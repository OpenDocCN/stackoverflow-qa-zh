# StackOverflow 问答 11528000-11528999

# xml - 如何在 XML 文件中特定节点的第一个和最后一个之间获取？

> ID：11528004
> 
> 赞同：0
> 
> 时间：2012-07-17T17:48:01.657
> 
> 标签：xml, regex, xpath

考虑我有一个包含以下数据的文件：

```
 ...
    <wsdl:message>
      ...
    </wsdl:message>
    <wsdl:message>
      ...
    </wsdl:message>
    <wsdl:message>
      ...
    </wsdl:message>
  ... 
```

什么是合适的正则表达式来获取第一个`<wsdl:message>`和最后一个之间的所有数据`</wsdl:message>`？

或者，（如已建议的那样）适当的 XPath 解决方案。

主要想法是我想找到并替换那部分数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T03:14:48.770

**只需使用**：

```
//x:message/node() 
```

其中前缀`x:`绑定（在*托管*XPath 的编程语言中）到 wsdl 名称空间——这通常称为“注册名称空间”）。

**或者，如果您无法注册此命名空间，请使用**：

```
//*[local-name()='message' 
  and 
    namespace-uri() = 'http://schemas.xmlsoap.org/wsdl/'
    ]/node() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T18:25:53.293

XPath

```
/*/wsdl:message[fn:position() > 1 and fn:position() < fn:last()] 
```

应该这样做。

**编辑**

对于 XPath 1.0（和 PHP 代码）

```
<?php
$string = <<<XML
<?xml version="1.0" encoding="utf-8"?>
<root xmlns:wsdl="/">
    <wsdl:message> 
      One
    </wsdl:message> 
    <wsdl:message> 
      Two 
    </wsdl:message> 
    <wsdl:message> 
      Three 
    </wsdl:message> 
    <wsdl:message> 
      Four 
    </wsdl:message> 
    <wsdl:message> 
      Five 
    </wsdl:message> 
    <wsdl:message> 
      Six 
    </wsdl:message>
</root>
XML;

print $string;
$xml = new SimpleXMLElement($string);

print_r($xml->xpath('/*/wsdl:message[position() > 1'.
                    ' and position() < last()]'));

?> 
```

# apache - httpd服务器服务位置？

> ID：11528006
> 
> 赞同：0
> 
> 时间：2012-07-17T17:48:04.533
> 
> 标签：apache

以下不起作用。

/etc/init.d https 重启服务 httpd 重启

我在 /etc/init.d 中没有看到任何与 httpd 相关的文件

虽然 httpd 服务器运行良好。/etc 中也不存在 httpd.conf 文件。我应该去哪里看？

请帮助重新启动服务。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T18:14:20.557

你能指定你使用的是哪个发行版吗？

*   Ubuntu 12.04LTS：`service apache2 restart`
*   Debian 6：`service apache2 restart`
*   红色的帽子：`/sbin/service httpd restart`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-01-23T10:24:33.643

森托斯 7：

```
/etc/systemd/system/multi-user.target.wants/httpd.service 
```

这指向：

```
/usr/lib/systemd/system/httpd.service 
```

# c# - 单例超类

> ID：11528007
> 
> 赞同：0
> 
> 时间：2012-07-17T17:48:08.587
> 
> 标签：c#, inheritance, singleton

我一直在阅读有关单例概念的内容。虽然不完全理解它，但我想在我的基类中使用我的实例获取器。

例如，我的类基类`RepositoryBase`将具有以下方法：

```
private static RepositoryBase _instance;
public static RepositoryBase Instance
{
    get
    {
        if (_instance == null)
            _instance = new RepositoryBase();
        return _instance;
    }
} 
```

这真的有意义吗？我相信当一个新的子类`UserRepository`（以.`RepositoryBase``Instance``RepositoryBase``UserRepository`

有什么办法可以让它`Instance`自动返回子类，同时仍然保留在基类中？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T17:58:47.107

您可以尝试使用通用基类

```
abstract public class RepositoryBase<T>
    where T : RepositoryBase<T>, new()
{
    public static readonly T Instance = new T();
}

public class SpecificRepository : RepositoryBase<SpecificRepository>
{
} 
```

然后像这样使用它

```
var obj = SpecificRepository.Instance; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T17:52:24.607

静态成员不是继承的，因为它们是静态的。这就是为什么你对它的看法无论如何都行不通的原因。

# javascript - Javascript在主页中插入动态行

> ID：11528008
> 
> 赞同：0
> 
> 时间：2012-07-17T17:48:09.397
> 
> 标签：javascript, dynamic, rows

我有两个页面：一个是主页面，一个是我抓取数据并提交回主页面的弹出窗口。它在 Chrome 和 FF 中似乎可以正常工作，但在 IE 中却不行。我收到一条错误消息“不支持此类接口”。这似乎发生在我要求在 IE 上测试的每个人身上。

我认为这与我将动态行附加到主页的方式有关。我只是不确定我应该如何正确地做这件事。

这是我使用的代码：

```
function addRowForPC(pcT,pcP)  {
    try {
        var tableID="Equipment"; 
        var table = window.opener.document.getElementById(tableID);              
        var rowCount = table.rows.length - 0;             
        var row = table.insertRow(rowCount);    

        insertFld( "delEquip", "image"   , table, rowCount, row, 0 ) //Image
        insertFld( pcT       , "text"    , table, rowCount, row, 1 ) //Text
        insertFld( pcP       , "textSpan", table, rowCount, row, 2 ) //Text
}

    catch(err) { 
        alert(err.message);
        return "Fail";
    }
}

//This calls: to create the rows:
function insertFld(fldName,fldType,table,rowCount,row,insCell)   {
    try {   
        var cellName = "cell" + (insCell+1);
        cellName = row.insertCell(insCell);

        switch (fldType) {
            case "image":
                        var image = document.createElement('img');
                        image.src="Images/delete.jpg";
                        image.alt ="Remove";
                        image.name=fldName +rowCount;
                        image.setAttribute('width','10');
                        image.setAttribute('height','10');
                        image.onclick= function(){deleteRow(this)}; 
                        cellName.appendChild(image); 
                        break;
            case "text":
                        cellName.innerHTML = fldName;
                        break;
            case "textSpan":
                        cellName.colSpan="2";
                        cellName.innerHTML = fldName;
                        break;
        }
    }

    catch(err) {    
        alert (err.message);
    }
} 
```

任何帮助/指导都会很棒。我是 JavaScript/HTML 的新手，所以我什至不知道从哪里开始 jQuery。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T18:40:17.643

哪个版本的IE？如果是 9，则打开开发人员工具，转到 Javascript 选项卡并打开调试，然后运行代码。它可能会给你一些有用的细节。如果没有，则首先注释掉大部分代码并运行它，如果它有效，则重新注释一些代码并重试，直到找到导致错误的位置。

我还会尝试将一些代码移动到打开器窗口，然后在其上调用函数，例如：

```
addRowForPC(pcT,pcP) {
    opener.addRowForPC(pcT,pcP);
} 
```

事实上，再看看你的代码，我认为它的 document.createElement() 调用就是问题所在，如果它在弹出窗口的上下文中运行，然后结果被添加到开启器中。您可能可以执行 opener.document.createElement() 以确保元素与开启者文档相关联，而不是与弹出窗口相关联。

# python - OpenCV：在 Python 中从 NumPy 转换为 IplImage

> ID：11528009
> 
> 赞同：8
> 
> 时间：2012-07-17T17:48:12.570
> 
> 标签：python, opencv

我有一张使用 cv2.imread() 加载的图像。这将返回一个 NumPy 数组。但是，我需要将其传递给需要 IplImage 格式数据的第 3 方 API。

我已经尽我所能搜索了所有内容，并找到了从 IplImage 转换为 CvMat 的实例，并且我发现了一些关于在 C++ 中转换的参考，但不是从 NumPy 到 Python 中的 IplImage。是否提供了可以进行此转换的功能？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-17T18:18:13.447

你可以这样做。

```
source = cv2.imread() # source is numpy array 
bitmap = cv.CreateImageHeader((source.shape[1], source.shape[0]), cv.IPL_DEPTH_8U, 3)
cv.SetData(bitmap, source.tostring(), 
           source.dtype.itemsize * 3 * source.shape[1]) 
```

`bitmap`这是`cv2.cv.iplimage`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-06-27T02:58:40.027

2申请方式：

1.  `img = cv2.imread(img_path) img_buf = cv2.imencode('.jpg', img)[1].tostring()`

2.  只需读取图像文件： `img_buf = open(img_path, 'rb').read()`

# css - Div 100% 高度在屏幕中央

> ID：11528010
> 
> 赞同：0
> 
> 时间：2012-07-17T17:48:13.097
> 
> 标签：css, html

为了说明，我创建了以下代码：

[http://jsfiddle.net/Ridermansb/SUcmH/4/embedded/result/](http://jsfiddle.net/Ridermansb/SUcmH/4/embedded/result/)

*   黄色：这是菜单，没错！
*   格林：这是页脚，是正确的！必须始终是底部：0（或者当站点更大时，必须向下推！）
*   蓝色：是网站的背景！部分正确！它应该只占用站点的一侧。
*   红色：这是网站内容的所在。它应该到网站的末尾（没有内容）

    > 像高度这样的东西：100% 但在页脚下方！

**基本上就像那个红色占据了整个屏幕的中心！**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T17:58:42.150

如果我正确理解您的问题，您需要将 .clearfooter 及其父级（在本例中为 #wrap）的高度设置为 100%

**[JSFiddle](http://jsfiddle.net/mhAKb/embedded/result/)**

```
#wrap {
    height: 100%;
}

.clearfooter {
    height: 100%;
    clear: both;
} 
```

# jquery-ui - 向对话框按钮添加类似样式的选项

> ID：11528011
> 
> 赞同：1
> 
> 时间：2012-07-17T17:48:17.073
> 
> 标签：jquery-ui, button, jquery-ui-dialog

正如我在过去的帖子中所说，我是一个 JavaScript 新手，现在学习了一些 JQuery。

## 简报：

我需要创建一个对话框，当有人单击**Cancel**时触发，并且具有（作为**文本**或**值**）“*您确定要退出吗？* ”，带有两个按钮：“*是的，我想离开*”和“*否，我想留在这个页面上*”。*“我想离开*”按钮的重定向部分稍后会弄清楚。

问题：我想使用**宽度选项使按钮可****自动调整**大小（换句话说，和，但我无法弄清楚：/**`width:auto``height: (number)px`**

 **这是我的代码->

```
 $(document).ready (function(){
    var $dialog = $('<div></div>');
    $(".selector").dialog({ modal:true });
    var $popUp = $('#btnCancel').one('click', function () {
        $dialog
        .html('All changes will not be saved')
        .dialog({
            title: 'Are you sure you want to exit?',
            resizable: false,
            modal: true,
            closeOnEscape: true,
            buttons: {

                "Yes, I want to leave": function() {
                $( this ).dialog( "close" );
                },
                "No, I want to stay on this page": function() {
                $( this ).dialog( "close" );
                }
            }
        });
    });
    $popUp.click(function () {
        $dialog.dialog('open');
        return false;
    });
}); 
```

我尝试更改这段代码的按钮部分->

```
 buttons: [
       { text: "Exit", 'class':'exit-button', resizable: true, click: function () { $(this).dialog("close"); } },
       { text: "Go back", 'class': 'go-back-button', resizable: true, click: function () { $(this).dialog("close"); } }
    ] 
```

但在最后一种情况下，它创建了两个值为“0”和“1”的按钮，并且没有 onclick 事件。

我应该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:03:25.533

如果你`id`在创建按钮时给它们一个 ，你可以用 CSS 来设置它们的样式，包括给它们一个`height`和`width`。

**示例**- [http://jsfiddle.net/tj_vantoll/ckhG6/2/](http://jsfiddle.net/tj_vantoll/ckhG6/2/)**

# javascript - 是否可以拦截所有重定向并在新窗口/弹出窗口中打开内容？

> ID：11528013
> 
> 赞同：6
> 
> 时间：2012-07-17T17:48:28.077
> 
> 标签：javascript, jquery

所以我有一个包含 iframe 的页面。在 iframe 中，有在同一窗口中打开新页面的链接 (self.location.href) (window.open(urlstring,'false') 等等......等等......

有没有办法可以强制此窗口内的所有链接在新窗口/弹出窗口中打开它们的内容？覆盖他们的重定向设置而不更改 iframe 内的代码？

我问这个的原因是因为，我认为 iframe 页面仍然引用父窗口作为他们的窗口，因此，当像“window.self.open”这样的函数被触发时，它把我的整个父窗口都带走了.. .

也许无论如何要将iframe作为页面内的单独窗口嵌入？只是不知道如何避免相同的窗口引用......

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:47:46.540

`target="_blank"`您可以通过添加到`a`元素（例如`<a href="example.html" target="_blank">Example</a>`）来设置在新窗口中打开的链接。

如果您想在不触及链接本身的情况下将其应用于所有链接，您可以包含一个 jquery 函数来为您执行此操作：

```
$("a").attr("target","_blank"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-07-18T13:17:26.787

您还可以将目标属性添加到`base`标头中的 -tag 中。

```
<base target="_blank"> 
```

这也将应用于所有链接。

# c# - 下载网页并保存为 UTF-8 文本文件

> ID：11528014
> 
> 赞同：3
> 
> 时间：2012-07-17T17:48:30.663
> 
> 标签：c#, utf-8

**我下载一个网页如下。我想将其保存为 UTF-8 文本。但是怎么做？**

```
HttpWebRequest req = (HttpWebRequest)WebRequest.Create(url);
using (HttpWebResponse resp = (HttpWebResponse)req.GetResponse())
{
    Encoding enc = Encoding.GetEncoding(resp.CharacterSet);
    Encoding utf8 = Encoding.UTF8;
    using (StreamWriter w = new StreamWriter(new FileStream(pathname, FileMode.Create), utf8))
    {
        using (StreamReader r = new StreamReader(resp.GetResponseStream()))
        {
            // This works, but it's bad because you read the whole response into memory:
            string s = r.ReadToEnd();
            w.Write(s);

            // This doesn't work :(
            char[] buffer = new char[1024];
            int n;
            while (!r.EndOfStream)
            {
                n = r.ReadBlock(buffer, 0, 1024);
                w.Write(utf8.GetChars(Encoding.Convert(enc, utf8, enc.GetBytes(buffer))));
            }

            // This means that r.ReadToEnd() is doing the transcoding to UTF-8 differently.
            // But how?!
        }
    }
    return resp.StatusCode;
} 
```

不要读这一段。它只是为了消除有关代码过多​​的警告消息。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-17T18:22:21.110

您可以简单地使用 WebClient 类。它支持编码和更易于使用：

```
WebClient webClient = new WebClient();
webClient.Encoding = System.Text.Encoding.UTF8;
webClient.DownloadFile(url, "file.txt"); 
```

# javascript - libphonenumber 独立（没有大量的谷歌依赖）？备用库？

> ID：11528017
> 
> 赞同：45
> 
> 时间：2012-07-17T17:48:39.253
> 
> 标签：javascript, phone-number, libphonenumber

我正在考虑将[http://code.google.com/p/libphonenumber/](http://code.google.com/p/libphonenumber/)用于一个完善的项目。今天，该项目不使用 Google 的 JavaScript 库，支持 jQuery、jQueryUI、requirejs 等。

libphonenumber 看起来很棒……除了 javascript 版本（svn co [http://libphonenumber.googlecode.com/svn/trunk/javascript/libphonenumber-js](http://libphonenumber.googlecode.com/svn/trunk/javascript/)）带有 goog.require 调用。如果运行演示（libphonenumber-js/i18n/phonenumbers/demo.html，如果您按照建议签出），它会从closure-library.googlecode.com 中提取大量谷歌库：

```
GET base.js
GET deps.js
GET error.js
GET string.js
GET asserts.js
GET array.js
GET useragent.js
GET browserfeature.js
GET tagname.js
GET classes.js
GET math.js
GET coordinate.js
GET size.js
GET object.js
GET dom.js
GET json.js
GET util.js
GET descriptor.js
GET fielddescriptor.js
GET message.js
GET serializer.js
GET objectserializer.js
GET stringbuffer.js
GET lazydeserializer.js
GET pbliteserializer.js 
```

我相信如果我使用闭包编译器编译它（“如果你给 use_closure_library 参数的值为 true，编译器会在源代码中查找 goog.require() 语句并提供任何此类语句请求的闭包库代码。” , [https://developers.google.com/closure/compiler/docs/api-ref](https://developers.google.com/closure/compiler/docs/api-ref)）我可以减少请求的原始数量，但这对于电话号码解析器来说仍然是相当多的内容，甚至是功能齐全的一款。

我的问题有两个可能的答案：

1.  一种在 JavaScript 中使用 libphonenumber 而无需引入所有 Google JavaScript 基础库的方法
2.  具有 JavaScript 和 Java 实现的备用独立（因为没有几十个依赖项）一流的电话号码处理库

任何和所有建议都非常感谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-09-28T05:50:58.560

我有一个[自定义版本](https://github.com/jackocnr/intl-tel-input/blob/master/build/js/utils.js)（当前为 220KB），用于我的[International Telephone Input](https://github.com/jackocnr/intl-tel-input)插件，并公开了大量的辅助功能。阅读[源代码](https://github.com/jackocnr/intl-tel-input/blob/master/src/js/utils.js)以获取详细信息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-07-01T10:15:59.900

你也可以使用我的库。 [https://github.com/Gilshalem/phoneparser](https://github.com/Gilshallem/phoneparser)

它只有一种方法，但你可以用它做很多事情

```
parsePhone("12025550104");
result: { countryCode:1, areaCode:202, number:5550104, countryISOCode:"US" } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-03-13T10:24:43.997

以下是 JavaScript 中 Google libphonenumber 的两个实现，它们具有零依赖关系并在单个文件中实现。我已经毫无问题地使用了 Nathan Hammond 的版本，但它不在 NPM 上。Rui Marinho 的版本在 NPM 上。

*   [https://github.com/nathanhammond/libphonenumber](https://github.com/nathanhammond/libphonenumber)
*   [https://github.com/ruimarinho/google-libphonenumber](https://github.com/ruimarinho/google-libphonenumber)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-08-10T21:24:29.923

我只花了2天时间弄清楚这一点。现在，无论如何，你可以从[这里下载一个缩小版的 libphonenumber-js](https://cdnjs.cloudflare.com/ajax/libs/libphonenumber-js/1.4.2/libphonenumber-js.min.js)

用通常的方式将其放置到位

```
<script type="text/javascript" language="javascript" src="/static/js/libphonenumber-js.min.js"></script> 
```

并忙于编码！

```
<script>
    $(".phone-format").keyup(function () {
            var val_old = $(this).val();
            var newString = new libphonenumber.AsYouType('US').input(val_old);
            $(this).focus().val('').val(newString);
    });
</script> 
```

# php - 由 PHPStorm 中的代码嗅探器触发的 Xdebug

> ID：11528022
> 
> 赞同：7
> 
> 时间：2012-07-17T17:49:05.003
> 
> 标签：php, xdebug, codesniffer

我在安装 PHPStorm 时让 xdebug 和 Code Sniffer 都工作得很好，但真正令人讨厌的部分是调试器现在似乎将 Code Sniffer 错误视为断点并中断代码以让我知道样式警告，而我正在试图测试代码。如何防止 Code Sniffer 被 PHPStorm 中的远程调试器捕获？

PS：我正在运行 Apache，使用虚拟主机将某些 URL 映射到我计算机上的文件夹，并且代码嗅探器从未显式触发 PHPStorm 的远程调试器，而我的站点导致 PHPStorm 询问我是否想包含它的虚拟 URL 以进行调试。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-07-26T09:42:16.063

我有一个类似的问题，我是这样解决的： - 转到“项目设置”->“PHP”->“调试”-在“XDebug”下我取消了两个“强制...”选项。

[![在此处输入图像描述](../Images/c435876ddcf296cf7cc4c88322dc93e8.png)](https://i.stack.imgur.com/Rx2zy.png)

希望它对你有用。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2020-08-12T10:47:33.460

我在 phpcs.bat 和 phpcbf.bat 的最后一行添加了“-dxdebug.remote_enable=0”参数。

```
"%PHPBIN%" -dxdebug.remote_enable=0 "%~dp0\phpcbf" %* 
```

# android - 维护视图状态android

> ID：11528023
> 
> 赞同：0
> 
> 时间：2012-07-17T17:49:07.267
> 
> 标签：android

请不要删除它，因为它是重复的。我是一个经验很少的安卓开发者。我有一个有 2 个屏幕的应用程序。第一个在 a 中有一堆选项，`TableLayout`每个选项都使用`RadioButton`.

我想要做的是，当我选择一个选项并单击`Button`下面出现的 a 时，`View`应该切换到显示一些相关数据的下一个屏幕，当单击 a 时`Button`，我希望它返回到同一屏幕，然后其余的我应该可以使用这些选项，以便在选择另一个选项的情况下重复相同的过程。

总之我希望能够保持第一个屏幕的状态。我似乎无法决定使用`ViewSwitcher`,`ViewFlipper`或 multiple`Activities`还是使用一个`Activity`我现在正在做的事情。但是随着我的应用程序变得越来越大，处理它变得非常困难。请建议最好的方法来做到这一点。我很困惑，迫切需要帮助，因为我的工作依赖于它。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T18:16:28.200

使用 2 个活动。当用户单击按钮时启动第二个活动。当用户单击“返回”按钮（或您提供给他的其他按钮）时，第二个活动完成并显示第一个活动（位于其下方）。

注意：你没有给我们太多信息，所以我不能保证这是最好的解决方案。从你所说的来看，这是我推荐的解决方案。正如他们在广告中所说的“您的里程可能会有所不同”;-)

# php - 如果 PHP 的 mt_rand() 使用比 rand() 更快的算法，为什么不直接更改 rand() 以使用更新的实现呢？

> ID：11528027
> 
> 赞同：4
> 
> 时间：2012-07-17T17:49:12.227
> 
> 标签：php

随机数函数的目的是得到——你猜对了——一个随机数，你无法预测（或者很难确定地预测）。如果`mt_rand()`函数比旧的更快且更不可预测（更“随机”）`rand()`，为什么不将底层实现切换到新方法呢？

换句话说，`rand()`如果/因为底层实现发生了变化，使用什么样的程序会在更高版本的 PHP 中中断？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-17T17:52:46.027

主要是因为那是*PHP 方式*。就像他们添加`mysql_real_escape_string`而不是替换`mysql_escape_string`它一样。

但是，它也可能与 mersenne-twister 算法的缺点有关（我不知道它们是否也存在于`rand()`算法中）：

> 本机形式的算法不适用于密码学（与 Blum Blum Shub 不同）。观察足够数量的迭代（在 MT19937 的情况下为 624，因为这个数字是产生未来迭代的状态向量的大小）允许人们预测所有未来的迭代。Makoto Matsumoto 等人提出了一对基于 Mersenne twister 输出的密码流密码。作者声称在计数器模式下速度比高级加密标准快 1.5 到 2 倍。^([维基百科](http://en.wikipedia.org/wiki/Mersenne_twister#Disadvantages))
> 
> 另一个问题是，将非随机初始状态（特别是存在许多零）转换为通过随机性测试的输出可能需要很长时间。小型滞后 Fibonacci 生成器或线性同余生成器启动得更快，通常用于为 Mersenne Twister 播种随机初始值。^([维基百科](http://en.wikipedia.org/wiki/Mersenne_twister#Disadvantages))

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-17T17:59:16.907

两种算法都是伪随机的。这意味着知道初始条件可以知道所有未来的迭代。不可能知道有人是否依赖于这样的实现细节（即依赖于函数的*实现*而不是函数的*意图*），因此创建一个新函数更安全。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2019-11-02T13:08:47.827

最后从 PHP 7.1 开始，两者`rand()`和`mt_rand()`是相同的功能。

# html - 使用 css 创建网格布局

> ID：11528028
> 
> 赞同：3
> 
> 时间：2012-07-17T17:49:21.513
> 
> 标签：html, css

我将使用 CSS 创建一个水平网格布局。（我将通过 JQuery 和[此](https://stackoverflow.com/questions/11262644/horizontal-scrolling-with-mouse-wheel-with-overthrow-plugin)解决方案使其水平滚动。请注意，滚动不是我的问题。我的问题是关于创建网格）

这是一个例子： ![](../Images/7ee0aba1d573d5e0e38680ada7e6d59d.png)

我已经在互联网上搜索了有关 CSS Grids 的信息，但似乎他们无法帮助我......

**我的问题是，如何创建类似上图的东西？为此我应该使用哪些插件或 css 属性？**

编辑：我想要固定的行数（我的意思是，当我调整页面大小时，行数**不应该改变。****应该有一个滚动条。**）（我将在 div 中使用它`overflow: auto`）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T17:51:26.893

`display:table`, `display:table-row`, `display:table-cell`,`display:inline-block`

这些 css 属性可以提供帮助，只需在本地 css 信息站点上查找它们即可。

-values`table`让每个元素的行为都像一个表格，而无需实际使用一个表格。这可能是解决您问题的好方法。

-value`inline-block`解决了一些浮动布局在块显示为*inline*时的悬垂问题，就像`img`s. 当然，旧浏览器对此几乎没有支持。

# eclipse - How do I import and export keyboard bindings in Eclipse?

> ID：11528031
> 
> 赞同：25
> 
> 时间：2012-07-17T17:49:32.430
> 
> 标签：eclipse

> **Possible Duplicate:**
> [eclipse keybindings settings](https://stackoverflow.com/questions/481073/eclipse-keybindings-settings)

How do I import and export keyboard bindings in Eclipse?

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-07-17T17:53:55.310

File->Export...->General->Preferences, then choose to "Export all" your preferences or just the "Keys Preferences"; make sure to point out the file where you want your preferences to be saved, and finally click "Finish".

File->Import...->General->Preferences, then point the preference file you created when exporting your preferences; choose to "Import all" or specific preferences, and finally click on "Finish".

# php - 获取 MySql 查询的响应

> ID：11528038
> 
> 赞同：1
> 
> 时间：2012-07-17T17:49:43.220
> 
> 标签：php, android, json

我有一个关于 android 中聊天程序的算法，但我在服务器端部分有问题。

我可以通过json将我的用户名、密码和电子邮件等数据从我的应用程序存储到我的数据库中，但我不知道如何将它们签入我的应用程序！（例如，将用户名检查查询的响应获取到我的应用程序中。）

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T17:54:25.253

基本上，当您运行`httpClient.execute`它时，它会返回一个响应，您需要使用该响应。

客户端：

```
HttpResponse resp = httpClient.execute( post );
DataInputStream is = new DataInputStream( resp.getEntity().getContent() ); 
```

服务器端取决于您使用的编程语言。例如使用python：

```
 self.response.headers['Content-Type'] = 'text/vnd.aexp.json.resp'
    self.response.set_status( 200,"OK" )
    self.response.out.write( json.dumps( responseList ) ) 
```

有关完整的源代码和详细信息，请参阅此示例：

[http://mylifewithandroid.blogspot.fi/2010/10/client-server-communication-with-json.html](http://mylifewithandroid.blogspot.fi/2010/10/client-server-communication-with-json.html)

**编辑**
检查这个PHP服务器端：

[http://www.happycode.info/php-json-response/](http://www.happycode.info/php-json-response/)

# eclipse-plugin - Eclipse 插件将 org.eclipse.swt.widgets.TreeColumn 的单元格更改为下拉框或组合框

> ID：11528040
> 
> 赞同：0
> 
> 时间：2012-07-17T17:49:48.080
> 
> 标签：eclipse-plugin, editor, rcp

我想知道如何将`TreeColumn`' 单元格从文本更改为下拉框或组合框，就像 XML 编辑器一样，当您输入时：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app id="WebApp_ID" version="2.4" 
    xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd">
</web-app> 
```

在 Eclipse 的 XML 编辑器的源页面，然后切换到它的设计页面，你会看到版本行的内容列与其他的不同，它是一个下拉框或组合框，而其他的是测试框。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T06:06:51.387

你可以用[`TreeEditor`](http://help.eclipse.org/helios/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/api/org/eclipse/swt/custom/TreeEditor.html)这个，我想。

# c - 互斥量可用时在哪里使用二进制信号量？

> ID：11528041
> 
> 赞同：7
> 
> 时间：2012-07-17T17:49:51.817
> 
> 标签：c, operating-system, mutex, semaphore

在阅读二进制信号量和互斥量时，我发现了以下区别：

> 两者都可以有值 0 和 1，但互斥锁可以由获得互斥锁的同一个线程解锁。如果更高优先级的进程想要获取相同的互斥锁，则获取互斥锁的线程可以进行优先级反转，而二进制信号量则不是这种情况。

那么我应该在哪里使用二进制信号量呢？谁能举个例子？

编辑：我想我已经弄清楚了两者的工作原理。基本上二进制信号量提供同步，而互斥量提供锁定机制。我阅读了 Galvin OS 书中的一些示例，以使其更加清晰。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-17T18:04:50.097

我发现二进制信号量非常有用的一种典型情况是线程初始化，其中线程将从父线程拥有的结构中读取。父线程需要等待新线程从结构中读取共享数据，然后才能让结构的生命周期结束（例如，通过离开其范围）。使用二进制信号量，您所要做的就是将信号量值初始化为零并让子级在父级等待它时发布它。如果没有信号量，您将需要一个互斥量和条件变量以及更丑陋的程序逻辑来使用它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-17T20:31:23.110

在几乎所有情况下，我都使用二进制信号量来向其他线程发出信号而无需锁定。

同步请求的简单使用示例：

**线程 1**：

```
Semaphore sem;
request_to_thread2(&sem); // Function sending request to thread2 in any fashion
sem.wait();               // Waiting request complete 
```

**线程 2**：

```
Semaphore *sem;
process_request(sem);     // Process request from thread 1
sem->post();              // Signal thread 1 that request is completed 
```

注意：在线程 2 处理中发布信号量之前，您可以安全地设置线程 1 数据，而无需任何额外的同步。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T18:11:09.393

使用计数信号量而不是二进制互斥锁的典型示例是，当您的可用资源数量有限时，a) 可互换且 b) 不止一个。

例如，如果您希望最多允许 10 个读者一次访问数据库，您可以使用初始化为 10 的计数信号量来限制对资源的访问。每个读取器必须在访问资源之前获取信号量，从而减少可用计数。一旦计数达到 0（即 10 个读者已获得访问权限并仍在使用数据库），所有其他读者将被锁定。一旦读者完成，他们将信号量计数增加一以表明他们不再使用该资源，并且其他一些读者现在可以获得信号量锁并获得访问权。

然而，计数信号量，就像所有其他同步原语一样，有很多用例，这只是一个跳出框框思考的问题。您可能会发现，您习惯使用互斥锁和附加逻辑解决的许多问题都可以使用信号量更轻松、更直接地实现。互斥量是信号量的一个子集，也就是说，你可以用互斥量做的任何事情都可以用一个信号量来完成（只需将计数设置为 1），但是有些事情可以单独用一个信号量来完成不能只用一个互斥锁来完成。

归根结底，任何一个同步原语通常都足以做任何事情（将其视为线程同步的“图灵完备”，将这个词混为一谈）。然而，每一个都是为不同的应用程序量身定做的，虽然你可以通过一些定制和额外的粘合来强迫一个人做你的竞标，但不同的同步原语可能更适合这项工作。

# ruby - 在 Ruby 中同时生成子进程

> ID：11528045
> 
> 赞同：1
> 
> 时间：2012-07-17T17:50:09.087
> 
> 标签：ruby, resque

我正在使用带有队列处理器的 resque，作为其执行的一部分，它将启动一个 shell 进程。目前，我正在使用`PTY.spawn()`调用 shell 命令并处理其输出。

我想扩充这段代码，以便可以给出一个数量（N）（在虚拟机上执行的命令，我希望能够通过一次调用启动一个可变数字），并让 shell 进程被调用 N 次单独的进程，第 N 个调用不必等待调用 N-1 完成，依此类推。我还想从每次调用中捕获所有 STDOUT，以便在调用完成后对输出进行处理。

我已经看过了，`Kernel::fork`但是分叉​​块内的代码范围与其父级不同（出于非常明显的原因）。

我可以使用什么工具来独立生成每个进程，捕获它们的输出，并且我仍然可以让父进程等待它们全部完成后再继续？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:18:04.127

这里：

```
stdouts=[]
numberOfProcesses.times do 
  stdouts<<PTY.spawn(command_line)[0..-1]
end 
```

如果您只是生成它们并获得一堆 STDOUT/STDIN 对，那是非常基本的。如果您希望能够在完成后立即处理每个进程的输出，请尝试以下操作：

```
threads=[]
numberOfProcesses.times do
  threads<<Thread.new(command_line) |cmd|
    stdout, stdin, pid = PTY.spawn(cmd)
    Process.waitpid(pid)
    process_output(stdout.read)
  end
end
threads.each {|t| t.join} 
```

这会并行生成它们，每个线程都在等待它的实例完成。当它的实例完成时，它处理输出并返回。主线程等待所有其他线程完成。

# sql-server-2008 - SSIS 包级别 OnError 发送两封电子邮件

> ID：11528050
> 
> 赞同：5
> 
> 时间：2012-07-17T17:50:37.287
> 
> 标签：sql-server-2008, ssis, package, transformation

我有一个包，只要控制流元素失败，它就会发送两封电子邮件。例如，如果 ExecuteSQL 任务失败，包级别的 OnError 事件处理程序会触发两封电子邮件。

这是一个已知的问题？我该如何解决这个问题？我可以通过数据库驱动的脚本来做到这一点，但本质上，我想处理 SSIS 本身的情况。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T18:22:49.493

请记住，事件处理程序将在触发操作发生时引发事件。因此，不能保证您只使用事件处理程序获取一个事件（当然也有一些例外）。

如果您只想保证一封电子邮件，那么我建议您不要通过 OnError 事件发送电子邮件，而是将作为控制流一部分的“发送电子邮件任务”链接到带有“故障约束”的 ExecuteSQL 任务。

或者，您还可以在 OnError 事件中设置一个等于 true 的用户变量，然后根据该变量发送电子邮件，其中包含一个“完成时”约束和一个检查错误用户变量值的表达式。这样，OnError 事件引发多少次并不重要，因为该任务只有在至少引发一次时才会运行。

# wcf - WCF over SSL - 我仍然可以通过 Internet 进行点对点操作吗？

> ID：11528057
> 
> 赞同：0
> 
> 时间：2012-07-17T17:51:11.420
> 
> 标签：wcf, ssl, wcf-security

设想

*   我们公共 DNN 网站上的 WCF 服务使用基于 SSL 的 WsHttpBinding。
*   安全模式是`TransportWithMessageCredential`
*   需要[用户名和密码](http://msdn.microsoft.com/en-us/library/system.identitymodel.selectors.usernamepasswordvalidator%28v=vs.90%29.aspx)验证
*   一个 WCF 客户端在我们的 Intranet 上使用该服务

我了解使用 SSL 的点对点安全的*基本*概念，但我的问题是 - 如果我的客户端应用程序（在我们的 Intranet 上）连接到我们公共网站上的 WCF 服务，我仍然可以拥有点对点安全吗SSL？考虑到通信是通过 Internet 进行的，该服务在 Internet 上是否会为“中间人”攻击打开它？我不是完全理解中间人的攻击吗？

我应该注意，我们 Intranet 上的应用程序是唯一将使用此服务的客户端，或者至少，这不是我将允许（提供其他用户名/密码）其他任何人使用或使用的东西。

谢谢

# java - 我想定义一个没有接口的 Spring Bean CLASS

> ID：11528061
> 
> 赞同：8
> 
> 时间：2012-07-17T17:51:14.967
> 
> 标签：java, spring, ioc-container

我有一个可以延伸的春豆`HibernateDaoSupport`。我希望这个 bean 注入到我的控制器中，但我不希望它实现任何接口。我只想从我的其余代码中引用具体类（也许不使用 AopProxy？）有没有人有办法做到这一点？

```
<bean id="mySampleService" class="com.sample.MySampleService">
    <property name="sessionFactory" ref="sessionFactory" />
</bean>

@Autowired
private MySampleService mySampleService;

... getters and setters .... 
```

我知道使用接口是个好主意，这就是 IoC 的全部意义，但请不要建议我使用接口。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-17T18:41:22.593

如果要代理的类（在您的情况下通过事务代理）实现任何接口（在您的情况下`InitializingBean`由实现`HibernateDaoSupport`），则 Spring 默认使用基于 JDK 动态代理的代理策略。

因此，它创建了一个 type 的代理`InitializingBean`，很明显，它不能注入到 type 的字段中`MySampleService`。

如果您不想使用接口，您可以通过声明`<tx:annotation-driven>`with来覆盖事务方面使用的策略`proxy-target-class = "true"`。

**也可以看看：**

*   [7.6 代理机制](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/aop.html#aop-proxying)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T18:37:02.957

检查以下内容。确保您的类路径中有 CGLIB。

[http://static.springsource.org/spring/docs/3.0.0.M3/spring-framework-reference/html/ch08s06.html](http://static.springsource.org/spring/docs/3.0.0.M3/spring-framework-reference/html/ch08s06.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T23:48:16.370

您可以将包括 xml 中的映射控制器在内的所有内容编写为 bean，然后您不需要编写接口。否则，使用注释时，您需要构建接口来代理它们。

# mysql - MySQL转储和导入不保留编码？

> ID：11528069
> 
> 赞同：3
> 
> 时间：2012-07-17T17:51:28.967
> 
> 标签：mysql, encoding, utf-8, character-encoding, mysqldump

我正在尝试将远程计算机上的 MySQL 数据库上的表复制到本地计算机上的另一个 MySQL 数据库。我注意到，在将转储导入本地机器后，出现了像 â‚¬â„¢ 这样的字符，而不是单引号。

我认为这是一个编码问题，所以我进入了两个数据库并运行`show create table posts`，在两个数据库接近尾声时，我看到了`CHARSET=utf8`. 此外，我在转储文件上运行`file -i`了转储文件，前后`scp`都将其导入本地计算机，它们都是 utf8。

但是，当我导入这个文件时，我之前得到了这个：

```
 attendees—policy makers, 
```

之后：

```
 attendeesâ€”policy makers, 
```

我不确定为什么会这样，一切都在使用 utf8，我错过了什么？

编辑：我正在`mysql Ver 14.12 Distrib 5.0.75, for debian-linux-gnu (x86_64)`远程和`mysql Ver 14.14 Distrib 5.5.25a, for osx10.7 (i386)`本地使用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T17:57:55.140

在这两个系统上，您必须检查您的连接编码是否正确：

```
SHOW VARIABLES LIKE 'character_set_%' 
```

通常看到这样的字符是双重编码的结果。确保您可以将连接和客户端编码匹配为完全相同。有许多命令行选项可以促进这一点，或者如果您使用的是驱动程序或客户端，其中的某些东西可以对其进行调整。

# windows - Windows 中的日志文件修改

> ID：11528071
> 
> 赞同：0
> 
> 时间：2012-07-17T17:51:33.793
> 
> 标签：windows, file, logging

我正在尝试找到一种将简单文本文件的修改记录到 Windows 日志中的方法。我似乎无法使用事件查看器的审计工具来解决它，因为它只记录授权，而不是修改。或者我做错了。任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T20:57:08.223

我不确定这里到底在问什么。您是否尝试记录在修改特定文件时生成的事件？

也许您想使用[`ReadDirectoryChangesW`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365465%28v=vs.85%29.aspx).

# c# - C# 中的关闭表单

> ID：11528077
> 
> 赞同：0
> 
> 时间：2012-07-17T17:51:57.267
> 
> 标签：c#, windows, forms

> **可能重复：**
> [C# 使用多个表单](https://stackoverflow.com/questions/10769193/c-sharp-working-with-mutliple-forms)

我在 C# 中有两种形式。我想关闭一个表格并显示另一个。代码如下：

```
AMBR A = new AMBR();
this.Close();
A.Show(); 
```

目前的形式是我的主要形式。它显示了我的第二个表单，但是关闭了两个表单并且我的程序停止了。我知道另一种标准方法是隐藏表单，但我的主表单只有一个徽标和加载栏。它不需要与用户进行任何交互。当我隐藏它时，在关闭第二个表单后，程序保持打开状态（如任务管理器中所示）并继续占用资源。我希望主窗体关闭，第二个窗体保持打开状态。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T18:03:24.413

打开你的“Program.cs”。将代码修改如下，其中 SplashFrm 是在 Application.Run 调用中创建的当前 Form

```
static class Program
{
    private static EventHandler idleTemp;
    private static SplashFrm splash;

    /// <summary>
    /// The main entry point for the application.
    /// </summary>
    [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        splash = new SplashFrm();
        splash.Show();
        idleTemp = new EventHandler(Application_Idle);
        Application.Idle += idleTemp;

        Application.Run(new AMBR());
    }

    static void Application_Idle(object sender, EventArgs e)
    {
        splash.Close();
        Application.Idle -= idleTemp;
        idleTemp = null;
        splash = null;
    }
} 
```

然后，在成功加载 AMBR 后，调用`Application.RaiseIdle(null);`并关闭并清理您的启动画面。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T18:10:34.057

[Application.Run](http://msdn.microsoft.com/en-us/library/ms157901.aspx) MSDN 页面上有一个示例，它解释了如何继承`ApplicationContext`以使程序仅在最后一个窗体关闭时结束，而不仅仅是在主窗体关闭时结束。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-17T17:56:11.200

不，您不能关闭主窗体并保持打开第二个窗体。但是你可以隐藏它。

```
this.Hide(); 
```

* * *

**编辑：**

另一种解决方案是使用第二个表单作为主表单，并在打开第二个表单（启动表单）时使其不可见。

所以：

```
this.Visible = false;

//Show the second form 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-17T17:56:15.307

你试过吗`this.Hide()`？而不是`this.Close();`？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-17T17:57:42.310

听起来您的主要形式有误。您应该将正在打开的另一个窗体更改为主窗体，并且当前作为主窗体的窗体应该由另一个窗体打开。当您当前的主窗体关闭时，将其作为`Show`您的新主窗体。程序启动时隐藏新的主窗体。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-17T17:57:02.863

问题的发生可能是因为您的主要方法是创建第一个表单并等待它关闭。当它关闭主进程并到达导致您的应用程序关闭的结尾时。

要么让主要方法创建第二个表单，要么不关闭第一个表单并隐藏它+隐藏任务栏图标。

# python - 确定数组中的重复值

> ID：11528078
> 
> 赞同：74
> 
> 时间：2012-07-17T17:52:00.047
> 
> 标签：python, numpy, duplicates, unique

假设我有一个数组

```
a = np.array([1, 2, 1, 3, 3, 3, 0]) 
```

我如何（有效地，Pythonically）找到哪些元素`a`是重复的（即非唯一值）？在这种情况下，结果将是`array([1, 3, 3])`或可能`array([1, 3])`是有效的。

我想出了一些似乎有效的方法：

### 掩蔽

```
m = np.zeros_like(a, dtype=bool)
m[np.unique(a, return_index=True)[1]] = True
a[~m] 
```

### 设置操作

```
a[~np.in1d(np.arange(len(a)), np.unique(a, return_index=True)[1], assume_unique=True)] 
```

这个很可爱，但可能是非法的（`a`实际上并不是唯一的）：

```
np.setxor1d(a, np.unique(a), assume_unique=True) 
```

### 直方图

```
u, i = np.unique(a, return_inverse=True)
u[np.bincount(i) > 1] 
```

### 排序

```
s = np.sort(a, axis=None)
s[:-1][s[1:] == s[:-1]] 
```

### 熊猫

```
s = pd.Series(a)
s[s.duplicated()] 
```

有什么我错过的吗？我不一定要寻找仅 numpy 的解决方案，但它必须与 numpy 数据类型一起工作，并且在中等数据集（最大 1000 万个大小）上高效。

* * *

## 结论

使用 1000 万大小的数据集进行测试（在 2.8GHz Xeon 上）：

```
a = np.random.randint(10**7, size=10**7) 
```

最快的是排序，1.1s。可疑`xor1d`的以 2.6s 位居第二，其次是 masking 和 Pandas`Series.duplicated`的 3.1s、`bincount`5.6s`in1d`和 senderle 的`setdiff1d`均为 7.3s。Steven 的`Counter`速度稍慢一点，为 10.5 秒；紧随其后的是 Burhan 的`Counter.most_common`110 秒和 DSM 的`Counter`360 秒减法。

我将使用排序来提高性能，但我接受 Steven 的回答，因为性能是可以接受的，而且*感觉*更清晰、更 Pythonic。

编辑：发现 Pandas 解决方案。如果 Pandas 可用，它就很清楚并且性能良好。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2018-07-12T05:16:55.327

从 numpy 版本 1.9.0 开始，[`np.unique`](https://docs.scipy.org/doc/numpy/reference/generated/numpy.unique.html)有一个参数`return_counts`可以大大简化您的任务：

```
u, c = np.unique(a, return_counts=True)
dup = u[c > 1] 
```

这类似于 using [`Counter`](https://docs.python.org/3/library/collections.html#collections.Counter)，除了你得到一对数组而不是映射。我很想知道它们相对于彼此的表现如何。

可能值得一提的是，尽管`np.unique`由于它的 numpyness 在实践中相当快，但它的算法复杂性比`Counter`解决方案更差。`np.unique`是基于排序的，所以在`O(n log n)`时间上渐近运行。`Counter`是基于哈希的，因此具有`O(n)`复杂性。除了最大的数据集之外，这对任何东西都没有多大关系。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2012-07-17T18:25:45.693

我认为这是在`numpy`. `numpy`如果您关心速度，您将不得不根据您的解决方案计时。

```
>>> import numpy as np
>>> from collections import Counter
>>> a = np.array([1, 2, 1, 3, 3, 3, 0])
>>> [item for item, count in Counter(a).items() if count > 1]
[1, 3] 
```

*注意：* 这类似于 Burhan Khalid 的回答，但在`items`条件中使用无下标应该更快。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-07-17T20:10:22.863

人们已经提出了`Counter`变体，但这里有一个不使用 listcomp 的变体：

```
>>> from collections import Counter
>>> a = [1, 2, 1, 3, 3, 3, 0]
>>> (Counter(a) - Counter(set(a))).keys()
[1, 3] 
```

[发布不是因为它有效——不是——而是因为我认为你可以减去`Counter`实例很可爱。]

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-07-17T18:02:32.603

对于 Python 2.7+

```
>>> import numpy
>>> from collections import Counter
>>> n = numpy.array([1,1,2,3,3,3,0])
>>> [x[1] for x in Counter(n).most_common() if x[0] > 1]
[3, 1] 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-07-17T18:32:49.790

这是另一种使用集合操作的方法，我认为它比您提供的方法更简单：

```
>>> indices = np.setdiff1d(np.arange(len(a)), np.unique(a, return_index=True)[1])
>>> a[indices]
array([1, 3, 3]) 
```

我想您是在要求`numpy`-only 解决方案，因为如果不是这种情况，那么仅使用 a 就很难争论`Counter`。我认为您应该明确说明该要求。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-07-17T18:34:33.527

如果`a`由小整数组成，您可以直接使用 numpy.bincount ：

```
import numpy as np

a = np.array([3, 2, 2, 0, 4, 3])
counts = np.bincount(a)
print np.where(counts > 1)[0]
# array([2, 3]) 
```

这与您的“直方图”方法非常相似，如果`a`不是由小整数组成，我会使用这种方法。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2015-06-15T04:12:02.757

如果数组是排序的 numpy 数组，那么只需执行以下操作：

```
a = np.array([1, 2, 2, 3, 4, 5, 5, 6])
rep_el = a[np.diff(a) == 0] 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-06-11T21:04:14.557

我正在为这个 3 年的问题添加我的解决方案，因为除了 numpy 之外，没有任何解决方案适合我想要或使用的库。此方法查找重复项的索引和*不同*重复项集的值。

```
import numpy as np

A = np.array([1,2,3,4,4,4,5,6,6,7,8])

# Record the indices where each unique element occurs.
list_of_dup_inds = [np.where(a == A)[0] for a in np.unique(A)]

# Filter out non-duplicates.
list_of_dup_inds = filter(lambda inds: len(inds) > 1, list_of_dup_inds)

for inds in list_of_dup_inds: print inds, A[inds]
# >> [3 4 5] [4 4 4]
# >> [7 8] [6 6] 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-04-22T13:56:17.140

```
>>> import numpy as np

>>> a=np.array([1,2,2,2,2,3])

>>> uniques, uniq_idx, counts = np.unique(a,return_index=True,return_counts=True)
>>> duplicates = a[ uniq_idx[counts>=2] ]  # <--- Get duplicates 
```

如果您还想获得孤儿：

```
>>> orphans = a[ uniq_idx[counts==1] ] 
```

# android - 如何移动具有透明背景的 SurfaceView？

> ID：11528081
> 
> 赞同：1
> 
> 时间：2012-07-17T17:52:09.340
> 
> 标签：android, transparency, android-relativelayout, surfaceview

我有一个活动类，我想在主要内容之上显示一个带有半透明背景的小型动态内容，这类似于移动覆盖。为此，我使用 SurfaceView 后代。为简单起见，我尝试编写 POC 代码，因此我在表面视图中绘制了一条弧线并旋转它，并在计时器事件上稍微移动。问题是代码可以正常工作，只有在涉及旋转的情况下。当我添加一个移位（x，y）来改变表面视图位置时，它开始以黑色不透明矩形作为背景进行绘制。代码如下：

```
public class AndroidActivity extends Activity
{
  private RelativeLayout layout;
  private OverlayView mOverlay;
  private Handler mHandler = new Handler();
  private Timer timer = new Timer();
  private SurfaceHolder surfaceHolder;
  private int degrees = 0;
  private int x = 100;
  private int y = 200;

  @Override
  protected void onCreate(Bundle b)
  {
    super.onCreate(b);
    setContentView(R.layout.main_view); // inflate main view
    layout = (RelativeLayout) findViewById(R.id.mainview); // get parent layout
    mOverlay = new OverlayView(this);   // create the surface view descendant
    // prepare layout parameters for the surface view
    RelativeLayout.LayoutParams params = new RelativeLayout.LayoutParams(50, 50);
    params.leftMargin = x;
    params.topMargin = y;
    mOverlay.setLayoutParams(params); // apply parameters
    // next 2 lines ensure transparent background mode
    mOverlay.setZOrderOnTop(true);
    mOverlay.getHolder().setFormat(PixelFormat.TRANSLUCENT);
    // add the surface view into the parent layout
    layout.addView(mOverlay);
    // lets start dynamic motion
    timer.schedule(new DebugTimerTask(), 500, 500);
  }

  private class OverlayView extends SurfaceView implements SurfaceHolder.Callback
  {
    private Paint mPaint = new Paint();

    public OverlayView(Context context)
    {
      super(context);
      surfaceHolder = getHolder();
      surfaceHolder.addCallback(this);
    }

    protected void doDraw(Canvas canvas)
    {
      mPaint.setStyle(Paint.Style.FILL_AND_STROKE);
      mPaint.setStrokeWidth(1);
      // will draw semitransparent yellow arc
      mPaint.setColor(Color.YELLOW);
      mPaint.setAlpha(128);
      RectF oval = new RectF(0, 0, +50, +50);
      canvas.drawColor(0, android.graphics.PorterDuff.Mode.CLEAR);
      canvas.drawArc(oval, degrees, 90, true, mPaint);
    }

    @Override
    public void surfaceChanged(SurfaceHolder holder, int format, int width,
    int height)
    {
    }

    @Override
    public void surfaceCreated(SurfaceHolder holder)
    {
      setZOrderOnTop(true);
      holder.setFormat(PixelFormat.TRANSLUCENT);
    }

    @Override
    public void surfaceDestroyed(SurfaceHolder holder)
    {
    }
  }

  private class DebugTimerTask extends TimerTask
  {
    public void run()
    {
      mHandler.post(new Runnable()
      {
        @Override
        public void run()
        {
          degrees += 10; // rotate a bit
          x += 1;        // move a bit
          y += 2;

          Canvas canvas = null;

          // if next lines are commented, code works almost perfectly:
          // rotation of semitransparent arc over content beneath,
          // but I need to move the overlay, so
          // if they are not commented, the overlay's background becomes black

          // variant A: doesn't work
          //RelativeLayout.LayoutParams params = new RelativeLayout.LayoutParams(50, 50);
          //params.leftMargin = x;
          //params.topMargin = y;
          //mOverlay.setLayoutParams(params);

          // variant B: doesn't work
          //mOverlay.layout(x, y, x + 50, y + 50);

          try
          {
            synchronized(surfaceHolder)
            {
              canvas = surfaceHolder.lockCanvas(null);
              if(canvas != null)
              {
                mOverlay.doDraw(canvas);
              }
            }
          }
          finally
          {
            if(canvas != null)
            {
              surfaceHolder.unlockCanvasAndPost(canvas);
            }
          }
        }
      });
    }
  }
} 
```

移动具有透明背景的表面视图的正确方法是什么？

# php - 如何保护多个选择框选项？

> ID：11528096
> 
> 赞同：0
> 
> 时间：2012-07-17T17:53:02.087
> 
> 标签：php, function, drop-down-menu

您是否需要保护多个选择框，因为选项已经设置而不是用户输入？

我使用此功能来保护常规输入：

```
function keepmesafe($input) 
 {
  if(get_magic_quotes_gpc() == true)
    {
     $input = stripslashes($input);
   }
   return htmlspecialchars($input);
} 
```

但是当我在多项选择上使用它时，我收到了这个警告：

> 警告：htmlspecialchars() 期望参数 1 是字符串，数组在 ...

我理解它需要一个字符串但得到一个数组的警告，所以如果你确实需要确保我需要在当前函数中更改什么或有任何人为此提供函数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:28:24.393

就像警告说的那样，您将一个数组发送到一个只接受字符串的函数。您应该将单个字符串发送到函数 htmlspecialchars，或将函数修改为如下内容：

```
 function keepmesafe($input) 
    {
        if(is_array($input))
        {
            foreach($input as $key => $value) 
            {
                $input[$key] = keepmesafe($value); 
            }   
            return $input;
        }

        if(get_magic_quotes_gpc() == true)
        {
            $input = stripslashes($input);
        }

        return htmlspecialchars($input);
    } 
```

[您可以在此处](https://stackoverflow.com/questions/129677/whats-the-best-method-for-sanitizing-user-input-with-php)找到有关用户输入和安全性的更多信息。

# ruby-on-rails-3 - 如何使我的 LESS 变量可用于 Rails 中的所有 CSS 文件？

> ID：11528098
> 
> 赞同：6
> 
> 时间：2012-07-17T17:53:08.977
> 
> 标签：ruby-on-rails-3, twitter-bootstrap, asset-pipeline, less

### 我有的：

在 Rails 3.2.2 中，我有以下样式表：

```
    应用程序/资产/样式表
    |
    |-- application.css 
    |-- bootstrap_and_overrides.css.less
    |
    |-- annotations.css.less
    |-- maps.css.less.erb
    `-- users.css.less.erb

```

前两个或多或少是系统默认的。其他的是我定义我的自定义样式的地方。

所以，`application.css`像往常一样，包括所有其他文件：

```
*= require_self
*= require_tree . 
```

当然`bootstrap_and_overrides.css.less`，还包括 Twitter Bootstrap 以及其他一些自定义的 LESS 变量。

```
@import "twitter/bootstrap/bootstrap";
@import "twitter/bootstrap/responsive";
// other stuff
@brown_text: #332820; 
```

* * *

### 什么不起作用：

现在，在 中`annotations.css.less`，我想使用`@brown_text`，但它给了我：

> `variable @brown_text is undefined`

我认为这是因为没有对`annotations.css.less`定义变量的“主”文件的引用。似乎`annotations.css.less`是先编译的——请注意，我目前处于开发环境中。

那么，我怎样才能使用我的自定义 LESS 变量，并使它们在其他样式表文件中可用？我目前的“修复”是将我所有的自定义样式移到`bootstrap_and_overrides.css.less.erb`中，这看起来一点也不干净。

### 什么*也*不起作用：

只`import`使用 LESS 文件是不可能的，因为它们使用 Rails 的资产路径助手。并且导入 ERB 文件也是不可能的，因为该`@import`语句不会找到该文件，因为它需要一个`.less`后缀。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-17T23:17:45.357

您不需要将 ERB 用于资产路径帮助程序 - 它们实际上已被烘焙到 less-rails gem 中，您可以在此处参考：[https ://github.com/metaskills/less-rails/#helpers](https://github.com/metaskills/less-rails/#helpers)

您应该能够在使用 ERB 的任何地方使用资产路径或资产 URL 来引用资产管道。

鉴于此，最好的方法是：

1.  转换`application.css`为`application.css.less`
2.  删除所有 Sprockets 指令
3.  `@import`目录中的每个单独文件。
4.  从任何具有 .erb 扩展名的文件中删除它，并将 ERB 资产帮助程序更改为 less-rails 资产帮助程序。
5.  确保在*之后*`annotations.css.less`导入——这就是为什么使用它通常不是一个好主意的原因，因为您无法控制文件加载的顺序。按照您现在的方式，annotations.css.less 将在 bootstrap_and_overrides 之前加载 - 在您要使用的变量甚至存在之前。 *`bootstrap_and_overrides``require_tree .`*

 *希望有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T18:59:00.203

twitter-bootstrap-rails 编译的方式是，您需要将其他 LESS 样式表导入覆盖文件。因此，对于附加文件，`annotations.less`：

```
@import "twitter/bootstrap/bootstrap";
@import "twitter/bootstrap/responsive";

//other LESS styles
@import "annotations" 
```

更多信息，请查看这个 gem 在下面使用的 less-rails。*

# excel - 如何从 DataGrid 中拖动行并将它们放到 Excel 中？

> ID：11528100
> 
> 赞同：0
> 
> 时间：2012-07-17T17:53:11.403
> 
> 标签：excel, flash, apache-flex, drag-and-drop, flex3

我希望能够从 Flash 应用程序中的 DataGrid 拖放到 Excel 电子表格中。这可能吗？如果是这样，我该如何实施？

**编辑：**九天没有评论让我相信以下事情之一：

1.  这个问题很容易回答，以至于每个读到它的人都会想，“啊，下一个人会得到它。这个炸玉米饼不会自己吃。”
2.  没有人知道 Microsoft Excel 是什么。
3.  我对 Flash 编码太无能了，以至于每个读到这个问题的人都会因为无法控制的歇斯底里的笑声而中风而死。有点像当一个人暴露在小丑的笑气中时会发生什么。
4.  整个互联网突然完全腾空，创造了一个巨大的数字荒地（显然除了我）。
5.  Adobe 负责其 Twitter 帐户的公关人员最近发布了一些极具攻击性的内容，每个人终于组织起来并成功抵制了一些东西，而没有邀请我参加聚会。

有人想告诉我哪一个是事实吗？

或者也许只是告诉我我想要的是愚蠢/不可能/不值得努力？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:20:47.633

The simple answer is no, it is not possible. Have you ever coded AS4? I spent 6 months coding stupid loops that randomly draw colored lines. It was terrible. Get out while you still can. I was coding some tangents outside by my school when a couple of engineering grads started making trouble. I coded one bad batch and my professor said "You're moving with the retards to coding 101" I hopped on my segway and rode home. I then hung myself.

# c++ - 在 C++ 中保存任何对象的数组？

> ID：11528101
> 
> 赞同：2
> 
> 时间：2012-07-17T17:53:20.157
> 
> 标签：c++, arrays, class, object

有人可以告诉我并提供一个代码示例，说明是否可以在不使用 C++ 继承的情况下创建一个可以容纳任何类型对象的数组？我还没有为它编写任何代码，但例如，如果我有 2 个类：RangedWeap 和 MeleeWeap，有没有办法在不使用继承的情况下将这些对象存储在同一个数组中？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-17T17:54:48.143

如果你想存储对象，**没有**. 这样做的原因是数组将对象存储在连续的内存中，并且每个存储对象的大小都是相同的。这不一定适用于不同的类型。

有一种丑陋的方法来存储`void*`，但那将是存储指针，而不是对象。此外，这将毫无用处，因为所有类型信息都丢失了。您到底如何确定`void*`指向的内容（假设您没有基类）？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T17:56:40.033

[Boost.Any](http://www.boost.org/doc/libs/1_50_0/doc/html/any.html)将启用此功能，但如果您愿意，它（可能？）在后台使用继承。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T17:56:26.977

您将很难区分这两个对象，但鉴于您有办法，您可以使用`union`：

```
struct A
{
    int type;  // to distinguish
    ...
};

struct B
{
    int type;
    ...
};

union AB
{
    int type;
    A a;
    B b;
};

AB array[] = {<whatever>}; 
```

稍后，您必须检查`type`何时访问，以了解是否应该访问`a`或`b`在每个元素中访问。

**注意：**您的对象应该是[POD](https://stackoverflow.com/q/146452/912144)，除非您根据@chris[使用 C++11 。](http://www2.research.att.com/~bs/C++0xFAQ.html#unions)

# sql - 在 OR 条件下仅选择一个结果行

> ID：11528102
> 
> 赞同：0
> 
> 时间：2012-07-17T17:53:20.700
> 
> 标签：sql

我有两张桌子，`table1`和`table2`。

table1 中的数据可能类似于：

```
Col1     col2
----     ----
NULL     NULL 
ABCD     NULL
NULL     DEFG
ABCD     DEFG 
```

现在有另一个表包含相同的两列并包含任何这些数据的所有组合，例如`(null, null)`或`(null, defg)`等。

我需要编写一个查询来获取匹配的行。

`column1`注意：匹配时应优先考虑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:14:01.980

我认为你需要三个连接。您没有指定要执行的操作，因此以下查询仅指定匹配类型：

```
select table1.*,
       (case when fullmatch.col1 is not null and fullmatch.col2 is not null
             then 'FullMatch'
             when halfmatch1.col1 is not null
             then 'HalfMatch1'
             when halfmatch2.col2 is not null
             then 'HalfMatch2'
             else 'NoMatch'
        end) as MatchType
from table1 left outer join
     table2 fullmatch
     on table1.col1 = fullmatch.col1 and
        table1.col2 = fullmatch.col2 left outer join
     table2 halfmatch1
     on table1.col1 = halfmatch.col1 and
        halfmatch.col1 is null left outer join
     table2 halfmatch2
     on table1.col2 = halfmatch.col2 and
        halfmatch.col2 is null 
```

# php - 按出现次数对 PHP 数组进行排序

> ID：11528104
> 
> 赞同：4
> 
> 时间：2012-07-17T17:53:24.747
> 
> 标签：php, arrays

简而言之，我想按每个成员出现的次数来排序一个数组，然后删除重复项。

所以这：

```
$array = array('s', 'h', 'c', 'b', 'a', 'b', 'd', 'e', 'f', 'f', 'g') 
```

将首先订购：

```
('b', 'b', 'f', 'f', 's', 'h', 'c', 'a', 'd', 'e', 'g') 
```

然后删除重复项：

```
$array = array_unique($array); 
```

看起来像这样：

```
('b', 'f', 's', 'h', 'c', 'a', 'd', 'e', 'g') 
```

那么，我该怎么做呢？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T18:07:59.113

一种快速的方法是构建一个数组/映射，计算原始数组中每个字母/条目的每个实例，对计数的一个进行排序，然后从排序列表中获取唯一值（按顺序）。

一个示例实现是：

```
<?php
$unsorted = array('a', 'b', 'c', 'b', 'd', 'e', 'f', 'f', 'g');

// build an array that "counts" each instance/entry
$count = array();
foreach ($unsorted as $key) {
    if (!isset($count[$key])) $count[$key] = 0;
    $count[$key]++;
}
// sort the counted array in reverse order (to be "descending")
arsort($count, SORT_NUMERIC);

// copy each of the keys of `$count`, in-order, into a new array
$sorted = array();
foreach ($count as $key=>$count) $sorted[] = $key;

print_r($sorted);
?> 
```

这给出了输出：

```
Array( [0] => f [1] => b [2] => e [3] => g [4] => d [5] => c [6] => a ) 
```

这不会保留它首先看到的字母的顺序，它实际上只是根据它们在原始数组中的次数对它们进行排序。它可以用额外的逻辑进行修改，以添加一些其他的排序功能，比如在按实例排序后按字母顺序排序。

**编辑：**使用的函数`array_count_values()`，例如`$count = array_count_values($unsorted)`，可以从上面替换整个“计数”循环。该函数的输出与我的循环产生的完全相同。感谢@Ana 的提示！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-17T18:14:36.383

接受的答案并不理想，实际上是不正确的，因为它不保留键/值对或导致 OP 发布的输出。更简单的方法如下：

```
function sortAndUnique($array)
{
  arsort($array);
  $array = array_count_values($array);
  arsort($array, SORT_NUMERIC);
  return $array;
} 
```

这首先按字母顺序排列数组，然后按最常出现的值排序，然后按数字对这些值进行排序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T17:56:58.623

我建议先计算它的字数，然后根据项目数重建一个数组。

编辑：以下基本片段可能对您有用。它可以满足您的要求，尽管我会质疑使用低效创建与最终循环一样多的数组来处理琐碎情况以外的任何事情。

```
$array = array('cat', 'dog', 'fish', 'fish');
$counts = array();
foreach ($array as $v)
{
    $counts[$v]++;
}
arsort($counts);
$array = array();
foreach ($counts as $k => $v)
{
    // $array = array_merge($array, array_fill(0, $v, $k));
    // ok, remove duplicates
    $array[] = $v;
}
print_r($array); 
```

编辑2：哇，其他答案和我的看起来很相似！我想我需要不那么慢

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-17T18:07:48.580

您可以尝试使用[array_count_values](http://php.net/manual/en/function.array-count-values.php)，然后对返回的数组进行排序（使用[asort](http://www.php.net/manual/en/function.asort.php)），然后将键提取到另一个数组中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-17T18:01:23.633

在删除唯一值之前使用相同的[usort](http://php.net/manual/en/function.usort.php)函数....

# c++ - 使用 OpenCV 2.4.1 显示视频

> ID：11528111
> 
> 赞同：0
> 
> 时间：2012-07-17T17:54:08.490
> 
> 标签：c++, opencv

嗨，我尝试使用 opencv 2.4.1 中的以下基本命令使用网络摄像头显示视频：-

```
int main()

{ cv::Mat san;

  cv::VideoCapture san_cap(0);

  while(1)
  {
    san_cap.read(san);

    cv::imshow("gp",san);

    if(cv::waitKey(0) >=0)

      break;
  }

   return 1;

  } 
```

在编译期间我没有收到任何错误但是在运行我的解决方案时我的输出视频卡在一个固定的帧上并且在我的控制台中我遇到了以下错误：-

**VIDIOC_QUERYMENU：无效参数**

逐行调试我的代码我发现我在这个特定的行中遇到错误

```
if(cv::waitKey(0) >= 0) 
```

这行有什么错误？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T09:39:30.237

我不知道你想用这个做什么，`cv::waitKey()`但我认为如果你把它改成这个，你的例子应该可以工作。如前所述，waitKey 应设置为 10 之类的值，并且您应始终检查 videoCapture 是否实际打开。如果无法打开，则说明您的硬件/驱动程序/os/OpenCV 安装有问题。

```
int main() {

    int waitKeyValue = 10;
    cv::Mat san;

    cv::VideoCapture san_cap(0);
    if (san_cap.isOpened()) {
        while (1) {
            san_cap.read(san);
            cv::imshow("gp", san);
            int key = cv::waitKey(waitKeyValue);
            if(key!=-1)cout<<key<<endl;
            if (key == 27 || key == 1048586) {
                if (waitKeyValue == 10)waitKeyValue = 0;
                else waitKeyValue = 10;
            }
        }
    } else cout << "videoCapture not working" << endl;
    return 1;

} 
```

# php - AJAX：如何在数据中发送反斜杠？

> ID：11528112
> 
> 赞同：2
> 
> 时间：2012-07-17T17:54:10.323
> 
> 标签：php, javascript, ajax, backslash, slash

我正在尝试通过 ajax 发送 php 代码以便将其保存在文件中。但是当我发送类似的东西时：

```
...$buffer = "if(\$_POST){".chr(13).chr(10);... 
```

反斜杠消失了！

这是我正在使用的代码：

```
$.post('save.php', {
            "c":  window[currentCode].getValue(),
            processData: false,
            "f": fileName
        }, function(data){
           ....
        });
        return false;
} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T17:58:17.427

```
"if(\\\$_POST){" 
```

前面还有两个反斜杠。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T18:00:11.827

这不是 Ajax 问题。你误解了逃避。在 PHP 中，`"\$"`计算结果为字符串`$`，因为反斜杠仅具有转义功能（`$`如果您在浏览器中打开 save.php，您也会看到）。要写字面量`\$`，你首先需要写`\`字符串（但反斜杠也必须被转义，所以我们有`"\\"`，然后写成`$`。`"\$"`所以这样做

```
$buffer = "...\\\$_POST..."; 
```

产生预期的结果。

另见[http://www.php.net/manual/en/language.types.string.php#language.types.string.syntax.double](http://www.php.net/manual/en/language.types.string.php#language.types.string.syntax.double)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T19:05:53.957

当我需要在 javascript 中使用正则表达式编辑文件时，我仍然遇到问题，如下所示：

```
function _basename(path) {
    return path.replace(/\\\\/g,'/').replace( /.*\\//, '' );
}

Uncaught SyntaxError: Unexpected token , 
```

我用来编辑 .php 文件的函数损坏了我的 javascript 代码。我需要一种编辑代码的方法，可以用于所有语言。

编辑：我只是在Linux服务器中而不是在Windows中遇到这个问题

请帮忙！

# entity-framework - 每个类型继承的实体框架表，带有 PK->FK，而不是 PK->PK

> ID：11528113
> 
> 赞同：1
> 
> 时间：2012-07-17T17:54:15.193
> 
> 标签：entity-framework, entity-framework-4.1

我必须为设计不佳的数据库创建一个实体框架模型。数据库使用每个类型继承的表，但它使用 PK->FK 关系，而不是 PK->PK 关系。例如

```
Person
   PersonID (PK)
   Name

Employee
   EmployeeID (PK)
   PersonID (FK)
   DateStarted

HourlyEmployee
   HourlyEmployeeID (PK)
   EmployeeID (FK)
   HourlyRate 
```

显然这只是设计得很糟糕，但我无法改变它。实体框架中按类型继承的表本质上希望 EmployeeID 不存在，并且 Employee 的 PK 为 PersonID。是否可以为此数据库创建模型，或者我是否选择其他工具？有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T18:14:59.137

如果模型存在，您可以从数据库创建模型，但它可能不是您所期望的。EF 有时不能很好地处理奇怪的数据库结构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T18:30:35.253

您不会将此映射为 TPT 继承，因为您的数据库的配置方式不允许您欺骗 EF。

如果`Employee.EmployeeID`在数据库中自动生成并且`Employee.PersonID`是唯一的（必须在数据库中强制执行唯一性），您应该能够（未经测试）通过简单的映射来欺骗 EF：

```
public Employee : Person {
    public DateTime DateStarted { get; set; }
} 
```

此类将告诉 EF`Employee`从 Person ( ) 继承密钥，`PersonID`并且您将从 EF 隐藏真正的密钥 - 如果真正的密钥是自动生成的，这应该可以工作。

问题是您的下一级继承打破了这种模式。要完成这项工作，您`HourlyEmployee`将不得不参考`PersonID`- 不是`EmployeeID`。EF 现在不知道`EmployeeID`存在，所以它甚至无法映射关系`HourlyEmployee`。

代码中的 TPT 继承首先有一个额外的限制 - PK 列在所有表中必须具有相同的名称。

# magento - Magento reindex 不填充 solr 搜索

> ID：11528114
> 
> 赞同：1
> 
> 时间：2012-07-17T17:54:21.283
> 
> 标签：magento, search, solr

我们将 solr 安装为一个 tomcat 应用程序。使用带有示例数据的默认安装 EE magento，一切运行完美。

然而，我们的几个商店运行索引并没有触及 /solr/data 文件夹。通常，当调用重新索引时，/data 中的所有文件都会被清除并重新填充。但是，在实时站点上，这不会发生。

我已经取消了很多扩展并再次运行索引..这次重新创建了文件，但几乎没有捕获任何数据......尽管数据库更大，但甚至比示例存储还要少。

关于我们应该在哪里寻找的任何线索？

# game-engine - 电晕会启用社交游戏吗？我可以集成谷歌分析吗？

> ID：11528118
> 
> 赞同：0
> 
> 时间：2012-07-17T17:54:40.097
> 
> 标签：game-engine, coronasdk

我正在考虑开始学习电晕开发，我正在构建的东西需要有一个服务器端（heroku/parse 或其他东西），我可以用电晕来做吗？我可以集成任何其他 SDK 吗？它支持谷歌分析吗？

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T17:37:26.000

你可以用 Corona 做很多服务器端的事情——autoLAN 和 GameMinion 都是第三方插件的很好的例子，它们可以让 Corona 中的社交游戏更容易，尽管它们不一定是你会使用的，看看它们会给你一个好主意什么是可能的。

对于 Google Analytics，根据您希望跟踪的内容，您可能最好考虑使用 Flurry 之类的东西。

# c# - C#中SQL的转义字符

> ID：11528122
> 
> 赞同：2
> 
> 时间：2012-07-17T17:54:54.607
> 
> 标签：c#, .net

我想在我的 C# 代码中添加一个简单的选择语句。示例如下所示。fname 中的 y 等值来自一个参数。//从 myTable 中选择 lname 其中 fname = 'y'

这就是我正在做的事情。我显然得到了 Sql 异常。我该如何纠正？谢谢。

```
string strOrdersOrigSQL = "SELECT LastName FROM Employees";
// Concatenate the default SQL statement with the "Where" clause and add an OrderBy clause
       strOrdersSQL = strOrdersOrigSQL + "where FirstName ="+ 'strFname'; 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-17T17:56:26.307

你永远不应该手动连接 sql 命令。使用类[SqlCommand](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.aspx)并添加参数

```
using (var cmd = new SqlCommand("SELECT LastName FROM Employees where FirstName = @firstName", conn))
{
   cmd.Parameters.AddWithValue("@firstName", strFname);
   var reader = cmd.ExecuteReader();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-17T17:59:32.880

您的查询的其他一些问题是您缺少空格并且引号位于字符串文字中：

```
strOrdersSQL = strOrdersOrigSQL + " where FirstName = '"+ strFname + "'";
//                                 ^                  ^               ^ 
```

但是如果变量包含引号字符或反斜杠，这仍然不起作用。

**您应该使用参数化查询**，而不是试图转义字符串。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-17T18:01:07.143

从 C# 传递时，您无需担心在 Sql 中转义字符

Sql 为你做

所有你需要做的就是：

```
string strOrdersOrigSQL = "SELECT LastName FROM Employees Where  FirstName = @FirstName" 
```

Nwo 您可以通过 SqlParameter 传递 @FirstName 的值，这将保护您的查询免受 Sql 注入

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-17T17:59:05.963

但它可以这样做

```
string strOrdersOrigSQL = "SELECT LastName FROM Employees";
// Concatenate the default SQL statement with the "Where" clause and add an OrderBy clause
       strOrdersSQL = strOrdersOrigSQL + " where FirstName ='"+ strFname + "'"; 
```

这不是正确的做法，因为它可能会受到 SQL 注入的影响。请改用参数化查询。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-17T17:59:02.437

首先，使用SqlCommand。但是如果选择直接写SQL，只要对输入进行转义就可以了。你应该非常小心，并且知道你在做什么。否则，您的代码会显示[SQL Injection](http://en.wikipedia.org/wiki/SQL_injection)。这是正确的代码：

```
string strOrdersOrigSQL = "SELECT LastName FROM Employees ";
// Concatenate the default SQL statement with the "Where" clause and add an OrderBy clause
strOrdersSQL = strOrdersOrigSQL + "where FirstName = '" + strFname.Replace("'", "''") + "'"; 
```

假设 strFname 是一个变量。

# c++ - 我的标准差程序的输出问题

> ID：11528123
> 
> 赞同：2
> 
> 时间：2012-07-17T17:54:58.493
> 
> 标签：c++, visual-studio-2010

我为家庭作业制作的程序存在严重的输出问题。下面是我用来计算用户给出的一组数字的平均值和标准差的代码，直到达到标志值 -1。我不允许使用数组。我应该使用我的教授给出的公式（用于标准开发部分），即 ((sum (xi)^n) - ((sum xi) ^2/ n) /(n-1)) xi is x sub i，即每个输入。我在我的 macbook pro 上的 win7 x64 vm 上使用 Visual Studio 2010（怀疑这有什么关系，但以防万一）。

下面是代码（后跟错误的屏幕截图）

```
#include<iostream>
#include <cmath>
using namespace std;

int i;

int sum_unkown_vars();
double std_dev(int sum, int n);

/*double std_dev(int sum, int n)
{
double dev;

dev = sqrt(((pow(sum, 2.0)-(pow(sum, 2.0)/n)))/(n-1));

return dev;
}*/

int sum_unkown_vars()
{
i = 0;
int n;
int sum1 = 0;
int sum_sqd = 0;
double sdev;

cout<<"This part will sum variables given by user until flag value of -1"<<endl;

cout<<"\nNext Variable Please: ";
cin >> n;
while(n != -1)
{

    sum_sqd = sum_sqd + n*n;
    sum1 = sum1 + n;
    i++;
    cout<<"\nNext Variable Please: ";
    cin >> n;
}

cout <<"\nNumber of variables is "<< i <<endl
    <<"Sum of variables is "<< sum1 <<endl;

sdev = sqrt(((sum_sqd*1.0)-(1.0*pow(sum1, 2.0)/n))/(n*1.0-1.0));

cout <<"\nStandard Deviation is "<< sdev << endl;

return sum1;
}

int main()
{
int sum = 0;
int j;
double avg;
double std_dev1;

cout<<"This program will take integers given by the user,"
    <<"\nsum them, then find average and standard deviation\n\n";

sum = sum_unkown_vars();

//cout <<"\nPlease enter number of integers previously given: ";
//cin >> j;

avg = sum / (i*1.0);

cout <<"\nAverage is: "<<avg<<endl;

//std_dev1 = std_dev(sum, i);

//cout <<"Standard Deviation is : "<< std_dev1 <<endl;

system("pause");
return 0;

} 
```

[![屏幕截图](../Images/e3ecece4f2f84c2d780acff7e2e8b541.png)](https://imgur.com/bWeE5)

提前感谢您收到的任何帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:13:44.927

公式中的变量 n

```
((sum (xi)^n) - ((sum xi) ^2/ n) /(n-1)) 
```

和函数中的变量'n'

```
sum_unkown_vars() 
```

不一样。公式中的 n 表示元素的数量，这由程序中的变量“i”定义。请先纠正这一点。

此外，变量的数量应该是 i+1，或者你应该在初始读数之后增加 i。

我认为代码中还有更多错误。例如，您不返回函数的标准偏差，您使用整数返回标准偏差等。请使用调试器自行调试其余部分。请对这些值做出预期并在调试器中进行交叉检查。

# android - 是否可以将加速度计和数字罗盘结合起来获得一个好的陀螺仪？

> ID：11528124
> 
> 赞同：0
> 
> 时间：2012-07-17T17:55:01.917
> 
> 标签：android, accelerometer, compass-geolocation, gyroscope

我想做一个需要使用陀螺仪传感器的应用

然而，由于廉价的安卓手机没有提供这种传感器，但它本身仍然有加速度计和数字罗盘。

据我所知.. 因为，加速度计可以检测到我们手机的 3 轴。与陀螺仪相比，他们唯一缺乏的是他们无法检测到用户是否在不改变姿势的情况下旋转手机。这就是为什么我需要使用数字罗盘来获取北方来解决这个问题。

那么，我想知道是否可以只使用这两个传感器来使陀螺仪传感器像工作一样工作？有人试过吗？它真的有效吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T18:19:36.997

目前尚不清楚*为什么*您的应用需要陀螺仪。我假设您想跟踪手机的方向。

您可以使用加速度计、指南针和低通滤波器很好地跟踪手机的方向。它有点滞后，但它有效，我已经为 Shimmer 平台实现了这一点。另请参阅[我在此处的回答](https://stackoverflow.com/a/5541875/341970)以及演示视频的链接。

# authorize.net - Authorize.Net AIM 行项目和描述有什么区别

> ID：11528129
> 
> 赞同：1
> 
> 时间：2012-07-17T17:55:19.543
> 
> 标签：authorize.net

我不确定`description`和之间有什么区别`lineitem`。订单项是否是以逗号分隔的已购买产品列表？我想知道变量最大长度和数据类型。此外，想知道用户信用卡对帐单、描述或订单项中出现的字段。找不到任何好的文档。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T03:26:14.423

描述是您对交易的描述。它可以是“首次订阅付款”或“交易 #123456 退款”之类的内容。它最多可包含 255 个字符（无符号）。有关详细信息，请参阅[AIM 指南的第 24 页。](http://www.authorize.net/support/AIM_guide.pdf)

行项目用于添加用户购买的每个项目或服务。这包括名称、价格、数量等。这基本上是为了让您记录购买的目的。订单项具有以下格式：

```
x_line_item
Optional
Value: Any string 
Format: Line item values must be delimited by a bracketed pipe <|>
Itemized order information

Item ID<|> 
The ID assigned to an item. 
Format: Up to 31 characters

<|>item name<|>
A short description of an item. 
Format: Up to 31 characters

<|>item description<|>
A detailed description of an item. 
Format: Up to 255 characters 

<|>itemX quantity<|>
The quantity of an item. 
Format: Up to two decimal places
Must be a positive number

<|>item price (unit cost)<|>
Cost of an item per unit, excluding tax, freight, and duty.
Format: Up to two decimal places
Must be a positive number
 The dollar sign ($) is not allowed when submitting delimited information.

<|>itemX 
taxable
Indicates whether the item is subject to tax.
Format: TRUE, FALSE, T, F, YES, NO, Y, N, 1, 0 
```

处理交易或出现在客户的信用卡对帐单上都不需要。两者的存在都是为了让您在 Authorize.Net 帐户中更好地组织交易。

# javascript - 我升级了 Knockout.js，现在我的模板坏了

> ID：11528131
> 
> 赞同：1
> 
> 时间：2012-07-17T17:55:24.257
> 
> 标签：javascript, knockout.js

我在我的项目中将 knockout.js 从 1.2 升级到 2.1。我正在使用一些基本模板，它们似乎被破坏了。我包括 jQuery.tmpl.js 和 knockout-2.1.0.js。希望得到一个快速的答复。

```
<ul data-bind="template: {name:'addressesTemplate', foreach:addresses}"></ul>

<button data-bind="click: addAddress">Add Address</button>

<button data-bind="click: save">Save Account</button>

<script id="addressesTemplate" type="text/html">
    <li>
    Address Type: <input data-bind="value: addressType"/><br/>
    Address Line 1: <input data-bind="value: addressLine1"/><br/>
    Address Line 2: <input data-bind="value: addressLine2"/><br/>
    City: <input data-bind="value: city"/><br/>
    State: <input data-bind="value: state"/><br/>
    Country: <input data-bind="value: country"/><br/>
    Zip Code: <input data-bind="value: zipCode"/><br/>
    <button data-bind="click: remove">Remove</button>
    </li>
</script>
<script type="text/javascript">

   function addressModel(id) {
        return {
            id: id,
            addressType: ko.observable(),
            addressLine1: ko.observable(),
            addressLine2: ko.observable(),
            city: ko.observableArray(),
            state: ko.observableArray(),
            country: ko.observableArray(),
            zipCode: ko.observableArray(),

            remove: function () {
                viewModel.addresses.remove(this);
            }

        };
    }

    var viewModel = {
        id : 0,
        username: ko.observable(""),
        addresses: ko.observableArray([]),
        addAddress: function () {
            this.addresses.push(new addressModel(""));
        },

        save: function () {
            alert(ko.toJSON(this));
            $.ajax({
                url: "/account/Save",
                type: "post",
                data: ko.toJSON(this),
                contentType: "application/json",
                success: function(result) {alert(result.message) },
                failure: function(result) { alert('fail') }
            });
        }

    };

    ko.applyBindings(viewModel);

</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:46:49.163

由于删除 jquery.tmpl 做到了，我将其添加为答案。但是为了增加价值，这里是你的 viewModel 与 remove 功能移动到 viewmodel （和[小提琴](http://jsfiddle.net/tyrsius/R3eDR/2/)）

```
function addressModel(id) {
    return {
        id: id,
        addressType: ko.observable(),
        addressLine1: ko.observable(),
        addressLine2: ko.observable(),
        city: ko.observableArray(),
        state: ko.observableArray(),
        country: ko.observableArray(),
        zipCode: ko.observableArray()
    };
}

var ViewModel = function() {
    var self = this;
    this.id = 0;
    self.username=  ko.observable("");
    self.addresses= ko.observableArray([]);
    self.addAddress= function() {
        self.addresses.push(new addressModel(""));
    };
    self.removeAddress = function(address) {
        self.addresses.remove(address);
    };
}; 
```

和新的`button`绑定：

```
<button data-bind="click: $parent.removeAddress">Remove</button> 
```

# javascript - 在不使用任何全局变量的情况下确定窗口是否已加载

> ID：11528132
> 
> 赞同：16
> 
> 时间：2012-07-17T17:55:25.167
> 
> 标签：javascript, events, load

我需要确定窗口是否已加载。

我想根据我调用它的时间创建一个`checkLoaded`返回`true`或指示这一点的函数。`false`

```
<html>
<head>
  function checkLoaded(){
    //alert true if window is loaded or alert false
  }
</head>
<body onload="checkLoaded()"> <!-- This should alert true -->
   Loding window.
   <script>
       checkLoaded();// this should alert false;
   </script>
</body>
</html> 
```

我不想使用在窗口加载时设置的全局变量。

有什么方法可以检查`window`对象的状态，也许是属性？

我不想使用 jQuery 或任何其他外部库。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-07-18T14:00:16.433

您可以使用该`document.readyState`属性来检查文档是否已加载而无需侦听任何事件。它将被设置为`"complete"`检查文档和所有子资源是否已加载。（这对应于`load`事件。）

```
function checkLoaded() {
  return document.readyState === "complete";
} 
```

如果只想查看文档是否加载完毕，不用担心子资源，也可以查看属性是否为`"interactive"`.

```
function checkLoaded() {
  return document.readyState === "complete" || document.readyState === "interactive";
} 
```

这应该适用于当前浏览器，但不支持所有旧版本的浏览器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T18:01:55.983

您有 2 个可用的事件：

```
addListener(document, "DOMContentLoaded", function(){});  //Dom parsing is finished
addListener(window, "load", function(){}); //loading of all external stuff is done 
```

[你可以在这里](http://ie.microsoft.com/testdrive/HTML5/DOMContentLoaded/Default.html)看到它们的不同

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T17:57:56.483

这将在加载窗口时发出警报：

```
(function(w) {
    //private variable
    var loaded = false;
    w.onload = function() {
        loaded = true;
    };

    w.checkLoaded = function() {
        alert(loaded);
    };
})(window); 
```

您现在可以`checkLoaded()`从应用程序的任何部分调用，它将返回 true 或 false。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T18:55:56.460

也许只是这样的事情：

```
<html>
<script>
  var loaded = false;
  function checkLoaded(){
     alert(window.loaded);
  }
</script>
<body onload="window.loaded = true; checkLoaded()">
   Loading window.
   <script>
       checkLoaded();
   </script>
</body>
</html> 
```

# c++ - 浮点数和科学记数法

> ID：11528142
> 
> 赞同：0
> 
> 时间：2012-07-17T17:56:16.323
> 
> 标签：c++

我正在从包含如下行的文件创建一维和二维数组：

42857000 -923070 0 0 -7887 428570 -546190 -4285700 546190 0 -6.5 -0.15384 6.5 0.15384 0.007 0 0 42857000 360570 0

当我从文件中填充数组时，它们会转换为科学记数法：

42857000 >>>>> 4.2857000e+007 等等！！！

有没有办法阻止这一切？

我的数组定义如下：

```
float aMatrix[DEFROWS][DEFCOLS] = {0.0};
float bMatrix[DEFCOLS] = {0.0}; 
```

这个问题导致我的应用程序崩溃。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T17:57:13.850

我认为这只是使用`cout`. 如果是这种情况，请使用[`std::fixed`](http://en.cppreference.com/w/cpp/io/manip/fixed)：

```
std::cout << std::fixed << whateverNumberCurrentlyInScientific; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T18:17:45.330

读入或发送时会崩溃吗？您使用的是 cout 还是 printf？一种非常常见的崩溃方法是使用带有 %d 的 printf 并向其发送浮点值。

# ruby-on-rails - 保存多个对象和“stringify_keys”错误。需要帮助

> ID：11528143
> 
> 赞同：0
> 
> 时间：2012-07-17T17:56:23.153
> 
> 标签：ruby-on-rails, ruby-on-rails-3

当我尝试保存多个对象时，出现下一个错误：

```
undefined method `stringify_keys' for #<Array...> 
```

关于如何处理它的任何想法？我的输入：

控制器：

```
def create
@course   = Course.find(params[:course_id])
@students = @course.users

@students.each do
 @grade  = @course.grades.build(params[:grade])
end

@grade.each { |a| a.save }
end 
```

_form.html.erb：

```
 <%= form_for ([@course, @grade]) do |f| %>

....

<% @students.each do |a| %>
<tr>
<td><%= a.last_name %><%= a.first_name %>
<%= f.hidden_field :student_id, :value => a.id, :index => @grade.id %></td>
<td><%= f.text_field :grade_evaluation, :index => @grade.id %></td>
<td><%= f.text_field :comment, :index => @grade.id %></td>
</tr>
.... 
```

这给了我下一个参数哈希等级：

```
 {....

 "grade"=>[
 {"student_id"=>"1",
 "grade_evaluation"=>"5",
 "comment"=>"you are an idiot" },

 {"student_id"=>"4",
 "grade_evaluation"=>"5",
 "comment"=>"you too"         }],
 "commit"=>"Create",
 "course_id"=>"3"} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T18:13:22.023

您正在迭代成绩，但不是在这里输入参数：

```
@students.each do
 @grade  = @course.grades.build(params[:grade])
end 
```

（注意，对于每个元素，您传递的是整个数组，而不是数组元素）。

最终这应该看起来像这样（但这不是一个很好的解决方案，但它会解决你的问题）。

```
params[:grade].each do |grade_params|
 grade  = @course.grades.build(grade_params)
end 
```

看看嵌套属性，这绝对是你要找的东西： http: [//api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html](http://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html)

# python - Python 中的评分者间协议（Cohen's Kappa）

> ID：11528150
> 
> 赞同：15
> 
> 时间：2012-07-17T17:56:46.323
> 
> 标签：python, statistics, rating

我有 3 位评分者对 60 个案例的评分。这些在按文档组织的列表中 - 第一个元素指的是第一个文档的评级，第二个文档的第二个，依此类推：

```
rater1 = [-8,-7,8,6,2,-5,...]
rater2 = [-3,-5,3,3,2,-2,...]
rater3 = [-4,-2,1,0,0,-2,...] 
```

Cohen 的 Kappa 是否有 python 实现？我在 numpy 或 scipy 中找不到任何东西，在 stackoverflow 上也找不到任何东西，但也许我错过了？这是一个相当普遍的统计数据，所以我很惊讶我找不到像 Python 这样的语言。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2016-12-07T21:54:41.097

[Cohen 的 kappa](https://en.wikipedia.org/wiki/Cohen's_kappa)是在 scikit-learn 0.17 中引入的：

[sklearn.metrics.cohen_kappa_score（y1，y2，标签=无，权重=无）](http://scikit-learn.org/stable/modules/generated/sklearn.metrics.cohen_kappa_score.html#sklearn.metrics.cohen_kappa_score)

[示例](http://scikit-learn.org/stable/modules/model_evaluation.html#cohen-s-kappa)：

```
from sklearn.metrics import cohen_kappa_score
labeler1 = [2, 0, 2, 2, 0, 1]
labeler2 = [0, 0, 2, 2, 0, 2]
cohen_kappa_score(labeler1, labeler2) 
```

提醒一下，来自 {1}：

[![在此处输入图像描述](../Images/e530f48a353f2283688253f89d57706d.png)](https://i.stack.imgur.com/kYNd6.png)

* * *

参考：

*   {1} Viera、Anthony J. 和 Joanne M. Garrett。“了解观察者间协议：kappa 统计量。” Fam Med 37，没有。5 (2005): 360-363。[https://www.ncbi.nlm.nih.gov/pubmed/15883903](https://www.ncbi.nlm.nih.gov/pubmed/15883903)：

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2017-06-19T06:09:25.910

您也可以使用[nltk.metrics.agreement](http://www.nltk.org/api/nltk.metrics.html)。下面是相同的代码片段

```
from nltk import agreement
rater1 = [1,1,1]
rater2 = [1,1,0]
rater3 = [0,1,1]

taskdata=[[0,str(i),str(rater1[i])] for i in range(0,len(rater1))]+[[1,str(i),str(rater2[i])] for i in range(0,len(rater2))]+[[2,str(i),str(rater3[i])] for i in range(0,len(rater3))]
ratingtask = agreement.AnnotationTask(data=taskdata)
print("kappa " +str(ratingtask.kappa()))
print("fleiss " + str(ratingtask.multi_kappa()))
print("alpha " +str(ratingtask.alpha()))
print("scotts " + str(ratingtask.pi())) 
```

另请参阅[http://courses.washington.edu/cmling/lab7.html](http://courses.washington.edu/cmling/lab7.html)了解其他示例

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-05-07T10:34:12.960

旧问题，但供参考 Kappa 可以在 skll 指标包中找到。

[http://skll.readthedocs.org/en/latest/api/metrics.html#skll.metrics.kappa](http://skll.readthedocs.org/en/latest/api/metrics.html#skll.metrics.kappa)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-11-20T17:22:11.667

为了扩展[Franck Dernoncourt 的答案](https://stackoverflow.com/a/41028077/8500357)并解决 skjerns 评论，这里是为两个以上的评估者创建矩阵的代码：

```
import itertools

from sklearn.metrics import cohen_kappa_score
import numpy as np

# Note that I updated the numbers so all Cohen kappa scores are different.
rater1 = [-8, -7, 8, 6, 2, -5]
rater2 = [-3, -5, 3, 3, 2, -2]
rater3 = [-4, -2, 1, 3, 0, -2]

raters = [rater1, rater2, rater3]

data = np.zeros((len(raters), len(raters)))
# Calculate cohen_kappa_score for every combination of raters
# Combinations are only calculated j -> k, but not k -> j, which are equal
# So not all places in the matrix are filled.
for j, k in list(itertools.combinations(range(len(raters)), r=2)):
    data[j, k] = cohen_kappa_score(raters[j], raters[k])

# [[0\.        , 0.11764706, 0\.        ],
#  [0\.        , 0\.        , 0.25      ],
#  [0\.        , 0\.        , 0\.        ]] 
```

这是一个情节`data`：

```
import seaborn as sns
import matplotlib.pyplot as plt

sns.heatmap(
    data, 
    mask=np.tri(len(raters)),
    annot=True, linewidths=5,
    vmin=0, vmax=1,
    xticklabels=[f"Rater {k + 1}" for k in range(len(raters))],
    yticklabels=[f"Rater {k + 1}" for k in range(len(raters))],
)
plt.show() 
```

[![热图](../Images/6f3369e84278fc2690570c1784b75d49.png)](https://i.stack.imgur.com/PN4hc.png)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-17T18:04:04.450

我还没有发现它包含在任何主要的库中，但是如果你在周围搜索一下，你可以在各种“食谱”类型的网站等上找到实现。以下是实现[Cohen 的 kappa](http://adorio-research.org/wordpress/?p=2301)、[Fleiss 的 kappa](http://en.wikibooks.org/wiki/Algorithm_Implementation/Statistics/Fleiss%27_kappa#Python)和[Krippendorff 的 alpha 的页面](http://cswww.essex.ac.uk/Research/nle/arrau/alpha.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-07-15T18:37:21.247

[statsmodels](http://statsmodels.sourceforge.net/)是一个 Python 库，其中包含 Cohen 的 Kappa 和其他评分者间一致性指标（在 中[`statsmodels.stats.inter_rater`](https://www.statsmodels.org/stable/stats.html?highlight=inter_rater#module-statsmodels.stats.inter_rater)）。

# javascript - CSS 打印方向 - 预览时为横向，但打印时为纵向

> ID：11528153
> 
> 赞同：1
> 
> 时间：2012-07-17T17:56:47.663
> 
> 标签：javascript, css, printing, landscape, portrait

我插入`<style type="text/css"> @page {size: landscape;}</style>`我的页面以横向打印（此页面仅用于打印）。

它在 Chrome 的打印预览中显示为我想要的。但是，在我将它打印到纸质或 PDF 之后，结果真的很奇怪。内容是横向的，但页面是纵向的，所以我在页面的顶部和底部有一个很大的空白区域，并且内容的右侧部分超出了页面边缘。

我的猜测是，由于某种原因，打印机不知道它支持横向方式。我已经尝试了几台打印机，它们都有这个问题。

如果您能给我任何建议或潜在的解决方案，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T20:41:37.843

@page { size: 标签是 CSS3，据我所知 CSS3 仍然不是公认的标准，因此许多新标签尚未被任何浏览器支持。具体而言，截至 2012 年 9 月 12 日，大多数浏览器尚不支持此标签。

[http://en.wikipedia.org/wiki/Comparison_of_layout_engines_%28Cascading_Style_Sheets%29#Grammar_and_rules](http://en.wikipedia.org/wiki/Comparison_of_layout_engines_%28Cascading_Style_Sheets%29#Grammar_and_rules)

上面的 URL 声称 IE8 及更高版本支持它，但到目前为止我没有运气使用它。

# compiler-errors - 如何找出为什么 xlC 返回码不为零？

> ID：11528160
> 
> 赞同：0
> 
> 时间：2012-07-17T17:57:10.403
> 
> 标签：compiler-errors, return-value, compiler-warnings, xlc

[ibm 参考](http://pic.dhe.ibm.com/infocenter/comphelp/v111v131/index.jsp?topic=/com.ibm.xlc111.aix.doc/compiler_ref/ruretcod.html)说，当发生严重级别高于 -qhalt 编译器选项设置的错误时，将生成返回码 1 。我确实使用 -qhalt=s （仅严重错误）和 -qnomaxerr （对错误数量没有限制）进行编译。尽管我成功地获取了我的文件，但编译的 xlC 返回代码是 1，但不是 0。我会接受它，但这会破坏我的 Makefile，因为当它遇到来自编译器的非零错误代码时，make 会停止。

当我编译一个简单的`int main() { return 0; }`程序时，我得到了预期的 0 返回码......

以下是有问题的编译会话的样子：

```
bash-3.1$ xlC -O4 -qstrict -I/adaneyko/src/boost-trunk -c some.h some.cpp -qhalt=s -qnomaxerr
xlC: 1501-218 (W) file some.h contains an incorrect file suffix
bash-3.1$ echo $?
1
bash-3.1$ xlC -qversion
IBM XL C/C++ Advanced Edition for Blue Gene/P, V9.0
Version: 09.00.0000.0010 
```

我不知道那个 1501-218 警告，也无法在 ibm 参考中找到它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T00:22:00.637

1501-218 (W) 文件 some.h 包含不正确的文件后缀

警告消息 1501-218 的意思是它所说的 some.h，文件后缀为“.h”，这对于 xlC 命令的输入文件不是有效的文件后缀。大概“some.h”是一个头文件，它是 some.cpp 中的#include，不需要在 xlC 命令行上列出。

# facebook - 后台应用程序的 Facebook 应用程序身份验证

> ID：11528161
> 
> 赞同：-1
> 
> 时间：2012-07-17T17:57:11.220
> 
> 标签：facebook, facebook-graph-api, authentication

我想知道是否可以构建一个作为后台进程运行的 facebook 应用程序。基本上，我会收集有关用户 Facebook 使用情况的数据，并通过电子邮件向他们发送月度报告。我的问题是，由于 facebook 有一个最长寿命为 60 天的身份验证令牌，这可行吗？我不想让用户每隔一个月访问一个网站只是为了继续使用该应用程序。

在我看来，这类似于 twitter facebook 应用程序。一旦您进行身份验证，如果您不再访问 twitter.com（相反，选择只使用 twitter 客户端），他们如何继续发布到您的 Facebook 帐户？他们的身份验证令牌不会在 60 天后过期吗？有什么我想念的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T18:11:45.737

我相信您必须每隔一段时间进行某种用户交互才能重新进行身份验证。

你的应用程序是在什么平台上构建的，facebook、移动、webapp？

# c++ - 排序提升元组的双端队列

> ID：11528170
> 
> 赞同：5
> 
> 时间：2012-07-17T17:57:57.547
> 
> 标签：c++, sorting, boost, stl, boost-tuples

不确定我是否在某处有一个简单的错字，但我在对元组双端队列进行排序时遇到了问题。

所以，我的双端队列看起来像这样：

```
std::deque<boost::tuple<unsigned int, unsigned int> > messages; 
```

然后我要排序：

```
sort(messages.begin(), messages.end(), msg_sort_criteria); 
```

还有我的排序功能：

```
bool msg_sort_criteria(boost::tuple<unsigned int, unsigned int> lhs, boost::tuple<unsigned int, unsigned int> rhs)
{
  return boost::get<1>(lhs) < boost::get<1>(rhs);
} 
```

发生的情况是我在 stl_heap.h 和 stl_algo.h 中出现错误。例如，

> 调用的对象类型“ `<bound member function type>`”不是函数或函数参数。

* * *

编辑：

为了澄清起见，这一切都发生在类的私有成员中。

```
class Messages::MessageImpl{
private:
  std::deque<boost::tuple<unsigned int, unsigned int> > messages;

  bool msg_sort_criteria(boost::tuple<unsigned int, unsigned int> lhs, boost::tuple<unsigned int, unsigned int> rhs)
  {
    return boost::get<1>(lhs) < boost::get<1>(rhs);
  }

  void fn()
  {
    sort(msg_queue_.begin(), msg_queue_.end(), msg_sort_criteria);
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:09:56.177

^(主要是从评论转发。)

将您的实现更改为：

```
class Messages::MessageImpl{
private:
  std::deque<boost::tuple<unsigned int, unsigned int> > messages;

  static bool msg_sort_criteria(boost::tuple<unsigned int, unsigned int> lhs,
                                boost::tuple<unsigned int, unsigned int> rhs)
  {
    return boost::get<1>(lhs) < boost::get<1>(rhs);
  }

  void fn()
  {
    sort(msg_queue_.begin(), msg_queue_.end(), &MessageImpl::msg_sort_criteria);
  }
}; 
```

# jquery - GMAP3 和自动完成：限制结果？

> ID：11528174
> 
> 赞同：3
> 
> 时间：2012-07-17T17:58:07.553
> 
> 标签：jquery, google-maps, autocomplete, jquery-autocomplete, jquery-gmap3

我正在使用[gMap3 网站](http://gmap3.net/examples/address-lookup.html)上的自动完成功能来创建自动完成搜索。我有它的工作，但是我想将自动完成结果限制在一个州（即密苏里州）。有没有办法做这样的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T22:49:48.207

您可以使用gMap 对象的`region`参数。`address`

```
address: {
    address: address,
    region: 'your region code'
} 
```

这将为您提供更好的结果，但不会删除错误的结果。
我不确定它是否适用于美国各州，或仅适用于整个国家。

我有同样的问题。最后我使用了这个参数，并在我发送到谷歌 API 的每个请求中附加了一个自定义字符串。

在您的情况下，只需将“密苏里州”添加到自动完成中的文本，然后再将其发送到谷歌地理编码器 api。

就像是：

```
$('#element').autocomplete({
    source: function( request, response ) {
        var requestTerm = 'Missouri US' + request.term; 

        $('#gmap').gmap3(
            {action:'getAddress',
                address: {
                    address: requestTerm,
                    region: 'your region code'
            }
        );
    ... 
```

也许不是最优雅的解决方案，但它工作正常。

# java - 使用 Java 以超级用户身份在 Linux 上创建 txt 文件

> ID：11528175
> 
> 赞同：0
> 
> 时间：2012-07-17T17:58:12.223
> 
> 标签：java, linux

我是 Java 和 Linux 的新手。我必须使用 Java 代码在 Linux 上创建一个本地文件。但只有当我以超级用户身份运行时，它才允许我创建文件。

在终端中，如果我运行“vi test.text”，它不允许我写入文件。所以需要以超级用户“sudo vi test.text”运行来创建文件。

如何编写 Java 代码以超级用户身份运行来创建文件？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T18:00:51.943

编写一个 java 应用程序来创建一个文件并使用 sudo 运行该 jar。

```
sudo java -jar filecreater.jar 
```

您运行 java 应用程序的用户应该在您尝试创建文件的文件夹中具有写入权限。

# jquery - jQuery 菜单 - 鼠标悬停

> ID：11528176
> 
> 赞同：0
> 
> 时间：2012-07-17T17:58:13.100
> 
> 标签：jquery, html, css

我正在开发一个 jQuery 菜单。

这是小提琴：http: [//jsfiddle.net/HZxjb/](http://jsfiddle.net/HZxjb/)

我需要的是能够浏览每个子类别。现在，当鼠标在“家”上时，当我想越过“文本 1”时，子类别滑回。我该如何阻止呢？

另外，我希望子类别滑入主类别旁边。因此，如果我的鼠标悬停在“主页”上，子 li 会滑到它旁边。如果我的鼠标在“服务”上，子li会在它旁边滑动，所以“主页”旁边不会有子按钮，因为“服务”在它下面。

此外，如果我快速从一个按钮转到另一个按钮，您会看到子按钮出现在正在返回的按钮下方。如何使这项工作成为一种不会发生的方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:08:00.607

[http://jsfiddle.net/HZxjb/13/](http://jsfiddle.net/HZxjb/13/)

您无需使用`id`. 我给你的是你应该如何建立你的菜单。

我会推荐：

不要在不了解基础知识的情况下开始构建复杂的东西。

例如，下一个代码，无论你怎么看，都是错误的：

```
$(document).ready(function () {
    $(".sub_button_home").hide();
});
$(document).ready(function () {
    $(".sub_button_services").hide();
});
$(document).ready(function () {
    $(".sub_button_products").hide();
}); 
```

您不仅可以通过 CSS（使用`display: none`）执行此操作，还附加了 3 个函数，而不是一个包含所有代码的函数。

我建议阅读 jQuery 的 API 来了解你应该采用的基本结构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T18:13:08.247

在你做任何事情之前，你应该首先构建一些有用的 html。您是如何想到在没有列表的情况下使用列表项的？关于使用表格设计菜单布局的方法，我最好在这一点上什么也不说。

您只需要无序列表即可达到您的目标。谷歌搜索来自 Stu Nichols 的菜单。在那里，您会发现不同菜单的多种可能性。

# mysql - 多个 mySQL 插入的问题

> ID：11528178
> 
> 赞同：0
> 
> 时间：2012-07-17T17:58:23.857
> 
> 标签：mysql, content-management-system, last-insert-id

我正在构建一个简单的 cms，并尝试在用户注册时自动在数据库中创建一个附加项。代码工作得很好，第一个插入行，但是一旦我添加了第二个，它就停止工作了。我从 StackOverflow 获得了这个代码结构，我查看了其他网站，它似乎是正确的，但对于我的生活，我无法弄清楚什么是错的。有什么建议么？

```
$registerquery = mysql_query("BEGIN
INSERT INTO users (Username, Password, EmailAddress) 
VALUES ('".$username."', '".$password."', '".$email."')
INSERT INTO pages (page_title, page_owner) 
VALUES ('My New Page', LAST_INSERT_ID())
COMMIT"); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T18:01:12.683

您不能使用 PHP 中的 MySQL 驱动程序在单个 query() 调用中发出两个查询。[这是针对某些形式的SQL 注入](http://bobby-tables.com)攻击的安全措施- 您的代码容易受到攻击（除非您正在执行 mysql_real_escape_string() 或类似的操作）。

您还缺少 a`;`来分隔两个查询。

多查询语法是

```
query1; query2; query3; etc... 
```

你基本上有

```
query1 query2 
```

这只是一个语法错误。

# database - Oracle 数据库：将模式导出到另一台机器

> ID：11528179
> 
> 赞同：0
> 
> 时间：2012-07-17T17:58:27.340
> 
> 标签：database, oracle

我在服务器上安装了一个 oracle 数据库，我想将一个模式导出到转储文件，但该服务器没有足够的硬盘空间。我可以使用 expdp 导出到另一台机器吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:32:48.047

如果您可以从第二台机器挂载一个卷，那么您可以“本地”导出。你如何做到这一点取决于你的操作系统等。

如果第二台机器已经有一个 Oracle 实例，您可以将其`expdp`与[`network_link`](http://docs.oracle.com/cd/E11882_01/server.112/e22490/dp_export.htm#i1011008)参数一起使用。*这将从*第一台机器而不是第二台机器导出*，*但如果软件可用，那么最终结果应该是相同的，它只是语义......

# css - Chrome Inspector 悬停问题

> ID：11528180
> 
> 赞同：0
> 
> 时间：2012-07-17T17:58:38.627
> 
> 标签：css, google-chrome, hover, inspector

有谁知道如何使用 Chrome 检查器解决此问题：

如果您检查 .outer 并将检查器设置为悬停，然后尝试查看 .inner 的样式，而 .outer 仍悬停，则悬停移动到 .inner。

这是针对此示例 CodePen 的：

[http://codepen.io/rctneil/pen/xCfdB](http://codepen.io/rctneil/pen/xCfdB)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T18:36:02.583

如果您在单击 .inner 之前折叠 Chrome 检查器的“样式”部分，则不会发生这种情况。

# vertica - Vertica/vSQL " 每天选择 10 行，按顺序和特定组

> ID：11528182
> 
> 赞同：0
> 
> 时间：2012-07-17T17:58:43.420
> 
> 标签：vertica

我有 Vertica 数据库，其中包含许多带有日期（时间戳）和更多属性的记录。例如，“testTable”看起来像

```
a varchar(255)
b int
timestamp bigint 
```

我需要在`sum(b)`一段时间内（比如 1 月 1 日到 1 月 15 日）找到每天的前 10 个日期，这些日期可以由用户指定。

迭代查询会是什么样子？粗略的方式可能是介于两者之间的个人`SELECT`陈述`UNION ALL`。

```
select a, sum(b) from testTable where TO_TIMESTAMP( timestamp ) between '2012-01-01 05:10:00' and '2012-01-02 05:10:00' group by a order by sum(b) desc LIMIT 10
UNION ALL
select a, sum(b) from testTable where TO_TIMESTAMP( timestamp ) between '2012-01-02 05:10:00' and '2012-01-03 05:10:00' group by a  order by sum(b) desc LIMIT 10
UNION ALL
select a, sum(b) from testTable where TO_TIMESTAMP( timestamp ) between '2012-01-03 05:10:00' and '2012-01-04 05:10:00' group by a order by sum(b) desc LIMIT 10
..
..
..
UNION ALL
select a, sum(b) from testTable where TO_TIMESTAMP( timestamp ) between '2012-01-14 05:10:00' and '2012-01-15 05:10:00' group by a order by sum(b) desc LIMIT 10 ; 
```

但我希望它更通用，用户可以运行具有两个给定日期的脚本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T14:15:27.250

语法可能有点偏离...我没有要测试的 Vertica。

```
select day, a, tot
from 
   (
   select 
      *,
      ROW_NUMBER() OVER (PARTITION BY tt4.day) as row_number
   from
      (
      select
         ts as day, 
         tt1.a, 
         sum(tt1.b) as tot
      from 
         testTable tt1, 
         ( select distinct date(TO_TIMESTAMP(tt2.timestamp)) as ts
           from   testTable tt2
           where  date(TO_TIMESTAMP(tt2.timestamp)) between cast('2012/01/01' as date) and cast('2012/01/15' as date) ) as tt3
      where 
         date(TO_TIMESTAMP(tt1.timestamp)) = tt3.ts
      group by 
         date(TO_TIMESTAMP(tt1.timestamp)), 
         tt1.a
      order by 
         date(TO_TIMESTAMP(tt1.timestamp)),
         sum(tt1.b) desc,
         tt1.a
      ) as tt4
   ) as tt5
where 
   tt5.row_number <=10 
```

# google-app-engine - 检查数据存储中是否已存在值的最佳方法

> ID：11528185
> 
> 赞同：3
> 
> 时间：2012-07-17T17:58:59.307
> 
> 标签：google-app-engine, python-2.7, datastore

我已经为我使用 Google Datastore 制作的博客制作了注册表单，现在我正在努力让它变得更好。

我看到的第一件事是可以更改的是 Web 应用程序在数据存储中查找用户名的方式，以查看已使用的用户名。

我是这样做的：

```
db.GqlQuery("SELECT * FROM UserData where username = :1", username) 
```

您能否请我参考更好的解决方案，这会更快。

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T18:35:11.513

如果用户名是唯一的，那么您可以将用户名设置为密钥，您可以在其中使用 db.Model.get_by_key_name()

实际上，为了获得更好的性能，请使用 ndb，它会缓存您的实体以获取请求，因此它会更快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T18:01:00.570

而不是 Select * 你可以做 Select username ...

# python - 递归Python超时

> ID：11528186
> 
> 赞同：1
> 
> 时间：2012-07-17T17:59:00.923
> 
> 标签：python, recursion, timeout

我有一个脚本，可以递归地分析链接中的 javascript，所以如果它找到一个 javascript，那么它会分析 javascript，如果它正在分析的 javascript 包含更多的 javascript，那么它会继续运行，依此类推。但是，我遇到了这个递归永远不会停止的问题，有没有办法为这个递归添加超时？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-17T18:10:11.243

Python 有一个内置的递归限制，`RuntimeError`如果超过这个限制，就会引发 a。默认情况下，它的堆栈限制为 1000。所以：

```
try:
    func_that_may_recurse_infinitely()   # i.e., your JavaScript crawler func
except RuntimeError as e:
    if "recursion" in str(e):
        print "stop all the downloadin'!" 
```

`sys.setrecursionlimit()`如果需要更深或更浅，您可以修改初始递归限制。

但是，更好的方法可能是保留`set()`您已经看到的项目，并简单地拒绝处理您已经处理的任何项目。这可以防止您首先陷入递归情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T18:14:08.677

我倾向于同意kindall。但是，如果您确实想限制递归的深度，则可以执行以下操作：

```
def foo(max_depth = 10, cur_depth=0):
    if cur_depth >= max_depth:
        return BASE_CASE

    else:
        return foo(max_depth, cur_depth+1) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-17T18:20:43.563

一个快速而肮脏的解决方案是调用 time.time() 并进行比较。例如，假设您有一个简单的阶乘函数，如下所示：

```
def fact(i):
  if i == 0 or i == 1: return 1
  return i * fact(i-1) 
```

如果您调用 fact(-1)，这将旋转一段时间，然后由于最大递归深度而引发 RuntimeError。

您可以像这样添加超时：

```
import time

def factWithTimeout(i, timeout):
  def fact(i, endtime):
    if time.time() > endtime:
      raise RuntimeError('Timeout')
    if i == 0 or i == 1: return 1
    return i * fact(i-1, endtime)
  return fact(i, time.time() + timeout) 
```

现在，如果您调用`factWithTimeout(-1, 0.0001)`，它只会旋转大约 100us，然后由于超时而退出 RuntimeError。

显然，对于一个如此微不足道的函数，它会在一毫秒内达到递归限制，这并没有太大的不同，但对于一个更现实的函数，这将不是问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-17T18:13:13.630

你可以这样做：

```
import time

start = time.time()
timeout_limit = 30   # 30 seconds, or some other number.

def foo():
    if time.time() > start + timeout_limit:
        return 0

    # insert code here.

    foo() 
```

...如果你不想要全局变量，你可以试试这个：

```
class Foo(object):
    def __init__(self, timeout_limit):
        self.timeout_limit = timeout_limit

    def run(self, ...):
        self.start = time.time()
        self._run(...)

    def _run(self, ...):
        if time.time() > self.start + self.timeout_limit:
            return

        # insert code here.

        self._run(...) 
```

...虽然这可能是矫枉过正。

# javascript - 将部分视图加载到 JQuery 对话框中的缓存问题

> ID：11528196
> 
> 赞同：1
> 
> 时间：2012-07-17T17:59:36.350
> 
> 标签：javascript, jquery, asp.net-mvc, jquery-ui, dialog

想象一个带有“编辑”链接的简单用户列表。单击“编辑”会打开一个对话框，其中包含所选用户的详细信息。“详细信息”弹出窗口是部分视图。

在 JQuery 对话框窗口中打开部分视图时，我遇到了缓存部分视图的问题。

我的部分视图（注意 OutputCache 属性是我试图解决缓存问题的事情之一）：

```
 [HttpGet]
    [OutputCache(NoStore = true, Duration = 0, VaryByParam = "*")]
    public PartialViewResult EditUser(int id)
    {
     var userList = userRepository.GetByRole(id);

     return PartialView("EditUser",userList);
    } 
```

上面的 PartialView 是从以下 Javascript 函数请求和加载的：

```
function editUserOpen(id) {

    $.ajaxSetup({  ///// Another thing I tried to solve caching
        cache: false
    });

    var url = "/User/PartialViewResult/" + id;

    $('#user-wrap').empty().load(url, function () {

    $("#dialog-edit-user").dialog({
        title: "Edit User",
        autoOpen: false,
        height: 300,
        width: 500,
        modal: true
    });

        $('#dialog-edit-user').dialog("open");
    });
} 
```

如上所示，“dialog-edit-user”（连同“dialog-add-user”和“dialog-delete-user”）位于 DOM 中的“user-wrap”Div 内。

功能上一切正常，但是当我打开一个对话框时，取消然后尝试为其他用户打开对话框，直到页面被刷新，对话框将始终包含来自最初显示的对话框的信息。我认为这是一个缓存问题，但我没有办法解决它。

如果可能的话，我想远离 $.ajax({ cache:false; }).html(content) 。在我看来，它比 .load() 慢得多。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-18T01:19:02.717

这是我发现的。

每次使用 .dialog() 初始化 JQuery 对话框时，如上所示，成为弹出窗口的 div 被从 DOM 中取出并移动到页面底部。Dialog Div 不能是另一个 Div 的子级。在我的例子中是：

```
<div id="user-wrap">
  <div id="dialog-edit-user">  /// <--- Jquery dialog div

  </div>
</div> 
```

对话框不能包装在其他 div 中。

第一次单击后，当显示对话框时，JQuery 只是开始在页面底部累积重复的 Div。`$("#").dialog('open')`每次使程序员/用户认为这是一个缓存问题时，都会打开累积重复的最顶层 DIV。

所以解决方案是要么从页面底部删除由 JQuery 创建的 div，要么使用 JQuery /函数`.dialog({close: }`将其移回父包装器 DIV 。`.append()``.appendTo()`

希望这对遇到类似问题的下一个程序员有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T18:05:05.950

向 URL 添加一些随机哈希以保持其唯一性：

```
...
var url = "/User/PartialViewResult/" + id + "?t=" + new Date().getTime();
... 
```

这将始终加载新内容。

# xna-4.0 - 通过 vb.net 在 XNA 4.0 中添加游戏服务

> ID：11528201
> 
> 赞同：1
> 
> 时间：2012-07-17T17:59:51.940
> 
> 标签：xna-4.0

我已经看到了许多解释如何在 C# 中添加游戏服务的示例。它们通常如下所示：

```
this.Services.AddService(typeof(SpriteBatch), spriteBatch); 
```

目前，我将在 vb.net 方面工作，并且不知道足够的 C# 来翻译这个。typeOf 方法似乎需要一个类型和一个对象，并返回一个布尔值。这似乎不是我想要的。有没有人足够了解 C# 和 vb.net 来翻译或填写我所缺少的内容？

# java - 在 android 的资产中打开文本文件给出 NullPointerException

> ID：11528204
> 
> 赞同：1
> 
> 时间：2012-07-17T17:59:58.567
> 
> 标签：java, android, file-io, nullpointerexception

我在 , 的子文件夹中有一些文件`assets`，`/assets/abc/0.txt`或者`/assets/abc/3.txt`我正在使用以下代码。

```
AssetManager mngr = getAssets();
String[] index = null; 
```

`String[] files = mngr.list("abc")`;

```
try {

        InputStreamReader reader = new InputStreamReader(getAssets().open(
                files[0]));
        BufferedReader buffreader = new BufferedReader(reader);
        int c = 0;

        if (reader != null) {
            String line;
            while ((line = buffreader.readLine()) != null) {
                index[c] = line;
                c++;
                System.out.println("Line number " + line);
            }
            reader.close();

        }
    } catch (Exception e) {
        e.printStackTrace();
    } 
```

我不知道为什么这段代码不起作用并给我 NullPointerException。请告诉我此代码是否有任何问题。

**编辑** 我的 logcat 是

```
07-17 23:58:24.023: W/System.err(1135): java.lang.NullPointerException
07-17 23:58:24.023: W/System.err(1135):     at com.example.abc.Main.readFile(Main.java:141)
07-17 23:58:24.023: W/System.err(1135):     at com.example.abc.Main.displayContent(Main.java:55)
07-17 23:58:24.023: W/System.err(1135):     at com.example.abc.Main.onCreate(Main.java:36)
07-17 23:58:24.023: W/System.err(1135):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
07-17 23:58:24.033: W/System.err(1135):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
07-17 23:58:24.033: W/System.err(1135):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
07-17 23:58:24.033: W/System.err(1135):     at android.app.ActivityThread.access$2300(ActivityThread.java:125)
07-17 23:58:24.033: W/System.err(1135):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
07-17 23:58:24.033: W/System.err(1135):     at android.os.Handler.dispatchMessage(Handler.java:99)
07-17 23:58:24.033: W/System.err(1135):     at android.os.Looper.loop(Looper.java:123)
07-17 23:58:24.033: W/System.err(1135):     at android.app.ActivityThread.main(ActivityThread.java:4627)
07-17 23:58:24.033: W/System.err(1135):     at java.lang.reflect.Method.invokeNative(Native Method)
07-17 23:58:24.033: W/System.err(1135):     at java.lang.reflect.Method.invoke(Method.java:521)
07-17 23:58:24.033: W/System.err(1135):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
07-17 23:58:24.033: W/System.err(1135):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
07-17 23:58:24.033: W/System.err(1135):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:04:02.213

如果您没有将除 null 之外的任何内容分配给变量索引，那么 index[c] 至少会导致空指针异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T18:10:24.333

`String[] index = null;`是错误的来源

`index[c] = line;`是 nullPointerException 发生的地方；

在使用它之前，您必须将对象分配给数组。

# regex - Apache2：Mod_rewrite 通配符 text.html

> ID：11528205
> 
> 赞同：0
> 
> 时间：2012-07-17T17:59:59.707
> 
> 标签：regex, mod-rewrite, apache2

我们改变了电子商务供应商，我需要坚持我们所做的一些 SEO。我想为一组页面做一个 301 到一个新的 URL

我有一组以相同的tickets.htm 结尾的页面。因此，例如，我有一个像 /blank_tickets.htm 和 /concert_tickets.htm 这样的页面，并且列表还在继续。

所以我尝试了这个： RewriteRule ^/(.*)tickets.htm$ /t/tickets/types/standard

我尝试了这种无前导/无 $ 等的变体。

我确定我遗漏了一些简单的东西，但我的 Google-fu 没有返回相关示例。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T18:21:18.920

你没有逃脱这个点。利用 \。在 .htm 部分的正则表达式中。

编辑：也使用 [R=301] 标志，或简单地 [R] 来生成 HTTP 301 标头。

# string - 在 COBOL 中查找子字符串的索引

> ID：11528208
> 
> 赞同：3
> 
> 时间：2012-07-17T18:00:14.813
> 
> 标签：string, indexing, substring, cobol

我正在寻找字符串中出现指定子字符串的位置。

例如，在字符串“green eggs and ham”中寻找子字符串“green”应该返回 me 1，但从“green eggs and green ham”中寻找子字符串会返回 1 和 14。

我该怎么做？

编辑 1：更改了措辞，因此位置从 1 开始，而不是 0。编辑 2：我可以在以下代码段中找到第一个实例为 WS-POINTER：

```
 MOVE 1 TO  WS-POINTER

 UNSTRING WS-STRING(1:WS-STRING-LEN)
  DELIMITED BY LT-MY-DELIMITER
  INTO WS-STRING-GARBAGE                             
  WITH POINTER WS-POINTER
 END-UNSTRING 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T04:07:22.873

AFAIK COBOL 没有在字符串中查找字符串位置的语句，因此需要手动完成。但是，COBOL 确实有一个语句可以计算字符串中字符串的出现次数：INSPECT string TALLYING counter FOR ALL search-string

这是一个在 OpenCOBOL 中工作的示例程序（请参阅 OpenCobol.org）：

```
 IDENTIFICATION DIVISION.
   PROGRAM-ID. OCCURRENCES.

   ENVIRONMENT DIVISION.
   INPUT-OUTPUT SECTION.
   FILE-CONTROL.

   DATA DIVISION.
   FILE SECTION.

   WORKING-STORAGE SECTION.
   01  TEST-STRING-1                    PIC X(30)
       VALUE 'green eggs and ham'.
   01  TEST-STRING-2                    PIC X(30)
       VALUE 'green eggs and green ham'.
   01  TEST-STRING                      PIC X(30).
   01  SEARCH-STRING                    PIC X(05)
       VALUE 'green'.
   01  MATCH-COUNT                      PIC 9.
   01  SEARCH-INDEX                     PIC 99.
   01  MATCH-POSITIONS.
       05  MATCH-POS                    PIC 99 OCCURS 9 TIMES.

   PROCEDURE DIVISION.
   MAIN.
       MOVE TEST-STRING-1 TO TEST-STRING
       PERFORM FIND-MATCHES

       MOVE TEST-STRING-2 TO TEST-STRING
       PERFORM FIND-MATCHES

       STOP RUN
       .

   FIND-MATCHES.
       MOVE ZERO TO MATCH-COUNT 
       INSPECT TEST-STRING TALLYING MATCH-COUNT
           FOR ALL SEARCH-STRING.
       DISPLAY 'FOUND ' MATCH-COUNT ' OCCURRENCE(S) OF '
           SEARCH-STRING ' IN:'
       DISPLAY TEST-STRING
       DISPLAY 'MATCHES FOUND AT POSITIONS: ' WITH NO ADVANCING
       PERFORM VARYING SEARCH-INDEX FROM 1 BY 1
           UNTIL SEARCH-INDEX = 30
           IF TEST-STRING (SEARCH-INDEX:5) = SEARCH-STRING
               DISPLAY SEARCH-INDEX ' ' WITH NO ADVANCING
       END-PERFORM
       DISPLAY ' '
       DISPLAY ' '
       . 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T13:09:34.513

您可以在 IBM i 上使用 QCLSCAN

```
 77  QCLSCAN-SRCHLEN          PIC S9(3)     COMP-3\.           
 77  QCLSCAN-STARTPOS         PIC S9(3)     COMP-3\.           
 77  QCLSCAN-PATLEN           PIC S9(3)     COMP-3\.           
 77  QCLSCAN-XLATE            PIC X(01)     VALUE "0".        
 77  QCLSCAN-TRIM             PIC X(01)     VALUE "0".        
 77  QCLSCAN-WILDCARD         PIC X(01)     VALUE LOW-VALUES. 
 77  QCLSCAN-FOUNDPOS         PIC S9(3)     COMP-3\.           
 ...
 ...
     MOVE LENGTH OF WRK-ACCT-NBR TO QCLSCAN-SRCHLEN 
     MOVE     1                  TO QCLSCAN-STARTPOS
     MOVE     9                  TO QCLSCAN-PATLEN  
     MOVE "0"                    TO QCLSCAN-XLATE   
     MOVE "0"                    TO QCLSCAN-TRIM    
     MOVE "?"                    TO QCLSCAN-WILDCARD
     CALL "QCLSCAN" USING  WRK-ACCT-NBR             
                           QCLSCAN-SRCHLEN          
                           QCLSCAN-STARTPOS         
                           EMPLOYEE-SSN-9X          
                           QCLSCAN-PATLEN           
                           QCLSCAN-XLATE            
                           QCLSCAN-TRIM             
                           QCLSCAN-WILDCARD         
                           QCLSCAN-FOUNDPOS         
     IF QCLSCAN-FOUNDPOS > ZERO                     
* Found data in position QCLSCAN-FOUNDPOS
     ELSE
* Found no match
     END-IF 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-18T10:27:58.863

```
MOVE 1 TO  WS-POINTER

UNSTRING WS-STRING(1:WS-STRING-LEN)
 DELIMITED BY LT-MY-DELIMITER
 INTO WS-STRING-GARBAGE                             
 WITH POINTER WS-POINTER
END-UNSTRING 
```

您询问如何将上述内容用于后续字符串。

可以通过两种方式使用 UNSTRING 来获得所需的计数。通过具有多个接收字段和 COUNT-IN 或通过使用 UNSTRING 的多次执行，每次都使用前一个 UNSTRING 的 POINTER 值。

您需要考虑分隔符的长度。但是，您最终会得到“非直观”的代码，每次有人使用它时都必须“理解”这些代码。

相反，它是一个简单的任务，使用“子字符串”处理与 OCCURS DEPENDING ON 或引用修改（接受答案中的方法）。

当 count + length-of-delimiter = max-length-of-string-to-search 时结束搜索，您*必须*确保不会“超出字段末尾”。

# mysql - MySQL 数据库连接和大小

> ID：11528212
> 
> 赞同：0
> 
> 时间：2012-07-17T18:00:24.787
> 
> 标签：mysql, database

我浏览了整个网络，我找到了不同的答案，但有几个具体的问题。

我有一个拥有大约 5400 名活跃会员的网站，有点 Facebook 的感觉。我有 10 个 MySQL 数据库，一个数据库包含一个“users”表和一个“User_stats”表。下一个数据库包含“照片”和“照片评论”等，用于博客、状态更新等。每个数据库中大约有 4-5 个表。我认为最大的表中有大约 250,000 行。

几年前，我将它们分成不同的数据库，因为我的共享主机遇到了限制。我现在有一个虚拟服务器，所以我没有这些限制。

我想知道，当我的代码加载到页面上时，打开一个 MySQL 连接、关闭它、打开一个到另一个数据库、关闭它等是否更好，或者如果我将所有表放入一个数据库中，我会打开页面开头的连接并在底部关闭它。

由于拉取照片、最近的博客条目、用户数据等，加载个人资料页面可能会在页面加载结束时连接到所有 10 个数据库。

我担心扩大规模，并认为如果我将它们全部放在 1 个数据库中，那么它会比打开和关闭这么多连接更容易。

你觉得呢？你有没有什么想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T18:05:14.820

只要所有数据库都托管在同一个 MySql 实例中，单个客户端连接就可以查询任何/所有数据库。

例子：

```
/*Query #1*/
SELECT FirstName, LastName
FROM userdb.users
WHERE UserID = ?

/*Query #2*/
SELECT PhotoName, Height, Width
FROM photodb.photos
WHERE PhotoID = ? 
```

关闭和重新打开每个数据库的连接不是要走的路。

# java - Java - 解决 WindowPeer 警告

> ID：11528214
> 
> 赞同：0
> 
> 时间：2012-07-17T18:00:37.837
> 
> 标签：java, warnings

当我编译下面的java代码时，

```
Window w = c instanceof Window ? (Window) c : SwingUtilities.getWindowAncestor(c);
WindowPeer peer = (WindowPeer) w.getPeer(); 
```

我收到以下警告消息：

```
warning: WindowPeer is internal proprietary API and may be removed in a future release 
```

知道如何解决这个问题吗？我正在使用 JDK 1.6，我也尝试了 1.7。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-24T23:51:50.170

以下是抑制警告的两种方法。但是，不建议抑制警告，警告消息文本会告诉您原因。

方法#1（最简单的）是运行

```
javac -XDignore.symbol.file ... 
```

它将针对 Sun 的内部`rt.jar`而不是面向公众的符号文件编译您的程序`ct.sym`。

方法#2a 是运行

```
javac -XDenableSunApiLintControl -Xlint:-sunapi ... 
```

这仍然会发出“注释”，但不会发出警告。

方法#2b 是通过编写来抑制警告和注释

```
@SuppressWarnings("sunapi") 
```

在源代码中，但这仍然需要您按如下方式运行 javac：

```
javac -XDenableSunApiLintControl ... 
```

# xpages - 根据 xpages 中先前的组合框选择隐藏？

> ID：11528215
> 
> 赞同：0
> 
> 时间：2012-07-17T18:00:41.177
> 
> 标签：xpages

我有 3 个组合框

组合1 组合2 组合3

如果 Combo1 为空白（无选择），则隐藏 combo2。如果 Combo2 为空白，则 Combo3 被隐藏。

如果 Combo1 更改，则 Combo2 空白，如果 Combo2 更改，则 Combo3 空白。

这是因为 Combo2 的选择由 Combo1 决定，而 Combo3 的选择由 Combo2 决定。这一切都运作良好。

如果我更改 Combo1 会发生什么，然后 Combo2 和 Combo3 就像预期的那样被空白，但 Combo3 没有被隐藏。如果我所做的只是再次更改 Combo1，则 Combo3 将被隐藏。这几乎就像我需要 2 个更新事件。

有没有办法解决？

更新

问题似乎在于具有计算选择值的组合框。在下面的示例中，更改 State 会导致 ShowRoom 范围变量为“0”，而更改楼层则将其设置为“1”。计算字段将显示范围变量的当前值。似乎没有触发 State 组合框的 onChange 事件。如果您将城市选择从计算值更改为静态值，那么它可以正常工作。

```
 Not&#160;Working (Computed&#160;Selections)<xp:table style="width:100%" id="tblSurvey2">

    <xp:tr>
        <xp:td style="width:300px">
            <xp:label value="*State" style="width:66.0px" styleClass="FieldLabel" id="label1">
            </xp:label>

        </xp:td>
        <xp:td style="width:745.0px">

            <xp:comboBox id="comboBoxState2" style="width:173.0px">

                <xp:eventHandler event="onchange" submit="true"
                    refreshMode="partial" refreshId="tblSurvey2">
                    <xp:this.action><![CDATA[#{javascript:viewScope.put("ShowRoom2","0");}]]></xp:this.action>
                </xp:eventHandler>

                <xp:selectItem itemLabel="AL"></xp:selectItem>
                <xp:selectItem itemLabel="CA"></xp:selectItem>
                <xp:selectItem itemLabel="NY"></xp:selectItem>
                <xp:selectItem itemLabel="PA"></xp:selectItem>
            </xp:comboBox>
            State =&#160;
            <xp:text escape="true" id="computedField1">
                <xp:this.value><![CDATA[#{javascript:getComponent("comboBoxState2").getValue()}]]></xp:this.value>
            </xp:text>
            &#160;&#160;&#160;Show Room =&#160;
            <xp:text escape="true" id="computedField4">
                <xp:this.value><![CDATA[#{javascript:viewScope.get("ShowRoom2");}]]></xp:this.value>
            </xp:text>
        </xp:td>
    </xp:tr>
    <xp:tr id="tr1">

        <xp:td style="width:300px">
            <xp:label value="*City" style="width:66.0px" styleClass="FieldLabel" id="label2">
            </xp:label>
        </xp:td>
        <xp:td style="width:785.0px">
            <xp:comboBox id="comboBoxCity2" style="width:175.0px">

                <xp:eventHandler event="onclick" submit="true"
                    refreshMode="norefresh" id="eventHandler1">
                </xp:eventHandler>
                <xp:eventHandler event="onchange" submit="true"
                    refreshMode="partial" refreshId="tblSurvey2" id="eventHandler2"></xp:eventHandler>

                <xp:selectItems>
                    <xp:this.value><![CDATA[#{javascript:new Array(getComponent("comboBoxState2").getValue() + " City1", getComponent("comboBoxState2").getValue() + " City2", getComponent("comboBoxState2").getValue() + " City3");}]]></xp:this.value>
                </xp:selectItems>
            </xp:comboBox>
        </xp:td>
    </xp:tr>

    <xp:tr id="tr2">

        <xp:td style="width:300px">
            <xp:label value="*Floor" style="width:66.0px" styleClass="FieldLabel" id="label3">
            </xp:label>
        </xp:td>
        <xp:td style="width:745.0px">
            <xp:comboBox id="comboBoxFloor2" style="width:89.0px">

                <xp:eventHandler event="onclick" submit="true" refreshMode="norefresh" id="eventHandler5">
                </xp:eventHandler>
                <xp:eventHandler event="onchange" submit="true"
                    refreshMode="partial" refreshId="tblSurvey2" id="eventHandler7">
                    <xp:this.action><![CDATA[#{javascript:viewScope.put("ShowRoom2","1");}]]></xp:this.action>
                </xp:eventHandler>

                <xp:selectItem itemLabel="Floor1"></xp:selectItem>
                <xp:selectItem itemLabel="Floor2"></xp:selectItem>
                <xp:selectItem itemLabel="Floor3"></xp:selectItem>
            </xp:comboBox>
        </xp:td>
    </xp:tr>
    <xp:tr id="tr3">
        <xp:this.rendered><![CDATA[#{javascript:viewScope.get("ShowRoom2") == "1";}]]></xp:this.rendered>
        <xp:td>
            <xp:label value="*Room" style="width:66.0px" styleClass="FieldLabel" id="label6">
            </xp:label>
        </xp:td>
        <xp:td>
            <xp:comboBox id="comboBoxRoom2" style="width:89.0px">                   
                <xp:selectItem itemLabel="A"></xp:selectItem>
                <xp:selectItem itemLabel="B"></xp:selectItem>
                <xp:selectItem itemLabel="C"></xp:selectItem>
            </xp:comboBox>
        </xp:td>
    </xp:tr>
  </xp:table>
<xp:br></xp:br>
<xp:br></xp:br> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T20:07:35.170

我想你正在使用部分刷新来做到这一点？所以你有了

```
C1 -> C2/C3
C2 -> C3 
```

由于您只能有一个部分刷新目标，因此您需要将 C2/C3 包装到一个面板中，并将该目标设置为 C1 的部分刷新。还要检查你如何隐藏 C3。您可能希望使用 viewScope 变量来管理状态并将您的可见性依赖于该变量。

更新：您应该将字段**绑定**到 viewScope 变量，而不是设置额外的值。另外：当绑定变量值丢失或与第一个值不匹配时，组合框会显示，但不反映它。因此，在组合框中，您总是需要有一个有意义的第一个值“-请选择|-”是常见的或查找实际的第一个值。在您的情况下，“请选择”是有道理的。您还可以考虑是否真的要隐藏字段（这将成为“神秘肉”导航）或只是更新可能的选择（从下面的示例中删除呈现的属性以查看其工作原理）。

干得好：

```
<xp:view xmlns:xp="http://www.ibm.com/xsp/core">
<xp:table style="width:100%" id="tblSurvey2">
    <xp:tr>
        <xp:td style="width:300px">
            <xp:label value="*State" style="width:66.0px"
                styleClass="FieldLabel" id="label1">
            </xp:label>
        </xp:td>
        <xp:td style="width:745.0px">
            <xp:comboBox id="comboBoxState2" style="width:173.0px"
                value="#{viewScope.selectedState}">
                <xp:eventHandler event="onchange" submit="true"
                    refreshMode="partial" refreshId="tblSurvey2" id="eventHandler2">
                    <xp:this.action><![CDATA[#{javascript:viewScope.selectedCity = "-";
viewScope.selectedFloor = "-";
       viewScope.selectedRoom = "-";}]]></xp:this.action>
                </xp:eventHandler>
                <xp:selectItem itemLabel="-Please select-"
                    itemValue="-" id="selectItem1">
                </xp:selectItem>
                <xp:selectItem itemLabel="AL" itemValue="AL" id="selectItem2"></xp:selectItem>
                <xp:selectItem itemLabel="CA" itemValue="CA" id="selectItem3"></xp:selectItem>
                <xp:selectItem itemLabel="NY" itemValue="NY" id="selectItem4"></xp:selectItem>
                <xp:selectItem itemLabel="PA" itemValue="PA" id="selectItem5"></xp:selectItem>
            </xp:comboBox>

        </xp:td>
    </xp:tr>
    <xp:tr id="tr1" style="background-color:rgb(253,250,227)">
        <xp:this.rendered><![CDATA[#{javascript:viewScope.selectedState && (viewScope.selectedState != "-")}]]></xp:this.rendered>
        <xp:td style="width:300px">
            <xp:label value="*City" styleClass="FieldLabel"
                id="label2">
            </xp:label>
        </xp:td>
        <xp:td style="width:785.0px">
            <xp:comboBox id="comboBoxCity2"
                value="#{viewScope.selectedCity}">
                <xp:eventHandler event="onchange" submit="true"
                    refreshMode="partial" id="eventHandler1" refreshId="tblSurvey2">
                    <xp:this.action><![CDATA[#{javascript:viewScope.selectedFloor = "-";
  viewScope.selectedRoom = "-";}]]></xp:this.action>
                </xp:eventHandler>
                <xp:selectItems id="selectItems1">
                    <xp:this.value><![CDATA[#{javascript:var hasState = viewScope.selectedState && (viewScope.selectedState != "-");
 var result = ["-Please select-|-"];
 var cities = viewScope.selectedState + " " + ["City1","City2","City3"];
 for (var x in cities) {
result.push(cities[x]);
 };
 return hasState ? result : "Please select a state first|-"; 
 }]]></xp:this.value>
                </xp:selectItems>
            </xp:comboBox>
        </xp:td>
    </xp:tr>

    <xp:tr id="tr2">

        <xp:this.rendered><![CDATA[#{javascript:viewScope.selectedCity && (viewScope.selectedCity != "-")}]]></xp:this.rendered>
        <xp:td style="width:300px">
            <xp:label value="*Floor" style="width:66.0px"
                styleClass="FieldLabel" id="label3">
            </xp:label>
        </xp:td>
        <xp:td style="width:745.0px">
            <xp:comboBox id="comboBoxFloor2"
                value="#{viewScope.selectedFloor}">

                <xp:eventHandler event="onchange" submit="true"
                    refreshMode="partial" id="eventHandler5" refreshId="tblSurvey2">
                    <xp:this.action><![CDATA[#{javascript:viewScope.selectedRoom = "-";}]]></xp:this.action>
                </xp:eventHandler>
                <xp:selectItems id="selectItems2">
                    <xp:this.value><![CDATA[#{javascript:var hasCity = viewScope.selectedCity && (viewScope.selectedCity != "-");
  var result = ["-Please select-|-"];
  var floors = viewScope.selectedCity + " " + ["Floor1","Floor2","Floor3"];
  for (var x in floors) {
result.push(floors[x]);
  };
  return hasCity ? result : "Please select a city first|-"; 
  }]]></xp:this.value>
                </xp:selectItems>
            </xp:comboBox>
        </xp:td>
    </xp:tr>
    <xp:tr id="tr3" style="background-color:rgb(253,250,227)">

        <xp:this.rendered><![CDATA[#{javascript:viewScope.selectedFloor && (viewScope.selectedFloor != "-")}]]></xp:this.rendered>
        <xp:td>
            <xp:label value="*Room" style="width:66.0px"
                styleClass="FieldLabel" id="label6">
            </xp:label>
        </xp:td>
        <xp:td>
            <xp:comboBox id="comboBoxRoom2"
                value="#{viewScope.selectedRoom}">
                <xp:selectItems id="selectItems3">
                    <xp:this.value><![CDATA[#{javascript:var hasFloor = viewScope.selectedFloor && (viewScope.selectedFloor != "-");
    var result = ["-Please select-|-"];
    var rooms = viewScope.selectedFloor + " " + ["Room A","Room B","Room C"];
    for (var x in rooms) {
    result.push(rooms[x]);
  };
   return hasFloor ? result : "Please select a floor first|-"; }]]></xp:this.value>
                </xp:selectItems>
                <xp:eventHandler event="onchange" submit="true"
                    refreshMode="partial" refreshId="computedField4" id="eventHandler3">
                </xp:eventHandler>
            </xp:comboBox>
        </xp:td>
    </xp:tr>
    <xp:tr>
        <xp:td>Current variables</xp:td>
        <xp:td>State:
<xp:text escape="true" id="computedField1" value="#{viewScope.selectedState}">
</xp:text>
<xp:br></xp:br>
City:
<xp:text escape="true" id="computedField2" value="#{viewScope.selectedCity}">
</xp:text>
<xp:br></xp:br>
Floor:
<xp:text escape="true" id="computedField3" value="#{viewScope.selectedFloor}">

</xp:text>
<xp:br></xp:br>Room:
<xp:text escape="true" id="computedField4" value="#{viewScope.selectedRoom}">
    </xp:text></xp:td></xp:tr></xp:table></xp:view> 
```

您可以通过将“请选择”移动到它自己的值项中来简化代码，并使用一个函数而不是重复代码，但您明白了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T19:57:09.410

您可以使用一些 javascript 执行多个部分更新。看看这个：

[http://xpageswiki.com/web/youatnotes/wiki-xpages.nsf/dx/Work_with_events_and_partial_or_full_refresh](http://xpageswiki.com/web/youatnotes/wiki-xpages.nsf/dx/Work_with_events_and_partial_or_full_refresh)

# android - Android：停止功能监听点击和恢复

> ID：11528217
> 
> 赞同：2
> 
> 时间：2012-07-17T18:00:41.313
> 
> 标签：android, audio, thread-sleep

我有一个功能`playsounds()`，它基本上一次又一次地播放相同的声音文件，但是`float`每次都有不同的称为“平衡”的值。每次播放后，我希望该功能停止并收听用户点击不同的`Button`. 如果没有点击，则调用下一个播放。

但是，如果用户单击，那么我想记录该余额值。我的问题是，一旦我启动该功能，就无法在两者之间停止它。所以即使我点击，它也不会被注意到。

你能帮我解决这个问题吗？

```
public void playsounds() throws InterruptedException
    { 

    snd.setBalance(0);
    snd.play(table);
    Thread.sleep(2000);
    tv.setText("Pressed at first call ");

    snd.setBalance(0.04f);
    snd.play(table);
    Thread.sleep(2000);
    tv.setText("Pressed at second call ");

    snd.setBalance(0.08f);
    snd.play(table);
    Thread.sleep(2000);
    tv.setText("and so on...");

    snd.setBalance(0.12f);
    snd.play(table);
    Thread.sleep(2000);

    snd.setBalance(0.16f);
    snd.play(table);
    Thread.sleep(2000);

    snd.setBalance(1.0f);
    snd.play(table);
    Thread.sleep(2000);

    snd.setBalance(1.84f);
    snd.play(table);
    Thread.sleep(2000);

    snd.setBalance(1.88f);
    snd.play(table);
    Thread.sleep(2000);

    snd.setBalance(1.92f);
    snd.play(table);
    Thread.sleep(2000);

    snd.setBalance(1.96f);
    snd.play(table);
    Thread.sleep(2000);    

    snd.setBalance(2.0f);
    snd.play(table);
    Thread.sleep(2000);     
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:42:53.390

你需要有效地把你的程序从里到外翻过来，让它完全由事件驱动。

基本上，您有一个计时器和用户作为事件的来源。你有一个变量来保存你当前的任务状态，还有一个你接下来要做什么的待办事项列表。

您从待办事项列表中开始一项操作，并在一段时间内启动一个计时器，直到您接下来在没有用户输入的情况下执行某项操作。

如果您获得用户输入，如果计时器尚未运行其 TimerTask，则您取消计时器。根据用户输入，您可以修改待办事项列表、记录某些内容或设置输出。

如果 TimerTask 在您获得用户输入之前运行，您只需执行列表中的下一件事。

由于 TimerTask 和用户输入发生在不同的线程上，因此您需要一种机制来确保一次只能发生一个。一个简单的解决方案是让它们都调用一个同步的方法来完成真正的工作，提供事件的类型作为参数。另一种想法是设置一个同步的标志寄存器来记录用户输入，然后重新调度计时器，以便 TimerTask 之后立即执行，并让它处理它从标志中发现的用户输入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T18:10:35.057

如果我正确理解您的问题...您可以使用布尔值并在您完成睡眠后检查它吗？

```
public class MyClass implements OnClickListener{

         private boolean buttonClick;

         public void playSounds(){
              //play sound
              // sleep
              if(buttonClick){
                  buttonClick = false;
                  //perform action or return
              }
         }

         public void onClick(){
              buttonClick = true;
         }
    } 
```

如果在主线程上调用 Thread.sleep() 可能不是最佳选择，您将无法获得即时响应。您还可以使函数更小并一遍又一遍地调用它..类似

```
public void playSound(float fValue){
    snd.setBalance(fValue);
    snd.play(table);
    //sleep
} 
```

# java - 使用静态变量调用对象

> ID：11528225
> 
> 赞同：0
> 
> 时间：2012-07-17T18:01:02.883
> 
> 标签：java, class, object

作为我的 IB MYP 个人项目的一部分，我最近开始编写一个 3d 计算机游戏，虽然我知道足够多的 Java，但我在让我的课程协同工作时遇到了麻烦。我要做的是创建一个名为 block 的类，它定义了一个块及其所有属性，然后在每次创建具有唯一属性的单个块时调用块类以获取块的基本描述。我已经尝试过哪些可以使用的扩展，但是我必须为每个唯一块创建一个新的扩展类，并且我尝试过创建一个对象但它不起作用。我所有的搜索都没有结果。这是我的代码：

```
package src;

public class Block {
    //Defines a Block

    double id; //Full = type, decimal = subtype
    String type; //Name/tooltip
    int sound; //Type of sound played on collision
    int light; //Ammount of light given off
    boolean breaks; //Wether the block is breakable
    boolean solid; //Wether the block has collision detection

} 
```

如何在不同的类中多次调用此对象，每次所有值都略有不同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T18:04:10.533

您可以有一个 Block 的构造函数，如下所示：

 `````
public Block(double id, String type, int sound, int light, boolean breaks, boolean solid) {
    this.id = id;
    this.type = type;
    this.sound = sound;
    this.light = light;
    this.breaks = breaks;
    this.solid = solid;
} 
````  `有了这个，您可以根据需要创建任意数量的不同类型的块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T18:06:39.970

**1.**如果值不断变化，最好把这个类**设为 Abstract**。

**2.**然后你可以有一个自定义的**构造函数来不同地初始化每个对象的状态。**

例如：

`public Block(double id, String type, int sound, int light, boolean breaks, boolean solid)`

**3.**拥有**getter 方法**，以便您可以获取变量的值。``

# python - 快速 Tkinter 格式问题

> ID：11528236
> 
> 赞同：1
> 
> 时间：2012-07-17T18:01:29.007
> 
> 标签：python, tkinter

我有一堆这样的框架：

```
 +--+
    |  |
  +-+--+-+
  |      |
+-+------+-+
|          |
+----------+ 
```

但我希望他们是这样的：

```
 +--+
        |  |
    +---+--+
    |      |
+---+------+
|          |
+----------+ 
```

做这个的最好方式是什么？

正在使用 pack 并且无法让他们行为正确。出于某种原因，使用网格根本没有显示它们，我的程序挂起

```
# Main script
root = Tk()
root.geometry('500x500')
for task in TaskList:
    GuiTools.TaskBox.TaskBox(root, task)
root.mainloop() # program hangs from this line, to the point of having to use kill to close it

# Taskbox class
class Taskbox(master, task):
    __init__(self)
        self.TaskFrame = Frame(master, borderwidth=3, relief=RAISED)
         . . .
        Putting stuff in frame
         . . .
        self.TaskFrame.pack() # Gives result 1
        #self.TaskFrame.grid(column=1, sticky='ne') # no display, causes hang 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T18:14:41.320

你几乎拥有它。您在`mainloop`将小部件添加到窗口之前就开始了，这将导致它们在`mainloop`完成之前不会被添加。当主循环完成时，窗口不再可用，因此添加它们将失败。

这是一个快速示例，将 3 帧彼此叠加，就像您想要的那样：

```
import Tkinter

root = Tkinter.Tk()
frame_one = Tkinter.Frame(root, width="50", height="50", borderwidth=3, relief=Tkinter.RAISED)
frame_one.grid(row=0, column=0, sticky=Tkinter.E)

frame_two = Tkinter.Frame(root, width="100", height="100", borderwidth=3, relief=Tkinter.RAISED)
frame_two.grid(row=1, column=0, sticky=Tkinter.E)

frame_three = Tkinter.Frame(root, width="150", height="150", borderwidth=3, relief=Tkinter.RAISED)
frame_three.grid(row=2, column=0, sticky=Tkinter.E)

root.mainloop() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T18:39:24.867

在不知道您首先将什么放入框架的情况下回答这个问题有点棘手。@sc0tt 是正确的，您可能想要使用它`sticky=tk.E`，但是，这可能不足以获得您想要的东西，因为您的框架可能会根据您放入的内容调整自己的大小（除非您这样做`myframe.grid_propagate(False)`）。解决这个问题的方法也是输入`columnspan`关键字。

这是一个愚蠢的循环，它将执行您想要的操作：

```
import Tkinter as tk
root = tk.Tk()
frames = []
for i in range(3):
    f = tk.Frame(root)
    f.grid(row=i, column=0, columnspan=i+1, sticky=tk.E)
    frames.append(f)

#Now, you can add buffer spaces (frames) into the grid at 
# `row=0,column=0`, `row=0,column=1` and `row=1,column=1` if you need it. 

root.mainloop() 
```

这有效地划分了您的网格，如下所示：

```
+----+-----+-----+
|    |     |     |
+----+-----+-----+
|    |           |
+----+-----------+
|                |
+----------------+ 
```

# php - 回声编号计数器 - 删除前导零

> ID：11528245
> 
> 赞同：0
> 
> 时间：2012-07-17T18:01:59.110
> 
> 标签：php, echo, counter

目前，我有一个编号系统，可以带回以下内容：

使用：

```
<?php echo $slide->counter; ?> 
```

**01 02 03 04 05**

我可以在上面的 php 中添加什么来摆脱零，使其显示：

**1 2 3 4 5**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T18:03:42.643

这应该工作...

```
printf('%d', $slide->counter); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T18:03:16.433

```
<?php echo (int)$slider->counter; ?> 
```

# javascript - JavaScript 中的 URI 验证

> ID：11528249
> 
> 赞同：7
> 
> 时间：2012-07-17T18:02:14.047
> 
> 标签：javascript, android-2.1-eclair

什么是仅使用 JavaScript 来验证 URI 在 Android 上工作的可靠方法（不必是正则表达式，是吗？）？

即在Android SDK端的Java中不做检查；它是在使用 JavaScript 的网页中完成的。

编辑：通过“在 Android 上工作”，我的意思是 Android 可以找到一个使用该 URI 响应 Intent 的活动。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T18:15:45.110

Javascript 从来没有像后端那么健壮，但是周围有很多不错的正则表达式。

此处的另一篇文章[尝试使用 JavaScript 验证 URL对此进行了介绍](https://stackoverflow.com/questions/1303872/trying-to-validate-url-using-javascript)

我认为最好的答案如下

有人提到了 Jquery Validation 插件，如果您只想验证 url，这似乎有点过头了，这是插件中的正则表达式行：

```
return this.optional(element) || /^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(value); 
```

这是他们从哪里得到的：[http ://projects.scottsplayground.com/iri/](http://projects.scottsplayground.com/iri/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T16:06:10.050

一个好的 URI 正则表达式（它是 URL 的超集）肯定是[https://github.com/jhermsmeier/uri.regex](https://github.com/jhermsmeier/uri.regex)。不幸的是，它还没有涵盖所有类型的 URI。但是，它适用于 Chrome。

更简单的版本可在[http://jmrware.com/articles/2009/uri_regexp/URI_regex.html](http://jmrware.com/articles/2009/uri_regexp/URI_regex.html)获得。由于多行，我无法在此处包含它。

这里是使用 JUnit 测试用例的分步开发：http: [//timezra.blogspot.de/2010/05/regex-to-validate-uris.html](http://timezra.blogspot.de/2010/05/regex-to-validate-uris.html) 这在这里不起作用“无效的正则表达式：无效组"

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2020-05-04T13:23:48.363

只需尝试调用您的代码：

```
const url = new URL(urlToCheck) 
```

如果给定`urlToCheck`或生成的 URL 不是有效的 URL，
则会引发异常.....然后你就知道了......

看：

[https://javascript.info/url](https://javascript.info/url)

[https://developer.mozilla.org/en-US/docs/Web/API/URL/URL](https://developer.mozilla.org/en-US/docs/Web/API/URL/URL)

# ruby-on-rails - Ruby 正则表达式：区分 iOS Safari 和 iOS Chrome

> ID：11528253
> 
> 赞同：1
> 
> 时间：2012-07-17T18:02:21.970
> 
> 标签：ruby-on-rails, ruby, regex, user-agent

根据以下文档：[https ://developers.google.com/chrome/mobile/docs/user-agent](https://developers.google.com/chrome/mobile/docs/user-agent)

这是适用于 iOS UA 字符串的 Chrome：

```
Mozilla/5.0 (iPhone; U; CPU iPhone OS 5_1_1 like Mac OS X; en) AppleWebKit/534.46.0 (KHTML, like Gecko) CriOS/19.0.1084.60 Mobile/9B206 Safari/7534.48.3 
```

这是适用于 iOS UA 字符串的 Safari：

```
Mozilla/5.0 (iPhone; U; CPU like Mac OS X; en) AppleWebKit/420+ (KHTML, like Gecko) Version/3.0 Mobile/1A543 Safari/419.3 
```

据我所知，未来的区别在于 Chrome 包含“CriOS”。我希望能够区分这两种浏览器，因此开始使用正则表达式来做到这一点。

使用：

```
/Gecko\) (?!CriOS)/ 
```

我能够做到这一点，但我很偏执，因为我没有在表达式中包含 iPhone（也许这也会在 Android 等上触发）

我想编写以下正则表达式，它在以下情况下返回匹配项：

1.  该字符串包含“iPhone”
2.  该字符串不包含“CriOS”

我该怎么做呢？

仅供参考，我一直在使用 rubular 来测试 reg exp，这非常棒[http://rubular.com/](http://rubular.com/)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-17T18:16:32.930

这应该这样做：

```
iPhone(?!.*?CriOS) 
```

`iPhone`匹配该单词的任何出现。然后它使用`iPhone`匹配的负前瞻。`.*?CriOS`匹配任何/所有字符，直到找到`CriOS`. 这`(?!expr)`是一个负前瞻。如果表达式为假，则它之前的 ( `Iphone`) 将匹配，否则将不匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-29T20:27:24.127

有关 iPhone Safari 字符串的更完整详细信息，请尝试：

```
'Mozilla/(\d+(?:\.?\d+)*) \(([\w\s\;]+?)\) AppleWebKit/(\d+(?:.?\d+)*) \([\w\s\,]*\) Version/(\d+(?:.?\d+)*) Safari/(\d+(?:.?\d+)*)' 
```

您现在显然也可以适应 Chrome ......

# xcode - Xcode 4.5：出现错误“加载了笔尖但未设置视图出口”

> ID：11528254
> 
> 赞同：1
> 
> 时间：2012-07-17T18:02:24.007
> 
> 标签：xcode, loading, nib

更新到 Xcode 4.5 beta 后出现此错误。如果我通过 Xcode 4.3.3 运行项目，我不会得到同样的错误。

```
'NSInternalInconsistencyException', reason: '-[UIViewController _loadViewFromNibNamed:bundle:] loaded the "LocationList" nib but the view outlet was not set.' 
```

“LocationList”是一个自定义单元格，所有者是 UITableViewController 的子类。我试图将其子类化为 UIViewController 并将其连接到 IB 中的“视图”，但随后它无法识别`[self.tableview reloadData];`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T21:59:06.380

我遇到了同样的问题，我所做的只是覆盖了 loadView 方法。如此奇怪的新 Xcode 无法确定当我们覆盖 UITableViewConroller 时它不应该从 Nib 加载 TableView（在我的情况下，我没有使用 IB 来放置 TableView，只是创建了一个新类，它是 UITableViewController 的子类，这个在 Xcode 3.3 中可以正常工作，但在 4.5 中不行）。这肯定会解决你的问题，

```
-(void)loadView {
[super loadView]; 
```

}

但我不太确定原因。

# .net - Excel VSTO 应用程序中可调整大小的 winform 控件出现问题

> ID：11528259
> 
> 赞同：2
> 
> 时间：2012-07-17T18:02:34.400
> 
> 标签：.net, winforms, vsto

我正在向 Excel 工作表添加一个 Winforms 控件。该控件继承自 ListView 并简单地添加了用户通过“抓取”右下角来调整其大小的能力，如下所示：

```
//This solution taken from 
//http://stackoverflow.com/questions/1535826/resize-borderless-window-on-bottom-right-corner/1535943#1535943
public class MyListView : ListView
{
    protected override void WndProc(ref Message m)
    {
        const int wmNcHitTest = 0x84;
        const int htBottomLeft = 16;
        const int htBottomRight = 17;
        if (m.Msg == wmNcHitTest)
        {
            int x = (int)(m.LParam.ToInt64() & 0xFFFF);
            int y = (int)((m.LParam.ToInt64() & 0xFFFF0000) >> 16);
            Point pt = PointToClient(new Point(x, y));
            Size clientSize = ClientSize;
            if (pt.X >= clientSize.Width - 16 && pt.Y >= clientSize.Height - 16 && clientSize.Height >= 16)
            {
                m.Result = (IntPtr)(IsMirrored ? htBottomLeft : htBottomRight);
                return;
            }
        }
        base.WndProc(ref m);
    }
} 
```

这个控件被添加到我的工作表中：

```
MyListView listView = new MyListView();

Microsoft.Office.Tools.Excel.Worksheet worksheet =
  Globals.Factory.GetVstoObject(Globals.ThisAddIn.Application.ActiveWorkbook.Sheets[1]);

worksheet.Controls.AddControl(listView, 0, 0, 100, 100, "myListView01"); 
```

有了这个，我可以通过抓住右下角并向左/向上拖动来缩小控件。

问题是我无法将其变大，因为它不允许将光标拖过 MyListView 的右/下边界。在做了一些调查之后，我相信这是因为通过 VSTO 添加到工作表的所有控件都由一个名为 VSTOContainerControl 的控件作为父级，该控件的大小始终设置为与其子控件相同。[此处](http://blogs.msdn.com/b/eric_carter/archive/2004/06/04/148819.aspx)的 MSDN 博客证实了这一事实。我发现如果我以编程方式增加父 VSTOContainerControl 的大小，子 MyListView 也会自动增加。但是，我需要用户能够随意手动增加大小。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T17:02:30.600

我建议在列表视图和容器控件之间放置一个小边距，以便您可以将调整大小手柄拖动几个像素，并以编程方式将容器的大小固定为新的大小 + 边距。容器调整大小可以在用户尝试调整大小时触发的任何事件的事件处理程序中完成。

# php - PHP 到电子邮件表单：“垃圾邮件”问题、验证、警报框

> ID：11528266
> 
> 赞同：0
> 
> 时间：2012-07-17T18:03:07.497
> 
> 标签：php, html, css, validation, error-handling

我花了很多时间尝试在 stackoverflow 上找到的东西，但我似乎无法找到我正在寻找的东西。

我还要说我对 PHP/JavaScript 的了解是基本的，因为这不是我通常参与的。

我有一个非常简单的联系表格：

```
 <form action=' ' method='post'>

    <label for='firstName' >First Name: </label>
    <input type='text' name='firstName' id='firstName' />

    <label for='lastName' >Last Name: </label>
    <input type='text' name='lastName' id='lastName' />

    <label for='phone' >Contact No :</label>
    <input type='text' name='phone' id='phone' />

    <label for='email' >Email Address:</label>
    <input type='text' name='email' id='email' />

    <input type='image' id="submit" src="images/submit.png" class="uibutton" onclick="show_alert()" />

  </form> 
```

这是我的PHP：

```
<?php 
```

if(isset($_POST['email'])) {

```
$field_name = $_POST['firstName'];
$field_surname = $_POST['lastName'];
$field_phone = $_POST['phone'];
$reply_to = $_POST['email'];

//send email
$mail_to = 'me.pfrrr@gmail.com';
$subject = 'Contact a site visitor '.$field_name." ".$field_surname;

$body_message = 'First Name: '.$field_name."\n";
$body_message .= 'Last Name: '.$field_surname."\n";
$body_message .= 'Phone Number: '.$field_phone."\n";
$body_message .= 'Email Address: '.$reply_to;

$headers = 'From: '.$field_name."\r\n";

$mail_status = mail($mail_to, $subject, $body_message, $headers); 
```

} ?>

我希望我的表格向我发送电子邮件。它做到了；但是我收到的电子邮件总是进入“垃圾邮件”文件夹。域/IP 不在 PBL 列表中。

如果有人至少能给我一个指导如何实现以下目标并回答一些问题，我将不胜感激：

1.  我想让电子邮件进入“收件箱”文件夹

2.我想验证表单，但我希望我的错误出现在文本字段下。我可以使用 Dreamweaver 提供的工具来做到这一点；但是它仍然允许我提交一个空表单。有没有办法可以使用 php/html/css 以美观的方式显示错误？（在同一页面 > 每个文本字段下）

3.在“提交”时，我有一个警告框，上面写着“谢谢”。只有正确填写表格时，如何才能弹出警告框？

我将非常感谢“正确”的答案（不是：“去阅读 php/javascript 教程”类型的东西，因为我已经这样做了，尝试了一些东西，但它们没有奏效 - 所以我需要进一步的建议）

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T18:13:26.407

1.  如果这只是发送到您的电子邮件，请将发件人地址添加到您的联系人中。这将覆盖任何垃圾邮件过滤器。

2.  如果你想要求字段，你可以使用[html5 表单验证](http://www.the-art-of-web.com/html/html5-form-validation/)。您还可以使用它们来检查有效的电子邮件地址。

3.  将您的 javascript 从按钮移动`onclick=""`到`onsubmit=""`您的`<form>`标签中。

# linux - 如何阅读 shell 命令的源代码？

> ID：11528267
> 
> 赞同：175
> 
> 时间：2012-07-17T18:03:08.687
> 
> 标签：linux, command, gnu-coreutils

我想阅读编写 linux 命令的实际源代码。我已经获得了一些使用它们的经验，现在我认为是时候与我的机器进行更深层次的交互了。

我在这里找到了一些命令[http://directory.fsf.org/wiki/GNU](http://directory.fsf.org/wiki/GNU)。不幸的是，我无法找到诸如“ls”之类的基本命令，这对我来说似乎很容易开始。

我究竟如何阅读像'ls'这样的简单shell命令的源代码？我在 Ubuntu 12.04 上运行

* * *

## 回答 #1

> 赞同：189
> 
> 时间：2012-07-17T18:08:29.093

所有这些基本命令都是`coreutils`包的一部分。

您可以在这里找到您需要的所有信息：

[http://www.gnu.org/software/coreutils/](http://www.gnu.org/software/coreutils/)

如果你想下载最新的源码，你应该使用 git：

`git clone git://git.sv.gnu.org/coreutils`

要在你的 Ubuntu 机器上安装 git，你应该使用 apt-get（git 不包含在标准的 Ubuntu 安装中）：

`sudo apt-get install git`

说实话，在这里您可以找到该`ls`命令的特定来源：

[http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/ls.c](http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/ls.c)

一个“足够简单”的命令只有 4984 行代码，因为`ls`......你还有兴趣阅读它吗？祝你好运！:D

* * *

## 回答 #2

> 赞同：145
> 
> 时间：2014-09-24T20:49:48.607

直接链接到一些流行程序的源代码[`coreutils`](http://www.gnu.org/software/coreutils/)：

*   [`cat`](http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/cat.c)（767 行）
*   [`chmod`](http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/chmod.c)（570 行）
*   [`cp`](http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/copy.c)（2912 行）
*   [`cut`](http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/cut.c)（831 行）
*   [`date`](http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/date.c)（570 行）
*   [`df`](http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/df.c)（1718行）
*   [`du`](http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/du.c)（1112 行）
*   [`echo`](http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/echo.c)（272 行）
*   [`head`](http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/head.c)（1070 行）
*   [`hostname`](http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/hostname.c)（116 行）
*   [`kill`](http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/kill.c)（312 行）
*   [`ln`](http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/ln.c)（651 行）
*   [`ls`](http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/ls.c)（4954 行）
*   [`md5sum`](http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/md5sum.c)（878 行）
*   [`mkdir`](http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/mkdir.c)（306 行）
*   [`mv`](http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/mv.c)（512 行）
*   [`nice`](http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/nice.c)（220 行）
*   [`pwd`](http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/pwd.c)（394 行）
*   [`rm`](http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/rm.c)（356 行）
*   [`rmdir`](http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/rmdir.c)（252 行）
*   [`shred`](http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/shred.c)（1325 行）
*   [`tail`](http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/tail.c)（2301 行）
*   [`tee`](http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/tee.c)（220 行）
*   [`touch`](http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/touch.c)（437 行）
*   [`wc`](http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/wc.c)（801 行）
*   [`whoami`](http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/whoami.c)（91 行）

[完整列表在这里。](http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-07-17T18:05:42.667

`ls`是 coreutils 的一部分。你可以用 git 得到它：

```
git clone git://git.sv.gnu.org/coreutils 
```

[您会在此页面](http://www.gnu.org/software/software.html)上找到与其他软件包一起列出的 coreutils（滚动到底部）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-07-13T19:45:59.797

[实际上， http](http://suckless.org) : //suckless.org 提供了更健全的资源，请查看他们的`sbase`存储库：

`git clone git://git.suckless.org/sbase`

它们更清晰、更智能、更简单、更简单，例如`ls.c`只有 369 LOC

之后会更容易理解更复杂的 GNU 代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-08-18T07:31:55.997

其他帖子中提到的 CoreUtils 并未显示我认为您寻求的大多数功能的实际实现。在大多数情况下，它为检索数据的实际函数提供前端，可以在这里找到：

它建立在[Gnulib 之上](https://github.com/rofl0r/gnulib)，实际源代码位于[lib-subdirectory](https://github.com/rofl0r/gnulib/tree/master/lib)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-02-04T14:23:45.027

您可以使用以下命令在 github 上拥有它

```
git clone https://github.com/coreutils/coreutils.git 
```

您可以在 src 文件夹中找到所有源代码。

> 你需要安装[git](https://git-scm.com/downloads)。

自 2012 年以来情况发生了变化，`ls`源代码现在有 5309 行

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-06-08T13:34:15.463

BSD 发行版实际上是一种阅读源代码的好方法，通过使用它们的存储库，因为它们都被打包到一个地方，您可以查看源代码的历史演变或变化。那么为什么不使用 BSD 存储库，例如[NetBSD](http://cvsweb.netbsd.org/bsdweb.cgi/src/?only_with_tag=MAIN)或[OpenBSD](https://cvsweb.openbsd.org/src/)来完成此任务。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-02-20T03:53:14.683

```
 cd ~ && apt-get source coreutils && ls -d coreutils* 
```

您应该能够在 ubuntu 上使用这样的命令来收集包的源代码，您可以省略`sudo`假设您下载到您拥有的位置。

# asp.net-mvc-3 - MVC3弹出对话框定位

> ID：11528274
> 
> 赞同：0
> 
> 时间：2012-07-17T18:03:34.783
> 
> 标签：asp.net-mvc-3, popup, positioning

我有一个 MVC3 C# .Net Web 应用程序。我在 .js 文件中定义了一个弹出对话框。我试图让弹出窗口显示在屏幕中央。这样做的属性是什么。我有尝试的位置：'绝对'但不行。这是我的 jscript 代码的片段

```
LdapDialog = {
    /*
    * Base URL for the app. Must be set prior to calling show (ideally in _Layout.cshtml).
    */
    baseUrl: "",

    title: "Lookup:  Search by Last Name",
    width: 375,
    height: 600,
    loading: $('<img src="' + $.getUrl('Content/Images/loading.gif') + '" />'), 
    dialogContainer: $('<div></div>'),
    position: $('absolute'),
} 
```

有任何想法吗？

# svn - 使用 SVN 查看先前代码的命令

> ID：11528279
> 
> 赞同：0
> 
> 时间：2012-07-17T18:03:56.957
> 
> 标签：svn, ubuntu, command-line

使用 svn 查看或返回（但不恢复）我们之前的任何代码（最后 3 或 5）的命令是什么？我知道有这样的命令`revert`，但这不是我要搜索的，因为我只想看看以前的代码是什么样子而不是还原它。如何在类 UNIX 系统中通过命令行执行此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:05:50.840

**编辑**

[颠覆命令和脚本](http://www.yolinux.com/TUTORIALS/Subversion.html)

```
svn diff -rBASE:HEAD 
```

* * *

```
right click on file go to svn >> check Difference 
```

[**修订日志对话框**](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-showlog.html#tsvn-dug-showlog-2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T18:18:12.247

svn cat 将显示文件的内容。

您可以使用 -r 开关指定修订版本来查看以前的版本。

例如

```
svn cat http://myrepo/myfile.txt -r1 
```

# c# - 线程是 Windows 概念吗？

> ID：11528281
> 
> 赞同：9
> 
> 时间：2012-07-17T18:04:01.403
> 
> 标签：c#, windows, multithreading, operating-system

所以我正在阅读“CLR via C#”并发现这一行“**线程是一个 Windows 概念，其工作是虚拟化 CPU** ”。真的吗？单\多线程最初来自 Windows？

搜索理由并没有帮助，因此寻求社区的帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-17T18:06:33.670

我想作者的真正意思是线程作为一种机制是由 Windows 而不是 .NET 框架管理的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-17T18:05:42.883

**简短回答：**不，它不仅仅是一个 Windows 概念，而且这个概念已经存在了很长时间。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-17T18:13:16.487

我想说的是，当我们谈论 Windows 上的“线程”时，有一个关于共享内存和实现的假设。实际上，在我转向 Windows 编程（而不是嵌入式编程）之前，我从未听说过“线程”这个词。我更熟悉多处理和多任务处理。所以这个概念不是唯一的，但术语可能已经改变。我会在 Windows 之前的经验中指出，多个进程不会共享内存，除非它是全局的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-17T18:07:22.167

我相信 Amiga 已经有了多线程。可能是文本提到多线程是（也是）一个 Windows 概念，但不是说它（最初）是一个 Windows 发明？

# ms-access - 从按钮运行查询时 ms 访问表单关闭

> ID：11528285
> 
> 赞同：0
> 
> 时间：2012-07-17T18:04:06.007
> 
> 标签：ms-access

我有一个带有一个组合框和确定按钮的表单。选择组合框的值并单击“确定”时，它将根据所选值打开查询。

这很好，但它会关闭表单然后打开查询。我必须再次单击表单选项卡以选择另一个值并运行查询。

是否有可能，查询在另一个窗口中运行，而表单窗口仍然打开？

对于组合框

我在行源中有一个代码，例如

```
select distinct format(columndate, 'mm-dd-yyyy') from table1 
```

对于确定按钮，我有如下代码：

```
Private Sub Submit_Click()
    Dim db As DAO.Database
    Dim qdf As DAO.QueryDef
    Dim strSQL As String
    Set db = CurrentDb
    Set qdf = db.QueryDefs("query")
    strSQL = "SELECT columndate," & _
      "sum(qty1)," & _
      "sum(qty2)," & _
      "sum(qty3)," & _
      "sum(qy4)" & _
      "FROM table1 " & _
      "WHERE table1.column_date = '" & Me.datefield.value & "' " & _
      "group by table1.[columndate];"

    qdf.sql = strSQL
    DoCmd.Restore
    DoCmd.OpenQuery ("query")
    DoCmd.Close acForm, "Me.Form3"

    Set qdf = Nothing
    Set db = Nothing

    Debug.Print strSQL
End Sub 
```

我对此还有一个问题。日期字段实际上在表中的格式为“dd-mm-yyyy”，但在查询中，只要我在第一个查询中将行源中的格式更改为“mm-dd-yyyy”，它就会显示空白结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T18:13:28.247

您的 OK 按钮单击处理程序必须如下所示

```
Private Sub btnOk_Click()
    DoCmd.OpenQuery(Me!cboQuery, acViewNormal, acReadOnly)
End Sub 
```

还要确保`Cancel`按钮的属性设置为`No`.

# javascript - 使用 D3.js 生成的 SVG 图形在 Safari 中滚动时消失

> ID：11528291
> 
> 赞同：2
> 
> 时间：2012-07-17T18:04:34.040
> 
> 标签：javascript, html, css, svg, d3.js

我目前在[http://orbit-analytics.herokuapp.com/user/2990](http://orbit-analytics.herokuapp.com/user/2990)部署了一个 Rails webapp，它利用 D3.JS 和 JavaScript 生成特定用户上传与时间相关的 SVG 图。图表在 Chrome、Safari 和 Firefox 中正确呈现，但突出显示刻度标签或滚动可能会导致图表的某些部分在 Safari（但不是 Chrome 或 Firefox）中消失。在具有类似图表的另一个页面上，这不是问题，可在[http://orbit-analytics.herokuapp.com/video/10](http://orbit-analytics.herokuapp.com/video/10)获得。

这是 Safari 问题还是我的代码有问题？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T20:44:32.407

当您从CSS 中删除该`stroke`属性时，您的问题已得到解决。`line`正如[您所提到](https://stackoverflow.com/questions/11528291/svg-graph-generated-using-d3-js-disappearing-when-scrolling-in-safari#comment15242728_11528291)的，您可以使用样式功能直接应用此样式。

至于添加次要行，请考虑使用. 如果没有，您可能会在[Axis](https://github.com/mbostock/d3/wiki/SVG-Axes)组件中找到答案。`axis.[tickSubdivide](https://github.com/mbostock/d3/wiki/SVG-Axes#wiki-tickSubdivide)([n])`

# java - JAVA：我的两个应用程序如何访问同一个文件？

> ID：11528295
> 
> 赞同：0
> 
> 时间：2012-07-17T18:04:48.220
> 
> 标签：java, file, javax.imageio

我已经制作了两个旨在同时运行的应用程序（我不想将它们组合起来），一个从某个文件读取，另一个写入它。当一个或另一个运行没有错误时，但是如果它们都在运行，则获取访问被拒绝错误。第一个的相关代码：

```
 class MakeImage implements Runnable {
        @Override
        public void run() {
            File file = new File("C:/Users/jeremy/Desktop/New folder (3)/test.png");
            while (true) {

                try{
//make image
                if(image!=null)
                {
                    file.createNewFile();
                ImageIO.write(image, "png", file);
                hello.repaint();}}
                catch(Exception e)
                {
                    e.printStackTrace();
                }

                }
    }
} 
```

第二种的相关代码：

```
 BufferedImage image = null;
            try {
                // Read from a file
                image = ImageIO.read(new File("C:/Users/jeremy/Desktop/New folder (3)/test.png"));
            }
            catch(Exception e){
                e.printStackTrace();
            }
            if(image!=null)
            {
            ByteArrayOutputStream baos = new ByteArrayOutputStream();
            ImageIO.write( image, "png", baos );
            baos.flush();
            byte[] imageInByte = baos.toByteArray();
            baos.close();
            returns=Base64.encodeBase64String(imageInByte);
            } 
```

我看了这个：[Java：如何处理试图修改同一个文件的两个进程](https://stackoverflow.com/questions/6332406/java-how-to-handle-two-process-trying-to-modify-the-same-file)，但那是当两者都写入文件时，这里只有一个。我按照前者的答案尝试了稍后重试的方法，但没有任何运气。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T18:14:52.810

除非您使用某种操作系统级别的文件锁定并检查锁定，否则您将无法非常轻松地可靠地执行此操作。一种相当可靠的管理方法是使用目录中的另一个文件作为信号量，在您写入或读取时“触摸”它，并在完成后将其删除。在访问文件之前检查信号量是否存在。否则，您将需要使用某种数据库来存储文件锁（保证一致性）并在那里检查它。

也就是说，你真的应该把它组合成一个程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T18:10:00.200

用`synchronized`在**修改文件的方法上**。

**编辑：**

根据线程安全类的定义，它是这样的......“**一个类被认为是线程安全的，它在底层操作系统交错和调度的情况下正常工作，没有来自客户端的同步机制”** .

我相信有一个文件要在不同的机器上访问，所以必须有一些客户端 - 服务器机制，如果它存在..那么让服务器端有同步机制，然后有多少客户端并不重要访问它...

如果没有，同步就绰绰有余了…………

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T18:15:55.473

尝试[RandomAccessFile](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/RandomAccessFile.html)。

这是一个有用但非常**危险**的功能。它是这样的“如果你为同一个文件创建不同的 RandomAccessFile 实例，你可以同时写入文件的不同部分。”
您可以使用 seek 方法创建指向文件不同部分的多个线程，并且多个线程可以同时更新文件。Seek 允许您移动到文件的任何部分，即使它不存在（在 EOF 之后），因此您可以移动到新创建的文件中的任何位置并在该位置写入字节。您可以打开同一文件的多个实例并查找不同的位置并同时写入多个位置。

# objective-c - 从应用程序保存到联系人：没有发生任何事情/错误

> ID：11528297
> 
> 赞同：0
> 
> 时间：2012-07-17T18:04:59.447
> 
> 标签：objective-c, ios, xcode4.2, addressbook

试图允许用户将我的应用程序中的联系方式保存到他们的通讯录/联系人中。

在 IBAction 下：

```
ABAddressBookRef addressBook = ABAddressBookCreate();
ABRecordRef person = ABPersonCreate(); 

CFErrorRef  anError = NULL;

ABRecordSetValue(person,kABPersonFirstNameProperty,@"Name goes here",&anError);
ABRecordSetValue(person, kABPersonOrganizationProperty, @"Company name here", &anError);
ABRecordSetValue(person, kABPersonJobTitleProperty, @"Job Title Here", &anError);

ABMutableMultiValueRef multiAddress =   ABMultiValueCreateMutable(kABMultiDictionaryPropertyType);
NSMutableDictionary *addressDictionary = [[NSMutableDictionary alloc] init];

[addressDictionary setObject:@"Chicago" forKey:(NSString *)kABPersonAddressCityKey];
[addressDictionary setObject:@"IL" forKey:(NSString *)kABPersonAddressStateKey];
[addressDictionary setObject:@"60654" forKey:(NSString *)kABPersonAddressZIPKey];

ABMultiValueAddValueAndLabel(multiAddress, @"Adress", (CFStringRef)@"Address", NULL);
ABRecordSetValue(person, kABPersonAddressProperty, multiAddress,&anError);
CFRelease(multiAddress);

ABMutableMultiValueRef websiteMultiValue = ABMultiValueCreateMutable(kABPersonURLProperty);
ABMultiValueAddValueAndLabel(websiteMultiValue, @"www.7app.co.uk", (CFStringRef)@"Website", NULL);
ABRecordSetValue(person, kABPersonURLProperty, websiteMultiValue, &anError);

ABMutableMultiValueRef emailMultiValue = ABMultiValueCreateMutable(kABPersonEmailProperty);
ABMultiValueAddValueAndLabel(emailMultiValue, @"something@hotmail.com", (CFStringRef)@"Email", NULL);
ABRecordSetValue(person, kABPersonEmailProperty, emailMultiValue, &anError);

ABAddressBookAddRecord(addressBook, person, &anError);

} 
```

我已经进口了

```
#import <AddressBook/AddressBook.h>

#import <AddressBookUI/AddressBookUI>.h 
```

当我按下按钮时，我完全没有反应。什么都没有发生。顺便提一下，如果出现明显错误，这是我第一次尝试使用地址簿框架。

我还想用以下内容保存联系人图片

```
 NSData *dataRef = UIImagePNGRepresentation(my image here);
ABPersonSetImageData(person, (__bridge_retained CFDataRef)dataRef, nil); 
```

但是我抛出了一个异常，我以通常的方式处理了一个图像，不确定这是否适合这种方法？我得到错误消息：

```
 2012-07-17 19:01:50.132 543[966:707] -[UIImageView CGImage]: unrecognized selector sent     to instance 0x15b9b0
 2012-07-17 19:01:50.133 543[966:707] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[UIImageView CGImage]: unrecognized selector sent to instance 0x15b9b0' 
```

通常，当由于连接问题引发异常时，我已经仔细检查并且 UI 图像没有重复连接等。

一如既往的任何建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:09:52.290

ABAddressBookSave()

[http://developer.apple.com/library/ios/#documentation/AddressBook/Reference/ABAddressBookRef_iPhoneOS/Reference/reference.html](http://developer.apple.com/library/ios/#documentation/AddressBook/Reference/ABAddressBookRef_iPhoneOS/Reference/reference.html)

Re your image problem, it looks like you are passing a UIImageView instance to UIImagePNGRepresentation() rather than a UIImage instance

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:28:40.540

Ok sorted the no action problem, had to implement the code to present the view!

# ssl - 有没有办法配置 Azure Blob 存储以使用我的域 SSL 证书？

> ID：11528304
> 
> 赞同：11
> 
> 时间：2012-07-17T18:05:33.757
> 
> 标签：ssl, azure, azure-blob-storage

我的应用程序正在运行 http。一些内容位于 mydomain.com，一些内容存储在具有 media.mydomain.com 自定义域设置的 blob 存储中。这一切都完美无缺。现在，当我开始研究 SSL 支持时，我收到警告说我从 media.mydomain.com 请求了内容，但从（标准 blob 存储 url）接收了内容。我已经阅读了教程和指南，但似乎没有一个涉及 SSL。

容器中是否有配置可以安装我的证书？或者我是否被迫从标准内容 URL 而不是我的自定义域加载 SSL 内容？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-17T19:02:34.533

Windows Azure Blob 存储确实支持 HTTPS 端点，因此可以通过 HTTPS 访问 blob，但是您不能将自己的或第 3 方 SSL 证书添加到 Windows Azure Blob 存储端点。

# mysql - 确保表条目是唯一的

> ID：11528313
> 
> 赞同：1
> 
> 时间：2012-07-17T18:05:56.957
> 
> 标签：mysql, sql, database, database-design

我有地址的mysql数据库表，它包含邮政编码/街道/城镇的单独列。

如何确保完整的表条目是唯一的，而不仅仅是其中一列？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T19:15:02.490

在 上制作[复合](http://en.wikipedia.org/wiki/Composite_key)键`{post code, street, town}`。

键可以是主键（PRIMARY KEY）或备用键（UNIQUE 约束）。

* * *

顺便说一句，两个不同`town`的 s 可以有相同的`post code`吗？如果没有，则不需要`town`in 键。事实上，考虑通过“提取”`town`到单独的表来规范化您的模型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T18:07:36.910

一个数据库表可能有多个唯一键，因此它将拒绝任何`INSERT`违反您在表中设置的约束的查询。

只需将其他列设置为唯一，您应该会发现您的问题已解决。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T18:10:15.883

mysql 允许您为 n 个字段或列拥有一个唯一键。当您将此列声明为 unique 时，mysql 检查重复约束。有关更多信息，请阅读此[mysql 唯一键](http://www.w3schools.com/sql/sql_unique.asp)

“UNIQUE 和 PRIMARY KEY 约束都为一列或一组列提供唯一性保证。”

但是，我建议进行前端验证以使用户感到舒适（以防你没有想到它；））

# android - 在android中比较字符串后出现意外错误

> ID：11528317
> 
> 赞同：0
> 
> 时间：2012-07-17T18:06:16.037
> 
> 标签：android, logic, string-comparison

我目前正在尝试构建一种方法，让系统比较两个字符串，如果它们相同，则会触发意图。这是我现在正在使用的代码，它应该是不言自明的：

```
String string 1 = ("Text 1");

String string 2 = EditText.getText().toString();

if(((string 1)).equals(string 2)) {
Intent intent = new Intent(this, SelectActivity.class);
startActivity(intent);
} else {} 
```

我得到的错误如下（此代码在“MainActivity”内）：“（com.mycompany.myapp.MainActivity.（anonymous），java.lang.Class）”没有适用的构造函数

我不太确定这意味着什么，所以如果有人能启发我，我将不胜感激:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T19:29:41.667

不知道为什么在初始化期间需要在 string1 的值周围加上括号，并且希望 string2 中的 EditText 实际上包含一个值派生形式“R.find 语句”

看看这是否有帮助：

```
String string1 = "Text 1";

String string2 = EditText.getText().toString();

if(string1.equals(string2)) {
Intent intent = new Intent(this, SelectActivity.class);
startActivity(intent);
} else {} 
```

您还应该遵循 MH 的建议，并确保您的方法定义正确。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T18:07:39.657

那不应该

```
String string1 = ...
String string2 = ...

if (string1.equals(string2)) { 
```

注意缺少空格...

# javascript - 谷歌Orgchart创造婚姻

> ID：11528321
> 
> 赞同：7
> 
> 时间：2012-07-17T18:06:33.430
> 
> 标签：javascript, treeview, orgchart

嗨，我[`Google Orgchart`](https://developers.google.com/chart/interactive/docs/gallery/orgchart?hl=da#Example)用来创建一个家谱，我将三个家庭结合在一起。

如何在已婚但来自不同家庭的人之间建立界限，如下所示。

```
+----------+                  +----------+
| Family 1 |                  | Family 2 |
+----------+                  +----------+
     |                             |
     |                 +-----------+-----------+
     |                 |                       |
+----------+      +----------+           +-----------+    +----------+
|  Husband |------|   Wife   |           | Wife's Bro|----| Bro's GF |
+----------+      +----------+           +-----------+    +----------+ 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-20T18:48:59.540

使用 Google 组织结构图是不可能的。阅读数据格式的文档。

> 具有三个字符串字符串列的表，其中每一行代表组织结构图中的一个节点。以下是三列：
> 
> 第 0 列 - 节点 ID。它在所有节点中应该是唯一的，并且可以包含任何字符，包括空格。这显示在节点上。您可以指定要在图表上显示的格式化值，但未格式化的值仍用作 ID。
> 
> 第 1 列 - [可选] 父节点的 ID。这应该是另一行第 0 列的未格式化值。保留未指定的根节点。
> 
> 第 2 列 - [可选] 当用户将鼠标悬停在此节点上时显示的工具提示文本。
> 
> **每个节点可以有零个或一个父节点，以及零个或多个子节点。**

您可以构建多棵树，但无法加入它们。（其中一个节点应该有两个父母或兄弟姐妹）。

* * *

尝试使用其他库：

*   [lib_gg_orgchart](http://www.fluxus.com.ve/gorka/lib_gg_orgchart/)。该库支持兄弟节点：[example1](http://www.fluxus.com.ve/gorka/lib_gg_orgchart/lib_gg_orgchart_v04_sample.php?sample=2)，[example2](http://www.fluxus.com.ve/gorka/lib_gg_orgchart/lib_gg_orgchart_v04_sample.php?sample=1)
*   [德古拉图库](http://www.graphdracula.net/)
*   [普罗托维斯](http://mbostock.github.com/protovis/ex/)
*   [自由树](http://code.google.com/p/ftree/)

...或者也许与[Geni 整合](http://www.geni.com/)

# r - 使用 mlply 与 mapply 的不同 pmax 输出

> ID：11528324
> 
> 赞同：2
> 
> 时间：2012-07-17T18:06:53.933
> 
> 标签：r, plyr

我仍在努力更好地了解 mlply 的工作原理。这是我的数据集的简化版本：

```
days <- list(c(as.POSIXct("2010-08-29 00:00:00 EDT"), as.POSIXct("2010-08-30 00:00:00 EDT")))
day2 <- list(c(as.POSIXct("2010-07-22 00:00:00 EDT"), as.POSIXct("2010-07-23 00:00:00 EDT"), as.POSIXct("2010-07-24 00:00:00 EDT")))
days <- append(day2, days)
arrivals <- data.frame(date=as.POSIXct("2010-08-29 21:00:00 EDT"), size=72)
arrivals <- rbind(arrivals, c("2010-07-22 17:30:00 EDT",84)) 
```

使用 mapply 和 pmax 来选择天数和到达之间的最大值，我得到以下信息：

```
starting <- mapply(function(x,y){pmax(x,y)},days,arrivals$date)
starting[[1]]
"2010-08-29 21:00:00 EDT" "2010-08-29 21:00:00 EDT" "2010-08-29 21:00:00 EDT" 
```

我确定使用 mlply 的下一个版本不是等效的，显然是我的错误，但是我不太确定为什么输出不同。

```
starts <- mlply( cbind(arrivals$date,days), function(date,days){pmax(date,days)})
as.POSIXct(starts[[1]], origin='1970-1-1')
[1] "2010-08-30 02:00:00 EDT" "2010-08-30 02:00:00 EDT" "2010-08-30 02:00:00 EDT" 
```

理想情况下，我正在寻找如何使用 mlply 重写 mapply 语句。提前致谢，--JT

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T18:36:45.173

比较

```
> starts[[1]]
[1] 1283112000 1283112000 1283112000
> as.numeric(starting[[1]])
[1] 1283112000 1283112000 1283112000
> 
```

POSIX 对 UTC/GMT 的引用。在您的示例中，您似乎提前了 5 个小时。这是内部的输出问题，它们似乎是同一时间。进一步的评论是困难的。这取决于您正在运行的操作系统。它可能会受到您的语言环境设置等的影响。

Also [as.POSIXct gives an unexpected timezone](https://stackoverflow.com/questions/6548601/as-posixct-gives-an-unexpected-timezone) suggests there maybe an issue with `as.POSIXct.date` but Im not sure if this is still an issue.

# c++ - 如何在 OpenFrameworks / OpenCV 中使用 HSV 颜色绘制正方形

> ID：11528325
> 
> 赞同：0
> 
> 时间：2012-07-17T18:07:00.327
> 
> 标签：c++, opencv, openframeworks

我有一个使用 OpenCv 的 OpenFrameworks 项目。我有图像的色调和饱和度值的直方图。为了显示直方图，我根据直方图中的值绘制了一个灰色正方形网格。为了更容易理解，我想在每个网格列下绘制一个框，表示它所代表的色调。但是鉴于 HSV 值，我如何指定绘制框的颜色？

通常你会使用 ofSetColor 或 ofSetHexColor 但它们是基于 RGB 的，我不知道 RGB 值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T10:37:43.710

也许这只是在更高版本中出现，但您现在可以使用 ofColor 执行以下操作

```
ofColor c = ofColor::fromHsb( 0, 255, 255 ); // bright red
c.setHue( 128 ); // now bright cyan

ofColor c( 0, 0, 255 ); // vibrant blue
c.setSaturation( 128 ); // pale blue

ofColor c = ofColor_::setHsb(float hue, float saturation, float brightness) 
```

然后你可以使用`ofSetColor(c);`

[来源](http://www.openframeworks.cc/documentation/types/ofColor.html#setHue)

# python - 如何升级 virtualenv 以使用新系统 python？

> ID：11528327
> 
> 赞同：2
> 
> 时间：2012-07-17T18:07:01.283
> 
> 标签：python, virtualenv

我已经用 python2.6 在系统上安装了 virtualenv。

我将系统python升级到2.7，但是virtualenv对python2.6还是有亲和力的。

我尝试了easy_install --upgrade virtualenv，但这并没有改变任何东西。

有谁知道如何更新系统安装的 virtualenv 以在系统上使用新的 python2.7？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T18:40:44.197

pip、easy_install 和 virtualenv 命令*根据*python 版本（python 2.6、2.7 等）安装。

您必须`easy_install`为您的 python 版本安装一个新副本（请参阅[setuptools 安装说明](https://pypi.python.org/pypi/setuptools#installation-instructions)，或`pip`通过[直接安装来](http://www.pip-installer.org/en/latest/installing.html)执行相同操作。

然后，您可以使用这个与 python 2.7 绑定的新安装来安装`virtualenv`.

新命令很可能已安装为`pip-2.7`or `easy_install-2.7`; 请参阅[`setuptools`有关多个 python 版本的文档](https://pythonhosted.org/setuptools/easy_install.html#multiple-python-versions)`pip`，它们`easy_install`本身很可能是其 2.6 版本的符号链接。尝试运行`pip-2.7 install virtualenv`或`easy_install-2.7 virtualenv`。

如果这对您不起作用，您可以随时使用`-m`开关：

```
python2.7 -m easy_install virtualenv 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T18:12:42.707

您可以从虚拟环境中尝试`pip install -U python`，不确定它会破坏什么。

您还可以更改指向旧 Python 的符号链接，但不确定会产生什么副作用。

我会推荐最安全的路径，即首先`pip freeze > installed.txt`使用新的 Python 并`pip install -r installed.txt`在其中重新创建 virtualenv。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-04T13:15:04.283

我创建了一个脚本来重新生成您的 virtualenv(s)：[https ://gist.github.com/WoLpH/fb98f7dc6ba6f05da2b8](https://gist.github.com/WoLpH/fb98f7dc6ba6f05da2b8)

如果您有很多要更新，您可以使用此脚本使用 GNU Parallel 并行化它：[https ://gist.github.com/WoLpH/fb98f7dc6ba6f05da2b8#file-recreate_virtualenvs-sh](https://gist.github.com/WoLpH/fb98f7dc6ba6f05da2b8#file-recreate_virtualenvs-sh)

```
#!/bin/zsh -e

export PATH="/usr/local/bin:$PATH"
. $(which virtualenvwrapper.sh)

envs=$(find ~/envs -mindepth 1 -maxdepth 1 -type d -print -or -name '*.sparseimage' -print | sed -e 's/.*\///' | sed 's/.sparseimage$//' | sort -u)
echo "$envs" | parallel -v --no-notice ~/scripts/recreate_virtualenv.sh {} 
```

只需将其复制到一个文件（上面的可下载链接）并像这样执行它：`zsh -e recreate_virtualenvs.sh <project_name>`

```
#!/bin/zsh -e

if [ ! -d "$PROJECT_HOME" ]; then
    echo 'Your $PROJECT_HOME needs to be defined'
    echo 'http://virtualenvwrapper.readthedocs.org/en/latest/install.html#location-of-project-directories'
    exit 1
fi

if [ "" = "$1" ]; then
    echo "Usage: $0 <project_name>"
    exit 1
fi

env="$1"
project_dir="$PROJECT_HOME/$1"
env_dir="$HOME/envs/$1"

function command_exists(){
    type $1 2>/dev/null | grep -vq ' not found'
}

if command_exists workon; then
    echo 'Getting virtualenvwrapper from environment'
    # Workon exists, nothing to do :)

elif [ -x ~/bin/mount_workon ]; then
    echo 'Using mount workon'
    # Optional support for packaged project directories and virtualenvs using
    # https://github.com/WoLpH/dotfiles/blob/master/bin/mount_workon
    . ~/bin/mount_workon
    mount_file "$project_dir"
    mount_file "$env_dir"

elif command_exists virtualenvwrapper.sh; then
    echo 'Using virtualenvwrapper'
    . $(which virtualenvwrapper.sh)
fi

if ! command_exists workon; then
    echo 'Virtualenvwrapper not found, please install it'
    exit 1
fi

rmvirtualenv $env || true

echo "Recreating $env"
mkvirtualenv $env || true
workon "$env" || true
pip install virtualenv{,wrapper}

cd $project_dir
setvirtualenvproject 

if [ -f setup.py ]; then
    echo "Installing local package"
    pip install -e .
fi

function install_requirements(){
    # Installing requirements from given file, if it exists
    if [ -f "$1" ]; then
        echo "Installing requirements from $1"
        pip install -r "$1"
    fi
}

install_requirements requirements_test.txt
install_requirements requirements-test.txt
install_requirements requirements.txt
install_requirements test_requirements.txt
install_requirements test-requirements.txt

if [ -d docs ]; then
    echo "Found docs, installing sphinx"
    pip install sphinx{,-pypi-upload} py
fi

echo "Installing ipython"
pip install ipython

if [ -f tox.ini ]; then
    deps=$(python -c "
parser=__import__('ConfigParser').ConfigParser();
parser.read('tox.ini');
print parser.get('testenv', 'deps').strip().replace('{toxinidir}/', '')")
    echo "Found deps from tox.ini: $deps"
    echo $deps | parallel -v --no-notice pip install {}
fi

if [ -f .travis.yml ]; then
    echo "Found deps from travis:"
    installs=$(grep 'pip install' .travis.yml | grep -v '\$' | sed -e 's/.*pip install/pip install/' | grep -v 'pip install . --use-mirrors' | sed -e 's/$/;/')
    echo $installs
    eval $installs
fi

deactivate 
```

# desire2learn - Desire 2 学习组织单位 ID

> ID：11528328
> 
> 赞同：0
> 
> 时间：2012-07-17T18:07:05.943
> 
> 标签：desire2learn

查找特定课程的特定 orgUnit ID 的 API 调用是什么？我正在尝试从 API 中提取成绩和班级列表，但如果没有 orgUnitID，我将无法做到

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T20:19:51.737

可能有几种方法可以解决此问题，具体取决于您所处的用例类型。首先，您可以遍历组织结构以查找您正在寻找的课程的详细信息。从组织的节点（根组织）开始，并使用[路由检索组织的后代](http://docs.valence.desire2learn.com/res/orgunit.html#get--d2l-api-lp-%28D2LVERSION-version%29-orgstructure-%28D2LID-orgUnitId%29-descendants-)以向下工作：您需要将此调用限制为仅提供课程类型的节点（默认情况下，组织单位类型 ID 为“3” ）。这个过程几乎肯定需要获取大量数据，然后对其进行解析。

如果您知道课程设置的*代码*（您的组织用来定义课程设置的唯一标识符）或名称，那么您可以通过匹配这些值在后代列表中找到该课程。

您还可以通过多种方式在更小的范围内进行此搜索：

*   如果您已经知道与课程设置相关的结构中节点的组织单位 ID（例如，作为课程设置的父级的*部门*或*学期*），您可以从*该*节点开始搜索，您将拥有要解析的节点要少得多。

*   如果您的调用用户上下文（或您知道并可以进行身份​​验证的用户上下文）已在课程设置或已知的父组织（如部门）中注册，那么您可以[获取该用户的所有注册列表](http://docs.valence.desire2learn.com/res/enroll.html#get--d2l-api-lp-%28D2LVERSION-version%29-enrollments-myenrollments-)，并解析这些以找到您正在寻找的单一课程。（请注意，此注册路由将数据作为分页结果集发送回，而不是作为简单的 JSON 数组，因此在找到所需的数据页之前，您可能需要进行多次调用才能遍历多个数据页。）

在所有这些场景中，该过程最终将导致您检索一个 JSON 结构，该结构将包含组织单位 ID，然后您可以保留该结构并在以后直接使用。

# gis - Linux 上的 gis 工具功能

> ID：11528329
> 
> 赞同：1
> 
> 时间：2012-07-17T18:07:08.553
> 
> 标签：gis, openlayers, mapserver, mapnik

目前，我有一个 openlayers 网页，它查询一个 tilelite 服务器，该服务器提供通过 layers-shapefiles.xml 添加的各种 shapefile（河流、湖泊、火边界、时区、自然森林、BLM 土地、电视接收轮廓......）的 mapnik 瓷砖.inc.

很快我将在美国西部进行广泛的旅行。我正在寻找一个可以在本地生成图块的系统，这样我就不会用尽我的数据使用量（我当前的设置对此很有效），但在查询 shapefile 数据时具有更多功能。在这方面，我目前的设置非常有限。我可以根据缩放级别打开和关闭形状和名称，但我正在寻找可以让我查询单个形状并在弹出窗口或滑出框架中显示相应数据（来自 shapefile db）的东西。如果需要，我可以构建弹出框或滑出框。

我正在考虑安装 mapserver 并看看它可以做什么，我今天可能会这样做，但我只是想问是否有人可以帮助我使用具有我正在寻找的功能的工具。

**更新：**

我花了一天时间来熟悉 mapserver。我可以打开和关闭图层，这是我无法使用由 tilelite 提供并由 openlayers 筛选的 mapnik 瓷砖做的。但是，我找不到任何人做我之前描述的事情的例子，即查询单个形状并从 shapefile 属性表中获取该形状的属性，并通过气球、弹出窗口以某种方式在网页上呈现它……是我在问什么可能呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T21:57:51.873

那是可能的。在这里检查

[http://openlayers.org/dev/examples/getfeatureinfo-control.html](http://openlayers.org/dev/examples/getfeatureinfo-control.html)

[http://demo.mapserver.org/tutorial/section3.html](http://demo.mapserver.org/tutorial/section3.html)

# php - 点击javascript发送通知？

> ID：11528339
> 
> 赞同：1
> 
> 时间：2012-07-17T18:07:49.877
> 
> 标签：php, jquery, redirect, notifications, query-string

所以假设我有这个代码

```
<a href="www.yourdomain.com"><img src="http://www.image.com/image.jpg" /></a> 
```

超级简单的代码。现在假设我将此代码作为 BB 交易提供给我的用户。他们可以把这个代码放在任何地方。他们的网站，他们购买的广告空间等。我可以附加任何类型的 javascript 代码（或链接到 php 页面并获取引荐来源网址，然后重新发送它们？）所以我可以获得某种通知？

所以当人们点击他的广告版本时，我会收到某种通知？

所以如果我成功了

```
<a href="www.MYdomain.com?theirdomain=www.blah.com" /><img></a> 
```

我可以从查询字符串中获取“他们的域”，并将它们转发到“他们的域”。很容易。

**但是现在，我现在要向自己发送“他们的域”信息吗？收集它的最佳方法是什么？**< -- 问题的结尾，我想

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T18:13:31.830

通常，这是通过将其从您自己的服务器弹回来完成的，不需要 JS。

```
<a href="http://mydomain.com/track?url=www.yourdomain.com">
  Go to yourdomain.com!
</a> 
```

`http://mydomain.com/track`然后负责两件事：

*   在数据库中记录点击，增加点击计数，创建点击记录，等等
*   响应 301 重定向到所需的 URL。

单击的用户不会更明智地发生这种情况，因为您的服务器不发送可呈现的内容并且它应该快速响应。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T18:14:57.230

关联：

```
<a href="www.MYdomain.com/ad.php?url=www.blah.com" /><img></a> 
```

`ad.php`：

```
if(isset($_GET['url'])) {
    $redirectURL = $_GET['url'];

    // do your stuff here

    header ('HTTP/1.1 301 Moved Permanently');
    header("Location: $redirectURL");
} 
```

请求到达您的服务器，您读取查询字符串参数`url`并执行您需要的任何操作，然后重定向到目标 url。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T18:17:42.110

当有人通过链接访问您的网站时，您可以节省很多东西。检查php的`$_SERVER`变量

[http://www.php.net/manual/en/reserved.variables.server.php](http://www.php.net/manual/en/reserved.variables.server.php)

对你来说，这`HTTP_REFERER`部分可能非常有趣。但是不要太相信它，因为它并不总是设置或可以手动设置。

除此之外，我同意@Alex Wayne。您可以/应该设置一个跟踪 url，它只收集信息并重定向（使用 301！）到目标页面，而不会引起用户注意。

您收集的信息可以存储在数据库中，例如 mysql 或文本文件或发送电子邮件或任何您认为最适合您的方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T18:14:39.970

假设您的客户之一是 www.foo.com。

你可以给他们这个放在他们的网站上：

`<a href="http://www.mydomain.com/click_ad.php?domain=foo.com"><img src="..." /></a>`

在您的网站上，您需要包含一个 click_ad.php 文件，该文件会在您的数据库中插入一个值，说明 foo.com 已经让用户点击了他们的广告版本。您可以在此处了解如何执行此操作：

**参考**： http: [//php.net/manual/en/book.mysqli.php](http://php.net/manual/en/book.mysqli.php)

我建议您为域使用一个数据库表（并将它们链接到一个 ID），然后为点击使用另一个数据库表（将域 ID 与点击量链接）。

# drupal-7 - 重定向循环创建 Drupal 7 多站点

> ID：11528340
> 
> 赞同：1
> 
> 时间：2012-07-17T18:07:55.100
> 
> 标签：drupal-7, installation, subdomain

我知道有一些与此相关的问题，但我无法回答我的问题。

我想开发 2 个指向相同 Drupal 文件的网站。

所以 ：

drupal1.example.com 应该指向 /www/dev/sites/drupal1.example.com drupal2.example.com 应该指向 /www/dev/sites/drupal2.example.com

我已经创建了两个子域来指向 /www/dev/ 文件夹，所以我猜 Drupal 应该“检查”流量的来源并使用正确的站点文件夹。

我已将 settings.php 放入 drupal1.example.com 和 drupal2.example.com 中的 default.settings.php （没有数据库信息），但似乎两个子域都使用 drupal1.example.com 站点文件夹（drupal2 不应该工作，它应该指向我的 install.php 文件夹）。

你知道我在做什么错吗？

谢谢！

# properties - 如何添加依赖于父级中包含的属性的 CSLA 业务规则？

> ID：11528344
> 
> 赞同：0
> 
> 时间：2012-07-17T18:08:17.423
> 
> 标签：properties, parent, business-rules, csla

我正在添加一个“舍入”业务规则，以将小数属性值四舍五入到单独整数属性中指定的小数位数。如果两个属性都是相关业务对象的成员，则此方法效果很好。如以下 VB.Net 代码中...

```
BusinessRules.AddRule(New Round(_decimalProperty, _precisionProperty)) 
```

我有一个继承自 CommonBusinessRule 的私有 Round 类，它的构造函数如下：

```
Public Sub New(decimalProperty As IPropertyInfo, precisionProperty As IPropertyInfo)
    MyBase.New(decimalProperty)

    InputProperties = New List(Of IPropertyInfo)()
    InputProperites.Add(decimalProperty)
    InputProperties.Add(precisionProperty)
End Sub 
```

每当任一属性更改时，这都会触发规则 Execute，并且 Execute 代码会完全按照我的意愿循环。

**问题：**我现在遇到一种情况，precisionProperty 是 Parent 业务对象的属性。当调用为子业务对象添加业务规则的CSLA方法时，子业务对象的Parent成员为null，所以我无法获取到父属性的引用。在 Parent 字段不再为空之后，是否有任何时间点允许我添加新的业务规则？如果有，用什么方法？还有另一种方法吗？

我们已经考虑将对父业务对象的引用（通过构造函数）传递给子级，但现在决定不采用这种方法（子级实际上有 6 层深，看来这需要重新设计我们的代码生成方案）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-04T23:46:43.817

BusinessBase 中的 parent 属性通常由 BusinessListBase 用来保持与其子项的关系。parent 属性确实不是（不应该？）在此之外使用。

当我有一个具有影响子对象的属性的父对象时，我将规则放在父对象中，然后父对象将调用子对象上的任何规则。您可以传入您喜欢的任何值，甚至可以在子属性上拥有一个属性副本并在父属性更改时设置它。

# xcode - Xcode：如何修复 tableView 的工具栏？

> ID：11528350
> 
> 赞同：1
> 
> 时间：2012-07-17T18:08:30.487
> 
> 标签：xcode, uitableview, toolbar

我有一个 tableView 并想在底部添加一个带有同步按钮和最新同步日期的工具栏（就像在 iPhone 上的邮件应用程序上一样）。但是滚动条应该是固定的，这样当我在表格视图中滚动时它就不会移动。

现在，我只是通过以下方式以编程方式添加 searchBar：

```
self.tableView.tableFooterView = self.toolbar; 
```

这里链接的另一个问题是，我正在使用 Xcode 的 MasterDetailsView 控制器模板。但我不能只是将工具栏拖到我的 MasterView 中（包含 tableview）。我的第一个猜测是它只是因为我使用的模板而修复了，但我不太确定。

提前致谢！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T18:22:23.657

而不是使用 UITableViewController 尝试使用符合 UITableViewDelegate 和 UITableViewDataSource 的普通 UIViewController。将 UITableView 作为子视图添加到视图控制器的主视图，并将其委托和数据源链接到视图控制器。

现在，您可以将任何其他 UIView 添加到将固定显示在 UITableView 顶部的主视图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-17T01:52:52.860

在该 ViewController 的故事板中，将 Bar Button Item 拖到 tableView 之后的底部，并在 viewDidLoad 方法中......执行以下操作..

```
self.navigationController.toolbarHidden = NO; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-08-26T00:11:06.393

我想我找到了一个非常好的解决方案。

在情节提要视图中，将工具栏从 Tableview 中删除。在故事板视图中，这将使其“浮动”在视图上方，并且工具栏将不再出现在编译的代码中。

也解决这个问题，将以下内容添加到您的视图控制器代码中

```
override func tableView(_ tableView: UITableView, viewForHeaderInSection section: Int) -> UIView? {
        let v = UIView()

        let toolBarView : UIView = UIView(frame: CGRect(x: 0, y: 0, width: UIScreen.main.bounds.width, height: 44))
        mainToolBar.frame = CGRect(x: 0, y: 0, width: UIScreen.main.bounds.width, height: 44)
        toolBarView.addSubview(mainToolBar)

        v.addSubview(toolBarView)
        return v
} 
```

# jquery - 在启动之前延迟功能不起作用

> ID：11528355
> 
> 赞同：0
> 
> 时间：2012-07-17T18:08:49.103
> 
> 标签：jquery, settimeout

我试图延迟我在 jquery 脚本中的一个函数的启动。我设置了一个 settimeout 但由于某种原因它没有占用，它破坏了脚本的其余部分。在此先感谢您提供的任何帮助。

JS

```
<script type="text/javascript">
    $(function () {
        $("#fullscreen_launch").click(function () {
            $("#fullscreen").animate({
                height: '100%',
                top: '0px',
            }, 950, setTimeout(function () {
                $('#fullscreen').load('http://www.klossal.com/portfolio/space_fullscreen.html');
            }, 2000);
            });
        });
    });
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T18:12:11.950

最后一个参数`animate`是回调。 `setTimeout`不返回函数，它返回一个 timeoutID（用于`clearTimeout`）。您需要将函数传递给`animate`.

```
$(function () {
    $("#fullscreen_launch").click(function () {
        $("#fullscreen").animate({
            height: '100%',
            top: '0px',
        }, 950, function () {
            setTimeout(function () {
                $('#fullscreen').load('http://www.klossal.com/portfolio/space_fullscreen.html');
            }, 2000);
        });
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T18:17:12.207

我让你的代码工作了，它位于这里：http: [//jsfiddle.net/VEXfJ/7/](http://jsfiddle.net/VEXfJ/7/)

单步执行代码的一个好方法是添加警报语句。

```
$(function()
{
    $("#fullscreen_launch").click(function()
    {
        alert("Clicked");

        $("#fullscreen").animate(
        {
            top: 0,
            height: 'toggle'
        }, 5000, function()
        {

            alert("animate complete");

            setTimeout(function()
            {
                alert("timeout");
                $('#fullscreen').load('http://www.klossal.com/portfolio/space_fullscreen.html');
            }, 2000);
        });
    });
});​ 
```

# crash - 每次启动时应用程序崩溃

> ID：11528357
> 
> 赞同：0
> 
> 时间：2012-07-17T18:09:09.637
> 
> 标签：crash, startup

我有一个已经在 iOS App Store 上的应用程序。我最近只更改了一些与代码无关的东西，测试了应用程序，它运行良好。我把它送去审查，但更新被拒绝了，因为它在审查期间启动时崩溃了。我现在已经将 Xcode 从 4.1 更新到 4.3.3，现在我的应用程序不会在模拟器或 iPhone 上启动。Xcode 说没有问题，但它仍然无法工作。

它似乎在 dyld_start 中崩溃了

```
0x8fe19063:  movl   %ebp, %esp     <- Thread 1: EXC_BREAKPOINT (code=EXC_1386_BPT, subcode=0x0) 
```

有谁知道这意味着什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-10T14:34:41.297

对于 OSX 应用程序，我也遇到了这个问题——结果发现有一些 dylib 不合适（我的 CMake 脚本已经将它们打乱了）并且主二进制文件无法启动。

不知道您是否可以在 iOS 应用程序上查看控制台输出，但我通过从终端窗口启动应用程序并看到它会吐出有关缺少 dylib 的投诉解决了我的问题 - 看起来 dylib 加载程序会将投诉吐出到 stdout/标准错误。我是 XCode 的新手，所以我不知道如何解决其中的这些错误。

# javascript - 在 node.js 中有没有更好的方法来做到这一点？

> ID：11528358
> 
> 赞同：0
> 
> 时间：2012-07-17T18:09:11.743
> 
> 标签：javascript, node.js, asynchronous

我正在使用 node.js 调用 redis 来获取一些数据。然后需要将数据排序为数组 - 这不是一个昂贵的过程，但我需要一个函数在排序完成后立即异步执行。

如果我在排序代码之后立即编写函数，它将在数组排序完成之前触发。所以我看到了解决这个问题的几种方法：

1) 编写 for() 循环，当前一个循环处于最后一次迭代时，下一个循环开始；在最后，放置异步方法以确保它在所有循环完成后运行。

2) 使用 setTimeout()。我对此感到不安，因为看起来可能取决于需要处理的数组的大小，它可能会神奇地过早或过晚触发。

有没有比嵌套 for 循环更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:12:54.213

您可以使用 setTimeout() 并将等待时间设置为数组大小的某个函数。不过我很同情你， setTimeout() 似乎很可怕。然而，在这样的时候，它是一种必要的邪恶。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T18:21:06.950

我很惊讶您用来访问 Redis 的任何代码都没有异步功能，但这应该可以工作：

```
var done = false;

function sort(){
   ...
   done = true;
}

function sortDone(){
   if(done){
      ...
   }else{
      process.nextTick(sortDone);
   }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T18:21:38.080

看起来你只是想要[`reduceRight`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/ReduceRight)。

```
arr.reduceRight( function( p, c, i ) {
    // sort
    if ( i === 0 ) {
        // You know you're at the last iteration
        // so you can call whatever async func you want
    }
}); 
```

# .net - ASP.NET iFrame 会话变量

> ID：11528361
> 
> 赞同：4
> 
> 时间：2012-07-17T18:09:48.593
> 
> 标签：.net, session, variables, iframe

我有一个通过 iFrame 嵌入到前端站点的网站管理员端的登录页面。在嵌入框架中单击按钮时，将检查登录详细信息并设置会话变量。

假设前端站点的域是`http://SiteA`，iFrame 嵌入为：

```
<iframe name="myFrame" src="http://SiteB/MyLogin.aspx" ></iframe> 
```

在 iFrame 中单击按钮后，SiteA 上的整个窗口将通过 javascript 调用重定向：

```
window.parent.location = "http://SiteB/home.aspx" 
```

`http://SiteB`我希望在重定向后我现在在 SiteB 时存储和访问从 iFrame 创建的会话变量，其 src 为。

这个变量是否仍然被归类为第 3 方会话变量，即使它是在一个框架内创建的，其源与随后被访问的源相同？如果是这样，是否有另一种方法，不使用 p3p 策略或诉诸查询字符串？

**附加信息**

login.aspx 页面在直接访问时按需要工作，而不是在 iFrame 中。当重定向保留在 iFrame 内时，它也可以工作，即

```
window.location = "http://SiteB/home.aspx" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:42:33.553

因为会话变量是在同一个域上创建的，所以从`http://SiteB/Home.aspx`.

# browser - Safari 如何知道何时提示用户保存密码？

> ID：11528368
> 
> 赞同：6
> 
> 时间：2012-07-17T18:10:07.803
> 
> 标签：browser, login, safari

这与[浏览器如何知道何时提示用户保存密码有关？](https://stackoverflow.com/questions/2398763/how-does-browser-know-when-to-prompt-user-to-save-password)除了我的特定于 Safari。

我有一个网站，您可以通过两种不同的方式登录。第一种是主站点，您必须在其中输入您的电子邮件、密码和您的帐户域。第二种方法是实际访问您的域（指向我的服务器），此时您只需要输入您的电子邮件和密码。

以第二种方式登录（两个输入），Safari、Chrome 和 Firefox 都会询问我是否要保存我的用户名和密码（如预期的那样）。

但是以第一种方式登录（三个输入），只有 Chrome 和 Firefox 会询问。Safari 没有。

我的表单不是 AJAX/Javascript。它有一个表单标签、一个提交按钮和三个带有 ID/名称的输入 - 电子邮件、密码（类型=密码）和帐户域。我没有自动完成=关闭。

**有谁知道 Safari 正在寻找什么来要求保存用户名/密码？** 是 b/c 我有三个输入而不是两个？

作为说明，我只使用 Safari 在我妻子的 Mac 上运行了相同的测试，并且在任何一种情况下都没有提示她保存。所以我不知道。

我确认我们都没有为这些网站点击“永远记住密码”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-04-15T05:08:17.807

我遇到了同样的问题，你的帖子回答了我的问题。

我只有一个简单的表单，它只要求输入密码，不会提示手机上的 Safari 保存密码：

```
<fieldset>
<legend>Please login below:</legend>
<form role="form" id="access" name="access" method="post">
    <div class="form-group form-group-sm">
        <label for="password">Password</label>
        <input class="form-control" required type="password" placeholder="Enter Password" name="password" id="password" />
    </div>
    <div class="form-group form-group-sm">
        <input class="btn-lg btn-primary center-block" type="submit" value="Login" />
    </div>
</form> 
```

阅读您的帖子后，我添加了一个“用户名”输入字段，如下所示：

```
<fieldset>
<legend>Please login below:</legend>
<form role="form" id="access" name="access" method="post">
    <div class="form-group form-group-sm">
        <label for="username">Username</label>
        <input class="form-control" required type="text" placeholder="Enter Username" name="username" id="username" />
    </div>
    <div class="form-group form-group-sm">
        <label for="password">Password</label>
        <input class="form-control" required type="password" placeholder="Enter Password" name="password" id="password" />
    </div>
    <div class="form-group form-group-sm">
        <input class="btn-lg btn-primary center-block" type="submit" value="Login" />
    </div>
</form> 
```

添加后，我现在收到保存密码的提示。

所以我认为 Safari 正在寻找用户名、姓名、电子邮件等以配合密码字段。我没有对此进行太多测试，但我相信有更多经验的人可以验证这一点。

谢谢你的帖子。

# ruby - 用 Nokogiri 解析 XML 文件？

> ID：11528374
> 
> 赞同：1
> 
> 时间：2012-07-17T18:10:28.733
> 
> 标签：ruby, xml, xml-parsing, nokogiri

```
<DataSet xmlns="http://www.atcomp.cz/webservices">
  <xs:schema xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata" id="file_mame">...</xs:schema>
  <diffgr:diffgram xmlns:msdata="urn:schemas-microsoft-com:xml-msdata" xmlns:diffgr="urn:schemas-microsoft-com:xml-diffgram-v1">
    <alldata xmlns="">
      <category diffgr:id="category1" msdata:rowOrder="0">
        <category_code>P.../category_code>
        <category_name>...</category_name>
        <subcategory diffgr:id="subcategory1" msdata:rowOrder="0">
          <category_code>...</category_code>
          <subcategory_code>...</subcategory_code>
          <subcategory_name>...</subcategory_name>
        </subcategory>
.... 
```

我怎样才能获得所有`categories`和`subcategories`数据？

我正在尝试类似的东西：

```
reader.xpath('//DataSet/diffgr:diffgram/alldata').each do |node| 
```

但这给了我：

```
undefined method `xpath' for #<Nokogiri::XML::Reader:0x000001021d1750> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T18:54:08.583

Nokogiri 的[阅读器](http://nokogiri.org/Nokogiri/XML/Reader.html)解析器不支持 XPath。尝试改用 Nokogiri 的内存中[文档](http://nokogiri.org/Nokogiri/XML/Document.html)解析器。

另一方面，要查询[xpath](http://nokogiri.org/Nokogiri/XML/Node.html#method-i-xpath)命名空间，您需要提供命名空间映射，如下所示：

```
doc = Nokogiri::XML(my_document_string_or_io)

namespaces = { 
  'default' => 'http://www.atcomp.cz/webservices', 
  'diffgr' => 'urn:schemas-microsoft-com:xml-diffgram-v1' 
}
doc.xpath('//default:DataSet/diffgr:diffgram/alldata', namespaces).each do |node|
  # ...
end 
```

或者您可以[删除命名空间](http://nokogiri.org/Nokogiri/XML/Document.html#method-i-remove_namespaces-21)：

```
doc.remove_namespaces!
doc.xpath('//DataSet/diffgram/alldata').each { |node|  } 
```

# zshrc - PS1中的zsh随机颜色

> ID：11528381
> 
> 赞同：3
> 
> 时间：2012-07-17T18:11:01.017
> 
> 标签：zshrc

我的`.bashrc` `PS1`（删节）是

```
\u\[\e[01;3$(($RANDOM % 8))m\]@\h \w $' 
```

使用 bash 的工作方式，它会在每个命令之后插入随机颜色，因此每次`@`都是不同的颜色（至少在 31-37 范围内）。

但是，我一直无法在 zsh 中做类似的事情。该`$''`语法不允许命令替换，并且连接也不起作用：

```
$'\e[01;3'$(($RANDOM % 8))
# The \e[01;3 character is printed first, then the random number 
```

使用引号`"`也不起作用；它只是打印出一个文字`\e...`

我知道 zsh 也有一些内置的文本颜色，例如`%{$fg[red]%}`，我可以以某种方式从数组中选择一种随机颜色，但问题是它需要由 随机选择，`PS1`而不仅仅是在启动时随机选择只有一次。

有什么办法可以在 zsh 的 PS1 中插入一个随机数来实现这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T20:12:54.920

您可以使用将在每个提示之前评估的[`precmd`钩子：](http://zsh.sourceforge.net/Doc/Release/Functions.html#Hook-Functions)

```
randomise_prompt_colour () {
  PS1="%n%B%F{$((RANDOM % 8))}@%m %~ %(!.#.\$) "
}

add-zsh-hook precmd randomise_prompt_colour 
```

# java - 分层死锁（有依赖关系），...或者：我如何让我的“等待”、“通知”和设计正确？

> ID：11528383
> 
> 赞同：0
> 
> 时间：2012-07-17T18:11:07.033
> 
> 标签：java, multithreading, deadlock, wait, notify

```
// multiple server instances (replicas), coordinated using MsgCoordinationService
public class Server {

    ConcurrentHashMap<TxID,Future<Msg>> local_registry = new ...
    MsgCoordinationService coordination_service = new .. 

    ...

    // Socket instance to communicate with a client...
    public void accept(Socket s) {
        new Thread(new Worker(s)).start();
    }

    // propose msg to coordination service, register demand to respond to client in local registry
    public Future<Msg> register(Msg m) {
        FutureMsg f = new MsgFuture(); // Future handle w. reference to an empty Msg object [= response]
        TxID uniqueID = coordination_service.propose(s); // transaction ID
        local_registry.add(uniqueID, f);
        return f;
    }

    // called by coordination service, guaranteeing a global order on msg deliveries
    public synchronized void deliver(TxID id, Msg m) {
        ... process Msg object [request]
        ... if local_registry.contains(id), 'compile' response
            (using the Msg object from FutureMsg f, f.get() - f.isDone() when a certain Msg flag has been set)

        ___ now:
        ... notify waiting 'Worker' threads to check whether their 'Future' object isDone()
    }

    private class Worker implements Runnable {
        ...
        public void run() {
            ...
            Future<Msg> f = Server.this.register(request); // obtained through Socket s

            while(!f.isDone())
                wait();

            response = f.get();
            ...
        }
    }
} 
```

我正在实现一个复制服务[多个服务器，客户端通信 w。单个服务器实例，创建/更新/删除操作将通过协调服务分发，该协调服务保证消息传递的全局顺序]。

一旦客户端与服务器实例建立新连接，所有通信都通过专用`Worker`实例进行引导[该实例在本地处理读取请求，并使用广播 C/U/D 操作`Server.this.register(...)`]。

`register`它本身基本上记录未来本地处理/回复的请求 - 并将`Msg`对象转发给协调服务。

服务通过 , ... 重新传递`Msg`对象`deliver`，在处理完封装的任务后，`Worker`将通知最初收到客户端请求的实例交出相应的响应。

由于某些原因，我的设计似乎被打破了...... - w/o `synchronized(this)`[in `Worker#run()`]，`wait()`不会等待；，`synchronized(this)`a `notifyAll()`in`Server#deliver(...)`不会释放“阻塞”`Worker`实例上的锁。

长话短说：事实证明，我需要你的帮助......要么（a）：了解基础知识`wait/notify/notifyAll`要么（b）：改进我的设计......要么（c）：（a）*和*（b ）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T19:16:38.887

线程调用`wait/notify`需要锁定调用这些方法的对象，否则会出现异常。在一般形式中，假设一个任意对象：

```
final Object obj = new Object();
...

synchronized(obj) {
    while(/* condition */) {
       obj.wait();
    }
} 
```

`wait`你没有被释放的原因`notify`是你`this.wait()`在一个与你调用的对象不同的对象内部进行操作`notify`，因此它们没有配对。您需要对两个调用使用相同的实例。您`this.wait()`在 的实例中`Worker`执行和`this.notifyAll()`在 的实例中执行`Server`，因此`this`不引用同一个对象。

您应该创建一个跨类和线程可见的同步对象并在该对象上进行同步。

# java - Android GPS 定位 - 删除更新

> ID：11528384
> 
> 赞同：0
> 
> 时间：2012-07-17T18:11:08.267
> 
> 标签：java, android, gps, locationlistener

我只是无法删除我的应用程序中的位置监听。我在 onCreate 方法中使用它：

```
locationManager = (LocationManager) this.getSystemService(Context.LOCATION_SERVICE); 
locationListener = new MyLocationListener();
locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 2000, 10, locationListener); 
```

这在我的 onPause/onStop/onDestroy 方法中：

```
locationManager.removeUpdates(locationListener); 
```

但是当我关闭我的应用程序时，卫星图标仍然存在。为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T20:41:47.897

Solved by a new onResume method:

```
protected void onResume() {
    super.onResume();
    locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 2000, 10, locationListener);
} 
```

# c# - 使用 htmlagilitypack 选择 div 并放入集合不起作用

> ID：11528387
> 
> 赞同：1
> 
> 时间：2012-07-17T18:11:27.733
> 
> 标签：c#, vb.net, html-agility-pack

为什么这不起作用？我在 foreach 循环开始时收到空引用异常错误

我正在尝试获取页面上的所有 div 文本并将每个文本放入我自己的集合中

```
Imports HtmlAgilityPack
Imports System.Xml

Partial Class _Default
    Inherits System.Web.UI.Page

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

        Dim webGet As HtmlWeb = New HtmlWeb
        Dim htmlDoc As HtmlDocument = webGet.Load("http://www.mysite.com")

        Dim ids As New List(Of String)()

        For Each div As Object In htmlDoc.DocumentNode.SelectNodes("//div")

            ids.Add(div.InnerText)

        Next

    End Sub
End Class 
```

***例外***

> 你调用的对象是空的。说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 
> 异常详细信息：System.NullReferenceException：对象引用未设置为对象的实例。
> 
> 源错误：
> 
> 第 12 行：Dim ids As New List(Of String)() 第 13 行：
> 第 14 行：对于每个 div 作为 htmlDoc.DocumentNode.SelectNodes("//div") 中的对象 第 15 行：
> 第 16 行：ids.Add(div.内文）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:23:50.413

您的代码看起来正确。也许 URL“http://www.mysite.com”没有返回有效的 HTML。

下面的代码有效：

```
Imports HtmlAgilityPack

Public Class _Default
    Inherits System.Web.UI.Page

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        Dim webGet As HtmlWeb = New HtmlWeb
        Dim htmlDoc As HtmlDocument = webGet.Load("http://stackoverflow.com/q/11528387/1350308")

        Dim ids As New List(Of String)()
        TextBox1.Text = ""
        For Each div As HtmlNode In htmlDoc.DocumentNode.SelectNodes("//div")
            TextBox1.Text += div.Id + Environment.NewLine
        Next
    End Sub

End Class 
```

TextBox1 中的结果是：

```
noscript-padding
notify-container
overlay-header
custom-header

header
portalLink
topbar
hlinks
hsearch

hlogo
hmenus

content

question-header
mainbar
question
adzerk1

comments-11528387

answers
answers-header

tabs
answer-11528559

comments-11528559

post-editor

wmd-button-bar

draft-saved
draft-discarded
wmd-preview

sidebar
newuser-box

adzerk2
hireme

feed-link
feed-link-text

prettify-lang
footer

footer-menu
footer-sites
footer-flair
svnrev
copyright
noscript-warning 
```

完整来源：[Q11528387WebApp.7z](https://dl.dropbox.com/u/49510149/stackoverflow/dotnet/Q11528387WebApp.7z)

# audio - .Ogg 与 .mp3 用于移动应用程序？

> ID：11528388
> 
> 赞同：3
> 
> 时间：2012-07-17T18:11:29.247
> 
> 标签：audio, mobile, mp3, html5-audio, ogg

我正在为 Android、Windows Phone、IOS 和黑莓构建一个移动应用程序。

它是一个音频应用程序，我想知道我应该使用 ogg 还是 mp3？

Ogg 似乎更压缩，这是一件好事，但我不确定它可以在 4 个平台中的哪个平台上运行，质量是否更差？

我不需要为所有平台使用相同的文件格式，因此请为 4 个平台中的每一个提供最佳选择。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-17T18:17:14.890

[iOS](http://developer.apple.com/library/ios/#documentation/AudioVideo/Conceptual/MultimediaPG/UsingAudio/UsingAudio.html)和[Windows Phone 7](http://msdn.microsoft.com/en-us/library/ff462087%28v=vs.92%29.aspx)无法自行播放 OGG 音频文件，除非您愿意自己编写解码器（您无法在 Windows Phone 7 上这样做，因为您没有对音频硬件的原始访问权限）。

[从 BlackBerry OS v5 开始，黑莓](http://docs.blackberry.com/en/smartphone_users/deliverables/18349/711-01774-123_Supported_Media_Types_on_BlackBerry_Smartphones.pdf)确实支持开箱即用的 OGG。

[Android](http://developer.android.com/guide/appendix/media-formats.html)将其列为受支持的编解码器，但由于 Android 的开源性质，运营商完全有可能在没有编解码器的情况下交付产品（我不知道这是否已在实践中完成）。

但是，所有这些平台都可以开箱即用地播放 MP3。您最好使用 MP3，因为它无处不在。

如果您使用可变比特率而不是恒定比特率，您可能能够获得类似 OGG 的 MP3 大小。

# sql-server - 使用 XML 更新 SQL Server 表

> ID：11528393
> 
> 赞同：3
> 
> 时间：2012-07-17T18:12:05.007
> 
> 标签：sql-server, xml, xquery

我有一个如下所示的 XML 变量：

```
<code>
<IDs>
    <ID id="1">a</ID>
    <ID id="43">d</ID>
    <ID id="3">b</ID>

</IDs>
</code> 
```

我想在将更新表的存储过程（SQL Server）中使用它。

我的表如下所示：

```
ID INT,
a INT,
b INT,
c INT,
d INT 
```

该语句应增加与 id 关联的字母值。

所以它看起来像这样：

```
Table Row with ID = 1, update column "a" by increasing the current value by 1.
Table Row with ID = 43 - update column "d" by increasing current value by 1.
Finally Table row with ID= 3 - update column "b" by increasing value by 1. 
```

这是我到目前为止所拥有的 - （第二行是我最需要帮助的地方。）：

```
Update MyTable
SET @letter = letterVal +1
WHERE ID IN(
SELECT x.v.value('@id','INT')
FROM @xmlIDs.nodes('/IDs/ID') x(v)
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T18:38:45.207

您将不得不按照以下方式做一些事情：

```
DECLARE @input XML = '<code>
<IDs>
    <ID id="1">a</ID>
    <ID id="43">d</ID>
    <ID id="3">b</ID>

</IDs>
</code>'

;WITH ParsedXML AS
(
SELECT
    ID = C.value('(@id)[1]', 'int'),
    ColumnName = C.value('(.)[1]', 'varchar(10)')
FROM @Input.nodes('/code/IDs/ID') AS T(C)
)
UPDATE MyTable 
SET a = CASE WHEN p.ColumnName = 'a' THEN t.a + 1 ELSE t.a END,
    b = CASE WHEN p.ColumnName = 'b' THEN t.b + 1 ELSE t.b END,
    c = CASE WHEN p.ColumnName = 'c' THEN t.c + 1 ELSE t.c END,
    d = CASE WHEN p.ColumnName = 'd' THEN t.d + 1 ELSE t.d END
FROM MyTable t
INNER JOIN ParsedXml p ON t.ID = p.ID

SELECT * FROM Mytable 
```

这会做到 - 但它真的很丑陋。主要问题是：你不能从其他地方获取列名作为值，在`UPDATE`语句中使用它 - 除非你走动态 SQL 路线，它有自己的优点和缺点，并且可能会变得相当混乱。

如果您对动态 SQL 感兴趣 - Erland Sommarskog[的动态 SQL 的诅咒和祝福是](http://www.sommarskog.se/dynamic_sql.html)**绝对必读的**- 在开始使用动态 SQL**之前**阅读它！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T20:53:16.063

一种动态 SQL 解决方案。不太漂亮但完全动态：

```
IF OBJECT_ID('tempdb..#tmp') IS NOT NULL DROP TABLE #tmp
GO
CREATE TABLE #tmp ( ID INT, a INT, b INT, c INT, d INT )
GO

INSERT INTO #tmp VALUES
    ( 1, 0, NULL, NULL, NULL ),
    ( 43, NULL, NULL, NULL, 0 ),
    ( 3, NULL, 0, NULL, NULL )
GO

SELECT 'before' s, * FROM #tmp

DECLARE @xml XML

SET @xml = '<code>
  <IDs>
    <ID id="1">a</ID>
    <ID id="43">d</ID>
    <ID id="3">b</ID>
  </IDs>
</code>'

-- Run a cursor through the XML resultset to update the table
DECLARE update_cursor CURSOR FAST_FORWARD LOCAL FOR 
SELECT
    x.y.value('@id', 'INT') id,
    x.y.value('.', 'VARCHAR(50)') columnName
FROM @xml.nodes('code/IDs/ID') AS x(y)

-- Cursor variables
DECLARE @id INT, @columnName VARCHAR(50)
DECLARE @sql NVARCHAR(MAX)

OPEN update_cursor

FETCH NEXT FROM update_cursor INTO @id, @columnName
WHILE @@fetch_status = 0
BEGIN

    --SELECT @id, @columnName

    SET @sql = 'UPDATE #tmp SET ' + @columnName + ' += 1 WHERE ID = ' + CAST( @id AS VARCHAR(20) )

    EXEC(@sql)
    --SELECT @sql

    FETCH NEXT FROM update_cursor INTO @id, @columnName
END

CLOSE update_cursor
DEALLOCATE update_cursor
GO

SELECT 'after' s, * FROM #tmp 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T18:55:53.047

我建议您将 XML 更改为如下所示：

```
<questions>
    <question id="1" answer="a" />
    <question id="43" answer="d" />
    <question id="3" answer="b" />
</questions> 
```

使用这种格式，您可以编写如下查询：

```
with CTE as (
    select
         x.n.value('@answer', 'char(1)') as answer
    from
        @Input.nodes('//questions/question') as x(n)
)
select 
    answer,
    count(answer) as answerCount
from
    CTE
group by
    answer; 
```

然后，您可以根据需要将这些添加到表格中，但您设计的表格看起来并不是很有用。

# objective-c - 与 Dynamic Tableview Height For Row 一起使用时核心数据消耗大量内存

> ID：11528401
> 
> 赞同：1
> 
> 时间：2012-07-17T18:12:46.803
> 
> 标签：objective-c, ios, core-data, memory-management, nsfetchedresultscontroller

我的核心数据在我的 iPhone 上消耗大量内存时遇到问题。在开始时，我设置了一个 fetchrequest，如下所示：

```
NSEntityDescription *entity = [NSEntityDescription entityForName:@"Tweets" inManagedObjectContext: [[ChubbyEyetwitterEngine sharedInstance] getManagedObjectContextForUse]]; 

NSPredicate *predicate =[NSPredicate predicateWithFormat:@"isWatchList==NO && favorited == NO  && accountHolder.id_str == %@ ",[[ChubbyEyetwitterEngine sharedInstance] getActiveUserID]];

// Define how we will sort the records
NSSortDescriptor *sortDescriptor = [[[NSSortDescriptor alloc] initWithKey:[sortTweetaryTimeLine objectForKey:@"sortKey"] ascending:[[sortTweetaryTimeLine objectForKey:@"ascending"] boolValue]] autorelease];   

NSSortDescriptor *secondarySortKey = [[[NSSortDescriptor alloc] initWithKey:@"created_at" ascending:FALSE] autorelease]; 

NSArray *sortDescriptors = [NSArray arrayWithObjects:
                            sortDescriptor,
                            secondarySortKey,nil];

NSFetchRequest *request = [[[NSFetchRequest alloc] init] autorelease];
[request setEntity:entity];
[request setPredicate:predicate];
[request setSortDescriptors:sortDescriptors];

if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) 
{
    //smaller batch on iphone
    [request setFetchBatchSize:12];

}else {
    //bigger on the ipad
    [request setFetchBatchSize:100];

}

//prefetching important relationships to cache data
[request setRelationshipKeyPathsForPrefetching:[NSArray arrayWithObjects:@"ownerOfThisTweetary",@"thisEntity", nil]];

diaryFetchResultsController= [[NSFetchedResultsController alloc] initWithFetchRequest:request managedObjectContext:[[ChubbyEyetwitterEngine sharedInstance] getManagedObjectContextForUse] sectionNameKeyPath:[sortTweetaryTimeLine objectForKey:@"sectionName"] cacheName:nil] ;   

NSError *fetchError = nil;
if ([diaryFetchResultsController performFetch:&fetchError]) {

}else
{

}

diaryFetchResultsController.delegate = self; 
```

在此之后，我在我的 tabeview 上调用 reloadData。在我的表格视图中，我根据 text 属性的长度以及 managedobject 上的其他属性动态计算单元格的高度并返回高度。

这里的问题是，在调用重新加载数据时，fetchedresultscontroller 中的所有对象都调用了 heightforrow，这反过来又将对象错误地放入内存。现在我的 tableview 有很多对象，进入数百个，我的内存消耗激增。

我正在寻找一种节省内存的方法：

我尝试做的事情：[diaryFetchResultsController.managedObjectContext setStalenessInterval:2.0]; 这没有任何效果，或者至少是我可以看到的效果，所以我尝试了其他方法->

在 heightForRowAtIndexPath 内，计算高度后，我尝试了 [diaryFetchResultsController.managedObjectContext refreshObject:object mergeChanges:YES]; 结果很糟糕，并导致了无限循环，实际发生的是当对象出现故障时，系统会自动为该索引路径调用 heightForRowAtIndexPath。

我的第二次尝试是从 heightForRowAtIndexPath 中删除刷新对象，而是在 cellForRowAtIndexPath 的末尾插入。结果与上述相同。

我的第三次尝试::

-（无效）turnMeBackIntoAfault{

```
 for (id object in diaryFetchResultsController.fetchedObjects){

    [diaryFetchResultsController.managedObjectContext refreshObject:object mergeChanges:YES];
 } 
```

}

然后我在 tableview 上调用 reloadData 后立即调用此方法。结果是对所有单元格调用了一次 heightForRowAtIndexPath（如预期的那样），然后在所有管理对象上调用了 turnMeBackIntoAfault。然而，坏消息是，在系统之后立即再次为所有单元格调用 heightForRowAtIndexPath，因此否定了将对象转回故障的影响。我还尝试在出错之前将 tableveiw 代表和数据源设置为 nil 并将 fetchedresultscontroller 代表设置为 nil，并在循环后再次将它们设置回自身，但效果仍然相同。

现在我绝对确定它的 heightForRowAtIndexPath 会导致大量内存消耗。我已经尝试过注释掉的 heightForRowAtIndexPath，我有几乎超过 1.5 倍的可用内存可用。

拥有动态行对我的应用程序至关重要，并且由于我的应用程序广泛使用 fetchedresultControllers 和 tableviews，我遇到了内存不足的情况。

任何节省内存的帮助将不胜感激！我整天都在为此挠头

# java - 如何使用 RichFaces 'repeat' 标记迭代 java Iterable？

> ID：11528402
> 
> 赞同：2
> 
> 时间：2012-07-17T18:12:49.747
> 
> 标签：java, jsf, iterator, richfaces

在 Java 中，我可以使用 for 循环来迭代 ArrayLists 或 Iterables。在 RichFaces 中，我可以使用 facelet“repeat”标签来迭代 ArrayList，但不能迭代 Iterables。我从使用 Iterable 中得到的错误消息是找不到 Iterable 中项目的属性或方法。我应该如何对 Iterable 进行编码，以便 RichFaces 将其中的项目视为正确的类，就像 Java 本身一样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T18:37:32.850

基于`org.richfaces.component.UISequence#createFacesModel`a4j:repeat （以及其他 RichFaces 数据迭代组件（rich:list、rich:dataTable 等））的 value 属性的有效类型如下：

```
javax.faces.model.DataModel
java.util.List
java.lang.Object[]
java.sql.ResultSet
javax.servlet.jsp.jstl.sql.Result 
```

因此，在您的情况下，iterables 应该实现`java.util.List`接口。

# grails - 在 Grails 中编写用于测试数据库持久性的集成测试

> ID：11528403
> 
> 赞同：0
> 
> 时间：2012-07-17T18:12:51.790
> 
> 标签：grails, integration-testing

当我尝试使用 grails 动态 get 方法获取域对象时，我的 grails 应用程序的集成测试返回一个空对象。这是我的问题的简化示例。假设我有一个控制器**TrackerLogController**，它使用服务**TrackerLogService**为另一个**Tracker**域保存更新的**日志**域。域跟踪器：

 **```
class Tracker {

   int id
   String name

   static hasMany = [logs: Log] 
} 
```

域日志：

```
class Log {
   int id
   String comment

   static belongsTo = [tracker: Tracker]
} 
```

控制器 TrackerLogController 保存：

```
def TrackerLogService

def saveTrackerLog() {

   def trackerId = params.trackerId

   def trackerInstance = Tracker.get(trackerId)
   Log log = TrackerLogService.saveTrackerLogs(trackerInstance, params.comment)
   if( log.hasErrors() ){
      //render error page
   }
   //render good page
} 
```

Service TrackerLogService 保存：

```
Log saveTrackerLogs( Tracker tracker, String comment) {
   Log log = new Log(tracker: tracker, comment: comment)
   log.save()
   return log
} 
```

所以现在我想为这个服务编写一个集成测试，但我不确定我是否应该只为控制器中的简单逻辑编写一个（如果错误，错误页面，否则是好页面）我想我会写一个对此进行单元测试，并进行集成测试以检查数据库中的持久性。

这就是我的集成测试：

```
class TrackerLogServiceTests {

   def trackerLogService

   @Before
   void setUp(){

      def tracker = new Tracker(id: 123, name: "First")

      tracker.save()

      //Now even if I call Tracker.get(123) it will return a null value...
   }

   @Test
   void testTrackerLogService() {
      Tacker trackerInstance  = Tracker.get(123) //I have tried findById as well 

      String commit = "This is a commit" 

      //call the service
      Log log = trackerLogService.saveTrackerLogs(trackerInstance , commit)

      //want to make sure I added the log to the tracker Instance
      assertEquals log , trackerInstance.logs.findByCommit(commit)
   }
} 
```

所以对于这个例子，我的 trackerInstance 将是一个空对象。我知道 Grails 魔法似乎不适用于没有 Mocking 的单元测试，我认为对于数据库中的持久性的 Intigration-Tests，您将能够使用 Grails 魔法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T18:46:34.633

除非您声明它是“已分配的”，否则您不能指定 id 值。因为它现在使用自动增量，所以不使用您的 123 值。出于安全原因，地图构造函数实际上忽略了它，因此您需要这样做：

```
def tracker = new Tracker(name: "First")
tracker.id = 123 
```

但随后它会被自动增量查找覆盖。请改用此方法：

```
class TrackerLogServiceTests {

   def trackerLogService

   private trackerId

   @Before
   void setUp(){    
      def tracker = new Tracker(name: "First")
      tracker.save()
      trackerId = tracker.id
   }

   @Test
   void testTrackerLogService() {
      Tacker trackerInstance  = Tracker.get(trackerId)

      String commit = "This is a commit" 

      //call the service
      Log log = trackerLogService.saveTrackerLogs(trackerInstance , commit)

      //want to make sure I added the log to the tracker Instance
      assertEquals log , trackerInstance.logs.findByCommit(commit)
   }
} 
```

此外，不相关 - 不要声明该`id`字段，除非它是非标准类型，例如字符串。Grails 为您添加了该字段以及该`version`字段。所有你需要的是

```
class Tracker {
   String name
   static hasMany = [logs: Log] 
} 
```

和

```
class Log {
   String comment
   static belongsTo = [tracker: Tracker]
} 
```**

# c - 关于通过引用指针复制数组的说明

> ID：11528407
> 
> 赞同：1
> 
> 时间：2012-07-17T18:12:55.957
> 
> 标签：c, arrays, pointers

所以我在这样的头文件中有这个数组：

```
// header.h
static const unsigned int array1[]={0x00,0x01,0x02,0x03}; 
```

和：

```
// file.c
main()
{
     unsigned int *ptrToArray;

     ptrArray = &array1[0];
 } 
```

如果我错了，请纠正我。我假设：找到数组元素的字节数，而不是`sizeof(array1)`等价的`sizeof(*ptrArray)`，对吧？

并且要访问数组的元素，而不是`array[i]`，现在将是：

*   `*(ptrArray)`对于第一个元素，
*   `*(ptrArray+1)`对于第二个元素，对吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T18:16:41.367

的类型`*ptrToArray`是`int`，因此`sizeof(*ptrToArray)`与 相同`sizeof(int)`。所以它不会告诉你任何关于`array1`.

虽然你可以写`*(ptrArray+1)`，等等，但你应该写`ptrToArray[1]`！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T18:20:38.117

指针不是数组，数组也不是指针。数组可以在方便的时候*衰减*为指针，但它仍然是一个完整的类型。

因此， 的类型`*someIntPointer`是`int`，而不是数组，即使该指针恰好指向数组中的第一个元素。 `sizeof(someArray)`正如你所期望的那样工作，因为它知道类型实际上是一个数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T18:18:50.707

`sizeof` **指针的**行为方式不同：您的示例将为您提供*数据类型*的大小: `unsigned int`。

虽然您可以使用指针算法通过 引用元素`ptrArray`，但您也可以使用标准数组解引用：`ptrArray[0]`, `ptrArrray[1]`, ... 在大多数情况下，您最好这样做。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-07-17T18:17:58.210

Sizeof 将返回常规指针类型的指针大小。如果您对取消引用的指针类型进行 sizeof，您将获得元素的大小（即 sizeof(unsigned int)）。您需要自己跟踪数组中的元素数量，或者在数组声明中使用 sizeof。

至于访问，您可以这样做，但您可以像使用普通数组一样使用括号表示法。

数组是一类特殊的指针。编译器知道何时将数组视为数组以及何时将其视为指针：这就是它知道数组有多大的方式，但您仍然可以将它传递给期望数组的函数（当您这样做时，您会得到指向第一个元素的指针）。然而，这同样不能反过来工作：编译器永远不会将声明为指针的指针视为数组。

顺便说一句，`[]`只是简化为指针算术。您可以将指针添加到 int，但也可以将 int 添加到指针。因此，您可以（但可能不应该）做一些奇怪的事情，例如`1[ptrArray]`

# html - drupal html中首页块之间的特定div

> ID：11528409
> 
> 赞同：0
> 
> 时间：2012-07-17T18:13:12.693
> 
> 标签：html, drupal-7, drupal-views

我不确定我是否纠正了提到的话题。但这是我必须做的

```
 <div class="block block-views">...</div>
<div class="block block-views">...</div>
<div class="clear"></div>
<div class="block block-views">...</div>
<div class="block block-views">...</div>
<div class="clear"></div>
<div class="block block-views">...</div>
<div class="block block-views">...</div> 
```

我如何 `<div class="clear">` 在每个 2(!) 块之后放置？避免使用 .block-views:nth-child(2n+1) { clear: left; }。块的数量可以从 2 到 10 不等。对于浮动的块，我需要这个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T08:10:57.630

你可以使用 CSS 做到这一点，试试这个：

```
<div id="view-1" class="block block-views">...</div>
<div id="view-2" class="block block-views">...</div>
<div class="clear"></div>
<div id="view-3" class="block block-views">...</div>
<div id="view-4" class="block block-views">...</div> 
```

在你的css中，写下这段代码：

```
#view-2:after, #view-4:after
{
    clear: both;
    content: ".";
    display: block;
    height: 0;
    visibility: hidden;
} 
```

您应该得到与使用`.clear`div 相同的结果。

希望这行得通……穆罕默德。

# adobe - 在 InDesign CS6 中使用“a href=”和“rel=”链接

> ID：11528419
> 
> 赞同：1
> 
> 时间：2012-07-17T18:13:48.903
> 
> 标签：adobe, adobe-indesign

我正在尝试在 inDesign 中创建一个超链接或一个按钮，它不仅链接到一个 URL，而且还允许传递一个 'rel=' 参数。

因此，您可以输入类似于 `<a href="http://youtu.be/kh29_SERH0Y?rel=0" rel="lightbox" title="YouTube Video">`可以点击的内容，而不是只输入链接地址的“转到网址”。

# wpf - 在分组列表视图中滚动

> ID：11528423
> 
> 赞同：9
> 
> 时间：2012-07-17T18:14:02.700
> 
> 标签：wpf, listview, scrollbar, grouping

我很绝望....让我的 WPF 分组列表视图工作...我无法在我的列表视图中滚动...

在我的示例应用程序中，我有一个带有两个扩展器的 Listview。第一个包含很多listviewitems ...所以需要滚动...但是如果我使用“该死的滚动条”它会直接跳转到下一个扩展器（在我的情况下是扩展器2of2）......所以这是不可能的正确滚动...

第一张截图： ![查看 1](../Images/2fd12aaf67bedcfff7c453dc9bf074a8.png)

第二张截图： ![查看 2](../Images/27b4103ad18953a7cb4cf29670fbb856.png)

我的列表视图样式：

```
 <Style x:Key="list12" TargetType="ListView">
    <Setter Property="SnapsToDevicePixels" Value="true"/>
    <Setter Property="OverridesDefaultStyle" Value="true"/>
    <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto"/>
    <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto"/>
    <Setter Property="ScrollViewer.CanContentScroll" Value="true"/>
    <Setter Property="VerticalContentAlignment" Value="Center"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="ListView">
                <Border Name="Border" BorderThickness="1" BorderBrush="#999999" Background="#DFDFDF">
                    <ScrollViewer Style="{DynamicResource {x:Static GridView.GridViewScrollViewerStyleKey}}">
                        <ItemsPresenter />
                    </ScrollViewer>
                </Border>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

我的 GridView.GridViewScrollViewerStyle：

```
<Style x:Key="{x:Static GridView.GridViewScrollViewerStyleKey}" TargetType="ScrollViewer">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="ScrollViewer">
                <Grid Background="{TemplateBinding Background}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <DockPanel Margin="{TemplateBinding Padding}">
                        <ScrollViewer DockPanel.Dock="Top" HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Hidden" Focusable="false">
                            <GridViewHeaderRowPresenter Margin="0,0,0,0" Columns="{Binding Path=TemplatedParent.View.Columns,
                                RelativeSource={RelativeSource TemplatedParent}}" ColumnHeaderContainerStyle="{Binding Path=TemplatedParent.View.ColumnHeaderContainerStyle, RelativeSource={RelativeSource TemplatedParent}}"
                                ColumnHeaderTemplate="{Binding Path=TemplatedParent.View.ColumnHeaderTemplate,RelativeSource={RelativeSource TemplatedParent}}"
                                ColumnHeaderTemplateSelector="{Binding Path=TemplatedParent.View.ColumnHeaderTemplateSelector, RelativeSource={RelativeSource TemplatedParent}}"
                                AllowsColumnReorder="{Binding Path=TemplatedParent.View.AllowsColumnReorder, RelativeSource={RelativeSource TemplatedParent}}"
                                ColumnHeaderContextMenu="{Binding Path=TemplatedParent.View.ColumnHeaderContextMenu, RelativeSource={RelativeSource TemplatedParent}}"
                                ColumnHeaderToolTip="{Binding Path=TemplatedParent.View.ColumnHeaderToolTip, RelativeSource={RelativeSource TemplatedParent}}"
                                SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                        </ScrollViewer>
                        <ScrollContentPresenter Name="PART_ScrollContentPresenter"
                                KeyboardNavigation.DirectionalNavigation="Local"
                                CanContentScroll="True" CanHorizontallyScroll="False"
                                CanVerticallyScroll="False"/>
                    </DockPanel>
                    <ScrollBar Name="PART_HorizontalScrollBar" Orientation="Horizontal" Grid.Row="1" Maximum="{TemplateBinding ScrollableWidth}" ViewportSize="{TemplateBinding ViewportWidth}" Value="{TemplateBinding HorizontalOffset}" Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}"/>
                    <ScrollBar Name="PART_VerticalScrollBar" Grid.Column="1" Maximum="{TemplateBinding ScrollableHeight}" ViewportSize="{TemplateBinding ViewportHeight}" Value="{TemplateBinding VerticalOffset}" Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}"/>
                </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

我的 ListViewItemContainerStyle：

```
<Style x:Key="ListViewItemContainerStyle" TargetType="{x:Type ListViewItem}">
        <Setter Property="Background" Value="#ffffff" />
        <Setter Property="HorizontalContentAlignment" Value="Left" />
        <Setter Property="VerticalContentAlignment" Value="Center" />
        <Setter Property="Foreground" Value="Black" />
        <Setter Property="Margin" Value="0,0,0,0" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ListViewItem}">
                    <Border x:Name="Bd" Background="{TemplateBinding Background}" SnapsToDevicePixels="true" BorderThickness="0,0,0,1" BorderBrush="#6FBDE8">
                        <GridViewRowPresenter VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsSelected"  Value="true">
                            <Setter TargetName="Bd" Property="BorderBrush" Value="#FF143c65" />
                            <Setter Property="Background" TargetName="Bd">
                                <Setter.Value>
                                    <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                        <LinearGradientBrush.GradientStops>
                                            <GradientStopCollection>
                                                <GradientStop Color="#FF75aac7" Offset="0"/>
                                                <GradientStop Color="#FF143c65" Offset="1"/>
                                            </GradientStopCollection>
                                        </LinearGradientBrush.GradientStops>
                                    </LinearGradientBrush>
                                </Setter.Value>
                            </Setter>
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="Bd" Property="Background" Value="#e0eff8" />
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsSelected" Value="true" />
                                <Condition Property="Selector.IsSelectionActive" Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter Property="Background" TargetName="Bd">
                                <Setter.Value>
                                    <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                        <LinearGradientBrush.GradientStops>
                                            <GradientStopCollection>
                                                <GradientStop Color="#FF75aac7" Offset="0"/>
                                                <GradientStop Color="#FF143c65" Offset="1"/>
                                            </GradientStopCollection>
                                        </LinearGradientBrush.GradientStops>
                                    </LinearGradientBrush>
                                </Setter.Value>
                            </Setter>
                            <Setter Property="BorderBrush" TargetName="Bd" Value="#FF143c65"/>
                            <Setter Property="Foreground" Value="White"/>
                        </MultiTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style> 
```

只是我的列表视图：

```
<ListView  Style="{StaticResource list12}" Name="ListView1" ItemsSource="{Binding}" ItemContainerStyle="{DynamicResource ListViewItemContainerStyle}" Margin="0,44,0,0">
                        <ListView.GroupStyle>
                            <GroupStyle>
                                <GroupStyle.ContainerStyle>
                                    <Style TargetType="{x:Type GroupItem}">
                                        <Setter Property="Template" >
                                            <Setter.Value>
                                                <ControlTemplate TargetType="{x:Type GroupItem}">
                                                    <Expander IsExpanded="true" BorderThickness="0,0,0,1" Margin="10">
                                                            <Expander.Header>
                                                            <Grid>
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition/>
                                                                    <ColumnDefinition Width="10"/>
                                                                    <ColumnDefinition/>
                                                                </Grid.ColumnDefinitions>
                                                                <Label Content="{Binding Path=Name}" Grid.Column="0"/>
                                                                <Label Content="{Binding Path=ItemCount}" FontWeight="Bold" Grid.Column="2"/>
                                                            </Grid>
                                                        </Expander.Header>
                                                            <Expander.Content>
                                                                <ItemsPresenter />                                              
                                                            </Expander.Content>
                                                        </Expander>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </GroupStyle.ContainerStyle>
                                </GroupStyle>
                            </ListView.GroupStyle>
                        <ListView.View>
                        <GridView>
                            <GridViewColumn CellTemplate="{StaticResource IDItemTemplate}" Header="ID"/>
                            <GridViewColumn CellTemplate="{StaticResource DateItemTemplate}" Header="Datum" />
                            <GridViewColumn CellTemplate="{StaticResource TypeItemTemplate}" Header="Typ" />
                            <GridViewColumn CellTemplate="{StaticResource StatusItemTemplate}" Header="Status" />
                            <GridViewColumn CellTemplate="{StaticResource AuthorItemTemplate}" Header="Autor" />
                            <GridViewColumn CellTemplate="{StaticResource BenennungItemTemplate}" Header="Benennung" />
                        </GridView>
                    </ListView.View>
                </ListView> 
```

我不知道我该如何解决我的问题......希望你们中的一些人可以帮助我让它工作......

谢谢大家的努力。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-17T18:16:43.277

您的问题是 `<Setter Property="ScrollViewer.CanContentScroll" Value="true"/>`ListView 样式的 setter 属性。

ScrollViewer 中的内容可以按物理单位或逻辑单位滚动。物理单位是与设备无关的像素。逻辑单元用于在 ItemsControl 中滚动项目。**（这就是你现在正在做的）**。ScrollViewer 的默认行为是使用物理单位来滚动其内容。但是，在**CanContentScroll 设置为 true 的情况下，内容可以使用逻辑单元进行滚动。**例如，从 ItemsControl 继承的 ListBox、ListView 和其他控件使用逻辑单元进行滚动。如果 CanContentScroll 为 true，则 ExtentHeight、ScrollableHeight、ViewportHeight 和 VerticalOffset 属性的值是项目数，而不是物理单位。

如果您需要物理滚动而不是逻辑滚动，请将宿主 Panel 元素包装在 ScrollViewer 中并将其 CanContentScroll 属性设置为 false。物理滚动是大多数 Panel 元素的默认滚动行为。

有关更多信息，请访问此处：http: [//msdn.microsoft.com/en-us/library/system.windows.controls.scrollviewer.cancontentscroll.aspx](http://msdn.microsoft.com/en-us/library/system.windows.controls.scrollviewer.cancontentscroll.aspx)

# css - 从 JSF 页面中移除 Primefaces CSS 布局

> ID：11528426
> 
> 赞同：3
> 
> 时间：2012-07-17T18:14:12.863
> 
> 标签：css, jsf, jsf-2, primefaces

我有一个来自的 JSF 页面。我也使用 Primefaces。在页面底部，我有两个执行 JSF 表单的按钮：

```
<div id="settingstwodivthree" style="width:400px; height:60px; position:absolute;  background-color:transparent; top:380px; left:800px">
    <p:commandButton value="Save Settings" id="ajax" actionListener="#{GeneralController.updateDBSettings}" rendered="true" update="growl,settingsupdate"/>
    <p:commandButton value="Default Settings" id="defaultsettings" actionListener="#{GeneralController.defaultSettings}" rendered="true" update="settingsupdate"/>                  
</div> 
```

当我将 Primefaces 添加到 JSF 页面时，按钮的默认布局发生了变化。Primefaces 的 css 文件似乎覆盖了按钮的布局。

我将此添加到`web.xml`文件中：

```
<context-param>
    <param-name>primefaces.THEME</param-name>
    <param-value>none</param-value>
</context-param> 
```

但问题仍然存在。有什么方法可以禁用css覆盖吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-07-02T09:30:34.503

嗨，我对剩余的 primefaces.css 也有同样的问题，我通过在此文件夹中放置一个空文件来覆盖 primefaces 文件来解决它

```
WebContent\resources\primefaces\primefaces.css 
```

# python - Python hadoop 流式传输：设置作业名称

> ID：11528429
> 
> 赞同：7
> 
> 时间：2012-07-17T18:14:33.053
> 
> 标签：python, hadoop, mapreduce, hadoop-streaming

*   我有一个使用 hadoop-streaming 在我的集群上运行的工作
*   我必须开始一项要为其添加作业名称的新作业，如何在命令行或文件上传递该选项来设置作业名称？
*   在 Java 中，你可以这样说

> ```
> JobConf conf = new JobConf(WordCount.class);
> conf.setJobName("wordcount"); 
> ```

如何使用 hadoop-streaming 做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-17T18:31:53.550

使用 -D key=value 表示法配置属性：

```
-D mapred.job.name='My Job' 
```

`-info`您可以通过仅使用参数调用流 jar 来列出一大堆选项

# c++ - 程序化 QGraphicsView 滚动未正确更新

> ID：11528432
> 
> 赞同：6
> 
> 时间：2012-07-17T18:14:38.513
> 
> 标签：c++, qt, user-interface, graphics, scroll

我有一个从 QGraphicsView 派生的自定义类，它实现了一个插槽调用 scrollHorizo​​ntal(int dx)，里面的代码很简单

```
void CustomView::scrollHorizontal(int dx){
    scrollContentsBy(dx, 0);
} 
```

我的问题是，像这样滚动有效，但不能正确更新场景，而是重复在视图边缘找到的任何像素，而不是重新调用项目的`paint()`方法。

我试图打电话`update()`后，但没有任何反应。我尝试通过拖动启用滚动并且更新工作正常！但我需要以编程方式完成，因为我有滚动条隐藏的东西，比如`horizontalScrollBar()->setValue()`不滚动视图。

我也试过：

```
scrollContentsBy(dx, 0);
this->scene()->invalidate(sceneRect());
this->update(); 
```

更新：

```
QPointF center = mapToScene(viewport()->rect().center()); 
centerOn(center.x() - dx, center.y()); 
update(); 
```

正在工作，但现在我的顶视图滚动速度比底视图慢，这是一个新问题。它们与`signal`s 和s 链接，在我已覆盖`slot`的底部视图中；在顶视图中被上面捕捉到。`scrollContentsBy(int dx, int dy)``emit horizontalScroll(dx)``slot`

任何想法为什么卷轴以不同的速度发生？滚动条可能与作为底部视图的一部分有效地使其成为“较小”窗口有关吗？

更新2：

不同的滚动率似乎源于一些舍入，以便使用 给我一个基于整数的“中心” `mapToScene(viewport()->rect().center());`，当您滚动时，滚动速度越慢，此错误加起来越多，滚动速度越快，总错误越少。

我有办法解决这个问题吗？我看不到任何获得浮点中心点的方法。

更新 3：

所以我基本上解决了这个问题，结果证明需要 mapToScene（我在网上其他地方找到的代码）。

我通过存储`QPointF`FP 计算的视口中心来解决这个问题，现在滚动两个视图时的错误量是不明显的。

最后一个问题是，当您向右滚动任意数量时，视图不再排列，然后调整窗口大小，然后再次滚动。我认为这与计算中心点和居中发生时间的逻辑顺序有关。

现在我在`QGraphicsScene::ResizeEvent()`和其他地方使用以下代码片段，根据需要更新中心

```
QRectF viewPort(viewport()->rect());
QPointF rectCenter((viewPort.x() + viewPort.x() + viewPort.width())/2.0, (viewPort.y() + viewPort.y() + viewPort.height())/2.0);

viewCenter = rectCenter; 
```

和我的`horizontalScroll(int dx)` `slot`

```
void CustomView::horizontalScroll(int dx)
{
    viewCenter.setX(viewCenter.x() - dx);
    centerOn(viewCenter.x(), viewCenter.y());
    update();
} 
```

重新调整窗口大小破坏两个视图的对齐时，如何解决此问题？如果需要进一步澄清，请询问，如果需要，我可以尝试给出我所指的内容的骨架。

更新 4：

粗略代码骨架

```
Class HeaderView:

class HeaderView View : public QGraphicsView
{
    Q_OBJECT
public:
    HeaderView(QWidget * parent = 0);
    HeaderView(QGraphicsScene * scene, QWidget * parent = 0);

private:
    QPointF viewCenter;

protected:
    void resizeEvent ( QResizeEvent * event );

public slots:
    void horizontalScroll(int);
    void addModel(qreal, qreal, const QString&);

}; 
```

页眉视图.cpp

```
void HeaderView::resizeEvent(QResizeEvent *event)
{
    QGraphicsView::resizeEvent(event);
    QRectF viewPort(viewport()->rect());
    QPointF rectCenter((viewPort.x() + viewPort.x() + viewPort.width())/2.0, (viewPort.y() + viewPort.y() + viewPort.height())/2.0);

    viewCenter = rectCenter;
}

void HeaderView::horizontalScroll(int dx)
{
    viewCenter.setX(viewCenter.x() - dx);
    centerOn(viewCenter.x(), viewCenter.y());
    update();
} 
```

类事件视图：

```
class EventView : public QGraphicsView
{
Q_OBJECT
public:
    EventView(QWidget * parent = 0);
    EventView(QGraphicsScene * scene, QWidget * parent = 0);
    QRectF visibleRect();

protected:
     void scrollContentsBy ( int dx, int dy );

signals:
    void horizontalScroll(int);

}; 
```

事件视图.cpp

```
void EventView::scrollContentsBy(int dx, int dy)
{
    QGraphicsView::scrollContentsBy(dx, dy);

    if(dx != 0){
        emit horizontalScroll(dx);
    }
} 
```

类 MainWindow 中的某处：

```
connect(eventView, SIGNAL(horizontalScroll(int)), headerView, SLOT(horizontalScroll(int)); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-20T17:02:13.420

我曾`QGraphicsView`在 Qt 4.6.3 - 4.7.2 中使用过，并且不得不争辩说您*可以*通过`QScrollBar`以下方式使用它们：

```
//graphics view initialization
QGraphicsView *graphicsView = new QGraphicsView(parent);
QGraphicsScene *scene = new QGraphicsScene(0,0,widthOfScene,heightOfScene,parent);
graphicsView->setHorizontalScrollBarPolicy(Qt::ScrollBarAlwaysOff);
graphicsView->setVerticalScrollBarPolicy(Qt::ScrollBarAlwaysOff);
graphicsView->setScene(scene);

//in another method
QScrollBar* yPos=graphicsView->verticalScrollBar();
yPos->setValue((int) newValue); 
```

它们是否隐藏并不重要。`setValue(int)`只要您的图形场景大于图形视图，它们仍然会响应。

`QGraphicsView`还将响应，`ensureVisible`它将滚动条移动到适当的位置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-17T18:22:41.600

你不应该`scrollContentsBy`像这里解释的那样打电话：http: [//qt-project.org/doc/qt-4.8/qabstractscrollarea.html#scrollContentsBy](http://qt-project.org/doc/qt-4.8/qabstractscrollarea.html#scrollContentsBy)

不知道你是否还能调用隐藏的滚动条来滚动它。如果没有， [`translate`](http://qt-project.org/doc/qt-4.8/qgraphicsview.html#translate)是一种选择。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-19T21:41:06.367

您是否尝试使用滚动条？隐藏它们并不会使它们不存在，并且[文档说](http://qt-project.org/doc/qabstractscrollarea.html#scrollContentsBy)您应该使用`QScrollBar::setValue`滚动到给定位置。

另一种选择是[`QGraphicsView::centerOn(QPointF)`](http://qt-project.org/doc/qgraphicsview.html#centerOn)与当前中心点结合使用 - 正如您也尝试过的那样 - 但直接在您的方法中计算中心点（**不要预先计算和存储中心点**），方法是使用[`QGraphicsView::mapToScene(int,int)`](http://qt-project.org/doc/qgraphicsview.html#mapToScene-5)：

```
void CustomView::horizontalScroll(int dx)
{
    QPointF viewCenter = mapToScene(width() / 2, height() / 2);
    viewCenter += QPointF(dx, 0); // Why did you subtract instead of add dx?
    centerOn(viewCenter); // BTW, you don't need to do .x(), .y()
    // You can remove update(); as this is already called in centerOn().
} 
```

请注意，如果您有如您所说的“`scrollContentsBy(int dx, int dy)`覆盖为`emit horizontalScroll(dx)`”，您还必须调用超类方法，以便视图可以自行滚动：

```
void CustomView::scrollContentsBy(int dx, int dy)
{
    emit horizontalScrolled(dx); // (You should call it different than the slot!)
    QGraphicsView::scrollContentsBy(dx, dy); // <-- This is what I mean!
} 
```

# symfony - 使用 Doctrine 和 Symfony2 进行数据库搜索

> ID：11528435
> 
> 赞同：4
> 
> 时间：2012-07-17T18:14:45.377
> 
> 标签：symfony, doctrine

所以我目前正在尝试使用 Symfony2 和 Doctrine 执行简单的搜索。类似的东西：http: [//docs.doctrine-project.org/projects/doctrine1/en/latest/en/manual/searching.html](http://docs.doctrine-project.org/projects/doctrine1/en/latest/en/manual/searching.html)

我目前有以下`YAML`文件设置来生成我的实体。它将我的`class Style`实体正确地生成为一个类。

```
...\Style:
    type: entity
    table: styles
    id:
        id:
            type: integer
            generator:
                strategy: IDENTITY
    actAs:
        Searchable:
            fields: [title]
            batchUpdates: true
    fields:
        title:
            type: string
            length: 150
            unique: true 
```

在我的控制器中，我试图基于字符串对该表进行搜索。

```
public function searchAction($pattern) 
{
    $repository = $this->getDoctrine()->getRepository('..:Style');
    $search = $repository->search($pattern);

    return $this->outputize($search);
} 
```

但是，当我尝试执行代码时，出现以下异常。

```
Undefined method 'search'. The method name must start with either findBy or findOneBy! 
```

我是否正确生成了我的实体，还是我明显遗漏了什么？

顺便说一句，当我查看`Entity/Style.php`生成后，没有明确的方法`->search()`，这里的函数应该由 Symfony 生成吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-18T06:55:55.970

`search()`不是 Symfony2 中支持的功能。您正在查看 Symfony 1.x 文档，而 Symfony2 与 Symfony 1.x 确实不同，因此作为参考，您应该始终使用[doc](http://symfony.com/doc/current/book/index.html)。

在 Symfony2 中有几种获取实体的方法。这里有一些例子：

1.  寻找

    ```
    $user = $this->getDoctrine()
        ->getRepository('UserBundle:User')
        ->find($user_id)
    ; 
    ```

2.  数据质量：

    ```
    $query = $em->createQuery(
        'SELECT b FROM YourBundle:Bid b WHERE b.property_id = :property_id ORDER BY b.amount DESC'
    )->setParameter('property_id', $property_id);
    try {
        $bids = $query->getResult();
    } catch (\Doctrine\Orm\NoResultException $e) {
        //Handle No Result Exception here
    } 
    ```

在此处参考 Symfony2 的 Doctrine 指南：http: [//symfony.com/doc/current/book/doctrine.html](http://symfony.com/doc/current/book/doctrine.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-07-05T15:57:06.310

你好，你可以在 symfony 3 中做到这一点

```
$em = $this->getDoctrine()->getManager();
$query = $em->createQuery(
                'SELECT p
                FROM AppBundle:Hotel p
                WHERE p.address like :location
                ORDER BY p.address ASC'
                )->setParameter('location','%'.$request->get('location').'%' );
$hotel = $query->getResult(); 
```

# c# - 在 PHP 中显示具有重复列的表

> ID：11528436
> 
> 赞同：12
> 
> 时间：2012-07-17T18:14:47.547
> 
> 标签：c#, php, html, sql

我在 MySQL 数据库中有以下数据：

```
Autonum  ID  Name  MetaValue
1         1  Rose  Drinker
2         1  Rose  Nice Person
3         1  Rose  Runner
4         2  Gary  Player
5         2  Gary  Funny 
```

我现在在 PHP 中工作，但我在使用 C#、Java 和其他语言时遇到过几次这个问题。

现在我过去和现在的目标是以以下格式显示数据：

```
<table>
    <thead>
    <th>Name</th>
    <th>MetaValue1</th>
    </thead>
    <tbody>
           <tr>      
               <td>Rose</td>
                <td>
                    <ul>
                        <li>Drinker</li> 
                        <li>Nice Person</li>
                        <li>Runner</li>
                     </ul>
                </td>
            </tr>
            <tr>
                <td>Gary</td>
                <td>
                    <ul>
                         <li>Player</li>
                         <li>Funny</li>
                 </td>
                </tr>
        </tbody>

</table> 
```

我之前通过创建一个代表我的 SQL 表的类来解决这个问题。然后我创建了一个`Dictionary`要举行`EmployeeId`的班级。

```
Dictionary<string,MyTable> MyData = new <string,MyTable>();
Table MyMetaData = new Table();
MyMetaData SomeMetaData=getMetaValueList();//imagine a web service that does that
MyData.add(EmployeeId,SomeMetaData); 
```

我跳过了步骤，但我希望你明白我的意思。我可能只需要所谓的此类问题的关键字。实现此目的的首选方法是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-17T20:44:24.680

出于一个原因，我不喜欢 SQL 解决方案。您要求数据库引擎加入字符串，然后使用 PHP 将其拆分。这就像重复的工作。另一个缺点是 if`metavalue`包含分隔符。

我的代码只是演示了如何在 PHP 中使用二维数组轻松地对数据进行分组，并且由编码人员决定从遗留 mysql_* 或 PDO 数据库中检索数据的方法。

```
// get result
$result = mysql_query("SELECT autonum,id,name,metavalue FROM table");

// loop through each row
while ($row = mysql_fetch_assoc($result)) {
    $table[$row['name']][] = $row['metavalue'];
}

// print it out
print_r($table); 
```

无需将整个结果集临时存储到数组中。您可以通过首先按要对数据分组并跟踪状态的字段对数据进行排序来直接迭代。

但是，我喜欢这种风格有两个原因，这是个人喜好（这不是必须做的解决方案）：

1.  通常，每个人都希望将逻辑和表示分开。在数组中存储数据可以很容易地传递给您的模板引擎。我更喜欢使用 PHP 模板引擎，因为它易于实现并且运行速度极快。

2.  我宁愿用轻微的性能速度和内存使用来换取可读性和可维护性。该算法简短易懂。如果性能是您的首要任务，您始终可以使用缓存，例如存储在文件中、存储在 memcached 中或将计算结果存储在数据库中。

没错，我们正在对来自不同方面的数据进行分组，但您假设`metavalue`不包含分隔符（在您的代码中是 |）。通过选择几乎不可能使用的分隔符可以很容易地修复它`metavalue`。无论如何，您的解决方案几乎在所有情况下都可以正常工作，因为`metavalue`@jvelez 显示的永远不会包含字符 |。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-17T18:36:03.643

问题不在于 php/java/c# 代码，而在于 SQL 端。

```
SELECT ID      AS id,
       Autonum AS num,
       Name    AS name,
       GROUP_CONCAT
       (
           ORDER BY MetaValue DESC SEPARATOR '|'
       )       AS list
FROM Things
GROUP BY Things.ID 
```

通过这种方式，您可以获得一个`name`值列表，以及该项目的所有关联 MetaValue，您只需拆分`list`on `'|'`。

在 PHP 中，您使用[`explode()`](http://php.net/manual/en/function.explode.php).，在 C# 中[`String.Split()`](http://msdn.microsoft.com/en-us/library/b873y76a.aspx)，我假设您将能够找到任何语言的类似内容。

HTML 的生成变得非常简单。

*这是一个 PHP 示例（使用了 PDO 连接 API）：*

```
$statement = $pdo->query( $sql );

if ( $statement->execute() )
{
    $data = $statement->fetchAll(PDO::FETCH_ASSOC);

    foeach ( $data as $row )
    {
         echo '<tr><td>' , $row['name'] , '</td>';
         echo '<td><ul><li>' , str_replace( '|', '</li><li>' , $row['list']) ;
         echo '</li></ul></td></tr>';
    }
} 
```

这`<tbody>`将从您的示例中生成内容。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-23T16:48:55.400

请查看您的数据，它是排序和排序的：

```
Autonum  ID  Name  MetaValue
1         1  Rose  Drinker
2         1  Rose  Nice Person
3         1  Rose  Runner
4         2  Gary  Player
5         2  Gary  Funny 
```

所以你可以做的是通过输出来解决这个问题：

*   每次 ID/名称更改时，您都会有一个新的表格行。
*   每次 MetaValue 更改时，您都会有一个新的列表条目。

您需要做的就是提前查看下一个元素以查看更改。这意味着您提前进行迭代（预先计算的迭代）或进行缓存迭代（例如[`CachingIterator`](http://php.net/CachingIterator)在 PHP 中使用）。

如果您随后也跟踪状态，您可以根据每个条目说明是否：

*   需要在它之前打开一个表行。
*   之后需要关闭一个表行。

实际上它更简单，这里是一个基于数组的行迭代示例（[Demo](http://codepad.org/JbYy9rJc)）：

```
$rows = array(
    array(1, 1, 'Rose', 'Drinker'),
    array(2, 1, 'Rose', 'Nice Person'),
    array(3, 1, 'Rose', 'Runner'),
    array(4, 2, 'Gary', 'Player'),
    array(5, 2, 'Gary', 'Funny'),
);

echo "<table>\n    <thead>\n    <th>Name</th>\n    <th>MetaValue1</th>\n    </thead>\n    <tbody>\n";

$events = new Events();
$last = array(2 => null);
foreach($rows as $row)
{
    if ($last[2] !== $row[2]) {
        $events->newRow($row[2]);
    }
    $events->newItem($row[3]);
    $last = $row;
}
$events->closeRow();

echo "    </tbody>\n</table>"; 
```

没有多少代码可以解决您的问题，因为问题本身只是数据内部的一点点状态。

可以通过创建您自己的迭代器来反转这里描述的事件，该迭代器可以传递给支持迭代器的模板系统，例如 twig 或 mustache。我以前的答案和博客文章中显示了一个完整的例子：

*   [将嵌套集模型放入但隐藏的“封闭”子树中](https://stackoverflow.com/questions/7729173/getting-nested-set-model-into-a-ul-but-hiding-closed-subtrees/7786733#7786733)
*   [如何将一系列父子关系转换为层次树？](https://stackoverflow.com/a/8285070/367456)
*   [一些 PHP 迭代器的乐趣](http://hakre.wordpress.com/2012/02/28/some-php-iterator-fun/)

与上面的示例相比，它可能看起来并不那么简单，但是它希望提供足够的代码来让您下定决心要去哪里。它是相当可扩展的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-23T18:14:44.733

我会以不同的方式解决这个问题。现在，您遇到了问题，因为您的数据库模式未标准化。相反，我将从更改架构开始。现在，你有这个：

```
CREATE TABLE foo {
    `autonum` INT(12) NOT NULL AUTO_INCREMENT,
    `id` INT(12) NOT NULL,
    `name` VARCHAR(255) NOT NULL,
    `metaValue` VARCHAR(255) NOT NULL,
    PRIMARY KEY(autonum)
) 
```

相反，我会将其拆分为两个表：

```
CREATE TABLE user {
    `id` INT(12) NOT NULL AUTO_INCREMENT,
    `name` VARCHAR(255) NOT NULL,
    PRIMARY KEY(id)
)
CREATE TABLE user_meta {
    `user_id` INT(12) NOT NULL,
    `value` VARCHAR(255) NOT NULL
) 
```

忽略这看起来像一个 EAV 表的事实（它不是，meta 只是由于 OP 的命名而被错误命名），应该清楚这如何更容易。所以让我们看看你的记录，并建立表格：

```
#User
id   | name
1    | Rose
2    | Gary

#User Meta
user_id | value
1       | drinker
1       | Nice Person
1       | Runner
2       | Player
2       | Funny 
```

现在我们有了数据，让我们看看如何提取它。假设我们总是想打印出所有用户（限制它很简单，但为了清楚起见，我们现在可以全部完成）。所以，我会在这里为每个表设置一个简单的类，将数据缓存到一个查询中。

```
class User implements IteratorAggregate {
    protected $data = array();
    public function __construct() {
        $query = mysql_query("SELECT id, name FROM user");
        while ($row = mysql_fetch_assoc($query)) {
            $this->data[$row['id']] => $row['name'];
        }
    }
    public function getIterator() {
        return new ArrayObject($this->data);
    }
}

class User_Meta {
    protected $data = array();
    public function __construct() {
        $query = mysql_query("SELECT user_id, value FROM user_meta");
        while ($row = mysql_fetch_assoc($query)) {
            if (empty($this->data[$row['user_id']])) {
                $this->data[$row['user_id']] = array();
            }
            $this->data[$row['user_id']][] = $row['value'];
        }
    }
    public function getDataForUserId($id) {
        return empty($this->data[$id]) ? array() : $this->data[$id];
    }
} 
```

现在，构建输出变得微不足道：

```
$users = new User;
$meta = new User_Meta;

echo "<table>
<thead>
<th>Name</th>
<th>MetaValue1</th>
</thead>
<tbody>";

foreach ($users as $id => $name) {

    echo "<tr>      
           <td>".htmlspecialchars($name)."</td>
            <td>
                <ul>";
    foreach ($meta->getDataForUserId($id) as $metaValue) {
         echo "<li>" . htmlspecialchars($metaValue) . "</li>";
    }

    echo "      </ul>
            </td>
           </tr>";
}

echo "</tbody></table>"; 
```

现在，说了这么多，我个人将实现它有点不同，使用一流的业务对象和数据映射器来处理所有事情。

我确实在这里犯了一些重罪，但我这样做是为了简单。这是我会做的不同的事情：

1.  不在对象的构造函数中做逻辑。相反，我会注入它或使用工厂来预填充数据。
2.  将关系的概念抽象为单独的业务对象。
3.  从显示逻辑中分离出拉取逻辑。
4.  更好地命名事物（元值不是字段的好名称）。

但这实际上取决于应用程序的确切要求。没有一种（或两种）*正确的方法*可以做到这一点。每种可能的方法都有优点和缺点。学会权衡权衡，以便您可以根据自己的要求选择合适的...

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-22T16:35:02.377

您问如何称呼这种类型的问题：它称为分组。一种可能性确实是在 SQL`GROUP BY`子句的帮助下解决它（但不同的 SQL 引擎对这些有不同的支持，特别是当涉及到要分组的更复杂的数据聚合时）。

在 C# 中，由于 LINQ，基本的解决方案是单行的，只需使用`GroupBy`扩展方法：

```
var data = new [] {
    new { RowId = 1, EmpId = 1, Name = "Rose", Value = "Drinker" },
    new { RowId = 2, EmpId = 1, Name = "Rose", Value = "Runner" },
    new { RowId = 3, EmpId = 2, Name = "Gary", Value = "Player" },
};

var grouping = data.GroupBy(row => row.Name);
var sb = new StringBuilder();
foreach (var grp in grouping) {
    sb.AppendFormat("<tr><td>{0}</td>\n", grp.Key);
    sb.AppendLine("  <td><ul>");
    foreach (var element in grp) {
        sb.AppendFormat("    <li>{0}</li>\n", element.Value);
    }
    sb.AppendLine("  </ul></td>\n</tr>");
}

Console.WriteLine(sb.ToString()); 
```

背后的基本思想`GroupBy`只是某种关联数组或字典，将分组的属性作为键以及与该键关联的所有行的列表。例如（使用具有上述定义的变量数据）：

```
var map = new Dictionary<Tuple<int, string>, List<object>>();
foreach (var row in data) {
    var key = Tuple.Create(row.EmpId, row.Name);
    if (!map.ContainsKey(key))
        map.Add(key, new List<object>());

    map[key].Add(row);
} 
```

上面的代码片段在概念上与来自 d​​raw010 和 invisal 的基于 PHP 的答案相同（它们使用二维 PHP 数组，在概念上与上面的列表字典相同）。我试图使步骤尽可能明确，并且不使用 C# 的太多特殊功能（例如，在实际程序中，您应该倾向于使用它自己的适当类来处理复杂的键而不是简单的元组），所以上面片段应该很容易移植到 Java 和其他语言。

正如您在此处的所有示例中所看到的，在对数据进行分组之后，HTML 生成始终是相同的（两个嵌套循环）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-07-21T19:31:30.637

这是一个解决方案，它类似于@invisal 的方式，我们基于表的属性创建数组以将结果分组在一起。

```
<?php

$mysqli = new mysqli("localhost", "uname", "pword", "wordpress");
if ($mysqli->connect_errno) {
    die("Failed to connect to MySQL: (" . $mysqli->connect_errno . ") " . $mysqli->connect_error);
}

$res = $mysqli->query("SELECT * FROM wp_postmeta");

// array that will hold the final results
$results = array();

// while we have more rows
while ($row = $res->fetch_assoc()) {
    // check to see if we already have this ID
    if (!array_key_exists($row['ID'], $results)) {
            // if not create a new index for it in $results, which holds an array
        $results[$row['ID']] = array();
    }

    // create new stdClass object that holds the row data
    $obj = new stdClass;
    $obj->Name = $row['Name'];
    $obj->MetaValue = $row['MetaValue'];

    // append this data to our results array based on the ID
    $results[$row['ID']][] = $obj;
}
?>

<table>
    <thead>
    <th>Name</th>
    <th>MetaValue</th>
    </thead>
    <tbody>

<?php foreach($results as $id => $values): ?>
    <tr>
        <td style="vertical-align: top"><?php echo $values[0]->Name ?></td>
        <td>
            <ul>
            <?php foreach($values as $value): ?>
                <li><?php echo $value->MetaValue ?></li>
            <?php endforeach; ?>
            </ul>
        </td>
    </tr>
<?php endforeach; ?>
    </tbody>
</table> 
```

这似乎会产生您想要的结果。希望有帮助。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-07-22T05:50:30.473

我曾经有一个类似的表，最后我使用一些 SQL 将数据作为单独的行返回。我已经修改了我的对象以使用您的 sql 并编写了一个简单的函数，它将按照您在问题中使用的格式在表中输出您的数据。

我使用的主要查询聚合函数是 MySQL GROUP_CONCAT。这类似于一个`implode()`函数。默认分隔符是逗号，因此如果您的元数据中有逗号，您可以通过`SEPARATOR 'yourSeparator'`在列名称后面的括号内添加来将其更改为不同的标记。您还可以使用`distinct`列名的前面来仅选择 group_concat 中的不同行。

我已将表头部分放在`try`语句中，这样如果您没有任何结果，您将不会显示半生成的表。

```
<?php

class myUser
{
    public $ID;
    public $name;
    public $metas;
}

class myTables
{
    public $SQL="
select 
    ID,
    name,
    GROUP_CONCAT(metavalue) as metas
FROM 
    table1
GROUP BY 
    ID,
    name;";

    public function outputTable()
    {
        $hostname="mysql:host=localhost;dbname=test";
        $username="testdb";
        $password="testdbpassword";

        try{
            echo "
        <table>
            <thead>
            <th>Name</th>
            <th>MetaValue</th>
            </thead>
            <tbody>
            ";
            $dbh = new PDO($hostname, $username, $password);
            $stmt = $dbh->query($this->SQL);
            $obj = $stmt->setFetchMode(PDO::FETCH_INTO, new myUser);
            foreach($stmt as $myUser)
            {
                echo "
                        <tr><td>".$myUser->name."</td><td><ul>";
                $metas=explode(",", $myUser->metas);
                for($i=0;$i<count($metas);$i++)
                {
                    echo "<li>".$metas[$i]."</li>";
                }
                echo "</ul></td></tr>";
            }
            unset($obj);
            unset($stmt);
            unset($dbh);
            echo "
            </tbody>
        </table>
            ";
        }
        catch(PDOException $e){
            echo 'Error : '.$e->getMessage();
            exit();
        }
    }

}

$myPage= new myTables();
$myPage->outputTable();
?> 
```

示例输出：

```
<table>
    <thead>
    <th>Name</th>
    <th>MetaValue1</th>
    </thead>
    <tbody>
    <tr><td>Rose</td><td><ul><li>Drinker</li><li>Nice Person</li><li>Runner</li></ul></td></tr>
    <tr><td>Gary</td><td><ul><li>Player</li><li>Funny</li></ul></td></tr>
   </tbody>
</table> 
```

我从您的查询中删除了`Autonum`，否则它会破坏聚合函数。但是，如果您确实需要它，则必须以类似的方式对其进行聚合。该`group_concat`函数将跳过空字段，因此您需要巧妙地将它们带入，否则您的自动编号 ID 将与您的结果不匹配。我在这里用一个简单`coalesce()`的内部`group_concat`函数做到了这一点。

为了容纳这些额外的部分，我稍微重写了对象。这应该可以满足您的所有需求，我已经留下了由我设置为 false 的私有变量设置的调试说明`isDebug`，但是将其设置为 true 会在对象运行函数时为您提供额外的信息。这将帮助您进行调试，因为我假设您的源数据实际上要复杂得多。

```
<?php

class myUser
{
    public $ID;
    public $name;
    public $metaDesc;
    public $metaNum;
    public $metaDescs;
    public $metaNums;
}
// Basic User stored here. One Object per Row is created.

class myTables
{
    private $isDebug=false; // Change this to true to get all validation messages;
    private $hostname="mysql:host=localhost;dbname=test";
    private $username="testdb";
    private $password="testdbpassword";
    private $myUsers=array();
    private $curUser = myUser;
    private $userCount=0;
    private $SQL="
select 
    ID,
    name,
    GROUP_CONCAT(coalesce(metavalue,'null')) as metaDesc,
    group_concat(autonum) as metaNum
FROM 
    table1
GROUP BY 
    ID,
    name;";

    public function getuserData()
    {
        $dbh = new PDO($this->hostname, $this->username, $this->password);
        $stmt = $dbh->query($this->SQL);
        $obj = $stmt->setFetchMode(PDO::FETCH_INTO, new myUser);
        $userCount=0;
        foreach($stmt as $myUser)
        {
            $this->myUsers[$userCount]=new myUser;
            $this->myUsers[$userCount]->ID=$myUser->ID;
            $this->myUsers[$userCount]->name=$myUser->name;
            $this->myUsers[$userCount]->metaDesc=$myUser->metaDesc;
            $this->myUsers[$userCount]->metaNum=$myUser->metaNum;
            $userCount++;
        }
        $this->userCount=$userCount;
        if($this->isDebug){echo "There are ".$this->userCount." users found.<br>";}
        unset($obj);
        unset($stmt);
        unset($dbh);
    }
    // Pulls the data from the database and populates the this->object.

    public function outputTable()
    {
        echo "
    <table>
        <thead>
        <th>Name</th>
        <th>MetaValue</th>
        </thead>
        <tbody>
        ";
        for($i=0; $i<$this->userCount; $i++)
        {
            if($this->isDebug){echo "Running main cycle. There are ".$this->userCount." elements.";}
            $this->myUsers[$i]->metaDescs=explode(',', $this->myUsers[$i]->metaDesc);
            $this->myUsers[$i]->metaNums=explode(',', $this->myUsers[$i]->metaNum);
            if($this->isDebug){echo "This user has ".(count($this->myUsers[$i]->metaDescs))." segments<br>";}
            if($this->isDebug){echo "My first segment is ".($this->myUsers[$i]->metaDesc)."<br>";}
            echo "<tr><td>".$this->myUsers[$i]->name."</td><td><ul>";
            for($j=0;$j<count($this->myUsers[$i]->metaDescs);$j++)
            {
                echo "<li>ID: ".$this->myUsers[$i]->metaNums[$j]." - ".$this->myUsers[$i]->metaDescs[$j]."</li>";
            }
            echo "</ul></td></tr>";
        }
            echo "
            </tbody>
        </table>
            ";
    }
    // Outputs the data held in the object into the table as required.

}

$myPage= new myTables();
$myPage->getUserData();
$myPage->outputTable();
?> 
```

输出现在如下所示：

```
<table>
    <thead>
    <th>Name</th>
    <th>MetaValue</th>
    </thead>
    <tbody>
    <tr><td>Rose</td><td><ul><li>ID: 1 - Drinker</li><li>ID: 2 - Nice Person</li><li>ID: 3 - Runner</li></ul></td></tr>
    <tr><td>Gary</td><td><ul><li>ID: 4 - Player</li><li>ID: 5 - Funny</li><li>ID: 6 - null</li><li>ID: 7 - Smelly</li></ul></td></tr>
</tbody>
</table>

Name    MetaValue
Rose    

ID: 1 - Drinker
ID: 2 - Nice Person
ID: 3 - Runner

Gary    

ID: 4 - Player
ID: 5 - Funny
ID: 6 - null
ID: 7 - Smelly 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-07-23T12:13:46.943

我建议你在数据库中[创建一个函数](http://dev.mysql.com/doc/refman/5.0/en/create-procedure.html)

```
create function get_meta(@autonum int)
 returns varchar(500)
as
 declare @meta varchar(500)='<ul>';
 select @meta=@meta+'<li>'+MetaValue+'</li>' from mytable where Autonum=@autonum
 return @meta+'</ul>'; 
```

并像这样在 PHP 端使用一个干净的语句。

```
select id,autonum,name, get_meta(autonum) as meta_output from mytable 
```

那么你需要做

```
echo $row["meta_output"]; 
```

像任何其他专栏一样。这就是我会使用的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-07-26T10:44:51.263

我这里既没有在MySql 端也没有在PHP 端进行分组，即没有使用php 的内存进行分组，也没有使用mysql 函数。只是控制打印。

[您可以在此处查看](http://codepad.org/0zGysLrX)以下代码的工作示例

```
<?php
$result = mysql_query("SELECT name,metavalue FROM table");

$count = mysql_num_rows($result);
?>
     <table>
        <thead>
        <th>Name</th>
        <th>MetaValue1</th>
        </thead>
        <tbody>
    <?php
$i     = 0;
// loop through each row
$start = 1;

while ($row = mysql_fetch_assoc($result) {
    if ($name != $row['name']) {// row with new name
        if ($start) {
            $start = 0;
            echo "<tr>";
            echo "<td>" . $row['name'] . "</td>
                 <td><ul><li>" . $row['metadata'] . "</li>";
        } else {
            $start = 1;
            echo "</ul></td>";
            echo "</tr><tr>";
            echo "<td>" . $row['name'] . "</td>
                 <td><ul><li>" . $row['metadata'] . "</li>";
        }
    } else {//row with the same name
        echo "<li>" . $row['metadata'] . "</li>";
        if ($i == $count - 1) {
            echo "</ul></td></tr>";
        }
    }
?>

<?php
    $name = $row['name'];
    $i++;
}
?>
    </tbody>
    </table> 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-07-23T13:35:49.450

```
This would print exactly what you need within the <tbody> tags :

<?php

$result = mysql_query("SELECT name, metavalue FROM table");
$previous_name = ""; //Variable to keep track of previous name value in array()

print '<table><thead><th>Name</th><th>Metavalue</th></thead><tbody>'; //print the static table header

while ($row = mysql_fetch_array($result)) {
    $name = $row['name'];
    $meta_value = $row['metavalue'];

    if (($previous_name != $name) && ($previous_name !="")) {
        //If $name has changed, close tags, reset $previous_name
        print '</ul></td></tr>';
        $previous_name = "";
    }

    if ($previous_name == "") {
        //New value of $name, open tags, set $name to $previous_name
        print '<tr><td>'.$name.'</td><td><ul>';
        $previous_name = $name;
    } 

    if ($previous_name == $name) {
        //print contents of $meta_value if $name is the same
        print '<li>'.$meta_value.'</li>';
    }   
}
//Once there are no more values in the array, close the static table header
print '</tbody></table>'; //close the static table header

?> 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-07-24T19:30:19.233

这与其他一些响应非常接近，但我认为更清晰，更容易理解。

为了便于使用，我在任何输出之前创建了一个 3 维数组。您可以一次完成所有操作，但我发现看起来更清晰的代码往往会将其分开（例如，从数据库读取与输出不同，因此请将它们分开）。这样，如果您需要引用 person 33 的第 15 个元值，您也有一个方便的数组`$resultArr[33]["meta"][15]`。

我还为每个结果行添加了类名和一个 ID，以便于 CSS 样式。

```
<?php
// DB connect //

// Get the DB Data
$result = mysql_query("SELECT Autonum, ID, Name, MetaValue FROM table GROUP BY ID");

// Set Start Values
$resultArr = array();
$curRow = -1;
$curMeta = -1;

// Loop Through the Rows
while ($row = mysql_fetch_assoc($result)) {
    // Start of a new ID, Set the name and Create the MetaValue Array
    if ($curRow != $row["ID"]){
        $curRow = $row["ID"];
        $resultArr[$curRow]["name"] = $row["Name"];
        $resultArr[$curRow]["meta"] = array();
        $curMeta = 0;
    }
    // Add the MetaValue
    $resultArr[$curRow]["meta"][$curMeta] = $row["MetaValue"};
    $curMeta++;
}
/* Array looks like:
$resultArr[1]["name"] = "Rose";
$resultArr[1]["meta"][0] = "Drinker";
$resultArr[1]["meta"][1] = "Nice Person";
$resultArr[1]["meta"][2] = "Runner";
$resultArr[2]["name"] = "Gary";
$resultArr[2]["meta"][0] = "Player";
$resultArr[2]["meta"][1] = "Funny";
*/

// Start the Table
$out = "<table>";
$out .= "\n<thead>";
$out .= "\n<th>Name</th>";
$out .= "\n<th>MetaValue1</th>";
$out .= "\n</thead>";
$out .= "\n<tbody>";

// Add the Rows
foreach($resultArr as $id => $col){
    $out .= "\n\n<tr id='result_" . $id . "'>";
    $out .= "\n<td class='rowName'>" . $col["name"] . "</td>";
    $out .= "\n<td class='rowMeta'>";
    $out .= "\n<ul>";
    foreach($col["meta"] as $meta){
        $out .= "\n<li>".$meta."</li>";
    }
    $out .= "\n</ul>";
    $out .= "\n</td>";
    $out .= "\n</tr>";
}

// Close the Table
$out .= "\n</tbody>";
$out .= "\n</table>";

// Print It Out Where You Need It
echo $out;
?> 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-07-23T19:36:08.890

这是我在这个问题上的第二种方法，[就像第一种](https://stackoverflow.com/a/11616884/367456)方法一样，我仍然喜欢用输出解决这个问题，例如：

```
<table>
    <?php foreach($users as $name => $columns) : ?>
        <tr>
            <td>
                <?php echo htmlspecialchars($name); ?>
            </td>
            <td>
                <ul>
                    <?php foreach($columns as $column) : ?>
                        <li><?php echo htmlspecialchars($column); ?></li>
                    <?php endforeach ?>
                </ul>
            </td>
        </tr>
    <?php endforeach ?>
</table> 
```

这里使用数组结构模拟数据库结果集，但使用典型的迭代器：

```
$rows = array(
    array(1, 1, 'Rose', 'Drinker'),
    array(2, 1, 'Rose', 'Nice Person'),
    array(3, 1, 'Rose', 'Runner'),
    array(4, 2, 'Gary', 'Player'),
    array(5, 2, 'Gary', 'Funny'),
);
$result = new ArrayIterator($rows);

$users = new Users($result); 
```

这表明这是一个单一的查询，没有子选择，不需要重新分组（如第一个问题中所述）根据它的顺序执行此操作。

`Users`仅缺少该类的代码：

```
class Users extends IteratorIterator
{
    private $last;
    public function __construct($it) {
        parent::__construct(new NoRewindIterator($it));
    }
    public function current() {
        $current = $this->getInnerIterator()->current();
        $this->last = $current[2];
        return new Columns($this->getInnerIterator(), $this->last);
    }
    public function key() {
        return $this->last;
    }
    public function next() {
        $current = $this->getInnerIterator()->current();
        if ($this->last === $current[2] || $current === NULL) {
            parent::next();
        }
    }
}

class Columns extends IteratorIterator
{
    private $name;
    public function __construct($it, $name) {
        $this->name = $name;
        parent::__construct($it);
    }
    public function valid()
    {
        $current = parent::current();
        return parent::valid() && $current[2] === $this->name;
    }
    public function current() {
        $current = parent::current();
        return $current[3];
    }
} 
```

[键盘上的完整演示](http://codepad.org/fdG05fnm)- 我必须承认这包含一些迭代器黑魔法。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-07-23T11:32:26.790

这是您想要的代码。为了避免与您的代码发生任何冲突，我没有使用任何类对象概念，因此代码是以简单的方式编写的。它看起来很简单，但毫无疑问它正在工作。请注意，代码是由过去一年半从事 php 工作的高级程序员放置的。所以不要介意代码的简单时尚

* * *

```
 <table>
        <thead>
        <th>Name</th>
        <th>MetaValue1</th>
        </thead>
        <tbody>
        <?php
        mysql_select_db("dbName", $con);
        $result = mysql_query("SELECT DISTINCT Name,ID FROM tableName");
        while($row = mysql_fetch_array($result))
        {
            $userName = $row['Name'];
            echo $userId = $row['ID'];

        ?>     
             <tr>      
                   <td><?=$userName?> <?=$userId?></td>
                    <td>
                       <ul>
                        <?php
                        $resultNew = mysql_query("SELECT * FROM tableName WHERE ID =$userId");
                        while($row = mysql_fetch_array($resultNew))
                        {
                            $mValue = $row['MetaValue'];
                        ?>
                        <li><?=$mValue?></li> 
                        <?php   
                        }
                        ?>
                        </ul>
                    </td>
                </tr>
          <?php } ?>      
            </tbody>

    </table> 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-07-26T03:55:10.057

```
<?php
/**
 * Displaying a table in PHP with repeated columns
 * @link http://stackoverflow.com/a/11616884/367456
 */

class Events
{
    private $row = 0;

    public function newRow($name)
    {
        $this->closeRow();
        echo "        <tr><td>$name</td><ul>";
        $this->row++;
    }

    public function closeRow()
    {
        if (!$this->row) return;
        echo "</ul></tr>\n";
        $this->row = 0;
    }

    public function newItem($name)
    {
        echo "<li>$name</li>";
    }
}

$rows = array(
    array(1, 1, 'Rose', 'Drinker'),
    array(2, 1, 'Rose', 'Nice Person'),
    array(3, 1, 'Rose', 'Runner'),
    array(4, 2, 'Gary', 'Player'),
    array(5, 2, 'Gary', 'Funny'),
);

echo "<table>\n    <thead>\n    <th>Name</th>\n    <th>MetaValue1</th>\n    </thead>\n    <tbody>\n";

$events = new Events();
$last = null;
foreach ($rows as $row) {
    if (@$last[2] !== $row[2]) {
        $events->newRow($row[2]);
    }
    $events->newItem($row[3]);
    $last = $row;
}
$events->closeRow();

echo "    </tbody>\n</table>"; 
```

# ruby-on-rails - 设置霰弹枪以使用其调试标志开始精简

> ID：11528441
> 
> 赞同：3
> 
> 时间：2012-07-17T18:15:13.873
> 
> 标签：ruby-on-rails, debugging, thin, shotgun

我正在尝试让调试器 gem 与 shotgun 一起工作，并且要使调试器工作，我需要以“调试开启”启动瘦服务器。

如果我运行：

```
shotgun -p 1378 -s thin -d -o 0.0.0.0
shotgun -p 1378 -s thin --debug -o 0.0.0.0 
```

我从 $DEBUG ruby​​ 变量设置为 true 开始得到霰弹枪，而不是在打开调试标志的情况下启动瘦服务器。

如果我运行：

```
shotgun -pp 1378 -s "thin --debug" -o 0.0.0.0 
```

我得到一个错误。当环境设置为开发时，是否有另一种方法来运行它，或者以某种方式告诉瘦在调试器模式下启动？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T22:27:11.387

Your [`-d` and `--debug` options are being interpreted by Shotgun](https://github.com/rtomayko/shotgun/blob/0.9/bin/shotgun#L23), rather than Thin, and that is what is setting `$DEBUG` to true.

Thin’s command line flag to turn on [debugging is `-D` or `--debug`](https://github.com/macournoyer/thin/blob/v1.4.1/lib/thin/runner.rb#L133) and this [sets `Thin::Logging.debug` to true](https://github.com/macournoyer/thin/blob/v1.4.1/lib/thin/runner.rb#L174). You can’t use the `thin` command line options (sine the command line is being read by `shotgun` which launches the server), but you can set this variable with some normal Ruby code. One way to do this would be with [a `shotgun.rb` file](http://rtomayko.github.com/shotgun/#PRELOADING) that requires Thin and changes the setting:

```
require 'thin'
Thin::Logging.debug = true 
```

(You might want to put this in a `begin...rescue...block` and rescue the LoadError in case Thin isn’t available.)

The output without this file:

```
$ shotgun
== Shotgun/Thin on http://127.0.0.1:9393/
>> Thin web server (v1.4.1 codename Chromeo)
>> Maximum connections set to 1024
>> Listening on 127.0.0.1:9393, CTRL+C to stop 
```

and with the file:

```
$ shotgun
== Shotgun/Thin on http://127.0.0.1:9393/
>> Thin web server (v1.4.1 codename Chromeo)
>> Debugging ON
>> Maximum connections set to 1024
>> Listening on 127.0.0.1:9393, CTRL+C to stop 
```

As far as I can tell, this setting only affects the verbosity of Thin’s logging, and doesn’t have anything to do with the [Debugger gem](https://rubygems.org/gems/debugger).

# javascript - 在浏览器请求其他资源（例如图像）之前是否会触发任何事件？

> ID：11528443
> 
> 赞同：3
> 
> 时间：2012-07-17T18:15:19.543
> 
> 标签：javascript, browser, monitoring, dom-events

我们想测量浏览器从网络获取资源所需的时间。例如，如果我的页面加载了 10 个图像和 4 个脚本，我想知道浏览器从网络加载这些资源需要多长时间。

编写浏览器插件可能会起作用，但它迫使我们为每个浏览器编写不同的工具..我们还能做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T18:18:46.087

[Google Speedtracer](https://developers.google.com/web-toolkit/speedtracer/)应该会为您提供这些信息。我相信它显示了请求的开始和总经过的时间。

如果您担心浏览器特定的怪癖，您可能需要使用 JavaScript 进行一些内联​​日志记录。

* * *

一个非常基本的脚本，例如：

```
<script type="text/javascript">
   var startTime = new Date().getTime();
</script>
<img src="yourimage.jpg" onload="console.log('new Date().getTime() - startTime')" /> 
```

应该做的伎俩，但它非常具有侵入性。

# wpf - 更改 WPF 组合框的边框颜色

> ID：11528446
> 
> 赞同：8
> 
> 时间：2012-07-17T18:15:25.970
> 
> 标签：wpf, xaml, combobox, styles

所以我试图在 Expression blend 中改变我的组合框的样式。

我所做的是创建一个组合框，然后**右键单击 > 编辑模板 > 编辑副本**

我可以更改组合框的颜色，除了组合框的**背景**和组合框的**边框**之间有一个白色边框。这是一个屏幕，您可以看到：

![在此处输入图像描述](../Images/efed71089c4787508bf717d01e5f58fd.png)

如您所见，蓝色和红色之间有一段时间的边界。据我所知，更改组合框颜色的代码如下：

```
<ToggleButton Grid.ColumnSpan="2" IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, 
RelativeSource={RelativeSource TemplatedParent}}" Style="{StaticResource 
ComboBoxReadonlyToggleButton}" BorderBrush="Red" Background="Blue"/> 
```

但无论如何，总是有一个白色的边框。我该如何摆脱它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-13T16:40:07.880

我知道这是一个老问题，它特定于混合，但是当谷歌搜索这个问题时，这是我发现的第一件事。

解决此问题的一个非常简单的示例，它比提到的第一个答案稍微简单一点，即设置“样式”属性。（不确定这是否适用于混合，因为我不使用混合，但对于视觉工作室中的简单 wpf，这是有效的）

例如，下面的代码创建了一个窗口，就像问题中提到的那样，但白线（在下拉项目中）是可编辑的。

```
<ComboBox Background="Blue" BorderBrush="Red">
    <ComboBox.ItemContainerStyle>
        <!-- Without this style section, there are white lines around the borders.  Even if you set these properties in the comboBoxItem areas -->
        <Style TargetType="ComboBoxItem">
            <Setter Property="Background" Value="Green"/>
            <Setter Property="BorderBrush" Value="Purple"></Setter>
        </Style>
     </ComboBox.ItemContainerStyle>
     <ComboBoxItem MouseMove="schedule" Name="cbi1">schedule</ComboBoxItem>
</ComboBox> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T18:50:11.723

问题是当您编辑副本时，您正在使用 Microsoft 的内置 chrome 组件编辑副本。为了更改外部边界，您需要用普通的 WPF 控件替换这些位，以便您可以更改值。对于组合框，您需要在此处使用代码：http: [//msdn.microsoft.com/en-us/library/ms752094](http://msdn.microsoft.com/en-us/library/ms752094)

e：这是您要编辑的部分

```
 <Border x:Name="Border"
        Grid.ColumnSpan="2"
        CornerRadius="2"
        BorderThickness="1">
  <Border.BorderBrush>
    <LinearGradientBrush EndPoint="0,1"
                         StartPoint="0,0">
      <GradientStop Color="{DynamicResource BorderLightColor}"
                    Offset="0" />
      <GradientStop Color="{DynamicResource BorderDarkColor}"
                    Offset="1" />
    </LinearGradientBrush>
  </Border.BorderBrush> 
```

# php - 在 PHP 中将对象作为参数发送，而不实例化它

> ID：11528448
> 
> 赞同：1
> 
> 时间：2012-07-17T18:15:30.073
> 
> 标签：php, class, object

如何在函数调用中将对象作为参数发送？我不想在传递对象时实例化它，所以`myFunction( new myObject() )`不会工作。

我希望`myFunction`以后能够实例化该对象。我只是不确定如何以这种方式传递课程。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T18:17:54.830

将类名作为字符串传递，并实例化它。

[https://stackoverflow.com/a/4578343/362536](https://stackoverflow.com/a/4578343/362536)

```
function ($className) {
    $object = new $className();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T18:20:08.097

您可以传递一个字符串并执行以下操作：

```
myFunction($class) {
    $object = new $class();
} 
```

但更好的 OOP 方法是传递一个工厂对象并让工厂创建对象：

```
class MyFactory {
    public function create() { 
        return new myObject; 
    }
}

myFunction(MyFactory $factory) {
    $object = $factory->create();
} 
```

# iphone - iphone - 通知没有被触发

> ID：11528459
> 
> 赞同：0
> 
> 时间：2012-07-17T18:16:36.790
> 
> 标签：iphone, objective-c, nsnotificationcenter

目标：

我想使用观察者模式，这样当一个 uiimageview 接收到不同的背景图像时，其他 2 个 uiimageview 将监听该更改，然后更改自己。

战略：

根据我在 Objective-c 中读到的观察者模式，我决定实现 nsnotificationcenter。

代码：

self 指的是 RemoteViewManagerController，updateButtons 是触发 ImageSwap 事件时将调用的方法，object 指的是“主”uiimageview，即改变时会导致其他uiimageview 发生变化的uiimageview。

```
- (void)registerButtonObserver:(UIView *)currentView
{  
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(updateButtons:) name:@"ImageSwap" object:[self.view viewWithTag:1]];
} 
```

setDefaultButtons 被调用，我们根据标签遍历按钮和目标按钮。“主”uiviewimage 的标签为 1。所以我们调用 setImageChange 来更改该按钮的背景图像，结果，我想触发 ImageSwap 事件，以更改其他两个 uiimageview 按钮，然后我传入那些按钮用户信息字典的一部分。这个想法是当调用 updateButtons 时，我可以在 userinfo 字典中引用这些按钮。

```
- (void)setDefaultButtons:(UIView *)currentView
{
    for( UIView *view in currentView.subviews ) {  
        if( [view isKindOfClass:[UIButton class]] ) {  
            if( view.tag == 1 ){                
                [self setImageChange:@"fence" forButton:view];

                NSArray *keys = [NSArray arrayWithObjects:@"subview1", @"subview2", nil];
                NSArray *objects = [NSArray arrayWithObjects:[self.view viewWithTag:4], [self.view viewWithTag:5], nil];
                NSDictionary *items = [NSDictionary dictionaryWithObjects:objects 
                                                                       forKeys:keys];
                NSLog(@"But we sure to get here right");
                [[NSNotificationCenter defaultCenter]postNotificationName:@"ImageSwap" object:view userInfo:items];                
            }
            else if(view.tag == 2){
                [self setImageChange:@"siren" forButton:view];
            }
            else if(view.tag == 3){
                [self setImageChange:@"auxiliary" forButton:view];
            }
        }  
    }
} 
```

请注意，我知道我们到达了 postNotificationName 行，因为这行确实触发了： NSLog(@"But we sure to get here right");

我没有收到任何错误。但是 RemoteViewManagerController.m 中的这一行：

```
- (void)updateButtons:(NSNotification*)notification 
{
    NSLog(@"Do we get here?");
} 
```

永远不会被调用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:22:17.070

我相信当两个子视图具有相同的标签时，`-viewWithTag:`只返回它找到的第一个。因此，如果碰巧有两个视图的 tag=1，那么您很可能观察到了错误的视图。尝试将调用中的`object`参数更改为，这将表明您要观察所有对象的通知。`-addObserver...``nil`

# jquery - 一个一个滑动内容，否则显示所有内容

> ID：11528462
> 
> 赞同：0
> 
> 时间：2012-07-17T18:16:41.053
> 
> 标签：jquery, html, css

我的网站正在垂直滑动内容。但是会发生什么：如果我在主屏幕上，并且想要单击最后一个菜单项（新闻通讯）.. 在到达目标链接（新闻通讯）之前滑动显示所有内容..

所以..我想知道，我需要做什么才能只滑动我点击的菜单项，否则是所有内容。

这是我有这个问题的工作网站：[http ://www.alsite.com.br/luxxx](http://www.alsite.com.br/luxxx)

这是我的滑动脚本：

```
$(document).ready(function() {

        //get all link with class panel
        $('a.panel').click(function () {

                    //reset and highlight the clicked link
            $('a.panel').removeClass('selected');
            $(this).addClass('selected');

            //grab the current item, to be used in resize function
            current = $(this);

                    //scroll it to the destination
            $('#wrapper').scrollTo($(this).attr('href'), 800);      

                    //cancel the link default behavior
            return false;
        });

        //resize all the items according to the new browser size
        $(window).resize(function () {

            //call the resizePanel function
            resizePanel();
        });

        function resizePanel() {

    //get the browser width and height
    width = $(window).width();
    height = $(window).height();

    //get the mask height: height * total of items
    mask_height = height * $('.item').length;

    //set the dimension     
    $('#wrapper, .item').css({width: width, height: height});
    $('#mask').css({width: width, height: mask_height});

    //if the item is displayed incorrectly, set it to the corrent pos
    $('#wrapper').scrollTo($('a.selected').attr('href'), 0);

}

    }); 
```

感谢帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T18:35:04.040

当然，只需隐藏所有其他屏幕，除了您当前显示的屏幕和您想要显示并滑过的屏幕。如果您可以`.current`在当前正在查看的课程上设置课程，那么您可以这样做：

```
$('.item').hide();
$((this).attr('href')).add('.current').show();
$('#wrapper').scrollTo($(this).attr('href'), 800); 
```

# linux - 如何使用 ffmpeg 将任何视频合并到我的介绍中

> ID：11528469
> 
> 赞同：0
> 
> 时间：2012-07-17T18:17:09.463
> 
> 标签：linux, shell, video, ffmpeg

我有一个介绍视频。我想在用户上传视频的开头使用 ffmpeg 或类似程序添加介绍（是的，我确实需要将它们合并到一个文件中，所以以后可以下载它）我一直在搜索互联网和它建议将（介绍和其他视频）都转换为 .mpg 格式。

好的，到目前为止一切都很好，但是现在当我尝试将它们结合在一起时，我得到了

> [mpeg4 @ 0x5547c60]检测到无效和低效的vfw-avi打包B帧

所以我猜这是因为两个视频中的某些东西不同，比如帧速率或大小。最糟糕的是，用户可以上传几乎任何格式的视频，包括 240p-720p 质量，因此没有一个默认大小可以将介绍视频转换成。

怎么可能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T06:50:30.770

您的介绍视频应该与用户视频的分辨率相匹配，您应该拥有与用户视频一样多的分辨率的介绍视频。或者将所有用户视频转换为单一分辨率以匹配介绍视频的分辨率。您是否正在使用 intro.mpg + user.mpg 来组合视频？这是给出上述错误吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-21T21:21:13.653

使用 ffmpeg：

```
ffmpeg -i 'concat:input1|input2' -codec copy output 
```

或者

```
ffmpeg -i opening.mkv -i episode.mkv -i ending.mkv -filter_complex '[0:0] [0:1] [1:0] [1:1] [2:0] [2:1] concat=n=3:v=1:a=1 [v] [a]' -map '[v]' -map '[a]' output.mkv 
```

或者

```
$ cat mylist.txt
file '/path/to/file1'
file '/path/to/file2'
file '/path/to/file3'

$ ffmpeg -f concat -i mylist.txt -c copy output 
```

来源：[使用 ffmpeg 连接两个 mp4 文件](https://stackoverflow.com/questions/7333232/concatenate-two-mp4-files-using-ffmpeg)

# c# - 将 WPF 控件打印到图像控件

> ID：11528472
> 
> 赞同：1
> 
> 时间：2012-07-17T18:17:14.413
> 
> 标签：c#, wpf, image, pixelsense, scatterview

我正在为需要在表中显示数据（即DataGrid）的表面编写应用程序。这很好，除了表格捕获了 ScatterViewItem 控件的触摸交互（基本上是一个可以由用户旋转、缩小和移动的面板）。这可以防止用户轻松操作 ScatterViewItem。

为了解决这个问题，我认为将控件绘制到图像上并放上去会很容易。看来我错了。这是我所有的尝试：

[http://pastie.org/private/gfkkv9f6apgrqi1ucspwpa](http://pastie.org/private/gfkkv9f6apgrqi1ucspwpa)（无需阅读此内容，除非您认为它有用。这就是为什么它在馅饼中而不是在此处）

我将 DataGrid 放在另一个 Grid 中，否则将无法正确测量：

```
Grid g = new Grid();
g.Children.Add(dataTable);

SurfaceScrollViewer viewer = new SurfaceScrollViewer();
viewer.Content = Utility.SaveWPFControlAsImage(g); 
```

如果我们将最后一行更改为

```
viewer.Content = g; 
```

我们得到了一张好表：

![在此处输入图像描述](../Images/be9cd75bcdab24b5ee527512cec92fa1.png)

如果我们不这样做，我们会得到：

![在此处输入图像描述](../Images/391a20a93f1f8a43752f6bf61752e5cb.png)

SaveWPFControlAsImage 如下：

```
 public static System.Windows.Controls.Image SaveWPFControlAsImage(FrameworkElement e)
    {
        e.Measure(new System.Windows.Size(double.PositiveInfinity, double.PositiveInfinity));

        RenderTargetBitmap targetBitmap =
            new RenderTargetBitmap((int)e.DesiredSize.Width,
                                   (int)e.DesiredSize.Height,
                                   96d, 96d,
                                   PixelFormats.Default);
        targetBitmap.Render(e);

        BmpBitmapEncoder encoder = new BmpBitmapEncoder();
        encoder.Frames.Add(BitmapFrame.Create(targetBitmap));

        MemoryStream stream = new MemoryStream();
        encoder.Save(stream);
        BitmapImage bmp = new BitmapImage();
        bmp.BeginInit();
        bmp.StreamSource = new MemoryStream(stream.ToArray());
        bmp.EndInit();

        return new System.Windows.Controls.Image()
        {
            Source = bmp,
        };
    } 
```

所以也许我只是没有正确渲染它，或者，也许，我只是在错误的角度处理这个......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:46:45.917

在 WPF 中，您可以使用`VisualBrush`它来捕获给定控件的实时预览。此外，如果您不想要给定控件的任何输入，您可以随时设置`IsHitTestVisible="False"`.

# entity-framework-migrations - 当密钥位于基类中时，EF 迁移 DropForeignKey 失败

> ID：11528476
> 
> 赞同：6
> 
> 时间：2012-07-17T18:17:22.083
> 
> 标签：entity-framework-migrations, entity-framework-5

我正在尝试为 EF 5.0.0-rc 代码优先类库更新我的数据模型。Up() 方法中的第一个命令是

```
DropForeignKey("dbo.ChileInventory", new[] { "LotInventoryItemTypeId", "ChileProductId" }, "dbo.ChileProducts"); 
```

但我收到 SqlException: 'FK_dbo.ChileInventory_dbo.ChileProducts_LotInventoryItemTypeId_ChileProductId' 不是约束。无法删除约束。

我认为错误的原因是由于我的 ChileProducts 类从其基类中获取了它的关键属性。由于接受主列名称的 DropForeignkey 方法没有重载，我相信 EF 无法确定要删除的正确约束。我还应该指出，异常消息中显示的约束名称与数据库中的约束名称不匹配（因此出现错误......）

您将在下面找到数据模型和迁移方法。但首先简要说明一下迁移背后的变化性质：InventoryBase 类的每个派生类都通过 InventoryTypeId 和 [InventoryTypeSpecific]ProductId 的复合键定义产品类型。例如，ChileInventory 会将其特定的智利类型标识为 InventoryItemTypeId = [ChileInventoryTypeId] 和 ChileProductId = [ChileProductId]。PackagingInventory 会将其包装类型标识为 InventoryItemTypeId = [PackagingInventoryTypeId] 和 PackagingProductId = [PackagingProductId]。等等。

我正在努力推出的模型更改是将 [InventoryTypeSpecific]ProductId 从每个 InventoryBase 衍生品提升到基础。这将导致所有 InventoryBase 派生对象共享一个公共 ProductId 属性，该属性与 InventoryItemTypeId 一起可以实现从 InventoryBase 到 ProductBase 的导航；这在以前的模型中是不可能的。

提前感谢您的建议和考虑。——文尼

## 数据模型

### 智利产品

```
public abstract class ProductBase
{
    [Key]
    [Column(Order = 0)]
    public virtual int InventoryItemTypeId { get; set; }

    [Key]
    [Column(Order = 1)]
    public virtual int Id { get; set; }

    [StringLength(150)]
    public virtual string Name { get; set; }

    [ForeignKey("InventoryItemTypeId")]
    public virtual InventoryItemType InventoryItemType { get; set; }

    public virtual bool IsActive { get; set; }
}
public class ChileProduct : ProductBase
{
    public virtual int ChileTypeId { get; set; }

    [ForeignKey("ChileTypeId")]
    public virtual ChileType ChileType { get; set; }
} 
```

### 智利库存

```
public abstract class InventoryBase
{
    [Key]
    [Column(Order = 0, TypeName = "Date")]
    public virtual DateTime DateCreated { get; set; }

    [Key]
    [Column(Order = 1)]
    public virtual int Sequence { get; set; }

    [Key]
    [Column(Order = 2)]
    public virtual int LotInventoryItemTypeId { get; set; }

    [Column(TypeName = "Date")]
    public virtual DateTime LotDateCreated { get; set; }

    public virtual int LotSequence { get; set; }

    public virtual int ProductId { get; set; }

    [ForeignKey("LotInventoryItemTypeId, LotDateCreated, LotSequence")]
    public virtual Lot Lot { get; set; }

    [ForeignKey("LotInventoryItemTypeId")]
    public virtual InventoryItemType ItemType { get; set; }

    public virtual ICollection<InventoryQuantityByLocation> QuantitiesByLocation { get; set; }

    [ForeignKey("LotInventoryItemTypeId, ProductId")]
    public virtual ProductBase ProductBase { get; set; }
}

public class ChileInventory : InventoryBase
{
    [Column(TypeName = "Date")]
    public virtual DateTime? ProductionBatchDateCreated { get; set; }

    public virtual int? ProductionBatchSequence { get; set; }

    public virtual int PackagingInventoryItemTypeId { get; set; }

    public virtual int PackagingProductId { get; set; }

    [ForeignKey("ProductionBatchDateCreated, ProductionBatchSequence")]
    public virtual ProductionBatch ProductionBatch { get; set; }

    [ForeignKey("LotInventoryItemTypeId, ProductId")]
    public virtual ChileProduct ChileProduct { get; set; }

    [ForeignKey("PackagingInventoryItemTypeId, PackagingProductId")]
    public virtual PackagingProduct PackagingProduct { get; set; }

} 
```

## 移民

```
public override void Up()
    {
        DropForeignKey("dbo.ChileInventory", new[] { "LotInventoryItemTypeId", "ChileProductId" }, "dbo.ChileProducts");
        DropForeignKey("dbo.PackagingInventory", new[] { "LotInventoryItemTypeId", "PackageId" }, "dbo.PackagingProducts");
        DropForeignKey("dbo.AdditiveInventory", new[] { "LotInventoryItemTypeId", "AdditiveProductId" }, "dbo.AdditiveProducts");
        DropIndex("dbo.ChileInventory", new[] { "LotInventoryItemTypeId", "ChileProductId" });
        DropIndex("dbo.PackagingInventory", new[] { "LotInventoryItemTypeId", "PackageId" });
        DropIndex("dbo.AdditiveInventory", new[] { "LotInventoryItemTypeId", "AdditiveProductId" });
        AddColumn("dbo.Inventory", "ProductId", c => c.Int(nullable: false));
        AddForeignKey("dbo.Inventory", new[] { "LotInventoryItemTypeId", "ProductId" }, "dbo.AdditiveProducts", new[] { "InventoryItemTypeId", "Id" });
        AddForeignKey("dbo.Inventory", new[] { "LotInventoryItemTypeId", "ProductId" }, "dbo.AdditiveProducts", new[] { "InventoryItemTypeId", "Id" });
        AddForeignKey("dbo.Inventory", new[] { "LotInventoryItemTypeId", "ProductId" }, "dbo.AdditiveProducts", new[] { "InventoryItemTypeId", "Id" });
        AddForeignKey("dbo.Inventory", new[] { "LotInventoryItemTypeId", "ProductId" }, "dbo.AdditiveProducts", new[] { "InventoryItemTypeId", "Id" });
        CreateIndex("dbo.Inventory", new[] { "LotInventoryItemTypeId", "ProductId" });
        CreateIndex("dbo.Inventory", new[] { "LotInventoryItemTypeId", "ProductId" });
        CreateIndex("dbo.Inventory", new[] { "LotInventoryItemTypeId", "ProductId" });
        CreateIndex("dbo.Inventory", new[] { "LotInventoryItemTypeId", "ProductId" });
        DropColumn("dbo.ChileInventory", "ChileProductId");
        DropColumn("dbo.PackagingInventory", "PackageId");
        DropColumn("dbo.AdditiveInventory", "AdditiveProductId");
    }

    public override void Down()
    {
        AddColumn("dbo.AdditiveInventory", "AdditiveProductId", c => c.Int(nullable: false));
        AddColumn("dbo.PackagingInventory", "PackageId", c => c.Int(nullable: false));
        AddColumn("dbo.ChileInventory", "ChileProductId", c => c.Int(nullable: false));
        DropIndex("dbo.Inventory", new[] { "LotInventoryItemTypeId", "ProductId" });
        DropIndex("dbo.Inventory", new[] { "LotInventoryItemTypeId", "ProductId" });
        DropIndex("dbo.Inventory", new[] { "LotInventoryItemTypeId", "ProductId" });
        DropIndex("dbo.Inventory", new[] { "LotInventoryItemTypeId", "ProductId" });
        DropForeignKey("dbo.Inventory", new[] { "LotInventoryItemTypeId", "ProductId" }, "dbo.AdditiveProducts");
        DropForeignKey("dbo.Inventory", new[] { "LotInventoryItemTypeId", "ProductId" }, "dbo.AdditiveProducts");
        DropForeignKey("dbo.Inventory", new[] { "LotInventoryItemTypeId", "ProductId" }, "dbo.AdditiveProducts");
        DropForeignKey("dbo.Inventory", new[] { "LotInventoryItemTypeId", "ProductId" }, "dbo.AdditiveProducts");
        DropColumn("dbo.Inventory", "ProductId");
        CreateIndex("dbo.AdditiveInventory", new[] { "LotInventoryItemTypeId", "AdditiveProductId" });
        CreateIndex("dbo.PackagingInventory", new[] { "LotInventoryItemTypeId", "PackageId" });
        CreateIndex("dbo.ChileInventory", new[] { "LotInventoryItemTypeId", "ChileProductId" });
        AddForeignKey("dbo.AdditiveInventory", new[] { "LotInventoryItemTypeId", "AdditiveProductId" }, "dbo.AdditiveProducts", new[] { "InventoryItemTypeId", "Id" });
        AddForeignKey("dbo.PackagingInventory", new[] { "LotInventoryItemTypeId", "PackageId" }, "dbo.PackagingProducts", new[] { "InventoryItemTypeId", "Id" });
        AddForeignKey("dbo.ChileInventory", new[] { "LotInventoryItemTypeId", "ChileProductId" }, "dbo.ChileProducts", new[] { "InventoryItemTypeId", "Id" });
    } 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-18T04:28:29.897

这是我发现的一种解决方法：

使用包含参数*principalName*和*name*的 DropForeignKey 重载——在这种情况下，这意味着**约束**名称！它有点脆弱，因为它需要预先了解约束名称，但它可以按预期工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-14T16:03:44.277

如果您的初始模型是使用 EF 4.3 创建的，那么您将在 EF 5.0 中遇到此类错误，因为生成 PK/FK 约束名称的规则在这两个 EF 版本之间发生了变化。

有关详细信息和另一种可能的解决方案，请参阅此[问题](https://stackoverflow.com/q/12053627/393672)。

# emulation - Windows 8 传感器。在模拟器上测试

> ID：11528477
> 
> 赞同：1
> 
> 时间：2012-07-17T18:17:26.670
> 
> 标签：emulation, windows-8, sensors

我没有 Windows 8 平板电脑。在平板电脑模拟器和桌面 Windows 8 上，以下代码返回`null`：

```
lightSensor = Windows.Devices.Sensors.LightSensor.getDefault(); 
```

其他传感器也一样（但地理定位不一样）。

我可以在没有设备的情况下以某种方式测试我的代码吗？我不关心返回的任何合理数据，但测试代码的正确性会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T06:34:38.323

买一个光传感器：P

目前测试这个王者的方法是有限的。IMO，如果您想要使用 Windows 8 的平板电脑，您应该破解市场上的其中一款平板电脑并在其上安装 Windows 8。微软在少数三星上安装了 Win8 来展示 Office 2013，所以它不会那么难 :)

但这有点离题了。回到问题。IMO 如果没有带有光传感器的设备，您将无法对其进行测试。我发现了许多您的代码示例，但没有一个经过测试。

# html - 为什么我必须将 left 和 right 设置为 0 才能使控件水平居中？

> ID：11528478
> 
> 赞同：2
> 
> 时间：2012-07-17T18:17:31.863
> 
> 标签：html, css

我使用CSS如下：

```
.center
{
    width: 30%;
    position: absolute;
    margin-left: auto;
    margin-right: auto;
    display: block;
    height: 100%;
    text-decoration: none;
    overflow: hidden;
    right:0;
    left:0;
} 
```

没有它是行不通的

```
right:0;
left:0; 
```

（我在[这里](http://www.zachgraeve.com/2006/10/01/center-abosulte-position-div/)的评论中找到了该解决方案）

为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T19:03:37.953

好的，请耐心等待……这整件事与[视觉格式化模型](http://www.w3.org/TR/CSS2/visuren.html)有关，特别是与计算宽度和边距的方式有关。

有几件事需要考虑，比如`display`和`position`（都可以[在 CSS 规范的第 10.3 节](http://www.w3.org/TR/CSS2/visudet.html#Computing_widths_and_margins)中看到）。

特别是对于您的情况，我们正在谈论绝对定位的非替换元素（因为它不是图像或任何具有固有大小的东西），所以它是第[10.3.7 节绝对定位的非替换元素](http://www.w3.org/TR/CSS2/visudet.html#abs-non-replaced-width)。

根据你的 CSS，你有一个定义的宽度，所以 not `auto`，你的左右边距都是`auto`. 所以它归结为左/右值是什么：

如果定义了 left/right ，而**不是 auto**，则适用以下规则：

> 如果 'margin-left' 和 'margin-right' 都是 'auto'，请在两个边距获得相等值的额外约束下求解方程 (...)

如果 left/right 没有定义，所以它们默认为**auto**，以下规则适用：

第一的：

> 将 'margin-left' 和 'margin-right' 的 'auto' 值设置为 0 (...)

第二：

> 如果建立包含静态位置的块的元素的“direction”属性是“ltr”，则将“left”设置为静态位置，否则将“right”设置为静态位置。然后求解'left'（如果'direction'是'rtl'）或'right'（如果'direction'是'ltr'）。

所以你可以看到，如果你没有为左/右定义一个特定的值，你的边距实际上会变成`0`你最终将 div 放在容器的左边或右边，具体取决于`direction`属性的值（你可以通过在你的css上放置类似的东西来测试这个，`html { direction:rtl; }`当左/右是自动时，div应该向右而不是向左）

但是，如果您确实指定了值，在您的情况下为 0，则“两个边距获得相等的值”有效地使元素居中。

希望能帮助到你！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T18:34:17.643

> “对于绝对定位的元素，*top*、*right*、*bottom*和 *left*属性指定元素包含块边缘的偏移量（元素相对于什么定位）。然后元素的边距定位**在这些偏移量内**。”

来源：[MDN](https://developer.mozilla.org/en/CSS/position)

这就是它起作用的原因 - 通过设置`left`和`right`属性，您可以将元素的偏移量拉伸为 100%。在 100% 的宽度内，`margin: auto`一切正常。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-17T18:21:56.090

It's a bit unexpected to see "absolute" (which is used when you want to control the position of the element on the site) and then "auto". Nevertheless, you might have a good reason for doing that. I'd suggest that since you're using the style

```
position: absolute; 
```

you could center it by specifying the style

```
left: 50%;
margin-left: -40px; 
```

under the assumption that your component is 80 pixels wide.

# asp.net-mvc - 从 github 克隆的 ASP.NET MVC 3 应用程序在每个 Nuget'd 包旁边显示黄色感叹号

> ID：11528488
> 
> 赞同：0
> 
> 时间：2012-07-17T18:18:11.350
> 
> 标签：asp.net-mvc, asp.net-mvc-3, github, nuget, nuget-package

从 github 克隆 ASP.NET MVC 项目后，通过 NuGet 提供的每个 DLL 都会在黄色背景下显示一个感叹号。问题似乎是绝对路径而不是相对路径，这意味着它显示了初始开发人员的绝对路径，在我的情况下与我的不同。

所以 ...

有没有办法强制 Nuget 使用相对路径？或者，有没有办法简单地使用 Nuget 从项目中更新所有这些？或者，有没有更好的方法在 github 环境中使用 NuGet？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T18:58:38.317

在您的项目上启用包还原。这将导致 Nuget 在构建时下载任何丢失的 dll。无论如何，它们不应该是绝对的，但是如果它们丢失了，这将解决它。

您可以在 Visual Studio 中右键单击解决方案并选择“启用 Nuget 包还原”

旧博文： [http ://blog.davidebbo.com/2011/08/easy-way-to-set-up-nuget-to-restore.html](http://blog.davidebbo.com/2011/08/easy-way-to-set-up-nuget-to-restore.html)

# jquery - 使用 jquery .get 选择与选项分离

> ID：11528492
> 
> 赞同：0
> 
> 时间：2012-07-17T18:18:15.443
> 
> 标签：jquery, append

一些我的选项如何与我的下拉菜单分开，我不知道为什么。一切顺利。如果我在将它附加到该 div 之前或之后发出警报（数据），它会将它们一起显示，但由于某种原因，它在附加过程中会变得混乱。

```
/* add category dropdown */
jQuery('#add_category').live("click", function(){
    jQuery.get("add_dropdown.php", { cat_num: cat_num },
    function(data){
        jQuery('#add_category').remove();
        jQuery('#added_categories').append(data);
        jQuery("#drop"+cat_num).selectbox("attach");
        cat_num += 1;
    });
}); 
```

这是 add_dropdown.php

```
<?php 
include('database.php');
include('logged_in.php'); 
?>
<p>
    <label>Additional Category</label>
    <span class="field">
        <select name="cat<?php echo $_GET['cat_num']; ?>" class="longinput" id="drop<?php echo $_GET['cat_num']; ?>"/>
            <option value=""></option>
            <?php $result = mysql_query("SELECT id, name FROM product_categories WHERE website_id='".$website_info['id']."' ORDER BY sub_of ASC");
            while($row = mysql_fetch_array($result)){
                echo "<option value='".$row['id']."'>".$row['name']."</option>";    
            } ?>
        </select>
        <a id='add_category' style='cursor: pointer;'>+ add one</a>
    </span>
</p> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T18:28:41.827

我的问题是它正在转换已经关闭的选择。

# javascript - 有哪些 HTML5 Canvas 像素检测和图像处理库？

> ID：11528494
> 
> 赞同：1
> 
> 时间：2012-07-17T18:18:23.053
> 
> 标签：javascript, html5-canvas

我正在尝试开发一个“Web 应用程序”（由于缺乏更好的术语），它使用用于移动设备的 HTML5 Canvas 元素显示一种交互式地图。该地图有大约 30 座不同形状和大小的建筑物（由其上的半透明 PNG 图像制成）。我希望用户能够点击任何建筑物以获取有关它们的信息。这些建筑物通常位于其他建筑物的同一个理论边界框内，因此它并不像检测用户何时在边界框内轻敲（想象一个 U 形建筑物和 U 内的另一建筑物）那么简单。因此，它应该使用某种光栅像素检测。为了让事情变得更复杂，我需要允许用户在地图上放大/缩小和平移（因为 30 座建筑物和一张地图对于在小手机屏幕上显示用户来说实在是太多了）。

我正在寻找一个可以支持这些功能的 JavaScript 库：

1.  图像像素检测
2.  移动触摸事件
3.  画布（或舞台？）缩放
4.  可在移动设备上使用

到目前为止，我已经找到了支持所有这些特性的 KineticJS。但是当我尝试在舞台上移动超过 4 个建筑物的地图时，它太跳动了。我尝试检查 Fabric.js，但它似乎没有像素检测（因为当您在边界框内单击时它会选择图像，而不是实际图像本身）。

有没有其他 JavaScript 库可以做这些事情？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T16:07:28.010

KineticJS 非常好（迄今为止我发现的最好的库）

我从来没有尝试过使用 png 图像，但是使用数百个原始对象进行缩放和平移非常流畅（没有像素检测 - 我想像素检测是相当昂贵的 CPU 操作）。

也许您可以尝试覆盖标准多边形（一栋建筑有几个）并附加到同一个点击/点击事件。

此外，您不需要在画布上移动对象，您只需将较大的画布放在较小的 div 中（带有溢出：隐藏）并拖动整个画布元素。

# javascript - JQuery 功能仅适用于浏览器刷新

> ID：11528498
> 
> 赞同：-1
> 
> 时间：2012-07-17T18:18:47.123
> 
> 标签：javascript, jquery

我遇到的问题是 JQuery 函数只有在我刷新网页时才有效，它在每个浏览器上都以这种方式工作。我想要做的是，一旦包含在特定 div 容器中的所有文本字段都在其中包含数据，我希望容器插入复选标记图像。但目前此图像仅在我在文本字段中输入所有数据并刷新浏览器后才可见。

.rightbilling 是 div 容器的类，我试图评估其文本字段，而“#step1”是包含 .rightbilling 的字段集。

我已经尝试解决这个问题好几个小时了。非常感谢您的帮助。如果您需要更多信息，请告诉我。

```
$(document.body).ready(function() {
        var all_complete = true;    
    $(".rightbilling").find("input:text").each(function(){

        if ($(this).val() == '' ) {
            all_complete = false;
            return true;
        };

    if (all_complete) {
        $("#step_1")
        .animate({
            paddingBottom: "120px"
        })
        .css({
            "background-image": "url(images/check.png)",
            "background-position": "bottom center",
            "background-repeat": "no-repeat"
        });

        $("#step_2").css({
            opacity: 1.0
        });
        $("#step_2 legend").css({
            opacity: 1.0 // For dumb Internet Explorer
        });
    };
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T18:22:05.620

因为您使用的是 document.ready 函数，所以只有在页面加载时才会调用您的函数。您需要考虑附加一个 onChange 侦听器以在输入字段已更改时调用您的函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T18:30:39.387

```
$(document.body).ready(
    function () {
        var validation = function () {
            var all_complete = true;
            $(".rightbilling").find("input:text").each(
                function () {
                    if ($(this).val() == '') {
                        all_complete = false;
                        return true;
                    }
                    if (all_complete) {
                        $("#step_1").animate({
                            paddingBottom: "120px"
                        }).css({
                            "background-image": "url(images/check.png)",
                            "background-position": "bottom center",
                            "background-repeat": "no-repeat"
                        });
                        $("#step_2").css({
                            opacity: 1.0
                        });
                        $("#step_2 legend").css({
                            opacity: 1.0 // For dumb Internet Explorer
                        });
                    }
            });
        }
        validation();  //call it when the page is loaded
        $(".rightbilling").find("input:text").on("change",validation); //call it when input changes
    }
); 
```

# android - Android 支持库最低 SDK

> ID：11528500
> 
> 赞同：0
> 
> 时间：2012-07-17T18:19:12.363
> 
> 标签：android, compatibility, android-support-library

**Android 支持库**（也称为兼容性库）的最低 SDK 版本是多少？它会一直回到 SDK 1 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:22:55.290

Android 支持包中的大多数项目都支持回 API 级别 4（又名 Android 1.6）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T18:23:33.127

支持的最低 API 级别：4

您可以在此处查看更多信息：

> [http://developer.android.com/tools/extras/support-library.html](http://developer.android.com/tools/extras/support-library.html)

# java - 如何在一个请求中发送文件和重定向？

> ID：11528503
> 
> 赞同：1
> 
> 时间：2012-07-17T18:19:51.310
> 
> 标签：java, jakarta-ee, servlets, glassfish

我有一个将文件发送到客户端的 servlet。是否可以添加重定向以开始下载并将用户重定向到另一个 html 页面？这是我的代码：

```
 protected void processRequest(HttpServletRequest request, HttpServletResponse response)
                throws ServletException, IOException {
            try {
                System.out.println("debut transfert fichier a " + request.getRemoteUser() + "/" + request.getRemoteAddr());

                response.setContentType("text/plain");
                response.setHeader("Content-Disposition",
"attachment;filename=my_file.pdf");
                // ServletContext ctx = getServletContext();
                File jnlp = new File(PATH);
                InputStream is = new FileInputStream(jnlp);

                int read = 0;
                byte[] bytes = new byte[BYTES_DOWNLOAD];
                OutputStream os = response.getOutputStream();

                while ((read = is.read(bytes)) != -1) {
                    os.write(bytes, 0, read);
                }
                 // not workinggetServletContext().getRequestDispatcher("/merci.html").forward(request, response);
                os.flush();

                os.close();
                is.close();
                HttpSession session = request.getSession();
                //    

            } catch (Exception ex) {
                System.out.println("Erreur inconnu lors transfert :" + ex);
            } 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T18:47:18.547

解决此问题的更好方法是将用户发送到摘​​要/感谢页面（将 URL 传递给下载）并将浏览器“重定向”到实际的下载 URL。

用户应该停留在第二页，因为浏览器会识别出“重定向”是下载而不是新页面。

# entity-framework - 实体框架中的连接字符串

> ID：11528505
> 
> 赞同：2
> 
> 时间：2012-07-17T18:19:56.483
> 
> 标签：entity-framework, connection-string

我被困住了。我花了将近一天的时间来解决，但无济于事。

问题：使用实体框架连接到生产数据库。

我在开发上连接良好。

```
<add name="DefaultConnectionString" connectionString="Data Source=.\SQLEXPRESS;Initial Catalog=MONDO;Integrated Security=True" providerName="System.Data.SqlClient" />

<add name="MONDOEntities" connectionString="metadata=res://*;provider=System.Data.SqlClient;provider connection string=&quot;Data Source=.\SQLEXPRESS;Initial Catalog=MONDO;Integrated Security=True;MultipleActiveResultSets=True&quot;" providerName="System.Data.EntityClient" /> 
```

转向生产，我使用（来自生产 web.config 文件）现有的“DefaultConnectionString”参数（ID 和密码）来编辑 MONDOEntities 连接字符串。（我可以这样做吗？）此外，我扩展了 MONDOEntities 中的元数据以包括 .csdl、.ssdl、.msl 并在其前面加上（再次猜测，我可以这样做吗？）MONDO。粗体部分是从 dev web.config 到生产 web.config 的更改。*注意，下面的连接字符串不是由 Visual Studio 创建的，我只是自己更改了一些信息以尝试使其在生产端工作。

```
<add connectionString="Data Source=MPOC\SQLEXPRESS;Database=Mondo;User ID=xxx;Password=xxxxx;" name="DefaultConnectionString" />

<add name="MONDOEntities" connectionString="metadata=res://*/MONDO.csdl|res://*/MONDO.ssdl|res://*/MONDO.msl;provider=System.Data.SqlClient;provider connection string=&quot;Data Source=MPOC\SQLEXPRESS;persist security info=True;Database=Mondo;User ID=xxx;Password=xxxxx;MultipleActiveResultSets=Tru e;App=EntityFramework&quot;" providerName="System.Data.EntityClient" /> 
```

我得到的错误消息是：无法加载指定的元数据资源。

```
Line 62: /// Initializes a new MONDOEntities object using the connection string found      in the 'MONDOEntities' section of the application configuration file.
Line 63: /// </summary>
Line 64: public MONDOEntities() : 
```

问题：我可以简单地手动修改 connectionStrings 还是需要通过编译过程来运行？这是一个网站项目，所以它会在我上传到生产环境后第一次即时编译。它没有在我的本地开发计算机上预编译。我想，底线是，如何为生产中的数据库的实体连接设置正确的 connectionString？

* * *

我正在进行一个需要学习现有网站的项目。我正在修复我的第一个错误并学习了 ado.net，我创建了一个实体数据模型并进行了一些代码更改。一切都在开发中顺利进行。

我将文件移至生产环境，然后出现此错误：

```
"The specified default EntityContainer name 'MONDOEntities' could not be found in the mapping and metadata information.
Parameter name: defaultContainerName" 
```

我用谷歌搜索了这条错误消息，并根据一些发现，我扩展了我的“元数据”，如下所示。这对我来说更像是在黑暗中拍摄：

原始（创建实体数据模型时在 web.config 中自动生成）：

```
connectionString="metadata=res://* 
```

新（我编辑/添加了这个）：

```
connectionString="metadata=res://*/MONDO.csdl|res://*/MONDO.ssdl|res://*/MONDO.msl; 
```

这似乎克服了第一个错误，我收到了一条新的错误消息（如 OP 中发布的）：

```
Unable to load the specified metadata resource.

Line 62: /// Initializes a new MONDOEntities object using the connection string found     in the 'MONDOEntities' section of the application configuration file.
Line 63: /// </summary>
Line 64: public MONDOEntities() : 
```

我认为我的元数据信息有问题。但是，鉴于原始的自动生成的 connectString 仅包含“metadata=res://*”，我真的不知道如何纠正这个问题。实际上，我什至不确定这是问题的根源。

底线，我的实体模型在开发中运行顺利，但在生产中没有连接。任何想法表示赞赏......谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:03:14.307

连接字符串与编译无关，只要您没有定义要对其执行的一些转换，或者您有一些对其进行操作的自定义钩子。所以是的，你可以手动修改它。

您可能弄错了这些元数据，尝试使用它们（例如删除前缀）。

您还绝对确定，在您的生产环境中，MONDOEntities 正在加载和使用正确的 connectionString 吗？

# google-apps-script - 需要帮助在脚本编辑器中创建 For 循环以使脚本在 Google 电子表格中的所有工作表上运行代码

> ID：11528510
> 
> 赞同：0
> 
> 时间：2012-07-17T18:20:08.737
> 
> 标签：google-apps-script, google-docs-api, google-spreadsheet-api

我有一个脚本，我试图在谷歌文档中的所有工作表上运行，但不知道如何使它工作。它适用于一张纸，但我有许多表格都需要检查相同的格式。谢谢。

这是我试图应用于所有工作表的脚本。

```
function sendEmail(email_address, email_subject, email_message) {
  MailApp.sendEmail(email_address, email_subject, email_message);
}

function timestamp() {
return new Date()
}

var EMAIL_SENT = "EMAIL_SENT";

function test_sendEmail() {
  var sheet = SpreadsheetApp.getActiveSheet();
  var cell = sheet.setActiveCell('A2');
  var criterion_cutoff = 5;
  var i = 0;
  var startRow = 2;
  var addr;
  var subj;
  var msg;
  var timecheck
  do {
    addr = cell.offset(i,0).getValue();
    subj = cell.offset(i,1).getValue();
    msg = cell.offset(i,2).getValue();
    criterion = cell.offset(i,3).getValue();
    timecheck = cell.offset(i,11).getValue();
    if (timecheck > 0) {
      if(criterion < criterion_cutoff) {
        sendEmail(addr,subj,msg);
        Browser.msgBox('Sending email to: ' + addr);
      }}
    i++;
  } while( cell.offset(i, 0).getValue().length > 0 )
  sheet.getRange(2, 5).setValue(timestamp());  
  Browser.msgBox('Done!');
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-22T12:45:27.717

您可以通过进行以下更改来使用要应用脚本的 ID 数组：
1\. 更改

```
function test_sendEmail() {
  var sheet = SpreadsheetApp.getActiveSheet(); 
```

到：

```
function test_sendEmail(sheetID) {
  var sheet = SpreadsheetApp.openById(sheetID); 
```

2\. 定义要更改的工作表 ID 数组：

```
var idArray = [Spreadsheet1_id, Spreadsheet2_id, ...]; 
```

3\. 创建一个循环遍历数组的所有元素

```
for(var k in idArray) test_sendEmail(idArray[i]); 
```

如果您不想手动填充 idArray，您可以创建一个函数来提取 Google Drive 中所有电子表格的 ID。如果这是您想要的，请使用以下代码，而不是我在第 2 点提供给您的代码行。

```
var sprArr =  DocsList.getFilesByType("spreadsheet");
var idArray;
for(var k in sprArr) idArray.push(sprArr[i].getId()); 
```

# android - android活动中的classnotfoundexception

> ID：11528511
> 
> 赞同：0
> 
> 时间：2012-07-17T18:20:10.830
> 
> 标签：android, exception

我有 2 个按钮链接到 2 个不同的 xml 文件。一个按钮有效，但是当我单击另一个按钮时，应用程序崩溃并且我的 logcat 向我发送了一堆错误。

这是 logcat 返回的内容

```
07-17 18:09:37.067: W/dalvikvm(329): threadid=1: thread exiting with uncaught exception (group=0x40015560)
07-17 18:09:37.077: E/AndroidRuntime(329): FATAL EXCEPTION: main
07-17 18:09:37.077: E/AndroidRuntime(329): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.example.com.proto1/com``.example.com.proto1.Voiceprompt}: java.lang.ClassNotFoundException: com.example.com.proto1.Voiceprompt in loader dalvik.system.PathClassLoader[/data/app/com.example.com.proto1-2.apk]
07-17 18:09:37.077: E/AndroidRuntime(329):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1569)
07-17 18:09:37.077: E/AndroidRuntime(329):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
07-17 18:09:37.077: E/AndroidRuntime(329):  at android.app.ActivityThread.access$1500(ActivityThread.java:117)
07-17 18:09:37.077: E/AndroidRuntime(329):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
07-17 18:09:37.077: E/AndroidRuntime(329):  at android.os.Handler.dispatchMessage(Handler.java:99)
07-17 18:09:37.077: E/AndroidRuntime(329):  at android.os.Looper.loop(Looper.java:123)
07-17 18:09:37.077: E/AndroidRuntime(329):  at android.app.ActivityThread.main(ActivityThread.java:3683)
07-17 18:09:37.077: E/AndroidRuntime(329):  at java.lang.reflect.Method.invokeNative(Native Method)
07-17 18:09:37.077: E/AndroidRuntime(329):  at java.lang.reflect.Method.invoke(Method.java:507)
07-17 18:09:37.077: E/AndroidRuntime(329):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
07-17 18:09:37.077: E/AndroidRuntime(329):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
07-17 18:09:37.077: E/AndroidRuntime(329):  at dalvik.system.NativeStart.main(Native Method)
07-17 18:09:37.077: E/AndroidRuntime(329): Caused by: java.lang.ClassNotFoundException: com.example.com.proto1.Voiceprompt in loader dalvik.system.PathClassLoader[/data/app/com.example.com.proto1-2.apk]
07-17 18:09:37.077: E/AndroidRuntime(329):  at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:240)
07-17 18:09:37.077: E/AndroidRuntime(329):  at java.lang.ClassLoader.loadClass(ClassLoader.java:551)
07-17 18:09:37.077: E/AndroidRuntime(329):  at java.lang.ClassLoader.loadClass(ClassLoader.java:511)
07-17 18:09:37.077: E/AndroidRuntime(329):  at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
07-17 18:09:37.077: E/AndroidRuntime(329):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1561)
07-17 18:09:37.077: E/AndroidRuntime(329):  ... 11 more 
```

我注意到由错误引起的，并认为它是源头。

这是我使用它的 java 和我的清单。

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.com.proto1"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="15" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name=".mainj"
            android:label="@string/title_activity_mainj" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name=".menu"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MENU" />

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>
        <activity
            android:name=".Infoactive"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.INFOSCREEN" />

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>
        <activity
            android:name=".Voiceprompt"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.VOICEPROMPTS" />

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>
    </application>

</manifest>

package com.example.com.proto1;

import android.app.Activity;
import android.content.Intent;
import android.media.MediaPlayer;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;

public class menu extends Activity {

    @Override
    protected void onCreate(Bundle aboutmenu) {
        // TODO Auto-generated method stub
        super.onCreate(aboutmenu);
        setContentView(R.layout.mainx);

        // Button Sound
        final MediaPlayer buttonSound = MediaPlayer.create(menu.this,
                R.raw.button_click);

        // Setting up the button references
        Button info = (Button) findViewById(R.id.aboutbutton);
        Button voice = (Button) findViewById(R.id.voicebutton);

        info.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                // TODO Auto-generated method stub
                buttonSound.start();
                startActivity(new Intent("android.intent.action.INFOSCREEN"));

            }
        });

        voice.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                // TODO Auto-generated method stub
                buttonSound.start();
                Intent voiceIntent = new Intent("android.intent.action.VOICEPROMPTS");
                startActivity(voiceIntent);
            }
        });

    }
} 
```

# ember.js - 如何在 Ember.ArrayController 中组合两个 DS.RecordArray

> ID：11528530
> 
> 赞同：2
> 
> 时间：2012-07-17T18:21:39.267
> 
> 标签：ember.js, ember-data

I want to create a view in Ember that combines records from two models and sorts them according to a common attribute.

I have made a working fiddle, but I am not sure if I am doing it right.

[http://jsfiddle.net/UtrtJ/15/](http://jsfiddle.net/UtrtJ/15/)

Is there a better way to do this?

[Edit] slightly updated the example to [http://jsfiddle.net/UtrtJ/16/](http://jsfiddle.net/UtrtJ/16/) which I think is better

# c# - 从 MAC 访问 Microsoft Team Foundation Server 网站

> ID：11528534
> 
> 赞同：0
> 
> 时间：2012-07-17T18:22:09.787
> 
> 标签：c#, ios, macos

这里有没有人尝试使用 safari 从 Mac OS 访问 TFS 的 Web 访问？我收到未找到服务器错误。在 Windows 上，它工作正常。

谢谢。

# objective-c - 检测到自动释放的 UIBarButtonItem 的潜在泄漏

> ID：11528537
> 
> 赞同：1
> 
> 时间：2012-07-17T18:22:11.363
> 
> 标签：objective-c, memory-management, memory-leaks

在以下代码中，xCode 的 Build & Analyze 函数检测到

> 在第 165 行分配并存储到“addButton”中的对象的潜在泄漏。

[addButton 是一个 UIBarButtonItem 使用类别 barItemWithImage （我在这里](http://forrst.com/posts/UIBarButtonItem_category_to_easy_add_custom_imag-9Ue)读到），它返回一个自动释放的对象。如果我不保留 addButtonItem，我会在尝试访问已发布的对象时遇到异常。

我在这里想念什么？

```
 UIBarButtonItem *addButton;

    if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad) {
        addButton = [UIBarButtonItem barItemWithImage:[UIImage imageNamed:@"RedPlus.png"] target:self action:@selector(createStoryModal:)];
    }else {
        addButton = [UIBarButtonItem barItemWithImage:[UIImage imageNamed:@"RedPlusiPhone.png"] target:self action:@selector(createStoryModal:)];
    }

    [addButton retain];

    NSArray* toolbarItems = [NSArray arrayWithObjects:
                             addButton,
                             [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace 
                                                                           target:nil
                                                                           action:nil],
                             nil];

    [toolbarItems makeObjectsPerformSelector:@selector(release)];
    self.toolbarItems = toolbarItems; 
```

类别代码：

```
 @implementation UIBarButtonItem(MyCategory)

+ (UIBarButtonItem*)barItemWithImage:(UIImage*)image target:(id)target action:(SEL)action{
    UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];
    [button setImage:image forState:UIControlStateNormal];
    [button setFrame:CGRectMake(0.0, 0.0, image.size.width, image.size.height)];
    [button addTarget:target action:action forControlEvents:UIControlEventTouchUpInside];

    return [[[UIBarButtonItem alloc] initWithCustomView:button] autorelease];
} 
```

@结尾

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T18:32:24.177

虽然该项目最初是一个自动释放的对象，但当您向它发送保留消息时，您现在是该对象的所有者，这意味着您必须释放它。`addButton`现在没有发布，所以会导致泄漏。

此外，您在 toolBarItems 数组中分配/初始化 UIBarButtonItem。你也不释放这个 UIBarButtonItem 。

由于toolbarItems 数组将增加addButton 和您在数组中分配/初始化的UIBarButton 的retainCount，因此在声明该数组后释放两者是安全的。（或者，为了清楚起见，在您设置`self.toolbarItems`为该数组之后。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T18:32:52.060

静态分析器是对的。

删除这个：

```
[addButton retain]; 
```

还有这个：

```
[toolbarItems makeObjectsPerformSelector:@selector(release)]; 
```

而且您还泄漏了`UIBarButtonItem`.

`NSArray`保留其元素。

其他地方可能还有其他内存问题，但这应该可以消除三个可见的问题/不良形式。

# javascript - 为什么我的 jQuery-UI 脚本不能在 Greasemonkey 中执行？它在 Firebug 控制台中运行

> ID：11528541
> 
> 赞同：2
> 
> 时间：2012-07-17T18:22:29.600
> 
> 标签：javascript, jquery, jquery-ui, greasemonkey

我对此进行了大量研究，因为这是我的第一个 Greasemonkey 脚本：

```
// ==UserScript==
// @name           Codecademy Resizeable Code
// @description    Adds jQuery resizable to editor
// @namespace      http://chrisneetz.com
// @include        http://www.codecademy.com/courses/*
// ==/UserScript==

$('#editor').resizable({ alsoResize: ".ace_scroller, .ace_editor, .ace_content, .ace_sb, .ace_print_margin_layer", handles: "n, s" }); 
```

我已经尝试过 Greasemonkey 的建议，但我不确定这是否是兼容性问题。 [第三方库](http://wiki.greasespot.net/Third-Party_Libraries#jQuery) 我已经将它包装在一个准备好的文档中，它没有任何区别，但是当我使用 Firebug 控制台时，它工作正常。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-18T00:17:12.793

# 更新：

我现在建议只使用托管在 Google 上的标准主题之一，而忘记尝试从本地副本运行所有内容（`@resource`指令的目的和 CSS 重写如下所示）。

[有关jQuery-UI 加载的维护密集度较低的方法，](https://stackoverflow.com/a/25468928/331508)请参阅此答案。

* * *

# 旧答案（仍然有效）：

Firebug javascript 在目标页面范围内执行。
Greasemonkey javascript 在受保护和特权的[沙箱](http://wiki.greasespot.net/Sandbox)中执行。

这意味着如果页面加载库，如 jQuery 和 jQuery-UI，Greasemonkey 脚本通常不会看到它们。（有一些方法可以解决这个问题，但尽可能避免它们。）

问题中的那个链接给出了答案。由于代码：`$('#editor').resizable(...`使用 jQuery 和 jQuery-UI，您的脚本必须包含这些库 - 如下所示：

```
// ==UserScript==
// @name        Codecademy Resizeable Code
// @description Adds jQuery resizable to editor
// @namespace   http://chrisneetz.com
// @include     http://www.codecademy.com/courses/*
// @require     http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js
// @require     http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js
// @grant       GM_addStyle
// ==/UserScript==

$('#editor').resizable ( {
    alsoResize: ".ace_scroller, .ace_editor, .ace_content, .ace_sb, .ace_print_margin_layer",
    handles:    "n, s"
} ); 
```

* * *

**然而**，jQuery-UI 也大量使用了自定义 CSS。让这个 CSS 与 Greasemonkey 一起工作有点复杂。像这样更改脚本以使用 CSS，加上 2 个更好的图标集：

```
// ==UserScript==
// @name        Codecademy Resizeable Code
// @description Adds jQuery resizable to editor
// @namespace   http://chrisneetz.com
// @include     http://www.codecademy.com/courses/*
// @require     http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js
// @require     http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js
// @resource    jqUI_CSS  http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css
// @resource    IconSet1  http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/images/ui-icons_222222_256x240.png
// @resource    IconSet2  http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/images/ui-icons_454545_256x240.png
// @grant       GM_addStyle
// @grant       GM_getResourceURL
// @grant       GM_getResourceText
// ==/UserScript==

$('#editor').resizable ( {
    alsoResize: ".ace_scroller, .ace_editor, .ace_content, .ace_sb, .ace_print_margin_layer",
    handles:    "n, s"
} );

/*--- Process the jQuery-UI, base CSS, to work with Greasemonkey (we are not on a server)
    and then load the CSS.

    *** Kill the useless BG images:
        url(images/ui-bg_flat_0_aaaaaa_40x100.png)
        url(images/ui-bg_flat_75_ffffff_40x100.png)
        url(images/ui-bg_glass_55_fbf9ee_1x400.png)
        url(images/ui-bg_glass_65_ffffff_1x400.png)
        url(images/ui-bg_glass_75_dadada_1x400.png)
        url(images/ui-bg_glass_75_e6e6e6_1x400.png)
        url(images/ui-bg_glass_95_fef1ec_1x400.png)
        url(images/ui-bg_highlight-soft_75_cccccc_1x100.png)

    *** Rewrite the icon images, that we use, to our local resources:
        url(images/ui-icons_222222_256x240.png)
        becomes
        url("' + GM_getResourceURL ("IconSet1") + '")
        etc.
*/
var iconSet1    = GM_getResourceURL ("IconSet1");
var iconSet2    = GM_getResourceURL ("IconSet2");
var jqUI_CssSrc = GM_getResourceText ("jqUI_CSS");
jqUI_CssSrc     = jqUI_CssSrc.replace (/url\(images\/ui\-bg_.*00\.png\)/g, "");
jqUI_CssSrc     = jqUI_CssSrc.replace (/images\/ui-icons_222222_256x240\.png/g, iconSet1);
jqUI_CssSrc     = jqUI_CssSrc.replace (/images\/ui-icons_454545_256x240\.png/g, iconSet2);

GM_addStyle (jqUI_CssSrc); 
```

# leaflet - 在 Leaflet 和 Wax 中绘制路线

> ID：11528542
> 
> 赞同：0
> 
> 时间：2012-07-17T18:22:31.207
> 
> 标签：leaflet, mapbox

我正在使用 Leaflet 和 MapBox。我需要开发一个 api，它将显示带有标签的某些城市点，并相应地在它们之间绘制路线。我有 BlueMarble 瓷砖直到一定的缩放，然后是 MapBox Streets。实现这个想法的最佳方式是什么？圆圈和路径是最佳选择吗？谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T15:49:44.493

我不确定你是否需要为你想做的事情创建一个 API。

[http://leaflet.cloudmade.com/examples/geojson.html](http://leaflet.cloudmade.com/examples/geojson.html)

在 Leaflet 教程中，它向您展示了如何从 GeoJson 数据创建 LineStrings 和 Points。因此，使用城市的纬度和经度坐标，您可以创建点并使用 LineStrings 来创建路线并将它们作为 GeoJson 图层添加到地图中。

# ldap - 复制 IBM Tivoli LDAP 服务器

> ID：11528544
> 
> 赞同：0
> 
> 时间：2012-07-17T18:22:40.677
> 
> 标签：ldap, replication, tivoli

我们有一个环境，其中包含两个 IBM Tivoli LDAP 服务器，其中 IBM Tivoli LDAP 配置为对等模式，也使用 NLB。

我们的一台机器崩溃了，我们在带有空 IBM Tivoli LDAP 服务器的机器上安装了一个新的操作系统。

现在我们想要将工作的 Tivoli LDAP 服务器复制到这个新服务器。有人可以告诉我们如何在不丢失任何数据的情况下再次使用新旧 LDAP 服务器配置这种对等复制吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T12:35:19.747

您可以导出 ldif 文件并将其导入新服务器，或者使用 Tivoli Directory Server (TDI) 在服务器之间移动数据。之后也可以使用 TDI 来保持两个目录服务器同步。

# sql - 将行转为列

> ID：11528545
> 
> 赞同：1
> 
> 时间：2012-07-17T18:22:40.987
> 
> 标签：sql, tsql, sql-server-2005, pivot, unpivot

我正在尝试旋转表格并且遇到了一些困难。我的表架构如下所示：

```
ID  W_C    W_P      A_C   A_P
3   257    251342   217   206078
4   443    109023   332   87437
6   17     9985     32    13515 
```

我想要完成的事情是：

```
 3       4       6
w_c     257     443     17
w_p     251342  109023  9985
a_c     217     332     87437
a_p     206078  87437   13515 
```

我不需要显示`w_c`, `w_p`, `a_c`, 或者`a_p`我只是将它用作参考点。

我认为可能有一种使用 pivot/unpivot 的方法，但我对它们不是很熟悉，而且我读过的内容对我没有帮助。

我尝试使用 CTE 做一些事情，但我认为它过于复杂并且是不好的做法：

```
;with [3_Data] as (
    Select
        1 as [common_key3]
        ,max(Case when [id] = 3 then [w_c] else 0 end) as [3_Records]
    From [example]
), [4_data] as (
Select
        1 as [common_key4]
        ,max(Case when [id] = 4 then [w_c] else 0 end) as [4_Records]
    From [example]
), [6_data] as (
    Select
        1 as [common_key6]
        ,max(Case when [id] = 6 then [w_c] else 0 end) as [6_Records]
    From [example]
)
Select [3_Records], [4_Records], [6_Records]
From [3_Data]
    inner join [4_data] on [common_key3] = [common_key4]
    inner join [6_data] on [common_key3] = [common_key6] 
```

Sql fiddle 已经创建了表：[http ://sqlfiddle.com/#!3/02ef2/6](http://sqlfiddle.com/#!3/02ef2/6)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T18:50:49.093

您可以使用 an[`UNPIVOT`](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)然后 a[`PIVOT`](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)来获得您想要的结果（参见[SQL Fiddle with Demo](http://sqlfiddle.com/#!3/477b6/5)）：

```
select col, [3], [4], [6]
from
(
  select id, value, col
  from
  (
    select id, w_c, w_p, a_c, a_p
    from t
  ) x
  unpivot
  (
    value
    for col in (w_c, w_p, a_c, a_p)
  )u
) x1
pivot
(
  sum(value)
  for id in ([3], [4], [6])
) p 
```

In this query you will first, `UNPIVOT` which will allow you easier access to the data to transform. You can use whatever names you want for the `value` and `col` fields, I just chose that for this example. Once the data is unpivoted, you can then apply a `PIVOT` to get the final product.

# javascript - 静默组在 javascript 正则表达式 match() 中不起作用

> ID：11528548
> 
> 赞同：1
> 
> 时间：2012-07-17T18:22:54.417
> 
> 标签：javascript, regex, match, silent

我正在尝试从标有“@”的字符串中提取（可能连字符）单词。

所以例如从字符串

```
var s = '@moo, @baa and @moo-baa are writing an email to a@bc.de' 
```

我想回来

```
['@moo', '@baa', '@moo-baa'] 
```

为了确保我没有捕获电子邮件地址，我检查了该组前面是否有一个空格字符或行的开头：

```
s.match(/(^|\s)@(\w+[-\w+]*)/g) 
```

这似乎可以解决问题，但它也捕获了我不想要的空间：

```
["@moo", " @baa", " @moo-baa"] 
```

像这样使分组静音

```
s.match(/(?:^|\s)@(\w+[-\w+]*)/g) 
```

似乎不起作用，它返回与以前相同的结果。我也尝试了相反的方法，并检查了该组前面是否没有 \w 或 \S ，但这也排除了该行的开头。我知道我可以简单地修剪空格，但我真的很想通过一个“匹配”调用来完成这个工作。

有人建议我做错了什么吗？非常感谢提前！！

[编辑]

我也刚刚注意到：为什么它也会返回“@”符号？！我的意思是，这就是我想要的，但它为什么要这样做呢？他们不在团体之外，不是吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T23:01:28.713

据我所知，`String.match`使用“g”修饰符时会返回整个匹配项。因为，使用修饰符，您告诉函数匹配整个表达式，而不是从子表达式（组）创建编号匹配。全局匹配不返回组，而是组本身就是匹配项。

在您的情况下，您正在寻找的正则表达式可能是这样的：

```
'@moo, @baa and @moo-baa are writing an email to a@bc.de'.match(/(?!\b)(@[\w\-]+)/g); 
```

您正在寻找每个不遵循单词边界的“@”符号。所以不需要沉默的团体。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T18:28:22.367

如果不想占用空格，就不要放在`\s`括号里面。括号内的任何内容都将作为捕获组的一部分返回。

# database - 我如何知道 DynamoDB 表分布在多少个分区上？

> ID：11528550
> 
> 赞同：20
> 
> 时间：2012-07-17T18:23:02.567
> 
> 标签：database, load-balancing, amazon-dynamodb

Amazon 的 DynamoDB 专为保证性能而设计。客户必须为其每个表提供吞吐量。

为了实现这种性能，表透明地分布在多个“服务器”AKA“分区”上。

亚马逊为我们提供了关于确定和优化吞吐量的[“最佳实践”指南。](http://docs.amazonwebservices.com/amazondynamodb/latest/developerguide/BestPractices.html)在本指南中，我们被告知预配置的**吞吐量平均分配在分区上**。换句话说，如果请求没有均匀地分布在分区上，则只有一*小部分*保留的（和付费的）吞吐量可供应用程序使用。

在**最坏的情况下**，它将是：

```
worst_throughput = provisioned_and_paid_throughput / partitions 
```

要估计这个“worst_throughput”，我需要知道分区的总数。我在哪里可以找到它或如何估算它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T05:27:25.097

它说：“在存储数据时，Amazon DynamoDB 将表的项目划分为多个分区，并主要基于散列键元素分发数据。”

您真正想知道的是单个分区的吞吐量。似乎您可以通过敲击单个键来测试它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-06-05T12:44:41.573

请参阅此页面：[http ://docs.aws.amazon.com/amazondynamodb/latest/developerguide/GuidelinesForTables.html#GuidelinesForTables.Partitions](http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/GuidelinesForTables.html#GuidelinesForTables.Partitions)

您可以根据您提供的读写容量进行一些简单的计算。 *请注意，这仅适用于初始容量。* 随着您继续使用 dynamodb，这些计算的相关性将越来越低。

`A single partition can hold approximately 10 GB of data, and can support a maximum of 3,000 read capacity units or 1,000 write capacity units.`

# checkbox - PHP：使用 php 获取具有不同名称/id 的多个复选框

> ID：11528551
> 
> 赞同：0
> 
> 时间：2012-07-17T18:23:16.310
> 
> 标签：checkbox

我尝试并尝试了四个小时以获取具有不同名称的复选框的值，我真的希望你们能帮助我解决这个问题。提前致谢。这是我的问题：

我有一个表格，其中包含一些问题和备选方案，可以选择哪些问题有自己的 id，每个备选方案也有自己的 id，当然每个备选方案也有一个属于该问题的问题 id。我有一张表用于提问，另一张表用于替代。例如：

1）选择一些方程得到20。（假设这个问题得到question_id = 1）

A）5 * 4（假设这个得到alternative_id = 10）
B）6 * 5（alternative_id = 20）
C）100 /5 (alternative_id = 30)
D) 4*5 （假设这个得到了alternative_id = 40）

当然以上所有的都会有question_id=1

2) 英俊的同义词是什么？（假设这个问题得到 question_id=2）

A）丑陋（假设这个问题得到alternative_id = 40）
B）好看（alternative_id = 60）
C）好看（alternative_id = 7）
D）种类（alternative_id = 5 )

当然，以上所有这些都会有 question_id=2

现在我的问题是如何用他们的问题 ID 获得那些替代 ID 值？

让我们从问题编号 1 => A、C 和 D（表示 id 10、30、40）和问题编号 2 => B 和 C（表示 id、60,7）中进行选择。当我单击提交按钮时，我想获得这些价值，这就是我正在做的事情。

如果我在我的复选框表单中使用它

```
print '<input type="checkbox" name="alternative['.$row_q['question_id'].']" value="'.$row['alternative_id'].'">'.$row['alternative'].'</input>';
<input type="submit" name="submit" value="OK" /> 
```

当我提交时，我使用以下代码：

```
$alt = $_GET['alternative'];
if (isset($_REQUEST['submit'])&& $_REQUEST['submit'] != "")  { 
 if(isset($_GET['alternative'])&& $_GET['alternative'] != ''){ 
foreach($alt AS $key=>$alt3){
    echo $key."-".$alt3."<br>";

} 
```

}

```
} 
```

我得到的是每个问题的最后一个选择。在这种情况下，40 和 7 带有键（question_id's），这意味着 40 是问题 1 中备选方案 D 的 id，而 7 是问题编号 2 中备选方案 C 的 id。

如果我使用没有这样索引的复选框的名称：

```
print '<input type="checkbox" name="alternative[]" value="'.$row['alternative_id'].'">'.$row['alternative'].'</input>'; 
```

然后我把所有选择的id放在一起，就像一堆但没有钥匙（没有question_id）。我的意思是所有问题编号 1 和编号 2 像这样：
10
30
40
60
7
而且很难知道、排序和插入哪个 id 属于哪个问题。我觉得我必须在数组中循环数组，但我真的不知道该怎么做。我怎样才能得到问题每个部分的选择的价值？再次感谢您提前提供的帮助，我希望你们明白我的意思。

=======================

`$alt`是选择的替代 ID 的值。我从中得到它们 `$_GET['alternative'];`，[alternative] 是复选框的名称。

```
<input type="checkbox" name="alternative['.$row_q['question_id'].']" value="'.$row['alternative_id'].'">'.$row['alternative'].'</input> 
```

所以我通过写来获得价值

```
$alt = $_GET['alternative']; in another page.<br> 
```

问题是：

例如，如果我从问题 1 中选择 A, B, C 和从问题 2 中选择 B , C 然后我得到`print_r`这样的结果： `Array ( [1] => 40 [2] => 7 )`，你看我`[1] => 40`从问题 #1 中只得到 C，它的问题 id 作为键，这是最后一个来自问题＃1的一个。我没有从问题 nr 1 中得到 A 和 B 只有 C。我的意思是 [1] 是问题 id 并且 =>40 是alternative_id 但是问题 #1 的最后一个选择的替代方案。我从问题 #2 中得到 C `[2] => 7` ，这是问题 #2 中最后选择的问题 ID。

我的目标是这样的：我的问题表中有一个名为 alt_id 的列。我的问题表如下所示： `Q_id`, `question`,`alt_id`

让我们问一下您选择 A、B 和 C 女巫的替代 id 是 10、30、40 现在我想用 implode() 用逗号收集它们并将它们写为 10、30、40 并将它们放在问题 id 行中的列 alt_id 中编号 1

```
Q_id       question                                            alt_id
1          Chose some equation to get 20                       10,30,40
2          What's a synonym of handsome?                       60,7
3          .................................................   89,6,50,30 
```

我想要他们这样

```
ARRAY([1]=>10,30,40  [2]=>60,7  [3]=>89,6,50,30) 
```

然后我想像这样更新问题表（当然`alt_id`从一开始就是NULL）

```
 foreach($alt AS $key=>$alternativ){
    $query = 'UPDATE question SET alt_id = '.alternative.'  WHERE q_id  = '.$key.' ';
    $result = mysql_query($query);  
    } 
```

所以我的问题是我怎样才能让他们像这样`ARRAY([1]=>10,30,40 [2]=>60,7 [3]=>89,6,50,30 and so on….`

=============第二次更新：==========
为了从我的数据库中获取价值，我使用这个脚本：（我也会向你展示 sourge 页面）：

```
$sql_q = " SELECT * FROM questions WHERE title_id = ".$title_id." "; 
$res_q= mysql_query($sql_q); 
while($row_q = mysql_fetch_array($res_q)){ 
    $q_id = $row_q['q_id']; 
    $sql_a = " SELECT alt_id, alt, q_id FROM ice_alternative WHERE q_id = ".$q_id." "; 
    $res_a = mysql_query($sql_a); 
    while ($row_a = mysql_fetch_array($res_a)){ 
        $alt_id = $row_a['alt_id']; ?> 
        <input type="checkbox" name="alternative[<?=$row_q['q_id']?>]" value="<?=$row_a['alt_id']?>"/><?=$row_a['alt']?></input><br /><br />
        <?php 
        } 
        } 
```

当我看到 sourge 页面时，它向我显示如下：

```
<form action="st_q2.php" name="reply2" method="POST" enctype="multipart/form-data"> 

1) Chose some equation to get 20

<input type="checkbox" name="alternative[1]" value="10"/>5*4</input><br /><br />
<input type="checkbox" name="alternative[1]" value="20"/>6*5</input><br /><br />
<input type="checkbox" name="alternative[1]" value="30"/>100/5</input><br /><br />
<input type="checkbox" name="alternative[1]" value="40"/> 4*5</input><br /><br />
<hr /><br><br><br>

2 ) What's a synonym of handsome?<br><br>    

<input type="checkbox" name="alternative[2]" value="50"/>Ugly</input><br /><br />
<input type="checkbox" name="alternative[2]" value="60"/>Fine-looking</input><br /><br />
<input type="checkbox" name="alternative[2]" value="7"/>Good-looking</input><br /><br />
<input type="checkbox" name="alternative[2]" value="5"/>Kind</input><br /><br />
<hr />      
<input type="submit" name="submit" value="OK" />
  </form> 
```

然后在我的下一页（st_q2.php）中，我编写了这样的代码：

```
$alt = $_POST['alternative'];
if (isset($_REQUEST['submit'])&& $_REQUEST['submit'] != "")  { 
if(isset($_POST['alternative'])&& $_POST['alternative'] != ''){ 
foreach($alt AS $key=>$alternativ){
    $query = 'UPDATE question SET alt_id = '.alternative.'  WHERE q_id  = '.$key.' ';
    $result = mysql_query($query);  
    } 
```

=================第四版============
如果我按照您所说的那样为问题1命名我的所有字段：`name="alternative[1][]"` 那么我得到

```
1) Chose some equation to get 20

<input type="checkbox" name="alternative[1][]" value="10"/>5*4</input> 
<input type="checkbox" name="alternative[1][]" value="20"/>6*5</input> 
<input type="checkbox" name="alternative[1][]" value="30"/>100/5</input> 
<input type="checkbox" name="alternative[1][]" value="40"/> 4*5</input>  
<hr /><br><br><br>

2 ) What's a synonym of handsome?<br><br>    

<input type="checkbox" name="alternative[1][]" value="50"/>Ugly</input> 
<input type="checkbox" name="alternative[1][]" value="60"/>Fine-looking</input> 
<input type="checkbox" name="alternative[1][]" value="7"/>Good-looking</input> 
<input type="checkbox" name="alternative[1][]" value="5"/>Kind</input> 
<hr />      
<input type="submit" name="submit" value="OK" />
  </form> 
```

如果我为我的所有字段命名，`name="alternative[<?=$row_q['q_id']?>][]"` 那么我得到

```
<input type="checkbox" name="alternative[1][]" value="10"/>5*4</input> 
<input type="checkbox" name="alternative[1][]" value="20"/>6*5</input> 
<input type="checkbox" name="alternative[1][]" value="30"/>100/5</input> 
<input type="checkbox" name="alternative[1][]" value="40"/> 4*5</input>  
<hr /><br><br><br>

2 ) What's a synonym of handsome?<br><br>    

<input type="checkbox" name="alternative[2][]" value="50"/>Ugly</input> 
<input type="checkbox" name="alternative[2][]" value="60"/>Fine-looking</input> 
<input type="checkbox" name="alternative[2][]" value="7"/>Good-looking</input> 
<input type="checkbox" name="alternative[2][]" value="5"/>Kind</input> 
```

如果我为我的所有字段命名，`name="alternative[<?=$row_q['q_id']?>][<?=$row_a['alt_id']?>]"` 那么我得到

```
<input type="checkbox" name="alternative[1][10]" value="10"/>5*4</input> 
<input type="checkbox" name="alternative[1][20]" value="20"/>6*5</input> 
<input type="checkbox" name="alternative[1][30]" value="30"/>100/5</input> 
<input type="checkbox" name="alternative[1][40]" value="40"/> 4*5</input>  
<hr /><br><br><br>

2 ) What's a synonym of handsome?<br><br>    

<input type="checkbox" name="alternative[2][50]" value="50"/>Ugly</input> 
<input type="checkbox" name="alternative[2][60]" value="60"/>Fine-looking</input> 
<input type="checkbox" name="alternative[2][7]" value="7"/>Good-looking</input> 
<input type="checkbox" name="alternative[2][5]" value="5"/>Kind</input> 
```

但是我仍然无法得到它们，`ARRAY([1]=>10,30,40 [2]=>60,7 [3]=>89,6,50,30)` 即使我在里面运行 SELECTION`foreach loop with implode(','$_POST['alternative'])` 我想要的是更新问题表中的列 alt_id 。从一开始就是这样的问题表：
Q_id question alt_id
1 选择一些方程得到 20 Null
2 帅的同义词是什么？空
3 ............................................. 。 空值                

但是在更新之后，我希望它看起来像下面这样：

Q_id question alt_id
1 选择一些方程得到 20 10,30,40
2 帅的同义词是什么？60,7
3 .................................................. ... 89,6,50,30                 

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T05:58:30.920

问题是给定问题的所有替代字段都具有相同的名称，因此只有最后一个字段被传递到下一页。要正确使用数组表示法，请为问题 1 命名所有字段`<input type="text" name="alternative[1][]">`。然后在`$_POST`下一页的数组中，`alternative`将是一个数组，其中 element`1`是一个包含您为问题 1 提交的每个选项的数组。

然后，您将使用以下内容迭代 $_POST['alternative']：

```
foreach($_POST['alternative'] as $qid => $question) {
    foreach($question as $altnum => $alternative) {
        // deal with alternatives here
        // using $qid for question ID and $altnum for alternative number
    }
} 
```

# ruby-on-rails - Rails：恢复使用 to_json 编码的 ActiveRecord 对象

> ID：11528552
> 
> 赞同：2
> 
> 时间：2012-07-17T18:23:27.180
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

我有一个名为 Account 的模型，具有以下关联：

```
has_many :contracts, :dependent => :destroy
has_many :packages, :dependent => :destroy

accepts_nested_attributes_for :contracts
accepts_nested_attributes_for :packages 
```

在销毁任何 Account 对象之前，我将其保存在带有 to_json 的文件中：

```
@account.to_json(:include => [:packages, :contracts]) 
```

美好的。当我尝试恢复它时会出现问题（在另一个脚本上）：

```
account_data = JSON.parse json
@account = Account.new account_data 
```

这引发了一个异常：

```
Package(#70193553579560) expected, got Hash(#70193548333800) 
```

为什么会发生这种情况？在这种情况下，Rails 不应该接受哈希吗？

在我执行@account.save 之后，我是否必须从哈希中删除合同和包密钥并插入它们？我正在寻找一种更清洁的方法来处理这个问题:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-02-08T20:13:20.553

看看输出`@account.to_json(:include => [:packages, :contracts])`。它将关联序列化为 JSON，因此您最终会得到以下内容：

```
{"id":10, packages:[{id:5,description:"Package1"}], contracts:[]} 
```

当您尝试重新加载 JSON 时，它正在尝试执行以下操作：

```
account.packages = [{id:5,description:"Package1"}] 
```

这不起作用，因为 account.packages 是一个关联，您不能直接使用 Hash 构建它。但是，您可以将 Hash 作为嵌套属性传递：

```
account.packages_attributes = [{id:5,description:"Package1"}] 
```

`packages_attributes`是由`accepts_nested_attributes_for`模型中已有的类方法定义的方法。

这不会很好地与`to_json`. 但是，ActiveRecord 也有一种`from_json`方法，旨在很好地播放`to_json`

# php - 团队日程的 MySQL 查询

> ID：11528554
> 
> 赞同：1
> 
> 时间：2012-07-17T18:23:29.367
> 
> 标签：php, mysql

我正在尝试根据下表检索每个团队的日程安排，但在显示团队名称时遇到了一些问题。这是我的表：

团队（team_id、team_name、team_mascot 等）

游戏（game_id、game_date、game_home_team、game_visitor_team、game_home_score、game_visitor_score、game_complete）

这是我当前的查询。我可以通过这个获得团队的 id 值，但我需要团队名称，因为 id 值对我没有多大好处。

```
SELECT game_home_team, game_visitor_team, game_date
FROM game 
INNER JOIN team home ON home.team_id = game_home_team 
INNER JOIN team visitor ON visitor.team_id = game_visitor_team
WHERE game_home_team = ? 
OR game_visitor_team = 6 
ORDER BY game_date ASC; 
```

如何使用此查询检索球队名称，并根据比赛得分显示 W 或 L 等结果？提前非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T18:27:22.637

```
SELECT
   home.team_name AS home_team,
   visitor.team_name AS visitor_team,
   game_date,
   IF(
      game_home_score = game_visitor_score, 
      'Tie', 
      IF(
         game_home_score > game_visitor_score,
         'Hometeam',
         'Visitorteam'
      )
   ) AS Winner
FROM game 
INNER JOIN team home ON home.team_id = game_home_team 
INNER JOIN team visitor ON visitor.team_id = game_visitor_team
WHERE game_home_team = ? 
OR game_visitor_team = 6 
ORDER BY game_date ASC; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T18:27:54.900

```
select game_home_team, home.team_name AS homename,
    game_visitor_team, visitor.team_name AS visitorname
etc... 
```

# javascript - 上传文件大小限制为 32kB，并且我收到“CGI.pm: Server closed socket during multipart read (client aborted?)”错误。

> ID：11528555
> 
> 赞同：2
> 
> 时间：2012-07-17T18:23:29.913
> 
> 标签：javascript, html, perl, cgi

我正在尝试上传文件，使用的服务器端语言是 Perl。CGI 模块版本为 3.15

出于某种奇怪的原因，我可以上传任何低于 32KB 的文件，但超出该文件大小，我收到以下错误：

`CGI.pm: Server closed socket during multipart read (client aborted?).`

我尝试为 CGI 设置以下参数

`use CGI ':standard';`

`$CGI::POST_MAX=-1;`

`$CGI::DISABLE_UPLOADS=0; # Allow file upload`

但我仍然收到错误。

听说这个问题在较新版本的 CGI 中修复了，但是我无法升级 CGI 模块，是否有替代方案？

**欢迎任何想法！**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-09-21T11:39:55.723

我看到你正在设置`$CGI::POST_MAX = 1`，这是 1 个字节。

尝试增加它：`1024 * 100`.

从[文档](http://search.cpan.org/~lds/CGI.pm-3.39/CGI.pm)：

> > > `$CGI::POST_MAX`
> > > 
> > > 如果设置为非负整数，此变量会设置 POSTing 大小的上限，以字节为单位。如果 CGI.pm 检测到大于上限的 POST，它将立即退出并显示错误消息。此值将影响普通 POST 和多部分 POST，这意味着它也限制了文件上传的最大大小。您应该将其设置为相当高的值，例如 1 兆字节。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-17T23:51:28.703

您的问题的关键似乎在这里：

`CGI.pm: Server closed socket during multipart read (client aborted?).`

错误消息似乎表明您的服务器正在关闭连接。如果您使用的是 Apache、nginx 等，请检查它们的配置设置以增加最大发布请求正文大小。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-07-17T18:25:01.467

阅读 CGI.pm 的整个文档，即使它很长。某处有一个 sub 设置文件上传的安全最大值。这是为了让您的服务器更能抵抗 DDOS。只需设置您喜欢的值。这将解决问题的 32kB 部分......

（很抱歉，这个疯狂的猜测没有解决任何问题。考虑删除这个答案。）

# c++ - 使用 QSqlTableModel 显示 SQL 视图

> ID：11528557
> 
> 赞同：0
> 
> 时间：2012-07-17T18:23:36.260
> 
> 标签：c++, database, qt, model-view-controller

我正在开发一个应用程序，该应用程序具有一个视图，该视图生成一个报告以显示给用户。这份报告是我需要过滤的东西。使用 Qt 中的 SQL 支持我尝试使用具有过滤功能的 QSqlTableModel，但它似乎没有找到视图，因为我收到错误“无法找到表 TABLE_NAME”。如何在 Qt 中为视图建模？我无法找到任何具体的信息。

```
QSqlDatabase connection(Request_Connection("DB Name"));
QSqlTableModel* pStore(new QSqlTableModel(NULL, connection));

if (connect(connection))
    pStore->setTable("ViewName"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T18:25:44.680

如果您遇到错误“无法找到表 TABLE_NAME”，这仅表示您正在尝试从不存在的表中获取数据。检查您的数据库。

编辑

好吧，你所做的很奇怪。它应该更像这样：

```
QSqlDatabase db = QSqlDatabase::addDatabase("QMYSQL");
db.setHostName("localhost");
db.setDatabaseName("customdb");
db.setUserName("root");
db.setPassword("root");
if(!db.open())
    QMessageBox::information(this, "Error", "Couldn't open database!"); 
```

那是开放数据库。在第一个引号中，您有一个您使用的 sql 名称。[在这里](http://qt-project.org/doc/qt-4.8/qsqldatabase.html#QSqlDatabase)您可以找到所有可用的 sql 插件。当您连接到数据库时，您可以读取一些数据。如果你想为此使用 QSqlTableModel，你可以这样做：

```
QSqlTableModel *model = new QSqlTableModel(parentObject, db);
model->setTable("employee");
model->setEditStrategy(QSqlTableModel::OnManualSubmit);
model->select();
model->setHeaderData(0, Qt::Horizontal, tr("Name"));
model->setHeaderData(1, Qt::Horizontal, tr("Salary"));

QTableView *view = new QTableView;
view->setModel(model);
view->hideColumn(0); // don't show the ID
view->show(); 
```

这个简单的例子将从'employee'表中加载'Name'和'Salary'列，并将其显示在'view' QTableView中。这就是你应该这样做的方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-10T01:12:56.527

我的建议：

1.  检查您的数据库名称。
2.  我发现这个网站有助于更好地理解 QSqlTableModel [http://harmattan-dev.nokia.com/docs/library/html/qt4/qsqltablemodel.html](http://harmattan-dev.nokia.com/docs/library/html/qt4/qsqltablemodel.html)

# php - 在联系表格中正确设置电子邮件

> ID：11528558
> 
> 赞同：-3
> 
> 时间：2012-07-17T18:23:39.700
> 
> 标签：php, email, field, contact-form, sender

考虑到我在 PHP 方面的经验有限，我使用了一个联系表单生成器，它几乎可以按照我的意愿工作。该表单及其所有变量都可以正常运行，但是在收到电子邮件后，它会将我自己的域添加为发件人的电子邮件。我想让完成联系表单电子邮件的人作为发件人，以便我可以轻松地回复邮件（而不是从邮件中复制和粘贴电子邮件地址）。

以下是部分代码：

```
<?php

$where_form_is="http://".$_SERVER['SERVER_NAME'].strrev(strstr(strrev($_SERVER['PHP_SELF']),"/"));

session_start();
if( ($_SESSION['security_code']==$_POST['security_code']) && (!empty($_POST['security_code'])) ) { 
// Checkbox handling
$field_4_opts = $_POST['field_4'][0].",". $_POST['field_4'][1].",". $_POST['field_4'][2];

// Checkbox handling
$field_5_opts = $_POST['field_5'][0].",". $_POST['field_5'][1].",". $_POST['field_5'][2].",". $_POST['field_5'][3];

mail("mail@mail.com","phpFormGenerator - Form submission","Form data:

Your Name:: " . $_POST['field_1'] . " 
Country:: " . $_POST['field_2'] . " 
Your Email:: " . $_POST['field_3'] . " 
Your areas of interest:: $field_4_opts
What type of articles are you interested in writing?:: $field_5_opts
Any other types of articles that interest you?:: " . $_POST['field_6'] . " 
Approximately how often will you contribute?: " . $_POST['field_7'] . " 
Your blog/website:: " . $_POST['field_8'] . " 
What would make you a good contributor?: " . $_POST['field_9'] . " 

 powered by phpFormGenerator.
");

include("confirm.html");
}
else {
echo "Invalid Captcha String.";
}

?> 
```

安装.php

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
    <title>testing2 - created by phpFormGenerator</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"><link href="style.css" rel="stylesheet" type="text/css">
    <!-- calendar stuff -->
          <link rel="stylesheet" type="text/css" href="calendar/calendar-blue2.css" />
          <script type="text/javascript" src="calendar/calendar.js"></script>
          <script type="text/javascript" src="calendar/calendar-en.js"></script>
          <script type="text/javascript" src="calendar/calendar-setup.js"></script>
    <!-- END calendar stuff -->

    <!-- expand/collapse function -->
    <SCRIPT type=text/javascript>
    <!--
    function collapseElem(obj)
    {
        var el = document.getElementById(obj);
        el.style.display = 'none';
    }

    function expandElem(obj)
    {
        var el = document.getElementById(obj);
        el.style.display = '';
    }

    //-->
    </SCRIPT>
    <!-- expand/collapse function -->

    <!-- expand/collapse function -->
        <SCRIPT type=text/javascript>
        <!--

        // collapse all elements, except the first one
        function collapseAll()
        {
            var numFormPages = 1;

            for(i=2; i <= numFormPages; i++)
            {
                currPageId = ('mainForm_' + i);
                collapseElem(currPageId);
            }
        }

        //-->
        </SCRIPT>
    <!-- expand/collapse function -->

     <!-- validate -->
    <SCRIPT type=text/javascript>
    <!--
        function validateField(fieldId, fieldBoxId, fieldType, required)
        {
            fieldBox = document.getElementById(fieldBoxId);
            fieldObj = document.getElementById(fieldId);

            if(fieldType == 'text'  ||  fieldType == 'textarea'  ||  fieldType == 'password'  ||  fieldType == 'file'  ||  fieldType == 'phone'  || fieldType == 'website')
            {   
                if(required == 1 && fieldObj.value == '')
                {
                    fieldObj.setAttribute("class","mainFormError");
                    fieldObj.setAttribute("className","mainFormError");
                    fieldObj.focus();
                    return false;                   
                }

            }

            else if(fieldType == 'menu'  || fieldType == 'country'  || fieldType == 'state')
            {   
                if(required == 1 && fieldObj.selectedIndex == 0)
                {               
                    fieldObj.setAttribute("class","mainFormError");
                    fieldObj.setAttribute("className","mainFormError");
                    fieldObj.focus();
                    return false;                   
                }

            }

            else if(fieldType == 'email')
            {   
                if((required == 1 && fieldObj.value=='')  ||  (fieldObj.value!=''  && !validate_email(fieldObj.value)))
                {               
                    fieldObj.setAttribute("class","mainFormError");
                    fieldObj.setAttribute("className","mainFormError");
                    fieldObj.focus();
                    return false;                   
                }

            }

        }

        function validate_email(emailStr)
        {       
            apos=emailStr.indexOf("@");
            dotpos=emailStr.lastIndexOf(".");

            if (apos<1||dotpos-apos<2) 
            {
                return false;
            }
            else
            {
                return true;
            }
        }

        function validateDate(fieldId, fieldBoxId, fieldType, required,  minDateStr, maxDateStr)
        {
            retValue = true;

            fieldBox = document.getElementById(fieldBoxId);
            fieldObj = document.getElementById(fieldId);    
            dateStr = fieldObj.value;

            if(required == 0  && dateStr == '')
            {
                return true;
            }

            if(dateStr.charAt(2) != '/'  || dateStr.charAt(5) != '/' || dateStr.length != 10)
            {
                retValue = false;
            }   

            else    // format's okay; check max, min
            {
                currDays = parseInt(dateStr.substr(0,2),10) + parseInt(dateStr.substr(3,2),10)*30  + parseInt(dateStr.substr(6,4),10)*365;
                //alert(currDays);

                if(maxDateStr != '')
                {
                    maxDays = parseInt(maxDateStr.substr(0,2),10) + parseInt(maxDateStr.substr(3,2),10)*30  + parseInt(maxDateStr.substr(6,4),10)*365;
                    //alert(maxDays);
                    if(currDays > maxDays)
                        retValue = false;
                }

                if(minDateStr != '')
                {
                    minDays = parseInt(minDateStr.substr(0,2),10) + parseInt(minDateStr.substr(3,2),10)*30  + parseInt(minDateStr.substr(6,4),10)*365;
                    //alert(minDays);
                    if(currDays < minDays)
                        retValue = false;
                }
            }

            if(retValue == false)
            {
                fieldObj.setAttribute("class","mainFormError");
                fieldObj.setAttribute("className","mainFormError");
                fieldObj.focus();
                return false;
            }
        }
    //-->
    </SCRIPT>
    <!-- end validate -->

</head>

<body onLoad="collapseAll()">

<div id="mainForm">

    <div id="formHeader">
            <h2 class="formInfo">testing2</h2>
            <p class="formInfo"></p>
    </div>

    <BR/><div id="footer"><p class="footer"><a class=footer href=http://phpformgen.sourceforge.net>Generated by phpFormGenerator</a></p></div>

</body>
</html> 
```

你能找到我需要改变的地方吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:27:43.880

在 PHP 中调用[mail函数之前添加相关的标头。](http://php.net/manual/en/function.mail.php)

```
 $headers = 'From: user@example.com' . "\r\n" .
    'Reply-To: user@example.com' . "\r\n";

mail($to, $subject, $message, $headers); 
```

**在你的情况下：**

```
<?php

$where_form_is="http://".$_SERVER['SERVER_NAME'].strrev(strstr(strrev($_SERVER['PHP_SELF']),"/"));

session_start();
if( ($_SESSION['security_code']==$_POST['security_code']) && (!empty($_POST['security_code'])) ) { 
// Checkbox handling
$field_4_opts = $_POST['field_4'][0].",". $_POST['field_4'][1].",". $_POST['field_4'][2];

// Checkbox handling
$field_5_opts = $_POST['field_5'][0].",". $_POST['field_5'][1].",". $_POST['field_5'][2].",". $_POST['field_5'][3];

$message = "Form data:
        Your Name:: " . $_POST['field_1'] . " 
        Country:: " . $_POST['field_2'] . " 
        Your Email:: " . $_POST['field_3'] . " 
        Your areas of interest:: $field_4_opts
        What type of articles are you interested in writing?:: $field_5_opts
        Any other types of articles that interest you?:: " . $_POST['field_6'] . " 
        Approximately how often will you contribute?: " . $_POST['field_7'] . " 
        Your blog/website:: " . $_POST['field_8'] . " 
        What would make you a good contributor?: " . $_POST['field_9'] . " 

         powered by phpFormGenerator.
        ";

     $headers = 'From: '.$_POST['field_3']. "\r\n" .
            'Reply-To: '.$_POST['field_3'] . "\r\n" .
            'X-Mailer: PHP/' . phpversion();

      mail("mail@mail.com","phpFormGenerator - Form submission", $message, $headers);

include("confirm.html");
}
else {
echo "Invalid Captcha String.";
}

?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T18:28:46.060

你应该去学习PHP，自动生成的表单代码太糟糕了。

```
<?php

$where_form_is="http://".$_SERVER['SERVER_NAME'].strrev(strstr(strrev($_SERVER['PHP_SELF']),"/"));

session_start();
if( ($_SESSION['security_code']==$_POST['security_code']) && (!empty($_POST['security_code'])) ) { 
// Checkbox handling
$field_4_opts = $_POST['field_4'][0].",". $_POST['field_4'][1].",". $_POST['field_4'][2];

// Checkbox handling
$field_5_opts = $_POST['field_5'][0].",". $_POST['field_5'][1].",". $_POST['field_5'][2].",". $_POST['field_5'][3];

mail("mail@mail.com","phpFormGenerator - Form submission","Form data:

Your Name:: " . $_POST['field_1'] . " 
Country:: " . $_POST['field_2'] . " 
Your Email:: " . $_POST['field_3'] . " 
Your areas of interest:: $field_4_opts
What type of articles are you interested in writing?:: $field_5_opts
Any other types of articles that interest you?:: " . $_POST['field_6'] . " 
Approximately how often will you contribute?: " . $_POST['field_7'] . " 
Your blog/website:: " . $_POST['field_8'] . " 
What would make you a good contributor?: " . $_POST['field_9'] . " 

 powered by phpFormGenerator.
", 'From: ' . $_POST['field_3']);

include("confirm.html");
}
else {
echo "Invalid Captcha String.";
}

?> 
```

我在 mail() 函数中添加了一个新参数，用于设置 from 标头。`, 'From: ' . $_POST['field_3']`是我添加的。看来 field_3 应该包含用户的电子邮件。试试看它是否有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T18:40:21.857

只需让您的代码看起来很漂亮，并为其添加一些标头。它会完成您的工作使用标头，您可以做任何您可以使用电子邮件客户端（如 GMAIL）做的事情。（附加文件或其他任何内容）

```
<pre> 

$headers =  'From: abc@example.com' . "\r\n" .
            'Reply-To: def@example.com' . "\r\n" .
            'X-Mailer: PHP/' . phpversion();

$message = "Form data:
    Your Name:: " . $_POST['field_1'] . " 
    Country:: " . $_POST['field_2'] . " 
    Your Email:: " . $_POST['field_3'] . " 
    Your areas of interest:: $field_4_opts
    What type of articles are you interested in writing?:: $field_5_opts
    Any other types of articles that interest you?:: " . $_POST['field_6'] . " 
    Approximately how often will you contribute?: " . $_POST['field_7'] . " 
    Your blog/website:: " . $_POST['field_8'] . " 
    What would make you a good contributor?: " . $_POST['field_9'] . " 

     powered by phpFormGenerator.
    ";
 $subject = "phpFormGenerator - Form submission"
 $to = "mail@mail.com"

  mail($to ,$subject,$message, $headers); 
```

# jquery - 使用 jQuery 突出显示表格行背景颜色

> ID：11528560
> 
> 赞同：0
> 
> 时间：2012-07-17T18:23:50.100
> 
> 标签：jquery, jquery-ui, background, html-table, highlight

我正在使用 jQuery 1.7.2 和 jQuery UI 1.8.21。我想突出显示表中的特定行，但这似乎不起作用：

```
<script language="javascript" type="text/javascript">   
$(document).ready(function() {      
     $('#tr635').effect("highlight", {}, 3000); 
});
</script> 
```

`#tr635`是我想强调的 tr 的 id。我究竟做错了什么？

编辑：

表格的 HTML 代码：

```
<table width="100%">
  <tr>
    <td colspan="8" class="title">Prioritize Liabilities</td>
  </tr>
  <tr>
    <td class="info">Note</td>
    <td class="info">Balance</td>
    <td class="info">Total Debt</td>
    <td class="info">Total Loss<br />Given Default</td>
    <td class="info">% Loss<br />Guarantee</td>
    <td class="info">Total Loss<br />After Guarantee</td>
    <td class="info">% Loss</td>
    <td class="info">Note LGD</td>
  </tr>
  <tr id="tr632">
    <td><em>GGA 01</em></td>
    <td>5,000</td>
    <td>5,000</td>
    <td>0</td>
    <td>0%</td>
    <td>0</td>
    <td>0.00%</td>
    <td>D</td>
  </tr>
  ...more rows...
</table> 
```

编辑2：我找到了答案。在我的表格的 CSS 中，我为表格中的 td 标签指定了背景颜色。我删除了它并在 tr 标签中设置了背景颜色。现在它起作用了。看起来 td 标签的 CSS 覆盖了 jQuery。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:44:27.160

你包括UI了吗？这是我看到的唯一区别：[jsFiddle 示例（单击打开/关闭 UI 包含）](http://jsfiddle.net/geF9y/1/)这将与可行的事实保持一致`fadein`......因为`fadein`它包含在主 jquery 库中，而`.effect`它是一个 UI 组件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:58:49.237

我找到了答案。在我的表格的 CSS 中，我为表格中的 td 标签指定了背景颜色。我删除了它并在 tr 标签中设置了背景颜色。现在它起作用了。看起来 td 标签的 CSS 覆盖了 jQuery。

# c++ - 如何访问 OpenCV 图像的所有通道

> ID：11528562
> 
> 赞同：2
> 
> 时间：2012-07-17T18:24:12.183
> 
> 标签：c++, image, opencv

我有一个这样创建的 OpenCV 图像：

```
cv::Mat img(XN_VGA_Y_RES, XN_VGA_X_RES, CV_64FC3, cv::Scalar(0)); 
```

如何访问其所有像素？

我试过：

```
for (int x=0; x < XN_VGA_X_RES; x++) {
    for (int y=0; y < XN_VGA_Y_RES; y++) {
        img.at<double>(y,x) = 1;
    }
} 
```

但是，当我这样做时，只有 1/3 的图像是白色的。我猜这是因为我的图像中有 3 个通道，但是我怎样才能访问它们呢？我尝试了各种类似的东西`img.at<double[3]>(y,x)`or `img.at<cv::Vec3f>(y,x)`，但它们似乎不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T18:29:49.323

试试这个：

```
img.at<cv::Vec3d>(y, x)[0] = 1;
img.at<cv::Vec3d>(y, x)[1] = 1;
img.at<cv::Vec3d>(y, x)[2] = 1; 
```

# java - 如何使用自定义值重新调整 png 文件的宽度和高度？

> ID：11528564
> 
> 赞同：1
> 
> 时间：2012-07-17T18:24:25.403
> 
> 标签：java, swing

我正在加载一个 png 格式的按钮图片。但是格式太大了。如何将其宽度和高度调整到定义的范围，但避免使用图像大小。

*前：*

```
 public JButton createButton(String name, String toolTip) {
    Image a = null;
    try {
      a = ImageIO.read((InputStream) Test.class.getResourceAsStream("/image/menu/" + name + ".png"));
    } catch (IOException ex) {
      ex.printStackTrace();
    }

    ImageIcon iconRollover = new ImageIcon(a);        
    int w = iconRollover.getIconWidth();
    int h = iconRollover.getIconHeight();

    // get the cursor for this button
    Cursor cursor =
            Cursor.getPredefinedCursor(Cursor.HAND_CURSOR);

    // make translucent default image
    //Image image = screen.createCompatibleImage(w, h, Transparency.TRANSLUCENT);
    Graphics2D g = (Graphics2D) a.getGraphics();
    Composite alpha = AlphaComposite.getInstance(
            AlphaComposite.SRC_OVER, .5f);
    g.setComposite(alpha);
    g.drawImage(iconRollover.getImage(), 0, 0, null);
    g.dispose();

    ImageIcon iconDefault = new ImageIcon(a);
    ImageIcon iconPressed = new ImageIcon(a);

    // create the button
    JButton button = new JButton();
    button.setIgnoreRepaint(true);
    button.setFocusable(false);
    button.setToolTipText(toolTip);
    button.setBorder(null);
    button.setContentAreaFilled(false);
    button.setCursor(cursor);
    button.setIcon(iconDefault);
    button.setRolloverIcon(iconRollover);
    button.setPressedIcon(iconPressed);
    return button;
  } 
```

*后：*

**跟进：**

```
 public JButton createButton(String name, String toolTip) {

    // Create image
    BufferedImage a = null;
    try {
      a = ImageIO.read((InputStream) P2P.class.getResourceAsStream("/image/menu/" + name + ".png"));
    } catch (IOException ex) {
      ex.printStackTrace();
    }
    BufferedImage bi = new BufferedImage(70, 70, BufferedImage.TRANSLUCENT);

    Graphics2D g = (Graphics2D) bi.getGraphics();
g.setRenderingHint(RenderingHints.KEY_INTERPOLATION, RenderingHints.VALUE_INTERPOLATION_BILINEAR);
    g.drawImage(a, 0, 0, 70, 70, null);
    g.dispose();   
    // get the cursor for this button
    Cursor cursor =
            Cursor.getPredefinedCursor(Cursor.HAND_CURSOR);
    ImageIcon iconRollover = new ImageIcon(bi);
    ImageIcon iconDefault = new ImageIcon(bi);
    ImageIcon iconPressed = new ImageIcon(bi);

    // create the button
    JButton button = new JButton();
    //button.addActionListener(this);
    button.setIgnoreRepaint(true);
    button.setFocusable(false);
    button.setToolTipText(toolTip);
    button.setBorder(null);
    button.setContentAreaFilled(false);
    button.setCursor(cursor);
    button.setIcon(iconDefault);
    button.setRolloverIcon(iconRollover);
    button.setPressedIcon(iconPressed);
    return button;
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:28:10.457

为什么不在`getScaledInstance()`您的 Image 实例上使用该方法，如下所示：

```
import java.awt.BorderLayout;
import java.awt.Graphics;
import java.awt.Image;
import java.awt.Toolkit;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;

static int width=300;//change this to your wanted size
static int height =500;

public class Main extends JFrame implements ActionListener {
  Image img;

  JButton getPictureButton  = new JButton("Get Picture");

  public static void main(String[] args) {
    new Main();
  }

  public Main() {
    this.setSize(600, 600);
    this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    JPanel picPanel = new PicturePanel();
    this.add(picPanel, BorderLayout.CENTER);

    JPanel buttonPanel = new JPanel();
    getPictureButton.addActionListener(this);
    buttonPanel.add(getPictureButton);
    this.add(buttonPanel, BorderLayout.SOUTH);

    this.setVisible(true);
  }

  public void actionPerformed(ActionEvent e) {
    String file = "a.png";
    if (file != null) {
      Toolkit kit = Toolkit.getDefaultToolkit();
      img = kit.getImage(file);

      img = img.getScaledInstance(width, height, Image.SCALE_SMOOTH);//scale the image to wanted size

      this.repaint();
    }
  }
  class PicturePanel extends JPanel {
    public void paintComponent(Graphics g) {
      g.drawImage(img, 0, 0, this);
    }
  }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-01T00:39:13.867

```
/** 
 * @param img image (Image or ImageIcon)
 * @param w the width of the returned image 
 * @param h the height of the returned image 
 * @param imgW the width of the graphics in the returned image 
 * @param imgH the height of the graphics in the returned image 
 * @return ImageIcon
*/
public static ImageIcon resizeImage(Object img, Integer w, Integer h, Integer imgW, Integer imgH) {
    Image image = objectToImage(img);
    if(w == null)
        w=image.getWidth(null);
    if(h == null)
        h=image.getHeight(null);
    if(imgW == null) 
        imgW=w;
    else if(imgH == null)
        imgH=imgW;
    if(imgH == null)
        imgH=h;

    BufferedImage resizedImage = new BufferedImage(w, h, BufferedImage.TYPE_INT_ARGB);
    Graphics2D g2d = resizedImage.createGraphics();
    g2d.setRenderingHint(RenderingHints.KEY_INTERPOLATION, RenderingHints.VALUE_INTERPOLATION_BILINEAR);
    g2d.drawImage(toBufferedImage(image), (w-imgW)/2, (h-imgH)/2, imgW, imgH, null);
    g2d.dispose();
    return new ImageIcon(resizedImage);
}

public static Image objectToImage(Object img) {
    if(img instanceof ImageIcon)
        return ((ImageIcon)img).getImage();
    else if(img instanceof Image)
        return (Image)img;
    else
        throw new ClassCastException();
}

public static BufferedImage toBufferedImage(Image img) { 
    BufferedImage bi = new BufferedImage(img.getWidth(null), img.getHeight(null), BufferedImage.TYPE_INT_ARGB);
    Graphics2D g2d = bi.createGraphics();
    g2d.drawImage(img, 0, 0, null);
    g2d.dispose();
    return bi;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T12:29:29.993

作品

```
 public JButton createButton(String name, String toolTip) {

    // Create image
    BufferedImage a = null;
    try {
      a = ImageIO.read((InputStream) P2P.class.getResourceAsStream("/image/menu/" + name + ".png"));
    } catch (IOException ex) {
      ex.printStackTrace();
    }
    BufferedImage bi = new BufferedImage(70, 70, BufferedImage.TRANSLUCENT);

    Graphics2D g = (Graphics2D) bi.getGraphics();
g.setRenderingHint(RenderingHints.KEY_INTERPOLATION, RenderingHints.VALUE_INTERPOLATION_BILINEAR);
    g.drawImage(a, 0, 0, 70, 70, null);
    g.dispose();   
    // get the cursor for this button
    Cursor cursor =
            Cursor.getPredefinedCursor(Cursor.HAND_CURSOR);
    ImageIcon iconRollover = new ImageIcon(bi);
    ImageIcon iconDefault = new ImageIcon(bi);
    ImageIcon iconPressed = new ImageIcon(bi);

    // create the button
    JButton button = new JButton();
    //button.addActionListener(this);
    button.setIgnoreRepaint(true);
    button.setFocusable(false);
    button.setToolTipText(toolTip);
    button.setBorder(null);
    button.setContentAreaFilled(false);
    button.setCursor(cursor);
    button.setIcon(iconDefault);
    button.setRolloverIcon(iconRollover);
    button.setPressedIcon(iconPressed);
    return button;
  } 
```

# javascript - String.search() vs String.split() 和 JavaScript 中的迭代

> ID：11528565
> 
> 赞同：0
> 
> 时间：2012-07-17T18:24:26.507
> 
> 标签：javascript, performance, search, split, loops

假设我有一串水果名称

```
var string = "cherries,oranges,limes" 
```

和一串红色水果

```
var array = ["tomatoes", "cherries", "raspberries"] 
```

在javascript中，如果我想查找字符串是否有任何红色水果，我可以

```
for(var i=0; i<array.length; i+=1){
    if(string.search(array[i])!=-1){
        return string.search(array[i]);

} 
```

这与以下相比如何？

```
var string_array= string.split(','); 
for(var i=0; i<array.length; i+=1){
    for(var j=0; j<string_array.length; j+=1){
       if(string_array[j]==array[i]){
       return string_array[j];
       }
}
}
return -1; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:29:10.990

这行不通；

```
for(var i=0; i<array.length; i+=1){
   return string.search(array[i]);
} 
```

您将在第一次迭代时返回。

因此，这不会很好地比较。

顺便说一句，如果您对脚本性能比较感兴趣，我建议您尝试使用[jsperf](http://jsperf.com/)。

# ms-access - 多个查询作为单一表单的记录源？

> ID：11528566
> 
> 赞同：1
> 
> 时间：2012-07-17T18:24:29.350
> 
> 标签：ms-access

我又回来了另一个问题。我有一个基于查询的表单，其中 WHERE 子句中的参数是表单的组合框。在详细信息中，它是连续的表单视图，并显示组合框的所有匹配字段（更新组合框后重新查询）。页脚有一个文本框和一个按钮，用户可以在其中为此数据添加新条目。

我基本上需要在它旁边放一个这种形式的镜子——这样它们就可以在视觉上进行比较。我需要在我的标题中并排放置两个组合框——在详细信息部分中有两个控件，这些控件是根据查询填充的。我考虑过使用子表单来基本上创造这种错觉，但我不能拥有具有连续表单视图的子表单。我的想法是有两个查询作为表单的记录源：

```
Select value FROM t1 WHERE criteria = me.combo1;
select value as val2 from t1 WHERE criteria = me.combo2; 
```

**示例数据（相同结构）：**

```
 **Friends**
    **User            friend**
  Bob              Jack
  Bob              Zach
  Bob              Mack
  John             Juan
  John             Sha'Quan 
```

然后，我将在详细信息部分中有一个“值”控件和一个“val2”控件，它们将从不同的查询和条件中填充。

这可能吗？

或者，我是否应该只拥有两个子表单，每个子表单都有一个由组合框中选择的值确定的不同父键？我希望它是我列出的方式，但如果没有其他选择，这是我必须做的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T18:34:54.267

尝试这个：

```
SELECT tx.*, ty.*
FROM (Select id, value FROM t1 WHERE criteria = me.combo1) As tx
LEFT JOIN (select id, value as val2 from t1 WHERE criteria = me.combo2) As ty
ON tx.ID = ty.ID 
```

我不得不在第一个组合的更新后事件中重新查询表单。

```
SELECT x.*,
       y.*
FROM   (SELECT t1.user,
               t1.friend
        FROM   t1
        WHERE  (( ( t1.user ) = [forms]![myForm]![combo5] ))) AS x
       INNER JOIN (SELECT user,
                          friend
                   FROM   t1
                   WHERE  (( ( t1.friend ) = [forms]![myForm]![combo7] ))) AS y
               ON ( x.user = y.user )
                  AND ( x.friend = y.friend ); 
```

# ruby-on-rails - 设置自定义域化 heroku 应用程序以从域的电子邮件地址发送电子邮件

> ID：11528567
> 
> 赞同：2
> 
> 时间：2012-07-17T18:24:45.993
> 
> 标签：ruby-on-rails, heroku, email

所以，我有一个 heroku 应用程序：severe-ocean-4908.herokuapp.com/

该应用程序有一个自定义域：我通过 godaddy 购买的 www.volunteerhours.org

我的 heroku 应用程序上有 zerigo 基本插件，该插件在域名 www.volunteerhours.org 下托管 heroku 应用程序

目前，该网站通过 gmail 发送电子邮件，但现在我正试图让它使用免费电子邮件帐户 info@volunteerhours.org 发送电子邮件

我在网上做了一些研究，发现了一些有用的文章

以下是我认为谈论我正在尝试做的设置的链接：

1.  [http://www.zerigo.com/docs/managed-dns/creating_your_first_domain](http://www.zerigo.com/docs/managed-dns/creating_your_first_domain)
2.  [https://webmasters.stackexchange.com/questions/22523/enable-email-on-godaddy-when-using-zerigo-on-heroku-hosted-app](https://webmasters.stackexchange.com/questions/22523/enable-email-on-godaddy-when-using-zerigo-on-heroku-hosted-app)

我的问题

目前，我正在尝试将我的电子邮件主机添加到 zerigo，以便 email.volunteerhours.org 托管到 smptout.sercureserver.net ......就像第一篇文章中提到的

我是 Rails 的初学者，我知道这个问题不是很具体，或者这是否是理想/简单的方法。任何帮助/评论都非常受欢迎

非常感谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T02:59:16.960

您需要在 Zerigo 界面中创建 CNAME 记录。提供的 Zerigo 链接上的以下屏幕截图显示了您需要在哪里执行此操作。

将“主机”设置为`email`，将 TTL 保留为默认值（与 CNAME 记录的结尾无关），将类型设置为`CNAME`并将优先级留空。

数据字段需要是`smptout.secureserver.net`.

请注意，您还需要根据 GoDaddy 文档为您的域填写 MX 记录。确保`email`在主机字段中设置 MX 记录，因为这将是您的邮件域。

![Zerigo DNS 接口](../Images/eb41bc38d5abdbd88d8159954c126cc3.png)

# javascript - 逗号分隔变量的范围

> ID：11528570
> 
> 赞同：3
> 
> 时间：2012-07-17T18:25:01.317
> 
> 标签：javascript

我突然想到，我不知道范围是什么

```
var foo='bar', 
baz = 'bar'; 
```

是。

显然 foo 是本地范围的，但是 baz 上的 var 关键字是否必须在本地范围内，或者我的示例已经在本地范围内？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T18:26:29.487

它们最终都将在同一范围内。

```
var foo = 'bar', 
    baz = 'bar'; 
```

简称：

```
var foo = 'bar'; 
var baz = 'bar'; 
```

因此，例如在一个函数中，即使您只声明一次，两者`foo`和都将成为局部变量。`baz``var`

像[JSLint](http://www.jslint.com/lint.html)这样的工具实际上希望`var`关键字只使用一次，所以如果你想遵守这一点，你应该使用第一个例子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T18:34:58.233

这确实是一个非常有趣的问题。JavaScript 充满了边界情况。

在这篇博文中： http: [//scribu.net/blog/javascript-var-keyword-for-php-developers.html](http://scribu.net/blog/javascript-var-keyword-for-php-developers.html)，作者给出了一些使用或不使用“var”关键字的影响的例子。

使长话短说，

*   **未声明**的变量是*全局的*
*   **声明**的变量是*local*，它允许“覆盖”全局变量。

# ios - 关于 Instruments 工具的 iOS 问题，我的应用程序中的内存问题

> ID：11528574
> 
> 赞同：3
> 
> 时间：2012-07-17T18:25:15.060
> 
> 标签：ios, xcode, memory-management, instruments

我刚开始学习仪器工具，我很确定我所看到的并不好。当我查看分配，特别是“Live Bytes”和“Overall Bytes”列时，我看到随着应用程序的运行，这个数字不断增加......

我的应用程序有两个视图控制器。表格视图和第二个视图控制器显示有关他们在表格视图中选择的行的详细信息，这些信息是从 Internet 下载的。

我一直点击表格视图中的一行，然后点击导航栏中的后退按钮......并且LiveBytes继续增加。

我猜这意味着我的对象没有从内存中释放......但如果我错了，请纠正我。

**我的问题是：如何使用工具/分配中的数据来追踪此内存问题？如何找到未从内存中释放的对象？**

我正在寻找有关如何使用这些工具来清理我的应用程序存在的任何内存问题的提示。

谢谢！

XCODE 4.2.1，部署到 iOS 5.0+

编辑：我正在查看#living 列，并看到像 UIScrollView 这样的对象不断增加......并且永远不会减少。当我单击导航栏中的后退按钮时，对象是否会自动从内存中释放？什么时候释放对象，还是我需要手动释放？或者我是否会因为使用强指针而遇到问题，导致对象不被释放？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:09:32.670

每当您想以循环模式观察内存使用情况时，“分配”工具中都有精彩的*Heapshot 分析*。

1.  启动您的应用程序并进入默认状态。
2.  在 Instruments 中，按“Mark Heap”按钮创建“Baseline”。
3.  在您的应用程序中执行一些操作，例如推送视图控制器。
4.  返回默认状态。
5.  再次按“标记堆”按钮以创建堆。
6.  从第 3 步开始重复大约五次。

这将产生一个 heapshots 列表，每个都显示在该循环中仍然存在的对象。如果您的应用没有泄漏，则中间堆中不会留下任何对象。

前一两个周期可能已经预热了一些缓存，后两个周期可能没有清理一些重用资源。这就是为什么制作四到六个 heapshots 通常是个好主意。

heapshot 分析的神奇之处在于，heapshot 会向您显示先前循环中泄漏的对象，并在稍后释放对象时自动删除它们。与“泄漏”工具相反，它还发现*废弃的内存*，而不仅仅是泄漏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-05-23T09:23:14.430

很可能您已经放弃了 arm64 并且仅使用 armv7 运行您的应用程序。添加 arm64 和 armv7 作为架构

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T18:43:43.903

我认为解决内存问题的最佳方法之一是使用 ARC。

```
Edit -> Refactor -> Upgrade to Objective-C ARC. 
```

ARC 将处理您应用程序中的大部分内存管理。特别是你的应用听起来不太复杂，它可能会完全消除你的问题。不过，您仍然需要注意保留周期并听取内存警告。如果你不想使用 ARC（你应该）至少运行静态分析器。您的问题可能很简单，静态分析器可以向您展示如何解决。

编辑：

您提到了滚动视图-这可能是您的问题：[每次释放 UIScrollView 时都会发生内存泄漏](https://stackoverflow.com/questions/9762995/memory-leak-every-time-uiscrollview-is-released)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T19:08:51.080

配置文件工具有一个名为“泄漏”的工具。它类似于“分配”工具，但它向您显示未释放的对象。也许您可以使用“泄漏”工具来查找保留的对象是什么并释放这些对象。

# web-services - Web 服务上的问题 - 带有字节 [] 的大尺寸请求

> ID：11528576
> 
> 赞同：2
> 
> 时间：2012-07-17T18:25:32.253
> 
> 标签：web-services, sharepoint, iis-7, bytearray, requestfiltering

我在 IIS + Sharepoint 场中遇到 Web 服务问题...

我有一个 Web 服务，它接收一个 byte[] 并将其转换为 Sharepoint 系统上的一个文件。当我从系统上传文件时，我发现文件没有问题（直到 50MB），当我用我的 WS 加载时，除非它小于 4MB，否则会留下调用。

我试图修改web.config：

```
<httpRuntime maxRequestLength="51200"/> //KB => 50MB 
```

接着：

```
<security> 
  <requestFiltering allowDoubleEscaping="true" > 
     <requestLimits maxAllowedContentLength="2000000000" /> 
  </requestFiltering> 
</security> 
```

执行 IISReset 但没有任何变化：不接受 byte[] > 4MB ..

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T15:01:50.943

我不确定，但考虑到您在这里没有其他答案，SharePoint 有自己的文件上传限制，需要在 SharePoint 的 web.configs 中设置。希望这可以帮助您入门，对不起，我无法提供更多帮助。

# java - 休眠：标准。向标准对象添加别名

> ID：11528578
> 
> 赞同：2
> 
> 时间：2012-07-17T18:25:37.620
> 
> 标签：java, hibernate, criteria, alias

在 Hibernate 中，有没有一种方法可以创建向 Criterion 对象添加别名。我有以下工作：

我从包含许多表的大型数据库中进行动态搜索。搜索在客户端选择了许多 (25+) 可选的非独占参数。这需要使用 Hibernate Criteria API 来实现可管理性。在我的 DAO 中，我有以下方法：

```
Public List<myPojoClass> getDataByCriterion( List<Criterion> restrictionList) {
    Session s = HibernateUtil.currentSession(); 
    Criteria c = s.createCriteria(myPojo.class); 
    for (Criterion crit : restrictionList){     
        c.add(crit); 
    }  

List<myPojoClass> response = c.list(); 
return response;
} 
```

我需要与 myOtherPojo.class 一起加入，并想知道是否可以将别名添加到上面的 Criteria 列表中。
类似于：

```
restrictionsList.add(... ...createAlias("myOtherPojo.class" , "mop"); 
```

然后，我需要像上面那样向这个类添加其他逻辑和。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T19:30:47.520

又是你！;)

您可以传递一组条目（如 HashMap<String, String>）并遍历它们以填充您的别名......像这样：

```
Public List<myPojoClass> getDataByCriterion( List<Criterion> restrictionList, HashMap<String,String> aliases) {
Session s = HibernateUtil.currentSession(); 
Criteria c = s.createCriteria(myPojo.class); 
for (Criterion crit : restrictionList){     
    c.add(crit); 
}
for (Entry<String, String> entry : aliases.entrySet()){
    c.createAlias(entry.getKey(), entry.getValue());
}

List<myPojoClass> response = c.list(); 
return response;
} 
```

如果你想改变获取模式，你可以做类似的事情。当然，调用方法需要知道数据模型，这样才能正确设置别名，否则在运行时会出错。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:23:56.613

据我所知，现在有一种方法可以在没有 Criteria 实例的情况下创建连接。我建议您为标准创建一些包装器，如有必要，将包含标准和别名定义，然后使用标准作为访问者（如来自此模式）

```
interface CriterionWrapper {
    void visit(Criteria c);
}
class OnlyCriterionWrapper implements CriterionWrapper {
    private Criterion c;
    public void visit(Criteria c){c.add(c);}
}
class CriterionWrapper implements CriterionWrapper{
    private Criterion c;
    private String whateverIsNeededToCreateAlias
    public void visit(Criteria c){
        c.createAlias(whateverIsNeededToCreateAlias); 
        c.add(c);
    }
} 
```

然后将 List 作为参数传递给您的 getDataByCriterion() 方法

# cakephp - Cakephp 认证只授权没有用户模型的管理员

> ID：11528586
> 
> 赞同：1
> 
> 时间：2012-07-17T18:26:08.410
> 
> 标签：cakephp, authentication, authorization, admin, acl

我已经集成了 Auth 组件和 Acl 组件（和行为），并且在 User 模型等下都可以正常工作。

现在我想让管理员完全独立于用户模型和访问控制列表。为什么？好吧，因为我正在尝试构建一个 CMS，如果客户不希望他的网站中有用户社区，它也应该可以工作。

所以我希望管理员能够在没有用户模型的情况下登录，一旦管理员登录，他应该可以访问所有内容，无论 Acl 说什么......

我怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T04:47:12.063

在 AppController 中声明 AuthComponent 时，您必须传递一个选项“userModel”。希望[此链接](http://book.cakephp.org/2.0/en/core-libraries/components/authentication.html#configuring-authentication-handlers)对您有所帮助。请询问它是否不适合您。

# javascript - FF 3.6 和 jQuery 1.7 和 removeEventListener()

> ID：11528588
> 
> 赞同：0
> 
> 时间：2012-07-17T18:26:30.233
> 
> 标签：javascript, jquery, firefox

我有一个问题，FireFox 3.6 不喜欢我在 jQuery (v1.7.2) 中调用非 jQuery 函数。

缩减我的代码版本：

```
function doInitialiseForm( theField ) {
  /* loop through a few fields and set the appropriate attributes & class */
  nX = parseInt( theField ) ;
  var inputElement = '' ;
  for ( i=(nX + 1); i <= 10 ; i++ )
  {
    $('#acBox' + i).addClass('pHide') ;  
    /* toggle the required attribute/class on the input boxes - for HTML5 input validation to behave correctly ... */
    inputElement =  document.getElementById('acBoxName_' + i ) ;
    inputElement.removeAttribute('required');
    $( inputElement ).removeClass( 'required' )
  }
}

$(document).ready(function() {

  if ( isBookingPage == '1' )
  {
      doInitialiseForm( document.getElementById('AttendingCount') ) ;  
  }
}); 
```

FireFox 报告的错误：

```
Error: uncaught exception: [Exception... "Not enough arguments"  nsresult: "0x80570001   (NS_ERROR_XPC_NOT_ENOUGH_ARGS)"  location: "JS frame :: http//development_server/Booking/js/script.js :: doInitialiseForm:: line 65"  data: no] 
```

它似乎与 FF 期望第三个参数有关`removeEventListener()`，这是可选的。但是，我没有直接使用`removeEventListener()`.

为了使上述代码在旧版本的 FireFox 中工作，我需要实现哪些额外的代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T08:43:02.473

问题现已解决。

函数 doInitialiseForm() 中省略的部分代码是调用 setAttribute() 并且我没有包含第二个参数。

即最初写为

```
inputElement.setAttribute('required'); 
```

什么时候应该

```
inputElement.setAttribute('required',''); 
```

# javascript - 如何使用分配给 JQuery .each() 中的变量的参数调用函数？

> ID：11528589
> 
> 赞同：0
> 
> 时间：2012-07-17T18:26:29.740
> 
> 标签：javascript, jquery

如何将参数传递给分配给变量的函数。例如：

```
var updateDiv = function() {
   var row = this;
   var values = "";
   $('input[type=text],textarea,input[type=radio]:checked,input[type=checkbox]:checked', this).each(function() {
       if ($(this).val()!="" && $(this).val()!=null) {
           if (values!="") values = values + ","+ $(this).val();
           else values +=  $(this).val();
         }
       });
      if (values!="") { 
       if(values.substring(0,1)==",") values = values.substring(1) +"<br>";
       else values = values +"<br>";
      } 
      $('.jist', row).append(values);
}

$('tr:has(input)').each(updateDiv);
$('tr:has(textarea)').each(updateDiv); 
```

HTML：

```
<tr>
<td>ai</td><td> <input type="text" name="ai" id="ai"></td>
<td><input type="checkbox" name="ana" id="ana" value="N/A"></td>
<td><div class="jist"></div></td>
</tr> 
```

我想将参数传递给`updateDiv`-> `updateDiv("mystring")`；我想以这种方式在函数中使用“mystring”-> `$('.'+mystring, row).append(values);`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:38:45.520

## 简单干净

不知道我是如何错过这里显而易见的。

jQuery

```
var updateDiv = function(divClass) {    
    ...
    $(divClass, row).append(values);
}

$('tr:has(input)').each(function(){ updateDiv('.hist'); });
$('tr:has(textarea)').each(function(){ updateDiv('.something-else'); }); 
```

.

## 全局变量法

您可以使用类名分配全局变量。通过在每个函数之前定义变量`.each()`，`updateDiv`函数使用不同的类名。

jQuery

```
var updateDiv = function() {    
    ...
    $(window.divClass, row).append(values);
}

window.divClass = '.hist';
$('tr:has(input)').each(updateDiv);
window.divClass = '.something-else';
$('tr:has(textarea)').each(updateDiv);​ 
```

.

## HTML5 数据方法

您可以将值作为数据对象分配给被调用的元素。我还清理了一些选择器和 jQuery 冗余。

小提琴：http: [//jsfiddle.net/iambriansreed/KWCdn/](http://jsfiddle.net/iambriansreed/KWCdn/)

HTML

```
<table>
    <tr data-update=".hist">
        <td>AutoI</td>
        <td> <input type="text" name="autoIH_complaint" id="autoIH_complaint"></td>
        <td><input class="NA" type="checkbox" name="autoINA" id="autoINA" value="N/A"></td>
        <td><div class="hist"></div></td>
    </tr>
</table> 
```

jQuery

```
var updateDiv = function() {

    var row = this, values = "";
    $('input:text,textarea,:radio:checked,:checkbox:checked', this).each(function() {
        if (this.value != "" && this.value != null) {
            if (values != "") values = values + "," + this.value;
            else values += this.value;
        }
    });
    if (values != "") {
        if (values.substring(0, 1) == ",") values = values.substring(1) + "<br>";
        else values = values + "<br>";
    }
    $(row.data('update'), row).append(values);
}

$('tr:has(input)').each(updateDiv);
$('tr:has(textarea)').each(updateDiv);​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T18:38:32.087

我们可以将索引传递给函数，就像 jQuery 的`.each()`方法一样。

```
<div class="test">1</div>
<div class="test">2</div>​ 
```

这将警告索引为“0”，然后为“1”。

```
var updateDiv = function( index )
{   
    alert( index );
}

$('.test').each(updateDiv); 
```

如果您将字符串作为参数传递，`.each(updateDiv("string1"))`它首先评估函数。

# java - 使用java创建最大堆

> ID：11528591
> 
> 赞同：2
> 
> 时间：2012-07-17T18:26:32.780
> 
> 标签：java, data-structures

我正在尝试使用以下代码在 java 中创建一个 Max-Heap：

```
public class Heapify {
// 16 14 10 8 7 9 3 2 4 1

    public static int[] Arr = {4, 1, 3, 2, 16, 9, 10, 14, 8, 7};
    public static int counter = 0;

    public static void main(String[] args) {
        int kk;
        for (kk = 0; kk <= Arr.length - 1; kk++) {
            heapM(Arr, kk);
        }

        for (int krk = 0; krk < Arr.length; krk++) {
            System.out.println(Arr[krk]);
        }

    }

    public static void heapM(int[] Arr, int i) {

        int largest;
        int left = i * 2;
        int right = i * 2 + 1;
        if (((left < Arr.length) && (Arr[left] > Arr[i]))) {
            largest = left;
        } else {
            largest = i;
        }

        if (((right < Arr.length) && (Arr[right] > Arr[largest]))) {
            largest = right;
        }
        if (largest != i) {
            swap(i, largest);

            heapM(Arr, largest);
        }
    }

    private static void swap(int i, int largest) {
        int t = Arr[i];
        Arr[i] = Arr[largest];
        Arr[largest] = t;

    }
} 
```

所需的输出应该是：

```
16 14 10 8 7 9 3 2 4 1 
```

而我得到

```
4 3 16 14 8 9 10 2 1 7 
```

有人可以帮忙解释为什么堆没有正确构建吗？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-17T18:43:07.360

我运行了你的代码，除了 Jodaka 说的，我还发现了一个错误

```
for (kk = 0; kk <= Arr.length - 1; kk++) {
        heapM(Arr, kk);
} 
```

应该

```
for (kk = Arr.length -1; kk >= 0; kk--) {
        heapM(Arr, kk);
} 
```

因为在做 MaxHepify 时，你从头开始，然后倒退。和

```
 int left = i * 2;
 int right = i * 2 + 1; 
```

应该是，正如Jodaka所说

```
int left = 2*i+1;
int right = 2*i + 2; 
```

我在这里运行它，现在输出是正确的

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-17T18:35:47.923

我认为你的问题在这里：

```
int left = i * 2;
int right = i * 2 + 1; 
```

由于java数组是从零开始的，所以你说0的左孩子是0 * 2 = 0！修正你的逻辑，看看是否能解决你的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-29T21:12:44.133

```
for (kk = Arr.length -1; kk >= 0; kk--) {
    heapM(Arr, kk);
} 
```

应该

```
for (kk = (Arr.length -1)/2; kk >= 0; kk--) {
    heapM(Arr, kk);
} 
```

更高效。

**编辑**这使您可以在 O(n) 时间内而不是 O(n*lg(n)) 时间内构建堆，并在此处进行说明：[http ://en.wikipedia.org/wiki/Binary_heap#Building%5Fa%5Fheap](http://en.wikipedia.org/wiki/Binary_heap#Building%5Fa%5Fheap)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-17T18:44:33.937

当你想创建一个最大堆时，你应该从 n/2 开始到 0 而不是从 0 到 n。由于从 0 到 n 发生的情况是，在像 2 0 1 12 13 这样的数组中。执行最大堆后的输出数组将是 2 13 1 12 0，就像你从 n/2 调用到 0 一样13 12 1 2 0。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-17T19:42:17.547

这是作业吗？如果没有，您可以使用 JAVA 的 PriorityQueue

# mysql - SQL 更新查询错误

> ID：11528593
> 
> 赞同：2
> 
> 时间：2012-07-17T18:26:35.227
> 
> 标签：mysql, sql, sql-server, sql-server-2005

这以前有效，但现在不起作用，我很困惑。我回顾了整个事情，一切看起来都很好，但也许更高级的人可以发现一些东西？

这是脚本：

```
UPDATE Orders SET Orders.OrderStatus = 'Shipped',Orders.SalesRep_CustomerID = null
WHERE Orders.OrderStatus in ('Pending','Processing') 
AND Orders.PaymentAmount = Orders.Total_Payment_Received
AND Orders.ShipDate < dateadd(day, -60, convert(char(10), getdate(), 101))
AND Orders.Shipped = Y 
```

我得到的只是一个错误，没有解释。有人能发现错误吗，我敢肯定，我对 SQL 太陌生了，无法识别它。谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-17T18:28:56.107

不确定您遇到的错误是什么，但您需要在引号中加上 Y。

```
UPDATE Orders SET Orders.OrderStatus = 'Shipped',Orders.SalesRep_CustomerID = null
WHERE Orders.OrderStatus in ('Pending','Processing') 
AND Orders.PaymentAmount = Orders.Total_Payment_Received
AND Orders.ShipDate < dateadd(day, -60, convert(char(10), getdate(), 101))
AND Orders.Shipped = 'Y' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T18:30:37.473

最后一行的 Y 必须在 ''

```
UPDATE Orders SET Orders.OrderStatus = 'Shipped',Orders.SalesRep_CustomerID = null
WHERE Orders.OrderStatus in ('Pending','Processing') 
AND Orders.PaymentAmount = Orders.Total_Payment_Received
AND Orders.ShipDate < dateadd(day, -60, convert(char(10), getdate(), 101))
AND Orders.Shipped = 'Y' 
```

或者如果您也发布错误会很好

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T17:05:50.900

UPDATE Orders SET Orders.OrderStatus = 'Shipped',Orders.SalesRep_CustomerID = null WHERE Orders.OrderStatus in ('Pending','Processing') AND Orders.PaymentAmount = Orders.Total_Payment_Received AND Orders.ShipDate < dateadd(day, -60,转换（char（10），getdate（），101））和 Orders.Shipped = 'Y'

# ruby - Splunk-client (with Nokogiri) giving Undefined Namespace Prefix

> ID：11528596
> 
> 赞同：1
> 
> 时间：2012-07-17T18:27:12.543
> 
> 标签：ruby, nokogiri, splunk

I'm using splunk-client to extract results from splunk. Here's the code:

```
query = "sourcetype=collection #{order_id}"
search = @splunk_client.search(query)
search.wait 
```

The search is happening fine, and it seems like I'm doing everything according to the example (https://github.com/cbrito/splunk-client), but I get this error on the 'search.wait' line:

```
Undefined namespace prefix: //s:key[@name='isDone'] 
```

Any ideas what could be going wrong? Running these commands in irb works fine. Is there some sort of blocking issue?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T20:55:02.830

There is currently very little error checking which occurs within the gem itself. The reason for the error is that `wait` looks for the status of the `isDone` key to change to true.

Since your credentials were not properly setup in the first place, the gem creates a search object with an invalid session. The search does not initially fail, because enough response came back from Splunk that Nokogiri processes it into an object without a Splunk search sid.

In the future I should likely raise an exception if a proper sid is not returned to avoid confusion.

Source: I wrote the gem.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T00:16:33.223

I found out the issue -- the splunk client wasn't authenticating properly, and so `search` was actually a broken SplunkJob object (with a nil username and authentication key). It's strange that there was no error raised until the `wait` command, but upon inspecting the `search` object, one of the fields stated that the object was malformed.

# jquery - 使用 Jquery Mobile 在网站的不同页面上具有相同 ID 的冲突

> ID：11528597
> 
> 赞同：4
> 
> 时间：2012-07-17T18:27:17.503
> 
> 标签：jquery, jquery-mobile, duplicates

我正在使用移动查询制作现有网站的移动版本。该站点有数百个页面，这些页面具有适用于 www 版本的已建立标记。问题是每个页面上都有许多相同元素 ID 的实例，例如 #username 或 #map 或 #photo。这在 www 上很好，因为每个页面都是独立加载的，所以没有冲突。在 JQM 中，看起来所有页面都以某种方式缓存在一起，并且代码引用了前一页。例如：

Page1.html

```
<div id="commonIdOnEveryPage">Page 1</div>
<a href="page2.html">Link</a>
<script>
alert($("#commonIdOnEveryPage").html());
</script> 
```

Page2.html

```
<div id="commonIdOnEveryPage">Page 2</div>
<script>
alert($("#commonIdOnEveryPage").html());
</script> 
```

单击第 1 页的链接转到第 2 页后，警报仍然显示“第 1 页”。

在这个例子中，很容易改变第二页的id，但是在实际的站点中，不同的页面上有数百个地方使用相同的ID，而JS有数千行长。当然有一种方法可以使 JQM 与此兼容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T18:32:30.790

改用一个公共类，jQuery Mobile 一次在 DOM 中有多个页面，使您的“唯一”id 不唯一。

```
$(".ui-page-active .commonclass").html() 
```

编辑：

如果 id 不能是唯一的，那么下一个最好的方法是：

```
$(".ui-page-active div[id=commonid]").html() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T00:16:02.657

我发现这段代码似乎从缓存中删除了前一页，但保留了后退按钮和转换。

```
$('div').live('pagehide', function(event, ui) {
    $(event.target).remove();
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-09-27T14:56:23.827

汤姆金凯德的回答是一个专业提示。

只需稍微清理一下即可：1）减少从缓存中删除每个 div 的开销，以及 2）使其与新的 JQuery 约定保持同步

```
$(document).on('pagehide', '.ui-page', function(event, ui) {
    $(event.target).remove();
}); 
```

现在，缓存已清除以前的页面，并保留了后退按钮功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-17T19:41:24.377

[默认情况下](http://jquerymobile.com/demos/1.1.1/docs/pages/page-scripting.html)，当您导航到 JQM 中的页面时，框架会通过 ajax 加载页面的内容并将其附加到 . `DOM`，因此您最终会得到每个页面的多个 id。您还可以[链接到一个页面](http://jquerymobile.com/demos/1.1.1/docs/pages/page-links.html)，以便它通过`http`使用 'rel="external" `or`data-ajax="false"` 正常加载页面，我认为这应该可以解决您的问题，您需要确保适当的 js 文件虽然链接在每个页面的头部。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-17T19:42:55.777

将使用：

```
$(document).ready(function(){
    alert('#commonIdOnEveryPage');
}); 
```

修理它？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-10T15:34:06.727

我根据时间创建一个唯一的字符串并将其附加到每个 id。

```
// unique string for use in DOM ids
$unique = str_replace(array(' ', '.') ,'_', microtime()); 
```

然后在html输出中：

```
<div id="commonIdOnEveryPage<?php echo $unique; ?>">Page 2</div>
<script>
alert($("#commonIdOnEveryPage<?php echo $unique; ?>").html());
</script> 
```

# http - Tell if someone is accesing my HTTP-resources directly?

> ID：11528598
> 
> 赞同：5
> 
> 时间：2012-07-17T18:27:19.977
> 
> 标签：http, hotlinking

Is there a way to find out if anyone is calling the image located on my website **directly** on their website?

I have a website and I just want to make sure no one is using my bandwidth.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T18:33:34.150

当然有一些方法，有些方法比其他方法更值得信赖。

* * *

### 使用*Referer* -Header

有一个名为*HTTP-Header 的*名称`Referer`，它通常包含一个字符串，表示用户访问该 URL 以访问当前请求。

您可以将其视为*“我来自这里”*的标题。

如果保证它始终存在，那么防止人们窃取您的带宽将是小菜一碟，尽管由于情况并非如此，因此仅依赖此值几乎是一场赌博（有时可能不存在）。

* * *

### 使用*Cookie*

判断用户是否是您网站上的真正访问者的另一种方法是使用 cookie，没有 cookie 并试图访问特定资源（例如图像）的用户可能会收到一条消息说*“对不起，只有 example.com 的真实访问者才能访问此图像”*。

太糟糕了，没有任何说明客户端被迫实施和处理 cookie。

* * *

### 使用设置过期时间的链接 [*推荐*]

这可能是最安全的选择，尽管它是最难实现的。

使用仅在*N*小时内有效的链接将无法窃取您的带宽，而不会遇到实施某种爬虫的麻烦，该爬虫会定期爬取您的网站并返回访问资源（例如图像）所需的当前访问令牌）。

当用户访问该站点时，生成的*N*小时令牌将应用于所有可用资源，并将其附加到返回给访问者的路径中。此令牌是强制性的，仅在*N*小时内有效。

如果用户尝试使用无效/不存在的令牌访问图像，您可以发送回HTTP 状态代码`404`或`401`作为*HTTP 状态代码*（最好是后者，因为它是一个*禁止*请求）。

**然而，有一些怪癖值得一提**：

*   *来自 *search-engine*s 的爬虫可能不会在N*小时内的特定时刻访问整个网站，请确保他们可以访问您网站的全部内容。通过使用标头*User-Agent*的值来识别它们。

*   不要试图将令牌的寿命降低到任何合理的时间，请记住，有些用户的连接速度很慢，拥有*5 秒*的令牌可能听起来很酷——但真正的用户可能会被错误地标记。

*   永远不要将令牌放在人们应该能够从外部点（搜索引擎）找到的资源上，例如包含您希望保护的图像的页面。

    如果您不小心这样做，您将主要损害您网站的声誉。

* * *

### 额外的想法...

> *请记住，任何实施以使 leechers 无法盗链您的资源的方法**都不**应导致真正的访问者被标记为带宽 leech。您可能想放松限制而不是加强限制。*
> 
> *我宁愿有 10 个普通访问者和 2 个 leechers，而不是没有 leechers 但只有 5 个普通用户（因为我不小心将 5 个真正的访问者标记为 leechers，而没有考虑太多）。*

# c# - 如何为 ASP.Net 复合服务器控件实现 ClientInstanceName 属性

> ID：11528600
> 
> 赞同：1
> 
> 时间：2012-07-17T18:27:21.920
> 
> 标签：c#, asp.net, devexpress, custom-server-controls

如何在我自己的服务器控件中实现 DevExpress 用于其控件的 ClientInstanceName 属性？

ClientID 属性是只读的。这是否意味着我必须等到生成 HTML 然后替换 name 属性？

有没有办法在 c# 中做到这一点，或者我必须在 JavaScript 中做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:20:01.923

这是我想出的（任何建议或改进将不胜感激）：

```
 private String _ClientInstanceName;

            /// <summary>
            /// Gets or Sets the client instance name.
            /// </summary>
            [
            Bindable(true), Category("Client-Side"),
            DefaultValue(""), Description("The ClientInstanceName can be used to reference this control on the client.")
            ]
            public String ClientInstanceName
            {
                get
                {
                    return _ClientInstanceName;
                }
                set
                {
                    _ClientInstanceName= value;
                }
            }

        protected override void OnPreRender(EventArgs e)
        {
            base.OnPreRender(e);

            //Register startup script for creating JavaScript reference to this server control object.
            if (this.ClientInstanceName.Length > 0) { registerClientInstanceName(this.ClientInstanceName, this.ClientID); }
        }

        /// <summary>
        /// Create a JavaScript reference to the Object with ClientID using the ClientInstanceName property.
        /// Based on: http://msdn.microsoft.com/en-us/library/asz8zsxy.aspx
        /// </summary>
        /// <param name="ClientInstanceName"></param>
        private void registerClientInstanceName(String ClientInstanceName, String ClientID)
        {
            // Define the name and type of the client scripts on the page.
            String csname1 = "ClientInstanceNameScript";
            Type cstype = this.GetType();

            // Get a ClientScriptManager reference from the Page class.
            ClientScriptManager cs = Page.ClientScript;

            // Check to see if the startup script is already registered.
            if (!cs.IsStartupScriptRegistered(cstype, csname1))
            {
                StringBuilder cstext1 = new StringBuilder();
                cstext1.Append("<script type=text/javascript>");
                cstext1.Append("window['" + ClientInstanceName + "']=document.getElementById('" + ClientID + "');");
                cstext1.Append("</script>");

                cs.RegisterStartupScript(cstype, csname1, cstext1.ToString());
            }
        } 
```

# lynx - 无法修改 lynx 中的下拉框

> ID：11528608
> 
> 赞同：1
> 
> 时间：2012-07-17T18:28:20.427
> 
> 标签：lynx

我在 cygwin 上使用 lynx 版本 2.8.7rel1。当我尝试更改下拉框时，当它突出显示时收到以下消息：“UNMODIFIABLE option list”，并且我无法更改其默认值。如何解决这个问题？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T16:08:25.857

这看起来像 lynx 2.8.7-1 中的错误

它看起来类似于 2005 年报告修复的这个错误：

> 修复：当“选择”的第一个“选项”元素具有“禁用”属性时，Lynx 将整个“选项/选择列表”变为不可修改。同一个“select”中后面的“option”元素的“disabled”属性没有这种效果。如果尊重“禁用”属性，它应该只禁用该元素，而不是父元素或兄弟元素（Paavo Hartikainen 报告）-TD

您可以通过恢复到 lynx 2.8.5-4 而不是 2.8.7-1 来解决此问题（2.8.5-4 在 cygwin 中仍然可用——当您在“选择包”界面中时，单击版本“新”列中 lynx 的编号，直到该版本出现）。

# sql-server-2008 - 为什么这段 SQL 代码不会产生错误？

> ID：11528612
> 
> 赞同：5
> 
> 时间：2012-07-17T18:28:32.487
> 
> 标签：sql-server-2008, tsql

> **可能重复：**
> [IN 子句中不存在列，但 SQL 运行](https://stackoverflow.com/questions/5076906/column-does-not-exist-in-the-in-clause-but-sql-runs)

我今天在工作时偶然发现了这个，我想知道，为什么下面的代码没有生成和错误？

```
CREATE TABLE #TableA (ColumnA VARCHAR(25))
CREATE TABLE #TableB (ColumnB VARCHAR(25))

INSERT INTO #TableA (ColumnA) VALUES('1')
INSERT INTO #TableA (ColumnA) VALUES('2')
INSERT INTO #TableA (ColumnA) VALUES('3')

INSERT INTO #TableB (ColumnB) VALUES('1')

SELECT *
FROM #TableA
WHERE ColumnA IN(SELECT ColumnA FROM #TableB) 
```

**输出：**

```
ColumnA
1
2
3 
```

#TableB 上不存在ColumnA，为什么没有产生错误？

@@VERSION 告诉我我正在运行它：

```
Microsoft SQL Server 2008 (RTM) - 10.0.1600.22 (X64)   Jul  9 2008 14:17:44   Copyright (c) 1988-2008 Microsoft Corporation  Enterprise Edition (64-bit) on Windows NT 6.1 <X64> (Build 7601: Service Pack 1) (VM) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-17T18:31:55.817

`ColumnA`在子查询中`(SELECT ColumnA FROM #TableB)` 是指`ColumnA`#TableA 的，它是 SELECT 列表中的有效列。

因此没有错误，并且您将得到三行，因为您将 #TableA.ColumnA 与 #TableA.ColumnA 进行比较

如果您想验证上述语句，请将 ColumnA 替换为除有效列（例如 ColumnAB）以外的任何内容（例如 ColumnAB），您将收到错误消息。

如果你试试这个：

```
CREATE TABLE #TableA (ColumnA VARCHAR(25))
CREATE TABLE #TableB (ColumnB VARCHAR(25))

INSERT INTO #TableA (ColumnA) VALUES('1')
INSERT INTO #TableA (ColumnA) VALUES('2')
INSERT INTO #TableA (ColumnA) VALUES('3')

INSERT INTO #TableB (ColumnB) VALUES('1')

SELECT *
FROM #TableA
WHERE ColumnA IN(SELECT ColumnAB FROM #TableB) 
```

输出将是

> 消息 207，级别 16，状态 1，第 14 行
> 无效的列名“ColumnAB”。

# java - JVM是如何调用的？

> ID：11528613
> 
> 赞同：0
> 
> 时间：2012-07-17T18:28:36.040
> 
> 标签：java, jvm

我正在努力学习Java。我浏览了很多文件。我的理解是，当我们给出**javac**命令时，文件被编译并产生字节码。在此之后，我们给出**java**命令来运行程序。

*   我想知道后台发生了什么？
*   我的意思是如何调用JVM？
*   谁在调用 JVM？
*   类是如何加载的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T18:30:36.973

该`java`命令将启动 JVM。我不确定这两者是否可以被视为同义词，但出于所有意图和目的，这就是结果。

当JVM启动时，类被加载到内存中，然后主类被执行。JVM 执行的细节相当复杂，IMO 不适合单个问题。正如 TS- 指出的那样，[规范](http://docs.oracle.com/javase/specs/jvms/se7/html/index.html)就在那里。

# perl - 用于排序的子键比较功能

> ID：11528619
> 
> 赞同：2
> 
> 时间：2012-07-17T18:29:00.567
> 
> 标签：perl, sorting, hierarchical, cmp

我需要一个可以与排序一起使用的 Perl 比较函数。

每个键都是一个文本字符串，具有任意数量的子键，由分隔符（点、冒号、空格和斜杠）分隔。一些子键是数字的，需要按数字排序。密钥格式和子密钥数量各不相同。因此，比较必须处理一个键长于另一个键，并且必须处理子键在一个键中是数字但在另一个键中不是数字的情况（在这种情况下，文本比较适用于该子键）。

这行得通，但我敢打赌有更好的解决方案：

```
use warnings;
use strict;
use Scalar::Util qw[looks_like_number];

sub hier_cmp {

    my $aa = $a;
    my $bb = $b;

    # convert all delims (. : / space) to the same delim

    $aa =~ tr/.:\/ /::::/;
    $bb =~ tr/.:\/ /::::/;
    my @lista = split(":", $aa);
    my @listb = split(":", $bb);

    my $result;

    for my $ix (0 .. min($#lista, $#listb)) {
        if (exists($lista[$ix]) && exists($listb[$ix])) {
            if ( looks_like_number($lista[$ix]) && looks_like_number($listb[$ix])) {
                # compare numerically
                $result = ($lista[$ix] <=> $listb[$ix]);
            } else {
                # compare as strings
                $result = ($lista[$ix] cmp $listb[$ix]);
            }
            if ($result == 0) {
                next;
            }
            return $result;

        } elsif (exists($lista[$ix])) {
            return 1;
        } else {
            return -1;
        }
    }
} 
```

就我而言，可读性比速度更重要。这只是一个内部工具，列表很少有超过数百个元素。但是，任何学习东西的机会都是好的。

如您所见，我不是 perl 向导。即使对我的代码进行微不足道的改进也将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T18:52:13.820

这看起来像自然排序。CPAN 上有几个模块已经这样做了，例如[Sort::Naturally](https://metacpan.org/module/Sort%3a%3aNaturally)或[Sort::Key::Natural](https://metacpan.org/module/Sort%3a%3aKey%3a%3aNatural)。

例如：

```
use Sort::Key::Natural qw(natsort);
my @sorted = natsort @data; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T19:16:01.103

如果你给我们一些数据来测试会有所帮助，但是这段代码通过了一些基本的测试并且看起来是正确的。

它通过使用该[`List::MoreUtils`](https://metacpan.org/module/List%3a%3aMoreUtils)函数`pairwise`创建字段对数组来简化问题。

然后只需检查是否只定义了一个，当其中一个列表先于另一个结束并且应该首先排序时；如果它们都是数字，则应将它们与数字比较进行比较；或者简单地将它们作为字符串进行比较。

如果到达对数组的末尾，则所有内容都匹配并返回零以表示相等。

**更新**

我已更改此代码以删除对`List::MoreUtils::pairwise`.

```
use strict;
use warnings;

use Scalar::Util 'looks_like_number';

sub hier_cmp {

  our ($a, $b);

  my @a = split m|[.: /]+|, $a;
  my @b = split m|[.: /]+|, $b;

  for my $i (0 .. $#a > $#b ? $#a : $#b) {
    my @ab = ( $a[$i], $b[$i] );
    if (grep defined, @ab < 2) {
      return defined $ab[0] ? 1 : -1;
    }
    else {
      my $numeric = grep(looks_like_number($_), @ab) == 2;
      my $result = $numeric ? $ab[0] <=> $ab[1] : $ab[0] cmp $ab[1];
      return $result if $result;
    }
  }

  return 0;
} 
```

# php - PHP：如何访问由静态函数返回的数组的第一个元素

> ID：11528620
> 
> 赞同：1
> 
> 时间：2012-07-17T18:29:03.593
> 
> 标签：php

> **可能重复：**
> [php 爆炸和数组索引](https://stackoverflow.com/questions/4639265/php-explode-and-array-index)

在 PHP 5.3...

我有一个总是返回一个数组的动态静态方法。在某些情况下，它将返回一个仅包含一个元素的数组。我想在一个语句中将数组的第一个元素分配给一个变量。目前我必须这样做：

```
$user = User::findByEmail($_SESSION['email']);
$user = $user[0];
echo $user; 
```

我想避开那部分...

```
$user = $user[0]; 
```

我希望这样的事情能够奏效：

```
$user = User::findByEmail($_SESSION['email'])[0]; // not working 
```

或者

```
$user = User::findByEmail($_SESSION['email'])->get(0); // not working 
```

或者

```
$user = User::findByEmail($_SESSION['email']).get(0); // not working 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T18:33:36.983

**编辑**

你想要的解决方案是这样的：

```
$user = current( User::findByEmail( $_SESSION['email'] ) ); 
```

请注意，使用`current()`with 函数总是返回第一个元素，因为数组从未分配给变量，并且没有点。如果函数通过引用返回数组，则情况并非如此。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T18:34:47.887

你不能（在 PHP 5.4 之前）。这是 PHP 解析器的限制。你最好的选择：

```
$user = User::findByEmail($_SESSION['email']);
$user = $user[0]; 
```

# javascript - 请在 JSfiddle 中使用 POST 请求

> ID：11528621
> 
> 赞同：7
> 
> 时间：2012-07-17T18:29:07.287
> 
> 标签：javascript, jsfiddle

每当我运行我的代码时，我都会收到错误`{"error": "Please use POST request"}`有人知道这个错误是什么意思吗？我在 jsfiddle 中的代码：http: [//jsfiddle.net/Aidoboy/AdzwC/12/](http://jsfiddle.net/Aidoboy/AdzwC/12/) 代码：

```
/*jslint browser: true, devel: true */

function Submit() {
    //"use strict";
    alert("running");
    document.forms.form.submit();
    var owed = 0;

    function calc(n, o) {
        if (n >= 90) {
            owed = owed + 1;
            if (n >= 95) {
                owed = owed + 1;
            }
        }
        else if (o >= 80) {
            owed = owed + 0.5;
        }
        if (n > o) {
            owed = owed + 0.5 * (n - o);
        }
        if (n < o) {
            if (n < 95) {
                owed = owed - 0.25;
            }
        }
        if (n == 94) {
            if (o == 97) {
                owed = owed + 0.25;
            }
        }
    }
    calc(form.Math.value, form.OMath.value);
    calc(form.Sci.value, form.OSci.value);
    calc(form.ELA.value, form.OELA.value);
    calc(form.SS.value, form.OSS.value);
    calc(form.Elec1.value, form.OElec1.value);
    calc(form.Elec2.value, form.OElec2.value);
    calc(form.Elec3.value, form.OElec3.value);
    calc(form.Elem1.value, form.OElem1.value);
    calc(form.Elem2.value, form.OElem2.value);
    calc(form.Elem3.value, form.OElem3.value);
    alert(Owed);
}​​​​​ 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-17T18:30:47.737

```
document.forms.form.submit(); 
```

这实际上提交了`<form>`，你不能在 jsFiddle ¹中这样做。只需删除该行，如果您想运行 JavaScript，为什么要提交表单？

[1：您*可以*，但不能使用`<form>`. 您可以测试 AJAX，请参阅[文档](http://doc.jsfiddle.net/use/echo.html)。您收到错误“请使用 POST 请求”，因为默认情况下`<form>`使用 GET。jsFiddle 不喜欢被发送查询字符串，所以它给出了那个错误。您*可以*向其发布内容，但不会发生任何事情。]

# c# - 将值转换器绑定到对象或类型

> ID：11528625
> 
> 赞同：1
> 
> 时间：2012-07-17T18:29:15.293
> 
> 标签：c#, wpf, xaml, ivalueconverter

例如，我有一个类似这样的视图模型：

```
 public class MyViewModel
{
    public ObservableCollection { get; set; }
}

public abstract class Person { }

public class Employee : Person { }

public class Boss : Person { } 
```

根据我不想对我的 ListItemTemplate 进行一些更改的人的类型。我有一个像这样的值转换器：

```
 public object Convert(object value, Type targetType, object parameter, string language)
{
       if (value == null) return Visibility.Collapsed;

      return value is Boss ? Visibility.Visible : Visibility.Collapsed;
} 
```

如何将 Visibilty 属性绑定到转换器？

我做过的事情：

```
<Border Visibility="{Binding Path=self, Converter={StaticResource BossVisibilityConverter}}">

<Border Visibility="{Binding Path=this, Converter={StaticResource BossVisibilityConverter}}"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:34:39.467

如果 DataContext 设置为您的 ViewModel 实例，则只需尝试以下操作：

```
<Border Visibility="{Binding Converter={StaticResource BossVisibilityConverter}}"> 
```

此外，您可能想查看**DataTemplateSelector**

```
public class PersonDataTemplateSelector: DataTemplateSelector
{

    public DataTemplate BossTemplate { get; set; }
    public DataTemplate EmployeeTemplate { get; set; }

    public override DataTemplate SelectTemplate(object item, DependencyObject container)
    {
        DataTemplate selectedTemplate = null;

        if (item is Boss)
        {
            selectedTemplate = BossTemplate;
        }
        else
        {
            selectedTemplate = EmployeeTemplate;
        }

        return selectedTemplate;
    }
} 
```

在xml中：

```
<controls:PersonDataTemplateSelector x:Key="personDataTemplateSelector"
                                       BossTemplate="{StaticResource ResourceKey=BossTemplate}" 
                                       EmployeeTemplate="{StaticResource ResourceKey=EmployeeTemplate}" />

<DataTemplate x:Key="BossTemplate">
   ... Template here
</DataTemplate>

<DataTemplate x:Key="EmployeeTemplate">
   ... Template here
</DataTemplate> 
```

然后，您可以使用 personDataTemplateSelector 作为 ListView 或其他一些 ItemsControl 中 ItemTemplateSelector 的值。

```
<ContentPresenter Content="{Binding}" 
                  ContentTemplateSelector="{StaticResource ResourceKey=personDataTemplateSelector}" /> 
```

# iphone - 在边界内倾斜移动图像

> ID：11528626
> 
> 赞同：0
> 
> 时间：2012-07-17T18:29:35.170
> 
> 标签：iphone, ios, xcode4.2

我目前正在创建一个 iPhone 应用程序，它显示我的速度航向位置和一些其他传感器读数，以供我的自行车使用。我已经设法从加速器获得倾斜读数。我要做的是根据倾斜读数向左或向右移动图像。

```
 _______________________________
    :          ===                :
    :          = =                :
    :          ===                :
    ------------------------------- 
```

假设 = 符号是我的图像，我试图让它根据倾斜角度向左边缘或右边缘移动。

有任何想法吗？我已经设法通过动画移动它，但如果我长时间倾斜，我不希望它连续移动。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T13:32:54.633

首先，我使用以下方法添加了加速器数据：

```
UIAccelerometer *theAccelerometer = [UIAccelerometer sharedAccelerometer];
theAccelerometer.updateInterval = 0.1; //in seconds
theAccelerometer.delegate = self; 
```

注意时间是 0.1 秒。您需要将该时间与下面的动画相匹配。`accelerometer:didAccelerate:`然后我在委托调用中设置动画：

```
-(void)accelerometer:(UIAccelerometer *)accelerometer didAccelerate:(UIAcceleration *)acceleration

{
    NSInteger newX = 0;

    newX = imageView.frame.size.width/2 + ((320-imageView.frame.size.width) * (acceleration.x+1)/2.0);

    [UIView animateWithDuration:0.1 animations:^{
        imageView.center = CGPointMake(newX, imageView.center.y);
    }] ;
} 
```

将动画持续时间与 匹配很重要，`updateInterval`这样`UIAccelerometer`您就可以确保在下一次更新之前完成动画。

这里的重要部分可能是确定`newX`位置的数学。我基本上取了图像宽度的一半，因为那是最左边的绝对位置。从那里我知道我有`320-imageView.frame.size.width`足够的空间可以添加。如果我添加整个`320-imageView.frame.size.width`，那么我将在`320-imageView.frame.size.width/2`最右边的位置。从那里我只需要`320-imageView.frame.size.width`根据我们加速的程度来分​​解块。`accelerator.x`数据在 -1 到 1 的范围内，所以我的整个范围是 2。所以我在 0 到 2 的范围内加了1 `accelerator.x`。然后我除以 2.0，这样我就有一个 0-1 的范围。现在我有了一个乘数，我可以乘以我的`320-imageView.frame.size.width`范围。如果它是 0，我会在最左边的位置。如果它是 1，我会在最右边的位置，中间的任何东西都会被线性分解。所以最后一个词是：

```
imageView.frame.size.width/2 + ((320-imageView.frame.size.width) * (acceleration.x+1)/2.0); 
```

获取图像的新 x 位置。

我希望这就是你要找的！我在设备上对其进行了测试，只要您匹配持续时间，它就非常流畅。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:01:03.240

如果你问的是关于动画的问题。这是苹果推荐的用于动画 UIView 的代码。您可以更改 x 和 y 坐标的值。

```
 imageFrame.origin.y = 200;

[UIView animateWithDuration:0.5
                      delay:0.0
                    options: UIViewAnimationCurveEaseOut
                 animations:^{
                     datePickerView.frame = imageFrame;
                 } 
                 completion:^(BOOL finished){
                     self.datePickerViewFlag = YES;
                 }]; 
```

# javascript - 通过用户单击在图像上绘制多个多边形并计算其面积

> ID：11528627
> 
> 赞同：0
> 
> 时间：2012-07-17T18:29:37.840
> 
> 标签：javascript, javascript-events

如何通过用户单击在图像上绘制多个多边形并使用 Javascript 计算其面积

# apache - 如何在 .htaccess 中编写“if...else”mod_rewrite 语句

> ID：11528634
> 
> 赞同：3
> 
> 时间：2012-07-17T18:30:20.580
> 
> 标签：apache, .htaccess, .htpasswd

我已经在 StackOverflow 上搜索了这个问题的答案，并且看到很多问题都接近了，但还没有什么对我有用。

我想让我`.htaccess`根据调用它的域应用不同的规则。基本上，如果 subdomain.example.com 被命中，重定向到 google.com。如果 localhost 被命中，重定向到 yahoo.com。如果 www.example.com（或 example.com）被点击，重定向到 bing.com。

稍后我将添加实际的重写规则（设置环境变量和 htpasswd 保护），但首先我需要让“if then”部分正常工作。

我的（非工作）代码如下。任何帮助是极大的赞赏。

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^subdomain\.example\.com$
RewriteRule http://google.com/ [L,R=301]

RewriteCond %{HTTP_HOST} ^localhost$
RewriteRule http://yahoo.com/ [L,R=301]

RewriteCond %{HTTP_HOST} ^(www\.)?example\.com$
RewriteRule http://bing.com/ [L,R=301] 
```

**编辑：根据下面 Barta 的评论更新（但仍然无效）代码。**

```
RewriteEngine On

RewriteCond %{HTTP_HOST} ^subdomain\.domain\.com$
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule .? - [S=1]
RewriteRule ^(.*)$ /index.php/$1 [L]

RewriteCond %{HTTP_HOST} ^localhost$
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule .? - [S=7]
RewriteRule ^(.*)$ /subdir/www/index.php/$1 [L]
RewriteRule ^ - [E=MYSQL_DB_HOST:localhost]
RewriteRule ^ - [E=MYSQL_DB_NAME:XXX]
RewriteRule ^ - [E=MYSQL_USERNAME:XXX]
RewriteRule ^ - [E=MYSQL_PASSWORD:XXX]
RewriteRule ^ - [E=BASE_URL:XXX]
RewriteRule ^ - [E=ENVIRONMENT:XXX]

RewriteCond %{HTTP_HOST} ^example\.com$
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule .? - [S=1]
RewriteRule ^(.*)$ /index.php/$1 [L] 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-05-27T20:40:16.213

如果您使用的是 Apache 2.4，您可能会发现这很有用。

如果通过 HTTPS 连接，我的服务器会设置一个环境变量`HTTPS`，尽管有不同的方法可以获取它。我的目标是强制 HTTP 身份验证，但仅限于安全连接并将非安全连接重定向到安全位置。

```
<If "%{HTTPS} == 'on'">
  AuthName "Files are protected, enter your normal website email and password"
  AuthType Basic
  AuthUserFile /home/sites/mysite.co.uk/.htpasswd
  Require valid-user
</If>
<Else>
  RewriteEngine On
  RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
</Else> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-17T18:48:12.880

您正在尝试使用 [L,R=301] 标志将[http://bing.com](http://bing.com)重写为 [L,R=301] 而不是[http://bing.com的任何内容。](http://bing.com)尝试`RewriteRule ^(.*)$ http://bing.com/ [L,R=301]`

关于 IF-ELSE：像这样在 RewriteRule 上使用 S 标志：

```
RewriteCond %{HTTP_HOST} ^subdomain\.example\.com$
RewriteRule .? - [S=<here comes the number of your directives in the "else" part>]
# Here comes your ELSE part:
# Etc. etc.
RewriteRule .? - [S=<here comes the number of your directives in the "if" part>]
# Here comes your IF part. 
```

在上面的示例中，如果您的 RewriteCONd 匹配，则带有 S 标志的 RewriteRule 将跳过以下指令并在第 N 次跳过后停止跳过，其中 N 在 S= 部分之后定义。这是你的 ELSE 部分。N 号应包括您的下一个跳过 IF 部分的 RewriteRule。

由于跳过，它们的顺序相反。如果您否定 RewriteCond，那么它们按正常顺序就可以了。

这是 Apache 文档中的原始示例： [https ://httpd.apache.org/docs/2.2/rewrite/flags.html#flag_s](https://httpd.apache.org/docs/2.2/rewrite/flags.html#flag_s)

**编辑：** 尝试这样的事情：

```
RewriteEngine On

RewriteCond %{HTTP_HOST} !^subdomain\.domain\.com$
RewriteRule .? - [S=1]
RewriteRule ^(.*)$ /index.php/$1 [L]

RewriteCond %{HTTP_HOST} !^localhost$
RewriteRule .? - [S=7]
RewriteRule ^(.*)$ /subdir/www/index.php/$1 [L]
RewriteRule ^ - [E=MYSQL_DB_HOST:localhost]
RewriteRule ^ - [E=MYSQL_DB_NAME:XXX]
RewriteRule ^ - [E=MYSQL_USERNAME:XXX]
RewriteRule ^ - [E=MYSQL_PASSWORD:XXX]
RewriteRule ^ - [E=BASE_URL:XXX]
RewriteRule ^ - [E=ENVIRONMENT:XXX]

RewriteCond %{HTTP_HOST} !^example\.com$
RewriteRule .? - [S=1]
RewriteRule ^(.*)$ /index.php/$1 [L] 
```

# nhibernate - 流利的nhibernate：相同类型的compositeid（），获取没有id映射的消息

> ID：11528636
> 
> 赞同：0
> 
> 时间：2012-07-17T18:30:27.487
> 
> 标签：nhibernate, fluent-nhibernate, many-to-many, composite-primary-key

我已经搜索了 Google 和 SO，但没有遇到任何遇到同样问题的人。这是我的模型：

```
public class Hierarchy
{
    public virtual Event Prerequisite { get; set; }
    public virtual Event Dependent { get; set; }

    public override bool Equals(object obj) 
    {
        var other = obj as Hierarchy; 
        if (other == null) 
        { 
            return false; 
        } 
        else 
        { 
            return this.Prerequisite == other.Prerequisite && this.Dependent == other.Dependent; 
        } 
    }

    public override int GetHashCode()
    {
        return (Prerequisite.Id.ToString() + "|" + Dependent.Id.ToString()).GetHashCode();
    }
} 
```

这是我的映射：

```
public class HierarchyMap : ClassMap<Hierarchy>
{
    public HierarchyMap()
    {
        CompositeId()
            .KeyReference(h => h.Prerequisite, "PrerequisiteId")
            .KeyReference(h => h.Dependent, "DependentId");
    }
} 
```

这是永远存在的结果：

```
{"The entity 'Hierarchy' doesn't have an Id mapped. Use the Id method to map your identity property. For example: Id(x => x.Id)."} 
```

我需要做一些特殊的配置来启用复合 ID 吗？我有最新的 FNh（截至 2012 年 6 月 29 日）。

**编辑**

即使我决定映射一个 Id 并引用 2 个事件而不是使用 CompositeId，我仍然认为这个问题是开放的。随意提出答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-11-29T09:03:51.780

我发现这是由于自动映射试图自动映射 ID 即使我的班级有一个实际的地图 - 它仍然试图自动映射 ID。一旦我从自动映射中排除了该类，它就工作得很好。

# gwt - Google Maps API v3 - InfoWindow 中的按钮和文本框？

> ID：11528637
> 
> 赞同：2
> 
> 时间：2012-07-17T18:30:28.460
> 
> 标签：gwt, google-maps-api-3

我正在使用来自[gwt-google-apis](http://code.google.com/p/gwt-google-apis/downloads/detail?name=gwt-maps-3.8.0-pre1.zip&can=2&q=)的新地图 v3 API 。

是否可以从 InfoWindow 内的 GWT 小部件中捕获事件？我错过了什么吗？

上面尝试过的代码（button.addClickHandler），它没有显示警报：

```
 Marker m = Marker.create();
    m.setIcon(MarkerImage.create(icone));
    m.setPosition(LatLng.create(posicao.lat(), posicao.lng()));
    m.setMap(map);

    m.addClickHandler(new ClickHandler() {

        @Override
        public void handle(MouseEvent event) {

            InfoWindow info = InfoWindow.create();

            Button button = new Button("Desativar");
            button.addClickHandler(new com.google.gwt.event.dom.client.ClickHandler() {

                @Override
                public void onClick(ClickEvent event) {
                    Window.alert("click");

                }
            });

            final HTMLPanel html = new HTMLPanel(("<div id='button'></div>"));
            html.add(button, "button");

            info.setContent(html.getElement());
            info.setPosition(posicao);
            info.open(map);

        }
    }); 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T12:57:18.220

问题是小部件之间层次结构破坏的结果，通常的方法是通过附加/分离小部件。您可以通过设置小部件的元素来做到这一点。这也是 Google Maps API 的问题。

这可以通过使用将成为的一部分的假面板来解决`InfoWindow`，因此当您制作`setContent(Widget widget)`假面板时，将更新并且小部件的元素将设置为内容（如前所述）。

请看一下这堂课：

```
public class MyInfoWindow extends InfoWindow {

  static class FakePanel extends ComplexPanel {
    public FakePanel(Widget w) {
      w.removeFromParent();
      getChildren().add(w);
      adopt(w);
    }

    @Override
    public boolean isAttached() {
      return true;
    }

    public void detachWidget() {
      this.remove(0);
    }
  }

  private IsWidget widgetContent = null;

  FakePanel widgetAttacher;

  public MyInfoWindow() {
    super(InfoWindowImpl.impl.construct());
  }

  private void detachWidget() {
    if (this.widgetAttacher != null) {
      this.widgetAttacher.detachWidget();
      this.widgetAttacher = null;
    }
  }

  public void close() {
    super.close();
    detachWidget();
  }

  public void setContent(String content) {
    this.widgetContent = null;
    this.detachWidget();
    super.setContent(content);
  }

  /** */
  public void setContent(Widget value) {
    this.widgetContent = value;
    setContent(value.getElement());

    if (this.widgetAttacher == null) {
      addListener(getJso(), "closeclick", new Runnable() {
        @Override
        public void run() {
          detachWidget();
        }
      });
      this.widgetAttacher = new FakePanel(value);
    } else if (this.widgetAttacher.getWidget(0) != value) {
      this.widgetAttacher.detachWidget();
      this.widgetAttacher = new FakePanel(value);
    }
  }

  private void setContent(Element element) {
    InfoWindowImpl.impl.setContent(getJso(), element);
  }

  public IsWidget getContentWidget() {
    return widgetContent;
  }

  public final native void addListener(JavaScriptObject jso, String whichEvent, Runnable handler)
  /*-{
    var that = jso;
    $wnd.google.maps.event.addListener(jso, whichEvent, function() {
      handler.@java.lang.Runnable::run()();
    });
  }-*/;

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T20:06:14.413

我必须在 InfoWindow 上构建一个包装器才能使其工作。

```
public class NXInfoWindow {

    static class FakePanel extends ComplexPanel {
        public FakePanel(Widget w) {
            w.removeFromParent();
            getChildren().add(w);
            adopt(w);
        }

        @Override
        public boolean isAttached() {
            return true;
        }

        public void detachWidget() {
            this.remove(0);
        }
    }

    private InfoWindow info;

    private IsWidget widgetContent = null;

    private Long id;

    FakePanel widgetAttacher;

    public static NXInfoWindow create(Long id){
        NXInfoWindow myInfo = new NXInfoWindow();
        myInfo.info = InfoWindow.create(); 
        myInfo.id = id;
        return myInfo;
    };

    private void detachWidget() {
        if (this.widgetAttacher != null) {
            this.widgetAttacher.detachWidget();
            this.widgetAttacher = null;
        }
    }

    public void close() {
        info.close();
        detachWidget();
    }

    public void setPosition(LatLng posicao) {
        info.setPosition(posicao);
    }

    public void open(GoogleMap map) {
        info.open(map);
    }

    public void setContent(Widget value) {
        this.widgetContent = value;
        info.setContent(value.getElement());

        if (this.widgetAttacher == null) {
            addListener(info, "closeclick", new Runnable() {
                @Override
                public void run() {
                    detachWidget();
                }
            });
            this.widgetAttacher = new FakePanel(value);
        } else if (this.widgetAttacher.getWidget(0) != value) {
            this.widgetAttacher.detachWidget();
            this.widgetAttacher = new FakePanel(value);
        }
    }

    private void setContent(Element element) {
        this.setContent(element);
    }

    public IsWidget getContentWidget() {
        return widgetContent;
    }

    public final native void addListener(JavaScriptObject jso, String whichEvent, Runnable handler)
    /*-{
        var that = jso;
        $wnd.google.maps.event.addListener(jso, whichEvent, function() {
          handler.@java.lang.Runnable::run()();
        });
      }-*/;
} 
```

# vba - 如何使 vba-word 在 vba-excel 中工作？

> ID：11528639
> 
> 赞同：0
> 
> 时间：2012-07-17T18:30:29.650
> 
> 标签：vba, excel, ms-word

以下两行

```
Dim curTasks As Tasks
Set curTasks = Application.Tasks 
```

获取所有当前任务的列表并像魅力一样工作，`vba-word`但不是`vba-excel`. 有没有办法将它移植到`vba-excel`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T21:00:19.890

正如我在评论中所说，VBA 中的 Excel 对象没有任务的概念。您可以在 Excel 模块中执行以下操作（尽管我仍然不确定您为什么要这样做）：

```
Dim curTasks As Tasks

Dim wrd As Word.Application

Set wrd = CreateObject("Word.Application")

Set curTasks = wrd.Tasks 
```

注意：您必须添加对 Microsoft Word 对象库的引用才能使其正常工作

# java - 使用 jsyntaxpane 的 JEditorPane 语法高亮

> ID：11528645
> 
> 赞同：0
> 
> 时间：2012-07-17T18:30:47.390
> 
> 标签：java, jeditorpane, jsyntaxpane

我的应用程序中有一个 JEditorPane，我正在使用 jsyntaxpane 和以下代码将 java 文件加载到其中，它运行良好：

为了突出

```
jsyntaxpane.DefaultSyntaxKit.initKit();
textarea.setContentType("text/java"); 
```

加载文件

```
int a = filesToCompileList.getSelectedIndex();
FileReader reader = new FileReader(file);
BufferedReader br = new BufferedReader(reader);
textarea.read.read(br, index);
br.close();
textarea.requestFocus(); 
```

但知道我必须改变我加载文件的方式，我目前正在加载文件

```
File file = new File(filePath);
textarea.setPage(file.toURI().toURL()); 
```

这是以我想要的方式加载文件，但不再突出显示 java 文件的文本！有人知道我该如何解决这个问题或让java以不同的方式突出显示吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T18:44:10.110

AFAIK，如果您不实现自己的[jeditorpane](http://docs.oracle.com/javase/6/docs/api/javax/swing/JEditorPane.html)版本，则无法完成。来自 javadoc

> setPage 方法可用于从 URL 初始化组件。在这种情况下，将根据 URL 确定内容类型，并设置为该内容类型注册的 EditorKit。

因此，内容的 mime 类型将继承自 url 的 mime 类型。稍后调用*setContentyType*将不起作用，因为这将更改 jeditorpane 的模型，清理内容。再次来自 Javadoc

> 注意：这具有更改模型的副作用，因为 EditorKit 是特定类型内容建模方式的来源。此方法将导致代表调用者调用 setDocument 以确保内部状态的完整性。

所以你必须继续使用 read 方法。

# svn - 有没有办法在 SVN 中找到尚未合并的更改？

> ID：11528647
> 
> 赞同：2
> 
> 时间：2012-07-17T18:30:49.893
> 
> 标签：svn, tortoisesvn

假设我有一个 SVN 存储库，它有两个分支：v1 和 v2。v2 是几个月前从 v1 分支出来的，两个分支的工作都在推进。对 v1 的任何更改都应该合并到 v2 中，但似乎其中一些已被遗漏。

我知道合并是由 SVN 记录的，因为在 TortoiseSVN 中运行 Show Log 时可以看到信息。那么 SVN（或 TortoiseSVN 客户端）是否提供了一种方式来表示“查看自分支点以来对 v1 的所有签入并找到任何尚未向前合并的内容”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T20:15:38.320

命令行：

> svn mergeinfo 源目标 --show-revs 合格

在 TortoiseSVN 中，您可以在选择要合并的内容时在日志中看到这一点（灰色提交已合并，黑色提交 - 没有）。此外，还有一个用于隐藏合并修订的复选框。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T18:37:33.767

我想你会在[这里](http://tortoisesvn.net/docs/nightly/TortoiseSVN_en/tsvn-dug-diff.html)找到你的答案..

或者你可以使用

```
svn diff http://server/svn/root/source-here@N http://server/svn/root/folder1/source-here@M 
```

这里 N 和 M 是要比较的两个修订版..

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T14:34:00.753

打开`merge`分支上的对话框。然后在合并向导对话框的第二页中，输入来自的 url `trunk`（或用于合并更改的任何 url）。然后单击`show log`按钮。

日志对话框现在以灰色显示您已合并的所有修订，以及尚未合并的黑色修订。

# ios - OpenGL中的平滑颜色混合

> ID：11528650
> 
> 赞同：5
> 
> 时间：2012-07-17T18:31:16.487
> 
> 标签：ios, opengl-es, blending

当一个顶点的纹理与另一个顶点合并时，我试图实现以下混合：

![由FiftyThree在Paper iPad App中绘制的图像](../Images/d220ac5ae04704a084bd19c88acadf13.png)

这是我目前拥有的：

![在此处输入图像描述](../Images/52dfcbb43957fb084678e785e84c6f38.png)

我已启用混合并将混合功能指定为：

```
 glBlendFunc(GL_ONE, GL_ONE_MINUS_SRC_ALPHA); 
```

我可以看到在paper app中绘制的图像是由一个小圆圈组成的，前后融合了相同的纹理，并且对颜色和alpha有一些混合效果。

如何达到预期的效果？

**更新：**

我认为正在发生的是两个纹理的相交区域正在修改 alpha 通道（添加或其他一些自定义函数），而纹理没有在相交区域中绘制。该区域的其余部分绘制了其余的纹理。像这样：

![在此处输入图像描述](../Images/0cba856983fc9350ec0348f9d59c7a1f.png)

不过，我并不完全确定如何达到这个结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T21:33:46.020

您不需要为此进行混合（并且它不会按您想要的方式工作）。

我认为只要您在屏幕空间中定义纹理坐标，两个单独的圆圈之间应该是无缝的。

为此，无需使用通过顶点着色器的纹理坐标，只需使用片段的位置对纹理进行采样，加上或减去一些缩放：

```
float texcoord = gl_FragCoord / vec2(xresolution_in_pixels, yresolution_in_pixels);`
gl_FragColor = glTexture2D(papertexture, texcoord); 
```

如果您无权访问 GLSL，则可以使用模板缓冲区来代替。只需将所有圆圈绘制到模板缓冲区中，将组合区域用作模板蒙版，然后绘制纹理的全屏四边形。颜色将无缝沉积在所有圆圈的结合处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-02T12:23:45.080

您可以通过 alpha 的最大混合来实现此效果。或使用着色器（OpenGL ES 2.0）手动（混合）：

```
#extension GL_EXT_shader_framebuffer_fetch : require
precision highp float;

uniform sampler2D texture;
uniform vec4      color;

varying vec2 texCoords;

void main() {
    float res_a =gl_LastFragData[0].a;
    float a = texture2D(texture, texCoords).a;
    res_a = max(a, res_a);
    gl_FragColor = vec4(color.rgb * res_a, res_a);
} 
```

结果：

![在此处输入图像描述](../Images/b125e87e7de49cb013334ff14d3eed10.png)

# xml - 使用 ant 迭代 int xml 文件

> ID：11528653
> 
> 赞同：1
> 
> 时间：2012-07-17T18:31:26.967
> 
> 标签：xml, parsing, ant

我有一个带有以下结构的 Xml 文件。我想按节点读取节点并使用没有通用分隔符的值调用特定任务。在 Ant 中这可能吗？

```
<projects>
<!-- first node -->
 <project>
    <name> </name>
    <url> </url>
    <package> </package>
 </project>

 <!-- Second node -->
 <project>
    <name> </name>
    <url> </url>
    <package> </package>
 </project>
<projects> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:50:05.180

使用[XSLT](http://ant.apache.org/manual/Tasks/style.html)任务将输入 XML 文件处理为随后执行的 ANT 脚本。

# 例子

```
|-- build.xml
|-- projects-process.xsl
`-- projects.xml 
```

运行会处理中的信息

```
$ ant
Buildfile: /home/mark/tmp/build.xml

run-projects:
     [xslt] Processing /home/mark/tmp/projects.xml to /home/mark/tmp/build-tmp.xml
     [xslt] Loading stylesheet /home/mark/tmp/projects-process.xsl

build:

dosomething:
     [echo] DOSOMETHING: 'Project 1' 'http://someurl1' 'project1'"

dosomething:
     [echo] DOSOMETHING: 'Project 2' 'http://someurl2' 'project2'"

BUILD SUCCESSFUL 
```

## 项目.xml

```
<projects>

    <project>
        <name>Project 1</name>
        <url>http://someurl1</url>
        <package>project1</package>
    </project>

    <project>
        <name>Project 2</name>
        <url>http://someurl2</url>
        <package>project2</package>
    </project>

</projects> 
```

## 项目-process.xsl

此 XSLT 样式表用于生成 ANT 脚本

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <xsl:output method="xml" indent="yes"/>

    <xsl:template match="/">
        <project name="genbuild" default="build">

            <target name="build">
                <xsl:apply-templates select="projects/project"/>
            </target>

            <target name="dosomething">
                <echo>DOSOMETHING: '${name}' '${url}' '${package}'"</echo>
            </target>

        </project>
    </xsl:template>

    <xsl:template match="project">
        <antcall target="dosomething">
            <param name="name"    value="{name}"/>
            <param name="url"     value="{url}"/>
            <param name="package" value="{package}"/>
        </antcall>
    </xsl:template>

</xsl:stylesheet> 
```

## 构建.xml

运行 XSLT 转换以处理**projects.xml**文件并生成 ANT 构建文件

```
<project name="demo" default="run-projects">

    <target name="run-projects">
        <xslt style="projects-process.xsl" in="projects.xml" out="build-tmp.xml"/>

        <ant antfile="build-tmp.xml"/>
    </target>

    <target name="clean">
        <delete file="build-tmp.xml"/>
    </target>

</project> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-19T22:42:56.233

蒂亚戈尔席尔瓦，

使用 xmlproperty 和 javascript 的组合，我能够拆分 projects.xml 文件的多元素（相同节点）并在 ant 中使用项目节点数据字段。所有操作都在单个 ant 文件中执行，一次执行。

上例中的示例数据 projects.xml 文件：

```
<projects>
    <project>
        <name>Project 1</name>
        <url>//someurl1</url>
        <package>project1</package>
    </project>
    <project>
        <name>Project 2</name>
        <url>//someurl2</url>
        <package>project2</package>
    </project>
</projects> 
```

必须转换为以下格式的 projects.xml 文件：

```
<myProjects>
    <!-- name;url;package -->
    <myProject>Project 1;//someurl1;project1</myProject>
    <myProject>Project 2;//someurl2;project2</myProject>
</myProjects> 
```

在这里，先前的节点元素被转换为一个字符串，其中的字段由“;”分隔 特点。

我已将元素“project”重命名为“myProject”以避免混淆，因为我将在 javascript 中使用 ant“project”对象。

一旦我们将可重复的 xml 节点展平为字符串，我们就可以使用以下 ant 脚本来遍历元素，读取展平的属性并根据需要使用它们。

```
<project name="testProjects" default="ProcessProjects" basedir=".">

  <target name="init" >
  <!-- From: http://sourceforge.net/projects/ant-contrib/files/ant-contrib/ 
     download the jar and put it a created "lib" folder of your project, where ant file is.
  -->
    <taskdef resource="net/sf/antcontrib/antlib.xml">
      <classpath><pathelement location="./lib/ant-contrib-1.0b3.jar"/></classpath>
    </taskdef>
    <xmlproperty file="./projects.xml" keepRoot="false"/>

    <!-- Properties will be used to store the values of: name;url;package -->
    <property name="name" value=""/>
    <property name="url" value=""/>
    <property name="package" value=""/>
  </target>

  <target name="ProcessProjects" depends="init">
    <echo>Process Projects</echo>
    <foreach list="${myProject}" target="processLoopStep" param="var1"/>
  </target>

  <target name="processLoopStep" >
    <script language="javascript"> <![CDATA[
      var var1 = project.getProperty("var1");
      var parts = var1.split(";");
      project.setProperty("name",parts[0]);
      project.setProperty("url",parts[1]);
      project.setProperty("package",parts[2]);
      ]]>
    </script>

    <!-- Do what you like with the values of the <project> element -->
    <echo message="myProject name = ${name} url = ${url} package = ${package}"/>
  </target>

</project> 
```

中的文件： - C:\temp\lib\ProcessProjects.xml - 构建 - C:\temp\lib\projects.xml - 数据 - C:\temp\lib\ant-contrib-1.0b3.jar -库罐

输出：

```
C:\temp>ant -f ProcessProjects.xml

Buildfile: C:\temp\ProcessProjects.xml
init:
ProcessProjects:
     [echo] Process Projects
processLoopStep:
     [echo] myProject name = Project 1 url = //someurl1 package = project1
processLoopStep:
     [echo] myProject name = Project 2 url = //someurl2 package = project2
BUILD SUCCESSFUL
Total time: 0 seconds 
```

问候， 尤雷克

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T18:45:54.817

Ant 项目不能嵌套在同一个 Ant 构建文件中。但是，可以使用[MacroDefs](http://ant.apache.org/manual/Tasks/macrodef.html)模块化构建逻辑。此外，子项目可以有自己的构建文件，可以使用[Ant](http://ant.apache.org/manual/Tasks/ant.html) Ant 任务从主构建文件调用。可以使用[AntCall 任务](http://ant.apache.org/manual/Tasks/antcall.html)在同一个构建文件中调用 Ant 目标。

# iis-7 - 找不到经典 asp 站点的包含文件

> ID：11528657
> 
> 赞同：0
> 
> 时间：2012-07-17T18:31:44.317
> 
> 标签：iis-7, asp-classic

我正在尝试在开发环境中设置一个旧的经典 asp 站点时遇到问题。我在包含文件的行中收到以下错误。

> 处理 URL 时服务器发生错误。请联系系统管理员。
> 
> 如果您是系统管理员，请单击此处了解有关此错误的更多信息。

这是我的设置：

*   我在 Win 7 上运行 IIS 7。
*   我有一个`ControlPanel`没有托管代码和经典管道的应用程序池
*   我的网站`ControlPanel`在默认网站下配置，指向我的项目目录“C:\Projects\uk_CP\uk_AU\au”

许多页面都可以工作，我可以登录，单击反馈表的链接，但最终我得到了上述错误。

我的反馈表位于“C:\Projects\uk_CP\uk_Au\au\feedbackform_admin\dataview_master.asp” 它有两个包含文件：

```
<!--#include file="../inc/adovbs.inc" -->
<!--#include file="../inc/incCreateConn.asp" --> 
```

这正确位于“C:\Projects\uk_CP\uk_Au\au\inc\”

也许我的 IIS 配置不正确导致我的工作目录失效？有没有一种有用的方法来解决它正在查看的路径？我已经 10 年没有在经典 asp 领域工作过，我不想成为专家，但我确实需要弄清楚这一点，而且我已经浪费了太多时间。

显然这是我的设置的一个问题，因为它确实在生产中工作......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T18:40:54.880

在您的 ASP 配置中，您必须启用设置“允许父路径”

# java - 扩展 AsyncTask 类的奇怪行为

> ID：11528659
> 
> 赞同：0
> 
> 时间：2012-07-17T18:31:48.423
> 
> 标签：java, android, interface, android-asynctask

我正在使用我自己的扩展 AsyncTasks 的通用抽象类 (MyAsyncTask)，并且需要一种方法来取消所有当前正在运行的 MyAsyncTasks。

```
abstract class MyAsyncTask<Params, Progress, Result> 
         extends AsyncTask<Params, Progress, Result> {
    ...
} 
```

所以我决定将所有任务的引用存储在 WeakHashMap 中。由于 MyAsincTask 是一个泛型类，我不能直接将它用作 HasMaps 键类型。关于存储在这个 HashMap 中的对象，我唯一需要知道的是它们有方法

```
public Boolean cancel(Boolean mayInterruptIfRunning); 
```

我觉得写一个界面是合理的

```
interface Cancelable {
    public Boolean cancel(Boolean mayInterruptIfRunning);
} 
```

并使 MyAsyncTask 实现它：

```
abstract class MyAsyncTask<Params, Progress, Result> 
         extends AsyncTask<Params, Progress, Result> implements Cancelable {

    private static WeakHashMap<Cancelable, Void> taskList = new WeakHashMap<Cancelable, Void>();

    public MyAsyncTask() {
        taskList.add(this, null);
    }

    public static void cancelAll() {
            Iterator<Cancelable> iterator = taskList.keySet().iterator();

            while (iterator.hasNext()) {
                Cancelable task = iterator.next();

                if (task != null) {
                    task.cancel(true);
                    iterator.remove();
                }
            }
    }

    ...

} 
```

令人困惑的部分是，即使 AsyncTask 有一个最终方法 cancel，它在我的接口中完全定义，我仍然必须在我的类中实现它。

```
 public Boolean cancel(Boolean mayInterruptIfRunning) {
            return super.cancel(mayInterruptIfRunning);
    } 
```

现在我的问题是：1）为什么我可以定义这个取消方法，即使超类中有相同的最终方法？2) 哪一个 - 如果我执行 new MyAsyncTask().cancel(); 之类的操作，将执行原始的一个或我的方法；?

我试图在纯 java 中模拟这种情况

```
abstract interface A {
    public Boolean cancel(Boolean a);
}

abstract class B<T> {
    public final Boolean cancel(Boolean a) {
        System.out.println("B.cacncel called");
        return a;
    }
}

abstract class C<T> extends B<T> implements A {}

class D extends C<Void> {}

class TestApp {
    public static void main(String[] args) {
        D x = new D();
        x.cancel(true);
    }
} 
```

但是在这种情况下，我不必在 D 类中实现取消方法，因为它已经在 B 类中实现了。那么，AsyncTask 有什么特别之处，为什么我必须重新实现取消方法？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T18:53:47.133

不，`AsyncTask`虽然`boolean cancel(boolean)`你有`Boolean cancel(Boolean)`

这个类编译得很好

```
public class Test {

    public Boolean d(Boolean v) { return false; }

    public boolean d1(boolean v1) { return true; } 

} 
```

# java - 私有静态最终更改的值

> ID：11528660
> 
> 赞同：-1
> 
> 时间：2012-07-17T18:31:50.060
> 
> 标签：java, static

在过去的几个小时里，我一直对以下内容感到困惑。我有一个分数类，其中零分数有一个常数，如下所示：

```
class Fraction{
    private static final Fraction ZERO = new Fraction(0,1);

    public static Fraction zero(){
        return ZERO;
    }
[etc]
} 
```

随后，我发现 ZERO 的值在执行过程中发生了变化，其中：

```
System.out.println(Fraction.zero());
Fraction half = new Fraction(1, 2);
System.out.println(Fraction.zero()); 
```

输出：

```
1/1
1/2 
```

而显然产生的值应该是 0/1，更重要的是，是固定的。问题绝对不在于 Fraction 类和与之关联的 GCD 计算器的实现，因为我过去曾成功且广泛地使用过它们。

任何关于这种奇怪行为原因的想法和想法都非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T18:33:50.780

您应该向我们展示该类中的其余代码 - 我的猜测是分子和分母变量已被标记为，`static`而它们实际上应该是常规实例变量。

无论问题是什么，`final`字段更改引用的对象的内容都没有错 -`final`修饰符仅确保不能使该字段引用另一个对象。对象本身不受保护。

# android - 如何使用 Android SDK 实现这样的布局？

> ID：11528665
> 
> 赞同：-4
> 
> 时间：2012-07-17T18:32:00.360
> 
> 标签：android, android-layout

我是 android 开发的新手，在使用 ogl、dx、sfml 等 API 进行了几年严格的 C++ 编码之后，我真的对所有这些布局和东西感到头疼。

基本上我问你如何实现以下设置：

![在此处输入图像描述](../Images/0232c2a2e84072d914ef08012e7c35eb.png)

我尝试将一些随机布局放在一起并使用所见即所得编辑器对其进行修复，但这只是让我发疯，我无法让它工作。感觉就像无论我做什么，编辑器的行为都不同。

如果有人能给我一些建议，那就太棒了。

`Activity`顺便说一句，我可以以 [在这种情况下]的形式创建一个称为每一帧的事件吗？[没有游戏循环很糟糕！]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:22:44.493

这只是一个具有垂直方向的 LinearLayout。您的 imageview+textview 本身可能是具有垂直方向的 LinearLayout。

阅读：http: [//developer.android.com/guide/topics/ui/layout/linear.html](http://developer.android.com/guide/topics/ui/layout/linear.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:36:40.527

我更喜欢将所有内容分解为彼此内部的布局。这将是您需要的示例，但是有很多方法可以定义完全相同的事物。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Large Text"
        android:layout_marginTop="20dp"
        android:layout_gravity="center"
        android:textAppearance="?android:attr/textAppearanceLarge" />

    <RelativeLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" 
        >

        <ImageView
            android:id="@+id/imageView1"
            android:layout_width="300dp"
            android:layout_height="300dp"
            android:layout_alignParentTop="true"
            android:layout_centerHorizontal="true"
            android:src="@drawable/icon" />

        <TextView
            android:id="@+id/textView2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Large Text"
            android:layout_centerHorizontal="true"
            android:layout_alignBottom="@+id/imageView1"
            android:textAppearance="?android:attr/textAppearanceLarge" />

    </RelativeLayout>

    <ImageButton
        android:id="@+id/imageButton1"
        android:layout_width="200dp"
        android:layout_height="50dp"
        android:src="@drawable/icon" 
        android:layout_marginTop="50dp"
        android:layout_gravity="center"/>

</LinearLayout> 
```

# java - 新手 JLayeredPane 问题

> ID：11528677
> 
> 赞同：3
> 
> 时间：2012-07-17T18:32:51.557
> 
> 标签：java, swing, jlayeredpane

我只是无法通过 JLayeredPanes 上的第一格。（请参阅我[昨天的原始问题](https://stackoverflow.com/questions/11512411/introducing-jlayeredpane-to-an-existing-jframe)。我一直在研究 JLayeredPane 教程和 API。这些教程与我最终尝试制作的内容有些不同。

回到第一方，我采用了 Oracle 的 JFrame 示例并对其进行了修改以包含分层窗格。

这是代码：

```
package components;

import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

/* FrameDemo.java requires no other files. */
public class FrameDemo {
    /**
     * Create the GUI and show it.  For thread safety,
     * this method should be invoked from the
     * event-dispatching thread.
     */
    private static void createAndShowGUI() {
        //Create and set up the window.
        JFrame frame = new JFrame("FrameDemo");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        JPanel mainLayer = new JPanel(new BorderLayout());
        mainLayer.setPreferredSize(new Dimension(640, 480));
        frame.setContentPane(mainLayer);
        frame.getLayeredPane().add(mainLayer, JLayeredPane.DEFAULT_LAYER, 0);

        JLabel emptyLabel = new JLabel("LABEL");
        emptyLabel.setPreferredSize(new Dimension(320, 240));
        mainLayer.add(emptyLabel, BorderLayout.NORTH);

        JPanel subLayer = new JPanel(new BorderLayout());
        JLabel subLabel = new JLabel("SUBLABEL");
        subLabel.setPreferredSize(new Dimension( 200, 100));
        subLabel.setBackground(Color.YELLOW);
        subLayer.add(subLabel, BorderLayout.SOUTH);
        subLayer.setVisible(true);
        subLabel.setVisible(true);
        frame.getLayeredPane().add(subLayer, JLayeredPane.PALETTE_LAYER, 0);

        //Display the window.
        frame.pack();
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        //Schedule a job for the event-dispatching thread:
        //creating and showing this application's GUI.
        javax.swing.SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                createAndShowGUI();
            }
        });
    }
} 
```

为什么它不起作用？IOW，为什么子标签不显示？它比主层更高。

一个想法是为什么我将 mainLayer 添加到内容窗格和分层窗格中？如果我不这样做，什么都不会出现。即，通过注释掉这一行，我得到一个空白框。

```
//        frame.setContentPane(mainLayer); 
```

显然，我不明白的东西。但它是什么？

我应该补充一点，这个简单的演示可以在没有分层窗格的情况下完成。但我的最终目标是拥有一个可以通过编程方式打开和关闭的层。但我什至无法让这个简单的案例起作用。如果我能克服这个困难，我想剩下的会更容易。

附录：

下面的代码说明了我想要实现的目标，它与下面设置的 TrashGod 非常相似，并且可以正常工作。有一个 JLayeredPane 具有一个常量层（在 Integer(0) 分层）和一个浮动层，最初在 Integer(-1) 分层，但可通过 Integer(-1) 层和 Integer(1) 之间的 F7 和 F8 键击切换层，从而允许它在恒定层之上或之下浮动。

```
package components;

import java.awt.*;
import java.awt.event.*;

import javax.swing.*;

/* MyLayeredPaneDemo.java requires no other files. */
public class MyLayeredPaneDemo {
    private JFrame frame;
    private JLayeredPane mainPanel;
    private JPanel constantLayer;
    private JPanel floatingLayer;
    /**
     * Create the GUI and show it.  For thread safety,
     * this method should be invoked from the
     * event-dispatching thread.
     */
    private MyLayeredPaneDemo() {}
    private void createAndShowGUI() {
        //Create and set up the window.
        this.frame = new JFrame("MyLayeredPaneDemo");
        this.frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        this.frame.setPreferredSize(new Dimension(640, 480));
        mainPanel = new JLayeredPane();
        constantLayer = new JPanel(new BorderLayout(0,0));
        floatingLayer = new JPanel(new BorderLayout(0,0));
//        constantLayer.setPreferredSize();
        constantLayer.setOpaque(true);
        constantLayer.setBackground(Color.BLUE);

        JLabel constantLabel = new JLabel("MAIN LAYER");
        constantLayer.setPreferredSize(new Dimension(640, 480));
        constantLayer.add(constantLabel, BorderLayout.CENTER);

        JLabel subLabel = new JLabel("SUB LAYER");
        floatingLayer.setBackground(Color.YELLOW);
        floatingLayer.add(subLabel, BorderLayout.SOUTH);
        floatingLayer.setOpaque(true);
        floatingLayer.setVisible(true);
        floatingLayer.setVisible(true);
        subLabel.setBackground(Color.YELLOW);

        mainPanel.add(constantLayer, new Integer(0), 0);
        constantLayer.setBounds(0,0,640,480);
        mainPanel.add(floatingLayer, new Integer(-1), 0);
        floatingLayer.setBounds(100, 360, 300, 90 );

        frame.add(mainPanel, BorderLayout.CENTER);

        //Display the window.
        mapKeyToAction(frame.getRootPane(), 
                JComponent.WHEN_ANCESTOR_OF_FOCUSED_COMPONENT,
                KeyStroke.getKeyStroke(KeyEvent.VK_F7, 0),
                "Hide Layer", 
                new AbstractAction() {

                    @Override
                    public void actionPerformed(ActionEvent e) {
                        System.out.println("F7 pressed");
                        mainPanel.setLayer(floatingLayer, new Integer(-1));
                    }       
                }); 
        mapKeyToAction(frame.getRootPane(), 
                JComponent.WHEN_ANCESTOR_OF_FOCUSED_COMPONENT,
                KeyStroke.getKeyStroke(KeyEvent.VK_F8, 0),
                "Show Layer", 
                new AbstractAction() {

                    @Override
                    public void actionPerformed(ActionEvent e) {
                        System.out.println("F8 pressed");
                        mainPanel.setLayer(floatingLayer, new Integer(1));
                    }       
                }); 
        frame.pack();
        frame.setVisible(true);
        frame.getRootPane().setFocusable(true);
        boolean ok = frame.getRootPane().requestFocusInWindow();
        System.out.println("focus ok: " + ok);

    }

    public static void main(String[] args) {
        //Schedule a job for the event-dispatching thread:
        //creating and showing this application's GUI.
        javax.swing.SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                new MyLayeredPaneDemo().createAndShowGUI();
            }
        });
    }

    private static void mapKeyToAction(JComponent component, 
            int whichMap, KeyStroke keystroke,String key, Action action) {
        component.getInputMap(whichMap).put(keystroke, key);
        component.getActionMap().put(key, action);
    }

} 
```

但是，我无法在我的真实案例中使用它。两者之间的区别在于，在这里，我的 JLayeredPane 由 Frame 拥有，而在我的实际应用程序中，我希望 JLayeredPane 由 JPanel 拥有，因为 Frame 包含层次结构中的某些级别，其大小为由其父级中的 GridBagLoyout 设置，因此在调用其构造函数时大小是不可知的，因此很难调用我需要在 JLayeredPane 的子级上执行的 setBounds()。

进一步的附录。我知道 Oracle 教程提到了[将布局而不是绝对定位与 JLayeredPane 一起使用的情况](http://docs.oracle.com/javase/tutorial/displayCode.html?code=http://docs.oracle.com/javase/tutorial/uiswing/examples/components/LayeredPaneDemo2Project/src/components/LayeredPaneDemo2.java)。这种情况和我的不同之处在于，在我的情况下，层在不同层上占据相同的水平空间，而在这种情况下，不同层上的组件占据不同的水平空间。就好像我们需要一个 3D 布局管理器一样！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-18T01:49:58.903

“默认情况下，分层窗格没有布局管理器。”—<a href="http://docs.oracle.com/javase/tutorial/uiswing/components/layeredpane.html" rel="nofollow noreferrer">*如何使用分层窗格*

附录：*我需要避免使用* `Frame`*'s 分层窗格，而是将分层窗格添加到 window*。

是[*的，根窗格*](http://docs.oracle.com/javase/tutorial/uiswing/components/toplevel.html#rootpane)是 的一个实例`JRootPane`，其中包含一个`JLayeredPane`. 特别是，“分层窗格包含菜单栏和内容窗格，并启用其他组件的 Z 排序。”

![在此处输入图像描述](../Images/ba6292318e57c6d41abc931479836477.png)

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class FrameDemo {

    private static void createAndShowGUI() {
        JFrame frame = new JFrame("FrameDemo");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        JLayeredPane mainLayer = new JLayeredPane();
        frame.add(mainLayer, BorderLayout.CENTER);

        JLabel label = new JLabel("LABEL", JLabel.CENTER);
        label.setBounds(100, 100, 200, 100);
        label.setOpaque(true);
        label.setBackground(Color.cyan);
        mainLayer.add(label, 1);

        JPanel subLayer = new JPanel(new BorderLayout());
        JLabel subLabel = new JLabel("SUBLABEL", JLabel.CENTER);
        subLabel.setBounds(20, 20, 200, 100);
        subLabel.setOpaque(true);
        subLabel.setBackground(Color.yellow);
        subLayer.add(subLabel, BorderLayout.SOUTH);
        mainLayer.add(subLabel, 2);

        frame.pack();
        frame.setSize(320, 240);
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        javax.swing.SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                createAndShowGUI();
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T02:06:17.183

我提出的解决方案要感谢垃圾神，我希望这也是一个很好的建议，即实现 ComponentListener 并捕获组件调整大小事件。此时，您可以获得容器的实际边界并使用它来设置 JPanel 层的实际边界，这些边界始终与包含它们的组件的边界保持某种固定关系。有用。

我相信 Trashgod 的解决方案也会起作用，但我还没有尝试过。

# c# - 迭代 Linqdatasource 返回的对象

> ID：11528681
> 
> 赞同：1
> 
> 时间：2012-07-17T18:32:57.480
> 
> 标签：c#, casting, iteration, linqdatasource

我有一个 GridView，带有过滤和分页（一次 10 个），绑定到 Linqdatasource。这一切都有效。

但是，在完成所有行的检索后，如何获取在 LinqDataSource 中检索到的所有数据的 Id？

我有这个方法，e.Result 是一个对象数据类型，包含这个网格的 List

```
protected void LinqDataSource_Selected(object sender, LinqDataSourceStatusEventArgs e)  // event fires after data retrieval complete.
{
    List<int> ids = new List<int>();
    if (e.TotalRowCount > 0)
    {
        for (int idx = 0; idx < e.TotalRowCount; idx++)
        {
            Foo foo = (Foo)(e.Result[idx]);  // error cannot apply indexing to expression of type object
            ids.Add(foo.Id);
        }
    }
} 
```

我的错误是迭代一个对象，怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:42:34.683

`e.Result`是`object`，因此您需要将其转换为 List 类型才能应用索引：

```
Foo foo = ((List<Foo>)(e.Result))[idx]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T18:41:42.383

你可以这样做：

```
protected void LinqDataSource_Selected(object sender, LinqDataSourceStatusEventArgs e)  // event fires after data retrieval complete.
{
    List<int> ids = new List<int>();
    if (e.TotalRowCount > 0)
    {
        List<Foo> fooList = ((IEnumerable)e.Result).ToList();
        for (int idx = 0; idx < fooList.Count; idx++)
        {
            Foo foo = fooList[idx];
            ids.Add(foo.Id);
        }
    }
} 
```

或者

```
protected void LinqDataSource_Selected(object sender, LinqDataSourceStatusEventArgs e)  // event fires after data retrieval complete.
{
    List<int> ids = new List<int>();
    if (e.TotalRowCount > 0)
    {
        foreach(Foo foo in (IEnumerable)e.Result)
        {
            ids.Add(foo.Id);
        }
    }
} 
```

如果您的 Selected 是过滤视图的结果，则 e.Result 将是匿名类型的 IEnumerable，因此获取信息很可能需要使用 IQueryable 和 viewmodel 对象。

# python - 在python中，如何计算函数中满足条件的次数？

> ID：11528682
> 
> 赞同：3
> 
> 时间：2012-07-17T18:32:57.573
> 
> 标签：python

一般来说，我对编程很陌生，虽然我确信这看起来像是家庭作业，但它可能是给某人的，但我正在自学，所以这是“自学作业”？

无论如何，我想计算一只乌龟在随机形成正方形时离开窗户的次数。我还想在它退出屏幕的每个点上放一个点，但这只是为了我自己的乐趣。

我知道我每次都设置为 0，但我无法弄清楚如何在这样的函数中创建一个累加器模式（如果这是正确的做法），它已经必须返回一个值。

这是我的代码：

```
import random
import turtle

def isInScreen(w,t):

    leftBound = - w.window_width()/2
    rightBound = w.window_width()/2
    topBound = w.window_height()/2
    bottomBound = -w.window_height()/2

    turtleX = t.xcor()
    turtleY = t.ycor()

    stillIn = True
    outs = 0

    if turtleX > rightBound or turtleX < leftBound:
        t.dot()
        t.right(180)
        t.forward(50)
        outs += 1
        print(outs)
        return outs

    if turtleY > topBound or turtleY < bottomBound:
        t.dot()
        t.right(180)
        t.forward(50)
        outs += 1
        print(outs)
        return outs

    if outs == 4:
        stillIn = False

    return stillIn

t = turtle.Turtle()
wn = turtle.Screen()

t.shape('turtle')
while isInScreen(wn,t):
    coin = random.randrange(0,2)
    if coin == 0:
        t.left(90)
    else:
        t.right(90)

    t.forward(50)

wn.exitonclick() 
```

任何意见，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T18:45:59.283

最简单的方法是跟踪你的海龟在你的函数之外但在你的`while`循环内部离开屏幕的次数。

不要让你的函数返回乌龟是否已经出去了四次，如果它在那一步出去了就让它返回。你必须改变你的功能看起来像：

```
def isScreen(w, t):
    if turtleX > rightBound or turtleX < leftBound:
        return True
    if turtleY > topBound or turtleY < bottomBound:
        return True
    else:
        return False 
```

然后，您可以跟踪您在`while`循环中退出了多少次：

```
outs = 0
while outs < 4:
    if isScreen:
        outs += 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T20:43:09.487

将引用特定事物的变量放入类中怎么样？

```
class MyTurtle(object):

    def __init__(self):
        self.outs = 0

    def isInScreen(self, w, t):
        leftBound = - w.window_width()/2
        rightBound = w.window_width()/2
        topBound = w.window_height()/2
        bottomBound = -w.window_height()/2

        turtleX = t.xcor()
        turtleY = t.ycor()

        stillIn = True

        if turtleX > rightBound or turtleX < leftBound:
            t.dot()
            t.right(180)
            t.forward(50)
            self.outs += 1
            print(self.outs)
            return outs

        if turtleY > topBound or turtleY < bottomBound:
            t.dot()
            t.right(180)
            t.forward(50)
            self.outs += 1
            print(self.outs)
            return outs

        if self.outs == 4:
            stillIn = False

        # for some reason i think this line was missing
        return stillIn
        # or this 
        return outs

t = turtle.Turtle()
wn = turtle.Screen()

myThing = MyTurtle()
t.shape('turtle')

# now you know WHAT is located "in screen"
# and you could now have lots of turtlely
# things running off the screen too with a
# little modification where each "myturtle"
# keeps track of its own "outs"

while myThing.isInScreen(wn, t):
    coin = random.randrange(0,2)
    if coin == 0:
        t.left(90)
    else:
        t.right(90)
    t.forward(50)
wn.exitonclick() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T19:08:26.347

一种方法是只创建`outs`一个全局变量（不推荐）：

```
outs = 0
def isInScreen(w,t):
    ... 
```

一个稍微好一点的封装方式`outs`是让它成为函数本身的一个属性。这样，它的行为有点像全局变量。

```
def isInScreen(w,t):

    leftBound = - w.window_width()/2
    rightBound = w.window_width()/2
    topBound = w.window_height()/2
    bottomBound = -w.window_height()/2

    turtleX = t.xcor()
    turtleY = t.ycor()

    stillIn = True

    if turtleX > rightBound or turtleX < leftBound:
        t.dot()
        t.right(180)
        t.forward(50)
        isInScreen.outs += 1
        print(isInScreen.outs)
        return isInScreen.outs

     # rest of the function

isInScreen.outs = 0 
```

基本上，您替换`outs`整个`isInScreen.outs`函数体，然后在定义函数后对其进行初始化。（不幸的是，你不能初始化函数内部的值，或者每次调用它时它都会被重置。）

请注意，这不是一个常见的习语。大多数时候，您将拥有一个具有`outs`属性的类和`isInScreen`一个更新属性的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T18:37:50.180

您可以返回一个列表对象，该对象具有“stillIn”值以及累加器的值。

# php - MySQL 查询仅收到 1 个结果

> ID：11528683
> 
> 赞同：0
> 
> 时间：2012-07-17T18:33:00.093
> 
> 标签：php, mysql

我有以下代码，它只显示 1 个结果。但是，我的数据库中有六行 product_id = '1'。我说的是`$order`，只有一个出现，而不是六个。怎么了？

```
$get = "SELECT * FROM artikelbestelling WHERE product_id = '1' LIMIT 0, 500";
$doget = mysql_query($get) or die(mysql_error());

while($row = mysql_fetch_assoc($doget))
{
$order = $row['ordernummer'];
$artikel = $row['artikelnummer'];
echo "<strong>$order</strong><br />";
} 
```

我的数据库结构：

id (primary & autoincrement)(int 11)

product_id (int 11)

数字（整数 11）

订单号（int 11）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:44:15.553

因为你的 id 是 int，所以你不需要使用 ''

```
$get = "SELECT * FROM artikelbestelling WHERE product_id = '1' LIMIT 0, 500";
$doget = mysql_query($get) or die(mysql_error());

while($row = mysql_fetch_array($doget))
{
$order = $row['ordernummer'];
$artikel = $row['artikelnummer'];
echo "<strong>$order</strong><br />";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T18:39:40.230

我立即注意到有两件事*不应该*有所作为，但可能值得一试，看看是否有影响。首先，假设 product_id 列是数字列而不是字符串，请尝试仅使用 1 而不是 '1'。其次，明确检查`mysql_fetch_assoc()`FALSE 的结果，而不是任何可能等于 false 的表达式。

```
$get = "SELECT * FROM artikelbestelling WHERE product_id = 1 LIMIT 0, 500";
$doget = mysql_query($get) or die(mysql_error());

while(($row = mysql_fetch_assoc($doget)) !== FALSE)
{
    $order = $row['ordernummer'];
    $artikel = $row['artikelnummer'];
    echo "<strong>$order</strong><br />";
} 
```

**编辑：**

如果您将代码更改为以下内容，您会得到什么？

```
$get = "SELECT * FROM artikelbestelling WHERE product_id = 1 LIMIT 0, 500";
$doget = mysql_query($get) or die(mysql_error());

$index = 0;
while(($row = mysql_fetch_assoc($doget)) !== FALSE)
{
    $order = $row['ordernummer'];
    $artikel = $row['artikelnummer'];
    echo $index++ . ": <strong>$order</strong><br />";
} 
```

具体来说，它是从 0 一直计数到 7，还是只显示第 0 行？我认为它必须是以下之一：

*   你真的只得到一行结果（这与你`mysql_num_rows()`返回 8 的语句相矛盾），
*   `mysql_fetch_assoc()`仅在一行之后错误地返回 FALSE（这表示某种影响 PHP 或 MySQL 驱动程序的错误，这通常不太可能），或者
*   它正在按应有的方式遍历循环，但是根据 Marc B 关于空标签的评论，您误解了结果。

这可能有效地帮助缩小范围。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T19:10:01.450

尝试这个.....

```
$get = "SELECT * FROM artikelbestelling WHERE product_id = '1'  
LIMIT 0, 500";
$doget = mysql_query($get) or die(mysql_error());

while($row = mysql_fetch_array($doget))
{
echo "$row[ordernummer]";
echo "<br />";
echo "$row[artikelnummer]";
} 
```

# c++ - C++ pthread 成员函数

> ID：11528684
> 
> 赞同：1
> 
> 时间：2012-07-17T18:33:04.410
> 
> 标签：c++, g++, pthreads, member-functions

> **可能重复：**
> [类中的 pthread 函数](https://stackoverflow.com/questions/1151582/pthread-function-from-a-class)

由于以下行，我有无法编译的代码`pthread_create`：

```
void* gtk_functor::_threaded_run(void* win)
{
    Gtk::Window* w = static_cast<Gtk::Window*>(win);
    Gtk::Main::run(*w);
    delete w;
}

void gtk_functor::operator ()(Gtk::Window& win, bool threaded)
{
    if (threaded)
    {
        pthread_t t_num;
        pthread_create(&t_num, NULL, (void* (*)(void*))&gtk_functor::_threaded_run, static_cast<void*>(&win));
    }
    else
    {
        Gtk::Main::run(win);
    }
} 
```

这个 gcc 行：

`g++ -o main 'pkg-config --cflags --libs sqlite3 gtkmm-3.0' -lpthread main.cpp`

最后用这个输出编译：

```
code/ui.cpp: In member function 'void ui::gtk_functor::operator()(Gtk::Window&, bool)':
code/ui.cpp:45:65: warning: converting from 'void* (ui::gtk_functor::*)(void*)' to 'void* (*)(void*)' [-Wpmf-conversions] 
```

显然代码无法正常工作，我在引发`sementation fault`时得到。`if (threaded)`

我知道它的演员阵容，但我不知道将成员函数传递给 pthread_create 的正确形式。有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T18:42:50.450

尝试制作`_threaded_run`静态。在标题中：

```
private:
  static void* _threaded_run(void*); 
```

在实施中：

```
void* gtk_functor::_threaded_run(void* win) {
  Gtk::Window* w = static_cast<Gtk::Window*>(win);
  Gtk::Main::run(*w);
  delete w;
} 
```

然后在创建线程时：

```
pthread_create(&t_num, NULL, &gtk_functor::_threaded_run, static_cast<void*>(&win)); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-17T18:37:45.117

正如@ildjarn 建议的那样，只需创建一个免费功能：

```
void * threaded_run(void * win)
{
    Gtk::Window * const w = static_cast<Gtk::Window*>(win);
    Gtk::Main::run(*w);
    delete w;
}

// ...

pthread_create(&t_num, NULL, threaded_run, &win); 
```

由于该函数不依赖于任何特定`gtk_functor`对象的状态，因此将其设为成员函数是没有意义的。

* * *

在一个假设的不同世界中，您确实*希望*在单独的线程中调用对象的成员函数，您需要以某种方式传递对象的对象引用，通常通过参数 void 指针：

```
struct Foo
{
    void * run() { /* ... use state ... */ }

    /* ... state ... */
};

Foo x;
pthread_t pt;

// start a new execution context with x.run():
pthread_create(&pt, NULL, FooInvoker, &x);

extern "C" void * FooInvoker(void * p)
{
    return static_cast<Foo*>(p)->run();
} 
```

事实上，您甚至可能希望将更多上下文信息打包到某个辅助结构中，并将指向该结构的 void 指针传递*给*线程调用函数。

# jquery - jquery datepicker的背景颜色被覆盖

> ID：11528686
> 
> 赞同：0
> 
> 时间：2012-07-17T18:33:26.860
> 
> 标签：jquery, html, css, datepicker

我正在尝试更改 jquery datepicker 组件的背景颜色。我已经将 css 放在了我的 css 文件中，但是设置的值被覆盖了。

我已将以下代码放在我的 css 文件中：

```
.ui-datepicker-week-end a  {    
background-image: none;
background-color: #EFE584;
 } 
```

看一下代码：http: [//jsfiddle.net/dvjWk/](http://jsfiddle.net/dvjWk/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T18:37:43.143

使用 firebug 进行的快速检查显示，锚元素已分配了“.ui-state-default”类，因此样式被 .ui-state-default 覆盖，因为这更具体。

使 css 选择器更具体

```
.ui-datepicker-week-end a.ui-state-default  {    
 background-image: none;
 background-color: #EFE584;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T18:37:29.350

自定义 JQuery-UI 元素外观的最佳方法是根据您的需要下载自定义版本：

[http://jqueryui.com/download](http://jqueryui.com/download)

请参阅右侧的“主题”配置。

# python - Django nonrel 开发服务器不导入 amazon.api

> ID：11528690
> 
> 赞同：0
> 
> 时间：2012-07-17T18:33:37.517
> 
> 标签：python, django, django-nonrel

我对 Django nonrel 的开发服务器有一个奇怪的问题：

我已经安装了[Amazon Simple Product API](https://github.com/yoavaviram/python-amazon-simple-product-api/ "亚马逊简单产品 API")，它在 shell 中运行良好，我可以在那里导入它，其他一切似乎都运行良好。但是当我尝试将其导入我的网站时，我得到了这个：

```
ImportError at /
No module named amazon.apiRequest Method:   GET
Request URL:    http://127.0.0.1:8000/
Django Version: 1.3
Exception Type: ImportError
Exception Value:    No module named amazon.api
Exception Location: /Users/Paulius/Desktop/Django-nonrel/projects/sort/phone/functions.py in <module>, line 3
Python Executable:  /opt/local/Library/Frameworks/Python.framework/Versions/2.7/Resources/Python.app/Contents/MacOS/Python
Python Version: 2.7.2
Python Path:    ['/Users/Paulius/Desktop/Django-nonrel/projects/sort',
 '/Users/Paulius/Desktop/Django-nonrel/projects/sort/djangoappengine/lib',
 '/usr/local/google_appengine',
 '/usr/local/google_appengine/lib/antlr3',
 '/usr/local/google_appengine/lib/enum',
 '/usr/local/google_appengine/lib/fancy_urllib',
 '/usr/local/google_appengine/lib/graphy',
 '/usr/local/google_appengine/lib/grizzled',
 '/usr/local/google_appengine/lib/httplib2',
 '/usr/local/google_appengine/lib/ipaddr',
 '/usr/local/google_appengine/lib/jinja2',
 '/usr/local/google_appengine/lib/markupsafe',
 '/usr/local/google_appengine/lib/oauth2',
 '/usr/local/google_appengine/lib/prettytable',
 '/usr/local/google_appengine/lib/protorpc',
 '/usr/local/google_appengine/lib/simplejson',
 '/usr/local/google_appengine/lib/sqlcmd',
 '/usr/local/google_appengine/lib/webapp2',
 '/usr/local/google_appengine/lib/webob',
 '/usr/local/google_appengine/lib/yaml/lib',
 '/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django_cms-2.2-py2.7.egg',
 '/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django_sekizai-0.5-py2.7.egg',
 '/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django_mptt-0.5.2-py2.7.egg',
 '/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/html5lib-0.95-py2.7.egg',
 '/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/South-0.7.4-py2.7.egg',
 '/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django_classy_tags-0.3.4.1-py2.7.egg',
 '/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django_floppyforms-0.4.7-py2.7.egg',
 '/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pygeoip-0.2.3-py2.7.egg',
 '/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/six-1.1.0-py2.7.egg',
 '/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/distribute-0.6.27-py2.7.egg',
 '/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/bottlenose-0.4.0-py2.7.egg',
 '/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/python_amazon_simple_product_api-1.1.0-py2.7.egg',
 '/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python27.zip',
 '/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7',
 '/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-darwin',
 '/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac',
 '/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac/lib-scriptpackages',
 '/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-tk',
 '/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-old',
 '/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-dynload',
 '/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages',
 '/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/PIL']
Server time:    Tue, 17 Jul 2012 18:11:04 +0000 
```

我使用相同的 python 版本来运行服务器和 shell，我不知道出了什么问题。

**追溯：**

```
Environment:

Request Method: GET
Request URL: http://127.0.0.1:8000/

Django Version: 1.3
Python Version: 2.7.2
Installed Applications:
['django.contrib.contenttypes',
 'django.contrib.auth',
 'django.contrib.sessions',
 'django.contrib.messages',
 'django.contrib.staticfiles',
 'django.contrib.admin',
 'phone',
 'django.contrib.admindocs',
 'djangotoolbox',
 'autoload',
 'dbindexer',
 'djangoappengine']
Installed Middleware:
('autoload.middleware.AutoloadMiddleware',
 'django.contrib.sessions.middleware.SessionMiddleware',
 'django.middleware.csrf.CsrfViewMiddleware',
 'django.contrib.messages.middleware.MessageMiddleware',
 'django.middleware.common.CommonMiddleware',
 'django.contrib.auth.middleware.AuthenticationMiddleware')

Traceback:
File "/Users/Paulius/Desktop/Django-nonrel/projects/sort/django/core/handlers/base.py" in get_response
  101\.                             request.path_info)
File "/Users/Paulius/Desktop/Django-nonrel/projects/sort/django/core/urlresolvers.py" in resolve
  250\.             for pattern in self.url_patterns:
File "/Users/Paulius/Desktop/Django-nonrel/projects/sort/django/core/urlresolvers.py" in _get_url_patterns
  279\.         patterns = getattr(self.urlconf_module, "urlpatterns", self.urlconf_module)
File "/Users/Paulius/Desktop/Django-nonrel/projects/sort/django/core/urlresolvers.py" in _get_urlconf_module
  274\.             self._urlconf_module = import_module(self.urlconf_name)
File "/Users/Paulius/Desktop/Django-nonrel/projects/sort/django/utils/importlib.py" in import_module
  35\.     __import__(name)
File "/usr/local/google_appengine/google/appengine/tools/dev_appserver_import_hook.py" in Decorate
  676\.       return func(self, *args, **kwargs)
File "/usr/local/google_appengine/google/appengine/tools/dev_appserver_import_hook.py" in load_module
  1845\.     return self.FindAndLoadModule(submodule, fullname, search_path)
File "/usr/local/google_appengine/google/appengine/tools/dev_appserver_import_hook.py" in Decorate
  676\.       return func(self, *args, **kwargs)
File "/usr/local/google_appengine/google/appengine/tools/dev_appserver_import_hook.py" in FindAndLoadModule
  1717\.                                          description)
File "/usr/local/google_appengine/google/appengine/tools/dev_appserver_import_hook.py" in Decorate
  676\.       return func(self, *args, **kwargs)
File "/usr/local/google_appengine/google/appengine/tools/dev_appserver_import_hook.py" in LoadModuleRestricted
  1660\.                                      description)
File "/Users/Paulius/Desktop/Django-nonrel/projects/sort/urls.py" in <module>
  2\. from phone.views import *
File "/usr/local/google_appengine/google/appengine/tools/dev_appserver_import_hook.py" in Decorate
  676\.       return func(self, *args, **kwargs)
File "/usr/local/google_appengine/google/appengine/tools/dev_appserver_import_hook.py" in load_module
  1845\.     return self.FindAndLoadModule(submodule, fullname, search_path)
File "/usr/local/google_appengine/google/appengine/tools/dev_appserver_import_hook.py" in Decorate
  676\.       return func(self, *args, **kwargs)
File "/usr/local/google_appengine/google/appengine/tools/dev_appserver_import_hook.py" in FindAndLoadModule
  1717\.                                          description)
File "/usr/local/google_appengine/google/appengine/tools/dev_appserver_import_hook.py" in Decorate
  676\.       return func(self, *args, **kwargs)
File "/usr/local/google_appengine/google/appengine/tools/dev_appserver_import_hook.py" in LoadModuleRestricted
  1660\.                                      description)
File "/Users/Paulius/Desktop/Django-nonrel/projects/sort/phone/views.py" in <module>
  9\. from functions import *
File "/usr/local/google_appengine/google/appengine/tools/dev_appserver_import_hook.py" in Decorate
  676\.       return func(self, *args, **kwargs)
File "/usr/local/google_appengine/google/appengine/tools/dev_appserver_import_hook.py" in load_module
  1845\.     return self.FindAndLoadModule(submodule, fullname, search_path)
File "/usr/local/google_appengine/google/appengine/tools/dev_appserver_import_hook.py" in Decorate
  676\.       return func(self, *args, **kwargs)
File "/usr/local/google_appengine/google/appengine/tools/dev_appserver_import_hook.py" in FindAndLoadModule
  1717\.                                          description)
File "/usr/local/google_appengine/google/appengine/tools/dev_appserver_import_hook.py" in Decorate
  676\.       return func(self, *args, **kwargs)
File "/usr/local/google_appengine/google/appengine/tools/dev_appserver_import_hook.py" in LoadModuleRestricted
  1660\.                                      description)
File "/Users/Paulius/Desktop/Django-nonrel/projects/sort/phone/functions.py" in <module>
  3\. from amazon.api import AmazonAPI

Exception Type: ImportError at /
Exception Value: No module named amazon.api 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:47:21.647

dev_appserever 会修改环境，因此您不会以在将项目部署到 App Engine 时不可用的方式包含库。

您必须将库放在您的实际项目文件夹中，或者至少从项目文件夹中软链接到它。

# javascript - 代码在 shell 中运行，但从文件运行时出现“找不到变量”错误

> ID：11528691
> 
> 赞同：0
> 
> 时间：2012-07-17T18:33:41.730
> 
> 标签：javascript, python, webkit, svg, gtk

我正在使用[这个人的代码](https://bitbucket.org/cuu508/hxm-t)来创建一个表盘，显示一个馈给它的值。

当我将每一行复制到 Python shell 时，它运行良好。所以我认为是时候为它添加更多功能了。但是当从文件运行时，在 shell 中工作的 VERY SAME 代码不起作用。它为变量“showHr”提供“找不到变量”错误

代码是：

```
import os

import gobject
import gtk
import pygtk
import sys
import webkit
pygtk.require('2.0')

URL = "/home/antimony/Oscillator Code/dials2-js.svg"
gobject.threads_init()
window = gtk.Window(gtk.WINDOW_TOPLEVEL)
window.set_resizable(True)
window.connect("destroy", lambda window, event: gtk.main_quit())
web_view = webkit.WebView()
web_view.open(URL)

vbox = gtk.VBox(False, 0)
vbox.add(web_view)
window.add(vbox)
window.show_all()
hr1  = 23000/(1*500)
web_view.execute_script("showHr(%d)" % hr1)
gtk.main() 
```

它本质上所做的是将 hr1 的值提供给 showHr ，这是 SVG 文件中的一个函数。

功能是：

```
function showHr(newBpm) {
    bpmTarget = newBpm;
} 
```

我对 SVG 的线索为零，所以我不知道哪里出了问题，也不知道是 SVG 文件的问题还是什么。为什么它在shell中运行时找不到'showHr'？:S

**更新 1** - 我对另一个程序有同样的问题。这次使用 PyQt4。那么问题可能与代码无关。我的 Python shell 有问题吗？如果是这样，谁能告诉我如何解决它？——好的，这已经解决了。我可能做了一些非常愚蠢的事情，比如运行一个不同的文件或其他东西，因为当我在一段时间后尝试它时它起作用了。我不知道我做错了什么。

**但是之前的问题仍然存在，我需要帮助！**

**更新 2** - 似乎有错误的代码行是：

```
web_view.execute_script("showHr(%d)" % hr1) 
```

我知道要在 Javascript 中调用函数，您可以将其写为“showHr(150);” （实际上这个调用在 SVG 文件中调用时有效）。即使将代码修改为现在阅读

```
web_view.execute_script("showHr(%d);" % hr1) 
```

它不起作用。它仍然给出相同的错误：

```
Message: console message: undefined @0: ReferenceError: Can't find variable: showHr 
```

无论如何将它指向那个SVG文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T04:40:47.187

我不能告诉你为什么，但我自己也遇到了类似的问题。稍作修改后，我发现：

```
web_view.execute_script("'showHr(%d)'" % hr1) 
```

# excel - 在 VBA 中逐行读取/解析文本文件

> ID：11528694
> 
> 赞同：62
> 
> 时间：2012-07-17T18:33:54.987
> 
> 标签：excel, vba

我正在尝试使用 VBA 解析文本文档并返回文本文件中给出的路径。例如，文本文件如下所示：

```
*Blah blah instructions
*Blah blah instructions on line 2
G:\\Folder\...\data.xls
D:\\AnotherFolder\...\moredata.xls 
```

我希望 VBA 一次加载 1 行，如果它以 a 开头，`*`则移至下一行（类似于被注释的那一行）。对于具有文件路径的行，我想将该路径写入单元格，例如`A2`第一个路径、`B2`下一个路径等。

我希望回答的主要问题是：

1.  使用 VBA 读取文本文件的最佳/简单方法是什么？
2.  我怎样才能逐行做到这一点？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2012-07-17T18:48:56.800

对于文本文件的最基本读取，请使用`open`

例子：

```
Dim FileNum As Integer
Dim DataLine As String

FileNum = FreeFile()
Open "Filename" For Input As #FileNum

While Not EOF(FileNum)
    Line Input #FileNum, DataLine ' read in data 1 line at a time
    ' decide what to do with dataline, 
    ' depending on what processing you need to do for each case
Wend 
```

#Author note - 请停止添加`close #FileNum`- 它已在评论中解决，不需要作为对此答案的改进

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2012-07-17T19:59:02.453

我发现带有 TxtStream 的 FileSystemObject 是读取文件的最简单方法

```
Dim fso As FileSystemObject: Set fso = New FileSystemObject
Set txtStream = fso.OpenTextFile(filePath, ForReading, False) 
```

然后有了这个`txtStream`对象，你就拥有了智能感知的各种工具（与使用该`FreeFile()`方法不同），因此猜测工作更少。另外，您不必分配 FreeFile 并希望它实际上仍然是免费的，因为您分配了它。

您可以读取如下文件：

```
Do While Not txtStream.AtEndOfStream
    txtStream.ReadLine
Loop
txtStream.Close 
```

注意：这需要参考 Microsoft Scripting Runtime。

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2012-07-18T13:06:39.637

为了完整性；处理加载到内存中的数据；

```
dim hf As integer: hf = freefile
dim lines() as string, i as long

open "c:\bla\bla.bla" for input as #hf
    lines = Split(input$(LOF(hf), #hf), vbnewline)
close #hf

for i = 0 to ubound(lines)
    debug.? "Line"; i; "="; lines(i)
next 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-26T17:09:02.070

您可以使用此代码在文本文件中逐行读取，还可以检查第一个字符是否为“*”，然后您可以保留它..

```
Public Sub Test()

    Dim ReadData as String

    Open "C:\satheesh\myfile\file.txt" For Input As #1

    Do Until EOF(1) 
       Line Input #1, ReadData 'Adding Line to read the whole line, not only first 128 positions
    If Not Left(ReadData, 1) = "*" then
       '' you can write the variable ReadData into the database or file
    End If 

    Loop

    Close #1

End Sub 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2019-11-14T07:39:43.837

下面是我从读取文本文件到 excel 文件的代码。

```
Sub openteatfile()
Dim i As Long, j As Long
Dim filepath As String
filepath = "C:\Users\TarunReddyNuthula\Desktop\sample.ctxt"
ThisWorkbook.Worksheets("Sheet4").Range("Al:L20").ClearContents
Open filepath For Input As #1
i = l
Do Until EOF(1)
Line Input #1, linefromfile
lineitems = Split(linefromfile, "|")
        For j = LBound(lineitems) To UBound(lineitems)
            ThisWorkbook.Worksheets("Sheet4").Cells(i, j + 1).value = lineitems(j)
        Next j
    i = i + 1 
Loop
Close #1
End Sub 
```

# c# - MemoryStream 返回时禁用读取

> ID：11528697
> 
> 赞同：9
> 
> 时间：2012-07-17T18:34:21.230
> 
> 标签：c#, stream, memorystream

在我的程序中，我基本上是在读取一个文件，对其进行一些处理，然后将其作为内存流传递回主程序，这将由流读取器处理。这一切都将由我的主要课程旁边的一个班级处理。

问题是，当我从另一个类中的方法返回内存流时，“canread”变量设置为 false，从而导致流读取器初始化失败。

下面是发生问题的示例（尽管在这里我正在写入另一个类中的内存流，但是当我将其传回时它仍然会导致相同的错误。

在名为“Otherclass”的类中：

```
public static MemoryStream ImportantStreamManipulator()
{
   MemoryStream MemStream = new MemoryStream();

   StreamWriter writer = new StreamWriter(MemStream);
   using (writer)
   {
       //Code that writes stuff to the memorystream via streamwriter

       return MemStream;
   }
} 
```

主程序中的函数调用：

```
MemoryStream MStream = Otherclass.ImportantStreamManipulator();
StreamReader reader = new StreamReader(MStream); 
```

当我在“return MemStream”上放置断点时，“CanRead”属性仍然设置为 true。一旦我执行到返回主函数并将返回值写入 MStream 的步骤，“CanRead”属性将设置为 false。然后这会导致 StreamReader 中出现异常，指出无法读取 MStream（如属性所示）。数据应该在流缓冲区中，但我就是无法将其取出。

如何设置它以便“CanRead”在返回到我的主目录后报告为真？还是我误解了 MemoryStream 的工作原理以及我将如何完成我想做的事情？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-07-17T18:38:41.027

这就是问题：

```
using (writer)
{
    //Code that writes stuff to the memorystream via streamwriter

    return MemStream;
} 
```

您正在关闭作者，这将关闭`MemoryStream`. 在这种情况下，您不想这样做……尽管您确实需要*刷新*writer，然后倒带`MemoryStream`. 只需将您的代码更改为：

```
public static MemoryStream ImportantStreamManipulator()
{
   // Probably add a comment here stating that the lack of using statements
   // is deliberate.
   MemoryStream stream = new MemoryStream();

   StreamWriter writer = new StreamWriter(stream);
   // Code that writes stuff to the memorystream via streamwriter

   writer.Flush();
   stream.Position = 0;
   return stream;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T18:38:38.163

获得内存流的`StreamWriter`所有权，当`using`语句结束时，`MemoryStream`也关闭。

请参阅[是否有任何方法可以在不关闭其 BaseStream 的情况下关闭 StreamWriter？](https://stackoverflow.com/questions/2666888/is-there-any-way-to-close-a-streamwriter-without-closing-its-basestream).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T19:12:16.503

正如其他人所说，问题在于 StreamWriter 关闭时 Stream 关​​闭。处理此问题的一种可能方法是返回字节数组而不是 MemoryStream。这避免了垃圾收集器必须处理的可能长时间运行的对象。

```
public static void Main()
{
    OutputData(GetData());
}

public static byte[] GetData()
{
    byte[] binaryData = null;

    using (MemoryStream ms = new MemoryStream())
    using (StreamWriter sw = new StreamWriter(ms))
    {
        string data = "My test data is really great!";

        sw.Write(data);
        sw.Flush();

        binaryData = ms.ToArray();
    }

    return binaryData;
}

public static void OutputData(byte[] binaryData)
{
    using (MemoryStream ms = new MemoryStream(binaryData))
    using (StreamReader sr = new StreamReader(ms))
    {
        Console.WriteLine(sr.ReadToEnd());
    }
} 
```

另一种方法是在返回之前将 Stream 复制到另一个流。但是，这仍然存在后续使用 StreamReader 访问它会关闭该流的问题。

```
public static void RunSnippet()
{
    OutputData(GetData());
}

public static MemoryStream GetData()
{
    MemoryStream outputStream = new MemoryStream();

    using (MemoryStream ms = new MemoryStream())
    using (StreamWriter sw = new StreamWriter(ms))
    {
        string data = "My test data is really great!";

        sw.Write(data);
        sw.Flush();

        ms.WriteTo(outputStream);
        outputStream.Seek(0, SeekOrigin.Begin);
    }

    return outputStream;
}

public static void OutputData(MemoryStream inputStream)
{
    using (StreamReader sr = new StreamReader(inputStream))
    {
        Console.WriteLine(sr.ReadToEnd());
    }
} 
```

# java - 您如何将 main 中创建的实例传递给类？

> ID：11528698
> 
> 赞同：0
> 
> 时间：2012-07-17T18:34:21.493
> 
> 标签：java, variables, static, main

首先，如果这是一个愚蠢的问题，我深表歉意。这最近一直困扰着我，我认为值得一问......

我有一个应用程序，其中类的流动如下：

![在此处输入图像描述](../Images/e10d615f3dd93c44317e23835f5fd00e.png)

我目前正试图让我的 Client 类和 Server 类能够访问在 MyApp 的 main 中创建的彼此的实例。问题是实例是在 main 中创建的（从而使它们成为静态的），我想知道如何正确地将它们传递给其他类，因为我所做的似乎不是正确的方法。

这是我所做的：

```
public class MyApp {
    private static RedClient red_client = null;
    private static BlueClient blue_client = null;
    private static RedServer red_server = null;
    private static BlueServer blue_server = null;

    public static void main(String[] args) {
        final Client myClient = new Client(arg1, arg2);
        red_client = myClient.getRedClient();
        blue_client = myClient.getBlueClient();

        final Server myServer = new Server(arg3, arg4);
        red_server = myServer.getRedServer();
        blue_server = myServer.getBlueServer();
    }

    public static RedClient getRedClient() {
        return red_Client;
    }

    public static BlueClient getBlueClient() {
        return blue_client;
    }

    public static RedServer getRedServer() {
        return red_server;
    }

    public static BlueServer getBlueServer() {
        return blue_server;
    }

} 
```

我稍后会像这样使用以下内容：

```
public class Client {
    public void SomeMethod {
        MyApp.getBlueServer.doSomething(myObject);
    }
} 
```

我只是不确定这是否是将实例传递给另一个类的正确方法，因为客户端和服务器都与 MyApp 通信。（请忽略类名，因为它们与应用程序的功能无关，我只是将它们用作名称，因为这是我能想到的第一件事）。

如果您需要任何澄清，请告诉我，因为我愿意学习和批评。如果这是错误的方式，请您解释为什么是错误的，然后解释正确的方式。

***编辑***

进一步澄清：

*   MyApp 可以访问客户端和服务器
*   客户端可以访问 RedClient 和 BlueClient
*   服务器可以访问 RedServer 和 BlueServer

没有其他类可以相互访问。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T18:39:34.663

您应该研究 Java 观察者模式：

[http://www.javapractices.com/topic/TopicAction.do?Id=156](http://www.javapractices.com/topic/TopicAction.do?Id=156)

[http://www.vogella.com/articles/DesignPatternObserver/article.html](http://www.vogella.com/articles/DesignPatternObserver/article.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T18:40:29.367

我没有看到你传递/设置任何东西。

没有理由不能将客户端实例传递给服务器（反之亦然）：

```
Client myClient = new Client(args);
Server myServer = new Server(args);

BlueClient = myClient.getBlueClient();
RedCLient = myClient.getRedClient();

BlueServer = myServer.getBlueServer();
RedServer = myServer.getRedServer();

myClient.addServer(blueServer);
myClient.addServer(redServer);

myServer.addClient(blueClient);
myServer.addClient(redClient); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T18:40:36.047

我不确定你在问什么，但我认为你需要先阅读一些关于面向对象编程的知识。

对于您刚刚提出的情况（我不喜欢它，但我认为它更好），您可能有 Client 构造函数来接收服务器作为参数：

```
Client client1 = new CLient(server1) 
```

因此您将能够从客户端方法访问 server1 对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-17T18:48:22.817

你可以和单身人士一起工作。如果你有一个类并且你可以确定总是最多有一个实例，那么这个实例就是一个单例。我给你举个小例子：

```
public class MyClass {
    private static MyClass instance;
    public static MyClass getInstance() {
        if(instance == null)
            instance = new MyClass();
        return instance;
    }
    private MyClass() { }
} 
```

有了这个，你可以从代码中的任何地方调用 MyClass.getInstance() ，你会得到一个单例；想一想；对于您谈论的情况，这可能非常实用。

# vb.net - 在 XNA 和 vb.net 中将对象转换为 spritebatch

> ID：11528699
> 
> 赞同：0
> 
> 时间：2012-07-17T18:34:22.713
> 
> 标签：vb.net, xna-4.0

我有一个需要访问 game.service 的 gameComponent。在以下示例中，我收到从对象到 microsoft.xna.framework.graphics.spritebatch 的隐式转换错误。C# 示例显示需要将对象转换为 spritebatch。任何人都可以在 vb.net 中做到这一点吗？

示例：将 spriteBatch 调暗为 SpriteBatch = Game.Services.GetService(GetType(SpriteBatch))

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T21:35:03.867

您没有提到需要投射哪个对象。我猜，这是GetService() 的返回值。然后你想做类似的事情：

```
Dim spriteBatch As SpriteBatch = DirectCast(Game.Services.GetService(GetType(SpriteBatch)), SpriteBatch) 
```

也许，一个通用的方法会帮助你。使用泛型方法，无需强制转换：

```
Function GetService(Of T)() As T
    '...
End Function
Dim spriteBatch = Game.Services.GetService(Of SpriteBatch)() 
```

# ruby-on-rails - 如何让 Facebook 喜欢帖子以显示图像和描述

> ID：11528701
> 
> 赞同：0
> 
> 时间：2012-07-17T18:34:30.000
> 
> 标签：ruby-on-rails, facebook, facebook-like, fbconnect, fb-graph

我正在使用 Facebook 应用页面上的 facebook like 按钮。当用户喜欢一个页面时，只会将 URL 发布到他们的墙上。

我试过以下

```
<meta property="og:title" content="my content" />
<meta property="og:image" content="my content"/>
<meta property="og:description" content="my content">
<meta property="og:type" content="product">
<meta property="og:url" content="my content">
<meta property="og:site_name" content="my content">
<meta property="fb:app_id " content="APPID"> 
```

旁边

```
 <meta name="title" content="mycontent" />
    <meta name="description" content="mycontent" />
    <link rel="image_src" type="image/jpeg" href="mycontent"/> 
```

该应用程序编写的是rails。有没有人解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T20:48:17.927

不要忘记 Open Graph 命名空间：

```
<!DOCTYPE html>
<html xmlns:fb="http://ogp.me/ns/fb#" lang="en" style="overflow:hidden;">
    <head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# <?php echo AppInfo::appNamespace(); ?>: http://ogp.me/ns/fb/<?php echo AppInfo::appNamespace(); ?>#">
        ... 
```

使用[Facebook Open Graph Debugger](https://developers.facebook.com/tools/debug)检查您的站点。

# wordpress-theming - Wordpress 的简单内容过滤器

> ID：11528704
> 
> 赞同：0
> 
> 时间：2012-07-17T18:34:35.127
> 
> 标签：wordpress-theming, wordpress

我为 wordpress 制作了一个非常简单的内容过滤器。如果帖子包含集合数组中的任何单词，则基本上可以防止创建帖子。过滤器不需要通知用户错误发布。只需要停止将帖子保存在数据库中，到目前为止我有这个：function thefilter($content){

```
$searchfilter = array(
    '#cure-plus.org#',
    '#porn#',
    '#escort#',
    '#no prescription#',
    '#Prescription#'
);

$count=0;
foreach($searchfilter as $filter){

    preg_match_all( $filter, $content, $pics );

    $count += count($pics[0]);
}

if ( $count > 0 ) {
   return 'This post has been deleted';
}
}

add_filter('content_save_pre','thefilter'); 
```

一切正常，一旦帖子存在，我就可以删除它，但我希望它永远不会那么远。

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T07:54:44.863

为了防止帖子被保存，您可以轻松地杀死 PHP，或重定向到某个地方。

```
if ( $count > 0 )
    die('You just got caught in our spam filter.');

return $content; 
```

或者

```
if ( $count > 0 )
    header( 'Location: http://disney.com' );
    die('You just got caught in our spam filter.');

return $content; 
```

即使您重定向，也要确保终止 PHP，以确保在数据库写入之前停止执行。

如果帖子是干净的，还记得将原始内容返回到过滤器。

# math - 如何在批处理中正确执行模数运算？

> ID：11528706
> 
> 赞同：6
> 
> 时间：2012-07-17T18:34:42.653
> 
> 标签：math, windows-7, batch-file

我正在尝试编写一个批处理文件，该文件根据对一组变量执行的模运算的结果执行操作。但是，我似乎无法完全正确。

首先要测试我的数学运算语法，我一直在尝试获得一个更简单的脚本来产生所需的结果。

```
:START
SETLOCAL
SET /P Input-Num="Input Number: "
SET /A Input-Num=%Input-Num% %% 2
ECHO %Input-Num%
ENDLOCAL
PAUSE 
:END 
```

如果我输入`5`，预期的输出是`1`。但是，相反，我收到一条消息`Missing operator.`，然后输出`5`.

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T18:56:24.657

使用`SET /P`是您的问题，因为 5 不再被视为数值。您的上述示例按预期工作

# iphone - 如果表需要很长时间，则显示加载消息

> ID：11528708
> 
> 赞同：0
> 
> 时间：2012-07-17T18:34:46.803
> 
> 标签：iphone, mbprogresshud

如果我的表格在 3 秒内没有填满所有信息，我想显示一条“正在加载”消息。这是我希望我的表执行的操作：

```
-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{

     //First time

     UITableView *cell = [tableView cellForRowAtIndexPath:indexPath];

     //Configure table

     //Second Time
}

NSTimeInterval timeDifference = [firstTime timeIntervalSinceDate:secondTime];
if (timeDifference == 3 seconds){
   //Display Loading message
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T20:22:13.083

我认为您在问题中处理的问题是错误的。如果您的数据加载时间过长，不要只显示加载状态，而是尝试始终显示加载状态，直到数据加载操作完成（希望在后台线程上，这将允许您的主 UI 线程实际显示正在加载的 UI）。有很多方法可以实现这一点，最适合您的方法取决于您的个人喜好和现有代码。

# jquery - 如何根据页面滚动位置为对象设置动画

> ID：11528713
> 
> 赞同：1
> 
> 时间：2012-07-17T18:34:53.753
> 
> 标签：jquery, html

我目前正在使用以下代码根据当前滚动位置显示/隐藏内容：

```
$(window).scroll(function () {
    if ($(window).scrollTop() >= 409) {
        $('.cliocont').fadeTo('slow', 1.0);
    } else if ($(window).scrollTop() <= 409) {
        $('.cliocont').fadeTo('slow', 0.5);
    }
}); 
```

这段代码似乎不起作用是有原因的吗？每当 else if 语句代码工作时，但只要添加它，内容就不会出现或隐藏。

谢谢，内森·尼亚梅尔

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-17T18:40:03.550

添加`.stop()`以防止动画淡入淡出错误
和布尔标志`var io`以防止不必要的动画：

## *[jsBin 演示](http://jsbin.com/exoyab/81/edit)*

```
var $cc = $('.cliocont'),
    io  = false; // flag // compare booleans

$(window).scroll(function () {

   var is409 = $(window).scrollTop() >= 409; // boolean
   if (io != is409){
      io = is409;
      $cc.stop().fadeTo(800, is409?1.0:0.5);
   }

}); 
```

`is409 ? 1.0 : 0.5`是一个[条件运算符](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Conditional_Operator)`if`，它是语句的简写；
`boolean ? ifTrue : else ;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-04T15:57:35.013

我会说这更合适，这包括两个动画的时间锁定 - 请删除 console.log(...) 调用：

```
 <script type="text/javascript">

            var animateTrainer1 = true;
            var animateTrainer2 = true;
            $(window).scroll(function () {

                var scrollTop = $(window).scrollTop();

                if (scrollTop > 500 && animateTrainer1) {
                    animateTrainer1 = false;
                    console.log("animated trainer 1");
                    Animations.toPosition("#trainer1", 0, -100, 4000);
                }

                if (scrollTop > 800 && animateTrainer2) {
                    animateTrainer2 = false;
                    console.log("animated trainer 2");
                    Animations.toPosition("#trainer2", 100, 340, 4000);
                }

            });

        </script> 
```

# css-transitions - webkit 转换似乎在某些 box-shadow 规则中不起作用

> ID：11528716
> 
> 赞同：1
> 
> 时间：2012-07-17T18:35:04.963
> 
> 标签：css-transitions, css

我想要一个表格单元格中的可扩展树。我得到了它的工作。在玩弄它时，我尝试添加一个过渡的盒子阴影。这仅在根级别有效。[（JsFiddle）](http://jsfiddle.net/RussAbbott/6xQpZ/44/)。

该问题可能与在 display [(link)](http://goo.gl/YByD8)上不起作用的转换有关。但是显示更改是否会破坏所有转换，或者我错过了什么？（我只加入了一个 webkit 转换。）

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T20:25:55.070

编辑：这可能是一种可能的解决方法，因为过渡效果不起作用。

您是否尝试过使用关键帧动画？我对代码做了一些更改。这是一个[演示（jsFiddle）。](http://jsfiddle.net/KYHBA/1/)

我变了：

```
/* This transition seems to have no effect. */
    -webkit-transition: box-shadow 0.5s;
} 
```

到：

```
/* This transition seems to have no effect. */
    -webkit-animation: shadow 0.5s ease-in-out;
}  

@-webkit-keyframes shadow {
    0%   { box-shadow: 0px 0px 0px #000; }    
    100% { box-shadow: 4px 4px 7px #000; }
} 
```

# ruby-on-rails - 神秘的 AbstractController::ActionNotFound （路线在那里）

> ID：11528719
> 
> 赞同：3
> 
> 时间：2012-07-17T18:35:28.733
> 
> 标签：ruby-on-rails, ruby-on-rails-3, mongoid

（轨道 3.0.7）

我的`routes.rb`有这个：

```
namespace :admin do
  namespace :campus_hub do
    resources :billing_subscriptions, {
      :except => [:destroy, :new, :create]
    } do
      member do
        post :add_addon
      end
    end
  end
end 
```

`rake routes`显示这条路线：

```
add_addon_admin_campus_hub_billing_subscription POST   /admin/campus_hub/billing_subscriptions/:id/add_addon(.:format)                            {:action=>"add_addon", :controller=>"admin/campus_hub/billing_subscriptions"} 
```

我的控制器 ( `Admin::CampusHub::BillingSubscriptionsController`) 有方法`add_addon`。

我在日志中做了一个如下所示的 POST：

```
Started POST "/admin/campus_hub/billing_subscriptions/50059f5be628f83b13000012/add_addon" for 33.33.33.1 at Tue Jul 17 20:21:17 +0200 2012 
```

我得到这个错误：

```
AbstractController::ActionNotFound (The action '50059f5be628f83b13000012' could not be found for Admin::CampusHub::BillingSubscriptionsController) 
```

我完全感到困惑。我发出的 POST 请求与路线完全匹配。为什么它认为ID是动作？希望我只是错过了一些明显的东西！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-26T01:41:14.280

我从 rails 版本猜测您遇到了与此类似的问题：[Rails 3 中的路由错误，](https://stackoverflow.com/questions/4868081/routing-error-with-rails-3-with-members)这是 rails 3 中的一个错误，请注意评论：[Rails 3 中的路由错误与成员](https://stackoverflow.com/questions/4868081/routing-error-with-rails-3-with-members#comment7306038_4868081)

你需要更换：

```
 member do
    post :add_addon
  end 
```

像这样：

```
match "add_addon" => "billing_subscriptions#add_addon", :as => :add_addon, :via => :post 
```

你会得到一个像这样稍微交换的路径：`admin_campus_hub_billing_subscription_add_addon_path`但它应该在轨道 3 和 4 中工作。

加起来就是这样的：

```
namespace :admin do
  namespace :campus_hub do
    resources :billing_subscriptions, {
      :except => [:destroy, :new, :create]
    } do
      match "add_addon" => "billing_subscriptions#add_addon", :as => :add_addon, :via => :post
    end
  end
end 
```

请注意，完整的 rake 路由如下所示：

```
admin_campus_hub_billing_subscription_add_addon POST  /admin/campus_hub/billing_subscriptions/:billing_subscription_id/add_addon(.:format) admin/campus_hub/billing_subscriptions#add_addon 
```

# node.js - NodeJS 扩展 ASCII 支持

> ID：11528722
> 
> 赞同：3
> 
> 时间：2012-07-17T18:35:39.700
> 
> 标签：node.js, encoding, ascii

我正在尝试读取包含扩展 ascii 字符（如“á”或“è”）的文件，但 NodeJS 似乎无法识别它们。

我尝试阅读：

*   缓冲
*   细绳

尝试不同的编码类型：

*   ASCII
*   base64
*   utf8

[如http://nodejs.org/api/fs.html](http://nodejs.org/api/fs.html)中所引用

有没有办法使这项工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T18:52:16.263

我使用二进制类型来读取此类文件。例如

```
var fs = require('fs');

// this comment has I'm trying to read a file that contains extended ascii characters like 'á' or 'è',

fs.readFile("foo.js", "binary", function zz2(err, file) {  
    console.log(file);
}); 
```

当我将以上内容保存到 foo.js 中时，输出中会显示以下内容：

```
var fs = require('fs');

// this comment has I'm trying to read a file that contains extended ascii characters like '⟡ 漀爀 ✀',

fs.readFile("foo.js", "binary", function zz2(err, file) {  
    console.log(file);
}); 
```

上面的怪异是因为我在 emacs 缓冲区中运行它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T19:21:50.787

我试图读取的文件是 ANSI 编码的。当我尝试使用“fs”模块的函数读取它时，它无法执行扩展 ASCII 字符的转换。

我刚刚发现 nodepad++ 实际上能够从某些格式转换为 UTF-8，而不仅仅是使用 UTF-8 编码标记文件。

转换后，我能够很好地阅读它并将我需要的所有操作应用于内容。

谢谢您的回答！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-10T19:31:27.867

我意识到这是一篇旧帖子，但我在个人寻找解决这个特定问题的方法时发现了它。

我编写了一个模块，为节点缓冲区提供扩展的 ASCII 解码和编码支持。[您可以在此处查看源代码。](https://github.com/jvilk/bfs-buffer/blob/2d7544c4aaeb683f009efa6dbef9e746270bda49/ts/extended_ascii.ts)它是我在浏览器中为浏览器内文件系统创建的称为 BrowserFS 的 Buffer 实现的一部分，但它可以 100% 独立于 NodeJS（或 Browserify）中的任何内容使用，因为它没有依赖关系。

只需添加[`bfs-buffer`](https://www.npmjs.com/package/bfs-buffer)到您的依赖项并执行以下操作：

```
var ExtendedASCII = require('bfs-buffer/js/extended_ascii').default;
// Decodes the input buffer as an extended ASCII string.
ExtendedASCII.byte2str(aBufferWithText);
// Encodes the input string as an extended ASCII string.
ExtendedASCII.str2byte("Some text"); 
```

或者，如果您不想为项目添加额外的依赖项，只需将模块调整到您的项目中即可。它是麻省理工学院许可的。

我希望这可以帮助将来像我一样在搜索中找到此页面的任何人。:)

# regex - 如何检查数字字符串的可选可变长度？

> ID：11528724
> 
> 赞同：0
> 
> 时间：2012-07-17T18:35:40.367
> 
> 标签：regex, variables, format

我正在尝试验证 IP 地址之类的内容，

它可能与端口连接或不连接。让我说：10.12.1.100 和 10.12.1.100:8080 都可以。

我创建了这样的东西：

> ^10\.([0-9]|[1-9][0-9]|1([0-9][0-9])|2([0-4][0-9]|5 [0-5]))\.([0-9]|[1-9][0-9]|1([0-9][0-9])|2([0-4][0 -9]|5[0-5]))\.([0-9]|[1-9][0-9]|1([0-9][0-9])|2([0 -4][0-9]|5[0-5]))([-+]?(:|\d[1,4]))$

但是，它不适用于：10.12.1.100:8080 部件。如何实现这部分 ([-+]?(:|\d[1,4]))？

如果我删除 ([-+]?(:|\d[1,4]));它将有效 10.12.1.100 部分正确。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:43:01.003

使用这个正则表达式`^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(:\d{1,5})?$`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T18:56:50.853

您的特定模式似乎正在做一些非常特定的 IP 匹配，否则我建议使用 @burning_LEGION 建议的东西。我猜你的场景有一些特定的东西超出了正常的 IP 解析。

我只是扩展您当前的模式，因为我假设您需要组结构保持不变。否则我建议重写。

但是要修复您的具体示例，请尝试替换`([-+]?(:|\d[1,4]))$`为`([-+]?(:\d{1,5}))?$`

# php - 将 emberjs <-> PHP 与 JSON 数据集成的类

> ID：11528726
> 
> 赞同：0
> 
> 时间：2012-07-17T18:35:46.623
> 
> 标签：php, json, ember.js, ember-data

我正在寻找类似 emberjs-data 但对于 PHP 的东西？

最长的描述：我正在寻找 PHP 中的类以标准格式为 emberjs 生成 JSON，并在 emberjs 中获取此数据。另一方面，我想使用相同的 JSON 标准将数据从 emberjs 发送到 PHP。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T09:25:01.183

实际上，您正在寻找与[ActiveModelSerializers](https://github.com/josevalim/active_model_serializers/)等效的 PHP 。

你看过[http://www.phpactiverecord.org/docs/ActiveRecord/Serialization](http://www.phpactiverecord.org/docs/ActiveRecord/Serialization)吗？

# javascript - 当 HTML DOM 中存在具有重复 ID 的元素时，javascript getElementById() 的行为？

> ID：11528731
> 
> 赞同：8
> 
> 时间：2012-07-17T18:36:07.623
> 
> 标签：javascript

当 HTML DOM 中存在具有重复 ID 的元素时，有人可以阐明 javascript getElementById() 的行为吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-17T18:38:04.800

虽然没有定义标准行为，但通常它会返回找到的第一个元素。

演示：http: [//jsfiddle.net/ruNKK/](http://jsfiddle.net/ruNKK/)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-17T18:46:39.017

如果您有多个具有相同 id 的元素，则可以使用

```
document.querySelectorAll("[id='myid']") 
```

但是，如果您可以控制它，您应该只修复 HTML。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-07-17T18:49:16.457

是的，行为未定义。

标记无效，并且没有标准定义浏览器在这种情况下应该做什么。

每个浏览器都会尝试做一些合理的事情，通常返回第一个元素。其他可能的处理方式是返回最后一个元素，根本没有元素（null），或者抛出错误。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-17T18:44:54.950

拥有多个具有相同 ID 的对象是非法的。因为它不应该被允许，`getElementById()`所以规范中没有指定存在多个匹配项的行为。事实上，[规范](http://www.w3.org/TR/DOM-Level-2-Core/core.html#ID-getElBId)明确指出：“如果多个元素具有此 ID，则未定义行为。”。

在我尝试过的几个浏览器中，它返回第一个，但显然你不应该依赖它。

如果要查找所有匹配项，则必须设计一个查询来查看所有标签的 ID 并收集与您匹配的标签。

在普通的 javascript 中，你可以这样做：

```
function getAllElementsById(id) {
    var all = document.getElementsByTagName("*");
    var results = [], elem;
    for (var i = 0; i < all.length; i++) {
        elem = all[i];
        if (elem.id && elem.id === id) {
            results.push(elem);
        }
    }
    return(results);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-17T18:43:09.503

是的。它会回到第一个。我们不能使用相同的ID作为HTML属性
1\. *查看plaincopy到clipboardprint？

```
* {  
 margin: 0;  
 padding: 0;  
} 
```

在我们进入更高级的选择器之前，让我们先为初学者敲掉明显的选择器。

星号将针对页面上的每个元素。许多开发人员将使用此技巧将边距和填充归零。虽然这对于快速测试当然很好，但我建议您永远不要在生产代码中使用它。它给浏览器增加了太多的重量，而且是不必要的。

* 也可以与子选择器一起使用。查看plaincopy到剪贴板打印？

```
#container * {  
 border: 1px solid black;  
} 
```

这将针对作为#container div 的子元素的每个元素。同样，尽量不要使用这种技术，如果有的话。

# X

查看plaincopy到剪贴板打印？

```
#container {  
   width: 960px;  
   margin: auto;  
} 
```

为选择器添加哈希符号前缀允许我们按 id 定位。这很容易成为最常见的用法，但是在使用 id 选择器时要小心。

# vb.net - 在 vb.net 中以任意精度存储和计算实数

> ID：11528734
> 
> 赞同：1
> 
> 时间：2012-07-17T18:36:32.527
> 
> 标签：vb.net

> **可能重复：**
> [用于任意数字精度的 .NET Framework 库](https://stackoverflow.com/questions/1169673/net-framework-library-for-arbitrary-digit-precision)

如何在 vb.net 中存储一个实数，例如根 2 或三分之一，达到任意精度（我需要的精度是无限精度）？

我希望能够存储实数并对其执行操作（即根 2 乘以根 2）而不会丢失任何准确性 - 如果我需要检索此值，存储 1/3 的 IE 将返回值 1/3。

我正在考虑使用分形编码，但我不确定最好的方法。

存储容量不是问题，我只需要 100% 准确的真实数字。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T18:43:40.703

那会是一个**实**数还是需要是任意数量的（几乎）任意数字？（对不起“回答” - 由于某种原因我现在无法添加评论......）

# python - 使用python过滤文件

> ID：11528735
> 
> 赞同：-4
> 
> 时间：2012-07-17T18:36:34.957
> 
> 标签：python

我从终端中的命令生成数据`netstat -a`，现在结果是我写入文件的所有传入和传出 IP 地址，如何通过列仅检索 IP 地址？

另外，如何按列参数检索数据？例如，从第 10 列开始，到第 27 列结束。我尝试了过滤器功能，但它不起作用。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:04:40.667

这个怎么样：

```
with open('data.txt') as inf:
    for lc, line in enumerate(inf, 1):  # lc - current line count
        if lc > 3:  # if you need to skip some header lines ?? (unknown data)
            cols = line.split()
            for i in xrange(10, 28):  # print column 10 - 27
                print cols[i], '  ',
            print 
```

*如果您可以发布一些带有问题的数据*，那将会很有帮助，因此*我使用您的示例列**10** - **27***来代替。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T18:42:29.260

```
filename = ...
with open(filename, 'rb') as f:
    for row in f.readlines()[1:]:
        columns = row.split()
        if len(columns) > 2:
            print row.split()[1] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T19:19:13.283

这与 Levon 的答案基本相同，但稍微更紧凑和 Pythonic，并且调整了数字以猜测我怀疑 OP 试图做什么。

```
with open('data.txt') as inf:
  for lc, line in enumerate(inf):  # lc - current line count
    if lc >= 2: # netstat usually has 2 lines of header info
      print ' '.join(line.split()[3:5]) # cols 3-4 are the addresses 
```

# python - 在 Celery 任务中运行 Scrapy 蜘蛛

> ID：11528739
> 
> 赞同：39
> 
> 时间：2012-07-17T18:36:54.417
> 
> 标签：python, django, scrapy, celery

我有一个 Django 站点，当用户请求它时会发生刮擦，我的代码会在一个新进程中启动一个 Scrapy spider 独立脚本。自然，这不适用于用户的增加。

像这样的东西：

```
class StandAloneSpider(Spider):
    #a regular spider

settings.overrides['LOG_ENABLED'] = True
#more settings can be changed...

crawler = CrawlerProcess( settings )
crawler.install()
crawler.configure()

spider = StandAloneSpider()

crawler.crawl( spider )
crawler.start() 
```

我决定使用 Celery 并使用工作人员来排队抓取请求。

但是，我遇到了 Tornado 反应堆无法重新启动的问题。第一个和第二个蜘蛛运行成功，但是后续的蜘蛛会抛出 ReactorNotRestartable 错误。

任何人都可以分享在 Celery 框架中运行 Spider 的任何技巧吗？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-07-25T19:34:37.950

好的，这就是我如何让 Scrapy 与我的 Django 项目一起工作，该项目使用 Celery 对要抓取的内容进行排队。实际的解决方法主要来自 joehillen 的代码，位于[http://snippets.scrapy.org/snippets/13/](http://snippets.scrapy.org/snippets/13/)

首先是`tasks.py`文件

```
from celery import task

@task()
def crawl_domain(domain_pk):
    from crawl import domain_crawl
    return domain_crawl(domain_pk) 
```

然后`crawl.py`文件

```
from multiprocessing import Process
from scrapy.crawler import CrawlerProcess
from scrapy.conf import settings
from spider import DomainSpider
from models import Domain

class DomainCrawlerScript():

    def __init__(self):
        self.crawler = CrawlerProcess(settings)
        self.crawler.install()
        self.crawler.configure()

    def _crawl(self, domain_pk):
        domain = Domain.objects.get(
            pk = domain_pk,
        )
        urls = []
        for page in domain.pages.all():
            urls.append(page.url())
        self.crawler.crawl(DomainSpider(urls))
        self.crawler.start()
        self.crawler.stop()

    def crawl(self, domain_pk):
        p = Process(target=self._crawl, args=[domain_pk])
        p.start()
        p.join()

crawler = DomainCrawlerScript()

def domain_crawl(domain_pk):
    crawler.crawl(domain_pk) 
```

这里的技巧是“从多处理导入过程”，它解决了 Twisted 框架中的“ReactorNotRestartable”问题。所以基本上 Celery 任务调用“domain_crawl”函数，它一遍又一遍地重用“DomainCrawlerScript”对象来与你的 Scrapy 蜘蛛交互。（我知道我的示例有点多余，但我在设置多个版本的 python 时这样做是有原因的 [我的 django 网络服务器实际上使用的是 python2.4，而我的工作服务器使用的是 python2.7]）

在我的示例中，“DomainSpider”只是一个修改过的 Scrapy Spider，它接受一个 url 列表，然后将它们设置为“start_urls”。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-08-12T23:43:37.860

我在设置文件中将[CELERYD_MAX_TASKS_PER_CHILD设置为 1 并解决了这个问题。](http://docs.celeryproject.org/en/latest/configuration.html#std%3asetting-CELERYD_MAX_TASKS_PER_CHILD)工作守护进程在每次蜘蛛运行后启动一个新进程，该进程负责处理反应器。

# http - 非串行流水线 HTTP 可能吗？

> ID：11528740
> 
> 赞同：2
> 
> 时间：2012-07-17T18:36:56.403
> 
> 标签：http

RFC 2616[第 8.1.2.2 节](http://www.w3.org/Protocols/rfc2616/rfc2616-sec8.html#sec8.1.2.2)指出：

> 支持持久连接的客户端可以“管道”其请求（即，发送多个请求而不等待每个响应）。服务器**必须以与接收请求****相同的顺序**发送对这些请求的响应。

串行响应*通常*弊大于利，因为串行响应实际上[需要服务器进行更多*处理*](https://devcentral.f5.com/weblogs/macvittie/archive/2009/04/02/http-pipelining-a-security-risk-without-real-performance-benefits.aspx)，并抵消了流水线带来的性能优势。

例如，如果 HTTP 客户端请求文件 1.jpg、2.jpg、3.jpg、4.jpg 和 5.jpg，则无论 3.jpg 在 1.jpg 之前返回，还是 4 .jpg 在 3.jpg 之前返回。客户只希望响应可用，以*任何*顺序。

HTTP 客户端如何获得流水线的好处，同时又不为响应队列的缺点买单？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T18:53:01.183

客户端无法绕过 HOL 排队，因为它是 RFC 2616 的一部分。流水线的唯一好处（在我看来）是在极其具体和狭窄的情况下。考虑：

**R ¹[成本]**=`Request A`加工成本。
**R ²[成本]**=`Request B`加工成本。
**TCP[成本]**= 协商新 TCP 连接的成本。

因此，在以下特定情况下使用流水线是可行的：

> **R ¹[成本]**≥ **R ²[成本]**≤ **TCP[成本]**

一个请求比前一个请求更昂贵并且比协商一个新的 TCP 连接更便宜的频率是多少？不经常。我要补充一点，Websockets（到目前为止）是一个更有趣和更合适的解决方案（就并行后端处理而言）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T19:10:19.840

它不能（在 HTTP/1.1 中）。它可能在 HTTP 的未来版本中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T19:23:08.390

HTTP 标头中没有默认机制来识别哪个响应将匹配哪个请求。由于接收到的顺序，响应被称为对特定请求的响应。如果您请求 1.jpg、2.jpg、3.jpg、4.jpg 和 5.jpg 并以任意顺序发送响应，您将不知道哪个是哪个。

（您可以在客户端和服务器标头中实现自己的标记，但您肯定不符合协议并且大多数实现不知道如何处理它。您必须进行一些处理才能映射，这可能会否定这种并行实现的预期好处也是如此。）

您从现有 HTTP 管道机制中获得的主要好处是：

*   可能减少通信延迟。这可能很重要，具体取决于您的连接。
*   对于需要更长的服务器端计算的请求，服务器可以在接收到请求时在后台启动此计算，同时它正在发送先前的响应，以便能够更早地开始发送第二个结果。（这也是一种延迟形式，但在响应准备方面。）

这些好处中的一些也可以通过更现代的网络浏览器技术获得，其中可以单独发送多个请求，并且可以逐步更新页面的某些部分（通过 AJAX）。

# c++ - 添加#includes 使用的文件

> ID：11528752
> 
> 赞同：0
> 
> 时间：2012-07-17T18:37:52.317
> 
> 标签：c++, visual-studio-2010

我从 Visual Studio 2010 中的新 Win32 控制台应用程序项目开始。我正在设置我的环境以支持初学者级别的 OpenGL 程序。我正在添加所需的 *.cpp 文件和 *.h 文件。我添加了

`#include "../../shared/gltools.h"//opengl toolkit`

当我将鼠标悬停在`#include`. 我试图添加所需的文件。我右键单击源文件并选择 > 添加 > 新过滤器 > 将其称为共享并按 Enter。

什么是过滤器？我以为我会添加一个物理文件夹而不是过滤器。这与“外部依赖”有何不同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:41:47.977

在项目属性中，取消**编译器**，找到字段**Additional Include Directories**并添加文件所在的目录，或者，添加文件所在的目录`/shared/`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:43:41.380

查找并分析一些 OpenGL 示例，这些示例通常带有您显然拥有的 OpenGL 头文件和库。检查您正在使用哪个包含目录 - 将其配置为上述“Luchian Grigore”。当您有该工作（程序编译）时，请记住添加库目录（在项目设置，链接器选项中），否则会出现链接器问题。这一切都应该在 howto 或代码示例中进行描述。分析它们以开始。不要重新反转轮子，玩得开心。

# jquery - 在父页面加载到手风琴菜单之前不显示子页面

> ID：11528754
> 
> 赞同：0
> 
> 时间：2012-07-17T18:37:58.340
> 
> 标签：jquery, css, jquery-ui-accordion

我在我网站上各个页面的 LHS 上有一个手风琴菜单

```
http://94.76.203.52 
```

单击顶部的高级，初级等。

我在父部分有内容，但我只希望在单击父链接后出现子菜单，因为您可能已经看到，子菜单出现在页面加载之前。

我正在将此插件与 Worpdress 一起使用

[http://www.designchemical.com/blog/index.php/wordpress-plugins/wordpress-plugin-jquery-vertical-accordion-menu-widget/](http://www.designchemical.com/blog/index.php/wordpress-plugins/wordpress-plugin-jquery-vertical-accordion-menu-widget/)

这是高级 LHS 菜单的 CSS：

```
 #dc_jqaccordion_widget-7-item {border-top: 0px solid #00365E; text-align:right; font-size:11px; margin-left:25px;}
 #dc_jqaccordion_widget-7-item ul, #dc_jqaccordion_widget-7-item ul li {margin: 0; padding: 0; border: none; list-style: none;}
 #dc_jqaccordion_widget-7-item ul a {background-repeat: no-repeat; background-position:10px center; border-top: 1px solid #fff; border-bottom: 1px solid #fff; padding: 5px 5px 5px 32px; text-decoration:none; display: block; font-weight: bold; text-transform:lowercase;color:#ECF6F5; background-color:#00365E;}
 *#dc_jqaccordion_widget-7-item ul a.dcjq-parent {background-color:#00365E; color:#ECF6F5;}
 #dc_jqaccordion_widget-7-item ul a.dcjq-parent.active { background-color: #00365E; color:#84CAC6; }
 #dc_jqaccordion_widget-7-item ul li ul li.current-menu-item a {background-color: #ECF6F5; color:#84CAC6; }
 #dc_jqaccordion_widget-7-item ul li ul li.current-menu-item a.active {background-color:      #ECF6F5; color:#00365E; }
 #dc_jqaccordion_widget-7-item ul li ul li.current-menu-item a:hover {background-color:   #ECF6F5; color:#00365E; }
 #dc_jqaccordion_widget-7-item ul li ul li {background-color: #84CAC6; color:white;}
 #dc_jqaccordion_widget-7-item ul li ul li a {background-color: #84CAC6; color:white;}
 #dc_jqaccordion_widget-7-item ul a:hover {background-color:#84CAC6 ; color:#00365E;}
 #dc_jqaccordion_widget-7-item ul li ul li a.dcjq-parent {background-color: #84CAC6; color:white;}
 #dc_jqaccordion_widget-7-item ul li ul li a.dcjq-parent:hover {background-color:#84CAC6 ; color:#00365E;}
 #dc_jqaccordion_widget-7-item ul li ul li a.dcjq-parent.active {background-color: #84CAC6; color:#00365E; }
 #dc_jqaccordion_widget-7-item ul li ul li ul li a {background-color: #ECF6F5; color:#84CAC6; }
 #dc_jqaccordion_widget-7-item ul li ul li ul li a.active {background-color: #ECF6F5; color:#00365E; } 
```

请问有人可以帮忙吗？

谢谢马克霍斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:20:11.160

请提供更多详细信息 - 当我无法重新创建它时，很难知道你看到了什么。否则，您可以隐藏“侧边栏”，直到文档加载...类似于：

```
$(document).ready(function() {
     $('.sidebar').show();
}); 
```

...当然，您最初必须隐藏侧边栏（`.sidebar {display:none;}`）。让我知道我是否离基地很远，但如果加载顺序是一个问题，这将解决它。

# c# - 异步 WCF 服务超时

> ID：11528758
> 
> 赞同：1
> 
> 时间：2012-07-17T18:38:06.097
> 
> 标签：c#, wcf, c#-4.0

我们有一个异步 WCF 服务操作，它从系统的所有不同组件获取日志文件并将它们发送到客户端。由于如果其中一个组件无法正常工作，这可能需要一段时间，所以如果此功能不会超时，那就太好了，但它也不应该导致客户端挂起。

我对异步 WCF 服务的理解是，当客户端向服务器请求某些东西时，服务器会立即回复一条消息说：“我正在处理它。继续做你自己的事情，我会告诉你什么时候我'我说完了。” 然后释放连接以供客户端发出其他请求，同时服务器启动一个新线程来完成其大部分工作。当服务器完成后，它会向客户端发送一条带有结果的消息。因此，服务器和客户端之间的连接是免费的，无论服务器花费多长时间，连接都不应该超时。它是否正确？

如果是这种情况，那么我们的服务没有按预期工作。当我测试该服务时，只要不到一分钟，它就可以按预期工作。但是，如果我强制它花费更长的时间，客户端会抛出 TimeoutException。既然服务是异步的，不应该永远不超时吗？如果是这样，我错过了什么？

我们使用此页面作为指南编写了我们的异步服务：http: [//code.msdn.microsoft.com/windowsdesktop/How-to-Implement-a-WCF-2090bec8](http://code.msdn.microsoft.com/windowsdesktop/How-to-Implement-a-WCF-2090bec8)

这是我的代码。这是服务合同：

```
[ServiceContract(CallbackContract = typeof(IInformationServiceCallBack), SessionMode = SessionMode.Required)]
public interface IInformationService
{
    //snip...

    [OperationContract(AsyncPattern=true)]
    [FaultContract(typeof(LogFileFault))]
    IAsyncResult BeginGetLogFiles(LogFileRequest[] logfileRequests,
        AsyncCallback callback, object state);

    LogFile[] EndGetLogFiles(IAsyncResult result);

    //snip...
} 
```

这是服务实现：

```
[ServiceBehavior(ConcurrencyMode = ConcurrencyMode.Multiple, InstanceContextMode = InstanceContextMode.PerSession, UseSynchronizationContext=false)]
public class InformationServiceImpl : IInformationService, IDisposable
{
    //snip...

    public IAsyncResult BeginGetLogFiles(LogFileRequest[] logfileRequests,
        AsyncCallback callback, object state)
    {
        var task = Task<LogFile[]>.Factory.StartNew((x) =>
            {
                return GetLogFilesHelper(logfileRequests);
            }, state);

        return task.ContinueWith(res => callback(task));
    }

    public LogFile[] EndGetLogFiles(IAsyncResult result)
    {
        var castResult = result as Task<LogFile[]>;
        return castResult.Result;
    }

    private LogFile[] GetLogFilesHelper(LogFileRequest[] logfileRequests)
    {
        //Long-running method that gets the log files
    }

    //snip...
} 
```

这是客户端代码：

```
public class InformationServiceConnection : WcfDurableConnection<IInformationService> //WcfDurableConnection is one of our internal classes
{
    //snip...

    public void GetServiceLogFiles(Action<LogFile[], WcfCommandResult> callback)
    {
        var logfileRequests = new LogFileRequest[]
        { 
            new LogFileRequest(/* snip */),
            new LogFileRequest(/* snip */),
            new LogFileRequest(/* snip */),
            new LogFileRequest(/* snip */)
        };

        ExecuteTask(x =>
            {
                LogFile[] logfile = null;
                WcfCommandResult wcfResult = null;

                var asyncCallback = new AsyncCallback((result) =>
                {
                    logfile = Channel.EndGetLogFiles(result);
                    callback(logfile, wcfResult);
                });

                wcfResult = RunCommand(y =>
                {
                    Channel.BeginGetLogFiles(logfileRequests, asyncCallback, null);
                }, x);
            });
    }

    /* ExecuteTask and RunCommand are both methods that take care of
     * multithreading issues for us. I included their code below in
     * case they make a difference, but the code I'm most interested
     * in is the GetServiceLogFiles method above. */

    //snip...
    protected CancellationTokenSource ExecuteTask(Action<CancellationToken> action)
    {
        CancellationTokenSource tokenSource = new CancellationTokenSource();

        ManualResetEvent lastTask;
        ManualResetEvent thisTask;
        lock (_objectLock)
        {
            lastTask = _syncTask;
            thisTask = new ManualResetEvent(false);
            _syncTask = thisTask;
        }

        tokenSource.Token.Register(x => ((ManualResetEvent)x).Set(), thisTask);

        var task = Task.Factory.StartNew((x) =>
        {
            try
            {
                lastTask.WaitOne();
                action((CancellationToken)x);
            }
            catch (Exception e)
            {
                LogUtility.Error(e);
            }
            finally
            {
                thisTask.Set();
            }
        }, tokenSource.Token, tokenSource.Token).HandleExceptions();

        return tokenSource;
    }

    //snip...

    protected WcfCommandResult RunCommand(Action<CancellationToken> action, CancellationToken token, bool isRestarting = false)
    {
        return RunCommand(x => { action(x); return true; }, token, isRestarting);
    }

    protected WcfCommandResult RunCommand(Func<CancellationToken, bool> action, CancellationToken token, bool isRestarting = false)
    {
        WcfCommandResult result = new WcfCommandResult();

        lock (_reconnectionLock)
        {
            if (_reconnecting && !isRestarting)
            {
                result.Completed = false;
                return result;
            }
        }

        lock (_channelLock)
        {
            if (Channel == null && !_closing)
            {
                token.ThrowIfCancellationRequested();
                Channel = GetNewChannel();
                var iChannel = (IClientChannel)Channel;
                var initResult = Initialize(token, false);

                if (initResult.Completed)
                {
                    Connected = true;
                    LogUtility.Info(string.Format("Connected to {0} at {1}", ServiceName, iChannel.RemoteAddress));
                }
                else
                    LogUtility.Info(string.Format("Failed to connect to {0} at {1}", ServiceName, iChannel.RemoteAddress));
            }
        }

        try
        {
            var channel = Channel;
            token.ThrowIfCancellationRequested();
            if (channel != null)
                result.Completed = action(token);
        }
        catch (FaultException e)
        {
            result.Exception = e;
            result.Detail = e.GetDetail<DurableFault>();
            LogUtility.Error(result.Exception);
        }
        catch (CommunicationException e)
        {
            Connected = false;
            result.Exception = e;
            IClientChannel channel = ((IClientChannel)Channel);
            if (channel != null)
                channel.Abort();
            Channel = null;
            if (!_reconnecting)
                LogUtility.Error(result.Exception);
        }
        catch (TimeoutException e)
        {
            Connected = false;
            result.Exception = e;
            IClientChannel channel = ((IClientChannel)Channel);
            if (channel != null)
                channel.Abort();
            Channel = null;
            if (!_reconnecting)
                LogUtility.Error(result.Exception);
        }
        catch (NullReferenceException e)
        {
            Connected = false;
            result.Exception = e;
            IClientChannel channel = ((IClientChannel)Channel);
            if (channel != null)
                channel.Abort();
            Channel = null;
            if (!_reconnecting)
                LogUtility.WriteException("Channel is null, it has either been disposed or not setup, call BeginSetupUser to create a new channel", e);
        }
        catch (ObjectDisposedException e)
        {
            Connected = false;
            result.Exception = e;
            IClientChannel channel = ((IClientChannel)Channel);
            if (channel != null)
                channel.Abort();
            Channel = null;
            if (!_reconnecting)
                LogUtility.Error(result.Exception);
        }
        catch (InvalidOperationException e)
        {
            Connected = false;
            result.Exception = e;
            IClientChannel channel = ((IClientChannel)Channel);
            if (channel != null)
                channel.Abort();
            Channel = null;
            if (!_reconnecting)
                LogUtility.Error(result.Exception);
        }

        return result;
    }

    //snip...
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T18:40:34.087

即使是异步调用，您的配置文件中也设置了超时。如果需要很长时间才能响应，您可能应该增加它。我认为默认是 1 分钟。在 Visual Studio 中，转到工具-> WCF 服务配置编辑器以轻松更改值。

如果您想查看配置的外观，这也可能对您有所帮助：[增加 WCF 服务中的超时值](https://stackoverflow.com/questions/424358/increasing-the-timeout-value-in-a-wcf-service)

您可以在该配置文件或后面的代码中设置它。

# grails - 获取列表中所有对象的 ID

> ID：11528759
> 
> 赞同：7
> 
> 时间：2012-07-17T18:38:17.267
> 
> 标签：grails

我有这样的课：

```
class Foo {
    String bar
} 
```

我正在尝试获取其String 在 list 中的所有`Foo`对象的 ID 。我尝试了几种方法，总是收到相同的错误：`bar``bars`

```
java.lang.String cannot be cast to java.util.Collection 
```

我尝试过的一些事情：

```
def ids = Foo.findAllByBarInList( bars )*.id
def ids = Foo.findAllByBarInList( bars ).collect{ it.id }
def ids = Foo.findAllByBarInList( bars ).collect{ it -> it?.id } 
```

**更新：**

我正在`bars`使用[split](http://groovy.codehaus.org/groovy-jdk/java/lang/String.html#split%28%29)所以它是一个数组，而不是一个列表。它让我失望，因为`Foo.findAllByBarInList( bars )`我的对象很好地归还了`Foo`，只有当我试图收集 id 时它才失败。我现在`bars`用[tokenize](http://groovy.codehaus.org/groovy-jdk/java/lang/String.html#tokenize%28%29)代替，一切都很好。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-17T18:57:28.860

只要`bars`是一个列表，它就对我有用

```
def bars = ['bar1', 'bar3']
def ids = Foo.findAllByBarInList(bars)*.id 
```

但是，如果您想要的只是`id`字段，那么从数据库中提取整个域类实例是一种浪费。目前只有一个字段，但实际上它可能是一个更大的表。所以我会使用 HQL 查询：

```
def ids = Foo.executeQuery(
   'select f.id from Foo f where f.bar in (:bars)',
   [bars: bars]) 
```

# shell - SSH：向本地后台发送远程命令

> ID：11528761
> 
> 赞同：3
> 
> 时间：2012-07-17T18:38:25.673
> 
> 标签：shell, ssh, tcpdump

所以我有一个类似于[如何将 ssh 作业发送到后台](https://stackoverflow.com/questions/8184717/how-to-send-ssh-job-to-background)的问题。

[我有一个 Windows c# 程序自动使用http://sshnet.codeplex.com/](http://sshnet.codeplex.com/)在远程 linux 操作系统上执行 tcpdump 。我正在尝试在远程 linux 上执行 tcpdump 并在断开连接后让它运行。

我一直在使用 plink 进行大量调试，但似乎无法达到预期的结果。我试过了：

```
plink root@10.5.1.1 bash -c "tcpdump -i eth0 -w test.cap" 
```

但它持有 sshclient 直到我 ctrl+C （不适用于自动化解决方案）。我还尝试了以下变体：

```
plink root@10.5.1.1 bash -c "tcpdump -i eth0 -w test.cap &" 
```

但是该命令根本不执行（test.cap 不存在）或立即终止（test.cap 包含 1 行）。在测试期间，我留下了一个 ping，所以捕获应该有一些 *东西*......

前面提到的链接解决了**screen**的问题，但是远程 linux os 是不可配置的并且没有**screen**。欢迎任何建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T18:42:21.433

在后一种情况下，您的`tcpdump`进程可能会在您断开连接时中止。尝试：

```
plink root@10.5.1.1 bash -c "nohup tcpdump -i eth0 -w test.cap &" 
```

请参阅手册页[`nohup`](http://linux.die.net/man/1/nohup)。您可能还需要考虑将 stdout 和 stderr 重定向到文件或`/dev/null`防止`nohup`将输出写入文件：

```
plink root@10.5.1.1 bash -c "nohup tcpdump -i eth0 -w test.cap >/dev/null 2>&1 &" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-18T03:06:03.247

我在启动远程应用程序时遇到了类似的问题。这种模式在 Debian 服务器上对我有用：

```
ssh root@server "nohup /usr/local/bin/app -c cfg &; exit" 
```

*另外：* 对于另一项测试，上述方法不起作用，即。该命令未在远程服务器上启动。添加一个在退出之前成功返回的命令似乎有效。

```
ssh root@server "nohup /usr/local/bin/otherapp &; w; exit" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-05-10T20:42:08.700

我有类似的情况：（在 Windows 机器上）我想创建一个 ms 批处理脚本来打开到树莓派的 SSH 连接并在后台执行本地脚本。我发现结合 Raj 和 fahd 的答案对我有用：

我的 ms 批处理脚本：

```
plink -load "raspberry Pi" -t -m startCommand.txt 
```

**startCommand.txt**的内容如下：

```
nohup /home/pi/myscript >/dev/null 2>&1 &
w
exit 
```

">/dev/null 2>&1 " 很重要！我发现（困难的方式）RPi 的 SD 卡通过一个非常大的 nohup.out 文件不断变满（并且使用完整的 SD 卡，RPi 甚至无法正确登录）

推理：

我使用 -load 在 PuTTY 中加载保存的会话（我这样做是因为我使用公钥/私钥而不是密码进行身份验证，但这应该与简单地输入主机相同）

然后 -t （由 Raj 推荐）

然后 -m 加载该文件中的命令列表

如果没有参数“-t”并且没有“w”和“exit”，我的批处理脚本只会运行，不会执行“myscript”并再次关闭。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-28T00:46:45.180

我遇到过同样的问题。我有一个脚本，其中我有 nohup tcpdump .... & 。我无法使用 ssh 运行它，因为它在 ssh 完成时死掉了。我想出的解决方案非常简单。我刚刚将 sleep 5 添加到脚本的末尾，它工作得很好。即使使用 nohup，在退出之前 tcpdump 似乎也需要几秒钟才能安全地进入后台。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-06T01:46:47.710

我遇到了同样的问题，我发现“-t”选项似乎对 nohup 很重要。我发现没有“-t”选项 nohup 不会生效。

`ssh -t user@remote 'nohup tcpdump -i any -w /tmp/somefile &>/dev/null & sleep 2'`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-06-05T22:57:37.907

我认为我已经做到了，至少在 IBM AIX 中

我在用着

```
ssh -tq user@host "/path/start-tcpdump.ksh" 
```

（身份验证由公钥完成）。我使用简单的“nohup tcpdump .... &”得到了不一致的结果，有时它有效，有时它没有，有时它甚至阻塞，我不得不断开会话。到目前为止，这一切正常，我真的不能说为什么它会起作用，但它是......

这是我的 start-tcpip.ksh

```
#!/usr/bin/ksh
HOST=$(uname -n)
FILTER="port not 22"
(tcpdump -i en1 -w $HOST-en1.cap $FILTER >/dev/null 2>&1 ) &
sleep 2
(tcpdump -i en2 -w $HOST-en2.cap $FILTER >/dev/null 2>&1 ) &
sleep 2
exit 0 
```

# css - 在 CSS 完全加载之前页面看起来很有趣

> ID：11528762
> 
> 赞同：0
> 
> 时间：2012-07-17T18:38:26.100
> 
> 标签：css, image, loading

我有这个网站，在加载 css 之前加载不完全，整个页面看起来很有趣大约一秒钟。它是用 wordpress 制作的，所以可能会有一些服务时间，但我认为没有什么可以做到这一点。

[http://hanrattyassoc.u4eastaging.com/section/product-highlight/](http://hanrattyassoc.u4eastaging.com/section/product-highlight/)

![一秒钟的样子](../Images/fdfc6f848a6f78ac3852278e89ea831d.png)

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-07-17T18:50:32.267

你可以做一个解决方法。添加样式**显示：无**或**不透明度：0** 到正文并创建一个 jquery 函数

```
$(document).ready(function(){
   $(body).animate({
      opacity : 1 }, 
      100
    ); 
```

这将在浏览器完成所有 css 和脚本加载后显示您的身体。

# c# - 使用 C# 从 excel 写入文本文件

> ID：11528767
> 
> 赞同：3
> 
> 时间：2012-07-17T18:38:42.803
> 
> 标签：c#, excel, c#-4.0

在 C# 中使用 Visual Studio 2010 并尝试从 Excel 工作表中获取文本文件中的输出。excel 表只包含一列，其数值如下：

```
ColumnA
-------
222
333
444
555
666
777
888
999
877
566
767
678
767 
```

我正在尝试像这样在文本文件中获取输出：

```
222, 333, 444, 
555, 666, 777, 
888, 999, 877, 
566, 767, 678,
767 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:43:11.200

这应该使用[BytesCout SpreadSheet SDK](http://bytescout.com/products/developer/spreadsheetsdk/bytescoutspreadsheetsdk.html)来完成：

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Text;
using Bytescout.Spreadsheet;

namespace Converting_XLS_to_TXT
{
class Program
{
static void Main(string[] args)
{
// Create new Spreadsheet from SimpleReport.xls file
Spreadsheet document = new Spreadsheet("SimpleReport.xls");

// delete output file if exists already
if (File.Exists("SimpleReport.txt")){
File.Delete("SimpleReport.txt");
}

// save into TXT
document.Workbook.Worksheets[0].SaveAsTXT("SimpleReport.txt");

}
}
} 
```

**参考：**

*   [BytesCout 电子表格教程](http://bytescout.com/products/developer/spreadsheetsdk/bytescoutxls_convert_excel_xls_into_text_txt_file.html)

# python - Python - SQL Server 调用不使用事务

> ID：11528770
> 
> 赞同：1
> 
> 时间：2012-07-17T18:38:56.313
> 
> 标签：python, sql-server, python-2.7, pyodbc

我有一个简单的 Python 脚本，我在其中发送对 SQL Server 2008 存储过程的调用，该存储过程又通过 xp_cmdshell 使用 bcp。当我通过管理控制台调用 SP 时，它工作得很好。当我从 python 脚本调用它时，它会挂起，因为执行会阻止用于 bcp 结果的 tempdb。

有没有办法在不使用事务的情况下从 Python 进行调用（因为我认为这个额外的附加组件正在锁定我的挂起调用）。

这是我的脚本：

* * *

```
import pyodbc as p

def CallExportFiles(conn, procName):
sql = "DECLARE @ret int EXEC @ret = [db].[dbo].[" + procName + "] @I_EMAILPROFILE = N\'SQL_AlertProfile\', @I_EMAILALERTS = N\'xxx@yyy.com\', @I_CUSTOMERID = N\'xxx\', @I_ENVIRO = N\'prod\', @I_COAFILENAME = N\'InvoiceGL\', @I_PERSONFILENAME = N\'Person\', @I_DELEGATESFILENAME = N\'Delegates\', @I_VENDORFILENAME = N\'InvoiceVendors\', @I_DIRECTORY = N\'\\\\xxx\\output\\yyy\\\', @I_ARCHIVEDIR = N\'\\\\xxx\\output\\yyy\\ARCHIVE\\\', @I_FAILUREDIR = N\'\\\\xxx\\output\\yyy\\FAILURE\\\' SELECT \'Return Value\' = @ret"
dbCursor = conn.cursor()
##Locks on this next execute call
dbCursor.execute(sql)
dbCursor.commit()

if __name__ == '__main__':
#connectin to the db with SQL Authentification
conn = p.connect(driver = '{SQL Server Native Client 10.0}', server = r'server', database = 'db', uid = 'sa', pwd = 'xxx')

if (conn == False):
    print 'Error, did not connect to the database'
else:
    CallExportFiles(conn, 'sp_export_files')

conn.close() 
```

* * *

在存储过程中调用时锁定的部分在此处执行（注意：此存储过程工作正常，使用 Management Studio 中的相同字符串调用：

* * *

```
SELECT CONVERT(varchar(1),'Z') AS [SORT],
CONVERT(varchar(64),'GLNumber') AS GLNUMBER,
CONVERT(varchar(1000),'GLDescription') AS GLDESCRIPTION,
CONVERT(varchar(4),'Type') AS [TYPE],
CONVERT(varchar(100),'GLStatusFlag') AS GLSTATUSFLAG,
CONVERT(varchar(100),'UDF1') AS UDF1,
CONVERT(varchar(100),'UDF2') AS UDF2,
CONVERT(varchar(100),'UDF3') AS UDF3,
CONVERT(varchar(100),'UDF4') AS UDF4,
CONVERT(varchar(100),'UDF5') AS UDF5
INTO ##BCP_Results1

INSERT INTO ##BCP_Results1([SORT],GLNUMBER,GLDESCRIPTION,[TYPE],GLSTATUSFLAG,UDF1,UDF2,UDF3,UDF4,UDF5)
SELECT 'A',
GLNUMBER,
GLDESCRIPTION,
[TYPE],
GLSTATUSFLAG,
UDF1,
UDF2,
UDF3,
UDF4,
UDF5
FROM dbname.DBO.GLACCOUNTS

set @sqlstring = 'bcp "SELECT GLNUMBER,GLDESCRIPTION,[TYPE],GLSTATUSFLAG,UDF1,UDF2,UDF3,UDF4,UDF5 FROM ##BCP_Results1 ORDER BY [SORT] DESC " queryout '+@I_DIRECTORY+@I_COAFILENAME+'-'+@I_ENVIRO+'-'+@I_CUSTOMERID+'-'+CONVERT(CHAR(10),GETDATE(),23)+'-'+ LEFT(CONVERT(CHAR(5),GETDATE(),114),2)+'-'+ RIGHT(CONVERT(CHAR(5),GETDATE(),114),2)+'.txt -c -t^| -U sa -P xxxx -S xserverx\xdbx'
EXECUTE master.dbo.xp_cmdshell @sqlstring
drop table ##BCP_Results1 
```

* * *

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T20:42:18.373

Change the value of the [autocommit](http://code.google.com/p/pyodbc/wiki/FAQs#Connecting_fails_with_an_error_about_SQL_ATTR_AUTOCOMMIT) property and that should resolve the issue.

# php - 使用 Symfony2 表单推进 1.6 i18n

> ID：11528771
> 
> 赞同：3
> 
> 时间：2012-07-17T18:38:58.217
> 
> 标签：php, forms, symfony, internationalization, propel

这里有人在 Symfony2 中使用过 Propel 的 i18n 行为吗？我似乎找不到任何关于此的信息，而且我不知道如何开始。

我期待将 Symfony2 表单与 Propel 1.6 i18n 一起使用，但我找不到任何关于如何将它们组合在一起的示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T12:23:44.300

尚未使用 Propel 和 Symfony2 为 i18n 做任何事情，但这里正在进行一项工作：[https](https://github.com/symfony/symfony/pull/5032) ://github.com/symfony/symfony/pull/5032 。

# sql - 通过在 Excel 中组合两列形成的新列中的额外空间

> ID：11528772
> 
> 赞同：0
> 
> 时间：2012-07-17T18:39:04.130
> 
> 标签：sql, excel, ms-access

我想在 Excel 中使用 SQL 组合数据库中的两列。

Concat(A,B) 作为 C。

问题是 C 在预期结果之后有一个额外的空格字符

有没有什么办法解决这一问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:40:19.903

如果它只是空格，您可以使用它`TRIM()`从结果中删除任何多余的空格

# jquery - jQuery 无冲突

> ID：11528774
> 
> 赞同：0
> 
> 时间：2012-07-17T18:39:13.427
> 
> 标签：jquery, scroller

在缅因州，Jan 转身了解如何修复此错误。

jQuery.noConflict - 如果你删除，那么一切正常，除了 thumbnailScroller。如何解决？

```
<script>

    function getItems() {
        alert('getItems1');

        $.get("/Product/Index", null, ajaxItems);
        alert('getItems2');
    }
    function ajaxItems(item) {
        alert(item);
        $("#index_items").replaceWith(item);
    }
</script>

<div id="create_form">
@Html.Action("Create", "Product")
</div>

@Html.Action("Index", "Product")

<script>

    jQuery.noConflict();

    (function ($) {
        window.onload = function () {
            $("#tS2").thumbnailScroller({
                scrollerType: "clickButtons",
                scrollerOrientation: "horizontal",
                scrollSpeed: 2,
                scrollEasing: "easeOutCirc",
                scrollEasingAmount: 600,
                acceleration: 4,
                scrollSpeed: 800,
                noScrollCenterSpace: 10,
                autoScrolling: 0,
                autoScrollingSpeed: 2000,
                autoScrollingEasing: "easeInOutQuad",
                autoScrollingDelay: 500
            });
        }
    })(jQuery);
</script>
<script src="@Url.Content("~/Scripts/jquery.thumbnailScroller.js")"></script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:44:16.697

移除`jQuery.noConflict();`并移动

```
<script src="@Url.Content("~/Scripts/jquery.thumbnailScroller.js")"></script> 
```

在您的内联`<script>`标签上方。

# asp.net-mvc - MvcApplication 的第二个实例

> ID：11528776
> 
> 赞同：3
> 
> 时间：2012-07-17T18:39:32.273
> 
> 标签：asp.net-mvc, castle-windsor

我正在尝试使用本文中描述的 IoC 实现 MembershipProvider：http: [//bugsquash.blogspot.cz/2010/11/windsor-managed-membershipproviders.html](http://bugsquash.blogspot.cz/2010/11/windsor-managed-membershipproviders.html)

但是我在实现 IContainerAccessor 的 MvcApplication 类方面存在一些问题。但是，当我尝试通过 MyMembershipProvider 中的代码访问容器时，容器为空引用。

```
(HttpContext.Current.ApplicationInstance as IContainerAccessor).Container 
```

我发现 MvcApplication 的第二个实例没有调用 Application_Start() 方法。因此没有实例被设置为 Container 属性。

为什么有第二个 MvcApplication 类实例？我以为只有一个实例。为什么没有调用 Application_Start() ？

我正在使用 .net4 和 mvc3。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:34:12.973

我终于找到了答案。我的问题与这个[Application_Start ASP.NET有关](https://stackoverflow.com/questions/7093026/application-start-asp-net)

有关 HttpApplication 类实例的信息在此博客文章[http://blog.andreloker.de/post/2008/05/HttpApplication-instances.aspx](http://blog.andreloker.de/post/2008/05/HttpApplication-instances.aspx)中，这是我正在寻找的答案。

# c# - 使用超过 2 个动态创建的 datagridview

> ID：11528784
> 
> 赞同：2
> 
> 时间：2012-07-17T18:39:57.433
> 
> 标签：c#

我正在开发一个 Windows 窗体应用程序。我的窗口窗体中有两个 tab2。在每个选项卡中，我构建了一个我将其命名为 dgvRound 的 datagridview。我将两组不同的数据加载到这两个选项卡中的两个 datagridview 中。当我从 tab1 切换到 tab2 时，我仍然看到 tab1 上的 datagridview 数据。如何更改它（货币？）以查看 tab2 中的 dgvRound，我用新数据更新 datagridview？

```
// tabView is my main tab page control
//  Add a new tab for a new round
string title = "Round " + Convert.ToString(intRound);
TabPage myTabPage = new TabPage(title);
tabView.TabPages.Add(myTabPage);

// set up datagridview box
DataGridView dgvRound = new DataGridView();
myTabPage.Controls.Add(dgvRound);
// set up the datagridview column and row headings
SetupTableView(dgvRound);

//load datagridview in a loop with different data from different dataset
string[] row1 = new string[] { "array of datas" };
dgvRound.Rows.Add(row1); 
```

我根据一些变量调用了上面的代码多次创建选项卡和 dgv。每个选项卡中每个数据网格中的数据都可以。但是，当我尝试从 tab2 中提取 datagridview (dgvRound) 中的数据时，我看到的是 tab1 中的数据而不是 tab2。例如：dgvRound.Rows[0].Cells["Game 1"].Value。我如何告诉它查看 tab2.dgvRound.Rows[0].Cells["Game 1"].Value？

感谢您的帮助丹尼尔

感谢HotSoft，我终于找到了在动态创建的标签页中搜索当前datagridview的代码。我添加了这个，它现在正在工作。TabPage CurrentTabPage = tabView.SelectedTab; // 在这里获取所有控件 Control.ControlCollection col = CurrentTabPage.Controls; // 应该只有一个 dgv foreach (Control myControl in col) { if (myControl.ToString() == "System.Windows.Forms.DataGridView") { DataGridView tempdgv = (DataGridView)myControl; tempdgv.SelectAll(); dgvRound = tempdgv；} } 再次感谢你的帮助...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T19:05:04.963

鉴于我看不到您在每个选项卡上动态创建 DataGridView 的代码

看起来您在两个选项卡上都显示了相同的 DataGrid，而没有重新加载或重新绑定不同选项卡上数据网格的不同数据源

**更新 OP 的评论：**

您可以像这样从标签页中获取 DataGridView

```
DataGridView dataGridView1 = tabPage1.Controls.OfType<DataGridView>() as DataGridView;
DataGridView dataGridView2 = tabPage2.Controls.OfType<DataGridView>() as DataGridView; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T19:04:59.290

为什么不为每个 tabPage 创建两个不同的 DataGridView？或者，如果您只想在两个选项卡上使用 1 个 dgv，则将其清除（将数据源设置为 null）并为下一个选项卡设置新数据源。

# haskell - 通过类型系统表达可选的函数集

> ID：11528787
> 
> 赞同：1
> 
> 时间：2012-07-17T18:40:17.527
> 
> 标签：haskell

我有一个类型类`Shape`，它声明了所有形状共有的许多函数。其中一个函数 ( `refine`) 需要返回一个子形状列表。为了表达这个约束，我使用存在量化：

`data Shapeable = forall a . Shape a => Shapeable a`

并有函数 return `[Shapeable]`。我有一个额外的限制，即可以优化某些形状（通过`refine`函数），而其他形状可以检查交叉点（通过`intersect`函数）。这些是相互排斥的，因为可以优化自身的形状不能检查相交，反之亦然。

如果我不使用量化，我会再创建两个类型类：`Intersectable`和`Refineable`. 有没有办法在像系统这样的单一类型类中表达不相交的函数集？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T18:42:53.740

我建议这样的事情：

```
data Shape
    = Composite
        { refine :: [Shape]
        , {- other type-class methods go here -}
        }
    | Primitive
        { intersect :: Shape -> Region
        , {- other type-class methods go here -}
        } 
```

...并完全跳过类型类和存在量化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T19:24:04.970

我相信你能得到的最接近的是有两个存在的案例：

```
data Shapeable =
    forall a . (Shape a, Intersectable a) => Intersectable a |
    forall a . (Shape a, Refineable a) => Refineable a 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T23:29:17.793

我建议根本不要使用类型类。将您的操作定义为简单的数据类型：

```
data ShapeOps a =
    ShapeOps {
      intersect :: Maybe (a -> a),
      refine    :: Maybe (a -> a)
    } 
```

然后你可以使用存在量化：

```
data Shape =
    forall a. Shape (ShapeOps a) a 
```

这个概念更容易考虑：

```
data Shape =
    forall a.
    Shape {
      intersect :: Maybe (a -> a),
      refine    :: Maybe (a -> a),
      shape     :: a
    } 
```

使用`Maybe`只是一个例子。您还可以使用*RankNTypes*代替存在量化：

```
newShape ::
    (forall a. (a -> a) -> a -> b) ->
    (forall a. (a -> a) -> a -> b) ->
    ShapeConfig ->
    b 
```

如果它有交集，这个函数可以将形状传递给第一个延续，如果它有细化，则传递给第二个延续。你可以想出各种组合方式。使用`Monoid`或者`Alternative`您甚至可以同时执行以下操作：

```
newShape ::
    (Alternative f) =>
    (forall a. (a -> a) -> a -> f b) ->
    (forall a. (a -> a) -> a -> f b) ->
    ShapeConfig ->
    f b 
```

使用 RankNTypes 的优点是您可以编写更灵活的函数。您现在可以拥有折叠、地图或任何您想要的东西，而不是简单的构造函数。

# vb.net - 将项目从 vb6 转换为 vb.net Visual Studio 2008

> ID：11528797
> 
> 赞同：1
> 
> 时间：2012-07-17T18:40:49.480
> 
> 标签：vb.net, visual-studio-2010, visual-studio-2008, vb6, vb6-migration

我想将我的旧 vb6 项目转换为 vb.Net 解决方案，当我打开时：`File->Open->Convert`这就是我得到的：

![在此处输入图像描述](../Images/f343fbe006eb870a0c2a1f89b8a29f83.png)

而且我找不到显示可用转换器的方法...

我尝试过：

*   安装框架 1.0，因为我在某处读到需要它
*   试图安装框架 2.0 但它说“我有它”但它没有显示在卸载程序列表中
*   尝试安装framework 3.0，和以前一样。
*   我什至尝试添加`Microsoft.VisualBasic.UpgradeWizard.dll`via，`regasm`但我无法在 VS2008 中打开控制台命令，仅在 VS2010 中，并且我读过 VS2010 无法处理从 vb6 到 vb.net 的转换，它必须先通过 VS2008。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T22:35:58.213

好吧，解决方案是安装 Visual Studio 2005，然后转换器可用：

我想我需要框架 1.0。

![显示升级向导的图像](../Images/a88c829301d83c175f585ae8069464ab.png)

它并不完美，它有一些错误，但它是一个完整的解决方案的一步。

当然，我发现了一些其他的 3rd 方转换程序，但它们很昂贵：

*   [ArtInSoft](http://www.artinsoft.com/)
*   [视觉WebGUI](http://www.visualwebgui.com/)

希望它可以帮助别人！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T18:53:57.653

不知道转换对话框的用途是什么——帮助中没有任何内容。

根据这个[论坛帖子](http://social.msdn.microsoft.com/Forums/en/vbinterop/thread/8709a99b-e124-453e-bcf3-46d03deadc64)，您可以在 Visual Studio 中打开 vbp，它应该要求转换项目（在 VS 2010 中没有打开 .vbp 文件的选项）。然而，即使它在 VS 2010 中仍然这样做，这也是一个非常糟糕的主意。

另请参阅[这篇](http://visualbasic.about.com/b/2011/01/24/converting-vb6-to-vb-net.htm)关于将 VB6 转换为 VB.NET 的帖子。

另外，检查这些重复的 SO 问题：

*   [VB6 到 VB.NET 的转换](https://stackoverflow.com/questions/1678064/vb6-to-vb-net-conversion)
*   [如何将大型应用程序从 Vb6 切换到 VB.net](https://stackoverflow.com/questions/395/how-to-switch-a-large-app-from-vb6-to-vb-net)
*   [从 VB6 迁移到 .NET 的最佳策略](https://stackoverflow.com/questions/683918/best-strategy-for-moving-from-vb6-to-net)

~~**编辑：** 根据[这个 MSDN Page](http://support.microsoft.com/kb/317885#appliesto)，转换向导只能升级到 Visual Studio 2005~~

**编辑 编辑：**根据 MarkJ 的评论，Visual Studio 2008[包括升级向导](http://msdn.microsoft.com/en-us/library/47s4twtx%28v=vs.90%29.aspx)。它在 VS 2010 中消失了。

# c - 结构对齐问题

> ID：11528799
> 
> 赞同：2
> 
> 时间：2012-07-17T18:41:06.723
> 
> 标签：c, memory-management, embedded, embedded-linux

我的编译器要求我有一个内存对齐的结构声明，以确保正确的数据访问。我有一个顶层结构，它由一些其他结构组成。确保顶部结构与 32 字节边界对齐是否足够，或者我需要确保每个结构都应与 32 字节边界对齐。代码片段如下：-

```
typedef struct {
   int p;
   int q;
   char n;
} L;

typedef struct {
   int c;
   int d;
   char e;
   L    X2[13];
} B;

typedef struct {
   int a;
   int b;
   B   X1[10];
} M; 
```

为了确保正确的数据访问，我是否需要确保所有结构都正确对齐内存，或者填充最顶部的结构将确保内存对齐。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T20:27:24.237

有时*您的应用程序*可能需要特定的布局，但如果在这种情况下如您所说，这是编译器的要求（或者更准确地说可能是编译器的目标架构），那么编译器有责任确保满足这些要求。

如果您需要编译器根据目标要求自然强制执行的对齐方式，您将需要编译器特定的指令来打包和对齐；然而，应用这样的指令并弄错比让编译器处理它更容易导致对齐错误。如果您尝试通过添加自己的填充成员来对齐，它可能会起作用，但不是必需的，编译器也可能会插入自己的额外填充。

关键是编译器不会生成一个结构，其成员无法安全有效地寻址。它将在成员之间插入任何必要的填充，以确保后续成员是可寻址的。

如果你不相信它会起作用，让你的链接器输出一个映射文件（如果它还没有这样做的话）并检查这些符号的地址以验证正确的对齐方式。还要查看结构的生成大小；您可能会发现其中一些大于它们各部分的总和——即编译器通过插入填充来强制对齐。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T21:04:26.823

如果您可以使用它，如果您的应用程序（或架构或性能）需要它，C11 有对齐声明：[http ://en.wikipedia.org/wiki/C11_%28C_standard_revision%29](http://en.wikipedia.org/wiki/C11_%28C_standard_revision%29)

*   对齐规范（_Alignas 说明符、alignof 运算符、aligned_alloc 函数、头文件）

GCC 肯定也有扩展。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T17:25:27.527

如果要使用自然对齐，则必须对字段进行排序并手动填充到自然字长。不保证可移植性，但对于特定的处理器，这是可以做到的（在嵌入式世界中并不罕见）。如果 sizeof(int) 为 4，则必须向子结构添加填充以确保数组对齐（我假设您的目标是避免编译器添加的“秘密”填充？）。例如 ：

```
typedef struct {
   int p;
   int q;
   char n;
   char pad[3];
} L;

typedef struct {
   int c;
   int d;
   char e;
   char pad[3];
   L    X2[13];
} B;

typedef struct {
   int a;
   int b;
   B   X1[10];
} M; 
```

通常不会导致结构中的“隐藏”对齐。

# iphone - UIGraphicsBeginImageContext 线程安全吗？

> ID：11528803
> 
> 赞同：1
> 
> 时间：2012-07-17T18:41:13.587
> 
> 标签：iphone, ios, cocoa, uikit

所以我一直觉得 UIGraphicsBeginImageContext 是线程安全的，可以从任何线程调用来创建一个新的 CGContextRef 可以用来绘制。

但是，当前的[文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIKitFunctionReference/Reference/reference.html)指出

`"You should call this function from the main thread of your application only."`

但是，在 WWDC 2012 会议视频“构建并发用户界面”中，演讲者显示您实际上可以在后台绘制，并在后台调用该方法：

![在此处输入图像描述](../Images/2377dc230bd8452ac32b30f35a177441.png)

![在此处输入图像描述](../Images/685ef3604f7ec72294a8a0c5e75b6407.png)

![在此处输入图像描述](../Images/c370663563fd33dd439a1fb1b6f4d48e.png)

如您所见，他向 a `_queue`（在 BG 线程上运行）添加了一个操作，它调用`renderedGraphOfSize`，它调用`UIGraphicsBeginImageContext`。那么有什么关系呢？在后台绘图时，我的应用程序出现了一些崩溃，所以我不知道为什么 Apple 会出现令人困惑的示例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-25T12:05:34.287

从文档中引用：

> 在 iOS 4 及更高版本中，您可以从应用程序的任何线程调用此函数。

链接：http: [//developer.apple.com/library/ios/#documentation/UIKit/Reference/UIKitFunctionReference/Reference/reference.html](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIKitFunctionReference/Reference/reference.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T20:51:00.970

UIGraphicsBeginImageContext 在 iOS 4 及更高版本中绝对是线程安全的。WWDC 2012 会议视频与 iOS 6 相关，所以也许您也应该与 iOS 6 文档相关:)

# c# - 我的性能计数器在哪里？它已创建，但我在 perfmon 中看不到它

> ID：11528804
> 
> 赞同：7
> 
> 时间：2012-07-17T18:41:19.437
> 
> 标签：c#, .net, perfmon

我有这段代码：我在哪里创建我的性能计数器。它执行正常，如果不存在，它也会创建性能计数器，但是当我使用 perfmon 时找不到这个性能计数器。

怎么了？

```
 const string _categoryName = "MyPerformanceCounter";
    if (!PerformanceCounterCategory.Exists(_categoryName))
    {
        CounterCreationDataCollection counters = new CounterCreationDataCollection();

        CounterCreationData ccdWorkingThreads = new CounterCreationData();
        ccdWorkingThreads.CounterName = "# working threads";
        ccdWorkingThreads.CounterHelp = "Total number of operations executed";
        ccdWorkingThreads.CounterType = PerformanceCounterType.NumberOfItems32;
        counters.Add(ccdWorkingThreads);

        // create new category with the counters above
        PerformanceCounterCategory.Create(_categoryName,
                "Performance counters of my app",
                PerformanceCounterCategoryType.SingleInstance,
                counters);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T11:11:47.047

没有收到任何异常的原因是缺少 try-catch 块。如果您像这样在 try 和 catch 块中添加语句

```
 try
        {                
            const string _categoryName = "MyPerformanceCounter";
            if (!PerformanceCounterCategory.Exists(_categoryName))
            {
                CounterCreationDataCollection counters = 
                new CounterCreationDataCollection();

                CounterCreationData ccdWorkingThreads = new CounterCreationData();
                ccdWorkingThreads.CounterName = "# working threads";
                ccdWorkingThreads.CounterHelp = "Total number of operations executed";
                ccdWorkingThreads.CounterType = PerformanceCounterType.NumberOfItems32;
                counters.Add(ccdWorkingThreads);

                // create new category with the counters above
                PerformanceCounterCategory.Create(_categoryName,
                        "Performance counters of my app",
                        PerformanceCounterCategoryType.SingleInstance,
                        counters);
            }                
        }
        catch(Exception ex)
        {
            MessageBox.Show(ex.ToString()); //Do necessary action
        } 
```

然后它将捕获异常。如果您看到“不允许请求的注册表访问”之类的异常。那么你需要管理权限来做这些事情。要确认这一点，使用管理权限运行 Visual Studio 并执行代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-09T14:26:53.057

除了以管理员身份运行 Visual Studio 以允许创建类别之外，我遇到了同样的问题 - .NET 代码报告计数器在那里，但在 perfmon 中没有可见的此类计数器类别。

显然 perfmon 有时会[通过在注册表中将其标记为禁用来禁用性能计数器](https://stackoverflow.com/questions/10341079/windows-performance-counters-disappearing-from-perfmon#11801008)。

如果您[在注册表中检查，](http://support2.microsoft.com/kb/248993)您`HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services`应该能够找到您的性能计数器类别（只需将您的类别名称作为“文件夹”之一查找）。在子项（“文件夹”）下`Performance`找到注册表值`Disable Performance Counters`并将其设置为零。重新启动 perfmon，您现在应该在 perfmon 中看到您的类别和计数器。

# jquery - JqG rid：设置“未选择行”对话框的位置

> ID：11528806
> 
> 赞同：2
> 
> 时间：2012-07-17T18:41:22.960
> 
> 标签：jquery, asp.net-mvc, jqgrid

[所以我在这里](https://stackoverflow.com/a/10335710/1532659)找到了一些很好的修复方法，可以将确认删除、编辑、查看等对话框居中。但是，当网格上**没有**选择行时，将出现一个不同的对话框，显示一个简单的“警告：请选择行”。除了这个对话框的语法很糟糕之外，我似乎找不到任何方法来处理这个对话框的事件，以便我可以根据需要重新定位。

我为我能找到的 navGrid 中的每个事件添加了处理程序，并使用 BugZilla 来查看它是否会在任何这些事件上停止但无济于事。***选择行时***，它将释放删除事件罚款。想法？下面是我的代码：

```
$('#sessionGrid').jqGrid({...}).navGrid('#sessionPager', { 
            add: false,
            edit: false,
            del: true,
            search: false,
            closeOnEscape: true
        }, {
            afterShowForm: function (form) {
                form.closest('div.ui-jqdialog').center();
            }
        }, {
            afterShowForm: function (form) {
                form.closest('div.ui-jqdialog').center();
            }
        }, {
            caption: "Delete",
            msg: "Delete the selected sessions?",
            bSubmit: "Delete",
            bCancel: "Cancel",
            afterShowForm: function (form) {
                form.closest('div.ui-jqdialog').center();
            }
        }, {
            afterShowForm: function (form) {
                form.closest('div.ui-jqdialog').center();
            }
        }, {
            afterShowForm: function (form) {
                form.closest('div.ui-jqdialog').center();
            }
        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T21:41:43.663

[grid.formedit.js](https://github.com/tonytomov/jqGrid/blob/master/js/)中的以下代码用于显示此对话框：

```
if (o.del) {
    tbd = $("<td class='ui-pg-button ui-corner-all'></td>");
    pDel = pDel || {};
    $(tbd).append("<div class='ui-pg-div'><span class='ui-icon "+o.delicon+"'></span>"+o.deltext+"</div>");
    $("tr",navtbl).append(tbd);
    $(tbd,navtbl)
    .attr({"title":o.deltitle || "",id: pDel.id || "del_"+elemids})
    .click(function(){
        if (!$(this).hasClass('ui-state-disabled')) {
            var dr;
            if($t.p.multiselect) {
                dr = $t.p.selarrrow;
                if(dr.length===0) {dr = null;}
            } else {
                dr = $t.p.selrow;
            }
            if(dr){
                if($.isFunction( o.delfunc )){
                    o.delfunc.call($t, dr);
                }else{
                    $($t).jqGrid("delGridRow",dr,pDel);
                }
            } else  {
// !!! The actual dialog is displayed here  -
                $.jgrid.viewModal("#"+alertIDs.themodal,{gbox:"#gbox_"+$.jgrid.jqID($t.p.id),jqm:true});$("#jqg_alrt").focus();
            }
        }
        return false;
    }).hover(
        function () {
            if (!$(this).hasClass('ui-state-disabled')) {
                $(this).addClass("ui-state-hover");
            }
        },
        function () {$(this).removeClass("ui-state-hover");}
    );
    tbd = null;
} 
```

不幸的是，jqGrid 没有为此公开事件。但是您可能会幸运地将自己的函数绑定到删除按钮的`click`事件。在同一个文件中，您可以看到 DOM ID 是如何分配给删除按钮的：

```
.attr({"title":o.deltitle || "",id: pDel.id || "del_"+elemids}) 
```

本质上，您可以将`id`参数作为删除参数的一部分传递，或者如果您不这样做，它将默认`elemids`分配给哪个网格的 DOM ID（例如：您的选择器将是`'#del_mygrid'`）。

`jQuery('div.ui-jqdialog').center();`无论如何，您可以在事件处理程序中使用类似的东西`click`来根据需要重新定位对话框。

这有帮助吗？

* * *

顺便说一句，实际的对话文本在`grid.locale-en.js`-

> alerttext: "请选择行",

我同意这太可怕了 :) 好消息是这是一个单独的 js 文件，因此您可以根据需要对其进行修改。

# html - 在 HTML 页面中实现 CSS 变量

> ID：11528807
> 
> 赞同：1
> 
> 时间：2012-07-17T18:41:27.507
> 
> 标签：html, css, image, variables

我有一个 HTML 文件，其中包含外部 CSS 文件中提到的许多背景图像和颜色，并且它链接在 HTML 的 header 标记内。

我想使用 CSS 变量来捕获背景图像和颜色的路径，并在 HTML 文件中使用它。

是否可以在不使用任何 Javascript 或服务器端语言或插件的情况下使用 CSS 变量。我只能使用纯 CSS 和 HTML 来实现这一点。我也看过[http://lesscss.org](http://lesscss.org)网站，但他们使用了一些插件，我无法使用。

这是可以实现的吗？如果是，任何人都可以编写一些示例代码吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T20:02:34.740

目前这在跨浏览器的方式中是不可能的，但该功能[正在被](http://dev.w3.org/csswg/css-variables/)指定，并有望在未来几年内广泛使用:)

## 建议的语法

```
:root { 
    var-main-background: #f00;
    var-main-color: #111;
}
h1 { 
    background: $main-background;
    color: $main-color;
} 
```

***注意：**这目前在浏览器中不可用，因此您必须同时使用诸如 LESS 或 SASS 之类的解决方法。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T18:45:28.050

我认为实现这一目标的唯一方法是使用 LESS。

[http://lesscss.org/](http://lesscss.org/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T18:54:28.440

LESS中有CSS变量，大家投反对票前请看问题。

LESS 是一个 javascript 文件，它将用这些 CSS 变量替换它们各自的值。使用纯 HTML 和 CSS 无法实现这一点。这就是为什么首先创建 LESS 和其他动态样式表语言的原因。

# asp.net-mvc - 保存/存储客户采购订单数据的最佳方式？

> ID：11528808
> 
> 赞同：0
> 
> 时间：2012-07-17T18:41:27.943
> 
> 标签：asp.net-mvc, database, asp.net-membership, e-commerce

我有一个自定义会员提供程序，我扩展了它 - 添加了几个字段，名字，姓氏，地址，邮政编码和城市。

现在，这些字段位于 aspnet_Membership 表中，因此我可以在使用静态 Membership asp.net 类时轻松访问它们。

现在，我希望能够将客户采购订单数据（名字、姓氏、地址、邮政编码和城市）保存到数据库中。

我应该在我的订单模型/表中使用一组新的字段 - 名字、姓氏、地址、邮政编码、城市还是应该在我的 asp_Membershihp 表和我的 Orders 表之间创建关系？

此外，如果我有欺骗数据，一旦用户要求删除他的帐户，如果我使用第一种方法，我的 Orders 表中将不会有任何孤立行。

因此，最好将用户数据、名字、姓氏、地址、邮政编码、城市放在一个表中，并在 aspnet_Membership 表和 Orders 表之间创建关系，或者在我的 Orders 表中创建与aspnet_Membership 表？优点缺点？

谢谢！

/P

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:09:07.767

在这种情况下，我宁愿有这种关系。

也是您存储订单的数据（我至少假设，从名称:)）我将在订单上维护一组单独的数据，因此可以选择指定与身份不同的计费/运输数据地点。

在订单表上复制至少一些数据的另一个正当理由是在表中包含与订单相关的所有必要数据，从而避免客户要求删除他的数据时出现问题，并保持该数据的原始值如果客户数据要及时更改，则订单。

但是，如果可以，则不应实际删除用户数据，而应在其中指定用户是活动还是已删除的字段。

# ios - iOS Facebook SDK - 将 UIImage 发布到用户的墙上

> ID：11528811
> 
> 赞同：1
> 
> 时间：2012-07-17T18:41:40.243
> 
> 标签：ios, facebook-graph-api, uiimage

好的，所以有很多线程，但似乎没有什么对我有用。

我的应用程序允许用户将照片（由应用程序的屏幕截图创建的 UIImage）发布到 Facebook。

但是，我目前只能使用以下方式发布照片：

```
 NSMutableDictionary* params = [NSMutableDictionary dictionaryWithObjectsAndKeys:[[appDelegate facebook] accessToken], @"access_token",nil];
    [params setObject:@"Caption" forKey:@"name"];
    [params setObject:[self captureScreen] forKey:@"source"];
    if([[appDelegate facebook] requestWithGraphPath:@"me/photos" andParams: params andHttpMethod: @"POST" andDelegate:(id)self]){
        [self.view addSubview:[Memos showMemo:facebookMemo]];//Show success alert
    } 
```

这工作正常，但不使用任何类型的 FB 对话框。我真的很想使用该对话框，以便用户感觉它更像是“facebook 官方”，并允许他们预览/确认帖子。

有什么简单的方法可以做到这一点吗？这是我得到的最接近的：[Post photo on user's wall using Facebook iOS SDK](https://stackoverflow.com/questions/6702135/post-photo-on-users-wall-using-facebook-ios-sdk)，但我对这些行有疑问：

```
currentAPICall = kAPIGraphUserPhotosPost; 
```

由于 xcode 无法识别任何 kAPI... 对象... 建议？

# java - IDE 中的 JSON 异常

> ID：11528814
> 
> 赞同：0
> 
> 时间：2012-07-17T18:41:47.020
> 
> 标签：java, json, ide

我使用以下函数调用

```
String subjects = callWebService(query);
DisplaySubjects(subjects); 
```

但是我在 IDE 中得到了一个 JsonException，所以我什至无法编译它。主题将是从 Ws 返回的有效 Json 字符串。（已测试）

```
public void displaySubjects(String subjects) throws JSONException 
{
    try 
    {
        ArrayList<String> stringArray = new ArrayList<String>();
        JSONArray jsonArray = new JSONArray(subjects);
            for (int i = 0; i < jsonArray.length(); i++) 
            {
                stringArray.add(jsonArray.getString(i));
            }
        ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
                android.R.layout.simple_list_item_1, android.R.id.text1, stringArray);

        setListAdapter(adapter);

    } 
    catch (JSONException e) 
    {
        throw new RuntimeException(e);
    }
} 
```

我不知道为什么？

编辑：当我去编译时，我在调用者行上收到此错误：错误：未报告的异常 JSONException; 必须被抓住或宣布被扔掉。但我这样做对吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T00:11:17.343

displaySubjects() 方法抛出 JSONException （可能怀疑）是已检查异常的子类，这意味着此方法的调用者需要捕获此异常，即包含在 try{}catch 中或抛出从 displaySubjects( ）。

简单地说，例如，如果您从另一个方法调用它：

```
public void displayControl(String json){
  try{
    displaySubjects(json);
  }catch(JSONException){
    // do something
  }
} 
```

或者你可以抛出那个异常。

```
public void displayControl(String json) throws JSONException{
  displaySubjects(json);
} 
```

除此之外，我注意到 displaySubjects() 方法捕获任何 JSONException 的出现并作为运行时异常重新抛出。这样做的效果是，实际上，您不需要从 displaySubjects() 显式抛出 JSONException。因此，除非您无意中从内部捕获 JSONException 并将其作为运行时异常重新抛出，否则您可能会从 displaySubjects() 中删除 throws JSONException 子句。

不需要捕获运行时异常。

# actionscript-3 - 从主时间线移除在影片剪辑中调用的声音

> ID：11528818
> 
> 赞同：0
> 
> 时间：2012-07-17T18:42:19.700
> 
> 标签：actionscript-3

当我在特定项目的时间线上前进时，我目前很难从播放中删除特定的声音。

用户选择时间轴上的特定项目，该项目将显示特定的影片剪辑，然后将在 MOUSE_DOWN 上播放特定的声音。

MOUSE_DOWN 的 eventListener 存在如下：

```
stage.addEventListener(MouseEvent.MOUSE_DOWN, sprayWater);
stage.addEventListener(MouseEvent.MOUSE_UP, stopWater);

function sprayWater(event:MouseEvent):void
{
    waterarm.gotoAndStop(2);
    trace("SPRAYING WATER");    
}

function stopWater(event:MouseEvent):void
{
    waterarm.water.gotoAndPlay("waterE");   
} 
```

在“waterarm”的第 2 帧上是一个名为“water”的电影剪辑，其中包含水的动画和以下用于启动水声的代码：

```
var sfxWater:sfxwater;
var waterChannel:SoundChannel;
sfxWater = new sfxwater;
waterChannel = sfxWater.play(); 
```

在“waterE”帧上，存在水消失的动画和代码`sfxWater.stop();`。

当用户在根时间轴上超过这一帧时，水的声音效果仍然保留在 MOUSE_DOWN 上，尽管此时时间轴上不再存在动画剪辑。

理想的结果是只有当该影片剪辑在主时间轴上可见时，才会在 MOUSE_DOWN 上播放单个声音并在 MOUSE_UP 上停止。如果有人可以提供任何帮助来阻止声音播放和删除此事件侦听器（如果可能，通过主时间线上的代码），我们将不胜感激。

问候，达伦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T12:23:53.717

如果您只想停止声音，为什么不使用`SoundMixer.stopAll()`.

您可以在检查所述影片剪辑的`visible`属性后在 MOUSE_UP 事件中使用它。

# xml - 使用 Java 泛型（集合）解组 XML

> ID：11528820
> 
> 赞同：1
> 
> 时间：2012-07-17T18:42:23.203
> 
> 标签：xml, jaxb, unmarshalling

我需要对通过 Yahoo 的 YQL Webservices 获得的一段 XML 进行解组。XML 如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<query xmlns:yahoo="http://www.yahooapis.com/v1/base.rng" yahoo:count="8" yahoo:created="2012-07-16T16:43:15Z" yahoo:lang="en-US">
<results>
    <results>
    <GsearchResultClass>GwebSearch</GsearchResultClass>
    <unescapedUrl>http://www.test.com/nl/nieuws</unescapedUrl>
    <url>http://www.test.com/nl/nieuws</url>
    <visibleUrl>www.test.com</visibleUrl>
    <cacheUrl>http://www.google.com/search?q=cache:0B4z0dyd94gJ:www.test.com</cacheUrl>
    <title>Nieuws | test.com</title>
    <titleNoFormatting>Nieuws | test.com</titleNoFormatting>
    <content>text text text text text text text text  &lt;b&gt;...&lt;/b&gt;</content>
    </results>
    [...]
</results>
</query> 
```

顺便说一句，重复的“结果”键不是错误。

我正在尝试使用以下类来解组它：

```
@XmlRootElement(name="query")
public class YQL<T> {

    List<T> results;

    @XmlElementWrapper(name="results")
    @XmlElement(name="results")
    public List<T> getResults() {
        return results;
    }

    public void setResults(List<T> results) {
        this.results = results;
    }   
}

@XmlType
public class SearchResult{

    String url,title,content;

    @XmlElement
    public String getUrl() {
        return url;
    }

    public void setUrl(String url) {
        this.url = url;
    }
[...]

public class YQLFeedReaderImpl<T> implements FeedReader<YQL<T>> {

private Class<T> resultClazz;

[...]

final JAXBContext context = JAXBContext.newInstance(YQL.class,resultClazz);

final Unmarshaller unmarshaller = context.createUnmarshaller();

URL url = new URL([....]);

return (YQL<T>) unmarshaller.unmarshal(url); 
```

我为 T 元素返回的是通用 ElementNSImpl 而不是 SearchResult。

关于如何处理这个问题的任何建议？

干杯，马克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T16:47:16.567

我最终重构了代码，使 YQL 成为接口 YQL 而不是类，并创建了一个实现该接口的类 GoogleYQL 并将整个 GoogleYQL 类视为 T。这很有效。仍然很好奇上述问题是否可以解决。

# java - hibernate 做预测缓存吗？

> ID：11528827
> 
> 赞同：5
> 
> 时间：2012-07-17T18:42:36.567
> 
> 标签：java, hibernate, sql-server-2008-r2

我们的 DBA 刚回来，对我们的 SQL 服务器数据库进行了长时间运行的查询。他认为我们应该审查该查询，看看我们是否可以优化。

问题是查询不是来自我们的应用程序代码。它通过主键从单个表中加载许多记录，准确地说是 9 条，并且我们从来没有通过应用程序的主键对该表进行任何查询。它也绝对是一个休眠查询，名称为 hibernate 所做的修改和所有属性的加载。

所以我想知道hibernate是否会做一些预测缓存，比如提取它认为我以后可能想要的记录。对此有任何意见吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T18:51:34.847

这可能是由于[批量获取](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html_single/#performance-fetching-batch)而执行的查询：

> 使用批量获取，如果访问一个代理，Hibernate 可以加载多个未初始化的代理。批量抓取是对惰性选择抓取策略的优化。
> 
> 类/实体的批量获取更容易理解。考虑以下示例：在运行时，您在 Session 中加载了 25 个 Cat 实例，每个 Cat 都有对其所有者的引用，即 Person。Person 类使用代理lazy="true" 进行映射。如果您现在遍历所有猫并在每个猫上调用 getOwner()，默认情况下，Hibernate 将执行 25 个 SELECT 语句来检索代理的所有者。您可以通过在 Person 的映射中指定批量大小来调整此行为：
> 
> ```
> <class name="Person" batch-size="10">...</class> 
> ```
> 
> Hibernate 现在将只执行三个查询：模式是 10、10、5。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:00:24.270

Hibernate 自己不做任何预测缓存，除了[批量获取/子选择获取](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html/performance.html#performance-fetching-batch)。

但是，Hibernate 可以隐式获取您请求的实体 - 例如，它获取急切关系的目标并在惰性关系的情况下初始化访问的惰性代理。

因此，如果有问题的表充当某些关系的目标，您需要检查这些关系是否急切，以及如果它们是惰性的，您如何访问它们。

# java - 将变量从服务传递到活动

> ID：11528829
> 
> 赞同：0
> 
> 时间：2012-07-17T18:42:38.170
> 
> 标签：java, android, android-activity

我正在尝试将我的服务类 VandroidService2 中的变量传递给我的活动类 VandroidServiceClient：这是发送 VandroidService2 中的变量的代码：

```
 long accel = 8987; 
         Intent myIntent = new Intent(VandroidService2.this,VandroidServiceClient.class);
         myIntent.putExtra("accel1", accel); 
```

这是我用来在 VandroidServiceClient 中接收它的代码：

```
 TextView textView = (TextView) findViewById(R.id.textViewName);
           Intent mIntent = getIntent();
           long lovalue = mIntent.getLongExtra("accel1", 0);
           textView.setText(String.valueOf(lovalue)); 
```

出于某种原因，默认变量 0 正在显示到屏幕上？我做错了什么，是否需要更多信息来帮助我？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T18:49:47.500

尝试`intent.getExtras()`，检查是否不为空，如果不为空则`.getLong("accel1", 0);`

如果你***确定***你以前做过什么，这将起作用。

# javascript - requireJS 使用 require 加载文本

> ID：11528831
> 
> 赞同：3
> 
> 时间：2012-07-17T18:42:46.157
> 
> 标签：javascript, backbone.js, requirejs

我正在使用带有 requireJS 的主干，并且我有几个模板文件，我想使用 require() 加载模板而不将其传递到模块定义中，例如在视图中的登录函数中，我想做类似的东西

```
var html = require( ['text!templates/users/login_form.html'] ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T21:32:26.417

你下载了RequireJS`text`插件吗？您需要下载它并将其放到您的项目中，然后 RequireJS 才能使用文本资源作为依赖项。您可以在项目页面和他们的[API 文档](http://requirejs.org/docs/api.html#text)中阅读有关它[的](https://github.com/requirejs/text#usage)信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T20:01:18.587

是的你可以！

```
loginTemplate = require(['text!templates/users/login_form.html'], 
                        function(Template) {
                         return Template;
                        }); 
```

这应该可以帮助你:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T20:01:48.080

您可以在模块定义中要求“require”作为依赖项

```
define(["require", "other_dependencies"], function(require, etc) {
    var template = require('text!templates/users/login_form.html');
}); 
```

# c# - ASP.NET 和 C# 中的自定义服务器控件 -

> ID：11528834
> 
> 赞同：0
> 
> 时间：2012-07-17T18:42:50.137
> 
> 标签：c#, asp.net, user-controls, custom-server-controls, htmltextwriter

我有一个带有一些组件的 aspx 和 aspx.cs 文件。现在我想在另一个页面中重用该页面的部分内容。我的方法是将重复的部分提取到 WebServerControl 中。

因此，在我浪费更多时间雅虎搜索之前，即使是正确的想法，如果是这样，有没有办法使用 aspx 文件的一部分，而不是`RenderContents`用`HtmlTextWriter`,`WriteBeginTag`等单调乏味地`WriteAttribute`进行操作。对于复杂的布局和大量的控件来说，这看起来像是一团糟。

标准是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T19:04:33.427

依靠。

主要驱动因素是，如果您需要在多个 Web 应用程序中重用您的控件，您应该使用`Custom Control`（C# 中的 .cs）。

否则，如果您只打算在一个 Web 应用程序中重用您的控件，请选择`User Control`(.ascx)。

[这篇](http://msdn.microsoft.com/en-us/library/aa651710%28v=vs.71%29.aspx)MSDN 文章是一个很好的起点。

更新（因为OP询问了更多细节）：

要为自定义控件嵌入 JavaScript，一种常见的方法是

```
var initializeScript = string.Format("MyNamespace.initialize('{0}', {1});", ClientID, myScriptString);
Attributes.Add("onmouseover", initializeScript); 
```

建议在 js 文件中而不是在 .cs 中编写 JavaScript 代码，因为后者是维护和调试的噩梦。希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T18:53:48.527

听起来您想要做的是将项目捆绑到[User Control](http://msdn.microsoft.com/en-us/library/y6wb1a0e.aspx)中。这将允许您通过使用现有的 .NET 控件来设计控件，而不是从头开始渲染所有内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T18:55:10.250

您只需要创建一个[ASP.NET Web 用户控件](http://msdn.microsoft.com/en-us/library/fb3w5b53.aspx)

**取自 MSDN：**

> ASP.NET Web 用户控件类似于完整的 ASP.NET 网页（.aspx 文件），同时具有用户界面页面和代码。创建用户控件的方式与创建 ASP.NET 页面的方式非常相似，然后添加所需的标记和子控件。用户控件可以包含代码来像页面一样操作其内容，包括执行数据绑定等任务。

# php - 如何开始使用 SOAP？

> ID：11528835
> 
> 赞同：1
> 
> 时间：2012-07-17T18:42:49.510
> 
> 标签：php, soap

我正在尝试开始使用 SOAP，我正在关注本教程： http: [//www.codewalkers.com/c/a/Miscellaneous/Using-SOAP-with-PHP/3/](http://www.codewalkers.com/c/a/Miscellaneous/Using-SOAP-with-PHP/3/)

据我所知，我已经安装了我需要的所有东西。

```
soap
Soap Client    enabled
Soap Server    enabled

Directive   Local Value   Master Value
soap.wsdl_cache   1   1
soap.wsdl_cache_dir   /tmp   /tmp
soap.wsdl_cache_enabled   1   1
soap.wsdl_cache_limit   5   5
soap.wsdl_cache_ttl   86400   86400 
```

当我尝试运行以下代码时，出现以下错误

```
<?php

function getStockQuote($symbol) {

    mysql_connect("localhost", "username", "password");
    mysql_select_db('captainc_general');
    $query = "SELECT stock_price FROM stockprices "
       . "WHERE stock_symbol = '$symbol'";
    $result = mysql_query($query);

    $row = mysql_fetch_assoc($result);
    return $row['stock_price'];
}

require_once('nusoap.php'); //use the nusoap library 

$server = new soap_server();

$server->configureWSDL('stockserver', 'urn:stockquote');

$server->register("getStockQuote",
                array('symbol' => 'xsd:string'),
                array('return' => 'xsd:decimal'),
                'urn:stockquote',
                'urn:stockquote#getStockQuote');

$HTTP_RAW_POST_DATA = isset($HTTP_RAW_POST_DATA)
                  ? $HTTP_RAW_POST_DATA : '';
$server->service($HTTP_RAW_POST_DATA);

?> 
```

> 警告：require_once(nusoap.php) [function.require-once]：无法打开流：第 17 行的 /home/captainc/public_html/soap/soaptest.php 中没有这样的文件或目录
> 
> 致命错误：require_once() [function.require]：无法在 /home/captainc/public_html 中打开所需的 'nusoap.php' (include_path='.:/usr/lib/php:/usr/local/lib/php') /soap/soaptest.php 第 17 行

任何人都知道我需要做些什么来对此进行排序？

# oracle - SQL Server 链接服务器错误消息

> ID：11528844
> 
> 赞同：1
> 
> 时间：2012-07-17T18:43:15.253
> 
> 标签：oracle, sql-server-2005, linked-server

我有一个 SQL Server 2005 数据库服务器，它设置了一个连接到 Oracle 数据库的链接服务器。

当我尝试运行删除或更新查询时，我收到以下错误消息：

> 无法使用来自链接服务器的 OLE DB 提供程序“OraOLEDB.Oracle”的书签获取行

几个小时前，当我测试它时，相同的代码还在工作，但突然它停止工作了。有没有人以前见过这个并且知道如何修复它/进一步排除故障？

在 SQL Developer 中直接在数据库中执行的相同查询工作正常。（我知道这是链接服务器的问题，但我不确定是什么）

任何指针将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T18:53:55.950

按以下方式使用 EXEC('query')：

假设，您之前的查询如下所示：

```
UPDATE [MyOraLinkedServer]..[XYZ].[TABLE]SET [DAT_COL] = cast (getdate() as smalldatetime) 
```

使用以下查询更改上述查询：

```
declare @NewValue smalldatetimeset 
@NewValue = cast(getdate() as smalldatetime)
exec( 'update XYZ.TABLE set DAT_COL = ?', @NewValue ) at MyOraLinkedServer 
```

注意：要实现这一点，您必须在链接服务器上启用 RPC

这样，它可能会解决你的问题......

# jquery - 如何使用 CSS 设置警报框的样式？

> ID：11528845
> 
> 赞同：7
> 
> 时间：2012-07-17T18:43:20.327
> 
> 标签：jquery, css

-- 更新 -- 我已经阅读了很多关于这个主题的文章，尝试了一些脚本，需要帮助来找出你能做什么或不能做什么。社区回答了这一切，以下是一个很好的起点。（这里的答案来自下面的社区，谢谢）

1.  您不能忽略默认的警报样式。它由您的客​​户制作（例如 chrome firefox 等）

2.  你可以改用jquery。而不是使用如下脚本：

    函数 check_domain_input() { var domain_val = document.getElementsByName('domain'); if (domain_val[0].value.length > 0) { return true; } alert('请输入要搜索的域名。'); 返回假；}

这使得客户端（firefox chrome 等）产生一个警报框。

2b。您告诉代码是否需要在事件加载 jquery alertbox 上发生某些事情，您可以制作漂亮的：（由 Jonathan Payne 回答并由 Jonathan Payne 创建。谢谢）

```
<link rel="stylesheet" href="http://code.jquery.com/ui/1.8.21/themes/base/jquery-ui.css" type="text/css" media="all" />

<div onclick="check_domain_input()">Click</div>

<div id="dialog" title="Attention!" style="display:none">
    Please enter a domain name to search for.
</div>

<script>
    function check_domain_input()
    {        
        $( "#dialog" ).dialog(); // Shows the new alert box.

        var domain_val = document.getElementsByName('domain');

        if (domain_val[0].value.length > 0)
        {
            return true;
        }

        $( "#dialog" ).dialog();

        return false;
    }
</script> 
```

在这里查看 jsFiddle：http: [//jsfiddle.net/8cypx/12/](http://jsfiddle.net/8cypx/12/)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-17T18:47:24.343

尝试`jQuery UI`位于此处：http: [//jqueryui.com/demos/dialog/](http://jqueryui.com/demos/dialog/)

他们有一个主题滚轮，您可以在其中设置对话框和模式框的样式。

- 编辑 -

回答你的第二个问题。

在这里查看 jsFiddle：http: [//jsfiddle.net/8cypx/12/](http://jsfiddle.net/8cypx/12/)

```
<link rel="stylesheet" href="http://code.jquery.com/ui/1.8.21/themes/base/jquery-ui.css" type="text/css" media="all" />

<div onclick="check_domain_input()">Click</div>

<div id="dialog" title="Attention!" style="display:none">
    Please enter a domain name to search for.
</div>

<script>
    function check_domain_input()
    {        
        $( "#dialog" ).dialog(); // Shows the new alert box.

        var domain_val = document.getElementsByName('domain');

        if (domain_val[0].value.length > 0)
        {
            return true;
        }

        $( "#dialog" ).dialog();

        return false;
    }
</script> 
```

​</p>

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-17T18:46:27.770

我建议使用 jQuery 对话框控件，而不是内置的 Javascript 对话框弹出窗口——它们很难看且无法用 CSS 自定义。这些可以很容易地设置样式，并且 jQuery 也为它提供了许多内置主题。

[http://docs.jquery.com/UI/Dialog](http://docs.jquery.com/UI/Dialog)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-17T18:47:37.943

如果我的问题正确，我认为您不能这样做，因为弹出窗口已连接到客户端的系统中。但是，设计您所描述的内容并不难，查看 DIV 元素或其他内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-17T18:48:19.880

确认/警告框是浏览器的一部分，而不是您的页面。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-11-03T11:47:53.473

使用下面的插件 [http://plugins.jquery.com/msgbox/](http://plugins.jquery.com/msgbox/)
并使用代码

> $.alert('文本');

而不是警报（'文本'）；使用 css 自定义

# svn - 导入现在格式良好但以前格式不正确的 Subversion 存储库

> ID：11528846
> 
> 赞同：2
> 
> 时间：2012-07-17T18:43:21.857
> 
> 标签：svn, version-control, mercurial, hgsubversion, repository-design

我想将源代码从[Subversion 存储库导入 Mercurial](http://sourceforge.net/scm/?type=svn&group_id=161807)。使用[Hg Subversion](http://mercurial.selenic.com/wiki/HgSubversion)我导入了它。问题是，SVN 存储库的布局是默认布局 - 带有`trunk`目录、目录中的分支`branches`等 - 今天，但以前不是这样。前段时间，项目的所有目录都是根存储库，因此 Hg Subversion 无法将`branches`目录转换为 Mercurial 分支，新的 Mercurial 存储库仅包含目录`branches`和`trunk`.

我以“艰难的方式”将分支目录转换为 Mercurial 分支：

*   对于每个分支`b`
*   `hg mv branches/$b .`
*   `hg rm branches trunk`
*   `hg branch $b`
*   `hg commint -m "Creating branch $b"`

但是，我想知道：有没有更好的方法呢？你将如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T13:36:33.883

hgsubversion 应该自动检测到trunk/tags/branches 目录的存在并完成智能的事情。您是否强制 hgsubversion 进入非自动模式以使其不这样做？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-05T19:36:45.393

```
$ hg help convert

The filemap is a file that allows filtering and remapping of files and
directories. Each line can contain one of the following directives:

  include path/to/file-or-dir

  exclude path/to/file-or-dir

  rename path/to/source path/to/destination  <== YOUR CASE

--filemap FILE     remap file names using contents of file 
```

# serialization - Symfony 2 User 类中哪些属性必须被序列化/反序列化？

> ID：11528849
> 
> 赞同：6
> 
> 时间：2012-07-17T18:43:36.097
> 
> 标签：serialization, symfony, doctrine-orm

Symfony 2中应该包含哪些属性（以及为什么）`serialize()`和方法？`deserialize()`

现在我有这个`id`领域并且它只是工作，但**我想知道为什么以及**`serialize()`在`User`课堂上的目的是什么。为了避免此消息：

> 您不能从不包含标识符的 EntityUserProvider 刷新用户。用户对象必须使用由 Doctrine 映射的自己的标识符进行序列化。

```
Class User implements AdvancedUserInterface, \Serializable
{
    /**
     * @return string
     */
    public function serialize()
    {
      return serialize($this->id);
    }

    /**
     * @param string $data
     */
    public function unserialize($data)
    {
      $this->id = unserialize($data);
    }
} 
```

虽然没有实现`\Serializable`并具有所有属性`protected`，但我得到：

> Symfony\Component\Security\Core\Authentication\Token\UsernamePasswordToken::serialize() 必须返回一个字符串或 NULL。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-18T06:35:18.867

您需要序列化/反序列化用户名和您在[相等性检查](https://stackoverflow.com/questions/8455337/symfony-2-userinterfaceequalsuser-comparing-for-re-authentication/8456607#8456607)中使用的字段。`id`除非可以在您的应用程序中更改，否则您不需要序列化该属性。

# java - 堆栈面板内的 GWT 图表

> ID：11528854
> 
> 赞同：0
> 
> 时间：2012-07-17T18:43:48.253
> 
> 标签：java, gwt

我有一个使用堆栈面板的类，然后在我的另一个类中调用它，然后在我的入口点类中调用。我的问题是如何让 GChart 在我的 Stackpanel 中显示（三个面板中只有一个）。

```
 package net.gui.client.content;

import net.gui.client.chart.ChartTuple;

import com.google.gwt.dom.client.Style.Unit;
import com.google.gwt.user.client.ui.HTML;
import com.google.gwt.user.client.ui.ScrollPanel;
import com.google.gwt.user.client.ui.StackLayoutPanel;
import com.google.gwt.user.client.ui.Widget;

/*
 author Kenny Watts
 since July 10, 2012
 This class creates the stacked panels that 
 display the data in the main screen of the gui
 */

public class StackPanel extends StackLayoutPanel {
    static int index = 0;
    public static final String PANEL0NAME = "Critical Data:";
    public static final String PANEL1NAME = "Supporting Data:";
    public static final String PANEL2NAME = "Other Data:";
    ChartTuple chartTest = new ChartTuple();

    public StackPanel(int numTabs) {
        super(Unit.PX);
        // for (int i = 0; i < numTabs; i++) {
        add(stackContent(0), PANEL0NAME, 25);
        add(stackContent(1), PANEL1NAME, 25);
        add(stackContent(2), PANEL2NAME, 25);

        // }
        showWidget(numTabs - 1);
        addStyleName("body");
        setAnimationDuration(500);
    }

    private Widget stackContent(int index) {

//      String content = "This is data set numebr: " + index + ""
//              + PanelUtils.randomText() + PanelUtils.randomText();
        ScrollPanel p = new ScrollPanel(chartTest);
        return (p);
    }
} 
```

那是我的堆栈面板，这是我的图表类。

```
 package net.gui.client.chart;

import com.googlecode.gchart.client.GChart;

/**
 * Defines a bar-chart of x*x vs. x, with gridlines.
 */

public class ChartTuple extends GChart {

    public ChartTuple() {
        setChartTitle("<b>x<sup>2</sup> vs x</b>");
        setChartSize(150, 150);
        addCurve();
        for (int i = 0; i < 10; i++)
            getCurve().addPoint(i, i * i);
        getCurve().setLegendLabel("x<sup>2</sup>");
        getCurve().getSymbol().setSymbolType(SymbolType.VBAR_SOUTH);
        getCurve().getSymbol().setBackgroundColor("red");
        getCurve().getSymbol().setBorderColor("black");
        getCurve().getSymbol().setModelWidth(1.0);
        getXAxis().setAxisLabel("<b>x</b>");
        getXAxis().setHasGridlines(true);
        getYAxis().setAxisLabel("<b>x<sup>2</sup></b>");
        getYAxis().setHasGridlines(true);
    }
} 
```

最后是我的入口点类：

```
package net.gui.client;

import com.google.gwt.core.client.EntryPoint;
import com.google.gwt.user.client.ui.RootLayoutPanel;

/**
 * Main entry point class for the ISCI gui. this just add's the BasePanel to the
 * rootlayoutpanel so it can be put into the HTML file.
 */
public class ISCI implements EntryPoint {

    @Override
    public void onModuleLoad() {
        BasePanel basePanel = new BasePanel();
        RootLayoutPanel.get().add(basePanel);
    }
} 
```

当我运行它时，我收到以下错误：“ [ERROR] [ISCI] - 第 16 行：没有源代码可用于类型 com.googlecode.gchart.client.GChart.SymbolType；您是否忘记继承所需的模块？”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T18:59:07.950

你是通过 GChart gwt 模块继承的吗？

```
<inherits name='com.googlecode.gchart.GChart' /> 
```

# c# - 在应用程序外部存储静态内容（字符串） - WP7

> ID：11528858
> 
> 赞同：0
> 
> 时间：2012-07-17T18:43:59.187
> 
> 标签：c#, xml, silverlight, windows-phone-7

我正在尝试以一种无需重新编译即可对其进行编辑的方式存储我的静态字符串。这些字符串是一组用于通过 Web 请求查询服务器的 URL，最好将它们放在一个名为 config 或 settings 的 xml 文件中以便于访问。我知道在 Android 上这很容易用一个看起来像这样的 xml 文件来完成：

```
 <?xml version="1.0" encoding="utf-8"?>
   <resources>

       <string name="hello">Hello World!</string>
       ...
       ...

   </resources> 
```

如果它存储在 res/values/strings.xml 中，那么我可以像 R.string.hello 一样从我的活动中引用它。

有没有办法在 windows phone 上做到这一点？还是使用标准的 Windows 方式保存配置信息，以便无需重新编译即可对其进行编辑？

提前感谢您的有用评论。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T18:51:41.567

为此目的使用[资源。](http://msdn.microsoft.com/en-us/library/ff637520%28v=VS.92%29.aspx)

# android - Android 动态创建和放置 MapView

> ID：11528873
> 
> 赞同：0
> 
> 时间：2012-07-17T18:45:15.597
> 
> 标签：android, layout, dynamic, android-mapview

我目前正在开发适用于 Android 的应用程序，但似乎无法弄清楚这一点。我的屏幕，目前只有一个大屏幕，`SurfaceView`被分成 4 个象限（不是真的，它仍然是`SurfaceView`一对一的线程）。

我正在尝试动态分配 a`MapView`并将其显示在屏幕的右上象限，同时仍然让它重绘自身以更新当前位置。有没有关于如何做到这一点的建议？有没有办法把它放在上面的图层上，使图层透明，然后将其偏移`MapView`到右上角？或者也许在右上角的象限上制作一个图层并让它显示`MapView`？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T20:32:12.293

得到它的工作。创建了一个覆盖屏幕的RelativeLayout，然后在其中创建了另一个RelativeLayout，并将其与右上角对齐并修改了高度和宽度。将SurfaceView动态分配到填满屏幕的RelativeLayout上，然后将MapView动态分配到右上角的RelativeLayout上。

# sql - 如果变量为空，则无 Where 子句

> ID：11528875
> 
> 赞同：1
> 
> 时间：2012-07-17T18:45:34.520
> 
> 标签：sql, sql-server-2008, tsql, sql-server-2008-r2

我正在尝试执行以下伪代码推断的内容：

```
WHERE 
CASE 
WHEN @test <> '' THEN Agent = @test
ELSE --no where clause 
END 
```

什么是正确的结构？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T18:47:25.033

使用或：

```
select * from yourTable
where @test = '' OR Agent = @test 
```

如果 @`test`带有空值（而不是`''`），则必须使用：

```
select * from yourTable
where @test is null OR Agent = @test 
```

# git - 发布托管在单个 Git 存储库中的多模块 Maven 项目

> ID：11528877
> 
> 赞同：9
> 
> 时间：2012-07-17T18:45:43.550
> 
> 标签：git, maven, maven-release-plugin, multi-module

我正在尝试发布包含在单个 git 存储库中的多模块项目的各个模块。

文件夹结构如下所示：

```
 |- api/pom.xml
  |- database/pom.xml
  |- core/pom.xml
  pom.xml 
```

`<modules>`父 pom 只是用作构建所有子组件的一种方式，这种方式通过使用标签是有意义的。本质上，构建 api，然后是数据库，然后是核心。

该项目最初托管在 SVN 中，通过简单地在 maven 标签中指向存储库中的不同路径，`scm`很容易让`maven release`命令发挥得很好。Git似乎不是这种情况。

运行时`mvn release:prepare`，它会根据需要对 api pom 进行更改，但在执行`mvn release:perform`时会尝试构建父 pom，并且由于无法解析 database/pom.xml 中列出的 api-snapshot 依赖项而无法构建数据库包.

我应该如何配置我的 scm 标签才能在 Git 存储库中发布特定模块？这甚至可能吗？

### 编辑：添加 pom 示例

这是 pom 文件外观的示例设置：

**父 pom.xml**

```
<project xmlns="http://maven.apache.org/POM/4.0.0" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 
    http://maven.apache.org/xsd/maven-4.0.0.xsd">

  <modelVersion>4.0.0</modelVersion>
  <groupId>com.findwise.hydra</groupId>
  <artifactId>hydra-parent</artifactId>
  <version>0.2.0</version>
  <packaging>pom</packaging>

  <modules>
    <module>api</module>
    <module>database</module>
    <module>core</module>
  </modules>
</project> 
```

**api/pom.xml**

```
<project xmlns="http://maven.apache.org/POM/4.0.0" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
    http://maven.apache.org/xsd/maven-4.0.0.xsd">

  <modelVersion>4.0.0</modelVersion>
  <groupId>com.findwise.hydra</groupId>
  <artifactId>hydra-api</artifactId>
  <packaging>jar</packaging>
  <version>0.2.0</version>
  <name>${project.artifactId}</name>
  <description>Hydra API</description>

  <licenses>
    ...
  </licenses>

  <scm>
    ...
  </scm>

  <properties>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
  </properties>

  <dependencies>
    ...
  </dependencies>

  <build>
    <finalName>${project.name}</finalName>
    <plugins>
      ...
    </plugins>
  </build>
</project> 
```

`database`pom 看起来很像，`api`但依赖于`api`. 也是如此`core`，这取决于`database`（并通过它，取决于`api`）。

和工件本身很重要，因为`api`定义了客户端 API 和后端 API，它们都用于与应用程序集成。由此产生了单独发布它们的最初想法——父 pom 只是事后的想法，以允许更简单地构建整个堆栈。`database``api``database`

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-18T07:35:09.890

发布多模块构建的常用方法是从根位置执行，这也意味着同时发布它的所有子模块。不单独发布单个模块。如果您尝试这样做，您将失去版本之间的关系。

如果您真的想单独发布模块，只需从中创建单独的 maven 项目，并为它们各自提供一个 git 存储库。

你提到的树看起来真的很像一个多模块构建，应该从根目录一步发布。

根据您更新的内容，我可以建议您使用真正的多模块构建，其结构如下：

```
root
 +-- pom.xml (1.0-SNAPSHOT)
 !
 +-- api 
 !     +-- pom.xml (1.0-SNAPSHOT)
 +-- database
 !     +-- pom.xml (1.0-SNAPSHOT)
 +-- core
       +-- pom.xml (1.0-SNAPSHOT) 
```

最好的方法是在 Maven 中使用继承，这意味着在每个模块 api、核心、数据库中使用这样的父级：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 
    http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>

  <parent>
    <groupId>com.findwise.hydra</groupId>
    <artifactId>hydra-parent</artifactId>
    <version>0.2.0-SNAPSHOT</version>
  </parent>

  <artifactId>hydra-api</artifactId>

  <description>Hydra API</description> 
```

这使您可以选择将 api、核心和数据库中常见的所有内容放入父级。例如，您应该只将许可证信息放入父级，属性如下：

```
 <properties>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
  </properties> 
```

此外，您可以将[有关您正在使用的插件](http://maven.apache.org/pom.html#Plugin_Management)的信息放入父级中，例如：

```
 <build>
    <pluginManagement>
      <plugins>
        <plugin>
          <groupId>org.apache.maven.plugins</groupId>
          <artifactId>maven-compiler-plugin</artifactId>
          <version>2.3.2</version>
          <configuration>
            <source>1.6</source>
            <target>1.6</target>
          </configuration>
        </plugin>
        ... 
```

当然，您只需在父级中定义一次 scm 区域以及许多其他内容。

此外，可以并建议将[dependencyManagement](http://maven.apache.org/pom.html#Dependency_Management)定义到父级中，这样您就有机会仅在某一点使用适当的版本定义依赖项，而无需在模块中定义版本。

这将导致模块中 pom 的大小显着减小。

结果将是通过单个`mvn release:prepare`等从父级发布，但会产生不同的工件，例如`hydra-api`，`hydra-core`并`hydra-database`具有相同的版本号，这将确保*api*、*core*等彼此一致。

# mysql - mysql搜索字符串的一部分

> ID：11528881
> 
> 赞同：0
> 
> 时间：2012-07-17T18:45:58.300
> 
> 标签：mysql, sql, substring

我的数据库中的表中有一个字段，其中包含以下 HTML 代码：

```
<table class="table_productinfo" border="0" cellpadding="0" cellspacing="0">
<tbody>
<tr><td class="attribute_head"><strong>Ausführung:</strong></td><td><strong>500mm</strong></td></tr>
<tr><td class="attribute_head">Farbe:</td><td>weiß glänzend</td></tr><tr><td class="attribute_head">Material:</td><td>Keramik</td></tr>
<tr><td class="attribute_head">Hersteller:</td><td>antoniolupi</td></tr>
<tr><td class="attribute_head">Serie:</td><td>ALBUM</td></tr>
<tr><td class="attribute_head">Design:</td><td>Prospero Rasulo</td></tr>
<tr><td class="attribute_head">Bemerkung:</td><td>Auch zur Wandmontage geeignet</td></tr>
<tr><td class="attribute_head">Höhe in mm:</td><td>150</td></tr>
<tr><td class="attribute_head">Tiefe in mm:</td><td>500</td></tr><tr><td class="attribute_head">Breite in mm:</td><td>500</td></tr>
<tr><td class="attribute_head">Artikelnummer:</td><td>NLALB</td></tr>
</tbody>
</table> 
```

现在我想通过 php 提交一个搜索字符串：

```
antoniolupi album prospero 
```

我该怎么做才能找到包含此内容的特定行？

我尝试了拆分关键字`explode(' ',$keyword)`并查找部分出现的方法，但我无法获得我需要的 sql 查询。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:08:00.840

在 where 子句中，在您正在搜索的列上使用类似的搜索词。column_name like '%search_term" 之后，您可以加入所有搜索词，具体取决于您是只需要一个匹配还是全部匹配。

# vba - 寻找用于 VBA 的功能最小化器

> ID：11528882
> 
> 赞同：2
> 
> 时间：2012-07-17T18:45:58.563
> 
> 标签：vba, excel

您好，我是 VBA 代码的新手，正在努力在 Excel 中的 UDF 内进行一些非线性曲线拟合。我熟悉 Matlab，我的大部分经验都来自于此。我正在寻找一个子/函数，它将为我提供类似于 Matlab 中的 fminsearch() 的功能。任何帮助，将不胜感激。谢谢

编辑（2）以回应布拉德

假设我想编写自己的 UDF，它使用最小化来迭代地找到数字的立方根。我可以编写以下函数吗？

```
Function myCubRootSResd(root As Double, rootCubed As Double) As Double 
Dim a As Double 
a = (root * root * root - rootCubed)
myCubRootSResd = a * a
End Function 
```

然后，这可以与 Solver 结合使用，通过更改输入“root”将此函数的输出设置为零来查找任何数字的立方根。然而，这只是我需要在我尝试编写的 UDF 中执行的一个步骤，并且我需要在我的 UDF 内部使用这个输出（在本例中为立方根），它最终计算最终输出。然后我想使用相对引用来使用我的整体 UDF 来计算一系列输入。我相信这需要在 VBA 内部进行最小化，而不是参考单元格。在这种情况下，封装函数将处理“root”的值并返回它。它只有一个输入，即“rootCubed”，并将其传递给 myCubeRootSResd。所以它看起来像这样：

```
Function myCubeRootFinder(rootCubed as Double) as Double

……. 

End Function 
```

任何帮助将不胜感激我一直试图找到一个简单的解决方案一段时间了，我只是没有找到任何人在 VBA 中进行这种类型的数值最小化的例子。

我意识到这可能不是在 VBA 中解决此问题的方法，但需要保留功能。谢谢你和我一起的病人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T06:15:43.370

好吧，我玩得很开心。

创建一个名为 FuncEval 的类：

```
Option Explicit

Dim output_ As Double
Dim input_() As Double

Public Property Get VectArr() As Double()
    VectArr = input_
End Property

Public Function Vect(i As Integer)
    Vect = input_(i)
End Function

Public Sub SetVect(ByRef newVect() As Double)
    Dim i As Integer
    ReDim input_(LBound(newVect) To UBound(newVect)) As Double
    For i = LBound(newVect) To UBound(newVect)
        input_(i) = newVect(i)
    Next i
End Sub

Public Property Get Result() As Double
    Result = output_
End Property

Public Property Let Result(newRes As Double)
    output_ = newRes
End Property 
```

还有一个名为 Func 的类：

```
Option Explicit

Private cube_ As Double

Public Property Let Cube(newCube As Double)
    cube_ = newCube
End Property

Public Function Eval(ByRef val() As Double) As FuncEval
    Dim ret As New FuncEval
    ret.Result = Abs(cube_ - val(0) * val(0) * val(0))
    ret.SetVect val
    Set Eval = ret
End Function 
```

现在将此代码放入标准模块中：

```
Option Explicit

Function NelderMead(f As Func, _
                    ByRef guess() As Double) As Double()

    'Algorithm follows that outlined here:
    'http://www.mathworks.com/help/techdoc/math/bsotu2d.html#bsgpq6p-11

    'Used as the perturbation for the initial guess when guess(i) == 0
    Dim zeroPert As Double
    zeroPert = 0.00025
    'The factor each element of guess(i) is multiplied by to obtain the
    'initial simplex
    Dim pertFact As Double
    pertFact = 1.05
    'Tolerance
    Dim eps As Double
    eps = 0.000000000001

    Dim shrink As Boolean
    Dim i As Integer, j As Integer, n As Integer
    Dim simplex() As Variant
    Dim origVal As Double, lowest As Double
    Dim m() As Double, r() As Double, s() As Double, c() As Double, cc() As Double, diff() As Double
    Dim FE As FuncEval, FR As FuncEval, FS As FuncEval, FC As FuncEval, FCC As FuncEval, newFE As FuncEval

    n = UBound(guess) - LBound(guess) + 1
    ReDim m(LBound(guess) To UBound(guess)) As Double
    ReDim r(LBound(guess) To UBound(guess)) As Double
    ReDim s(LBound(guess) To UBound(guess)) As Double
    ReDim c(LBound(guess) To UBound(guess)) As Double
    ReDim cc(LBound(guess) To UBound(guess)) As Double
    ReDim diff(LBound(guess) To UBound(guess)) As Double
    ReDim simplex(LBound(guess) To UBound(guess) + 1) As Variant

    Set simplex(LBound(simplex)) = f.Eval(guess)

    'Generate the simplex
    For i = LBound(guess) To UBound(guess)
        origVal = guess(i)
        If origVal = 0 Then
            guess(i) = zeroPert
        Else
            guess(i) = pertFact * origVal
        End If
        Set simplex(LBound(simplex) + i - LBound(guess) + 1) = f.Eval(guess)
        guess(i) = origVal
    Next i

    'Sort the simplex by f(x)
    For i = LBound(simplex) To UBound(simplex) - 1
        For j = i + 1 To UBound(simplex)
            If simplex(i).Result > simplex(j).Result Then
                Set FE = simplex(i)
                Set simplex(i) = simplex(j)
                Set simplex(j) = FE
            End If
        Next j
    Next i

    Do

        Set newFE = Nothing
        shrink = False
        lowest = simplex(LBound(simplex)).Result

        'Calculate m
        For i = LBound(m) To UBound(m)
            m(i) = 0
            For j = LBound(simplex) To UBound(simplex) - 1
                m(i) = m(i) + simplex(j).Vect(i)
            Next j
            m(i) = m(i) / n
        Next i

        'Calculate the reflected point
        For i = LBound(r) To UBound(r)
            r(i) = 2 * m(i) - simplex(UBound(simplex)).Vect(i)
        Next i
        Set FR = f.Eval(r)

        'Check acceptance conditions
        If (simplex(LBound(simplex)).Result <= FR.Result) And (FR.Result < simplex(UBound(simplex) - 1).Result) Then
            'Accept r, replace the worst value and iterate
            Set newFE = FR
        ElseIf FR.Result < simplex(LBound(simplex)).Result Then
            'Calculate the expansion point, s
            For i = LBound(s) To UBound(s)
                s(i) = m(i) + 2 * (m(i) - simplex(UBound(simplex)).Vect(i))
            Next i
            Set FS = f.Eval(s)
            If FS.Result < FR.Result Then
                Set newFE = FS
            Else
                Set newFE = FR
            End If
        ElseIf FR.Result >= simplex(UBound(simplex) - 1).Result Then
            'Perform a contraction between m and the better of x(n+1) and r
            If FR.Result < simplex(UBound(simplex)).Result Then
                'Contract outside
                For i = LBound(c) To UBound(c)
                    c(i) = m(i) + (r(i) - m(i)) / 2
                Next i
                Set FC = f.Eval(c)
                If FC.Result < FR.Result Then
                    Set newFE = FC
                Else
                    shrink = True
                End If
            Else
                'Contract inside
                For i = LBound(cc) To UBound(cc)
                    cc(i) = m(i) + (simplex(UBound(simplex)).Vect(i) - m(i)) / 2
                Next i
                Set FCC = f.Eval(cc)
                If FCC.Result < simplex(UBound(simplex)).Result Then
                    Set newFE = FCC
                Else
                    shrink = True
                End If
            End If
        End If

        'Shrink if required
        If shrink Then
            For i = LBound(simplex) + 1 To UBound(simplex)
                For j = LBound(simplex(i).VectArr) To UBound(simplex(i).VectArr)
                    diff(j) = simplex(LBound(simplex)).Vect(j) + (simplex(i).Vect(j) - simplex(LBound(simplex)).Vect(j)) / 2
                Next j
                Set simplex(i) = f.Eval(diff)
            Next i
        End If

        'Insert the new element in place
        If Not newFE Is Nothing Then
            For i = LBound(simplex) To UBound(simplex)
                If simplex(i).Result > newFE.Result Then
                    For j = UBound(simplex) To i + 1 Step -1
                        Set simplex(j) = simplex(j - 1)
                    Next j
                    Set simplex(i) = newFE
                    Exit For
                End If
            Next i
        End If

    Loop Until (simplex(UBound(simplex)).Result - simplex(LBound(simplex)).Result) < eps

    NelderMead = simplex(LBound(simplex)).VectArr

End Function

Function test(cube, guess) As Double

    Dim f As New Func
    Dim guessVec(0 To 0) As Double
    Dim Result() As Double
    Dim i As Integer
    Dim output As String

    f.cube = cube
    guessVec(0) = guess

    Result = NelderMead(f, guessVec)

    test = Result(0)

End Function 
```

Func 类包含您的残差函数。NelderMead 方法只需要 Func 类的 Result 方法，因此只要 Eval 方法处理与您的初始猜测长度相同的向量并返回 FuncEval 对象，您就可以对 Func 类做任何事情。

调用测试函数来查看它的运行情况。注意，我还没有实际测试过多维向量，我必须出去，如果您有任何问题，请告诉我！

**编辑：关于泛化函数传递的建议**

您需要针对不同的问题创建许多不同的类。这意味着要保持 NelderMead 函数的通用性，您需要将其声明行更改为以下内容：

```
Function NelderMead(f As Object, _
                    ByRef guess() As Double) As Double() 
```

无论 f 是什么，它都必须始终有一个 Eval 方法，该方法采用一个双精度数组。

**编辑：函数传递，可能是在 VBA 中完成的（愚蠢的）方式**

```
Function f(x() As Double) As Double
    f = x(0) * x(0)
End Function

Sub Test()
    Dim x(0 To 0) As Double
    x(0) = 5
    Debug.Print Application.Run("f", x)
End Sub 
```

使用此方法，您将拥有以下声明：

```
Function NelderMead(f As String, _
                    ByRef guess() As Double) As Double() 
```

然后使用上面的 Application.Run 语法调用 f 。您还需要在函数内部进行一些更改。它并不漂亮，但坦率地说，它一开始并不那么漂亮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:03:16.427

您可以使用 Excel 附带的 Solver 加载项来解决最小化问题。

# android - 无法让人脸检测从 sdcard android 工作

> ID：11528884
> 
> 赞同：0
> 
> 时间：2012-07-17T18:46:03.430
> 
> 标签：android, face-detection

我正在尝试在 android 中使用 FaceDetection。如果我使用以下行解码位图，则检测到面部 -

```
Bitmap myBitmap=BitmapFactory.decodeResource(getResources(), R.drawable.face5,bitmapFatoryOptions); 
```

但是，如果我将相同的图像存储在 sdcard 中并尝试使用下面的行，则不会检测到人脸。

```
Bitmap myBitmap=BitmapFactory.decodeFile(Environment.getExternalStorageDirectory() + "/axs" + "/face5.png"); 
```

我真的不知道为什么会这样。在这两种情况下，我都能在画布上看到图像。然而，第一个突出显示检测到的人脸，而不是第二个。我想当我以两种方式阅读结果位图时，结果位图会有所不同。

请建议我可以做些什么来让人脸检测从 sdcard 工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:30:48.763

我认为我在进行良好搜索之前发布的问题太快了。对此感到抱歉。

我找到了问题的解决方案。基本上是图像的大小造成了问题。按照这个链接。[Android 人脸检测仅适用于可绘制对象，不适用于 SD 卡中的图像](https://stackoverflow.com/questions/9656144/android-face-detection-only-works-with-drawables-not-with-images-from-sd-card)

# gcc - g++ 4.1.2 与 g++ 4.6 混合

> ID：11528885
> 
> 赞同：2
> 
> 时间：2012-07-17T18:46:12.313
> 
> 标签：gcc, g++, version

所以，事情就是这样。要在 Linux 上为 Maya 开发插件，我们必须使用 GCC 4.1.2 进行编译。但是这个编译器不支持任何新的 C++0x 特性。

有没有可能做这样的事情：

```
gcc-4.6 -o test.cpp.o -c test.cpp
gcc-4.1.2 -o exec_test test.cpp.o 
```

我非常怀疑这是否可能，但值得一问。

如果这是不可能的，有没有办法实现类似的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T16:06:27.463

这两个 GCC 版本的 ABI 是兼容的，问题是 GCC 4.6 编译的对象可能依赖于仅由较新的 GCC 的 C++ 标准库定义的符号（例如，如果您使用`std::fstream`构造函数获取`std::string`您的对象将具有依赖关系在那个符号上，它只存在于支持 C++11 的最新版本的 GCC 中。）

只要您从 GCC 4.6（即`libstdc++.so.6.0.16`）链接到 libstdc++，它就会起作用，即通过链接`-L /path/to/gcc-4.6/lib`

[您还必须确保在运行时找到更新版本的库，即通过使用libstdc++ 手册](http://gcc.gnu.org/onlinedocs/libstdc++/manual/using_dynamic_or_shared.html#manual.intro.using.linkage.dynamic)中列出的方法之一告诉动态加载器使用该库

例如：

```
$ cat x.cc
#include <vector>
#include <fstream>
#include <string>
int main()
{
    std::string s = "output";
    std::ofstream f(s);
    std::vector<int> v(3);
    int n;
    for (auto i : v)
        ++n;
    f << n << '\n';
}
$ g++-4.6 -std=c++0x x.cc -c
$ g++-4.1 x.o
x.o: In function `main':
x.cc:(.text+0x5c): undefined reference to `std::basic_ofstream<char, std::char_traits<char> >::basic_ofstream(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::_Ios_Openmode)'
collect2: ld returned 1 exit status
$ g++-4.1 x.o -L /path/to/4.6/lib64 -Wl,-rpath,/path/to/4.6/lib64
$ ./a.out
$ cat output
3 
```

# java - JavaFX 显示 WebView 控件的 HTML 源代码

> ID：11528888
> 
> 赞同：2
> 
> 时间：2012-07-17T18:46:17.020
> 
> 标签：java, browser, webview, webkit, javafx

我正在使用 WebView 控件在 JavaFX 中进行浏览。到目前为止一切都很完美，除了我不知道如何实现“查看页面源代码”功能，就像在所有主流浏览器中一样，以显示当前页面的 HTML 源代码。我有想法，但他们需要做一些事情。鉴于 WebView 像 Chrome 一样使用 WebKit 引擎，我希望有一种快速的方法。

提前致谢！

一个

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T20:18:17.143

使用本[教程](http://java.sun.com/developer/onlineTraining/protocolhandlers/)作为指南实现您自己的[URLStreamHandlerFactory并缓存传入的文档以供以后通过查看源函数显示。](http://docs.oracle.com/javase/7/docs/api/java/net/URL.html#setURLStreamHandlerFactory%28java.net.URLStreamHandlerFactory%29)

为了实现更直接的实现（例如 webView.getEngine().getSourceText() 或类似的东西），您需要提交[jira 功能请求](http://javafx-jira.kenai.com)。

顺便说一句，我为 WebView 实现了一个[浏览器](http://code.google.com/p/willow-browser/)，如果你愿意，你可以采用它（虽然它目前没有实现视图源）。

# android - 为什么 zoomToSpan 有时只会在 Android MapView 中缩放到我期望的位置？

> ID：11528889
> 
> 赞同：0
> 
> 时间：2012-07-17T18:46:23.893
> 
> 标签：android, google-maps, android-mapview

我有一个 MapActivity，旨在显示由实例变量 mCenterPoint、mLatSpan 和 mLongSpan 定义的特定区域。Map 对象具有获取中心点的方法，以及地图的纬度跨度和经度跨度。打开 MapActivity 时，我希望它立即以中心点为中心并缩放到正确的跨度。

这是我的 onCreate 方法和我的 setRegionOfMap 方法：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.google_map);

    mMapView = (MapView) findViewById(R.id.mapview);
    mMapView.setBuiltInZoomControls(true);

    setRegionOfMap();

}
private void setRegionOfMap(){
    mMapView.getController().setCenter(mCenterPoint);
    mMapView.getController().zoomToSpan(mLatSpan, mLongSpan);
} 
```

mMap 只是我的地图对象的一个​​实例。中心点和跨度始终是相同的值，因为数据不会动态变化。大约 1/4 - 1/2 的时间地图完全按照我的预期进行缩放。然而，地图的其余时间看起来都正确居中，只是缩小得太远了。为什么 MapView 只会在某些时候缩放而其他时候不正确？我唯一的理论是，当 zoomToSpan 调用发生时，地图可能没有完全绘制，因此缩放没有注册。不过，我还无法检验这个理论。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T18:12:44.510

我最终通过从 OnGlobalLayoutListener 调用 zoomToSpan 自己解决了这个问题。之前的问题是在onCreate()中，地图还没有绘制出来，所以缩放没有效果。从此侦听器调用 zoomToSpan 可确保设置地图并且缩放具有效果。这是我的“setRegionOfMap()”方法。

```
 private void setRegionOfMap(){
    final LinearLayout layout = (LinearLayout)findViewById(R.id.outdoor_maps_linearlayout);
    final ViewTreeObserver vto = layout.getViewTreeObserver(); 
    vto.addOnGlobalLayoutListener(new OnGlobalLayoutListener() { 
        @Override 
        public void onGlobalLayout() { 
            layout.getViewTreeObserver().removeGlobalOnLayoutListener(this); 
            MapView mapView = (MapView)layout.findViewById(R.id.mapview);
            mapView.getController().setCenter(mCenterPoint);
            mapView.getController().zoomToSpan(mLatSpan, mLongSpan);
        } 
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:02:38.347

我认为问题在于，`mMap.getLatSpan()`如果`mMap.getLongSpan()`您在开始时调用该方法，则返回 0 `onCreate`，如果您在 postdelay 可运行中进行计算，则它必须工作。

在这里你可以找到更好的答案：

[Mapview getLatitudeSpan 和 getLongitudeSpan 不起作用](https://stackoverflow.com/questions/2667386/mapview-getlatitudespan-and-getlongitudespan-not-working)

我用来在两个位置之间居中和缩放的代码：

```
if (searchedLocationFrom != null && searchedLocationTo != null) { // center

            int lat1 = (int) (searchedLocationFrom.getLatitude() * 1E6);
            int lon1 = (int) (searchedLocationFrom.getLongitude() * 1E6);
            int lat2 = (int) (searchedLocationTo.getLatitude() * 1E6);
            int lon2 = (int) (searchedLocationTo.getLongitude() * 1E6);

            // mapController.setZoom(13);
            mapController.zoomToSpan((lat1 > lat2 ? lat1 - lat2 : lat2
                    - lat1), (lon1 > lon2 ? lon1 - lon2 : lon2 - lon1));
            int z = mapView.getZoomLevel();
            mapController.setZoom(z > 1 ? z - 1 : z);
            mapController
                    .setCenter(new GeoPoint(lat1 - ((lat1 - lat2) / 2),
                            lon1 - ((lon1 - lon2) / 2)));
        } 
```

希望有所帮助:)

# regex - 德尔福：TRegExpr

> ID：11528895
> 
> 赞同：-1
> 
> 时间：2012-07-17T18:46:45.923
> 
> 标签：regex, delphi

问题：需要获取字符串中的所有 st 。这样做，但在备忘录中只添加最后一个结果，即 st2。如何获得 st 和 st2 等？

```
const
  pattern = '<h3 class=.*><a class=.*>([a-zA-Z0-9а-яА-Я]+)</a></h3>';
var
  r: TRegExpr;
  s: string;
begin
r:=TRegExpr.Create;
s:='<h3 class="yt-lockup-ellipsize"><a class="yt-uix-sessionlink yt-uix-tile-link result-item-translation-title"dir="ltr"title="Женщины"data-sessionlink="ei=CO_0s_S3oLECFQQZ3wodxl5sKw%3D%3D"href="/watch?v=E0MzksPjObU">st1</a></h3>';
s:=s + '<h3 class="yt-lockup-ellipsize"><a class="yt-uix-sessionlink yt-uix-tile-link result-item-translation-title"dir="ltr"title="Женщины"data-sessionlink="ei=CO_0s_S3oLECFQQZ3wodxl5sKw%3D%3D"href="/watch?v=E0MzksPjObU">st2</a></h3>';
r.Expression:=pattern;
if r.Exec(s) then
  REPEAT
    Memo2.Lines.Add(r.Match[1]);
  UNTIL not r.ExecNext; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T19:37:43.627

啊。使用正则表达式解析 HTML =*坏*主意。

无论如何，您的正则表达式是贪婪的，因此该`"<h3 class=.*><a class=.*>"`部分从您的第一个标签一直匹配到第二个标签。你只需要通过第一个被击中的“>”来吞噬东西，所以尝试类似`"<h3 class="[^>]*><a class="[^>]*>([a-zA-Z0-9а-яА-Я]+)</a></h3>"`. （您也可以使用惰性量词，例如“.+?”而不是“.*”，但这比使用 negated 选项要慢。）

请注意，这将无法正确处理嵌入在带引号的属性中的“>”——为此，您需要更加努力。

*   编辑：仅供参考，这是惰性量词版本：（`<h3\sclass=.+?><a\sclass=.+?>([a-zA-Z0-9а-яА-Я]+)</a></h3>`“\s”是空格字符——在大多数正则表达式中更可靠。解析器）。

确实，最好通过 XML 解析器运行它。

# java - 在Java中将字节转换为二进制

> ID：11528898
> 
> 赞同：4
> 
> 时间：2012-07-17T18:46:58.383
> 
> 标签：java, binary, byte, bit

我正在尝试将字节值转换为二进制以进行数据传输。基本上，我在字节数组中以二进制形式（“10101100”）发送一个像“AC”这样的值，其中“10101100”是一个字节。我希望能够接收这个字节并将其转换回“10101100”。到目前为止，我根本没有成功，真的不知道从哪里开始。任何帮助都会很棒。

**编辑**：对不起，我没有意识到我忘记添加具体细节的所有混乱。

基本上我需要使用字节数组通过套接字连接发送二进制值。我可以这样做，但我不知道如何转换这些值并使它们正确显示。这是一个例子：

我需要发送十六进制值 ACDE48 并能够将其解释回来。根据文档，我必须通过以下方式将其转换为二进制：byte [] b={10101100,11011110,01001000}，其中数组中的每个位置都可以保存 2 个值。然后，我需要在发送和接收这些值后将它们转换回来。我不知道该怎么做。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-17T19:16:08.670

```
String toBinary( byte[] bytes )
{
    StringBuilder sb = new StringBuilder(bytes.length * Byte.SIZE);
    for( int i = 0; i < Byte.SIZE * bytes.length; i++ )
        sb.append((bytes[i / Byte.SIZE] << i % Byte.SIZE & 0x80) == 0 ? '0' : '1');
    return sb.toString();
}

byte[] fromBinary( String s )
{
    int sLen = s.length();
    byte[] toReturn = new byte[(sLen + Byte.SIZE - 1) / Byte.SIZE];
    char c;
    for( int i = 0; i < sLen; i++ )
        if( (c = s.charAt(i)) == '1' )
            toReturn[i / Byte.SIZE] = (byte) (toReturn[i / Byte.SIZE] | (0x80 >>> (i % Byte.SIZE)));
        else if ( c != '0' )
            throw new IllegalArgumentException();
    return toReturn;
} 
```

还有一些更简单的方法来处理这个问题（假设大端）。

```
Integer.parseInt(hex, 16);
Integer.parseInt(binary, 2); 
```

和

```
Integer.toHexString(byte).subString((Integer.SIZE - Byte.SIZE) / 4);
Integer.toBinaryString(byte).substring(Integer.SIZE - Byte.SIZE); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T19:04:03.433

要将十六进制转换为二进制，您可以使用 BigInteger 来简化代码。

```
public static void sendHex(OutputStream out, String hexString) throws IOException {
    byte[] bytes = new BigInteger("0" + hexString, 16).toByteArray();
    out.write(bytes, 1, bytes.length-1);
}

public static String readHex(InputStream in, int byteCount) throws IOException {
    byte[] bytes = new byte[byteCount+1];
    bytes[0] = 1;
    new DataInputStream(in).readFully(bytes, 1, byteCount);
    return new BigInteger(0, bytes).toString().substring(1);
} 
```

* * *

字节以二进制形式发送，无需翻译。事实上，它是*唯一*不需要某种形式的编码的类型。因此，没有什么可做的。

用二进制写入一个字节

```
OutputStream out = ...
out.write(byteValue);

InputStream in = ...
int n = in.read();
if (n >= 0) {
   byte byteValue = (byte) n; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-11-18T08:53:48.300

@LINEMAN78s 解决方案的替代方案是：

```
public byte[] getByteByString(String byteString){
    return new BigInteger(byteString, 2).toByteArray();
}

public String getStringByByte(byte[] bytes){
    StringBuilder ret  = new StringBuilder();
    if(bytes != null){
        for (byte b : bytes) {
            ret.append(Integer.toBinaryString(b & 255 | 256).substring(1));
        }
    }
    return ret.toString();
} 
```

# jquery - 网页慢（Jquery + bootstrap）

> ID：11528901
> 
> 赞同：0
> 
> 时间：2012-07-17T18:47:14.897
> 
> 标签：jquery, twitter-bootstrap, responsive-design, performance

我有一个小问题......我做了一个页面，上面有 BOOTSRAP 和 Nivo 滑块（jquery）。我将 boostrap 用于基本样式和响应式设计（为移动设备、平板电脑调整大小......）。

但是，我的页面仅在 Chrome 下非常慢。我尝试启动 CSS3 动画、Nivo 滑块，但无事可做……总是很慢。奇怪的是，如果我在页面上缩放一次（或取消缩放），它会变得非常流畅，就像正常浏览一样。仅当我在加载后对其进行缩放/取消缩放... FF 或 IE 上没有任何内容。

任何想法 ？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-17T18:51:33.553

我鼓励你使用谷歌页面速度测试——他们有关于如何让页面更快的很好的提示：[https ://developers.google.com/speed/pagespeed/](https://developers.google.com/speed/pagespeed/)

一组类似的诊断工具是 YSlow（也是一个 Chrome 插件）。我也去看看 [https://chrome.google.com/webstore/detail/ninejjcohidippngpapiilnmkgllmakh](https://chrome.google.com/webstore/detail/ninejjcohidippngpapiilnmkgllmakh)

# ios - 防止 contentSizeForViewInPopover 动画

> ID：11528907
> 
> 赞同：0
> 
> 时间：2012-07-17T18:47:24.623
> 
> 标签：ios, ipad

我有一个弹出框，其中包含一个`UITableView`. 在情节提要中，我将弹出框高度设置为适合整个表格，并且显示效果很好。但是，在某些情况下，我需要显示更少的单元格，在这些情况下，我想更改弹出框的高度。我这样做：

```
- (void)viewDidAppear:(BOOL)animated {
    [super viewDidAppear:animated]; 
    if (trimFourCells) {  // reduce the popover's height by that of four cells
        CGSize size = self.contentSizeForViewInPopover;
        size.height -= 4*60;
        self.contentSizeForViewInPopover = size;
    }
} 
```

它工作得很好，除了变化是动画的：首先显示完整尺寸，然后在大约一秒钟内缩小。

我的问题是是否可以禁用此动画。

我试图通过`NO`，`[super viewDidAppear:animated]`甚至试图在改变尺寸后移动那条线。它并没有阻止动画。然后我尝试将代码移动到`viewWillAppear`，这甚至没有改变高度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T19:53:07.173

感谢@frowing，这是解决方案。不必在弹出框的代码中更改大小，而是必须在调用者中完成。我已将如下代码添加到`prepareForSegue`：

```
- (void) prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    UIPopoverController *pc = ((UIStoryboardPopoverSegue*)segue).popoverController;
    if (trim_nCells > 0) { // trim that many cells from the table
        CGSize size = pc.contentViewController.contentSizeForViewInPopover;
        size.height -= trim_nCells * cellHeight;
        [pc setPopoverContentSize:size animated:NO];
    }
    (... rest of the prep code ...)
} 
```

注意，由于是在显示之前完成的，所以没有涉及到动画，所以`animated:`param的值是没有作用的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T19:32:04.490

只需使用

```
- (void)setPopoverContentSize:(CGSize)size animated:(BOOL)animated 
```

像这样：

```
[popoverController setPopoverContentSize:size animated:NO]; 
```

# c++ - STL 映射是如何分配的？堆栈还是堆？

> ID：11528911
> 
> 赞同：12
> 
> 时间：2012-07-17T18:47:28.663
> 
> 标签：c++, memory-management, stl, map

我想知道`map`C++ 中的 STL 是否具有连续内存 - 或者内存是否分配给堆？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-17T18:49:54.007

由于`map`是一个**动态容器**，它的元素的内存是*动态分配*的（无论这意味着什么（它取决于可配置的分配器）！）。

此外，`map`它是一个**基于节点的**容器，因此每个元素都进入不同的、单独的分配（以允许最大迭代器和引用非无效）。元素在内存中几乎可以肯定是*不*连续的，并且可能以反映您添加它们的方式分散在各处。

实际上，映射将被实现为某种类型的平衡树，以实现对数查找、插入和删除时间。

（如果您想要一个具有连续存储和对数查找时间的数据结构，请考虑使用排序向量。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T19:01:56.490

它很可能是特定于实现的，[您当然可以更改任何 STL 容器的分配器](https://stackoverflow.com/a/4406645/195488)，但这不适合胆小的人，您需要查看您正在使用的标准库的文档。

无论如何，map 通常实现为[红黑树](https://stackoverflow.com/q/720507/195488)，树节点位于堆上。

（如果我理解正确，树节点包含[value_type 的实例](https://stackoverflow.com/questions/6972111/does-new-always-allocate-on-the-heap-in-c-c-sharp-java)，它们是地图的键/值对）。

请注意，堆栈对于任何容器来说都是一个糟糕的存储想法，因为堆栈应该被视为稀缺资源。

# c# - NHibernate Insert into ... select ... 使用 GUID 作为 PrimaryKey

> ID：11528914
> 
> 赞同：1
> 
> 时间：2012-07-17T18:47:40.903
> 
> 标签：c#, nhibernate, hql

我尝试使用 NHibernate 进行休闲：

```
this.Session.CreateQuery(@"insert into ContactGroupContact (Id, MailAddress, Company, Person, Branch, ContactGroup, User, FaxNumber)
                             select newid(), MailAddress, Company, Person, Branch, 
                                    :destContactGroupId, User, FaxNumber
                             from ContactGroupContact cgc
                             where cgc.ContactGroup.Id = :contactGroupId")
        .SetEntity("destContactGroupId", tempContactGroup)
        .SetGuid("contactGroupId", contactGroupId)
        .ExecuteUpdate(); 
```

的列`Id`是`ContactGroupContact`类型`GUID`。

当我执行此操作时，我收到`NHibernate.QueryException`以下消息：

> 节点没有数据类型： MethodNode ( ( newid exprList ) [插入 ContactGroupContact (Id, MailAddress, Company, Person, Branch, ContactGroup, User, FaxNumber) select newid(), MailAddress, Company, Person, Branch, :destContactGroupId, User , 来自 ContactGroupContact cgc 的传真号码，其中 cgc.ContactGroup.Id = :contactGroupId]

有人可以帮我吗，出了什么问题？- 谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:40:52.253

这是 Diego 建议的一个例子。我承认我对此并不陌生，但假设这是处理它的适当方法（它有效）

```
public class DerivedDialectWithNewId : MsSql2005Dialect
{
    public DerivedDialectWithNewId()
    {
        RegisterFunction("newid", new NoArgSQLFunction("newid", NHibernateUtil.Guid, true));        
    }
} 
```

这里是如何将它与 Fluent NHibernate 一起使用

```
private static FluentConfiguration GetConfiguration()
    {
        return Fluently.Configure()
            .Database(
                MsSqlConfiguration.MsSql2005.ConnectionString(
                    c => c.FromConnectionStringWithKey("CustomConnectionString"))
                    .Dialect<DerivedDialectWithNewId>()));
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T20:01:48.313

尝试创建派生`Dialect`并注册`newid`为函数。

# javascript - 浏览器强制执行的大小限制是多少?

> ID：11528915
> 
> 赞同：1
> 
> 时间：2012-07-17T18:47:43.530
> 
> 标签：javascript, html, forms, http-post

尝试使用图像文件上传大图像时，POST 中不包含到服务器。确保文件在 POST 请求中发送到服务器的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:06:31.293

您需要说明*服务器*是什么，因为它指定了限制。一般来说，POST 请求没有定义的限制——尽管对于非文件 POST 条目，一些**浏览器** *会*设置限制，有时大约 2MB。

告诉我们服务器类型，我们可以告诉您如何更改限制（假设它是您可以控制的服务器）。告诉我们您希望传输的文件大小也会很有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:11:14.507

就像我在评论中所说的那样，它与浏览器无关，与您服务器上的设置有关。

它在文档中：[https ://docs.djangoproject.com/en/dev/topics/http/file-uploads/?from=olddocs](https://docs.djangoproject.com/en/dev/topics/http/file-uploads/?from=olddocs)

> **更改上传处理程序行为**
> 
> *三个设置控制 Django 的文件上传行为：*
> 
> `FILE_UPLOAD_MAX_MEMORY_SIZE`
> 
> 将上传到内存中的文件的最大大小（以字节为单位）。大于 FILE_UPLOAD_MAX_MEMORY_SIZE 的文件将被流式传输到磁盘。
> 
> ```
> Defaults to 2.5 megabytes. 
> ```

# c++ - 如何注册 UPnP 服务

> ID：11528916
> 
> 赞同：3
> 
> 时间：2012-07-17T18:47:44.050
> 
> 标签：c++, windows-mobile, windows-ce, upnp

我有一个适用于 Windows Mobile 6 ARMV4I 的 Visual Studio 2008 C++ 项目，我想在其中注册一个 UPnP 服务。

我正在使用 Windows CE 6 SDK 中的 Microsoft 示例作为 UPnP 服务的实现。WINCE600\PUBLIC\SERVERS\SDK\SAMPLES\UPNP\DEVICE

不幸的是，`RegisterRunningDevice`调用失败并出现错误 E_HANDLE。

```
#include "upnpdevice_i.c"
#import "upnpdevice.dll" named_guids

int main()
{
    ::CoInitializeEx( NULL, COINIT_MULTITHREADED );

    using namespace UPnPHostLib;
    IUPnPDeviceControlPtr device_ctrl( CLSID_Device );
    IUPnPRegistrarPtr registrar( CLSID_UPnPRegistrar );

    bstr_t device_descr = /* contents of the device.xml file from the sample */

    // throws a _com_error exception where hr = E_HANDLE
    bstr_t device_id = registrar->RegisterRunningDevice( device_descr, 
        device_ctrl, 
        L"foo", 
        L"/windows/upnp", 
        0 );

    /* ... */

    ::CoUninitialize();
    return 0;
} 
```

我看到其他人在我的网络搜索过程中提到了这个错误，但我没有看到任何结果。

*   我已经注册了 upnpdevice.dll
*   我已经安装了“可选的 Windows Mobile 服务器组件”upnpctrl、upnphost 和 httpd。
*   可执行文件、upnpdevice.dll、device.xml 和 service.xml 文件都在`/windows/upnp`目录中。

有人有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T15:08:25.037

我已经解决了。问题是[可选的 Windows Mobile Server 组件](http://msdn.microsoft.com/en-us/library/bb416384.aspx)未签名。当 device.exe 在启动时尝试将它们加载为流驱动程序时，它们被拒绝了。

-保罗H

# ruby-on-rails - 将 Rails 的 ActiveRecord 中的稀疏数据转换为对 HTML 表友好的格式？

> ID：11528919
> 
> 赞同：3
> 
> 时间：2012-07-17T18:47:58.603
> 
> 标签：ruby-on-rails, html-table

我正在寻找一个必须是常见场景的最佳实践：将从 Rails（ActiveRecord，SQL）数据库表中提取的*稀疏记录按摩到一个结构中，以便在 HTML 中呈现表。*

出于性能原因，我做了一个查询，它返回这样的数据（为了清楚起见，我简化了示例）：

```
Lineitem.all
=> [#<Lineitem id: 1, username: "Bob", category: "A", amount: 10>, 
    #<Lineitem id: 2, username: "Bob", category: "C", amount: 20>, 
    #<Lineitem id: 3, username: "Jen", category: "A", amount: 30>, 
    #<Lineitem id: 4, username: "Ken", category: "B", amount: 40>,
    #<Lineitem id: 5, username: "Ken", category: "E", amount: 50>] 
```

我的目标是这样的 HTML 表格：

```
 A     B     C     D     E
           ---   ---   ---   ---   ---
  Bob       10          20
  Jen       30   
  Ken             40                50
  Sam 
```

如果每个类别都作为单独的列存储在数据库中（或者如果我使用的是 NoSQL ......？！）或者如果我不关心数据库性能，这将是微不足道的。

为了解决这个问题，我一直在编写这样的臭帮助代码：

```
# create hash lookup, index first by username then by category, eg:
#   ["Bob"]["A"] = #<Lineitem id: 1, ...>
#   ["Bob"]["C"] = #<Lineitem id: 2, ...>
#   ["Jen"]["A"] = #<Lineitem id: 3, ...>  ...
def index_lineitems(lineitems)
  h = {}
  lineitems.each do |li|
    h[li.username] = {} unless h.key? li.username
    h[li.username][li.category] = li
  end
  h
end

# look up value from indexed hash
def get_lineitem_amount(indexed_lineitems, username, category)
  if indexed_lineitems.key?(username) && indexed_lineitems[username].key?(category)
    indexed_lineitems[username][category].amount
  else
    ""
  end
end 
```

或对此的一些变化。然后我确定最终的行和列列表是什么（注意“Sam”行......）并通过`get_lineitem_amount`每次循环和调用来呈现 HTML 表。这是如此糟糕的代码，我很尴尬地分享它。

对于这个常见问题，肯定有一种更简洁、更 OO 和 Rails 友好的方法。

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:51:33.847

我正在做一些非常相似的稍微清洁的事情：

假设这是在控制器中：

```
@data = LineItem.all 
```

这就是观点

```
columns = @data.map(&:category).uniq

%table
  %thead
    %tr
      %th &nbsp;
      - columns.each do |column|
        %th= column
  %tbody
    - @data.group_by(&:username).each do |username, rows|
      %tr
        %td= username
        - cursor = 0
        - rows.group_by(&:category).sort_by{|cat,rows| columns.index(cat)}.each do |category, rows|
          - until cursor == columns.index(category) do
            - cursor += 1
            %td &nbsp;
          %td= rows.sum(&:amount) 
```

如果您将列存储在单独的数据库表中并将它们包含到当前模型中，那么它会变得更干净. 一个额外的查询并不会真正破坏应用程序的性能。

# google-maps - Google Maps API 请求性能问题

> ID：11528920
> 
> 赞同：0
> 
> 时间：2012-07-17T18:48:02.543
> 
> 标签：google-maps, google-maps-api-3

我有一个应用程序，它通过谷歌地图 api（距离矩阵和地图 API）使用地理定位来计算距离并在地图上显示图钉。我的逻辑存在性能问题（我的数据库中有 100 个地址，我将它们全部抓取，我将所有地址都放入距离矩阵并获取我所在位置的距离）每次用户点击时我都会这样做更新位置按钮。但是该方法有一个问题，每次单击刷新按钮时我都会发出 100 个请求，并且仅适用于 1 个用户。显然，有时 API 会限制每天的请求数。我的问题是：我怎样才能获得更好的性能并改进我的逻辑，让这个应用程序运行得更快并且不达到每日请求限制？我有大约 1000 人在使用这个应用程序。

这是我的代码：

```
<?php
header('Content-Type: application/json');

// Open the connection with the database
$conn = mysql_connect('localhost', 'gennovacap', 'coupons');
mysql_select_db('coupons', $conn);

$id_voucher = $_POST['id_voucher'];
$uuid = $_POST['uuid'];
// $uuid = "1343C38F-C0F3-4D86-B763-C14CFBF1DAC3";
// $id_voucher = 8;

$q = mysql_query("SELECT * FROM vouchers WHERE id_voucher = ".$id_voucher);
$voucher = mysql_fetch_assoc($q);

if(preg_match('/[\+]{2}+/', $voucher['address'])) {
    $i = 0;
    foreach(explode('++', $voucher['address']) as $address){

        $address = preg_replace('/\s/m', '+', $address);
        $request = "http://maps.googleapis.com/maps/api/geocode/xml?address=".$address."&sensor=true";
        $result = simplexml_load_file($request);

        $latitude = $result->result->geometry->location[0]->lat;
        $longitude = $result->result->geometry->location[0]->lng;

        $json['markers'][$i]['latitude'] = $latitude;
        $json['markers'][$i]['longitude'] = $longitude;
        $json['markers'][$i]['titlev'] = $voucher['name'];

        $i++;
    }

} else {

    $address = preg_replace('/\s/m', '+', $voucher['address']);
    $request = "http://maps.googleapis.com/maps/api/geocode/xml?address=".$address."&sensor=true";
    $result = simplexml_load_file($request);

    $latitude = $result->result->geometry->location[0]->lat;
    $longitude = $result->result->geometry->location[0]->lng;

    $json['markers'][0]['latitude'] = $latitude[0];
    $json['markers'][0]['longitude'] = $longitude[0];
    $json['markers'][0]['titlev'] = $voucher['name'];

}

// See if the user redeemed this coupon
$redemption = mysql_query("SELECT * FROM redemptions WHERE uuid = '".$uuid."' AND id_voucher = '".$id_voucher."'");
$count = mysql_num_rows($redemption);
if($count > 0) {
    $created_at = mysql_fetch_row($redemption);
    $json['titlev'] = $voucher['name'];
    $json['deal'] = $voucher['deal'];
    $json['redemptions'] = false;
    $json['redemptions_text'] = $created_at[3];
} else {
    $json['titlev'] = $voucher['name'];
    $json['deal'] = $voucher['deal'];
    $json['redemptions'] = true;
    $json['redemptions_text'] = "Redeem This Coupon";
}

print json_encode($json); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T20:24:38.667

[这与Rafael Fragoso 的问题](https://stackoverflow.com/questions/11505555/working-with-geolocation-and-google-maps-api-help)非常相似，我的回答也适用于此处。*正如安德鲁所说，您可以暂时缓存它（因此可以暂时*存储由一个用户进行地理编码的地址- 这对于符合 TOS 很重要），以供其他用户在接下来的一小时或几分钟或任何时间内需要该地址。

然而，一个更好、更健壮的解决方案是找到一个可以提升查询限制并且更永久的 API。请参阅我的链接答案以获取帮助您入门的建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T18:57:06.037

你可以使用缓存来减少请求的数量吗？

另外，我过去做过的事情是，当我达到谷歌 API 请求的限制并回退到其他服务（如 Yahoo 或其他服务）时。

我不确定雅虎是否具有相同的功能，但可能值得研究

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-17T19:57:41.943

我不确定我是否理解您为什么要反复查找 lat/lng。将地图查找添加到用于添加/编辑地址并将纬度/经度直接存储在数据库中的界面会容易得多。当您编辑地址时，请通过显示 Google 地图的 Web 浏览器执行此操作，并使用 JavaScript 将 lat/lng 推送到隐藏字段中，然后将其发布回服务器端脚本，该脚本可以将它们放入数据库中。

然后，当您需要引脚数据时，您可以直接从数据库中提取它。您的代码将运行得更快，对于 100 个地址，您只需触摸 API 100 次，而不是每次使用 100 次。

在 JavaScript 中运行脚本客户端，您不会遇到限制，如果您批量运行它们可能会达到 10/秒的吞吐量限制，但如果您一次执行一个，则不适用。

# php - 正则表达式将单词的第二个字母大写

> ID：11528921
> 
> 赞同：1
> 
> 时间：2012-07-17T18:48:05.030
> 
> 标签：php, regex

使用php，我想取一个全小写的单词，如果单词的第一个字母以an开头，`i`则将第二个字母大写。

因此，如果我的话是在字符串`iphone`之后。`preg_replace()``iPhone`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T18:52:01.627

使用此正则表达式`(?<=\b\w)(\w)`查找字母但正则表达式无法修改字符串，使用正则表达式匹配的索引以通过 php 大写

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T18:52:32.037

尝试这个：

```
$str = preg_replace('/^i([a-z])([a-z]+)$/e', '"i" . strtoupper("\\1") . "\\2"', $str); 
```

此代码检查单个单词以查看它是否全部为小写。如果是这样，它将第二个字母大写。

如果它变得更复杂，您可能想要使用[preg_replace_callback()](http://php.net/preg_replace_callback)代替。

# javascript - 在 Javascript 中解析 XML 的问题

> ID：11528923
> 
> 赞同：0
> 
> 时间：2012-07-17T18:48:07.603
> 
> 标签：javascript, xml, ajax, xmlhttprequest

我有一个 javascript 函数，它向我的服务器上的一个 php 文件发出 http_request，该文件生成一个 XML 文件（见下面的输出）。当返回 XML 文件时，相同的 javascript 函数会**解析 XML（这是我的问题所在）**并将其传递给其他函数；其中大部分处理。

到目前为止，我一直无法解析我的 XML 文档，也无法完全弄清楚原因。

**XML**

```
<Results><!--Root-->
  <Result_Set>
    <State>State</State>
    <Cities>
      <City>City 1</City>
      <City selected="true">City 2</City>
       ...ETC...
    </Cities>
    <Zipcodes>
       <Zipcode selected="true">Zipcode 1</Zipcode
       <Zipcode>Zipcode 2</Zipcode>
        ...ETC...
    </Zipcodes>
  </Result_Set>
</Results> 
```

**Javascript**

```
function GetZipInfo(zipcode){
    var xmlhttp;
    var x,resultSet,state,cities,zipcodes

    if (window.XMLHttpRequest){// code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
      }
    else{// code for IE6, IE5
         xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
      }

    xmlhttp.onreadystatechange=function(){
        if (xmlhttp.readyState==4 && xmlhttp.status==200){  

            resultSet=xmlhttp.responseXML.documentElement.getElementsByTagName("Result_Set") //Function Crashes Here

            for(x=0;x<resultSet.length;x++){
                state=resultSet[x].getElementsByTagName("State")[0].nodeValue;
                cities=resultSet[x].getElementsByTagName("Cities");
                zipcodes=resultSet[x].getElementsByTagName("Zipcodes");

                selectState(state)
                xmlDropdown(cities, "City", "Cities")
                xmlDropdown(zipcodes, "Zipcode", "Zipcodes")
            }
        }
    }   
    xmlhttp.open("GET","GetZipInfo.php?Zipcode="+zipcode,true);
    xmlhttp.send();
} 
```

我以前从未用任何语言解析过 XML 文档，所以我认为可以肯定地说我完全不知道哪里出了问题。

先感谢您！

编辑：事实证明，我的响应是以**responseText**而不是**responseXML的形式返回的**

**响应文本**

我正在使用**php**创建 XML 页面：

```
header("Content-Type: text/plain");
//Create the DOM
echo $xmlDoc->saveXML() 
```

仍然不确定为什么它不作为 XML 返回。它可能与**echo $xmlDoc->saveXML() 有关**吗？

**编辑**：我同意一些评论，即我的问题在于 XML 文件中的标题。我在代码中添加了“alert(xmlhttp.responseText)”行。其中显示：

```
<?xml version="1.0"?>
<!--The Contents of my XML file--> 
```

是否需要设置编码类型才能正常工作。如果是这样，我如何修改我的 PHP 代码（见上文）以插入该编码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:11:22.720

您的响应的 MIME 类型应该是，或以( [RFC 3023](https://www.rfc-editor.org/rfc/rfc3023)`text/xml` )结尾的东西。`+xml`

此外，您应该在第一行之前添加一个[XML 声明。](http://www.w3.org/TR/2000/REC-xml-20001006#sec-prolog-dtd)

最后但并非最不重要的一点是，虽然[`getElementsByTagName`](https://developer.mozilla.org/en/DOM/element.getElementsByTagName)它适用于 HTML 文档中的所有元素，但您应该[`document.getElementsByTagName`](https://developer.mozilla.org/en/DOM/document.getElementsByTagName)在 XML 文档中使用：

```
var resultSet = xmlhttp.responseXML.getElementsByTagName("Result_Set"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:06:40.180

在您的代码顶部，您缺少：

```
<?xml version="1.0" encoding="UTF-8" ?> 
```

还缺少';' 在这些行之后：

```
selectState(state)
xmlDropdown(cities, "City", "Cities")
xmlDropdown(zipcodes, "Zipcode", "Zipcodes") 
```

在 XML 中也缺少 '>' 之后：

```
</Zipcode 
```

# objective-c - 在 Windows 中运行目标 c

> ID：11528929
> 
> 赞同：0
> 
> 时间：2012-07-17T18:48:47.680
> 
> 标签：objective-c, windows, gnustep

我安装了 GNUstep 和 minGW。我的代码似乎编译没有错误，当我尝试运行它时，我得到：

> gnustep-base-1_24.dll 丢失

我正在使用 Windows GNUStep。

注意：我将 GNUstep/system/Tools 目录添加到我的 PATH

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-31T09:37:50.980

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T23:43:44.627

此链接对设置 GUNstep 非常有帮助： [objective-c-for-windows](https://stackoverflow.com/questions/56708/objective-c-for-windows)

但是如果编译时出现问题，试试这个命令： gcc -o hello hello.m -I/c/GNUstep/GNUstep/System/Library/Headers \ -L /c/GNUstep/GNUstep/System/Library/Libraries - lobjc -lgnustep-base \ -fconstant-string-class=NSConstantString

# ios - iOS 时变动画

> ID：11528930
> 
> 赞同：1
> 
> 时间：2012-07-17T18:48:52.510
> 
> 标签：ios, time, uiviewanimation, varying

我有兴趣为视图做类似动画的抖动，类似于中描述的内容

[ios-icon-jiggle-algorithm](https://stackoverflow.com/questions/6604356/ios-icon-jiggle-algorithm)和[error-in-button-jiggle-algorithm](https://stackoverflow.com/questions/11499298/error-in-button-jiggle-algorithm)

然而，这些解决方案实现**了时不变**动画，这意味着动画序列在动画开始之前是固定的，并且一遍又一遍地执行完全相同的动画。在这些情况下，旋转角度是预先计算的。

我想做的是**时变**动画，其中动画随时间变化。在前面的示例中，我希望旋转角度根据一些基于时间的函数而变化。

打个比方，想象一下我正在为一块果冻制作动画。在动画开始时，我敲击果冻一次，它开始摇晃，然后随着时间的推移，摇晃的大小逐渐减小，直到它完全不摇晃。

据我了解，我无法将随时间变化的值注入到动画块中，我认为唯一可行的做法是按照[ios-multiple-animation-blocks](https://stackoverflow.com/questions/10019696/ios-multiple-animation-blocks)将固定动画字符串链接在一起。将 3 或 4 个递减动画值串在一起，我应该会得到一个可以接受的效果。

那么，如果有办法用 UIView Animations 做我想做的事呢？还是我应该采用另一种方法？

**[编辑]**

为了更清楚我所说的时变的含义，我希望能够将动画属性的值指定为函数时间，而不必先验地预先计算动画属性。并且以一种（可能）允许我即时修改功能的方式这样做。作为一个具体的例子，我可能想要一个函数 f(t) ：

```
For t<0 f(t) = 0
For t>0 and t<1 f(t) = 1-t
For t>1 f(t)= 0 
```

实际上，更好的 af(t) 表示形式如下：

```
f(t) = A(t)sin(t) 
```

**[编辑#2]**

经过一番考虑，我决定，虽然理想情况下能够指定随时间变化的视图动画是我想要做的效果，但实际上，当它应用在应用程序中时，用户可能不会注意到我的编程能力。所以我只是要伪造它并使用预先计算并多次触发的关键帧动画。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T21:28:43.497

抱歉，如果不通过触发完成块中的下一个将多个动画链接在一起，您就无法使用 UIView 动画执行此操作，您真的不应该这样做。

但别担心，你要做的并不难。

Core Animation 支持属性的[关键帧动画](https://developer.apple.com/library/mac/#documentation/GraphicsImaging/Reference/CAKeyframeAnimation_class/Introduction/Introduction.html)，您可以在其中指定属性应在其间进行动画处理的值数组。您还可以指定属性将从中读取其值的路径。

如果您指定一个值数组，您可以对值之间的时间以及如何完成插值（指定值之间的计算）进行细粒度控制。

你像这样创建一个新动画

```
CAKeyframeAnimation *myJiggleAnimation = [CAKeyframeAnimation animationWithKeyPath:nameOfPropertyBeingAnimated];
// example key paths could be @"position" or @"transform"
[myJiggleAnimation setValues:[NSArray arrayWithValues:/* your values here */]]; 
```

由于您要向 NSArray 添加对象，因此它们必须包含在对象中。对于数字，这意味着使用`NSNumber`s。对于这样的点、矩形或变换，有一个名为的类`NSValue`可以包装这些，像这样

```
[NSValue valueWithCGPoint:myPoint]; 
[NSValue valueWithCGSize:mySize];
[NSValue valueWithCGRect:myRect]; 
[NSValue valueWithCATransform3D:myTransform]; // 3D transform
[NSValue valueWithCGAffineTransform:myAffineTransform]; // 2D transform 
```

然后运行动画，你将它添加到应该动画的视图层，像这样

```
[[myView layer] addAnimation:myJiggleAnimation forKey:@"jiggle"];
// The key is used so that you can reference the animation if you have to 
```

请注意，在动画结束时，动画属性的值不会改变，因此视图可能会跳回原始状态。这是预期的行为。要让它以另一个值结束，只需在将动画添加到图层后将属性设置为其结束值。

* * *

*注意：*由于它是核心动画，因此您必须将其导入`QuartzCore.framework`您的项目并包含`<QuartzCore/QuartzCore.h>`在您的代码中。

# amazon-ec2 - 对于 AWS AutoScaling - 必须有多少台服务器同意？

> ID：11528931
> 
> 赞同：0
> 
> 时间：2012-07-17T18:48:54.280
> 
> 标签：amazon-ec2, amazon-web-services

我找不到与此相关的文档，因此请指出其中提到这一点的地方....

假设我有一个包含 3 个服务器的自动缩放组，并且我想在 CPU 超过 X% 时添加更多服务器。在扩展策略采取行动之前，这些服务器中有多少必须超过 x%？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T15:33:16.010

简短版：没有固定的数字。

扩展策略是触发 cloudwatch 警报时采取的操作。

由您来定义该警报是什么。最简单的指标可能是自动缩放组聚合的 CPU 利用率。除了选择指标之外，您还需要选择它的聚合方式（亚马逊称其为统计数据）

如果您选择“平均”统计数据，那么它会平均跨实例的 cpu 利用率，因此没有固定数量的实例会触发策略。假设您的阈值是 50%，如果两台服务器为 45%，一台为 60，则警报应触发，但如果 1 台服务器为 45%，两台服务器为 51%，则不会触发。

您还可以将警报设置为最大触发：只要有 5 分钟的时间段，服务器总是 > 50%（不一定总是相同的），或者最小触发：当所有服务器高于阈值

# php - PHP - 将图像目录剪切在一起

> ID：11528933
> 
> 赞同：0
> 
> 时间：2012-07-17T18:49:07.907
> 
> 标签：php, image

假设我有一个 32 像素 (32x32) 的图像目录，我想让它成为一个精灵表。我不想手动执行它，因为它会花费太长时间，但是我该如何制作它，以便每张图像都被粉碎成一个图像，它是一条线......所以.. 32px 高宽会大得多（显然）。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:00:16.090

正如 Crontab 建议的那样，我会使用 ImageMagick。这是工作的正确工具。你可以让你的 PHP 脚本执行一个 shell 脚本；在该 shell 脚本中，您可以使用正确的 ImageMagick 命令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T19:10:51.870

虽然 ImageMagick 是要走的路，但您不需要调用 shell 脚本。

而是使用[ImageMagick PHP 类](http://php.net/manual/en/book.imagick.php)。这是 PECL 存档的一部分，因此即使在大多数托管 Web 服务器上也很容易安装。

# jquery - 如何使用 jquery 更新选择元素的选项列表？

> ID：11528936
> 
> 赞同：2
> 
> 时间：2012-07-17T18:49:37.237
> 
> 标签：jquery, html

我有一个看起来像这样的选择元素：

```
<select id="productId">

</select> 
```

我当前的 jquery 如下：

```
...
if (data.success) {
    var items = [];
    $.each(data.products, function(key, val) {
        items.push('<options id="' + val + '">' + key + '</option>');
    });
    var options = items.join('');
    $("#productId").html(options);
    //$("#productId").val(options);
    //$("#productId").append(options);
} 
```

我的任何尝试都不会用我的新选项更新选择标签。我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T18:51:20.887

试试这个：

```
if (data.success) {
    $.each(data.products, function(key, val) {
        $('#productId').append('<option id="' + val + '">' + key + '</option>');
    });
} 
```

# c# - 如何在 WindowsFormsHost 控件中捕获鼠标单击事件？

> ID：11528940
> 
> 赞同：1
> 
> 时间：2012-07-17T18:49:55.567
> 
> 标签：c#, wpf, events, windowsformshost

我有一个带有 WindowsHostControl 的用户控件，它承载了第 3 方视频控件。我希望能够在视频上单击鼠标时捕获鼠标单击事件。我尝试将事件附加到 WindowsFormsHost 控件，但它从未触发。如何拦截鼠标点击？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T20:27:37.170

我通过将事件处理程序附加到 WindowsFormsHost 中包含的子元素解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:19:40.677

改为捕获 PreviewMouseDown。

# python - Python：连接 URL 和整数

> ID：11528942
> 
> 赞同：1
> 
> 时间：2012-07-17T18:49:59.717
> 
> 标签：python, string, url, urllib2, string-concatenation

我正在尝试根据循环的迭代连接 url 和整数。但我收到错误：`TypeError: not all arguments converted during string formatting`

```
for i in range(0,20):
    convertedI = str(i)
    address = 'http://www.google.com/search?q=%s&num=100&hl=en&start='.join(convertedI) % (urllib.quote_plus(query)) 
```

我也尝试了 urllib.urlencode 函数，但最终得到了同样的错误。

我想我应该提到除了查询之外，这是一个我在我的 main 中传递的字符串我想将当前迭代值分配给 url 中的 start 参数>`&start=1`

所以第一次迭代我希望我的网址为

```
http://www.google.com/search?q=%s&num=100&hl=en&start=1' % (urllib.quote_plus(query)) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T18:52:05.150

```
for i in range(0, 20):
    address = 'http://www.google.com/search?q=%s&num=100&hl=en&start=%s' % (urllib.quote_plus(query), i) 
```

无需使用`str`as`%s`隐含地为您执行此操作。也不需要`join`,`join`用于在一个序列中获取多个字符串并使用连接字符将它们拉到一起。您只需要简单的字符串格式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T18:52:38.677

我认为你误解了什么`join`。它使用它的参数作为分隔符来连接传递序列的元素：

```
>>> ','.join(['a', 'b', 'c'])
'a,b,c' 
```

听起来你只是想做`"http://..." + convertedI`，但不清楚你到底想做什么。您想要在哪里以及字符串中`convertedI`的值？`urllib.quote_plus(query)`

# java - 在phonegap中从js调用一个java函数

> ID：11528945
> 
> 赞同：1
> 
> 时间：2012-07-17T18:50:14.287
> 
> 标签：java, javascript, function, cordova, webintents

我在移动应用程序中，遇到以下问题：

我有一个`MiniPrinterFunction.java`文件，里面`com.StarMicronics.StarIOSDK`包含`GetStatus()`,`PrintText()`和`PrintBitmap()`函数。

`GetStatus()`我想从 phonegap 中的 javascript调用例如函数。

我尝试 webintent 如下

```
window.plugins.webintent.sendBroadcast({
        action: 'com.StarMicronics.StarIOSDK.MiniPrinterFunctions.GetStatus'

    }, function() {alert("test1");
    }, function() {alert("test2");
}); 
```

没有成功...

这是正确的方法还是有其他方法可以做到这一点？？？？

请指教

# java - 使用java验证信用卡到期日期？

> ID：11528949
> 
> 赞同：4
> 
> 时间：2012-07-17T18:50:23.203
> 
> 标签：java, regex, validation, date

我正在寻找以 MM/YY 格式验证信用卡到期日期。我不知道如何验证，是否选择简单日期格式/正则表达式。

感谢你的帮助。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-07-17T19:01:36.707

用于`SimpleDateFormat`解析 a `Date`，然后将其与 new 进行比较`Date`，即“现在”：

```
String input = "11/12"; // for example
SimpleDateFormat simpleDateFormat = new SimpleDateFormat("MM/yy");
simpleDateFormat.setLenient(false);
Date expiry = simpleDateFormat.parse(input);
boolean expired = expiry.before(new Date()); 
```

### 编辑：

感谢您`@ryanp`的宽大处理。`ParseException`如果输入不正确，上面的代码现在将抛出一个。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-17T21:41:06.550

扮演魔鬼的拥护者...

```
boolean validateCardExpiryDate(String expiryDate) {
    return expiryDate.matches("(?:0[1-9]|1[0-2])/[0-9]{2}");
} 
```

翻译为：

*   非捕获组（[什么是非捕获组？问号后跟冒号 (?:) 是什么意思？](https://stackoverflow.com/q/3512471/1143427)）：0 后跟 1-9，**或**1 后跟 0-2
*   其次是 ”/”
*   其次是0-9，**两次**。

...所以这个版本需要零填充月份（01 - 12）。`?`在第一个之后添加一个`0`以防止这种情况。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-03-14T12:57:04.777

## java.time

要验证您是否有有效的到期日期字符串：

```
 DateTimeFormatter ccMonthFormatter = DateTimeFormatter.ofPattern("MM/uu");
    String creditCardExpiryDateString = "11/21";
    try {
        YearMonth lastValidMonth = YearMonth.parse(creditCardExpiryDateString, ccMonthFormatter);
    } catch (DateTimeParseException dtpe) {
        System.out.println("Not a valid expiry date: " + creditCardExpiryDateString);
    } 
```

要验证它是否表示信用卡过期：

```
 if (YearMonth.now(ZoneId.systemDefault()).isAfter(lastValidMonth)) {
            System.out.println("Credit card has expired");
        } 
```

考虑一下您要使用哪个时区，因为新月份并非在所有时区的同一时刻开始。如果你想要 UTC：

```
 if (YearMonth.now(ZoneOffset.UTC).isAfter(lastValidMonth)) { 
```

如果您愿意，例如，欧洲/基辅时区：

```
 if (YearMonth.now(ZoneId.of("Europe/Kiev")).isAfter(lastValidMonth)) { 
```

**链接：** [Oracle 教程：](https://docs.oracle.com/javase/tutorial/datetime/)解释如何使用 java.time 的日期时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T19:02:04.557

你真的需要使用正则表达式吗？正则表达式实际上只适合匹配字符，而不是日期。我认为只使用简单的日期函数会容易得多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-03-14T12:32:11.257

我认为代码会更好：

```
int month = 11;
int year = 2012;

int totalMonth = (year * 12) + month;
totalMonth++; // next month needed
int nextMonth = totalMonth % 12;
int yearOfNextMonth = totalMonth / 12;

SimpleDateFormat simpleDateFormat = new SimpleDateFormat("MM/yyyy");
simpleDateFormat.setLenient(false);
Date expiry = simpleDateFormat.parse(nextMonth + "/" + yearOfNextMonth);
boolean expired = expiry.before(new Date()); 
```

您需要计算下个月，因为信用卡上显示的月份是卡有效的最后一个月。

# xcode - Xcode 按钮启动 URL

> ID：11528950
> 
> 赞同：5
> 
> 时间：2012-07-17T18:50:30.877
> 
> 标签：xcode, button

我创建了一个简单的应用程序，在底部工具栏中有一个按钮，但我似乎无法让按钮工作。我试图附加一个动作，按下时会打开一个 URL，但它不起作用。所以我已经删除了这个动作，我希望有人能提供帮助。我已在此 URL [https://www.box.com/s/5d45ce1df7d9dd0fe205上发布了压缩的 xcode 项目](https://www.box.com/s/5d45ce1df7d9dd0fe205)

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-07-17T18:52:25.817

像这样的东西会起作用。这是纯文本按钮的示例：

```
UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];
[button setFrame:CGRectMake(0, 0, 100, 40)];
[button setBackgroundColor:[UIColor clearColor]];
[button setTitle:@"Google" forState:UIControlStateNormal];
[button setTitleColor:[UIColor blueColor] forState:UIControlStateNormal];
[button addTarget:self action:@selector(openGoogleURL) forControlEvents:UIControlEventTouchUpInside];
[self.view addSubview:button]; 
```

和按钮的选择器：

```
-(void)openGoogleURL
{
    [[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"https://www.google.com"]];
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-08-30T19:03:14.253

使用另一个嵌入了 webView 的视图控制器。此解决方案强制在观看 url 内容期间留在您的应用程序中。

1.  在情节提要上创建另一个视图控制器。
2.  将 webview 放在上面。（将其命名为 webView ）
3.  通过辅助编辑器将 Web 视图与控制器类连接（假设您将新的 UIView 类连接到视图控制器）
4.  在新类的 viewDidLoad 中插入：

    ```
     [super viewDidLoad];
     NSString *fullURL = @"http://google.pl";

     NSURL *url = [NSURL URLWithString:fullURL];

     NSURLRequest *requestObj = [NSURLRequest requestWithURL:url];

    [self.webView loadRequest:requestObj]; 
    ```

# mysql - mysql中的条件选择变量

> ID：11528952
> 
> 赞同：0
> 
> 时间：2012-07-17T18:50:45.527
> 
> 标签：mysql, sorting, conditional

我正在尝试编写一个 SQL 查询，该查询将根据可能位于 2 个表中的 1 个或两者中的日期（这是数据库中的 INTEGER）进行排序。

与此相关的表中的字段是：

分配： - id - id_lead - date_assigned

潜在客户：- id - date_added

这些表还有其他字段，但它们不适用于这个问题。

现在我想要的是，如果没有为潜在客户分配，我希望“date_sort”变量成为潜在客户的 date_added 值。如果有潜在客户的分配，我希望它是分配的 date_assigned 值。

我的问题是，使用我的查询不会显示任何在我的结果列表中没有分配的潜在客户。

这是我正在处理的查询：

```
$pagi_sql = "select 
             l.id, l.id_infusionsoft, l.name_first, l.name_last, l.postcode, a.website as a_website, l.website as l_website, l.date_added,
             a.id_dealership, a.id_lead, a.id as id_assign, a.date_assigned,
             d.name as dealership,
             if(a.id = null, l.date_added, a.date_assigned) as date_sort
             from `leads` as l
             left join `assignments` as a on (a.id_lead = l.id)
             left join `dealerships` as d on (d.id = a.id_dealership)
             $where
             order by date_sort desc"; 
```

这是我的原始查询，它有效，但没有按照我想要的方式排序：

```
$pagi_sql = "select 
             l.id, l.id_infusionsoft, l.name_first, l.name_last, l.postcode, a.website as a_website, l.website as l_website, l.date_added,
             a.id_dealership, a.id_lead, a.id as id_assign, a.date_assigned,
             d.name as dealership
             from `leads` as l
             left join `assignments` as a on (a.id_lead = l.id)
             left join `dealerships` as d on (d.id = a.id_dealership)
             $where
             order by l.date_added desc"; 
```

潜在客户可以有多个分配....我认为这是问题所在...但我无法弄清楚如何让它按照我想要的方式进行排序。

我应该改变这些，以便我从分配表中选择吗？但后来我遇到了问题，如何在按 date_add/date_assigned 排序的同一张表中显示未分配的潜在客户？

任何帮助都是极好的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:56:39.047

更改此行：

```
if(a.id = null, l.date_added, a.date_assigned) AS date_sort 
```

对此：

```
if(a.id IS NULL, l.date_added, a.date_assigned) AS date_sort 
```

第一行没有按照您想要的方式排序的原因是因为`IF`总是执行错误条件，因为`NULL`它是一个未知值并且不能***等于***任何东西，甚至不等于它本身。

您必须使用`IS NULL`而不是`= NULL`.

阅读我对这个[问题的](https://stackoverflow.com/q/11500150/1446794)[回答](https://stackoverflow.com/a/11500175/1446794)，以更深入地了解价值观。`NULL`

* * *

编辑：如果你想更简洁，你可以这样做：

```
COALESCE(a.date_assigned, l.date_added) 
```

该[`COALESCE()`](http://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html#function_coalesce)函数将返回第一个非`NULL`参数。

如果您不需要显示 的值`date_sort`，您甚至可以将其直接放入`ORDER BY`子句中：

```
ORDER BY COALESCE(a.date_assigned, l.date_added) 
```

# c - 使用 memset 设置数组

> ID：11528955
> 
> 赞同：3
> 
> 时间：2012-07-17T18:50:52.520
> 
> 标签：c, arrays, memset

我仍然是 C 的新手，我对 memset 函数有疑问。

我将一个 char * 传递给一个函数，并在这个函数内部创建一个数组，然后使用 memset 设置每个值。我一直在使用 dbx 来观察这个变量，因为它进入了函数，并且由于某种原因，在我们通过 memset 之后它被设置为“”。

首先，为什么会发生这种情况？我假设 memset 必须重置 char * 所在的内存？

其次，有没有更好的方法将每个元素设置为“0”？

这是我的代码：

```
static char *writeMyStr(char *myStr, int wCount) {

   // here myStr is set to "My String is populated"  

   char **myArr;
   myArr = (char **) malloc(sizeof(char *) * wCount);
   memset(myArr, 0, sizeof(char *) * wCount);   // myStr is set to ""

   ... populate array ... 

} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-17T19:06:29.253

您是在寻找零字符还是零数字？像这样初始化数组时：

```
memset(arr, 0, count); 
```

它相当于

```
memset(arr, '\0', count); 
```

因为`0=='\0'`. 字符串的长度是第一个空终止符的位置，因此您的字符串长度为零，因为支持它的数组用零填充。人们这样做的原因是，当他们向字符串添加内容时，他们不需要重新以空值终止它。

如果您希望您的字符串为“0000”...使用字符零：

```
memset(arr, '0', count); 
```

但请记住以空值终止它：

```
arr[count-1] = '\0'; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T18:59:07.710

如果您最初尝试对数组进行零填充，最好使用 calloc 而不是 malloc。

所有 malloc 都会为您提供一个具有随机、不确定值的内存块。而 calloc 为您提供一块内存并将其填充为零，从而保证您不会在其中有垃圾。

# dev-c++ - 无法在 Devc 上为 SHA-256 哈希编译加密

> ID：11528956
> 
> 赞同：0
> 
> 时间：2012-07-17T18:50:58.133
> 
> 标签：dev-c++, crypto++

```
#include <..\cryptopp\dll.h>
#include <..\cryptopp\sha.h>
#include <..\cryptopp\hex.h>
#include<..\cryptopp\files.h>

#include <iostream>
#include<string>

using namespace std;
using namespace CryptoPP;

const int MAX_PHRASE_LENGTH=250;

int main(int argc, char *argv[]) {

CryptoPP::SHA256 hash;
byte digest[ CryptoPP::SHA256::DIGESTSIZE ];
std::string message = "Hello World!";

hash.CalculateDigest( digest, (const byte*)message.c_str(), message.length());

CryptoPP::HexEncoder encoder;
std::string output;
encoder.Attach( new CryptoPP::StringSink( output ) );
encoder.Put( digest, sizeof(digest) );
encoder.MessageEnd();

std::cout << "Input string: " << message << std::endl;
std::cout << "SHA256: " << output << std::endl;

return 0;
} 
```

错误

编译器：默认编译器正在执行 g++.exe... g++.exe "C:\Users\Pr\Desktop\Work\encrypt\sha256\sampeSHA256.cpp" -o "C:\Users\Pr\Desktop\Work\encrypt\ sha256\sampeSHA256.exe" -I"C:\Dev-Cpp\lib\gcc\mingw32\3.4.2\include" -I"C:\Dev-Cpp\include\c++\3.4.2\backward" -I "C:\Dev-Cpp\include\c++\3.4.2\mingw32" -I"C:\Dev-Cpp\include\c++\3.4.2" -I"C:\Dev-Cpp\include" -L "C:\Dev-Cpp\lib" 在来自 C:/Dev-Cpp/include/c++/3.4.2/backward/..\cryptopp/seckey.h:8 的文件中，来自 C:/Dev-Cpp/ include/c++/3.4.2/backward/..\cryptopp/rijndael.h:7，来自 C:/Dev-Cpp/include/c++/3.4.2/backward/..\cryptopp/aes.h:4，来自 C:/Dev-Cpp/include/c++/3.4.2/backward/..\cryptopp\dll.h:11，来自 C:\Users\Pr\Desktop\Work\encrypt\sha256\sampeSHA256.cpp:1: C:/Dev-Cpp/include/c++/3.4.2/backward/..\cryptopp/cryptlib.h:277: 错误：函数`std::string CryptoPP::NameValuePairs::GetValueNames() const' definition is marked dllimport. C:/Dev-Cpp/include/c++/3.4.2/backward/..\cryptopp\/cryptlib.h:283: error: function`bool CryptoPP::NameValuePairs::GetIntValue(const char*, int&) const' 定义标记为 dllimport。C:/Dev-Cpp/include/c++/3.4.2/backward/..\cryptopp/cryptlib.h:287: 错误：函数`int CryptoPP::NameValuePairs::GetIntValueWithDefault(const char*, int) const' definition is marked dllimport. C:/Dev-Cpp/include/c++/3.4.2/backward/..\cryptopp\/cryptlib.h:291: error: function`静态无效 CryptoPP::NameValuePairs::ThrowIfTypeMismatch(const char*, const std::type_info& , const std::type_info&)' 定义被标记为 dllimport。C:/Dev-Cpp/include/c++/3.4.2/backward/..\cryptopp/cryptlib.h:301: 错误: 函数`void CryptoPP::NameValuePairs::GetRequiredIntParameter(const char*, const char*, int& ) const' 定义被标记为 dllimport。

在来自 C:/Dev-Cpp/include/c++/3.4.2/backward/..\cryptopp/aes.h:4 的文件中，来自 C:/Dev-Cpp/include/c++/3.4.2/backward/ ..\cryptopp\dll.h:11，来自 C:\Users\Pr\Desktop\Work\encrypt\sha256\sampeSHA256.cpp:1: C:/Dev-Cpp/include/c++/3.4.2/backward/ ..\cryptopp/rijndael.h:15：错误：函数 `static const char* CryptoPP::Rijndael_Info::StaticAlgorithmName()' 定义标记为 dllimport。

在来自 C:/Dev-Cpp/include/c++/3.4.2/backward/..\cryptopp\dll.h:16 的文件中，来自 C:\Users\Pr\Desktop\Work\encrypt\sha256\sampeSHA256。 cpp:1: C:/Dev-Cpp/include/c++/3.4.2/backward/..\cryptopp/des.h:58: 错误：函数`static const char* CryptoPP::DES_EDE2_Info::StaticAlgorithmName()'定义标记为 dllimport。

C:/Dev-Cpp/include/c++/3.4.2/backward/..\cryptopp/des.h:82: error: function `static const char* CryptoPP::DES_EDE3_Info::StaticAlgorithmName()' 定义标记为 dllimport .

在来自 C:/Dev-Cpp/include/c++/3.4.2/backward/..\cryptopp\dll.h:37 的文件中，来自 C:\Users\Pr\Desktop\Work\encrypt\sha256\sampeSHA256。 cpp:1: C:/Dev-Cpp/include/c++/3.4.2/backward/..\cryptopp/skipjack.h:15: 错误：函数`static const char* CryptoPP::SKIPJACK_Info::StaticAlgorithmName()'定义标记为 dllimport。

执行终止

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-28T03:54:08.817

消除`#include <..\cryptopp\dll.h>`

正如弗雷泽所说，使用`-L<path to Crypto++>`.

正如弗雷泽所说，使用`-lcryptopp`or `-lcrypto++`。您使用的取决于您所拥有的。默认情况下，它的`-lcryptopp`.

# ios - iPhone SDK 故事板 - 将表字符串传递给以前的 segue？

> ID：11528957
> 
> 赞同：0
> 
> 时间：2012-07-17T18:51:19.063
> 
> 标签：ios, objective-c, iphone, sdk, segue

我有一个主 ViewController，它有两个按钮，每个按钮都连接到自己的表格视图。表格视图单元格有一个标题和一个副标题，我已经设法将我的内容加载到其中。

当我单击该项目时，我希望它与标题字符串和副标题字符串一起将我带回主视图控制器。

我应该使用推送转场还是模态转场？

在我的主视图控制器上，我有我希望字符串更改为的标签。

如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:00:47.193

如果你想“返回”到主视图控制器，你应该既不使用推送也不使用模态 segue。只要它包含在导航控制器中，听起来您想要做的就是以某种方式将从单元收集的数据转发到主视图控制器，然后将当前视图从导航堆栈中弹出。

如果您要使用 push segue，那么主视图控制器将在导航堆栈上两次。

如果您要使用模态转场，您最终可能会在模态视图控制器中到处漂浮着大量导航堆栈。

# java - 如何使用 java 检索 youtube 搜索结果及其视频 ID？

> ID：11528960
> 
> 赞同：1
> 
> 时间：2012-07-17T18:51:20.793
> 
> 标签：java, youtube

如果给出了视频 ID，我知道如何检索所有统计信息。但是，如果我必须根据查询标题检索搜索结果 (20) 的视频 ID，那么我将无法做到这一点。**任何人都可以帮助我如何使用JAVA API**处理它。

提前非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T19:01:10.517

您是否搜索过 Google 文档？他们的指南正是您正在寻找的内容：[YouTube API - 搜索视频](https://developers.google.com/youtube/2.0/developers_guide_java#Retrieving_and_searching_for_videos)

它甚至给你一个例子：

```
YouTubeQuery query = new YouTubeQuery(new URL("http://gdata.youtube.com/feeds/api/videos"));
// order results by the number of views (most viewed first)
query.setOrderBy(YouTubeQuery.OrderBy.VIEW_COUNT);

// search for puppies and include restricted content in the search results
query.setFullTextQuery("puppy");
query.setSafeSearch(YouTubeQuery.SafeSearch.NONE);

VideoFeed videoFeed = service.query(query, VideoFeed.class); 
```

从返回的 VideoFeed 中，您可以轻松获取视频 id。

```
for(VideoEntry videoEntry : videoFeed.getEntries() ) {
     YouTubeMediaGroup mediaGroup = videoEntry.getMediaGroup();
     mediaGroup.getVideoId(); // the video ID
} 
```

# asp.net-mvc - 从部分视图发送请求时出错

> ID：11528961
> 
> 赞同：0
> 
> 时间：2012-07-17T18:51:24.443
> 
> 标签：asp.net-mvc, model, partial-views

我正在尝试学习 MVC 的基础知识（NerdDinner 教程）。我定义了一个模型：

```
public class DinnerFormViewModel
{

    // Properties
    public Dinner Dinner { get; private set; }

    public SelectList Countries { get; private set; }

    // Constructor
    public DinnerFormViewModel(Dinner dinner)
    {
        Dinner = dinner;
        Countries = new SelectList(PhoneValidator.Countries, dinner.Country);
    }
} 
```

我定义了一个局部视图：

```
 @model MyNerddiner.Models.DinnerFormViewModel

 @using (Html.BeginForm()) {
 @Html.ValidationSummary(true)
 <fieldset>
    <legend>Dinner</legend>

    @Html.HiddenFor(model => model.Dinner.DinnerID)
    <div class="editor-label">
        @Html.LabelFor(model => model.Dinner.Title)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.Dinner.Title)
        @Html.ValidationMessageFor(model => model.Dinner.Title)
    </div>
</fieldset>
} 
```

从通常的视图加载：

```
 @model MyNerddiner.Models.DinnerFormViewModel
 @{
   ViewBag.Title = "Create";
 } 
 <div id="Create" > 
 <h2>Host a Dinner</h2>

   @Html.Partial("_DinnerForm")

 </div> 
```

控制器：

```
public ActionResult Create()
{

    Dinner dinner = new Dinner()
    {
        EventDate = DateTime.Now.AddDays(7)
    };
    return View(new DinnerFormViewModel(dinner));
}

[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Create(DinnerFormViewModel dinnerViewModel)
{
    Dinner dinner = null;
    if (ModelState.IsValid)
    {
        try
        {
            dinner = dinnerViewModel.Dinner;
            UpdateModel(dinner);
            dinnerRepository.Add(dinner);
            dinnerRepository.Save();

            return RedirectToAction("Details", new { id = dinner.DinnerID });
        }
        catch
        {
            ModelState.AddRuleViolations(dinner.GetRuleViolations());
            return View(dinner);
        }
    }
    return View(new DinnerFormViewModel(dinner));
} 
```

现在，当我尝试创建（回发）时，出现错误：

> 没有为此对象定义无参数构造函数。

我可以猜测这是因为程序试图在某个地方启动`DinnerFormViewModel`，但是在哪里，为什么以及如何使它正确？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:28:24.407

MVC 框架需要您的视图模型有一个不带参数的构造函数，以便它可以创建一个空实例来填充来自请求的数据。DinnerFormViewModel 没有实现没有参数的构造函数，添加一个，这将解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T20:11:03.913

嗯，找到问题了，和model和constructor无关。

问题是视图包含以下行：@Html.DropDownListFor(model => model.Countries, Model.Countries) @Html.ValidationMessageFor(model => model.Countries) 当我检查异常来自哪里时 - 它来自于国家价值为空。

在我将模型 => model.Countries 更改为模型 => model.Dinner.Country 之后

异常停止被抛出

我很高兴我自己解决了这个问题！

# pointers - 64位指针的问题

> ID：11528968
> 
> 赞同：0
> 
> 时间：2012-07-17T18:51:48.360
> 
> 标签：pointers, 64-bit, 32bit-64bit, 32-bit, pointer-address

我正在使用 Windows 7，并且我的程序有 64 位和 32 位版本。32 位版本工作得很好，但是，我在运行时遇到了 64 位版本的问题。我创建了一个列表视图项，并正在用我的信息填充列。它们都在打印，但有一个打印不正确。这是它正在打印的内容（我为缺少图片而道歉，但作为新成员我无法发布图片）：

卡车

ÍÍÍÍHRZ141

ÍÍÍÍHRZ152

它似乎在我真正希望它显示的信息之前放置了 4 个空字符。经进一步检查，该地址似乎不正确。这是发生错误的代码的一部分：

```
Audit * audit = (Audit *)plvdi->item.lParam;

    switch(plvdi->item.iSubItem)
    {
    case 0:
      {
        plvdi->item.pszText = audit->Truck;
        while(plvdi->item.pszText[0] != 'H')
        {
          plvdi->item.pszText++;
        }
      }
      return true; 
```

这是一个临时修复，因为我所有的卡车名称都以字符 H 开头。 plvdi->item.psz text 是列表视图项的文本显示，而 audit->Truck 是一个 char[]。它应该很简单：

```
sprintf(plvdi->item.pszText, audit->Truck); 
```

但这似乎不起作用。它给我留下了同样的错误。运行时，地址 plvdi->item.pszText 比 audit->Truck 的地址少 4 个字节，在赋值语句之后（while 语句上的断点），我认为这是导致 4 个空字符的原因。我只是不确定如何在没有像我发布的那样的解决方法的情况下解决这个问题，为什么会发生这种情况，以及为什么只在 64 位解决方案中。预先感谢您在此问题上提供的任何帮助。

编辑：从我在程序中发现的其他类似问题来看，它似乎与指针有关。在选择向量之后出现的审计类中的所有内容都出现了问题，并且似乎偏离了 4 个字节。在另一堂课中，我发现指向审计的指针之后的一切都失败了，而且我也遇到了一些字符串问题（从技术上讲，它们是指向 char 数组的指针）。当我将带有指针的元素移动到头文件中类的末尾时，一切似乎又正常了。知道字符串、向量或其他类似结构是否具有依赖于 32 位或 64 位系统的指针吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-05T10:33:23.700

在 64 位 Windows 平台上，指针的 sizeof 为 8 字节，而在 32 位配置上为 4。检查您的代码以避免 4 字节大小的假设。

# c# - 在 C# Windows 窗体中，如何将命令发送到文本框？

> ID：11528969
> 
> 赞同：1
> 
> 时间：2012-07-17T18:51:52.640
> 
> 标签：c#, winforms, richtextbox

我正在做一个打字windows程序`C#`，现在终于完成了，但我只需要让用户能够在`Arabic`.

在每次打字开始时，他会在和`Combo Box`之间进行选择，`English``Arabic`

我想要的是，如果他选择`Arabic`，我希望`typingTextBox`打字光标立即切换到屏幕右侧（`RCtrl + RShift`）并将打字语言切换为阿拉伯语（`Alt + RShift`）

我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T18:59:14.487

您可以为ComboBox 上的[SelectedIndexChanged](http://msdn.microsoft.com/en-us/library/system.windows.forms.combobox.selectedindexchanged.aspx)事件编写事件处理程序。在里面使用：

*   [TextBox 的RightToLeft](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.righttoleft.aspx)属性更改光标位置。
*   [InputLanguage.CurrentInputLanguage](http://msdn.microsoft.com/en-us/library/system.windows.forms.inputlanguage.currentinputlanguage.aspx)静态属性，用于更改应用程序的输入语言

# javascript - _.delay() - 杀死计时器

> ID：11528974
> 
> 赞同：22
> 
> 时间：2012-07-17T18:52:03.607
> 
> 标签：javascript, underscore.js

只是好奇是否有办法杀死库`_.delay`函数中的计时器。`underscore.js`它`setTimeout()`在带注释的源中使用，但我无法弄清楚执行此操作的实际方法。

一个例子是：

```
_.delay(this.functionName, 5000) 
```

如果这在 3 秒内没有被调用并且我想停止`functionName`被调用，我可以提前终止计时器吗？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-07-17T18:53:34.707

```
var timerId = _.delay(this.functionName, 5000); //save the timerid in a variable
clearTimeout(timerId); //Kill the timer 
```

# objective-c - 通过 NSStream 在 iOS 设备之间发送后解析数据

> ID：11528977
> 
> 赞同：3
> 
> 时间：2012-07-17T18:52:07.623
> 
> 标签：objective-c, tcp, nsstream

我有一个应用程序设置为使用`NSStream`s 通过 TCP 连接在两个 iOS 设备之间发送数据。

发送的数据由两部分组成：

1.  一个整数，表示即将到来的消息对象的大小
2.  消息对象，一些`NSStrings`和一个`NSData`用 NSKeyedArchiver 编码的对象

问题：

1.  当 NSData 对象大约为 1.5Mb 时，当我尝试对其进行解码时，我得到一个难以理解的存档异常。当读取消息应该在的位置后面的 4 个字节时，那里是一个大数字，而不是下一条消息的大小。
2.  当 NSData 对象大约 80Kb 时，成功解码了两条消息，然后我得到了难以理解的存档异常。

似乎数据在某些时候出现了乱序……尽管 TCP 的全部目的是保持它的有序。所以，一定是我的问题！

## 相关代码

### 服务器

`sendData:`传递已使用 NSKeyedArchiver 编码的 Message 对象。它被要求在短时间内收到 100 条消息

```
// dataQueue is an NSMutableArray
- (void) sendData:(NSData *)data
{
  int size = data.length;
  NSData *msgSize = [NSData dataWithBytes:&size length:sizeof(int)];

  if (self.outputStream.hasSpaceAvailable && (self.dataQueue.count == 0)) {
    [self.dataQueue addObject:data];
    [self.outputStream write:msgSize.bytes maxLength:msgSize.length];
  }
  else {
    [self.dataQueue addObject:msgSize];
    [self.dataQueue addObject:data];
  }
}

//called by NSStreamDelegate method when space is available
- (void) hasSpaceAvailable
{
  if (self.dataQueue.count > 0) {
    NSData *tmp = [self.dataQueue objectAtIndex:0];
    [self.outputStream write:tmp.bytes maxLength:tmp.length];
    [self.dataQueue removeObjectAtIndex:0];
  }
} 
```

### 客户

`streamHasBytes:`收集消息片段并将它们附加到 self.buffer。当 self.buffer 的长度大于 self.buffer 前 4 个字节指示的消息长度时，Message 对象被解析...

```
//Called by NSStreamDelegate method when bytes are available
- (void) streamHasBytes:(NSInputStream *)stream
{
  NSInteger       bytesRead;
  uint8_t         buffer[32768];

  bytesRead= [stream read:buffer maxLength:sizeof(buffer)];

  if (bytesRead == -1 || bytesRead == 0) //...err

  @synchronized(self) { //added to test concurrency
  [self.buffer appendBytes:buffer length:bytesRead];
  }
  [self checkForMessage];
}

- (void) checkForMessage
{
  @synchronized(self) { //added to test concurrency
  int msgLength = *(const int *)self.buffer.bytes;

  if (self.buffer.length < msgLength) return;

  //remove the integer from self.buffer
  [self.buffer replaceBytesInRange:NSMakeRange(0, sizeof(int)) withBytes:NULL length:0]; 

  //copy the actual message from self.buffer
  NSData *msgData = [NSData dataWithBytes:self.buffer.bytes length:msgLength];

  //remove the message from self.buffer
  [self.buffer replaceBytesInRange:NSMakeRange(0, msgLength) withBytes:NULL length:0];

  Message *theMsg = [NSKeyedUnarchiver unarchiveObjectWithData:msgData];
  [self.delegate didReceiveMessage:theMsg];
  }
} 
```

# 编辑：

我现在注意到，在第一个消息中的 NSData 对象大约为 1.5Mb 的情况下，对于大约 1.6Mb 的总消息大小，客户端仅收到大约 1.3Mb ......这将解释难以理解的存档错误。为什么不能交付所有数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T23:27:37.583

事实证明，在某些情况下，我认为正在发送的数据中只有一小部分实际上正在发送。`NSOutputStream`的`write:maxLength:`方法返回实际写入流的字节数。所以`hasSpaceAvailable`上面的方法可以用

```
NSInteger i = [self.outputStream write:tmp.bytes maxLength:tmp.length];
if (i < tmp.length) {
    //send the difference
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-01T19:57:37.213

我正在做几乎相同的事情，但我采用了一些不同的方法。我选择获取归档 dataToSend 的大小，然后将 int 大小的变量转换为 mutableData 块。然后我将 dataToSend 附加到 dataSized 块中，创建一个您可以处理的数据块，并“连接”在一起发送。这样，一切都保持在一起。事情应该保持在一起，他们确实做到了。您必须相应地调整缓冲区。我有大约 400 到 450 字节的数据，所以我有一个 512 字节的缓冲区用于 dataToSend，然后服务器和客户端有 4096（4K）缓冲区来累积发送的数据。但它永远不会超过 1536 字节，4 个玩家以 30 fps 共享数据......

每个玩家呼叫：

```
- (void)sendData:(CAKNodeSpec *)sentSpec {

    NSMutableData *archivedData = [NSMutableData dataWithCapacity:512];
    NSKeyedArchiver *archiver = [[NSKeyedArchiver alloc] initForWritingWithMutableData:archivedData];

    [sentSpec encodeWithCoder:archiver];
    [archiver finishEncoding];

    [self.gameClient outputData:archivedData];
// gameClient is custom NSStreamDelegate with IN/OUT Streams
} 
```

在 gameClient 和 gameConnect 中为 gameServer

```
- (void)outputData:(NSMutableData *)dataToSend {
    if (self.outputBuffer != nil) {

    unsigned int size = (unsigned int)dataToSend.length;
// maintains 32-bit/64-bit architecture compatibility & silence warnings

    NSMutableData *dataSized = [NSMutableData dataWithBytes:&size length:sizeof(unsigned int)];

    [dataSized appendBytes:dataToSend.bytes length:size];

    [self.outputBuffer appendData:dataSized];

    [self startOutput];
    }
}

- (void)startOutput {

    NSInteger actuallyWritten = [self.outputStream write:self.outputBuffer.bytes maxLength:self.outputBuffer.length];
        if (actuallyWritten > 0) {
        [self.outputBuffer replaceBytesInRange:NSMakeRange(0, (NSUInteger) actuallyWritten) withBytes:NULL length:0];
    } else {
        [self closeStreams];
    }
} 
```

遵循经典的 switch-case-model

```
- (void)stream:(NSStream *)aStream handleEvent:(NSStreamEvent)streamEvent {
assert(aStream == self.inputStream || aStream == self.outputStream);
switch(streamEvent) {
    case NSStreamEventOpenCompleted: {
        if (aStream == self.inputStream) {
            self.inputBuffer = [[NSMutableData alloc] init];
            self.dataQueue = [[NSMutableArray alloc] init];
        } else {
            self.outputBuffer = [[NSMutableData alloc] init];
        }
    } break;
    case NSStreamEventHasSpaceAvailable: {
        if ([self.outputBuffer length] != 0) {
            [self startOutput];
        }
    } break;
    case NSStreamEventHasBytesAvailable: {
        uint8_t buffer[4096];
        NSInteger actuallyRead = [self.inputStream read:buffer maxLength:4096];
        if (actuallyRead > 0) {
            [self.inputBuffer appendBytes:buffer length:(NSUInteger)actuallyRead];

            NSLog(@"Read: %ld", (long)actuallyRead);

            [self chopaChunk];
            NSMutableData *specData;

            while ((specData = [self.dataQueue shift])) {
                [self.delegate handleData:specData]; // unarchives
            }
        } else {
            NSLog(@"empty buffer!");
        }
    } break;
    case NSStreamEventErrorOccurred:
    case NSStreamEventEndEncountered: {
        [self closeStreams];
    } break;
    default:
    break;
    }
} 
```

这是真正的差异区域：

```
- (void)chopaChunk {

    unsigned int dataSize = *(const unsigned int *)self.inputBuffer.bytes;

    while (self.inputBuffer.length >= (sizeof(unsigned int) + dataSize)) {

    //remove the integer from self.inputBuffer
    [self.inputBuffer replaceBytesInRange:NSMakeRange(0, sizeof(unsigned int)) withBytes:NULL length:0];

    //copy the actual message from self.inputBuffer
    NSMutableData *specData = [NSMutableData dataWithBytes:self.inputBuffer.bytes length:dataSize];

    [self.dataQueue addObject:specData];

    //remove the message from self.inputBuffer
    [self.inputBuffer replaceBytesInRange:NSMakeRange(0, dataSize) withBytes:NULL length:0];

    if (self.inputBuffer.length > 0) {
        dataSize = *(const unsigned int *)self.inputBuffer.bytes;
// I just keep going adding, I guess you would add multiple 80K pieces here
        }
    }

} 
```

按照您的指示，我选择检查 inputBuffer 是否 >= dataSize + (sizeof(unsigned int))，就像香肠制造商一样，我们只需在它们进来时将其拧断！:D

流程是数据到 outputBuffer 到 outputStream <- 发送 -> 到 inputStream 到 inputBuffer 返回数据。

我认为，如果您使用连接的数据而不是尝试发送两个不同的对象，那么您会比试图弄清楚谁是谁以及何时获得什么感觉要好...和> =而不是<，只需添加 mutableData 块您的数据队列...您的用例可能会有所不同...

# google-drive-api - 在 Google Drive 上显示 SVG 查看器的问题

> ID：11528978
> 
> 赞同：0
> 
> 时间：2012-07-17T18:52:12.233
> 
> 标签：google-drive-api

我正在使用 Google Drive API（太棒了！）来上传 SVG 内容。我遇到的主要问题是，当我在 Google Drive 中打开文件时，SVG 上的标签显示不正确。它们看起来比应有的大得多。

下载文件并在 Chrome 中打开看起来不错。我相信在 Gmail 预览版中也会出现同样的问题。

这是一个示例 SVG 文件： [https ://docs.google.com/open?id=0B16Q4tqg5T6QcDRzTE1LSmxMTE0](https://docs.google.com/open?id=0B16Q4tqg5T6QcDRzTE1LSmxMTE0)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T20:59:44.513

问题似乎与查看器有关，而不是由于上传机制。您是否尝试过从云端硬盘 UI 上传相同的文件？你有同样的渲染问题吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-06-26T21:44:23.247

当谷歌驱动器渲染它时，预览仍然行为不端并且完全乱码。如前所述，使用 Chrome 在本地下载和查看是可以的。（我也喜欢解决这个问题）。

# ios - 尽管处于静音模式，但电影的音频播放？

> ID：11528986
> 
> 赞同：0
> 
> 时间：2012-07-17T18:52:55.900
> 
> 标签：ios, mpmovieplayercontroller, avaudioplayer, avaudiosession

对不起我的问题，但我已经实现了一个介绍视频，尽管我的 iPad 有硬件静音开关，但音频仍在播放。我还在我的应用程序中使用 AVAudioplayer 来播放简短的声音样本。在这个类中，它是我设置“AVAudioSessionCategory”的唯一区域。但是仅对于所有音频播放，都听不到任何声音。它只是为了我的介绍视频。

任何帮助如何解决“音频错误”，使电影播放器​​保持沉默？谢谢

这是我的音频课：

```
- (id)initWithSoundfileName:(NSString*) file 
{
    if ((self = [super init]))
    {
        NSString* filename =       [file stringByDeletingPathExtension];
        NSString* fileextension =  [file pathExtension];

        // get file path from bundle
        NSString *soundFilePath = [[NSBundle mainBundle] pathForResource: filename ofType: fileextension];
        NSLog(@"AudioPlayer init: %@", soundFilePath);

        NSURL* fileurl = [[NSURL alloc] initFileURLWithPath:soundFilePath];
        NSError* error = nil;

        AVAudioPlayer* audioplayer = [[AVAudioPlayer alloc] initWithContentsOfURL:fileurl error:&error ];
        if (error) { NSLog(@"Error creating AVAudioPlayer %@", [error description]);}

        // set audio policy
        [[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryAmbient error:NULL];

        self.player =  audioplayer;
        [self.player prepareToPlay];
        [self.player setDelegate:self];
    }
    return self;

}
-(void) play{
    [self.player play];
} 
```

这是我的视频播放方法：

```
- (void)playIntroVideo
{    
    NSString *movpath = [[NSBundle mainBundle] pathForResource:@"mymovie" ofType:@"mp4"];

    NSURL *fileURL    =   [NSURL fileURLWithPath:movpath];  
    self.moviePlayerController = [[MPMoviePlayerController alloc] initWithContentURL:fileURL]; 
    self.moviePlayerController.fullscreen = YES;
    self.moviePlayerController.scalingMode = MPMovieScalingModeAspectFit;
    self.moviePlayerController.controlStyle = MPMovieControlStyleNone;
    self.moviePlayerController.movieSourceType = MPMovieSourceTypeFile;

    self.moviePlayerController.useApplicationAudioSession = NO;     
    [self.moviePlayerController.view setFrame: self.view.bounds];   

    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(moviePlayBackComplete:)  
                                                 name:MPMoviePlayerPlaybackDidFinishNotification  
                                               object:self.moviePlayerController];  

    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(moviePlaybackStateChanged:)  
                                                 name:MPMoviePlayerPlaybackStateDidChangeNotification  
                                               object:self.moviePlayerController];  

    [self.view addSubview:self.moviePlayerController.view];

    [self.moviePlayerController prepareToPlay];
    [self.moviePlayerController play];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T21:12:45.937

就像@Till 提到的：当我将`MoviePlayerController`属性更改为 时`useApplicationAudioSession=TRUE`，它解决了我的问题。音频播放无声。

# entity-framework - 使用 EF Code First 从数据库中选择特定列

> ID：11528988
> 
> 赞同：12
> 
> 时间：2012-07-17T18:53:07.353
> 
> 标签：entity-framework, linq-to-sql, ef-code-first

我们有一个客户非常大的表，有**500 多**列（我知道有人这样做！）

其中许多列实际上**是其他表的外键**。

我们还需要**预先加载**一些相关的表。

在 Linq to SQL 或 Dynamic Linq 中是否有任何方法可以指定要从数据库中检索哪些列？我正在寻找一个实际上对生成的 SQL 语句有这种影响的 linq 语句：

```
SELECT Id, Name FROM Book 
```

当我们运行 EF 生成的 reguar 查询时，SQL Server 会抛出一个错误，提示您已达到查询中可以选择的最大列数！！！

任何帮助深表感谢！

* * *

是的，正是这种情况，该表有 500 列并且是自引用的，我们的工具会自动预先加载第一级关系，这达到了 SQL 对可查询列数的限制。

我希望我可以设置为仅加载相关实体的有限列，例如 Id 和 Name（在 UI 中用于向用户查看记录）

我猜另一个选项是控制应该急切加载哪些 FK 列。但是，对于具有您可能不想一直加载的二进制或 ntext 列的表来说，这仍然是个问题。

有没有办法将多个模型（实体）挂钩到 Code First 中的同一个表？我们尝试过这样做，我认为努力失败了。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-17T19:00:36.097

是的，您可以使用投影仅返回列的子集：

```
var result = from x in context.LargeTable
             select new { x.Id, x.Name }; 
```

问题：投影和急切加载不能一起工作。一旦您开始使用投影或自定义连接，您正在更改查询的形状并且您无法使用`Include`（EF 将忽略它）。在这种情况下，唯一的方法是在投影结果集中手动包含关系：

```
var result = from x in context.LargeTable
             select new {
                 Id = x.Id,
                 Name = x.Name,
                 // You can filter or project relations as well
                 RelatedEnitites = x.SomeRelation.Where(...) 
             }; 
```

您还可以投影到特定类型，但不能映射特定类型（例如，您不能`LargeTable`从我的示例中投影到实体）。映射实体的投影只能在 Linq-to-objects 中的物化数据上完成。

编辑：

可能对 EF 的工作方式存在一些误解。EF 在实体之上工作 - 实体是您所映射的。如果您将 500 列映射到实体，EF 只需使用您定义的实体。这意味着查询加载实体并持久保存实体。

为什么它会这样工作？实体被认为是原子数据结构，它的数据只能加载和跟踪一次——这是将更改正确持久化回数据库的关键特性。这并不意味着您不应该只加载列的子集，但您应该了解加载列的子集并不能定义您的原始实体 - 它被视为实体中数据的任意视图。此视图不会被跟踪，并且无法在没有额外工作的情况下持久保存回数据库（仅仅是因为 EF 不保存有关投影来源的任何信息）。

EF 还对映射实体的能力施加了一些额外的限制

*   每个表通常只能映射一次。为什么？再次因为将表多次映射到不同实体可能会破坏正确持久化这些实体的能力 - 例如，如果任何非键列被映射两次并且您加载映射到同一记录的两个实体的实例，您将在期间使用哪个映射值保存更改？
*   有两个例外允许您多次映射表
    *   每个层次结构继承表 - 这是一个映射，其中表可以包含来自继承层次结构中定义的多个实体类型的记录。映射到层次结构中基本实体的列必须由所有实体共享。每个派生实体类型都可以将其自己的列映射到其特定属性（其他实体类型的这些列始终为空）。不能在多个实体之间共享派生属性的列。还必须有一个称为鉴别器的附加列，告诉 EF 记录中存储了哪种实体类型 - 此列不能映射为属性，因为它已经映射为类型鉴别器。
    *   表拆分 - 这是单表映射限制的直接解决方案。它允许您将表拆分为具有一些约束的多个实体：
        *   实体之间必须存在一对一的关系。您有一个用于加载核心数据的中心实体，并且所有其他实体都可以通过该实体的导航属性进行访问。急切加载、延迟加载和显式加载正常工作。
        *   关系是真实的 1-1，因此两个部分或关系都必须始终存在。
        *   实体不得共享除键之外的任何属性 - 此约束将解决初始问题，因为每个可修改属性仅映射一次
        *   拆分表中的每个实体都必须具有映射的键属性
        *   插入需要填充整个对象图，因为其他实体可以包含映射的所需列

Linq-to-Sql 还包含将列标记为延迟加载的功能，但此功能目前在 EF 中不可用 - 您可以[为该功能投票](http://data.uservoice.com/forums/72025-entity-framework-feature-suggestions/suggestions/1051513-lazy-loading-at-property-column-level)。

它导致您的优化选项

*   使用投影获取实体的只读“视图”
    *   您可以在 Linq 查询中执行此操作，如我在此答案的前一部分中所示
    *   您可以创建数据库视图并将其映射为新的“实体”
    *   在 EDMX 中，您还可以使用定义查询或查询视图在映射中封装 SQL 或 ESQL 投影
*   使用表拆分
    *   EDMX 允许您毫无问题地将表拆分为多个实体
    *   [代码首先允许您拆分表](https://stackoverflow.com/questions/5390172/how-to-map-table-splitting-in-ef-code-first)，但是当您将表拆分为两个以上的实体时会出现一些问题（我认为它要求每个实体类型都具有从拆分表到所有其他实体类型的导航属性 - 这使得它很难使用）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-19T18:02:46.177

创建查询所需列数的存储过程，然后从代码中调用存储过程。

# mysql - 当我需要从另一个表中知道外键的值时，如何将数据插入到表中？

> ID：11528991
> 
> 赞同：0
> 
> 时间：2012-07-17T18:53:26.697
> 
> 标签：mysql, database, database-design

我有两张桌子：

`Customer`具有自动增量字段`ID`和主键和

`address`带有`customer_ID`作为外键的字段。

我有一个表格，要求提供所有客户信息及其地址（可以超过 1 个）

我运行以下两个查询来更新数据库，但是我目前正在`Customer_ID`手动输入值以对其进行测试。

```
mysql_query("INSERT INTO customer(First_Name, Surname, Company_Name, Telephone, Alt_Telephone)VALUES('$fName', '$lName', '$cName', '$tel', '$altTel')") ;
mysql_query("INSERT INTO address(line_1, line2, town, postcode, customer_ID)VALUES('$line1', '$line2', '$town', '$post_code', '2')") ; 
```

该`customer_ID`字段应与`ID`客户表中的当前字段相同，如何确保在填写地址表时自动执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T19:01:34.303

### 使用 PHP

解决您的问题的最简单方法是在您第一次调用（将数据插入您的表*customer*[`mysql_insert_id`](http://se2.php.net/manual/en/function.mysql-insert-id.php) ）之后调用您的 php 代码。`mysql_query`

 *此函数将返回最后插入的 id，但您必须确保*customer*的 id是自动递增的主键。

返回的值`mysql_insert_id`是给定连接/会话的本地值，即使在您完成后另一个连接插入了一条记录，您也会得到您插入的 id。

* * *

### 使用 MySQL

您可以使用下面的 SQL 函数`LAST_INSERT_ID()`，只需确保之前运行的 sql-query 是插入到*customer*中（以及检查 id 确实是一个 key 并且*auto-incremented*）。

```
-- first insert into `customer`

INSERT INTO address
  address(line_1, line2, town, postcode, customer_ID)
VALUES
  ('$line1', '$line2', '$town', '$post_code', LAST_INSERT_ID()); 
```

这里与*php-version*相同，`LAST_INSERT_ID()`将检索您最后插入的 ID。

* * *

您还可以使用可以描述为*SELECT INTO*的 SQL 功能，请参见以下代码段：

```
INSERT INTO address
 address(line_1, line2, town, postcode, customer_ID)
SELECT
  '$line1', '$line2', '$town', '$post_code', customer.id
FROM customer
WHERE <some_constraint> 
```

* * *

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T19:00:44.973

您可以 (1)`mysql_insert_id()`在 php 中使用，或 (2)`LAST_INSERT_ID()`直接在您的 sql 中使用

代码示例1：

```
mysql_query("INSERT INTO customer(First_Name, Surname, Company_Name, Telephone, Alt_Telephone)
    VALUES('$fName', '$lName', '$cName', '$tel', '$altTel')") ;
$customer_id = mysql_insert_id();
mysql_query("INSERT INTO address(line_1, line2, town, postcode, customer_ID) 
    VALUES('$line1', '$line2', '$town', '$post_code', {$customer_id})") ; 
```

代码示例2：

```
mysql_query("INSERT INTO customer(First_Name, Surname, Company_Name, Telephone, Alt_Telephone)
    VALUES('$fName', '$lName', '$cName', '$tel', '$altTel')") ;
mysql_query("INSERT INTO address(line_1, line2, town, postcode, customer_ID) 
    VALUES('$line1', '$line2', '$town', '$post_code', LAST_INSERT_ID())") ; 
```*

# java - 如何为 f:selectItems 中的枚举创建和使用通用 bean？

> ID：11528998
> 
> 赞同：3
> 
> 时间：2012-07-17T18:53:58.957
> 
> 标签：java, jsf, generics, enums, managed-bean

我有这个签名的通用类：

```
public abstract class EnumListBean<E extends Enum<E>> {

    public List<E> getEnumList() {
        //implementation details
    }

} 
```

目前，我必须定义一个空子类才能访问具体泛型参数的 enumList 属性：

```
@ManagedBean
@ApplicationScoped
public class ItemRarityBean  extends EnumListBean<Item.Rarity>{
} 
```

这使得访问该属性成为可能，例如：

```
<f:selectItems value="#{itemRarityBean.enumList}" var="rarity"
            itemLabel="#{rarity.readableName}" itemValue="#{rarity}" /> 
```

我想知道是否真的必须声明一个派生 bean 但不能直接将泛型类作为 bean 访问：

```
<f:selectItems value="#{enumListBean<Item.Rarity>.enumList}" var="rarity"
                itemLabel="#{rarity.readableName}" itemValue="#{rarity}" /> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T19:32:28.010

您不能在 EL 中使用泛型。EL 是一种基于反射的运行时语言。你知道，泛型只在编译时可用，在运行时不可用。

对于您的特定目的，使用[OmniFaces](http://omnifaces.org) [`<o:importConstants>`](http://showcase.omnifaces.org/taghandlers/importConstants)可能更容易。

```
<o:importConstants type="com.example.Item$Rarity" var="Rarity" />
...
<h:selectOneMenu>
    <f:selectItems value="#{Rarity}" />
</h:selectOneMenu> 
```

*（该`var`属性不是强制性的，但您需要引用它，因为`#{Item$Rarity}`它不完全可读；如果您的`Rarity`枚举是独立枚举而不是内部枚举，那么您可以使用`type="com.example.Rarity"`）*

它在设计上被视为 a `Map<String, Rarity>`，而不是 a`List<Rarity>`左右。因此，如果您打算访问 的`var`属性中的各个项目`<f:selectItems>`，以便您可以访问特定的枚举方法，那么您需要显式迭代`Map#values()`（这需要 EL 2.2 支持）。

```
<h:selectOneMenu>
    <f:selectItems value="#{Rarity.values()}" var="rarity" itemValue="#{rarity}" itemLabel="#{rarity.readableName}" />
</h:selectOneMenu> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T18:59:43.387

是的，你必须。因为实例化抽象类没有意义。