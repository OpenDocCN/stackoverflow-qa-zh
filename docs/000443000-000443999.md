# StackOverflow 问答 000443000-000443999

# unit-testing - 如何在不确定的情况下进行单元测试？

> ID：443000
> 
> 赞同：16
> 
> 时间：2009-01-14T13:46:17.500
> 
> 标签：unit-testing, math, statistics

我们有几种不同的优化算法，每次运行都会产生不同的结果。例如，优化的目标可能是找到函数的最小值，其中 0 是全局最小值。优化运行返回如下数据：

```
[0.1, 0.1321, 0.0921, 0.012, 0.4] 
```

这非常接近全球最小值，所以这没关系。我们的第一种方法是只选择一个阈值，如果结果太高，则让单元测试失败。不幸的是，这根本不起作用：结果似乎具有高斯分布，因此，尽管不太可能，但有时即使算法仍然很好而我们运气不好，测试也会失败。

那么，我该如何正确测试呢？我认为这里需要相当多的统计数据。同样重要的是测试仍然很快，只是让测试运行几百次然后取平均值会太慢。

以下是一些进一步的说明：

*   例如，我有一个算法可以将一个圆拟合到一组点中。它非常快，但并不总是产生相同的结果。我想写一个单元测试来保证在大多数情况下它已经足够好了。

*   不幸的是，我无法为随机数生成器选择固定种子，因为我不想测试算法是否产生与以前完全相同的结果，但我想测试类似“90% 确定我得到 0.1 或更好的”。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-14T14:19:05.310

听起来您的优化器需要两种测试：

1.  测试算法的整体有效性
2.  测试算法实现的完整性

由于该算法涉及随机化，因此 (1) 难以进行单元测试。随机过程的任何测试都会在一定比例的时间内失败。您需要了解一些统计数据才能了解失败的频率。有一些方法可以在测试的严格程度和失败的频率之间进行权衡。

但是有一些方法可以为 (2) 编写单元测试。例如，您可以在运行单元测试之前将种子重置为特定值。那么输出是确定性的。这不允许您评估算法的平均有效性，但这是针对 (1) 的。这样的测试将充当绊脚石：如果有人在维护期间将错误引入代码中，则确定性单元测试可能会捕获该错误。

可能还有其他可以进行单元测试的东西。例如，也许无论随机部分发生什么，您的算法都可以保证返回某个范围内的值。也许一些价值应该总是积极的，等等。

**更新**：我在 Beautiful Testing 一书中写了一个关于这个问题的章节。请参阅第 10 章：[测试随机数生成器](http://www.johndcook.com/Beautiful_Testing_ch10.pdf)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-14T14:02:34.627

单元测试不应该有未知的通过/失败状态。如果您的算法在多次使用相同的输入运行时返回不同的值，那么您可能在算法中做了一些奇怪的事情。

我将采用 5 种优化算法中的每一种并对其进行测试，以确保在给定一组输入 x 的情况下，您每次都能获得优化的 y 值。

**编辑**：要解决系统的随机组件，您可以引入传递种子以供使用的随机数生成器的能力，或者您可以利用模拟库（ala RhinoMocks）强制它在以下情况下使用特定数字RNG 被要求提供一个随机数。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-14T14:12:31.503

您的算法可能有一个随机分量。把它控制住。

你可以

1.  允许调用者选择随机数生成器的种子。然后在测试中使用硬编码的种子。
2.  让调用者提供一个随机数生成器。然后在测试中使用假随机数生成器。

第二个选项可能是最好的，因为这将使您更容易推断算法的正确结果是什么。

在对算法进行单元测试时，您要验证的是您是否正确实现了算法。不是算法是否做了它应该做的事情。单元测试不应将被测代码视为黑盒。

您可能希望有一个单独的“性能”测试来比较不同算法的执行方式（以及它们是否真的有效），但您的单元测试实际上是为了测试您的算法*实现*。

例如，在实现 Foo-Bar-Baz 优化算法 (TM) 时，您可能不小心写成了 x:=x/2 而不是 x:=x/3。这可能意味着该算法运行速度较慢，但​​仍会找到相同的算法。您将需要白盒测试来发现这样的错误。

**编辑：**

> 不幸的是，我无法为随机数生成器选择固定种子，因为我不想测试算法是否产生与以前完全相同的结果，但我想测试类似“90% 确定我得到 0.1 或更好的”。

我看不到任何方法可以进行自动验证和随机的测试。如果您想有任何机会将真实错误与统计噪声区分开来，尤其如此。

如果您想测试“有 90% 的把握，我会得到 0.1 或更好的结果”，我会建议如下：

```
double expectedResult = ...;
double resultMargin = 0.1;
int successes = 0;
for(int i=0;i<100;i++){
  int randomSeed = i;
  double result = optimizer.Optimize(randomSeed);
  if(Math.Abs(result, expectedResult)<resultMargin)
    successes++; 
}
Assert.GreaterThan(90, successes); 
```

（请注意，此测试是确定性的）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-14T13:56:23.780

让测试运行，如果其中任何一个失败，*只重新运行这些测试*50 次，看看它们失败的时间比例。（当然，以自动化的方式。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-14T14:27:13.500

我建议，与其针对产生高斯分布的代码运行*测试*，不如创建一个多次运行该方法的蒙特卡罗类型算法，然后使用适当的分布模型*测试结果的整体分布。*例如，如果它是一个平均值，那么您*将*能够针对一个固定阈值进行测试。如果它更复杂，您将需要创建对适当分布建模的代码（例如，值 < x 是否占我结果的 y%）。

请记住，您不是在测试数字生成器，而是在测试生成值的单元！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-15T07:36:13.160

感谢所有答案，我现在正在这样做：

1.  运行测试 5 次并取中值结果。
2.  如果中值结果低于某个阈值，则测试成功。
3.  如果阈值失败，请再次测试，直到达到阈值（测试成功）或直到我完成了如此多的迭代（大约 100 次左右），我可以非常确定中位数不再低于阈值。

这样，每当一个测试看起来要失败时，它就会经常重新计算，直到它非常确定它确实失败了。

这似乎可行，但我不太满意，因为我只测试中值结果。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-14T14:27:58.930

jUnit 和 NUnit 都可以断言具有容差/增量值的浮点数据类型。即您测试输出是否是正确的值，给出或取一些小数。在您的情况下，您要检查的正确值是 0，如果您希望给定输出中的所有值都通过（或 0.20，公差为 +/-0.20），则公差为 0.5。

由于结果的随机性，您可能需要对算法的某些部分进行单元测试，以确保它确实完成了预期的工作。

# sql - 使用 SQL 2008 空间函数，如何构造一个 LINESTRING 表示两个（或多个）POINT 实例之间的线？

> ID：443002
> 
> 赞同：5
> 
> 时间：2009-01-14T13:46:58.620
> 
> 标签：sql, sql-server, sql-server-2008, geospatial, spatial

定义几个点如下：

```
declare @p1 geography, @p2 geography
set @p1 = 'POINT(1 2)'
set @p2 = 'POINT(6 8)' 
```

现在我想获得这两点之间的最短线。我可以使用什么功能来获取这条线？（即，它应该输出一个 LINESTRING(1 2, 6 8) 或 LINESTRING(6 8, 1 2)）

我知道我可以通过将点格式化为 WKT，进行一些字符串操作，然后将其解析回来来做到这一点，但这似乎很荒谬。当然有一些方法可以直接从一系列点构造线串？

（对于“几何”类型，我可以使用@p2.STUnion(@p1).STConvexHull()，但是对于地理类型没有STConvexHull()。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-01T13:32:08.600

在 T-SQL 中有两种方法可以做到这一点：

```
declare @p1 geography = 'POINT(1 2)', @p2 geography = 'POINT(6 8)';

-- using geometry
SELECT geography::Parse(geometry::Parse(@p2.STUnion(@p1).ToString()).STConvexHull().ToString())

-- using lat, long methods
SELECT geography::Parse('LINESTRING('+str(@p1.Long)+' '+str(@p1.Lat)+','+str(@p2.Long)+' '+str(@p2.Lat)+')') 
```

# operator-overloading - 删除重载，递归溢出

> ID：443009
> 
> 赞同：2
> 
> 时间：2009-01-14T13:49:59.397
> 
> 标签：operator-overloading, stack-overflow

嘿伙计们，我写了一个快速测试。我想 delete 调用 deleteMe 然后删除自己。这样做的目的是让我可以正常删除由 lib 分配的 obj。（我不希望由于 crt 或 w/e 导致任何崩溃）。

删除这个我得到一个stackoverflow，没有它msvc说我泄露了4个字节。当我不调用测试时，我泄漏 0。我如何删除 w/oa 递归问题？-edit- 使这一点更清楚。由于crt，我希望LIB调用delete（因此deleteMe）而不是程序

```
class B
{
public:
    virtual void deleteMe()=0;
    static void operator delete (void* p) { ((B*)p)->deleteMe(); }
};

class D : public B
{
public:
    void deleteMe()      {
        delete this;
    }
};

int test()
{
    B *p = new D;
    delete p;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T13:55:20.273

您不应该覆盖删除。尤其是对于最终调用删除的函数。您需要执行的任何内存释放（并且在本示例中您不需要执行任何操作）都应在析构函数中完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T14:10:44.127

递归是由于`deleteMe`调用`delete`，它调用`operator delete`了`deleteMe`再次调用的 B。可以重载`operator delete`（尽管您通常`operator new`也会重载），尤其是在处理可能是您的情况的“外来”对象时，但是您必须反过来从 custom 中调用实际的清理例程`delete`。

在一般情况下，重载`operator delete`必须匹配`operator new`. 在你的情况下：

```
B *p = new D; 
```

这里`p`是用全局分配的`new`，所以它必须用全局释放`delete`。所以：

```
class D : public B
{
public:
    void deleteMe()      {
        ::delete this;
    }
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T14:08:21.183

您最好只使用您的客户应该调用的 Destroy() 方法......这将保护您的库免受堆中的差异。

# c# - 我在哪里可以找到 Java 到 C# 的转换器？

> ID：443010
> 
> 赞同：44
> 
> 时间：2009-01-14T13:50:19.143
> 
> 标签：c#, java

我需要将 Java 1.5se 应用程序转换为 C# 2.0。

有谁知道这样做的工具（最好是免费/开源）？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-01-14T13:54:50.027

即使有这样的工具，我强烈建议您手动进行转换。自动转换器通常会忠实地重现代码，但会忽略惯用语——因为它们真的很难正确。

此外，.NET 和 Java 中泛型之间的差异可能导致两个代码库中的一些非常不同的决定。

真的，你最好用手做。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2010-11-02T13:45:14.317

一个好用的工具叫做 Sharpen，它是开源的。

该工具已由 Xamarin 团队分叉和更新，他们使用它将 Android API 转换为 C#。他们的副本可以在这里找到：

*   [GitHub 上的 XobotOS/锐化（Mono 的 Xamarin 团队）](https://github.com/xamarin/XobotOS/tree/master/sharpen)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-01-14T13:57:36.027

[Java 语言转换助手](http://msdn.microsoft.com/en-us/vstudio/aa718346.aspx)。可选安装（至少）Visual Studio 2005 标准版。

选择文件/打开/转换/Java 语言转换助手。

记得之后手动检查代码。会有很多问题。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-01-15T20:08:28.443

[ikvm](http://www.ikvm.net/)在 .NET 中公开 java 类。它不是转换器，但根据我的经验，我会向任何从 java 过渡到 .NET 的人推荐它

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2010-11-02T13:15:47.190

虽然这两种语言的语法看起来很相似，但语义却大不相同。提到几个地方两种语言误入歧途

*   泛型，Java 将所有内容编译为对象，C# 保留泛型类型
*   异常，Java 有检查异常，C# 没有
*   匿名类和内部类，Java 有匿名类和嵌套类，C# 两者都没有。相反，C# 有委托和事件。因此，编程模型非常不同
*   委托，C# 具有函数指针的概念，这导致了不同的编程方式。
*   事件，C# 具有事件和组件的概念，这导致了不同的编程方式。
*   API，撇开所有语义差异不谈，两种语言都有巨大的 API，它们都没有经过简单的转换。

换句话说，您将无法自动进行此类转换。如果更改为 C# 的原因是为了能够将您的代码转换为 .exe 文件，那么 Java 市场上也有各种选择。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-01-29T16:24:35.133

现在，我正在测试有形解决方案（这不是免费的）

[有形资源转换器](http://www.tangiblesoftwaresolutions.com/)

它添加了一个类助手。但在它外面，结果看起来不错。

爪哇：（原创）

```
public class PackVariableArrays {

private ClassError myerror=new ClassError();

public VariableArrays unpack(String txt) {
    VariableArrays pc = new VariableArrays();
    Variable lc;
    txt=txt.replace("\r\n","\n");
    setMyerror(new ClassError());
    if (txt==null) {
        lc=new Variable();
        lc.name="ERV-5: Empty values";
        pc.addItem(lc);

        return pc;
    }
    String[] linecode = txt.split(ClassUtil.SEPARATOR2);
    int blen = 0;
    int tmpint = 0;

    int numelement = 9999; 
```

C#（转换）

```
public class PackVariableArrays {

    private ClassError myerror =new ClassError();

    public virtual VariableArrays unpack(string txt) {
        VariableArrays pc = new VariableArrays();
        Variable lc;
        txt=txt.Replace("\r\n","\n");
        Myerror = new ClassError();
        if (txt==null) {
            lc=new Variable();
            lc.name="ERV-5: Empty values";
            pc.addItem(lc);

            return pc;
        }
        string[] linecode = StringHelperClass.StringSplit(txt, ClassUtil.SEPARATOR2, true);
        int blen = 0;
        int tmpint = 0;

        int numelement = 9999; 
```

这是一个简单的案例，但效果很好。然而，正如我之前所说，它使用了一个类助手（StringHelperClass.StringSplit），这很好，但它是不需要的。在它之外，结果代码非常清晰。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-14T14:00:50.637

微软曾经有自己的Java to C# Converter - [Microsoft Java Language Conversion Assistant 3.0](http://msdn.microsoft.com/en-us/vs2005/aa718346.aspx)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-10-03T23:18:31.363

你试过[XMLVM](http://www.xmlvm.org)吗？它有一个自动转换为 C# 的选项，如下所示：

```
xmlvm --in=myjar.jar --out=output_dir --target=csharp 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-12-15T18:01:30.477

最近 Xamarin 使用锐化将 android 移植到单声道。看看[这个](https://github.com/xamarin/XobotOS)链接。

# c# - 我可以随我的产品重新分发 Microsoft T4 引擎吗？

> ID：443027
> 
> 赞同：6
> 
> 时间：2009-01-14T13:55:42.770
> 
> 标签：c#, t4

我正在动态生成代码，目前使用 String.Format 和嵌入占位符 - 但重新格式化 C# 代码以用作模板是一种痛苦，我认为使用 T4 模板会更好。

但是，代码生成将在正在运行的系统上进行，因此我需要知道我可以安全合法地将 Microsoft T4 引擎与我的产品一起重新分发。

还有人这样做吗？或者知道（法律）答案？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-12T09:42:40.177

看起来可能很快就会有另一种选择。

昨天，Miguel de Icaza 发布了关于 MonoDevelop 中 T4 集成的文章，所以我期待现在任何时候都会有一个等效的单声道 T4 工具集。

见：[http ://tirania.org/blog/archive/2009/Mar-10.html](http://tirania.org/blog/archive/2009/Mar-10.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-14T14:32:03.617

您可以将 T4​​ 作为[DSLToolsRedist](http://www.microsoft.com/downloads/details.aspx?familyid=693EE22D-4BB1-450D-835C-59EEBCB9F2AE&displaylang=en)的一部分重新分发，但是，它需要已安装 Visual Studio 2005 标准版或更高版本。我不相信 T4 目前可以在没有 Visual Studio 的情况下合法地重新分发。[Visual Studio 2010](http://blogs.msdn.com/garethj/archive/2008/11/11/dsl-2010-feature-dives-t4-preprocessing-rationale.aspx)将直接支持您描述的方案

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-15T10:10:05.173

我有答案，不幸的是，正如 Oleg 所建议的那样。（顺便说一句，在 T4 上做得很好）。您此时不能重新分发 T4 - 它是 VS 的一部分。在 VS2010 中，可以预编译 T4 模板，然后使用您的应用程序重新分发这些预编译的模板，而无需 T4 依赖来运行它们。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-01-15T22:47:50.240

为清楚起见，官方的回答是您不能将 Microsoft T4 引擎作为独立于 Visual Studio 的部分进行分发。

但是，从 Visual Studio 2010 开始，您可以使用和重新分发不依赖于 Visual Studio 的预编译模板。

您还可以在安装了 Visual Studio 的计算机上在 Visual Studio 之外使用 T4。

您还可以免费许可和重新分发 Visual Studio 隔离 Shell，并将其用作工具的主机 - 它包括 T4。

从 Visual Studio 2010 SP1 开始，您可以通过 VS 安装目录中 buildserver.txt 中的许可证将 T4 复制到您的构建机器。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-15T10:21:24.277

我有自己的模板代码生成系统，在一个单独的 appdomain 中编译代码，从 VS2008 出来之前开始。

如果您有兴趣，请发表评论，我将发布代码的网址。

使用我的模板引擎的代码在[这里](http://svn.vkarlsen.no/public/listing.php?repname=LVK&path=/LVK_3_5/trunk/LVK.Text.Templating/)，您可以使用 Web 浏览器浏览它或将[Subversion](http://subversion.tigris.org/)客户端指向它。*请注意，以此处开头的链接确实在单词之后停止，但服务器端 WMD 渲染器会将链接泄漏到以下文本中。*

请注意，如果您只是复制该命名空间中的单个文件，那么它不会自行编译，它需要 LVK.Delegates 和 LVK.Scripting 中的一些东西，命名空间从上面的链接上升了几个级别。如果您不想吸收整个库，则需要一次提取它抱怨的部分，直到它编译为止。

~~[在同一存储库中的/LVK_3_5/trunk/Binaries/Debug/LVK](http://svn.vkarlsen.no/public/listing.php?repname=Binaries&path=/LVK_3_5/)中还有一个二进制版本的库。如果您下载它，只需添加对它的引用并检查类[LVK.Text.Templates.TextTemplate 即可](http://svn.vkarlsen.no/public/filedetails.php?repname=LVK&path=/LVK_3_5/trunk/LVK.Text.Templating/TextTemplate.cs)。~~

不幸的是，目前我的图书馆没有任何示例。

基本上，要使用模板：

```
TextTemplate tt = new TextTemplate();
tt.Source = "... code here, check example file above ...";
tt.Compile();
String output = tt.Generate(singleObjectParameter); 
```

在模板内部，基本上所有代码都插入到一个方法中（这意味着它在能够轻松添加方法方面不如 T4，但您可以使用匿名方法），您将可以访问数据对象作为名为 data 的参数传递给它。

所以只输出传递参数的内容：

```
<%= data %> 
```

重复一遍：

```
<% for (Int32 index = 0; index < 10; index++) { %>
<%= data %>
<% } %> 
```

如果您有任何问题，请将其发送至我的邮箱 lasse@vkarlsen.no。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-14T17:46:29.463

我记得这是在 2006 年出现的（在我知道 T4 是什么之前！）并去搜索并找到了这个[http://social.msdn.microsoft.com/Forums/en-US/vsx/thread/1ab0bf3f-2810-4adf -bf75-900b98dee8e2/](http://social.msdn.microsoft.com/Forums/en-US/vsx/thread/1ab0bf3f-2810-4adf-bf75-900b98dee8e2/)不幸的是，gotdotnet 链接已损坏。很难说他们是否在该线程中同意您可以合法地在 VS 之外托管 T4 并重新分配 - 或不。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-15T12:00:07.760

这是一个真正的耻辱，但正如 Oleg 指出的那样，如果它未经测试，那么你怎么能发布它。

Lassevk，当然我很感兴趣 - 正在考虑重新散列我大约 10 年前构建的模板引擎，但我总是为更轻松的生活而奋斗！

# sharepoint - 文档库中多个范围内的自定义 SharePoint 功能 - 显示为重复项

> ID：443030
> 
> 赞同：1
> 
> 时间：2009-01-14T13:56:23.423
> 
> 标签：sharepoint, sharepoint-2007

我有一个自定义功能，它是文档库中的一个编辑控制块 (ECB) 操作，它被部署为解决方案包 (WSP)。当您按下文件旁边的下拉列表时，您会看到该功能，选择ECB操作时，用户将重定向到自定义应用程序页面。

我允许将此功能安装到所有 4 个不同的范围：Farm、WebApplication、Site 和 Web。它们中的每一个都将位于不同的解决方案包中，但共享相同的 FeatureId、SolutionId 等。假设一次仅将功能安装到一个范围内。如果管理员部署它、激活它，并且如果我们他/她想要更改范围、停用它，那么一切都会正常运行。如果由于某种原因管理员没有首先将其停用，则 ECB 操作将在文档库中具有重复条目。

例如，假设我们将它安装为站点范围（站点集），然后决定我们希望它在农场范围中而不是先停用它，而只是转到解决方案管理并收回并删除它。如果我们查看以前可用的网站集，我们看不到欧洲央行的行动。

如果我们随后添加 Farm 范围解决方案包并部署它，我们现在将在网站集中看到 ECB 操作，即使我们尚未部署它并且 feature.xml ActivateOnDefault 属性设置为 false。如果我们继续激活它，我们现在将看到两个欧洲央行的行动。

有没有人有任何想法？我在下面添加了 feature.xml 和 elements.xml。

TIA，马格努斯

```
<?xml version="1.0" encoding="utf-8"?> 
```

```
<?xml version="1.0" encoding="utf-8"?> 
```

RegistrationType="List" RegistrationId="101"
Location="EditControlBlock" Sequence="300"
ImageUrl="/_layouts/images/MyFeature/MyOtherPic.gif" Title="My Feature"
Description="My ECB feature" >

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-14T14:18:30.150

AFAIK，这种行为是设计使然。您将需要添加或扩展 FeatureReceiver 并覆盖某些方法，尤其是 FeatureUninstalling，您需要在每个仍处于激活状态的地方停用您的功能。

您可以记录每次激活，例如使用（顶级）Web 属性。

[演练：使用 WSS 扩展创建 SharePoint 功能接收器和自定义链接](http://blog.tylerholmes.com/2008/03/walkthrough-creating-sharepoint-feature.html "演练：使用 WSS 扩展创建 SharePoint 功能接收器和自定义链接")

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T19:02:51.230

以防其他人遇到这种情况并碰巧看到这篇文章。

通过retractsolution 移除特征时的行为取决于元素类型。对于我在我的案例中使用的 ECB 元素，如果我在每个范围的 feature.xml 文件中都有唯一的 SolutionId 和 Feature Id (Id)，则如果我在不同的功能范围中安装功能，它已被删除并且不会显示重复项.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-29T11:31:51.310

试试这个，

[创建共享点功能的非常简单的方法](http://sarangasl.blogspot.com/2009/09/in-this-article-im-going-to-describe.html)

# jquery - 可编辑的 div 元素

> ID：443033
> 
> 赞同：1
> 
> 时间：2009-01-14T13:57:17.993
> 
> 标签：jquery, xhtml, image, wysiwyg

是否可以有一个只能包含文本和图像的可编辑 div 元素。我知道您可以使用 TinyMCE 和 jWYSIWYG 等丰富的控件，但是我不需要所有这些功能并且想要一些轻量级的东西。

基本上我想要的只是一个纯文本可编辑元素，我还可以在其中添加各种图像，例如在使用 IE 或 Firefox 时**无法调整大小的表情符号。**我使用 jQuery 作为框架，所以任何使用它都会很棒。

**更新：** 是否可以阻止图像的单击事件以使调整大小处理程序不出现？

**相关问题** [Firefox - designMode：禁用图像大小调整句柄](https://stackoverflow.com/questions/289433/firefox-designmode-disable-image-resizing-handles)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T12:01:15.610

你不能强迫人们不要调整图片大小……我在 Firefox 中有一个扩展程序，可以让我无论如何都调整图片大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T14:06:35.337

我个人会说 TinyMCE 是最好的方法。您可以禁用许多不需要的功能，只留下您想要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T14:21:22.967

这可能也有太多功能，但我知道您可以删除大部分功能。我不认为图像一旦放入就可以调整大小。它是一种网络文本编辑器。[可爱编辑器](http://cutesoft.net/ASP.NET+WYSIWYG+Editor/default.aspx)

**编辑：**您几乎可以删除所有功能，并且只能允许文本和图像。它将有一个 html 选项卡和另一个您也可以删除的选项卡

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T14:28:06.900

我会建议一个简单而小的[http://nicedit.com/index.php](http://NicEdit)

# c# - LINQ 中的 If Else

> ID：443044
> 
> 赞同：42
> 
> 时间：2009-01-14T14:02:20.337
> 
> 标签：c#, linq, linq-to-sql

是否可以在 LINQ 查询中使用 If Else 条件？

就像是

```
from p in db.products
if p.price>0
select new
{
  Owner=from q in db.Users
        select q.Name
}
else
select new
{
   Owner = from r in db.ExternalUsers
            select r.Name
} 
```

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-01-14T14:06:49.517

这可能有效...

```
from p in db.products
    select new
    {
        Owner = (p.price > 0 ?
            from q in db.Users select q.Name :
            from r in db.ExternalUsers select r.Name)
    } 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-14T14:05:55.680

我假设`db`这是 LINQ-to-SQL / Entity Framework / 类似的（不是 LINQ-to-Objects）；

通常，您使用条件语法（a ? b : c）会做得更好 - 但是，我不知道它是否适用于您的不同查询（毕竟，您将如何编写 TSQL？）。

对于你*可以*做的事情类型的一个简单的例子：

```
select new {p.PriceID, Type = p.Price > 0 ? "debit" : "credit" }; 
```

你可以做更丰富的事情，但我真的怀疑你可以在条件中选择*表格*。当然，欢迎您尝试...

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-02-02T04:04:51.723

上面的答案不适合复杂的 Linq 表达式。所有你需要的是：

```
// set up the "main query"
var test = from p in _db.test select _db.test;
// if str1 is not null, add a where-condition
if(str1 != null)
{
    test = test.Where(p => p.test == str);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-01-12T13:43:52.987

```
 var result = _context.Employees
                .Where(x => !x.IsDeleted)
                .Where(x => x.ClientId > (clientId > 0 ? clientId - 1 : -1))
                .Where(x => x.ClientId < (clientId > 0 ? clientId + 1 : 1000))
                .Where(x => x.ContractorFlag == employeeFlag);
            return result; 
```

如果 clientId = 0 我们想要所有员工，。但是对于 1 到 999 之间的任何 clientId，我们只需要具有该 ID 的客户端。我遇到了单独的 LINQ 语句不一样的问题（删除/客户端过滤器需要在所有查询上），所以通过添加这两行它可以工作（直到我们有 999 多个客户端 - 这将是一个快乐的重新-因素日！！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-04T08:45:44.697

你应该这样改变：

```
private string getValue(float price)
{
    if(price >0)
        return "debit";
    return "credit";
}

//Get value like this
select new {p.PriceID, Type = getValue(p.Price)}; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-01-19T14:05:33.910

我的例子：

```
 companyNamesFirst = this.model.CustomerDisplayList.Where(a => a.CompanyFirst != null ? a.CompanyFirst.StartsWith(typedChars.ToLower())) : false).Select(b => b.CompanyFirst).Distinct().ToList(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-10-22T11:17:34.033

如果您将 LinQ 与 EF Core 一起使用，一个简单的示例可以是：

```
var orderedData = await _dbContext.ModelName
                    .OrderBy(c => c.Name.Length.Length > 4 ? c.Name:c.SuperTerm.Name.IndexOf(searchValue))
                    .ThenBy(t => t.Producer)
                    .TolistAsync(); 
```

# python - 如何使用子流程模块与流程正确交互

> ID：443057
> 
> 赞同：12
> 
> 时间：2009-01-14T14:07:12.433
> 
> 标签：python, subprocess

我在使用 subprocess 模块重定向另一个程序的 stdio 时遇到问题。仅从标准输出读取会导致挂起，并且 Popen.communicate() 可以工作，但它会在读取/写入后关闭管道。实现这一点的最简单方法是什么？

我在windows上玩这个：

```
import subprocess
proc = subprocess.Popen('python -c "while True: print \'Hi %s!\' % raw_input()"',
                        shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE,
                        stderr=subprocess.STDOUT)
while True:
    proc.stdin.write('world\n')
    proc_read = proc.stdout.readline()
    if proc_read:
        print proc_read
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-14T14:16:38.607

不适合您的示例 100%，但有助于理解潜在问题：进程 P 启动子 C。子 C 将某些内容写入其标准输出。C 的 stdout 是一个具有 4096 字符缓冲区的管道，并且输出比这短。现在，C 等待一些输入。对于 C，一切都很好。

P 等待永远不会出现的输出，因为操作系统认为没有理由刷新 C 的输出缓冲区（其中的数据太少）。由于 P 永远不会得到 C 的输出，它永远不会向 C 写入任何内容，因此 C 挂起等待来自 P 的输入。

修复：每次写入管道后使用刷新，强制操作系统*现在*发送数据。

在您的情况下，在打印后添加`proc.stdin.flush()`主 while 循环和子循环中的 a 应该可以解决您的问题。`sys.stdout.flush()`

您还应该考虑将从其他进程读取的代码移动到线程中。这里的想法是，您永远无法知道数据何时到达，而使用线程可以帮助您在编写处理结果的代码时理解这些问题。

在这个地方，我想向您展示新的 Python 2.6 文档，但它也没有解释刷新问题 :( 哦，好吧...

# iphone - 您如何为 Mac 和 iPhone 创建混合 Xcode 项目？

> ID：443074
> 
> 赞同：12
> 
> 时间：2009-01-14T14:13:57.960
> 
> 标签：iphone, cocoa, cocoa-touch, xcode, macos

我正在开发一个包含两个目标的项目。一个用于构建用于 Mac 开发的框架，另一个用于创建用于 iPhone 开发的静态库。

在通用代码中，平台之间的#ifdef 没有问题，但我无法正确获取目标和依赖项。

第一个问题是，使用哪个基础 SDK？例如，如果我使用 Mac 10.5，我不能包含 UIKit 框架（它被标记为红色，如果我展开它，它不会显示头文件）。即使实际链接到它的目标是为 iPhone OS 构建的。

另一个问题是，Foundation.framework 或 Security.framework 之类的东西怎么样？如何处理它们，因为我只能包含其中一个版本（Mac 或 iPhone SDK）...

有人对我有建议吗？我想要一个干净的项目结构和两个目标的绝对相同的代码库......配置是要走的路吗？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-12-18T10:06:19.550

只是让你知道：

我最终有了一个针对不同平台的不同目标的项目。但是我没有在目标本身中包含我所依赖的框架，而是将它们添加到*Other Linker Flags*构建设置中：

```
-framework Foundation -framework Security 
```

你可以在我在[github](http://github.com/soundcloud/cocoa-api-wrapper)上做的项目中查看它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-14T18:27:47.180

可能最简单（就您必须做的事情而言）的方法是使用相同的源集的两个项目（如果您愿意，您可以将其包装为虚拟伞形项目的子项目） - 一个针对 Mac OS X，另一个 iPhone 操作系统。

或者，您不能在同一个项目中创建两个单独的目标，并从“获取信息”窗口的“构建”选项卡中为每个目标更改“基础 SDK”吗？我没有 Xcode 在我面前检查，但我认为它会让你这样做。

（当然，无论使用哪种方法，您都可以添加第三个目标：模拟器的静态库，这在测试时很有用！）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-12-18T11:46:49.817

实际上并没有那么糟糕。只需创建适当类型的第二个目标，然后更改“Base SDK”构建设置。然后确保添加所有必要的文件。如果您想同时构建两者，请创建一个聚合目标。有关实际示例，请参阅我的项目[SSPromise](http://bitbucket.org/cbarrett/sspromise)。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-01-14T16:49:29.830

你不能使用[PIMPL 成语](http://www.ddj.com//cpp/205918714)吗？和/或两者都有一个共同的标头，但使用基于目标架构或 SDK 的不同实现文件？

# visual-studio - 在 Windows 7 上安装 VS 2008 Team Developer

> ID：443075
> 
> 赞同：2
> 
> 时间：2009-01-14T14:14:48.860
> 
> 标签：visual-studio, visual-studio-2008, windows-7

有没有人在 Windows 7 beta 上成功安装过 VS 2008 Team Developer 版本？每次尝试时，我都会收到有关 C:\Windows\Winsxs 中权限不足的错误。

我能够毫无问题地安装 VS 2008 Team Database 版本，并认为在 DB 版本之后安装 Dev 版本可能会解决 winxs 问题，但仍然没有运气。

[VS 错误消息图像 http://img152.imageshack.us/img152/7263/snipimagewd8.jpg](http://img152.imageshack.us/img152/7263/snipimagewd8.jpg)

编辑：我的安装是在 32 位版本的 windows 上。看起来 64 位版本的作品 - 有人在 32 位 windows 7 上尝试过吗？

编辑：我尝试关闭 UAC，没有运气。然后，尝试只安装*“*团队开发人员工具”部分（因为我已经安装了团队数据库） - 并得到了同样的错误，只是这次它包含一个“忽略”按钮。单击忽略，只是得到另一个没有忽略的错误，这次是 C:\Windows\Winsxs\Policies 文件夹。此时唯一的选择是取消安装。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T16:31:46.743

是的，我已经成功安装了它（Win7 64bit + Dev edition + SP1 + Team Explorer），到目前为止没有遇到任何问题。

我可能会尝试安装尽可能少的功能集，看看是否可行。如果是这样，我将一一添加功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T16:35:13.320

如果您还没有，可以尝试完全禁用 UAC。只需在控制面板中搜索用户访问控制或其他内容，它就会显示出来。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T20:11:04.673

所以，我尝试在我的另一台笔记本电脑上安装它，它安装得很好。

两台笔记本电脑之间唯一的（软件）区别是一台已经运行了几天，并且安装了所有的 Windows 更新补丁。因此，我检查了安装失败的第一台笔记本电脑，并且有一堆 Office 2007 更新要安装 - 所以安装了这些更新并再次尝试安装。在办公室补丁全部到位后，VS 2008 Team Dev 安装工作。这仍然让我感到困惑，为什么它在最初的几天让我如此悲伤。

如果我有空闲时间再次测试这一切以查看这是否真的解决了它，我可能只需要启动一个虚拟机 - 办公室补丁应该阻止我的 VS 安装似乎很奇怪。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T03:22:23.850

确保您没有在 Windows XP SP2 的兼容模式下运行安装程序。因为那时它会抱怨它至少需要安装它找不到的 Windows XP SP2。此外，我无法从使用 MS Virtual CDROM 安装的 ISO 映像安装它。我得到的错误是“无法加载sitsetup.dll”。将映像刻录到 DVD 并从那里运行设置可解决此问题。

我正在使用 Windows 7 Ultimate build 7000、32 位、英文版。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-22T09:20:43.693

我并不是说听起来很光顾，但是您是否以管理员身份运行安装程序？

# .net - 如何通过 Crystal Report API 访问有关级联动态提示的信息？

> ID：443079
> 
> 赞同：1
> 
> 时间：2009-01-14T14:16:25.957
> 
> 标签：.net, api, crystal-reports

我正在使用 CR 2008 RAS API（但如果需要，也可以使用较旧的 API）。知道如何访问有关报表中动态提示设置的信息吗？

我可以访问 PromptField 对象

```
dataDefController.ParameterFieldController.
    GetPromptParameterFields(new PropertyBagClass()); 
```

但似乎找不到任何关于其动态提示设置的选项（例如用于填充默认值的字段、级联提示设置等）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-23T14:33:32.910

这里有两个对 RAS API 很有帮助的链接。

API 参考： [http ://help.sap.com/businessobject/product_guides/boexir31/en/rassdk_net_apiRef_12_en.chm](http://help.sap.com/businessobject/product_guides/boexir31/en/rassdk_net_apiRef_12_en.chm)

开发指南： [http ://help.sap.com/businessobject/product_guides/boexir31/en/rassdk_net_dg_12_en.chm](http://help.sap.com/businessobject/product_guides/boexir31/en/rassdk_net_dg_12_en.chm)

不幸的是，他们似乎没有完全回答您的问题，但也许他们会有所帮助。

# vba - 根据另一列中的值选择一列中的一组单元格

> ID：443081
> 
> 赞同：1
> 
> 时间：2009-01-14T14:17:06.190
> 
> 标签：vba, excel

我在以下表格的excel中有一大组数据

* * *

```
A   B
1   stuff1
6   stuff2
3   stuff3
1   stuff4
1   stuff5
7   stuff6
3   stuff7
2   stuff8
.   .
.   .
.   .
5   stuffn 
```

* * *

我想要的是一些vba代码，它将选择B中所有在A列中有“1”的单元格 - 我将使用这个集合在我的代码的另一部分执行一些任务

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-14T14:35:17.527

我不确切知道您在长期中要做什么，但是对于这一步，您可以在 C 列中执行此操作`=if(a1=1,b1,"")`
，然后在 c 列上应用过滤器并选择非空白选项，
然后您可以选择整个 c 列

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T16:18:43.930

这应该有效：

```
Sub SelectCellsInColBBasedOnColA()
    Dim TheSheet As Worksheet
    If TypeOf ActiveSheet Is Worksheet Then
        Set TheSheet = ActiveSheet
    Else
        Exit Sub
    End If

    Dim Row As Integer
    Dim CellsToSelect As String
    For Row = 1 To TheSheet.Range("A" & CStr(TheSheet.Rows.Count)).End(xlUp).Row
        If TheSheet.Range("A" & CStr(Row)).Value = 1 Then
            If CellsToSelect <> "" Then CellsToSelect = CellsToSelect & ","
            CellsToSelect = CellsToSelect & "B" & CStr(Row)
        End If
    Next Row
    TheSheet.Range(CellsToSelect).Select
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T16:39:16.090

总是有 ADO。

```
'Reference: Microsost ActiveX n.n Object Library '
'but it is not necessary, Dim rs and cn as object '
'if you do not wish to use a reference '

Dim rs As ADODB.Recordset
Dim cn As ADODB.Connection

'From: http://support.microsoft.com/kb/246335 '

strFile = Workbooks(1).FullName
strCon = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & strFile _
    & ";Extended Properties=""Excel 8.0;HDR=No;IMEX=1"";"

Set cn = CreateObject("ADODB.Connection")
Set rs = CreateObject("ADODB.Recordset")

cn.Open strCon

'Substitute a name range for [Sheet1$] '
'or include a range of cells : [Sheet1&A1:C7] '
'F1 is field 1, because we have no header (HDR: No) '
strSQL = "SELECT * FROM [Sheet3$] " _
       & "WHERE F1=1"

rs.Open strSQL, cn

'Write out to another sheet '
Worksheets(2).Cells(2, 1).CopyFromRecordset rs 
```

# python - _lsprof.c 分析器对 python 多线程的行为

> ID：443082
> 
> 赞同：1
> 
> 时间：2009-01-14T14:17:20.103
> 
> 标签：python, multithreading

这是一个关于 Python 原生 c 文件 _lsprof 的问题。如果 f 的执行被另一个线程中断，_lsprof.profile() 探查器如何计算多线程程序中函数 f 花费的总时间？

例如：

def f():
linef1
linef2
linef3

def g():
lineg1
lineg2

在执行时， f 和 g 不在同一个线程中：

linef1
linef2
lineg1
linef3
lineg2

那么 f 的总运行时间是否会被视为需要做的时间量：

linef1
linef2
linef3

还是有效的延迟时间：

线
1 线
2 线 1 线
3

在 _lsprof.profile() 的结果中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T23:44:13.463

引用[setprofile 的文档](http://docs.python.org/library/sys.html#sys.setprofile)：

> 该函数是线程特定的，但分析器无法知道线程之间的上下文切换，因此在存在多个线程的情况下使用它没有意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T10:38:35.437

谢谢你的回答！实际上，我在每种情况下都运行一个分析器，所以这个问题是有道理的。根据我所做的测试，分析器将在上面的示例中测量“linef1 linef2 linef3”。

# apache-flex - Flex4（代号 Gumbo）SWF 文件大小推测

> ID：443083
> 
> 赞同：2
> 
> 时间：2009-01-14T14:17:27.297
> 
> 标签：apache-flex, flash, flex4

我听说即将推出的 Flex 4 框架中的组件将更加松散耦合，可能允许使用相对较少组件的项目使用更小的文件大小。这是真的吗？还是整个 Flex 框架仍会捆绑到每个使用单个 Flex 4 组件的 SWF 中？

如果这是真的，并且我们可以编译相当小的 SWF，那么对于一个非常小的 Flex 4 应用程序，我们可以期望什么样的 SWF 文件大小？最小的意思是一个带有一些文本的 VBox 和一个滚动条。

编辑：

好吧，我的错，在以后发这样的问题之前需要做更多的研究：Flex 4 是建立在 Flex 3 架构之上的，所以 SWFs 仍然需要捆绑 Flex 框架（或者使用 RSL 来分离框架字节码来自应用程序字节码 - 如下所述）。

看：

*   [http://flexorg.wip3.adobe.com/gumbo/gumboplan.htm](http://flexorg.wip3.adobe.com/gumbo/gumboplan.htm)
*   [http://opensource.adobe.com/wiki/display/flexsdk/Gumbo](http://opensource.adobe.com/wiki/display/flexsdk/Gumbo)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-14T14:25:58.293

我不知道 Flex 4 计划对 swf 大小进行任何更改（并且快速的 google 搜索没有发现任何内容），但话虽如此，Flex 3 进行了一些更改以减小 swf 的大小：

[http://www.onflex.org/ted/2007/06/flex-3-thursday-dramatically-smaller.php](http://www.onflex.org/ted/2007/06/flex-3-thursday-dramatically-smaller.php)

它允许 swf 不包含框架，如果需要框架，它会被下载到客户端并缓存。因此，您的 swf 大小仅取决于您的实际代码的大小。我们的 swf 尺寸非常小，小至 200kb。您是否有某个项目产生的 swf 比您预期的要大？

# opengl - opengl topdown<->bottomup 纹理？

> ID：443086
> 
> 赞同：2
> 
> 时间：2009-01-14T14:17:40.713
> 
> 标签：opengl, textures, flip, topdown, bottom-up

当我通过 FreeImage 加载图像时，这些位是从下到上的。我的 GL 代码要求所有图像都是自上而下的。当我将位复制到纹理时，翻转图像的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T02:45:58.563

您可以使用纹理矩阵来有效地翻转 texcoords。我认为这会起作用：

```
glMatrixMode(GL_TEXTURE);
glLoadIdentity();
glScalef(1.0, -1.0, 1.0);
glMatrixMode(GL_MODELVIEW); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T21:56:15.933

可以试试 FreeImage_FlipVertical()。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T17:10:37.913

我认为使用简单的数组算术和 1 个临时长字值进行就地翻转是明智的。（所以每像素翻转，4 个字节）。

您当然可以翻转纹理坐标，但恕我直言，这是不明智的，因为您可能不想用纹理颠倒的信息污染您的代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-07-15T23:03:24.193

根据您的应用程序，大多数专业游戏会在构建过程中翻转它们的纹理，而不是在加载时。

# c++ - C 和 C++ 之间的主要区别是什么？您何时会选择其中一个？

> ID：443090
> 
> 赞同：10
> 
> 时间：2009-01-14T14:19:09.507
> 
> 标签：c++, c, programming-languages

对于那些有这两种经验的人来说，主要区别是什么？对于任何一个新手来说，学习哪个更好？在某些情况下您可能会选择 C，但在其他情况下您会选择 C++？是使用最好的工具完成工作，还是其中一个明显优于另一个。我知道 C++ 是 C 的“增强”，但它是在 83 年创建的，并没有完全取代 C，所以它必须有更多的东西。

我知道这个问题是主观的，我并不是要发动任何宗教战争，所以请尽量客观。明确优缺点和比较。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-14T14:39:17.907

虽然 C 是一种纯过程语言，但 C++ 是一种*多范式*语言。它支持

*   通用编程：允许编写一次代码，并将其与不同的数据结构一起使用。
*   元编程：允许在编译时利用模板生成高效的代码。
*   检查：允许在编译时检查某些属性：表达式有什么类型？一个函数有多少个参数？每种都有什么类型？
*   面向对象编程：允许程序员进行面向对象的编程，具有复杂的特性，例如多重继承和私有继承。
*   过程式编程：允许程序员将函数从任何类中解放出来。结合 ADL 等高级功能，可以编写与某些类的细节分离的干净代码。

除此之外，C++ 在很大程度上保持了与 C 代码的兼容性，但也存在一些差异。这些可以在 C++ 标准的附件 D 中阅读，以及使 C 代码有效的 C++ 代码的原因和可能的修复。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-14T14:22:40.953

C++ 99% 是 C 的超集。它在语法上更严格一些，在事物变化方面有一些非常细微的差异。

最大的不同是 C++ 尝试面向对象。对类有本机支持。

C++ 中还有其他一些好处：模板、流运算符、按引用传递（比按指针传递更容易混淆）

使用 C++ 会失去什么？它缺少许多人使用 C 的一些最低级别的 hack。我不记得它们中的任何一个，但是我从来没有听说过任何好的论据来欺骗编译器做你想做的事情，除非是为了将效率提高 10%。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-14T14:27:22.503

顾名思义，正如您在问题中所说，C++ 是 C 的增强。这是一个重大的增强。（我使用“增强”一词来指代功能，而不是功能。）但是，关于增强，它意味着增长。C++ 通常适用于更大的程序。应用程序，真的。它是一种高性能语言，但它很大。

另一方面，C 用于内核和驱动程序编程是有原因的。它很旧（古老？），很小，如果你很聪明，你可以在不自己编写汇编程序的情况下尽可能快地获得它。显然，权衡是功能。C 没有很多像我这样的 C++ 程序员认为理所当然的类和模板之类的大而柔软的概念（是的，完全有罪）。

因此，为了更直接地回答您的问题，我的大多数大型高性能项目都是用 C++ 编写的。如果我正在研究驱动程序或嵌入式系统之类的东西，我希望使用 C。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-14T14:31:17.300

如果您从未使用过需要您进行手动内存管理的语言，我会先选择 C。

专注于 C 基础知识，如字符串、函数指针以及如何使用和管理内存。当您转换到 C++ 时，这些都将转移。最重要的是，确保你真正了解指针，它们与内存的关系，以及指针和数组之间的关系。我想说要成为一个全面的程序员，理解这些东西是必需的。

然后，转到 C++ 并了解 OO 模型、模板等。从一开始就尝试用 C++ 做所有事情可能有点不知所措。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-14T14:41:07.653

我会提出这样的论点，即在大多数情况下，您最好使用 C++ 而不是 C。如果您不想使用，则不必使用 C++ 的所有复杂功能。C++ 添加的一些东西对大多数情况非常有用：

*   更强的打字。
*   标准库中包含的字符串类。
*   一个数组类（向量），它会根据您的需要而增长，并为您处理所有的内存分配和释放。

就我个人而言，我觉得这三件事让使用 C++ 是值得的，即使你用它来编写类似 C 的代码（也就是过程的、非面向对象的代码）。

也许如果你正在做一些内核黑客或嵌入式系统开发，你应该使用 C，但否则，我会推荐 C++。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-14T15:18:54.113

> 对于那些有这两种经验的人来说，主要区别是什么？

C是子集，C++是超集。C++ 包括支持面向对象编程的特性（例如“多态性”）以及许多其他特性。

> 对于任何一个新手来说，学习哪个更好？

C 更容易（因为它是一个较小的主题），而 C++ 更好（因为它更强大，包括 C，而且根据我的经验，用 C++ 编程的工作比用 C 编程的工作要多）。

> 在某些情况下您可能会选择 C，但在其他情况下您会选择 C++？

在目标平台支持 C 但不支持 C++（即在某些嵌入式设备上）的极少数情况下，我会选择 C ​​而不是 C++。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-15T17:46:11.993

您可以在可能的地方使用 C++，在必须的地方使用 C。一般来说，如果您的平台有可用的 C++ 编译器，则没有理由不使用它。C 是一门非常好的语言，但 C++ 增加了很多额外的功能而不会失去任何功能，因此它几乎总是首选语言。

# c# - 如何使用 .NET 监控应用程序状态？

> ID：443092
> 
> 赞同：2
> 
> 时间：2009-01-14T14:19:19.990
> 
> 标签：c#, networking, monitoring

我必须开发一个系统来监控网络中运行的应用程序。它应该收集有关应用程序状态的信息，并在出现问题时发送警报。我选择在.NET 上开发这个应用程序。如果有任何用于此目的的 API 或任何可以帮助我开始的想法，请告诉我。如果您建议任何其他框架来开发此类项目，我可以知道原因！

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-14T14:37:26.990

[WMI](http://msdn.microsoft.com/en-us/magazine/cc302051.aspx)（System.Management 命名空间）或连接到 Windows 性能监视器将为您提供良好的运行开始。您还可以设置自己的“客户端-服务器”监控基础架构，其中程序在每台目标机器上作为 Windows 服务运行。然后，所述程序将能够运行您想要的任何监视代码，例如检查具有特定名称的进程是否正在运行。该程序将向中央服务器发送包含给定机器的“状态”报告的报告（通过远程处理、套接字、Web 服务或任何您喜欢的东西）。然后中央服务器可以聚合状态并发送警报或触发警报或任何适合您业务需求的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T14:28:34.387

这取决于您是否指任意应用程序，没有任何编码更改或应用程序本身的支持？或者您的意思是一套经过自定义编码以与您正在构建的监控系统合作的应用程序。

在后一种情况下，我将向应用程序添加一个远程处理通道，监控系统可以定期连接到该通道（功能类似于 ping）并使用通用 GetStatus() 方法向监控系统报告适当的健康统计信息...我会将此功能作为单独的依赖程序集添加到我要监视的每个应用程序中...

在第一种情况下，我相信您将需要连接到操作系统 API，尤其是与网络上其他机器上运行的操作系统进行通信（如果这也是一个要求）正如您提到的 .Net 我假设您只是在谈论 WIn32 机器。我不知道 WIn32 API 在这方面提供了什么功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T14:22:07.897

您需要定义监控。您计划如何监控应用程序以及您计划记录什么样的信息？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T14:29:06.650

您对应用程序“问题”的定义是什么？您是否对要监控的应用程序进行代码控制？一般来说，有“问题”的应用程序不会宣布它，因为它通常是由于错误造成的。如果该应用程序尚未设计为专门为您发送信息以查找问题，那么您将如何检测到这一点非常困难。

我过去做过的唯一类似的事情是连接到调度程序本身（在 Windows CE 中），以监控量子线程的数量正在寻找消耗过多处理器的东西，但要预先警告这样做那种东西有很大的潜在错误，它使用了很多处理器本身（我不知道你是否可以在桌面上做到这一点）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T14:29:29.003

好吧，监控应用程序并不是那么简单，因为您必须查看其他电脑以及其中发生的情况。

监控网络的常用方法是使用 SNM-Protocol 套件，或者更多地进入 Windows 世界 WMI-Path。

WMI 包含在 .NET 中，但没有漏洞，因此您需要知道如何处理 WMI 并为此构建自己的包装器。

我敢打赌，SNMP 并没有真正的帮助，因为并非所有应用程序都支持这一点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-14T16:45:17.590

更清楚地说，在我的网络中，我有不同的机器和服务器，它们运行着一些应用程序，如数据库、Web 应用程序和许多其他应用程序。

该网络的管理员需要一个监控应用程序，如果有任何应用程序出现故障，它会向他发出警报。但我没有说明可能出现的问题类型！！

我可以对 WMI 有更多的解释吗？

谢谢你。

# c++ - 关于 COM/ActiveX 对象的问题

> ID：443095
> 
> 赞同：0
> 
> 时间：2009-01-14T14:20:38.757
> 
> 标签：c++, c, com, dll, activex

我对“传统”的工作有很好的了解`.dll`。还有 和 之间的区别`dynamic loading`等等`static loading`。

但我对 COM 对象的工作有以下疑问，

*   是否必须使用 注册 COM 对象`regsvr32`？
*   `COM object`我可以在相同/不同的目录中注册两个版本吗？
*   `.dll`除了被打包在 .dll 文件中之外，“传统”和.dll 文件之间还有什么共同点`COM object`吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T14:32:15.067

是的，COM 程序集已注册，以便 COM 基础结构知道它们存在。DLL 是通过注册 CLSID 而不是路径找到的。

如果两个版本具有不同的名称，则它们可以共存（显然，文件夹中不能有相同的命名文件）。

所有 COM 对象都实现了特定的接口（IUnknown，很多都有 IDispatch）。COM 的工作原理实际上是一个超出我们可以在此处发布的主题的方式。你可能会得到一本 ATL Internals 之类的书，或者阅读一些在线 COM 教程。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-14T15:57:32.413

1) 否 - 不需要注册 COM*对象*。需要注册才能创建*新的*COM 对象。有许多需要 COM 对象的接口（COM 或本机函数）。他们的 API 告诉你你的 COM 对象应该支持哪个接口。由于您传入一个现有的 COM 对象，因此它们不需要注册信息来创建您的 COM 对象。此方案的一个变体是运行对象表，您可以在其中注册创建的 COM 对象。这些对象也是您创建的，您不需要注册信息。

示例界面：IQueryCancelAutoplay。

2) COM*对象*存在于内存中。您可能正在考虑一个 COM*类*，它与它的 COM 工厂一起在 DLL 中实现。COM 类由它们的 GUID 注册。您可以有多个类=每个 DLL 的 GUID，但每个类只有一个 DLL。请记住，调用者向 COM 请求您的类的一个实例。如果有两个 DLL 实现同一个类，COM 会加载哪个 DLL？！当然，可以有两个 DLL，每个 DLL 都实现一个类，这两个类共享一些接口。他们将始终共享 IUnknown，例如，通常是 IDispatch，但很少是 IAcmeCorpFooBrv2

3) COM DLL*是*一个普通的 DLL，它 (a) 公开了一些特定于 COM 的函数，并且 (b) 已注册，因此 COM 框架可以在其上调用 LoadLibrary。DLL 还可能公开其他非 COM 函数。因此，您可以自己在 COM DLL 上调用 LoadLibrary。这有时对减少创建第一个 COM 对象所涉及的延迟很有用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-14T14:39:49.293

[1）如果您不使用名为Reg-Free COM 的](http://msdn.microsoft.com/en-us/magazine/cc188708.aspx)东西，则必须注册它

2)不能注册两个具有相同CLSID 到ProgID 映射的COM 对象。

3）最终，传统的 dll 和 COM dll 都包含机器代码。如果不是为了实现接口，那么您编写代码的方式也没有太大区别。

# wcf - 我的 WCF 是否使用正确的绑定？

> ID：443102
> 
> 赞同：1
> 
> 时间：2009-01-14T14:21:55.540
> 
> 标签：wcf, binding, web-config

我的 wcf 服务的 web.config 如下所示：

如何确认它正确使用了设置？

**即使我已将绑定配置为使用：SendTimeout = 10 分钟等，有时我仍然会收到此超时错误？**

```
<system.serviceModel>
    <services>
      <service behaviorConfiguration="MyService.MyServiceBehavior"
        name="MyService.MyService">
        <endpoint address="" binding="basicHttpBinding" bindingConfiguration="longTimeoutBinding"
          bindingName="" contract="MyService.IMyService">
          <identity>
            <dns value="localhost" />
          </identity>
        </endpoint>
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
      </service>
    </services>
    <bindings>
      <basicHttpBinding>
        <binding name="longTimeoutBinding" closeTimeout="00:05:00" openTimeout="00:05:00"
          receiveTimeout="00:10:00" sendTimeout="00:10:00" maxBufferPoolSize="1048576" maxReceivedMessageSize="67108864">
          <security mode="None" />
        </binding>
      </basicHttpBinding>
    </bindings>

    <behaviors>
      <serviceBehaviors>
        <behavior name="MyService.MyServiceBehavior">
          <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment -->
          <serviceMetadata httpGetEnabled="true"/>
          <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
          <serviceDebug includeExceptionDetailInFaults="true"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>
  </system.serviceModel> 
```

我的客户端（Windows 服务）app.config 看起来像：

```
<system.serviceModel>
    <bindings>
      <basicHttpBinding>
        <binding name="BasicHttpBinding_IMyService" closeTimeout="00:01:00"
          openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
          allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
          maxBufferSize="65536" maxBufferPoolSize="1048576" maxReceivedMessageSize="67108864"
          messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered"
          useDefaultWebProxy="true">
          <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
            maxBytesPerRead="4096" maxNameTableCharCount="16384" />
          <security mode="None">
            <transport clientCredentialType="None" proxyCredentialType="None"
              realm="" />
            <message clientCredentialType="UserName" algorithmSuite="Default" />
          </security>
        </binding>
      </basicHttpBinding>
    </bindings>
    <client>
      <endpoint address="http://local/MyService/MyService.svc"
        binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_IMyService"
        contract="MyService.IMyService" name="BasicHttpBinding_IMyService" />
    </client>
  </system.serviceModel> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-14T19:35:41.740

尝试在客户端配置中设置超时值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T14:18:15.953

如果将客户端中的 sendTimeout 设置为 10 分钟会怎样？

# .net - 是否有（免费）用于 3D WPF 对象的工具或库？

> ID：443106
> 
> 赞同：9
> 
> 时间：2009-01-14T14:23:07.377
> 
> 标签：.net, wpf, graphics, 3d

我想在 WPF 中玩一些 3D 控件，但有点惊讶地发现 WPF 中没有原始的实体控件 - 我只是想在场景中放置一些球体和立方体，但没有意识到我必须这样做使用网格渲染它们。

现在肯定有人已经创建了可以添加到 WPF 3D 场景中的 3d 基元库。这些库中的任何一个都是免费的吗？

建模工具怎么样？我知道有一些免费的建模应用程序（如 Blender），但是有没有办法从这些应用程序中导出模型并将它们包含在 WPF 应用程序中？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-16T18:09:21.737

Charles Petzold 为 WPF 编写了一个基本 3D 形状库，您可以在这里找到：http: [//www.charlespetzold.com/3D/](http://www.charlespetzold.com/3D/)

诚然，它带有一个奇怪的许可证，但总而言之，它相当便宜，而且你会得到一本免费的书，我顺便推荐一下；）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-22T15:14:29.130

我应该添加一些其他非常非常重要的东西，我在第一篇文章中忘记提到了——你*为什么*要看 3D 控件？我查看了 Thomas 发布的链接，他们有一个 3D 动画“刀开关”来替换复选框。

为了所有纯洁圣洁的爱，*不要把*它强加在商业桌面应用程序上！如果你想玩它，如果你想让儿童软件变得有趣或者什么，很好，很好。但我只是想确保你没有试图在你的会计包或其他东西中“增加冲击力”......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-14T14:52:03.310

我不知道它与 WPF 的性能如何，但您可以直接从 Microsoft 免费下载[XNA 。](http://xna.com/)它为您提供了一些漂亮的 3D API 包装器。

另外，请查看马特[对此问题](https://stackoverflow.com/questions/130507/how-can-i-use-wpfs-d3dimage-with-managed-directx-or-xna)的回答。我不知道等待 .NET 4.0 是否适合您...

“WPF 博士”写了一篇关于 WPF D3DImage 控件的[CodeProject 文章，然后](http://www.codeproject.com/KB/WPF/D3DImage.aspx)[在博客中介绍了它](http://www.drwpf.com/blog/Home/tabid/36/EntryID/38/Default.aspx)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-23T02:09:13.220

恕我直言，请勿使用[Petzold Media 3D](http://www.charlespetzold.com/3D/)进行图元绘图。它以不寻常的方式工作于 WPF 3D 覆盖 OnDraw() 方法。这不是正确的方法。这是学习某些功能的好资源，仅此而已。当然，在[codeplex](http://helixtoolkit.codeplex.com/)中有很棒的免费库 Helix 3D 。任何用于创建 3D 对象的工具都是一个好的开始。在 WPF 中查看帖子[3D 模型](https://stackoverflow.com/questions/3127753/displaying-3d-models-in-wpf/12809252#12809252)祝您 在 WPF 3D 中好运！ps 我也喜欢手工绘制 3D 图元...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-07T16:17:28.850

如果您计划使用 Blender，您可以使用[XAML Exporter for Blender](http://www.codeplex.com/xamlexporter)导出模型。 还有适用于[3D Studio MAX](http://max2xaml.codeplex.com/)和[Maya 3d](http://www.highend3d.com/maya/downloads/tools/3d_converters/3782.html)的导出器，并且很可能也适用于大多数其他商业包。

# installshield - InstallShield：卸载时删除已安装的文件

> ID：443109
> 
> 赞同：1
> 
> 时间：2009-01-14T14:24:22.320
> 
> 标签：installshield, uninstallation

在安装时，我将一些文件复制到“System32”文件夹中。卸载时这些文件不会被删除。为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-14T15:19:28.187

MSI 安装应该是声明性的而不是程序性的。您声明应该复制哪些文件，它们会被 Windows 安装程序复制。卸载 Windows Installer 时知道要删除哪些文件，因为它，因为他确实首先安装了它们。

另一方面，如果您在安装过程中进行手动操作，例如自己复制文件，Windows Installer 不知道这一点，您有责任在卸载时删除它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T15:11:52.600

文件所属的组件可能是[永久](http://msdn.microsoft.com/en-us/library/aa369530(VS.85).aspx)的吗？另请注意，除非必须，否则应避免将文件安装到 System32。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T14:31:16.097

文件是如何手动到达该文件夹的？如果是这样，它们将不会被删除，请参阅[http://kb.acresso.com/selfservice/viewContent.do?externalID=Q100225](http://kb.acresso.com/selfservice/viewContent.do?externalID=Q100225)

* * *

我正在使用 InstallScript，并且某些功能会在卸载时回滚：[为卸载而记录的 InstallScript 功能](http://helpnet.acresso.com/robo/projects/installshield14helplib/IHelpIScriptLog.htm)- 他们在那里提到它也适用于 InstallScript 或 InstallScript MSI 项目。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T14:51:07.400

这是基于 MSI 的安装还是 installscript？如果是 MSI，也许详细的日志会提供更多的洞察力？另外（您可能检查过），但请确保这些文件未标记为永久。

另外，这是动态链接文件还是静态文件？由于基于 msi 的安装程序缺少密钥文件，我有时会遇到动态问题。您可以尝试使文件静态链接。

# regex - 如何匹配不包括前导和尾随空格的引用文本？

> ID：443111
> 
> 赞同：0
> 
> 时间：2009-01-14T14:24:58.357
> 
> 标签：regex

即比赛

```
 He said, "For my part, it was Greek to me. " 
```

应该

```
For my part, it was Greek to me. 
```

没有尾随空格。我试过了

```
\"\s*([^\"]*)\s*\" 
```

但它总是匹配组中的尾随空格。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T14:28:29.940

尝试：

```
\"\s*([^\"]*?)\s*\" 
```

但要小心，这个版本取决于右引号（因为它很懒）。当您在此处添加惰性运算符时，它会获取尽可能小的字符串。如果没有右引号，则此正则表达式将失败

如果您确定没有空字符串，您可以使用：

```
\"\s*([^\"]*[^\"\s])\s*\" 
```

这个版本的主要问题是你现在至少要争取一个角色。

老实说，看了两遍，我会使用第一个模式。您正在寻找结束报价，而不是转义任何报价。它会在 100% 的时间内满足您当前的需求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T14:28:02.063

之后使用简单的字符串函数修剪空白不是更容易吗？这也将简化正则表达式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T14:29:01.360

如果你强制它的最后一个字符是非空格怎么办？像这样的东西：

```
\"\s*([^\"]*[^\s])\s*\" 
```

# ipc - 如何计算不同机器上的统计数据并再次组合它们？

> ID：443119
> 
> 赞同：0
> 
> 时间：2009-01-14T14:27:13.750
> 
> 标签：ipc, distributed, user-feedback

我有两个提供相同功能的后端应用程序，它们位于两台不同的机器上（实际上这是为了进行负载平衡）。所以他们使用相同的方式处理客户端前端请求。

我想收集有关所有连接的客户端的一些统计信息（即：客户端 GUI 应用程序中最常用的组件是什么或类似的东西）并每秒将结果发送给所有客户端。

我正在考虑分别计算每个后端组件上的这些统计信息并将两者加在一起，在这种情况下，我有一组选项，例如在后端组件之间进行某种通信，或者只是在全局数据库中创建小表，然后每个后端更新表然后选择并发送给它的客户，但这可能会降低性能，因为我想每秒发送一次统计信息

我需要帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-14T14:34:15.407

在我投资更复杂的解决方案之前，我需要证明任意（或随机）分配不够好。保留每台机器的统计数据，并根据一些任意分配（当前第二个是奇数，选择机器 1，第二个是偶数，选择 2）首先比较它们的负载因子。如果这不起作用，那么您可以开始寻找更好的算法。

FWIW，这正是我们在校园计算实验室中为 1000 多台机器分配默认打印机的方式。我们在每个实验室的各种打印机上的负载是均匀分布的。

# c - 解锁连接到套接字会导致上下文切换吗？

> ID：443128
> 
> 赞同：1
> 
> 时间：2009-01-14T14:28:33.530
> 
> 标签：c, winapi, sockets, winsock

我正在使用 winsock 并调用`connect`非阻塞套接字。当 CPU 被其他进程占用时，我偶尔会在函数返回之前看到一些延迟（最多 200 毫秒）。据我所知，`connect`非阻塞套接字上的 a 应该立即返回，但可能`connect`会导致上下文切换，并且由于 CPU 正在努力工作，我的线程需要一段时间才能再次获得 CPU 时间并退出函数。

我知道（或至少相当肯定）`connect`阻塞套接字会导致上下文切换，但非阻塞套接字会导致上下文切换`connect`吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T10:51:35.620

此外，这个调用需要深入内核，这已经意味着花费了一些时间。正如其他人指出的那样：上下文切换可以随时发生。您可以做一些技巧（例如使用稍高的优先级等），但事实是使用非实时操作系统您无法保证分配的时间片、完成某些操作所需的时间等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T04:23:38.087

无论是非阻塞连接、阻塞连接还是连接之前/之后的任何时间，都可以随时进行上下文切换。只是在连接过程尚未完成时，非阻塞连接可能会返回。

在任何现代操作系统中，在正常程序运行的任何阶段都可以进行上下文切换。永远无法保证某段代码将不间断地运行。（只有那些对系统非常关键的人才能获得这样的特权）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T03:16:04.027

根据定义，非阻塞调用不会*导致*上下文切换。但是，上下文切换可能会立即发生。

我不确定你在这里的意思。“据我所知，非阻塞套接字上的连接应该立即返回。” 一方面，是的，无论连接是否完成，后续代码行都会执行，因此从这个意义上说，它会立即返回。如果您的意思是它会立即返回，因为在它返回之前不会发生上下文切换，那么您将是不正确的。

# linux - 在 Linux 中，我如何知道某个 TCP 数据包是否收到了 ACK？

> ID：443134
> 
> 赞同：2
> 
> 时间：2009-01-14T14:29:42.810
> 
> 标签：linux, tcp

长话短说：在 Linux 中，如何确保收到某个 TCP 数据包的 ACK 消息？

全文：

我正在调试 Asterisk/OpenH323 <-> Panasonic IP-GW16 问题。

H323 连接涉及两个会话：H225.0 和 H245。这些只是两个 TCP 会话，通过它们传输一些数据。

我们称它们`Session 1`为（对于 H225.0）和`Session 2`（对于 H245）。

`Session 1`具有众所周知的 TCP 端口号 1720，而端口号`Session 2`是在运行时选择的。

控制流程如下：

1.  Panasonic 调用 Asterisk：它打开`Session 1`(TCP/1720) 到 Asterisk 并发送一个 SETUP 消息`Session 1`，其中包含`port 2`Panasonic 将要收听的消息。
2.  Asterisk 向 Panasonic 发送 CALL PROCEEDING 消息`Session 1`
3.  松下开始收听`port 2`
4.  Panasonic 通过 发送 TCP ACK `Session 1`。
5.  Asterisk`Session 2`在`port 2`.

第 2 步和第 3 步的顺序很重要：Panasonic 不会收听，`port 2`除非它在 ​​上收到 CALL PROCEEDING 消息`step 2`。

但是在 OpenH323 代码中，`step 2`只有`step 5`几行。

这就是连接`sometimes`在调试模式下`quite never`工作并在发布时工作的原因。

在数据包转储中可以清楚地看到。我做了一系列的实验，在52个案例中，有52个，如果`step 5`在前面`step 4`，连接失败；如果没有，则连接成功。

除了 ACK 中的 ACK 之外，没有从 Panasonic 发送的其他消息`step 4`，而且似乎 Asterisk 知道`port 2`被监听的唯一方法是接收该 ACK。

当然我可以实现定时等待，但我想要一个更清洁的解决方案。

所以问题又来了：在通过 TCP 连接发送消息后`step 2`，我如何知道是否收到了包含该消息的数据包的 ACK？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T16:46:35.497

在这种特定情况下，我会说您会发现您的`tcp_info`结构将包含一个 nonzero `tcp_info.tcpi_unacked`。你可以通过`getsockopt(TCP_INFO)`.

注意：显然界面不稳定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-10-29T00:12:44.440

A TCP-level ACK is sent by the operating system and can be sent before the data is read by the process. So if you receive the ACK it doesn't mean that the remote application acted on the message or was even notified of it's existence.

Just imagine: if TCP acks we're a message confirmation then the application should read() the message, process it (which can take a while) and then call a "read_ok" syscall. As far as I know this is impossible with the standard socket API.

You might be able to check if there's any unacked data with the SIOCOUTQ ioctl (man 7 tcp). But it's not reliable solution to your problem.

Are you sure this is how h323 is supposed to work? What if port2 is invalid or taken by another connection? A confirmation or error should be sent back.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T16:49:51.293

时序看起来很奇怪，尽管如果松下使用专有的操作系​​统可能会解释它。

澄清一下——AIUI——如果松下运行的是“正常”操作系统，它在第 4 阶段发送的 ACK 将在松下的软件`read()`从控制 TCP 套接字获得数据后立即发生。

同样，在 Asterisk 服务器接收到来自 Panasonic 的 ACK 之前，对（在步骤 2 中）的 OpenH323 代码调用`write()`不应返回（*假设它不是非阻塞套接字*！）。 **这**就是您应该知道已收到 ACK 的方式。

从本质上讲，松下似乎在收到消息之前并没有在`listen()`第二个插座上做相当于。它看起来像一个竞争条件 - 有时 Open323 会在另一端准备好之前尝试。`read()``CALL PROCEEDING``connect()`

当这种情况发生时，你是否`ECONNREFUSED`在 OpenH23 结束？

# sql - 为另一个表中的每个 id 在表中插入行

> ID：443140
> 
> 赞同：50
> 
> 时间：2009-01-14T14:31:45.053
> 
> 标签：sql, tsql

我尝试在这里搜索类似的解决方案，但没有看到，所以我想知道完成以下任务的最佳方法是什么。

我有一个包含 1700 万行以上的表，它们都有一个唯一的 ID。我们最近创建了一个新表，它将与之前的表一起使用，其中新表的外键是旧表的唯一 id。

例如。
表 1 - id、field1、field2、field3 ... 表 2 - table1.id、field1 ...

问题是，由于我们正在将其迁移到实时环境中，因此我们需要使用包含表 1 中表 1 中每一行的 id 的行来回填表 2。例如，表 1 - 1，测试，空表 2 现在需要对于 table1 中的每一行，具有：1、null、... 等等。主要问题是表 1 中的 id 并非都是连续的，因此我们必须从表 1 中读取，然后根据找到的 id 插入表 2。

有没有更简单的方法来解决这个问题？提前感谢乔

还要澄清一下，表 2 将是新数据，表 1 中包含的唯一内容是保持外键关系的 id

这也是 sql server 2000

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-01-14T16:14:39.010

如果我理解正确，您希望 table2 中的每条记录对应 table1 中的一条记录。另外我相信除了对 table1 的引用之外，table2 最初应该包含空白行。

所以假设

```
table1 (ID, field1, field2, ...)
table2 (ID, table1_ID, fieldA, fieldB,...)
-- where table1_ID is a reference to ID of table1 
```

创建 table2 后，您可以简单地运行此插入语句

```
insert into table2(table1_ID) 
select ID from table1 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-01-14T14:37:56.007

我不确定我是否完全关注你，但这样的事情对你有用吗？

```
INSERT INTO table2 ( SELECT field1, field2, field3... FROM table1 ) 
```

如果我理解正确，您希望 table2 中的每条记录都有 table1 中的记录。这将做到这一点。只需以正确的顺序匹配您在选择中的字段，并为表 2 中您在表 1 中没有的任何字段指定常量。

HTH。如果我不理解，请告诉我，我会再次尝试提供帮助。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-14T14:43:29.740

你需要阅读这篇文章。

[最常见的 SQL 反模式有哪些？](https://stackoverflow.com/questions/346659/what-are-the-most-common-sql-anti-patterns#346679)

> 主要问题是表 1 中的 id 并不都是连续的，所以我们必须从表 1 中读取，然后根据找到的 id 插入表 2

是的，看看我在上面文章中的回答，并使用 Item #2 编写一个 key-walking 循环。

确保在编写插入语句时提供了一个字段列表——正如我在第 1 项中所说的那样。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-14T14:39:10.637

有了这么多行，您可能会遇到事务日志空间和运行大型插入事务的时间长度的问题。

如果运行时间是一个限制，我会认真推荐使用 Bcp （或者根据平台适用的任何工具）

从原始表中选择 id，使用它为扩展表构建 Bcp 文件，然后将其 Bcp 入。

许多人发现在包含 10,000 条记录的文件中 Bcp 比包含 17,000,000 行的一个humungus 文件更高效。

此外，您可以在上线之前在后台执行此操作，并编写一个 t-sql 作业来获取，并且可能在您获取 id 的 snapshop 后插入。

# c++ - Visual Studio 6 VC++ 项目版本 - 我如何增加它？

> ID：443141
> 
> 赞同：1
> 
> 时间：2009-01-14T14:31:59.263
> 
> 标签：c++, versioning, increment, visual-studio-6

我正在对用 VC++6 编写的旧程序进行更改。项目资源包括一个“版本”集，其中包括以下内容： 块头 注释 公司名称 文件版本 产品版本

FileVersion 和 ProductVersion 都是 1.0.0.97（其中 97 是内部版本号，每次构建项目时都会递增）

我的更改是这样的，我应该增加其他数字之一。它可能应该到 1.0.1。但即使我可以编辑这些字符串，只要我构建项目，前三个数字就会恢复为 1.0.0。有谁知道这些数字真正保存在哪里以及如何更改它们？

这些数字和设置也进入可执行文件的“属性”。构建日期保存在“评论”资源字符串中，我认为这是废话，并希望自动生成它：我不会记得在每次构建之前检查它！

任何建议都非常感激。

--- 阿利斯泰尔。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T15:04:18.107

这些在 rc .file 中

打开资源编辑器并查看版本选项卡/部分。

如果您进行更改并保存它，那么它们应该保持这种状态。我会检查是否有任何其他任务或覆盖这些任务的东西。

请注意，其中一个字段（我忘记了）是另一个字段的“奴隶”。发布资源文件（或至少包含版本信息的部分）

您可以将#include 用于版本信息，以便您只有一个位置用于版本信息。

# c# - 限制对只读属性的方法调用的访问

> ID：443144
> 
> 赞同：3
> 
> 时间：2009-01-14T14:32:07.313
> 
> 标签：c#, properties, readonly

我有一个类，它定义了一个有效公开私有字段的只读属性，如下所示：

```
public class Container
{
    private List<int> _myList;

    public List<int> MyList
    {
        get { return _myList;}
    }

    public Container() : base ()
    {
        _myList = new List<int>();
    }

    // some method that need to access _myList
    public SomeMethod(int x)
    {
         _myList.Add(x);
    }
} 
```

现在消费者不可能直接管理我的财产，所以像 aContainer.MyList = new List(); 这样的代码 生成编译时错误。但是，消费者完全可以自由地调用他得到的引用的各种方法，所以这是完全有效的代码

```
Container c = new Container();  
Console.WriteLine(c.MyList.Count);  
c.MyList.Add(4);  
Console.WriteLine(c.MyList.Count); 
```

哪种破坏了整个只读概念。

是否有任何健全的解决方法可以让我拥有真正的只读参考属性？

PS我不能只返回列表的副本，因为这样用户会认为他做了所有必要的更改，但是唉......他们会消失的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-14T14:38:57.673

不要返回对您列表的直接引用。而是返回一个包裹在它周围的 ReadOnlyCollection，或者如果 List<> 返回类型一成不变，则返回列表的副本。他们可以在不影响原件的情况下对副本做任何他们想做的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T14:40:26.813

引用是["readonly"](http://msdn.microsoft.com/en-us/library/acdd6hb7(VS.71).aspx)，即实际对象。即你不能用另一个对象替换引用。因此，如果您有一个像这样破坏它的课程：

```
public class Container
{
    private readonly  List<int> _myList;

    public List<int> MyList
    {
        get { return _myList;}
    }

    public Container() : base ()
    {
        _myList = new List<int>();
    }

    public void BreakReadOnly()
    {
        _myList = new List<int>();
    }
} 
```

…然后它甚至不会编译。这是因为只读字段不能用任何其他对象重新分配。在这种情况下`BreakReadOnly`将尝试分配一个新列表。

如果你真的想要它的只读集合，那么你可以这样做：

```
 public ReadOnlyCollection<int> MyList
    {
        get { return _myList.AsReadOnly(); }
    } 
```

希望这可以帮助。

**更新**：删除了 IEnumerable 的使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T14:56:36.390

你可以像这样返回一个[只读集合](http://msdn.microsoft.com/en-us/library/e78dcd75.aspx)：

```
 public ReadOnlyCollection<int> MyList
    {
        get { return _myList.AsReadOnly(); }
    } 
```

或返回一个新列表，以便调用者可以在不更改原始列表的情况下更改列表。

```
 public List<int> MyList
    {
        get { return new List<int>(_myList)}
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T14:38:30.123

看看静态[Array.AsReadOnly()](http://msdn.microsoft.com/en-us/library/53kysx7b.aspx)方法，您可以使用它来返回一个数组的包装器，以防止它被修改。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T14:54:45.113

您希望 _myList，这是一个只读的引用类型。好吧，它是只读的，只读概念没有失败。

CLR 以这样一种方式为引用类型实现只读属性，即引用（如果需要，指向对象的指针）是只读的，而引用指向的对象可以修改。

要解决此问题，您需要将对象本身的成员字段设置为只读，因为您无法通过将只读标志附加到对象的引用来使整个对象变为只读。

您可以实现您的不可变泛型集合类，该类的行为方式与 List<> 对象相同，但具有只读成员。

# c++ - C ++在库之间混合新/删除？

> ID：443147
> 
> 赞同：15
> 
> 时间：2009-01-14T14:32:24.207
> 
> 标签：c++, libs

如果我`new`在我的库中使用关键字（它的构建方式与我的主应用程序不同），当我在我的主应用程序中使用 删除它时`delete`，是否有可能出现崩溃/错误？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-14T15:51:21.553

这取决于。如果您谈论的是静态库，那么您可能会没事——代码将在与主程序相同的上下文中运行，使用相同的 C++ 运行时库。这意味着`new`并且`delete`将使用相同的堆。

如果您谈论的是共享库（DLL），那么您可能不会好。在 DLL 中运行的代码可能使用不同的 C++ 运行时库，这意味着堆的布局会有所不同。DLL 可能完全使用不同的堆。

调用`delete`（在主程序中）由 DLL 分配的指针（反之亦然）将导致（最好的​​情况）立即崩溃或（最坏的情况）需要一段时间才能追踪的内存损坏。

你有几个选择。第一种是使用“工厂方法”模式来创建和删除这些对象：

```
Foo *CreateFoo();
void DeleteFoo(Foo *p); 
```

这些*不*应该在头文件中实现。

或者，您可以`Destroy`在对象上定义一个方法：

```
class Foo
{
    ~Foo();

public:
    virtual void Destroy();
}; 
```

...再次，不要在头文件中实现它。你会这样实现它：

```
void Foo::Destroy()
{
    delete this;
    // don't do anything that accesses this object past this point.
} 
```

请注意， Foo 的析构函数是私有的，因此您必须调用`Foo::Destroy`.

Microsoft COM 做了类似的事情，它定义了一个`Release`方法，当对象的引用计数降至零时删除该对象。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-14T14:40:44.783

是的。特别是，您会看到调试/发布堆不同的问题，如果您的库使用新放置或任何自定义堆，您也会遇到问题。调试/发布问题是迄今为止最常见的问题。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-14T14:54:29.857

是的你将会。一个简单的解决方案是在您的库中提供可从主应用程序调用的 Create 和 Delete 函数。Create 函数将执行 new 并返回一个指针，该指针稍后将传递给 Delete 函数进行删除。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-14T16:39:18.133

这是我只在 Windows 上看到的问题。

Unixish 系统不习惯强制共享库链接到同一程序中同一库的不同版本，并且所有加载的符号都是全局可见的。这意味着如果一个对象在代码的一部分中分配并在另一部分中删除，则两者都使用相同的系统库来执行此操作。

我不得不说，Windows 使用其各种 C 运行时 DLL 创建的这个问题对于 C 程序员来说确实很烦人且不自然。查看 C 库；它具有类似 strdup 的函数，可以对字符串进行 malloc 并期望程序员对其调用 free() 。但是在你自己的 Windows 库中做同样的事情，然后等待爆炸。您也必须等待，因为它不会在开发过程中发生，但只有在您将已编译的 DLL 提供给其他一些可怜的 sap 之后才会发生。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-14T21:31:16.407

[Old New Thing](http://blogs.msdn.com/oldnewthing/archive/2006/09/15/755966.aspx)之前已经介绍过这一点。他还列出了微软的主要解决方案。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-14T16:22:53.440

你说得对，那里有问题，但在大多数情况下，有一个比其他答案（到目前为止）提出的更简单的解决方案。您可以继续自由地使用 new 和 delete —— 您需要做的就是为库中可能跨 DLL 边界使用的每个类重载 new 和 delete。

就个人而言，我只是定义了一个简单的类来提供所需的功能：

```
class NewDelete
{
    public:
        void *operator new (size_t size);
        void operator delete (void *memory);
        void *operator new (size_t size, void *ptr);
        void operator delete (void *memory, void *ptr);
}; 
```

只要这四个成员函数都定义在同一个 DLL 中，那么从这个类派生的任何类都自动是“DLL 安全的”——new 和 delete 可以在它们上正常使用，而不必担心 DLL 边界。

# java - 对 Java 安全性和 BouncyCastle API 感到茫然和困惑

> ID：443151
> 
> 赞同：11
> 
> 时间：2009-01-14T14:33:19.200
> 
> 标签：java, cryptography, rsa, bouncycastle, jce

我一直在尝试理解 Java 的 BouncyCastle 加密 API。不幸的是，我发现 Java 密码学通常被服务提供者接口和行话所掩盖，以至于我无法理解任何实际所做的事情。我已经尝试反复阅读必要的文档，但它仍然难以理解，引入了许多远远超出我*认为*应该需要的概念。

我真正想要的是一个执行以下操作的类：

```
public class KeyPair {
    public byte[] public;
    public byte[] private;
}

public class RSACrypto {
    public static KeyPair generateRSAKeyPair() { /*implementation*/}
    public static byte[] encrypt(byte[] data, byte[] publicKey) { /*impl*/}
    public static byte[] decrypt(byte[] encryptedData, byte[] privateKey) { /*impl*/ }
} 
```

抱歉，如果这是一个非常复杂的问题，可以作为“我真正想要的”提出。非常欢迎任何关于在哪里阅读 Java 密码学和 BouncyCastle 的指针。任何关于 Java 加密系统实际布局的概述都非常受欢迎。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-15T23:19:15.953

```
import java.security.GeneralSecurityException;
import java.security.KeyPair;
import java.security.KeyPairGenerator;
import java.security.PrivateKey;
import java.security.PublicKey;

import javax.crypto.Cipher;

public class RSACrypto
{

  /* A 1024-bit key will encrypt messages up to 117 bytes long. */
  private static final int KEY_SIZE = 1024;

  private static final String XFORM = 
    "RSA/ECB/OAEPWITHSHA-256ANDMGF1PADDING";

  public static KeyPair generateRSAKeyPair()
    throws GeneralSecurityException
  {
    KeyPairGenerator gen = KeyPairGenerator.getInstance("RSA");
    gen.initialize(KEY_SIZE);
    return gen.generateKeyPair();
  }

  public static byte[] encrypt(byte[] plaintext, PublicKey pub)
    throws GeneralSecurityException
  {
    Cipher cipher = Cipher.getInstance(XFORM);
    cipher.init(Cipher.ENCRYPT_MODE, pub);
    return cipher.doFinal(plaintext);
  }

  public static byte[] decrypt(byte[] ciphertext, PrivateKey pvt)
    throws GeneralSecurityException
  {
    Cipher cipher = Cipher.getInstance(XFORM);
    cipher.init(Cipher.DECRYPT_MODE, pvt);
    return cipher.doFinal(ciphertext);
  }

  public static void main(String... argv)
    throws Exception
  {
    KeyPair pair = RSACrypto.generateRSAKeyPair();
    byte[] plaintext = "A short secret message.".getBytes("UTF-8");
    byte[] ciphertext = RSACrypto.encrypt(plaintext, pair.getPublic());
    byte[] recovered = RSACrypto.decrypt(ciphertext, pair.getPrivate());
    System.out.println(new String(recovered, "UTF-8"));
  }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T14:56:25.173

嗯，你试过[O'Reilly 的 Java Cryptography 书](https://rads.stackoverflow.com/amzn/click/com/1565924029)吗？（不能亲自担保）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-08T21:20:18.847

```
import java.security.GeneralSecurityException;
import java.security.KeyFactory;
import java.security.KeyPairGenerator;
import java.security.PublicKey;
import java.security.interfaces.RSAPrivateKey;
import java.security.spec.PKCS8EncodedKeySpec;
import java.security.spec.X509EncodedKeySpec;

import javax.crypto.Cipher;

public class RsaCrypto {

    private static final int KEY_SIZE = 3072;
    private static final String TRANSFORMATION = "RSA/ECB/OAEPWITHSHA-256ANDMGF1PADDING";

    public static KeyPair generateRSAKeyPair() {
        try {
            KeyPairGenerator gen = KeyPairGenerator.getInstance("RSA");
            gen.initialize(KEY_SIZE);
            java.security.KeyPair p = gen.generateKeyPair();
            KeyPair pair = new KeyPair();
            pair.privateKey = p.getPrivate().getEncoded();
            pair.publicKey = p.getPublic().getEncoded();
            return pair;
        } catch (GeneralSecurityException e) {
            throw new RuntimeException(e);
        }

    }

    public static byte[] encrypt(byte[] data, byte[] publicKey) {
        X509EncodedKeySpec publicKeySpec = new X509EncodedKeySpec(publicKey);
        try {
            KeyFactory kf = KeyFactory.getInstance("RSA");
            PublicKey pk = kf.generatePublic(publicKeySpec);
            Cipher rsa = Cipher.getInstance(TRANSFORMATION);
            rsa.init(Cipher.ENCRYPT_MODE, pk);
            return rsa.doFinal(data);
        } catch (GeneralSecurityException e) {
            throw new RuntimeException(e);
        }
    }

    public static byte[] decrypt(byte[] encryptedData, byte[] privateKey) {
        try {
            PKCS8EncodedKeySpec privSpec = new PKCS8EncodedKeySpec(privateKey);
            RSAPrivateKey pk = (RSAPrivateKey) KeyFactory.getInstance("RSA")
                    .generatePrivate(privSpec);

            Cipher rsaCipher = Cipher.getInstance(TRANSFORMATION);
            rsaCipher.init(Cipher.DECRYPT_MODE, pk);
            return rsaCipher.doFinal(encryptedData);

        } catch (GeneralSecurityException e) {
            throw new RuntimeException(e);
        }
    }

} 
```

# ruby - 在运行时获取/设置 Ruby 方法元数据的最佳策略是什么？

> ID：443152
> 
> 赞同：2
> 
> 时间：2009-01-14T14:33:21.040
> 
> 标签：ruby, extension-methods, metaprogramming, metadata

我有一堂有一些方法的课。这是超级秘密，但我已经在这里复制了我能做到的。

```
Class RayGun
  # flashes red light
  # requires confirmation
  # makes "zowowowowowow" sound
  def stun!
    # ...
  end

  # flashes blue light
  # does not require confirmation
  # makes "trrrtrtrtrrtrtrtrtrtrtr" sound
  def freeze!
    # ...
  end

  # doesn't flash any lights
  # does not require confirmation
  # makes Windows startup sound
  def killoblast!
    # ...
  end
end 
```

我希望能够在运行时向类询问其中一种方法并接收哈希或结构，如下所示：

```
 {:lights => 'red', :confirmation => false, :sound => 'windows'} 
```

这样做的最佳方法是什么？显然，您可以将单独的 YAML 文件放在旁边并设置一个约定来将两者联系起来，但理想情况下，我希望将代码和元数据放在一个地方。

我能想到的最有前途的想法是这样的：

```
class RayGun
  cattr_accessor :metadata
  def self.register_method(hsh)
    define_method(hsh.name, hsh.block)
    metadata[hsh[:name]] = hsh
  end

  register_method({
    :name => 'stun!', 
    :lights => 'red', 
    :confirmation => 'true', 
    :sound => 'zowowo',
    :block => Proc.new do
      # code goes here
   })

   # etc.
end 
```

有人有更好的想法吗？我在吠叫一棵非常错误的树吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T16:57:36.740

只是一点美化：

```
class RayGun
  cattr_accessor :metadata
  def self.register_method(name, hsh, &block)
    define_method(name, block)
    metadata[name] = hsh
  end

  register_method( 'stun!',
    :lights => 'red', 
    :confirmation => 'true', 
    :sound => 'zowowo',
    ) do
      # code goes here
  end

   # etc.
end 
```

您确实无法轻松访问原始闭包，但可能不需要它。

要回答这个问题，它看起来还不错，您可以做一些更传统但可能足够好的事情：

```
class RayGun
  cattr_accessor :metadata

  @metadata[:stun!] = {:lights => 'red', 
                        :confirmation => 'true', 
                        :sound => 'zowowo'}
  def stun!
    # ...
  end

   # etc.
end 
```

在原始示例中， register_method 是公共的，如果您打算以这种方式使用它，那么第二个选项变得不太有用，因为它不能确保一致性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-26T14:43:36.153

[我在http://github.com/wycats/thor/tree](http://github.com/wycats/thor/tree)周围发现了另一种策略。Thor 允许你写这样的东西：

```
Class RayGun < Thor
  desc "Flashes red light and makes zowowowowow sound"
  method_options :confirmation => :required
  def stun!
    # ...
  end
end 
```

它通过使用（未记录的）钩子来管理它`Module#method_added`。它是这样工作的：

1.  调用`Thor#desc`并 `Thor#method_options`设置实例变量`@desc`, `@method_options`.

2.  定义方法`stun!`调用 `Thor#method_added(meth)`

3.  `Thor#method_added`注册 `Task.new(meth.to_s, @desc, @method_options)`（粗略地说）和取消设置`@desc`, `@method_options`.

4.  现在已经为下一个方法做好了准备

整洁的！如此整洁，我将接受我自己的答案:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T16:58:30.623

[YARD](http://github.com/lsegal/yard/tree/master)工具可让您将元数据添加到方法中。我很确定它只是将元数据粘贴到`rdoc`您生成的文件中，但是您可以轻松地以此为基础来获取运行时信息。

# sql-server-2005 - SQL Server 2005 性能和空白

> ID：443153
> 
> 赞同：0
> 
> 时间：2009-01-14T14:33:26.547
> 
> 标签：sql-server-2005, performance

有人告诉我，我不确定我是否相信这一点：在我提交它们之前，从我在 sql server 2005 中的存储过程中删除空格，将使它们运行得更快并提高性能。我想知道其他人是怎么想的？

谢谢，

斯科特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T14:37:38.130

我看不出会是这样。也许存储过程会编译得稍微快一些，但在那之后它应该没有任何区别。

更重要的是，即使这是真的，我也无法想象花费在删除空格上的时间会值得您获得任何性能优势。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T14:35:04.983

如果不对其进行基准测试，我无法“知道”，但这听起来很牛。

首先，我很确定 SQLServer 会编译存储过程（意思是，它的冗长程度绝对不会影响它）。其次，在任何系统中解析空白都是很简单的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T14:37:41.467

我称之为恶作剧。这甚至没有通过气味测试。sprocs 被编译，SQL Server 使用的是从您的 sproc 创建的计划 - 空白是无关紧要的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-07-19T20:49:24.777

是和不是。事实证明，您可以有两个查询，除了空白之外相同，它们在 SQL Server 上以不同的速度运行。如果我没有亲眼看到它，我不会相信这一点，但是这确实出现在我的工作中（在 sql server 2008 上），经过大量测试、拉扯头发和否认，我不得不承认它正在发生。这是另一个遇到相同问题的人的示例：

[SQL Server 2008 R2 中的空间会降低性能](https://stackoverflow.com/questions/6363970/space-in-sql-server-2008-r2-slows-down-performance)

现在是答案的“否”部分。我们有很多带有很多空白的查询，而这正是我所知道的一次。这根本不是加速查询的标准方法，只是碰巧有一个非常奇怪的边缘情况。我不会花任何时间从存储过程中删除空白，它几乎永远不会有帮助。几乎。

# c# - 以编程方式（在 c# 中）在页面上调用 Javascript，然后将其提交回服务器

> ID：443163
> 
> 赞同：1
> 
> 时间：2009-01-14T14:35:04.390
> 
> 标签：c#, javascript

我需要请求一个页面（我目前正在使用 httpwebrequest），调用一些 javascript（例如

功能选择（id）{document.getElementById（“选择”）。值= id；}

然后将其提交回服务器。. . 这可能吗？

**编辑**

抱歉含糊不清。

我试图与之交互的页面已经 100% 工作，我需要做的就是找到一种方法来欺骗服务器认为有人已经加载了页面，导致运行了一段 jScript，然后提交它回到服务器，就像一个假用户。我目前正在尝试在 winForm 上使用嵌入式 webBrowser，这样做最简单，因为等待被告知何时发出此请求的代码已经编写好了，它只需要能够模拟 squishy不在中间的人类。

如果你不知道我目前正在学习 javascript，所以如果我不太确定基本的东西，请原谅我 ^_^

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T14:51:39.817

如果您使用 HttpWebRequest 将“页面”（或其他资源）从 Web 拉到您的 C# 应用程序中，那么您实际上是将页面作为字符串处理。您实际上并没有执行 JavaScript 的上下文……没有 DOM 或 JavaScript 引擎，除非您有浏览器来为您提供这些东西。对于更简单的解决方案，我会问是否有一种方法可以通过直接将此页面作为 C# 中的纯文本使用来获得您正在寻找的相同功能？在你的例子中（我猜这是你想要做的一个非常简化的例子），你正在寻找一个 DOM 元素的值。您可以使用字符串或正则表达式函数来获取此类信息。如果您只想从正在下载的资源中提取文本信息，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T14:43:35.573

我知道的唯一方法是将 AJAX 实现到您的网页中。我们确实需要更多地了解它才能了解如何做到这一点，但这应该不是那么困难。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T14:45:35.837

你要提交表格吗？获取，发布？

如果你是，只需将它所期望的表单数据返回给服务器。无需操作 UI。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T14:47:56.720

这很难。由于您以 html 文本形式获得结果，假设您以某种方式在该 html 页面中找到要执行的 js 代码，没有可以解释您的 js 代码的机制。

也许您应该考虑在您的应用程序中使用 ie 浏览器组件。

但是，如果您只想发回特定数据，那很容易；只需在请求页面时设置发布和获取变量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T14:51:27.883

[Prototype](http://www.sergiopereira.com/articles/prototype.js.html) JavaScript 库有一个[evalScripts](http://www.sergiopereira.com/articles/prototype.js.html#Ajax.options)选项，允许执行响应中的 JavaScript 。它有局限性，但它可能会有所帮助。

# eclipse - 从 Eclipse 搜索中排除文件夹

> ID：443169
> 
> 赞同：271
> 
> 时间：2009-01-14T14:35:55.323
> 
> 标签：eclipse, search

有没有办法从 Eclipse 中的搜索中排除某些文件夹（及其所有子文件夹）？

* * *

## 回答 #1

> 赞同：297
> 
> 时间：2009-01-14T14:38:18.377

**快速而肮脏的方式：**

右键单击文件夹，转到属性，然后将文件夹标记为派生。默认情况下，派生实体被排除在搜索之外。*这种方法的问题在于，如果您删除该文件夹*（从 Eclipse 内部或外部，然后刷新项目树），Eclipse 会“忘记”该文件夹是派生的。就像 Eclipse 一样，这是一个[长期存在的错误](https://bugs.eclipse.org/bugs/show_bug.cgi?id=154089)（在这种情况下是 10 年），它仍然适用于当前版本（撰写本文时为 4.6 Neon）。

**安全的方法：**

创建一个工作集，其中仅包含您要搜索的那些实体，并仅在该工作集中进行搜索。有关此过程的详细信息，请参阅[Dave Ray 的回答](https://stackoverflow.com/a/443220/25050)。

* * *

## 回答 #2

> 赞同：253
> 
> 时间：2011-05-24T13:14:38.453

这对我有用（我正在使用 Helios - 当最初提出这个问题时，也许这种方式不可用？）

*   转到项目 -> 属性 -> 资源过滤器。
*   单击*添加*。
*   选择*过滤器类型*：*排除所有*
*   选择*适用于*：*文件夹*；检查*所有孩子（递归）*。
*   在 Attributes 中，选择*Name*、*Matches*，`.svn`（例如）。

（实际上，我是`.*`用来一次性过滤掉 .svn、.hg 等的。）

确定项目属性对话框后，这些目录将不再出现在搜索中。事实上，Eclipse 非常友好，可以自动更新*现有的*搜索结果窗口并删除所有现在被过滤掉的匹配项。

* * *

## 回答 #3

> 赞同：85
> 
> 时间：2009-01-14T14:47:59.840

我可以想象，标记资源派生可能会导致其他领域出现问题。相反，使用要包含在搜索中的文件夹创建一个工作集：

*   打开搜索对话框 ( `Ctrl`+ `H`)
*   将搜索范围更改为工作集
*   点击选择...
*   单击“新建”以使用您要搜索的内容创建一个新的工作集（或“全部添加”，然后删除您要过滤的内容

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-04-26T13:41:25.207

*   右键单击您的项目
*   选择`Properties`
*   选择`Resource`->`Resource filters`
*   点击`Add filter`
*   选择以下设置：
    *   排除所有
    *   文件和文件夹
    *   所有孩子（递归）
*   更改`Name`为`Project Relative Path`
*   `(bin$|bin/.*|build/.*|build$)`用（替换`bin`和`build`您要排除的文件夹的名称）填充输入文本
*   打钩`Regular expression`

点击确定，然后应用。

## 免责声明

这建立在@atzz 的回答之上，它帮助我解决了这个问题。但是，虽然它确实回答了如何排除某些文件的问题，但没有回答如何排除某些文件夹的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-14T16:19:46.830

**Eclipse Juno 中最好的快速和肮脏的方式：**

1.  右键单击**文件夹**。
2.  转到属性。
3.  转到 C/C++ 构建。
4.  选中“从构建中排除资源”。
5.  单击确定按钮。
6.  右键单击**项目**。
7.  转到索引。
8.  单击重建。
9.  放松！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-03-12T03:11:54.723

排除在 Eclipse 中搜索的文件夹或文件

```
1 Right-click on the file/folder.
3 Click on the "Properties" option.
4 Select the "Resource" option.
5 Place a check next to the "Derived" attribute. 
```

希望是帮助。

# c# - MethodInfo 用于 EntityCollection 而不是 Queryable

> ID：443170
> 
> 赞同：0
> 
> 时间：2009-01-14T14:36:13.500
> 
> 标签：c#, linq, entity-framework, reflection, lambda

我正在手动创建等效的 lambda：

```
var function = p => p.Child.Any(c => c.Field == "value"); 
```

我有一个 MethodInfo 引用，它与内置代码中的表达式一起使用的“任何”方法。

```
MethodInfo method = typeof(Queryable).GetMethods()
        .Where(m => m.Name == "Any" && m.GetParameters().Length == 2)
        .Single().MakeGenericMethod(typeof(Child)); 
```

我的实体是：父母 1---* 孩子

Child 是 Parent 上的导航属性（上述 lambda 中的 p）。属性的类型是设计者创建的 EntityCollection。

我正在寻找正确的方法来引用 Any 方法来创建该调用。Marc 给了我如何在这里得到这个的答案：[Calling a Method from an Expression](https://stackoverflow.com/questions/439172/calling-a-method-from-an-expression)

但它不适用于实体框架。EntityCollection 没有实现 IQueryable，那么 Any 方法应该如何被引用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-14T14:44:14.747

`EntityCollection<T>`没有实现`IQueryable<T>`，所以这不起作用并不奇怪，IMO。

您能否对您正在尝试做的事情进行更多解释？如果您希望查询在数据库上运行，我的猜测是它真的不会支持它（假设它`EntityCollection<T>`没有实现`IQueryable<T>`）。如果您希望查询在本地运行，您应该使用 Enumerable.Any 而不是 Queryably.Any。

编辑：看到更新的集合后，我相信您只想要 Enumerable.Any 而不是 Queryable.Any。不要忘记，如果这是作为表达式树提供的，那么无论如何您实际上都不会*执行*该代码。大概框架理解 Enumerable.Any 应用于`EntityCollection<T>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-03T03:35:00.797

您可以使用 AsQueryable() 扩展方法将 EntityCollection 转换为 IQueryable。

# linux - Bash 文本解析高尔夫

> ID：443185
> 
> 赞同：0
> 
> 时间：2009-01-14T14:39:18.797
> 
> 标签：linux, svn, bash, code-golf

我正在编写一个 shell 脚本来确定最后一次在 subversion 存储库中创建分支的时间。以下代码有效：

```
 DEV='http://some/svn/server/'
        BRANCH='some/repos/branches/'
        LAST_UPDATE=`svn list http://$DEV$BRANCH | sort -r`
        LAST_UPDATE=${LAST_UPDATE:0:10} 

```

但我不喜欢最后两行。我怎样才能将它们结合在一起？

```
笔记：

`svn 列表 http://some/svn/server | 排序-r`
将返回一个文件夹列表，例如：
2009-01-12/
2009-01-11/
...
2009-01-01/

```

我只是想删除斜杠

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T14:41:28.870

怎么样：

```
 LAST_UPDATE=`svn list http://$DEV$BRANCH | sort -r | awk -F\/ '{print $1}'` 
```

我没有测试过它，我不确定反引号内的引号是否会导致任何问题，但否则我看不出它为什么不起作用......

本

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T21:58:43.417

另一个也许更强有力的建议是使用`basename`：

```
LAST_UPDATE=`svn list http://$DEV$BRANCH | sort -r | xargs -i basename {}` 
```

关键优势在于`basename`了解路径语法，并且无论您向其抛出什么奇怪的文件名，都会产生规范的表示。

# iphone - Running Apple Store Apps on iPhone simulator?

> ID：443186
> 
> 赞同：19
> 
> 时间：2009-01-14T14:39:28.953
> 
> 标签：iphone, ios-simulator

Can i run download applications from Apple Store on iPhone simulator?

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-01-17T07:46:10.933

No, you cannot, because the App Store apps are compiled for the iPhone (ARM), not the simulator (x86). Sorry.

# ruby-on-rails - 在具有单表继承的 Rails 应用程序中使用 memcached？

> ID：443187
> 
> 赞同：1
> 
> 时间：2009-01-14T14:39:32.820
> 
> 标签：ruby-on-rails, memcached, single-table-inheritance

我有一个使用 STI 处理不同类型用户的 Rails 应用程序，例如：

```
class Admin < User
  ...
end 
```

我想使用 memcached，但我不断收到可怕的“未知类/模块”错误。我已经尝试预加载我*所有*的 ActiveRecord 模型，但无济于事。第一个请求正常工作，但第一个从 memcached 错误中提取出来。我也按照[这些说明](http://casey0.com/archive/2007/January/cached_model_and_single_table_inheritance.html)无济于事。

单表继承是否可以使用 memcached？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T14:46:25.320

我认为这是由于类的[延迟加载](http://en.wikipedia.org/wiki/Lazy_loading)。当您从 memcached 调用它时，未加载类定义，然后您会收到错误消息。

我使用的解决方法是：

```
Admin #lazily load the class definition

# do whatever that has cached Admins 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T15:14:27.977

问题是在上述 before_filter 运行之前，restful_authentication 的 login_from_session 方法被加载了。在此方法的顶部预加载 STI 用户类有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-23T19:15:28.967

只是一个简短的评论，我读过现在首选使用 require_dependency 'admin'，不知道为什么

```
require_dependency 'region' 
```

另外，我发现如果您添加，这是不必要的

```
config.cache_classes = true 
```

到您的 production.rb （或 development.rb 用于测试），这似乎捕获了所有用于缓存的模型

# msbuild - 读取 dll 版本的 MSBuild 任务

> ID：443188
> 
> 赞同：18
> 
> 时间：2009-01-14T14:39:37.250
> 
> 标签：msbuild

我正在寻找一个 MSBuild 任务，它会告诉我特定 dll 的版本。有没有可用的任务？

在我的情况下，dll 是一个 .Net 程序集，所以我实际上是在寻找 Assembly.FullName。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-14T14:46:22.510

[GetAssemblyIdentity](http://msdn.microsoft.com/en-us/library/ms164296.aspx)是你的人。此任务输出包含名为 Version、PublicKeyToken 和 Culture 的项目元数据条目。

```
<ItemGroup>
    <MyAssemblies Include="File1.dll;File2.dll" />
</ItemGroup>

<Target Name="RetrieveIdentities>
    <GetAssemblyIdentity
        AssemblyFiles="@(MyAssemblies)">
        <Output
            TaskParameter="Assemblies"
            ItemName="MyAssemblyIdentities"/>
    </GetAssemblyIdentity>
</Target> 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-01-14T15:27:11.133

谢谢疯子！我想我会分享工作代码。

```
<Target Name="UpdateWebConfigVersion">
    <GetAssemblyIdentity AssemblyFiles="lib\foo.dll">
        <Output TaskParameter="Assemblies" ItemName="fooAssemblyInfo"/>
    </GetAssemblyIdentity>
    <XmlUpdate XmlFileName="src\Web\ServiceModel.Extensions.config"
            XPath="//extensions/behaviorExtensions/add[@name='silverlightFaults']/@type"
            Value="foo.ServiceModel.Extensions.Behaviors.SilverlightFaultBehavior, foo, Version=%(fooAssemblyInfo.Version), Culture=neutral, PublicKeyToken=XXXXXXXX"/>
</Target> 
```

# asp.net-mvc - ASP.NET MVC 视图中允许多少逻辑？

> ID：443193
> 
> 赞同：35
> 
> 时间：2009-01-14T14:40:49.387
> 
> 标签：asp.net-mvc, views

在查看 ASP.NET MVC 站点的示例时，我看到了很多在视图中嵌入逻辑的示例，例如：

```
<% if (customerIsAllowed)
   { %>

   <p>nnn</p>
   <p>nnn</p>
   <p>nnn</p>
   <p>nnn</p>
   <p>nnn</p>

<% }  else {%>

   <p>nnn</p>
   <p>nnn</p>
   <p>nnn</p>
   <p>nnn</p>
   <p>nnn</p>

<% } %> 
```

尽管这对我来说似乎是错误的，因为这是我们在 ASP 3.0 中试图摆脱的那种事情，但我什至在一些播客中听说，自从 MVC 框架的其余部分以来，“一点点逻辑就可以了”正在处理我们在 ASP 3.0 中没有的结构。

是否有任何 MVC 约定指定视图中允许的逻辑类型和数量？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-01-14T14:46:32.683

这取决于逻辑的原因。如果逻辑基于控制器传递给它的某些属性选择替代表示，则可能没问题。这允许您重用一些视图。不必为每个自定义权限重新创建（和重复）整个视图，您可以传入一些数据，允许基于此权限自定义视图。

我认为这是理想化的 MVC 和严格执行 DRY 之间的务实平衡（不要重复自己）。在某些情况下，如果您不能轻松实现两者，那么违反其中一个或另一个是更明智的做法。在明确模型和基本视图相同的情况下，在视图中添加一点逻辑以保持视图 DRY 是合理的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T03:00:11.250

如果逻辑与视图的格式有关，并且不会导致实体或数据的更改，那么我认为在视图中是可以的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-15T03:04:00.040

42.

只是在开玩笑 ：-）

对此没有固定的答案，尽管良好的关注点分离是一种普遍接受的最佳实践。围绕这个问题的争论可能是无止境的，知道为你的特定项目做正确的方法会带来我认为的经验，并且能够注意到“代码异味”或感觉不正确的事情。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T15:17:49.653

这是另一种思考方式。表示逻辑进入视图。业务处理逻辑进入控制器，数据验证进入模型。但是最终应该是指导而不是宗教：）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-15T09:22:37.267

只要视图中的逻辑用于演示（如果您不喜欢标记文件中的代码，可以将其放入代码隐藏文件中），就可以了。在您的示例中，代码/逻辑用于选择一个可以的视图部分。演示文稿可以有逻辑，它不需要是简单的 HTML。

# excel - 在国际范围内将多行 csv 文件导入 Excel

> ID：443204
> 
> 赞同：5
> 
> 时间：2009-01-14T14:44:17.273
> 
> 标签：excel, csv

有一个 .csv 文件我们想分发给我们的客户，它包含多行条目（即带有换行符的条目）。根据客户的语言设置，文件可能会或可能不会正确导入 Excel。通常，我们建议使用 导入文件，但多行条目似乎存在一些错误，因此它们会“分解”成单独的行（奇怪的是，直接打开文件时不会发生这种情况）。

对于某些语言（例如英语），可以正确打开带有逗号的 csv，但不能正确打开带有分号的文件。对于其他语言（例如德语），可以直接打开带有分号的 csv，但不能打开带有逗号的文件。

导入对多行条目没有帮助。

示例 csv 文件（2 个 csv 行）：

```
A; B; "some
stuff"; C;
1; 2; "another line"; 3; 
```

正确导入（2 行多行条目）：

```
A B (some
stuff) C
1 2 (another line) 3 
```

错误的导入（3 行）：

```
A; B; C; "some
stuff";D;
1; 2; "another line"; 3; 
```

还有另一种干预的可能性 - 选择一列并在数据下按文本到列。这会根据分隔符整齐地拆分行，但仍然没有绕过换行符。

是否可以导入 csv 文件，以便始终识别多行条目？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-12-01T17:40:27.740

您可能会发现它在 openoffice 中可以正常打开。我做到了。

在这种情况下，您可以将其保存为 Excel 表格，并将这两个文件分发给您的客户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T04:27:47.993

您的问题不太清楚，但我认为这就是您想要的： 注意：由于某种原因，错误捕获部分没有正确粘贴。对不起

```
Public Sub ReadCSV()
'' Assumes all records:
''   Have 5 fields
''   The fields are delimited by a ;
''   The Last field ends in a ;

Dim FileName As String
Dim ExcelRow As Long
Dim WorkSheetName As String
Dim FieldValue(5) As String
Dim FieldNo As Integer
Dim StringPosition As Integer
Dim LineFromFile As String
Dim CharFromLine As String

WorkSheetName = "Sheet1"
ExcelRow = 2  '' Assumes Row 1 is a heading that you should not delete

''   Get the FileName and Open the file
If Application.FileDialog(msoFileDialogOpen).Show <> -1 Then Exit Sub
FileName = Application.FileDialog(msoFileDialogOpen).SelectedItems(1)

On Error GoTo OpenError
Open FileName For Input As #1

''   Clear old data from the workbook
sRange = WorkSheetName + "!A2:E65536"
Range(sRange).ClearContents '' Preserves formatting

''   Read The file one line at a time
On Error GoTo ReadError
While Not EOF(1)
    Line Input #1, LineFromFile
    Debug.Print LineFromFile
    FieldNo = 1
    While FieldNo <= 5  '' 5 is the number of fields in a record
        DoEvents
        FieldValue(FieldNo) = ""
        StringPosition = 1
        ''   Examine each character from the line
        While StringPosition <= Len(LineFromFile)
            CharFromLine = Mid(LineFromFile, StringPosition, 1)
            If CharFromLine = ";" Then '' ";" is the delimitor in the delimited file
                FieldNo = FieldNo + 1
                If FieldNo < 6 Then FieldValue(FieldNo) = ""
            Else
                FieldValue(FieldNo) = FieldValue(FieldNo) + CharFromLine
            End If
            ''   Test to see if we're at the end of a line, but haven't got all the fields yet
            If StringPosition = Len(LineFromFile) And FieldNo < 6 Then
                FieldValue(FieldNo) = FieldValue(FieldNo) + Chr(10) ''   Add a LineFeed to represent the new line
                Line Input #1, LineFromFile
                StringPosition = 0
            End If
            StringPosition = StringPosition + 1
        Wend
    Wend
    ''   Put the Data in the Workbook
    For FieldNo = 1 To 5
        Sheets(WorkSheetName).Cells(ExcelRow, FieldNo).Value = FieldValue(FieldNo)
    Next FieldNo
    ExcelRow = ExcelRow + 1
Wend
Exit Sub
OpenError:
    Call MsgBox("Error Opening File:" + FileName, vbCritical, "File Open Error")
    Exit Sub
ReadError:
    Call MsgBox("Error Reading File:" + FileName, vbCritical, "File Read Error")
End Sub 
```

# c# - 使用 MSMQ 或 WCF - VS 2008

> ID：443205
> 
> 赞同：0
> 
> 时间：2009-01-14T14:44:50.813
> 
> 标签：c#

这是我的情况： 1\. 有一个依赖于通过 FTP 提供的 XML 的现有应用程序。基于 XML，应用程序执行任务。

2.  现在我想下载文件，路径是 XML 文件的一个元素，使用 BITS

3.  我想创建一个 BITS 应用程序，当第 1 步中的应用程序向 BITS 应用程序发送消息时，它应该在项目的下载方面起作用。

第 1 步中的应用程序在 VS-2003 中，一个版本在 VS-2005 中。我想在 VS-2008 中创建我的 BITS 应用程序，如果我不能使用 BITS，那么我会使用 curlHTTP 来执行 HTTP GET。这 ？我是否使用 MSQM 或 WCF 在步骤 1 中的应用程序和我的下载应用程序之间发送消息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T15:39:30.593

WCF 具有对 MSMQ 队列的本机支持。

有两种类型的绑定可能适用于您的情况......

NetMSMQBinding：http: [//msdn.microsoft.com/en-us/library/system.servicemodel.netmsmqbinding.aspx](http://msdn.microsoft.com/en-us/library/system.servicemodel.netmsmqbinding.aspx)

MSMQIntegrationBinding：http: [//msdn.microsoft.com/en-us/library/system.servicemodel.msmqintegration.msmqintegrationbinding.aspx](http://msdn.microsoft.com/en-us/library/system.servicemodel.msmqintegration.msmqintegrationbinding.aspx)

使用这些绑定，您应该能够直接与 MSMQ 队列通信。

因此，我认为这不是 WCF 的非此即彼的情况。您要么需要 MSMQ，要么不需要。

（WCF 非常强大，但很难掌握。目前我正在编写自己的框架，用于在 Windows 服务中自托管 WCF 服务。）

# sql - SQL 中不同度量单位之间的转换（在 Access 中）

> ID：443210
> 
> 赞同：0
> 
> 时间：2009-01-14T14:46:21.450
> 
> 标签：sql, ms-access, units-of-measurement

我正在尝试编写一个访问数据库，但我使用 SQL 进行所有查询。我的数据库几乎完成了，但我有一个让我难过的查询。它是一个包含食谱的数据库。我有一张桌子，里面有烹饪的所有转换（汤匙到茶匙，茶匙到杯子等）。用户需要能够使用配方要求的任何单位放入成分（换句话说，我无法标准化单位，我必须找到它们是什么）。然后我需要能够将这些转换为标准化单位。这就是我遇到问题的地方，因为蔬菜之类的东西可以装在杯子，汤匙等中，而肉类之类的东西则以盎司，磅等为单位。我想避免创建一堆 vb if/then's。我觉得必须有一种方法可以用 SQL 来做到这一点，但我可以'

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-14T14:58:55.497

我会以不同的方式思考这个问题。您有不同类型的度量（体积、重量、计数等）。这些措施中的每一个都有不同的可转换单位。选择度量（例如盎司），同时选择度量类型和特定单位。我有一种在相同度量类型的单位之间进行转换的方法——以支持调整配方的大小——但我不担心在不同的度量类型之间进行转换。

知道类型后，您可以根据该度量类型的基本单位将所有值存储在数据库中。根据该值，也许还有用户偏好，您可以在显示时将其转换为合适的显示单元。我认为这在 SQL 中不会特别容易做到，而且我不会害怕在代码中进行转换。您只需要为每种度量类型选择合适的单位并进行转换的不同显示格式器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T14:53:09.347

我认为烹饪你必须分开两种不同类型的单位

1.  按重量
2.  按体积

您无法将这些单位标准化，或者知道您需要 2 杯满足有什么意义？

然后，当您区分这两种不同类型的单位时，您可以将它们标准化为两个单位。也许：

1.  杯子，茶匙，...单位为毫升
2.  肉、蔬菜……以克或磅为单位，或其他

如果它们都具有相同的基数，那么您就可以比较它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T14:12:20.783

我得到它来提取一条记录的转换因子。我只是通过查询来完成的。我基本上查找一列和一行（使用sql，列名和行名是可变的），该值就是我需要乘以的值。但是，众所周知，您永远不会只使用 sql 中的一条记录。关于如何扩展它以合并所有数据的任何想法？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T14:50:10.583

只要您向用户询问他们正在使用的单元，并且您知道您要做什么，那么您应该能够从文件中查询答案。假设您的表看起来像：

fromUnit fromUnitFactor（可能总是 1） ToUnit ToUnitFactor（从 fromUnit 到 toUnit 所需的一切）

然后只需查询它，您就知道您在寻找什么，知道您拥有什么。然后只需将用户给出的数量乘以返回的 toUnitFactor 即可。

最大的问题是您需要表格中 from 和 to 的所有组合。

说得通？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T15:04:20.523

用户必须为您提供单位，每个单位都有一个类型（重量、体积等）。您的“转换表”只需要包含每个单位类型的基线。即 8 盎司到一杯，128 盎司到一加仑。知道这两件事，您可以将杯子转换为加仑。

在单个查询中执行此操作是另一回事。如果你能做一点 VBA，在一次调用中得到杯到盎司，然后在另一个调用中得到盎司到加仑，我认为你会更轻松。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-18T15:45:25.420

好的，

只是想发布我的解决方案，以防将来有人遇到这个问题。实际上，我用 SQL 以通常的方式制作了表格并用我对 SQL 感兴趣的所有其他数据填充它。然后我有一个 DCOUNT 函数来告诉有多少记录设置了一个变量。然后我有一个 DLOOKUP 函数，它告诉我要从什么转换到什么，并将它设置在我所在记录的新表中。呸，我想我在我的头上！感谢各位的帮助。

# asp.net - 缓存通用查找数据 - 策略

> ID：443217
> 
> 赞同：3
> 
> 时间：2009-01-14T14:47:35.113
> 
> 标签：asp.net, caching

着眼于在 asp.net Web 应用程序中为一些常见的查找数据实现缓存。

过去，我创建了一个单例，它创建了一堆具有公共访问器的哈希表。这对于永不改变的只读数据非常有效。

我已经对 System.Web.Caching 做了一些研究，但它似乎并没有比单例方法提供任何好处。我们没有使用 SQLServer，因此在数据可能发生变化的极少数情况下，我们将无法利用 SQLCacheDependency。

任何人都有使用这些替代方案的经验吗？或者有更好的建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-14T15:33:10.623

System.Web.Caching 的一个好处是内存存储在应用程序池中。这很方便，因为在应用程序池上[设置内存/处理限制非常容易。](http://technet.microsoft.com/en-us/library/cc776532.aspx)

我在对应用程序进行压力测试时遇到了这个问题（每个用户任务都需要昂贵的计算）。随着我们添加越来越多的用户，缓存占用了所有可用内存。一旦我们在应用程序池上设置了内存限制，一切都会自行解决。Cache 有[LRU 算法](http://msmvps.com/blogs/theproblemsolver/archive/2006/12/19/using-the-system-web-cache-in-a-winforms-application.aspx)来管理内存。

我不知道缓存中的数据是否依赖于负载，但如果是，这是一个方便的好处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T18:28:23.467

我无法谈论 System.Web.Caching 的好处，因为和您一样，我通常实现了查找表数据结构的单例实例。单例类还公开了一个 InvalidateCache() 方法来处理数据可能更改的罕见情况。

如果您正在构建用于 asp.net 和例如 winforms 的业务对象库，那么您可能决定避免使用 System.Web.Caching。

我使用的业务对象框架为名为 NameValueListBase<TKey, TValue> 的查找表提供了一个基类。这个泛型基类提供了强类型的辅助方法。您可以开发一个类似的基类并公开您自己的辅助方法，而不是仅仅公开 System.Collections.Generic.Dictionary 的一个实例。

我提到的业务对象框架称为[CSLA.Net](http://lhotka.net/cslanet/Info.aspx)，在[Expert C# 2008 Business Objects](https://rads.stackoverflow.com/amzn/click/com/1430210192)中有详细解释。该书还有一个可用于 VB.Net 的版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T16:40:29.393

我对两者都有经验。我更喜欢单例模式，原因如下：

1.  它不绑定到 asp.net
2.  它允许您使用业务层中的查找来验证或其他任何内容。
3.  如果查找变得更复杂并且您决定不缓存它，则重构会更容易。

# java - 什么 MS SQL Server 类型映射到 Types.VARCHAR

> ID：443222
> 
> 赞同：0
> 
> 时间：2009-01-14T14:49:11.460
> 
> 标签：java, sql-server, tsql, jdbc, jtds

我正在为我们的更新程序开发一个语句扫描器（寻找会导致同步数据出现问题的语句），我需要知道哪些 TSQL 数据类型被解析为[`Types.VARCHAR`](http://java.sun.com/j2se/1.5.0/docs/api/java/sql/Types.html#VARCHAR)，哪些[`Types.LONGVARCHAR`](http://java.sun.com/j2se/1.5.0/docs/api/java/sql/Types.html#LONGVARCHAR)在调用时解析为`DatabaseMetaData.getColumns()`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-14T17:10:35.700

签出：[了解 BOL 中的 JDBC 驱动程序数据类型](http://msdn.microsoft.com/en-us/library/ms378599(SQL.90).aspx)：

*   [使用基本数据类型](http://msdn.microsoft.com/en-us/library/ms378878(SQL.90).aspx)
*   [使用高级数据类型](http://msdn.microsoft.com/en-us/library/ms378813(SQL.90).aspx)

所以基本上：

*   LONGVARCHAR：文本、ntext、varchar(max)、nvarchar(max)、xml
*   VARCHAR：varchar、nvarchar

# iphone - Mac/iPhone 混合应用程序的数据存储

> ID：443223
> 
> 赞同：1
> 
> 时间：2009-01-14T14:49:12.443
> 
> 标签：iphone, cocoa, macos, core-data

过去 5 个月左右我一直在做 iPhone 开发，并且一直在使用 Gus Mueller 的[FMDB](http://code.google.com/p/flycode/)进行数据库交互。我的下一个项目将有一个 Mac 和一个 iPhone 应用程序，它们将在它们之间共享数据，尽管最终，iPhone 将主要是一个查看器应用程序，具有一些小的编辑功能。

我的问题是：Core Data 是否会让我在 Mac 端的生活变得足够轻松，是否值得两次编写我的数据模型，在 Mac 上使用 Core Data，在 iPhone 上使用 FMDB？或者我应该对两者都使用 FMDB，以便我可以为 Mac 和 iPhone 重复使用相同的代码？

我已经对 Core Data 进行了一些探讨，但并不多（主要是 Hillegas 书中的示例），因此任何支持 Core Data 的具体示例都将不胜感激。作为记录，我真的很喜欢 FMDB，我只是想知道 Core Data 在这种情况下是否会让我的生活变得更轻松。

编辑：我了解 FMDB 和 Core Data 之间的核心区别，我主要想知道 Core Data 提供的“免费”是否值得对我的数据模型进行两次编码。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-14T14:57:58.383

主要区别在于 FMDB 是 SQLite 的 Obj-C 包装器，而 CoreData 是碰巧在 SQLite 中存储数据的对象模型（您不是在编辑数据库，而是在编辑对象）。这意味着它更高级别并提供更多抽象，但如果您知道您在使用数据库做什么，那么您应该可以使用其中任何一个。就个人而言，我宁愿在共享代码方面犯错，因为它会导致更少的错误、更容易的开发和更快的发布。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-14T19:36:34.843

您可能还想研究来自 OmniGroup 的[OmniDataObjects](http://www.omnigroup.com/developer/)框架。它在 OS X 和 iPhone OS 上的 SQLite 之上实现了 CoreData 功能的子集。我相信他们在 OmniFocus 的 OS X 和 iPhone 版本中都使用了它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-07-15T02:12:41.590

所以，现在这个问题可能已经完全解决了，但是为了后代，我想提一下 iPhone OS 3.0，Core Data*在*iPhone 上，如果你想在你的 Mac 应用程序中使用它，你可以分享很多您的 iPhone 应用程序的工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T15:23:09.783

我同意马丁的观点。如果您*只是*在编写桌面应用程序，我会说使用 Core Data。由于您同时进行这两种操作，因此尝试在存储模型之间进行转换时出现问题的可能性确实指向将 FMDB 用于台式机和手机。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-14T17:52:32.527

代码共享很好，但是根据你的模型和模型控制器类的相似程度，你可能不想完全打折 Core Data。例如，除了对象持久性之外，您还可以“免费”获得非常好的撤消/重做支持。您可能想要做一个快速原型来判断您最终可能会在两个应用程序之间重写多少代码。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-14T19:40:13.540

Core Data 的优势在于它是一个对象图管理框架，恰好可以持久化到 SQLite（或二进制或 XML 或自定义）数据存储中。因此，它管理单个对象实例的故障和对象之间的双向（包括对多）关系（包括基于这些关系传播或拒绝删除的几个选项）以及验证对单个对象属性和关系的约束（包括必需/可选、基数、范围等）。在 OS X 10.5 中，它还包括用于在模型模式之间半自动迁移数据存储的工具。

当然，缺点是它在 iPhone 上不可用。如果 FMDB 满足您的需求，您可能会更容易管理单个代码库而不是两个代码库。

如果您的桌面应用程序需要 Leopard，最后一个选择是使用 FMDB 编写一个 NSAtomicStore 子类。NSAtomicStore 必须将整个存储读取到内存中——因此你会失去 SQLite 在桌面客户端上的一些好处——但由于数据将在 iPhone 上共享，我猜你不会有那么多数据无论如何。通过这种方法，您可以在客户端使用 Core Data，在 iPhone 上使用 FMDB，并在两者之间使用通用数据模型/数据存储。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-14T20:52:46.500

我不知道您的项目涉及什么类型的数据，但是如果它以任何方式处理人员记录，并且如果记录的数量相当少，您也可以使用内置的地址簿（ABAddressBook 类）作为数据库。

它让您可以添加应用程序独有的属性（在其他不使用它们的应用程序中不可见），并且您可以完全免费地在 iPhone 和 mac 之间进行同步。

# python - Jython，动态查询多列

> ID：443224
> 
> 赞同：1
> 
> 时间：2009-01-14T14:49:41.473
> 
> 标签：python, oracle10g, jython

我正在使用 Oracle 数据库和 Jython。

我可以从数据库中提取数据没有问题。

```
results = statement.executeQuery("select %s from %s where column_id = '%s'", % (column, table, id)) 
```

如果我想提取一列数据，这很好用。

假设我想循环抛出一个这样的列表：

```
columns = ['column1', 'column2', 'column3', 'column4', 'column5'] 
```

所以查询最终看起来像这样：

```
results = statement.executeQuery("select %s, %s, %s, %s, %s from %s where column_id = '%s'", % (column1, column2, column3, column4, column5, table, id)) 
```

我怎么能这样做？

我想要实现这一点的原因是因为我可能想要拉 6 或 7 列，并且我想将不同的查询存储在外部文件中。

我希望你明白我的意思。如果不是，我会尽我所能重新措辞。

干杯

亚瑟

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-14T15:19:30.290

您可以简单地将所有列替换为单个字符串，如下所示：

```
columns = ['column1', 'column2', 'column3', 'column4', 'column5']
results = statement.executeQuery("select %s from %s where column_id = '%s'" % (",".join(columns), table, id)) 
```

顺便说一句，这并不能防止 SQL 注入，所以我假设列、表和 id 输入是程序生成或清理的。

# delphi - 在存储库 (SVN) 中包含 Delphi 类型库？

> ID：443226
> 
> 赞同：2
> 
> 时间：2009-01-14T14:50:47.370
> 
> 标签：delphi, delphi-2006, typelib, com-hell

在 SVN 中保存 Delphi 类型库的最佳方法是什么。

每次编译应用程序时文件都会更改

该文件未以可读的 AscII 格式保存

很难弄清楚从一个版本到下一个版本所做的更改

**当多人更改文件时，这是一个主要问题**

**问题：**

1) 是否应该在版本控制中保存导出的“IDL”文件？

2) 可以将“IDL”转换为 Delphi 类型库吗？如果可以，怎么办？

3) 使用 Delphi 类型库时的最佳实践是什么？

4）摆脱Delphi2009 datasnap项目中的类型库有多容易？

ps 我正在使用 BDS2006

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-14T16:02:17.757

在 Delphi 2009 中，这完全改变了。[类型库现在以纯文本 RIDL 文件的形式保存在项目中](http://chrisbensen.blogspot.com/2008/07/tiburn-sneak-peek-com_23.html)。这些将与源代码控制配合得很好。DataSnap 也完全改变了；您可以[在此处阅读相关内容](http://blog.marcocantu.com/blog/new_datasnap_tiburon.html)，并在此处观看[截屏视频](http://dn.codegear.com/article/38587)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-14T17:29:13.040

Delphi 和 COM对这个问题有一些很好的答案[：TLB 和维护问题](https://stackoverflow.com/questions/16897/delphi-and-com-tlb-and-maintenance-issues)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-14T17:29:56.987

在 Delphi 2009 之前，我不会签入 TLB 文件，而是手动将 TLB（和 *_TLB.PAS 文件以供参考）放入 zip 文件，然后将其强制进入版本控制。当我对 TLB 进行实际更改时，我会更新 zip 文件并将其签入。本地 TLB 总是被版本控制系统读取/写入并忽略。当 TLB 文件神秘地不再编译时，这个方案为我节省了好几次，我可以关闭我的项目，从 zip 文件中解压缩，重新加载项目并继续工作。

# windows - 如何确定我的应用程序是在 x86 还是 x64 Windows 上运行？

> ID：443227
> 
> 赞同：3
> 
> 时间：2009-01-14T14:51:01.643
> 
> 标签：windows, version

我想知道，在运行时，我是在 32 位还是 64 位窗口上运行。OSVERSIONINFOEX 结构告诉我主要和次要版本，但我猜我需要内部版本号。有谁知道它们是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-14T15:42:03.537

如果您的应用程序是为 64 位编译的，那么答案很简单：您在 64 位 Windows 上运行。

如果您的应用程序是为 32 位编译的，则需要调用[IsWow64Process](http://msdn.microsoft.com/en-us/library/ms684139.aspx)。此功能仅在 Windows XP 或更高版本上导出；如果要支持早期版本的 Windows，则需要使用 GetProcAddress 来获取指向此函数的指针。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T15:38:07.930

假设您使用的是 C++，这里有一个非常好的操作系统检测[类](http://www.naughter.com/dtwinver.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T15:34:35.143

您可以从`OSVERSIONINFOEX`结构中获取内部版本号。

如果您是 32 位进程并且想知道您是否在 WOW64（即 64 位操作系统）下运行，请调用`IsWow64Process()`. （需要 XP SP2 或更高版本）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T16:09:19.067

我使用 WMI。

从 Win32_OperatingSystem 中选择 *

获取第一个实例，然后选择 Version 属性。对于 WinXP，它返回 5.1.2600。

# jakarta-ee - 如何在 glassfish 中触发计时器触发器？

> ID：443230
> 
> 赞同：2
> 
> 时间：2009-01-14T14:51:26.900
> 
> 标签：jakarta-ee, glassfish, timer

我们的功能测试用例需要一些一致性。我们目前能做的最好的事情就是在产品中的 Java EE 计时器应该被触发之前等待一个估计的时间。如果测试用例能够以编程方式（可能使用 JMX）触发计时器，那将更加可预测。

如何才能做到这一点？我们可以使用 Glassfish 计时器工具的 JMX 接口吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T12:27:19.063

这显然是不可能的，因为这个问题已经将近三个月没有答案了。

但是，我意识到，出于测试目的，在触发实际发生时得到通知就足够了。（主动触发它只会为我争取质量交易的时间）

我正在添加对事件完成的监控，但感谢您让我知道这实际上是不可能的；）

# .net - .NET 3.5 - 配置系统未能初始化异常

> ID：443235
> 
> 赞同：29
> 
> 时间：2009-01-14T14:52:43.713
> 
> 标签：.net, .net-3.5, configuration, settings, app-config

在我的 winform 应用程序中，我正在尝试添加一个 userSetting，尽管 appSettings 也发生了错误。添加设置后，我收到一个异常提示：“配置系统无法初始化”，内部异常“无法识别的配置部分 userSetting”

异常详情：

```
System.Configuration.ConfigurationErrorsException was unhandled
  Message="Configuration system failed to initialize"
  Source="System.Configuration"
  BareMessage="Configuration system failed to initialize"
  Line=0
  StackTrace:
       at System.Configuration.ConfigurationManager.PrepareConfigSystem()
       at System.Configuration.ConfigurationManager.RefreshSection(String sectionName)
       at System.Configuration.ClientSettingsStore.ReadSettings(String sectionName, Boolean isUserScoped)
       at System.Configuration.LocalFileSettingsProvider.GetPropertyValues(SettingsContext context, SettingsPropertyCollection properties)
       at System.Configuration.SettingsBase.GetPropertiesFromProvider(SettingsProvider provider)
       at System.Configuration.SettingsBase.GetPropertyValueByName(String propertyName)
       at System.Configuration.SettingsBase.get_Item(String propertyName)
       at System.Configuration.ApplicationSettingsBase.GetPropertyValue(String propertyName)
       at System.Configuration.ApplicationSettingsBase.get_Item(String propertyName)
       at Settings.get_ApplicationData() in \Properties\Settings.Designer.cs:line 41
       at Common.Initialize.IsSettingsInitialized() 
       at SurveyClient.Program.Main() 
       at System.AppDomain._nExecuteAssembly(Assembly assembly, String[] args)
       at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
       at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
       at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
       at System.Threading.ThreadHelper.ThreadStart()
  InnerException: System.Configuration.ConfigurationErrorsException
       Message="Unrecognized configuration section userSettings.
       Source="System.Configuration"
       BareMessage="Unrecognized configuration section userSettings."
       Line=3
       StackTrace:
            at System.Configuration.ConfigurationSchemaErrors.ThrowIfErrors(Boolean ignoreLocal)
            at System.Configuration.BaseConfigurationRecord.ThrowIfParseErrors(ConfigurationSchemaErrors schemaErrors)
            at System.Configuration.BaseConfigurationRecord.ThrowIfInitErrors()
            at System.Configuration.ClientConfigurationSystem.OnConfigRemoved(Object sender, InternalConfigEventArgs e)
       InnerException: 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-03-02T16:47:09.993

我有一些用户设置，然后删除了所有设置并开始看到这个异常 - 但只有在运行应用程序而不调试时。调试应用程序时效果很好。原因是用户级设置“缓存”在本地应用程序数据文件夹中，实际上不是从 MYAPP.exe.config 中读取的。所以我所做的是转到 C:\Users\MYUSERNAME\AppData\Local\MYCOMPANY\MYAPP.exe_Url_longnastyhash9982749827349879\1.0.0.0\user.config （这是在 Win7 上，路径取决于操作系统）并删除了该文件夹（使用长哈希）完全。异常消失了。顺便说一句，根据您的设置，此 user.config 文件可能位于 \AppData\Local 或 \AppData\Roaming 下。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-01-14T14:56:23.397

尝试检查 app.config（部署后的 myapp.exe.config）文件是否存在并位于顶部（可能与其他位）

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
<configSections>
<sectionGroup name="userSettings"
    type="System.Configuration.UserSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" >
</sectionGroup> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-10-25T09:30:29.617

当我如下编写 App.Config（愚蠢地）时出现此错误。

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>

<!--List of XMLFiles Begins -->
    <add key="ConfigFileEnvironment" value="C:\Program Files\MyProduct\Config\Environment.xml" />
<!--List of XMLFiles Ends -->

</configuration> 
```

注意，没有appSettings？我以前经常犯这个错误...

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-06-06T16:06:05.783

删除所有用户设置后，我开始看到此消息。我可以通过将单个 userSetting 添加回设置文件来修复它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-02-09T20:48:41.227

清理解决方案删除所有当前存在的设置文件以及app.config关闭VS手动进入并清除项目的bin文件夹和obj文件夹重新启动PC重新添加“应用程序配置文件”

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-12-09T03:38:56.473

我的 machine.config 中有一些垃圾导致了这个错误。查找异常堆栈跟踪，看看您是否有同样的问题。它本质上是格式错误的 XML。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-05-02T19:21:06.930

我今天遇到了这个问题，发现我不小心（更不用说错误地）在我的 App.config 中添加了第二个自定义配置部分。一旦我删除了错误的添加，我就可以继续运行我的应用程序而不会出现问题。

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <configSections>
    <section name="ABCConfig" type="ABC.Configuration.ABCConfigurationSection, ABC"/>
    <!-- Other custom section definitions -->
  </configSections>
  <connectionStrings>
      <!-- Connection strings go here -->
  </connectionStrings>

  <!-- Configure ABC -->
  <ABCConfig CustomA="blah" CustomB="stuff" />

  <!-- Other custom sections -->

  <!-- Errant addition to Configure ABC which causes the problem - SHOULD NOT BE HERE -->
  <ABCConfig CustomA="blah" CustomB="stuff" />

</configuration> 
```

删除第二个 ABCConfig 部分解决了我的问题。希望这可以帮助！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-18T13:04:08.027

问题可能是您的配置文件不符合其架构。例如，可以通过复制 ConnectionStrings 部分来重新创建此问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-06-06T10:31:32.553

我遇到了这个问题，因为我更改了一个应用程序设置范围（从“应用程序”到用户“）。由于找不到解决问题的解决方案，我决定将设置文件删除到解决方案资源管理器中。之后，我打开属性，在“设置”选项卡中，单击建议创建设置文件的位置。并且已经使用我在之前的设置文件中定义的值创建了一个新的设置文件。我重建了我的项目，它运行良好。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-05-25T20:59:03.800

启动标签在 VS Pro 2013 版本 12.021005.1 上为我做了诀窍，带有 .Net 4.5.51650 用于控制台应用程序（即 app.config 文件）

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <startup> 
        <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.5" />
    </startup>
 <connectionStrings>
 ...
</connectionStrings>
</configuration> 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-08-22T18:39:30.147

只是在此处发布，因为我找到了解决问题的方法，但没有在此处列出...。我在主配置节点下添加了一个 appSettings 标记，当我运行它时，我遇到了与 OP 相同的错误。修复它的是确保 configSections 节点在我的 appSettings 节点之前。 [![在此处输入图像描述](https://i.stack.imgur.com/5SJi3.png)](https://i.stack.imgur.com/5SJi3.png)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-05-29T18:20:19.903

当我的应用程序的 .NET 4.x 版本已经在文件夹下生成了公共`user.config`文件时，我收到了这个错误`AppData`，然后我启动了 .NET 3.5 版本。

尽管按照@beluga 的建议删除`user.config`下面`%APPDATA%\Local\<Company>\<AppName>_StrongName_*\<Version>`的内容可以解决问题，但设置也会丢失，如果发生这种情况，用户挖掘文件删除可能会非常令人沮丧。

但实际上，即使是 .NET 3.5 版本也可以使用配置文件。

罪魁祸首是类型使用 .NET 4.x 程序集标识的`sectionGroup`元素：`UserSettingsGroup`

```
<sectionGroup name="userSettings" type="System.Configuration.UserSettingsGroup, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"> 
```

要从应用程序处理此问题，您需要应用一些自定义程序集解析逻辑：

```
// somewhere in your application startup:
AppDomain.CurrentDomain.AssemblyResolve += HandleAssemblyResolve; 
```

事件处理程序在哪里：

```
private static Assembly HandleAssemblyResolve(object sender, ResolveEventArgs args)
{
    // System.dll, any version
    if (args.Name.StartsWith("System, Version=", StringComparison.Ordinal))
        return typeof(UserSettingsGroup).Assembly;

    // for any other assembly letting the default logic take over
    return null;
} 
```

# java - 如何确定对应于 SQL Server 的 sp_unprepare 调用的 SQL？

> ID：443237
> 
> 赞同：0
> 
> 时间：2009-01-14T14:53:14.680
> 
> 标签：java, sql-server, deadlock

这可能是非常基本的，所以请耐心等待（另一方面，可能有一个很好的闪亮的干货答案！）。

我目前正在诊断一个死锁问题，实际上我可以看到我的一个会话被另一个会话阻止了。（死锁的另一端是 Java 线程以相反的顺序相互等待。）在 Management Studio 的进程资源管理器中显示进程的详细信息为我提供了阻塞会话的 SQL，但阻塞会话的 SQL*仅*显示作为“ `EXEC sp_unprepare 807`”。

现在我明白这与准备好的陈述有关，所以我本身并不为此感到不安。但是，我想知道实际的 SQL 是什么，这样我就知道在代码库中的何处投下怀疑的眼光。那么在这一点上，将其与该线程执行的实际 SQL 相关联的最佳方法是什么？是否有一个系统表，我可以在其中查找准备好的语句到他们的 SQL 的映射？可能是一个存储会话的最后*n 个*SQL 语句的表，该会话有望保持`prepare`调用？是否可以在数据库驱动程序连接上设置一个标志，以完全禁用此会话的准备好的语句？

我也欢迎解决这个问题的替代方法，如果它们是更好的方法（基本上我高度怀疑有一些 Java 代码在修改表后无法提交，我想知道 SQL 来提供帮助我找出它在哪里）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T15:03:22.523

尝试这个

```
dbcc inputbuffer(spid) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T21:29:00.467

使用 SQL Profiler 跟踪服务器上的活动，然后重新创建问题。使用服务器端游标时，SQL 将使用数字作为句柄。您可以通过 Profiler 输出跟踪这些句柄，以查看正在使用该句柄执行的其他内容。在句柄和 SPID 之间，您可以跟踪工作负载并深入探究问题的原因。

# java - 通过不同的JVM实现接口

> ID：443239
> 
> 赞同：0
> 
> 时间：2009-01-14T14:54:18.423
> 
> 标签：java, jvm

假设您有接口定义。

那个界面可以是*Operation*。

然后，您有两个应用程序在不同的 JVM 中运行，并通过交换*Operation*实例以某种方式进行远程通信。

让我们称它们为 application *A*和 application *B*。

如果应用程序*A使用应用程序**B*的类路径中不可用的类来实现*Operation* ，应用程序*B*仍然能够处理该接口的实现吗？即使*B*在不同的JVM中？

 *** * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-14T15:03:35.127

这取决于您的“以某种方式远程通信”部分中发生的魔法。

如果这种通信是通过 RMI 或类似技术完成的，那么就可以了。应用程序 B 将为`Operation`JVM A 中的对象创建一个远程代理，并在此代理上调用方法生成对 JVM A 的 HTTP 请求，这些请求针对存在于该 JVM 中的实际对象（可以访问实现类）进行解析。

如果这种通信是通过序列化对象并通过网络发送它们来完成的，那么它将不起作用。当来自应用程序 A 的对象到达 JVM B 时，反序列化将失败（使用 a`ClassNotFoundException`或类似的方法）。

很可能还有其他远程技术，在这种情况下，事情取决于实现。我知道类加载器可以从字节数组加载类，因此从概念上讲，拥有能够从远程源加载类的类加载器是很有可能的。我相信，网络库理论上可以通过这种方式通过线路序列化实际类，因此虽然 JVM B 本身不会知道实现类，但它的类加载器将根据需要提供类的字节码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T14:59:38.147

这取决于“以某种方式远程通信”的含义。如果应用程序 A*实际上*只是将某种内置于代理中的令牌交给应用程序 B，以便对 Operation 接口的调用被代理回应用程序 A，那么它可能没问题。如果想法是让应用程序 B 创建实现类的本地实例，那么这是行不通的，因为它不知道对象的样子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T14:56:53.393

只要它只尝试通过公共接口引用它，它*应该*能够处理它。只要它们都实现相同版本的接口，实际实现并不重要。

# asp.net - 在处理程序中检测身份验证超时并将整个页面重定向到登录页面

> ID：443243
> 
> 赞同：4
> 
> 时间：2009-01-14T14:55:41.883
> 
> 标签：asp.net, jquery, forms-authentication, httphandler

我正在编写一个应用程序，有人可以在其中编辑网页上的段落。jQuery 用于向处理程序发送和接收已编辑的段落数据，处理程序将其保存或从数据库中读取。问题是如果表单身份验证超时，我会从我的处理程序中取回登录页面。如果身份验证超时并将整个页面重定向到登录页面，我有什么方法可以在客户端或服务器上检测到？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T15:01:58.097

在我的应用程序中，在客户端，我检查返回页面的 HTTP 状态。如果是 401（未经授权的错误），我会在模式对话框中显示登录表单。您可以像这样重新进行身份验证，或者只是使用重定向

```
window.location = 'http://someurl.com'; 
```

这需要服务器的合作才能返回 401，但这对我来说似乎是最干净的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-29T19:22:10.347

我最近完成了一种处理 401 的方法，我认为它也适用于您。.NET 过去版本的问题是错误页面不会返回正确的错误代码，它们只是 302 到指定页面。

使用 .NET 3.5，您的错误处理程序可以使用 redirectMode 来“重写”而不是“重定向”：

```
<customErrors mode="On" defaultRedirect="/err.aspx" redirectMode="ResponseRewrite">
  <error statusCode="404" redirect="/404.aspx"/>
</customErrors> 
```

由于所有请求（包括 Web 服务调用）现在都将返回正确的 HTTP 状态代码，因此您可以在 javascript 中正确使用 404 / 401 / 500 代码。

然后，在您的客户端代码中（这是在 jQuery 中并且正在重定向任何错误，不仅是 401，而且您明白了）：

```
$(document).ajaxError(function(event, XMLHttpRequest, ajaxOptions, thrownError) {
  window.location.href('/error.aspx');
}); 
```

# c - 挂钩窗口登录/注销事件

> ID：443244
> 
> 赞同：0
> 
> 时间：2009-01-14T14:55:44.550
> 
> 标签：c, windows, winapi, windows-xp, native

我有一项将在系统级别运行的服务。现在，我想跟踪其中的登录用户。早些时候我试图从 GetUserName api 获取登录的用户名，但在我的情况下，它每次都返回“SYSTEM”。

在我的情况下，无论如何要登录用户名吗？或者我可以安装任何挂钩，以便我可以让哪个用户登录？

PS：我主要在 Delphi 2007 工作，但这些问题特定于 Win32 API。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-14T15:15:52.060

我不熟悉 Delphi 的 Windows 服务实现，但是无论您设置服务接受的控件，都应该添加 SERVICE_ACCEPT_SESSIONCHANGE。然后在您的 HandlerEx 回调函数中，dwEventType 参数将是 WM_WTSSESSION_CHANGE 值之一，lpEventData 将是指向包含事件会话 ID 的 WTSSESSION_NOTIFICATION 结构的指针。

您可以将此信息与终端服务 API 一起使用来确定谁做了什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T15:00:11.110

您可以使用[SENS](http://msdn.microsoft.com/en-us/magazine/cc301850.aspx)收听订阅登录通知。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T15:07:58.613

您需要更具体地提出您的要求。在任何给定时间，可能有多个用户在本地或远程登录。你只关心交互式用户吗？

最常见的请求是如何获取本地登录的交互式用户，即物理上坐在键盘和屏幕前的人。在决定如何继续之前，您必须考虑各种问题。MSDN 在[Window Stations](http://msdn.microsoft.com/en-us/library/ms687096(VS.85).aspx)上有一个很好的条目，可以比我更好地解释这种情况。

# eclipse - 如何让工作台窗口在基于 Eclipse 的项目中打开模式对话框？

> ID：443245
> 
> 赞同：20
> 
> 时间：2009-01-14T14:55:57.140
> 
> 标签：eclipse, eclipse-plugin, eclipse-rcp, eclipse-pde

为了打开模态对话框，您需要传递一个父窗口，并传递必要的标志以使对话框成为模态。

根据您在 eclipse 基础结构中的位置，找到这个父窗口并不总是那么容易。

如何访问父窗口？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-01-14T17:07:25.627

上一个答案中的一段代码将起作用。但是，请记住，您只能从 UI 线程打开对话框。如果您从其他线程（例如后台进程）打开对话框，则需要执行以下操作：

```
PlatformUI.getWorkbench().getDisplay().asyncExec(new Runnable() {
    public void run() {
        Shell activeShell = PlatformUI.getWorkbench().getActiveWorkbenchWindow().getShell();
    }
}); 
```

否则创建对话框时会出现异常。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-01-14T15:00:18.567

从视图或编辑器（这部分很简单）：

```
this.getSite().getWorkbenchWindow().getShell() 
```

从其他地方访问视图或编辑器，与上面相同。

如果您发现自己在一个无法访问视图或编辑器的课程中，您可能不想调用任何 UI 代码，但如果您真的想自责：

```
PlatformUI.getWorkbench().getActiveWorkbenchWindow().getShell() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T15:27:25.207

不完全是您想要做的，但您可能需要在创建对话框时使用**SWT.APPLICATION_MODAL**、**SWT.DIALOG_TRIM**等，以使其成为模态对话框（但也许这不是您的问题所在）。

有关更多信息，请参阅此[链接](http://www.java2s.com/Tutorial/Java/0280__SWT/ThemodalstateofshellsAPPLICATIONMODALMODELESSPRIMARYMODALSYSTEMMODAL.htm)。

# c# - 在 C# 中使用命名空间创建特定的 XML 文档

> ID：443250
> 
> 赞同：13
> 
> 时间：2009-01-14T14:56:54.533
> 
> 标签：c#, xml, namespaces, xsd

我们得到了一个示例文档，并且需要能够准确地为供应商重现文档的结构。但是，我对 C# 如何处理命名空间有点迷茫。这是该文档的示例：

```
<?xml version="1.0" encoding="UTF-8"?>
<Doc1 xmlns="http://www.sample.com/file" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="http://www.sample.com/file/long/path.xsd">
    <header>
        <stuff>data</stuff>
        <morestuff>data</morestuff>
    </header>
 </Doc1> 
```

我通常这样做是加载一个空白文档，然后开始填充它：

```
XmlDocument doc = new XmlDocument();
doc.LoadXml("<Doc1></Doc1>");
// Add nodes here with insert, etc... 
```

一旦开始编写文档，如何将命名空间和架构放入 Doc1 元素中？如果我从 Doc1 元素中的命名空间和模式开始，将它们包含在 LoadXml() 中，那么*所有*子元素都具有命名空间——这是一个禁忌。文档被拒绝。

所以换句话说，我必须完全按照所示制作它。（而且我宁愿不只是在 C# 中编写文本到文件并希望它是有效的 XML）。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-01-14T15:13:47.120

你应该这样试试

```
 XmlDocument doc = new XmlDocument();  

  XmlSchema schema = new XmlSchema();
  schema.Namespaces.Add("xmlns", "http://www.sample.com/file");

  doc.Schemas.Add(schema); 
```

不要忘记包含以下命名空间：

```
using System.Xml.Schema;
using System.Xml; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-12T12:43:31.517

我个人更喜欢使用通用 XmlElement 及其属性来声明命名空间。我知道有更好的方法，但这个永远不会失败。

尝试这样的事情：

```
xRootElement.SetAttribute("xmlns:xsi", "http://example.com/xmlns1"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T15:20:27.497

如果您在 Samples 文件夹中使用 Visual Studio 2008，您将找到一个示例插件，可让您将 XML 片段粘贴为 Linq2XML 代码。

[Scott Hanselman](http://www.hanselman.com/blog/)有一篇包含详细信息的[博客文章](http://www.hanselman.com/blog/PasteXMLAsXLinqXElementVisualStudioAddIn.aspx)。

我认为这是从示例 XML 文档到创建它的 C# 代码的最快方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-01-26T10:33:33.840

我发现 XDocument API 比旧的 XmlDocument 更有用

```
 XNamespace g = "http://base.google.com/ns/1.0";
        var doc = XDocument.Parse(templateFeed);
        var channel = doc.Descendants("rss").First();

        channel.Add(new XElement("item",
                    new XElement("description", "DDD23"),
                    new XElement(g + "image_link", "http://qqq2")
                 ));

        doc.Save("plik"); 
```

# vbscript - 自动生成MD5并显示

> ID：443253
> 
> 赞同：0
> 
> 时间：2009-01-14T14:57:57.200
> 
> 标签：vbscript, hash, md5

在自动列出特定文件夹中包含的几个小文件（~100-500kb）的页面上，有没有办法使用 VBScript 自动生成每个文件的 MD5 哈希并将其显示在页面上？

Cliff 笔记：我可以在服务器机器上生成文件的 MD5 哈希吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T17:50:16.213

如果 VBScript 是客户端，那么您就有问题了。

如果它在服务器端运行，那么它很容易（只要 Web 服务器具有读取权限）。

简单的解决方案 - 对于每个文件，通过以下方式获取其 MD5 哈希：

1.  将文件读入内存
2.  计算 MD5 哈希`System.Security.Cryptography.MD5CryptoServiceProvider`
3.  转换为十六进制`System.BitConverter.ToString(array).Replace("-","")`

一个（很多）更好的解决方案是读取块中的文件并将其提供给`MD5CryptoServiceProvider`，因为将整个大文件加载到内存中并不是世界上最好的事情。

# ruby-on-rails - 为什么我的 Rails 服务器渲染时间不加起来？

> ID：443255
> 
> 赞同：6
> 
> 时间：2009-01-14T14:58:42.860
> 
> 标签：ruby-on-rails, ruby, performance

我的 Rails 应用程序在我的登台服务器上速度非常慢时遇到了一些问题。最令人困惑的是每个请求的日志输出的最后一行。

看起来视图和数据库时间甚至不接近整个渲染时间。在一页上，完成时间约为 1000 毫秒，视图约为 450 毫秒，数据库约为 20 毫秒。

渲染页面所需的其余时间从何而来？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T01:11:53.480

当事情变得神秘时......分析器是你的朋友！

分析器将统计哪些方法被调用最多以及每个方法调用花费了多长时间。

当我在 RubyLand 中时，[ruby-prof为我解决了这个问题，它会生成一个漂亮的调用图（如果你愿意，可以使用 html 格式），这可以很容易地查看哪些方法正在减慢你的请求。](http://ruby-prof.rubyforge.org/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-10-25T19:46:35.163

我发现大部分渲染时间都花在 Rails 创建和准备 Active Record 对象上。在查询之后和视图之前。例如，取决于从“查找”返回的记录数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T10:17:39.590

Besides rendering and database time, some time is spent in your controller code and the Rails framework. This can be really slow if too few resources are assigned to your staging server. You should not however that the durations in the log are not always perfect, especially the database duration.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-16T05:28:48.063

你的apache日志说什么？它肯定会有不同的数字来显示服务请求所需的时间。

Apache 向 rails 发送请求，rails 在其上工作，这就是您在生产日志中看到的内容。

所有的 HTML 仍然必须在您的浏览器上呈现（大量的 CSS、图像、js 等）。尝试使用 firefox 扩展 httpwatch 来了解 UI 元素的渲染时间，它应该加起来。

如前所述，NewRelic 应该给你在各种活动中花费的时间（MVC）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T16:52:51.147

我推荐使用[New Relic 的 RPM 服务](https://rpm.newrelic.com)。它有一个免费版本，但青铜服务（每月 40 美元）非常棒，可以进一步帮助追踪这些问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-15T02:03:32.393

我正准备用相同的答案重新审视这个问题，所以我只是捎带。这是一个视图渲染的一个非常小的 ruby​​-prof[片段](http://gist.github.com/47220)。令人惊讶的是引擎盖下发生了多少事情。

# java - 有谁知道如何成功地在 J2ME 上使用预处理？

> ID：443261
> 
> 赞同：1
> 
> 时间：2009-01-14T14:59:53.093
> 
> 标签：java, ant, java-me, preprocessor, mtj

我会尽力更好地解释我的问题。使用 Eclipse 和 MTJ（Java 移动工具）插件，您可以为预处理器设置一些指令，以便创建不同的代码构建，例如在 C/C++ 中。我的问题是我无法使用此功能。我的意思是，当我构建源代码时，生成的输出包含每一行代码，甚至包含其中的代码

```
//#mdebug info
...
//#enddebug 
```

指示。我选中了“启用预处理”选项，并将调试级别更改为每个可能的设置（低于、等于和高于“信息”），结果始终相同：指令被简单地忽略。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T16:25:24.090

您正在使用 MTJ 的 v0.9.1（或更新版本）吗？ [这个](http://wiki.eclipse.org/DSDP/MTJ/Plans/0.9.1)wiki 显示了他们对 MTJ 的规划，直到 0.9.1 才支持 mdebug 和 debug。

对于任何可能遇到此问题的人，[这里](http://eclipseme.org/docs/preprocessing.html)是预处理的设置说明页面。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-18T17:51:51.080

找到了！这是一个配置问题，我的错误。MTJ 插件本身仍然存在问题：当您导出 build.xml 文件以馈送 Ant 时，无论您在下拉菜单中选择了何种调试级别，它总是以在输出中写入“信息”结束，所以我必须手动更改它。我会尝试直接询问插件的开发人员。

# java - 有没有人使用 SnakeYAML 从本地 Maven 存储库成功加载 YAML 文件？

> ID：443264
> 
> 赞同：1
> 
> 时间：2009-01-14T15:00:53.650
> 
> 标签：java, maven-2, yaml, snakeyaml

如果我直接从测试程序中引用[SnakeYAML jar（见底部），一切正常。](http://trac-hg.assembla.com/snakeyaml/wiki "SnakeYAML 的 Trac wiki")如果我在我的 Maven 创建的项目中，我会从我的单元测试中获得以下输出：

```
java.lang.NoSuchMethodError: java.util.LinkedList.push(Ljava/lang/Object;)V
    at org.yaml.snakeyaml.scanner.ScannerImpl.addIndent(ScannerImpl.java:482)
    at org.yaml.snakeyaml.scanner.ScannerImpl.fetchBlockEntry(ScannerImpl.java:653)
    at org.yaml.snakeyaml.scanner.ScannerImpl.fetchMoreTokens(ScannerImpl.java:268)
    at org.yaml.snakeyaml.scanner.ScannerImpl.checkToken(ScannerImpl.java:178)
    at org.yaml.snakeyaml.parser.ParserImpl$ParseImplicitDocumentStart.produce(ParserImpl.java:213)
    at org.yaml.snakeyaml.parser.ParserImpl.peekEvent(ParserImpl.java:172)
    at org.yaml.snakeyaml.parser.ParserImpl.checkEvent(ParserImpl.java:143)
    at org.yaml.snakeyaml.parser.ParserImpl.checkEvent(ParserImpl.java:163)
    at org.yaml.snakeyaml.composer.Composer.getSingleNode(Composer.java:66)
    at org.yaml.snakeyaml.constructor.BaseConstructor.getSingleData(BaseConstructor.java:60)
    at org.yaml.snakeyaml.Loader.load(Loader.java:35)
    at org.yaml.snakeyaml.Yaml.load(Yaml.java:134) 
```

由于 Maven 在中央存储库中找不到 SnakeYAML，因此我手动将其安装到本地存储库中。万一这很重要，我在使用 SnakeYAML 0.9 和 Maven 2.0.9 的 Mac 上。

**示例 YAML 文件**

```
- 
    accountCode: foo
    accountId: 1
    email: foo@bar.com
    userId: 1 
```

**工作测试程序**

```
import java.io.*;
import java.util.*;

import org.yaml.snakeyaml.Yaml;

/**
 * Testing SnakeYAML.
 *
 * @author Hank Gay
 */
public final class Foo {
    public static void main(final String[] args) throws Exception {
        final Yaml yaml = new Yaml();
        Reader reader = null;
        try {
            reader = new FileReader("/tmp/foo.yaml");
            System.out.println(yaml.load(reader));
        } catch (final FileNotFoundException fnfe) {
            System.err.println("We had a problem reading the YAML from the file because we couldn't find the file." + fnfe);
        } finally {
            if (null != reader) {
                try {
                    reader.close();
                } catch (final IOException ioe) {
                    System.err.println("We got the following exception trying to clean up the reader: " + ioe);
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-14T15:23:54.057

似乎是 JDK 版本问题：[在 Java 6](http://java.sun.com/javase/6/docs/api/java/util/LinkedList.html#push(E))`LinkedList#push`中引入。

在运行 Maven 之前尝试设置`JAVA_HOME`为正确的版本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-16T17:32:27.710

在 1.0rc1 版本中修复

所有 Java 6 依赖项都从 SnakeYAML 中删除。

# c - 我在哪里可以找到 C 的位移指南？

> ID：443265
> 
> 赞同：6
> 
> 时间：2009-01-14T15:01:46.787
> 
> 标签：c, bit-shift

我看过*[什么是位移（位移）运算符以及它们是如何工作的？](https://stackoverflow.com/questions/141525/absolute-beginners-guide-to-bit-shifting)*，但我仍然觉得位移的概念很难理解。

有人可以指出我在 C 中移位的更基本指南的方向吗？我希望它会很长，因为它需要涵盖整个主题。

我正在学习*[C 编程语言](https://en.wikipedia.org/wiki/The_C_Programming_Language)*(AKA K&R)，这就是它的用途，所以我可以做练习。我了解基础知识，但我仍然无法进行正确的位移操作。

**以下是让我难过的 K&R 的练习**

练习 2-6：编写一个函数 setbits(x, p, n, y) 返回 x，其中从位置 p 开始的 n 位设置为 y 的最右边 n 位，其他位保持不变。

练习 2-7：编写一个函数 invert(x, p, n)，它返回 x，其中从位置 p 开始的 n 位反转（即 1 变为 0，反之亦然），其他保持不变。

练习 2-8：编写一个函数 rightrot(x, n)，返回整数 x 向右旋转 n 位的值

练习 2-9：在二进制补码系统中，x &= (x-1) 删除 x 中最右边的 1 位。解释原因，并使用此观察来编写更快的 bitcount 版本。

这些是 k&R（C 编程语言）书中的练习。这是最好的 C 书籍，但我无法理解位移，所以我在这些练习中遇到了问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-14T15:09:54.367

位移就是它的*字面*意思：向左或向右移动给定序列中的所有位。

您需要记住的是，每个十进制数（如 6、7、3、2）都表示为计算机内存中的位序列。因此，如果您在一段 C 代码中找到类似的内容：

```
(7 >> 1) 
```

这意味着 7 的底层二进制表示中的位将右移 1 个位置。

我认为您引用的链接中的解释非常清楚。也许自己在纸上写下一系列位并按照引用的链接进行操作会有所帮助。

或者您可能还不了解计算机如何在内部处理数字。在这种情况下，在学习位移之前，您需要阅读相关内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-14T15:58:54.657

您将需要更多工具包中的工具来回答这些问题，而不是转移。

我认为你需要开始非常基本的关于如何用二进制表示数字。然后，您将需要考虑如何设置和清除该数字中的特定位，或同时清除一组位。您需要知道如何测试以查看是否设置了某组位以及如何进行屏蔽。您必须能够使用按位运算符和、或、异或、反转等运算符来完成上述所有操作。

然后你会想知道移位——将位向左和向右移动特定数量的空格。您会想知道“空”的位会发生什么。它是用 1 还是 0 填充的？什么时候用 1 或 0 填充？

谷歌搜索“按位运算教程”似乎已经提出了一些有希望的结果。但是这里有一些基础知识可以用来测试你自己，以确保你理解

```
// 1234 in hexadecimal. Do you understand this is not 1234 in decimal? Do you understand
// how specifying in hex makes it easier to think about the binary representation?
unsigned short i = 0x1234;
// Flip all the bits in 0x1234
printf("%04x", ~i);

// Test - Is the most significant bit set?
// mask is a binary number with the most significant bit set. Do
// you understand why this is so?
unsigned short mask = 0x8000;
if ((mask & i) == mask)
{
    printf("bit set!");
}
else
{
    printf("bit cleared!");
}

// Set the most significant bit
i = i | mask;
printf("Set the MSB of i, check it out: %i\n", i)

// Set the second most significant bit
// Do you see how by shifting mask right one it becomes the next most significant bit?
i = i | (mask >> 1); 
```

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T15:13:35.327

将这些位写在纸上，考虑从一端擦除它们，然后在另一端添加更多。与小学不同，乘以 10 时移动小数点。

您所有的 C 函数都将移入零。

所以

```
x = y << 3; 
```

表示左移三位，右边的新位全为零。左边的三个位进入“位桶”：

```
x = z >> 2 
```

丢失右边的两位并在左边添加两个零。

您会发现缺少的功能以及 K&R 练习的内容。在现有的处理器类型中，您拥有比 C 或任何其他高级语言更多的转换能力。

您具有旋转功能，其中从一端移位的位在另一端移位。

因此，以这种方式向右旋转一位的数字 0xD 将是 0xE，因为最低有效位是 1，因此将 1101 向右移动，右侧的 1 变为左侧的 1 1110。

有时您会通过[ALU](https://en.wikipedia.org/wiki/Arithmetic_logic_unit)中的进位位进行轮换。假设进位位中有一个零，并且您将 0xD 旋转了一位 0 1101 留下 1 0110 a 0x6。再旋转一个，0 1011，你得到一个 0xB 等等。

你为什么要通过你问的进位位旋转？对于更大的数字，假设您有四个位寄存器并且想要进行 8 位移位，假设每个字母都是 bcde fghi 位，其中`a`是进位位，另外两组四位是四位寄存器。首先通过进位 e abcd fghi 循环左寄存器，然后通过进位 i abcd efgh 循环右寄存器。很酷；我们刚刚使用 4 位移位函数进行了 8 位移位。

如果您在开始之前清除了进位位（通常有此指令，或者您始终可以执行诸如添加 0+0 之类的操作或其他保证清除该位的操作），您将拥有

我 0bcd efgh

如果您说的是在 64 位数字上运行的 32 位指令集，这与 C 移位函数的作用没有什么不同。

处理器通常具有类似 C 的移位，其中一个零被移入，将 abcd 向左移动 1 得到 bcd0 将 abcd 向右移动 2 得到 00ab。

这给使用现代处理器的年轻人带来了一些问题……想想这些事情，因为他们的处理器都支持整数除法，并且可以在单个时钟周期内运行。早在我们进行除法之前，或者当除法是几十到几百个时钟时，但是移位是一个时钟，您可以使用移位来完成 2 次除法或乘法的所有功率。将数字 0x0D 左移 2 后得到 0b00001101 << 2 = 0b00110100 或 0x34。0xD 是十进制的 13，而 0x34 是十进制的 52。52 是 13 的四倍。四是 2 的 2 次方。移位 2 与乘以 4 相同。

这是双向的；0x34 右移 2 是 0xD，但这就是问题所在。当你得到负数时，将数字减去 4 0xFC，然后将其除以 2。使用 C 0xFC >> 1 将给出 0x7E，但 0x7E 是十进制的 +126。-4/2 = 126 怎么算？

问题是 C 在零处移动。您会发现某些处理器具有与逻辑移位不同的算术移位。算术移位保持最高位，所以如果你使用一个有符号数，比如 0bQWER，并且你算术右移一位，你会得到 0bQQwe。最高位都移动到下一位并保持在原来的位置。

再次移位 0bQQQW，以此类推。现在算术左移将移入零而不是最低有效位，因此 0bQWER 左移一位是 0bWER0。这是有道理的。-4 左移一位是 0xF8，即 -8，-4 乘以 2 是 -8，所以是正确的。

所以你会发现有些处理器只有算术右移，而没有左移。有些允许你指定一个 asl，但是当他们组装它时，用 lsl（逻辑左移）替换它，谁知道有些可能实际上有一个单独的操作码，即使它是相同的功能。我假设可能有一些有 asl 和 asr 和 lsr，但没有 lsl。

只需使用纸和铅笔并弄清楚事情。从实数作为例子开始，然后再抽象。想`0x1234`向右旋转一点，比方说？

```
0001001000110100  write out the bits
x0001001000110100 shift right one
0000100100011010  because this is a rotate fill in the new bit with the bit that fell off on the prior operation 
```

现在想右移两位

```
0000100100011010
xx0000100100011010
1000001001000110 
```

我将如何在 C 中进行一次旋转？

```
unsigned int rotate_right_one ( unsigned int x )
{
  unsigned int y;
  y = x & 1;  // Save the bit that is about to fall off the right
  x >> = 1;  // Logical rotate one bit
  x |= y<<31; // This assumes that unsigned int is 32 bits.
  return(x);
} 
```

要旋转更多，您可以简单地多次调用此函数，或者考虑掩码并在上方移动，以及它如何工作超过一位。

另请注意，某些处理器只有一种旋转功能。例如，想想这个。我有一个四位寄存器，我旋转 5 位。我能得到什么？

```
abcd
bcda  first rotate
cdab  second
dabc  third
abcd  fourth
bcda  fifth 
```

单向左旋转是什么样的？

```
abcd
bcda  one bit left. 
```

四位寄存器上的右五与左一相同 5-4=1。与 asl 一样，一些处理器允许您对操作进行编码，但汇编器使用 nbits-shift 作为旋转量，用另一个旋转替换该操作。

对于某些人来说，逻辑位运算就像指针一样难以理解，但它是基础，如果您学习并使用它，您将领先于您的竞争对手或您周围的人。

这是一个计算某个变量中位数的示例：

```
for(count=0, r=1; r; r<<=1) 
    if(r&some_variable) 
        count++; 
```

理解那行代码，你就可以很好地学习 C 和逻辑位操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-01-22T23:12:53.583

以 2-6 为例，我使用了 17、4、3、15 的值。
所以：

x = 17 或 10001

p = 4

n = 3

y = 15 或 01111

使用我的示例数字，我们需要在这里做的是从 y (111) 中取出三个 ls 位并将它们从位置 4 开始插入到 x 中。这将给我们 11111 或 31。我们需要从 x 开始清除 3 位位置四，清除 y 中除最右边 3 位之外的所有位，将它们移动到位置四并将两个值相或。

第一个：将所有1向左移动n个位置〜0 << n = 1111111111111000

第二：将所有的放在最右边的 n 个位置 ~(~0 << n) = 0000000000000111

第 3 步：将这 n 个 1 位移动到位置 p，并从位置 p 开始将 n 位设置为零。~(~(~0 << n) << (pn)) = 1111111111110001

4th: 这个掩码用 x 清除 x 在位置 p = 10001 的 n 位

（我相信每个人都意识到我们所做的只是回到我们的起始编号，但我们必须这样做以便告诉程序我们想要从哪个位置开始，以及我们想要使用多少位. 如果 p 是 6 而 n 是 4 怎么办？）

接下来清除 y 中的所有位，除了最右边的 n 位：

第一个： ~(~0 << n) 将所有的放在最右边的 n 个位置。0000000000000111

2nd: y & ~(~0 << n) 选择y的最右边n位 0000000000000111

3rd: (y & ~(~0 << n)) << (pn) 将 y 的 n 位放在位置 p 0000000000001110 最后 OR 两个结果一起

0000000000010001 = 17

0000000000001110 = 7 或=

0000000000011111 = 31

结果变为：

> 返回 x & ~(~(~0 << n) << (pn)) | (y & ~(~0 << n)) << (pn);

如果这很难阅读，我很抱歉。我的格式化能力有些受限。（我确信这是我的错）我希望这会有所帮助，我一直坚持这个特定的练习很长一段时间，今天终于想出了这个解决方案，在看了这个帖子之后，所以我想我会发布正确的答案，并解释为什么它是正确的答案，这是我发现在我见过的许多答案中缺乏的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T22:03:18.120

让我们尝试 2-6，让您了解位操作的工作原理，然后看看它是否有意义。

```
int setbits( int x, int p, int n, int y )
{
    int bitmask = ~0, y_right = 0; 

    /* Ok, first let's get y's rightmost bits.
     * Take our bitmask, shift it left by n bits, leaving the least significant
     * n bits as 0\. Then, flip the bitmask so the rightmost n bits become 1, and the
     * leftmost n bits become 0.
     *
     * Then, AND this bitmask with y, to yield y's n rightmost bits.
     */
    bitmask = ~( bitmask << n );
    y_right = bitmask & y;

    /*
     * Ok, now let's use y_right as our bitmask for x.
     * Shift y_right to the left to *begin* at position p.
     */
     y_right <<= p - n;
     x |= y_right;

     return x;
} 
```

注意：以上可能完全不正确，因为我还没有测试过，但它应该给你一个不错的开始。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-14T16:00:46.900

如果你有钱（和时间），就拿一份[Hacker's Delight](https://rads.stackoverflow.com/amzn/click/com/0321842685)（Henry S. Warren 着）。它可能是最好的移位指南。它将带您完成简单的转变（和其他操作技术），一直到[格雷码](https://en.wikipedia.org/wiki/Gray_code)等等......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-14T16:16:19.973

让我们做一个练习，作为示例。

> 练习 2-6：编写一个函数 setbits(x, p, n, y)，它返回 x，从位置 p 开始的 n 位设置为 y 的最右边 n 位，其他位保持不变。

让我们记住，最低有效位是位 0（位于位置 0）。

这是伪代码：

1.  将 x 中的 p 到 p+n 位移动到位置 0 到 n。那就是你右移的地方。
2.  准备一个位掩码，它将位 n 到最高位的任何内容变为 0。您可以为此使用查找数组（例如，0xFF 表示 n=8，0x7F 表示 7 等等），或者您可以在循环中使用设置位 0 和左移的组合。
3.  将位掩码应用于`x`using `&`。我们不关心的所有位`x`现在都是 0。
4.  反转位掩码。我们现在在高端有一堆 1，在低端有一堆 0。我们要在 y 中更改的位在位掩码中都有 0。
5.  使用 & 将位掩码应用于 y。我们将用 x 中的位替换的 y 中的所有位现在都设置为 0，我们不想更改的位保持不变。
6.  通过组合 x 和 y 来设置我们想要在 y 中更改的位`|`。这是关键点——用笔和纸复习正在发生的事情。x 中在 (3) 中设置为 0 的位不会影响 y 中的相应位。x 中不受 (3) 影响的位将与 y 中的 0 组合（由于 step5 为 0），将结果位设置为它在 x 中的值。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-14T17:09:39.600

请记住，几乎所有这些练习都有一个简单的解决方案，可以使用函数 int IsBitSet(int i, int n); 编写。int SetBit(int i, int n); << 和 >> 的组合。直接的解决方案几乎都是最坏的情况，但更容易实现和阅读。这有点像在加法方面实现乘法或在增量方面实现加法。

# cocoa-touch - 什么会影响 stringWithContentsOfFile" 返回的 NSString 的生命周期？

> ID：443268
> 
> 赞同：0
> 
> 时间：2009-01-14T15:02:46.487
> 
> 标签：cocoa-touch, string, file-access

考虑以下两种从文件中读取字符串的方法：

```
NSString *path = [[NSBundle mainBundle] pathForResource:@"foo" ofType:@"txt"];
NSString *string = [NSString stringWithContentsOfFile:path encoding:NSASCIIStringEncoding error:NULL]; 
```

* * *

```
NSString *path = [[NSBundle mainBundle] pathForResource:@"foo" ofType:@"txt"];
NSFileHandle *file = [NSFileHandle fileHandleForReadingAtPath:path];
NSData *data = [file readDataToEndOfFile];
NSString *string = [[NSString alloc] initWithData:data encoding:NSASCIIStringEncoding];
[file closeFile]; 
```

我更愿意依赖方法#1，但在以下上下文中使用时它的行为很奇怪：

```
NSString *string; // CLASS VARIABLE
(void) setupView
{
  string = ...; // LOADING THE STRING
}
(void) drawView
{
 ...;  // USING THE STRING
} 
```

简而言之，它是一个基于 NSTimer 的 OpenGL-ES 绘图循环。问题是字符串只能在第一帧访问。在下一帧，iPhone 模拟器 (2.2) 在尝试访问字符串时崩溃。

可能有人会说“我的代码或我正在使用的 OpenGL-ES 代码中的某些东西”......但是如何解释一个奇怪的事实，即如果我使用方法 #2 加载字符串，一切都按预期工作？

有什么线索吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T15:44:33.347

在 Cocoa 中，只有使用`alloc`、或. 每当您不拥有一个对象时，您就无法保证该对象在您使用它的本地范围之外。在您的示例中，由于您没有使用上述任何方法创建新字符串，因此如果您存储它，您无法保证它会在以后出现。`new``copy``retain`

为了获得您尚未拥有的对象（即，您希望它保留以便以后使用）的所有权（即，您没有使用前面提到的方法之一创建它） ，您必须向该对象发送保留消息。例如，如果您如下所示重写代码，您将拥有该字符串，并且您不必担心以后使用它：

```
// option 1
NSString *path = [[NSBundle mainBundle] pathForResource:@"foo" ofType:@"txt"];
NSString *string = [[NSString alloc] initWithContentsOfFile:path encoding:NSASCIIStringEncoding error:NULL];

// option 2
NSString *path = [[NSBundle mainBundle] pathForResource:@"foo" ofType:@"txt"];
NSString *string = [NSString stringWithContentsOfFile:path encoding:NSASCIIStringEncoding error:NULL];
[string retain]; 
```

选项 1 没问题，因为您专门创建了带有`alloc`消息的字符串。您现在拥有该字符串对象，直到您在其他时间放弃所有权。考虑到您的特定情况，这可能是您的最佳选择（即，您真的不想使用便利构造函数，因为您希望字符串对象在以后使用）。

选项 2 没问题，因为您通过将`retain`. 在您的情况下，这可能不是最佳选择，因为 `alloc/init`已经有一个可用的选项并且通常更易于阅读。

当您完成一个对象并且想要放弃该对象的所有权时，您向该对象发送`release`消息。重要的是要记住，在 Cocoa 中，向对象发送`release`消息并不意味着您要销毁它，而只是放弃所有权。

Cocoa 内存管理是围绕对象所有权的思想设计的。虽然一开始可能会有点混乱，但是一旦你开始理解它，它就会使在环境中编程变得更加容易，而不会引入内存错误、泄漏或其他错误。便利方法（如`stringWithString`）真正设计用于当您想要创建一个您实际上只在短时间内使用并且在单个函数或程序块范围内的对象时使用。如果您打算将对象保留在该范围之外，则首选使用`alloc/init`or`new`方法来构造对象。

有关更多信息，请阅读[Cocoa 的内存管理编程指南](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/MemoryMgmt.html)。它确实被认为是 Cocoa 开发人员的必读。此外，通常需要阅读、试验和再阅读几次才能真正掌握，尤其是如果您对其他内存管理模型有很多经验的话。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T15:12:42.160

当您使用 Class 方法创建 String 时，通常会将其添加到最顶层的自动释放池中。在事件循环结束时，池向它持有的所有对象发送释放消息。在这种情况下，新创建的字符串的保留计数等于 1，并且在循环结束时它达到 0 并被释放。如果要保留字符串，请向其发送保留消息，以在事件循环结束时保持保留计数为正。

# javascript - 使用原型通过 Ajax 提交表单并更新结果 div

> ID：443276
> 
> 赞同：8
> 
> 时间：2009-01-14T15:05:06.153
> 
> 标签：javascript, ajax, prototypejs, form-submit

我想知道如何通过 Ajax（使用原型框架）提交表单并在“结果”div 中显示服务器响应。html 看起来像这样：

```
<form id="myForm" action="/getResults">
    [...]
    <input type="submit" value="submit" />
</form>
<div id="result"></div> 
```

我尝试将一个javascript函数（使用Ajax.Updater）附加到“onsubmit”（在表单上）和“onclick”（在输入上），但在函数结束后表单仍然是“非Ajax”提交（所以整个页面被结果替换）。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-01-14T15:21:03.627

查看 Prototype API 的页面[`Form.Request`](http://www.prototypejs.org/api/form/request)和[`Event`](http://www.prototypejs.org/api/event)处理。

基本上，如果你有这个：

```
<form id='myForm'>
.... fields ....
<input type='submit' value='Go'>
</form>
<div id='result'></div> 
```

你的 js 或多或少是：

```
Event.observe('myForm', 'submit', function(event) {
    $('myForm').request({
        onFailure: function() { .... },
        onSuccess: function(t) {
            $('result').update(t.responseText);
        }
    });
    Event.stop(event); // stop the form from submitting
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-14T15:11:44.690

您需要从 ajax 函数返回值 false，这会阻止标准表单提交。

```
<form id="myForm" onsubmit="return myfunc()" action="/getResults">

function myfunc(){
   ... do prototype ajax stuff...
  return false; 
```

}

在表单上使用 onsubmit 还可以捕获使用 enter 键提交的用户。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-14T15:16:34.867

您首先需要[序列化您的表单](http://www.prototypejs.org/api/form/serialize)，然后调用[Ajax Updater](http://www.prototypejs.org/api/ajax/updater)，使用[POST 选项](http://www.prototypejs.org/api/ajax/options)并将序列化的表单数据传递给它。然后结果将出现在您指定的元素中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T15:27:34.363

您需要停止`onsubmit`事件的默认操作。

例如：

```
function submit_handler(e){
    Event.stop(e)
} 
```

[有关在 Prototype 中停止默认事件行为的](http://www.prototypejs.org/api/event/stop)更多信息»

# mysql - 有没有办法在 INSERT 语句中命名列？

> ID：443280
> 
> 赞同：2
> 
> 时间：2009-01-14T15:06:03.097
> 
> 标签：mysql, syntax, insert

当我在 PHP 代码中执行 SELECT 语句时，我总是选择命名列，例如：

```
SELECT id, name from users; 
```

而不是使用：

```
SELECT * from users; 
```

这样做的好处是信息量更大、可读性更强，并且还可以避免以后在表中添加新列时出现问题。

我想知道的是，是否可以在 INSERT 语句中使用相同的想法？我想象它可能是这样的：

```
INSERT into people values (id=1, name="Fred"); 
```

我在此示例中显示的语法不起作用，但我想知道是否可以使用等效的方法？如果没有，有谁知道为什么不？是故意遗漏吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-01-14T15:08:01.203

```
INSERT INTO table_name (column1, column2, column3,...)
VALUES (value1, value2, value3,...)

INSERT INTO people (id, name)
VALUES (1, 'Fred'); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-14T15:08:14.340

```
INSERT into people(id,name) values (1, 'Fred'); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-14T15:08:33.463

你想要的是

```
INSERT INTO PEOPLE ( id, name ) VALUES ( 1, 'FRED' ) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-14T15:08:23.683

```
INSERT INTO table (column_1, column_2, column_3, ...)
VALUES (value_1, value_2, value_3, ...) 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-14T15:09:07.770

使用`INSERT INTO <table> (col1, col2) VALUES (1,2)`.

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-14T15:09:05.180

试试这个方法： INSERT INTO people (id, name) VALUES (1, "Fred");

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-14T15:09:56.300

这种情况的语法是

> 插入人员（id，name）值（1，'Fred'）；

至少它在我使用的 dbms 中有效（PostgreSQL）

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-14T15:28:09.260

只有 MySQL 才有这种语法。Afaik，其他 RDBMS 不允许这样做。这是语法：

```
INSERT INTO games SET yr = 2012, city = 'London'; 
```

我希望 PostgreSQL 促进这种插入语法

然而，标准 ANSI 语法将是

INSERT into people (yr, city) values (2012, 'London');

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-14T12:49:18.630

使用标准语法，您可以一次插入多行：

```
INSERT INTO Table (column1,...,columnN) VALUES
(r1v1, ..., r1vN),
(r2v1, ..., r2vN),
(r3v1, ..., r3vN). 
```

这是比一次一行（尤其是在 MySQL 中）[*更快*的数据导入方式！](http://dev.mysql.com/doc/refman/5.0/en/insert-speed.html)我不认为你可以做同样的使用

```
INSERT INTO Table SET column1 = r1v1, ..., columnN = r1vN 
```

句法。

（根据个人经验，一次插入 300000 行需要几分钟。当我将脚本更改为仅使用少量插入语句时，每个插入数千行，只需几秒钟即可将其全部导入，MySQL 5.0）。

# eclipse - 如何在 Eclipse 中使用引用的项目

> ID：443286
> 
> 赞同：5
> 
> 时间：2009-01-14T15:08:11.127
> 
> 标签：eclipse, struts

好吧，也许每个人都知道如何做到这一点，但我从来没有尝试过，因为我从来不需要它，你如何在 eclipse 中处理多个引用的项目？我有几个 Struts 1 Web 应用程序必须使用另一个 struts 1“库”项目，现在我正在使用 url 请求在它们之间进行通信，这真的很烦人（至少我是如何实现它的）。

我希望能够直接在我的其他 struts 应用程序中使用“库”项目的类。

到目前为止，我知道应该在同一个工作区中，并且我必须使用项目属性中的“项目引用”选项进行引用，但就是这样！我真的不知道接下来该怎么办。

谢谢！

* * *

好的，做到了！现在，当我在 WAR 文件中导出 struts 应用程序时，struts 库应用程序会发生什么？我需要在单独的 WAR 文件中导出，还是仅通过导出主应用程序 WAR 也会导出库 Web 应用程序的**所有文件？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-14T15:10:38.157

项目菜单 -> 属性

转到 Java 构建路径。

在那里，您可以直接添加库或将另一个项目添加到当前项目的构建路径中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-08T22:41:14.740

您可能只需要必要的 jar 文件并将它们包含在您的 WAR 中，或者将它们添加到您的应用程序服务器（许多有不同的方法来执行此操作）。

另一种选择是将每个 WAR 捆绑在一个 EAR 文件中。这种方法不适用于 Tomcat，但适用于 WebSphere、WebLogic ...

# version-control - 恢复 Team Foundation Server

> ID：443294
> 
> 赞同：3
> 
> 时间：2009-01-14T15:09:57.317
> 
> 标签：version-control, tfs, backup

我们正在考虑从 Subversion 迁移到 Team Foundation Server 以满足我们的源代码控制要求。这背后的原因是我们的项目团队越来越大，管理层对使用 M'soft 产品而不是开源解决方案感到更自在（我知道 - 我试图争辩这种说法的愚蠢，但没有得到任何结果） .

到目前为止，我们没有遇到任何问题，除了复制如果基础服务器盒完全死机而我们只剩下备份会发生的情况。我们已经尝试按照以下链接中的计划进行操作 - [http://msdn.microsoft.com/en-us/library/ms404869.aspx](http://msdn.microsoft.com/en-us/library/ms404869.aspx) - 但事实证明这非常困难！

我们只是想知道这是否应该如此痛苦，或者我们是否真的很昏暗或其他什么。我知道结合使用 Subversion 和 Tortoise，我可以在几个小时内让整个系统恢复运行，但目前这需要几天时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T02:18:51.677

恢复 TFS 服务器是一件痛苦的事，你不仅仅是昏暗的。您可能需要考虑使用备用服务器（应用层和数据层都适用）。切换到待机也不会太痛苦，可以很快完成。当然，您仍然需要备份以防万一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T02:46:15.367

应该不需要几天的时间。你有一些巨大的 WSS 数据库吗？如果是这样，您可以在初始恢复期间忽略这些，因为那不是您的核心源代码所在的位置。

最重要的是让您的应用层和数据库重新上线。最简单的方法可能是通过 cornetdesign dot com 的 foyc 给我发电子邮件，我可以帮助您完成它，或者让您与合适的人取得联系。但我已经处理过重要的恢复，而且以前从来没有过几天。

# c++ - 矩阵的缓存策略和技术

> ID：443295
> 
> 赞同：1
> 
> 时间：2009-01-14T15:10:07.953
> 
> 标签：c++, caching

如前所述，我目前正在开发一个用于个人项目的小型线性代数库。矩阵被实现为 C++ 向量，元素赋值 (a(i,j) = v; ) 被委托给向量元素的赋值。对于我的项目，我需要求解大量的方方程系统，为此，我为方阵实现了 LU 分解（高斯消元法）。在当前的实现中，我避免每次通过缓存 L 和 U 矩阵来重新计算 LU 分解，问题是由于我将元素分配委托给向量，我无法找到一种方法来判断矩阵是否正在更改以及是否重新计算分解。关于如何解决这个问题的任何想法？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T18:06:44.290

```
template<class T>
class matrix {
public:
    class accessor {
    public:
        accessor(T& dest, matrix& parent) : dest(dest), parent(parent) { }
        operator T const& () const { return dest; }
        accessor& operator=(T const& t) { dest = t; parent.invalidate_cache(); return *this; }
    private:
        T& dest;
        matrix& parent;
    };

    // replace those with actual implementation..
    accessor operator()(int x, int y) {
        static T t; return accessor(t, *this);
    }
    T const& operator()(int x, int y) const {
        static T t; return t;
    }

private:
    void invalidate_cache() { cout << "Cache invalidated !!\n"; }
    vector<T> impl;
}; 
```

感谢##iso-c++ @ irc.freenode.net 进行一些有用的更正

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-14T15:20:57.213

如果我理解正确，您需要在代码执行期间检查矩阵是否已更改。

好吧，向量不支持这样的功能。但是，您可以做的是编写自己的 Matrix 类，向其中添加此类功能并使用它来代替向量。

一个示例实现可能是：

```
class Matrix {
public:
    Matrix() : hasChanged(false) {}

    double setElement(int i, int j, double value) {
        innerStorage[i][j] = value;
        hasChanged = true;
    }

    double getElement(int i, int j) {
        return innerStorage[i][j];
    }

    void clearHasChangedFlag() {
        hasChanged = false;
    }

private:
    vector<vector<double> > innerStorage;
    bool hasChanged;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T15:17:24.400

您的描述听起来像是您正在就地进行 LU 分解。从内存的角度来看，这肯定更有效。这意味着在执行分解时覆盖矩阵值。如果这是真的，那么“被改变以及是否重新计算分解”是一个有争议的问题。当您使用 LU 分解覆盖原始矩阵时，您会丢失原始矩阵。

如果您没有覆盖原始数据，那么每当您给矩阵元素一个新值时，听起来您也想重新计算分解。我建议你不要这样做。对我来说似乎效率低下。如果客户想要更改许多值，他们可能不想在全部完成之前支付另一个 LU 分解的成本。

您可以尝试使用工厂接口进行矩阵转换/分解。这是一个简单的方法，它将接收一个 Matrix 并返回一个（分解的）矩阵。您可以以这种方式保留原始矩阵；返回值是一个新实例。您可以更改原始然后将其传递给工厂以重新计算 LU 分解。它会消耗您的内存，这对于非常大的矩阵来说可能是一个问题。

在Java中，我会这样写：

```
public interface MatrixDecomposition
{  
    Matrix decompose(Matrix original);
} 
```

在 C++ 中，它是一个纯虚函数。（太长了——我不记得语法了。）

还有其他类型的分解（例如，QR、SVD 等），因此这种设计将在您需要时很好地适应它们。只需为接口编写另一个实现，Bob 就是你的叔叔。

许多物理问题都以“稀疏”矩阵为特征，这些矩阵具有聚集在对角线周围的非零值带宽和外部零值。如果您使用不将零值存储在带宽之外的特殊技术，您可以解决更大的内存问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T16:39:05.530

Frederick 建议的 setElement 和 getElement 版本是一个选项，但使用它太无聊了。我想用相同的语法在读写时访问 a(i,j) ，而不用担心我是否正在修改矩阵。最好的办法可能是让用户修改矩阵，并在他认为有必要时将重新计算 LU 分解的责任委托给他。然而它会很无聊。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T16:56:54.027

保留与上次 LU 因式分解一起使用的 Matrix 的完整隐藏副本并在重新执行之前以 O(n*m) 时间检查它怎么样？丑陋但可以工作。

# emacs - Emacs：如何编译（运行make）而不按回车进行编译命令查询？

> ID：443302
> 
> 赞同：14
> 
> 时间：2009-01-14T15:11:54.317
> 
> 标签：emacs, macros, makefile, xemacs

使用 (x)emacs，如何在不单独按 Enter 接受默认命令的情况下运行“编译”命令？（我可以将“编译”绑定到一个键，但我希望整个事情发生而无需单独按 Enter）

当然，使用其他命令的类似行为也可以。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-01-14T15:44:22.237

当我实际上想更改命令行时，我曾经`(setq compilation-read-command nil)`在我的`.emacs`和调用中使用前缀参数：`compile``C-u M-x compile`

从那以后，我发现这个`recompile`命令更接近我想要的。最重要的是，它不会提示输入命令行。这是我实际绑定到功能键的命令。

然后通常的工作流程是：`M-x compile`每个项目的第一次，以及`F9`编辑-编译-测试过程的每次迭代。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-14T15:19:20.230

唔，

经过一番谷歌搜索后，我从[EmacsWiki 中找到了答案：编译命令](http://www.emacswiki.org/emacs/CompileCommand)（在**No prompt for command 下**）：

```
(setq compilation-read-command nil) 
```

希望以后对其他人有所帮助。不再为相同的默认命令按回车键。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-07T14:13:02.600

最明显的方法是调用 Mx recompile

# asp.net - 审计代码的工具转移到生产 Web 服务器？

> ID：443303
> 
> 赞同：1
> 
> 时间：2009-01-14T15:12:17.293
> 
> 标签：asp.net, migration, audit

我的团队最近收到了外部审计的结果，我们必须更正一项。

他们希望我们改变将代码移动到生产环境的方式。我们目前对所有代码更改和移动请求等使用源代码控制和票务系统。

问题在于如何将代码推送到我们的生产网络服务器。而不是使用 Araxis Merge 或差异工具。他们希望我们使用能够对移动的文件进行全面审核的工具。审核员稍后将检查该工具的日志，以确保只有经过批准的代码才能投入生产。

有人使用这样做的工具吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T19:52:30.863

我的建议是不要将文件从一个环境移动到另一个环境，而是开始实施候选版本打包。

这些软件包可以使用归档工具（tar、winzip）或更复杂的工具（如 Wise Installer 或 InstallShield）从简单的方式实现。

循环将类似于以下内容：

*   从发布候选标签分支构建发布候选，其中包括准备通过测试挑战的合并变更集，
*   将构建中的所有文件打包到 tar/zip/setup.exe
*   通过同一个包部署到各种测试环境
*   如果候选发布通过测试，则可以使用相同的包部署到生产环境；如果没有，请回到第一方并组合另一位候选人。

如果候选发布失败，则将候选发布指定为失败的基线，实施修复，并构建和打包另一个候选发布。

虽然我通常不赞成将构建的对象放入源代码存储库，但从方便和控制的角度来看，可以将包置于控制之下，以确保在使用包从一个部署的时间之间不会对其进行任何更改环境到另一个。

候选发布版本 ID 应用于包和相关代码分支的命名约定中，以确保明显的关系。如果可能，将版本 ID 信息放入资源文件有助于确保来自正确构建的文件存在于正确的位置。

我的偏好是构建所有内容并部署所有内容，即使只更改了一个文件。每次构建、打包和部署所有内容都可以使脚本和流程保持简单和可重复。

基本上...构建一次，经常部署。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T15:23:01.877

我会使用[MSDeploy](http://blogs.iis.net/msdeploy/)。这是[Application Center 2000](http://www.microsoft.com/applicationcenter/evaluation/overview/default.mspx)的继任者。这将允许您构建包（文件、GAC 程序集、DB、COM...）并从 DEV --> QA -- PROD 推送它们。这样，您将确保完全部署，并且可以归档日志以满足审计要求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T04:20:06.253

robocopy e:\src\WebApp \\production_server\wwwRoot\WebApp >> auditme.txt

# java - 使用 Java 和 UTF-8 编码生成有效的 XML

> ID：443305
> 
> 赞同：19
> 
> 时间：2009-01-14T15:13:39.320
> 
> 标签：java, xml, encoding, utf-8

我正在使用 JAXP 生成和解析一个 XML 文档，其中一些字段是从数据库中加载的。

序列化 XML 的代码：

```
DocumentBuilder builder = DocumentBuilderFactory.newInstance().newDocumentBuilder();
Document doc = builder.newDocument();
Element root = doc.createElement("test");
root.setAttribute("version", text);
doc.appendChild(root);

DOMSource domSource = new DOMSource(doc);
TransformerFactory tFactory = TransformerFactory.newInstance();

FileWriter out = new FileWriter("test.xml");
Transformer transformer = tFactory.newTransformer();
transformer.setOutputProperty(OutputKeys.INDENT, "yes");
transformer.setOutputProperty(OutputKeys.ENCODING, "UTF-8");
transformer.transform(domSource, new StreamResult(out)); 
```

解析 XML 的代码：

```
DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
factory.setNamespaceAware(true);
DocumentBuilder builder = factory.newDocumentBuilder();
Document doc = builder.parse("test.xml"); 
```

我遇到以下异常：

```
[Fatal Error] test.xml:1:4: Invalid byte 1 of 1-byte UTF-8 sequence.
Exception in thread "main" org.xml.sax.SAXParseException: Invalid byte 1 of 1-byte UTF-8 sequence.
    at org.apache.xerces.parsers.DOMParser.parse(Unknown Source)
    at org.apache.xerces.jaxp.DocumentBuilderImpl.parse(Unknown Source)
    at javax.xml.parsers.DocumentBuilder.parse(Unknown Source)
    at com.test.Test.xml(Test.java:27)
    at com.test.Test.main(Test.java:55) 
```

字符串文本包括 u-umlaut 和 o-umlaut（字符代码 0xFC 和 0xF6）。这些是导致错误的字符。当我自己转义字符串以使用 ü 和 ö 然后问题就消失了。当我写出 XML 时，其他实体会自动编码。

如何在不自己替换这些字符的情况下正确写入/读取我的输出？

（我已经阅读了以下问题：

[如何将字符从 Oracle 编码为 XML？](https://stackoverflow.com/questions/156697/how-to-encode-characters-from-oracle-to-xml)

[修复 XML 文件中的错误编码](https://stackoverflow.com/questions/216890/repairing-wrong-encoding-in-xml-files)）

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-14T15:26:52.180

使用 FileOutputStream 而不是 FileWriter。

后者应用自己的编码，几乎可以肯定不是 UTF-8（取决于您的平台，它可能是 Windows-1252 或 IS-8859-1）。

编辑（现在我有时间）：

允许将没有序言的 XML 文档编码为 UTF-8 或 UTF-16。使用序言，可以指定其编码（序言只能包含 US-ASCII 字符，因此序言始终是可读的）。

Reader 处理字符；它将解码底层 InputStream 的字节流。结果，当您将 Reader 传递给解析器时，您是在告诉它您已经处理了编码，因此解析器将忽略序言。当您传递 InputStream （读取字节）时，它不会做出此假设，并且会查看序言来定义编码 - 如果不存在，则默认为 UTF-8/UTF-16。

我从未尝试过读取以 UTF-16 编码的文件。我怀疑解析器会寻找字节顺序标记 (BOM) 作为文件的前 2 个字节。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-14T15:32:46.427

好吧，肯定不是有效`0xFC`字符。这些应该被限定为两个字节序列：和.`0xF6``UTF-8``0x3CBC``0x3CB6`

最有可能的问题是字符的原始来源被定义为`UTF-8`当它们不是时。

# java - 在调用超类的构造函数之前不可能执行初始化吗？

> ID：443310
> 
> 赞同：2
> 
> 时间：2009-01-14T15:15:02.577
> 
> 标签：java, xml

我想要具有某些构造函数参数的某个超类的子类来加载一个 XML 文件，其中包含我想传递给超构造函数的信息。这是不可能实现的吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-14T15:18:00.793

改用工厂方法怎么样？也许是这样的：

```
private MyObject(ComplexData data)
{
    super(data);
}

public static MyObject createMyObject(String someParameter)
{
    ComplexData data = XMLParser.createData(someParameter);
    return new MyObject(data); 
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-14T15:19:13.443

您可以在 super() 调用中调用静态方法，例如

```
public Subclass(String filename)
{
    super(loadFile(filename));
}

private static byte[] loadFile(String filename)
{
    // ...
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T15:22:03.203

不可能，不。凌乱，可能非常。

我以前需要这样做，并发现最简单最干净的方法和处理它是在调用构造函数之前加载数据，然后将其作为参数传递。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T15:21:56.090

我喜欢工厂的答案，但有时您也可以执行以下操作：

```
public MyObject(String parm) {
    super(parseComplex(parm));
}

private static ComplexData parseComplex(String parm) {
    ....
    return new ComplexData(...);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T15:36:39.257

我喜欢马修斯的建议。一种变体是创建管理预加载数据的对象，并将这些对象传递给对象的构造函数。

我在为客户工作的项目中这样做。有一堆配置文件需要加载。在构建依赖对象之前，我还需要建立数据库和 Web 服务连接。

它工作得很好，很简单，当其他人继承此代码时，他们将很容易遵循逻辑。这提高了客户的价值。

# c++ - 重载删除，纯虚函数调用

> ID：443315
> 
> 赞同：1
> 
> 时间：2009-01-14T15:17:07.473
> 
> 标签：c++, operator-overloading

所以我想重载删除抽象虚拟类。这将在另一个库中的派生类中调用 deleteMe()。这是为了防止这里提到的错误/崩溃[C++ mix new/delete between libs?](https://stackoverflow.com/questions/443147/c-mix-new-delete-between-libs)

当我在我的基类中调用 delete me from delete 时，我收到错误“纯虚拟函数调用”。然后我发现它已经调用了我的 dtor。我如何重载删除或以不调用 dtor 的方式编写此代码，以便我可以编写删除 obj；并让它调用 obj->deleteMe() 然后调用它自己的删除函数和 dtor？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-14T15:39:20.830

听起来你使用 operator delete 就像一个应该做任意事情的普通函数。然而，操作符 delete 只应该释放作为第一个参数提供给它的内存，它是指向该内存区域的指针。

该指针将指向您的对象所在的内存位置。但是，此时，您的对象的析构函数已经运行，并且您的对象不再存在。你根本不能在它上面调用任何成员函数——更不用说虚函数了！

我感觉你把操作员删除的目的弄错了。如果调用`delete pointer`，编译器会调用对象的析构函数，然后调用释放函数释放分配的内存，这就是调用`operator delete`。

那么，为什么不使用我们之前向您展示的解决方案`boost::shared_ptr`呢？

# iphone - 如何将 UIWebView 放置在表格视图单元格中并维护其滚动条？

> ID：443333
> 
> 赞同：0
> 
> 时间：2009-01-14T15:19:54.923
> 
> 标签：iphone, cocoa-touch, uiwebview

如何将 UIWebView 放置在表格视图单元格中，同时保持 UIWebView 的滚动条？我的表格视图也有多个单元格和一个标题框架，我确实需要它是可滚动的，因为它有很多行。

当我使用 UITextView 时，文本显示得非常好，它也显示滚动条，但问题是我的内容是富文本，所以我没有任何其他选择，只能在 UIWebView 中显示内容。任何想法，黑客？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T10:41:35.707

除非苹果对此有所作为，否则这是行不通的。UITableView 和 UIWebView 都支持滚动条，但它们相互矛盾。UITableView 滚动条具有优先权，因此无论何时执行滚动操作，该操作都会发送到 UITableView 而不是 UIWebView。

出于某种原因，当 UITextView 与 UITableView 一起使用时，滚动条对两者都有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-16T06:29:35.710

将 UIWebView 添加到表格单元格的问题是这两个对象都是可滚动的（tableview 和 webview），如果使用不当，将会产生并发症。除了 uiwebview，你的 tableview 有其他单元格吗？你需要tableview可以滚动吗？如果 tableview 不需要滚动，请在 webview 中启用滚动并为 tableview 禁用滚动。那应该行得通。

但是如果你只想显示文本，为什么不使用 UITextView （尽管你也会面临 UITextView 的同样问题）？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-01-11T15:56:48.460

我刚刚在 UIWebView 文档中找到了这个：

“重要提示：您不应该在 UIScrollView 对象中嵌入 UIWebView 或 UITableView 对象。如果这样做，可能会导致意外行为，因为这两个对象的触摸事件可能会混淆并错误处理。”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T15:31:29.440

当您将内容放入 UIWebView 时，滚动条会自动添加。请务必在界面生成器中取消选中“缩放页面以适合”，以便页面在显示时不会重新缩放。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-14T15:56:55.083

当 UIWebView 的内容超过 UIView 的高度时，它会自动显示滚动条。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-10T21:52:13.003

您可以将 UIWebView 放入 UIScrollView 并通过将`canCancelTouchEvents`UISCrollView 的属性设置为`NO`. 如果你只是轻弹， UIScrollView 将滚动。如果您的手指短时间按住然后开始轻弹，UIWebView 将滚动。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-01-06T22:53:51.327

试试这个快速破解，看看你是否可以强制 web 视图显示滚动指示器： ((UIScrollView*)[webView.subViews objectAtIndex:0]).showsVerticalScrollIndicator = YES;

更彻底的方法是将您的单元格内容分为摘要和详细信息。在每个单元格中显示摘要，但不显示详细信息。选择单元格后，使用新屏幕显示所选单元格的全部内容。这完全避免了在可滚动视图中具有可滚动视图的可用性问题。

# java - 有没有办法从 MS-Dataset XSD 文件生成 java 类？

> ID：443356
> 
> 赞同：1
> 
> 时间：2009-01-14T15:25:47.533
> 
> 标签：java, xsd, code-generation, dataset

给定一个 Dataset XSD 文件，是否可以生成不使用 System.Data 的 java 类？我尝试使用 JAXB 的 XJC 工具运行测试，但它并没有产生任何非常有用的东西。

更新：按照 Fernando 的建议，我也尝试了 XmlBeans，它生成了类似于 XJC 输出的内容——即表的类表示，但没有任何列、约束或行。我可以在外观中添加这些东西，但理想情况下，它们将由使用的任何 XSD 编译器生成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T15:36:17.310

您可以尝试[XMLBeans](http://xmlbeans.apache.org/)而不是 JAXB API。您可以通过命令行命令或仅使用 ANT 脚本来调用它。我过去了调用 XMLBeans 将 XSD 编译为 jar 文件的 build.xml 文件的一部分。

```
<taskdef name="xmlbean" classname="org.apache.xmlbeans.impl.tool.XMLBean" classpathref="classpath"/>

<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<!--  Crea y compila las clases del modelo                             -->
<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

<target name="build" description="--> crea las clases a partir del schema">
    <!-- Borra los fuentes del modelo -->
    <delete quiet="true" dir="${build.dir}/src" />

    <mkdir dir="${build.classes}"/>

    <!-- Construye fuentes asociadas y crea las clases -->
    <xmlbean srcgendir="${build.dir}/src" classpathref="classpath" classgendir="${build.classes}">
        <fileset dir="${src.dir}" excludes="**/*.xsd"/>
        <fileset dir="${schemas.dir}" includes="**/*.*"/>
    </xmlbean>

    <javac srcdir="${src.dir}" 
                destdir="${build.classes}" 
                encoding="Windows-1252" 
                debug="${debug}" 
                debuglevel="${debuglevel}" 
                deprecation="${deprecation}" 
                verbose="${verbose}" 
                optimize="${optimize}" 
                source="${source}" 
                target="${target}">
                <classpath refid="classpath" />
    </javac>
</target> 
```

# powershell - 如何在 PowerShell 上转义命令行参数？

> ID：443375
> 
> 赞同：9
> 
> 时间：2009-01-14T15:32:34.820
> 
> 标签：powershell

看来我可以使用单引号或双引号转义命令行参数：

```
PS C:\> echo Hello World
Hello
World
PS C:\> echo 'Hello World'
Hello World
PS C:\> echo "Hello World"
Hello World 
```

但是还有一些我无法弄清楚的事情，那就是当您希望从包含空格的目录中运行可执行文件时：

```
PS C:\> c:\program files\test.exe
The term 'c:\program' is not recognized as a cmdlet, function, operable program, or script file. Verify the term and try again.
At line:1 char:11
+ c:\program  <<<< files\test.exe
PS C:\> 'c:\program files\test.exe'
c:\program files\test.exe
PS C:\> "c:\program files\test.exe"
c:\program files\test.exe
PS C:\> 
```

如何让 PowerShell 运行上面的可执行文件？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-14T15:38:20.470

尝试在命令前加上 & 号。例如

```
& 'C:\Program Files\winscp\winscp.exe' 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-14T15:36:41.567

用这个：

```
. "c:\program files\test.exe" 
```

实际上，更好的解决方案是：

```
Invoke-Item "c:\program files\test.exe" 
```

或使用别名：

```
ii "c:\program files\test.exe" 
```

使用 Invoke-Item 意味着将使用正确的 Windows 文件处理程序。所以对于一个 EXE 文件，它会运行它。例如，对于 .doc 文件，它将在 Microsoft Word 中打开。

这是最方便的 PowerShell 命令行之一。试试看：

```
ii . 
```

# c# - 从 web 方法而不是数据集返回字符串。

> ID：443378
> 
> 赞同：0
> 
> 时间：2009-01-14T15:33:43.757
> 
> 标签：c#, .net, web-services

我将如何重构它以使其返回字符串而不是数据集？

```
[WebMethod]
public DataSet GetPONumber(string Database)
{
    SqlConnection sqlConn = new SqlConnection();

    sqlConn.ConnectionString = GetConnString(Database);

    // build query
    string strSQL = @" A SELECT QUERY!!!!! ";

    SqlDataAdapter da = new SqlDataAdapter(strSQL, sqlConn);
    DataSet ds = new DataSet();
    da.Fill(ds, "NEWPO");

    return (ds);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T15:47:36.257

您可以将数据集转换为其 JSON 字符串表示形式。这样，基本上任何客户都可以轻松使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T15:47:55.023

您可以返回 ds.GetXml() 并更改返回类型。

这会将数据作为 XML 返回。

如果您的结果非常简单（比如说一个值），您可能只想直接返回它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T16:05:09.233

```
//Use an SqlCommand and the ExecuteScalar method.
//Cast returnValue to known object.
SqlCommand command = sqlConn.CreateCommand();
command.CommandType = CommandType.Text;
command.CommandText = @" A SELECT QUERY!!!!! ";
sqlConn.Open();
object returnValue = command.ExecuteScalar();
command.Dispose();
return returnValue.ToString(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T20:16:01.083

这是我完成并正在工作的内容，感谢您的意见：

```
[WebMethod]
    public String GetPONumber(string Database)
    {   
        //Create Object ready for Value
        object po = "";

        //Set Connection
        SqlConnection Connection = new SqlConnection(GetConnString(Database));

        //Open Connection
        Connection.Open();

        //Set Query to string
        string Query = @" SQL QUERY GOES HERE!!!! ";

        //Run Query
        SqlCommand Command = new SqlCommand(Query, Connection);

        //Set Value from Query
        try
        {
            po = Command.ExecuteScalar();
        }
        catch
        {
            //Error
        }

        //Clean up sql
        Command.Dispose();
        Command = null;

        //Clean up connection
        Connection.Close();
        Connection.Dispose();
        Connection = null;

        //Return Value
        return po.ToString();
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-27T20:31:56.290

@MartGrif

我已修改您的代码以包含 using 语句，这是常见用法。它还使代码更简洁，我相信，更具可读性。using 语句在代码块末尾自动处理对象。[在此处查看 MSDN](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)上的文档

```
[WebMethod]
public String GetPONumber(string Database)
{   
    //Create Object ready for Value
    object po = "";

    //Set Connection
    using(SqlConnection connection = new SqlConnection(GetConnString(Database)))
    {
        string Query = @" SQL QUERY GOES HERE!!!! ";
        using(SqlCommand command = new SqlCommand(Query, connection))
        {
            try
            {
                connection.Open();
                po = Command.ExecuteScalar();
            }
            catch
            {
                //Error
            }
        }
    }
    return po.ToString();
} 
```

# vb.net - 什么可能导致 VB.NET 应用程序在运行任何代码之前崩溃？

> ID：443384
> 
> 赞同：1
> 
> 时间：2009-01-14T15:35:04.970
> 
> 标签：vb.net, crash

我的 VB.NET 应用程序在开发 PC 上编译、安装和工作正常。

但是，当我将安装包带到别处时，它安装正常，但在执行任何代码之前崩溃。

错误是“遇到问题需要关闭...”

我已经删除了对外部文件的所有引用，例如图标文件等。

我只有一个本地 dll，参考似乎还可以。

还有哪些其他问题可能导致此问题？

谢谢！乔恩

更新：在 1 台 PC 上，重新安装 MDAC 已解决该问题。然而，大多数客户端都是 XP，所以这无济于事。

在某些 Windows XP 笔记本电脑上，我仍然收到相同的错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T15:36:40.973

很抱歉问一个明显的问题，但是目标 PC 是否安装了 .Net Runtime？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T15:38:49.910

您可以查看事件日志（在“运行”框中以“eventvwr”开头）以获取更多信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T15:56:46.783

我以前用无效的 app.config 文件看到过这种情况。鉴于您刚刚发布的错误，您也可以检查机器的清单文件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-07-28T04:43:25.287

两种可能：

这是当 vb.net 在初始化期间遇到错误时您得到的错误类型。例如，如果您有

```
dim iClass as new myClass 
```

在启动窗体或模块的全局区域（在子或函数之前）中，如果在创建实例 iClass 期间发生错误，那么您会收到一条相当无价值的错误消息，但不知道在哪里找到问题。

如果在初始化期间发生的控制事件的虚假触发导致 _load 开始执行之前事件处理程序中出现错误，您也可能会收到此类错误。根据 Microsoft 的说法，此事件触发偶尔会发生，“设计使然”。这可以通过在 _load 执行后切换的标志来防止，以告诉处理程序它是否可以安全运行，并且可能通过明智地使用设计时分配的控件属性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-14T15:47:22.327

好的 - 事件查看器有帮助。我认为。

看起来在安装过程中没有找到一些参考。

* * *

这是最后6个条目...

```
Faulting application pa.exe, version 2.0.1.26594, stamp 496e0437, faulting module kernel32.dll, version 5.0.2195.6946, stamp 40d78cce, debug? 0, fault address 0x0002bbf3\. 

Detection of product '{3CA9D9FD-E8CD-4B73-8053-8C406ED8CB28}', feature 'DefaultFeature' failed during request for component '{ACA3C479-D7C7-902C-092A-E6635AD9A8B1}' 

Detection of product '{3CA9D9FD-E8CD-4B73-8053-8C406ED8CB28}', feature 'DefaultFeature', component '{7D04E12E-2803-6F47-E11C-B8146C27E61B}' failed.  The resource 'C:\Program Files\pa\pa-update.exe' does not exist. 

Faulting application pa.exe, version 2.0.1.26594, stamp 496dffb9, faulting module kernel32.dll, version 5.0.2195.6946, stamp 40d78cce, debug? 0, fault address 0x0002bbf3\. 

Detection of product '{3CA9D9FD-E8CD-4B73-8053-8C406ED8CB28}', feature 'DefaultFeature' failed during request for component '{ACA3C479-D7C7-902C-092A-E6635AD9A8B1}' 

Detection of product '{3CA9D9FD-E8CD-4B73-8053-8C406ED8CB28}', feature 'DefaultFeature', component '{30A51F7D-D0DA-E436-F48F-1092ECE7858D}' failed.  The resource 'C:\Program Files\pa\pa-common.dll' does not exist. 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-14T16:07:45.297

您的目标是不是安装在其他机器上的更高版本的 .NET 平台？
您可以在编译选项卡的“我的项目”中检查您的项目（VS.2008）的目标框架。单击 Advanced Compile Options...
在 Advanced Compiler Setting 对话框的底部，每个框架都会有一个下拉列表。
在客户端计算机上，您可以在“程序和功能”控制面板 (Vista) 或 XP 中的“添加和删除程序”中检查 .NET 版本

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-22T16:54:23.330

我不了解 .NET，但在 Delphi 中，您可以使用 IDE 的一个实例来调试第二个实例。然后要在启动时调试问题（在正确调试开始之前），您可以将 IDE A 连接到 IDE B 进行调试，然后在 IDE B 中运行您的应用程序，在 IDE A 中打开的代码可能会为您提供一些关于问题的线索。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-28T15:22:23.087

有一些 3rd 方 DLL 的行为很奇怪。试试这个，在您的部署中，将它们更改为包含而不是自动包含。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-01-04T02:32:25.743

我今天发生了这种情况。我的错误是我从另一个程序中复制了该程序并进行了修改以满足我的要求。问题是当一个程序启动时，第二个程序会崩溃而没有任何错误。我发现我需要更改装配信息。我更改了应用程序名称、程序集标题，并创建了一个唯一的 GUID。一旦我这样做了，我就可以同时运行这两个程序。

# javascript - Internet Explorer 中的鼠标坐标

> ID：443385
> 
> 赞同：0
> 
> 时间：2009-01-14T15:35:11.540
> 
> 标签：javascript, internet-explorer, internet-explorer-6

我有我的游戏地图，我有一个脚本，单击时会在地图上显示鼠标坐标的警报。

地图比例为 1 地图单位到 2.5 像素，地图从 -600、600 开始，然后下降到 600、1700。因此我不能简单地扔掉鼠标的像素。

我得到了它的工作（并且对此感到非常高兴）但是唉 IE（6）有问题。我已将其范围缩小到 IE 无法正确获取滚动参数。

这是出现故障的相关代码，但完整代码位于[http://woarl.com/map/ieMap.html](http://woarl.com/map/ieMap.html)

```
tempX = event.clientX + document.body.scrollLeft;
tempY = event.clientY + document.body.scrollTop; 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T15:42:52.817

尝试：

```
tempX = event.clientX + (document.documentElement.scrollLeft || document.body.scrollLeft);
tempY = event.clientY + (document.documentElement.scrollTop || document.body.scrollTop); 
```

检查了您的页面，并且 DOCTYPE 将 IE 置于标准模式，因此`scrollXXX`您想要的属性实际上位于`document.documentElement`，而不是`document.body`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T15:43:42.240

鼠标坐标位置很糟糕，因为规范没有指出它们是否应该与文档或视窗相关，等等。[在http://www.quirksmode.org/js/events_properties.html](http://www.quirksmode.org/js/events_properties.html)的底部有一个很好的问题描述，以及一个可以在所有浏览器上运行的脚本示例。

特别是看起来您需要添加`document.documentElement.scroll(Left|Top)`event 和 document.body 参数。

# python - 为什么在加载模块时使用 Paramiko 会挂起？

> ID：443387
> 
> 赞同：11
> 
> 时间：2009-01-14T15:35:25.720
> 
> 标签：python, multithreading, ssh, module, paramiko

将以下内容放入文件**hello.py**（`easy_install paramiko`如果你还没有的话）：

```
hostname,username,password='fill','these','in'
import paramiko
c = paramiko.SSHClient()
c.set_missing_host_key_policy(paramiko.AutoAddPolicy())
c.connect(hostname=hostname, username=username, password=password)
i,o,e = c.exec_command('ls /')
print(o.read())
c.close() 
```

适当填写第一行。

现在输入

```
python hello.py 
```

你会看到一些 ls 输出。

现在改为输入

```
python 
```

然后从解释器类型中

```
import hello 
```

瞧！它挂了！如果您将代码包装在一个函数中`foo`并`import hello; hello.foo()`改为执行，它将取消挂起。

为什么 Paramiko 在模块初始化中使用时会挂起？ **Paramiko 是如何知道它在模块初始化期间首先被使用的？**

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-16T16:01:36.910

Paramiko 为底层传输使用单独的线程。作为导入的副作用，您*永远不应该有一个生成线程的模块。*据我了解，只有一个导入锁可用，因此当您的模块中的子线程尝试另一个导入时，它可以无限期地阻塞，因为您的主线程仍然持有锁。（可能还有其他我不知道的陷阱）

一般来说，模块在导入时不应该有任何副作用，否则你会得到不可预知的结果。用这个把戏推迟执行`__name__ == '__main__'`，你会没事的。

[编辑] 我似乎无法创建一个重现此死锁的简单测试用例。我仍然认为这是导入的线程问题，因为身份验证代码正在等待一个永远不会触发的事件。这可能是 paramiko 或 python 中的一个错误，但好消息是，如果你做的事情正确，你永远不会看到它；）

这是一个很好的例子，为什么您总是希望尽量减少副作用，以及为什么函数式编程技术变得越来越流行。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-09-30T21:02:11.360

正如[JimB 所](https://stackoverflow.com/a/450895/1729555)指出的，当 python 尝试在 ssh 连接尝试期间首次使用时隐式导入解码器时，这是一个**导入问题。**`str.decode('utf-8')`有关详细信息，请参阅*分析*部分。

一般来说，你不能强调你应该避免让一个模块在导入时自动产生新线程。如果可以的话，尽量避免使用魔法模块代码，因为它几乎总是会导致不必要的副作用。

1.  如前所述，解决您的问题的简单且明智的方法是将您的代码放在一个`if __name__ == '__main__':`主体中，该主体仅在您执行此特定模块时才会执行，并且不会在其他模块导入此 mmodule 时执行。

2.  （不推荐）另一个解决方法是在您调用之前在您的代码中执行一个虚拟 str.decode('utf-8') `SSHClient.connect()`- 请参阅下面的分析。

那么这个问题的根本原因是什么？

**分析（简单密码验证）**

*提示：如果你想在 python 导入和设置中调试线程`threading._VERBOSE = True`*

1.  `paramiko.SSHClient().connect(.., look_for_keys=False, ..)`隐含地为您的连接生成一个新线程。如果您打开`paramiko.transport`.

`[Thread-5 ] [paramiko.transport ] DEBUG : starting thread (client mode): 0x317f1d0L`

2.  这基本上是作为`SSHClient.connect()`. 当`client.py:324::start_client()`被调用时，会创建一个锁`transport.py:399::event=threading.Event()`并启动线程`transport.py:400::self.start()`。请注意，该`start()`方法随后将执行该类的`transport.py:1565::run()`方法。

3.  `transport.py:1580::self._log(..)`打印我们的日志消息“启动线程”，然后继续`transport.py:1584::self._check_banner()`。

4.  `check_banner`做一件事。它检索 ssh 横幅（来自服务器的第一个响应）`transport.py:1707::self.packetizer.readline(timeout)`（请注意，超时只是套接字读取超时），最后检查换行符，否则超时。

5.  如果收到服务器横幅，它会尝试对响应字符串进行 utf-8 解码`packet.py:287::return u(buf)`，这就是发生死锁的地方。执行`u(s, encoding='utf-8')`str.decode('utf-i') 并隐式导入via最终导致导入死锁`encodings.utf8`。`encodings:99``encodings.search_function`

因此，一个肮脏的解决方法是只导入一次 utf-8 解码器，以免由于模块导入副作用而阻塞该特定导入。( `''.decode('utf-8')`)

**使固定**

**肮脏的修复**-*不推荐*

```
import paramiko
hostname,username,password='fill','these','in'
''.decode('utf-8')  # dirty fix
c = paramiko.SSHClient()
c.set_missing_host_key_policy(paramiko.AutoAddPolicy())
c.connect(hostname=hostname, username=username, password=password)
i,o,e = c.exec_command('ls /')
print(o.read())
c.close() 
```

**很好的修复**

```
import paramiko
if __name__ == '__main__':
    hostname,username,password='fill','these','in'
    c = paramiko.SSHClient()
    c.set_missing_host_key_policy(paramiko.AutoAddPolicy())
    c.connect(hostname=hostname, username=username, password=password)
    i,o,e = c.exec_command('ls /')
    print(o.read())
    c.close() 
```

参考[paramiko 问题跟踪器：问题 104](https://github.com/paramiko/paramiko/issues/104)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-05T03:36:47.443

"".decode("utf-8") 对我不起作用，我最终这样做了。

```
from paramiko import py3compat
# dirty hack to fix threading import lock (issue 104) by preloading module
py3compat.u("dirty hack") 
```

我有一个实现了 paramiko 的包装器。 [https://github.com/bucknerns/sshaolin](https://github.com/bucknerns/sshaolin)

# ms-word - 此项目中的宏已被禁用

> ID：443389
> 
> 赞同：1
> 
> 时间：2009-01-14T15:35:46.747
> 
> 标签：ms-word

打开 Word 文档时，应该会启动一个宏，并且会启动一段时间。但是随后我在激活宏时保存了文档，之后我收到错误消息：

```
The macros in this project have been disabled 
```

当我打开文档时。

我尝试了不同的安全设置。

知道可能是什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-09-30T13:20:05.547

如果您的宏中的错误阻止了项目中的宏，通常需要很长时间来寻找解决方案，因为 MS 似乎不批准宏的广泛使用。

在 Word 中：在文件 -> 选项 -> 高级中启用宏的解决方案是不够的。

只需转到：开发人员->保护->限制编辑->打开右侧面板，按停止保护按钮。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T15:46:03.297

在 Word 中：Tools->Macro_>security 并设置为中等。替代方案包括受信任的位置和自我认证的项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-19T15:08:14.100

在功能区中：在开发人员中，单击宏安全，然后启用所有宏。重启 Xcel

[![启用此项目中的宏](https://i.stack.imgur.com/qagtU.png)](https://i.stack.imgur.com/qagtU.png)

# delphi - 德尔福印刷技术

> ID：443398
> 
> 赞同：7
> 
> 时间：2009-01-14T15:38:34.043
> 
> 标签：delphi, printing, delphi-2009

在哪里可以找到为我的程序添加打印功能的好资源？

我找到了这个页面：[http](http://efg2.com/Lab/Library/Delphi/Printing/index.html) ://efg2.com/Lab/Library/Delphi/Printing/index.html但它已经 5 年没有更新了，我想知道在 Delphi 2009 中，StretchDIBits 是否是还是首选StretchDrawMap，如何最好地支持分页、预览等。

迄今为止，我通过创建 html 或 pdf 文档而不是打印这些文档来作弊，但是对于所有打印任务来说走这么远有点繁重。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-14T19:45:34.777

我建议快速报告[http://fast-report.com/en/](http://fast-report.com/en/)是我用过的最好的报告工具。

在 Fast Report 之前，我使用过 QuickReport、Fortes Report、Report Builder 和 Rave。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T02:02:23.063

创建 HTML 和 PDF 实际上并没有那么糟糕。使用提供的 API 直接打印是。

到目前为止，所有答案都包含报告组件。有一个很好的理由 - 这是最灵活和最强大的打印方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T16:26:59.623

我用过狂欢报告。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T18:40:59.853

[ReportBuilder Pro](http://www.digital-metaphors.com/)是一个非常好的报表生成器，可以为您的程序添加打印功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T07:58:59.477

Delphi 不是已经自带了一些打印组件吗？它们应该可以正常使用。在旧版本中它是 QuickReport，现在它是别的东西（Rave Report（编辑））

# c# - 从日志文件中提取特定的 XML 消息

> ID：443403
> 
> 赞同：0
> 
> 时间：2009-01-14T15:40:45.647
> 
> 标签：c#, xml, vb.net

我有一个日志文件，其中包含数百/数千条单独的 XML 消息，需要找到一种方法来根据给定的参数（节点值）提取完整的 xml 消息。

我最大的问题是，即使我编写了相当多的程序，我也很少接触 XML 或我使用的语言的 XML 库，并且不认为简单的文本解析会是一个优雅的解决方案！

我将在 C# 或 VB.net 中尝试此操作，任何帮助将不胜感激，任何解决方案的尝试都会更好！

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-14T15:46:14.637

编辑：下面的答案假定整个日志文件是一个有效的 XML 文档。如果不是这种情况，请忽略。

[XPath 可能是您的答案 - 假设您有能力一次性加载整个日志文件，那么使用XmlNode.SelectSingleNode](http://msdn.microsoft.com/en-us/library/system.xml.xmlnode.selectsinglenode.aspx)或[XNode.XPathSelectElement](http://msdn.microsoft.com/en-us/library/system.xml.linq.xnode.xpathselectelement.aspx)应该相当容易。

或者，如果您使用的是 LINQ to XML，您可以构建一个 LINQ 查询——如果您不熟悉 XPath，它可能更易读。

如果您想学习 XPath，我通常会发现[W3Schools](http://w3schools.com/xpath/)教程非常好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T15:50:46.373

一个非常基本的方法是：

1.  解析文件。您可以提取每条 Xml 消息并将其视为一个完整的文档。
2.  根据参数查询 xml 并确定它是否匹配。

这个解决方案不是最好的，我敢打赌它会表现很差，因为你会加载很多，虽然只有测试会知道。这种方法的好处是文件不必是有效的 Xml。因此，如果您解析正在写入的文件，则可以使用此方法。（我假设您的记录器只是将 xml 附加到文件中，而不是将其视为一个大 dom）。

如果文件也没有被写入，并且根据大小，您可以将文件的内容包装在 Xml 节点中。再次假设写入文件的唯一内容是 Xml。如果您记录其他信息，那么您将不得不使用第一个解决方案。

至于解析 Xml，您有多种选择，例如 Linq to Xml 或 XPath。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T16:33:05.150

对于 LINQ to XML，类似于以下内容：

```
Dim xml As XDocument = XDocument.Load("Messages.xml")
Dim messages = From msg In xml.<Messages>.<Message> Select msg

For Each m In messages
  Console.WriteLine(m.Value.ToString)
Next 
```

当然，这将不得不修改以适合您的 XML 的结构。

# visual-c++ - 同类目标目录

> ID：443408
> 
> 赞同：8
> 
> 时间：2009-01-14T15:43:04.393
> 
> 标签：visual-c++, incremental-linking

如果启用了增量链接，Visual C++ 会在 $(TargetDir) 中生成 *.ilk 文件，我可以覆盖此行为并将其重定向到另一个目录吗？（不使用构建后步骤）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-11-03T08:46:04.617

在 Visual C++ 6.0 和 Visual C++ 2008 中，无法为 ilk 文件选择不同的目录。增量链接的有效选项是`/INCREMENTAL:YES`和`/INCREMENTAL:NO`。

此外，如果您创建后期构建步骤以将 ilk 文件移动到不同的位置，Visual C++ 将不会意识到这一点，因此与完全禁用增量链接相同，因为 Visual C++ 将找不到 ilk 文件。

HTH。

# c# - 是否可以将属性网格中显示的属性标记为密码字段

> ID：443411
> 
> 赞同：19
> 
> 时间：2009-01-14T15:44:03.563
> 
> 标签：c#, passwords, attributes, propertygrid

我正在使用 C# 并且有一个包含属性网格控件的 Windows 窗体。

我已将 propertygrid 的 SelectedObject 分配给一个设置文件，该文件显示并允许我编辑设置。但是其中一项设置是密码 - 我希望它在字段中显示星号，而不是密码设置的纯文本值。

保存时该字段将被加密，但我希望它的行为类似于普通的密码输入框，当用户输入密码时会显示星号。

我想知道是否有一个属性可以应用于设置属性以将其标记为密码？

谢谢。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-01-14T19:28:10.790

从 .Net 2 开始，您可以使用附加到密码属性的[PasswordPropertyTextAttribute 。](http://msdn.microsoft.com/en-us/library/system.componentmodel.passwordpropertytextattribute.aspx)

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T15:49:32.010

我不认为你可以让 PropertyGrid 换成星号，但你也许可以使用单向类型转换器和模态编辑器......像这样：

```
using System;
using System.ComponentModel;
using System.Drawing.Design;
using System.Windows.Forms;
using System.Windows.Forms.Design;
class Foo
{
    [TypeConverter(typeof(PasswordConverter))]
    [Editor(typeof(PasswordEditor), typeof(UITypeEditor))]
    public string Password { get; set; }

    // just to show for debugging...
    public string PasswordActual { get { return Password; } }
}
class PasswordConverter : TypeConverter
{
    public override object ConvertTo(ITypeDescriptorContext context, System.Globalization.CultureInfo culture, object value, System.Type destinationType)
    {
        return destinationType == typeof(string) ? "********" : 
            base.ConvertTo(context, culture, value, destinationType);

    }
}
class PasswordEditor : UITypeEditor
{
    public override UITypeEditorEditStyle GetEditStyle(ITypeDescriptorContext context)
    {
        return UITypeEditorEditStyle.Modal;
    }
    public override object EditValue(ITypeDescriptorContext context, IServiceProvider provider, object value)
    {
        IWindowsFormsEditorService svc = (IWindowsFormsEditorService)
            provider.GetService(typeof(IWindowsFormsEditorService));
        if (svc != null) {
            TextBox tb;
            Button btn;
            Form frm = new Form { Controls = {
                 (tb = new TextBox { PasswordChar = '*', Dock = DockStyle.Top,
                     Text = (string)value}),
                 (btn = new Button { Text = "OK", Dock = DockStyle.Bottom, DialogResult = DialogResult.OK})
            }, AcceptButton = btn};

            if (frm.ShowDialog() == DialogResult.OK)
            {
                value = tb.Text;
            }
        }
        return value;
    }
}
static class Program {
    [STAThread]
    static void Main() {
        Application.EnableVisualStyles();
        Application.Run(new Form {
            Controls = {
                new PropertyGrid {
                    Dock = DockStyle.Fill,
                    SelectedObject = new Foo { Password = "Bar"}
                }
            }
        });
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T15:58:54.050

这是我过去所做的。它在网格中为密码显示“********”，并带有一个“...”按钮以允许用户设置密码（使用您提供的对话框）。

```
public class User
{
    [TypeConverter(typeof(PasswordConverter))]
    [Editor(typeof(PasswordEditor), typeof(UITypeEditor))]
    public string Password { get; set; }
}

public class PasswordConverter : TypeConverter
{
    public override bool CanConvertTo(ITypeDescriptorContext context, Type destinationType)
    {
        if (destinationType == typeof(string)) return true;

        return base.CanConvertTo(context, destinationType);
    }

    public override object ConvertTo(ITypeDescriptorContext context, System.Globalization.CultureInfo culture, object value, Type destinationType)
    {
        if (destinationType == typeof(string))
        {
            string password = (string)value;

            if (password != null && password.Length > 0)
            {
                return "********";
            }
        }

        return base.ConvertTo(context, culture, value, destinationType);
    }
}

public class PasswordEditor : UITypeEditor
{
    public override object EditValue(ITypeDescriptorContext context, IServiceProvider provider, object value)
    {
        string password = (string)value;

        // Show a dialog allowing the user to enter a password

        return password;
    }

    public override UITypeEditorEditStyle GetEditStyle(ITypeDescriptorContext context)
    {
        return UITypeEditorEditStyle.Modal;
    }
} 
```

# sql-server-2005 - SQL 2005 - 快速复制数据库+数据的快捷方式

> ID：443421
> 
> 赞同：17
> 
> 时间：2009-01-14T15:46:43.183
> 
> 标签：sql-server-2005

我有我的开发数据库，​​我想分拆一个副本进行测试。我想经常这样做。

经常这样做的最快和最简单的方法是什么？我可以通过生成包含数据的脚本来完成工作，但我觉得必须有更好的方法。我是否应该备份数据库 1 然后搞砸它，以便我可以将其恢复为不同的名称？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-14T15:51:11.443

分离数据库，复制 .MDF 文件（和 .ldf 文件），您可以同时附加两者。或者只有一个，保留一个作为副本，以便以后快速复制。

Mcirosoft SQL Server Management Studio 中的“复制数据库”命令也可以像这样工作。

您可以使用 PowerShell 或仅使用 .Cmd 文件调用 osql 轻松地自动化/编写脚本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T15:52:46.310

您还可以使用 SQL Management Studio UI 创建文件备份，然后将其还原到同一服务器或任何其他服务器上的新数据库中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T15:53:11.223

在 SQL 2005 中，我想说最快的方法是使用复制数据库，在数据库 --> 任务下

源和目标可以相同，如果需要，它允许您重命名数据库。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T15:50:36.047

有一个用于创建和恢复数据库的命令行工具 (DOS)。

您也可以将其作为 T-SQL 脚本执行。 [http://www.sqlmag.com/Article/ArticleID/46560/sql_server_46560.html](http://www.sqlmag.com/Article/ArticleID/46560/sql_server_46560.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T15:53:18.943

我会使用脚本，因为这有助于你所做的事情的透明度。
（特别是如果您想经常这样做，因为每次更改都会有稍微不同的数据。）

但是，如果您不想麻烦地创建脚本，最简单的方法是备份然后恢复为不同的名称。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-14T16:03:02.683

如果要编写脚本，可以使用以下内容。如果您不能使数据库脱机，这也是最好的：

```
USE master
GO

-- the original database (use 'SET @DB = NULL' to disable backup)
DECLARE @DB varchar(200)
SET @DB = 'PcTopp'

    -- the backup filename
DECLARE @BackupFile varchar(2000)
SET @BackupFile = 'c:\pctopp\sqlserver\backup.dat'

-- the new database name
DECLARE @TestDB varchar(200)
SET @TestDB = 'TestDB'

-- the new database files without .mdf/.ldf
DECLARE @RestoreFile varchar(2000)
SET @RestoreFile = 'c:\pctopp\sqlserver\backup'

-- ****************************************************************
--                    no change below this line
-- ****************************************************************

DECLARE @query varchar(2000)

DECLARE @DataFile varchar(2000)
SET @DataFile = @RestoreFile + '.mdf'

DECLARE @LogFile varchar(2000)
SET @LogFile = @RestoreFile + '.ldf'

IF @DB IS NOT NULL
BEGIN
    SET @query = 'BACKUP DATABASE ' + @DB + ' TO DISK = ' + QUOTENAME(@BackupFile, '''')
    EXEC (@query)
END

-- RESTORE FILELISTONLY FROM DISK = 'C:\temp\backup.dat'
-- RESTORE HEADERONLY FROM DISK = 'C:\temp\backup.dat'
-- RESTORE LABELONLY FROM DISK = 'C:\temp\backup.dat'
-- RESTORE VERIFYONLY FROM DISK = 'C:\temp\backup.dat'

IF EXISTS(SELECT * FROM sysdatabases WHERE name = @TestDB)
BEGIN
    SET @query = 'DROP DATABASE ' + @TestDB
    EXEC (@query)
END

RESTORE HEADERONLY FROM DISK = @BackupFile
DECLARE @File int
SET @File = @@ROWCOUNT

DECLARE @Data varchar(500)
DECLARE @Log varchar(500)

SET @query = 'RESTORE FILELISTONLY FROM DISK = ' + QUOTENAME(@BackupFile , '''')

CREATE TABLE #restoretemp
(
 LogicalName varchar(500),
 PhysicalName varchar(500),
 type varchar(10),
 FilegroupName varchar(200),
 size int,
 maxsize bigint
)
INSERT #restoretemp EXEC (@query)

SELECT @Data = LogicalName FROM #restoretemp WHERE type = 'D'
SELECT @Log = LogicalName FROM #restoretemp WHERE type = 'L'

PRINT @Data
PRINT @Log

TRUNCATE TABLE #restoretemp
DROP TABLE #restoretemp

IF @File > 0
BEGIN
    SET @query = 'RESTORE DATABASE ' + @TestDB + ' FROM DISK = ' + QUOTENAME(@BackupFile, '''') + 
        ' WITH MOVE ' + QUOTENAME(@Data, '''') + ' TO ' + QUOTENAME(@DataFile, '''') + ', MOVE ' +
        QUOTENAME(@Log, '''') + ' TO ' + QUOTENAME(@LogFile, '''') + ', FILE = ' + CONVERT(varchar, @File)
    EXEC (@query)
END
GO 
```

复制自：[http ://weblogs.asp.net/mschwarz/archive/2004/08/26/220735.aspx](http://weblogs.asp.net/mschwarz/archive/2004/08/26/220735.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-14T16:16:35.887

还有一种选择，

这是一篇博客文章，讨论了使用数据库发布向导以及如何使用它来将数据库的所有元素（包括数据）导出到 SQL 文件。可能会有所帮助，而且看起来很简单。

[http://blog.sqlauthority.com/2007/11/16/sql-server-2005-generate-script-with-data-from-database-database-publishing-wizard/](http://blog.sqlauthority.com/2007/11/16/sql-server-2005-generate-script-with-data-from-database-database-publishing-wizard/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-10-05T03:37:41.173

SQL 2005上面的帖子[- 快速复制数据库+数据的快速方法](https://stackoverflow.com/questions/443421/sql-2005-quick-way-to-quickly-duplicate-a-database-data/443511#443511)工作......

但是如果你使用 sql server 2008 r2 例如，你可能需要对“create table #restoretemp”部分进行轻微修改，因为“restore filelistonly ...”的返回已经改变了......

基本上在“maxsize bigint”之后添加这个

```
 maxsize bigint,
 fileid bigint,
 createlsn numeric(26),
 droplsn numeric(26),
 uniqueid uniqueidentifier,
 readonlylsn numeric(26),
 readwritelsn numeric(26),
 BackupSizeInBytes bigint,
 SourceBlockSize int,
 FileGroupId int,
 LogGroupGUID uniqueidentifier,
 DifferentialBaseLSN numeric(26),
 DifferentialBaseGUID uniqueidentifier,
 IsReadOnly bit,
 IsPresent bit,
 TDEThumbprint varbinary(40) 
```

你最终会得到下面的工作脚本......

```
USE master
GO

-- the original database (use 'SET @DB = NULL' to disable backup)
DECLARE @DB varchar(200)
SET @DB = 'source_db_name'

-- the backup filename
DECLARE @BackupFile varchar(2000)
SET @BackupFile = 'D:\somewhere\DB\backup.dat'

-- the new database name
DECLARE @TestDB varchar(200)
SET @TestDB = 'boon_db'

-- the new database files without .mdf/.ldf
DECLARE @RestoreFile varchar(2000)
SET @RestoreFile = 'D:\somewhere\DB'

-- ****************************************************************
--                    no change below this line
-- ****************************************************************

DECLARE @query varchar(2000)

DECLARE @DataFile varchar(2000)
SET @DataFile = @RestoreFile + '.mdf'

DECLARE @LogFile varchar(2000)
SET @LogFile = @RestoreFile + '.ldf'

IF @DB IS NOT NULL
BEGIN
    SET @query = 'BACKUP DATABASE ' + @DB + ' TO DISK = ' + QUOTENAME(@BackupFile, '''')
    EXEC (@query)
END

-- RESTORE FILELISTONLY FROM DISK = 'C:\temp\backup.dat'
-- RESTORE HEADERONLY FROM DISK = 'C:\temp\backup.dat'
-- RESTORE LABELONLY FROM DISK = 'C:\temp\backup.dat'
-- RESTORE VERIFYONLY FROM DISK = 'C:\temp\backup.dat'

IF EXISTS(SELECT * FROM sysdatabases WHERE name = @TestDB)
BEGIN
    SET @query = 'DROP DATABASE ' + @TestDB
    EXEC (@query)
END

RESTORE HEADERONLY FROM DISK = @BackupFile
DECLARE @File int
SET @File = @@ROWCOUNT

DECLARE @Data varchar(500)
DECLARE @Log varchar(500)

SET @query = 'RESTORE FILELISTONLY FROM DISK = ' + QUOTENAME(@BackupFile , '''')

CREATE TABLE #restoretemp
(
 LogicalName varchar(500),
 PhysicalName varchar(500),
 type varchar(10),
 FilegroupName varchar(200),
 size int,
 maxsize bigint,
 fileid bigint,
 createlsn numeric(26),
 droplsn numeric(26),
 uniqueid uniqueidentifier,
 readonlylsn numeric(26),
 readwritelsn numeric(26),
 BackupSizeInBytes bigint,
 SourceBlockSize int,
 FileGroupId int,
 LogGroupGUID uniqueidentifier,
 DifferentialBaseLSN numeric(26),
 DifferentialBaseGUID uniqueidentifier,
 IsReadOnly bit,
 IsPresent bit,
 TDEThumbprint varbinary(40)
)
INSERT #restoretemp EXEC (@query)

SELECT @Data = LogicalName FROM #restoretemp WHERE type = 'D'
SELECT @Log = LogicalName FROM #restoretemp WHERE type = 'L'

PRINT @Data
PRINT @Log

TRUNCATE TABLE #restoretemp
DROP TABLE #restoretemp

IF @File > 0
BEGIN
    SET @query = 'RESTORE DATABASE ' + @TestDB + ' FROM DISK = ' + QUOTENAME(@BackupFile, '''') + 
        ' WITH MOVE ' + QUOTENAME(@Data, '''') + ' TO ' + QUOTENAME(@DataFile, '''') + ', MOVE ' +
        QUOTENAME(@Log, '''') + ' TO ' + QUOTENAME(@LogFile, '''') + ', FILE = ' + CONVERT(varchar, @File)
    EXEC (@query)
END
GO 
```

# loops - 在复杂性分析中，为什么 ++ 被认为是 2 个操作？

> ID：443423
> 
> 赞同：4
> 
> 时间：2009-01-14T15:46:55.087
> 
> 标签：loops, complexity-theory, analysis

在我的计算机科学 II 课上，教授认为 ++、--、*= 等是 2 个操作。但是，在组装级别，这并不是真正的两个操作。有人可以解释一下还是只是为了简单起见？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-14T15:49:13.413

我实际上认为它是 3 个操作：读取、递增（或其他）、写入。这是假设它从某种共享内存读取到某种本地存储（例如寄存器或堆栈），在本地存储上操作，然后写回。

它在装配级别有多少操作将取决于您要增加的内容、平台、硬件等。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-14T15:49:46.003

因为 ++（例如：b++）是

```
b = b + 1 
```

那里有两个操作，加法（b + 1），然后将加法的值分配给原始变量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T16:00:00.990

做复杂性分析时为什么要麻烦？这只是 O(1) :-)

编辑：当你投票否决时，请告诉我为什么。由于这个问题被标记为*complex*，我认为大 O 概念是最重要的，而不是实际的常数。此外，正如其他答案中已经提到的，这有多少操作取决于很多因素：您计算操作的方式、平台、编译器等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T15:55:24.417

我来猜几个。

*   你的教授指的是解释语言吗？
*   ++i 与 i++ 不同，也许他指的是那个？
*   也许他选择的汇编语言需要中间存储变量？

    ```
    add reg_temp, reg_i, 1
    mov reg_i, reg_temp 
    ```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T15:49:02.323

不是加法加二传手吗？

类似于 i+=1？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-14T15:50:38.857

教授可能只是指必须取值，将其加 1，然后将其分配回变量。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-14T15:56:20.827

在汇编级别，一切都在寄存器中完成，因此在 A 中有一个变量

```
ADD AX,1 
```

但是，在编译语言中，所有内容都必须存储，因此 i++ 变为（在伪汇编中）

```
MOV AX,i
ADD AX, 1
MOV i, AX 
```

这是三个操作...除非我完全忘记了我的基本架构...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-14T16:09:05.993

你让我想起了我很久以前听到 的一个有点“**陪审团没有出局”的问题。**

> *“前增量比后增量快”*

我刚刚做了一个快速的谷歌搜索。

1.  很多人仍然认为这是真的。
2.  其他人则认为编译器已经如此优化，无法对比较高级的代码进行基准测试。
3.  然而，[其他人](http://discuss.fogcreek.com/joelonsoftware/default.asp?cmd=show&ixPost=171881)则认为没有区别。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-14T16:14:45.373

在我看来它应该超过 2，因为它根据上下文有两种含义，当我看到它时，我总是要提醒自己。

`a = b++`是相同的`a = b; b = b + 1`

和

`a = ++b`是相同的`b = b + 1; a = b`

这足以让大多数一年级学生陷入困境。

# javascript - 加载后如何让greasemonkey在页面上调用函数

> ID：443430
> 
> 赞同：28
> 
> 时间：2009-01-14T15:48:58.593
> 
> 标签：javascript, greasemonkey

我有一个非常简单的greasemonkey 脚本，我想调用页面上已经存在的javascript 函数。我已经阅读了文档，但似乎没有任何效果

```
window.setTimeout(function() { 
    alert('test') // This alert works, but nothing after it does
    myFunction() // undefined
    window.myFunction() // undefined
    document.myFunction() // undefined
}, 1000); 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-14T15:56:24.303

尝试使用： unsafeWindow.myFunction();

更多细节和信息 - [http://wiki.greasespot.net/UnsafeWindow](http://wiki.greasespot.net/UnsafeWindow)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-01-14T15:57:00.950

在原始页面中调用函数的一种方法是这样的：

```
location.href = "javascript:void(myFunction());"; 
```

这有点难看。GreaseMonkey 也提供了[unsafeWindow](http://wiki.greasespot.net/UnsafeWindow)，但作者建议不要使用它。

```
unsafeWindow.myFunction(); 
```

看起来更整洁，但请确保您了解其后果。从手册：

> unsafeWindow 绕过了 Greasemonkey 的基于 XPCNativeWrapper 的安全模型，该模型的存在是为了确保恶意网页无法更改对象，从而使greasemonkey 脚本（其执行权限比网页中运行的普通 Javascript 更多）执行其作者的操作或用户无意。因此，用户脚本应避免调用或以任何其他方式依赖于 unsafeWindow 上的任何属性 - 特别是如果它们是针对任意网页执行的，例如带有 @include * 的网页，其中页面作者可能以这种方式颠覆了环境。

换句话说，如果您使用 unsafeWindow，您的脚本会提升原始页面脚本可用的权限。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-03T01:21:24.877

您可以尝试使用 javascript 事件侦听器。

这些在响应发生的对象事件（例如页面加载）时执行代码

例如，要在页面加载时执行代码：

```
window.addEventListener('load', function () 
{
    /* code goes here */
}); 
```

# sql-server-2000 - sql server 2000 直接备份到单独的服务器

> ID：443432
> 
> 赞同：1
> 
> 时间：2009-01-14T15:49:10.607
> 
> 标签：sql-server-2000, backup

Windows Server 2003 上的 SQL Server 2000。

我正在尝试从 EM 中直接运行备份到另一台服务器，如下所示：

将数据库 AbraEmployeeSelfService 备份到磁盘 = '\\servername\f$\Backup\myDB_backup.bak'

我收到此错误：无法打开备份设备 '\\servername\f$\Backup\myDB_backup.bak'。设备错误或设备离线。有关详细信息，请参阅 SQL Server 错误日志。消息 3013，级别 16，状态 1，第 1 行备份数据库异常终止。

错误日志显示以下消息：BackupDiskFile::CreateMedia: Backup device '\\servername\f$\Backup\myDB_backup.bak' failed to create。操作系统错误 = 5（访问被拒绝。）。

我正在使用对目标路径具有完全权限的 Windows 登录名运行该命令。至少，我可以从我的桌面打开一个运行窗口，输入 \\servername\f$\Backup，然后在生成的资源管理器窗口中，我可以在该目录中添加/编辑/删除文件。

我需要做什么才能克服访问拒绝？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T15:55:33.837

我不确定 SO 是否正在逃离你的目的地，但它应该是：

```
'\\servername\f$\Backup\myDB_backup.bak' 
```

（服务器名称前有两个\）

SQL Server 将尝试以运行 SQL Server 服务的用户身份连接到此网络共享。您可能需要将 SQL Server 作为另一个帐户来运行，该帐户与具有该目标权限的帐户相匹配。

[解决 SQL Server 备份和还原难题](http://searchsqlserver.techtarget.com/tip/0,289483,sid87_gci1131243,00.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T15:53:58.910

MSSQLSERVER 服务在哪个用户帐户下运行？我相信 LocalSystem 受到限制，无法访问远程资源。

# c# - Lambda 变量名称 - 简称，还是不简称？

> ID：443466
> 
> 赞同：35
> 
> 时间：2009-01-14T15:55:25.757
> 
> 标签：c#, .net, naming-conventions, lambda

通常，当我使用 lambdas 时，我只使用“a、b、c、d...”作为变量名，因为类型很容易推断，而且我发现短名称更容易阅读。这是一个例子：

```
var someEnumerable = GetSomeEnumerable();
var somethingElseList = someEnumerable.Select(a => a.SomeProperty)
                                      .OrderBy(a => a.SomePropertyField);
var someDictionary = somethingElseList.ToDictionary(a => new SomeClass(a.Prop1),
                                                    a => a); 
```

有些人质疑这个命名，并希望看到长打出来的名字，像这样：

```
var someEnumerable = GetSomeEnumerable();
var somethingElseList = someEnumerable.Select(importantObj => importantObj.SomeProperty)
                                      .OrderBy(objsInfo => objsInfo.SomePropertyField);
var someDictionary = somethingElseList.ToDictionary(theInfoId => new SomeClass(theInfoId.Prop1),
                                                    theInfoId2 => theInfoId2); 
```

由于范围非常窄（在括号之间），除非您变​​得愚蠢并嵌套它们，否则我发现阅读短名称更容易。

**没有陷入我上面使用的愚蠢命名示例中**，关于 Lambda 变量名称的普遍共识是什么？简称，还是不简称？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-01-14T16:02:09.457

我通常这样做的方式取决于您枚举的集合。如果集合的名称暗示 lambda 参数将是什么类型，那么我只使用单个字母，但是如果集合不是描述性的，那么我将使用一个词。

IE：

```
myCollection.Where(person =>....); //non descriptive collection name

myPeopleCollection.Where(p=>...); // descriptive collection name 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-01-14T15:57:40.387

我尝试使用单字但有意义的名称。所以我*倾向于*使用“person”而不是“p”，但不会使用“newlyAddedPerson”。

这也适用于查询表达式——我很可能在快速的一次性示例中违反了这一点，但我通常不喜欢：

```
from p in source
where p.Age > 10
select p.Name; 
```

我宁愿看到

```
from person in source
where person.Age > 10
select person.Name; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-14T16:01:42.297

我喜欢简称的东西。我一直这样做。我主要在 lambdas 中使用 i,y,x，但我在 sql 中使用 a,b,c,d。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-09-06T17:34:45.173

我们的团队不允许单字母变量，不允许 lamdas 中的事件。

我们发现，就像在 TSQL 中一样，代码存在的时间越长，它就越混乱。就 lambda 而言

我们会做这样的事情：

```
people.Where(personFound => personFound.FirstName.Contains("blah!")); 
```

这样下一个开发者就不用看

```
people.Where(p => p.FirstName.Contains("blah")); 
```

它似乎可读，但一开始总是这样

加盟怎么样

```
citizenShip.Join(people, c => c.personid, p => p.persoinid, (p, c) => new { p.FirstName, c.IsCitizen})
.Where(pc => pc.FirstName.Contains("blah"); 
```

与变量名相同

```
citizenShip.Join(people, 
                 citizenToJoin => citizenToJoin.personid, 
                 personToJoin => personToJoin.persoinid, 
                 (joinedPerson, joinedCitiznship) => 
                     new { joinedPerson.FirstName, joinedCitiznship.IsCitizen})
.Where(personAndCitizenshipFound=> personAndCitizenshipFound.FirstName.Contains("blah"); 
```

哦，但这令人困惑和丑陋。只需使用不同的字母，以免混淆

```
citizenShip.Join(people, 
                 c => c.personid, 
                 p => p.persoinid, 
                 (jp, pc) => 
                     new { jp.FirstName, jc.IsCitizen})
.Where(pc => pc.FirstName.Contains("blah"); 
```

仍然令人困惑，但现在更糟了。所以我们将 lambda 分解，以便我们重构可读性

```
var peopleWithCitizenship = citizenShip.Join(people, 
                                             citizenToJoin => citizenToJoin.personid, 
                                             personToJoin => personToJoin.persoinid, 
                                             (joinedPerson, joinedCitiznship) => new { joinedPerson.FirstName, joinedCitiznship.IsCitizen});

var peopleWithCitizenshipFilteredByName = peopleWithCitizenship.Where(personAndCitizenshipFound=> personAndCitizenshipFound.FirstName.Contains("blah")); 
```

这不是一个完美的例子，但只需很少的内部知识就可以使代码可读。我们发现这暴露了复杂的代码（lambda），需要将其分解成更小的块。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-14T17:17:56.807

我会说我同意 BFree。对我来说，这将取决于上下文，但我总是尽量让它尽可能“简洁”。请注意，我说的是简洁，而不是简洁或简短。

这是 LISP 方言 Clojure 中的两个示例：

```
user=> (def names ["ryan" "bob" "tom" "tim"])
#'user/names

user=> (filter (fn [name] (.startsWith name "t")) names)
("tom" "tim") 
```

对于那些不了解 Lisp/Clojure 的人，我的 lambda 是函数“filter”的参数。也就是说，“（fn [name] ....）”。我在这里选择使用“名称”，因为它很短，但准确地描述了我正在使用的内容。但是，我认为“a”、“i”、“x”等同样具有可读性。

```
user=> (def odds (iterate (fn [n] (+ n 2)) 1))
#'user/odds

user=> (take 5 odds)
(1 3 5 7 9) 
```

在这里，我只是用“n”来代表“数字”。我认为“数字”也可以，但对我的口味来说有点过于冗长。

我当然不会使用名称“nameOfPerson”或“previousOddNumber”。这只是太多的信息。大多数时候，我也尽量避免输入类型，例如'nameString'。我发现这样的东西，大多数时候，是多余的信息。

就个人而言，我认为像这样更冗长的名称往往源于它有助于记录代码的想法。它似乎在 Java/C# 等语言中尤为普遍。我认为这可以双向争论，这取决于程序员的风格。但是，名称越冗长，代码就越紧凑（读起来越脆弱）。如果我的名字非常具体，而且它是一个经常变化的功能，那么这个名字很可能也必须改变很多。最终，DEV 可能会变得懒惰，您最终会得到一个实际上并不能描述变量用途的名称。这不是问题，当且仅当程序员不认为名称是正确的。当然，这可能会在编译过程中很快解决（因为程序员会尝试划分两个字符串或类似的东西），

由于屏幕空间，我也会主张简洁。我仍然尝试将我的行包装在 80 列宽，当“myVaraibleNameIsAsLongAsAParagraph”时这很难。

最终，我认为它总是会归结为妥协。所以他们不喜欢“a”，但也许他们会同意你应该争取像“人”或“数字”这样的单字名称，并避免那种可怕的驼峰式。

对不起这本书。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-14T16:03:33.917

就“命名”提出“共识”问题可能会要求很多。:)

我同意“好名字的重要性”与名字的范围成正比。乔恩斯基特的首选答案

```
from person in source ... 
```

是引人注目的，但如果名称被大量使用，特别是如果输入的名称更好，我想我更喜欢

```
from p in persons ... 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-14T17:23:14.427

我选择一个、两个或三个字母，它们构成了所讨论对象的缩写表示。

```
Persons.Where(p => ...)
AnalysisCode.Where(ac => ...) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-14T17:30:15.520

作为一般规则，我认为变量/对象/方法名称越明确越好。由于我们经常将大部分时间花在阅读其他人的代码上，我们越容易理解，您就越能更快地将注意力从语法转移到逻辑上。如今，有了 IntelliSense 之类的东西，尽可能地在清晰度方面犯错并不是真正的负担。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-12-10T01:21:47.583

基于上述答案，我认为普遍的共识是，如果您无法从上下文中分辨出您正在处理的内容，那么使用描述性名称会更好。例如：

```
entities.Where(person => person.Age >= 21); 
```

但是，在上下文*很*明显的情况下，单字母名称实际上可能有助于提高可读性，因为它可以更容易地关注关键信息。例如：

`people.Where(p => p.Age >= 21);`或者`people.Where(x => x.Age >= 21);`

问题是，哪个更好，`p`还是`x`？

*   赞成`p`，这是 SQL 查询中熟悉的模式，并提供了一点额外的提醒，即您正在谈论`Person`.
*   赞成`x`，如果您重命名`Person`为`Customer`，则不必担心修复所有 lambda 参数。如果你使用过`p`，如果你的代码变成 ，实际上会有点混乱`customers.Where(p => p.Age >= 21)`，而`x`基本上是不可知的。

我最近开始使用`x`，到目前为止，我还没有发现任何明显的缺点，但如果您不同意，请发表评论。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-07-19T18:15:12.280

我同意@Johnny Wey；命名你的变量 - 出于同样的原因，你在任何其他代码中命名它们！不要仅仅因为代码的“内联”性质而理解这种偏离清晰的预设。可读性是关键——一目了然/无需“悬停”在东西上；否则，您不妨说不需要适当命名变量。如果与“Enuerable”一起使用可能会有一点余地，但仍然很高兴看到（再次一目了然）代码在做什么。如果变量类型推断依赖于传递给类的一些泛型类型或其他东西，来吧，命名它。让所有代码读起来像一个句子；计算机应该适应我们（“人性化”），不是相反，我们开始表现得像计算机一样变得神秘，只是因为我们可以/感觉更聪明/更像技术极客（诱惑就在那里，我知道！）。输入一个清晰的名称很容易，并且您仍然拥有在命名方法中执行的所有智能感知/句子完成选项。另外，悬停在 lambdas 的情况下并不总是为您提供有关 var 的信息（在调试期间令人沮丧），因此很高兴看到“足够清晰/具有代表性”的命名，尤其是对于尚未通过所有心理体操的新开发人员能够通过遍历语句上下文来推断类型（这也可能是神秘的）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-05-18T09:02:57.420

如果变量的目的明确，则缩短会更好。Lambda 需要一种函数式的写作风格，因此您会在一行中看到很多链接。当你保持它们简短时，它会更清晰。

另一种情况是，有时您需要声明一个在该范围内没有相关性/意义的虚拟变量。在这种情况下，我使用`_`这对我来说很清楚。这很方便，尤其是在方法重载期间，例如，

```
public Foo Do()
{
    return Do(_ => true);
}

public Foo Do(Func<T, bool> pattern)
{
    return SomethingElse(pattern);
} 
```

# sql - 仅当列值为 true 时才加入表

> ID：443467
> 
> 赞同：3
> 
> 时间：2009-01-14T15:55:30.467
> 
> 标签：sql, sql-server

我正在使用 SQL Server 2005。我正在尝试将 2 个表连接在一起，但仅当主表中的列值为 true 时。像这样：

```
select * from T1
join T2 on T1.value = T2.value
where T2.value2 = 'variable2'
and T2.value3 = 'variable3' 
```

T1 中有一个列值表示我是否必须使用 T2 中的值。我可以考虑 where 子句的情况，但它总是会加入表，如果 T1 中的值为 false，则 T2 中没有要加入的值，因此选择不返回任何行。

你不能在加入周围放置一个案例，所以我有点坚持这个......有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-14T15:57:22.803

```
select * 
from T1
join T2 
  on  T1.value = T2.value
  and T1.booleancolumn = 1
where T2.value2 = 'variable2'
and T2.value3 = 'variable3'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T16:01:14.013

与 Dave 发布的内容类似，但我也读到这意味着您想要实际替换结果中的值。在这种情况下：

```
SELECT
    COALESCE(T2.Value, T1.Value) AS Value, 
    COALESCE(T2.Value2, T1.Value2) AS Value2,
    COALESCE(T2.Value3, T1.Value3) AS Value3
FROM T1
LEFT JOIN T2 ON T2.value = T1.value 
    AND T2.Value2= @Variable2 AND T2.Value3 = @Variable3 
```

请注意，我也将您的常量视为实变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T16:00:20.397

也许我误解了你的问题，但这是我的猜测。

我*认为*您可以在 WHERE 中使用案例。

```
select * from T1
join T2 on T1.value = T2.value
where T2.value2 = case T1.useT2 when 'yes' then 'variable2' else T2.value2 END
and T2.value3 = case T1.useT2 when 'yes' then 'variable3' else T2.value3 END 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T16:03:36.333

与戴夫所说的非常相似，尽管我会将布尔列检查放入 WHERE 中，因此类似这样

```
SELECT * FROM T1
INNER JOIN T2 
  ON T1.Value = T2.Value
WHERE T2.Value2 = 'variable2'
AND T2.Value3 = 'variable3'
AND T1.booleancolumn = 1 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T16:09:41.563

戴夫马克是对的，但更笼统地说......

条件连接是对您问题的回答，例如尝试在网络上查找一些资源

[http://weblogs.sqlteam.com/jeffs/archive/2007/04/03/Conditional-Joins.aspx](http://weblogs.sqlteam.com/jeffs/archive/2007/04/03/Conditional-Joins.aspx)

[http://bytes.com/groups/ms-sql/641690-difference-condition-join-where](http://bytes.com/groups/ms-sql/641690-difference-condition-join-where)

根据表中的数据进行连接是非常强大的技术

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-14T16:48:32.187

我想知道与条件连接相关的性能注意事项（如果有的话）是什么？它是否等同于这样的 UNION：

```
SELECT T1.* 
  FROM T1
  WHERE T1.use_t2 = FALSE
  AND T1.value2 = 'variable2'
  AND T1.value3 = 'variable3'
UNION ALL
SELECT T2.* 
  FROM T1 JOIN T2 ON T1.value = T2.value
  WHERE T1.use_t2 = TRUE
  AND T2.value2 = 'variable2'
  AND T2.value3 = 'variable3' 
```

# c# - 在 Windows 中更改默认字体会弄乱我的 Win Forms 按钮

> ID：443478
> 
> 赞同：1
> 
> 时间：2009-01-14T15:57:02.383
> 
> 标签：c#, .net, winforms

我们有一组具有自定义对话框窗口的 C# (.NET 2.0) 应用程序。当用户在 Windows 中更改默认字体大小和分辨率等时，表单的边缘会失去控制（它们会被推离表单的可见部分），通常会从底部掉落按钮。这对我们来说是个问题，并且会在使用我们围绕这些应用程序创建的标准外观框架的其他应用程序中引起问题。

您将如何使您的整个应用程序独立于 Windows 字体更改？您将如何将其集成到多个解决方案中？

或者更好的是如何调整整个应用程序以适应 Windows 外观的变化？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-14T16:24:29.427

WinForms 具有 AutoScaleMode 属性，该属性可以设置为 Font、DPI、Inherit 或 None。默认值为“字体”，根据我的经验，它并不总是正确缩放。您可以尝试其他选项之一（如果您根本不希望表单缩放，可能是“无”？）

至于使整个应用程序能够自行调整，请查看“继承”选项（不过，您仍然需要在应用程序的父表单或启动表单上设置“继承”以外的其他内容）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T16:10:49.877

您可以处理 Microsoft.Win32 命名空间中的[SystemEvents.UserPreferenceChanged](http://msdn.microsoft.com/en-us/library/microsoft.win32.systemevents.userpreferencechanged.aspx)事件。当系统字体更改时，UserPreferenceChangedEventArgs[参数](http://msdn.microsoft.com/en-us/library/microsoft.win32.userpreferencechangedeventargs.aspx)将具有 UserPreferenceCategory.Window 的[类别](http://msdn.microsoft.com/en-us/library/microsoft.win32.userpreferencecategory.aspx)[。](http://msdn.microsoft.com/en-us/library/microsoft.win32.userpreferencechangedeventargs.category.aspx)我认为您将不得不触发手动窗口布局并重新绘制以响应此事件。

# asp.net - SQL Server 和 asp.net 应用程序安全模型/最佳实践

> ID：443487
> 
> 赞同：2
> 
> 时间：2009-01-14T15:58:15.097
> 
> 标签：asp.net, sql-server, security

对于我针对 sql server 的 asp.net Web 应用程序（至少是那些需要登录才能访问的应用程序），我通常按如下方式实现安全性：

我通常推出自己的用户注册、用户登录页面，并在 sql 服务器中保存用户 ID 和加密密码，并根据该表验证登录 - 我还提供忘记密码、“发送我的密码”、电子邮件验证以激活帐户等所有通过自定义代码。

一旦用户被应用程序验证（假设所有用户都具有相同的权限），我通常使用实用程序 logonid 让 asp.net 与 sql server 对话，所以换句话说我只需要创建一个登录每个应用程序的 id，并且由于 100% 的所有数据访问都是通过存储过程完成的，我只需要授予单个用户执行存储过程的访问权限，并且在 sql server 上不需要其他工作。每个应用程序都有自己的数据库，该应用程序的登录只能访问该数据库。

所有这一切对我来说都很好，唯一的缺点是能够在 sql server 中设置跟踪并查看正在调用的用户 ID 和 procs 会很好，但是因为所有用户都在“交谈”数据库通过单一数据库登录，这不会发生。

所以，两部分问题：

1) 你们是否有我应该考虑使用的安全模型？总是一遍又一遍地做同样的事情很容易——尤其是因为它有效——但是还有其他模型可以更好地工作或我应该考虑吗？是否建议从 asp.net 应用程序的所有数据库访问都共享一个数据库登录名？或者这被认为是不好的做法？如果是这样，为什么？

2）假设我坚持我的模型，有没有办法允许在 sql 跟踪窗口中看到应用程序登录 ID？很高兴看到 sp 被调用以及登录系统的人的用户 ID（不是数据库登录）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T16:08:52.423

> 是否建议从 asp.net 应用程序的所有数据库访问都共享一个数据库登录名？

是的，主要用于连接池。

关于 2)，我通常通过在 ASP.NET 端登录来做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T16:06:28.027

1) 建议您的 Web 应用程序通常使用单一登录到数据库。如果您不这样做，您将被迫冒充您的呼叫者，这通常是不推荐的，而且它的扩展性也不是很好。您不应为每个用户使用不同的连接字符串。例如，为每个用户使用 SQL 身份验证是一个坏主意。它将使连接轮询无效。

2）您可以通过修改连接字符串来做到这一点，但这会使连接 pollign 无效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T16:15:03.220

从 .NET 最佳实践的角度来看，您可能需要考虑查看[Microsoft Enterprise Library](http://msdn.microsoft.com/en-us/library/dd203099.aspx)。它包含一组有助于解决安全和数据访问等问题的实践、模式和功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T16:05:23.460

1）只要您使用存储过程进行访问，一次登录就可以了。有些人也喜欢将一个用于管理。

2）您可以修改存储过程以接受用户 ID 作为参数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T12:27:47.427

我通常会共享一个用户进行连接池。

在您可能需要跟踪特定用户的情况下。我编写了管理功能，您可以在其中使应用程序使用第二个数据库登录。然后，您可以为特定用户启用此功能并单独跟踪该用户。

这只是意味着您可以一次性跟踪，同时为应用程序的其余部分保留单用户连接池。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-24T15:38:04.260

我也一直在使用相同的方法。最近，我想知道这是否会影响应用程序的可扩展性。我的数据库服务器具有多核处理器，并且非常能够进行并行操作，但我认为 SQL Server 序列化查询使用相同的用户 ID 运行。我认为这意味着来自不同实际用户的存储过程正在排队，因为 SQL Server 认为它们都来自同一个用户 ID。

如果是这种情况，我认为这将严重限制我的应用程序的可扩展性，不是吗？

# sql-server-2005 - SQL Server 在哪里存储 DTS 包？

> ID：443491
> 
> 赞同：3
> 
> 时间：2009-01-14T15:58:54.067
> 
> 标签：sql-server-2005, dts, ssis

我创建了一些 DTS 包并将它们保存在服务器上。我在哪里可以在服务器上编辑这些 DTS 包？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T16:01:48.803

您应该连接到集成服务...然后在 MSDB 文件夹或 FileSystem 文件夹中，这取决于您如何保存它们

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T11:39:52.113

您可能知道，DTS 已被[弃用](http://en.wikipedia.org/wiki/Deprecation)，并在 SQL Server 2005 中被[SSIS](http://en.wikipedia.org/wiki/SQL_Server_Integration_Services)取代。但是，可以在 SQL Server 2005 中编辑和运行 DTS 包，方法是安装“<a href="http://www.microsoft。 com/downloads/details.aspx?FamilyID=50b97994-8453-4998-8226-fa42ec403d17&DisplayLang=en" rel="nofollow noreferrer">Microsoft SQL Server 2005 功能包”。您应该查看的特定组件是用于编辑的“Microsoft SQL Server 2000 DTS Designer Components”和用于运行时的“Microsoft SQL Server 2005 Backward Compatibility Components”。

这允许您从 SQL Server 2000 升级到 SQL Server 2005，并且您的旧 DTS 包仍将运行。这让您有时间将它们升级到[SSIS](http://en.wikipedia.org/wiki/SQL_Server_Integration_Services)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-03T00:04:28.133

当您使用导入/导出向导时，您可以在向导结束时选择[将 SSIS 包保存到数据库](https://docs.microsoft.com/en-us/sql/integration-services/import-export-data/save-ssis-package-sql-server-import-and-export-wizard?view=sql-server-2017)中。

> 该向导将包保存在 msdb 数据库的 sysssispackages 表中。此选项不会将包保存到 SSIS 目录数据库 (SSISDB)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-05-31T15:15:18.760

DTS 包的原始有效负载应由此得出结果：

```
SELECT * FROM msdb.dbo.sysdtspackages WHERE name = 'MyPackageName' 
```

或这个：

```
exec msdb..sp_get_dtspackage @name = N'PackageName', @id = 'PACKAGE_GUID', @versionid = 'VERSION_GUID'
--you can get PACKAGE_GUID from going to Package/Properties from DTS Designer
--you can get VERSION_GUID from Package/Properties from DTS Designer 
```

有效载荷在`packagedata`现场。但是，它是二进制格式，因此无法对该字段进行太多操作。

这在技术上从物理位置的角度回答了这个问题。

# perl - 什么可以使 Class::Loader 在“use”和“new”没有失败的情况下失败？

> ID：443493
> 
> 赞同：3
> 
> 时间：2009-01-14T15:59:09.760
> 
> 标签：perl, cgi, cpan

我正在开发一个使用[Crypt::RSA](http://search.cpan.org/dist/Crypt-RSA)的非常大的 CGI 应用程序，该应用程序已正确安装。当我尝试运行任何嵌入式库时，我收到“尝试将空引用作为函数调用”类型的错误（我现在无法返回确切的错误，因为我们必须回滚发布日期） . 我跟踪对 Crypt::RSA 构造函数的空引用，该构造函数使用[Class::Loader](http://search.cpan.org/dist/Class-Loader)来启用 Crypt::RSA::ES::OAEP。

我用“use”和“new”替换了类加载器，这部分工作正常，尽管库在很多方面仍然失败。显然我的环境有问题。我只是不确定是什么。谁能给我任何线索？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T18:38:33.807

好的，经过 12 个小时的深入研究，我得到了这个工作。

这就是发生的事情（但不是为什么）。每当我调用`eval()`引用`use`或`require`语句时（如发生在 Class::Loader 中，也发生在 Crypt:: 框架中的其他位置），它无法看到以其他方式包含为 Perl 类路径的路径。由于大多数引用的 use/require 对象只是假设该类将在那里，因此很少有有用的错误被抛出。我会转储`@INC`到文件，在 eval 块之外，一切都会在那里。

具有讽刺意味的是，我在 dev vs staging 中使用了相同的设置，它在 dev 中有效，但在 staging 中无效。我还必须指出，FindBin（我不应该在 CGI 中使用它，我知道，但 Crypt 使用它）在 /dev/null 中上下摆动，但在开发中却没有。

由于我无法轻松比较版本或全局配置，这就是我的任务结束的地方。

我在 Crypt::RSA 中为自己解决问题的方法是禁用与 FindBin 相关的所有命令，以及`requir`我的代码可以访问的任何内容的硬编码 e 引用。我在 Crypt::RSA 中为 Crypt::RSA::ES::OAEP 做了一个要求，在 Crypt::Random::Generator 中为 Crypt::Random::Provider::rand 做了一个要求

希望这可以帮助将来遇到问题的任何人。任何可以提出原因的人，请回复，我将添加它以完成帖子。

# list - SharePoint 编辑任务列表任务

> ID：443495
> 
> 赞同：0
> 
> 时间：2009-01-14T15:59:36.357
> 
> 标签：list, sharepoint, task, edit

我有 SharePoint 设置，为了测试，我添加了一个任务列表，添加了几列，并对其进行了测试。我想修改任务列表任务页面，而不是任务列表页面。我可以编辑任务列表页面，但我无法编辑任务列表任务页面。我在该页面上的站点操作中缺少“编辑页面”按钮。如何编辑实际任务的页面？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-14T16:33:58.767

不是开箱即用。除了生成不同的视图之外，您对列表页面无能为力。也许您可以通过内容查询 Web 部件公开该列表并按照您喜欢的方式对其进行格式化。

# java - 将 JSON 转换为地图

> ID：443499
> 
> 赞同：222
> 
> 时间：2009-01-14T16:00:38.773
> 
> 标签：java, json, parsing, collections

像这样转换 JSON 代码的最佳方法是什么：

```
{ 
    "data" : 
    { 
        "field1" : "value1", 
        "field2" : "value2"
    }
} 
```

在其中一个键是 (field1, field2) 并且这些字段的值是 (value1, value2) 的 Java Map 中。

有任何想法吗？我应该为此使用 Json-lib 吗？或者如果我编写自己的解析器会更好？

* * *

## 回答 #1

> 赞同：394
> 
> 时间：2009-02-24T21:11:56.707

我希望您是在开玩笑说要编写自己的解析器。:-)

对于这样一个简单的映射，[http://json.org](http://json.org)（java 部分）中的大多数工具都可以使用。对于其中之一（杰克逊[https://github.com/FasterXML/jackson-databind/#5-minute-tutorial-streaming-parser-generator](https://github.com/FasterXML/jackson-databind/#5-minute-tutorial-streaming-parser-generator)），你会这样做：

```
Map<String,Object> result =
        new ObjectMapper().readValue(JSON_SOURCE, HashMap.class); 
```

（其中 JSON_SOURCE 是文件、输入流、阅读器或 json 内容字符串）

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2011-11-15T06:25:48.970

使用 GSON 库：

```
import com.google.gson.Gson;
import com.google.common.reflect.TypeToken;
import java.lang.reclect.Type; 
```

使用以下代码：

```
Type mapType = new TypeToken<Map<String, Map>>(){}.getType();  
Map<String, String[]> son = new Gson().fromJson(easyString, mapType); 
```

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2011-12-01T10:15:31.220

我喜欢[谷歌 gson](http://code.google.com/p/google-gson/)库。
当你不知道 json 的结构时。您可以使用

```
JsonElement root = new JsonParser().parse(jsonString); 
```

然后你可以使用json。例如如何从您的 gson 中获取“value1”：

```
String value1 = root.getAsJsonObject().get("data").getAsJsonObject().get("field1").getAsString(); 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2010-11-10T22:02:39.083

使用 JSON 库例如[http://www.json.org/java/](http://www.json.org/java/)

```
// Assume you have a Map<String, String> in JSONObject jdata
@SuppressWarnings("unchecked")
Iterator<String> nameItr = jdata.keys();
Map<String, String> outMap = new HashMap<String, String>();
while(nameItr.hasNext()) {
    String name = nameItr.next();
    outMap.put(name, jdata.getString(name));

} 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2015-08-18T07:46:35.910

我的帖子可能对其他人有帮助，所以想象一下您有一张地图，其中包含特定的值对象，如下所示：

```
{  
   "shopping_list":{  
      "996386":{  
         "id":996386,
         "label":"My 1st shopping list",
         "current":true,
         "nb_reference":6
      },
      "888540":{  
         "id":888540,
         "label":"My 2nd shopping list",
         "current":false,
         "nb_reference":2
      }
   }
} 
```

要使用 GSON 库解析这个 JSON 文件，很简单：如果您的项目是 mavenized

```
<dependency>
    <groupId>com.google.code.gson</groupId>
    <artifactId>gson</artifactId>
    <version>2.3.1</version>
</dependency> 
```

然后使用这个片段：

```
import com.google.gson.Gson;
import com.google.gson.JsonElement;
import com.google.gson.JsonObject;
import com.google.gson.JsonParser;

//Read the JSON file
JsonElement root = new JsonParser().parse(new FileReader("/path/to/the/json/file/in/your/file/system.json"));

//Get the content of the first map
JsonObject object = root.getAsJsonObject().get("shopping_list").getAsJsonObject();

//Iterate over this map
Gson gson = new Gson();
for (Entry<String, JsonElement> entry : object.entrySet()) {
    ShoppingList shoppingList = gson.fromJson(entry.getValue(), ShoppingList.class);
    System.out.println(shoppingList.getLabel());
} 
```

相应的 POJO 应该是这样的：

```
public class ShoppingList {

    int id;

    String label;

    boolean current;

    int nb_reference;

    //Setters & Getters !!!!!
} 
```

希望能帮助到你 ！

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-01-04T11:22:14.440

这样它就像地图一样工作......

```
JSONObject fieldsJson = new JSONObject(json);
String value = fieldsJson.getString(key);

<dependency>
    <groupId>org.codehaus.jettison</groupId>
    <artifactId>jettison</artifactId>
    <version>1.1</version>
</dependency> 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2017-08-31T12:57:42.380

我这样做。这很简单。

```
import java.util.Map;
import org.json.JSONObject;
import com.google.gson.Gson;

public class Main {
    public static void main(String[] args) {
        JSONObject jsonObj = new JSONObject("{ \"f1\":\"v1\"}");
        @SuppressWarnings("unchecked")
        Map<String, String> map = new Gson().fromJson(jsonObj.toString(),Map.class);
        System.out.println(map);
    }
} 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-09-12T05:51:15.897

使用谷歌的 Gson 2.7（也可能是早期版本，但我测试了 2.7）它很简单：

```
Map map = gson.fromJson(json, Map.class); 
```

它返回一个类型的 Map`class com.google.gson.internal.LinkedTreeMap`并在嵌套对象上递归工作。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-02-14T10:06:53.510

JsonTools 库非常完整。它可以在[Github](https://github.com/branscha/lib-jsontools)上找到。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2014-08-13T14:10:09.603

```
java.lang.reflect.Type mapType = new TypeToken<Map<String, Object>>(){}.getType();
Gson gson = new Gson();
Map<String, Object> categoryicons = gson.fromJson(json, mapType ); 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2020-03-30T18:50:39.193

如果您使用的是 org.json，JSONObject 有一个方法`toMap()`。您可以轻松做到：

```
Map<String, Object> myMap = myJsonObject.toMap(); 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-03-18T10:58:56.643

另一种选择是[json-simple](https://github.com/fangyidong/json-simple/)，可以在[Maven Central](http://mvnrepository.com/artifact/com.googlecode.json-simple/json-simple/1.1.1)中找到：

```
(JSONObject)JSONValue.parse(someString); //JSONObject is actually a Map. 
```

该工件为 24kbytes，没有其他运行时依赖项。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-07-11T15:36:34.587

试试这个代码：

```
 public static Map<String, Object> convertJsonIntoMap(String jsonFile) {
        Map<String, Object> map = new HashMap<>();
        try {
            ObjectMapper mapper = new ObjectMapper();
            mapper.configure(DeserializationFeature.UNWRAP_ROOT_VALUE, true);
            mapper.readValue(jsonFile, new TypeReference<Map<String, Object>>() {
            });
            map = mapper.readValue(jsonFile, new TypeReference<Map<String, String>>() {
            });
        } catch (IOException e) {
            e.printStackTrace();
        }
        return map;
    } 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2021-06-19T03:56:38.757

JSON to Map 始终是字符串/对象数据类型。我有来自谷歌的 GSON 库。使用字符串的 Gson 库不适用于您需要做其他事情的复杂对象

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-01-10T15:01:56.440

[Underscore-java](https://github.com/javadev/underscore-java)库可以将 json 字符串转换为哈希映射。我是项目的维护者。

代码示例：

```
import com.github.underscore.U;
import java.util.*;

public class Main {

    @SuppressWarnings("unchecked")
    public static void main(String[] args) {
        String json = "{"
            + "    \"data\" :"
            + "    {"
            + "        \"field1\" : \"value1\","
            + "        \"field2\" : \"value2\""
            + "    }"
            + "}";

       Map<String, Object> data = (Map) U.get((Map<String, Object>) U.fromJson(json), "data");
       System.out.println(data);

       // {field1=value1, field2=value2}
    }
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-10-26T07:00:16.243

```
import net.sf.json.JSONObject

JSONObject.fromObject(yourJsonString).toMap 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-03-25T13:27:03.827

如果您需要没有任何依赖关系的纯 Java，您可以使用 Java 8 中的 Nashorn API 构建。**它在 Java 11 中已弃用。**

这对我有用：

```
...
import javax.script.ScriptEngine;
import javax.script.ScriptEngineManager;
import javax.script.ScriptException;
...

public class JsonUtils {

    public static Map parseJSON(String json) throws ScriptException {
        ScriptEngineManager sem = new ScriptEngineManager();
        ScriptEngine engine = sem.getEngineByName("javascript");

        String script = "Java.asJSONCompatible(" + json + ")";

        Object result = engine.eval(script);

        return (Map) result;
    }
} 
```

**示例使用**

JSON：

```
{
    "data":[
        {"id":1,"username":"bruce"},
        {"id":2,"username":"clark"},
        {"id":3,"username":"diana"}
    ]
} 
```

代码：

```
...
import jdk.nashorn.internal.runtime.JSONListAdapter;
...

public static List<String> getUsernamesFromJson(Map json) {
    List<String> result = new LinkedList<>();

    JSONListAdapter data = (JSONListAdapter) json.get("data");

    for(Object obj : data) {
        Map map = (Map) obj;
        result.add((String) map.get("username"));
    }

    return result;
} 
```

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2009-06-12T16:03:59.543

JSON to Map 始终是字符串/对象数据类型。我有谷歌的 GSON 库。

效果很好，JDK 1.5 是最低要求。

# multithreading - 增量器/减量器（var++，var--）等线程安全吗？

> ID：443500
> 
> 赞同：16
> 
> 时间：2009-01-14T16:00:40.490
> 
> 标签：multithreading, language-agnostic

受到这个问题的启发：[在复杂性分析中，为什么 ++ 被认为是 2 个操作？](https://stackoverflow.com/questions/443423/in-complexity-analysis-why-is-considered-to-be-2-operations)

采用以下伪代码：

```
class test
{
   int _counter;
   void Increment()
   {
     _counter++;
   } 
} 
```

这在 x86 架构上会被认为是线程安全的吗？此外，Inc / Dec 汇编指令线程安全吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-01-14T16:05:48.107

不，递增不是线程安全的。`INC`和`DEC`指令也不是。它们都需要加载和存储，并且在另一个 CPU 上运行的线程可以在这些操作之间交错的相同内存位置进行自己的加载或存储。

一些语言内置了对线程同步的支持，但这通常是您必须要求的，而不是您在每个变量上自动获得的东西。那些没有内置支持的人通常可以访问提供类似功能的库。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-14T16:05:27.173

一句话，没有。

`InterlockedIncrement()`您可以根据您的平台使用类似的东西。在 .NET 上，您可以使用`Interlocked`类方法（`Interlocked.Increment()`例如）。

[Rob Kennedy 提到](https://stackoverflow.com/questions/443500/are-incrementers-decrementers-var-var-etc-thread-safe#443530)，即使操作是根据单个指令实现的，`INC`就内存而言，执行一组读/增量/写步骤。多处理器系统存在损坏的机会。

还有一个`volatile`问题，这将是使操作线程安全的必要部分 - 但是，标记变量`volatile`不足以使其成为线程安全的。使用平台提供的联锁支持。

这通常是正确的，当然在 x86/x64 平台上也是如此。

# calling-convention - 将 __arglist 与一组不同的命名参数一起使用

> ID：443516
> 
> 赞同：2
> 
> 时间：2009-01-14T16:03:40.873
> 
> 标签：calling-convention

在我的应用程序中，我有 2 层。第一层是 C 遗留的公开 cdecl 函数，它使用“...”语法来处理不同的参数列表。我发现从我的 .Net 层（第二个）调用这些函数的唯一方法是使用 DllImport 技术。例如下面的 C 函数：

```
int myFunc(char* name, ...); 
```

在 C# 中看起来像这样：

```
[DllImport("MyDll.dll"),
 CharSet = CharSet.Ansi,
 CallingConvention = CallingConvention.Cdecl]
int myFunc(string name, __arglist); 
```

我的问题是，有时我想用 2 个额外参数调用此函数，但如果其中一个为 NULL，则它不会包含在参数列表中（我的旧代码在 NULL 值上失败）。例如我想要这个电话：

```
int foo(string name, string a, string b)
{
     myFunc(name, __arglist(a, b));
}

{
     foo("john", "arg1", null);
} 
```

被 C 解释为

```
myFunc("john", "arg1"); 
```

不幸的是做这样的事情：

```
int foo(string name, string a, string b)
{
     List<string> args = new List<string>();
     if(a != null) args.Add(a);
     if(b != null) args.Add(b);
     myFunc(name, __arglist(args));
}
{
     foo("john", "arg1", null);
} 
```

被 C 解释为：

```
myFunc(name, args); 
```

并不是：

```
myFunc(name, args[0]); 
```

有人知道吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T16:31:47.180

C 函数如何知道哪个是最后一个参数？它无法*先验地知道有*多少参数。它需要额外的信息。函数获取所需信息的一种常见方法是解析包含的字符串参数以计算格式说明符，如`printf`. 在这种情况下，如果格式字符串仅指示有一个额外参数，则该函数不知道真正只有一个额外参数的调用与有两个或有 20 个参数的调用之间的区别。函数应该具有只读取一个参数的自律性，因为这就是所说的所有格式字符串。阅读更多会导致未定义的行为。

如果我所描述的不是您的函数的工作方式，那么您在调用端无能为力来解决它。但如果你的函数是这样工作的，那么调用端就没有什么*可做**的*了，因为没有问题。

另一种选择，因为您指出您的“遗留代码在空值上失败”，是修复您的遗留代码，使其不再失败。

第三种选择是简单地写出所有四种可能性：

```
 if (a != null) {
   if (b != null)
     return myFunc(name, a, b);
   else
     return myFunc(name, a);
 } else {
   if (b != null)
     return myFunc(names, b);
   else
     return myFunc(names);
 } 
```

但是，超过两个可选参数，代码开始变得笨拙。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-12T20:12:52.177

尝试在将 System.List ToArray() 包装到 __arglist 之前转换它

`myFunc(name, __arglist(args.ToArray()));`

# language-agnostic - 一个类有多少变量太多了？

> ID：443518
> 
> 赞同：4
> 
> 时间：2009-01-14T16:03:44.743
> 
> 标签：language-agnostic, oop

我想看看是否有人对我正在编写的类（如[OOP中的类）有更好的设计。](http://en.wikipedia.org/wiki/Object-oriented_programming)我们有一个将共享文件夹统计信息放入[CSV](http://en.wikipedia.org/wiki/Comma-separated_values)文件的脚本。我正在阅读它并将其放入 Share 课程中。

我的老板想知道以下信息：

*   文件总数
*   文件总大小
*   办公文件数
*   办公文件的大小
*   exe文件数
*   exe文件的大小
*   ETC ....

我有一个类，其中包含 $numOfficeFiles、$sizeOfficeFiles 等变量以及大量的 get/set 方法。难道没有更好的方法来做到这一点吗？如果你有一个有很多变量/属性的类，一般规则是什么？

我认为这是一个与语言无关的问题，但如果它很重要，我正在使用 PHP。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-14T16:17:54.340

有时，数据可能只是数据：

```
files = {
   'total':  { count: 200, size: 3492834 },
   'office': { count: 25, size: 2344 },
   'exe':    { count: 30, size: 342344 },
   ...
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-14T17:57:06.340

每当我在一个类中看到超过 5 或 6 个非最终变量时，我都会感到不安。

按照 Outlaw Programmer 的建议，他们可能应该被安排在一个较小的班级中。它也很有可能只是放在哈希表中。

这里有一个很好的经验法则：如果你有一个只有一个 setter 和一个 getter 的变量，那么你有的是 DATA，而不是代码——把它从你的类中取出并放入一个集合或其他东西中。

拥有一个带有 setter 和 getter 的变量只是意味着您永远不会对它做任何事情（它是数据），或者操作它的代码在另一个类中（糟糕的 OO 设计，将变量移动到另一个类）。

请记住——作为类成员的每条数据都是您必须编写特定代码才能访问的东西；例如，当您将其从对象传输到 GUI 上的控件时。

我经常用名称标记 GUI 控件，这样我就可以遍历集合并自动将数据从集合传输到屏幕并返回，从而显着减少样板代码；将数据存储为成员变量会使这个过程更加复杂（需要反思）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-14T16:12:38.327

“一个班级应该做一件事，并且把它做好”

如果你没有违反这条规则，那么我会说没有太多。

但是，这取决于。

如果太多你的意思是 100，那么你可能想把它分成一个数据类和集合，如下面的编辑所示。

然后你只有一个 get/set 操作，但是这种“懒惰”有利有弊。

**编辑：**

乍一看，您有成对的变量，计数和大小。应该有另一个类，例如具有计数和类的 FileInfo，现在您的第一个类只有 FileInfo 类。

您还可以输入文件类型，例如“All”、“Exe”。. . 在文件信息类上。现在父类变成了 FileInfo 对象的集合。

就个人而言，我想我会去的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T16:09:32.530

我认为答案是“没有太多变数”。

但是，如果这些数据要保留一段时间，您可能只想将其放入数据库并让您的函数调用数据库。

我假设您不想在每次被要求时都重新计算所有这些值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-14T16:12:23.740

每个类的“最大变量”计数实际上是对所讨论的类有意义的数据的函数。如果一个类确实有 X 个不同的值并且所有数据都是相关的，那应该是你的结构。根据所使用的语言创建可能有点乏味，但我不会说你不应该超过任何“限制”。这是由目的决定的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-14T16:24:16.743

听起来您可能有大量重复的代码。您想要一堆不同类型的文件数和文件大小。您可以从如下所示的类开始：

```
public class FileStats
{
    public FileStats(String extension)
    {
        // logic to discover files goes here
    }

    public int getSize() { }
    public int getNumFiles() { }
} 
```

然后，在你的主类中，你可以拥有一个包含所有你想要的文件类型的数组，以及这些帮助对象的集合：

```
public class Statistics
{
    private static final String[] TYPES = { "exe", "doc", "png" };
    private Collection<FileStats> stats = new HashSet<FileStats>();

    public static void collectStats()
    {            
        stats.clear();
        for(String type : TYPES)
            stats.add(new FileStats(type));
    }
} 
```

您可以通过将参数传递给 getter 方法来清理您的 API：

```
public int getNumFiles(String type)
{
    return stats.get(type).getNumFiles();
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-14T16:13:17.610

没有“硬”限制。然而，OO 设计确实有[耦合](http://en.wikipedia.org/wiki/Coupling_(computer_science))和[内聚](http://en.wikipedia.org/wiki/Cohesion_(computer_science))的概念。只要您的课程是松散耦合且高度内聚的，我相信您可以根据需要使用尽可能多的成员/方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-14T16:13:32.833

就我所看到的：

如果您保留一个包含所有文件名的数组，则可以动态计算所有这些变量。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-14T16:13:59.557

也许我不明白目标，但是为什么要使用变量将所有值加载到内存中，只是为了将它们转储到 csv 文件（何时？）。我更喜欢目录的无状态监听器并立即将值写入 csv。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-14T16:20:51.493

这更像是一个可读性问题。

我会将所有数据包装到一个数组中。并且只使用一对 get/set 方法。

就像是：

```
class Test()
{
    private $DATA = array();

    function set($what,$data) {
       $DATA[$what] = $data;
    }

    function get($what) {
        return $this->DATA[$what];
    }
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-14T16:22:45.297

我总是试图将一个类视为我要计算的“我的容器的名称”或“任务的名称”。类中的方法是任务的“动作”部分。

在这种情况下，您似乎可以开始将事物组合在一起，例如您多次重复**数字**和**大小**操作。为什么不创建一个其他类继承自的超类，例如：

```
class NameOfSuperClass {
    public $type;
    function __construct($type) {
        $this->type = $type;
        $this->getNumber();
        $this->getSize();
    }
    public function getNumber() {
        // do something with the type and the number
    }
    public function getSize() {
        // do something with the type and the size
    }
}

Class OfficeFiles extends NameOfSuperClass {
    function __construct() {
        $this->_super("office");
    }
} 
```

我不确定这在 PHP 中是否正确，但你明白我的意思。事情将开始看起来更干净，更易于管理。

# c# - 如何将具有整数值的 (byte[] lpData) 传递给 RegSetValueExW P/Invoke

> ID：443522
> 
> 赞同：0
> 
> 时间：2009-01-14T16:04:49.997
> 
> 标签：c#, interop, registry

我有这个 P/Invoke RegSetValueExW 将值设置为注册表项。在 C# 中

```
[DllImport("coredll.dll", EntryPoint = "RegSetValueExW")]
public static extern int RegSetValueExW(uint hKey, string lpValueName,
            uint lpReserved,
            uint lpType,
            byte[] lpData,
            uint lpcbData); 
```

我的第 4 个参数 byte[] lpdata 有问题。我需要传递一个值为 5 (int) 的 DWORD。如果我传递一个字符串 (REG_SZ)，一切正常，只需要使用 GetBytes 函数进行转换。

如果我调用 GetBytes("5") 它将其转换为 53 的 ascii 值，因此它将 53 写入注册表值而不是 5

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T16:19:07.177

我首先要问你为什么在 Microsoft.Win32.RegistryKey 类中已经有设置注册表值的方法时在这里使用 PInvoke？或者您是否还在使用旧版本的 Compact Framework？

假设您对 PInvoke 有充分的理由，最简单的答案就是为整数值重载 PInvoke 声明。IE：

```
[DllImport("coredll.dll", EntryPoint = "RegSetValueExW")]
public static extern int RegSetValueExW(uint hKey, string lpValueName,
        uint lpReserved,
        uint lpType,
        ref int lpData,
        uint lpcbData); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T16:23:00.117

使用 REG_DWORD 而不是 REG_SZ，然后使用 BitConverter.GetBytes(Int32) 将 int 转换为 byte[]。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T16:21:58.933

如果您需要传递一个整数值，您可以简单地将其转换为字节

```
byte[] lpData = new byte[] { (byte)5 }; 
```

# sql-server-2005 - SQL 2005：NOLOCK 提示显着增加了读取。怎么回事？

> ID：443531
> 
> 赞同：2
> 
> 时间：2009-01-14T16:05:49.713
> 
> 标签：sql-server-2005, locking, query-hints

我有一个存储过程，当 NOLOCK 提示添加到查询时，它会执行更多读取操作。我很困惑 - 请问有人知道为什么吗？

详细信息：查询是：

```
SELECT * FROM dbo.<table-name> WITH (NOLOCK). 
```

它进行了 40,000 次读取，但行数不到 2,000 行。我确定大多数这些读取是由 3 个 TEXT 列引起的。（如果我省略了这些，它会下降到 59 次读取！）但是当我删除 WITH (NOLOCK) 时，它会从 40,000 次读取到 13,000 次。我重复了几次，因为我认为我一定搞砸了，但这两种方式都非常一致。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T16:21:49.777

NOLOCK 从尚未提交的事务中读取数据。

**编辑**

NOLOCK 读取未提交数据的演示。

```
create table table1 (id int, val int)
go

select * from table1 with ( NoLock)
begin tran
insert into table1 values (1,1)

--Switch to new query window
select * from table1 with ( NoLock)
--switch back
rollback tran
select * from table1 with ( NoLock) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T16:07:28.057

也许读取计数包括读取锁的页面读取？

# sql-server - 如果我所有的 sql server 数据库访问都是通过存储过程完成的

> ID：443532
> 
> 赞同：4
> 
> 时间：2009-01-14T16:05:52.227
> 
> 标签：sql-server, linq, linq-to-sql

如果我所有的 sql server 数据库访问都是通过存储过程完成的，并且我计划继续这种做法，那么在未来的项目中使用 linq2sql 和/或实体框架是否是一个不必要的复杂层，不会增加太多价值？

相关问题：微软是否试图引导开发人员远离依赖存储过程进行数据访问？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T16:12:00.777

不。LINQ2SQL 在能够轻松地将数据库实体映射到代码中的类并使用本机语言结构轻松处理这些类方面增加了很多价值。如果需要，您可以轻松地将生成的实体类的 CRUD 操作映射到存储过程。我确实发现有些东西不再需要存储过程来轻松工作，所以我已经不再使用它们，但你不是被迫的。本质上，LINQ2SQL 可以做的是替换大部分（如果不是全部）您的 DAL，从而使您不必编写此代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T16:17:01.593

我也使用 Linq2sql 来调用我的存储过程，因为它生成 .net 代码的速度如此之快，我可以从我的应用程序中调用它，它只是拖放，基本上在几秒钟内完成。我仍然认为您需要问自己花费了多少时间来维护这些存储过程。如果你这样做，你会节省大量使用 linq2sql 进行 crud 调用的时间。我仅在对数据库执行多步操作时才使用存储过程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T16:16:41.627

LINQ-to-SQL 支持将大量操作（包括 CRUD）映射到存储过程，但您失去了可组合性 - 即您不能只添加`(exp).Where(x=>x.IsActive)`. 一种选择是使用表值函数 (UDF) 代替**查询**数据的存储过程；这也提供了一个更严格的元模型（而不是`SET FMT_ONLY ON`, 即 hit'n'miss ）。

这样，您的查询方法可以在数据库中组合；但请注意，实体框架不**支持**这一点，即使 LINQ-to-SQL 支持。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T17:31:30.977

只是为了解决您的相关问题：使用存储过程的好处不像以前那么突出。虽然我不会说存储过程是邪恶的，就像过去有些人所说的那样（[http://www.tonymarston.net/php-mysql/stored-procedures-are-evil.html](http://www.tonymarston.net/php-mysql/stored-procedures-are-evil.html) - 这是一个非常不错的文章），我会说动态 sql 的使用，只要它以明确定义的结构化方式完成，这些天是完全可以接受的。

我不认为微软试图引导开发人员远离使用存储过程，但动态 sql 应该被视为一个可接受的选项。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T04:09:18.973

您失去了编写 Linq 查询的能力，这是 linq-to-sql 的最佳部分。

# xml - 如何在 Flex/ActionScript 中使用 SortField 对数据进行数字排序？

> ID：443542
> 
> 赞同：2
> 
> 时间：2009-01-14T16:07:06.763
> 
> 标签：xml, apache-flex, actionscript, sorting

从文档中：

**SortField() 构造函数**

```
public function SortField(name:String = null, caseInsensitive:Boolean = false, descending:Boolean = false, numeric:Object = null) 
```

我对最后一部分感到困惑 - `numeric:Object = null`。

这是我的功能：

```
private function createXMLDataProvider():XMLListCollection{
    var sort:Sort = new Sort();
    sort.fields = [new SortField("@sortorder",true,false,true), new SortField("@label")];
    var searchTypesCollection:XMLListCollection = 
        new XMLListCollection(getAssociations(_appData.searchTypes, "category", searchType));
    searchTypesCollection.sort = sort;
    searchTypesCollection.refresh();
    return searchTypesCollection;
} 
```

在这条线上：

```
sort.fields = [new SortField("@sortorder",true,false,true), new SortField("@label")]; 
```

第一个 SortField 是一个数字，但正在像文本一样进行比较。我应该把什么放在它说真的地方？

同样来自文档：

指定如果正在排序的字段包含数字（数字/int/uint）值或数字值的字符串表示，则比较器使用数字比较。如果此属性为 false，则使用字符串比较对具有数字字符串表示的字段进行排序，因此 100 在 99 之前，因为“1”是低于“9”的字符串值。如果此属性为空，则对第一个数据项进行自省以查看它是数字还是字符串，并根据该自省进行排序。

默认值为假。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T16:50:34.227

在此处查看对 XMLListCollection 进行排序的示例：

[http://blog.flexexamples.com/2007/08/05/sorting-an-arraycollection-using-the-sortfield-and-sort-classes/](http://blog.flexexamples.com/2007/08/05/sorting-an-arraycollection-using-the-sortfield-and-sort-classes/)

如果您向下滚动到 Vivek 的评论，这里有一个示例和来自 Peter deHaan 的后续评论。看起来他只是省略了 caseInsensitive 属性，而不是在构造函数中明确设置它，例如：

```
var sortField:SortField = new SortField(value);
sortField.numeric = true;
sortField.descending = true;

var sort:Sort = new Sort();
sort.fields = [sortField];
xmlListColl.sort = sort;
return xmlListColl.refresh(); 
```

希望有帮助！顺便说一句，数字属性的 true 是正确的——我不确定它为什么接受 Object；它看起来像在 Flex 2 中，它是一个布尔值，而在 Gumbo 中，它仍然是一个对象，尽管在 Gumbo 文档中添加了以下行：

> 修改此属性时，它会调度 numericChanged 事件。

一个线索，也许？不过，布尔值很好，是的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T18:33:54.267

我只是在这里猜测，但是`caseInsensitive`和`numeric`字段对我来说似乎是一个非此即彼的选择，也就是说，如果您设置`caseInsensitive`为`true`，那么设置 也没有真正意义，`numeric`反之亦然。尝试如下修改上面的行，看看它是否可以这样工作。

```
sort.fields = [new SortField("@sortorder",false,false,true), new SortField("@label")]; 
```

# java - 快速而肮脏的解决方案，用于不同机器中的进程之间的通信

> ID：443543
> 
> 赞同：5
> 
> 时间：2009-01-14T16:07:09.820
> 
> 标签：java, windows, process, communication

我在我的网络中的两台机器上有两个用 java 编写的进程，它们应该将简单的数据块相互传递。

**我正在寻找一种快速而肮脏的方式（不求助于写入文件和轮询网络共享文件的更改）**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-14T16:09:30.753

java [RMI](http://java.sun.com/javase/6/docs/technotes/guides/rmi/index.html)（远程方法接口）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T20:35:37.267

ActiveMQ Broker 上的 JMS 非常简单。它[在这里](http://activemq.apache.org/download.html)可用。以下是发送消息的快速而肮脏的伪代码，但您可以看到它的最小代码。考虑两个 Java 应用程序，一个发布者和一个订阅者。

1.  在您的发布者之一中创建代理：

    ```
    BrokerService broker = new BrokerService();    
    broker.addConnector("tcp://localhost:61616");    
    broker.setPersistent(false);    
    broker.start(); 
    ```

2.  在两个应用程序中设置连接（注意：订阅者将本地主机替换为运行代理的机器的地址）：

    ```
    final ActiveMQConnectionFactory factory = new ActiveMQConnectionFactory("tcp://localhost:61616");    
    TopicConnection connection = factory.createTopicConnection();    
    Session session = connection.createSession(false,Session.DUPS_OK_ACKNOWLEDGE); 
    ```

3.  在发布应用程序中发送数据：

    ```
    Topic topic = session.createTopic("Quick and dirty topic");
    MessageProducer producer = session.createProducer(topic);    
    ObjectMessage message = session.createObjectMessage();    
    message.setObject((Serializable) "Object you want to send");    
    producer.send(message); 
    ```

4.  在您订阅应用程序（必须实现 javax.jms.MessageListener）中，需要以下设置：

    ```
    Destination dest = session.createTopic("Quick and dirty topic");    
    MessageConsumer consumer = session.createConsumer(dest);    
    consumer.setMessageListener(this); 
    ```

5.  订阅应用程序的`onMessage(Message arg0)`方法（因为它是 MessageListener）将收到已发布对象的通知。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T16:11:47.737

假设机器有彼此的地址（得到所说的地址是一个不同的问题），我认为你最好的选择是[Spring remoting](http://static.springframework.org/spring/docs/2.0.x/reference/remoting.html)。您有一个数据传递接口、一个封装您要传递的数据的域对象，以及一个在每一端实现该接口的远程服务。之后，您的代码将远程服务视为另一个协作者。便宜、简单、快速，您可以使用任何您喜欢的传输方式（RMI、HTTP、Hessian、Burlap 等）。

我通常需要大约 10 分钟（最多）将现有的接口/服务公开为远程服务，尽管第一次需要更长的时间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T04:07:46.403

您可能会发现[Terracotta](http://terracotta.org)是一种非常简单的方法。Terracotta 允许您聚集堆的一部分（例如，HashMap）并在所有节点上查看该映射的内容。设置它相当简单。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-14T16:16:00.113

我将支持让您的进程通过套接字进行通信的想法，并提到 Apache 的[MINA](http://mina.apache.org/)包使这种事情变得非常简单和健壮，并且具有可扩展性，而没有像 RMI 或 JMS 这样的更大系统的开销。它还包含对编码和解码消息的一些很好的支持。我在一个中等规模的系统中使用得非常成功。

这种交流也很容易抽象。无论您是否使用 MINA，一旦您设置了类来处理建立/拆除连接和跨连接移动数据，它们可能会高度可重用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-14T16:11:15.990

你所描述的是快速（而且不是那么快）和肮脏的方式。完成任务的唯一其他方法是设置进程以通过套接字侦听和发送数据（由您直接实现 - 在 java 中这很容易，只需谷歌，您会发现，或者作为库的一部分 - 可能需要更复杂的东西）

因此，每个进程都会在特定端口上有一个侦听器，并且每隔一段时间就会通过该端口发送数据。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-14T20:48:34.807

我完全同意 GaryF Spring Remoting 是最好的选择，它既快速又干净。如果您对 Spring 完全不熟悉，一开始可能需要一些时间。但相信我，这完全值得。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-14T16:08:56.073

问题不清楚。您是否正在寻找要使用的 API 或库？两台机器一开始就知道彼此的地址，还是需要互相发现？

您可以将 JMS 用于大多数通信，但所有机器都必须熟悉单独运行的“代理进程”。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-14T17:42:08.507

我发现 RMI 有点烦人。您必须为单个远程对象定义 3 个文件，并且如果您还不知道如何使用它，则必须学习正常开发过程之外的东西（我相信涉及单独的编译器步骤）。

可能有工具可以让它工作，但我可以建议只打开一个简单的套接字吗？它们使用起来几乎是微不足道的。

唯一需要注意的是，您应该小心定义计算机之间的流量。

# java - 在不使用关系数据库的情况下在 Java 中存储和检索对象的简单方法？

> ID：443558
> 
> 赞同：11
> 
> 时间：2009-01-14T16:10:25.510
> 
> 标签：java, persistence, relational

**您是否知道不使用像 Hibernate 这样的关系 DB / ORM**在 Java 中存储和检索对象的“简单”方法？

[*请注意，我没有为此考虑按原样进行序列化，因为它不允许检索对象图中间的任意对象。我也不考虑 DB4O，因为它有限制性许可。谢谢。*]

“简单”的意思是：不必处理诸如键/值对之类的低级细节来重建对象图（与 BerkeleyDB 或传统缓存一样）。这同样适用于从面向文档或面向列的数据库（CouchDB、HBase、...，甚至 Lucene）重建对象。

也许有一些有趣的项目在上述存储系统和我不知道的对象模型（如 ORM 用于 RDBMS）之间提供了一层集成。

任何人成功地在生产中使用它们，或者尝试使用关系数据库以外的持久性策略？RDF 商店怎么样？

**更新**：我遇到了一篇非常有趣的文章：[分布式键值存储列表](http://www.metabrew.com/article/anti-rdbms-a-list-of-distributed-key-value-stores/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-14T16:17:30.750

*   [对象序列化](http://www.mactech.com/articles/mactech/Vol.14/14.04/JavaSerialization/index.html)（也就是将东西存储到文件中）
*   [Hibernate](http://www.hibernate.org/)（使用关系数据库，但对开发人员相当透明）

我建议使用 Hibernate，因为它可以处理在使用数据库时使开发人员陷入困境的大部分丑陋细节，同时仍然允许多年来对数据库软件进行的优化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T16:32:36.510

[NeoDatis](http://www.neodatis.org/)看起来很有趣。它是根据 LGPL 获得许可的，因此不像 GLP 本身那样严格。

查看他们的[1 分钟教程](http://www.neodatis.org/1m-tutorial)，看看它是否适合您的需求。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T16:58:27.440

我想推荐[XStream](http://xstream.codehaus.org/)，它只需要你的 POJO 并从中创建 XML，这样你就可以将它存储在磁盘上。它非常易于使用，也是开源的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T16:22:58.243

我会推荐像马特这样的 Hibernate（或更一般地说，OR-mapping），但后端也有一个 RDBMS，我不太清楚你的意思

> ...不使用关系数据库？...

了解更多有关应用程序的信息也会很有趣，因为 OR 映射并不总是一个好主意（开发性能与运行时性能）。

编辑：我很快就了解了兵马俑，这里有一个关于用该工具替换数据库的很好的 stackoverflow[讨论](https://stackoverflow.com/questions/346647/on-using-terracotta-as-a-persistence-solution)。仍然是实验性的，但值得一读。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-14T17:34:47.443

我仍然认为您应该考虑为[db4o](http://www.db4o.com/)付费。

如果您想要其他内容，请在标题中添加“with an MIT-style license”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-14T16:25:55.913

查看 Prevayler[对此问题](https://stackoverflow.com/questions/439958/highest-performance-database-in-java)的评论。Prevayler 是一个围绕对象序列化的事务性包装器——粗略地说，在纯 java 中使用对象并通过没有 sql 的 java API 持久化到磁盘，比编写自己的序列化更简洁。

注意事项 - 将序列化作为一种​​持久性机制，您在更新类时冒着使保存的数据无效的风险。即使使用包装库，您也可能希望自定义序列化/反序列化处理。它还有助于在类中包含 serialVersionUID，这样您就可以覆盖 JVM 关于何时更新类的想法（因此无法重新加载您保存的序列化数据）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-14T16:49:59.953

嗯...如果没有序列化，也没有 ORM 解决方案，我会退回到某种基于 XML 的实现吗？如果您只想从对象图中提取一些对象，您仍然必须仔细设计它 - 可能每个对象都有一个不同的文件，其中对象关系由一个 URI 引用到另一个文件？

我会说这并不“容易”，因为我一直发现设计 XML 到对象的映射有点费时，但我真的受到了 Apache Betwixt 上的一次对话的启发，这让我感到充满希望刚刚过时，现在可以使用更简单的解决方案。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-17T08:21:34.960

Terracotta 提供了一个高度可用、高度可扩展的持久磁盘对象存储。您可以仅将它用于此功能 - 或者您可以使用它的广泛功能来实现完全集群的应用程序 - 您的选择。

红陶：

*   不会破坏对象身份，为您提供最自然的编程接口
*   不需要序列化
*   集群（并持久化）几乎所有 Java 类（Maps、Locks、Queues、FutureTask、CyclicBarrier 等）
*   以内存速度将对象持久保存到磁盘
*   仅移动对象增量，提供非常高的性能

[这是一个关于 gnip 如何](http://www.terracotta.org/web/display/orgsite/TCCS+Gnip)使用 Terracotta 进行内存持久性的案例研究 - 没有数据库。Gnip 接收 Facebook、Twitter 等网站上的所有事件，并以标准化的方式为消费者制作它们。他们目前的解决方案是每秒处理超过 50,000 条消息。

它是 OSS，并与许多其他 3rd 方框架高度集成，包括 Spring 和 Hibernate。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-01T23:01:46.773

我想我已经找到了我的问题的答案。

当您一直从关系、规范化和连接方面考虑您的数据时，获得面向文档的范式思维方式并非易事。

[CouchDB](http://couchdb.apache.org)似乎符合要求。它仍然可以充当键值存储，但其强大的查询功能（map/reduce、视图排序规则）、并发准备和与语言无关的 HTTP 访问使其成为我的选择。

唯一的问题是必须正确定义 JSON 结构并将其映射到对象，但我相信我会想出一个简单的解决方案来使用 Java 和 Scala 的关系模型（并且稍后担心缓存，因为争用已从数据库）。Terracotta 仍然有用，但肯定不像 RDBMS 场景那样有用。

谢谢大家的意见。

# authentication - wininet如何处理cookies

> ID：443567
> 
> 赞同：0
> 
> 时间：2009-01-14T16:12:06.317
> 
> 标签：authentication, wininet, http-authentication

我有一个 .NET 客户端应用程序，它需要使用两个不同的用户凭据与服务器进行通信。假设应用程序运行两个线程。开始运行时，每个线程都会发送用户和密码以进行身份​​验证，然后服务器会在 http 会话中存储一个 cookie。随后的调用发送身份验证 cookie 而不是用户凭据。

我们有两个用于同一进程的 cookie。wininet 如何“知道”为每个线程发送适当的 cookie？

wininet 是否管理每个线程的 cookie 集合？每个http会话？每个进程？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T16:27:44.927

Wininet 对每个进程使用 cookie。

但是，在 .NET 客户端中，您可以将 Cookie 容器与 HttpWebRequest 对象一起使用。

您为每个“会话”创建一个 cookie 容器。在为每个会话发出各种请求时，为每个 HttpWebRequest 分配适当的容器。

# .net - 使用 ComboBox 的自动完成功能，同时将值限制为列表中的值？

> ID：443569
> 
> 赞同：18
> 
> 时间：2009-01-14T16:12:37.547
> 
> 标签：.net, winforms, validation, combobox

在 WinForms 2.0 中，ComboBox 具有自动完成功能，它显示一个自定义下拉列表，其中仅包含以输入文本开头的值。

但是，如果我想将有效值限制为仅出现在 ComboBox 的项目列表中的值，我可以通过设置`DropDownStyle`to来做到这一点`DropDownList`，这会阻止用户输入值。

但是，现在我无法使用需要用户输入的自动完成功能。

是否有另一种方法可以限制对列表的输入，同时仍然允许使用自动完成功能？请注意，我已经看到了一些自定义解决方案，但我真的很喜欢匹配的自动完成项目在下拉列表中显示的方式，即使原始列表可能不是，也可以排序。

编辑：我考虑过只验证输入的值，即测试用户输入是否在`TextChanged`事件中有效，甚至在使用`Validating`事件中。那么问题是预期的行为是什么？我是清除它们的值（空值也是无效的），还是使用默认值？最接近的匹配值？

Ps 还有其他的标签可以添加到这个问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-01T10:05:51.440

这个解决方案对我有用：

```
Private Sub myComboBox_Validating(sender As System.Object, e As System.ComponentModel.CancelEventArgs) Handles myComboBox.Validating
    If Not myComboBox.Items.Contains(myComboBox.Text) Then
        MsgBox("Please select a value from the list", MsgBoxStyle.Exclamation, "Value not available")
        e.Cancel = True
    End If
End Sub 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-01-13T15:33:39.547

您是否尝试过设置`AutoCompleteMode = AutoCompleteMode.SuggestAppend`和`AutoCompleteSource = AutoCompleteSource.ListItems`？这允许用户输入，但它只接受`ComboBox`. 唯一的问题是 Win7 的行为发生了变化（请参阅[ComboBox.SelectedValue 与 Windows 7 中的 DropDownStyle = DropDownList 时显示的文本不匹配](https://stackoverflow.com/questions/2001361/combobox-selectedvalue-does-not-match-displayed-text-when-dropdownstyle-dropdow)）。

至于标签，你可以试试“combobox”和“.net”。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-08-08T05:35:48.977

它可能就像这样简单：

```
Private Sub cbx_Validating(ByVal sender As Object, _
                           ByVal e As System.ComponentModel.CancelEventArgs) _
    Handles  cbxZip.Validating, cbxCity.Validating, cbxCountry.Validating

    'Prerequisites: object: combobox, style: dropdownlist, 
    'autocompletesource=listitems, autocompletemode<>none
    'check if the typed value is in the list, else cancel
    'if the value isn't found, 'findstring' will return -1
    'if cancel is set to True, one can't leave the field
    e.Cancel = sender.FindStringExact(sender.Text) < 0

    'make it obvious to the user there is an issue
    If e.Cancel Then Beep()
End Sub 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-14T17:18:26.807

您可以挂钩 keypress 或 textchanged 事件并验证输入的文本是否是至少一个列表项的初始子字符串匹配，如果不是则拒绝按键（或删除最近的字符）。我能想到的唯一问题是，不接受某些输入可能会让用户有点困惑（特别是在输入第一个字符时，此时自动完成列表还不可见，所以他们会'不知道什么是有效值）。

或者只是在下拉列表模式下使用它 - 人们仍然可以输入，它会跳转到第一个匹配的列表项......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-06-08T07:58:40.387

您可以将“SuggestAppend 属性设置为 SuggestAppend”并将“AutoCompleteSource”设置为“ListItems”，这将在下拉列表中列出并添加您输入的字符。此外，如果没有选择，那么即使是 apprpiate ValueMemeber 也会被选择用于下拉菜单。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-10T02:51:38.223

我想做同样的事情并遇到了这个问题。这是我想出的。

为组合框创建 KeyDown 事件处理程序并检查 Enter 键。请注意，在用户点击输入后，组合框中的文本被选中（如，被选中，就像您正在执行剪切或复制操作一样）并且焦点仍保留在组合框中。

如果按下输入，则调用验证函数，如果输入的值是好/坏，它将执行您认为必要的任何操作。

您可以在 Leave 事件处理程序中调用相同的函数，以防止用户在做出有效选择之前离开组合框。

```
private void uxWidgetsComboBox_KeyDown(object sender, KeyEventArgs e)
{
   if (e.KeyCode == Keys.Enter)
   {
      ValidateSelection();
   }
}

private void uxWidgetsComboBox_Leave(object sender, EventArgs e)
{
   if(!ValidateSelection())
   {
      uxWidgetsComboBox.Focus();
   }
} 
```

或者类似的东西，但你明白了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-10-20T22:30:21.647

我有同样的问题......我问过同样的问题（[如何强制用户将建议的条目输入 ComboBox？](https://stackoverflow.com/questions/7759887/how-to-force-a-user-to-take-a-suggested-entry-into-a-combobox)），然后我用事件实现它，但我得到了很多代码通过概括行为得到改善......请告诉我你是否容易得到它。谢谢！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-14T16:17:09.910

我这样做的方法是在它们离开框时根据可能值列表检查值，并且不要让它们留下无效值。我不知道当您发现他们输入了无效值时您会如何处理它，但这是我过去所做的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-10-06T15:30:05.897

这对我有用。我使用 DataTable 作为数据源

```
 With cbo
    .AutoCompleteSource = AutoCompleteSource.ListItems
    .AutoCompleteMode = AutoCompleteMode.SuggestAppend
 End With

Private Sub cbo_Validating(sender As System.Object, e As System.ComponentModel.CancelEventArgs) Handles cbo.Validating
   If cbo.SelectedItem Is Nothing Then
       MessageBox.Show("Value entered not valid", "Message", MessageBoxButtons.OK, MessageBoxIcon.Exclamation)
       e.Cancel = True
   End If
End Sub 
```

# scrum - 您在开发过程中使用什么衡量标准来确定软件的*完成度*？

> ID：443575
> 
> 赞同：1
> 
> 时间：2009-01-14T16:13:28.653
> 
> 标签：scrum

我刚刚[在 Hanselminutes 上听完](http://www.hanselminutes.com/default.aspx?ShowID=137)一个关于“完成”定义的令人大开眼界的播客。所以我对每个人的问题是“你什么时候认为一个软件是“完成”的？是在它完全单元测试的时候吗？是在它完全记录在案的时候吗？你在开发过程中使用什么衡量标准来确定你的完成*度*？软件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-14T16:16:48.023

确定取决于软件的上下文和目的吗？

月球着陆器（真实的东西）对完成月球着陆器的 Flash 游戏会有一个非常不同的定义。

在我工作的地方，DONE 是由非技术经理委员会定义的。你可以想象其中的乐趣和游戏。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-14T16:17:49.050

sprint 评审中的测试、单元测试、集成测试、webtest、同行 QA 和最终用户评审。同行 QA 决定是否需要其他任何东西，所有测试都必须在 CI 环境中通过。这是在一个 scrum 网络项目中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-14T17:01:29.680

支票什么时候结清？

说真的，每次你编写一个软件时，你都应该*定义*“完成”的含义。第一的。如果您有客户，那么应该有一份合同——具体的、可衡量的、商定的和可测试的——定义完成。

如果你不知道你要去哪里，你怎么知道你什么时候到那里？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T16:17:18.163

当他们的客户（1）认为它完成时，它会被签入、备份和记录。

另外：“完成”很少存在于网络开发中。

*(1) 客户可能是内部 PM 等*

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-14T16:35:31.153

一个很好的衡量标准是代码流失。使用您的源代码控制软件，测量变化率。每天要删除/添加/更改多少行代码。随着时间的推移绘制这个图表。当您接近准备发布时，这应该会呈下降趋势，并表明稳定性和准备发布。这假设您实际上测试良好并进行更改以修复错误或响应更改请求。如果您的用户验收测试用户和集成/单元测试活动继续回归和测试，并且您不必进行代码更改（因为他们没有发现任何需要更改的内容），那么您可能已经准备好发布了。

如果在任意或外部驱动的发货日期前几天大量代码正在搅动，请注意！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-14T16:44:22.787

当软件可用于满足定义系统的要求时。

但我一直认为，“软件永远不会完成，它只是达到了可接受的不完整程度。”

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-14T16:57:22.810

从开发的角度来看，我的朋友和导师西蒙贝克很好地描述了“完成”，[这里](http://www.think-box.co.uk/blog/2006/02/knowing-when-youre-done.html)

Alistair Cockburn、Jeff Patton 和 Mike Cohn 也[收集了以下观点](http://www.infoq.com/news/2008/02/done-shippable-quality)

可交付的质量必须在上线运行中得到锻炼，这迫使团队真正专注于确保更仔细地考虑增量工作。

“完成”是上面所有引用的第一个同意的东西，每个团队和项目总是不同的；然而，为了满足知道某项工作已经完成，团队必须在开始时进行一项练习，以充实完成度的衡量标准并列出这些标准。

在这样做的过程中，每个人都一致同意可接受的完成点是什么——这是否包括在 Excel 中记录任务，或者编写文档（或不）成为该团队/项目的实施细节。最重要的是，每个人对 Done 的理解都是统一的。

同样，假设您通过共识达成该定义，也可以根据共识的要求对其进行更改。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-14T16:19:50.653

当所有要求都得到满足并且所有测试都通过时。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-14T16:21:21.070

它从未完成，只是版本化和发布。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-27T15:09:55.633

每个项目都有自己的完成定义，我们的代码完整（编译成功等），单元测试（或某种本地测试，如果不可能）并在我们的一个包中发布（因此其他团队可以使用） .

但国防部最重要的事情是各方都应该就它是什么（团队、产品负责人、经理等）达成一致，它应该是某种公共合同，在团队门户中发布是个好主意。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-27T15:12:33.867

任何时候任何软件都完成了 80%。至少，这是我的经验告诉我的......

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-01-14T16:20:02.353

当客户认为是。

# openssl - 使用 OpenSSL 解码/提取 smime.p7m 文件内容（带有嵌入文件的电子邮件）？

> ID：443580
> 
> 赞同：4
> 
> 时间：2009-01-14T16:14:34.360
> 
> 标签：openssl, smime

我们有一个旧进程 (VBScript)，它读取一个公共邮箱并将某些电子邮件处理到数据库中。

新法规现在对所有带有附件的邮件进行数字签名。

该过程现在只提取一个文件 (smime.p7m)。使用基于 GUI 的查看器，我可以看到嵌入的文件并毫无问题地提取它们。但是，我*真正*需要的是一个基于命令行的提取器，它将写出嵌入的文件（PDF、DOC、XLS）——它们没有加密，只是签名。我使用没有证书的笔记本电脑对此进行了测试，只需使用上述查看器打开 smime.p7m 文件。

看起来 OpenSSL 将对此进行解码/提取，并且有人设法获得了在 Windows 上编译的版本。但是，对可执行文件的大量试错测试令人沮丧，因为我找不到正确的标志组合来只说“打开 smime.p7m 文件并写出您找到的所有嵌入文件”。在所有选项之后，“openssl smime”似乎总是想要一个“cert.pem”，但我没有。

我错过了什么？提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-10-08T19:17:10.293

您是否尝试过 openssl 的“-noverify”选项？

对于仅签名的消息，您可以使用

```
openssl smime -verify -in <signed.eml> -noverify -out /tmp/blob 
```

然后，您可以使用类似 RFC822 的解析器从“blob”中获取正文和附件。这意味着您的解析器必须能够编码像quoted-printable 和base64。

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2009-01-15T15:54:22.200

看起来唯一可用的选项是使用 Chilkat 的库编写一个简单的程序。这个选项的成本是 149 美元或 289 美元，具体取决于每个开发人员的许可类型，但至少它是免版税的。

# c# - C# 中的编译器是否会删除始终为假的条件

> ID：443586
> 
> 赞同：3
> 
> 时间：2009-01-14T16:15:21.787
> 
> 标签：c#, .net, performance

假设我在 c# 中有以下代码片段

```
static const bool DO_PERFORMANCE_CODE = false;

if (DO_PERFORMANCE_CODE)
{
   // performance monitoring code goes here
} 
```

该代码会被编译器删除吗？这是我想要的功能。基本上我想模仿 C# 中的条件编译的东西，但我想要除 Release 和 Debug 之外的更多配置。如果有更好的方法可以做到这一点，我愿意听听。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-14T16:19:28.937

当您构建“调试”时，定义了预处理器变量 DEBUG。所以，你可以这样做：

```
public void MyFunc()
{
//do release stuff
#if DEBUG
//do performance testing
#endif
//finish release stuff
} 
```

当您切换到发布模式时，编译器将忽略它。

或者，如果您不想在调试模式下进行测试，您可以定义自己的预处理器变量，确保在要测试时使用“#define PERFORMANCE_TESTING”，并在不需要时将其注释掉。

```
#define PERFORMANCE_TESTING

    public void MyFunc()
    {
    //do release stuff
    #if PERFORMANCE_TESTING
    //do performance testing
    #endif
    //finish release stuff
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-14T16:32:10.270

定义自己的符号可能更简洁，但我很好奇编译器会做什么，所以我做了一些实验（在发布模式下使用 VS 2008）。

有了这个：

```
class Program
{
    static void Main(string[] args)
    {
        bool foo = false;

        if (foo)
        {
            Console.WriteLine("Hello, world?");
        }
    }
} 
```

编译器仍然为 if 语句生成代码：

```
.method private hidebysig static void  Main(string[] args) cil managed
{
  .entrypoint
  // Code size       16 (0x10)
  .maxstack  1
  .locals init ([0] bool foo)
  IL_0000:  ldc.i4.0
  IL_0001:  stloc.0
  IL_0002:  ldloc.0
  IL_0003:  brfalse.s  IL_000f
  IL_0005:  ldstr      "Hello, world\?"
  IL_000a:  call       void [mscorlib]System.Console::WriteLine(string)
  IL_000f:  ret
} // end of method Program::Main 
```

相反，如果您这样做：

```
class Program
{
    static void Main(string[] args)
    {
        bool foo = false;

        if (false)
        {
            Console.WriteLine("Hello, world?");
        }
    }
} 
```

它不会为 if 语句生成代码：

```
.method private hidebysig static void  Main(string[] args) cil managed
{
  .entrypoint
  // Code size       1 (0x1)
  .maxstack  8
  IL_0000:  ret
} // end of method Program::Main 
```

它似乎也跳过了分配了一个从未使用过的值的变量。

我检查了 ildasm.exe，Visual Studio 附带的反汇编程序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T16:51:04.193

我用 Reflector 和 Visual Studio 2008 SP1 运行了一堆测试，这就是我发现的。

1.  在错误的条件编译（#if SOMETHING_FALSE...）中，代码不仅没有被编译，而且编译器甚至不会抱怨错误
2.  在基于常量（即 if(false) { ... 或 if(constant_declared_false) { ...) 的始终为假条件的代码块中，值和引用类型的变量声明都被编译，但没有可执行代码被编译（方法调用、for循环、设置变量的值等）。
3.  如果我将局部变量设置为 false 并测试局部变量，则编译所有代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T16:21:18.310

您可以定义自己的预编译器变量。

```
 #define temp

 #if temp
 // Do something
 #endif 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-14T16:21:32.100

您可以在文件顶部定义自己的常量：

```
 #define SUPERDOOPERDEBUG

 using System;

 ....

 #if SUPERDOOPERDEBUG

     // something

 #endif 
```

此外，您可以设置不同的构建配置，而不仅仅是“发布”和“调试”（请参阅​​构建 -> 配置菜单或在项目 -> 属性菜单中定义其他条件编译符号

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-14T16:22:13.957

您可以定义除 DEBUG/RELEASE 之外的更多符号...只需查看项目属性 :-) 然后您可以使用预处理器指令语法根据项目配置选择性地包含内容

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-14T16:25:55.057

您不仅限于 DEBUG 和 RELEASE。`#define`您可以使用或在项目属性中指定其他常量。

# windows - NTLDR 技术信息

> ID：443587
> 
> 赞同：3
> 
> 时间：2009-01-14T16:15:26.107
> 
> 标签：windows, bootloader

我试图尽可能多地弄清楚它是如何`NTLDR`工作的。我最大的问题是：

1）使用什么样的可执行格式`NTLDR`？

我也对以下内容感到好奇，但是一旦我知道文件格式，我敢打赌这两个将很容易弄清楚。

2）应该在内存中的哪里`NTLDR`加载？

3) 入口点是`NTLDR`什么？

# sql-server - 计算数据库中的存储过程？

> ID：443588
> 
> 赞同：5
> 
> 时间：2009-01-14T16:15:56.417
> 
> 标签：sql-server, stored-procedures

我如何计算数据库中存储过程的数量？存储过程过多是一种不好的做法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-14T16:18:28.270

```
Select count(*) from sysobjects where xtype = 'P' 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-14T16:19:22.870

```
Select count(1) from information_schema.routines
where routine_type = 'PROCEDURE' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T16:35:24.163

您可能希望从计数中排除系统存储过程

一种方法是调用：

```
select count(*) from sysobjects 
    where xtype = 'P'
    and category = 0
    and left(name,2) <> 'sp' 
```

那是假设你没有在你的程序前面加上 sp

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T16:18:50.903

您需要尽可能多的应用程序需要。保持程序小而简单是一件好事。

如果您使用的是 sql 2005，查看 proc 计数的直观方式是在 SSMS 中导航到可编程性下的存储过程节点。单击查看-对象资源管理器详细信息，右侧将显示对象数量。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-14T16:18:53.353

以下是您可以使用的查询：

```
 select count(*) from sysobjects where xtype='P' 
```

如果您的所有数据库访问都必须通过 SP，那么天空就是极限。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-14T20:04:17.737

这将排除使用图表工具时有时会创建的那些（它们将以 dt_ 开头）

```
SELECT * FROM information_schema.routines
WHERE OBJECTPROPERTY(OBJECT_ID(SPECIFIC_NAME),'IsMSShipped') =1
AND  routine_type = 'PROCEDURE' 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-14T16:52:58.497

如果你使用它们，那么真的没有“太多”这样的东西。

我有一个开发人员担心他的存储过程在数据库中使用了太多空间，所以我必须实际计算所有存储过程的总大小。[很好的答案在这里。](https://stackoverflow.com/questions/219570/how-do-i-calculate-the-size-of-stored-procedures-in-sql-server-2005)结果是存储过程的大小加在一起可能占数据库总大小的 0.001%。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-05T14:52:59.310

这是一个您可以使用的简单查询：

```
SELECT COUNT(object_id) FROM sys.procedures 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-07-16T08:03:03.627

通过此查询，您将获得数据库中所有 procs 中实际文本的数据量。结果以字节为单位，因此计算 MB 结果 (1024*1024)。除以 1048576

```
SELECT SUM(DATALENGTH(sm.definition))/1048576 as 'Total Proc text size'
FROM sys.sql_modules sm
INNER JOIN sys.sysobjects so ON sm.object_id = so.id
WHERE so.type = 'P' 
```

# solaris - 如何更改 Solaris 上的键盘布局

> ID：443605
> 
> 赞同：2
> 
> 时间：2009-01-14T16:18:19.220
> 
> 标签：solaris, keyboard-layout

我正在运行一台装有 SunOS 且没有图形环境的机器。有人知道如何从控制台更改键盘布局吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2017-01-25T07:25:30.127

# 选择您的布局

键入以下命令以从列表中选择您的布局：

```
kbd -s 
```

如果您的语言不在列表中，请查看这篇[关于如何创建自己的布局的博客文章](http://iks.cs.ovgu.de/~elkner/keyboard/kbdhowto.html "关于如何创建自己的布局的博客文章")。如果您有非标准（例如 Apple）布局，您可能需要查看此内容。

# 重新加载您的键盘映射

使用以下命令重新加载键盘翻译表：

```
loadkeys 
```

除非您使用像 SmartOS 这样的内存操作系统，否则更改应该会在重新启动后持续存在

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T16:34:24.353

看看 loadkeys 命令

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T07:09:40.513

如果它正在运行最近的 Solaris 10 更新版本或补丁集，或者比 Solaris 10 更新的版本（例如 Solaris Express 或 OpenSolaris），请尝试*kbd -s* -- 在较旧的 Solaris x86 版本上，请尝试*kdmconfig*。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T19:22:38.730

更改 /etc/default/kbd 中的 LAYOUT 值（使用“kbd -s”获取允许值的列表）。然后运行“kbd -i”，最后重新启动。

# c# - 如何将文件 (PDF) 插入 varbinary SQL Server 列并稍后检索它？

> ID：443635
> 
> 赞同：5
> 
> 时间：2009-01-14T16:23:44.843
> 
> 标签：c#, sql-server, file, blob

我希望获取报告运行的结果（来自 Crystal Reports 的 PDF 文件），对其进行序列化，将其粘贴到 varbinary 字段中，然后稍后能够对其进行反序列化并将其呈现给用户。

现在我只需要简单的旧 ADO .NET（SqlClient、SqlCommand 等）

这有什么陷阱吗？考虑到我知道当前保存 PDF 文件的本地计算机上的路径这一事实，完成此操作的基本语法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-14T16:27:07.470

**编辑：**刚刚在[MSDN 文档](http://msdn.microsoft.com/en-us/library/ms187993.aspx)中看到**Image is going to be removed**。更好地使用 VARBINARY(MAX)。（嘿，我不知道）。

我的旧答案：*VARBINARY 的限制为 8 KB。可能太小而无法存储 PDF。您最好使用 IMAGE 数据类型。*

使用参数通过 SqlCommand 插入/选择数据，您可以像使用任何普通字段一样使用纯 SQL。

您传递到图像字段的数据是一个字节数组。

编辑 2：由于您使用的是 C#，因此您应该使用 DataReader 检索数据。[要创建 DataReader，请使用SqlCommand.ExecuteReader](http://msdn.microsoft.com/en-us/library/y6wy5a0f.aspx)上的 SequentialAccess 标志，以防止数据过早读入内存。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T07:02:11.137

我真的根本不会使用`byte[]`参数`IDbCommand`。如果您的 PDF 为 100 Mb 大怎么办？据我所知，这会在将结果发送到请求浏览器之前从您的数据库中获取所有 100 Mb（需要服务器上的内存量）。现在考虑为大约这个大小的不同 PDF 获取多个并发请求......每秒......这不是很可扩展。

有关可能的解决方案，请查看[“Blob + Stream = BlobStream”](http://www.dotnetmag.nl/IBL/GetArticle.aspx?code=761)，这是我几年前在荷兰为 .NET 杂志撰写的一篇文章。此方法使用 SQL Server 命令从派生类访问部分[BLOB 。](http://en.wikipedia.org/wiki/BLOB)`Stream`

这篇文章是荷兰语的，但附带[的示例](http://download.microsoft.com/download/1/0/e/10e9204a-88fe-4e8b-94f6-e14497dded6b/dnm12_109_Code.zip)代码应该足以让您入门。此外，Peter De Jonghe 似乎写了[一篇关于 CodeProject](http://www.codeproject.com/KB/database/LobStreamFrameworkPart1.aspx)的文章，对我的文章进行了一些扩展，将其概括为不仅仅是`image`SQL Server 中的列。这篇文章是英文的。

我希望这可以帮助您解决问题。

# .net - Vista 上的 HttpListener.Start() AccessDenied 错误

> ID：443640
> 
> 赞同：13
> 
> 时间：2009-01-14T16:25:22.560
> 
> 标签：.net, windows-vista, permissions

以普通用户身份运行此代码会引发 HttpListenerException（拒绝访问）。片段作为管理员运行正常

```
class Program
{
    static void Main(string[] args)
    {
        HttpListener listener = new HttpListener();
        listener.Prefixes.Add("http://myip:8080/app/");
        listener.Start();
        //.... and so on
     }
} 
```

我继续使用 netsh 添加了 uri（netsh http show 列出了 uri）

```
netsh http add urlacl url=http://+:8080/app user=domain\user 
```

仍然得到同样的错误。添加 ACL 确实适用于其他项目（尽管它们没有使用 HttpListener）。我尝试了多个端口/应用程序名称组合，没有任何效果。

任何想法可能是什么原因？

在 Vista 上运行 .Net 3.5 SP1

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-14T23:00:57.147

我不明白为什么，但就是这样。看来原因是我的网卡配置了2个IP。

如果在代码中我指定了其中一个 ip（就像我在上面的问题中所做的那样）

```
listener.Prefixes.Add("http://myip1:8080/app/"); 
```

然后为了避免异常我需要用IP绑定的弱通配符注册它

```
netsh http add urlacl url=http://myip1:8080/app user=domain\user 
```

但是，如果我使用强通配符（加号）添加前缀

```
listener.Prefixes.Add("http://+:8080/app/"); 
```

并使用相同的通配符注册

```
netsh http add urlacl url=http://+:8080/app user=domain\user 
```

那么没有错误，我可以从两个 ip 访问我的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T16:58:44.473

该 URI 是否已在系统上注册？

[http://msdn.microsoft.com/en-us/library/system.net.httplistenerexception.aspx](http://msdn.microsoft.com/en-us/library/system.net.httplistenerexception.aspx)说这是一个原因。

# c++ - 混合托管和非托管 C++ 的最佳单元测试工具是什么？

> ID：443642
> 
> 赞同：6
> 
> 时间：2009-01-14T16:25:34.230
> 
> 标签：c++, unmanaged, managed-c++

我将开始为混合了托管和非托管 C++ 的代码库实施一些单元测试。NUnit 可以用非托管代码破解它吗？有更好的选择吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-14T16:42:40.793

可以使用 NUnit 来测试非托管代码，例如：

```
// Tests.h

#pragma once

#include <cmath>

using namespace System;
using namespace NUnit::Framework;

namespace Tests {

    [TestFixture]
    public ref class UnitTest
    {
    public:
        UnitTest(void) {}

        [Test]
        void TestCos()
        {
            Assert::AreEqual(1, cos(0.0));
        }

    };
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T17:11:08.070

只要您在托管 C++ 中编写单元测试，NUnit 就可以很好地处理非托管代码。外部包装器将是 NUnit 友好的，并且可以访问非托管部分。

# .net - .NET 中的 PHP range() 函数？

> ID：443648
> 
> 赞同：1
> 
> 时间：2009-01-14T16:27:06.583
> 
> 标签：.net, php, range

我需要生成一个序列号列表。我知道 Ruby 你可以做 1..10 或 PHP 你可以做 range(1, 10)。.Net 中已经有类似的东西了，还是我必须编写它？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-14T16:35:10.637

在 C#（使用 .NET 3.0 或更高版本）中，这应该可以完成这项工作：

```
IEnumerable<int> myRange = Enumerable.Range(1, 10); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T16:33:32.077

这对你有用吗？

```
public List<int> Range(int start, int finish)
{
  List<int> retList = new List<int>();
  for(int i = start; i <= finish; i++)
  {
     retList.Add(i);
  }
  return retList;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T16:35:42.260

你可以使用[Enumerable.Range](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.range.aspx) ()

# python - Django 模板 ifequal 比较小数

> ID：443650
> 
> 赞同：1
> 
> 时间：2009-01-14T16:27:22.307
> 
> 标签：python, django, django-templates

所以，我有一个可以是 3 个不同值的小数域。在我看来，我传入了一个值字典，其中包含适当的十进制值作为键。

```
{% for item in booklist %}  
    {% for key, value in numvec.items %}  
        {{item.number}}  
        {% ifequals item.number {{key}} %}  
            {{value}}  
        {% endifequals %}  
    {% endfor %}
{% endfor %} 
```

这是我作为 numvec 传入的字典：

```
numvec = {"TEST":Decimal("0.999"), "TEST2":Decimal("0.500"), 
```

“TEST3”：十进制（“0.255”）}

number 字段在我的模型中被定义为具有以下选择：

```
BOOK_CHOICES=((Decimal("0.999"), 'TEST'),(Decimal("0.500"), 'TEST2'),(Decimal("0.255"), 'TEST3'),) 
```

如果我将 dict 与属性进行比较，则项目编号在视图中打印得很好，但由于某种原因，ifequals 无法正确地将两个小数比较在一起。这是一个错误，还是我在使用 ifequals 的模板中做错了什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2010-04-15T10:25:19.493

这不是一个错误，**它可以**实现你想要做的事情。

但是，首先，关于您的代码的一些评论：

*   没有“ifequals/endifequals”运算符。您可以使用["ifequal/endifequal"](http://docs.djangoproject.com/en/dev/ref/templates/builtins/#ifequal)或["if/endif"](http://docs.djangoproject.com/en/dev/ref/templates/builtins/#operator)。
*   第二件事。`{% ifequal item.number {{key}} %}`如果您在“ifequal”或“if”运算符内留下双花括号，您的代码将导致 TemplateSyntaxError 异常。

**现在解决方案**：

1.  只需简单地使用[“stringformat”](http://docs.djangoproject.com/en/dev/ref/templates/builtins/#stringformat)过滤器将您的十进制值转换为字符串。
2.  在运算符中使用变量时跳过大括号。
3.  不要忘记“if”或“ifequal”运算符中的变量始终表示为字符串。

这是一个*例子*：

```
{% for item in decimals %}  
  {% if item|stringformat:"s" == variable %}  
    {{ variable }}
  {% endif %}  
{% endfor %} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T18:30:24.383

据此[，](http://docs.djangoproject.com/en/dev/ref/templates/builtins/#ifequal)您似乎只能比较字符串。如果我是你，我会制作自己的[模板标签。](http://www.mechanicalgirl.com/view/custom-template-tags-in-django/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-07-29T08:21:57.383

解决方案：

```
{% for item in decimals %}  
  {% if item|stringformat:"s" == variable %}  
    {{ variable }}
  {% endif %}  
{% endfor %} 
```

适用于将小数（如循环）与字符串（如传递的值）进行比较

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T19:30:01.003

最简单的解决方案是在模型上定义一个封装数字逻辑并返回人性化字符串的方法。

或者您可以编写一个模板标签来执行此操作，这需要更多代码，但可能更好地保留模型/视图层分离。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T04:05:00.983

目前还不太清楚这是否会对 Ardesco 有所帮助，但是[template_utils](http://code.google.com/p/django-template-utils/)有`if_greater`, `if_greater_or_equal`, `if_less`,`if_less_or_equal`标记（以及其他）可以解决非常相关的情况，即普通`ifequals`的还不够。

安装后只需添加`template_utils`你的 django settings.py `INSTALLED_APPS`，然后放入`{% load comparison %}`你的模板

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-11-05T23:05:36.160

相反，像 1.1 和 2.2 这样的数字在二进制浮点中没有精确的表示。[>>](https://docs.python.org/2/library/decimal.html)

例如，如果你

```
print Decimal(3.59) 
```

你得到

```
3.589999999999999857891452847979962825775146484375 
```

因此，如果您在 django 模板中比较两个小数，最好使用@Oleg Sakharov 的答案，或者您可以使用相同的方法但不同的格式字符串，例如：

```
if item|stringformat:".2f" == "3.59" 
```

# goto - 为什么 goto 实践不佳？

> ID：443655
> 
> 赞同：2
> 
> 时间：2009-01-14T16:28:45.707
> 
> 标签：goto

## 这个问题是 [Goto Still Considered Harmful](https://stackoverflow.com/questions/46586/goto-still-considered-harmful)的副本。如果您想进一步讨论这个问题，请使用原始问题。

为什么 GOTO 编程习惯不好？在某些情况下使用它是有意义的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T16:32:30.737

请注意，Djkstra 写的是“GOTO 被认为是有害的”，而不是“GOTO 被认为是致命的”。它有它的位置。不幸的是，要知道何时使用它的判断来自于您在维护其他人的代码方面有一些经验，尤其是几年前不再在您公司工作的人编写的代码。因此，在您有这种经验之前，最好尽可能避免使用 goto。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-14T16:30:27.450

基本上，它鼓励糟糕的编码风格。参见：[Goto 被认为是有害的](http://www.cs.utexas.edu/users/EWD/ewd02xx/EWD215.PDF)[pdf]

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T16:31:15.247

它可以迅速导致[意大利面条代码](http://en.wikipedia.org/wiki/Spagetti_code)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T16:30:39.337

这意味着您还没有按程序设计代码。

如果你正确地构建你的whiles和ifs，你应该很少需要goto。

很少是关键词。有时它很有用。从这个意义上说，现在很多人只是显式地抛出和捕获异常，只是为了避免可怕的 goto。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-14T16:33:51.733

因为代码的结构可能难以遵循。

这个

```
y:
// do more stuff
goto x

p:
// do stuff
// then done
goto y;

x: 
  // do a bunch of stuff
  if (...)
      goto y;
  else
      goto p;

done: 
```

远不如

```
int main()
{
    x();
}

function p()
{
    if (...)
    {
         return;
    }
}

function x()
{
    if (...)
    {
         return;
    }
    else 
    {
         p();
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-14T16:32:15.887

GOTO 会使您的控制流程短路，从而破坏您的设计并为调试和维护噩梦打开大门。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-14T16:33:25.477

可读性成为一个问题，并且逻辑流可能会因使用 goto 而产生意想不到的影响。

我认为 .net 编译器将更改一些 case/switch 语句以使用 goto 很有趣。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-14T16:33:27.677

在某些情况下，这是有道理的。但是，在大多数情况下，使用它被认为是不好的做法，因为与使用诸如 for 循环和 while 循环之类的结构化代码相比，它会使代码的执行路径难以阅读。

当您查看 goto 或标签时，如果不阅读或搜索标签名称的代码，您真的不知道去往或来自哪里。这很棘手，特别是如果 goto 不适合与标签在同一屏幕上。将此与 for 循环或 while 循环或 if.. 进行比较。您可以从结构（即代码的缩进）中看出执行路径是什么。

话虽如此，它有时还是很有用的，尤其是当跳出一些嵌套的 for 循环时，这些循环正在挖掘多维数组中的特定值。当找到正确的值时，您可以在此处使用 goto 跳出 for 循环。

# c# - 基于 char 的字符串拆分 \

> ID：443662
> 
> 赞同：2
> 
> 时间：2009-01-14T16:31:37.370
> 
> 标签：c#, c#-3.0, c#-2.0

此刻脑子里有些僵硬。我有以下语法： -

```
 string[] repname = Thread.CurrentPrincipal.Identity.ToString().Split('\'); 
```

我在拆分字符上遇到错误。谁能建议我如何使用 \ 字符作为分隔符进行拆分？

干杯

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-14T16:33:21.250

采用

```
Split('\\') 
```

“\”是一个[转义字符](http://en.wikipedia.org/wiki/Escape_character)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T16:33:33.357

\ 是 C# 中的一个例外字符。

您需要执行以下操作之一：

```
Split('\\'); 
```

或者

```
Split(@'\'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T16:33:51.763

通常，该`\`字符旨在转义其他字符。如果你希望它被从*字面上*理解，你需要用另一个来逃避它`\`。因此，为了逃避反斜杠，您将提供`\\`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T16:35:08.313

Split 将 char[] 作为参数，而不是 char。尝试;

```
string[] repname = Thread.CurrentPrincipal.Identity.ToString().Split(new char[] {'\\'}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T16:35:25.317

```
 string[] repname = Thread.CurrentPrincipal.Identity.ToString().Split(new string[]{"\\"}, StringSplitOptions.None); 
```

# c# - 如何创建一个接受任何对象并为所有属性返回名称：值对的方法？

> ID：443683
> 
> 赞同：-1
> 
> 时间：2009-01-14T16:33:53.870
> 
> 标签：c#, generics, reflection

例如我有一个简单的类

```
public class Person{ 
    public int Age {get;set;}
    public string Name {get;set;}
} 
```

我需要创建一个方法，该方法采用任何类并将对象中设置的属性值吐出为格式为“Age:35;Name:John Doe;”的字符串

我正在寻找方法签名

```
public string SpitNameValuePairs<T>() 
```

或类似的东西。如果使用反射，如何有效地做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T16:45:19.883

这是一个快速实现。

```
 public static string SplitNameValuePairs(object value)
    {
        string retVal = string.Empty;
        List<string> keyValuePairs = new List<string>();

        foreach (var propInfo in value.GetType().GetProperties())
        {
            keyValuePairs.Add(string.Format("{0}:{1};", propInfo.Name, propInfo.GetValue(value, null).ToString()));
        }

        retVal = string.Join("", keyValuePairs.ToArray());

        return retVal;
    } 
```

然后像这样调用：

```
 var person = new Person();
        person.Name = "Hello";
        person.Age = 10;
        Console.WriteLine(SplitNameValuePairs(person)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T17:01:35.217

当属性定义了索引器并且它只输出实例属性（非静态）时，它可以防止崩溃。

```
 private static string SplitNameValuePairs<T>(T value)
    {
        StringBuilder sb = new StringBuilder();

        foreach (PropertyInfo property in typeof(T).GetProperties(BindingFlags.Instance | BindingFlags.Public | BindingFlags.NonPublic))
        {
            if (property.GetIndexParameters().Length == 0)
                sb.AppendFormat("{0}:{1};", property.Name, property.GetValue(value, null));
        }
        return sb.ToString();
    } 
```

# c# - 为什么 C# 不允许只读局部变量？

> ID：443687
> 
> 赞同：126
> 
> 时间：2009-01-14T16:35:02.603
> 
> 标签：c#, immutability, language-design, readonly

与同事就这件事进行了友好的辩论。我们对此有一些想法，但想知道 SO 人群对此有何看法？

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2011-04-29T10:51:26.377

我认为这是对部分 C# 架构师的错误判断。局部变量上的 readonly 修饰符有助于保持程序的正确性（就像断言一样），并且可以潜在地帮助编译器优化代码（至少在其他语言的情况下）。它现在在 C# 中被禁止的事实是另一个论点，即 C# 的某些“功能”仅仅是对其创建者的个人编码风格的强制执行。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2017-12-06T15:02:18.990

C# 7 设计团队简要讨论了[*只读局部变量和参数*](https://github.com/dotnet/roslyn/issues/115)的提案。来自[2015 年 1 月 21 日的 C# 设计会议笔记](https://github.com/dotnet/roslyn/issues/98)：

> 参数和局部变量可以被 lambdas 捕获，从而并发访问，但是没有办法保护它们免受共享互状态问题的影响：它们不能是只读的。
> 
> 通常，大多数参数和许多局部变量在获得初始值后永远不会被分配。允许只读它们会清楚地表达这种意图。
> 
> 一个问题是，此功能可能是“有吸引力的麻烦”。尽管“正确的做法”几乎总是将参数和局部变量设为只读，但这样做会使代码变得非常混乱。
> 
> 部分缓解这种情况的一个想法是允许将局部变量上的组合 readonly var 收缩为 val 或类似的东西。更一般地，我们可以尝试简单地考虑一个比已建立的 readonly 更短的关键字来表达 readonly-ness。

在 C# 语言设计存储库中继续讨论。投票表示您的支持。[https://github.com/dotnet/csharplang/issues/188](https://github.com/dotnet/csharplang/issues/188)

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2009-01-14T17:25:08.277

针对 Jared 的回答，它可能只是一个编译时特性——编译器会禁止您在初始声明后写入变量（这必须包括一个赋值）。

我能看到其中的价值吗？老实说，有可能——但不是很多。如果你不能轻易判断一个变量是否要在方法的其他地方分配，那么你的方法太长了。

对于它的价值，Java 有这个特性（使用`final`修饰符），我*很少*看到它被使用，除非它*必须*用于允许变量被匿名内部类捕获 - 以及它在*哪里*使用时，它给我的印象是混乱而不是有用的信息。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2017-08-04T23:13:53.303

这是对 c# 语言设计器的疏忽。F# 有 val 关键字，它基于 CLR。没有理由 C# 不能具有相同的语言功能。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-01-14T17:07:41.400

一个原因是只读本地没有 CLR 支持。Readonly 被翻译成 CLR/CLI initonly 操作码。此标志只能应用于字段，对本地没有意义。事实上，将其应用于本地可能会产生无法验证的代码。

这并不意味着 C# 不能做到这一点。但它会给同一个语言结构赋予两种不同的含义。本地版本将没有 CLR 等效映射。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-01-14T17:59:43.230

我是那个同事，不友好！（只是在开玩笑）

我不会消除该功能，因为最好编写简短的方法。这有点像说你不应该使用线程，因为它们很难。把刀给我，让我负责不割伤自己。

就个人而言，我想要另一个“var”类型的关键字，如“inv”（不变）或“rvar”，以避免混乱。我最近一直在研究 F#，发现不可变的东西很有吸引力。

从来不知道Java有这个。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2012-04-30T13:20:19.847

我想要本地*只读*变量，就像我喜欢本地*const*变量一样。但它的优先级低于其他主题。
也许它的**优先级**与 C# 设计者不*（还！）*实现此功能的原因相同。但是在未来的版本中支持本地只读变量应该很容易（并且向后兼容）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-14T17:01:27.683

只读意味着可以设置实例变量的唯一位置是在构造函数中。在本地声明变量时，它没有实例（它只是在范围内），并且构造函数无法触及它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-09-03T12:24:59.320

我知道，这并不能回答您的问题的原因。无论如何，那些阅读这个问题的人可能会欣赏下面的代码。

如果你真的担心在覆盖一个只应该设置一次的局部变量时，你会自责，并且你不想让它成为一个更全局可访问的变量，你可以做这样的事情。

```
 public class ReadOnly<T>
    {
        public T Value { get; private set; }

        public ReadOnly(T pValue)
        {
            Value = pValue;
        }

        public static bool operator ==(ReadOnly<T> pReadOnlyT, T pT)
        {
            if (object.ReferenceEquals(pReadOnlyT, null))
            {
                return object.ReferenceEquals(pT, null);
            }
            return (pReadOnlyT.Value.Equals(pT));
        }

        public static bool operator !=(ReadOnly<T> pReadOnlyT, T pT)
        {
            return !(pReadOnlyT == pT);
        }
    } 
```

示例用法：

```
 var rInt = new ReadOnly<int>(5);
        if (rInt == 5)
        {
            //Int is 5 indeed
        }
        var copyValueOfInt = rInt.Value;
        //rInt.Value = 6; //Doesn't compile, setter is private 
```

也许没有那么少的代码，`rvar rInt = 5`但它可以工作。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-07-12T14:46:54.890

如果您使用 C# 交互式编译器，则可以在 C# 中声明只读局部变量`csi`：

```
>"C:\Program Files (x86)\MSBuild\14.0\Bin\csi.exe"
Microsoft (R) Visual C# Interactive Compiler version 1.3.1.60616
Copyright (C) Microsoft Corporation. All rights reserved.

Type "#help" for more information.
> readonly var message = "hello";
> message = "goodbye";
(1,1): error CS0191: A readonly field cannot be assigned to (except in a constructor or a variable initializer) 
```

您还可以在`.csx`脚本格式中声明只读局部变量。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2021-09-13T20:08:01.620

能够将局部变量设为只读可以更容易理解复杂的算法，因为它减少了移动部件的数量。

由于 C# 不为本机提供非编译时常量，因此我将其与隐式强制转换一起使用：

```
public readonly struct ReadonlyVar<T>
{
    private readonly T value;

    internal ReadonlyVar(T _value) => value = _value;

    public static implicit operator T(ReadonlyVar<T> _readonly) => _readonly.value;

    public override string ToString() => "" + value;
}

public static class ReadonlyExt
{
    public static ReadonlyVar<T> Readonly<T>(this T _value) => new ReadonlyVar<T>(_value);
} 
```

用法：

```
int y = 234;
var x = ( 9000 + y ).Readonly();
y = x; 
```

它并不完美，因为可以为它分配另一个 ReadonlyVar，但这从来没有无意中发生在我身上。

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2017-10-17T21:06:30.660

使用`const`关键字使只读变量。

参考：[https ://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/const](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/const)

```
public class SealedTest
{
    static void Main()
    {
        const int c = 707;
        Console.WriteLine("My local constant = {0}", c);
    }
} 
```

* * *

## 回答 #13

> 赞同：-6
> 
> 时间：2009-01-14T16:37:44.767

我认为这是因为一个具有只读变量的函数可能永远不会被调用，而且它可能会超出范围，你什么时候需要？

# c# - 在c#中遍历对象树

> ID：443695
> 
> 赞同：24
> 
> 时间：2009-01-14T16:36:32.880
> 
> 标签：c#, algorithm, tree, tree-traversal

我有一棵由多个对象组成的树，其中每个对象都有一个名称 ( `string`)、id ( `int`)，可能还有一个相同类型的子数组。我如何遍历整个树并打印出所有的 ID 和名称？

我是编程新手，坦率地说，我很难解决这个问题，因为我不知道有多少级别。现在我正在使用`foreach`循环来获取根目录下的父对象，但这意味着我无法获取子对象。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-01-14T16:39:54.810

使用递归的算法如下：

```
printNode(Node node)
{
  printTitle(node.title)
  foreach (Node child in node.children)
  {
    printNode(child); //<-- recursive
  }
} 
```

这是一个版本，它还跟踪递归嵌套的深度（即我们是否打印根的孩子、孙子、曾孙等）：

```
printRoot(Node node)
{
  printNode(node, 0);
}

printNode(Node node, int level)
{
  printTitle(node.title)
  foreach (Node child in node.children)
  {
    printNode(child, level + 1); //<-- recursive
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T16:40:42.327

好吧，你总是可以使用递归，但在“现实世界”的编程场景中，如果你不跟踪深度，它可能会导致坏事。

这是用于二叉树的示例：http: [//www.codeproject.com/KB/recipes/BinarySearchTree.aspx](http://www.codeproject.com/KB/recipes/BinarySearchTree.aspx)

如果您对整个数据结构不熟悉，我会搜索链接列表和其他树结构。有丰富的知识需要掌握。

# linux - 你如何在 *nix 中卸载？

> ID：443699
> 
> 赞同：5
> 
> 时间：2009-01-14T16:38:09.010
> 
> 标签：linux, unix, uninstallation

我仍然无法理解的一件事是在 *nix 环境中卸载程序的经验法则。大多数时候，我很乐意让睡狗躺着，而不是卸载我不再需要的软件。但有时我会遇到几个 Apaches、svn 等。

到目前为止，这是我所知道的处理这个问题：

1) 如果您使用 apt-get 或 yum 安装，则有一个卸载命令。应用程序文件夹中很少有卸载脚本，例如uninstall.sh

2) 要确定从命令行调用哪个特定安装，请使用“type -a”命令

3）使用“sudo find / | grep”来查找其他可能安装的东西（据我所知，类型只查找PATH变量中的东西）

4）在 PATH 中添加/更改事物的顺序以使所需的应用程序版本排在第一位，或者为 .bashrc 添加别名

5）删除我不再想要的东西。如果应用程序仅安装在一个文件夹中，这很容易，但如果有多个文件夹，则很棘手。我听说过的一个技巧是运行具有时间范围的查找，以查找在安装发生时发生更改的所有文件 - 这大致显示了更改和添加的内容。

你有什么要补充/更正的吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-14T16:42:06.270

如果您没有使用包管理器（rpm、apt 等），那么您可能是从源代码安装的。要安装，您按照 ./configure && make && make install 执行了一个过程。如果应用程序表现良好，那么“安装”make 目标应该与“卸载”目标相结合。所以再次提取源，再次配置（使用相同的路径），然后卸载。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-14T16:42:51.403

通常，如果您从源代码编译某些内容，则该过程将是

```
$ make
$ su
# make install 
```

在这种情况下，绝大多数程序都会有一个卸载目标，这将使您可以逆转安装过程中发生的步骤

```
$ su
# make uninstall 
```

与往常一样，阅读程序的 README 或 INSTALL 文件以确定可用的内容。在大多数情况下，您要么通过包管理器安装某些东西（它也将处理卸载），要么您将调用某种手动过程（应该附带解释如何卸载它的自述文件）。

# html - 仅具有水平滚动的 Div

> ID：443700
> 
> 赞同：105
> 
> 时间：2009-01-14T16:38:10.490
> 
> 标签：html, css, internet-explorer

我有一个固定宽度的 DIV，其中包含一个包含许多列的表格，并且需要允许用户在 DIV 内水平滚动表格。

这需要仅在 IE6 和 IE7 上工作（内部客户端应用程序）。

以下在 IE7 中有效：

```
overflow-x: scroll; 
```

任何人都可以帮助提供适用于 IE6 的解决方案吗？

* * *

## 回答 #1

> 赞同：224
> 
> 时间：2009-01-14T16:43:21.213

解决方案相当简单。为了确保我们不会影响表格中单元格的宽度，我们将关闭*white-space*。为了确保我们得到一个水平滚动条，我们将打开*overflow-x*。差不多就是这样：

```
.container {
    width: 30em;
    overflow-x: auto;
    white-space: nowrap;
} 
```

你可以[在这里看到最终结果](http://jsfiddle.net/jonathansampson/3gamh26o/)，或者在下面的动画中。如果表格确定了容器的高度，则不需要显式设置`overflow-y`为`hidden`. 但要明白这也是一种选择。

[![在此处输入图像描述](https://i.stack.imgur.com/S38HG.gif)](https://i.stack.imgur.com/S38HG.gif)

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2013-03-03T18:46:25.637

我无法让选定的答案起作用，但经过一番[研究](http://www.htmlhelpcentral.com/messageboard/showthread.php?13621-Horizontal-scrolling-div)，我发现水平滚动 div 必须`white-space: nowrap`在 css 中。

这是完整的工作代码：

```
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Something</title>
    <style type="text/css">
        #scrolly{
            width: 1000px;
            height: 190px;
            overflow: auto;
            overflow-y: hidden;
            margin: 0 auto;
            white-space: nowrap
        }

        img{
            width: 300px;
            height: 150px;
            margin: 20px 10px;
            display: inline;
        }
    </style>
</head>
<body>
    <div id='scrolly'>
        <img src='img/car.jpg'></img>
        <img src='img/car.jpg'></img>
        <img src='img/car.jpg'></img>
        <img src='img/car.jpg'></img>
        <img src='img/car.jpg'></img>
        <img src='img/car.jpg'></img>
    </div>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-01-14T16:49:32.933

```
overflow-x: scroll;
overflow-y: hidden; 
```

编辑：

这个对我有用：

```
<div style='overflow-x:scroll;overflow-y:hidden;width:250px;height:200px'>
    <div style='width:400px;height:250px'></div>
</div> 
```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2014-07-30T09:10:29.957

对于水平滚动，请记住以下两个属性：

```
overflow-x:scroll;
white-space: nowrap; 
```

查看工作链接：[点击我](http://jsfiddle.net/v2Ypj/)

HTML

```
<p>overflow:scroll</p>
<div class="scroll">You can use the overflow property when you want to have better   control of the layout. The default value is visible.You can use the overflow property when you want     to have better control of the layout. The default value is visible.</div> 
```

CSS

```
div.scroll
{
background-color:#00FFFF;
height:40px;
overflow-x:scroll;
white-space: nowrap;
} 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2019-06-25T22:31:57.003

试试这个：

HTML：

```
<div class="container">
  <div class="item">1</div>
  <div class="item">2</div>
  <div class="item">3</div>
  <div class="item">4</div>
  <div class="item">5</div>
</div> 
```

CSS：

```
.container {
  width: 200px;
  height: 100px;
  display: flex;
  overflow-x: auto;
}

.item {
  width: 100px;
  flex-shrink: 0;
  height: 100px;
} 
```

空白：nowrap；属性不允许您换行文本。只需在此处查看示例：[https ://codepen.io/oezkany/pen/YoVgYK](https://codepen.io/oezkany/pen/YoVgYK)

# java - Java中的回调函数

> ID：443708
> 
> 赞同：196
> 
> 时间：2009-01-14T16:40:16.227
> 
> 标签：java, callback, function-pointers

有没有办法在 Java 方法中传递回调函数？

我试图模仿的行为是将.Net Delegate 传递给函数。

我见过有人建议创建一个单独的对象，但这似乎有点矫枉过正，但是我知道有时矫枉过正是做事的唯一方法。

* * *

## 回答 #1

> 赞同：171
> 
> 时间：2009-01-14T16:48:13.247

如果您的意思是 .NET 匿名委托之类的东西，我认为 Java 的匿名类也可以使用。

```
public class Main {

    public interface Visitor{
        int doJob(int a, int b);
    }

    public static void main(String[] args) {
        Visitor adder = new Visitor(){
            public int doJob(int a, int b) {
                return a + b;
            }
        };

        Visitor multiplier = new Visitor(){
            public int doJob(int a, int b) {
                return a*b;
            }
        };

        System.out.println(adder.doJob(10, 20));
        System.out.println(multiplier.doJob(10, 20));

    }
} 
```

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2014-11-06T10:02:29.613

从 Java 8 开始，就有了 lambda 和方法引用：

*   [Oracle 文档：Lambda 表达式](http://docs.oracle.com/javase/tutorial/java/javaOO/lambdaexpressions.html)
*   [Oracle 文档：方法参考](http://docs.oracle.com/javase/tutorial/java/javaOO/methodreferences.html)

例如，如果你想要一个函数式接口`A -> B`，你可以使用：

```
import java.util.function.Function;

public MyClass {
    public static String applyFunction(String name, Function<String,String> function){
        return function.apply(name);
    }
} 
```

你可以这样称呼它：

```
MyClass.applyFunction("42", str -> "the answer is: " + str);
// returns "the answer is: 42" 
```

你也可以通过类方法。例如：

```
@Value // lombok
public class PrefixAppender {
    private String prefix;

    public String addPrefix(String suffix){
        return prefix +":"+suffix;
    }
} 
```

然后你可以这样做：

```
PrefixAppender prefixAppender= new PrefixAppender("prefix");
MyClass.applyFunction("some text", prefixAppender::addPrefix);
// returns "prefix:some text" 
```

**注意**：

这里我使用了功能接口`Function<A,B>`，但是包里还有很多其他的`java.util.function`。最值得注意的是

*   `Supplier`：`void -> A`
*   `Consumer`：`A -> void`
*   `BiConsumer`：`(A,B) -> void`
*   `Function`：`A -> B`
*   `BiFunction`：`(A,B) -> C`

以及许多其他专门研究某些输入/输出类型的人。然后，如果它没有提供您需要的，您可以创建自己的`FunctionalInterface`：

```
@FunctionalInterface
interface Function3<In1, In2, In3, Out> { // (In1,In2,In3) -> Out
    public Out apply(In1 in1, In2 in2, In3 in3);
} 
```

使用示例：

```
String computeAnswer(Function3<String, Integer, Integer, String> f){
    return f.apply("6x9=", 6, 9);
}

computeAnswer((question, a, b) -> question + "42");
// "6*9=42" 
```

你也可以通过抛出异常来做到这一点：

```
@FunctionalInterface
interface FallibleFunction<In, Out, Ex extends Exception> {
    Out get(In input) throws Ex;
}
public <Ex extends IOException> String yo(FallibleFunction<Integer, String, Ex> f) throws Ex {
    return f.get(42);
} 
```

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2013-12-13T16:41:00.517

为简单起见，您可以使用**Runnable**：

```
private void runCallback(Runnable callback)
{
    // Run callback
    callback.run();
} 
```

用法：

```
runCallback(new Runnable()
{
    @Override
    public void run()
    {
        // Running callback
    }
}); 
```

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2017-12-18T22:47:56.630

但是我看到有一种最喜欢的方式就是我一直在寻找的方式。它基本上来自这些答案，但我不得不对其进行操作以使其更加冗余和高效。**我认为每个人都在寻找我想出的东西**

### 切中要害：：

先做一个*这么简单的接口*

```
public interface myCallback {
    void onSuccess();
    void onError(String err);
} 
```

现在让这个回调在你想要处理结果时运行 -***更有可能在异步调用之后并且你想要运行一些依赖于这些结果的东西***

```
// import the Interface class here

public class App {

    public static void main(String[] args) {
        // call your method
        doSomething("list your Params", new myCallback(){
            @Override
            public void onSuccess() {
                // no errors
                System.out.println("Done");
            }

            @Override
            public void onError(String err) {
                // error happen
                System.out.println(err);
            }
        });
    }

    private void doSomething(String param, // some params..
                             myCallback callback) {
        // now call onSuccess whenever you want if results are ready
        if(results_success)
            callback.onSuccess();
        else
            callback.onError(someError);
    }

} 
```

`doSomething`是需要一些时间的函数，您想向其添加回调以在结果到来时通知您，将回调接口作为参数添加到此方法

### 希望我的观点很清楚，享受；）

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2009-06-22T10:13:57.143

一点点吹毛求疵：

> 我似乎有人建议创建一个单独的对象，但这似乎有点矫枉过正

传递回调包括在几乎任何 OO 语言中创建一个单独的对象，因此它几乎不能被认为是矫枉过正。您可能的意思是，在 Java 中，它需要您创建一个单独的类，这比具有显式一等函数或闭包的语言更冗长（并且更耗费资源）。然而，匿名类至少减少了冗长并且可以内联使用。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2017-04-03T19:27:03.377

这在带有 lambda 的 Java 8 中非常容易。

```
public interface Callback {
    void callback();
}

public class Main {
    public static void main(String[] args) {
        methodThatExpectsACallback(() -> System.out.println("I am the callback."));
    }
    private static void methodThatExpectsACallback(Callback callback){
        System.out.println("I am the method.");
        callback.callback();
    }
} 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2011-07-15T04:18:47.600

我发现使用反射库实现的想法很有趣，并想出了这个我认为效果很好的方法。唯一的缺点是失去了您传递有效参数的编译时检查。

```
public class CallBack {
    private String methodName;
    private Object scope;

    public CallBack(Object scope, String methodName) {
        this.methodName = methodName;
        this.scope = scope;
    }

    public Object invoke(Object... parameters) throws InvocationTargetException, IllegalAccessException, NoSuchMethodException {
        Method method = scope.getClass().getMethod(methodName, getParameterClasses(parameters));
        return method.invoke(scope, parameters);
    }

    private Class[] getParameterClasses(Object... parameters) {
        Class[] classes = new Class[parameters.length];
        for (int i=0; i < classes.length; i++) {
            classes[i] = parameters[i].getClass();
        }
        return classes;
    }
} 
```

你像这样使用它

```
public class CallBackTest {
    @Test
    public void testCallBack() throws NoSuchMethodException, InvocationTargetException, IllegalAccessException {
        TestClass testClass = new TestClass();
        CallBack callBack = new CallBack(testClass, "hello");
        callBack.invoke();
        callBack.invoke("Fred");
    }

    public class TestClass {
        public void hello() {
            System.out.println("Hello World");
        }

        public void hello(String name) {
            System.out.println("Hello " + name);
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-01-14T16:48:53.903

方法（还）不是 Java 中的一等对象；您不能将函数指针作为回调传递。相反，创建一个包含您需要的方法的对象（通常实现一个接口）并传递它。

已经提出了 Java 中的闭包提案——这将提供您正在寻找的行为——但没有一个将包含在即将发布的 Java 7 版本中。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-01-14T16:50:49.670

当我在 Java 中需要这种功能时，我通常使用[观察者模式](http://en.wikipedia.org/wiki/Observer_pattern)。它确实暗示了一个额外的对象，但我认为这是一种干净的方式，并且是一种广泛理解的模式，有助于提高代码的可读性。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-09-12T13:32:51.957

检查闭包是如何在 lambdaj 库中实现的。它们实际上具有与 C# 委托非常相似的行为：

[http://code.google.com/p/lambdaj/wiki/Closures](http://code.google.com/p/lambdaj/wiki/Closures)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2016-07-06T18:19:27.027

您也可以`Callback`使用以下`Delegate`模式：

回调.java

```
public interface Callback {
    void onItemSelected(int position);
} 
```

PagerActivity.java

```
public class PagerActivity implements Callback {

    CustomPagerAdapter mPagerAdapter;

    public PagerActivity() {
        mPagerAdapter = new CustomPagerAdapter(this);
    }

    @Override
    public void onItemSelected(int position) {
        // Do something
        System.out.println("Item " + postion + " selected")
    }
} 
```

CustomPagerAdapter.java

```
public class CustomPagerAdapter {
    private static final int DEFAULT_POSITION = 1;
    public CustomPagerAdapter(Callback callback) {
        callback.onItemSelected(DEFAULT_POSITION);
    }
} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2011-03-25T04:41:25.530

我尝试使用 java.lang.reflect 来实现“回调”，这是一个示例：

```
package StackOverflowQ443708_JavaCallBackTest;

import java.lang.reflect.*;
import java.util.concurrent.*;

class MyTimer
{
    ExecutorService EXE =
        //Executors.newCachedThreadPool ();
        Executors.newSingleThreadExecutor ();

    public static void PrintLine ()
    {
        System.out.println ("--------------------------------------------------------------------------------");
    }

    public void SetTimer (final int timeout, final Object obj, final String methodName, final Object... args)
    {
        SetTimer (timeout, obj, false, methodName, args);
    }
    public void SetTimer (final int timeout, final Object obj, final boolean isStatic, final String methodName, final Object... args)
    {
        Class<?>[] argTypes = null;
        if (args != null)
        {
            argTypes = new Class<?> [args.length];
            for (int i=0; i<args.length; i++)
            {
                argTypes[i] = args[i].getClass ();
            }
        }

        SetTimer (timeout, obj, isStatic, methodName, argTypes, args);
    }
    public void SetTimer (final int timeout, final Object obj, final String methodName, final Class<?>[] argTypes, final Object... args)
    {
        SetTimer (timeout, obj, false, methodName, argTypes, args);
    }
    public void SetTimer (final int timeout, final Object obj, final boolean isStatic, final String methodName, final Class<?>[] argTypes, final Object... args)
    {
        EXE.execute (
            new Runnable()
            {
                public void run ()
                {
                    Class<?> c;
                    Method method;
                    try
                    {
                        if (isStatic) c = (Class<?>)obj;
                        else c = obj.getClass ();

                        System.out.println ("Wait for " + timeout + " seconds to invoke " + c.getSimpleName () + "::[" + methodName + "]");
                        TimeUnit.SECONDS.sleep (timeout);
                        System.out.println ();
                        System.out.println ("invoking " + c.getSimpleName () + "::[" + methodName + "]...");
                        PrintLine ();
                        method = c.getDeclaredMethod (methodName, argTypes);
                        method.invoke (obj, args);
                    }
                    catch (Exception e)
                    {
                        e.printStackTrace();
                    }
                    finally
                    {
                        PrintLine ();
                    }
                }
            }
        );
    }
    public void ShutdownTimer ()
    {
        EXE.shutdown ();
    }
}

public class CallBackTest
{
    public void onUserTimeout ()
    {
        System.out.println ("onUserTimeout");
    }
    public void onTestEnd ()
    {
        System.out.println ("onTestEnd");
    }
    public void NullParameterTest (String sParam, int iParam)
    {
        System.out.println ("NullParameterTest: String parameter=" + sParam + ", int parameter=" + iParam);
    }
    public static void main (String[] args)
    {
        CallBackTest test = new CallBackTest ();
        MyTimer timer = new MyTimer ();

        timer.SetTimer ((int)(Math.random ()*10), test, "onUserTimeout");
        timer.SetTimer ((int)(Math.random ()*10), test, "onTestEnd");
        timer.SetTimer ((int)(Math.random ()*10), test, "A-Method-Which-Is-Not-Exists");    // java.lang.NoSuchMethodException

        timer.SetTimer ((int)(Math.random ()*10), System.out, "println", "this is an argument of System.out.println() which is called by timer");
        timer.SetTimer ((int)(Math.random ()*10), System.class, true, "currentTimeMillis");
        timer.SetTimer ((int)(Math.random ()*10), System.class, true, "currentTimeMillis", "Should-Not-Pass-Arguments");    // java.lang.NoSuchMethodException

        timer.SetTimer ((int)(Math.random ()*10), String.class, true, "format", "%d %X", 100, 200); // java.lang.NoSuchMethodException
        timer.SetTimer ((int)(Math.random ()*10), String.class, true, "format", "%d %X", new Object[]{100, 200});

        timer.SetTimer ((int)(Math.random ()*10), test, "NullParameterTest", new Class<?>[]{String.class, int.class}, null, 888);

        timer.ShutdownTimer ();
    }
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-09-20T20:49:58.697

它有点旧，但尽管如此......我发现彼得威尔金森的答案很好，除了它不适用于像 int/Integer 这样的原始类型。问题是`.getClass()`for `parameters[i]`，它返回例如，另一方面（Java 的错误）`java.lang.Integer`不会正确解释它......`getMethod(methodName,parameters[])`

我将它与 Daniel Spiewak 的建议结合起来（[在他对此的回答中](https://stackoverflow.com/questions/180097/dynamically-find-the-class-that-represents-a-primitive-java-type)）；成功的步骤包括：捕获`NoSuchMethodException`-> `getMethods()`-> 通过 -> 查找匹配`method.getName()`项，然后显式循环遍历参数列表并应用 Daniels 解决方案，例如识别类型匹配和签名匹配。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-10-14T08:03:02.287

我最近开始做这样的事情：

```
public class Main {
    @FunctionalInterface
    public interface NotDotNetDelegate {
        int doSomething(int a, int b);
    }

    public static void main(String[] args) {
        // in java 8 (lambdas):
        System.out.println(functionThatTakesDelegate((a, b) -> {return a*b;} , 10, 20));

    }

    public static int functionThatTakesDelegate(NotDotNetDelegate del, int a, int b) {
        // ...
        return del.doSomething(a, b);
    }
} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2021-06-02T19:10:00.837

使用 java 8 这个任务有点简单，如果你想在多线程场景中使用回调，你可以做类似下面的事情：

```
public  void methodA (int n, IntConsumer consumer) {

    // create a thread
    Thread t = new Thread(() -> {
        // some time consuming operation
        int result = IntStream.range(0, n).sum();
        // after the result is ready do something with it.
        consumer.accept(result);
    });
    t.start();
} 
```

并使用此方法：

```
methodA(1000000, System.out::println); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-05-01T08:01:54.177

```
public class HelloWorldAnonymousClasses {

    //this is an interface with only one method
    interface HelloWorld {
        public void printSomething(String something);
    }

    //this is a simple function called from main()
    public void sayHello() {

    //this is an object with interface reference followed by the definition of the interface itself

        new HelloWorld() {
            public void printSomething(String something) {
                System.out.println("Hello " + something);
            }
        }.printSomething("Abhi");

     //imagine this as an object which is calling the function'printSomething()"
    }

    public static void main(String... args) {
        HelloWorldAnonymousClasses myApp =
                new HelloWorldAnonymousClasses();
        myApp.sayHello();
    }
}
//Output is "Hello Abhi" 
```

基本上如果你想创建一个接口的对象是不可能的，因为接口不能有对象。

选项是让某个类实现接口，然后使用该类的对象调用该函数。但是这种方法真的很冗长。

或者，编写 new HelloWorld() （*oberserve 这是一个接口而不是一个类），然后跟随着接口方法本身的定义。（*这个定义实际上是匿名类）。然后你得到对象引用，通过它你可以调用方法本身。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-06-10T16:14:12.927

创建一个接口，并在回调类中创建相同的接口属性。

```
interface dataFetchDelegate {
    void didFetchdata(String data);
}
//callback class
public class BackendManager{
   public dataFetchDelegate Delegate;

   public void getData() {
       //Do something, Http calls/ Any other work
       Delegate.didFetchdata("this is callbackdata");
   }

} 
```

现在在你想要回调的类中实现上面的 Created Interface。并且还传递要回调的类的“this”对象/引用。

```
public class Main implements dataFetchDelegate
{       
    public static void main( String[] args )
    {
        new Main().getDatafromBackend();
    }

    public void getDatafromBackend() {
        BackendManager inc = new BackendManager();
        //Pass this object as reference.in this Scenario this is Main Object            
        inc.Delegate = this;
        //make call
        inc.getData();
    }

    //This method is called after task/Code Completion
    public void didFetchdata(String callbackData) {
        // TODO Auto-generated method stub
        System.out.println(callbackData);
    }
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-12-01T23:13:11.910

最简单和最简单的方法是创建一个可重用的模型和触发器.... [https://onecompiler.com/java/3wejrcby2?fbclid=IwAR0dHbGDChRUJoCZ3CIDW-JQu7Dz3iYGNGYjxYVCPCWfEqQDogFGTwuOuO8](https://onecompiler.com/java/3wejrcby2?fbclid=IwAR0dHbGDChRUJoCZ3CIDW-JQu7Dz3iYGNGYjxYVCPCWfEqQDogFGTwuOuO8)

# algorithm - 在总和匹配的两组整数中查找子集的算法

> ID：443712
> 
> 赞同：11
> 
> 时间：2009-01-14T16:42:02.027
> 
> 标签：algorithm, bidirectional, subset-sum

我正在寻找一种算法，它可以采用两组整数（正数和负数）并在每个整数中找到具有相同总和的子集。

这个问题类似于[子集和问题](http://en.wikipedia.org/wiki/Subset-sum_problem)，除了我在两边都寻找子集。

这是一个例子：

列表 A {4, 5, 9, 10, 1}

列表 B {21, 7, -4, 180}

所以这里唯一的匹配是：{10, 1, 4, 9} <=> {21, 7, -4}

有谁知道是否有针对此类问题的现有算法？

到目前为止，我唯一的解决方案是一种蛮力方法，它尝试每种组合，但它在指数时间内执行，我不得不对要考虑的元素数量进行严格限制，以避免花费太长时间。

我能想到的唯一其他解决方案是在两个列表上运行阶乘并在那里寻找相等性，但这仍然不是很有效，并且随着列表变大，需要的时间呈指数增长。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-14T17:02:23.500

与子集和问题一样，这个问题是**弱**NP 完全的，因此它有一个在时间多项式 (M) 中运行的解，其中 M 是问题实例中出现的所有数字的总和。您可以通过动态编程来实现这一点。对于每个集合，您可以通过填充二维二进制表来生成所有可能的总和，其中 (k,m) 处的“真”表示可以通过从集合的前 k 个元素中选择一些元素来实现子集总和 m。

您迭代地填充它 - 如果 (k-1,m) 设置为“true”，则将 (k,m) 设置为“true”（显然，如果您可以从 k-1 个元素中获取 m，则可以从 k 中获取它通过不选择第 k 个元素）或者如果 (k-1,md) 设置为“true”，其中 d 是集合中第 k 个元素的值（在您选择第 k 个元素的情况下）。

填写表格可以获得最后一列中所有可能的总和（代表整个集合的总和）。对两组都这样做并找到共同的和。您可以通过反转用于填充表格的过程来回溯表示解决方案的实际子集。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-14T17:38:45.003

其他人说的是真的：

1.  这个问题是NP完全的。一个简单的减少是通常的子集和。您可以通过注意仅当 A 的非空子集 (-B) 的总和为零时，才可以通过注意 A 的子集与 B 的子集（不是都为空）相加来证明这一点。

2.  这个问题只是弱 NP 完全问题，因为它在所涉及的*数字*的大小上是多项式的，但被推测为*对数*是指数的。这意味着这个问题比绰号“NP-complete”可能暗示的要容易。

3.  您应该使用动态编程。

那么我对这个讨论有什么贡献呢？好吧，代码（在 Perl 中）：

```
@a = qw(4 5 9 10 1);
@b = qw(21 7 -4 180);
%a = sums( @a );
%b = sums( @b );
for $m ( keys %a ) {
    next unless exists $b{$m};
    next if $m == 0 and (@{$a{0}} == 0 or @{$b{0}} == 0);
    print "sum(@{$a{$m}}) = sum(@{$b{$m}})\n";
}

sub sums {
    my( @a ) = @_;
    my( $a, %a, %b );
    %a = ( 0 => [] );
    while( @a ) {
        %b = %a;
        $a = shift @a;
        for my $m ( keys %a ) {
            $b{$m+$a} = [@{$a{$m}},$a];
        }
    %a = %b;
    }
    return %a;
} 
```

它打印

```
sum(4 5 9 10) = sum(21 7)
sum(4 9 10 1) = sum(21 7 -4) 
```

因此，值得注意的是，有不止一种解决方案可以解决您的原始问题！

**编辑**：用户 itzy 正确地指出这个解决方案是错误的，更糟糕​​的是，在多个方面！！对此我感到非常抱歉，我希望在上面的新代码中解决了这些问题。尽管如此，仍然存在一个问题，即对于任何特定的子集和，它只打印出一种可能的解决方案。与之前的问题不同，这些问题是直接错误，我将其归类为故意限制。祝你好运并提防错误！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T15:22:17.913

非常感谢所有快速回复！

动态规划解决方案与我们现在拥有的详尽方法并没有真正的不同，我想如果我们需要最佳解决方案，我们确实需要考虑每一种可能的组合，但是生成这个详尽的总和列表所花费的时间太长了..做了一个快速测试，为 x 个元素生成所有可能的总和所需的时间很快超过 1 分钟：

```
11 elements took - 0.015625 seconds
12 elements took - 0.015625 seconds
13 elements took - 0.046875 seconds
14 elements took - 0.109375 seconds
15 elements took - 0.171875 seconds
16 elements took - 0.359375 seconds
17 elements took - 0.765625 seconds
18 elements took - 1.609375 seconds
19 elements took - 3.40625 seconds
20 elements took - 7.15625 seconds
21 elements took - 14.96875 seconds
22 elements took - 31.40625 seconds
23 elements took - 65.875 seconds
24 elements took - 135.953125 seconds
25 elements took - 282.015625 seconds
26 elements took - 586.140625 seconds
27 elements took - 1250.421875 seconds
28 elements took - 2552.53125 seconds
29 elements took - 5264.34375 seconds 
```

对于我们试图解决的业务问题，这不是真的可以接受的。我要回到绘图板上，看看我们是否确实需要知道所有的解决方案，或者我们可以只用一个（最小的/最大的子集，例如）相反，希望这可以帮助解决问题并使我的算法按预期执行。

一样的谢谢！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T16:47:59.503

子集总和是 Np 完全的，你可以多项式地将你的问题简化为它，所以你的问题也是 NP 完全的。

# xslt - 从 xsl 变量中获取 xpath

> ID：443724
> 
> 赞同：5
> 
> 时间：2009-01-14T16:44:41.353
> 
> 标签：xslt, xpath

我正在尝试使用 xsl ver 1.0 从 xsl 变量中获取一些 xpath。那是我的变量：

```
 <xsl:variable name ="myVar">
        <RefData RefTag="test1" bbb="false" />
        <RefData RefTag="test2" bbb="false" />
        <RefData RefTag="test3" bbb="false" />
        <RefData RefTag="test4" bbb="true"  />
        <RefData RefTag="test5" bbb="false" />
        <RefData RefTag="test6" bbb="false" />
  </xsl:variable> 
```

我正在尝试使用 RefTag 值获取 bbb 属性值：

```
<xsl:if test="$myVar/RefData[@RefTag = 'test3']/@bbb"> 
```

这是行不通的。

VS XSL 调试器返回错误：“要在路径表达式中使用结果树片段，首先使用 msxsl:node-set() 函数将其转换为节点集。”

我不明白如何使用 msxsl:node-set() 函数，而且无论如何我不喜欢使用 msxsl 命名空间。

有人可以在这里帮忙吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-14T20:42:39.530

**不需要 xxx:node-set() 扩展**的一种解决方案如下：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/>
 <!--                                           -->
    <xsl:variable name ="myVar">
        <RefData RefTag="test1" bbb="false" />
        <RefData RefTag="test2" bbb="false" />
        <RefData RefTag="test3" bbb="false" />
        <RefData RefTag="test4" bbb="true"  />
        <RefData RefTag="test5" bbb="false" />
        <RefData RefTag="test6" bbb="false" />
    </xsl:variable>
 <!--                                           -->
    <xsl:variable name="vrefVar" select=
     "document('')/*/xsl:variable[@name='myVar']"
     />
 <!--                                           -->
    <xsl:template match="/">
      <xsl:value-of select="$vrefVar/*[@RefTag='test3']/@bbb"/>
    </xsl:template>
</xsl:stylesheet> 
```

**当上述转换应用于任何 XML 文档（未使用）时，会产生所需的结果**：

`false`

**请注意 XSLT[`document()`](http://www.w3.org/TR/xslt#function-document)函数**的使用，以便`<xsl:variable>`简单地将所需的元素作为 xml 文档中的元素进行访问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T18:25:38.653

```
<xsl:variable name="myVariable" select="msxsl:node-set($myVar)"/> 
```

您可以通过将变量内容移动到源 xml 来避免 msxsl 命名空间。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-14T18:31:17.813

假设这个 XML：

```
<test1>
  <RefData RefTag="test1"/>
  <RefData RefTag="test2"/>
  <RefData RefTag="test3"/>
  <RefData RefTag="test4"/>
  <RefData RefTag="test5"/>
  <RefData RefTag="test6"/>
</test1> 
```

像这样的东西可以工作：

```
<xsl:template match="/">
  <xsl:apply-templates select="test1/RefData"/>
</xsl:template>

  <xsl:template match="RefData">
    <xsl:variable name="myVar">
      <xsl:choose>
        <xsl:when test="@RefTag = 'test1'">false</xsl:when>
        <xsl:when test="@RefTag = 'test2'">false</xsl:when>
        <xsl:when test="@RefTag = 'test3'">false</xsl:when>
        <xsl:when test="@RefTag = 'test4'">true</xsl:when>
        <xsl:when test="@RefTag = 'test5'">false</xsl:when>
        <xsl:when test="@RefTag = 'test6'">false</xsl:when>
        <xsl:otherwise>true</xsl:otherwise>
      </xsl:choose>
    </xsl:variable>
    <!--<text x="{$myVar}"/>-->
  </xsl:template> 
```

# java - Java toString() 使用反射？

> ID：443730
> 
> 赞同：57
> 
> 时间：2009-01-14T16:45:55.670
> 
> 标签：java, performance, reflection, tostring

前几天我正在为 Java 中的一个类编写一个 toString()，方法是将类的每个元素手动写入一个 String，我突然想到，使用反射可以创建一个可以工作的通用 toString() 方法在所有课程上。IE 它将找出字段名称和值并将它们发送到字符串。

获取字段名称相当简单，以下是同事的想法：

```
public static List initFieldArray(String className) throws ClassNotFoundException {

    Class c = Class.forName(className);
    Field field[] = c.getFields();
    List<String> classFields = new ArrayList(field.length);

    for (int i = 0; i < field.length; i++) {
        String cf = field[i].toString();
        classFields.add(cf.substring(cf.lastIndexOf(".") + 1));
    }

    return classFields;
} 
```

使用工厂，我可以通过在第一次调用 toString() 时存储一次字段来降低性能开销。然而，找到这些值可能要昂贵得多。

由于反射的性能，这可能比实际更假设。但我对反射的想法以及如何使用它来改进我的日常编程很感兴趣。

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2009-01-14T16:53:44.843

Apache commons-lang [ReflectionToStringBuilder](http://commons.apache.org/proper/commons-lang//apidocs/org/apache/commons/lang3/builder/ReflectionToStringBuilder.html)为您执行此操作。

```
import org.apache.commons.lang3.builder.ReflectionToStringBuilder

// your code goes here

public String toString() {
   return ReflectionToStringBuilder.toString(this);
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2016-01-19T17:28:19.157

如果您对 JSON 没问题，另一种选择是 Google 的 GSON 库。

```
public String toString() {
    return new GsonBuilder().setPrettyPrinting().create().toJson(this);
} 
```

它会为你做反射。这会生成一个漂亮、易于阅读的 JSON 文件。相对易于阅读，非技术人员可能会觉得 JSON 令人生畏。

如果您不想每次都更新它，您也可以将 GSONBuilder 设为成员变量。

如果您有无法打印的数据（如流）或您不想打印的数据，您可以将@Expose 标签添加到您想要打印的属性，然后使用以下行。

```
 new GsonBuilder()
.setPrettyPrinting()
.excludeFieldsWithoutExposeAnnotation()
.create()
.toJson(this); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-14T18:23:17.223

W/reflection，因为我不知道 apache 库：

（请注意，如果您这样做，您可能需要处理子对象并确保它们正确打印 - 特别是数组不会向您显示任何有用的东西）

```
@Override
public String toString()
{
    StringBuilder b = new StringBuilder("[");
    for (Field f : getClass().getFields())
    {
        if (!isStaticField(f))
        {
            try
            {
                b.append(f.getName() + "=" + f.get(this) + " ");
            } catch (IllegalAccessException e)
            {
                // pass, don't print
            }
        }
    }
    b.append(']');
    return b.toString();
}

private boolean isStaticField(Field f)
{
    return Modifier.isStatic(f.getModifiers());
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-14T17:00:42.117

如果您使用的是 Eclipse，您还可以查看[JUtils toString generator](http://eclipse-jutils.sourceforge.net/)，它是静态执行的（在源代码中生成方法）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-14T18:17:35.113

不是反射，但我查看了生成 toString 方法（以及 equals/hashCode）作为使用字节码操作的编译后步骤。[结果喜忧参半。](http://illegalargumentexception.blogspot.com/2008/12/java-automating-object-equality.html)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-09-20T22:16:46.957

您可以使用已经实现的库，例如来自 Apache commons-lang的[ReflectionToStringBuilder 。](http://commons.apache.org/proper/commons-lang//apidocs/org/apache/commons/lang3/builder/ReflectionToStringBuilder.html)如前所述。

或者自己用***反射 API***编写类似的 smt 。

这是***一些例子***：

```
class UniversalAnalyzer {

   private ArrayList<Object> visited = new ArrayList<Object>();

   /**
    * Converts an object to a string representation that lists all fields.
    * @param obj an object
    * @return a string with the object's class name and all field names and
    * values
    */
   public String toString(Object obj) {
      if (obj == null) return "null";
      if (visited.contains(obj)) return "...";
      visited.add(obj);
      Class cl = obj.getClass();
      if (cl == String.class) return (String) obj;
      if (cl.isArray()) {
         String r = cl.getComponentType() + "[]{";
         for (int i = 0; i < Array.getLength(obj); i++) {
            if (i > 0) r += ",";
            Object val = Array.get(obj, i);
            if (cl.getComponentType().isPrimitive()) r += val;
            else r += toString(val);
         }
         return r + "}";
      }

      String r = cl.getName();
      // inspect the fields of this class and all superclasses
      do {
         r += "[";
         Field[] fields = cl.getDeclaredFields();
         AccessibleObject.setAccessible(fields, true);
         // get the names and values of all fields
         for (Field f : fields) {
            if (!Modifier.isStatic(f.getModifiers())) {
               if (!r.endsWith("[")) r += ",";
               r += f.getName() + "=";
               try {
                  Class t = f.getType();
                  Object val = f.get(obj);
                  if (t.isPrimitive()) r += val;
                  else r += toString(val);
               } catch (Exception e) {
                  e.printStackTrace();
               }
            }
         }
         r += "]";
         cl = cl.getSuperclass();
      } while (cl != null);

      return r;
   }    
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-17T21:59:44.473

这是相当于 Olivier 答案的 Netbeans；[用于 Netbeans 的 smart-codegen 插件](http://code.google.com/p/smart-codegen/)。

# linux - 如何通过 SSH 在 Windows 中挂载远程 Linux 文件夹？

> ID：443732
> 
> 赞同：152
> 
> 时间：2009-01-14T16:45:58.387
> 
> 标签：linux, shell, ssh

我是一名盲人学生，目前在系统管理员/shell 编程课上。虽然 ssh 可以很好地执行 ls、pwd 等命令，但编辑器不能很好地与我的屏幕阅读器和 ssh 会话配合使用。我想知道是否可以通过 ssh 挂载 Linux 文件夹，使其显示为 Windows 驱动器？通过这种方式，我可以使用可访问的软件编辑我需要的任何文件，而不必经常使用 SCP 来回发送文件。

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2009-01-14T16:56:27.927

早在 2002 年，Novell 开发了一些名为[NetDrive](http://www.novell.com/coolsolutions/qna/999.html)的软件，可以将 WebDAV、FTP、SFTP 等共享映射到 Windows 驱动器盘符。它现在是废弃软件，因此不再维护（并且在 Novell 网站上不可用），但可以免费使用。我通过搜索“netdrive.exe”发现了很多可供下载的内容，我实际上下载了一些并比较了它们的 md5sum 以确保我得到的是一个通用的（并且希望是安全的）版本。

**2017 年 11 月 10 日更新** [SFTPNetDrive](https://www.nsoftware.com/sftp/drive/)是原始 netdrive 项目的当前项目。他们免费供个人使用：

> 我们免费提供 SFTP 网络驱动器供个人使用

他们在网站上也有付费选项。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-01-14T16:59:35.800

[Dokan](https://dokan-dev.github.io/)看起来像是 Windows 的 FUSE 和 sshfs 实现。如果它按预期工作并宣传，它将完全符合您的要求。

（链接更新和工作 2015-10-15）

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2011-03-17T13:57:50.733

我发现最好的最简单的解决方案是[https://github.com/billziss-gh/sshfs-win](https://github.com/billziss-gh/sshfs-win)，连接的服务器显示为功能齐全的网络驱动器。这不是基于“Dokany”或“dokan”的解决方案，从经验来看，它似乎更稳定、更高效，另请参阅[WinFsp 性能测试](https://github.com/billziss-gh/winfsp/wiki/WinFsp-Performance-Testing)。

[![在 windows 上挂载 ssh](https://i.stack.imgur.com/ylSEm.png)](https://i.stack.imgur.com/ylSEm.png)

*请注意之前这个答案，[https://github.com/Foreveryone-cz/win-sshfs](https://github.com/Foreveryone-cz/win-sshfs)和之前[http://www.swish-sftp.org/](http://www.swish-sftp.org/)但我不再使用它们中的任何一个，第一个停止工作第二个创建了并非所有程序都完全支持的驱动器。*

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-01-14T16:52:44.033

另一个更适合 Windows 的选项（39 美元）是[http://www.expandrive.com/sftpdrive](http://www.expandrive.com/sftpdrive)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-14T17:03:05.200

看看 CIFS ( [http://www.samba.org/cifs/](http://www.samba.org/cifs/) )。它是一个虚拟文件系统，您可以在您的 linux 机器上运行，它允许您使用 SMB 在 Windows 中的 linux 机器上挂载文件夹。

关于 Linux 的 CIFS 信息可以在这里找到：http: [//linux-cifs.samba.org/](http://linux-cifs.samba.org/)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-14T16:48:38.770

您需要在 Windows 机器上安装远程共享。这就是[Samba/smb](http://us3.samba.org/samba/)的用途。

你要做的是将你的 Linux 机器变成一个 SMB 服务器，让它以一种与 Windows 兼容的方式共享文件。

如果您不在同一个网络上，则需要通过 SSH 连接进行隧道传输，这可能不值得。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-07-26T04:14:23.587

看看多坎

[https://dokan-dev.github.io/](https://dokan-dev.github.io/)

这很不确定，但它有效，而且它是免费的

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-14T16:54:22.470

我认为您不能在只能访问 ssh 的 Windows 下将 Linux 文件夹安装为网络驱动器。我可以建议您使用[WinSCP](http://winscp.net/eng/index.php)，它允许您通过 ssh 传输文件并且它是免费的。

编辑：好吧，对不起。Vinko 在我之前发帖，现在我学到了新东西 :)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-14T17:03:17.913

显然，Novell 的免费[NetDrive](http://www.novell.com/coolsolutions/qna/999.html)软件可以访问 SFTP 文件服务器。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-10-19T07:59:48.770

下面是大卫的第二个回答：当用户登录时，我需要自动挂载网络驱动器。Dokan SSHFS 是一个不错的工具，但在这种情况下不够可靠。我发现的 Netdrive 副本不支持 SSHFS 或 sftp - 不确定是否有更新的版本支持。

我现在正在试用的解决方案包括添加一个虚拟网络适配器（禁用文件共享），使用 plink 通过新适配器打开隧道到运行 SAMBA 的远程计算机，并将网络驱动器安装到新适配器上。这里有另一个有用的教程[http://www.blissonia.com/eolson/notes/smboverssh.php](http://www.blisstonia.com/eolson/notes/smboverssh.php)。

可以使用登录脚本设置隧道和网络驱动器，因此登录后几秒钟用户可以使用映射驱动器而无需采取任何操作。

# c# - C# Mono+Winforms MessageBox 问题

> ID：443737
> 
> 赞同：5
> 
> 时间：2009-01-14T16:47:23.233
> 
> 标签：c#, .net, winforms, mono

我有一个名为**hellof.cs的文件**

```
class MyFirstApp {
static void Main() {
     System.Windows.Forms.MessageBox.Show("Hello, Mono+WinForms!");
   }
} 
```

在 Ubuntu 8.10 上，我执行以下操作

```
gmcs hellowf.cs -r:System.Drawing.dll -r:System.Windows.Forms.dll
mono hellowf.exe 
```

...它看起来像这样：

[替代文字 http://img136.imageshack.us/img136/4674/helloproblemuk5.png](http://img136.imageshack.us/img136/4674/helloproblemuk5.png)

* * *

消息的第二部分丢失了。为什么会这样？相同的二进制文件 - **hellof.exe** - 在 Windows 上运行良好。

* * *

更新：这真的很烦人。到目前为止，这是我拥有并尝试使其工作的单声道版本：

```
 1.9.1 (from official ubuntu repo)
    2.0.1 (from some some 3rd party repo)
    2.2   (wiped every mono pkg and compiled myself) 
```

我当前的单声道版本：

```
mono --version
Mono JIT compiler version 2.2 (tarball Wed Jan 14 22:58:21 CET 2009)
Copyright (C) 2002-2008 Novell, Inc and Contributors. www.mono-project.com
    TLS:           __thread
    GC:            Included Boehm (with typed GC)
    SIGSEGV:       altstack
    Notifications: epoll
    Architecture:  x86
    Disabled:      none
gmcs --version
Mono C# compiler version 2.2.0.0 
```

……有什么线索吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-14T23:11:42.523

最后我找到了解决方法。这似乎是 Mono 中与字体渲染相关的错误。当“**完整**”提示打开时会发生这种情况。我通常是这样的。将其更改为“**轻微**”或“**中等**”`System->Preferences->Appearance->Fonts->Details`可以解决问题。谢谢您的帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T19:33:37.533

在 opensuse 11.0、mono 2.0.1 上工作正常。

请编辑您的问题并输入您正在使用的单声道版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T16:50:48.967

在“你好，Mono+WinForms！”前面加上一个@。看看它是否仍然发生。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T22:55:21.230

标准调试建议：开始进行小的、受控的更改，看看会发生什么。这将有助于缩小问题的范围。

尝试删除符号：, + !
尝试删除空间。
尝试各种较短的字符串，可能还有一些较长的字符串。

一旦您对 MessageBox 将打印什么和不打印什么有了更好的了解，您就可以开始调试该特定问题，而不是尝试调试“它不起作用！”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T05:45:54.083

当你更新你的包和源代码时，你更新/编译了 libgdiplus 吗？如果 System.Drawing 和 libgdiplus 版本不同步，我们已经看到了一些时髦的图形问题。

# msmq - 尝试安装 MSMQ 时出错

> ID：443740
> 
> 赞同：0
> 
> 时间：2009-01-14T16:48:02.593
> 
> 标签：msmq

有VS-2003、VS-2005、VS-2008

尝试在添加/删除 Windows 组件中启用 MSMQ 并得到这个

'本地用户被认证为匿名用户并且不能访问活动目录。您需要以域用户身份登录才能访问 Active Directory。

我正在尝试在我的机器上进行开发并想设置一个私有 Q 以便我可以开发一个 MSMQ 应用程序。

这类似于这种情况：我在我的机器上作为管理员。我已登录 VPN 并尝试上述操作。

[链接文本](http://groups.google.com/group/microsoft.public.msmq.setup/browse_thread/thread/5819165067560863)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-14T23:29:34.297

取消选中“添加 Windows 组件”gui 中的“活动目录集成”选项。专用队列不需要它。

# git - Git的章鱼合并有逆向吗？

> ID：443745
> 
> 赞同：4
> 
> 时间：2009-01-14T16:48:52.217
> 
> 标签：git, branch

Git 有一个广受吹捧的（？）章鱼合并功能，可以将许多头合并为一个。

但是有没有相反的方法，从一个节点同时产生多个分支？

假设我有一堆代码用于一个项目，而我刚刚开始使用 Git。该项目中的某些功能已完成，其他功能仍在进行中。我想要的是让那些未完成的功能移动到它们*各自**独立*的分支中，并让 master 尽可能“完整”，没有未完成的代码。

现在，我当然可以一步完成所有这些：创建一个“未完成的功能 #1”分支，并从主服务器中删除特定于该功能的文件。然后我将主分支重新分支到“未完成的功能 #2”，并再次从主分支中删除功能 #2 特定文件，但也从第一个分支中删除。因此，我每次拆分的工作量都会增加。

在这种情况下有什么可以帮助我的吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-14T18:16:29.513

**旁注：**章鱼*合并*和*章鱼分支点*场景非常不同。请记住，提交的 DAG（有向无环图）中的指针从子（较新提交）指向父或父。所以在章鱼*合并*的情况下，你有提交（提交对象），它有两个以上的父母；在“章鱼分支点”的情况下，您只需有几个提交指向与其父级相同的提交。

章鱼合并：

```
1 <---- M
2 <----/ |
3 <------| 
```

章鱼分支点：

```
P <----- 1
^-------- 2
^-------- 3 
```

所以我认为这个问题的命名是完全错误的

* * *

## 答案

现在，如果您要做的是在不同分支之间拆分工作区域中的修改，将每个功能放在单独的主题分支中，您可以在 Git 中使用显式*暂存区域*（也称为索引）。

假设您修改了两个文件“a”和“b”，并且您希望对文件“a”的修改转到分支“A”，并将文件“b”中的修改转到分支“B”。让我们假设您当前所在的分支，您想要作为您想要创建的许多分支的基础的分支点，被命名为“master”。

首先，让我们创建分支'A'

```
$ git checkout -b A master 
```

Git 回复：

```
M       a
M       b
Switched to a new branch "A" 
```

“M”表示文件“a”和“b”相对于您基于分支“A”的点（“master”分支）进行了修改。（下面，我将简单地将 git response 放在命令行调用下面，而不是单独注明什么是回复。）

让我们将文件“a”的内容添加到暂存区（索引）。

```
$ git add a 
```

请注意，如果您只想将文件“a”中的某些更改子集添加到分支“A”，则可以使用“git add --interactive”（缩写为“-i”）或“git gui”来执行 per-对暂存区和其他此类操作进行大量更改。

现在我们将更改提交到分支“A”

```
$ git commit
Created commit 35d0061: Commit description...
 1 files changed, 1 insertions(+), 0 deletions(-) 
```

**请注意**，我们*没有*使用 '-a' 选项来 git-commit！

顺便说一句，如果您想在从暂存区提交之前测试更改，您可以使用“git stash save --keep-index”将工作区恢复到您使用“git commit”提交的状态，测试更改，然后使用“git stash pop --index”（或“git stash pop”；我不记得你在这里需要哪一个）回到以前的状态。

现在我们基于分支'master'创建另一个分支，分支'B'

```
$ git checkout -b B master
M       b
Switched to a new branch "B" 
```

您可以很容易地看到您为分支“B”留下的更改（您没有提交到分支“A”的更改）转到了新创建的分支“B”。无需删除文件或删除更改。无需知道其他分支中的内容。一切都是自动的。
再次将文件“b”的内容添加到暂存区（索引），并在分支“B”上提交：

```
$ git add B
$ git commit 
```

您可以根据需要经常重复此操作，并且新分支*不会*变得更难。

高温高压

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T18:06:36.990

由于您刚刚开始使用 Git，因此重新开始并仅将“完整”代码提交到 Master 分支会更容易。然后从 master 签出一个新的分支以获得一个特性，并在它自己的分支上提交那个“未完成”的特性代码。对每个功能分支重复。

无论如何，您必须将代码划分为功能并“完成”，因此请使用它来设置您的存储库。

# xml - 如何将 Excel OpenXML 共享字符串转换为内联字符串？

> ID：443772
> 
> 赞同：6
> 
> 时间：2009-01-14T16:55:27.540
> 
> 标签：xml, excel, openxml

我有一个 Excel 2007 OpenXML 格式的大型电子表格，我想以编程方式在 xml 中进行操作。Excel 使用共享字符串方法保存它，这种方法虽然更有效，但使过程复杂化。有谁知道 Excel 中是否有一个选项可以使用内联字符串保存，或者可能已经构建了一个实用程序来再次将所有字符串重新内联到 sheet.xml 中？没有太多运气谷歌搜索，如果可能的话，我宁愿使用现有的解决方案而不是构建自己的转换器。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-03T06:47:37.730

这样做应该很容易（只需遍历每个页面/行/共享字符串单元格，在表中查找其值，然后更改其值和类型），但您为什么要这样做（除非您正在做一些 XSLT或者其他的东西）？通过内联所有内容，您可能会增加文件大小。只需确保您修改的任何单元格都更改为内联字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-16T22:52:36.613

查看教程：[从 C# 读取和写入 Excel 2007 或 Excel 2010](http://www.sadev.co.za/content/reading-and-writing-excel-2007-or-excel-2010-c-series-index)

# python - 在 Python 中处理 __init__(self) 中的实例名称字符串

> ID：443775
> 
> 赞同：4
> 
> 时间：2009-01-14T16:55:48.990
> 
> 标签：python, instance, instantiation

我正在做这样的事情：

```
class Class(object):
    def __init__(self):
        self.var=#new instance name string# 
```

如何使我的实例的 __ init __ 方法将实例名称字符串用于“c”？以防万一说：

```
c=Class() 
```

我希望 c.var 等于'c'。

感谢您的回复，我正在实现持久性，而 Class 是持久性对象的类。我希望 __ init __ 在以下情况下向数据库添加一个条目：

```
c=Class() 
```

那么，假设：

```
del c 
```

稍后的：

```
c=Class() 
```

如果已经有条目“c”，则应使用数据库中的数据创建一个实例，否则创建新条目。

* * *

感谢您的回复，我正在实现持久性，而 Class 是持久性对象的类。我希望 __ init __ 在以下情况下向数据库添加一个条目：

```
c=Class() 
```

那么，假设：

```
del c 
```

稍后的：

```
c=Class() 
```

如果已经有条目“c”，则应使用数据库中的数据创建一个实例，否则创建新条目。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-14T17:13:51.607

Python 没有变量，它有[对象和名称](http://effbot.org/zone/python-objects.htm)。当你这样做

```
c = Class() 
```

你正在做两件事：

1.  创建类型的新对象`Class`
2.  将对象绑定到`c`当前范围内的名称。

您创建的对象没有任何“变量名”的概念 - 如果稍后您这样做

```
a = c 
```

`a`那么同一个对象可以使用名称和以完全相同的方式访问`c`。您可以删除 name `a`，并且该对象仍然存在。

如果您创建的对象需要有一个名称，最好的方法是[显式地](http://www.python.org/dev/peps/pep-0020/)将它传递给它们，

```
class Class(object):
    def __init__(self, name):
        self.name = name

var = Class('var') 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-14T17:07:24.473

你不能这样做。这样做的原因是首先创建了类的对象，然后才将该对象绑定到实例的名称。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T17:05:28.533

您不能（缺少令人难以置信的技巧，例如检查堆栈帧和检查字节码）。甚至可能没有*名字*，或者可能有多个这样的名字。例如，以下代码片段应该给出什么：

```
l = [Class(), Class()]
a=b=c=d=Class() 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-14T17:06:06.300

我认为这是不可能的，因为在对象完全构造和初始化之后发生对新实例变量的分配，因此您不知道它将在**init**方法中分配的变量名称

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-14T17:05:25.897

我不知道在不使用深度反射和调试器的情况下以编程方式访问变量名称的方法。我认为这些信息在运行时不可用。

如果你想给实例一个（唯一的？）名字，你应该让初始化器接受一个额外的参数。

```
def __init__(self, name):
    self.name = name 
```

调用者应传入适当的名称：

```
c = Class("c") 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-14T17:07:36.097

这是一个范围问题，你不能做你所要求的。因为 c 将在您的类范围之外声明，您的实例不知道它在代码中的名称。

如果您可以提供更广泛的解释来说明您正在尝试完成的工作，也许可以建议您提出更好的解决方案。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-14T20:55:08.773

要持久化数据对象，您需要使用数据库记录的唯一 ID。

**伪代码，因为我不知道您使用的是什么数据库模块**

```
import db # assume this is your db module

class Class(object):
    def __init__(self):
        self.id = None
        self.name = None

    def get_by_id(self, id):
        records = db.execute('select * from table where id=%s' % str(id))
        if records:
            self.id = records[0]['id']
            self.name = records[0]['name']

    def save(self):
        db.execute('update table set name=%s where id=%s' % (self.name, str(self.id))) 
```

同样，这是伪代码，不建议我使用我使用的字符串注入技术，因为它相当不安全，它只是为了说明如何使用带有 db 的类进行持久化。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-14T17:04:52.170

那是不可能的。您似乎混淆了变量和对象。

无论如何，很可能没有变量：

例如

```
foo(Class())

Class().arbitraryMethod() 
```

或多个：

```
a = b = Class() 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-01-29T07:25:39.447

几年前我也有同样的想法。这是某种简洁的功能，但语言创建者没有提供它。而且我认为他们都是傻瓜，没有发现这个伟大的功能。

但后来想想。我认为逻辑是不可能的。说：

```
class Class(object):
    def __init__(self):
        self.instance_name.move() # self.instance_name refer to var
    def move(self):
        print "move"

var = Class() 
```

现在如果 var 是一个数组，那也可能吗？

```
var[0] = Class() # i think it will get confused a bit 
```

这就是我的想法，我认为将实例分配给自身是不可能的。在某种语言中，我只是将实例字符串发送到对象中，然后使用 eval 执行函数

# winforms - 视觉继承是否适用于 VS2008 中的用户控件

> ID：443777
> 
> 赞同：1
> 
> 时间：2009-01-14T16:56:02.140
> 
> 标签：winforms, visual-studio-2008, inheritance, visual-inheritance

我有一个基本的用户控件。我将 Ok 和 Cancel 按钮放在控件的右下方，并将它们锚定在底部和右侧。

然后我创建另一个从基本用户控件继承的用户控件。我调整继承控件的大小（例如增加高度或宽度）。将继承的控件扔到窗体上。跑。继承的控件不支持 Ok 和 Cancel 按钮的锚属性。

以下是复制的确切步骤。

1 - 创建一个新的winforms项目

2 - 创建一个基本控件 (BaseControl1)，在底部/右侧有一个 Ok 和 Cancel 按钮。将它们固定在底部，对。编译应用程序。

3 - 创建一个继承自步骤 1 中创建的基本控件 (BaseControl1) 的新用户控件 (UserControl1)。

4 - 增加（在设计器中）UserControl1 的高度或宽度。

5 - 将 UserControl1 扔到 Form1 上。跑。您会看到 Ok 和 Cancel 按钮不在它们应该在的位置。

我做错了什么，还是 VS2008 根本不尊重基本用户控件上控件的锚属性？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T22:48:14.503

将按钮上的**Modifiers**属性更改为**Protected**。然后，在完成第 4 步后，您会注意到 UserControl1 的设计器代码现在包含一行代码来设置按钮的位置。当您的按钮被限定为**Friend**时，这并没有发生。

我一直想知道为什么从工具箱中删除的控件默认情况下没有限定为**私有**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T17:03:57.773

我认为您的问题是 Anchor 属性的默认值不会被锚定。当您更改属性并编译时，这并不意味着这是继承您的控件的类的默认设置。

如果您使用属性选择器，Visual Studio 会自动在您的应用程序中放置一些代码来更改这些值（即设计器代码）。找到 InitializeComponent() 方法，我敢打赌你会看到以下效果：

```
this.myOKButton.Anchor = AnchorStyles.Bottom | AnchorStyles.Right;
this.myCancelButton.Anchor = AnchorStyles.Bottom | AnchorStyles.Right; 
```

您需要在类中的某处设置此属性，例如构造函数，或覆盖该属性并指定您希望它锚定的方式。

# ms-access - Access 2007 中的每周周期

> ID：443785
> 
> 赞同：0
> 
> 时间：2009-01-14T16:57:48.737
> 
> 标签：ms-access, ms-access-2007

有没有办法定义我想在报告中使用的每周时间段，目前 Access 将一周定义为太阳到周六，我想使用周一到太阳。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T17:29:49.933

[Weekday 函数](http://office.microsoft.com/en-us/access/HA012289331033.aspx)有一个可选参数来定义开始日期 - 这有什么用吗？

# dll - 为什么自注册不好？

> ID：443789
> 
> 赞同：1
> 
> 时间：2009-01-14T16:58:23.617
> 
> 标签：dll, installation, registry, dllregistration

假设自注册用于安装组件作为较大安装程序的一部分，为什么自注册不好？例如自注册 vb 自定义控件或 capicom 或其他。我承认，对于您自己编写的 dll，自行注册可能并不安全，但我不是在讨论这些。

MSDN 列出了自注册不好的[几个原因，在此转载：](http://msdn.microsoft.com/en-us/library/aa371608(VS.85).aspx)

*   ~~回滚将无法正常工作。~~
    好吧，这个理由说得通。*   广告也不会起作用。
    忽略广告仅对某些类型的软件客户端很重要这一事实，我不明白为什么这是一个问题。只需要宣传主应用程序，而不是其组件。*   ~~自注册不正确支持每用户密钥。~~
    所以呢？让每个用户都可以访问“通用”组件并不是一件坏事，除非你的机器上有很多用户，在这种情况下它仍然不是世界末日。*   自注册更容易受到编码错误的影响。
    我绝对可以相信这一点，除非是 Microsoft 编写的 dll（它们可能有错误，但我不认为信任它们是不合理的）。对于由软件生成的 tlbs 和 ocxs，编码错误似乎不太可能发生。*   自注册 dll 可能会链接到其他 dll。
    对于程序生成的 dll，自我注册似乎不太可能因此而失败，但手动添加注册密钥会起作用。我宁愿让我的自我注册返回一个我缺少 dll 的错误。

    我相信这会引起火焰：/

    编辑：划掉我认为真正重要的论点（基于用户的反应和我自己的）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T17:10:39.723

至于这个项目：

> *   自注册不正确支持每用户密钥。
>     
>     
>     
>     所以呢？让每个用户都可以访问“通用”组件并不是一件坏事，除非你的机器上有很多用户，在这种情况下它仍然不是世界末日。

这不仅仅是一台机器上有多少用户的问题，还有他们拥有什么权限的问题。如果不是管理员，用户将不太可能拥有更新`HKEY_LOCAL_MACHINE`注册表部分的权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T17:35:56.833

项目

> 自注册 dll 可能会链接到其他 dll

当您尝试注册 dll 时适用，但安装程序尚未复制/安装您的注册功能所需的另一个 dll。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T17:51:18.503

我会添加一个我遇到的潜在“问题”（使用自动生成的 MS COM 对象的自注册代码）：

自注册运行可执行文件，包含所有需要/需要的内容。因此，例如，如果您的组件直接或间接记录它被激活的事实（如果组件只应该在非常特定的点或非常特定的上下文中运行，或者与其他应用程序协调，则可能用于安全日志记录），注册似乎是一种激活（除非您小心记录）。如果您的日志记录了使用组件的上下文，这也可能很有趣，在这种情况下，您将拥有触发自注册的任何继承上下文。

在大多数情况下没什么大不了的，但有时会引起一些微妙的混乱。我会将它添加到它可能不受欢迎的原因列表中。

# c# - Log4Net 在主线程中工作，但不在创建的线程中

> ID：443795
> 
> 赞同：0
> 
> 时间：2009-01-14T16:59:32.773
> 
> 标签：c#, .net, multithreading, unit-testing

在 VS2008，C# 中，我创建了一个单元测试（VS 单元测试），它调用一些代码，然后调用 Log4Net 并记录一些信息。这行得通。

如果我在单元测试中创建一个线程来调用相同的代码，我会从 Log4Net 收到**“无法解析配置文件”**异常。

有什么想法为什么它不能从创建的线程解析配置文件但可以从主线程解析？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T01:41:29.703

Log4Net 似乎使用线程本地存储。

[http://www.brianlow.com/index.php/2007/04/17/log4net-aspnet/](http://www.brianlow.com/index.php/2007/04/17/log4net-aspnet/)

# c++ - 如何知道 MFC 消息循环是否已经在运行？

> ID：443809
> 
> 赞同：0
> 
> 时间：2009-01-14T17:01:38.323
> 
> 标签：c++, c, mfc, loops, message

有什么方法可以知道 MFC 消息循环是否已经在运行？

**编辑**：上下文：库（带有事件处理）需要知道它的事件过滤是否必须附加到现有的 MFC 消息循环或创建自己的消息循环：如果主消息循环已经存在，它不能创建自己的循环，因为它会阻塞。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-28T21:03:51.957

如果不等待一些时间，就没有办法做到这一点，例如在尝试发送事件并等待它时，或者使用专门用于检测停滞应用程序的特殊 MFC 功能等待 5 秒（哪个？我不记得了它的名字...）。

如果您需要这样做，请找到另一种方法，做出其他假设。对不起。

# python - python，索引错误

> ID：443813
> 
> 赞同：1
> 
> 时间：2009-01-14T17:01:45.157
> 
> 标签：python, xml, for-loop

我有一些从 xml 文件中提取数据的代码，但它似乎随机开始抛出；

```
Traceback (most recent call last):
  File "C:\Users\mike\Documents\python\arl xml\turn 24 reader", line 52, in <module>
    unitCount   = getText(evoNode.getElementsByTagName("count")[0].childNodes)
IndexError: list index out of range 
```

当时我运行它的前几次都很好，我不知道我是否偶然更改了它，但现在它抛出了错误。

这是它尝试使用的 xml 部分的示例；

```
- <unit>
  <count>1200</count> 
  <type>Zweihander Doppelsoldners</type> 
  <typeid>102</typeid> 
  </unit> 
```

这是它抱怨的代码；

```
 for unitNode in node.getElementsByTagName('unit'):
      unitName      = getText(evoNode.getElementsByTagName("type")[0].childNodes)
      unitId     = getText(evoNode.getElementsByTagName("typeid")[0].childNodes)
      unitCount   = getText(evoNode.getElementsByTagName("count")[0].childNodes)

      unitList.append("%s x %s" % (unitName, unitCount)) 
```

虽然我接受它首先抱怨计数行，因为计数是单位部分 xml 文件中三个中最高的，但我仍然不确定它为什么抱怨，因为它成功地运行了一组非常相似的代码被克隆和编辑。

任何人都知道我可以做什么或可以提出改进问题的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T17:08:01.977

一个简单的想法：检查是否`evoNode.getElementsByTagName("count")`返回一个非空列表：

```
counts = evoNode.getElementsByTagName("count")
if counts:
    unitCount = getText(counts[0].childNodes) 
```

当然，检查应该应用于您的代码检索到的所有列表。

另一件事，您使用 进行迭代**`unitNode`**，但在循环内部，您访问**`evoNode`**，这对于每次迭代可能都是相同的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T17:14:38.170

正如 gimel 所说，如果它返回非空列表，您应该检查 getElementsByTagName("count") ，但回到您的问题：

如果您说它之前可以正常工作，那么我猜问题出在您获取 XML 的源代码上。

# asp.net-mvc - 如何在指向子文件夹的域上托管 asp.net mvc 应用程序？

> ID：443830
> 
> 赞同：2
> 
> 时间：2009-01-14T17:04:31.110
> 
> 标签：asp.net-mvc

我有以下场景：

www.somedomain.com -> 这指向共享主机上的文件夹，例如 /MyFolder1 www.otherdomain.com -> 这指向同一共享主机上的另一个文件夹，例如 /MyFolder2

使用 asp.net mvc 我的网址被映射到：

www.somedomain.com/MyFolder1/Action www.somedomain.com/MyFolder2/Action

我（显然）不想在我的网址上有“MyFolder1”和“MyFolder2”。我如何在 asp.net MVC 上解决这个问题？

我希望有：

www.somedomain.com/Action www.somedomain.com/Action

但是我需要将子文件夹保留在 IIS 上（或其他一些允许我拥有两个站点的解决方案，在同一主机上具有不同的域）。

非常感谢您的帮助。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T18:51:13.360

处理此 IMO 的最佳方法是在 IIS 级别使用重写。我刚刚在使用 IIS 7 URL Rewrite 的站点上完成了此操作。如果您的主机提供商上没有安装此模块，您可以尝试使用其他 URL 重写工具之一。但是，例如在 DiscountASP 上，您可以使用 IIS 7 URL 重写。

首先，您需要将所有域指向您当前的站点。然后当您下载该工具时：http: [//blogs.iis.net/bills/archive/2008/05/31/urlrewrite-module-for-iis7.aspx](http://blogs.iis.net/bills/archive/2008/05/31/urlrewrite-module-for-iis7.aspx)，它提供了一个用于编辑规则的 GUI。最终，这些规则被放入您的 web.config 文件中。你希望你的规则看起来像这样：

```
 <rewrite>
        <rewriteMaps>
            <rewriteMap name="otherdomain" />
        </rewriteMaps>
        <rules>
            <rule name="otherdomain" stopProcessing="false">
                <match url=".*" />
                <conditions>
                    <add input="{HTTP_HOST}" pattern="otherdomain.com" />
                </conditions>
                <action type="Rewrite" url="/site_folder/otherdomain/{R:0}" />
            </rule>
        </rules>
    </rewrite> 
```

如果您正在使用 ISAPI 重写，我可能会尽快为我正在使用的另一台不支持 IIS 重写的主机提供它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T21:52:03.510

我的托管服务提供商正在使用带有 ISAPI_Rewrite 的 IIS 6。

它工作正常， www.somedomain.com/MyFolder1/Action 变成 www.somedomain.com/Action ，因为我想在入口页面上。但是所有 Url.ActionLink() 再次映射到我不想要的 www.somedomain.com/MyFolder1/Action。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T15:54:45.570

最简单的做法是在共享主机上创建一个子域。类似于 app1.somedomain.com 和 app2.somedomain.com，子域直接映射到应用程序所在的子目录并成为根目录。

# php - 如何使用 PHP 获取网页的快照或缩略图？

> ID：443837
> 
> 赞同：4
> 
> 时间：2009-01-14T17:05:48.797
> 
> 标签：php, screenshot, webpage, thumbnails

我需要创建快照/缩略图/站点预览 a-site.com。

有一些网站可以满足我的需求。但是我不想使用外部服务，也不想依赖其他人来完成我的项目（如果他们关闭网站会发生什么？）

出于这个原因，我正在寻找一些项目来让我这样做。

任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T17:11:06.103

PHP 库中没有任何东西可以做到这一点 - 您正在考虑设置一个外部应用程序（带有队列）来获取图像，尽管您当然可以使用 PHP 将项目添加到队列中。

GD 中有几个 Windows 函数可以截取计算机的屏幕截图（网络服务器 - 不是客户端），所以也许您可以在 PHP 中编写一个脚本来执行此操作。

**编辑：**在想这些：[`imagegrabscreen`](http://www.php.net/manual/en/function.imagegrabscreen.php)和[`imagegrabwindow`](http://www.php.net/manual/en/function.imagegrabwindow.php)。我不确定他们会做你想做的事（即使在全屏模式下，Firefox 的屏幕顶部也有蓝条 - 不确定其他浏览器）。但是，如果您有兴趣，[皮埃尔对这些功能有一些了解。](http://blog.thepimp.net/archives/Screen-capture-with-PHP-and-GD.html)

我建议用另一种语言编写一个应用程序（我假设 .NET 有一些东西）来为你做这件事。 **编辑：** [此页面](https://web.archive.org/web/20141006053603/http://bobpowell.net/capture.aspx)告诉您如何在 C# 中执行此操作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T17:11:09.787

在 windows 上你可以使用 GD 的[`imagegrabwindow()`](http://www.php.net/imagegrabwindow)功能。

编辑：帮助页面实际上向您展示了如何从 IE 中获取屏幕截图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T04:23:02.643

谢谢大家。我找到了一个伪解决方案（使用 dcom + imagegrabscreen + wamp）。我需要用gd调整final.png的大小，因为png等于客户端的分辨率（在我家，是1650 * 1280的图片）。当我结束这个时，我会发布一个 .zip 文件来下载再次感谢（但如果有人有更好的想法，我很高兴看到）

PS：对不起我的英语

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T22:28:59.130

有一个 Firefox 扩展程序可以将您正在查看的网页转换为图像：

[http://www.screengrab.org/](http://www.screengrab.org/)

[http://addons.mozilla.org/en-US/firefox/addon/1146](http://addons.mozilla.org/en-US/firefox/addon/1146)

如果您愿意发挥创造力，则可能会遇到问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T17:11:13.357

在这种情况下，PHP 不会为您做太多事情。您需要一个支持 CSS 的完整 (X)HTML 渲染引擎，可能还支持 JavaScript。

那，或者使用某种可以启动真实浏览器的古怪脚本，并从中截取屏幕截图。无论哪种方式，PHP 都可能不是操作部分的正确工具。

# java - 定义记录器非静态的缺点

> ID：443846
> 
> 赞同：10
> 
> 时间：2009-01-14T17:09:14.110
> 
> 标签：java, logging

此答案的评论[如何减少 Java 日志记录样板代码？](https://stackoverflow.com/questions/212697/how-do-you-reduce-java-logging-boilerplate-code#212753)强烈建议不要将记录器用作实例成员变量。我可以想到两个负面影响：
1）超类日志与子类的记录器
2）对象不能被序列化（除非标记为瞬态）

但是，如果不需要序列化并且使用子类名称进行日志记录不是问题，那么还有什么应该避免的吗？我认为在将记录器变量定义从一个类复制到另一个类时，它减少了样板代码并避免了复制粘贴错误。甚至 Spring 框架（我相信它具有非常好的编码标准）也使用这种方法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-14T17:31:42.317

如果您的 Logger 是实例成员而不是静态成员，则每次创建新对象时都必须检索 Logger。尽管这种开销可能微不足道，但这是一个缺点。

从设计的角度来看，Loggers 并不是一个对象的真正属性，因为它们通常是关于您的系统的元信息，而不是系统本身的业务信息。A`Logger`并不是像an或 a那样的`Car`对象的一部分。将 Loggers 作为成员绑定到对象（在大多数情况下）在语义上没有任何意义。`Engine``Transmission`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-05-12T11:39:53.013

您可能想查看这些讨论该主题的页面：

*   [SLF4j 常见问题解答：类的 Logger 成员是否应该声明为静态的？](http://www.slf4j.org/faq.html#declared_static)
*   [Commons Wiki：何时可以使用对日志对象的静态引用](https://cwiki.apache.org/confluence/display/COMMONS/Logging+StaticLog)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T17:27:52.093

当然，除了带有子类名称的超类日志记录之外，主要区别在于`Logger`每个类成员都有一个对象。根据有多少类正在使用日志记录，这可能是大量的记录器，因此内存膨胀可能是一个问题。

另外，从抽象的角度来看，记录器确实属于类，并且可以在所有实例之间共享，而不是每个实例都需要自己的私有副本，因此将其声明为静态是有意义的。翻转您的问题，使其成为非静态的有什么优势？（能够传入`getClass()`调用`getLogger()`而不是传入类常量是我唯一能想到的，这是一件很小的事情）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T17:27:19.923

另一个可能是次要的缺点：浪费内存，尤其是当您有很多实例时，每个实例都有自己的记录器

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T17:22:47.437

尝试调试错误，`SuperClass`当错误确实记录在类中时，您会看到该类生成的消息`SubClass`。我见过几种情况，其中开发人员创建了一个`LoggingUtils`生成消息的类，这些消息通常会复制日志框架已经嵌入的内容。

我看到的使用共享日志实例的唯一真实情况是类似于 Apache commons HttpClient 记录器`httpclient.wire`，它在多个类之间共享，用于记录通过客户端发送的请求和响应的内容。这种特殊的日志记录情况不会记录包的实际执行信息，它会记录有关整个 http“事务”的信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-28T08:26:36.260

主要关注点之一是清理内存实例。即使您不创建类的对象，因为您使用 logger 的静态实例，也会引用这些对象。

同样正如 apache 所说，这会保留引用，因此它们在使用后不会被释放一次。

[Apache Wiki 是这样说的](https://cwiki.apache.org/confluence/display/COMMONS/Logging+StaticLog)

在某些情况下，使用静态限定符可能是有益的。然而，在其他情况下，这确实是一个非常糟糕的主意，并且可能会产生意想不到的后果。

使用静态的技术结果是显而易见的：类的所有实例只共享一个日志引用。这显然是节省内存的；无论创建多少实例，都只需要一个引用（4 或 8 个字节）。它也是 CPU 高效的；查找 Log 实例所需的查找仅在第一次引用该类时完成一次。

# .net - 在哪里可以找到一些示例 WPF 动画？

> ID：443847
> 
> 赞同：47
> 
> 时间：2009-01-14T17:09:15.313
> 
> 标签：.net, wpf, xaml, animation, sample

因为我是一名程序员，而不是艺术家或动画师，所以我未能在我的应用程序中展示 WPF 的最佳功能。虽然我有一些简单的按钮动画示例，比如增长，或者点击时颜色变亮，但我正在寻找一些展示按钮动画和一些展示面板更改动画，以展示 WPF 的最佳功能。通常我会进行更细微的更改，但在某些情况下，我需要一些东西来真正展示使用 WPF 优于 WinForms 技术的优势。

任何人都可以指出一些真正显示 WPF 并具有令人**惊叹**的因素的按钮示例和/或面板更改（在导航中从一个面板切换到下一个面板）。

**编辑**

请不要指向[http://codeproject.com](http://codeproject.com)或 microsoft 示例，因为我已经详细阅读了这些示例。事实上，这里是我的 rss 阅读器中的 WPF 站点列表（欢迎对其他博客提出建议）：

[Lester 的 WPF 博客](http://blogs.msdn.com/llobo/default.aspx)、 [Ask Dr. WPF](http://drwpf.com/blog/Home/tabid/36/BlogId/1/Default.aspx)、[Expression Blend and Design](http://blogs.msdn.com/expression/default.aspx)、[WPF Wonderland](http://wpfwonderland.wordpress.com/)、[nerdplusart](http://notstatic.com)、[Karl On WPF](http://karlshifflett.wordpress.com)、[Windows Presentation Foundation SDK](http://blogs.msdn.com/wpfsdk/default.aspx)、[Josh Smith on WPF](http://joshsmithonwpf.wordpress.com)、[Rob Relyea-Xamlified](http://blogs.windowsclient.net/rob_relyea/default.aspx)、[The Moth](http://www.danielmoth.com/Blog/index.htm)。

我要具体的例子，谢谢...

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-18T16:33:56.220

老实说，我认为最好的学习方法是使用动画工具。如果您有权访问 Expression Blend，则可以使用它来了解很多有关如何在 Xaml 中设置 WPF 动画的信息。动画有许多细微差别，比如关键帧缓动，通过在 Visual Studio 中使用 IntelliSense 很难理解和正确处理。

正如我之前提到的，很多人都可以使用 Expression Blend，但并没有意识到这一点。许多大学生和一些高中生通过[DreamSpark](https://www.dreamspark.com/default.aspx)免费获得它。拥有 MSDN 许可证的公司可以获得它。初创公司也可以通过[BizSpark](http://www.microsoft.com/BizSpark/)计划获得它。

无论如何，如果您有兴趣通过 Expression Blend 学习动画，第 9 频道的这些入门视频是一个不错的起点：

[使用 Expression Blend 制作动画：如何创建动画](http://channel9.msdn.com/posts/jennmar/Animation-Using-Expression-Blend-Part-1-How-to-create-an-animation/)

[使用 Expression Blend 的动画：如何在事件上启动动画](http://channel9.msdn.com/posts/jennmar/Animation-Using-Expression-Blend-How-to-start-animations-on-events/)

[使用 Expression Blend 的动画：如何使动画跟随路径](http://channel9.msdn.com/posts/jennmar/Animation-Using-Expression-Blend-How-to-make-an-animation-follow-a-path/)

最后，我将给您留个小预告，让动画在尚未公布的 Blend 版本中变得更加有趣。更多信息请关注三月份的[Mix 。](http://www.visitmix.com/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-08T19:48:42.250

还可以查看水波纹的动画，雨滴落入水中：

[http://stuff.seans.com/2008/08/24/raindrop-animation-in-wpf/](http://stuff.seans.com/2008/08/24/raindrop-animation-in-wpf/)

我有偏见，但我认为这是一个很好的演示，展示了在 WPF 中制作 3D 动画的强大功能。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-14T19:01:28.970

[WPF 按钮的酷控件模板](http://jobijoy.blogspot.com/2008/07/cool-control-template-for-wpf-button.html)怎么样？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-19T11:29:39.167

[PhotoSuru](http://www.photosuru.com/)是一个很酷的应用程序，具有许多动画和各种图形效果（它也使用像素着色器）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-19T14:44:19.873

你可以看看family.show [http://www.codeplex.com/familyshow](http://www.codeplex.com/familyshow)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-23T16:24:20.743

[Blu](http://2010.thirteen23.com/experiences/desktop/blu/)
有一些非常不错的动画。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-24T09:05:13.630

你可能知道，但我没有看到这里提到的 WPF 示例的[WindowsClient.net](http://windowsclient.net/downloads/folders/wpfsamples/default.aspx)列表。

[Family.show](http://www.codeplex.com/familyshow)是 WPF 团队的一个参考应用程序（w/ Vertigo）。

如果您只需要展示，您应该查看 WindowsClient.net [WPF Showcase](http://windowsclient.net/community/showcase.aspx)和 Tim Sneath 的[WPF 应用列表](http://blogs.msdn.com/tims/archive/tags/portfolio/default.aspx)。

threeteen23 的[Blu](http://2010.thirteen23.com/experiences/desktop/blu/)和[Drama](http://2010.thirteen23.com/experiences/desktop/drama/)也很适合作为展示，但没有可用的来源。不过，Drama 确实有带有列表视图的令人惊叹的动画。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-08-11T06:11:15.630

也可以在这里查看 wpf 应用程序列表 -

> 酷 WPF 应用程序：
> 
> [http://blogs.msdn.com/b/chabrook/archive/2007/02/20/cool-wpf-applications.aspx](http://blogs.msdn.com/b/chabrook/archive/2007/02/20/cool-wpf-applications.aspx)

# cocoa - 为什么我的 WebView 不显示我指定的 URL？

> ID：443854
> 
> 赞同：1
> 
> 时间：2009-01-14T17:10:52.970
> 
> 标签：cocoa, webkit

我正在使用 WebView。如果我把这个电话放在我的`-awakeFromNib`：

```
[myWebView setMainFrameURL:@"http://www.google.com"]; 
```

我得到了我想要的行为。Google 的主页显示在我的 WebView 中。但是，我需要从包含 NSStrings 的可变数组中以另一种方法设置主框架的 URL。

这个方法调用

```
[myWebView setMainFrameURL:[mutableArrayContainingNSStrings objectAtIndex:0]]; 
```

不更新 WebView。我需要告诉 WebView 重新加载吗？我试过了`-setNeedsDisplay:YES`，`-reload`但无济于事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T15:49:12.023

我解决了这个问题。WebView 是一个 IBOutlet。我正在执行在-awakeFromNib 之前给我带来问题的方法调用。将那一行移至 -awakeFromNib ，现在已排序。感谢您的输入。+1 到我的新手帖子列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T17:38:14.863

您是否尝试在您的操作方法上设置断点以检查两者`myWebView`是否`[mutableArrayContainingNSStrings objectAtIndex:0]`都指向正确的对象？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T01:50:46.007

几件事

(1) 我支持 Marc 的评论，确保它指向正确的对象

(2) 自从我直接处理 WebKit 已经有一段时间了，但我知道你可能有像 "www.google.com" 这样的字符串，而这样的字符串不起作用，你需要 " [http://www .google.com](http://www.google.com) ”，您在第一次调用 myWebView 时拥有。确保您的所有 URL 字符串都是这样的。是浏览器（Safari/Chrome/etc）将 www.google.com 扩展为[http://www.google.com](http://www.google.com)，以便您可以实际访问该站点

如果这些都不起作用，那么我可以验证并运行测试以查看 WebView 发生了什么

# cognos - Cognos 中的交叉表

> ID：443863
> 
> 赞同：1
> 
> 时间：2009-01-14T17:12:16.600
> 
> 标签：cognos, crosstab

我有一组数据需要在 Cognos 中显示为交叉表。示例数据包括

```
    ID、月、年、州
    1、10、2008、25
    2, 10, 2008, 26

```

问题是在交叉表中，每一行的月份列都是重复的，而不是对月份使用相同的列。

例子：

```
编号 2008 2008
     10 10
1 25
2 26

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-09T16:05:14.013

我不是 Cognos 人，但听起来您的详细信息没有包含在 SUM(x) 之类的聚合函数中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T14:54:38.230

除了简单的数据报告外，Cognos 还允许您输入 SQL 查询。尝试深入研究

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T17:33:22.603

您能告诉我们您按行、列和度量放置区在交叉表中添加了什么吗？您的数据源是关系数据还是多维数据集？有了更多信息，我想我们可以解决这个问题。

克里斯

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-05T10:06:15.543

通常在报告中，基本目的是根据某些标准显示聚合。但在您的示例中，提供的数据对于您在交叉表中实际想要什么没有任何意义？...如果您可以定义您想要的，那么解决方案真的很简单...

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-02-13T20:50:27.793

在处理视图后重新编写报告以防止问题再次发生。

# cocoa-touch - 将数字存储在整数字符串中并在以后的操作中调用它

> ID：443864
> 
> 赞同：0
> 
> 时间：2009-01-14T17:12:20.767
> 
> 标签：cocoa-touch

我目前正在尝试让 UISlider 工作。

我正在尝试将字符串值设置为 8 以从视图加载开始。

然后，当滑块更改值时，我希望字符串使用该数字进行更新，然后稍后我可以将字符串中的值用于 setDuration:## 稍后在另一个操作中。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T17:21:45.117

要更新字符串，您只需获取值并执行以下操作：

```
NSString *myString = [NSString stringWithFormat:@"%f", [slider value]]; 
```

要将字符串值作为浮点数返回，您只需执行以下操作：

```
float myValue = [myString floatValue]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T19:04:35.970

我最终使用了 CAFloat..

# .net - 在 WPF 中绘制像素

> ID：443867
> 
> 赞同：32
> 
> 时间：2009-01-14T17:13:06.753
> 
> 标签：.net, wpf

我将如何管理 WPF 中的逐像素渲染（例如，对于光线追踪器）？我最初的猜测是创建一个 BitmapImage，修改缓冲区，并将其显示在一个 Image 控件中，但我不知道如何创建一个（创建方法需要一块非托管内存）

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-01-14T23:12:20.150

我强烈*反对*前两个建议。假设您使用的是 3.5 SP1 [，WriteableBitmap 类提供了您需要的内容。](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.writeablebitmap(VS.85).aspx)在 SP1 之前，在 WPF 中这个问题并没有真正好的答案，除非您采取一些严重的诡计。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-11-03T03:39:13.533

如果您正在考虑做一些像光线追踪器这样的事情，您需要绘制很多点，您可能希望直接在位图的内存空间中绘制，而不是通过抽象层。此代码将为您提供明显更好的渲染时间，但其代价是需要“不安全”代码，这可能是您的选择，也可能不是。

```
 unsafe
            {
                System.Drawing.Point point = new System.Drawing.Point(320, 240);
                IntPtr hBmp;
                Bitmap bmp = new Bitmap(640, 480);
                Rectangle lockRegion = new Rectangle(0, 0, 640, 480);
                BitmapData data = bmp.LockBits(lockRegion, ImageLockMode.ReadWrite, PixelFormat.Format24bppRgb);
                byte* p;

                p = (byte*)data.Scan0 + (point.Y * data.Stride) + (point.X * 3);
                p[0] = 0; //B pixel
                p[1] = 255; //G pixel
                p[2] = 255; //R pixel

                bmp.UnlockBits(data);

                //Convert the bitmap to BitmapSource for use with WPF controls
                hBmp = bmp.GetHbitmap();
                Canvas.Source = System.Windows.Interop.Imaging.CreateBitmapSourceFromHBitmap(hbmpCanvas, IntPtr.Zero, Int32Rect.Empty, System.Windows.Media.Imaging.BitmapSizeOptions.FromEmptyOptions());
                Canvas.Source.Freeze();
                DeleteObject(hBmp); //Clean up original bitmap
            } 
```

要清理 hBitmap，您需要在类文件顶部附近声明它：

```
 [System.Runtime.InteropServices.DllImport("gdi32.dll")]
        public static extern bool DeleteObject(IntPtr hObject); 
```

另请注意，您需要设置项目属性以允许不安全的代码。您可以通过右键单击解决方案资源管理器中的项目并选择属性来执行此操作。转到构建选项卡。选中“允许不安全代码”框。另外我相信您需要添加对 System.Drawing 的引用。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-14T18:03:03.503

如果需要，您可以添加小矩形，但其中每一个都是一个 FrameworkElement，因此它可能有点重量级。另一种选择是自己创建一个 DrawingVisual，在其上绘制、渲染，然后将其粘贴到图像中：

```
private void DrawRubbish()
{
    DrawingVisual dv = new DrawingVisual();
    using (DrawingContext dc = dv.RenderOpen())
    {
        Random rand = new Random();

        for (int i = 0; i < 200; i++)
            dc.DrawRectangle(Brushes.Red, null, new Rect(rand.NextDouble() * 200, rand.NextDouble() * 200, 1, 1));

        dc.Close();
    }
    RenderTargetBitmap rtb = new RenderTargetBitmap(200, 200, 96, 96, PixelFormats.Pbgra32);
    rtb.Render(dv);
    Image img = new Image();
    img.Source = rtb;
    MainGrid.Children.Add(img);
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-14T17:24:41.443

您可以将 1X1 矩形对象放在画布上

```
 private void AddPixel(double x, double y)
  {
     Rectangle rec = new Rectangle();
     Canvas.SetTop(rec, y);
     Canvas.SetLeft(rec, x);
     rec.Width = 1;
     rec.Height = 1;
     rec.Fill = new SolidColorBrush(Colors.Red);
     myCanvas.Children.Add(rec);
  } 
```

这应该非常接近你想要的

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-12-28T12:02:15.527

这是一个使用WritableBitmap 的方法。

```
public void DrawRectangle(WriteableBitmap writeableBitmap, int left, int top, int width, int height, Color color)
{
    // Compute the pixel's color
    int colorData = color.R << 16; // R
    colorData |= color.G << 8; // G
    colorData |= color.B << 0; // B
    int bpp = writeableBitmap.Format.BitsPerPixel / 8;

    unsafe
    {
        for (int y = 0; y < height; y++)
        {
            // Get a pointer to the back buffer
            int pBackBuffer = (int)writeableBitmap.BackBuffer;

            // Find the address of the pixel to draw
            pBackBuffer += (top + y) * writeableBitmap.BackBufferStride;
            pBackBuffer += left * bpp;

            for (int x = 0; x < width; x++)
            {
                // Assign the color data to the pixel
                *((int*)pBackBuffer) = colorData;

                // Increment the address of the pixel to draw
                pBackBuffer += bpp;
            }
        }
    }

    writeableBitmap.AddDirtyRect(new Int32Rect(left, top, width, height));
} 
```

并使用它：

```
private WriteableBitmap bitmap = new WriteableBitmap(1100, 1100, 96d, 96d, PixelFormats.Bgr24, null);

private void Button_Click(object sender, RoutedEventArgs e)
{
    int size = 10;

    Random rnd = new Random(DateTime.Now.Millisecond);
    bitmap.Lock(); // Lock() and Unlock() could be moved to the DrawRectangle() method. Just do some performance tests.

    for (int y = 0; y < 99; y++)
    {
        for (int x = 0; x < 99; x++)
        {
            byte colR = (byte)rnd.Next(256);
            byte colG = (byte)rnd.Next(256);
            byte colB = (byte)rnd.Next(256);

            DrawRectangle(bitmap, (size + 1) * x, (size + 1) * y, size, size, Color.FromRgb(colR, colG, colB));
        }
    }

    bitmap.Unlock(); // Lock() and Unlock() could be moved to the DrawRectangle() method. Just do some performance tests.

  image.Source = bitmap; // This should be done only once
} 
```

# algorithm - 下载剩余时间预测器

> ID：443870
> 
> 赞同：4
> 
> 时间：2009-01-14T17:14:14.287
> 
> 标签：algorithm, progress-bar

是否有任何小部件可用于根据完成历史百分比预测下载（或任何其他过程）何时完成？

简单的版本只会根据开始时间、当前时间和完成百分比进行 2 点拟合，但可能会有更好的选择。

GUI 最宽的会很好，但只返回值的类会很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T17:42:14.683

对于我将尝试的理论算法，如果我要编写这样的小部件，将类似于：

1.  记录一秒内传输的数据量（文字[KiB](http://en.wikipedia.org/wiki/Kibibyte) / s）
2.  记住最近 5 或 10 个这样的时期（以获得最近的平均 KiB/s）
3.  从传输的大小中减去总大小（以获得“剩余字节数”）
4.  ？？？
5.  小工具！

那应该做...

（缺少的步骤是：剩余千字节除以平均 KiB/s）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T17:32:26.387

大多数进度条小部件都有一个 update() 方法，该方法需要完成百分比。
然后，他们根据自开始以来的时间和最新百分比计算剩余时间。如果您有一个设置时间较长的进程，您可能希望添加更多功能，以便它不包括此时间，可能通过在发送 0% 更新时重置预测时钟。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-16T20:32:53.257

它与其他一些提议具有相同的效果，但通过收集作为时间函数的完成百分比数据，可以使用统计方法生成 R^2 最佳拟合线并将其投影到 100% 完成。为了使其考虑到当前操作，可以对较新的数据赋予更大的权重（或者可以对旧数据进行细化）并使其忽略短期波动，可以对第一个数据点赋予更大的权重。

# sql - 为缺少索引为 SQL Server 创建索引的思考

> ID：443881
> 
> 赞同：12
> 
> 时间：2009-01-14T17:18:14.403
> 
> 标签：sql, sql-server-2008, indexing, performance

我正在调整我的 SQL Server 2008 数据库的性能，并正在使用各种 DMV 的输出来识别缺失的索引、未使用的索引等。

我主要使用这 3 个脚本（来自 SQLServerCentral.com），它们依赖于 SQL Server 提供的 DMV 数据：

[终极缺失索引查找器](http://www.sqlservercentral.com/scripts/Index+Management/63937/ "终极缺失索引查找器")

[终极重复索引查找器](http://www.sqlservercentral.com/scripts/Index+Management/63935/)

[终极索引使用报告器](http://www.sqlservercentral.com/scripts/Index+Management/63934/)

在尝试创建新索引时，我知道我需要很聪明，并尝试将许多建议分组到尽可能少的索引中，方法是正确创建它们，以便它们可以做得很好，为几个不同的查询提供服务。当唯一的区别可能是包含的列等时，为每个查询创建一个单独的索引。

所以我想了解社区的想法，看看人们是否可以回答一些关于阅读 DMV 结果和构建新索引的问题。

**索引中包含的列的顺序是否重要？**

**采取以下两个索引建议。你会怎么做才能使 1 适合两者？**

```
object_name equality_columns                    inequality_columns              included_columns
    Appointment [FranchiseId], [AppointmentTypeId]  [CustomerId], [ApptDateTime]    NULL
    Appointment [FranchiseId], [AppointmentTypeId]  [ApptDateTime]                  [CustomerId] 
```

**如果我有很多索引建议具有相同的等式和不等式字段但包含的字段不同，那么是包含更多字段还是包含更少的字段更好？同样，目标是创建 1 个索引与 3 个（如果 3 个具有不同的包含列）。**

最后，如果有任何好的资源可以为此类事情提供良好的经验法则或一般指导方针，如果可以提供这些链接，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T18:13:09.833

**索引列的顺序很重要，但不包括列。** 这是因为只有键列用于查找。

您必须“阅读”大多数文档的字里行间，但这就是他们在[这篇 BOL 文章中所暗示的内容](http://msdn.microsoft.com/en-us/library/ms190806.aspx)

[这个讨论](http://www.eggheadcafe.com/software/aspnet/31808193/sql-2005-index-included-c.aspx)更明确地说顺序不重要。

索引中包含的列几乎*​​唯一需要*考虑的是空间——如果包含大量列或非常大的列，索引可能会变得非常大。但这意味着您*绝对*不想做两个*单独*的索引，每个索引都有相同的键列但包含的键列不同。那么你只是在加剧你的空间问题。

# php - {$_GET['id']} 和 '".$_GET['id']."' 之间的区别？

> ID：443883
> 
> 赞同：0
> 
> 时间：2009-01-14T17:19:57.333
> 
> 标签：php, string, concatenation, string-concatenation

写作有什么区别吗

```
{$_GET['id']}

```

和

'".$_GET['id']."'

在sql语句中？两者的工作原理相同

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T17:43:54.633

将 get 请求中的数据直接放入 SQL 总是一个坏主意，并且有许多简单的方法可以防止 SQL 注入。

对于您知道需要数字 ID 的简单情况，您可以简单地将值强制为数字，这样就没有 SQL 注入的机会。一种方法可能是 okoman 的用法`sprintf()`，可能是这样的：

```
$sql = "INSERT INTO table VALUES(".sprintf("%d",$_GET['id']) .")"; 
```

虽然我认为它的丑陋和糟糕的形式。像这样的东西更好：

```
$sql = "INSERT INTO table VALUES(".(int)$_GET['id']) .")"; 
```

它只是将值转换为 int - 如果它不是可以转换为 int 的数字 - 你会得到一个“0”，它可能是也可能不是你想要的。

其他替代方法（以及当您的数据不应该是数字时）包括使用转义函数，例如`add_slashes()`或上面提到的`mysql_real_escape_string()`.

恕我直言，在 PHP 中使用数据库访问并很容易防止 SQL 注入的最佳方法是使用新的 PHP PDO 库（[http://php.net/PDO](http://php.net/PDO)）。这允许您编写不包含任何数据的 SQL 字符串，并将数据稍后添加到数据库服务器本身中。在这种形式下，绝对没有办法进行 SQL 注入。

这是一些示例代码：

```
$dbh = new PDO('mysql:host=localhost;dbname=test', $user, $pass);
$stmt = $dbh->prepare("INSERT INTO table VALUES (?)");
$stmt->bindParam(1, $_GET['id']);
$stml->execute(); 
```

如您所见，数据并未添加到 SQL 查询本身，因此无需转义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T17:26:23.000

在 SQL 语句中直接使用其中任何一个都是一个非常糟糕的想法。它允许 SQL 注入。请务必使用类似`mysql_real_escape_string`.

两者的主要区别在于 top 只能在使用双引号的字符串内部使用。然而，底部可以与双引号或单引号一起使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T17:26:42.267

据我所知没有区别，但你应该这样做吗？您允许未经处理的输入到您的 sql 查询中，这意味着如果您的网站面向 Internet，您将使其对 sql 注入攻击敞开大门。

这是您在继续之前应该阅读的问答：

[如何防止 PHP 中的 SQL 注入？](https://stackoverflow.com/questions/60174/best-way-to-stop-sql-injection-in-php)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-14T17:25:11.910

如果你在字符串中使用变量——尤其是关联数组——你可以确定它会导致错误。这只是糟糕的风格。我 - 就个人而言 - 也不喜欢第二种选择。

```
sprintf( '... %d ...', $_GET[ 'id' ] ); 
```

这是我最喜欢将变量放入字符串的方式。

# python - Python：回调、委托、...？什么是常见的？

> ID：443885
> 
> 赞同：25
> 
> 时间：2009-01-14T17:20:28.863
> 
> 标签：python, events, delegates, callback

只是想知道在 python 中对事件做出反应的常用方法是什么。在其他语言中有几种方法，如回调函数、委托、侦听器结构等。有没有通用的方法？有哪些默认语言概念或附加模块，您可以推荐哪些？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-14T18:07:35.427

就我个人而言，我认为回调、侦听器和委托之间没有区别。

[观察者模式](http://en.wikipedia.org/wiki/Observer_pattern)（又名侦听器，又名“多个回调”）很容易实现 - 只需保存一个观察者列表，并从中添加或删除可调用对象。这些可调用对象可以是函数、绑定方法或带有`__call__`魔法方法的类。您所要做的就是定义您期望从这些接口中获得的接口——例如，它们是否接收任何参数。

```
class Foo(object):
  def __init__(self):
    self._bar_observers = []

  def add_bar_observer(self, observer):
    self._bar_observers.append(observer)

  def notify_bar(self, param):
    for observer in self._bar_observers:
      observer(param)

def observer(param):
  print "observer(%s)" % param

class Baz(object):
  def observer(self, param):
    print "Baz.observer(%s)" % param

class CallableClass(object):
  def __call__(self, param):
    print "CallableClass.__call__(%s)" % param

baz = Baz()

foo = Foo()

foo.add_bar_observer(observer) # function
foo.add_bar_observer(baz.observer) # bound method
foo.add_bar_observer(CallableClass()) # callable instance

foo.notify_bar(3) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T18:20:02.110

这完全取决于您的应用程序所需的复杂程度。对于简单的事件，回调可能会做。对于更复杂的模式和解耦级别，您应该使用某种发布-订阅实现，例如[PyDispatcher](http://pydispatcher.sourceforge.net/)或 wxPython 的 pubsub。

另请参阅[此讨论](https://stackoverflow.com/questions/115844/recommended-python-publish-subscribe-dispatch-module)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T17:43:22.577

我不能说常见的方法，但是[这个页面](http://www.suttoncourtenay.org.uk/duncan/accu/pythonpatterns.html "Python 中的模式")（实际副本不可用）有一个我喜欢的观察者模式的实现。

这是互联网档案链接： [http ://web.archive.org/web/20060612061259/http://www.suttoncourtenay.org.uk/duncan/accu/pythonpatterns.html](http://web.archive.org/web/20060612061259/http://www.suttoncourtenay.org.uk/duncan/accu/pythonpatterns.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T18:33:55.033

我使用的大多数 Python 库都为它们的事件通知实现了回调模型，我认为它非常适合这种语言。 [Pygtk通过从](http://www.pygtk.org/)[GObject](http://www.pygtk.org/docs/pygobject/class-gobject.html)派生所有对象来做到这一点，它实现了基于回调的信号处理。（尽管这是底层 C GTK 实现的一个特性，而不是受该语言启发的东西。）但是，[Pygtkmvc](http://sourceforge.net/projects/pygtkmvc/)在 Pygtk之上实现了一个观察者模式（和 MVC），这是一项有趣的工作。它使用了一个非常华丽的基于元类的实现，但我发现它在大多数情况下工作得相当好。如果您有兴趣了解完成此操作的一种方式，那么该代码也相当简单易懂。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T17:50:22.607

我已经看到使用的侦听器和回调。但是AFAIK没有Python方式。如果所讨论的应用程序合适，它们应该同样可行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-15T06:39:56.267

该`matplotlib.cbook`模块包含一个`CallbackRegistry`您可能想要查看的类。从[文档](http://matplotlib.sourceforge.net/api/cbook_api.html)中：

```
处理一组信号的注册和断开连接
回调：

   信号='吃'，'喝'，'快乐'

   定义一个（x）：
       打印'吃'，x

   def ondrink(x):
       打印“喝”，x

   回调 = CallbackRegistry（信号）

   ideat = callbacks.connect('eat', oneat)
   iddrink = callbacks.connect('drink', ondrink)

   #tmp = callbacks.connect('drunk', ondrink) # 这将引发 ValueError

   callbacks.process('drink', 123) # 将调用 oneat
   callbacks.process('eat', 456) # 会调用 ondrink
   callbacks.process('be merry', 456) # 什么都不会被调用
   callbacks.disconnect(ideat) # 断开连接
   callbacks.process('eat', 456) # 什么都不会被调用

```

您可能不希望依赖于 matplotlib 包。[我建议您简单地将类从源代码](http://matplotlib.svn.sourceforge.net/viewvc/matplotlib/trunk/matplotlib/lib/matplotlib/cbook.py?view=markup)复制粘贴到您自己的模块中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-14T17:34:58.740

就个人而言，我只见过使用回调。但是，我还没有看到那么多事件驱动的 python 代码，所以 YMMV。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-12T04:13:31.083

我正在寻找一种在 Python 中注册和处理事件的实现。我唯一的经验是使用[Gobject](http://www.pygtk.org/docs/pygobject/class-gobject.html)，但只使用过 PyGtk。它很灵活，但对于某些用户来说可能过于复杂。我也遇到过其他一些有趣的候选人，但不清楚他们之间的比较。

*   [Pyevent](http://code.google.com/p/pyevent/)，一个围绕[libevent](http://code.google.com/p/pyevent/)的包装器。
*   [佐佩事件](http://code.google.com/p/pyevent/)

# wcf - 使用 WCF 进行授权和身份验证

> ID：443886
> 
> 赞同：0
> 
> 时间：2009-01-14T17:21:04.023
> 
> 标签：wcf, authentication, authorization

处理安全性的最佳实践是什么，即 Web 应用程序中的授权和身份验证？

我正在开发一个 Web 应用程序，使用 WCF 作为 SOA，将来我的应用程序中的单个组件更有可能与某些第三方应用程序集成。我正在寻找一种解决方案，通过它我可以使用我的应用程序的内部方法为我的应用程序处理授权和身份验证，并且我可以使用某些第三方应用程序提供的接口进行授权和身份验证。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T23:38:20.837

请参阅[什么是好的 WCF/Web 服务安全阅读？](https://stackoverflow.com/questions/683865/what-is-some-good-wcf-web-services-security-reading)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T17:37:53.803

我们目前正在研究 Microsoft Geneva 框架来解决这个问题（加上我们的其他 SSO 要求）。看起来很不错。

[http://msdn.microsoft.com/en-us/security/aa570351.aspx](http://msdn.microsoft.com/en-us/security/aa570351.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T15:13:29.760

您应该查看 XACML 的授权方面。它与技术无关，并且扩展性非常好。

# php - 使用 Zend 框架调用多个存储过程

> ID：443895
> 
> 赞同：0
> 
> 时间：2009-01-14T17:23:55.907
> 
> 标签：php, mysql, zend-framework, stored-procedures

我正在使用 Zend Framework 1.7.2、MySQL 和 MySQLi PDO 适配器。我想在给定操作期间调用多个存储过程。我发现在 Windows 上调用多个存储过程存在问题。如果您尝试它，您会收到以下错误消息：

> SQLSTATE[HY000]：一般错误：2014 在其他无缓冲查询处于活动状态时无法执行查询。考虑使用 PDOStatement::fetchAll()。或者，如果您的代码只针对 mysql 运行，您可以通过设置 PDO::MYSQL_ATTR_USE_BUFFERED_QUERY 属性来启用查询缓冲。

我发现要解决这个问题，我可以在每次调用存储过程后关闭与数据库的连接：

```
if (strtoupper(substr(PHP_OS, 0, 3)) === 'WIN') {
  //If on windows close the connection
  $db->closeConnection();
} 
```

这对我来说效果很好，但是，现在我想调用包装在事务中的多个存储过程。当然，在这种情况下关闭连接不是一种选择，因为它会导致打开的事务回滚。任何想法，如何解决这个问题和/或解决这个问题。

*   [有关解决方法的更多信息](http://www.zfforums.com/zend-framework-components-13/databases-20/how-stored-procedure-using-mysqli-pdo-successfully-662.html)
*   [关于问题的错误报告](http://framework.zend.com/issues/browse/ZF-2101)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T11:17:12.060

调用这样的查询时我有同样的错误（在下一个查询中使用的变量）

```
$db->query("SET @curr = 0.0;"); 
```

为了解决这个问题，我将配置文件更改为

```
'database' => array(
        'adapter' => 'mysqli', 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-29T22:08:40.397

这种准备、执行然后关闭每个调用存储过程的 $sql 语句的模式确实有效。

```
public function processTeams($leagueid,$raceid,$gender)
{
    $db = Zend_Db_Table::getDefaultAdapter();
    $sql = $db->prepare(sprintf("CALL addScoringTeams(%d,%d,'%s')",$leagueid,$raceid,$gender));
    $sql->execute();
    $sql->closeCursor();
    $this->logger->info(sprintf("CALL addScoringTeams(%d,%d,'%s')",$leagueid,$raceid,$gender));

    $sql1 = $db->prepare(sprintf("CALL updateScoringTeamTotals(%d)",$raceid));
    $sql1->execute();
    $sql1->closeCursor();
    $this->logger->info(sprintf("CALL updateScoringTeamTotals(%d)",$raceid));

    $sql2 = $db->prepare(sprintf("CALL updateScoringTeamClasses(%d,'%s')",$raceid,$gender));
    $sql2->execute();
    $sql2->closeCursor();
    $this->logger->info(sprintf("CALL updateScoringTeamClasses(%d,'%s')",$raceid,$gender));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-02-14T13:00:18.720

您可以使用准备语句。无需更换驱动程序

```
$sql = "CALL procedure()";
$stmt = $this->db->createStatement();
$stmt->prepare($sql);
$result = $stmt->execute(); 
```

# git - 从 GitHub 中删除代码

> ID：443896
> 
> 赞同：30
> 
> 时间：2009-01-14T17:23:58.480
> 
> 标签：git, github

有没有办法从 GitHub 中完全删除目录及其历史记录？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-01-14T17:28:50.653

如果您要从 GitHub 中删除项目，请打开您的项目，单击“管理”选项卡（或直接浏览到[https://github.com/username/project_name/edit](https://github.com/username/project_name/edit)），然后在页面底部单击“删除此存储库”。它会要求您确认这一点，然后它就消失了。

如果您只想擦除存储库的一部分，则需要将其执行到您的 git 存储库并将其推送到 GitHub。

GitHub 在他们的常见问题解答中写[了一个关于这个](http://github.com/guides/completely-remove-a-file-from-all-revisions)的方法。我自己没有尝试过，所以我无法进一步指导你，但你可能可以在这里自己管理。

在任何一种情况下，这自然不会删除任何第三方拉取——如果有人在你删除它之前拉取了存储库，它就会消失，而你对此无能为力（除了尝试“非常请”——技术）。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-07-02T16:44:31.873

要有选择地删除文件或目录（及其所有相关历史记录），您可以使用`git filter-branch`.

当您想要完全删除错误签入存储库的文件时，这非常有用。

语法很简单：

```
git filter-branch --tree-filter 'rm -f filename' HEAD 
```

[有关手册页](https://git-scm.com/docs/git-filter-branch)的更多信息。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-14T17:28:30.157

转到编辑选项卡；页面底部有一个删除链接。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-12-24T03:40:03.747

这是从 GitHub 存储库中删除目录但不是本地系统的最简单方法：

```
git rm -r --cached FolderName
git commit -m "Removed folder from repository"
git push origin master 
```

# php - 锁定 MySQL 数据库以便一次只有一个人可以运行查询？

> ID：443909
> 
> 赞同：5
> 
> 时间：2009-01-14T17:27:53.107
> 
> 标签：php, mysql, concurrency

当人们尝试访问 MySQL 数据库并尝试使用相同信息更新表时，我遇到了一些问题。

我有一个使用 PHP 编写的网页。在此网页中是一个查询，用于检查某些数据是否已输入到数据库中。如果数据没有，那么我继续插入它。麻烦的是，如果两个人同时尝试，检查可能会说数据还没有输入，但是当插入发生时，它是由另一个人输入的。

处理这种情况的最佳方法是什么？我可以锁定数据库只处理我的查询然后其他人吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-14T17:36:42.213

阅读[数据库事务](http://en.wikipedia.org/wiki/Database_transaction)。与运行 LOCK TABLES 相比，这可能是处理所需内容的更好方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-14T21:46:08.297

手动锁定表是你能做的最糟糕的事情。如果解锁它们的代码从未运行（因为 PHP 失败，或者用户下一步单击下一步，离开 PC 等），会发生什么情况。

在 Web 应用程序中最小化这种情况的一种方法，也是开发人员经常犯的错误，是让数据网格充满要编辑的数据文本框，每行或整个表格都有一个保存按钮。显然，如果这个人在周五打开这个并在周一回来，数据可能是错误的，他们可能正在保存新数据。解决此问题的一种简单方法是在每一行上都有 EDIT 按钮，然后单击该按钮然后加载一个编辑表单，这样他们就有希望加载新数据并且一次只能提交 1 行更改。

但更重要的是，您应该包含一个日期时间字段作为隐藏的输入框，当他们尝试提交数据时，请查看日期并确定数据的年龄，并确定太旧的时间并警告或拒绝用户关于他们的行为。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T17:30:27.093

你正在寻找`LOCK`.

[http://dev.mysql.com/doc/refman/5.0/en/lock-tables.html](http://dev.mysql.com/doc/refman/5.0/en/lock-tables.html)

这可以作为一个简单的`mysql_query`（或`MySQLi::query/prepare`）运行。

我会说最好锁定需要锁定的特定表（尽管您可能会尝试`LOCK TABLES *`）而不是整个数据库 - 因为将无法读取任何内容。我认为您正在寻找类似的东西：

```
LOCK TABLES items;
START TRANSACTION;
INSERT INTO items (name, label) VALUES ('foo', 'bar');
UNLOCK TABLES; 
```

或者在 PHP 中：

```
mysql_query('LOCK TABLES items');
mysql_query("INSERT INTO items (name, label) VALUES ('foo', 'bar')");
mysql_query('UNLOCK TABLES'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T17:34:43.217

您可以在编辑某些内容之前检查数据是否已更改。在这种情况下，如果有人在其他人进行编辑时编辑了数据，他将被告知。

有点像 stackoverflow 处理评论。

# model-view-controller - 我应该在哪里保存复杂的 MVC 应用程序 UI 状态？

> ID：443910
> 
> 赞同：2
> 
> 时间：2009-01-14T17:28:20.063
> 
> 标签：model-view-controller, design-patterns, user-interface, frameworks

我一直在看几个 MVC 框架（如 rails、merb、cakephp、codeignitier 和类似的......）

我见过的所有示例基本上都是简单明了的 CRUD 页面，包含查询字符串和发布的字段值中所需的所有 infr。

我有几个应用程序是用一些用经典 asp 构建的框架制作的。

这个框架处理一些比我发现的例子更复杂的 CRUD 东西。

像主细节，按示例过滤，分页，排序和类似的东西。

我有一个控制器类，它只是一个有限状态机，通过不同的状态（如新建、浏览、过滤、显示等），然后根据引发的事件执行适当的操作，最后将需要的信息检索到调用页面。

为了实现这一点，我有几个隐藏的输入来保持网页的状态（比如当前 id、过滤条件、订单条件、以前的状态、以前的事件，嗯，你明白了）

您认为实现这种功能的最佳方法是什么？

隐藏在视图中并从控制器中使用的输入？？？（我想这相当于我现在在 classi asp 中所做的）

--

（为回应 tvanfosson 而添加）

基本上，我的问题是指第三类，与上下文相关的设置（关于我同意你的其他两个类别）我存储在隐藏字段中以将它们存储在查询字符串中的信息，我猜当你点击“下一页”包含您需要保存在查询字符串中的所有内容，对吗？这样查询字符串就会附加到执行某种操作的每个链接中...

我不确定，使用查询字符串而不是隐藏输入有什么优点和缺点？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T17:45:36.813

我根据实际数据的特征使用不同的策略。作为首选项的东西，例如默认页面大小，我保存在与当前登录用户关联的首选项对象（表）中，并在需要时从那里检索。

与当前登录相关的持久设置，如页面的过滤器设置，存储在用户的会话中。通常，如果用户在当前会话中设置它们，它们应该保持粘性。我认为过滤器设置和可见性是这样的。如果我过滤一个列表，从它导航到一个特定的项目，然后回到列表，我希望我的过滤器设置被重新应用——所以我把它作为会话的一部分。

与上下文相关的设置——比如当前的排序列或页码，是使用查询参数控制的。分页和排序控件（链接）使用适当的查询参数构建，以便在单击时“做正确的事”，并传递任何必要的查询参数来维护或更新控件的当前上下文。使用查询参数允许您使用 HTTP GET，它是可收藏的，而不是 POST。使用隐藏的表单参数使用户更难保存或输入将他们直接带到他们想去的地方的 URL。这可能对排序比对分页更有用，但原则同样适用。

# database - 我应该编写哪些数据库测试，以便轻松重构数据库

> ID：443912
> 
> 赞同：3
> 
> 时间：2009-01-14T17:28:33.027
> 
> 标签：database, refactoring, agile

是否有关于编写数据库测试的指南，以便您可以在进行进化数据库设计时“无所畏惧”地重构数据库？

在开发数据库时应该对数据库的哪些方面进行测试？任何例子都会很棒..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T17:42:58.550

我编写调用我的 dal 代码的测试，并在检查插入/更新/删除是否实际发生后，即所谓的状态测试。这些是公关定义而不是单元测试，而是集成测试，但它们实际上帮助我多次进行数据库更改。随着时间的推移，我进行了更多更好的测试，甚至更大的数据库更改也进行得相当无缝。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T17:31:37.450

根据 TDD，进行测试的概念是您测试事物*现在*的工作方式。当您需要更改某些内容时，您可以更改解决该问题的测试（确保当前代码库失败），然后更改代码直到测试通过。没有改变的测试让你相信你的软件的其他方面仍然像以前那样做，并且你的重构没有破坏任何东西。

因此，您不会在编写测试时考虑到重构；相反，您测试您的需求，然后当您的需求发生变化时，您相应地更新测试，并重构*代码*以使其通过新的*测试*。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T17:33:51.097

总是害怕您对数据库所做的每一次更改。这将迫使您仔细检查您更改的每一件事并缩小可能的错误。

请记住，数据库通常是一个或多个应用程序的主干，因此您所做的每一项更改都必须经过仔细计划和适当的测试。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-14T18:22:34.273

在编写存储过程时，我会随意添加 Debug / Print 语句。使用 @Debug 作为 bit 类型的输入参数：

```
IF @Debug = 1 PRINT @MyDynamicVariable 
```

# xslt - XSL/XPath 缩进

> ID：443914
> 
> 赞同：7
> 
> 时间：2009-01-14T17:29:11.917
> 
> 标签：xslt, xpath

您使用哪些约定（如果有）来缩进 XSL 代码？

*   你如何处理非常长、复杂的 XPath
*   您可以将它们插入您选择的 XML 编辑器吗？
*   是否有一些可以很好地完成这项工作的开源代码？

对于某些背景，我在 Emacs 中使用 nxml-mode。大多数情况下都可以，您可以配置子元素应该缩进的空格数。但对于复杂的 XPath，它并不是很好。如果我的代码中有很长的 XPath，我希望通过使其看起来像这样来使其结构尽可能透明......

```
<xsl:for-each select="/some
                       /very[@test = 'whatever']
                        /long[@another-test = perhaps
                                               /another
                                                /long
                                                 /xpath[@goes='here']]
                         /xpath" 
```

但是，我目前必须手动执行此操作，因为 nxml 只会将其与“/some..”对齐。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T19:16:38.467

在我看来，长 xpath 很难阅读，应该避免。有两种方法可以做到：

1.  简化源 xml。
2.  将大模板拆分为较小的模板。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T19:29:04.710

如果我在阅读 xpath 语句时遇到困难（这种情况并不经常发生，但偶尔会发生），我倾向于以不同的方式分解 XSL……它实际上与我分解其他语言语法的方法非常相似…… .所以你在问题中的例子可能更像这样：

```
<xsl:for-each select="/some/very[@test = 'whatever']/long">
  <xsl:if test="@another-test = perhaps/another/long/xpath[@goes='here']">
    <xsl:for-each select="xpath">
      ... result xml ....
    </xsl:for-each>
  </xsl:if>
</xsl:for-each> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T18:20:55.377

不要使用长 xpath。放弃 for-each 并使用匹配模板。将 xpath 分解为几个模板。阅读一堆琐碎的匹配模板比其中一个要容易得多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T18:33:59.190

有时无法避免更长的 xpath，即使您使用模板而不是 for-eaches（如果可以的话，应该这样做）。在 XSLT/XPath 2.0 中尤其如此：

```
<xsl:attribute name="tablevel" 
     select="if (following::*[self::topic | self::part]) 
             then (following::*[self::topic | self::part])[1]/@tablevel
             else @tablevel"/> 
```

我倾向于不打破跨行的“简单”路径，但会打破运算符或条件的“更大”路径。

对于编辑，我使用 Oxygen（它是跨平台的），它可以很好地处理这种间距。有时它并不能准确地预测你想要什么，但是一旦它存在，它就会保持空间，即使你重新缩进你的代码。

# javascript - 为什么 Django 管理员“今天”和“现在”按钮不显示在 Safari 中？

> ID：443920
> 
> 赞同：3
> 
> 时间：2009-01-14T17:30:34.503
> 
> 标签：javascript, python, django, safari, webkit

我正在开发一个 Django 应用程序，其中包含一个带有日期/时间字段的模型。在我的应用程序的本地副本上，该特定模型的管理页面显示日期/时间字段：

[替代文字 http://www.cs.wm.edu/~mpd/images/bugs/django-date-local.png](http://www.cs.wm.edu/~mpd/images/bugs/django-date-local.png)

这正如预期的那样。但是，当我部署到我的网络服务器并从那里使用应用程序时，我得到了这个：

[替代文字 http://www.cs.wm.edu/~mpd/images/bugs/django-date-server.png](http://www.cs.wm.edu/~mpd/images/bugs/django-date-server.png)

服务器上的应用程序与我的本地副本*完全相同，**只是*我在服务器上禁用了调试（但我认为这不重要……应该吗？）。为什么服务器上的管理应用程序与本地管理应用程序不同？

* * *

## 更新

*   该问题似乎已本地化到 Safari。当通过 Firefox 访问管理站点时，会出现“今天”和“现在”按钮。看起来 Safari 无法下载显示这些小部件所需的一些 JavaScript 文件（但奇怪的是 Firefox 可以）。
*   我注意到 Safari 收到以下文件的“304 Not Modified”代码，但我不确定这意味着什么，或者如何修复它。显然，这些是控制日期/时间小部件的 JavaScript 文件和图像：
    *   `RelatedObjectLookup.js`
    *   `DateTimeShortcuts.js`
    *   `icon_calendar.gif`
    *   `icon_clock.gif`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T22:25:08.960

我认为你必须看看你的 firefox 配置和 safary 配置有什么不同

在我的头顶上：

*   一个可以配置为使用代理（干扰交通），另一个不。确保两者的配置相同。

*   Safari 可能已经缓存了错误，在再次测试之前清除缓存。

*   尝试直接从浏览器访问 gif 文件（通过输入图像的完整 url）并在比较 GET 请求和响应的线路上运行 wireshark。有些东西会有所不同，可以帮助您跟踪问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T20:19:08.173

如果你在这些文件上得到 304。刷新浏览器的缓存，然后重试。

如果无论如何它都没有再次加载，请确保您获得 200 OK。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T17:55:36.717

似乎您缺少管理媒体（因此未加载 js 和图像）。我一般做以下。

在`settings.py`

```
ADMIN_MEDIA_PREFIX = '/media/admin/' 
```

`django.contrib.admin.media`然后我在我的`media`目录中符号链接路径。说：

```
ln -s /var/lib/python-support/python2.5/django/contrib/admin/media/ /var/www/media/admin 
```

开发服务器自动提供管理媒体。但是在生产服务器上，通常更喜欢直接从 apache（或任何服务器）提供静态内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T17:47:43.800

检查部署服务器上的媒体位置、权限和设置。

[http://www.djangobook.com/en/1.0/chapter20/](http://www.djangobook.com/en/1.0/chapter20/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T18:06:30.687

您是否尝试过检查 firebug 的 NET 选项卡以查看管理 javascript/css/image 文件是否都正确加载？

我曾经遇到过这个问题。

将开发服务器中的所有这些文件与生产服务器进行比较。

# winforms - 如何在显示时自动调整用户控件的大小

> ID：443921
> 
> 赞同：1
> 
> 时间：2009-01-14T17:30:35.737
> 
> 标签：winforms, visual-studio-2008, user-controls

我有一个带有一堆用户控件的 Winforms 项目。我希望用户控件将自身移动到相对于其容器的 1,1 位置（无论是表单还是面板控件）。并调整自身大小以适应容器的一半。

我可以在 UserControl 中响应什么事件才能做到这一点，而无需在容器中编写任何代码（例如表单或面板）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T19:34:33.303

您可以使用基本`Load`事件。

代码可能是这样的：

```
private void UserControl1_Load(object sender, EventArgs e)
{
    Control parent = this.Parent;
    if (parent != null)
    {
        this.Location = new Point(1, 1);
        this.Width = (parent.Width / 2);
        this.Height = (parent.Height / 2);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T18:14:33.353

Paint 事件应该可以工作，除非我遗漏了一些东西。

# css - 不同颜色的飞出菜单

> ID：443922
> 
> 赞同：2
> 
> 时间：2009-01-14T17:30:46.687
> 
> 标签：css, sharepoint, master-pages

我正在为 MOSS 发布站点创建自定义母版页。设计师为飞出菜单提出了这个想法......

[替代文字 http://www.abbeylegal.com/Downloads/2009-01-06/gradient%20menu.jpg](http://www.abbeylegal.com/Downloads/2009-01-06/gradient%20menu.jpg)

它为每个菜单选项使用渐变/不同的背景和文本颜色。

有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T17:42:57.070

您可以使用 CSS 下一个兄弟选择器 (+) 来实现这一点，但 IE6 不会获得样式。

执行以下操作（例如颜色属性）：

```
ul ul li { background: darkblue; color: lightblue; }
ul ul li+li { background: blue; color: lightblue; }
ul ul li+li+li { background: lightblue; color: darkblue; }
ul ul li a:hover { color: black; } 
```

或者，您必须将 CSS 类应用于每个下降的子项（如果您对此不负责，请与程序员交谈），或者通过使用 javascript 添加类来实现。

理想情况下，尝试让他们相信你不能为 IE6 做到这一点，但现代浏览器会很好地管理。只要该站点仍然可用，颜色的渐变是非常小的损失。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T17:55:02.397

我看到两个纯 CSS 的可能性：

1\. 如果输入行的像素高度是固定的，则始终可以使用一张带有渐变的背景图像。如果您使用列表制作菜单，则可以将其贴在包含列表的标签上。

2\. 如果您想保持行高/字体大小灵活，您可以使用多个类：每种色调一个。只需给每个第 n 行一个特殊的类，并以相应的色调作为背景色，然后将该类打在该行的标签上。

设计评论家：我在这里看到的问题是您将拥有最大数量的条目，因为随着这种逐渐淡化的水平，在六或七个条目后背景颜色将变为白色。

客气话：只要菜单不必是透明的就可以了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T17:59:21.903

如果您希望能够计算任意颜色的渐变，[此页面](http://www.drpeterjones.com/colorcalc/)有一些有用的函数来处理十六进制颜色三元组计算。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T18:03:43.580

对于菜单中的每个级别，我可能会使用具有不同 CSS 类的[Suckerfish方法：](http://www.htmldog.com/articles/suckerfish/dropdowns/)`<li>`

```
<ul id="menu">
    <li class="root"><a href="#">Home</a></li>
    <!-- etc. -->
    <li><a href="#">Products</a>
        <ul>
             <li class="sub1"><a href="#">BTE Legal Expense Insurance</a></li>
             <li class="sub2"><a href="#">Legal Services</a></li>
             <!-- etc. -->
        </ul>
    </li>
    <!-- etc. -->
</ul> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-21T14:10:41.870

我发现 Sharepoint 无法做到这一点

# c# - 在我的会话中存储对象时的会话变量问题

> ID：443929
> 
> 赞同：0
> 
> 时间：2009-01-14T17:33:11.287
> 
> 标签：c#, asp.net

我有一个登录页面，我在其中验证我的用户，并基于此验证，我将他们的用户信息存储在会话变量中，以便我可以随时访问它。为此，我试图存储我的 dbml 生成的类“UserInfo”之一的实例。所以我填充类，然后将它存储在我称为“用户”的会话变量中

```
 UserInfo u = new UserInfo();
    u = dal.RetrieveUser(userID, userPass)
    Session["user"] = u; 
```

我遇到的问题是它似乎在用户之间混淆了这些会话变量。或者更具体地说，它似乎总是从为每个登录的后续用户存储的第一个用户变量中获取信息。因此，用户 1 的信息正在为用户 2、用户 3 等提取...

我的问题是我的类“UserInfo”在某种程度上是静态的吗？或者是什么导致了这种情况发生？我的 UserInfo 类如下所示：

```
public partial class UserInfo
    {
        ... 
```

编辑：经过进一步审查，似乎我的 Session 变量实际上工作正常，但我的自定义菜单实际上是问题所在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T17:41:37.913

听起来更像是 DAL 的问题，而不是会话对象。您能否验证每次传递的用户 ID 不同，并且 RetrieveUser 函数使用传递的值而不是静态值？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T19:18:34.303

您是在同一台计算机上还是在不同的计算机上使用 Web 客户端进行测试？例如，默认情况下，即使您打开了多个窗口或选项卡，FireFox 也会在单个进程中运行。听起来很傻，我的一位同事在遇到同样问题时并没有注意到这种现象。

# delphi - 数组作为函数的结果类型和输入

> ID：443931
> 
> 赞同：1
> 
> 时间：2009-01-14T17:34:41.673
> 
> 标签：delphi, arrays, function

在delphi7中我有一个函数，我需要返回一个数组作为结果类型b

“函数创建框（键：tkey）：字节数组[0..255]；” 这是不允许的，它期望“预期的标识符，但找到的数组”是错误抛出。如果我声明一个记录类型的数组似乎可以正常工作，但为一个函数执行此操作似乎毫无意义。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-14T17:40:47.930

问题是您不允许在函数声明中创建新类型。但这就是您将返回类型指定为`array[0..255] of Byte`. 相反，声明一个命名类型，然后将其用作返回类型：

```
type
  TSBox = array[0..255] of Byte;

function CreateSBox(const Key: TKey): TSBox; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-12-31T23:30:09.793

这有一个微妙的原因，在 Pascal 中，两个数组类型声明不是相同的“类型”，无论它们的声明多么相同，因此不兼容赋值。如果你写：

```
var
  A: array[1..10] of Integer;
  B: array[1..10] of Integer; 
```

A和B是**不同**的类型。如果你写

```
A := B; 
```

代码不会编译，A 和 B 是不同的类型。

因此，如果你写

```
var
  A: array[1..10] of Integer;
...
function Foo(...): array[1..10] of Integer; 
```

您实际上是在为函数结果声明一个类型 - 该类型将毫无用处，因为无论其声明如何，您都无法将其分配给 A 或任何数组，例如：

```
 A := Foo(...); 
```

即使编译器允许您以这种方式声明函数，它也不起作用。

因此，获得有用的函数结果类型的唯一方法是使用已声明的类型。只有开放数组是该规则的例外，但它们只能用作函数参数，不能用作结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-12-31T20:09:51.650

好的 type TSBox = array of Byte 可以正常工作，但是在 2 个或更多单元中使用这种新类型可能会很棘手。因为你会收到一条错误消息“不兼容的类型”。这种情况有部分解决方案。U 可以使用以下符号通知编译器哪个单元具有该类型： unit.type; 示例：假设我有一个名为 Web 的单元，我在其中声明类型 TDownload。我可以这样做： var fileUrl : Web.TDownload; 在这种情况下，编译器将理解 ur 使用相同的类型。然而，这就是我对你们所有人的问题：如果你们不想将该单元放在使用条款中怎么办 - 循环引用、便便良好做法等。我能做些什么来避免这个问题？

# c# - 在 C# 中使用枚举索引数组

> ID：443935
> 
> 赞同：19
> 
> 时间：2009-01-14T17:35:18.053
> 
> 标签：c#, arrays, enums, cil

我有很多固定大小的数字集合，其中每个条目都可以使用常量访问。自然，这似乎指向数组和枚举：

```
enum StatType {
    Foo = 0,
    Bar
    // ...
}

float[] stats = new float[...];
stats[StatType.Foo] = 1.23f; 
```

这样做的问题当然是您不能使用枚举来索引没有强制转换的数组（尽管编译的 IL 使用纯整数）。所以你必须到处写这个：

```
stats[(int)StatType.foo] = 1.23f; 
```

我试图找到在不强制转换的情况下使用相同简单语法的方法，但还没有找到完美的解决方案。使用字典似乎是不可能的，因为我发现它比数组慢大约 320 倍。我还尝试为以枚举为索引的数组编写一个泛型类：

```
public sealed class EnumArray<T>
{
    private T[] array;
    public EnumArray(int size)
    {
        array = new T[size];
    }
    // slow!
    public T this[Enum idx]
    {
        get { return array[(int)(object)idx]; }
        set { array[(int)(object)idx] = value; }
    }
} 
```

甚至是带有指定枚举的第二个通用参数的变体。这与我想要的非常接近，但问题是您不能只将非特定枚举（无论是来自泛型参数还是盒装类型枚举）强制转换为 int。相反，您必须先将其与对象的转换相结合，然后再将其转换回。这有效，但速度很慢。我发现为索引器生成的 IL 看起来像这样：

```
.method public hidebysig specialname instance !T get_Item(!E idx) cil managed
{
    .maxstack 8
    L_0000: ldarg.0 
    L_0001: ldfld !0[] EnumArray`2<!T, !E>::array
    L_0006: ldarg.1 
    L_0007: box !E
    L_000c: unbox.any int32
    L_0011: ldelem.any !T
    L_0016: ret 
} 
```

如您所见，那里有不必要的装箱和拆箱说明。如果将它们从二进制文件中剥离出来，代码就可以正常工作，并且比纯数组访问慢一点。

有什么方法可以轻松克服这个问题吗？或者甚至更好的方法？我认为也可以使用自定义属性标记此类索引器方法并在编译后剥离这两个指令。什么是合适的图书馆？也许是 Mono.Cecil？

当然，总是有可能删除枚举并使用如下常量：

```
static class StatType {
    public const int Foo = 0;
    public const int Bar = 1;
    public const int End = 2;
} 
```

这可能是最快的方法，因为您可以直接访问数组。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-14T17:47:19.667

我怀疑您*可以*通过编译一个委托来为您进行转换来使其更快一些，这样它就不需要装箱和拆箱。如果您使用的是 .NET 3.5，那么表达式树可能是最简单的方法。（您将在 EnumArray 示例中使用它。）

就个人而言，我很想使用您的`const int`解决方案。它不像.NET 默认提供枚举值验证 - 即你的调用者总是可以`int.MaxValue`转换为你的枚举类型，你会得到一个 ArrayIndexException （或其他）。因此，鉴于您已经获得的保护/类型安全相对缺乏，恒定值答案很有吸引力。

希望 Marc Gravell 能在一分钟内完成编译的转换委托的想法......

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-14T18:24:40.167

如果您的 EnumArray 不是通用的，而是明确采用了 StatType 索引器 - 那么您就可以了。如果这不是可取的，那么我可能会自己使用 const 方法。但是，通过传入 Func<T, E> 的快速测试显示与直接访问相比没有明显差异。

```
 public class EnumArray<T, E> where E:struct {
    private T[] _array;
    private Func<E, int> _convert;

    public EnumArray(int size, Func<E, int> convert) {
        this._array = new T[size];
        this._convert = convert;
    }

    public T this[E index] {
        get { return this._array[this._convert(index)]; }
        set { this._array[this._convert(index)] = value; }
    }
 } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-14T18:55:14.413

如果您有很多固定大小的集合，那么将属性包装在对象中可能比使用 float[] 更容易：

```
public class Stats
{
    public float Foo = 1.23F;
    public float Bar = 3.14159F;
} 
```

传递对象将为您提供所需的类型安全、简洁的代码和常量时间访问。

如果你*真的*需要使用一个数组，添加一个 ToArray() 方法来将你的对象的属性映射到一个 float[] 就很容易了。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-15T18:30:29.493

```
struct PseudoEnum 
{ 
    public const int INPT = 0; 
    public const int CTXT = 1; 
    public const int OUTP = 2; 
}; 

// ... 

String[] arr = new String[3]; 

arr[PseudoEnum.CTXT] = "can"; 
arr[PseudoEnum.INPT] = "use"; 
arr[PseudoEnum.CTXT] = "as"; 
arr[PseudoEnum.CTXT] = "array"; 
arr[PseudoEnum.OUTP] = "index"; 
```

（我还在[https://stackoverflow.com/a/12901745/147511](https://stackoverflow.com/a/12901745/147511)上发布了这个答案）

[编辑：哎呀，我刚刚注意到 Steven Behnke 在本页的其他地方提到了这种方法。对不起; 但至少这显示了一个这样做的例子......]

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-14T17:56:26.793

枚举应该是类型安全的。如果您将它们用作数组的索引，则您正在修复枚举的类型和值，因此与声明 int 常量的静态类相比，您没有任何好处。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-14T19:19:09.013

我对 C# 不是 100% 熟悉，但我以前见过隐式运算符用于将一种类型映射到另一种类型。您可以为 Enum 类型创建一个隐式运算符，允许您将其用作 int 吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-14T17:45:55.440

不幸的是，我不相信有任何方法可以将隐式转换运算符添加到枚举中。因此，您必须要么忍受丑陋的类型转换，要么只使用带有 const 的静态类。

这是一个 StackOverflow 问题，讨论了有关隐式转换运算符的更多信息：

[我们可以在 c# 中定义枚举的隐式转换吗？](https://stackoverflow.com/questions/261663/can-we-define-implicit-conversions-of-enums-in-c)

# c# - 为什么 Visual C# 2008 Express 中缺少 StringBuilder 类的 Chars 属性？

> ID：443936
> 
> 赞同：1
> 
> 时间：2009-01-14T17:35:31.453
> 
> 标签：c#, .net

这几乎就是整个问题。我在干净的 Windows XP Pro SP3 机器上安装了 Visual C# 2008 Express，启动了一个新的 Windows Forms 项目，双击该表单以创建 Form1_Load 方法，然后键入：

```
StringBuilder SB;
SB = new StringBuilder("test");
SB.Chars 
```

但字符不会出现在自动完成菜单上。为什么不？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T17:40:14.407

它是索引器，您使用`foo[bar]`语法而不是引用它`foo.Chars(bar)`：

```
StringBuilder sb = new StringBuilder("Hello");
char c = sb[1]; // c='e' 
```

C# 不使用索引器的名称，也不能使用具有相同参数但名称不同（以不同语言创建）的多个索引器。

大多数时候这没关系，但只是偶尔我希望它完全支持命名索引器......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T17:43:04.150

这是因为您使用的是 C#。

在 C# 中，带参数的属性不能按名称引用，而在 VB 中，它们可以按名称使用。您可以像访问集合中的 Items 属性一样访问此属性：

```
StringBuilder sb = new StringBuilder();
char ch = sb[0]; 
```

这将返回 StringBuilder 内部字符串中的第一个字符。

# sql-server-2005 - 如何学习 MS SQL Server 2005？

> ID：443942
> 
> 赞同：1
> 
> 时间：2009-01-14T17:37:11.073
> 
> 标签：sql-server-2005

我想自己开始学习 SQL Server 2005。任何人都可以推荐对我来说是一个好的开始的好书或网站吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-14T17:42:18.100

**图书：**

[Microsoft SQL Server 2005 内部：T-SQL 查询](https://rads.stackoverflow.com/amzn/click/com/0735623139)

[Microsoft SQL Server 2005 内部：存储引擎](https://rads.stackoverflow.com/amzn/click/com/0735621055)

[Pro SQL Server 2005 数据库设计和优化](https://rads.stackoverflow.com/amzn/click/com/1590595297)

**网站：**

[SQL Server 编程技巧](http://wiki.lessthandot.com/index.php/SQL_Server_Programming_Hacks_-_100%2B_List)

[sqlserver百科](http://sqlserverpedia.com/wiki/Main_Page)

[Microsoft SQL Server 2005 – 学习门户](http://www.microsoft.com/learning/2005/sql/default.mspx)

[如果你买不起书，可以阅读好的 SQL 文章](http://blogs.lessthandot.com/index.php/DataMgmt/DataDesign/good-sql-articles-to-read-if-you-can-t-a)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T17:43:36.287

你是从零开始学习 SQL 吗？

我建议从这个[SQL 教程](http://www.w3schools.com/sql/default.asp)开始。

但是，如果您已经了解 SQL，那么[这是一个很好的关于 SQL 2005 特性的教程列表](http://www.intelligentedu.com/blogs/post/best_new_training_sites/3662/102-sql-server-2005-tutorials-and-articles)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T18:09:21.260

如果您想深入了解 SQL Server 端到端，我发现 Robert Vieira 的 SQL Server 书籍很有用。

这是我推荐的[一个。](https://rads.stackoverflow.com/amzn/click/com/0764584340)

这是一本好书，我推荐它来吸收理论。

如果您需要一本好的参考书，我发现 Murach 的 SQL Server 书籍很有用。

这是我推荐的[一个。](http://www.murach.com/books/sql5/index.htm)

这是一本快速“烹饪书”类型解决方案的好书。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T18:11:43.830

这是这些常见问题的附加链接

[SQL Server 被问到最多的十个问题及其答案](http://blogs.lessthandot.com/index.php/DataMgmt/DataDesign/the-ten-most-asked-sql-server-questions--1)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-14T18:18:36.983

对于较重的 TSQL 问题，我发现这个博客很有用：

[http://www.sommarskog.se/](http://www.sommarskog.se/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-14T18:48:38.450

[在 SQL Server 2005 上学习 SQL](https://rads.stackoverflow.com/amzn/click/com/0596102151)是一本适合初学者的好书。它涵盖了 SQL 语法和服务器管理任务。

# cocoa-touch - 如何从 NSString 中删除非法字符？

> ID：443945
> 
> 赞同：1
> 
> 时间：2009-01-14T17:37:53.913
> 
> 标签：cocoa-touch

我正在使用基于每一行和选项卡的 NSScanner 解析一个选项卡分隔列表。但是由于某种原因，数组中的最后一个字段（从每一行解析）包含一个 \r 字符。

如何从代表行（或字段）的 NSString 中删除它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T19:59:20.647

如果`\r`字符在末尾（可能是因为要解析的文件是 CRLF），您可以执行类似`[string stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceAndNewlineCharacterSet]]`. `'\r'`（如果您也不想去除空格，则可能需要使用显式创建的字符集。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T19:44:10.553

尝试在各种扫描方法调用中将[+[NSCharacterSet newlineCharacterSet]方法与 NSScanner 一起使用。](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSCharacterSet_Class/Reference/Reference.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T19:59:51.257

仅供参考， \r 是在 Windows 环境中创建的文件的行尾的一部分。

# java - 可迭代的 Collections.max 函数 在java中

> ID：443946
> 
> 赞同：6
> 
> 时间：2009-01-14T17:38:00.277
> 
> 标签：java, collections, max, standard-library

Java Collections.max 只接受一个可排序对象的集合。然而，由于集合不一定是排序的，我看不出有任何理由不为可迭代类型实现相同的 max 函数。

`Iterable<T extends Comparable<? super T>>`java的标准库中有max方法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2011-04-06T15:04:04.890

虽然 Guava 不是 Java 的标准库，但它已经足够接近了......

[`E com.google.common.collect.Ordering#max(Iterable<E> iterable)`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Ordering.html#max%28java.lang.Iterable%29)

例如`T max = Ordering.natural().max(myIterable);`

至于标准库为什么不实现它，可能是因为[Collection 必须是有限](http://docs.oracle.com/javase/7/docs/api/java/util/Collection.html#size())的，但[Iterable 不一定是](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Iterables.html#cycle%28T...%29)——而且可以说，如果非终止的 Iterable 会导致您的代码循环，则*永远不*应该接受 Iterable永远。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-14T18:46:43.900

`Collections.max`在 1.2 中引入。`Iterable`在 1.5 中引入。

很少有一个`Iterable`不是`Collection`. 如果你这样做了，那么它很容易实现（请仔细阅读规范）。如果您认为这真的很重要，您可以在 bugs.sun.com 上提交一份 RFE（或者如果那里已经有，请投票）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T17:46:57.060

嗯……不，没有。如果您想使用[Collections.max()](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Collections.html#max(java.util.Collection))您必须首先将您的[Iterable](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Iterable.html)转换为[Collection](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Collection.html)，可能通过将所有元素添加到[List](http://java.sun.com/j2se/1.5.0/docs/api/java/util/List.html)（或[Set](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Set.html)，具体取决于数据）中。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-14T17:50:26.367

根据定义，集合的元素必须是“可排序的”（具体来说，它们必须实现`Comparable`），因为为了计算最大值，必须能够确定一个元素是否大于另一个元素（这正是 Comparable 的含义）。

Collections 类中的[max() 方法](http://java.sun.com/javase/6/docs/api/java/util/Collections.html#max(java.util.Collection))基本上具有您在此处发布的确切类型签名，因此它应该适合您的目的。

# asp.net - dotnetkicks.com 如何实现他们的 ASP.NET 分页？

> ID：443951
> 
> 赞同：0
> 
> 时间：2009-01-14T17:39:04.317
> 
> 标签：asp.net, url-rewriting, paging

我知道[dotnetkicks.com](http://www.dotnetkicks.com/)系统是开源的，所以我可以自己查看代码，但我无法理解他们是如何进行分页的。这很难解释，但如果您[访问 dotnetkicks.com](http://www.dotnetkicks.com/)，您可以在他们的首页上使用分页。

我特别感兴趣的是它们如何显示前几页，然后是“...”，然后是最后几页。

开始是这样的

上一页 1 2 3 4 5 6 ... 355 356 下一页

然后，如果您点击第 10 页，它将更改为

上一页 1 2 ... 6 7 8 9 10 11 12 13 14 ... 355 356 下一页

这是迄今为止我最喜欢的分页系统，所以我想在我的网站上做同样的事情

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T20:40:32.937

如果您曾经编写过分页控件，则项目中的[分页控件非常简单。](http://www.google.com/codesearch/p?hl=en#1tpgUBiru_A/trunk/DotNetKicks/Incremental.Kick/Web/Controls/Navigation/Paging.cs)我认为可能让您感到困惑的是[urlrewriting.net](http://www.urlrewriting.net/)用于 /page/n url 格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T02:07:12.263

我已经编写了这样一个控件，并且需要一些代码......有很多决定要做。

```
public class SimplePagerLinkGenerator : IPagerLinkGenerator
{
    private PagingDisplaySettings _displaySettings;

    public SimplePagerLinkGenerator(PagingDisplaySettings displaySettings)
    {
        this._displaySettings = displaySettings;
    }

    public PageLinkData[] GetPagesLinkData(uint crtPageIndex, uint pageCount, ushort pageSize,
        string urlLinkTemplate)
    {
        int i, crtPage = (int)crtPageIndex, pageCnt = (int)pageCount,
            pgInnerCnt = (int)this._displaySettings.PagesBeforeOrAfterCurrent,
            pgEndCnt = (int)this._displaySettings.PagesShownAtEndingsCount;

        int innerBlockStart = crtPage - pgInnerCnt;
        int innerBlockEnd = crtPage + pgInnerCnt;
        int innerBlockStartNormalized = innerBlockStart < 1 ? 1 : innerBlockStart;
        int innerBlockEndNormalized = innerBlockEnd > pageCount ? pageCnt : innerBlockEnd;

        List<PageLinkData> result = new List<PageLinkData>(2 * pgEndCnt + 3 + 2 * pgInnerCnt);
        for (i = 1; i <= pgEndCnt && i <= pageCount; i++)
            result.Add(new PageLinkData(i, i == crtPage, urlLinkTemplate, pageSize));
        if (i > pageCount)
            return result.ToArray();
        if (innerBlockStart > pgEndCnt + 1)
        {
            result.Add(PageLinkData.Ellipsis);
            for (i = innerBlockStart; i <= innerBlockEndNormalized; i++)
                result.Add(new PageLinkData(i, i == crtPage, urlLinkTemplate, pageSize));
        }
        else
            for (i = pgEndCnt + 1; i <= innerBlockEndNormalized; i++)
                result.Add(new PageLinkData(i, i == crtPage, urlLinkTemplate, pageSize));

        if (innerBlockEnd < pageCount - pgInnerCnt)
        {
            result.Add(PageLinkData.Ellipsis);
            for (i = pageCnt - pgInnerCnt + 1; i <= pageCount; i++)
                result.Add(new PageLinkData(i, i == crtPage, urlLinkTemplate, pageSize));
        }
        else
            for (; i <= pageCount; i++)
                result.Add(new PageLinkData(i, i == crtPage, urlLinkTemplate, pageSize));

        return result.ToArray();
    }

    public PagingDisplaySettings DisplaySettings { get { return this._displaySettings; } }
} 
```

# clickonce - 是否可以将 NGen 与 ClickOnce 部署一起使用？

> ID：443955
> 
> 赞同：21
> 
> 时间：2009-01-14T17:40:13.970
> 
> 标签：clickonce, ngen

是否可以将 NGen 与 ClickOnce 部署一起使用？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-18T18:45:21.287

实际上，您可以使用 NGEN 和 clickone，但是您需要在 clickonce 安装完成后运行 NGEN，因为 NGEN 是 .NET 安装的一部分（对于 3.5，您应该参考 2.0 安装）。

这是一个示例，我认为它足够通用，您可以在不更改或对代码进行很少更改的情况下使用它（对您的表单的调用除外）：

```
static class Program
{
    /// <summary>
    /// The main entry point for the application.
    /// </summary>
    [STAThread]
    static void Main()
    {
        if (ApplicationDeployment.IsNetworkDeployed && ApplicationDeployment.CurrentDeployment.IsFirstRun)
        {

            string appPath = Application.StartupPath;
            string winPath = Environment.GetEnvironmentVariable("WINDIR");

            Process proc = new Process();
            System.IO.Directory.SetCurrentDirectory(appPath);

            proc.EnableRaisingEvents = false;
            proc.StartInfo.CreateNoWindow = false;
            proc.StartInfo.WindowStyle = ProcessWindowStyle.Hidden;

            proc.StartInfo.FileName = winPath + @"\Microsoft.NET\Framework\v2.0.50727\ngen.exe";
            proc.StartInfo.Arguments = "uninstall " + Application.ProductName + " /nologo /silent";

            proc.Start();
            proc.WaitForExit();

            proc.StartInfo.FileName = winPath + @"\Microsoft.NET\Framework\v2.0.50727\ngen.exe";
            proc.StartInfo.Arguments = "install " + Application.ProductName + " /nologo /silent";

            proc.Start();
            proc.WaitForExit();

        }

        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        Application.Run(new Form1());
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-14T17:47:48.963

你不能。请参阅[http://social.msdn.microsoft.com/Forums/en-US/clr/thread/a41b62c5-bdee-4bd5-9811-15a35c4a4add/](http://social.msdn.microsoft.com/Forums/en-US/clr/thread/a41b62c5-bdee-4bd5-9811-15a35c4a4add/)。您需要为此创建一个常规安装程序文件。

# validation - 报表上的参数验证

> ID：443958
> 
> 赞同：5
> 
> 时间：2009-01-14T17:41:22.907
> 
> 标签：validation, reporting-services, report

我是 SSRS 的新手，所以如果这个问题太简单了，我深表歉意：

我有一个报告，它接受一个名为“金额”的参数。我想将有效输入限制为货币值 >= 0，如果用户输入不正确的值，则会弹出一条错误消息。

我不想验证存储过程中的输入并抛出异常，因为 SSRS 会向从另一台机器访问报告的用户显示非常通用的“'someTable' 的查询执行失败”消息，而我的业务不想转向在“启用远程错误”标志上。

**如何将输入验证添加到报告参数并通知用户输入错误？**

是的，我用谷歌搜索过，但运气不佳。提前致谢 ：）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-14T19:50:53.643

好的，这个怎么样？

实际上，您在 SSRS 中拥有的只是报表字段中的 SQL 查询和表达式。

也许您可以在报告顶部为您的错误消息添加一个大的红色文本框，并给它一个表达式，如 '=IIf(Parameters!Amount.Value < 0, "Error: Invalid Amount", "")' .

然后转到表的“隐藏”属性并为其指定表达式“=Parameters！Amount.Value < 0”

您还可以添加到查询的 where 子句中并添加“AND @Amount >= 0”，这样当出现错误时您就不会从数据库中获取。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T17:50:08.613

可以在 SSRS 中创建基于特定列表或查找查询的报告参数，但我认为您不能应用正则表达式或类似的东西。

相反，您可能会考虑将您的报告分成两个面板，一个显示您的报告，一个显示错误，然后您创建一个程序集，其中包含一个在运行之前验证报告参数的函数。如果验证参数功能成功，则隐藏错误面板并显示报告面板，如果不成功，则执行相反的操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T18:57:58.417

我不认为您可以在报告工具本身中做很多事情。这是相当初级的。

但是，您可以提供一个 ASP.net Web 界面或一个表单，您可以使用它以 .NET 允许的任何格式向用户询问参数值，并使用 ReportViewer 控件来显示报告。这听起来令人生畏，但实际上非常简单，特别是如果您已经有一个可以构建的项目。

Microsoft 提供[了使用 ReportViewer 控件的教程](http://msdn.microsoft.com/en-us/library/aa337090.aspx)。

# python - 如何从长十六进制字符串创建 python 字节对象？

> ID：443967
> 
> 赞同：110
> 
> 时间：2009-01-14T17:42:50.360
> 
> 标签：python, hex, byte

我在字符串中有很长的十六进制数字序列，例如

> 000000000000484240FA063DE5D0B744ADBED63A81FAEA390000C8428640A43D5005BD44

只有更长，几千字节。在 python 2.6/3 中是否有一种内置方法可以将其转换为字节对象？

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2013-06-18T03:37:20.777

适用于 Python 2.7 及更高版本，包括 python3：

```
result = bytearray.fromhex('deadbeef') 
```

**注意：**`bytearray.fromhex()` Python 2.6 中的函数似乎存在错误。python.org 文档声明该函数接受一个字符串作为参数，但是在应用时，会引发以下错误：

```
>>> bytearray.fromhex('B9 01EF')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: fromhex() argument 1 must be unicode, not str` 
```

* * *

## 回答 #2

> 赞同：105
> 
> 时间：2009-01-14T17:50:38.193

```
result = bytes.fromhex(some_hex_string) 
```

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2009-01-14T17:47:20.057

您可以使用十六进制编解码器执行此操作。IE：

```
>>> s='000000000000484240FA063DE5D0B744ADBED63A81FAEA390000C8428640A43D5005BD44'
>>> s.decode('hex')
'\x00\x00\x00\x00\x00\x00HB@\xfa\x06=\xe5\xd0\xb7D\xad\xbe\xd6:\x81\xfa\xea9\x00\x00\xc8B\x86@\xa4=P\x05\xbdD' 
```

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2009-01-14T17:46:38.013

试试[binascii 模块](http://doc.astro-wise.org/binascii.html#-unhexlify)

```
from binascii import unhexlify
b = unhexlify(myhexstr) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-07-30T06:39:06.260

```
import binascii

binascii.a2b_hex(hex_string) 
```

我就是这样做的。

# asp.net - 在 .net 中，是否有与 Server.HTMLEncode() 相反的函数？

> ID：443968
> 
> 赞同：2
> 
> 时间：2009-01-14T17:42:51.563
> 
> 标签：asp.net

.Net 的 Server.HTMLEncode() 是一个非常有用的函数，它接受一个 HTML 字符串并用它们的实体等价物替换特殊字符 - "<" 变成 < ; 等等。

是否有（内置）功能可以相反？好像没有，我不敢相信。虽然我当然可以编写自己的（过去也有）Server.HTMLEncode 对不同的字符串编码和高级 unicode 字符进行了各种很酷的处理，我真的不会在一年内让我的手动解码器崩溃。

当其他人需要返回纯 HTML 时，他们会怎么做？

更新：为了回答第一批问题，我介绍了 MSDN 上关于 [Server object](http://msdn.microsoft.com/en-us/library/ms525541.aspx)的文章，它有 Encode 但没有 Decode……我和任何人一样感到惊讶。

更新 2：正如几位警惕的读者所指出的，我正在查看的文档是针对经典 ASP 的，而不是针对 ASP.Net 的。谢谢大家，这是一个重要的 MSDN 安全提示。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-14T17:44:40.920

Server.HtmlDecode ....

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-14T17:44:47.627

您没有在找到 HtmlEncode 的地方看到 HtmlDecode？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-14T18:05:58.350

您正在查看错误的文档。看一下这个：

> [http://msdn.microsoft.com/en-us/library/system.web.httpserverutility_methods.aspx](http://msdn.microsoft.com/en-us/library/system.web.httpserverutility_methods.aspx) [http://msdn.microsoft.com/en-us/library/system.web.httpserverutility.htmlencode.aspx](http://msdn.microsoft.com/en-us/library/system.web.httpserverutility.htmlencode.aspx) [http: //msdn.microsoft.com/en-us/library/system.web.httpserverutility.htmldecode.aspx](http://msdn.microsoft.com/en-us/library/system.web.httpserverutility.htmldecode.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T18:02:50.650

HttpServerUtility.HtmlDecode

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T18:03:48.087

啊，MSDN，我爱你。

有一个 Server.HTMLDecode() 方法，服务器对象的文档只是没有提到它存在。

谢谢大家！

# c# - 向 ASP.NET 添加全局异常处理

> ID：443977
> 
> 赞同：1
> 
> 时间：2009-01-14T17:44:24.320
> 
> 标签：c#, asp.net, exception, asp.net-2.0

我在一个相当大的网站上工作。我们目前有 4 个 Web 服务器和一个使用 C# 运行 ASP.NET 2.0 的主动被动数据库集群。目前我们的异常处理没有捕获正确的异常抛出。我听说这是因为`Server.GetLastError()`它不是线程安全的（***注意****：我们目前不使用`Server.GetLastError().GetBaseException()`这可能是我们没有得到正确错误的原因*）。

我们正在启动一个捕获确切异常的项目，因此我们实际上可以看到错误的根本原因，我正在尝试找到最好的方法来做到这一点。

我们的选择是：

*   遍历我们所有的类/方法（数百个，如果不是数千个）添加 try/catch/finally 块以捕获正确的异常。
*   找出一种方法来正确处理 global.asax 中的异常。

所以我想我的问题是：

*   `Server.GetLastError()`线程安全吗？
*   如果同时抛出两个异常，是否都会被记录？
*   有没有比我列出的更好的方法来处理这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T18:05:23.513

我相信您根本不应该更改初始应用程序。您应该在 web.config 中创建并注册一个 IHttpModule，该 IHttpModule 挂钩 Error 事件以递归记录抛出的异常及其内部异常。

**延伸阅读**：

*   [**MSDN** - 使用 HTTP 模块和处理程序创建可插入的 ASP.NET 组件](http://msdn.microsoft.com/en-us/library/aa479332.aspx)
*   [**DotNetSlackers** - ELMAH - 错误记录模块和处理程序](https://web.archive.org/web/20170628223117/http://dotnetslackers.com/articles/aspnet/ErrorLoggingModulesAndHandlers.aspx "dotnetslackers.com/articles/aspnet/ErrorLoggingModulesAndHandlers.aspx 的存档")
*   [**CodeProject** - ELMAH - 错误日志模块和处理程序，用于 asp.net 中未处理的错误](https://www.codeproject.com/Articles/26468/ELMAH-Error-Loggin-Module-and-Handler-For-unhandle)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T18:00:19.873

你应该看看[Steven A. Lowe 的](https://stackoverflow.com/users/9345/steven-a-lowe) [CALM](http://www.nov8r.com)产品。

这是一个非常好的“插件”解决方案。

（免责声明：我是 beta 测试者之一）

# java - 为什么枚举的构造函数不能访问静态字段？

> ID：443980
> 
> 赞同：120
> 
> 时间：2009-01-14T17:45:30.513
> 
> 标签：java, enums

为什么枚举的构造函数不能访问静态字段和方法？这对于类是完全有效的，但对于枚举是不允许的。

我想要做的是将我的枚举实例存储在静态地图中。考虑这个允许通过缩写查找的示例代码：

```
public enum Day {
    Sunday("Sun"), Monday("Mon"), Tuesday("Tue"), Wednesday("Wed"), Thursday("Thu"), Friday("Fri"), Saturday("Sat");

    private final String abbreviation;

    private static final Map<String, Day> ABBREV_MAP = new HashMap<String, Day>();

    private Day(String abbreviation) {
        this.abbreviation = abbreviation;
        ABBREV_MAP.put(abbreviation, this);  // Not valid
    }

    public String getAbbreviation() {
        return abbreviation;
    }

    public static Day getByAbbreviation(String abbreviation) {
        return ABBREV_MAP.get(abbreviation);
    }
} 
```

这将不起作用，因为枚举不允许其构造函数中的静态引用。然而，如果作为一个类实现，它就可以工作：

```
public static final Day SUNDAY = new Day("Sunday", "Sun");
private Day(String name, String abbreviation) {
    this.name = name;
    this.abbreviation = abbreviation;
    ABBREV_MAP.put(abbreviation, this);  // Valid
} 
```

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2009-01-14T17:50:07.117

在静态字段全部初始化之前调用构造函数，因为静态字段（包括表示枚举值的那些）按文本顺序初始化，并且枚举值总是在其他字段之前。请注意，在您的类示例中，您没有显示 ABBREV_MAP 的初始化位置 - 如果它*在*SUNDAY 之后，则在初始化类时会出现异常。

是的，这有点痛苦，可能设计得更好。

但是，根据我的经验，通常的答案是`static {}`在所有静态初始化程序的末尾有一个块，并在那里进行所有静态初始化，`EnumSet.allOf` 用于获取所有值。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2011-10-26T11:18:27.550

引自[JLS，“枚举主体声明”部分](https://docs.oracle.com/javase/specs/jls/se8/html/jls-8.html#jls-8.9.2)：

> 如果没有这条规则，由于枚举类型固有的初始化循环性，显然合理的代码将在运行时失败。（在任何具有“自类型”静态字段的类中都存在循环。）下面是一个可能会失败的代码示例：
> 
> ```
> enum Color {
>     RED, GREEN, BLUE;
>     static final Map<String,Color> colorMap = new HashMap<String,Color>();
> 
>     Color() {
>        colorMap.put(toString(), this);
>     }
> } 
> ```
> 
> 此枚举类型的静态初始化将引发*NullPointerException*，因为当枚举常量的构造函数运行时静态变量 colorMap 未初始化。上面的限制确保这样的代码不会编译。
> 
> 请注意，该示例可以轻松重构以正常工作：
> 
> ```
> enum Color {
>     RED, GREEN, BLUE;
>     static final Map<String,Color> colorMap = new HashMap<String,Color>();
> 
>     static {
>         for (Color c : Color.values())
>             colorMap.put(c.toString(), c);
>     }
> } 
> ```
> 
> 重构后的版本显然是正确的，因为静态初始化从上到下发生。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-02-18T09:00:25.530

也许这就是你想要的

```
public enum Day {
    Sunday("Sun"), 
    Monday("Mon"), 
    Tuesday("Tue"), 
    Wednesday("Wed"), 
    Thursday("Thu"), 
    Friday("Fri"), 
    Saturday("Sat");

    private static final Map<String, Day> ELEMENTS;

    static {
        Map<String, Day> elements = new HashMap<String, Day>();
        for (Day value : values()) {
            elements.put(value.element(), value);
        }
        ELEMENTS = Collections.unmodifiableMap(elements);
    }

    private final String abbr;

    Day(String abbr) {
        this.abbr = abbr;
    }

    public String element() {
        return this.abbr;
    }

    public static Day elementOf(String abbr) {
        return ELEMENTS.get(abbr);
    }
} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2016-02-10T15:47:54.677

该问题通过嵌套类解决。优点：它更短，CPU消耗也更好。缺点：JVM 内存中多了一个类。

```
enum Day {

    private static final class Helper {
        static Map<String,Day> ABBR_TO_ENUM = new HashMap<>();
    }

    Day(String abbr) {
        this.abbr = abbr;
        Helper.ABBR_TO_ENUM.put(abbr, this);

    }

    public static Day getByAbbreviation(String abbr) {
        return Helper.ABBR_TO_ENUM.get(abbr);
    } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-05-02T10:16:23.320

当一个类在 JVM 中加载时，静态字段会按照它们在代码中出现的顺序进行初始化。例如

```
public class Test4 {
        private static final Test4 test4 = new Test4();
        private static int j = 6;
        Test4() {
            System.out.println(j);
        }
        private static void test() {
        }
        public static void main(String[] args) {
            Test4.test();
        }
    } 
```

输出将为 0。请注意，test4 初始化发生在静态初始化过程中，在此期间 j 尚未初始化，因为它稍后会出现。现在，如果我们切换静态初始化器的顺序，使得 j 在 test4 之前。输出将是 6。但在枚举的情况下，我们无法更改静态字段的顺序。枚举中的第一件事必须是实际上是枚举类型的静态最终实例的常量。因此，对于枚举，它始终保证静态字段不会在枚举常量之前初始化。因为我们不能为静态字段提供任何合理的值以用于枚举构造函数，在枚举构造函数中访问它们是没有意义的。

# jquery - 您可以在同一页面上有多个具有不同主题的网格吗？

> ID：443982
> 
> 赞同：1
> 
> 时间：2009-01-14T17:45:39.340
> 
> 标签：jquery, jqgrid

我有一个使用 jqGrid 和 jQuery 的主/详细信息设置。是否可以让细节网格使用与主网格不同的主题/皮肤？

我看到一个更改图像文件夹的设置，但在我看来，`grid.css`整个页面都必须相同。有人试过吗？或者您对解决方法有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-25T00:30:21.973

我快速浏览了文档，似乎你不能，因为如果你有多个网格，默认情况下它们都会使用相同的 CSS 规则。如果您加载另一个 grid.css 样式表，那么它将优先于前一个样式表。它们似乎没有提供为每个网格选择主题的机制。

# php - php中的简单授权/登录功能

> ID：443988
> 
> 赞同：6
> 
> 时间：2009-01-14T17:47:14.800
> 
> 标签：php, security, authentication

我希望第一次实现用户登录到我的网站。我很高兴构建自己的解决方案，或者实现一些开源的东西，但是到目前为止，在我的搜索中没有一个包是一个明显的选择。同样，我完全意识到，充其量作为中级 php 程序员，如果我推出自己的解决方案，我很可能会错过一些明显的事情，并让大门真正敞开。

有什么建议么？我们不是在这里谈论超级敏感或支付数据，但同样，我渴望不要让人们搞砸我的网站！

要求是 - 基于 php - 尽可能简单，不需要花哨的花里胡哨 - 不是 Zend 框架，因为我现在已经推出了自己的非常基本的框架感谢[这篇文章](https://stackoverflow.com/questions/422250/php-framework-or-template-engine-or-something-else)

感谢您的输入。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-14T18:16:16.160

一些好的安全问题是

*   **永远不要**将未加密的用户密码存储在数据库中
*   **永远不要**在会话或 cookie 数据中存储用户密码，甚至是密码的哈希值。
*   如果您需要确保登录是安全的，则必须使用 https。

我发现这些文章对使用 cookie 构建登录系统非常有帮助：

*   [鱼缸上的博文](http://fishbowl.pastiche.org/2004/01/19/persistent_login_cookie_best_practice/)。
*   [改进的持久登录 Cookie 最佳实践](http://jaspan.com/improved_persistent_login_cookie_best_practice)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-14T18:03:40.600

“你会睁大眼睛的，孩子。”

安全很难。我不想这么说，但是你制作一个安全的简单授权方案的可能性很小。这里没有简单的模式。因此，您可能希望首先阅读各种框架/cmses 中的一堆身份验证代码，以及您可以看到其他人如何完成它的其他地方，然后开始研究。

这里有一些链接： [http ://www.topmost.se/personal/articles/casual-cryptography-for-web-developers.htm](http://www.topmost.se/personal/articles/casual-cryptography-for-web-developers.htm) [http://pear.php.net/packages.php?catpid=1](http://pear.php.net/packages.php?catpid=1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T19:30:02.453

我发现对于*某些*用途，使用 http 身份验证构建我自己的就足够了。我建议[将此](http://us3.php.net/features.http-auth)作为起点。

由于您有自己的基本框架，因此在某个常见的地方包含身份验证代码应该不会太难。

一些优点是

*   代码不多。
*   不需要 cookie 或 URL 重写。

缺点

*   不能很好地扩展到更精细的访问控制。
*   没有*简单*的方法“退出”。

--
bmb

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-14T18:04:13.580

作为初学者，这并不难，而且编码很有趣。

你需要一个地方来存储你的数据（比如说一个 mysql 数据库）。

您至少应该有一个登录字段和一个密码字段。（例如，密码应使用 sha1() 加密存储）。

现在，您必须显示一个登录表单。我想这对你来说没问题。

每当我们获得登录名和密码时，要做什么？

查询数据库以查看是否与 login_base == login_form 和 password_base == sha1(password_form) 匹配。

如果是，您设置了一些东西，例如会话。

因此，在应该记录的页面上，您只需检查是否有会话集。

这是基础；然后你可以添加一些级别等等。

# xml - 如何在 shell 脚本中解析 rss-feeds / xml

> ID：443991
> 
> 赞同：13
> 
> 时间：2009-01-14T17:47:39.947
> 
> 标签：xml, bash, rss, scripting

我想在我的 ReadyNas 上解析 rss 提要并下载[播客，无论如何它都在 24/7 运行。](https://blog.stackoverflow.com/category/podcasts/)

所以我正在考虑让一个 shell 脚本定期检查提要并生成 wget 来下载文件。

进行解析的最佳方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-15T10:06:12.123

有时，一个带有 shell 标准命令的简单单行就足够了：

```
 wget -q -O- "http://www.rss-specifications.com/rss-podcast.xml" | grep -o '<enclosure url="[^"]*' | grep -o '[^"]*$' | xargs wget -c 
```

当然，这并不适用于所有情况，但通常已经足够好了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T18:01:24.973

你可以访问awk吗？也许你可以使用[XMLGawk](http://home.vrweb.de/~juergen.kahrs/gawk/XML/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T17:49:56.960

[我在这里](http://codesnippets.joyent.com/posts/show/1909)和[那里](http://bashcurescancer.com/the-best-in-command-line-xml-xmlstarlet.html)读到了关于[XMLStartlet](http://xmlstar.sourceforge.net/)

但是有可用的 ReadyNas NV+ 端口吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-14T13:38:13.577

我编写了以下用于从 Amazon S3 下载 XML 的简单脚本，因此它可用于解析不同类型的 XML 文件：

```
#!/bin/bash
#
# Download all files from the Amazon feed
#
# Usage:
#  ./dl_amazon_feed_files.sh http://example.s3.amazonaws.com/
# Note: Don't forget about slash at the end
#

wget -qO- "$1" | grep -o '<Key>[^<]*' | grep -o "[^>]*$" | xargs -I% -L1 wget -c "$1%" 
```

这与[@leo answer](https://stackoverflow.com/a/446217/55075)类似。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T18:15:29.373

您可以使用[libxml2](http://xmlsoft.org/)中的 xsltproc并编写一个简单的 xsl 样式表来解析 rss 并输出链接列表。

# ironpython - 有没有人追踪 IronPython 或 IronRuby 是否支持属性？

> ID：443996
> 
> 赞同：1
> 
> 时间：2009-01-14T17:49:20.100
> 
> 标签：ironpython, ironruby

我已经扫描了“谷歌”，但还没有找到关于 Iron* 语言（任何或全部）最终是否会获得属性支持的明确答案。

任何人？

谢谢 - 乔恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-14T20:12:40.730

最近在 Ironpython 邮件列表中有一些关于计划的讨论 -[链接文本](http://www.mail-archive.com/users@lists.ironpython.com/msg08218.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T20:15:26.653

截至去年 8 月 IronRuby[还没有属性支持](http://rubyforge.org/pipermail/ironruby-core/2008-August/002633.html)，从那以后我还没有看到任何关于它的最新公告，但这绝对是一个计划中的功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T23:02:38.280

在不久的将来，我们将再次关注以 .NET 互操作为重点的版本的属性支持。请关注 ironruby-core@rubyforge.org 以获取更新。**