# StackOverflow 问答 000850000-000850999

# sql - 如何管理数据库中的“组”？

> ID：850017
> 
> 赞同：2
> 
> 时间：2009-05-11T20:45:10.257
> 
> 标签：sql, sql-server, database-design

我在[这里](https://stackoverflow.com/questions/774402/is-there-anything-wrong-with-having-a-table-with-one-column-mssql-server)问过这个问题，但我认为我没有理解我的意思。

假设我有以下表格（所有 PK 都是 IDENTITY 字段）：

*   人员（PersonId (PK)、姓名、SSN 等）
*   贷款（LoanId (PK)、金额等）
*   借款人（BorrowerId(PK)、PersonId、LoanId）

假设史密斯先生以他的名义获得了 2 笔贷款，3 笔与他的妻子联名贷款，1 笔与他的情妇联名贷款。为了申请的目的，我想对人进行 GROUP，以便我可以轻松地挑选出史密斯先生与他的妻子共同贷款的贷款。

为了实现这一点，我添加了 BorrowerGroup 表，现在我有以下内容（所有 PK 都是 IDENTITY 字段）：

*   人员（PersonId (PK)、姓名、SSN 等）
*   贷款（LoanId (PK)、Amount、BorrowerGroupId 等）
*   BorrowerGroup(GroupId (PK))
*   借款人（BorrowerId(PK)、GroupId、PersonId）

现在，史密斯先生分为 3 个组（他自己、他和他的妻子、他和他的情妇），我可以很容易地在这些组中查找他的活动。

新设计的问题：

生成新 BorrowerGroup 的唯一方法是在 IDENTITY_INSERT ON 的情况下插入 MAX(GourpId)+1，这感觉不对。此外，具有 1 列的表的概念有点奇怪。

我坚信代理键，如果可能的话，我想坚持这种设计。

本应用不关心个人，GROUP被视为个人

### 为了这个应用程序的目的，有没有更好的方法来分组人员？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-11T21:00:06.377

您可以删除表格`BorrowerGroups`- 它不包含任何信息。此信息已通过`Loans` `People`共享提供 - 我只是假设您有一张`PeopleLoans`桌子。

```
People          Loans           PeopleLoans
-----------     ------------    -----------
1  Smith         6  S1    60    1   6
2  Wife          7  S2    60    1   7
3  Mistress      8  S+W1  74    1   8
                 9  S+W2  74    1   9
                10  S+W3  74    1  10
                11  S+M1  89    1  11
                                2   8
                                2   9
                                2  10
                                3  11 
```

所以你`BorrowerGroups`实际上几乎是`Loans`- 只有史密斯的 6 和 7，史密斯和妻子的 8 到 10，以及史密斯和情妇的 11。**所以首先没有必要`BorrowerGroups`，因为它们与`Loans`被涉及的分组相同`People`。**

但可能很难有效地检索这些信息，因此您可以考虑`GroupId`直接在`Loans`. 忽略第三列的第二列`Loans`（只是为了便于阅读）应该代表您的组。它们是多余的，所以如果你改变它们，你必须小心。

`GroupId`如果您找到一种从相关人员的 id 中获取唯一性的好方法，则可以将其设为计算列。如果一个字符串可以作为组 ID，您可以只订购人员的 ID，然后用分隔符连接他们。

`60`只有 Smith 的Group会得到 id `'1'`， group`74`会变成`1.2`， group`89`会变成`1.3`。不是那么聪明，但独特且易于计算。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T21:05:55.510

使用原始模式：

*   人员（PersonId (PK)、姓名、SSN 等）
*   贷款（LoanId (PK)、金额等）
*   借款人（BorrowerId(PK)、PersonId、LoanId）

只需查询您需要的数据（您的示例是在同一笔贷款中查找夫妻）：

```
SELECT
    l.*
    FROM Borrowers            b1
        INNER JOIN Borrowers  b2 ON b1.LoanId=b2.LoanId
        INNER JOIN Loans       l ON b1.LoanId=l.LoanId
    WHERE b1.PersonId=@HusbandID
        AND b2.PersonId=@WifeID 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T20:57:22.233

数据库的设计似乎还可以。为什么创建新组时必须使用 MAX(GourpId)+1？您不能只创建行然后使用 SCOPE_IDENTITY() 返回新 ID 吗？

例如

```
INSERT INTO BorrowerGroup() DEFAULT VALUES
SELECT SCOPE_IDENTITY() 
```

（见[另一个问题](https://stackoverflow.com/questions/45651/sql-how-to-get-the-id-of-values-i-just-inserted)）

（编辑到 SQL 礼貌[这个问题](https://stackoverflow.com/questions/850327/how-to-insert-into-a-table-with-just-one-identity-column)）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T21:04:13.313

我会做更多这样的事情：

> *   人员（PersonId (PK)、姓名、SSN 等）
>     
>     
> *   贷款（LoanId (PK)、Amount、BorrowerGroupId 等）
>     
>     
> *   BorrowerGroup(BorrowerGroupId (PK))
>     
>     
> *   PersonBelongsToBorrowerGroup(BorrowerGroupId (PK), PersonId(PK))

我摆脱了 Borrowers 表。只需将信息存储在 BorrowerGroup 表中。这是我的偏好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-11T21:34:07.570

共识似乎是省略 BorrowerGroup 表，我必须同意。建议您使用 MAX(groupId+1) 有各种 ACID/事务问题以及 IDENTITY 字段存在的主要原因。

那就是说；KM 提供的 SQL 看起来不错。有多种方法可以获得相同的结果。连接、子选择等。那里的真正问题......是了解数据集。鉴于您提供的解释，数据集将非常小。这也支持删除 BorrowerGroup 表。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T14:53:45.867

我将有一个组表，然后是一个 groupmembers(borrowers) 表来完成贷款和人之间的多对多关系。这允许跟踪组上的数据，而不仅仅是成员列表（我相信其他人提出了这个建议？）。

```
CREATE TABLE LoanGroup
(
    ID int NOT NULL 
    , Group_Name char(50) NULL 
    , Date_Started datetime NULL 
    , Primary_ContactID int NULL
    , Group_Type varchar(25)
) 
```

# java - Lucene 搜索查询中的嵌套禁止/要求运算符

> ID：850020
> 
> 赞同：3
> 
> 时间：2009-05-11T20:45:27.557
> 
> 标签：java, search, parsing, lucene

我正在使用 Lucene for Java，并且需要弄清楚当我执行一些晦涩的查询时引擎会做什么。进行以下查询：

```
+(foo -bar) 
```

如果我使用 QueryParser 解析输入，我会得到一个 BooleanQuery 对象，如下所示：

```
org.apache.lucene.search.BooleanQuery:
    org.apache.lucene.search.BooleanClause(required=true, prohibited=false):
        org.apache.lucene.search.BooleanQuery:
            org.apache.lucene.search.BooleanClause(required=false, prohibited=false):
                org.apache.lucene.search.TermQuery: foo
            org.apache.lucene.search.BooleanClause(required=false, prohibited=true):
                org.apache.lucene.search.TermQuery: bar 
```

Lucene 寻找什么？是必须包含“foo”但不能包含“bar”的文档吗？如果我搜索：

```
-(foo +bar) 
```

那些不能包含 'foo' 和不能包含 'bar' 的文件是吗？或者也许不能包含“foo”但必须包含“bar”？

如果它有帮助，这是我用来查看 QueryParser 结果的内容：

```
QueryParser parser = new QueryParser("contents", new StandardAnalyzer());
Query query = parser.parse(text);
debug(query, 0);

public static void debug(Object o, int depth) {
    for(int i=0; i<depth; i++) System.out.print("\t");
    System.out.print(o.getClass().getName());

    if(o instanceof BooleanQuery) {
        System.out.println(":");
        for(BooleanClause clause : ((BooleanQuery)o).getClauses()) {
            debug(clause, depth + 1);
        }
    } else if(o instanceof BooleanClause) {
        BooleanClause clause = (BooleanClause)o;
        System.out.println("(required=" + clause.isRequired() + ", prohibited=" + clause.isProhibited() + "):");
        debug(clause.getQuery(), depth + 1);
    } else if(o instanceof TermQuery) {
        TermQuery term = (TermQuery)o;
        System.out.println(": " + term.getTerm().text());
    } else {
        throw new IllegalArgumentException("Unknown object type");
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T20:56:55.657

默认情况下，Lucene 假设术语之间是 OR 关系，所以第一个查询相当于

```
+(foo OR -bar) 
```

这将匹配包含（在默认字段中）“foo”或不包含“bar”的文档

在第二个查询中，“+”使“bar”成为必需，这使得可选的“foo”变得多余，因此可以将其简化为“-bar”，以匹配所有不包含“bar”的文档

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T21:40:24.837

Luke [http://www.getopt.org/luke/](http://www.getopt.org/luke/)对于了解查询的作用非常有用

# c# - Tracing LINQ TO SQL generated queries in ASP.NET MVC

> ID：850024
> 
> 赞同：2
> 
> 时间：2009-05-11T20:46:30.690
> 
> 标签：c#, visual-studio-2008, linq, linq-to-sql, debugging

Quick question on LINQ to SQL generated queries output.

I am in a ASP.NET MVC project, Visual Studio 2008, and I am trying what's suggested in MSDN documentation:

```
MyDataContext _dc = new MyDataContext();
_dc.Log = Console.Out; 
```

But nothing is being shown on "Output" window (CTRL+Alt+O).

Is there is something else I need to configure in order to make LINQ to SQL dumping debug info to Output window in Visual Studio 2008?

I don't know if it makes any difference, but my entities (and **MyDataContext** class) are located in a separate *class library* project.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-11T20:53:09.510

You can use [LINQ to SQL Visualizer](http://weblogs.asp.net/scottgu/archive/2007/07/31/linq-to-sql-debug-visualizer.aspx). Attach the debugger, add a breakpoint and you'll be able to use it.

# php - 如何在 PHP 中进行有向图绘制？

> ID：850031
> 
> 赞同：6
> 
> 时间：2009-05-11T20:50:24.553
> 
> 标签：php, graphics, graph-theory, directed-graph

我正在寻找一种在 PHP 中绘制有向图的方法。（如[http://upload.wikimedia.org/wikipedia/commons/0/08/Directed_acyclic_graph.png](http://upload.wikimedia.org/wikipedia/commons/0/08/Directed_acyclic_graph.png)）。我希望它创建图形的图像，就像 GD 可以输出图像一样。

我在这方面搜索了很多，但我只能找到很多用于绘制一般图形的库（带有条形图等），而不是有向图。

PS我试过通过system()使用dot（linux程序），但不幸的是我没有在服务器上这样做的权限。另外，我无权在服务器上安装 PHP 扩展和类似的东西，所以它应该与普通的 PHP 一起工作（最好只包含一个文件）。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-11T20:54:08.523

我找到了[GraphViz 的 PEAR 接口](http://pear.php.net/package/Image_GraphViz)；我之前没有使用过，所以不能给你任何个人建议，不管它是好是坏。（但也许这并不能解决您的问题，因为您说您无法安装应用程序）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T21:00:53.553

我不知道 php 中有任何图形可视化实现。

但是我建议您考虑使用 javascript 绘制图形，例如使用适用于大多数浏览器的[canviz](http://code.google.com/p/canviz/) JS 库（是的，包括[IE 6 和 7](http://code.google.com/p/canviz/wiki/Browsers)，但目前不包括 8）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-09T00:10:54.240

我使用 php 生成[d3 强制导向图](https://github.com/mbostock/d3/wiki/Force-Layout)系统使用的 json。所以显示都是客户端处理的，我需要做的就是制作正确的 json 数据结构......

-FT

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T21:09:43.693

在谷歌快速搜索后，我找到[了 graph.php](https://secure.phpeclipse.com/browser/vendors/seagull/trunk/lib/pear/Structures/Graph.php?rev=1564)，它在评论中指出它通过弧连接节点，在提供的示例中是直线，但可能是朝着正确方向迈出的一大步。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-10T13:35:02.250

还没有尝试过，但这看起来很有希望。

[http://www.kylescholz.com/blog/2006/06/using_force_directed_graphs.html](http://www.kylescholz.com/blog/2006/06/using_force_directed_graphs.html)

# ruby-on-rails - Netbeans 的问题：Rails erb/rhtml 智能感知？

> ID：850047
> 
> 赞同：2
> 
> 时间：2009-05-11T20:56:53.513
> 
> 标签：ruby-on-rails, netbeans, intellisense, erb

我一直在使用 Netbeans for Rails 并且非常喜欢它，考虑到我为它支付的费用很少。但困扰我的是，当我编辑 RHTML 或 ERB 文件时，它不会自动完成代码 - 或者至少不可靠。有时它会在您键入点运算符后显示对象上可用的适当变量和方法。有时它会忽略实例变量。**有解决方案吗？**（请不要说 RadRails）。

哦，如果有人解决了这个问题，还有一件事：考虑到当我在 Rails 模板中时我必须输入**<%**的频率，我希望有一些用于自动输入 tag 的热键。. . ? 在我输入标签之前，我总是必须停下来低头看我的键盘以找到**<**和**%**键，所以它不像听起来那么简单。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-11T21:02:41.083

我相信你正在寻找这样的东西：

[http://ruby.netbeans.org/codetemplates-rhtml.html](http://ruby.netbeans.org/codetemplates-rhtml.html)

输入其中一个触发器，然后按 Tab 键将其展开为给定的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T22:04:13.683

此外，您可能想探索使用 HAML。手上就容易多了。

# linq - LINQ - 加入动态查询

> ID：850050
> 
> 赞同：3
> 
> 时间：2009-05-11T20:58:04.930
> 
> 标签：linq, dynamic, join

由于一些商业决策，我需要改变一些我正在做的事情。耶我。:)

目前，我有：

```
public IOrderedQueryable<ProductDetail> GetProductList(string productGroupName, string productTypeName, Dictionary<string,List<string>> filterDictionary)
{
    string whereClause = "ProductGroupName='" + productGroupName + "' AND ProductTypeName='" + productTypeName + "'";
    string comma = "";
    foreach (KeyValuePair<string, List<string>> myKVP in filterDictionary)
    {
        comma = "";
        if (myKVP.Value.Count > 0)
        {
            whereClause = String.Format("{0} AND FieldName = {1} AND FieldValue IN (", whereClause, myKVP.Key);
            foreach (string value in myKVP.Value)
            {
                whereClause = String.Format("{0}{1}'{2}'", whereClause, comma, value);
                comma = ",";
            }
            whereClause = String.Format("{0})", whereClause);
        }
    }

    var q = db.ProductDetail
              .Where (whereClause)
              .OrderBy ("ProductTypeName");
    return q;
} 
```

我现在不需要直接加入，而是需要通过另外 2 个表来正确应用过滤器。我试图弄清楚如何正确加入动态 LINQ 查询。在 TSQL 中，它类似于：

```
SELECT pd.* 
  FROM ProductDetail pd
 INNER JOIN ProductFilterAssignment pfa ON pd.ProductID = pfs.ProductID
 INNER JOIN ProductFilter pf ON pfs.FIlterID = pf.FIlterID
 WHERE pf.FieldName = 'var1' AND pf.FieldValue IN ('var1a','var1b','var1c',etc)
   AND pf.FieldName = 'var2' AND pf.FieldValue IN ('var2a','var2b','var2c',etc) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-11T22:24:09.843

哎哟。是的，这是一个复杂的要求。你知道，lambdas 是累积的，所以如果你使用连续的 linq 表达式，你可以更简单地做到这一点。请注意，后续的 linq 表达式正在使用先前的表达式结果，并且整个表达式在迭代之前不会实际执行。

```
public IOrderedQueryable<ProductDetail> GetProductList(string productGroupName, string productTypeName, Dictionary<string,List<string>> filterDictionary)
{
    // Initial select on productGroupName and productTypeName
    var products = from product in db.ProductDetail
                   where product.ProductGroupName == productGroupName && product.ProductTypeName == productTypeName
                   select product;

    // Now add each filter item present.
    foreach (KeyValuePair<string, List<string>> myKVP in filterDictionary)
    {
        products = from product in products
                   join pfa in db.ProductFilterAssignment on product.ProductID equals pfa.ProductID
                   join pf in db.Product on pfa.FilterID equals pf.FilterId
                   where pf.FieldName == myKVP.Key && myKVP.Value.Contains(pf.FieldValue)
                   select product;
    }

    return products.OrderBy ("ProductTypeName");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T21:12:07.433

我没有给你一个好的“答案”，但更多的是一个旁白。查看[LINQPad](http://www.linqpad.net/)。您甚至可能会在此页面的右侧看到广告。编写 LINQ 查询非常流畅。它可能有助于编写和验证此查询以及您编写的任何其他未来 LINQ 查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-12T15:36:03.437

尝试使用[Spolty 框架](http://code.spolty.com)。它有助于对 Linq To SQL 和实体框架进行动态查询。您可以动态创建左/内连接、添加条件、排序和其他内容。如果您使用 Spolty 框架，那么您的代码将如下所示：

```
public IQueryable<ProductDetail> GetProductList(string productGroupName, string productTypeName, Dictionary<string, List<string>> filterDictionary)
{
    // create root node 
    JoinNode productDetailNode = new JoinNode(typeof(ProductDetail));
    productDetailNode.AddConditions(new Condition("ProductGroupName", productGroupName),
                    new Condition("ProductTypeName", productTypeName));

    // if there are conditions than we create joins
    if (filterDictionary.Count > 0)
    {
        // create joinNode  
        // INNER JOIN ProductFilterAssignment pfa ON pd.ProductID = pfs.ProductID
        JoinNode productFilterAssignmentNode = new JoinNode(typeof(ProductFilterAssignment));
        productDetailNode.AddChildren(productFilterAssignmentNode);

        // create joinNode  
        // INNER JOIN ProductFilter pf ON pfs.FIlterID = pf.FIlterID
        JoinNode productFilterNode = new JoinNode(typeof(ProductFilter));
        productFilterNode.AddChildren(productFilterNode);

        foreach (KeyValuePair<string, List<string>> myKVP in filterDictionary)
        {
            // create condition pf.FieldName = {1} And AND pf.FieldValue IN ('var1a','var1b','var1c',etc)
            productFilterNode.AddConditions(new Condition("FieldName", myKVP.Key),
                                            OrCondition.Create("FieldValue", myKVP.Value.ToArray()));
        }
    }

    // create result query by JoinNode productDetailNode
    QueryDesigner queryDesigner = new QueryDesigner(db, productDetailNode).
                                        OrderBy(new Ordering("ProductTypeName"));

    return queryDesigner.Cast<ProductDetail>();
} 
```

# html - 带有长 URL 的 CSS 溢出

> ID：850055
> 
> 赞同：2
> 
> 时间：2009-05-11T21:00:21.573
> 
> 标签：html, css, width, overflow

好的，所以我在 160x600 容器中放置了谷歌广告。新广告在刷新时随机显示。当一个广告弹出一个不包含任何破折号或任何字符的长 URL 时，它会溢出容器 div。现在我有溢出：隐藏，所以在隐藏 160 像素之后的任何东西。问题是，如果有一个长 URL，其中一些会被隐藏（这很好），但广告上方的文本也会被隐藏而不是中断，因为它水平流出到 url 为止。

如何使文本符合并以 160 像素换行，即使我无法将其下方的 URL 换行？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-11T21:11:32.130

[对于支持](https://developer.mozilla.org/En/CSS/Word-wrap)[它](http://dev.opera.com/)的浏览器[，](http://msdn.microsoft.com/en-us/library/ms531186(VS.85).aspx) 自动[换行](http://www.w3.org/TR/css3-text/#word-wrap)：break-word;。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-11T21:05:19.693

我认为没有一种干净的 CSS 方法可以解决这个问题：[http ://www.w3schools.com/Css/pr_pos_overflow.asp](http://www.w3schools.com/Css/pr_pos_overflow.asp)

要解决此问题，您可以将 URL 放在其自己的 div 中并将溢出属性设置为隐藏。这将禁止 URL 超出容器，我不确定这是否是您想要的。

如果您使用的是 PHP，我发现这可以使您的文本连字符：

```
$t = preg_replace("/>(([[:alnum:]]+:\/\/)¦www\.)([^[:space:]]".
"{30,40})([^[:space:]]*)([^[:space:]]{10,20})([[:alnum:]#?\/&=])".
"</", ">\\1\\3...\\5\\6<", $t); 
```

（来自[http://www.webmasterworld.com/forum83/5762.htm](http://www.webmasterworld.com/forum83/5762.htm)）

**编辑**：还有很酷的[word-wrap](http://www.css3.info/preview/word-wrap/) css 属性，但大多数当前浏览器都不会处理它。

希望有帮助

* * *

此外，这有点像：[Using CSS, how can I split a string (eg a long URL) in a table cell?](https://stackoverflow.com/questions/138132/using-css-how-can-i-split-a-string-e-g-a-long-url-in-a-table-cell)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T21:02:58.323

您始终可以将 URL 放在单独的 DIV 中，然后将该 DIV 的溢出设置为隐藏。

# javascript - 是否可以检测用户是否在新选项卡中打开了链接？

> ID：850058
> 
> 赞同：35
> 
> 时间：2009-05-11T21:00:46.190
> 
> 标签：javascript, tabs

如果用户在您的网站上并在新选项卡中打开另一个链接（也指向您的网站），是否可以将此与仅正常单击该链接的用户区分开来？这可以在 javascript 中，在服务器上，等等。

我猜答案是你不能这样做，但我想仔细检查一下。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-05-11T21:05:56.383

你可以这样做：

```
if (history.length == 1) {  // Um, needs to be 0 for IE, 1 for Firefox
    // This is a new window or a new tab.
} 
```

可能还有其他方式`history.length`，`1`但我不知道它们可能是什么。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-11T21:38:24.100

除了 JavaScript 中的 history.length 之外，您还可以读取/写入窗口的名称。

因此，如果您检查它是否有名称 onload... 它*应该*在第一次加载时为空白... 如果您随后将其设置为“foo”... 在该窗口中的每个后续加载... name 属性将返回“foo”...除非您在新选项卡/窗口中打开链接...该新窗口不应设置名称。

（当然，除非您通过 window.open(url, name, features); 打开一个弹出窗口，它允许您预先设置名称）

```
<script>
 if(window.name == ''){
   //first load (or Nth load in a new Tab/Window)
   if(!SOME_VALUE_SET_FOR_2ND_TO_NTH_LOADS){
     //set name so we can catch new Tab/Window
     window.name = 'myWinName';
   } else {
     //we have a new Tab/Window (or something funky)
     alert('What?! One window not cool enough for ya?\n' +
       'Calling the InterWeb Police!');
   }
 } else if(window.name == 'myWinName'){
   //2nd-Nth load
   document.title = 'All is well... we think';
 }
</script> 
```

注意事项：

*   如果您的页面最初加载在一个已经有名称的窗口/框架中......事情会变得古怪
*   如果您的页面具有（命名的）iframe，并且您有任何指向这些 iframe 的链接，则 IE7/8 中存在一个错误，即当用户在新选项卡/窗口中打开这些链接时，新选项卡/窗口将“继承”最初针对的 iframe 的名称（非常奇怪的错误，没有预期的修复）

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-12-03T17:22:54.983

这是我在 ASP.NET MVC 中用来禁止经过身份验证的用户打开多个选项卡的方法：

```
<script language="javascript" type="text/javascript">
    @if(Request.IsAuthenticated)
    {
        <text>
        if (window.name != 'singleWindow') {
            window.location.href = "Content/ErrorPages/SingleTab.htm";
        } 
        </text>
    }
    else
    {
        <text>
        window.name = "singleWindow";
        </text>
    }
</script> 
```

基本上，这会在用户第一次访问登录页面时设置窗口名称。登录后，对于每个后续页面加载，都会测试窗口名称。

两个问题：

*   如果禁用 JavaScript，则无法正常工作
*   如果用户错误地关闭了原始选项卡，然后在地址栏中粘贴了指向我网站的其他链接，用户将始终收到错误页面。为了给用户一个恢复的机会，我在 SingleTab.htm 页面中包含了“注销”链接，这样用户就可以销毁他的会话 cookie 并开始一个新的会话。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-11T21:06:31.453

JavaScript 中的 window.opener 属性将指向打开新窗口的窗口。但是，它不区分新窗口和新选项卡。选项卡不是官方 W3C 规范的一部分，因此没有对它们的直接支持。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-11T21:06:20.627

最简洁的答案是不。长答案是，如果您正在从您的页面对服务器端方法进行 ajaxy 调用，这可能会使窗口保持打开状态（在短时间内调用）。这将是一个草率、不可靠的混乱，并且您无法区分新窗口或选项卡。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-11T21:05:20.957

我真的不这么认为。据我所知，最接近的方法是监视按键和鼠标点击事件，以尝试将操作与在新选项卡中打开链接的常用方法相匹配。（即，如果他们在单击或中键时按住 Command，则可能是一个新选项卡）。但这并不可靠，因为这些绑定中的任何一个都可以更改。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-11T21:09:22.510

这是客户端行为，所以我认为你可以用 javascript 做一些事情，比如检查浏览器历史记录，但是在新标签和新窗口之间是模棱两可的。

除此之外，并非所有浏览器都有选项卡，并且并非所有浏览器对选项卡的含义都相同（在某些过程中是不同的过程，而在另一些过程中则不是）。

但是，你为什么要检查呢？您的应用程序是否在新选项卡中执行真的很重要吗？我不这么认为...

# .net - 在不同的项目中调试 C# 到 Intel C++

> ID：850062
> 
> 赞同：1
> 
> 时间：2009-05-11T21:01:09.060
> 
> 标签：.net, c++, debugging

类似于这里的这个问题：

[关于 C# 调试的老问题](https://stackoverflow.com/questions/608553/c-debugging-across-dlls)

我正在尝试调试一个在多个项目中使用并在 Visual Studio 2008 中使用英特尔的 C++ v 11 编译器（即，不是标准编译器）编译的库。我用来调试的当前平台是一个 C# 程序，它调用通过 ap/invoke 的 C++ 方法。

有没有办法调试到 C++ 代码（已在调试模式下编译），而不是在 C++ 代码中启动一些巨大的循环并将调试器附加到进程中？现在，C# 代码只是跨过 C++ 调用。

我已经设置它以便我可以调试托管和非托管/本机代码，以及调试“不是我的代码”，但这些设置似乎并不重要。

我真的非常想避免将 C++ 项目添加到 C# 项目中；正如我所说，它是一个由多个程序调用的库，因此这样做会对其他程序和维护产生严重后果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-11T20:42:51.427

我记得在 WPF 开发的早期（项目本身，我当时在 MSFT），我们不得不使用两个调试器，用于本地代码的 WindDbg 和 .Net 独立调试器（不记得叫什么) 并在两者中设置断点。不确定VS是否支持这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-09-09T20:03:46.163

答案：为dll设置调试可执行文件和运行目录，然后尝试从dll作为单独的项目进行调试。也就是说，将 intel 项目加载到一个 sln 文件中，然后将 C# 项目放在另一个 sln 文件中。

然后，当您尝试通过 f5/调试按钮调试 dll 时，可执行文件将启动，并且代码将执行，直至您设置的任何断点。

确保有一个后期构建步骤将 dll 放入与 C# 可执行文件相同的目录中；否则，dll 将与实际运行的代码不同步，结果会很奇怪（即，断点不对齐等）。

此外，使用这种方法，您将失去编辑并继续（或者，如果有办法保留它，我不知道），但至少您可以调试。

（为@Dmitri Nesteruk 发布的答案）

# apache - 我可以做 http://pc_name 和 smb://pc_name... 来测试我的本地站点或使用共享资源。有什么类似的东西那么方便吗？

> ID：850063
> 
> 赞同：-3
> 
> 时间：2009-05-11T21:01:35.797
> 
> 标签：apache, url, testing, smb

在为 apache 或 SVN 测试我们的机器时，我发现我们实际上可以使用

[http://pc_name](http://pc_name)

当我们的计算机被命名为“pc_name”并且同一网络上的其他 PC 可以通过该 URL 在端口 80 访问该 PC。

Mac 可以通过 Finder -> Connect to Server -> smb://pc_name 连接到我的 PC 共享资源

这些很棒。有没有类似的东西很棒但我还没有发现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T06:19:16.120

[http://pc_name](http://pc_name)仅在网络中的 DNS 服务器处于活动状态且已将名称分配给名为“pc_name”的 pc 或修改了“hosts”文件时才有效。

也许还有很多事情你没有发现。您的问题不够具体，无法给出一个好的答案。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-05-12T12:01:54.803

[SSH](http://en.wikipedia.org/wiki/Secure_Shell)？

正如马丁所说：你的问题不够具体。

# version-control - 计划不周、分支和精神分裂的应用程序的版本号方案

> ID：850064
> 
> 赞同：5
> 
> 时间：2009-05-11T21:01:42.193
> 
> 标签：version-control, versioning

我正在为一个应用程序寻找一个版本编号方案/模式/系统，该应用程序当前分支为多个版本，具有[shell 游戏](http://en.wikipedia.org/wiki/Shell_game)风格的发布日期。这使版本控制成为一场噩梦。我只想使用典型的*Major.Minor.Revision*，但是这对我来说很快就会崩溃，就像这里目前的情况一样。

这是我的库存...

*   *1.0.0* - 生产版本。
*   *1.0.1* -带有错误修复的生产**版本。**
*   *1.1.0* - 具有新功能的生产**次要**版本将于 7 月到期（必须遵守法规）。
*   *1.2.0* - 生产**次要版本，具有与****尚未发布的仍在开发中的** *系统 A*集成的新功能。
*   *2.0.0* - 产品的开发**主要**版本“2.0”（代码迁移到更新的平台，提高了可用性）。

为了让它更有趣，他们正在计划另一个项目（新功能）以与不同的系统集成。

*   *1.3.0* - 生产**次要**版本，具有与*System B*集成的新功能。

更复杂的是，我们不确切知道何时（阅读：顺序）这些将“上线”。如果我们正在集成的其中一个系统出现延迟，则管理层会更改发布时间表。所以今天的 1.2.0 版本可能会延迟，然后我们标记为 1.3.0 的构建将首先下降。如果不在周期结束时更改版本标签，与 QA 协调已经很困难了。

问题？想法？毛茸茸的小动物？

和平|露水

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-11T21:14:28.477

在我看来，您不想专门使用版本号。您可以使用代号，（Windows 在每个版本发布之前都这样做了）。您基本上需要比数字更多的东西来区分您*所*谈论的分支。随着版本的发布，您可以在它们上贴上 Major.Minor.Revision 标记，但在此之前，您需要以可识别的方式命名它们。

将它们拆分为分支和子分支。确保任何依赖于更高分支的东西都有派生名称。因此，您可以调用 ProductionMac 分支和 ProductionWindows 分支，这样您会立即知道它们不会被合并，并且它们都来自生产。

要维护的最重要的事情是结构层次结构。版本号可以很好地做到这一点，但您必须不断添加“。” 对于每个新层，这很烦人且完全无法描述（很像命名变量 variableOne、variableTwo、variableThree）因此，请确保无论您选择如何标记每个分支，哪些分支与哪些其他分支相关仍然很明显。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-11T21:09:58.280

听起来数字不会有太大帮助，我会用小毛茸茸的动物来命名这些版本。

或者，以产生它的项目命名每个版本（“UI 大修”、“6 月维护”等），然后只在它上线时为其分配一个版本号？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T21:34:31.423

我会使用字典在内部开发编号和外部“发布”编号之间进行映射，然后在内部使用内部开发编号，并且仅在您准备将其从开发中发布时才公开“发布”编号。

如果您使用使用无理数的中间图，则可以加分。“版本 3.14159 的开发进展如何？” “哦，不错，但我仍在修复我们在 2.71828183 版本中发现的错误。” “什么？那个bug？应该在次要版本1.73205中修复！” :-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-11T21:40:27.730

正如其他人所建议的那样，在内部使用非数字代号，并在每个组件发布时应用一个数字。

将修订/内部版本号附加到版本控制可以帮助您将此内部代号与外部版本号匹配（并有助于与 QA 沟通）。

例如：
RegulationCompliance r1234 对应于版本 1.1.0.1234。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-12T13:53:08.483

这是我昨天在讨论这个问题时考虑的另一种选择。也许我需要重新考虑什么是*主要*的。与另一个系统集成可能是少量工作，但如果它以如此重要的方式影响调度和发布日期和版本，就像它在这里对我所做的那样，也许仅这一点就足以将分支提升到*主要*地位。然后我的一些头痛将被最小化。

无序发布版本的最可能场景围绕*次要*迭代展开。主要部门采取协调*的*、跨部门的努力。你可以在地平线上看到它们。*未成年*人偷偷靠近你，把一切都搞砸。

> “这是新的合规规定。如果它们在 7 月 15 日之前不生效，我们将被罚款 50 万美元。每天。”
> 
> “什么？你什么时候弄到这些的？”
> 
> “去年七月。你不是抄送了分发吗？”
> 
> ** 捂脸**

我仍然认为德文布的答案是最好的。但我想把这个扔在这里给其他陷入困境的人。

和平|露水

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-11T21:47:29.733

nth-ing 以前的帖子。

我们让我们的构建系统在每次构建之后增加构建号（无论是否要发布），这是开发/质量保证用来识别构建的。最终版本 # 仅在 QA 发布时向外界公开。所以确实有多个 1.3.0.x 版本，但只有一个真正的 1.3.0。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-11T21:39:05.503

根据您的描述，我同意前几篇文章。与范围/功能集相关的有意义的、唯一的名称可能是每个分支的方法。每个命名分支中的编号版本似乎是合理的。

您*真正*需要的……是 Gmail 样式的标签……用于您的版本控制！

# c# - 在 Using 语句中从 DataLayer 返回 DataReader

> ID：850065
> 
> 赞同：10
> 
> 时间：2009-05-11T21:02:28.417
> 
> 标签：c#, .net, database, .net-2.0

我们有很多数据层代码遵循这个非常普遍的模式：

```
public DataTable GetSomeData(string filter)
{
    string sql = "SELECT * FROM [SomeTable] WHERE SomeColumn= @Filter";

    DataTable result = new DataTable();
    using (SqlConnection cn = new SqlConnection(GetConnectionString()))
    using (SqlCommand cmd = new SqlCommand(sql, cn))
    {
        cmd.Parameters.Add("@Filter", SqlDbType.NVarChar, 255).Value = filter;

        result.Load(cmd.ExecuteReader());
    }
    return result;
} 
```

我认为我们可以做得更好一些。我现在的主要抱怨是它强制将所有记录加载到内存中，即使对于大型集合也是如此。我希望能够利用 DataReader 一次只在 ram 中保留一条记录的能力，但是如果我直接返回 DataReader，则在离开 using 块时连接将被切断。

如何改进这一点以允许一次返回一行？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-11T21:14:48.287

再一次，为这个问题构思我的想法的行为揭示了答案。具体来说，我写的最后一句“一次一行”。我意识到我并不在乎它是一个数据读取器，只要我可以逐行枚举它。这导致我这样做：

```
public IEnumerable<IDataRecord> GetSomeData(string filter)
{
    string sql = "SELECT * FROM [SomeTable] WHERE SomeColumn= @Filter";

    using (SqlConnection cn = new SqlConnection(GetConnectionString()))
    using (SqlCommand cmd = new SqlCommand(sql, cn))
    {
        cmd.Parameters.Add("@Filter", SqlDbType.NVarChar, 255).Value = filter;
        cn.Open();

        using (IDataReader rdr = cmd.ExecuteReader())
        {
            while (rdr.Read())
            {
                yield return (IDataRecord)rdr;
            }
        }
    }
} 
```

一旦我们移动到 3.5 并且可以开始在结果上使用其他 linq 运算符，这将工作得更好，我喜欢它，因为它让我们开始思考每一层之间的“管道”，用于返回大量的查询结果。

不利的一面是，对于持有多个结果集的读者来说会很尴尬，但这种情况非常罕见。

**更新**
自从我在 2009 年第一次开始使用这种模式以来，我了解到最好也将其设为通用`IEnumerable<T>`返回类型并添加一个`Func<IDataRecord, T>`参数以将 DataReader 状态转换为循环中的业务对象。否则，延迟迭代可能会出现问题，以至于您每次都看到查询中的最后一个对象。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-11T21:12:30.960

您想要的是受支持的模式，您必须使用

```
cmd.ExecuteReader(CommandBehavior.CloseConnection); 
```

`using()`并从您的 GetSomeData() 方法中删除两者。调用者必须提供异常安全性，以保证阅读器上的关闭。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-11T21:21:03.147

在这样的时代，我发现 lambdas 很有用。考虑到这一点，而不是数据层给我们数据，让我们给数据层我们的数据处理方法：

```
public void GetSomeData(string filter, Action<IDataReader> processor)
{
    ...

    using (IDataReader reader = cmd.ExecuteReader())
    {
        processor(reader);
    }
} 
```

然后业务层会调用它：

```
GetSomeData("my filter", (IDataReader reader) => 
    {
        while (reader.Read())
        {
            ...
        }
    }); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-14T07:25:48.777

关键是`yield`关键词。

与乔尔的原始答案类似，更加充实：

```
public IEnumerable<S> Get<S>(string query, Action<IDbCommand> parameterizer, 
                             Func<IDataRecord, S> selector)
{
    using (var conn = new T()) //your connection object
    {
        using (var cmd = conn.CreateCommand())
        {
            if (parameterizer != null)
                parameterizer(cmd);
            cmd.CommandText = query;
            cmd.Connection.ConnectionString = _connectionString;
            cmd.Connection.Open();
            using (var r = cmd.ExecuteReader())
                while (r.Read())
                    yield return selector(r);
        }
    }
} 
```

我有这个扩展方法：

```
public static void Parameterize(this IDbCommand command, string name, object value)
{
    var parameter = command.CreateParameter();
    parameter.ParameterName = name;
    parameter.Value = value;
    command.Parameters.Add(parameter);
} 
```

所以我打电话：

```
foreach(var user in Get(query, cmd => cmd.Parameterize("saved", 1), userSelector))
{

} 
```

这是完全通用的，适合任何符合 ado.net 接口的模型。[枚举集合后释放连接和读取器对象。](https://stackoverflow.com/q/1405877/661933)无论如何填充`DataTable`using`IDataAdapter`的`Fill`方法[可以比`DataTable.Load`](https://stackoverflow.com/questions/334658/is-datareader-quicker-than-dataset-when-populating-a-datatable)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-11T21:17:48.253

我从来都不是让数据层返回通用数据对象的忠实粉丝，因为这几乎消除了将代码分离到自己的层中的全部意义（如果未定义接口，您如何切换数据层？ ）。

我认为你最好的选择是让所有这样的函数返回你自己创建的自定义对象的列表，然后在你的数据中，你将你的过程/查询调用到数据读取器中，并遍历创建列表。

这将使其更容易处理（尽管最初是创建自定义类），更容易处理您的连接（因为您不会返回任何与之关联的对象），并且应该更快。唯一的缺点是所有内容都将像您提到的那样加载到内存中，但我认为这不会引起关注（如果是，我认为需要调整查询）。

# javascript - JavaScript - 覆盖或阻止执行

> ID：850090
> 
> 赞同：6
> 
> 时间：2009-05-11T21:06:51.560
> 
> 标签：javascript, jquery

我正在开发一个客户端项目，我必须包含他们的页眉和页脚，其中包括一些核心 JavaScript 文件。我在页面上有几个s，但它们的核心 JS 文件编码不佳，并且在尝试使用过滤器替换包含文件的标签`PNG`之前不检查 IE 7 。结果是，在 IE 7 中，我的所有图像都被替换为具有 default 的标签，从而在我的页面中的每个 png 图像之后导致换行。`IMG``.png``DIVS``AlphaImageLoader``.png``DIV``display: block`

我想做的是用更好的函数覆盖它们的函数，或者以某种方式阻止它们的执行，但是我不能修改 JS 文件本身，它既定义了函数又将其附加到窗口`onload`事件。我已经尝试在几个地方（标题、`/body`标签之前、in`$(document).ready`等）以相同的名称重新定义函数，但原始函数似乎总是在执行，大概是因为原始函数代码是与事件处理程序，而不仅仅是指向函数的指针。

有什么办法可以解决吗？有没有办法选择性地删除`onload`事件处理程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T21:11:07.357

如果这是唯一在负载下运行的东西，我认为你可以这样做

```
window.onload = null; 
```

如果还有其他东西在运行，我想你必须重新连接它们。我想它有点脆弱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T21:16:24.993

在 IE7 中，您可以使用 detachEvent 方法：-

```
window.detachEvent("load", fn) 
```

其中 fn 是附加的函数，但是由于此组合中有 jquery，因此要掌握附加的实际函数可能是一项艰巨的任务。附加的实际功能很可能是匿名的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T11:47:59.113

你知道替换 PNG 图像的函数的名称吗？如果是这样，您可以通过执行以下操作来覆盖现有功能：

```
// Assuming PNG function is called pngSwap
function pngSwap() {
    alert('png swap');              
}

$(document).ready(function() {
    if (window.pngSwap && window.pngSwap.constructor === Function) {
        var oldFunc = window.pngSwap;
        window.pngSwap = function() {
            alert('new png swap');
        }
    }

    pngSwap();
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T01:17:30.233

你试过使用`$(window).unbind("load")`吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-11T21:15:57.490

页眉和页脚之间的大 IFRAME 应该可以解决问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-11T21:27:23.040

好吧，根据它的绑定方式，您可能能够摆脱类似的情况：

```
window.onload = function(){
  var alert=function(a){
    console.log(a);
  }
  window.onload();
} 
```

显然，您希望重新定义警报以外的其他内容，但这可能会奏效。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-12T00:56:29.393

也许如果这就是它所做的一切，你可以编写一个函数来反转它，查找所有 png 图像并剥离 div，如果你想跳过某些图像，你可以为那些你想要区别对待的图像植入一个属性

另一种方法是通过不包含图像文件名的 png 部分来欺骗函数，并在加载时附加 .png（在它们的 onload 之后）

或者你可以用另一个标签替换你的 png 图像，并替换 onload

顺便说一句，如果你只是提醒window.onload，你可以确切地知道onload里面有什么，如果除了那个功能什么都没有，设置window.onload = null;

# wpf - 更新未实现 IObservable 集合的绑定

> ID：850096
> 
> 赞同：0
> 
> 时间：2009-05-11T21:08:58.750
> 
> 标签：wpf, data-binding

我正在尝试将列表框绑定到集合。问题是集合可以改变，但集合没有实现 IObservableCollection。强制绑定刷新的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T21:46:57.503

如果没有关于如何以及在何处使用此集合的更多信息，这里有一些可能会对您有所帮助的指针。

*   如果集合没有密封，您可以继承它。
*   如果集合是密封的，您可以创建一个包含集合实例并包装所有相关方法的适配器类。

在任何情况下，您的新类都可以实现`IObservableCollection`并用于绑定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T22:22:33.730

正如 Tormod 建议的那样，更可取的方法是将集合更改为 ObservableCollection，或者在集合中实现 INotifyCollectionChanged 将负责刷新 UI。

但是，如果这些选项不可用，那么您可以通过在包含该集合的任何类中使用 INotifyPropertyChanged 来“强制”刷新。然后我们将列表视为常规属性，并使用 setter 通知更改。为此，它需要重新分配引用，这就是为什么首选使用 ObservableCollection 之类的东西以及引发 PropertyChanged 事件的原因。

这是一个快速示例，展示了如何仅使用标准通用列表来完成此操作：

```
public partial class Window1 : Window, INotifyPropertyChanged
{
    public Window1()
    {
        InitializeComponent();
        this.Names = new List<string>() { "Mike", "Robert" };
        this.DataContext = this;
    }

    private IList<string> myNames;
    public IList<string> Names
    {
        get
        {
            return this.myNames;
        }
        set
        {
            this.myNames = value;
            this.NotifyPropertyChanged("Names");
        }
    }

    private void OnAddName(object sender, RoutedEventArgs e)
    {
        Names.Add("Kevin");
        Names = Names.ToList();
    }

    public event PropertyChangedEventHandler PropertyChanged;

    private void NotifyPropertyChanged(String info)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(info));
        }
    }
} 
```

xml:

```
<Window x:Class="Sample.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1"
    Height="300"
    Width="300">
<Grid>
    <StackPanel>
        <ListBox ItemsSource="{Binding Names}" />
        <Button Content="Add Name"
                Click="OnAddName" />
    </StackPanel>
</Grid> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T23:18:38.040

您可以将绑定设置为显式更新，然后通过代码触发更新，例如使用刷新按钮。

举个例子。

```
<StackPanel>
    <ListBox 
        x:Name="lb" 
        ItemsSource="{Binding SomeList, UpdateSourceTrigger=Explicit}" 
        />
    <Button Content="Refresh" Click="Refresh_Click" />
</StackPanel>

private void Refresh_Click(object sender, RoutedEventArgs e)
{
    BindingExpression be = lb.GetBindingExpression(ListBox.ItemsSourceProperty);
    be.UpdateSource();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T06:43:49.433

您还可以在 ViewModel 中强制刷新。这是我在他的 MVVM 演示应用程序中看到 Josh Smith 所做的事情：

```
ICollectionView coll = CollectionViewSource.GetDefaultView(myCollection);
if (coll!=null)
   coll.Refresh(); 
```

myCollection 可以是您绑定到视图的任何类型的集合。

Bea Stollnitz 有更多关于 CollectionViewSource 的信息： [http ://www.beacosta.com/blog/?m=200608](http://www.beacosta.com/blog/?m=200608)

# eclipse - GWT/Eclipse/Jetty 问题：Jasper 无法解析标记库

> ID：850108
> 
> 赞同：12
> 
> 时间：2009-05-11T21:11:57.497
> 
> 标签：eclipse, gwt, jetty, jstl, taglib

我正在尝试让 GWT Hosted 模式在 Eclipse 中工作，就像[这个 HOWTO 一样](http://blog.salvadordiaz.fr/2009/04/29/keep-your-source-tree-clean-gwt/)。Servlet 可以正常工作，我的 GWT 代码也是如此，但是我的所有 JSP 都失败了，因为出现以下错误：

```
[WARN] /view/lniExecutiveSummary.htm
org.apache.jasper.JasperException: /WEB-INF/jsp/lni/lniExecutiveSummary.jsp(1,1) The absolute uri: http://java.sun.com/jsp/jstl/fmt cannot be resolved in either web.xml or the jar files deployed with this application
    at org.apache.jasper.compiler.DefaultErrorHandler.jspError(DefaultErrorHandler.java:39)
    at org.apache.jasper.compiler.ErrorDispatcher.dispatch(ErrorDispatcher.java:409)
    [ trimmed ] 
```

这个 webapp 在 Tomcat 5x 下部署时工作正常；在 Eclipse 中运行时，我似乎无法让它解析标记库。我是 Eclipse 的新手，让它与 GWT+Maven 所需的所有移动部件一起工作让我大吃一惊。

**更新**：我不再使用 Eclipse；我已经切换（返回！）到 Intellij IDEA。所以我不能诚实地评估你们这些好心人发布的答案。一旦发生某些投票操作，或者其他人使用其中一种方法报告成功，我将接受适当的答案。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T21:52:24.640

您是否尝试`jsf-api.jar`在 Java 项目中将“”标记为“已导出”？
（如[该线程](http://dev.eclipse.org/newslists/news.eclipse.platform/msg32707.html)中所述）

> 1.) 进入 java-project 属性并将“ `jsf-api.jar`”标记为已导出。( `project>properties>java build path>order and exports`)
> 2.) 进入高级全局 tomcat 首选项并将您的项目添加到 tomcat 类路径 ( `windows>preferences>tomcat>advanced>add projects to tomcat classpath`)
> 
> 然后，再次尝试在 eclipse 下运行您的 webapp。

这是[**一篇**](http://wiki.hudson-ci.org/display/HUDSON/Setting+up+Eclipse+to+build+Hudson)描述相同过程/设置的文章，不是针对 JSF，而是针对 Hudson（虽然同样的问题）

您可以清楚地看到我上面提到的两个步骤：

[![](https://i.stack.imgur.com/xm5rm.png)](https://i.stack.imgur.com/xm5rm.png)
[（来源：[hudson-ci.org](http://wiki.hudson-ci.org/download/attachments/4161557/override.png)）]

[![](https://i.stack.imgur.com/2c5EJ.png)](https://i.stack.imgur.com/2c5EJ.png)
[（来源：[hudson-ci.org](http://wiki.hudson-ci.org/download/attachments/4161557/otherTips.png)）]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-10-22T06:46:07.180

在 Eclipse 项目类路径中添加 Jar 文件。如果你已经有了这个文件 tomcat lib. 此选项适用于您。如果您有 Eclipse Web 项目，第二个选项是在 Web-Inf lib 文件夹中添加 jar。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-09T20:37:00.453

> *这个 webapp 在 Tomcat 5x 下部署时工作正常；在 Eclipse 中运行时，我似乎无法让它解析标记库。我是 Eclipse 的新手，让它与 GWT+Maven 所需的所有移动部件一起工作让我大吃一惊。*

您显然有 JSTL JAR 文件`Tomcat/lib`而不是`WEB-INF/lib`. 您可以通过至少三种方式解决此问题：

1.  将 JSTL JAR 文件移动/复制到`WEB-INF/lib`.
2.  将 JSTL JAR 文件移动/复制到`Tomcat/lib`您的开发机器中。
3.  将包含 JSTL JAR 文件的正确 Tomcat 服务器与 Eclipse 中的 Web 项目相关联。如果尚未完成，请在`Servers`视图中添加 Tomcat 服务器。然后在项目属性中转到*Java Build Path* > *Libraries* > *Add Library* > *Server Runtime* > 选择有问题的服务器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-09T18:37:35.513

我感觉到你的痛苦。我经历了同样的痛苦，试图让 gwt、maven 和 eclipse 一起工作。

我已经能够使用以下 pom.xml 使其与 maven 一起使用。通过这种方式，您可以使用`mvn gwt:run`在托管模式下运行，但不幸的是，我永远无法获得`mvn gwt:eclipse`生成 Eclipse 启动运行时配置的 mvn 目标。

这是我的 pom.xml 中的相关片段。请注意，我发现在单独的位置安装 gwt 并指向 maven 使用它而不是让 mvn 从 repo 下载 gwt 更容易。mvn 依赖项中的“系统”级别范围是导致这种情况发生的原因。

```
 <properties>

      <!-- convenience to define GWT version in one place -->
      <gwt.version>1.7.1</gwt.version>
      <google.webtoolkit.home>${env.GWT_HOME}</google.webtoolkit.home>

      <!--  tell the compiler we can use 1.5 -->
      <maven.compiler.source>1.6</maven.compiler.source>
      <maven.compiler.target>1.6</maven.compiler.target>      

  </properties>

  <dependencies>

      <!--  GWT dependencies (from central repo) -->
    <dependency>
      <groupId>com.google.gwt</groupId>
      <artifactId>gwt-servlet</artifactId>
      <version>${gwt.version}</version>
      <scope>system</scope>
      <systemPath>${env.GWT_HOME}/gwt-servlet.jar</systemPath>
    </dependency>
    <dependency>
      <groupId>com.google.gwt</groupId>
      <artifactId>gwt-user</artifactId>
      <version>${gwt.version}</version>
      <scope>system</scope>
      <systemPath>${env.GWT_HOME}/gwt-user.jar</systemPath>
    </dependency>

    ... other dependencies...
  </dependencies>

  <build>
    <outputDirectory>war/WEB-INF/classes</outputDirectory>
    <plugins>
      <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>gwt-maven-plugin</artifactId>
        <version>1.1</version>
        <executions>
          <execution>
            <goals>
              <goal>compile</goal>
              <goal>generateAsync</goal>
              <goal>test</goal>
            </goals>
          </execution>
        </executions>
        <configuration>
            <runTarget>com.gwt.example/Application.html</runTarget>
            <extraJvmArgs>-Xmx512m</extraJvmArgs>
        </configuration>
      </plugin>
      <!--
          If you want to use the target/web.xml file mergewebxml produces,
          tell the war plugin to use it.
          Also, exclude what you want from the final artifact here.
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-war-plugin</artifactId>
                <configuration>
                    <webXml>target/web.xml</webXml>
                    <warSourceExcludes>.gwt-tmp/**</warSourceExcludes>
                </configuration>
            </plugin>
            -->

      <plugin>
          <groupId>org.apache.maven.plugins</groupId>
          <artifactId>maven-compiler-plugin</artifactId>
          <version>2.0.2</version>
          <configuration>
            <source>${maven.compiler.source}</source>
            <target>${maven.compiler.target}</target>
            <module>com.gwt.example</module>
          </configuration>
      </plugin>
    </plugins>

    ...rest of pom.xml... 
```

我成功使用的另一种技术是使用 eclipse [google gwt 插件](http://code.google.com/eclipse/)。只需使用向导创建一个新的 gwt 项目，确保您可以从 eclipse 运行它，然后使用您自己的代码进行修改。

# javascript - jQuery AJAX 和处理不同的数据类型

> ID：850113
> 
> 赞同：11
> 
> 时间：2009-05-11T21:13:05.280
> 
> 标签：javascript, jquery, ajax

我正在使用 ASP.Net MVC，但这适用于任何框架。

我正在对我的服务器进行 Ajax 调用，大多数情况下它会返回普通的旧 HTML，但是如果出现错误，我希望它返回一个带有状态消息（以及其他一些东西）的 JSON 对象。`dataType`jQuery 调用中的选项似乎没有办法很好地处理这个问题。默认情况下，它似乎将所有内容解析为 html，从而导致`<div>`填充`"{ status: 'error', message: 'something bad happened'}"`.

[编辑] 忽略`dataType`对象并让 jQuery 弄清楚也不起作用。它将结果的类型视为 a`string`并将其视为 HTML。

我想出的一种解决方案是尝试将结果对象解析为 JSON。如果可行，我们就知道它是一个 JSON 对象。如果它抛出一个异常，它是 HTML：

```
$.ajax({
    data: {},
    success: function(data, textStatus) {
        try {
            var errorObj = JSON.parse(data);
            handleError(errorObj);
        } catch(ex) {
            $('#results').html(data);
        }
    },
    dataType: 'html', // sometimes it is 'json' :-/
    url: '/home/AjaxTest',
    type: 'POST'
}); 
```

然而，以这种方式使用异常让我觉得设计很糟糕（至少可以说是不直观的）。有没有更好的办法？我曾想过将整个响应包装在一个 JSON 对象中，但在这种情况下，我认为这不是一个选择。

这是我从史蒂夫威尔科克那里得到的解决方案：

```
// ASP.NET MVC Action:
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult AjaxTest(int magic) {
    try {
        var someVal = GetValue();
        return PartialView("DataPage", someVal);
    } catch (Exception ex) {
        this.HttpContext.Response.StatusCode = 500;
        return Json(new { status = "Error", message = ex.Message });
    }
}

// jQuery call:

$.ajax({
    data: {},
    success: function(data, textStatus) {
        $('#results').html(data);
    },
    error: function() {
        var errorObj = JSON.parse(XMLHttpRequest.responseText);
        handleError(errorObj);
    },
    dataType: 'html',
    url: '/home/AjaxTest',
    type: 'POST'
}); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-11T21:42:07.713

对于您的 JSON 错误，您可以从服务器返回 500 状态代码而不是 200。然后 jquery 客户端代码可以使用 $.ajax 函数上的 error: 处理程序进行错误处理。在 500 响应中，您可以从 responseText 解析 JSON 错误对象，在 200 响应中，您可以像往常一样将 HTML 放入 div 中。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-11T21:31:32.613

虽然史蒂夫的想法很好，但为了完整起见，我将其添加进去。

看来，如果您指定 json 的 dataType 但返回 HTML，则 jQuery 可以很好地处理它。

我用以下代码测试了这个理论：

```
if($_GET['type'] == 'json') {
    header('Content-type: application/json');
    print '{"test":"hi"}';
    exit;
} else {
    header('Content-type: text/html');
    print '<html><body><b>Test</b></body></html>';
    exit;
} 
```

这`$_GET['type']`只是为了让我可以控制测试时返回的内容。在你的情况下，你会根据事情是对还是错来返回一个或另一个。过去，使用这个 jQuery 代码：

```
$.ajax({
    url: 'php.php?type=html', // return HTML in this test
    dataType: 'json',
    success: function(d) {
        console.log(typeof d); // 'xml'
    }
}); 
```

即使我们将 JSON 指定为 dataType，jQuery (1.3.2) 发现它并非如此。

```
$.ajax({
    url: 'php.php?type=json',
    dataType: 'json',
    success: function(d) {
        console.log(typeof d); // 'object'
    }
}); 
```

所以你可以利用这个（据我所知）无证行为来做你想做的事。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-11T21:50:02.520

但是为什么不只返回 JSON 而不管 POST 上的状态（成功或错误）并使用 GET 来显示结果？
如果你问我，这似乎是一个更好的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-26T19:32:04.967

或者，您总是可以返回一个 JSON 响应，并将一个参数作为 HTML 内容。

就像是：

```
{
     "success" : true,
     "errormessage" : "",
     "html" : "<div>blah</div>",
} 
```

我认为您只需要在 html 值中转义双引号，json 解析器就会为您撤消该操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-03-06T19:31:32.960

我遇到了与 MVC/Ajax/JQuery 完全相同的问题，并且想要使用多个数据类型（JSON 和 HTML）。我有一个 AJAX 请求使用 HTML 数据类型返回数据，但我尝试将从 ajax 请求返回的数据转换为 JSON 对象。我有一个这样的函数，可以从我的成功回调中调用：

```
 _tryParseJson: function (data) {
        var jsonObject;

        try {
            jsonObject = jQuery.parseJSON(data);
        }
        catch (err) {
        }

        return jsonObject;
    } 
```

然后我假设如果 jsonObject 和 errorMessage 属性存在，则发生错误，否则不会发生错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-05-19T02:53:59.590

我仅通过使用 ajax 成功和错误回调来实现这一点。这样我就可以得到来自服务器的混合字符串和 json 对象响应。

下面我准备接受 json，但是如果我得到“parsererror”的状态（意味着 jquery 无法将传入的代码解析为 json，因为这是我所期望的），但它的请求状态为“OK”（ 200），然后我将响应作为字符串处理。除了“parsererror”和“OK”之外的任何事情，我都作为错误处理。

```
$.ajax({
    dataType: 'json',
    url: '/ajax/test',
    success: function (resp) {
      // your response json object, see if status was set to error
      if (resp.status == 'error') {
        // log the detail error for the dev, and show the user a fail
        console.log(resp);
        $('#results').html('error occurred');
      }
      // you could handle other cases here
      // or use a switch statement on the status value
    },
    error: function(request, status, error) {
      // if json parse error and a 200 response, we expect this is our string
      if(status == "parsererror" && request.statusText == "OK") {
        $('#results').html(request.responseText);
      } else {
        // again an error, but now more detailed and not a parser error
        // and we'll log for dev and show the user a fail
        console.log(status + ": " + error.message);
        $('#results').html('error occurred');
      }
    }
  }); 
```

# python - 将数千条记录插入表中的最有效方法是什么（MySQL，Python，Django）

> ID：850117
> 
> 赞同：12
> 
> 时间：2009-05-11T21:13:26.747
> 
> 标签：python, sql, mysql, django, insert

我有一个带有唯一字符串字段和几个整数字段的数据库表。字符串字段的长度通常为 10-100 个字符。

每分钟左右一次我有以下情况：我收到与表的记录结构相对应的 2-10000 个元组的列表，例如

```
[("hello", 3, 4), ("cat", 5, 3), ...] 
```

我需要将所有这些元组插入到表中（假设我验证了这些字符串都没有出现在数据库中）。为了澄清起见，我使用的是 InnoDB，并且我有一个用于该表的自动增量主键，该字符串不是 PK。

我的代码当前遍历这个列表，为每个元组创建一个具有适当值的 Python 模块对象，并调用“.save()”，如下所示：

```
@transaction.commit_on_success
def save_data_elements(input_list):
    for (s, i1, i2) in input_list:
        entry = DataElement(string=s, number1=i1, number2=i2)
        entry.save() 
```

这段代码目前是我系统中的性能瓶颈之一，所以我正在寻找优化它的方法。

例如，我可以生成每个包含 100 个元组的 INSERT 命令的 SQL 代码（“硬编码”到 SQL 中）并执行它，但我不知道它是否会改进任何东西。

您对优化这样的流程有什么建议吗？

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-11T21:16:21.703

特别是对于 MySQL，加载数据的最快方法是使用[LOAD DATA INFILE](http://dev.mysql.com/doc/refman/5.1/en/load-data.html)，因此如果您可以将数据转换为预期的格式，它可能是将其放入表中的最快方法。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-11T21:16:29.580

您可以将行写入格式为“field1”、“field2”、.. 的文件，然后使用 LOAD DATA 加载它们

```
data = '\n'.join(','.join('"%s"' % field for field in row) for row in data)
f= open('data.txt', 'w')
f.write(data)
f.close() 
```

然后执行这个：

```
LOAD DATA INFILE 'data.txt' INTO TABLE db2.my_table; 
```

[参考](http://dev.mysql.com/doc/refman/5.1/en/load-data.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-11T21:51:33.843

如果你没有`LOAD DATA INFILE`像其他一些建议提到的那样，你可以做两件事来加快你的插入速度：

1.  使用准备好的语句——这减少了为每次插入解析 SQL 的开销
2.  在单个事务中执行所有插入 - 这需要使用支持事务的数据库引擎（如 InnoDB）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-12T01:08:52.603

如果你可以做一个手卷`INSERT`声明，那么这就是我要走的路。具有多个值子句的单个语句`INSERT`比许多单独的语句要快得多`INSERT`。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-12T06:38:43.810

无论使用哪种插入方法，您都需要使用 InnoDB 引擎来实现最大的读/写并发。MyISAM 将在插入期间锁定整个表，而 InnoDB（在大多数情况下）只会锁定受影响的行，从而允许 SELECT 语句继续执行。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-11T21:16:10.610

你收到什么格式？如果它是一个文件，你可以做某种批量加载：[http ://www.classes.cs.uchicago.edu/archive/2005/fall/23500-1/mysql-load.html](http://www.classes.cs.uchicago.edu/archive/2005/fall/23500-1/mysql-load.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-12T02:23:39.483

这与将数据实际加载到数据库中无关，但是......

如果向用户提供“数据正在加载...加载将很快完成”类型的消息是一个选项，那么您可以在不同的线程中异步运行 INSERT 或 LOAD DATA。

只是要考虑其他事情。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-12T09:14:03.200

我不知道确切的细节，但你可以使用 json 样式的数据表示并将其用作固定装置或其他东西。我在 Douglas Napoleone 的 Django Video Workshop 上看到了类似的东西。[请参阅http://www.linux-magazine.com/online/news/django_video_workshop](http://www.linux-magazine.com/online/news/django_video_workshop)上的视频。和[http://www.linux-magazine.com/online/features/django_reloaded_workshop_part_1](http://www.linux-magazine.com/online/features/django_reloaded_workshop_part_1)。希望这个有帮助。

希望你能解决。我刚开始学习 django，所以我可以为您指出资源。

# actionscript-3 - 编写一个按钮到它的翻转状态？

> ID：850120
> 
> 赞同：1
> 
> 时间：2009-05-11T21:14:39.553
> 
> 标签：actionscript-3

任何人都知道是否可以通过 AS3 将按钮更改为滚动状态，而实际上它没有滚动？

客户决定在流程后期要求一些其他元素来影响按钮状态。如果我知道我会使用影片剪辑而不是按钮。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T21:20:20.150

手动调度翻转事件？除此之外，我看不到任何其他方式。不过，我很好奇，什么样的要求会要求如此奇怪。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T01:05:59.940

您是否尝试过手动调用 gotoAndStop(2) ？

如果上述解决方案都不起作用，您要么必须继承 SimpleButton 并将其链接到您的符号，要么在 MovieClips 中重建

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-21T08:12:21.130

您可以打开任何库显示对象的属性并将其更改为按钮、图形或影片剪辑类型。这应该允许您将实例类型更改为按钮并保留翻转功能，同时允许对实例执行“gotoAndStop”操作。我不完全确定这是否有效，而且这个线程很旧，但如果有人遇到同样的问题，那值得一试。这是假设您没有动态创建 SimpleButtons。

# ssas - 在 PerformancePoint 记分卡中导入 Analysis Services 2008 KPI

> ID：850134
> 
> 赞同：1
> 
> 时间：2009-05-11T21:18:10.153
> 
> 标签：ssas, performancepoint

我正在尝试将 KPI 从 Analysis Services 导入 PerformancePoint 记分卡，当我这样做时，仪表板设计器会引发错误：

> 出现未知错误。如果问题仍然存在，请联系管理员。服务器应用程序事件日志中可能有其他信息。

当我检查事件日志时，我发现以下异常：

```
System.IO.FileNotFoundException: Could not load file or assembly 'Microsoft.AnalysisServices, Version=9.0.242.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91' or one of its dependencies. The system cannot find the file specified.
File name: 'Microsoft.AnalysisServices, Version=9.0.242.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91'
   at Microsoft.PerformancePoint.Scorecards.Server.ImportExportHelper.GetImportableAsKpis(IBpm pmService, DataSource asDataSource)
   at Microsoft.PerformancePoint.Scorecards.Server.PmServer.GetImportableAsKpis(DataSource dataSource) 
```

我发现[此线程](http://social.technet.microsoft.com/Forums/en-US/ppsmonitoringandanalytics/thread/433ebc3e-1c6d-4918-acb9-22e4f1ba0a99)建议重新安装 Microsoft ADOMD.NET，但安装程序将无法运行，因为服务器已经有更新版本的产品（服务器正在运行 SQL Server Analysis Services 2008，其中包括 Microsoft.AnalysisServices.AdomdClient。 dll 版本 9.0.3042.0)

任何人有任何想法（自己找到DLL并将其手动安装到GAC）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-31T15:58:57.957

[我相信您需要SQL Server 2005 Feature Pack](http://tinyurl.com/r2pw82)中的 SQLServer2005_ASOLEDB9 文件。如果这对您不起作用，您可以从现有的 2005 安装中获取 DLL 并使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T04:53:10.163

我确实安装了 SQLServer2005_ASOLEDB9 。它仍然不起作用。我的问题是我无法从一个数据库中导入 KPI。在同一台服务器上，我可以从剩余的数据库中导入 kpi。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-04-07T20:11:28.270

[http://macraem.wordpress.com/2010/08/25/issues-importing-ssas-2008-kpis-into-performancepoint-2007/](http://macraem.wordpress.com/2010/08/25/issues-importing-ssas-2008-kpis-into-performancepoint-2007/)

> In .NET we can redirect the assembly bindings in the web.config. I added the following to the Web.Config file for the PPS Monitoring WebService which Dashboard Designer uses to connect to SSAS:

`<runtime> <assemblyBinding xmlns=”urn:schemas-microsoft-com:asm.v1″&gt; <dependentAssembly> <assemblyIdentity name=”Microsoft.AnalysisServices” publicKeyToken=”89845dcd8080cc91″ culture=”neutral” /> <bindingRedirect oldVersion=”9.0.242.0″ newVersion=”10.0.0.0″/>
</dependentAssembly> </assemblyBinding> </runtime>`

# asp.net - 如何通过 ASP.NET（最好是 VB）在 Twitter 上发布一个简单的帖子？

> ID：850137
> 
> 赞同：4
> 
> 时间：2009-05-11T21:18:37.860
> 
> 标签：asp.net, api, twitter

除了每天通过我的网站发布一次之外，我不想在 Twitter 上做任何花哨的事情。我搜索了一下，有各种超级复杂的方法来做 Twitter 所做的每一件小事，但似乎很少有关于如何做最简单的事情的文档，那就是发帖！

有谁知道如何做到这一点？或者你至少能给我指出正确的方向吗？我不需要完整的包装器或任何东西（[http://apiwiki.twitter.com/Libraries#C/NET](http://apiwiki.twitter.com/Libraries#C/NET)），只需一个简单的函数即可发布到 Twitter。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-11T22:42:54.620

这是有史以来最简单的实现。在 2 分钟内启动并运行：[Twitterizer](http://www.twitterizer.net/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T21:40:49.790

有几种不同的方法可以做到这一点，它们会根据您想要使用和访问的工具而有所不同。选项 1 开箱即用，但编码可能很复杂。选项 3 您必须下载工具，但一旦安装并加载，您应该能够非常快速地使用 twitter api。

1.  使用 WebRequest.Create 创建/发送消息到远程端点
2.  使用 WCF，创建镜像端点并使用仅客户端端点访问 twitter api。
3.  使用[WCF REST Starter Kit Preview 2](http://aspnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24644)，它有一个名为 HttpClient 的新类。如果可以的话，我将不得不推荐这种技术。[这是一个在 3 分钟内使用 REST Twitter 源](http://www.pluralsight.com/main/screencasts/screencast.aspx?id=httpclient-consuming-twitter-in-under-3-minutes)的精彩视频。

以下是使用 WCF REST Starter Kit 的 HttpClient 的示例：

```
 public void CreateFriendship(string friend)
    {
        using (var client = new HttpClient())
        {
            var url = string.Format("http://www.twitter.com/friendships/create/{0}.xml?follow=true", friend);
            client.Post(url)
                .CheckForTwitterError()
                .EnsureStatusIs(HttpStatusCode.OK);
        }
    } 
```

如果您想了解有关特定方法的更多信息，请添加评论。

**更新：**

对于选项 #1，请参阅此问题：[Remote HTTP Post with C#](https://stackoverflow.com/questions/547347/remote-http-post-with-csharp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T21:45:34.900

它相当简单；您只需使用 webrequest.create 将 xml 文件发布到网页。这个例子很接近（假设你在另一个地方有消息的 xml，只是将它作为字符串传递给 twitterxml 变量。url 可能不是正确的；在定义接口的这个 [page][1] 上找到它

```
WebRequest req = null;
   WebResponse rsp = null;
   try
   {
    string twitterXML = "xml as string";
    string uri = "http://twitter.com/statuses/update.format";
    req = WebRequest.Create(uri);
    //req.Proxy = WebProxy.GetDefaultProxy(); // Enable if using proxy
    req.Method = "POST";        // Post method
    req.ContentType = "text/xml";     // content type
    // Wrap the request stream with a text-based writer
    StreamWriter writer = new StreamWriter(req.GetRequestStream());
    // Write the XML text into the stream
    writer.WriteLine(twitterXML);
    writer.Close();
    // Send the data to the webserver
    rsp = req.GetResponse();

   } 
```

[1]：[http](http://apiwiki.twitter.com/Twitter-REST-API-Method%3A-statuses) ://apiwiki.twitter.com/Twitter-REST-API-Method%3A-statuses 更新

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T19:12:30.300

有几种方法可以做到这一点，你可以看看[http://restfor.me/twitter](http://restfor.me/twitter)它将为您提供 RESTful 文档中的代码。

基本上进行任何经过身份验证的调用，您都可以遵循以下逻辑：

```
 /// 
        /// Executes an HTTP POST command and retrives the information.     
        /// This function will automatically include a "source" parameter if the "Source" property is set.
        /// 
        /// The URL to perform the POST operation
        /// The username to use with the request
        /// The password to use with the request
        /// The data to post 
        /// The response of the request, or null if we got 404 or nothing.
        protected string ExecutePostCommand(string url, string userName, string password, string data) {
            WebRequest request = WebRequest.Create(url);
            request.ContentType = "application/x-www-form-urlencoded";
            request.Method = "POST";
            if (!string.IsNullOrEmpty(userName) && !string.IsNullOrEmpty(password)) {
                request.Credentials = new NetworkCredential(userName, password);

                byte[] bytes = Encoding.UTF8.GetBytes(data);

                request.ContentLength = bytes.Length;
                using (Stream requestStream = request.GetRequestStream()) {
                    requestStream.Write(bytes, 0, bytes.Length);

                    using (WebResponse response = request.GetResponse()) {
                        using (StreamReader reader = new StreamReader(response.GetResponseStream())) {
                            return reader.ReadToEnd();
                        }
                    }
                }
            }

            return null;
        } 
```

# c++ - 需要帮助创建对象数组

> ID：850142
> 
> 赞同：2
> 
> 时间：2009-05-11T21:21:02.567
> 
> 标签：c++

我正在尝试创建一个采用整数参数的类对象数组。我看不出这个简单的小代码有什么问题。有人可以帮忙吗？

```
#include <fstream>
#include <iostream>
using namespace std;

typedef class Object
{
 int var;
public:
 Object(const int& varin) : var(varin) {}
} Object;

int main (int argc, char * const argv[])
{
 for(int i = 0; i < 10; i++)
 {
  Object o(i)[100];
 }

 return 0;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-11T21:24:41.517

在 C++ 中， es 和s不需要`typedef`s 。所以：`class``struct`

```
class Object
{
 int var;
public:
 Object(const int& varin) : var(varin) {}
}; 
```

此外，描述性名称总是可取的，`Object`被滥用了。

```
int main (int argc, char * const argv[])
{
 int var = 1;

 Object obj_array[10]; // would work if Object has a trivial ctor

 return 0;
} 
```

否则，在您的情况下：

```
int main (int argc, char * const argv[])
{
 int var = 1;

 Object init(var);
 Object obj_array[10] = { var, ..., var }; // initialize manually

 return 0;
} 
```

虽然，你真的应该寻找`vector`

```
#include <vector>
int main (int argc, char * const argv[])
{
 int var = 1;

 vector<Object> obj_vector(10, var); // initialize 10 objects with var value

 return 0;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-11T22:46:12.880

dirkgently 的概要是 C++ 中项目数组的相当准确的表示，但是他用相同的值初始化数组中的所有项目，看起来你正在尝试用不同的值初始化每个项目。

要回答您的问题，请创建一个采用 int 构造函数参数的对象数组。您不能，在分配数组时创建对象，并且在没有简单的构造函数的情况下，您的编译器会抱怨。但是，您可以初始化指向对象的指针数组，但使用向量确实可以获得更多的灵活性，因此我的以下示例将使用 std::vector。

如果您希望每个对象具有不同的值，则需要分别初始化每个对象，您可以通过以下两种方式之一来执行此操作；在堆栈上或堆上。让我们先看看栈上。

任何采用单个参数且未标记为`explicit`的构造函数都可以用作隐式构造函数。这意味着在任何需要该类型对象的地方，您都可以使用单参数类型的实例。在这个例子中，我们创建了一个 Object 类的向量并向其中添加 100 个对象（push_back 将项目添加到向量中），我们将一个整数传递给 push_back，它会隐式创建一个传入整数的 Object。

```
#include <vector>
int main() {
    std::vector<Object> v;

    for(int i = 0; i < 100; i++) {
        v.push_back(i);
    }
} 
```

或者说清楚一点：

```
#include <vector>
int main() {
    std::vector<Object> v;

    for(int i = 0; i < 100; i++) {
        v.push_back(Object(i));
    }
} 
```

在这些示例中，所有 Object 对象都在 for 循环范围内的堆栈上分配，因此当对象被推入向量时会发生副本。复制大量对象可能会导致一些性能问题，尤其是当您的对象复制成本很高时。

解决此性能问题的一种方法是在堆上分配对象并将指针存储到向量中的对象：

```
#include <vector>
int main() {
    std::vector<Object*> v;

    for(int i = 0; i < 100; i++) {
        v.push_back(new Object(i));
    }

    for(int i = 0; i < 100; i++) {
        delete v[i];
    }
} 
```

由于我们的对象是在堆上创建的，我们需要确保删除它们以调用它们的解构函数并释放它们的内存，这段代码在第二个循环中执行此操作。

手动调用`delete`有它自己的警告，如果您将这些指针传递给其他代码，您可以快速跟踪谁拥有指针以及谁应该删除它们。解决这个问题的一个更简单的方法是使用智能指针来跟踪指针的生命周期，查看其中一个`boost::shared_ptr`或`tr1::shared_ptr`哪些是引用计数指针：

```
#include <vector>
int main() {
    std::vector<shared_ptr<Object> > v;

    for(int i = 0; i < 100; i++) {
        Object* o = new Object(i);
        v.push_back(shared_ptr<Object>(o));
    }
} 
```

您会注意到 shared_ptr 构造函数是显式的，这是故意这样做的，以确保开发人员有意将其指针填充到共享指针中。当一个对象的所有引用都被释放时，该对象将被 shared_ptr 自动删除，让我们不必担心它的生命周期。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T11:41:10.930

如果要坚持使用数组，则必须手动初始化或使用默认构造函数。但是，您可以通过使用默认参数创建构造函数来获得一些控制。这将被编译器视为默认构造函数。例如，以下代码按顺序打印出数字 0、...、9。（但是，我不确定标准是否规定数组中的对象必须按顺序构造。它可能取决于实现，在这种情况下，数字可能以任意顺序出现。）

```
#include <iostream>

using namespace std;

struct A {
   int _val;

   A(int val = initializer()) : _val(val) {}

   static int initializer() { static int v = 0;  return v++; }
};

int main()
{
   A a[10];
   for(int i = 0; i < 10; i++)
      cout << a[i]._val << endl;
} 
```

# java - 合并 Spring 和 Grails 项目

> ID：850145
> 
> 赞同：3
> 
> 时间：2009-05-11T21:21:46.093
> 
> 标签：java, spring, maven-2, grails, gant

我们正在使用 Spring 和 Maven 作为配置管理器开发后台应用程序。该项目更分为两部分，其中一个部分仅用于管理数据库表中的数据。

现在有人发现了Grails，有了Grails，这项工作很容易，但我们不能放弃所有工作而开始一个新项目（其他部分就可以了）。

有了这个，我们正在尝试合并两者。我们已经配置了 maven grails 插件，现在我们可以获取依赖项并运行 grails 任务，虽然还不完美，但差不多。我们遇到的*最大*问题是项目的第一部分（Spring 部分）的目录结构与使用 Grails 的目录结构有点不同。我们想改变 Grails 部分的结构，但我们真的不知道该怎么做。我们怀疑我们必须使用（G）ant的一些脚本来改变目录结构，但是我们不知道*首先*，如何制作脚本，*其次*，如何在Maven中使用它，最后合并两个部分. 两部分的库是兼容的，因此将所有东西放在一起是可行的。

我不是在等待**答案**，但与 gant 脚本和 maven 相关的东西会很棒。

作为第二个问题，有没有人试图做这样的事情？（用一个 grails 项目合并或*扩展*一个普通的 spring 项目？）

谢谢大家。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T21:45:21.960

我发现[Mastering Grails是一个很好的应用程序演示，比](http://www.ibm.com/developerworks/views/java/libraryview.jsp?search_by=mastering+grails)*Hello World*复杂一点！.

[在Grails 和遗留数据库](http://www.ibm.com/developerworks/java/library/j-grails07158/index.html?S_TACT=105AGX02&S_CMP=EDU)中描述了在现有 Java 类之上“拍打”Grails 应用程序。

高温高压

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T21:30:06.953

你想要这个`grails-app/conf/Config.groovy`文件。

在其中，添加或设置`grails.config.locations { }`您想要将 spring 应用程序与主 gails 应用程序合并的位置。

# sql-server-2005 - 创建表命令后授予用户插入权限

> ID：850147
> 
> 赞同：8
> 
> 时间：2009-05-11T21:22:58.993
> 
> 标签：sql-server-2005, tsql

在创建表命令后授予特定用户仅插入权限的 T-SQL 语法是什么？

这是我的`CREATE TABLE`脚本：

```
CREATE TABLE [dbo].[MyTable] (
    [MyColumn1] [uniqueidentifier] NOT NULL,
    [MyColumn2] [char] (1) NULL
) ON [PRIMARY] 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-11T21:25:23.573

```
GRANT INSERT ON [dbo].[MyTable] TO BillyBob 
```

或者类似的东西...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-12-09T21:26:06.137

这对我有用...注意用户组上使用的方括号，没有它们就不起作用（因为斜线）。

```
USE AutoX
GRANT INSERT ON [dbo].[TBL_AUTOX_USER_ACTIVITY] TO [NAM\APP_AUTOX_USERS] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T21:28:22.587

像这样的东西：

```
USE AdventureWorks;
GRANT INSERT ON OBJECT::Person.Address TO RosaQdM;
GO 
```

请参阅[此处](http://msdn.microsoft.com/en-us/library/ms188371.aspx)了解更多信息。

# java - 通过反射访问Java静态最终变量值

> ID：850148
> 
> 赞同：32
> 
> 时间：2009-05-11T21:23:02.050
> 
> 标签：java, reflection

Java静态最终类变量的值可以通过反射检索吗？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-05-11T21:24:45.917

~~我猜这取决于类型和编译器~~（再想一想，最好不要！）。Sun 的编译器内联原始常量，但我不知道它们是否完全从类中删除了条目。我会查明真相的。

**编辑：**是的，即使它们是内联的，您仍然可以访问它们。测试类：

```
public class ReflectionConstantTest {
    private static final int CONST_INT = 100;
    private static final String CONST_STRING = "String";
    private static final Object CONST_OBJECT = new StringBuilder("xyz");
    public static void main(String[] args) throws Exception {
        int testInt = CONST_INT;
        String testString = CONST_STRING;
        Object testObj = CONST_OBJECT;
        for (Field f : ReflectionConstantTest.class.getDeclaredFields()) {
            f.setAccessible(true);
            System.out.println(f.getName() + ": " + f.get(null));
        }
    }
} 
```

输出：

```
常量_INT：100
CONST_STRING：字符串
CONST_OBJECT: xyz

```

`javap -c`输出：

```
编译自“ReflectionConstantTest.java”
公共类从头开始.ReflectionConstantTest 扩展 java.lang.Object{
public scratch.ReflectionConstantTest();
  代码：
   0：aload_0
   1：调用特殊#1；//方法 java/lang/Object."":()V
   4：返回

public static void main(java.lang.String[]) 抛出 java.lang.Exception；
  代码：
   0：双向推 100
   2：istore_1
   3：最不发达国家#2；//字符串字符串
   5：astore_2
   6：获取静态#3；//字段 CONST_OBJECT:Ljava/lang/Object;
   9：astore_3
   10：ldc_w #4；//类从头开始/ReflectionConstantTest
   13：调用虚拟#5；//方法java/lang/Class.getDeclaredFields:()[Ljava/lang/reflect/Field;
   16：4号店
   18：加载 4
   20：数组长度
   21：istore 5
   23：图标st_0
   24：istore 6
   26：加载 6
   28：加载 5
   30: if_icmpge 90
   33：加载 4
   35：加载 6
   37：加载
   38：商店 7
   40：加载 7
   42：图标st_1
   43：调用虚拟#6；//方法 java/lang/reflect/Field.setAccessible:(Z)V
   46：得到静态#7；//字段 java/lang/System.out:Ljava/io/PrintStream;
   49：新#8；//类 java/lang/StringBuilder
   52：重复
   53：调用特殊#9；//方法 java/lang/StringBuilder."":()V
   56：加载 7
   58：调用虚拟#10；//方法 java/lang/reflect/Field.getName:()Ljava/lang/String;
   61：调用虚拟#11；//方法java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
   64：最不发达国家#12；//细绳 ：
   66：调用虚拟#11；//方法java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
   69：加载 7
   71: 常量空值
   72：调用虚拟#13；//方法java/lang/reflect/Field.get:(Ljava/lang/Object;)Ljava/lang/Object;
   75：调用虚拟#14；//方法java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
   78：调用虚拟#15；//方法 java/lang/StringBuilder.toString:()Ljava/lang/String;
   81：调用虚拟#16；//方法java/io/PrintStream.println:(Ljava/lang/String;)V
   84：iinc 6、1
   87：转到 26
   90：返回

静止的 {};
  代码：
   0：新#8；//类 java/lang/StringBuilder
   3：重复
   4：最不发达国家#17；//字符串xyz
   6：调用特殊#18；//方法java/lang/StringBuilder."":(Ljava/lang/String;)V
   9：静置#3；//字段 CONST_OBJECT:Ljava/lang/Object;
   12：返回

}

```

您可以看到它是内联的，`CONST_INT`但（当然）不是。然而仍然可以通过反射获得。`CONST_STRING``CONST_OBJECT``CONST_INT`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-11T21:28:45.240

是的。（只是没有静态，实例。它是静态的，非实例。）

[> 如果底层字段是静态字段，则忽略 obj 参数；它可能为空。](http://java.sun.com/javase/6/docs/api/java/lang/reflect/Field.html#get(java.lang.Object))

（包括标准警告，大多数反射的使用都是一个坏主意）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-17T20:55:53.353

如果您的项目允许使用开源库，您可以使用

[FieldUtils.readDeclaredStaticField](http://commons.apache.org/proper/commons-lang/javadocs/api-release/org/apache/commons/lang3/reflect/FieldUtils.html#readDeclaredStaticField(java.lang.Class,%20java.lang.String))

```
public class Test {
    public final static String CONSTANT="myConstantValue";
} 
```

在另一个类中，您可以使用：

```
Object value = FieldUtils.readDeclaredStaticField(Test.class, "CONSTANT");
System.out.println(value); 
```

您将在控制台中看到“myConstantValue”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-21T11:11:31.527

仅获取名称和值不需要 setAccessible(true)。当您必须处理接口中声明的常量并需要符号名称时，这是一个有用的示例：

```
interface Code {
   public static final int FOO = 0;
   public static final int BAR = 1;
}

...

try {
   for (Field field : Code.class.getDeclaredFields()) {
      String name = field.getName();
      int value = field.getInt(null);
      System.out.println(name + "=" + value);
   }
}
catch (IllegalAccessException e) {
   System.out.println(e);
} 
```

# asp.net - Visual Studio 2008 中的解决方案加载缓慢

> ID：850153
> 
> 赞同：5
> 
> 时间：2009-05-11T21:25:09.533
> 
> 标签：asp.net, visual-studio, visual-studio-2008

我正在开发一个 ASP.NET 3.5 项目，该项目在一个解决方案中有 55 个项目。在 Visual Studio 2008 中打开解决方案时，需要一分钟多的时间才能打开 - 每个项目大约需要 1 秒。但是，如果我在打开解决方案之前断开网线，只需要大约 15 秒！关于可能导致放缓的任何想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-11T21:31:13.363

在我们使用 Visual Source Safe 的时候，我也遇到过这种情况。

如果您的解决方案受源代码控制，则可能是您的源代码控制插件要求更新。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T01:52:28.333

你应该做一些调查，启动[Wireshark](http://www.wireshark.org/)，在有问题的接口上开始捕获，看看有什么流量流过网络。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T01:39:46.450

我可以用问题回答问题吗？让 VS 不只是死于那么多项目，更不用说在 60 秒内快速加载的秘诀是什么？

在大约 10-12 个项目时，Visual Studio 上的编译时间变得难以忍受，在大约 5-8 个项目时，Resharper 将崩溃。IDE 是如此的记忆猪，甚至通过使用多个 VS 实例来打开更多项目通常也不是一种选择。

无论如何，这都是关于内存使用的，而奇怪的球出项目可能正在这样做，例如文件最多的项目。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-07-24T12:29:36.980

本周我遇到了同样的问题（5年后！！）。它是由一个巨大的 .suo 文件（大约 400 Mb）引起的，删除它可以解决问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-06-01T21:14:45.240

我在没有互联网连接的开发机器上遇到了这个问题，结果发现这个问题与 IE 的互联网选项中的设置有关：

> 控制面板 -> Internet 选项 -> 高级 -> 安全 -> 检查发布者的证书吊销

在确保未选中此选项后，我的解决方案再次开始快速加载。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-11T21:33:35.947

几年前，我记得一位同事有一些类似的问题（解决方案要小得多，并且在 VS2003 中）。不记得细节，但我认为它与本地 ASPNET 用户帐户有关（或者更确切地说，它不存在）。虽然不确定...

作为旁注：我通常发现在每个解决方案中可能有几个项目会更有效（通常一个解决方案会生成一个或两个用于生产代码的程序集），然后同时运行几个 Visual Studio 实例. 相同解决方案中的 50 多个项目感觉就像在问问题。

可能是您有其他依赖项，只是想分享我的想法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-11T21:35:11.780

> 一个解决方案中有 55 个项目

哇。我无法想象什么样的解决方案需要这么多项目。答案可能是您的源代码控制提供者需要刷新每个项目的状态，所有这些都需要时间。

对于 edit-merge-commit 风格的版本控制系统，比如 subversion，这个操作不会发生。尝试暂时从整个解决方案中删除源代码控制，看看这是否是罪魁祸首。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-11T21:37:24.490

如果您的解决方案附加到源代码管理，那么它会尝试加载符号并验证您已签出哪些项目。因此，如果您的连接速度较慢，将解决方案脱机通常会更快。

[http://www.tmgirvin.com/2009/03/working-offline-with-visual-studio-2008-and-tfs.html](http://www.tmgirvin.com/2009/03/working-offline-with-visual-studio-2008-and-tfs.html)

**编辑** 我见过的另一个解决方案，创建一个 _webTier.sln _database.sln _build.sln （是你的项目名称）

并且这些解决方案中的每一个都是整个项目的自给自足的部分，但是如果您在 webtier 上工作并且不需要加载数据库项目或移动项目部分，您可以打开 webtier解决方案。

构建解决方案包含需要构建的整个包，并且需要很长时间才能加载。

# c# - 比较两个 IQueryable 实例

> ID：850154
> 
> 赞同：3
> 
> 时间：2009-05-11T21:25:14.370
> 
> 标签：c#, linq

我有两个`IQueryable`实例-`objIQuerableA`并且`objIQueryableB`我只想获取存在于`objIQuerableA`而不存在于`objIQuerableB`.

一种方法是使用 foreach 循环，但我想知道是否有更好的方法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-11T21:41:39.400

简单直接。

```
var result = objIQuerableA.Except(objIQuerableB); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-08-25T06:30:59.820

标题实际上是比较两个 IQueryables。如果您想实际进行比较以确定两个 IQueryable 在单个查询中是否包含相同的结果......

```
var aExceptB = objIQuerableA.Except(objIQuerableB);
var bExceptA = objIQuerableB.Except(objIQuerableA);
var symmetricDiff = aExceptB.Union(bExceptA);
bool areDifferent = symmetricDiff.Any(); 
```

# jettison - Jettison 邮件列表的电子邮件是什么？

> ID：850156
> 
> 赞同：0
> 
> 时间：2009-05-11T21:25:32.483
> 
> 标签：jettison

听起来像一个愚蠢的问题，不是吗？

但是[Jettison 项目](http://jettison.codehaus.org/Mailing+Lists)上的页面提到了[Codehaus 邮件订阅页面](http://xircles.codehaus.org/manage_email/manage)，该页面反过来会在您订阅之前询问邮件列表名称。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T21:27:29.140

[http://xircles.codehaus.org/projects/jettison/lists](http://xircles.codehaus.org/projects/jettison/lists)

# asp.net - 在 GridView 的 linq 数据源中访问一些聚合函数

> ID：850159
> 
> 赞同：0
> 
> 时间：2009-05-11T21:26:08.300
> 
> 标签：asp.net, linq-to-sql, gridview

我正在做一个传统的 WebForms 项目。在项目中，我正在尝试一些 Linq 数据源，并计划最终迁移到 MVC 架构。我对 Linq 还是很陌生。

我有一个使用 Linq 数据源的 GridView。我显示的实体具有多对多关系，我想在关系的多方面获得列的最大值。

我可以在 gridview 中显示基础实体的属性：

```
<asp:TemplateField HeaderText="Number" SortExpression="tJobBase.tJob.JobNumber">
  <ItemTemplate>
     <asp:Label ID="Label1" runat="server" Text='<%# Bind("tJobBase.tJob.JobNumber") %>'>
     </asp:Label>
  </ItemTemplate>
</asp:TemplateField> 
```

我还可以显示许多相关属性的计数：

```
<asp:TemplateField HeaderText="Number" SortExpression="tJobBase.tJob.tHourlies.Count">
  <ItemTemplate>
     <asp:Label ID="Label1" runat="server" Text='<%# Bind("tJobBase.tJob.tHourlies.Count") %>'>
     </asp:Label>
  </ItemTemplate>
</asp:TemplateField> 
```

有没有办法让 tHourlies 集合中名为 WeekEnding 的列的最大值显示在 GridView 中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-11T21:35:07.677

尝试：

```
Bind("tJobBase.tJob.tHourlies.Max(w => WeekEnding)") 
```

但我认为最好进行特定查询，在字段中返回您想要的最大值，并将此查询绑定到您的网格视图。然后你可以像往常一样访问这个字段

```
Bind("MaxWeekEnding") 
```

# java - 我可以从构造函数启动线程吗？

> ID：850160
> 
> 赞同：3
> 
> 时间：2009-05-11T21:26:11.547
> 
> 标签：java, multithreading

给定 J5+ 内存模型 (JSR-133)，以下代码是否是线程安全且允许的？

如果它是安全的，在某些情况下是否可以接受？

```
public final class BackgroundProcessor
extends Object
implements Runnable
{

public BackgroundProcessor(...) {
    super();

    ...

    new Thread(this).start();
    }

public void run() {
    ...
    }
} 
```

当我阅读新的 JMM 规范时，启动线程会创建与启动线程所做的任何事情的先发生关系。

假设该对象在构造函数中设置了私有成员变量并在 run() 中使用。

并且该类被标记为 final 以防止子分类意外。

注意：这里有一个类似的问题，但这有不同的角度：[在自己的构造函数中调用thread.start()](https://stackoverflow.com/questions/84285/calling-thread-start-within-its-own-constructor)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-11T22:55:16.517

[JLS：线程和锁](http://docs.oracle.com/javase/specs/jls/se5.0/html/memory.html)说

> 两个动作可以通过happens-before关系排序。如果一个动作发生在另一个动作之前，那么第一个动作对第二个动作可见并在第二个动作之前排序。
> 
> 如果我们有两个动作 x 和 y，我们写 hb(x, y) 来表示 x 发生在 y 之前。
> 
> *   如果 x 和 y 是同一线程的操作，并且 x 在程序顺序中位于 y 之前，则为 hb(x, y)。

和

> 线程上的 start() 调用发生在已启动线程中的任何操作之前。

因此我们可以得出结论，在调用 Thread.start() 之前，构造函数中的所有操作都发生在线程中启动的所有操作之前。如果 Thread.start() 是对对象字段的所有写入，则启动的线程将看到对对象字段的所有写入。如果没有其他对字段的写入（另一个线程将读取），则代码是线程安全的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T03:23:09.480

好吧，除非您特别想在 Java 并发问题上不同意 Brian Goetz，否则我认为这是错误的。虽然他的原话是“最好不要……”，但我还是听从了他的建议。来自**JCIP，p。42：**

> “在构造过程中可以让 'this' 引用逃逸的一个**常见错误是****从构造函数启动线程**[...] 在构造函数中*创建*线程没有任何问题，但最好不要立即*启动*线程。相反，公开一个开始或初始化方法......”

**更新：**只是为了详细说明为什么这是一个问题。尽管可以保证在调用 Thread.start() 和该线程的 run() 方法实际开始执行之间存在内存屏障，但在调用 Thread.start()*之后*在构造函数期间发生的事情之间没有这样的屏障。因此，如果还有一些其他变量需要设置，或者如果 JVM 执行一些“刚刚构建的对象”的内务处理，则这些变量都不能保证被其他线程看到：即对象可以被其他线程处于不完整状态。

顺便说一句，除了它是否真的破坏了 JMM 之外，它也只是感觉有点像构造函数中的“奇怪的事情”。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-05-11T21:34:10.627

1.  你的类可能应该实现 Runnable

2.  是的，你的代码没问题

3.  扩展 Object 不是必需的。我确定您知道 Object 被所有类隐式扩展。我不知道这种显式扩展对象的流行做法来自哪里，但这是一种糟糕的风格。

# video - 关于SDL的一堆问题

> ID：850161
> 
> 赞同：2
> 
> 时间：2009-05-11T21:26:32.433
> 
> 标签：video, sdl

我正在使用 SDL 开始一个小型 RTS 游戏，这里有一些问题：

*   我使用小精灵，有没有办法用扫描线显示屏幕 x2 ？我尝试使用 rotozoom 缩放它，但它会减慢游戏速度，我想避免手动缩放我的精灵。
*   运行时如何在全屏和窗口之间切换？我找到了该 `SDL_WM_ToggleFullScreen`功能，但根据 SDL 文档，它似乎不适用于 Windows。
*   为了放置我自己的光标，我用我的指针加载了一个精灵并让它跟随鼠标。但我也想降低帧率， `SDL_Delay`这样做会使指针移动不流畅。SDL 光标似乎不受应用程序帧速率的影响，它是使用它的更好解决方案吗？如果是，有没有办法使用图片而不是奇怪的蒙版？
*   有没有更好的限制帧率的方法？
*   如何为表面着色（如`draw_lit_sprite`在 Allegro 中）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-11T21:39:37.500

> 运行时如何在全屏和窗口之间切换？我找到了该`SDL_WM_ToggleFullScreen`功能，但根据 SDL 文档，它似乎不适用于 Windows。

是的，文档说明该`SDL_WM_ToggleFullScreen`功能目前仅适用于 X。

我这样做的方式是这样的：

```
void SdlGraphics::setupScreenSurface() {
    Uint32 flags = 0;
    flags |= SDL_HWSURFACE;
    flags |= SDL_DOUBLEBUF;

    if(isFullScreen) {
        flags |= SDL_FULLSCREEN;
    }

    screenSurface = boost::shared_ptr<SDL_Surface>( 
        SDL_SetVideoMode(width, height, depth, flags), 
        utility::NullDeleter() 
    );
}

void SdlGraphics::setFullScreen(bool fullScreen) {
    if(isFullScreen != fullScreen) {
        isFullScreen = fullScreen;
        setupScreenSurface();
    }
} 
```

对于这些要点：

> *   我使用小精灵，有没有办法用扫描线显示屏幕 x2 ？我尝试使用 rotozoom 缩放它，但它会减慢游戏速度，我想避免手动缩放我的精灵。
>     
>     
> *   如何为表面着色（如`draw_lit_sprite`在 Allegro 中）

我几乎会推荐使用带有 SDL 的 OpenGL 模式。它会给你硬件加速的自由来做这些事情。`rotozoom`都是在软件中完成的（据我所知），这就是它如此缓慢的原因。它总是很慢。

在以 2x 绘制精灵时，您可能还有一个选择是将所有内容绘制为 1x 大小的纹理，然后在绘制完所有内容后，将该纹理缩放 2x。然后你只处理一个表面，而不是每帧一遍又一遍地处理许多小的表面。

至于光标问题，听起来您可能希望[尽可能快地绘制，但只能以恒定速率更新您的游戏](http://gafferongames.com/game-physics/fix-your-timestep/)。这样，您将获得流畅的滚动，但游戏不会失控。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T17:09:58.297

Sprite 大小 - 对于任何类型的实时缩放或旋转，您最好使用 OpenGL，而不是像 SDL 这样的软件 blitter。其他库（例如[SFML](http://www.sfml-dev.org/)）会为您完成此操作。

Fullscreen/Windowed - Zack 的回答看起来不错，只需再次调用 SDL_SetVideoMode。

光标移动 - 通常操作系统将鼠标与底层应用程序分开渲染，以使其保持响应。如果您自己渲染鼠标光标，那么您唯一的办法就是更快地渲染您的游戏。我认为您对光标本身没有太多选择（可能是由于跨平台要求）。

帧率 - 许多人建议将游戏中的运动和物理与帧率分离（例如，请参阅“[修复你的时间步长](http://gafferongames.com/game-physics/fix-your-timestep/)”）。另外，请注意 SDL_Delay 对等待时间施加了一个下限，而不是上限。

着色表面 - 同样，这最好由 OpenGL 执行，因为 SDL 不直接支持这一点。

# java - 如何向正在运行的 Linux 进程发送 Ctrl-Break？

> ID：850163
> 
> 赞同：10
> 
> 时间：2009-05-11T21:26:51.577
> 
> 标签：java, linux, kill, jvm-arguments

我正在调试在 Sun 的 JDK 1.4.2_18 上运行的应用程序中的内存泄漏。这个版本似乎支持命令行参数 -XX:+HeapDumpOnCtrlBreak，这可能会导致 JVM 在遇到控制中断时转储堆。如何将其发送到 Linux 机器上的后台进程？看来 kill 信号是应该起作用的方式，但是我 kill -l 没有报告任何明显是 Ctrl-Break 的东西，至少在我的 Ubuntu 机器上是这样。

更新：我用 Sun JDK 1.4.2_18 测试了 Kill -3（_14 是第一个以这种方式转储堆的），并且它有效。创建了一个堆转储文件，并且该进程仍在运行。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-11T21:38:15.020

Ctrl-\ 是 Windows Ctrl-Break 的 UNIX/Linux 等效项。[Wikipedia](http://en.wikipedia.org/wiki/SIGQUIT)还告诉我，您还可以在 Linux 虚拟控制台上使用 Ctrl-4 或 SysRq（我想您需要一些奇怪的东西才能让普通终端仿真器传递这些按键的表示（通过 ssh/telnet））。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-11T21:53:14.060

kill -QUIT 可能会这样做（它会生成一个线程转储，该线程转储由 Windows 上的 ctrl-break 生成。不过，我还没有尝试使用堆转储选项）。

# ruby-on-rails - 我们可以重命名我们的 Rails 文件夹并且没有任何副作用吗？

> ID：850171
> 
> 赞同：7
> 
> 时间：2009-05-11T21:28:30.917
> 
> 标签：ruby-on-rails, ruby, deployment, rename

在开始 Ruby on Rails 编程时，我将使用

轨道第一
轨道第二

并在这些“第一”和“第二”项目中进行尝试

但是随着它们变得更加成熟，我想将它们签入 SVN 并进一步发展，所以我可以将它们重命名为

“超级应用”

或者

“网络30”

并检查 SVN 并进一步发展而没有任何副作用？我不想重命名它们并生成更多的控制器和模型并进行迁移，有一天发现该项目搞砸了，并在进行生产/部署时引起了问题。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-11T21:31:03.037

不是问题。Rails 不关心它存储的目录的名称（或它的路径）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-11T21:36:28.330

在进行此类重命名时，我没有遇到任何问题。

实际上我刚刚创建了一个项目，并验证了重命名后，RAILS_ROOT 变量会自动更新。您可以使用脚本/控制台验证这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T21:31:55.453

如果必须合并，请先合并它们，然后再提交。

Rails 不介意项目名称，所以不用担心。如果您需要重命名 svn 上已有的内容，请不要忘记使用[重命名](http://juicebar.wordpress.com/2007/05/04/svn-rename-pitfalls-to-avoid/)功能。

# objective-c - Cocoa 中的 Key Value Observing，内省 change 属性

> ID：850172
> 
> 赞同：11
> 
> 时间：2009-05-11T21:28:34.537
> 
> 标签：objective-c, cocoa, key-value-observing

我在布尔属性上使用键值观察 NSObject 方法：

```
-(void)observeValueForKeyPath:(NSString *)keyPath
                     ofObject:(id)object
                       change:(NSDictionary *)change
                      context:(void *)context 
```

这个关键路径的值中最有趣的部分是一个 BOOL，它在 YES/NO 之间不断翻转。我从更改字典中得到的最多是 kind = 1。无论如何，如果不探测我正在观察的对象以查看实际的更改值是什么？

谢谢。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-11T21:42:24.373

首先，您指定 NSKeyValueObservingOptionNew：

```
[theObject addObserver: self
            forKeyPath: @"theKey"
               options: NSKeyValueObservingOptionNew
               context: NULL]; 
```

…然后，在您的观察者方法中：

```
-(void) observeValueForKeyPath: (NSString *)keyPath ofObject: (id) object
                        change: (NSDictionary *) change context: (void *) context
{
    BOOL newValue = [[change objectForKey: NSKeyValueChangeNewKey] boolValue];
} 
```

理想情况下，您会在调用之前检查 value 是否`nil`（好吧，它*可能会*`-boolValue`发生） ，但为了清楚起见，这里省略了。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-06-30T13:48:34.820

正如 Jim Dovey 所说，除了变化字典不带零值，而是空值，所以

```
NSLog(@"%@", [change description]); 
```

将导致类似：

```
{
    kind = 1;
    new = <null>;
    old = <null>;
} 
```

如前所述，对空值调用 boolValue 将导致错误

> [NSNull boolValue]：无法识别的选择器发送到实例 0xa0147020

为避免这种情况，必须检查的不是 nil，而是 [NSNull null]，如下所示：

```
if([change objectForKey:NSKeyValueChangeNewKey] != [NSNull null]) 
  BOOL newValue = [[change objectForKey: NSKeyValueChangeNewKey] boolValue]; 
```

或者

```
id newValue;
if((newValue[change valueForKey: @"new"]) != [NSNull null]){
     BOOL newBOOL = [newValue boolValue];
} 
```

# 3d - 如何应用变换矩阵？

> ID：850179
> 
> 赞同：14
> 
> 时间：2009-05-11T21:30:09.637
> 
> 标签：3d, projection

我正在尝试获取 3D 空间中某个点的 2D 屏幕坐标，即我知道相机的平移、倾斜和滚动的位置，并且我有我希望投影的点的 3D x、y、z 坐标。

我很难理解转换/投影矩阵，我希望这里的一些聪明人可以帮助我；）

这是我到目前为止汇总的测试代码：

```
public class TransformTest {

public static void main(String[] args) {

    // set up a world point (Point to Project)
    double[] wp = {100, 100, 1};
    // set up the projection centre (Camera Location)
    double[] pc = {90, 90, 1};

    double roll = 0;
    double tilt = 0;
    double pan = 0;

    // translate the point
    vSub(wp, pc, wp);

    // create roll matrix
    double[][] rollMat = {
            {1, 0, 0},
            {0, Math.cos(roll), -Math.sin(roll)},
            {0, Math.sin(roll), Math.cos(roll)},
    };
    // create tilt matrix
    double[][] tiltMat = {
            {Math.cos(tilt), 0, Math.sin(tilt)},
            {0, 1, 0},
            {-Math.sin(tilt), 0, Math.cos(tilt)},
    };
    // create pan matrix
    double[][] panMat = {
            {Math.cos(pan), -Math.sin(pan), 0},
            {Math.sin(pan), Math.cos(pan), 0},
            {0, 0, 1},
    };

    // roll it
    mvMul(rollMat, wp, wp);
    // tilt it
    mvMul(tiltMat, wp, wp);
    // pan it
    mvMul(panMat, wp, wp);

}

public static void vAdd(double[] a, double[] b, double[] c) {
    for (int i=0; i<a.length; i++) {
        c[i] = a[i] + b[i];
    }
}

public static void vSub(double[] a, double[] b, double[] c) {
    for (int i=0; i<a.length; i++) {
        c[i] = a[i] - b[i];
    }      
}

public static void mvMul(double[][] m, double[] v, double[] w) {

    // How to multiply matrices?
} } 
```

基本上，我需要的是获取 3D 点相交的给定屏幕的 2D XY 坐标。我不确定如何使用滚动、倾斜和平移矩阵来转换世界点 (wp)。

非常感谢您对此的任何帮助！

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-11T21:42:35.153

**这是复杂的东西。请阅读有关该主题的书，以获取所有数学和细节。如果你打算长期玩这些东西，你需要知道这些东西。这个答案只是为了让你可以弄湿你的脚并四处乱窜。**

## 乘法矩阵

第一件事。矩阵相乘是一件[相当简单的事情](http://mathworld.wolfram.com/MatrixMultiplication.html "矩阵乘法")。

假设您有矩阵*A*、*B*和*C*，其中*AB* = *C*。假设您想计算矩阵*C*在第 3 行第 2 列的值。

*   *取A*的第三行和*B*的第二列。您现在应该从*A*和*B*中获得相同数量的值。（如果你没有为这两个矩阵定义矩阵乘法。你不能这样做。）如果两者都是 4×4 矩阵，你应该有来自*A*（第 3 行）的 4 个值和来自*B*的 4 个值（第 2 列）。
*   *将A*的每个值与*B*的每个值相乘。您最终应该得到 4 个新值。
*   添加这些值。

您现在在第 3 行第 2 列有矩阵*C的值。当然，挑战在于以编程方式执行此操作。*

```
/* AB = C

Row-major ordering
a[0][0] a[0][2] a[0][3]...
a[1][0] a[1][4] ...
a[2][0] ...
...*/
public static mmMul(double[][] a, double[][] b, double[][] c) {
    c_height = b.length; // Height of b
    c_width = a[0].length; // Width of a
    common_side = a.length; // Height of a, width of b

    for (int i = 0; i < c_height; i++) {
        for (int j = 0; j < c_width; j++) {
            // Ready to calculate value of c[i][j]
            c[i][j] = 0;

            // Iterate through ith row of a, jth col of b in lockstep
            for (int k = 0; k < common_side; k++) {
                c[i][j] += a[i][k] * b[k][j];
            }
        }
    }
} 
```

* * *

## 齐次坐标

您有 3D 坐标。假设你有 (5, 2, 1)。这些是笛卡尔坐标。我们称它们为 ( *x* , *y* , *z* )。

齐次坐标意味着您在笛卡尔坐标的末尾写了一个额外的 1。(5, 2, 1) 变为 (5, 2, 1, 1)。我们称它们为（*x*、*y*、*z*、*w*）。

每当您进行使*w* ≠ 1 的变换时，您将坐标的每个分量除以*w*。这会改变您的*x*、*y*和*z*，并再次使*w* = 1。（即使你的转换没有改变*w* ，这样做也没有什么坏处。它只是将所有内容除以 1，什么都不做。）

您可以使用同质坐标做一些非常酷的事情，即使它们背后的数学并不完全有意义。正是在这一点上，我要求您再次查看此答案顶部的建议。

* * *

## 转换一个点

我将在本节和以下各节中使用 OpenGL 术语和方法。如果有什么不清楚或似乎与您的目标相冲突（因为这对我来说似乎有点像家庭作业：P），请发表评论。

我还将首先假设您的滚动、倾斜和平移矩阵是正确的。

当您想使用变换矩阵变换一个点时，将该矩阵右乘以表示您的点的列向量。假设您想通过某个变换矩阵*A*翻译 (5, 2, 1) 。您首先定义*v* = [5, 2, 1, 1] ^T。（我用**小 T**写 [ *x* , *y* , *z* , *w* ] ^T表示*你*应该把它写成列向量。）

 ***```
// Your point in 3D
double v[4][5] = {{5}, {2}, {1}, {1}} 
```

在这种情况下，*Av* = *v* [1]，其中*v* [1]是您的转换点。像矩阵乘法一样进行此乘法运算，其中*A*为 4×4，*v*为 4×1。您最终将得到一个 4×1 矩阵（这是另一个列向量）。

```
// Transforming a single point with a roll
double v_1[4][6];
mmMul(rollMat, v, v_1); 
```

现在，如果要应用多个变换矩阵，首先将它们组合成一个变换矩阵。通过按照您希望它们应用的顺序将矩阵相乘来做到这一点。

以编程方式，您应该从单位矩阵开始，然后对每个变换矩阵进行右乘。令*I* [4]为 4×4 单位矩阵，并让*A* [1]、*A* [2]、*A* [3] ……成为您的变换矩阵。让您的最终转换矩阵为*A* [final]

*[最终]← *I* [4][最终]← *A*[最终]*A* [1]
*A*[最终]← *A*[最终]*A* [2][最终]← *A*[最终]*A* [3] *_* *_* *_**

 ****请注意，我使用该箭头表示分配。当你实现这个时，确保**在矩阵乘法计算中仍在使用A* [final时不要覆盖它！] *复印一份。*

```
// A composite transformation matrix (roll, then tilt)

double a_final[4][4] =
{
    {1, 0, 0, 0},
    {0, 1, 0, 0},
    {0, 0, 1, 0},
    {0, 0, 0, 1}
}; // the 4 x 4 identity matrix

double a_final_copy[4][4];
mCopy(a_final, a_final_copy); // make a copy of a_final
mmMul(rollMat, a_final_copy, a_final);
mCopy(a_final, a_final_copy); // update the copy
mmMul(tiltMat, a_final_copy, a_final); 
```

最后，做与上面相同的乘法：*A* [final] *v* = *v* [1]

```
// Use the above matrix to transform v
mmMul(a_final, v, v_1); 
```

* * *

## 从开始到结束

相机变换应表示为视图矩阵。在此处执行您的*A*[视图] *v* = *v* [1]操作。（*v*将您的世界坐标表示为 4×1 列向量，*A* [final]是您的*A*[视图]。）

```
// World coordinates to eye coordinates
// A_view is a_final from above
mmMult(a_view, v_world, v_view); 
```

投影变换描述了透视变换。这就是使较近的物体变大而使较远的物体变小的原因。这是在相机转换之后执行的。如果您还不需要透视，只需使用单位矩阵作为投影矩阵。无论如何，在这里执行*A v* [1] = *v* [2]。

```
// Eye coordinates to clip coordinates
// If you don't care about perspective, SKIP THIS STEP
mmMult(a_projection, v_view, v_eye); 
```

接下来，您需要进行透视划分。这深入研究了我尚未描述的同质坐标。*无论如何，将v* [2]的每个分量除以*v* [2]的最后一个分量。如果*v* [2] = [ *x* , *y* , *z* , *w* ] ^T，则将每个分量除以*w*（包括*w*本身）。你应该以*w* = 1 结束。（如果你的投影矩阵是单位矩阵，就像我之前描述的那样，这一步应该什么都不做。）

 ***```
// Clip coordinates to normalized device coordinates
// If you skipped the previous step, SKIP THIS STEP
for (int i = 0; i < 4; i++) {
    v_ndc[i] = v_eye[i] / v[3];
} 
```

最后，拿上你的*v* [2]。前两个坐标是您的*x*和*y*坐标。第三个是*z*，你可以扔掉它。（稍后，一旦你变得非常先进，你可以使用这个*z*值来确定哪个点在某个其他点的前面或后面。）此时，最后一个分量是*w* = 1，所以你不需要完全没有了。

```
x = v_ndc[0]
y = v_ndc[1]
z = v_ndc[2]  // unused; your screen is 2D 
```

*如果您跳过了透视和透视分割步骤，请使用上面`v_view`的代替`v_ndc`。*

[这与OpenGL 坐标系](http://www.opengl.org/resources/faq/technical/transformations.htm)的集合非常相似。不同之处在于您从世界坐标开始，而 OpenGL 从对象坐标开始。区别如下：

*   你从世界坐标开始
    *   OpenGL从对象坐标开始
*   您使用视图矩阵将世界坐标转换为眼睛坐标
    *   OpenGL 使用 ModelView 矩阵将对象坐标转换为眼睛坐标

从那以后，一切都一样了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-11T21:37:40.327

这个范围太大了，无法在这里得到一个好的答案：我建议阅读关于这个主题的一个很好的参考。我一直很喜欢[Foley 和 VanDam](https://rads.stackoverflow.com/amzn/click/com/0201848406) ...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T16:42:52.373

我在[这里](http://pastebin.com/f724f2461)发布了一些代码，可以满足您的大部分需求。

它包含 OpenGL 的 Java 实现`gluPerspective()`和`gluLookAt()`函数：

```
Camera camera = new Camera();

Point3d eye = new Point3d(3, 4, 8);
Point3d center = new Point3d(0, 0, 0);
Vector3d up = new Vector3d(0, 1, 0);

camera.perspective(60.0, 1.6, 0.1, 20); // vertical fov, aspect ratio, znear, zfar
camera.lookAt(eye, center, up); 
```

要使用`project()`其中的功能，请使用：

```
void plot(Camera camera, Point4d p) {
    Point4d q = Camera.project(p);
    float x = q.x / q.w;
    float y = q.y / q.w;
    ...
} 
```

返回的`x`and`y`值在 -0.5 ... 0.5 范围内

# php - 如何在 php 中使用 Spreadsheet_Excel_Writer() 在 Excel 单元格中输出超过 255 个字符？

> ID：850182
> 
> 赞同：4
> 
> 时间：2009-05-11T21:30:30.290
> 
> 标签：php, export-to-excel

我正在尝试在 Excel 电子表格中输出几段文本，但现在文本被截断为仅显示 255 个字符。代码非常简单：

```
$xls =& new Spreadsheet_Excel_Writer();
$sheet =& $xls->addWorksheet($name);

foreach ($rec as $field) {
    $rec = ($rec['data'] ? $rec['data'] : $rec);
    $sheet->write($row, $col++, $field);
} 
```

我能做些什么来获取所有文本，而不仅仅是 255 个字符？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-11T21:33:52.047

从[文档中的注释](http://pear.php.net/manual/en/package.fileformats.spreadsheet-excel-writer.spreadsheet-excel-writer-worksheet.writestring.php#5294)：

```
$workbook->setVersion(8); // Use Excel97/2000 Format
$worksheet->writeString(0, 0, $str); 
```

# internet-explorer - 使用查询字符串从 URL 缓存

> ID：850187
> 
> 赞同：7
> 
> 时间：2009-05-11T21:31:18.447
> 
> 标签：internet-explorer, url, caching, query-string

我正在开发的 Web 应用程序提供带有 /image?name=a.gif 之类的 URL 的图像。页面加载缓慢的部分原因是浏览器没有缓存图像。

即使 URL 中包含查询字符串，是否有任何 http 标头组合可以说服 IE 缓存图像？我试图避免浏览器发出任何不必要的请求（包括 if-modified-since 类型的请求）

我对仅适用于 IE (6+) 的解决方案感到满意。另外，我知道我可以通过 URL 重写来避免这个问题——我只是想更好地理解浏览器缓存。

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2011-04-03T01:08:10.750

人们普遍认为，许多旧浏览器（包括 IE6）和一些旧版本的缓存（如 Squid）不会缓存任何附加了查询字符串的文件，无论过期日期如何。

查询字符串版本控制的更强大的替代方法是将版本控制信息放入路径中，例如：

```
site/static/23212903/css/bundle.css 
```

或者：

```
site/images/logo.r23212903.png 
```

有关更多信息，请参阅 Sergey Chernyshev 关于正确设置缓存标头的[精彩文章](http://calendar.perfplanet.com/2010/easy-cache-headers/)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-11T21:35:08.817

将 Web 服务器中的[expires 标头](http://developer.yahoo.com/performance/rules.html#expires)设置为某个遥远的日期。

# java - 编写桌面 GUI 客户端与服务器通信

> ID：850198
> 
> 赞同：2
> 
> 时间：2009-05-11T21:34:17.587
> 
> 标签：java, client-server

我有一个 Java 应用程序，它是一个长时间运行的进程（我们称它为“服务器”）。我必须编写一个桌面 GUI（最有可能在 Swing 中），我们称之为“客户端”，它可以连接到这个应用程序并且：

1.  显示来自应用程序的状态更新
2.  向应用程序提供特定的“手动触发”命令

客户端和服务器之间的每次交互（对话线程）都会很短，但可能涉及一些上下消息。实现这样的事情有哪些不同的选择？速度对我来说不是一个大问题。我更感兴趣的是我可以在不被管道细节困扰的情况下发展对话协议。我现在想到的选项是套接字、RMI、JMS 和 JavaSpaces。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T22:08:28.810

[在Apache Camel](http://camel.apache.org/) (Java)上达到顶峰。它支持您提到的所有选项，并且在路由消息时还允许规则。

单独安装或随 Apache ActiveMQ（JMS 代理）一起安装。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T21:45:21.390

如果可以选择通过[RESTful](http://en.wikipedia.org/wiki/REST) API 扩展服务器，那可能是客户端最容易使用的一种。在简单地以 URL 术语说明 API 之后，您可以在需要时轻松地将您的客户端切换到其他语言。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T21:50:31.223

我已经通过使用 ObjectInputStream 和 ObjectOutputStream 进行序列化命令的套接字解​​决了这个问题。

对于协议，您需要不同的对象命令（命令模式在这里很有用）。所有这些对象都应该是可序列化的。然后您可以简单地发送/接收命令。恕我直言，最简单的方法（在技术方面和实施方面）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T21:39:40.773

我多年来一直使用[XML-RPC](http://de.wikipedia.org/wiki/XML-RPC)做这种事情。我喜欢它，因为它非常简单，可以让你在 15 分钟内运行。都是 http 和简单的 XML。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-12T00:35:34.357

我同意@Norbert Hartl。Apache 有一个非常简单的 XMLRPC 实现，您可以将其与 Apache HTTPClient 一起使用。该库还有一个使用服务器接收 XMLRPC 请求的示例。

# iphone - 以编程方式缩放、平移 iPhone 2.2.1 的 UIWebView

> ID：850207
> 
> 赞同：1
> 
> 时间：2009-05-11T21:35:42.013
> 
> 标签：iphone, event-handling, uiwebview

问候！

我正在尝试从生成的事件中控制 UIWebView。

是否有一部分**记录在案**的iphone SDK 以编程方式创建 UIEvent（或动作或其他东西），然后我可以将其传递给 UIWebView 并让它像用户的手势一样解释它？

如果有人可以向我展示或链接到创建捏事件，我会解决！

或者，如果有人知道为什么这是不可能的，或者只是以某种违反许可的方式完成，这也会有帮助......

多谢你们

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T22:52:53.137

尽管没有记录的方法来创建s，但您可以通过在自定义子类中实现`UIEvent`来拦截和重新发送`UIEvent`s 。`-sendEvent:``UIApplication`

使用私有方法，您可以调用`[[UIEvent alloc] _initWithTouches:(NSMutableSet *)touches keyedTouches:NULL]`以获取新的`UIEvent`

如果您希望以`UIWebView`记录的方式专门设置缩放级别，则可以通过 javascript 进行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T05:29:36.857

看看谷歌代码上的[溴](http://code.google.com/p/bromine/)。它生成触摸事件作为测试过程的一部分。

# svn - 如何在 Windows 上从 SVN 迁移/转换为 Mercurial (hg)

> ID：850213
> 
> 赞同：120
> 
> 时间：2009-05-11T21:37:48.563
> 
> 标签：svn, version-control, mercurial, migration, hgsvn

我正在寻找一种工具来将几个 SVN 存储库迁移到 Mercurial，包括历史、标签等。

我正在使用 TortoiseHg (Windows x32)，所以 ConvertExtensions 被丢弃。有一些关于如何在 Linux 机器 ( [hgsvn](http://pypi.python.org/pypi/hgsvn) ) 上执行此过程的信息，但我没有可用的 Linux 机器。

我可以在 Windows 上使用那些 Python 脚本吗？如果是这样，我需要做什么？或者，我可以使用哪些其他工具来完成此过程？

基本上，如何将 SVN 项目转换为 Mercurial？

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2009-07-23T22:48:00.067

我只需要自己解决这个问题。我有一台 Windows XP 机器，它有一个单独的 Windows 服务器托管[VisualSVN Server](http://www.visualsvn.com/server/)。

我还安装了[TortoiseHG](https://tortoisehg.bitbucket.io/)以及[CollabNet Subversion 命令行客户端](http://www.open.collab.net/downloads/subversion/)。

**`<Enable Convert Extension w/ Tortoise Hg 2>`**

非常感谢[bgever](https://stackoverflow.com/users/70182/bgever)在评论中指出使用 TortoiseHg 2.0，启用转换扩展比以往任何时候都容易。正如他所说

> TortoiseHG 2.0 使这变得更加简单：从开始菜单启动 TortoiseHG 工作台。选择文件 --> 设置。从列表中选择扩展。选中“转换”复选框，然后单击确定。就是这样！无需再尝试生成配置文件并在文件系统中搜索。– bgever 3 月 11 日 7:56

**`</Enable Convert Extension w/ Tortoise Hg 2>`**

**`<Enable Convert Extension Manually>`**

要将存储库从 SVN 转换为 HG，我按照以下步骤操作：

1) 打开 C:\Program Files\TortoiseHg\Mercurial.ini

**编辑**

仅供参考 - Tortoise Hg 已将此文件迁移到

*   XP 或更早版本 - C:\Documents and Settings\USERNAME\Mercurial.ini
*   Vista 或更高版本 - C:\Users\USERNAME\Mercurial.ini

该文件将大部分为空，您只需在其中列出您想要覆盖的内容。如果这就是您所拥有的，只需将这两行添加到文件的最后：

```
[extensions]
convert = 
```

2）搜索以开头的行

> [扩展]

3) 在它下面你会看到一个关键字列表，每行用分号 (;) 注释掉

4）找到说的行

> ;转换=

并删除分号，使其显示为

> 转换 =

**`</Enable Convert Extension Manually>`**

5) 打开命令提示符并导航到您希望在其中创建新 hg 文件夹的目录（该过程将在命令提示符打开的目录中创建一个名为 yoursvnreponame-hg 的新文件夹）。

6) 使用此命令

> hg 转换文件：///y:/yoursvnreponame

我发现转换工具可能会遇到网络存储库的问题，所以我必须将驱动器映射到它，但这对我来说效果很好。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-22T11:29:49.550

1.  在 localhost 上启动 svn 服务器
2.  hg 转换 svn://localhost/your_repo
3.  完成，因为 svn 绑定只需要 file:// 协议

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-11T21:39:44.097

Mercurial 对此有一个[内置的转换扩展](https://www.mercurial-scm.org/wiki/RepositoryConversion#Subversion)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-11-06T23:18:03.967

要将 SVN 存储库转换为 HG 存储库并将其复制到不同的服务器，您需要做一些事情。

1.  已安装 TortoiseHG。（查看当前使用的版本）
2.  已安装 Python。（查看当前使用的版本）
3.  Python 模块（您可以在[http://pysvn.tigris.org/project_downloads.html](http://pysvn.tigris.org/project_downloads.html)找到它们）
4.  您需要将`convert`扩展​​添加到 Tortoise。从开始菜单启动 TortoiseHG 工作台。选择`File -> Settings`。`Extensions`从列表中选择。选中`convert`复选框并单击确定。

首先是转换……</p>

1.  最好将当前 SVN Repo 所在的文件夹映射到您正在使用的计算机上。（即`\\server\folder` 不要映射SVN Repo文件夹本身。映射它上面的文件夹）给映射的驱动器一个字母，比如`Y:\`
2.  打开命令提示符并键入： `CD /D Y:\`
3.  在`Y:\`提示符处键入：（ `hg convert y:/RepoName` 使用当前 Repo 的名称）注意正斜杠和反斜杠。命令中的一个是正斜杠。此外，如果名称有空格，请将名称放在引号中。（即`Y:/"My Repo folder"`）
4.  现在它应该正在运行，并将在旧文件夹旁边创建另一个文件夹。里面应该有一个 hg 文件夹。它不会被启动，也不要启动！
5.  转换完成。

其次是克隆……</p>

1.  打开 TortoiseHG 工作台。去`File -> Clone Repository`
2.  来源：输入转换后的 repo 的完整路径。
3.  目的地：输入您想要克隆 repo 的完整路径。无需在新目的地创建文件夹，因为克隆过程将创建并初始化它。
4.  将权限添加到新的克隆文件夹。
5.  你完成了！！！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-11-07T01:09:12.980

仍然没有人不提及[hgsubversion](https://bitbucket.org/durin42/hgsubversion) ( [Extension Wiki](https://www.mercurial-scm.org/wiki/HgSubversion) )，它可以做到几乎没有任何头痛（不包括罕见的情况和特定的树）。

只需添加扩展，启用它并添加`hg clone SVN_REPO`到本地 mercurial repo

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-26T21:10:23.030

这是在[TortoiseHg 常见问题解答](http://bitbucket.org/tortoisehg/stable/wiki/FAQ#how-can-i-convert-a-subversion-repository-to-mercurial)中：

> ### 如何将 subversion 存储库转换为 Mercurial？
> 
> 您必须安装 svn-win32-1.4.6 命令行工具，然后将它们添加到您的路径中。然后您必须启用转换扩展。此时，您应该可以使用“ `hg convert`”命令进行转换。请将有关转换扩展的问题/问题直接发送到 Mercurial 邮件列表或`#mercurial`.`irc.freenode.net`

所以这显然是可能的——我使用的是 Linux，所以我自己没有尝试过。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-05-12T18:40:46.303

我刚刚将带有 HTTP 身份验证的远程 SVN 存储库转换为 Mercurial 存储库，让我告诉你，关于如何执行此操作的文档并不多。我必须下载 Mercurial 源并使用源包独立安装它，这样 SVN 绑定才能以正确的方式工作。

我像这样安装它：

```
python setup.py install 
```

这在我的 Server 2003 机器上运行良好。我现在可以通过执行以下操作以正确的方式转换 SVN 存储库：

```
python c:\python26\scripts\hg convert <remote repo> 
```

Mercurial 网站上的 ConvertExtension 文档不是很清楚，但确实这样说：

> 无法将 Subversion 绑定安装到 [Mercurial 的] 内置 Python 库中。因此，您需要使用安装在独立 Python 之上的 Mercurial

所以现在我只使用独立版本进行转换，使用 TortoiseHg 进行实际的 VCS 工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-01-24T11:15:24.550

迟到总比不到好 ...

一个价格的两个答案...

1.  如果它是一个公共的开源仓库，您可以使用[http://svn2github.com/add/](http://svn2github.com/add/)大约半小时将该仓库克隆到 GitHib，然后将其拉入 Hg。

2.  使用的好处**`hg convert`**是可以恢复。将 SVN 转换为 Hg 可能需要**几天时间**。如果您停止此操作，它将从停止的地方恢复。

下面是我写的一个批处理文件，因为 Codeplex SVNbridge 垃圾。这个例子中的 repo 确实需要几天时间来获取整个历史记录（我在澳大利亚，所以延迟可能是一个因素）。我想认为它在某个地方给了一个 TFS 服务器一个很好的打击。

这个批处理文件可以随时运行以从 SVN 源中提取更新，如果它们恰好是地球上仅存的仍然使用 SVN 的更新。我还没有测试过，所以看看如果你这样做会发生什么，所以如果我是你，如果你要编辑 repo，我会放弃原来的分支。

如果您克隆 Hg 存储库，这些`robocopy shamap`东西是为了维护 SVN 历史记录，shamap 是短暂的 - 检查批处理文件和 shamap（我会在新分支上这样做）。

这批...

```
@echo off
mode con:cols=100 lines=800

:: Change the SVN remote name here
::
set remote=https://cinch.svn.codeplex.com/svn
::

title Fetching SVN from %remote%. This could take...DAYS
echo .
echo Fetching SVN checkins from %remote%
echo .
echo Dependencies: Tortoise Hg and hg.exe in the Path would be ideal.
echo using hg convert
echo .
echo First, I will make a backup of shamap in the hg repo folder.
echo If shamap in .hg\ is newer then it will be copied to the repo.
echo You should commit it so hg clones of this repo work with this.
echo Commit this .BeeyATch file as well.
echo shamap keeps track of what has been fetched from SVN.
echo ok, that ends the educational part of this script...
echo Now I will fetch SVN changes from
echo %remote%
echo ...
echo ...(this could take quite some time)...
echo ...DAYS...yes...DAYS
echo ...especially if it's fecking Codeplex SVN...
echo .
echo If this craps out just run it again - it will resume from where it left off. 
echo and fetch the rest...eventually
echo .
echo Control C to abort or any other key to start:
echo .

pause

echo .
:: http://mercurial.selenic.com/wiki/ConvertExtension <== see for details of shamap
:: copy the shamap from the original convert into the .hg folder unless it is already there & newer
:: don't panic if shamap is much bigger than the original - diff it to see why
robocopy .\ .\.hg\ shamap /XO 
robocopy .\.hg\ .\ shamap /XO 
echo .

hg convert --verbose --debug %remote% "%CD%"
echo .
echo .
echo Finished fetching from %remote%
title Finished fetching from %remote%
echo Any  key to Exit
echo .
pause

exit 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-06-08T12:07:07.240

使用 Mercurial 的[`convert`扩展](https://www.mercurial-scm.org/wiki/ConvertExtension)：

1.  启用转换扩展；像这样添加`convert=`到`[extensions]`.hgrc 的部分：

    > [扩展]
    > 转换=

2.  *Linux 需要额外的 python 绑定：`sudo apt-get install python-subversion`*
3.  执行`hg convert`命令
    *   见`hg convert -h`帮助
    *   例子：（`hg convert http://[svnserver]/[Project] --source-type svn [DestinationDir]` *见注2）*
4.  推送到新创建的 Mercurial 存储库：`hg push https://[mercurialserver]/[Project]`

**注意**：您甚至可以重复 hg convert 命令以包含在前一次转换之后在 svn 存储库中所做的新更改。

**注意 2**：当 hg convert 无法使用时`http://`，或者`svn://`您可以先签出 Subversion 存储库（或更新现有存储库）并使用本地签出进行转换；例子：`hg convert [DirectoryOfLocalCheckout] --source-type svn [DestinationDir]`

# sql - 我应该先建立一个记录集还是只插入数据？

> ID：850227
> 
> 赞同：0
> 
> 时间：2009-05-11T21:39:47.077
> 
> 标签：sql, vbscript, recordset

我正在使用独立的 VBScript 使用 Web 服务。

Web 服务返回给我一个作业列表，我需要循环并添加到 SQL 数据库中。

我可以

1.  运行节点列表，读取数据并在循环中执行 SQL 插入操作。
    或者
2.  运行节点列表构建记录集，*然后*运行记录集操作 SQL 插入。

选项 1 有速度，但选项 2 似乎……更干净。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T21:51:06.857

一位名叫 Donald Knuth 的计算机科学家曾经说过，

> 过早的优化是编程中万恶（或至少是大部分）的根源。

您从 Web 服务以 HTTP 流的形式接收答案，除非您正在做一些非常特别的事情，否则您的代码将在收到整个答案之前无法控制。因此，将其存储在中间记录集中不会赢得任何时间。即便如此，开销也不会很大。

因此，请选择您有信心可以毫无错误地进行编码的任何内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T21:44:06.337

选项 2 在负载下速度更快，选项 1 编码速度更快。你想花时间让它花哨和快速，或者只是把它弄干净和工作？

将其设置在自己的函数中，使其成为孤立的，如果您以后需要速度，它是一个简单的重构。然后你就可以开始编写其他的东西了。写对了，以后再优化。

# vb.net - IList(Of T).排序帮助

> ID：850232
> 
> 赞同：1
> 
> 时间：2009-05-11T21:40:38.713
> 
> 标签：vb.net, generics, ilist

```
Dim classCodeDetails As List(Of ClassCodeDetail) =     
    db.ClassCodeHeaders.Single(Function(cch)
        cch.CLCH_ID = classCodeHeaderId
    ).ClassCodeDetails.ToList()

classCodeDetails.Sort(Function(c1, c2)  
    c1.Make.MAKE_English.CompareTo(c2.Make.MAKE_English)
) 
```

我的问题是如何对多个属性进行排序？我想先按 排序`Make.MAKE_English`，然后按`Model.MODL_English`。

我该如何实施？

谢谢，
~ck

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T21:43:34.793

如果您不需要就地排序，您可以使用以下`OrderBy`功能：

```
Dim sortedList = list.OrderBy(Function(x) x.Prop1).ThenBy(Function(x) x.Prop2) 
```

你的例子是：

```
Dim classCodeDetails As List(Of ClassCodeDetail) = _
   db.ClassCodeHeaders.Single(Function(cch) cch.CLCH_ID = classCodeHeaderId).ClassCodeDetails _
  .OrderBy(Function(c1) c1.Make.MAKE_English) _
  .ThenBy(Function(c1) c1.Make.MODL_English) _
  .ToList() 
```

实际上，这是执行此操作的正确方法（似乎您正在使用 LINQ to SQL），因为它将`ORDER BY`在生成的 SQL 语句中用于对数据进行排序，而不是在客户端上手动对其进行排序。

# language-agnostic - 如何制作似乎没有“重新加载”的网页

> ID：850236
> 
> 赞同：2
> 
> 时间：2009-05-11T21:42:01.847
> 
> 标签：language-agnostic

我在看这个网站[http://bountii.com/search.php?item=router](http://bountii.com/search.php?item=router)

我查看了其他以类似方式工作的网站。

该页面提供了许多过滤器，例如：价格范围、受欢迎程度等。但是当执行这些过滤器时，看起来只加载了网页的一部分而不是整个页面。这似乎没有使用 ajax，因为它将整个请求发送回服务器（search.php 页面）。

它似乎没有使用此页面[http://nettuts.s3.amazonaws.com/196_jquery/index.htm](http://nettuts.s3.amazonaws.com/196_jquery/index.htm)上提到的技术，他们只是在编辑 CSS 以不显示某些链接。

我很好奇这是如何工作的。有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-11T21:44:40.283

它只是重新加载非常快。整个页面上没有任何 Javascript。HTML 格式良好，页面非常简单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T21:45:52.713

如果您想查看发生了什么，请执行以下操作：

1.  如果您还没有使用 Firefox，请安装它
2.  安装萤火虫扩展
3.  转到您感兴趣的网站，然后单击小萤火虫图标（在右下角的状态栏中，这是一个小错误），然后启用该网站的所有萤火虫选项
4.  重新加载网页并点击周围
5.  看看不同的萤火虫面板。它将跟踪所有网络请求（XHR 或其他），您可以四处窥探并查看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T21:47:15.677

它可能通过 Ajax 请求新数据，填充隐藏`<div>`元素，然后用隐藏元素替换可见元素`<div>`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T21:50:19.307

它可能正在使用 Javascript XMLhttprequest。Facebook 和许多其他网站都使用此功能。它无需重新加载整个页面即可访问服务器。

以下是来自 w3schools.com 的示例：

```
<script type="text/javascript">

var xmlhttp;
function loadXMLDoc(url)
{
xmlhttp=null;
if (window.XMLHttpRequest)
  {// code for all new browsers
  xmlhttp=new XMLHttpRequest();
  }
else if (window.ActiveXObject)
  {// code for IE5 and IE6
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
if (xmlhttp!=null)
  {
  xmlhttp.onreadystatechange=state_Change;
  xmlhttp.open("GET",url,true);
  xmlhttp.send(null);
  }
else
  {
  alert("Your browser does not support XMLHTTP.");
  }
}

function state_Change()
{
if (xmlhttp.readyState==4)
  {// 4 = "loaded"
  if (xmlhttp.status==200)
    {// 200 = OK
    // ...our code here...
    }
  else
    {
    alert("Problem retrieving XML data");
    }
  }
}
</script> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-11T21:54:34.073

除了快速加载之外，浏览器优化和缓存可能也起作用。我让它看起来像是通过点击链接交替刷新页面来加载页面几次。

刚刚在 IE 中尝试过，每次点击我都能看到一个可见的重新加载。在 Chrome 中，它看起来没有任何刷新，我猜是因为浏览器优化。我知道在 Chrome 中，如果您在具有相同内容的 2 个选项卡之间切换，它甚至不会重绘任何内容。

# iphone - 带有视口的 UIWebview 横向格式

> ID：850241
> 
> 赞同：2
> 
> 时间：2009-05-11T21:43:14.340
> 
> 标签：iphone, cocoa-touch, uiwebview

我正在使用这里提到的元视口[为什么 UIWebView 会缩小图像？](https://stackoverflow.com/questions/835040/why-does-uiwebview-shrink-images)对于 UIWebView。这可以很好地格式化肖像，我不必补偿奇怪的缩放比例。但是，一旦旋转到横向，我就无法利用额外的宽度。意思是，我想将更多文本放入单行横向。一切都保持在 1.0。有没有办法将视口更改为旋转时的 0.75 缩放并在纵向时更改为 1.0？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-07-05T20:47:37.910

我编写了这个函数来设置视口宽度，因为 UIWebView 被调整大小。您可以轻松地调整它以设置除宽度以外的视口属性。

```
-(NSString *) setViewportWidth:(CGFloat)inWidth {
    NSString *result = [_webView stringByEvaluatingJavaScriptFromString:[NSString stringWithFormat:@"(function ( inWidth ) { "
        "var result = ''; "
        "var viewport = null; "
        "var content = 'width = ' + inWidth; "
        "var document_head = document.getElementsByTagName('head')[0]; "
        "var child = document_head.firstChild; "
        "while ( child ) { "
            "if ( null == viewport && child.nodeType == 1 && child.nodeName == 'META' && child.getAttribute( 'name' ) == 'viewport' ) { "
                "viewport = child; "
                "content = child.getAttribute( 'content' ); "
                "if ( content.search( /width\\s=\\s[^,]+/ ) < 0 ) { "
                    "content = 'width = ' + inWidth + ', ' + content; "
                "} else { "
                    "content = content.replace( /width\\s=\\s[^,]+/ , 'width = ' + inWidth ); "
                "} "
            "} "
            "child = child.nextSibling; "
        "} "
        "if ( null != content ) { "
            "child = document.createElement( 'meta' ); "
            "child.setAttribute( 'name' , 'viewport' ); "
            "child.setAttribute( 'content' , content ); "
            "if ( null == viewport ) { "
                "document_head.appendChild( child ); "
                "result = 'append viewport ' + content; "
            "} else { "
                "document_head.replaceChild( child , viewport ); "
                "result = 'replace viewport ' + content; "
            "} "
        "} "
        "return result; "
    "})( %d )" , (int)inWidth]];

    return result;
} 
```

# c# - Silverlight 过渡效果telerik 演示如何？

> ID：850254
> 
> 赞同：0
> 
> 时间：2009-05-11T21:47:16.380
> 
> 标签：c#, silverlight, transitions

我想达到一个效果，我不知道如何开始。在[terelik 的 silverlight 演示](http://demos.telerik.com/silverlight/)中，当您从左侧菜单中选择一个选项时，主要部分会按下，然后向左移动，然后显示一个新部分。

我想做类似的事情。我计划创建一个小型用户控件来显示客户数据。当用户在记录之间移动时，我想显示此转换。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-11T23:22:03.727

在我的脑海中，最快的方法可能是创建一个包含其他两个*“事物”的*用户控件，例如另一个用户控件、网格等。然后在这个自定义转换控件中，您需要做的就是实现转换（按下和移位），并管理将旧项目换成新项目。

# security - 有没有标准的asp.net认证授权登录系统？

> ID：850256
> 
> 赞同：1
> 
> 时间：2009-05-11T21:47:33.087
> 
> 标签：security, authentication, login, authorization

除了2.0自带的（生成的aspnetdb.mdf）外，有没有标准的asp.net互联网网站登录授权认证系统？一个可以插入网站的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T21:53:03.030

您可以使用[aspnet_regsql.exe](http://msdn.microsoft.com/en-us/library/x28wfk74.aspx)在您选择的任何 sql server db 中创建所需的表/存储过程/视图。一旦你添加了正确的连接字符串和会员配置，你就可以使用所有在 .net 2.0 中添加的会员资料

[4 Guys](http://www.4guysfromrolla.com/articles/102208-1.aspx)有一个很好的关于如何实现会员系统的教程，其中包括使用 aspnet_regsql.exe。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T21:54:02.030

“生成的 aspnetdb.mdf”是 ASP.NET Membership 模型。您可以在没有*生成 aspnetdb.mdf*的网站中使用它。

从 MSDN 中的一篇名为[Introduction to Membership](http://msdn.microsoft.com/en-us/library/yh26yfzy.aspx)的文章中：

> ASP.NET 成员资格为您提供了一种验证和存储用户凭据的内置方式。因此，ASP.NET 成员身份可帮助您管理网站中的用户身份验证。您可以将 ASP.NET 成员资格与 ASP.NET 表单身份验证或 ASP.NET 登录控件一起使用，以创建一个完整的用户身份验证系统。

[也可以在这里](https://stackoverflow.com/questions/835124/how-do-i-change-my-asp-net-membership-database-from-express-to-standard-sql/835185#835185)查看我的回答和评论。

# asp.net-mvc - 可查询的 使用 ASP.NET MVC - 如果模型当前不使用 LINQ，你可以使用它吗？

> ID：850258
> 
> 赞同：3
> 
> 时间：2009-05-11T21:49:14.957
> 
> 标签：asp.net-mvc, linq

如果您有一个模型，其类不使用 LINQ，您是否仍能以某种方式利用并使用 IQueryable 与 MVC 中的分页一起使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T22:10:43.733

如果您只想在 MVC 中进行分页，请查看 MvcContrib 的 Pager。

[这是一些示例代码](https://web.archive.org/web/20110128235244/http://blogs.embarcadero.com/johnk/2009/04/02/38871)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T22:20:20.333

我使用[Martijn Boland 的 Html.Pager()](http://blogs.taiga.nl/martijn/2008/08/27/paging-with-asp.net-mvc)助手的修改版本来生成实际的 HTML 寻呼机。我的控制器设置为接收页面大小和页码参数，并将它们传递给我的 POCO 模型工厂。

他的完全控制包含IPagedList，它用分页所需的一切包装了IList。对我的口味来说有点太重了，因为无论如何我都在做 SQL 端分页。

如果您出于特定原因需要 IQueryable，[这里有一个 IList 上的简单转换方法](https://stackoverflow.com/questions/73542/ilistt-to-iqueryablet)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T22:21:03.373

不，但是您仍然可以使用 IEnumerable 来实现分页，当然，它会从内存中分页整个数据集，但是由于您没有使用 LINQ，所以这与您获得的一样好。

# mvvm - 获取 ListView 祖先的 DataContext

> ID：850262
> 
> 赞同：1
> 
> 时间：2009-05-11T21:49:57.340
> 
> 标签：mvvm, binding, relativesource

我正在使用 MVVM 开发 WPF 应用程序，需要一些帮助。

对于我的 AddressesViewModel 的视图，我有一个带有列表视图的用户控件。我想从 listViewItem 的上下文菜单中执行在 AddressesViewModel 中找到的命令。因为我正在打开一个 ContextMenu，所以在可视化树中找不到它（我在某处读过）。

这是视图标记：

```
 <UserControl>
        <ListView Name="lstAddress"
                        ItemsSource="{Binding Path=Addresses}" 
                        HorizontalAlignment="Stretch" MinHeight="150" MinWidth="100">
            <ListView.Resources>
                <ContextMenu x:Key="ItemContextMenu">
                    <MenuItem Header="Add Address"/>
                </ContextMenu>
            </ListView.Resources>
            <ListView.View>
                <GridView>
                    <GridViewColumn Header="Address" DisplayMemberBinding="{Binding Path=Address}/>
                    <GridViewColumn Header="City" DisplayMemberBinding="{Binding Path=City}"/>
                </GridView>
            </ListView.View>
            <ListView.ItemContainerStyle>
                <Style TargetType="{x:Type ListViewItem}">
                    <Setter Property="ContextMenu" Value="{StaticResource ItemContextMenu}"/>
                </Style>
            </ListView.ItemContainerStyle>
        </ListView>
    </UserControl> 
```

这是 ViewModel 类：

```
public class AddressesViewModel
{
    public List<AddressViewModel> Addresses { get; set; }

    public ICommand AddAddressCommand { get; set; }
}

public class AddressViewModel
{
    public String Address { get; set; }
    public String City { get; set; }
    public String State { get; set; }
    public String Zip { get; set; }
} 
```

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-24T20:37:36.650

如果您的 MenuItem 看起来像这样，它应该适合您：

```
 <MenuItem Header="Add Address" 
                          Command="{Binding DataContext.AddAddressCommand, 
                                RelativeSource={RelativeSource FindAncestor, 
                                    AncestorType={x:Type ListView}}}"/> 
```

# iphone - 将图像显示为弹出窗口

> ID：850278
> 
> 赞同：0
> 
> 时间：2009-05-11T21:52:44.140
> 
> 标签：iphone, cocoa-touch, uiview, uiwebview, uiimageview

我需要在 UIWebView 顶部显示表格格式的数据作为模式。基本上是一个 UIAlertView。但是，我需要在此模式中显示表格数据，这是 UIAlertView 无法做到的（据我所知）。我正在考虑创建一个包含文本数据的图像，并在 UIImageView 或 UIView 中显示图像，该图像可以有一个关闭按钮。不确定这是否可以全部变成模态的。

我看到一个视图可以作为子视图添加到 UIAlertView：http: [//blogs.oreilly.com/iphone/2008/03/open-iphone-sdk-building-a-uip.html](http://blogs.oreilly.com/iphone/2008/03/open-iphone-sdk-building-a-uip.html)。不过，不确定苹果是否会这样做。

这些方法听起来可行还是有更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-24T11:48:00.450

有一种非常简单的方法可以在视图中添加表格和 uiwebview。设置表的数据源和委托。并显示数据。或者如果你想要别的东西......显示图片或更详细地解释。

# asp.net-mvc - 为 ASP.NET MVC 环境推荐的单元测试书

> ID：850279
> 
> 赞同：11
> 
> 时间：2009-05-11T21:52:46.680
> 
> 标签：asp.net-mvc, unit-testing

我需要有关与 ASP.NET MVC 一起使用的优秀单元测试书籍的建议。根据您实际阅读和使用的书籍（您的圣经），您推荐什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-11T22:34:33.260

似乎所有较新的 ASP.NET MVC 书籍都至少有一章是关于单元测试的。

我最近完成了 Steve Sanderson 的书[Pro ASP.NET MVC Framework](http://blog.codeville.net/2009/04/29/now-published-pro-aspnet-mvc-framework-apress/)，我认为作者非常强调单元测试。这本书没有关于单元测试的专门章节，但几乎每一章都有相关的部分或标注/侧边栏来处理测试路由（入站和出站）、控制器、存储库、模型绑定器等。如果我记得他非常详细地使用了[nUnit](http://www.nunit.org/index.php)和[Moq](http://code.google.com/p/moq/)库。[您可以在 Google Books： Pro ASP.NET MVC Framework](http://books.google.com/books?id=Xb3a1xTSfZgC)上预览他的书的部分内容，或者从[Apress](http://www.apress.com/book/view/1430210079)（他们的电子书价格合理，但用您的电子邮件地址保护密码，这对我来说有点痛苦）或从[Amazon](https://rads.stackoverflow.com/amzn/click/com/1430210079)订购。

我还没有看到任何关于 ASP.NET MVC 单元测试的书的计划，所以你可能不得不坚持博客或在即将出版的 ASP.NET MVC 书籍中可以找到的任何内容（就像我说的，似乎它们都不同程度地涵盖了单元测试）。

我知道的一些书：

[Wrox：开始 ASP.NET MVC 1.0](http://www.wrox.com/WileyCDA/WroxTitle/productCd-047043399X.html) --- 有一个关于测试的示例章节，可[在此处](http://p2p.wrox.com/book-beginning-asp-net-mvc-1-0-isbn-978-0-470-43399-7/74180-free-chapter-9-testing-asp-net-mvc-applications-preview.html)下载。

[Manning: ASP.NET MVC in Action](http://www.manning.com/palermo/) --- 没有关于测试的明确章节，但是如果您下载[CodeCampServer](http://code.google.com/p/codecampserver/)参考应用程序，您会发现大量的单元、集成和回归测试。

[Wrox: Professional ASP.NET MVC 1.0](http://www.wrox.com/WileyCDA/WroxTitle/Professional-ASP-NET-MVC-1-0.productCd-0470384611.html) --- 在[NerdDinner](http://haacked.com/archive/2009/03/10/chapter-one-pro-aspnetmvc.aspx)示例应用程序中有单元测试和一个专门的测试章节。测试大师 Roy Osherove（The [Art of Unit Testing 的作者）在](http://www.manning.com/osherove/)[这里](http://weblogs.asp.net/rosherove/archive/2009/03/20/test-review-1-nerddinner.aspx)回顾了 NerdDinner 测试。

[Packt: ASP.NET MVC 1.0 Quickly](http://www.packtpub.com/asp-net-model-view-controller-1-0-quickly/book) --- 有一章是关于单元测试的，作者有一个很好的博客，讨论了包括[测试](http://blog.maartenballiauw.be/post/2008/03/19/ASPNET-MVC-Testing-issues-Q-and-A.aspx)在内的各种 ASP.NET MVC 问题。

[Sams: ASP.NET MVC Framework Unleashed](http://www.informit.com/store/product.aspx?isbn=0672329980) --- 浏览本书[的目录](http://www.informit.com/store/product.aspx?isbn=0672329980)可以发现大量用于测试的内容（模拟、TDD 等）。您可以查看作者的[博客](http://stephenwalther.com/blog/category/9.aspx)以获取即将出版的书籍和其他 ASP.NET MVC 和 TDD 相关文章中的示例内容。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-11T21:59:01.227

单元测试的艺术

[http://www.artofunittesting.com/](http://www.artofunittesting.com/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-11T21:55:36.817

我喜欢 Kent Beck 的“测试驱动开发：示例”（[amazon 链接](https://rads.stackoverflow.com/amzn/click/com/0321146530)）作为 TDD 的介绍，它不是特定于 C# 也不是 ASP.NET MVC。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-11T21:57:22.087

我是 Pragmatic Press 书籍的忠实粉丝

[C# 中的实用单元测试](http://www.pragprog.com/titles/utc2/pragmatic-unit-testing-in-c-with-nunit)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-11T22:02:27.460

我建议从[带有 NUnit 的 C# 中的实用单元测试](http://www.pragprog.com/titles/utc2/pragmatic-unit-testing-in-c-with-nunit)开始，因为它易于阅读并且使用 C# 非常具体（如果您将 C# 用于 ASP.NET，则非常理想）。之后继续使用[XUnit 测试模式](http://xunitpatterns.com/)。它更通用，给你很多想法，作为一个很好的参考。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-11T21:56:32.853

不知道一个专门为此，但这是圣经：http: [//xunitpatterns.com/](http://xunitpatterns.com/)。

不是一本书，但可能有帮助： http: [//www.codeplex.com/xunit](http://www.codeplex.com/xunit)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-11T22:00:22.287

好吧，如果您正在寻找圣经，请查看Gerard Meszaros 的*xUnit 测试模式*。它有理论、测试气味和带有示例的模式。（那将是上面推荐的 Ray T.）

如果您正在寻找更高级别的测试（尤其是通过 UI），请查看 Gojko Adzic 的电子书（[www.acceptancetesting.info](http://www.acceptancetesting.info)和[www.fitnesse.info](http://www.fitnesse.info)）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-11T22:02:39.613

请参阅 IEEE 软件文章[TDD：无畏编程的艺术 中](http://www2.computer.org/portal/web/csdl/abs/html/mags/so/2007/03/s3024.htm)的推荐书籍列表。它有一个评论和与每个相关的级别。

他们中有一些：

*   Kent Beck，TDD 示例，Addison-Wesley，2002（介绍性）
*   David Astels，测试驱动开发：实用指南，Prentice Hall，2003 年（中级）
*   James Newkirk 和 Alexey Vorontzov，Microsoft .NET 中的测试驱动开发，Microsoft Press，2004 年（中级）

# asp.net - Silverlight 中的 JsonArray 到 javascript

> ID：850285
> 
> 赞同：0
> 
> 时间：2009-05-11T21:55:04.947
> 
> 标签：asp.net, javascript, json

我正在创建一个 JsonArray，例如：

```
JsonArray jsonValues = new JsonArray();
 for( int i = 0; i < values.Count; i++ )
 {
   var someSingleValue = values[i];
    jsonValues.Add( string.Format( "Name: {0}", someSingleValue ) );
 } 
```

之后，我通过调用将 json 值发送到 .aspx 页面中的 javascript： HtmlPage.Window.Invoke("call", jsonValues);

该调用有效并且到达那里，但是我不知道如何迭代这些值，即提取它们。我试过：（在javascript中）

```
for (var x in somevalues){ alert(somevalues); } 
```

我也试过：

```
 for(var i = 0; i < somevalues.length; i++) {
            alert(somevalues[i]);
            } 
```

但它崩溃了。（在这两种情况下）有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T22:40:26.307

您是否使用 eval 方法将字符串序列化为 JSON 对象？

```
function call(somevalues){

  //somevalues is currently just a string.
  var results = eval("(" + somevalues +")");

  //results now should contain your array as a JSON object.    

  //and you should be able to iterate over it at this point.
  for(var i = 0; i < results.length; i++){
     alert(results[i]);
  }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-11T21:58:21.930

假设 somevalues 确实是一个数组，你可以这样做：

```
for(var i = 0; i < somevalues.length; i++) {
   // do something with somevalues[i]
} 
```

您所做的是告诉 JavaScript 迭代对象的属性，这与使用常规循环`somevalues`的迭代相似但不同。`for`

* * *

编辑：我愿意打赌你的变量，`somevalues`是一个字符串。只是做`alert(somevalues)`，看看会发生什么。

# apache-flex - 构建单独的 .swc 是否允许更快地加载应用程序？

> ID：850288
> 
> 赞同：0
> 
> 时间：2009-05-11T21:55:50.857
> 
> 标签：apache-flex, optimization

我们的应用程序在启动时加载有点慢，如果在几个 swc 中分离应用程序的模块会减少加载时间，我会自己徘徊（grosso modo : a module = a "page" ）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T23:20:34.823

SWC 只是一个压缩的类 zip 类存档（静态库）/针对 SWC 编译应用程序不会更改输出的 swf。有两种方法可以减少初始加载：

1.RSL - 与应用程序分开加载并可以缓存的动态库。任何由 Adob​​e 签名的 RSL 不仅可以由依赖于平台缓存的 Web 浏览器缓存，还可以由 Flash 播放器本身缓存，这意味着即使用户清理其浏览器缓存或根本没有缓存，一旦 RSL已下载，已缓存。

这对于 flex 框架和 RPC 的运行时加载通常很有用。如前所述，另一种类型的 RSL 缓存是浏览器缓存。无论哪种方式，RSL 都会在启动时加载。

2.另一种方式是将应用程序的一部分提取到模块中，然后按需加载。例如，如果应用程序有 3 个屏幕，则只有在用户第一次进入该屏幕时，才会加载每个屏幕 [“可能”，因为由开发人员决定何时]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T22:33:24.947

这取决于是什么导致启动缓慢。SWF被浏览器缓存后是否变慢？如果是这样，那么您只需要更好地构建代码，以便在启动时不会发生太多事情。您可以通过在组件上设置 creationPolicy 属性来推迟对象的创建。如果速度慢是由 SWF 的大小引起的，那么使用框架 RSL 并划分为模块将有助于减少初始下载大小。

# php - 使用 Thrift 在 HBase 中写入 php 数组

> ID：850291
> 
> 赞同：5
> 
> 时间：2009-05-11T21:56:59.547
> 
> 标签：php, thrift, hbase

我有一个 Thrift php 客户端，我想在 HBase 表中写入，我正在执行以下操作：

```
 $mutations = array(
    new Mutation( array(
      'column' => 'entry:num',
      'value' => array('a','b','c')
    ) ),
  );
  $client->mutateRow( $t, $row, $mutations ); 
```

问题是在 HBase 中插入时，作为数组的值被转换为“数组”，而不是存储数组的元素。如何将列表存储为数组（或字节数组）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-02-11T23:48:30.853

HBase 突变对象需要三个具有布尔/文本值的字段，而不是数组。因此，您需要将任何结构化值转换为字符串，例如。

```
 $mutations = array(
     new Mutation( array(
       'isDelete' => FALSE,
       'column'   => 'entry:num',
       'value'    => serialize(array('a','b','c'))
     ) ),
   );
   $client->mutateRow( $t, $row, $mutations ); 
```

HBase Thrift API 的定义在这里； [http://svn.apache.org/viewvc/hbase/trunk/src/main/resources/org/apache/hadoop/hbase/thrift/Hbase.thrift?view=markup](http://svn.apache.org/viewvc/hbase/trunk/src/main/resources/org/apache/hadoop/hbase/thrift/Hbase.thrift?view=markup)

我没有测试过这个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T08:08:04.023

我必须承认，我不知道您要做什么（可能是由于缺乏有关 Thrift 和 HBase 的知识），但是如果我正确理解了您的问题，那么您正在尝试编写一些 PHP 数据结构（在这种情况下为数组）到存储介质。为此，您必须以某种方式*序列化*您的数据。这可能是使用自定义 XML 序列化、自定义二进制序列化，或者可能是最简单的解决方案，由`serialize()`相应的`unserialize()`.

如果您努力实现语言间互操作性，您应该使用自定义序列化，或者您必须编写一个反序列化函数来反序列化目标语言中的 PHP 序列化格式。

只是一个简单的例子 - 我不知道你必须把这段代码放在哪里，因为我不知道你在做什么：

```
$mutations = array(
    new Mutation(array(
      'column' => 'entry:num',
      'value'  => array('a','b','c')
    )),
  );
$data = serialize($mutations); // $data now is a string
// write $data to storage
// read $readData from storage
$readMutations = unserialize($readData);
// $readMutations == $mutations 
// (but the Mutation instances are not the same instances any more) 
```

请看

*   [`serialize()`](http://de3.php.net/manual/en/function.serialize.php)
*   [`unserialize()`](http://de3.php.net/manual/en/function.unserialize.php)
*   [序列化对象 - 会话中的对象](http://de3.php.net/manual/en/language.oop.serialization.php)

# wcf - Silverlight + 智能客户端操作在一项服务中？

> ID：850296
> 
> 赞同：0
> 
> 时间：2009-05-11T21:58:29.247
> 
> 标签：wcf, silverlight, web-services

对于我的项目的 Web 服务，我想支持桌面客户端和 silverlight 客户端。我应该为每个服务编写单独的 Web 服务还是将所有操作放在一个服务中？如果我把它们都放在一起，我必须使用 basicHttpBinding。winforms 应用程序现在使用 wsHttpBinding，使用 basicHttpBinding 我会失去什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T13:17:45.060

我强烈建议您仔细阅读以下内容：

**《Silverlight 和 WCF 功能比较》**

[http://msdn.microsoft.com/en-us/library/cc896571(VS.95).aspx](http://msdn.microsoft.com/en-us/library/cc896571(VS.95).aspx)

在开发用于 silverlight 的 Web 服务时，有很多问题，特别是如果您已经有了 wsHttpBinding 解决方案。祝你好运！

编辑：我也发现这篇文章很有用：

**WCF：BasicHttpBinding 与 SOAP 数据包级别的 WSHttpBinding 相比** [http://geekswithblogs.net/claeyskurt/archive/2008/04/22/121508.aspx](http://geekswithblogs.net/claeyskurt/archive/2008/04/22/121508.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T12:59:18.023

使用一个具有两个端点的 Web 服务，这将允许您支持 basicHttpBinding 以及 wsHttpBinding。

两种绑定的区别在于basic是Soap 1.1而ws是Soap 1.2和WS-Addressing Specifications，另外wsHttpBinding提供了更多的安全选项

# c++ - C++ RTTI 继承导致类大小增加

> ID：850299
> 
> 赞同：0
> 
> 时间：2009-05-11T21:59:05.203
> 
> 标签：c++, class, object, rtti

在 C++ 中，问题很简单。

我有 2 个类，其中一个包含另一个作为其实现的一部分。

```
struct A
{
    void do_something()
    {
    };
};

struct B
{
    A obj_A;
    void hello_world()
    {
    };
}; 
```

现在的问题是，当我执行 sizeof(B) 和 B 类型的对象时，如果 A 是 B 的一部分，则结构 B 大一个字节。A 100% 只包含非虚拟成员（不需要虚拟表）并且不需要 typeid 检查。有什么办法（比如编译器指令）从 B 中完全删除不需要的字节，但仍然通过 B 访问 A 的成员函数？

我只能假设额外的字节是编译器将 char* 添加到 A 的名称“A”，但任何其他想法都会有所帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-11T23:33:31.697

sizeof(A) 不能为 0，因为对象的每个部分都应该是“可寻址的”（即当我们使用运算符 & 时应该有不同的地址）

```
struct A
{
};

struct B
{
    A m_a1;
    A m_a2;
};

void test()
{
    B b;
    A* pa1 = &b.m_a1;
    A* pa2 = &b.m_a2;

    // "pa1" need to be different from "pa2" 
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T22:44:30.967

不幸的是，您没有提到编译器。

无论如何，在您发布的代码中，A 类是“空基类优化”的候选者。这是 C++ 标准的一部分，它说可以优化没有成员变量的基类以不占用字节。

B 必须按 C++ 标准占用空间，因为它至少包含一个成员（即 obj_A）。

您可以通过调用 do_something() 直接从 B 中访问 A 的成员函数。不需要魔法。

# svn - Subversion 合并：我如何干净利落地重新集成“权威”分支？

> ID：850304
> 
> 赞同：13
> 
> 时间：2009-05-11T22:00:46.340
> 
> 标签：svn

我们一直在试验一种新技术来管理我们的发布分支。

一般来说，我们在主干上维护我们当前的发布，并为每个发布创建发布分支。发布分支是通常进行积极开发的地方，主干用于修复当前版本的错误。

我们定期将主干中的错误修复合并到发布分支（每周）。

现在我们已经准备好发布另一个版本，我们想将发布分支合并到主干中。不幸的是，这会导致许多冲突（> 50）。起初我很惊讶，但现在我明白 Subversion 不能用主干中存在的内容轻松纠正分支中的更改。

**有没有办法告诉 Subversion 在集成回主干时使用分支中文件的所有版本？我们知道文件的分支版本是“正确的”。**

作为替代方案，理论上我们可以放弃主干，只在分支上工作——从分支分支发布。

我们使用 TortoiseSVN 和 Subclipse。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-11T23:36:01.693

从输出`svn help merge`：

> **--接受** *ARG*
> 
> 指定自动冲突解决动作（'推迟'、'base'、'mine-conflict'、'theirs-conflict'、'mine-full'、'theirs-full'、'edit'、'launch'）

要在合并到主干时接受分支更改，您需要“ `--accept theirs-full`”选项。

我认为 TortoiseSVN 1.6.2 在 GUI 中没有等效的选项。您仍然可以通过选择“ ”以[交互方式解决冲突](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-merge.html#tsvn-dug-merge-conflict-callback)`use repository`，因为在合并过程中会遇到每个冲突。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-02-09T19:21:45.467

我相信您通过将错误修复从主干复制到您的发布分支所做的事情有时称为变[基](http://en.wikipedia.org/wiki/Rebasing)。在这种情况下，所有变基意味着您采用一个通常基于主干的修订版 r49 的分支，并将来自主干的 r50-r57 的更改合并到分支中，以便您现在可以将该分支视为基于修订版树干的 r57，而不是修订版 r49。

实践中的问题是，当将来自主干或任何其他基础的一系列修订合并到其中一个分支时，它不会重置创建该分支的基础修订，而是将正常的[mergeinfo](http://svnbook.red-bean.com/en/1.5/svn.ref.svn.c.mergeinfo.html)属性作为唯一的方法知道合并了什么。为了能够将来自分支的更改重新集成回其基础（例如主干），而不会无意中重播合并的基础更改，例如在我之前的示例中从 r50-r57 将通过樱桃合并从分支到基础的更改以不包括由变基（从基础合并到分支）引起的任何修订的方式选择特定修订。

不幸的是，除此之外，由 Subversion 开发人员实现一种方法来自动执行此操作，以便只有不包含 mergeinfo 属性的修订版描述了仅包含原始基础修订版和基础目标修订版之间的修订的合并（通常是头）。这变得更加复杂，因为合并通常包括与合并提交一起提交的手动更改，这些更改将丢失，并且任何给定对象的起源都必须追踪到它的共同祖先才能使其工作正确地在[楼梯上](http://dehora.net/journal/2006/02/subversion_tips_dealing_with_branches.html)分支机构。除此之外，允许将分支替换为基础或主干的较新副本并将所有以前的提交作为一系列单独的提交重新应用的功能也将使这成为可能，但是笨拙的行为更像是真正的变基.

这些评论不是一个明确的答案，但代表了我作为 Subversion 长期用户的理解。如果有人有任何其他要添加的内容或可以在我的陈述中挑选出一些可能不正确的内容，请务必让我知道，以便我们能够真正了解 Subversion 当前实现的功能和限制。

**更新：**根据 Subversion 文档，似乎在使用[--reintegrate 选项](http://svnbook.red-bean.com/nightly/en/svn.branchmerge.basicmerging.html#svn.branchemerge.basicmerging.reintegrate)时，Subversion 应该能够正确地重新集成在分支中完成的工作，这种方式考虑到可能已经完成的任何可能的刷新合并，以将基本更改带入分支。当然，这在技术上与变基有点不同，但我认为它在使用上足够相似，可以称为变基。现在的主要问题是 --reintegrate 选项是否在 base 的更改以樱桃挑选的方式合并到主干时是否有效，而不是合并从 BASE+NEXT 到 HEAD 的所有内容。

**更新：**当使用Subversion 1.5 及更高版本的 svn merge *--reintegrate*选项时，似乎也[应该支持樱桃采摘。](http://svnbook.red-bean.com/nightly/en/svn.branchmerge.advanced.html#svn.branchmerge.cherrypicking)遵循这些说明应该允许您重新集成，而不会由于重新引入变基更改修订而导致意外冲突。

 *有关更多信息，请阅读标题为[保持分支同步](http://svnbook.red-bean.com/en/1.5/svn.branchmerge.basicmerging.html#svn.branchemerge.basicmerging.stayinsync)的部分下的 Subversion 书籍。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T22:03:26.883

也许我在这里遗漏了一些东西，但听起来最简单的选择是删除主干并通过从较新的发布分支分支来重新创建它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T22:15:54.380

从理论上讲，您可以从树干的头部到树枝的头部“合并两棵不同的树”。这*应该*避免由于重新集成而引起的任何奇怪的冲突。

# c++ - 多线程 C 程序中的信号量互斥并发问题

> ID：850305
> 
> 赞同：1
> 
> 时间：2009-05-11T22:01:16.527
> 
> 标签：c++, c

如何设计多线程 C 程序以避免信号量互斥并发

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-11T22:07:36.330

有几种方法。

最好的方法是消除线程之间的所有共享数据。虽然这并不总是可行的，但尽可能多地消除共享数据总是好的。

之后，您需要开始研究无锁编程。无锁编程现在有点流行，但一个肮脏的秘密是，使用基于锁的并发（如互斥锁和信号量）通常是一个更好的主意。无锁编程很难正确。查阅 Herb Sutter 关于该主题的文章或维基百科页面。有很多关于无锁同步的好资源。

介于两者之间的是关键部分。如果你在 Windows 上编程，关键部分应该优先于互斥锁，因为它们会做一些工作来避免完全互斥锁锁定和解锁的开销。首先尝试这些，如果您的性能无法接受（或者您的目标平台没有关键部分），那么您可以研究无锁技术。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T22:18:15.360

最好编程少锁代码。这很难，但可能。

[GCC 原子内置](http://gcc.gnu.org/onlinedocs/gcc/Atomic-Builtins.html)

[Andrei Alexandrescu 的文章 (C++)](http://www.ddj.com/cpp/184401865)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T22:28:00.853

确保在线程之间*传递数据结构，始终知道数据**专*属于哪个线程。如果您使用（如 Dan 之前提到的）eq 无锁队列来传递您的数据，那么您不应该遇到太多并发问题（因为您的代码的行为更像任何其他等待数据到达的代码）。

但是，如果您要将单线程代码迁移到多线程代码 - 这是完全不同的野兽。这很难。而且大多数时候没有优雅的解决方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T05:04:10.847

另外，请查看`InterlockedXXX`在多线程环境中执行原子操作的系列。

*   [互锁增量](http://msdn.microsoft.com/en-us/library/ms683614(VS.85).aspx)函数
*   [联锁递减](http://msdn.microsoft.com/en-us/library/ms683580(VS.85).aspx)函数
*   [联锁交换](http://msdn.microsoft.com/en-us/library/ms683590(VS.85).aspx)功能

# c# - 时间：2019-03-10 标签：c#deriving from int32

> ID：850306
> 
> 赞同：25
> 
> 时间：2009-05-11T22:01:20.957
> 
> 标签：c#

我有几个班级，成员名为“Id”。最初我想将这些存储为整数，但我想要一些保护层，以确保我不会意外地将房间 ID 分配给一个人等。

一种解决方案是 typedef（使用 RoomId = System.Int32;），但我需要在所有文件中使用这些代码行。我更喜欢从 int32 派生的 RoomId 类，但我不知道如何设置它以允许显式转换（用于初始化）

还是我应该以其他方式做到这一点？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-05-11T22:28:58.540

您不能派生自`Int32`，但可以指定隐式转换，这可能会为您提供所需的行为：

```
public struct RoomId
{
    private int _Value;

    public static implicit operator RoomId(int value)
    {
        return new RoomId { _Value = value };
    }

    public static implicit operator int(RoomId value)
    {
        return value._Value;
    }
}

// ...

RoomId id = 42;

Console.WriteLine(id == 41);    // False
Console.WriteLine(id == 42);    // True
Console.WriteLine(id < 42);     // False
Console.WriteLine(id > 41);     // True
Console.WriteLine(id * 2);      // 84 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-11T22:03:50.890

```
 public static explicit operator RoomId(int value) {
     return new RoomId { Id = value };
 } 
```

然后你可以这样做：

```
 RoomId variable = (RoomId)10; 
```

`Int32`不能从C# 中的任何其他值类型派生类。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-11T22:06:41.167

如果我理解正确，您真正需要的唯一操作是比较是否相等。您可以创建一个 RoomId 类（或结构，以适合您的方式）

```
class RoomId
{
    private int Value {get; set;}

    public RoomId(int value)
    {
        this.Value = value;
    }

    public bool Equals(RoomId other)
    {
        return this.Value == other.Value;
    }
}

RoomId room1 = new RoomId(1);
RoomId room2 = new RoomId(2);

// To compare for equality
bool isItTheSameRoom = room1.Equals(room2);
// Or if you have overloaded the equality operator (==)
bool isItTheSameRoom = room1 == room2; 
```

如果需要，您可以实现 IEquatable、重载相等和不等运算符。如果您需要持久性，您可以实现 ISerializable 接口以确保整数值仅在真正需要时“转义”类。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-11T22:04:20.577

您不能在 .NET 中继承值类型（结构，包括 Int32）。

最接近的选择是制作一个只包含 Int32 的结构。这将需要相同的空间，但可能仅限于您的确切结构。如果需要，您可以稍后更改您的结构以包含其他信息。（但请注意，这可能是一个破坏性的 API 更改。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-08-09T04:29:32.410

我的偏好是使用简单的 T4 模板即时生成自定义类型。这是我最近在个人项目中使用的一个示例。第 10 行是生成的类型列表。这些东西过去都是`int`，但现在它们都是强类型的。

通过避免通常的“原始痴迷”反模式，这也使您的代码朝着使用更多功能范式的方向发展。

这是我正在使用的模板。随时更新/修改（如果您添加任何有用的内容，请告诉我们其他人）。

```
<#@ template debug="false" hostspecific="false" language="C#" #>
<#@ assembly name="System.Core" #>
<#@ import namespace="System.Linq" #>
<#@ import namespace="System.Text" #>
<#@ import namespace="System.Collections.Generic" #>
<#@ output extension=".cs" #>
<#

// List of types to generate:
var createTypeList = new[] { "XDim", "YDim", "YDelta", "DelayValue", "HValue", "Score", "TplIndexValue" };

#>
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Diagnostics.Contracts;
// ReSharper disable CheckNamespace

<#
    for(int i = 0; i < createTypeList.Length; i++) 
    {
        var typeName = createTypeList[i];
#>

    [ImmutableObject(true)]
    public struct <#=typeName#> : IComparable<<#=typeName#>>
    {
        public <#=typeName#>(int value) { Value = value; }

        [Pure] public int Value { get; }
        [Pure] public bool Equals(<#=typeName#> other) => Value == other.Value;

        [Pure]
        public override bool Equals(object obj)
        {
            if (ReferenceEquals(null, obj)) return false;
            if (Equals(this, obj)) return true;
            return obj.GetType() == GetType() && Equals((<#=typeName#>)obj);
        }

        [Pure]
        public override int GetHashCode()
        {
            unchecked
            {
                return (base.GetHashCode() * 397) ^ Value;
            }
        }

        [Pure] public static bool operator ==(<#=typeName#> left, <#=typeName#> right) => Equals(left, right);
        [Pure] public static bool operator !=(<#=typeName#> left, <#=typeName#> right) => !Equals(left, right);
        [Pure] public int CompareTo(<#=typeName#> other) => Equals(this, other) ? 0 : Value.CompareTo(other.Value);
        [Pure] public static bool operator <(<#=typeName#> left, <#=typeName#> right) => Comparer<<#=typeName#>>.Default.Compare(left, right) < 0;
        [Pure] public static bool operator >(<#=typeName#> left, <#=typeName#> right) => Comparer<<#=typeName#>>.Default.Compare(left, right) > 0;
        [Pure] public static bool operator <=(<#=typeName#> left, <#=typeName#> right) => Comparer<<#=typeName#>>.Default.Compare(left, right) <= 0;
        [Pure] public static bool operator >=(<#=typeName#> left, <#=typeName#> right) => Comparer<<#=typeName#>>.Default.Compare(left, right) >= 0;
        [Pure] public override string ToString() => $"{nameof(Value)}: {Value}";
    }
<#
    }
#> 
```

# mysql - MySQL Cluster 可以处理 TB 级的数据库吗

> ID：850307
> 
> 赞同：6
> 
> 时间：2009-05-11T22:01:24.703
> 
> 标签：mysql, cluster-computing

我必须研究提供 MySQL 数据库的解决方案，该数据库可以处理 TB 范围内的数据量并具有高可用性（五个九）。每个数据库行可能有一个时间戳和最多 30 个浮点值。预期工作负载高达 2500 次插入/秒。查询可能不太频繁，但可能很大（可能涉及 100Gb 的数据），尽管可能只涉及单个表。

我一直在研究 MySQL Cluster，因为那是他们的 HA 产品。由于数据量大，我需要使用基于磁盘的存储。实际上，我认为只有时间戳可以保存在内存中，而所有其他数据都需要存储在磁盘上。

有没有人在这种规模的数据库上使用 MySQL Cluster 的经验？它甚至可行吗？基于磁盘的存储如何影响性能？

我也愿意接受其他关于如何实现这一数据量的预期可用性的建议。[例如，使用像Sequoia](http://community.continuent.com/community/sequoia)这样的第三方库来处理标准 MySQL 实例的集群会更好吗？还是基于 MySQL 复制的更直接的解决方案？

唯一的条件是它必须是基于 MySQL 的解决方案。我不认为 MySQL 是处理我们正在处理的数据的最佳方式，但这是一个硬性要求。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-11T22:17:46.843

速度方面，可以处理。大小方面，问题不在于数据的大小，而在于索引的大小，因为索引必须完全适合内存。

我很乐意提供更好的答案，但高端数据库工作非常依赖于任务。我需要更多地了解数据的情况才能提供进一步的帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T23:58:07.070

好的，我*确实*阅读了关于 mySQL 是一项硬性要求的部分。

话虽如此，让我首先指出您所说的工作负载——2500 次插入/秒、罕见的查询、可能具有高达整个数据集 10% 的结果集的查询——几乎是微不足道的适用于任何关系数据库系统。

（这让我想起了很久以前的一个项目，在该项目中，我有一个硬性要求，即在不到 300 秒的时间内通过 9600 波特 RS-422 线路（也是硬性要求）加载 100 兆字节的程序数据（也是硬性要求。 ) 1kbyte/sec × 300 seconds = 300kbytes 的事实似乎没有通信。）

然后是关于“*最多*包含30 个浮点数”的部分。措辞至少表明每次插入的样本数量是可变的，这反过来又表明了一些规范化问题——或者需要使每行 30 个条目宽并使用 NULL。

但话虽如此，好吧，您说的是 300Kbytes/sec 和 2500 TPS（假设这确实是一系列不相关的样本）。至少，这[组基准表明它并非不可能。](http://dimitrik.free.fr/db_STRESS_MySQL_540_and_others_Apr2009.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T00:01:16.877

[这篇文章](http://www.mysqlperformanceblog.com/2006/06/09/why-mysql-could-be-slow-with-large-tables/)非常有助于确定什么会降低大型 MySQL 数据库的速度。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-11-23T17:27:02.677

可能尝试休眠分片并在 10 个节点上运行 MySQL，每个节点 1/2 TB，这样您就可以处理 5 TB 了；）我认为远远超出了您的限制？

# sql - 如何插入只有一个 IDENTITY 列的表？

> ID：850327
> 
> 赞同：88
> 
> 时间：2009-05-11T22:08:34.613
> 
> 标签：sql, sql-server, identity

（在尝试回答[另一个](https://stackoverflow.com/questions/850017/how-to-manage-groups-in-the-database/850049#850049)问题的过程中提出了这个问题）

考虑下面的 MS-SQL 表，称为 GroupTable：

```
组ID
--------
1  
2  
3  

```

其中 GroupID 是主键并且是一个标识列。

**如何在不**使用 IDENTITY_INSERT ON的情况下向表中插入新行（从而生成新 ID） ？

请注意：

```
INSERT INTO GroupTable() Values () 
```

……行不通。

编辑：我们在这里谈论 SQL 2005 或 SQL 2008。

* * *

## 回答 #1

> 赞同：132
> 
> 时间：2009-05-11T22:13:17.507

这应该有效：

```
INSERT INTO GroupTable DEFAULT VALUES 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-05-11T22:14:04.727

干得好：

```
INSERT INTO GroupTable DEFAULT VALUES 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-10-28T11:35:13.013

一次可以插入多行。

例如，插入 30 行。插入 GroupTable 默认值 GO 30

This will insert 30 rows by incrementing the identity column each time.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T22:12:22.220

您可以尝试使用序列或类似的东西吗？您从序列中选择的位置，它将为您提供序列中的下一个值。

# permissions - 如何从作为网络服务运行的 ASMX Web 服务写入自定义事件日志？

> ID：850331
> 
> 赞同：0
> 
> 时间：2009-05-11T22:09:29.057
> 
> 标签：permissions, service, events, logging

我有一个作为“网络服务”运行的 ASMX Web 服务。**我希望能够在**每次调用 Web 服务时（以及发生错误时）写入自定义事件日志。

我使用以下代码在 Windows server 2008 机器上以管理员身份运行创建了一个新的事件日志 (MyLog)：

```
 if (!EventLog.SourceExists(APPLICATIONNAME))
            {
                EventLog.CreateEventSource(APPLICATIONNAME, EVENTLOGNAME);
            }
            EventLog.WriteEntry(APPLICATIONNAME, "Service started", EventLogEntryType.Information); 
```

其中 APPLICATIONAME 是“MyApp”，EVENTLOGNAME 是“MyLog”（更改名称以保护无辜者）。

首先，它创建一个新的“MyLog”事件日志（通过 eventvwr 验证），但其内容与应用程序事件日志相同。我期待得到一个空的、未连接的事件日志。

其次，当我尝试使用以下代码从 Application_Start 方法中写入新创建的事件日志时：

```
EventLog.WriteEntry(APPLICATIONNAME, "Service started", EventLogEntryType.Information); 
```

我得到一个**System.Diagnostics.EventLogPermission**类型的**SecurityException**。

 **我试图更改注册表中“MyLog”配置单元的 ACL（如[MSDN 上所建议的](http://msdn.microsoft.com/en-us/library/aa363648.aspx)那样），但无济于事。

我宁愿不更改 Web 服务的身份，也不更改系统上其他应用程序使用的应用程序事件日志上的 ACL。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-15T20:57:51.013

由于我的 Web 服务在 SharePoint 的上下文中运行，因此我只需使用**SPSecurity.RunWithElevatedPrivileges**包装对 EventLog.WriteEntry 的调用。

# cocoa - 如何为 GUI Cocoa 应用程序创建命令行前端？

> ID：850333
> 
> 赞同：4
> 
> 时间：2009-05-11T22:11:00.800
> 
> 标签：cocoa, xcode, user-interface, command-line

我正在创建一个主要是 GUI Cocoa 应用程序，但我还想创建一个命令行前端来打印相同的数据，以便我可以使用[geektool](http://projects.tynsoe.org/en/geektool/)显示它。

我猜我需要在我的 Xcode 项目中创建一个额外的命令行自定义可执行文件并将其与 GUI 可执行文件一起构建？是否有关于如何执行此操作的教程？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-11T22:23:44.477

[您可以使用 XCode 构建多个目标](http://www.fousa.be/blog/building-multiple-targets-in-xcode)。正如您所建议的，只需将您的第二个目标设为命令行工具（当您创建新目标时，只需在新项目助手的“命令行实用程序”下选择适当的选项）。

*编辑：*也可以[将您的命令行工具嵌入到您的应用程序中](http://www.smallersystems.com/blogs/mar/2008/05/23/embedding-a-command-line-tool-within-a-cocoa-application/) *，*甚至可以让一个可执行文件完成这两项工作。如果您希望能够分发您的应用程序并将其与您的（单独的）命令行工具一起提供，那么嵌入您的命令行应用程序可能会很有趣。

要让一个可执行文件完成这两项工作，您必须[在 main 中接受命令行参数](http://unixjunkie.blogspot.com/2006/07/command-line-processing-in-cocoa.html)（通常`main.m`由 XCode 为您生成）。但是，这可能会变得混乱，因此最好只拥有一个单独的前端。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T22:19:51.147

[这本书](https://rads.stackoverflow.com/amzn/click/com/0974078506)可能是在 Mac OS X 上编写 CLI 应用程序的最佳出版资源。

# javascript - 如何解决 JavaScript 的 parseInt 八进制行为？

> ID：850341
> 
> 赞同：283
> 
> 时间：2009-05-11T22:14:11.437
> 
> 标签：javascript, integer, octal

尝试在 JavaScript 中执行以下命令：

```
parseInt('01'); //equals 1
parseInt('02'); //equals 2
parseInt('03'); //equals 3
parseInt('04'); //equals 4
parseInt('05'); //equals 5
parseInt('06'); //equals 6
parseInt('07'); //equals 7
parseInt('08'); //equals 0 !!
parseInt('09'); //equals 0 !! 
```

我刚刚学到了 JavaScript 认为前导零表示[八进制整数](http://en.wikipedia.org/wiki/Octal)的艰难方法，并且由于没有`"8"`or`"9"`在 base-8 中，该函数返回零。不管你喜不喜欢，[这是设计使然](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Functions/parseInt)。

有哪些解决方法？

*注意：为了完整起见，我即将发布解决方案，但这是我讨厌的解决方案，因此请发布其他/更好的答案。*

* * *

**更新：**

JavaScript 标准的第 5 版 ( [ECMA-262](http://www.ecma-international.org/publications/standards/Ecma-262.htm) ) 引入了消除此行为的重大更改。Mozilla 有一篇很好[的文章](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/parseInt#ECMAScript_5_Removes_Octal_Interpretation)。

* * *

## 回答 #1

> 赞同：331
> 
> 时间：2009-05-11T22:15:56.253

这是一个常见的 Javascript 问题，有一个简单的解决方案：

只需[指定基数](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/parseInt)或“基数”，如下所示：

```
parseInt('08',10); // 8 
```

您也可以使用[Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)：

```
Number('08'); // 8 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2010-01-05T14:15:58.903

如果您**知道**您的值将在有符号的 32 位整数范围内，那么`~~x`在所有情况下都会做正确的事情。

```
~~"08" === 8
~~"foobar" === 0
~~(1.99) === 1
~~(-1.99)  === -1 
```

如果您查找二进制 not ( `~`)，则规范要求对参数进行“ToInt32”转换，该参数明显转换为 Int32，并指定将`NaN`值强制为零。

是的，这是令人难以置信的hackish，但非常方便......

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-05-11T22:16:25.520

从[parseInt 文档](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Functions/parseInt)中，使用可选的 radix 参数来指定 base-10：

```
parseInt('08', 10); //equals 8
parseInt('09', 10); //equals 9 
```

这让我觉得迂腐、混乱和冗长（真的，每个 parseInt 中都有一个额外的参数？）所以我希望有更好的方法。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-05-11T22:19:14.423

```
function parseDecimal(s) { return parseInt(s, 10); } 
```

编辑：如果您不喜欢一直将“，10”添加到 parseInt() 调用中，则制作自己的函数来执行您真正想要的操作只是一种选择。它有一个非标准函数的缺点：如果你经常使用它对你来说更方便，但对其他人来说可能更混乱。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-05-11T22:16:36.440

指定基数：

```
var number = parseInt(s, 10); 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-05-12T00:44:18.320

如果 parseInt 没有第二个参数，那么用假定十进制的版本替换它会很淘气吗？（注意 - 未经测试）

```
parseIntImpl = parseInt
parseInt = function(str, base){return parseIntImpl(str, base ? base : 10)} 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2015-07-18T00:30:14.163

> **您也可以使用一元运算符 ( +** ) ，而不是使用 parseFloat 或 parseInt 。

```
+"01"
// => 1

+"02"
// => 2

+"03"
// => 3

+"04"
// => 4

+"05"
// => 5

+"06"
// => 6

+"07"
// => 7

+"08"
// => 8

+"09"
// => 9 
```

并且为了很好的衡量

```
+"09.09"
// => 9.09 
```

[MDN 链接](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Arithmetic_Operators)

> 一元加号运算符在其操作数之前并计算其操作数，但如果尚未将其转换为数字，则尝试将其转换为数字。虽然一元否定 (-) 也可以转换非数字，但**一元加法是将某物转换为数字的最快和首选方法**，因为它不对数字执行任何其他操作。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2012-01-20T03:20:07.243

十进制怎么样：

```
('09'-0) === 9  // true

('009'-0) === 9 // true 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2011-07-17T06:05:50.563

如果您已经使用 parseInt 完成了一堆编码并且不想将“，10”添加到所有内容，则可以重写该函数以使 base 10 成为默认值：

```
window._oldParseInt = window.parseInt;
window.parseInt = function(str, rad) {
    if (! rad) {
        return _oldParseInt(str, 10);
    }
    return _oldParseInt(str, rad);
}; 
```

这可能会使后来的读者感到困惑，因此制作 parseInt10() 函数可能更不言自明。就我个人而言，我更喜欢使用一个简单的函数，而不是一直添加“,10”——这只会为错误创造更多机会。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-10-09T19:29:51.413

此问题无法在最新的 Chrome 或 Firefox (2019) 中复制。

# sql-server - SQL 编码字符串参数，以便特殊字符起作用

> ID：850353
> 
> 赞同：1
> 
> 时间：2009-05-11T22:19:06.263
> 
> 标签：sql-server, stored-procedures

我希望能够添加一个新的 SQL LOGIN 并以个人电子邮件地址命名。例如“billg@example.com”。当我将它传递给以下存储过程时，我收到一个错误（错误跟随过程）。

存储过程：

```
CREATE PROCEDURE [Forms].[AddLogin]
    @Email nvarchar(2048),
    @TenantPassword nvarchar(2048)
AS
BEGIN
    -- SET NOCOUNT ON added to prevent extra result sets from
    -- interfering with SELECT statements.
    SET NOCOUNT ON;

    EXEC('CREATE LOGIN ' + @Email + ' WITH PASSWORD = ''' + @TenantPassword + ''', DEFAULT_DATABASE = DunderMifflin')
END 
```

错误：

```
Msg 102, Level 15, State 1, Line 1
Incorrect syntax near '.'. 
```

我确定我需要做的就是以某种方式对参数进行编码。有什么帮助吗？如果我通过 SQL 管理器向导添加用户，我可以指定电子邮件地址，这样我就知道它是一个有效的登录名。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T22:26:57.500

您应该可以用方括号括起来，[如下所述](http://msdn.microsoft.com/en-us/magazine/cc163523.aspx)：

```
EXEC('CREATE LOGIN [' + @Email + '] WITH PASSWORD = ''' + @TenantPassword + ''', DEFAULT_DATABASE = DunderMifflin') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T22:59:32.720

强制注入警告：无论你做什么，请不要将用户密码直接传递到这个例程中！！如果用户输入的密码是

```
bill');DROP DATABASE DunderMifflin;-- 
```

然后你基本上是在执行语句：

```
CREATE LOGIN billg@microsoft.com WITH PASSWORD = 'bill');
DROP DATABASE DunderMifflin;
-- ''', DEFAULT_DATABASE = DunderMifflin') 
```

这不好。

# wxwidgets - wxWidgets 使用 'new' 关键字

> ID：850368
> 
> 赞同：3
> 
> 时间：2009-05-11T22:25:04.553
> 
> 标签：wxwidgets, new-operator, keyword

对于wxWidgets，为什么要说：

```
MyFrame *frame = new MyFrame 
```

代替：

```
MyFrame frame; 
```

两者有什么区别？第二个更易读且更易于使用，但所有示例都使用第一个，所以我想知道原因是什么。

澄清一下，我知道第二个版本不起作用，但我想知道是否有特定的设计决定导致必须使用第一种形式而不是第二种形式。TIA。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-11T22:28:46.887

第一个在堆上分配一个新的 MyFrame 实例，并返回一个指向它的指针。第二个直接在堆栈上创建一个新的 MyFrame 实例。

您需要使用第一种语法的原因是您将将此框架（UI 元素）添加到另一个 UI 元素中，例如窗口。该窗口会将指针指向一个框架，并将其添加为子框架。

如果您使用第二种语法，则必须将指针传递给您的堆栈对象（&frame），这将编译，但是一旦您的方法返回，frame 的析构函数就会被调用，因为 frame 会超出范围。这将“破坏”窗口内的引用。

# c++ - 寻找非常相似的程序执行

> ID：850370
> 
> 赞同：2
> 
> 时间：2009-05-11T22:25:54.147
> 
> 标签：c++, c, unix

我想知道是否有可能/有人知道那里有任何工具来比较两个相关程序的执行（例如，课堂作业），看看它们有多相似。例如，不是比较函数的名称，而是比较它们如何使用系统调用。一个愚蠢的情况是测试一个 C 字符串是否在多个单独的程序中打印为（参见下面的示例~~）~~。

```
printf("%s",str) 
```

或者作为

```
for (i=0;i<len;i++) printf("%c",str[i]); 
```

我对此没有过多考虑，但我想 strace / ltrace（甚至可能是 oprofile）将是一个很好的起点。特别是，这适用于 UNIX C / C++ 程序。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T22:52:18.800

我认为你可以使用 valgrind 来做这种事情。

更细粒度的版本（取决于对程序源的访问权限以及您在比较方面确切想要的内容）将使用 kprobes。

> Kernel Dynamic Probes (Kprobes) 为内核模块提供了一个轻量级的接口，用于植入探针并注册相应的探针处理程序。探针是一个自动断点，它在执行（内核空间）模块中动态植入，无需修改其底层源。探针旨在用作需要对系统造成最小干扰的临时服务辅助工具。在不希望使用交互式调试器的生产环境中特别提倡使用它们。Kprobes 在测试和开发环境中也有很大的适用性。在测试期间，故障可能由探测模块注入或模拟。在开发中，可以轻松插入调试代码（例如 printk），而无需重新编译到被测模块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T22:28:47.077

最初的想法是使用 ltrace 和 strace 来记录调用，然后在日志上使用 diff。这显然只会涵盖系统调用的库。如果您需要更精细的日志记录，oprofile 可能会有所帮助。

如果您有权访问源代码，则可以通过使用分析信息编译代码来检测代码，然后在运行后解析 gcov 输出。如果您的代码没有根据外部数据/状态采用不同的路线，则纯静态源代码分析可能就足够了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T22:40:41.377

如果您可以访问这两个程序的源代码，您可以构建函数图（每个函数都是一个节点，如果 A 调用 B()，则从 A 到 B 有一条边），并计算一些图相似度指标。这将捕获通过重命名和重组生成的源代码副本。

# mysql - mysql更新/设置语句的速度。乘以一列

> ID：850373
> 
> 赞同：3
> 
> 时间：2009-05-11T22:27:24.503
> 
> 标签：mysql, performance

我在 MySql 表“temp”中有 100 万行，并希望将列“t”（int unsigned，indexed）乘以 1000。

```
mysql> update temp set t=1000*t; 
```

这个过程需要 25 秒。非索引列上的相同语句需要 10 秒；

任何想法如何使这个过程更快？我必须在超过 1e5 个表上应用它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T22:35:33.053

您可以在更新完成后关闭索引并重新打开

```
ALTER TABLE tbl_name DISABLE KEYS;
ALTER TABLE tbl_name ENABLE KEYS; 
```

或者，如果您使用的是 myISAM，您可以使用 delay_key_write 标志。您可以按表设置，也可以全局设置。您可以使用“FLUSH TABLE mytable”命令强制 mysql 更新索引的磁盘副本。

[http://dev.mysql.com/doc/mysql/en/create-table.html](http://dev.mysql.com/doc/mysql/en/create-table.html)

[http://dev.mysql.com/doc/mysql/en/myisam-start.html](http://dev.mysql.com/doc/mysql/en/myisam-start.html)

[http://dev.mysql.com/doc/mysql/en/flush.html](http://dev.mysql.com/doc/mysql/en/flush.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T22:31:02.780

索引与这里的问题无关。想想你在做什么——你正在改变表中的所有行，所以无论你如何选择它们，如果你在 t 上有一个索引，你仍然在扫描整个表。

UPDATE 操作 == IO 是您的瓶颈所在。获得更快的磁盘。

如果您使用的是 InnoDB，我唯一的建议是查看调整[innodb_flush_log_at_trx_commit](http://dev.mysql.com/doc/refman/5.1/en/innodb-parameters.html#sysvar_innodb_flush_log_at_trx_commit)并将其设置为 2 是否有助于您的性能，但我怀疑它只是 1 个查询。在 UPDATE 之后禁用键并重新启用它们在 InnoDB 中不起作用。

# c# - 在具有自定义属性的实体框架中使用部分类

> ID：850404
> 
> 赞同：0
> 
> 时间：2009-05-11T22:38:34.080
> 
> 标签：c#, asp.net, entity-framework

在将部分类与 EF 生成的类一起使用的情况下，我应该如何处理自定义属性？

这是设置：

TimeSheet Table - 这存储员工的时间
- TimeSheetID (auto, int, PK)
- EntryDate (DateTime)
- Hours (int)
- EmployeeID (int)

EmployeeHourlyRate 表 - 存储员工当前的小时费率。历史汇率也存储在这里。
- RateID (int, PK)
- EffectiveDate (int, PK)
- Rate (double)

这是从 TimeSheet 到 EmployeeHourlyRate 的一对多关系。为了找到员工的费率，我会选择小于 timeSheet 的 EntryDate 的最大有效日期。

为了方便起见，我创建了一个名为 TimeSheet 的分部类，并向该类添加了一个名为“Rate”的新属性。我想做的是从填充我的 TimeSheets 集合的同一查询中填充我自己。我只知道没有简单而干净的方法来处理这个问题。

例如，我可以这样做：

```
var list = from ts in Context.TimeSheets
          ....
          select new TimeSheet() {
                 TimeSheetID = ts.TimeSheetID,
                 EntryDate = ts.EntryDate,
                 Hours = ts.Hours,
                 EmployeeID = ts.EmployeeID,
                 Rate = SomeRate   //real code has been omitted 
          }; 
```

这在理论上应该可行，但由于某种原因，EF 在运行时抱怨我正在重新使用实体生成的类（不知道为什么——如果我创建自己的自定义类，它就可以正常工作）。但是，即使它确实有效，我仍然必须维护一个字段列表并继续从我的 EF 映射到单个类——即，当/如果我将新字段添加到 TimeSheet 表时，维护会成为一个问题。必须重新输入所有这些信息也很愚蠢。

所以我的问题是，人们通常如何处理这种情况？有没有办法在数据模型中做一些事情，能够有效地了解我的加入规则（关于根据我的 EntryDate 选择正确的生效日期）并处理这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T01:19:45.690

我想查看您的完整 LINQ 查询（包括“SomeRate”代码），以确切了解您想要实现的目标，但也许这样的事情可以工作：

警告：空气代码。

```
public partial class TimeSheet
{
    public double Rate
    {
        get //Calculate your rate here... e.g.
        {
            if ((this.Employee == null) || (this.Employee.EmployeeHourlyRates.Count == 0))
                //throw an exception

            EmployeeHourlyRate maxRate;
            foreach (EmployeeHourlyRate rate in this.Employee.EmployeeHourlyRates)
            {
                if ((rate.EffectiveDate <= this.EntryDate)
                    && ((maxRate == null) || (maxRate.EffectiveDate < rate.EffectiveDate)))
                {
                    maxRate = rate;
                }
            }

            if (maxRate == null)
                //throw exception
            else
                return maxRate.Rate;
        }
    }
} 
```

编辑：添加急切加载示例以避免数据库往返。

```
var list = from ts in Context.TimeSheets.Include("Employee.EmployeeHourlyRate")
           where blah blah
           select ts; 
```

# procedural-music - 什么是通过编程创作音乐的好 API？

> ID：850412
> 
> 赞同：13
> 
> 时间：2009-05-11T22:42:07.210
> 
> 标签：procedural-music

我正在研究用程序生成的音乐来玩。我希望找到一个真正简单的 API，我可以在其中调用乐器、音符、持续时间并将歌曲串在一起（我当然会接受任何东西，但这是我的偏好）。有没有这样做的图书馆？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-11T22:48:57.150

你最好的选择是一个音乐编程环境，其中有几个。

[Csound](http://en.wikipedia.org/wiki/Csound)是最著名的之一。这是他们的[网站](http://www.csounds.com/)。

[Max MSP](http://www.cycling74.com/products/max5)也是另一个广泛使用的选项，它也提供了一个可视化的编程界面。然而，它是商业的。

另一个众所周知的选项（并被实验电子音乐家广泛使用）是[SuperCollider。](http://en.wikipedia.org/wiki/SuperCollider) [这](http://supercollider.sourceforge.net/)是它的网页。

这是描述类似语言/环境的[维基百科文章。](http://en.wikipedia.org/wiki/Comparison_of_audio_synthesis_environments)

您还可以使用具有正确库的通用编程语言来完成音频/音乐工作。一方面，Java 提供了[Java Sound API](http://java.sun.com/products/java-media/sound/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-01-05T17:13:02.113

[JFugue](http://www.JFugue.org)是专门为支持程序生成音乐而开发的。它是一个免费的开源 (LGPL) Java API。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T22:46:43.753

很难给出具体的建议，因为您没有指定语言。大多数语言都有一个不错的[MIDI](http://en.wikipedia.org/wiki/Midi)库，这将是我首先要看的地方，除非你需要比 MIDI 格式允许的更重的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T22:50:43.437

您可能想看看 [Common Music](http://commonmusic.sourceforge.net)。
它是一个音乐创作系统，将音乐过程和结构的高级算法表示转换为用于声音合成和显示的各种控制协议

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-11T22:51:07.693

也许[生成音乐](http://en.wikipedia.org/wiki/Generative_music)是一个好的开始。 [谷歌搜索](http://www.google.com/search?q=procedurally+generating+music&ie=UTF-8&oe=UTF-8)也引导了几个有趣的链接。[Brian Eno](http://en.wikipedia.org/wiki/Brian_Eno#Generative_music)为 Spore 创作了程序生成的音乐。

# web-services - 我应该如何做一个 ISerializable 流（或足够接近）

> ID：850415
> 
> 赞同：1
> 
> 时间：2009-05-11T22:43:21.247
> 
> 标签：web-services, soap, stream

我有一个通过 SOAP 访问的 Web 服务。我真的很喜欢其中一种返回 Stream 的方法。

*我有哪些选择？*

我现在的想法是实现 Stream 并将所有数据填充到一个字符串中。有没有一种已经这样做的类型？如果可能的话（我不认为是这样），我很想通过 SOAP 对流进行真正的隧道传输，以便即使在方法返回后数据也会被延迟提取。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T19:16:22.800

您最好的选择是将 Stream 读入字节数组。然后，您可以在 Web 服务中序列化字节数组。然后，客户端可以使用原始字节数组并将其重新组装成原始格式。

我也使用相同的策略通过 Web 服务上传文件，效果很好。

# c# - 如何从控制台应用程序中访问 Properties 命名空间？

> ID：850416
> 
> 赞同：10
> 
> 时间：2009-05-11T22:43:40.453
> 
> 标签：c#, .net, properties, global-variables, application-settings

我正在尝试存储/检索存储在应用程序设置中的值。从我的控制台应用程序中，我似乎无法访问 Properties.Setting 命名空间。我的网上冲浪显示，在控制台应用程序中可能需要做更多的工作。如何做到这一点？

```
string test = Properties.Settings.Default.MyString; 
```

谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-11T22:53:19.593

默认情况下，控制台应用程序中没有设置文件。但是，您只需在解决方案资源管理器中右键单击您的项目，选择“属性”，然后在出现的窗口中单击“设置”选项卡，即可添加一个。

应该有一个链接说“单击此处创建默认设置文件”。创建完成后，您就可以参加比赛了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-07-04T13:41:52.403

1.  确保您使用的类的命名空间是项目的默认命名空间。

2.然后你可以使用

```
string s = Properties.Settings.Default.THENAMEINSETTINGS; 
```

.

[![在此处输入图像描述](https://i.stack.imgur.com/3Wiy1.png)](https://i.stack.imgur.com/3Wiy1.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T17:11:32.983

所以.. 一旦我在保存属性的项目中创建了我的 Settings.settings 文件，我遇到了如何从同一解决方案中的另一个项目访问这些属性的问题。设置对象是密封的，因此您必须使用一些技巧来访问另一个项目中的属性值。我在这里找到了我的解决方案：

[http://blog.decarufel.net/2007/10/getting-access-to-settings-in-another.html](http://blog.decarufel.net/2007/10/getting-access-to-settings-in-another.html)

基本上，您在尝试检索值的项目中创建指向 Settings.Designer.cs 文件的链接文件。

我希望这可以帮助有类似问题的人。

-缺口

# python - Python 2.6 Win32 (xp) 上的 Python 多处理

> ID：850424
> 
> 赞同：2
> 
> 时间：2009-05-11T22:46:37.920
> 
> 标签：python, winapi, multiprocessing, python-2.6

我试图从 jesse noller 的这个 Multiprocessing 讲座中复制这个例子（如另一篇 SO 帖子中所推荐的那样）[ [http://pycon.blip.tv/file/1947354?filename=Pycon-IntroductionToMultiprocessingInPython630.mp4]](http://pycon.blip.tv/file/1947354?filename=Pycon-IntroductionToMultiprocessingInPython630.mp4])

但由于某种原因，我遇到了一个错误，好像它忽略了我的函数定义：我在 Windows XP (win32)**上，我知道它对 2.6 中的多处理库有限制，要求一切都是可腌制的**

```
from multiprocessing import Process
import time

def sleeper(wait):
    print 'Sleeping for %d seconds' % (wait,)
    time.sleep(wait)
    print 'Sleeping complete'

def doIT():    
    p = Process(target=sleeper, args=(9,))
    p.start()
    time.sleep(5)
    p.join()

if __name__ == '__main__':
    doIT() 
```

输出：

```
Evaluating mypikklez.py
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "C:\Python26\lib\multiprocessing\forking.py", line 342, in main
    self = load(from_parent)
  File "C:\Python26\lib\pickle.py", line 1370, in load
    return Unpickler(file).load()
  File "C:\Python26\lib\pickle.py", line 858, in load
    dispatch[key](self)
  File "C:\Python26\lib\pickle.py", line 1090, in load_global
    klass = self.find_class(module, name)
  File "C:\Python26\lib\pickle.py", line 1126, in find_class
    klass = getattr(mod, name)
AttributeError: 'module' object has no attribute 'sleeper' 
```

导致问题的错误是：AttributeError: 'module' object has no attribute 'sleeper'

一个功能如此简单，我无法理解会有什么问题。

这只是为了基本概念的自学目的。我不想预先优化任何现实世界的问题。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-11T22:50:49.083

从追溯看来，您正在将代码直接运行到 python 解释器（REPL）中。

不要那样做。将代码保存在文件中，然后使用以下命令从文件中运行它：

```
python myfile.py 
```

这将解决您的问题。

* * *

作为一个不相关的说明，这一行是错误的：

```
print 'Sleeping for ' + wait + ' seconds' 
```

它应该是：

```
print 'Sleeping for %d seconds' % (wait,) 
```

因为你不能连接 string 和 int 对象（python 是强类型的）

# iphone - 在 iPhone 上使用 UITableView Outlet 从 UIViewController 修改 UITableViewCell

> ID：850426
> 
> 赞同：0
> 
> 时间：2009-05-11T22:47:26.000
> 
> 标签：iphone, cocoa-touch, uitableview

情况如下，

我有 UIViewController 类和 UITableView 插座。我想修改/设置单元格的样式。我相信我可以用 UITableViewCells tableviewCellWithReuseIdentifier 方法做到这一点。由于我的类不是 UITableViewController 它没有这个方法。如何从 UIViewController 类中使用此方法。

另外我知道我可以创建一个自定义 UITableViewCell 类并将其实例化而不是常规 UITableViewCell 类，但是无论如何我可以在 UIViewController 类中执行此操作吗？

谢谢，乔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-11T23:13:54.600

UITableViewController 本质上是一个带有 UITableView 实例的 UIViewController，并且 viewController 本身设置为 table 的`delegate`and `dataSource`（这意味着 viewController 为这些委托方法实现了存根）。

你可以通过让你的 UIViewController 实现`UITableViewDataSource`和`UITableViewDelegate`协议来自己做。然后在 UIViewController 的`loadView`（或`viewDidLoad`）方法中将 tableView 实例的`dataSource`和设置`delegate`为`self`。

要返回自定义单元格，请在您的 UIViewController 中实现该`cellForRowAtIndexPath`方法并返回自定义单元格。

此外，请查看 Matt Gallagher 的帖子，了解无需继承 UITableViewCell 子类即可自定义表格单元格的方法：http: [//cocoawithlove.com/2009/04/easy-custom-uitableview-drawing.html](http://cocoawithlove.com/2009/04/easy-custom-uitableview-drawing.html)

# .net - 为什么 IpcChannel 告诉我“无法打开匿名级别的安全令牌？”

> ID：850427
> 
> 赞同：5
> 
> 时间：2009-05-11T22:47:33.707
> 
> 标签：.net, remoting

我有一个非常简单的客户端-服务器应用程序，我用它来分隔两个不能在同一进程中一起存在的组件。在开发它们时（服务器是一个 exe，客户端是一个库），我所有的单元测试都像粪肥中的猪一样快乐。当我继续在其他地方重新使用该库时，出现以下异常：

```
System.Runtime.Remoting.RemotingException: An error occurred while processing the request on the server: System.Security.SecurityException: Cannot open an anonymous level security token.

   at System.Security.Principal.WindowsIdentity.GetCurrentInternal(TokenAccessLevels desiredAccess, Boolean threadOnly)
   at System.Security.Principal.WindowsIdentity.GetCurrent()
   at System.Runtime.Remoting.Channels.Ipc.IpcServerTransportSink.ServiceRequest(Object state)
The Zone of the assembly that failed was:
MyComputer. 
```

为了简单起见，我在代码中设置了双方的远程处理，而不是配置文件。它们实际上是相同的：

```
BinaryClientFormatterSinkProvider client = new BinaryClientFormatterSinkProvider();
BinaryServerFormatterSinkProvider server = new BinaryServerFormatterSinkProvider();
server.TypeFilterLevel = TypeFilterLevel.Full;

Hashtable config = new Hashtable();
config["name"] = "SomeName";
config["portName"] = "SomePortName";

config["typeFilterLevel"] = "Full";
config["impersonate"] = "true";
config["tokenImpersonationLevel"] = "Impersonation";
config["useDefaultCredentials"] = "True";
config["secure"] = "True";

Channel = new IpcChannel(config, client, server); 
```

所以问题是：为什么远程处理框架要在启用模拟时创建一个匿名令牌？我已经完全没有地方可以寻找答案了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-08-20T00:45:32.310

这不是答案

我知道这是一个老问题，但也许有人找到了解决方案。我有与作者类似的设置，但只需要识别级别：

服务器端：

```
Dictionary<string, object> properties = new Dictionary<string, object>();
properties["authorizedGroup"] = GetUsersGroupName();
properties["name"] = configuration.ServiceShortName + ".Server";
properties["portName"] = configuration.ServiceGuid;
BinaryServerFormatterSinkProvider sinkProvider = new BinaryServerFormatterSinkProvider();
sinkProvider.TypeFilterLevel = TypeFilterLevel.Full;
Channel = new IpcServerChannel(properties, sinkProvider);
Channel.IsSecured = true;
ChannelServices.RegisterChannel(Channel, true);
RemotingConfiguration.RegisterWellKnownServiceType(typeof(AppManagerServer), configuration.ServerObjectUrl, WellKnownObjectMode.SingleCall);

string GetUsersGroupName()
{
        const string builtInUsersGroup = "S-1-5-32-545";
SecurityIdentifier sid = new SecurityIdentifier(builtInUsersGroup);
NTAccount ntAccount = (NTAccount)sid.Translate(typeof(NTAccount));
        return ntAccount.Value;
} 
```

客户端：

```
channel = new IpcClientChannel(AppManagerConfiguration.Instance.ServiceShortName + ".Client", null);
ChannelServices.RegisterChannel(channel, true);
string appManagerUrl = "ipc://" + AppManagerConfiguration.Instance.ServiceGuid + "/" + AppManagerConfiguration.Instance.ServerObjectUrl;
(IAppManager)Activator.GetObject(typeof(IAppManager), appManagerUrl).DoSomething(); 
```

然后间歇性地我得到以下信息： **处理服务器上的请求时发生错误：System.Security.SecurityException：无法打开匿名级别的安全令牌。**

在 System.Security.Principal.WindowsIdentity.GetCurrentInternal(TokenAccessLevels desiredAccess, Boolean threadOnly)

在 System.Security.Principal.WindowsIdentity.GetCurrent()

在 System.Runtime.Remoting.Channels.Ipc.IpcServerTransportSink.ServiceRequest（对象状态）

失败的程序集区域是：MyComputer

# objective-c - 在 UITableView 的一部分中带有选项卡切换动画的类似选项卡的东西

> ID：850431
> 
> 赞同：1
> 
> 时间：2009-05-11T22:48:25.547
> 
> 标签：objective-c, iphone, cocoa-touch

我在我的 iPhone 应用程序中有一个 UITableView 部分，它看起来类似于在标准联系人应用程序中查看联系人详细信息。在其中一个部分中，我将 UISegmentedControl 设置为该部分的标题，该部分中的项目取决于在分段控件中选择了哪个段。我想做的是让动画将一个选项卡的行移出视图到一侧，并将另一个选项卡的行从另一侧移入。我已经设法通过使用默认 UITableView 的动画插入/删除相应的行来实现这一点，但是当一个选项卡中的行数与另一个选项卡中的行数不同时，它看起来有点奇怪。此外，它的代码也很讨厌。

这是我的代码（简化了一点）：

```
[self.tableView beginUpdates];
UITableViewRowAnimation delAnim = UITableViewRowAnimationRight;
UITableViewRowAnimation insAnim = UITableViewRowAnimationLeft;
NSUInteger numdel = [self.list count];
NSUInteger numins = [newlist count];
NSMutableArray* indices = [NSMutableArray arrayWithCapacity: numdel];
for (NSUInteger i = 0; i < numins; i++)
{
    [indices addObject: [NSIndexPath indexPathForRow: i  inSection: SECT]];
}
[self.tableView insertRowsAtIndexPaths: indices  withRowAnimation: insAnim];
[indices removeAllObjects];
for (NSUInteger i = 0; i < numdel; i++)
{
    [indices addObject: [NSIndexPath indexPathForRow: i  inSection: SECT]];
}
[self.tableView deleteRowsAtIndexPaths: indices  withRowAnimation: delAnim];
self.list = newlist;
[self.tableView endUpdates]; 
```

我对 Objective C 和 Cocoa 还很陌生，所以非常欢迎任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T00:02:35.800

您可以尝试使用直接在其中制作动画的单独表格视图。这里的代码片段只是即兴输入的，所以可能需要一些工作，但它至少应该给你一些指示：

```
- (void) switchToNewTableFromRight
{
    UITableView * newTableView = [[UITableView alloc] initWithFrame: self.tableView.frame style: self.tableView.style];

    // put it off to the right of the existing table
    CGRect frame = newTableView.frame;
    frame.origin.x += frame.size.width;
    newTableView.frame = frame;

    // set data for new table
    // you should ensure you're setup to supply data for the new table here, btw
    newTableView.delegate = self;
    newTableView.dataSource = self;
    [newTableView reloadData];

    // add to parent of current table view at this (offscreen) location
    [self.tableView.superview addSubview: newTableView];

    // now we animate
    [UIView beginAnimations: @"TableFromRight" context: newTableView];

    // set the function it should call when the animation completes
    [UIView setAnimationDelegate: self];
    [UIView setAnimationDidStopSelector: @selector(animation:finished:context:)];

    // set new table's frame to current table's frame
    newTableView.frame = self.tableView.frame;

    // set current table's frame to be offscreen to the left
    frame = self.tableView.frame;
    frame.origin.x -= frame.size.width;
    self.tableView.frame = frame;

    // commit the animations to start them going
    [UIView commitAnimations];
}

- (void) animation: (NSString *) animationID finished: (BOOL) finished context: (void *) context
{
    // could be a good idea to check that finished == YES here
    UITableView * newTableView = (UITableView *) context;
    self.tableView = newTableView;

    // newTableView has been inited but not autoreleased, etc.
    // now the controller (self) owns it, so release that first reference
    [newTableView release];
} 
```

这里的想法是您设置新表格（使其与现有表格大小相同），将其放置在现有表格右侧的屏幕外，然后为两个表格的左侧移动设置动画。这样，现有表格将在屏幕外移动，而新表格将在屏幕上移动。当动画完成时，它会调用提供的方法，让你有机会将新的表格视图变成正式的表格视图。

另一种选择是使用翻转过渡，可能是这样的：

```
// setup new table
UITableView * newTableView = [[UITableView alloc] initWithFrame: self.tableView.frame style: self.tableView.style];
newTableView.delegate = self;
newTableView.dataSource = self;
[newTableView reloadData];

[UIView beginAnimations: nil context: NULL];
[UIView setAnimationDuration: 1.0];
[UIView setAnimationTransition: UIViewAnimationTransitionFlipFromRight forView: self.tableView.superview cache: YES];

// generally here you'd remove the old view and add the new view
// I'm *assuming* that UITableViewController's -setTableView: will do the same thing
self.tableView = newTableView;

[UIView commitAnimations]; 
```

希望其中之一会产生预期的效果。

# delphi - 与 SQlite 一起使用的 Delphi 组件

> ID：850435
> 
> 赞同：10
> 
> 时间：2009-05-11T22:50:25.463
> 
> 标签：delphi, sqlite, components

我可以使用哪些组件来将 SQlite 数据库与 Delphi 6 一起使用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-11T23:20:59.860

[在http://zeos.firmos.at/portal.php](http://zeos.firmos.at/portal.php)尝试 Zeos 库。

它适用于 SQLite 等。

它是免费的，您也可以获得源代码。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-05-18T07:35:24.600

在这种情况下，我的答案是 AnyDAC。我们目前在这里使用它并且它有效。特别是当您认为您获得的不仅仅是数据库可以做的事情时。 [http://www.da-soft.com/anydac/](http://www.da-soft.com/anydac/)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-12T02:21:07.913

我在 FeedDemon 中使用[DISQLite3](http://www.yunqa.de/delphi/doku.php/products/sqlite3/index)并强烈推荐它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-11T23:34:51.803

[我已经成功使用了来自http://www.aducom.com](http://www.aducom.com)的 ASqlite 。

它是免费的开源软件。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-12T06:39:15.697

新的[DevArt UniDac](http://www.devart.com/news/2009/unidac270b.html)组件具有 Sqlite 提供程序

[Unidac](http://www.devart.com/unidac/)不是免费的，但强烈推荐它，它有非常稳定和快速的提供程序，支持 Oracle、MS SQL Server、MySql、Interbase、PostgreSql 和现在的 Sqlite。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-10-19T14:56:03.817

我们刚刚为 Delphi 6 验证了 Synopse SQlite3 框架。

你有一个完整的客户端/服务器 ORM 框架，使用 SQLite3 3.7.3 进行数据存储。它又快又轻。还有一些用户界面专用类（屏幕自动生成，直接导出 pdf 报告...）。

见[http://synopse.info/forum/viewforum.php?id=2](http://synopse.info/forum/viewforum.php?id=2)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-10-09T13:50:33.320

我使用[LiteDAC](http://www.devart.com/litedac/)（Devart 的 SQLite 组件）并且非常喜欢它，因为它允许将 SQLite 库静态链接到您的应用程序并具有内置的 SQlite 加密！所以我强烈推荐它

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-07-11T20:34:39.933

在 Delphi XE7 中，FireDAC 被集成到 Delphi 中。

[Embarcadero 在 2013 年收购了 DA-SOFT](http://www.embarcadero.com/press-releases/embarcadero-technologies-acquires-high-performance-enterprise-database-connectivity-technology-for-developers)，FireDAC 是他们更名为 AnyDAC。

Embarcadero 计划支持并继续开发 FireDAC，因此它现在是您的 SQLite 数据访问组件的绝佳选择。

# c++ - 将对象列表传递给另一个类 C++ 的问题

> ID：850436
> 
> 赞同：0
> 
> 时间：2009-05-11T22:50:27.710
> 
> 标签：c++

下面我编写了一个示例程序，用于学习如何将对象列表传递给另一个类。我在下面谈谈我遇到的问题。

```
#include <iostream>
#include <vector>
using namespace std;

class Integer_Class
{
 int var;
public:
 Integer_Class(const int& varin) : var(varin) {}
 int get_var() { return var; }
};

class Contains_List
{
 typedef Integer_Class* Integer_Class_Star;
 Integer_Class_Star list;
public:
 Contains_List(const Integer_Class_Star& listin) : list(listin) {}
 Integer_Class* get_list() { return list; }
};

int main (int argc, char * const argv[])
{
 // Create a vector to contain a list of integers.
 vector<Integer_Class> list;
 for(int i = 0; i < 10; i++)
 {
  Integer_Class temp_int(i);
  list.push_back(temp_int);
 } 
```

这是错误开始发生的地方。有人可以看看第二类定义和下面的代码，并阐明我做错了什么。非常感谢，一如既往！

```
 // Import this list as an object into another object.
 Contains_List final(list);

 // Output the elements of the list by accessing it through the secondary object.
 for(int i = 0; i < 10; i++)
 {
  cout << final.get_list()[i].get_var();
 }

 return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T23:02:15.930

你没有提到你得到了什么样的错误，但是你的代码的一个非常明显的问题是构造函数`Contains_List`需要一个指针，`Integer_Class`而你发送它的参数 ( `list`) 是 type `vector<Integer_Class>`。

向量与数组不同，因此您不能将其作为指针传递给它所包含的类型。要么更改您的构造函数以接受向量或指向向量的指针/引用，要么更改导致您出现问题的代码，以便它向其发送指向数组的指针。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T23:03:40.357

“Contains_List”构造函数接受“Integer_Class*”

您将“list”声明为“vector”类型，但将其传递给“Contians_List”构造函数。您应该更改“Contains_List”类，使其包含一个向量而不是 Integer_List 数组。两者不可互换。

如果您愿意，您也可以将向量更改为 Integer_List 的数组。

# javascript - 如何确定我的哪些标记在我的 Google 地图中可见？

> ID：850439
> 
> 赞同：3
> 
> 时间：2009-05-11T22:50:48.070
> 
> 标签：javascript, google-maps, google-maps-markers

这是我想要做的。我有大约 160 个名胜古迹。用户输入我使用 Google 进行地理编码的地址（邮政编码、完整地址等）。然后，我创建一个以该点为中心的谷歌地图，并为地图上的每个兴趣点添加一个标记（使用 MarkerManager）。到目前为止，一切都很好。

我想在地图旁边显示与正在显示的标记相对应的项目列表。当用户拖动窗口，或者放大或缩小，或者其他什么时，我想更新这个列表。如果一次显示的项目太多，我想向用户显示一条消息。

做这个的最好方式是什么？我尝试向 MarkerManager 添加一个侦听器，以便在它更改时我可以确定哪些标记仍然显示。然而，事件似乎并没有像我预期的那样触发，即当显示的标记发生变化时。此外，我怀疑每次循环超过 160 多个这样的标记是否有效。

```
 GEvent.addListener(mgr, "changed", 
                function(bounds, markerCount) 
                {
                    var visibleBounds = map.getBounds();

                    for (var i = 0; i < gmarkers.length; i++) 
                    {
                        //alert(gmarkers[i].getPoint());
                        if (visibleBounds.containsLatLng(gmarkers[i].getLatLng())) {

                            // this will need to be replaced with an ajax call
                            // to get the details from the server
                            strHtml += "<div>Another item</div>";
                            count ++;
                        }
                    }
                    alert(count);
                }); 
```

实现这一目标的最佳方法是什么？

**更新**：此代码有效，但该事件似乎仅在地图移动一定最小距离时触发。因此，如果用户将地图拖了一小段距离，该事件似乎不会触发。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T21:37:48.000

您需要监听“idle”事件，该事件在地图在平移或缩放后变为空闲时触发。

```
google.maps.event.addListener(map, 'idle', function() {
  var bounds = map.getBounds();
  ...
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T20:08:33.807

'changed' 事件仅在标记发生更改时触发，因此肯定会有小动作不会改变任何内容的情况。MarkerManager 大大扩展了它的工作范围，以使移动时更加顺畅（它显示在地图之外的标记，在一定距离内）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-08T17:00:37.273

要首先获取所有标记，您必须找到当前视口的边界，然后您必须循环所有标记并查看它们是否包含在边界中。下面是一个例子。

var bounds =map.getBounds();

```
for(var i = 0; i < markers.length; i++){ // looping through my Markers Collection        
if(bounds.contains(markers[i].position))
 console.log("Marker"+ i +" - matched");
} 
```

# javascript - 注入尽可能少的字符的javascript文件？

> ID：850450
> 
> 赞同：3
> 
> 时间：2009-05-11T22:53:01.200
> 
> 标签：javascript, code-golf, bookmarklet, minimize

我正在开发一个小书签，并认为我会面临一个挑战：如何从链接中以尽可能少的字符注入外部 javascript 文件。

这是我能想到的最短的：

```
javascript:(function(d){d.body.appendChild(d.createElement('script')).src='URL'})(document) 
```

那是没有 URL 的 88 个字符。

这里的 Stack Overflow javascript 大师能做得更好吗？我将接受字符最少的工作答案，所以戴上你的思考帽！

（有一件事：书签必须在所有主流浏览器中都可以使用。[这](http://pastie.org/309899)是一个聪明的解决方案，但不适用于所有主流浏览器，因为它会返回一个值。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-12T00:14:29.587

```
javascript:void(with(document)body.appendChild(createElement('script')).src='URL') 
```

79 个字符。感谢[Ben Blank](https://stackoverflow.com/users/46387/ben-blank)使用`void`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-11T23:19:40.737

我不知道你为什么要把它包装在一个函数外壳中——它似乎工作得很好，而且几乎没有十几个字符：

```
javascript:void(document.body.appendChild(document.createElement('script')).src='URL') 
```

但是，除此之外，您的实现看起来非常简约。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-09T18:08:11.083

假设 String.prototype 没有被污染，我们可以保存一些字符。

```
javascript:with(document)(body.appendChild(createElement('script')).src='URL')._ 
```

# ruby - 如何处理 OpenX XMLRPC 身份验证/会话

> ID：850452
> 
> 赞同：1
> 
> 时间：2009-05-11T22:54:20.887
> 
> 标签：ruby, xml-rpc, openx

我在使用 Openx 时遇到问题；这是问题

OpenX::Services::Base.connection 返回由 OpenX::Services::Base.connection 填充的类变量@@connection，如果它之前没有被初始化。

它是一个类变量的问题是它在连接中持续存在，这意味着如果活动中存在停顿，我的站点和 OpenX 之间的 XMLRPC 会话将超时，并且 OpenX API 没有用于通信过期会话的规定，无论如何这都是浪费的，因为它需要在每次通信之前请求一个请求，以验证会话是否仍然有效。

我认为更好的方法是在任何需要 OpenX 支持的请求开始时实例化一个连接，并在最后关闭它，确保会话不会超时XMLRPC 方面的事情。

使用 OpenX / OpenX XMLRPC 时有没有其他人遇到过这种情况？如果是这样，您是如何解决此问题的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-10-04T11:00:19.030

我在 OpenX RPC 调用周围有一个 try/catch 块，并且我编写了一个异常翻译器。如果我检测到会话超时，我将再次执行登录操作，我将获取新的会话 ID，并再次运行失败的 OpenX 调用。为了使会话保持活动状态，它比拥有一个 cron 作业要复杂一些，但性能和鲁棒性更高（在我看来）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-10T08:33:41.673

我们面临同样的问题。我们的解决方案：创建一个未经身份验证的控制器，它与 OpenX API 进行一些简单的交互（只是为了让它保持运行状态），并让这个 URL 由一个 cron 作业每 5-10 分钟调用一次。

你用了什么解决方案？

# c# - C# 中的远程 MSMQ 接收错误

> ID：850458
> 
> 赞同：0
> 
> 时间：2009-05-11T22:56:10.197
> 
> 标签：c#, msmq

我正在尝试从远程队列发送和接收。我可以让发送工作（我看到队列中的消息），但是，当我尝试接收时，我收到拒绝访问错误。我的计算机与远程队列的计算机位于不同的域中，所以我很确定这与问题有关。这是代码片段：

```
 MessageQueue queue = new MessageQueue(@"FormatName:DIRECT=OS:DEVAPP002\private$\queuetest");
   queue.Send("This is a test");
   Message msg = queue.Receive();  // Kaboom 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T00:07:49.097

要测试权限是否是您的问题，请检查匿名用户是否具有对队列的读/写访问权限。

每个人用户意味着登录域的每个人，至少就排队服务而言。

# apache-flex - 将 flash.utils.Dictionary 正确序列化为 SharedObject

> ID：850466
> 
> 赞同：3
> 
> 时间：2009-05-11T23:00:40.517
> 
> 标签：apache-flex, flash, serialization, shared-objects

我的 Flex 项目中有一个名为 HashMap 的便利集合类，它本质上是 flash.utils.Dictionary 的包装器，带有一堆便利方法和一个添加的（同步的）ArrayCollection，以便我可以将 HashMap 传递给需要的可绑定控件一个数组集合。这一切都很好。

我刚刚发现，不能正常工作的是将 HashMap 放在本地 SharedObject 中。

注册该类会导致它被存储并作为正确的类型返回，并且 ArrayCollection 成员很好地返回，但是 Dictionary 不存储它的数据..

这是一个片段：

```
[RemoteClass(alias="com.tamedtornado.collections.HashMap")]
public class HashMap extends Proxy
{
    public var hash:Dictionary = new Dictionary();

    // Keeps an array collection as well so we can give this to a data bound control

    [Bindable]
    public var collection:ArrayCollection = new ArrayCollection(); 
```

这就是相关的东西。让 Dictionary 正确存储自身的过程是什么？实际上，我必须使 ArrayCollection 瞬态，因为现在每次刷新 SO 时，我都会获得（在字典中唯一键入的）数据的另一个副本。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-12T00:12:44.800

我对此进行了更多修改，并得到了很多愚蠢的结果，试图让序列化“正常工作”，所以我终于实现了 IExternalizable 接口，并修复了它。

```
 public function readExternal(input:IDataInput):void
    {
        var hashCount:int = input.readInt();

        for (var i:int = 0;i<hashCount;i++)
        {
            var prop:Object = input.readObject();
            var val:Object = input.readObject();

            putEntry(prop,val);
        }
    }

    public function writeExternal(output:IDataOutput):void
    {
        output.writeInt(collection.length);

        for (var prop:Object in hash)
        {
            output.writeObject(prop);

            output.writeObject(hash[prop]);
        }
    } 
```

一切都被存储并正确输入。存储的对象必须是本地类（如 String），或者具有 [RemoteClass] 元数据标记/registerClassAlias() 调用。但除此之外，它还有效。

# php - Horde 是一个可接受的 PHP 群件开发框架吗？

> ID：850467
> 
> 赞同：2
> 
> 时间：2009-05-11T23:01:29.033
> 
> 标签：php, frameworks, horde

我正在处理这个项目，客户希望它与一个群件包集成，包括批量电子邮件、日历和任务列表。他听说过[Horde](http://www.horde.org/)和[Horde GroupWare](http://www.horde.org/groupware/)，并有兴趣使用它。

你有与 Horde 相关的开发者经验吗？如果是这样，那么你的发现是什么？你觉得它稳定吗？框架/API 怎么样？容易集成吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-03-18T13:49:24.823

我意识到这是一个迟到的答案，所以你的问题现在可能已经得到了回答，但是：

我参与的一个应用程序非常广泛地使用了 Horde，特别是 webmail 方面。框架/API/集成方面，这非常令人头疼——Horde 中有很多代码，如果您确实必须经常进入并经常接触代码，这将使其很快变得难以管理。

如果您想要的是更少的调整，更多的使用，那么您就有了一个强大的工具供您使用。我工作的*公司*将它广泛用于他们的目的，并且非常高兴。

我想这更符合你想要的，所以我会说继续。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-03T18:16:43.617

Horde 是适合您自己的自定义应用程序或增强现有模块的框架和应用程序系统。

[http://wiki.horde.org/CreatingYourFirstModule](http://wiki.horde.org/CreatingYourFirstModule)

或者：wiki.horde.org/PopulatingYourFirstModule

API 文档：[http ://dev.horde.org/](http://dev.horde.org/)

# c# - 如何在 C# 中使用 int64 索引对数组的一部分进行排序？

> ID：850468
> 
> 赞同：4
> 
> 时间：2009-05-11T23:01:34.230
> 
> 标签：c#, .net, arrays, sorting, int64

.Net 框架有一个 Array.Sort 重载，它允许指定排序的开始和结束索引。然而，这些参数只有 32 位。因此，当描述排序范围的索引只能使用 64 位数字指定时，我看不到对大型数组的一部分进行排序的方法。我想我可以复制和修改框架的排序实现，但这并不理想。

更新：

我创建了两个类来帮助我解决这些和其他大型数组问题。另一个这样的问题是，早在我达到内存限制之前，我就开始出现 OutOfMemoryException。我假设这是因为请求的内存可能可用但不连续。为此，我创建了 BigArray 类，它是一个通用的、可动态调整大小的数组列表。它比框架的通用列表类具有更小的内存占用，并且不需要整个数组是连续的。我还没有测试过性能命中，但我确定它在那里。

```
 public class BigArray<T> : IEnumerable<T>
  {
    private long capacity;
    private int itemsPerBlock;
    private int shift;
    private List<T[]> blocks = new List<T[]>();

    public BigArray(int itemsPerBlock)
    {
      shift = (int)Math.Ceiling(Math.Log(itemsPerBlock) / Math.Log(2));
      this.itemsPerBlock = 1 << shift;
    }

    public long Capacity
    {
      get
      {
        return capacity;
      }
      set
      {
        var requiredBlockCount = (value - 1) / itemsPerBlock + 1;
        while (blocks.Count > requiredBlockCount)
        {
          blocks.RemoveAt(blocks.Count - 1);
        }
        while (blocks.Count < requiredBlockCount)
        {
          blocks.Add(new T[itemsPerBlock]);
        }
        capacity = (long)itemsPerBlock * blocks.Count;
      }
    }

    public T this[long index]
    {
      get
      {
        Debug.Assert(index < capacity);
        var blockNumber = (int)(index >> shift);
        var itemNumber = index & (itemsPerBlock - 1);
        return blocks[blockNumber][itemNumber];
      }
      set
      {
        Debug.Assert(index < capacity);
        var blockNumber = (int)(index >> shift);
        var itemNumber = index & (itemsPerBlock - 1);
        blocks[blockNumber][itemNumber] = value;
      }
    }

    public IEnumerator<T> GetEnumerator()
    {
      for (long i = 0; i < capacity; i++)
      {
        yield return this[i];
      }
    }

    System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator()
    {
      return this.GetEnumerator();
    }

  } 
```

回到最初的排序问题……我真正需要的是一种按顺序对数组的每个元素进行操作的方法。但是对于如此大的数组，复制数据、对其进行排序、对其进行操作然后丢弃已排序的副本（必须保持原始顺序）是令人望而却步的。因此，我创建了静态类 OrderedOperation，它允许您按排序顺序对未排序数组的每个元素执行任意操作。并以低内存占用（此处以内存换取执行时间）来执行此操作。

```
 public static class OrderedOperation
  {
    public delegate void WorkerDelegate(int index, float progress);

    public static void Process(WorkerDelegate worker, IEnumerable<int> items, int count, int maxItem, int maxChunkSize)
    {
      // create a histogram such that a single bin is never bigger than a chunk
      int binCount = 1000;
      int[] bins;
      double binScale;
      bool ok;
      do
      {
        ok = true;
        bins = new int[binCount];
        binScale = (double)(binCount - 1) / maxItem;
        int i = 0;
        foreach (int item in items)
        {
          bins[(int)(binScale * item)]++;
          if (++i == count)
          {
            break;
          }
        }
        for (int b = 0; b < binCount; b++)
        {
          if (bins[b] > maxChunkSize)
          {
            ok = false;
            binCount *= 2;
            break;
          }
        }
      } while (!ok);

      var chunkData = new int[maxChunkSize];
      var chunkIndex = new int[maxChunkSize];
      var done = new System.Collections.BitArray(count);
      var processed = 0;
      var binsCompleted = 0;
      while (binsCompleted < binCount)
      {
        var chunkMax = 0;
        var sum = 0;
        do
        {
          sum += bins[binsCompleted];
          binsCompleted++;
        } while (binsCompleted < binCount - 1 && sum + bins[binsCompleted] <= maxChunkSize);
        Debug.Assert(sum <= maxChunkSize);
        chunkMax = (int)Math.Ceiling((double)binsCompleted / binScale);
        var chunkCount = 0;
        int i = 0;
        foreach (int item in items)
        {
          if (item < chunkMax && !done[i])
          {
            chunkData[chunkCount] = item;
            chunkIndex[chunkCount] = i;
            chunkCount++;
            done[i] = true;
          }
          if (++i == count)
          {
            break;
          }
        }
        Debug.Assert(sum == chunkCount);
        Array.Sort(chunkData, chunkIndex, 0, chunkCount);
        for (i = 0; i < chunkCount; i++)
        {
          worker(chunkIndex[i], (float)processed / count);
          processed++;
        }
      }
      Debug.Assert(processed == count);
    }
  } 
```

这两个类可以一起工作（这就是我使用它们的方式），但它们不是必须的。我希望其他人发现它们有用。但我承认，它们是边缘案例类。欢迎提问。如果我的代码很糟糕，我也想听听提示。

最后一个想法：正如您在 OrderedOperation 中看到的，我使用的是整数而不是长整数。目前这对我来说已经足够了，尽管我有最初的问题（应用程序在不断变化，以防你无法分辨）。但是，如果需要，该类也应该能够处理多头。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T09:02:52.280

您会发现，即使在 64 位框架上，数组中的最大元素数也是`int.MaxValue`.

接受或返回的现有方法`Int64`只是将`long`值转换为`Int32`内部，并且在参数的情况下，`ArgumentOutOfRangeException`如果`long`参数不在 and 之间`int.MinValue`，将抛出一个`int.MaxValue`。

例如`LongLength`，返回 an 的属性`Int64`只是强制转换并返回`Length`属性的值：

```
public long LongLength
{
    get { return (long)this.Length; }    // Length is an Int32
} 
```

因此，我的建议是将您的`Int64`指示转换为`Int32`，然后调用现有的`Sort`重载之一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T23:42:35.240

由于 Array.Copy 采用 Int64 参数，因此您可以拉出需要排序的部分，对其进行排序，然后将其放回原处。当然，假设您对少于 2^32 个元素进行排序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T23:23:53.880

似乎如果您要对超过 2^32 个元素进行排序，那么最好还是编写自己的、更高效的排序算法。

# javascript - 如何通过 JavaScript 检测 iPhone 何时进入横向模式？有这方面的活动吗？

> ID：850472
> 
> 赞同：15
> 
> 时间：2009-05-11T23:04:36.737
> 
> 标签：javascript, iphone, safari, mobile-safari, ios

我正在编写一个针对 iPhone 的网站。`<body>`当 iPhone 的方向改变时（即当用户将手机变成横向和/或纵向模式时），我想在元素上设置一个类。

我可以通过 JavaScript 检测到这种变化吗？有这方面的活动吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-11T23:06:46.780

是的，通过`onorientationchange`事件和`window.orientation`属性。

*   [由 Apple 记录](https://developer.apple.com/library/archive/documentation/AppleApplications/Reference/SafariWebContent/HandlingEvents/HandlingEvents.html#//apple_ref/doc/uid/TP40006511-SW16)

（在 iOS 以外[的平台上，改为使用`ScreenOrientation`API](https://caniuse.com/screen-orientation)。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T23:25:35.203

您可以检查文档正文宽度。如果它突然变小或变大，你就知道发生了什么。你可以用一个间隔来测量它。

```
window.setInterval(function() {
    // check body with here and compare with global variable that holds the last measurement
    // you may set a boolean isLandscape = true if the body with became bigger.
}, 50); 
```

# git - Git：我没有在 origin/master 之前提交的分支如何

> ID：850473
> 
> 赞同：20
> 
> 时间：2009-05-11T23:05:42.117
> 
> 标签：git, version-control

我 100% 使用从 master 分支创建的分支。现在一位同事已经推回了 origin/master，我试图将这些更改推送到我的个人分支中。当我执行“git checkout master”后跟“git status”时，我得到以下信息：

```
# Your branch is ahead of 'origin/master' by 2 commits. 
```

我从未提交过 2 次提交的分支如何？找出它们是什么提交并从本质上撤消它们的最佳方法是什么？我不希望将任何东西推回原点/主控，因为这可能会导致未知的冲突。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-05-11T23:23:21.247

要查看 HEAD 中不在 origin/master 中的提交：

```
git log origin/master.. 
```

将它们吹走并使您的 HEAD 与 origin/master 相同：

```
git reset --hard origin/master 
```

您是如何将更改推送到您自己的存储库的？我注意到您提到了“推送”... origin 是中央回购吗？你同事的repo？我怀疑您实际上想要做的是直接或从中央集结点拉动您同事的更改，而不是推动。可能只是您在 origin/master 之前所做的 2 个更改实际上是您同事的更改，但 origin/master 跟踪分支已过时。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-11T23:29:03.560

你正在处理 master 的一个分支，并且你做了两个不在`origin/master`.

消息`# Your branch is ahead of 'origin/master' by 2 commits.`说：

```
# Your branch 'mybranch' has two commits not in 'origin/master' 
```

想象一下 git 用户类似于 SVN 的修订号，您的分支有提交 1、2、3、4、5 - 但`origin/master`只有 1、2、3。所以修订历史看起来像下面的蹩脚的 ASCII 图。

```
your branch                                   -- [commit 4]--[commit 5]
                                             /                    /\ HEAD
master --[commit 1]--[commit 2]--[commit 3]-/
                                       /\ origin/master 
```

要在日志中显示最后两次提交，您可以执行以下操作。

```
git log HEAD..HEAD~2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T23:23:35.143

你有没有在你*正在*`git rebase`工作的分支上做过任何事情？

 *如果没有，您可以尝试复制您的分支 ( `git checkout -b testrebase`) 并发出 a`git rebase master`以查看是否有效。这将解开您相对于 master 所做的所有提交，然后尝试将它们应用回来（基本上使历史有意义）。如果它不起作用，只需删除 testrebase。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-20T19:43:05.677

您可能需要确保您的 origin/master 与您的 master 的 repo 版本是最新的。尝试运行：

```
git fetch origin master 
```

所以你的本地来源/主人与回购的主人相同。然后当你跑

```
git pull origin master 
```

您应该准确显示本地 master 之前有多少次提交。之后，您可以运行[araqnid 的命令](https://stackoverflow.com/a/850509/863846)来查看哪些提交实际上是不同的。

# windows - Visual Studio 或 Eclipse - 哪个更适合 Windows 上的 Qt？

> ID：850477
> 
> 赞同：1
> 
> 时间：2009-05-11T23:07:33.907
> 
> 标签：windows, visual-studio, eclipse, qt, ide

Visual Studio 或 Eclipse - 哪个 IDE 更适合 Windows 上的 Qt？
考虑到 Eclipse 是免费的，我对 VS 的 Express 版本特别感兴趣，但如果这样可以更好地与 Qt 集成，我对非免费版本持开放态度。

在发布之前，您可能会查看关于 SO 的类似问题，以**避免**写出我已经阅读过的内容 :) 寻找深入的答案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T17:00:35.963

我将扩展我的评论，询问为什么 Qt Creator 不在您的列表中。

我在 MSVC 方面经验丰富，并且在 Linux 上使用 Eclipse 进行了一些 C++ 开发，并且对它印象深刻。尽管我对这些工具很熟悉，但我还是决定将 Qt Creator 用于基于 Qt 的工作。

Qt 的信号和槽范例实际上是一种语言扩展，并且 Qt Creator 使其非常易于使用：在编写 connect() 语句时具有出色的代码完成功能，可以智能地显示您正在连接的类上的可用信号和槽。

帮助系统集成得很好，与资源编辑器和表单设计器的集成使其感觉也有点像 Visual Studio。

调试器足以满足大多数目的，但缺乏使用 MSVC 进行调试的技巧——对于一些错误，我不得不退回到手动使用 gdb。

我缺少的另一件事是能够对我的代码文件进行一些虚拟组织。我无法在项目视图中将相关类组合在一起。

但尽管有这些缺陷，我很喜欢它。一探究竟！

**编辑**：对 Eclipse 和 MSVC 支持的改进都在[Qt Roadmap](http://www.qtsoftware.com/developer/qt-roadmap#continue-and-enhance-eclipse)上。如果 Qt Creator 真的不适合您，我认为 MSVC 会胜出，尤其是在您已经熟悉它的情况下。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-11T23:17:12.660

改用 Qt-Creator。它仍处于测试阶段，但每个版本都在变得更好。它可能不具备 VS 和 eclipse 所具有的所有功能，但它可能具有*您*需要的功能。此外，它与 Qt 紧密集成。

# .net - VB.NET 服务关闭

> ID：850481
> 
> 赞同：1
> 
> 时间：2009-05-11T23:11:33.573
> 
> 标签：.net, vb.net, windows-services

我有一个我编写的 VB.NET Windows 服务，它运行良好。在 VB.NET 中有一个称为 OnStop() 的可覆盖方法，该方法在服务停止时被调用。但是，它似乎只有在有人从服务 MMC 控制台窗口实际停止服务时才会停止。

我的问题是，是否有事件或可覆盖的方法在服务停止时被调用，无论它是如何停止的（例如计算机重新启动、发生异常和关闭服务等）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-11T23:21:45.100

没有一个事件可以处理所有这些事件。您列出的大多数事件都可以单独处理。

*   OnShutdown 可以覆盖以处理非突然电源事件（用户关机、重启等...）
*   [Application.UnhandledException](http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception.aspx)可用于未处理的异常

请注意，您不能依赖这些事件 100% 的时间触发。在某些情况下，每个事件都将无法运行。例如，如果我走过去拔掉电源线，电源相关事件不会触发。您的代码必须在没有任何事先通知的情况下关闭服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T23:18:02.673

您可以覆盖[OnShutdown](http://msdn.microsoft.com/en-us/library/system.serviceprocess.servicebase.onshutdown.aspx)以捕获断电事件（重新启动），并覆盖 OnStop 以处理 MMC 关闭事件。

但是，没有调用方法来处理异常。如果您的服务崩溃，您将需要有异常处理来处理这种情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T23:29:28.067

根据 Inbar Gazit[在 System.ServiceProcess 中的更改，在 .NET 3.5 之前的 3.5 RTM](http://blogs.msdn.com/bclteam/archive/2007/11/01/change-in-system-serviceprocess-shutdown-is-coming-in-3-5-rtm-inbar-gazit.aspx)帖子中，OnStop 事件在计算机关闭期间没有被调用，因此要处理此事件，您的服务需要覆盖[**OnShutdown**](http://msdn.microsoft.com/en-us/library/system.serviceprocess.servicebase.onshutdown.aspx)方法（您还需要实现 OnStop 事件），但它应该在 .NET 3.5 中进行更改。根据 Inbar 的说法，ServiceBase 的 .NET 3.5 版本会在关闭期间调用 Stop 方法，但仅实现这两种方法可能更安全（请记住框架之间的差异）。

关于异常，这将取决于您的服务（或服务组件）如何处理它们。如果发生未处理的异常，服务不会停止，它会崩溃。所以处理这种情况完全取决于你：也许你确保所有方法都有异常处理，也许你在代码中添加一个未处理的异常处理程序等等，但你必须在这里决定适当的策略。

# attributes - 你经常使用链接关系（“rel”属性）吗？

> ID：850482
> 
> 赞同：7
> 
> 时间：2009-05-11T23:12:20.687
> 
> 标签：attributes, standards-compliance, semantic-markup

我渴望转向一种更加基于标准、可访问且语义正确的 Web 开发方法。在办公室，我预计不会立即发生巨大的变化，但我正试图开始为进一步发展奠定一些基本基础。

`rel`此过程的一部分是在链接和其他此类内容中引入属性。这比熟悉的旧

```
<link href="mystyles.css" type="text/css" rel="stylesheet" /> 
```

许多开发人员可能会不假思索地投入其中。我很想知道是否有人`rel`经常以其他方式使用。例如，使用 . 将主导航的链接设置回主页`rel="start"`。

如果您在自己的项目中实现了链接关系，是什么促使您采用它们以及您试图实现的好处是什么？

如果您查看了链接关系但决定不使用它们，您做出决定的依据是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-11T21:53:23.300

我经常在and元素上使用具有广泛值的`rel`(and ) 属性。`rev``<link/>``<a/>`

我在下面概述了一些更常见（和更有用）的关系类型。更完整的`rel`值列表保存在[microformats wiki](http://microformats.org/wiki/existing-rel-values)上。

## HTML 4

HTML 4 规范定义了几种标准链接类型。

*   **`alternate`**- 在提供指向 HTML 文档的替代版本的链接时使用，例如以不同的语言或其他格式。这在链接到网站的联合（RSS 或 Atom）版本时最常用。
*   **`next`**和**`previous`**- 用于表示一系列文档中的下一个和上一个文档。如果`rel="next"`在`<link/>`元素上使用，则某些浏览器将预取链接文档的内容（请参阅[MDC 链接预取常见问题解答](https://developer.mozilla.org/en/Link_prefetching_FAQ)）。

## XFN

XFN（XHTML Friends Network）是一种[微格式](http://microformats.org)，用于描述由网页表示的人与人之间的关系。它还允许一个页面指示代表同一个人的其他页面（例如，我的博客、我的 Twitter 个人资料和我的 Stack Overflow 个人资料都代表我）。它通过定义一组`rel`值来完成所有这些工作：

*   **`me`**- 用于表示链接页面和链接页面代表同一个用户。当从用户个人资料链接到用户自己的网站时，许多社交网站（包括 Stack Overflow）广泛采用这种方式。
*   **`contact`**,**`aquantance`**和**`friend`**- 表示您认识要链接的人以及您对他们的了解程度。
*   **`met`**- 表示您遇到了您要链接的人。
*   **`co-worker`**和**`colleague`**- 表明您与您链接的人一起工作或在同一领域工作。
*   **`co-resident`**和**`neighbor`**- 表明您与所链接的人住在一起或住在附近。
*   **`child`**, **`parent`**, **`sibling`**,**`spouse`**和**`kin`**- 表示您正在链接到您的家庭成员。
*   **`muse`**, **`crush`**,**`date`**和**`sweetheart`**- 表示与您链接的人的浪漫关系。

这些关系可以被解析并用于确定有关用户的信息，例如他们的朋友是谁或他们拥有哪些其他在线个人资料。有关当前和潜在未来的更多信息，可能会对以下页面的应用感兴趣：

*   Ben Ward 关于[便携式社交网络](http://www.digital-web.com/articles/portable_social_networks_building_blocks_of_a_social_web/)的文章。
*   微格式 wiki 上的[XFN 实现](http://microformats.org/wiki/xfn-implementations)列表。

## 其他

各种规范定义了各种其他链接类型：

*   **`nofollow`**- 用于表示搜索引擎在抓取网页时不应跟随链接。请参阅[rel-nofollow 规范](http://microformats.org/wiki/rel-nofollow)。
*   **`canonical`**- 用于表示另一个 URL 是当前页面的规范版本，因此应该受到搜索引擎的青睐。这也与`rev`属性一起使用以指示当前页面的替代 URL，通常更短（即`rev="canonical"`指示当前 URL 是链接 URL 的规范版本）。更多信息和工具可以在[Simon Willison 关于 rev=canonical 的博客文章](http://simonwillison.net/2009/Apr/11/revcanonical/)中找到。
*   **`tag`**- 用于表示链接页面是描述链接页面的标签（即关键字）。请参阅[rel-tag 规范](http://microformats.org/wiki/rel-tag)。
*   **`license`**- 用于表示发布链接页面内容的许可证。请参阅[rel-license 规范](http://microformats.org/wiki/rel-license)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-11T23:20:30.970

我将 rel="nofollow" 用于博客评论中用户贡献的链接。谷歌不会跟随链接，也不会因为链接而获得更高的页面排名。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-11T23:15:43.800

我使用它们的一件事是作为一种指定应在新窗口中打开的外部链接的方式。此功能在严格的 XHTML 中是不可能的，因为标签`target`上不再允许该属性。`<a>`但是使用一些 javascript 和`rel`属性，您可以完成相当不错的工作，如本文所述：[符合标准的世界中的新窗口链接](http://www.sitepoint.com/article/standards-compliant-world/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T23:35:38.837

正如[乍得所说](https://stackoverflow.com/questions/850482/do-you-commonly-use-link-relations-rel-attributes/850491#850491)，我`rel="external"`用来指定我想在新窗口中打开的链接（利用一些 jQuery 使其成为可能）。

`rel="nofollow"`当我想让遵循规则的机器人（如谷歌机器人）不索引我的链接时，我也会使用。

例如，在公共网站上自动添加 nofollow 很有用，否则可能会诱使垃圾邮件发送者从您的博客评论中创建链接农场。

# iframe - 覆盖时绘制错误的解决方法 超过一个 in Safari? 问问题 问问题 2009-05-11T23:13:44.007 2027 次 This question shows research effort; it is useful and clear 1 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. I'm getting a very weird drawing bug in Safari, and i would like to see if there's any workaround I could take... I'm currently displaying a <div> (absolutely positioned, high z-index) on top of an IFrame that displays contents from other sites. Just for context, the <div> is a toolbar we show over other sites. This works well in all browsers, but in Safari, when the IFrame is showing some sites, and the user scrolls the page in the IFrame, the drawing of the toolbar gets all screwed up. Here is a very minimalistic POC that reproduces the problem: <html> <head> </head> <body> <div id="mainContainer" style="position: absolute; top: 0; left:0; height: 500px; width: 500px; border: 2px solid red;"> <div id="floatingToolbar" style="position: absolute; top: 20px; right: 20px; height: 40px; width: 300px; background-color: blue; color: red; z-index:200;"> Toolbar! </div> <iframe id="theIFrame" src="http://www.overstock.com/Clothing-Shoes/Skynyrd-Mens-Rock-Roll-Freebird-Lyric-T-shirt/3023049/product.html?sec_iid=33972" style="position: absolute; top: 0; left:0; height: 500px; width: 500px; border: 2px solid red;"> </iframe> </div> </body> </html> If you save that to your hard drive, and open it with Firefox, you'll get this: (source: crystalgears.com) And if you open it in Safari, and wildly scroll up and down inside the IFrame, it'll look like this: (source: crystalgears.com) Now, this only happens in Safari. Chrome works correctly. It happens in Safari Windows and Mac. I'm testing with Safari Windows 3.2.1 (525.27.1), but i've seen it happen in other versions. To make this more mysterious, it only happens when I show some sites inside the IFrame. For example, if you show www.google.com or www.stackoverflow.com, the toolbar works perfectly. However, items inside www.overstock.com or www.amazon.com work well. Also, it's not only a few sites that give me this problem. It's a lot. I haven't been able to find some special thing that differentiates consistently the "bad" sites from the "good" ones, but I haven't looked deep enough. Maybe it's the DOCTYPE, or something else. What seems to be a rule (although it's admittedly very soft) is that "complex" or "heavy" sites tend to trigger it, while "light" sites don't. Any ideas of what I could do to work around this issue? Thanks! iframesafarirendering 4 1 回答 1 This answer is useful 1 I would expect the unexpected when rendering on top of an iframe, similar to when a div is positioned over a flash video. It can work, and sometimes does. But scrolling or movement in the flash or iframe can trigger some rendering issues. Is there any chance you could use a different solution then the iframe? Would using a library like cURL to get the data off a different page suffice? 于 2009-05-11T23:32:52.570 回答 Related 3 html - 如何制作全局标题而不是将其粘贴到每个页面中？ 2 ruby-on-rails - 在 do 块内运行代码？（活动管理员仪表板） 1 php - 强制浏览器缓存用 Apache 和 PHP 压缩的 css 和 js 文件 1 css - 100% 固定 div，在子 div 和固定高度标题中溢出 2 php - PHP变量作为SQL查询中的表名 2 sql - 为 array_agg() 设置限制 2 vhdl - 在 vhdl 中计算（并验证）以太网 FCS (crc32) 2 javascript - 如何获取 Google Maps 3 Directions Service API 来区分多条路线？ 1 hibernate - Hibernate 通过 Annotation 映射 OneToMany 1 xml - 使用 XPath 返回初始值或最近出现的值，然后运行运算符 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：850484
> 
> 赞同：1
> 
> 时间：
> 
> 标签：iframe, safari, rendering

I'm getting a very weird drawing bug in Safari, and i would like to see if there's any workaround I could take...

I'm currently displaying a <div> (absolutely positioned, high z-index) on top of an IFrame that displays contents from other sites. Just for context, the <div> is a toolbar we show over other sites.

This works well in all browsers, but in Safari, when the IFrame is showing **some** sites, and the user scrolls the page in the IFrame, the drawing of the toolbar gets all screwed up.

Here is a very minimalistic POC that reproduces the problem:

```
<html>
<head>
</head>
<body>

<div id="mainContainer" style="position: absolute; top: 0; left:0; height: 500px; width: 500px; border: 2px solid red;">
    <div id="floatingToolbar" style="position: absolute; top: 20px; right: 20px; height: 40px; width: 300px; background-color: blue; color: red; z-index:200;">
        Toolbar!
    </div>
    <iframe id="theIFrame" src="http://www.overstock.com/Clothing-Shoes/Skynyrd-Mens-Rock-Roll-Freebird-Lyric-T-shirt/3023049/product.html?sec_iid=33972" style="position: absolute; top: 0; left:0; height: 500px; width: 500px; border: 2px solid red;">
    </iframe>
</div>

</body>
</html> 
```

* * *

If you save that to your hard drive, and open it with Firefox, you'll get this:

[![alt text](https://i.stack.imgur.com/EX2t7.jpg)](https://i.stack.imgur.com/EX2t7.jpg)
[(source: [crystalgears.com](http://www.crystalgears.com/temp/safariproblem_firefox.jpg))]

* * *

And if you open it in Safari, and wildly scroll up and down inside the IFrame, it'll look like this:

[![alt text](https://i.stack.imgur.com/VKp3A.jpg)](https://i.stack.imgur.com/VKp3A.jpg)
[(source: [crystalgears.com](http://www.crystalgears.com/temp/safariproblem_safari.jpg))]

* * *

Now, this **only** happens in Safari. Chrome works correctly. It happens in Safari Windows and Mac. I'm testing with Safari Windows 3.2.1 (525.27.1), but i've seen it happen in other versions.

To make this more mysterious, it only happens when I show **some** sites inside the IFrame. For example, if you show www.google.com or www.stackoverflow.com, the toolbar works perfectly. However, items inside www.overstock.com or www.amazon.com work well. Also, it's not only *a few* sites that give me this problem. It's **a lot**. I haven't been able to find some special thing that differentiates consistently the "bad" sites from the "good" ones, but I haven't looked deep enough. Maybe it's the DOCTYPE, or something else. What seems to be a rule (although it's admittedly very soft) is that "complex" or "heavy" sites tend to trigger it, while "light" sites don't.

Any ideas of what I could do to work around this issue?

Thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T23:32:52.570

I would expect the unexpected when rendering on top of an iframe, similar to when a div is positioned over a flash video. It can work, and sometimes does. But scrolling or movement in the flash or iframe can trigger some rendering issues.

Is there any chance you could use a different solution then the iframe? Would using a library like cURL to get the data off a different page suffice?

# pocketpc - 以编程方式在一列上添加多个过滤器。卫星表格

> ID：850486
> 
> 赞同：0
> 
> 时间：2009-05-11T23:15:05.987
> 
> 标签：pocketpc, palm-os, satelliteforms

有没有办法以编程方式在列上添加多个过滤器？

```
Tables("TYPE").AddFilter("Code", "<>", "OP") --  Works until then next line.
Tables("TYPE").AddFilter("Code", "<>", "MP") --  The first filter is removed. 
```

.... 我还不够酷，无法添加 SatelliteForms 标签。

这是[SatelliteForms](http://www.satelliteforms.net/)的链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T16:49:58.947

让我提出我对 SatelliteForms 没有经验的免责声明。但是，我确实梳理了**[SF_MobileAppGuide](http://www.satelliteforms.net/support/SF_MobileApp_Guide.pdf)**并根据**AddFilter**、**RemoveFilter**和**RemoveAllFilters**方法的调用方式，似乎每列只能有**一个过滤器**。

这解释了为什么当您添加第二行时，它只是替换您的过滤器而不是添加它。

# java - 与未签名 Java 小程序的原始服务器的套接字连接

> ID：850497
> 
> 赞同：2
> 
> 时间：2009-05-11T23:19:30.393
> 
> 标签：java, security, applet

我到处读到，未经签名的 Java 小程序不允许与任何服务器建立网络连接，但起源于小程序的服务器除外。这对我的应用程序来说没问题，因为我的小程序只需要与服务器通信。但是，当我编写一个测试小程序以尝试打开套接字以与我的开发机器上的进程通信时，它会引发以下异常：

```
建立套接字连接时出错：
java.security.AccessControlException：
  访问被拒绝（java.net.SocketPermission 127.0.0.1:11000 连接，解决）

```

导致异常的代码：

```
private void sendMsg(String msg) {
   Socket s = null;
   try {
      s = new Socket("localhost", 11000);
   }
   catch (Exception e) {
      System.err.println("Error establishing socket connection:");
      e.printStackTrace();
      return;
   }

   try {
      OutputStream out = s.getOutputStream();
      out.write(msg.getBytes());
      out.flush();
      s.shutdownOutput();
      s.close();
   }
   catch (Exception e) {
      System.err.println("Error in writing to the socket:");
      e.printStackTrace();
   } 
```

起初我认为这是我的代码中的一个问题，我的经验不足导致我错过了。但是，在尝试运行官方 Java 教程中的[Talk Server示例时，我遇到了同样的异常。](http://java.sun.com/docs/books/tutorial/deployment/applet/workaround.html "使用服务器绕过安全限制")这让我相信我实际上遇到了设置问题，或者对默认安全限制有误解。默认安全管理器是否会阻止您打开连接到运行 applet 的机器的套接字，即使它也是为 applet 提供服务的机器？如果是这样，这对我来说是个问题，因为部署的系统需要允许登录到实际服务器的用户使用远程用户将使用的同一个小程序。有没有办法解决我得到的不涉及签署小程序的异常？如果没有必要，我不想去麻烦。

**注意：**我知道最好不要让用户从服务器访问小程序。那不是最初的设计，但不幸的是，实际考虑迫使我在实现上妥协。

*更新：*从网络服务器查看小程序的页面可以解决问题。即使服务器是本地主机。Java 1.6.0_11 中的安全更新仅适用于直接从本地文件系统加载的小程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T00:27:53.090

这是由于最近的安全更新中引入的插件发生了变化。对不起！从本地文件系统加载的小程序不再被授予对 localhost 的套接字权限。

[解决方案 246387：Java 运行时环境中的安全漏洞可能允许从本地文件系统加载的代码访问 LocalHost](http://sunsolve.sun.com/search/document.do?assetkey=1-66-246387-1)

> Java 运行时环境 (JRE) 允许从本地文件系统加载的代码访问 localhost。这可能允许恶意放置在本地文件系统上并随后运行的代码对本地主机进行网络访问，如果代码是从远程主机加载的，否则将不允许这样做。这可能被用来窃取 cookie 和劫持会话（对于将名称映射到 localhost 的域）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T16:02:54.857

我怀疑您正在从本地 HTML 文件（例如 applet.html）运行小程序，这会引发 Tom Hawtin 提到的错误。

而是在您的机器上运行一个网络服务器（例如[Tomcat](http://tomcat.apache.org/)）并通过`[http://localhost/applet.html](http://localhost/applet.html)`

从您的网络服务器中的 servlet 打开套接字端口可能会更好。通过这种方式，您的网络服务器可以管理您的整个系统，并且可以更简单地在机器之间传输。

我经常使用相同的设置与 localhost 和 live 上的 applet 和 servlet 之间的套接字连接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-22T03:13:00.037

Oracle 知道这个严重限制 Applet 使用的 Java 问题：Java 运行时环境中的安全漏洞可能允许从本地文件系统加载的代码访问 LocalHost 就是他们所说的。这是错误 ID 6704154

他们的解决方案是：这个问题没有解决方法；此“解决方法”于 2008 年 12 月 3 日发布。因此，如果您希望将 Applets 与 Tomcat 或任何类似服务器一起使用，您将不得不回到 Java 1.4.2

我花了一个多星期的时间来完整记录这些事实，因为我在同一条船上。

# c# - 错误：如何在 Castle Active Record 中保存多对多关系？

> ID：850502
> 
> 赞同：2
> 
> 时间：2009-05-11T23:21:07.427
> 
> 标签：c#, castle-activerecord

我一直在尝试使用 Castle ActiveRecord 保存多对多关系。我究竟做错了什么？我在文档或谷歌上找不到任何东西。数据库中有数据。

课程与书籍有多对多的关系。

测试代码。

```
Database.Course c = new Database.Course();
c.Number = "CS 433";
c.Name = "Databases";
c.Size = 34;
c.Books = Database.Book.FindAll();
c.Save(); 
```

也不起作用

```
foreach(Database.Book b in Database.Book.FindAll()){
    c.Books.Add(b);
} 
```

数据库类

```
[ActiveRecord]
public class Course : ActiveRecordValidationBase<Course>
{
    private int? id;
    private string number;
    private string name;
    private string description;
    private int size; //number of students in class

    //references
    private IList books = new ArrayList();

    public override string ToString()
    {
        return FormattedName;
    }

    public string FormattedName
    {
        get
        {
            return string.Format("{0} - {1}", Number, Name);
        }
    }

    [PrimaryKey]
    public int? Id
    {
        get { return id; }
        set { id = value; }
    }

    [Property, ValidateNonEmpty]
    public string Number
    {
        get { return number; }
        set { number = value; }
    }

    [Property, ValidateNonEmpty]
    public string Name
    {
        get { return name; }
        set { name = value; }
    }

    [Property(ColumnType="StringClob")]
    public string Description
    {
        get { return description; }
        set { description = value; }
    }

    [Property]
    public int Size
    {
        get { return size; }
        set { size = value; }
    }

    [HasAndBelongsToMany(typeof(Book),
    Table = "BookCourse", ColumnKey = "course_id", ColumnRef = "book_id", Inverse = true)]
    public IList Books
    {
        get { return books; }
        set { books = value; }
    }
}

[ActiveRecord]
public class Book : ActiveRecordValidationBase<Book>
{
    private int? id;
    private string title;
    private string edition;
    private string isbn;
    private bool is_available_for_order;
    //relations
    private IList authors = new ArrayList();
    private IList bookordercount = new ArrayList();
    private IList courses = new ArrayList();
    private Inventory inventory;

    public override string ToString()
    {
        return FormattedName;
    }

    public string FormattedName
    {
        //*
        get {
            string str;
            if (Edition == null || Edition == "")
                str = Title;
            else
                str = string.Format("{0} ({1})", Title, Edition);

            if (Authors.Count != 0)
            {
                return string.Format("{0} by {1}", str, FormattedAuthors);
            }
            else
            {
                return str;
            }
        }
        /*/
        get
        {
            return Title;
        }
        //*/
    }

    public string FormattedAuthors
    {
        get
        {
            if (Authors.Count == 0) return "";

            StringBuilder sb = new StringBuilder();
            int i = 0, end = Authors.Count;
            foreach (Author a in Authors)
            {
                i++;
                sb.Append(a.FormattedName);
                if (i != end) sb.Append("; ");
            }
            return sb.ToString();
        }
    }

    [PrimaryKey]
    public int? Id
    {
        get { return id; }
        set { id = value; }
    }

    [Property, ValidateNonEmpty]
    public string Title
    {
        get { return title; }
        set { title = value; }
    }

    [Property]
    public string Edition
    {
        get { return edition; }
        set { edition = value; }
    }

    [Property, ValidateNonEmpty]
    public string Isbn
    {
        get { return isbn; }
        set { isbn = value; }
    }

    [Property]
    public bool IsAvailableForOrder
    {
        get { return is_available_for_order; }
        set { is_available_for_order = value; }
    }

    //relations

    [HasAndBelongsToMany(typeof(Author),
    Table = "BookAuthor", ColumnKey = "book_id", ColumnRef = "author_id")]
    public IList Authors
    {
        get { return authors; }
        set { authors = value; }
    }

    [HasMany(typeof(BookOrderCount), Table = "BookOrderCounts", ColumnKey = "BookId")]
    public IList BookOrderCount
    {
        get { return bookordercount; }
        set { bookordercount = value; }
    }

    [HasAndBelongsToMany(typeof(Course),
   Table = "BookCourse", ColumnKey = "book_id", ColumnRef = "course_id")]
    public IList Courses
    {
        get { return courses; }
        set { courses = value; }
    }

    [OneToOne]
    public Inventory Inventory
    {
        get { return inventory; }
        set { inventory = value; }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-11T23:25:38.167

确保将 Inverse = true 放在您想要的位置。来自[Castle AR 文档](http://www.castleproject.org/activerecord/documentation/v1rc1/usersguide/relations/hasandbelongs.html)，

> 选择关系的一方作为所有者是明智的。另一面，不可写，需要使用Inverse=true。

将 Inverse = true 放在关系的另一边，如下所示：

```
[HasAndBelongsToMany(typeof(Book),
    Table = "BookCourse", ColumnKey = "course_id", ColumnRef = "book_id")]
    public IList<Book> Books

[HasAndBelongsToMany(typeof(Course),
   Table = "BookCourse", ColumnKey = "book_id", ColumnRef = "course_id", Inverse = true)]
    public IList<Course> Courses 
```

您还必须在两个类的顶部添加属性 - 目前他们不知道它们映射到哪些表。目前你有这个：

```
public class Course : ActiveRecordBase<Course> 
```

添加这个（其中“课程”是您的课程表的名称）：

```
[ActiveRecord("course")]
public class Course : ActiveRecordBase<Course> 
```

# linq - 将 SQL 转换为 LINQ

> ID：850521
> 
> 赞同：0
> 
> 时间：2009-05-11T23:30:04.183
> 
> 标签：linq, linq-to-sql

如何将以下内容转换为 LINQ

```
SELECT Q.MaterialID AS MaterialID, Q.ProductID AS ProductID, QB.Quantity AS Quantity, 
        Q.ParameterID AS ParameterID, SUM((Q.ParameterValue * Q.Quantity)/Q.TotalTonnes) AS ParameterValue
    FROM @Quality Q
    INNER JOIN @QuantityBreakdown QB 
    ON ((Q.MaterialID = QB.MaterialID) OR (Q.MaterialID IS NULL AND QB.MaterialID IS NULL))
    AND ((Q.ProductID = QB.ProductID) OR (Q.ProductID IS NULL AND QB.ProductID IS NULL))
    GROUP BY Q.MaterialID, Q.ProductID, ParameterID, QB.Quantity 
```

我达到：

```
 (from final in (from q in qualities
                            from qb in quantityBreakDowns
                            where q.MaterialID == qb.MaterialID && q.ProductID == qb.ProductID
                            select q)
             group final by new {final.MaterialID, final.ProductID, final.ParameterID, final.Quantity}
             into FinalResult
                 select new
                            {
                                FinalResult.Key.MaterialID,
                                FinalResult.Key.ProductID,
                                FinalResult.Key.ParameterID
                                //QB.Quantity AS Quantity ??
                                //SUM((Q.ParameterValue * Q.Quantity)/Q.TotalTonnes) AS ParameterValue ??

                            } 
```

“？？？” => 如何获得这些。

这是正确的做法吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-11T23:38:27.103

我认为我们不应该为您执行 LINQ 查询，而是为您指明学习 LINQ to SQL 的正确方向。

否则，您的下一个查询将处于相同位置。

*   [C# 101 Linq to SQL 示例](http://msdn.microsoft.com/en-us/vcsharp/aa336746.aspx)
*   [VB.NET Linq to SQL 101 示例](http://msdn.microsoft.com/en-us/vbasic/bb688085.aspx)
*   [http://www.linqpad.com](http://www.linqpad.com)
*   [http://www.hookdonlinq.com](http://www.hookedonlinq.com)
*   [http://dimecasts.net/Casts/ByTag/Linq2Sql](http://dimecasts.net/Casts/ByTag/Linq2Sql)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T23:38:04.683

像这样的东西应该可以解决问题。我不使用 LinqToSql，所以你需要检查如何获取 IQuerable 对象。否则，这应该为您指明正确的方向。

```
var results = from q in myIQuerableObject<Quality>
from qb on qb.MaterialId == q.MaterialId or (qb.MaterialId == null && q.MaterialId == null)
select new {Quality = q, Breakdown = qb} 
```

# apache2 - 日志中出现“内部虚拟连接”，达到 MaxClient，服务器崩溃。意见？

> ID：850524
> 
> 赞同：1
> 
> 时间：2009-05-11T23:33:39.963
> 
> 标签：apache2, redhat

我正在尝试简化客户端的服务器。下载 access_log 文件后，我注意到有很多条目看起来像：

```
::1 - - [11/May/2009:23:21:16 +0100] "GET / HTTP/1.0" 403 5043 "-" "Apache/2.2.3 (CentOS) (internal dummy connection)" 
```

我还检查了 httpd.conf 文件，并且看到了以下设置：

```
# ServerLimit: maximum value for MaxClients for the lifetime of the server
# MaxClients: maximum number of server processes allowed to start   
# MaxRequestsPerChild: maximum number of requests a server process serves
<IfModule prefork.c>
StartServers       8
MinSpareServers    8
MaxSpareServers   13
ServerLimit      256
MaxClients   256
MaxRequestsPerChild  50
</IfModule>

# worker MPM
# StartServers: initial number of server processes to start
# MaxClients: maximum number of simultaneous client connections
# MinSpareThreads: minimum number of worker threads which are kept spare
# MaxSpareThreads: maximum number of worker threads which are kept spare
# ThreadsPerChild: constant number of worker threads in each server process
# MaxRequestsPerChild: maximum number of requests a server process serves
<IfModule worker.c>
StartServers         2
MaxClients         150
MinSpareThreads     25
MaxSpareThreads     75
ThreadsPerChild     25
MaxRequestsPerChild  0
</IfModule> 
```

我一直在阅读我需要将 MaxSpareServes 设置为大于 MinSpareServers 的值。非常感谢您的意见。

最亲切的问候。汤姆

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-25T16:32:38.040

据我所知，没什么好担心的，如果您愿意，可以使用 Andri 已经提供的链接中的信息阻止他们进入日志...

> 如果您希望将它们从您的日志中排除，您可以使用普通的条件日志技术。例如，要从日志中忽略来自环回接口的所有请求，您可以使用
> 
> `SetEnvIf Remote_Addr "127\.0\.0\.1" loopback` 然后将 env=!loopback 添加到 CustomLog 指令的末尾。

# windows - 内核模式驱动程序写入文件

> ID：850530
> 
> 赞同：3
> 
> 时间：2009-05-11T23:35:45.670
> 
> 标签：windows, kernel, driver

我正在开发 Windows 键盘过滤器驱动程序，我需要写入文件。我尝试使用 zwcreate、zwwrite 和 zwclose，但驱动程序没有在 PASSIVE_LEVEL 运行，我得到了 BSOD。我以前从未编写过 Windows 驱动程序。谢谢您的帮助！

编辑：谢谢 J. 通过！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T06:06:06.470

调度工作项 (IoAllocateWorkItem/IoQueueWorkItem) 并从工作项回调例程中处理所有文件 I/O。

> 我不确定让内核驱动程序首先写入文件是否是个好主意。恕我直言，最好的方法是提供一个与驱动程序通信、获取数据然后将其写入磁盘的用户空间程序。

这适用于 Unix，但不适用于 Windows。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-07-09T18:00:00.900

```
PCUCHAR buffer[] = {0x00, 0x01, 0x02, 0x03};    //  for example
ULONG bufferSize = sizeof(buffer);

UNICODE_STRING      filePath;   //  Must be with DOS prefix: \??\C:\MyFolder\logs.txt
HANDLE              hFile;
OBJECT_ATTRIBUTES   ObjectAttributes;
IO_STATUS_BLOCK     IoStatusBlock;

InitializeObjectAttributes(&ObjectAttributes, &filePath, OBJ_CASE_INSENSITIVE | OBJ_KERNEL_HANDLE, NULL, NULL);

NTSTATUS Status = ZwCreateFile(&hFile, FILE_GENERIC_READ | FILE_GENERIC_WRITE, &ObjectAttributes,
    &IoStatusBlock, NULL, FILE_ATTRIBUTE_NORMAL, 0, FILE_CREATE,
    FILE_SYNCHRONOUS_IO_NONALERT, NULL, 0);

if (!NT_SUCCESS(Status))
{
    DbgPrint("[DRV_NAME]: Creating file error");
    return Status;
}

Status = ZwWriteFile(hFile, NULL, NULL, NULL, &IoStatusBlock, (PVOID)buffer, bufferSize, NULL, NULL);

if (!NT_SUCCESS(Status))
{
    InjDbgPrint("[DRV_NAME]: Writing file error");
    return Status;
}

ZwClose(hFile); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-16T13:13:13.917

使用 Zw-Tools 从设备驱动程序写入文件的一个很好的例子是在 rootkit.com 上找到的 Clandestiny 的[Klog](http://www.rootkit.com/board_project_fused.php?did=proj21)。它目前对我帮助很大。

好吧，我有点同意 Johannes 的观点，即不建议直接从驱动程序执行经典的用户态工作（文件/网络/...-访问）。它不仅容易出错，而且将来可能会出现不可预见的中断。用户界面通常更加稳定和有弹性。

# svn - 使用 Subversion 的有用工具

> ID：850531
> 
> 赞同：42
> 
> 时间：2009-05-11T23:35:55.687
> 
> 标签：svn

有许多很棒的工具可以与 Subversion 集成并做一些非常简洁的事情。我已经尝试了其中的一些，但最终只倾向于定期使用以下内容：

1.  [Tortoise](http://tortoisesvn.tigris.org)（无处不在的 Explorer 插件）
2.  [Visual SVN](http://www.visualsvn.com/visualsvn)（用于 VS 的 IDE 集成）
3.  [Visual SVN Server](http://www.visualsvn.com/server)（轻量级SVN服务器）
4.  [SVN Monitor](http://www.svnmonitor.com)（存储库监控）

还有什么是您发现与 Subversion 交互真正创新或有用的？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-11T23:49:27.600

[StatSVN](http://www.statsvn.org/)是一个非常酷的工具，尽管它是一个书呆子，用于报告有关您的回购和提交统计信息的详细信息；这真的只是图色情:)

[以下](http://www.statsvn.org/statsvn/index.html)是图表的一些示例。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-11T23:43:52.490

除了之前的一些评论：

*   [TeamCity](http://www.jetbrains.com/teamcity/)在 CC.NEt 和 Hudson 以外的构建工具方面对 Subversion 提供了出色的支持。
*   [带有 Visual Studio 的AnkhSVN](http://ankhsvn.open.collab.net/)（它的最新版本看起来相当不错）
*   [Atlassian](http://www.atlassian.com/software/fisheye/)的 Fisheye 是监视和查看源代码/历史/修订的绝佳方式，具有一些简洁的统计数据和对代码审查等的支持。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-12T02:06:05.223

[Trac](http://trac.edgewall.org/)是一个带有 SVN 集成的问题跟踪器。我真的很喜欢*时间线视图*，可以快速查看所有*变更集*以进行快速代码审查。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2010-08-24T15:09:10.240

在 Microsoft Office 中编写或编辑文本时，我始终专注于我的任务。像大多数人一样，当我不得不中断工作进行维护时，我会感到不安。尽管如此，在 Subversion 下保留文档的更改历史记录被认为是一种很好的做法。

作为比较，为了*通过 TortoiseSVN***更新文档**，必须执行多达*5 个步骤*：

 ***1.  关闭文档；
2.  在 Windows 资源管理器中打开其文件夹；
3.  通过上下文菜单执行更新命令，
4.  等待它完成，关闭 TortoiseSVN 窗口，
5.  再次打开文档。

**[通过使用 Microsoft Office 的MagnetSVN](http://magnetsvn.com "将 Subversion 集成到 Microsoft Office")**插件，我可以将所有这些步骤减少到一键。
**这是一个真正的节省时间！** ![MagnetSVN 功能区选项卡](https://i.stack.imgur.com/bH56b.png)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-12T07:44:46.107

在 Mac 上，我喜欢[Versions](http://versionsapp.com/)。其他人更喜欢[基石](http://www.zennaware.com/cornerstone/)。两者都是具有出色 UI 的优秀 SVN 客户端。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-11T23:39:37.600

我最终只是为了留在我的 IDE 中而使用[Subclipse 。](http://subclipse.tigris.org/)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-12T06:56:21.740

[svn 协议处理程序](http://tortoisesvn.net/SVNProtocolHandler)也非常有用：它允许您在 Internet Explorer中浏览 svn:// 存储库。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-11T23:43:29.387

我使用[Commit Monitor](http://tools.tortoisesvn.net/CommitMonitor)来获取其他开发人员提交的通知。

我得看看 SVN Monitor，看起来它做同样的事情，但比 Commit Monitor 有更多的功能。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-12T00:40:44.363

我在 Windows 和 Mac 上使用过 Synchro。如果您在不同平台上有开发人员，它尤其适用。我认为该许可证允许您一个用户在多个平台上使用它（我在 Mac 上进行全职开发并在 Linux 和 Windows 上进行测试）。

Versions 是一个带有漂亮 UI 的 Mac 客户端。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-12T00:49:26.720

我使用[kdesvn](http://kdesvn.alwins-world.de/)作为 linux 客户端，完成这项工作。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-12T02:18:09.213

我认为一些可用的[钩子脚本](http://subversion.tigris.org/tools_contrib.html#hook_scripts)对于在您的存储库上设置非常有用。例如，我使用了一个 pre-commit 钩子来确保最小的日志消息长度（我们的一些开发人员倾向于使用空日志消息进行提交）和一个 post-commit 钩子来将电子邮件发送到邮件列表。

我也认为[RepoGuard](http://repoguard.tigris.org/)看起来很有趣，但还没有机会使用它。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-22T07:37:18.210

SVNplot 从您的 Subversion 存储库生成很酷的统计信息

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2010-08-24T15:40:34.873

[Winmerge](http://winmerge.org/)是一个相当不错的 Diff 工具，可以很好地与 tortoise svn 集成。我比乌龟自带的默认差异工具更喜欢它。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-12-09T19:21:12.937

[如果您需要搜索存储库的内容， SvnQuery](http://svnquery.tigris.org/)非常有用。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-11T23:39:57.863

将集成服务器与版本控制结合起来可以为您的构建过程带来奇迹。我最喜欢的两个是[CruiseControl.NET](http://confluence.public.thoughtworks.org/display/CCNET/Welcome+to+CruiseControl.NET)和[Hudson](http://hudson-ci.org/) - 但那里有很多。请注意，这两者都可以与 SVN 无缝协作。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-05-11T23:41:06.223

某种颠覆性的网络访问应用程序。你可以在这里找到一个比较：http: [//geekswithblogs.net/flanakin/articles/CompareSubversionWebTools.aspx](http://geekswithblogs.net/flanakin/articles/CompareSubversionWebTools.aspx)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-05-11T23:41:13.960

我真的很喜欢[SyncroSVN](http://www.syncrosvnclient.com/)（我在 Mac 上使用它） 易于使用，内置 diff 和 SSH 支持。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-05-11T23:43:48.700

我同意 Peter D 和 Gabriel Florit 的观点；在 Eclipse 中，你得到一个 gui，你可以轻松地在 svn 存储库中移动，删除或重命名或其他任何东西。使用 Hudson，我可以检查我的项目并构建它们并运行它们的单元测试。

我还没有真正探索过它，但是 Maven 有用于颠覆的插件。我使用 Maven 进行构建和部署，但没有将它与 subversion 插件一起使用。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-05-12T07:31:49.153

我会添加一个普通的 Subversion 命令行客户端（例如来自[SlikSvn](http://sliksvn.com/en/download)）。到目前为止，编写和/或自动化颠覆命令的最简单方法。

如果您需要更多的脚本功能或者想要在您自己的 .Net 应用程序中集成 Subversion 支持，也许可以[使用 SharpSvn 。](http://sharpsvn.net/)（AnkhSVN、Svn Monitor 和其他几个工具都建立在 SharpSvn 绑定之上）。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2012-01-25T02:04:05.307

[commandlinefu](http://www.commandlinefu.com/commands/tagged/35/svn/sort-by-votes "命令行fu")让我的生活更轻松，我需要一些奇怪的统计数据，如果你在 Windows 上，只需安装 cygwin。

# continuous-integration - Cruisecontrol 自定义图表

> ID：850540
> 
> 赞同：0
> 
> 时间：2009-05-11T23:41:04.790
> 
> 标签：continuous-integration, cruisecontrol.net

我已经解决了我[最初](https://stackoverflow.com/questions/839306/help-needed-configuring-cruisecontrol-net-statistics-merge)的统计数据收集问题，但现在想在一些漂亮的图表中呈现数据（很像 CCNET 中的默认图表）。我遵循了我认为正确的方法[，](http://www.ridgway.co.za/archive/2007/05/21/adding-custom-graphs-to-the-cruisecontrol.net-statistics-replacement.aspx)但仍然没有出现。有没有一个我可以看到的工作示例，我已经知道了？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-12T11:33:11.740

解决了！

我只需要实际按照说明进行操作，因此我不再需要帮助。

# flash - AS3 - 调度事件问题

> ID：850542
> 
> 赞同：0
> 
> 时间：2009-05-11T23:41:12.650
> 
> 标签：flash, actionscript-3, event-handling, dispatchevent

我有一个 Flash AS3 项目，它加载外部 SWF 并以不同的方式控制它们。在某些加载的 SWF 文件上，它们有一个“下一个选择”按钮，可将您带到新的演示文稿。在我的主要外部加载的 SWF 上，我有代码：

```
setTimeout(function() {dispatchEvent(new Event("nextPresentation", false));}, 4000); 
```

它会自动移动到集合中的下一个选择。这段代码完全按照我想要的方式工作。

在下一个加载的 SWF 中，用户没有超时，而是通过整个事情，在所有时间线的末尾有一个按钮，表示下一个选择。所以我在那里添加了以下代码：

```
function nextSelectionClick(evt:MouseEvent) {
    trace('here123');
    dispatchEvent(new Event("nextPresentation", false));
} 
```

出于某种原因，该事件永远不会弥补加载 SWF 的文件。我确定我正在处理点击事件，因为我得到了跟踪，但该事件永远不会弥补它，即使它看起来应该是与超时完全相同的行为。我在这里想念什么？为什么该代码的行为与按钮单击和超时不同？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-11T23:49:41.203

你是对的，它们应该发挥相同的作用，这就留下了一个巨大的问题，即应用程序中还发生了什么。似乎问题不在这里，但在其他地方。

我不想问这样的问题，但你确定事件是从根显示对象触发的吗？如果它不是从那里发射的，您将不会从外部听到它。

抱歉，如果没有看到更多实际代码或了解更多情况，我无法为您提供更多信息。

泰勒。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T00:04:37.870

我认为您已将`bubbles`属性设置为`false`. 这将防止事件比它所在的容器更远地冒泡。

试试这个：

```
dispatchEvent(new Event("nextPresentation", true)); 
```

另外，关于组织，我会创建一个`PresentationEvent`类并在它们上面设置`SKIP_PREVIOUS`和`SKIP_NEXT`事件常量。这与 ActionScript 使用的事件模型更加一致，并且减少了冗余。这样，您可以将当前演示文稿和其他方便的演示文稿相关数据作为事件的一部分传递。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-03-20T12:11:10.303

我也在使用调度自定义事件，但有时它工作，有时它不是。例如：

```
private function rollBackAction
{
  var atd:Class =  getDefinitionByName("com.utils."+CreateList.currentClass) as Class;
  dispatchEvent(new AppEvent("RollBackAction",{}));

} 
```

和使用功能

```
package com.utils
{

import com.components.mouseOverAct;
import com.model.CreateList;
import com.SequenceCheck.SeqCheck;
import com.events.AppEvent;

import flash.display.MovieClip;

import flash.events.MouseEvent;

import flash.events.Event;

public class RightRotate extends mouseOverAct
{
    private var rotateBool:Boolean;
    private var XposIntial:Number;
    private var A:Number;
    private var An:Number;
    private var angle:Number;
    var mc:MovieClip;
    private var frameCount:int;

    public function RightRotate()
    {
        trace("main")
        this.buttonMode = true;
        this.addEventListener("RollBackAction",rollingBack);
        knob_mc.addEventListener(MouseEvent.MOUSE_DOWN,turn);
    }
    private function rollingBack(e:AppEvent)
    {
        trace("Abc")
        knob_mc.rotation = An;
        rotation_01.gotoAndStop(A);
    }
    private function turn(e:MouseEvent):void
    {
        mc = simulator.activityAssets.spw.neddle;
        CreateList.excerciseName = "Right_Bottom_Right";
        CreateList.currentClass = "RightRotate";
        A = rotation_01.currentFrame;
        An = knob_mc.rotation;
        this.stage.addEventListener(MouseEvent.MOUSE_MOVE,turn);
        this.stage.addEventListener(MouseEvent.MOUSE_UP,endTurn);
        var position:Number = Math.atan2((mouseY - knob_mc.y),mouseX - knob_mc.x);
        //trace(position);
        angle = (position / Math.PI) * 180;
        knob_mc.rotation = angle;
        if (CreateList.stepId >= 3)
        {
            if (mc.currentFrame > 3)
            {
                mc.gotoAndStop(mc.currentFrame + 5);

            }
        }
        mainProcess();
    }

    private function endTurn(e:MouseEvent):void
    {
        rotateBool = false;
        rotation_01.gotoAndStop(rotation_01.currentFrame);
        knob_mc.removeEventListener(MouseEvent.MOUSE_DOWN,turn);
        this.stage.removeEventListener(MouseEvent.MOUSE_MOVE,turn);
        knob_mc.addEventListener(MouseEvent.MOUSE_DOWN,turn);
        var sqChck:SeqCheck = new SeqCheck(CreateList.stepId);

    }

    private function mainProcess()
    {
        if (! rotateBool)
        {
            rotateBool = true;
            rotation_01.gotoAndPlay(rotation_01.totalFrames / 2 + rotation_01.currentFrame);
        }
    }

}

} 
```

# wpf - 缩放控件到 WPF 表单

> ID：850554
> 
> 赞同：18
> 
> 时间：2009-05-11T23:44:42.957
> 
> 标签：wpf, silverlight, wpf-controls

如何对我的 wpf 表单实现缩放控件，类似于 Visual Studio 设计器中可用的控件？

谢谢！

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-12T04:57:00.153

将您的东西放入网格中，将网格的比例渲染转换绑定到滑块（滑块的最小值应为 1）：

```
 <Grid x:Name="LayoutRoot">
        <Grid.RowDefinitions>
            <RowDefinition Height="0.867*"/>
            <RowDefinition Height="0.133*"/>
        </Grid.RowDefinitions>
        <Slider x:Name="slider" Grid.Row="1" Minimum="1"/>
        <Grid RenderTransformOrigin="0.5,0.5">
            <Grid.RenderTransform>
                <TransformGroup>
                    <ScaleTransform 
                    ScaleY="{Binding Path=Value, ElementName=slider}" 
                    ScaleX="{Binding Path=Value, ElementName=slider}"/>
                </TransformGroup>
            </Grid.RenderTransform>
            <TextBox Text="TextBox" Height="45.214"
 VerticalAlignment="Top" Margin="194,139,209,0"/>
            <TextBox VerticalAlignment="Bottom" 
Text="TextBox" Margin="194,0,209,118.254" Height="48.96"/>
        </Grid>
    </Grid> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-12T22:05:53.110

也许您可以尝试[使用 Codeplex 上 WPF Extensions](http://wpfextensions.codeplex.com)中的 Zoom Control ：

[替代文本 http://i3.codeplex.com/Project/Download/FileDownload.aspx?ProjectName=wpfextensions&DownloadId=66810](http://i3.codeplex.com/Project/Download/FileDownload.aspx?ProjectName=wpfextensions&DownloadId=66810)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-02T18:08:10.617

要获得 WPF 的专业缩放控制，请查看[ZoomPanel](http://www.wpf-graphics.com/ZoomPanel.aspx)。

它不是免费的，但非常易于使用并具有许多功能 - 动画缩放和平移，支持 ScrollViewer，支持鼠标滚轮，包括 ZoomController（带有移动、放大、缩小、矩形缩放、重置按钮）。它还附带许多代码示例。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T08:36:11.250

你应该看看Mitsu Furuta 的[这篇文章](http://blogs.msdn.com/mitsu/archive/2009/03/09/wpf-surface-demo-driving-an-extending-desktop-with-a-popfly-duck.aspx)（不要担心有趣的标题！）。我不确定它是否完全符合您的要求，但它可以给您一些想法......

# asp.net - 如何在 Windows Server 上模拟 cron 作业？

> ID：850556
> 
> 赞同：11
> 
> 时间：2009-05-11T23:45:16.640
> 
> 标签：asp.net, cron

我在 Windows 机器上运行 .NET，我希望每晚午夜运行一个函数。当然，由于 HTTP 无状态和 Windows 没有“cron 作业”类型的功能（据我所知），我要么必须在每晚午夜自己访问我的站点，要么只是等待用户访问该站点以依赖关于它正在更新。

我可以创建一个替代方案，在某个时间自动运行某些东西吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-11T23:48:19.160

我很确定 Windows 的任务调度程序可以做 cron 可以做的大部分事情。但我可能会遗漏一些东西。

**编辑**：到达设置->控制面板->计划任务

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-12T23:32:06.137

如果其他答案都不适合您，这里有一个选项：

有一堆服务器监控服务会定期（如果你愿意的话，每分钟）对你的网站进行一次 http 调用。您可以在其中一些上免费获得 5 分钟的间隔。

创建一个受密码保护的页面，该页面执行您的功能（如果今天尚未完成）并将该服务指向它。

至少这样你就不需要写任何额外的东西，而且你可以放心，因为它不依赖于你的家用机器。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-12T00:32:31.490

Jeff Attwood 在播客中的某个时候提到了一个肮脏的黑客，使用缓存过期回调来伪造这个。

他会在 .Net 的缓存中插入一个项目，过期设置为 2 小时，一旦项目过期，就会调用回调，这就是他的 cron。

我认为这是文章：
[http ://www.codeproject.com/KB/aspnet/ASPNETService.aspx?display=Print](http://www.codeproject.com/KB/aspnet/ASPNETService.aspx?display=Print)

如果您问我，这很糟糕，但是对于共享托管解决方案，我想不出更好的办法。

此外，您可以向某些外部 cron 服务提供 URL，它们会定期“ping”它，例如：（这些不是免费的）
[http://webcron.org/](http://webcron.org/)
[http://www.webbasedcron.com/](http://www.webbasedcron.com/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T00:04:18.650

这是在任务计划程序中以编程方式添加/删除和管理任务的起点。

[http://www.codeproject.com/KB/system/taskscheduler.aspx](http://www.codeproject.com/KB/system/taskscheduler.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-12T00:58:02.620

如果你有命令行访问权限，你可以试试“at”命令，它就像一个超轻的 cron：

[http://support.microsoft.com/kb/313565](http://support.microsoft.com/kb/313565)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-12T01:26:50.217

您还可以查看 Quartz .Net [http://quartznet.sourceforge.net/](http://quartznet.sourceforge.net/)这是一个调度程序

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-02-17T15:52:14.813

cron的[windows 等效项是 At](http://en.wikipedia.org/wiki/At_%28Windows%29)。如果您可以访问机器。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-12T00:09:12.573

使用[Timer](http://msdn.microsoft.com/en-us/library/system.timers.timer.aspx)类创建一个定时调用要执行的方法的定时器。

静态定时器可以在 Global 类的 Application_Start 事件中启动。因为计时器使用间隔而不是绝对时间，所以您必须计算直到午夜的时间间隔并相应地设置[Interval](http://msdn.microsoft.com/en-us/library/system.timers.timer.interval.aspx)属性。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-12T00:26:43.810

看起来[GoDaddy 对此有规定](http://help.godaddy.com/topic/67/article/3549)，但方法不止一种：安装 Drupal 时，它需要您设置一个 cron 作业，我发现项目成员已经彻底记录了这一步。访问[http://drupal.org/cron](http://drupal.org/cron)获取更多信息，并记住阅读[http://drupal.org/node/31506](http://drupal.org/node/31506)以获取特定的 Windows 信息。如果一切都失败了，谷歌搜索“web cron job”并使用商业“cron job”服务。慎重选择，别被坑了。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-16T15:48:00.790

我也面临同样的问题。我想在 GoDaddy 上用 MSSQL 运行 ASP.NET。但是他们没有用于 Windows 托管的计划任务。看完帖子后，我自己google了一下，找到了这个免费的网络cron作业调度器：

我刚试过，效果很好……差不多。该工作将在 1 年内到期。

[http://www.setcronjob.com/](http://www.setcronjob.com/)

希望能帮助到你。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-09-25T08:46:12.660

在寻找同一个问题的答案时，我发现[这篇文章 (quartz-net-with-asp-net)带有](https://stackoverflow.com/questions/1356789/quartz-net-with-asp-net)[Quartz.NET](http://quartznet.sourceforge.net/)的设置说明（“Enterprise Job Scheduler for .NET Platform”，来自他们的网站），甚至来自ASP.NET 应用程序。

在这里添加主要是为了参考。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-05-12T23:25:36.193

为什么不安装 cygwin 并使用 cron 本身？

这是有关设置的pdf指南：

[http://csc.csudh.edu/kleyba/cygwin-cron.pdf](http://csc.csudh.edu/kleyba/cygwin-cron.pdf)

# iphone - 如何在公开发布之前将 iPhone 应用程序提交给客户进行审核？

> ID：850557
> 
> 赞同：6
> 
> 时间：2009-05-11T23:45:30.443
> 
> 标签：iphone, app-store

在提交到应用商店之前，我需要向客户展示我开发的应用以供审核。

客户端有一个 iPhone，但没有运行 xCode 的 mac。
我有一个个人（不是公司）的 iPhone 开发者帐户。
客户距离太远，无法亲自拜访。

我有哪些选择？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-11T23:48:04.153

如果客户端有 iTunes，您可以配置特定于客户端 iPhone ID（在 iTunes 中可见）的应用程序构建。他们只需要将其拖入 iTunes，然后将其安装到手机上。

Apple iPhone 开发者网站上有大量关于此的文档。祝你好运！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-12T00:29:18.237

选项1：

*   登录 iPhone 开发者门户网站。
*   将他们的 iPhone UDID 添加到设备列表中。
*   *生成包含您自己的测试电话和*他们的测试电话的配置文件。下载文件（以 .mobileprovision 结尾）。
*   双击它以将其安装在您的开发机器上。
*   退出并重新启动 XCode，然后将您的代码签名身份设置为此配置文件的名称。
*   构建二进制文件。
*   在 XCode “Groups & Files” 栏的左侧，查找 Products（可能需要展开文件夹）。
*   选择 {yourapp}.app。右键单击并选择“在 Finder 中显示”。
*   现在获取 .app 文件和您下载的 .mobileprovision 文件，将它们压缩并发送到客户端。
*   他们需要解压缩存档，然后将 .app 和 .mobileprovision 拖放到他们的 iTunes 上并同步手机。您的应用程序应该会显示并运行。
*   门户网站有更详细的说明，但这基本上是简而言之。

选项#2：

*   注册屏幕共享服务，例如 WebEx 或 Glance.net（在 Mac 和 Windows 机器上都可以使用）。当他们在他们的机器上观看截屏视频时，在模拟器中运行应用程序。如果它处于开发的早期阶段，这可能会更有用，因为他们可以提供实时反馈。在后期阶段，向他们发送应用程序可能更有用。屏幕共享的好处是他们可以接管鼠标并在您在那里进行解释时单击并探索。

选项#3：

*   获取 SnapzPro 或 ScreenFlow 之类的屏幕录制应用程序，并在模拟器中运行该应用程序，同时录制其功能的画外音。向他们发送电影的链接。如果您让他们了解所有功能，这将非常有用。如果一次不止一个人需要查看材料，它也很方便。与#2 相比的优势在于他们可以在自己的时间一遍又一遍地观看并做笔记。

根据开发阶段的不同，#3 可能在早期阶段最好，#2 在中间阶段，#3 在最后阶段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T00:01:23.740

我建议让客户端使用 iphone 配置实用程序来安装/卸载应用程序的早期版本。我正在与我的团队一起使用它，它可以让您直接访问手机的控制台和错误日志，这在您处于开发的早期阶段时非常方便。它还允许您管理应用程序的安装/卸载，并以比 iTunes 更易于管理的方式查看您正在安装的显式版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-09T13:10:42.463

选项#4：

试试[https://testflightapp.com/](https://testflightapp.com/ "试飞")，这很容易分发你的应用程序。甚至 Twitter Mirror 也在使用它来测试他们的 beta 版本。

# linq - 你见过的最可怕的 LINQ 函数是什么？

> ID：850561
> 
> 赞同：0
> 
> 时间：2009-05-11T23:47:32.407
> 
> 标签：linq, wcf, c#-3.0, rest

在处理个人项目时，我想要一个简单的服务来从 Outlook 中提取项目并以“RESTful”设计在 WCF 中托管。在这个过程中，我想出了这个相当可怕的课程。

人们还见过哪些其他可怕的 linq 代码？

```
public IQueryable<_AppointmentItem> GetAppointments(DateTime date)
{
    var dayFlag = (OlDaysOfWeek)(int)Math.Pow(2, (int)date.DayOfWeek);
    return
        OlDefaultFolders.olFolderCalendar.GetItems<_AppointmentItem>()
        .Select(a => new
        {
            Appointment = a,
            RecurrencePattern = a.IsRecurring ? 
                                a.GetRecurrencePattern() : null
        })
        .Where(a =>
            a.Appointment.Start.Date <= date &&
            (
                (a.RecurrencePattern == null && 
                 a.Appointment.End.Date >= date) ||
                (
                    a.RecurrencePattern != null &&
                    (
                        (a.RecurrencePattern.DayOfMonth == 0 ||
                         a.RecurrencePattern.DayOfMonth == date.Day) &&
                        (a.RecurrencePattern.DayOfWeekMask == 0 || 
                         ((a.RecurrencePattern.DayOfWeekMask & 
                           dayFlag) != 0)) &&
                         (a.RecurrencePattern.MonthOfYear == 0 || 
                          a.RecurrencePattern.MonthOfYear == date.Month)
                    )
                )
            )
        )
        .Select(a => a.Appointment);
}

[OperationContract()]
[WebGet(
    UriTemplate = "/appointments/{year}/{month}/{day}",
    RequestFormat = WebMessageFormat.Xml,
    ResponseFormat = WebMessageFormat.Xml,
    BodyStyle = WebMessageBodyStyle.Bare
    )]
[ContentType("text/xml")]
public XElement ListAppointments(string year, string month, string day)
{
    try
    {
        int iYear, iMonth, iDay;
        int.TryParse(year, out iYear);
        int.TryParse(month, out iMonth);
        int.TryParse(day, out iDay);

        if (iYear == 0) iYear = DateTime.Now.Year;
        if (iMonth == 0) iMonth = DateTime.Now.Month;
        if (iDay == 0) iDay = DateTime.Now.Day;

        var now = new DateTime(iYear, iMonth, iDay).Date; // DateTime.Now;
        return GetAppointments(now).ToXml();
    }
    catch (System.Exception ex)
    {
        return new XElement("exception", ex.ToString());
    }
}

using System;
using System.Collections.Generic;
using System.Linq;
using System.Xml.Linq;
using Microsoft.Office.Interop.Outlook;

namespace WhitedUS.ServiceModel.Office.Linq
{
    public static class OutlookUtilities
    {
        public static IQueryable<T> GetItems<T>(
            this OlDefaultFolders defaultFolderType)
        {
            return
                new ApplicationClass()
                .Session
                .GetDefaultFolder(defaultFolderType)
                .Items
                .OfType<T>()
                .AsQueryable();
        }

        public static XElement ToXml<T>(this IEnumerable<T> input)
        {
            if (input == null)
                return null;

            Type typ = typeof(T);
            var root = XName.Get(typ.Name.Trim('_'));

            return new XElement(root,
                input
                .Select(x => x.ToXml<T>())
                .Where(x => x != null)
                );
        }

        public static XElement ToXml<T>(this object input)
        {
            if (input == null)
                return null;

            Type typ = typeof(T);
            var root = XName.Get(typ.Name.Trim('_'));

            return new XElement(root,
                typ.GetProperties()
                .Where(p => p.PropertyType.IsValueType || 
                       p.PropertyType == typeof(string))
                .Select(p => new { Prop = p, Getter = p.GetGetMethod() })
                .Where(p => p.Getter != null)
                .Select(p => new { Prop = p.Prop, Getter = p.Getter, 
                                   Params = p.Getter.GetParameters() })
                .Where(p => (p.Params == null || p.Params.Count() <= 0))
                .Select(p => new { Name = p.Prop.Name, 
                                   Value = p.Getter.Invoke(input, null) })
                .Where(p => p.Value != null)
                .Select(p => new XAttribute(XName.Get(p.Name), p.Value))
                );
        }
    }
} 
```

另请参阅：[您见过的最严重的 LINQ 语法滥用是什么？](https://stackoverflow.com/questions/246270/what-is-the-worst-abuse-youve-seen-of-linq-syntax)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-12T12:47:51.937

[完全 LINQified RayTracer](http://blogs.msdn.com/lukeh/archive/2007/10/01/taking-linq-to-objects-to-extremes-a-fully-linqified-raytracer.aspx)非常可怕。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T13:14:06.880

实际上，我见过的最可怕的 Linq 查询是我的第一个查询。它足够熟悉，让我认为我理解它，但又足够不同，让我怀疑我是否真的理解它。

# asp.net - 为什么我的 CSS 在添加到项目之前无法工作？

> ID：850562
> 
> 赞同：1
> 
> 时间：2009-05-11T23:47:40.580
> 
> 标签：asp.net, visual-studio-2008, webdev.webserver

我有一个 asp.net mvc 项目，我用 iui css 和 javascript 包构建的向导替换了默认 css。它们被放置在 ~/Content/iui/ 文件夹中。当我通过开发网络服务器运行该站点时，没有使用 css。我设法通过将 iui 文件夹添加到项目资源管理器中的项目来修复它。这就是我所做的一切，页面已经正确设置了脚本和样式标签。

这里发生了什么？我确信 MSVS 在幕后做了一些事情，我想了解它为什么这样做，以及为什么我所做的事情会产生它所做的行为。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T11:04:11.570

查看您的网站项目的“属性页”（VS 菜单：网站 -> 启动选项）。在“MSBuild Options”下，“输出文件夹”设置是 Visual Studio Dev Web Server 在运行时使用的路径。只有属于项目的文件才会复制到此目录。

这就是为什么即使您将文件添加到正确的文件夹，它不是开发 Web 服务器正在查看的文件夹。

# visual-studio - Visual Studio 集成自定义 MSBuild 任务行为

> ID：850563
> 
> 赞同：1
> 
> 时间：2009-05-11T23:47:54.887
> 
> 标签：visual-studio, msbuild, nunit, msbuild-task

我在网上寻找一个 NUnit 自定义 MSBuild 任务，它可以在每个构建上运行，并且可以很好地使用 Visual Studio UI（2008 是我的版本）。我发现 MSBuild.Community.Tasks 项目很棒，但在 Visual Studio 集成部分失败了。我真正想要的是在 VS 的错误列表窗口中将失败的测试显示为警告/错误（以及测试不成功时的 FAILED 项目构建）。因此，我编写了自己的自定义 MSBuild 任务，该任务完全按照我的意愿完成。

但。

我遇到的唯一问题是正常的 VS UI 错误列表行为是，当您单击错误时，它会跳转到适当的源文件并**突出显示**有问题的代码。我能够将文件和行号与失败的测试相关联，但是我无法以任何方式说服 Visual Studio 为我突出显示有问题的代码（当我双击错误时）。我得到的只是光标在正确的位置。`line`我尝试了, `endLine`, `column`,`endColumn`方法参数 ( )的各种组合`Log.LogError()`，但无济于事。并且基于编译器错误的错误输出，它看起来也只提供了行和列（没有结束值）。

有人反对这个奇怪的问题并解决了它吗？

**2009 年 5 月 13 日更新您可以在**[http://code.google.com/p/nunitmsbuildvsintegrated/](http://code.google.com/p/nunitmsbuildvsintegrated/)
免费获得此项目（无需选择方法）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T10:00:55.523

对于此功能，您必须创建在 Visual Studio 中显示自定义面板的 Visual Studio 集成包。构建项目时将调用此自定义面板。

[Visual Studio 可扩展性开发人员中心](http://msdn.microsoft.com/en-us/vsx/default.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T07:06:45.020

我无法解决您的确切问题，但有一些想法。

您确定要在每次构建结束时运行一整套单元测试吗？我个人认为它是生产力杀手。相反，在处理代码时，我倾向于运行一小部分测试，这些测试仅涵盖有问题的代码，这就是[ReSharper](http://www.jetbrains.com/resharper/features/unit_testing.html#Unit_Test_Sessions)或[TestDriven.NET](http://www.testdriven.net/)等工具发挥作用的地方。

[![ReSharper 单元测试会话](https://i.stack.imgur.com/QfAQE.png)](https://i.stack.imgur.com/QfAQE.png)
[（来源：[jetbrains.com](http://www.jetbrains.com/resharper/features/previews/unit_test_sessions.png)）]

# python - Python 模块可以使用来自另一个文件的导入吗？

> ID：850566
> 
> 赞同：3
> 
> 时间：2009-05-11T23:48:29.567
> 
> 标签：python

我有这样的事情：

```
 # a.py  
 import os
 class A:
   ...

 # b.py
 import a
 class B(A):
   ... 
```

在 B 类（b.py）中，我希望能够使用在 a.py 中导入的模块（在本例中为 os）。是否可以在 Python 中实现这种行为，或者我应该在两个文件中导入模块？

编辑：我不担心导入时间，我的问题是导入块放在文件上的视觉混乱。我最终在每个控制器（RequestHandler）中都有这样的东西：

```
 from django.utils import simplejson
 from google.appengine.ext import webapp
 from google.appengine.ext.webapp import template
 from google.appengine.ext import db 
```

这就是我想避免的。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-12T00:11:58.747

是的，您可以通过 a.os 使用来自其他文件的导入。

但是，pythonic 方法是只导入您需要的确切模块，而不用创建一个链（这可能导致循环引用）。

当您导入一个模块时，代码会被编译并插入到名称字典 -> 模块对象中。字典位于 sys.modules。

```
import sys
sys.modules

>>> pprint.pprint(sys.modules)
{'UserDict': <module 'UserDict' from 'C:\python26\lib\UserDict.pyc'>,
 '__builtin__': <module '__builtin__' (built-in)>,
 '__main__': <module '__main__' (built-in)>,
 '_abcoll': <module '_abcoll' from 'C:\python26\lib\_abcoll.pyc'>,
# the rest omitted for brevity 
```

当您再次尝试导入模块时，Python 将检查字典以查看它是否已经存在。如果是，它会将已编译的模块对象返回给您。否则，它将编译代码，并将其插入到 sys.modules 中。

由于字典是作为哈希表实现的，因此与创建循环引用的风险相比，这种查找非常快速并且占用的时间可以忽略不计。

> 编辑：我不担心导入时间，我的问题是导入块放在文件上的视觉混乱。

如果你只有大约 4 或 5 个这样的导入，它不会太杂乱。请记住，“显式胜于隐式”。但是，如果它真的让您很困扰，请执行以下操作：

```
<importheaders.py>
from django.utils import simplejson
from google.appengine.ext import webapp
from google.appengine.ext.webapp import template
from google.appengine.ext import db

<mycontroller.py>
from importheaders import * 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T00:01:39.000

只需再次导入模块。

在 python 中导入模块是一个非常轻量级的操作。第一次导入模块时，python 会加载模块并执行其中的代码。在任何后续导入中，您只会获得对已导入模块的引用。

如果您愿意，您可以自己验证这一点：

```
# module_a.py
class A(object):
    pass

print 'A imported'

# module_b.py
import module_a

class B(object):
    pass

print 'B imported'

# at the interactive prompt
>>> import module_a
A imported
>>> import module_a     # notice nothing prints out this time
>>> import module_b     # notice we get the print from B, but not from A
B imported
>>> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T23:52:56.580

您应该单独导入它。但是，如果你真的需要转发一些功能，你可以从一个函数中返回一个模块。只是：

```
import os
def x:
   return os 
```

但它似乎是一个插件功能——对象+继承会更好地解决这种情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T23:56:47.790

听起来您想使用[python 包](http://docs.python.org/tutorial/modules.html#packages)。看看那些。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-12T00:05:07.790

是的。导入模块后，该模块将成为当前模块的属性。

```
# a.py
class A(object):
    ...

# b.py
import a
class B(a.A):
    ... 
```

例如，在 Django 中，许多包只是简单地导入其他模块的内容。类和函数在单独的文件中定义，只是为了分离：

```
# django/db/models/fields/__init__.py
class Field(object):
    ...
class TextField(Field):
    ...

# django/db/models/__init__.py
from django.db.models.fields import *

# mydjangoproject/myapp/models.py
from django.db import models
class MyModel(models.Model):
    myfield = models.TextField(...)
    .... 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-12T00:45:11.017

首先，您可以将其缩短为：

```
from django.utils import simplejson
from google.appengine.ext import webapp, db
from webapp import template 
```

其次，假设您在 my_module.py 中有这些 ^ 导入

在 my_module2.py 你可以这样做：

从 my_module2.py 导入 webapp、db、tempate

例子：

```
In [5]: from my_module2 import MyMath2, MyMath

In [6]: m2 = MyMath2()

In [7]: m2.my_cos(3)
Out[7]: 0.94398413915231416

In [8]: m = MyMath()

In [9]: m.my_sin(3)
Out[9]: 0.32999082567378202 
```

其中 my_module2 是：

```
from my_module import math, MyMath

class MyMath2(object):

    the_meaning_of_life = 42

    def my_cos(self, number):
        return math.cos(number * 42) 
```

而 my_module1 是：

```
import math

class MyMath(object):

    some_number = 42

    def my_sin(self, num):
        return math.sin(num * self.some_number) 
```

干杯，希望它可以帮助 AleP

# java - maven s3 wagon 供应商

> ID：850570
> 
> 赞同：16
> 
> 时间：2009-05-11T23:50:02.857
> 
> 标签：java, maven-2, amazon-s3

如何使用 wagon s3 提供商进行部署？

我发现了几个插件，其中大部分不完整，其中一些没有维护。还有一个来自官方 maven SVN 存储库的沙盒插件，但我正在考虑如何使用它。

有什么提示吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2010-12-07T17:07:53.223

spring 有一个更新的 s3 提供程序，它可以工作：

```
<build>
    <extensions>
        <extension>
            <groupId>org.springframework.build.aws</groupId>
            <artifactId>org.springframework.build.aws.maven</artifactId>
            <version>3.0.0.RELEASE</version>
        </extension>
    </extensions>
</build> 
```

如果你想在 maven 3 中使用它，你需要在你的 settings.xml 中加密你的密码。

分步说明在[这里](https://github.com/SpringSource/aws-maven)。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-01-03T14:02:31.583

[这辆货车](https://github.com/jcaddel/maven-s3-wagon/)是我们用来部署到 S3 的。它类似于 Spring 的，但具有多线程上传支持。

这让 CI 服务器可以非常快速地将大量 Maven 内容推送到 S3。（约 50 秒内 22k 个文件和 400mb 的内容）

[https://github.com/jcaddel/maven-s3-wagon](https://github.com/jcaddel/maven-s3-wagon)

```
<build>
 <extensions>
   <extension>
    <groupId>org.kuali.maven.wagons</groupId>
    <artifactId>maven-s3-wagon</artifactId>
    <version>1.2.1</version>
   </extension>
 </extensions>
</build> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-10-25T13:21:30.597

另一种选择：

```
<build>
  <extensions>
    <extension>
      <groupId>org.cyclopsgroup</groupId>
      <artifactId>awss3-maven-wagon</artifactId>
      <version>0.1</version>
    </extension>
  </extensions>
  [...]
</build> 
```

然后在`settings.xml`：

```
<servers>
  <server>
    <id>foo.s3</id>
    <username>AKIAJ.......OLVBA</username>
    <password>PsndORui..............KGZtDpeIYjsA/</password>
  </server>
</servers> 
```

然后在你的`pom.xml`：

```
<distributionManagement>
  <repository>
    <id>foo</id>
    <url>s3://foo.s3/</url>
  </repository>
</distributionManagement> 
```

应该管用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-10-23T21:01:59.833

另一个选项是 jcaddel 插件的一个分支，最后一次更新是 2016 年 3 月，但对我有用：

```
<extension>
    <groupId>co.axiomzen.maven.wagons</groupId>
    <artifactId>maven-s3-wagon</artifactId>
    <version>1.2.6</version>
</extension> 
```

看起来主要的弱点是：旧的 AWS 开发工具包版本，不使用默认 AWS 凭证链，因此缺乏对来自 ECS 的凭证之类的支持。此外，URL 中的“@”和“:”等字符没有正确编码，但我不确定这是 wagon 还是 Maven 的问题。

# unit-testing - 自动化测试：帮助和教育开发人员的方法？

> ID：850571
> 
> 赞同：5
> 
> 时间：2009-05-11T23:51:18.157
> 
> 标签：unit-testing, automated-tests

我是一名嵌入开发团队的软件测试工程师。我的大部分工作涉及检查项目自动化测试的状态（主要是单元/集成测试）。

我不是一个短视的狂热者，想要强行测试每个人的喉咙，但我**确实**想帮助每个人充分利用他们编写测试的时间。每周都会花费大量时间编写测试，因此最大化回报非常重要。

现在，我做一些事情来尝试和帮助。首先，我总是让自己可以谈论可测试性问题。例如，尝试识别测试策略、特定设计是否可测试等等。

除了向人们解释事情并试图帮助他们之外，我还审查了完成的代码和他们编写的测试（我必须在故事上签字，这意味着我也有点对抗）。

我目前的过程是独自坐下来，研究他们的代码，并为所有问题区域添加书签和评论，可以改进的地方以及改进的原因。然后我让开发人员到我的电脑前，讨论所有的评论点。然后我给他们发了一篇不错的文章，这样他们就有了记录，而且他们很容易参考。

我**不会**为他们修复他们的代码和测试，但如果我发现差距，我会添加更多测试用例等。我决定不为他们修复测试的原因是，开发人员很容易说“谢谢”却不去理会。我的理由是，如果他们必须在我签字之前解决我发现的问题，这将导致项目测试的更好标准（即更自给自足的开发人员测试）。

**我的问题是：在帮助球队方面，我能做得更好吗？您发现了哪些有益的方法？**

我特别想听听那些面临相同挑战的类似职位的人的意见（例如，帮助提高测试质量，证明价值测试可以带来相关情况，并且在支持和对抗之间取得良好的平衡。）

***编辑**：感谢您的回答；所有这些都包含有用的建议。我将排名靠前的答案标记为最佳答案，因为我想这取决于开发人员的支持，而结对编程是我尚未尝试过的事情（在测试后没有一些即兴的“这就是我将如何做到这一点”的演示书面）。我会和任何努力测试某样东西的人一起尝试一下:) 干杯。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-11T23:57:43.497

如果您有某些人在测试方面往往较弱，那么请与他们坐下来，结对编程之类的，并且在他们处理代码时，您可以帮助他们了解如何进行测试。

一段时间后，这些人应该会在单元测试方面做得更好，而你在这方面的工作量应该会减少。

另一件事是每个人都应该关注测试。如果我触摸一个功能，进行任何更改，那么我应该检查测试以确保它们是完整的。如果有问题，我可以与开发人员讨论。

您还应该争取团队负责人的工作，因为这是他的职责的一部分，或者应该是，以确保每个人都了解如何很好地编写测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T14:24:29.293

我会做的几件事：

1.  让他们进行覆盖并发现任何遗漏的代码区域，并强调尽管他们认为自己已经涵盖了所有案例，但他们可能没有。我和几个人一起做过这个，当他们认为他们已经编写了防水测试时，他们总是对他们错过的地方感到非常惊讶
2.  在本地 Wiki 上创建一个“食谱”页面。每当有人提出他们无法弄清楚或需要您帮助的测试场景时，请将其粘贴在 Wiki 上并使其易于查找。让其他人也做出贡献
3.  听起来您无论如何都已经这样做了，但请确保当有人遇到与测试相关的问题时，即使这会损害您的正常工作量，也*要让自己有空。*如果你对它充满热情，它应该会激励那些有兴趣做正确事情的人。

当我介绍某人进行测试（或一种新的测试技术）时，我经常会花费大量时间随机走到他们的工作站，只是为了看看他们的进展情况并把他们推向正确的方向。在去喝茶/抽烟休息或进行构建时，这可以很好地安装。我对此有很好的反馈，但 YMMV。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T14:42:21.237

根据团队的规模，我想知道在对代码进行初步审查之后是否有意义，让其他人成为另一组眼睛，可以看到你提出的更改并作为一种展示方式这不仅仅是你对它的看法。这可以作为一种方式来突出您希望看到哪些更改可能存在一些紧张，开发人员可能会回答：“哦，这需要数周时间，而且可能不值得......”或类似的东西，如果你想改变的不是那么简单。

同样，大多数团队如何看待测试？是否有领导者或受人尊敬的人对此持积极态度并有助于培养对它的积极态度？是否有关于测试指南的一般文档可以帮助团队新手快速上手？这些只是我要检查的其他几个领域，因为有时测试可能是一件好事，有时它们可​​能会很痛苦。就像半空或半满的玻璃杯，这取决于你想怎么看。

并不是说我有同样的职位，但作为一个已经做了一段时间的开发人员，这正是我希望看到的帮助使测试成为一件好事，正如玛莎斯图尔特所说的那样。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-18T16:22:52.457

让团队轻松开始测试的一种方法是在修复错误时开始编写测试的实践。因此，当出现错误时，首先要做的是编写一个由于错误而失败的测试，修复错误然后让测试通过。

这种方法也可以在代码被内部修改（没有公共 API 更改）时完成 - 编写测试以覆盖正在修改的区域，以确保它不会被代码更改破坏。以这种方式编写测试的工作量要少得多，并且一旦开发人员发现他们的第一个回归错误，就清楚地展示了好处。

# gmail - 在 Debian exim4 中添加 gmail 作为 smarthost

> ID：850574
> 
> 赞同：-1
> 
> 时间：2009-05-11T23:53:01.040
> 
> 标签：gmail, debian, exim4, smarthost

我想知道如何在 Debian 上设置我的 exim4，以便它可以使用 gmail 作为智能主机，而不是我的 ISP。似乎需要设置 TLS，当然还有 gmail 用户名和密码。Debian 中 exim4 附带的“标准”智能主机示例没有这些。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-07T02:36:27.900

上述解决方案由于某种原因不起作用，但这里的解决方案对我有用。

[http://www.manu-j.com/blog/wordpress-exim4-ubuntu-gmail-smtp/75/](http://www.manu-j.com/blog/wordpress-exim4-ubuntu-gmail-smtp/75/)

我所做的唯一更改是使用`xyz@mydomain.com`而不是`xyz@gmail.com`在“开始身份验证器”部分中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T00:12:12.490

首先，安装 stunnel4 并将其配置`[127.0.0.1]:587`为`smtp.gmail.com:465`像这样映射：

```
client=yes
[smtp-gmail]
accept = 587
connect = smtp.gmail.com:465 
```

然后重新配置exim4：

```
dpkg-reconfigure exim4-config 
```

配置exim4使用很多小文件，smarthost通过localhost:587

编辑 /etc/exim4/passwd.client 并添加：

```
localhost:yourname@gmail.com:yourpassword 
```

记得检查权限，然后运行：

```
update-exim4.conf 
```

那应该这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T16:45:29.473

请参阅 Debian Wiki 上的说明：

[http://wiki.debian.org/GmailAndExim4](http://wiki.debian.org/GmailAndExim4)

# c++ - 在不调用 uac 的情况下启动服务

> ID：850575
> 
> 赞同：4
> 
> 时间：2009-05-11T23:53:12.820
> 
> 标签：c++, windows, service, uac

我注意到一些应用程序（如 steam）能够以普通用户身份启动/停止服务，而无需调用 uac 控件。有谁知道怎么做？

操作系统：Vista/Win 7 Visual Studio 2005 C++

.

编辑：昨晚我在玩蒸汽服务，试图弄清楚它有什么不同。如果我将我的服务 exe 放在 steam 所在的位置，它可以在没有 uac（使用 sc.exe）的情况下正常启动，但如果我使用的是我的 steam exe，它就不起作用。在注册表中查看服务信息时，我发现 Steam 具有额外的权限部分。这是什么意思，你如何设置它？

.

编辑2：您需要更改服务的用户访问权限：http: [//msdn.microsoft.com/en-us/library/ms684215 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms684215(VS.85).aspx)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-12T01:22:17.743

启动（或停止）服务的能力由服务上的 ACL 控制。如果您授予交互式用户启动您的服务的权限，他们就可以启动您的服务。

这完全取决于您在安装服务时如何设置服务。

显然，您必须使用 Windows 服务 API (OpenSCManager/OpenService/StartService) 来启动服务。

# .net - 如何调用重写的 MSBuild 目标

> ID：850577
> 
> 赞同：11
> 
> 时间：2009-05-11T23:53:26.627
> 
> 标签：.net, msbuild

在 MSBuild 中，您可以覆盖`<Target />`您自己的另一个文件中的 a。例如，文件中包含的*AfterBuild*目标`Microsoft.Common.targets`只需定义您自己的具有相同名称的目标：

```
<Target Name="AfterBuild">
    <!-- Do something different -->
</TargetName> 
```

你会看到这样的注释：

使用项目“XXXXX”中的目标“AfterBuild”覆盖项目“C:\Windows\Microsoft.NET\Framework\v3.5\Microsoft.Common.targets”中的目标“AfterBuild”。

**有没有办法调用原来的 AfterBuild 目标？**

我想这样做以检测某些复杂的默认目标，然后执行原始行为。许多像 Build 这样的目标都公开了一个可以用于此的 BuildDependsOn 属性。许多其他人没有 - 我想在不完全复制其内容的情况下覆盖它们。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-14T02:45:54.477

处理 MSBuild 脚本时，它还将处理导入的文件。结果将是整个脚本在内存中的单一规范表示。当遇到已经存在的目标时，先前的定义将被丢弃，因此无法调用原始目标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-02-08T12:44:19.247

> 我想这样做以检测某些复杂的默认目标，然后执行原始行为。许多像 Build 这样的目标都公开了一个可以用于此的 BuildDependsOn 属性。许多其他人没有 - 我想在不完全复制其内容的情况下覆盖它们。

如果您想先在目标上运行自定义的东西，然后再运行原始目标，为什么不直接使用`BeforeTargets`？

所以而不是

```
<Target Name="AfterBuild">
    <!-- custom AfterBuild overriding default AfterBuild -->
</TargetName> 
```

只需使用

```
<Target Name="JustBefore_AfterBuild" BeforeTargets="AfterBuild">
    <!-- custom AfterBuild just before default AfterBuild -->
</TargetName> 
```

# c - 使用 Win32 和视觉样式的按钮背景透明度

> ID：850581
> 
> 赞同：0
> 
> 时间：2009-05-11T23:54:57.153
> 
> 标签：c, winapi, button, transparency, comctl32

***编辑：**如果有人以前在win32中尝试过这个，我是否通过使用DrawThemeBackground（）朝着正确的方向前进？*

我最近使用 ComCtl32.dll 版本 6 的清单启用了视觉样式。Win32 中的视觉样式示例：[视觉样式](http://msdn.microsoft.com/en-us/library/bb773187(VS.85).aspx)

按钮看起来很棒，但我不知道如何使按钮周围的背景透明。请查看示例图片：[http ://www.freeimagehosting.net/image.php?2bdeff33ba.jpg](http://www.freeimagehosting.net/image.php?2bdeff33ba.jpg)

我的主窗口背景颜色设置为深灰色：

```
a.hbrBackground = GetStockObject(DKGRAY_BRUSH); 
```

常用控件初始化为：

```
INITCOMMONCONTROLSEX stylesStruct;
stylesStruct.dwSize = sizeof(stylesStruct);
stylesStruct.dwICC = ICC_STANDARD_CLASSES;
InitCommonControlsEx(&stylesStruct); 
```

我创建了按钮窗口：

```
j = CreateWindow(L"BUTTON", L"hello",
    WS_VISIBLE | WS_CHILD | BS_DEFPUSHBUTTON, 100, 100,
    100, 100, h, 0, hInst, 0); 
```

按钮在白色背景上看起来很好，但边框在其他任何东西上都可见。是否可以使按钮周围的边框透明？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T03:25:55.920

你试过`WS_EX_TRANSPARENT`吗？

我认为你可以在 Visual Studio 的资源编辑器中设置它，如果你正在使用它。

# c# - 强制获取/设置私有属性的私有变量的访问权限

> ID：850586
> 
> 赞同：6
> 
> 时间：2009-05-11T23:58:42.077
> 
> 标签：c#

如果我有一个私有变量，我想对其进行一些内部验证，并且我想将该验证保存在一个地方，我将它放在一个 getter/setter 后面，并且只能通过那个 getter/setter 访问它。这在处理公共属性时很有用，因为其他代码无法访问私有变量，但是当我处理类本身内部的对象时，有没有办法强制执行 getter/setter？

```
 private int _eyeOrientation;

  private int eyeOrientation
  {
     get
     {
        return _eyeOrientation;
     }
     set
     {
        if (value < 0)
        {
           _eyeOrientation = 0;
        }
        else
        {
           _eyeOrientation = value % 360;
        }
     }
  } 
```

这里的问题是类中的其他函数可能会意外修改

`_eyeOrientation = -1;`

这会使程序陷入困境。有没有办法让它抛出编译器错误？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-12T00:30:57.577

听起来你需要一个角度类型。

```
// Non mutable Angle class with a normalized, integer angle-value
public struct Angle
{
  public Angle(int value)
  {
    Value = value;
  } 

  private angle;
  public Value 
  { 
    get { return angle; } 
    private set { angle = Normalize(value); } 
  }

  public static int Normalize(int value)
  {
     if (value < 0) return 360 - (value % 360);
     return value % 360;
  }
}

public class SomeClass
{
  public Angle EyeOrientation { get; set; }
} 
```

如果您有某种值，例如角度、金钱、重量或其他任何值，将其设为自己的类型始终是一个很好的实践，即使值本身存储在 int、decimal 等中。这种类型使您的接口更清晰和类型安全。如果您期望角度或整数值作为某些方法的参数，则情况不同。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-12T00:14:14.720

一般来说，你不应该担心这个。如果您不想在类本身中进行检查，类成员仍然可以使用这些属性。

如果您的类变得如此之大以至于您不再信任类中的方法，那么我认为是时候开始重构并将其分解为更易于管理的较小类了。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-12T00:11:09.000

您可以在嵌套类中定义它。

```
public class NeedsEye
{

    Eye _eye = new Eye();

    public NeedsEye()
    {
        // now, here, any access to the property must be made through the
        // _eye variable. The Eye class has access to any of the properties
        // and members of the NeedsEye class, but the NeedsEye class has not
        // any access to members of the Eye class.
    }

    private class Eye
    {
        private int _orientation;

        public int Orientation 
        {
            get { return _orientation; }

            if (value < 0)
            {
               _eyeOrientation = 0;
            }
            else
            {
               _eyeOrientation = value % 360;
            }     
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-12T11:37:17.583

您可以将该字段标记为过时，以便编译器在您尝试访问它时生成警告，然后为属性 getter/setter[禁止该警告](http://msdn.microsoft.com/en-us/library/441722ys.aspx)。

[对于普通`Obsolete`属性](http://msdn.microsoft.com/en-us/library/h0h063ka.aspx)，您需要禁止显示的警告代码是CS0612，[如果属性具有自定义消息](http://msdn.microsoft.com/en-us/library/x5ye6x1e.aspx)，则为 CS0618 。

一般来说，我认为这有点像 hack，并尽可能避免它。更好的解决方案是适当地注释代码并培训您的开发人员，以便他们做正确的事情。

```
[Obsolete("Please use the EyeOrientation property instead.")]
private int _eyeOrientation;

public int EyeOrientation
{
    #pragma warning disable 612, 618
    get
    {
        return _eyeOrientation;
    }
    set
    {
        _eyeOrientation = (value > 0) ? value % 360 : 0;
    }
    #pragma warning restore 612, 618
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-12T00:12:33.553

只需将您的私有属性和公共 getter/setter 放入私有类中。

那么只有 getter 和 setter 才能访问私有属性。

这是矫枉过正，但会工作。:)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-12T10:57:55.683

根据您的工具，您可以考虑强制执行编码约定，不允许直接访问 get/set 之外的私有成员

可能需要做更多的工作，但您不必创建一系列包装类。

# ms-access - 如何在 Access 中“链接”链接表？

> ID：850596
> 
> 赞同：8
> 
> 时间：2009-05-12T00:01:42.993
> 
> 标签：ms-access

我的场景：计算机 A 有一个包含链接表的 Access 数据库。这些链接表实际上驻留在计算机 B 上的另一个 Access 数据库中。还没有什么不寻常的。

现在我们创建一个 SQL Server 数据库，并在计算机 B 上的 Access 数据库中建立这些表的链接；我们配置一个机器 DSN 来定义计算机 B 上必要的 ODBC 连接。Access 数据库 B 现在包含本地表和链接的 SQL 表。

Access 数据库 A 现在想要链接到 Access 数据库 B 的新表 - 但只有其本地表显示在对话框中以添加链接表。看来您不能在 Access 中“链接到链接表”...

但这真的是真的吗？我们要做的是呈现数据库 B 的 SQL 表链接到数据库 A *，就好像它们是本地表一样*；即数据库A 不知道数据库B 中的新表实际上不是本地的。

当然，我们可以通过在*该*计算机上配置 DSN 将 SQL 表直接链接到数据库 A，但我们不想这样做。我们希望使用计算机/数据库 B 作为连接或“网关”，将本地和 SQL 表无缝地呈现给网络上的其他 Access 客户端应用程序。这只是一个临时设置，它允许我们将所有 Access 客户端应用程序逐步迁移到基于 SQL Server 的表中，而无需修改大量代码。

这可以做到吗？是否还有其他我们没有想到的可行解决方案或场景？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T05:34:10.843

不——你只能链接到真实的表——你必须重新创建你在数据库 B 上为数据库 A 所做的 SQL 服务器链接

如果 SQL Server 数据没有太大变化，而您只是将其用于查找，则可以将数据导入到可以链接到的真实 Access 表中。

编辑

另一种解决方案是动态链接表格 - 这样您就不必手动将 DSN 添加到每台计算机。使用类似这样的连接字符串：

```
ODBC;Driver={SQL Server};Server=<server name/IP>;Database=<database>;UID=<user>;PWD=<password> 
```

这链接了一个表

```
Dim db As Database
Dim TD As TableDef
Dim sTableName As String  ''MS Access name (can be same as SQL Server name)
Dim sServerTableName As String  ''SQL Server Name 

sTable = "Table1"
sServerTableName  = "dbo.Table1"
sServerConnect = "ODBC;Driver={SQL Server};Server=Localhost;Database=DB1;"

Set TD = db.CreateTableDef(sTableName)
TD.Connect = sServerConnect
TD.SourceTableName = sServerTableName

db.TableDefs.Append TD
db.TableDefs.Refresh 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T20:12:09.130

关于查询建议，可以在`IN 'C:\OtherDatabase.mdb'`子句中使用`FROM`子句：

```
SELECT qryMyTable.*
FROM qryMyTable IN 'c:\OtherDatabase.mdb'; 
```

这将在存储查询的数据库中为您显示另一个数据库中的查询内容。如果到另一个数据库的路径没有改变，你可以使用这个方法来捎带另一个数据库的链接表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T00:12:33.647

您能否在 B 上创建一个查询/视图，它只是 C 上链接表的视图，以便 A 可以访问 B 上的查询/视图（实际上是 C 上的表）？

像：

```
A 上的链接查询 -> B 上的查询
                                ：
                       B 上的链接表 -> C 上的真实表

```

评论后编辑：好的，显然你不能链接到查询，所以那将不起作用。

另一个想法：您能否在 B 和 C 之间设置复制，以便将 C 的所有表复制到 B，A 可以访问它们？

# reporting-services - Reporting Services Borderstyle 属性问题

> ID：850603
> 
> 赞同：0
> 
> 时间：2009-05-12T00:07:28.660
> 
> 标签：reporting-services, border

我正在使用矩阵控制`RS2008`。我想使用表达式将矩阵的值单元格（第 2 列，第 2 行）设置为底部没有边框或双边框。我有一个`boolean`为报告的每一行设置此条件的字段。底部边框样式的表达式是...

```
=Iif(Fields!DoubleBottom.Value=True, "Double", "None") 
```

边框宽度设置为`3pt`。当此表达式位于 Value 单元格中时，该表达式似乎被评估为 backwords。有属性`True`时没有边框，有属性时`False`有双边框。除了反转问题外，双边框适用于报告中的所有行。不仅仅是属性所在的行`True`。如果我从 Value 单元格中删除表达式并将其放入 (col 1, row 2) 的单元格中，它就可以正常工作。即每行中的第一个单元格具有适当的边框。关于为什么 Value 单元格应该以这种方式运行的任何想法？我正在为此单元格设置其他条件属性，它们工作正常。例如，我正在设置`Format`属性（小数位数）并且有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-13T17:53:15.360

对于将双边框应用于报告中的所有行的问题，我遇到了条件边框的问题。我的问题已通过将默认 BorderStyle 属性设置为“无”来解决。

# visual-studio-2008 - VS 2008 + 英特尔 Fortran 问题

> ID：850605
> 
> 赞同：1
> 
> 时间：2009-05-12T00:08:33.793
> 
> 标签：visual-studio-2008, fortran

我正在使用 VS 2008 和英特尔的 Visual Fortran 编译器。它与 VS 的集成非常好，但我仍然想整理一些东西。希望你能帮助我解决其中的一些问题。

1.  有没有办法在 VS 中定义新的大纲（折叠）规则，以便它自动从 CALL SUBROUTINE 折叠到 END SUBROUTINE ？
2.  有没有办法重新定义 VS 的键盘快捷键。我想将评论快捷方式从默认重新定义为更简单的东西，比如 Alt-C ？
3.  我经常做一个项目，我必须在配置属性下添加一些额外的依赖项，以及一些库。有没有办法我可以以某种方式定义新项目（你知道，当我去新项目时，我会有 MyNiceProject），所以我已经预定义了这些设置。
4.  我已经安装了 Intel 的 Array Visualizer。作为一个独立的应用程序是一件好事，但是当我进入调试模式时，我似乎无法可视化任何数组。调试工具栏下的“查看数组”选项只是保持灰色。有任何想法吗 ？

任何这些帮助将不胜感激。

我知道这是一个标题下的 4 个问题，但在这里使用 fortran 和 vs 的人并不多，所以我认为最好不要用 4 个单独的问题“窒息”主页。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-09-15T15:43:33.077

我知道关于阵列可视化器的一个答案，我敢打赌你的操作系统是 64 位的。阵列可视化器与 VS 2008 的集成不适用于 64 个操作系统。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-09-15T16:02:11.963

1.  不知道。

2.  是 - 工具 | 选项 | 环境 | 键盘

3.  不知道。

4.  不知道。

但是我对您的问题的回答不足，这激发了我尝试去了解更多信息。我承认我通常使用 Emacs 来编辑 Fortran 源文件，只是使用 VS 作为 Windows 的构建工具。

# git - git分支参考中的`..`是什么意思？

> ID：850607
> 
> 赞同：36
> 
> 时间：2009-05-12T00:09:46.457
> 
> 标签：git

```
git log origin/master
git log origin/master.. 
```

与上面的确切区别是什么？我试图了解`..`符号的确切作用。我认为这是一个范围，但在这种情况下，它做了一些不同的事情。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-05-12T00:52:26.827

使用`git log`（以及所有其他采用类似参数集的 Git 命令），它是如何找到一系列修订的规范，是的。请记住，在 Git 的一般世界中，这意味着修订图的某些子图——对于大多数人来说，它通常意味着列表中的一系列修订。（如果你没有做太多的分支，它也会简化为 Git 中的那个）。

修订规范包含一组正面引用（起点）和负面引用（终止点）和附加过滤器（限制修订数、grep 提交文本等）。Git 从正面引用开始并返回修订历史记录，当它遇到可从负面引用到达的修订时停止（不一定只是在它到达负面引用之一时）。

可能相当令人困惑的是，已经发展了各种速记符号，旨在使这一切更易于使用，但不知何故也设法混淆了——我不得不花很长时间弄清楚“master..maint”是什么，“ maint..master”等表示以及何时使用哪个。

当你只说“origin/master”时，这意味着“origin/master”是一个积极的参考，没有消极的参考。因此，Git 从 origin/master 开始并回溯*所有*可用的修订——您将获得 origin/master 的完整历史记录。

“origin/master..”是“origin/master..HEAD”的简写，它看起来有点像“从起源/主人到 HEAD”的意思。它确实有效。它可以重写为“HEAD ^origin/master”或“HEAD --not origin/master”。在这种情况下，HEAD 是正引用，“origin/master”是负引用。因此，Git 从 HEAD 开始，然后遍历图形，直到遇到可从 origin/master 访问的修订。事实上，它很可能会遇到 origin/master 本身。请注意，所有引用都是包含性的——正引用本身是输出，而负引用不是（除非你给出 --boundary，然后它们被标记）。这意味着“origin/master..HEAD”

因此，如果您在上游版本之上进行了几次本地提交，您就会遇到这种情况：

```
steve@monolith:~/src/git <master>$ git log --pretty=oneline --abbrev-commit --decorate -n 4
ea3107d (refs/heads/master) Add another dummy comment
869c260 Add dummy comment
6345d7a (refs/remotes/origin/master, refs/remotes/origin/HEAD) Merge branch 'maint'
be427d7 allow -t abbreviation for --track in git branch 
```

现在“git log origin/master..”意味着 git 将从 HEAD (ea3107d) 开始，这是从 origin/master 无法访问的，所以它会打印出来。然后它回到 HEAD 的父级 (869c260)，它仍然不是，所以打印出来。然后下一个父节点是 6345d7a，它*是*origin/master，所以它会停止。

请注意，“git log ..origin/master”的作用相反——尝试从 origin/master 回到 HEAD。在这种情况下，它不会打印任何东西。但是，如果我检查了“origin/maint”，它会打印出 origin/master 上不在 origin/maint 上的修订：所以一般来说，尝试将“A..B”视为“B 中不存在的修订”在 A”中，并记住省略 A 或 B 表示“HEAD”。

只是为了额外的超级骗子，还有一个符号“A...B”。所以记得数点数！在 A 和 B 处于同一修订版的情况下，没有真正的区别。但是“A...B”的意思是 A 或 B 中的修订不在 A 和 B 的任何合并基础中。因此，如果 A 和 B 位于不同的分支上，它会显示在任一分支上所做的所有提交因为他们分道扬镳。

修订范围的“长格式”（“B --not A”）允许您指定诸如“不在任何远程跟踪分支上的本地分支上的所有修订”（“--branches --not --遥控器”）。这个参数列表由许多 Git 命令解析（“git rev-list”是核心命令），包括 gitk。因此，您可以执行“gitk --branches --not --remotes”以图形方式查看本地更改。

最后，对于超级混淆，“git diff”之类的命令接受相同类型的速记语法，但这并不意味着（完全）相同的东西。`git diff`实际上需要两个修订并比较它们，这与范围不同——请记住，Git 中的修订范围是一个子图，而不仅仅是一个列表。“git diff A..B”等价于“git diff A B”。“git diff A...B”的意思是“显示 B 与 A 不同后的变化”。令人困惑？只是一点点：例如，“git log A...B”和“git log B...A”意思相同，但“git diff A...B”和“git diff B...A” “ 不。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-05-16T10:39:50.453

```
git log origin/master 
```

就像（假命令）：

```
git log INITIAL..origin/master 
```

尽管：

```
git log origin/master.. 
```

是：

```
git log origin/master..HEAD 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-12T00:36:03.420

我认为这是一个范围。“..”命令将向您显示原始/主最后一次提交与您正在处理的分支上的最后一次提交之间的提交。

您还可以通过将其放在..之后来指定要比较的分支，因此它将变为

```
git log origin/master..<branch_name> 
```

您还可以使用提交标识符来过滤输出，例如：

```
git log 663f4c..fec6b 
```

尝试`git help log`查看其他选项:-)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-06-21T11:39:08.750

我自己记住语义的助记方式......

我认为 'git log start..end' 的日期范围是**start**代表**历史的较早部分**，而**end**代表**较新的历史**。但是，与日期范围不同，提交范围不是线性回溯，与实际时间无关，而是设置减法，即：

```
(commits reachable from "end") - (commits reachable from "start") 
```

请记住，提交范围中的**开始**（将被排除）代表一组一个或多个提交，而不是一个单一的提交。

实际上，它指的是在“开始”（不包括）和“结束”（包括）之间创建的所有提交。

# c# - 连接数组中所有字符串并用空格分隔的有效方法是什么？

> ID：850610
> 
> 赞同：8
> 
> 时间：2009-05-12T00:11:54.350
> 
> 标签：c#, string, concatenation

假设我有一个字符串数组：

```
string[] myStrings = new string[] { "First", "Second", "Third" }; 
```

我想连接它们，所以输出是：

```
First Second Third 
```

我知道我可以像这样连接它们，但是两者之间没有空格：

```
string output = String.Concat(myStrings.ToArray()); 
```

我显然可以循环执行此操作，但我希望有更好的方法。

**有没有更简洁的方法来做我想做的事？**

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-12T00:12:35.767

试试这个：

```
String output = String.Join(" ", myStrings); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T00:15:35.263

```
StringBuilder buf = new StringBuilder();
foreach(var s in myStrings)
  buf.Append(s).Append(" ");
var ss = buf.ToString().Trim(); 
```

# c++ - 如何从崩溃中提取调试信息

> ID：850617
> 
> 赞同：11
> 
> 时间：2009-05-12T00:12:51.850
> 
> 标签：c++, windows, crash, stack-trace, backtrace

如果我的 C++ 应用程序在 Windows 上崩溃，我想将有用的调试信息发送到我们的服务器。

在 Linux 上，我会使用 GNU`backtrace()`功能 - Windows 是否有等效功能？

有没有办法在程序崩溃后提取有用的调试信息？还是仅来自流程内部？

（“测试你的应用程序以使其不会崩溃”的建议没有帮助！-所有非平凡的程序都会有错误）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-12T00:24:05.903

[Stackwalk64](http://msdn.microsoft.com/en-us/library/ms680650.aspx)函数可用于在 Windows 上捕捉堆栈跟踪。

如果您打算使用此功能，您应该确保在禁用 FPO 的情况下编译您的代码 - 如果没有符号，StackWalk64 将无法正确遍历 FPO 的帧。

`__try/__except`通过调用 SetUnhandledExceptionFilter，您可以通过顶级块让一些代码在崩溃时运行在进程中。这有点不可靠，因为它要求您在崩溃的进程中运行代码。或者，您可以只使用内置的 Windows 错误报告来收集崩溃数据。这更可靠，因为它不需要您添加在受损、崩溃的进程中运行的代码。唯一的成本是获得代码签名证书，因为您必须向服务提交签名的二进制文件。 [https://sysdev.microsoft.com/en-US/Hardware/signup/](https://sysdev.microsoft.com/en-US/Hardware/signup/)有更多详细信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T00:30:09.420

如果您希望滚动自己的代码，可以使用 Windows API 调用[MiniDumpWriteDump 。](http://msdn.microsoft.com/en-us/library/ms680360.aspx)Windows XP 和 Vit 都自动执行此过程，您可以在[https://winqual.microsoft.com](https://winqual.microsoft.com)上注册以访问错误报告。

另请查看[http://kb.mozillazine.org/Breakpad](http://kb.mozillazine.org/Breakpad)和[http://www.codeproject.com/KB/debug/crash_report.aspx](http://www.codeproject.com/KB/debug/crash_report.aspx)了解其他解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T00:21:30.837

该网站提供了在 C++ 异常后在 Win32 上进行堆栈检索的非常详细的概述：

[http://www.eptacom.net/pubblicazioni/pub_eng/except.html](http://www.eptacom.net/pubblicazioni/pub_eng/except.html)

当然，这只会在进程内部起作用，所以如果进程终止或崩溃到它在代码运行之前终止的地步，它将无法工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-12T00:25:47.867

生成一个小型转储文件。然后，您可以将其加载到`windbg`Visual Studio 中并检查发生崩溃的整个堆栈。

[这是](http://msdn.microsoft.com/en-us/library/bb204861.aspx)开始阅读的好地方。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-12T08:14:02.267

将当前堆栈帧地址转储到日志文件中非常简单。您所要做的就是在程序故障（即Windows 中的中断处理程序）或断言上调用这样的函数。这也可以在发布的版本中完成。然后可以将日志文件与映射文件匹配，从而生成带有函数名称的调用堆栈。

几年前我发表了一篇关于这个的文章。

见[http://www.ddj.com/architect/185300443](http://www.ddj.com/architect/185300443)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-13T14:00:58.323

让我描述一下我如何处理我的 C++/WTL 应用程序中的崩溃。

首先，在主函数中，我调用[_set_se_translator](http://msdn.microsoft.com/en-us/library/5z4bw5h5(VS.80).aspx)，并传入一个将抛出 C++ 异常而不是使用结构化 Windows 异常的函数。此函数获取一个错误代码，您可以通过[FormatMessage](http://msdn.microsoft.com/en-us/library/ms679351.aspx)获取一个 Windows 错误消息，以及一个 PEXCEPTION_POINTERS 参数，您可以使用它来编写一个小型转储（[代码here](http://msdn.microsoft.com/en-us/library/bb204861(VS.85).aspx)）。您还可以检查某些“崩溃”错误的异常代码，例如 EXCEPTION_NONCONTINUABLE_EXCEPTION 或 EXCEPTION_STACK_OVERFLOW :)

minidump 文件本身可以像普通项目一样在 Visual Studio 中打开，并且如果您为可执行文件创建了一个 .pdb 文件，您可以运行该项目，它会跳转到崩溃的确切位置，以及调用堆栈和寄存器，可以从调试器中检查。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-12T08:24:26.603

如果您想获取运行时崩溃的调用堆栈（以及其他有用的信息），甚至在现场发布版本，那么您需要设置[Dr Watson](http://support.microsoft.com/kb/308538)（运行 DrWtsn32.exe）。如果您选中“生成故障转储”选项，当应用程序崩溃时，它会将一个小型转储文件写入指定的路径（称为 user.dmp）。

您可以使用它，将它与您在构建服务器时创建的符号结合起来（在编译器/链接器中设置它以生成 pdb 文件 - 将这些安全地放在家里，您可以使用它们来匹配转储，以便他们可以计算出源代码发生事故的地方）

获取自己[的 windbg](http://www.microsoft.com/whdc/devtools/debugging/)，打开它并使用菜单选项“加载故障转储”。加载完所有内容后，您可以键入“~#kp”以获取每个线程的调用堆栈（或单击当前线程顶部的按钮）。

网上有很多关于如何做到这一点的好文章，[这](http://www.debuginfo.com/articles/easywindbg.html)是我最喜欢的一篇，你会想[阅读这篇](http://msdn.microsoft.com/en-gb/magazine/cc301459.aspx)文章以了解如何帮助自己真正轻松地管理符号。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-13T11:47:27.417

[您必须在](https://stackoverflow.com/questions/696580/getting-a-dump-of-a-process-that-crashes-on-startup/700108#700108)应用程序中设置转储生成框架，您可以这样做。

然后，您可以将转储文件上传到服务器，以便使用 windbg 等转储分析器进行进一步分析。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-05-27T10:30:31.077

您可能想使用 adplus 来捕获崩溃调用堆栈。

您可以下载并安装适用于 Windows 的调试工具。

这里提到了adplus的用法： [Adplus用法](http://support.microsoft.com/kb/286350)

这会创建完整的崩溃或挂起转储。一旦你有了转储，Windbg 就会来救援。映射正确的 pdb 和符号，您就可以开始分析转储了。首先使用命令“！分析 -v”

# php - PHP：将城市、州、国家/地区字符串转换为正确的标题大小写

> ID：850620
> 
> 赞同：1
> 
> 时间：2009-05-12T00:13:49.977
> 
> 标签：php, string

我有城市、州、国家/地区字符串，例如：

```
NEW YORK, NY, US
REDMOND, WA, US
US
HONG KONG
CALGARY, CA
E. SYRACUSE, NY, US 
```

我想将它们转换为适当的情况（纽约、纽约、美国等）。什么是在 PHP 中执行此操作的快速方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T00:25:37.883

```
$locs = array(
  'NEW YORK, NY, US',
  'REDMOND, WA, US',
  'US',
  'HONG KONG',
  'CALGARY, CA',
  'E. SYRACUSE, NY, US',
);
foreach ($locs as &$loc) {
  $items = explode(',', $loc);
  if (strlen($items[0]) > 2) {
    $items[0] = ucwords($items[0]);
  }
  $loc = implode(',', $items);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T00:17:24.450

你所说的“适当的情况”是什么意思？我有一种感觉，就您确切需要的内容而言，我遗漏了一些东西，所以如果您能准确说明这些数据是什么以及您希望如何处理它，那就太好了。

您可以使用[`ucfirst`](http://www.php.net/ucfirst)将每个单词的第一个字母变成大写，并且可以使用[`explode`](http://www.php.net/explode)将字符串分隔为相应的段：

```
$str = "NEW YORK, NY, US";
list($city, $state, $country) = explode(',', $str);
$city = ucfirst(strtolower($city)); 
```

在您提供的示例中，您不需要对州和国家/地区做任何事情，尽管[`strtoupper`](http://www.php.net/strtoupper)如果您想保证它们是大写的。

然而，这是一个棘手的命题，因为我确信在某些情况下，它给出的任何输出都可能不是编写特定城市的“正确”方式，尽管我想不出任何例子我确信有一些。

我还注意到有几行只有一个国家（“US”）和一些只有一个城市（“HONG KONG”）——没有可靠的方法来确定字符串包含的内容。您可以尝试将其与国家和城市列表等相匹配，但似乎您想出的任何解决方案充其量只是一场猜谜游戏。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T00:35:16.743

没有字典总会有一些边缘情况，所以我认为这种方法是最好的

```
vinko@parrot:~$ cat cap.php
<?php

$list = "NEW YORK, NY, US
REDMOND, WA, US
US
HONG KONG
CALGARY, CA
E. SYRACUSE, NY, US";

$countries = array("HONG KONG", "US", "CA");
$states = array("NY","WA");

$list = split("\n",$list);

$out = "";
foreach ($list as $line) {
        list($first,$second,$third) = split(",",$line);

        //Here you check in a dictionary for country/state to
        //like this:

        if (!in_array($first,$countries) && !in_array($first,$states)) {
                $first = ucwords(strtolower($first));
        }
        if ($third) { $out.= $first.",".$second.",".$third; }
        else if ($second && !$third) { $out.= $first.",".$second; }
        else { $out.= $first; }
        $out.= "\n";
}
echo $out;
?> 
```

```
vinko@parrot:~$ php cap.php
美国纽约州纽约市
美国华盛顿州雷德蒙德
我们
香港
加利福尼亚州卡尔加里
E. 美国纽约州锡拉丘兹

```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-17T03:36:26.680

```
function title_case($val) {
    return mb_convert_case($val[0], MB_CASE_TITLE, "UTF-8");
}

$locs = array(
  'NEW YORK, NY, US',
  'REDMOND, WA, US',
  'US',
  'HONG KONG',
  'CALGARY, CA',
  'E. SYRACUSE, NY, US',
);
foreach ($locs as &$loc) {
  $loc = preg_replace_callback( '/\b\w{3,}\b/', "title_case", $loc);
}
print_r($locs);

// Array
// (
//     [0] => New York, NY, US
//     [1] => Redmond, WA, US
//     [2] => US
//     [3] => Hong Kong
//     [4] => Calgary, CA
//     [5] => E. Syracuse, NY, US
// ) 
```

# wpf - 如何使 WPF DatePicker 控件看起来像它的 WinForms 表亲？

> ID：850624
> 
> 赞同：2
> 
> 时间：2009-05-12T00:15:20.397
> 
> 标签：wpf, controls, datepicker

我下载并安装了 WPF 工具包（它提供了 VS2008 无法及时发布的控件）。

但是，DatePicker 控件看起来不像它的 WinForms 表亲。
[替代文字 http://www.angryhacker.com/toys/datepicker.png](http://www.angryhacker.com/toys/datepicker.png)

首先，下拉按钮不是下拉菜单，而是日历的小图。其次，日历在控件的右侧而不是在其下方打开。如何使控件看起来像普通的日期选择器？还是我应该使用其他东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-12-30T11:03:07.340

如果有的话，您还可以使用 Expression Blend 提取默认控件模板。只需在新项目中创建 DatePicker 的实例，然后选择它 - 在“对象”菜单中应该有编辑控件样式和模板的选项，包括编辑现有模板副本的选项。

修改模板后，只需将其粘贴到资源字典中并从您的 xaml 中引用它。我这样做是因为我想为 DatePicker、GridView 和 ListBox 控件创建自定义模板。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-17T18:33:34.550

您可以从 CodePlex 下载源代码并从 generic.xaml 中检索当前的 ControlTemplate。然后，您可以将其复制到您的应用程序资源中并从那里修改控制模板。

与重新定义 .NET 3.5 附带的控件的 ControlTemplates 没有什么不同，它们也是二进制的。我今天才真正做到这一点，很抱歉包含一大堆 XAML，但这是我将“15”按钮重新设置为更“网格”日历外观的方法。您要么必须将其放入 App.Xaml 中，要么将其作为合并字典包含在内。

```
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:local="clr-namespace:Microsoft.Windows.Controls;assembly=WPFToolkit"
xmlns:primitives="clr-namespace:Microsoft.Windows.Controls.Primitives;assembly=WPFToolkit"
xmlns:vsm="clr-namespace:System.Windows;assembly=WPFToolkit">

<Style TargetType="{x:Type local:DatePicker}">
    <Setter Property="Foreground" Value="#FF333333" />
    <Setter Property="IsTodayHighlighted" Value="True" />
    <Setter Property="SelectedDateFormat" Value="Short" />
    <Setter Property="Background" Value="Transparent" />
    <Setter Property="Padding" Value="2"/>
    <Setter Property="BorderBrush">
        <Setter.Value>
            <LinearGradientBrush EndPoint=".5,0" StartPoint=".5,1">
                <GradientStop Color="#FFA3AEB9" Offset="0"/>
                <GradientStop Color="#FF8399A9" Offset="0.375"/>
                <GradientStop Color="#FF718597" Offset="0.375"/>
                <GradientStop Color="#FF617584" Offset="1"/>
            </LinearGradientBrush>
        </Setter.Value>
    </Setter>
    <Setter Property="BorderThickness" Value="1" />
    <Setter Property="HorizontalContentAlignment" Value="Stretch" />
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type local:DatePicker}">
                <Border BorderBrush="{TemplateBinding BorderBrush}" 
                        BorderThickness="{TemplateBinding BorderThickness}"
                        Background="{TemplateBinding Background}" 
                        Padding="{TemplateBinding Padding}">

                    <vsm:VisualStateManager.VisualStateGroups>
                        <vsm:VisualStateGroup x:Name="CommonStates">
                            <vsm:VisualState x:Name="Normal" />
                            <vsm:VisualState x:Name="Disabled">
                                <Storyboard>
                                    <DoubleAnimation Storyboard.TargetName="PART_DisabledVisual" Storyboard.TargetProperty="Opacity" To="1" Duration="0" />
                                </Storyboard>
                            </vsm:VisualState>
                        </vsm:VisualStateGroup>
                    </vsm:VisualStateManager.VisualStateGroups>
                    <Border.Child>
                        <Grid x:Name="PART_Root"
                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" 
                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}">
                            <Grid.Resources>
                                <!-- Main DatePicker Brushes -->
                                <SolidColorBrush x:Key="DisabledBrush" Color="#A5FFFFFF" />

                                <!-- Button Template -->
                                <ControlTemplate x:Key="DropDownButtonTemplate" TargetType="Button">
                                    <Grid>
                                        <vsm:VisualStateManager.VisualStateGroups>
                                            <vsm:VisualStateGroup x:Name="CommonStates">
                                                <vsm:VisualStateGroup.Transitions>
                                                    <vsm:VisualTransition GeneratedDuration="0" />
                                                    <vsm:VisualTransition To="MouseOver" GeneratedDuration="0:0:0.1" />
                                                    <vsm:VisualTransition To="Pressed" GeneratedDuration="0:0:0.1" />
                                                </vsm:VisualStateGroup.Transitions>
                                                <vsm:VisualState x:Name="Normal" />
                                                <vsm:VisualState x:Name="MouseOver">
                                                    <Storyboard>
                                                        <ColorAnimation Duration="0" Storyboard.TargetName="Background" Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)" To="#FF448DCA"/>
                                                        <ColorAnimationUsingKeyFrames BeginTime="0" Duration="00:00:00.001" Storyboard.TargetName="BackgroundGradient" Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[3].(GradientStop.Color)">
                                                            <SplineColorKeyFrame KeyTime="0" Value="#7FFFFFFF"/>
                                                        </ColorAnimationUsingKeyFrames>
                                                        <ColorAnimationUsingKeyFrames BeginTime="0" Duration="00:00:00.001" Storyboard.TargetName="BackgroundGradient" Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[2].(GradientStop.Color)">
                                                            <SplineColorKeyFrame KeyTime="0" Value="#CCFFFFFF"/>
                                                        </ColorAnimationUsingKeyFrames>
                                                        <ColorAnimationUsingKeyFrames BeginTime="0" Duration="00:00:00.001" Storyboard.TargetName="BackgroundGradient" Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[1].(GradientStop.Color)">
                                                            <SplineColorKeyFrame KeyTime="0" Value="#F2FFFFFF"/>
                                                        </ColorAnimationUsingKeyFrames>
                                                    </Storyboard>
                                                </vsm:VisualState>
                                                <vsm:VisualState x:Name="Pressed">
                                                    <Storyboard>
                                                        <ColorAnimationUsingKeyFrames BeginTime="0" Duration="00:00:00.001" Storyboard.TargetName="Background" Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)">
                                                            <SplineColorKeyFrame KeyTime="0" Value="#FF448DCA"/>
                                                        </ColorAnimationUsingKeyFrames>
                                                        <DoubleAnimationUsingKeyFrames BeginTime="0" Duration="00:00:00.001" Storyboard.TargetName="Highlight" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                            <SplineDoubleKeyFrame KeyTime="0" Value="1"/>
                                                        </DoubleAnimationUsingKeyFrames>
                                                        <ColorAnimationUsingKeyFrames BeginTime="0" Duration="00:00:00.001" Storyboard.TargetName="BackgroundGradient" Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[1].(GradientStop.Color)">
                                                            <SplineColorKeyFrame KeyTime="0" Value="#EAFFFFFF"/>
                                                        </ColorAnimationUsingKeyFrames>
                                                        <ColorAnimationUsingKeyFrames BeginTime="0" Duration="00:00:00.001" Storyboard.TargetName="BackgroundGradient" Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[2].(GradientStop.Color)">
                                                            <SplineColorKeyFrame KeyTime="0" Value="#C6FFFFFF"/>
                                                        </ColorAnimationUsingKeyFrames>
                                                        <ColorAnimationUsingKeyFrames BeginTime="0" Duration="00:00:00.001" Storyboard.TargetName="BackgroundGradient" Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[3].(GradientStop.Color)">
                                                            <SplineColorKeyFrame KeyTime="0" Value="#6BFFFFFF"/>
                                                        </ColorAnimationUsingKeyFrames>
                                                        <ColorAnimationUsingKeyFrames BeginTime="0" Duration="00:00:00.001" Storyboard.TargetName="BackgroundGradient" Storyboard.TargetProperty="(Border.Background).(GradientBrush.GradientStops)[0].(GradientStop.Color)">
                                                            <SplineColorKeyFrame KeyTime="0" Value="#F4FFFFFF"/>
                                                        </ColorAnimationUsingKeyFrames>
                                                    </Storyboard>
                                                </vsm:VisualState>
                                                <vsm:VisualState x:Name="Disabled" />
                                            </vsm:VisualStateGroup>
                                        </vsm:VisualStateManager.VisualStateGroups>

                                        <!--Start UI-->
                                        <Grid Height="18" Width="19" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0" Background="#11FFFFFF" FlowDirection="LeftToRight">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="20*"/>
                                                <ColumnDefinition Width="20*"/>
                                                <ColumnDefinition Width="20*"/>
                                                <ColumnDefinition Width="20*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="23*"/>
                                                <RowDefinition Height="19*"/>
                                                <RowDefinition Height="19*"/>
                                                <RowDefinition Height="19*"/>
                                            </Grid.RowDefinitions>
                                            <Border Margin="-1" Grid.ColumnSpan="4" Grid.Row="0" Grid.RowSpan="4" BorderThickness="1" BorderBrush="#FF45D6FA" Opacity="0" CornerRadius="0,0,1,1" x:Name="Highlight"/>
                                            <Border x:Name="Background" Margin="0,-1,0,0" Grid.ColumnSpan="4" Grid.Row="1" Grid.RowSpan="3" BorderThickness="1" BorderBrush="#FFFFFFFF" Opacity="1" CornerRadius=".5" Background="#FF1F3B53"/>
                                            <Border x:Name="BackgroundGradient" Margin="0,-1,0,0" Grid.ColumnSpan="4" Grid.Row="1" Grid.RowSpan="3" BorderThickness="1" BorderBrush="#BF000000" Opacity="1" CornerRadius=".5">
                                                <Border.Background>
                                                    <LinearGradientBrush StartPoint=".7,0" EndPoint=".7,1">
                                                        <GradientStop Color="#FFFFFFFF" Offset="0" />
                                                        <GradientStop Color="#F9FFFFFF" Offset="0.375" />
                                                        <GradientStop Color="#E5FFFFFF" Offset="0.625" />
                                                        <GradientStop Color="#C6FFFFFF" Offset="1" />
                                                    </LinearGradientBrush>
                                                </Border.Background>
                                            </Border>
                                            <Rectangle Grid.ColumnSpan="4" Grid.RowSpan="1" StrokeThickness="1">
                                                <Rectangle.Stroke>
                                                    <LinearGradientBrush EndPoint="0.48,-1" StartPoint="0.48,1.25">
                                                        <GradientStop Color="#FF494949"/>
                                                        <GradientStop Color="#FF9F9F9F" Offset="1"/>
                                                    </LinearGradientBrush>
                                                </Rectangle.Stroke>
                                                <Rectangle.Fill>
                                                    <LinearGradientBrush EndPoint="0.3,-1.1" StartPoint="0.46,1.6">
                                                        <GradientStop Color="#FF4084BD"/>
                                                        <GradientStop Color="#FFAFCFEA" Offset="1"/>
                                                    </LinearGradientBrush>
                                                </Rectangle.Fill>
                                            </Rectangle>
                                            <Canvas Grid.Column="0" Grid.ColumnSpan="4" Grid.Row="1" Grid.RowSpan="3">
                                                <Line StrokeThickness="1" X1="5" X2="5"  Y1="0" Y2="13" Stroke="Black" RenderTransformOrigin="0.5,0.5" />
                                                <Line StrokeThickness="1" X1="10" X2="10"  Y1="0" Y2="13" Stroke="Black" RenderTransformOrigin="0.5,0.5" />
                                                <Line StrokeThickness="1" X1="15" X2="15"  Y1="0" Y2="13" Stroke="Black" RenderTransformOrigin="0.5,0.5" />
                                                <Line StrokeThickness="1" X1="0" X2="18"  Y1="3" Y2="3" Stroke="Black" RenderTransformOrigin="0.5,0.5" />
                                                <Line StrokeThickness="1" X1="0" X2="18"  Y1="8" Y2="8" Stroke="Black" RenderTransformOrigin="0.5,0.5" />
                                            </Canvas>

                                            <Ellipse HorizontalAlignment="Center" VerticalAlignment="Center" Fill="#FFFFFFFF" StrokeThickness="0" Grid.ColumnSpan="4" Width="3" Height="3"/>
                                            <Border Grid.ColumnSpan="4" Grid.Row="0" Grid.RowSpan="4" BorderThickness="1" BorderBrush="#B2FFFFFF" Opacity="0" CornerRadius="0,0,.5,.5" x:Name="DisabledVisual"/>
                                        </Grid>
                                        <!--End UI-->
                                    </Grid>
                                </ControlTemplate>
                            </Grid.Resources>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <Button x:Name="PART_Button" Grid.Row="0" Grid.Column="1"
                                    Template="{StaticResource DropDownButtonTemplate}"
                                    Foreground="{TemplateBinding Foreground}" 
                                    Width="20"
                                    Margin="3,0,3,0" 
                                    Focusable="False" 
                                    VerticalAlignment="Top"
                                    HorizontalAlignment="Left" />
                            <primitives:DatePickerTextBox x:Name="PART_TextBox" 
                                Grid.Row="0" Grid.Column="0" 
                                Foreground="{TemplateBinding Foreground}" 
                                HorizontalContentAlignment="Stretch"
                                VerticalContentAlignment="Stretch" />
                            <Grid x:Name="PART_DisabledVisual" 
                                  Opacity="0" 
                                  IsHitTestVisible="False" 
                                  Grid.Row="0" Grid.Column="0"
                                  Grid.ColumnSpan="2">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Rectangle Grid.Row="0" Grid.Column="0" RadiusX="1" RadiusY="1" Fill="#A5FFFFFF"/>
                                <Rectangle Grid.Row="0" Grid.Column="1" RadiusX="1" RadiusY="1" Fill="#A5FFFFFF" Height="18" Width="19" Margin="3,0,3,0" />
                                <Popup x:Name="PART_Popup" 
                                       PlacementTarget="{Binding ElementName=PART_Button}"
                                       Placement="Bottom" 
                                       StaysOpen="False"
                                       AllowsTransparency="True" />
                            </Grid>
                        </Grid>
                    </Border.Child>
                </Border>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

# c++ - c++ char数组是否超出范围？

> ID：850626
> 
> 赞同：1
> 
> 时间：2009-05-12T00:15:46.603
> 
> 标签：c++, string, memory-management, stl

我有一个方法需要一个`const char`指针作为输入（不是空终止）。这是我在项目中使用的库 (TinyXML) 的要求。`string.c_str()`我从方法调用中获取此方法的输入。

这个`char`指针需要删除吗？调用完成后字符串立即超出范围；所以字符串应该用它的析构函数来删除它，对吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-12T00:17:42.640

不要删除从 std::string::c_str 获得的内存。字符串对此负责（它完全有可能给你一个指向其内部缓冲区的指针，所以如果你删除它，那将是一件坏事（tm））。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-12T00:17:08.380

返回的 char 数组以`string.c_str()`null 结尾。~~如果 tinyXML 的函数采用非空终止的 char* 缓冲区，那么您可能会得到一些意想不到的行为。~~

> `const char* c_str ( ) const;`
> 
> 获取等效的 C 字符串
> 
> 生成与字符串对象具有相同内容的以空字符结尾的字符序列（c-string），并将其作为指向字符数组的指针返回。
> 
> 自动附加终止空字符。

不，它不需要被释放。String 的析构函数会为你做这件事。

> 返回的数组指向一个内部位置，该位置具有此字符序列所需的存储空间加上其终止的空字符，但此数组中的值不应在程序中修改，并且仅允许保持不变，直到下一次调用字符串对象的非常量成员函数。

[来源](http://www.cplusplus.com/reference/string/string/c_str/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-12T01:23:39.690

另一方面，
如果您不需要 char 指针以空终止，那么您最好使用 used`str.data()`而不是`str.c_str()`. 不同之处在于`.data()`，您所获得的内容不会被授予 null 终止。如果您的字符串恰好占据了由`string`. 在这种情况下，调用`.c_str()`将强制`string`将日期重新分配给一个新的更大的缓冲区，这些缓冲区包含足够的空间来添加`'\0'`最后。

无论如何，您当然不应该删除返回的指针。`string`会处理的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T01:36:14.460

`std::string.c_str()`返回一个指向空终止字符串的指针。实际的字符数组仍归`std::string`对象所有，只要：

1.  该`std::string`对象是有效的，并且
2.  不调用`std::string`对象上的非常量成员函数（即修改字符串会使任何先前指向的 C 样式字符串无效）。

由字符串对象本身来分配和释放它返回给您的空字符数组。

You can always use a null-terminated string as a non-null-terminated string. After all, an NTS is just a non-NTS with an extra zero at the end. As long as the string is correctly terminated as the function expects, it'll never see the "extra" null.

# python - Python *.py、*.pyo、*.pyc：嵌入式系统可以消除哪些？

> ID：850630
> 
> 赞同：12
> 
> 时间：2009-05-12T00:18:59.983
> 
> 标签：python, embedded

为了挤入我目前正在使用的嵌入式系统中可用的有限文件系统存储量，我想消除任何可以合理删除而不会显着影响功能或性能的文件。Python 库中的 *​​.py、*.pyo 和 *.pyc 文件占了相当大的空间，我想知道这些选项中的哪一个对于在小型嵌入式系统中安装 Python 2.6 最合理：

1.  保留 *.py，消除 *.pyc 和 *.pyo（保持调试能力，性能受损？）
2.  保留*.py 和*.pyc，去掉*.pyo（优化真的能买到什么吗？）
3.  保留 *.pyc，消除 *.pyo 和 *.py（这行得通吗？）
4.  保留 *.py、*.pyc 和 *.pyo（都需要？）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-12T00:27:43.183

[http://www.network-theory.co.uk/docs/pytut/CompiledPythonfiles.html](http://www.network-theory.co.uk/docs/pytut/CompiledPythonfiles.html)

> 当使用 -O 标志调用 Python 解释器时，会生成优化代码并将其存储在“.pyo”文件中。优化器目前没有多大帮助；它只删除断言语句。
> 
> 将两个 -O 标志传递给 Python 解释器 (-OO) 将导致字节码编译器执行优化，在极少数情况下可能会导致程序出现故障。目前只从字节码中删除**doc字符串，从而生成更紧凑的“.pyo”文件。**

我给你的建议？

如果不需要断言语句和 __doc__ 字符串，请使用 -OO 仅编译**.pyo文件。**

否则，仅使用**.pyc**。

**编辑**

我注意到你只提到了 Python 库。如果您只需要部分功能，则可以删除大部分 python 库。

我还建议您看一下[tinypy](http://www.tinypy.org/)，它是 Python 的大子集，大小约为 64kb。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T00:25:38.693

3 号应该并且将会起作用。您不需要 .pyo 或 .py 文件即可使用已编译的 Python 代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T04:54:30.923

我建议只保留 .py 文件。启动时间的差异不是很大，并且有源代码是一个加号，因为它可以在不同的 python 版本下运行而没有任何问题。

从 python 2.6 开始，将 sys.dont_write_bytecode 设置为 True 将完全禁止编译 .pyc 和 .pyo 文件，因此如果您有 2.6 可用，您可能希望使用该选项。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-09-03T12:20:01.020

以下是我在日常工作中最小化主线 Python 2.7 的磁盘需求的方法：

1）从您不需要的标准库中删除包。以下为保守名单：

```
bsddb/test ctypes/test distutils/tests email/test idlelib lib-tk
lib2to3 pydoc.py tabnanny.py test unittest 
```

请注意，某些 Python 代码可能具有令人惊讶的依赖关系；例如`setuptools`需要`unittest`运行。

2) 预编译所有 Python 代码，使用 -OO 去除断言和文档字符串。

```
find -name '*.py' | python -OO -m py_compile - 
```

请注意，默认情况下 Python 不查看`.pyo`文件。您还必须使用选项或环境变量在运行时明确要求优化。以下列方式之一运行脚本：

```
python -OO -m mylib.myscript
PYTHONOPTIMIZE=2 python -m mylib.myscript 
```

3) 删除`.py`源代码文件（除非您需要将它们作为脚本运行）和`.pyc`未优化的文件。

```
find '(' -name '*.py' -or -name '*.pyc' ')' -and -not -executable -execdir rm '{}' ';' 
```

4) 压缩 Python 库文件。Python 可以从 zip 文件中加载模块。zip 文件中的路径必须与包层次结构匹配；因此，您应该在压缩之前将`site-packages`和`.egg`目录合并到主库目录中。（或者您可以将多个 zip 文件添加到 Python 路径。）

在 Linux 上，Python 的默认路径`/usr/lib/python27.zip`已经包含，所以只需将 zip 文件放在那里，你就可以开始了。

保留`os.pyo`为普通（非压缩）文件，因为 Python 会将此作为健全性检查。如果将其移动到 zip 文件中，每次 Python 调用都会收到警告（尽管一切仍然有效）。或者您可以在此处留下一个空`os.py`文件，然后将真实文件放入 zip 文件中。

最后注意事项：

*   以这种方式，Python 适合 7 MB 的磁盘空间。可以做更多的事情来减小大小，但 7 MB 对于我的目的来说已经足够小了。:)
*   Python 字节码在不同版本之间不兼容，但谁在乎何时是您进行编译而您控制 Python 版本？
*   `.pyo`zip 文件中的文件在所有情况下都应该是性能上的胜利，除非磁盘非常快并且处理器/RAM 非常慢。无论哪种方式，Python 都是从内存中执行的，而不是磁盘格式，因此它只会影响加载时的性能。虽然剥离文档字符串可以节省相当多的内存。
*   请注意，`.pyo`文件不包含`assert`语句。
*   `.pyo`文件保留函数名称和行号，因此可调试性不会降低：您仍然可以获得很好的回溯，您只需手动查找源代码中的行号，无论如何您都必须这样做。
*   如果您想在运行时“破解”文件，只需将其放在当前工作目录中即可。它优先于库 zip 文件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-12T00:50:04.177

它最终归结为你真的只需要三个选项之一，但你最好的选择是使用 .pys 和 .pyos 或 .pycs。

以下是我如何看待您的每个选项：

1.  如果您将 .pys 放入 zip 文件中，您将看不到 pycs 或 pyos 已构建。还应该指出的是，性能差异仅在于启动时间，即使那样，根据我的经验也不是太大（尽管您的里程可能会有所不同）。[另请注意，正如Algorias](https://stackoverflow.com/questions/850630/python-py-pyo-pyc-which-can-be-eliminated-for-an-embedded-system/851194#851194)指出的那样，有一种方法可以防止解释器输出 .pycs 。
2.  我认为这是一个理想的选择（无论是那个还是 .pys 和 .pyos），因为您可以获得性能、可调试性和可靠性的最佳组合。不过，您不一定*需要*源文件和编译文件。
3.  如果您真的空间有限并且需要性能，这将起作用。如果可能的话，我建议你保留 .pys。编译的二进制文件（.pycs 或 .pyos）并不总是转移到不同版本的 python。
4.  除非您计划有时以优化模式运行，有时以非优化模式运行，否则您是否需要全部三个是值得怀疑的。

就空间而言，如果将 .py 文件放在 zip 文件中，与 .pycs 和 .pyos 相比，我的（非常有趣的）经验是压缩得最好。如果您打算压缩文件，.pyos 不会在纯粹的空间方面获得很多，因为文档字符串往往压缩得相当好，并且断言不会占用那么多空间。

# .net - 您正在使用哪种持续集成工具？

> ID：850631
> 
> 赞同：5
> 
> 时间：2009-05-12T00:19:24.930
> 
> 标签：.net, tfs, continuous-integration, cruisecontrol.net, teamcity

### 复制：

> *   [持续集成](https://stackoverflow.com/questions/51925/continuous-integration)
> *   [巡航控制 .NET 替代品？](https://stackoverflow.com/questions/647621/cruise-control-net-alternatives)

* * *

我计划在我工作的地方开始持续集成。我曾经在我以前的工作场所和 CruiseControl.Net 之前使用过 TFS，在此之前我们编写了自己的 CI 服务器。

我想知道其他人正在使用什么工具，为什么？

我主要关心windows/.Net环境......

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-12T00:21:39.730

Hudson 很棒 - 比 CruiseControl.NET 更容易设置，并且还可以生成漂亮的图表。

TeamCity 也很容易设置。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-12T13:35:19.627

我会看一下 CI 特征矩阵，实际上有几十种工具，每一种都有自己的优势。我自己，我是 AnthillPro 的人。

[CI 特征矩阵](http://confluence.public.thoughtworks.org/display/CC/CI+Feature+Matrix)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-12T00:22:12.210

我们将 CruiseControl.NET 用于 .NET 环境。我喜欢用于跟踪构建状态的 CC Tray 应用程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T09:46:45.453

我们曾经有两个 Cruise Control.net 服务器，它们之间运行大约 20 个左右的构建。我们已经开始将它们全部转移到单个虚拟化 TeamCity 服务器上，并且我们正忙于添加更多（虚拟）构建代理以减少构建时间并减少排队构建。

我真的很喜欢 TeamCity 的简单性和用户界面。在我们节省了配置它的时间里，它很容易支付许可证费用。它还允许在不同的代理上轻松扩展构建，并将一个构建的输出馈送到其他构建的输入。

我们确实看过 Hudson 和 Cruse，但很难通过阅读手册和使用简单的测试构建来确定哪个最好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-12T08:24:21.283

我们使用 CruiseControl.net 和一些自定义 Ruby 脚本，在每次构建结束时执行更广泛和自定义的行为。

目前这些都是基于 CC.Net 的 1.3 版本，但随着 1.4 的出现，可以使用基本系统和任何挂在它上面的东西来做更多的事情。

我写[了几篇关于我们的 CI 流程的博](http://www.spreetree.net/blog/?cat=21)文，可能很有趣。

# c# - 将两个可观察的集合组合到一个列表框？

> ID：850632
> 
> 赞同：2
> 
> 时间：2009-05-12T00:20:56.363
> 
> 标签：c#, wpf, data-binding, observablecollection

我有两个可观察的集合都设置为一类属性。我需要将这两个集合合并到一个列表框中。我查看了 Compositecollection 类，但这不是我需要的。理想情况下，我希望列表框看起来像这样......

将此视为一个列表框控件，每个列表框项都包含来自两个可观察集合的源属性的对象。

```
Collection1 Collection1
--------------------------
Data          Data
--------------------------
Data          Data
--------------------------
Data          Data
--------------------------
Data          Data
--------------------------
Data          Data
-------------------------- 
```

我只是想知道是否真的可以做这样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T03:07:38.477

好吧，如果我没看错你的问题，

您可以创建另一个集合（例如 List），其中每个元素都是由 Collection1 和 Collection2 的每个元素组成的匿名类型（或类型取决于您想要的 DisplayMember 和 ValueMember）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T01:01:47.060

如果我理解正确，那么没有。ListBox 只能绑定到一个源。您可以做的是将两个集合合并为一个，然后使用多重绑定在每一行上显示两组数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T08:31:05.033

如果我正确理解了您的问题，您应该可以通过使用 Linq Join 来做到这一点

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T09:28:07.380

您可以使用 MultiBinding 并定义一个将两个（或多个）集合合并为一个的转换器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-18T20:46:31.273

CompositeCollection/CollectionContainer - 他们是你的朋友

# asp.net-mvc - 用于开发基于小部件的门户的 ASP.NET MVC

> ID：850636
> 
> 赞同：1
> 
> 时间：2009-05-12T00:23:00.757
> 
> 标签：asp.net-mvc, widget, portal

[ASP.NET MVC对开发](http://en.wikipedia.org/wiki/ASP.NET_MVC_Framework)[http://www.google.com/ig](http://www.google.com/ig)之类的东西 有多合适？

我还没有看到或找不到任何例子。MVC 方法是否暗示用户界面不应该看起来像那样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-10-09T17:32:09.930

查看[http://aspspider.info/lakkakula/local.aspx](http://aspspider.info/lakkakula/local.aspx)，它是使用 Asp.Net MVC 1.0、Microsoft Ajax 客户端模板和 jQuery 开发的 Web 2.0 门户，具有拖放小部件个性化功能，类似于 google.com/ig。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T10:34:35.380

MVC 非常适合这样的 UI。您的主控制器可以使用用户定义的小部件列表进行渲染，或者可以使用对返回 JsonResult 的方法的 ajax 调用......这可以为相应控件的每个部分 vie 生成包装器客户端调用。我认为 MVC 会简化很多事情。

MVC + jQueryUI 将是你所需要的一切......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T00:40:57.437

我想再澄清一点，“合适”到底是什么意思？

一种方法可能是让每个可用的“widgit”成为一个控制器，然后您可以使用 jQuery（或任何您想要的）来调用指定的方法并进行渲染。然后该页面将有一系列针对用户的“列表”（您可以将其存储在数据库中），您可以简单地订购这些列表以以正确的顺序显示相关的小部件。

显然，这是一个非常大的简化......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-26T12:05:09.523

*[请参阅使用 ASP.NET MVC、Microsoft Ajax 客户端模板和带有拖放小部件个性化的 jQuery 开发 Web 2.0 门户](http://lakkakula.wordpress.com/2009/06/18/developing-web-2-0-portal-using-asp-net-mvc-microsoft-ajax-client-templates-and-jquery-with-drag-and-drop-widget-personalization-part-1/)*教程。

# c# - LINQ to SQL 未映射的属性

> ID：850637
> 
> 赞同：2
> 
> 时间：2009-05-12T00:23:32.880
> 
> 标签：c#, linq-to-sql

是否可以在设计器中添加自定义属性并且不绑定到列？我摆弄了一些设置，决定用该属性创建一个部分类。有没有办法在 ORM 设计器中显示这个字段？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T04:01:22.540

LINQ-to-SQL 设计器正在维护映射。未映射的属性需要放在单独的部分类中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T00:27:48.270

在设计器中，右键单击对象属性标题并添加 => 属性。

# svn - 使用 SVN 处理和同步开源库的自定义版本

> ID：850639
> 
> 赞同：2
> 
> 时间：2009-05-12T00:23:57.543
> 
> 标签：svn, open-source, repository

我发现了一个在我的项目中似乎非常有用的开源库。然而，该库处于 alfa/beta 状态并且有点不成熟。碰巧我不得不手动应用补丁或完全自己进行一些更改，以消除该库中的一些小错误。

问题是：**如何在我的 SVN 存储库中存储和管理我的自定义“分支”？**

**我想保留我的自定义更改（最终可能会被项目所有者签入主干）以及我希望能够将我的版本与官方主干合并（他们可能已经改进了某些东西等）。**

我已经做的是用适当的 svn:externals 属性标记一个文件夹（比如说资源）。然后我可以从官方主干“从内部”更新绑定到我的仓库的工作副本。显然我不能做的是提交更改。似乎没有什么（临时搬迁，切换，...​​）有效。我什至尝试导出到其他文件夹，然后进行更改，然后“以某种方式”合并它，但唯一的结果是一堆错误，其中大多数人抱怨 repo guids 不匹配。但也许我错过了一些细节:)。

那么有什么想法如何使用**始终保持最新的**第三方开源库并管理自己的定制？我不考虑在我的存储库中仅存储 .patch 文件作为选项；）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T23:36:14.587

虽然您无法准确地在存储库之间进行分支，但您*可以*将代码导入您自己的存储库中，然后[在存储库之间执行合并](http://blogs.open.collab.net/svn/2008/03/do-not-post-mer.html)。（链接的帖子暗示此功能存在问题，但我相信它在最新的 SVN 版本中得到完全支持。SVN 1.6.1[修复](http://subversion.tigris.org/issues/show_bug.cgi?id=3383)了与此方案相关的错误。）

SVN 书描述了一种更通用的策略，它不使用跨存储库合并。如果 3rd 方代码根本不在 SVN 存储库中，它也可以工作。请参阅[供应商分支](http://svnbook.red-bean.com/en/1.5/svn.advanced.vendorbr.html)部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T23:36:55.100

查看活塞，它可以轻松完成您想要的工作。

[http://piston.rubyforge.org/](http://piston.rubyforge.org/)

我用它来维护一个上游存储库，它工作得很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T23:45:15.553

您可以使用分布式版本控制软件代替 SVN。例如， [Git](http://whygitisbetterthanx.com/)支持将分支与 SVN 存储库同步。

# c# - 在C#中获取机器MAC地址的可靠方法

> ID：850650
> 
> 赞同：148
> 
> 时间：2009-05-12T00:29:29.047
> 
> 标签：c#, mac-address

我需要一种方法来使用 C# 获取机器的 MAC 地址，而不管它运行的是什么操作系统。

该应用程序需要在 XP/Vista/Win7 32 位和 64 位以及这些操作系统上运行，但默认为外语。此外，许多 C# 命令和操作系统查询并不适用于所有操作系统。

你有什么想法？

我一直在抓取输出，`ipconfig /all`但这非常不可靠，因为每台机器的输出格式都不同。

* * *

## 回答 #1

> 赞同：153
> 
> 时间：2011-10-05T13:12:40.560

更清洁的解决方案

```
var macAddr = 
    (
        from nic in NetworkInterface.GetAllNetworkInterfaces()
        where nic.OperationalStatus == OperationalStatus.Up
        select nic.GetPhysicalAddress().ToString()
    ).FirstOrDefault(); 
```

或者：

```
String firstMacAddress = NetworkInterface
    .GetAllNetworkInterfaces()
    .Where( nic => nic.OperationalStatus == OperationalStatus.Up && nic.NetworkInterfaceType != NetworkInterfaceType.Loopback )
    .Select( nic => nic.GetPhysicalAddress().ToString() )
    .FirstOrDefault(); 
```

* * *

## 回答 #2

> 赞同：83
> 
> 时间：2009-10-13T15:39:48.463

这是一些返回第一个可操作网络接口的 MAC 地址的 C# 代码。假设`NetworkInterface`程序集是在其他操作系统上使用的运行时（即 Mono）中实现的，那么这将在其他操作系统上工作。

**新版本：返回速度最快且 MAC 地址有效的网卡。**

```
/// <summary>
/// Finds the MAC address of the NIC with maximum speed.
/// </summary>
/// <returns>The MAC address.</returns>
private string GetMacAddress()
{
    const int MIN_MAC_ADDR_LENGTH = 12;
    string macAddress = string.Empty;
    long maxSpeed = -1;

    foreach (NetworkInterface nic in NetworkInterface.GetAllNetworkInterfaces())
    {
        log.Debug(
            "Found MAC Address: " + nic.GetPhysicalAddress() +
            " Type: " + nic.NetworkInterfaceType);

        string tempMac = nic.GetPhysicalAddress().ToString();
        if (nic.Speed > maxSpeed &&
            !string.IsNullOrEmpty(tempMac) &&
            tempMac.Length >= MIN_MAC_ADDR_LENGTH)
        {
            log.Debug("New Max Speed = " + nic.Speed + ", MAC: " + tempMac);
            maxSpeed = nic.Speed;
            macAddress = tempMac;
        }
    }

    return macAddress;
} 
```

**原始版本：只返回第一个。**

```
/// <summary>
/// Finds the MAC address of the first operation NIC found.
/// </summary>
/// <returns>The MAC address.</returns>
private string GetMacAddress()
{
    string macAddresses = string.Empty;

    foreach (NetworkInterface nic in NetworkInterface.GetAllNetworkInterfaces())
    {
        if (nic.OperationalStatus == OperationalStatus.Up)
        {
            macAddresses += nic.GetPhysicalAddress().ToString();
            break;
        }
    }

    return macAddresses;
} 
```

我唯一不喜欢这种方法的是，如果您有 Nortel Packet Miniport 或某种类型的 VPN 连接，它就有可能被选中。据我所知，没有办法将实际物理设备的 MAC 与某种类型的虚拟网络接口区分开来。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-09-11T20:49:08.520

如果您要连接的机器是 Windows 机器，WMI 是最好的解决方案，但如果您正在查看 linux、mac 或其他类型的网络适配器，那么您将需要使用其他东西。以下是一些选项：

1.  使用 DOS 命令 nbtstat -a 。创建一个进程，调用这个命令，解析输出。
2.  首先 Ping IP 以确保您的 NIC 将命令缓存在其 ARP 表中，然后使用 DOS 命令 arp -a 。像选项 1 一样解析过程的输出。
3.  在 iphlpapi.dll 中对 sendarp 使用可怕的非托管调用

这是第 3 项的示例。如果 WMI 不是可行的解决方案，这似乎是最佳选择：

```
using System.Runtime.InteropServices;
...
[DllImport("iphlpapi.dll", ExactSpelling = true)]
        public static extern int SendARP(int DestIP, int SrcIP, byte[] pMacAddr, ref uint PhyAddrLen);
...
private string GetMacUsingARP(string IPAddr)
{
    IPAddress IP = IPAddress.Parse(IPAddr);
    byte[] macAddr = new byte[6];
    uint macAddrLen = (uint)macAddr.Length;

    if (SendARP((int)IP.Address, 0, macAddr, ref macAddrLen) != 0)
        throw new Exception("ARP command failed");

    string[] str = new string[(int)macAddrLen];
    for (int i = 0; i < macAddrLen; i++)
        str[i] = macAddr[i].ToString("x2");

    return string.Join(":", str);
} 
```

为了给予应有的荣誉，这是该代码的基础： [http ://www.pinvoke.net/default.aspx/iphlpapi.sendarp#](http://www.pinvoke.net/default.aspx/iphlpapi.sendarp#)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-05-12T00:42:47.060

[Win32_NetworkAdapterConfiguration WMI 类](http://msdn.microsoft.com/en-us/library/aa394217.aspx)的*MACAddress*属性可以为您提供适配器的 MAC 地址。（系统管理命名空间）

```
MACAddress

    Data type: string
    Access type: Read-only

    Media Access Control (MAC) address of the network adapter. A MAC address is assigned by the manufacturer to uniquely identify the network adapter.

    Example: "00:80:C7:8F:6C:96" 
```

如果您不熟悉 WMI API（Windows 管理规范），这里有一个很好的 .NET 应用[概述。](http://msdn.microsoft.com/en-us/library/bb404655.aspx)

WMI 可用于具有 .Net 运行时的所有 Windows 版本。

这是一个代码示例：

```
System.Management.ManagementClass mc = default(System.Management.ManagementClass);
ManagementObject mo = default(ManagementObject);
mc = new ManagementClass("Win32_NetworkAdapterConfiguration");

ManagementObjectCollection moc = mc.GetInstances();
    foreach (var mo in moc) {
        if (mo.Item("IPEnabled") == true) {
              Adapter.Items.Add("MAC " + mo.Item("MacAddress").ToString());
         }
     } 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2018-08-13T12:02:01.060

恕我直言，返回第一个 mac 地址不是一个好主意，尤其是在托管虚拟机时。因此我检查发送/接收字节总和并选择最常用的连接，这并不完美，但应该是正确的 9/10 次。

```
public string GetDefaultMacAddress()
{
    Dictionary<string, long> macAddresses = new Dictionary<string, long>();
    foreach (NetworkInterface nic in NetworkInterface.GetAllNetworkInterfaces())
    {
        if (nic.OperationalStatus == OperationalStatus.Up)
            macAddresses[nic.GetPhysicalAddress().ToString()] = nic.GetIPStatistics().BytesSent + nic.GetIPStatistics().BytesReceived;
    }
    long maxValue = 0;
    string mac = "";
    foreach(KeyValuePair<string, long> pair in macAddresses)
    {
        if (pair.Value > maxValue)
        {
            mac = pair.Key;
            maxValue = pair.Value;
        }
    }
    return mac;
} 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2014-10-03T14:46:49.710

此方法将确定用于连接到指定 url 和端口的网络接口的 MAC 地址。

这里的所有答案都无法实现这一目标。

*我几年前（2014 年）写了这个答案。所以我决定给它一点“整容”。请查看更新部分*

```
 /// <summary>
    /// Get the MAC of the Netowrk Interface used to connect to the specified url.
    /// </summary>
    /// <param name="allowedURL">URL to connect to.</param>
    /// <param name="port">The port to use. Default is 80.</param>
    /// <returns></returns>
    private static PhysicalAddress GetCurrentMAC(string allowedURL, int port = 80)
    {
        //create tcp client
        var client = new TcpClient();

        //start connection
        client.Client.Connect(new IPEndPoint(Dns.GetHostAddresses(allowedURL)[0], port));

        //wai while connection is established
        while(!client.Connected)
        {
            Thread.Sleep(500);
        }

        //get the ip address from the connected endpoint
        var ipAddress = ((IPEndPoint)client.Client.LocalEndPoint).Address;

        //if the ip is ipv4 mapped to ipv6 then convert to ipv4
        if(ipAddress.IsIPv4MappedToIPv6)
            ipAddress = ipAddress.MapToIPv4();        

        Debug.WriteLine(ipAddress);

        //disconnect the client and free the socket
        client.Client.Disconnect(false);

        //this will dispose the client and close the connection if needed
        client.Close();

        var allNetworkInterfaces = NetworkInterface.GetAllNetworkInterfaces();

        //return early if no network interfaces found
        if(!(allNetworkInterfaces?.Length > 0))
            return null;

        foreach(var networkInterface in allNetworkInterfaces)
        {
            //get the unicast address of the network interface
            var unicastAddresses = networkInterface.GetIPProperties().UnicastAddresses;

            //skip if no unicast address found
            if(!(unicastAddresses?.Count > 0))
                continue;

            //compare the unicast addresses to see 
            //if any match the ip address used to connect over the network
            for(var i = 0; i < unicastAddresses.Count; i++)
            {
                var unicastAddress = unicastAddresses[i];

                //this is unlikely but if it is null just skip
                if(unicastAddress.Address == null)
                    continue;

                var ipAddressToCompare = unicastAddress.Address;

                Debug.WriteLine(ipAddressToCompare);

                //if the ip is ipv4 mapped to ipv6 then convert to ipv4
                if(ipAddressToCompare.IsIPv4MappedToIPv6)
                    ipAddressToCompare = ipAddressToCompare.MapToIPv4();

                Debug.WriteLine(ipAddressToCompare);

                //skip if the ip does not match
                if(!ipAddressToCompare.Equals(ipAddress))
                    continue;

                //return the mac address if the ip matches
                return networkInterface.GetPhysicalAddress();
            }

        }

        //not found so return null
        return null;
    } 
```

要调用它，您需要传递一个 URL 来连接，如下所示：

```
var mac = GetCurrentMAC("www.google.com"); 
```

您还可以指定端口号。如果未指定，默认值为 80。

**更新：**

**2020**

*   添加了注释来解释代码。
*   已更正以与使用映射到 IPV6 的 IPV4 的较新操作系统（如 windows 10）一起使用。
*   减少嵌套。
*   升级代码使用“var”。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2012-06-21T12:30:45.563

我们使用 WMI 来获取具有最低度量的接口的 mac 地址，例如，接口窗口会更喜欢使用，如下所示：

```
public static string GetMACAddress()
{
    ManagementObjectSearcher searcher = new ManagementObjectSearcher("SELECT * FROM Win32_NetworkAdapterConfiguration where IPEnabled=true");
    IEnumerable<ManagementObject> objects = searcher.Get().Cast<ManagementObject>();
    string mac = (from o in objects orderby o["IPConnectionMetric"] select o["MACAddress"].ToString()).FirstOrDefault();
    return mac;
} 
```

或者在 Silverlight 中（需要提升信任）：

```
public static string GetMACAddress()
{
    string mac = null;
    if ((Application.Current.IsRunningOutOfBrowser) && (Application.Current.HasElevatedPermissions) && (AutomationFactory.IsAvailable))
    {
        dynamic sWbemLocator = AutomationFactory.CreateObject("WbemScripting.SWBemLocator");
        dynamic sWbemServices = sWbemLocator.ConnectServer(".");
        sWbemServices.Security_.ImpersonationLevel = 3; //impersonate

        string query = "SELECT * FROM Win32_NetworkAdapterConfiguration where IPEnabled=true";
        dynamic results = sWbemServices.ExecQuery(query);

        int mtu = int.MaxValue;
        foreach (dynamic result in results)
        {
            if (result.IPConnectionMetric < mtu)
            {
                mtu = result.IPConnectionMetric;
                mac = result.MACAddress;
            }
        }
    }
    return mac;
} 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2014-01-14T14:20:31.923

```
public static PhysicalAddress GetMacAddress()
{
    var myInterfaceAddress = NetworkInterface.GetAllNetworkInterfaces()
        .Where(n => n.OperationalStatus == OperationalStatus.Up && n.NetworkInterfaceType != NetworkInterfaceType.Loopback)
        .OrderByDescending(n => n.NetworkInterfaceType == NetworkInterfaceType.Ethernet)
        .Select(n => n.GetPhysicalAddress())
        .FirstOrDefault();

    return myInterfaceAddress;
} 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-05-12T00:43:27.200

您可以使用 NIC ID：

```
 foreach (NetworkInterface nic in NetworkInterface.GetAllNetworkInterfaces()) {
     if (nic.OperationalStatus == OperationalStatus.Up){
         if (nic.Id == "yay!")
     }
 } 
```

它不是 MAC 地址，而是一个唯一标识符，如果这就是您要查找的内容。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-11-15T15:48:03.700

我真的很喜欢 AVee 的 IP 连接指标最低的解决方案！但是，如果安装了具有相同指标的第二个网卡，则 MAC 比较可能会失败......

最好将接口的描述与 MAC 一起存储。在以后的比较中，您可以通过此字符串识别正确的 nic。这是一个示例代码：

```
 public static string GetMacAndDescription()
    {
        ManagementObjectSearcher searcher = new ManagementObjectSearcher("SELECT * FROM Win32_NetworkAdapterConfiguration where IPEnabled=true");
        IEnumerable<ManagementObject> objects = searcher.Get().Cast<ManagementObject>();
        string mac = (from o in objects orderby o["IPConnectionMetric"] select o["MACAddress"].ToString()).FirstOrDefault();
        string description = (from o in objects orderby o["IPConnectionMetric"] select o["Description"].ToString()).FirstOrDefault();
        return mac + ";" + description;
    }

    public static string GetMacByDescription( string description)
    {
        ManagementObjectSearcher searcher = new ManagementObjectSearcher("SELECT * FROM Win32_NetworkAdapterConfiguration where IPEnabled=true");
        IEnumerable<ManagementObject> objects = searcher.Get().Cast<ManagementObject>();
        string mac = (from o in objects where o["Description"].ToString() == description select o["MACAddress"].ToString()).FirstOrDefault();
        return mac;
    } 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-06-04T06:00:47.437

假设我有一个使用本地 IP 192.168.0.182 的 TcpConnection。然后，如果我想知道该 NIC 的 mac 地址，我将调用方法为：`GetMacAddressUsedByIp("192.168.0.182")`

```
public static string GetMacAddressUsedByIp(string ipAddress)
    {
        var ips = new List<string>();
        string output;

        try
        {
            // Start the child process.
            Process p = new Process();
            // Redirect the output stream of the child process.
            p.StartInfo.UseShellExecute = false;

            p.StartInfo.RedirectStandardOutput = true;
            p.StartInfo.UseShellExecute = false;
            p.StartInfo.CreateNoWindow = true;
            p.StartInfo.FileName = "ipconfig";
            p.StartInfo.Arguments = "/all";
            p.Start();
            // Do not wait for the child process to exit before
            // reading to the end of its redirected stream.
            // p.WaitForExit();
            // Read the output stream first and then wait.
            output = p.StandardOutput.ReadToEnd();
            p.WaitForExit();

        }
        catch
        {
            return null;
        }

        // pattern to get all connections
        var pattern = @"(?xis) 
(?<Header>
     (\r|\n) [^\r]+ :  \r\n\r\n
)
(?<content>
    .+? (?= ( (\r\n\r\n)|($)) )
)";

        List<Match> matches = new List<Match>();

        foreach (Match m in Regex.Matches(output, pattern))
            matches.Add(m);

        var connection = matches.Select(m => new
        {
            containsIp = m.Value.Contains(ipAddress),
            containsPhysicalAddress = Regex.Match(m.Value, @"(?ix)Physical \s Address").Success,
            content = m.Value
        }).Where(x => x.containsIp && x.containsPhysicalAddress)
        .Select(m => Regex.Match(m.content, @"(?ix)  Physical \s address [^:]+ : \s* (?<Mac>[^\s]+)").Groups["Mac"].Value).FirstOrDefault();

        return connection;
    } 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2018-07-10T05:05:16.777

```
string mac = "";
foreach (NetworkInterface nic in NetworkInterface.GetAllNetworkInterfaces())
            {

                if (nic.OperationalStatus == OperationalStatus.Up && (!nic.Description.Contains("Virtual") && !nic.Description.Contains("Pseudo")))
                {
                    if (nic.GetPhysicalAddress().ToString() != "")
                    {
                        mac = nic.GetPhysicalAddress().ToString();
                    }
                }
            }
MessageBox.Show(mac); 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2016-07-04T05:01:00.533

真的很讨厌挖掘这篇旧帖子，但我觉得这个问题值得另一个特定于 Windows 8-10 的答案。

使用[Windows.Networking.Connectivity](https://msdn.microsoft.com/library/windows/apps/br207308)命名空间中的[NetworkInformation](https://msdn.microsoft.com/en-us/library/windows/apps/windows.networking.connectivity.networkinformation)，您可以获得 Windows 正在使用的网络适配器的 Id。然后可以从前面提到的GetAllNetworkInterfaces() 中获取接口MAC 地址。

这在 Windows 应用商店应用程序中不起作用，因为System.Net.NetworkInformation 中的[NetworkInterface](https://msdn.microsoft.com/en-us/library/windows/apps/system.net.networkinformation.networkinterface(v=vs.105).aspx)不公开 GetAllNetworkInterfaces。

```
string GetMacAddress()
{
    var connectionProfile = NetworkInformation.GetInternetConnectionProfile();
    if (connectionProfile == null) return "";

    var inUseId = connectionProfile.NetworkAdapter.NetworkAdapterId.ToString("B").ToUpperInvariant();
    if(string.IsNullOrWhiteSpace(inUseId)) return "";

    var mac = NetworkInterface.GetAllNetworkInterfaces()
        .Where(n => inUseId == n.Id)
        .Select(n => n.GetPhysicalAddress().GetAddressBytes().Select(b=>b.ToString("X2")))
        .Select(macBytes => string.Join(" ", macBytes))
        .FirstOrDefault();

    return mac;
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2020-01-09T08:55:28.960

```
foreach (NetworkInterface nic in NetworkInterface.GetAllNetworkInterfaces())
{
     if (nic.OperationalStatus == OperationalStatus.Up)
     {
            PhysicalAddress Mac = nic.GetPhysicalAddress();
     }
} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2017-11-24T13:03:47.677

稍微改变了 blak3r 他的代码。如果您有两个速度相同的适配器。按 MAC 排序，因此您始终获得相同的值。

```
public string GetMacAddress()
{
    const int MIN_MAC_ADDR_LENGTH = 12;
    string macAddress = string.Empty;
    Dictionary<string, long> macPlusSpeed = new Dictionary<string, long>();
    try
    {
        foreach(NetworkInterface nic in NetworkInterface.GetAllNetworkInterfaces())
        {
            System.Diagnostics.Debug.WriteLine("Found MAC Address: " + nic.GetPhysicalAddress() + " Type: " + nic.NetworkInterfaceType);

            string tempMac = nic.GetPhysicalAddress().ToString();

            if(!string.IsNullOrEmpty(tempMac) && tempMac.Length >= MIN_MAC_ADDR_LENGTH)
                macPlusSpeed.Add(tempMac, nic.Speed);
        }

        macAddress = macPlusSpeed.OrderByDescending(row => row.Value).ThenBy(row => row.Key).FirstOrDefault().Key;
    }
    catch{}

    System.Diagnostics.Debug.WriteLine("Fastest MAC address: " + macAddress);

    return macAddress;
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-05-12T00:46:39.783

`ipconfig.exe`是使用各种 DLL 实现的，包括`iphlpapi.dll`... 谷歌搜索`iphlpapi`揭示了 MSDN 中记录的相应 Win32 API。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-02-07T20:25:50.387

尝试这个：

```
 /// <summary>
    /// returns the first MAC address from where is executed 
    /// </summary>
    /// <param name="flagUpOnly">if sets returns only the nic on Up status</param>
    /// <returns></returns>
    public static string[] getOperationalMacAddresses(Boolean flagUpOnly)
    {
        string[] macAddresses = new string[NetworkInterface.GetAllNetworkInterfaces().Count()];

        int i = 0;
        foreach (NetworkInterface nic in NetworkInterface.GetAllNetworkInterfaces())
        {
            if (nic.OperationalStatus == OperationalStatus.Up || !flagUpOnly)
            {
                macAddresses[i] += ByteToHex(nic.GetPhysicalAddress().GetAddressBytes());
                //break;
                i++;
            }
        }
        return macAddresses;
    } 
```

# asp.net - 使用 web.config 中的 system.web.authorization 设置来保护经典的 asp 文件？

> ID：850651
> 
> 赞同：1
> 
> 时间：2009-05-12T00:29:31.310
> 
> 标签：asp.net, iis, asp-classic, web-config

我有一个包含大量子文件夹层次结构和数千个经典 ASP 文件的虚拟目录，所有这些文件都在 NT 文件夹级别设置了不同的权限（不要问..*摇头*）。

有没有办法用他们自己的 web.config 设置所有这些虚拟目录，这样我就可以通过在其中配置 system.web.authorization 参数来控制访问并取消文件夹级别的权限？

我已经尝试过，到目前为止只能在 asp.net 文件上进行这项工作，而不是经典的 ASP。

如果不可能，有人可以提供一些替代方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T00:48:16.707

因为经典 ASP 不知道 ASP.NET 运行时，因为它是 a) 经典且 2) 不是 .NET，因此您不能使用 .NET 配置来管理权限。

您的选择是：

1.  升级到 IIS7
2.  将所有 asp 页面重命名为 aspx
3.  将您的 asp 处理程序更改为 aspnet_isapi.dll（即 .net 处理程序）

虽然 2 和 3 可能有效，但您需要完全测试这些页面以确保它们仍然按预期工作。

我想说最好的办法是只使用文件系统 ACL 来控制谁可以访问这些文件夹。仅仅因为你不了解他们并不意味着他们没有自己的位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T01:59:53.173

您可以使用通配符映射，以便所有文件类型都将由 IIS6 中的 ASP.NET 运行时处理；但是，即使启用了此权限，也不会通过 web.config 处理。经典和 .NET 中的 Windows 身份验证都使用文件权限来确定访问权限。

# silverlight - Silverlight 2.0 与 IE6 + 压缩错误

> ID：850665
> 
> 赞同：0
> 
> 时间：2009-05-12T00:37:09.673
> 
> 标签：silverlight, internet-explorer-6

如果我们打开 IIS 动态压缩，我们的 silverlight 应用程序将无法在 IE6 上运行。但是，如果我们关闭压缩，该站点将起作用。

关闭压缩不是我们的选择。

我们已经尝试了 [http://otoole.wordpress.com/2009/03/10/18/](http://otoole.wordpress.com/2009/03/10/18/)帖子中的所有内容，但没有解决问题。IE7 上不会出现此问题。

看起来这是微软的 IE 错误，但微软不会将此作为错误发布，并且关于问题原因的信息很少。

有没有人有这个问题？如果你知道如何解决它……请回信。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-12T12:53:00.643

您可以仅为页面本身关闭压缩，这样您就可以对其他所有内容保持压缩。

或者，[此处](http://silverlight.net/forums/p/87700/204665.aspx)详述的步骤是否有帮助？

# visual-c++ - 如何从停靠状态中排除 MFC 栏

> ID：850668
> 
> 赞同：0
> 
> 时间：2009-05-12T00:40:16.283
> 
> 标签：visual-c++, mfc

有没有一种简单的方法可以从 MFC 框架窗口保存的停靠状态中排除控制栏？

我们有一个停靠栏，其可见性由其他状态控制，并且停靠状态的加载会干扰所需的行为。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-11-14T02:54:51.373

覆盖这些并使它们返回 FALSE

```
virtual BOOL LoadState(LPCTSTR lpszProfileName = NULL, int nIndex = -1, UINT uiID = (UINT) -1);

virtual BOOL SaveState(LPCTSTR lpszProfileName = NULL, int nIndex = -1, UINT uiID = (UINT) -1); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T13:07:41.583

[在使用DockControlBar](http://msdn.microsoft.com/en-us/library/kc9dywd6(VS.80).aspx)或[FloatControlBar](http://msdn.microsoft.com/en-us/library/xkywsyh1(VS.80).aspx)（取决于*其他状态*）调用“LoadBarState”**后，**您将不得不停靠/取消停靠特定栏。

 *另一个（更骇人听闻的）选项是在调用“SaveBarState”**后使用设置删除特定的注册表项。**停靠状态保存在这里：

> HKLM\软件*\公司名\应用程序名*

每个控制栏都有一个键。

# c# - 是否可以删除 .NET 中未使用的代码/程序集？

> ID：850672
> 
> 赞同：3
> 
> 时间：2009-05-12T00:41:32.863
> 
> 标签：c#, .net, ilmerge

我的应用程序中有一个控件库，对于我正在开发的应用程序类型来说有点大。该库超过 2Mb，我几乎不使用它的功能，我会说我使用了它所有功能的 5% 到 10%。

无论如何要从库中删除我的应用程序从不使用的代码？

PS：这个库不是我开发的，也不是开源的（你可以购买代码）。

编辑：我发布这个是因为我虽然可以使用 ILMerge 来实现，但这是过去有人对我说的......我尝试使用 ILMerge 但没有用，我不确定我是否正确使用它。 ..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T02:57:36.170

需要注意的是，请确保根据制作库的供应商公司的 EULA，您所做的事情是允许的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T01:26:17.503

有一个名为[SmartAssembly](http://www.smartassembly.com/)的产品可以做到这一点。它有点贵，至少对我来说。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T01:00:25.580

我的老板使用了一个混淆产品来做到这一点，将使用的代码放入一个组合程序集中。不过不记得它叫什么了，可能是 DotNet Reactor（我们在确定一个之前使用了几种不同的产品）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T00:49:20.107

2Mb 不算大。

如果你觉得它太多了，并且因为它是你的代码，你应该考虑将它重构为单独的程序集，仍然使用相同的命名空间。这样，您的代码只能引用它需要的程序集。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-12T00:54:29.100

如果它是开源的，您可以查看代码并有选择地取出您想要的内容并构建一个单独的程序集。

如果它不是开源的，您可以在程序集中使用[Reflector](http://www.red-gate.com/products/reflector/)并拧出您想要保留的代码（及其所有依赖项），然后在您自己的程序集中重新构建它。我不确定这有多合法。这可能取决于您图书馆的许可证。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-12T00:54:36.197

你可以这样做，但需要一些编程。看看 mono cecil 项目，你可以打开程序集，删除不需要的类型并保存它。编程涉及确定不使用哪些类型（A 类型正在使用 B 类型，因此如果您使用 A 类型，则应保留 B 类型）...

# formatting - 不显示文化的本国货币时的正确货币格式

> ID：850673
> 
> 赞同：16
> 
> 时间：2009-05-12T00:41:35.033
> 
> 标签：formatting, currency

如果您正在格式化不是当前文化的本地货币的货币，那么格式化货币的正确方法是什么？

例如，如果我为 fr-FR 文化格式化美元，我是像 en-US 文化 ( **$1,000.00** ) 还是作为 fr-FR 文化但将欧元符号更改为美元符号 ( **1 000,00美元**）。也许还有别的东西（**1** 000,00 美元或**1 000,00 美元**）？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-05-12T00:53:36.323

这里没有绝对的规则，但有几个指导原则：

1.  尝试使用该区域设置的数字格式（例如，美国的 1,000.00 在德国将显示为 1'000,00）；
2.  请记住，不同的货币可以使用相同的符号（例如，澳元和美元使用 $）并且有[许多货币符号](http://www.xe.com/symbols.php)；
3.  如果您的网站是“单一”货币，那么只需使用该货币的正确符号即可。我指的是亚马逊、旅游网站、购物网站等网站。这些网站是单一货币的，因为它们一次是**一种货币**。例如，他们不会同时展示马来西亚林吉特和新加坡元；和
4.  如果您的网站是多币种，则根本不要使用该符号：使用由[ISO 4217 货币名称和代码元素](http://www.iso.org/iso/home/standards/currency_codes.htm)定义的国际标准三字母货币代码。像 xe.com 这样的网站就属于这一类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-08T13:15:57.307

如果您总是想显示符号，这里有一个实用程序类：

```
public class Utils {

    public static SortedMap<Currency, Locale> currencyLocaleMap;

    static {
        currencyLocaleMap = new TreeMap<Currency, Locale>(new Comparator<Currency>() {
            @Override
            public int compare(Currency c1, Currency c2) {
                return c1.getCurrencyCode().compareTo(c2.getCurrencyCode());
            }
        });

        for (Locale locale : Locale.getAvailableLocales()) {
            try {
                Currency currency = Currency.getInstance(locale);
                currencyLocaleMap.put(currency, locale);
            }
            catch (Exception e) {
            }
        }
    }

    public static String  getAmountAsFormattedString(Double amount, Double decimals, String currencyCode) {
        Currency currency = Currency.getInstance(currencyCode);
        double doubleBalance = 0.00;
        if (amount != null) {
            doubleBalance = ((Double) amount) / (Math.pow(10.0, decimals));
        }
        NumberFormat numberFormat = NumberFormat.getCurrencyInstance(currencyLocaleMap.get(currency));
        return numberFormat.format(doubleBalance);
    }

    public static String getCurrencySymbol(String currencyCode) {
        Currency currency = Currency.getInstance(currencyCode);
        return currency.getSymbol(currencyLocaleMap.get(currency));
    }

} 
```

# iphone - 基准 UIView drawRect: 方法

> ID：850677
> 
> 赞同：6
> 
> 时间：2009-05-12T00:42:57.120
> 
> 标签：iphone, objective-c, cocoa-touch, benchmarking, quartz-graphics

我正在用 Objective-C 编写一个 iPhone 应用程序，它在视图中使用了一些自定义绘图，我想对我的代码的各种修订进行基准测试，看看有什么真正有帮助。我打算通过设置一个新的应用程序来做到这一点，将我的自定义绘图代码添加到视图的 drawRect: 方法中，然后，在视图控制器的 for 循环中，发送`[UIView setNeedsDisplay]`大量时间并计时需要多长时间去完成。然而，这些`setNeedsDisplay`调用似乎被缓存了，所以即使我在 for 循环中调用它 1000 次，该`drawRect:`方法也只被调用一次。另外，我尝试直接调用 drawRect: 但我需要一个图形上下文来进行一些绘图，并且当我不使用`setNeedsDisplay:`UIGraphicsGetCurrentContext() 时不会给我一个上下文。

有什么建议么？

谢谢，

凯尔

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T02:23:14.710

您可以通过执行以下操作对视图进行基准测试：

```
- (NSTimeInterval)timeTakenToDrawView:(UIView *)view count:(NSInteger)count
{
    CGRect bounds = [view bounds];
    NSDate *startDate = [NSDate date];
    UIGraphicsBeginImageContext(bounds.size);
    CGContextRef context = UIGraphicsGetCurrentContext();
    NSInteger i = 0;
    for (i = 0; i < count; i++) {
        CGContextSaveGState(context);
        [view drawRect:bounds];
        CGContextRestoreGState(context);
    }
    UIGraphicsEndImageContext();
    return [[NSDate date] timeIntervalSinceDate:startDate];
} 
```

（没试过，但应该可以）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T01:07:48.453

在你的 NSView 的 .m 里面。显然，您可能希望将其连接到 UI 或其他东西。

```
- (void)awakeFromNib {
    // Have to wait for the window to be onscreen, graphics context ready, etc
    [NSTimer scheduledTimerWithTimeInterval:1.0 target:self selector:@selector(timerFired:) userInfo:NULL repeats:NO];
}

- (void)timerFired:(NSTimer *)aTimer {
    [self lockFocus];

    NSDate* then = [NSDate date];

    int callIdx = 0;
    for( callIdx = 0; callIdx < 1000; callIdx++ ) {
        [self drawRect:[self bounds]];
    }
    NSDate* now = [NSDate date];

    [self unlockFocus];

    NSLog(@"Took %f seconds", [now timeIntervalSinceDate:then]);
}

- (void)drawRect:(NSRect)rect {
    [[NSColor redColor] set];
    NSRectFill(rect);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T03:20:21.357

不要忘记，如果您的 drawRect 经常使用，您还可以使用 CoreImage 性能工具并获取帧速率。

您还可以使用一些性能工具来查看该方法花费了多长时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-02T21:58:40.340

如果您正在寻找可以进行更深入分析的东西，我有一组宏可以用于时间分析：[https ://gist.github.com/952456](https://gist.github.com/952456)

# asp.net - 为同一个 .NET 应用程序使用 2 个主机名

> ID：850682
> 
> 赞同：0
> 
> 时间：2009-05-12T00:46:01.500
> 
> 标签：asp.net, dns, themes

我需要有 2 个域名，它们基本上是相同的应用程序，但具有不同的主题或皮肤。我知道我可以使用服务器变量检查域名，但是如何将两个域都指向同一个应用程序？我是否像常规网站一样开发它（主题除外？）我是否只是制作一个常规的“网站项目”？另外，我现在只能访问我的本地开发机器（[http://localhost](http://localhost)），而不是域，那么我该如何进行测试和设置呢？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T00:51:52.287

您将在 IIS 中执行此操作。您的 DNS 会将两个域都指向同一台机器，然后在 IIS 标头中放置两个域条目。

至于从代码角度处理它，您可以使用 Request (HttpRequest.Url) 对象来确定正在访问两个站点中的哪一个，并动态更改站点特定的任何设置。

编辑。哎呀，错过了关于测试的一点。好吧，最好的办法是在您的 HOSTS 文件中使用您的域名添加两个条目。编辑文件 c:\windows\system32\drivers\etc\hosts 并添加以下行

fakedomain1.com 127.0.0.1

fakedomain2.com 127.0.0.1

EDIT2：未标记的忍者编辑很烦人。

# javascript - Dojo 是否离线工作？有没有其他选择？

> ID：850686
> 
> 赞同：0
> 
> 时间：2009-05-12T00:49:14.380
> 
> 标签：javascript, dojo, offline

我正在开发一个需要离线工作的网络应用程序。我现在正在看[Gears](http://gears.google.com/)，但我也发现[Dojo 离线](http://www.dojotoolkit.org/offline)。我问这个问题是因为它的最新消息是从 2007 年开始的，并且托管的[演示](http://docs.google.com/View?docid=dhkhksk4_8gdp9gr#demos)似乎不起作用（我已经在我的 Ubuntu 笔记本电脑上的 Firefox 3.0 下安装了 Gears）是否有人在离线使用 Dojo，或者替代高现在级别的离线 Web 应用程序工具包？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T20:05:20.890

作为您链接到的网站，Dojo Offline 建立在 Gears 之上。您想要使用 Dojo Offline 的唯一原因是如果您将 dojo 工具包用于您网站上的其他功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T20:16:09.227

即使文档仍然一团糟，它也能正常工作。看看[Dojo 离线 hello world 演示](http://download.dojotoolkit.org/release-1.3.1/dojo-release-1.3.1/demos/offline/helloworld/helloworld.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-23T16:45:12.563

Dojo Offline 很可能会在即将推出的浏览器中支持原生 HTML5 离线功能（如最新的 Firefox 3.5 候选版本），或者如果用户不在支持 HTML5 的浏览器上，则回退到使用 Gears。因此，Dojo Offline 在实际实现之上提供了一个抽象层，这将允许适应更新的离线技术，而无需更改您自己的代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-02T15:56:39.600

Dojo 离线已经被弃用了一段时间（最后在 v1.3 可用，目前到 v1.5）。

# javascript - this.focus() 在 Firefox 中无法正常工作

> ID：850689
> 
> 赞同：1
> 
> 时间：2009-05-12T00:49:38.670
> 
> 标签：javascript, apache-flex, flash, focus

我正在使用嵌入在我的 html 文档中的 flex 应用程序激活 ExternalInterface 调用。调用转到一个 javascript 函数

```
function documentFocus() {
  this.focus();
} 
```

一切都像一个魅力，除了 Firefox 没有 100% 关注文档正文。它停止监听 onkeyup 事件（它仍然注册 onkeydown）。

非常奇怪的行为。有谁知道发生了什么？

在这里试试：http//www.willemdemmers.com/dplxr/

重现步骤： 尝试使用箭头按钮查看正常行为（箭头图像在 keydown 上亮红色，在 keydown 上停止亮起） 单击窗口底部的闪光灯以从文档正文中移除焦点并调用函数调用。再次尝试箭头按钮并查看新行为。

键事件从箭头键（左和右）触发。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T12:57:36.477

这实际上是我希望修复的长期存在的 Firefox 错误。我不记得手头的 Mozilla 错误编号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T14:58:10.790

您可以尝试聚焦隐藏（或绝对远离）输入元素，然后聚焦文档。因为输入几乎是原生元素，所以它可能会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T00:54:53.450

我认为问题在于当它被点击并从你手中夺走它时，它在键盘上是贪婪的。

你可以在 youtube 上看到这一点。当您选择视频时，您可以使用向上和向下箭头向上和向下滚动页面。但是，当您单击 Flash 区域（视频）时，您将无法再执行此操作。由于闪光灯抓住了键盘。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T01:35:43.837

看看这个： [http ://code.google.com/p/custom-context-menu/](http://code.google.com/p/custom-context-menu/)

这是一个使用javascript禁用flash右键单击的项目，并在这样做时告诉flash。此外，它适用于非常多的浏览器。

不是 100% 的解决方案，但您应该能够根据您的需要调整他们的 JS 代码

# silverlight - 如何使用统一将相同的视图模型传递给子视图？

> ID：850691
> 
> 赞同：2
> 
> 时间：2009-05-12T00:50:59.993
> 
> 标签：silverlight, unity-container, prism

我有一个业务对象，比如说客户，它有太多字段无法在一个页面中显示，所以我将它拆分为不同的标签页。数据不是我可以将其拆分为有意义的位的方式（例如地址，具有状态，街道名称等），因此我决定保持相同的模型和视图模型并具有不同的视图（每个标签页内容是不同的视图）绑定到相同的视图模型。

首先这是正确的方法，为什么不呢？

其次，如果是，我如何使用统一将**相同的**视图模型传递给子视图？目前我使用构造函数注入，但它们是视图模型的新实例。

干杯，

阿里

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-12T06:50:08.193

如果您使用的是 Prism，那么您可以使用 RegionContext。

为 TabControl 指定 RegionContext：

```
<TabControl cal:RegionManager.RegionName="MyTabControl"
cal:RegionManager.RegionContext="{Binding Path=ViewModel}"> 
```

并使用 RegionContext 上的静态 GetObservableContext 方法从添加到该区域的视图中访问它：

```
void ViewConstructor()
{
this.ViewModel = (MyViewModel)RegionContext.GetObservableContext(this).Value;
} 
```

如果您不使用 Prism，则可以将 ViewModel 注册为命名实例：

```
Container.RegisterInstance<IMyViewModel>("viewModelName", new MyViewModel()); 
```

稍后使用：

```
Container.Resolve<IMyViewModel>("viewModelName"); 
```

# php - html电子邮件的mail（）标题问题

> ID：850701
> 
> 赞同：1
> 
> 时间：2009-05-12T00:55:36.570
> 
> 标签：php, email, header

我正在尝试为 php 中的网站编写错误报告功能。我无法正确获取标题，因此电子邮件将显示为 html。

这是代码：

```
if( isset($_POST['submit']) )
{
    $browser = $_SERVER['HTTP_USER_AGENT'];
    $page = $_POST['page'];
    $email = $_POST['email'];
    $error = $_POST['error'];

    $message  =  "<html><body> \n";   
    $message .=  "Email: $email \n";
    $message .=  "Page: $page \n";
    $message .=  "OS/ Browser: $browser \n";
    $message .=  "Error: $error \n";
    $message .=  "</body></html> \n";

    $headers  = 'MIME-Version: 1.0' . '\r\n';
    $headers .= 'Content-type: text/html; charset="iso-8859-1"' . '\r\n';
    $headers .= 'From:  <code@website.com>' . '\r\n';
    $headers .= 'Reply-To: $email ' . '\r\n';
    $headers .= 'X-Priority: 1' . '\r\n';

    $subject  = "[ERROR REPORT] Page: " . $page;

    mail("myEmail@gmail.com", $subject, $message, $headers );

    $mesg = "Thank you for your report!";

}

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T20:16:00.467

就个人而言，我是 Pear Mail ( [http://pear.php.net/package/Mail](http://pear.php.net/package/Mail) ) 和 Pear Mail_Mime ( [http://pear.php.net/package/Mail_Mime](http://pear.php.net/package/Mail_Mime) ) 的粉丝。

发送 HTML 电子邮件（带有纯文本正文，适用于不支持 HTML 的客户端）就像这样简单：

```
include_once('Mail.php');
include_once('Mail/Mime.php');

$htmlBody = '<html><body><b>Hello World</b></body></html>';
$plainBody = 'Your client doesn\'t support HTML';
$em = Mail::factory('sendmail');
$headers = array('From'=>'me@domain.com', 'To'=>'joe@schmoe.com', 'Subject'=>'Cool Email');
$mime = new Mail_Mime();
$mime->setTxtBody($plainBody);
$mime->setHtmlBody($htmlBody);
$message = $mime->get();
$headers = $mime->headers($headers);
$mail = $em->send('joe@schmoe.com', $headers, $message); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-12-16T17:10:07.113

我注意到的一个问题是您需要在适当的位置使用双引号而不是单引号。

采用：`"\r\n"`

代替：`'\r\n'`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T00:58:04.367

基本上重复我对[另一个问题](https://stackoverflow.com/questions/809924/is-this-the-correct-way-to-send-email-with-php/)的回答，在大多数情况下，我完全支持自己滚动，但是在邮件方面，我衷心建议让自己更轻松，并使用[Swift Mailer](http://swiftmailer.org/)或[PHPMailer](http://phpmailer.codeworxtech.com/)之类的东西（在那订购，为了我的钱）。

作为附带奖励（假设您指定回复等），您被标记为垃圾邮件的机会也少得多。

编辑：也许这只是您使用的示例，但您的消息中没有实际的 HTML。为什么不只使用纯文本？是的，我也会使用我建议的纯文本类之一。

# html - 有哪些网站可以让“开发者”阻止客户端更改 html？

> ID：850702
> 
> 赞同：0
> 
> 时间：2009-05-12T00:56:23.293
> 
> 标签：html, css, client-side

我以前知道它叫什么，但那是几年前的事了。该站点基本上允许开发人员在标签内添加 ID 或 Class，以让站点知道客户端只能更改具有特定 ID 或 Class 的标签之间的代码。我希望有人知道。这是要了我的命。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T02:59:43.293

我相信您正在考虑[CushyCMS](http://www.cushycms.com/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T00:58:57.393

不确定是否有任何网站在不使用内容管理系统 (CMS) 的情况下允许该功能。您是否还记得某个特定的 CMS 系统？

或者它是你所追求的 WIKI？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T15:19:43.163

或者，您可能正在考虑 Adob​​e 的 Dreamweaver 和[Contribute](http://www.adobe.com/products/contribute/) （以前称为 Macromedia）。

# c# - 我正在寻找指向 cdb/windbg + .net 文档的链接

> ID：850704
> 
> 赞同：2
> 
> 时间：2009-05-12T00:57:16.973
> 
> 标签：c#, windbg, sos

我刚开始使用 cdb，我喜欢它！

我找到了一些关于使用 cdb 的有趣文章并将其添加到[书签](http://delicious.com/john.weldon/cdb)，但我很想看看其他人的资源。

您使用哪些站点从 cdb (windbg) 中提取最大实用性

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T18:23:54.330

以下是我多年来在 WinDbg/SOS 上收集的一系列链接：

*   [如果坏了，你应该修复它，你应该写博客](http://blogs.msdn.com/tess/default.aspx)——Tess Ferrandez 的关于 WinDbg/.Net 的优秀博客和有趣的[实验室调试](http://blogs.msdn.com/tess/pages/net-debugging-demos-information-and-setup-instructions.aspx)
*   [WinDbg / SOS Cheat Sheet](http://geekswithblogs.net/.netonmymind/archive/2006/03/14/72262.aspx) -- 常用的 SOS 命令
*   [John Robbin 的博客 / CmdTree 信息](http://www.wintellect.com/CS/blogs/jrobbins/archive/2008/09/17/windbg-cmdtree-file-that-eases-some-sos-pain.aspx)-- CmdTree 是 WinDbg 的一个隐藏功能，用于创建常用项目的快捷方式
*   [SOSEX](http://www.stevestechspot.com/) ——Steve Johnson 的 SOS 扩展，包含一堆 exta .Net 调试扩展

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T01:27:55.193

代码项目有一篇很棒的关于 WinDbg 的初学者文章。可能有些项目您还没有看到。

[http://www.codeproject.com/KB/debug/windbg_part1.aspx](http://www.codeproject.com/KB/debug/windbg_part1.aspx)

以下是一些常用功能的列表

[http://www.windbg.info/doc/1-common-cmds.html](http://www.windbg.info/doc/1-common-cmds.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-12T01:28:46.267

这是一本很棒的书：[Advanced Windows Debugging](http://advancedwindowsdebugging.com/)，尽管它更关注本机而不是托管调试。它有一些您可能会感兴趣的链接。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T03:08:26.243

[这](http://msdn.microsoft.com/en-us/library/ms954594.aspx)是来自 MSDN 库的关于 .NET 调试的一系列好文章，它涵盖了使用 WinDbg 和 Core Debugger。

# c# - 在 C# 中检测您的操作系统上安装了哪个版本的 IE？

> ID：850709
> 
> 赞同：4
> 
> 时间：2009-05-12T00:59:32.493
> 
> 标签：c#, .net, internet-explorer, windows-services, httpwebrequest

我正在维护一个 Windows 服务，该服务以编程方式生成 HttpWebRequest 和 HttpWebResponse 对象，用于检索请求的响应消息。

HttpWebRequest的`UserAgent`属性被硬编码为使用 IE 6 作为浏览器代理。是否有一种以编程方式检测托管服务的服务器上安装了哪个版本的 IE 的方法？

它当前托管在 Windows Server 2003 机器上，并且可能安装在 Windows Server 2008 机器上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-08T15:54:13.307

如果您创建了一个，您也可以从 WebBrowser 控件本身中提取它：

```
WebBrowser  browser = new WebBrowser();
Version ver = browser.Version; 
```

警告：必须从 STA 线程调用，否则会引发异常。这可以在 MSTest 清理代码中遇到，它是 MTA，而不是 STA。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T01:05:10.783

看起来可以设置用户代理：http: [//msdn.microsoft.com/en-us/library/system.net.httpwebrequest.useragent.aspx](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.useragent.aspx)

这些天我更喜欢 WebClient 类，它是 HttpWebRequest 的包装器，允许你用更少的代码做一些事情：http: [//msdn.microsoft.com/en-us/library/system.net.webclient.aspx](http://msdn.microsoft.com/en-us/library/system.net.webclient.aspx)

# cocoa - Cocoa NSSortDescriptors 属于模型还是控制器？

> ID：850711
> 
> 赞同：0
> 
> 时间：2009-05-12T01:01:36.390
> 
> 标签：cocoa, model-view-controller, sorting, nssortdescriptor

子类会`NSSortDescriptor`放在模型层还是控制器层？

由于它们主要用于显示和业务逻辑，因此将它们放在 Controller 层似乎是有意义的。但模型应该知道如何对自己进行排序也是有道理的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T02:39:15.323

NSSortDescriptor... 子类？

> 模型应该知道如何对自己进行排序。

排序是一个向用户展示的问题，这使得它更像是视图和控制器的领域；模型通常应该远离这些事情。

在 Cocoa 中，您*实例化*NSSortDescriptor，并将这些描述符保存在一个数组中，以供任何想要使用它们对事物进行排序的人使用。我想不出继承 NSSortDescriptor 的理由。

# c# - 从 CreateUserWizardStep 遍历 ControlCollection

> ID：850712
> 
> 赞同：0
> 
> 时间：2009-05-12T01:01:42.007
> 
> 标签：c#, .net, asp.net, linq, collections

我正在尝试遍历我的 CreateUserWizardStep 的 CreatedUser 事件中的 ControlCollection。我有一个 ContentTemplate ，其中包含一个充满复选框的表格，我使用这些复选框来收集一周内用户的可用性。为了简洁起见，我将把我的代码粘贴到 pastebin 上。

[这](http://pastebin.com/m3c89cbd4)是 .aspx 页面的链接。 [这](http://pastebin.com/m4bf557e8)是 CreatedUser 事件。

这个循环：

```
foreach (Control c in CreateUserWizardStep1.ContentTemplateContainer.Controls)
    {
        if (c.GetType() == typeof(CheckBox))
        {
        }
    } 
```

给我一个 WizardDefaultInnerTable 而不是......以及更容易使用的东西。

我如何去获得第二张桌子内的复选框？我想要做的是找到选中的属性，然后构建可以放入数据库的字符串。任何指导表示赞赏。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T02:19:34.547

您必须递归地通过控件。但是，您也可以通过您设置的 id 来引用它们。

递归解决方案看起来像：

```
IEnumerable<T> FindControls<T>(Control parent) where T : Control {
   T t = parent as T;
   if (t != null) yield return t;

   foreach (Control c in parent.Controls) {
      foreach (var c2 in FindControls<T>(c)) yield return c2;
   }
} 
```

# asp.net-mvc - 请求对此 MVC Widget 方法的输入

> ID：850715
> 
> 赞同：0
> 
> 时间：2009-05-12T01:03:17.230
> 
> 标签：asp.net-mvc

我意识到这个问题有点主观，但似乎 ASP.Net MVC 的最佳实践仍在不断发展。

我去寻找有关如何使用自己的控制器实现子/部分视图的示例，以便我可以生成自包含的小部件，我遇到了这篇文章。

[http://blog.codeville.net/2008/10/14/partial-requests-in-aspnet-mvc/](http://blog.codeville.net/2008/10/14/partial-requests-in-aspnet-mvc/)

它有效，但我很好奇是否有人对这种事情有更多经验可以看到我使用这种方法可能遇到的一些障碍。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T10:29:53.970

通常，您的主视图模型应包含中继到部分所需的模型数据。如果需要，请使用复合模型，或通过 ViewData 传递额外的数据。

# c# - 将文本附加到富文本框中的开头

> ID：850716
> 
> 赞同：11
> 
> 时间：2009-05-12T01:03:17.837
> 
> 标签：c#, richtextbox

```
private void button1_Click(object sender, EventArgs e)
{
    richTextBox1.AppendText("\r\n");
    richTextBox1.Focus();
    string s = "Enter ";
    richTextBox1.AppendText(s + "\r\n");
    richTextBox1.SelectionStart = richTextBox1.Text.Length - (s.Length +1);
    richTextBox1.SelectionLength = s.Length +1;
    richTextBox1.SelectionFont = new Font("Arial", 12, FontStyle.Bold);
    richTextBox1.DeselectAll();
    richTextBox1.SelectionStart = richTextBox1.Text.Length;
    richTextBox1.SelectionLength = richTextBox1.Text.Length;
    richTextBox1.SelectionFont = new Font("Arial", 12, FontStyle.Regular);
    richTextBox1.DeselectAll();
} 
```

每次用户单击按钮时，我都希望新的“Enter”位于 RichTextBox 的顶部而不是底部。我该怎么做？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-12T01:18:05.287

从技术上讲，如果您将它插入到文本的顶部，那么您是在“插入”或“前置”，而不是“附加”。;)

您可以使用 SelectedText 属性在 RichTextBox 的开头插入文本。我刚刚敲了一个快速演示应用程序来测试它：

```
 private void button1_Click(object sender, EventArgs e)
    {
        richTextBox1.SelectionStart = 0;
        richTextBox1.SelectionLength = 0;
        richTextBox1.SelectedText = DateTime.Now.ToString();
    } 
```

当单击 button1 时，它会在 RichTextBox 的开头插入当前时间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-20T08:16:06.447

我喜欢的最简单的方法是，

```
 private void button1_Click(object sender, EventArgs e)
    {
        richTextBox1.Text = DateTime.Now.ToString() + richTextBox1.Text;
    } 
```

它将在开始时添加当前日期时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-12-03T10:22:43.853

以前的消息似乎已过时。我通过以下方式解决它：

```
Paragraph newExternalParagraph = new Paragraph();
newExternalParagraph.Inlines.Add( new Bold(new Run("[" + hour.ToString() + ":" + minute.ToString() + "]"))
{
    Foreground = Brushes.Yellow
});
_consoleText.Document.Blocks.InsertBefore(_consoleText.Document.Blocks.FirstBlock , newExternalParagraph); 
```

# c++ - 为什么我的堵塞物不粘住？

> ID：850724
> 
> 赞同：0
> 
> 时间：2009-05-12T01:09:10.230
> 
> 标签：c++, clog

我想我没能理解 C++ 的一些更好的点。我想建立一个我的程序做了什么的日志，并且发现了`std::clog`，这似乎在理论上做了我想要的，但实际上它没有。

如果我执行以下操作，clog 会按预期工作并将“Test 1”写入屏幕，“Test 2”会显示在文件中：

```
int main ()
{
    clog << "Test 1" << endl;
    streambuf* original_buffer = clog.rdbuf (ofstream ("test.log").rdbuf ()));
    clog << "test 2" << endl;

    clog.rdbuf (original_buffer);
    return 0;
} 
```

但是如果我把所有这些都放到一个类中，那么“Test 1”会被写入屏幕，test.log 会被创建，但里面什么都没有，“Test 2”也找不到！：

```
class IerrLog
{
    std::streambuf * original_buffer;
    public:
    IerrLog ()
    {
        std::ofstream logFile ("test.log");
        original_buffer = std::clog.rdbuf (logFile.rdbuf ());
    }
    ~IerrLog ()
    {
        std::clog.rdbuf (original_buffer);
    }
};

int main () {
    clog << "Test 1" << endl;
    IerrLog someLog ();
    clog << "Test 2" << endl;
    return 0;
} 
```

我错过了什么？

编辑：如果我在 valgrind 中运行后者，我会收到这样的错误（前者运行干净）：

```
Invalid read of size 8
    at 0x39598993E5: std::ostream::flush() (in /usr/lib/libstdc++.so.6.0.10)
    by 0x395989B5F2: std::basic_ostream<char, std::char_traits<char> >& std::endl<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&) (in /usr/lib/libstdc++.so.6.0.10)
    by 0x400F8E: main (main.cc:23)
  Address 0x7ff0006c8 is just below the stack ptr.  To suppress, use: --workaround-gcc296-bugs=yes 
```

我并没有令人讨厌地认为我（一个普通的程序员）在这么简单的程序中发现了一个编译器错误，但这让我更加困惑，valgrind 显然发现后者在某种程度上是错误的，即使我试图让它们在功能上相同。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T01:13:25.200

我假设您要创建*IerrLog*的堆栈变量。你需要改变

```
IerrLog someLog (); 
```

到

```
IerrLog someLog; 
```

您的原始语句将被编译器解释为函数*someLog()*的声明，该声明不接受任何参数并返回 IerrLog。

您还应该将文件创建为成员变量，而不是在堆栈上。

# python - Python 递归生成器的范围

> ID：850725
> 
> 赞同：2
> 
> 时间：2009-05-12T01:09:32.100
> 
> 标签：python, recursion, scope, generator

大家好，我正在使用递归生成器来创建数字的固定整数分区，但我对范围问题感到困惑。

该代码类似于此代码段。

```
def testGen(a,n):
    if n <= 1:
        print('yield', a)
        yield a
    else:
        for i in range(2):
            a[i] += n
            for j in testGen(a,n-i-1):
                yield j 
```

我的困惑如下图所示。

```
>>> list(testGen([1,2],4))
yield [10, 2]
yield [10, 4]
yield [10, 7]
yield [12, 11]
yield [12, 13]
[[12, 13], [12, 13], [12, 13], [12, 13], [12, 13]] 
```

我可以简单地通过使用数组的副本（例如传递`a[:]`给递归调用）得到正确的答案，但我仍然不明白上述行为。为什么打印语句和产量值不同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T01:13:36.353

我猜你正在改变数组，所以当你打印它有一个特定的值时，下一次你打印它实际​​上已经更新了这个值，依此类推。最后，你有 5 次对同一个数组的引用，所以当然你有 5 次相同的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T01:17:26.113

print 语句显示该特定时间点的列表。您的代码会在您运行它时更改列表，因此当您最后检查列表时，您会看到它的值。

您可以通过以下步骤观察到这一点：

```
>>> g = testGen([1,2],4)
>>> g.next()
('yield', [10, 2])   # note brackets in print statement because I'm on python 2.5
[10, 2]
>>> g.next()
('yield', [10, 4])
[10, 4]
>>> g.next()
('yield', [10, 7])
[10, 7]
>>> g.next()
('yield', [12, 11])
[12, 11]
>>> g.next()
('yield', [12, 13])
[12, 13] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T01:20:26.110

列表是可变对象，如果你传入一个列表，并且生成器对该列表执行就地操作，那么最终对列表的所有引用都将指向同一个列表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T01:19:19.480

print 和 yield 语句是不同的，因为您只有一个 print 语句，而您有 2 个 yield。尝试这个：

```
def testGen(a,n):
    if n <= 1:
        print('yield', a)
        yield a
    else:
        for i in range(2):
            a[i] += n
            for j in testGen(a,n-i-1):
                print('yield', j)
                yield j

>>> list(testGen([1,2],4))
('yield', [10, 2])
('yield', [10, 2])
('yield', [10, 2])
('yield', [10, 2])
('yield', [10, 4])
('yield', [10, 4])
('yield', [10, 4])
('yield', [10, 4])
('yield', [10, 7])
('yield', [10, 7])
('yield', [10, 7])
('yield', [12, 11])
('yield', [12, 11])
('yield', [12, 11])
('yield', [12, 13])
('yield', [12, 13])
('yield', [12, 13])
[[12, 13], [12, 13], [12, 13], [12, 13], [12, 13]] 
```

您将看到最后的产量是您的答案，因为您一直在传递相同的列表而不是制作副本。

# jquery - 当我 jQuery AJAX 调用路由时需要 MVC 路由的帮助

> ID：850726
> 
> 赞同：3
> 
> 时间：2009-05-12T01:11:01.770
> 
> 标签：jquery, asp.net-mvc, ajax

我正在尝试访问一个简单的 ASP.NET MVC 路由，但出现以下错误：

> 参数字典包含不可空类型“System.Boolean”的参数“isFoo”的空条目，用于......等等等等。

IE。布尔属性未设置...这意味着该值未传入。

所以我有一个名为 Transform(..) 的 Action 方法，它不接受使用 jQuery 发送给它的 HTTP 值。就像我发布的值丢失了:(

MVC 站点是标准的 ASP.NET MVC 文件->新建->MVC Web 应用程序。除了添加一个新的控制器类之外，什么都没有改变。而已。

```
using System.Web.Mvc;
using System.Web.Mvc.Ajax;

namespace WorldDomination.EbonHawk.Web.Controllers
{
    public class AjaxController : Controller
    {
        [AcceptVerbs(HttpVerbs.Post)]
        public ActionResult Transform(bool isFoo, string bar)
        {
            // blah....
            return View();
        }

    }
} 
```

以及如何调用它，使用 jQuery ....

```
$.ajax({
    type: "POST",
    url: "/ajax/transform",
    data: "isfoo=true&bar=" + $("#Bar").val(),
    contentType: "application/json;",
    dataType: "json",
    success: function() { alert("it worked"); },
    failure: function() { alert("Uh oh"); }
}); 
```

当我使用 FireBug 时，它肯定表明我正在尝试 POST 到 url。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T01:18:06.643

乍一看，您似乎对 jQuery 感到困惑……

您告诉它您的数据类型是 JSON，但提交文本。从您的 AJAX 帖子中删除您的 dataType 子句，jQuery 将找出并适当地提交您的帖子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T01:21:10.693

杰夫所说的。或者，如果您希望保留`dataType`，您的`data`行应如下所示：

```
...
data: { isfoo: true, bar: $("#Bar").val() },
... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T01:46:47.720

ASP.NET MVC 控制器操作只是将 POST 或 GET 参数转换为函数的参数。如果使用这些 HTTP 方法之一正确传递了参数，则应该没问题。但是，您的 jQuery 似乎无法正常工作。

您应该将 $.ajax 调用更改为如下

```
$.ajax({
    type: "POST",
    url: "<%= Url.Action("Transform", "Ajax") %>",
    data: { isfoo: true, bar: $("#Bar").val() },
    contentType: "application/json;",
    dataType: "json",
    success: function() { alert("it worked"); },
    failure: function() { alert("Uh oh"); }
}); 
```

请注意，此问题与路由系统无关。如果您想使用路由创建一个干净的 URL 以使用参数调用，您需要将您的方法更改为 POST。不过，总的来说，你现在拥有它的方式要干净得多。但是，最好使用路由系统为您的服务生成基本 URL。

**编辑：**

如果您要像在 data 选项中那样使用 GET 参数，我认为您还需要让 isfoo= 读取 isFoo=。我不记得参数化时大写是否重要。

# bash - 如何从命令行将文本附加到 /etc/apt/sources.list？

> ID：850730
> 
> 赞同：75
> 
> 时间：2009-05-12T01:13:48.443
> 
> 标签：bash

我是 linux 新手，刚开始学习 bash。我正在使用 Ubuntu 9.04，并且想从命令行将存储库添加到 /etc/apt/sources.list。基本上，我想这样做：

```
sudo echo "[some repository]" >> /etc/apt/sources.list 
```

但是，即使我使用 sudo，我也会收到此错误：

```
bash: /etc/apt/sources.list: Permission denied 
```

如何避免此错误？

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2009-05-12T01:17:01.903

```
echo "[some repository]" | sudo tee -a /etc/apt/sources.list 
```

[tee](http://en.wikipedia.org/wiki/Tee_(command))命令通过*sudo*作为超级用户调用，*-a*参数告诉 tee 附加到文件而不是覆盖它。

您的原始命令失败，因为使用*>>*的 IO 重定向将作为普通用户完成，只有您的 echo 是使用 sudo 执行的。

调用 sudo 子shell，如

```
sudo sh -c 'echo "[some repository]" >> /etc/apt/sources.list' 
```

正如其他人所指出的那样，也有效。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-12T01:32:19.770

在启动命令之前，shell 会自行处理“>”、“<”、“>>”等。所以问题是“sudo >> /etc/foo”在获得权限之前试图打开 /etc/foo 进行追加。

解决这个问题的一种方法是使用 sudo 启动另一个 shell 来做你想做的事情，例如：

```
sudo sh -c 'echo "[some repository]" >> /etc/apt/sources.list' 
```

或者：

```
echo "[some repository]" | sudo sh -c 'cat >> /etc/apt/sources.list' 
```

一种更简单的方法可能只是使用 sudo 在 /etc/file 上启动编辑器:)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2010-07-02T20:29:20.110

最好使用单独的文件`/etc/apt/sources.list.d`而不是修改`/etc/apt/sources.list`，如[其他答案](https://stackoverflow.com/questions/1584066/append-to-etc-apt-sources-list)中所述。（请注意，文件名必须以结尾，`.list`否则将被忽略。）

但是，如果您想使用`echo`权限问题来创建它，仍然存在。您可以`tee`像这样使用它来创建它：

```
echo '[some repository]' | sudo tee /etc/apt/sources.list.d/some-repository.list >/dev/null 
```

或像这样：

```
sudo tee /etc/apt/sources.list.d/some-repository.list >/dev/null <<EOF
[some repository]
EOF 
```

`-a`请注意，您不需要`tee`命令（因为您没有附加）。

您还可以在其他地方创建文件，然后将其复制到位：

```
sudo cp path/to/some-repository.list /etc/apt/sources.list.d/ 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-12T01:31:16.077

解决此问题的一种方法是在子外壳中进行重定向：

```
sudo sh -c 'echo "[some repository]" >> /etc/apt/sources.list' 
```

这样，该`sh`进程在下执行`sudo`，因此具有打开重定向输出到`/etc/apt/sources.list`.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-01-10T15:53:49.140

以下对我有用

```
sudo echo "deb http://downloads-distro.mongodb.org/repo/ubuntu-upstart dist 10gen" | sudo tee -a /etc/apt/sources.list.d/10gen.list 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-11-12T21:56:00.440

在 Karmic 中，您可以只使用`add-apt-repository`命令，至少对于 PPA。

例如：

```
sudo add-apt-repository ppa:docky 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-05-25T10:41:34.023

这是不使用管道的解决方案，只是简单的就地编辑：

```
sudo ex +'$put = \"[some repository]\"' -cwq /etc/apt/sources.list 
```

`ex`相当于`vi -e`。_

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2011-05-24T23:15:19.963

如果您以 su 身份登录（如果您有权限），则相同的命令可以正常工作...

```
su
echo "[some repository]" >> /etc/apt/sources.list 
```

如果您不是超级用户，请选择 Lothar 的答案。

如果您这样做，请务必从 su 退出，这样您就不会以 root（超级用户）身份运行不必要的程序

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2016-08-07T09:00:51.290

首先通过以下命令打开或创建要编辑的文件

> 1- sudo nano 文件名
> 
> 2-打开文件后编辑
> 
> 3- ctrl+x
> 
> 4-按'Y'说是

你就完成了。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2021-07-19T18:21:38.187

**有趣，1- 用 rm 删除文件，2 用 touch 再次创建文件，3 使用 printf 打印格式化，4 用 tee 管道到文件（这是为 DEBIAN）替换你的口味和喜欢**

```
sudo rm /etc/apt/sources.list && sudo touch /etc/apt/sources.list && sudo chmod +rwx /etc/apt/sources.list && sudo printf "deb http://deb.debian.org/debian buster main contrib non-free
deb-src http://deb.debian.org/debian buster main contrib non-free
deb http://deb.debian.org/debian-security/ buster/updates main contrib non-free
deb-src http://deb.debian.org/debian-security/ buster/updates main contrib non-free
deb http://deb.debian.org/debian buster-updates main contrib non-free
deb-src http://deb.debian.org/debian buster-updates main contrib non-free" | sudo tee -a /etc/apt/sources.list 
```

# c# - .net 中的可空类型

> ID：850743
> 
> 赞同：0
> 
> 时间：2009-05-12T01:21:03.877
> 
> 标签：c#, .net, .net-3.5

为什么

```
properties[5].PropertyType.GetGenericTypeDefinition() == 
   Type.GetType("System.Nullable`1") 
```

等于 true while

```
properties[5].PropertyType.GetGenericTypeDefinition() ==
   Type.GetType("System.Nullable") 
```

等于假？

`Properties[5]`作为一个`public Nullable<DateTime>`领域。

“1 `after the`System.Nullable”是什么意思？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T01:26:31.310

`1 表示该类型是泛型类型。由于可能有一个名为“Foo”的类型以及一个名为“Foo”的类型，因此需要有一些内部方法来区分这两种类型。

由于存在非泛型`System.Nullable`类型但您使用的是泛型类型，因此与 GetType("System.Nullable") 的比较将始终返回 false。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T01:26:52.760

Nullable`1 是您在 C# 中称为 Nullable<T> 的类的真实名称（或 VB.Net 中的 Nullable(Of T)）。

Nullable 是一个静态类，具有许多用于使用 Nullable<T> 的辅助方法。

# iphone - 为 iphone 提交添加屏幕截图

> ID：850746
> 
> 赞同：0
> 
> 时间：2009-05-12T01:22:18.477
> 
> 标签：iphone, submit, screenshot

只是出于好奇。我正在考虑为我的应用程序添加屏幕截图，这些屏幕截图都面向横向和纵向。商店会自动识别这些格式并适当地应用它们吗？

一切顺利。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T01:28:13.960

是的，它确实。

# list - 如何在 Haskell 中使用“unwords”打印字符串列表？

> ID：850748
> 
> 赞同：1
> 
> 时间：2009-05-12T01:24:13.233
> 
> 标签：list, haskell, pretty-print

我想打印如下所示的字符串列表。

```
|Name|Country|Age|
------------------
|1   |USA    |20 |
|2   |UK     |19 | 
```

我能够使用以下方法实现这一目标。

```
printfieldName :: [String] -> String
printfieldName [] = []
printfieldName (x:xs)  = "|" ++ x ++ "\t" ++ printfieldName (xs) 
```

是否可以使用内置函数“unwords”来实现这一点。我可以使用“unwords”打印它，但无法`|`在单词之间放置。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T01:36:27.020

首先，我会这样写：

```
printfieldName []     = []
printfieldName (x:xs) = "|" ++ x ++ "\t" ++ printfieldName xs 
```

嗯，实际上，不，像这样：

```
concatMap (\x -> '|' : x ++ "\t") 
```

好吧，也许更像：

```
concatMap (printf "|%s\t") 
```

好的。那么它可以作为'unwords'来完成吗？

```
-- | 'unwords' is an inverse operation to 'words'.
-- It joins words with separating spaces.
unwords                 :: [String] -> String
unwords []              =  ""
unwords ws              =  foldr1 (\w s -> w ++ ' ':s) ws 
```

不，但是看看你是否可以把 c​​oncatMap 写成一个 foldr ......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-12T01:49:37.183

我看到'|'之间有一个额外的空格 和 word，所以你可以使用这个功能：

```
printfieldName x = unwords (map ((++) "|") x)  ++ "|" 
```

小解释：

```
(++) "|" - creates a function which take prefixes each word with "|", so
(++) "|" "test" -> "|test" 
```

然后，`map`将此函数应用于将其转换为的单词列表`["|1", "|USA", "|20", ... ]`

然后`unwords`将它们连接成一个字符串，单词之间有空格。`++ "|"`需要添加final`|`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-12T02:15:17.033

`Data.List`有一个叫做 intersperse 的函数。也许你可以使用它。

```
printfieldName xs = "|" ++ unwords (intersperse "|\t" xs) ++ "|" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-02-23T22:00:45.527

也许你问的有点过头了，但是：

```
formatTable :: [String] -> [[String]] -> String
formatTable header rows =
    formatRow header ++ dashRow ++ concatMap formatRow rows

    where formatRow cells = bracket '|' (spread cells)
          dashRow         = bracket '+' (map (\n -> replicate n '-') widths)
          bracket c cells = concatMap (c:) cells ++ (c:"\n")

          spread cells    = zipWith pad widths cells
          pad n s         = take n (s ++ repeat ' ')

          widths = foldr maxLengths (repeat 0) (header : rows)
          maxLengths = zipWith (\c l -> max (length c) l) 
```

然后，例如：

```
> let h = words "Name Country Age"
> let rows = map words ["1 USA 20", "2 UK 19"]
> h
["Name","Country","Age"]
> rows
[["1","USA","20"],["2","UK","19"]]
> putStr $ formatTable h rows
|Name|Country|Age|
+----+-------+---+
|1   |USA    |20 |
|2   |UK     |19 | 
```

# python - 使用 paramiko 检查远程主机上是否存在路径

> ID：850749
> 
> 赞同：18
> 
> 时间：2009-05-12T01:24:59.767
> 
> 标签：python, ssh, scp, paramiko

Paramiko的[SFTPClient](http://www.metasnark.com/paramiko/docs/paramiko.SFTP-class.html)显然没有`exists`方法。这是我目前的实现：

```
def rexists(sftp, path):
    """os.path.exists for paramiko's SCP object
    """
    try:
        sftp.stat(path)
    except IOError, e:
        if 'No such file' in str(e):
            return False
        raise
    else:
        return True 
```

有一个更好的方法吗？检查异常消息中的子字符串非常难看，而且可能不可靠。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-09-08T00:29:06.087

有关定义所有这些错误代码的常量，请参见[`errno`模块](http://docs.python.org/library/errno.html#errno.ENOENT)。此外，使用`errno`异常的属性比使用`__init__`args 的扩展更清楚，所以我会这样做：

```
except IOError, e: # or "as" if you're using Python 3.0
  if e.errno == errno.ENOENT:
    ... 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2019-01-05T23:10:06.407

Paramiko 从字面上加注`FileNotFoundError`

```
def sftp_exists(sftp, path):
    try:
        sftp.stat(path)
        return True
    except FileNotFoundError:
        return False 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-12T02:16:12.727

没有为 SFTP 定义“存在”方法（不仅仅是 paramiko），所以你的方法很好。

我认为检查 errno 会更干净一些：

```
def rexists(sftp, path):
    """os.path.exists for paramiko's SCP object
    """
    try:
        sftp.stat(path)
    except IOError, e:
        if e[0] == 2:
            return False
        raise
    else:
        return True 
```

# asp.net-mvc - 在 .NET 中实现基于 REST 的 Web 服务的最佳方式是什么？

> ID：850763
> 
> 赞同：3
> 
> 时间：2009-05-12T01:29:33.597
> 
> 标签：asp.net-mvc, wcf, rest, wcf-data-services

到目前为止，我的选择是 ADO.Net 数据服务、WCF REST Starter Kit（不确定我是否可以使用它，因为它们的 EULA 很难理解和混淆）、ASP.NET MVC。

有很多帖子，但我想看看是否还有我缺少的框架。如果您已经使用上述任何选项，也请发布您的经验。

我希望使用的场景是从 SQL Server 数据库中保存和检索一些数据。我正在寻找已经内置了一些基础设施的东西。我阅读了其他问题，但我没有得到人们对上述选项的任何具体经验，所以想知道事情是否会随着时间而改变。

提前致谢。

澄清 #1：我目前将我的选项限制为 MS Stack

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T03:40:49.063

实际上，我认为 ADO.NET for Data Services（以前称为 Astoria）是您想要的。

[http://msdn.microsoft.com/en-us/data/bb931106.aspx](http://msdn.microsoft.com/en-us/data/bb931106.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-20T23:40:45.113

就 v1 而言，WCF 肯定不是要走的路。它会阻止您实现 ReST 架构的许多约束。

如果您想通过 http 进行 ReST，为什么不看看 OpenRasta，它是从头开始构建以支持 REST 场景的：

[http://trac.caffeine-it.com/openrasta](http://trac.caffeine-it.com/openrasta)

塞布

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T01:54:05.367

如果您使用 .asmx wed 服务，您可以使用[ScriptService](http://msdn.microsoft.com/en-us/library/system.web.script.services.scriptserviceattribute.aspx)标记该类，然后在 AJAX 调用中请求 Json 以获取 Json。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T03:34:33.660

如果您的网站已经在运行 MVC，并且添加额外的视图并转储 xml/json 而不是 HTML 内容会更容易。（Stack Overflow 为他们的 RSS 提要这样做）

如果您想添加自定义标头，例如 Basic Http Authentication、[X-HTTP-Method-Override](http://code.google.com/apis/gdata/docs/2.0/basics.html)以支持 put/delete（因为浏览器管道仅支持 get/post），在[Rest Starter Kit](http://msdn.microsoft.com/en-us/netframework/cc950529.aspx)中很容易做到，而且几乎不可能目前在 WCF 3.5 中执行（可能与设置了允许[httpcontext](http://msdn.microsoft.com/en-us/library/system.web.httpcontext.aspx)的属性的 asp.net 模块一起使用）

Rest Starter Kit 填补了 WCF 3.5 遗漏的所有空白！

REST Starter Kit 有一个 ASP.NET 预发布组件，如**“软件按原样许可。”您承担使用它的风险。它可能永远不会作为稳定版本发布“** [查看许可证](http://aspnet.codeplex.com/license)

为了帮助您入门[，PluralSight](http://www.pluralsight.com/main/screencasts/default.aspx)提供了一些关于 REST 和 REST Starter Kit 的精彩视频教程。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-12T01:51:27.213

ASP.NET MVC 并不像其他东西。它是一种 Web 开发模型，是 WebForms 的替代品。

至于实现基于 REST 的 Web 服务，WCF 可能是要走的路。它几乎是设置一些额外的属性，配置单个 xml 文件，仅此而已。就基础架构而言，WCF 与现有的任何选择一样完整，因为它具有内置的带宽和并发性，如果您决定切换传输（例如，命名管道或 TCP）或希望切换到使用 SOAP，这是一个微不足道的开关。此外，跟踪是内置的，当出现问题时可以很方便。

最后一个选项可能是 Web 方法。如果您只是想通过 Ajax 启用网站，Web 方法可能会成功。

至于您是否缺少任何框架......如果您正在处理 MS 开发堆栈，不，仅此而已，除了仍然支持的经典 Web 服务。

如果您谈论的是非 MS 语言，那么所有各种语言（Java、Python、Ruby 等）都有半百种不同的 Web 服务标准。如果您不局限于 MS 技术，那么您应该明确这一点，因为它提供了大量的选项。

编辑：这并不是说你不能用 ASP.NET MVC 做基于 REST 的无视图接口。如果只是意味着您的基础设施为零，并且基本上将自己滚动。因此，没有负载处理、没有 DDOS 保护、没有容错等等……

# development-environment - 开发服务器上的基本要素是什么？

> ID：850764
> 
> 赞同：2
> 
> 时间：2009-05-12T01:30:23.003
> 
> 标签：development-environment

这是受问题“[如何处理家庭服务器？](https://stackoverflow.com/questions/46331/what-can-i-do-with-a-home-server) ”的启发。

到目前为止，我能想到：

*   持续集成构建服务器，如 luntbuild 或 Cruise controll
*   源代码控制
*   错误跟踪器/进程跟踪器
*   您在生产中拥有的所有工件的副本

关于什么：

*   IDE 和远程桌面？（虽然我个人认为 IDE 在客户端上仍然是最好的）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T01:58:19.213

用于文档、注释等的本地 wiki 服务器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T01:52:58.957

*   网络服务器
*   从开发迁移到测试的脚本
*   将测试迁移到生产环境的脚本
*   将您的 svn 备份到 S3 或类似的异地备份存储的脚本
*   vi/vim 因为你需要一个好的文本编辑器
*   sed、awk 和 ruby​​ 用于非常难的脚本

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T21:24:38.487

valgrind 和/或其他分析软件

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T21:37:36.013

事后[调试工具](http://www.microsoft.com/whdc/DevTools/Debugging/default.mspx)，适用于 Windows，即：

*   umdh（用于内存泄漏）
*   drwtsn32（用于崩溃），
*   cdb（从挂起的应用程序中获取小型转储），
*   windbg（检查小型转储）。

还在那里放置一个[符号服务器](http://entland.homelinux.com/blog/2006/07/06/setting-up-a-symbol-server/)来存储您自己的应用程序的符号（无需记住哪个集合对应于哪个版本的应用程序）

这些都是帮助调试应用程序的东西，就好像它们在客户机器上运行一样 - 而不是您的开发机器及其调试器、源代码、符号等。如果您可以在那里诊断问题，您可以使用现场工具来解决问题永远看不到你什么时候在家里运行它们。

还为您使用的开发工具放置一个文件共享并存储所有安装程序 - 这样您就可以轻松获得设置新开发工作站所需的所有位。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-12T01:46:15.380

某种调试器...

# c# - 打开打印机使用的串行端口

> ID：850765
> 
> 赞同：1
> 
> 时间：2009-05-12T01:31:15.450
> 
> 标签：c#, printing, serial-port, epson

我正在将 ESC/P 代码 ( [http://webpages.charter.net/dperr/links/esc_p83.htm](http://webpages.charter.net/dperr/links/esc_p83.htm) ) 发送到连接到 COM1 的 Epson LX-300 打印机，并且电脑已经安装了正确的驱动程序，因为别人需要它。

所以我写了这个：

```
using System.IO.Ports;

public class EpsonPrint {

    private char esc = (char)27;
    private char ff = (char)12;

    public static void Main (string[] args) {
        new EpsonPrint();
    }

    public EpsonPrint() {
        SerialPort port = new SerialPort("COM1", 19200, Parity.None, 8,  StopBits.One);
        port.Open();
        port.Write(esc+"@hola mundo!"+ff);
        port.Close();
    }
} 
```

它可以工作，但只能在 Epson 驱动程序指向另一个端口或其他东西的情况下工作，因为如果我让它使用 COM1，上面的代码会抛出：

“给定的端口名称不以 COM/com 开头或不解析为有效的串行端口。”

并且记录在案，这不是“端口已打开”错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-12T01:37:55.987

我认为您需要将其发送到驱动程序而不是端口。看看这篇文章：

[http://support.microsoft.com/kb/138594/EN-US/](http://support.microsoft.com/kb/138594/EN-US/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-02T08:23:26.567

COM1 由打印机驱动程序保持。这可以防止您的应用程序打开端口。尝试将打印机驱动程序属性中的打印机端口切换到 COM1 以外的端口。在此之后，您的应用程序将可以自由使用 COM1。

# c++ - 如何确定机器上的硬件（CPU 和 RAM）？

> ID：850774
> 
> 赞同：20
> 
> 时间：2009-05-12T01:37:52.243
> 
> 标签：c++, c, memory, hardware, cpu

我正在开发一个跨平台分析套件，并希望在每次运行的报告中添加有关机器 CPU（架构/时钟速度/内核）和 RAM（总数）的信息。目前我需要针对 Windows 和 Unix，所以我需要从这两个平台获取这些信息的方法，有什么线索吗？

**编辑：**感谢您的出色回答，现在我得到了 CPU 架构、CPU 内核数和总内存，但我仍然缺乏 CPU 的时钟速度，对此有什么想法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-12T01:53:34.637

这是在 Windows 机器上获取所需信息的一种方法。我从一个实际项目中复制并粘贴了它，并进行了一些小的修改，因此请随时清理它以使其更有意义。

```
 int CPUInfo[4] = {-1};
        unsigned   nExIds, i =  0;
        char CPUBrandString[0x40];
        // Get the information associated with each extended ID.
        __cpuid(CPUInfo, 0x80000000);
        nExIds = CPUInfo[0];
        for (i=0x80000000; i<=nExIds; ++i)
        {
            __cpuid(CPUInfo, i);
            // Interpret CPU brand string
            if  (i == 0x80000002)
                memcpy(CPUBrandString, CPUInfo, sizeof(CPUInfo));
            else if  (i == 0x80000003)
                memcpy(CPUBrandString + 16, CPUInfo, sizeof(CPUInfo));
            else if  (i == 0x80000004)
                memcpy(CPUBrandString + 32, CPUInfo, sizeof(CPUInfo));
        }
        //string includes manufacturer, model and clockspeed
        cout << "CPU Type: " << CPUBrandString << endl;

        SYSTEM_INFO sysInfo;
        GetSystemInfo(&sysInfo);
        cout << "Number of Cores: " << sysInfo.dwNumberOfProcessors << endl;

        MEMORYSTATUSEX statex;
        statex.dwLength = sizeof (statex);
        GlobalMemoryStatusEx(&statex);
        cout << "Total System Memory: " << (statex.ullTotalPhys/1024)/1024 << "MB" << endl; 
```

有关详细信息，请参阅[GetSystemInfo](http://msdn.microsoft.com/en-us/library/ms724381%28VS.85%29.aspx)、[GlobalMemoryStatusEx](http://msdn.microsoft.com/en-us/library/aa366589%28VS.85%29.aspx)和[__cpuid](http://msdn.microsoft.com/en-us/library/hskdteyh%28VS.80%29.aspx)。虽然我没有包含它，但您也可以通过 GetSystemInfo 函数确定操作系统是 32 位还是 64 位。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-12T01:44:08.643

在 Windows 上，您可以使用[GlobalMemoryStatusEx](http://msdn.microsoft.com/en-us/library/aa366589(VS.85).aspx)来获取实际 RAM 的数量。

处理器信息可以通过[GetSystemInfo](http://msdn.microsoft.com/en-us/library/ms724381(VS.85).aspx)获得。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2018-04-25T11:54:56.413

对于带有 GCC 的 Linux，您可以使用非常相似的解决方案，例如 windows。您需要包含并且需要基于[此](http://agentzh.org/misc/code/gdb/nat/x86-gcc-cpuid.h.html#L147)`<cpuid.h>`修改方法的输入。`__cpuid()`

```
#include <cpuid.h>

char CPUBrandString[0x40];
unsigned int CPUInfo[4] = {0,0,0,0};

__cpuid(0x80000000, CPUInfo[0], CPUInfo[1], CPUInfo[2], CPUInfo[3]);
unsigned int nExIds = CPUInfo[0];

memset(CPUBrandString, 0, sizeof(CPUBrandString));

for (unsigned int i = 0x80000000; i <= nExIds; ++i)
{
    __cpuid(i, CPUInfo[0], CPUInfo[1], CPUInfo[2], CPUInfo[3]);

    if (i == 0x80000002)
        memcpy(CPUBrandString, CPUInfo, sizeof(CPUInfo));
    else if (i == 0x80000003)
        memcpy(CPUBrandString + 16, CPUInfo, sizeof(CPUInfo));
    else if (i == 0x80000004)
        memcpy(CPUBrandString + 32, CPUInfo, sizeof(CPUInfo));
}

cout << "CPU Type: " << CPUBrandString << endl; 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-12T02:43:52.277

在 Windows 上确定 CPU 时钟速度：

```
double CPUSpeed()
{
    wchar_t Buffer[_MAX_PATH];
    DWORD BufSize = _MAX_PATH;
    DWORD dwMHz = _MAX_PATH;
    HKEY hKey;

    // open the key where the proc speed is hidden:
    long lError = RegOpenKeyEx(HKEY_LOCAL_MACHINE,
                                L"HARDWARE\\DESCRIPTION\\System\\CentralProcessor\\0",
                                0,
                                KEY_READ,
                                &hKey);
    if(lError != ERROR_SUCCESS)
    {// if the key is not found, tell the user why:
        FormatMessage(FORMAT_MESSAGE_FROM_SYSTEM,
                        NULL,
                        lError,
                        0,
                        Buffer,
                        _MAX_PATH,
                        0);
        wprintf(Buffer);
        return 0;
    }

    // query the key:
    RegQueryValueEx(hKey, L"~MHz", NULL, NULL, (LPBYTE) &dwMHz, &BufSize);
    return (double)dwMHz;
} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-12T01:41:26.760

CPU很简单。使用`cpuid`说明。我将留下其他海报以找到一种便携式方法来确定系统有多少 RAM。:-)

对于特定于 Linux 的方法，您可以访问`/proc/meminfo`（并且`/proc/cpuinfo`，如果您懒得解析`cpuid`响应）。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-05-12T01:42:10.473

在 Linux 上，您可以解析 /proc/cpuinfo（包含每个处理器的信息块）和 /proc/meminfo（包含各种通用内存统计信息，包括 MemTotal）。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-10-19T06:58:38.947

我很晚了，但这是我的贡献。我试图采用更现代的 C++ 方法。

```
 #include <intrin.h> // NOTE this header is MSVC specific!
    #include <string>
    #include <array>

    std::string GetCpuInfo()
    {
        // 4 is essentially hardcoded due to the __cpuid function requirements.
        // NOTE: Results are limited to whatever the sizeof(int) * 4 is...
        std::array<int, 4> integerBuffer = {};
        constexpr size_t sizeofIntegerBuffer = sizeof(int) * integerBuffer.size();

        std::array<char, 64> charBuffer = {};

        // The information you wanna query __cpuid for.
        // https://docs.microsoft.com/en-us/cpp/intrinsics/cpuid-cpuidex?view=vs-2019
        constexpr std::array<int, 3> functionIds = {
            // Manufacturer
            //  EX: "Intel(R) Core(TM"
            0x8000'0002,
            // Model
            //  EX: ") i7-8700K CPU @"
            0x8000'0003,
            // Clockspeed
            //  EX: " 3.70GHz"
            0x8000'0004
        };

        std::string cpu;

        for (int id : functionIds)
        {
            // Get the data for the current ID.
            __cpuid(integerBuffer.data(), id);

            // Copy the raw data from the integer buffer into the character buffer
            std::memcpy(charBuffer.data(), integerBuffer.data(), sizeofIntegerBuffer);

            // Copy that data into a std::string
            cpu += std::string(charBuffer.data());
        }

        return cpu;
    } 
```

这是我自己使用此功能的结果：“Intel(R) Core(TM) i7-8700K CPU @ 3.70GHz”

老实说，这样的事情还没有标准化真的很烦人......

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-03-17T20:24:36.157

OP 想要一个可在 Windows 和 Linux 之间移植的 CPU 时钟速度计算例程。干得好：

```
#ifdef WIN32
#define WIN32_LEAN_AND_MEAN
#include <windows.h>
typedef unsigned __int64 usCount;
static usCount GetUsCount()
{
    static LARGE_INTEGER ticksPerSec;
    static double scalefactor;
    LARGE_INTEGER val;
    if(!scalefactor)
    {
        if(QueryPerformanceFrequency(&ticksPerSec))
            scalefactor=ticksPerSec.QuadPart/1000000000000.0;
        else
            scalefactor=1;
    }
    if(!QueryPerformanceCounter(&val))
        return (usCount) GetTickCount() * 1000000000;
    return (usCount) (val.QuadPart/scalefactor);
}
#else
#include <sys/time.h>
#include <time.h>
#include <sched.h>
typedef unsigned long long usCount;
static usCount GetUsCount()
{
#ifdef CLOCK_MONOTONIC
    struct timespec ts;
    clock_gettime(CLOCK_MONOTONIC, &ts);
    return ((usCount) ts.tv_sec*1000000000000LL)+ts.tv_nsec*1000LL;
#else
    struct timeval tv;
    gettimeofday(&tv, 0);
    return ((usCount) tv.tv_sec*1000000000000LL)+tv.tv_usec*1000000LL;
#endif
}
#endif
static usCount usCountOverhead, CPUClockSpeed;
#ifdef __GNUC__
#include "x86intrin.h"
#define __rdtsc() __builtin_ia32_rdtsc()
#endif
static usCount GetClockSpeed()
{
  int n;
  usCount start, end, start_tsc, end_tsc;
  if(!usCountOverhead)
  {
    usCount foo=0;
    start=GetUsCount();
    for(n=0; n<1000000; n++)
    {
      foo+=GetUsCount();
    }
    end=GetUsCount();
    usCountOverhead=(end-start)/n;
  }
  start=GetUsCount();
  start_tsc=__rdtsc();
  for(n=0; n<1000; n++)
#ifdef WIN32
    Sleep(0);
#else
    sched_yield();
#endif
  end_tsc=__rdtsc();
  end=GetUsCount();
  return (usCount)((1000000000000.0*(end_tsc-start_tsc))/(end-start-usCountOverhead));
} 
```

显然，这只适用于 x86/x64，并且它依赖于 TSC 以与 CPU 相同的速度计数。如果你做了一些奇怪的超频事情，例如在我的身上，我超频了 FSB，但降低了倍频器以保持核心时钟符合规格，因此 TSC 将以 FSB 乘以最大倍频器计数，这太快了。

为了获得最佳结果，在运行 GetClockSpeed() 之前，我建议您运行一个反 SpeedStep 循环，例如

```
usCount start;
start=GetUsCount();
while(GetUsCount()-start<3000000000000ULL);
CPUClockSpeed=GetClockSpeed(); 
```

尼尔

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-12T02:15:09.530

在 Solaris 上：

-为了记忆

```
 prtconf | grep Memory 
```

-CPU用

```
 psrinfo -v | grep MHz 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-12T04:19:24.973

[http://en.wikipedia.org/wiki/CPUID](http://en.wikipedia.org/wiki/CPUID)可能对 CPUID 有帮助

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-10-28T04:43:30.143

bsruth 在此页面上最接受的答案使用 __cpuid 不必要地循环通过不需要的扩展函数。如果您只需要知道处理器品牌字符串，则无需查询 0x80000000。

维基百科对示例代码有一个很好的解释： [https ://en.wikipedia.org/wiki/CPUID#EAX=80000002h,80000003h,80000004h:_Processor_Brand_String](https://en.wikipedia.org/wiki/CPUID#EAX=80000002h,80000003h,80000004h:_Processor_Brand_String)

```
#include <cpuid.h>  // GCC-provided
#include <stdio.h>
#include <stdint.h>

int main(void) {
    uint32_t brand[12];

    if (!__get_cpuid_max(0x80000004, NULL)) {
        fprintf(stderr, "Feature not implemented.");
        return 2;
    }

    __get_cpuid(0x80000002, brand+0x0, brand+0x1, brand+0x2, brand+0x3);
    __get_cpuid(0x80000003, brand+0x4, brand+0x5, brand+0x6, brand+0x7);
    __get_cpuid(0x80000004, brand+0x8, brand+0x9, brand+0xa, brand+0xb);
    printf("Brand: %s\n", brand);
} 
```

这是我想出的将其直接转换为 c++ 中的 std::string 的版本

```
std::string CPUBrandString;
CPUBrandString.resize(49);
uint *CPUInfo = reinterpret_cast<uint*>(CPUBrandString.data());
for (uint i=0; i<3; i++)
    __cpuid(0x80000002+i, CPUInfo[i*4+0], CPUInfo[i*4+1], CPUInfo[i*4+2], CPUInfo[i*4+3]);
CPUBrandString.assign(CPUBrandString.data()); // correct null terminator
std::cout << CPUBrandString << std::endl; 
```

此版本适用于 linux，但对于使用 __cpuid 的 windows 应该不难理解

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-05-23T14:49:25.193

我编写了一些使用 WMI 服务来获取最大时钟速度的代码，我知道它是 VB.net，但它显示了这个想法：

```
''' <summary>
''' Use WMI to get the Clock Speed in Hz
''' </summary>
Public Function GetMaxClockSpeedInHz() As Double
    Dim manObj = New ManagementObject("Win32_Processor.DeviceID='CPU0'")
    manObj.Get()
    GetMaxClockSpeedInHz = Convert.ToInt32(manObj.Properties("MaxClockSpeed").Value)
End Function 
```

Win32_OperatingSystem 参考：http: [//msdn.microsoft.com/en-us/library/Aa394239](http://msdn.microsoft.com/en-us/library/Aa394239)

WMI 参考： http: [//msdn.microsoft.com/en-us/library/aa394572 (v=VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa394572(v=VS.85).aspx)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-01-24T14:27:13.573

对于 Windows 和 Win32 C++ 项目：

[http://www.codeguru.com/cpp/wp/system/hardwareinformation/article.php/c9087/Three-Ways-to-Retrieve-Processor-Information.htm](http://www.codeguru.com/cpp/w-p/system/hardwareinformation/article.php/c9087/Three-Ways-to-Retrieve-Processor-Information.htm)

上面的 URL 和包含的文章演示了在 Windows 上检索 CPU 信息的 3 种不同方法。源代码在文章的底部，写得很好，并且包含三个有用的类，您可以从您的 Win32 C++ 代码中调用它们。

# jquery - ASP.Net + jQuery + jQuery 验证插件 + UpdatePanel + nyroModal - 在每个字段上成功触发！

> ID：850777
> 
> 赞同：3
> 
> 时间：2009-05-12T01:40:48.790
> 
> 标签：jquery, asp.net-ajax, updatepanel, jquery-validate, nyromodal

我有一个表单，其中包含用户用价格（数字）填充的输入字段列表。我已将他们的 css 类设置为“必需”和“数字”，以便 jQuery 验证插件相应地验证它们。所有这些都运行良好。当每个字段不是数字或缺少值等时会显示错误。

整个表单实际上位于 nyroModal（jQuery 插件）模型弹出窗口中。但这不重要，它只是一个 .aspx 网络表单。其中，我还使用了一个 UpdatePanel 并将所有内容都放入其中，因为我的表单本质上是一个 2 阶段过程。用户必须在表单的第一个“页面”上完成一些基本步骤。当验证并工作时，我只是在 UpdatePanel 中隐藏/显示一些元素，以向用户显示表单的下一个“页面”，即如上所述的所有价格文本框输入字段。

我使用 ImageButton 作为验证表单的触发点。默认情况下，如果您只保留 ImageButton 的原样，.Net 将触发回发，在我的情况下是 AJAX 回发，因为它全部发生在 UpdatePanel 中。这又是需要的。出于明显的原因，我不想要丑陋的完整回发。

经过大量阅读后，我需要一种在 javascript 中附加到 .Net 的 PageRequestManager 的方法，以便我可以根据 jQuery 是否成功验证表单来拦截 .Net 想要进行回发的时间。所以我的逻辑是：默认情况下，不允许回发，但是当 jQuery 成功验证表单时，设置一个变量表示现在允许回发，然后下次回发尝试发生时，它将通过。因此向用户显示成功。

这一切都运行得相当好，但还有一个最后一个问题。

jQuery 验证插件的 validate({success}) 选项似乎在每个单独的字段验证成功后被错误地触发，而不是整个表单。即，如果我在任何一个价格输入字段中输入一个数字，此成功选项将触发并将我的 cancelPostback 变量设置为 false，这反过来意味着表单现在提交，即使它尚未经过验证，只是因为一个字段是有效的。我本来希望这个 validate({success}) 选项只有在整个表单被验证后才会触发。

我是否错误地解释了这一点，实际上它在做它应该做的事情？如果是这样，我如何才能仅在验证整个表单时才将我的 cancelPostback 变量设置为 true？

非常感谢您提供任何见解或提醒。

我实现验证并拦截 .Net 回发事件的 jQuery 代码如下：

```
<script type="text/javascript">
    // By default, don't allow Postback until we've successfully validated our form on the client-side.
    var cancelPostback=true;

    // Every single time the page loads, including every single AJAX partial postback
    function pageLoad()
    {
        // Reset the value to say that "We don't allow Postbacks at this stage"..
        cancelPostback=true;

        // Attach client-side validation to the main form
        $("#<%= form1.ClientID %>").validate({ success: function() { alert('validation succeeded!'); cancelPostback = false; } });

        // Grab a reference to the Page Request Manager
        var prm = Sys.WebForms.PageRequestManager.getInstance();
        prm.add_initializeRequest(onEachRequest);

        alert("Page Load");
    }

    // Our own custom method to be attached to each new/future page request..
    function onEachRequest(sender, args)
    {
        alert("About to cancel? " + cancelPostback);
        // Check to see if we need to Cancel this Postback based on Conditional Logic within this page..
        args.set_cancel(cancelPostback);
    }
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-06-30T16:02:09.203

我的解决方案有问题，因为除了 IE 之外的所有浏览器都在 jQuery 验证器的 submitHandler() 函数之前触发了“onEachRequest”函数。我想出了一个更优雅的解决方案，如果验证失败，它会简单地取消回发，而不是依赖预设变量。

```
 Sys.Application.add_init(function() {
    var prm = Sys.WebForms.PageRequestManager.getInstance();
    prm.add_initializeRequest(onEachRequest);
  }); 

  function onEachRequest(sender, args) {
    if (args.get_postBackElement().id == <%= [YourSubmitButton].ClientID %>) {
      args.set_cancel(!$('#aspnetForm').valid());
    }
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T04:55:18.753

感谢 heaps tvanfosson 的及时帮助。

好的更新：

我关注了越来越多的链接，最终找到了“成功”的文档。插件自己主页上的文档很糟糕，并且省略了许多关键功能:) 但在官方 jQuery 页面上它“更好”。“成功”选项旨在每次成功验证单个字段时触发。所以这是按设计工作的，我错误地假设它只会在整个表单有效时触发。

我试过你的 invalidHandler 想法。我喜欢这个主意。我遇到的一个问题是 ImageButton 的回发仍然会首先触发，因此它会在 invalidHandler 代码运行之前开始回发。所以回发仍然会继续，然后，invalidHandler 将禁用未来的回发，不幸的是它们以错误的顺序触发。但除此之外，它还显示出完美解决方案的所有其他迹象。

然后我又尝试了 submitHandler 方式，即相反的方式。再次，这遇到了一些顺序问题，因为回发会再次首先触发，但被阻止，然后 submitHandler 将允许以后的回发，但已经太晚了，所以这个回发被错过了。您必须再次单击该按钮两次才能启动它。

所以最终的半杂乱无章的解决方案，说实话还不错，是：

我将此行更改为： // 将客户端验证附加到主表单 $("#<%= form1.ClientID %>").validate({ submitHandler: function() { PreventPostback = false; __doPostBack('UpdatePanel1' , ''); } });

如您所见，它首先切换了 PreventPostback 变量，然后手动触发了新的回发，因为第一次回发已经被阻止并终止了。因此，此手动 __doPostBack 调用可确保根据 PreventPostback 的新值触发新的回发。

我从 ImageButtons 后面删除了事件方法，并在服务器端代码中创建了一个名为“DoPostBackLogic()”的新方法，该方法仅在页面回发时调用，我知道这一定来自此验证逻辑，因为那是我的表单上唯一可能发生的回发。然后所有的隐藏/显示/保存逻辑都在那里发生。这意味着当我手动调用 __doPostBack 时，我可以简单地使用 UpdatePanel 的 ID，而不必担心模仿特定的 ImageButton 等。

这样它就可以完美地工作。默认情况下禁用回发，当表单有效时，允许回发，但随后手动触发回发以使新值生效。

所以这基本上是您的第二个解决方案，再次感谢您的聆听和分享！:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T02:27:59.493

我建议查看 submitHandler 和 invalidHandler 选项。一个或另一个应该为你想要的工作。我认为最好的方法是默认允许回发，并在 invalidHandler 中将 cancelPostback 设置为 true。或者，您可以编写自己的 submitHandler 直接调用 __doPostBack 并通过 ImageButton 替换提交。

# javascript - 使用 Javascript 进行面向对象编程 - 构造函数

> ID：850781
> 
> 赞同：2
> 
> 时间：2009-05-12T01:41:47.760
> 
> 标签：javascript, oop, object, function

我见过很多这样的...

```
function myObject(data) {
       var myData = data;
}

myObject.prototype.doSomething = function () {
      alert("I did something!");
} 
```

但是Visual Studio上的智能感知给了我一个函数的.constructor，这会让我相信这是正确的......

```
function myObject() {
     var myData;

     this.constructor = function(data) {
         myData = data;
     }

     this.doSomething = function() {
         alert("I did something!");
     }
} 
```

我喜欢第二种方法的封装，但几乎每个人都使用“.prototype”。是否有任何理由特别这样做，或者像这样封装所有类方法是否可以。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T01:50:26.200

看一眼：

*   [JavaScript 中的私有成员](http://javascript.crockford.com/private.html)
*   [JavaScript 中的原型继承](http://javascript.crockford.com/prototypal.html)
*   [JavaScript 中的经典继承](http://javascript.crockford.com/inheritance.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T01:50:02.380

这根本不是什么`constructor`。它只是返回函数。所以在你的情况下，它会返回`myObject`. 例如：

```
function someObject() {
  this.a = 5;
}
var obj = new someObject();
obj.constructor; // Would return someObject 
```

有关[该](http://www.w3schools.com/jsref/jsref_constructor_boolean.asp)`constructor`物业的更多详细信息，请参阅此处。

使用的要点`prototype`是您可以在创建构造函数后对其进行扩展。因此，您可以使用它来为所有 String 对象添加方法。

```
String.prototype.myFunc = function(){/*Some code*/}; 
```

# nhibernate - 如何输出 Fluent NHibernate 创建的 HBM？

> ID：850784
> 
> 赞同：6
> 
> 时间：2009-05-12T01:43:55.913
> 
> 标签：nhibernate, fluent-nhibernate, mapping, hbm

我正在尝试调试我的流利应用程序，并想看看生成的文件是什么样的。

有哪些查看方式？

有没有办法导出它们？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-12T01:46:11.090

没关系！

.Mappings(m => m.FluentMappings.ExportTo("路径"))

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T11:34:37.697

还

.Mappings(m => m.AutoMappings.ExportTo("路径"))

:)

# php - XML 表单验证？

> ID：850787
> 
> 赞同：0
> 
> 时间：2009-05-12T01:44:49.003
> 
> 标签：php, xml, validation

是否有一个简单的表单验证，它运行一个 XML 文件来控制 HTML、Javascript 和 PHP 的生成，实际上也会遵循规则？

现在完成的方式我必须将两者分开。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T01:51:02.283

从来没听说过。我能做的最好的事情是使用 jQuery[验证插件](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)，然后通过使其和我的服务器端验证引用相同的配置变量来使验证规则通用，我通过 $_SESSION 数组传递这些变量。

编辑：实际上，我似乎记得 PEAR [HTML_QuickForm2](http://pear.php.net/package/HTML_QuickForm2)类做了一个合理的工作，但我出于我的目的拒绝了它，因为它产生的 HTML 代码不符合标准（至少对 XHTML 严格）并且它不'在布局灵活性方面没有足够的空间。

# c# - ListView 项目激活延迟

> ID：850789
> 
> 赞同：1
> 
> 时间：2009-05-12T01:45:44.850
> 
> 标签：c#, .net, vb.net, listview

我有一个带有 HotTracking 的 Activation 属性的 ListView。在用户单击项目和事件触发之间似乎有大约 2 秒的延迟。有没有办法让事件在用户点击后立即触发？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-09-17T09:03:03.933

我发现没有办法改变这个延迟，它是一个内置设置。

问题是，MouseDown 事件实际上有一个延迟反应，只有在它触发**后才设置 SelectedItems 属性。**

您必须手动执行此操作：使用 MouseClick 事件。如果单击某个项目，即使它已被选中，这也会触发。单击空白区域时*不会*触发。

```
Private Sub list_MouseClick(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles list.MouseClick
    Dim item As ListViewItem = list.GetItemAt(e.X, e.Y)
    If Not IsNothing(item) Then
        do your stuff here
    End If
End Sub 
```

您可以通过处理此事件来模拟热跟踪

```
Private Sub list_MouseMove(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles list.MouseMove
    Dim item As ListViewItem = list.GetItemAt(e.X, e.Y)
    If Not IsNothing(item) Then
        list.SelectedItems.Clear()
        item.Selected = True
    End If
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-21T03:00:18.280

是的，请改用 SelectedIndexChanged 事件！

# iphone - iPhone OS 3.0 访问剪贴板

> ID：850793
> 
> 赞同：1
> 
> 时间：2009-05-12T01:46:36.097
> 
> 标签：iphone, objective-c, cocoa-touch, iphone-sdk-3.0

我正在实现一个带有语法突出显示的自定义文本编辑器，我想将它集成到 OS 3.0 剪贴板系统中。所以，我的问题是，有没有办法以编程方式设置/读取系统范围的剪贴板？

谢谢，

凯尔

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T05:33:45.180

搜索 UIPasteboardNameGeneral。

# python - 清除清单的不同方式

> ID：850795
> 
> 赞同：228
> 
> 时间：2009-05-12T01:46:55.630
> 
> 标签：python, list

当您想在 Python 中清除列表时，是否有任何理由做比这两行之一更复杂的事情？

```
old_list = []
old_list = list() 
```

我问的原因是我刚刚在一些正在运行的代码中看到了这一点：

```
del old_list[ 0:len(old_list) ] 
```

* * *

## 回答 #1

> 赞同：377
> 
> 时间：2009-05-12T02:03:16.583

清除列表将影响同一列表的所有其他引用。

例如，此方法不会影响其他引用：

```
>>> a = [1, 2, 3]
>>> b = a
>>> a = []
>>> print(a)
[]
>>> print(b)
[1, 2, 3] 
```

但是这个可以：

```
>>> a = [1, 2, 3]
>>> b = a
>>> del a[:]      # equivalent to   del a[0:len(a)]
>>> print(a)
[]
>>> print(b)
[]
>>> a is b
True 
```

你也可以这样做：

```
>>> a[:] = [] 
```

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2017-06-03T23:25:34.087

Doing`alist = []`不会清除列表，只是创建一个空列表并将其绑定到变量`alist`。如果旧列表有其他变量绑定，它仍然存在。

*要真正就地*清除列表，您可以使用以下任何一种方式：

1.  `alist.clear() # Python 3.3+, most obvious`
2.  `del alist[:]`
3.  `alist[:] = []`
4.  `alist *= 0 # fastest`

有关更多详细信息，请参阅[可变序列类型](https://docs.python.org/dev/library/stdtypes.html#typesseq-mutable)文档页面。

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2012-10-19T08:23:54.067

有一种非常简单的方法可以清除 python 列表。使用**del list_name[:]**。

例如：

```
>>> a = [1, 2, 3]
>>> b = a
>>> del a[:]
>>> print a, b
[] [] 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-05-12T02:03:32.217

~~在我看来，del 会将内存还给你，而分配一个新列表将使旧列表仅在 gc 运行时才被删除。物质。~~

这对于大型列表可能很有用，但对于小型列表应该可以忽略不计。

**编辑**：作为 Algorias，没关系。

注意

```
del old_list[ 0:len(old_list) ] 
```

相当于

```
del old_list[:] 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-05-25T05:22:54.277

```
del list[:] 
```

将删除该列表变量的值

```
del list 
```

将从内存中删除变量本身

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-05-12T07:13:48.387

在两种情况下，您可能需要清除列表：

1.  您想`old_list`在代码中进一步使用该名称；
2.  您希望尽快对旧列表进行垃圾收集以释放一些内存；

在案例 1 中，您只需继续分配：

```
 old_list = []    # or whatever you want it to be equal to 
```

在情况 2 中，该语句将减少对名称指向`del`的列表对象的引用计数。`old list`如果列表对象仅由名称`old_list`at 指向，则引用计数将为 0，并且该对象将被释放以进行垃圾回收。

```
 del old_list 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-07-07T13:41:34.557

如果您正在清除列表，那么您显然不再需要该列表。如果是这样，您可以通过简单的 del 方法删除整个列表。

```
a = [1, 3, 5, 6]
del a # This will entirely delete a(the list). 
```

但如果您再次需要它，您可以重新初始化它。或者只是简单地清除它的元素

```
del a[:] 
```

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2016-02-01T20:28:09.440

另一个可以正常工作的解决方案是创建空列表作为参考空列表。

```
empt_list = [] 
```

例如，您有一个列表为 `a_list = [1,2,3]`. 要清除它，只需执行以下操作：

```
a_list = list(empt_list) 
```

这将创建`a_list`一个空列表，就像`empt_list`.

# c++ - 指针的意义何在？

> ID：850796
> 
> 赞同：26
> 
> 时间：2009-05-12T01:47:41.930
> 
> 标签：c++, pointers

当我可以声明变量时，C++ 中的指针有什么意义？什么时候适合使用它们？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-05-12T02:11:21.393

指针最好通过 C 和 C++ 在将变量传递给函数方面的差异来理解。

是的，您可以传递整个变量或仅传递指向它的指针（行话分别是按值或引用）。

但是，如果变量是 20 兆字节数组，就像您决定将整个文件读入一个数组一样怎么办？通过值传递它是愚蠢的：你为什么要为这个操作复制 20 兆，如果你最终修改它（即它是一个外参数），你必须把那 20 兆复制回来？

更好的是只是“指向”它。你说，“这是一个指向一大块内存的指针”。那个小小的间接节省了大量的时间。

一旦你明白这一点，其他一切都基本相同。重新排列列表中的项目只是交换指针而不是复制每个项目，当你开始时你不需要知道事情有多大等等

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-12T01:53:48.240

指针在处理在编译时大小和形状未知的数据结构（想想列表、树、图形、数组、字符串等）时最有用。

**编辑**

这些相关答案也可能有所帮助（第二个链接中的最佳答案绝对值得一看）：

[在 C++ 中我无法掌握指针和类](https://stackoverflow.com/questions/96285/in-c-i-cannot-grasp-pointers-and-classes)

[理解指针的障碍是什么，可以做些什么来克服它们？](https://stackoverflow.com/questions/5727/what-are-the-barriers-to-understanding-pointers-and-what-can-be-done-to-overcome)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T01:56:48.500

指针也非常适合将可变参数传递给函数，以便调用者可以“看到变化”。您可能想知道，“但为什么不使用参考呢？”。我喜欢谷歌的论点：

[http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml#Reference_Arguments](http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml#Reference_Arguments)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T01:57:15.097

我在学习指针时遇到了完全相同的问题，它们似乎并不重要，但是随着您的进步，您会发现它们有时非常有用。

指针经常用于编程情况。例如，当您按名称引用数组时，例如 `array[i] = 3;` 编译器正在做一些花哨的数学运算，最终将该代码转换为

(数组地址) + (sizeof(数组元素) * i) = 3;

它们还使树、链表和其他数据结构成为可能，随着您了解更多，您会发现这些。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-12T02:26:00.713

在最基本的层面上，指针允许您关联不相交的内存块。指针可以帮助您的一个简单（人为的，不可否认的）示例是在需要 1000000000000 个整数的数组的算法中。如果我尝试以下定义，这样的数组将太大而无法放入我现在正在输入的机器的 RAM 中：

```
int bigMatrix[1000000000000]; // I can't allocate this much contiguous memory 
```

但是，如果我创建一个指针数组，我可以将子数组保留在一个中等大小的磁盘阵列上。

```
int *bigMatrix[1000000]; // Each pointer refers to a sub-array 
                         // of 1000000 elements on disk 
```

诚然，如果/当用户需要它们时，我将不得不编写代码以在这些子数组中进行分页，包括将数组符号隐藏在访问器方法后面。也就是说，指针允许我在需要时创建我需要的临时关联。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-12T01:50:52.347

有时，您有一个函数需要返回一些不是固定数量的内存，例如从文件中读取。

```
bool ReadDataFromFile(char** contents); 
```

您将声明一个 char* 内容并将该指针的地址传递给函数。然后该函数将分配内存，您的指针将在返回时指向内容。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-12T02:40:55.697

除了效率和灵活性。C/C++ 中指针的主要观点是硬件是如何工作的，如果不使用指针，您将无法编写设备驱动程序、内存管理器或高效缓存。

第一个 C 编译器的主要设计目标之一是成为一种“可移植的汇编语言”，并且能够以更高级别的语言完成任何您可以使用传统汇编/机器代码执行的操作。这意味着能够直接操作地址——这就是指针的意义所在。

然而，遵循 KISS 原则不要使用指针，除非它们真的让事情变得更简单。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-12T02:44:50.840

从架构的角度来看，指针是对 0 .. n 关系建模的一种经济方式：

```
struct A {
  vector<const B *> *pBees;
  A() : pBees(nullptr) {}
  void notice_bee(const B *pB) { 
    if (!pBees)
      pBees = new vector<const B *>;
    pBees.push_back(pB)
  }
  ~A() { 
    delete pBees; // no need to test, delete nullptr is safe
  }
  size_t bees_noticed() { return pBees ? pBees->size : 0 }
}; 
```

如果绝大多数 A 对象永远不需要关注任何 B 对象，那么每个 A 对象都没有理由应该有一个零长度向量。在 Gnu C++ 4.0.1 下，sizeof(vector) 为 12；sizeof(vector *) 为 4。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-08T16:16:31.323

在我看来，您还没有了解动态内存分配。C++中有两种分配内存的方法：静态和动态。您已经熟悉静态分配（即 - 声明变量）。如果您在编写程序时确切地知道您需要多少变量（或者更确切地说是内存），那就太好了。

但如果你不这样做呢？例如，假设您正在阅读包含一堆您需要跟踪的数字。为什么？我不知道，但这不是重点。

那么你可以从一个数组开始：

```
int array[100]; 
```

But what if there are more than 100 numbers in the file? Eventually you'll want a more flexible solution:

```
int *array = new int[size];
// do stuff
delete [] array; 
```

This gives you a lot more flexibility and lets you create more dynamic data structures.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-04-19T00:32:27.450

Pointers store a memory address, so you would use them whenever you needed the memory address of something. This can be useful for things such as memory management, knowing where your data is stored. My professor told us this is a beautiful thing for advance programs in terms of ensuring your data are contiguously located in memory (like c-style strings are).

Hope this is some form of help for you!

-Zen, a newbie at c++

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-06-08T15:59:09.703

假设您编写了一个文本编辑器。在这种情况下，您事先并不知道文档的大小。你可能很想声明类似的东西

```
  字符文档[10000]；

```

但肯定有一天，您会想在更大的文档上使用您的编辑器。所以这种尝试是徒劳的；您需要的是一种在*运行时*（而不是编译时）请求新内存的方法。

这样做的 C++ 方法是使用操作符 new，它返回一个指向新分配的内存的指针：

```
  char* pDocument = new char[getSizeOfDocument()];

```

（请注意，此示例过于简单。在现实生活中，您当然不会这样做，而是使用 std::string 和 std::vector 之类的东西，它们在内部为您执行此分配。）

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2009-05-12T02:23:16.957

来自[维基百科](http://en.wikipedia.org/wiki/Reference_%28C%2B%2B%29)：

> C++ 引用在几个基本方面不同于指针：
> 
> *   定义后不能直接引用引用对象；其名称的任何出现都直接引用它所引用的对象。
> *   一旦创建了引用，以后就不能再引用另一个对象；我们说它不能重新安装。这通常使用指针来完成。
> *   引用不能为空，而指针可以；每个引用都指向某个对象，尽管它可能有效也可能无效。
> *   引用不能未初始化。因为不可能重新初始化引用，所以它们必须在创建后立即初始化。特别是，局部和全局变量必须在定义它们的地方进行初始化，并且作为类实例数据成员的引用必须在类构造函数的初始化列表中进行初始化。

由于上述限制，指针是您作为引用对象的轻量级容器所获得的全部，特别是如果您正在做多态或动态的事情。代表窗口的纯抽象类指针的动态数组就是一个例子。

由于我懒得想一个多态的例子，我将从[cplusplus.com](http://www.cplusplus.com/doc/tutorial/polymorphism/)中提取一个：

```
// pointers to base class
#include <iostream>
using namespace std;

class CPolygon {
  protected:
    int width, height;
  public:
    void set_values (int a, int b)
      { width=a; height=b; }
  };

class CRectangle: public CPolygon {
  public:
    int area ()
      { return (width * height); }
  };

class CTriangle: public CPolygon {
  public:
    int area ()
      { return (width * height / 2); }
  };

int main () {
  CRectangle rect;
  CTriangle trgl;
  CPolygon * ppoly1 = &rect;
  CPolygon * ppoly2 = &trgl;
  ppoly1->set_values (4,5);
  ppoly2->set_values (4,5);
  cout << rect.area() << endl;
  cout << trgl.area() << endl;
  return 0;
} 
```

在上面的代码中，指针`CPolygon *`用于引用`CRectangle`对象和`CTriangle`对象。

# objective-c - 释放对象后使用它？

> ID：850798
> 
> 赞同：0
> 
> 时间：2009-05-12T01:47:59.137
> 
> 标签：objective-c, cocoa

我正在阅读 Aaron Hillegrass 为 Mac OS X 编写的 Cocoa Programming 并且遇到了一些我不明白的事情。在第 150-151 页，他创建了一个对象，将其释放，然后再次使用它。例如：

```
- (void) someMethod
{
    NSMutableArray *array = [[NSMutableArray alloc] init];
    NSString *str = [[NSString alloc] initWithString:"This is a string."];
    [array addObject:str];
    [str release];
    int x = [array indexOfObjectIdenticalTo:str];
    NSLog(@"the index of %@ in the array is %d", str, x);
} 
```

如果对象已被释放，这将如何工作？在方法完成或设置为 之前，对象是否仍然有效`nil`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T01:53:29.800

将它添加到数组中会增加引用计数，因此显式释放会将引用计数保留为 1。这不是一个好习惯（在完成引用之前不应释放某些东西），但在这种情况下它是安全的。

# python - 如何使用模式将文件过滤到使用 Python 的另一个文件？

> ID：850799
> 
> 赞同：0
> 
> 时间：2009-05-12T01:49:08.510
> 
> 标签：python, file-io

我有一本字典。我只想获取包含简单单词模式的单词（即“cow”）并将它们写入另一个文件。每行以一个单词开头，然后是定义。我对python还是很陌生，所以我没有很好地掌握语法，但是我脑海中的伪代码看起来像：

```
infile = open('C:/infile.txt')
outfile = open('C:/outfile.txt')

pattern = re.compile('cow')

for line in infile:
  linelist = line.split(None, 2)
  if (pattern.search(linelist[1])
    outfile.write(listlist[1])

outfile.close()
infile.close() 
```

我遇到了很多错误，任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T02:03:02.780

```
import re

infile  = open('C:/infile.txt')
outfile = open('C:/outfile.txt', 'w')

pattern = re.compile('^(cow\w*)')

for line in infile:
    found = pattern.match(line)
    if found:
        text = "%s\n" % (found.group(0))
        outfile.write(text)

outfile.close()
infile.close() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-21T09:14:01.857

使用 'with open' 和过滤器

```
import re
pattern = re.compile('^(cow\w*)')

with open(outfile,"w") as fw:
  with open(infile,"r") as f:
    for outline in filter(lambda x: not pattern.match(x.strip()),f):
      fw.write(outline) 
```

# c# - 使用 System.Diagnostics.Process 在命令行上输入文件

> ID：850802
> 
> 赞同：9
> 
> 时间：2009-05-12T01:50:11.927
> 
> 标签：c#, command-line

我正在尝试在文件中运行命令行程序和管道。该命令在命令行上运行良好，但我似乎无法让它与 C# 中的 Process 对象一起使用。这是我发出的命令：

"C:\Servers\CollabNet Subversion Server\svnadmin" 加载 C:\Repositories\TestLoad < C:\Temp\test.dump

此函数适用于我传递给它的所有其他命令，除了上面的命令：

```
public static bool ExecuteSvnCommand( string command, string arguments, out string result, out string errors )
{
    bool retval = false;
    string output = string.Empty;
    string errorLines = string.Empty;
    Process svnCommand = null;
    var psi = new ProcessStartInfo( command );

    psi.RedirectStandardOutput = true;
    psi.RedirectStandardError = true;
    psi.WindowStyle = ProcessWindowStyle.Hidden;
    psi.UseShellExecute = false;
    psi.CreateNoWindow = true;

    try
    {
        Process.Start( psi );
        psi.Arguments = arguments;
        svnCommand = Process.Start( psi );

        StreamReader myOutput = svnCommand.StandardOutput;
        StreamReader myErrors = svnCommand.StandardError;
        svnCommand.WaitForExit();

        if ( svnCommand.HasExited )
        {
            output = myOutput.ReadToEnd();
            errorLines = myErrors.ReadToEnd();
        }

        // Check for errors
        if ( errorLines.Trim().Length == 0 )
        {
            retval = true;
        }
    }
    catch ( Exception ex )
    {
        string msg = ex.Message;
        errorLines += Environment.NewLine + msg;
    }
    finally
    {
        if (svnCommand != null)
        {
            svnCommand.Close();
        }
    }

    result = output;
        errors = errorLines;

    return retval;
} 
```

我已经尝试了这个功能的几种不同组合，但我无法让它工作。我不断收到“系统找不到指定的文件”消息。我已经做了大约一个星期了，我想我需要一些眼睛来看看我做错了什么。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-12T04:14:00.817

马克和卢克都给了我正确的方向。我不能使用任何一个答案，因为我必须这样做才能在 Linux 中与 Mono 一起运行。所以我最终按照建议写信给 StandardInput。这是有效的代码：

```
public static bool ExecuteSvnCommandWithFileInput( string command, string arguments, string filePath, out string result, out string errors )
{
    bool retval = false;
    string output = string.Empty;
    string errorLines = string.Empty;
    Process svnCommand = null;
    var psi = new ProcessStartInfo( command );

    psi.RedirectStandardInput = true;
    psi.RedirectStandardOutput = true;
    psi.RedirectStandardError = true;
    psi.WindowStyle = ProcessWindowStyle.Hidden;
    psi.UseShellExecute = false;
    psi.CreateNoWindow = true;

    try
    {
        Process.Start( psi );
        psi.Arguments = arguments;
        svnCommand = Process.Start( psi );

        var file = new FileInfo(filePath);
        StreamReader reader = file.OpenText();
        string fileContents = reader.ReadToEnd();
        reader.Close();

        StreamWriter myWriter = svnCommand.StandardInput;
        StreamReader myOutput = svnCommand.StandardOutput;
        StreamReader myErrors = svnCommand.StandardError;

        myWriter.AutoFlush = true;
        myWriter.Write(fileContents);
        myWriter.Close();

        output = myOutput.ReadToEnd();
        errorLines = myErrors.ReadToEnd();

        // Check for errors
        if ( errorLines.Trim().Length == 0 )
        {
            retval = true;
        }
    }
    catch ( Exception ex )
    {
        string msg = ex.Message;
        errorLines += Environment.NewLine + msg;
    }
    finally
    {
        if (svnCommand != null)
        {
            svnCommand.Close();
        }
    }

    result = output;
    errors = errorLines;

    return retval;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-12T02:13:30.593

我不是 100% 确定，但我的猜测是您必须使用其属性手动将数据推`test.dump`送到进程。`StandardInput`

否则，您可以尝试使用`cmd.exe`执行命令：

```
var psi = new ProcessStartInfo( "cmd.exe /c \"" + command "\"" ); 
```

原因是“>”、“<”和“|” 运算符由 shell 本身 (cmd.exe) 实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T02:13:10.797

我的猜测是您应该挂钩 StandardInput 并自己写入文件。您可以尝试使用 ShellExecute = true，但我不确定它是否有效。

# jquery - 使用不显眼的 JS 更新页面的两个不同部分（在带有 jQ uery 的 Rails 中）

> ID：850804
> 
> 赞同：0
> 
> 时间：2009-05-12T01:50:35.497
> 
> 标签：jquery, ruby-on-rails, ajax, unobtrusive-javascript

当用户单击我博客上的排序链接时，我想使用 AJAX 来拉入新帖子并更新排序链接部分。使用 RJS 会很容易，但我想保持我的 JS 不显眼，并且只用数据（并且没有代码）响应 AJAX 请求。

这就是我现在正在做的事情：

```
 $('a.order_by').livequery('click', function() {
    $.get(this.href, null, function(data) {
      // The server returns a blob of HTML with a div#posts
      // and a div#sorting
      $("#posts").partial_html(data, "#posts");
      $("#sorting").partial_html(data, "#sorting");
    });
    return false;
  }); 
```

这是`partial_html()`功能：

```
// Stolen from the jQuery source for $.load()
jQuery.fn.partial_html = function(data, selector) {
    $(this).html($("<div/>").append(data.replace(/<script(.|\s)*?\/script>/g, "")).find(selector));
} 
```

显然这有点恶心 - 这样做的正确方法是什么？（使用两个 's 会超级容易`$.load()`，但这需要一个多余的 HTTP 请求）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T03:19:21.080

```
 $("#posts").html($(data).filter("#posts").html());
  $("#sorting").html($(data).filter("#sorting").html()); 
```

为我工作。（虽然我不确定这是“正确”的做法）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T11:11:28.020

我认为这可能与我的问题[Rails 有关：不是灰烬，不是 JS 响应，而是](https://stackoverflow.com/questions/13137722/rails-not-ember-not-js-responses-but-something-in-between)我刚刚发布的介于两者之间的东西。让我们看看是否能找到正确的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T01:55:58.483

我会将返回的数据存储在一个变量（想想缓存）中`$.load()`，然后使用 jQuery 从该缓存中选择 div 并将其附加到 DOM 中`$.html()`

# cocoa - 循环中的 Cocoa 自动释放

> ID：850820
> 
> 赞同：0
> 
> 时间：2009-05-12T01:56:26.377
> 
> 标签：cocoa, memory, string, loops

（我已经阅读了 Apple 的内存管理指南，以及其他内存管理帮助，但我仍然对以下内容感到困惑）

我应该如何使用循环中的便捷方法进行内存管理？我是否需要显式创建一个自动释放池然后将其排空。还是这一切都是自动的？

例如

```
for (i=0; i<numFilePaths; i++) {
    // ...
    NSString *componentString = [someString lastPathComponent];
    // ...
} 
```

在此示例中，我反复从 lastPathComponent 获取一个新字符串。暂时忽略同一件事中的不礼貌，我应该如何处理这种内存管理情况？

'componentString' 根本不保留，它仅在循环内具有生命周期，仅用于与其他字符串进行比较。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-12T02:05:20.873

自动释放池仅在运行循环完成时才会被耗尽，通常是在方法结束时，当控制权返回给用户时。如果您发现自己多次运行循环，这将导致创建大量自动释放对象（这些对象将在内存中累积，直到您的方法结束），您可能需要创建一个本地自动释放池并自己排空它。

你可以通过实例化和释放一个新的来创建和释放一个本地自动释放池。

```
for (i=0; i<10000; i++) {
  NSAutoreleasePool *localPool = [[NSAutoreleasePool alloc] init];
  NSString *aString = [NSString string];
  [pool drain];
} 
```

如果创建和释放太多池，可能会影响性能，因此您可能需要检查一定数量的迭代（例如每 100 个循环左右）来创建和释放池。没有固定的数字，所以你必须玩一些。

更新：更新`[pool release]`以`[pool drain]`保持与 Marc Charbonneau 建议的垃圾收集的未来兼容性。

# sql - 返回部分不同/唯一的行

> ID：850827
> 
> 赞同：1
> 
> 时间：2009-05-12T02:01:17.680
> 
> 标签：sql, unique, distinct, partial, group-by

我需要创建一个查询，该查询按两列分组并根据条件返回一个附加列。

例如，假设我有以下列：

产品代码 | 序列号 | 数量 | 购买日期 | 客户ID

该表包含具有不同数量和购买日期的 ProductCode 和 SerialNumber 的重复组合。我想为 DatePurchased 返回具有最大（最近）值的行的 ProductCode、SerialNumber 和 Quantity。为了使事情更加复杂，必须对 CustomerID = 'xxx' 的所有行执行此操作。

有任何想法吗？？？

任何帮助表示赞赏。干杯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T02:06:24.350

假设唯一的 DatePurchased：

```
SELECT a.*
FROM Table as a
JOIN (
   SELECT ProductCode, SerialNumber, MAX(DatePurchased) as MaxDate 
   FROM Table
   GROUP BY ProductCode, SerialNumber
) as b ON
   a.ProductCode = b.ProductCode
   AND a.SerialNumber = b.SerialNumber
   AND a.DatePurchased = b.MaxDate
WHERE
   a.CustomerID = 'xxx' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T04:21:19.230

```
SELECT
     T1.ProductCode,
     T1.SerialNumber,
     T1.Quantity
FROM
     Some_Table T1
LEFT OUTER JOIN Some_Table T2 ON
     T2.ProductCode = T1.ProductCode AND
     T2.SerialNumber = T1.SerialNumber AND
     T2.CustomerID = T1.CustomerID AND
     T2.DatePurchased > T1.DatePurchased
WHERE
     T1.CustomerID = 'xxx' AND
     T2.ProductCode IS NULL 
```

# regex - 正则表达式前缀仅在后向断言中匹配

> ID：850830
> 
> 赞同：0
> 
> 时间：2009-05-12T02:03:14.120
> 
> 标签：regex

我正在尝试编写一个正则表达式来解析这样的（看似非常简单的）一段文本。

```
some stuff
First name: John
Last name: Smith
more stuff 
```

我想捕获名字和姓氏，所以我尝试了这样的正则表达式：

```
(?<=First name:\s*)(?<FirstName>\w+)(?<=\s*Last name:\s*)(?<LastName>\w+) 
```

这无法找到匹配项。每个部分（名字和姓氏）单独工作，但不能一起工作。此外，以下作品

```
(?<=John\s*Last name:\s*)(?<LastName>\w+) 
```

但是当我将“约翰”移出非匹配组时......

```
John(?<=\s*Last name:\s*)(?<LastName>\w+) 
```

……不匹配！

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T02:22:41.920

由于后视断言是零宽度（即它们不消耗任何字符），FirstName 捕获将匹配/捕获“First name:”之后的任何内容，在本例中为“John”。在第一次匹配之后，目标字符串中的位置将紧跟在“John”之后。但由于正则表达式的下一部分是另一个后视，正则表达式将查看其当前位置之前的内容是否与您的后视文本匹配，在本例中为“姓氏：”。由于它实际上前面是“John”，因此整个正则表达式都失败了，甚至从未到达“Smith”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T02:11:33.217

刚刚意识到我可能不需要后视，因为以下工作：

```
First name:\s*(?<FirstName>\w+)\s*Last name:\s*(?<LastName>\w+) 
```

不过，我很想知道为什么它不适用于后视以备将来参考。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T02:12:53.963

我认为您需要确保换行符在您使用的任何正则表达式语言中都是可匹配的。

在 Python 中，这意味着传递`re.DOTALL`给您正在使用的`re.compile()`任何函数。`re`在 Perl 中，`s`在最后一个斜杠之后添加。

# c# - C#/.NET：字典内存使用

> ID：850833
> 
> 赞同：6
> 
> 时间：2009-05-12T02:03:39.360
> 
> 标签：c#, .net, dictionary

我有一个包含大量数据的通用字典。当 Dictionary 的大小开始占用太多内存时，我想开始删除项目（我知道如何确定哪些项目）。

我的程序监视此 Dictionary 使用的 RAM 的最佳方法是什么？

Dictionary 中的每个项目都是可变大小的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T02:06:52.443

计算出每个项目的大小并乘以`Dictionary.Count`

[这里](http://blogs.msdn.com/mab/archive/2006/04/24/582666.aspx)显示了一种方法：

> 确定对象在内存中使用大小的近似方法可以通过检查对象创建前后的总内存来完成。在以下示例中，假设您有一个名为 foo 的类。
> 
> ```
> long StopBytes = 0;
> foo myFoo;
> 
> long StartBytes = System.GC.GetTotalMemory(true);
> myFoo = new foo();
> StopBytes = System.GC.GetTotalMemory(true);
> GC.KeepAlive(myFoo); // This ensures a reference to object keeps object in memory
> 
> MessageBox.Show("Size is " + ((long)(StopBytes - StartBytes)).ToString()); 
> ```

C# 有一个“sizeof”运算符，其工作方式与 C/C++ 中的一样，但它返回该类型字段的大小。因此对于引用类型（类，而不是结构），它将始终返回指针的大小（在 32 位系统上为 4）。改为使用`System.Runtime.InteropServices.Marshal.SizeOf()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T02:19:32.440

我不相信有任何 API 可以为您提供对象的真实大小，但可以通过测量对象创建前后使用的内存量来确定；但是，这并不是真正的线程安全。

你可以使用 System.Runtime.InteropServices.Marshal.SizeOf() 即使这不会给你一个准确的大小它会给你一个准确的比较点，这样你就可以说：如果对象的大小增加了 X%然后删除 Y 个元素。

此外，您可以尝试保持运行总计，但如果集合中的项目是可编辑的，您将需要确保每次添加、删除和编辑都包含在计算中。您仍然面临正确测量添加和删除项目的问题，如上所述，我不相信有一个 API 可以准确地做到这一点。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-12T02:12:31.530

当您向字典添加内容时，计算添加项的大小并将每个添加项的总和保持为单个 int 值，当您从字典中删除项时减少此值。

# forms - 可以强制 CakePHP 表单助手包含自定义属性吗？

> ID：850835
> 
> 赞同：1
> 
> 时间：2009-05-12T02:04:18.907
> 
> 标签：forms, cakephp

我需要做的是创建一个类似这样的表单：

```
<form method="post" promptpermission="email" action="blahblah"> 
```

（注意**promptpermission**属性。）

有什么办法可以做到这一点而不会远离助手？

```
<?php echo $form->create(); ?> 
```

由于它只是一种形式，因此我非常不愿意使用 mod。有没有一种快速简便的方法来做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T02:08:50.727

很确定[第二个参数](http://api.cakephp.org/view_source/form-helper/#line-89)是一个选项数组：

```
<?php echo $form->create(null, array('promptpermission' => 'email')); ?> 
```

请注意，自定义属性不是有效的 (X)HTML。

# flash - AS2 到 AS3 迁移，处理按钮上留下的代码

> ID：850839
> 
> 赞同：0
> 
> 时间：2009-05-12T02:06:01.480
> 
> 标签：flash, actionscript-3, migration, actionscript-2

我有几个 (20-30) Flash 文件需要从 AS2 迁移到 AS3。我遇到的最大问题是遍历所有代码并将代码在按钮上的位置更改为事件处理程序模型非常乏味。

我不抱希望，但我想知道是否有人知道任何技巧或工具可以快速将 AS2 中按钮上的所有代码更改为符合 AS3 的代码。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T08:14:04.543

在版本之间移植 20-30 个 Flash 文件可不是件小事——祝你好运。正如您所怀疑的那样，您可能找不到任何捷径。只要确保将所有代码移动到外部类中，这样就不会再遇到这个问题了。我猜您没有选择仅将 AS2 swfs 加载到 AS3 容器的选项？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-09-30T15:33:00.407

好吧，我建议不确定您是否应该使用任何好的反编译器，并且该反编译器可以将您的 as2 代码转换为 as3 .. 尝试并祝您好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-19T01:25:16.517

我有一段时间没有研究这个了，但是这个 JSFL 库可能会有一些用处：

[gthmb_as2_converter.zip](http://greenethumb.com/files/gthmb_as2_converter.zip)

它可以解析单个文件（FLA 或类文件）或文件文件夹，并尽最大努力从 as2 转换为 as3。它不会涵盖所有内容，但它会处理大部分繁琐的事情。我写它是因为当我们的设计师将 AS2 项目交给我并说“让它成为 AS3”时，我已经厌倦了不得不手工做所有这些废话：）

让我知道它是否有帮助。zip 中有一个基本的 README 文件，告诉你如何使用它。非常简单的东西：运行一个转换 jsfl 脚本并按照提示进行操作。

我不认为它能够像这样的处理程序：

```
on (release)
{
    //blargh
} 
```

但如果你这样做：`mybtn.onRelease = function()...`它会解决这个问题。

# email - 在用户体验方面，是请求新信息还是提示对旧信息的许可更好？

> ID：850848
> 
> 赞同：1
> 
> 时间：2009-05-12T02:10:17.120
> 
> 标签：email, facebook, permissions, user-experience

Facebook 应用程序可以访问他们称为代理邮件的服务。它基本上是用户/应用程序对唯一的电子邮件地址，只要他们继续授予应用程序权限，就会转发到用户注册的电子邮件地址。

所以我可以使用它并提示许可，或者我可以直接询问用户他们的真实电子邮件地址。

您认为哪个用户体验更好？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T02:19:30.303

如果您担心的是 UX（用户体验），我会选择“请求许可”，原因有两个：

1.  与重新输入我的电子邮件地址相比，给予许可的工作更少。它还保持了集中式应用程序的感觉，而不是分散的应用程序试图一起工作。

2.  它也给用户一种安全感。在任何时候，如果他们想停止接收来自您的应用程序的电子邮件......他们所要做的就是取消许可。如果他们要输入他们的电子邮件地址，谁知道您可能会如何处理这些数据（您是否会做任何事情都无关紧要，这是用户在注册/配置时的体验）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T02:20:25.403

在用户体验方面，我觉得不必要的（侵入性）提示很糟糕。

因此，在对此 UI 做出决定时，请尽量给予用户尽可能多的控制权。控制权的用户带来愉快的用户体验。

在屏幕/页面上提供这两个选项。让用户选择。即在此处输入您的电子邮件地址......或者，“在此处检查以允许访问存储的电子邮件......”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T02:14:20.093

我个人更愿意提供一次电子邮件地址，但为什么不给用户选项呢？

默认要求提供真实的电子邮件地址，并带有“不想使用您的真实电子邮件？” 链接也简要解释了不给的缺点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T02:15:44.380

提示许可。如果他们同意，他们必须单击“是”，这意味着单击，而不是输入电子邮件地址。我知道这两个操作最多只需要 10 秒，但用户不想花任何时间输入个人资料信息。

# nhibernate - Fluent Nhibernate 在一对多中生成无效的列名

> ID：850853
> 
> 赞同：1
> 
> 时间：2009-05-12T02:12:33.777
> 
> 标签：nhibernate, orm, fluent-nhibernate, mapping

Fluent NHibernate 在多对一关系中生成无效的列名。

```
enter public EmployeeMap()
    {
        Id(x => x.EmployeeID);
        Map(x => x.FirstName);
        Map(x => x.LastName);
        Map(x => x.City);
        Map(x => x.HireDate);
        Map(x => x.Title);
        HasMany(x => x.Orders)
            .WithForeignKeyConstraintName("EmployeeID")
            .Inverse()
            .Cascade.All();

    } 
```

生成的 HBM：

```
<bag name="Orders" inverse="true" cascade="all">
  <key foreign-key="EmployeeID" column="Employees_id" />
  <one-to-many class="FluentWeb.Domain.Orders, FluentWeb, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" />
</bag> 
```

注意“Employees_id”。我看过其他帖子，其中人们使用方法“WithKeyColumn（“EmployeeID”）。此方法不可用。我该怎么办？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T02:47:32.363

以下似乎是解决方案：

```
.KeyColumnNames.Add("CustomerName") 
```

-缺口

# php - 在数组中查找数字序列

> ID：850858
> 
> 赞同：1
> 
> 时间：2009-05-12T02:13:47.410
> 
> 标签：php

我正在制作一个 Yahtzee 游戏，我需要一种计算小顺子的方法（按顺序排列的 4 个数字序列）。所以有效的是：1,2,3,4 | 2,3,4,5 | 3,4,5,6。

我有一个由 5 个数字组成的数组，我需要弄清楚这 3 个组合中的一个是否在该数组中。

对于那些不熟悉 Yahtzee 的人来说，有 5 个骰子（数组中的五个数字）可以从 1 到 6。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-12T02:19:09.367

```
function isStraight($hand) {
    $straights = array(range(1, 4), range(2, 5), range(3, 6));
    foreach($straights as $solution) {
        if(array_intersect($solution, $hand) == $solution) {
            return $solution;
        }
    }
    return false;
}

$hand = array(1,5,2,4,3);

var_dump(isStraight($hand)); 
```

不确定游戏规则，但应该这样做。

该函数将返回它找到的第一个解决方案——在这种情况下`[1,2,3,4]`。`false`如果它没有找到任何顺子，它将返回布尔值。希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T02:25:57.873

也许是这样的：---警告---空气编码

```
function findSequenceLength(array $array)
{
  // Filter duplicates out - and sort the array.
  $sorted = array_unique($array, SORT_NUMERIC);

  $lastValue = null;
  $thisSeq = 0;
  $longestSeq = 0;
  foreach ($sorted as $value)
  {
    if ( ( $lastValue !== null ) && $value == $lastValue + 1)
    {
      // our value is exactly one above the last entry
      // increase the counter
      $thisSeq++;
    } else {
      // sequence ended - save the value
      $longestSeq = max($longestSeq, $thisSeq);
      $thisSeq = 1;
    }
    $lastValue = $value;
  }
  return max($longestSeq, $thisSeq);
}

$sequence = array(1,2,4,5,4,6);
echo findSequenceLength($sequence);  // should return 3 [4,5,6] 
```

然后您可以测试“序列长度”是否 >= 4 以测试您的“小直”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T02:30:20.847

更确切地说：

```
 function array_match($array, $target_array) {
  $offset = 0;
  $maxoffset = sizeof($target_array) - sizeof($array);
  for($y=0;$y<$maxoffset;$y++) {
    $result = true;
    for($x=0;$x<sizeof($array);$x++) {
      if ($array[$x] != $target_array[$x+$y] ) {
         $result = false;
         continue;
      }
    }
    if ($result)
       return "true";
  }
  return "false";
}
echo array_match(array(1,2,3), array(1,2,3,4,5)); //true
echo array_match(array(1,2,3), array(4,1,2,3,5)); //true
echo array_match(array(1,2,3), array(4,2,2,1,2)); //false 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T12:11:31.137

这是另一个想法，使用通用 isStraight() 方法并使用它来测试两个数组切片。

```
$tests = array(
            array(1,2,3,4,5),
            array(1,1,2,3,4),
            array(4,3,2,1,4),
            array(3,4,5,6,1)
        );
foreach($tests as $test) {
    print_r($test);
    echo "Straight: "; 
    var_dump(isStraight($test));
    echo "Short Straight: "; 
    var_dump(isShortStraight($test));
    echo "\n";
}

function isShortStraight($hand) {
    return isStraight(array_slice($hand, 0, 4)) || 
           isStraight(array_slice($hand, 1, 4));
}

function isStraight($hand) {
    $unique = array_unique($hand);
    if (count($hand) != count($unique)) {
        /* Has Duplicates, not a straight */
        return false;
    }

    sort($unique);
    if ($unique != $hand) {
        /* Sort order changed, not a straight */
        return false;
    }
    return true;
} 
```

# c# - C# 多线程代码审查

> ID：850861
> 
> 赞同：1
> 
> 时间：2009-05-12T02:15:04.413
> 
> 标签：c#, multithreading, locking

我锁定队列重要吗？

```
public abstract class ExpiringCache<TKey,TValue> : IDisposable 
{
    protected readonly object locker = new object();

    protected readonly Dictionary<TKey, TValue> cache =
        new Dictionary<TKey, TValue>();

    private readonly Queue<KeyValuePair<TKey, long>> queue =
        new Queue<KeyValuePair<TKey, long>>();

    private volatile bool dispose;

    private readonly Thread cleaningThread;

    private readonly long lifeSpanTicks;

    public ExpiringCache(TimeSpan lifeSpan)
    {
        // Validate lifeSpan

        if (lifeSpan.Ticks == 0)
        {
            throw new ArgumentOutOfRangeException
                ("lifeSpan", "Must be greater than zero.");
        }

        this.lifeSpanTicks = lifeSpan.Ticks;

        // Begin expiring expired items

        this.cleaningThread = new Thread(() =>
        {
            while (!this.dispose)
            {
                this.RemoveExpired();
                Thread.Sleep(1);
            }
        });

        this.cleaningThread.Start();
    }

    private void RemoveExpired()
    {
        if (this.queue.Count == 0)
        {
            return;
        }

        var pair = this.queue.Peek();

        if (pair.Value >= DateTime.Now.Ticks)
        {
            lock (this.locker)
            {
                this.cache.Remove(pair.Key);
            }

            this.queue.Dequeue();
        }
    }

    public bool Contains(TKey key)
    {
        lock (this.locker)
        {
            return this.cache.ContainsKey(key);
        }
    }

    public void Add(TKey key, TValue value)
    {
        lock (this.locker)
        {
            this.cache.Add(key, value);
        }

        this.queue.Enqueue(new KeyValuePair<TKey, long>
            (key, DateTime.Now.Ticks + this.lifeSpanTicks));
    }

    public void Dispose()
    {
        this.dispose = true;
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-12T02:33:05.320

例如，仅锁定 Contains 方法是不够的。看到这个：http:
[//blogs.msdn.com/jaredpar/archive/2009/02/16/a-more-usable-thread-safe-collection.aspx](http://blogs.msdn.com/jaredpar/archive/2009/02/16/a-more-usable-thread-safe-collection.aspx)

基本上，您需要重新考虑经典的 Queue API 并使用类似的方法`DequeueIfContains()`而不是简单的`Contains()`+ `Dequeue()`，以便相同的锁适用于`Contains`检查和`Dequeue`操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-09T20:21:10.530

你可以使用：[`ConcurrentDictionary<TKey, TValue>`](https://docs.microsoft.com/en-us/dotnet/api/system.collections.concurrent.concurrentdictionary-2?view=netframework-4.8) 和[`ConcurrentQueue<T>`](https://docs.microsoft.com/en-us/dotnet/api/system.collections.concurrent.concurrentqueue-1?view=netframework-4.8)。它们内置于 C# .Net 4.0 及更高版本中。

# java - 解决数独的多线程算法？

> ID：850866
> 
> 赞同：18
> 
> 时间：2009-05-12T02:16:34.567
> 
> 标签：java, multithreading, algorithm, sudoku

我有一个家庭作业要编写一个多线程数独求解器，它可以找到给定谜题的所有解决方案。我之前写过一个非常快速的单线程回溯数独求解器，所以我在数独求解方面不需要任何帮助。

我的问题可能与并非真正理解并发有关，但我看不出这个问题如何从多线程中受益。我不明白如何在不维护拼图的多个副本的情况下同时找到同一问题的不同解决方案。鉴于这个假设（请证明它是错误的），我看不出多线程解决方案如何比单线程更有效。

如果有人能给我一些关于算法的起始建议，我将不胜感激（请不要代码......）

* * *

我忘了提，要使用的线程数被指定为程序的参数，所以据我所知，它与拼图的状态没有任何关系......

此外，可能没有唯一的解决方案 - 有效的输入可能是一个完全空的板。我必须报告`min(1000, number of solutions)`并显示其中之一（如果存在）

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-12T02:47:47.993

真的很简单。基本概念是，在您的回溯解决方案中，您将在有选择时进行分支。您尝试了一个分支，回溯，然后尝试了另一种选择。

现在，为每个选择生成一个线程并同时尝试它们。如果系统中已有 < 一些线程（这将是您的输入参数），则仅生成一个新线程，否则只需使用简单的（即您现有的）单线程解决方案。为了提高效率，请从线程池中获取这些工作线程。

这在许多方面是一种分而治之的技术，您将选择作为一个机会，将搜索空间分成两半并将一半分配给每个线程。很可能一半比另一半更难，这意味着线程的生命周期会有所不同，但这就是使优化变得有趣的原因。

处理明显同步问题的简单方法是复制当前板状态并将其传递到函数的每个实例中，因此它是函数参数。这种复制意味着您不必担心任何共享并发。如果您的单线程解决方案使用全局变量或成员变量来存储板状态，则您将需要在堆栈上（简单）或每个线程（更难）上的副本。您需要返回的所有函数都是一个棋盘状态以及为达到该状态而采取的一些动作。

每个调用多个线程来完成工作的例程应该在有 n 个工作时调用 n-1 个线程，完成第 n 个工作，然后使用同步对象等待，直到所有其他线程完成。然后，您评估他们的结果 - 您有 n 个棋盘状态，返回移动次数最少的棋盘状态。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-12T02:32:02.153

多线程在单个线程必须等待资源并且您可以同时运行另一个线程的任何情况下都很有用。这包括一个线程等待 I/O 请求或数据库访问，而另一个线程继续 CPU 工作。

*如果*各个线程可以分流到不同的 CPU（或内核），那么多线程也很有用，因为它们真正并发地运行，尽管它们通常必须共享数据，所以仍然会有一些争用。

我看不出多线程数独求解器比单线程数独求解器更高效的任何原因，仅仅是因为没有等待资源。一切都将在内存中完成。

但我记得我在 Uni 做的一些作业，它同样没用（Fortran 代码查看当你在 30 度一英里然后 15 度再挖一英里时隧道有多深 - 是的，我很漂亮老的 ：-）。关键是表明你可以做到，而不是它有用。

上算法。

我写了一个单线程求解器，它基本上在每次传递中运行一系列规则来尝试填充另一个正方形。一个示例规则是：如果第 1 行只有一个空方格，则该数字从第 1 行中的所有其他数字中显而易见。

所有行、所有列、所有 3x3 迷你网格都有类似的规则。还有检查行/列相交的规则（例如，如果给定的正方形由于行而只能包含 3 或 4，由于列只能包含 4 或 7，那么它是 4）。还有更复杂的规则我不会在这里详述，但它们基本上与您手动解决它的方式相同。

我怀疑您的实施中有类似的规则（因为除了蛮力之外，我想不出其他方法来解决它，如果您使用过蛮力，那么您就没有希望了:-)。

我建议将每个规则分配给一个线程并让它们共享网格。每个线程都会执行自己的规则，并且只有该规则。

**更新：**

乔恩，根据您的编辑：

> [编辑] 我忘了提，要使用的线程数被指定为程序的参数，所以据我所知，它与拼图的状态没有任何关系......
> 
> 此外，可能没有唯一的解决方案 - 有效的输入可能是一个完全空的板。我必须报告 min(1000, number of solutions) 并显示其中一个（如果存在）

看起来您的老师不希望您根据规则进行拆分，而是根据分叉点（可以应用多个规则）进行拆分。

我的意思是，在解决方案的任何时候，如果有两个或多个可能的前进，您应该将每个可能性分配给一个单独的线程（仍然使用您的规则来提高效率，但同时检查每个可能性）。这将为您提供更好的并发性（假设线程可以在单独的 CPU/内核上运行），因为不会有对板的争用；每个线程都会得到它自己的副本。

此外，由于您限制了线程数，因此您必须使用一些线程池魔法来实现这一点。

我建议的是有一个工作队列和 N 个线程。当您的主线程启动所有工作线程时，工作队列最初是空的。然后主线程将开始的拼图状态放入工作队列。

工作线程只是等待状态被放置在工作队列中，其中一个会抓取它进行处理。工作线程是您的单线程求解器，只需稍作修改：当有 X 个向前移动的可能性（X > 1）时，您的工作线程将其中的 X-1 个放回工作队列，然后继续处理另一种可能性。

所以，假设只有一种解决方案（真正的数独 :-)。第一个工作线程将在没有找到任何分叉的情况下减少解决方案，这与您当前的情况完全相同。

但是在第 27 步有两种可能性（例如，3 或 4 可以进入左上角的单元格），您的线程将创建另一个具有第一种可能性的棋盘（将 3 放入该单元格）并将其放入工作队列中。然后它将 4 放入自己的副本中并继续。

另一个线程将拿起该单元格中带有 3 的板并继续。这样，您就有两个线程同时运行以处理这两种可能性。

当任何线程决定其板不可解时，它会将其丢弃并返回工作队列以进行更多工作。

当任何线程决定其板已解决时，它会通知可以存储它的主线程，覆盖任何先前的解决方案（首先找到的是解决方案）或者如果它已经有解决方案则将其丢弃（最后找到的是解决方案）然后工作线程返回工作队列进行更多工作。在任何一种情况下，主线程都应该增加找到的解决方案的计数。

当所有线程都处于空闲状态并且工作队列为空时，main 要么会有解决方案，要么不会有解决方案。它还将有一个解决方案的计数。

请记住，工作线程和主线程之间的所有通信都需要互斥（我假设您根据问题中的信息知道这一点）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-12T02:28:42.377

多线程背后的想法是利用多个 CPU，允许您同时进行多个*计算*。当然，每个线程都需要自己的内存，但这通常不是问题。

大多数情况下，您想要做的是将可能的解决方案状态分成几个尽可能独立的子空间（以避免在线程创建开销上浪费太多资源），但“适合”您的算法（实际上受益从拥有多个线程）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-12T02:37:10.883

这是一个贪婪的蛮力单线程求解器：

1.  选择下一个空单元格。如果没有更多的空单元格，胜利！
2.  可能的单元格值 = 1
3.  检查无效的部分解决方案（行、列或 3x3 块中的重复项）。
4.  如果部分解无效，则增加单元格值并返回步骤 3。否则，转到步骤 1。

如果您查看上面的大纲，步骤 2 和 3 的组合显然是多线程的候选者。更雄心勃勃的解决方案涉及创建递归探索，以生成提交到线程池的任务。

*编辑回应这一点：“我不明白如何在不维护拼图的多个副本的情况下同时找到同一问题的不同解决方案。”*

你不能。这就是重点。但是，一个具体的 9 线程示例可能会使好处更加明显：

1.  从一个示例问题开始。
2.  找到第一个空单元格。
3.  创建 9 个线程，其中每个线程都有自己的问题副本，并将其自己的索引作为空单元格中的候选值。
4.  在每个线程中，在这个线程本地修改的问题副本上运行您的原始单线程算法。
5.  如果其中一个线程找到答案，则停止所有其他线程。

可以想象，每个线程现在运行的问题空间稍小，每个线程都有可能在自己的 CPU 内核上运行。仅使用单线程算法，您无法获得多核机器的好处。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-09-08T23:19:10.877

## TL;博士

是的，基于回溯的数独求解器可以根据谜题从并行化中受益匪浅！拼图的搜索空间可以建模为树数据结构，并且回溯执行此树的**深度优先搜索 (DFS)**，这本质上是不可并行的。但是，通过将 DFS 与其相反形式的树遍历、**广度优先搜索 (BFS)**相结合，可以解锁并行性。这是因为 BFS 允许同时发现多个独立的子树，然后可以并行搜索。

因为 BFS 解锁了并行性，所以使用它保证使用全局线程安全队列，所有线程都可以将发现的子树推入/弹出该队列，与 DFS 相比，这需要显着的性能开销。因此，并行化这样的求解器需要微调执行的 BFS 的数量，以便执行足以确保树的遍历被充分并行化，但又不能过多地导致线程通信的开销（推送/弹出子树队列）超过了并行化提供的加速。

不久前，我并行化了一个基于回溯的数独求解器，并实现了 4 个不同的并行求解器变体以及一个顺序（单线程）求解器。并行变体都以不同方式和不同程度地结合了 DFS 和 BFS，最快的变体平均是单线程求解器的三倍以上（见底部图表）。

此外，**为了回答您的问题**，在我的实现中，每个线程都会收到初始拼图的副本（当线程产生时），因此所需的内存略高于顺序求解器 - 这在并行化某些东西时并不少见。但这就是您所说的唯一“低效率”：如上所述，如果 BFS 的数量经过适当微调，则通过并行化可实现的加速大大超过线程通信的并行开销以及更高的内存占用。此外，虽然我的求解器假设了独特的解决方案，但将它们扩展为处理不正确的谜题并找到所有解决方案将很简单，并且由于求解器设计的性质，不会显着降低加速比（如果有的话）。

* * *

## 完整答案

数独求解器是否受益于多线程很大程度上取决于其底层算法。常见的方法，如约束传播（即基于规则的方法），其中难题被建模为约束满足问题或随机搜索，并没有真正受益，因为使用这些方法的单线程求解器已经非常快。然而，回溯在大多数情况下会受益匪浅（取决于谜题）。

您可能已经知道，数独的搜索空间可以建模为树数据结构：三级中的第一级表示第一个空单元格，第二级表示第二个空单元格，依此类推。*在每个级别，节点代表给定*其祖先节点值的该单元格的潜在值。**因此搜索这个空间可以通过同时搜索独立的子树来并行化。**单线程回溯求解器必须自己遍历整个树，一个接一个的子树，但并行求解器可以让每个线程并行搜索单独的子树。

有多种方法可以实现这一点，但它们都是基于深度优先搜索 (DFS) 和广度优先搜索 (BFS) 相结合的原理，这是树遍历的两种（相反）形式。单线程回溯求解器仅对整个搜索进行 DFS，这本质上是不可并行的。但是，通过将 BFS 添加到混合中，可以解锁并行性。这是因为 BFS 逐级遍历树（与 DFS 的逐个分支相反），从而在移动到下一个较低级别之前找到给定级别上的所有可能节点，而 DFS 获取第一个可能的节点并在移动到下一个可能的节点之前完全搜索其子树。因此，BFS 可以立即发现多个独立的子树，然后可以通过单独的线程进行搜索；DFS 没有

与多线程的情况一样，并行化代码很棘手，如果您不确切知道自己在做什么，最初的尝试通常会*降低性能。*在这种情况下，重要的是要意识到 BFS 比 DFS 慢得多，因此**主要关注的是调整您执行的 DFS 和 BFS 的数量，以便执行足够的 BFS 以解锁发现多个子树的能力同时，还要最小化它，因此它的缓慢最终不会超过这种能力。**请注意，BFS 本质上并不比 DFS 慢，只是线程需要访问发现的子树，以便它们可以搜索它们。因此，BFS 需要一个全局线程安全的数据结构（例如队列），子树可以由单独的线程推入/弹出该数据结构，与不需要线程之间任何通信的 DFS 相比，这需要显着的开销。**因此，并行化这样的求解器是一个微调过程，并且希望执行足够的 BFS 来为所有线程提供足够的子树进行搜索（即在所有线程之间实现良好的负载平衡），同时最小化线程之间的通信（推/将子树弹出到队列中/从队列中弹出）。**

不久前，我并行化了一个基于回溯的数独求解器，并实现了 4 个不同的并行求解器变体，并将它们与我也实现的顺序（单线程）求解器进行了基准测试。它们都是用 C++ 实现的。最佳（最快）并行变体的算法如下：

*   从拼图树的 DFS 开始，但只能达到一定的水平，或**搜索深度**
*   在搜索深度，执行 BFS 并将在该级别发现的所有子树推送到全局队列
*   然后线程将这些子树从队列中弹出并对其执行 DFS，一直到最后一层（最后一个空单元格）。

下图（取自我当时的报告）说明了这些步骤： 不同颜色的三角形代表不同的线程和它们遍历的子树。绿色节点表示该级别上允许的单元格值。注意在搜索深度执行的单个 BFS；在这一层发现的子树（黄色、紫色和红色）被推入全局队列，然后并行独立地遍历到树的最后一层（最后一个空单元格）。

[![在此处输入图像描述](https://i.stack.imgur.com/tWkvf.png)](https://i.stack.imgur.com/tWkvf.png)

如您所见，此实现仅执行一个级别（在搜索深度）的 BFS。这个搜索深度是可调的，优化它代表了前面提到的微调过程。搜索深度越深，执行的 BFS 就越多，因为树的宽度（给定级别上的 # 个节点）自然会增加您越往下走。有趣的是，最佳搜索深度通常处于相当浅的级别（即树中不是很深的级别）；这表明即使执行少量的 BFS 也足以生成充足的子树并在所有线程之间提供良好的负载平衡。

此外，由于全局队列，可以选择任意数量的线程。将线程数设置为等于硬件线程数（即 # 逻辑核心）通常是一个好主意；选择更通常不会进一步提高性能。此外，还可以通过执行树的第一级（第一个空单元格）的 BFS 来并行化在开始时执行的初始 DFS：然后并行遍历在级别 1 发现的子树，每个线程在给定搜索深度。这就是上图中所做的。尽管如上所述，最佳搜索深度通常很浅，但这并不是绝对必要的，因此即使是单线程的，下降到搜索深度的 DFS 仍然非常快。

I thoroughly tested all solvers on 14 different Sudoku puzzles (specifically, a select set of puzzles specially designed to be difficult for a backtracking solver), and the figure below shows each solver's average time taken to solve *all* puzzles, for various thread counts (my laptop has four hardware threads). Parallel variant 2 isn't shown because it actually achieved significantly worse performance than the sequential solver. With parallel variant 1, the # threads was automatically determined during run-time, and depended on the puzzle (specifically, the branching factor of the first level); Hence the blue line represents its average total solving time regardless of the thread count.

[![在此处输入图像描述](https://i.stack.imgur.com/yjCAZ.jpg)](https://i.stack.imgur.com/yjCAZ.jpg)

所有并行求解器变体都以不同方式在不同程度上结合了 DFS 和 BFS。当使用 4 个线程时，最快的并行求解器（变体 4）平均比单线程求解器快三倍！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-12T02:23:46.537

当您说给定难题的所有解决方案时，您是指*该难题的最后一个也是唯一的解决方案*吗？还是*达成*一种解决方案的不同方式？我的理解是，根据定义，数独谜题只能有一个解决方案......

对于前者，[Pax 的基于规则的方法](https://stackoverflow.com/questions/850866/multi-threaded-algorithm-for-solving-sudoku/850912#850912)或[Tom Leys 对现有回溯算法的多线程处理](https://stackoverflow.com/questions/850866/multi-threaded-algorithm-for-solving-sudoku/850959#850959)可能是可行的方法。

如果是后者，您可以实现某种分支算法，该算法在拼图的每个阶段为每个可能的移动启动一个新线程（带有它自己的拼图副本）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-12T02:25:19.857

它是否需要从多线程中受益，或者只是利用多线程来学习作业？

如果您使用蛮力算法，则很容易拆分为多个线程，并且如果分配专注于编码线程，这可能是一个可接受的解决方案。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-12T02:24:22.353

根据您对单线程求解器的编码方式，您可能能够重用该逻辑。您可以编写一个多线程求解器，以使用一组不同的策略启动每个线程来解决难题。

使用这些不同的策略，您的多线程求解器可能会在比单线程求解器更短的时间内找到全部解决方案（请记住，尽管真正的数独难题只有一个解决方案……但您并不是唯一一个不得不在课堂上处理那个糟糕透顶的游戏）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-12T02:33:55.707

一些一般要点：我不会并行运行进程，除非 1) 很容易划分问题 2) 我知道这样做会有所帮助 - 例如，我不会遇到另一个瓶颈。我完全避免在线程之间共享可变值 - 或最小化它。有些人足够聪明，可以安全地使用互斥锁。我不是。

您需要在算法中找到创建自然分支或大型工作单元的点。一旦确定了要工作的单元，就将其放入队列中以供线程拾取。作为一个简单的例子。10 个数据库要升级。在所有 10 台服务器上开始异步升级。等待全部完成。我可以轻松避免线程/进程之间共享状态，并且可以轻松汇总结果。

对于数独，我想到的是一个有效的数独解决方案应该结合 2-3 个（或更多）策略，这些策略永远不会超过一定的深度。当我做数独时，很明显，在任何给定时刻，不同的算法提供的解决方案工作量最少。您可以简单地启动一些策略，让他们调查到有限的深度，等待报告。冲洗，重复。这避免了“暴力破解”解决方案。每个算法都有自己的数据空间，但你可以组合答案。

Sciam.com 在一两年前就有关于这方面的文章——不过看起来它并不公开。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-12T02:45:26.767

您说您使用回溯来解决问题。您可以做的是将搜索空间分成两个并将每个空间处理给一个线程，然后每个线程都会执行相同的操作，直到您到达最后一个节点。我对此做了一个解决方案，可以在 www2.cs.uregina.ca/~hmer200a 找到，但是使用单线程，但是使用分支和绑定分割搜索空间的机制是存在的。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-12T02:25:11.370

几年前，当我研究解决数独时，似乎最佳解决方案使用了逻辑分析算法的组合，并且仅在必要时才使用蛮力。这使求解器能够非常快速地找到解决方案，并且如果您想使用它来生成新的谜题，还可以按难度对棋盘进行排名。如果您采用这种方法，您当然可以引入一些并发性，尽管让线程实际一起工作可能会很棘手。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-10-28T22:21:48.987

我有一个很有趣的想法……用演员模型来做！我会说使用erlang ..怎么样？你从原来的板子开始，然后..

*   1）首先空单元创建9个不同编号的孩子，然后自杀
*   2）每个孩子检查它是否无效，如果是则自杀，否则
    *   如果有空单元格，请转到 1)
    *   如果完成，这个演员是一个解决方案

显然，每个幸存的参与者都是问题的解决方案 =)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-08-09T22:33:54.933

只是一个旁注。我实际上实现了一个优化的数独求解器并研究了多线程，但有两件事阻止了我。

首先，启动一个线程的简单开销需要 0.5 毫秒，而整个解析需要 1 到 3 毫秒（我使用的是 Java，其他语言或环境可能会给出不同的结果）。

其次，大多数问题不需要任何回溯。而那些这样做的人，只需要在解决问题的后期，一旦所有的游戏规则都用尽了，我们需要做出一个假设。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-05-03T00:31:35.983

这是我自己的一分钱。希望能帮助到你。

请记住，处理器间/线程间通信是昂贵的。**除非必须**，否则不要使用多线程。如果在其他线程中没有太多工作/计算要完成，您还不如继续使用单线程。

尽量**避免**线程间共享数据。仅在必要时使用它们

尽可能利用**SIMD 扩展。**借助矢量扩展，您可以一次对多个数据执行计算。它可以帮助你很多。

# .net - What is this new Axum programming language?

> ID：850870
> 
> 赞同：10
> 
> 时间：2009-05-12T02:18:55.640
> 
> 标签：.net, programming-languages, concurrent-programming, axum

I read [this](http://msdn.microsoft.com/en-us/devlabs/dd795202.aspx) story on slashdot today where they announce a new parallel programming language by Microsoft.

What is this new programming language about? It says Parallel Programming. But is it going to be an alternative/replacement for MPI, PVM, OpenMP and similar parallel libraries/frameworks?

Any thoughts?

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-09-11T07:05:33.143

Axum is a language structured in such a way as to make safe and performant concurrent programming simpler. The concepts modelled by the language avoid the need to make thread synchronisation explicit via the use of `lock` (in C#), `Monitor`, `ReaderWriterLockSlim`, etc...

It could be argued that many of the ideas within Axum have been in the [Erlang programming language](http://en.wikipedia.org/wiki/Erlang_%28programming_language%29) since 1986 -- a language designed by researchers working in Sweden for Ericsson to run on telephone switches, and hence support for massive throughput under highly concurrent load was so essential it was designed into the language. Whilst many of the ideas in Axum aren't new, they are certainly new to .NET and the CLR (at least at the language level.)

Existing .NET libraries that contain some of these ideas are:

*   [Retlang](http://code.google.com/p/retlang/)
*   [Concurrency and Coordination Runtime (CCR)](http://msdn.microsoft.com/en-us/library/bb648752.aspx)

Like Erlang, message passing is a central concept in Axum. Like Erlang, Axum is largely indifferent as to whether the recipient of the message is located in-process or remotely. Axum currently provides integration with WCF.

Axum differs from the libraries mentioned above in that it includes support for these concepts at the language level, not just via use of libraries. The Axum compiler deals not only with the Axum language, but also with some experimental extensions to the C# language itself; namely the `isolated` and `readonly` keywords.

Adding new features to a language is not something to be taken lightly. [Spec#](http://research.microsoft.com/en-us/projects/specsharp/) is another C#-superset language developed at [MSR](http://research.microsoft.com/en-us/) (unrelated to concurrency). As seen with the support for [Code Contracts](http://research.microsoft.com/en-us/projects/contracts/) in .NET 4.0, Microsoft has decided to favour adding a new API rather than new language extensions (this benefits users of all languages on the CLR.) However in the case of Axum, there is not enough richness in the C# 3.0 language to express the kinds of immutability constraints required of types and their members for truly safe concurrent programming.

Having dabbled in Erlang and liking what I saw, I'm very excited about where Axum might take us. Some of the extensions to the C# language proposed by the team are useful for regular C# projects too.

Finally I'd like to point out that there's more to Erlang than just a good concurrency model. Erlang is a strict functional programming language. It supports hot swappable code, meaning that a system can be upgraded without it ever being stopped (a desirable feature of a telephone switch or any other 24x7 system). I heard a report from a large British telecommunications organisation running a switch for a year and only failing to route four calls in that time. Erlang has other characteristics such as remote exception handling as well.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-12T02:38:31.847

Looks to me like you hit the nail on the head in your question. Looks like the Microsoft.NET alternative to some of the languages/frameworks you mentioned. Take a look at the Programmer's Guide here:

[Axum Programmer's Guide](http://download.microsoft.com/download/B/D/5/BD51FFB2-C777-43B0-AC24-BDE3C88E231F/Axum%20Programmers%20Guide.pdf)

Looks like it should play nicely with the rest of the .NET Framework. It might open up some interesting C#/F#/Axum interactions...

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-12T02:42:25.693

Axum is the new name for Microsoft's "Maestro" language, which originally was a research language for parallel programming but has been "promoted" to a first-class language just recently.

A bit more information on Channel 9 here:

[Maestro: A Managed Domain Specific Language For Concurrent Programming](http://channel9.msdn.com/shows/Going+Deep/Maestro-A-Managed-Domain-Specific-Language-For-Concurrent-Programming/Default.aspx)

... and on the [official Axum team blog](http://blogs.msdn.com/maestroteam/default.aspx).

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-01T18:38:33.367

Here's an update on the state of [Axum](http://blogs.msdn.com/b/maestroteam/archive/2011/02/28/the-state-of-axum.aspx). Apparrently some of the concurrency features will no longer be part of C#/VB.Net.

> ...the concepts around safe parallelism and agent-based programming were seen by many as too far outside the mainstream to be adopted now in languages like C# and VB. The idea of Axum was to not force these concepts on general-purpose languages, so those of us who have work on Axum are not surprised.

# python - 比使用 for 循环更快地对数字列表求和？

> ID：850877
> 
> 赞同：13
> 
> 时间：2009-05-12T02:20:32.000
> 
> 标签：python, algorithm, for-loop

有没有办法比 for 循环更快地总结一个数字列表，也许在 Python 库中？还是只有多线程/矢量处理才能有效地做到这一点？

编辑：为了澄清，它可以是任何数字的列表，未排序，只是来自用户的输入。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-05-12T02:22:50.047

您可以使用 sum() 对数组的值求和。

```
a = [1,9,12]
print sum(a) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-12T06:56:34.733

用循环时间总结列表的另一种方法：

```
 s = reduce(lambda x, y: x + y, l) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T02:24:49.607

如果列表中的每一项都简单地增加 1，或者如果您可以在系列中找到一个模式，您可以找到一个求和 n 项的公式。例如，级数 {1,2,3,...,n} 的和 = n(n+1)/2

[在这里](http://en.wikipedia.org/wiki/Summation)阅读更多

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T02:26:32.833

好吧，我不知道它是否更快，但您可以尝试一些微积分来使其成为一次操作。(N*(N+1))/2 给出从 1 到 N 的每个数字的总和，还有其他公式可以解决更复杂的总和。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-12T02:31:29.720

对于一般列表，您必须至少检查每个成员至少一次才能得到总和，这正是 for 循环所做的。使用库 API（如 sum）更方便，但我怀疑它实际上会更快。

# java - 将 Java 对象设置为 null 有什么作用吗？

> ID：850878
> 
> 赞同：116
> 
> 时间：2009-05-12T02:20:49.490
> 
> 标签：java, garbage-collection, performance

我正在浏览一些旧书，并找到了 Peter Hagger 的“Practical Java”的副本。在性能部分，建议将对象引用设置为`null`不再需要时。

在 Java 中，设置对象引用是为了`null`提高性能还是垃圾回收效率？如果是这样，在什么情况下这是一个问题？容器类？对象构成？匿名内部类？

我经常在代码中看到这一点。这是现在过时的编程建议还是仍然有用？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-05-12T03:11:38.597

这在一定程度上取决于您何时考虑将引用归零。

如果您有一个对象链 A->B->C，那么一旦 A 不可访问，A、B 和 C 都将有资格进行垃圾回收（假设没有其他内容涉及 B 或 C）。例如，没有必要也从来没有必要将引用 A->B 或 B->C 显式设置为 null。

除此之外，大多数时候问题并没有真正出现，因为实际上您正在处理集合中的对象。您通常应该始终考虑通过调用适当的 remove() 方法从列表、地图等中删除对象。

曾经**有**一些建议来设置对 null 的引用的情况特别是在一个**长范围内，其中内存密集型对象在该范围的中途停止使用**。例如：

```
{
  BigObject obj = ...
  doSomethingWith(obj);
  obj = null;             <-- explicitly set to null
  doSomethingElse();
} 
```

这里的基本原理是，因为*obj*仍在作用域内，因此如果没有显式地将引用置空，它直到*doSomethingElse()*方法完成后才成为可垃圾回收的。这就是**现代 JVM 可能不再适用**的建议：事实证明，JIT 编译器可以计算出在什么时候不再使用给定的本地对象引用。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-05-12T02:26:18.933

不，这不是过时的建议。悬空引用仍然是一个问题，特别是如果您正在`ArrayList`使用预分配的数组实现可扩展的数组容器（或类似容器）。超出列表“逻辑”大小的元素应该被清空，否则它们不会被释放。

请参阅 Effective Java 第 2 版，第 6 项：消除过时的对象引用。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-12T03:57:04.277

**实例字段、数组元素**

如果有一个对象的引用，它就不能被垃圾回收。特别是如果那个对象（以及它后面的整个图）很大，那么只有一个引用正在停止垃圾收集，并且不再需要那个引用，这是一种不幸的情况。

病态情况是对象保留了用于配置它的整个 XML DOM 树的不必要实例，未取消注册的 MBean，或来自未部署的 Web 应用程序的对对象的单个引用，阻止了整个类加载器被卸载.

因此，除非您确定持有引用本身的对象无论如何都会被垃圾回收（甚至在那时），否则您应该将不再需要的所有内容都清空。

**作用域变量：**

如果您正在考虑在其作用域结束之前将局部变量设置为 null ，以便它可以被垃圾收集器回收并将其标记为“从现在开始不可用”，您应该考虑将其置于更有限的作用域中.

```
{
  BigObject obj = ...
  doSomethingWith(obj);
  obj = null;          //   <-- explicitly set to null
  doSomethingElse();
} 
```

变成

```
{
  {  
     BigObject obj = ...
     doSomethingWith(obj);
  }    //         <-- obj goes out of scope
  doSomethingElse();
} 
```

长而扁平的作用域通常也不利于代码的易读性。仅仅为此目的引入私有方法来分解事物也并非闻所未闻。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-12T02:31:36.227

在内存受限的环境（例如手机）中，这可能很有用。通过设置 null，objetc 不需要等待变量超出范围即可被 gc'd。

然而，对于日常编程来说，这不应该是规则，除非在特殊情况下，比如 Chris Jester-Young 引用的那个。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-04-26T07:24:27.473

首先，这并不意味着您将对象设置为`null`. 我在下面解释它：

```
List list1 = new ArrayList();
List list2 = list1; 
```

在上面的代码段中，我们正在创建存储在内存中`list1`的对象的对象引用变量名称。`ArrayList`引用该对象也是如此`list1`，它只不过是一个变量。在第二行代码中，我们复制了`list1`to的引用`list2`。所以现在回到你的问题，如果我这样做：

```
list1 = null; 
```

这意味着`list1`不再引用存储在内存中的任何对象，因此`list2`也没有可引用的对象。因此，如果您检查 的大小`list2`：

```
list2.size(); //it gives you 0 
```

所以这里出现了垃圾收集器的概念，它说**“你不必担心释放对象持有的内存，当我发现它不再在程序中使用时我会这样做，JVM 会管理我。”**

我希望它澄清了这个概念。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-01-11T09:01:03.407

这样做的原因之一是消除过时的对象引用。你可以在这里阅读文本[。](http://www.informit.com/articles/article.aspx?p=1216151&seqNum=6)

# javascript - 在返回的 AJAX 内容中调用用户定义的 JS 函数

> ID：850880
> 
> 赞同：2
> 
> 时间：2009-05-12T02:22:36.257
> 
> 标签：javascript, ajax, events

我有一个通过使用 AJAX 加载 div 内容的系统。一切都很好，我可以让 div 完美地加载我数据库中的详细信息，并且效果很好。

**问题是这样的：**

在返回的 div 中，我有几个带有`onClick`事件的按钮。`onClick`当我尝试调用用户定义的函数时，这些事件会导致错误，但当我调用 JS 定义的函数时`onClick="my_function();"`，这些`onClick`事件不会导致错误`onClick="alert('success');"`。

有谁知道为什么会这样？`my_function()`在我的页面头部定义。虽然，我也尝试在 AJAX 返回的内容中定义它，但仍然没有运气。

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-12T05:59:02.440

好的，这是简单的答案..我的按钮元素名称和 id 与它试图调用的函数相同..我知道的愚蠢错误..无论如何，它现在正在工作..但是，我确实有另一个问题..我的ajax只触发一次..第一次效果很好，但之后该功能不起作用

这是我的代码：

```
function delete_account(account_id) {
  create_request();
  var url = "accounts_ajax.php?action=delete_account&account_id=" + account_id;

  show_div('action_window');

  document.getElementById('action_window').innerHTML = '<div class="please_wait"><img src="images/working.gif"><br>Loading...</div>';  

  xmlHttp.open("GET", url, true);
  xmlHttp.onreadystatechange = function(){if(xmlHttp.readyState!=4)return;if(xmlHttp.status==200){reload_div('action_window', xmlHttp.responseText);}};
  xmlHttp.send(null);
  } 
```

它只会导致第二次出错。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T02:29:13.860

如果您使用原型、jquery 等（任何 JS 框架），您需要确保已将参数“evalJS”设置为 true。最后一个例子我把作品放在原型中。

[在这里](http://prototypejs.org/api/ajax/request)查看原型

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T02:45:29.853

您可以尝试通过 JavaScript 添加事件处理程序，而不是在实际元素上添加 onclick 处理程序。

然后你可以使用匿名函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T02:48:48.320

如果您只是简单地使用 AJAX 请求的结果更新`innerHTML`元素`DIV`，请记住浏览器只解析 HTML 而不是脚本。

可能这就是您收到 JavaScript 错误的原因。

要解析脚本，您还需要查阅库的文档。例如，如果您使用的是 ASP.NET，您可以调用`ScriptManager.RegisterClientScriptBlock`以指示 AJAX 客户端组件解析结果中的脚本。

另一方面，如果您是手动操作（我不久前做过的一件事），您需要自己检测和解析脚本。

# iphone - 有人可以向我解释这些错误吗？

> ID：850888
> 
> 赞同：2
> 
> 时间：2009-05-12T02:24:03.523
> 
> 标签：iphone, objective-c, cocoa-touch

我收到这些奇怪的错误，但我不明白。以下是错误：

> 错误：可变大小的对象可能未初始化（#1）
> 
> 错误：Objective-C 类“笑话”的静态分配实例（#1）
> 
> 错误：Objective-C 类“笑话”的静态分配实例（#1）
> 
> 错误：无法转换为指针类型（#2）

（注意：错误后的数字将指示错误在我的实现文件中的位置）

这是我的 .m 文件：

```
#import "Joke.h"

@implementation Joke
@synthesize joke;
@synthesize rating;

- (id)init {
[super init];
return self;
}

- (void)dealloc {
[joke release];
[super dealloc];    
}

+ (id)jokeWithValue:(NSString *)joke {
Joke j = [[Joke alloc] init]; // (# 1) This is where #1 errors occurred
j.joke = joke;
return [j autorelease]; // (# 2) This is where #2 errors occurred
 }

@synthesize joke;
@synthesize rating;

@end 
```

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-12T02:29:05.653

Objective-C 对象的实例必须是指针，这会导致您的问题。你的笑话初始化应该是：

```
Joke *j = [[Joke alloc] init]; 
```

此外，将对象作为循环引用保持自身也是一个坏主意。您将使用 j->joke->joke->joke->joke->joke... 进行无限递归

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-12T02:27:47.467

您需要在变量前加上“*”——例如，“Joke *j = [[Joke alloc] init];”

您也只希望 @synthesize 在那里一次 - 而不是每个属性。像这样： `@synthesize joke, rating;`

# search - 使用 Lucene.net 进行精确短语搜索

> ID：850897
> 
> 赞同：11
> 
> 时间：2009-05-12T02:26:22.523
> 
> 标签：search, lucene, lucene.net

我无法使用 Lucene.NET 2.0.0.4 搜索确切的短语

例如，我正在搜索“范围属性设置变量”（包括引号）但没有收到匹配项，我已经确认 100% 的短语存在。

谁能建议我哪里出错了？Lucene.NET 甚至支持吗？像往常一样，API 文档并没有太大帮助，我读过的一些 CodeProject 文章也没有特别提到这一点。

使用以下代码创建索引：

```
Directory dir = Lucene.Net.Store.FSDirectory.GetDirectory("Index", true);

Analyzer analyzer = new Lucene.Net.Analysis.SimpleAnalyzer();

IndexWriter indexWriter = new Lucene.Net.Index.IndexWriter(dir, analyzer,true);

//create a document, add in a single field
Lucene.Net.Documents.Document doc = new Lucene.Net.Documents.Document();

Lucene.Net.Documents.Field fldContent = new Lucene.Net.Documents.Field(
    "content", File.ReadAllText(@"Documents\100.txt"),
    Lucene.Net.Documents.Field.Store.YES,
    Lucene.Net.Documents.Field.Index.TOKENIZED);

doc.Add(fldContent);

//write the document to the index
indexWriter.AddDocument(doc); 
```

然后我使用以下方法搜索一个短语：

```
//state the file location of the index
Directory dir = Lucene.Net.Store.FSDirectory.GetDirectory("Index", false);

//create an index searcher that will perform the search
IndexSearcher searcher = new Lucene.Net.Search.IndexSearcher(dir);

QueryParser qp = new QueryParser("content", new SimpleAnalyzer());

// txtSearch.Text  Contains a phrase such as "this is a phrase" 
Query q=qp.Parse(txtSearch.Text);  

//execute the query
Lucene.Net.Search.Hits hits = searcher.Search(q); 
```

目标文档约为 7 MB 纯文本。

我已经看到了这个[先前的问题](https://stackoverflow.com/questions/343002/searching-phrases-in-lucene)，但是我不想要一个邻近搜索，只是一个精确的短语搜索。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-24T20:21:41.143

[Shashikant Kore 的回答是正确的](https://stackoverflow.com/questions/850897/exact-phrase-search-using-lucene-net/851243#851243)，您需要启用长期职位...

但是，我建议不要将文档的文本存储在字段中，除非您绝对需要它在搜索结果中返回给您……将存储设置为“否”可能有助于减少索引的大小。

```
Lucene.Net.Documents.Field fldContent = 
    new Lucene.Net.Documents.Field("content", 
        File.ReadAllText(@"Documents\100.txt"),
    Lucene.Net.Documents.Field.Store.NO,
    Lucene.Net.Documents.Field.Index.TOKENIZED, 
    Lucene.Net.Documents.Field.TermVector.WITH_POSITIONS_OFFSETS); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-12T05:18:43.740

您尚未启用长期职位。如下创建字段应该可以解决您的问题。

```
Lucene.Net.Documents.Field fldContent = 
    new Lucene.Net.Documents.Field("content", 
        File.ReadAllText(@"Documents\100.txt"),
    Lucene.Net.Documents.Field.Store.YES,
    Lucene.Net.Documents.Field.Index.TOKENIZED, 
    Lucene.Net.Documents.Field.TermVector.WITH_POSITIONS_OFFSETS); 
```

# python - 以编程方式编辑 Photoshop PSD 文本图层

> ID：850899
> 
> 赞同：13
> 
> 时间：2009-05-12T02:27:02.803
> 
> 标签：python, perl, image, photoshop, psd

我有一个多层 PSD，其中一个特定层是非光栅化文本。我试图从 bash/perl/python/whatever-else 程序中找出一种方法：

1.  加载PSD
2.  编辑所述图层中的文本
3.  展平图像中的所有图层
4.  保存为网络友好格式，如 PNG 或 JPG

我立刻想到了[ImageMagick](http://www.imagemagick.org/)，但我不认为我可以通过 IM 编辑文本层。如果我可以通过其他编程方式完成前两个步骤，我总是可以使用 ImageMagick 来执行最后两个步骤。

经过几个小时的谷歌搜索和 CPAN 和 PyPI，我仍然没有发现任何有希望的东西。有人对这个主题有什么建议或想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-12T07:07:47.523

如果您不喜欢使用官方支持的 AppleScript、JavaScript 或 VBScript，那么也可以使用 Python 来实现。这在文章[Photoshop scripting with Python](http://techarttiki.blogspot.com/2008/08/photoshop-scripting-with-python.html)中进行了解释，该文章依赖于 Photoshop 的 COM 接口。

我没有尝试过，所以万一它对你不起作用：如果你的文本在[转换为 SVG](http://www.google.de/search?hl=de&q=photoshop+svg+plugin&revid=1305924600&ei=4h4JSqDpJsPj-Ab308jmCw&sa=X&oi=revisions_inline&resnum=0&ct=broad-revision&cd=3)后被保留，那么你可以简单地用你喜欢的任何工具替换它。之后，将其转换为 PNG（例如 by `inkscape --export-png=...`）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-12T05:18:51.663

我能想到的自动更改 PSD 内的文本的唯一方法是使用基于正则表达式的替换。

1.  在 Photoshop 中创建一个非常简单的图片，可能是一个白色背景和一个文本层，文本的长度是已知的。
2.  在文件中搜索您的文本，并使用十六进制编辑器在附近搜索文本的长度（可能是也可能不是文件格式的一部分）。
3.  尝试更改文本，首先更改为相同长度的字符串，然后更改为更短/更长的字符串。
4.  每次更改后在 Photoshop 中打开以查看文件是否损坏。

此方法（如果可行）仅在相关图层包含已知字符串时才有效，该字符串可以替换为您的其他值。请注意，我不知道这是否可行，因为我在这台计算机上没有 Photoshop 来尝试这种方法。也许你可以让它工作？

至于转换成png，我很茫然。如果替换脚本在 Python 中，您可以使用 Python Imaging Library（PIL，[似乎支持它](http://effbot.org/imagingbook/format-psd.htm)）来完成，否则您可能只需要打开 Photoshop 来进行转换。这意味着首先务实地更改文本可能不值得。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-12T08:12:17.183

您是否考虑过在 The GIMP 中打开和编辑图像？它有很好的 PSD 支持，并且可以用多种语言编写脚本。

您使用哪一个部分取决于您的平台，Perl 界面在我所知道的最后一次无法在 Windows 上运行。我相信所有端口都支持 Scheme。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-12T10:35:01.350

您可以使用 Photoshop 本身通过 OLE 执行此操作。当然，您需要安装 Photoshop。Perl 中的 Win32::OLE 或 Python 中的类似模块。请参阅[http://www.adobe.com/devnet/photoshop/pdfs/PhotoshopScriptingGuide.pdf](http://www.adobe.com/devnet/photoshop/pdfs/PhotoshopScriptingGuide.pdf)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-12T03:01:50.310

如果您要使 Photoshop 自动化，您几乎必须使用 Photoshop 自己的脚本系统。我不认为有办法解决这个问题。

换个角度看问题，你能不能从 Photoshop 导出到其他支持图层的格式，比如 PNG，ImageMagick 可以编辑它？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-01-28T10:14:20.030

您也可以使用 Node.js 进行尝试。我做了一个[PSD命令行工具](https://www.npmjs.com/package/psd-cli)

一行命令安装（需要安装NodeJS/NPM）

`npm install -g psd-cli`

然后，您可以通过在终端中输入来使用它

`psd myfile.psd -t`

您可以检查代码以从另一个节点脚本中使用它，或者通过您的 shell 使用它来自另一个 Bash/Perl/whatever 脚本。

# regex - 正则表达式相反

> ID：850907
> 
> 赞同：31
> 
> 时间：2009-05-12T02:29:34.547
> 
> 标签：regex

是否可以编写一个返回所需结果的逆向的正则表达式？正则表达式通常具有包容性 - 查找匹配项。我希望能够将正则表达式转换为相反的 - 断言没有匹配项。这可能吗？如果是这样，怎么做？

[http://zijab.blogspot.com/2008/09/finding-opposite-of-regular-expression.html](http://zijab.blogspot.com/2008/09/finding-opposite-of-regular-expression.html)声明你应该用括号括起来你的正则表达式

```
/^((?!^ MYREGEX ).)*$/ 
```

，但这似乎不起作用。如果我有正则表达式

```
/[a|b]./ 
```

，字符串“abc”使用我的正则表达式和 zijab 建议的相反返回 false，

```
/^((?!^[a|b].).)*$/ 
```

. 是否可以编写正则表达式的逆向，还是我想错了？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-12T02:34:18.390

你不能检查一下是否没有匹配项吗？我不知道您使用的是什么语言，但是这个伪代码怎么样？

```
if (!'Some String'.match(someRegularExpression))
    // do something... 
```

如果您只能更改正则表达式，那么您从链接中获得的那个应该可以工作：

```
/^((?!REGULAR_EXPRESSION_HERE).)*$/ 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-12T21:21:31.170

您的倒置正则表达式不起作用的原因是因为`^`负前瞻中的 ' '：

```
/^((?!^[ab].).)*$/
      ^            # WRONG 
```

也许它在 vim 中有所不同，但在我熟悉的每种正则表达式风格中，插入符号匹配字符串的开头（或多行模式下的行开头）。但我认为这只是博客条目中的一个错字。

您还需要考虑您正在使用的正则表达式工具的语义。例如，在 Perl 中，这是真的：

```
"abc" =~ /[ab]./ 
```

但在 Java 中，这不是：

```
"abc".matches("[ab].") 
```

这是因为传递给该`matches()`方法的正则表达式隐式锚定在两端（即`/^[ab].$/`）。

采用更常见的 Perl 语义`/[ab]./`意味着目标字符串包含一个由“a”或“b”组成的序列，后跟至少一个（非行分隔符）字符。换句话说，在任何时候，条件都是 TRUE。该语句的反面是，在每一点条件都是 FALSE。这意味着，在您使用每个字符之前，您执行一个否定的前瞻来确认该字符不是匹配序列的开始：

```
(?![ab].). 
```

而且您必须检查*每个*字符，因此必须将正则表达式锚定在两端：

```
/^(?:(?![ab].).)*$/ 
```

这是一般的想法，但我认为不可能反转*每个*正则表达式 - 当原始正则表达式可以包括正面和负面的环视、不情愿和所有格量词以及谁知道什么时，就不可能了。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-12T19:02:13.300

You can invert the character set by writing a `^` at the start (`[^…]`). So the opposite expression of `[ab]` (match either `a` or `b`) is `[^ab]` (match neither `a` nor `b`).

But the more complex your expression gets, the more complex is the complementary expression too. An example:

You want to match the literal `foo`. An expression, that does match anything else but a string that contains `foo` would have to match either

1.  any string that’s shorter than `foo` (`^.{0,2}$`), or
2.  any three characters long string that’s not `foo` (`^([^f]..|f[^o].|fo[^o])$`), or
3.  any longer string that does not contain `foo`.

All together this may work:

```
^[^fo]*(f+($|[^o]|o($|[^fo]*)))*$ 
```

But note: This does only apply to `foo`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-06-10T00:30:30.913

在 perl 中，您可以使用`$string !~ /regex/;`.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-03-02T23:16:40.277

您也可以通过使用`re.split`, 并根据您的正则表达式拆分来执行此操作（在 python 中），从而返回所有与正则表达式不匹配的部分，[如何找到正则表达式的逆](http://www.technomancy.org/python/strings-that-dont-match-regex/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-09-08T20:56:07.203

使用 grep，您可以使用`--invert-match`或`-v`。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-12-14T06:20:27.783

Java 正则表达式有一种有趣的方式来做到这一点（可以[在这里](http://www.regexplanet.com/advanced/java/index.html)测试），你可以为你想要的字符串创建一个贪婪的可选匹配，然后匹配它后面的数据。如果贪心匹配失败，它是可选的，所以没关系，如果它成功，它需要一些额外的数据来匹配第二个表达式，所以失败。

它看起来违反直觉，但有效。

例如，`(foo)?+.+`匹配`bar`，但不匹配（或空字符串）。`foox``xfoo``foo`

这在其他方言中可能是可能的，但我自己无法让它发挥作用（如果第二场比赛失败，他们似乎更愿意回溯？）

# objective-c - 在没有 Mac 的情况下学习 Objective C

> ID：850920
> 
> 赞同：8
> 
> 时间：2009-05-12T02:35:12.447
> 
> 标签：objective-c, ruby, frameworks

我没有 Mac 或 iPhone。然而，采用 C 语言并使其更加动态地转向 smalltalk、python 或 ruby​​ 的概念对我来说真的很有吸引力。我很想从目标 C 开始。

目标 C 只是 C 的语法超集还是*真的*像 C 一样。它可以用 gcc 等编译吗？

我的大部分编程都是用 Ruby 完成的。Objective C 似乎比 C 更宽容。你可以在 C 中为 Ruby 编写本机扩展。你可以在 Objective C 中为 Ruby 编写本机扩展吗？

除了拥有 Mac/iPhone 和 XCode 之外，我如何开始使用 Objective C？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-12T02:37:47.183

[维基百科](http://en.wikipedia.org/wiki/Objective-C)说

> 今天，它主要用于 Apple 的 Mac OS X 和 iPhone OS，这两个环境虽然不符合 OpenStep 标准，但它是 Apple Cocoa API 使用的主要语言，尽管它最初是 NeXT 的主要语言下一步操作系统。不使用这些库的通用 Objective-C 程序也可以为 gcc 支持的任何系统编译，其中包括一个 Objective-C 编译器。
> 
> 今天的 Objective-C 经常与标准对象的固定库（通常称为“工具包”或“框架”）结合使用，例如 Cocoa 或 GNUstep。

[如果您主要运行 Windows 并运行GNUStep](http://www.gnu.org/software/gnustep/)，也许您应该获得一个 Linux vm 。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T02:57:54.360

苹果将​​目标 c 更改贡献回 gcc（并不是说他们有很多选择，是 GPL）。所以无论你在哪里可以设置 gcc，你都可以设置一个 Objective-C 编译器。

除此之外，[Gnustep](http://www.gnu.org/software/gnustep/)环境可以为您提供一点原始 OpenStep/NextStep 环境的味道。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T02:49:26.557

是的，您可以在 MAC/IPhone 之外编写、编译和运行目标 c 程序

详情请查看以下链接 [http://www.otierney.net/objective-c.html#settingup](http://www.otierney.net/objective-c.html#settingup) [http://www.faqs.org/faqs/computer-lang/Objective-C/faq/](http://www.faqs.org/faqs/computer-lang/Objective-C/faq/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T02:56:53.940

Objective-C 语言和 Apple 在它之上构建的框架之间是有区别的。这些框架由一堆可以在代码中使用的对象组成，如果您的目标是 Mac 或 iPhone，它们尤其有用。在 GNUStep 中有一些类似的对象，但它不是 Cocoa/etc 库的完全替代品，尤其是不涵盖任何与 iPhone 相关的内容。

GNUStep 和 Objective-C 语言（通过 gcc）可用于许多平台，您可以编写自己的程序，使用 Objective-C 对象并与来自 Objective-C 的任何 C api 交互。

Objective-C 是 C 的超集，因此实际上并不比 C 更宽容，但可以说它比 C++（几乎是 C 的超集）更宽容。您也可以将 Objective-C 和 C++ 与 GCC 混合使用，但这会有点复杂，尤其是在异常处理方面。

不过，对于开始和使用该语言，GNUStep 和 GCC 将是一个不错的选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-12T02:59:09.287

我看不出有什么令人信服的理由为什么不能将 Objective C 用于原生 ruby​​ 扩展，除非你不会从中受益。您仍然必须使用较低级别的 C Api 调用，因为据我所知，objective-c 绑定没有任何红宝石。此外，Objective C 带有一个相当丰富的实用程序类库，虽然很有帮助，但在 ruby​​ 扩展的上下文中不会轻易证明它们的大小和重量是合理的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-01T21:15:28.093

您可以在此页面上进行 ObjC 的简单实验：http: [//www.codesign.cz/LearnObjC/](http://www.codesign.cz/LearnObjC/)

# python - 您可以将类（不是对象）作为参数传递给python中的方法吗？

> ID：850921
> 
> 赞同：8
> 
> 时间：2009-05-12T02:35:23.507
> 
> 标签：python, static, parameters

我想做如下的事情

```
class A:
  def static_method_A():
    print "hello"

def main(param=A):
  param.static_method_A() 
```

我希望这相当于`A.static_method()`. 这可能吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-12T02:37:44.890

当然。类是 Python 中的一等对象。

尽管在您的示例中，您应该为您的方法使用`@classmethod`(class object as initial argument) 或`@staticmethod`(no initial argument) 装饰器。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-12T02:39:51.550

您应该能够执行以下操作（注意`@staticmethod`装饰器）：

```
class A:
  @staticmethod
  def static_method_A():
    print "hello"
def main(param=A):
  param.static_method_A() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T02:38:29.727

确定为什么不呢？不要忘记将@staticmethod 添加到静态方法。

```
class A:
  @staticmethod
  def static_method_A():
    print "hello"

def main(param=A):
  param.static_method_A() 
```

# ruby-on-rails - 在 Rails 中，如何像在 ASP 中一样访问 Request.ServerVariables？

> ID：850934
> 
> 赞同：2
> 
> 时间：2009-05-12T02:39:13.000
> 
> 标签：ruby-on-rails, ruby, http-request

我想访问给定的 Requests ServerVariables，但我似乎在 Google 上找不到任何关于如何访问请求对象的 Server Vars 的信息。我该怎么做，还是我注定永远不知道？

***为什么我想这样做（但实际上不是我想要做的）的一个例子：*** *用户登录，你想存储他们登录的地方的 IP 地址，或者我想记录用户-来自浏览器的代理或推荐人，他们正在查看该网站。*

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-12T02:46:34.923

您应该查看`request`控制器中可用的对象。有很多方法，比如

`request.remote_ip`

您可以在 Rails API 网站上阅读有关[Request 对象的更多信息](http://api.rubyonrails.org/classes/ActionDispatch/Request.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T14:14:15.610

控制器中的`request`访问器返回一个 ActionDispatch::Request 对象，该对象可以访问您期望的所有服务器变量。

我找到的最佳文档在这里：[http ://apidock.com/rails/v3.2.1/ActionDispatch/Request](http://apidock.com/rails/v3.2.1/ActionDispatch/Request)

有时您有`request.remote_ip`其他答案中提到的方法，有时您可以通过 访问事物`request.env`，例如，要获取用户代理，请使用`request.env["HTTP_USER_AGENT"]`

# javascript - 如何生成tinymce到ajax生成的textarea

> ID：850938
> 
> 赞同：0
> 
> 时间：2009-05-12T02:40:14.607
> 
> 标签：javascript

如何生成tinymce到ajax生成的textarea有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T06:24:55.567

如果您向我展示您的代码，我可能会为您提供更好的帮助。但是，您应该能够调用此函数并将 Ajax 生成的 TextArea 的 id 传递给它。

```
//add this to your Ajax callback that generates the TextArea
//replace with the Id of the new textarea
var myTextArea = document.getElementById("MyNewTextArea"); 
generateTinyMCE(myTextArea);

//Add this function to your script tag
function generateTinyMCE(id) {
 if (!tinyMCE.get(id))
   tinyMCE.execCommand('mceAddControl', false, id);
 else
   tinyMCE.execCommand('mceRemoveControl', false, id);
} 
```

# scripting - 以编程方式设置即时消息显示消息

> ID：850950
> 
> 赞同：0
> 
> 时间：2009-05-12T02:44:18.297
> 
> 标签：scripting, instant-messaging

为即时通讯程序设置显示消息的脚本是简单还是复杂？经过一番搜索，似乎根本没有任何关于此的信息。

举个例子，如果我有一个报价的文本文件，是否可以将 google talk 显示消息每小时更改为不同的报价？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T03:18:37.523

取决于您使用的客户端。据我所知，Google 的客户端不提供任何插件接口，但开源即时通讯工具[Pidgin](http://www.pidgin.im/)提供。我认为已经有一个插件可以满足您的需求，但是您可以使用他们提供的[文档和示例编写自己的插件。](http://developer.pidgin.im/wiki/CHowTo)

编写这样的东西的复杂性取决于您对 C 或 Perl 的了解程度，因为您可以使用 Pidgin 中的任何一种进行编程。[从其他人的插件](http://plugins.guifications.org/trac/wiki/PluginPack)中读取代码，您应该能够弄清楚 Pidgin API。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-07-27T01:45:07.127

您可以使用 Kik API 以编程方式在移动应用程序之间发送丰富的内容和文件。它适用于 iPhone 和 Android 平台，只需大约 5 行代码即可集成到您的应用程序中。API 网站上有更多信息：[http ://www.kik.com/dev](http://www.kik.com/dev)

免责声明：我是 Kik API 背后的开发人员之一 :)

# jquery - 使用jquery从表格单元格定位扩展折叠框

> ID：850954
> 
> 赞同：0
> 
> 时间：2009-05-12T02:45:48.387
> 
> 标签：jquery, panel, expand, collapsable

我的问题是，是否有人知道如何在不扩展整个表格的情况下实现从表格单元创建滑动的效果。

它太独立于桌子顶部特定行的位置滑动，所以也可以这么说

否则它看起来很难看，正如您从[我的页面](http://www.woonbel.nl/registraties/registratie.php)中看到的那样 （单击第一行）我将 div 放置在单元格中

我想我也找到了 tablecell 的位置并将其放在它的顶部，但我还不知道该怎么做。

这是我用于幻灯片的代码：

```
$(".reg_info_body").hide();
$(".reg_info").toggle(function(){
$(this).children(".reg_info_body").slideDown(100);
}, function(){
$(this).children(".reg_info_body").slideUp(300);
}); 
```

谢谢，理查德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-12T02:51:52.527

如果你使用 css 来垂直对齐：top; 那张桌子的单元格能解决你的问题吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T02:56:24.517

只需将其添加到您的样式中即可：

***位置：固定；宽度：400px；***

```
.reg_info_body {
background-color:#F4F4F8;
height:200px;
padding:5px 10px 15px;
position:fixed;
width:400px;
z-index:100;
} 
```

在 FF-FireBug 中测试

* * *

如果您想向用户显示有关该字段的提示或信息，最好使用[jQuery Beauty Tip 插件](http://www.lullabot.com/articles/announcing-beautytips-jquery-tooltip-plugin)。太棒了，我在我的项目中使用它:)

# c# - 如何限制基于 WPF 的应用程序中的光标移动？

> ID：850956
> 
> 赞同：3
> 
> 时间：2009-05-12T02:46:31.087
> 
> 标签：c#, wpf, mouse, cursor-position

我正在使用 WPF 应用程序，更具体地说是带有可拖动元素的 Canvas。

拖动项目后，我想将光标移动的范围限制在拖动项目的画布内。

可以开始拖动的事件如下所示

```
 private void WidgetCanvas_PreviewHeaderLeftMouseDown(object sender, MouseButtonEventArgs e)
{
     e.Handled = true;
     ... logic to figure out if this is a valid drag, blah blah blah ...

     this.IsDragging = true;
     // TODO: clip the available cursor movement to actual width of Canvas
} 
```

在 Preview-MouseUp 上，我想简单地将光标移动“取消剪辑”回到正常状态。

一旦开始拖动（PreviewMouseMove），我将监视鼠标的移动，所以最坏的情况是，我可以手动检查鼠标的位置并将其限制在画布上，但这似乎有点难看。

有人有更好的方法来限制光标边界吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T03:57:52.107

[没有干净的方法可以做到这一点](http://social.msdn.microsoft.com/forums/en-US/wpf/thread/7d0418d2-4b6c-4711-9c17-6e0d0718912f/)，不那么干净的方法会使您的鼠标光标[在剪辑区域的边界处“抖动”](http://social.msdn.microsoft.com/forums/en-US/wpf/thread/7d0418d2-4b6c-4711-9c17-6e0d0718912f/)。

此外，我会质疑这是否真的是一个好主意。用户应该真正*拥有*鼠标，当您试图人为地限制他或她拥有的东西时，他或她通常会感到沮丧。

如果您想在鼠标离开画布时提供反馈，也许您可​​以在鼠标按钮仍然按下时让被拖动的项目卡在边框上？这将告诉用户他或她已经离开了目标区域，而没有试图对鼠标可以去的地方施加限制。

祝你好运！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T08:29:31.523

您应该可以使用[ClipCursor](http://msdn.microsoft.com/en-us/library/ms648383.aspx)本机 API 来完成。

# asp.net - 将 TemplateField 添加到 DetailsView

> ID：850960
> 
> 赞同：2
> 
> 时间：2009-05-12T02:47:53.907
> 
> 标签：asp.net, detailsview, templatefield

如何将 TemplateField 控件添加到 DetailsView Fields 集合的开头？

这是我的代码..

```
TemplateField tf = new TemplateField();
...
...
dv.Fields.Add(tf); 
```

这将添加到 DetailsView 控件的最后。我尝试了 dv.Fields(0) 但没有可用的 Add 方法。我注意到我们有 dv.Fields.RemoveAt 但我们没有 dv.Fields.AddAt...

有任何想法吗？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T04:26:35.103

要在开头添加字段，请使用**[INSERT](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datacontrolfieldcollection.insert.aspx)**方法，如下所示：

```
TemplateField tf = new TemplateField();
...
...
dv.Fields.Insert(0, tf); 
```

# ruby-on-rails - 如何使 Rails 助手更面向对象

> ID：850965
> 
> 赞同：1
> 
> 时间：2009-05-12T02:50:38.770
> 
> 标签：ruby-on-rails, oop, helpers

对于所有帮助者，我想在我的整个 Rails 应用程序中替换以下语法：

```
time_ago_in_words(@from_time) 
```

有了这个：

```
@from_time.time_ago_in_words 
```

理想情况下，此更改还将使助手在我的应用程序中的任何位置都可用（例如，相同的方式`5.times`）。

有谁知道这样做的插件？自己动手会不会很困难？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T03:52:13.037

如果您创建一个新模型，您可以使其继承现有类的方法。

示例（app/models/mykindofstring.rb）：

```
class Mykindofstring < String

    def all_caps_and_reverse
        self.upcase.reverse
    end 

end 
```

然后从控制器：

```
@my_string = Mykindofstring.new('This is my string') 
```

最后从视图中调用它：

```
<%= @my_string %> 
```

显示为这是我的字符串，而：

```
<%= @my_string.all_caps_and_reverse %> 
```

显示为 GNIRTS YM SI SIHT。

该类继承自字符串类，因此适用于字符串的所有方法也适用于 mykindofstring 对象。其中的方法只是两个现有字符串方法组合的新名称，但您可以让它做任何您想做的事情，例如将时间转换为格式化字符串的方法。

基本上它只是用你自己的方法扩展一个当前的 Ruby 类，而不是使用函数/帮助器。

**主要编辑**

基于 Ians 对此答案的评论和他自己对上述问题的回答，我在 Rails 中进行了一些尝试，并想出将其添加到 application_helper.rb 中：

```
module ApplicationHelper
  String.class_eval do
    def all_caps_and_reverse
      self.upcase.reverse
    end
  end
end 
```

现在只需在应用程序中的任何字符串上调用该方法：

```
@string = 'This is a string.'
@string.all_caps_and_reverse 
```

.gnirts a si sihT

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T14:57:07.183

对于所有（或什至大多数）助手，您不会在整个应用程序中找到任何简单的方法来执行此操作。

帮助程序被构造为旨在包含在视图呈现类中的模块。要利用它们，您必须保留一个 ActionView 的副本（我想这不是一笔大买卖）。

但是，您始终可以打开类并指定所需的每个助手：

```
class Time
  def time_ago_in_words
    ActionView::Base.new.time_ago_in_words self
  end
end

>> t = Time.now
=> Tue May 12 10:54:07 -0400 2009
>> t.time_ago_in_words
=> "less than a minute"
(wait a minute)
>> t.time_ago_in_words
=> "1 minute" 
```

如果您采用这种方法，我建议缓存您使用的 ActionView::Base 实例。或者，如果你不想变得如此重量级，你可以创建自己的类来只包含你想要的帮助器（你不想直接在每个时间、日期、字符串等类中包含帮助器，尽管，因为这会使方法命名空间非常混乱——并且与您想要的自然名称冲突）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-19T13:11:44.727

如果您使用的是 Ruby 2.1，则可以使用 Refinements。它们是猴子修补 Ruby 类的替代方案。借用[@Jarrod 的猴子补丁](https://stackoverflow.com/a/851064/276959)示例：

```
module MyString
  refine String do
    def all_caps_and_reverse
      upcase.reverse
    end
  end
end 
```

您现在可以在任何您想要的对象中使用它：

```
class Post
  using MyString
end
@post.title.all_caps_and_reverse 
```

您可以在此处[阅读有关细化](http://www.sitepoint.com/look-ruby-2-1/)的更多信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T02:56:52.723

制作一个模型，TimeAgo 或类似的东西。在此处实现以下想法： [“文字化”数字的代码片段](http://codesnippets.joyent.com/posts/show/447)

然后，在您的控制器中，使用此类创建实例变量。然后，在您看来，请致电`@from_time.in_words`

# c# - Sharepoint - 以编程方式检索用户组和权限

> ID：850969
> 
> 赞同：2
> 
> 时间：2009-05-12T02:53:34.083
> 
> 标签：c#, sharepoint

目前我正在尝试检索我的共享点站点中的所有组。之后，我需要知道组中有哪些用户以及每个用户的站点权限级别。我正在使用 WSS 3.0 ，在 C# (visual studio 2008) 中开发。真的需要帮助，因为我还是这个领域的新手。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T03:29:44.430

可以找到如下组：

```
SPSite siteCollection = new SPSite("site url");
SPWeb site = siteCollection.OpenWeb();

foreach(SPGroup group in site.Groups){
  Console.WriteLine(group.Name);

   foreach(SPUser u in group.Users){
         //will give you users in group, you can then grab the roles of the user
   }
} 
```

要查找角色具有的权限：

```
SPSite oSiteCollection = SPContext.Current.Site;
using(SPWeb oWebsite = oSiteCollection.AllWebs["Site_Name"])
{
    SPMember oMember = oWebsite.Roles["Role_Name"];
    oWebsite.Permissions[oMember].PermissionMask = 
        SPRights.ManageLists | SPRights.ManageListPermissions;
} 
```

权限矩阵可以在[这里找到](http://office.microsoft.com/en-us/sharepointtechnology/HA101001491033.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-22T17:58:24.810

如果您正在寻找使用客户端对象模型的代码，您可以查看以下链接。

1.  为了获得团体。 [http://social.technet.microsoft.com/wiki/contents/articles/24075.how-to-get-sharepoint-user-group-names-in-a-netc-client-application-using-sharepoint-client-对象模型.aspx](http://social.technet.microsoft.com/wiki/contents/articles/24075.how-to-get-sharepoint-user-group-names-in-a-netc-client-application-using-sharepoint-client-object-model.aspx)

2.  用于获取与组关联的权限级别。 [http://social.technet.microsoft.com/wiki/contents/articles/24087.how-to-get-the-permission-levels-associated-with-sharepoint-user-groups-using-client-object-model- in-netc.aspx](http://social.technet.microsoft.com/wiki/contents/articles/24087.how-to-get-the-permission-levels-associated-with-sharepoint-user-groups-using-client-object-model-in-netc.aspx)

# c# - 使用 try、catch 块的目的是什么？

> ID：850970
> 
> 赞同：0
> 
> 时间：2009-05-12T02:53:49.590
> 
> 标签：c#, .net, try-catch

它是 if, then 块的替代品吗？我见过很多这样使用它们的代码。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-12T02:57:34.373

不，它不是 if 和 then 块的替代品，它的用途完全不同。try, catch 块的目的是尝试做一些可能失败并引发异常的事情（例如，从磁盘读取文件，但文件可能不存在，等等）。捕获异常后，您可以处理它。

```
try {
   riskyOperation();
catch (ExpectedException) {
   handleException();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T02:57:44.500

try catch 块的目的是让你*尝试*执行和操作，然后如果发生异常，*捕获*异常并优雅地处理它而不是崩溃。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-04T18:31:09.090

try 块是发生异常的代码块。

catch 块捕获并处理 try 块异常。

# hibernate - 在两列上创建休眠集合

> ID：850977
> 
> 赞同：1
> 
> 时间：2009-05-12T02:57:23.470
> 
> 标签：hibernate

我正在尝试创建一个地址簿应用程序，其中一个表用于人员，另一个用于公司，第三个用于电话。Phones 表将包含 People 和 Companies 的数据，并有一个字段指示数据的来源。让我们假设这些是简单的表：

```
CREATE TABLE `Person` {
  `id` int(11) NOT NULL auto_increment,
  `firstName` varchar(80) NOT NULL,
  `lastName` varchar(80) NOT NULL
}

CREATE TABLE `Company` (
  `id` int(11) NOT NULL auto_increment,
  `name` varchar(80) NOT NULL
}

CREATE TABLE `ContactPhone` (
  `id` int(11) NOT NULL auto_increment,
  `contactType` char(1) NOT NULL, -- either 'P' or 'C'
  `contactId` int(11) NOT NULL, -- the id of the Person or Company
  `number` varchar(40) NOT NULL
} 
```

我已经创建了它们对应的 java 类，它们是一个非常简单的表示形式：

```
public class Person {
  private Integer id;
  private String firstName;
  private String lastName;
  private Collection<Phone> phones;
  // ...
}

public class Company {
  private Integer id;
  private String name;
  private Collection<Phone> phones;
  // ...
}

public class Phone {
  private Integer id;
  private String number;
  // ...
} 
```

在简单的 SQL 中，我可以很容易地得到这个人和相应的电话。我需要使用普通休眠（无注释）创建人员与电话之间以及公司与电话之间的映射，但无法使其正常工作。甚至不确定它必须是单向的还是双向的。我已经搜索了文档，但没有找到任何可以提供帮助的东西。任何人？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T00:40:52.633

最后我设法得到这个工作。我正在寻找的是hibernate的多态性元素。我最终创建了一个 Contact 类，如下所示：

```
public class Contact {
  private Integer id;
  private Collection<Phone> phones;
  ...
} 
```

并从中派生出 Person 和 Company。借助 Hibernate 的多态性，可以将 Person 和 Company 存储在不同的表中，并让 Phone 以双向方式连接到 Contact。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T03:16:32.190

您可以使用Hibernate的[“过滤器”映射功能](http://www.redhat.com/docs/manuals/jboss/jboss-eap-4.3/doc/hibernate/Hibernate_Reference_Guide/Filtering_data-Hibernate_filters.html)来实现这一点

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T05:07:59.153

如果您询问如何通过配置文件中的映射表映射它们，它看起来像这样：

`<bag name="Phone" table="CompanyPhoneMapping" lazy="true" cascade="all">`

`<key column="CompanyId" />`

`<one-to-many class=<insert namespace>.Phone, <insert dll> />`

`</bag>`

我只熟悉 nhibernate，但我认为 java hibernate 解决方案是相似的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T04:44:51.070

`Person`可接受的模型是与和`Company`类中的连接表的单向关联。如何实现这一点完全取决于您的模型的具体情况。在线文档在[这里](http://docs.jboss.org/hibernate/stable/core/reference/en/html/assoc-unidirectional-join.html)。

# opengl - 在OpenGL中绘制“点状”形状，对缩放无所谓

> ID：850988
> 
> 赞同：3
> 
> 时间：2009-05-12T03:04:02.460
> 
> 标签：opengl, graphics, graph

我正在使用 Qt 和 QWt3D 绘图工具，并扩展它们以提供我需要的一些 3-D 和 2-D 绘图功能，因此我在此过程中学习了一些 OpenGL。

我目前能够使用 OpenGL 绘制点，但只能作为圆形（或通过关闭抗锯齿来实现的“正方形”）。这些点以我喜欢的方式运行 - 即它们不会在我放大时改变大小，尽管它们的 x/y/z 位置在我缩放、平移等时会适当移动。

我想做的是使用无数形状（^、<、>、*、.等）绘制点。根据我对 OpenGL 的理解（不是很多），这并非易事，因为 OpenGL 将所有内容视为“真实”3-D 对象，因此放大任何 openGL 形状但“点”会改变对象的投影尺寸。

在做了一些阅读之后，我认为这个问题有（至少）两种可能的解决方案：

1.  使用 OpenGL 纹理。这似乎并不难，但我相信纹理图像会随着我的放大而变得越来越小——对吗？

2.  使用 OpenGL 多边形、线条等并绘制 *、三角形或其他任何东西。但是在这里我又遇到了同样的问题——如何防止 OpenGL 在缩放时重新调整“点”的大小？

每次用户缩放或平移以确保点保持相同大小时，是否只是硬着头皮重新绘制整个数据集？有没有办法告诉openGL不要重新计算对象的大小？

抱歉，如果这在某处的 OpenGL 文档中 - 我找不到它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-12T03:18:52.297

您想要的称为“点精灵”。OpenGL1.4 通过`ARB_point_sprite`扩展支持这些。

试试这个教程

[http://www.ploksoftware.org/ExNihilo/pages/Tutorialpointsprite.htm](http://www.ploksoftware.org/ExNihilo/pages/Tutorialpointsprite.htm)

看看它是否是你要找的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T04:29:24.287

无论如何，每次用户缩放或平移时都会重新绘制场景，因此您不妨重新计算大小。

您建议使用带纹理的多边形，或直接使用多边形，这对我来说听起来不错。听起来您希望绘图点在相机移动时保持在图表中的正确位置，但您希望防止它们在用户缩放时改变大小。为此，只需调整绘图点多边形的大小，使多边形大小与到相机的距离之间的比率保持不变。如果你有很多情节点，计算到相机的距离可能会因为涉及平方根而变得昂贵，但查找表可能会解决这个问题。

除了调整大小之外，您还希望保持情节点朝向相机，因此[广告牌](http://nehe.gamedev.net/data/articles/article.asp?article=19)是您的解决方案。

另一种方法是[投影](http://www.opengl.org/documentation/specs/man_pages/hardcopy/GL/html/glu/project.html)每个 3D 绘图点位置以找出它们的 2D 屏幕坐标。然后只需在这些屏幕坐标处渲染多边形。无需重新缩放。但是，gluProject 非常慢，所以如果这不是比我第一次建议的那样简单地重新缩放绘图点多边形慢几个数量级的话，我会感到非常惊讶。

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T03:11:18.020

没有简单的方法可以做你想做的事。您必须根据相机的当前缩放动态调整您正在绘制的图元的大小。您可以使用一种称为[*广告牌*](http://www.lighthouse3d.com/opengl/billboarding/)的技术来确保您的对象始终面向相机。

# objective-c - integerForKey 总是使应用程序崩溃

> ID：850989
> 
> 赞同：3
> 
> 时间：2009-05-12T03:04:37.500
> 
> 标签：objective-c

**在使用setInteger:forKey**保存后使用**integerForKey**从**标准**用户默认值中检索值总是会使应用程序崩溃。

 ****如果我使用**objectForKey**检索值并将值转换为 int，则没有错误，我可以在日志消息中显示值。但是，当我尝试将该 int 分配给另一个 int 或尝试对其执行数学函数（例如添加）时，它也会使应用程序崩溃。

如何检索已保存到 standardUserDefaults 的 int？我正在针对 SDK 3.0 进行开发，但在 2.2.1 中遇到了相同的问题。谢谢。

首选项定义为

```
NSUserDefaults *prefs; 
```

并且retrievePrefs 总是在savePrefs 之前调用。应用程序在退出前还会调用 [prefs synchronize]。

```
-(void)retrievePrefs {
    prefs = [[NSUserDefaults standardUserDefaults] retain];
    if (prefs) {
       // doesn't crash app, spits out 'page: 1'
       NSLog(@"page: %@", [prefs objectForKey:@"pageIndex"]); 

       // crashes app with no details
       NSLog(@"page: %@", [prefs integerForKey:@"pageIndex"]); 
    }
}

-(void)savePrefs {
    if (prefs) {
        [prefs setInteger:1 forKey:@"pageIndex"];
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T03:08:26.963

您的第二个 NSLog 调用是导致它的原因：`%@`限定符用于打印出 Objective-C 对象或 CoreFoundation CFTypeRefs，因此它将该整数解释为指针并尝试取消引用它。

你需要的是：

```
-(void)retrievePrefs {
    prefs = [[NSUserDefaults standardUserDefaults] retain];
    if (prefs) {
        NSLog(@"page: %@", [prefs objectForKey:@"pageIndex"]);
        NSLog(@"page: %ld", (long)[prefs integerForKey:@"pageIndex"]);
    }
} 
```

查看 API 文档以`NSLog`获取更多信息`printf`。`-[NSString stringWithFormat:]`

# c# - 使用 LINQ 如何过滤字符串列表中匹配模式“q1、q2”等的值？

> ID：850999
> 
> 赞同：0
> 
> 时间：2009-05-12T03:13:19.730
> 
> 标签：c#, linq

这应该是一个简单的问题，但我正在寻找最好的答案，至少考虑到性能和优雅。

我有一个字符串列表，*其中一些*值的格式为 q1、q2、q3 等。

我想选择这些。

这样做的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T03:13:31.963

最好的答案是使用 Regex 或[Jay Bazuzi 的 int.TryParse 建议](https://stackoverflow.com/questions/850999/using-linq-how-do-you-filter-a-list-of-strings-for-values-that-match-the-pattern/851033#851033)。

作为一个简单的例子，在[LINQPad](http://www.linqpad.net/)中试试这个：

```
void Main()
{
    int n = 100;

    string[] a = {"q2", "q3", "b"};
    a = a.Concat(Enumerable.Repeat(0,n).Select(i => "qasd")).ToArray(); /* Random data */

    /* Regex Method */
    System.Text.RegularExpressions.Regex r = new System.Text.RegularExpressions.Regex("^q[0-9]+$");
    List<string> regMethod = a.Where(c => r.IsMatch(c)).ToList().Dump("Result");

    /* IsInteger Method */
    List<string> intMethod = a.Where(c => c.StartsWith("q") && IsInteger(c.Substring(1))).ToList().Dump("Result");

    /* int.TryParse Method suggest by Jay Bazuzi */
    int e = 0;
    List<string> parseMethod = a.Where(c => c.StartsWith("q") && int.TryParse(c.Substring(1), out e)).ToList().Dump("Result");
}

public static bool IsInteger(string theValue)
{
   try
   {
       Convert.ToInt32(theValue);
       return true;
   } 
   catch 
   {
       return false;
   }
} 
```

尝试一次注释掉这两种方法中的一种，并尝试不同 n 值的性能。

我的经验（在我的 Core 2 Duo 笔记本电脑上）似乎表明：

```
n = 100\. Regex takes about 0.003 seconds, IsInteger takes about 0.01 seconds
n = 1,000\. Regex takes about 0.004 seconds, IsInteger takes about 0.07 seconds
n = 10,000\. Regex takes about 0.007 seconds, IsInteger takes about 0.67 seconds
n = 100,000\. Regex takes about 0.046 seconds, IsInteger takes about 6.9 seconds
n = 1,000,000\. Regex takes about 0.42 seconds, IsInteger takes about 1 minute and 6 seconds 
```

ParseMethod 具有与 Regex 相同的性能（如果在代码示例中内联完成，则速度稍快，如果在单独的方法中完成，则大致相同，即替换 IsInteger 方法体）。

注意：不考虑创建字符串的成本（如果您愿意，请插入日期差异），但两种方法的成本相同

如果大多数键不使用“q”（从未调用 IsInteger），则这些数字更接近，但*即使在这种情况下，Regex 也一样好或更好*

即（对于“asdasd”而不是“qasd”的填充字符串）：

```
n = 100\. Regex takes about 0.003 seconds, IsInteger takes about 0.003 seconds
n = 1,000\. Regex takes about 0.004 seconds, IsInteger takes about 0.004 seconds
n = 10,000\. Regex takes about 0.005 seconds, IsInteger takes about 0.005 seconds
n = 100,000\. Regex takes about 0.023 seconds, IsInteger takes about 0.025 seconds
n = 1,000,000\. Regex takes about 0.21 seconds, IsInteger takes about 0.22 seconds 
```

ParseMethod 再次具有与 Regex 相同的性能。

**结论：**使用 Regex 或 TryParse，在最坏的情况下它会快得多，否则同样快

但是，是否有更好/更快的方法从字符串集合中选择 int 值？也许是一个以某种方式编译得更快的通用过滤器？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T03:34:25.157

似乎您正在尝试进行微优化，这意味着您将花费大量精力来使程序以相同的速度运行。首先关注代码的清晰性，然后优化实际上很慢的部分。

**假设您已经分析并发现这是您的应用程序在实际场景中的瓶颈：**

**在非异常**情况下使用异常是不优雅的（并且通常是性能拖累）。例如，请参见[http://www.developerfusion.com/code/4650/validating-an-integer/ 。](http://www.developerfusion.com/code/4650/validating-an-integer/)

根据您的情况的限制，您最好将您更改`IsInteger()`为执行以下操作之一：

```
bool int.TryParse(string s, out int result); 
```

（见[http://msdn.microsoft.com/en-us/library/system.int32.tryparse.aspx](http://msdn.microsoft.com/en-us/library/system.int32.tryparse.aspx)）

或者：

```
Microsoft.VisualBasic.Information.IsNumeric(object expression) 
```

（见[http://www.hanselman.com/blog/ExploringIsNumericForC.aspx](http://www.hanselman.com/blog/ExploringIsNumericForC.aspx)）

或者

```
x >= '0' && x < '9' 
```

进而：

```
.Where(c => c[0] == 'q' && IsInteger(c[1])) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T05:15:01.530

IsInteger 遇到的瓶颈可能是由于 try-catch。

我尝试用 TryParse 替换 IsInteger，得到以下结果（n=1,000,000）：

正则表达式方法：540 毫秒

TryParse 方法：537 毫秒

对于第二种方法，我使用了以下代码：

```
Func<string, bool> lambda = (string c) => { Int32 temp; 
                                    return c.StartsWith("q") 
                                    && int.TryParse(c.Substring(1),out temp); };
List<string> intMethod = a.Where(lambda).ToList(); 
```

故事的寓意是...

虽然我通常更喜欢使用 Regex，但在这种字符串操作很简单的简单情况下，TryParse 解决方案是完全可以接受的。在性能方面，您使用哪种方法并不重要，但不要使用异常处理来检查某个字符串值是否为 int！*********************