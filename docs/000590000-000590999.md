# StackOverflow 问答 000590000-000590999

# scala - Scala 的“规范”BDD 框架如何工作？

> ID：590002
> 
> 赞同：7
> 
> 时间：2009-02-26T10:39:08.613
> 
> 标签：scala, bdd, specs

我刚刚开始使用 Scala，我想知道哪种语言功能允许您这样做：

```
"PersistentQueue" should {
  "add and remove one item" in {
    withTempFolder {
      val q = new PersistentQueue(folderName, "work", Config.fromMap(Map.empty))
      q.setup

      q.length mustEqual 0
      q.totalItems mustEqual 0
      q.bytes mustEqual 0
      q.journalSize mustEqual 0

      q.add("hello kitty".getBytes)

      q.length mustEqual 1
      q.totalItems mustEqual 1
      q.bytes mustEqual 11
      q.journalSize mustEqual 32

      new String(q.remove.get.data) mustEqual "hello kitty"

      q.length mustEqual 0
      q.totalItems mustEqual 1
      q.bytes mustEqual 0
      q.journalSize mustEqual 33

      q.close
      dumpJournal("work") mustEqual "add(11:0:hello kitty), remove"
    }
  }
} 
```

这是来自[Kestrel 的单元测试](http://github.com/robey/kestrel/blob/2ae2eabef5ff38073967d21b210ad51349b7428c/src/test/scala/net/lag/kestrel/PersistentQueueSpec.scala)。

这里发生了什么？是否`"PersistentQueue" should`意味着 Scala 字符串类已经使用“应该”方法进行了扩展，或者这里发生了其他事情？我快速浏览了 Scala 文档，但看不到此代码示例使用了哪些语言功能。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-26T11:08:19.790

在我看来，隐式方法似乎被添加到 String 类中。[这篇文章](http://scalada.blogspot.com/2008/03/implicit-conversions-magical-and.html)有一个演示。

# php - 用于黑客攻击的稳定 PHP CMS

> ID：590006
> 
> 赞同：2
> 
> 时间：2009-02-26T10:41:01.353
> 
> 标签：php, content-management-system

我已经使用 Wordpress 和 Joomla 构建了几个小型网站，并进行了一些黑客操作以使它们完全按照我的意愿运行。但是这两个，可能还有许多其他 PHP CMS，都受到不断涌现的安全修复的影响。我不需要时间来测试修复程序，确保我的自定义仍然有效，并在有人攻击站点之前将它们推出，然后一个月后再次做同样的事情 - 我永远不会做任何其他事情一种开销。

所以我的问题是：是否有一个（最好是 PHP）内容管理系统以某种方式成功地避免了不断的安全更新和由此产生的测试/系统管理员工作？所以我可以在有时间的时候继续努力，而不是继续努力修补最新的攻击？

拥有健全的插件模型以使其更容易编码的奖励积分。如果它提供了一种从 Joomla 和/或 wordpress 导入数据的简单方法，则会获得更多奖励积分。

谢谢

编辑：正如正确指出的那样，完全避免更新不是一个明智的目标。相反，我想尽量减少更新带来的痛苦。所以我真正想要的是：

*   易于适应和主题，以保证在更新期间不会中断
*   简单的更新过程

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-26T13:29:40.310

没有 cms（没有软件，就此而言）如此安全，您无需更新。开发人员犯了错误，并出现了新的漏洞。所以每个 cms*都应该*“受到不断的安全修复”。如果不是，您应该询问自己有关项目的安全策略和站点的安全性。有关相关阅读，请参阅[安全上的开放安全模型、Drupal 和 ExpressionEngine 。](http://www.lullabot.com/articles/drupal-and-expressionengine-security-models)

因此，除非您不关心网站的安全性，否则您是在问错误的问题。我认为它实际上应该是：是否有一个可以在*不修改核心文件*的情况下进行自定义的 cms，以便安全更新不会破坏我的自定义？或者：如何自定义 cms 以使安全更新不会破坏我的自定义？安全更新通常不会破坏（甚至是自定义的）站点 - 除非自定义以错误的方式完成。

我对这个新问题的回答是[Drupal](http://drupal.org/)（包括加分）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T14:54:59.123

WordPress 的最新版本（2.7 分支）具有核心和插件的自动更新功能，因此在修复可用时升级非常容易。api 也很棒——我做过很多基于 WordPress 的网站，很少（如果有的话）需要破解核心。

只要您通过插件或主题进行自定义，并在新版本可用时使用自动更新，您应该没有任何问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T10:52:49.470

我喜欢用 PHP 编写的[CMS Made Simple 。](http://www.cmsmadesimple.org/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T11:22:39.773

在安全性、稳定性和灵活维护方面，我建议使用 Symfony 框架（参见：[http](http://www.symfony-project.org/) ://www.symfony-project.org/ ）。它有很多插件，支持 wordpress、joomla 和任何你需要的东西。[另请参阅http://cakephp.org](http://cakephp.org)上的 PHPcake

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T11:35:17.560

我真的很喜欢EllisLab 制作的[ExpressionEngine](http://expressionengine.com/)，它基于他们的开源框架[CodeIgniter](http://codeigniter.com/)（我认为这是最好的 PHP MVC 框架之一）。

有一个用于非商业用途的免费版本的 ExpressionEngine，这是我用过的全部，但付费插件 + 模块看起来很漂亮。

至于真正免费，[ModX](http://modxcms.com/)还可以，但坦率地说，它有一个奇怪的插件系统，也就是说，我在上面建立了几个网站，并对结果感到满意。

# python - Python 或 IronPython

> ID：590007
> 
> 赞同：33
> 
> 时间：2009-02-26T10:41:16.173
> 
> 标签：python, ironpython, cpython

IronPython 如何与 python.org 的 Python 默认 Windows 实现相叠加？如果我正在学习 Python，我会用 IronPython 学习一种微妙的不同语言吗？没有什么库我会做什么？

或者，IronPython 是否有任何优点（不包括 .NET IL 编译的类）可以使其更具吸引力？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-02-26T14:30:48.447

有许多重要的区别：

1.  与其他 .NET 语言的互操作性。例如，您可以使用 IronPython 应用程序中的其他 .NET 库，或使用 C# 应用程序中的 IronPython。随着 .NET 4.0 中对动态类型的更大支持，这种互操作性正在增加。有关这方面的更多详细信息，请参阅PDC 2008 上的[这](http://channel9.msdn.com/pdc2008/TL10/) [两个](http://channel9.msdn.com/pdc2008/TL16/)演示文稿。
2.  Better concurrency/multi-core support, due to lack of a GIL. (Note that the GIL doesn't inhibit threading on a single-core machine---it only limits performance on multi-core machines.)
3.  Limited ability to consume Python C extensions. The [Ironclad](http://code.google.com/p/ironclad/) project is making significant strides toward improving this---they've nearly gotten [Numpy](http://numpy.scipy.org/) working!
4.  Less cross-platform support; basically, you've got the CLR and [Mono](http://www.mono-project.com/Main_Page). Mono is impressive, though, and runs on many platforms---and they've got an implementation of Silverlight, called [Moonlight](http://www.mono-project.com/Moonlight).
5.  Reports of improved performance, although I have not looked into this carefully.
6.  功能滞后：由于 CPython 是参考 Python 实现，它具有“最新和最伟大”的 Python 功能，而 IronPython 必然落后。许多人不认为这是一个问题。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-26T10:47:57.500

编写代码的方式存在一些细微差别，但最大的区别在于可用的库。

使用 IronPython，您可以获得所有可用的 .Net 库，但代价是一些尚未移植到 .Net VM 的“普通”python 库。

基本上，您应该期望语法和习语相同，但是如果您尝试将 IronPython 编写的脚本提供给“常规”Python 解释器，则它不会运行。反过来可能更有可能，但我认为你也会发现差异。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-26T10:47:34.833

嗯，它通常更快。

不能使用模块，只有库的一个子集。

[这是差异列表。](http://www.codeplex.com/IronPython/Wiki/View.aspx?title=Differences)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-26T14:36:37.247

请参阅博文[IronPython 是一种单向门](http://www.johndcook.com/blog/2009/02/26/ironpython-is-a-one-way-gate/)。它总结了我在 StackOverflow 上提问时学到的关于 IronPython 的一些知识。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-26T10:55:51.257

Python 是 Python，唯一的区别是 IronPython 被设计为在 CLR (.NET Framework) 上运行，因此可以互操作和使用以其他 .NET 语言编写的 .NET 程序集。因此，如果您的平台是 Windows，并且您还使用 .NET 或您的公司使用，那么应该考虑 IronPython。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-26T11:50:53.900

IronPython 的优点之一是，与 CPython 不同，IronPython 不使用全局解释器锁，从而使线程更有效。

在标准的 Python 实现中，线程在每个对象访问时获取 GIL。这限制了并行执行，尤其是在您希望充分利用多个 CPU 时。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-26T14:39:43.903

Pro：如果安装了 SilverLight ，您可以[在浏览器中运行 IronPython 。](http://www.codeplex.com/sdlsdk)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-26T10:50:26.543

这还取决于您是否希望您的代码在 Linux 上运行。不知道 IronPython 是否可以在 Windows 平台以外的任何平台上工作。

# asp.net - 通过WCF传递CategoryAttribute问题

> ID：590012
> 
> 赞同：1
> 
> 时间：2009-02-26T10:42:47.933
> 
> 标签：asp.net, wcf, propertygrid, custom-attributes

在传递实体时，WCF 似乎不包括诸如 Category 之类的属性。

我有一个围绕 EF 实体的类，用于在胖客户端上填充属性网格。

我正在尝试使用 WCF 从服务器检索信息，并在客户端复制属性网格。我已经测试了代码，并且在主机中，我能够确定实例中元素的类别。

但是，当我从 ASP.NET 站点请求实例时，似乎无法检索到类别信息。我得到的只是杂项，所以我认为这意味着当我序列化它时，属性会被剥离。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-26T14:30:41.147

特定于 .NET 的信息不会在元数据中传递。因此，该信息不会用于创建您使用 svcutil 或“添加服务引用”创建的代理类。这就是为什么属性、非默认构造函数、方法或索引器不会出现在代理类中的原因。

你应该尽量避免这种信息。但是，如果您真的需要它，您可以将这些类型放入单独的程序集中，并与客户端共享。这意味着您必须在更新该程序集时更新所有客户端。

# javascript - 获取数组中所有选中的复选框

> ID：590018
> 
> 赞同：208
> 
> 时间：2009-02-26T10:45:14.417
> 
> 标签：javascript, jquery, ajax, dhtml

所以我有这些复选框：

```
<input type="checkbox" name="type" value="4" />
<input type="checkbox" name="type" value="3" />
<input type="checkbox" name="type" value="1" />
<input type="checkbox" name="type" value="5" /> 
```

等等。其中大约有 6 个并且是手动编码的（即不是从数据库中获取的），因此它们可能会在一段时间内保持不变。

我的问题是如何将它们全部放在一个数组中（在 javascript 中），这样我就可以在`$.post`使用 Jquery 发出 AJAX 请求时使用它们。

有什么想法吗？

编辑：我只想将选定的复选框添加到数组中

* * *

## 回答 #1

> 赞同：394
> 
> 时间：2009-02-26T10:52:41.420

格式化：

```
$("input:checkbox[name=type]:checked").each(function(){
    yourArray.push($(this).val());
}); 
```

希望它会奏效。

* * *

## 回答 #2

> 赞同：93
> 
> 时间：2017-09-02T16:18:54.880

**纯JS**

对于那些不想使用 jQuery 的人

```
var array = []
var checkboxes = document.querySelectorAll('input[type=checkbox]:checked')

for (var i = 0; i < checkboxes.length; i++) {
  array.push(checkboxes[i].value)
} 
```

* * *

## 回答 #3

> 赞同：56
> 
> 时间：2012-03-02T07:45:24.710

```
var chk_arr =  document.getElementsByName("chkRights[]");
var chklength = chk_arr.length;             

for(k=0;k< chklength;k++)
{
    chk_arr[k].checked = false;
} 
```

* * *

## 回答 #4

> 赞同：41
> 
> 时间：2009-02-26T10:55:33.067

我没有测试它，但它应该可以工作

```
<script type="text/javascript">
var selected = new Array();

$(document).ready(function() {

  $("input:checkbox[name=type]:checked").each(function() {
       selected.push($(this).val());
  });

});

</script> 
```

* * *

## 回答 #5

> 赞同：27
> 
> 时间：2017-08-25T06:56:11.477

**ES6 版本：**

```
const values = Array
  .from(document.querySelectorAll('input[type="checkbox"]'))
  .filter((checkbox) => checkbox.checked)
  .map((checkbox) => checkbox.value); 
```

```
function getCheckedValues() {
  return Array.from(document.querySelectorAll('input[type="checkbox"]'))
  .filter((checkbox) => checkbox.checked)
  .map((checkbox) => checkbox.value);
}

const resultEl = document.getElementById('result');

document.getElementById('showResult').addEventListener('click', () => {
  resultEl.innerHTML = getCheckedValues();
});
```

```
<input type="checkbox" name="type" value="1" />1
<input type="checkbox" name="type" value="2" />2
<input type="checkbox" name="type" value="3" />3
<input type="checkbox" name="type" value="4" />4
<input type="checkbox" name="type" value="5" />5

<br><br>
<button id="showResult">Show checked values</button>
<br><br>
<div id="result"></div>
```

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2009-02-26T10:53:57.050

这应该可以解决问题：

```
$('input:checked'); 
```

我认为您没有其他可以检查的元素，但是如果这样做，则必须使其更具体：

```
$('input:checkbox:checked');

$('input:checkbox').filter(':checked'); 
```

* * *

## 回答 #7

> 赞同：23
> 
> 时间：2019-10-02T10:44:10.610

不需要临时变量的纯 JavaScript：

```
Array.from(document.querySelectorAll("input[type=checkbox][name=type]:checked"), e => e.value); 
```

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2011-06-26T12:45:24.933

在 MooTools 1.3 中（撰写本文时最新）：

```
var array = [];
$$("input[type=checkbox]:checked").each(function(i){
    array.push( i.value );
}); 
```

* * *

## 回答 #9

> 赞同：14
> 
> 时间：2016-08-18T11:53:00.530

如果你想使用 vanilla JS，你可以像 @zahid-ullah 那样做，但要避免循环：

```
 var values = [].filter.call(document.getElementsByName('fruits[]'), function(c) {
    return c.checked;
  }).map(function(c) {
    return c.value;
  }); 
```

ES6 中的相同代码看起来更好：

```
var values = [].filter.call(document.getElementsByName('fruits[]'), (c) => c.checked).map(c => c.value); 
```

```
window.serialize = function serialize() {
  var values = [].filter.call(document.getElementsByName('fruits[]'), function(c) {
    return c.checked;
  }).map(function(c) {
    return c.value;
  });
  document.getElementById('serialized').innerText = JSON.stringify(values);
}
```

```
label {
  display: block;
}
```

```
<label>
  <input type="checkbox" name="fruits[]" value="banana">Banana
</label>
<label>
  <input type="checkbox" name="fruits[]" value="apple">Apple
</label>
<label>
  <input type="checkbox" name="fruits[]" value="peach">Peach
</label>
<label>
  <input type="checkbox" name="fruits[]" value="orange">Orange
</label>
<label>
  <input type="checkbox" name="fruits[]" value="strawberry">Strawberry
</label>
<button onclick="serialize()">Serialize
</button>
<div id="serialized">
</div>
```

* * *

## 回答 #10

> 赞同：12
> 
> 时间：2015-05-10T06:01:31.333

在 Javascript 中它会是这样的[（演示链接）](http://jsbin.com/nudoridavo/2/)：

```
// get selected checkboxes
function getSelectedChbox(frm) {
  var selchbox = [];// array that will store the value of selected checkboxes
  // gets all the input tags in frm, and their number
  var inpfields = frm.getElementsByTagName('input');
  var nr_inpfields = inpfields.length;
  // traverse the inpfields elements, and adds the value of selected (checked) checkbox in selchbox
  for(var i=0; i<nr_inpfields; i++) {
    if(inpfields[i].type == 'checkbox' && inpfields[i].checked == true) selchbox.push(inpfields[i].value);
  }
  return selchbox;
} 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2016-09-09T16:57:13.870

```
var checkedValues = $('input:checkbox.vdrSelected:checked').map(function () {
        return this.value;
    }).get(); 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2017-11-16T07:33:14.370

在检查时添加复选框的值并在取消检查时减去值

```
$('#myDiv').change(function() {
  var values = 0.00;
  {
    $('#myDiv :checked').each(function() {
      //if(values.indexOf($(this).val()) === -1){
      values=values+parseFloat(($(this).val()));
      // }
    });
    console.log( parseFloat(values));
  }
});
```

```
<div id="myDiv">
  <input type="checkbox" name="type" value="4.00" />
  <input type="checkbox" name="type" value="3.75" />
  <input type="checkbox" name="type" value="1.25" />
  <input type="checkbox" name="type" value="5.50" />
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2019-07-02T10:16:13.977

在现代浏览器中使用 vanilla JS 执行此操作的另一种方法（不支持 IE，遗憾的是在撰写本文时不支持 iOS Safari）是使用[FormData.getAll()](https://developer.mozilla.org/en-US/docs/Web/API/FormData/getAll)：

```
var formdata   = new FormData(document.getElementById("myform"));
var allchecked = formdata.getAll("type"); // "type" is the input name in the question

// allchecked is ["1","3","4","5"]  -- if indeed all are checked 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2017-05-11T02:53:09.127

用这个：

```
var arr = $('input:checkbox:checked').map(function () {
  return this.value;
}).get(); 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2021-03-04T09:05:33.823

按输入名称选择复选框

```
var category_id = [];

$.each($("input[name='yourClass[]']:checked"), function(){                    
    category_id.push($(this).val());
}); 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-03-16T10:09:01.830

使用 jQuery

你只需要为每个输入添加类，我已经添加类“源”你当然可以改变它

```
<input class="source" type="checkbox" name="type" value="4" />
<input class="source" type="checkbox" name="type" value="3" />
<input class="source" type="checkbox" name="type" value="1" />
<input class="source" type="checkbox" name="type" value="5" />

<script type="text/javascript">
$(document).ready(function() {
    var selected_value = []; // initialize empty array 
    $(".source:checked").each(function(){
        selected_value.push($(this).val());
    });
    console.log(selected_value); //Press F12 to see all selected values
});
</script> 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2019-04-07T06:49:59.093

```
function selectedValues(ele){
  var arr = [];
  for(var i = 0; i < ele.length; i++){
    if(ele[i].type == 'checkbox' && ele[i].checked){
      arr.push(ele[i].value);
    }
  }
  return arr;
}
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2020-05-04T20:16:46.597

```
var array = []
    $("input:checkbox[name=type]:checked").each(function(){
        array.push($(this).val());
    }); 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-10-18T11:56:21.960

如果您使用按钮单击或其他东西来运行插入，请使用注释的 if 块来防止添加已经在数组中的值

```
$('#myDiv').change(function() {
  var values = [];
  {
    $('#myDiv :checked').each(function() {
      //if(values.indexOf($(this).val()) === -1){
      values.push($(this).val());
      // }
    });
    console.log(values);
  }
});
```

```
<div id="myDiv">
  <input type="checkbox" name="type" value="4" />
  <input type="checkbox" name="type" value="3" />
  <input type="checkbox" name="type" value="1" />
  <input type="checkbox" name="type" value="5" />
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-04-13T10:06:54.967

你可以尝试这样的事情：

```
$('input[type="checkbox"]').change(function(){
       var checkedValue = $('input:checkbox:checked').map(function(){
                return this.value;
            }).get();         
            alert(checkedValue);   //display selected checkbox value     
 }) 
```

这里

```
$('input[type="checkbox"]').change(function() call when any checkbox checked or unchecked, after this
$('input:checkbox:checked').map(function()  looping on all checkbox, 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2018-05-04T09:56:49.690

这是我解决同样问题的代码，有人也可以试试这个。 **jQuery**

```
<script>
$(document).ready(function(){`
$(".check11").change(function(){
var favorite1 = [];        
$.each($("input[name='check1']:checked"), function(){                    
favorite1.push($(this).val());
document.getElementById("countch1").innerHTML=favorite1;
});
});
});
</script> 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-05-05T15:14:01.570

可以使用我创建的这个功能

```
function getCheckBoxArrayValue(nameInput){
    let valores = [];
    let checked = document.querySelectorAll('input[name="'+nameInput+'"]:checked');
    checked.forEach(input => {
        let valor = input?.defaultValue || input?.value;
        valores.push(valor);
    });
    return(valores);
} 
```

使用它就这样称呼它

```
getCheckBoxArrayValue("type"); 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2021-10-12T12:13:05.580

```
 var idsComenzi = [];

    $('input:checked').each(function(){
        idsComenzi.push($(this).val());
    }); 
```

# c++ - 是否有一种跨平台的方式来获取正在运行的应用程序列表？

> ID：590021
> 
> 赞同：0
> 
> 时间：2009-02-26T10:46:39.437
> 
> 标签：c++, qt, cross-platform

我需要获取当前正在运行的应用程序列表，以便我的 C++ 应用程序并使它们成为焦点。

有人做过吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-26T11:04:33.437

没有真正的跨平台方式可以做到这一点。进程、应用程序等的整个概念是操作系统特定的概念。如果您使用某个库来解决问题，那么您并不是真正的跨平台，您仅限于该库支持的平台。例如，Qt 不是通用的跨平台，它可以在很多平台上运行，但不是在每个已知的平台上运行，并且在无法运行的平台上，Qt 解决方案将无法工作。大多数类 UNIX 平台都支持 POSIX API（多一些，少一些），如果您限制自己使用 POSIX 功能，该解决方案将适用于 Linux、BSD、Mac OS X、Solaris 和类似的操作系统。但是，它不适用于 Windows。微软决定放弃对 POSIX 的支持（并不是说他们的 POSIX 支持一开始就很好），然而，Cygwin 将 POSIX 支持带回了 Windows（Cygwin 在 Windows 之上模拟了完整的 Linux glibc API）。问题是，甚至 POSIX 也没有真正提供一组功能来解决您的问题 - 例如，与 ps 相比，在 Linux 系统上，像 ps 这样的 POSIX 工具获取进程信息的方式与 BSD 系统完全不同。

第二个问题是你在谈论“焦点”。焦点不适用于应用程序。没有 UI 和窗口的后台应用程序不能有“焦点”。对于这样的应用程序，“焦点”意味着什么？因此，您并不真正对正在运行的应用程序列表感兴趣，而是对正在运行的具有窗口且其窗口可能获得焦点的 UI 应用程序列表感兴趣。完全不同的东西。Windows 系统在不同平台之间的差异更大，POSIX 完全忽略了 UI。

此外，您的问题上有一个 Visual-C++ 标签，那么您的代码必须如何跨平台，因为 Visual-C++ 是 Windows 唯一的东西，不是吗？您真正想要支持哪些平台（请相应地更新您的问题），因为我怀疑有没有比为每个受支持的平台编写不同的代码更好的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T10:58:41.030

第一：应用没有焦点；窗户做。其次：有些窗口不接受焦点。所以，我认为从字面上看是不可能的。

# c++ - 我可以取消单例吗

> ID：590027
> 
> 赞同：0
> 
> 时间：2009-02-26T10:48:21.993
> 
> 标签：c++

我想使用一个大量使用单例的库，但我实际上需要一些管理器类来拥有多个实例。该代码是开源的，但自己更改代码会使将 lib 更新到较新版本变得困难。

如果有的话，有什么技巧可以强制创建单例甚至整个库的新实例？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T10:51:02.250

首先找出是谁编写了图书馆，访问他们的家庭住址并将他们打败，最好是一本关于软件设计的书。:)

除此之外：将您对原始库的更改保持为补丁集，以便您可以（或多或少）轻松地将其应用于每个新版本。此外，尝试将您的更改放入库中，这样您就不必自己维护补丁。;)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T10:50:51.130

在 Windows 下，您可以将每个实例封装在不同的 DLL 中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T10:51:01.940

请记住，该库还依赖于单例的单例性质。如果您想更新库，您需要验证您的更改不会违反库的功能。每次只能手动完成。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T10:52:57.567

答案是“视情况而定”。一个很好的例子是微软的 C 运行时使用的 C++ 堆。当然，这是作为单例实现的。现在，当您将 CRT 静态链接到多个 DLL 时，您最终会得到多个副本。较新的实现只有一个堆，而较旧的 CRT 为每个链接的库创建一个堆。

# sql - 在 SQL 中返回空表的首选方法是什么？

> ID：590028
> 
> 赞同：13
> 
> 时间：2009-02-26T10:48:34.440
> 
> 标签：sql

我知道我可以使用以下查询返回一个空表：

```
select * from tbFoo where 1=2 
```

但该代码对我来说并不好看。

**有这样做的“标准”方式吗？**

如果你想知道我为什么要做这么奇怪的事情，那是因为[我无法命名从存储过程返回的数据表](https://stackoverflow.com/questions/589976/how-can-you-name-the-datasets-tables-you-return-in-a-stored-proc)，所以我需要空占位符。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-26T11:34:30.477

刚刚运行两者：

```
SELECT TOP 0 * FROM Table
and
SELECT * FROM Table WHERE 1=0 
```

它们产生完全相同的执行计划。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T10:55:00.103

大多数时候我看到 1=0 但是当你真的必须这样做时，这几乎是标准方法。虽然真的不得不这样做是很少见的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T11:27:59.103

您真正需要的是`information_schema`，使用它可以让您找出表的定义。

你没有提到你正在使用哪个数据库，所以这里有一个关于[`information_schema`MySQL、PostgreSQL](http://www.petefreitag.com/item/666.cfm)（和 MSSQL、Oracle 等）中的支持的链接

网站上的一个例子；

```
SELECT table_name, column_name, is_nullable, data_type, character_maximum_length
FROM INFORMATION_SCHEMA.Columns
WHERE table_name = 'employees' 
```

在您的情况下，您只需要列名；

```
SELECT column_name 
FROM INFORMATION_SCHEMA.Columns
WHERE table_name = 'employees' 
```

# php - 哪些与 PHP 一起使用的数据库共享相同（或大部分）的 SQL 语法？

> ID：590035
> 
> 赞同：1
> 
> 时间：2009-02-26T10:51:03.657
> 
> 标签：php, mysql, pdo

我读过虽然 SQL 是为了标准化，但它是用不同的数据库实现的，等等。我只将 MySQL 用于数据库。

我想知道的是其他数据库共享相同的语法？我现在正在使用 PDO，我想设置一个标志以允许用户指定他们想要使用的数据库。

我很想知道哪些是“安全”的数据库，可以处理大多数（如果不是全部）我的一般 MySQL 查询。主要是SELECT、INSERT、UPDATE、DROP、DELETE。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T10:53:35.850

这种称为`ANSI SQL`.

所有主要的数据库引擎（即`Oracle`,`MS SQL`和）理论上都应该（应该）`PostgreSQL`支持.`MySQL``SQL-92`

这包括您提到的所有内容：`SELECT`, `INSERT`, `UPDATE`, `DROP`, `DELETE`，只要您不使用复杂的从句。

在实践中：

1.  并非所有数据库都支持完整的`SQL-92`.

    `SQL`即使在跨平台编写也`SQL-92`需要大量测试。

2.  `SQL`当您插入`1001st`行并需要优化查询时，平台独立性就结束了。

    如果你浏览一下`StackOverflow`标记过的问题`SQL`，你会看到他们中的大多数说“*帮助我优化这个查询*”，大多数答案说“*使用这个平台相关的黑客*” 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T11:15:21.087

你会发现有些数据库存储数据类型不同，例如，mysql 将布尔值存储为 1 和 0，而 postgres 将它们存储为 't' 和 'f'。

只要您的数据库类意识到需要转换数据，您就应该没问题，可能 96.3482% 的日常 CRUD 都可以很好地工作。

即使您创建直接调用 PDO 的数据库类，您也可以稍后添加一些用于数据转换或查询修改的逻辑。

您可以使用数据库抽象层[ADOdb](http://adodb.sourceforge.net/)。^(（它得到了植物渴望的东西）)

我建议确保您的客户在您花费大量时间开发您可能不需要的功能之前，实际上对他们需要运行哪个数据库进行了废话。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T11:15:40.053

标准化的[SQL92](http://en.wikipedia.org/wiki/SQL-92)在所有 RDBMS 中几乎相同。不同之处在于标准未定义的部分，例如`LIMIT`日期时间处理函数，当然还有过程语言。至于 PHP 流行的数据库：让 SQL 在 MySQL、SQLite 和 PostgreSQL 之间移植并不难。使用 Oracle、Sybase 和 DB/2 不会那么容易。

# .net - DebuggerDisplay 属性不起作用

> ID：590046
> 
> 赞同：0
> 
> 时间：2009-02-26T10:54:17.017
> 
> 标签：.net, visual-studio, debugging

这是一个针对 .NET 2.0 框架的 C++/CLI WinForms 项目。我正在使用 Visual Studio 2008。如何让它工作？

**编辑：**代码片段

```
[Serializable]
[DebuggerDisplayAttribute(L"ID={EmployeeID}")]
public ref class Employee
{
    [ReadOnly(true)]
    int nID;
    property int EmployeeID
    {
        int get()
        {
            return nID;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T11:03:16.310

定义“不起作用”...它在 C# 中肯定有效（我不知道 C++ 编辑器是否支持它 - 只需翻译以下在 C# 中*有效*的内容即可；-p）

```
using System.Diagnostics;
[DebuggerDisplay("HiWorld={Bar}")]
class Foo
{
    public string Bar { get; set; }
    static void Main()
    {
        Foo foo = new Foo { Bar = "abc" };
        // breakpoint and hover shows: HiWorld="abc"
    }
} 
```

我不再“做”C++，但反射器说：

```
[DebuggerDisplay(S"HiWorld={Bar}")]
private __gc class Foo
{
    // Methods
    private: static void __gc* Main()
    {
        Foo __gc* <>g__initLocal0 = __gc new Foo();
        <>g__initLocal0->Bar = S"abc";
        Foo __gc* foo = <>g__initLocal0;
    }

    // Properties
    [CompilerGenerated]
    public: __property String __gc* get_Bar()
    {
        return this-><Bar>k__BackingField;
    }
    [CompilerGenerated]
    public: __property void __gc* set_Bar(String __gc* value)
    {
        this-><Bar>k__BackingField = value;
    }

    // Fields
    [CompilerGenerated]
    private: String __gc* <Bar>k__BackingField;
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-11T10:16:06.583

共识是 C++ IDE 不支持它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T12:22:39.910

我认为您的问题可能是您指定的是宽字符串 ( `L"ID={EmployeeID}"`) 而不是 CLR 字符串 ( `S"ID={EmployeeID}"`)。所以也许把 L 换成 S 看看你怎么走？

# c# - 共享点错误

> ID：590047
> 
> 赞同：0
> 
> 时间：2009-02-26T10:54:47.763
> 
> 标签：c#, vb.net, sharepoint, moss

我创建了一个 .net Web 部件并将其部署在 sharepoint 站点上。当我预览它时，共享点抛出一个错误，说“预览 Web 部件时发生错误”

web部分中的代码如下

```
 Dim myweb As Microsoft.SharePoint.SPWeb = Microsoft.SharePoint.WebControls.SPControl.GetContextWeb(Context)
        'Dim mylist As Microsoft.SharePoint.SPList = myweb.Lists(System.Configuration.ConfigurationSettings.AppSettings("BedList").ToString())
        Dim mylist As Microsoft.SharePoint.SPList = myweb.Lists("{80F6F320-E1F5-42EB-A2FB-895EAE00F589}")
        Dim items As Microsoft.SharePoint.SPListItemCollection = mylist.Items

        For Each item As Microsoft.SharePoint.SPListItem In items
            returnString = returnString + "<br/>" + item("Status").ToString() + " For " + item("Title").ToString + "<br/>"
        Next 
```

有谁知道为什么这不起作用。我无法掌握抛出的异常。任何帮助都会很棒

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T11:21:59.010

首先，您应该通过更改 web.config 中的以下内容来使您的异常可见

调用堆栈 = 真

```
 <SafeMode MaxControls="200" CallStack="true" DirectFileDependencies="10" TotalFileDependencies="50" AllowPageLevelTrace="false"> 
```

自定义错误 = 关闭

```
<customErrors mode="Off" /> 
```

然后你会看到真正的异常

您也可以尝试使用以下代码获取当前网页：

```
Dim myweb As Microsoft.SharePoint.SPWeb = SPContext.Current.Web 
```

当您尝试获取列表时，其他问题可能与错误的 listId 或 ListName 有关。

希望能帮助到你

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T11:01:31.320

您可以在执行 myList.Items 之前尝试检查 myList 是否为空

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T21:46:04.937

还要寻找 <compilation..> 标记并将其设置为

<编译调试=“真”..>

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T11:34:07.287

您是否将“BedList”键添加到正确的 web.config 文件中？

# python - Python 中的视频和语音聊天可操作性

> ID：590053
> 
> 赞同：3
> 
> 时间：2009-02-26T10:56:32.550
> 
> 标签：python, audio, chat, voice

我正在尝试在 Python 中查找有关视频和语音聊天可操作性的资源......有人知道一些好的资源或示例项目吗？

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T11:46:50.247

如果你想要更高层次的东西，你可以试试[Empathy](http://live.gnome.org/Empathy)。它具有 python 绑定，因此您可以在应用程序上使用聊天 GUI 元素或创建自己的。如果你想要更低级别的东西，你可能想尝试直接使用[Telepathy Python](http://telepathy.freedesktop.org/wiki/Telepathy%20Python)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-08-04T04:47:54.640

基本上一个具有 xmpp-jingle 可以容纳视频和语音聊天的远见库是常用的，对于 python itz farsight.py：试试吧.....！

# php - 计算一个小部件？

> ID：590057
> 
> 赞同：2
> 
> 时间：2009-02-26T10:58:54.680
> 
> 标签：php, widget

您好，我最近添加了一个天气小部件，供人们添加到他们的网站。基本上是人们可以链接到的 php 页面。

我的问题是我可以以某种方式放置一个计数器或其他东西来计算有多少人在使用我的小部件吗？

我的小部件位于[http://www.site.com/widget/](http://www.havairan.com/widget/)它是波斯语的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T13:07:40.910

好吧，这取决于 - 你想知道有多少人在他们的网站上使用过你的小部件，或者有多少人看过使用你的小部件的网站？这些数字完全不同。

对于后一种选择，jonstjohn 的方法会很好用：为了易于实现和许多功能，我推荐 Google Analytics 方法 - 他们有非常精美的图表，可以显示很多有趣的信息。

另一方面，如果您想计算有多少网站正在使用您的小部件，那么您可以执行以下操作：

*   在您的数据库中创建一个带有 varchar 列的表。在该列上放置一个唯一索引。
*   在您的代码中，读取 $_SERVER["HTTP_REFERER"] 参数以获取调用您的小部件的 URL。
*   现在您只想从该 URL 中删除域部分，因为网站可能会将您的小部件放在他们的模板中，这样它就可以在他们的所有页面中使用。因此，如果您想计算网站而不是网站中的页面，请执行以下操作

    $domainParts = explode("/", $_SERVER["HTTP_REFERER"]);
    $domain = $domainParts[2];

*   现在将您找到的域插入表中。如果这个网站已经调用了一次你的小部件，那么插入将失败并出现唯一约束错误 - 只需忽略该错误（例如，通过在插入命令上使用“@”，如 @mysql_query("INSERT INTO...") ）。

要知道有多少网站正在使用您的小部件，只需计算表中的行数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T11:09:40.723

您可以在 PHP 页面上放置跟踪代码。可能性是：

*   谷歌分析代码

*   通过在数据库中插入一行记录每次 .php 页面执行的时间

我敢肯定还有其他人，但那些应该工作。

# c# - 在 WCF 中支持具有属性的 XSD

> ID：590067
> 
> 赞同：4
> 
> 时间：2009-02-26T11:02:06.763
> 
> 标签：c#, wcf, xsd, wsdl

我们的项目中有一些 XSD 定义了使用属性和元素来指定属性值的类型，例如：

```
<Instrument name="blah">
</Instrument> 
```

我使用这些 XSD 定义 WSDL 使用的模式，但是当我通过 schemagen 运行它时，生成的代码被解包。例如：

```
public interface InstrumentService
{    
    // CODEGEN: Parameter 'GetInstrumentResponse' requires additional schema information that cannot be captured using the parameter mode. The specific attribute is 'System.Xml.Serialization.XmlElementAttribute'.
    GetInstrumentResponse GetInstrument(GetInstrumentRequest request);
 } 
```

（GetInstrumentRequest 和 GetInstrumentResponse 应该只解包到参数和返回值）。

这样做的原因是数据协定序列化程序不支持具有属性的复杂类型，但我确实在某处读到，如果您使用文档/文字而不是文档/文字包装来定义 WSDL，schemagen 将回退到 XmlSerializer实现，它确实支持属性。到目前为止，我试图让它工作的尝试都失败了：// CODEGEN：生成消息契约，因为操作 GetInstrument 既不是 RPC 也不是文档包装。

那么，这种关于文档/文字的假设是否错误？有没有办法从定义具有属性的复杂类型的 WSDL 生成展开的接口代码？

这是我正在使用的修改后的文档/文字 WSDL：

```
<?xml version="1.0" encoding="UTF-8"?>
<wsdl:definitions
    targetNamespace="http://tempuri.org/"
    xmlns:http="http://schemas.xmlsoap.org/wsdl/http/"
    xmlns:mime="http://schemas.xmlsoap.org/wsdl/mime/"
    xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/"
    xmlns:soap12="http://schemas.xmlsoap.org/wsdl/soap12/"
    xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/"
    xmlns:tm="http://microsoft.com/wsdl/mime/textMatching/"
    xmlns:tns="http://tempuri.org/"
    xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <wsdl:types>
        <xs:schema targetNamespace="http://tempuri.org/">
            <xs:complexType name="testComplexType">
                <xs:sequence/>
                <xs:attribute name="name" type="xs:string"/>
            </xs:complexType>
            <xs:element name="input" type="tns:testComplexType"/>
        </xs:schema>
    </wsdl:types>
    <wsdl:message name="GetInstrumentIn">
        <wsdl:part element="tns:input" name="input"/>
    </wsdl:message>
    <wsdl:message name="GetInstrumentOut"/>
    <wsdl:portType name="InstrumentService">
        <wsdl:operation name="GetInstrument">
            <wsdl:input message="tns:GetInstrumentIn"/>
            <wsdl:output message="tns:GetInstrumentOut"/>
        </wsdl:operation>
    </wsdl:portType>
    <wsdl:binding name="InstrumentService" type="tns:InstrumentService">
        <soap12:binding transport="http://schemas.xmlsoap.org/soap/http"/>
        <wsdl:operation name="GetInstrument">
            <soap:operation soapAction="GetInstrument" style="document"/>
            <wsdl:input>
                <soap:body use="literal"/>
            </wsdl:input>
            <wsdl:output>
                <soap:body use="literal"/>
            </wsdl:output>
        </wsdl:operation>
    </wsdl:binding>
    <wsdl:service name="InstrumentService">
        <wsdl:port binding="tns:InstrumentService" name="InstrumentService"/>
    </wsdl:service>
</wsdl:definitions> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T11:36:07.743

很抱歉回答我自己的问题。似乎只需从操作响应类型中删除 nillable="true" 语句，在文档/文字/包装的 WSDL 类型模式中就可以解决问题 - 无需删除到文档/文字。

```
<wsdl:types>
    <xs:schema elementFormDefault="qualified" targetNamespace="http://com.barcap.cbts.core.messaging.rpc/">
        <xs:element name="GetInstrument">
            <xs:complexType/>
        </xs:element>
        <xs:element name="GetInstrumentResponse">
            <xs:complexType>
                <xs:sequence>
                    <!-- nillable="true" removed -->
                    <xs:element maxOccurs="1" minOccurs="0"
                        name="GetInstrumentResponse" type="tns:Instrument"/>
                </xs:sequence>
            </xs:complexType>
        </xs:element>
        <xs:complexType name="Instrument">
            <xs:sequence/>
            <xs:attribute name="name" type="xs:string"/> 
        </xs:complexType>
    </xs:schema>
</wsdl:types> 
```

# .net - 设置 MasterPage 属性时堆栈溢出

> ID：590068
> 
> 赞同：1
> 
> 时间：2009-02-26T11:02:15.173
> 
> 标签：.net, asp.net, user-controls, master-pages

尝试从 ASPX 页面在 MasterPage 中设置公共属性时出现堆栈溢出。

我正在使用 TabContainer 制作“贺卡”编辑器。每个选项卡都有一个用户控件，当活动选项卡更改时，所有内容都会更新 - 同时我需要将所有数据存储在母版页属性中。

从 ASPX 页面：

```
protected void tcTabs_ActiveTabChanged(object sender, EventArgs e)
{
    Master.Message = "blahblah";
} 
```

从母版页：

```
public string Message
{
    get { return Message; }
    set { Message = value; }
} 
```

这就是我得到堆栈溢出的地方；在集合 {}。我尝试设置什么并不重要，我每次都会遇到同样的问题。我确定我遗漏了一些小事情，但据我所知，我正在关注我找到的所有示例。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-26T11:05:15.820

问题是 Message 属性正在调用自身。您需要设置成员变量或控件属性。

**编辑**：示例：

```
string mMessage = string.Empty;

public string Message
{
    get { return mMessage; }
    set { mMessage = value; }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T11:10:43.467

Kieron 是正确的，您的属性本质上是一个无限递归方法调用。你的属性被编译成这样的：

```
public string get_Message() { return get_Message(); }
public void set_Message(string value) { set_Message(value); } 
```

这显然是不正确的。您需要一个支持字段：

```
private string message;
public string Message { get { return this.message; } set { this.message = value; } } 
```

或者，如果您正在使用 C# 3，只需像这样定义 Message：

```
public string Message { get; set; } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T11:53:13.490

伙计，每当您不使用自动属性时

```
public string Message{get;set;} 
```

您需要有一些私有变量或一些可以存储属性值的变量......通常我这样做：

```
private string _Message;

public string Message
{
 get{return _Message;}
 set{_Message = value;}
} 
```

简单的？是的。

# c# - 您将如何在 Java 或 C# 中编写高效的循环缓冲区？

> ID：590069
> 
> 赞同：44
> 
> 时间：2009-02-26T11:02:23.113
> 
> 标签：c#, java, class-design

我想要一个实现固定大小的[*循环缓冲区*](https://en.wikipedia.org/wiki/Circular_buffer)的简单类。它应该是高效的、易于使用的、通用的类型。

目前它不需要[支持 MT](https://en.wikipedia.org/wiki/Multithreading_(computer_architecture))。以后总能加个锁，反正不会是高并发的。

方法应该是：`.Add()`我猜`.List()`，我在哪里检索所有条目。再三考虑，我认为应该通过索引器进行检索。在任何时候，我都希望能够通过*index*检索缓冲区中的任何元素。但请记住，从一个时刻到下一个 Element[n] 可能会有所不同，因为*循环缓冲区*会填满并翻转。这不是一个*堆栈*，它是一个循环缓冲区。

关于“*溢出*”：我希望内部会有一个包含项目的数组，并且随着时间的推移，缓冲区的*头部*和*尾部*将围绕该固定数组旋转。但这对用户来说应该是不可见的。不应有外部可检测到的“溢出”事件或行为。

这不是学校作业——它最常用于[MRU 缓存](https://en.wikipedia.org/wiki/Cache_replacement_policies#Most_recently_used_(MRU))或固定大小的事务或事件日志。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-26T11:33:19.140

我会使用一个 T 数组，一个头尾指针，以及 add 和 get 方法。

喜欢：（Bug 搜索留给用户）

```
// Hijack these for simplicity
import java.nio.BufferOverflowException;
import java.nio.BufferUnderflowException;

public class CircularBuffer<T> {

  private T[] buffer;

  private int tail;

  private int head;

  @SuppressWarnings("unchecked")
  public CircularBuffer(int n) {
    buffer = (T[]) new Object[n];
    tail = 0;
    head = 0;
  }

  public void add(T toAdd) {
    if (head != (tail - 1)) {
        buffer[head++] = toAdd;
    } else {
        throw new BufferOverflowException();
    }
    head = head % buffer.length;
  }

  public T get() {
    T t = null;
    int adjTail = tail > head ? tail - buffer.length : tail;
    if (adjTail < head) {
        t = (T) buffer[tail++];
        tail = tail % buffer.length;
    } else {
        throw new BufferUnderflowException();
    }
    return t;
  }

  public String toString() {
    return "CircularBuffer(size=" + buffer.length + ", head=" + head + ", tail=" + tail + ")";
  }

  public static void main(String[] args) {
    CircularBuffer<String> b = new CircularBuffer<String>(3);
    for (int i = 0; i < 10; i++) {
        System.out.println("Start: " + b);
        b.add("One");
        System.out.println("One: " + b);
        b.add("Two");
        System.out.println("Two: " + b);
        System.out.println("Got '" + b.get() + "', now " + b);

        b.add("Three");
        System.out.println("Three: " + b);
        // Test Overflow
        // b.add("Four");
        // System.out.println("Four: " + b);

        System.out.println("Got '" + b.get() + "', now " + b);
        System.out.println("Got '" + b.get() + "', now " + b);
        // Test Underflow
        // System.out.println("Got '" + b.get() + "', now " + b);

        // Back to start, let's shift on one
        b.add("Foo");
        b.get();
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-05-24T23:01:58.640

这就是我将*（或确实）*在 Java 中编写高效循环缓冲区的方式。它由一个简单的数组支持。对于我的特定用例，我需要高并发吞吐量，因此我使用 CAS 来分配索引。然后，我创建了可靠副本的机制，包括整个缓冲区的 CAS 副本。我在一个[简短的文章](http://www.blisted.org/wiki/papers/tutorials/java/100lines/FastCircularBuffer)中更详细地概述的案例中使用了它。

```
import java.util.concurrent.atomic.AtomicLong;
import java.lang.reflect.Array;

/**
 * A circular array buffer with a copy-and-swap cursor.
 *
 * <p>This class provides an list of T objects who's size is <em>unstable</em>.
 * It's intended for capturing data where the frequency of sampling greatly
 * outweighs the frequency of inspection (for instance, monitoring).</p>
 *
 * <p>This object keeps in memory a fixed size buffer which is used for
 * capturing objects.  It copies the objects to a snapshot array which may be
 * worked with.  The size of the snapshot array will vary based on the
 * stability of the array during the copy operation.</p>
 *
 * <p>Adding buffer to the buffer is <em>O(1)</em>, and lockless.  Taking a
 * stable copy of the sample is <em>O(n)</em>.</p>
 */
public class ConcurrentCircularBuffer <T> {
    private final AtomicLong cursor = new AtomicLong();
    private final T[]      buffer;
    private final Class<T> type;

    /**
     * Create a new concurrent circular buffer.
     *
     * @param type The type of the array.  This is captured for the same reason
     * it's required by {@link java.util.List.toArray()}.
     *
     * @param bufferSize The size of the buffer.
     *
     * @throws IllegalArgumentException if the bufferSize is a non-positive
     * value.
     */
    public ConcurrentCircularBuffer (final Class <T> type, 
                                     final int bufferSize) 
    {
        if (bufferSize < 1) {
            throw new IllegalArgumentException(
                "Buffer size must be a positive value"
                );
        }

        this.type    = type;
        this.buffer = (T[]) new Object [ bufferSize ];
    }

    /**
     * Add a new object to this buffer.
     *
     * <p>Add a new object to the cursor-point of the buffer.</p>
     *
     * @param sample The object to add.
     */
    public void add (T sample) {
        buffer[(int) (cursor.getAndIncrement() % buffer.length)] = sample;
    }

    /**
     * Return a stable snapshot of the buffer.
     *
     * <p>Capture a stable snapshot of the buffer as an array.  The snapshot
     * may not be the same length as the buffer, any objects which were
     * unstable during the copy will be factored out.</p>
     * 
     * @return An array snapshot of the buffer.
     */
    public T[] snapshot () {
        T[] snapshots = (T[]) new Object [ buffer.length ];

        /* Determine the size of the snapshot by the number of affected
         * records.  Trim the size of the snapshot by the number of records
         * which are considered to be unstable during the copy (the amount the
         * cursor may have moved while the copy took place).
         *
         * If the cursor eliminated the sample (if the sample size is so small
         * compared to the rate of mutation that it did a full-wrap during the
         * copy) then just treat the buffer as though the cursor is
         * buffer.length - 1 and it was not changed during copy (this is
         * unlikley, but it should typically provide fairly stable results).
         */
        long before = cursor.get();

        /* If the cursor hasn't yet moved, skip the copying and simply return a
         * zero-length array.
         */
        if (before == 0) {
            return (T[]) Array.newInstance(type, 0);
        }

        System.arraycopy(buffer, 0, snapshots, 0, buffer.length);

        long after          = cursor.get();
        int  size           = buffer.length - (int) (after - before);
        long snapshotCursor = before - 1;

        /* Highly unlikely, but the entire buffer was replaced while we
         * waited...so just return a zero length array, since we can't get a
         * stable snapshot...
         */
        if (size <= 0) {
            return (T[]) Array.newInstance(type, 0);
        }

        long start = snapshotCursor - (size - 1);
        long end   = snapshotCursor;

        if (snapshotCursor < snapshots.length) {
            size   = (int) snapshotCursor + 1;
            start  = 0;
        }

        /* Copy the sample snapshot to a new array the size of our stable
         * snapshot area.
         */
        T[] result = (T[]) Array.newInstance(type, size);

        int startOfCopy = (int) (start % snapshots.length);
        int endOfCopy   = (int) (end   % snapshots.length);

        /* If the buffer space wraps the physical end of the array, use two
         * copies to construct the new array.
         */
        if (startOfCopy > endOfCopy) {
            System.arraycopy(snapshots, startOfCopy,
                             result, 0, 
                             snapshots.length - startOfCopy);
            System.arraycopy(snapshots, 0,
                             result, (snapshots.length - startOfCopy),
                             endOfCopy + 1);
        }
        else {
            /* Otherwise it's a single continuous segment, copy the whole thing
             * into the result.
             */
            System.arraycopy(snapshots, startOfCopy,
                             result, 0, endOfCopy - startOfCopy + 1);
        }

        return (T[]) result;
    }

    /**
     * Get a stable snapshot of the complete buffer.
     *
     * <p>This operation fetches a snapshot of the buffer using the algorithm
     * defined in {@link snapshot()}.  If there was concurrent modification of
     * the buffer during the copy, however, it will retry until a full stable
     * snapshot of the buffer was acquired.</p>
     *
     * <p><em>Note, for very busy buffers on large symmetric multiprocessing
     * machines and supercomputers running data processing intensive
     * applications, this operation has the potential of being fairly
     * expensive.  In practice on commodity hardware, dualcore processors and
     * non-processing intensive systems (such as web services) it very rarely
     * retries.</em></p>
     *
     * @return A full copy of the internal buffer.
     */
    public T[] completeSnapshot () {
        T[] snapshot = snapshot();

        /* Try again until we get a snapshot that's the same size as the
         * buffer...  This is very often a single iteration, but it depends on
         * how busy the system is.
         */
        while (snapshot.length != buffer.length) {
            snapshot = snapshot();
        }

        return snapshot;
    }

    /**
     * The size of this buffer.
     */
    public int size () {
        return buffer.length;
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-26T11:58:29.640

我会根据需要使用[ArrayBlockingQueue](http://java.sun.com/javase/6/docs/api/java/util/concurrent/ArrayBlockingQueue.html)或其他预构建的队列实现之一。很少需要自己实现这样的数据结构（除非是学校作业）。

编辑：既然您已经添加了“通过索引检索缓冲区中的任何元素”的要求，我想您需要实现自己的类（除非[google-collections](http://code.google.com/p/google-collections/)或其他一些库提供了一个）。正如 JeeBee 的示例所示，循环缓冲区很容易实现。你也可以看看 ArrayBlockingQueue 的源代码——它的代码很干净，只是去掉了锁定和不需要的方法，并添加了通过索引访问它的方法。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-07-03T21:42:19.897

这是我在生产代码中使用[的 Java 即用型 CircularArrayList 实现。](http://www.museful.net/2011/software-development/circulararraylist-for-java)通过以 Java 推荐的方式覆盖 AbstractList，它支持 Java Collections Framework 中标准 List 实现所期望的所有功能（通用元素类型、子列表、迭代等）。

以下调用在 O(1) 中完成：

*   add(item) - 在列表末尾添加
*   remove(0) - 从列表的开头删除
*   get(i) - 检索列表中的随机元素

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-12-08T07:31:45.447

使用 Java 的[ArrayDeque](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayDeque.html)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-26T19:52:58.610

只需使用别人的实现：

[Power Collections](http://www.codeplex.com/PowerCollections/Release/ProjectReleases.aspx?ReleaseId=6863) [Deque`<T>`](http://en.wikipedia.org/wiki/Deque)由循环缓冲区实现。

电源集合库不完整，但 Deque 是完全可以接受的扩展循环缓冲区。

由于您表明您不希望扩展而是希望覆盖，您可以相当容易地修改代码以覆盖。这将简单地涉及删除对逻辑上相邻的指针的检查，并且无论如何都只是写。同时可以将私有缓冲区设为只读。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-05-10T18:57:35.750

System.Collections.Generic.Queue - 内部是简单的循环缓冲区（带有头部和尾部的 T[]，就像[来自 JeeBee 的示例一样](https://stackoverflow.com/a/590167)）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-07-31T17:35:50.943

在[Guava](http://github.com/google/guava) 15 中，我们引入了`EvictingQueue`，这是一个非阻塞的有界队列，当尝试将元素添加到完整队列时，它会自动从队列头部驱逐（删除）元素。这与传统的有界队列不同，后者在满时阻塞或拒绝新元素。

听起来这应该适合您的需求，并且具有比`ArrayDeque`直接使用更简单的界面（尽管它在引擎盖下使用了一个！）。

更多信息可以在[这里](https://plus.sandbox.google.com/+googleguava/posts/QVqQGiSppF3)找到。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-03-06T12:11:03.123

我想从java的角度来回答这个问题。

要使用 java 实现循环缓冲区，您可能需要三样东西，包括：循环缓冲区类、泛型和对它的少量操作（为了了解您需要哪些操作以及这些操作中的内部机制，您可能需要阅读[wiki首先是循环缓冲区](https://en.wikipedia.org/wiki/Circular_buffer)）。

其次，缓冲区满或空的判断要非常小心。这里我给出两个本能的全/空判断解决方案。在解决方案一中，您需要创建两个整数变量来存储缓冲区的当前大小和缓冲区的最大大小。显然，如果当前大小等于最大大小，则缓冲区已满。

在另一种解决方案中，我们将最后一个存储位置设置为空闲（对于大小为 7 的循环缓冲区，我们将存储设置为空闲的 7）。据此，我们可以在`(rp+1)%MAXSIZE == fp;`满足表达式时确定缓冲区已满。

为了更清楚，这里给出了一种使用 java 语言的实现。

```
import java.nio.BufferOverflowException;
import java.nio.BufferUnderflowException;        

public class CircularBuffer<T> {
    private int front;
    private int rear;
    private int currentSize;
    private int maxSize;
    private T[] buffer;

    public CircularBuffer(int n) {
        buffer = (T[]) new Object[n];
        front = 0;
        rear = 0;
        currentSize = 0;
        maxSize = n;
    }

    public void push(T e) {
        if (!isFull()) {
            buffer[rear] = e;
            currentSize++;
            rear = (rear + 1) % maxSize;
        } else throw new BufferOverflowException();
    }

    public T pop() {
        if (!isEmpty()) {
            T temp = buffer[front];
            buffer[front] = null;
            front = (front + 1) % maxSize;
            currentSize--;
            return temp;
        } else throw new BufferUnderflowException();
    }

    public T peekFirst() {
        if (!isEmpty()) {
            return buffer[front];
        } else  return null;
    }

    public T peekLast() {
        if (!isEmpty()) {
            return buffer[rear - 1];
        } else return null;
    }

    public int size() {
        return currentSize;
    }

    public boolean isEmpty() {
        if (currentSize == 0) {
            return true;
        } else return false;
    }

    public boolean isFull() {
        if (currentSize == maxSize) {
            return true;
        } else return false;
    }

    public boolean clean() { 
        front = 0;          
        rear = 0;
        while (rear != 0) {
            buffer[rear] = null;
            rear = (rear + 1) % maxSize;
        }   
        return true;
    }

    public static void main(String[] args) {
        CircularBuffer<Integer> buff = new CircularBuffer<>(7);
        buff.push(0);
        buff.push(1);
        buff.push(2);
        System.out.println(buff.size());
        System.out.println("The head element is: " + buff.pop());
        System.out.println("Size should be twoo: " + buff.size());
        System.out.println("The last element is one: " + buff.peekLast());
        System.out.println("Size should be two: " + buff.size());
        buff.clean();
        System.out.println("Size should be zero: " + buff.size());

    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-27T02:17:15.253

如果 lru 缓存可以工作，请考虑只使用[http://java.sun.com/javase/6/docs/api/java/util/LinkedHashMap.html#LinkedHashMap(int,%20float,%20boolean)](http://java.sun.com/javase/6/docs/api/java/util/LinkedHashMap.html#LinkedHashMap(int,%20float,%20boolean))，[http:// /java.sun.com/javase/6/docs/api/java/util/LinkedHashMap.html#removeEldestEntry(java.util.Map.Entry)](http://java.sun.com/javase/6/docs/api/java/util/LinkedHashMap.html#removeEldestEntry(java.util.Map.Entry))

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-04-27T17:29:29.583

这是我为自己使用而编写的实现，但这可能很有用。

缓冲区包含最大的固定项集。该集合是循环的，旧项目会自动删除。调用者可以通过绝对增量索引（长）获取项目尾部，但项目可能在时间太远的调用之间丢失。这个类是完全线程安全的。

```
public sealed class ConcurrentCircularBuffer<T> : ICollection<T>
{
    private T[] _items;
    private int _index;
    private bool _full;

    public ConcurrentCircularBuffer(int capacity)
    {
        if (capacity <= 1) // need at least two items
            throw new ArgumentException(null, "capacity");

        Capacity = capacity;
        _items = new T[capacity];
    }

    public int Capacity { get; private set; }
    public long TotalCount { get; private set; }

    public int Count
    {
        get
        {
            lock (SyncObject) // full & _index need to be in sync
            {
                return _full ? Capacity : _index;
            }
        }
    }

    public void AddRange(IEnumerable<T> items)
    {
        if (items == null)
            return;

        lock (SyncObject)
        {
            foreach (var item in items)
            {
                AddWithLock(item);
            }
        }
    }

    private void AddWithLock(T item)
    {
        _items[_index] = item;
        _index++;
        if (_index == Capacity)
        {
            _full = true;
            _index = 0;
        }
        TotalCount++;
    }

    public void Add(T item)
    {
        lock (SyncObject)
        {
            AddWithLock(item);
        }
    }

    public void Clear()
    {
        lock (SyncObject)
        {
            _items = new T[Capacity];
            _index = 0;
            _full = false;
            TotalCount = 0;
        }
    }

    // this gives raw access to the underlying buffer. not sure I should keep that
    public T this[int index]
    {
        get
        {
            return _items[index];
        }
    }

    public T[] GetTail(long startIndex)
    {
        long lostCount;
        return GetTail(startIndex, out lostCount);
    }

    public T[] GetTail(long startIndex, out long lostCount)
    {
        if (startIndex < 0 || startIndex >= TotalCount)
            throw new ArgumentOutOfRangeException("startIndex");

        T[] array = ToArray();
        lostCount = (TotalCount - Count) - startIndex;
        if (lostCount >= 0)
            return array;

        lostCount = 0;

        // this maybe could optimized to not allocate the initial array
        // but in multi-threading environment, I suppose this is arguable (and more difficult).
        T[] chunk = new T[TotalCount - startIndex];
        Array.Copy(array, array.Length - (TotalCount - startIndex), chunk, 0, chunk.Length);
        return chunk;
    }

    public T[] ToArray()
    {
        lock (SyncObject)
        {
            T[] items = new T[_full ? Capacity : _index];
            if (_full)
            {
                if (_index == 0)
                {
                    Array.Copy(_items, items, Capacity);
                }
                else
                {
                    Array.Copy(_items, _index, items, 0, Capacity - _index);
                    Array.Copy(_items, 0, items, Capacity - _index, _index);
                }
            }
            else if (_index > 0)
            {
                Array.Copy(_items, items, _index);
            }
            return items;
        }
    }

    public IEnumerator<T> GetEnumerator()
    {
        return ToArray().AsEnumerable().GetEnumerator();
    }

    IEnumerator IEnumerable.GetEnumerator()
    {
        return GetEnumerator();
    }

    bool ICollection<T>.Contains(T item)
    {
        return _items.Contains(item);
    }

    void ICollection<T>.CopyTo(T[] array, int arrayIndex)
    {
        if (array == null)
            throw new ArgumentNullException("array");

        if (array.Rank != 1)
            throw new ArgumentException(null, "array");

        if (arrayIndex < 0)
            throw new ArgumentOutOfRangeException("arrayIndex");

        if ((array.Length - arrayIndex) < Count)
            throw new ArgumentException(null, "array");

        T[] thisArray = ToArray();
        Array.Copy(thisArray, 0, array, arrayIndex, thisArray.Length);
    }

    bool ICollection<T>.IsReadOnly
    {
        get
        {
            return false;
        }
    }

    bool ICollection<T>.Remove(T item)
    {
        return false;
    }

    private static object _syncObject;
    private static object SyncObject
    {
        get
        {
            if (_syncObject == null)
            {
                object obj = new object();
                Interlocked.CompareExchange(ref _syncObject, obj, null);
            }
            return _syncObject;
        }
    }
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-06-04T02:03:21.727

这是另一个使用 Apache 公共集合的 BoundedFifoBuffer 的实现。如果您使用来自 Apache 的最新 JAR，请使用 CircularFifoQueue，因为不推荐使用以下类

```
 BoundedFifoBuffer apiCallHistory = new BoundedFifoBuffer(20);

    for(int i =1 ; i < 25; i++){

        if(apiCallHistory.isFull()){
          System.out.println("removing :: "+apiCallHistory.remove());
        }
        apiCallHistory.add(i);

} 
```

* * *

## 回答 #13

> 赞同：-8
> 
> 时间：2010-05-22T21:25:43.770

```
// The following is in C#

public class fqueue
{

  // The following code implements a circular queue of objects

  //private data:

    private bool empty;
    private bool full;

    private int begin, end;

    private object[] x;

  //public data:

    public fqueue()
    {
        empty = !(full = false);
        begin = end = 0xA2;

        x = new object[256];
        return;
    }

    public fqueue(int size)
    {
        if (1 > size) throw new Exception("fqueue: Size cannot be zero or negative");

        empty = !(full = false);
        begin = end = 0xA2;

        x = new object[size];
        return;
    }

    public object write
    {
        set
        {
            if(full) throw new Exception("Write error: Queue is full");

            end = empty ? end : (end + 1) % x.Length;

            full = ((end + 1) % x.Length) == begin;
            empty = false;

            x[end] = value;
        }
    }

    public object read
    {
        get
        {
            if(empty) throw new Exception("Read error: Queue is empty");
            full = false;

            object ret = x[begin];

            begin = (empty=end==begin) ?
                begin :
                (begin + 1) % x.Length;

            return ret;
        }
    }

    public int maxSize
    {
        get
        {
            return x.Length;
        }
    }

    public int queueSize
    {
        get
        {
            return end - begin + (empty ? 0 : 1 + ((end < begin) ? x.Length : 0));
        }
    }

    public bool isEmpty
    {
        get
        {
            return empty;
        }
    }

    public bool isFull
    {
        get
        {
            return full;
        }
    }

    public int start
    {
        get
        {
            return begin;
        }
    }        

    public int finish
    {
        get
        {
            return end;
        }
    }
} 
```

# sql - MS Access 中的重复计数（不同 [f]）

> ID：590073
> 
> 赞同：1
> 
> 时间：2009-02-26T11:04:08.990
> 
> 标签：sql, ms-access

有没有一种快速的方法可以在 MS Access 中复制 Count(Distinct [f])​​ 的效果？

例如：

单个推荐的数据表（实际数据中有几千个）：

```
| Referral ID | Assessment Date | Assessment Team | Service Provided | Service Team
| 1           | 02/01/2008      | AAA             | BBB              | AAA
| 1           | 02/01/2008      | AAA             | CCC              | AAA
| 1           | 02/01/2008      | AAA             | DDD              | BBB
| 1           | 03/01/2008      | BBB             | EEE              | CCC 
```

我想要一个查询，它给出：

```
| Referral ID | Number of Assessments | Teams Assessing | Services Provided | No Teams Providing
| 1           | 2                     | 2               | 4                 | 3 
```

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T14:17:01.773

这有点复杂，但可能适合。小鬼是你的桌子。

```
SELECT DISTINCT a.[Referral ID], b.CountOfADate, c.CountOfATeam, d.CountOfService, e.CountOfSTeam

FROM (((imp AS a 

INNER JOIN 
    (SELECT b1.[Referral ID], Count(b1.ADate) AS CountOfADate
     FROM (SELECT DISTINCT t.[Referral ID], t.[Assessment Date] As ADate FROM imp As t) AS b1
     GROUP BY b1.[Referral ID]) AS b 
ON a.[Referral ID] = b.[Referral ID]) 

INNER JOIN 
    (SELECT c1.[Referral ID], Count(c1.ATeam) AS CountOfATeam
    FROM (SELECT DISTINCT t.[Referral ID], t.[Assessment Team] As ATeam FROM imp As t) AS c1
    GROUP BY c1.[Referral ID]) AS c 
ON a.[Referral ID] = c.[Referral ID]) 

INNER JOIN 
    (SELECT d1.[Referral ID], Count(d1.Service) AS CountOfService
    FROM (SELECT DISTINCT t.[Referral ID], t.[Service Provided] As Service FROM imp As t) AS d1
    GROUP BY d1.[Referral ID]) AS d 
ON a.[Referral ID] = d.[Referral ID]) 

INNER JOIN 
    (SELECT e1.[Referral ID], Count(e1.STeam) AS CountOfSTeam
    FROM (SELECT DISTINCT t.[Referral ID], t.[Service Team] As STeam FROM imp As t) AS e1
    GROUP BY e1.[Referral ID]) AS e 
ON a.[Referral ID] = e.[Referral ID]; 
```

# html - 如何设置在 HTML 选择框中显示的最大项目数量

> ID：590077
> 
> 赞同：6
> 
> 时间：2009-02-26T11:05:25.167
> 
> 标签：html, css

我有一个`<select>`带有一些年份数字的框，范围为 50 年前，目前当我单击该框时，选项将到达屏幕的最底部，有没有办法设置选择框的最大选项数量应该在诉诸滚动条显示其余部分之前显示？我在谷歌上找不到任何关于这个的东西，唯一接近的是`size`属性，这*真的*不是我想要的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T11:10:53.500

不，那是不可能的。

你可以做一些棘手的 JavaScript/AJAX 事情，但通常有更好的解决方案。;)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T11:14:27.950

我相信你不能这样做的原因（对不起）是这些通常被实现为操作系统本机控件，这也意味着它们在不同的浏览器/平台中表现不同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-26T11:27:49.713

使用 Javascript 可以获得类似的效果。这对你来说更近了吗？

```
<select id="mySelect" 
            onfocus="this.size=4" 
            onblur="this.size=1"
            onmouseleave="this.size=1">
    <option>1</option>
    <option>2</option>
    <option>3</option>
    <option>4</option>
    <option>1</option>
    <option>2</option>
    <option>3</option>
    <option>4</option>
    <option>1</option>
    <option>2</option>
    <option>3</option>
    <option>4</option>
</select> 
```

当然，您的非 JavaScript 用户仍然会获得巨大的下降。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T14:22:14.320

@Aistina - 你的问题是指纯 CSS 和 HTML。
正如**teknohippy**和**Lennart**所写，如果你可以\想要包含 JavaScript，你就能得到想要的效果。
您可以构建自己的选择或文本框（[示例](http://www.dhtmlgoodies.com/scripts/ajax-dynamic-list/ajax-dynamic-list.html)）或使用控件来执行此操作（[示例](http://demos.telerik.com/aspnet-ajax/combobox/examples/default/defaultcs.aspx)）

# sql - 对于自动增量字段：MAX(ID) vs TOP 1 ID ORDER BY ID DESC

> ID：590079
> 
> 赞同：17
> 
> 时间：2009-02-26T11:05:59.780
> 
> 标签：sql, sql-server, sql-server-2005, query-optimization

我想从一个字段中找到最高的 AutoIncremented 值。（在我可以使用的插入之后，它没有被获取`@@SCOPE_IDENTITY`等）这两个查询中的哪一个会运行得更快或提供更好的性能。 `Id`是 的主键和`autoincrement`字段`Table1`。这是针对 Sql Server 2005 的。

```
SELECT MAX(Id) FROM Table1

SELECT TOP 1 Id FROM Table1 ORDER BY Id DESC 
```

**[编辑]**
是的，在这种情况下`Id`是我定义聚集索引的字段。
如果索引是`ID DESC`什么..是的，如果 1.Id 是聚集索引 + 主键
，那么很高兴知道性能会受到怎样的影响。 2.id是聚集索引，不是主键。 3.id是非聚集索引ASC+主键。 4.id是非聚集索引ASC，不是主键。 5.id是非聚集索引DESC+主键。 6\. id是非聚集索引DESC而不是主键。 7\. 身份证只是

`AutoIncrement`

希望这不是一个艰巨的任务！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-08-12T15:41:39.650

没有人提到 IDENT_CURRENT('Table1') - 把他们都吹走了 - 当然它只适用于身份列，但这就是*问题*......

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-26T11:59:57.500

**如果有聚集索引，则两个查询之间的性能几乎没有差异。**

这是因为两者都将执行将承担 100% 查询成本的聚集索引扫描。

对没有索引的列执行两个查询会导致在两个执行计划中使用 3 个运算符。

Top 子句使用 Sort 运算符，Max 函数使用 Stream Aggregate 运算符。

当没有索引时，MAX() 函数提供更好的性能。

可以在此处找到概念证明，并且可以在此处找到测试场景的完整演练：

[性能比较 Top 1 Verses MAX() 函数](https://www.johnsansom.com/performance-comparison-of-select-top-1-verses-max/)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-26T11:11:31.517

理论上，他们将使用相同的计划并几乎同时运行。

在实践中，

```
SELECT TOP 1 Id FROM Table1 ORDER BY Id DESC 
```

更有可能使用`PRIMARY KEY INDEX`.

此外，如果您决定选择其他列以及`id`.

一个实际的计划`MAX()`说：

```
SELECT <- AGGREGATE <- TOP <- CLUSTERED INDEX SCAN 
```

，而计划`TOP 1`说：

```
SELECT <- TOP <- CLUSTERED INDEX SCAN 
```

，即`aggregate`省略。

聚合实际上不会在这里做任何事情，因为只有一行。

*PS*如前所述`@Mehrdad Afshari`，`@John Sansom`在非索引字段`MAX`上稍快（当然不是`20`优化器所说的时间）：

```
-- 18,874,368 行

设置语言英语
设置统计时间
设置统计 IO 开启
打印“最大”
从主服务器中选择 MAX(id)
打印“前 1 名”
SELECT TOP 1 id FROM master ORDER BY id DESC
打印“最大”
从主服务器中选择 MAX(id)
打印“前 1 名”
SELECT TOP 1 id FROM master ORDER BY id DESC
打印“最大”
从主服务器中选择 MAX(id)
打印“前 1 名”
SELECT TOP 1 id FROM master ORDER BY id DESC
打印“最大”
从主服务器中选择 MAX(id)
打印“前 1 名”
SELECT TOP 1 id FROM master ORDER BY id DESC
打印“最大”
从主服务器中选择 MAX(id)
打印“前 1 名”
SELECT TOP 1 id FROM master ORDER BY id DESC

将语言设置更改为 us_english。

SQL Server 执行时间：
   CPU 时间 = 0 毫秒，经过时间 = 1 毫秒。

SQL Server 执行时间：
   CPU 时间 = 0 毫秒，经过时间 = 1 毫秒。

SQL Server 执行时间：
   CPU 时间 = 0 毫秒，经过时间 = 1 毫秒。
最大限度

SQL Server 执行时间：
   CPU 时间 = 0 毫秒，经过的时间 = 20 毫秒。

(строкобработано: 1)
表'主'。扫描计数 3，逻辑读取 32655，物理读取 0，预读读取 447，lob 逻辑读取 0，lob 物理读取 0，lob 预读读取 0。

SQL Server 执行时间：
   CPU 时间 = 5452 毫秒，经过时间 = 2766 毫秒。
前1名

SQL Server 执行时间：
   CPU 时间 = 0 毫秒，经过时间 = 1 毫秒。

(строкобработано: 1)
表'主'。扫描计数 3，逻辑读取 32655，物理读取 0，预读读取 2，lob 逻辑读取 0，lob 物理读取 0，lob 预读读取 0。

SQL Server 执行时间：
   CPU 时间 = 6813 毫秒，经过时间 = 3449 毫秒。
最大限度

SQL Server 执行时间：
   CPU 时间 = 0 毫秒，经过时间 = 1 毫秒。

(строкобработано: 1)
表'主'。扫描计数 3，逻辑读取 32655，物理读取 0，预读读取 44，lob 逻辑读取 0，lob 物理读取 0，lob 预读读取 0。

SQL Server 执行时间：
   CPU 时间 = 5359 毫秒，经过时间 = 2714 毫秒。
前1名

SQL Server 执行时间：
   CPU 时间 = 0 毫秒，经过时间 = 1 毫秒。

(строкобработано: 1)
表'主'。扫描计数 3，逻辑读取 32655，物理读取 0，预读读取 0，lob 逻辑读取 0，lob 物理读取 0，lob 预读读取 0。

SQL Server 执行时间：
   CPU 时间 = 6766 毫秒，经过时间 = 3379 毫秒。
最大限度

SQL Server 执行时间：
   CPU 时间 = 0 毫秒，经过时间 = 1 毫秒。

(строкобработано: 1)
表'主'。扫描计数 3，逻辑读取 32655，物理读取 0，预读读取 0，lob 逻辑读取 0，lob 物理读取 0，lob 预读读取 0。

SQL Server 执行时间：
   CPU 时间 = 5406 毫秒，经过时间 = 2726 毫秒。
前1名

SQL Server 执行时间：
   CPU 时间 = 0 毫秒，经过时间 = 1 毫秒。

(строкобработано: 1)
表'主'。扫描计数 3，逻辑读取 32655，物理读取 0，预读读取 0，lob 逻辑读取 0，lob 物理读取 0，lob 预读读取 0。

SQL Server 执行时间：
   CPU 时间 = 6780 毫秒，经过时间 = 3415 毫秒。
最大限度

SQL Server 执行时间：
   CPU 时间 = 0 毫秒，经过时间 = 1 毫秒。

(строкобработано: 1)
表'主'。扫描计数 3，逻辑读取 32655，物理读取 0，预读读取 85，lob 逻辑读取 0，lob 物理读取 0，lob 预读读取 0。

SQL Server 执行时间：
   CPU 时间 = 5392 毫秒，经过时间 = 2709 毫秒。
前1名

SQL Server 执行时间：
   CPU 时间 = 0 毫秒，经过时间 = 1 毫秒。

(строкобработано: 1)
表'主'。扫描计数 3，逻辑读取 32655，物理读取 0，预读读取 10，lob 逻辑读取 0，lob 物理读取 0，lob 预读读取 0。

SQL Server 执行时间：
   CPU 时间 = 6766 毫秒，经过时间 = 3387 毫秒。
最大限度

SQL Server 执行时间：
   CPU 时间 = 0 毫秒，经过时间 = 1 毫秒。

(строкобработано: 1)
表'主'。扫描计数 3，逻辑读取 32655，物理读取 0，预读读取 0，lob 逻辑读取 0，lob 物理读取 0，lob 预读读取 0。

SQL Server 执行时间：
   CPU 时间 = 5374 毫秒，经过时间 = 2708 毫秒。
前1名

SQL Server 执行时间：
   CPU 时间 = 0 毫秒，经过时间 = 1 毫秒。

(строкобработано: 1)
表'主'。扫描计数 3，逻辑读取 32655，物理读取 0，预读读取 0，lob 逻辑读取 0，lob 物理读取 0，lob 预读读取 0。

SQL Server 执行时间：
   CPU 时间 = 6797 毫秒，经过时间 = 3494 毫秒。

```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-26T11:12:48.050

只需比较执行计划，您就会看到（`Ctrl+M`编辑查询时在 Management Studio 中按下）。我的疯狂猜测是，只要`Id`列上有（聚集）索引，这些查询的性能相同。

然而，这作为一个整体是一个*非常糟糕的*主意。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-26T11:17:12.970

`MAX`一般比较快。

如果存在，两个查询都将使用列上的索引。

如果列上不存在索引，则`TOP 1`查询将使用`Top N Sort`运算符对表进行**排序**，而不是**流聚合**，这会使其变慢。

`MAX`还提供了更好的可读性。

*旁注*：虽然`MAX`将在索引情况下的执行计划中使用流聚合运算符，但它没有任何特定成本，因为它只是处理单行（`Actual Rows = 1`）。您可以通过在单个批次中运行查询来比较查询并查看相对成本。在索引的情况下，两个查询都将花费 50%。我在一个大约有 7000 行的表上测试了非索引案例，与成本为 35% 的 MAX 相比，TOP 的成本为 65%。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-26T12:06:58.513

我刚刚针对典型数据集测试了您提供的两个 SQL 语句：

```
SELECT MAX(Id) FROM Table1

SELECT TOP 1 Id FROM Table1 ORDER BY Id DESC 
```

并且`SELECT TOP 1 Id FROM Table1 ORDER BY Id DESC`稍微快一点，因为它在执行计划中少了一个步骤。以下是每个查询执行的执行计划：

**从表 1 中选择 MAX(Id)**

聚集索引扫描 >> 顶部 >> 流聚合 >> 选择

**SELECT TOP 1 Id from Table1 ORDER BY Id DESC**

聚集索引扫描 >> 顶部 >> 选择

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-26T19:27:02.480

> 是的，在这种情况下，Id 是我定义聚集索引的字段。如果索引是 ID DESC 那么什么.. 是的，很高兴知道如果
> 
> 1.  Id 是聚集索引 + 主键。
> 2.  Id 是聚集索引而不是主键。
> 3.  Id 是非聚集索引 ASC + 主键。
> 4.  Id 是非聚集索引 ASC，而不是主键。
> 5.  Id 是非聚集索引 DESC + 主键。
> 6.  Id 是非聚集索引 DESC 而非主键。
> 7.  Id 只是自动增量

对于案例 1 和 2，两者都将执行返回单个记录的聚集索引扫描。两个查询之间没有 IO 差异。

对于案例 3、4、5 和 6，两者都将执行返回单个记录的索引扫描。两个查询之间没有 IO 差异。

对于案例 7，两者都将执行表扫描。IO成本没有区别。

总结：案例1-6都是赢了！如果您处于案例 7 中，那么从 IO 的角度来看，您已经失败了。

您可以使用 SQL 的查询分析器来测量 IO。在查询之前运行它。

```
SET STATISTICS IO ON 
```

# c# - DataTable.DefaultView- 需要解释 C#

> ID：590082
> 
> 赞同：0
> 
> 时间：2009-02-26T11:06:42.243
> 
> 标签：c#, datatable

这是让我有点不安的代码..

```
DataTable dt=GetDataTable();
for(int i=0<dt.Rows.Count;i++)
{
   string Name=dt.DefaultView[i].Row["FirstName"].ToString()
} 
```

我需要对此进行解释，实际上 dt.DefaultView[i] 在这里是什么意思？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T11:16:35.793

实际上，该代码是多余的。“视图”将实际的 DataTable 映射到具有可用于数据绑定场景的虚拟属性的东西。默认视图只是“所有列，按此顺序，无初始排序，无初始过滤器”布局。

使用您的代码，该行：

```
string Name = dt.Rows[i]["FirstName"].ToString(); 
```

应该没事。

顺便说一句-`for`可以稍微整理一下用法和字符串索引器：

```
 DataColumn col = dt.Columns["FirstName"];
    foreach (DataRow row in dt.Rows)
    {
        string name = (string)row[col];
        //.. do something with name
    } 
```

这更容易阅读和更有效（DataColumn 索引器是最佳的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T11:25:56.987

dt.DefaultView[i] 返回 DefaultView 中索引 i 处的行的 DataRowView 实例。

[DataRowView 上的 MSDN](http://msdn.microsoft.com/en-us/library/system.data.datarowview.aspx)

# winapi - 使用 PowerShell 回收 IIS 应用程序池：“异常调用回收”

> ID：590094
> 
> 赞同：3
> 
> 时间：2009-02-26T11:11:45.073
> 
> 标签：winapi, powershell, iis-6, wmi, application-pool

看起来最近的 Windows 更新破坏了我用来回收 IIS6 应用程序池的一些功能，因为这已经工作了几个月直到今天。

```
Exception calling "Recycle" : "Win32: The object identifier does not representException calling "Recycle" : "Win32: The object identifier does not represent a valid object. 
```

我用来回收应用程序池的功能是：

```
function recycle-pool($strServerName)
{
    $objWMI = [WmiSearcher] "Select * From IIsApplicationPool"
    $objWMI.Scope.Path = "\\" + $strServerName + "\root\microsoftiisv2"
    $objWMI.Scope.Options.Authentication = 6
    $pools = $objWMI.Get()
    foreach ($pool in $pools)
    {
        $pool.recycle()
        if (!$?)
        {
            Write-Host $pool.name " - ERROR"
        }
        else
        {
            Write-Host $pool.name " - Recycled"
        }
} 
```

关于问题是什么以及我应该如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-12-06T01:02:46.843

最初的问题是针对 IIS6 的，但我在 Windows 2012 上使用 WebAdministration Module 的 Restart-WebAppPool 遇到了类似的问题。所以我回过头来调用 AppCMD，效果很好：

```
& $env:windir\system32\inetsrv\appcmd recycle apppool "YOURAPPPOOLNAMEHERE" 
```

有时，您不必过度设计解决方案。希望有一天能帮助其他人。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T12:18:04.097

其中一个应用程序池已停止，这导致了错误。其他应用程序池回收良好。上面的代码可以用于其他任何人。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T13:51:51.240

您可以尝试使用 ADSI 进行回收：

```
$server = "IIsServerName"  
$iis = [adsi]"IIS://$server/W3SVC/AppPools"  
$iis.psbase.children | foreach {  
    $pool = [adsi]($_.psbase.path)   
    $pool.psbase.invoke("recycle")  
} 
```

# c++ - 从 Windows 上的服务器端检测 RPC 连接丢失

> ID：590098
> 
> 赞同：3
> 
> 时间：2009-02-26T11:12:58.393
> 
> 标签：c++, c, windows, winapi, rpc

有没有办法从服务器端检查 RPC 连接的状态？我正在寻找一种方法来检测来自客户端的连接是否丢失，无论是客户端崩溃还是其他连接问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T13:14:46.477

使用[上下文句柄](http://msdn.microsoft.com/en-us/library/aa373969(VS.85).aspx)管理特定客户端调用之间的服务器状态。RPC 使用 keep-alive 来检测客户端断开连接，如果客户端断开连接，它将执行您的上下文句柄中断例程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T00:26:43.383

莫弗拉纳根的回答是最好的恕我直言。更多的上下文。

如果您使用绑定句柄，则无法跨 RPC 调用跟踪状态，并且“客户端断开连接”的概念基本上没有意义 - 您仍然需要从 RPC 调用返回。

如果您使用上下文句柄，则 RPC 运行时库将在客户端断开连接时调用 _rundown 函数。

当调用该例程时，服务器可以清理它需要的任何东西。

# asp.net - UpdatePanel.Visible = true 没有效果

> ID：590099
> 
> 赞同：5
> 
> 时间：2009-02-26T11:13:18.110
> 
> 标签：asp.net, ajax, panel, visible

有一个广泛的任务。有一个更新面板upDetails，当用户从主表中选择任何项目时，它会显示详细信息表（最初可见= false），我们应该设置详细信息.Visible = true;

但它在我放置它的任何地方/事件中都不起作用——既不是 BL 方法，也不是预渲染。它仍然是看不见的

但是当我不让它最初不可见时，一切正常

我做错了什么？

提前致谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-26T11:22:18.510

您是在谈论**ASP.NET Ajax UpdatePanel**控件吗？尝试在 UpdatePanel 中放置一个“真正的”面板控件 (asp:Panel)，并将该控件的可见性设置为 false/true，并使 UpdatePanel 可见。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-05-27T07:43:25.243

如果 updatepanel 可见性设置为 false，则不会在输出中呈现。没有被渲染，它不存在客户端，然后它不能被使用（不是 ajax 事件）。

使用占位符可以解决您的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-02-04T06:41:18.733

不幸的是，我搜索了很长时间，进行了实验，但无法让它发挥作用。我的最终决定是将我想在占位符控件中显示/隐藏的内容包装起来。它们为您提供了在不添加标记的情况下切换可见性的灵活性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T18:00:01.297

您应该检查以确保包含您面板的任何控件都是可见的。如果不是，则在 updatepanel 控件上设置 visible 属性将不会执行任何操作，因此您需要首先确保容器控件可见。

# ruby-on-rails - 在 Rspec 的全局 before(:all) 中设置 HTTP_REFERER

> ID：590100
> 
> 赞同：6
> 
> 时间：2009-02-26T11:13:33.163
> 
> 标签：ruby-on-rails, rspec

为了避免添加

```
request.env["HTTP_REFERER"] = '/' 
```

在我创建的每个 controller_spec 文件的 before 块中，我尝试将其添加到全局配置中（在 spec_helper.rb 中）

```
config.before(:each) {request.env["HTTP_REFERER"] = '/'} 
```

问题是，我收到以下错误：

```
You have a nil object when you didn't expect it!
The error occurred while evaluating nil.env 
```

有没有人关于如何正确实现这一点的任何指示？

干杯!

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-26T20:08:39.493

你有没有尝试过

```
 config.before(:type => :controller) do
    request.env["HTTP_REFERER"] = "/"
  end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-07-10T23:27:03.437

我注意到马特的回答是 2 年前，我不确定他使用的是什么“rspec”版本。但就我而言，我的 rspec 版本 = 1.3.2，并且代码段不起作用（总是出错：

```
You might have expected an instance of Array.
The error occurred while evaluating nil.<<
    from /usr/lib/ruby/gems/1.8/gems/rspec-1.3.2/lib/spec/runner/configuration.rb:181:in `__send__'
    from /usr/lib/ruby/gems/1.8/gems/rspec-1.3.2/lib/spec/runner/configuration.rb:181:in `add_callback'
    from /usr/lib/ruby/gems/1.8/gems/rspec-1.3.2/lib/spec/runner/configuration.rb:101:in `before'
... 
```

)，直到我稍微改变一下：

```
# here the ":each" symbol is very important and necessary.  
# :type => :controller is the "option"
config.before(:each, :type => :controller) do
  request.env["HTTP_REFERER"] = "/"
end 
```

请参阅 rspec-1.3.2 的文档：

```
append_before(scope = :each, options={}, &proc)
Appends a global before block to all example groups. scope can be any of 
:each (default), :all, or :suite. 
When :each, the block is executed before each example. 
When :all, the block is executed once per example group, before any of its examples are run. 
When :suite the block is run once before the entire suite is run. 
```

# visual-studio-2008 - 禁用 EnterpriseLibrary 与 VS2008 的集成

> ID：590101
> 
> 赞同：0
> 
> 时间：2009-02-26T11:13:38.873
> 
> 标签：visual-studio-2008, integration, enterprise-library

有谁知道禁用企业库与 VS 集成的快速方法。问题在于它会锁定 AppDomain.AssemblyLoad 事件，并且每次 VS 加载程序集时都会爬取 30 多个项目，如果您有工作流项目，这种情况经常发生。每次发生这种情况时，VS 都会在几分钟内无法使用:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-26T12:18:14.490

删除以下键有很大帮助：

```
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\9.0\Packages\{488366a4-630c-4a0e-a6a2-b019cee13bea}] 
```

与之前的 2-4 分钟相比，现在的冻结时间不到 15 秒！:)

# .net - 添加文本时防止文本框滚动

> ID：590106
> 
> 赞同：4
> 
> 时间：2009-02-26T11:15:19.137
> 
> 标签：.net, winforms, user-interface, textbox, scroll

我正在向 WinForms TextBox 对象添加新的日志行，这会导致文本框滚动到底部。我怎样才能防止这种情况并保留我目前的职位？（一个简短的代码片段会有所帮助）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-02-28T14:57:49.360

实际上， AppendText() 不会做你想做的事（尝试添加更多文本，但在某些时候一切都会出错）

答案实际上在 Win32 API 中，幸运的是，一个 SO 用户已经完美地实现了这个行为： [自动滚动文本框使用的内存比预期的要多](https://stackoverflow.com/questions/1743448/auto-scrolling-text-box-uses-more-memory-than-expected-c-net-v3-5)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T20:40:35.963

在 C# 中，您可以尝试`<yourTextBox>.Text += "your new text";`代替`<yourTextBox>.AppendText("your new text");`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-06T06:44:02.417

对所提问题的正确和简单的答案是`SelectedText`（读/写）属性。您可以为其分配一些文本，该文本将出现在插入符号位置，而不必滚动文本框。您可以`SelectionStart`在此之前使用将插入符号移动到正确的位置。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-26T11:33:28.170

由于某种原因，SelectionStart 没有做我想做的事。它被重置为 0。我发现[这篇文章](http://vidmar.net/weblog/archive/2005/08/15/2092.aspx)回答了我想要的（即使用文本框作为日志）。答案是 TextBox.AppendText()

# algorithm - 查找排序数组中的所有重复值和缺失值

> ID：590109
> 
> 赞同：0
> 
> 时间：2009-02-26T11:15:41.413
> 
> 标签：algorithm, language-agnostic, find

假设您在数组中有一个排序范围（x 到 y）的值。

```
x = 3;
y = 11;

array == 3, 4, 5, 6, 7, 8, 9, 10, 11 
```

但有可能有些值是重复的，有些是缺失的，所以你可能有：

```
array == 4, 5, 5, 5, 7, 8, 9, 10, 10 
```

用您的语言查找所有重复值和缺失值的最佳方法是什么，以便您获得：

```
resultMissingValuesArray == 3, 6, 11
resultDuplicatesArray == 5, 5, 10 
```

这里有一些 C++ 代码可以帮助您入门：

```
#include <vector>
#include <iostream>
#include <algorithm>

using namespace std;

const int kLastNumber = 50000; // last number expected in array
const int kFirstNumber = 3; // first number expected in array

int main()
{
    vector<int> myVector;

    // fill up vector, skip values at the beginning and end to check edge cases
    for(int x = kFirstNumber + 5; x < kLastNumber - 5; x++)
    {   
        if(x % 12 != 0 &&  x % 13 != 0 && x % 17 != 0)
            myVector.push_back(x);  // skip some values

        else if(x % 9 == 0)
        {
            myVector.push_back(x);  // add duplicates
            myVector.push_back(x);  
        }

        else if(x % 16 == 0)
        {
            myVector.push_back(x);  // add multiple duplicates
            myVector.push_back(x);  
            myVector.push_back(x);  
            myVector.push_back(x);  
        }
    }

    // put the results in here
    vector<int> missingValues;
    vector<int> duplicates;

    //  YOUR CODE GOES HERE         

    // validate missingValues for false positives
    for(int x = 0; x < (int) missingValues.size(); ++x)
    {
        if(binary_search(myVector.begin(), myVector.end(), missingValues.at(x)))
            cout << "Oh noes! You missed an unmissed value. Something went horribly, horribly wrong.";
    }

    // validate duplicates (I think... errr)
    vector<int>::iterator vecItr = myVector.begin();
    vector<int>::iterator dupItr = duplicates.begin();

    while(dupItr < duplicates.end())
    {
        vecItr = adjacent_find(vecItr, myVector.end());     

        if(*vecItr != *dupItr)
            cout << "Oh noes! Something went horribly, horribly wrong.";

        // oh god
        while(++dupItr != duplicates.end() && *(--dupItr) == *(++dupItr) && *vecItr == *(++vecItr));            

        ++vecItr;
    }

    return 0;
} 
```

我没有对验证部分进行太多测试，所以它们可能有问题（尤其是重复的部分）。

我将发布我自己的解决方案作为答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T11:47:57.030

我最喜欢的 - Python，非常简单：

```
x = 3
y = 11
array = [ 3, 4, 5, 6, 7, 8, 9, 10, 11 ]
test  = [ 4, 5, 5, 5, 7, 8, 9, 10, 10 ]

resultMissingValuesArray = set(range(x,y+1)).difference(test)        
resultDuplicatesArray = reduce(lambda i,j: i+j, [[n]*(test.count(n)-1) for n in set(test) if test.count(n)>1], []) 
```

通过这一行可以更容易地找到重复项：

```
resultDuplicatesArray = [n for n in set(test) if test.count(n)>1]
# [5, 10] - just numbers, that have duplicates
# you can use test.count(5) for number of duplicates 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T12:07:06.360

红宝石：

```
x = 3
y = 11
array  = [ 4, 5, 5, 5, 7, 8, 9, 10, 10 ]

resultMissingValuesArray = (x..y).to_a - array
resultDuplicatesArray = array.delete_if { |e| array.index(e) == array.rindex(e) }.uniq 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T11:24:25.370

由于您已将其标记为与语言无关，因此这是我将使用的算法。

```
# Get numbers and sort them in ascending order.

input x,y;
input number[1..n];
sort number[1..n];

# Set dups and missing to empty sets.

dups = [];
missing = [];

# Get edge cases.

if number[1] > x:
    foreach i x .. number[1] - 1:
        missing.add(i)
if number[n] < y:
    foreach i number[n] + 1 .. y:
        missing.add(i)

# Process all numbers starting at second one.

foreach i 2 .. n:
    # If number same as last and not already in dups set, add it.

    if number[i] == number[i-1] and not dups.contains(number[i]):
        if number[i] >= x and number[i] <= y:
            dups.add(number[i])

    # If number not last number plus one, add all between the two
    #   to missing set.

    if number[i] != number[i-1] + 1:
        foreach j number[i-1] + 1 .. number[i] - 1:
            if j >= x and j <= y:
                missing.add(j) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-03T14:47:50.770

我认为您可以在 C++ 中快速做到这一点，方法是设置第二个数组作为检查以查看已找到哪些元素，然后在每次找到元素时将其元素递增一。所以：

```
int array = [3,4,5,6,7,8,9,10,11];
unsigned array_size = 9;
int test = [4,5,5,5,7,8,9,10,10];

// Find the maximum element in array
// This might not be necessary if it's given somewhere
unsigned max = 0;
unsigned min = -1;
for(unsigned i = 0; i < array_size; i++){
    if(array[i] > max)    max = array[i];
    if(array[i] < min)    min = array[i];
}

// Go make a counts vector to store how many examples of each value there are
vector< unsigned > counts(max+1, 0);
for(unsigned i = 0; i < array_size; i++)
    counts[test[i]]++;

// Gather the unique elements, duplicates and missing elements
vector< unsigned > unique;
vector< unsigned > duplicates;
vector< unsigned > missing;
for(unsigned i = min; i < max + 1; i++){
    switch(counts[i]){
        case 0 : missing.push_back(i);    break;
        case 1 : unique.push_back(i);     break;
        default: duplicates.push_back(i);
    }
} 
```

这仅在数组中的数字大于 0 时才有效，这通常是这种情况。好处是它在元素数量上线性缩放，这很有用:-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T11:22:36.777

```
if(myVector.front() > kFirstNumber)
    for(int x = kFirstNumber; x < myVector.at(0); ++x)
        if(x >= kFirstNumber && x <= kLastNumber)
            missingValues.push_back(x);

for(int x = 1; x < (int) myVector.size(); ++x)
{
    if(myVector.at(x) == myVector.at(x - 1))
        if(x >= kFirstNumber && x <= kLastNumber)
            duplicates.push_back(myVector.at(x));

    if(myVector.at(x) != myVector.at(x - 1) + 1)
        for(int y = myVector.at(x - 1) + 1; y <= myVector[x] - 1; y++)
            if(y >= kFirstNumber && y <= kLastNumber)
                missingValues.push_back(y);
}   

if(myVector.back() < kLastNumber)
    for(int x = myVector.back() + 1; x <= kLastNumber; ++x)
        if(x >= kFirstNumber && x <= kLastNumber)
            missingValues.push_back(x); 
```

（我的解决方案非常难看，所以我用 Pax 算法的 C++ 实现替换了它。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-26T13:43:09.483

在蟒蛇

```
consecutive=zip(l[0:-1],l[1:])
duplicate=[ a for (a,b) in consecutive if a==b]
missing=reduce(lambda u,v:u+v, [range(a+1,b) for (a,b) in consecutive]) 
```

# apache-flex - 如何编码 MXML 以将侦听器附加到自定义 ActionScript 类

> ID：590118
> 
> 赞同：5
> 
> 时间：2009-02-26T11:18:51.153
> 
> 标签：apache-flex, actionscript, event-handling

例如，以下 MXML 脚本将侦听器附加到 Button 类：

```
<mx:Button id="STACK" label="OVERFLOW" click="doStuff()"/> 
```

我有一个自定义操作脚本类，它在值更新时触发一个事件，我希望能够在 MXML 类中监听该事件：

动作脚本类：

```
public function set currentPage(newCurrentPage: Number) : void {
    _currentPage = newCurrentPage;

    dispatchEvent(new DataEvent(PAGE_CHANGED, true, false, _currentPage));
} 
```

我希望能够在 MXML 中执行以下操作：

```
<myClass:Class <...> pageChanged="doMoreStuff()" /> 
```

我该怎么做？干杯:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-26T11:28:25.140

您必须使用元数据标签声明事件：

```
<mx:Metadata>
[Event(name="pageChanged", type="full.type.name.of.DataEvent")]
</mx:Metadata> 
```

事件的名称必须与事件名称匹配（在您的示例中为 PAGE_CHANGED 常量）。

编辑：如果您在 ActionScript 而不是 MXML 中编写类，则可以将元数据标记直接应用于您的类：

```
[Event(name="pageChanged", type="full.type.name.of.DataEvent")]
public class MyClass extends WhateverItExtends 
```

# javascript - javascript - 通过指定坐标检索 html 控件

> ID：590119
> 
> 赞同：3
> 
> 时间：2009-02-26T11:18:56.990
> 
> 标签：javascript, javascript-events

如何仅通过指定触发事件的坐标（如 onmousedown、onmouseup、onclick 等）来获取 html 控件的 id。坐标可以通过

e.clientX , e.clientY 其中 e 是事件对象。

这个想法是获取完成单击事件的控件的 ID，而该控件的定义中没有任何 onClick 事件。

这将免除为多个控件指定 onClick 事件的需要。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-26T11:27:31.167

我不认为这是可能的，但幸运的是（如果我正确理解您的要求）您不需要：

如果您想获取用户单击的 HTML 元素，而不在每个元素上指定单击事件处理程序，只需在顶级元素（包含所有其他有趣元素 - 甚至可能是“文档”的元素）上指定一个单击处理程序，然后查看 MouseEvent 的 target 属性——它将指定最初接收点击的 HTML 元素，而不是您指定 onclick 事件处理程序的元素（这可以通过使用“this”关键字简单地获得）。

如果你有 firebug，请在 StackOverflow 上的 firebug 控制台中尝试一下：

```
document.getElementById('question').onclick = function(e) { 
  var target = window.event?window.event.srcElement:e.target; 
  alert("Got click: " + target); 
} 
```

然后单击问题文本上的任意位置以获取包含正确 HTML 元素的警报 :-)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-23T00:08:27.357

这是一个非常好的问题，假设我们正在寻找的函数是这样的：

```
document.elementFromPoint = function(x,y) { return element; }; 
```

这个不起眼的功能实际上是在 Firefox 3.0 中使用 gecko 布局引擎实现的。

[https://developer.mozilla.org/en/DOM/document.elementFromPoint](https://developer.mozilla.org/en/DOM/document.elementFromPoint)

但它在其他任何地方都不起作用。您可以自己构建此功能：

```
document.elementFromPoint = function(x,y) {

    // Scan through every single HTML element
    var allElements = document.getElementsByTagName("*");

    for( var i = 0, l = allElements.length; i < l; i++ ) {

        // If the element contains the coordinate then we found an element:
        if( getShape(allElements[i]).containsCoord(x,y) ) {
            return allElements[i];
        }

    }

    return document.body;

}; 
```

这将非常缓慢，但是，它可能会起作用！如果您正在寻找这样的东西来使您的 HTML 代码更快，那么请找到其他东西......

基本上，它会遍历文档中的每一个 HTML 元素，并尝试找到一个包含坐标的元素。我们可以使用 element.offsetTop 和 element.offsetWidth 来获取 HTML 元素的形状。

有一天我可能会发现自己使用这样的东西。如果您想在整个文档中创建通用内容，这可能会很有用。就像可以在任何地方工作的工具提示系统，或者在任何左键单击时启动上下文菜单的系统。最好找到某种方法在 HTML 元素上缓存 getShape 的结果...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T11:23:53.030

> 这将免除为多个控件指定 onClick 事件的需要。

如果这是您唯一的目标，我建议使用 jQuery 优雅地为多个元素指定事件处理程序。

这是来自[jQuery 教程](http://docs.jquery.com/Tutorials:Getting_Started_with_jQuery)的示例之一，它正是这样做的：

```
 $(document).ready(function() {
    $("a[href*=/content/gallery]").click(function() {
       // do something with all links that point somewhere to /content/gallery
    });
 }) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T11:32:35.943

当您的 HTML 页面渲染时，各种元素的位置将由您的浏览器的渲染引擎动态得出。唯一可以对其结果布局属性进行可靠测试的元素是图像。

因此，要执行您想要的操作，您需要对所有元素使用绝对定位，并在其他位置存储一个页面地图以将控件与位置联系起来。我想这太复杂了！

尽管它与您的问题有些矛盾，但您应该通过 javascript 或服务器端将 onclick 事件附加到您的控件。对不起！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T11:35:36.793

你实际上并不需要这个职位。您需要的是**[事件对象的目标属性](https://developer.mozilla.org/en/DOM/event.target)**。我不知道这是如何在 jQuery 中处理的，但这里有一个受上述资源启发的快速示例：

**JavaScript**

```
<script type="text/javascript">
window.onload = function() {
    document.body.onclick = function(event) {
        alert(event.target.id);
    }
}
</script> 
```

**CSS**

```
div {
 width: 200px;
 height: 200px;
 margin: 30px;
 background: red;
} 
```

**HTML**

```
<div id="first-div"></div>
<div id="second-div"></div> 
```

# regex - 我没有得到正则表达式

> ID：590122
> 
> 赞同：10
> 
> 时间：2009-02-26T11:21:02.070
> 
> 标签：regex

我不理解或看不到正则表达式的必要性。

有些人可以用简单的术语解释它们，并提供一些有用的基本示例，甚至是关键的。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-02-26T11:25:16.770

在需要使用/操作*模式*的地方使用它们。例如，假设您需要识别以下模式：

*   任何字母，AZ，大写或小写，5 或 6 次
*   3 位数
*   单个字母 az（绝对小写）

（邮政编码、信用卡、社会安全号码验证等都会出现这种情况。）

用代码编写这并不*难*——但随着模式变得越来越复杂，它变得越来越难。使用正则表达式，您描述*模式*（而不是验证它的代码）并让正则表达式引擎为您完成工作。

这里的模式类似于

```
[A-Za-z]{5,6}[0-9]{3}[a-z] 
```

（也有其他表达方式。）分组结构可以很容易地匹配整个模式并抓取（或替换）它的不同部分。

虽然有一些缺点：

*   正则表达式可能会变得复杂且难以很快阅读。彻底记录！
*   不同的正则表达式引擎之间的行为存在差异
*   如果您不是专家（我当然不是！），则很难判断其复杂性；有一些“陷阱”可以使模式对特定输入非常慢，这些陷阱根本不明显
*   有些人大量过度使用正则表达式（当然有些人使用不足）。我见过的最糟糕的例子是有人问（在 C# 组中）如何检查字符串的长度是否为 3 - 这显然是使用 String.Length 的工作，但有人*认真*建议匹配正则表达式。疯狂。（他们也弄错了正则表达式，这有点证明了这一点。）
*   正则表达式使用反斜杠来转义各种事物（例如，使用 . 来表示“一个点”而不仅仅是“任何字符”。在许多语言中，反斜杠本身需要转义。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-02-26T11:24:43.963

**什么正则表达式用于：**

正则表达式本身就是一种允许您对字符串输入执行复杂验证的语言。即，您将一个字符串传递给它，如果匹配与否，它将返回真或假。

**如何使用正则表达式：**

*   表单验证，判断用户输入的是不是你想要的格式
*   在文本块中查找特定模式的位置
*   搜索和替换搜索词是正则表达式的地方，替换的是普通字符串。

**一些正则表达式语言特性：**

*   **交替：**允许您选择一件事或另一件事。示例仅匹配是或否。

    是|否

*   **分组：**您可以使用括号定义范围和优先级。例如匹配 3 种色调。

    gr(a|e)y|黑色|白色

*   **量化：** 你可以量化你想要多少东西。? 表示 1 或 0，* 表示 0 或更多。+ 表示至少一个。示例：接受一个非空的二进制字符串：

    (0|1)+

**为什么是正则表达式？**

正则表达式使匹配字符串变得容易，它通常可以用一个简单的小正则表达式字符串替换几十行源代码。

**不适用于所有类型的匹配：**

要了解某物如何有用，您还应该了解它如何无用。正则表达式不适合某些任务，例如当您需要保证字符串具有相同数量的括号时。

**提供几乎所有语言版本：**

正则表达式几乎可以在任何编程语言中使用。

**正式语言：**

任何正则表达式都可以转换为确定性有限状态机。并且以同样的方式，您可以弄清楚如何制作将验证您的正则表达式的源代码。

**例子：**

```
[hc]+at 
```

匹配“hat”、“cat”、“hhat”、“chat”、“hcat”、“ccchat”等，但不匹配“at”

[来源，进一步阅读](http://en.wikipedia.org/wiki/Regular_expression)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-26T11:26:48.750

它们看起来有点神秘，但它们提供了一个非常强大的工具来查找**文本中的模式**。从`href`HTML 页面中的标签到验证电子邮件地址的任何内容。

它们可以被处理成一个非常有效的数据结构（FSA），可以非常快速地找到匹配项。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-26T11:26:01.513

它们有点棘手，但非常强大，值得学习。网络上到处都是教程和示例，例如从[这里开始，然后查看](http://www.regular-expressions.info/tutorial.html)[这里](http://www.regular-expressions.info/examples.html)的示例。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-26T12:00:58.963

如果我可以将 OP 引导到我自己的一个问题的一些答案/评论：[了解正则表达式有多重要？](https://stackoverflow.com/questions/519929/how-important-is-knowing-regexs)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-26T11:34:47.200

正则表达式是指定大多数模式匹配和替换问题的一种非常简洁的方法，并且正则表达式引擎可以进行高度优化。

如果你想做与相对简单的正则表达式相同的工作，你将不得不编写大量代码，其中可能包含许多错误，难以理解并且性能不佳。

而对正则表达式执行相同操作的时间要短得多，几乎可以肯定其性能与技术上可能的一样好，并且对于任何熟悉正则表达式的人来说都更容易理解（尽管在任何一种情况下都应该对其进行评论）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-26T11:48:19.400

电子邮件示例实际上是正则表达式的一个坏示例。可以使用正则表达式，但生成的表达式（例如[这个](http://www.geekzilla.co.uk/View0B840FC8-E8B1-4EDD-888B-41F4D8AB7E0C.htm)不处理“John Doe”样式地址的表达式）非常复杂 - 看看[电子邮件地址规范](http://en.wikipedia.org/wiki/E-mail_address)，你就会明白为什么......

然而，正则表达式在许多其他情况下非常有用，例如从文本中提取 IP 地址、从 html 中提取标签等。查找所有版本化文件将是另一个示例。类似于以下内容：

```
my_versioned_file_(\d{4}-\d{2}-\d{2}).txt 
```

将匹配该格式的任何文件名`my_versioned_file_2009-02-26.txt`并将日期提取为捕获组（包裹在“（）”中的部分）供您进一步分析。

没有正则表达式不是必需的，但它们可以节省大量时间来编写手动解析器，以实现正则表达式可以轻松实现的目标。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-26T11:29:17.200

给你一些例子：

*   电子邮件地址

*   密码至少需要 1 个字母和 1 个数字

*   你怎么能达到这些要求？

*   最好的方法是使用正则表达式。

阅读以下链接以了解更多信息：

**如何：在 ASP.NET 中使用正则表达式来约束输入** [http://msdn.microsoft.com/en-us/library/ms998267.aspx](http://msdn.microsoft.com/en-us/library/ms998267.aspx)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-26T11:29:52.173

每当您在大量文本数据中找到某种模式时，或者如果您想检查字符串是否采用某种格式。

例如电子邮件地址...

检查 at 符号和是否存在有效域的代码看起来非常大，您可以只使用正则表达式并在 2 行代码中得到答案。

```
Regex r = new Regex("<An Email Address Regex>");
bool isValidEmail = r.IsMatch(MyInput); 
```

其他示例是在将数字解析为整数等之前检查数字的格式是否正确。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-26T12:35:22.813

Jon 和 Sqook 对正则表达式给出了很好的解释和定义，对于简单的问题它是很容易理解的，但是如果你用它来解决复杂的问题，正则表达式可以是 &$ *@* ((至少对我来说;-))

我经常使用 Expresso 来帮助我构建复杂的正则表达式代码。

[http://www.ultrapico.com/Expresso.htm](http://www.ultrapico.com/Expresso.htm)

它有一个内置库，其中包含您可以使用的表达式、一个可以构建代码的设计模式以及一个可以测试和验证代码的测试模式。它帮助我更好地构建和理解复杂的表达式！

祝你好运！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-27T21:48:09.777

一些实际的现实世界用法：

查找扩展 JUnit 的 TestCase 的抽象类：

```
abstract\s+class\s+\w+\s+extends\s+TestCase 
```

这对于查找无法实例化并且需要从运行测试用例的 ant 构建脚本中排除的测试用例很有用。您无法搜索常规文本，因为您事先不知道类名。因此 \w+ （至少一个单词字符）。

查找正在运行的 bash 或 bourne shell 脚本：

```
 ps -e | grep -e " sh| bash" 
```

如果您想将它们全部或其他东西杀死，这很有用，如果您只搜索 sh ，您将无法获得 bash 并且必须再次运行该命令以获取 bash 脚本。同样，比完美更有用，但几乎没有你在运行中编写的正则表达式。

它并不完美，但大多数正则表达式不会，否则它们会花费很长时间来编写它们不值得。你完善的那些是你作为某种验证或构建应用程序的一部分提交的那些。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-10-21T07:57:38.050

关键用途的例子是**JavaScript**：
如果你需要对一个字符串做`search`or `replace`，你唯一能做的匹配就是一个正则表达式。它在那些字符串方法的 JavaScript API 中......

[就个人而言，我只在需要在文本编辑器（ TextPad](http://en.wikipedia.org/wiki/TextPad)或 Visual Studio）中进行一些自动查找/替换的高级匹配时才使用正则表达式。在我看来，最强大的功能是能够匹配可以插入替换的模式。

# c# - 定时器不能在 C# 中停止

> ID：590141
> 
> 赞同：0
> 
> 时间：2009-02-26T11:26:09.220
> 
> 标签：c#, .net, winforms, timer

我在 Windows 窗体（C# 3.0、.net 3.5 SP1、VS2008 SP1、Vista）上有一个计时器，即使它停止后似乎也能工作。代码是：

```
using System;
using System.Windows.Forms;

namespace TestTimer
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
            StartTimer();
        }

        private DateTime deadline;

        private void StartTimer()
        {
            deadline = DateTime.Now.AddSeconds(4);
            timer1.Start();
        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            int secondsRemaining = (deadline - DateTime.Now).Seconds;

            if (secondsRemaining <= 0)
            {
                timer1.Stop();
                timer1.Enabled = false;
                MessageBox.Show("too slow...");
            }
            else
            {
                label1.Text = "Remaining: " + secondsRemaining.ToString() + (secondsRemaining > 1 ? " seconds" : " second");
            }
        }
    }
} 
```

即使在调用 timer1.Stop() 之后，我仍会继续在屏幕上接收 MessageBoxes。当我按 esc 时，它停止了。但是，我预计只会出现一个消息框......我还应该做什么？添加 timer1.Enabled = false 不会改变行为。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-26T11:28:28.993

我可能错了，但 MessageBox.Show() 是阻塞操作（等待您关闭对话框）吗？如果是这样，只需将 Show() 调用移到 Stop/Enabled 行之后？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T12:03:51.827

这里可能有几个因素在起作用。

模态 MessageBox.Show() 可以阻止计时器停止生效，直到它被解除（正如布赖恩指出的那样）。

timer1_Tick 可以在后台线程上执行。UI 调用（例如 MessageBox.Show() 和后台线程不能混合使用。

这两个问题都可以通过使用 BeginInvoke 调用显示消息框的方法来解决。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-07-27T01:07:17.020

请注意，以下内容是不必要的：

```
 timer1.Stop();
            timer1.Enabled = false; 
```

`Stop()`是一样的`Enabled=false`。和`Start()`是一样的`Enabled=true`。

[http://msdn.microsoft.com/en-us/library/system.windows.forms.timer.enabled.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.timer.enabled.aspx)

# xslt - 为什么我不能在 XSL 中获取参数以使用应用模板？

> ID：590157
> 
> 赞同：6
> 
> 时间：2009-02-26T11:31:07.570
> 
> 标签：xslt, parameters

我发现不可能让 with-param 与 apply-templates 一起工作。例如，我已经破解了[w3schools](http://www.w3schools.com/xsl/xsl_apply_templates.asp)中给出的示例。

xsl

```
<xsl:template match="/">
  <xsl:apply-templates>
    <xsl:with-param name="test" select="'has this parameter been passed?'"/>
  </xsl:apply-templates>
</xsl:template>

<xsl:template match="cd">
  <xsl:param name="test"></xsl:param>
  parameter:
  <xsl:value-of select="$test"></xsl:value-of>
</xsl:template> 
```

xml

```
<catalog>
  <cd>
    <title>Empire Burlesque</title>
    <artist>Bob Dylan</artist>
    <country>USA</country>
    <company>Columbia</company>
    <price>10.90</price>
    <year>1985</year>
  </cd>
  <cd>
    <title>Hide your heart</title>
    <artist>Bonnie Tyler</artist>
    <country>UK</country>
    <company>CBS Records</company>
    <price>9.90</price>
    <year>1988</year>
  </cd>
</catalog> 
```

（希望）你会看到 test 参数没有被传递给 cd 模板。我可以在使用调用模板时让它工作，但不是应用模板。这是怎么回事？我正在使用 XSL 1.0。请忽略我正在传递硬编码参数的事实 - 这只是一个示例。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-26T11:50:34.933

嗯......有趣......我在.NET中使用`XslTransform`和失败`XslCompiledTransform`- 但它看起来*应该*工作......好奇......

**更新**问题似乎是**根**匹配；尝试

```
<xsl:template match="/catalog"> <!-- CHANGE HERE --> 
  <xsl:apply-templates>
    <xsl:with-param name="test" select="'has this parameter been passed?'"/>
  </xsl:apply-templates>
</xsl:template> 
```

然后，这对我有用，无需任何其他更改。不同之处在于您匹配的是根节点。当您执行“应用模板”时，它*首先*级联到目录（带有参数），*然后*到 cd（不带参数）。要得到你想要的，你需要从目录开始。您可以通过`<xsl:vaue-of select="name()"/>`在匹配项中添加一个来查看这一点，然后尝试将其作为“/”和“/catalog”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T11:43:42.077

尝试指定要应用的模板：

```
<xsl:template match="/">
  <xsl:apply-templates select="catalog/cd">
    <xsl:with-param name="test" select="'has this parameter been passed?'"/>
  </xsl:apply-templates>
</xsl:template> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-06-09T01:06:19.880

你总是可以使用 xsl:call-template.. 例如：

```
...
<xsl:call-template name="foo">
   <xsl:with-param name="bars" select="42"/>
</xsl:call-template>
...

<xsl:template name="foo">
   <xsl:param name="bars"/>
   <xsl:value-of select="$node"/>
</xsl:template> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T11:45:52.120

[使用http://xmlsoft.org/XSLT/](http://xmlsoft.org/XSLT/)的 libxslt 1.1.24 为我工作 ：

```
$ xsltproc xml1.xsl xml1.xml
<?xml version="1.0"?>

  parameter:
  has this parameter been passed?

  parameter:
  has this parameter been passed? 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-06T08:30:38.217

我看到问题是根目录下的*cd元素不匹配。*在根目录下，您有*目录*元素而不是*cd*元素，因此将模板修改为 match='catalog'

# c# - 如果锁定的对象内部发生异常，它会保持锁定状态吗？

> ID：590159
> 
> 赞同：91
> 
> 时间：2009-02-26T11:31:13.513
> 
> 标签：c#, .net, multithreading, exception, locking

在ac#线程应用程序中，如果我要锁定一个对象，让我们说一个队列，如果发生异常，该对象会保持锁定状态吗？这是伪代码：

```
int ii;
lock(MyQueue)
{
   MyClass LclClass = (MyClass)MyQueue.Dequeue();
   try
   {
      ii = int.parse(LclClass.SomeString);
   }
   catch
   {
     MessageBox.Show("Error parsing string");
   }
} 
```

据我了解，catch 之后的代码不会执行 - 但我一直想知道锁是否会被释放。

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2012-02-27T15:49:59.113

我注意到没有人在他们对这个老问题的回答中提到，在*异常时释放锁是一件非常危险的事情。*是的，C# 中的 lock 语句具有“finally”语义；当控制正常或异常退出锁时，锁被释放。你们都在谈论这是一件好事，但这是一件坏事！如果您有一个引发未处理异常的锁定区域，正确的做法是*在患病进程破坏更多用户数据之前立即终止它*，而不是*释放锁定并继续运行*。

这样看：假设你有一间浴室，门上有锁，外面有一排人等着。浴室里的炸弹爆炸，杀死了里面的人。您的问题是“在这种情况下，锁会自动解锁，以便下一个人可以进入浴室吗？” 是的，它会。 **那不是一件好事。**一颗炸弹刚刚在那里爆炸并杀死了一个人！管道很可能被毁坏了，房子的结构不再健全，而且*里面可能还有另一个炸弹*。正确的做法是*尽快让所有人离开并拆除整个房子。*

我的意思是，仔细考虑一下：如果您锁定了一个代码区域以便从一个数据结构中读取而不在另一个线程上对其进行变异，并且该数据结构中的某些内容引发了异常，*那么很有可能是因为数据结构是腐败的*。用户数据现在混乱了；此时您不想*尝试保存用户数据*，因为您正在保存*损坏*的数据。只需终止该过程。

如果您锁定了一个代码区域以便在没有另一个线程同时读取状态的情况下执行突变，并且突变抛出，那么**如果数据之前没有损坏，那么它肯定是 now**。这正是锁应该*保护*的场景。现在等待读取该状态的代码将*立即*获得对损坏状态的访问权限，并且可能本身会崩溃。同样，正确的做法是终止进程。

无论您如何切片，锁内的异常都是*坏消息*。正确的问题不是“如果发生异常，我的锁会被清理吗？” 要问的正确问题是“我如何确保锁内永远不会出现异常？如果有，那么我如何构建我的程序，以便将突变回滚到以前的良好状态？”

* * *

## 回答 #2

> 赞同：91
> 
> 时间：2009-02-26T11:35:04.220

第一的; 你考虑过 TryParse 吗？

```
in li;
if(int.TryParse(LclClass.SomeString, out li)) {
    // li is now assigned
} else {
    // input string is dodgy
} 
```

锁将被释放有两个原因；首先，`lock`本质上是：

```
Monitor.Enter(lockObj);
try {
  // ...
} finally {
    Monitor.Exit(lockObj);
} 
```

第二; 您捕获并且不重新抛出内部异常，因此`lock`永远不会真正看到异常。当然，您在 MessageBox 的持续时间内持有锁，这可能是个问题。

因此，除了最致命的灾难性不可恢复异常之外，它将在所有情况下都被释放。

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2012-02-27T14:49:25.020

是的，这将正确释放；`lock`充当`try`/ `finally`，`Monitor.Exit(myLock)`在 finally 中，所以无论你如何退出它都会被释放。作为旁注，`catch(... e) {throw e;}`最好避免，因为这会损坏 ; 上的堆栈跟踪`e`。最好根本不要抓住它*，*或者：使用`throw;`而不是`throw e;`重新抛出。

如果您真的想知道，C#4 / .NET 4 中的锁是：

```
{
    bool haveLock = false;
    try {
       Monitor.Enter(myLock, ref haveLock);
    } finally {
       if(haveLock) Monitor.Exit(myLock);
    }
} 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-10-01T08:19:41.300

“锁定语句被编译为对 Monitor.Enter 的调用，然后是 try...finally 块。在 finally 块中，调用 Monitor.Exit。

x86 和 x64 的 JIT 代码生成确保在 Monitor.Enter 调用和紧随其后的 try 块之间不会发生线程中止。”

取自： [本站](http://blogs.microsoft.co.il/blogs/sasha/archive/2009/01/27/why-concurrency-is-hard-or-timedlock-can-get-you-in-trouble.aspx)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-26T11:59:47.687

只是为马克的出色答案添加一点。

`lock`像这样的情况正是关键字存在的原因。它可以帮助开发人员确保锁在`finally`块中被释放。

如果您被迫使用`Monitor.Enter`/`Exit`例如支持超时，您必须确保将调用`Monitor.Exit`放在`finally`块中以确保在发生异常时正确释放锁。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-02-27T14:50:36.367

您的锁将被正确释放。A 的`lock`行为是这样的：

```
try {
    Monitor.Enter(myLock);
    // ...
} finally {
    Monitor.Exit(myLock);
} 
```

并且`finally`无论您如何离开该块，都可以保证执行`try`块。

# c++ - 如何使用 Windows x64 记录堆栈帧

> ID：590160
> 
> 赞同：25
> 
> 时间：2009-02-26T11:32:00.843
> 
> 标签：c++, c, winapi, 64-bit, callstack

我正在使用带有 Win32 的 Stackdumps，将所有返回地址写入我的日志文件。我稍后将这些与映射文件进行匹配（请参阅我的文章 [Post Mortem Debugging][1]）。

**编辑:: 问题已解决 - 请参阅下面我自己的答案。**

在 Windows x64 中，我找不到仅将返回地址写入日志文件的可靠方法。我尝试了几种方法：

**试验一：指针算术：**

```
 CONTEXT Context;
   RtlCaptureContext(&Context);
   char *eNextBP  = (char *)Context.Rdi;
   for(ULONG Frame = 0; eNextBP ; Frame++)
   {        
       char *pBP = eNextBP;
       eNextBP = *(char **)pBP; // Next BP in Stack
       fprintf(LogFile, "*** %2d called from %016LX  (pBP at %016LX)\n", Frame, 
              (ULONG64)*(char **)(pBP + 8), (ULONG64)pBP);

    } 
```

这在调试版本中工作正常 - 但它在发布版本中崩溃。Context.Rdi 的值在那里没有可用的值。我确实检查了编译器设置的差异（visual Studio 2005）。我没有发现任何可疑之处。

**试用 2：使用 StackWalk64**

```
RtlCaptureContext(&Context);
STACKFRAME64 stk;
memset(&stk, 0, sizeof(stk));

stk.AddrPC.Offset       = Context.Rip;
stk.AddrPC.Mode         = AddrModeFlat;
stk.AddrStack.Offset    = Context.Rsp;
stk.AddrStack.Mode      = AddrModeFlat;
stk.AddrFrame.Offset    = Context.Rbp;
stk.AddrFrame.Mode      = AddrModeFlat;

for(ULONG Frame = 0; ; Frame++)
{
    BOOL result = StackWalk64(
                            IMAGE_FILE_MACHINE_AMD64,   // __in      DWORD MachineType,
                            GetCurrentProcess(),        // __in      HANDLE hProcess,
                            GetCurrentThread(),         // __in      HANDLE hThread,
                            &stk,                       // __inout   LP STACKFRAME64 StackFrame,
                            &Context,                  // __inout   PVOID ContextRecord,
                             NULL,                     // __in_opt  PREAD_PROCESS_MEMORY_ROUTINE64 ReadMemoryRoutine,
                             SymFunctionTableAccess64,                      // __in_opt  PFUNCTION_TABLE_ACCESS_ROUTINE64 FunctionTableAccessRoutine,
                             SymGetModuleBase64,                     // __in_opt  PGET_MODULE_BASE_ROUTINE64 GetModuleBaseRoutine,
                             NULL                       // __in_opt  PTRANSLATE_ADDRESS_ROUTINE64 TranslateAddress
                             );

    fprintf(gApplSetup.TraceFile, "*** %2d called from %016LX   STACK %016LX    FRAME %016LX\n", Frame, (ULONG64)stk.AddrPC.Offset, (ULONG64)stk.AddrStack.Offset, (ULONG64)stk.AddrFrame.Offset);
    if(! result)
        break;
} 
```

这不仅会转储返回地址，还会转储整个堆栈。我使用这种方法在我的日志文件中收到了大约 1000 行。我可以使用它，但是我必须通过行搜索，并且堆栈的一些数据恰好是有效的代码地址。

**试验 3：使用回溯**

```
static USHORT (WINAPI
*s_pfnCaptureStackBackTrace)(ULONG, ULONG, PVOID*, PULONG) = 0;  
    if (s_pfnCaptureStackBackTrace == 0)  
    {  
        const HMODULE hNtDll = ::GetModuleHandle("ntdll.dll");  
        reinterpret_cast<void*&>(s_pfnCaptureStackBackTrace)
=  ::GetProcAddress(hNtDll, "RtlCaptureStackBackTrace");  
    }  
    PVOID myFrames[128];
    s_pfnCaptureStackBackTrace(0, 128, myFrames, NULL);

    for(int ndx = 0; ndx < 128; ndx++)
        fprintf(gApplSetup.TraceFile, "*** BackTrace %3d %016LX\n", ndx,  (ULONG64)myFrames[ndx]); 
```

导致没有可用的信息。

有没有人在 x64 中实现了这样的堆栈遍历，它只写出堆栈中的返回地址？我见过 [StackTrace64][2]、[StackWalker][3] 和其他方法。它们要么不编译，要么过于复杂。这基本上是一个简单的任务！

**示例 StackDump64.cpp**

```
#include <Windows.h>
#include <DbgHelp.h>
#include <Winbase.h>

#include <stdio.h>

void WriteStackDump()

{

    FILE *myFile = fopen("StackDump64.log", "w+t");

    CONTEXT                       Context;
    memset(&Context, 0, sizeof(Context));
    RtlCaptureContext(&Context);

    RtlCaptureContext(&Context);
    STACKFRAME64 stk;
    memset(&stk, 0, sizeof(stk));

    stk.AddrPC.Offset       = Context.Rip;
    stk.AddrPC.Mode         = AddrModeFlat;
    stk.AddrStack.Offset    = Context.Rsp;
    stk.AddrStack.Mode      = AddrModeFlat;
    stk.AddrFrame.Offset    = Context.Rbp;
    stk.AddrFrame.Mode      = AddrModeFlat;

    for(ULONG Frame = 0; ; Frame++)
    {
        BOOL result = StackWalk64(
                                IMAGE_FILE_MACHINE_AMD64,   // __in      DWORD MachineType,
                                GetCurrentProcess(),        // __in      HANDLE hProcess,
                                GetCurrentThread(),         // __in      HANDLE hThread,
                                &stk,                       // __inout   LP STACKFRAME64 StackFrame,
                                &Context,                  // __inout   PVOID ContextRecord,
                                 NULL,                     // __in_opt  PREAD_PROCESS_MEMORY_ROUTINE64 ReadMemoryRoutine,
                                 SymFunctionTableAccess64,                      // __in_opt  PFUNCTION_TABLE_ACCESS_ROUTINE64 FunctionTableAccessRoutine,
                                 SymGetModuleBase64,                     // __in_opt  PGET_MODULE_BASE_ROUTINE64 GetModuleBaseRoutine,
                                 NULL                       // __in_opt  PTRANSLATE_ADDRESS_ROUTINE64 TranslateAddress
                                 );

        fprintf(myFile, "*** %2d called from %016I64LX   STACK %016I64LX    AddrReturn %016I64LX\n", Frame, stk.AddrPC.Offset, stk.AddrStack.Offset, stk.AddrReturn.Offset);
        if(! result)
            break;
    }

    fclose(myFile);
}

void funcC()
{
    WriteStackDump();
}

void funcB()
{
    funcC();
}

void funcA()

{
    funcB();
}

int main(int argc, char *argv[])

{

    funcA();
} 
```

运行此示例会产生以下日志文​​件内容：

```
***  0 called from 000000014000109E   STACK 000000000012F780    AddrReturn 0000000140005798
***  1 called from 000000001033D160   STACK 000000000012F788    AddrReturn 00000001400057B0
***  2 called from 00000001400057B0   STACK 000000000012F790    AddrReturn 0000000000000001
***  3 called from 0000000000000002   STACK 000000000012F798    AddrReturn 00000001400057B0
***  4 called from 0000000000000002   STACK 000000000012F7A0    AddrReturn 000000000012F7F0
***  5 called from 000000000012F7F0   STACK 000000000012F7A8    AddrReturn 0000000000000000
***  6 called from 0000000000000000   STACK 000000000012F7B0    AddrReturn 000007FF7250CF40
***  7 called from 000007FF7250CF40   STACK 000000000012F7B8    AddrReturn 000007FF7250D390
***  8 called from 000007FF7250D390   STACK 000000000012F7C0    AddrReturn 000007FF725B6950
***  9 called from 000007FF725B6950   STACK 000000000012F7C8    AddrReturn CCCCCCCCCCCCCCCC
*** 10 called from CCCCCCCCCCCCCCCC   STACK 000000000012F7D0    AddrReturn 000000001033D160
*** 11 called from 000000001033D160   STACK 000000000012F7D8    AddrReturn CCCCCCCCCCCCCCCC
*** 12 called from CCCCCCCCCCCCCCCC   STACK 000000000012F7E0    AddrReturn CCCCCCCCCCCCCCCC
*** 13 called from CCCCCCCCCCCCCCCC   STACK 000000000012F7E8    AddrReturn CCCCCCCCCCCCCCCC
*** 14 called from CCCCCCCCCCCCCCCC   STACK 000000000012F7F0    AddrReturn 0000000000000000
*** 15 called from 0000000000000000   STACK 000000000012F7F8    AddrReturn 0000000000000000
*** 16 called from 0000000000000000   STACK 000000000012F800    AddrReturn 0000000000000000
*** 17 called from 0000000000000000   STACK 000000000012F808    AddrReturn 0000000000000000
*** 18 called from 0000000000000000   STACK 000000000012F810    AddrReturn 0000000000000000
*** 19 called from 0000000000000000   STACK 000000000012F818    AddrReturn 0000000000000000
*** 20 called from 0000000000000000   STACK 000000000012F820    AddrReturn 00001F800010000F
*** 21 called from 00001F800010000F   STACK 000000000012F828    AddrReturn 0053002B002B0033
*** 22 called from 0053002B002B0033   STACK 000000000012F830    AddrReturn 00000206002B002B
*** 23 called from 00000206002B002B   STACK 000000000012F838    AddrReturn 0000000000000000
*** 24 called from 0000000000000000   STACK 000000000012F840    AddrReturn 0000000000000000
*** 25 called from 0000000000000000   STACK 000000000012F848    AddrReturn 0000000000000000
*** 26 called from 0000000000000000   STACK 000000000012F850    AddrReturn 0000000000000000
*** 27 called from 0000000000000000   STACK 000000000012F858    AddrReturn 0000000000000000
*** 28 called from 0000000000000000   STACK 000000000012F860    AddrReturn 0000000000000000
*** 29 called from 0000000000000000   STACK 000000000012F868    AddrReturn 0000000000000246
*** 30 called from 0000000000000246   STACK 000000000012F870    AddrReturn 000000000012F7F0
*** 31 called from 000000000012F7F0   STACK 000000000012F878    AddrReturn 0000000000000000
*** 32 called from 0000000000000000   STACK 000000000012F880    AddrReturn 0000000000000000
*** 33 called from 0000000000000000   STACK 000000000012F888    AddrReturn 000000000012F888
*** 34 called from 000000000012F888   STACK 000000000012F890    AddrReturn 0000000000000000
*** 35 called from 0000000000000000   STACK 000000000012F898    AddrReturn 0000000000000000
*** 36 called from 0000000000000000   STACK 000000000012F8A0    AddrReturn 000000000012FE10
*** 37 called from 000000000012FE10   STACK 000000000012F8A8    AddrReturn 0000000000000000
*** 38 called from 0000000000000000   STACK 000000000012F8B0    AddrReturn 0000000000000000
*** 39 called from 0000000000000000   STACK 000000000012F8B8    AddrReturn 0000000000000000
*** 40 called from 0000000000000000   STACK 000000000012F8C0    AddrReturn 0000000000000246
*** 41 called from 0000000000000246   STACK 000000000012F8C8    AddrReturn 0000000000000000
*** 42 called from 0000000000000000   STACK 000000000012F8D0    AddrReturn 0000000000000000
*** 43 called from 0000000000000000   STACK 000000000012F8D8    AddrReturn 0000000000000000
*** 44 called from 0000000000000000   STACK 000000000012F8E0    AddrReturn 0000000000000000
*** 45 called from 0000000000000000   STACK 000000000012F8E8    AddrReturn 0000000000000000
*** 46 called from 0000000000000000   STACK 000000000012F8F0    AddrReturn 000000000000027F
*** 47 called from 000000000000027F   STACK 000000000012F8F8    AddrReturn 0000000000000000
*** 48 called from 0000000000000000   STACK 000000000012F900    AddrReturn 0000000000000000
*** 49 called from 0000000000000000   STACK 000000000012F908    AddrReturn 0000FFFF00001F80
*** 50 called from 0000FFFF00001F80   STACK 000000000012F910    AddrReturn 0000000000000000
*** 51 called from 0000000000000000   STACK 000000000012F918    AddrReturn 0000000000000000
*** 52 called from 0000000000000000   STACK 000000000012F920    AddrReturn 0000000000000000
*** 53 called from 0000000000000000   STACK 000000000012F928    AddrReturn 0000000000000000
*** 54 called from 0000000000000000   STACK 000000000012F930    AddrReturn 0000000000000000
*** 55 called from 0000000000000000   STACK 000000000012F938    AddrReturn 0000000000000000
*** 56 called from 0000000000000000   STACK 000000000012F940    AddrReturn 0000000000000000
*** 57 called from 0000000000000000   STACK 000000000012F948    AddrReturn 0000000000000000
*** 58 called from 0000000000000000   STACK 000000000012F950    AddrReturn 0000000000000000
*** 59 called from 0000000000000000   STACK 000000000012F958    AddrReturn 0000000000000000
*** 60 called from 0000000000000000   STACK 000000000012F960    AddrReturn 0000000000000000
*** 61 called from 0000000000000000   STACK 000000000012F968    AddrReturn 0000000000000000
*** 62 called from 0000000000000000   STACK 000000000012F970    AddrReturn 0000000000000000
*** 63 called from 0000000000000000   STACK 000000000012F978    AddrReturn 0000000000000000
*** 64 called from 0000000000000000   STACK 000000000012F980    AddrReturn 0000000000000000
*** 65 called from 0000000000000000   STACK 000000000012F988    AddrReturn 0000000000000000
*** 66 called from 0000000000000000   STACK 000000000012F990    AddrReturn 0000000000000000
*** 67 called from 0000000000000000   STACK 000000000012F998    AddrReturn 0000000000000000
*** 68 called from 0000000000000000   STACK 000000000012F9A0    AddrReturn 0000000000000000
*** 69 called from 0000000000000000   STACK 000000000012F9A8    AddrReturn 0000000000000000
*** 70 called from 0000000000000000   STACK 000000000012F9B0    AddrReturn 0000000000000000
*** 71 called from 0000000000000000   STACK 000000000012F9B8    AddrReturn 0000000000000000
*** 72 called from 0000000000000000   STACK 000000000012F9C0    AddrReturn 0000000000000000
*** 73 called from 0000000000000000   STACK 000000000012F9C8    AddrReturn 0000000000000000
*** 74 called from 0000000000000000   STACK 000000000012F9D0    AddrReturn 0000000000000000
*** 75 called from 0000000000000000   STACK 000000000012F9D8    AddrReturn 0000000000000000
*** 76 called from 0000000000000000   STACK 000000000012F9E0    AddrReturn 0000000000000000
*** 77 called from 0000000000000000   STACK 000000000012F9E8    AddrReturn 0000000000000000
*** 78 called from 0000000000000000   STACK 000000000012F9F0    AddrReturn 0000000000000000
*** 79 called from 0000000000000000   STACK 000000000012F9F8    AddrReturn 0000000000000000
*** 80 called from 0000000000000000   STACK 000000000012FA00    AddrReturn 0000000000000000
*** 81 called from 0000000000000000   STACK 000000000012FA08    AddrReturn 0000000000000000
*** 82 called from 0000000000000000   STACK 000000000012FA10    AddrReturn 0000000000000000
*** 83 called from 0000000000000000   STACK 000000000012FA18    AddrReturn 0000000000000000
*** 84 called from 0000000000000000   STACK 000000000012FA20    AddrReturn 0000000000000000
*** 85 called from 0000000000000000   STACK 000000000012FA28    AddrReturn 0000000000000000
*** 86 called from 0000000000000000   STACK 000000000012FA30    AddrReturn 0000000000000000
*** 87 called from 0000000000000000   STACK 000000000012FA38    AddrReturn 0000000000000000
*** 88 called from 0000000000000000   STACK 000000000012FA40    AddrReturn 0000000000000000
*** 89 called from 0000000000000000   STACK 000000000012FA48    AddrReturn 0000000000000000
*** 90 called from 0000000000000000   STACK 000000000012FA50    AddrReturn 0000000000000000
*** 91 called from 0000000000000000   STACK 000000000012FA58    AddrReturn 0000000000000000
*** 92 called from 0000000000000000   STACK 000000000012FA60    AddrReturn 0000000000000000
*** 93 called from 0000000000000000   STACK 000000000012FA68    AddrReturn 0000000000000000
*** 94 called from 0000000000000000   STACK 000000000012FA70    AddrReturn 0000000000000000
*** 95 called from 0000000000000000   STACK 000000000012FA78    AddrReturn 0000000000000000
*** 96 called from 0000000000000000   STACK 000000000012FA80    AddrReturn 0000000000000000
*** 97 called from 0000000000000000   STACK 000000000012FA88    AddrReturn 0000000000000000
*** 98 called from 0000000000000000   STACK 000000000012FA90    AddrReturn 0000000000000000
*** 99 called from 0000000000000000   STACK 000000000012FA98    AddrReturn 0000000000000000
*** 100 called from 0000000000000000   STACK 000000000012FAA0    AddrReturn 0000000000000000
*** 101 called from 0000000000000000   STACK 000000000012FAA8    AddrReturn 0000000000000000
*** 102 called from 0000000000000000   STACK 000000000012FAB0    AddrReturn 0000000000000000
*** 103 called from 0000000000000000   STACK 000000000012FAB8    AddrReturn 0000000000000000
*** 104 called from 0000000000000000   STACK 000000000012FAC0    AddrReturn 0000000000000000
*** 105 called from 0000000000000000   STACK 000000000012FAC8    AddrReturn 0000000000000000
*** 106 called from 0000000000000000   STACK 000000000012FAD0    AddrReturn 0000000000000000
*** 107 called from 0000000000000000   STACK 000000000012FAD8    AddrReturn 0000000000000000
*** 108 called from 0000000000000000   STACK 000000000012FAE0    AddrReturn 0000000000000000
*** 109 called from 0000000000000000   STACK 000000000012FAE8    AddrReturn 0000000000000000
*** 110 called from 0000000000000000   STACK 000000000012FAF0    AddrReturn 0000000000000000
*** 111 called from 0000000000000000   STACK 000000000012FAF8    AddrReturn 0000000000000000
*** 112 called from 0000000000000000   STACK 000000000012FB00    AddrReturn 0000000000000000
*** 113 called from 0000000000000000   STACK 000000000012FB08    AddrReturn 0000000000000000
*** 114 called from 0000000000000000   STACK 000000000012FB10    AddrReturn 0000000000000000
*** 115 called from 0000000000000000   STACK 000000000012FB18    AddrReturn 0000000000000000
*** 116 called from 0000000000000000   STACK 000000000012FB20    AddrReturn 0000000000000000
*** 117 called from 0000000000000000   STACK 000000000012FB28    AddrReturn 0000000000000000
*** 118 called from 0000000000000000   STACK 000000000012FB30    AddrReturn 0000000000000000
*** 119 called from 0000000000000000   STACK 000000000012FB38    AddrReturn 0000000000000000
*** 120 called from 0000000000000000   STACK 000000000012FB40    AddrReturn 0000000000000000
*** 121 called from 0000000000000000   STACK 000000000012FB48    AddrReturn 0000000000000000
*** 122 called from 0000000000000000   STACK 000000000012FB50    AddrReturn 0000000000000000
*** 123 called from 0000000000000000   STACK 000000000012FB58    AddrReturn 0000000000000000
*** 124 called from 0000000000000000   STACK 000000000012FB60    AddrReturn 0000000000000000
*** 125 called from 0000000000000000   STACK 000000000012FB68    AddrReturn 0000000000000000
*** 126 called from 0000000000000000   STACK 000000000012FB70    AddrReturn 0000000000000000
*** 127 called from 0000000000000000   STACK 000000000012FB78    AddrReturn 0000000000000000
*** 128 called from 0000000000000000   STACK 000000000012FB80    AddrReturn 0000000000000000
*** 129 called from 0000000000000000   STACK 000000000012FB88    AddrReturn 0000000000000000
*** 130 called from 0000000000000000   STACK 000000000012FB90    AddrReturn 0000000000000000
*** 131 called from 0000000000000000   STACK 000000000012FB98    AddrReturn 0000000000000000
*** 132 called from 0000000000000000   STACK 000000000012FBA0    AddrReturn 0000000000000000
*** 133 called from 0000000000000000   STACK 000000000012FBA8    AddrReturn 0000000000000000
*** 134 called from 0000000000000000   STACK 000000000012FBB0    AddrReturn 0000000000000000
*** 135 called from 0000000000000000   STACK 000000000012FBB8    AddrReturn 0000000000000000
*** 136 called from 0000000000000000   STACK 000000000012FBC0    AddrReturn 0000000000000000
*** 137 called from 0000000000000000   STACK 000000000012FBC8    AddrReturn 0000000000000000
*** 138 called from 0000000000000000   STACK 000000000012FBD0    AddrReturn 0000000000000000
*** 139 called from 0000000000000000   STACK 000000000012FBD8    AddrReturn 0000000000000000
*** 140 called from 0000000000000000   STACK 000000000012FBE0    AddrReturn 0000000000000000
*** 141 called from 0000000000000000   STACK 000000000012FBE8    AddrReturn 0000000000000000
*** 142 called from 0000000000000000   STACK 000000000012FBF0    AddrReturn 0000000000000000
*** 143 called from 0000000000000000   STACK 000000000012FBF8    AddrReturn 0000000000000000
*** 144 called from 0000000000000000   STACK 000000000012FC00    AddrReturn 0000000000000000
*** 145 called from 0000000000000000   STACK 000000000012FC08    AddrReturn 0000000000000000
*** 146 called from 0000000000000000   STACK 000000000012FC10    AddrReturn 0000000000000000
*** 147 called from 0000000000000000   STACK 000000000012FC18    AddrReturn 0000000000000000
*** 148 called from 0000000000000000   STACK 000000000012FC20    AddrReturn 0000000000000000
*** 149 called from 0000000000000000   STACK 000000000012FC28    AddrReturn 0000000000000000
*** 150 called from 0000000000000000   STACK 000000000012FC30    AddrReturn 0000000000000000
*** 151 called from 0000000000000000   STACK 000000000012FC38    AddrReturn 0000000000000000
*** 152 called from 0000000000000000   STACK 000000000012FC40    AddrReturn 0000000000000000
*** 153 called from 0000000000000000   STACK 000000000012FC48    AddrReturn 0000000000000000
*** 154 called from 0000000000000000   STACK 000000000012FC50    AddrReturn 0000000000000000
*** 155 called from 0000000000000000   STACK 000000000012FC58    AddrReturn 0000000000000000
*** 156 called from 0000000000000000   STACK 000000000012FC60    AddrReturn 0000000000000000
*** 157 called from 0000000000000000   STACK 000000000012FC68    AddrReturn 0000000000000000
*** 158 called from 0000000000000000   STACK 000000000012FC70    AddrReturn 0000000000000000
*** 159 called from 0000000000000000   STACK 000000000012FC78    AddrReturn 0000000000000000
*** 160 called from 0000000000000000   STACK 000000000012FC80    AddrReturn 0000000000000000
*** 161 called from 0000000000000000   STACK 000000000012FC88    AddrReturn 0000000000000000
*** 162 called from 0000000000000000   STACK 000000000012FC90    AddrReturn 0000000000000000
*** 163 called from 0000000000000000   STACK 000000000012FC98    AddrReturn 0000000000000000
*** 164 called from 0000000000000000   STACK 000000000012FCA0    AddrReturn 0000000000000000
*** 165 called from 0000000000000000   STACK 000000000012FCA8    AddrReturn 0000000000000000
*** 166 called from 0000000000000000   STACK 000000000012FCB0    AddrReturn 0000000000000000
*** 167 called from 0000000000000000   STACK 000000000012FCB8    AddrReturn 0000000000000000
*** 168 called from 0000000000000000   STACK 000000000012FCC0    AddrReturn CCCCCCCCCCCCCCCC
*** 169 called from CCCCCCCCCCCCCCCC   STACK 000000000012FCC8    AddrReturn CCCCCCCCCCCCCCCC
*** 170 called from CCCCCCCCCCCCCCCC   STACK 000000000012FCD0    AddrReturn CCCCCCCCCCCCCCCC
*** 171 called from CCCCCCCCCCCCCCCC   STACK 000000000012FCD8    AddrReturn CCCCCCCCCCCCCCCC
*** 172 called from CCCCCCCCCCCCCCCC   STACK 000000000012FCE0    AddrReturn CCCCCCCCCCCCCCCC
*** 173 called from CCCCCCCCCCCCCCCC   STACK 000000000012FCE8    AddrReturn 0000000300000000
*** 174 called from 0000000300000000   STACK 000000000012FCF0    AddrReturn 0000000300000000
*** 175 called from 0000000300000000   STACK 000000000012FCF8    AddrReturn 0000000300000000
*** 176 called from 0000000300000000   STACK 000000000012FD00    AddrReturn 000000000012FCF0
*** 177 called from 000000000012FCF8   STACK 000000000012FD08    AddrReturn 0000000300000000
*** 178 called from 0000000300000000   STACK 000000000012FD10    AddrReturn 000000000012FD10
*** 179 called from 000000000012FD18   STACK 000000000012FD18    AddrReturn 0000000300000000
*** 180 called from 0000000300000000   STACK 000000000012FD20    AddrReturn 0000000000000000
*** 181 called from 0000000000000000   STACK 000000000012FD28    AddrReturn 0000000000000000
*** 182 called from 0000000000000000   STACK 000000000012FD30    AddrReturn 0000000000000000
*** 183 called from 0000000000000000   STACK 000000000012FD38    AddrReturn 0000000000000000
*** 184 called from 0000000000000000   STACK 000000000012FD40    AddrReturn 0000000000000000
*** 185 called from 0000000100000000   STACK 000000000012FD48    AddrReturn 0000000100000000
*** 186 called from 0000000000000000   STACK 000000000012FD50    AddrReturn 0000000000000000
*** 187 called from 0000000000000000   STACK 000000000012FD58    AddrReturn 0000000100000000
*** 188 called from 0000000100000000   STACK 000000000012FD60    AddrReturn 0000000000000000
*** 189 called from 0000000000000000   STACK 000000000012FD68    AddrReturn 0000000000000000
*** 190 called from 0000000000000000   STACK 000000000012FD70    AddrReturn 0000000000000000
*** 191 called from 0000000000000000   STACK 000000000012FD78    AddrReturn 0000000000000000
*** 192 called from 0000000000000000   STACK 000000000012FD80    AddrReturn 0000000000000000
*** 193 called from 0000000000000000   STACK 000000000012FD88    AddrReturn 0000000000000000
*** 194 called from 0000000000000000   STACK 000000000012FD90    AddrReturn 0000000000000000
*** 195 called from 0000000000000000   STACK 000000000012FD98    AddrReturn 0000000000000000
*** 196 called from 0000000000000000   STACK 000000000012FDA0    AddrReturn 0000000000000000
*** 197 called from 0000000000000000   STACK 000000000012FDA8    AddrReturn 0000000000000000
*** 198 called from 0000000000000000   STACK 000000000012FDB0    AddrReturn 0000000000000000
*** 199 called from 0000000000000000   STACK 000000000012FDB8    AddrReturn 0000000000000000
*** 200 called from 0000000000000000   STACK 000000000012FDC0    AddrReturn 0000000000000000
*** 201 called from 0000000000000000   STACK 000000000012FDC8    AddrReturn 0000000000000000
*** 202 called from 0000000000000000   STACK 000000000012FDD0    AddrReturn 0000000000000000
*** 203 called from 0000000000000000   STACK 000000000012FDD8    AddrReturn 0000000000000000
*** 204 called from 0000000000000000   STACK 000000000012FDE0    AddrReturn 0000000000000000
*** 205 called from 0000000000000000   STACK 000000000012FDE8    AddrReturn CCCCCCCCCCCCCCCC
*** 206 called from CCCCCCCCCCCCCCCC   STACK 000000000012FDF0    AddrReturn 000000CECCCCCCCC
*** 207 called from 000000CFCCCCCCCC   STACK 000000000012FDF8    AddrReturn CCCCCCCC00000001
*** 208 called from CCCCCCCC00000001   STACK 000000000012FE00    AddrReturn FFFFFFFFFFFFFFFE
*** 209 called from FFFFFFFFFFFFFFFE   STACK 000000000012FE08    AddrReturn CCCCCCCCCCCCCCCC
*** 210 called from CCCCCCCCCCCCCCCC   STACK 000000000012FE10    AddrReturn 000000000012FE40
*** 211 called from 000000000012FE40   STACK 000000000012FE18    AddrReturn 000000014000122F
*** 212 called from 000000014000122F   STACK 000000000012FE20    AddrReturn CCCCCCCCCCCCCCCC
*** 213 called from CCCCCCCCCCCCCCCC   STACK 000000000012FE28    AddrReturn CCCCCCCCCCCCCCCC
*** 214 called from CCCCCCCCCCCCCCCC   STACK 000000000012FE30    AddrReturn CCCCCCCCCCCCCCCC
*** 215 called from CCCCCCCCCCCCCCCC   STACK 000000000012FE38    AddrReturn CCCCCCCCCCCCCCCC
*** 216 called from CCCCCCCCCCCCCCCC   STACK 000000000012FE40    AddrReturn 000000000012FE70
*** 217 called from 000000000012FE70   STACK 000000000012FE48    AddrReturn 000000014000125F
*** 218 called from 000000014000125F   STACK 000000000012FE50    AddrReturn CCCCCCCCCCCCCCCC
*** 219 called from CCCCCCCCCCCCCCCC   STACK 000000000012FE58    AddrReturn CCCCCCCCCCCCCCCC
*** 220 called from CCCCCCCCCCCCCCCC   STACK 000000000012FE60    AddrReturn CCCCCCCCCCCCCCCC
*** 221 called from CCCCCCCCCCCCCCCC   STACK 000000000012FE68    AddrReturn CCCCCCCCCCCCCCCC
*** 222 called from CCCCCCCCCCCCCCCC   STACK 000000000012FE70    AddrReturn 000000000012FEA0
*** 223 called from 000000000012FEA0   STACK 000000000012FE78    AddrReturn 000000014000128F
*** 224 called from 000000014000128F   STACK 000000000012FE80    AddrReturn CCCCCCCCCCCCCCCC
*** 225 called from CCCCCCCCCCCCCCCC   STACK 000000000012FE88    AddrReturn CCCCCCCCCCCCCCCC
*** 226 called from CCCCCCCCCCCCCCCC   STACK 000000000012FE90    AddrReturn CCCCCCCCCCCCCCCC
*** 227 called from CCCCCCCCCCCCCCCC   STACK 000000000012FE98    AddrReturn CCCCCCCCCCCCCCCC
*** 228 called from CCCCCCCCCCCCCCCC   STACK 000000000012FEA0    AddrReturn 000000000012FED0
*** 229 called from 000000000012FED0   STACK 000000000012FEA8    AddrReturn 00000001400012CB
*** 230 called from 00000001400012CB   STACK 000000000012FEB0    AddrReturn CCCCCCCCCCCCCCCC
*** 231 called from CCCCCCCCCCCCCCCC   STACK 000000000012FEB8    AddrReturn CCCCCCCCCCCCCCCC
*** 232 called from CCCCCCCCCCCCCCCC   STACK 000000000012FEC0    AddrReturn CCCCCCCCCCCCCCCC
*** 233 called from CCCCCCCCCCCCCCCC   STACK 000000000012FEC8    AddrReturn CCCCCCCCCCCCCCCC
*** 234 called from CCCCCCCCCCCCCCCC   STACK 000000000012FED0    AddrReturn 0000000000000000
*** 235 called from 0000000000000000   STACK 000000000012FED8    AddrReturn 000000014000190C
*** 236 called from 000000014000190C   STACK 000000000012FEE0    AddrReturn 0000000100000001
*** 237 called from 0000000100000001   STACK 000000000012FEE8    AddrReturn 0000000000454B50
*** 238 called from 0000000000454B50   STACK 000000000012FEF0    AddrReturn 0000000000000000
*** 23 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-08-26T13:12:28.687

我终于找到了一种使用 Windows 函数在 x64 中记录堆栈帧的可靠方法`CaptureStackBackTrace()`。由于我不想更新我的 SDK，我通过调用它`GetProcAddress(LoadLibrary());`

```
 typedef USHORT (WINAPI *CaptureStackBackTraceType)(__in ULONG, __in ULONG, __out PVOID*, __out_opt PULONG);
   CaptureStackBackTraceType func = (CaptureStackBackTraceType)(GetProcAddress(LoadLibrary("kernel32.dll"), "RtlCaptureStackBackTrace"));

   if(func == NULL)
       return; // WOE 29.SEP.2010

   // Quote from Microsoft Documentation:
   // ## Windows Server 2003 and Windows XP:  
   // ## The sum of the FramesToSkip and FramesToCapture parameters must be less than 63.
   const int kMaxCallers = 62; 

   void* callers[kMaxCallers];
   int count = (func)(0, kMaxCallers, callers, NULL);
   for(i = 0; i < count; i++)
      printf(TraceFile, "*** %d called from %016I64LX\n", i, callers[i]); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-07-28T13:33:13.883

对于 vs2008 x64：基于[https://msdn.microsoft.com/en-us/library/windows/desktop/bb204633%28v=vs.85%29.aspx](https://msdn.microsoft.com/en-us/library/windows/desktop/bb204633%28v=vs.85%29.aspx)和 RED SOFT ADAIR：

```
#if defined DEBUG_SAMPLES_MANAGEMENT  

#include "DbgHelp.h"
#include <WinBase.h>
#pragma comment(lib, "Dbghelp.lib")

void printStack( void* sample_address, std::fstream& out )
{
    typedef USHORT (WINAPI *CaptureStackBackTraceType)(__in ULONG, __in ULONG, __out PVOID*, __out_opt PULONG);
    CaptureStackBackTraceType func = (CaptureStackBackTraceType)(GetProcAddress(LoadLibrary(L"kernel32.dll"), "RtlCaptureStackBackTrace"));

    if(func == NULL)
        return; // WOE 29.SEP.2010

    // Quote from Microsoft Documentation:
    // ## Windows Server 2003 and Windows XP:  
    // ## The sum of the FramesToSkip and FramesToCapture parameters must be less than 63.
    const int kMaxCallers = 62; 

    void         * callers_stack[ kMaxCallers ];
    unsigned short frames;
    SYMBOL_INFO  * symbol;
    HANDLE         process;
    process = GetCurrentProcess();
    SymInitialize( process, NULL, TRUE );
    frames               = (func)( 0, kMaxCallers, callers_stack, NULL );
    symbol               = ( SYMBOL_INFO * )calloc( sizeof( SYMBOL_INFO ) + 256 * sizeof( char ), 1 );
    symbol->MaxNameLen   = 255;
    symbol->SizeOfStruct = sizeof( SYMBOL_INFO );

    out << "(" << sample_address << "): " << std::endl;
    const unsigned short  MAX_CALLERS_SHOWN = 6;
    frames = frames < MAX_CALLERS_SHOWN? frames : MAX_CALLERS_SHOWN;
    for( unsigned int i = 0;  i < frames;  i++ )
    {
        SymFromAddr( process, ( DWORD64 )( callers_stack[ i ] ), 0, symbol );
        out << "*** " << i << ": " << callers_stack[i] << " " << symbol->Name << " - 0x" << symbol->Address << std::endl;
    }

    free( symbol );
}
#endif 
```

在这里调用：

```
#if defined DEBUG_SAMPLES_MANAGEMENT
        if(owner_ != 0)
        {   
            std::fstream& out = owner_->get_debug_file();
            printStack( this, out );   
        }
#endif 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T17:30:57.720

我们在这里专门使用小型转储。您可以生成一个仅包含堆栈信息的精简版，并稍后从一个体面的调试器中转储出堆栈跟踪。

它不能直接解决您的问题，但我认为它将为您提供更好的事后报告机制。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-10-21T14:04:59.913

在试用 3 中，您可能错误地使用 CaptureStackBackTrace()。根据文档，在 Windows XP 和 Windows Server 2003 上，第一个和第二个参数的总和必须小于 63，但在您的情况下，总和为 128。

[http://msdn.microsoft.com/en-us/library/windows/desktop/bb204633%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/bb204633%28v=vs.85%29.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T11:59:27.330

`StackWalk64`诀窍是在返回 0 时停止调用`stk.AddrReturn.Offset`。这意味着堆栈上没有更多的帧。如果`stk.AddrReturn.Offset`非零，您可以使用该值作为返回地址。

如果您`StackWalk64`在此之后继续调用，我的猜测是它会尝试将内存位置中的任何内容解释为堆栈并返回不可预测的数据。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-26T12:16:45.273

看这个，我不知道它是否相关：
...
使用汇编代码 汇编代码可以直接移植到 AMD64 和 64 位 Windows 上——出于性能原因，值得付出努力！例如，您可以利用新的 64 位通用寄存器 (r8-r15)，以及新的浮点和 128 位 SSE/SSE2/浮点寄存器 (xmm8-xmm15)。但是，您应该在 ABI（应用程序二进制接口）规范中[了解新的 64 位堆栈帧和调用约定。](http://developer.amd.com/pages/11112003167.aspx)
...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-27T13:23:42.720

StackWalk64 是正确的选择，第一次调用会给你调用者的地址。

你的问题可能是在发布时你有很多内联。返回地址可能不是您所期望的。

编辑：您只需要设置 AddrPC 和 AddrFrame。只需确保您的 rbp 和 rip 是与您的被调用者上下文相对应的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-08T12:57:25.577

关于第一个问题：在发行版中禁用“省略堆栈帧”，“琐碎”的堆栈跟踪代码将起作用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-07-02T12:32:44.640

关于 RtlCaptureStackBackTrace，我在 32 位 Windows 上注意到的一件事是，如果为 FramesToCapture 传递了太大的数字，它会失败。实验上，我已经确定 61 为最大值，我无法理解！

不确定它在 x64 中是否相同，但这可以解释为什么你没有得到任何信息。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-04-01T14:35:45.010

反汇编 RtlCaptureStackBackTrace() 我注意到传递给 RtlCaptureStackBackTrace() 的最大值应该是：framesToSkip+framesToCapture+1 应该小于 64。否则返回 0 并且没有其他错误代码。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-07-05T13:32:23.957

使用`StackWalk64`时，无论是否存在有效数据，您都在遍历线程的整个堆栈。一旦返回地址为 0，您应该终止步行，如下所示：

```
for (ULONG Frame = 0; ; Frame++)
{
  if (FALSE == StackWalk64(...))
  {
    printf("Stack walk failed!\n");
    break;
  }  

  if (stackFrame.AddrPC.Offset == 0)
  {
    printf("Stack walk complete!\n");
    break;
  }

  do_something();
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-09-29T19:51:33.707

发现带有“CaptureStackBackTraceType”的简短版本非常有用！

[然后使用SymFromAddr()](https://docs.microsoft.com/en-us/windows/win32/debug/retrieving-symbol-information-by-address)、[SymInitialize()](https://docs.microsoft.com/en-us/windows/win32/debug/initializing-the-symbol-handler)解析“callers[]”的函数名称 ，这主要是 Pedro Reis 的版​​本

最后根据 [函数对函数签名进行分解/分解功能](https://stackoverflow.com/questions/4939636/function-to-mangle-demangle-functions)

注意：GNU demangler 函数`abi::__cxa_demangle()`需要一个下划线前缀

# c# - 在c#中运行时确定的切换值

> ID：590162
> 
> 赞同：2
> 
> 时间：2009-02-26T11:32:11.623
> 
> 标签：c#, runtime, case-statement

我在 c# 中有一个 case 语句。我想在运行时从配置文件中选择案例的值。这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T11:32:56.627

不使用 switch 语句，不。案例标签必须是编译时常量。

Marc Gravell 有一个类似开关的构造，你可以在某个地方使用……我会试着找到它。不过，它可能不适合您的特定用途。

否则，一系列 if/else if/else if [...] /else 是要走的路。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T11:41:01.087

由于 C# 中的 case 语句中使用的值应该是常量，我认为不可能在运行时从配置文件中设置这些值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T11:47:00.480

正如其他人所说，switch语句需要编译时的值，因为底层哈希表是在编译时构建的。如果您有在运行时确定的条目，如果我是您，我会使用带有命令模式或委托的哈希表/字典。

# javascript - 如何使用 jQuery 获取选择的所有选项？

> ID：590163
> 
> 赞同：448
> 
> 时间：2009-02-26T11:32:21.917
> 
> 标签：javascript, jquery, jquery-selectors

如何通过传递其 ID 通过 jQuery 获取选择的所有选项？

我只是想得到他们的价值观，而不是文字。

* * *

## 回答 #1

> 赞同：663
> 
> 时间：2009-02-26T11:52:38.437

采用：

```
$("#id option").each(function()
{
    // Add $(this).val() to your list
}); 
```

[.each() | jQuery API 文档](https://api.jquery.com/each/)

* * *

## 回答 #2

> 赞同：187
> 
> 时间：2009-02-26T11:45:33.867

我不知道 jQuery，但我知道如果你得到选择元素，它包含一个“选项”对象。

```
var myOpts = document.getElementById('yourselect').options;
alert(myOpts[0].value) //=> Value of the first option 
```

一个12岁的答案。让我们对其进行一些现代化改造：

```
console.log( [...document.querySelector("#demo").options].map( opt => opt.value ) );
```

```
<select id="demo">
  <option value="Belgium">Belgium</option>
  <option value="Botswana">Botswana</option>
  <option value="Burkina Faso">Burkina Faso</option>
  <option value="Burundi">Burundi</option>
  <option value="China">China</option>
  <option value="France">France</option>
  <option value="Germany">Germany</option>
  <option value="India">India</option>
  <option value="Japan">Japan</option>
  <option value="Malaysia">Malaysia</option>
  <option value="Mali">Mali</option>
  <option value="Namibia">Namibia</option>
  <option value="Netherlands">Netherlands</option>
  <option value="North Korea">North Korea</option>
  <option value="South Korea">South Korea</option>
  <option value="Spain">Spain</option>
  <option value="Sweden">Sweden</option>
  <option value="Uzbekistan">Uzbekistan</option>
  <option value="Zimbabwe">Zimbabwe</option>
</select>
```

* * *

## 回答 #3

> 赞同：153
> 
> 时间：2011-10-13T20:43:21.623

`$.map`可能是最有效的方法。

```
var options = $('#selectBox option');

var values = $.map(options ,function(option) {
    return option.value;
}); 
```

`$('#selectBox option:selected')`如果您只想要已选择的选项，则可以添加更改选项。

第一行选择所有复选框并将它们的 jQuery 元素放入一个变量中。然后我们使用`.map`jQuery 的函数将函数应用于该变量的每个元素；我们所做的只是返回每个元素的值，因为这是我们所关心的。因为我们在 map 函数中返回它们，所以它实际上按照请求构建了一个值数组。

* * *

## 回答 #4

> 赞同：78
> 
> 时间：2009-02-26T12:37:53.540

一些答案使用`each`，但`map`恕我直言，这是一个更好的选择：

```
$("select#example option").map(function() {return $(this).val();}).get(); 
```

jQuery中有（至少）两个`map`函数。Thomas Petersen 的回答使用“Utilities/jQuery.map”；这个答案使用“遍历/地图”（因此代码更简洁）。

这取决于您将如何处理这些值。假设您想从函数返回值，`map`可能是更好的选择。但是，如果您要直接使用这些值，您可能想要`each`。

* * *

## 回答 #5

> 赞同：60
> 
> 时间：2009-02-26T11:57:55.087

```
$('select#id').find('option').each(function() {
    alert($(this).val());
}); 
```

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2009-02-26T12:18:24.787

这将为您将选项值**`#myselectbox`**放入一个干净的数组中：

```
// First, get the elements into a list
var options = $('#myselectbox option');

// Next, translate that into an array of just the values
var values = $.map(options, e => $(e).val()) 
```

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2012-04-30T19:48:13.380

```
$("#id option").each(function()
{
    $(this).prop('selected', true);
}); 
```

虽然，**正确**的方法是设置元素的 DOM 属性，如下所示：

```
$("#id option").each(function(){
    $(this).attr('selected', true);
}); 
```

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2011-05-06T15:09:41.013

您可以通过复选框的名称获取所有“选定值”，并将它们显示在由“，”分隔的字符串中。

一个很好的方法是使用 jQuery 的 $.map()：

```
var selected_val = $.map($("input[name='d_name']:checked"), function(a)
    {
        return a.value;
    }).join(',');

alert(selected_val); 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2013-09-20T05:35:54.463

[工作示例](http://jsbin.com/usizo/110/edit)

最有效的方法是使用`$.map()`

**例子：**

```
var values = $.map($('#selectBox option'), function(ele) {
   return ele.value; 
}); 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2014-02-19T12:48:10.110

您可以为此使用以下代码：

```
var assignedRoleId = new Array();
$('#RolesListAssigned option').each(function(){
    assignedRoleId.push(this.value);
}); 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2016-10-14T20:43:21.440

对于多选选项：

`$('#test').val()`返回选定值的列表。 `$('#test option').length`返回选项的总数（选择和未选择）

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2019-02-01T20:04:07.020

这是jquery中的一个简单示例，用于获取所选项目的所有值，文本或值，或所选项目的文本

```
$('#nCS1 > option').each((index, obj) => {
   console.log($(obj).val());
}) 
```

```
printOptionValues = () => {

  $('#nCS1 > option').each((index, obj) => {
    console.log($(obj).val());
  })

}

printOptionTexts = () => {
  $('#nCS1 > option').each((index, obj) => {
    console.log($(obj).text());
  })
}

printSelectedItemText = () => {
  console.log($('#nCS1 option:selected').text());
}

printSelectedItemValue = () => {
  console.log($('#nCS1 option:selected').val());
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<select size="1" id="nCS1" name="nCS1" class="form-control" >
					<option value="22">Australia</option>
          <option value="23">Brunei</option>
          <option value="33">Cambodia</option>
          <option value="32">Canada</option>
          <option value="27">Dubai</option>
          <option value="28">Indonesia</option>
          <option value="25">Malaysia</option>				
</select>
<br/>
<input type='button' onclick='printOptionValues()' value='print option values' />
<br/>
<input type='button' onclick='printOptionTexts()' value='print option texts' />
<br/>
<input type='button' onclick='printSelectedItemText()' value='print selected option text'/>
<br/>
<input type='button' onclick='printSelectedItemValue()' value='print selected option value' />
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-03-02T10:54:27.327

这是一个简单的 jQuery 脚本：

```
var items = $("#IDSELECT > option").map(function() {
    var opt = {};
    opt[$(this).val()] = $(this).text();
    return opt;
}).get();
var selectvalues = [];

for(var i = 0; i < items.length; i++) {
    for(key in items[i]) {

        var id = key;
        var text = items[i][key];

        item = {}
        item ["id"] = id;
        item ["text"] = text;

        selectvalues.push(item);

    }
}
console.log(selectvalues);
copy(selectvalues); 
```

```
<select>
  <option value="volvo">Volvo</option>
  <option value="saab">Saab</option>
  <option value="mercedes">Mercedes</option>
  <option value="audi">Audi</option>
</select> 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2020-10-23T07:11:10.003

```
 var arr = [], option='';
$('select#idunit').find('option').each(function(index) {
arr.push ([$(this).val(),$(this).text()]);
//option = '<option '+ ((result[0].idunit==arr[index][0])?'selected':'') +'  value="'+arr[index][0]+'">'+arr[index][1]+'</option>';
            });
console.log(arr);
//$('select#idunit').empty();
//$('select#idunit').html(option); 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-08-06T16:18:26.667

```
$("input[type=checkbox][checked]").serializeArray(); 
```

或者：

```
$(".some_class[type=checkbox][checked]").serializeArray(); 
```

要查看结果：

```
alert($("input[type=checkbox][checked]").serializeArray().toSource()); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-08-14T12:13:45.843

如果您正在寻找带有某些选定文本的所有选项，那么下面的代码将起作用。

```
$('#test').find("select option:contains('B')").filter(":selected"); 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-10-22T21:22:54.273

捷径

```
$(() => {
$('#myselect option').each((index, data) => {
    console.log(data.attributes.value.value)
})}) 
```

或者

```
export function GetSelectValues(id) {
const mData = document.getElementById(id);
let arry = [];
for (let index = 0; index < mData.children.length; index++) {
    arry.push(mData.children[index].value);
}
return arry;} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-06-19T11:56:36.820

我发现它简短而简单，并且可以在 Dev Tool 控制台本身中进行测试。

`$('#id option').each( (index,element)=>console.log(`索引：${index}，值：${element.value}，文本：${element.text}`) )`

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-08-12T16:56:04.730

另一种方法是使用`toArray()`带有地图的胖箭头功能，例如：

```
const options = $('#myselect option').toArray().map(it => $(it).val()) 
```

# html - Opera 中的 HTML 错误

> ID：590190
> 
> 赞同：1
> 
> 时间：2009-02-26T11:41:48.573
> 
> 标签：html, css, cross-browser

在高于 9.0 的 Opera 版本中，我发现了一个无法渲染大部分文本的错误。这发生在链接、跨度和强标签上。除此之外，它还会引发一个带有 sup 标签的奇怪错误。

这是现场网站的链接：[http://clients.bionic-comms.co.uk/licensingawards/microsite/enter.html](http://clients.bionic-comms.co.uk/licensingawards/microsite/enter.html) 下面是代码（第一个 div 根本没有给我任何问题）：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Licensing Awards '09 - Enter Your Products</title>
    <link rel="stylesheet" type="text/css" href="css/style.css" />
    <!--[if IE 6]> 
      <link rel="stylesheet" type="text/css" href="css/ie.css">
    <![endif]-->
    <noscript><link rel="stylesheet" type="text/css" href="css/noscript.css"></noscript>
    <script src="js/shadedborder/shadedborder.js" type="text/javascript"></script>
  </head>
  <body>
    <div id="page">
      <div id="otherbits">
        <a href="about.html" id="licensing" name="About"><i>About</i></a>
        <a href="http://www.bionic-comms.co.uk" id="bionic" name="Bionic"><i>Bionic</i></a>
      </div>
      <div id="header">
        <div id="nav">
          <div id="menu"> 
            <a href="enter.html" id="home" name="Home"><i>Home</i></a>
            <a href="nominate.html" id="nominate" name="nominate"><i>nominate</i></a>
            <a href="tickets.html" id="tickets" name="tickets"><i>tickets</i></a>
            <a href="about.html" id="about" name="about"><i>about</i></a>
            <a href="photos.html" id="photos" name="photos"><i>photos</i></a>
          </div>
        </div>
      </div>
      <div id="lildetails">
        <p>Thursday September 10th 2009, Royal Lancaster Hotel, London &bull; Black Tie / Posh Frocks</p>
      </div>
      <div id="enter">
        <div class="head">
          <h2 class="enter">Here you can download the entry form for the product categories in The Licensing Awards 2009\. These annual product awards are open to all UK and Ireland-based companies and are for officially licensed ranges.</h2>
        </div>
        <div class="circle1">1</div>
        <div class="text1">
          <div id="my-border">
            <h5 class="enter">Fill in the form:</h5><br /><span class="enter">Fill in the entry form (one form per entry). <strong>You can download the form <a href="files/entryform.pdf" class="enter">here</a>.</strong></span>
          </div>
        </div>
        <div class="circle2">2</div>
        <div class="text2">
          <div id="my-border1">
            <h5 class="enter">Select your product entries:</h5><br /><span class="enter">Check that the products being entered comply with the entry requirements (i.e. were launched between June 1st 2008 and May 31st 2009). You should submit up to five actual items for each licensed range. Remember &ndash; entries should be license&ndash;specific.</span>
          </div>
        </div>
        <div class="circle3">3</div>
        <div class="text3">
          <div id="my-border2">
            <h5 class="enter">Send your entries:</h5><br /><span class="enter">All entry forms, samples and supporting materials should be sent (arriving no later than June 1st) to:<br /><br /> <span class="enter">The Licensing Awards, Max Publishing, United House, North Road, London, N7 9DP</span>.<br /><br />For further clarification on entering contact Ian Hyder or Jakki Brown at The Licensing Source Book on 202 7700 6740 or by email: <a href="mailto:ianh@max-publishing.co.uk" class="enter">ianh@max-publishing.co.uk</a></span>
          </div>
        </div>
      </div>
    </div>

    <script language="javascript" type="text/javascript">
      var browser=navigator.appName;
      var b_version=navigator.appVersion;
      var version=parseFloat(b_version);
      if ((browser=="Microsoft Internet Explorer") && (version=4)) {  } 
      else {
        var myBorder = RUZEE.ShadedBorder.create({ corner:8, shadow:16 });
        myBorder.render('my-border');
        myBorder.render('my-border1');
        myBorder.render('my-border2');
      }
    </script>
  </body>
</html> 
```

如果有人可以对此有所了解或告诉我我做错了什么，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T12:08:03.487

我不知道为什么，因为我知道所有关于 Javascript 的知识，但它是导致错误的 shadedbo.js。删除那个（并且只有那个）使站点在 Opera 9.26 上正确呈现

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T12:13:23.457

您是否尝试过使用[Opera Dragonfly](http://www.opera.com/dragonfly/)？它是内置的 Javascript 调试器，还可以让您检查页面的 DOM。

Dev.Opera 上有一篇关于它的[介绍性文章。](http://dev.opera.com/articles/view/introduction-to-opera-dragonfly/)

错误控制台也可能有帮助，您可以在“工具”、“高级”、“错误控制台”下找到它。这是它在我的 Opera 9.63 副本中显示的内容：

```
CSS - http://clients.bionic-comms.co.uk/licensingawards/microsite/css/style.css
Linked-in stylesheet
Expected ruleset
Line 10:
  # pre, form, fieldset, table, th, td { margin: 0; padding: 0; } 
  ---------------------------------------------------------------^
CSS - http://clients.bionic-comms.co.uk/licensingawards/microsite/css/style.css
Linked-in stylesheet
Declaration syntax error
Line 373:
  }
  -^
CSS - http://clients.bionic-comms.co.uk/licensingawards/microsite/enter.html
HTML style attribute
background-position-y is an unknown property
Line 1:
  tion:absolute; margin:0; padding:0; width:100%; left:0px; background-position-y:
  --------------------------------------------------------------------------------^ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T12:16:26.023

您可能想要[验证](http://validator.w3.org)此文档。您将其声明为 XHTML，但事实并非如此。你也有未转义的保留字符。（&& 在脚本部分）

我不认为这些问题是您的渲染问题的原因，但现在是谁。有时修复警告可以解决错误:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T12:23:30.627

该页面在 Firefox 3.0.6 和 Opera 9.62 中对我来说是一样的。但是，您应该查看 CSS 中的一对错误和一个 Javascript 错误。在 Firefox 中打开错误控制台并浏览到该页面，您将看到它们。

# assembly - 处理器之间的转换

> ID：590192
> 
> 赞同：3
> 
> 时间：2009-02-26T11:43:40.643
> 
> 标签：assembly, embedded, porting, processor

我在工作中主要编写嵌入式代码。我们有一个大型的长期项目，已经开发了好几代，现在为其编写的处理器正在停产，甚至可能无法继续使用同一制造商的处理器。（过渡可能是从 TI 到 Renesas FPU 微处理器）。部分问题是某些代码是用汇编编写的。
我正在寻找使过渡尽可能轻松的方法，并在将来需要这种过渡时使其更加顺畅。
你有什么建议？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-26T11:53:56.953

生成尽可能多的代码的通用 C 版本。

如果您的意图是让最终实现以手动优化的方式组装，这似乎是浪费时间，但实际上并非如此。

在针对新目标进行优化时，您可以重写汇编中的关键部分，但是拥有 C 版本首先可以让您在每个新目标上快速启动并运行一些东西，其次提供一个可读的参考实现，以便在优化时进行比较，两者这将使您的生活变得更加轻松。

此外，意识到没有必要对*所有东西*进行手动优化组装，只需花费最多时间/占用最多空间的代码部分即可。用汇编语言编写一个大型项目几乎肯定是在浪费不必要的精力。其余的可以保持为通用 C。但是在 C 版本启动并运行并且您可以对其进行概要分析之前，您不会知道应该关注什么。你可以猜到，但你不会知道。

# sql-server - 使用 SQl Server 2008 FTS 突出显示

> ID：590194
> 
> 赞同：0
> 
> 时间：2009-02-26T11:43:51.000
> 
> 标签：sql-server, full-text-search, highlighting

这个问题已经在这里[了](https://stackoverflow.com/questions/69089/how-to-do-hit-highlighting-of-results-from-a-sql-server-full-text-query)，但没有答案，所以再试一次 - 如何使用 SQL 2008 FTS 对结果进行高亮显示？

到目前为止，我找到[了 SQLHighlighter](http://www.sqlhighlighter.com/)，但它是商业产品。我还尝试了本书[http://apress.com/book/view/9781430215943](http://apress.com/book/view/9781430215943)中描述的解决方案，但性能极差。作为最后的手段，我尝试了 Lucene.Net Highlighter，但它与 Lucene 相关联（我正试图摆脱它）。

有人可以推荐其他方式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T12:12:49.200

AFAIK 它是 FTS 的一个列出的“错误”，它不返回任何命中跟踪信息

您只需要自己解析查询，并将其与每个结果行文本列匹配并进行突出显示

这可能非常简单或非常困难，具体取决于您构建 FTS 查询的方式

# apache-flex - 为 flex 应用程序创建 .project 文件

> ID：590210
> 
> 赞同：1
> 
> 时间：2009-02-26T11:49:27.057
> 
> 标签：apache-flex, clearcase

我想将我的 flex 项目添加到像 Clearcase 这样的 SCM 中，然后允许其他开发人员下载它并在 FlexBuilder 中使用。

我需要什么格式将它放在我的透明箱中，以便用户可以简单地下载并导入 Flex Builder？有什么方法可以创建一个 .project 文件或类似的方法来允许 Flex 在 clearcase 中识别项目？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-26T11:59:45.737

我不知道 Flex Builder 项目配置文件（虽然我非常了解 ClearCase），但这个问题看起来像“[你是否将项目文件置于版本控制之下？](https://stackoverflow.com/questions/116121/do-you-keep-your-project-files-under-version-control/119377#119377) ”或“[哪些 eclipse 文件属于版本控制之下](https://stackoverflow.com/questions/337304/which-eclipse-files-belong-under-version-control/337317)”

本质上，只要您有相对路径和/或变量供其他用户解释，您就应该将任何配置文件放在 ClearCase 中。

快照或动态 ClearCase 视图将简单地呈现这些文件供他们使用，无论它们是什么。例如，一些 eclipse .project 或 .classpath 可以以这种方式存储，同时使用[链接目录](https://stackoverflow.com/questions/300328#300346)。

因此，对于 Flex Builder 项目，确定要存储什么文件的一种方法是将这些文件的最小子集复制到新目录中，然后检查是否可以成功重新打开项目。
一旦确定了最小的文件集，您就可以“添加到源代码管理”它们。

# iphone - 如何重现普通 UITableView 的标准标题

> ID：590213
> 
> 赞同：1
> 
> 时间：2009-02-26T11:50:18.460
> 
> 标签：iphone, uitableview, header

我的 iPhoneApp 中有一个普通的 UITableView。我想更改标题文本的字体大小。我知道这是不可能的，我需要使用自己的标签创建自定义标题。

我只是想知道是否有人知道我如何重现类似于标准的标题（使用相同的背景图像等......）？我在任何地方都找不到背景图片..

最好的问候，乔纳森

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T12:04:27.020

您正在寻找`[UIColor groupTableViewBackgroundColor]`：

```
[view setBackgroundColor:[UIColor groupTableViewBackgroundColor]]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-10-04T16:17:07.410

It won't stretch REALLY high, because it will look bad, but this can get you out of dodge, create a stretchable image which uses a graphic of the original header (any iphone template png/psd has these readily extractable).

Then

```
UIImage *image = [UIImage imageNamed:@"tableHeader.png"];
UIImage *stretchImage = [image stretchableImageWithLeftCapWidth:5.0 topCapHeight:2.0];
UIImageView *backgroundImage = [[UIImageView alloc] initWithFrame:frame];
[backgroundImage setImage:stretchImage]; 
```

and either return that as part of the UIView you construct in your:

```
- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section{ 
```

method or (better still) add it as the background of whatever UIView subclass instance you're returning in that method.

Clearly, any width works, I've found I can get it up to 55pixels high without looking naff. Best answer is to replicate the gradient.. I'm too nooby for that though :)

# javascript - 如何使用 Jquery 的 AJAX 提交复杂的表单？

> ID：590214
> 
> 赞同：3
> 
> 时间：2009-02-26T11:50:29.817
> 
> 标签：javascript, jquery, ajax

我正在尝试使用 Jquery 的 ajax 提交表单。它有一些文本框、一些复选框和多个选项的下拉菜单（即可以选择多个选项）。

这里有人告诉我，我可以使用获取所有选定复选框的值

```
$("input:checkbox[name=type]:checked") 
```

然后我可以遍历上述代码返回的所有值，将它们分配给这样的数组：

```
var types=new Array();

    $.each(cboxes, function()
      {
         types[types.length]=$(this).val();
      }
    ); 
```

并尝试使用以下方式提交表单：

```
var someField=$("#someField").val();
var someField2=$("#someField2").val();
var data={field1 : someField, field2=someField2, s_types:types};
$.post("signup.php?type=p",types); 
```

但这不起作用，特别是复选框没有正确提交。我怎样才能让它工作？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-26T12:05:58.857

不必遍历每个字段来获取表单值。jQuery 有一种将表单输入序列化为查询字符串的方法。你可以这样做：

```
$.ajax({
  url: "mybackend.php",
  data: $("#myForm").serialize(),
  success: function(e) { // do something on success },
  error: function(e) { // do something on error }
}); 
```

请记住，javascript 帖子始终以 UTF-8 格式发送数据，因此如果您计划发送带有国际字符的文本，请确保您期望在后端使用这种格式。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-26T12:01:09.320

我建议使用插件来做到这一点。看看这个[表单插件](http://malsup.com/jquery/form/)。它还可以很好地与[验证插件](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)集成。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-26T12:16:36.350

默认的 jQuery [$.param](http://docs.jquery.com/Internals/jQuery.param)不处理数组（[按设计](http://dev.jquery.com/ticket/4177#comment:1)），因此您不能按原样使用 $.serialize。使用插件，如[kgiannakis' answer](https://stackoverflow.com/questions/590214/how-to-submit-a-complex-form-using-jquerys-ajax/590247#590247)中建议的那样，或覆盖 $.param 函数，以便正确处理数组：

```
function($) {
  $.param = function(a) {
    var s = [];
    if (a.constructor == Array || a.jquery) 
      jQuery.each(a, function() { s.push( encodeURIComponent(this.name) + "=" + encodeURIComponent( this.value ) ); });
    else
      for (var j in a)
        if (a[j] && a[j].constructor == Array) jQuery.each( a[j], function(){ s.push( encodeURIComponent(j) + "[]=" + encodeURIComponent( this ) ); });
        else s.push(encodeURIComponent(j) + "=" + encodeURIComponent(a[j]));
    return s.join("&").replace(/%20/g, "+");
  };
})(jQuery); 
```

...然后使用 $.serialize，就像[Danita](https://stackoverflow.com/questions/590214/how-to-submit-a-complex-form-using-jquerys-ajax/590267#590267)建议的那样。

# c++ - 是否可以从 CMFCRibbonCategory 中删除 CMFCRibbonPanel？

> ID：590217
> 
> 赞同：1
> 
> 时间：2009-02-26T11:51:47.643
> 
> 标签：c++, visual-c++, mfc, mfc-feature-pack

我正在寻找`CMFCRibbonPanel`从`CMFCRibbonCategory`. 中只有`AddPanel()`函数`CMFCRibbonCategory`，没有`RemovePanel()`。

我真的需要重建我的整体`CMFCRibbonCategory`来做到这一点吗？

只是为了澄清，我想要的是从类别中删除面板本身，而不是从面板中删除元素。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-05T15:34:21.840

就我而言，我最终确实从头开始重建了该类别。在`CMFCRibbonCategory`源代码（查找`afxribboncategory.cpp`）中，没有明显的方法可以从面板数组中删除面板。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T15:54:33.427

`CMFCRibbonPanel`我对和一无所知`CMFCRibbonCategory`。在 MSDN 中看到类声明后，我认为您可以获得对`CMFCRibbonPanel`from的引用`CMFCRibbonCategory`并调用`CMFCRibbonPanel::RemoveAll`指针。

```
CMFCRibbonCategory *pCategory = m_wndRibbonBar.GetCategory(0);

if (pCategory)
{
     CMFCRibbonPanel *pPanel = pCategory->GetPanel(0);

     if (pPanel)
     {
        pPanel->RemoveAll();
        m_wndRibbonBar.AdjustSizeImmediate();
     }
} 
```

# svn - 手动合并发散代码的技巧

> ID：590220
> 
> 赞同：5
> 
> 时间：2009-02-26T11:53:07.920
> 
> 标签：svn, merge, branch, branching-and-merging

我相当习惯于使用 svn 进行分支和合并，通常这工作正常。然而，一个组件在两个分支中工作，并且基本上将组件带到不同的方向，因此自动合并将不起作用，并且使用超越比较显示文件大部分不同。

我试图将一些文件拼接在一起，但结果，即使它们有效，也是相当可怕的。

我很想对企业说，这是无法做到的。我可以看到这让他们感到沮丧，因为他们有模块 + 功能 A 和模块 + 功能 B 工作，但模块 + 功能 A + 功能 B 就目前而言没有意义。例如，功能 A 可能会删除功能 B 中的关键组件。

有没有办法尝试合并这样的代码？或者模块+A+B真的是模块+C吗？

我们确实看到了这一点，但与功能 B 相比，功能 A 需要的时间范围更短，而功能 B 是长期运行项目的一部分。有没有办法避免这种情况发生？或者他们是如何构建代码以使两个功能很好地结合在一起的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T12:07:16.030

你所说的本质上是试图重新定位其中一个分支。在[一些 DVCS](http://git-scm.com/docs/git-rebase)中对此有支持，但我不知道 SVN 中对这种事情有任何支持。

您最好的选择是选择其中一个分支（现在最重要的分支）并将其合并到应该相当直截了当的主线中。在另一个分支中，您需要从主干中提取更改并协调差异，鉴于您描述的情况，这几乎肯定不会是自动的，您可能需要花一些时间认真考虑如何在顶部实现这个分支功能一个并入主线，但这是并行开发的成本：事情发生了变化。

以后如何避免这种情况？[频繁整合](http://martinfowler.com/articles/continuousIntegration.html)。

如果您有两个团队，每个团队都给定代码库 A，并且他们在 6 个月内致力于不同的功能，那么集成将非常痛苦，因为每个团队都会假设另一个团队已经改变了 A。另一方面，通过每周或每月的集成构建，每个团队都应该更加了解对方正在进行哪些更改，最终集成应该更容易。

这就是为什么开源项目经常反对巨大的补丁，它们过时的速度惊人地快，而且没有人真正有时间正确地审查它们。另一方面，如果您将相同的贡献分解为多个独立的可消化的小部分，则您的贡献更有可能被 A) 接受和 B) 正确审查，这样它就不会导致层出不穷的缺陷。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T12:33:58.090

取一个文件，比如 src1.c。您可以通过这种方式构建描述合并的菱形图：

> ```
>  Original src1.c
>         /       \
>        /         \
>       /           \
>    b1 src1.c     b2 src1.c
>       \            /
>        \          /
>         \        /
>          \      /
>         merged src1.c 
> ```

其中 b1 表示第一个分支版本，b2 表示第二个分支版本。您可以比较并行差异（例如合并源和 b2 版本之间的差异，以及 b1 和原始版本之间的差异）。这可能会有所帮助。

# silverlight - 有什么方法可以检查 Silverlight 中的 DataGrid 是否有焦点？

> ID：590222
> 
> 赞同：0
> 
> 时间：2009-02-26T11:53:13.757
> 
> 标签：silverlight, datagrid

我有一个 Silverlight DataGrid，我需要检查它是否有焦点。我知道有一种方法可以为 GotFocus 设置焦点和事件，但看不到任何检查它是否有焦点的方法。

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T12:42:10.423

AFAIK 没有直接的方法或属性来检查它是否具有焦点，但您应该能够使用 FocusManager.GetFocusedElement()。

如果您随后定义扩展方法，您应该能够调用 MyDataGrid.HasFocus()：

```
public static class ControlExtensions
{
    public static bool HasFocus(this Control aControl)
    {
        return System.Windows.Input.FocusManager.GetFocusedElement() == aControl;
    }
} 
```

**[已编辑：我现在确实对其进行了测试：]** 但是有一个问题：调用 GetFocusedElement() 可以返回 DataGrid 中当前聚焦的单元格。因此，在这种情况下，HasFocus 将返回 false。

为了能够检查 DataGrid 或其一个单元格是否被聚焦，我们可以像这样调整我们的扩展方法

```
public static class ControlExtensions
{
    public static bool HasFocus(this Control aControl, bool aCheckChildren)
    {
        var oFocused = System.Windows.Input.FocusManager.GetFocusedElement() as DependencyObject;
        if (!aCheckChildren)
            return oFocused == aControl;
        while (oFocused != null)
        {
            if (oFocused == aControl)
                return true;
            oFocused = System.Windows.Media.VisualTreeHelper.GetParent(oFocused);
        }
        return false;
    }
} 
```

希望这个对你有帮助？

# vb.net - 如何在两个不同的应用程序中捕获来自取消或确定按钮的响应？

> ID：590225
> 
> 赞同：1
> 
> 时间：2009-02-26T11:54:28.200
> 
> 标签：vb.net

使用我的应用程序 (vb.net) 我正在尝试扫描 Excel 文件，其中一些具有 ActiveX 组件。

运行我的应用程序时，我在 Windows Vista 环境中得到一个小窗口，其中 Office-2007 具有按钮“确定”和“取消”按钮以继续。

但我的问题是，即使我一直按**OK 按钮**，扫描也没有进行。**现在我想在按下取消按钮**的同时继续我的应用程序；即只是跳过文件。是否可以从**取消按钮**捕获响应？（因为这是来自另一个应用程序的消息框，即来自 Vista 或 Office-2007，我不确定）。

我的主要动机是忽略消息框继续....

任何人都可以请在那里帮助我....

谢谢....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T12:22:01.073

的`DisplayAlerts`属性在`Microsoft.Interop.Excel.Application`这里可能会有所帮助。

如果设置为，`FALSE`则 Excel 会自动选择弹出框上的默认选项。我不知道这是否适用于 ActiveX 控件，但它可能值得一试。

# .net - 为什么 Visual Studio 中的 ClickOnce 不从依赖程序集中部署内容文件？

> ID：590227
> 
> 赞同：16
> 
> 时间：2009-02-26T11:55:19.477
> 
> 标签：.net, clickonce

我有一个通过单击部署的智能客户端应用程序。问题是我在依赖程序集中有内容文件，这些文件只是没有显示在 Visual Studio 的已发布应用程序文件对话框中。

这意味着每次部署时，我都必须将应用程序构建输出目录中的所有内容文件复制到已发布目录中并重建清单，这真的很痛苦。

为什么 Visual Studio 中的发布者看不到这些文件？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-30T18:08:02.587

我似乎从@John Hunter 找到了一个更简单的答案演变，将其添加到 csproj。

```
<ItemGroup>
    <Content Include="Bin\**\*.rpt" />
</ItemGroup> 
```

这将使 Visual Studio 自动查看该文件夹中的所有 *.rpt 文件作为解决方案的一部分。你可以去`*.*`积累一切。如果您有一个容器文件夹，这更有意义`bin\MyDeployables\**\*.*`

我们遵循类似的用法，使用 Cassette MSBuild 在发布时合并和缩小我们的 JS，并能够通过内置的 VS 发布工具发布创建的文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-26T15:00:48.970

我想我在[这篇文章](https://stackoverflow.com/questions/423162/deploying-content-file-from-dependent-assemblies-with-clickonce/424691#424691)中的回答回答了你的问题。

**摘要**
要么...
使用“添加为链接”功能将您的内容文件添加到您的项目中。
或者...
创建一个构建后事件以将您的内容文件复制到主输出文件夹。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-23T13:56:19.630

好的，我仍然不知道为什么 Visual Studio 无法使用其发布 ui 显示引用的内容文件，但我找到了一种解决方法来强制发布包含这些文件。

正如[这篇 MSDN 文章](https://docs.microsoft.com/en-us/archive/blogs/mwade/how-to-publish-files-which-are-not-in-the-project)所建议的，将其放入项目文件中。

```
<ItemGroup>
<AdditionalPublishFile Include="$(OutputPath)\**\*.rpt">
  <Visible>False</Visible>
</AdditionalPublishFile>
</ItemGroup>
<Target Name="BeforePublish">
  <Touch Files="@(IntermediateAssembly)" />
  <CreateItem Include="@(AdditionalPublishFile)" AdditionalMetadata="TargetPath=%(RecursiveDir)%(Filename)%(extension);IsDataFile=false">
    <Output TaskParameter="Include" ItemName="_DeploymentManifestFiles" />
  </CreateItem>
</Target> 
```

请注意，在某些情况下，可能需要重新启动 Visual Studio（而不仅仅是重新加载项目）才能使这些更改生效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-27T21:46:46.137

我认为这个解决方案是基于：http: [//blogs.msdn.com/mwade/archive/2008/06/29/how-to-publish-files-which-are-not-in-the-project.aspx](http://blogs.msdn.com/mwade/archive/2008/06/29/how-to-publish-files-which-are-not-in-the-project.aspx)

根据我最近对该帖子的评论：

> 我们应该在什么时候期望这些出现在“应用程序文件”列表中（如果有的话）？
> 
> 或者可以安全地假设它们最终会出现在我们部署的数据文件列表中？
> 
> 就我而言，我希望使用：
> 
> 错误的
> 
> 包含来自构建目录的“资源”子文件夹中的依赖程序集的所有内容文件。

安德鲁。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-21T19:19:21.693

将此添加到 .csproj / .vbproj 的底部可解决此问题。它获取依赖项目的已经缓存的目标项，并将它们显式添加到应用程序清单中，然后也会在分发清单中发布

```
<Target Name="MyAddAdditionalPublishItemsFromDependencies"    BeforeTargets="GenerateApplicationManifest">

  <!-- Get items from child projects first. This just fetches data cached by MSBuild -->
  <MSBuild
      Projects="@(_MSBuildProjectReferenceExistent)"
      Targets="GetCopyToOutputDirectoryItems"
      BuildInParallel="$(BuildInParallel)"
      Properties="%(_MSBuildProjectReferenceExistent.SetConfiguration); %(_MSBuildProjectReferenceExistent.SetPlatform); %(_MSBuildProjectReferenceExistent.SetTargetFramework)"
      Condition="'@(_MSBuildProjectReferenceExistent)' != '' and '$(_GetChildProjectCopyToOutputDirectoryItems)' == 'true' and '%(_MSBuildProjectReferenceExistent.Private)' != 'false' and '$(UseCommonOutputDirectory)' != 'true'"
      ContinueOnError="$(ContinueOnError)"
      SkipNonexistentTargets="true"
      RemoveProperties="%(_MSBuildProjectReferenceExistent.GlobalPropertiesToRemove)">

    <Output TaskParameter="TargetOutputs" ItemName="_AllChildProjectItemsWithTargetPath"/>
  </MSBuild>

  <ItemGroup>
    <!-- Filter out the interesting files from MSBuild -->
    <_AllImportedCopyItems KeepDuplicates="false" KeepMetadata="CopyToOutputDirectory;TargetPath" Include="@(_AllChildProjectItemsWithTargetPath->'%(FullPath)')" Condition="'%(_AllChildProjectItemsWithTargetPath.CopyToOutputDirectory)'=='Always' or '%(_AllChildProjectItemsWithTargetPath.CopyToOutputDirectory)'=='PreserveNewest'" />

    <!-- Get auto copied DLLs with these references -->
    <_AllReferenceAutoCopyItems KeepDuplicates="false" KeepMetadata="CopyToOutputDirectory;TargetPath" Include="@(ReferenceCopyLocalPaths)"/>
  </ItemGroup>
  <ItemGroup>
    <!-- Release memory for huge list -->
    <_AllChildProjectItemsWithTargetPath Remove="@(_AllChildProjectItemsWithTargetPath)"/>
  </ItemGroup>
  <ItemGroup>
    <!-- Filter non-dll -->
    <_AllReferenceAutoCopyItems Remove="%(_AllReferenceAutoCopyItems.Identity)" Condition="'%(_AllReferenceAutoCopyItems.Extension)' != '.dll'" />

    <!-- Remove items which we already have in the deployment manifest -->
    <_AllReferenceAutoCopyItems Remove="@(_DeploymentManifestFiles);@(_DeploymentManifestDependencies)" />
  </ItemGroup>

  <!-- Replace items in _AllReferenceAutoCopyItems with the items emitted by the AssignTargetPath task that have the TargetPath metadata -->
  <AssignTargetPath Files="@(_AllReferenceAutoCopyItems)" RootFolder="$(MSBuildProjectDirectory)">
    <Output TaskParameter="AssignedFiles" ItemName="_Temporary" />
  </AssignTargetPath>
  <ItemGroup>
    <_AllReferenceAutoCopyItems Remove="@(_Temporary)" />
    <_AllReferenceAutoCopyItems Include="@(_Temporary)" />
    <_Temporary Remove="@(_Temporary)" />     
  </ItemGroup>

  <!-- And now declare these items as files for deployment -->
  <ItemGroup>
    <_DeploymentManifestFiles Include="@(_AllImportedCopyItems)">
      <IncludeHash Condition="'%(Extension)' == '.dll' or '%(Extension)' == '.exe'">True</IncludeHash>
      <IsDataFile>false</IsDataFile>
    </_DeploymentManifestFiles>
    <_DeploymentManifestFiles Include="@(_AllReferenceAutoCopyItems)">
      <IncludeHash Condition="'%(Extension)' == '.dll' or '%(Extension)' == '.exe'">True</IncludeHash>
      <IsDataFile>false</IsDataFile>
    </_DeploymentManifestFiles>
  </ItemGroup>    
  <!-- Remove items which we will never again use - they just sit around taking up memory otherwise -->
  <ItemGroup>
    <_AllImportedCopyItems Remove="@(_AllImportedCopyItems)" />
    <_AllReferenceAutoCopyItems Remove="@(_AllReferenceAutoCopyItems)" />
  </ItemGroup>
</Target> 
```

我正在考虑在 .NuGet 包中发布此功能，以便更轻松地安装此脚本。当我有一个链接时，我会发布一个链接。

# silverlight - Silverlight - 检查 302 http 响应

> ID：590229
> 
> 赞同：0
> 
> 时间：2009-02-26T11:55:42.313
> 
> 标签：silverlight, http, http-status-code-302

有谁知道是否有可能发现 Silverlight 中 WCF 调用的响应导致 302（临时重定向）。

生成 302 是因为我们的服务落后于 ISA 并且用户会话超时。Silverligt 应用程序仍然加载在浏览器中，并且 usre 进行交互以进行失败的 WCF 调用。我可能会收到 Not Found 错误，但这也报告了许多不同的问题，因此并不是真正的解决方案。我想专门针对 302 并刷新页面以让用户重新进行身份验证。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T11:47:46.143

我遇到了类似的问题，幸运的是找到了解决方案：为了能够检索除 200 或 404 之外的 Web 请求的 StatusCode，您应该使用

```
var request = WebRequestCreator.ClientHttp.Create(uri) 
```

代替

```
var request = WebRequest.Create(uri) as HttpWebRequest; 
```

我最近写了一篇关于这个问题的帖子，你可以看看[这里](http://bazzilic.wordpress.com/2012/05/27/silverlight-httpwebresponse-status-code-other-than-200-ok-or-404-not-found/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-17T17:55:02.890

我一直在寻找同一个问题的答案，但决定不使用这种方法来解决我正在处理的问题，所以我没有适合你的解决方案，但如果你使用的是 Silverlight 3，那么你也许能够解决它。我尽可能使用本页底部讨论的备用 Http 堆栈：

[http://developers.de/blogs/damir_dobric/archive/2009/08/22/soap-faults-and-new-network-stack-in-silverlight-3.aspx](http://developers.de/blogs/damir_dobric/archive/2009/08/22/soap-faults-and-new-network-stack-in-silverlight-3.aspx)

这至少使我能够访问 SOAP 错误，但我不知道您是否/如何访问 HTTP 302 响应，因为当我尝试这样做时，我发现 Silverlight 似乎实际上遵循了重定向并重新发出我的 SOAP 请求，而不是报告给我的应用程序。

不过，我确实开始调查的是如何使用行为来改变这种情况。不过，我对这项调查并没有走得太远，所以不知道它是否可行！

# c# - 强制分配超类中的变量（在编译时）

> ID：590231
> 
> 赞同：0
> 
> 时间：2009-02-26T11:56:44.573
> 
> 标签：c#

我有一个包含一堆变量的超类。例如

```
string s1= ""; string s2= ""; string s3= ""; 
```

...ETC

我想保证这些变量在编译时在从这个超类继承的子类中被覆盖（分配一些有用的东西）。

有没有一种优雅的方式来做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-26T11:58:45.083

使基类中的所有构造函数都将它们作为参数，并从这些构造函数中设置它们：

```
protected BaseClass(string s1, string s2, string s3)
{
    this.s1 = s1;
    this.s2 = s2;
    this.s3 = s3;
} 
```

...

```
// Just for example
public DerivedClass(string x) : base("foo", "bar", x)
{
} 
```

希望它们无论如何都是私有字段，所以派生类无论如何都不能直接设置它们，对吧？:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T12:07:16.280

C# 中不能有虚拟字段。如果你真的需要这个，你可以使用属性，然后覆盖它并在你的子类中给出一个默认值。

```
public class A
{
  private string s1;
  public virtual string S1
  { 
    get { return this.s1; }
  }
}

public class B : A
{
  private string myString = "default";
  public override string S1
  {
    get
    {
      return this.myString;
    }
  } 
} 
```

# css - 我需要将 2 个不同的高度应用于 2 个不同的字段集标签

> ID：590244
> 
> 赞同：1
> 
> 时间：2009-02-26T12:00:46.017
> 
> 标签：css

我在 CSS 中使用的是

```
form fieldset
{
    height : 300px;    
} 
```

但是我有

```
<fieldset><legend>ONE</legend></fieldset>`

<fieldset><legend>TWO</legend></fieldset> 
```

问题是两个字段集都应用了相同的高度。

有没有办法将不同的高度应用于 CSS 中的不同字段集。我不是在寻找我知道如何应用的内联样式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T12:02:53.997

如果您只使用每个 ONCE，则给每个字段集一个 ID，否则使用一个类

```
<fieldset id="f1">
</fieldset>
<fieldset id="f2">
</fieldset> 
```

或者

```
<fieldset class="bluefieldset"> 
</fieldset> 
<fieldset class="grayfieldset"> 
</fieldset> 
```

一个类表示许多元素可以使用它。W3C 中的 Id 是 Id 属性对页面唯一的标准

在 CSS 中，您引用了一个类，例如

```
.bluefieldset{} 
```

或者

```
fieldset.bluefieldset{} 
```

对于您使用哈希的 ID，例如

```
#f1 
```

或者

```
fieldset#f1{} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T12:16:45.773

使用 css :first-child 选择器 ( [http://www.w3schools.com/css/pr_pseudo_first-child.asp](http://www.w3schools.com/css/pr_pseudo_first-child.asp) )

这在 IE6 中不起作用

# python - 如何更改 Python 模块名称？

> ID：590250
> 
> 赞同：10
> 
> 时间：2009-02-26T12:01:22.863
> 
> 标签：python, module

只有我重命名文件才有可能吗？或者文件中是否有一个`__module__`变量来定义它的名称？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-26T12:16:09.537

如果您真的想使用语句“import newname”导入文件“oldname.py”，有一个技巧可以实现：使用旧名称导入模块*，*然后使用新名称将其注入`sys.modules`。随后的导入语句也会在新名称下找到它。代码示例：

```
# this is in file 'oldname.py'
...module code... 
```

用法：

```
# inject the 'oldname' module with a new name
import oldname
import sys
sys.modules['newname'] = oldname 
```

现在您可以在任何地方使用`import newname`.

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-26T12:26:13.067

您可以使用 as 来更改导入时用于模块的名称：

```
import foo as bar
print bar.baz 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-26T12:05:14.193

是的，您应该重命名文件。最好是在您这样做之后从系统中删除`oldname.pyc`和`oldname.pyo`编译的文件（如果存在），否则该模块也可以以旧名称导入。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T12:27:07.620

当您执行此操作时，Python 解释器会在 PYTHONPATH 中`import module_name`查找文件 。`module_name`*`.extension`*因此，在不更改文件名的情况下不会更改该名称。但当然你可以这样做：

```
import module_name as new_module_name 
```

甚至

```
import module_name.submodule.subsubmodule as short_name 
```

有用的例如。用于编写数据库代码。

```
import sqlite3 as sql
sql.whatever.. 
```

然后切换例如。`sqlite3`对`pysqlite`您来说，只需更改导入行

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T12:06:27.640

每个类都有一个`__module__`属性，尽管我相信改变它不会改变类的命名空间。

如果可能的话，它可能会涉及使用 setattr 将方法或类插入到所需的模块中，尽管您冒着使您的代码对未来的同行非常困惑的风险。

最好的办法是重命名文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-26T12:07:30.587

你想在哪里有这个`__module__`变量，所以你的原始脚本知道要导入什么？模块由文件名识别并在`sys.path`变量中定义的路径中查找。

因此，您必须重命名文件，然后删除`oldname.pyc`，以确保一切正常。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-11-20T17:13:31.760

我在使用 bsddb 时遇到了这样的问题。我被迫安装 bsddb3 模块，但导入了数百个脚本 bsddb。我没有更改所有的导入，而是提取了 bsddb3 egg，并在 site-packages 目录中创建了一个软链接，以便“bsddb”和“bsddb3”与 python 相同。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-03-02T07:48:31.237

您可以通过**模块**属性设置模块，如下所示。

```
func.__module__ = module 
```

您甚至可以创建一个装饰器来更改文件中特定函数的模块名称，例如：

```
def set_module(module):
    """Decorator for overriding __module__ on a function or class.
    Example usage::
        @set_module('numpy')
        def example():
            pass
        assert example.__module__ == 'numpy'
    """
    def decorator(func):
        if module is not None:
            func.__module__ = module
        return func
    return 
```

然后使用

```
@set_module('my_module')
def some_func(...): 
```

请注意，因为此装饰器用于更改函数的各个模块名称。

此示例取自 numpy 源代码：[https ://github.com/numpy/numpy/blob/0721406ede8b983b8689d8b70556499fc2aea28a/numpy/core/numeric.py#L289](https://github.com/numpy/numpy/blob/0721406ede8b983b8689d8b70556499fc2aea28a/numpy/core/numeric.py#L289)

# jquery - 如何在页面加载时隐藏手风琴？

> ID：590252
> 
> 赞同：0
> 
> 时间：2009-02-26T12:01:44.547
> 
> 标签：jquery

我在一个 DIV 标记中有两组 JQuery Accordions。在页面加载的那一刻，这两个 Accordions 显示在另一个下方。但是，我只希望在加载 HTML 页面时显示这些 Accordions 之一。如何隐藏一个而使另一个可见？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T12:19:06.843

给他们不同的标识符，并使用选择器来选择你想要隐藏的那个，并将其可见属性更改为隐藏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T12:17:55.240

来自CSS：

```
display:none; 
```

或者

```
visibility:hidden; 
```

或者

```
position:absolute;left:-9999px; 
```

或者

```
opacity:0 
```

这是为了完全隐藏手风琴。但是，如果您只想显示手风琴头，则只隐藏内容（dd 或 div 或您使用的任何内容）`display:none`。

# java - 确定 Java RMI 调用的远程客户端 IP 地址

> ID：590257
> 
> 赞同：6
> 
> 时间：2009-02-26T12:03:17.117
> 
> 标签：java, networking, client-server, rmi

当我实现 RMI 服务器（实现扩展 java.rmi.Remote 的接口）时，有没有办法获取有关当前 RMI 请求上下文的信息，特别是远程客户端的 IP 地址？

```
public void myMethod() throws RemoteException {

    log.info("remote IP is "+ RMISomething.getSomething());

} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-27T00:52:11.497

请参阅[java.rmi.server.RemoteServer#getClientHost](http://java.sun.com/javase/6/docs/api/java/rmi/server/RemoteServer.html#getClientHost())

# c++ - 从多个线程写入静态数据实际上是否安全

> ID：590264
> 
> 赞同：1
> 
> 时间：2009-02-26T12:05:27.720
> 
> 标签：c++, multithreading

我有一些想要从数据库中缓存的状态数据。几个线程中的任何一个都可以修改状态数据。数据修改后将写入数据库。数据库写入将始终由底层数据库访问层连续完成，该层将数据库操作排队在不同的进程中，因此我不关心那些竞争条件。

只从多个线程修改静态数据是否有问题？理论上，修改有可能实现为读取、修改、写入，但实际上我无法想象会是这样。

我的数据处理类将如下所示：

```
class StatusCache
{
public:
    static void SetActivityStarted(bool activityStarted)
        { m_activityStarted = activityStarted; WriteToDB(); }
    static void SetActivityComplete(bool activityComplete);
        { m_activityComplete = activityComplete; WriteToDB(); }
    static void SetProcessReady(bool processReady);
        { m_processReady = processReady; WriteToDB(); }
    static void SetProcessPending(bool processPending);
        { m_processPending = processPending; WriteToDB(); }
private:
    static void WriteToDB(); // will write all the class data to the db (multiple requests will happen in series)
    static bool m_activityStarted;
    static bool m_activityComplete;
    static bool m_processReady;
    static bool m_processPending;
}; 
```

我不想使用锁，因为应用程序的这一部分已经有几个锁，添加更多锁会增加死锁的可能性。

数据库更新中的 2 个线程之间是否存在重叠并不重要，例如

```
thread 1                        thread 2                    activity started in db
SetActivityStarted(true)        SetActivityStarted(false)   
  m_activityStated = true
                                  m_activityStarted = false
                                  WriteToDB()               false
  WriteToDB()                                               false 
```

因此 db 显示了最近由 m_... = x 行设置的状态。还行吧。

这是一种合理的使用方法还是有更好的方法？

[编辑说我只关心最后一个状态-顺序不重要]

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-26T12:11:34.197

不，这不安全。

生成的写入 m_activityStarted 和其他代码的代码可能是原子的，但这不是保证的。此外，在您的设置器中，您会做两件事：设置布尔值并拨打电话。这绝对不是原子的。

你最好在这里使用某种锁进行同步。

例如，一个线程可能会调用第一个函数，在该线程进入“WriteDB()”之前，另一个线程可能会调用另一个函数并进入 WriteDB()，而不是第一个进入那里。然后，可能状态以错误的顺序写入数据库。

如果您担心死锁，那么您应该修改您的整个并发策略。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-26T13:55:53.413

在多 CPU 机器上，不能保证在不发出同步指令的情况下，运行在不同 CPU 上的线程会以正确的顺序看到内存写入。只有当您发出同步命令（例如互斥锁或解锁）时，才能保证每个线程的数据视图是一致的。

为了安全起见，如果您希望在线程之间共享状态，则需要使用某种形式的同步。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-26T17:21:18.023

你永远不知道事情是如何在较低级别实现的。尤其是当您开始处理多核、各种缓存级别、流水线执行等时。至少不是没有大量工作，并且实现经常更改！

如果你不互斥它，最终你会后悔的！

我最喜欢的例子涉及整数。这一特定系统在两次写入中写入其整数值。例如，不是原子的。自然地，当线程在这两次写入之间被中断时，你会从一个 set() 调用中获得高字节，而从另一个调用中获得低字节 ()。一个经典的错误。但远不是可能发生的最坏情况。

互斥是微不足道的。

你提到： ***我不想使用锁，因为应用程序的这一部分已经有几个锁，添加更多会增加死锁的可能性。***

只要你遵循黄金法则，你会没事的：

*   不要混合互斥锁命令。EgAlock();B.lock() 在一个地方和 B.lock();A.lock(); 在另一个。使用一个订单或另一个！
*   锁定尽可能短的时间。
*   不要尝试将一个互斥锁用于多种用途。使用多个互斥锁。
*   尽可能使用递归或错误检查互斥锁。
*   使用 RAII 或宏来确保解锁。

例如：

```
#define RUN_UNDER_MUTEX_LOCK( MUTEX, STATEMENTS ) \
   do { (MUTEX).lock();  STATEMENTS;  (MUTEX).unlock(); } while ( false )

class StatusCache
{
public:
    static void SetActivityStarted(bool activityStarted)
        { RUN_UNDER_MUTEX_LOCK( mMutex, mActivityStarted = activityStarted );
          WriteToDB(); }
    static void SetActivityComplete(bool activityComplete);
        { RUN_UNDER_MUTEX_LOCK( mMutex, mActivityComplete = activityComplete );
          WriteToDB(); }
    static void SetProcessReady(bool processReady);
        { RUN_UNDER_MUTEX_LOCK( mMutex, mProcessReady = processReady );
          WriteToDB(); }
    static void SetProcessPending(bool processPending);
        { RUN_UNDER_MUTEX_LOCK( mMutex, mProcessPending = processPending );
          WriteToDB(); }

private:
    static void WriteToDB(); // read data under mMutex.lock()!

    static Mutex mMutex;
    static bool  mActivityStarted;
    static bool  mActivityComplete;
    static bool  mProcessReady;
    static bool  mProcessPending;
}; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T12:10:21.513

我不是 c++ 人，但我认为如果你没有某种同步的话，写它是不安全的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-26T13:31:02.397

看起来你在这里有两个问题。

#1 是你的布尔赋值不一定是原子的，即使它是你代码中的一个调用。所以，在幕后，你可能会有不一致的状态。如果您的线程/并发库支持，您可以考虑使用 atomic_set()。

#2 是阅读和写作之间的同步。从您的代码示例中，看起来您的 WriteToDB() 函数写出了所有 4 个变量的状态。WriteToDB 序列化在哪里？您是否会遇到这样的情况：thread1 启动 WriteToDB()，它读取 m_activityStarted 但没有完成将其写入数据库，然后被 thread2 抢占，它一直写入 m_activityStarted。然后，thread1 恢复，并完成将其不一致的状态写入数据库。至少，我认为在执行数据库更新所需的读取访问时，您应该对锁定的静态变量具有写入访问权限。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-26T18:23:54.847

> 理论上，修改有可能实现为读取、修改、写入，但实际上我无法想象会是这样。

通常是这样，除非您设置了某种事务性内存。变量通常存储在 RAM 中，但在硬件寄存器中进行修改，因此读取不仅仅是为了踢球。读取对于将值从 RAM 复制到可以修改（甚至与另一个值比较）的位置是必要的。当数据在硬件寄存器中被修改时，陈旧的值仍然在 RAM 中，以防其他人想要将它复制到另一个硬件寄存器中。当修改后的数据被写回 RAM 时，其他人可能正在将其复制到硬件寄存器中。

在 C++ 中，整数保证至少占用一个字节的空间。这意味着它们实际上可能具有除 true 或 false 之外的值，例如由于读取发生在写入过程中的竞争条件。

在.Net 上有一些静态数据和静态方法的自动同步。标准 C++ 中没有这样的保证。

如果您只查看整数、布尔值和（我认为）长整数，那么您有一些用于原子读/写和加法/减法的选项。C++0x 有[一些东西](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2427.html)。[英特尔 TBB](http://www.threadingbuildingblocks.org/)也是如此。我相信大多数操作系统也有实现这一点所需的钩子。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-26T18:31:02.940

虽然您可能害怕死锁，但我相信您会为您的代码感到非常自豪，因为您知道它可以完美运行。
所以我建议你加入锁，你可能还想考虑信号量，一种更原始​​（也许更通用）的锁类型。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-26T12:13:45.687

你可以用 bool 来逃避它，但是如果被改变的静态对象是非常复杂的类型，就会发生可怕的事情。我的建议 - 如果您要从多个线程编写，请始终使用同步对象，否则您迟早会被咬。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-26T13:22:50.997

这不是一个好主意。有很多变量会影响不同线程的时序。

如果没有某种锁，您将无法保证拥有正确的最后状态。

两个状态更新可能会乱序写入数据库。

只要锁定代码设计得当，这样的简单过程就不会出现死锁问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-26T13:34:20.330

正如其他人指出的那样，这通常是一个非常糟糕的主意（有一些警告）。

仅仅因为当您碰巧测试特定机器时没有发现问题并不能证明该算法是正确的。对于并发应用程序尤其如此。例如，当您切换到具有不同内核数量的机器时，交错可能会发生巨大变化。

警告：如果您所有的 setter 都在进行原子写入，并且您不关心它们的时间安排，那么您可能会没事。

根据您所说的，我认为您可以在设置器中设置一个脏标志。一个单独的数据库写入线程会经常轮询脏标志并将更新发送到数据库。如果某些项目需要额外的原子性，则它们的设置器需要锁定互斥锁。数据库写入线程必须始终锁定互斥锁。

# visual-studio-2008 - 我应该先安装哪个：Visual Studio 2008 还是 SQL Server 2008？

> ID：590266
> 
> 赞同：11
> 
> 时间：2009-02-26T12:05:36.143
> 
> 标签：visual-studio-2008, sql-server-2008, installation

半年前，我安装了 Visual Studio 2008 和 SQL Server 2008。我不太记得我先安装了哪个，但从那以后我无法从 Visual Studio IDE 连接到任何基于文件的 SQL Server 数据库。我认为这与 Visual Studio 中的一个错误有关，即我之前在同一系统上安装了 Visual Studio 2005 以及我安装这两个程序的顺序。

现在我即将升级到 Visual Studio Team System，我宁愿避免遇到同样的数据库连接问题。我是不是该

A) 卸载 Visual Studio 和 SQL Server，然后重新安装 SQL Server，然后重新安装 Visual Studio？B) 只需卸载 Visual Studio 并更新到 VS Team System？

谢谢，

阿德里安

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-26T12:43:53.213

我安装的是 SQL Server 的开发者版，而不是 VS2008 附带的 SQL Server Express 版。我发现如果您先安装 SQL Server，安装效果会更好，这样在安装 SQL Server Developer 版本之前无需卸载 Express 版本。我不建议安装这两个版本。在我发现安装了两个版本是问题所在之前，我遇到了无穷无尽的问题。卸载 VS 和 SQL Server Express 可能是必要的，但我相信只需卸载 SQL Server Express 并（重新）安装 SQL Server Developer 版本就足够了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T12:07:42.927

我认为它们的安装顺序并不重要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T12:12:51.353

没有技术原因您应该首先安装一个或另一个。VS IDE 对于两者都是相同的，并且无论安装什么其他东西，都应该安装用于开发的 Visual Studio 附加组件（C#、VB 是附加组件）或 SQL。

就我个人而言，我会先安装 DB - 原因是如果您第二次安装 DB，则起始页的默认提要设置为 SQL 团队的 RSS 提要，而不是 MSDN 提要。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T12:40:30.630

我从 SQL 2005 Express 更改为 SQL 2008 Express 后的经验是 VS 无法识别 SQL 2008 并且仍在寻找 SQL 2005。

我采取了这些步骤：

*   卸载 Visual Studio
*   删除我能找到的所有似乎与 Visual Studio 相关的注册表项
*   安装 Visual Studio

VS 现在能够连接到 SQL Server 和用户实例（文件 mdf）但是，在最少特权的用户访问帐户中，我收到此错误消息：“由于启动进程失败，无法生成 SQL Server 的用户实例用户实例。”

要修复此错误：

*   在 C:\Users[user]\AppData 目录下，如果找到 SQL Express 正在使用的文件夹并删除它们。

我现在能够在 Visual Studio 中建立数据库连接。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-10-06T15:13:00.027

始终首先将 IIS 添加到您的操作系统然后 intsall Office（如果需要）然后使用 windows 更新，只要您确定没有更多更新然后安装 Sql Server 然后使用 windows 更新以确保您有 Sql Server 所需的任何 ServicePack然后安装 Visual Studio，然后使用 Windows 更新，只要您确定没有更多更新

您可以在同一台机器上拥有开发人员和快速版本的 sql（甚至不同版本）。您可以拥有从 2003 年到 2010 年的所有 Visual Studio 版本（之前也没有尝试过）。

唯一需要注意的是：所有语言都使用相同的语言，否则您将经常遇到 MSDN 崩溃，并且 msdn 的合并操作会使您的 PC 上的 msdn 无法读取。

辛比

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2010-09-06T17:36:52.040

通过在自定义安装中禁用sqlsever express editin选项来安装visual studio，然后单独安装sqlserver express edition 2005，然后安装mangaement studio ..u可以连接到DB ..它正在工作......

# sql - 数据透视表

> ID：590268
> 
> 赞同：1
> 
> 时间：2009-02-26T12:06:09.123
> 
> 标签：sql, sql-server, sql-server-2005

我有一张这样的桌子：

```
序列号 partnb id 实际标称
1 1 AGR 15,2176803 15,2
1 1 四月 5,8060656 5,8
1 1 DCI 61,9512259 62
1 43​​ AGR 15,4178727 15,4
1 43​​ 四月 7,235779 7,2
1 43​​ DCI 52,0080535 52
2 2 AGR 15,2097009 15,2
2 2 四月 5,8009968 5,8
2 2 DCI 61,9582795 62
2 44 AGR 15,4191387 15,4
2 44 四月 7,2370065 7,2
2 44 DCI 52,010244 52
```

我想要这个：

```
序列号 partnb AGR AGR_nominal APR APR_nominal DCI DCI_nominal
1 1 15,217 15,2 5,806 5,8 61,951 62
1 43​​ 15,417 15,2 7,235 7,2 52,008 62
2 2 15,209 15,2 5,800 5,8 61,958 62
2 44 15,419 15,4 7,237 7,2 52,010 52
```

如何在 SQL Server 2005 中实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T12:27:29.773

您可以使用 Sql Server 2005 中的 PIVOT 关键字。这是描述[http://msdn.microsoft.com/en-us/library/ms177410.aspx](http://msdn.microsoft.com/en-us/library/ms177410.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T13:54:22.123

我找到了解决方案

```
  选择
    平面，
    序列号，
    合作伙伴，
    友通社，
    （从 vwMeasurement v WHERE p.planid=v.planid 中选择标称
        AND p.serialnumber=v.serialnumber AND p.partnb=v.partnb
        和 v.id='DFI') 作为nominal_DFI，
    直流电，
    （从 vwMeasurement v WHERE p.planid=v.planid 中选择标称
        AND p.serialnumber=v.serialnumber AND p.partnb=v.partnb
        AND v.id='DCI') 作为标称_DCI，
    DPI,
    （从 vwMeasurement v WHERE p.planid=v.planid 中选择标称
        AND p.serialnumber=v.serialnumber AND p.partnb=v.partnb
        AND v.id='DPI') 作为nominal_DPI，
    AGR,
    （从 vwMeasurement v WHERE p.planid=v.planid 中选择标称
        AND p.serialnumber=v.serialnumber AND p.partnb=v.partnb
        AND v.id='AGR') 作为nominal_AGR，
    四月，
    （从 vwMeasurement v WHERE p.planid=v.planid 中选择标称
        AND p.serialnumber=v.serialnumber AND p.partnb=v.partnb
        AND v.id='APR') 作为nominal_APR，
    危险品，
    （从 vwMeasurement v WHERE p.planid=v.planid 中选择标称
        AND p.serialnumber=v.serialnumber AND p.partnb=v.partnb
        和 v.id='DGR') 作为nominal_DGR，
    民主共和国，
    （从 vwMeasurement v WHERE p.planid=v.planid 中选择标称
        AND p.serialnumber=v.serialnumber AND p.partnb=v.partnb
        AND v.id='DPR') 作为nominal_DPR，
    DFE,
    （从 vwMeasurement v WHERE p.planid=v.planid 中选择标称
        AND p.serialnumber=v.serialnumber AND p.partnb=v.partnb
        和 v.id='DFE') 作为nominal_DFE，
    DKE,
    （从 vwMeasurement v WHERE p.planid=v.planid 中选择标称
        AND p.serialnumber=v.serialnumber AND p.partnb=v.partnb
        和 v.id='DKE') 作为nominal_DKE，
    MDKE,
    （从 vwMeasurement v WHERE p.planid=v.planid 中选择标称
        AND p.serialnumber=v.serialnumber AND p.partnb=v.partnb
        和 v.id='MDKE') 作为nominal_MDKE，
    MDKI,
    （从 vwMeasurement v WHERE p.planid=v.planid 中选择标称
        AND p.serialnumber=v.serialnumber AND p.partnb=v.partnb
        和 v.id='MDKI') 作为nominal_MDKI，
    DKI,
    （从 vwMeasurement v WHERE p.planid=v.planid 中选择标称
        AND p.serialnumber=v.serialnumber AND p.partnb=v.partnb
        和 v.id='DKI') 作为nominal_DKI
  FROM(SELECT DISTINCT serialnumber, planid, partnb, id, actual FROM vwMeasurement) 驱动
  枢轴 (
    总和（驱动程序。实际）
    FOR driver.id IN (DFI, DCI, DPI, AGR, APR, DGR, DPR, DFE, DKE, MDKE, MDKI, DKI)
  ) 作为 p
  ORDER BY planid、序列号、partnb
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T12:21:18.463

可能有更好的方法，但您可以为 AGR、APR 和 DCI 创建单独的视图并将它们加入 id。

# wpf - TwoWay 或 OneWayToSource 绑定无法在只读属性上工作

> ID：590269
> 
> 赞同：113
> 
> 时间：2009-02-26T12:06:13.600
> 
> 标签：wpf, binding

我有一个需要在文本框中显示的只读属性，并在运行时出现此错误。我已经设置了`IsEnabled="False"`，`IsReadOnly="True"`- 没有运气。其他搜索说 readonly 应该修复它，但不适合我。通过添加一个虚拟设置器，我得到了一个丑陋的解决方法......

* * *

## 回答 #1

> 赞同：194
> 
> 时间：2009-02-26T12:14:50.910

没有代码很难猜测，但您应该能够将 BindingMode 设置为 OneWay。

```
<TextBox Text="{Binding Path=MyProperty, Mode=OneWay}" /> 
```

或来自代码：

```
Binding binding = new Binding();
binding.Mode = BindingMode.OneWay; 
```

# javascript - 在没有用户交互的情况下触发的 Javascript 事件？

> ID：590289
> 
> 赞同：3
> 
> 时间：2009-02-26T12:10:40.577
> 
> 标签：javascript, events

我的表单上的文本框可能会根据在各种下拉列表中选择的内容而改变。

当文本框值发生变化时，有没有办法调用 javascript 函数？

尝试过 onchange 事件，但这似乎只有在用户手动更改文本框值时才有效。

干杯，

布兰丹

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-26T12:17:19.767

不，javascript 触发的表单元素更改不会触发事件。如果他们这样做了，这将导致各种递归无限循环。

简单的解决方案是在更改文本框的值时手动调用 onchange 函数，但是您也可以使用某种包装函数。作为一个非常基本的例子：

```
function updateTextField(new_text) {
  text_field.value = new_text;
  text_field.onchange();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T12:15:39.613

从您的 JS 代码中设置文本框的内容时，调用另一个传入要设置的文本的函数，然后您可以从任何需要的地方调用它，然后执行您的逻辑。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-26T12:17:49.437

尝试使用 setTimeout 断开负责更改控件值的逻辑与 onchange 事件的执行路径的连接。

```
<html>
  <head>
    <script type="text/javascript">
      function setValue(target) {
        alert("changed - value: " + target.value);
        setTimeout("reallySetValue('" + target.id + "');", 1);
      }
      function reallySetValue(id) {
        var control = document.getElementById(id);
        control.value += control.value;
      }
    </script>
  </head>
  <body>
    <form>
      <div>
        Enter "a" here: 
        <input type="text" id="test" onchange="setValue(this)">  
        <br/>
        <br/>
        <input type="text">  
      </div>
    </form>
  </body>
</html> 
```

此处说明 [了在其 OnChange 事件中更改文本框值](http://ewbi.blogs.com/develops/2004/12/ie_changing_a_t.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T12:21:56.213

您可以使用出色的[event.simulate.js](http://github.com/kangax/protolicious/blob/5b56fdafcd7d7662c9d648534225039b2e78e371/event.simulate.js)来执行此操作。不过，这个脚本确实依赖于 Prototype.js 库。

如果您想在不依赖外部库的情况下做到这一点，请查看**`fireEvent`**and**`createEvent`**函数。一个简单的演示如何实现它：

```
function triggerEvent(element, eventName)
{
    if (document.createEvent)
    {
        var evt = document.createEvent('HTMLEvents');
        evt.initEvent(eventName, true, true);

        return element.dispatchEvent(evt);
    }

    if (element.fireEvent)
        return element.fireEvent('on' + eventName);
}

triggerEvent(document.getElementById('myTextbox', 'change')); 
```

使用 event.simululate.js，你会这样做：

```
Event.simulate('myTextbox', 'change'); 
```

这里问了一个类似的问题：[使用 Prototype 触发事件](https://stackoverflow.com/questions/460644/trigger-an-event-with-prototype)。

**编辑：**虽然可以使用`document.getElementById('myTextbox').change()`，但我不建议这样做，因为它会使您的代码不那么灵活。将 onChange 事件附加到文本框时，手动调用 change() 事件时不会触发这些事件。使用上述方法，事件将传播，就像事件是用户触发的一样。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-26T12:27:07.387

在 Web 浏览器中，控件上的编程更改不会触发该控件上的事件。您必须指示更改文本框值的代码触发 onchange 事件。这就是你可以用普通的 javascript 做到这一点的方法：

```
var textbox = document.getElementById("boxId");
textbox.value = "Abc";
textbox.onchange(); 
```

当然，使用像 jQuery 这样的库会更容易、更健壮：

```
$("#boxId").val("Abc").change(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-26T12:15:38.507

假设前端是 html：

您可以安装一个 timout 回调并以 100 毫秒的间隔查询文本框的内容，并将其与您存储在变量中的某个先前值进行比较。

关键字：window.setTimout()、window.setInterval()

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-26T13:57:43.783

我建议查看 YUI 的自定义事件，例如： [YUI 自定义事件示例链接](http://developer.yahoo.com/yui/examples/event/custom-event.html)

您所需要的只是将此脚本与事件操作一起附加

```
<script type="text/javascript" src="http://yui.yahooapis.com/2.7.0/build/yahoo-dom-event/yahoo-dom-event.js"></script> 
```

然后你就可以使用自定义事件（HTML 中的任何地方）fnSubscriberChange - 在这个 Func 中你可以做任何你想做的事情。您可以将您的文本框更改值逻辑放在这里，并取决于更改的选择框值 - 调用所需的函数。依赖事件监听的逻辑清晰易修改；YUI 库支持所有浏览器，所以你不应该介意浏览器的功能。

文本框和选择框：

```
 <input type='text' id='id_text_fld' value=''/>
    <select id='id_sel_one'>
     <option value="test1">Test1
     <option value="test2">Test2
    </select>
    <select id='id_sel_two'>
     <option value="test3">Test3
     <option value="test4">Test4
    </select> 
```

事件脚本：

```
<script>
    (function() {

        //create a new custom event, to be fired
        var onChangeValue = new YAHOO.util.CustomEvent("onChangeValue");
        // Attach change event listener for Select boxes by their IDs
      YAHOO.util.Event.on( ['id_sel_one', 'id_sel_two'], 'change', fnCallback, this);  
      // Function to call when Change event on Select occures
        fnCallback = function(e) { 
            alert("This elem:" + this.id+ " changed value to:" + this.value);
            // Fire our Custom event 
        onChangeValue.fire({dom_el: this}); // passing select box element [this] to function 
      }

      // Listen for Custom event and call our Func 
      onChangeValue.subscribe(fnSubscriberChange); // Lets listen for ChangeValue event and call our Func 
        fnSubscriberChange = function(type, args) {
             alert("Event type:" + type + " dom el id:" + args[0].dom_el.id );
             var dom_el = args[0].dom_el; // Select Box that produces Change
        };
    })();
    </script> 
```

# xpath - MSXML 中的 XPath 查询是否有最大长度？

> ID：590296
> 
> 赞同：2
> 
> 时间：2009-02-26T12:11:32.947
> 
> 标签：xpath, msxml, msxml3

我打算使用 msxml 做一个相对较大的 XPath 查询。msxml 强制执行的查询是否有最大长度？

背景：从一些外部输入，我的代码将创建许多 xpath 查询，我对所有这些或-ed 的结果感兴趣：

```
 myObject.SelectNodes(subQuery1 +"|"+ subQuery2 +"|" + subQuery3 + "|" + ...) 
```

我什至不知道在编译时会有多少子查询，所以我无法预测查询字符串会得到多长时间。

我宁愿避免为每个子查询多次调用 SelectNodes，因为我担心性能会更差（COM 编组开销到 MSXML、处理多个结果树而不是单个树等）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T12:17:34.803

我没有遇到任何这样的限制，我怀疑在运行查询的剪切成本使其无论如何都不可行之前你可以达到任何限制。

# asp.net - IIS7权限问题

> ID：590298
> 
> 赞同：1
> 
> 时间：2009-02-26T12:12:07.673
> 
> 标签：asp.net, security, iis, iis-7, permissions

我使用 II7 进行了正常的 Windows Server 2008 安装。每个网站都有自己的应用程序池。但是有一个安全相关的问题。

asp.net 应用程序将文件写入 C: 或任何其他目录没有任何限制。在 IIS 6 中，在这种情况发生之前，我必须在 windows 文件夹安全权限中设置这些权限，并允许 ASPNET_Usr 执行此操作。

托管 asp.net 应用程序并不允许它们在例如 c: 中写入读取文件的最佳做法是什么？

***编辑***

匿名授权。已启用并且指定的用户是“ISUR”。所有其他身份验证均被禁用。在应用程序池中，我用作进程标识“网络服务”。

我在服务器（不在域中）“www.xyz.test”上创建了一个新用户，并删除了他的所有组成员身份。将进程身份更改为该用户并使匿名身份验证使用应用程序池身份并且仍然能够写入 C:。

在我的情况下，更改信任级别不是一种选择，因为我们使用的是第 3 方应用程序

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T12:16:46.367

这完全取决于您的 asp.net 网站在哪个用户帐户上运行。即它是网络服务吗？据我所知，如果我希望能够写入 web 目录，那么我将仅授予我的网站帐户写入权限，以访问我想要保存文件的目录。我使用的帐户是用于匿名身份验证的帐户。

即我有一个名为 mycompany.com 的网站。我将此用户帐户创建为域用户组的一部分。我将其添加为匿名身份验证凭据，并授予它对 Web 根目录的访问权限，并对我也想编写的嵌套文件夹进行写入访问。

用户帐户将被称为 mycompany.com，因此我知道它仅对与 Web 和该特定网站相关的权限负责。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T12:22:07.540

听起来网站权限（在 IIS 中）设置为
- Windows 身份验证：并且您正在使用对这些文件夹具有权限的人登录
或
- 匿名身份验证：并且用于模拟的帐户具有权限

最佳做法是确保用于访问该站点的帐户（即，如果 Windows 身份验证 - 您的帐户，或者如果是匿名的，则被模拟的帐户）对文件夹没有权限。

您还可以在 machine.config 中将信任级别提高到中等、高或完全以获取其他安全强制策略 - 但请谨慎使用，因为它可能导致某些 ASP.NET 应用程序失败。

# netbeans - How to link opened file with project tree in NetBeans

> ID：590313
> 
> 赞同：30
> 
> 时间：2009-02-26T12:16:10.690
> 
> 标签：netbeans, netbeans6.5

I feel dumb asking this question, but I can't find solution to this myself.

When I open several files in editor and switch between them, I have problem finding currently opened file in project or files tree.

I used Eclipse before and every time I changed a tab with file, the project tree set focus for the same file. Is there a way to do something like this in NetBeans?

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-30T19:46:36.720

Just thought of adding what ax said:

The keyboard shortcuts in Windows are:

*   Select in Projects : `Ctrl+Shift+1`
*   Select in Files : `Ctrl+Shift+2`

The keyboard shortcuts in OS X are:

*   Select in Projects : `CMD+Shift+1`
*   Select in Files : `CMD+Shift+2`

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-08-19T10:31:33.083

As described in [NetBeans "link with editor" feature](https://stackoverflow.com/questions/1268046/netbeans-link-with-editor-feature), if you want the link to be permanent or persistent, use View | Synchronize Editor with Views. (In NetBeans >= 6.7.1, at least.)

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-02-26T12:43:19.407

from [http://forums.netbeans.org/topic3732.html](http://forums.netbeans.org/topic3732.html) :

You can do this from the navigate menu, I believe. There are entries for going to the file in the project tab or the file tab. I didn't see an option that allows you to do this automatically, like there is in Eclipse, but this menu entry allows you to do it upon request.

[edit]: also working: in the file > right mouse button > select in > projects | files | classes | favourites

[edit 2]: [http://forums.netbeans.org/topic8420.html](http://forums.netbeans.org/topic8420.html) : This feature is not available till NetBeans IDE 6.5\. This feature is added in the new version and may be available in NetBeans IDE 7.0M1 and after and you can find it in the View Menu.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-09-02T14:21:25.687

Navigate->Select in Files or Projects

# asp.net - asp.net windows 身份验证

> ID：590315
> 
> 赞同：3
> 
> 时间：2009-02-26T12:16:30.550
> 
> 标签：asp.net, windows, authentication

我需要哪些设置才能完成以下操作？

IIS6 服务器位于 Domain1

用户从 Domain2 访问，例如 Domain2\User

我想

```
WindowsIdentity ident = WindowsIdentity.GetCurrent(); 
```

返回 Domain2\User 而不是 Domain1\IUSR_SERVER

**当前的设置**

我已将 IIS 中的身份验证配置为“集成 Windows 身份验证”检查，其余的都清楚，这在与 IIS 服务器相同的服务器上工作正常。

在 web.config 中：

```
<authentication mode="Windows"/>
<identity impersonate="true"/> 
```

跨域这些设置提示登录。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T12:48:31.347

这两个域需要创建一个信任关系（如果它们是应该已经存在的同一个林的一部分），那么可能需要配置一些委派（这里说的是 AD 东西而不是 .NET）。

客户端和服务器之间的身份验证必须使用协商和 kerberos，这反过来意味着时钟需要彼此相隔 5 分钟，当两个域属于同一个林时，这也不应该成为问题。

# java - 在HashTable中查找Key的方法

> ID：590327
> 
> 赞同：2
> 
> 时间：2009-02-26T12:19:00.387
> 
> 标签：java, hashtable, loops

我正在尝试创建一个迭代哈希表并将键作为字符串返回的方法，最好的方法是什么？

编辑：从评论中复制

抱歉，如果我没有说得更清楚，我正在尝试在 Java 中执行此操作。我创建了一个测试类

```
public void runprog() {
    hashMap.put("Butter", 50);
    hashMap.put("Beans", 40);
    for (Object o: hashMap.entrySet() ) {
        Map.Entry entry = (Map.Entry) o;
        System.out.println(entry.getKey() + " " + entry.getValue());
    }
} 
```

它输出

```
黄油 50
豆类 40

```

我创建了一个查找键并返回值的方法

```
public Object findValue(String Name){
    for (Object o: hashMap.entrySet()) {
        Map.Entry entry = (Map.Entry) o;
        return entry.getValue();
    }
    return null;
} 
```

当我寻找 Butter 它返回 50 当我寻找 Beans 它返回 50

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-26T15:59:54.583

给定示例数据（“Butter”，“Beans”），这似乎是家庭作业......

在您的示例中， findValue 每次都返回地图/表中的第一个键。您甚至没有使用您输入的密钥（名称）。这是一个解决您的问题的示例，认为您以错误的方式使用地图。

一个更好的方法来做到这一点：

```
// assume Name is your key, ex. "Butter" 
// No need to iterate since maps are designed for lookup
Object value = map.get(Name); 
```

你的例子，固定：

```
public Object findValue(String Name){
    for (Object o: hashMap.entrySet()) {
        Map.Entry entry = (Map.Entry) o;

        // THIS IS THE IMPORTANT LINE
        if(entry.getKey().equals(Name))
        {
            return entry.getValue();
        }
    }
    return null;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-26T12:31:23.087

设置：

```
 final Object sentinal = new Object();

    Map<String, Object> map = new HashMap<String, Object>(){{
        put("key1", new Object());
        put("key2", sentinal);
    }}; 
```

给定一个键，找到一个值（查找）：

```
 System.out.println(map.get("key2") == sentinal); 
```

给定一个值，找到它的键（反向查找）：

```
 for(Map.Entry<String, Object> entry : map.entrySet()){
        if(entry.getValue() == sentinal){
            System.out.println(entry.getKey());
        }
    } 
```

...不过，如果我必须定期进行反向查找，我通常会构建一个反向映射：

```
 Map<Object, String> reverse = new HashMap<Object, String>();
    for(Map.Entry<String, Object> entry : map.entrySet()){
        reverse.put(entry.getValue(), entry.getKey());
    }
    System.out.println(reverse.get(sentinal)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T16:45:48.187

查看第二段代码，您实际上并没有在任何地方使用 Name 参数。所以发生的事情是，第一次循环时，条目的值被返回——第一个值恰好是 50。

您需要检查条目的键是否实际上等于您要查找的名称...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-01-13T15:34:26.933

使用 for 循环按值获取键是不省时的！！而且您不会从 HashTable 中受益。

因此，由于您想使用哈希表进行直接和反向检索，您可以使用两个哈希表。表 1（键、值） 表 2（值、键）

```
//Table1
hashtable1.put("Butter", 50);
hashtable1.put("Beans", 40);

//Table2
hashtable2.put(50, "Butter");
hashtable2.put(40, "Beans");

//Retrieving by key
System.out.println(hashtable1.get(50));

//Retrieving by value
System.out.println(hashtable2.get("Butter")); 
```

**输出**

* * *

黄油

50

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T12:40:32.160

抱歉，如果我没有说得更清楚，我正在尝试在 Java 中执行此操作。我创建了一个测试类

```
 public void runprog() {
    hashMap.put("Butter", 50);
    hashMap.put("Beans", 40);
    for (Object o: hashMap.entrySet() ) {
        Map.Entry entry = (Map.Entry) o;
        System.out.println(entry.getKey() + " " + entry.getValue());
    }
} 
```

它输出

```
Butter 50
Beans 40 
```

我创建了一个查找键并返回值的方法

```
 public Object findValue(String Name){
    for (Object o: hashMap.entrySet()) {
        Map.Entry entry = (Map.Entry) o;
        return entry.getValue();
    }
    return null;
} 
```

当我寻找 Butter 它返回 50 当我寻找 Beans 它返回 50

# c# - c# 正则表达式问题

> ID：590334
> 
> 赞同：1
> 
> 时间：2009-02-26T12:21:00.913
> 
> 标签：c#, regex

我想在这样的行中搜索一个值

```
<p align="center"><input type="hidden" name="e79e7ec" value="15302f565b"> 
```

我需要 name="" value 和 value="" value :P 创建此代码，但此代码无效

```
Regex rloginRand = new Regex(@"<p align=center><input type=hidden name=\w*");
            Match mloginRand = rloginRand.Match(source);
            string loginrand = "";
            if (mloginRand.Success)
            {
                 loginrand = mloginRand.ToString().Replace("<p align=center><input type=hidden name=", "");
            }
            string loginrnd = "";
            Regex rloginRnd = new Regex(@"name="+ loginrand+"value=\w*");
            Match mloginRnd = rloginRnd.Match(source);

            if (mloginRand.Success)
            {
                loginrnd = mloginRnd.ToString().Replace("name="+loginrand+" value=", "");
            } 
```

错误是

Form1.cs(71,69)：错误 CS1009：无法识别的转义序列

在这条线上

正则表达式 rloginRnd = new Regex(@"name="+ loginrand+"***value=\w****");

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T12:25:20.263

正则表达式并不总是 HTML 的最佳工具；我会使用[HTML Agility Pack](http://www.codeplex.com/htmlagilitypack)（因为它不是 xhtml）和 xpath - 那么它应该很简单：

```
 HtmlDocument doc = new HtmlDocument();
    doc.LoadHtml(html);
    HtmlNode node = doc.DocumentNode.SelectSingleNode("input");
    // read (if you want)
    string name = node.GetAttributeValue("name", ""),
        value = node.GetAttributeValue("value", "");
    // wipe
    node.SetAttributeValue("name", loginrand);
    node.SetAttributeValue("value", "");
    // get html
    html = doc.DocumentNode.OuterHtml; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T12:23:27.163

使用
`Regex rloginRnd = new Regex(@"name="+ loginrand+@"*value=\w**");`
注意：第二个@符号

或
`Regex rloginRnd = new Regex(@"name="+ loginrand+"*value=\\w**");`
注：双 \ 在 w 之前

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T12:23:28.380

您需要`@`在字符串的每个部分之前放置一个：

```
Regex rloginRnd = new Regex(@"name="+ loginrand+@"value=\w*"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T12:24:05.053

我不认为 @ 涵盖了整个字符串连接，只是它所在的那一点。

尝试。

```
Regex rloginRnd = new Regex(@"name="+ loginrand+ @"*value=\w**"); 
```

或者

```
Regex rloginRnd = new Regex(@"name="+ loginrand+ "*value=\\w**"); 
```

或使用 string.format

# .net - 接口上的属性有什么用？

> ID：590336
> 
> 赞同：4
> 
> 时间：2009-02-26T12:21:08.760
> 
> 标签：.net, attributes, interface

使用 Resharper，我提取了现有类的接口。这个类在一些成员上设置了一些属性，Resharper 也在接口成员上设置了这些属性。

我可以从界面中删除这些属性吗？实现接口时不会继承接口上的属性吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-26T12:37:03.930

它们不被实现类使用——但仍然可能很关键。例如，WCF 通过接口上的属性定义了 service-contracts 和 operation-contracts。

如果它们*在您的情况下*没有用，请删除它们。否则，别管他们；-p

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T12:32:51.990

它们不是继承的，但根据属性，您仍然可以做有趣的事情。例如，如果您使用 entlib 中的验证块，则可以使用接口上的属性对从它派生的所有类进行验证，而无需重新键入类的验证规则。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-27T07:47:10.560

我同意当类属性自动复制到提取的接口时，这很烦人。TeamCity youTrack 上有一个未解决的问题。有趣的是，它在 7（七！！！）年前就已经开放了，并且只有 3 票（包括我自己）。

如果同意，请点赞：
[提取接口将类属性属性移动到接口](http://youtrack.jetbrains.com/issue/RSRP-15211)

# c# - 使用 C# 访问 Sharepoint - 我在哪里可以找到参考库？

> ID：590346
> 
> 赞同：3
> 
> 时间：2009-02-26T12:23:35.227
> 
> 标签：c#, sharepoint, reference

我目前正在用 C# 编写一个 Windows 应用程序，它将文档添加到文档库列表中。我正在尝试引用 Microsoft.Sharepoint，但是我没有看到 Visual Studio 2005 中的 COM 或 .NET 库添加引用列表。我需要参考什么 dll，在哪里可以找到它？

谢谢，

亚历克斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-26T12:28:40.050

要访问文档库，我建议通过 SharePoint 公开的列表 Web 服务。从个人经验来看，这是最简单、最便携和可升级的方式。

所有 Web 服务和 .NET 库的文档也可以在[Windows 共享点服务的 Visual Studio 扩展中下载](http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=b2c0b628-5cab-48c1-8cae-c34c1ccbdc0a)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-26T12:31:47.923

要访问 SharePoint 库，您必须在项目中包含以下程序集：Microsoft.SharePoint.dll

您可以在 SharePoint Server 的 12 hives 文件夹下找到它：C:\Program Files\Common Files\Microsoft Shared\web server extensions\12\ISAPI

在那里，您可以找到更多 SharePoint 功能可能需要的程序集。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-26T12:43:45.133

你要开发什么样的应用程序？？？

如果它是一个将在不是 Sharepoint 目标计算机的计算机上执行的客户端应用程序，则您必须调用 SharePoint Web 服务来执行操作。

如果您的应用程序将在服务器、SharePoint 机器上执行，您可以使用 12 文件夹中的 dll。对于开发，您必须将 dll 复制到本地文件夹并将它们引用到您的项目中。要检查应用程序是否运行良好，必须在 SharePoint 机器上而不是在开发机器上执行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-26T12:30:11.390

我假设您使用的是 Sharepoint 2007，因此您可以在安装 SP 的 12 Hive 的 Bin 文件夹中找到库。这通常是：C:\program files\common files\microsoft shared\web server extensions\12

您将需要对 Microsoft.SharePoint.dll 的引用。

# java - preferenceChanged 方法中的 Java/Swing 堆栈溢出

> ID：590352
> 
> 赞同：2
> 
> 时间：2009-02-26T12:26:02.740
> 
> 标签：java, swing

我目前正在处理一个 Java 项目，并且遇到了堆栈溢出错误的问题。首先程序会读入一个大约 1,500,000 字的文件并将其添加到一个数组中。然后它读入一个大约 600 字的小文件并将其添加到一个数组中。它检查 600 字文件中有多少字出现在另一个文件中。大文件中的每个单词都与一个数字相关联。因此，当它在大文件中找到一个单词时，它会获取该单词及其相关整数的副本并将其添加到数组中。我的问题是我收到堆栈溢出错误：

`"AWT-EventQueue-0" java.lang.StackOverflowError`

问题是当小文件大约 200 字时，程序运行良好。程序必须执行的最后一行是：

```
result.setPage("file:file for gui NEW.html"); 
```

（其中结果是 JEditorPane）

出于某种原因，当小文件为 600 个字时，我得到一个 stackoverflow 错误，但在 200 个字时运行正常。它运行最后一行并生成此文件，但不会将其打印到编辑器窗格，因为那是异常开始的时候。

谁能帮助告诉我为什么会发生这种情况以及我该如何解决它？谢谢。

* * *

控制台中的完整错误是：

```
线程“AWT-EventQueue-0”中的异常 java.lang.StackOverflowError
    在 sun.awt.SunToolkit.getSystemEventQueueImplPP（未知来源）
    在 sun.awt.SunToolkit.getSystemEventQueueImpl（未知来源）
    在 java.awt.Toolkit.getEventQueue（未知来源）
    在 java.awt.EventQueue.isDispatchThread（未知来源）
    在 javax.swing.SwingUtilities.isEventDispatchThread（未知来源）
    在 javax.swing.JComponent.revalidate（未知来源）
    在 javax.swing.plaf.basic。
             BasicTextUI$RootView.preferenceChanged（未知来源）
    在 javax.swing.text.View.preferenceChanged（未知来源）
    在 javax.swing.text.BoxView.preferenceChanged（未知来源）
    在 javax.swing.text.View.preferenceChanged（未知来源）
    在 javax.swing.text.BoxView.preferenceChanged（未知来源）
    在 javax.swing.text.View.preferenceChanged（未知来源）
    在 javax.swing.text.BoxView.preferenceChanged（未知来源）
    （......永远重复......）

```

**编辑：**所以基本上看起来 GUI 中的两个控件不断调用彼此的`preferenceChanged()`方法。

* * *

Gui 似乎是最可能的原因，因为当我在没有 gui 的情况下运行程序并将文件的内容打印到控制台时，它可以正常工作。我不知道究竟是什么导致了这个问题。我没有使用偏好更改例程。只有像 setSize()、setVisible() 等这样的东西会导致它吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-26T12:28:26.230

你在某处有递归函数吗？这通常是堆栈溢出的根源。

[附加信息在这里](http://danzig.jct.ac.il/java_class/recursion.html)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-26T13:29:21.310

我认为您遇到了这个问题的变体：

[http://www.jdocs.com/harmony/5.M5/javax/swing/text/BoxView.html#M-layout(int,int)](http://www.jdocs.com/harmony/5.M5/javax/swing/text/BoxView.html#M-layout(int,int))

> `protected void layout ( int width, int height )`
> 
> 如果在每个布局上尝试子项更改其首选项，则此方法可能会导致堆栈溢出，即调用 preferenceChanged。

我不确定你是如何做到这一点的，但尽量不要改变孩子对布局的偏好。我敢肯定，比我有更多挥杆经验的人可以提供更有价值的答案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-26T13:20:11.737

堆栈溢出在 GUI 对象的 preferenceChanged() 例程中。罪魁祸首是你的 GUI 正在做的事情，你的数组使用只是触发器。

您是否对任何 GUI 对象进行子类化，尤其是在任何地方具有您自己的 preferenceChanged() 函数的对象？最好的猜测是它与显示滚动条有关，因为异常取决于您要添加到此数组中的对象数量。仔细检查文档以了解您正在使用的任何 GUI 对象或事件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T12:34:33.047

查看 StackOverflowError 的堆栈跟踪。它几乎肯定会向您展示一种或两种重复调用自身/彼此的方法。重写这些方法，这样就不会发生（或不会经常发生）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-26T15:26:00.780

我会检查正在输出的文件，因为递归似乎是在 JEditorPane 中而不是在您的代码中发生的 - 这个文件是否显示在普通的 Web 浏览器中好吗？请记住，JEditorPane 不是世界上最先进的组件，如果您试图展示复杂的东西，可能会窒息。

我在 JEditor 窗格中也遇到过布局错误，这些错误似乎是随机发生的，我从来没有找到底部，尽管这通常是在我编辑窗格的内容而不是仅仅显示网页时。

如果您在加载文件时更改窗口的大小，则可能会导致您所描述的各种错误 - 我会尝试将文件加载到编辑器窗格中而不更改它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-26T12:33:34.220

假设您可以在 Eclipse 上附加调试器（对不起，我不知道 Netbeans/Idea），您可以为 StackOverflowError 添加异常断点。在断点视图的工具栏中，有一个带有感叹号的蓝色 J 按钮 - “J！” - 单击此按钮，然后输入 StackOverflowError 并选择仅在未捕获的异常时暂停。

也许这将提供更多关于出了什么问题的背景信息。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-26T12:37:30.200

如果这是一个递归问题，那么您可以尝试使用使用显式堆栈而不是[BFS](http://en.wikipedia.org/wiki/Breadth-first_search)或[DFS等隐式堆栈的新算法来更改您的算法](http://en.wikipedia.org/wiki/Depth-first_search)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-02-26T12:30:40.170

您应该检查递归 - 直接递归（当函数调用自身时）和间接递归（当 A 调用 B 并且 B 再次调用 A 时）。

最简单的方法是附加一个调试器并在堆栈溢出时查看调用堆栈。

# c++ - 用 new 分配大块内存

> ID：590362
> 
> 赞同：6
> 
> 时间：2009-02-26T12:28:00.537
> 
> 标签：c++, memory, new-operator, bad-alloc

我需要用 new 分配大块内存。

我坚持使用 new 因为我正在为两部分应用程序的生产者端编写一个模拟。实际的生产者代码正在分配这些大块，我的代码有责任删除它们（在处理它们之后）。

有没有办法可以确保我的应用程序能够从堆中分配如此大量的内存？我可以将堆设置为更大的大小吗？

我的情况是 64 个 288000 字节的块。有时我要分配 12 个，而其他时候我要分配 27 个。我得到一个 std::bad_alloc 异常。

这是：C++，Linux 上的 GCC（32 位）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-26T16:59:18.373

关于C++/GCC/Linux(32bit) 中的*新功能...*

已经有一段时间了，它依赖于实现，但我相信*new*会在幕后调用*malloc()*。 *Malloc()*，除非您要求超出进程地址空间或超出指定（*ulimit/getrusage*）限制的内容，否则不会失败。即使您的系统没有足够的 RAM+SWAP。例如： 我相信，在具有 256Meg RAM + 0 SWAP 的系统上*malloc(1gig)会成功。*

但是，当您使用该内存时，内核会通过延迟分配机制提供页面。那时，当您第一次读取或写入该内存时，如果内核无法为您的进程分配内存页面，它会杀死您的进程。

当您的同事的核心泄漏速度较慢时，这可能是共享计算机上的问题。特别是当他开始淘汰系统进程时。

因此，您看到 std::bad_alloc 异常的事实是“有趣的”。

现在*new*将在分配的内存上运行构造函数，在它返回之前接触所有这些内存页面。根据实现，它*可能*会捕获内存不足信号。

你用普通的 o'l *malloc*试过这个吗？

您是否尝试过运行“*免费*”程序？你有足够的可用内存吗？

正如其他人所建议的那样，您是否检查了*limit/ulimit/getrusage()*的硬约束和软约束？

你的代码到底是什么样的？我猜是*新的 ClassFoo [ N ]*。或者也许是*new char [N]*。

什么是*sizeof(ClassFoo)*？什么是*N*？

对于大多数现代机器来说，分配 64*288000 (17.58Meg) 应该是微不足道的……您是在嵌入式系统上运行还是在其他特殊的系统上运行？

或者，您是否与自定义*新*分配器链接？你的班级有自己的*新*分配器吗？

您的数据结构（类）是否分配其他对象作为其构造函数的一部分？

有人篡改了您的库吗？您是否安装了多个编译器？您是否使用了错误的包含或库路径？

您是否链接过时的目标文件？您是否只需要重新编译所有源文件？

你能创建一个简单的测试程序吗？仅仅几行代码就可以重现该错误？还是您的问题在其他地方，只出现在这里？

--

对于它的价值，我已经在 g++ 下的 32 位 linux 中分配了超过 2gig 的*新数据块。*你的问题在别处。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-26T12:44:38.203

您可能受到进程 ulimit 的限制；运行`ulimit -a`并检查虚拟内存和数据段大小限制。除此之外，您能否发布您的分配代码，以便我们了解实际情况？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T20:18:52.527

更新：

我已经修复了一个数组索引错误，现在它正在正确分配。

如果我不得不猜测......我在我的堆中走来走去并且正在搞乱malloc的数据结构。（？？）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T16:23:50.657

我建议在程序启动时分配所有内存并使用新位置来定位缓冲区。为什么要采用这种方法？好吧，您可以手动跟踪碎片等。没有可移植的方法来确定可以为您的进程分配多少内存。我很肯定有一个特定于 linux 的系统调用可以为您提供该信息（想不出它是什么）。祝你好运。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T18:00:54.683

当您在不同时间运行程序时会出现不同的行为，这一事实让我认为分配代码不是真正的问题。相反，其他人正在使用内存，而您是金丝雀，发现它丢失了。

如果那个“其他人”在你的程序中，你应该可以使用[Valgrind](http://valgrind.org/)找到它。

如果其他人是另一个程序，您应该能够通过转到不同的[运行级别](http://www.redhat.com/docs/manuals/enterprise/RHEL-4-Manual/en-US/Reference_Guide/s1-boot-init-shutdown-sysv.html)来确定这一点（尽管您不一定知道罪魁祸首）。

# c++ - dynamic_cast 失败

> ID：590371
> 
> 赞同：6
> 
> 时间：2009-02-26T12:30:20.937
> 
> 标签：c++, dynamic-cast

我有一个基类和一个派生类。每个类都有一个 .h 文件和一个 .cpp 文件。

我正在以下代码中将基类对象动态转换为派生类：

h 文件：

```
class Base
{
  public:
    Base();
    virtual ~Base();
};

class Derived : public Base
{
  public:
    Derived(){};
    void foo();
};

class Another
{
  public:
    Another(){};
    void bar(Base* pointerToBaseObject);
}; 
```

cpp 文件：

```
Base::Base()
{
    //do something....
}
Base::~Base()
{
    //do something....
}
void Derived::foo()
{
    Another a;
    a.bar(this);
}
void Another::bar(Base* pointerToBaseObject)
{
    dynamic_cast<Derived*>(pointerToBaseObject)
} 
```

由于某种奇怪的原因，转换失败（返回 NULL）。但是，如果我将 Derived 类的构造函数的实现从 .h 移动到 .cpp 文件，则转换成功。

什么会导致它？

编译器是 gcc 3.1，在 Linux-SUSE 上。顺便说一句，我只在这个平台上看到这种行为，并且相同的代码在 Visual Studio 中运行良好。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-26T12:44:16.487

Base有虚函数吗？否则它将无法正常工作。如果不出意外，请将其 dtor 设为虚拟。

不知道是否已经被删除他的答案的其他人问过，但我相信这是不同的：你是从基地的构造函数做 dynamic_cast 吗？如果是这样，那就行不通了。编译器会认为 Base 是派生最多的类型，类似于调用虚函数并最终调用 Base 的版本。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-26T13:21:03.060

如果您在基类中有一个虚函数（正如 litb 指出的那样），那么发布的代码应该不会失败。

但我相信，如果你没有，每个当前的编译器都会产生“基类不是多态”的错误，所以这可能不是问题。

我唯一能想到的是，由于一些奇怪的错误，所有内容都被内联并且没有生成任何 vtable。但是如果你将构造函数放在 C++ 文件中，编译器会决定不内联所有内容，从而触发 vtable 的创建，从而使你的强制转换工作。

但这是非常疯狂的猜测，我认为任何编译器都不会出现这样的错误（？）

如果您想要一个明确的答案，请发布更多代码。以及使用的编译器/平台。

编辑：查看更新的代码

我认为您至少应该从 Base 派生；）（我想这是一个错字）

但是在看到代码之后，我唯一能想到的是 gcc（错误地）内联了所有内容并且不会为 Derived 生成 vtable。对于它的价值，它运行良好，用 gcc 4.0 编译

3.1 到现在已经超过 7 年了......如果有任何升级的可能性，我会去的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-26T13:27:19.100

将析构函数设为虚拟，并将其（或至少一种虚拟方法）放在 .cpp 文件中。

一些编译器（阅读：gcc）寻找第一次遇到的非内联虚方法体并使用它来决定将虚方法表放在哪里。如果在 .cpp 文件中没有任何带有主体的虚拟方法，则不会创建虚拟方法表。

您必须至少有一种虚拟方法才能使 dynamic_cast 工作。动态转换使用表来计算类型信息，如果没有虚拟方法，则不会创建表。

如果你有一个你希望被子类化的类并且它有一个析构函数，或者如果这个类有任何实例变量是带有析构函数的类，那么你真的想让你的析构函数成为虚拟的（即使它有一个空的主体） . 否则，子类实例不会发生您期望的清理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T13:35:55.880

您是在 Visual C++ 中执行此操作吗？我认为您过去必须在编译器设置中启用运行时类型信息 (RTTI) 才能使其正常工作。

如果我错了，请不要喷我。好久没用C++了！！！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T14:34:06.397

在查看您的代码时，我没有看到任何继承。你忘了这样做吗？派生不是从任何东西派生的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-26T14:36:31.257

在您发布的代码中，Derived 不是从 Base 派生的。

**编辑：** 仅供参考，修改后的代码适用于 g++ 3.4.5

# security - 如何从客户网站安全地收集数据

> ID：590375
> 
> 赞同：0
> 
> 时间：2009-02-26T12:32:18.030
> 
> 标签：security

我需要向我的客户提供一个代码片段，他们可以将其添加到他们的网站，类似于谷歌分析代码，例如

```
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker("UA-xxxxxx-x");
pageTracker._trackPageview();
} catch(err) {}
</script> 
```

但我需要它从客户电子商务网站收集一些价值。他们会将代码添加到他们的站点，然后我们将接收这些值并将它们添加到我们的 sql 数据库中。他们将根据我们提供给他们的代码提供客户端或服务器端的值。

谁能建议一种安全的方法来做到这一点？就客户而言，越简单越好。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-26T12:40:51.567

Javascript 是客户端技术。因为浏览器不允许跨站点脚本，您的客户端必须托管脚本，以便它可以访问页面的其余部分。它当然不能访问服务器上的电子商务应用程序，因为它在客户端上运行。可以想象，它可以向电子商务服务器发出 Ajax 请求以获取数据，但这意味着您需要在服务器上放置可以处理此类请求的代码，并且完全在服务器端执行此操作是有意义的。我不确定您要收集什么样的信息，但似乎您可以在客户端上收集的信息不多。

无论如何，当您的 Javascript 在用户的浏览器中呈现时，它可以向您自己的站点发送请求，例如通过插入不可见的图像，并在查询字符串中传递信息 - 这是不安全的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T13:57:35.033

您将需要在服务器端执行此操作。出于安全原因，浏览器要么不允许在 ssl 会话中发布到另一个站点，要么向用户提供一个非常可爱的安全警告，让他们感觉自己被黑客入侵了。

我会在您的服务器上创建一个 Web 服务，并为客户端提供一些示例代码以从他们的服务器调用它。

# apache-flex - 如何从文件中加载 WSDL

> ID：590378
> 
> 赞同：1
> 
> 时间：2009-02-26T12:33:00.057
> 
> 标签：apache-flex, web-services, actionscript, air

我正在尝试节省一些带宽并在我的 flex/air 应用程序中包含 wsdl 文件。我应该使用哪种 url 格式来加载该文件而不是远程文件。

我正在使用**loadWSDL** () 方法。

编辑：wsdl 文件需要是应用程序的一部分。我知道我可以将 file://some/path 用于本地文件，但不知道如何加载应用程序本身内部的文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T12:49:00.580

如果文件是本地文件，只需使用[文件 URI 方案](http://en.wikipedia.org/wiki/File_URI_scheme)：

`file://host/path/file.wsdl`

如果这不起作用，请检查[安全沙盒](http://livedocs.adobe.com/flex/3/html/help.html?content=05B_Security_02.html)功能是否阻止它。

在 AIR 应用程序中，为了访问应用程序的[临时存储目录](http://livedocs.adobe.com/flex/3/langref/flash/filesystem/File.html#applicationStorageDirectory)或[应用程序自己的目录](http://livedocs.adobe.com/flex/3/langref/flash/filesystem/File.html#applicationDirectory)中的文件，您需要使用特殊`app:`或`app-storage:`URL 方案。

就像直接说的那样，您始终可以将文件嵌入到应用程序中，但据我所知，之后您将无法以持久的方式对其进行修改，因为它不仅仅是文件系统中的文件。可能对您来说最好的选择是嵌入此文件，如果您以后需要更新它，让应用程序将更新的版本保存到其中`File.applicationStorageDirectory`（然后您总是会在使用默认嵌入版本之前先检查它。）虽然我不知道如果使用带有 WebService 类的嵌入式 XML 文件甚至是可能的。

有关如何将外部 XML 文件嵌入您的应用程序的信息，请参阅[本文。](http://dispatchevent.org/roger/embed-almost-anything-in-your-swf/)这就是我的做法：

```
// note: common sense says that the mimeType should be "text/xml" here but
// it doesn't work -- this does, though. who knows why.
[Embed(source="File.xml", mimeType="application/octet-stream")]
private const _fileXMLClass:Class;
private var _fileXML:XML = XML(new _fileXMLClass()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T13:02:11.373

> wsdl 文件必须是应用程序的一部分。

您是否尝试过将其作为资源嵌入到 Flex/AIR 项目中？读[这个](http://livedocs.adobe.com/flex/3/html/help.html?content=projects_5.html)。例如，您可以通过指定以下内容来加载应用程序附带的静态图像`source`：

```
source="@Embed(source='relativeOrAbsolutePath')" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T15:34:13.007

Uf，这很难看，所以我正在回答参考。感谢您对 hasseg 和 dirkgently 的见解

这是代码。

首先，声明变量：

```
[Embed(source="/ws/wsdl/LoginService.wsdl", 
       mimeType="application/octet-stream")]
private const _fileXMLClass:Class;
private var _fileXML:XML = XML(new _fileXMLClass()); 
```

然后，加载 wsdl：

```
var file : File = dir.resolvePath(name + ".xml");
var stream : FileStream = new FileStream();
stream.open(file, FileMode.WRITE);
stream.writeUTFBytes(getWsdl().toXMLString());
stream.close();
loadWSDL(file.url); 
```

如果有人有想法让它不那么难看，请告诉我。

编辑：我刚刚注意到编辑过的答案，所以代替这段代码就足够了：

```
loadWSDL('app:///path/to/my/file.wsdl'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-29T14:02:35.480

我在 flash builder air 移动应用程序中使用以下代码，它可以工作，可能会有所帮助。我使用 url 加载程序从 Web 服务获取文件内容，并将其写入我的 air 应用程序文档目录中的 xml 文件。

```
var url:URLRequest = new URLRequest(Globals.deviceSettings.endpoint);
                loader.load(url);
                loader.addEventListener(Event.COMPLETE, loaderComplete); 
```

获取 Web 服务的状态，如果是 200 则可用并抬头。 `loader.addEventListener(HTTPStatusEvent.HTTP_STATUS, ldrStatus);`

在事件监听器中

```
function loaderComplete(e:Event):void
            {

                    var f:File= File.documentsDirectory.resolvePath("source/category.xml");
                    var _xml:XML = new XML(loader.data);
                    var fs:FileStream = new FileStream();
                    fs.open(f, FileMode.WRITE);
                    fs.writeUTFBytes(_xml.toXMLString());
                    fs.close();
                    popup.close(true);
                    var popup:MyPopupComponent = new MyPopupComponent();
                    popup.show("Successfully updated from the server",this);
                    popup.close();
            } 
```

您可以根据需要使用 file.documentdirectory 或 applicaiton 或您选择的目录，请记住，为了安全起见，某些路径是只读的。如果您想写回这些文件，您将无法做到，但仅出于阅读目的，最好将文件放在那里。

# sharepoint - Sharepoint 中的授权和变体有问题吗？

> ID：590379
> 
> 赞同：1
> 
> 时间：2009-02-26T12:33:11.990
> 
> 标签：sharepoint, sharepoint-2007

您好，我在 Sharepoint 中有一个使用变体的网站。我有不同的网站：ES、CA、EU、EN。我对角色使用授权，并在 web.config 中的位置标记中设置了限制。这是行不通的。大家可以进入es/admin。

```
<location path="es/admin">
    <system.web>
      <authorization>
        <allow roles="administrators" />
        <deny users="*" />
      </authorization>
    </system.web>
  </location> 
```

但是，如果我使用一个不是变体的网站，例如，像这样：

```
<location path="prueba">
    <system.web>
      <authorization>
        <allow roles="administrators" />
        <deny users="*" />
      </authorization>
    </system.web>
  </location> 
```

它有效，有一个重定向。

如果这是不可能的，请提供替代方案，我使用自定义会员提供程序和角色提供程序，那么我如何将这个站点的变体限制为仅一个组？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-26T12:37:06.850

这是因为变量不是实际位置，因此 web.config 选项将不起作用 - 它们是一个小 url 技巧，用于定义从数据库中读取的内容。

# java - 如何在Java中获取特定年份的所有星期日日期？

> ID：590385
> 
> 赞同：1
> 
> 时间：2009-02-26T12:35:08.990
> 
> 标签：java, date

我正在认真寻找这段代码......我是新程序员。

实际上，我想用标志制作所有日期，这些日期都是特定年份的星期日。

拜托，我热切地等待你的回应......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-26T12:53:42.800

创建一个新日历。将时间设置为 1/1/yyyy 和一些时间。检查当前日期是否为星期日并前滚一天直到它是。那是一年中的第一个星期日。前滚 7 天，直到年份不再匹配，随时标记。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-26T12:42:00.253

仔细研究[java.util.Calendar 的文档。](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Calendar.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-26T12:55:44.493

如果我这样做，我会使用[Joda Time](http://joda-time.sourceforge.net)使用 LocalDate 找到一年中的第一个星期日。创建 1 月 1 日，然后添加 1 天，直到它是星期日，然后添加 7 天，直到您用完一年。

```
LocalDate date = new LocalDate(YEAR, 1, 1);
while ( date.dayOfWeek() != 7 )
{
  date = date.addDays(1);
}

while ( date.year() == YEAR )
{
  date = date.addDays(7);
} 
```

或类似的东西。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-26T13:04:26.457

像这样的东西应该工作。

```
int year = 2009;
Calendar cal = new GregorianCalendar(year, Calendar.JANUARY, 1);
for (int i = 0, inc = 1; i < 366 && cal.get(Calendar.YEAR) == year; i+=inc) {
    if (cal.get(Calendar.DAY_OF_WEEK) == Calendar.SUNDAY) {
        // this is a sunday
        cal.add(Calendar.DAY_OF_MONTH, 7); 
        inc = 7;
    } else {
        cal.add(Calendar.DAY_OF_MONTH, 1);
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-26T13:04:43.350

这是一个使用 java.util.Calendar 和 java.util.GregorianCalendar 的示例代码，它会打印出 2009 年的每个星期日。在格式化日期时可以进行很多优化，但我将把它留给你作为练习.

```
import java.util.Calendar;
import java.util.GregorianCalendar;

public class Test
{
    public static void main(String[] args)
    {
        int year =2009;
        int dayOfWeek = Calendar.SUNDAY;
        String dayOfWeekString = "Sunday";
        // instantiate Calender and set to first Sunday of 2009
        Calendar cal = new GregorianCalendar();
        cal.set(2009, 0, 1, 0, 0); cal.getTime();
        cal.set(Calendar.DAY_OF_WEEK, dayOfWeek); cal.getTime();
        int i = 1;
        while (cal.get(Calendar.YEAR) == 2009)
        {
            System.out.println(dayOfWeekString + " " + i + ": " + cal);
            cal.add(Calendar.DAY_OF_MONTH, 7);
            i++;
        }
    }
} 
```

如您所见，TiGz 使用 Joda Time 的方式要简单得多。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-09-01T01:53:59.353

# java.time

Java 8 及更高版本带有新的 java.time 包。受[JSR 310](https://jcp.org/en/jsr/detail?id=310)定义的[Joda-Time启发，由](http://www.joda.org/joda-time/)[ThreeTen-Extra](http://www.threeten.org/threeten-extra/)项目扩展。这些新类取代了臭名昭著的麻烦 java.util.Date/.Calendar & java.text.SimpleDateFormat 等。

请注意，我们指定了一个时区，这对于确定日期至关重要。例如，巴黎的新一天比蒙特利尔更早。

```
ZoneId zoneId = ZoneId.of( "America/Montreal" );  // Time zone is crucial in determining the date. A new day dawns earlier in Paris than In Montréal, for example. 
```

您将编写此代码以仅[`LocalDate`](http://docs.oracle.com/javase/8/docs/api/java/time/LocalDate.html)在没有任何时间的情况下使用。但在业务中，完整的日期时间通常更有用。所以我这里的例子使用[`ZonedDateTime`](http://docs.oracle.com/javase/8/docs/api/java/time/ZonedDateTime.html).

为了简洁起见，我希望将一天中的时间设置为一天中的第一刻。您可能会认为这意味着`00:00:00.0`但并不总是因为[Daylight Saving Time](http://docs.oracle.com/javase/8/docs/api/java/time/LocalDate.html)等异常情况。为了对这第一刻进行软编码，我们要调用[`atStartOfDay`](http://docs.oracle.com/javase/8/docs/api/java/time/LocalDate.html#atStartOfDay-java.time.ZoneId-)在 LocalDate 上找到的方法。所以我们从 开始[`LocalDate`](http://docs.oracle.com/javase/8/docs/api/java/time/LocalDate.html)，然后使用那个方法来获取一个`ZonedDateTime`对象。

再次注意，我们在获取今天的日期时指定了一个时区。一个非常常见的错误是省略时区。省略时，将隐式应用 JVM 当前的默认时区。这意味着您的结果可能因机器或管理员设置而异。更糟糕的是，这个 JVM 中任何应用程序的任何线程中的任何代码都可以在运行时的任何时刻调用以更改该默认时区，**而您的应用程序正在执行**！所以总是指定而不是隐式依赖当前的默认值。

```
LocalDate today = LocalDate.now( zoneId );  // We want a ZonedDateTime, but starting with a LocalDate in order to get first moment of the day (see next line).
ZonedDateTime todayStart = today.atStartOfDay( zoneId );  // Set time-of-day to first moment of this date, just to be neat. Usually that time is '00:00:00.0' but not always. 
```

java.time 框架包括一些方便的[TemporalAdjustors](http://docs.oracle.com/javase/8/docs/api/java/time/temporal/TemporalAdjusters.html)来获取一年中的第一天，以及从那里获取该月的第一个星期日。

```
ZonedDateTime firstOfThisYear = todayStart.with( TemporalAdjusters.firstDayOfYear( ) );
ZonedDateTime zdtFirstOfNextYear = firstOfThisYear.with( TemporalAdjusters.firstDayOfNextYear( ) );
ZonedDateTime firstSundayOfThisYear = firstOfThisYear.with( TemporalAdjusters.dayOfWeekInMonth( 1, DayOfWeek.SUNDAY ) ); 
```

现在我们将循环遍历一年中的所有星期。我们一次增加一周，直到我们发现自己在下一年。我们收集每个星期天的[`List`](http://docs.oracle.com/javase/8/docs/api/java/util/List.html).

```
ZonedDateTime zdt = firstSundayOfThisYear; // Var changing throughout loop.
List< ZonedDateTime > sundays = new ArrayList<>( 53 );  // Set initial capacity to maximum number of values.
while ( zdt.isBefore( zdtFirstOfNextYear ) ) {
    // Handle this iteration.
    sundays.add( zdt );
    System.out.println( "Sunday # " + sundays.size( ) + " : " + zdt );
    // Prepare next iteration.
    zdt = zdt.plusWeeks( 1 );
} 
```

跑的时候。

```
Sunday # 1 : 2015-01-04T00:00-05:00[America/Montreal]
Sunday # 2 : 2015-01-11T00:00-05:00[America/Montreal]
…
Sunday # 51 : 2015-12-20T00:00-05:00[America/Montreal]
Sunday # 52 : 2015-12-27T00:00-05:00[America/Montreal] 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-08-31T12:50:03.973

```
List arrList = new ArrayList();
SimpleDateFormat format1 = new SimpleDateFormat("dd-M-yyyy");
Date date = null;
Calendar cal = Calendar.getInstance();

for (int i = 0; i <= 51; i++) 
{
    try 
    {
        cal.add(Calendar.WEEK_OF_YEAR, +1);
        cal.set(Calendar.DAY_OF_WEEK, Calendar.SUNDAY);
        String formatted = format1.format(cal.getTime());
        date = format1.parse(formatted);
        arrList.add(date);
    } catch (Exception e) {
        e.printStackTrace();
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-26T12:51:44.100

一年大约有 365 天，因此 Big-O 的*n*非常易于管理。我会说只是从年初到最后一天迭代，并检查每一天是否是星期天。

你至少需要[`Calendar.get()`](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Calendar.html#get(int)),[`Calendar.DAY_OF_WEEK`](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Calendar.html#DAY_OF_WEEK)和[`Calendar.SUNDAY`](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Calendar.html#SUNDAY)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-06-29T20:01:39.297

我最近开发了 [Lamma Date]，旨在服务于此类用例。

以下代码将打印出 2014 年的所有星期日：

```
List<Date> sundays2014 = Dates.from(2014, 1, 1).to(2014, 12, 31).byWeek().on(DayOfWeek.SUNDAY).build();

for(Date date: sundays2014) {
    System.out.println(date);
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-05-28T10:31:21.730

**这将给你一年中的所有星期日**

> 由我和朋友赫曼特发明

```
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.GregorianCalendar;

public class Test {

    public static void main(String[] args) {

        SimpleDateFormat format =new SimpleDateFormat("dd-MMM-yyyy");
        String DATE_FORMAT = "yyyy MM dd";

        SimpleDateFormat sdf = new SimpleDateFormat(DATE_FORMAT);
        Calendar c1 = Calendar.getInstance(); // today

        String y=sdf.format(c1.getTime());
        String years=y.substring(0,4);
        int year=Integer.parseInt(years);
        //Connection con=null;

        Calendar cal = new GregorianCalendar(year, Calendar.JANUARY, 1);
        for (int i = 0, inc = 1; i <366 && cal.get(Calendar.YEAR) == year; i+=inc) {
            if (cal.get(Calendar.DAY_OF_WEEK) == Calendar.SUNDAY) {
                // this is a sunday
                String frm="";
                frm=format.format(cal.getTime());
            //System.out.println("From  :"+frm);

                  System.out.println("the value of the sunday is "+format.format(cal.getTime()));
                cal.add(Calendar.DAY_OF_MONTH, 7);   
            } else {
                cal.add(Calendar.DAY_OF_MONTH, 1);
            }

        }
    }
} 
```

# c# - 如果正在运行，检测并重新激活我的应用程序 - 紧凑的框架

> ID：590402
> 
> 赞同：1
> 
> 时间：2009-02-26T12:42:20.673
> 
> 标签：c#, compact-framework

通常，移动开发人员不必这样做，因为智能最小化功能可以处理它。

但我需要自己做，因为我的移动应用程序是由引导应用程序启动的。

开始菜单图标启动 bottstrapper，它从 Web 服务下载目标版本，启动它然后关闭。如果应用程序由于某种原因被最小化，用户通常会使用开始菜单图标再次激活它。但是，这会启动引导程序并生成客户端的第二个副本。

对于桌面应用程序，这个问题在网络上随处可见（实际上在这个站点上）。通常引用的解决方案是结合使用 Process.GetProcessesByName 与 API 调用的组合，以便在找到后重新激活进程。另一种解决方案是创建一个控制器类，该类继承自一些我忘记了名称的 VisualBasic dll。我今天遇到的所有解决方案都不受comapct 框架的支持。

所以实际的问题是：

是否有替代 Process.GetProcessesByName 的紧凑框架？

如果没有，我必须执行什么 API 调用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T12:56:34.413

我不确定您是否找到了这个，但 MSDN 有一篇关于创建[流程管理器应用程序](http://msdn.microsoft.com/en-us/library/aa446560.aspx)的文章，该应用程序包含我认为您需要的信息。

这篇文章推荐使用 toolhelp.dll 并有一个非常详细的演练，用于获取正在运行的进程列表。它适用于 Visual Studio 2003，因此您可能对正在运行的任何版本的 VS.NET 都感到满意。

# java - Java中没有泛型参数的泛型方法

> ID：590405
> 
> 赞同：37
> 
> 时间：2009-02-26T12:43:48.110
> 
> 标签：java, generics

在 C# 中，我实际上可以这样做：

```
//This is C#
static T SomeMethod<T>() where T:new()
{
  Console.WriteLine("Typeof T: "+typeof(T));
  return new T();
}

//And call the method here
SomeMethod<SomeClassName>(); 
```

但由于某种原因，我无法让它在 Java 中工作。

我想做的是，在超类上创建一个静态方法，以便子类可以转换为 XML。

```
//This is Java, but doesn't work
public static T fromXml<T>(String xml) {
  try {
    JAXBContext context = JAXBContext.newInstance(T.class);
    Unmarshaller um = context.createUnmarshaller();
    return (T)um.unmarshal(new StringReader(xml));
  } catch (JAXBException je) {
    throw new RuntimeException("Error interpreting XML response", je);
  }
}

//Also the call doesn't work...
fromXml<SomeSubObject>("<xml/>"); 
```

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-02-26T12:51:20.323

```
public static <T> T fromXml(Class<T> clazz, String xml) { 
```

称为：

```
Thing thing = fromXml(Thing.class, xml); 
```

或更明确地说：

```
Thing thing = MyClass.<Thing>fromXml(Thing.class, xml); 
```

更令人困惑的是，您可以拥有既构造泛型类型又具有自身泛型参数的构造函数。不记得语法并且从未见过它在愤怒中使用（无论如何，您可能最好使用静态创建方法）。

演员表`(T)`是不安全的，你不能写 T.class。因此，将 T.class 作为参数包含在内（就像`JAXBContext.newInstance`这样），如果类型错误，则抛出相关异常。

```
public static <T> T fromXml(Class<T> clazz, String xml) {
    try {
        JAXBContext context = JAXBContext.newInstance(clazz);
        Unmarshaller um = context.createUnmarshaller();
        Object obj = um.unmarshal(new StringReader(xml));
        try {
            return clazz.cast(obj);
        } catch (ClassCastException exc) {
             throw new RelevantException(
                 "Expected class "+clazz+
                  " but was "+obj.getClass()
             );
        }
    } catch (JAXBException exc) {
        throw new RelevantException(
            "Error unmarshalling XML response",
            exc
         );
    }
} 
```

我相信 JAXB 的下一个版本（在 6u14 中？）在课堂上为这类事情提供了一些方便的方法`JAXB`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-26T12:52:22.320

在 Java 中，泛型是仅编译时的数据，在运行时会丢失。因此，如果您调用这样的方法，JVM 将无法知道是什么`T.class`。解决这个问题的常规方法是将类实例对象作为参数传递给方法，如下所示：

```
public static <T> T fromXml(Class<T> clazz, String xml) {
  try {
    JAXBContext context = JAXBContext.newInstance(clazz);
    Unmarshaller um = context.createUnmarshaller();
    return (T)um.unmarshal(new StringReader(xml));
  } catch (JAXBException je) {
    throw new RuntimeException("Error interpreting XML response", je);
  }
}

fromXml(SomeSubObject.class, "<xml/>"); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-11-05T20:53:54.460

像 Java 这样的方法`Collections.emptySet()`有这样的签名：

```
public static final <T> Set<T> emptySet() 
```

并被称为：

```
Set<Foo> foos = Collections.<Foo>emptySet(); 
```

Mockito 的`anyObject()`方法是另一个例子。我个人认为这两种语法都不是很棒。将类型作为方法参数传递是可行的，但总是感觉很笨拙。以看起来更简洁的方式提供参数，`emptySet()`但方法允许指定类型并不总是很明显。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T13:30:36.470

恐怕您正在尝试做的事情在 Java 中根本行不通。无法创建泛型类型的新实例是 .NET 在缺少 Java 时提供的那些“必备”功能之一。这会导致前面建议的“变通办法”。查看`ArrayList.toArray(T)`作为参考如何做到这一点：本质上，您必须将引用传递给您尝试创建的对象，以便您知道在运行时要实例化哪个类。这是来自的代码`ArrayList.toArray(T)`：

```
 public <T> T[] toArray(T[] a)
{
   if (a.length < size)
   {
      a = (T[]) java.lang.reflect.Array.
         newInstance(a.getClass().getComponentType(), size);
   }
   System.arraycopy(elementData, 0, a, 0, size);
   if (a.length > size)
   {
      a[size] = null;
   }
   return a;
} 

```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-03-09T18:48:36.363

当前答案更安全，但在技术上已经过时，因为在 java7 及更高版本中，您不需要“Class clazz”参数。该类型是从预期的返回类型推断出来的。您只会收到有关不安全演员表的警告。

```
public class Main {

    private static class Dog {
        public String toString() { return "dog"; }
    }

    private static class Cat {
        public String toString() { return "cat"; }
    }

    public static void main(String[] args) {
        Cat cat = parse("cat");
        Dog dog = parse("dog");
        System.out.println("the cat object is a " + cat);
        System.out.println("the dog object is a " + dog);
    }

    private static Object untypedParse(String stringToParse) {
        if(stringToParse.equals("dog")) {
            return new Dog();
        } else if(stringToParse.equals("cat")) {
            return new Cat();
        } else {
            throw new RuntimeException("not expected");
        }
    }

    public static <T> T parse(String stringToParse) {
        return (T)untypedParse(stringToParse);
    }

}

~/test/generics$ javac Main.java
Note: Main.java uses unchecked or unsafe operations.
Note: Recompile with -Xlint:unchecked for details.
~/test/generics$ java Main
the cat object is a cat
the dog object is a dog 
```

# c# - 如何在 DataColumn 表达式中访问父子节点

> ID：590409
> 
> 赞同：1
> 
> 时间：2009-02-26T12:45:35.067
> 
> 标签：c#, ado.net, expression, datacolumn

我有一个带有 3 个数据表的数据集：

> 个人
> 
> dt工资
> 
> 朋友

每个人都有薪水，每个人都有一个朋友。

我在 dtSalary 中添加了一列 dcHisFriend，并希望显示拥有指定薪水的人的朋友姓名。

所以 dtPerson 有一个列 NAME，dtSalary 有一个列 VALUE，dtFriend 有一个列 NAME。

我添加了列 dcHisFriend 并将 Expression 设置为：

> dtSalary.Add(dcHisFriend);
> 
> dcHisFriend.Expression = "Max(Parent.Child(Persons_Friend).NAME)";

但这显然是行不通的。

你能告诉我如何将一个有薪水的人的朋友的名字输入dcHisFriend列到薪水表中吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T13:03:01.670

我认为，无法访问 DataColumn 中“表达式”中的任何其他行。

实现类似行为的唯一方法是在源数据所在的 DataTables 上挂钩 DataColumnChanged 事件，然后将计算值设置为常规列（=没有表达式的列）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-25T13:28:38.597

实际上有一种方法可以做到这一点，前提是您的表之间的关系是 1 比 1（尽管缺少行不是一个大问题）：创建两个关系而不是一个，即

```
var joinColT1 = table1.Columns["ID"];
var joinColT2 = table2.Columns["FK_IDT1"];
var rel1 = new DataRelation("R1To2", joinColT1, joinColT2, false);
var rel2 = new DataRelation("R2To1", joinColT2, joinColT1, false);
theDataSet.Relations.Add(rel1);
theDataSet.Relations.Add(rel2);
// Add the column you're after
var hisFriend = new DataColumn("HisFriend", typeof(string), "Parent([R2To1]).[HisFriend]");
table1.Columns.Add(hisFriend);
// Add a back-reference to the other table against the friend if you want, too
var hisFriendsSalary = new DataColumn("HisFriendsSalary", typeof(decimal) "Parent([R1To2]).[Salary]");
table2.Columns.Add(hisFriendsSalary); 
```

不过，有几点需要注意：首先，当我第一次尝试这个时，我遇到了语法错误，而表达式中的关系名称周围没有方括号。不过，这可能与我用于关系的名称有关。

其次，我相信 Expressions 的结果是针对行存储的（它们不是在访问时“及时”计算的，它们是在值更改时计算的，并保留结果）。这意味着您使用这种方法存储了两次数据。有时这很好，有时则不然。

第三，你会注意到我没有使用约束。那是因为在我的典型用例中，我不希望每一行在另一个表中都有一个类似物（这就是为什么首先有两个表，经常！）。这可能（我没有检查过 dotnetframework.org）对性能有影响。

# .net - NHibernate：列不允许空值。插入失败

> ID：590415
> 
> 赞同：4
> 
> 时间：2009-02-26T12:49:11.470
> 
> 标签：.net, nhibernate, fluent-nhibernate

我有 2 个实体 Person 和 Address，Person 有一个地址。

**编辑：地址已经存在，我只是想保存外键。**

当我这样做时：

```
 PersonDTO person = new PersonDTO();
    person.Age = "Bob";
    person.Address = new AddressDTO {Key = 123};
    Save(person); 
```

我得到这个例外：

> 无法将值 NULL 插入到列“键”、表“地址”中；列不允许空值。INSERT 失败。语句已终止。

从 Person 映射文件片段

```
<class name="PersonDTO" table="Person" xmlns="urn:nhibernate-mapping-2.2">
    <id name="Key" column="PersonKey" type="Guid">
      <generator class="guid" />
    </id>
    <one-to-one name="Address" class="AddressDTOl" />
  </class> 
```

我不明白为什么会发生这种情况，我给地址键一个值。我的方法有缺陷吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T13:05:11.710

你需要这样做

```
AddressDTO add = new AddressDTO {Key = 123};
Save(add);

PersonDTO person = new PersonDTO();
person.Age = "Bob";
person.Address = add;
Save(person); 
```

或者如果您不想显式保存 Address ，请修改您的映射：

```
<many-to-one name="Address" column="..." class="AddressDTO" cascade="save-update" /> 
```

如果地址已经存在，则需要从数据库中获取：

```
PersonDTO person = new PersonDTO();
person.Age = "Bob";
person.Address = GetAddressDTO( 123 );
Save(person); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T12:58:10.073

在保存此人之前，您应该保存地址。根据生成器，您可能必须使用传入 ID 的保存重载。

如果您需要隐式保存，则应在人员中设置地址属性的级联。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T15:39:42.930

修复！

我更改了[流利](http://code.google.com/p/fluent-nhibernate/)的 nhibernate 映射，我使用了引用关系而不是 HasOne。

这导致将映射更改为：

```
<many-to-one name="Address" column="AddressKey" /> 
```

# .net - 如何使用正则表达式来匹配中间带连字符的变长数字？

> ID：590419
> 
> 赞同：1
> 
> 时间：2009-02-26T12:51:41.057
> 
> 标签：.net, regex

我想要一个 .net 正则表达式用于以下内容：

用户可以输入一个值，例如`tcm:12312312-221231323`或`tcm:23121231-23423423-34234234`

除“tcm”和连字符外的所有条目都是数字。将有一个或两个连字符。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T12:57:14.583

```
^tcm:\d{8}-(\d{9}|\d{8}-\d{8})$ 
```

那是 tcm:(八位数字)-(九位数字) 或 tcm:(八位数字)-(八位数字)-(八位数字)

* * *

```
^tcm:\d+(-\d+){1,2}$ 
```

如果您正在寻找 tcm:(一些数字)-(一些数字) 或 tcm:(一些数字)-(一些数字)-(一些数字)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T13:05:06.970

试试这个，需要两组或三组

```
tcm:\d+-\d+(-\d+)? 
```

如果对数字的长度有限制，请尝试以下操作：

```
tcm:\d{4,8}-\d{4,8}(-\d{4,8})? 
```

（其中 4 和 8 是每组的最小值和最大值）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T12:55:31.890

你的意思是：

中医：[\d-]+

?

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T13:09:49.657

好吧，数字中间的破折号不是数字... ;)

以下是一些选项：

If the dashes are optional:

```
^tcm:[\d\-]+$ 
```

If the dashes are optional, but may not occur first or last:

```
^tcm:\d[\d\-]*\d$ 
```

If at least one dash is required:

```
^tcm:\d*-[\d\-]+$ 
```

If at least one dash is required, but may not occur first or last:

```
^tcm:\d+-[\d\-]*\d$ 
```

If dashes are optional, but may not occur first or last or next to each other:

```
^tcm:\d+(-\d+)*$ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T13:17:32.803

I's not clear if you want to validate the input and just *match* the input or if you want to extract the data.

If you just need to match the input to validate it, then:

```
 ^tcm:\d+(-\d+){1,2}$ 
```

Will only match if there are 2 or 3 groups of digits, no less, no more.

If you need to account for whitespace that may occur, you could modify the Regex like this:

```
 ^tcm\s*:\s*\d+\s*(-\s*\d+){1,2}\s*$ 
```

If you wanted to extract each set of digits:

*   In Perl, you would use the `@result` array that would contain 2 or 3 groups of digits only if the whole pattern matched (the `subject` string contains the line you want to extract data from).

    ```
    my @result = $subject =~ /^tcm:(\d+)-(\d+)(?:-(\d+))?$/; 
    ```

*   In C# you could do the equivalent thing:

    ```
    MatchCollection results = null;
    Regex r = new Regex(@"^tcm:(\d+)-(\d+)(?:-(\d+))?$");
    results = r.Matches(subject);
    if ((results.Count == 2) || ((results.Count == 3))) {
        // use results.Item[] to access each group of digits
    } else {
        // The subject doesn't match
    } 
    ```

# sql - 使用 SSIS 做一个 between 查询

> ID：590423
> 
> 赞同：2
> 
> 时间：2009-02-26T12:53:56.060
> 
> 标签：sql, ssis

我想知道是否有一种方法可以在 SSIS 中进行查询之间的连接，而无需在我的服务器上使用临时表。

给定两个表，Accounts 和 Groups。Accounts 包含一个具有上限和下限范围的客户列表，用于定义客户列表。组包含所有客户。

我希望能够加入表格，以便获得所有帐户以及附加到这些帐户的客户。如果我只需要一个帐户，我可以使用有条件的拆分，但是我想要所有帐户和组中的所有客户。

这些表来自不同的系统，因此不能将查询放在一个数据源中。

如果表在同一个系统上，我可以使用以下查询。

```
SELECT 
    Accounts.Account,
    Groups.Customer
FROM
    Accounts,
    Groups
WHERE
    Accounts.AccountType = 1 AND
    Groups.GroupName BETWEEN Accounts.LowerGroup AND Accounts.UpperGroup 
```

关于如何在 SSIS 包中执行此操作的任何想法。我真的不喜欢我当前将两个表保存到服务器的方法，但我正在努力寻找一种方法来在单个数据流任务中完成它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T07:04:58.480

我假设每个客户都属于一个帐户，并且组范围不相交？

然后我会做这样的事情：

1）按组对两个表进行排序（只需使用 Accounts 表中的 LowerGroup）

2）按组完全合并加入。这会给你像

```
 Account Group Customer
 A1      G1    NULL
 NULL    G2    C1
 NULL    G3    C2
 A2      G4    NULL
 NULL    G5    C3
 NULL    G6    C4 
```

3) 一个简单的脚本转换，它将执行以下操作：

```
 If Customer is NULL 
    Store the Account to member variable, and skip this row
  Else
    Copy stored Account to the Account column, output the row 
```

你会得到

```
 Account Group Customer
 A1      G2    C1
 A1      G3    C2
 A2      G5    C3
 A2      G6    C4 
```

# php - 在用户登录时有条件地运行 PHP 脚本的最佳方式

> ID：590432
> 
> 赞同：1
> 
> 时间：2009-02-26T12:58:36.687
> 
> 标签：php, coding-style

我可能会吹毛求疵，但这样做更好吗：

```
if ($loggedin) {
    // normal process
}
else {
    header('Location: login.php');
} 
```

或这个：

```
if (!$loggedin) {
    header('Location: login.php');
    exit();
}
// normal process 
```

或者它只是无关紧要？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-26T13:01:08.740

我更喜欢第二种风格，因为“//normal process”可能是一段很长的代码，所以最后一个 }（来自 else 分支）可能有点混乱。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-26T13:05:00.573

我更喜欢第二个，因为通过简单的检查，“正常过程”还不是 1 个缩进级别。我认为 PHP 可能会对此进行优化，因此性能无关紧要，因此在这一点上，这是一个可读性问题，而第二个对我来说更有意义（“未登录，重定向，退出”），而不是将所有逻辑包装在一个巨大的如果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T13:05:10.230

它真的没有任何区别。在我个人看来，第二个分支更容易理解，因为当用户未登录时，您不必滚动到最后即可查看发生了什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T13:13:44.890

您应该始终在重定向之后使用`exit`or`die`以避免进一步的代码被执行。

但除此之外，我也更喜欢第二个，因为`$loggedin`这是您“正常流程”的先决条件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T02:00:35.870

绝对是第二个。它读起来更好，对你的其余代码也能更好地工作。

# openssl - 为什么有效性扩展 ca 不包含私钥信息？

> ID：590441
> 
> 赞同：0
> 
> 时间：2009-02-26T13:02:38.707
> 
> 标签：openssl, ssl-certificate

我有一个自签名的 rootcacert.pem，它将在下个月到期。由于特定原因，我使用以下命令扩展了此 rootcacert 的有效性：

openssl x509 -in rootcacert.pem -days 365 -out extendedrootcacert.pem - signkey rootcakey.pem -text

所以我得到了新的根 ca 作为extendedrootcacert.pem。使用新的根 ca，我可以使用旧根 ca 签名的用户证书以及这个新根 ca 签名的新用户证书。所有功能都可以正常工作，没有任何问题。

但是当我用记事本打开这个extendedrootcacert.pem & original rootcacert.pem文件时，发现内容有区别。

rootcacert.pem 有私钥和其他信息（PrivateKey、publicExponent、privateExponent、prime1、prime2、exponent1、exponent2、coefficient），如下所示：

[http://ospkibook.sourceforge.net/docs/OSPKI-2.4.7/OSPKI-html/sample-key-components.htm](http://ospkibook.sourceforge.net/docs/OSPKI-2.4.7/OSPKI-html/sample-key-components.htm)

但是新的 extendedrootcacert.pem 中没有此信息。两个证书中的所有其他字段都相同。

我不知道原始 rootcacert.pem 是如何生成的。

是否会对我的应用程序的功能产生任何不利影响。有什么方法可以将此信息包含在新的扩展根 ca 中。是否绝对有必要在新的扩展根目录中包含这些信息？

感谢任何输入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T13:15:36.087

你的链接是错误的。

证书的重要部分在字里行间：

```
-----BEGIN CERTIFICATE-----
…
-----END CERTIFICATE----- 
```

外界所有人类可理解的东西，都只供人类消费。

您可以使用以下方法重新转储这两种信息：

```
openssl x509 -in rootca.pem -noout -text
openssl x509 -in extendedrootca.pem -noout -text 
```

并比较它们。

您的 rootca.pem 也可能将*密钥*和证书组合在一个文件中。在这种情况下，您会发现以下行：

```
-----BEGIN RSA PRIVATE KEY-----
…
-----END RSA PRIVATE KEY----- 
```

然后你应该把它添加到你的extendedrootca.pem。

# database - 在 Products 表的人工主键和自然键之间做出决定

> ID：590442
> 
> 赞同：22
> 
> 时间：2009-02-26T13:02:52.340
> 
> 标签：database, primary-key

基本上，我需要将来自多个供应商的产品数据合并到一个数据库中（当然，它比这更复杂），其中有几个表需要连接在一起以进行大多数 OLTP 操作。

我将坚持使用默认值并使用自动递增整数作为主键，但是当一个供应商提供他们自己的“ProductiD”字段时，其余的则不提供，我将不得不做很多手动映射到另一个表然后加载数据（因为我必须先将其加载到 Products 表中，然后将 ID 取出并将其与我需要的其他信息一起添加到其他表中）。

或者，我可以使用产品的 SKU 作为其主键，因为 SKU 对于单个产品是唯一的，并且所有供应商都在其数据馈送中提供 SKU。如果我使用 SKU 作为 PK，那么我可以轻松加载数据馈送，因为一切都基于 SKU，这就是它在现实世界中的工作方式。但是，SKU 是字母数字的，并且可能比基于整数的密钥效率略低。

我应该看看有什么想法吗？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-02-26T13:10:37.017

这是[代理和自然主键](http://www.agiledata.org/essays/keys.html)之间的选择。

恕我直言，总是偏爱代理主键。主键不应该有意义，因为该含义可以改变。就连国名也可以改变，国家可以存在和消失，更不用说产品了。绝对不建议更改主键，自然键可能会发生这种情况。

有关[代理键与主键](http://rapidapplicationdevelopment.blogspot.com/2007/08/in-case-youre-new-to-series-ive.html)的更多信息：

> 所以代理键会赢吗？好吧，让我们回顾一下自然键的任何缺点是否适用于代理键：
> 
> *   缺点 1：主键大小 – 代理键通常没有索引大小问题，因为它们通常是 int 类型的单列。这大约是最小的。
> *   缺点 2：外键大小 - 它们没有外键或外索引大小问题，原因与缺点 1 相同。
> *   骗局 3：美学 - 嗯，它是一种旁观者类型的东西，但它们当然不涉及编写与使用复合自然键一样多的代码。
> *   骗局 4 和 5：可选性和适用性——代理键对于不想或无法提供数据的人或事物没有任何问题。
> *   骗局 6：唯一性——它们 100% 保证是唯一的。那是一种解脱。
> *   骗局 7：隐私 - 如果不道德的人获得它们，他们没有隐私问题。
> *   骗局 8：意外的非规范化——您不能意外地对非业务数据进行非规范化。
> *   骗局 9：级联更新 - 代理键不会改变，所以不用担心如何在更新时级联它们。
> *   骗局 10：Varchar 加入速度 - 它们通常是 int 的，因此它们通常会尽可能快地加入。

还有[主键的代理键与自然键？](http://decipherinfosys.wordpress.com/2007/02/01/surrogate-keys-vs-natural-keys-for-primary-key/)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-02-03T04:09:18.283

除了最简单的内部情况外，我建议始终使用代理键。它为您提供未来的选择，并保护您免受未知因素的影响。

没有理由不能将其他密钥（如 SKU）设置为非空来强制执行它们，但至少通过消除对第三方的依赖，您可以选择，而不是从你并在后期忍受痛苦的重写。

无论您选择自动递增的整数还是自己确定下一个主键，都会出现复杂情况。使用 auto-incremented 方法，您可以轻松插入记录并让它分配自己的键，但您可能无法准确识别您的记录给出的键（并且不能保证获取最大键返回您的键）。

我倾向于使用自分配密钥，因为您拥有更多控制权，并且在 sql server 中，您可以从中央密钥表中检索密钥并确保没有其他人获得相同的密钥，所有这些都在一个语句中：

```
DECLARE @Key INT

UPDATE  KeyTable
WITH    (rowlock)
SET @Key = LastKey = LastKey + 1
WHERE   KeyType = 'Product' 
```

该表记录了最后使用的键。上面的 sql 直接在表中增加该键并返回新键，确保其唯一性。

**为什么要避免使用字母数字主键：**

三个主要问题：性能、整理和空间。

性能 - 虽然有性能成本，就像下面的 Razzie，我不能引用任何数字，但索引字母数字的效率低于数字。

排序规则 - 您的开发人员可能会在不同的表中创建具有不同排序规则的相同键（它会发生），这会导致在查询中加入这些表时不断使用“排序”命令，并且很快就会变老。

空格 - 像 David 的 9 个字符的 SKU 需要 9 个字节，但一个整数只需要 4 个（2 代表 smallint，1 代表 tinyint）。即使是一个 bigint 也只需要 8 个字节。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-26T13:21:06.477

自然键一直存在的危险是，当某些更改超出您的控制范围时，您的初始假设现在或将来会被证明是错误的，或者在某些地方您需要引用一条记录，其中传递有意义的字段不是需要（例如，使用员工的社会安全号码作为主键的 Web 应用程序，然后必须使用 /employee.php?ssn=xxxxxxx 之类的 url）

根据我自己对“独特”SKU 和供应商数据提要的个人经验 - 您是否**绝对** **确定**他们向您发送的提要包含完整、独特、格式良好的 SKU？

在从具有不同 IT 水平和文书能力的供应商处获取信息时，我必须亲自处理以下所有问题：

*   产品完全缺少其 SKU ("")
*   文员在他们的数据库中使用了占位符 SKU，例如 999999999 和 00000000，但从未更正它们
*   那些进行数据输入或导入的人混淆了各种产品编号，将 UPC 与 SCC 之类的东西混为一谈，甚至想方设法将它们拼凑在一起（我见过最后带有不可能校验位的 SCC 代码，因为他们只是复制了UPC 并添加 01 或 10，不更正校验位）
*   由于特殊原因，或者只是无能，供应商在其数据库中输入了两次相同的产品（例如，同一主板的 rev. 1 和 rev. 2 具有相同的 SKU，但在供应商数据库和数据馈送中作为 2 条记录存在因为 rev 2\. 有新功能）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-26T13:13:15.187

我也会使用自动增量主键。有一个字母数字主键对性能的影响是存在的，尽管我不敢说出任何数字。但是，如果性能在您的应用程序中很重要，则更有理由使用自动增量主键列。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-26T13:09:32.183

我建议将自动递增的“无意义”整数作为主键。如果有人提出重新组织产品 ID 的想法，至少您的数据库不会遇到麻烦。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-26T14:09:30.463

和我几个月前的问题很相似...

[我应该有一个专用的主键字段吗？](https://stackoverflow.com/questions/166750/should-i-have-a-dedicated-primary-key-field)

最后我选择了一个自动递增的 PK。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-26T14:22:21.917

由于您正在处理来自您无法控制的多个供应商的数据，因此我将使用代理键。您不希望有一天当其中一个碰巧向您发送副本时，您必须重新架构您的数据库设计。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-04-10T15:44:12.820

代理键（自动递增 INT 字段）将唯一标识表中的一行。另一方面，唯一自然键 (productName) 将防止重复的产品数据进入表中。

使用唯一的自然键字段，两行或多行永远不会有相同的数据。

使用代理键字段，由于自动递增 INT 字段，行可以是唯一的，但行中的数据将不是唯一的，因为代理键与数据无关。

让我们以 User 表为例，该表的自然键字段 (userName) 将阻止同一用户注册两次，但自动递增 INT 字段 (userId) 不会。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-26T13:06:05.827

如果每个产品都有一个 SKU 并且每个产品的 SKU 都是唯一的，我不明白您为什么不想将它用于可能的主键。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-26T13:20:35.277

您总是可以对 SKU 进行[哈希](http://en.wikipedia.org/wiki/Cryptographic_hash_function)处理，从而消除 alpha。您必须为可能的冲突（这应该非常罕见）编写代码，这是一个额外的复杂性。

我会使用散列来填充主键并使初始导入变得容易，但是在 dB 中使用它时，总是将其视为随机数。这样主键将失去它的意义（并具有自动递增键的所有优点），从而在未来允许灵活性。

# c# - 我应该作为 C# 程序员学习 Openedge

> ID：590445
> 
> 赞同：6
> 
> 时间：2009-02-26T13:03:32.400
> 
> 标签：c#, .net, openedge

我们在我工作的公司中有一个 Progress OpenEdge ( [http://en.wikipedia.org/wiki/Progress_4GL ) 开发团队。](http://en.wikipedia.org/wiki/Progress_4GL)我是那里唯一的 c# 开发人员并且非常喜欢它。所以现在经理让我学习 OpenEdge 中的编程。他不希望我成为一名优秀的 OpenEdge 程序员，但他希望团队成员了解两个世界。他希望球队能从中受益。我不是不愿意学习，但我想成为一名更好的开发人员，我喜欢发现 .Net 的更多方面。那么，关于 Progress OpenEdge 有什么好处，我可以从中受益还是应该远离它。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-27T16:26:41.687

1.  OpenEdge 是用于构建 CRUD 应用程序的强大框架；但它是一种小众技能，拥有它并没有像 SAP 那样的工资溢价；相反，体面的 OpenEdge 开发人员很难以沼泽标准费率获得 - 经理通过后门招募 OpenEdge 开发人员并不为人所知。

2.  核心 ABL（OpenEdge 语言）与主流语言有很大的不同，这对于好奇的程序员和你的老板来说是很有趣的，因为每个人都可以理解其他人的观点是有意义的。

因此，请记住以下几点：

学习基础知识以丰富您对核心能力的理解是值得的，遵循“英格兰人应该知道什么，只有英格兰人知道？”的思路。您可能还会发现数据访问的便捷性令人大开眼界。

不值得花太多时间在一个无限广泛使用的框架中发展你的专业知识。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-26T13:07:26.057

如果您的经理希望您学习 OpenEdge，那么他有这样做的理由。一个原因可能是您将承担一些开发工作，也许在其他人关闭时提供掩护。正如他所说，另一个原因可能是他希望团队了解两个世界。

您需要了解的是，Progress 人员是否也会关注 .NET。如果没有，你知道他想到了哪些原因。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-26T14:18:15.827

学习新的（和不同的！）语言从来都不是一个坏主意。它可以让大脑保持运转，并教给您可能无法用您的语言提供的概念。学习 OpenEdge 不会对您的 C# 知识产生不利影响，您可能可以同时学习它们。我个人目前正在阅读 C#、Python、PHP、Ruby 和 Groovy，而我的大部分工作都是在 Java 中完成的，我只是想知道一切。（更不用说阅读上述语言的多个框架了）。

简而言之，你总是会从学习一门新语言中受益，因为它会给你一个不同于你习惯的观点。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-26T23:35:45.017

您使用的是什么版本的 OpenEdge？我可能有偏见，但我会说是的，这是值得的。有人在寻找 OpenEdge 开发人员，而 Progress 最近发布了一个我们称为“OpenEdge GUI for .Net”的产品，它允许您使用仅使用 OpenEdge ABL 代码的 .Net 控件构建 .Net 前端，将会有越来越多的商店寻找了解 OO .Net 世界但也了解 ABL 的人。

ABL 的另一个优点是它非常向后兼容（当我们升级版本时没有 VB6 噩梦）（尽管有些人可能会说这种向后兼容性是一个错误）。

ABL 现在正在将其传统的 Procedule 方式与 OO 概念相结合，因此您可以根据有意义的情况使用一种或另一种或两种理论。

我想您将要学习的主要内容是数据访问组件，是的，这在 .Net 世界中对您没有帮助，但我认为您会发现学习其他数据访问更容易，因此，这将是一个拥有的资产。

最后，如果您在 .Net 方面拥有良好的基础，那么您将成为您雇主的重要资产（并成为未来工作申请的另一个选择），帮助他们的 OpenEdge 开发人员理解 .Net 理念。我认为进步永远不会使 ABL 编译为 CLR 代码（如果我的术语有误，请原谅。它是位代码吗？你知道在 .Net VM 中运行的代码）但他们确实知道 .Net正在赢得桌面大战，他们借用了一些概念（.Net GUI 和数据集）。我希望（再次有偏见）您会查看一些 OE 数据访问并说，我希望 .Net 有一个简单的方法来做到这一点！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-16T15:49:44.643

这是一个利基市场，但利基市场可能非常值得。它也可能像被困在泥里一样。事实证明，这取决于很多因素，但正如其他人所说，学习新东西总是好的。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-24T10:45:20.297

凭借我 12 年的 Progress / Webspeed / Sonic 经验，我每小时赚 75 欧元。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-05-25T07:26:37.420

OpenEdge 似乎主要被软件开发人员用于构建产品。最终用户通常只与应用程序的 rdbms 端交互。恕我直言，学习任何新语言都是一件好事，它与你习惯的语言越不同越好——当我们的假设和习惯受到挑战和扩展时，我们会学得更好。OE 作为 rdbms 几乎是“一劳永逸”的，几乎不需要维护。建议你去[进步论坛](http://communities.progress.com/pcom/community/psdn/openedge)在线查找 DBA 管理员指南，完成它，然后阅读嵌入式 SQL，因为这可能会在短时间内对您更有意义。在消化完所有这些之后，继续写点东西。没有什么比把橡胶铺在路上并建造一些有用的东西更好的了。向其他开发人员询问支持问题，或者构建一个简单的表格，然后就去做。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-03-13T05:45:06.307

如果您的代码与 OpenEdge 程序交互，那么您应该了解一些有关环境的信息，以便更好地与它交互。

# opengl - 多视图平截头体剪裁

> ID：590458
> 
> 赞同：2
> 
> 时间：2009-02-26T13:07:47.413
> 
> 标签：opengl, clipping

函数 gluPerspective() 可用于设置近 Z 和远 Z 剪切平面。

我想画一个剪裁在某个远 Z 平面的场景，并在这个 Z 平面之外画另一个场景。是否可以每帧进行两次剪辑？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T13:11:36.673

你没有理由不能这样做。

只需设置第一个透视图，绘制第一个场景，然后设置第二个透视图并绘制第二个场景，所有这些都在同一帧的绘图中。
这通常被称为多通道渲染。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T13:14:44.107

您可能需要先绘制最远的场景，`glClear(GL_DEPTH_BUFFER_BIT);`然后再绘制最近的场景。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T07:02:53.040

一种可能性是为场景分配不同的深度范围。一些伪代码是：

```
 glDepthRange(0.5, 1.0)
  draw_far_scene
  glDepthRange(0.0, 0.5)
  draw_near_scene 
```

您必须设置投影矩阵才能对近/远场景执行正确的剪辑。

需要分配深度范围以防止深度缓冲区“合并”两个渲染。

# c# - XNA MathHelper.SmoothStep？它是如何工作的？

> ID：590462
> 
> 赞同：5
> 
> 时间：2009-02-26T13:09:30.203
> 
> 标签：c#, xna, smoothstep

我有一辆车，加速时我希望速度“慢慢”增加..

在查看了几个站点后，我得出的结论是，可以使用 SmoothStep 方法来做到这一点？

我几乎知道如何移动纹理和东西，所以一个使用 smoothstep 来增加浮点值或类似东西的例子会非常有帮助！

提前致谢 ：）

我觉得很遗憾 MSDN 库中没有所有方法的示例。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-26T16:06:22.430

SmoothStep 在这里帮不了你。SmoothStep 是一个二值插值函数。它的作用类似于正弦插值。它会在 x=0.5 左右以急剧的速度缓慢加速，然后减速到到达 (x=1.0)。

如下所示：

[![smoothstep_approx](https://i.stack.imgur.com/5cKkt.png)](https://i.stack.imgur.com/5cKkt.png)

这是近似值，实际函数没有这些确切数字。

是的，您可以使用 x=0..0.5 来实现您想要的效果，但对加速度曲线的控制很少。

如果您想真正加速汽车或任何其他物体，最好的办法是自己跟踪加速度和速度。

```
class Car : GameComponent
{
    public override void Update(GameTime time)
    {
         velocity += acceleration * time.ElapsedGameTime.TotalSeconds;
         position += velocity * time.ElapsedGameTime.TotalSeconds;
    }

    Vector3 position;
    Vector3 velocity;
    Vector3 acceleration;
} 
```

位置、速度和加速度是 Vector2 或 Vector3，具体取决于您的游戏状态使用的维度。此外，请注意这种形式的集成容易出现轻微的数学错误。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-26T13:19:50.520

从[这个文档](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.mathhelper.smoothstep.aspx)看来，SmoothStep 需要 3 个参数 - 您想要在它们之间移动的两个值以及它们之间可能需要介于 0 和 1 之间的量。
所以假设您有一个从 0 线性递增到目标速度的浮点 f经过一段时间。而不是直接使用 f 作为速度，使用 SmoothStep 看起来像这样：

```
float speed = MathHelper.SmoothStep(0, destSpeed, f/destSpeed); 
```

这份文档的糟糕程度真的令人惊讶。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T17:11:16.207

我在此期间发现的非常有用的网站。 [http://johnnygizmo.blogspot.com/2008/10/xna-series-basic-ai.html](http://johnnygizmo.blogspot.com/2008/10/xna-series-basic-ai.html)

# c# - C#.NET 中的 JPEG 2000 支持

> ID：590471
> 
> 赞同：22
> 
> 时间：2009-02-26T13:11:21.807
> 
> 标签：c#, .net, gdi, jpeg2000

.NET 似乎无法使用 GDI 库打开 JP2 (Jpeg 2000) 文件。我在谷歌上搜索过，但找不到任何库或示例代码来执行此操作。

有人有什么想法吗？除非我必须这样做，否则我真的不想为图书馆付费。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2010-07-21T18:10:38.433

似乎我们可以使用[FreeImage](http://freeimage.sourceforge.net/)来做到这一点（这是免费的）

```
FIBITMAP dib = FreeImage.LoadEx("test.jp2");
//save the image out to disk    
FreeImage.Save(FREE_IMAGE_FORMAT.FIF_JPEG, dib, "test.jpg", FREE_IMAGE_SAVE_FLAGS.JPEG_QUALITYNORMAL);
//or even turn it into a normal Bitmap for later use
Bitmap bitmap = FreeImage.GetBitmap(dib); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-01-14T22:46:19.993

对于遇到此旧帖子的任何人，Gordon 的上述代码效果很好，但正如 jixtra 指出的那样，您确实会遇到异常： System.DllNotFoundException: 'Unable to load DLL 'FreeImage': The specified module could not be found。 ' 通过nuget安装时。通过安装 FreeImage-dotnet-core nuget 包并将 FreeImage.dll 手动添加到 bin 文件夹中，我能够使其在 .net 4.6.1 中运行。您可以在此处下载 dll：http: [//freeimage.sourceforge.net/download.html](http://freeimage.sourceforge.net/download.html)。

我需要一个质量更好的图像来与 tesseract 一起使用，所以我做了一些小改动，这对新 jpeg 的质量产生了巨大的影响：

```
var jp2Format = FREE_IMAGE_FORMAT.FIF_JP2;
var dib = FreeImage.LoadEx("test.jp2", ref jp2Format);

FreeImage.SetResolutionX(dib, 300);
FreeImage.SetResolutionY(dib, 300);
FreeImage.Save(FREE_IMAGE_FORMAT.FIF_JPEG, dib, "test.jpg", FREE_IMAGE_SAVE_FLAGS.JPEG_QUALITYSUPERB); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-26T13:20:00.240

不久前我一直在寻找类似的东西，如果可以的话，我希望实现一个；[对我的问题](https://stackoverflow.com/questions/455018/extending-the-list-of-supported-image-formats-in-gdi)的回答暗示没有*记录*的方法可以为.Net 中的 Image 类使用的 GDI+ 执行此操作。

我相信，如果您正在编写 WPF 应用程序，那么您可以通过[Windows Imaging Components 编解码器](http://msdn.microsoft.com/en-us/library/aa905327.aspx)扩展支持的图像格式列表，并且*可能*已经有一个（询问您本地友好的搜索引擎？）

可以选择使用支持 JPEG2000 的[DotImage](http://www.atalasoft.com/products/dotimage/jpeg2000/?gclid=CN-e3Mmi-pgCFQtdQgodvHXfmA)等插件，尽管在加载图像时可能需要更多“努力”。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-11-25T01:33:05.183

我使用[Leadtools](http://www.leadtools.com/SDK/Raster/Raster-ImagingPro.htm)显示 JPEG 2000 图像。它们提供了一个 .NET 库，包括 WPF 和 WinForms 控件来显示图像。然而，有一个相当高的价格标签。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-01-25T03:24:08.933

如果您需要一个没有不安全块的完全托管的解决方案，您可以使用[Jpeg2000.Net 库。](https://bitmiracle.com/jpeg2000/)免责声明：我正在开发这个库，该库是商业的。

以下是将 JPEG 2000 图像解码为 TIFF 的基本示例：

```
string fileName = ...; // path to JPEG 2000 image
using (var image = new J2kImage(fileName))
{
    var options = new J2kDecodingOptions
    {
        UpsampleComponents = true
    };

    // Alternatively, you can decode only part of the image using J2kImage.DecodeArea method
    var imageData = image.Decode(options);
    imageData.Save(tiffFileName, J2kOutputFormat.Tiff);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-03-03T21:51:04.587

此外，对于当前最新的开源选项，您可以使用[Emgu CV](https://github.com/emgucv/emgucv)，它是[OpenCV](https://docs.opencv.org/3.4/d4/da8/group__imgcodecs.html#ga461f9ac09887e47797a54567df3b8b63)的包装器。C# 中的基本示例代码如下所示：

```
Mat image = CvInvoke.Imread(@"\Path\To\File.jp2"); 
```

# java - Java JLabel - 添加唯一标识符

> ID：590473
> 
> 赞同：3
> 
> 时间：2009-02-26T13:11:28.747
> 
> 标签：java, jlabel

无论如何要向 JLabel 添加 ID 或唯一标识符吗？

谢谢大家

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T13:19:04.517

JLabel 有一个从 java.awt.Component 继承的 setName 方法。您可以将其用作 ID。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T13:20:16.043

您可以调用`Component.setName`它，或`JComponent.putClientProperty`，或子类或使用`JLabel`对象作为键是`Map`某种类型的。

但可能要走的路是保持对原始对象的引用，这样您就可以编写干净、直接的代码，而不必查找组件。

# visual-studio - 使用 Visual C++ 将二维数组写入文件并从文件中读取二维数组

> ID：590486
> 
> 赞同：1
> 
> 时间：2009-02-26T13:14:45.043
> 
> 标签：visual-studio, c++-cli

我是 C++ 新手。我组成了 680x680 的二维数组。我试图将它写入 txt 文件。不幸的是，我不能定期沿着它的维度编写二维数组。我也想从 txt 文件中读取二维数组。我的代码在下面。你能帮帮我吗？

```
/*Declaration 680 *680 multidimensional array*/
array< array< double >^ >^ arr = gcnew array< array< double >^ >(680);

for (j=0;j<arr->Length;j++){
  arr[j]=gcnew array<double>(680);}

 /*Write double array to file*/

FILE *OutFile = fopen("C:\\test.txt","w++");

for(n=0;n<=(N-1);n++){
  fprintf(OutFile,"\n ");
  for(k=0;k<=(N-1);k++){
      fprintf(OutFile,"\t %f ",dizi[n][k]);}}

fclose(OutFile);

/* Declaration array reading from file*/

array< array< double >^ >^ read = gcnew array< array< double >^ >(680);

for (j=0;j<read->Length;j++){
  read[j]=gcnew array<double>(680);}

/* reading array from file*/

FILE *InFile = fopen("C:\\test.txt","r");
double db;
for(n=0;n<=(N-1);n++){
  for(k=0;k<=(N-1);k++){
    fscanf(InFile,"\t %f ",&db);
    read[n][k]=db; }}
fclose(InFile); 
```

此致...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-26T15:59:50.387

现在没有时间详细研究这个，您可能会使用“序列化”和“反序列化”这两个词环顾四周（谷歌或 SO）。

* * *

**后来**：我不做任何视觉上的事情，所以我将忽略任何与语法相关的事情。

1.  它编译吗？
2.  如果是这样，它运行时不会崩溃吗？
3.  如果是这样，您是否直接查看了输出？它给了你期望的东西吗？
4.  使用 fscanf 进行输入解析很棘手。您需要非常小心地让空白字符匹配。[看这里。](http://books.google.com/books?id=GyJcz1CnjV4C&pg=RA1-PA364&lpg=RA1-PA364&dq=visual+fscanf&source=bl&ots=eKG4LKqorI&sig=Rm7xyAL2RdRPFhJM_JnvWWqP2zY&hl=en&ei=W9emSciqGsyJnge57ITWDw&sa=X&oi=book_result&resnum=4&ct=result#PRA1-PA365,M1)您最大的问题似乎是您正在编写换行符，但不允许输入包含它们。

**我的建议：**慢慢来，检查每个步骤发生的情况，并在您更好地了解可能出现的问题时报告（编辑问题）......

# ios - 存储大量布尔变量的最佳方法？

> ID：590487
> 
> 赞同：4
> 
> 时间：2009-02-26T13:14:45.510
> 
> 标签：ios, objective-c, xcode, cocoa-touch

我正在编写一个需要我存储 60*4 布尔值的代码，这些值的标题存储在 plist 中。我需要在运行时操作布尔值并且找不到轻松更新 plist 文件的方法..同样使用 sqlite 数据库存储布尔值对于如此大量的数据变得忙碌...有没有简单的方法通过我可以在运行时和应用程序启动后轻松存储和检索这些值？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-26T19:06:20.860

I don't mean to be a heretic, but there's a simple rule for cases like this: premature optimization is the root of all evil.

60*4 is only 240 booleans. Even if you somehow manage to store them in the worst possible way and take 1k per boolean, that's still only 240k. As long as that's storage rather than RAM, who cares? Why not start with the simplest possible way and fix it when something comes to you later? SQLite would be perfectly fine for this.

If you're close to shipping and have identified this as a problem, by all means ignore this answer. :)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-11-05T14:47:29.017

虽然如上所述使用 NSArray 或 NSMutableArray 会容易得多，但您可以查看使用标准 C++ 向量类。AFAIK 这是非常节省空间的 wrt。内存的分配。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T21:36:55.990

你可以使用 NSData 方法来存储布尔数组，但你也可以让可可自然地做到这一点：

```
NSArray* arrayOfBools; // array of 240 NSNumbers, each made with [NSNumber numberWithBool:NO]; 
```

然后

```
[[NSUserDefaults standardUserDefaults] setObject:arrayOfBools forKey:@"MyNameForThe240"]; 
```

检索它们：

```
NSArray* savedBools = [[[NSUserDefaults standardUserDefaults] objectForKey:"MyNameForThe240"]; 
```

您可能希望它们在一个可变数组中：

```
NSMutableArray* the240ThatCanBeEdited = [NSMutableArray arrayWithArray:savedBools]; 
```

然后在退出时，用

```
[[NSUserDefaults standardUserDefaults] setObject:the240ThatCanBeEdited forKey:@"MyNameForThe240"]; 
```

# svn - 将 Subversion 与一个简单的文件存档集成到应用程序中是否过大？

> ID：590493
> 
> 赞同：3
> 
> 时间：2009-02-26T13:16:36.440
> 
> 标签：svn, version-control

当我们即将开始规划一个处理媒体文件（mp3、flv、pdf、图像）的应用程序时，我正在考虑如何处理文件存储。文件会发生变化，版本应该在一定程度上被跟踪，所以想到在应用程序中集成 SVN。

现在我想知道，是不是太多了？我很确定我们只会使用 SVN 带来的一小部分功能，所以也许只使用数据库指向文件系统也一样好。

另一方面，这些自定义存档解决方案总是非常临时，这次我想要一个可靠的解决方案。太麻烦了？你怎么看？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T13:19:48.027

我认为 SVN 的问题是，它会随着大型二进制媒体（非常少，如果有的话，“差异”使用）而稳定增长，并且很难用 SVN 清除历史记录。只要你知道你在做什么，应该没问题...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T13:21:21.110

Subversion 真的很简单，尤其是在带有 TortoiseSVN 的 Windows 平台上。乍一看，在简单的场景中使用它来存档您的媒体文件可能不是一个坏主意。

您可能遇到的问题是所有这些文件类型都是二进制的，因此它们无法区分。因此，您的存储库将变得非常大，您将无法轻松比较两个版本之间的更改。

我认为在一个简单的情况下，这对你来说可能并不重要，所以把自己搞砸！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-26T13:25:55.950

有几件事需要考虑。

在存储 mp3、flv 和 pdf 文件时，颠覆可能不是最佳解决方案。Subversion 的更改跟踪在文本文件上效果最好，只存储文件中的更改。支持二进制文件，但 subversion 的工作效率不如普通文件。例如，冲突解决实际上并不奏效。

您是否将其他信息存储在数据库中？如果您将有关文件的信息存储在数据库中，那么当 subversions 中的事务回滚或数据库中的事务回滚时，您可能会遇到麻烦。保持数据库和颠覆同步可能会导致麻烦。我会尝试寻找一种解决方案，将我的所有数据都存储在一个地方。如果您可以将所有内容存储在 subversion 中，这可能是可行的方法，如果您必须使用额外的数据库，那么使用数据库来存储文件版本可能也是最简单的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T13:30:01.433

即使您无法区分文件，如果发生不好的事情，能够相对轻松地恢复到以前的状态仍然很好。

# php - 需要有关 PHP DOM XPath 解析表的帮助

> ID：590496
> 
> 赞同：0
> 
> 时间：2009-02-26T13:17:44.520
> 
> 标签：php, parsing, xpath

我最近刚刚阅读了 PHP 中的 DOM 模块，现在我正在尝试使用它来解析 HTML 文档。该页面说这是一个比使用 preg 更好的解决方案，但我很难弄清楚如何使用它。

该页面包含一个表格，其中包含日期和该日期的 X 事件数。

首先，我需要从具有 valign="bottom" 的 tr 中获取文本（日期），然后我需要从低于该 tr 的具有 valign="top" 的所有 tr 中获取所有列值。我需要 tr 下面的每个 tr 的所有列值，直到下一个 tr 的日期为 valign="bottom" （下一个日期）。带有列数据的 tr 的数量是未知的，可以为零或很多。

这是页面上的 HTML 的样子：

> ```
> <table>
>     <tr valign="bottom">
>         <td colspan="4">2009-02-26</td>
>     </tr>
>     <tr valign="top">
>         <td>21:00</td>
>         <td>Column data</td>
>         <td>Column data</td>
>         <td>Column data</td>
>     </tr>
>     <tr valign="top">
>         <td>23:00</td>
>         <td>Column data</td>
>         <td>Column data</td>
>         <td>Column data</td>
>     </tr>
>     <tr valign="bottom">
>         <td colspan="4">2009-02-27</td>
>     </tr>
>     <tr valign="top">
>         <td>06:00</td>
>         <td>Column data</td>
>         <td>Column data</td>
>         <td>Column data</td>
>     </tr>
>     <tr valign="top">
>         <td>10:00</td>
>         <td>Column data</td>
>         <td>Column data</td>
>         <td>Column data</td>
>     </tr>
>     <tr valign="top">
>         <td>13:00</td>
>         <td>Column data</td>
>         <td>Column data</td>
>         <td>Column data</td>
>     </tr>
> </table> 
> ```

到目前为止，我已经能够获得前两个日期（我只对前两个感兴趣），但我不知道如何从这里开始。

我用来获取日期 trs 的 xpath 查询是

```
$result = $xpath->query('//tr[@valign="bottom"][position()<3]); 
```

现在我需要一种方法将那天的所有事件与日期联系起来，即。选择直到下一个日期 tr 之前的所有 tds 和所有列值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-26T15:32:41.960

```
$oldSetting = libxml_use_internal_errors( true ); 
libxml_clear_errors(); 

$html = new DOMDocument(); 
$html->loadHtmlFile('http://url/table.html'); 

$xpath = new DOMXPath( $html ); 
$elements = $xpath->query( "//table/tr" ); 

foreach ( $elements as $item ) {
  $newDom = new DOMDocument;
  $newDom->appendChild($newDom->importNode($item,true));

  $xpath = new DOMXPath( $newDom ); 

  foreach ($item->attributes as $attribute) { 

    for ($node = $item->firstChild; $node !== NULL; 
         $node = $node->nextSibling) {
      if (($attribute->nodeName =='valign') && ($attribute->nodeValue=='top'))
      {
        print($node->nodeValue); 
      }
      else
      {
        print("<br>".$node->nodeValue);
      }
    }
    print("<br>");
  } 
}

libxml_clear_errors(); 
libxml_use_internal_errors( $oldSetting ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T13:37:30.900

使用`following-sibling()`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-16T19:16:44.630

这个 XPath 表达式

```
/table/tr/td[@colspan=4] 
```

或者

```
/table/tr[valign='bottom']/td 
```

生成带有日期单元格的节点集。

如何在标记之间获取单元格？

```
/table/tr/td[not(@colspan=4)][preceding::td[@colspan=4][1]='2009-02-26'] 
```

# asp.net - Visual Studio 中“网站”和“项目”之间的区别

> ID：590501
> 
> 赞同：68
> 
> 时间：2009-02-26T13:19:25.577
> 
> 标签：asp.net, visual-studio-2008

> **可能重复：**
> [ASP.NET：网站还是 Web 应用程序？](https://stackoverflow.com/questions/398037/asp-net-web-site-or-web-application)

我注意到，当您启动 Visual Studio 2008 并选择“**新项目**”->“ASP.NET Web 应用程序”而不是“**新网站**”->“ASP.NET 网站”时，得到的结果明显不同'。例如，如果您选择“项目”，那么您可以编译为 .dll，并且每个页面都会获得一个 *.aspx.designer.cs 代码隐藏文件。

1）为什么我们有这两种不同的项目类型？

2）你更喜欢哪个？

3) 为什么我会选择其中之一？

4) *.aspx.designer.cs 文件是怎么回事？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-02-26T13:28:14.247

他们有不同的目的。

网站是一个内容可能会随着时间而变化的网站，即页面本身也会发生变化。没有实际的项目文件，站点只是作为一组文件部署。

应用程序是一个站点，其中内容只是应用程序，动态部分将主要在数据库等持久存储中。它将具有更复杂的逻辑，因为它可能代表一组用于数据输入的表单以及检查内容的手段。它有一个项目文件来更严格地控​​制其配置，并将其代码部署为已编译的 dll。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-02-26T13:25:46.933

1）“网站”模型是在 ASP.NET 2.0 中引入的，“Web 应用程序”模型是原始 .net 框架的项目类型。它们都有不同的用途（见下文）。

2）这取决于上下文。一个很好的例子是，如果您正在销售软件产品，您可能希望使用“Web 应用程序”项目，因为它自然适合于干净编译的代码。

3）见上，个人喜好，保养特点。“网站”允许您做的一件有趣的事情可能会给您带来很多麻烦，那就是在网站运行时对记事本中的代码隐藏（通常是 *.cs 或 *.vb）文件进行任意更改。

4) Designer.cs 文件用于存储自动生成的代码。**“此代码是由工具生成的。”**

*   [描述差异的 MSDN 文章](http://msdn.microsoft.com/en-us/library/aa730880(VS.80).aspx#wapp_topic5)
*   [类似的stackoverflow问题](https://stackoverflow.com/questions/475938/what-is-the-difference-between-web-application-and-website-in-asp-net)

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-02-26T13:39:11.397

我不会重复 2 的定义，因为刚刚得到了回答。

那么为什么要使用其中一个呢？

网站让您可以将其视为 PHP 或经典 ASP 站点，您可以在其中进行立即生效的内联更改。

优点

*   您可以直接在 Web 服务器上对站点进行调整
*   部署就像复制文件夹一样简单

缺点

*   如果您没有在实时站点上正确进行更改，您可能会遇到更改管理问题，您忘记让所有文件保持同步
*   您可以将运行时语法错误显示给最终用户，因为检查的唯一方法是手动运行每个页面

Web 应用程序让您可以像对待桌面应用程序一样对待它——在您的机器上编译了一个可部署的应用程序。

优点

*   清晰、结构化的变更管理。您不能意外混合来自两个不同版本的代码。当涉及 2 个人时，这一点可能很重要 - 一个编写代码，一个负责将文件放到服务器上。

*   因为您在您的机器上编译它，所以此时所有内容都会得到语法检查*

缺点

*   部署比从您的开发机器复制文件夹要复杂一些。然而，“发布”命令的使用极大地简化了编译和组合应该复制到 Web 服务器的文件的过程。

*   任何更改都需要在您的机器上完成、编译，并将一个全新的版本发送到 Web 服务器*

*如果您在构建选项中打开它，则仅检查 aspx/html 文件的语法。也可以在服务器上编辑这些文件，除非它们被编译到您的项目中。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2010-10-12T04:23:49.013

简单的答案如下：

1.  新网站 - 在页面被请求时在服务器编译的页面后面创建代码。
2.  新 Web 项目 - 将预编译页面创建到一个或多个程序集（甚至整个站点）中，并部署在服务器上。

场景 #1 - 如果黑客获取了您的代码隐藏文件，则任何数据库密码都会暴露。这些页面是在请求时编译的。您可以选择将所有内容预编译成一个大型程序集。如果没有，服务器上的负载就会增加。

场景 #2 - 如果黑客获得了您的程序集，它们将被混淆。混淆的程序集更难破解。这些程序集是预编译的，从而减少了服务器的负载。

了解更多信息：

[Web 应用程序项目简介](http://msdn.microsoft.com/en-us/library/aa730880%28VS.80%29.aspx#wapp_topic5)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-02-26T13:47:42.170

3) WebApplication 项目可由 MSBuild 构建。网站不是（没有很多调整）。如果您将 TeamSystem 与自动构建一起使用，那么这就是您要走的路。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-12-03T13:40:19.533

没有人真正提到过的最大区别（除了Annakata 提到的）是，通过将所有内容编译到单个DLL 中的模型，您可以完全控制应用程序生成的类。您知道它们在哪里，并且始终可以从应用程序的其他任何地方引用它们。

使用单页模型，您无法做到这一点。您必须通过在 AppCode 目录中创建“存根”类并在您的页面中继承这些类来解决它，但即使这样也不理想，并且会增加复杂性。

如果您正在尝试开发一个复杂的动态站点，您只会在运行时根据内容动态加载大量用户控件时，您才会真正反对这些东西。然后，差异非常明显——因此我们的大部分开发在 ASP 1.1 上停滞不前，直到我们以后可以回到相同的模型。

尼希

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2011-06-27T15:14:34.750

从两者的经验来看：“网站”用于没有适当的测试方法、没有 CI 服务器以及鼓励和促进定期对特定页面进行“修补程序”的文化。“Web 应用程序”是事实上的标准，其中遵循适当的软件方法，并进行单元测试（如果不是完整的 TDD）和 CI 服务器，重点是在需要“修补程序”之前编写干净的代码和发现错误。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-02-26T13:44:42.257

站点是 2003 年最初的 .NET 进行 Web 开发的方式。根据我的经验，它们是*非常*有问题的，因为缺少项目定义，它们不能被重用，并且在模块化编码方面存在问题，在 TeamSystem 集成和命名空间方面存在问题。与域的一对一绑定和缺乏真正的发布抽象会导致维护问题。

!codebehind 的古老“经典” ASP 方式是一个严重的问题，因为它再次损害了代码重用和测试，并且经常提到的允许热修复的好处 - 如果曾经调用过 - 实际上是一个巨大的信号，表明您有一个失败的开发过程. 热修复的能力当然比不能热修复要好，但这是你永远不想调用的东西。

你可能会说网站模型的问题已经够严重了，以至于 MS 给了我们 Web 应用程序。就个人而言，我永远不会将它们用于演示代码之外的任何东西......实际上我什至不会这样做。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-02-26T13:28:18.113

1.  起初有一个 Web 应用程序项目（它的行为类似于当前的 Web 站点项目）。他们对其进行了更改以反映某些用户的要求。然而，人们希望恢复旧功能，因此他们重新引入了 Web 站点项目，该项目的行为类似于原始 Web 应用程序项目。

2.  我——和我的工作场所——更喜欢网站项目

3.  我们喜欢网站的文件是文件系统中的文件（无需手动添加）

4.  不知道

这是我发现的两篇关于两者的文章：

[http://damieng.com/blog/2008/02/07/web-site-vs-web-application](http://damieng.com/blog/2008/02/07/web-site-vs-web-application)

[http://www.dotnetspider.com/resources/1520-Difference-between-web-site-web-application.aspx](http://www.dotnetspider.com/resources/1520-Difference-between-web-site-web-application.aspx)

**注意：** Web 部署项目已经解决了很多网站问题

**更新：**修复了第 1 点，Web 应用程序首先出现

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2010-04-29T09:21:14.973

如果您的工作需要利用 oo 语言特性（类层次结构、命名空间），或者如果您需要在项目之间重用公共代码（数据访问、类库等），那么 Web 应用程序项目是唯一的选择。

网站项目（线索在名称中）仅适用于非复杂的“宣传册软件”*网站*（其中页面由静态内容组成），而不是 Web*应用程序*。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-02-26T13:55:58.280

差别很小，我强烈建议使用网站模型。

主要区别在于，对于一​​个网站，有些文件需要放在特定的目录中（代码文件需要放在“App_Code”目录中），除此之外，它非常简单。

如果为部署编译的代码对您很重要，并且您想要一个 DLL（与您为网站进行正常发布时创建的几个相反），那么您将想要获得这个附加组件：[http ://msdn.microsoft.com/en-us/asp.net/aa336619.aspx](http://msdn.microsoft.com/en-us/asp.net/aa336619.aspx)

# c# - Web 客户端软件工厂入门但我没有找到解决方案图片？

> ID：590502
> 
> 赞同：0
> 
> 时间：2009-02-26T13:19:35.420
> 
> 标签：c#, .net, asp.net, asp.net-mvc

我下载了添加启动设置 MVP 软件，设置完成后，我在项目类型列表中找不到 MVP C# 解决方案（如：ASP .Net MVC 解决方案或 ASP .Net Silverlight 解决方案）？

我需要一个项目列表列表，例如启动 ASP .Net 解决方案：

如果我单击新项目，.Net 会给我一种替代解决方案，所以我从列表中选择其中一个？我在这个列表中添加了 silverlight 也是 MVC 解决方案，但我没有找到 MVP？

请看第二张图：

[Web 客户端软件工厂入门](http://www.codeplex.com/websf/Wiki/View.aspx?title=Getting_Started_Feb_2008&referringTitle=Home)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-26T16:12:33.057

您是否安装了指导自动化扩展？如果没有，您需要安装它们。然后，您必须卸载 Web 客户端工厂并使用 Guidance 部分重新安装它（安装程序上的第一个文件夹，默认情况下未选中）。

您可以尝试重新安装，但我发现这失败了。

正确安装后，项目类型将出现在 Guidance Packages 下。您将看到适用于 C# 和 VB 的 Web 客户端解决方案，无论是 WAP 还是网站。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T07:43:50.353

是的，我安装了指导自动化扩展。但 install.exe 不在包中。请看链接[请点击！！！](http://ayende.com/Blog/archive/2007/12/07/MVP-Pattern-guidance-from-patterns-amp-practices.aspx)

# performance - 图形：浮点累积图像的最佳性能

> ID：590504
> 
> 赞同：2
> 
> 时间：2009-02-26T13:19:44.047
> 
> 标签：performance, optimization, opengl, graphics

我需要加快一些我正在研究的粒子系统眼睛糖果。眼睛糖果涉及添加剂混合、积累以及粒子上的轨迹和发光。目前我正在手动渲染到浮点图像缓冲区，在最后一分钟转换为无符号字符，然后上传到 OpenGL 纹理。为了模拟发光，我以不同的分辨率和不同的偏移量多次渲染相同的纹理。事实证明这太慢了，所以我正在考虑改变一些东西。问题是，我的开发硬件是 Intel GMA950，但目标机器有 Nvidia GeForce 8800，所以在这个阶段很难分析 OpenGL 的东西。

我做了一些非常不科学的分析，发现大部分的减速都来自处理浮动图像：按常数缩放所有像素以使其淡出，并将浮动图像转换为无符号字符并上传到图形硬件。因此，我正在研究以下优化选项：

*   在定点 16.16 配置中用 uint32 替换浮点数
*   使用 SSE2 程序集优化浮点运算（图像缓冲区是一个 1024*768*3 的浮点数组）
*   使用 OpenGL 累积缓冲区而不是浮点数组
*   使用 OpenGL 浮点 FBO 代替浮点数组
*   使用 OpenGL 像素/顶点着色器

您对这些可能性有任何经验吗？有什么想法、建议吗？还有什么我没有想到的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T15:52:51.060

问题仅仅是您必须处理的大量数据。

您的浮动缓冲区大小为 9 兆字节，并且您多次触摸数据。您的渲染循环很可能看起来像这样：

*   清除缓冲区
*   在上面渲染一些东西（使用读取和写入）
*   转换为无符号字节
*   上传到 OpenGL

That's a lot of data that you move around, and the cache can't help you much because the image is much larger than your cache. Let's assume you touch every pixel five times. If so you move 45mb of data in and out of the slow main memory. 45mb does not sound like much data, but consider that almost each memory access will be a cache miss. The CPU will spend most of the time waiting for the data to arrive.

If you want to stay on the CPU to do the rendering there's not much you can do. Some ideas:

*   Using SSE for non temporary loads and stores *may* help, but they will complicate your task quite a bit (you have to align your reads and writes).

*   Try break up your rendering into tiles. E.g. do everything on smaller rectangles (256*256 or so). The idea behind this is, that you actually get a benefit from the cache. After you've cleared your rectangle for example the entire bitmap will be in the cache. Rendering and converting to bytes will be a lot faster now because there is no need to get the data from the relative slow main memory anymore.

*   Last resort: Reduce the resolution of your particle effect. This will give you a good bang for the buck at the cost of visual quality.

The best solution is to move the rendering onto the graphic card. Render to texture functionality is standard these days. It's a bit tricky to get it working with OpenGL because you have to decide which extension to use, but once you have it working the performance is not an issue anymore.

Btw - do you **really** need floating point render-targets? If you get away with 3 bytes per pixel you will see a nice performance improvement.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T23:11:59.333

It's best to move the rendering calculation for massive particle systems like this over to the GPU, which has hardware optimized to do exactly this job as fast as possible.

Aaron is right: represent each individual particle with a sprite. You can calculate the movement of the sprites in space (eg, accumulate their position per frame) on the CPU using SSE2, but do all the additive blending and accumulation on the GPU via OpenGL. (Drawing sprites additively is easy enough.) You can handle your trails and blur either by doing it in shaders (the "pro" way), rendering to an accumulation buffer and back, or simply generate a bunch of additional sprites on the CPU representing the trail and throw them at the rasterizer.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T13:51:13.473

尝试用精灵替换手动代码：一个 OpenGL 纹理，其 alpha 为 10%。然后在屏幕上画出很多（其中十个在同一个地方以获得全光）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T13:57:27.170

如果您所说的“手动”意味着您正在使用 CPU 来戳像素，那么我认为您可以使用 OpenGL 绘制纹理多边形的几乎所有事情都将带来巨大的加速。

# c# - c# - 从 firebird 读取/写入 blob

> ID：590508
> 
> 赞同：0
> 
> 时间：2009-02-26T13:19:57.697
> 
> 标签：c#, blob, firebird

我正在尝试使用 c# 从 firebird 读取图像，并将其保存到文件系统。我可以从表格中读取并保存。但无法查看图像。我在网上尝试了很多代码。但结果是一样的:(有人可以帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T13:45:16.200

您如何从 Firebird 中检索代码？如果您正在获取数据并将其转换为 byte[] 尝试：

```
 byte [] blob = row["image"];
// create a file FileStream to write the data
FileStream fs = new FileStream("image.jpg", FileMode.Create); 
fs.Write(blob,0,blob.Length);
fs.Close(); 

```

上面的代码应该可以解决问题。

PS：我在代码中做了很多假设，但你可以理解。

# java - Java TCP 套接字嗅探

> ID：590510
> 
> 赞同：6
> 
> 时间：2009-02-26T13:20:03.983
> 
> 标签：java, sockets, client

我正在使用 TCP 套接字在同一台计算机（本地主机）上使用特定端口号在服务器和客户端程序之间进行数据通信。

我需要一个可以捕获通过该套接字发送/接收的数据的软件吗？

（或者）

从 Java 中的指定端口嗅探数据包的最简单方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-26T13:24:04.600

我建议使用 Wireshark。它易于使用并在许多平台上运行。

[http://www.wireshark.org/](http://www.wireshark.org/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-26T14:09:03.897

如果您正在编写一些代码（而不仅仅是运行 wireshark/tcpdump），那么您几乎没有选择。如果您想坚持使用 Java，那么使用原始套接字的唯一（？）选项是通过 JNI，并且很少有库可以提供帮助，例如：

*   [jNetPcap](http://jnetpcap.com/) - 本地 libpcap/winpcap 库的包装器，公开它们的所有功能和结构
*   [RockSaw](http://www.savarese.org/software/rocksaw/index.html) - 使用原始套接字的 API

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T13:24:57.297

最简单的方法是用代理实现替换其中一个程序中的套接字中的`InputStream`/ `OutputStream`，该代理实现打印/日志或“三通”到原始和打印/日志流。

但是如果你真的想弄得一团糟，那里有很多嗅探器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T13:28:18.223

如果您不介意使用命令行感到沮丧和肮脏，您可以尝试[netcat](http://netcat.sourceforge.net/)。如果您愿意，它可以让您监听端口并将输出转储到文件中。
您还可以让它发送虚假数据并记录响应。

我经常将它用作假装的 HTTP 代理（并配置 Firefox 以使用它）来发现通过网络发送的内容。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-03-29T16:39:28.290

`Tcpdump`也可以直接使用，如果流量不高，不需要使用`wireshark`。就像

```
tcpdump -ni lo0 port 1234 
```

应该是你所需要的（lo0 是所有 Unix/Linux 系统上的环回接口；当然还要更改端口号）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-05-20T07:46:51.877

像这样运行你的程序：

`java -Djavax.net.debug=all helloworld.java`

[Oracle JSSE 页面](http://docs.oracle.com/javase/6/docs/technotes/guides/security/jsse/JSSERefGuide.html#NoSSLSocket)上完整记录了该开关

优点：

*   比其他建议的解决方案简单得多（不需要外部软件）
*   还可以解密/转储 TLS/SSL 连接 :)

缺点：

*   这仅**在您使用来自`java.net.*`eg的类时才有效，`OutputStream`或者`InputStream`**如果您使用原始套接字，这将不起作用。这记录在链接中。
*   相信这可能只适用于 Oracle JDK。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-11-13T16:35:13.367

您可以使用`tcpdump`它为您提供多种选择。使用 -w 选项将捕获保存在`.pcap`文件中，完成后使用`wireshark`. 这种方式的优点是您可以每秒捕获高速率的数据包，而不会影响您电脑的整体性能（即使它是低端的）。

# java - Netbeans 和 .NET Web 服务

> ID：590514
> 
> 赞同：1
> 
> 时间：2009-02-26T13:20:37.603
> 
> 标签：java, web-services, netbeans, java-metro-framework

我不是经验丰富的Java开发人员，因此欢迎任何评论...

我已经使用 c# 编写了一个 Web 服务，我想从 java 中使用这个服务 - 使用 Netbeans 来完成这个任务。

除了一个之外，所有方法都运行良好：该方法需要一个名为 BusinessDataField2 的类型 - 此类型包含 2 个字段：名称（字符串）和值（对象）

这些字段使用 get、set 方法填充 - 这在 .NET 环境中很容易工作。

然而 ...

我可以看到 Java 对 get 和 set 方法需要不同的参数 - 参数是：

JAXB 元素 JAXB 元素

问题是：我如何实例化这个对象？我尝试了很多不同的方法，但没有任何效果......

谢谢，提供

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T14:35:30.073

您不应该使用“对象”类型。它可以是任何实际类型，但您并没有告诉 Java 端会发生什么。那么，它所能做的最好的事情就是处理该值的实际 XML。

考虑：对象可能是一个 int，也可能是一些复杂的结构。Java 端如何知道如何处理它？Java 端甚至没有复杂结构的代理类，因为您从未告诉它您可以返回复杂结构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T15:31:00.393

我建议使用[CXF](http://cxf.apache.org/) Web 服务框架来使用您的 Web 服务。它可以查看您的 wsdl 文件并生成与您的 .net 对象相对应的 java 对象。

他们的网站上也有一个[HOWTO](http://cwiki.apache.org/CXF20DOC/how-do-i-develop-a-client.html)。

# sql-server - Sharepoint 文档库作为 SSIS 中的目标

> ID：590528
> 
> 赞同：2
> 
> 时间：2009-02-26T13:25:05.673
> 
> 标签：sql-server, sharepoint, ssis

我从 SSIS 创建了一个 CSV 文件，我想在我们的 Sharepoint 文档库的特定文件夹中“发布”它。什么是首选方法？

我已经查看了带有共享点列表目标[SharePoint 列表源和目标](http://www.codeplex.com/SQLSrvIntegrationSrv/Release/ProjectReleases.aspx?ReleaseId=17652)的示例，这非常好，但不完全是我想要的。我只想从 SSIS 中将文件上传到文档库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T20:52:21.993

SharePoint 使用 WEBDAV 来提供类似位置的文件夹。您可以通过转到相关列表并选择操作-> 使用资源管理器打开来查看此示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T09:12:43.443

另一种选择是向文档库发送电子邮件。

doc lib 所有者需要在页面选项上设置电子邮件地址，这会给你一个看起来像的电子邮件

xxxx@moss.domain.com

如果文件夹被移动，只要电子邮件仍然存在，您就不必担心

# javascript - 如何让我的 .NET 开发人员相信学习 jQuery 是有益的

> ID：590531
> 
> 赞同：2
> 
> 时间：2009-02-26T13:25:42.177
> 
> 标签：javascript, jquery, client-side

我有一些 .NET 开发人员只想使用 MS AJAX 工具包并认为 JavaScript（和任何 JS 库）是邪恶的。我试图解释说，如果您将客户端开发视为一种成熟的语言，您可以构建可维护的代码……但我认为经典的 ASP 时代已经在这些人身上留下了印记。任何人都有一个建议来帮助说服这类开发人员，从长远来看，学习 jQuery 实际上会让他们受益，因为行业正在回归“让我们再次接近金属”，例如使用 MVC？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-26T13:28:51.700

告诉他们微软支持 jquery 并且它与 MVC 一起提供

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-26T13:37:49.743

如果他们没有意识到 jQuery 是蜜蜂的膝盖——他们生活在一块岩石下——告诉他们所有使用 jQuery 的人（谷歌、戴尔、MLB、美国银行......一个很好的列表在 jQuery 主页的中间）——或者只是告诉他们，每次他们访问他们的 Netflix 帐户时，他们正在使用 jQuery，或者如果他们访问总统的网站（我猜这可能适得其反……）； )

强调学习一种无处不在的“技术”只会帮助你的职业生涯。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-26T13:33:32.033

将他们指向Scott Guthrie 的[这篇文章](http://weblogs.asp.net/scottgu/archive/2008/09/28/jquery-and-microsoft.aspx)。文章中的快速引用解释了所有内容：

> 今天我很高兴地宣布， **Microsoft 将在未来将 jQuery 与 Visual Studio 一起提供**。我们将按原样分发 jQuery JavaScript 库，不会从 jQuery 主分支分叉或更改源代码。这些文件将在现有的 jQuery MIT 许可下继续使用和发布。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T13:43:14.320

*   询问他们是否喜欢服务器往返。（让他们明白客户端的东西是必要的。）
*   问他们是否想编写同时在 3 个不同地方工作的代码？（让他们了解需要一个几乎消除浏览器差异的库。）
*   向他们展示[谁在使用 jQuery 的列表](http://docs.jquery.com/Sites_Using_jQuery)。

如果他们喜欢优雅的代码，他们就会明白你在说什么。否则我认为他们将很难说服。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-26T14:04:52.690

使用 jQuery 实现对您的组织/客户有价值的东西，以证明它在您的环境中运行良好 - 如果它在 MS AJAX 工具包中难以实现、更复杂或需要更长时间，那就更好了。

开发人员经常会发现在适用于他们的上下文中运行代码的实际示例比一般认可或其他谁在使用它的列表更具说服力（每种实用技术都可以提供一个好的用户列表）。

如果您的开发人员不喜欢 JavaScript，也许您应该问他们认为 AJAX 工具包在客户端运行什么。AJAX Toolkit*是*客户端的一个 JavaScript 库 - 只是一个旨在轻松集成到 ASP.NET 中的库。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-26T15:39:44.100

了解给定领域的主要工具总是一个好主意。JQuery 是主要的 JS 库。对于一些轶事证据，请查看 StackOverflow 上的标签：

*   jQuery：1809 项
*   asp.net-ajax：272 项
*   ajaxtoolkit：54 项

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-26T15:43:18.367

告诉他们他们可以事半功倍——理解 jQuery/javascript 将帮助他们更多地理解 AJAX.NET。在我的书中，这是一个巨大的泄漏抽象——自从切换到 jQuery 之后，它使 Web 编程变得更加有趣，我可以构建更酷的应用程序。

# c# - C#：声明和使用具有不同类型的泛型类列表，如何？

> ID：590540
> 
> 赞同：29
> 
> 时间：2009-02-26T13:27:40.050
> 
> 标签：c#, .net, generics, list

具有以下泛型类，该类将包含以下任**`string, int, float, long`**一类型：

```
public class MyData<T>
{
    private T _data;

    public MyData (T value)
    {
        _data = value;
    }

    public T Data { get { return _data; } }
} 
```

我正在尝试获取**`MyData<T>`**每个项目的不同之处的列表**`T`**。

我希望能够访问列表中的项目并获取其值，如下面的代码所示：

```
MyData<> myData = _myList[0];    // Could be <string>, <int>, ...
SomeMethod (myData.Data); 
```

where**`SomeMethod()`**声明如下：

```
public void SomeMethod (string value);
public void SomeMethod (int value);
public void SomeMethod (float value); 
```

* * *

**更新：**

**`SomeMethod()`****`SomeMethod(object)`**来自另一个我无法控制且不存在的等级。

* * *

但是，我似乎找不到让编译器满意的方法。

有什么建议么？

谢谢你。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-26T14:41:43.413

我认为您遇到的问题是因为您正在尝试创建泛型类型，然后创建该泛型类型的列表。您可以通过外包您尝试支持的数据类型（例如 IData 元素）来完成您想要做的事情，然后创建具有 IData 约束的 MyData 泛型。这样做的缺点是您必须创建自己的数据类型来表示您正在使用的所有原始数据类型（string、int、float、long）。它可能看起来像这样：

```
public class MyData<T, C>
    where T : IData<C>
{
    public T Data { get; private set; }

    public MyData (T value)
    {
         Data = value;
    }
}

public interface IData<T>
{
    T Data { get; set; }
    void SomeMethod();
}

//you'll need one of these for each data type you wish to support
public class MyString: IData<string>
{
   public MyString(String value)
   {
       Data = value;
   }

   public void SomeMethod()
   {
       //code here that uses _data...
       Console.WriteLine(Data);
   }

   public string Data { get; set; }
} 
```

然后你的实现将是这样的：

```
var myData = new MyData<MyString, string>(new MyString("new string"));    
// Could be MyString, MyInt, ...
myData.Data.SomeMethod(); 
```

这是一个多一点的工作，但你得到了你想要的功能。

**更新：** 从您的界面中删除 SomeMethod 并执行此操作

```
SomeMethod(myData.Data.Data); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-09-28T14:59:51.133

代表确实可以帮助简化这一点，并且仍然保持类型安全：

```
public void TestMethod1()
{
    Action<SomeClass, int> intInvoke = (o, data) => o.SomeMethod(data);
    Action<SomeClass, string> stringInvoke = (o, data) => o.SomeMethod(data);

    var list = new List<MyData> 
    {
        new MyData<int> { Data = 10, OnTypedInvoke = intInvoke },
        new MyData<string> { Data = "abc", OnTypedInvoke = stringInvoke }
    };

    var someClass = new SomeClass();
    foreach (var item in list)
    {
        item.OnInvoke(someClass);
    }
}

public abstract class MyData
{
    public Action<SomeClass> OnInvoke;
}

public class MyData<T> : MyData
{
    public T Data { get; set; }
    public Action<SomeClass, T> OnTypedInvoke 
    { set { OnInvoke = (o) => { value(o, Data); }; } }
}

public class SomeClass
{
    public void SomeMethod(string data)
    {
        Console.WriteLine("string: {0}", data);
    }

    public void SomeMethod(int data)
    {
        Console.WriteLine("int: {0}", data);
    }
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-26T13:37:11.727

只需使用 ArrayList 并忘记`MyData<T>`类型。

```
ArrayList myStuff = getStuff();
float x = myStuff.OfType<float>().First();
SomeMethod(x);
string s = myStuff.OfType<string>().First();
SomeMethod(s); 
```

问题`MyData<T>`在于您希望编译器检查仅在运行时才知道的类型。编译器检查编译时已知的类型。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-26T13:39:13.097

你不能按照你想要的方式去做。

当一个泛型类的实例被初始化时，它被绑定到特定的类型。由于您想在列表中保存不同类型的对象，因此您必须创建一个绑定到最小公分母的实例——在您的情况下，它是 Object。

但是，这意味着 Data 属性现在将返回 Object 类型的对象。编译器无法在编译时推断出实际的数据类型，因此它可以选择适当的`SomeMethod`重载。

您必须提供`SomeMethod`将 Object 作为参数的重载，或者删除在集合中保存不同此类不同类型的要求。

或者您可以使用标准`IEnumerable`集合（如 Array）并使用`OfType<>`扩展方法来获取特定类型集合的子集。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-26T13:31:38.090

在这种情况下，您需要`MyData<object>`，因为这是这些类型唯一的共同点。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-26T13:42:17.503

建议通配符回到[这里](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=135286)。关闭为“不会修复”:(

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-26T17:50:35.347

您可以为泛型参数创建一个泛型包装器`SomeMethod`并检查其类型，然后委托给适当的方法。

```
public void SomeMethod<T>(T value)
{
    Type type = typeof(T);

    if (type == typeof(int))
    {
        SomeMethod((int) (object) value); // sadly we must box it...
    }
    else if (type == typeof(float))
    {
        SomeMethod((float) (object) value);
    }
    else if (type == typeof(string))
    {
        SomeMethod((string) (object) value);
    }
    else
    {
        throw new NotSupportedException(
            "SomeMethod is not supported for objects of type " + type);
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-26T13:31:30.617

`MyData<T>`从非泛型类继承`MyData`并列出它。

这样，您就无法自动解决过载问题。您必须手动完成。

```
abstract class MyData { 
   protected abstract object GetData();
   protected abstract Type GetDataType(); 
   public object Data {
      get { return GetData(); } 
   }
   public Type DataType {
      get { return GetDataType(); } 
   }
}

class MyData<T> : MyData { 
   protected override object GetData() { return Data; }
   protected override Type GetDataType() { return typeof(T); }
   public new T Data {
     get { ... }
   }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-26T13:32:29.680

泛型允许您在创建列表时为整个列表指定一种类型，例如，将创建一个用于存储 int 的列表，如下所示

```
var myData = new MyData<int>(); 
```

如果你想在同一个泛型列表中存储多个类型，你可以为这些类型指定一个通用的基类型或接口。不幸的是，在您的情况下，您要存储的类型的唯一常见基本类型是对象。

```
var myData = new MyData<object>(); 
```

但是您可以只使用非通用列表来存储对象。

# console - `tee` 命令等效于 *input*？

> ID：590548
> 
> 赞同：2
> 
> 时间：2009-02-26T13:30:00.607
> 
> 标签：console, stdout, stdin

unix**`tee`**命令将标准输入拆分为标准输出和一个文件。

我需要的是另一种工作方式，将多个输入合并到一个输出 - 我需要连接两个（或更多）命令的标准输出。
不确定这个应用程序的语义应该是什么——让我们假设每个参数都是一个完整的命令。

例子：

```
>  eet "echo 1" "echo 2" > file.txt 
```

应该生成一个包含内容的文件

```
1
2 
```

我试过

```
>  echo 1 && echo 2 > zz.txt 
```

它不起作用。

旁注：我*知道*我可以将每个命令的输出附加到文件中，但我想一次性完成（实际上，我想将合并的输出通过管道传输到另一个程序）。
另外，我*可以*自己动手，但是只要我负担得起，我就很懒惰:-)

哦，是的，如果它在 Windows 中工作会很好（尽管我猜任何 bash/linux 风格的解决方案都可以通过 UnxUtils/msys/etc 工作）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-26T13:31:13.037

尝试

```
( echo 1; echo 2 ) > file.txt 
```

生成一个子shell并在那里执行命令

```
{ echo 1; echo 2; } > file.txt 
```

也是可能的。这不会产生子shell（最后一个命令后的分号很重要）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-11T09:16:46.820

我猜你想要的是并行运行这两个命令，并将两个输出合并到另一个命令。

我会做：

```
( echo 1 & echo 2 ) | cat 
```

其中“echo 1”和“echo 2”是生成输出的命令，“cat”是接收合并输出的命令。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-26T13:34:24.387

`echo 1 > zz.txt && echo 2 >> zz.txt`

那应该行得通。您真正要做的就是依次运行两个命令，其中第一个重定向到一个文件，然后，如果成功，您运行另一个命令，将其输出附加到您首先编写的文件的末尾.

# sql - 在 oracle 中对具有空值的列求和

> ID：590551
> 
> 赞同：31
> 
> 时间：2009-02-26T13:30:50.900
> 
> 标签：sql, oracle

我想将两个数字相加，但是当其中一个数字为空时，结果为空。有没有解决的办法。我可以简单地在代码中完成，但我宁愿在查询中完成。这是一个oracle数据库。

**表结构**

```
hours_t
type     craft    regular       overtime
 A         1        5              0
 A         1        3              1
 B         2        9            <null>
 B         1        4              4 
```

**查询**

```
select type, craft, sum(regular + overtime) as total_hours
from hours_t
group by type, craft
order by type, craft 
```

**不想要的结果**

```
type   craft   total_hours
  A      1          9
  B      1          8
  B      2        <null> 
```

**想要的结果**

```
type    craft   total_hours
  A       1          9
  B       1          8
  B       2          9 
```

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-02-26T13:34:25.040

NVL(value, default) 是您正在寻找的功能。

```
select type, craft, sum(NVL(regular, 0) + NVL(overtime, 0) ) as total_hours
from hours_t
group by type, craft
order by type, craft 
```

Oracle 有 5 个与 NULL 相关的函数：

1.  NVL
2.  NVL2
3.  合并
4.  NULLIF
5.  LNNVL

[**NVL**](http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/functions105.htm#i91798)：

```
NVL(expr1, expr2) 
```

> NVL 允许您在查询结果中将 null（返回为空白）替换为字符串。如果 expr1 为空，则 NVL 返回 expr2。如果 expr1 不为空，则 NVL 返回 expr1。

[**NVL2**](http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/functions106.htm#i91806)：

```
NVL2(expr1, expr2, expr3) 
```

> NVL2 允许您根据指定表达式是否为空来确定查询返回的值。如果 expr1 不为空，则 NVL2 返回 expr2。如果 expr1 为空，则 NVL2 返回 expr3。

[**合并**](http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/functions023.htm#i1001341)

```
COALESCE(expr1, expr2, ...) 
```

> COALESCE 返回表达式列表中的第一个非空 expr。至少一个 expr 不能是文字 NULL。如果所有出现的 expr 评估为 null，则该函数返回 null。

[**NULLIF**](http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/functions102.htm#i1001340)

```
NULLIF(expr1, expr2) 
```

> NULLIF 比较 expr1 和 expr2。如果它们相等，则函数返回 null。如果它们不相等，则函数返回 expr1。您不能为 expr1 指定文字 NULL。

[**LNNVL**](http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/functions078.htm#i1479295)

```
LNNVL(condition) 
```

> 当条件的一个或两个操作数可能为空时，LNNVL 提供了一种评估条件的简洁方法。

[有关Oracle SQL 函数](http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/functions001.htm)的更多信息

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2009-02-26T13:33:59.863

```
select type, craft, sum(nvl(regular,0) + nvl(overtime,0)) as total_hours
from hours_t
group by type, craft
order by type, craft 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-26T13:39:27.540

关于使用 nvl() 的其他答案是正确的，但似乎没有一个答案更突出：

您甚至应该在此列中包含 NULL 吗？

它们有 0 以外的含义吗？

这似乎是一种情况，您应该在 th 列上有一个 NOT NULL DEFAULT 0

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-26T13:56:00.683

NVL 评分最高的答案是完全有效的。如果您对使 SQL 代码更具可移植性有任何兴趣，您可能想要使用 CASE，它在 Oracle 和 SQL Server 中以相同的语法支持：

```
select 
  type,craft,
  SUM(
    case when regular is null
         then 0
         else regular
    end
    +
    case when overtime is null
         then 0
         else overtime
    end
  ) as total_hours
from 
  hours_t
group by
  type
 ,craft
order by
  type
 ,craft 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-05-08T19:53:35.963

在某些情况下，还需要 nvl(sum(column_name),0)。您可能需要考虑您的场景。

例如，我试图根据特定条件从特定表中获取特定列的总和。根据条件，

1.  表中存在一行或多行。在这种情况下，我想要总和。
2.  行不存在。在这种情况下，我想要 0。

如果你在这里使用 sum(nvl(column_name,0)) ，它会给你空值。您可能想要的是 nvl(sum(column_name),0)。

这可能是必需的，尤其是当您将此结果传递给 java 时，将数据类型设为数字，因为这样就不需要特殊的 null 处理。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-26T13:35:19.127

您需要使用 NVL 功能，例如

SUM(NVL(常规,0) + NVL(加班,0))

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-26T13:34:15.480

```
select type, craft, sum(NVL(regular, 0) + NVL(overtime, 0)) as total_hours
from hours_t
group by type, craft
order by type, craft 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-02-25T01:28:55.670

代码：

```
select type, craft, sum(coalesce( regular + overtime, regular, overtime)) as total_hours
from hours_t
group by type, craft
order by type, craft 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-08-04T18:49:02.767

如果没有 group by`SUM(NVL(regular, 0) + NVL(overtime, 0))`将引发错误，为了避免这种情况，我们可以简单地使用`NVL(regular, 0) + NVL(overtime, 0)`

# regex - 在文件中查找和替换 - .NET 友好的正则表达式语法

> ID：590552
> 
> 赞同：3
> 
> 时间：2009-02-26T13:30:51.027
> 
> 标签：regex, replace

我正在寻找一个体面的工具，它可以使用我在 C# 中使用的正则表达式语法对多个文件进行搜索和替换。通常我会在 Visual Studio 中执行此操作，但它具有最奇怪的正则表达式语法（这意味着比手动替换文件中的文本要快）。

到目前为止，我已经尝试过 windows grep 但它不喜欢下面的正则表达式。有问题的正则表达式是

```
<see cref="(?<class>.+)">(.+)</see> 
```

替换为

```
<see cref="${class}"/> 
```

或者将其转换为 Visual Studio 的语法就可以了！

Jeff在他的博客上有一个[完整的帖子。](http://www.codinghorror.com/blog/archives/000633.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T13:51:04.283

在 Visual Studio 中，您可以使用以下 Reg Ex 执行此操作：

```
\<see cref="{.+}"\>.+\</see\> 
```

代替：

```
<see cref="\1" /> 
```

请记住在“查找和替换”对话框中选择“使用/正则表达式”。

我一直认为 Visual Studio 不支持与 .Net 框架相同的正则表达式语法，这很糟糕。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-26T13:51:13.473

在 Visual Studio 中，找到：

```
\<see cref="{:i}"\>.*\</see\> 
```

并替换为：

```
<see cref="\1"/> 
```

{} 是 VS 分组运算符。它没有被命名。在替换中，\n 用于查找表达式中第 n 组的值。

如果您需要考虑新行或其他空白，您可以调整**`:i`**and部分。**`.*`**

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-26T14:17:08.793

有几个选择：

*   如果这是你经常做的事情，我会选择[PowerGrep](http://www.powergrep.com/)，因为它可能是最完整和用户友好的工具。

*   它的兄弟[RegexBuddy](http://www.regexbuddy.com/)也有一个 Grep 功能，尽管没有那么全面。

*   如果你不怕 Perl，你也可以使用它的命令行作为[搜索和替换工具](http://techome.wordpress.com/2007/12/22/perl-commandline-search-and-replace/)。

*   否则，仍然有古老的[sed](http://en.wikipedia.org/wiki/Sed)[在 Windows 上](http://gnuwin32.sourceforge.net/packages/sed.htm)工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T13:33:30.050

notepad++ 非常流行和轻量级并且有这个功能，你试过吗？：

[http://notepad-plus.sourceforge.net/uk/site.htm](http://notepad-plus.sourceforge.net/uk/site.htm)

**编辑：看起来我的链接已经过时了，而且这种用法只是最近才出现的：**

[http://www.opensourcereleasefeed.com/release/show/notepad-v5-2-released-replace-in-files-feature-added](http://www.opensourcereleasefeed.com/release/show/notepad-v5-2-released-replace-in-files-feature-added)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-27T19:15:33.870

您可以使用 .NET 正则表达式插件来允许您在 Visual Studio 中使用 .NET 正则表达式。[它位于http://www.codeproject.com/KB/macros/VS2005RegexAddIn.aspx](http://www.codeproject.com/KB/macros/VS2005RegexAddIn.aspx)的 CodeProject 上。

麦克风

# php - 两个 session_starts() 挂起 PHP 应用程序

> ID：590557
> 
> 赞同：0
> 
> 时间：2009-02-26T13:31:45.640
> 
> 标签：php, file, session, front-controller

上下文：我打算使用 mod_rewrite （首页加载子页面）构建应用程序，但在从前端控制器页面加载 session_enabled 页面时卡住了。

问题：问题是我使用 session_start() 调用 twise，PHP 页面停止响应。奇怪的是， session_start 函数是无害的，它们在不同的页面上被调用。

我已将问题缩小到此示例：

child.php 文件：

父.php 文件：

调用 parent.php 将使浏览器无限加载。只要您评论其中一个 session_start() 调用 - 它会立即加载。

问题的根源是什么？我非常需要启用会话的页面。

PS我可以通过包含页面来解决它，但是它们依赖于 URL 参数，我想避免为了某种参数代理而修复它们。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-26T13:34:21.283

`session_write_close()`一旦不再需要写入会话，您就需要调用。目前，由于您的两个脚本在整个持续时间内都打开了会话，因此您一次只能运行一个。

从[手册中](http://uk.php.net/session_write_close)：

> 会话数据通常在脚本终止后存储而无需调用`session_write_close()`，但由于会话数据被锁定以防止并发写入，因此在任何时候只有一个脚本可以对会话进行操作。将框架集与会话一起使用时，由于这种锁定，您将体验到一个一个加载的框架。您可以通过在会话变量的所有更改完成后立即结束会话来减少加载所有帧所需的时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T13:35:38.190

在加载子页面之前尝试使用[session_write_close() 。](http://www.php.net/manual/en/function.session-write-close.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T13:39:29.413

您还可以检查会话是否已经启动，如果没有，则仅启动一个新会话：

```
 if (!isset($_SESSION)) session_start(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T13:41:13.230

除此之外，一次只能使用一个会话。您需要调用该[`session_regenerate_id`函数](http://docs.php.net/session_regenerate_id)来生成新 ID：

```
if (session_id() != '') {
    session_write_close();
}
session_start();
session_regenerate_id(); 
```

否则，父会话 ID 也将用于子会话。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T13:35:25.507

无论如何，在你的脚本中有两个 session_starts() 是一件坏事。

为什么不直接在 parent.php 文件（而不是 child.php）上启动会话？或者只是 child.php 而不是 parent.php

让一个页面包含在初始化所有其他页面（SQL 连接、会话启动等）的所有其他页面中是个好主意。然后将该页面包含在所有其他页面上。

# objective-c - 怎么可能回到同一页面？

> ID：590575
> 
> 赞同：0
> 
> 时间：2009-02-26T13:35:34.133
> 
> 标签：objective-c, xcode

我是 Objective C 的新手。我只是想构建一个 iphone 应用程序。我创建了一些 NIB 文件，并通过创建一个对象并使用以下代码转到其他 NIB 文件：

```
scoreViewController *sviewController = [[scoreViewController alloc] initWithNibName:@"scoreViewController" bundle:nil];
self.scoreView = sviewController;
[sviewController release];
// Setup the animation
[self.navigationController pushViewController:self.scoreView animated:YES]; 
```

现在我想回到同一页面。对于这种情况我做了同样的工作，但是当我添加上一页头文件名时它不起作用。

```
mainViewController *mainviewController = [[mainViewController alloc] initWithNibName:@"mainViewController" bundle:nil];
self.mcoreView = mainviewController;
[mainviewController release];
// Setup the animation
[self.navigationController pushViewController:self.mcoreView animated:YES]; 
```

因此，如果您能如此高兴地发表您的评论，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T13:47:07.460

我不是 100% 确定你在问什么，但我认为你想从第二个控制器回到第一个。您在这里所做的是实例化第一个控制器的第二个实例（因此您现在有 3 个控制器），并将其推入堆栈。假设我这样做是正确的，那么如果你想回到第一个控制器，你应该将第二个控制器从堆栈中弹出，而不是添加第三个：

```
//mainViewController *mainviewController = [[mainViewController alloc] initWithNibName:@"mainViewController" bundle:nil];
//self.mcoreView = mainviewController;
//[mainviewController release];

// Setup the animation
[self.navigationController popViewControllerAnimated:YES]; 
```

# emacs - 如何对 Emacs Lisp 中的数字列表求和？

> ID：590579
> 
> 赞同：35
> 
> 时间：2009-02-26T13:37:15.067
> 
> 标签：emacs, elisp

这有效：

```
(+ 1 2 3)
6 
```

这不起作用：

```
(+ '(1 2 3)) 
```

如果`cl-*`加载了“”，则此方法有效：

```
(reduce '+ '(1 2 3))
6 
```

如果`reduce`总是有空，我可以写：

```
(defun sum (L)
  (reduce '+ L))

(sum '(1 2 3))
6 
```

定义函数的最佳实践是`sum`什么？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-02-26T13:45:00.897

```
(apply '+ '(1 2 3)) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-18T11:15:47.913

如果您在 Emacs 中操作列表并编写功能代码，请安装[`dash.el`](https://github.com/magnars/dash.el)库。然后你可以使用它的[`-sum`](https://github.com/magnars/dash.el)功能：

```
(-sum '(1 2 3 4 5)) ; => 15 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-21T18:56:42.733

线性递归函数 (sum L)

```
;;
;; sum
;;
(defun sum(list)    
    (if (null list)
        0

        (+ 
            (first list) 
            (sum (rest list))
        )   
    )   
) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-02T14:58:52.637

您可以定义自定义函数来计算传递给它的列表的总和。

```
(defun sum (lst) (format t "The sum is ~s~%" (write-to-string (apply '+ lst))) 
EVAL: (sum '(1 4 6 4))
-> The sum is "15" 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-26T13:40:35.917

这应该可以解决问题：

```
(defun sum-list (list)
  (if list
      (+ (car list) (sum-list (cdr list)))
    0)) 
```

[[来源]](http://www.cs.utah.edu/dept/old/texinfo/emacs19/cl_16.html)

编辑：[这是另一个很好的链接](http://www.math.utah.edu/docs/info/emacs-lisp-intro_8.html)，它解释了`car`-`cdr`基本上它们是允许您获取列表的第一个元素并检索没有第一个项目的新列表的功能。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2011-09-16T16:01:23.673

`(eval (cons '+ '(1 2 3)))`-- 虽然不如“减少”

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2017-04-02T17:20:12.173

（插入（数字到字符串（应用'+'（1 2 3））））

# java - GWT：在 GET 请求中捕获 URL 参数

> ID：590580
> 
> 赞同：54
> 
> 时间：2009-02-26T13:37:20.307
> 
> 标签：java, gwt

我需要构建一个 GWT 应用程序，该应用程序将由具有特定 URL 参数的外部应用程序调用。

例如：

[http://www.somehost.com/com.app.client.Order.html?orderId=99999](http://www.somehost.com/com.app.client.Order.html?orderId=99999)。

如何在 GWT 应用程序中捕获 orderId 参数？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-02-26T14:03:59.557

尝试，

```
String value = com.google.gwt.user.client.Window.Location.getParameter("orderId");
// parse the value to int 
```

PS GWT 可以调用原生 javascript，这意味着如果 javascript 可以做这些事情，GWT 也可以；例如在 GWT 中，你可以写

```
public static native void alert(String msg)
/*-{
 $wnd.alert("Hey I am javascript");
}-*/; 
```

在这种情况下，您甚至可以使用现有的 javascript 库在查询字符串中提取参数的值。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-10-31T12:35:35.447

GWT 具有从 URL 获取参数的功能：

```
String value = Window.Location.getParameter("param"); 
```

确保您的 URL 采用以下形式：

[http://app.com/?param=value#place](http://app.com/?param=value#place)而不是[http://app.com/#place¶m=value](http://app.com/#place&param=value)

为了获取地图中的所有参数，请使用：

```
Map<String, List<String>> map = Window.Location.getParameterMap(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-29T09:23:20.853

我建议你使用[GWT MVP](http://www.gwtproject.org/articles/mvp-architecture.html)。假设您的网址为

> [http://www.myPageName/myproject.html?#orderId:99999](http://www.myPageName/myproject.html?#orderId:99999)

在你的*AppController.java*中——

试试看

```
 ......
    public final void onValueChange(final ValueChangeEvent<String> event) {
    String token = event.getValue();

    if (token != null) {
        String[] tokens = History.getToken().split(":");
        final String token1 = tokens[0];
        final String token2 = tokens.length > 1 ? tokens[1] : "";

        if (token1.equals("orderId") && tonken2.length > 0) {
            Long orderId = Long.parseLong(token2);
            // another your operation
        }
    }
}
........... 
```

另一种选择，您也可以与[Spring MVC](http://docs.spring.io/spring/docs/current/spring-framework-reference/html/mvc.html)一起使用。这是一个例子......

```
// Below is in your view.java or presenter.java

Window.open(GWT.getHostPageBaseURL() + "customer/order/balance.html?&orderId=99999",
            "_self", "enable");

// Below code in in your serverside controller.java

@Controller
@RequestMapping("/customer")
public class ServletController {
@RequestMapping(value = "/order/balance.html", method = RequestMethod.GET)
public void downloadAuctionWonExcel(@RequestParam(value = "orderId", required = true) final String orderId,
    final HttpServletResponse res) throws Exception {
    try {
        System.out.println("Order Id is "+orderId);
        // more of your service codes
        }
        catch (Exception ex) {
        ex.printStackTrace();
        }
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-23T13:52:00.463

您可以使用`Activities`and`Places`来做到这一点。当您为您的页面创建 Place 时，您可以将 orderId 设置为成员。`Activity`当您创建与地点相关联时（在**ActivityMapper**中） ，可以在后记中使用该成员。

唯一的限制是您不能将 orderId 作为普通参数发送。您必须使用此表单的 url：

```
127.0.0.1:60206/XUI.html?#TestPlace:orderId=1 
```

# silverlight - Silverlight：线程/延迟操作/异步调用/事件

> ID：590584
> 
> 赞同：1
> 
> 时间：2009-02-26T13:38:09.183
> 
> 标签：silverlight, multithreading, events, asynchronous

我有以下场景：当用户将鼠标移出弹出窗口时，我希望发生动画，五秒钟后，我想删除弹出窗口。

这是我希望这样做的代码是：

```
private bool leftPopup = false;
public void AnimatePopupOut(object sender, MouseEventArgs e)
{
   myAnim.Begin();
   (new Thread(new ThreadStart(delayedRemovePopup))).Start();
}

private void delayedRemovePopup()
{
   leftPopup = true;
   Thread.Sleep(5000);
   PopUp.IsOpen = false;
} 
```

第一行“leftPopup = true”很好，但第三行“PopUp.IsOpen = false”给了我一个访问冲突异常，可能是因为这个对象属于GUI线程。有什么方法可以访问 PopUp.IsOpen 属性？如果没有，是否有另一种方法可以在一段时间后调用事件来执行此操作？

干杯

尼克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T14:38:06.497

尝试使用 PopUp.Dispatcher.Invoke()。这会将您的调用编组回 UI 线程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T00:24:14.223

这是我在 WPF 中做的一个技巧。它被移植以在 Silverlight 中使用并挂起 Dispacher 类。我不知道莫里斯的回答，因为我在 SL5 中看不到“调用”方法。我确实看到了 BeginInvoke，它在延迟操作方面毫无用处。

用法：您必须在代码文件中包含 System.Windows 命名空间，否则不会出现此扩展方法。

```
// lets say you want to enable a control 1 second after a save event
// lets say you just want to prevent click happy users from going crazy
//   This code assumes you disabled the button on the click event
Button b = this.idButton1;
b.Dispatcher.DelayInvoke(TimeSpan.FromSeconds(1), () => { b.Enabled = true; }); 
```

这就对了。只需一行代码就可以解决问题。下面是使上述代码成为可能的扩展类。

```
using System.Threading;
using System.Threading.Tasks;
using System.Windows.Threading;

namespace System.Windows {

    public static class DispatcherExtensions {

        public static void DelayInvoke<TArg1, TArg2, TArg3>(this Dispatcher dispatcher, TimeSpan delay, Action<TArg1, TArg2, TArg3> action, TArg1 arg1, TArg2 arg2, TArg3 arg3) {
            dispatcher.DelayInvoke(delay, (Delegate)action, arg1, arg2, arg3);
        }

        public static void DelayInvoke<TArg1, TArg2>(this Dispatcher dispatcher, TimeSpan delay, Action<TArg1, TArg2> action, TArg1 arg1, TArg2 arg2) {
            dispatcher.DelayInvoke(delay, (Delegate)action, arg1, arg2);
        }

        public static void DelayInvoke<TArg1>(this Dispatcher dispatcher, TimeSpan delay, Action<TArg1> action, TArg1 arg1) {
            dispatcher.DelayInvoke(delay, (Delegate)action, arg1);
        }

        public static void DelayInvoke(this Dispatcher dispatcher, TimeSpan delay, Action action) {
            dispatcher.DelayInvoke(delay, (Delegate)action);
        }

        public static void DelayInvoke(this Dispatcher dispatcher, TimeSpan delay, Delegate del, params object[] args) {

            if (dispatcher == null)
                throw new NullReferenceException();
            if (delay < TimeSpan.Zero)
                throw new ArgumentOutOfRangeException("delay");
            if (del == null)
                throw new ArgumentNullException("del");

            var task = new Task(() => { Thread.Sleep(delay); });

            task.ContinueWith((t) => { dispatcher.BeginInvoke(del, args); });
            task.Start();
        }
    }
} 
```

# .net - 确保在 MVVM WPF 应用程序的 UI 线程上调用 OnPropertyChanged()

> ID：590590
> 
> 赞同：38
> 
> 时间：2009-02-26T13:39:42.563
> 
> 标签：.net, wpf, multithreading, mvvm

在我使用 MVVM 模式编写的 WPF 应用程序中，我有一个后台进程来做这件事，但需要从它获取状态更新到 UI。

我正在使用 MVVM 模式，因此我的 ViewModel 几乎不知道将模型呈现给用户的视图 (UI)。

假设我的 ViewModel 中有以下方法：

```
public void backgroundWorker_ReportProgress(object sender, ReportProgressArgs e)
{
    this.Messages.Add(e.Message);
    OnPropertyChanged("Messages");
} 
```

在我看来，我有一个 ListBox 绑定到`List<string>`ViewModel 的 Messages 属性 (a)。 通过调用 a`OnPropertyChanged`来完成接口的作用。`INotifyPropertyChanged``PropertyChangedEventHandler`

我需要确保`OnPropertyChanged`在 UI 线程上调用它 - 我该怎么做？我尝试了以下方法：

```
public Dispatcher Dispatcher { get; set; }
public MyViewModel()
{ 
    this.Dispatcher = Dispatcher.CurrentDispatcher;
} 
```

然后将以下内容添加到`OnPropertyChanged`方法中：

```
if (this.Dispatcher != Dispatcher.CurrentDispatcher)
{
    this.Dispatcher.Invoke(DispatcherPriority.Normal, new ThreadStart(delegate
    {
        OnPropertyChanged(propertyName);
    }));
    return;
} 
```

但这没有用。有任何想法吗？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-02-26T13:46:27.133

WPF 自动将属性更改编组到 UI 线程。但是，它不会编组集合更改，因此我怀疑您添加消息会导致失败。

您可以自己手动编组添加（请参见下面的示例），或者使用类似我不久前在博客中写过的[这种技术。](http://kentb.blogspot.com/2008/01/cross-thread-collection-binding-in-wpf.html)

手动编组：

```
public void backgroundWorker_ReportProgress(object sender, ReportProgressArgs e)
{
    Dispatcher.Invoke(new Action<string>(AddMessage), e.Message);
    OnPropertyChanged("Messages");
}

private void AddMessage(string message)
{
    Dispatcher.VerifyAccess();
    Messages.Add(message);
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-02-05T16:18:38.013

我真的很喜欢 Jeremy 的回答： [在 Silverlight 中调度](http://www.wintellect.com/CS/blogs/jlikness/archive/2009/12/16/dispatching-in-silverlight.aspx)

概括：

*   在 ViewModel 中放置 Dispatcher 似乎不优雅

*   创建一个 Action<Action> 属性，将其设置为仅在 VM 构造函数中运行该操作

*   从 V 使用 VM 时，设置 Action 属性以调用 Dispatcher

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-26T04:30:50.223

本周我也遇到了类似的情况（这里也是 MVVM）。我有一个单独的类在做它的事情，在事件处理程序上报告状态。事件处理程序*按预期被调用，我可以看到结果使用 Debug.WriteLine 准时返回*。

但是使用 WPF，无论我做什么，UI 都不会更新，直到该过程完成。该过程完成后，UI 将按预期更新。就好像它正在获取 PropertyChanged，但在一次执行 UI 更新之前等待线程完成。

（令我沮丧的是，Windows.Forms 中带有 DoEvents 和 .Refresh() 的相同代码就像一个魅力。）

到目前为止，我已经通过在它自己的线程上启动进程来解决这个问题：

```
//hook up event handler
myProcess.MyEvent += new EventHandler<MyEventArgs>(MyEventHandler); 

//start it on a thread ...
ThreadStart threadStart = new ThreadStart(myProcess.Start);

Thread thread = new Thread(threadStart);

thread.Start(); 
```

然后在事件处理程序中：

```
private void MyEventHandler(object sender, MyEventArgs e) { 
....
Application.Current.Dispatcher.Invoke(
                DispatcherPriority.Send,
                (DispatcherOperationCallback)(arg =>
                { 
         //do UI updating here ...
        }), null); 
```

我不推荐此代码，因为我仍在尝试了解 WPF 线程模型、Dispatcher 的工作原理，以及为什么在我的情况下，即使事件处理程序按预期调用，UI 也不会更新，直到进程完成（按设计？）。但这到目前为止对我有用。

我发现这两个链接很有帮助：

[http://www.nbdtech.com/blog/archive/2007/08/01/Passing-Wpf-Objects-Between-Threads-With-Source-Code.aspx](http://www.nbdtech.com/blog/archive/2007/08/01/Passing-Wpf-Objects-Between-Threads-With-Source-Code.aspx)

[http://srtsolutions.com/blogs/mikewoelmer/archive/2009/04/17/dealing-with-unhandled-exceptions-in-wpf.aspx](http://srtsolutions.com/blogs/mikewoelmer/archive/2009/04/17/dealing-with-unhandled-exceptions-in-wpf.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T15:52:49.320

我在我的外部处理`BackgroundWorker.ReportProgress`事件`ViewModel`并将实际`BackgroundWorker`实例和`ViewModel`定义`async`方法的类传递给我的类。

然后该`async`方法调用`bgWorker.ReportProgress`并传递一个将委托包装为`UserState`(as `object`) 的类。我作为匿名方法编写的委托。

在事件处理程序中，我将它从`object`回转换为包装器类型，然后在内部调用委托。

所有这一切意味着我可以直接从异步运行的代码中编写 UI 更改，但它只是围绕它进行了包装。

这更详细地解释了它：

[http://lukepuplett.blogspot.com/2009/05/updating-ui-from-asynchronous-ops.html](http://lukepuplett.blogspot.com/2009/05/updating-ui-from-asynchronous-ops.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-05-26T12:04:00.540

这更像是对已接受答案的扩展，但我用我的事件处理程序做了这个......

```
using System.Threading;

private void Handler(object sender, RoutedEventArgs e)
{
    if (Thread.CurrentThread == this.Dispatcher.Thread)
    {
        //do stuff to this
    }
    else
    {
        this.Dispatcher.Invoke(
            new Action<object, RoutedEventArgs>(Handler),
            sender,
            e);
    }
} 
```

# javascript - 使用 jQuery 以像素为单位的填充或边距值作为整数

> ID：590602
> 
> 赞同：209
> 
> 时间：2009-02-26T13:43:50.963
> 
> 标签：javascript, jquery, css

jQuery 有 height() 和 width() 函数，它们以整数形式返回像素的高度或宽度...

如何使用 jQuery**以像素和整数形式获取元素的填充或边距值？**

我的第一个想法是执行以下操作：

```
var padding = parseInt(jQuery("myId").css("padding-top")); 
```

但是，例如，如果以 ems 给出填充，我怎样才能获得以像素为单位的值？

* * *

查看 Chris Pebble 建议的 JSizes 插件，我意识到我自己的版本是正确的 :)。jQuery 总是返回以像素为单位的值，因此只需将其解析为整数即可。

感谢 Chris Pebble 和 Ian Robinson

* * *

## 回答 #1

> 赞同：233
> 
> 时间：2009-02-26T13:48:01.390

您应该能够使用 CSS ( [http://docs.jquery.com/CSS/css#name](http://docs.jquery.com/CSS/css#name) )。您可能必须更具体，例如“padding-left”或“margin-top”。

例子：

**CSS**

```
a, a:link, a:hover, a:visited, a:active {color:black;margin-top:10px;text-decoration: none;} 
```

**JS**

```
$("a").css("margin-top"); 
```

结果是 10px。

如果要获取整数值，可以执行以下操作：

```
parseInt($("a").css("margin-top")) 
```

* * *

## 回答 #2

> 赞同：80
> 
> 时间：2009-02-26T14:07:10.393

比较外部和内部高度/宽度以获得总边距和填充：

```
var that = $("#myId");
alert(that.outerHeight(true) - that.innerHeight()); 
```

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2010-12-15T14:40:20.777

parseInt 函数有一个“radix”参数，它定义了转换中使用的数字系统，因此调用`parseInt(jQuery('#something').css('margin-left'), 10);`将左边距作为整数返回。

这是 JSizes 使用的。

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2013-12-07T04:43:54.940

请不要仅仅为了做一些本机可用的事情而去加载另一个库！

jQuery's`.css()`将 %'s 和 em's 转换为与开头等效的像素，并将从返回的字符串的末尾`parseInt()`删除`'px'`并将其转换为整数：

[http://jsfiddle.net/BXnXJ/](http://jsfiddle.net/BXnXJ/)

```
$(document).ready(function () {
    var $h1 = $('h1');
    console.log($h1);
    $h1.after($('<div>Padding-top: ' + parseInt($h1.css('padding-top')) + '</div>'));
    $h1.after($('<div>Margin-top: ' + parseInt($h1.css('margin-top')) + '</div>'));
}); 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2012-03-15T14:55:05.843

以下是获取周围尺寸的方法：

```
var elem = $('#myId');

var marginTopBottom  = elem.outerHeight(true) - elem.outerHeight();
var marginLeftRight  = elem.outerWidth(true)  - elem.outerWidth();

var borderTopBottom  = elem.outerHeight() - elem.innerHeight();
var borderLeftRight  = elem.outerWidth()  - elem.innerWidth();

var paddingTopBottom  = elem.innerHeight() - elem.height();
var paddingLeftRight  = elem.innerWidth()  - elem.width(); 
```

注意每个变量，`paddingTopBottom`例如，包含元素两侧边距的总和；即，`paddingTopBottom == paddingTop + paddingBottom`。我想知道是否有办法将它们分开。当然，如果它们相等，您可以除以 2 :)

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2012-09-03T22:57:01.237

解析整数

```
parseInt(canvas.css("margin-left")); 
```

为 0px 返回 0

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2011-10-15T18:06:09.743

这个简单的功能将做到这一点：

```
$.fn.pixels = function(property) {
    return parseInt(this.css(property).slice(0,-2));
}; 
```

用法：

```
var padding = $('#myId').pixels('paddingTop'); 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2009-02-26T13:51:53.563

您可以像使用[任何 CSS 属性](http://docs.jquery.com/CSS)一样获取它们：

```
alert($("#mybox").css("padding-right"));
alert($("#mybox").css("margin-bottom")); 
```

您可以在 css 方法中使用第二个属性设置它们：

```
$("#mybox").css("padding-right", "20px"); 
```

编辑：如果您只需要像素值，请使用`parseInt(val, 10)`：

```
parseInt($("#mybox").css("padding-right", "20px"), 10); 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2010-10-30T20:58:38.730

好的，只是回答原来的问题：

您可以像这样将填充作为可用的整数：

> var padding = parseInt($("myId").css("padding-top").replace("ems",""));

如果您定义了另一个测量值，例如 px，只需将“ems”替换为“px”。parseInt 将 stringpart 解释为错误的值，因此将其替换为 ... 很重要。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-07-28T14:53:50.163

您还可以自己扩展 jquery 框架，例如：

```
jQuery.fn.margin = function() {
var marginTop = this.outerHeight(true) - this.outerHeight();
var marginLeft = this.outerWidth(true) - this.outerWidth();

return {
    top: marginTop,
    left: marginLeft
}}; 
```

从而在您的 jquery 对象上添加一个名为 margin() 的函数，该函数返回一个类似于 offset 函数的集合。

外汇。

```
$("#myObject").margin().top 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-08-02T10:27:25.330

Don't use string.replace("px", ""));

Use parseInt or parseFloat!

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-10-22T23:17:32.710

不要死，但我做了这个，它可以根据各种值确定像素：

```
$.fn.extend({
  pixels: function (property, base) {
    var value = $(this).css(property);
    var original = value;
    var outer = property.indexOf('left') != -1 || property.indexOf('right') != -1 
      ? $(this).parent().outerWidth()
      : $(this).parent().outerHeight();

    // EM Conversion Factor
    base = base || 16;

    if (value == 'auto' || value == 'inherit') 
        return outer || 0;

    value = value.replace('rem', '');
    value = value.replace('em', '');

    if (value !== original) {
       value = parseFloat(value);
       return value ? base * value : 0;
    }

    value = value.replace('pt', '');

    if (value !== original) {
       value = parseFloat(value);
       return value ? value * 1.333333 : 0; // 1pt = 1.333px
    }

    value = value.replace('%', '');

    if (value !== original) {
      value = parseFloat(value);
      return value ? (outer * value / 100) : 0;
    }

    value = value.replace('px', '');
    return parseFloat(value) || 0;
  }
}); 
```

这样，我们考虑了大小调整和自动/继承。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-07-04T11:11:46.663

我可能以非常舒适的方式使用[github.com/bramstein/jsizes](https://github.com/bramstein/jsizes) jquery 插件来填充和边距，谢谢...

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-12-28T23:16:44.530

从[Quickredfox](https://stackoverflow.com/a/1901665/1250044)无耻地采用。

```
jQuersy.fn.cssNum = function(){
    return parseInt(jQuery.fn.css.apply(this, arguments), 10);
}; 
```

**更新**

更改为，`parseInt(val, 10)`因为它比`parseFloat`.

[http://jsperf.com/number-vs-plus-vs-toint-vs-tofloat/20](http://jsperf.com/number-vs-plus-vs-toint-vs-tofloat/20)

# dst - 在夏令时开始之前，我需要在支持环境中做什么？

> ID：590608
> 
> 赞同：-1
> 
> 时间：2009-02-26T13:45:55.670
> 
> 标签：dst

我的公司正在支持美国客户的以下应用程序：

IBM 大型机、DB2、Unix、Teradata、甲骨文、SQL Server 2005、劳森

由于夏令时将在下个月开始，我想知道您对我们应该注意什么以避免任何不良事件的一般想法？

谢谢，维沙赫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-26T14:22:28.857

夏令时可能有点棘手，一些想法：

*   夏令时的一天有 23 或 25 小时，而不是像往常一样的 24 小时
*   02:00h 和 03:00h 之间有间隔，或者这些时间出现两次

当您从外部获取数据时，您必须**始终**使用时区，否则您会遇到问题。例如，您无法知道发件人是否已经更改了夏令时设置，因为您无法可靠地知道设备上的一切是否正常，此外，大多数用户不会更改时区（或夏令时标志），他们改变时间本身，那会给你带来严重的麻烦。手机有时不会自己更改日光设置，用户只需将时间从 CET 02:00h 更改为 03:00h！这显然是错误的，因为时间本身并没有改变，它是时区！现在仍然是欧洲中部时间 02:00，但欧洲中部时间 03:00。

如果它们在时区更改中正常工作，您可能应该检查您使用的产品/库。

我测试了我们的 python（使用 mx.DateTime）环境，如果它正确知道要使用的时区：

测试程序：

```
from mx.DateTime import *

def f(dt):
    return dt.Format("%Y-%m-%d %H:%M %Z")

base = ISO.ParseDateTime('2009-03-29 00:00')

for i in range(10):
    test = base + i*(30*oneMinute)
    diff = test.ticks()-base.ticks()

    print "Seconds between %s and %s: %d(%d) diff=%d" % (f(base),
                                                         f(test), diff,
                                                     i*1800, i*1800-diff) 
```

对我来说输出（住在德国，3 月 29 日是夏令时）：

```
$ python test.py
Seconds between 2009-03-29 00:00 CET and 2009-03-29 00:00 CET: 0(0) diff=0
Seconds between 2009-03-29 00:00 CET and 2009-03-29 00:30 CET: 1800(1800) diff=0
Seconds between 2009-03-29 00:00 CET and 2009-03-29 01:00 CET: 3600(3600) diff=0
Seconds between 2009-03-29 00:00 CET and 2009-03-29 01:30 CET: 5400(5400) diff=0
Seconds between 2009-03-29 00:00 CET and 2009-03-29 02:00 CEST: 7200(7200) diff=0
Seconds between 2009-03-29 00:00 CET and 2009-03-29 02:30 CEST: 9000(9000) diff=0
Seconds between 2009-03-29 00:00 CET and 2009-03-29 03:00 CEST: 7200(10800) diff=3600
Seconds between 2009-03-29 00:00 CET and 2009-03-29 03:30 CEST: 9000(12600) diff=3600
Seconds between 2009-03-29 00:00 CET and 2009-03-29 04:00 CEST: 10800(14400) diff=3600
Seconds between 2009-03-29 00:00 CET and 2009-03-29 04:30 CEST: 12600(16200) diff=3600 
```

正如您所看到的`mx.DateTime`那样，它可以正常工作，但是有很多库和产品都失败了。

# php - 开始电子商务，需要语言选择的指导

> ID：590611
> 
> 赞同：-1
> 
> 时间：2009-02-26T13:46:34.123
> 
> 标签：php, ruby, programming-languages

我正在考虑开展电子商务，但我不确定选择哪种语言来编写网站的核心。

由于成本，我宁愿避免微软的 ASP.NET 和 C# 路线，而且我也更喜欢在 Linux 上开发:-)

基本上，我在使用 PHP 或 Ruby on Rails 之间权衡。我和我的开发伙伴在 PHP（以及 C、Java 和 Perl）方面经验丰富，但考虑到 Rails 似乎很受欢迎。我看了一下谷歌应用引擎是否是启动业务的好方法，但我对 Python 不熟悉，也不愿意严重依赖谷歌来支持一切。

我想知道在开发时间、更简洁、更可维护的代码方面使用 Rails 是否有好处，记住我们必须同时学习 Ruby 和 Rails。

要考虑的另一件事是，该网站的常见活动之一是上传、下载和组织相当大的文件（0-10MB）。我们想实现我们自己的版本控制系统，并且需要指导哪些语言/框架适合于此。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T14:03:11.290

您将使用哪种语言并不重要，但 Rails 是一种框架，而 PHP 是一种语言。如果您想使用 PHP，我建议您使用像 Symphony 这样的 PHP 框架，如果您选择 Ruby，我建议您使用 Rails。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T13:55:02.323

如果您已经了解 PHP，那么它是比先学习 Ruby 更好的选择。

您可以在 PHP 中获得干净且可维护的代码。重点是尽可能将 HTML 和代码分开。你仍然可以在你的视图中使用 PHP 代码而不是 smarty 之类的东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-26T13:57:09.013

我会推荐使用你最喜欢使用的任何语言（听起来像 php）。如果您想从您的技能中为您的新客户提供最大的利益，那么您不希望在了解某项工作的方式时出现延迟，或者因为您不了解框架行为而引入错误。

如果您遇到 php 不适合的项目，您总是可以研究替代技术，这足以证明它的合理性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T14:00:37.413

我想说在这种情况下最重要的是使用您已经有经验的东西。您选择的几乎任何语言都可以胜任这项任务。

您对此类项目的主要考虑应该是效率。您希望能够花更少的时间进行编码，并有更多的时间专注于业务的其他方面。

这假设您将在网站上出售某些东西。

如果企业通过网站的核心代码提供某种自动化服务，那么您将需要考虑一种最适合这些任务的语言。

尽管如此，使用你已经知道的东西总是更快更有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T14:02:14.163

您将 PHP（一种脚本语言）与 Ruby on Rails（一种 Web 应用程序框架）进行比较。您可能应该将一些 PHP 框架（如 CodeIgniter）与 RoR 进行比较。

也就是说，PHP 绝对是“更安全”的选择，因为您已经熟悉它。这一切（显然！）归结为您是否想学习一个新环境。PHP 和 Ruby 都同样能够创建出色的网站。我认为开发时间或代码清洁度/可维护性之间没有任何内在差异；这些取决于程序员——尽管有些语言比其他语言更*提倡干净的方法。*

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-26T14:04:21.210

正如其他人所说，最好坚持你所知道的 - 使用 PHP。然而，你应该使用一个框架——否则你真的是在把你的双手绑在背后。此外，它还可以让您在使用熟悉的东西的同时学习一些东西。就个人而言，我使用并推荐[CodeIgniter](http://codeigniter.com)，因为它很容易进入并且拥有一个非常活跃和乐于助人的社区。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-26T14:06:24.717

TIOBE[列表](http://www.tiobe.com/index.php/content/paperinfo/tpci/index.html)是语言使用和查找资源的良好指标。除此之外，我会使用你所知道的 PHP。一点问题都没有

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-26T14:13:28.177

使用 Ruby 开发非常快，但在您的情况下，您必须先学习它。浏览一些 Ruby 书籍或教程，估计学习它的难易程度以及需要多少时间。只需估计用众所周知的语言构建解决方案需要多少时间，以及学习和使用 Ruby 编程需要多少时间。

或者，如果您有足够的时间开始使用已知语言进行开发并同时开始学习 Ruby。然后当你学够了switch。

# jquery - 如何创建具有后退按钮支持的 ASP.NET MVC 向导？

> ID：590613
> 
> 赞同：3
> 
> 时间：2009-02-26T13:47:14.370
> 
> 标签：jquery, asp.net-mvc

我正在使用 ASP.NET MVC 创建一个应用程序，并且我需要在我的一个页面上使用向导样式的界面。

到目前为止，这是我正在做的事情：
我创建了一个包含 5 个 div 的页面。所有在 css 文件中都设置了“显示：无”。当用户第一次点击页面时，我使用 jquery 显示第一步：

```
$("#callStep1").show(); 
```

第一步有一个选择列表，当用户进行选择时，将执行以下代码：

```
$("#callStep1").hide();
$("#callStep2").show(); 
```

这一直持续到用户进入第 5 步并单击提交按钮。一切正常，除非我在第 2、3、4、5 步并点击后退按钮，当我真的只想转到上一步时，它会一直带我回到我之前所在的页面。

我怎样才能使这项工作？我看过一些使用“#”并在页面上创建链接的示例，但不确定是否有更好的方法。

有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T17:23:54.367

> 以完全不显眼且可访问的方式（也称为 Hijax）实现 Ajax 驱动的链接，并支持浏览器的后退/前进导航按钮和书签。还可以增强可比较的 DHTML 驱动链接。

[http://www.stilbuero.de/jquery/history/#Chapter_3](http://www.stilbuero.de/jquery/history/#Chapter_3)

[希贾克斯（维基百科）](http://en.wikipedia.org/wiki/Hijax)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-26T17:40:15.870

如果您在向导页面上不是绝对需要 AJAX，则可以通过在成功的表单 POST 后返回不同的视图来做到这一点。

在控制器中：

```
[AcceptVerbs(HttpVerbs.Get)]
public ActionResult DoSomethingLong(int somethingId, int step)
{
  MyModelType myModel = MyModelFactory.Fetch(somethingId);

  switch(step)
  {
    case 1:
      return View("Step1", myModel);
      break;
    case 2:
      return View("Step2", myModel);
      break;
  }
}

[AcceptVerbs(HttpVerbs.Post)]
public ActionResult DoSomethingLong(int somethingId, int step)
{
   MyModelType myModel = MyModelFactory.Fetch(somethingId);

   if (TryUpdateModel(myModel))
   {
       //Successful update.  Send to next step.
       return RedirectToAction("DoSomethingLong", new {somethingId = somethingId, step = step + 1}
   }
   else
   {
       //Update failed, redisplay current View with validation errors.
       return View(myModel);
   }
} 
```

# tfs - 订阅 TeamSystem 事件

> ID：590616
> 
> 赞同：0
> 
> 时间：2009-02-26T13:47:54.730
> 
> 标签：tfs, continuous-integration

我尝试订阅 TeamFoundation 的“构建完成”事件，如本文[http://msdn.microsoft.com/en-us/magazine/cc507647.aspx](http://msdn.microsoft.com/en-us/magazine/cc507647.aspx)中所述。而且我无法从团队系统中得到任何东西。谁能指出我需要检查的一些潜在问题区域？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T14:09:09.077

当我查看捕捉事件时，我发现了这篇出色的[博客文章。](http://blogs.conchango.com/howardvanrooijen/archive/2006/04/29/3894.aspx)它有一个可以下载的模板，启动和运行并开始了解可以捕获的事件非常容易。

# wpf - WPF 绑定到 ObjectDataProvider 方法并检测返回值依赖关系

> ID：590619
> 
> 赞同：1
> 
> 时间：2009-02-26T13:48:55.273
> 
> 标签：wpf, data-binding, observablecollection

我正在使用 ObjectDataProvider 绑定到一个方法。公开此方法的类包含 T:INofifyChanged 类型的 ObservableCollection。我的问题是，因为方法返回值取决于它的 ObservableCollection 的值，所以我需要在 ObservableCollection 以任何方式更改时更新绑定。

简而言之，该方法的返回值取决于其他因素，我希望此方法绑定在它的依赖关系发生变化时刷新。

我如何让绑定控件知道方法返回值何时不同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T13:54:51.373

ObservableCollection 类公开了您可以挂钩的 CollectionChanged 事件。

不过，使用 ViewModel 并通过它处理更新可能会更好。看看 MVVM 模式。

# asp.net - 通过 HttpHandlers 和 HttpModules 陌生性在 asp.net 2.0 中测量网络性能

> ID：590620
> 
> 赞同：0
> 
> 时间：2009-02-26T13:49:14.413
> 
> 标签：asp.net, performance, .net-2.0, httphandler, httpmodule

我们有一个依赖 HttpModule 和 HttpHandlers 的性能测量模块，其工作方式如下：

1.  请求进入服务器以获取页面。
2.  HttpModule_Begin 在 cookie 中写入开始时间。
3.  HttpModule_End 在 cookie 中写入结束时间。
4.  在客户端，页面加载完成后，通过 HttpHandler_ProcessRequest 处理的 AJAX 触发一个特殊请求
5.  在 HttpHandler_ProcessRequest 中，从之前的 HttpModule_End（存储在 cookie 中）写入的结束时间中减去 DateTime.Now 并将其存储在数据库中。我忘了提一件事：所有数据都是通过 cookie 共享的，所以 HttpHandler 只是从 cookie 中提取数据而没有任何会话 id 等……所有参与者都在同一个时区。

此过程在大多数情况下都可以正常工作，但有些情况会报告网络时间超过一个小时！这表明在写入结束时间和触发 AJAX 请求之间经过了非常长的时间，或者从触发 AJAX 请求到它到达应用服务器的时间之间经过了很长的时间。我试图弄清楚是什么导致了这个问题。为什么操作不只是超时？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T20:05:46.770

扩展您的故障排除：将值附加到 IIS 日志 ( [HttpContext.Current.Response.AppendToLog(string)](http://msdn.microsoft.com/en-us/library/system.web.httpresponse.appendtolog.aspx) )。

IIS 日志将显示您的条目，您可以确定实际记录这些请求的时间。您可以附加任何您想要的内容，它会显示在日志的查询字段中（假设您使用的是 W3C 格式。）

如果您遇到请求延迟，如证据所示，您可以验证它。这将为您提供 IIS 日志作为与 cookie 中记录值的比较源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T14:21:38.080

您是否包含一些唯一 ID，允许 AJAX 请求处理程序确定用于计算的结束时间？如果没有，可能已经在客户端上呈现了足够多的页面，AJAX 请求实际上是在结束时间被写入数据库之前到达的，并且它使用了错误的结束时间。

# .net - 每 100 秒收集一次垃圾

> ID：590623
> 
> 赞同：10
> 
> 时间：2009-02-26T13:50:32.600
> 
> 标签：.net, garbage-collection

有没有人遇到过高内存分配负载下的应用程序每 100 秒执行一次第二代收集的情况？

我们使用具有 8-16 GB 物理内存的 64 位服务器。

应用程序有几 GB 的数据存储在缓存中，因为它实际上是由应用程序使用的，所以无法从中清除。此外，它在处理过程中收到大量分配 GEN 0 对象的请求。

让我感到奇怪的是 GEN 2 集合每 100 秒的表现就像时钟一样。我在想它应该不太可预测

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-26T13:53:45.977

如果你的内存负载很高，并且使用了很多对象，那么是的：GC 会很忙……如果它正在达到第 2 代，那么听起来你有*很多*中/长期对象徘徊...

我假设内存使用情况相当稳定？以上*可能*表明某种伪泄漏（可能通过静态事件等持有太多对象），或者可能只是意味着您的内存使用率很高！

你用了多少内存？您可以考虑 x64 和大量内存吗？或者，3gb 交换机 (x86) 会为您购买更多字节吗？

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-26T14:01:24.947

如果您正在运行双核 CPU，请尝试在 app/web.config 中设置 GCServer="true"。

在我的例子中，它完成了大约 10% 的原始 GC，并且应用程序感觉更加敏捷。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-02T21:35:56.100

像发条一样发生的第二代收集表明 GC.Collect 方法像发条一样被调用，或者分配就像发条一样。

除非分配或 GC.Collect 调用是真正随机的，否则您期望在垃圾收集中看到的随机性不太可能发生。

鉴于您的服务器应用程序处于如此高的负载下，并且您在处理过程中创建了新对象，我会认真考虑重构代码以查看是否可以在处理过程中新创建更少的对象，例如使用对象池。

对象池与大多数垃圾收集器的不同之处在于，池中的对象一旦放回池中就可以被重用，并且垃圾收集器需要执行一次收集，然后才能再次使用前一个持有对象的内存块作为不同的对象。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-26T13:56:07.937

为此，进程和系统的内存使用也应该非常一致。垃圾收集由以下任一事件触发：

*   第 0 代的预算已满
*   GC.Collect() 被调用
*   CLR 想要释放内存
*   AppDomain 关闭
*   CLR 关闭

在您的情况下，可能的候选人可能是定期收集（即由于分配）或定时收集（）。

编辑：只是为了澄清分配。常规对象的分配总是发生在第 0 代（例外是在大对象堆上分配的 85000 字节或更大的大对象）。只有当它们在集合中存活时，实例才会移动到第 1 代和第 2 代。第 1 代和第 2 代没有直接分配。

此外，当第 0 代/第 1 代收集没有释放足够的内存时（或者当显式请求完整收集时），将执行第 2 代收集（也称为完整收集）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-26T14:11:50.350

您可能正在生成更多对象，然后可以一次全部放入年轻堆中，或者您有内存泄漏。

如果您正在集中创建大量需要同时处于活动状态的对象，那么您可能会溢出年轻部分，并且必须将一些对象复制到老年代。随着旧堆填满，这会更频繁地强制进行完整收集。在这种情况下，您可能需要找到一种分配更少对象的方法，除非有一种方法可以像 Sun JVM 那样请求更大的年轻堆。

如果您实际上将对象存储在某处（例如在旧对象拥有的列表中），那么您就有逻辑泄漏。通常，您不希望旧对象引用年轻对象。这往往会提升年轻对象，并且 GC 算法通常会针对它不会发生进行优化。此外，如果这会显着缩短对象可以存在的范围（尽管它通常是多余的），您可能需要考虑清除引用。

除非您的内存使用量异常高，否则您可能无能为力。请记住，对于任何长时间运行的程序，您最终都必须进行一些 GC，并且一次需要的内存越多，它出现的频率就越高。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-26T14:30:28.840

我假设您也在使用.NET。我不确定您使用的是什么工具，但我是 Red Gate 的 Ants profiler 的忠实粉丝。我在工作中使用它。它可以识别哪些对象正在占用资源。一旦你缩小范围，希望你能找到有问题的代码并适当地释放资源。

检查您的代码并确保尽可能调用 Dispose()。

让我们知道怎么回事。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-04T07:19:20.647

由于您在服务器上运行，我假设它也是多核机器。如果是这种情况，那么默认情况下您会获得 Server GC 风格，因此您无需在配置文件中设置任何内容。

您每 100 秒收集一次 Gen2 的事实是您的分配模式和对象生命周期模式的一个因素。如果您的分配模式是一致的，您将获得一致的 GC，您可以通过查看 perfmon 下的 .Net CLR Memory perf counters 来验证此行为

您将需要跟踪以下指标

1.  # Gen0 集合

2.  # 第 1 代系列

3.  # 第 2 代系列

4.  每秒分配的字节数
5.  # 所有堆中的字节。

你应该看到最后一个指标像拼图一样移动，增加，Gen2 Collection 开始，再次减少，循环重复。

为避免这种情况，您需要检查

*   您可以在请求之间，在池中创建对象吗？这将一起避免 GC。
*   如果没有，您能否减少为每个请求分配的对象数量？

希望这可以帮助。谢谢

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-26T13:55:19.470

我认为这是针对.net的。

GC 在它想要基于它的算法时进行收集。您可以建议垃圾收集器进行收集，但它实际上可能不会做任何事情。

您可以使用 GC.Collect() 让 GC 查看是否可以收集垃圾。但是，它实际上可能不会从内存中删除项目。

注意：另外，请确保您正确清除引用。意味着取消挂钩事件，清除对象之间的引用。这将有助于 GC 收集不再范围内的对象。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-04T09:47:05.500

我不明白是什么导致了“每 100 秒执行一次第二代收集”，很少看到现实生活中的系统对这样的“时钟工作”周期做任何事情。

如果你的内存负载很高，并且使用了很多对象，那么是的：GC 会很忙……如果它正在达到第 2 代，那么听起来你有很多中/长期对象闲逛...您可能正在生成更多对象，然后可以一次全部放入年轻堆中，或者您有内存泄漏。

假设您没有泄漏，您是否使用[内存分析器](http://www.google.co.uk/search?hl=en&q=memory+profiler+.net)检查过？我还假设您没有创建很多不必要的垃圾（例如 string1 += string2 在循环内）。

我能想到两件事*可能会*有所帮助。

通过限制 Asp.net 同时处理的请求（线程）的数量，您可以限制活动对象的数量，也可以加快单个请求的处理速度，因此不会让对象保持活动的时间过长。（你有很多线程接触开关吗？）

如果您将对象存储在 Asp.net 缓存和/或 Asp.net 会话中。您可以尝试为此缓存信息使用进程外存储，例如 Asp.net 会话服务器、第 3 方会话服务器、[memcache](http://sourceforge.net/projects/memcacheddotnet/)或 Microsoft 最近发布的缓存服务器 ( [Velocity](http://msdn.microsoft.com/en-us/data/cc655792.aspx) )。只需在需要时从数据库中重新读取数据，可能比将其存储在长寿命对象中更好。

如果上述情况失败，您使用了多少内存？您可以考虑 x64 和大量内存吗？或者网络农场..

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-05T03:08:52.977

频繁调用垃圾收集器本身并不一定是一个大问题 - 但是它可能是一个标志，表明您没有以最佳方式很好地处理您的内存（例如，没有通过引用将大量字符串传递给方法）。

垃圾收集应该是非确定性的。需要注意的是，如果您正在运行许多关键任务，但您的线程在某个时刻（例如每 100 秒）处于休眠状态，那么垃圾收集器可能会借此机会进行收集是合理的。更有可能是由于分配导致的消耗或多或少定期达到峰值，并且调用垃圾收集器来检索未使用的内存。

我强烈建议分析您的应用程序的内存消耗。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-06T09:19:27.780

可能只是您的应用程序每 100 秒创建一个巨大的对象，因此 GC 被迫工作吗？

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-08-19T03:19:12.827

我也见过这个 100 秒的频率，它不会发生在所有的生产设置上，但我在本地和其他设置上看到过。

# php - 重复条目mysql和php

> ID：590633
> 
> 赞同：1
> 
> 时间：2009-02-26T13:52:37.853
> 
> 标签：php, mysql

我已将我的数据库字段“用户名”和“电子邮件”设置为 unquie，当使用下面的代码时，这仅在“用户名”已经存在时才有效，然后会回显错误。如果他们的电子邮件存在，则用户会收到一个 mysql 重复错误，此时应显示与上述相同的错误。

```
<?php

require_once ( 'connection.php' );

$username=$_POST['username']; 
$password=md5($_POST['password']);
$email=($_POST['email']);
$ip=$_SERVER['REMOTE_ADDR'];
session_start();

$query = "INSERT INTO users (username, password, email, rank, ip, active) VALUES     ('$username','$password', '$email', '1', '$ip', '0')";

$sql = "SELECT username AND email FROM users WHERE username = '$username' AND  email     = '$email'" ;
$result=mysql_query($sql);
$count=mysql_num_rows($result);
$row = mysql_fetch_array($result);

if ( $count== 0 )
{
if (!mysql_query($query))
{
 die('Error: ' . mysql_error());
}
  echo "You are signed up, please follow the link on your email to active your        account.";
}
else
 {
  echo "Username or Email already exists"."<br><a href=\"sign_up.php\">Try    Again</a></br>";
 }  
? 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T13:55:52.527

尝试切换

```
WHERE username = '$username' AND  email     = '$email'" 
```

到

```
WHERE username = '$username' OR email     = '$email'" 
```

**编辑**：我试图猜测你想在这里做什么。根据您的描述，您似乎希望用户名或电子邮件是唯一的，并且您在这些列上有两个单独的唯一索引。您的代码检查用户名和电子邮件的组合是否唯一。

**编辑 2**：另外，我认为您可能想研究[SQL Injection](http://en.wikipedia.org/wiki/SQL_injection)和[Concurrency](http://en.wikipedia.org/wiki/Concurrency_(computer_science))的概念。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T14:00:26.447

在 WHERE 语句中切换到 OR 子句而不是 AND。

此外，不要使用 $_POST（或 $_GET 和 $_REQUEST）中给出的值，而不确保它们是安全的。如果我发送一个包含 SQL 的用户名会发生什么？

```
','','','','',''); DELETE FROM users; 
```

确保在发送到数据库之前使用 add_slashes() 或类似的过程来清理数据。

# .net - 如何设置 GroupBox 标题颜色

> ID：590637
> 
> 赞同：4
> 
> 时间：2009-02-26T13:54:33.310
> 
> 标签：.net, winforms, groupbox

在我的系统上，组框的标题始终是深蓝色，我该如何更改？

[如何更改组框边框颜色的](https://stackoverflow.com/questions/76455/how-do-you-change-the-color-of-the-border-on-a-group-box)答案？展示了如何覆盖标题和边框的绘制，但我不想处理视觉样式和绘制圆角等。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T14:13:47.223

ForeColor 是控制组框中文本颜色的属性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-26T17:01:08.680

这应该可以解决问题：

```
public Form1()
{
  InitializeComponent();
  GroupBoxRenderer.RenderMatchingApplicationState = false;
  groupBox1.ForeColor = Color.Green;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T14:14:15.243

看来我可以通过将 ForeColor 设置为我想要的颜色并将 FlatStyle 设置为 Standard 来设置标题颜色。

如果 FlatStyle 是 System，或者它是 Standard 并且 ForeColor 没有从默认值更改，则标题颜色设置为 XP Theme 中指定的颜色。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-26T08:27:11.127

以上对我没有帮助。
我通过添加 GroupBox.Header 标签[在这里找到了解决方案：](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/9e1b181f-05d8-4fb2-b61b-494555ae4b57)

```
<GroupBox>
  <GroupBox.Header>
      <TextBlock Text="Header" Foreground="Black"/>
  </GroupBox.Header>
</GroupBox> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T14:08:35.473

至少在 Delphi 中，标题只是字体颜色，您要确保 parentfont 为 false。但这可能对您根本没有用，因为您标记了您的问题 .net

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-09-21T02:32:20.043

环境

```
groupBox1.ForeColor 
```

更改位于 groupbox 内的其他控件（如按钮、标签等）的前景色，如果您只需要更改 groupbox 的文本颜色，这在大多数情况下是不受欢迎的。一个简单的解决方法是

```
 private void button1_Click(object sender, EventArgs e)
    {
        List<Color> lstColour = new List<Color>();
        foreach (Control c in groupBox1.Controls)
            lstColour.Add(c.ForeColor);

        groupBox1.ForeColor = Color.Red; //the colour you prefer for the text

        int index = 0;
        foreach (Control c in groupBox1.Controls)
        {
            c.ForeColor = lstColour[index];
            index++;
        }
    } 
```

当然，如果您稍后以编程方式将控件添加到组框，上述代码可能毫无意义，但好消息是您可以通过在代码中添加额外条件来处理所有这些情况。可以肯定的是，可以使用控制和前景色的键值对列表。

# database - 用于将数据读取/保存到数据库的 .NET 单元测试

> ID：590642
> 
> 赞同：11
> 
> 时间：2009-02-26T13:55:33.417
> 
> 标签：database, unit-testing

我读到的关于单元测试的大部分内容都是关于测试你的类及其行为。但是如何测试将数据保存到数据库和从数据库中读取数据。在我们的项目中，保存和读取数据是通过 Flex 应用程序使用的服务完成的（使用 WebORB 作为网关）。例如，一项服务会读取所有有权访问某个模块的用户。您如何测试返回的用户实际上是有权访问该模块的用户？

有时能够测试从数据库中加载数据需要数据库中已有数据。在我们的一些测试中，我们首先需要将大量测试数据保存到数据库中，然后才能测试读取的内容......

同样的事情也适用于存储过程。如果数据库中没有数据，您如何测试 sp。现实情况是，为了测试某些存储过程，我们需要十个表中的数据......

谢谢，列文卡登

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-26T14:01:53.620

这更像是一个集成测试而不是一个单元测试。

在这种情况下，我要做的是构建一个非持久性基础测试，该测试将测试所需的数据加载到 test-db 中，然后运行单元测试。之后，它会处理当前事务，因此不会存储任何数据。

这里最大的问题是，如果您的客户出现故障 - 您无法运行此类测试......另一个问题是您的 test-db 中的数据将在您每次运行此类测试时重置。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-26T14:11:44.203

您可以对 db 操作进行测试，但如果可能，请尽量避免，否则：

*   它们将比普通测试运行得慢（更有可能是集成测试）
*   他们需要更多的设置/拆卸工作（db/schema/table 数据）
*   它们引入了对您的测试框架的外部依赖

您的类没有将数据库相关工作与其他工作（例如业务逻辑）分开也可能是一种代码味道*。*然而它可能不是，我们有一个框架测试，它验证自动生成的 SQL 脚本在插入新数据后返回预期的递增标识值，AFAIK 除了针对数据库执行它之外，无法测试该代码是否正常工作。您可以将其模拟出来，或者只是假设如果 SQL 与您期望的相匹配，那么就可以了，但我不喜欢这种假设，因为很多其他代码都依赖于它。

根据您的测试框架，您应该将这些测试标记为 [Database] 相关的，以便您将它们与其他测试分开。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-26T14:11:47.027

我同意@Gambrinus。一般来说，几乎不可能对数据层进行单元测试。你能做的最好的就是提供一个强大的数据层接口并在业务层模拟它，然后为你的集成测试保存数据质量测试。

我见过模拟 ORM 工具的尝试（[这个用于 LINQ 的](http://aabs.wordpress.com/2007/06/26/using-mock-objects-when-testing-linq-code/)工具让我很开心），但它们不测试查询的正确性，只是查询是以测试人员认为应该编写的方式编写的。由于测试人员通常是针对 ORM 编写查询的人，因此这没有任何价值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-26T14:01:23.167

尝试使用[mbunit](http://mbunit.com)。它是一个 .NET 测试框架，允许您在设置中填充数据库，然后回滚您在测试期间对数据库所做的更改，将数据库恢复到之前的状态。[这里](http://weblogs.asp.net/astopford/archive/2006/07/25/MbUnit-database-testing_2C00_-and-thanks-to-Roy.aspx)有一篇关于它的快速文章。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-26T14:04:13.207

对保存到数据库和从数据库读取的代码的测试称为[集成测试](http://en.wikipedia.org/wiki/Integration_testing)。您可以在运行集成测试之前使用数据生成器生成测试数据。集成测试不必像单元测试那样频繁地运行。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-26T14:05:53.140

很有趣，我的项目也有同样的问题。模拟可能是一个很好的方法，但我没有尝试过。通常，我们用数据填充表。我编写单元测试来锻炼给定类的 CRUDL 功能。因此，如果我有一个 Person 类，单元测试包括创建、读取、更新、删除和列出。这些方法倾向于调用存储过程（在大多数情况下），因此它也会测试其中的一部分。

有一些工具可以转储大量的测试数据。

[Red Gate 的 Sql 数据生成器](http://www.red-gate.com/products/SQL_Data_Generator/index.htm)

让我们知道哪种方法对您有效。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-26T14:04:46.653

*   答：如果您的 FlexApplication 直接访问您的数据库，那么测试起来并不容易。您应该在两者之间有一个可测试的接口/层。
*   B：在“TestSetup-Phase”中将数据放入数据库是正常的。
*   C：应该可以测试实际触发存储过程的接口。
    *   如果是 sprocs 不被 GUI 使用，而只是 sql-to-sql，那么测试 sprocs 的也是“外面”的系统。通常你在实际测试之前和之后都有一个 sp_setup 和 sp_teardown sproc

# python - 如果有子类实例，如何查询模型？

> ID：590653
> 
> 赞同：2
> 
> 时间：2009-02-26T13:57:53.177
> 
> 标签：python, django, model-inheritance

我有这两个简单的模型，A 和 B：

```
from django.db import models

class A(models.Model):
  name = models.CharField(max_length=10)

class B(A):
  age = models.IntegerField() 
```

现在，我如何查询所有没有 B 实例的 A 实例？

我发现的唯一方法需要在每个子类上都有一个明确的唯一字段，该字段不为 NULL，以便我可以执行 A.objects.filter(b__this_is_a_b=None)，例如，获取不是 B 实例的实例。我正在寻找一种方法来做到这一点，而无需添加这样的明确愚蠢的标志。

我也不想查询所有对象，然后在 Python 中过滤它们。我想让数据库为我做这件事，基本上就像`SELECT * FROM A WHERE A.id in (SELECT id from B)`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T20:50:32.813

由于某些版本的 django 或 python 这也适用：

```
A.Objects.all().filter(b__isnull=True) 
```

因为如果 a 是 A 对象，当 a 存在时，ab 给出 a 的子类 B

我知道这是一个老问题，但我的回答可能会对这个主题的新搜索者有所帮助。

也可以看看：

[多表继承](https://docs.djangoproject.com/en/dev/topics/db/models/#multi-table-inheritance)

我自己对此的一个问题是：[将超类向下转换为子类](https://stackoverflow.com/questions/9821935/django-model-inheritance-create-a-subclass-using-existing-super-class)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T15:57:12.983

我不确定是否可以在单个查询中使用 Django 的 ORM 纯粹在数据库中执行此操作。这是我能做到的最好的：

```
A.objects.exclude(id__in=[r[0] for r in B.objects.values_list("a_ptr_id")]) 
```

这是 2 个 DB 查询，最适合使用简单的继承图 - A 的每个子类都需要一个新的数据库查询。

* * *

好的，这需要大量的试验和错误，但我有一个解决方案。它非常丑陋，而且 SQL 可能比只使用两个查询更糟糕，但你可以这样做：

```
A.objects.exclude(b__age__isnull=True).exclude(b__age_isnull=False) 
```

如果不引用 b 上的字段，就无法让 Django 进行连接。但是通过这些连续`.exclude()`的 s，您可以使*任何*具有 B 子类的 A 匹配一个或另一个排除项。剩下的就是没有 B 子类的 A。

无论如何，这是一个有趣的用例，你应该在 django-dev 上提出它......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T14:31:35.077

我不使用 django，但看起来你想要 isinstance(obj, type) 内置 python 方法。

**编辑：**
A.objects.exclude(id__exact=B__id) 会工作吗？

# c# - 可以为线程池重用标准线程吗？

> ID：590657
> 
> 赞同：0
> 
> 时间：2009-02-26T14:00:04.153
> 
> 标签：c#, .net, multithreading, asynchronous, threadpool

我在一个令我困惑的应用程序中有一些奇怪的行为。

我创建了一个线程，我们称之为worker，负责处理通信请求。客户端在管道上写入，而线程使用请求并发送消息。

现在，线程的主循环是这样的：

```
lock(this)
{
  object_id = Transport.BeginSend(xxx, xxx, callback, yyy)
  clientsObjects[object_id] = client_id;
} 
```

现在回调需要访问client_id（它比我写的要复杂一点，但问题是回调接收到object_id，假设BeginSend是一个调用`UdpClient.BeginSend`

```
void Callback(IAsyncResult ar)
{
  State st = (State)ar;
  lock(this)
  {
    client_id = clientsObjects[st.object_id]
  }
} 
```

锁在那里是因为回调可能会触发得如此之快以至于它实际上发生在`clientsObjects[object_id] = client_id;`可以执行之前......

好的，现在..问题是它不工作，它时不时工作......为什么？如果我跟踪正在执行 BeginSend 的线程和正在执行回调的线程的 ManagedThreadId，我发现有时它们具有相同的 ThreadId！

那可能吗？怎么会这样？关于我做错了什么的任何建议？

评论：实际代码并不完全一样，Transport 是 UDPClient 的包装器，它允许轻松更改传输层，锁不是真正的锁而是自旋锁......但概念本身或多或少是我写下来的.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T14:40:39.517

[这](http://weblogs.asp.net/justin_rogers/archive/2004/05/06/127580.aspx)是一篇较早的文章，它讨论了 Stream.BeginRead() 函数实际上是同步运行的，而不是您期望的异步运行。这篇文章来自 2004 年，所以我假设它指的是 .NET 1.0/1.1。这篇文章并没有具体提到 UdpClient.BeginSend()，但我经常想知道 Socket 中的 BeginXXX 函数是否有时具有相同的行为，尤其是在有数据要立即读取的情况下。可能值得检查一下网络，看看这是否可能。

是否可以通过 BeginSend() 函数的 state 参数将 client_id 传递给回调函数？

```
 object_id = Transport.BeginSend(xxx, xxx, Callback, client_id); 
```

# c# - 序列化和恢复未知类

> ID：590658
> 
> 赞同：11
> 
> 时间：2009-02-26T14:00:05.293
> 
> 标签：c#, xml-serialization, abstract-class

基础项目包含一个抽象基类 Foo。在单独的客户端项目中，有一些类实现了该基类。

我想通过在基类上调用一些方法来序列化和恢复具体类的实例：

```
// In the base project:
public abstract class Foo
{
    abstract void Save (string path);
    abstract Foo Load (string path);
} 
```

可以假设在反序列化时，所有需要的类都存在。如果可能的话，序列化应该在 XML 中完成。使基类实现 IXmlSerializable 是可能的。

我有点卡在这里。如果我对事物的理解是正确的，那么这只能通过`[XmlInclude(typeof(UnknownClass))]`为每个实现类添加到基类来实现 - 但实现类是未知的！

有没有办法做到这一点？我没有反思的经验，但我也欢迎使用它的答案。

**编辑：**问题是**去**序列化。只是序列化会很容易。:-)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-26T14:12:52.703

您也可以在创建 时执行此操作，方法是`XmlSerializer`在构造函数中提供其他详细信息。请注意，它不会重复使用此类模型，因此您需要配置`XmlSerializer`一次（在应用程序启动时，从配置中），然后重复使用它......注意`XmlAttributeOverrides`重载可以进行更多自定义。 .

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Xml.Serialization;
static class Program
{
    static readonly XmlSerializer ser;
    static Program()
    {
        List<Type> extraTypes = new List<Type>();
        // TODO: read config, or use reflection to
        // look at all assemblies
        extraTypes.Add(typeof(Bar));
        ser = new XmlSerializer(typeof(Foo), extraTypes.ToArray());
    }
    static void Main()
    {
        Foo foo = new Bar();
        MemoryStream ms = new MemoryStream();
        ser.Serialize(ms, foo);
        ms.Position = 0;
        Foo clone = (Foo)ser.Deserialize(ms);
        Console.WriteLine(clone.GetType());
    }
}

public abstract class Foo { }
public class Bar : Foo {} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-26T14:12:16.277

您不必将序列化函数放入任何基类中，而是可以将其添加到实用程序类中。

例如（代码仅作为示例，rootName 是可选的）

```
public static class Utility
{
       public static void ToXml<T>(T src, string rootName, string fileName) where T : class, new()
        {
            XmlSerializer serializer = new XmlSerializer(typeof(T), new XmlRootAttribute(rootName));
            XmlTextWriter writer = new XmlTextWriter(fileName, Encoding.UTF8);
            serializer.Serialize(writer, src);
            writer.Flush();
            writer.Close();
        }
} 
```

只需拨打电话

```
Utility.ToXml( fooObj, "Foo", @"c:\foo.xml"); 
```

不仅 Foo 的家族类型可以使用它，而且所有其他可序列化对象。

编辑

OK 全方位服务...（rootName 是可选的）

```
public static T FromXml<T>(T src, string rootName, string fileName) where T : class, new()
{
    XmlSerializer serializer = new XmlSerializer(typeof(T), new XmlRootAttribute(rootName));
    TextReader reader = new StreamReader(fileName);
    return serializer.Deserialize(reader) as T;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-26T14:10:38.667

好吧，序列化应该不是问题，XmlSerializer 构造函数接受一个 Type 参数，即使通过抽象基础上的方法在派生类的实例上调用 GetType 也会返回派生类型的实际 Type。所以本质上只要你在反序列化时知道正确的类型，那么正确类型的序列化是微不足道的。因此，您可以在名为 serialize 的基础上实现一个方法，或者您将什么传递`this.GetType()`给 XmlSerializer 的构造函数。或者只是将当前引用传递出去，让 serialize 方法处理它，您应该没问题。

编辑：OP编辑更新..

如果您不知道反序列化时的类型，那么您实际上只有一个字符串或字节数组，而在某个地方没有某种标识符，您就有点儿小溪了。您可以做一些事情，例如尝试将 xx 基类的每个已知派生类型反序列化，我不推荐这样做。

您的另一个选择是手动遍历 XML 并通过将类型嵌入为属性或您拥有的东西来重建对象，也许这就是您在文章中最初的意思，但就目前而言，我认为没有办法内置序列化可以在您不指定类型的情况下为您处理此问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T14:04:56.450

在 XML 命名空间深处的某个地方，有一个名为 XmlReflectionImporter 的奇妙类。

如果您需要在运行时创建模式，这可能会对您有所帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-26T14:10:35.860

[您还可以通过在构造函数](http://msdn.microsoft.com/en-us/library/e5aakyae.aspx)的所有可能类型中创建一个 XmlSerializer 密码来执行此操作。请注意，当您使用此构造函数时，每次都会编译 xmlSerializer，如果您不断地重新创建它，则会导致泄漏。您将希望创建一个序列化程序并在您的应用程序中重用它。

然后，您可以引导序列化程序并使用反射查找 foo 的任何后代。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-26T14:24:18.790

这些链接可能会对您有所帮助：

*   [代码项目文章](http://www.codeproject.com/KB/XML/xmlserializerforunknown.aspx)
*   [博文](http://mfharoon.blogspot.com/2006/12/using-ixmlserializable-to-overcome-not.html#comment-208521519005505187)
*   [堆栈溢出问题](https://stackoverflow.com/questions/20084/xml-serialization-and-inherited-types)

我有一个复杂的远程处理项目，并且希望对序列化的 XML 进行非常严格的控制。服务器可以接收它不知道如何反序列化的对象，反之亦然，因此我需要一种快速识别它们的方法。

我尝试过的所有 .NET 解决方案都缺乏项目所需的灵活性。

我在基本 xml 中存储了一个 int 属性来标识对象的类型。

如果我需要从 xml 创建一个新对象，我创建了一个检查类型属性的工厂类，然后创建适当的派生类并将 xml 提供给它。

我做了这样的事情（把它从内存中拉出来，所以语法可能有点不对）：

(1) 创建接口

```
interface ISerialize
{
    string ToXml();
    void FromXml(string xml);       
}; 
```

(2) 基类

```
public class Base : ISerialize
{
    public enum Type
    {
        Base,
        Derived
    };

    public Type m_type;

    public Base()
    {
        m_type = Type.Base;
    }

    public virtual string ToXml()
    {
        string xml;
        // Serialize class Base to XML
        return string;
     }

    public virtual void FromXml(string xml)
    {
        // Update object Base from xml
    }
}; 
```

(3) 派生类

```
public class Derived : Base, ISerialize
{
    public Derived()
    {
         m_type = Type.Derived;
    }

    public override virtual string ToXml()
    {
        string xml;
        // Serialize class Base to XML
        xml = base.ToXml();
        // Now serialize Derived to XML
        return string;
     }
     public override virtual void FromXml(string xml)
     {
         // Update object Base from xml
         base.FromXml(xml);
         // Update Derived from xml
     }
}; 
```

(4) 对象工厂

```
public ObjectFactory
{
    public static Base Create(string xml)
    {
        Base o = null;

        Base.Type t;

        // Extract Base.Type from xml

        switch(t)
        {
            case Base.Type.Derived:
                o = new Derived();
                o.FromXml(xml);
            break;
         }

        return o;
    }
}; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-26T14:17:27.153

将类标记为 Serializable 并使用~~Soap~~ BinaryFormatter 而不是 XmlSerializer 将自动为您提供此功能。序列化时将被序列化实例的类型信息写入XML，~~Soap~~ BinaryFormatter可以在反序列化时实例化子类。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-12-06T17:03:11.750

此方法读取 XML 根元素并检查当前正在执行的程序集是否包含具有此类名称的类型。如果是这样，则对 XML 文档进行反序列化。如果不是，则抛出错误。

```
public static T FromXml<T>(string xmlString)
{
    Type sourceType;
    using (var stringReader = new StringReader(xmlString))
    {
        var rootNodeName = XElement.Load(stringReader).Name.LocalName;
        sourceType =
                Assembly.GetExecutingAssembly().GetTypes()
                    .FirstOrDefault(t => t.IsSubclassOf(typeof(T)) 
                                    && t.Name == rootNodeName)
                ??
                Assembly.GetAssembly(typeof(T)).GetTypes()
                    .FirstOrDefault(t => t.IsSubclassOf(typeof(T)) 
                                    && t.Name == rootNodeName);

        if (sourceType == null)
        {
            throw new Exception();
        }
    }

    using (var stringReader = new StringReader(xmlString))
    {
        if (sourceType.IsSubclassOf(typeof(T)) || sourceType == typeof(T))
        {
            var ser = new XmlSerializer(sourceType);

            using (var xmlReader = new XmlTextReader(stringReader))
            {
                T obj;
                obj = (T)ser.Deserialize(xmlReader);
                xmlReader.Close();
                return obj;
            }
        }
        else
        {
            throw new InvalidCastException(sourceType.FullName
                                           + " cannot be cast to "
                                           + typeof(T).FullName);
        }
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-12-08T08:51:40.843

我使用未知（但预期）类的 XmlType 属性来确定反序列化的类型。预期的类型在 AbstractXmlSerializer 类的实例化期间加载并放置在字典中。在反序列化过程中，根元素被读取，并由此从字典中检索类型。之后就可以正常反序列化了。

**XmlMessage.class：**

```
public abstract class XmlMessage
{
} 
```

**IdleMessage.class：**

```
[XmlType("idle")]
public class IdleMessage : XmlMessage
{
    [XmlElement(ElementName = "id", IsNullable = true)]
    public string MessageId
    {
        get;
        set;
    }
} 
```

**AbstractXmlSerializer.class：**

```
public class AbstractXmlSerializer<AbstractType> where AbstractType : class
{
    private Dictionary<String, Type> typeMap;

    public AbstractXmlSerializer(List<Type> types)
    {            
        typeMap = new Dictionary<string, Type>();

        foreach (Type type in types)
        {
            if (type.IsSubclassOf(typeof(AbstractType))) {
                object[] attributes = type.GetCustomAttributes(typeof(XmlTypeAttribute), false);

                if (attributes != null && attributes.Count() > 0)
                {
                    XmlTypeAttribute attribute = attributes[0] as XmlTypeAttribute;
                    typeMap[attribute.TypeName] = type;
                }
            }
        }
    }

    public AbstractType Deserialize(String xmlData)
    {
        if (string.IsNullOrEmpty(xmlData))
        {
            throw new ArgumentException("xmlData parameter must contain xml");
        }            

        // Read the Data, Deserializing based on the (now known) concrete type.
        using (StringReader stringReader = new StringReader(xmlData))
        {
            using (XmlReader xmlReader = XmlReader.Create(stringReader))
            {
                String targetType = GetRootElementName(xmlReader);

                if (targetType == null)
                {
                    throw new InvalidOperationException("XML root element was not found");
                }                        

                AbstractType result = (AbstractType)new
                    XmlSerializer(typeMap[targetType]).Deserialize(xmlReader);
                return result;
            }
        }
    }

    private static string GetRootElementName(XmlReader xmlReader)
    {            
        if (xmlReader.IsStartElement())
        {
            return xmlReader.Name;
        }

        return null;
    }
} 
```

**单元测试：**

```
[TestMethod]
public void TestMethod1()
{
    List<Type> extraTypes = new List<Type>();
    extraTypes.Add(typeof(IdleMessage));
    AbstractXmlSerializer<XmlMessage> ser = new AbstractXmlSerializer<XmlMessage>(extraTypes);

    String xmlMsg = "<idle></idle>";

    MutcMessage result = ser.Deserialize(xmlMsg);
    Assert.IsTrue(result is IdleMessage);           
} 
```

# ruby-on-rails - 在哪里可以找到高级 Ruby on Rails 教程？

> ID：590666
> 
> 赞同：12
> 
> 时间：2009-02-26T14:01:25.367
> 
> 标签：ruby-on-rails, ruby

我正在创建 rails 应用程序，想知道在哪里可以找到关于如何使用 rails 的好教程。

我使用了这个我认为非常适合开始学习 Rails 的博客：

[http://fairleads.blogspot.com/2007/12/rails-20-and-scaffolding-step-by-step.html](http://fairleads.blogspot.com/2007/12/rails-20-and-scaffolding-step-by-step.html)

我刚刚开始使用 Rails，现在想学习更高级的 Rails。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-26T14:05:46.230

有很多学习 Rails 的资源，

*   [railscasts.com/](http://railscasts.com/)
*   [newwiki.rubyonrails.org/](http://newwiki.rubyonrails.org/)
*   [http://www.ruby-forum.com/forum/3](http://www.ruby-forum.com/forum/3)

这些是免费的截屏视频和论坛，如果你想要一本书，我向你推荐[Obie Fernandez 的 Rails Way](https://rads.stackoverflow.com/amzn/click/com/0321445619)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-26T17:53:37.820

绝对是[http://guides.rubyonrails.org/](http://guides.rubyonrails.org/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-26T16:25:18.920

这里还有一些非常好的商业截屏视频：

*   [http://peepcode.com/](http://peepcode.com/)
*   [http://envycasts.com/](http://envycasts.com/)

但是，大多数更高级的教程都分散在针对特定问题或功能的博客文章中。我曾经在我的谷歌阅读器中有[ruby​​corner.com](http://rubycorner.com/)，并且会监视它以获取有用的内容，并订阅我发现的博客的各个提要，这些博客的内容一直很好。

此外，[Apidock.com](http://apidock.com)在出色的用户界面中拥有 rails、ruby 和 rspec 文档以及许多有用的用户评论。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T16:12:55.270

我完全不同意 Rails 方式。一旦您已经基本了解 Rails 基础知识，那将是一本好书，但它确实不是教程风格。我猜不同的人有不同的笔画。

我的建议是，您应该寻找一本更面向教程并且最近发布的书，因为 Rails 变化如此之快，以至于您的书一眨眼就会过时。选择您自己的项目并按照教程进行调整以适应您的项目需求。总是，除非你做的事情非常简单，否则你会发现教程很短，你必须自己研究解决方案，但这是最好的学习方式。

请注意，几乎所有在线教程都已过时。可能有超过一半的 railscasts 是针对 2.0 之前的 rails 的。 [Rails 指南](http://guides.rubyonrails.org/)非常好并且是最新的，甚至已经开始包含版本之间差异的注释。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-28T00:52:34.217

还可以获取 Ruby Inside、Ruby Flow 和 Rails Inside 等网站的 RSS 提要。它们只是一些 Ruby/Rails 博客，还有更多，但这是一个好的开始，也是查找您永远不会知道的信息的好方法。很多材料不适合初学者，但不要让你不知所措，拥有所有的信息会得到回报，而且那里有一些很棒的入门内容，有时可能正是你所追求的。

# sql - 使用 VIEW 进行 SELECT 操作可以提高性能吗？

> ID：590669
> 
> 赞同：3
> 
> 时间：2009-02-26T14:02:32.383
> 
> 标签：sql, performance, oracle

致力于提高我们决策中心的性能，我们发现的瓶颈之一是数据库。

所以我想知道，oracle 是否为它的观点编译了一个执行计划？

让我们假设我`10000`在请求期间有一个已定义的查询被使用次数。查询类似于：

```
select A, B, C 
from aTbl, bTbl left join cTbl on bTbl.cTblID = cTbl.objectkey
where aTbl.objectkey = bTbl.parentkey 
```

在代码中，我想使用附加过滤参数来获取上面的查询结果，例如：`WHERE aTbl.flag1 = <<NUMBER>>`

现在我有两个选择：

1.  使用上述创建准备好的语句`SQL`，然后重用该对象。
2.  将上述`select (aTbl, bTbl, cTbl)`内容放入 a`VIEW`中，然后在此视图上创建准备好的语句，从而受益于预编译 b Oracle 的执行计划。

你有什么建议？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-26T14:07:39.987

`Oracle` *如果它认为它将改进计划，则*可能会将谓词推入视图。**

 *如果您想避免这种情况，您可以使用以下任一方法：

1.  在视图定义中添加`/*+ NO_MERGE */`或提示`/*+ NO_PUSH_PRED */`
2.  在使用视图的查询中添加`/*+ NO_MERGE (view) */`或提示。`/*+ NO_PUSH_PRED (view) */`

如果您想强制执行此操作，请使用他们的对手`/*+ PUSH_PRED */`和`/*+ MERGE */`

只要考虑性能，使用定义的视图（如果它`MATERIALIZED VIEW`当然不是）或内联视图（即子查询）没有区别。

`Oracle`编制计划不是为了视图，而是为了准确的`SQL`文本。

也就是说，对于以下语句：

```
SELECT A, B, C 
FROM   aTbl, bTbl
LEFT JOIN cTbl ON 
  bTbl.cTblID = cTbl.objectkey
WHERE aTbl.objectkey = bTbl.parentkey
  AND aTbl.flag1 = :NUMBER

SELECT *
FROM
  (
  SELECT A, B, C, flag1
  FROM   aTbl, bTbl
  LEFT JOIN cTbl ON 
    bTbl.cTblID = cTbl.objectkey
  WHERE aTbl.objectkey = bTbl.parentkey
  )
WHERE flag1 = :NUMBER

/*
CREATE VIEW v_abc AS
SELECT A, B, C, flag1 
FROM   aTbl, bTbl
LEFT JOIN cTbl ON 
  bTbl.cTblID = cTbl.objectkey
WHERE aTbl.objectkey = bTbl.parentkey
*/

SELECT A, B, C
FROM v_abc
WHERE flag1 = :NUMBER 
```

该计划将：

1.  相同（如果`Oracle`会选择推送谓词，这很有可能）；
    *   首次调用时编译；
    *   再次调用时被重用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T14:22:32.197

视图并不是您真正想要的。

您想要做的是为您的标志条件使用[绑定变量](http://www.akadia.com/services/ora_bind_variables.html)；这样你就可以编译语句一次，并为不同的标志执行多次。

就像一个风格注释一样——你应该决定如何指定连接，并遵循它，以保持一致性和可读性。照原样，您有 atbl 和 btbl 的显式连接条件，以及 btbl 和 ctbl.. 的“左连接”语法在事物方案中并不重要，但看起来和读起来有点奇怪。

祝你好运！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-26T14:51:41.253

视图不会导致性能提升。有时它们可​​能会降低性能。我并不是说你应该避免观点；在使用它们之前只知道可能的影响。[Oracle 文档](http://download.oracle.com/docs/cd/B19306_01/server.102/b14211/design.htm#i28177)说：

> 视图可以加速和简化应用程序设计。一个简单的视图定义可以掩盖数据模型的复杂性，程序员的优先级是检索、显示、收集和存储数据。
> 
> 然而，虽然视图提供了干净的编程接口，但它们可能会导致次优、资源密集型查询。最糟糕的视图使用类型是当一个视图引用其他视图时，以及当它们加入查询时。在许多情况下，开发人员可以直接从表中满足查询，而无需使用视图。通常，由于其固有属性，视图使优化器难以生成最佳执行计划。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-27T03:21:33.773

我认为这不是您要寻找的，但是如果底层表格不经常更改，例如每天或每小时，您可以使用物化视图。这基本上是一个存储的结果集。您还可以在它们上添加索引。它们可以按计划刷新，也可以在底层表发生变化时刷新（对于 OLTP 而言并非如此）。

[这是 Oracle 关于使用物化视图的文档。](http://download.oracle.com/docs/cd/B19306_01/server.102/b14223/basicmv.htm#g1028195)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T14:22:26.703

Oracle 中没有“预编译”视图：从定义的视图中选择与直接从表中选择在性能方面没有什么不同（假设所有连接和条件都相同）。

当您说您的查询是“在请求期间被使用 10000 次”时，我感到很困惑。这听起来不太理想 - 为什么会这样？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-26T14:25:08.663

这里的答案是“是”和“否”。

oracle 只会解析一个语句一次。关键是它必须是“相同的”，而不仅仅是相似。这包括间距（或制表符）和注释。

创建视图`create view`允许您按原样修复语句并允许重用。

然而。

`SELECT * FROM VIEW`
和
`SELECT * FROM VIEW WHERE A=1`

是 2 个不同的语句/查询。

要获得最大的语句重用，您必须使用绑定变量，而不仅仅是将条件连接到您的 SELECT 上。这通常意味着准备好的陈述

如果可以的话，您没有提到哪种宿主语言，如果可以的话，我会用一个具体的例子进行更新。

在 PL/SQL 中

```
宣布
  光标 c (cpflag aTbl.flag1%TYPE ) 是
   选择 A、B、C
     来自 aTbl、bTbl、cTbl
    其中 aTbl.objectkey = bTbl.parentkey
      和 bTbl.cTblID = cTbl.objectkey
      和 aTbl.flag1 = cp_flag ；

vtype c%rowtype;
开始

打开 c(100);
将 c 提取到 vtype 中；
关闭 c;

打开 c(200);
将 c 提取到 vtype 中；
关闭 c;
结尾;

```

在诸如 java 之类的准备语句中，您输入“？” 作为占位符并使用 stmt.bind() 调用

希望有帮助

# ruby-on-rails - 在将 redbox 插件安装到 rails 时，为什么它说找不到插件？

> ID：590676
> 
> 赞同：0
> 
> 时间：2009-02-26T14:04:49.150
> 
> 标签：ruby-on-rails, ruby, plugins

当我尝试安装 redbox 插件时，尽管一切都已安装，最后一行显示未找到插件。这是为什么 ？

```
script/plugin install http://svn2.cvsdude.com/craigambrose/plugins/redbox
+ ./README
+ ./Rakefile
+ ./images/redbox_spinner.gif
+ ./init.rb
+ ./install.rb
+ ./javascripts/redbox.js
+ ./lib/redbox.rb
+ ./lib/redbox_helper.rb
+ ./stylesheets/redbox.css
+ ./tasks/redbox_tasks.rake
+ ./test/redbox_test.rb
Plugin not found: ["http://svn2.cvsdude.com/craigambrose/plugins/redbox"] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T23:37:40.707

里面的路径`vendor/plugins/redbox/install.rb`似乎是错误的：

```
plugins_dir = File.expand_path(".")
redbox_dir = File.join(plugins_dir, 'redbox')
root_dir = File.join(redbox_dir, '..', '..', '..')

File.copy File.join(redbox_dir, 'javascripts', 'redbox.js'), File.join(root_dir, 'public', 'javascripts', 'redbox.js')
File.copy File.join(redbox_dir, 'stylesheets', 'redbox.css'), File.join(root_dir, 'public', 'stylesheets', 'redbox.css')
File.copy File.join(redbox_dir, 'images', 'redbox_spinner.gif'), File.join(root_dir, 'public', 'images', 'redbox_spinner.gif') 
```

`redbox_dir`路径不考虑`vendor/plugins`路径组件。但是您可以通过手动将上面列出的三个文件从`vendor/plugins/redbox`目录复制到应用程序目录下的相应子目录来完成安装`public`。

# asp.net-mvc - 将 MVC 视图和母版页包含为 DLL 资源，而不是单独的文件

> ID：590683
> 
> 赞同：0
> 
> 时间：2009-02-26T14:06:13.250
> 
> 标签：asp.net-mvc, build-process

在发布 ASP.NET MVC 应用程序时是否存在一种方法，通过将 .aspx 视图文件（如果可能的话，也包括 .master）作为资源编译到应用程序 DLL 中来完全删除它们？

发布的应用程序将只是 /bin 文件夹、Global.asax 和 web.config，如果需要，还可以是 default.aspx，以及 /Content 文件夹中的任何内容。所有视图都将包含在*MyProject* .dll 文件中。

为了澄清，我并不是说每个 .aspx 都被引用正确资源的 1 行虚拟文件覆盖，而是在已发布的应用程序中可以完全消除这些文件。

这里的目标是简单地更改管理以及围绕它的所有审核和人员层 - 一个文件被部署，该文件替换现有文件，并且不会乱用一堆必须添加/删除的 .aspx 文件/更新（是的，SVN 或类似的解决方案可以处理该问题，但管理政治阻止了这一点）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T08:15:34.660

这是[你](https://stackoverflow.com/questions/531416/including-views-in-a-class-library)要找的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-03T15:57:12.503

可以使用 Web 表单视图引擎，但您必须自己扩展路径提供程序。

这里有一个关于同一件事的问题： [Using VirtualPathProvider to load ASP.NET MVC views from DLLs](https://stackoverflow.com/questions/236972/using-virtualpathprovider-to-load-asp-net-mvc-views-from-dlls)

如果您使用 Spark 视图引擎，它已经内置了额外的路径提供程序。

可以在此处找到文档： [将视图文件夹添加到配置](http://sparkviewengine.com/documentation/viewlocations#Addingaviewfoldertoconfig)

它允许您使用默认的虚拟目录或插入您自己的自定义提供程序，将您的视图作为嵌入式资源定位在 DLL 中，在文件系统的其他位置。

# php - PHP中的多线程

> ID：590684
> 
> 赞同：6
> 
> 时间：2009-02-26T14:06:14.043
> 
> 标签：php, multithreading

我最近阅读了有关[http://php.net/pcntl](http://php.net/pcntl)的信息，并且正在了解这些功能的工作原理以及在 PHP 中使用多线程是否明智，因为它不是 PHP 的核心功能。

我想通过它触发不需要反馈的事件，例如手动触发 cronjob 执行。

所有这些都应该在使用 Zend Framework 编写的 Web 应用程序中运行

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-26T14:19:50.610

pcntl 包工作得很好——它只是使用了相应的[unix 函数](http://linux.die.net/man/2/fork)。唯一的不足是，如果从 Web 服务器上下文调用 php，则不能使用它们。即，您可以在 shell 脚本中使用它，但不能在网页上使用它 - 至少在不使用诸如使用 exec或类似[调用分叉脚本之类的黑客攻击的情况下不能。](http://joseph.randomnetworks.com/archives/2005/10/21/fake-fork-in-php/)

[编辑] 我刚刚找到一个解释[为什么 mod_php 不能 fork](http://www.mail-archive.com/php-bugs@lists.php.net/msg95558.html)的页面。基本上这是一个安全问题。[/编辑]

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-26T15:51:07.617

这不是线程控制，这是进程控制。线程库是[pthreads（POSIX 线程）](http://en.wikipedia.org/wiki/POSIX_Threads)，它不包含在 PHP 中，因此 PHP 中没有多线程函数。

对于多处理，您不能在 mod_php 中使用它，因为那将是一个巨大的安全漏洞（生成的进程将拥有所有 Web 服务器的权限）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-26T14:22:45.893

让 php 代码在多个线程中执行的唯一可能方法是将 php 作为线程 Web 服务器的模块运行，这是没有用的，因为线程是完全隔离的，并且您的代码无法控制它们。据我所知， pcntl 只管理进程，而不是线程。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-26T16:03:19.677

如果我需要从 PHP 执行手动 crontab 执行或类似操作，我可能会使用队列。有一个将作业附加到的数据库表。另一个进程，无论是来自 cron 还是作为守护进程运行，都会在作业出现时执行它们。

另一种方法是设置一个单独的脚本并对其执行 HTTP GET。它不是线程化的，但它是对 PHP 中另一个命令的一种脱壳方式。

例如，如果我想`/usr/bin/somescript.sh`按需运行，我就会有`somescript.php`一个系统调用。这将位于只能从 localhost 访问的虚拟主机上。

我会对网络服务器进行套接字调用并获取脚本。关键是*不要*在套接字上读取，这样它就不会阻塞。如果我想检查 的返回值`somescript.php`，我稍后会在我的主脚本中进行检查以防止阻塞。

如果`somescript.php`执行需要很长时间（比调用脚本更长），您将不得不做一些魔术来阻止 apache 在套接字关闭时杀死脚本。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-07-03T12:11:53.047

多平台 PHP 多线程引擎 [http://anton.vedeshin.com/articles/lightweight-and-multiplatform-php-multithreading-engine](http://anton.vedeshin.com/articles/lightweight-and-multiplatform-php-multithreading-engine)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-10-14T11:46:00.243

在 PHP 中工作的多线程示例（摘自他们的项目页面）：

*   [Cron 多线程](https://www.drupal.org/project/cron_mt)。

> 截至 2011 年 10 月 25 日，此模块已“终止使用”并且已弃用，以支持[Elysia Cron](http://drupal.org/project/elysia_cron)等项目。这个模块并非完全没用，因为受 Cron MT 启发的核心补丁被提交给了 D7。

*   [升压](https://www.drupal.org/project/boost)。

> ... 为 Drupal 提供静态页面缓存，为主要接收匿名流量的站点提供非常显着的性能和可扩展性提升。对于共享主机，这是提高性能的最佳选择。在专用服务器上，您可能需要考虑使用 Varnish。

# asp.net - 任何人都可以推荐条码网络服务器控件吗？

> ID：590695
> 
> 赞同：2
> 
> 时间：2009-02-26T14:09:33.023
> 
> 标签：asp.net, barcode, web-controls

任何人都可以推荐用于格式 39 和 128 格式的条码 Web 服务器控件吗？

更新：在选择了我们从未听说过的 3 个控件后，我发布了此消息。我希望得到使用流行、稳定和商业产品的人的推荐。看起来我们只会选择我们的经理发送的选择之一。如果您在事后阅读此内容，并且有很好的推荐，请添加它以供将来需要的其他人使用。谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-26T14:59:28.317

有一系列关于 CodeProject 文章的文章就是这样做的：

*   [在 Windows 中绘制条码第 1 部分 - Code 39](http://www.codeproject.com/KB/graphics/barcode1.aspx)
*   [在 Windows 中绘制条码第 5 部分 - Code 128](http://www.codeproject.com/KB/graphics/barcode5.aspx)

另一个：

*   [条码图像生成库](http://www.codeproject.com/KB/graphics/barcode1.aspx)

另一种方式，使用条形码字体，但在 ASP.Net 中使用简单

*   [ASP.NET 应用程序中的条形码](http://www.codeproject.com/KB/aspnet/AspBarCodes.aspx)

实际上，如果您坚持使用简单的一维条码，实现您自己的条码绘制程序并不难。
关于这个主题的最好的书是[The Bar Code Book](https://rads.stackoverflow.com/amzn/click/com/1425133746)。这是一本绝对的参考书，你只是想保留和阅读纯粹的书呆子乐趣。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-26T17:17:20.387

www.codeplex.com 上还有一个开源的 ASP.NET 条码生成框架：

[http://www.codeplex.com/BarcodeRender](http://www.codeplex.com/BarcodeRender)

我确实对 Interleaved 2 of 5 符号系统有疑问，但我相信它是最近才添加的。也许其他符号系统更稳定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T22:05:05.830

伙计们……不要走得太远。有可轻松用于绘制条形码的 Windows 字体（TrueType 字体/TTF）。Graphics 对象是你的朋友。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T14:41:07.027

您绝对应该检查以下两个选项：

1) [www.idautomation.com](http://www.idautomation.com)

2）[barbeque](http://barbecue.sourceforge.net/)开源库（Java）生成条码。

两者都很棒！

# richtext - 类 Wiki 文本编辑器保留原始标记的最佳选择？

> ID：590696
> 
> 赞同：4
> 
> 时间：2009-02-26T14:10:34.050
> 
> 标签：richtext

我们需要一个能够保留原始标记的基于 Web 的类似 wiki 的富编辑器。目前，给定的自定义标记正在转换为 html 以进行显示和编辑（允许人们在链接和类似情况下编辑 html），然后在保存时转换回特定标记。这显然容易出错且不理想。

第一个重大决定是在纯**javascript**基于 html 的解决方案（如[TinyMCE](http://tinymce.moxiecode.com/)）和更面向客户端的解决方案（如 flash 或**silverlight** ）之间做出决定，这将使我们不必担心 html 等。

根据您的经验，目前最好的选择是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T15:26:25.350

这是一个很长的讨论。我的建议是使用具有良好 XHTML 输出的 JavaScript。根本不要使用闪光灯或银光。

对于我的项目，我使用了 YUI 文本编辑器，一切都非常好。在这里试试：http: [//developer.yahoo.com/yui/examples/editor/skinning_editor.html](http://developer.yahoo.com/yui/examples/editor/skinning_editor.html)

试试这个链接，这是一个非常好的网络编辑器比较，可以得到你需要的东西：

*   [http://geniisoft.com/showcase.nsf/WebEditors](http://geniisoft.com/showcase.nsf/WebEditors)
*   [http://blog.webdistortion.com/2008/03/09/9-of-the-best-rich-text-editors-reviewed/](http://blog.webdistortion.com/2008/03/09/9-of-the-best-rich-text-editors-reviewed/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-10T12:59:47.647

用户的种类和使用数据的环境有很多话要说。HTML 是一种演示格式，因此使用它来编辑内容是次优的。在很多情况下，您需要将内容与表示分离，然后 HTML 会因此而给您带来麻烦。您当然可以尝试将输入限制为 HTML 的子集，但这很难做到正确，并且首先会削弱这个想法，因为输入不再是真正的所见即所得。CMS 多年来一直在努力解决这个问题，所以我想没有简单的解决方案。

如果您的编辑是高级用户（可能是程序员，但我在普通人方面取得了成功），您可以让他们以 markdown 或类似的以内容为中心的格式输入内容，然后在演示时将其转换为 HTML。这种方法的最大障碍似乎是缺乏实时预览（所见即所得）。我已经使用[Showdown](http://attacklab.net/showdown/)实时呈现预览，就像这个网站一样 - 我最近为一种混合所见即所得类型的输入[制作了一个小部件](http://github.com/troelskn/upflow/tree/master)，你可能会发现它很有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-26T14:34:32.387

在 Mozilla，他们一直在研究这个：

[Mozilla 贝斯平](https://bespin.mozilla.com/index.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-10T10:23:45.430

[如果您使用Markdown](http://daringfireball.net/projects/markdown/basics)或[Textile](http://www.textism.com/tools/textile/)之类的东西，您可能不需要允许直接 HTML 编辑——用户将始终使用内容的纯文本表示，而按需单向纯文本到 HTML 转换将是可以在 HTML 页面中获得更好的外观。

如果需要，有许多 Ruby Gem 可以帮助您实现 Markdown 和 Textile 纯文本到 html 的转换。还有一些不错的降价编辑器（作为 SO 使用的编辑器）。

在我看来，纯文本编辑（在 Markdown、Textile 或类似中）就足够了，并且在大多数情况下是更好的选择。这绝对是一种用于创建丰富内容的非常轻量级且符合标准的方法，尽管 Markdown、Textile 等不涵盖所有可能的格式选项，但纯文本路径值得认真考虑。

你也可以在 StackOverflow 上看到——它使用 Markdown 来提问和回答——这是一个不错的选择。我强烈支持能够看到“格式化标签”的需要，因为所见即所得几乎总是会导致错误放置/不需要的标签。此外，使用纯文本格式可以让您**100% 控制生成的 HTML**。

如果您**必须**使用 WYSIWYG，我对 TinyMCE 的体验足以推荐它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-10T10:35:26.120

我们使用[Screwturn](http://www.screwturn.eu)开发基于内部知识的wiki 页面，供我们的开发人员参考。我会说它是一个不错的免费 wiki 工具。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-11T06:44:14.293

我建议使用基于 Javascript 的编辑器。那里有很多，它们真的很好。与 JS 编辑器相比，我发现基于 flash / java / active x / 等的编辑器速度慢且笨拙。

我喜欢的一些 JS 编辑器是：

*   [FCK编辑器](http://www.fckeditor.net/demo)
*   [TinyMCE](http://tinymce.moxiecode.com/examples/full.php)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-12T08:19:10.143

我个人喜欢 TinyMCE。

使用 TinyMCE 时，我可以推荐查看 BB 代码。我在编辑器中以 BB 代码实时呈现的文本，因此它看起来像粗体或您想要的样式。

将其以 BB 代码格式保存到数据库中，然后在显示文本时使用字符串替换器。

如果您想要标准的 wiki 标记，您可以制作自己的插件来呈现 wiki 代码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-06-14T20:54:41.793

WordPress 附带的 JavaScript 编辑器非常棒。

# security - Grails 的用户管理插件/框架？

> ID：590708
> 
> 赞同：15
> 
> 时间：2009-02-26T14:12:08.507
> 
> 标签：security, grails, plugins

是否有用于 grails 的用户管理插件？

几乎每个网站都需要以下内容：

*   用户登录/认证
*   注册（带电子邮件验证）
*   忘记电子邮件提醒用户
*   用户资料

是否有任何 Grails 插件/框架/任何提供此类东西作为构建基础的东西？

我知道如何构建这些东西，所以我不是在寻找那种类型的答案。每个人都重新实现这种类型的基本功能似乎很愚蠢。

Java 中的一个类似示例是 AppFuse，但这比我在这里寻找的要复杂得多。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-03-05T04:32:52.710

任何在 2010 年今天看到这个问题的人都可以看看 Nimble 插件：[http ://www.grails.org/plugin/nimble](http://www.grails.org/plugin/nimble)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-26T14:20:03.637

我认识的有一对，

[http://www.grails.org/AcegiSecurity+Plugin](http://www.grails.org/AcegiSecurity+Plugin)

基于流行的 Acegi Security（现在称为 Spring Security），对于您想要的东西可能有点重量级。

其次

[http://www.grails.org/Authentication+Plugin](http://www.grails.org/Authentication+Plugin)

这是一个更轻量级的实现。

其他可以在[http://www.grails.org/Plugins](http://www.grails.org/Plugins)的“安全插件”下找到

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-03-30T00:13:26.263

以下是一些新增功能：[Spring Security UI](http://grails.org/plugin/spring-security-ui)和[Grum](http://code.google.com/p/grum/)。两者都有最近（2012 年）的活动，不像 Stark 和 Nimble，后者似乎已经停止了开发（最近一次更新是从 2 年前开始的）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-26T15:17:08.493

如果您对基于 Spring 安全性的解决方案感兴趣，可以查看 Stark：

[http://www.grails.org/Stark+Security+Plugin](http://www.grails.org/Stark+Security+Plugin)

# cocoa - 如何禁用 NSTextField 的拖放功能？

> ID：590713
> 
> 赞同：1
> 
> 时间：2009-02-26T14:13:20.940
> 
> 标签：cocoa, drag-and-drop, nstextfield, nsdragginginfo

我想禁止将任何内容放入我的 NSTextField。在我的应用程序中，用户可以将 iCal 事件拖放到 GUI 的不同部分。现在我有一个测试用户不小心将 iCal 事件放到了文本字段中——但他没有意识到这一点，因为文本被插入到我在单行文本字段中看到的行的上方。

（您可以通过单击文本字段并使用键盘排成一行来显示插入的文本 - 但普通用户不会这样做，因为他/她甚至不会意识到首先插入了某些内容！）

我试过`registerForDraggedTypes:[NSArray array]]`（似乎没有任何效果）以及实现`draggingEntered:`委托方法返回`NSDragOperationNone`（委托方法甚至没有被调用）。

有任何想法吗？

**编辑：**当然，将某些内容放到 NSTextField 上只有在它具有焦点时才有效，正如 ssp 在[他的博客](http://earthlingsoft.net/ssp/blog/2007/08/cocoa_bitching#draganddrop)中和[Daniel Jalkut 对博客条目的评论中](http://www.red-sweater.com/blog/142/drag-if-you-want-to#comments)所描述的那样。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-08-11T12:40:49.867

我很高兴你在我的博客文章中发现了这些评论。我认为它们是发现如何实现您正在寻找的东西的冰山一角。

您需要记住，当一个`NSTextField`作品有焦点时，拖到它的原因是它`NSTextField`本身暂时被一个更丰富、更强大的视图（an `NSTextView`）所遮蔽，它被称为“字段编辑器”。

在字段编辑器上查看 Apple 文档的这一部分：

[https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/TextEditing/Tasks/FieldEditor.html](https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/TextEditing/Tasks/FieldEditor.html)

为了实现您的目标，我认为您可能需要`NSTextField`通过实现窗口委托方法来拦截您的字段编辑器的标准规定：

`windowWillReturnFieldEditor:toObject:`

这使您有机会调整 上的配置`NSTextView`，或提供全新的字段编辑器对象。

在最坏的情况下，您可以提供自己的`NSTextView`子类作为字段编辑器，旨在拒绝所有拖拽。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-25T03:54:11.230

这可能有效：如果您将 NSTextView 子类化并实现`-acceptableDragTypes`return `nil`，则文本视图将被禁用为拖动目标。我还必须实现 NSDraggingDestination 方法`-draggingEntered:`并`-draggingUpdated:`返回 NSDragOperationNone。

```
@implementation NoDragTextView
- (NSArray *)acceptableDragTypes
{
    return nil;
}
- (NSDragOperation)draggingEntered:(id<NSDraggingInfo>)sender
{
    return NSDragOperationNone;
}
- (NSDragOperation)draggingUpdated:(id<NSDraggingInfo>)sender
{
    return NSDragOperationNone;
}
@end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-12-10T02:51:05.230

我能够通过创建自定义 NSTextView 并实现进入和退出 NSDraggingDestination 协议方法以将 NSTextView 设置为隐藏来解决此问题。一旦文本字段被隐藏，超级视图将能够捕获拖放事件，或者如果超级视图没有实现或想要拖放它们被丢弃

例如：

```
- (NSDragOperation)draggingEntered:(id<NSDraggingInfo>)sender {

    //hide so that the drop event falls through into superview's drag/drop view
    [self setHidden:YES];

    return NSDragOperationNone;
}

- (void)draggingExited:(id<NSDraggingInfo>)sender {

    //show our field editor again since dragging is all over with
    [self setHidden:NO];

} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-26T20:07:11.820

你有没有尝试过

```
- (void)unregisterDraggedTypes
```

来自 NSView？

# vb.net - Collection(Of T) 是基于 0 的数组还是基于 1 的数组？

> ID：590726
> 
> 赞同：1
> 
> 时间：2009-02-26T14:18:55.467
> 
> 标签：vb.net

如果它是从 0 开始的，我们如何添加一个占位符使其从 1 开始呢？谢谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-26T14:22:55.393

它是从 0 开始的。一个返回的问题可能是：你*为什么*要让它从 1 开始？

使用扩展方法，您可以（如果您愿意）执行以下操作：

```
<Extension()>
Public Function GetOneBased(Of T)(ByVal list As IList(Of T), ByVal index As Integer) As T
   Return list(index-1)
End Function

<Extension()>
Public Sub SetOneBased(Of T)(ByVal list As IList(Of T), ByVal index As Integer, ByVal value As T)
   list(index-1) = value
End Sub 
```

然后使用（来自几乎任何集合）：

```
Dim foo = data.GetOneBased(1)
data.SetOneBased(1, bar) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T14:22:11.090

它是基于 0 的。如果你想让它基于 1 为什么不创建一个接受索引的读取方法删除一个然后使用它并返回值？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T14:27:46.880

您可以使用[Insert( int index, T item )](http://msdn.microsoft.com/en-us/library/ms132411.aspx)在位置 0 插入一个项目，但我认为您最好执行索引算术并将引用作为基于 0 的集合。这是大多数程序员在你之后所期望的。@Robert 的扩展方法想法有一定的价值，但我认为最终会让你的代码的最终维护者感到困惑。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T14:50:39.117

为什么要让它从 1 开始？VB.Net 中的数组也使用基于 0 的索引。

# c++ - 强大的音频库

> ID：590730
> 
> 赞同：1
> 
> 时间：2009-02-26T14:19:32.280
> 
> 标签：c++, audio

你能推荐一个强大的音频库吗？

我需要它独立地进行 timestrech 和 pitchshift，以及让我完全访问原始音频数据并让我将字节流式传输到它的管道中。

其他效果，如 eq、过滤、失真是一个加号。

需要可从 C++/Linux 访问。

也许 gstreamer、xine 或 mplayer 会起作用？或者你有什么建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T17:48:24.587

I think [**FMod**](http://www.fmod.org/) is widely recognized as one of the most powerful audio engine available for free until you do something commercial with it, and cross-platform, like in console-mac-pc cross-platform.

Now, [**OpenAL**](http://connect.creativelabs.com/openal/default.aspx) is worth giving a try.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T16:21:44.687

我相信 OpenAL、PulseAudio、JACK 和 Phonon 都以某种形式具有这些特性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T01:46:05.390

如果您愿意为此付费，Miles 非常好。除了业余爱好项目之外，我不推荐 FMOD。它有一些真正令人讨厌的错误，我已经看到新版本引入了尽可能多的修复。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T21:15:37.553

我以前用过[soundtouch](http://www.surina.net/soundtouch/)。专注于改变速度/音高/等。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-26T14:31:12.660

[ALSA](http://www.alsa-project.org/main/index.php/Main_Page)看起来很大。

[JACK](http://jackaudio.org/) for Linux 看起来也很有希望。

# apache-flex - Flex 和伪造的 Mxml 初始化而不实际显示组件，（更深入）

> ID：590734
> 
> 赞同：0
> 
> 时间：2009-02-26T14:21:10.343
> 
> 标签：apache-flex, flash, actionscript-3, user-interface, events

我有一个 TitleWindow mxml 类，它有几个组件和侦听器。在它的 creationComplete 和初始化状态中，我添加了一些侦听器来侦听其 gui 上的事件。

此 TitleWindow 仅在用户单击“按钮”时显示，我使用以下代码将 TitleWindow 设为单例：

```
public static function getInstance():MyWindow
{
    if ( MyWindow.singleton )
    {
        return MyWindow.singleton;
    }
    else{
        MyWindow.singleton = new MyWindow();
        return MyWindow.singleton;
    }            
} 
```

我需要一个单例，因为用户会多次调用这个窗口，而我只需要一个。

问题是关于一些特殊的外部事件，我需要在 MyWindow 的按钮上“修改”一些侦听器（删除侦听器并添加新的侦听器），甚至在它显示一次之前。

当我的应用程序启动时，我的内存中仍然有 MyWindow.getInstance()。但是，如果在应用程序启动时使用以下代码时未发生组件的实际渲染，则添加/删除侦听器似乎没有任何效果。

```
 myWindow= MyWindow.getInstance();
  myWindow.initialize(); 
```

如果我“显示”（“渲染”）myWindow 至少一次，这并不奇怪，那么 myWindow 实例上的事件修改就可以完美地工作。

我怎样才能伪造这个组件的**完整**初始化而不在启动时显示它？

谢谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T18:58:48.430

哪种容器可以容纳您的按钮？如果您使用的是[多视图容器](http://livedocs.adobe.com/flex/3/html/layoutperformance_05.html#131483)，您可以尝试[`creationPolicy`](http://livedocs.adobe.com/flex/3/html/help.html?content=layoutperformance_05.html)将`all`. [单视图容器一次性](http://livedocs.adobe.com/flex/3/html/layoutperformance_05.html#171985)创建所有子视图，您不应该面对这个问题。

从 Flex 3.0 文档我可以检索到：

> 除 Application 容器外，所有容器的默认创建策略是父容器的策略。应用程序容器的默认策略是自动。

这看起来像是你所有麻烦的原因。

**更新：**我之前没有提到这一点，因为我认为这是意料之中的 :) 设置`creationPolicy`to`all`会使您的应用程序加载更慢。因此，请阅读[Ordered Creation](http://livedocs.adobe.com/flex/3/html/help.html?content=layoutperformance_07.html#172599) ——此技术可帮助您选择是一次性显示控件（这是创建所有控件后的默认行为）还是逐步显示，以及何时显示它们被创建。

# regex - 使用正则表达式解析 HTML：为什么不呢？

> ID：590747
> 
> 赞同：224
> 
> 时间：2009-02-26T14:24:18.853
> 
> 标签：regex, html-parsing

在stackoverflow上，提问者使用正则表达式从HTML中获取一些信息的每个问题似乎都不可避免地会有一个“答案”，即不使用正则表达式来解析HTML。

为什么不？我知道那里有quote-unquote“真正的”HTML解析器，例如[Beautiful Soup](http://www.crummy.com/software/BeautifulSoup/)，我相信它们功能强大且有用，但是如果您只是做一些简单，快速或肮脏的事情，那么为什么当一些正则表达式就可以正常工作时，还要麻烦使用如此复杂的东西吗？

此外，对于正则表达式，是否有一些我不了解的基本知识使它们成为一般解析的糟糕选择？

* * *

## 回答 #1

> 赞同：228
> 
> 时间：2009-02-26T14:32:44.107

正则表达式无法进行整个 HTML 解析，因为它依赖于匹配开始和结束标记，而这在正则表达式中是不可能的。

正则表达式只能匹配[正则语言](http://en.wikipedia.org/wiki/Regular_grammar)，但 HTML 是[上下文无关语言](http://en.wikipedia.org/wiki/Context-free_grammar)而*不是*正则语言（正如@StefanPochmann 指出的，正则语言也是上下文无关的，因此上下文无关并不一定意味着不是正则语言）。在 HTML 上使用正则表达式唯一可以做的就是启发式方法，但这并不适用于所有条件。应该有可能呈现一个将被任何正则表达式错误匹配的 HTML 文件。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-02-26T14:32:22.173

对于 quick´n´dirty regexp 就可以了。但要知道的基本知识是，*不可能*构造一个能够*正确*解析 HTML 的正则表达式。

原因是正则表达式不能处理任意嵌套的表达式。请参阅[可以使用正则表达式匹配嵌套模式吗？](https://stackoverflow.com/questions/133601/can-regular-expressions-be-used-to-match-nested-patterns)

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2013-09-10T17:07:31.140

（来自[http://htmlparsing.com/regexes](http://htmlparsing.com/regexes)）

假设您有一个 HTML 文件，您正在尝试从 <img> 标记中提取 URL。

```
<img src="http://example.com/whatever.jpg"> 
```

所以你在 Perl 中写了一个这样的正则表达式：

```
if ( $html =~ /<img src="(.+)"/ ) {
    $url = $1;
} 
```

在这种情况下，`$url`确实会包含 `http://example.com/whatever.jpg`. 但是当你开始获取这样的 HTML 时会发生什么：

```
<img src='http://example.com/whatever.jpg'> 
```

或者

```
<img src=http://example.com/whatever.jpg> 
```

或者

```
<img border=0 src="http://example.com/whatever.jpg"> 
```

或者

```
<img
    src="http://example.com/whatever.jpg"> 
```

或者你开始得到误报

```
<!-- // commented out
<img src="http://example.com/outdated.png">
--> 
```

它看起来很简单，对于单个不变的文件来说可能很简单，但是对于您将要对任意 HTML 数据执行的任何操作，正则表达式只是未来令人心痛的秘诀。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-02-26T14:29:02.803

两个快速的原因：

*   编写一个可以抵抗恶意输入的正则表达式很难；比使用预建工具更难
*   编写一个可以处理不可避免的荒谬标记的正则表达式很难；比使用预建工具更难

关于一般解析的正则表达式的适用性：它们不适合。您是否见过解析大多数语言所需的各种正则表达式？

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2009-02-26T14:34:11.857

就解析而言，正则表达式在“词法分析”（lexer）阶段很有用，在这个阶段，输入被分解为标记。它在实际的“构建解析树”阶段不太有用。

对于 HTML 解析器，我希望它只接受格式良好的 HTML，并且需要正则表达式无法执行的功能（它们不能“计数”并确保给定数量的打开元素由相同数量平衡关闭元素）。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-02-26T14:29:35.643

因为有很多方法可以“搞砸”浏览器以相当自由的方式处理 HTML，但是要重现浏览器的自由行为以使用正则表达式覆盖所有情况需要相当多的努力，所以你的正则表达式将不可避免地在某些特殊情况下失败情况下，这可能会在您的系统中引入严重的安全漏洞。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-02-26T14:30:34.783

问题是大多数提出与 HTML 和正则表达式有关的问题的用户都会这样做，因为他们找不到自己的有效正则表达式。然后必须考虑使用 DOM 或 SAX 解析器或类似的东西是否会更容易。它们经过优化和构造，用于处理类似 XML 的文档结构。

当然，有些问题可以用正则表达式轻松解决。但重点在于**轻松**。

如果您只想找到所有看起来对正则表达式没问题的 URL `http://.../`。但是，如果您想查找具有类“mylink”的 a-Element 中的所有 URL，您最好使用适当的解析器。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-02-26T14:35:50.930

正则表达式不是为处理嵌套标签结构而设计的，而且处理所有可能的实际 HTML 可能出现的边缘情况充其量是复杂的（在最坏的情况下是不可能的）。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-02-26T14:36:31.693

我相信答案在于计算理论。对于使用正则表达式解析的语言，它必须按照定义为“常规”（[链接](http://en.wikipedia.org/wiki/Regular_language)）。HTML 不是常规语言，因为它不符合常规语言的许多标准（与 html 代码中固有的许多嵌套级别有关）。如果你对计算理论感兴趣，我会推荐[这](http://books.google.co.uk/books?id=eRYFAAAACAAJ&dq=theory+of+computation&ei=WqimSamaGYvCMvCFrIQO)本书。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2017-06-15T22:06:47.730

HTML/XML 分为标记和内容。正则表达式仅在进行词法标签解析时才有用。我想你可以推断出内容。对于 SAX 解析器来说，这将是一个不错的选择。标签和内容可以传递给用户定义的函数，在该函数中可以跟踪元素的嵌套/闭合。

就仅解析标签而言，它可以使用正则表达式完成并用于从文档中剥离标签。

经过多年的测试，我发现了浏览器解析标签的方式的秘密，无论是良莠不齐的标签。

普通元素用这种形式解析：

这些标签的核心使用这个正则表达式

```
 (?:
      " [\S\s]*? " 
   |  ' [\S\s]*? ' 
   |  [^>]? 
 )+ 
```

您会注意到这`[^>]?`是其中一种选择。这将匹配来自格式错误的标签的不平衡引号。

它也是正则表达式所有邪恶的最大*根源。*它的使用方式将触发一个颠簸，以满足它的贪婪，必须匹配的量化容器。

如果被动使用，永远不会有问题但是，如果你通过穿插需要的属性/值对来*强制*匹配，并且没有提供足够的保护以防止回溯，那将是一场失控的噩梦。

这是普通旧标签的一般形式。注意 `[\w:]`代表标签名称？实际上，代表标签名称的*合法*字符是令人难以置信的 Unicode 字符列表。

```
 <     
 (?:
      [\w:]+ 
      \s+ 
      (?:
           " [\S\s]*? " 
        |  ' [\S\s]*? ' 
        |  [^>]? 
      )+
      \s* /?
 )
 > 
```

* * *

继续前进，我们还看到您无法在不解析*所有*标签的情况下搜索特定标签。我的意思是你可以，但它必须使用像 (*SKIP)(*FAIL) 这样的动词组合，但仍然必须解析所有标签。

原因是标签语法可能隐藏在其他标签内，等等。

因此，要被动解析所有标签，需要一个正则表达式，如下所示。这个特定的也匹配*不可见的内容*。

作为新的 HTML 或 xml 或任何其他开发新结构，只需将其添加为替代项之一。

* * *

*网页注释 - 我从未见过有
问题的网页（或 xhtml/xml）。如果你找到了，请告诉我。*

*性能说明 - 很快。这是我见过的最快的标签解析器
（可能会更快，谁知道呢）。
我有几个特定的​​版本。它也非常适合作为刮刀
（如果您是动手类型）。*

* * *

完整的原始正则表达式

`<(?:(?:(?:(script|style|object|embed|applet|noframes|noscript|noembed)(?:\s+(?>"[\S\s]*?"|'[\S\s]*?'|(?:(?!/>)[^>])?)+)?\s*>)[\S\s]*?</\1\s*(?=>))|(?:/?[\w:]+\s*/?)|(?:[\w:]+\s+(?:"[\S\s]*?"|'[\S\s]*?'|[^>]?)+\s*/?)|\?[\S\s]*?\?|(?:!(?:(?:DOCTYPE[\S\s]*?)|(?:\[CDATA\[[\S\s]*?\]\])|(?:--[\S\s]*?--)|(?:ATTLIST[\S\s]*?)|(?:ENTITY[\S\s]*?)|(?:ELEMENT[\S\s]*?))))>`

格式化的外观

```
 <
 (?:
      (?:
           (?:
                # Invisible content; end tag req'd
                (                             # (1 start)
                     script
                  |  style
                  |  object
                  |  embed
                  |  applet
                  |  noframes
                  |  noscript
                  |  noembed 
                )                             # (1 end)
                (?:
                     \s+ 
                     (?>
                          " [\S\s]*? "
                       |  ' [\S\s]*? '
                       |  (?:
                               (?! /> )
                               [^>] 
                          )?
                     )+
                )?
                \s* >
           )

           [\S\s]*? </ \1 \s* 
           (?= > )
      )

   |  (?: /? [\w:]+ \s* /? )
   |  (?:
           [\w:]+ 
           \s+ 
           (?:
                " [\S\s]*? " 
             |  ' [\S\s]*? ' 
             |  [^>]? 
           )+
           \s* /?
      )
   |  \? [\S\s]*? \?
   |  (?:
           !
           (?:
                (?: DOCTYPE [\S\s]*? )
             |  (?: \[CDATA\[ [\S\s]*? \]\] )
             |  (?: -- [\S\s]*? -- )
             |  (?: ATTLIST [\S\s]*? )
             |  (?: ENTITY [\S\s]*? )
             |  (?: ELEMENT [\S\s]*? )
           )
      )
 )
 > 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2016-10-17T21:19:55.240

此表达式从 HTML 元素中检索属性。它支持：

*   未引用/引用的属性，
*   单/双引号，
*   属性内的转义引号，
*   等号周围的空格，
*   任意数量的属性，
*   仅检查标签内的属性，
*   逃避评论，和
*   管理属性值中的不同引号。

`(?:\<\!\-\-(?:(?!\-\-\>)\r\n?|\n|.)*?-\-\>)|(?:<(\S+)\s+(?=.*>)|(?<=[=\s])\G)(?:((?:(?!\s|=).)*)\s*?=\s*?[\"']?((?:(?<=\")(?:(?<=\\)\"|[^\"])*|(?<=')(?:(?<=\\)'|[^'])*)|(?:(?!\"|')(?:(?!\/>|>|\s).)+))[\"']?\s*)`

[检查出来](https://regex101.com/r/wRD0zq/1)。它与“gisx”标志一起工作得更好，就像在演示中一样。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-02-26T15:26:20.250

“这取决于”。由于这里给出的所有原因，正则表达式确实不能也不能以真正的准确性解析 HTML。但是，如果错误的后果（例如不处理嵌套标签）很小，并且如果正则表达式在您的环境中非常方便（例如当您破解 Perl 时），请继续。

假设您正在解析链接到您网站的网页——或许您通过 Google 链接搜索找到了它们——并且您想要一种快速的方法来大致了解链接周围的上下文。您正在尝试运行一个可能会提醒您链接垃圾邮件的小报告，类似的东西。

在这种情况下，错误解析一些文件不会有什么大不了的。除了您之外，没有人会看到错误，如果您非常幸运，将很少有足够的错误可以单独跟进。

我想我是说这是一个权衡。有时，如果准确性不重要，那么实现或使用正确的解析器（尽管可能很简单）可能不值得麻烦。

小心你的假设。例如，如果您尝试解析将公开显示的内容，我可以想到一些正则表达式快捷方式可能适得其反的方法。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2011-04-29T06:45:17.987

在某些情况下，使用正则表达式从 HTML 解析某些信息是正确的方法——这在很大程度上取决于具体情况。

上面的共识是，总的来说这是一个坏主意。但是，如果 HTML 结构是已知的（并且不太可能更改），那么它仍然是一种有效的方法。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2013-02-12T18:34:47.810

请记住，虽然 HTML 本身不规则，但您正在查看的页面部分*可能*是规则的。

例如，`<form>`标签嵌套是错误的；如果网页工作正常，那么使用正则表达式来获取 a`<form>`是完全合理的。

我最近只使用 Selenium 和正则表达式进行了一些网页抓取。我侥幸成功了，因为我想要的数据放在`<form>`, 并以简单的表格格式放置（所以我什至可以依靠`<table>`,`<tr>`并且`<td>`是非嵌套的——这实际上是非常不寻常的）。在某种程度上，正则表达式甚至几乎是必要的，因为我需要访问的一些结构是由注释分隔的。（Beautiful Soup 可以给你评论，但使用 Beautiful Soup 很难抓取`<!-- BEGIN -->`和`<!-- END -->`阻止。）

但是，如果我不得不担心嵌套表，我的方法根本行不通！我将不得不依靠美丽的汤。然而，即便如此，有时您也可以使用正则表达式来获取所需的块，然后从那里向下钻取。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2013-02-12T22:56:32.453

实际上，在 PHP 中使用正则表达式进行 HTML 解析是完全可能的。您只需要向后解析整个字符串，每次使用不贪婪的说明符从那里`strrpos`查找并重复正则表达式即可克服嵌套标签。`<`在大型事物上并不花哨而且速度非常慢，但我将它用于我自己的网站模板编辑器。我实际上并没有解析 HTML，而是我为查询数据库条目以显示数据表而制作的一些自定义标签（我的`<#if()>`标签可以通过这种方式突出显示特殊条目）。我不准备在这里和那里只使用几个自创标签（其中包含非常非 XML 数据）的 XML 解析器。

所以，即使这个问题已经死了，它仍然出现在谷歌搜索中。我读了它并认为“接受挑战”并完成了我的简单代码的修复，而无需替换所有内容。决定向任何寻找类似原因的人提供不同的意见。最后一个答案也是 4 小时前发布的，所以这仍然是一个热门话题。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2016-12-28T05:05:01.120

我也为此尝试了一个正则表达式。它主要用于查找与下一个 HTML 标记配对的内容块，它不会寻找***匹配***的关闭标记，但它会选择关闭标记。用你自己的语言滚动一个堆栈来检查这些。

与“sx”选项一起使用。如果您感到幸运，也可以使用“ g”：

```
(?P<content>.*?)                # Content up to next tag
(?P<markup>                     # Entire tag
  <!\[CDATA\[(?P<cdata>.+?)]]>| # <![CDATA[ ... ]]>
  <!--(?P<comment>.+?)-->|      # <!-- Comment -->
  </\s*(?P<close_tag>\w+)\s*>|  # </tag>
  <(?P<tag>\w+)                 # <tag ...
    (?P<attributes>
      (?P<attribute>\s+
# <snip>: Use this part to get the attributes out of 'attributes' group.
        (?P<attribute_name>\w+)
        (?:\s*=\s*
          (?P<attribute_value>
            [\w:/.\-]+|         # Unquoted
            (?=(?P<_v>          # Quoted
              (?P<_q>['\"]).*?(?<!\\)(?P=_q)))
            (?P=_v)
          ))?
# </snip>
      )*
    )\s*
  (?P<is_self_closing>/?)   # Self-closing indicator
  >)                        # End of tag 
```

这个是为 Python 设计的（它可能适用于其他语言，尚未尝试过，它使用正向前瞻、负向后视和命名反向引用）。支持：

*   打开标签 -`<div ...>`
*   关闭标签 -`</div>`
*   评论 -`<!-- ... -->`
*   CDATA -`<![CDATA[ ... ]]>`
*   自闭标签 -`<div .../>`
*   可选属性值 -`<input checked>`
*   未引用/引用的属性值 -`<div style='...'>`
*   单引号/双引号 -`<div style="...">`
*   转义引号 - `<a title='John\'s Story'>`
    *（这不是真正有效的 HTML，但我是个好人）*
*   等号周围的空格 -`<a href = '...'>`
*   为有趣的位命名的捕获

不触发格式错误的标签也很好，比如当你忘记 a `<`or时`>`。

如果您的正则表达式支持重复命名捕获，那么您就是黄金，但 Python`re`不支持（我知道正则表达式支持，但我需要使用 vanilla Python）。这是你得到的：

*   `content`- 直到下一个标签的所有内容。你可以忽略这个。
*   `markup`- 包含所有内容的整个标签。
*   `comment`- 如果是评论，评论内容。
*   `cdata`- 如果是`<![CDATA[...]]>`，则为 CDATA 内容。
*   `close_tag`- 如果是关闭标签 ( `</div>`)，则为标签名称。
*   `tag`- 如果是开放标签 ( `<div>`)，则为标签名称。
*   `attributes`- 标签内的所有属性。如果您没有得到重复的组，请使用它来获取所有属性。
*   `attribute`- 重复，每个属性。
*   `attribute_name`- 重复，每个属性名称。
*   `attribute_value`- 重复，每个属性值。如果被引用，这包括引号。
*   `is_self_closing`- 这是`/`如果它是一个自闭合标签，否则什么都没有。
*   `_q`-`_v`忽略这些；它们在内部用于反向引用。

如果您的正则表达式引擎不支持重复的命名捕获，则有一个部分被调用，您可以使用它来获取每个属性。只需在组上运行该正则表达式`attributes`即可获取每个`attribute`,`attribute_name`并`attribute_value`退出它。

此处演示：[https ://regex101.com/r/mH8jSu/11](https://regex101.com/r/mH8jSu/11)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-02-26T14:33:51.747

对于像 HTML 这样的语言，正则表达式还不够强大。当然，有一些示例可以使用正则表达式。但一般来说不适合解析。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2015-11-22T15:03:21.180

你，知道……有很多你做不到的心态，**我**认为围栏两边的每个人都是对的和错的。你可以**做到**，但它比仅仅针对它运行一个正则表达式需要更多的处理。以[这个](http://bit.ly/1MKKkXh)（我在一个小时内写的）为例。它假定 HTML 是完全有效的，但根据您用于应用上述正则表达式的语言，您可以对 HTML 进行一些修复以确保它会成功。例如，删除不应该存在的结束标签：*`</img>`*例如。然后，将结束的单个 HTML 正斜杠添加到缺少它们的元素等。

例如，我将在编写一个库的上下文中使用它，该库允许我执行类似于 JavaScript 的 HTML 元素检索`[x].getElementsByTagName()`。我只是拼接了我在正则表达式的 DEFINE 部分中编写的功能，并使用它来逐步进入元素树，一次一个。

那么，这将是验证 HTML 的最终 100% 答案吗？不，但这是一个开始，只要多做一点工作，就可以完成。但是，尝试在一个正则表达式执行中执行它是不切实际的，也不高效。

# regex - 使用 FINDSTR 转义批处理文件中的反斜杠

> ID：590748
> 
> 赞同：3
> 
> 时间：2009-02-26T14:24:20.600
> 
> 标签：regex, batch-file, pre-commit-hook, findstr

在我的 svn Pre commit 钩子中，我使用 findstr 来阻止某些文件类型被提交。我现在想将此扩展到目录，首先是 \obj\ 目录，但是我遇到了正则表达式的问题并转义了目录的 \

目前我有

```
"C:\Program Files\VisualSVN Server\bin\svnlook.exe" changed -t %2 %1 | FindStr /R ".obj\\\"
IF %ERRORLEVEL% EQU 1 GOTO OK
echo "obj directories cannot be committed" >&2
exit 1
:OK
exit 0 
```

我试过只在最后使用 \ 但这似乎也逃脱了双引号？

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T15:07:51.633

根据经验，以下任一命令都可以执行您想要的操作：

```
... | findstr /R \.obj\\

... | findstr /R "\.obj\\\\" 
```

由于您指定`/R`了 ，因此您还需要在 the 之前添加一个反斜杠，`.`否则它将被解释为通配符。

旁注：从我的测试看来，findstr.exe 使用了[微软网站](http://msdn.microsoft.com/en-us/library/a1y7w461.aspx)上描述的 MS 的 C 库使用的有点奇怪的引用规则。在这种特殊情况下，相关规则是提到前面有偶数个反斜杠的双引号字符被解释为反斜杠的一半。（是的，这很奇怪，当你意识到 cmd.exe 也特别对待双引号字符时，它会变得更奇怪......坦率地说，在 Windows 上正确引用事物是一个痛苦的世界。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T14:44:10.770

在正则表达式中，反斜杠应该被双重转义以在字符串正则表达式中正确解释：

```
FindStr /R "\\.obj\\\\" 
```

但在你的情况下，因为你的正则表达式应该匹配`.obj`文件和“ `obj`”目录，我建议：

```
FindStr /R "\\.?obj\\\\?" 
```

因为您的原始正则表达式（“ `.obj\\`”）只会检测到“ `.obj`”目录，而不是“ `obj`”。因此' `?`'

自从 '。' 表示任何字符，您还需要`\\`在它之前添加“”来更改其解释。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T15:19:17.753

你得到什么错误？

这可能是一个红鲱鱼，但SVN`/`用作路径分隔符，这会导致Windows下的一些问题。我必须在所有钩子脚本中添加以下内容才能更改`/`为`\`：

```
SET REPOS=%1

:: Transform forward-slashes to back-slashes for Windows
SET REPOS=%REPOS:/=^\% 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T16:46:54.987

我使用以下方法解决了这个问题。

```
:CHECKOBJDIRWITHFILES
"C:\Program Files\VisualSVN Server\bin\svnlook.exe" changed -t %2 %1  > "C:\Repositories\SoftwareRepository\hooks\out.txt"
"C:\Program Files\VisualSVN Server\bin\svnlook.exe" changed -t %2 %1 | FindStr /R ./obj/.
echo %ERRORLEVEL% > "C:\Repositories\SoftwareRepository\hooks\error.txt"
IF %ERRORLEVEL% EQU 1 GOTO CHECKOBJDIRWITHOUTFILES
echo "obj directories and their files cannot be committed" >&2
exit 1
:CHECKOBJDIRWITHOUTFILES
"C:\Program Files\VisualSVN Server\bin\svnlook.exe" changed -t %2 %1  > "C:\Repositories\SoftwareRepository\hooks\out.txt"
"C:\Program Files\VisualSVN Server\bin\svnlook.exe" changed -t %2 %1 | FindStr /R ./obj
echo %ERRORLEVEL% > "C:\Repositories\SoftwareRepository\hooks\error.txt"
IF %ERRORLEVEL% EQU 1 GOTO OK
echo "obj directories cannot be committed" >&2
exit 1
:OK
echo %ERRORLEVEL%  >&2
exit 0 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-22T20:38:23.317

在这种情况下你真的需要一个正则表达式吗？如果您只是搜索子字符串“\obj\”，则可以使用 /C 而不是 /R 将文本视为文字匹配字符串：

```
{command} | findstr /C:\obj\ 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-04-12T08:05:27.400

在 findstr 由两个字符序列组成的情况下，`\"`搜索字符串必须是`\\\\"`（四个反斜杠）。

# .net - Web.config 连接数据库的问题

> ID：590755
> 
> 赞同：0
> 
> 时间：2009-02-26T14:25:51.173
> 
> 标签：.net, database, web-config

```
<connectionStrings>
      <add name ="MyDB" connectionString ="Data Source=.\SQLEXPRESS" providerName="System.Data.SqlClient"/>
    </connectionStrings> 
```

我已经连接了上述内容，但是我不断收到以下信息：

```
System.Configuration.ConfigurationErrorsException: The requested database MyDb is not defined in configuration. 
```

接线有问题还是问题出在我的代码中？

```
DatabaseFactory.CreateDatabase(DB_NAME) 
```

问题已解决我将连接放在服务配置文件中，但是所有帖子都有帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T14:28:40.730

首先，您的连接字符串中没有初始目录、用户 ID 或密码。这意味着连接字符串不能用于连接到现有数据库，也不能用于任何直接的控件连接。

其次，我需要查看您*获取*连接字符串的方法，因为这实际上是导致错误的原因。如果解决第一个问题并不能解决问题，请发布用于提取连接字符串以进行下一步的代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-26T14:39:52.483

供将来参考 -[这个网站](http://www.connectionstrings.com/)可能会有所帮助，我将其用作备忘单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T14:30:15.453

检查您的所有 web.config 内容并确保如下所示：

```
<configuration> 
  <connectionStrings> 
    <add name="SQLite" connectionString="Data Source=0" 
      providerName="System.Data.SQLite" /> 
  </connectionStrings> 
</configuration> 
```

# c# - 使用 Actions 时 () 在 lambda 表达式中是什么意思？

> ID：590756
> 
> 赞同：26
> 
> 时间：2009-02-26T14:25:52.500
> 
> 标签：c#, lambda

我从 Jon Skeet 的 C# In Depth 站点粘贴了一些代码：

```
static void Main()
{
    // First build a list of actions
    List<Action> actions = new List<Action>();
    for (int counter = 0; counter < 10; counter++)
    {
        actions.Add(() => Console.WriteLine(counter));
    }

    // Then execute them
    foreach (Action action in actions)
    {
        action();
    }
} 
```

[http://csharpindepth.com/Articles/Chapter5/Closures.aspx](http://csharpindepth.com/Articles/Chapter5/Closures.aspx)

注意这一行：

动作.添加（（）

括号内的 () 是什么意思？

我看过几个 lambda 表达式、委托、Action 对象的使用等示例，但我没有看到对这种语法的解释。它有什么作用？为什么需要它？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-02-26T14:28:42.213

这是声明不带参数的 lambda 表达式的简写。

```
() => 42;  // Takes no arguments returns 42
x => 42;   // Takes 1 argument and returns 42
(x) => 42; // Identical to above 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-26T14:27:38.627

这是一个没有参数的 lambda 表达式。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-25T22:21:22.753

我想到这样的羔羊：

(x) => { 返回 x * 2; }

但只有这一点很重要：

( **x** ) => { 返回**x * 2** ; }

我们需要 => 知道它是一个 lambda 而不是强制转换，因此我们得到这个：

x => x * 2

（很抱歉没有将代码格式化为代码，那是因为你不能在代码中使事情变得粗体......）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-26T14:30:06.047

来自[MSDN](http://msdn.microsoft.com/en-us/library/bb397687.aspx)。表达式 lambda 采用 (inputs)=> 表达式的形式。所以像 ()=> 表达式这样的 lambda 表示没有输入参数。Action 的签名不带参数

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-26T14:30:27.980

这一行的作用是使用 lambda 表达式向列表中添加一个匿名 Action，它不接受任何参数（这就是 () 存在的原因）并且什么也不返回，因为它只打印计数器的实际值.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-26T14:27:56.240

它表示没有参数的匿名函数。

# .net - 如果更改 app.config，是否必须重新启动 Windows 服务？

> ID：590791
> 
> 赞同：45
> 
> 时间：2009-02-26T14:33:01.330
> 
> 标签：.net, windows-services

如果更改 app.config，是否必须重新启动 Windows 服务？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-02-26T14:34:30.390

[是的，你这样做](http://blogs.msdn.com/junfeng/archive/2005/02/20/376880.aspx)：

> .Net 框架将读取 app.config 一次，并且永远不会再接触 app.config。这就是为什么您必须重新启动应用程序以获取更改的原因。
> 
> 为什么 .Net 框架没有检测到 app.config 已更改，并刷新所有配置数据？
> 
> 原因很简单，这在一般情况下是不可能的。
> 
> 让我们在这里使用雷蒙德的“想象这可以做到”的逻辑......

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-26T22:44:07.047

我以前用过这个。本质上，这会在检索值之前重新加载指定的部分。可能比按需刷新的配置文件观察器效率低，但谨慎使用肯定有效。

```
 ConfigurationManager.RefreshSection("appSettings")
  sValue = ConfigurationManager.AppSettings(name) 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-26T14:37:29.477

*不，你*不必。但是，如果您希望更改`app.config`生效，您可能需要重新启动它。或者您可能想要实现一个自定义配置文件观察器机制，该机制将动态更改服务的设置。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-26T14:35:41.913

是的。

大概你的意思是 appname.exe.config 文件？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-26T22:25:42.767

通常是的。但是，您可以编写一个 Windows 服务，在配置文件上放置一个文件监视器并感知修改并应用它而无需重新启动。

例如，Log4Net 日志框架为其配置文件提供了这种机制。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-26T15:53:12.900

这超出了问题的范围，但我猜您只想在某些“应用程序特定”部分（appSettings 等）中进行更改。

你最好编写自己的配置部分处理程序，它监视它自己的配置文件 - [nlog 使用](http://www.nlog-project.org/config.html#file)的方法. 检查“**自动重新配置**”部分。

# c++ - 如何杀死 MFC 线程？

> ID：590792
> 
> 赞同：11
> 
> 时间：2009-02-26T14:33:26.803
> 
> 标签：c++, multithreading, mfc

我使用它生成一个线程`AfxBeginThread`，它只是一个无限的while循环：

```
UINT CMyClass::ThreadProc( LPVOID param )
{
  while (TRUE)
  {
      // do stuff
  }
  return 1;
} 
```

如何在我的类析构函数中杀死这个线程？

我想像

```
UINT CMyClass::ThreadProc( LPVOID param )
{
  while (m_bKillThread)
  {
      // do stuff
  }
  return 1;
} 
```

然后在析构函数中设置`m_bKillThread`为`FALSE`。但我仍然需要在析构函数中等待，直到线程死亡。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-26T14:37:23.503

**主动杀死线程：**

使用`AfxBeginThread`( `CWinThread*`) 的返回值获取线程句柄 ( `m_hThread`)，然后将该句柄传递给 TerminateThread Win32 API。但是，这不是终止线程的安全方法，因此请继续阅读。

**等待线程完成：**

使用`AfxBeginThread` ( `CWinThread*`)的返回值获取成员m_hThread，然后使用`WaitForSingleObject(p->m_hThread, INFINITE);` 如果该函数返回`WAIT_OBJECT_0`，则线程结束。而不是`INFINITE`你也可以在超时发生之前等待毫秒数。在这种情况下`WAIT_TIMEOUT`将被退回。

**向您的线程发出信号，表明它应该结束：**

在做`WaitForSingleObject`只是设置某种线程应该退出的标志之前。然后在线程的主循环中，您将检查该布尔值并打破无限循环。在您的析构函数中，您将设置此标志，然后执行`WaitForSingleObject`.

**更好的方法：**

如果您需要更多控制，可以使用[boost conditions](http://www.boost.org/doc/libs/1_34_0/doc/html/boost/condition.html)之类的东西。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-02-25T13:39:38.707

顺便说一句，关于 TerminateThread()，以这种方式使用它。

```
DWORD exit_code= NULL;
if (thread != NULL)
{
    GetExitCodeThread(thread->m_hThread, &exit_code);
    if(exit_code == STILL_ACTIVE)
    {
        ::TerminateThread(thread->m_hThread, 0);
        CloseHandle(thread->m_hThread);
    }
    thread->m_hThread = NULL;
    thread = NULL;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-08-30T18:19:10.273

[首先，您必须以某种方式启动线程，以便 MFC 在完成](https://msdn.microsoft.com/en-us/library/2s21xzfe.aspx#_core_premature_thread_termination)时不会删除线程对象，MFC 线程的默认设置是删除自身，因此您想将其关闭。

```
 m_thread = AfxBeginThread(ThreadProc, this, THREAD_PRIORITY_NORMAL ,CREATE_SUSPENDED);
   m_thread->m_bAutoDelete = FALSE;
   m_thread->ResumeThread(); 
```

现在在线程中，您需要一种机制，调用者线程可以向其发送信号以结束自身。有多种方法，一种是`WaitForSingleObject`检查信号的状态，另一种方法是简单地向该线程发送消息以结束自身。这是一个优雅的结局，而不是杀死它。

当这个线程自己结束时（=退出线程函数，清理），你可以让主线程在它退出之前等待它完成。

```
 int wait = 2000 // seconds ( I am waiting for 2 seconds for worker to finish)
     int dwRes = WaitForSingleObject( m_thread->m_hThread, wait);
     switch (dwRes)
     {
     case WAIT_OBJECT_0:
         TRACE( _T("worker thread just finished") ); break;
     case WAIT_TIMEOUT:
         TRACE( _T("timed out, worker thread is still busy") ); break;
     } 
```

注意`m_bAutoDelete = FALSE`上面的设置使得当线程完成时我们仍然有一个有效的句柄成为可能，所以我们可以等待它。您现在要做的最后一件事是删除 CWinThread 对象以释放其内存（因为我们负责这样做）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T14:39:55.510

您必须等待，直到线程完成所有工作。

```
if(WaitForSingleObject(thread_handle, INFINITE) == WAIT_OBJECT_0) 
    ;//all right
else
    ;//report error 
```

小心使用 TerminateThread 函数，这是非常危险的。

# java - 如何从 Linux 上运行的 Java 访问首选应用程序？

> ID：590797
> 
> 赞同：0
> 
> 时间：2009-02-26T14:34:21.090
> 
> 标签：java, linux, preferences, robohelp

我们有一个基于 Java 的多平台系统，它为[Robohelp](http://www.adobe.com/products/robohelp/)提供在线用户指南信息。它运行在各种 Windows 和 Linux 版本上。与我们基于 Linux 的系统相关的默认 Robohelp 代码在命令行中具有指向“netscape”的硬编码链接，它构建该链接以生成 Web 浏览器以查看帮助文件。显然，这对没有安装 netscape 的系统没有帮助。

我真正想做的是在 Linux 上运行时从 Java 中检测首选应用程序首选项。在我目前所在的 Fedora 9 机器上，可以在 System -> Preferences -> Personal -> Preferred Applications 下找到它。第一个设置是“Web 浏览器”。

我如何从 Java 代码中检测到该设置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T15:15:22.380

看看[java.awt.Desktop](http://java.sun.com/javase/6/docs/api/java/awt/Desktop.html)。支持在用户首选程序中打开/编辑/打印文件，在用户首选浏览器中打开 URL，发送电子邮件，...

# wpf - 为什么我可以绑定到 ListBox 但不能绑定到 WPF 中的 DataGrid？

> ID：590813
> 
> 赞同：2
> 
> 时间：2009-02-26T14:36:51.570
> 
> 标签：wpf, datagrid

我在 WPF 中设置了 LINQ-to-SQL / NorthWind。

ListBox 显示数据，但 DataGrid 不显示（没有错误，只是不显示任何内容）。

我引用了 WPFToolkit.dll。

为什么 DataGrid 不显示 ListBox 可以显示的数据？

**XAML：**

```
<Window x:Class="TestLinq343.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:dg="clr-namespace:Microsoft.Windows.Controls;assembly=WPFToolkit"
    Title="Window1" Height="300" Width="300">
    <Window.Resources>
        <DataTemplate x:Key="ShowCustomer">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding CategoryID}"/>
                <TextBlock Text=": "/>
                <TextBlock Text="{Binding ProductName}"/>
            </StackPanel>
        </DataTemplate>
    </Window.Resources>
    <Grid>
        <dg:DataGrid x:Name="TheDataGrid" AutoGenerateColumns="True"></dg:DataGrid>
        <ListBox x:Name="TheListBox" ItemTemplate="{StaticResource ShowCustomer}"/>
    </Grid>
</Window> 
```

**后面的代码：**

```
using System.Linq;
using System.Windows;
using TestLinq343.Model;
using Microsoft.Windows.Controls;

namespace TestLinq343
{
    public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();

            NorthwindDataContext db = new NorthwindDataContext();
            var sortedProducts =
                from p in db.Products
                orderby p.UnitsInStock descending
                select p;

            TheDataGrid.ItemsSource = sortedProducts;
            TheListBox.ItemsSource = sortedProducts;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T15:13:00.420

这只是一个 XAML 问题，这解决了它：

```
<ScrollViewer>
    <StackPanel>
        <dg:DataGrid x:Name="TheDataGrid"/>
        <ListView x:Name="TheListView" ItemTemplate="{StaticResource ShowCustomer}"/>
    </StackPanel>
</ScrollViewer> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T14:40:31.903

可能是因为您没有指定数据网格列。尝试将 datagrids AutoGenerateColumns 属性设置为 true。

# uml - 键盘友好的轻量级 UML 建模工具？

> ID：590821
> 
> 赞同：6
> 
> 时间：2009-02-26T14:38:46.760
> 
> 标签：uml, modeling

我正在寻找一个在 Windows 上运行的免费 UML 工具，它可以让我非常快速地创建简单的图表，并且尽可能少地摆弄鼠标。

我不需要代码生成或花哨的东西，只需要带有箭头的 UML 样式框。

我想要的是例如让我使用键盘快捷键添加一个新类并让我输入名称而无需双击添加的类或类似的东西。只是一个简单的应用程序，可让您高效建模，而不会产生吃办公桌的冲动......

我不想要的是必须将一个项目从工具箱拖到表面，双击该项目，输入名称，再次抓住鼠标，单击确定按钮，然后重复。

对于 Eclipse，有[TextUML](http://abstratt.com/)可以让您使用文本符号创建图表，但我希望它用于 .Net 开发，并且我不想只为一个小型图表插件运行 Eclipse。

我已经尝试了很多开源工具，但其中大多数都有非常糟糕的用户体验。

那么，有没有符合上述描述的工具呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-26T14:57:16.513

如果您真的只想要带箭头的框，请使用[GraphViz](http://www.graphviz.org/)。它允许您输入文本描述，并且当前的 Windows 版本现在能够提供文本文件的图形预览。你可以选择不同的形状类型，它可以让你制作出像下面这样花哨的图表。

我有一个成熟的 UML 工具（出色的[Enterprise Architect](http://www.sparxsystems.com.au/)），但我仍然每天使用 GraphViz 来绘制简单的草图。

有关 GraphViz 的更多传统 UML 示例，请参阅[此博客](http://www.ffnn.nl/pages/articles/media/uml-diagrams-using-graphviz-dot.php)和[UMLGraph](http://www.umlgraph.org/)站点。

```
digraph {

/* notes */
    subgraph cluster_legend {
    graph [color=lightyellow style=filled]
    node[shape=plaintext]
    edge[style=invisible arrowhead=none]
    Mac[label="On Macintosh\nonly" color=blue fontcolor=blue]
    Next[label="Next Version" color=grey fontcolor=grey]
    Mac->Next
}

edge [color=black fontcolor=black]
node [weight=bold fontsize=14 color=black fontcolor=black]

/* docs */
node[ shape=box3d]
AppMakerv2[label="AppMaker V2\nDocument" color=blue fontcolor=blue]
AppMakerX[label="AppMakerX\nDocument"]

/* Code */
node [shape=folder]
PP[label="PowerPlant\nPPob Resources" color=blue fontcolor=blue]
Classic[label="Classic Mac\nResource fork:\nMENU, DLOG, DITL" color=blue fontcolor=blue]
XAML
WPFApp[label="WPF Application\nXAML resources\nC# Code and properties"]
REALBasic[label="REALbasic Application\nXML format\nwindows and code" color=grey fontcolor=grey]
Cocoa[label="Cocoa Application\nxib resources\nObjective-C Code" color=grey fontcolor=grey]
hand[label="Hand Editing in\nAppMaker v2 GUI" shape=plaintext fontcolor=blue]

/* processes */
node[shape=ellipse]
Importer[color=blue fontcolor=blue]
Exporter[color=blue fontcolor=blue]
Converter
WPFGen[label="WPF\nGenerator"]
CocoaGen[label="Cocoa\nGenerator" color=grey fontcolor=grey]
RBGen[label="REALbasic\nGenerator" color=grey fontcolor=grey]

/* Mac workflow */
edge[color=blue]
PP->Importer
Classic->Importer
hand->AppMakerv2
Importer->AppMakerv2
AppMakerv2->Exporter->AppMakerX

/* cross-platform workflow */
edge[color=black]
XAML->Converter->AppMakerX
AppMakerX->WPFGen->WPFApp

/* future workflow */
edge [color=grey fontcolor=grey]
AppMakerX->CocoaGen->Cocoa
AppMakerX->RBGen->REALBasic

} 
```

[替代文字 http://www.aussiedesignsoftware.com/AppMakerX/files/amxworkflow.png](http://www.aussiedesignedsoftware.com/AppMakerX/files/amxworkflow.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-02-03T18:53:02.000

尝试 trace2uml [http://trace2uml.tigris.org/](http://trace2uml.tigris.org/)

它是免费的，易于使用且轻便

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T22:25:16.027

我发现 JUDE 非常好，用于 UML 建模的轻量级软件。它是跨平台的，有社区版，易于使用，支持标准 UML，图表看起来很漂亮。

[http://jude.change-vision.com/jude-web/index.html](http://jude.change-vision.com/jude-web/index.html)

# c++ - 处理浮点数的精度问题

> ID：590822
> 
> 赞同：9
> 
> 时间：2009-02-26T14:39:37.927
> 
> 标签：c++, floating-point, floating-accuracy

我想知道是否有办法克服似乎是我的机器内部浮点数表示的结果的准确性问题：

为了清楚起见，将问题总结为：

```
// str is "4.600";   atof( str ) is 4.5999999999999996  
double mw = atof( str )  

// The variables used in the columns calculation below are:   
//  
//                    mw = 4.5999999999999996  
//                    p = 0.2  
//                    g = 0.2  
//                    h = 1 (integer)  

int columns = (int) ( ( mw - ( h * 11 * p ) ) / ( ( h * 11 * p ) + g ) ) + 1; 
```

在转换为整数类型之前，列计算的结果是 1.9999999999999996；距离 2.0 的预期结果如此接近但如此遥远。

欢迎提出任何建议。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-26T14:48:03.257

当您使用浮点算术时，严格相等几乎没有意义。您通常希望与一系列可接受的值进行比较。

请注意，某些值*不能*完全表示为浮点值。

看看[每个计算机科学家应该知道的关于浮点运算](http://docs.sun.com/source/806-3568/ncg_goldberg.html)和[比较浮点数](http://www.cygnus-software.com/papers/comparingfloats/comparingfloats.htm)的知识。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-26T15:31:56.100

不存在精度问题。

您得到的结果 (1.9999999999999996) 与数学结果 (2) 相差 1E-16。考虑到您的输入“4.600”，这非常准确。

当然，你确实有一个舍入问题。C++ 中的默认舍入是截断；你想要类似于 Kip 解决方案的东西。详细信息取决于您的确切域，您期望`round(-x)== - round(x)`吗？

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-26T14:47:23.180

如果你没有读过，[这篇论文](http://docs.sun.com/source/806-3568/ncg_goldberg.html)的标题真的是正确的。请考虑阅读它，以了解更多关于现代计算机上浮点运算的基础知识、一些陷阱以及对它们为何如此行事的解释。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-26T14:57:11.490

将浮点数舍入为整数的一种非常简单有效的方法：

```
int rounded = (int)(f + 0.5); 
```

注意：这仅在`f`始终为正时才有效。（感谢 j 随机黑客）

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-26T15:51:29.907

如果准确性真的很重要，那么您应该考虑使用双精度浮点数而不仅仅是浮点数。虽然从你的问题看来你已经是了。但是，您在检查特定值时仍然存在问题。您需要以下代码（假设您正在检查您的值是否为零）：

```
if (abs(value) < epsilon)
{
   // Do Stuff
} 
```

其中“epsilon”是一些小但非零值。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-26T16:36:17.630

在计算机上，浮点数从来都不是精确的。它们始终只是一个近似值。（1e-16 已接近。）

有时会有你看不到的隐藏位。有时代数的基本规则不再适用：a*b != b*a。有时将寄存器与内存进行比较会发现这些细微的差异。或者使用数学协处理器与运行时浮点库。（我已经这样做太久了。）

C99 定义：（查看*math.h*）

```
double round(double x);
float roundf(float x);
long double roundl(long double x); 
```

.

或者你可以自己滚动：

```
template<class TYPE> inline int ROUND(const TYPE & x)
{ return int( (x > 0) ? (x + 0.5) : (x - 0.5) ); } 
```

对于浮点等价，请尝试：

```
template<class TYPE> inline TYPE ABS(const TYPE & t)
{ return t>=0 ? t : - t; }

template<class TYPE> inline bool FLOAT_EQUIVALENT(
    const TYPE & x, const TYPE & y, const TYPE & epsilon )
{ return ABS(x-y) < epsilon; } 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-26T14:41:29.013

使用小数：[decNumber++](http://www.alphaworks.ibm.com/tech/decnumberplusplus)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-26T14:43:25.687

您可以阅读[本文](http://www.scribd.com/doc/5836/What-Every-Computer-Scientist-Should-Know-About-FloatingPoint-Arithmetic)以找到您要查找的内容。

您可以获得结果的绝对值，如下[所示](https://stackoverflow.com/questions/588004/is-javascripts-math-broken/588014#588014)：

```
x = 0.2;  
y = 0.3;  
equal = (Math.abs(x - y) < 0.000001) 
```

# asp.net - 在 css 文件的末尾指定 .aspx？

> ID：590823
> 
> 赞同：8
> 
> 时间：2009-02-26T14:39:42.623
> 
> 标签：asp.net

在 ASP.NET 中处理 Web 应用程序时，将文件指定为 stylesheet.css.aspx 而不仅仅是简单的 stylesheet.css 的原因是什么？我已经在各种网络应用程序中看到了这一点。

网页设计师提到了一些关于它是如何成为 .NET 的东西并为 ASPX 页面存储全局变量的内容，但我并不真正理解，也不知道完整的故事。

这是在我的工作中针对不同国家/地区具有不同站点的大型 Web 应用程序完成的。这让我想知道，我什么时候会为不同的国家/地区制作单独的 Web 应用程序，而不是一个提供不同语言的 Web 应用程序？这样做是否有性能、架构或其他技术原因？我可以想到几个非技术原因（例如 SEO 考虑）。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-26T14:46:25.790

样式表可能不是静态的，而是在服务器上动态生成的。

通过考虑几个参数（例如用户主题选择或其他东西），可以使用此技术提供不同的样式表。

**澄清**：虽然您可以在 IIS 中映射`.css`扩展以由 ASP.NET 处理。它有两个问题：

1.  静态 CSS 文件也将传递给 ASP.NET 运行时，这将导致小的性能损失。
2.  在许多共享宿主环境中，您无法控制 IIS 处理程序映射。

Web 浏览器不关心（至少，它们不应该关心）扩展名或有关 URL 的任何其他内容。他们唯一应该关心的是`Content-Type`标题。它应该设置为`text/css`; 否则他们中的一些人可能会抱怨。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-26T14:46:56.537

样式表只是一个文本文件 - 只要`<link>`匹配，您就可以指定所需的任何文件扩展名。换句话说，这将起作用：

```
<link type="text/css" rel="stylesheet" href="style.foobar"/> 
```

只要您的样式表具有该名称。 ~~我想不出任何理由用 .aspx 扩展名来命名样式表，因为它具有误导性和混淆性。~~[其他帖子很好地解释了为什么会使用它。]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T15:04:34.000

如前所述，它允许服务器将其作为 aspx 文件处理。我敢肯定它会吐出 css，但会允许你在服务器端进行处理。

在您给出的示例中，如果您对不同区域具有相同的 html 内容（可能已翻译，但结构相同），那么通过使用动态 css 文件，您可以换出例如背景图像。通常这被认为是一个坏主意，因为您应该向 html 元素添加不同的类名来解决这个问题。

这样做的另一个常见原因是避免重复颜色定义。从技术上讲，您也可以通过使用类名来避免这种情况，但这会变得相当烦人。大多数人都希望拥有类似的东西：

> `define sitebordercolor #999; define sitebackgroundcolor #fff;`

然后在他们的 CSS 中，能够做到：

> `.foo { border: 1px solid #sitebordercolor; background-color: #sitebackgroundcolor; }`

但是，CSS 不允许您这样做。因此，通过使用 ASPX 文件，您可以获得相同的结果：

> `.foo { border: 1px solid <%=sitebordercolor %>; background-color: <%=sitebackgroundcolor %>; }`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T14:50:00.320

样式表通常是静态文本文件，没有理由给一个 .aspx 扩展名，除非它们是动态生成的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T14:53:10.563

如果您将样式表命名为 .aspx，它将由 ASP.Net 引擎处理，而不是简单地用作文本文件。

一旦你在 .Net 中，你就可以自由地写你的 CSS。不过，我更喜欢参数化的 css.aspx，因为浏览器想要缓存 CSS 文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-20T09:14:04.287

[Mehrdad's answer](https://stackoverflow.com/questions/590823/specifying-aspx-on-the-end-of-a-css-file/590846#590846) is spot on with regards to the CSS files - that's how we enable dynamic colours on a number of our sites - have the colour defined by a query string, enable [page caching varying by that query string](http://msdn.microsoft.com/en-us/library/y96218s9.aspx), and there you go.

In response to the architecture part of this question:

Whilst SEO considerations would recommend that localised content is often served from a local server and domain (i.e. French content on a .fr domain for example) this often isn't possible.

In terms of maintenance, it's easier to maintain one web site rather than multiple - so you would build it once, take advantage of the framework features to enable [localisation](http://msdn.microsoft.com/en-us/library/aa728892.aspx) (resource files, etc), and then you can either deploy that to one location or multiple as you see fit.

# c# - LINQ 审计和当前用户与 Web 应用程序

> ID：590844
> 
> 赞同：1
> 
> 时间：2009-02-26T14:46:11.810
> 
> 标签：c#, linq-to-sql, auditing

**背景：**

我有一个 Web 应用程序，我需要对其进行数据库审计以进行插入/删除/更新（可能还有读取）。我使用 LINQ 作为我的 ORM。使用我在网上找到的一些想法，我想出了一种使用属性来装饰具有关联审计表的实体的方法。审计表本身除了当前用户的id和名称、修改类型、修改时间、操作是否成功等字段外，还需要包含与原表相同类型的相同列。审计发生在 SubmitChanges 期间——我的数据上下文是抽象的，我在具体实现中继承和覆盖 SubmitChanges。抽象数据上下文实际上是从 AbstractAuditableDataContext 派生的，它扩展了 DataContext 并添加了一个 CurrentUser 属性，其中包含当前用户 ID 和名称的占位符。默认情况下，对于没有登录用户的实例，这些是 0 和“系统”——比如在注册或登录期间，当用户表的某些字段可能被更新时。该应用程序是使用 ASP.NET MVC 用 C# 编写的。

**问题：**

填充派生数据上下文的当前用户属性的最佳方法是什么？我是否应该创建一个注入到 AuditUtility 中的实用程序类，以检查 CurrentUser 是否已设置，如果没有，则将其填充。为了测试我会模拟它，但在实时应用程序中它可能会使用惰性- 加载并在会话中获取/设置它。或者我应该修改数据上下文工厂（由所有控制器使用）来执行此功能。我已经在单元测试期间使用了模拟工厂，因此这不会涉及创建新类。或者是否应该在工厂之外进行派生，并在上下文创建期间注入当前用户。这将允许我“代表”审计。

我意识到这有点主观，但我很感激你可能贡献的任何想法/经验。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T16:32:07.003

如果您使用的是 Windows 或 Forms 身份验证，则可以检查 HttpContext 而不传递任何内容。如果您不在 Web 上下文中，请从线程中获取用户。也许：

```
if(HttpContext.Current != null)
{
    //grab the user from the HttpContext
}
else
{
    //grab the user from the Thread
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T16:35:29.507

`System.Threading.Thread.CurrentPrincipal`应该给你你正在寻找的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T15:15:47.280

您的 DataContext 的范围是什么（应用程序、会话、请求，每个 BusinessObject ..）？如果它变化，您可能根本不想在 DataContext 中缓存当前用户（或在创建期间设置它）。我可能会在需要时使用从 Session （一种或另一种方式）检索当前用户的 DataContext 中的属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T16:27:13.463

我最终创建了一个 CurrentUserUtilityBase 类，该类具有一个 GetAuditUser 方法，该方法采用当前数据上下文并检索与 HttpContext.User.Identity 中的当前用户名对应的用户对象。它使用此对象来提取当前用户的 id 和显示名称，并创建并返回包含这些属性的 AuditUser 对象。

我的实现类使用工厂来获取我的数据上下文的实例，并在此数据上下文上调用基类方法。我的数据上下文的工厂方法使用当前用户实用程序在创建上下文后将上下文的当前用户注入上下文。

# recovery - 如何编写可以恢复 FAT32 文件的程序

> ID：590848
> 
> 赞同：2
> 
> 时间：2009-02-26T14:46:52.857
> 
> 标签：recovery, fat32

如何编写可以恢复 FAT32 文件的程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T14:56:31.273

这非常复杂，但是 FAT32 的文档非常好：

我只使用这些资源编写了一个用于直接 FAT32 访问的工具：

*   [http://en.wikipedia.org/wiki/File_Allocation_Table](http://en.wikipedia.org/wiki/File_Allocation_Table)

*   [http://support.microsoft.com/kb/154997/](http://support.microsoft.com/kb/154997/)

*   [http://www.microsoft.com/whdc/system/platform/firmware/fatgen.mspx](http://www.microsoft.com/whdc/system/platform/firmware/fatgen.mspx)

但我从未真正尝试过恢复文件。能否成功恢复文件取决于几个因素：

1.  该文件必须仍然物理地“存在”在硬盘上
2.  你必须知道文件从哪里开始
3.  你必须知道你在找什么（标题..）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-26T14:51:41.237

这取决于您尝试恢复的文件发生了什么。数据可能仍在分区上，或者现在可能被覆盖。有很多预先编写的解决方案。一个简单的谷歌搜索应该会为您提供大量可以尝试恢复数据的软件，但并不是 100% 肯定会恢复它们。如果你真的想自己恢复它们，你需要写一些东西来读取原始分区并忽略丢失的文件标记。

[这](http://apps.tempel.org/iBored/)是一个程序（由 Thomas Tempelman 编写。这个人很棒。）可能会帮助你。您可以制作分区的副本，忽略损坏的位，然后对副本进行操作，这样您就不会搞砸任何事情，您还可以直接使用它恢复数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-05T09:16:54.537

我认为您指的是*数据雕刻*，即读取物理设备并根据某些知识重建以前未链接的文件（例如，当您找到两个字母 PK 时，很可能比 zip 存档跟随，对于 JPEG 的 JFIF 也是如此）。

在这种情况下，我建议您[研究 PhotoRec 的源代码，](http://www.cgsecurity.org/)这是一个很棒的（在我看来，最好的）数据雕刻开源工具。

# sql-server - Sql Server的管理工作室界面中关于设计关系的查询

> ID：590857
> 
> 赞同：0
> 
> 时间：2009-02-26T14:50:10.397
> 
> 标签：sql-server, sql-server-2005

想象一下，我有两张桌子：经理，球员。这是为一支足球队准备的，其中几名球员只能为一名经理效力，而一名经理管理多 (11) 名球员。

在 Sql Server 中设计关系时，在弹出窗口出现关系的属性时，表在哪一边有关系吗？

那么换句话说，将密钥从 Player 连接到 Manager 或从 Manager 到 Player 有区别吗？

以及如何将关系指定为 1:n 还是自动确定为 1:n 或 1:1？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T14:59:42.683

您连接`Player`到`Manager`，这将创建一个`FOREIGN KEY Player (manager_id) REFERENCES Manager (id)`

除非表中`1:n`有一个关系，否则关系将是，这不是你的情况。`UNIQUE CONSTRAINT``manager_id``Player`

通常，`1:1`关系存储在一个表中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T14:58:11.860

它们是有区别的。玩家需要有一个外键约束来引用经理的主键（或另一个唯一键）。

*   源表：外键约束
*   目标表：主/唯一键约束

在创建外键（约束）之前，需要先设置主键约束。它自动为 1:n（如果您的外键可以为空，则为 0:n，即有些玩家没有经理）。

# multithreading - 如何更改侦听器线程优先级

> ID：590859
> 
> 赞同：2
> 
> 时间：2009-02-26T14:50:48.260
> 
> 标签：multithreading, delphi, indy, thread-priority

我使用 Indy 10 的 TIdCmdTCPServer 组件来实现我的客户端-服务器应用程序。问题是来自客户端的请求可能相当复杂，而且我的服务器应用程序的 GUI 部分会立即失去响应能力。从[Indy Documentation](http://www.indyproject.org/docsite/html/frames.html?frmname=topic&frmfile=TIdTCPServer.html)，我得到了那个 Indy：

> 使用线程优先级 tpHighest 为绑定创建和启动侦听器线程。

我可以改变这种行为吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-26T15:21:42.490

为侦听线程设置较低的优先级不会解决您的问题。侦听器线程所做的只是侦听，这不是 CPU 密集型任务。在连接到达之前，该线程根本不做任何事情。您可以使用 Process Explorer 之类的工具来确认这一点；我认为它可以按线程显示 CPU 使用率。

*将优先级设置得较低*实际上可能会使您的服务器看起来响应速度较慢，因为当连接到达时，侦听该连接的线程将以较低的优先级运行，并且无法立即处理该连接。在您的服务器开始处理其请求之前，客户端将不得不等待一段时间。

请求不在侦听器线程中处理。侦听器线程将大部分工作委托给其他线程。如果您只有一个 TCP 绑定，那么您将只有一个侦听器线程，但您可以处理许多并发连接。尽管只有一个侦听器，但每个连接都将由一个单独的线程处理。

`OnBeforeListenerRun`无论如何，您可以通过处理服务器对象的事件来更改优先级。它接收对`TIdThread`表示侦听器线程的引用，因此您可以为其`Priority`属性分配不同的值。此外，您有源代码，因此您可以进入并更改*IdGlobalCore.pas*`tpListener`中常量的定义。代码使用该值，而不是直接使用。*`tpHighest`*

 ** * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-26T20:48:53.733

正如 Rob 指出的那样，不要更改侦听器线程的优先级，而是降低工作线程的优先级。可以在*TIdCmdTCPServer*实例的*OnConnect()*处理程序中访问它，如下所示：

 *```
procedure TServerForm.IdCmdTCPServer1Connect(AContext: TIdContext);
begin
  // sanity checks need to go here
  TIdYarnOfThread(AContext.Yarn).Thread.Priority := tpLower;
end; 
```

# .net - 比较.dll和反汇编差异的工具？

> ID：590863
> 
> 赞同：25
> 
> 时间：2009-02-26T14:53:19.267
> 
> 标签：.net, disassembly

有谁知道一个像样的工具，可以比较同一个 dll 的两个不同版本并提取差异？

谢谢

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2014-03-04T16:58:15.190

也可以使用 JetBrains 的[dotPeek 。](http://www.jetbrains.com/decompiler/)它也是免费的。

*   在 dotPeek 中打开程序集
*   选择装配体
*   文件 --> 导出到项目
*   选择磁盘上的位置

对要比较的程序集重复上述操作，然后在差异工具中打开这两个文件夹。我使用[了 WinMerge](http://winmerge.org/)。

您会注意到绝大多数文件都有差异。这是因为文件顶部有这样的注释

```
// MVID: {some guid here} 
```

或者

```
// Assembly location: {some path here} 
```

您可以在 WinMerge 中创建一个过滤器来忽略它

*   工具 --> 过滤器...
*   转到“线路过滤器”选项卡
*   添加以下过滤器`^// MVID:`
*   添加以下过滤器（可选）`^// Assembly location:`
*   选中新正则表达式旁边的复选框
*   选中“启用线路过滤器”复选框

当您同意更改时，它将重新扫描文件夹并忽略以该注释开头的任何行。现在您应该只看到您感兴趣的更改。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-26T14:55:40.463

Reflector 有一个[Diff](https://www.red-gate.com/products/dotnet-development/reflector/index)工具。注意：Reflector 现在是付费软件。

注意：Diff 工具不再可用。您仍然可以通过[Softpedia](https://www.softpedia.com/get/Programming/Other-Programming-Files/Reflector-Diff.shtml#download)下载它并将其与旧版本的 Reflector 一起使用（从 2010 年左右开始）。在以后的版本中，它不再起作用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-26T14:54:58.937

为什么不先拆机再对比？

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-26T14:57:01.863

检查[http://www.red-gate.com/products/reflector/](http://www.red-gate.com/products/reflector/)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-12-17T20:26:52.643

使用[.NET Reflector](http://www.red-gate.com/products/dotnet-development/reflector/)（您只需要免费版）打开 dll，然后右键单击并选择将它们导出到单独的目录。

然后使用[ExamDiff Pro](http://www.prestosoft.com/edp_examdiffpro.asp)比较目录（您可以获得 30 天免费试用）。您可以浏览子文件夹并根据需要在新的比较窗口中打开每个文件（只需在 ExamDiff Pro 窗口中双击）。 **效果很棒！**

*ExamDiff Pro 还有一个 Dump PE32 插件，可以直接在 .dll 和 .exe 文件之间进行比较。这有助于查看标头更改和标记二进制差异，但不会为您反编译（因此请使用上面的 Reflector 方法）。*

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-17T09:41:33.883

Microsoft BCL 团队有一个工具可以做到这一点，它叫做 LibCheck，可以在这里找到

[http://blogs.msdn.com/b/bclteam/archive/2005/03/21/400123.aspx](http://blogs.msdn.com/b/bclteam/archive/2005/03/21/400123.aspx)

这是一个旧工具，我不得不使用更高版本的运行时重新编译源代码，但它运行良好并提供有关更改的 html 报告。

# c# - 如何将标签的字体颜色设置为与 GroupBox 的标题颜色相同？

> ID：590864
> 
> 赞同：4
> 
> 时间：2009-02-26T14:54:33.257
> 
> 标签：c#, .net, vb.net, winforms

我想在表单上有一些标签，其字体颜色与我的组框上的标题颜色相同，此外，如果用户在他们的系统上应用了不同的主题，我希望这些颜色发生变化。

我可以在不更改默认 GroupBox 标题的情况下执行此操作吗？

更新：

我尝试将 Label ForeColor 设置为 ActiveCaption，这对于默认（蓝色）方案看起来不错，但是当我将方案更改为 Olive Green 时，标签和组框标题不一样。

此外，GroupBox 的正常行为是将 FlatStyle 设置为 Standard 会将标题颜色设置为 ForeColor，但是要创建一个新的 GroupBox 并将其 ForeColor 设置为 ControlText，您必须首先将其设置为 ControlText 以外的其他内容，然后再将其设置回来。（如果你不理解我的意思，那就试试看。）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-26T17:12:11.163

嗯，同样的问题？我将重复我的帖子：

```
using System.Windows.Forms.VisualStyles;
...

    public Form1()
    {
      InitializeComponent();
      if (Application.RenderWithVisualStyles)
      {
        VisualStyleRenderer rndr = new VisualStyleRenderer(VisualStyleElement.Button.GroupBox.Normal);
        Color c = rndr.GetColor(ColorProperty.TextColor);
        label1.ForeColor = c;
      }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T15:33:07.550

标签公开 ForeColorChanged 事件。然后，您可以执行以下操作：

```
this.label1.ForeColorChanged += (o,e) => { this.groupBox1.ForeColor = this.label1.ForeColor;}; 
```

但是，如果您尝试检测用户何时更改了他们的主题，您可以连接到 Microsoft.Win32 命名空间中的 SystemEvents。像这样的东西：

```
 Microsoft.Win32.SystemEvents.UserPreferenceChanged += new Microsoft.Win32.UserPreferenceChangedEventHandler(SystemEvents_UserPreferenceChanged);

void SystemEvents_UserPreferenceChanged(object sender, Microsoft.Win32.UserPreferenceChangedEventArgs e)
        {
            this.groupBox1.ForeColor = this.label1.ForeColor;
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T15:37:20.130

我假设您使用 Windows 窗体而不是 WPF。当您应用颜色时，使用系统颜色（例如 Control 或 HighlightText），这些颜色将在用户切换 Windows 主题时更改。这是将组框的颜色设置为系统颜色然后将此颜色应用于标签的代码：

```
groupBox1.ForeColor = SystemColors.ActiveBorder;
label1.ForeColor = groupBox1.ForeColor; 
```

# java - 为什么在 java 中 op-assign 运算符类型不安全？

> ID：590868
> 
> 赞同：3
> 
> 时间：2009-02-26T14:55:34.240
> 
> 标签：java, types, operators, language-features

我不确定这个问题的措辞是否明确，但举个例子会更清楚。

我发现这在 Java 中不起作用：

```
int a = ...;
a = 5.0; 
```

但这将：

```
int a = ...;
a += 5.0; 
```

即，似乎 = 运算符是类型安全的，但 += 不是。这是否有任何深层原因，或者它只是语言设计者必须做出的另一个任意决定。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-26T15:02:52.647

原因是数学运算做了一些隐式转换：

`a += 5.0;`评估如下：

```
a = (int) ((double) a + 5.0); 
```

然而，赋值需要显式转换。

（它可能是浮点数而不是双精度数，我不记得哪个 Java 将其视为十进制文字。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T15:13:55.990

让生活更轻松。

让我们再进一步。考虑：

```
byte b;
...
++b; 
```

增量确实在做：

```
b = (byte)(1 + (int)b); 
```

即使使用`+=`它也不会变得更好：

```
b += b; 
```

是：

```
b = (byte)((int)b+(int)b); 
```

这将使这些运算符对字节/短/字符无用。

当然，除非我们有任意大小的整数，否则我不会高兴。

# c# - 在 C# 中强制转换为 int 的效果

> ID：590871
> 
> 赞同：0
> 
> 时间：2009-02-26T14:56:24.500
> 
> 标签：c#, reference, casting

有人可以花时间在这里向我解释语言基础：

```
int foo = myObject.SomeList.Count;
for (int i = 0 ; i < foo ; i++)
{
  myObject.SomeList.Add(bar);
} 
```

进入无限循环，因为`foo`引用了一个不断增加的值。将第一行修改为：

```
int foo = (int)myObject.SomeList.Count; 
```

让它消失，以某种方式`foo`一劳永逸地从参考变为价值。这可能是教科书，但是，为什么会这样？

非常感谢

**编辑：**好的，正如帕特里克所说，无限循环仅在 foo 没有先前存储时发生，强制转换毫无意义，这是有道理的。这确实是我在调试时最初的想法。因此，当演员修复它时，我感到很惊讶。实际发生的情况是，我被 Visual Studio 误导，以为我已经修复了它，而实际上在编辑的代码和执行的代码之间存在同步问题，从而导致错误的结论。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-26T15:03:42.783

我在我的系统上试过这个，无法复制你的问题。但是，我可以使用以下代码复制它，也许这就是您的意思：

```
// SomeList is not empty before the loop
for (int i = 0; i < myObject.SomeList.Count; i++)
{
    myObject.SomeList.Add(bar);
} 
```

在这种情况下，我们没有将 Count 存储在 int 中，因此每次添加到列表时，我们都将 i+1 与 Count+1 进行比较，因此是无限循环。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-26T14:58:19.427

你确定吗？！！

`int`是一个值类型。这不应该发生。

乔恩斯基特，过来帮忙！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-26T15:01:57.687

您描述的行为不会在 C# 中发生。在这两种情况下，您都明确地将 foo 的值声明为 int 。这是一个值类型。根据定义，foo 指向的实例与 myObject.SomeList.Count 中的原始实例是分开的。

您可以发布更详尽的代码示例吗？

# c# - 属性的默认值

> ID：590872
> 
> 赞同：2
> 
> 时间：2009-02-26T14:56:31.193
> 
> 标签：c#, initialization

如果你有这样的对象：

```
public class Foo
{
    private int _id;

    public int id
    {
        get { return _id; }
        set { _id = value; }
    }

    private string _name;

    public string name
    {
        get { return _name; }
        set { _name = value; }
    }
} 
```

并且您想将 id 初始化为 -1 并将名称初始化为 String.Empty 最佳实践是什么？（以及为什么）

正在做：

```
private int _id = -1 
```

或者

在构造函数中设置 _id = -1 和 name = String.Empty？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-26T14:59:45.740

这更像是一个风格问题。只有少数情况是功能问题

1.  当您有许多将字段初始化为相同值的构造函数时。那时你有多余的代码，应该重构你的构造函数或使用字段初始化器。
2.  如果字段初始值设定项依赖于同一类层次结构中另一个字段的值，则不要使用它。在没有部分类的情况下，结果是可以预测的，但仍然可以让人陷入困境。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T14:59:31.157

取决于您希望何时设置它...

```
private int _id = -1 
```

将在调用构造函数之前初始化 _id。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-26T15:00:16.210

字段方法很简洁，获得了很多选票，但我的偏好（对于简单属性）是使用自动属性，在这种情况下你*不得不*使用构造函数：

```
 public Foo() {
        Id = -1;
        Name = "";
    }
    public int Id {get;set;}
    public string Name {get;set;} 
```

您也可以考虑使用`[DefaultValue(-1)]`etc，这有助于设计人员和序列化程序，但这**不会**影响自动实现的属性（或常规属性）的初始值 - 它只是附加信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T14:59:14.853

在我看来，将其设置为“内联”而不是使用构造函数似乎可以更好地表明意图。在功能上它们是相同的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T15:00:00.950

CLR 向导可能会纠正我，但我相信这两种方法在功能上是相同的，但您可以提出一个论点，即在构造函数中设置默认值更加明确和明显，但也有点混乱。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-26T15:00:42.057

内联初始化由 C# 编译器添加到构造函数的顶部，因此实际上没有区别。我个人更喜欢总是添加构造函数，即使它只是一个默认构造函数。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-26T15:05:17.833

主要是风格偏好的问题。我通常在构造函数中分配它们，因为它是在实例化对象时发生的所有数据和过程的合理位置。

# c# - 如何将 XML 字符串写入文件？

> ID：590881
> 
> 赞同：25
> 
> 时间：2009-02-26T14:59:15.167
> 
> 标签：c#, xml, .net-3.0

我有一个字符串，它的值为：

```
<ROOT>
    qwerty
    <SampleElement>adsf</SampleElement> 
    <SampleElement2>The text of the sample element2</SampleElement2> 
</ROOT> 
```

如何使用 C# 3.0 将此字符串写入文件？

提前致谢。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-02-26T15:07:02.463

尝试这个：

```
string s = "<xml><foo></foo></xml>";
XmlDocument xdoc = new XmlDocument();
xdoc.LoadXml(s);
xdoc.Save("myfilename.xml"); 
```

如果您的 XML 无效，加载将失败的额外好处。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-02-26T15:15:53.190

```
File.WriteAllText("myFile.xml",myString); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T15:01:49.963

您必须使用[CDATA 部分](http://en.wikipedia.org/wiki/CDATA)。更具体地说，创建一个`XmlCDataSection`using`XmlDocument.CreateCDataSection`并将您的字符串作为参数提供。

* * *

## 回答 #4

> 赞同：-6
> 
> 时间：2009-02-26T15:28:15.003

我知道您说的是 C#，但您是否尝试过 VB.NET for XML Literals。惊人的东西。

```
Public Class Program
    Public Shared Sub Main()
        Dim myKeyBoardStyle = "dvorak"

        Dim myXML As XElement = <ROOT>
                                qwerty
                                <altKeyboard><%= myKeyBoardStyle.ToUpper() %></altKeyboard>
                                    <SampleElement>adsf</SampleElement>
                                    <SampleElement2>The text of the sample element2</SampleElement2>
                                </ROOT>

        Console.WriteLine(myXML.ToString())

        myXML.Save(".\fileFromXElement.xml")
    End Sub
End Class 
```

注意将代码结果注入输出的整洁元素：

```
<?xml version="1.0" encoding="utf-8"?>
<ROOT>
                                qwerty
                                <altKeyboard>DVORAK</altKeyboard><SampleElement>adsf</SampleElement><SampleElement2>The text of the sample element2</SampleElement2></ROOT> 
```

剪辑 [删除意见]

# windows - Windows 注册表文件关联菜单

> ID：590892
> 
> 赞同：2
> 
> 时间：2009-02-26T15:00:42.823
> 
> 标签：windows, delphi, registry, shell-extensions

我最近（今天）开始从德尔福内部干预我的注册表。:) 一切正常，我的自定义文件类型现在用我的程序打开，但有 2 个问题我无法解决。

1）我想要从所有文件类型中“打开”的选项，所以我添加了

```
 reg := TRegistry.Create;
  reg.RootKey := HKEY_CLASSES_ROOT;
  reg.LazyWrite := false;
  reg.OpenKey('*\OpenWithList\EncryptionSystem', true);
  reg.WriteString('','C:\Program Files\EncryptionSystem\EncryptionSystem.exe "%1"');
  reg.CloseKey;
  reg.free; 
```

如果我使用 regedit 查看注册表，它肯定在那里，但是当我右键单击一个文件并选择打开时它不存在...

所以我然后添加了这个

```
 reg.OpenKey('*\shell\Encrypt\command', true);
  reg.WriteString('','C:\Program Files\EncryptionSystem\EncryptionSystem.exe "%1"');
  reg.CloseKey; 
```

这对每个文件都有效，但选项位于顶部，带有“打开”和“编辑”。我有点希望它像大多数程序一样出现在菜单小节中......我意识到我需要使用 shellext，但我不明白这些如何与上下文菜单处理程序一起工作的结构......我已经学会了所有无论如何，我已经阅读了注册表......我知道 shellext 的名称稍后会出现在“。*”之后，但至于大乱码键的含义，我不知道。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-26T18:10:12.010

看起来“打开方式”菜单不是由该注册表项单独填充的。它被 Explorer 存储在以下位置的特定于扩展名的列表所胜过：

> HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts

我敢猜测，您添加应用程序的列表仅在资源管理器没有更好用的情况下使用 - 因此仅适用于尚未定义自己的“打开方式”列表的文件。

此外，看起来“打开方式”注册表项的形式应该与您正在使用的形式不同。密钥应该是 EXE 文件的名称，例如*ExcryptionSystem.exe*。该键的默认值（如果存在）应该是一个空字符串。我只是基于我在自己系统上的注册表中看到的内容。

您应该查看[文件类型](http://msdn.microsoft.com/en-us/library/cc144148.aspx)MSDN 文章，它是[文件关联简介的](http://msdn.microsoft.com/en-us/library/cc144104.aspx)一部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T18:07:48.503

查看注册表，您的行应该更改为。

从

```
reg.OpenKey('*\OpenWithList\EncryptionSystem', true);
reg.WriteString('','C:\Program Files\EncryptionSystem\EncryptionSystem.exe "%1"') 
```

到

```
reg.OpenKey('*\OpenWithList\EncryptionSystem.exe', true); //note exe
reg.WriteString('','C:\Program Files\EncryptionSystem\EncryptionSystem.exe "%1"') 
```

首先检查这个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-20T23:48:43.430

在我的 W7P 上，它们没有被引用。相反，他们在...

```
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts 
```

# jakarta-ee - 您知道哪些用于 Java EE JSP 的标记库，例如 displaytag、tinyMCE 以及其他对新 J2EE 开发人员有用的东西？

> ID：590894
> 
> 赞同：0
> 
> 时间：2009-02-26T15:01:21.853
> 
> 标签：jakarta-ee, tinymce, displaytag

您知道哪些用于 Java EE JSP 的标记库，例如[displaytag](http://displaytag.sourceforge.net/11/)、[tinyMCE](http://tinymce.moxiecode.com/)以及其他对新 Java EE 开发人员有用的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T20:55:04.457

你已经提到了我最喜欢的：displaytag。我还将 Struts 标记用于他们的 html 标记集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-30T19:47:49.467

我喜欢配对 ajax-tags:display 来包装我的 displaytags 以完成一些 ajax 工作。

# java - 处理异常的 Java 程序退出

> ID：590899
> 
> 赞同：3
> 
> 时间：2009-02-26T15:03:18.463
> 
> 标签：java, database, termination

假设我有一个打开数据库连接的 Java 应用程序。通常我会在 finally 块中添加一个 connection.close() ，但是在 kill 操作或任何其他异常终止的情况下不会执行此块，不是吗？作为程序员，我是否可以采取任何其他预防措施以便在应用程序退出之前正确关闭连接？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T15:08:31.070

您应该查看 Java 的 Runtime.addShutdownHook() 方法（[http://java.sun.com/javase/6/docs/api/java/lang/Runtime.html#addShutdownHook(java.lang.Thread)](http://java.sun.com/javase/6/docs/api/java/lang/Runtime.html#addShutdownHook(java.lang.Thread))）。它允许您添加一个将在虚拟机终止时调用的钩子。您可以使用它来调用清理例程。

那将是一个 TERM 信号。KILL 信号将杀死进程并且不允许它进行任何清理（因为接收进程无法捕获或忽略 KILL 信号）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-26T15:09:30.710

如果某些外部因素杀死了您的程序，那么您将无能为力。显然他们想阻止它，那你怎么能阻止他们呢？

我打算建议一个[关闭挂钩](http://java.sun.com/javase/6/docs/api/java/lang/Runtime.html#addShutdownHook(java.lang.Thread))，但 Javadocs 状态：

> 在极少数情况下，虚拟机可能会*中止*，即停止运行而没有完全关闭。当虚拟机在外部终止时会发生这种情况，例如`SIGKILL`在 Unix 或`TerminateProcess call`Microsoft Windows 上使用信号终止。如果本地方法出错，例如破坏内部数据结构或尝试访问不存在的内存，虚拟机也可能中止。**如果虚拟机中止，则无法保证是否会运行任何关闭挂钩。**

（强调我的）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-26T15:07:22.510

终止程序最终会使`TCP`从程序到`[Oracle|SQL Server|MySQL|PostgreSQL]`服务器的流超时。

服务器将看到它并回滚任何待处理的事务。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-26T15:10:10.850

1.  您不需要在应用程序关闭时调用 connection.close()，因为所有打开的文件都会被操作系统自动关闭。
2.  此外，连接的 finalize() 方法应该在应用程序自动关闭之前运行（如果关闭是正常的，而不是 ABORTed），并且应该关闭连接。
3.  在任何情况下，您都可以注册[shutdown-hooks](http://java.sun.com/javase/6/docs/api/java/lang/Runtime.html#addShutdownHook(java.lang.Thread))来执行您需要的任何清理工作（同样，将在正常关闭情况下运行，而不是 ABORT）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-26T15:06:46.257

当您真的被杀死时（`kill -9`在 UNIX 上），您无法对此采取任何措施。

A `finally`-block 是您能做的最多的事情，请参阅[SO：在 Java 中，是否保证调用“finally”块（在 main 方法中）？](https://stackoverflow.com/questions/516049/in-java-is-the-finally-block-guaranteed-to-be-called-in-the-main-method)详情。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-26T15:49:55.747

某种程度的异常终止是不可避免的。您如何捕捉到电源线被拉到服务器上的事件？

# c# - NInject：你把你对内核的引用保存在哪里？

> ID：590900
> 
> 赞同：48
> 
> 时间：2009-02-26T15:03:24.720
> 
> 标签：c#, dependency-injection, inversion-of-control, ioc-container, ninject

我在一个新的 Web 应用程序上使用 NInject，有两件事我不清楚：

1.  我不需要保留对内核的引用（会话/应用变量）以确保 GC 不会收集我的所有实例吗？例如，如果我指定 .Using() 然后收集 Kernel 对象，我的所有“单例”不也被收集了吗？

2.  如果我确实需要保留对 Kernel 对象的引用，我如何允许传递给 WithArguments() 的参数发生变化，或者这是不可能的。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-02-26T16:39:08.747

确实，您不想绕过内核。通常，在 Web 应用程序中，我将内核存储在 HttpApplication 的静态属性中。如果您需要对内核的引用，您可以只公开一个类型为 IKernel 的依赖项（通过构造函数参数或属性），然后 Ninject 将为您提供对激活该类型的内核的引用。

如果在绑定上使用 WithArguments()，它们将用于所有激活。如果您使用 IParameters，它们将仅用于该激活。（但是，如果您正在激活的服务具有像 Singleton 这样的可重用行为，即使您传递不同的 IParameters，它也不会被重新激活。）

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-26T15:20:49.840

这是开始使用 IoC 容器时的常见陷阱。请参阅[此相关问题](https://stackoverflow.com/questions/109668/ioc-where-do-you-put-the-container)。

简而言之：

*   传递你的容器是不好的做法（去过那里，做过，真的很痛）
*   如果你真的需要直接调用容器，首先考虑抽象为注入工厂，然后作为最后一个资源考虑使用容器的静态网关

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2011-03-22T04:21:23.993

Mark Seeman -- [Manning Dependency Injection](http://www.manning.com/seemann/)的作者建议使用**好莱坞原则**不要打电话给我们（IOC 框架），我们会打电话给你...... IOC 容器应该放在 Application 的 Composition root.. 它需要按要求实例化.. 就像提到的 wat nate

.. 对于 Web 应用程序，组合根是 Global.asax 文件，您可以在其中使用覆盖启动事件，并且您可以绑定您的 Ninject 来解析组件

# c# - 光标在winforms中消失（C#）

> ID：590906
> 
> 赞同：0
> 
> 时间：2009-02-26T15:04:44.560
> 
> 标签：c#, winforms

我的 winforms 应用程序中的光标有问题。当我按下表单上的按钮时，光标会消失一小段时间（1-3 秒）

有任何想法吗？这可能是由后台工作人员干扰 cursor = cursors.waitcursor 调用引起的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T15:07:27.597

我的猜测是，您有一个在该时间范围内正在运行并“冻结”用户界面的进程。使用 BackgroundWorker 和 cursor = cursors.waitcursor 可能会导致问题。

# linux - 来自 root 帐户的 Bash 脚本和用户主目录 (Linux)

> ID：590909
> 
> 赞同：0
> 
> 时间：2009-02-26T15:06:13.590
> 
> 标签：linux, bash, scripting, root

我正在 bash 中为 Linux 上的应用程序编写安装脚本。

该脚本将一些文件复制到 /usr/bin 和 /usr/share 中，因此需要由 root 用户执行，此外它在 $HOME 目录中为配置文件创建了一个隐藏目录。

问题来了：如果普通用户想要安装程序，他需要是 root。但如果他是 root，$HOME 目录将是 /root/ 而不是 /home/username。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-26T15:11:30.660

...此外，如果 UserA 安装了软件，但 UserB 运行它，则 UserB 将不会在`/home/UserB`. 此外，下面的隐藏目录`/home/UserA`将由 root 拥有，而不是 userA。

因此，您需要让应用程序创建隐藏目录，而不是安装程序。

另一种可能的选择是不安装在系统目录中；一种可能的替代位置是`/usr/local`. 但是，即使这样也可能需要 root 权限。想想它是否可以安装在其他地方，以及它如何定位它的材料。

但是，需要 root 权限才能安装并不是世界末日——对某些人来说是一种麻烦，但并非完全不正常。但是要求每个使用过的人都具有 root 权限是不正常的——如果每个使用它的人都需要运行安装程序，那就不好了。

最后一点（现在）：如果你使用`sudo`，它不会改变 $HOME 的值，即使你获得了 root 权限。但是，要求使用您的应用程序的每个人都拥有`sudo`特权也不是一件好事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T15:28:34.517

你必须使用`$HOME`吗？也许您可以提示输入用户名并安装到`~$username`？

# .net - 在击键时显示 .NET Windows 应用程序

> ID：590910
> 
> 赞同：3
> 
> 时间：2009-02-26T15:06:40.030
> 
> 标签：.net, keyboard, desktop-application, keystroke

我的应用程序主要位于最小化的系统托盘上。我希望用户能够击键（如 ALT+SHIFT 等）并显示在屏幕上（有点像 Launchy，如果你使用过它；或谷歌搜索栏）。

有谁知道该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T15:11:25.183

您需要 SetWindowsHookEx Windows API 调用。在这篇 CodeProject 文章中有一些关于使用它的细节：

[http://www.codeproject.com/KB/system/CSLLKeyboard.aspx](http://www.codeproject.com/KB/system/CSLLKeyboard.aspx)

还有一些有用的建议，关于什么会起作用，什么不起作用，以及 SetWindowsHookEx 和 .NET 周围潜伏着哪些棘手的问题：

[http://www.pinvoke.net/default.aspx/user32.SetWindowsHookEx](http://www.pinvoke.net/default.aspx/user32.SetWindowsHookEx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T15:19:06.897

[托管 Windows API](http://mwinapi.sourceforge.net/)有一个 Hotkey 类，它封装了您想要的低级挂钩。非常容易使用。

# ant - 如何在战争任务中引用类路径引用？

> ID：590911
> 
> 赞同：6
> 
> 时间：2009-02-26T15:06:43.650
> 
> 标签：ant

我为我的应用程序库声明了以下类路径引用：

```
<path id="libraries">
    <fileset dir="${lib.dir}" includes="**/*.jar" />
</path > 
```

我可以使用库的类路径编译代码：

```
<javac srcdir="${src}" destdir="${build.classes}" classpathref="libraries"/> 
```

但是我找不到将库文件集也包含在我的 WAR 文件中的方法：

```
<war destfile="${release.dir}/rel.war" webxml="${webinf}">
    <classes dir="${build.classes}"/>

     <!-- I need to copy paste the same directory declaration! -->
    <lib dir="${lib.dir}" includes="**/*.jar"/> 
</war> 
```

如何用与我的 javac 任务重用相同路径的东西替换“lib”声明？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T17:12:20.790

声明`fileset`out of the`path`并为其分配一个标识符：

```
<fileset id="xxx" dir="..." includes="..." /> 
```

然后在两个声明中引用标识符（`lib`指定一个文件集，因此您不必使用嵌套）：

```
<path id="libraries">
    <fileset refid="xxx"/>
</path>
...
<lib refid="xxx"/> 
```

# c# - 将自定义对象序列化为 XML

> ID：590914
> 
> 赞同：3
> 
> 时间：2009-02-26T15:07:01.607
> 
> 标签：c#, xml, serialization

我正在尝试创建一个可以序列化以生成以下 XML 的类：

```
<chart palette='1'>
  <categories>
    <category label='2001' />
    <category label='2002' /> 
```

..ETC

我有一个看起来像这样的类：

```
[XmlRoot("chart")]
public class Chart
{        
    [XmlAttributeAttribute("palette")]
    public string Palette;

    [XmlElement("categories")]
    public List<Category> Categories = new List<Category>();
}

[XmlRoot("category")]
public class Category
{
    [XmlAttributeAttribute("label")]
    public string Label;
} 
```

但是，这不会产生所需的图表->类别->类别@标签结构。Category 类上的 XmlRoot 似乎没有被使用。这是我从该代码中获得的输出：

```
 <chart palette="2">
  <categories label="2002" /> 
 </chart> 
```

如何获得我想要的 XML 结构？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-26T15:10:30.473

使用[XmlArrayAttribute](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlarrayattribute.aspx)和[XmlArrayItemAttribute](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlarrayitemattribute.aspx)

```
[XmlRoot("chart")]
public class Chart
{        
    [XmlAttributeAttribute("palette")]
    public string Palette;

    [XmlArray("categories")]
    [XmlArrayItem("category")]
    public List<Category> Categories = new List<Category>();
}

public class Category
{
    [XmlAttributeAttribute("label")]
    public string Label;
} 
```

有时只创建所需的 xml 结构，然后使用 xsd.exe 从中生成类会很有用。这必须分两步完成，首先生成一个 xsd 文件，然后从中生成类。

```
xsd.exe something.xml
xsd.exe something.xsd /classes 
```

这可能不会给出您想要的确切结果（除非您有一个非常好的 xsd，并且不只是从 xml 生成它），但确实给出了一些想法

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-26T15:13:05.430

应该：

```
[XmlRoot("chart")]
public class Chart
{        
    [XmlAttributeAttribute("palette")]
    public string Palette;

    [XmlArray("categories")]
    [XmlArrayItem("category")]
    public List<Category> Categories = new List<Category>();
}

[XmlRoot("category")]
public class Category
{
    [XmlAttribute("label")]
    public string Label;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-06T01:48:01.927

我有一个类似的想法，并最终编写了一个自定义基类来处理它。[在http://www.ideosity.com/ASP-NET/Object-to-XML-lab.aspx](http://www.ideosity.com/ASP-NET/Object-to-XML-lab.aspx)查看我的文章。我认为它会让你朝着正确的方向前进。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T15:18:06.883

即使这是针对 ASP.NET，您可能会发现此链接很有用

[ASP.NET 中的 XML 序列化](http://www.4guysfromrolla.com/webtech/012302-1.shtml)

它告诉您在序列化方面如何以两种方式工作。

另外，不要忘记可以通过Visual Studio 附带的**命令提示符使用的 xsd.exe 工具（我使用的是 .NET 2005）**

例如，您可以通过将 XML 文件传递​​给它来创建以下架构

例如**xsd yourfile.xml**

然后，您可以使用生成的 xsd 创建一个序列化类，它基本上是 XML 的对象模型，通过将模式传递给 xsd，每个节点都有一个类

例如**xsd yourfile.xsd /c /l:C**

同样，这是基于 .NET 的，因此如果原始海报不感兴趣，请致歉。

# winforms - 用于继承 UI 样式控件的 WinForms 事件

> ID：590919
> 
> 赞同：1
> 
> 时间：2009-02-26T15:07:28.907
> 
> 标签：winforms, user-interface, controls

跟进这个问题：

[Winforms 风格/UI 外观和感觉提示](https://stackoverflow.com/questions/553518/winforms-style-ui-look-and-feel-tips)

因此，我创建了其他控件继承自的“基本控件”。为了测试，我正在尝试更改一种基本标签的字体。但它不会传播到从它继承的控件。在其中一个表单上，我可以看到设计器文件正在设置控件的属性，因此我的基本控件的属性被覆盖。

在基本控件上，我使用构造函数来设置默认属性。我应该使用不同的事件吗？如果有，是哪一个。

这是基于评论请求的基本控件之一的代码...

```
Public Class InfoLabel
    Inherits Label

    Public Sub New()
        ' This call is required by the Windows Form Designer.
        InitializeComponent()

        ' Add any initialization after the InitializeComponent() call.
        Me.Font = New System.Drawing.Font("Tahoma", 14.25!)
        Me.ForeColor = System.Drawing.Color.FromArgb(CType(CType(49, Byte), Integer), CType(CType(97, Byte), Integer), CType(CType(156, Byte), Integer))
        Me.AutoSize = False

    End Sub
End Class 
```

基本控件显示在 winform 编辑器的项目工具箱中。然后从工具箱中拖放控件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T22:02:15.040

您的问题是您的自定义控件的 InitializeComponent() 方法。我不知道为什么会在那里。如果您正在实现 UserControl，您将自动获得该方法，但从标准控件继承该方法不应该存在。由于您的基类有一个 InitializeComponent() 方法，而您的子类也有一个，因此有人正在覆盖其他人。

我只是在 C# 中对标签进行了子类化。我将它拖到我的表单上，字体显示为新字体，而不是基（标签）类的字体。

```
using System.Drawing;
using System.Windows.Forms;

namespace WindowsFormsApplication1
{
    public class MyLabel : Label
    {
        public MyLabel()
        {
            Font = new Font("Candara", 14);
        }
    }
} 
```

然后我创建了第二个标签，称为 MySubLabel，它继承自 MyLabel 类。当我更改 MyLabel 类的 ForeColor 时，MySubLabel 会自动更新。

所以这应该有效。

警告：在 Visual Studio 中，您需要在尝试在设计器中查看更新之前重新编译程序集。

# python - Django - 使用虚拟字段设计模型？

> ID：590921
> 
> 赞同：3
> 
> 时间：2009-02-26T15:08:17.780
> 
> 标签：python, django, django-models

在 Django 中设计具有虚拟字段的模型时，我想问一下最优雅的方法......

假设我们正在建立一个在线商店，系统中的所有产品都由模型“*产品*”定义。

```
class Product(models.Model):
    # common fields that all products share
    name = ...
    brand = ...
    price = ... 
```

但是商店会有很多完全不相关的产品类型，所以我需要一些方法来存储不同产品类型的虚拟字段（即 MP3 播放器的容量，一本书的页数，..）。

到目前为止，我可以用我的原始 Django 技能提出的解决方案远非完美：

*   拥有我手动管理的“custom_fields”属性和中间表。（在我脸上难看地尖叫:)）

*   *或者使用 Python 危险的 exec-eval 语句动态地从“ Product* ”继承类（这对于维护来说太巫术了，而且实现需要了解 Django 内部知识）。

你对此有何看法？

TIA。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-26T15:17:49.100

产品有特点。

```
class Feature( models.Model ):
    feature_name = models.CharField( max_length=128 )
    feature_value = models.TextField()
    part_of = models.ForeignKey( Product ) 
```

像那样。

只是功能列表。

```
p= Product( "iPhone", "Apple", 350 )
p.save()
f= Feature( "mp3 capacity", "16Gb", p )
f.save() 
```

如果需要，您可以在单独的表中拥有功能名称的主列表。不要过度分析特征。您不能对它们进行任何处理。你所做的就是呈现它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-26T15:09:48.090

Ruby on Rails 有一个“序列化”字段，允许您将字典打包到文本字段中。也许 DJango 提供了类似的东西？

[本文](http://www.davidcramer.net/code/181/custom-fields-in-django.html)有一个 SerializedDataField 的实现。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-26T15:28:37.140

就个人而言，我会选择 S. Lott 的回答。但是，您可能想要创建一个自定义 JSON 字段：

[http://svn.navi.cx/misc/trunk/djblets/djblets/util/fields.py](http://svn.navi.cx/misc/trunk/djblets/djblets/util/fields.py)

[http://www.djangosnippets.org/snippets/377/](http://www.djangosnippets.org/snippets/377/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T20:43:55.610

带着遗产去吧。使用自己的附加字段创建 Produce 子类。

# sql - 获取新的 SQL 记录 ID

> ID：590927
> 
> 赞同：10
> 
> 时间：2009-02-26T15:09:37.730
> 
> 标签：sql, sql-server, sql-server-2005, asp-classic

如何取回刚刚插入的新记录的自动生成 ID？（使用 ASP 经典和 MSSQL 2005）

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-26T15:13:28.360

```
SELECT SCOPE_IDENTITY() 
```

使用 @@IDENTITY 可能会产生意想不到的结果，所以要小心你如何使用它。将记录插入其他表的触发器将导致 @@IDENTITY 值更改 - 其中 SCOPE_IDENTITY() 将为您提供仅来自当前范围的最后一个身份。

这是一个示例，它将显示 @@IDENTITY 和 SCOPE_INSERT() 之间的区别以及它们如何返回不同的值。

```
use tempdb
go
create table table1
    (ID int identity)
go
create table table2
    (ID int identity(100, 1))
go
create trigger temptrig 
    on table1 
    for insert
as
begin

    insert  table2 
     default values;

end
go
insert  table1 
default values;
select  SCOPE_IDENTITY(), 
        @@IDENTITY 
```

此处没有人讨论的另一个选项是使用 SQL 2005 中的 OUTPUT 子句。在这种情况下，您只需将输出子句添加到插入中，然后从代码中捕获该记录集。这在插入多条记录而不是仅插入 1 条时效果很好...

```
use tempdb
go
create table table1
    (ID int identity)
go
insert   table1 
output   inserted.ID
default values;
--OR...
insert   table1 
output   inserted.$identity
default values; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-26T15:15:47.560

SELECT @@IDENTITY 通常有效，但可能会返回由于触发器或其他原因插入的记录的标识，而不是原始标识。

SELECT SCOPE_IDENTITY 是我推荐的。它返回仅在当前范围内插入的值。

还有一个“IDENT_CURRENT(tablename)”返回为特定表插入的最后一个标识。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-26T15:31:59.690

**有三种方法可以获取*sql*中的最后一个标识。**

其他人已经提到了它们，但为了完整起见：

*   @@IDENTITY - 还可以返回在同一范围内的其他对象中创建的 id（想想触发器）
*   IDENT_CURRENT - 仅限于一个表，但不限于您的范围，因此它会给繁忙的表带来不好的结果
*   Scope_Idenity() - 仅限于请求的范围。99% 的时间都在使用它

**此外，还有三种方法可以获取该 ID 并将其返回*给您的客户端代码：***

*   在存储过程中使用输出参数

    ```
    INSERT INTO [MyTable] ([col1],[col2],[col3]) VALUES (1,2,3); 
    SELECT @OutputParameterName = Scope_Identity(); 
    ```

*   使用返回值。

    ```
    INSERT INTO [MyTable] ([col1],[col2],[col3]) VALUES (1,2,3); 
    Return Scope_Identity(); 
    ```

*   选择 id 到结果集中。例如，您的 sql 语句将如下所示：

    ```
    Dim ResultID As Integer
    Dim strSQL As String
    strSQL = "INSERT INTO [MyTable] ([col1],[col2],[col3]) VALUES (1,2,3); SELECT Scope_Identity();"
    rsResults.Open strSQL, oConn
    ResultID = rsResults("ID") 
    ```

不幸的是（或者幸运的是，从我的角度来看）我的 Classic ASP 太远了，无法显示来自客户端代码的前两个示例。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-26T15:16:13.487

SELECT @@Identity 或 SELECT SCOPE_IDENTITY() 都可以工作，但是选择 SCOPE_Identity() 更安全，因为它返回当前范围内最后一个自动生成的 ID。例如，假设我们有一个名为 ScopeIDTable 的表，并且在这个表上我们有一个触发器。此触发器将插入一条记录到 TriggerIdTable 中，两个表都有一个自动增量列。

如果您使用 SELECT @@Identity，您将获得该会话中的最后一个自动增量，这将是从触发器 (TriggerIdTable) 中生成的 Id。

如果您使用 SELECT SCOPE_IDENTITY()，您将从 ScopeIdTable 中获取 id。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-26T15:34:03.677

您运行查询

```
select scope_identity() 
```

使用相同的数据库连接，然后再对其进行任何其他操作。正如您可能期望的那样，结果是一个记录集，其中包含具有单个字段的单行。您可以使用索引 0 访问该字段，或者如果您愿意，也可以为其命名：

```
select scope_identity() as lastId 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-01T20:38:36.137

我一直想知道为什么有人会想要使用

```
@@identity 
```

自从

```
select scope_identity() 
```

显然是完成 Scot 要求的最省钱的方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-26T15:43:28.007

在需要以基于集合的方式一次插入多个记录的情况下，它会变得更有趣。

我有时会在客户端使用 GUID 生成（但对于经典 ASP，您可能需要使用实用程序来生成值），或者更常见的是在服务器端的 GUID 键列上使用 NEWSQUENTIALID() 约束。

我知道不是每个人都喜欢 GIUDS，但出于一些非常正当的原因（它们的大小以及它如何影响索引/分页）。

[http://www.sqlmag.com/Articles/Index.cfm?ArticleID=50164&pg=2](http://www.sqlmag.com/Articles/Index.cfm?ArticleID=50164&pg=2)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-17T21:26:35.203

感谢所有建议 SELECT SCOPE_IDENTITY() 的人。我能够创建一个存储过程：

```
USE [dbname]
GO 
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[spInsert]
(
   @Nn varchar(30)
)
AS
BEGIN TRANSACTION InsertRecord 
   INSERT INTO A (Nn) 
   VALUES (@Nn) 
   SELECT NewID = SCOPE_IDENTITY()   -- returns the new record ID of this transaction
   COMMIT TRANSACTION InsertRecord 
```

并使用 VB 调用存储过程：

```
Dim strNn '<- var to be passed'
Set cn = Server.CreateObject("ADODB.Connection") 
connectString = "DSN" 
cn.Open connectString, "user", "PW0rd" 
Set rs = Server.CreateObject("ADODB.Recordset") 
set rs = cn.Execute("EXEC [dbname].[dbo].[A] @Nn=" & strNn)
'return the value'
resultID = rs(0) 
```

我现在可以在任何时候引用新创建的 ID 时使用 resultID。

# actionscript-3 - as3 访问未定义的属性？

> ID：590930
> 
> 赞同：0
> 
> 时间：2009-02-26T15:10:07.340
> 
> 标签：actionscript-3, flash-cs4

有人可以帮我找出为什么我在以下截图中收到错误消息“访问未定义的属性：removeChild(goBack)”吗？

顺便说一句，这是用于 Flash CS4

```
function nameOfFunction() {

var goBack:backButton_mc = new backButton_mc();

goBack.x = 10;

goBack.y = 700;

goBack.back_text.text = myXML.*[buildingName].NAME;

goBack.name = "backBtn";

goBack.buttonMode = true;

addChild(goBack);

goBack.addEventListener(MouseEvent.CLICK, anotherFunction);

}

function anotherFunction(e:MouseEvent):void {

 removeChild(goBack);

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T15:45:34.697

你的范围错了。（惊喜：-D）

变量 goBack 只是在“nameOfFunction”中定义的，当您尝试从另一个函数（如“anotherFunction”）访问它时，它将不再存在（即使它在显示列表中）

解决这个问题有不同的可能性：

```
function anotherFunction(e:MouseEvent):void {
   removeChild(e.currentTarget);
} 
```

或者最好的方法是：将 goBack 提升为拥有这两个功能的类的类成员。（或者，如果您不使用类，则将 goBack 设为“全局”。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T00:58:31.860

河马是正确的，但我觉得多解释一点很重要。

您创建了一个局部变量，即 var someVariable:DataType; 一个函数内。这意味着该变量仅可用于函数（本地）范围（内部）中的对象，并且仅在函数的生命周期内持续存在。一旦该函数运行，代码就消失了，直到再次运行。看起来您很可能直接在时间线上的 flash IDE 中进行编程，这很好，但是，如果您使用的是文档类，您只需在构造函数上方的 Class 范围内声明您的变量，然后在您现在使用的相同函数中设置值。这样，对变量的引用不存在于函数中，它只是从内部设置。这将允许从同一类中的任何位置访问该变量，即使设置为私有。

这可能会有所帮助：

```
//Frame 1, Actions layer
//Slap goBack right onto the root / stage
var goBack:MovieClip;
/*
I noticed you had this data-typed differently,
i prefer to type to an interface, not an implementation.
Since your class is a movieclip in the library it extends
MovieClip and therefor IS A MovieClip, but ok either way.
*/

function nameOfFunction():void
{
    goBack = new backButton_mc();
    goBack.x = 10;
    goBack.y = 700;
    goBack.back_text.text = myXML.*[buildingName].NAME;
    goBack.name = "backBtn";
    goBack.buttonMode = true;
    addChild(goBack);
    goBack.addEventListener(MouseEvent.CLICK, anotherFunction);
}

function anotherFunction(e:MouseEvent):void
{
    removeChild(goBack);
} 
```

范围非常重要，一段时间后很容易解决。坚持下去，进行实验，阅读可以帮助您的开发的约定和标准，并开始喜欢 DocumentClass，因为即使一开始它可能会让某些人望而生畏，一旦您学习并习惯了它，就很难去回到时间轴上的 flash IDE 编程，我相信只有显示对象和音频有任何存在。

# c# - TSQL：生成人类可读的 id

> ID：590933
> 
> 赞同：1
> 
> 时间：2009-02-26T15:10:25.170
> 
> 标签：c#, tsql

我们有一个包含查询的大型数据库，每个查询都使用 Guid 引用。Guid 对客户不是很友好，所以我们想要额外的 5 位“人类 id”（好的，因为我们很可能在任何时候都不会有超过 99999 个查询，如果一个人类用户引用多个查询也没关系因为它们不用于任何重要的事情）。

1) 有没有办法在 99999 之后将 IDENTITY 列重置为 1？

我目前的解决方法是使用`INT IDENTITY(1,1) NOT NULL`列，并在呈现 HumanId 时使用`HumanId % 100000`。

2）有什么办法可以自动“随机分配”[0..99999] 上的 id，以便在彼此之后创建的两个查询不会获得相邻的 id？我想我正在寻找一个双向的一对一哈希函数？？

...理想情况下，我想在创建查询时使用 T-SQL 自动创建这些 id 来创建它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T15:15:15.423

如果性能和并发性不是太大问题，您可以使用触发器和 MAX() 函数来计算“下一个人类 ID”值。您可能希望将 IDENTITY 列保持原样，并将“人类 ID”放在单独的列中。

编辑：顺便说一句，这听起来像是一个“表示层”问题，它不应该出现在您的数据库中。您的应用程序的表示层应该有代码来担心以人类可读的方式呈现记录。只是一个想法...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T15:32:39.797

我强烈建议重新审视你的逻辑。你的方法有一些危险，包括：

1.  重复使用 ID 总是一个坏主意，即使原始记录已经“过时” - 如果继续将 ID 增加到 99999 之后，您会失去什么吗？这里的问题更有可能是长期维护，特别是如果系统随着时间的推移而发展存在任何危险。另一件需要考虑的事情 - 用户是否有机会获取此参考编号，并在将来的某个阶段使用它来参考您的系统？

2.  通过手动分配生成/随机 ID，您需要确保没有为多条记录分配相同的 ID。您必须遵循一些选项（例如，使用事务），但是您应该确保事务的范围不会让您面临并发事务被阻止的问题 - 这可能会导致一些问题例如。表现。最好的方式是在外部生成 ID（因为 SQL 的随机性不是特别好），然后对数据库执行唯一约束，也许是 Firoz Ansari 建议的方式。

如果您仍想重置标识列，可以使用 DBCC CHECKIDENT 命令来完成。

在 SQL Server 中生成随机种子的示例可以在这里找到： [http ://weblogs.sqlteam.com/jeffs/archive/2004/11/22/2927.aspx](http://weblogs.sqlteam.com/jeffs/archive/2004/11/22/2927.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-26T16:03:37.693

如果您绝对需要在数据库中执行此操作，那么为什么不直接从 GUID 列中获取您的人性化值呢？

```
-- human_id doesn't have to be calculated when you retrieve the data
-- you could create a computed column on the table itself if you prefer
SELECT (CAST(your_guid_column AS BINARY(3)) % 100000) AS human_id
FROM your_table 
```

这将为您提供一个介于 0 和 99999 之间的随机值，该值源自 GUID 的前 3 个字节。如果您想要更大或更小的范围，请相应地调整除数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T15:20:11.700

您可以创建具有两列的复合主键，例如..BatchId 和 HumanId。这些列中的记录将如下所示：

批次 ID、人类 ID

1, 1

1, 2

1、3

.

.

1、99998

1、99999

2, 1

2, 2

3, 3

使用 MAX 或 ORDER BY DESC 获取下一个可用的 HumanId，条件为 BachId

```
SELECT TOP 1 @NextHumanId=HumanId
FROM [THAT_TABLE]
ORDER BY BatchId DESC, HumanID DESC

IF @NextHumanId>=99999 THEN SET @NextHumanId=1 
```

希望这有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T15:14:25.550

您可以有一个可用 HUMANID 表，每次添加查询时，您都可以从表中随机提取一个 HUMANID（并删除它），每次删除查询时，您都可以将其添加回来（通过插入）。

# flash - 关于在表单上的 Flash 播放器中播放 youtube 电影的操作脚本

> ID：590934
> 
> 赞同：2
> 
> 时间：2009-02-26T15:10:30.117
> 
> 标签：flash, actionscript, youtube

我有 ac# 表单，我想在其中显示 youtube 电影。我已经放置了一个冲击波闪光对象，我可以在其中加载 youtube 电影。

axShockwaveFlash.LoadMovie(0, " [http://www.youtube.com/v/tVP0b8qvZg8&enablejsapi=1&playerapiid=ytplayer](http://www.youtube.com/v/tVP0b8qvZg8&enablejsapi=1&playerapiid=ytplayer) ");

这很好用。当我通过代码，想要播放/暂停/任何东西与 youtube 电影时，就会出现问题。我可以理解需要做一些动作脚本并使用冲击波调用函数，但到目前为止没有任何效果。我是 Actionscripting 和 flash 的初学者。

我希望你们中的一些人可以提供一些帮助或代码示例来控制我的 youtube 电影。

非常感谢提前

拉斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T17:15:24.710

[在 C# 应用程序中嵌入 Flash 视频](http://www.adobe.com/devnet/flash/articles/stock_history03.html)有一个很好的示例。我建议您按照文章并将参数转发到视频播放器 - Youtube API 的命令可在 Google 代码部分中找到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T21:38:23.453

这为您提供了有关使用 YouTube API 和 Chormeless 播放器的详细教程，因此您可以自行控制电影。如果您需要，我也有一个演示，但这应该足以让您继续前进，如果您需要更多帮助，请告诉我:)

教程：[http ://www.perkstoveland.com/archives/40](http://www.perkstoveland.com/archives/40)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-09T19:08:21.770

如果您只想在您的网站上播放 Youtube 视频，则只需将其嵌入即可。

例如：

```
<object width="400" height="300">
   <param name="movie" value="http://www.youtube.com/v/2Trszk44ElI&hl=en&fs=1&showinfo=0" />
   <param name="allowFullScreen" value="true" />
   <param name="allowscriptaccess" value="always" />
   <embed src="http://www.youtube.com/v/2Trszk44ElI&hl=en&fs=1&showinfo=0" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="400" height="300"></embed>
</object> 
```

或者，您可以使用 JW Player，它是内置于 actionscript 3 中的免费视频播放器（仅供个人使用）。 [http://www.longtailvideo.com/players/jw-flv-player/](http://www.longtailvideo.com/players/jw-flv-player/)

# mysql - MySQL / ColdFusion 8：sql模式

> ID：590937
> 
> 赞同：3
> 
> 时间：2009-02-26T15:10:47.557
> 
> 标签：mysql, coldfusion, coldfusion-8

我们一直在用 ColdFusion 和 MySQL 做一些测试，有点困惑。我们知道您可以在 /etc/my.cnf 文件中设置不同的“sql-mode”标志，这将导致 MySQL 以特定方式运行，具体取决于定义的模式。我们知道您也可以在启动 MySQL 时使用“--sql-mode=”标志设置这些标志。

在 /etc/my.cnf 中，我们看到没有定义模式（其中一个被注释掉了），所以我们添加了 'sql-nodes=""' 并重新启动了 mysql (/etc/init.d/mysqld restart)。每当我们进入 MySQL 命令行查看设置的模式时，输出如下：

```
mysql> SELECT @@GLOBAL.sql_mode;
+-------------------+
| @@GLOBAL.sql_mode |
+-------------------+
|                   | 
+-------------------+
1 row in set (0.00 sec)

mysql> SELECT @@SESSION.sql_mode;
+--------------------+
| @@SESSION.sql_mode |
+--------------------+
|                    | 
+--------------------+
1 row in set (0.00 sec) 
```

这告诉我没有模式，这就是我们想要的。然而，在 ColdFusion 8 中做同样的事情，我们看到以下内容：

* * *

```
SELECT @@GLOBAL.sql_mode;
[empty string]

SELECT @@SESSION.sql_mode;
STRICT_TRANS_TABLES 
```

* * *

这表明 Global sql-mode 为空，而 Session sql-mode 设置为 ' `STRICT_TRANS_TABLES`'，这是我们不想要的。

现在，在我们做任何其他事情之前，我可以在 ColdFusion 中将 Session sql-mode 设置为空，这给了我想要的效果，但我真的不想去每个查询并添加它。

我（尝试）查看 /etc/init.d/mysqld 脚本以查看是否可以找到设置模式的位置，但什么也没看到。

你们对正在发生的事情有什么建议或想法吗？就好像 ColdFusion 将它设置在某个地方一样，但是我可以看到 ColdFusion 管理员中没有任何东西可以设置它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-26T19:00:56.223

我对此做了一些研究，看起来这是与 Java 或 JDBC 的兼容性问题：

> 驱动程序需要启用 STRICT_TRANS_TABLES 模式以强制执行截断检查的 JDBC 合规性。
> 
> 如果您不能使用 STRICT_TRANS_TABLES 作为 sql_mode 的一部分，那么您必须通过添加“jdbcCompliantTruncation=false”作为 URL 配置参数来禁用截断检查。

在这里找到：[http ://bugs.mysql.com/bug.php?id=23371](http://bugs.mysql.com/bug.php?id=23371)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T18:26:16.010

我的*猜测*是 CF/JDBC 连接中的某处正在缓存该信息。您是否尝试过重新启动 CF 或添加新数据源以查看会发生什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T19:04:17.980

根据 Ben Doom 所说，您可能想尝试使用 MySQL 的 MyODBC 驱动程序为 MYSQL 设置数据源，看看是否得到不同的结果。

# java - 从 Java 文本组件中获取删除的文本

> ID：590951
> 
> 赞同：4
> 
> 时间：2009-02-26T15:14:36.877
> 
> 标签：java, swing, text, jtextcomponent

A`JTextComponent`允许您将 a 添加`DocumentListener`到其`Document`中，这将告诉您何时添加或删除文本，以及更改的偏移量和长度。但是，它不会告诉您更改的文本是什么。

这对于添加文本来说不是什么大问题，因为您可以使用偏移量和长度来查找添加的文本。但是，您不能使用它来查找已删除的文本，因为该文本已经消失了。

有没有人遇到过这个问题？如何获取从文档中删除的字符串？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T15:21:10.010

安装`DocumentFilter`到`AbstractDocument`.

（顺便说一句：在 Swing 中，通常最好直接使用模型（在本例中为文档）。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T15:17:30.440

每次添加文本时，将文档存储在内存中。每次删除文本时，将文档与上次存储的内容进行比较以确定删除的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T15:18:18.740

将文本的原始版本存储在一个属性中，您仍然可以在其中执行“偏移长度技巧”来获取删除的字符串。应该做得很好

# linux - 顶部的进程命令

> ID：590952
> 
> 赞同：28
> 
> 时间：2009-02-26T15:14:55.987
> 
> 标签：linux, bash, process, utilities, top-command

当您运行几个 python 脚本时，问题就出现了。在命令顶部，它仅显示带有这些脚本的“python”。如何重命名进程或以其他方式标记它，以便我可以在顶部区分它们？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-02-26T15:20:48.920

只需使用该`--full-commands`选项显示每个进程的完整命令行：

```
top -c 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-26T15:18:59.143

按“ `c`”并显示命令行 - 这将允许您查看它们是什么。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-26T15:20:23.803

您还可以查看 ps 命令。根据您的系统：

```
ps aux 
```

或者

```
ps -fu USERNAME 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-26T15:19:30.123

您是否正在寻找一种显示完整命令行的方法？然后只需按' `c`'

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-26T15:21:27.843

这可能取决于平台和版本，但在我使用的平台（CentOS、Debian）上，top 通常将命令运行的最后一部分显示为 ID。

因此，我猜测您正在通过执行“python *scriptname* ”来运行脚本。

如果您将脚本更改为可作为它们本身执行（chmod +x 和第一行 #!/usr/bin/python [或 python 所在的任何地方]），然后仅使用“ *scriptname* ”而不是“python *scriptname* ”运行它们，它们应该作为他们的文件名显示在顶部。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-26T15:34:09.717

您也可以尝试 ps aux 或 ps -au USESRNAME。ps 非常好，因为您可以格式化输出，例如。ps -u USERNAME -o pid,command 显示进程的pid和命令。然后你也可以通过 grep (ps -u USERNAME -o pid,command|grep python) 过滤，查看所有正在运行的python脚本。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-26T22:14:14.107

我不确定您是否可以在 Python 中执行此操作，但在 C 程序中，实际上可以修改 argv[0] 以显示进程的“更漂亮”的名称。我认为限制是新名称的长度必须等于或短于原始名称，这样您就不会踩到内存。

# javascript - 使用 ASP.NET MVC 框架时最好的 WYSIWYG 编辑器是什么？

> ID：590960
> 
> 赞同：35
> 
> 时间：2009-02-26T15:16:31.550
> 
> 标签：javascript, asp.net-mvc, xhtml, wysiwyg

想知道我可以在基于 ASP.NET MVC 框架的网站中嵌入的最好的 WYSIWYG 编辑器是什么？理想情况下，它应该符合 Xhtml 并允许用户嵌入图像等。

我以前使用过的唯一一个是[FCKEditor](http://www.fckeditor.net/)，它与 MVC 的工作情况如何 - 有没有人尝试过......？

我的主要要求是：

*   Xhtml 合规性
*   禁用 Javascript 时（尽其所能）弃用
*   修改工具栏选项
*   可剥皮（至少很容易改变外观和感觉）
*   易于使用的客户端 API
*   与 ASP.NET MVC 框架配合得很好

**编辑：**

正如[尼克](https://stackoverflow.com/questions/590960/whats-the-best-wysiwyg-editor-when-using-the-asp-net-mvc-framework/591025#591025)所说，[XStandard](http://www.xstandard.com/)编辑器很好，但需要一个插件......您对需要插件来实现网站功能有何看法？

谢谢，
基龙

**附加信息：**

正如[Hippo](https://stackoverflow.com/questions/590960/whats-the-best-wysiwyg-editor-when-using-the-asp-net-mvc-framework/591037#591037)回答的那样，TinyMCE 编辑是理想的——为了完整性，这里有下载页面：

[http://tinymce.moxiecode.com/download.php](http://tinymce.moxiecode.com/download.php)

也有 .NET、JSP、ColdFusion、PHP 和 jQuery 插件的下载。此外，还有可用的语言包。

已经用了一段时间了，我用过的最好的编辑器。谢谢大家！

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-02-26T15:33:43.100

我真的很喜欢[TinyMCE](http://tinymce.moxiecode.com/)，它也应该符合您的要求。它有据可查，并提供了很多配置的可能性。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-26T15:47:04.863

[CKEditor](http://ckeditor.com/)（FCKEditor 的下一个版本）处于测试阶段，但看起来它最终可能会相当不错。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-06T18:56:49.477

这是使用 FckEditor 和 MVC 框架的一个很好的链接

[将 FCK 编辑器与 ASP.NET MVC 一起使用](http://msmvps.com/blogs/superska/archive/2009/04/06/using-fck-editor-with-asp-net-mvc.aspx)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-12-24T21:44:23.557

看看 Aloha Editor [http://aloha-editor.org](http://aloha-editor.org)，它带有一个新概念：没有 iframe 和真正的所见即所得的完整前端编辑。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-29T08:15:24.037

在 JQuery 主页上搜索兼容 JQuery 的 WYSIWYG 编辑器列表。那里有很多：[JQuery插件](http://plugins.jquery.com/search/node/wysiwyg+type:project_project)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-08-28T10:55:57.957

我真的很喜欢 markItUp 的简单性和可扩展性[！](http://markitup.jaysalvat.com/home/)

它实际上不是所见即所得，但我们最近才从使用 TinyMCE 更改为 markItUp，我必须说它一直运行良好！

最重要的是，它**很**容易扩展。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-26T15:31:17.663

[XStandard](http://www.xstandard.com/)符合您的大部分要求，但它确实需要您的客户端安装浏览器插件。

# asp.net - ASP.NET 连接字符串

> ID：590967
> 
> 赞同：0
> 
> 时间：2009-02-26T15:17:35.433
> 
> 标签：asp.net, session, session-variables, connection-string

我的 ASP.NET 2.0 应用程序的连接字符串之一出现问题。在某些情况下，我会得到一个*ConnectionString Property Has not Being Initialized*问题，该问题随机、间歇性地发生，没有任何原因。

我的连接字符串实际上来自网络服务，因为不同类型的用户会根据他们的用户级别提供不同的连接字符串集。

到目前为止我所做的事情是这样的：

我有一个母版页 ( `mstr.page`) 和 ( ) 后面的相应代码`mstr.page.vb`。

在我的母版页中，我最初检索连接字符串并将其存储到会话变量中，即

```
Session("ConnString") = "RetrievedConnectionString" 
```

现在在我的一个页面中，让我们说`page1.aspx.vb`，我使用来自一个类（名为 ）的公共共享函数，`MyClass.vb`并在我的`page1.aspx.vb`.

一些代码供参考：

```
[MyClass.vb]
Imports System.Web

NameSpace ClassNameSpace
  Public Class Admin
    Protected Shared da as New DataAccess()

    Public Shared Function MYFunction() as String
      'Execute some sql statements here, using the DataAccess
      stringToReturn = Ctype(da.ExecuteScalar("SQLCommand"), String)
      Return stringToReturn
    End Function
  End Class
End NameSpace

[DataAccessClass.vb]
Public Class DataAccess()
  Private m_ConStr As String = ""

  Public Sub New()
    m_ConStr = HttpContext.Current.Session("ConnString")
  End Sub

  'Some methods for SQL statement execution (ExecuteQuery, ExecuteScalar)
End Class

[Page1.aspx.vb]
Imports ClassNameSpace

Protected Sub Page_Load(....) Handles Me.Load
  Dim strValue as String = Admin.MyFunction()
End Sub 
```

我已经将代码放在上面，以向您展示事情进展的一些粗略想法。

基本上，该函数`Admin.MyFunction()`有时会失败，因为在数据访问类中，连接字符串似乎已经失去了它的价值（空白或无）。

这已经困扰我很久了。

我希望有人能指出我正确的方向来解决这个问题。基本上，我希望每个访问 Web 应用程序的用户检索到的连接字符串始终保持不变并在任何地方使用。会话变量似乎不是最合适的，因为当 ASP.NET 回收其进程时，会话就会丢失。

顺便说一句，我最初是通过 Web 服务的母版页检索连接字符串。当条件是会话变量丢失时，我尝试在数据访问类中放置相同的检索函数，但我认为我的应用程序在回收过程中无法连接到 Web 服务。

对此的任何建议将不胜感激。

*对此进行更新：*

我尝试使用会话变量并将模式设置为状态服务器，但显然我正在使用的某些 DLL 无法序列化，因此我又回到了原点。

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T15:30:28.977

要检查的一件事是您的 Session 是否被破坏。如果您使用（默认）内存中会话，那么只要 ASP.NET 工作进程被回收，会话就会终止。如果这导致了您的问题，您可能需要考虑在 IIS 中使用 ASP.NET SessionServer 或 SQL Server 作为您的会话存储。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T16:21:37.417

我会尽量限制您对此类事情的 Session 使用。如果您使用 Web.Config 来存储您的连接字符串，您可以随时访问它，它不会像会话一样对您过期。

如果应用程序实例的所有用户都相同，您也可以考虑使用静态数据访问类...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T15:32:17.160

这是我遇到的完全相同的问题，结果是会话变量死亡，因此无法正确初始化连接字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T15:40:34.567

为什么您的应用程序不能只使用一个连接字符串？为什么连接字符串需要通过网络服务进入？这给整个过程增加了大量的延迟。我认为它可能与数据库中的数据安全性有关。

如果你*必须*这样做，我会说，你不能有一个后备/默认连接字符串吗？包装你的代码，试图用一些错误处理将它从会话中拉出来，如果它失败恢复到你的默认值？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T15:44:49.610

我会将您的网络服务和网络应用程序放在不同的应用程序池中。然后增加 Web 应用程序池的超时长度。

# perl - 如何将 /doc/ 添加到 Catalyst 中每个 URL 的末尾？

> ID：590972
> 
> 赞同：4
> 
> 时间：2009-02-26T15:18:34.667
> 
> 标签：perl, catalyst

我们试图让我们的 REST API 更友好一点，我们有一个 REST API 的基类，它继承自 Catalyst::Controller::REST。每个 REST 类都可以识别它接受的查询参数。我们认为将这些信息公开并将其放入基类中会很好：

```
sub doc : Regex('/doc$') {
    my ( $self, $c ) = @_;
    $c->stash->{params} = $c->forward('allowed_query_params');
} 
```

从那里开始，每个 REST url 都可以在末尾添加 /doc/ 以显示它接受哪些查询参数。

它不起作用。$self*始终*是 PIPs::C::API::V1::Franchise 实例，无论调用哪个 URL。这似乎是因为这些：

```
[26 Feb 2009 15:07:40,509] [Catalyst.Dispatcher] [DEBUG] Loaded Private actions:
.-----------------------+--------------------------------------+--------------.
| Private               | Class                                | Method       |
+-----------------------+--------------------------------------+--------------+
...
| /api/v1/franchise/doc | PIPs::C::Api::V1::Franchise          | doc          | 
```

和：

```
[26 Feb 2009 15:07:40,514] [Catalyst.DispatchType.Regex] [DEBUG] Loaded Regex actions:
.--------------------------------------+--------------------------------------.
| Regex                                | Private                              |
+--------------------------------------+--------------------------------------+
| /doc$                                | /api/v1/franchise/doc                |
| /doc$                                | /api/v1/version/doc                  |
| /doc$                                | /api/v1/creditrole/doc               |
| /doc$                                | /api/v1/doc                          |
| /doc$                                | /api/v1/segmentevent/doc             |
| /doc$                                | /api/v1/collection/doc               |
| /doc$                                | /api/v1/episode/doc                  | 
```

因此，“doc”方法的第一个实例通过 Franchise 调度，即使给定 URL 的控制器是 API::V1::Version 或类似的东西。

我该如何解决这个问题？LocalRegex 显然不起作用，并且链式操作似乎不合适，因为由于我们应用程序的性质，我们永远不知道“/api/v1/”和“/doc/”之间有多少路径部分。

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T22:06:19.320

我想你想要`LocalRegex`而不是`Regex`. 但是为什么要使用正则表达式，而不仅仅是简单的`Local`？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-23T16:31:54.913

看起来，这取决于你想让你的应用程序有多优雅。您可以尝试使用链式操作，将 doc 操作链接到您想要附加 '/doc' 的每个操作。AFAIK，催化剂不支持将一个动作链接到多个其他动作，但这可能已经改变。或者，他们不能都接受一个额外的论点吗？

或者，修改上面的代码：

```
sub auto : Private {
    my ($self, $c) = @_;
    if ((my $path = $c->req->path) =~ /\/doc$/) {
        $path =~ s/\/doc//;
        $c->detach($path);
    }
} 
```

不过，这确实可能是不好的做法……

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-11T00:03:38.710

您可以执行此根站点文件（如果站点名为 Hello，则在 lib 文件夹中的 Hello.pm）。您可以使用方法 prepare_path 并检查第一部分是否为 api/v1 以将 doc 部分附加到末尾。不确定在这个阶段这样做是否是不好的做法。

```
sub prepare_path {
   my $c = shift;

   $c->maybe::next::method( @_ ) ;

   # Get the path
   my $path = $c->request->path;

   if ((index($path, 'api/v1') > 0)) {
      $path .= '/doc';

      # Change the path
      $c->request->path( $path ) ;
   }
 } 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-26T22:13:43.810

我认为 Local 不起作用，因为控制器操作可能会接受多个参数，因此 Controller::Foo::my_action 可能最终会接受： /foo/my_action/this/1/that/2/the_other

因此，如果我没看错，您需要 /foo/my_action/this/1/that/2/the_other/doc、/bar/other_action/thing/4/thang/2/the_other/doc 等。

一种方法是在基本控制器中使用 sub auto : Private { } 来检查 $c->req->path 或 $c->req->args 的 doc 最后然后转发到相关的私人行动（如果存在）

```
sub auto : Private {
    my ($self, $c) = @_;
    $c->forward('doc_method) if $c->req->args->[ $@{$c->req->args}  eq 'doc';
} 
```

（未经测试）。此外，您可能想要 $c->detach 而不是转发，不确定。

# c# - 提供字符串字段时如何正确实现 IWebPartField.Schema

> ID：590973
> 
> 赞同：3
> 
> 时间：2009-02-26T15:18:43.183
> 
> 标签：c#, sharepoint

[MSDN 示例](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.webparts.iwebpartfield.aspx)展示了如何使用 DataTable 来查找 propertydescriptor。当我需要做的只是存储和转发一个短字符串值时，DataTable 就显得过大了。

一个例子看起来有点理智，它使用 TypeDescriptor.GetProperties(this)["afieldnameintheclass"]。这对我来说是正确的。

让我感到困惑的是，一个类似的示例在公共 IWebPartField GetWPConnectFieldProvider() 函数上使用了一个属性 [ConnectionProvider("Web part Connection Provider")]，并且似乎在他的 GetProperties 调用 (TypeDescriptor.GetProperties(this )["Web 部件连接提供程序"])。

这个看似理智的例子是否正确？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T15:50:15.323

是的，我已经对代码视而不见了。

如果您要提供给消费者 Web 部件的值存储在该字段中：

```
string afieldnameintheclass; 
```

您将使用以下架构属性。

```
public PropertyDescriptor Schema {
{
  get
  {
    return TypeDescriptor.GetProperties(this)["afieldnameintheclass"];
  }
} 
```

# asp.net - asp.net - sqldatasource - detailsview - 使用存储过程插入记录

> ID：590974
> 
> 赞同：1
> 
> 时间：2009-02-26T15:18:52.980
> 
> 标签：asp.net, detailsview, sqldatasource

我正在尝试使用存储过程来使用 detailsview 和 sqldatasource 插入记录。我收到以下错误：

过程或函数“CustRec_iu”需要未提供的参数“@firstname”。

我的 detailsview 定义如下：

```
<asp:DetailsView ID="dvCustDetails1" runat="server" AutoGenerateRows="False" 
    DataSourceID="SqlDataSource1" Height="149px" Width="469px">
            <Fields>
                <asp:BoundField DataField="FirstName" HeaderText="First Name" 
                    SortExpression="FirstName" />
                <asp:BoundField DataField="LastName" HeaderText="Last Name" 
                    SortExpression="LastName" />
                <asp:CommandField ButtonType="Button" ShowInsertButton="True" />
            </Fields>
</asp:DetailsView> 
```

在后面的代码中，PageLoad 如下所示：

```
 SqlDataSource1.ConnectionString = Connection.ConnectionStr;

    //SqlDataSource1.InsertCommand = "INSERT INTO [customer] (firstname,lastname,active) values(@firstname,@lastname,@active)";
    SqlDataSource1.SelectCommand = "select firstname,lastname from customer";

    //SqlDataSource1.SelectCommand = "CustRec";
    SqlDataSource1.InsertCommand = "CustRec_iu";

    SqlDataSource1.InsertParameters.Clear();

    SqlDataSource1.InsertParameters.Add(new Parameter("firstname", DbType.String));
    SqlDataSource1.InsertParameters.Add(new Parameter("LastName", DbType.String));
    SqlDataSource1.InsertParameters.Add(new Parameter("Active",DbType.Int16,"1")); 
```

请注意，如果我使用注释掉的内联语句，则插入有效。

我的存储过程如下所示：

```
ALTER PROCEDURE dbo.CustRec_iu
    (
    @custid int = null,
    @firstname varchar(100),
    @lastname varchar(100),
    @Active bit = 1 
    )

AS
    if (isnull(@custid,0) = 0)
    begin
        insert into customer
            (firstname,lastname,Active) 
        values
            (@firstname,@lastname,@Active)
    end
    else
    begin
        update customer 
        set 
            firstname=@firstname, 
            lastname= @lastname, 
            active = @Active
        where 
            custid = @custid
    end
    /* SET NOCOUNT ON */
    RETURN 
```

我不明白输入参数如何在 sqldatasource、detailsview 等之间进行交互。它如何与 insline 语句一起使用而不与存储过程一起使用？sql datasource 和 detailsview 在事件方面是如何工作的？谷歌搜索和打印书籍 Professional asp.net 3.5 in c# and VB 帮助不大。

提前感谢您阅读我的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T15:41:52.600

我想你可能会失踪``SqlDataSource1.InsertCommandType = CommandType.StoredProcedure``

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T15:34:47.390

快速查看后，似乎没有为插入参数分配默认值。尝试参数类构造函数...

```
New Parameter(name, dbType, defaultValue) 
```

此外，您可能不需要在后面的代码中执行 sqldatasource。您可以尝试以下方法。

```
<asp:DetailsView DataSourceID="SqlDataSource1" Height="149px" Width="469px">
   <Fields>
      <asp:BoundField DataField="FirstName" HeaderText="First Name" SortExpression="FirstName" />
      <asp:BoundField DataField="LastName" HeaderText="Last Name" SortExpression="LastName" />
      <asp:CommandField ButtonType="Button" ShowInsertButton="True" />
   </Fields>
</asp:DetailsView>
<asp:SqlDataSource ID="SqlDataSource1" runat="server" ConnectionString="<%$ ConnectionStrings:YourConnectionString %>"
   InsertCommand="CustRec_iu"
   InsertCommandType="StoredProcedure" 
   SelectCommand="select firstname,lastname from customer" 
   SelectCommandType="Text">
        <InsertParameters>
            <asp:Parameter Name="firstname" Type="String" />
            <asp:Parameter Name="LastName" Type="String" />
            <asp:Parameter Name="Active" Type="String" DefaultValue="1" />
        </InsertParameters>
</asp:SqlDataSource> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T18:33:03.187

内联语句的工作方式与 sproc 类似，不同之处在于您使用嵌入在字符串中的 @param 语句来创建字符串。

你应该只需要在你的存储过程中拉入你的更新和插入语句。然后，您必须创建参数链接。

如果您想进行这种拖放操作，请将更新语句插入到向导中。最坏的情况是添加参数映射。因此，拖放在这里并没有真正提供太多。

# jquery - 使用 jQuery 在输入时禁用其他文本框

> ID：590976
> 
> 赞同：2
> 
> 时间：2009-02-26T15:18:56.773
> 
> 标签：jquery

我有一个包含多个搜索（文本）字段的表单。在其中一个字段中输入文本时，我想禁用其他字段。相反，如果从活动文本字段中删除所有文本，则应重新启用其他字段。

基本的想法是这样的（我认为）：

```
$(document).ready(function() {
    $("input[@type=text]").keypress(function(e) {
        if(current textbox has text in it)
        {
            //disable all textboxes that aren't this one
        }
        else
        {
            //enable all textboxes
        }
    });
}); 
```

我不清楚查找/使用“所有不是这个的文本框”的最简单方法是什么。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-26T15:22:36.950

我认为执行“所有不是这个的所有文本框”的最佳方法是使用`not`过滤器，例如：

```
$(document).ready(function() {
    $(":text").keyup(function(e) {
        if($(this).val() != '') {
            $(":text").not(this).attr('disabled','disabled');
        } else {
            $(":text").removeAttr('disabled');
        }
    });
}); 
```

### 情侣笔记：

*   我建议为您希望包含在此行为中的所有输入元素提供一个类，并使用 input.myfields 选择器，因为它更快/更干净。
*   此外，从 jQuery 1.3 开始，`@`不支持选择器中的 。`:text`是您想要的东西的简写，如果您坚持以这种方式选择它们。
*   我也认为你想要`keyup`事件而不是`keypress`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T15:23:29.147

我会先禁用它们，然后由于要执行的代码是由控件的事件触发的，因此您可以使用 this 关键字来引用具有焦点的控件并重新启用它。

```
$("input[@type=text]").attr("disabled", true);
$(this).attr("disabled", false); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T15:24:28.897

我会将登录信息附加到焦点/模糊事件中：

```
$(function() {
    $(':text').focus(function() {
        $(':text').not(this).attr('disabled','disabled');
    }).blur(function {
        if (this.value.length == 0) {
            $(':text').removeAttr('disabled');
        }
    });
}) 
```

@attr 选择器在 1.2 中已弃用，并已从 1.3 中完全删除。在这种情况下，您需要使用 :text

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T15:22:01.273

使用[非](http://docs.jquery.com/Selectors/not#selector)选择器

# javascript - 为什么创建后无法连接到我的 COM 对象事件？

> ID：590978
> 
> 赞同：0
> 
> 时间：2009-02-26T15:19:06.287
> 
> 标签：javascript, com, events, wsh

我使用 C++ 编写了一个 COM 对象。

如果我同时执行它们（Javascript），则创建对象并连接到它的事件可以正常工作：

```
var obj = WScript.CreateObject("SomeCOMClass.Object", "event_"); 
```

但是，以下会生成此错误（msdn）：http: [//msdn.microsoft.com/en-us/library/a7tya2wc](http://msdn.microsoft.com/en-us/library/a7tya2wc(VS.85).aspx) (VS.85).aspx 。

```
var obj = WScript.CreateObject("SomeCOMClass.Object");
WScript.ConnectObject(obj, "event_"); 
```

错误描述页面没有描述为什么我无法连接到已创建的对象。我希望能够连接到创建的对象，因为我计划从各种 C++ COM 函数返回对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-17T18:36:27.010

我刚刚发现 Eric Lippert 的一篇旧博客文章描述了这一点：http: [//blogs.msdn.com/ericlippert/archive/2005/02/15/373330.aspx](http://blogs.msdn.com/ericlippert/archive/2005/02/15/373330.aspx)

本质上，他说你需要你的对象来实现`IProvideClassInfo`，或者`IProvideMultipleClassInfo`为了让 WScript 收集关于传出（回调）接口的类型信息，所以它可以设置一个匹配的处理程序。

# c# - 合并两个 IEnumerable s

> ID：590991
> 
> 赞同：44
> 
> 时间：2009-02-26T15:21:30.387
> 
> 标签：c#, merge

我有两个`IEnumerable<T>`s。

一个充满了后备元素。这将始终包含最多的元素。另一个将根据某些参数被填充，并且可能包含更少的元素。如果第二个元素中不存在一个元素，我需要用第一个元素的等效元素填充它。

这段代码完成了这项工作，但对我来说效率低下，需要我将 IEnumerables 强制转换为 ILists 或使用临时列表 Person 实现 IEquatable

```
IEnumerable<Person> fallBack = Repository.GetPersons();
IList<Person> translated = Repository.GetPersons(language).ToList();

foreach (Person person in fallBack)
{
    if (!translated.Any(p=>p.equals(person)))
        translated.add(person);  
} 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-02-26T15:23:56.917

```
translated.Union(fallback) 
```

或（如果 Person 不`IEquatable<Person>`按 ID 实现）

```
translated.Union(fallback, PersonComparer.Instance) 
```

其中 PersonComparer 是：

```
public class PersonComparer : IEqualityComparer<Person>
{
    public static readonly PersonComparer Instance = new PersonComparer();

    // We don't need any more instances
    private PersonComparer() {}

    public int GetHashCode(Person p)
    {
        return p.id;
    }

    public bool Equals(Person p1, Person p2)
    {
        if (Object.ReferenceEquals(p1, p2))
        {
            return true;
        }
        if (Object.ReferenceEquals(p1, null) ||
            Object.ReferenceEquals(p2, null))
        {
            return false;
        }
        return p1.id == p2.id;
    }
} 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-02-26T15:25:10.937

试试这个。

```
public static IEnumerable<Person> SmartCombine(IEnumerable<Person> fallback, IEnumerable<Person> translated) {
  return translated.Concat(fallback.Where(p => !translated.Any(x => x.id.equals(p.id)));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-01T04:00:05.433

使用`Concat`. 在案例类型`Union`中不起作用`List<dynamic>`***