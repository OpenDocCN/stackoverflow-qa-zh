# StackOverflow 问答 000270000-000270999

# sql-server - Sql Server Management - 避免编写排序规则脚本的选项？

> ID：270003
> 
> 赞同：0
> 
> 时间：2008-11-06T19:45:52.107
> 
> 标签：sql-server, scripting, collation

我有不同排序规则的数据库。我希望能够从一个数据库中编写表格并在另一个数据库中创建它们。但是，当我编写表格脚本时，它会在列定义中包含排序规则。

有没有办法从生成的表创建脚本中排除排序规则？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T19:51:36.043

工具 -> 选项

在脚本下（在表/视图部分）

将包含排序规则设置为 False！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T20:49:39.513

相当蹩脚 - 但在脚本生成后对其进行搜索和替换？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T02:43:24.573

您使用的是哪个版本的 SSMS？完整版还是特快版？

您需要至少为 2005 年应用 SP2 才能在 Tools->Options 下获得脚本设置。

这不需要应用于数据库服务器，如果需要，它可以仅应用于管理工作站上的客户端工具。

# visual-studio - 在 Visual Studio SQL 编辑器中，我如何摆脱这些框？

> ID：270005
> 
> 赞同：2
> 
> 时间：2008-11-06T19:46:21.933
> 
> 标签：visual-studio, sql-scripts

我通常通过在 Visual Studio 中编写脚本来创建我的 SQL 表和存储过程。这对我来说非常有效，除了一个简单的烦恼：VS 在所有 SQL 查询和数据操作命令周围放置了蓝色框。这些框的目的是让人们过分注意 VS 认为可以在“查询生成器”中编辑查询这一事实。</p>

我不想使用查询生成器。我只想要一个漂亮、干净的脚本，它反映了我对数据库引擎应该做什么的奇妙愿景。爆炸吧，吉姆，我是程序员而不是 Microsoft Access 爱好者！

然而，我确实喜欢 VS 提供的语法高亮和源代码控制集成。

所以我的问题是：如何关闭烦人的蓝框？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-07-16T18:06:09.190

打开 Visual Studio 工具 --> 选项 --> 数据库工具 --> 常规。取消选中“启用 DML 标记”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T19:51:21.270

将 SQL 查询轮廓的颜色设置为与背景相同的颜色。

# c# - SetSecurityDescriptorSddlForm（字符串 sddlForm）

> ID：270010
> 
> 赞同：1
> 
> 时间：2008-11-06T19:49:44.453
> 
> 标签：c#, security, dacl

根据这个 API，我没有找到任何有用的网站。

字符串的格式是什么？内容？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T20:01:10.937

[此处](http://msdn.microsoft.com/en-us/library/aa379570(VS.85).aspx)定义了安全描述符字符串格式

# javascript - 谁能解释为什么这个 JavaScript 会导致 IE7 中的内存泄漏？

> ID：270011
> 
> 赞同：2
> 
> 时间：2008-11-06T19:50:09.697
> 
> 标签：javascript, internet-explorer, memory-leaks, dom-events

代码相当长但很简单：

*   创建了 100 个泄漏的 JavaScript 对象。
*   从 JS 对象创建了 10 个泄漏元素。
*   删除 1 个元素，添加 1 个元素 10000 次。

我假设`detachEvent`呼叫无法正常运行。此外，如果您`this.eventParams`从数组更改为简单变量，泄漏就会消失。为什么？

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Memory Leak With Fix</title>
    <style type="text/css">
      .leakyEle 
      {
        border: solid 1px red;
        background-color: Gray;
      }
    </style>
    <script type="text/javascript">

/******************************* MAIN ********************************/
var leakObjArray = new Array();
AddEvent(window, 'load', Startup, false);

function Startup() {           
  for(var i=0; i<100; i++) {
    leakObjArray.push(new LeakyObj(i));
  }

  for(var j=0; j<10; j++) {
    leakObjArray[j].CreateLeakyEle();
  }     
  var container = document.getElementById('Container');
  AddEvent(container, 'click', Run, false);
  alert('Close this dialog and click the document to continue.');
}

function Run() {
  var k = 0;
  var l = 10;

  for(var m = 0; m<10000; m++) {
    leakObjArray[k].DestroyLeakyEle();
    leakObjArray[l].CreateLeakyEle();
    if(k<leakObjArray.length - 1) {
      k++;
    } else {
      k = 0;
    }
    if(l<leakObjArray.length - 1) {
      l++;
    } else {
      l = 0;
    }
  }   
  for(var i=0; i<leakObjArray.length; i++) {
    leakObjArray[i].DestroyLeakyEle();
  }
  alert('Test Complete.');
}

/******************************* END MAIN ********************************/

/******************************* LEAKY OBJECT ********************************/
function LeakyObj(id) {
  this.id = id;
  this.leakyEle = null;
  this.containerEle = document.getElementById('Container');
  this.clicked = false;
  this.eventParams = new Array();
}

LeakyObj.prototype.CreateLeakyEle = function() {
  var leakyEle = document.createElement('div');
  leakyEle.id = 'leakyEle' + this.id;  
  leakyEle.className = 'leakyEle';           
  leakyEle.innerHTML = this.id + ' --- XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' +
    '<br/>XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' +
    '<br/>XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' +
    '<br/>XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' +
    '<br/>XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX';

  this.leakyEle = leakyEle;

  var _self = this;
  this.eventParams.push(AddEventWithReturnParams(this.leakyEle, 'click', function() { _self.EventHandler(); }, false));

  this.containerEle.appendChild(leakyEle);
}

LeakyObj.prototype.DestroyLeakyEle = function() {
  if(this.leakyEle != null) {
    this.containerEle.removeChild(this.leakyEle);
    for(var i=0; i<this.eventParams.length; i++) {      
      RemoveEventOverload(this.eventParams[i]);
    }
    this.leakyEle = null;
  }
}

LeakyObj.prototype.EventHandler = function() {
  this.leakyEle.style.display = 'none';
  this.clicked = true;
}

/******************************* END LEAKY OBJECT ********************************/

/******************************* GENERAL FUNCS ********************************/

function AddEvent(elm, evType, fn, useCapture){
  var success = false;
  if(elm.addEventListener) {
    if(evType == 'mousewheel') evType = 'DOMMouseScroll';
    elm.addEventListener(evType, fn, useCapture);    
    success = true;
  } else if(elm.attachEvent) {
    if(evType == 'mousewheel') {
      window.onmousewheel = document.onmousewheel = fn;
      success = true;
    } else {
      var r = elm.attachEvent('on' + evType, fn);
      success = r;
    }
  } else {
    success = false;
  }
  elm = null;
  return success;
}

function AddEventWithReturnParams(elm, evType, fn, useCapture) {
  var eventParams = new EventParams(elm, evType, fn, useCapture);
  AddEvent(elm, evType, fn, useCapture);
  return eventParams;
}

function RemoveEvent(elm, evType, fn, useCapture) {
  if(elm) {  
  if(elm.removeEventListener) {
    elm.removeEventListener(evType, fn, useCapture);    
    return true;
  } else if(elm.detachEvent) {  
    var r = elm.detachEvent('on' + evType, fn);    
    return r;
  } else {
    debugger;
  }  
  }
}

function RemoveEventOverload(eventParams) {
  if(eventParams) {
    return RemoveEvent(eventParams.element, eventParams.eventType, eventParams.handler, eventParams.capture);
  }
}

function EventParams(elm, evType, fn, useCapture) {
  return {
    element: elm,
    eventType: evType,
    handler: fn,
    capture: useCapture
  }
}
/******************************* END GENERAL FUNCS ********************************/
    </script>
</head>
<body>
<div id="Container"></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T20:15:37.303

如果您查看您的代码，您应该注意到在存储在 eventParams 数组中的每个 eventParams 对象中，您都有对这些对象的引用，但您永远不会清空您的数组。尝试清除您的阵列...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T20:14:54.263

看起来您正在将内容推送到 CreateLeakyEle 中的 eventParams 数组，但从未删除它？是对的吗？

# c - 16 位微控制器上的 C 培训

> ID：270012
> 
> 赞同：0
> 
> 时间：2008-11-06T19:50:09.757
> 
> 标签：c, assembly, embedded, microcontroller

我的公司正在从汇编编码的微控制器过渡到 C。我们正在考虑 Microchip、Atmel、Renasas 等。人。用于使用 C 代码的未来项目。是否有很好的培训资源可以让我们的工程师跟上 C 的速度？研讨会，讲师，课程等。工程师的经验水平从没有培训到有些知识不等。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-06T20:12:07.187

欢迎来到 80 年代。:) 从经典的 K&R C 书或我最喜欢的 C：Harbinson & Steel 的参考手册开始，如果你能找到的话。我使用 PIC，并且有几本关于 PIC 编程的有用书籍。我已经通过使用 PC 熟悉了 C，但我发现它们在这方面没有用。

C 允许您接近汇编程序，并且大多数编译器都可以将其包含在内，因此它与任何高级语言一样接近汇编程序。我想你应该很快就开心起来，很快就到家了。

如果您有兴趣向前发展几十年；>）您可能需要考虑使用 Microchip C 编译器。我很快就会对此进行研究，并且有一本关于[C/C++ 中实用状态图的](https://rads.stackoverflow.com/amzn/click/com/1578201101)好书。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-07T03:51:26.120

好消息是，如果您的工程师有汇编背景，那么一些“C”语言概念，例如指针和数组，将不难掌握（希望掌握。）

关于您关于嵌入式 C 培训的具体问题，**[Netrino](http://www.netrino.com)**提供了一系列关于嵌入式培训的课程，包括用 C 和 C++ 编写嵌入式代码。

此外，嵌入式系统会议（几周前刚刚在波士顿举行过一次，我想下一次是明年春天在硅谷举行的会议）总是充满关于嵌入式开发和不同语言的课程。但是您可能没有等待 6 个月的奢侈。

如果您的员工更多是“书本学习者”类型，那么这些书可能会引起您的兴趣：

*   **[嵌入式 C 编程和 Atmel AVR](https://rads.stackoverflow.com/amzn/click/com/1418039594)**

*   **[嵌入式 C 编程和 Microchip PIC](https://rads.stackoverflow.com/amzn/click/com/1401837484)**

*   **[嵌入式系统编程：使用 C 和 GNU 开发工具](https://rads.stackoverflow.com/amzn/click/com/0596009836)**

*   **[嵌入式 C](https://rads.stackoverflow.com/amzn/click/com/020179523X)**

这应该给你足够的时间咀嚼。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-08T02:05:02.203

当然，你应该检查[http://arduino.cc](http://arduino.cc)：

[http://arduino.cc/en/Tutorial/HomePage](http://arduino.cc/en/Tutorial/HomePage)

高温高压

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-15T19:04:02.687

为什么要提到 16 位？

如果是因为你认为 8 位是如此 20 世纪，那你是对的。但 16 位也是如此。今天的 32 位控制器（尤其是 ARM）比 16 位控制器更强大，而且通常更便宜。更便宜，因为一些 16 位芯片使用过时的工艺，具有较大的特征尺寸和较大的芯片。

实际上，我认为一些 8 位控制器的使用寿命会比 16 位控制器更长。与 16 位或 32 位控制器相比，前者的优势可能在于尺寸。您无法将 ARM 控制器放入 2.9x1.3 mm SOT23 封装中。此外，较小的 8 位控制器仍然比最小的 ARM 便宜。

对我来说，使用 16 位控制器的唯一原因是安装代码，但既然你提到了一些你正在“考虑”的品牌，我想你现在没有使用它们。

我会看看ARM。ARM7TDMI 是稳定的，可从多家供应商处获得多种配置。我可以推荐 NXP LPC2000。起价约为 1.50 美元，对于 32 位控制器来说还不错。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T22:12:21.977

> 是否有很好的培训资源可以让我们的工程师跟上 C 的速度？

对于初学者， Bruce Eckel 的[“Thinking in C”多媒体课程](http://mindview.net/CDs/ThinkingInC/beta3)***免费***提供了对 C 系列编程语言的非常好的和非常完整的介绍 （下载大小约为 100 兆，课程本身是闪存） .

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-06T20:45:30.910

首先，我建议使用 Microchip 的 MPLAB 和 C 编译器的“学生”版本。

C 编译器在到期后运行时不进行优化。

MPLAB 有一个内置的模拟器来运行这些程序。您可以旋转输出引脚以查看事物的移动。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-08T10:28:59.200

For 16-bit Microchip pics, there is

[http://www.amazon.com/Programming-16-Bit-PIC-Microcontrollers-Technology/dp/0750682922](https://rads.stackoverflow.com/amzn/click/com/0750682922)

IIRC it was decent, but they focus pretty heavily on doing one thing per chip. Our apps multiplex a lot of I/O, and for that the examples/casestudies in the book (that assumed exclusive use) were hard to bring to practice.

When I started with this architecture, having a readily made example board (from Microchip, $50-$100 range) really helped, specially if you target roughly the same variant as the example board.

This because it offered an easy check if a problem was hardware or software related by running it on the example board.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-08T01:59:26.613

msp430 是 C 语言中最好的微控制器之一。但你最好的选择就是选择 ARM，它们很快就会消除剩余的竞争。Microchip 已经抓住了一个 32 位内核来竞争，但我认为他们最终会成为失败者。随着 32 位 ARM 满足并击败了疲倦的 8 位微控制器（如 PIC 和 8051 和 z80）的价格，除了 msp，您应该避免停在 32 位内核以下的任何东西上。

它不是最好的也不是最高效的编译器，但价格合适，没有其他编译器像 gcc 那样支持。为许多平台构建或下载预构建的 gcc 相对容易。我会避免陷入任何需要制造商 IDE 和工具的事情。这些工具很好，在某些情况下需要开始使用微型工具，但从长远来看，您可能想要探索替代方案的优缺点。

至于学习 C，如果你知道汇编比任何其他语言包括汇编只是语法。我相信你需要的一切都可以通过谷歌在线找到。一旦你选择了一个评估板和一个微型（Stellaris 有一些好东西），首先研究他们的示例程序，然后使用谷歌查找其他示例程序并从那里开始。特别是对于微控制器，但总的来说，您希望避免任何语言的绝妙功能，坚持使用简单、基本的东西，在任何编程语言中都是相同的东西。您遇到的编译器，尤其是专门为微型计算机构建的编译器，不会处理像 gcc、microsoft 或 borland 这样的极端情况。这也将使您的代码更易于移植到其他 micros 或其他语言（不过，我会避免使用 asm 和 C 之上的任何内容，尤其是微型）。如果您必须拥有一本书，请购买 K&R 或任何正在使用的替代品。请注意，直接出自第一版的 K&R C 不会真正在任何地方编译。但它保持基础，让你远离语言的问题领域。

Linux 设备驱动程序非常高级（几乎在应用程序级别，大部分代码与“金属”无关）。你不会在微型计算机上运行 linux，即使是 arm 微型计算机，学习 linux 设备驱动程序对于其他目标来说是一个很好的练习，但对于这个目标不是。你想不惜一切代价避开操作系统，特别是linux和windows，你想学习非操作系统的C编程。查看 WINARM 示例。（这包括 RTOS）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-11T22:33:40.297

有专门为嵌入式系统教授 C 语言的公司，例如英国的 Feabhas 或[美国的](http://www.feabhas.com/)[Netrino](http://www.netrino.com/)。浏览一下网络。

除了其他帖子中提到的处理器，ST 的 STM32 系列也非常值得一看。它们是 32 位的，极具成本效益，并且有多种封装。

ST 似乎正在努力让人们快速使用他们的产品，并推出了[STM32 Circle](http://www.stm32circle.com/hom/index.php)等开发硬件。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-11-07T03:58:14.373

有很多关于学习 C 编程的书籍，尤其是对于您提到的架构。通过搜索“微控制器”查看亚马逊。

此外，Microchip 为其特定的编译器和芯片举办了很多研讨会/课程——它们通常价格低廉，并且在美国各地有几个培训中心。由于许多工程师需要接受培训，您可以考虑直接联系 Microchip 并了解进行内部培训的费用。

-亚当

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-11-06T19:53:37.707

首先想到的是编写 Linux 设备驱动程序的文档。这与您感兴趣的内容松散相关，但是O'Reilly的[这本关于驱动程序编程的书涵盖了 16 位设备的编码。](http://www.xml.com/ldd/chapter/book/ch10.html)一般来说，至少应该有一些有用的编码风格约定。

# c# - 在构造函数中进行冗长的操作是否被认为是糟糕的设计？

> ID：270029
> 
> 赞同：8
> 
> 时间：2008-11-06T19:54:04.710
> 
> 标签：c#, constructor, class-design

我正在实现一个类来比较目录树（在 C# 中）。起初我在类的构造函数中实现了实际的比较。像这样：

```
DirectoryComparer c = new DirectoryComparer("C:\\Dir1", "C:\\Dir2"); 
```

但是在构造函数中做一个可能冗长的操作感觉不“正确”。另一种方法是将构造函数设为私有并添加如下静态方法：

```
DirectoryComparer c = DirectoryComparer.Compare("C:\\Dir1", "C:\\Dir2"); 
```

你怎么看？您希望构造函数“快速”吗？第二个例子更好还是只是使类的使用复杂化？

**顺便提一句：**

我不会将任何答案标记为已接受，因为我认为没有正确答案，只有偏好和品味。

**编辑：**

只是为了澄清我的例子。我不仅对目录是否不同感兴趣，而且对它们的不同之处（哪些文件）感兴趣。所以一个简单的 int 返回值是不够的。cdragon76.myopenid.com 的答案实际上非常接近我想要的（+1 给你）。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-06T20:01:09.063

我认为两者的组合是“正确”的选择，因为我希望 Compare 方法返回比较结果，而不是比较器本身。

```
DirectoryComparer c = new DirectoryComparer();

int equality = c.Compare("C:\\Dir1", "C:\\Dir2"); 
```

...正如 Dana 提到的，.Net 中有一个[IComparer](http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx)接口反映了这种模式。

[IComparer.Compare](http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx)方法返回一个 int ，因为 IComparer 类的使用主要用于排序。一般模式虽然适合问题的问题：

1.  构造函数使用（可选）“配置”参数初始化实例
2.  比较方法接受两个“数据”参数，比较它们并返回一个“结果”

现在，结果可以是一个 int、一个 bool、一个 diff 集合。什么都适合需要。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-06T19:56:12.523

我更喜欢第二个。

我希望构造函数实例化该类。compare 方法完成了它的设计目的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-06T19:58:18.680

我认为界面可能是您所追求的。我会创建一个类来表示一个目录，并让它实现 DirectoryComparer 接口。该接口将包括 compare 方法。如果 C# 已经有一个 Comparable 接口，你也可以实现它。

在代码中，您的调用将是：

```
D1 = new Directory("C:\");
..
D1.compare(D2); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-06T19:56:14.363

你永远不应该做任何可能在构造函数中失败的事情。您不想创建无效对象。虽然您可以实现对象不做太多事情的“僵尸”状态，但最好在单独的方法中执行任何复杂的逻辑。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-06T20:57:22.510

我同意不要在构造函数中进行冗长操作的普遍观点。

此外，在设计主题时，我会考虑更改您的第二个示例，以便该`DirectoryComparer.Compare`方法返回对象以外的其他内容`DirectoryComparer`。（也许是一个名为`DirectoryDifferences`or的新类`DirectoryComparisonResult`。）类型的对象`DirectoryComparer`听起来像是用于比较目录的对象，而不是表示一对目录之间差异的对象。

然后，如果您想定义比较目录的不同方式（例如忽略时间戳、只读属性、空目录等），您可以将这些参数传递给`DirectoryComparer`类构造函数。或者，如果您总是希望`DirectoryComparer`使用完全相同的规则来比较目录，您可以简单地创建`DirectoryComparer`一个静态类。

例如：

```
DirectoryComparer comparer = new DirectoryComparer(
    DirectoryComparerOptions.IgnoreDirectoryAttributes
);
DirectoryComparerResult result = comparer.Compare("C:\\Dir1", "C:\\Dir2"); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-06T19:56:18.280

是的，通常构造函数是快速的，它旨在准备对象以供使用，而不是实际执行操作。我喜欢您的第二个选项，因为它保持单线操作。

您还可以通过允许构造函数传递两个路径来使其更容易一些，然后使用一个实际执行处理的 Compare() 方法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-06T20:01:06.133

我喜欢第二个例子，因为它解释了实例化对象时到底发生了什么。另外，我总是使用构造函数来初始化类的所有全局设置。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-06T20:04:08.233

我认为对于通用比较器，您可能在构建时只想指定要比较的文件，然后再进行比较-这样您还可以实现扩展逻辑：

*   再比较一下——如果目录改变了怎么办？
*   通过更新成员来更改您正在比较的文件。

此外，您可能希望在您的实现中考虑在目标目录中的文件已更改时从您的操作系统接收消息 - 并且可以选择再次重新比较。

关键是-您通过假设此类仅用于对这些文件的单个实例进行一次比较来施加限制。

因此，我更喜欢：

`DirectoryComparer = new DirectoryComparer(&Dir1,&Dir2);`

 `DirectoryComparer->Compare();`  `或者

`DirectoryComparer = new DirectoryComparer();`

 `DirectoryComparer->Compare(&Dir1,&Dir2);`  `* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-07T14:30:51.900

我认为构造函数不仅可以根据需要花费尽可能多的时间来构造有效对象，而且构造函数也必须这样做。推迟对象创建是非常糟糕的，因为您最终会得到可能无效的对象。因此，您必须每次在触摸对象之前检查它（这就是在 MFC 中完成的方式，您`bool IsValid()`到处都有方法）。

**我只看到创建对象的两种方式略有不同。无论如何，人们都可以将 new 运算符视为类的静态函数。所以，这一切都归结为语法糖。**

`DirectoryComparer`班级做什么？它的责任是什么？从我的角度来看（这是 C++ 程序员的观点），看起来你最好只使用一个自由函数，但我认为你不能在 C# 中拥有自由函数，对吗？我猜你会收集`DirectoryComparer`对象中不同的文件。如果是这样，您可以更好地创建文件数组或相应命名的等效类之类的东西。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-06T20:28:18.340

如果您正在使用 C#，您可以使用扩展方法创建一个方法来比较您将附加到 DirectoryClass 中的构建的 2 个目录，因此它看起来像：

```
Directory dir1 = new Directory("C:\.....");
Directory dir2 = new Directory("D:\.....");

DirectoryCompare c = dir1.CompareTo(dir2); 
```

这将是更清晰的实现。[更多关于这里](http://www.developer.com/net/csharp/article.php/3592216)的扩展方法。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-06T20:34:20.840

如果一个操作可能需要未知的时间，那么您可能希望将它导出到不同的线程中（这样您的主线程就不会阻塞并且可以做其他事情，例如显示一个旋转的进度指示器）。其他应用程序可能不想这样做，他们可能希望在单个线程中完成所有操作（例如，那些没有 UI 的应用程序）。恕我直言，将对象创建移动到单独的线程有点尴尬。我宁愿在我当前的线程中（快速）创建对象，然后让它的一个方法在另一个线程中运行，一旦方法完成运行，另一个线程可能会死掉，我可以在我的当前线程通过在转储对象之前使用对象的另一种方法，因为我'

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-06T21:02:59.830

如果参数只被处理一次，那么我认为它们不属于构造函数参数或实例状态。

但是，如果比较服务将支持某种可暂停算法，或者您想在两个目录的相等状态基于文件系统事件或类似事件发生变化时通知侦听器。然后目录是实例状态的一部分。

在这两种情况下，除了初始化实例之外，构造函数都不会做任何工作。在上述两种情况下，算法要么由客户端驱动，就像迭代器一样，要么由事件监听线程驱动。

我通常会尝试做这样的事情：如果可以将状态作为参数传递给服务方法，则不要在实例中保持状态。尝试设计具有不可变状态的对象。定义属性，例如在 equals 和 hashcode 中使用的属性应该始终是不可变的。

从概念上讲，构造函数是将对象表示映射到它所表示的对象的函数。

根据上面的定义，Integer.valueOf(1) 实际上比 new Integer(1) 更像是一个构造函数，因为 Integer.valueOf(1) == Integer.valueOf(1)。, 在任何一种情况下，这个概念也意味着所有的 cosntructor 参数，只有构造函数参数，应该定义对象的 equals 行为。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-07T14:00:55.363

我肯定会做第二个。

如果构造函数中的长操作实际上是在构建对象，那么它是可用的。

现在我看到人们在构造函数中做的一件事是调用虚方法。这很糟糕，因为一旦有人将您用作基类并覆盖其中一个函数，一旦您进入构造函数，您将调用基类的版本而不是派生类。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-11-07T14:19:04.937

我认为谈论“冗长”之类的抽象术语与是否将某些内容放入构造函数中的决定没有任何关系。

构造函数是应该用来初始化一个对象的东西，一个方法应该用来“做某事”，即有一个函数。

# performance - 注释会影响 Perl 的性能吗？

> ID：270042
> 
> 赞同：8
> 
> 时间：2008-11-06T19:59:39.503
> 
> 标签：performance, perl, comments

我正在优化一些经常运行的 Perl 代码（每个文件每天一次）。

注释会减慢 Perl 脚本的速度吗？我的实验倾向于否：

```
use Benchmark;
timethese(20000000, {
    'comments' => '$b=1;
# comment  ... (100 times)
', 'nocomments' => '$b=1;'}); 
```

给出几乎相同的值（除了噪声）。

```
Benchmark: timing 10000000 iterations of comments, nocomments...
  comments:  1 wallclock secs ( 0.53 usr +  0.00 sys =  0.53 CPU) @ 18832391.71/s (n=10000000)
nocomments:  0 wallclock secs ( 0.44 usr +  0.00 sys =  0.44 CPU) @ 22935779.82/s (n=10000000)

Benchmark: timing 20000000 iterations of comments, nocomments...
  comments:  0 wallclock secs ( 0.86 usr + -0.01 sys =  0.84 CPU) @ 23696682.46/s (n=20000000)
nocomments:  1 wallclock secs ( 0.90 usr +  0.00 sys =  0.90 CPU) @ 22099447.51/s (n=20000000) 
```

如果我将注释和无注释版本作为单独的 Perl 脚本运行，我会得到类似的结果。

不过，这似乎违反直觉，如果没有其他要求，解释器每次都需要将注释读入内存。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-06T20:03:33.367

运行时性能？不。

解析和词法分析性能？是的当然。

由于 Perl 倾向于动态解析和 lex，因此注释会影响“启动”性能。

它们会显着影响它吗？不太可能。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-06T22:21:58.437

Perl 是一种即时编译语言，因此注释和 POD 对运行时性能没有影响。

注释和 POD 对编译时间的影响很小，但它们对 Perl 来说非常容易和快速解析，几乎不可能衡量性能影响。您可以通过使用该`-c`标志进行编译来亲自查看这一点。

在我的 Macbook 上，一个带有 2 个语句和 1000 行 70 个字符注释的 Perl 程序与一个只有 2 个打印语句的 1000 行空注释的编译时间相同。确保运行每个基准测试*两次*以允许您的操作系统缓存文件，否则您要进行基准测试的是从磁盘读取文件的时间。

如果启动时间对您来说是个问题，那不是因为评论和 POD。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-06T20:03:25.020

Perl 编译一个脚本然后执行它。注释略微减慢了编译阶段，但对运行阶段的影响为零。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-11-06T20:49:26.067

Perl 与 shell 脚本不同，它不是一种脚本语言。解释器不会逐行读取文件。Perl 程序的执行分为两个基本阶段：编译和运行时 [1]。在编译阶段，源代码被解析并转换为字节码。在运行时阶段，字节码在虚拟机上执行。

注释会减慢解析阶段，但与解析脚本本身所需的时间（对于大多数程序来说已经非常小）相比，差异可以忽略不计。您真正关心解析时间的唯一一次是在网络服务器环境中，该程序每秒可以调用多次。mod_perl 的存在就是为了解决这个问题。

你正在使用`Benchmark`. 那挺好的！你应该寻找改进算法的方法——而不是微优化。Devel::DProf 可能有助于找到任何热点。您绝对*不应该*在错误的尝试中删除注释以使您的程序更快。你只会让它无法维护。

* * *

[1] 这通常称为“及时”编译。Perl 实际上还有几个阶段，比如`INIT`和`END`这里无关紧要。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-06T20:54:12.797

重点是：优化瓶颈。读取文件包括：

*   打开文件，
*   阅读其内容，
*   关闭文件，
*   解析内容。

在这些步骤中，阅读是迄今为止最快的部分（我不确定是否要关闭，它是一个系统调用，但您不必等待它完成）。即使它是整个事情的 10%（我认为不是），然后将其减少一半只会提高 5% 的性能，代价是缺少评论（这是一件非常糟糕的事情）。对于解析器，丢弃以 # 开头的行并不是明显的减速。在那之后，评论就消失了，所以不能放慢速度。

现在，想象一下，通过删除所有评论，您实际上可以将“阅读脚本”部分提高 5%（这是一个非常乐观的估计，见上文）。“看剧本”占剧本总耗时的比例有多大？当然，这取决于它做了多少，但是由于 perl 脚本通常会读取至少一个文件，因此最多为 50%，但是由于 perl 脚本通常会做更多的事情，因此诚实的估计会将其降低到某个范围内1%。*因此，剥离所有评论的* 预期效率提升*最多*（非常乐观）2.5%，但实际上更接近 0.05%。然后，实际上提供超过 1% 的那些已经很快，因为它们几乎什么都不做，所以你再次在错误的点进行优化。

总结，优化瓶颈。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-06T23:19:44.827

Benchmark 模块在这种情况下是无用的。它只是测量一遍又一遍地运行代码的时间。由于您的代码实际上并没有做任何事情，因此大部分代码都对其进行了优化。这就是为什么你会看到它每秒运行 2200 万次。

我在[Mastering Perl](http://oreilly.com/catalog/9780596527242/)中几乎整整一章都有这方面的内容。基准技术的测量误差约为 7%。您的基准数字在此范围内，因此几乎没有区别。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-06T20:05:17.310

来自 Paul Tomblins 的评论：

> > perl 不做某种即时编译吗？也许评论会提前被丢弃？——</p>

是的，Perl 可以。

它是一种介于编译和解释之间的编程语言。代码被即时编译然后运行。评论通常没有任何区别。它可能会产生的最大影响是，当它最初逐行解析文件并预编译它时，您可能会看到纳秒级的差异。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-06T20:04:13.927

我希望一条评论只会被解析一次，而不是在循环中多次解析，所以我怀疑这是一个有效的测试。

我希望注释会稍微减慢编译速度，但我认为删除它们太小了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-06T20:40:49.047

Perl 注释会减慢脚本的速度吗？好吧，解析它，是的。解析后执行？不。脚本多久被解析一次？只有一次，所以如果你在 for 循环中有注释，注释会被解析丢弃一次，在脚本甚至运行之前，一旦它开始运行，注释就已经消失了（并且脚本不会在内部存储为脚本Perl)，因此无论 for 循环重复多少次，注释都不会产生影响。解析器跳过注释的速度有多快？Perl 注释的完成方式非常快，因此我怀疑你会注意到。如果您有 5 行代码，并且每行之间有 1 行 Mio 注释，您会注意到启动时间更长……但是这种可能性有多大，那么大的注释有什么用呢？

# apache-flex - Flex - 嵌套对象结构的 XML 序列化和反序列化

> ID：270046
> 
> 赞同：1
> 
> 时间：2008-11-06T20:00:12.407
> 
> 标签：apache-flex, actionscript-3, xml-serialization

我们的 Flex 应用程序希望将请求和响应作为对象图（没有什么不寻常的）来处理，例如响应成为某些视图的模型，并且将是具有多层嵌套的结构。

** 现在，理想情况下，我们希望对不同的消息格式（例如 XML 和 AMF）使用相同的客户端（和服务器）端对象，并具有可插入的序列化/反序列化层（！）

AMF 使用 [RemoteClass(alias="samples.contact.Contact")] 对客户端到服务器进行序列化和匹配，但似乎没有 XML 的等价物。

我（有点乐观）正在寻找一种将对象图序列化为 XML 的简洁方法，以便通过客户端的 HTTPService 发送。

对于响应，默认的“对象”和“E4X”提供了一些反序列化。这很方便，但是我们当然没有像使用 AMF 那样将 XML 解包回特定的 AS 类的技巧。

有什么建议么？（确实有一个关于将对象包装/转换为 XML 或 XMLList 的想法——但这似乎不起作用）

更新：

这两个库看起来都很有用，我很可能会在某个时候使用它们。

现在，我真的需要简单地重新使用我们在任何情况下都使用的 AMF3 序列化的元数据集（[RemoteClass]，[Transient]）

.. 所以目前最好的选择是 AMFX - 使用 Flex 数据服务使用 XML 进行 AMF 传输 - mx.messaging.channels.amfx 包中的类 - 目前唯一的缺点是任何 Externalizable 类都转换为十六进制字节流 -并且 ArrayCollection 是可外部化的！（希望通过序列化子类中的内部数组来解决..）

希望这对某人有用..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-11T12:39:09.033

关于 Xml 序列化，我可以为您提供一个起点（尽管可能有偏见：D）。

我正在开发一个允许将 AS3 对象自动转换为 xml 和从 xml 转换的项目。它基本上在用于通信的模型对象上使用注释，以便构造 xml 结构或从 xml 填充对象。

[它被称为 FlexXB，您可以在http://code.google.com/p/flexxb/](http://code.google.com/p/flexxb/)上查看它。我开始这个项目是因为我在工作中遇到了同样的问题（即我有一个通过 xml 通信的服务器），我希望它对其他人有用。

干杯，

亚历克斯

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-28T22:24:39.637

另一个项目：**FleXMLer** ( [http://code.google.com/p/flexmler/](http://code.google.com/p/flexmler/) )。
它既有 asx3m 的直截了当的态度，您可以直接调用：

```
新的 FleXMLer().serialize(obj);
```

或者，您可以自定义 XML 元素名称、跳过元素并调整数组和哈希表的序列化方式。非常感谢您的意见。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-28T12:54:14.110

[在http://code.google.com/p/asx3m](http://code.google.com/p/asx3m)结帐 asx3m 项目 它是 Java XStream 序列化库的 AS3 端口，并且运行良好。我这样做是因为我必须连接到使用 XStream 交换数据对象的服务器平台，并在其中投入了大量工作。它可以扩展为将 AS3 对象序列化为任何格式（例如 JSON），并且可以利用用户定义的元标记的强大功能。干杯，

托米斯拉夫

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T20:52:23.313

Adobe 也提供了一个包含 JSON 的库。由于 ActionScript 是 JavaScript 的超集……而且 JSON 越来越多地支持跨框架……

# java - Java 资源文件

> ID：270048
> 
> 赞同：1
> 
> 时间：2008-11-06T20:00:49.113
> 
> 标签：java, properties, jar

我正在编写一个包含一些“编辑器”功能的小型 GUI 应用程序，以及我想让用户打开一些示例文本文件以快速测试的东西。最简单的方法是使用适当的示例文件打包一个单独的 zip，然后手动打开它们；我想让事情变得更加用户友好，并允许他们从应用程序内部挑选文件然后运行它们。

所以……我用什么？我最初考虑过 .properties ，但这似乎不太适合这份工作......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T20:36:45.203

您可以在 jar 中直接包含资源文件，然后在您的应用程序中将其作为资源流打开。如果您使用的是 Spring，则可以将资源直接注入 bean。如果没有，请查看[Class.getResourceAsStream()](http://java.sun.com/javase/6/docs/api/java/lang/Class.html#getResourceAsStream(java.lang.String))。您只需要注意用于访问资源文件的路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T20:07:29.037

可以为您的 FileDialog 提供一个 FilenameFilter，它可以按您喜欢的任何标准过滤文件。您可以将其默认指向示例文件的目录，让它忽略所有未命名为“.sample”或“MySampleXXXX.java”的内容，例如

```
myDialog.setFilenameFilter( new FilenameFilter() {

   public void accept (File dir, String name) {
           return name.startsWith("FooBar");
   }
} 
```

# winforms - 什么时候应该使用尺寸控制（windows Forms）？

> ID：270061
> 
> 赞同：0
> 
> 时间：2008-11-06T20:03:44.630
> 
> 标签：winforms, sizing, grip

它应该用于所有相当大的表单，还是仅在不容易猜出一个表单是相当大的时候使用？是否有使用它的 GUI 约定？

任何指向文档的链接将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T20:11:50.353

根据 Vista 用户体验指南：

> 可调整大小的窗口不再必须在右下角显示调整大小字形，因为：
> 
> *   窗口的所有边和边缘都可以调整大小，而不仅仅是右下角。
> *   字形需要显示状态栏，但许多可调整大小的窗口不提供状态栏。
> *   可调整大小的窗口边框和调整大小指针在传达窗口可调整大小方面比调整大小字形更有效。

[http://msdn.microsoft.com/en-us/library/aa511262.aspx](http://msdn.microsoft.com/en-us/library/aa511262.aspx)

# java - Hibernate/JPA 注释——未知实体

> ID：270074
> 
> 赞同：0
> 
> 时间：2008-11-06T20:09:15.600
> 
> 标签：java, hibernate, jpa, annotations

几个月来一直运行良好的应用程序已经停止使用几个月来`@Entity`一直是其中一部分的 JPA 注释。当我的集成测试运行时，我看到了几十个“ `org.hibernate.MappingException: Unknown entity: com.whatever.OrderSystem`”类型的错误。

我不清楚这里出了什么问题。

我没有`hibernate.cfg.xml`文件，因为我使用的是 Hibernate Entity Manager。由于我只使用注释，因此我的实体没有 .hbm.xml 文件。我的`persistence.xml`文件很小，并且`META-INF`按照应有的方式存在。

我显然遗漏了一些东西，但不能指望它。

我正在使用 hibernate-annotations 3.2.1、hibernate-entitymanager 3.2.1、persistence-api 1.0 和 hibernate 3.2.1。hibernate-commons-annotations 也是项目 POM 的一部分，但我不知道这是否相关。

是否存在消失的 web.xml 条目，或者意外删除的 Spring 配置条目？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-13T21:15:29.453

在您的实体类中验证您导入 javax.persistent.Entity 而不是 org.hibernate.annotations.Entity

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T20:32:02.480

我似乎记得我曾经遇到过类似的问题。

这是一个很长的镜头，但如果您还没有这样做，您是否明确指定了您正在使用的提供程序？

```
<persistence ...>
   <persistence-unit ...>
      <provider>org.hibernate.ejb.HibernatePersistence</provider> <---- explicit setting
      ....
   </persistence-unit>
</persistence> 
```

否则，我不确定？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-30T17:12:04.600

这是针对一个特定类（少数类）还是所有实体类发生的。persistence.xml 文件有一个类和/或 jar 文件列表，需要扫描这些文件以查找 @Entity 映射。如果它在早期工作，您可以对正常工作的 persistence.xml 版本进行快速比较。另一个问题可能是它获取了不同的persistence.xml 文件——您可以通过在persistence.xml 中引入错误（例如，使xml 无效）来验证这一点。

# data-structures - LinkedList 和二叉搜索树的区别

> ID：270080
> 
> 赞同：41
> 
> 时间：2008-11-06T20:13:23.330
> 
> 标签：data-structures, linked-list, language-agnostic, binary-search-tree

链接列表和 BinarySearchTree 之间的主要区别是什么？BST 只是维护 LinkedList 的一种方式吗？我的导师谈到了 LinkedList，然后是 BST，但没有比较它们，也没有说什么时候更喜欢一个。这可能是一个愚蠢的问题，但我真的很困惑。如果有人能以简单的方式澄清这一点，我将不胜感激。

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2008-11-06T20:21:07.043

链表：

```
Item(1) -> Item(2) -> Item(3) -> Item(4) -> Item(5) -> Item(6) -> Item(7) 
```

二叉树：

```
 Node(1)
                /
            Node(2)
           /    \
          /      Node(3)
  RootNode(4)
          \      Node(5)
           \    /
            Node(6)
                \
                 Node(7) 
```

在链表中，项目通过单个 next 指针链接在一起。在二叉树中，每个节点可以有 0、1 或 2 个子节点，其中（在二叉搜索树的情况下）左节点的键小于该节点的键，而右节点的键大于节点。只要树是平衡的，每个项目的搜索路径都比链表中的要短很多。

搜索路径：

```
------ ------ ------
key    List   Tree
------ ------ ------
1      1      3
2      2      2
3      3      3
4      4      1
5      5      3
6      6      2
7      7      3
------ ------ ------
avg    4      2.43
------ ------ ------ 
```

通过更大的结构，平均搜索路径变得更小：

```
------ ------ ------
items  List   Tree
------ ------ ------
     1      1   1
     3      2   1.67
     7      4   2.43
    15      8   3.29
    31     16   4.16
    63     32   5.09
------ ------ ------ 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-11-06T20:26:26.393

**二叉搜索树**是一棵二叉树，其中每个内部节点*x*存储一个元素，使得 x 的左子树中存储的元素*小于*或等于*x并且**x*的右子树中存储的元素大于或等于*x*。

![替代文字](https://upload.wikimedia.org/wikipedia/commons/thumb/d/da/Binary_search_tree.svg/300px-Binary_search_tree.svg.png)

现在，**链接列表**由一系列节点组成，每个节点包含任意值和一个或两个指向下一个和/或前一个节点的引用。

![链表](https://upload.wikimedia.org/wikipedia/commons/thumb/6/6d/Singly-linked-list.svg/300px-Singly-linked-list.svg.png)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-11-06T20:20:02.177

在计算机科学中，[二叉搜索树 (BST)](http://en.wikipedia.org/wiki/Binary_search_tree)是一种二叉树数据结构，具有以下属性：

*   每个节点（树中的项目）都有一个不同的值；
*   左右子树也必须是二叉搜索树；
*   节点的左子树只包含小于节点值的值；
*   节点的右子树只包含大于或等于节点值的值。

在计算机科学中，[链表](http://en.wikipedia.org/wiki/Linked_list)是基本的数据结构之一，可用于实现其他数据结构。

所以二叉搜索树是一个抽象概念，可以用链表或数组来实现。而链表是一种基本的数据结构。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-11-06T20:19:00.200

我想说的主要区别是对二叉搜索树进行了排序。当您插入二叉搜索树时，这些元素最终存储在内存中的位置是其值的函数。使用链表，元素被盲目地添加到列表中，而不管它们的值如何。

您可以立即进行一些权衡： 链表保留插入顺序并且插入成本更低 二叉搜索树通常搜索速度更快

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-11-06T20:23:58.160

链表是相互链接的连续数量的“节点”，即：

```
public class LinkedListNode
{
     Object Data;
     LinkedListNode NextNode;
} 
```

二叉搜索树使用类似的节点结构，但不是链接到下一个节点，而是链接到两个子节点：

```
public class BSTNode
{
    Object Data
    BSTNode LeftNode;
    BSTNode RightNode;
} 
```

通过在向 BST 添加新节点时遵循特定规则，您可以创建一个遍历速度非常快的数据结构。这里的其他答案已经详细说明了这些规则，我只是想在代码级别显示节点类之间的区别。

需要注意的是，如果将已排序的数据插入 BST，最终会得到一个链表，并且会失去使用树的优势。

因此，linkedList 是 O(N) 遍历数据结构，而 BST 在最坏情况下是 O(N) 遍历数据结构，而在最佳情况下是 O(log N)。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-11-06T20:20:34.987

链表和 BST 并没有太多共同之处，只是它们都是充当容器的数据结构。[**链接列表**](http://en.wikipedia.org/wiki/Linked_list)基本上允许您在列表中的任何位置有效地插入和删除元素，同时保持列表的顺序。这个列表是使用从一个元素到下一个元素（通常是前一个元素）的指针来实现的。

另一方面，[**二叉搜索树**](http://en.wikipedia.org/wiki/Binary_search_tree)是一种更高抽象的数据结构（即它没有指定*如何*在内部实现），它允许有效的搜索（即为了找到一个特定的元素，你根本不需要查看要素。

请注意，链表可以被认为是退化的二叉树，即所有节点只有一个孩子的树。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-11-06T21:46:18.290

它们确实有相似之处，但主要区别在于二叉搜索树旨在支持对元素或“键”的有效搜索。

二叉搜索树，就像一个双向链表，指向结构中的另外两个元素。然而，当向结构中添加元素时，而不是仅仅将它们附加到列表的末尾，二叉树被重新组织，使得链接到“左”节点的元素小于当前节点，而链接到“右”节点的元素节点大于当前节点。

在一个简单的实现中，将新元素与结构的第一个元素（树的根）进行比较。如果小于，则采用“左”分支，否则检查“右”分支。这对每个节点都继续，直到发现一个分支是空的；新元素填充该位置。

使用这种简单的方法，如果按顺序添加元素，您最终会得到一个链表（具有相同的性能）。通过重新排列节点，存在不同的算法来维持树中的某种平衡度量。例如，AVL 树做最多的工作是尽可能保持树的平衡，从而提供最佳搜索时间。红黑树不能保持树的平衡，导致搜索速度稍慢，但在插入或删除键时平均做的工作较少。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-11-06T20:22:02.597

其实很简单。链表只是一堆链接在一起的项目，没有特定的顺序。你可以把它想象成一棵从不分枝的非常瘦的树：

`1 -> 2 -> 5 -> 3 -> 9 -> 12 -> |i.` （最后是终止 null 的 ascii-art 尝试）

二叉搜索树在两个方面有所不同：二叉部分意味着每个节点有*2*个子节点，而不是一个，而搜索部分意味着这些子节点被排列以加快搜索速度——只有较小的项目在左边，只有较大的项目向右：

```
 5
   / \
  3   9
 / \   \
1   2   12 
```

9 没有左孩子，1、2 和 12 是“叶子”——它们没有分支。

有道理？

对于大多数“查找”用途，BST 更好。但是对于仅“保留一个列表以处理以后的先进先出或后进先出”类型的事情，链接列表可能会很好用。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-11-06T20:21:31.847

链表就是……一个列表。它是线性的；每个节点都有对下一个节点的引用（如果您说的是双向链表，也是前一个节点）。树的分支---每个节点都有对各种子节点的引用。二叉树是一种特殊情况，其中每个节点只有两个孩子。因此，在链表中，每个节点都有一个前一个节点和一个下一个节点，而在二叉树中，一个节点有一个左孩子、右孩子和父母。

这些关系可能是双向的或单向的，这取决于您需要如何遍历结构。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-11-06T20:23:20.783

链表的问题是在其中搜索（无论是检索还是插入）。

对于单链表，您必须从头部开始并按顺序搜索以找到所需的元素。为了避免扫描整个列表，您需要对列表中的节点进行额外的引用，在这种情况下，它不再是一个简单的链表。

二叉树通过固有的排序和可导航性允许更快速的搜索和插入。

我过去成功使用的另一种方法是 SkipList。这提供了类似于链表的东西，但具有额外的引用以允许与二叉树相当的搜索性能。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-11-06T20:22:15.200

链表是直线数据，相邻节点相互连接，例如 A->B->C。您可以将其视为直栅栏。

BST 是一种层次结构，就像一棵树，主干连接到分支，而这些分支又连接到其他分支，依此类推。这里的“二进制”一词意味着每个分支最多连接到两个分支。

您使用链表仅表示直接数据，每个项目最多连接一个项目；而您可以使用 BST 将一个项目连接到两个项目。您可以使用 BST 来表示诸如家谱之类的数据，但这将成为 n 元搜索树，因为每个人可能有两个以上的孩子。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-06T20:21:20.210

二叉搜索树可以以任何方式实现，它不需要使用链表。

链表只是一个结构，它包含节点和指向节点内其他节点的指针/引用。给定列表的头节点，您可以浏览到链表中的任何其他节点。双向链表有两个指针/引用：对下一个节点的正常引用，以及对前一个节点的引用。如果双向链表中的最后一个节点引用列表中的第一个节点作为下一个节点，并且第一个节点引用最后一个节点作为它的前一个节点，则称它为循环链表。

二叉搜索树是一棵基于二叉搜索比较算法将其输入分成大致相等的两半的树。因此，它只需要很少的搜索就可以找到一个元素。例如，如果你有一棵 1-10 的树并且你需要搜索三个，首先会检查顶部的元素，可能是 5 或 6。三个会小于那个，所以只有前半部分然后将检查树。如果下一个值为 3，则您拥有它，否则，将进行比较，等等，直到找不到它或返回其数据。因此，树的查找速度很快，但插入或删除的速度并不快。这些是非常粗略的描述。

[来自维基百科的链表](http://en.wikipedia.org/wiki/Linked_list)和[二叉搜索树](http://en.wikipedia.org/wiki/Binary_Search_Tree)，也来自维基百科。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-11-06T20:22:40.970

它们是完全不同的数据结构。

链表是一个元素序列，其中每个元素都链接到下一个元素，如果是双向链表，则链接到前一个元素。

二叉搜索树是完全不同的东西。它有一个根节点，根节点最多有两个子节点，每个子节点最多可以有两个子笔记等。这是一个非常聪明的数据结构，但在这里解释起来有点乏味。查看有关它的[Wikipedia 文章](http://en.wikipedia.org/wiki/Binary_tree)。

# c# - 单实例形式但不是单例

> ID：270091
> 
> 赞同：1
> 
> 时间：2008-11-06T20:20:12.100
> 
> 标签：c#, winforms, multithreading

我无法理解这怎么可能。请帮忙！！

我有一个带有托盘图标的应用程序。我希望在用户双击托盘图标时显示一个表单。我有一个问题，可以通过快速三次或四次单击托盘图标来显示 2 个或更多表单。我不想要单例的原因是我希望每次关闭时都会释放表单以节省内存，也许这不是一个好主意？

我有一个名为 m_form1 的字段。我有一个名为 ShowForm1 的方法；我在 TrayIcon 的双击上调用了 ShowForm1 方法。

```
 private Form1 m_form1;
        private void ShowForm1()
        {
            if (m_form1 == null)
            {
                Trace.WriteLine("*CREATE*" + Thread.CurrentThread.ManagedThreadId.ToString());
                m_form1 = new Form1();
                m_form1.FormClosed += new FormClosedEventHandler(m_form1_FormClosed);
                m_form1.Show();
            }
            m_form1.BringToFront();
            m_form1.Activate();
        } 
```

因此，当 Form1 需要一段时间来构造时，则可以创建 2，因为当第二次调用到达时 m_form1 仍然为 null。锁定似乎不起作用，因为它是两个调用的同一个线程（我猜是 UI 线程），即跟踪写出 *CREATE*1 两次（如下）。

```
[3560] *CREATE*1 
[3560] *CREATE*1 
```

更改代码以包含锁定语句对我没有帮助。

```
 private Form1 m_form1;
    private object m_Locker = new object();
    private void ShowForm1()
    {
        lock (m_Locker)
        {
            if (m_form1 == null)
            {
                Trace.WriteLine("****CREATE****" + Thread.CurrentThread.ManagedThreadId.ToString());
                m_form1 = new Form1();
                m_form1.FormClosed += new FormClosedEventHandler(m_form1_FormClosed);
                m_form1.Show();
            }
        }
        m_form1.BringToFront();
        m_form1.Activate();
    } 
```

我应该如何处理这种情况？

多谢你们

蒂姆。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-06T20:23:48.957

有一个额外的布尔变量“m_formUnderConstruction”，您可以在构建表单之前对其进行测试，并在您决定构建表单后立即设置它。

不幸的是，重入让这一切有点恶心。我已经移除了锁，就好像它曾经从不同的线程中调用过一样，然后你就会遇到令人讨厌的情况，即试图从不同的线程显示一个表单到构建它的那个线程上。

```
private Form1 m_form1;
private bool m_underConstruction = false;

private void ShowForm1()
{
    if (m_underConstruction)
    {
        // We're about to show it anyway
        return;
    }
    m_underConstruction = true;
    try
    {
        if (m_form1 == null)
        {
            m_form1 = new Form1();
            m_form1.FormClosed += new FormClosedEventHandler(m_form1_FormClosed);
            m_form1.Show();
        }
    }
    finally
    {
        m_underConstruction = false;
    }
    m_form1.BringToFront();
    m_form1.Activate();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T20:31:51.687

使用 Interlocked.Increment 更改尝试次数。如果是1，打开表格，否则，不要。并在测试后或表单关闭时使用 Interlocked.Decrement。

```
private int openedForms = 0;
private Form1 m_form1;
private void ShowForm1()
{

    if (Interlocked.Increment(ref openedForms) = 1)
    {
       m_form1 = new Form1();
       m_form1.FormClosed += new FormClosedEventHandler(m_form1_FormClosed);
       m_form1.Show();
    }
    else
    {
       Interlocked.Decrement(ref openedForms);
    }
    if (m_form1 != null)
    {
       m_form1.BringToFront();
       m_form1.Activate();
    }
}

private void m_form1_FormClosed(object Sender, EventArgs args)
{
   Interlocked.Decrement(ref openedForms);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-29T16:31:35.150

请看这个，它处理 NotifyIcon 和 Form1 的所有鼠标事件组合。

更多信息：http: [//code.msdn.microsoft.com/TheNotifyIconExample](http://code.msdn.microsoft.com/TheNotifyIconExample)

# c# - 在表达式中使用赋值可以吗？

> ID：270093
> 
> 赞同：1
> 
> 时间：2008-11-06T20:20:47.403
> 
> 标签：c#, expression, variable-assignment

我遇到了这段代码，并希望其他人提供他们的观点……是好是坏？;)

```
Class ReportClass
{
 public string ReportName {get; set;}
} 
```

然后在代码中使用如下：

```
displayReport(ReportClass.ReportName = cmbReportName.SelectedValue.ToString()) 
```

这是我能给你的最简单的例子。问题是......为什么我找不到例子？这会叫什么？这只是自找麻烦吗？

**编辑：**我指的是就地分配。直到今天我才知道

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-06T20:45:06.247

我倾向于避免就地分配——或者实际上是这样的任何副作用——除了一个常见的习语：

```
string line;
while ((line = reader.ReadLine()) != null)
{
    // Do something with line    
} 
```

（以及用于读取流等的变体）

我也可以在参数调用中使用对象初始化器，例如

```
Foo(new Bar { X=1, Y=2 }); 
```

但是分配给现有对象中的属性...嗯，这都是主观的，但这不是我的一杯茶。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-06T20:30:36.133

我认为这更难维护/更难调试/更难理解代码。在调用该方法之前，我会在一行上进行分配。

```
ReportClass.ReportName = cmbReportName.SelectedValue.ToString();
displayReport(ReportClass.ReportName); 
```

我从来都不是复合语句的粉丝。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-06T20:35:26.390

**完全没问题。**两个都。

*   自动属性（`{get; set;}`事物）：在 C# 中引入。非常有用的功能。

*   参数中的赋值：在 C# 中很少使用，但完全合法。基本上，它将赋值运算符 (=) 右侧的表达式的值分配给左侧属性的属性，然后将该值传递给方法。

    这在 C 中更为常见，但我看不出为什么在 C# 中也不应该允许它。有时它可能有助于提高可读性，有时它会使情况变得更糟。使用常识来决定何时适用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-06T20:27:16.580

您是指自动属性还是就地分配？

取决于您的团队 IMO。如果您的团队由 C 风格的开发人员组成。那我觉得还可以。

但是，如果要由 VB 开发人员进一步维护此代码，那么您需要使其更具可读性。

例子？C 语言中的赋值运算符 (=) 也返回它所分配的值。

```
var a = 0;
var b = 0;

// This makes a *and* b equals to 1
a = b = 1; 

// This line prints 3 and a is now equals to 3
Console.WriteLine(a = 3);

// This line prints 7 and a and b is now equals to 7
Console.WriteLine(a = b = 7); 
```

我认为这种分配发生是很自然的。因为 C 语言似乎鼓励速记符号 IMO。

如果您需要更多的可读性和更少的麻烦，那么我会说换行符是一个不错的添加。

```
displayReport(
    ReportClass.ReportName = cmbReportName.SelectedValue.ToString()); 
```

*当每个复合*语句位于不同的行时，使您的意图更加清晰。（但仍然是复合语句）

或者，首先将正确的部分提取到它自己的变量中，例如

```
var reportName = cmbReportName.SelectedValue.ToString();

displayReport(ReportClass.ReportName = reportName); 
```

我一直在使用它，我还没有看到有人在阅读它时感到困惑。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-06T20:46:18.863

Microsoft 框架设计指南不鼓励在一行中放置多个语句，除非有直接的语言支持，例如在`for`语句中。由于对多重赋值有明确的语言支持，

```
int a, b, c;
a = b = c = 0; 
```

是允许的。另一方面，不鼓励使用您的示例中使用的表单代码。

各位，这个怎么样？

```
while ((packetPos = Packet.FindStart(buffer, nextUnconsideredPos)) > -1) 
```

为避免内联分配，您必须进行冗余分解，如下所示：

```
packetPosition = Packet.FindStart(buffer, nextUnconsideredPosition);
while (packetPosition > -1)
{
  ...
  packetPosition = Packet.FindStart(buffer, nextUnconsideredPosition);
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-06T20:47:25.460

就我个人而言，我发现作为参数的赋值不是很可读。整个执行流程只是因为在参数列表中实际发生了操作而产生了偏差。

我喜欢认为我的代码应该表达意图，而不是保存空格。我在这个例子中的意图正是 EvilSyn 所建议的，首先分配值，然后将其传递给方法。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-11-06T20:24:47.613

对我来说似乎很好。它可能是用 C# 3.0 编译的，并且允许[C# 自动属性](http://msdn.microsoft.com/en-us/library/bb384054.aspx)。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-11-07T12:43:38.670

就属性命名而言，您有一个 ReportClass，我会将其更改为 Report，并且其上的属性从 ReportName 更改为仅 Name。节省您的打字时间（尽管可以使用智能感知）。编码为 Report.Name 时看起来更好。

我知道这有点离题，但是嘿嘿

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2008-11-06T20:39:55.570

这真的是有效的代码吗？对我来说似乎是一个静态类。

我猜你会这样使用它：

```
displayReport(new ReportClass { ReportName = cmbReportName.SelectedValue.ToString() } )

```

# vb.net - 计算月份

> ID：270112
> 
> 赞同：2
> 
> 时间：2008-11-06T20:25:08.580
> 
> 标签：vb.net

我有一个应用程序，用户可以在其中选择第一条语句和最后一条语句的日期。例如，第一个语句 = 1/1/08，最后一个语句 = 12/1/08，应该等于 12 个语句。

但是，使用以下代码时，结果为 11：

```
numPayments = DateDiff(DateInterval.Month, CDate(.FeeStartDate), CDate(.FeeEndDate)) 
```

有没有另一种方法来计算这个，还是我必须坚持在结果中加 1？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-06T20:27:21.507

写的时候加1。;)

2008 年 1 月 1 日和 2008 年 12 月 1 日之间相差 11 个月。没有改变。;)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T20:27:43.020

好吧，1 月 1 日和 12 月 1 日之间的月数是 11……您要查找的是月差 +1。所以只需添加一个:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T20:30:29.303

此外，您使用的 DateDiff 函数是 VB6 保留的。最好这样表达：

```
numPayments = (Date.Parse(.FeeEndDate) - Date.Parse(.FeeStartDate)).TotalMonths + 1 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-06T20:31:18.380

是的，您总是必须添加一个，尽管您可以将一个添加到结束日期或从开始日期减去一个来获得这种效果。考虑开始日期和结束日期相同的情况。它们的差异为 0，但您仍然希望显示 1 个语句以记录一个奇怪的情况。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-06T03:42:41.767

你可以试试这个。希望这很有帮助。

```
Dim myDate As Date
Dim dateNow As Date
Dim nextMonth As Date

myDate = Now
dateNow = Format(myDate, "MM/dd/yyyy")
nextMonth = DateAdd(DateInterval.Month, 5, dateNow) 'compute the next 5 months from date now. Let say, #12/6/2012# the result will be #5/6/2013#

MessageBox.Show(DateDiff(DateInterval.Month, dateNow, nextMonth) & "months==> " & nextMonth)
'This will count the number of months interval. The result will be 5 months=>> #5/6/2013 because we count december to may. 
```

# c - 如何阻止 sem_open() 因 ENOSYS 失败？

> ID：270113
> 
> 赞同：3
> 
> 时间：2008-11-06T20:25:18.080
> 
> 标签：c, linux, ipc, posix, semaphore

我有两个 Slackware Linux 系统，POSIX 信号量`sem_open()`调用失败，errno 设置为 38。下面重现的示例代码（代码在 CentOS / RedHat 上运行良好）。

是否有任何内核或系统配置选项可能导致此问题？其他建议？

有问题的系统是 Slackware 10.1.0 内核 2.6.11 /lib/librt-2.3.4.so /lib/libpthread-0.10.so，但相同的代码适用于更旧的 RedHat 9 内核 2.4.20 /lib/librt -2.3.2.so /lib/tls/libpthread-0.29.so。（也适用于 CentOS 5 内核 2.6.18 /lib/librt-2.5.so /lib/i686/nosegneg/libpthread-2.5.so）。

`man sem_open``sem_open()`表明系统不支持此 errno 方法。

```
#define ENOSYS          38      /* Function not implemented */ 
```

`sem_open()`用户空间是`librt`我们动态链接的地方，并且存在`librt`于受影响的系统上。

受影响的系统声称支持 POSIX 信号量：`_POSIX_SEMAPHORES`是真的并`sysconf(_SC_SEMAPHORES)`证实了这一点。

谢谢，基兰

编辑 1：我添加了有关正在使用的软件版本的更多详细信息，并删除了一些不相关的评论。

编辑 2： /dev/shm 安装在好的系统上，而不是安装在坏的系统上。安装它并没有改变受影响系统上的行为。我认为 /dev/shm 也是必要的，但 sem_open() 在此之前失败了，并且 strace 支持这一点。

```
# /* Quick'n'dirty test program to illustrate sem_open failure
#Run this file to auto-build test and run as a.out

# Build
gcc $0 -lrt
if [ $? -ne 0 ] ; then exit ; fi

# Run
$( dirname $0)/a.out
exit
*/

#include <stdio.h>
#include <fcntl.h>
#include <errno.h>
#include <unistd.h>
#include <semaphore.h>

int main(int argc, char *argv[]) {

 const char *SEM_NAME = "SHRMEM_SCXL";  /* name of mutex */
 sem_t *mutex = SEM_FAILED;             /* ptr to mutex */

#ifdef _POSIX_SEMAPHORES
  printf("_POSIX_SEMAPHORES %ld\n", _POSIX_SEMAPHORES);
#else
  puts("Undefined");
#endif

 printf("sysconf %s\n", sysconf(_SC_SEMAPHORES) ? "Yes" : "No" );

 mutex = sem_open(SEM_NAME, O_CREAT, 0666, 1);

 if (mutex == SEM_FAILED) printf("Failed %d\n", errno);
 else {
        puts("Success - pause while you check /dev/shm ");
        sleep(5);
        sem_close(mutex);
        sem_unlink(SEM_NAME);
 }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-06T21:33:38.440

/dev/shm 是否已安装？旧版本的 slackware 可能没有在引导时挂载这个文件系统。从 /etc/fstab：

```
tmpfs  /dev/shm  tmpfs  defaults  0   0 
```

编辑：毕竟这可能不是问题。我认为您可能只需要升级内核甚至 librt。

Edit2：我认为对于我认为您正在使用的 slackware 11，您需要一个比 2.6.13 更新的内核才能使用 sem_open 似乎需要的 NPTL 线程库（/lib/tls 中的库）工作。

Edit3：我设法让它与我拥有的 slackware 11 盒子一起工作，方法是 a）安装 /dev/shm 和 b）将环境变量设置`LD_ASSUME_KERNEL`为 2.6.13（任何内核版本> 2.6.12 都可以使用）。即使内核是 2.6.11.11，这似乎也有效，但线程等其他东西可能不会。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T12:20:19.667

旧版本的线程库不支持在进程之间共享 POSIX 信号量。从`man sem_init`

> pshared 参数指示信号量是当前进程本地的（ pshared 为零）还是要在多个进程之间共享（ pshared 不为零）。LinuxThreads 当前不支持进程共享信号量，因此如果 pshared 不为零，sem_init 总是返回错误 ENOSYS。

当 sem_open() 创建命名信号量时，它总是试图在进程之间共享它们。

支持在 Slackware 10 上使用 sem_init() 在进程之间共享匿名信号量

*   升级 libpthread 和（可能）librt
*   升级内核

此外，支持与 sem_open() 共享命名信号量

*   添加一行以`/etc/fstab`挂载`/dev/shm`为 tmpfs

    tmpfs /dev/shm tmpfs 默认值 0 0

*   运行`mount /dev/shm`或重启

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T16:15:05.717

“进程共享 sema4s 不起作用”假设对我来说很有意义。并不是说它对您有帮助，但是如果您有时间和意愿，您可能想尝试以下方法，看看“流程共享”方面是否是失败的：

1.  在非共享内存中使用 sem_init 创建一个信号量（用于线程）。如果它有效，那么 sema4s 在该过程中工作。

2.  在共享内存中重复实验。这应该告诉您它们是否在进程之间工作。请注意，您可能需要实际尝试使用 sema4 来查看它是否在进程之间工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T16:38:49.427

跨进程共享信号量的另一种方法是使用 SystemV 信号量。

即使在共享 POSIX 信号量不起作用的情况下（至少在上述系统上），这些也确实有效。

有关两种类型的信号量使用的示例，请参见[http://www.linuxdevcenter.com/pub/a/linux/2007/05/24/semaphores-in-linux.html](http://www.linuxdevcenter.com/pub/a/linux/2007/05/24/semaphores-in-linux.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-19T07:02:44.897

我正在使用[POSIX](https://en.wikipedia.org/wiki/POSIX)消息队列，我遇到了同样的错误，mq_open 失败并出现错误 38 (ENOSYS)。

解决方法是在内核配置中启用 POSIX MESSAGE QUEUE 来重建内核。

这将构建具有 POSIX 消息队列支持的内核，它对我有用。

# php - 我可以告诉 Apache 从 PHP 进行内部重定向吗？

> ID：270117
> 
> 赞同：8
> 
> 时间：2008-11-06T20:27:13.053
> 
> 标签：php, apache, redirect

有什么方法可以通过从 mod_php 和 apache 调用的 PHP 脚本告诉 apache 执行内部重定向到其他文件？

我不想从 PHP 中读取/要求该文件并将其吐出，我认为将其传递给 Apache 会更有效。我相信这可以用 mod_perl 完成，我很好奇是否有办法用 PHP/mod_php/apache 做到这一点。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T20:32:23.073

[virtual()](http://www.php.net/virtual)可以做你想做的事。我不确定，我从未尝试过。

请注意，如果您只是调用 HTML 或 PHP 页面，则 include() 和 require() 将起作用，并且可以移植到其他 PHP 安装。

我依稀记得使用带有本地 url 的 Location[标头](http://www.php.net/header)作为内部重定向（例如`header("Location: /uri/here.php");`，但我无法在此处对其进行测试以确保。

# java - 对于少量信息，java 文件 i/o 或 derby 哪个更快？

> ID：270124
> 
> 赞同：1
> 
> 时间：2008-11-06T20:28:51.973
> 
> 标签：java, file, performance, io, derby

我正在用 java 编写一个小代理，它将与其他代理玩游戏。我想在程序运行之间保留少量状态（最多可能约为 1kb），以便我可以尝试根据过去的成功调整代理的性能。本质上，我会在每场比赛开始时读取少量数据并在结束时写入少量数据。似乎我有 2 个选项，文件 I/O 或 derby。两者都有速度优势吗？或者对于这么少量的数据真的不重要吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T21:12:13.943

对于 1kb 的数据，最好使用标准文件 IO。最有可能的是，您可以将整个对象树序列化到磁盘并在再次启动时进行反序列化。如果您想变得花哨，可以使用 JAXB 序列化为 XML 而不是二进制文件。

尽管我喜欢将每个问题都适合数据库解决方案，但我认为这在这里不太实用。除非您对数据库特定功能有一些特殊需求，否则使用数据库会引入大量开销、复杂性和维护问题。

您可能真正想要使用数据库的唯一领域是您有很多小对象/行并且您经常对数据执行排序和过滤。但即便如此，您也可以保留十几个内存中的有序列表，并以更少的资源获得更好的性能，而不必担心数据库的问题。

如果您真的认为在这种情况下需要数据库，请考虑 HSQL。我不认为它是一个真正的数据库，但它是一个可以持久保存到文件的内存数据库。低开销、低复杂性和相对较少的故障点。另外，如果您需要编辑持久化的数据，您可以使用文本编辑器来完成。不能这么说德比。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T20:36:16.450

考虑到这些对象可能因文件大小而异，并且您的计算机规格（总线速度、HD 速度）会影响这一点，唯一确定的方法是编写自己的基准测试。只需创建一个简单的 for 循环，从 1 数到 1000，然后一遍遍地读取循环内的文件（但不要创建和销毁循环内的对象，只关注读取部分）。

当然，这整个练习充满了预优化的味道，这可能会导致不良的编码习惯。只需以最易读、最简单的方式编写代码，如果出现速度问题，请根据需要进行重构。

但由于它是少量数据，我会说没关系。

# ruby-on-rails - 如何在rails应用程序之间传递参数？

> ID：270125
> 
> 赞同：1
> 
> 时间：2008-11-06T20:28:59.540
> 
> 标签：ruby-on-rails

我必须在两个 Rails 应用程序之间传递参数。在一侧（发件人）我有一个哈希数组。我有如下代码来发送数据：

```
 http = Net::HTTP.new('localhost', '3030')
   result = http.post('/processar_lotes', my_array_of_hashes) 
```

一些问题

*   是否有任何（某种）序列化或类似的东西可以传递给其他应用程序？
*   另一方面，如何反序列化信息？
*   我作为参数传递的大小是否有限制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T22:51:40.810

可能不是您正在寻找的答案，但我会使用 XML。这将使您的应用程序比使用特定语言的序列化更加灵活。

将数组转换为 XML 并返回应该不会太难。

**编辑：**您可能想查看[ROXML](http://roxml.rubyforge.org/)和[XML::Mapping](http://xml-mapping.rubyforge.org/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-10T14:49:29.630

要回答您的问题：

*   有很多方法可以“序列化”数据。您可以使用自己的自定义格式，也可以使用标准格式。例如，你可以尝试使用 Rails`to_xml`方法，或者`to_json`方法。您还可以使用 Ruby 的[Marshal](http://ruby-doc.org/core/classes/Marshal.html)对象。
*   根据您的选择，这可能是`from_json`、`from_xml`、`Marshal.load`或您自己的自定义阅读器。
*   通常，对于 HTTP 帖子，这是无限的，但根据您的服务器配置，它可能会更少。

# oracle - 使用 SQL Server 2000 Reporting Services 连接到 Oracle 数据库？

> ID：270127
> 
> 赞同：0
> 
> 时间：2008-11-06T20:29:53.687
> 
> 标签：oracle, reporting-services, sql-server-2000

我正在尝试在 SSRS2000 中创建一个报告，该报告将查询 ORACLE 数据库并传递一个参数，我收到以下错误消息：

ORA-01036: 非法的变量名称/编号但无法在网络上的其他地方找到很多关于此错误代码的帮助

我希望这会很简单，有人知道如何完成这项任务吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-06T22:00:30.603

事实证明，必须将参数命名为 Parameter1 才能工作，并且 dba 必须更正连接问题！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T22:24:32.643

您必须接受一些答案才能将此问题显示为“已回答”，并且您不能接受自己的问题，所以它也可能是这个问题。

伙计们，我发誓我不是为了代表而拖钓，我什至不知道正确的说法是什么。但是，如果我将其标记为 Wiki，我不会对吗？所以我做了。

# drawing - 如何使用 XNA 画线？

> ID：270138
> 
> 赞同：46
> 
> 时间：2008-11-06T20:32:02.497
> 
> 标签：drawing, xna, lines, primitive, shapes

我已经阅读了一堆涉及 XNA 的教程（并且是各种版本），但我对绘制原语仍然有些困惑。一切似乎真的很复杂。

有人可以使用代码向我展示在屏幕上绘制一两条线的最简单的 XNA 实现吗？也许有一个简短的解释（包括样板文件）？

我不是游戏程序员，也没有多少 XNA 经验。我的最终目标是在屏幕上绘制一些线条，最终我将通过旋转等（手动）进行转换。然而，对于这第一步..我需要简单地画线！我记得在我古老的 OpenGL 时代，用几个方法调用画一条线是相当简单的。我应该简单地恢复使用非托管 directx 调用吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-06T20:41:50.807

使用 XNA 时，所有内容（甚至是 2d 基元）都必须以 3d 卡可以理解的方式表示，这意味着一条线只是一组顶点。

MSDN在这里有一个很好的演练：

[http://msdn.microsoft.com/en-us/library/bb196414.aspx#ID2EEF](http://msdn.microsoft.com/en-us/library/bb196414.aspx#ID2EEF)

你会发现渲染一条原始线比设置一个带纹理的四边形并旋转它需要更多的代码，因为本质上，你在渲染一条线时做同样的事情。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2011-01-15T00:43:30.923

按照 NoHayProblema 的回答（我还不能发表评论）。

这个答案虽然是这个老问题的正确答案，但并不完整。Texture2D 构造函数返回一个未初始化的纹理，它永远不会在屏幕上绘制。为了使用这种方法，您需要像这样设置纹理的数据：

```
Texture2D SimpleTexture = new Texture2D(GraphicsDevice, 1, 1, false,
    SurfaceFormat.Color);

Int32[] pixel = {0xFFFFFF}; // White. 0xFF is Red, 0xFF0000 is Blue
SimpleTexture.SetData<Int32> (pixel, 0, SimpleTexture.Width * SimpleTexture.Height);

// Paint a 100x1 line starting at 20, 50
this.spriteBatch.Draw(SimpleTexture, new Rectangle(20, 50, 100, 1), Color.Blue); 
```

考虑到将数据写入像素的方式必须与纹理的 SurfaceFormat 一致。该示例有效，因为纹理被格式化为 RGB。可以像这样在 spriteBatch.Draw 中应用旋转：

```
this.spriteBatch.Draw (SimpleTexture, new Rectangle(0, 0, 100, 1), null,
    Color.Blue, -(float)Math.PI/4, new Vector2 (0f, 0f), SpriteEffects.None, 1f); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-11-12T01:37:37.287

找到了该 [http://www.bit-101.com/blog/?p=2832的教程](http://www.bit-101.com/blog/?p=2832)

它使用 BasicEffect（着色器）和 XNA 4.0 中的内置绘图用户原语

一些我觉得有帮助的代码示例：

加载内容方法

```
basicEffect = new BasicEffect(GraphicsDevice);
basicEffect.VertexColorEnabled = true;
basicEffect.Projection = Matrix.CreateOrthographicOffCenter
(0, GraphicsDevice.Viewport.Width,     // left, right
GraphicsDevice.Viewport.Height, 0,    // bottom, top
0, 1); 
```

画法

```
basicEffect.CurrentTechnique.Passes[0].Apply();
var vertices = new VertexPositionColor[4];
vertices[0].Position = new Vector3(100, 100, 0);
vertices[0].Color = Color.Black;
vertices[1].Position = new Vector3(200, 100, 0);
vertices[1].Color = Color.Red;
vertices[2].Position = new Vector3(200, 200, 0);
vertices[2].Color = Color.Black;
vertices[3].Position = new Vector3(100, 200, 0);
vertices[3].Color = Color.Red;

GraphicsDevice.DrawUserPrimitives<VertexPositionColor>(PrimitiveType.LineList, vertices, 0, 2); 
```

如果这对您有帮助，请玩得开心并投票。还请访问我从中获得的教程。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-09-19T14:53:31.057

好吧，你可以用一种非常简单的方式来做到这一点，而无需进入 3D 可怕的矢量内容。

只需创建一个快速纹理，例如：

`Texture2D SimpleTexture = new Texture2D(GraphicsDevice, 1, 1, false, SurfaceFormat.Color);`

然后使用该纹理画一条线：

`this.spriteBatch.Draw(SimpleTexture, new Rectangle(100, 100, 100, 1), Color.Blue);`

我希望这有帮助

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-11-13T15:32:26.533

我认为最简单的最好方法是获取一个白色像素的图像，然后将该像素拉伸成一个矩形，使其看起来像一条线

我做了一个线课，

```
class Line
{
    Texture pixel = ((set this to a texture of a white pixel with no border));
    Vector2 p1, p2; //this will be the position in the center of the line
    int length, thickness; //length and thickness of the line, or width and height of rectangle
    Rectangle rect; //where the line will be drawn
    float rotation; // rotation of the line, with axis at the center of the line
    Color color;

    //p1 and p2 are the two end points of the line
    public Line(Vector2 p1, Vector2 p2, int thickness, Color color)
    {
        this.p1 = p1;
        this.p2 = p2;
        this.thickness = thickness;
        this.color = color;
    }

    public void Update(GameTime gameTime)
    {
        length = (int)Vector2.Distance(p1, p2); //gets distance between the points
        rotation = getRotation(p1.X, p1.Y, p2.X, p2.Y); //gets angle between points(method on bottom)
        rect = new Rectangle((int)p1.X, (int)p1.Y, length, thickness)

        //To change the line just change the positions of p1 and p2
    }

    public void Draw(SpriteBatch spriteBatch, GameTime gameTime)
    {
        spriteBatch.Draw(pixel, rect, null, color, rotation, new Vector2.Zero, SpriteEffects.None, 0.0f);
    }

    //this returns the angle between two points in radians 
    private float getRotation(float x, float y, float x2, float y2)
    {
        float adj = x - x2;
        float opp = y - y2;
        float tan = opp / adj;
        float res = MathHelper.ToDegrees((float)Math.Atan2(opp, adj));
        res = (res - 180) % 360;
        if (res < 0) { res += 360; }
        res = MathHelper.ToRadians(res);
        return res;
    } 
```

希望这可以帮助

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-07-06T03:00:50.647

还有“manders”在CodePlex上放出的“圆线”代码：

*   [http://roundline.codeplex.com/](http://roundline.codeplex.com/)

这是关于它的博客文章：

*   [XNA RoundLine 代码在 CodePlex 上发布](http://blogs.msdn.com/manders/archive/2009/03/13/xna-roundline-code-released-on-codeplex.aspx)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-02-23T16:51:20.440

我想绘制光线，以便调试由爆炸产生的光线以及它们与对象相交的位置。这将在两点之间绘制一条像素细线。这就是我所做的：

类来存储一些简单的光线数据。XNA 默认光线类可以工作，但它不存储光线到相交的长度。

```
public class myRay
{
    public Vector3 position, direction;
    public float length;
} 
```

存储要绘制的光线的列表：

```
List<myRay> DebugRays= new List<myRay>(); 
```

创建一个 BasicEffect 并在 LoadContent 方法中使用所需的分辨率将其传递给“Matrix.CreateOrthographicOffCenter”投影。

然后在 draw 方法中运行它：

```
private void DrawRays()
{
    spriteBatch.Begin();

    foreach (myRay ray in DebugRays)
        {
            //An array of 2 vertices - a start and end position
            VertexPositionColor[] Vertices = new VertexPositionColor[2];
            int[] Indices = new int[2];

            //Starting position of the ray
            Vertices[0] = new VertexPositionColor()
            {
                Color = Color.Orange,
                Position = ray.position
            };

            //End point of the ray
            Vertices[1] = new VertexPositionColor()
            {
                Color = Color.Orange,
                Position = ray.position + (ray.direction * ray.length)
            };

            Indices[0] = 0;
            Indices[1] = 1;

            foreach (EffectPass pass in BasicEffect.CurrentTechnique.Passes)
            {
                pass.Apply();
                GraphicsDevice.DrawUserIndexedPrimitives(PrimitiveType.LineStrip, Vertices, 0, 2, Indices, 0, 1, VertexPositionColorTexture.VertexDeclaration);
            }
        }

    spriteBatch.End();
} 
```

因此，当我的游戏中发生爆炸时，它会这样做（伪代码）：

```
OnExplosionHappened()
{
    DebugRays.Clear()

    myRay ray = new myRay()
                    {
                        position = explosion.Position,
                        direction = GetDirection(explosion, solid),
                        //Used GetValueOrDefault here to prevent null value errors
                        length = explosionRay.Intersects(solid.BoundingBox).GetValueOrDefault()
                    };

    DebugRays.Add(ray);
} 
```

它非常简单（它可能看起来比实际复杂得多）并且很容易将它放入一个单独的类中，您无需再考虑。它还可以让您一次绘制很多线条。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-09-19T15:45:53.603

我自己也遇到了这个问题，并决定创建一个名为 LineBatch 的类。LineBatch 将绘制线条而不需要 spriteBatch 或点。课程如下。

```
public class LineBatch
{
    bool cares_about_begin_without_end;
    bool began;
    GraphicsDevice GraphicsDevice;
    List<VertexPositionColor> verticies = new List<VertexPositionColor>();
    BasicEffect effect;
    public LineBatch(GraphicsDevice graphics)
    {
        GraphicsDevice = graphics;
        effect = new BasicEffect(GraphicsDevice);
        Matrix world = Matrix.Identity;
        Matrix view = Matrix.CreateTranslation(-GraphicsDevice.Viewport.Width / 2, -GraphicsDevice.Viewport.Height / 2, 0);
        Matrix projection = Matrix.CreateOrthographic(GraphicsDevice.Viewport.Width, -GraphicsDevice.Viewport.Height, -10, 10);
        effect.World = world;
        effect.View = view;
        effect.VertexColorEnabled = true;
        effect.Projection = projection;
        effect.DiffuseColor = Color.White.ToVector3();
        cares_about_begin_without_end = true;
    }
    public LineBatch(GraphicsDevice graphics, bool cares_about_begin_without_end)
    {
        this.cares_about_begin_without_end = cares_about_begin_without_end;
        GraphicsDevice = graphics;
        effect = new BasicEffect(GraphicsDevice);
        Matrix world = Matrix.Identity;
        Matrix view = Matrix.CreateTranslation(-GraphicsDevice.Viewport.Width / 2, -GraphicsDevice.Viewport.Height / 2, 0);
        Matrix projection = Matrix.CreateOrthographic(GraphicsDevice.Viewport.Width, -GraphicsDevice.Viewport.Height, -10, 10);
        effect.World = world;
        effect.View = view;
        effect.VertexColorEnabled = true;
        effect.Projection = projection;
        effect.DiffuseColor = Color.White.ToVector3();
    }
    public void DrawAngledLineWithRadians(Vector2 start, float length, float radians, Color color)
    {
        Vector2 offset = new Vector2(
            (float)Math.Sin(radians) * length, //x
            -(float)Math.Cos(radians) * length //y
            );
        Draw(start, start + offset, color);
    }
    public void DrawOutLineOfRectangle(Rectangle rectangle, Color color)
    {
        Draw(new Vector2(rectangle.X, rectangle.Y), new Vector2(rectangle.X + rectangle.Width, rectangle.Y), color);
        Draw(new Vector2(rectangle.X, rectangle.Y), new Vector2(rectangle.X, rectangle.Y + rectangle.Height), color);
        Draw(new Vector2(rectangle.X + rectangle.Width, rectangle.Y), new Vector2(rectangle.X + rectangle.Width, rectangle.Y + rectangle.Height), color);
        Draw(new Vector2(rectangle.X, rectangle.Y + rectangle.Height), new Vector2(rectangle.X + rectangle.Width, rectangle.Y + rectangle.Height), color);
    }
    public void DrawOutLineOfTriangle(Vector2 point_1, Vector2 point_2, Vector2 point_3, Color color)
    {
        Draw(point_1, point_2, color);
        Draw(point_1, point_3, color);
        Draw(point_2, point_3, color);
    }
    float GetRadians(float angleDegrees)
    {
        return angleDegrees * ((float)Math.PI) / 180.0f;
    }
    public void DrawAngledLine(Vector2 start, float length, float angleDegrees, Color color)
    {
        DrawAngledLineWithRadians(start, length, GetRadians(angleDegrees), color);
    }
    public void Draw(Vector2 start, Vector2 end, Color color)
    {
        verticies.Add(new VertexPositionColor(new Vector3(start, 0f), color));
        verticies.Add(new VertexPositionColor(new Vector3(end, 0f), color));
    }
    public void Draw(Vector3 start, Vector3 end, Color color)
    {
        verticies.Add(new VertexPositionColor(start, color));
        verticies.Add(new VertexPositionColor(end, color));
    }
    public void End()
    {
        if (!began)
            if (cares_about_begin_without_end)
                throw new ArgumentException("Please add begin before end!");
            else
                Begin();
        if (verticies.Count > 0)
        {
            VertexBuffer vb = new VertexBuffer(GraphicsDevice, typeof(VertexPositionColor), verticies.Count, BufferUsage.WriteOnly);
            vb.SetData<VertexPositionColor>(verticies.ToArray());
            GraphicsDevice.SetVertexBuffer(vb);

            foreach (EffectPass pass in effect.CurrentTechnique.Passes)
            {
                pass.Apply();
                GraphicsDevice.DrawPrimitives(PrimitiveType.LineList, 0, verticies.Count / 2);
            }
        }
        began = false;
    }
    public void Begin()
    {
        if (began)
            if (cares_about_begin_without_end)
                throw new ArgumentException("You forgot end.");
            else
                End();
        verticies.Clear();
            began = true;
    }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-06-08T08:04:51.467

只需拉伸一个白色像素。

```
 point = game.Content.Load<Texture2D>("ui/point");

        public void DrawLine(Vector2 start, Vector2 end, Color color)
        {
            Vector2 edge = end - start;
            float angle = (float)Math.Atan2(edge.Y, edge.X);

            spriteBatch.Begin();
            spriteBatch.Draw(point,
                new Rectangle((int)start.X, (int)start.Y, (int)edge.Length(), 1),
                null, 
                color, 
                angle,
                new Vector2(0, 0),
                SpriteEffects.None,
                0);
            spriteBatch.End();
        } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-12-04T06:29:51.113

这是我用来通过指定开始坐标、结束坐标、宽度和颜色来制作线条的简单方法：

注意：您必须将一个名为“dot”的文件添加到内容目录（该行将由这些组成）。

```
using System;
using System.Collections.Generic;
using System.Linq;
using Microsoft.Xna.Framework;
using Microsoft.Xna.Framework.Audio;
using Microsoft.Xna.Framework.Content;
using Microsoft.Xna.Framework.GamerServices;
using Microsoft.Xna.Framework.Graphics;
using Microsoft.Xna.Framework.Input;
using Microsoft.Xna.Framework.Media;

namespace Xna.LineHelper
{
    public class LineManager
    {
        int loopCounter;
        int lineLegnth;
        Vector2 lineDirection;
        Vector2 _position;
        Color dotColor;
        Rectangle _rectangle;
        List<Texture2D> _dots = new List<Texture2D>();
        FunctionsLibrary functions = new FunctionsLibrary();

        public void CreateLineFiles(Vector2 startPosition, Vector2 endPosition, int width, Color color, ContentManager content)
        {
            dotColor = color;
            _position.X = startPosition.X;
            _position.Y = startPosition.Y;
            lineLegnth = functions.Distance((int)startPosition.X, (int)endPosition.X, (int)startPosition.Y, (int)endPosition.Y);
            lineDirection = new Vector2((endPosition.X - startPosition.X) / lineLegnth, (endPosition.Y - startPosition.Y) / lineLegnth);
            _dots.Clear();
            loopCounter = 0;
            _rectangle = new Rectangle((int)startPosition.X, (int)startPosition.Y, width, width);
            while (loopCounter < lineLegnth)
            {
                Texture2D dot = content.Load<Texture2D>("dot");
                _dots.Add(dot);

                loopCounter += 1;
            }

        }

        public void DrawLoadedLine(SpriteBatch sb)
        {
            foreach (Texture2D dot in _dots)
            {
                _position.X += lineDirection.X;
                _position.Y += lineDirection.Y;
                _rectangle.X = (int)_position.X;
                _rectangle.Y = (int)_position.Y;
                sb.Draw(dot, _rectangle, dotColor);
            }
        }
    }

    public class FunctionsLibrary
    {
        //Random for all methods
        Random Rand = new Random();

        #region math
        public int TriangleArea1(int bottom, int height)
        {
            int answer = (bottom * height / 2);
            return answer;
        }

        public double TriangleArea2(int A, int B, int C)
        {
            int s = ((A + B + C) / 2);
            double answer = (Math.Sqrt(s * (s - A) * (s - B) * (s - C)));
            return answer;
        }
        public int RectangleArea(int side1, int side2)
        {
            int answer = (side1 * side2);
            return answer;
        }
        public int SquareArea(int side)
        {
            int answer = (side * side);
            return answer;
        }
        public double CircleArea(int diameter)
        {
            double answer = (((diameter / 2) * (diameter / 2)) * Math.PI);
            return answer;
        }
        public int Diference(int A, int B)
        {
            int distance = Math.Abs(A - B);
            return distance;
        }
        #endregion

        #region standardFunctions

        public int Distance(int x1, int x2, int y1, int y2)
        {
            return (int)(Math.Sqrt((x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2)));
        }

        #endregion

    }
} 
```

# sql - 从数据库映射中删除

> ID：270148
> 
> 赞同：0
> 
> 时间：2008-11-06T20:35:20.370
> 
> 标签：sql, database

我有这 3 个表 + 数据：

**items** : itemId, itemName
data: 1, 我的物品一

**类别**：catId、catName
数据：1、我的猫一只。2、我的猫二

**地图**：mapId、itemId、catId

当您在类别“my cat one”中包含项目“my item one”时，您将 [1, 1, 1] 插入到地图中。当您将“我的项目一”添加到“我的猫二”时，您将 [2, 1, 2] 插入到地图中。现在假设我们改变主意，只想要“我的猫二”中的项目。这意味着我们需要知道该项目不再属于哪些类别并从地图中删除关联。为此采取的最有效的步骤顺序是什么？（我正在寻找一种可以超越这个简单示例的解决方案。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T20:40:37.627

假设您已经获得了“my cat two”的类别 ID 和“my item 1”的项目 ID：

```
DELETE FROM MAP WHERE ItemID = @MyItem1Id
                AND CatID <> @MyCat2Id 
```

如果您有一组要保留该项目的类别，您可以：

1.  从地图中删除该项目的所有内容，然后重新添加集合
2.  使用与上述类似的查询，但使用“AND CatID NOT IN [ ... ]”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T20:41:58.467

如果您决定某个项目只应属于新类别，则以下内容应该有效：

```
DELETE
     M
FROM
     Map M
WHERE
     M.itemid = @item_id AND
     M.catid <> @new_cat_id 
```

# sharepoint - PortalSiteMapProvider 导致过多的 SPRequest 对象

> ID：270161
> 
> 赞同：1
> 
> 时间：2008-11-06T20:37:54.637
> 
> 标签：sharepoint, navigation, portalsitemapprovider

我们有一个自定义导航 Web 部件，它使用 MOSS 的 PortalSiteMapProvider 来构建菜单导航。Provider 似乎没有管理它的对象。关于如何管理在 Provider 中创建的对象的任何想法？

它导致像这样的日志错误：

线程 1 上当前未释放的 SPRequest 对象 (9) 可能过多。确保正确处置此对象或其父对象（例如 SPWeb 或 SPSite）。此对象的分配 ID：{56D66DBA-AE72-42DF-A70F-B45E05A60A08} 当前分配的堆栈跟踪：
在 Microsoft.SharePoint.SPRequestManager.Add(SPRequest request, Boolean shareable)
at Microsoft.SharePoint.SPGlobal.CreateSPRequestAndSetIdentity(Boolean bNotGlobalAdminCode,在Microsoft.SharePoint.SPWeb.InitializeSPRequest
()
在 Microsoft.SharePoint.SPWeb.EnsureSPRequest()
在 Microsoft.SharePoint.SPWeb.get_Request()
在 Microsoft.SharePoint.SPWeb.InitWebPublic()
在 Microsoft.SharePoint.SPWeb.get_Exists()
在 Microsoft.SharePoint.Publishing.CachedObjectFactory.CreateWebFromUrl(String url)
在 Microsoft.SharePoint.Publishing.Navigation.SPNavigationSiteMapNode..ctor(PortalWebSiteMapNode webNode , SPNavigationNode 节点, PortalSiteMapNode parentNode, NodeTypes 类型, String url, String title, String description)
在 Microsoft.SharePoint.Publishing.Navigation.SPNavigationSiteMapNode.CreateSPNavigationSiteMapNode(PortalWebSiteMapNode webNode, SPNavigationNode 节点, PortalSiteMapNode parentNode)
在 Microsoft.SharePoint.Publishing.Navigation。 PortalWebSiteMapNode.ProcessSPNavigationNode（SPNavigationNode 节点，SPNavigationNode previousSibling，PortalSiteMapNode parentNode）
在 Microsoft.SharePoint.Publishing.Navigation.PortalWebSiteMap.Node.PopulateNavigationChildren()
在 Microsoft.SharePoint.Publishing.Navigation.PortalSiteMapNode.GetNavigationChildren（NodeTypes包括类型，NodeTypes包括HiddenTypes，OrderingMethod排序，AutomaticSortingMethod方法，布尔升序，Int32 lcid）
在微软。 SharePoint.Publishing.Navigation.PortalSiteMapNode.GetNavigationChildren(NodeTypes includedHiddenTypes)
在 Microsoft.SharePoint.Publishing.Navigation.PortalSiteMapProvider.GetChildNodes(PortalSiteMapNode 节点, NodeTypes includedHiddenTypes)
在 Microsoft.SharePoint.Publishing.Navigation.PortalSiteMapProvider.GetChildNodes(SiteMapNode 节点)
在 System .Web.SiteMapNode.get_ChildNodes()
在 Microsoft.SharePoint.Publishing.Navigation.PortalHierarchicalEnumerable.System.Collections.IEnumerable.GetEnumerator()
在 System.Web.UI.WebControls.Menu.DataBindRecursive（MenuItem 节点，IHierarchicalEnumerable 枚举）
在 System.Web.UI.WebControls.Menu。 DataBindRecursive(MenuItem node, IHierarchicalEnumerable enumerable)
at System.Web.UI.WebControls.Menu.DataBindItem(MenuItem item)
at System.Web.UI.WebControls.Menu.PerformDataBinding()
at System.Web.UI.WebControls.HierarchicalDataBoundControl.PerformSelect ()
在 System.Web.UI.WebControls.BaseDataBoundControl.DataBind()
在 System.Web.UI.WebControls.Menu.DataBind()
在 System.Web.UI.WebControls.BaseDataBoundControl.EnsureDataBound()
在 System.Web.UI.WebControls.Menu.EnsureDataBound()
在 System.Web.UI.WebControls.BaseDataBoundControl.OnPreRender(EventArgs e)
在 System.Web.UI.WebControls.Menu.OnPreRender(EventArgs e, Boolean registerScript)
在System.Web.UI.WebControls.Menu.OnPreRender(EventArgs e)
在 Microsoft.SharePoint.WebControls.AspMenu.OnPreRender(EventArgs e)
在 System.Web.UI.Control.PreRenderRecursiveInternal()
在 System.Web.UI.Control。 PreRenderRecursiveInternal()
在 System.Web.UI.Control.PreRenderRecursiveInternal()
在 System.Web.UI.Control.PreRenderRecursiveInternal()
在 System.Web.UI.Control.PreRenderRecursiveInternal() 在 System.Web.UI.Control.PreRenderRecursiveInternal(
) )
在 System.Web.UI.Control.PreRenderRecursiveInternal()
在 System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
在 System.Web.UI.Page.ProcessRequest(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
在 System.Web .UI.Page.ProcessRequest() 在 System.Web.UI.Page.ProcessRequestWithNoAssert(HttpContext context)
在 System.Web.UI.Page.ProcessRequest(HttpContext context) 在 ASP.VIEWPAGE_ASPX_2077083467.ProcessRequest(HttpContext context)
在 System.Web .HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously)
在 System.Web.HttpApplication.ApplicationStepManager.ResumeSteps（异常错误）
在 System.Web.HttpApplication.System.Web.IHttpAsyncHandler.BeginProcessRequest（HttpCont

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T21:58:07.160

[Stefan Goßner](http://blogs.technet.com/stefan_gossner/archive/2008/05/07/troubleshooting-spsite-spweb-leaks-in-wss-v3-and-moss-2007.aspx)的博客文章似乎回答了这个问题。问题不在于没有关闭 SPWeb 对象，而是一旦达到某个分配阈值（默认为 8），就会在日志中创建警告。根据您的站点结构，将创建的数量会有所不同。鉴于导航的嵌套性质，对象在遍历子树时保持打开状态。所以对象*被*正确处理，只是超过 8 个（默认情况下）在给定时间保持打开状态。

[看到这个问题](https://stackoverflow.com/questions/146841/why-does-my-out-of-the-box-sharepoint-navigation-look-like-it-is-leaking-memory)

# javascript - JQuery fadeIn fadeOut 与 setInterval 偶尔工作

> ID：270177
> 
> 赞同：2
> 
> 时间：2008-11-06T20:41:06.427
> 
> 标签：javascript, jquery

我有一堆图像需要每 2 秒一次使用花哨的 JQuery fadeIn 和 fadeOut 旋转进出一个。我有 HTML 中的所有图像来预加载它们和一个 setInterval 计时器，它使当前图像淡出，然后淡入下一个图像。问题是，有时当您在淡入/淡出过程中单击或滚动时， JS 被打断，当前图像永远不会消失，下一个会淡出给你两张图像。

我觉得这与 setInterval 不能每 2 秒正常运行有关，但是有没有更好的方法来完成我需要的？

这是一段代码：

HTML

```
<a href="javascript:;">
  <img id="img1" src="image1.gif" />
  <img id="img2" src="image2.gif" style="display:none;" />
  <img id="img3" src="image3.gif" style="display:none;" />
</a> 
```

JS

```
var numImages = 3;
var currentImage = 1;
imageInterval = window.setInterval("changeImage();", 2000);

function changeImage()
{
    $("#img" + currentImage).fadeOut("slow", function() {
        if (currentImage >= numImages)
        {
            currentImage = 0;
        }
        $("#img" + (currentImage + 1) ).fadeIn("slow", function() {
            currentImage++;
        });
    });
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-07T05:51:36.517

您是否考虑过使用[Cycle 插件](http://malsup.com/jquery/cycle/)？听起来这完全符合您的要求，并且提供了很大的灵活性。我自己使用过这个插件，效果很好。强烈推荐。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T21:00:21.723

就在我的脑海中......你为什么在回调函数中做 currentImage 簿记？在我看来这更容易，甚至可能与您的问题有关：

```
function changeImage()
{
    $("#img" + currentImage).fadeOut("slow");
    currentImage = (currentImage >= numImages) ? 1 : currentImage + 1;
    $("#img" + currentImage).fadeIn("slow");
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T21:10:31.437

您的问题是，如果您在 img2 完成淡入之前单击它，currentImage 仍然认为您正在处理 img1 和 img2 之间的过渡，但实际上 img2 现在是活动的，您正在等待 img3。

我认为吉姆的解决方案应该会让您满意。

作为免费蜜蜂，也可以考虑添加它以允许您添加更多图像而无需编辑脚本：

```
numImages = $("a > img").size(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T20:58:17.733

你有两次 id="img2" 。

你能不能简化 - 先计算当前和下一个 id。然后做你的 $().fadeOut() 和下一行 $().fadeIn() 并避免所有的功能复杂性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-06-07T15:50:17.740

还

```
setInterval (function () {
    $("img:eq(0)").fadeOut ("slow").next ("img").fadeIn ("slow");
}, 2000); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-06-15T07:57:33.950

我在使用基于[snook.ca 最简单的 jquery slideshow](http://snook.ca/archives/javascript/simplest-jquery-slideshow)的函数时遇到了类似的问题。（请参阅我的评论@tom）尽管无论我是否单击或滚动都会发生我的情况！

似乎在循环的第一次运行之后，时间变得一团糟，开始半淡入或淡出，然后直接跳入而没有淡出！我在 firebug 中观看 html 面板，发现 css 显示属性没有正确地从“块”设置回“无”，最终导致所有图像都`display:block`设置在它们上，而不管它们假定的淡入淡出状态。

我确实想知道这是否是一个时间问题，淡出速度被 setInterval 延迟弄乱了，从而导致了混合的触发顺序。如果是这种情况，那么我不知道如何解决它。

但是看到 css 行为后，我现在想知道这是否是 jQuery 实现它的“淡入”和“淡出”功能的方式中的一个潜在问题？？！！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-01-12T23:27:04.787

我给了你的代码一些解决方法，并想出了这段工作代码：

```
$(document).ready(() => {

let numImages = 4;
let currentImage = 1;

function changeImage() {
    $('#img-' + currentImage).fadeOut(1000, function() {
        if (currentImage === numImages) {
            currentImage = 0;
        }
        currentImage++;
        $('#img-' + currentImage).fadeIn(1000, function() {
            changeImage();
        });
    })
}

changeImage();

}) 
```

# c# - 我可以使用数组或其他可变数量的参数初始化 C# 属性吗？

> ID：270187
> 
> 赞同：114
> 
> 时间：2008-11-06T20:42:38.373
> 
> 标签：c#, attributes

是否可以创建一个可以用可变数量的参数初始化的属性？

例如：

```
[MyCustomAttribute(new int[3,4,5])]  // this doesn't work
public MyClass ... 
```

* * *

## 回答 #1

> 赞同：191
> 
> 时间：2008-11-06T20:51:14.050

属性将采用一个数组。虽然如果你控制属性，你也可以使用`params`（这对消费者来说更好，IMO）：

```
class MyCustomAttribute : Attribute {
    public int[] Values { get; set; }

    public MyCustomAttribute(params int[] values) {
       this.Values = values;
    }
}

[MyCustomAttribute(3, 4, 5)]
class MyClass { } 
```

您的数组创建语法恰好是关闭的：

```
class MyCustomAttribute : Attribute {
    public int[] Values { get; set; }

    public MyCustomAttribute(int[] values) {
        this.Values = values;
    }
}

[MyCustomAttribute(new int[] { 3, 4, 5 })]
class MyClass { } 
```

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2008-11-06T21:50:21.590

您可以这样做，但它不符合 CLS：

```
[assembly: CLSCompliant(true)]

class Foo : Attribute
{
    public Foo(string[] vals) { }
}
[Foo(new string[] {"abc","def"})]
static void Bar() {} 
```

显示：

```
Warning 1   Arrays as attribute arguments is not CLS-compliant 
```

对于常规反射的使用，最好有多个属性，即

```
[Foo("abc"), Foo("def")] 
```

但是，这不适用于`TypeDescriptor`/ `PropertyDescriptor`，其中仅支持任何属性的单个实例（第一次或最后一次获胜，我不记得是哪个）。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2008-11-06T20:49:50.387

尝试像这样声明构造函数：

```
public class MyCustomAttribute : Attribute
{
    public MyCustomAttribute(params int[] t)
    {
    }
} 
```

然后你可以像这样使用它：

`[MyCustomAttribute(3, 4, 5)]`

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-11-06T20:49:08.657

那应该没问题。从规范，第 17.2 节：

如果以下所有语句都为真，则表达式 E 是*属性参数表达式：*

*   E 的类型是属性参数类型（§17.1.3）。
*   在编译时， E 的值可以解析为以下之一：
    *   一个常数值。
    *   一个 System.Type 对象。
    *   *属性参数表达式*的一维数组。

这是一个例子：

```
using System;

[AttributeUsage(AttributeTargets.All, AllowMultiple = false, Inherited = true)]
public class SampleAttribute : Attribute
{
    public SampleAttribute(int[] foo)
    {
    }
}

[Sample(new int[]{1, 3, 5})]
class Test
{
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-06T20:48:45.757

是的，但是您需要初始化您传入的数组。这是我们单元测试中的一个行测试示例，它测试了可变数量的命令行选项；

```
[Row( new[] { "-l", "/port:13102", "-lfsw" } )]
public void MyTest( string[] args ) { //... } 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-06T20:50:49.027

你可以这样做。另一个例子可能是：

```
class MyAttribute: Attribute
{
    public MyAttribute(params object[] args)
    {
    }
}

[MyAttribute("hello", 2, 3.14f)]
class Program
{
    static void Main(string[] args)
    {
    }
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-03-18T14:39:50.970

要背负 Marc Gravell 的回答，是的，您可以使用数组参数定义属性，但应用具有数组参数的属性不符合 CLS。但是，仅使用数组属性定义属性就完全符合 CLS。

让我意识到这一点的是 Json.NET，一个符合 CLS 的库，有一个属性类 JsonPropertyAttribute 和一个名为 ItemConverterParameters 的属性，它是一个对象数组。

# sql - 跨 SQL 数据库查找唯一的表/列组合

> ID：270190
> 
> 赞同：2
> 
> 时间：2008-11-06T20:42:52.770
> 
> 标签：sql, sql-server

我有 4 个具有相似架构的数据库，我正在尝试创建一个查询以仅返回仅存在于数据库 1 中且不存在于数据库 2、3 或 4 中的表、列对。

目前我可以通过以下查询返回数据库 1 和 2 之间的对称差异...

```
select table_name, column_name from (
        select table_name, column_name from [Database1].information_schema.columns
        union all
        select table_name, column_name from [Database2].information_schema.columns) as tmp
        group by table_name, column_name having count(*) = 1 
```

但是，在尝试仅隔离数据库 1 中的那些列并在所有 4 个数据库中执行相同操作时，事情变得越来越复杂。这个查询最干净的解决方案是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T20:44:53.517

```
SELECT
     D1.table_name,
     D1.column_name
FROM
     Database1.information_schema.columns D1
LEFT OUTER JOIN Database2.information_schema.columns D2 ON
     D2.table_name = D1.table_name AND
     D2.column_name = D1.column_name
LEFT OUTER JOIN Database3.information_schema.columns D3 ON
     D3.table_name = D1.table_name AND
     D3.column_name = D1.column_name
LEFT OUTER JOIN Database4.information_schema.columns D4 ON
     D4.table_name = D1.table_name AND
     D4.column_name = D1.column_name
WHERE
     D2.table_name IS NULL AND
     D3.table_name IS NULL AND
     D4.table_name IS NULL 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T20:57:42.693

我可以一开始就想出这个，这可以是一个良好的开端。不过，这还没有经过测试，可能只是另一种选择：

```
select table_name, column_name from [Database1].information_schema.columns d1
where table_name || '+' || column_name
not in (select table_name || '+' || column_name from [Database2].information_schema.columns)

and table_name || '+' || column_name
not in (select table_name || '+' || column_name from [Database3].information_schema.columns)

and table_name || '+' || column_name
not in(select table_name || '+' || column_name from [Database4].information_schema.columns) 
```

# vim - 如何强制关键字在 VIM 编辑器中自动大写？

> ID：270192
> 
> 赞同：5
> 
> 时间：2008-11-06T20:43:04.533
> 
> 标签：vim, syntax, editor

有人知道如何编辑 VIM 的语法文件，以便关键字自动大写吗？我需要这样做以使我的编码风格与团队中的其他开发人员保持一致。

我正在使用 VIm 7.2 版（实际上是 gVIM），我使用的语法文件是 Progress.vim 文件（在 Syntax 目录下与 VIM 一起自动安装）。我对文件进行了一些调整，因为我不喜欢某些事情是如何完成的，但基本上是一样的。

TIA

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-06T20:48:45.023

尝试：

```
:help abbreviations 
```

例如：

```
:iab begin BEGIN 
```

现在，每当您键入“begin”时，它将被“BEGIN”替换。

# java - Eclipse 中的 Java：我应该将文件放在我想使用 getResource 加载的文件系统的什么位置？（例如 ImageIcon 的图像）

> ID：270197
> 
> 赞同：51
> 
> 时间：2008-11-06T20:43:55.640
> 
> 标签：java, eclipse, filesystems, imageicon

我知道该文件需要位于 getClass().getResource(filename) 可以找到它的位置，但我不知道那在哪里。

我对将文件放在文件系统本身的什么位置以及如何使用 Eclipse 的功能来设置资源都很感兴趣。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2008-11-06T21:40:10.300

对于 Eclipse，通常您需要做的就是在源代码目录中的某个位置设置一个文件夹。例如，如果包含您的源的目录是，`/src`那么您可以创建一个`/src/resources`文件夹来放置您的图像/文件。然后，在您的类中，您`getResource("/resources/image.png")`可以检索它。

如果您愿意，您还可以将图像/文件放在与尝试访问它的类相同的文件夹/包中（例如：将 image.png与需要访问它`com.mycompany`的类一起放在包中并调用），但我我们发现将图像和其他文件等资源保存在类文件夹之外的它们自己的特殊目录中更容易——它们只是更容易管理。`com.mycompany.Foo``getResource("image.png")`

在 Eclipse 中，每当您进行构建时，此资源目录中的文件将与您编译的类一起复制到您的构建目录中。

重要的是要注意，如果您在 Eclipse 中启用了“自动构建”（大多数人都这样做），那么此目录中的任何资源在 Eclipse 之外都会被更改（即您使用图像编辑工具编辑图像）IDE 可能不会始终检测到这种变化。通常在项目文件夹上进行刷新将确保文件在这些情况下在构建中得到更新。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-06T20:45:58.990

您可以将它们放在类旁边的 src 文件夹中，也可以为此目的创建一个新的源文件夹（通常称为*resources*），尽管您可以从代码中找到相同的位置。

然后你使用`getResource("/com/x/y/foo.png")`.

# intellisense - 如何在 C++ Builder 2009 中打开 Intellisense 和代码提示？

> ID：270218
> 
> 赞同：1
> 
> 时间：2008-11-06T20:47:49.640
> 
> 标签：intellisense, c++builder

我刚刚安装了 CodeGear Studio 2009，但没有找到可以放置 Intellisense 和代码提示的位置。

顺便说一句，在 Visual Studio 中，我们可以以相同的方式缩进选定的代码块。如何在 CodeGear 中使用类似的功能？

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T20:52:42.830

它被称为代码洞察力。我还没有 2009，但它可能与 2007 在同一个地方。查看**Tools > Options > Editor Options > Code Insight**。

顺便说一句，它远不如 VS 中的 Intellisense 好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T20:59:06.983

通用名称称为“代码完成”，智能感知和洞察力只是捕捉公司使用的营销名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T21:08:09.553

即使在打开所有 CodeInsight 点的情况下重新启动它后，我发现没有结果（（

# visual-studio-2008 - 如何使用 Visual Studio 2008 标准版运行测试项目？

> ID：270221
> 
> 赞同：6
> 
> 时间：2008-11-06T20:48:42.743
> 
> 标签：visual-studio-2008, unit-testing

我目前正在运行 Visual Studio 2008 标准版，他们为该版本删除的项目之一是单元测试功能。结果，当我打开像 MVC 商务测试这样的示例项目时，其中一个项目将无法加载，因为它不知道打开该类型的项目。

我知道我可以排除或删除该项目，并且我知道 TestDriven.NET，但是是否有 VS2008 Standard 的插件可以执行 VS2008 Pro 附带的单元测试？TestDriven.NET 会这样做，还是测试与 NUnit 测试有足够的不同以至于这不起作用？

**更新：**澄清一下，我很好奇是否有任何程序或插件可以*在 Visual Studio 2008*中运行测试项目。TestDriven.NET 无法加载或运行或允许 VS2008 打开测试项目，并且 Gallio 无法在 VS2008 IDE 中运行（尽管我非常感谢这些建议）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-06T20:58:02.960

按照Richard Dingwall的[这篇博](http://richarddingwall.name/2008/09/26/gallio-the-framework-agnostic-test-runner-for-net/)文中的最佳说明尝试[Gallio ，对于 Visual Studio 支持，请使用](http://www.gallio.org/)[TestDriven.Net](http://www.testdriven.net/)运行它。

[此 Google Groups 帖子](http://groups.google.com/group/gallio-dev/browse_thread/thread/8c880aa0a963244d)中也提供了一些信息。

* * *

来自加里奥的网站：

> 目前，Gallio 可以**从**MbUnit 版本 2 和 3、**MSTest**、NBehave、NUnit、xUnit.Net 和 csUnit 运行测试。Gallio 提供工具支持和**与**CCNet、MSBuild、NAnt、NCover、Pex、Powershell、Resharper、**TestDriven.Net**、TypeMock 和 Visual Studio Team System 的集成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T20:54:01.300

TestDriven.NET 可以运行 NUnit、xUnit.NET 和 MSTest。虽然它不是免费的，但非常值得。从[http://www.testdriven.net/overview.aspx](http://www.testdriven.net/overview.aspx)：

> 支持多种单元测试框架，包括 NUnit、MbUnit 和 MS Team System。

# asp.net - <%# Eval("State") %> 或 <%# DataBinder.Eval(Container.DataItem, "state")%>

> ID：270230
> 
> 赞同：38
> 
> 时间：2008-11-06T20:51:13.113
> 
> 标签：asp.net, data-binding, eval

和有什么区别

```
<%# Eval("State") %> 
```

在您的`aspx`页面中，而不是

```
<%# DataBinder.Eval(Container.DataItem, "State") %> 
```

在你的`aspx`页面？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-11-06T20:58:48.123

`Eval("State")`是`DataBinder.Eval(Container.DataItem, "State")`语法的简化形式。它仅适用于数据绑定模板控件。

有关详细信息，请参阅[MSDN 文档](http://msdn.microsoft.com/en-us/library/ms178366.aspx)。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-06T20:56:42.383

没有区别。"Eval" 方法只是 DataBinder.Eval(Container.DataItem, "blah") 方法的快捷方式。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-01-31T10:53:41.230

尽管[文档](https://msdn.microsoft.com/en-us/library/ms178366.aspx#Anchor_1)指出使用（确切地说）实际上是调用并且他们的任务是做完全相同的工作，但它们之间`<%# Eval %>`还是存在很多差异。`<%# DataBinder.Eval %>``Eval``TemplateControl.Eval``DataBinder.Eval`

这是正确的，但使用只是`Eval`意味着 ASP.NET 本身会解析数据绑定的对象。它在内部使用堆栈执行此操作，在`Control.DataBind()`调用时添加项目。诀窍是只有当`Page`控件的属性在该点是非时才会发生这种情况`null`。

如果-managed 堆栈在您到达需要解决`Page`的点时不是最新的，则该方法将给出异常并显示如下消息`DataItem``Page.GetDataItem()`

> 诸如 、 和 等数据绑定方法`Eval()`只能`XPath()`在`Bind()`数据绑定控件的上下文中使用。

`DataBinder.Eval`在这些情况下仍然有效，因为您手动为其提供了目标对象，因此 ASP.NET 不需要自己进行任何解析。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-06T20:57:23.337

Eval 方法只是后者的一个捷径

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2012-12-10T16:56:51.403

我看过以下代码

```
<%# (DataBinder.Eval(Container.DataItem, "ApplicationId").ToString() == "-1" ? "N/A" : Eval("ApplicationId").ToString()) %> 
```

所以我猜他们略有不同。

# c++ - 帮助获得 QTP 以识别控件

> ID：270250
> 
> 赞同：1
> 
> 时间：2008-11-06T20:58:19.840
> 
> 标签：c++, qtp, hwnd

我们正在尝试使用 QTP (QuickTest Professional) 来自动测试旧版 C++ 应用程序。

但是，应用程序的主窗口由几个相同的面板组成。每个面板都有一个唯一的标题。

如果我在 Spy++（DevStudio 附带）中查看窗口，我会看到：

```
+ Window <hwnd> "Window Title" taskwindowclass
  + Window <hwnd> "Panel A" childwindowclass
    + Window <hwnd> "OK" Button
  + Window <hwnd> "Panel B" childwindowclass
    + Window <hwnd> "OK" Button 
```

然而，在 QTP 的 Object Spy 中，层次结构显示为：

```
+ Window: Window Title
  + WinButton: OK 
```

它甚至没有显示有一个中间面板。

有人知道获取窗口“路径”以识别每个控件的方法吗？即控制标识为：

```
Button A: "Window Title/Panel A/OK"
Button B: "Window Title/Panel B/OK" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T17:05:34.570

您可以使用描述性编程来绕过对象映射。QTP 默认会忽略面板对象。您可以尝试动态获取对面板对象的引用，然后搜索 ChildObjects 集合以找到确定按钮。另一种选择可能是简单地将序号标识符添加到确定按钮。

*   按钮 A：“窗口标题/确定索引 #1”
*   按钮 B：“窗口标题/确定索引 #2”

# php - 发送脚本后是否有一些输入 ID 或表单名称列表？

> ID：270260
> 
> 赞同：1
> 
> 时间：2008-11-06T21:00:40.893
> 
> 标签：php, html, forms, numbers, input

让我们想象一下我得到了这个：

index.php 生成的表单具有不可预测的输入数量，这些输入具有某些 ID/名称和不同的值，可以由用户编辑并由 script.php 保存

```
<form action="script.php" method="post">
<input id="1" name="1" type="text" value="1"/>
<input id="24" name="24" type="text" value="2233"/>
<input id="55" name="55" type="text" value="231321"/>
</form> 
```

脚本.php：

在这里，我需要获取类似于 index.php 生成的所有输入的数组，并保存与其 id/name 对应的每个值。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T21:07:01.570

我可能在您的问题中遗漏了某些内容，但该`$_POST`变量将包含您要求的所有名称 => 值对。例如，在您上面的 HTML 片段中：

```
print_r($_POST);

// contains:

array
(
  [1] => 1
  [24] => 2233
  [55] => 231321
)

// example access:

foreach($_POST as $name => $value) {
  print "Name: {$name} Value: {$value} <br />";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T21:08:55.230

在 script.php 中的 $_POST 变量上使用 array_keys 来提取您创建的名称并使用它们来获取值。

```
$keys = array_keys( $_POST );
foreach( $keys as $key ) {
  echo "Name=" . $key . " Value=" . $_POST[$key];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T21:08:15.607

听起来您正在使用类或框架来生成表单，您需要阅读框架的文档以查看它是否/在哪里收集这些数据。

# c# - 转换为 int16、int32、int64 - 你怎么知道该选择哪一个？

> ID：270263
> 
> 赞同：8
> 
> 时间：2008-11-06T21:02:07.773
> 
> 标签：c#, integer, typeconverter

我经常必须转换一个检索到的值（通常作为一个字符串） - 然后将它转换为一个 int。但是在 C# (.Net) 中，您必须选择 int16、int32 或 int64 - 当您不知道检索到的数字有多大时，您怎么知道该选择哪一个？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-06T21:16:02.410

这里提到声明 Int16 保存 ram 的每个人都应该投反对票。

您的问题的答案是使用关键字“int”（或者如果您愿意，请使用“Int32”）。

这为您提供了多达 24 亿个数字的范围……此外，32 位处理器将更好地处理这些整数……而且（也是**最重要的原因**）是，如果您打算出于任何原因使用该整数……它可能需要是一个“int”（Int32）。

在 .Net 框架中，99.999% 的数字字段（即整数）是“整数”（Int32）。

示例：Array.Length、Process.ID、Windows.Width、Button.Height 等 100 万次。

编辑：我意识到我的脾气暴躁会让我投票失败......但这是正确的答案。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-06T21:12:55.630

只是想补充一点……我记得在 .NET 1.1 时代，编译器已经过优化，因此**“int”操作实际上比字节或短操作更快。**

我相信它今天仍然有效，但我现在正在进行一些测试。

* * *

编辑：我有一个惊喜发现：short(s) 的加法、减法和乘法运算实际上返回 int！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-06T21:17:47.553

反复尝试 TryParse() 没有意义，您已经声明了一个字段。除非您将该字段设置为 Object 类型，否则您无法改变主意。不是一个好主意。

该字段表示的任何数据都具有物理意义。这是一个年龄、一个大小、一个计数等。物理量对其范围有实际的限制。选择可以存储该范围的 int 类型。不要试图修复溢出，这将是一个错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-07T19:04:38.573

与当前最流行的答案相反，较短的整数（如 Int16 和 SByte）通常比较大的整数（如 Int32 和 Int64）占用更少的内存空间。您可以通过实例化 sbyte/short/int/long 的大型数组并使用 perfmon 测量托管堆大小来轻松验证这一点。确实，许多 CLR 风格会在对它们进行算术运算时为特定于 CPU 的优化扩展这些整数，但是当作为对象的一部分存储时，它们只占用必要的内存。

因此，您绝对应该考虑大小，特别是如果您将使用大型整数列表（或使用包含整数字段的大型对象列表）。您还应该考虑诸如 CLS-compliance 之类的事情（它不允许公共成员中有任何无符号整数）。

对于像将字符串转换为整数这样的简单情况，我同意 Int32 (C# int) 通常最有意义，并且可能是其他程序员所期望的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T21:03:21.827

如果我们只是在谈论几个数字，那么选择最大的不会对您的整体 ram 使用产生显着影响，并且会起作用。如果你在谈论很多数字，你需要对它们使用 TryParse() 并找出最小的 int 类型，以节省 ram。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T21:06:07.827

所有计算机都是有限的。您需要根据您认为用户的需求来定义上限。

如果您确实没有上限并且希望允许“无限”值，请尝试将 .Net Java 运行时库添加到您的项目中，这将允许您使用 java.math.BigInteger 类 - 它在几乎无限大小上进行数学运算整数。

注意：.Net Java 库带有完整的 DevStudio，但我不认为它们带有 Express。

# html - 如何让 VS HTML 编辑器默认为单引号？

> ID：270264
> 
> 赞同：9
> 
> 时间：2008-11-06T21:02:13.387
> 
> 标签：html, visual-studio, editor, autocomplete, intellisense

Visual Studio HTML 编辑器中的自动完成功能会插入双引号（例如`<input type="text"`）。

有谁知道是否有一个设置会更改默认值以自动插入单引号（例如`<input type='text'`）？

谢谢，迈克尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T21:27:01.123

Visual Studio 中没有内置选项来执行此操作。可能有第三方插件可以帮助您，但如果是这样，我不熟悉它。

# java - 如何解压缩字节数组中的压缩数据？

> ID：270268
> 
> 赞同：6
> 
> 时间：2008-11-06T21:04:33.133
> 
> 标签：java, io, gzipinputstream

我有一个类，它有一个接收对象作为参数的方法。此方法通过 RMI 调用。

```
public RMIClass extends Serializable {
    public RMIMethod(MyFile file){
        // do stuff
    }
} 
```

MyFile 有一个名为“body”的属性，它是一个字节数组。

```
public final class MyFile implements Serializable {

    private byte[] body = new byte[0];
    //.... 

    public byte[] getBody() {
        return body;
    }
    //....
} 
```

此属性保存由另一个应用程序解析的文件的 gzip 压缩数据。

在使用它执行进一步操作之前，我需要解压缩这个字节数组。

我看到的所有解压缩 gzip 数据的示例都假设我想将其写入磁盘并创建一个物理文件，但我没有这样做。

我该怎么做呢？

提前致谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-06T21:10:47.817

用[ByteArrayInputStream](http://java.sun.com/javase/6/docs/api/java/io/ByteArrayInputStream.html)包装字节数组并将其输入[GZipInputStream](http://java.sun.com/javase/6/docs/api/java/util/zip/GZIPInputStream.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T21:09:20.690

查看这些示例，无论它们在何处使用 FileOutputStream，都请改用 ByteArrayOutputStream。无论他们在哪里使用 FileInputStream，请改用 ByteArrayInputStream。其余的应该很简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T21:06:48.603

为什么不创建自己的扩展**OutputStream**的类，或者归档写入的内容是什么？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-05-16T14:14:53.780

If you want to write to a ByteBuffer you can do this.

```
private static void uncompress(final byte[] input, final ByteBuffer output) throws IOException
    {
        final GZIPInputStream inputGzipStream = new GZIPInputStream(new ByteArrayInputStream(input));
        Channels.newChannel(inputGzipStream).read(output);
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-01-17T22:27:54.933

JDK 9+

```
 private byte[] gzipUncompress(byte[] compressedBytes) throws IOException {
    try (InputStream inputStream = new GZIPInputStream(new ByteArrayInputStream(compressedBytes))) {
      try (ByteArrayOutputStream outputStream = new ByteArrayOutputStream()) {
        inputStream.transferTo(outputStream);
        return outputStream.toByteArray();
      }
    } 
```

}

# java - 从 Jaxb 1 更新到 Jaxb 2

> ID：270282
> 
> 赞同：3
> 
> 时间：2008-11-06T21:08:36.480
> 
> 标签：java, xml, jaxb

我希望将我们项目的 jaxb 版本从 1 更新到 2。有没有人尝试在他们的项目上这样做，是否有任何人想要这样做的提示？我知道每个项目都是独一无二的，我只是在寻找一般提示。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-08T07:05:17.183

JAXB2 将为简单类型限制生成枚举类。任何依赖于设置字符串值来使用这些类型的 Java 代码都需要您使用适当的枚举来代替。我认为这很好，因为您在编译时得到类型检查，而不是在运行时得到验证警告。

JABX2 使用类型化列表而不是非类型化列表，因此您可以从 Java 代码中删除大量强制转换。

日期支持得到很大改善。IIRC，JAXB1 中的大多数日期类型生成日历，而在 JAXB2 中它们生成 XMLGregorianCalendar。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-05T20:26:50.547

今天我正在阅读有关 JAXB 1 的教程，并尝试使用 JAXB 2.1（包含在 JavaSE 6 中）编译示例。XSD 中的元素使用了未命名的类型，例如：

```
<xs:element name="logging">
        <xs:complexType>
                <xs:attribute name="debug" type="xs:boolean" use="required"/>
                <xs:attribute name="file" type="xs:string" use="required"/>
        </xs:complexType>
</xs:element> 
```

就我所见，JAXB 1.0 生成了一个 Logging 类和一个 LoggingType 类（指的是未命名的日志元素类型），而 JAXB 2 只生成了一个 Logging 类。这在这个例子的所有标签上经常发生，所以我猜在这种情况下这种情况经常发生。但是，删除“Type”后缀即可修复编译，无需进行任何其他更改。

# iis - 是否可以使 IIS 上的站点的一部分只能从本地主机查看？

> ID：270284
> 
> 赞同：24
> 
> 时间：2008-11-06T21:08:48.320
> 
> 标签：iis, localhost

我们有一个运行 IIS 的网络服务器。我们可能想运行一个共享博客或其他东西来跟踪信息。由于安全问题，我们希望该部分只能从本地主机查看，因此人们必须远程访问才能使用它。

所以，重复我的问题，网站的一部分是否只能从本地主机查看？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2014-03-22T09:23:44.113

对于有人在`IIS 8`/`Windows 2012`

1) 在`Server Manager`, , `Manage, Add Roles and Features`, Next, Next (get to `Server Roles`), 向下滚动到`Web Server (IIS)`, 展开该行, 然后展开`Web Server`, 最后展开`Security`。确保安装了**IP 和域限制**。

2) 在`IIS Manager`中，深入到您要保护的文件夹并左键单击选择它。在该`Features View`文件夹中选择**IP 和域限制**在`Actions`选择`Edit Feature Settings`. 更改`'Access for unspecified clients:'`为`'Deny'`然后确定。

`'Add Allow Entry'`3)最后进入`Action`s 菜单。输入服务器的特定 IP 地址。

现在只允许来自您的服务器的请求访问。或任何共享该 IP 地址的服务器。因此，在一个小型网络中，办公室可以在该办公室的所有 PC 之间共享 IP 地址，因此所有这些 PC 都可以访问该文件夹。

最后但同样重要的是要记住，如果您的网络有一个动态 IP 地址，那么如果该 IP 发生更改，您将向现在使用该 IP 的任何人公开您的博客管理文件夹。此外，该新 IP 地址上的每个人都将无法访问您的该文件夹...

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-06T21:36:20.637

在 IIS6 中，您可以调出 Web 的属性并单击目录安全选项卡。单击选项卡中间的按钮以编辑 IP 和域限制。在此选项卡上将所有计算机设置为拒绝，然后为要允许访问此站点的 IP 添加例外。

我不确定如何在 IIS7 上配置它。我看了但找不到它，如果我找到它，我会编辑这个答案。

编辑：[配置 IIS7](http://technet.microsoft.com/en-us/library/cc772206.aspx)

*   乔什

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-10-05T09:59:51.360

您还可以使用绑定而不是 IP 限制。如果您编辑要限制访问的网站的绑定，您可以选择该网站可用的 IP 地址。如果您将 IP 地址设置为 127.0.0.1，则站点仅响应此 IP 地址，而此 IP 地址当然只能在机器本地工作。

我已经使用 IIS 8.5 对此进行了测试。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-06-17T08:59:45.773

如果有人希望在命令行上执行此操作，这似乎适用于 IIS 7+

```
%windir%\system32\inetsrv\appcmd.exe set config "Default Web Site" -section:system.webServer/security/ipSecurity /+"[ipAddress='0',allowed='False']" /commit:apphost
%windir%\system32\inetsrv\appcmd.exe set config "Default Web Site" -section:system.webServer/security/ipSecurity /+"[ipAddress='127.0.0.1',allowed='True']" /commit:apphost 
```

[参考](http://www.iis.net/configreference/system.webserver/security/ipsecurity/add)

我最初想在 web.config 中执行此操作以简化分发，看起来以下可能有效：

```
<security>
    <ipSecurity allowUnlisted="false">    <!-- this line blocks everybody, except those listed below -->                
        <clear/> <!-- removes all upstream restrictions -->
        <add ipAddress="127.0.0.1" allowed="true"/>    <!-- allow requests from the local machine -->
    </ipSecurity>
</security> 
```

但是由于无论如何您都需要在中央 IIS 配置中解锁该功能，因此直接使用第一个命令进行更改没有任何优势。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-06T22:23:23.973

我同意使用 IIS“目录安全”来阻止除 127.0.0.1 (localhost) 之外的所有 IP 地址的建议。

也就是说，我想知道这种要求用户远程访问的策略如何可能**更**安全。使用标准 IIS 身份验证机制而不是管理服务器计算机上的 Windows 角色和权限不是更安全（也更简单）吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T21:14:56.763

如果未经授权的用户尝试访问它，具体取决于您想要发生的事情。

您可以尝试将特定部分设置为虚拟目录，然后拒绝匿名用户查看。但是，将提示他们登录，如果他们可以登录，那么他们可以看到它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-06T21:18:37.847

从 IIS MMC 中的选项来看，您还可以让虚拟目录只能由某些 IP 范围访问。您可以屏蔽除 127.0.0.1 以外的所有人。但是，我还没有尝试过。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-06T22:05:07.100

您可以授予或拒绝从特定 IP 对站点或文件夹的访问权限。在 IIS 中，进入相关站点或文件夹的属性。

(1) 点击“目录安全”选项卡

(2) 单击“IP 地址和域名限制”框下的编辑。

(3) 单击“拒绝访问”（这告诉 IIS 阻止除您列出的 IP 之外的所有 IP）

(4) 点击“添加...”

(5) 点击“单机”

（6）输入127.0.0.1（localhost的IP）

请注意，最好在此处使用 IP（正如我所描述的）而不是域名，因为可以使用 hosts 文件轻松伪造域。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-10-28T08:03:56.960

正如[https://stackoverflow.com/a/39870955/2279059](https://stackoverflow.com/a/39870955/2279059)中所建议的，可以将站点的绑定配置为仅在环回接口上侦听。这使得该站点无法从网络访问，而无需使用 IP 地址限制。

要同时支持 IPv4 和 IPv6，请添加两个绑定，一个 for`127.0.0.1`和一个 for `[::1]`，并将主机名设置为`*`，以便 IP 地址或`localhost`可用于访问它，如屏幕截图所示：

[![在此处输入图像描述](https://i.stack.imgur.com/uF2ms.jpg)](https://i.stack.imgur.com/uF2ms.jpg)

要以编程方式添加“本地”站点，您可以使用：

```
appcmd add site /name:MyLoalSite /bindings:http/127.0.0.1:7103:*,http/[::1]:7103:* /physicalPath:"C:\path\to\site\" 
```

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2008-11-06T21:18:15.867

您可以简单地将这个 .NET 添加到页面顶部。

```
string MyWebServerName = currentContext.Request.ServerVariables["SERVER_NAME"];

if ( MyWebServerName == "127.0.0.1" || MyWebServerName == "localhost" )
{
  // the user is local 
}
else
{
  // the user is NOT local
} 
```

# asp.net - 以编程方式编辑 Web.config

> ID：270287
> 
> 赞同：14
> 
> 时间：2008-11-06T21:09:46.120
> 
> 标签：asp.net, vb.net, web-config

以编程方式编辑 Web.config 文件的好方法是什么？

我查看了 System.Xml 但找不到任何明显的答案。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-06T21:22:59.290

如果您仍然想在所有警告之后这样做，[这个家伙会显示示例代码：](http://www.dotnetspider.com/resources/17562-Edit-Delete-Create-Encrypt-sections.aspx)

```
protected void EditConfigButton(object sender, EventArgs e)
{
   Configuration objConfig = System.Web.Configuration.WebConfigurationManager.OpenWebConfiguration("~");
   AppSettingsSection objAppsettings = (AppSettingsSection)objConfig.GetSection("appSettings");
   //Edit
   if (objAppsettings != null)
   {
      objAppsettings.Settings["test"].Value = "newvalueFromCode";
      objConfig.Save();
   }
} 
```

编辑 web.config 的一个正当理由是对其进行加密，这就是那篇文章的内容。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-06T21:17:23.140

您可以使用 WebConfigurationManager 来读取特定的配置部分。这将返回一个 ConfigurationSection 对象。您可以使用它来读取/修改该部分中的 ConfigurationElements。更新它们后，您可以保存 ConfigurationSection，它将使用您的更改更新文件。

如果它们尚未加密，我使用它来自动加密 Application_Start 上的 appSettings 和 connectionStrings。我实际上并没有以这种方式更改任何设置，但您似乎应该能够这样做。

保存更新的配置文件可能会导致应用程序根据其构建方式进行回收。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T21:13:13.490

根据您在做什么，该方法在每种情况下确实有点不同。然而，最可靠的方法是将其加载为 XmlDocument 并通过该方法根据需要对其进行修改，但您必须小心仅以所需的方式对其进行修改。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-06T21:17:39.113

理论上; 您可以通过编程方式生成一个 Web 配置文件，并使用一些模板使其变得容易。

但是，如果您尝试从站点内编辑 web.config；**强烈**建议您不要这样做。至少；每次更新时都会触发应用程序重置；如果您使用进程内会话，这将特别糟糕。

正如安德斯所问的，你想做什么？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-06T21:17:35.977

是的，我同意乔希的观点。我以前试过这个，我有两个负面影响：

1.  如果在回发后当前页面加载缓慢，因为 ASP.NET 正在加载 web.config 和所有相关资源
2.  如果您在加载周期中足够早地更改 web.config（例如 global.asax 事件），则站点可能永远不会以不可预知的方式加载或失败

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-20T22:41:03.303

同意其他人的观点，编辑 webconfig 是可以实现的，但具有连锁反应只是危险/涉及风险

如果它是特定于应用程序的值，那么它应该在特定于应用程序的配置文件中

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-07-04T02:48:40.227

很多时候你想在部署后修改应用程序特定的设置，比如说当出现问题时，例如切换数据库连接以防当前数据库出现故障。此外，有时您想创建自己的基于 XML 的配置文件，您希望以编程方式对其进行修改。

试试 XML Webpad - [http://xmlwebpad.codeplex.com/](http://xmlwebpad.codeplex.com/)

它是一个查看编辑 XML 文件的框架。一旦你将它与你的 web 应用程序集成，编辑 web.config 就像查看 web.config 页面一样简单，进行所需的更改并点击保存按钮（全部来自你的应用程序）。

# asp.net - 您可以在 IIS 6 中启用 HTTP 压缩而不重新启动 IIS 吗？

> ID：270288
> 
> 赞同：2
> 
> 时间：2008-11-06T21:10:24.090
> 
> 标签：asp.net, iis-6, http-compression

我目前正在优化我公司网站的性能；当下载 2MB 以上的主页和资产需要 6-10 秒时（该网站主要是 Flash，有很多媒体，所以它不是 2MB 的 HTML 和视图状态）。有很多事情需要做才能减小这个下载大小。但我绝对想做的一件事是启用 HTTP 压缩来压缩我们的静态内容，特别是 XML、CSS 和 JS；我不认为压缩对 SWF 和 JPG 有多大作用。

我只想在我们的登台站点上启用它，这样我就可以进行一些服务器测试和基准测试。这意味着我将不得不进行一些元数据库编辑，因为 IIS 6 不允许您通过 IIS 管理器在单个站点上设置压缩。问题是元数据库被 IIS 锁定，所以我无法保存；即使我保存了编辑，我也需要重新启动 IIS 才能使更改生效；这将关闭同一服务器上托管的其他实时站点。无论如何都可以在不重新启动 IIS 的情况下为一个站点启用压缩？我不介意重新启动我们的临时站点；我只是不希望这项工作破坏服务器上的其他站点。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-06T21:14:02.973

您确实意识到 IISRESET 可以在几秒钟内发生，而且它可能非常快，以至于用户请求只会“挂起”，直到服务器响应。

唯一不好的部分是，如果他们使用服务器会话，这些会话可能会丢失。

您应该启用 HTTP 压缩，这通常是一件好事，在当今的服务器中，您很少使用任何大量的 CPU 使用率，因此压缩 HTTP 输出的小任务将为您节省更多带宽，而不是 CPU 时间。

我还应该提一下，无论是谁在创建您的 Flash 文件，都是错误的，Flash 开发人员需要流式传输 Flash 组件，而不是在第一页视图上提供每一个图形、声音和动画。没有理由任何 Flash 首页应该超过 100k。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T21:46:47.073

您是否选中了“启用直接元数据库编辑”？如果是这样，您应该能够编辑元数据库，并且当文件保存时，IIS 将自动拾取大部分更改。[更多细节在这里](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/1d1e5de4-fd63-40cd-bc5d-c20521548eed.mspx?mfr=true)

您还可以使用 adsutil.vbs 启用压缩。[此处](http://weblogs.asp.net/owscott/archive/2004/01/12/57916.aspx)和[此博客文章](http://www.codinghorror.com/blog/archives/000059.html)的评论中有示例。

```
cscript C:\Inetpub\AdminScripts\adsutil.vbs set w3svc/site#/root/DoStaticCompression False
cscript C:\Inetpub\AdminScripts\adsutil.vbs set w3svc/site#/root/DoDynamicCompression False 
```

# windows - 在 Windows 上找到 Apache 服务器的路径

> ID：270292
> 
> 赞同：1
> 
> 时间：2008-11-06T21:11:04.197
> 
> 标签：windows, apache, batch-file, scripting

对于我正在编写的 Windows 脚本，我需要检测机器是否安装了 Apache 2.2，并找到应用程序路径。

我想出的一种解决方案是 wget [http://localhost:8080/server-info](http://localhost:8080/server-info)并从中解析根目录和配置文件。如果服务器不使用端口 8080，这将失败

另一种选择是调用“sc qc Apache2.2”并解析返回的字符串。如果服务器没有作为服务安装，或者使用不同的名称，这将失败。

有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T21:23:11.113

如果他们不使用安装程序安装它，那么没有很多好的选择。如果他们使用 MSI/安装程序，您可以检查注册表：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Apache Software Foundation\Apache\2.2.2\ServerRoot 
HKEY_CURRENT_USER\SOFTWARE\Apache Software Foundation\Apache\2.2.2\ServerRoot 
```

您还可以查看正在运行的进程列表：

```
WMIC PROCESS get Caption,Commandline,Processid 
```

寻找合适的EXE。如果出于某种原因您需要端口号，则使用 netstat 并搜索适当的端口。

另外，当您说“Windows 脚本”时，我假设您使用的是现代且功能强大的东西，例如[Windows Scripting Host](http://msdn.microsoft.com/en-us/library/9bbdkx3k(VS.85).aspx)（我最喜欢的）或[PowerShell](http://www.microsoft.com/windowsserver2003/technologies/management/powershell/default.mspx)。甚至不用处理批处理文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T21:20:32.087

我记得，Apache 编写了一些注册表项。如果您知道如何从脚本中读取它们，那可能会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-01-03T14:01:39.230

紫外线桌面

在服务器上找不到路径。

尝试将 index.php 放在帮助台安装的站点 url 之后，或者如果您使用的是 apache，请确保启用 mode_rewrite 模块，并且在服务器的配置文件中将文档根目录的 AllowOverride 指令设置为 All/FileInfo。`[enter code here][1]`

# asp.net - 黑莓浏览器 ASP.Net 点击事件

> ID：270294
> 
> 赞同：1
> 
> 时间：2008-11-06T21:11:25.070
> 
> 标签：asp.net, blackberry

我有一个小页面，可以从 BB 查看。这是我的两个问题：

1.  如果我“单击”链接以提交页面，则会收到以下错误：“JavaScript：执行脚本时出错。” 我可以告诉我的 BB 模拟 Microsoft IE 浏览器，但我没有收到此错误。我希望不要使用这个选项，因为我怀疑我的用户能够解决这个问题。

2.  我有一个面板，里面有一个文本框和一个按钮。我将面板的 DefaultButton 属性设置为按钮，因此当有人按下回车按钮时，它会触发按钮的单击事件。当我在我的 BB 上按 Enter 键时，它会重新加载页面。有谁知道为什么以及如何解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T21:36:31.650

黑莓对 Javascript 的支持不是很好，尤其是运行旧软件的 BB。

对于#1，您的站点正在输出两组不同的 HTML。仅将浏览器类型设置为黑莓根本不会影响其渲染引擎，它只是发送一个不同的标头，使 asp.net 认为客户端正在运行 IE，因此它正在发送不同的 html/javascript。

对于#2，我认为 BB 不会做你想做的事。它正在提交表单但未正确设置事件目标。将表单处理逻辑移动到 isPostback if 语句中的 Page_Load 中可能更容易。这样，无论表单如何提交，您的代码都会运行。

通过向 asp.net 提供有关黑莓浏览器的更多详细信息，可以解决这两种情况。 [这是一篇](http://www.codeproject.com/KB/aspnet/BlackberryASPNET.aspx)描述如何制作 .browser 文件的文章，以便 asp.net 知道要发送到设备的 HTML 和 JavaScript 类型。

# mysql - 我可以在 MySql 中使用函数作为默认值吗？

> ID：270309
> 
> 赞同：99
> 
> 时间：2008-11-06T21:16:00.800
> 
> 标签：mysql

我想做这样的事情：

```
 create table app_users
(
    app_user_id smallint(6) not null auto_increment primary key,
    api_key     char(36) not null default uuid()
); 

```

但是这会导致错误，有没有办法在 mysql 中为默认值调用函数？

谢谢。

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2008-11-06T21:24:22.313

不，你不能。

但是，您可以轻松地创建一个触发器来执行此操作，例如：

```
在_insert_app_users 之前创建触发器
  在 app_users 上插入之前
  每一行
  SET new.api_key = uuid();

```

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2018-10-11T21:18:14.893

从[mysql v8.0.13](https://dev.mysql.com/doc/refman/8.0/en/data-type-defaults.html)开始，可以使用表达式作为字段的默认值：

> DEFAULT 子句中指定的默认值可以是文字常量或表达式。除了一个例外，将表达式默认值括在括号内，以将它们与文字常量默认值区分开来。

```
CREATE TABLE t1 (
  uuid_field     VARCHAR(32) DEFAULT (uuid()),
  binary_uuid    BINARY(16)  DEFAULT (UUID_TO_BIN(UUID()))
); 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2015-04-20T15:59:42.517

如前所述，您不能。

如果你想模拟这种行为，你可以通过这种方式使用触发器：

```
CREATE TRIGGER before_insert_app_users
BEFORE INSERT ON app_users
FOR EACH ROW
  IF new.uuid IS NULL
  THEN
    SET new.uuid = uuid();
  END IF; 
```

您仍然必须更新以前存在的行，如下所示：

```
UPDATE app_users SET uuid = (SELECT uuid()); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-11-06T21:22:36.793

不幸的是，没有，MySQL 5 默认需要常量。在下面的链接中更详细地讨论了这个问题。但唯一的答案是允许 null 并添加一个表触发器。

MySQL 只是最近才接受 UUID 作为其 DB 包的一部分，而且它的功能并不像我们想要的那样丰富。

[http://www.phpbuilder.com/board/showthread.php?t=10349169](http://www.phpbuilder.com/board/showthread.php?t=10349169)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-11-06T21:24:51.580

我相信[你不能](http://dev.mysql.com/doc/refman/5.0/en/data-type-defaults.html)：

> 默认值必须是常量；它不能是函数或表达式

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-07-31T23:55:09.917

请注意，MySQL 的return 和`UUID()`将`CHAR(36)`UUID 存储为文本（如其他答案所示）显然效率低下。相反，该列应该是`BINARY(16)`，并且您可以`UUID_TO_BIN()`在插入数据和`BIN_TO_UUID()`读回数据时使用。

```
CREATE TABLE app_users
(
    app_user_id SMALLINT(6) NOT NULL AUTO_INCREMENT PRIMARY KEY,
    api_key     BINARY(16)
);

CREATE TRIGGER before_insert_app_users
BEFORE INSERT ON app_users
FOR EACH ROW
  IF new.api_key IS NULL
  THEN
    SET new.api_key = UUID_TO_BIN(UUID());
  END IF; 
```

请注意，由于 MySQL 并不真正知道这是一个 UUID，因此很难解决将其存储为二进制文件的问题。本文解释了如何创建一个生成的列，该列将根据需要将 UUID 转换为文本，而不占用任何空间或担心保持单独的二进制和文本版本同步：[https ://mysqlserverteam.com/storing-uuid-values-in -mysql表/](https://mysqlserverteam.com/storing-uuid-values-in-mysql-tables/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-09-18T09:07:03.743

从版本 10.2.1 开始的 MariaDB 中，您可以。请参阅[其文档](https://mariadb.com/kb/en/library/create-table/#default)。

```
CREATE TABLE test ( uuid BINARY(16) PRIMARY KEY DEFAULT unhex(replace(uuid(),'-','')) );
INSERT INTO test () VALUES ();
SELECT * FROM test; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-07-20T14:51:45.047

我不确定上述答案是否适用于旧版本，但我在某处看到您可以使用 unhex() 函数执行此操作。我试过了，它有效。（玛丽亚数据库版本 10.2）

你可以做

```
.... column_name binary(16) not null default unhex(replace(uuid(),'-','')) 
```

它有效。要查看 uuid，只需执行 hex(column_name)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-10-23T13:29:05.130

Harrison Fisk 的答案在写的时候很棒，但现在已经过时了。

如今，您可以将表达式用作`DEFAULT`值。从 MySQL 8.0 和 MariaDB 10.2 开始支持此功能。请注意，如果您要使用`NOW()`or之类的非确定性函数`USER()`，则不应使用`binlog_format=statement`.

# mysql - 如何编写查询以将两个帐户及其活动日志合并为一个？

> ID：270325
> 
> 赞同：0
> 
> 时间：2008-11-06T21:20:55.520
> 
> 标签：mysql, sql

我们经常有用户创建多个帐户，然后多次存储相同的课程活动数据。一旦他们意识到错误，他们就会与我们联系以将帐户合并为一个他们可以使用的帐户。

我一直在试图弄清楚如何在 MySQL 中编写一个查询，将他们的活动日志合并到一个配置文件中，这样我就可以删除其他配置文件，但我仍然找不到将工作。

表格如下所示：

```
CREATE TABLE user_rtab (
    user_id int PRIMARY KEY,
    username varchar,
    last_name varchar,
    first_name varchar
);

CREATE TABLE lessonstatus_rtab (
    lesson_id int,
    user_id int,
    accessdate timestamp,
    score double,
); 
```

发生的情况是，用户最终在两个或多个帐户下学习相同的课程和不同的课程，然后他们想要获取所有课程状态并将它们分配到一个用户帐户下。

任何人都可以提供一个查询，根据用户表中的姓氏和名字字段来确定所有用户帐户，然后仅使用用户或用户名字段将所有必要的状态迁移到一个帐户吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T21:29:09.747

尝试通过 last/first 合并这些数据是一个可怕的想法，您拥有的用户越多，您就越有可能将不正确的条目进行网格化。您的桌子上有 ID 是有原因的，请使用它们。

我看不出有什么理由不能说“我想将用户 7 合并为 12”，然后执行以下操作：

```
UPDATE lessonstatus_rtab SET user_id=12 WHERE user_id=7;
DELETE FROM user_rtab WHERE user_id=7; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T21:28:37.577

这个怎么样，假设我们将 user_id 2 合并为 1。

这将更新在 2 下完成但尚未在 1 下完成的课程。

```
UPDATE lessonstatus_rtab
SET user_id = 1
WHERE user_id = 2
AND NOT EXISTS
(SELECT *
 FROM lessonstatus_rtab e
 WHERE e.lesson_id = lessonstatus_rtab.lesson_id
 AND user_id = 1) 
```

剩下的任何东西都是重复的，现在可以删除：

```
DELETE FROM lessonstatus_rtab
WHERE user_id = 2 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T21:33:49.580

我目前的一个客户也面临着类似的问题，除了他们有几十个表需要合并。这是使用现实生活中的主键（自然键）的原因之一。你最好的办法是在它发生之前尽量避免这个问题。

要记住的另一件事是，两个人可以共享相同的名字和姓氏。也许您不会因为您的用户群而认为这是一个问题，但如果他们已经创建了多个帐户，那么在他们开始编造假名称或创建几乎相同但不完全相同的名称之前需要多长时间。名字通常不是一个很好的匹配来确定两个人是否相同。

As to the technical part of your question, it depends a lot on what the business rules are. If they have the same lesson in there twice with different scores do you use the highest score? How do you decide to which user account to link everything? No matter what, it's going to probably be a multi-step process.

# php - 使用 Visio (Dia) 绘制算法

> ID：270329
> 
> 赞同：1
> 
> 时间：2008-11-06T21:21:32.600
> 
> 标签：php, diagram, visio, dia

我只是想知道有多少经验丰富的程序员实际上在 MS Visio 或 Gnome Dia 这样的程序中绘制出他们的流程或算法？

我正在尝试为我的网站编写一些复杂的 PHP 代码，但似乎缺少了一些东西。图表程序会有所帮助还是我应该在另一个领域寻找？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T21:25:47.803

每次我尝试在 Visio 中制作真正的使用图时，结果总是比它的价值更多。永远不要低估铅笔和纸的力量，或者更好的是白板。

但是，是的，解释或写出你的问题会比仅仅坐在那里思考问题更快地找到解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T21:31:46.980

我只将 Visio 用于不需要遵循 UML 规则的快速图表。有时对于与代码细节无关的文档很有用：如果您需要显示代码的一些高度抽象的视图，Visio 可以完成这项工作，示例，显示每个主要部分如何通信的文档或简单的活动图。 ..

如果您需要进行密集的 UML 设计，您可以找到[免费的 UML 编辑器的 SO 列表。](https://stackoverflow.com/questions/168512/best-free-professional-looking-uml-tool#168548)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T04:25:31.450

OmniGraffle。类图。序列图。交互图。'纳夫说。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T22:03:34.573

当我想用 3 个框和几个箭头制作草图时，我使用 graphviz。我讨厌图形的东西，每次更改名称时都必须重新调整所有内容。

它（几乎）和写作一样简单：

```
Input -> Frobnicator -> Output 
```

在文本文件中然后运行“dot -Tpng -O myfile”

试试看 ...

但请注意，图形表示仅适用于非常高级的视图（即对象很少）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-07T15:25:38.810

我使用magicdraw来绘制我的用例（所以我和我的团队完全了解所需的功能），然后我为更复杂的功能制作活动图表和类图。您还可以在那里进行数据库架构并让它为您生成 sql（如果您的数据库很大，那么上帝会发送）。Magicdraw 不是免费的，但是如果您预计会进行大量复杂的项目，那么投资可能是值得的。除了走图表路线之外，您还可以考虑使用 PHP 框架，该框架可能会处理一些事情，例如 Zend Framework 或 Code Ignitor

# authentication - 如何从断开的网络生成 SSL 客户端证书？

> ID：270333
> 
> 赞同：5
> 
> 时间：2008-11-06T21:22:43.503
> 
> 标签：authentication, ssl, https, pki, client-certificates

我有一个独特的情况，我需要在 IE 浏览器和 IIS 6 之间通过 HTTPS 实现客户端证书身份验证。浏览器和 IIS 被防火墙隔开，只允许浏览器在 SSL 端口上连接到 IIS。

我们在与 IIS 相同的网络上有一个内部证书服务器。我已经为 IIS 生成了一个 SSL 服务器证书并已安装。我将 IIS 配置为仅允许 SSL，需要客户端证书。

这里的限制是浏览器机器在断开的网络上，所以我不能像往常一样访问 CA 的[http://caserver/CertSrv](http://caserver/CertSrv) URL 并[请求客户端证书](http://www.windowsecurity.com/articles/Client-Certificate-Authentication-IIS6.html)。

我想如果有一种方法可以针对根 CA 的公钥生成 CSR，我可以将其复制到 CA 服务器以生成客户端证书。但是，在 IE 或证书 MMC 中似乎没有任何规定可以做到这一点。证书 MMC 似乎需要直接连接到 CA。

以前有没有人解决过这个问题？

仅供参考，所有引用的服务器都运行 Windows Server 2003。

**更新：**感谢 Jonas Oberschweiber 和 Mark Sutton 指出 CertReq.exe 命令行工具。使用它，我生成了一个 CSR，因此生成了一个成功安装的客户端证书。但是，在访问有问题的 IIS 服务器时，IE 显然没有发送此客户端证书；它仍然会生成 403.7“禁止：需要 SSL 客户端证书”。我怀疑原因是客户端证书的主题字段与运行 IE 的帐户的用户 ID 不匹配，因此可能没有发送不匹配的客户端证书。主题与我用来提交 CSR 并在防火墙另一端生成客户端证书的用户相匹配。

主题字段重要吗？我还需要做些什么来让 IE 发送这个证书吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T13:03:58.473

在您的客户端上使用 certreq 命令，如下所示

certreq -new -f 文件在 c:\certrequest.req

这是文件的示例

[版本] 签名="$Windows NT$"

[NewRequest]
Subject="CN=dc1.extranet.frbrikam.com" EncipherOnly
= False
Exportable = False
KeyLength = 1024
KeySpec = 1
KeyUsage = 0xA0
MachineKeySet = True
ProviderName = "Microsoft RSA SChannel Cryptographic Provider"
ProviderType = 12
RequestType = CMC

[请求属性] CertificateTemplate=TLSServer

将 CertificateTemplate 替换为您的证书模板的名称

获得请求文件后，您需要将其带到 U 盘上的证书颁发机构，并像往常一样使用 Web 注册界面来处理请求文件。

将输出证书带回客户端打开它并单击安装。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T21:25:48.113

您听起来好像已经尝试了几件事，所以我的猜测是您已经知道这些，但无论如何我都会发布它们，以防万一：[Certificate Command Line Tools](http://www.microsoft.com/technet/prodtechnol/windows2000serv/reskit/distrib/dscj_mcs_ooiy.mspx?mfr=true "证书命令行工具")。但是，我不确定他们是否按照您的意愿行事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T21:32:35.900

使用可以看到 CA 服务器的第三台计算机访问您提到的[http://caserver/CertSrv站点。](http://caserver/CertSrv)选择第三个选项，下载 CA 证书、cert chai 或 CRL。在下一页选择“下载 CA 证书链”，它将下载 p7b 文件。使用闪存驱动器（或电子邮件等）将其传输到另一台计算机，这将允许您将其导入 IE 中受信任的根服务器。

[http://technet.microsoft.com/en-us/library/cc787796.aspx](http://technet.microsoft.com/en-us/library/cc787796.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-12T14:10:21.010

建议更新，以防万一 - 服务器中受信任的证书列表是什么？

主题 DN 与 Windows 用户名相同对我来说从来都不是问题——尽管我不怎么使用 IIS。但是，在 IIS 的某个地方肯定有一个受信任的证书列表。这个错误对我来说听起来像是服务器的受信任证书列表不包括颁发客户端证书的 CA 或根 CA。

如果您在访问 IIS 服务器时从未在 IE 中看到证书选择弹出窗口，则尤其如此 - 即使您在 IE 证书存储中配置了证书。这意味着客户端访问了服务器，服务器提供了受信任证书的列表，而客户端没有适合该列表的证书。所以 SSL 会话进入了 Forbidden 错误状态。

如果弹出证书选择窗口，并且您选择并发送了证书，则服务器端可能存在其他配置问题..

# .net - C# 编译器抛出无效参数错误。为什么？

> ID：270334
> 
> 赞同：1
> 
> 时间：2008-11-06T21:22:56.543
> 
> 标签：.net, c#-2.0

我有一个包含两种方法的类，如下所示：

```
public String getFoo(Int32 a)
{
  return getBar(a, "b", null);
}

public String getBar(Int32 a, String b, Int32 c)
{
  //do something
  return "";
} 
```

但是，当我编译我的类时，出现两个错误：

1.  getBar(int,string,int) 的最佳重载方法匹配有一些无效参数
2.  参数“3”：无法从“ `<null>`”转换为“int”

我想我明白为什么会出现这个错误：编译器在编译时不知道对象的真实类型是什么。有人可以确认我对错误原因的看法是否正确或指出真正的原因吗？

更重要的是，我可以这样设计我的代码吗？如果是这样，我需要做什么来修复错误？我以这种方式设计我的课程的原因是因为我不想在 getBar 和 getFoo 中复制代码。这两种方法基本上做同样的事情，除了一个采用第三个参数。

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-06T21:27:09.547

在 .NET 中，引用类型和值类型之间有一个不同的概念。

引用类型是在堆上分配的对象（它将是 System.Object 的子类）。堆栈上的所有内容都是指向该对象的指针。因此，存储空指针是完全有效的。

值类型是在堆栈上分配的对象，它将是 System.ValueType 的子类。因为值类型存在于堆栈中，所以当您将其值传递给函数时，您会传递对象的全部内容。

值类型不能为空。

大多数 C# 基本类型都是值类型。String 是一种特殊类型的原始类型，实际上是一种引用类型。

在 .NET 2.0 中，MS 添加了将泛型类型包含在结构中的功能，以便它可以模拟可为空的类型。真正发生的是 Nullable<T> 结构内部的逻辑正在为您模拟一个空值。

他们通过在类型中添加问号来使用语法快捷方式来表达它，例如：

```
int? nullableInt = null;
float? nullableFloat = null; 
```

ETC...

如果你不喜欢 int? 语法，你总是可以使用 Nullable<SomeType>

```
public String getBar(Int32 a, String b, Nullable<Int32> c) 
```

作为旁注，我更喜欢在做你正在做的事情时添加一个重载，只是为了使语法更好。

```
public String getBar(Int32 a, String b)
{
     this.getBar(a,b,null);
}

public String getBar(Int32 a, String b, Nullable<Int32> c)
{
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T21:26:24.213

尝试将第三个参数设置为`getBar`可为空的 int。

因此，签名将如下所示：

```
public String getBar(Int32 a, String b, Int32? c) 
```

[您可以在此处](http://msdn.microsoft.com/en-us/library/1t3y8s4s.aspx)和[此处](http://msdn.microsoft.com/en-us/library/2cf62fcy.aspx)找到有关 .NET 中可为空类型的更多信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T21:26:00.237

`Int32`是一个值类型，这意味着`null`它不是类型参数的有效参数`Int32`。

如果您确实需要可为空的整数，请使用该`int?`类型。

您看到的两个错误实际上是相同的错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T21:28:05.690

Int32 是 int 的别名，它是值/不可为空的类型。对于它的可为空版本，请使用 System.Nullable 或简单的“int？”。

也不要忘记转换回不可为空的 int：

```
int? nullable = ...;
int non_nullable = nullable??0; 
```

其中数字表示如果它确实为空，它应该假设什么值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-06T21:29:29.213

桑尼是对的。
Int32 是值类型，不能保存值“null”。如果您需要将“null”作为参数值传递，请使用 Nullable 而不是 Int32 作为参数类型。

您可以在 MSDN上的[Nullable Types (C# Programming Guide)](http://msdn.microsoft.com/en-us/library/1t3y8s4s(VS.80).aspx)中找到更多信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T21:31:01.660

Int32 不能为空。改为将其设为可为空的类型：

```
public String getBar(Int32 a, String b, Int32? c)
{
    if (c.HasValue)
    {
        ...do something with c.Value...
    }
    return "";
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-06T21:32:19.363

好的，所以~~五~~七个人提出`int?`了解决方案。根据具体情况，我提出了另外两种*可能更合适的解决方案；*

*   **创建**只有两个参数的方法的重载，并`null`在调用时省略：

    ```
    public String getFoo(Int32 a)
    {
      return getBar(a, "b", null);
    }

    public String getBar(Int32 a, String b)
    {
      //do something else, without the int
    } 
    ```

    尽管您可能不想这样做，因为您声明要避免代码重复。

*   **使用`default`代替`null`**：

    ```
    return getBar(a, "b", default(int)); 
    ```

    顺便说一句，这与传递 value 相同`0`。

# asp.net - ASP.NET 从另一个窗口刷新一个窗口

> ID：270337
> 
> 赞同：0
> 
> 时间：2008-11-06T21:23:24.500
> 
> 标签：asp.net, javascript, .net-2.0

我有一个带有 GridView 的页面，它使用 Javascript 启动弹出窗口。然后用户选择一个项目，更新连接到 GridView 的数据并关闭弹出窗口。

如何刷新第一个（即调用页面），以便可以刷新 Gridview 中显示的数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T21:26:48.610

在你的弹出窗口中试试这个：

```
<script>
window.opener.location.reload()
</script> 
```

那应该刷新打开弹出窗口的页面

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T21:55:27.930

如果您只需要在调用页面上触发回发，这应该可以：

```
<script>
window.parent.document.forms[0].submit();
</script> 
```

通过显式提交表单，您可以避免仅刷新调用页面时出现的警告。

如果您需要在回发期间在 GridView 上触发 OnSelectedIndexChanged 事件，那么事情会有点复杂，但您应该能够通过`window.parent.document.__doPostBack()`使用合适的参数调用来做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-11T18:40:31.643

这是解决方案：

```
Dim CloseScript As String = "<script language='javascript'>function closeWindow(){ window.opener.document.forms[0].submit();window.close();}closeWindow();</script>" 
```

在 .NET 2.0 中，您必须将其添加到页面以在 Javascript 上方注册：

```
 'register with ClientScript 
    'The RegisterStartupScript method is also slightly different 
    'from ASP.NET 1.x 
    Dim s As Type = Me.[GetType]()
    If Not ClientScript.IsClientScriptBlockRegistered(s, "CloseScript") Then
        ClientScript.RegisterClientScriptBlock(s, "CloseScript", CloseScript)
    End If 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-19T21:23:14.673

这是否避免了“页面无法刷新”消息

```
window.opener.location = window.opener.location; 
```

*（对不起，我只是在 TonyB 的帖子上发表评论，但我没有足够的 SO 积分，所以我不允许...... :(*

# c++ - 在 VC++ 8 中替换 auto_ptr

> ID：270347
> 
> 赞同：9
> 
> 时间：2008-11-06T21:26:27.597
> 
> 标签：c++, smart-pointers

`std::auto_ptr`在 VC++ 8 中被破坏（这是我们在工作中使用的）。我对它的主要抱怨是它允许`auto_ptr<T> x = new T();`，这当然会导致可怕的崩溃，同时很容易出错。

从stackoverflow上另一个问题的[答案：](https://stackoverflow.com/questions/106508/what-is-a-smart-pointer-and-when-should-i-use-one#110706)

> 请注意，Visual Studio 2005 中 std::auto_ptr 的实现被严重破坏。 [http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=98871](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=98871) [http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=101842](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=101842)

我想用

*   `boost::scoped_ptr`, 对于不应传递所有权的指针。
*   `boost::shared_ptr`, 用于容器中和需要它们的其他地方的指针。
*   `std::auto_ptr`, 对于应该/可以传递所有权的指针。

但是因为`std::auto_ptr`对我来说已经坏了，我想知道最好的方法是什么：

*   换成`std::auto_ptr`网上的东西。就像Rani Sharoni 的[这个](http://groups.google.com/group/comp.std.c++/msg/97a2539a1bbbe491)（还没试过）。
*   改为使用`boost::shared_ptr`。当然会起作用，尽管会有一些我不关心的小开销。但我想用`auto_ptr`指针的意图来表示。（有关此方法的投票，请参阅[此](https://stackoverflow.com/questions/197048/idiomatic-use-of-stdautoptr-or-only-use-sharedptr#197083)答案。）
*   在实践中我永远不需要传递所有权，所以我不应该担心这个。

* * *

更新：这是我所做的：我复制了 Rani Sharoni 的上述 auto_ptr 实现。[从这里](http://groups.google.com/group/comp.std.c++/msg/97a2539a1bbbe491)。

做了一些小测试：

```
class T
{
public:
    T() {
        OutputDebugStringA("T\n");
    };
    ~T() {
        OutputDebugStringA("~T\n");
    };
};

{
    fix::auto_ptr<T> x(new T); // This just works.
}
{
    fix::auto_ptr<T> x = (new T); // Doesn't compile. Great!
}
{
    fix::auto_ptr<T> x = fix::auto_ptr<T>(new T); // Transfer of ownership works also.
} 
```

当然，这些测试绝不是详尽无遗的，您不应该相信它们。实现一个异常安全的模板类是一件棘手的事情。至少这比内置的效果更好。

~~注意：关于版权，我不知道我是否被允许使用这个实现。我已经给 Rani 发了电子邮件，正在等待回复。当我知道更多时，我会更新这篇文章。~~ 每个人都可以根据需要使用 Rani Sharoni 的 auto_ptr 实现。

感谢您的所有回复。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-07T09:47:14.437

移动以增强智能指针。

同时，您可能希望从旧的/另一个 STL 中提取工作的 auto_ptr 实现，这样您就有工作代码。

我相信 auto_ptr 语义从根本上被破坏了——它节省了打字，但界面实际上并不简单：你仍然必须跟踪哪个实例是当前所有者并确保所有者最后离开。

unique-ptr “修复”，通过使 release 不仅放弃所有权，而且将 RHS 设置为空。它是最接近 auto-ptr 的替代品，但由于其不同的语义，它不是直接替代品。

有一篇关于[提升智能指针](http://www.codeproject.com/KB/stl/boostsmartptr.aspx)的介绍性文章，作者，咳咳，我。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T22:01:30.523

您是否考虑过使用[STLPort](http://www.stlport.org/)？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T22:04:03.777

使用 unique_ptr。我认为这些被引入是为了更好的 auto_ptr。

[http://www.boost.org/doc/libs/1_35_0/doc/html/interprocess/interprocess_smart_ptr.html#interprocess.interprocess_smart_ptr.unique_ptr](http://www.boost.org/doc/libs/1_35_0/doc/html/interprocess/interprocess_smart_ptr.html#interprocess.interprocess_smart_ptr.unique_ptr)

事实上，我被认为可能会弃用 auto_ptr 以支持它：

[http://objectmix.com/c/113487-std-auto_ptr-deprecated.html](http://objectmix.com/c/113487-std-auto_ptr-deprecated.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T21:30:17.543

你为什么认为 std::auto_ptr<> 坏了。

我本来会向标准委员会报告那样糟糕的事情！

你的意思是你需要：

```
std::auto_ptr<T>   x(new T);  // Use the explicit constructor. 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T21:30:12.007

使用 boost::shared_ptr/boost::scoped_ptr。它将成为即将推出的 C++ 标准中的首选智能指针（已经在 TR1 中）。

编辑：请在此处找到相关讨论：[Idiomatic use of std::auto_ptr or only use shared_ptr?](https://stackoverflow.com/questions/197048/idiomatic-use-of-stdautoptr-or-only-use-sharedptr)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-06T07:28:22.050

据我记得，不是吗：

```
auto_ptr<T> x = auto_ptr<T>(new T()); ?? 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-06T07:42:30.993

不是答案，而是出于与这些错误相关的任何人的普遍利益。还有一个与VC8[相关的错误](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=319580)`auto_ptr`，它与隐式向上转换有关。这可能是最邪恶的，因为其他错误只会让您编译根据标准非法的代码而不会失败，但至少兼容的代码可以正常工作。有了这个错误，实际上合规的代码就不能正常工作。

问题是这样的。标准`auto_ptr`以支持 s 的隐式向上转换的方式指定构造函数和转换运算符`auto_ptr`，就像使用普通指针一样。但是，VC8 实现了一个`reinterpret_cast`而不是一个`static_cast`。自然，这不仅是标准字母上的 UB，而且它还与多个基类和/或虚拟继承相冲突。这是一个由此破坏的法律代码示例：

```
struct Base1 { int x; };
struct Base2 { int y; };
struct Derived : Base1, Base2 {};

std::auto_ptr<Derived> createDerived()
{
  return std::auto_ptr<Derived>(new Derived);
}

std::auto_ptr<Base2> base2(createDerived()); 
```

在我过去的一项工作中，当我们在生产中遇到这个问题时，我们最终只是自己修补了标题（这是一个微不足道的 2 行修复）。

# delphi - Delphi Prism/Oxygene 中的 Lambda 表达式

> ID：270350
> 
> 赞同：2
> 
> 时间：2008-11-06T21:26:48.050
> 
> 标签：delphi, lambda, fibonacci, oxygene

我一直在尝试在 Oxygene 中使用 Lambda 表达式。非常简单的递归 lambda 表达式来计算斐波那契数：

```
var fib : Func<int32, int32>;
fib := n -> iif(n > 1, fib(n - 1) + fib(n - 2), n);
fib(3); 
```

当我运行此代码时，我得到一个 nullreferenceexception。关于我做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-06T22:23:46.203

你没有做错什么。如果有的话，编译器应该警告你在 lambda 的主体内使用 fib，一个未分配的变量。

然而，编译器应该将 fib 捕获为一个位置，以便当分配完成并且稍后调用委托时，fib 被正确分配并且递归应该按预期工作。

失败的最明显可能原因是 Prism 不是在捕获位置，而是在捕获值，这非常不直观，并且与非纯语言中的所有其他闭包实现不一致。

例如，在 JavaScript 中尝试这段代码（与 Craig 在这篇文章的评论中的断言相反，JavaScript 还捕获位置，而不是值）：

```
<html>
<head>
<script language='javascript'>
function main()
{
    var x = 1;
    var f = function() { return x; };
    alert(f());
    x = 2;
    alert(f());
}
</script>
</head>
<body>
<input type=button onclick="javascript:main()"></input>
</body>
</html> 
```

单击按钮后的警报框分别显示 1 和 2，而遵循 Prism/Oxygene 语义它们将显示 1 两次。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-09-29T08:40:54.470

史蒂夫：

该问题显然已在 Delphi Prism 2010 中得到解决。以下代码示例在官方版本中有效。

```
 var fib : Func<int32, int32>;
 fib := n -> iif(n > 1, fib(n - 1) + fib(n - 2), n);
 var i := fib(9); //1,1,2,3,5,8,13,21,34
 MessageBox.Show(i.ToString); 
```

MessageBox 显示值 34。

在回答 Jeroen 的问题时，此代码在原始的官方发布版本 3.0.21.661 中运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T13:20:10.170

作为临时解决方法，您可以使用：

```
var f := new class(f: Tfib := nil);
f.f := method(n : Int32): Int32
begin
  if n > 1 then  
    Result := f.f(n-1) + f.f(n-2)
  else
    Result := n;
end;
f.f(3); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T11:57:15.237

Prism 处理局部变量的捕获方式与原生 Delphi 或 C# 不同。在这两个本地代码中的所有引用都将映射到编译器生成的类的字段，该类将保存您的匿名方法。在 prism 中，这些 locals 仍然是普通的 locals，但是这个隐藏字段的字段是在您实例化匿名方法时设置的。

获得递归 lambda 的一种方法是使用引用类型为您保存 lambda。

所有这些听起来比实际上要复杂得多。
实现目标的 2 种方法：
1)

```
 var fib := new class(Call : Func<Integer, Integer> := nil);  
    fib.Call := n -> iif(n > 1, fib.Call(n - 1) + fib.Call(n - 2), n);  
    var x := fib.Call(3); 
```

2）当你不想引用这个包装器时，你可以这样做：

```
 var fib : Func;  
    with fibWrapper := new class(Call : Func<Integer, Integer> := nil) do  
    begin  
        fibWrapper.Call := n -> iif(n > 1, fibWrapper.Call(n - 1) + fibWrapper.Call(n - 2), n);  
        fib := fibWrapper.Call;  
    end; 
```

顺便说一句，Prism 在这里没有遵循 C# 的原因是，对于线程和循环，这种对捕获的变量的重用会导致非常奇怪的运行时问题。在 Prism 中，捕获在您分配匿名方法或 lambda 的那一刻真正被捕获。它具有某种不可改变的触感……

干杯，罗伯特

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-07T12:07:27.680

这同样适用于匿名方法吗？我猜是这样，但不能完全弄清楚让它运行的语法

```
 var f : Tfib;
  f := method(n : Int32): Int32
  begin
    if n > 1 then  
      Result := f(n-1) + f(n-2)
    else
      Result := n;
  end; 
```

**编辑**

确实如此。

```
 var f := new class(call : TFib := nil);
  f.call := method(n : Int32): Int32
  begin
    if n > 1 then  
      Result := f.call(n-1) + f.call(n-2)
    else
      Result := n;
  end; 
```

# image - 我在哪里可以找到免费的天气图标？

> ID：270361
> 
> 赞同：6
> 
> 时间：2008-11-06T21:29:57.607
> 
> 标签：image, icons, weather

与[https://stackoverflow.com/questions/139944/where-can-one-find-free-software-icons-images相关](https://stackoverflow.com/questions/139944/where-can-one-find-free-software-icons-images)

我需要免费的天气相关图标。具体来说，我需要您可能在十天预报中看到的图标（晴天/夜晚、雨天/夜晚等）。我在哪里可以找到这样的图像？

**要求：就像上面链接的问题的作者一样，我宁愿不要剥夺任何人的知识产权。**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-06T21:45:45.500

Weather.com 有一个免费的 xml 服务，他们为此提供了 SDK。SDK 包括 3 种尺寸（31x31、61x61 和 93x93）的图标，适用于大约 48 种天气条件。我在他们的协议中找不到任何禁止将图标用于除服务之外的任何内容的内容。（也没有专门授予免费再分发）

它们非常好，因此可能值得研究：

[http://www.weather.com/services/xmloap.html](http://www.weather.com/services/xmloap.html)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-06T21:49:53.073

[http://flagrantdisregard.com/fd-weather-icons/](http://flagrantdisregard.com/fd-weather-icons/)

这是根据[知识共享署名 3.0](http://creativecommons.org/licenses/by/3.0/us/)许可授权的，因此可以用于商业作品（带有署名）

[http://jyrik.deviantart.com/art/Weather-Icons-Shiny-5215175](http://jyrik.deviantart.com/art/Weather-Icons-Shiny-5215175)

这是根据[Creative Commons Attribution-Noncommercial-Share Alike 3.0](http://creativecommons.org/licenses/by-nc-sa/3.0/)许可授权的，不能用于商业用途。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-10-19T19:31:53.000

这些不是很好，但它们在 NOAA 网站上，并且有很多可供选择。见[http://www.nws.noaa.gov/weather/images/fcicons/](http://www.nws.noaa.gov/weather/images/fcicons/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-06T21:39:12.720

[好吧， “天气图标”](http://images.google.com/images?hl=en&rlz=1B3GGGL_enUS276US276&q=weather+icons&um=1&ie=UTF-8&sa=X&oi=image_result_group&resnum=1&ct=title)的快速谷歌产生了很好的结果。或者像[deviantART](http://jyrik.deviantart.com/art/Weather-Icons-Shiny-5215175) （[第二个链接](http://browse.deviantart.com/customization/icons/#order=9&q=weather)）这样的地方是一个不错的选择。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-06T21:41:17.817

[Buuf 图标集](http://www.iconarchive.com/category/application/buuf-icons-by-mattahan.html)包含一个子目录 Things/Weda ，其中包含 15 个天气图标。它是 CC Attribution-Noncommercial-Share Alike 3.0。对商业应用程序没有好处，但如果您正在寻找免费应用程序的东西，我认为您是因为您不愿意付费；）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-06T21:43:28.920

嗨，您可以在这里找到一些非常棒的图标

[http://tango.freedesktop.org/Tango_Desktop_Project](http://tango.freedesktop.org/Tango_Desktop_Project)

这是一个开源图标主题

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-06T22:55:29.463

你可能会打开剪贴画网站

> 该项目旨在创建一个可以自由使用的用户贡献的剪贴画档案。提交给项目的所有图形都应根据知识共享的声明放入公共领域。

[http://openclipart.org/media/tags/weather](http://openclipart.org/media/tags/weather)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-08-18T17:43:29.663

[http://www.fordesigner.com/maps//3800-0.htm](http://www.fordesigner.com/maps//3800-0.htm)有一个免费的天气图标..

# asp.net - ASP.NET 中的 XML 到数据库

> ID：270364
> 
> 赞同：0
> 
> 时间：2008-11-06T21:30:14.220
> 
> 标签：asp.net, xml, vb.net

使用 VB.NET，如何将 XML 文件中的值添加到具有类似架构的 SQL Server 数据库中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-06T21:39:01.083

我不知道我脑海中浮现的方法，但您应该能够将文件加载到 DataTable 中，然后使用 ADO.net 将其放入数据库（如果您使用的是 SqlBulkCopy 类，请查看SQL Server 数据库）。

这应该让你有足够的词来打孔并找到一个很好的例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T14:07:28.550

最简单的方法是使用 DataSet 类的 ReadXml() 方法。然后，正如用户上面提到的，数据集包含一 (1) 个 DataTable。将它放入 SQL 中非常容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T14:57:43.787

使用 XSL 转换来创建插入语句。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-12-05T04:31:57.840

不能使用 xsl 转换，您需要一个字符串进行查询，而不是另一个 xml

# java - 你用 Object.clone() 做什么？

> ID：270369
> 
> 赞同：14
> 
> 时间：2008-11-06T21:31:38.493
> 
> 标签：java

一位同事最近问我如何深度克隆 Map，我意识到我可能从未使用过 clone() 方法——这让我很担心。

您发现需要克隆对象的最常见场景是什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-06T21:55:41.063

我假设您指的`Object.clone()`是Java。如果是，请注意`Object.clone()`存在一些重大问题，并且在大多数情况下不鼓励使用它。请参阅Joshua Bloch 的[“Effective Java”](http://java.sun.com/docs/books/effective/)中的第 11 项以获得完整答案。我相信您可以安全地`Object.clone()`在原始类型数组上使用，但除此之外，您需要明智地正确使用和覆盖克隆。您最好定义一个复制构造函数或根据您的语义显式克隆对象的静态工厂方法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-06T21:34:36.460

最常见的情况是，当我必须将可变对象返回给调用者时，我担心调用者可能会搞砸，通常是以线程不友好的方式。列表和日期是我最常这样做的。如果调用者可能想要遍历 List 并且我有可能更新它的线程，则返回它的克隆或副本会更安全。

实际上，这带来了一些我将不得不提出另一个问题的问题：复制构造函数还是克隆？当我做 C++ 时，我们总是做一个复制构造函数并用它实现克隆，但是如果你使用复制构造函数实现你的克隆，FindBugs 不喜欢它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-06T21:35:09.687

当我需要复制某些内容以修改副本而不影响原始内容时，当然在这种情况下，深度克隆（仅）就足够了。我必须在克隆域类实例的系统上执行此操作，应用用户的更改，然后对两者进行比较以供用户验证他们的更改。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-07T10:59:07.490

Object.clone() 方法没有指定子类的副本是深拷贝还是浅拷贝，它完全依赖于特定的类。Object.clone() 方法本身进行浅拷贝（复制 Object 类的内部状态），但子类必须覆盖它，调用 super.clone()，并根据需要（浅或深）复制它们的内部状态。

它确实指定了一些约定，您可能遵循也可能不遵循。要让 (a.getClass() == a.clone().getClass()) 返回 true，应该调用 super.clone() 而不是简单的 'new Subclass()'，因为 super.clone() 可能会正确实例化该对象的类（即使在子类中），并复制所有内部状态，包括私有字段，由于可见性规则，子类无法使用复制构造函数复制这些状态。或者您将被迫公开不应公开的构造函数，以便更好地封装。

例子：

```
//simple clone
class A implements Cloneable {
  private int value;
  public A clone() {
    try {
      A copy = (A) super.clone();
      copy.value = this.value;
      return copy;
    } catch (CloneNotSupportedException ex) {}
  }
}

//clone with deep and shallow copying
class B extends A {
  Calendar date;
  Date date;
  public B clone() {
    B copy = (B) super.clone();
    copy.date = (Calendar) this.date.clone(); // clones the object
    copy.date = this.date; // copies the reference
    return copy;
  }
} 
```

当依赖对象是可变的（如日历）时，通常使用深拷贝，并且拷贝必须完全独立于原始对象。

当依赖对象是不可变的（如 Date）时，共享同一个实例通常不是问题，浅拷贝可能就足够了。

使用 Object.clone() 时，您必须遵循一些规则，但它们足够简单易懂。可能最困难的部分是正确定义应该复制到对象图中的深度。这是一个逻辑问题，而不是语言问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-13T02:33:31.863

我在 Spring webflow 应用程序中使用了 Object.clone() 来检查用户在表单上编辑/输入数据以进行审计时发生了什么变化。

在流程开始时，我调用了在 spring webflow 中使用的表单支持对象上实现的 clone 方法，并将克隆的实例保存到用户会话中。一旦用户完成了 html 表单上的数据编辑并按下了保存按钮，我将绑定到支持对象的新值与克隆值进行比较，以确定用户更改了哪些数据。

这很好用，而且很容易实现，我还没有真正遇到过在 Java 中克隆的任何问题。

# javascript - jquery圆角

> ID：270380
> 
> 赞同：3
> 
> 时间：2008-11-06T21:34:46.147
> 
> 标签：javascript, jquery, rounded-corners

这可能听起来很愚蠢，但我不知道如何实现 jquery 的圆角（[http://www.methvin.com/jquery/jq-corner-demo.html](http://www.methvin.com/jquery/jq-corner-demo.html)）。我的 javascript-fu 完全失败，我似乎无法让它在我的页面上运行。谁能给我看一个简单的 HTML 和 JavaScript 示例，你会用它来显示它们吗？为我的愚蠢道歉。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-06T21:50:08.953

1.  这个东西在 Safari 和谷歌浏览器中不起作用。

2.  您需要在页面中包含[jquery.js](http://jqueryjs.googlecode.com/files/jquery-1.2.6.js)。不要忘记有一个单独的结束标签。

    `<script type="text/javascript" src="jquery.js"></script>`

3.  您还需要在页面中包含 jQuery Corner Plugin JavaScript 文件 ( [jquery.corner.js](http://www.methvin.com/jquery/jquery.corner.js) )。

    `<script type="text/javascript" src="jquery.corner.js"></script>`

4.  在您的页面中的某处，您应该有`<div>`您想要的角落：

    `<div id="divToHaveCorners" style="width: 200px; height: 100px; background-color: #701080;">Hello World!</div>`

5.  在页面的其他地方，最好不在 div 本身之前，发出以下 JavaScript 命令。这将在页面加载并准备好操作时执行内部函数。

    `<script type="text/javascript">$(function() { $('#divToHaveCorners').corner(); } );</script>`

6.  你完成了！如果没有，请告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-05T23:28:05.887

Methvin`http://www.methvin.com/jquery/jq-corner-demo.html`的 jquery 角还可以并且工作正常，但是......还有更漂亮的选择：

```
http://blue-anvil.com/jquerycurvycorners/test.html 
```

您甚至可以使用该库来制作圆形图像。

非常重要的是： - 2008 年 7 月 18 日 - 现在可以在 IE6、7、safari 和所有其他现代浏览器中使用。修复了居中错误。

因此，请从以下网址下载 jQuery Curvy Corners 2.0.2 Beta 3：

```
http://code.google.com/p/jquerycurvycorners/downloads/list 
```

再次，您必须首先加载 jquery 核心库，因此您的 HEAD 示例可以是：

```
<head>
<script src="http://path.to.your.downloaded.jquery.library/jquery-1.2.6.min.js" type="text/javascript"></script> 
<script src="http://path.to.your.downloaded.jquery.library/jquery.curvycorners.min.js" type="text/javascript"></script>

<script type="text/javascript">
$(function(){

$('.myClassName').corner({
     tl: { radius: 6 },
     tr: { radius: 6 },
     bl: { radius: 6 },
     br: { radius: 6 }
});

}
</script>
</head> 
```

其中：tl,tr,bl,br 是左上角、右上角等...

接下来，你的身体区域：

和 ？

就是这样:)

关于图片的链接：

```
http://img44.imageshack.us/img44/3638/corners.jpg 
```

...并准备使用代码：

```
<html>
    <head>
    <script src="http://blue-anvil.com/jquerycurvycorners/jquery-1.2.6.min.js" type="text/javascript"></script> 
    <script src="http://blue-anvil.com/jquerycurvycorners/jquery.curvycorners.min.js" type="text/javascript"></script>
    <script type="text/javascript">
    $(function(){

    $('.myClassName').corner({
         tl: { radius: 12 },
         tr: { radius: 12 },
         bl: { radius: 12 },
         br: { radius: 12 }
    });

    });
    </script>
 <style>
 .myClassName
 {
 width:320px;
 height:64px;
 background-color:red;
 text-align:center;
 margin:auto;
 margin-top:30px;
 }
 </style>
</head>

<body>

<div class="myClassName">content</div>

</body>

</html> 
```

只需复制、粘贴、享受 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T21:49:30.127

1) 确保 jquery 已加载 2) 确保corners lib已加载 3) 在准备好的回调中，使用选择器获取您想要效果的 div 并调用corners 方法

```
$(document).ready(function() {
 $("#idofdiv").corners();
}); 
```

# sql-server - SQL Reporting Services 无法配置虚拟目录

> ID：270382
> 
> 赞同：2
> 
> 时间：2008-11-06T21:34:53.353
> 
> 标签：sql-server, tfs, reporting-services, directory, virtual

我有一个问题，我们尝试将 TFS 2005 服务器升级到 2008。在安装过程中，我们遇到了无法配置 SQL Reporting Services 的错误。日志文件显示，在创建/配置 SQL Reporting Services 的虚拟目录（确切地说是 Reports 目录）期间，抛出了 FileNotFoundException。该目录实际上已创建。SQL 报告服务在安装之前运行良好。我尝试使用报表服务器配置工具手动重新配置，但是虽然它会创建两个目录，但它仍然失败并出现 FileNotFoundException。我手动配置 .config 文件以指向当前服务器，并且能够运行 sql 报告服务网站。我们尝试了几件事：弄乱权限、应用程序池、重新安装 .

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-10T20:49:58.187

我最近遇到了类似的问题。安装新的 RS 实例并应用 SQL Server sp2 和 KB954606 修补程序后，我尝试配置 RS 实例，但创建虚拟目录失败。与您的情况一样，创建了虚拟目录，但是 RS 配置工具引发了错误。

就我而言，使用 IIS 管理器删除新创建的虚拟目录，然后重新启动服务器修复了所有问题。重新启动后，我能够使用 RS 配置工具成功创建虚拟目录。

# asp.net - 事后将 Web 表单转换为 Web 内容表单。（。网）

> ID：270385
> 
> 赞同：0
> 
> 时间：2008-11-06T21:35:22.963
> 
> 标签：asp.net, webforms, master-pages

我有一个几年前的网站，其中包含大约 30 个带有代码的 aspx Web 表单页面。我想以最少的工作量为所有这些添加一个通用母版页。

本质上，我只需要将正文标记中的所有内容添加到内容占位符，并保留后面的代码。

有没有快速的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-23T15:32:28.720

对于每个页面，请执行以下操作 - 将属性添加到名为 MasterPageFile="Your MasterPage Path" 的 <@Page > 标签 - 添加以下标签 - 删除 html 和 head 标签及其内容，除了 body 标签 - 删除 body 标签，但保留它内容 - 删除表单标签 - 完成

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T21:39:52.017

剪切和粘贴工作正常 - 剪切所有旧的页眉/页脚内容并粘贴到内容控制标签中，然后添加母版页名称，你就完成了

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T21:53:25.423

要记住的一件事是，当您添加母版页时，您正在添加一个命名容器，因此您的所有客户端 ID 都会更改。如果您有任何与您的控件相关联的静态 javascript，请务必更新 id。

# language-features - 使用 bignums 的开销

> ID：270386
> 
> 赞同：2
> 
> 时间：2008-11-06T21:35:41.620
> 
> 标签：language-features, language-design

当涉及数字时，我遇到了关于是否在我的语言中使用 bignums 作为默认数据类型的问题。我自己对此进行了评估，并将其简化为便利和舒适与性能的问题。该问题的答案取决于未得到优化的程序对性能的影响有多大。

在固定数字或整数就足够的地方使用大数字的开销有多小？在最好的实现中它可以有多小？什么样的实现可以达到最小的开销，它们会导致什么样的额外权衡？

如果我将我的语言默认设置为 bignums，我可以期望对整体语言性能产生什么样的影响？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T21:45:05.783

你或许可以看看 Lisp 是如何做到的。它几乎总是会做*完全* *正确*的事情，并在必要时隐式转换类型。它有fixnums（“正常”整数）、bignums、比率（减少的真分数，表示为一组两个整数）和浮点数（不同大小）。只有浮点数有精度误差，并且具有传染性，即一旦计算涉及浮点数，结果也是浮点数。“Practical Common Lisp”很好地描述了这种行为。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T21:39:25.623

老实说，最好的答案是“试试看”。

显然 bignums 不能像原生类型那样高效，原生类型通常适合单个 CPU 寄存器，但每个应用程序都不同 - 如果您的应用程序不执行整数运算的整个负载，那么开销可以忽略不计。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T22:00:12.583

想一想……我认为它根本不会对性能产生太大影响。

因为 bignums 本质上会有一个*非常*大的基数，比如 65536 或更大的基数，这通常是传统固定数和整数的最大可能值。

我不知道你会将 bignum 的基数设置为多大，但如果你将它设置得足够大，以便当它用于代替 fixnums 和/或整数时，它永远不会超过它的第一个 bignum-digit 因此操作将与正常的 fixnums/int 几乎相同。

这为优化提供了机会，对于永远不会超过其第一个大数字的大数字，您可以用超快的大数字操作替换它们。

然后在需要第二个大数位时切换到 n 位算法。

这可以通过位标志和对所有算术运算的验证操作来实现，粗略地认为，您可以使用最高位来表示 bignum，如果数据块的最高位设置为 0，则将它们处理为如果它们是正常的 fixnum/ints 但如果它设置为 1，则将块解析为 bignum 结构并从那里使用 bignum 算法。

这应该避免来自简单循环迭代器变量的性能影响，我认为这是性能影响的第一个可能来源。

这只是我的粗略想法，一个建议，因为你应该比我更了解:-)

ps 抱歉，忘记了 bignum-digit 和 bignum-base 的技术术语是什么

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T21:37:58.010

您的减少是正确的，但选择取决于您的语言的性能特征，*我们不可能知道*！

一旦你实现了你的语言，你就可以测量性能差异，并可能为程序员提供一个指令来选择默认值

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T21:40:13.733

在您创建自己的基准之前，您永远不会知道实际的性能影响，因为结果会因语言、语言版本和 CPU 的不同而有所不同。除了 32 位整数使用的内存是 16 位整数的两倍这一明显事实外，没有独立于语言的方法来衡量这一点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T21:41:45.337

> 在固定数字或整数就足够的地方使用大数字的开销有多小？显示小可以是最好的实现吗？

坏消息是，即使在最好的软件实现中，BigNum 也将比内置算法慢几个数量级（即从因子 10 到因子 1000）。

我没有确切的数字，但我认为在这种情况下，确切的数字不会有太大帮助：如果您需要大数字，请使用它们。如果没有，不要。如果您的语言默认使用它们（哪种语言使用？一些动态语言使用......），请考虑切换到另一种语言的劣势是否可以通过性能增益得到补偿（这应该很少）。

（大致可以翻译为：有很大的不同，但没关系。*如果*（且仅当）它很重要，请使用另一种语言，因为即使有最好的实现，这种语言显然也不太适合任务。）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-06T21:50:25.570

我完全怀疑它是否值得，除非它是非常特定于领域的。

首先想到的是**整个程序中的所有小 for 循环**，小迭代器变量都将是 bignums 吗？这太可怕了！

但是，如果您的语言相当实用……那么也许不是。

# java - 任何支持条件格式的 Java 轻量级模板解决方案？

> ID：270391
> 
> 赞同：5
> 
> 时间：2008-11-06T21:38:08.433
> 
> 标签：java, string, templates, template-engine, stringtemplate

我正在使用 MessageFormat 使用如下模板格式化一些地址：

```
"{0}\n{1}\n{2}\n{3}, {4} {5}" 
```

在哪里

*   0 = 街道 1
*   1 = 街道 2
*   2 = 街道 3
*   3 = 城市
*   4 = 状态
*   5 = 拉链

大多数这些字段在捕获时都是可选的。例如，当没有街道 3 时，如何避免出现空行？我可以使用这样的模板“{0}{1}{2}{3}{4}{5}”，然后相应地替换“street 3\n”或“”，但模板不提供对格式化有很大好处。

有没有办法在格式字符串中包含条件？或者是否有另一个支持条件格式的、最好是轻量级的模板工具？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-20T02:49:36.890

**编辑：重写...**

如果你*不关心设计*，那么你可以随意选择一个模板引擎，或者因为你喜欢它的名字，或者其他什么。如果您没有选择引擎的标准，那么谁在乎您选择哪一个？

另一方面，如果您*确实关心设计*，例如使用模型-视图-控制器 (MVC) 设计模式，那么您的选择很快就会减少。

这里的大多数答案都强调了各种模板引擎的强大功能。但是 MVC 的全部意义在于您不想做更多事情，因为在模板中做更多事情最终会对您造成非常严重的伤害。业务逻辑不属于 View，它属于 Model。控制逻辑属于控制器。只有一个模板引擎实际上强制执行 MVC 模式。如果您不希望 MVC 模式（也许您正在超越它），那么一个引擎仍然可以帮助您不伤害自己并鼓励您正确划分功能。

实际上只有一个好的模板引擎： **StringTemplate**。有关原因的详细信息，请参见[http://www.cs.usfca.edu/~parrt/papers/mvc.templates.pdf](http://www.cs.usfca.edu/~parrt/papers/mvc.templates.pdf)。

我已经在多个平台（Python、Java、.Net）以及许多替代品和 StringTemplate 规则上使用了它。

决定完成。享受。最好的祝愿。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-16T05:00:11.453

其他人提到了字符串模板，但我们最近切换到了 MVEL（它也做得更多，但实际上并没有增加太多重量）： http: [//mvel.codehaus.org/](http://mvel.codehaus.org/)（我发现它更容易使用）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-06-06T15:59:40.087

恕我直言，[块模板引擎](http://www.x5software.com/chunk/)是最好的。jar 文件只有**180 KB**！并支持**IF**和**迭代**。多么酷啊 ！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-06T22:07:55.283

[jguru 字符串模板](http://www.antlr.org/wiki/display/ST/Defining+Templates)

这是用来构建站点 jGuru 的——它已经存在了一段时间。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-06T21:53:47.230

不知道您认为它有多轻巧，但[Apache Velocity](http://velocity.apache.org/)是最著名的 Java 模板引擎之一。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-06T21:55:38.193

您可以按照您的方式进行格式化，然后通过将多个`'\n'`s 替换为单个 s 来删除空行`'\n'`，例如

```
result = result.replaceAll("\n+", "\n"); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-06T21:58:15.943

使用 Velocity 或[Freemarker](http://freemarker.org/)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-08T16:29:19.367

Freemarker 很不错。它轻巧、快速、具有条件格式和大量其他功能。

# monitor - 你能通过简单的 C 代码过热显示器吗？

> ID：270393
> 
> 赞同：3
> 
> 时间：2008-11-06T21:39:06.230
> 
> 标签：monitor, overheating

一位教授告诉我，使用 C 代码可以将旧显示器上的单个像素加热到显示器会过热和冒烟的程度。你们有没有遇到任何支持这一点的东西？我正在我的办公室就这是否可能进行辩论。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-06T21:44:14.083

使用旧的 PC 单色显示器，您可以通过编程方式关闭水平同步信号，这会导致显示器中的内部位过热并出现物理故障。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-06T21:57:31.000

好吧，旧的多同步 CRT 有点不稳定。使它们处于垂直和水平偏转线圈将停止移动电子束（并且不会关闭电子束）的状态（分辨率），它会在荧光粉涂层上烧出一个漂亮的针孔。弄乱发送到 CRT 的信号并不难，您可以使用一些简单的 OUT 指令重新编程 CRT 控制器。抽烟？不，它在里面。有一两年的问题，那时我只是一只小狗。

我自己从来没有真正抽过一根，但伟大的城市教授神话。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-06T22:59:21.840

啊[杀手捅](http://en.wikipedia.org/wiki/Killer_poke)。这显然在某些非常早期的计算机模型上是可能的。[Commodore PET](http://en.wikipedia.org/wiki/Commodore_PET)是我脑海中浮现的一个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T21:43:55.707

这个神话可能会出现，因为显示器会产生一种效果，即不会改变的像素会变成“烧毁”，但这个词是俚语，而不是字面意义上的烧毁。

在 CRT 或 Plasma 上，您可以通过过度使用像素来“烧毁”像素，从而导致像素卡住。LCD 似乎会这样做，但如果您只是将显示器关闭几个小时，烧焦的图像就会消失，而另一方面，CRT 和等离子会永远损坏。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-15T02:35:29.770

通过将坏数据写入旧 PC 上的 crt 控制器，您绝对可以烧毁旧的（< 1990 显示器）。他们会抽烟并停止工作。当我还是 BIOS 编写器时，我就这样做了。

埃德

# msdn - Microsoft BizSpark 是否适合初创公司？

> ID：270407
> 
> 赞同：24
> 
> 时间：2008-11-06T21:41:54.167
> 
> 标签：msdn, bizspark

前几天我了解了[Microsoft BizSpark](http://www.microsoft.com/bizspark/)并开始了注册过程。有没有其他人听说过它或取得了成功？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-06T22:27:15.073

我不能专门为 BizSpark 说话（它太新了），但微软已经实施了类似的[Empower](http://www.empowerforisv.com/)计划 5 年左右。我们公司刚开始的时候，我们就加入了这个项目（并且参加了两年），这是一个非常棒的项目。

当然，主要的好处是您可以以如此低的成本访问 MSDN 订阅。不过，除此之外，它让我们与当地的微软办公室取得了联系，并为我们提供了一条通往典型 ISV 合作伙伴关系的清晰途径。您还会收到一些技术支持事件，当/如果您需要升级遇到的问题时，这些事件会很方便。

Empower 的要求非常简单……基本上承诺在两年内发布基于当前 Microsoft 堆栈的商业软件产品。

希望对您有所帮助...我期待听到更多关于 BizSpark 的不同之处 - 或者它是否只是 Empower 的下一个演变。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-07T06:00:38.293

好吧，我刚刚注册了……是的，当然要支付“最终游戏”金额……但是如果您无论如何都要使用 Microsoft 技术……那么这是一笔很棒的交易……我现在有了软件（今天)，并且有我需要的一切来开发我正在从事的项目......开源非常好，不要误会我的意思......但你必须出于正确的理由做出决定......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-24T21:01:10.430

我认为这是一个伟大的举措，他们正在赠送 Visual Studio 和 VS Team System 的最高（最昂贵）许可证。使用 Empower，您可以获得带有 MSDN 的 Visual Studio 专业版。需要指出的是，这不是针对顾问的，有一个名为 Microsoft Action Pack Subscription 的单独程序更适合该受众。Bizspark 计划是针对软件供应商的，我想它会有一些类似于 Empower 的要求，您必须在一定时间内发布商业软件。让我们知道您的注册情况...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-13T22:11:42.670

我最近加入并授权。我认为这很重要。我有一套旧的 MSDN 软件我正在使用，并且不喜欢将所有的钱花在我没有当前收入的创业公司的想法上。

显然 MS 真的很想重新吸引开发人员使用它的平台。

我可以看到的缺点之一（或根据您的观点的优点）[这需要健康的愤世嫉俗]是 MS 使用这个程序来

*   确定潜在市场，让它进入并击败竞争对手
*   确定它想要收购的初创公司。

它的数据库中包含您的所有信息 - 业务类型等。

我仍然加入了——没什么大不了的，但对于那些已经认为 MS 是大灰狼的人来说，这可能会以错误的方式摩擦他们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-14T23:15:11.627

我认为 BizSpark 对初创公司来说是一个很好的机会

*   知道他们将使用 Microsoft 技术
*   不知道用什么技术

那些不知道要使用哪种软件工具或编程语言的人可以测试微软的工具以及开源或其他免费或廉价的替代品。

通过这种方式，他们可以选择最适合他们的技术——在许可证费用方面也是如此——并且记得计算你用来管理许可证的时间。

最愉快的问候 Claus Ageskov，SALDI - 丹麦开源 ERP

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-11-07T05:31:51.907

我的 0.02 美元是一个陷阱。MS 知道许多初创公司，尤其是那些没有风险投资的初创公司（在我的书中，这使它们成为“真正的”初创公司），因为节省成本和控制你的命运——修复错误的能力，都涌向开源技术，修改东西，并防止供应商锁定，这是开源的最佳部分。MS 正试图诱骗他们被锁定。我会避开。但出于类似的原因，我也会避开风险投资。恕我直言，一家将真正走向成功的创业公司（不仅仅是被收购并像大多数泡沫公司一样成为资金池）是由一小群知识渊博的人创立的，资金来自这些人自己的口袋。做你喜欢的事是因为你想做，而不是因为你

# c++ - 在 C++ 中通过值传递还是通过常量引用传递更好？

> ID：270408
> 
> 赞同：227
> 
> 时间：2008-11-06T21:43:00.810
> 
> 标签：c++, variables, pass-by-reference, constants, pass-by-value

在 C++ 中通过值传递还是通过常量引用传递更好？

我想知道哪个是更好的做法。我意识到通过常量引用传递应该在程序中提供更好的性能，因为您没有制作变量的副本。

* * *

## 回答 #1

> 赞同：216
> 
> 时间：2008-11-06T21:49:23.980

通常建议最佳实践¹对***所有类型*****使用 pass by const ref ，除了内置类型（, ,等），迭代器和函数对象*`char``int``double`****（lambdas，派生自的类`std::*_function`）。*

 **在移动语义*存在之前尤其如此。原因很简单：如果您按值传递，则必须制作对象的副本，并且除了非常小的对象外，这总是比传递引用更昂贵。

使用 C++11，我们获得了[*移动语义*](https://stackoverflow.com/q/3106110/1968)。简而言之，移动语义允许在某些情况下，一个对象可以“按值”传递而不复制它。特别是，当您传递的对象是[*rvalue*](https://stackoverflow.com/q/3601602/1968)时，就是这种情况。

就其本身而言，移动对象仍然至少与通过引用传递一样昂贵。然而，在许多情况下，一个函数无论如何都会在内部复制一个对象——即它将获得参数的*所有权*。²

在这些情况下，我们有以下（简化的）权衡：

1.  我们可以通过引用传递对象，然后在内部复制。
2.  我们可以按值传递对象。

“按值传递”仍然会导致对象被复制，除非对象是右值。在右值的情况下，可以移动对象，因此第二种情况突然不再是“复制，然后移动”，而是“移动，然后（可能）再次移动”。

对于实现正确移动构造函数的大型对象（例如向量、字符串……），第二种情况比第一种更有效*。***因此，如果函数拥有参数的所有权，并且对象类型支持高效移动**，则建议使用按值传递。

* * *

历史注释：

事实上，任何现代编译器都应该能够找出何时按值传递代价高昂，并尽可能隐式地将调用转换为使用 const ref。

*理论上。*在实践中，编译器不能总是在不破坏函数的二进制接口的情况下改变它。在某些特殊情况下（当函数被内联时），如果编译器能够确定原始对象不会通过函数中的操作进行更改，则实际上会省略副本。

但总的来说，编译器无法确定这一点，而 C++ 中移动语义的出现使这种优化的相关性大大降低。

* * *

¹例如，Scott Meyers，*Effective C++*。

²对于对象构造函数来说尤其如此，它可以接受参数并将它们存储在内部，作为构造对象状态的一部分。

* * *

## 回答 #2

> 赞同：99
> 
> 时间：2008-11-07T05:52:25.283

**编辑：** Dave Abrahams 在 cpp-next 上的新文章：

## [想要速度？按值传递。](http://web.archive.org/web/20140113221447/http://cpp-next.com/archive/2009/08/want-speed-pass-by-value/)

* * *

对于复制成本较低的结构，按值传递具有额外的优势，即编译器可能会假设对象没有别名（不是相同的对象）。使用传递引用，编译器不能总是假设。简单的例子：

```
foo * f;

void bar(foo g) {
    g.i = 10;
    f->i = 2;
    g.i += 5;
} 
```

编译器可以将其优化为

```
g.i = 15;
f->i = 2; 
```

因为它知道 f 和 g 不共享相同的位置。如果 g 是一个引用 (foo &)，编译器就无法假设。因为 gi 可以被 f->i 别名化，并且必须具有 7 的值。所以编译器必须从内存中重新获取 gi 的新值。

有关更实用的规则，请参阅[Move Constructors](http://www.ddj.com/database/184403855)文章中的一组很好的规则（强烈推荐阅读）。

*   如果函数打算将参数更改为副作用，请通过非常量引用获取它。
*   如果函数不修改其参数并且参数是原始类型，则按值获取。
*   否则通过 const 引用获取，但以下情况除外
    *   如果该函数无论如何都需要复制 const 引用，请按值获取。

上面的“原始”基本上是指几个字节长并且不是多态（迭代器、函数对象等）或复制成本高的小数据类型。在那篇论文中，还有另一条规则。这个想法是，有时人们想要复制一份（以防参数无法修改），有时则不想（以防万一，如果参数是临时的，则想在函数中使用参数本身， 例如）。该论文详细解释了如何做到这一点。在 C++1x 中，该技术可以在语言支持下本地使用。在那之前，我会遵守上述规则。

示例：要使字符串大写并返回大写版本，应始终按值传递：无论如何都必须获取它的副本（不能直接更改 const 引用）-因此最好使其尽可能透明调用者并尽早制作该副本，以便调用者可以尽可能地优化 - 如该论文中所述：

```
my::string uppercase(my::string s) { /* change s and return it */ } 
```

但是，如果您无论如何都不需要更改参数，请通过引用 const 来获取它：

```
bool all_uppercase(my::string const& s) { 
    /* check to see whether any character is uppercase */
} 
```

但是，如果您参数的目的是在参数中写入一些东西，那么通过非常量引用传递它

```
bool try_parse(T text, my::string &out) {
    /* try to parse, write result into out */
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-11-06T21:47:18.413

取决于类型。您正在增加必须进行引用和取消引用的小开销。对于大小等于或小于使用默认复制 ctor 的指针的类型，按值传递可能会更快。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-11-06T21:56:34.573

正如已经指出的那样，这取决于类型。对于内置数据类型，最好按值传递。即使是一些非常小的结构，例如一对整数，也可以通过按值传递来更好地执行。

这是一个示例，假设您有一个整数值并且您想将它传递给另一个例程。如果该值已被优化为存储在寄存器中，那么如果您想将其作为引用传递，则必须首先将其存储在内存中，然后将指向该内存的指针放在堆栈上以执行调用。如果它是按值传递的，那么只需要将寄存器压入堆栈即可。（细节比给定不同的调用系统和CPU要复杂一些）。

如果你在做模板编程，你通常会被迫总是通过 const ref 传递，因为你不知道传入的类型。传递错误值的惩罚比传递内置类型的惩罚要糟糕得多通过常量参考。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-06-11T07:02:41.710

这是我在设计非模板函数的接口时通常的工作方式：

1.  如果函数不想修改参数并且值复制起来很便宜（int、double、float、char、bool 等...请注意 std::string、std::vector 和其余部分，则按值传递标准库中的容器不是）

2.  如果值复制成本很高并且函数不想修改指向的值并且 NULL 是函数处理的值，则传递 const 指针。

3.  如果值复制成本很高并且函数想要修改指向的值并且 NULL 是函数处理的值，则通过非常量指针传递。

4.  当值复制成本高且函数不想修改引用的值时，通过 const 引用传递，如果使用指针代替，NULL 将不是有效值。

5.  当值复制成本很高并且函数想要修改所引用的值并且如果使用指针代替，NULL 将不是有效值时，通过非常量引用传递。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-11-06T21:44:24.863

听起来你得到了答案。按值传递是昂贵的，但如果您需要，它会给您一个副本以供使用。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-11-06T21:50:21.077

通常，通过 const 引用传递更好。但是，如果您需要在本地修改函数参数，则最好使用按值传递。对于某些基本类型，按值传递和按引用传递的性能通常相同。实际上引用内部由指针表示，这就是为什么您可以期望例如指针的两个传递在性能方面是相同的，或者由于不必要的取消引用，甚至按值传递可以更快。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-10-29T13:48:09.627

通过值传递小类型。

传递大类型的 const 引用（大的定义可能因机器而异）但是，在 C++11 中，如果您要使用数据，则按值传递，因为您可以利用移动语义。例如：

```
class Person {
 public:
  Person(std::string name) : name_(std::move(name)) {}
 private:
  std::string name_;
}; 
```

现在调用代码会做：

```
Person p(std::string("Albert")); 
```

并且只会创建一个对象并将其直接移动到`name_`class 中的 member 中`Person`。如果您通过 const 引用传递，则必须制作一个副本以将其放入`name_`.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-06T22:04:00.300

根据经验，非类类型的值和类的 const 引用。如果一个类真的很小，那么按值传递可能会更好，但差异很小。您真正要避免的是按值传递一些巨大的类并将其全部复制 - 如果您传递一个包含相当多元素的 std::vector ，这将产生巨大的影响。

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2021-04-24T08:39:21.710

通过引用传递比通过值传递更好。我正在解决 Leetcode 上最长的公共子序列问题。它显示 TLE 以通过值传递，但接受了代码以通过引用传递。我花了 30 分钟才弄清楚这一点。

* * *

## 回答 #11

> 赞同：-6
> 
> 时间：2015-01-05T04:06:52.197

简单的区别：-在函数中我们有输入和输出参数，所以如果您传递的输入和输出参数相同，则使用引用调用，否则如果输入和输出参数不同，则最好使用值调用。

例子 `void amount(int account , int deposit , int total )`

输入参数：account，deposit输出参数：total

输入和输出是不同的使用 vaule 调用

2.  `void amount(int total , int deposit )`

输入总额 存款 输出总额

# com - 如何使用 Skype4Com 找到麦克风音频的采样率？

> ID：270411
> 
> 赞同：0
> 
> 时间：2008-11-06T21:43:38.093
> 
> 标签：com, audio, skype

我正在使用 Skype4Com COM 对象来截取来自麦克风的音频。我知道它是 16 位单声道，但我如何知道它的采样率是多少？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-03-28T20:07:01.827

我知道可以通过 wav 文件手动设置输入。唯一允许的频率是 16,000 Hz。我认为用于传输的速率也是 16,000 Hz。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-06T14:53:56.947

目前看来，Skype4Com 中没有确定麦克风采样率的工具。我的实验表明它是 16kHz。

# .net - Activator.GetObject - MarshalByRefObject

> ID：270427
> 
> 赞同：1
> 
> 时间：2008-11-06T21:46:54.687
> 
> 标签：.net, remoting, appdomain, proxy-classes

在 .Net Activator.GetObject(Type type, string url, object data) 中返回对象的代理。我猜这个代理继承自 MarshalByRefObject 并且可以跨 AppDomains 发送。我对吗？

在我的应用程序中，我在 appdomain A 中创建一个对象并使用它 appdomain B。该对象的成员是使用 Activator.GetObject () 创建的代理对象。因此，当我在 AppDomain B 中时，我对在 appdomain A 中创建的对象有一个透明代理。当我尝试对代理对象执行调用该方法时，我遇到了错误。

例如，我在 App Domain B 中创建了一个 Connection 对象。我在 App Domain A 中有 Connection 对象的透明代理。当我尝试从 AppDomain A 进行这样的调用时遇到错误。 ConnectionObject.SecurityProxy.GetSecurityAccount ( )。看起来问题是当我尝试像上面那样拨打电话时，它试图在 AppDomain A 中再次创建 SecurityProxy，而不是将呼叫转发到 AppDomain B。连接时已经在 AppDomain B 中创建了安全代理对象被创建。

你能帮我弄清楚我做错了什么吗？

问候，阿尼尔。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-06-19T15:46:57.263

假设 SecurityProxy 是 ConnectionObject 上的一个属性...

您正在处理域 A 中的 ConnectionObject 代理。方法调用被转发到域 B，在那里它们被执行，结果返回到域 A。

属性是一种编译器技巧。它使 get_X 和 set_X 这两个方法看起来是一个字段。

因此，当您调用“ConnectionObject.SecurityProxy”时，您正在调用一个方法，该方法返回一个跨 appdomain 边界的 SecurityProxy 实例。

您必须做以下两件事之一：创建和解包 SecurityProxy 的实例并将其交给 ConnectionObject，或者将 ConnectionObject 转变为仅公开方法并仅返回您绝对知道可以安全跨越 appdomain 边界的类型/参数的外观。

# reporting-services - Reporting Services 报表中的自定义代码

> ID：270434
> 
> 赞同：6
> 
> 时间：2008-11-06T21:49:21.280
> 
> 标签：reporting-services

在 Reporting Services 中，我想添加一个包含自定义代码块数据的参数。理想情况下，我将能够运行以下代码（这是一个简单的测试示例）：

```
Function GetPeriods() As String()
 Dim values As System.Collections.ArrayList = 
    New System.Collections.ArrayList()
 For i as integer = 1 to 24
    values.Add(i)
 Next
 Return values.ToArray()
End Function 
```

并将以下内容放入参数的“文本字段”中：

```
=Code.GetPeriods() 
```

但是，当我运行报告时，我应用它的参数被禁用并为空。是否应该使用不同的技术？还是我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T03:56:46.320

您将数组项（字符串数组）返回到文本字段中。相反，尝试返回一个纯字符串。那应该行得通。如果您仍想返回一个数组列表，则基本上必须将其绑定到 RDL 中的列表控件。您绝对可以使用数据集扩展来做到这一点。但是，我不确定是否还有其他简单的方法。检查列表控件的属性，看看它是否允许您直接绑定到数组列表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-11T03:02:20.680

如果您使用的是 SQL 2008 Reporting Services，那么您可以查看[此页面](http://msdn.microsoft.com/en-au/library/ms153561.aspx)，该页面介绍了使用自定义程序集的概念。

如果您使用的是 SQL 2005 Reporting Services，那么[此链接](http://msdn.microsoft.com/en-au/library/ms153561(SQL.90).aspx)就是您想要的。

这是一件微不足道的事情，只需将您的代码编译到类库中并按照提供的说明允许您的报告引用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-03T14:51:26.180

我检查了你的代码。唯一错误的是您的函数返回`String()`。当我将您的方法签名更改为 return`Array`时，它在我的报告中运行良好。

将签名更改为`Function GetPeriods() As Array`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-17T01:56:42.443

您可以在 SQL Server 上创建相同的存储过程并从该过程加载参数值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-28T19:13:58.563

要访问在 SSRS 报告的自定义代码中实现的成员/函数，您应该将访问修饰符设置为“Public”：

```
Public Function GetPeriods() As String
... 
```

请参阅文章[在 SQL Server Reporting Services 中编写自定义代码](http://blogs.sqlxml.org/bryantlikes/articles/824.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-07-31T15:53:19.333

我一直在尝试做同样的事情，从报告代码中设置一个简单的参数值列表。这些答案中的任何一个链接都没有显示如何做到这一点，经过相当多的挖掘后，我认为这甚至是不可能的。是的，可以从数据库查询、Web 服务或自定义程序集中获取值，但与从 =Code.GetValues() 等简单函数调用获取列表相比，这些值都会产生大量开销，其中函数使用 For 循环来创建值。

msvcyc 正确地指出参数需要一个字符串值，但函数返回一个数组。我按照prashant sable的建议将返回类型更改为Array，但选择列表仍然显示为灰色，它不起作用。而coldice 说访问修饰符应该是Public 是正确的。

在我的挖掘中，我发现 [了 James Kovac](http://www.jameskovacs.com/blog/CommentView.aspx?guid=31eeaafd-a118-4e76-917d-78d54441aee9) 2005 年的一篇文章，指出了为什么这是不可能的。Parameters 类有一个 get 方法，但没有 set 方法。在 SSRS 2008 的 VS 2008 对象浏览器中，对象名称已更改，但仍不包含设置方法（请参阅 Microsoft.ReportingServices.Interfaces.IParameter.Name 或 .Value）。

我当前的解决方法是对值列表进行硬编码，但如果您的值列表需要是动态的，那么您唯一的选择是数据库查询、Web 服务或自定义程序集。我认为这三个中最简单的解决方法是从数据库引擎中获取值，正如 oleksiy.t 所建议的那样，只要您可以编写一个查询来返回您想要的值列表。您的整数列表或我的时间间隔列表都将是易于编写的查询。否则，您将需要使用其他两种解决方法之一。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-07T21:46:32.800

我所看到的一切都需要参数及其各自的设置成为 RDL 的一部分。

话虽如此，如果您要“硬编码”这些值，您可以为报表创建一个数据集，可能是在 XML 中，或者如果它需要以编程方式驱动，则在 Web 服务中进行。

# visual-studio - 哪里可以下载旧版本的 Visual C++ Express

> ID：270437
> 
> 赞同：3
> 
> 时间：2008-11-06T21:49:38.423
> 
> 标签：visual-studio, visual-c++

有没有办法下载旧版本的 Visual C++ Express。我对 Visual C++ 2005 Express (PRIOR SP1) 和 Visual C++ Toolkit 2003 特别感兴趣。我尝试用谷歌搜索它们，但所有链接到 microsoft.com 的网站都被微软（出于某种原因）从那里删除。

如果有人能帮助我解决这个问题，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-07T15:34:11.430

我也将它放在上面的评论中，但只是为了确保您不会错过它：如果您尝试这样做是因为您在部署和不同版本的 dll 方面遇到问题，请查看[App does not使用 VS 2008 SP1 DLL 运行，以前的版本适用于 RTM 版本](https://stackoverflow.com/questions/59635/app-does-not-run-with-vs-2008-sp1-dlls-previous-version-works-with-rtm-versions#70808)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-07T06:30:19.967

如果您想将您的应用程序与 CRT（C 运行时）的 RTM（SP1 之前）版本链接，您显然可以通过在您的项目或编译器命令行中[定义来实现。`_USE_RTM_VERSION`](http://social.msdn.microsoft.com/Forums/en-US/vcgeneral/thread/13efe532-8a62-4951-b636-39e4589e65a5/)

此外，[将 CRT 部署为专用程序集](http://msdn.microsoft.com/en-us/library/ms235291.aspx)仍应适用于 CRT 的 SP1 版本。如果这是您尝试做的事情，那么发布有关问题所在的更多信息可能会帮助您找到解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T22:35:38.147

微软拥有它。如果他们不再有链接，我认为你不走运。

我敢打赌，如果他们在网络上找到副本，他们的网络爬虫会自动为他们的律师寻呼。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-03-15T17:58:48.203

对于我们这些在 2010 年之后寻找此答案的人，以下链接在此发布时有效：

[旧版 Visual Studio 下载](https://www.visualstudio.com/vs/older-downloads/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T21:54:35.340

没有充分的理由在 SP1 之前运行 2005，您确实意识到 2005 /w SP1 编译的代码将为最终用户运行相同的代码，他们不需要安装 .NET SP 来运行代码。

SP 修复了错误、安全漏洞和各种改进，几乎没有功能更改，您只会因为不使用 /w 最新的 SP 而松懈。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-11-06T22:00:39.777

根据我的个人经验，如果最终用户没有安装可再发行组件，那么使用 SP1 编译的软件将无法正常工作。但是，如果没有 SP1，如果您将其与所需的 .dll 一起分发，则可以使 .exe 正常工作。

# winapi - 如何在 DoDragDrop 中重绘 UI

> ID：270438
> 
> 赞同：3
> 
> 时间：2008-11-06T21:49:42.683
> 
> 标签：winapi, visual-c++

我正在将我的应用程序实现为拖动源。当我调用 DoDragDrop（Win32 调用，而不是 MFC）时，它会进入模式循环，并且在 DoDragDrop 返回之前，我不会在主窗口中收到重绘消息。不幸的是，如果我在 shell（一个文件）中做了一个 drop 并且文件名已经存在，shell 会询问我是否要替换该文件。但是由于我的应用程序因为 DoDragDrop 没有返回而被阻止，所以它没有重新绘制并且看起来“冻结”。

有什么线索吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-02-02T14:37:01.633

你试过计时器吗？我遇到了`DoDragDrop()`与其他阻塞调用相同的问题，并`SHFileOperation()`使用对`SetTimer()`.

编辑：如果您想要更多控制，`DoDragDrop()`那么工作线程运行良好。正如有人建议的那样，您可以尝试调用`DoDragDrop()`工作线程，但我无法让鼠标捕获正常工作。一个更简单的解决方案是调用`DoDragDrop()`主线程并让工作线程定期`WM_USER`向主线程的队列发布消息。 `DoDragDrop()`然后将检索消息并将其分派到您的窗口`WndProc()`，此时只要队列保持为空，您就可以执行空闲处理。如果你给工作线程一个比主线程低的优先级，那么它会`WM_USER`在主线程空闲时立即执行并发布消息（即，只要`DoDragDrop()`完成处理所有用户输入并在内部调用 MsgWaitForMultipleObjects()）。此方法比该`SetTimer()`方法更好，因为它使您的应用程序可以完全控制 CPU。从处理程序返回后，您不必等待最多 10 毫秒（`SetTimer()`允许的最小频率），`WM_TIMER`然后再到达下`WM_TIMER`一条消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T14:48:58.993

我建议在不同的线程上运行拖放操作。这样，DoDragDrop() 将阻塞新线程中的消息循环，而不是 UI 线程中的消息循环。如果您采用这种方法，您还应该考虑（在我的脑海中）：

1.  可能从主线程和拖放线程运行的任何代码都需要可重入。作为推论，您将需要保护主线程和拖放线程使用的任何数据结构。如果您的应用程序已经是多线程的，那么您应该熟悉这些问题。
2.  您应该考虑如果您的用户从不响应 shell 的对话框会发生什么。他可以继续与你的 UI 交互吗？他能否使在挂起操作中“丢弃”的数据无效？他可以退出你的申请吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-11T18:41:07.603

似乎真正的答案是在我的数据对象中实现 IAsyncOperation。

# java - SQL删除级联帮助（具体问题）

> ID：270440
> 
> 赞同：1
> 
> 时间：2008-11-06T21:49:51.390
> 
> 标签：java, sql, jdbc, constraints, hsqldb

我在 HSQL 数据库中有两个具有多对多关系的表（为说明目的而重命名/重构）。当我从多对多关系的一侧删除时，我希望所有内容都被清除（不查询表；这对性能至关重要）

这是我的主要表格：

```
CREATE TABLE PERSON
(
    PERSON_ID INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, 
    NAME VARCHAR(50)
)

CREATE TABLE JOB
(
    JOB_ID INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, 
    NAME VARCHAR(50)
) 
```

这是我的联接表：

```
CREATE TABLE JOB_PERSON
(
    PERSON_ID INTEGER, 
    JOB_ID INTEGER
) 
```

这是我的限制：

```
ALTER TABLE JOB_PERSON ADD 
    CONSTRAINT FK_PERSON_JOB FOREIGN KEY(PERSON_ID) 
    REFERENCES PERSON ON DELETE CASCADE ON UPDATE CASCADE 

ALTER TABLE JOB_PERSON ADD
    CONSTRAINT FK_JOB_PERSON FOREIGN KEY(JOB_ID) 
    REFERENCES JOB ON DELETE CASCADE ON UPDATE CASCADE 
```

我基本上想这样做：“从person_id = 0的人中删除”并让它从PERSON、JOB_PERSON和JOB中删除所有内容，如果JOB实体将被孤立（不再在多对多表中引用）

在不查询数据库的情况下这可能吗？当我删除时，它只会从 PERSON 和 JOB_PERSON 中删除。您可能会说，我缺乏 sql 技能。

这是我一直在玩的虚拟数据：

```
insert into person values(null,'Arthur');
insert into person values(null,'James');
insert into job values(null, 'Programmer')
insert into job values(null, 'Manager')
insert into job_person values(0,0);
insert into job_person values(0,1);
insert into job_person values(1,1); 
```

因此，如果我输入这两个语句：

```
delete from person where person_id=0
delete from person where person_id=1 
```

我想删除所有 3 个表中的所有内容。可能的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T21:51:30.480

创建一个您传递 ID 的存储过程，然后按您需要的顺序简单地删除正确的行。

这样，您的应用程序就不会与确切的顺序相关联，这在未来可能会随着数据库的重新设计而改变。您还可以获得额外的好处，即存储过程比发送一堆查询更快。

尽管如果您在尝试删除该条目时绝对想要一种删除依赖表的方法，则必须使用触发器，但触发器的规则是，尽可能避免使用它们，如果存在其他解决方案，请使用它。所以最终，使用存储过程是最好的解决方案。

# java - javax.servlet.ServletException：在范围内找不到 bean [名称]

> ID：270444
> 
> 赞同：18
> 
> 时间：2008-11-06T21:50:11.233
> 
> 标签：java, jsp, usebean

我收到此错误：

```
javax.servlet.ServletException: bean not found within scope 
```

在顶部带有此的页面上。

```
<jsp:useBean id="bean" type="com.example.Bean" scope="request" /> 
```

该类存在于类路径中，它今天早上工作，我不明白在范围内找不到的意思。

这是如何引起的，我该如何解决？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2010-06-12T16:44:41.120

您需要`class`属性而不是`type`属性。

以下：

```
<jsp:useBean id="bean" type="com.example.Bean" scope="request" /> 
```

*基本上*在幕后执行以下操作：

```
Bean bean = (Bean) pageContext.getAttribute("bean", PageContext.REQUEST_SCOPE);

if (bean == null) {
    throw new ServletException("bean not found within scope");
}

// Use bean ... 
```

而以下：

```
<jsp:useBean id="bean" class="com.example.Bean" scope="request" /> 
```

基本上在幕后执行以下操作：

```
Bean bean = (Bean) pageContext.getAttribute("bean", PageContext.REQUEST_SCOPE);

if (bean == null) {
    bean = new Bean();
    pageContext.setAttribute("bean", bean, PageContext.REQUEST_SCOPE);
}

// Use bean ... 
```

如果它以前工作过并且“突然”没有工作，那么这意味着负责将 bean 放入范围的*东西已经停止工作。*例如，一个 servlet 在 中执行以下操作`doGet()`：

```
request.setAttribute("bean", new Bean());
request.getRequestDispatcher("page.jsp").forward(request, response); 
```

也许您已经通过 URL 直接调用 JSP 页面，而不是通过 URL 调用 Servlet。如果您想禁用对 JSP 页面的直接访问，请将它们放入`/WEB-INF`并转发给它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T17:18:31.407

您必须添加

```
<jsp:useBean id="givingFormBean" type="some.packg.GivingForm" scope="request" /> 
```

因为默认情况下，bean 是[在*页面*范围内查看的](http://java.sun.com/products/jsp/tags/11/syntaxref11.fm14.html)

# java - Maven 编译多个 src 目录

> ID：270445
> 
> 赞同：207
> 
> 时间：2008-11-06T21:50:12.637
> 
> 标签：java, maven-2

有没有办法在单个 maven 项目中编译多个 java 源目录？

* * *

## 回答 #1

> 赞同：291
> 
> 时间：2008-11-06T22:01:36.780

您可以使用 build-helper 添加新的源目录：

```
<build>
    <plugins>
        <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>build-helper-maven-plugin</artifactId>
            <version>3.2.0</version>
            <executions>
                <execution>
                    <phase>generate-sources</phase>
                    <goals>
                        <goal>add-source</goal>
                    </goals>
                    <configuration>
                        <sources>
                            <source>src/main/generated</source>
                        </sources>
                    </configuration>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build> 
```

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2014-05-13T07:52:46.787

我天真地这样做：

```
<build>
  <finalName>osmwse</finalName>
  <sourceDirectory>src/main/java, src/interfaces, src/services</sourceDirectory>
</build> 
```

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2008-11-06T21:51:31.340

这对我有用

```
<build>
    <sourceDirectory>.</sourceDirectory>
    <plugins>
        <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
        <configuration>
        <includes>
            <include>src/main/java/**/*.java</include>
            <include>src/main2/java/**/*.java</include>
        </includes>
        </configuration>
        </plugin>
    </plugins>
</build> 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2012-02-22T12:53:27.750

要使其在 intelliJ 中工作，您还可以通过以下方式将 generatedSourcesDirectory 添加到编译器插件：

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-compiler-plugin</artifactId>
    <version>3.8.1</version>
    <configuration>
        <generatedSourcesDirectory>src/main/generated</generatedSourcesDirectory>
    </configuration>
</plugin> 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2013-08-17T01:39:48.753

通过定义资源标签，这也适用于 maven。您可以随意命名您的 src 文件夹名称。

```
 <resources>
        <resource>
            <directory>src/main/java</directory>
            <includes>
                <include>**/*.java</include>
                <include>**/*.properties</include>
                <include>**/*.xml</include>
            </includes>
        </resource>

        <resource>
            <directory>src/main/resources</directory>
            <includes>
                <include>**/*.java</include>
                <include>**/*.properties</include>
                <include>**/*.xml</include>
            </includes>
        </resource>

        <resource>
            <directory>src/main/generated</directory>
            <includes>
                <include>**/*.java</include>
                <include>**/*.properties</include>
                <include>**/*.xml</include>
            </includes>
        </resource>
    </resources> 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2019-11-04T13:56:50.400

这适用于 maven 3.5.4，现在 Intellij Idea 将此代码视为源代码：

```
<plugin>
     <groupId>org.apache.maven.plugins</groupId>
     <artifactId>maven-compiler-plugin</artifactId>
     <version>3.3</version>
     <configuration>
         <generatedSourcesDirectory>src/main/generated</generatedSourcesDirectory>                    
     </configuration>
</plugin> 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-01-23T13:22:27.497

虽然来自 evokk 的答案基本上是正确的，但它缺少**test classes**。您必须添加目标**为 add-test-source 的**测试类：

```
<execution>
    <phase>generate-sources</phase>
    <goals>
        <goal>add-test-source</goal>
    </goals>
    <configuration>
       <sources>
            <source>target/generated/some-test-classes</source>
        </sources>
    </configuration>
</execution> 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-11-11T08:32:07.293

使用帖子中的 build-helper-maven-plugin - 并更新 src/main/generated。mvn clean compile 在我的 ../common/src/main/java 或 ../common 上工作，所以保留后者。然后是的，确认 IntelliJ IDEA (ver 10.5.2) 级别的编译失败，正如 David Phillips 提到的那样。问题是 IDEA 没有向项目添加另一个源根目录。手动添加它解决了这个问题。这不好，因为编辑项目中的任何内容都应该来自 maven，而不是直接编辑 IDEA 的项目选项。然而，我将能够忍受它，直到他们直接支持 build-helper-maven-plugin 以便它会自动添加源。

然后需要另一种解决方法来完成这项工作。由于每次在 pom 更改后 IDEA 重新导入 maven 设置时，我新添加的源都保留在模块上，但它丢失了它的源文件夹选择并且没用。所以对于 IDEA - 需要设置一次：

*   选择 - 项目设置/Maven/导入/重新导入时保留源和测试文件夹。
*   添加 - 项目结构 / 项目设置 / 模块 / {Module} / 源 / 添加内容根目录。

现在，将这些文件夹保持在导入状态也不是世界上最好的做法，......但试一试。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-02-16T17:44:55.893

这可以分两步完成：

*   对于每个源目录，您应该创建自己的模块。
*   在所有模块中，您应该指定相同的构建目录：`${build.directory}`

如果您使用已启动的 Jetty ( `jetty:run`)，那么在任何模块（使用 Maven、IDEA 或 Eclipse）中重新编译任何类都会导致 Jetty 重新启动。对于修改的资源，您将获得相同的行为。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-07-07T14:54:13.927

在配置中，您可以使用`<compileSourceRoots>`.

```
oal:          org.apache.maven.plugins:maven-compiler-plugin:3.8.1:compile (default-cli)
[DEBUG] Style:         Regular
[DEBUG] Configuration: <?xml version="1.0" encoding="UTF-8"?>
<configuration>
  <basedir default-value="${basedir}"/>
  <buildDirectory default-value="${project.build.directory}"/>
  <compilePath default-value="${project.compileClasspathElements}"/>
  <compileSourceRoots default-value="${project.compileSourceRoots}"/>
  <compilerId default-value="javac">${maven.compiler.compilerId}</compilerId>
  <compilerReuseStrategy default-value="${reuseCreated}">${maven.compiler.compilerReuseStrategy}</compilerReuseStrategy>
  <compilerVersion>${maven.compiler.compilerVersion}</compilerVersion>
  <debug default-value="true">${maven.compiler.debug}</debug>
  <debuglevel>${maven.compiler.debuglevel}</debuglevel>
  <encoding default-value="${project.build.sourceEncoding}">${encoding}</encoding>
  <executable>${maven.compiler.executable}</executable>
  <failOnError default-value="true">${maven.compiler.failOnError}</failOnError>
  <failOnWarning default-value="false">${maven.compiler.failOnWarning}</failOnWarning>
  <forceJavacCompilerUse default-value="false">${maven.compiler.forceJavacCompilerUse}</forceJavacCompilerUse>
  <fork default-value="false">${maven.compiler.fork}</fork>
  <generatedSourcesDirectory default-value="${project.build.directory}/generated-sources/annotations"/>
  <maxmem>${maven.compiler.maxmem}</maxmem>
  <meminitial>${maven.compiler.meminitial}</meminitial>
  <mojoExecution default-value="${mojoExecution}"/>
  <optimize default-value="false">${maven.compiler.optimize}</optimize>
  <outputDirectory default-value="${project.build.outputDirectory}"/>
  <parameters default-value="false">${maven.compiler.parameters}</parameters>
  <project default-value="${project}"/>
  <projectArtifact default-value="${project.artifact}"/>
  <release>${maven.compiler.release}</release>
  <session default-value="${session}"/>
  <showDeprecation default-value="false">${maven.compiler.showDeprecation}</showDeprecation>
  <showWarnings default-value="false">${maven.compiler.showWarnings}</showWarnings>
  <skipMain>${maven.main.skip}</skipMain>
  <skipMultiThreadWarning default-value="false">${maven.compiler.skipMultiThreadWarning}</skipMultiThreadWarning>
  <source default-value="1.6">${maven.compiler.source}</source>
  <staleMillis default-value="0">${lastModGranularityMs}</staleMillis>
  <target default-value="1.6">${maven.compiler.target}</target>
  <useIncrementalCompilation default-value="true">${maven.compiler.useIncrementalCompilation}</useIncrementalCompilation>
  <verbose default-value="false">${maven.compiler.verbose}</verbose>
</configuration> 
```

这些是 3.8.1 版本的编译器插件可用的所有配置。不同的版本有不同的配置，您可以通过`-X`在通用 mvn 命令之后运行代码来找到这些配置。像

```
mvn clean install -X
mvn compiler:compile -X 
```

并使用 id 或目标或插件名称搜索这也可能对其他插件有所帮助。Eclipse、intelliJ 可能不会将所有配置都显示为建议。

# security - 在 IIS 6.0 中使用 SSLv3

> ID：270453
> 
> 赞同：7
> 
> 时间：2008-11-06T21:52:31.913
> 
> 标签：security, iis, ssl

我最近收到来自 McAfee 服务（以前称为 HackerSafe）的通知，说我的网站正在使用 SSLv2，它应该使用 SSLv3。我对 SSL 的版本一无所知。我的网站使用的是 IIS 6.0，是否有设置可以打开 SSLv3，或者我是否需要安装一些东西才能做到这一点？另外，只使用 SSLv3 有什么缺点吗？是否有只能使用 v2 的浏览器？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-13T22:54:52.280

TravisO 的答案中引用的[Microsoft 知识库文章](http://support.microsoft.com/kb/187498/en-us)有助于一般参考。我使用了那篇文章中的信息以及从 ServerSniff.net 的[SSL 分析工具收集的信息](http://serversniff.net/sslcheck.php)

此外，您可以将以下代码段复制并粘贴到 .reg 文件中，以快速禁用 Web 场上的 SSLv2：

```
Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 2.0\Server]
"Enabled"=dword:00000000 
```

关于 SSLv3 的浏览器支持，以下信息应该会有所帮助（取自 McAfee Scan Alert）：

> 在 Internet Explorer 7 中，默认 HTTPS 协议设置已更改为禁用较弱的 SSLv2 协议并启用较强的 TLSv1 协议。默认情况下，IE7 用户只会使用 SSLv3 或 TLSv1 协商 HTTPS 连接。Mozilla Firefox 预计将在其即将发布的版本中放弃对 SSLv2 的支持。
> 
> 由于几乎所有现代浏览器都支持 SSLv3，因此禁用对较弱 SSL 方法的支持应该具有最小的影响。以下浏览器支持 SSLv3：
> 
> *   Internet Explorer 5.5 或更高版本 (PC)
> *   Internet Explorer 5.0 或更高版本 (Mac)
> *   Netscape 2.0（国内）或更高版本（PC/Mac）
> *   Firefox 0.8 或更高版本 (PC/Mac/Linux)
> *   Mozilla 1.7 或更高版本 (PC/Mac/Linux)
> *   卡米诺 0.8 或更高 (Mac)
> *   Safari 1.0 或更高版本 (Mac)
> *   Opera 1.7 或更高版本 (PC/Mac)
> *   Omniweb 3.0 或更高版本 (Mac)
> *   Konqueror 2.0 或更高版本 (Linux)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-06T22:03:18.210

微软有一篇关于禁用 SSLv3 的知识库文章，显然它与启用它在同一个地方。 [http://support.microsoft.com/kb/187498/en-us](http://support.microsoft.com/kb/187498/en-us)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T23:17:29.820

如果您正在考虑修复此问题，您可能还希望修复弱密码，因为大多数扫描仪都会抱怨这两者。那是[Microsoft KB245030](http://support.microsoft.com/kb/245030)。通常，任何支持 SSLv3 的浏览器也将支持比该链接处的脚本关闭的密码更新和更强的密码。

# c++ - 是否可以用 C++ 对 iPhone 进行编程

> ID：270455
> 
> 赞同：126
> 
> 时间：2008-11-06T21:53:12.067
> 
> 标签：c++, iphone, objective-c

我完全支持语言多样性，但 Objective C 太疯狂了。所以我很好奇：是否可以在使用 Cocoa API 等的同时使用 C++ 编写 iPhone 应用程序？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2008-11-06T22:01:52.863

尽管 Objective-C 最初看起来确实很“疯狂”，但我鼓励你坚持下去。一旦你有一个“啊哈”的时刻，突然间一切都开始变得有意义了。对我来说，我花了大约 2 周的时间专注于 Objective-C 来真正理解 Cocoa 框架、语言以及它们如何组合在一起。但是一旦我真正“得到”它，那是非常非常令人兴奋的。

这听起来陈词滥调，但这是真的。坚持到底。

当然，如果您要引入 C++ 库或现有 C++ 代码，您可以将这些模块与 Objective-C/Objective-C++ 一起使用。

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2008-11-06T21:55:21.377

简短的回答，是的，有点。您可以使用 Objective-C++，您可以在[Apple Developer Connection 上阅读。](http://web.archive.org/web/20101203170217/http://developer.apple.com/library/mac/#/web/20101204020949/http://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/ObjectiveC/Articles/ocCPlusPlus.html)

如果您已经了解 C++，那么学习 Objective-C 将非常简单，如果您决定尝试一下。有关该主题的更多信息也在 ADC 上。

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2008-11-06T23:39:33.303

我使用 Objective-C 将 UI 拼接在一起。
但是代码的核心部分仍然是用 C++ 编写的。

这就是 Objective-C 的 UI 界面和处理事件的主要目的。
它非常适合这个目的。

我仍然喜欢 C++ 作为代码的后端（但这主要是因为我喜欢 C++）你也可以很容易地使用 Objective-C 作为应用程序的后端。

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2008-11-06T23:39:24.133

首先，说 Objective-C 是“疯狂的”是很幽默的——我身边放着一本 Bjarne Stroustrup C++ 的书，它有 1020 页。Apple 在 Objective-C 上的 PDF 是 141。

如果您想使用 UIKit，那么您在 C++ 中做任何事情都会非常非常困难。任何符合 Apple UI 的严肃 iPhone 应用程序都需要使用 Objective-C 编写其 UI 部分。只有在编写 OpenGL 游戏时，您才能几乎完全坚持使用 C/C++。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2008-11-09T17:43:27.550

有了这方面的经验，您确实可以将 C++ 代码用于您的“核心”代码，但您必须将 Objective-C 用于任何 iPhone 特定的代码。

不要试图强迫 Objective-C 表现得像 C++。起初在您看来这是可能的，但生成的代码确实不能很好地与 Cocoa 一起工作，而且您会对发生的事情感到非常困惑。花点时间在没有任何 C++ 的情况下正确学习如何构建 GUI 和 iPhone 应用程序，然后链接到您的 C++ 基础。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-01-22T15:12:40.537

您必须使用 Objective C 来与 Cocoa API 交互，所以别无选择。当然，您可以在幕后使用尽可能多的 C++（Objective C++ 使这变得简单）。

这确实是一种疯狂的语言，但一旦你有点习惯了，它也很有趣。:-)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-05-12T04:51:29.430

我不确定 C++，但您绝对可以使用名为[MonoTouch](http://xamarin.com/monotouch)的产品在 C# 中编写 iPhone 应用程序。

您可以查看这篇文章，详细讨论 MonoTouch Vs Obj-C：[如何在 MonoTouch 和 Objective-C 之间做出决定？](https://stackoverflow.com/questions/1583856/how-to-decide-between-monotouch-and-objective-c)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-10-27T15:20:38.570

我正在将一个用 Java 编写的计算密集型 Android 应用程序移植到 iOS6。我通过将非 UI 部分从 Java 移植到 C++，在 Obj-C 中编写（最小）UI 部分，并使用标准 C/C++ 技术将前者包装在（小）C 接口中来做到这一点，这样它可以从 Obj-C 访问，毕竟它是 C 的超集。

到目前为止，这一直有效，我还没有遇到任何问题。这似乎是一种合法的方法，因为 Xcode 允许您创建 C++ 类以及 Obj-C 类，并且一些官方示例代码就是这样做的。我不必离开任何官方支持的接口来执行此操作。

鉴于 Xcode 中的界面构建器为您提供的帮助，即使有可能，用 C++ 编写剩余的 UI 代码似乎也没有什么好处，所以我的回答是您可以使用 C++几乎所有你的应用程序，或者你认为合适/方便的应用程序。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-03-09T16:18:24.080

是的，但是除非您正在编写非常简单的程序，否则认为您可以用一种语言编写各种程序是一个有缺陷的想法。Objective C 适用于 Cocoa，就像 C# 适用于 .NET，使用正确的工具完成正确的工作，尝试通过编写桥接代码使 C++ 与 Cocoa 交互，并尝试使 C++ 代码的行为符合 Cocoa 要求，这不是一个好主意，也不期望 C++ Objective C的性能是。您应该尝试布局应用程序的设计和架构，同时考虑现有技能，并确定应该用哪种语言编写哪个部分，然后相应地构建。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-08-09T14:27:59.763

我目前正在编写一个名为 Objective-X 的 Objective-C++ 框架，这使得 PURE C++ iPHONE PROGRAMMING 成为可能。你可以这样做：

```
#import "ObjectiveX.h"

void GUIApplicationMain() {    
    GUIAlert Alert;
    GUILabel Label;
    GUIScreen MainScreen;

    Alert.set_text(@"Just a lovely alert box!");
    Alert.set_title(@"Hello!");
    Alert.set_button(@"Okay");
    Alert.show();

    Label.set_text(@"Ciao!");
    Label.set_position(100, 200, 120, 40);

    MainScreen.init();
    MainScreen.addGUIControl(Label.init());    
} 
```

并使用 GCC 的适当命令行选项编译它。我已经编译了这个 helloworld 应用程序&它 w0rkX0rz 就像一个魅力。;-) 它很快就会在 GoogleCode 上可用。搜索 Objective-X 或访问[http://infotronix.orgfree.com/objectivex](http://infotronix.orgfree.com/objectivex)大约。一个星期后！

更新（但显然无效）网址：[http ://code.google.com/p/objectivex/](http://code.google.com/p/objectivex/)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-12-02T07:23:18.220

这可能有点离题，但无论如何。您可以直接在 iOS 设备上编写 c++。查看 CppCode ios 应用程序 - [http://cppcode.info](http://cppcode.info)。我相信这有助于以后学习 c 和 c++ 以及 Objective-c。

# objective-c - Cocoa/WebKit，在 Safari 实例中打开“window.open()”JavaScript 链接

> ID：270458
> 
> 赞同：7
> 
> 时间：2008-11-06T21:53:29.540
> 
> 标签：objective-c, cocoa, macos, webkit

我正在使用 WebKit 构建一个非常基本的 Cocoa 应用程序，以在其中显示一个 Flash/Silverlight 应用程序。非常基本，无意让它成为浏览器本身。

到目前为止，我已经能够使用它`<a href="..." />`在 Safari 的新实例中打开基本的 html 链接 ()

```
[[NSWorkspace sharedWorkspace] openURL:[request URL]]; 
```

`window.open()`现在我的困难是在 JavaScript 中使用时在新的 Safari 实例中打开链接。我“认为”（通过这个，我一直在破解代码并且不确定我是否真的这样做了）我通过设置 WebView`policyDelegate`并实现它来实现这种工作

```
-webView:decidePolicyForNavigationAction:request:frame:decisionListener: 
```

委托方法。然而，这导致了一些不稳定的行为。

所以一个简单的问题，我需要做什么才能在`window.open()`被调用时在 Safari 的新实例中打开链接。

谢谢

重要的是，我通常是一名 .NET 开发人员，并且只使用 Cocoa/WebKit 几天。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-07T16:02:55.710

昨晚我取得了进步，并解决了我的部分问题。

我已经在使用`webView:decidePolicyForNewWindowAction:request:newFrameName:decisionListener:`并且已经让它与锚标记一起使用，但是当调用 JavaScript 时，该方法似乎从未被调用。

但是，当`window.open()`被调用时`webView:createWebViewWithRequest:request`，我试图在此处强制窗口在 Safari 中打开，但是请求始终为空。所以我永远无法读出 URL。

我已经进行了一些搜索，这似乎是一个已知的“*错误功能*”，但是我无法找到解决它的方法。

据我了解`createWebViewWithRequest`，您可以创建新的 webview，然后将请求的 url 发送到要加载的新 webview。 [这是迄今为止我能找到的最好的解释。](http://code.google.com/p/pandoraboy/source/browse/tags/pandoraboy_0_3/Controller.m#156)

因此，虽然很多人已经指出了这个问题，但我还没有看到任何适合我需要的解决方案。我会尝试再深入一点`decidePolicyForNewWindowAction`。

谢谢！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-04T10:20:31.713

好吧，我通过创建一个虚拟 webView 来处理它，将它的 frameLoad 委托设置为一个自定义类来处理

```
- (void)webView:decidePolicyForNavigationAction:actionInformation :request:frame:decisionListener: 
```

并在那里打开一个新窗口。

代码 ：

```
- (WebView *)webView:(WebView *)sender createWebViewWithRequest:(NSURLRequest *)request {
    //this is a hack because request URL is null here due to a bug in webkit        
    return [newWindowHandler webView];
} 
```

和 NewWindowHandler ：

```
@implementation NewWindowHandler

-(NewWindowHandler*)initWithWebView:(WebView*)newWebView {
    webView = newWebView;

    [webView setUIDelegate:self];
    [webView setPolicyDelegate:self];  
    [webView setResourceLoadDelegate:self];

    return self;
}

- (void)webView:(WebView *)sender decidePolicyForNavigationAction:(NSDictionary *)actionInformation request:(NSURLRequest *)request frame:(WebFrame *)frame decisionListener:(id<WebPolicyDecisionListener>)listener {
    [[NSWorkspace sharedWorkspace] openURL:[actionInformation objectForKey:WebActionOriginalURLKey]];
}

-(WebView*)webView {
    return webView;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-13T10:17:05.687

似乎有一个错误，`webView:decidePolicyForNewWindowAction:request:newFrameName:decisionListener:`即请求总是`nil`，但是有一个强大的解决方案可以同时使用普通`target="_blank"`链接和 javascript 链接。

基本上，我使用另一个短暂的 WebView 来处理新页面的加载。类似于 Yoni Shalom，但语法糖多一点。

要使用它，首先为您的 WebView 设置一个委托对象，在这种情况下，我将自己设置为委托：

```
webView.UIDelegate = self; 
```

然后只需实现`webView:createWebViewWithRequest:`委托方法并在加载新页面时使用基于块的 API 执行某些操作，在这种情况下，我在外部浏览器中打开页面：

```
-(WebView *)webView:(WebView *)sender createWebViewWithRequest:(NSURLRequest *)request {
    return [GBWebViewExternalLinkHandler riggedWebViewWithLoadHandler:^(NSURL *url) {
        [[NSWorkspace sharedWorkspace] openURL:url];
    }];
} 
```

差不多就是这样。这是我的课程的代码。标题：

```
//  GBWebViewExternalLinkHandler.h
//  TabApp2
//
//  Created by Luka Mirosevic on 13/03/2013.
//  Copyright (c) 2013 Goonbee. All rights reserved.
//

#import <Foundation/Foundation.h>

@class WebView;

typedef void(^NewWindowCallback)(NSURL *url);

@interface GBWebViewExternalLinkHandler : NSObject

+(WebView *)riggedWebViewWithLoadHandler:(NewWindowCallback)handler;

@end 
```

实施：

```
//  GBWebViewExternalLinkHandler.m
//  TabApp2
//
//  Created by Luka Mirosevic on 13/03/2013.
//  Copyright (c) 2013 Goonbee. All rights reserved.
//

#import "GBWebViewExternalLinkHandler.h"

#import <WebKit/WebKit.h>

@interface GBWebViewExternalLinkHandler ()

@property (strong, nonatomic) WebView                           *attachedWebView;
@property (strong, nonatomic) GBWebViewExternalLinkHandler      *retainedSelf;
@property (copy, nonatomic) NewWindowCallback                   handler;

@end

@implementation GBWebViewExternalLinkHandler

-(id)init {
    if (self = [super init]) {
        //create a new webview with self as the policyDelegate, and keep a ref to it
        self.attachedWebView = [WebView new];
        self.attachedWebView.policyDelegate = self;
    }

    return self;
}

-(void)webView:(WebView *)sender decidePolicyForNavigationAction:(NSDictionary *)actionInformation request:(NSURLRequest *)request frame:(WebFrame *)frame decisionListener:(id<WebPolicyDecisionListener>)listener {
    //execute handler
    if (self.handler) {
        self.handler(actionInformation[WebActionOriginalURLKey]);
    }

    //our job is done so safe to unretain yourself
    self.retainedSelf = nil;
}

+(WebView *)riggedWebViewWithLoadHandler:(NewWindowCallback)handler {
    //create a new handler
    GBWebViewExternalLinkHandler *newWindowHandler = [GBWebViewExternalLinkHandler new];

    //store the block
    newWindowHandler.handler = handler;

    //retain yourself so that we persist until the webView:decidePolicyForNavigationAction:request:frame:decisionListener: method has been called
    newWindowHandler.retainedSelf = newWindowHandler;

    //return the attached webview
    return newWindowHandler.attachedWebView;
}

@end 
```

许可为 Apache 2。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-12-09T21:42:19.637

通过阅读所有帖子，我想出了我的简单解决方案，所有功能都在同一个类中，在这里，用浏览器打开一个链接。

```
- (WebView *)webView:(WebView *)sender createWebViewWithRequest:(NSURLRequest *)request {

    return [self externalWebView:sender];
}

- (void)webView:(WebView *)sender decidePolicyForNavigationAction:(NSDictionary *)actionInformation request:(NSURLRequest *)request frame:(WebFrame *)frame decisionListener:(id<WebPolicyDecisionListener>)listener
{
    [[NSWorkspace sharedWorkspace] openURL:[actionInformation objectForKey:WebActionOriginalURLKey]];
}

-(WebView*)externalWebView:(WebView*)newWebView
{
     WebView *webView = newWebView;

    [webView setUIDelegate:self];
    [webView setPolicyDelegate:self];
    [webView setResourceLoadDelegate:self];
    return webView;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-07T10:30:59.947

你没有提到你看到什么样的不稳定行为。[一种快速的可能性是，在实现委托方法时，您忘记通过调用传递给您的委托的WebPolicyDecisionListener](http://developer.apple.com/documentation/Cocoa/Reference/WebKit/Protocols/WebPolicyDecisionListener_Protocol/Reference/Reference.html#//apple_ref/occ/intf/WebPolicyDecisionListener)的忽略方法来告诉 webview 您忽略了单击，这可能会使事情进入一个奇怪的状态。

如果这不是问题，那么您对所显示的内容有多少控制权？策略委托为您提供了过滤所有资源负载的简单机制（正如您所发现的那样），并且所有新窗口都通过[webView:decidePolicyForNewWindowAction:request:newFrameName:decisionListener:](http://developer.apple.com/documentation/Cocoa/Reference/WebKit/Protocols/WebPolicyDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/instm/NSObject/webView:decidePolicyForNewWindowAction:request:newFrameName:decisionListener:)打开。所有 window.open 调用都应该通过它，触发新窗口的其他任何东西也应该如此。

如果您想在应用程序中保留其他打开的窗口，您将做更多的工作。传递给委托的参数之一是包含有关事件信息的[字典](http://developer.apple.com/documentation/Cocoa/Reference/WebKit/Protocols/WebPolicyDelegate_Protocol/Reference/Reference.html#//apple_ref/doc/uid/20001912-7527)。Insie 那个字典 WebActionElementKey 将有一个包含许多[细节](http://developer.apple.com/documentation/Cocoa/Reference/WebKit/Classes/WebView_Class/Reference/Reference.html#//apple_ref/doc/uid/20001903-BBCHHFBA)的字典，包括链接的原始 dom 内容。如果你想在那里四处寻找，你可以获取实际的 DOM 元素，并检查 href 的文本以查看它是否以 window.open 开头。这有点重，但如果你想要细粒度的控制，它会给你。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-11-07T04:58:05.260

解释：

通过 window.open 从 JavaScript 创建的 Windows 通过 createWebViewWithRequest。所有 window.open 调用都会导致 createWebViewWithRequest: 请求为空，然后在该 WebView 上发生位置更改。

有关详细信息，请参阅WebKit 邮件列表上的[这篇旧帖子。](https://lists.apple.com/archives/webkitsdk-dev/2004/Jun/msg00041.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-08-24T03:41:49.810

除了返回一个新的 WebView 并等待其`loadRequest:`方法被调用之外，我最终覆盖`window.open`了 WebView 的 JSContext 中的函数：

首先，我将我的控制器设置为 WebView 的 WebFrameLoadDelegate：

```
myWebView.frameLoadDelegate = self; 
```

然后，在委托方法中，我重写了`window.open`函数，我可以在那里处理 URL。

```
- (void)webView:(WebView *)webView didCreateJavaScriptContext:(JSContext *)context forFrame:(WebFrame *)frame{
context[@"window"][@"open"] = ^(id url){
        NSLog(@"url to load: %@", url);
    };
} 
```

这让我可以处理我需要的请求，而无需创建额外的 WebView。

# python - 使用 Python 进行 DTD 验证？

> ID：270460
> 
> 赞同：5
> 
> 时间：2008-11-06T21:53:46.420
> 
> 标签：python, xml

我想知道哪些内置的 python 库支持 DTD 验证。

我一直在环顾四周，无法得到一个直接的答案。我知道 ElementTree 不支持 DTD 验证。

哪些可以？

# installation - SQL Express 2005 的静默安装

> ID：270468
> 
> 赞同：6
> 
> 时间：2008-11-06T21:55:43.717
> 
> 标签：installation, sql-server-express, silent

谁能告诉我执行 SQL Server Express 2005 静默安装的过程以及指定安装参数的方法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-06T22:09:36.823

获取 MSI 并执行

```
string InstallFile = "SSCERuntime-ENU-x86.msi"
string LogFile = "C:\Install.log"

Process proc;
proc = Process.Start("msiexec", "/l " + LogFile + " /quiet /i " + InstallFile); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-06T22:24:44.860

如果您这样做是为了支持桌面应用程序的部署，那么这是一个坏主意。

使用 SQL Server 的精简版而不是速成版。它更适合进程中的情况，并且更容易部署。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T19:16:18.207

感谢您的及时回复，我会尝试，但我正在寻找类似的 SQL EXPRESS [http://msdn.microsoft.com/en-us/library/ms144259.aspx](http://msdn.microsoft.com/en-us/library/ms144259.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-09T00:44:14.910

你可以在这里找到变量， http: [//msdn.microsoft.com/en-us/library/ms345154 (SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms345154(SQL.90).aspx)

您应该能够使用 msiexec /qn REBOOT=ReallySuppress ADDLOCAL=ALL INSTANCENAME= SAPWD= 静默安装

您可能想要设置一些其他变量，您可以在上面的链接中找到这些变量，例如 SQLAUTOSTART 和 DISABLENETWORKPROTOCOLS。

# visual-studio-2008 - 通过 NAnt 与 Visual Studio 构建 - 缺少一个 dll

> ID：270479
> 
> 赞同：2
> 
> 时间：2008-11-06T21:59:16.877
> 
> 标签：visual-studio-2008, dll, msbuild, nant, reference

我的解决方案包括这两个项目：

*   我的命名空间.Web.UI
*   MyNamespace.Web.Core

UI 引用 Core，Core 引用 Foobar.dll，除了我的库，它不存在任何地方。当我从 Visual Studio 2008 构建时，Foobar.dll 按预期位于 UI 项目的 Bin 文件夹中。我已经确定它在构建之前不存在。

但是当我从 NAnt 构建时，它不存在，这会导致运行时异常。NAnt 任务如下所示：

```
<target name="compile" depends="init">
    <exec program="${framework::get-framework-directory(framework::get-target-framework())}\msbuild.exe"
       commandline="${solution.file} /m /t:Clean /p:Configuration=${project.config} /v:q" workingdir="." />
    <exec program="${framework::get-framework-directory(framework::get-target-framework())}\msbuild.exe"
       commandline="${solution.file} /m /t:Rebuild /p:Configuration=${project.config} /v:q" workingdir="." />
</target> 
```

在 VS 中，我尝试过在发布模式和调试模式下构建、重建、重建所有内容。它总是一样的。Foobar.dll 位于 Bin 文件夹中。NAnt 并非如此。我还尝试从 NAnt 脚本中删除 /m 开关。结果相同。

在 Core 而不是 UI 中引用了其他几个 dll，它们在 NAnt 构建后按预期出现在 Bin 中。

我的解决方法是在 UI 项目中引用 Foobar.dll，但这让我有点恶心。知道什么会导致这种情况吗？

（顺便说一句，Foobar.dll 实际上是 NHibernate.ProxyGenerators.CastleDynamicProxy.dll）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T18:40:52.783

您可能在 VS 中可以选择“复制本地”，这是隐含的，嗯，在构建之前将其复制到本地。您需要在 NAnt 中进行模拟。

类似于您可以从 Visual Studio 为 Web 项目执行“发布”的原因，但对于命令行，您必须构建然后将输出复制到您要去的任何地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T18:35:39.173

我之前在 NantContrib 中使用过 MSBuild 任务，它似乎将库 dll 复制到 bin 文件夹中。当然，这并不能真正解释为什么你的方法不起作用，但我假设你的目标是让它构建，而不是弄清楚为什么它不会构建

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T22:03:24.840

在我从事的一些工作中，我求助于使用 NAnt 的[复制任务](http://nant.sourceforge.net/release/latest/help/tasks/copy.html)将 DLL 复制到 bin 目录中，以便构建项目。我不知道这是否一定是最佳实践，但它确实有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T22:22:03.980

我同意科里的观点。由于您正在使用 msbuild，因此您需要确保将任何第 3 方（您的或其他方的）dll 复制到您的 bin 或输出文件夹中。

在运行任务之前，您可以使用任务在 nant 中执行此操作。那么一切都应该没问题。

唯一的问题是您必须知道在 msbuild 任务运行之前将其放在哪里，因此您可能必须首先创建文件夹结构并希望 msbuild 不会将其清除。

希望有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-12-02T18:15:35.673

我有一个类似的问题。我通过明确添加解决了这个问题

> <私人>真实</私人>

在 .csproj 文件中的引用中，它应该强制复制本地。

```
<Reference Include="Microsoft.Web.Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
  <SpecificVersion>False</SpecificVersion>
  <HintPath>..\lib\Microsoft.Web.Infrastructure.1.0.0.0\lib\net40\Microsoft.Web.Infrastructure.dll</HintPath>
  <Private>True</Private>
</Reference> 
```

# c++ - 在发布模式下是否忽略了 assert(false)？

> ID：270488
> 
> 赞同：31
> 
> 时间：2008-11-06T22:01:32.253
> 
> 标签：c++, visual-c++, posix, assert

我正在使用 VC++。在发布模式下被`assert(false)`忽略？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-11-06T22:07:25.707

如果在发布模式下编译包括定义 NDEBUG，那么是的。

见[断言 (CRT)](https://msdn.microsoft.com/library/9sb57dw4.aspx)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-06T22:05:27.393

IIRC，assert(x) 是一个宏，在定义 NDEBUG 时计算结果为空，这是 Visual Studio 中发布版本的标准。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-06T22:07:19.857

断言宏（至少它通常是一个宏）通常在发布代码中定义为无操作。它只会在调试代码中触发。话说回来。我曾在定义了自己的断言宏的地方工作过，它在调试和发布模式下都触发了。

我被教导将断言用于“永远不会”为假的条件，例如函数的先决条件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-06T22:05:40.530

我认为只有定义了 NDEBUG （Visual C++ 应用程序默认使用它）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-07T01:15:01.833

我认为过分依赖断言的确切行为是错误的。“assert(expr)”的正确语义是：

*   表达式 expr 可能会或可能不会被评估。
*   如果 expr 为真，则继续正常执行。
*   如果 expr 为假，则发生的情况未定义。

更多信息请访问[http://nedbatchelder.com/text/assert.html](http://nedbatchelder.com/text/assert.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-03-23T09:32:43.117

GNU 也一样：

```
 #ifdef    NDEBUG

  # define assert(expr)     (__ASSERT_VOID_CAST (0)) 
```

# css - 你怎么做两个 重叠？

> ID：270493
> 
> 赞同：163
> 
> 时间：2008-11-06T22:02:10.757
> 
> 标签：css, html, overlap

我需要两个 div 看起来有点像这样：

```
 |               |
 ---|    LOGO       |------------------------
|   |_______________|  LINKS                |
|             CONTENT                       | 
```

使它们整齐重叠的最整洁/最优雅的方式是什么？徽标将具有固定的高度和宽度，并将接触页面的顶部边缘。

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2008-11-06T22:06:34.443

只需使用负边距，在第二个 div 中说：

```
<div style="margin-top: -25px;"> 
```

并确保设置 z-index 属性以获得所需的分层。

* * *

## 回答 #2

> 赞同：93
> 
> 时间：2008-11-06T22:05:58.877

我可能会这样处理它（CSS和HTML）：

```
html,
body {
  margin: 0px;
}
#logo {
  position: absolute; /* Reposition logo from the natural layout */
  left: 75px;
  top: 0px;
  width: 300px;
  height: 200px;
  z-index: 2;
}
#content {
  margin-top: 100px; /* Provide buffer for logo */
}
#links {
  height: 75px;
  margin-left: 400px; /* Flush links (with a 25px "padding") right of logo */
}
```

```
<div id="logo">
  <img src="https://via.placeholder.com/200x100" />
</div>
<div id="content">

  <div id="links">dssdfsdfsdfsdf</div>
</div>
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-06T22:04:17.443

使用绝对或相对定位，您可以进行各种重叠。您可能希望徽标的样式如下：

```
div#logo {
  position: absolute;
  left: 100px; // or whatever
} 
```

注：绝对位置有其偏心率。您可能需要进行一些实验，但做您想做的事情应该不会太难。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-06T22:04:46.023

使用 CSS，您将徽标 div 设置为绝对位置，并将 z 顺序设置为高于第二个 div。

```
#logo
{
    position: absolute:
    z-index: 2000;
    left: 100px;
    width: 100px;
    height: 50px;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-06T22:54:59.043

如果您希望徽标占据空间，您最好将其向左浮动，然后使用边距向下移动内容，有点像这样：

```
＃标识 {
    向左飘浮;
    边距：0 10px 10px 20px；
}

＃内容 {
    边距：10px 0 0 10px；
}

```

或您想要的任何保证金。

# asp.net - 输入按钮不提交表单（仅限 IE）ASP.NET

> ID：270494
> 
> 赞同：10
> 
> 时间：2008-11-06T22:02:13.750
> 
> 标签：asp.net, javascript, internet-explorer, textbox

我有一个带有文本框和按钮的表单。IE 是唯一在按下 Enter 时不会提交表单的浏览器（适用于 FF、Opera、Safari、Chrome 等）。我发现这个 javascript 函数试图哄骗 IE 行为；但无济于事：

```
function checkEnter(e){
    var characterCode
    if (e && e.which) {
        e = e
        characterCode = e.which
    } else {
        e = event
        characterCode = e.keyCode
    }
    if (characterCode == 13) {
        document.forms[0].submit()
        return false
    } else {
        return true
    }
} 
```

执行：

```
searchbox.Attributes("OnKeyUp") = "checkEnter(event)" 
```

有什么建议吗？

**编辑：** [CodeProject](http://www.codeproject.com/)上的[此页面](http://www.codeproject.com/KB/aspnet/EnterKeyToButtonClick.aspx)概述了 Dillie 所说的内容，并且效果很好。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-01-28T15:10:43.807

只需在页面上的隐藏 div 中创建文本输入。这将绕过 IE 错误。

示例 div：

```
 <!-- Fix for IE bug (One text input and submit, disables submit on pressing "Enter") -->
    <div style="display:none">
            <input type="text" name="hiddenText"/>
    </div> 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-06T22:14:51.150

我过去做过的另一件事是将表单区域包装在 Panel 中，并将 DefaultButton 属性设置为您拥有的提交按钮。只要您在面板区域中有一个表单元素处于焦点位置，这就会有效地将 enter 键映射到提交。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-02-10T05:41:48.950

这里有一个很好的关于这个问题的文章，以及一个很好的基于 jquery 的解决方案：

> [http://www.thefutureoftheweb.com/blog/submit-a-form-in-ie-with-enter](http://www.thefutureoftheweb.com/blog/submit-a-form-in-ie-with-enter)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-06T22:05:01.670

```
// Use the following Javascript in your HTML view
// put it somewhere between <head> and </head>

    <script language="JavaScript" type="text/javascript"><!--
    function KeyDownHandler(btn)
    {
      if (event.keyCode == 13)
      {
        event.returnValue=false;
        event.cancel = true;
        btn.click();
      }
    }
    // -->
    </script>

    // Put this in your TextBox(es) aka inside <asp:textbox ... >
    onkeydown="KeyDownHandler(ButtonID)" 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-01T23:04:22.863

使用 时`display:none`，IE 将看不到按钮，因此无法使用它来提交表单。相反，您可以使用`z-index`和绝对定位将其隐藏在另一个元素下，例如使用样式：

`position:absolute; bottom: -20px; left: -20px; z-index: -1;`

现在它仍然存在，可供 IE 使用，但隐藏在另一个元素之下。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-14T15:36:26.887

隐藏按钮 - 不使用 display:none，但使用以下样式：

```
position: absolute; /* no longer takes up layout space */
visibility: hidden; /* no longer clickable / visible */ 
```

如果您这样做，您将不需要添加任何其他元素或隐藏输入。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-03-14T09:45:45.677

这是由于 IE 对单个文本字段输入的特殊性。

一个简单的解决方案是通过添加另一个隐藏的文本字段来停止具有单个文本字段的页面。

```
<input type="text" name="hidden" style="visibility:hidden;display:none;" /> 
```

见.. [http://www.4guysfromrolla.com/articles/060805-1.aspx](http://www.4guysfromrolla.com/articles/060805-1.aspx)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-11-06T22:08:29.353

它是否使用 GET 而不是 POST？网址是否太长？我见过那个...

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-11-06T22:41:27.447

基本上，表单需要一个按钮、输入类型=“提交”或输入类型=“图像”，以启用内置行为以在输入时提交表单。您不需要 javascript 来提交它。

# asp-classic - 如何使用 AES 在 VBScript 中加密？

> ID：270510
> 
> 赞同：13
> 
> 时间：2008-11-06T22:05:56.350
> 
> 标签：asp-classic, vbscript, aes, rijndael, rfc2898

我希望使用特定密钥和[IV](http://en.wikipedia.org/wiki/Initialization_vector)值在[VBScript中使用](http://en.wikipedia.org/wiki/VBScript)[Rijndael/AES加密一些数据。](http://en.wikipedia.org/wiki/Advanced_Encryption_Standard)有什么好的函数库或 COM 组件可以很好用吗？

我看了看[CAPICOM](http://en.wikipedia.org/wiki/CAPICOM)；它只允许使用密码，并且不允许设置特定的密钥和 IV 值。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-01-24T20:26:04.307

一种方法是在 vbscript 中声明加密类，而不需要外部添加的 COM 对象或包装器。以下示例采用字符串，使用 Rijndael 托管类进行加密和解密：

```
'-----------------------------------------------------
Dim obj,arr,i,r,str,enc,asc
dim bytes,bytesd,s,sc,sd
set obj=WScript.CreateObject("System.Security.Cryptography.RijndaelManaged")
Set asc = CreateObject("System.Text.UTF8Encoding")
s="This is a private message"
bytes=asc.GetBytes_4(s)
obj.GenerateKey()
obj.GenerateIV()
set enc=obj.CreateEncryptor()
set dec=obj.CreateDecryptor()

bytec=enc.TransformFinalBlock((bytes),0,lenb(bytes))
sc=asc.GetString((bytec))
msgbox sc

byted=dec.TransformFinalBlock((bytec),0,lenb(bytec))
sd=asc.GetString((byted))
msgbox sd
'----------------------------------------------------- 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T15:03:14.570

一种响应建议将`RijndaelManaged`类包装在 COM 中。您还可以在 COM 中包装一些其他 AES 实现。我刚刚尝试[了 SlowAES](http://code.google.com/p/slowaes)，它是 AES 的 JavaScript 实现。通过 Windows 脚本组件将其包装在 COM 中，使其可从 VBScript 调用。仅当您不能使用 .NET 方法时，我才会推荐此方法；我猜想.NET 的 AES 会比 JavaScript 中实现的 AES 更快。

在我对 COM-wrapped-SlowAEs 的测试中，我使用了 CBC 模式，并且加密与 .NET 中的 RijndaelManaged 类完全兼容。

这是WSC；我遗漏了由 SlowAES 提供的 3 个 .js 文件。您需要将它们原封不动地插入到我标记文件的位置。

```
<?xml version="1.0"?>

<!--

//
// Ionic.COM.SlowAES.wsc
//
// This is a Windows Script Component that exposes the SlowAES
// encryption engine via COM. This AES can be used from any 
// COM-capable environment, including Javascript or VBScript. 
//
//
// This code is licensed under the Microsoft Public License. See the
// accompanying License.txt file for details.
//
// Copyright 2009 Dino Chiesa
//

-->

<package>

<component id="Ionic.Com.SlowAES">

  <comment>
SlowAES is a Javascript implementation of AES.  
     See http://code.google.com/p/slowaes.  
This is a COM package for SlowAES.
  </comment>

<?component error="true" debug="true"?>

<registration
  description="WSC Component for SlowAES"
  progid="Ionic.Com.SlowAES"
  version="1.00"
  classid="{ba78383f-1bcc-4df6-9fb9-61cd639ebc94}"
  remotable="False">

  <!-- boilerplate registration/unregistration logic -->
  <script language="VBScript">
  <![CDATA[

strComponent = "Ionic SlowAES"

Function Register
  MsgBox strComponent & " - registered."
End Function

Function Unregister
  MsgBox strComponent & " - unregistered."
End Function

  ]]>
  </script>
</registration>

<public>
  <method name="EncryptString">
<parameter name="plainText"/>
  </method>

  <method name="DecryptBytes">
<parameter name="cipherText"/>
  </method>

  <method name="DecryptBytesToString">
<parameter name="cipherText"/>
  </method>

  <method name="DecryptHexString">
<parameter name="hexStringCipherText"/>
  </method>

  <method name="DecryptCommaDelimitedStringToString">
<parameter name="cipherText"/>
  </method>

  <property name="Key">
  <put/>
  </property>

  <property name="Mode">
  <put/>
  <get/>
  </property>

  <property name="IV">
  <put/>
  <get/>
  </property>

  <property name="KeySize">
  <put/>
  <get/>
  </property>
</public>

<script language="JavaScript">
<![CDATA[

// ...insert slowAES code here... //

// defaults
var _keysize = slowAES.aes.SIZE_128;
var _mode = slowAES.modeOfOperation.CBC;
var _iv = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
var _key;

/* 
* byteArrayToHexString
* convert a byte array to hex string.
*/
function byteArrayToHexString(a)
{
try { hexcase } catch(e) { hexcase=0; }
var hex_tab = hexcase ? "0123456789ABCDEF" : "0123456789abcdef";
var r= "";
for (var i = 0; i < a.length; i++)
{
    var b  = hex_tab.charAt((a[i] >> 4) & 0x0F) + 
    hex_tab.charAt(a[i] & 0x0F);
    r+= b;
}
return r;
}

/* 
* hexStringToByteArray
* convert a string of hex byts to a byte array
*/
function hexStringToByteArray(s)
{
var r= Array(s.length/2);
for (var i = 0; i < s.length; i+=2)
{
    r[i/2] = parseInt(s.substr(i,2),16);
}
return r;
}

function EncryptString(plainText)
{
 var bytesToEncrypt = cryptoHelpers.convertStringToByteArray(plainText);
 var result = slowAES.encrypt(bytesToEncrypt, 
     _mode,
     _key,
     _keysize,
     _iv);
return result['cipher'];
}

function DecryptBytesToString(cipherText)
{
var d = DecryptBytes(cipherText);
var s = cryptoHelpers.convertByteArrayToString(d);
s[cipherText.length]= 0;
return s;
}

function DecryptHexString(hexStringCipherText)
{
var cipherText = hexStringToByteArray(hexStringCipherText);
return DecryptBytesToString(cipherText);
}

function DecryptCommaDelimitedStringToString(cipherText)
{
var c = [];
var atoms = cipherText.split(",");
for (i=0; i < atoms.length; i++)
{
    c.push(parseInt(atoms[i], 10));
}
var d = DecryptBytes(c);
return cryptoHelpers.convertByteArrayToString(d);
}

function DecryptBytes(cipherText)
{
if (cipherText == undefined) return null;

var originalSize = cipherText.length;

var result = slowAES.decrypt(cipherText, 
    originalSize,
    _mode,
    _key,
    _keysize,
    _iv);

return result;
}

function put_Key(keyString)
{
  _key = hexStringToByteArray(keyString);
}

function put_KeySize(size)
{
if (size == 128) _keysize = slowAES.aes.keySize.SIZE_128;
else if (size == 192) _keysize = slowAES.aes.keySize.SIZE_192;
else if (size == 256) _keysize = slowAES.aes.keySize.SIZE_256;
else
    throw "Unsupported key size.  Must be one of { 128, 192, 256 }.";
}

function get_KeySize()
{
if (_keysize == slowAES.aes.keySize.SIZE_128) return 128;
else if (_keysize == slowAES.aes.keySize.SIZE_192) return 192;
else if (_keysize == slowAES.aes.keySize.SIZE_256) return 256;
else return -1;
}

function put_IV(ivString)
{
    _iv = hexStringToByteArray(ivString);
}

function get_IV()
{
return byteArrayToHexString(_iv);
}

function put_Mode(mode)
{
if (mode == "CBC") _mode= slowAES.modeOfOperation.CBC;
else if (mode == "OFB") _mode= slowAES.modeOfOperation.OFB;
else if (mode == "CFB") _mode= slowAES.modeOfOperation.CFB;
else throw "Unsupported mode.  Must be one of {CBC, OFB, CFB}";
}

function get_Mode()
{
if (_mode == slowAES.modeOfOperation.CBC) return "CBC";
if (_mode == slowAES.modeOfOperation.OFB) return "OFB";
if (_mode == slowAES.modeOfOperation.CFB) return "CFB";
return "???";
}

]]>

</script>

</component>

</package> 
```

将其保存到名为 SlowAES.wsc 的文件中。使用“regsvr32 SlowAES.wsc”注册它。下面是一些使用该组件的 VBScript 代码。

```
' '
' byteArrayToHexString'
' convert a byte array to hex string.'
' '
Function byteArrayToHexString(a)
Dim r,b,i
r = ""
For i = 0 To UBound(a)
    b = Hex( (a(i) And &HF0) / 16) & Hex(a(i) And &HF)
    r= r & b
Next
byteArrayToHexString= r
End Function

' '
' hexStringToByteArray'
' convert a string of hex byts to a byte array'
' '
Function hexStringToByteArray(s)
Dim r()
ReDim r(Len(s)/2-1)
Dim x
For i = 0 To  Len(s)-2 Step 2
    x= "&H" & Mid(s,i+1,2)
    r(i/2) = CInt(x)
Next
hexStringToByteArray= r
End Function

Function DemoEncryption()
WScript.echo "Testing Ionic.Com.SlowAES..."

WScript.echo "key:              " & byteArrayToHexString(key)
WScript.echo "iv:               " & byteArrayToHexString(iv)
WScript.echo "key length:       " & keyLengthInBytes & " bytes"
WScript.echo "key length:       " & (keyLengthInBytes*8) & " bits"
WScript.echo "plaintext:        " & plaintext
WScript.echo "plaintext.length: " & Len(plaintext)

WScript.echo "instantiate Ionic.Com.SlowAES"
Dim aes
set aes = CreateObject("Ionic.Com.SlowAES")

WScript.echo "keysize"
aes.KeySize = keyLengthInBytes * 8

WScript.echo "key"
aes.Key = byteArrayToHexString(key)

WScript.echo "iv "
aes.IV= byteArrayToHexString(iv)

WScript.echo "mode "
aes.Mode = "CBC"

WScript.echo "encrypting... "
Dim result
result= aes.EncryptString(plaintext)

' result is a comma-separated string '
' if we Eval() on it we convert it to an array '
Dim expr
expr = "Array(" & result & ")" 

result= Eval( expr )

WScript.echo "Cryptotext/Eval: " & byteArrayToHexString(result)
WScript.echo "Cryptotext.length: " & UBound(result)+1

WScript.echo "decrypting... "
Dim decrypted
'The javascript way to do this is to pass the byte array.'
' Like so:'
'    var decrypted = aes.DecryptBytesToString(result);'
' '
'This does not work from VBScript. So, convert to a hexstring,'
'pass the hex string, and then convert back, in the COM component.'
decrypted= aes.DecryptHexString(byteArrayToHexString(result))

WScript.echo "decrypted: " & decrypted
End Function

dim plaintext, iv, key, keyLengthInBytes

plaintext= "Hello. This is a test. of the emergency broadcasting system."
' iv must be a hexstring representation of an array of bytes, length=16'
iv =  hexStringToByteArray("feedbeeffeedbeefbaadf00dbaadf00d")
' key must be a hexstring representation of an array of bytes, length=16 or 32'
key = hexStringToByteArray("cafebabe0099887766554433221100AA")
keyLengthInBytes= UBound(key)+1

If Err.Number <> 0 Then Err.Clear

Call DemoEncryption

If (Err.Number <> 0) Then WScript.echo("Error: " & Err.Description) 
```

如果您还想要基于密码的密钥派生功能，那么您可以[在此处获取 PBKDF2 的非常简洁的 JavaScript 代码](http://anandam.name/pbkdf2/)，并[为此创建另一个 WSC](http://cheeso.members.winisp.net/srcview.aspx?dir=AES-example&file=Ionic.Com.PBKDF2.wsc)，而不会太麻烦。

* * *

**编辑**：我做了我所描述的 - 获取 PBKDF2 的源代码并将其集成到 SlowAES 的代码中。我还在 C# 中生成了第二个独立的实现，它使用内置的 .NET 类库来执行 RFC 2898 密钥派生和 AES 加密。

结果是 3 个测试应用程序，一个在 C# 中，一个在 JavaScript 中，另一个在 VBScript 中。 [源是可用的](http://cheeso.members.winisp.net/srcview.aspx?dir=AES-example)。他们都采用相同的论点。它们每个都使用[符合 RFC 2898](https://www.rfc-editor.org/rfc/rfc2898)的密钥派生函数。您可以指定密码、[salt](http://en.wikipedia.org/wiki/Salt_%28cryptography%29)、[IV](http://en.wikipedia.org/wiki/Initialization_vector)和明文，以及要在[PBKDF2](http://en.wikipedia.org/wiki/PBKDF2)中使用的 RFC 2898 迭代次数。您可以轻松验证每个测试程序的密文是否相同。也许这个例子对某人有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-16T09:12:40.550

One option would be to create a simple wrapper class in .NET for the [RijndaelManaged class](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rijndaelmanaged.aspx) from the .NET framework and expose it via [COM Interop](http://msdn.microsoft.com/en-us/library/zsfww439.aspx "Exposing .NET Framework Components to COM") so you can call it from VBScript.

# deployment - vb6 xcopy 部署

> ID：270523
> 
> 赞同：4
> 
> 时间：2008-11-06T22:11:06.323
> 
> 标签：deployment, vb6, xcopy, regfreecom

谁能告诉我如何将 vb6（COM dll 的 ocx 和 exes）的遗留应用程序转换为使用 Regfree COM 。

我尝试在 Visual Studio 中打开 dll 并创建清单文件，但其中一些 dll 出现错误。

有没有什么工具可以帮助我完成这个过程？

我尝试了一个名为 regsvr42 的 codeproject 工具，它没有完全创建清单。

我使用了诸如 PE explorer 之类的工具来获取所有类型库信息，但是将它们转换为清单文件太难了。

我们已经开始将它迁移到.NET，几个月来我们必须部署它，如果它是基于 xcopy 的部署会更容易。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-13T14:03:03.693

要创建清单文件，您可以尝试使用[http://mmm4vb6.atom5.com/](http://mmm4vb6.atom5.com/)中的 Make My Manifest 。

*编辑*MMM 网站已关闭。我[在这里](http://web.archive.org/web/20140829021337/http://mmm4vb6.atom5.com/)看到作者在托管方面遇到了问题，并提供了另一个位置来获取 Make My Manifest -[在此处下载](https://app.box.com/s/yvm0wk95e1lachm7juf5)。

如果您可以控制对象的创建，则可以使用[http://www.thecommon.net/10.html中的 DirectCOM](http://www.thecommon.net/10.html)

请记住，如果使用的 DLL 或 OCX 之一正在使用 CreateObject 调用动态创建其他 COM 对象，则该引用将不会存储在 vbp 项目文件中，您将不会获得完整的清单文件。可能您必须在应用程序运行时捕获对象创建。Depends.exe 应用程序可以分析正在运行的应用程序并报告所有使用的 dll。我不知道是否有工具可以找到额外的 COM 相关信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-25T18:35:08.273

在 MSDN 上的这篇文章中有一个很好的演练：[COM 组件的免注册激活：演练](http://msdn.microsoft.com/en-us/library/ms973913.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-13T17:36:23.467

Make My Manifest 可以适应后期绑定和早期绑定。您只需通过文件位置或 ProgId 手动添加对后期绑定依赖项的引用。

您可以查看[http://mmm4vb6.atom5.com/mmm-demo-1248.html](http://mmm4vb6.atom5.com/mmm-demo-1248.html)以获得使用该实用程序的更多帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-17T22:21:29.367

[MakeMyManifest 被誉为](http://mmm4vb6.atom5.com/)为 VB6 项目创建清单的自动工具，我自己没有尝试过。 [DirectCOM](http://www.thecommon.net/10.html)也有粉丝，我也没试过。

*编辑*MMM 网站已关闭。我[在这里](http://web.archive.org/web/20140829021337/http://mmm4vb6.atom5.com/)看到作者在托管方面遇到了问题，并提供了另一个位置来获取 Make My Manifest -[在此处下载](https://app.box.com/s/yvm0wk95e1lachm7juf5)。

有一种半自动技术。您可以使用 Visual Studio 2008 创建清单（您可以使用免费版本，如 Visual Basic Express Edition）。然后手动进行一些编辑以使清单适用于 VB6。有关分步说明，请参阅[此 MSDN 文章的这一部分- 忽略有关 ClickOnce 的其余文章。](http://msdn.microsoft.com/en-us/library/aa697429(VS.80).aspx#atupvb6ap2_topic4)

# lisp - 为 Common Lisp 项目自动创建 ASDF 文件

> ID：270525
> 
> 赞同：4
> 
> 时间：2008-11-06T22:11:53.543
> 
> 标签：lisp, common-lisp, asdf

有没有图书馆可以做到这一点？玩转 Common Lisp 似乎这将是降低新手入门门槛的最有用的东西之一。ASDF 似乎主要是为部署而设计的，而不是为快速原型设计和开发而设计的。关注 comp.lang.lisp 上的线程，似乎人们同意 CL 的包系统功能强大，但缺乏 Python 死的简单模块系统之类的易用性。从某种意义上说，它是为功率而不是可用性而设计的，这是失败的。

很高兴知道我是否错了。如果我是对的，我很惊讶没有人尝试在 ASDF 之上构建类似 Python 模块的系统。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-07-11T19:23:29.883

[Zach Beane 写](http://xach.livejournal.com/278047.html)了他现在如何使用 Quicklisp 和 Quickproject 开始新的 Common Lisp 项目。这可能是你想要的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-07T01:00:07.870

不确定它是否已经准备好迎接黄金时段，或者它是否完全符合您的要求，但这里有一个[XCVB](http://common-lisp.net/project/xcvb/)的链接。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-07T09:58:52.947

我不知道。我主要使用 ASDF 来满足我的开发中编译需求。一旦您注意到您会从多个源文件中受益，请打开 <projectname>.asd，添加一个基本的 ASDF 系统定义模板并开始添加文件名。当您注意到跨文件依赖项时，请更新依赖项列表。

但是，然后，我使用完全相同的方法来处理 Makefile（是的，我知道有自动依赖检查器可以为你做这件事，但是由于我主要是自己编写代码，所以将 Makefile/ASDF 定义修改为更容易我去）。

在 SBCL 中，REQUIRE 上有一个检查 ASDF 系统的钩子，因此您最终会得到与 Python 的导入一样方便的东西，但不知何故，我怀疑这不是您的意思。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-07T00:47:26.787

这可能不是您想要的答案，但显然您对模块系统中的需求有所了解。您是否考虑过自己创建一个？也就是说，利用您有限的领域、有限的要求、您的环境，并简单地敲出任何可以迅速让您的生活更轻松的抽象？

这是 Lisp 的主要优点之一，我相信你知道，这些简单的抽象和小工具通常很容易在 Lisp 中制作。

我并不是建议解决所有对包系统或 ASDF 有问题的人，我只是建议按照您的理解解决您自己的问题，这可能比一些更强大的更大范围更简单、更小。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-17T09:27:52.820

现在也有[泥球](http://mudballs.com/)。

如果您正在寻找一款软件来添加此功能，那么这是一个不错的选择。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-01-25T00:02:54.923

如果您想要一个只使用 bash 生成新的通用 lisp 项目目录和文件布局的命令行工具，您可能会发现我为自己创建的一个很有用：[lispproject](https://github.com/analyticd/lispproject)。如果它不符合您的需求，请继续分叉它或从它获取模板的 repo 以满足您的需求：[lisp-project-template](https://github.com/analyticd/lisp-project-template)。查看 lispproject repo 中的 sh 文件，了解模板的使用方式。另外，请注意，当我在 macOS 上使用它时，您可能需要调整对 sed 的调用以适应您的平台。替代 sed 调用在主脚本中，但如果您需要它们，只需将它们注释掉。

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2008-11-06T22:19:41.813

> 它是为电源而不是可用性而设计的

这就是大多数 Lisp 大师喜欢它的方式。

# c++ - 断言与 ATLASSERT 与断言

> ID：270527
> 
> 赞同：7
> 
> 时间：2008-11-06T22:12:26.273
> 
> 标签：c++, mfc, assert

我正在重构一些充斥着`ASSERT`语句的 MFC 代码，并为将来的 Linux 移植做准备，我想用标准的`assert`. 人们知道的两种实现之间是否有任何显着差异可能会咬我的背面？

同样，我也遇到了一些`ATLASSERT`我也想替换的代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T22:36:29.500

不，MFC 版本只包含一个易于调试的断点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T22:23:08.437

[用您自己的断言宏](https://stackoverflow.com/questions/17732/when-should-assertions-stay-in-production-code)替换它们。这就是您从中获得最大好处的方式（日志记录、堆栈跟踪等）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T23:18:32.053

我建议使用您自己的宏，或者使用#define 进行 linux 编译。没有令人信服的理由放弃 Windows 方面的任何额外帮助（例如：内置断点），也没有令人信服的理由在一些简单的兼容性 #define 就足够的情况下更改大量代码。

# .net - 如何确定 .NET 程序集是为 x86 还是 x64 构建的？

> ID：270531
> 
> 赞同：352
> 
> 时间：2008-11-06T22:14:03.447
> 
> 标签：.net, assemblies, x86, 64-bit, x86-64

我有一个任意的.NET 程序集列表。

我需要以编程方式检查每个 DLL 是否是为 x86（而不是 x64 或任何 CPU）构建的。这可能吗？

* * *

## 回答 #1

> 赞同：330
> 
> 时间：2008-11-06T22:20:18.830

看着`System.Reflection.AssemblyName.GetAssemblyName(string assemblyFile)`

您可以从返回的 AssemblyName 实例中检查程序集元数据：

使用**PowerShell**：

```
[36] C:\> [reflection.assemblyname]::GetAssemblyName("${pwd}\Microsoft.GLEE.dll") | 佛罗里达州

名称：Microsoft.GLEE
版本：1.0.0.0
文化信息：
代码库：file:///C:/projects/powershell/BuildAnalyzer/...
EscapedCodeBase : file:///C:/projects/powershell/BuildAnalyzer/...
处理器架构：MSIL
标志：公钥
哈希算法：SHA1
版本兼容性：SameMachine
密钥对：
全名：Microsoft.GLEE，版本=1.0.0.0，文化=中性...

```

在这里，[ProcessorArchitecture](http://msdn.microsoft.com/library/system.reflection.processorarchitecture)标识目标平台。

*   **Amd64**：基于 x64 架构的 64 位处理器。
*   **Arm**：一个ARM处理器。
*   **IA64**：仅限 64 位 Intel Itanium 处理器。
*   **MSIL**：与处理器和每字位数无关。
*   **X86**：32 位 Intel 处理器，本机或在 64 位平台 (WOW64) 上的 Windows on Windows 环境中。
*   **无**：处理器和每字位数的未知或未指定组合。

在此示例中，我使用 PowerShell 来调用该方法。

* * *

## 回答 #2

> 赞同：234
> 
> 时间：2008-11-06T22:19:37.647

您可以使用[CorFlags](http://msdn.microsoft.com/en-us/library/ms164699%28v=vs.80%29.aspx) [CLI](http://en.wikipedia.org/wiki/Command-line_interface)工具（例如，C:\Program Files\Microsoft SDKs\Windows\v7.0\Bin\CorFlags.exe）根据其输出确定程序集的状态并将程序集作为二进制资产，您应该能够确定需要寻找的位置，以确定 32BIT 标志是设置为 1（*x86*）还是 0（*任何 CPU*或*x64*，具体取决于`PE`）：

```
Option    | PE    | 32BIT
----------|-------|---------
x86       | PE32  | 1
Any CPU   | PE32  | 0
x64       | PE32+ | 0 
```

博客文章*[x64 Development with .NET](https://web.archive.org/web/20130424225355/http://theruntime.com/blogs/brianpeek/archive/2007/11/13/x64-development-with-net.aspx)*提供了一些关于 .NET 的信息`corflags`。

更好的是，您可以[使用`Module.GetPEKind`](http://msdn.microsoft.com/en-us/library/system.reflection.module.getpekind(VS.80).aspx)其他属性来确定程序集是`PortableExecutableKinds`值`PE32Plus`（64 位）、`Required32Bit`（32 位和 WOW）还是（任何 CPU）。`ILOnly`

* * *

## 回答 #3

> 赞同：152
> 
> 时间：2009-06-16T17:11:02.630

只是为了澄清，CorFlags.exe 是[.NET Framework SDK](http://en.wikipedia.org/wiki/Microsoft_Windows_SDK)的一部分。我的机器上有开发工具，确定 DLL 是否仅为 32 位的最简单方法是：

1.  打开 Visual Studio 命令提示符（在 Windows 中：菜单开始/程序/Microsoft Visual Studio/Visual Studio 工具/Visual Studio 2008 命令提示符）

2.  CD 到包含相关 DLL 的目录

3.  像这样运行标志： `corflags MyAssembly.dll`

你会得到这样的输出：

```
Microsoft (R) .NET Framework CorFlags Conversion Tool.  Version  3.5.21022.8
Copyright (c) Microsoft Corporation.  All rights reserved.

Version   : v2.0.50727
CLR Header: 2.5
PE        : PE32
CorFlags  : 3
ILONLY    : 1
32BIT     : 1
Signed    : 0 
```

根据评论，上述标志应如下阅读：

*   任何 CPU：PE = PE32 和 32BIT = 0
*   x86：PE = PE32 和 32BIT = 1
*   64 位：PE = PE32+ 和 32BIT = 0

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2012-03-19T09:31:37.677

你自己写怎么样？自从在 Windows 95 中实现以来，PE 架构的核心并没有发生重大变化。下面是一个 C# 示例：

```
 public static ushort GetPEArchitecture(string pFilePath)
    {
        ushort architecture = 0;
        try
        {
            using (System.IO.FileStream fStream = new System.IO.FileStream(pFilePath, System.IO.FileMode.Open, System.IO.FileAccess.Read))
            {
                using (System.IO.BinaryReader bReader = new System.IO.BinaryReader(fStream))
                {
                    if (bReader.ReadUInt16() == 23117) //check the MZ signature
                    {
                        fStream.Seek(0x3A, System.IO.SeekOrigin.Current); //seek to e_lfanew.
                        fStream.Seek(bReader.ReadUInt32(), System.IO.SeekOrigin.Begin); //seek to the start of the NT header.
                        if (bReader.ReadUInt32() == 17744) //check the PE\0\0 signature.
                        {
                            fStream.Seek(20, System.IO.SeekOrigin.Current); //seek past the file header,
                            architecture = bReader.ReadUInt16(); //read the magic number of the optional header.
                        }
                    }
                }
            }
        }
        catch (Exception) { /* TODO: Any exception handling you want to do, personally I just take 0 as a sign of failure */}
        //if architecture returns 0, there has been an error.
        return architecture;
    }
} 
```

现在的常数是：

```
0x10B - PE32  format.
0x20B - PE32+ format. 
```

但是使用这种方法，它允许新常量的可能性，只需在您认为合适的情况下验证返回即可。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2017-08-22T07:20:43.880

JetBrains 的 DotPeek 提供了查看 msil(anycpu)、x86、x64 的快捷方式 [![点窥](https://i.stack.imgur.com/KYHkA.png)](https://i.stack.imgur.com/KYHkA.png)

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2013-02-18T12:45:49.010

尝试[在 CodePlex 的这个项目中](http://apichange.codeplex.com/SourceControl/changeset/view/76c98b8c7311#ApiChange.Api/src/Introspection/CorFlagsReader.cs)使用 CorFlagsReader 。它没有对其他程序集的引用，可以按原样使用。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2013-09-26T18:11:44.783

```
[TestMethod]
public void EnsureKWLLibrariesAreAll64Bit()
{
    var assemblies = Assembly.GetExecutingAssembly().GetReferencedAssemblies().Where(x => x.FullName.StartsWith("YourCommonProjectName")).ToArray();
    foreach (var assembly in assemblies)
    {
        var myAssemblyName = AssemblyName.GetAssemblyName(assembly.FullName.Split(',')[0] + ".dll");
        Assert.AreEqual(ProcessorArchitecture.MSIL, myAssemblyName.ProcessorArchitecture);
    }
} 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2016-03-30T17:53:42.840

下面是一个批处理文件，它将`corflags.exe`针对当前工作目录`dlls`和`exes`所有子目录中的所有目录运行，解析结果并显示每个目录的目标架构。

根据使用的版本，`corflags.exe`输出中的行项目将包括`32BIT`、*或* `32BITREQ`(and `32BITPREF`)。输出中包含这两者中的任何一个都是必须检查以区分`Any CPU`和的关键行项目`x86`。如果您使用的是旧版本`corflags.exe`（Windows SDK v8.0A 之前的版本），那么只有`32BIT`行项目会出现在输出中，正如其他人在过去的答案中所指出的那样。否则`32BITREQ`，`32BITPREF`更换它。

这假设`corflags.exe`在`%PATH%`. 确保这一点的最简单方法是使用`Developer Command Prompt`. 或者，您可以从它的[默认位置](https://stackoverflow.com/a/4450356/4342563)复制它。

如果下面的批处理文件针对非托管`dll`or运行`exe`，它将错误地将其显示为`x86`，因为实际输出`Corflags.exe`将是类似于以下内容的错误消息：

> corflags：错误 CF008：指定的文件没有有效的托管标头

```
@echo off

echo.
echo Target architecture for all exes and dlls:
echo.

REM For each exe and dll in this directory and all subdirectories...
for %%a in (.exe, .dll) do forfiles /s /m *%%a /c "cmd /c echo @relpath" > testfiles.txt

for /f %%b in (testfiles.txt) do (
    REM Dump corflags results to a text file
    corflags /nologo %%b > corflagsdeets.txt

   REM Parse the corflags results to look for key markers   
   findstr /C:"PE32+">nul .\corflagsdeets.txt && (      
      REM `PE32+` indicates x64
        echo %%~b = x64
    ) || (
      REM pre-v8 Windows SDK listed only "32BIT" line item, 
      REM newer versions list "32BITREQ" and "32BITPREF" line items
        findstr /C:"32BITREQ  : 0">nul /C:"32BIT     : 0" .\corflagsdeets.txt && (
            REM `PE32` and NOT 32bit required indicates Any CPU
            echo %%~b = Any CPU
        ) || (
            REM `PE32` and 32bit required indicates x86
            echo %%~b = x86
        )
    )

    del corflagsdeets.txt
)

del testfiles.txt
echo. 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2018-08-18T18:06:49.690

我克隆了一个超级方便的工具，它在 Windows 资源管理器中为程序集添加上下文菜单条目以显示所有可用信息：

在此处下载： [https ://github.com/tebjan/AssemblyInformation/releases](https://github.com/tebjan/AssemblyInformation/releases)

[![在此处输入图像描述](https://i.stack.imgur.com/EwVii.png)](https://i.stack.imgur.com/EwVii.png)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-07-28T04:49:15.783

另一种方法是在 DLL 上使用 Visual Studio 工具中的 dumpbin 并查找适当的输出

```
dumpbin.exe /HEADERS <your dll path>
    FILE HEADER VALUE
                 14C machine (x86)
                   4 number of sections
            5885AC36 time date stamp Mon Jan 23 12:39:42 2017
                   0 file pointer to symbol table
                   0 number of symbols
                  E0 size of optional header
                2102 characteristics
                       Executable
                       32 bit word machine
                       DLL 
```

注：以上 o/p 为 32bit dll

dumpbin.exe 的另一个有用选项是 /EXPORTS，它将向您显示 dll 公开的函数

```
dumpbin.exe /EXPORTS <PATH OF THE DLL> 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-03-27T15:08:19.850

更通用的方法 - 使用文件结构来确定位数和图像类型：

```
public static CompilationMode GetCompilationMode(this FileInfo info)
{
    if (!info.Exists) throw new ArgumentException($"{info.FullName} does not exist");

    var intPtr = IntPtr.Zero;
    try
    {
        uint unmanagedBufferSize = 4096;
        intPtr = Marshal.AllocHGlobal((int)unmanagedBufferSize);

        using (var stream = File.Open(info.FullName, FileMode.Open, FileAccess.Read))
        {
            var bytes = new byte[unmanagedBufferSize];
            stream.Read(bytes, 0, bytes.Length);
            Marshal.Copy(bytes, 0, intPtr, bytes.Length);
        }

        //Check DOS header magic number
        if (Marshal.ReadInt16(intPtr) != 0x5a4d) return CompilationMode.Invalid;

        // This will get the address for the WinNT header  
        var ntHeaderAddressOffset = Marshal.ReadInt32(intPtr + 60);

        // Check WinNT header signature
        var signature = Marshal.ReadInt32(intPtr + ntHeaderAddressOffset);
        if (signature != 0x4550) return CompilationMode.Invalid;

        //Determine file bitness by reading magic from IMAGE_OPTIONAL_HEADER
        var magic = Marshal.ReadInt16(intPtr + ntHeaderAddressOffset + 24);

        var result = CompilationMode.Invalid;
        uint clrHeaderSize;
        if (magic == 0x10b)
        {
            clrHeaderSize = (uint)Marshal.ReadInt32(intPtr + ntHeaderAddressOffset + 24 + 208 + 4);
            result |= CompilationMode.Bit32;
        }
        else if (magic == 0x20b)
        {
            clrHeaderSize = (uint)Marshal.ReadInt32(intPtr + ntHeaderAddressOffset + 24 + 224 + 4);
            result |= CompilationMode.Bit64;
        }
        else return CompilationMode.Invalid;

        result |= clrHeaderSize != 0
            ? CompilationMode.CLR
            : CompilationMode.Native;

        return result;
    }
    finally
    {
        if (intPtr != IntPtr.Zero) Marshal.FreeHGlobal(intPtr);
    }
} 
```

编译模式枚举

```
[Flags]
public enum CompilationMode
{
    Invalid = 0,
    Native = 0x1,
    CLR = Native << 1,
    Bit32 = CLR << 1,
    Bit64 = Bit32 << 1
} 
```

[GitHub 上](https://github.com/BlackGad/PS.FileStructureAnalyzer)带有解释的源代码

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-08-04T07:56:59.720

[检查 .NET 程序集的目标平台的另一种方法是使用.NET Reflector](http://en.wikipedia.org/wiki/.NET_Reflector)检查程序集...

@#~#€~！我刚刚意识到新版本不是免费的！所以，更正一下，如果你有一个免费版本的 .NET 反射器，你可以用它来检查目标平台。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-04-24T01:19:59.057

cfeduke 注意到调用 GetPEKind 的可能性。从 PowerShell 执行此操作可能很有趣。

例如，这里是可以使用的 cmdlet 的代码：[https ://stackoverflow.com/a/16181743/64257](https://stackoverflow.com/a/16181743/64257)

或者，在[https://stackoverflow.com/a/4719567/64257](https://stackoverflow.com/a/4719567/64257)中指出“ [PowerShell 社区扩展](http://pscx.codeplex.com/)中还有 Get-PEHeader cmdlet，可用于测试可执行映像。”

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-10-04T12:12:36.240

您可以在这里找到更高级的应用程序：[CodePlex - ApiChange](http://apichange.codeplex.com/)

例子：

```
C:\Downloads\ApiChange>ApiChange.exe -CorFlags c:\Windows\winhlp32.exe
File Name; Type; Size; Processor; IL Only; Signed
winhlp32.exe; Unmanaged; 296960; X86

C:\Downloads\ApiChange>ApiChange.exe -CorFlags c:\Windows\HelpPane.exe
File Name; Type; Size; Processor; IL Only; Signed
HelpPane.exe; Unmanaged; 733696; Amd64 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-05-19T11:30:02.577

已经提到的工具的替代品是[Telerik JustDecompile](https://www.telerik.com/products/decompiler.aspx)（免费工具），它将在程序集名称旁边显示信息：

[![Telerik 中的任何或 x86 或 x64 信息](https://i.stack.imgur.com/41Igu.png)](https://i.stack.imgur.com/41Igu.png)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-04-14T22:48:39.150

我喜欢**[ILSpy](https://github.com/icsharpcode/ILSpy)工具**的家伙。它不仅展示了架构，还展示了目标框架：

```
// linq2db, Version=3.0.0.0, Culture=neutral, PublicKeyToken=e41013125f9e410a
// Global type: <Module>
// Architecture: AnyCPU (64-bit preferred)
// Runtime: v4.0.30319
// This assembly is signed with a strong name key.
// This assembly was compiled using the /deterministic option.
// Hash algorithm: SHA1 
```

因此可以确定是 .Net Core 2.1、.Net Framework 4.6 还是其他任何一个：

[![目标框架](https://i.stack.imgur.com/43LFa.png)](https://i.stack.imgur.com/43LFa.png)

# c# - 嵌入 .Net 运行时

> ID：270533
> 
> 赞同：2
> 
> 时间：2008-11-06T22:14:59.187
> 
> 标签：c#, windows, mono, clr

我是否能够嵌入 .net 运行时以便在主机操作系统上不需要 .net？我正在通过查看此处查看使用 Mono 执行此操作：http: [//mono-project.com/Embedding_Mono](http://mono-project.com/Embedding_Mono)但似乎暗示使用外部模块来完成此操作。我的目标是拥有一个没有安装 .net 运行时的可执行文件。我不知道如何在我的应用程序中配置它来编译本机代码，链接单声道运行时 - 以及编译 C# 代码并链接它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-06T22:21:09.063

您现在可以像刚刚在 PDC 上演示的那样[静态编译 Mono 程序集。](http://tirania.org/blog/archive/2008/Nov-05.html)这样做的目的是允许 .Net 应用程序在 iPhone 上运行，但这应该可以在任何地方运行。

对此有一些限制；显然，它不能依赖于运行时生成的代码，所以 Reflection.Emit 不存在了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-07T03:21:14.870

我成功使用的第三方解决方案：[Xenocode](http://www.xenocode.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T22:18:28.773

目前不支持此功能，并且 AFAIK 没有计划更改该状态。

有一些第三方工具可以尝试为您执行此操作，但上次我检查时没有一个非常好。

# user-interface - VB6：与不可见的形式交互

> ID：270537
> 
> 赞同：2
> 
> 时间：2008-11-06T22:16:58.790
> 
> 标签：user-interface, forms, vb6

所以，我在 VB 中有一个表单，它是可见的，除非程序以静默方式启动，在这种情况下，表单仍然被加载，但交互是以编程方式完成的。但是，在极少数情况下，我希望在不可见表单中创建的表单是可见的。什么是最好的方法来实现这一点，理想情况下不创建新的形式。我想出了一些想法，但真的不喜欢：

*   创建一个新表单，传递该表单的 hwnd 以便它托管任何适用的窗口。真的很容易做到，可能相当灵活。还是丑。
*   手动调用可见表单，提取值，将用户填写的数据传递给不可见表单。这个解决方案可能是最简单的，但它也是一个 hack。如果它被用于少量表单，这是一个糟糕的解决方案，但它可能会。
*   创建一个新类，重构由事件触发的表单。
*   将主窗体设置为可见，但扭曲其加载功能，使其实际上不显示任何内容。
*   根本不使用不可见的表单，重构代码以更好地将表单的功能与使用分开。事实上，这在很大程度上已经是正确的，但我看不出有一种方法可以完全做到这一点，而不需要对类的使用方式进行一些重复，因为我最终需要使用包含相同功能的不同类。不过，这可能是理想主义的解决方案。

*   我实际上最终做了什么：在受影响的地方粘贴一个 shell 执行调用，它启动了一个用不同标志编译的程序副本的新实例。这并不像听起来那么糟糕。使用任何其他解决方案的部分问题是，每当我想在我的代码上添加不同的 UI 时，我都需要创建一个新的控制器类来以​​不同的方式处理相关事件。该程序的大部分界面已经与其实现分开，但是创建一个新的 UI 需要我添加额外的事件处理程序等等。诚然，它可能只需要大约 3 个事件处理程序来处理在触发事件时提示用户输入。

编辑：**在某种程度上，我误解了我的问题：**问题是我想回收我现有 UI 的一部分，但不是全部。因此，使我不希望用户看到的部分不可见，但使菜单看起来可见。解耦各个 UI 组件可能最终会增加程序的复杂性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T22:19:02.157

最后一个选项更可取；重构后应该没有多余的代码

摆弄不可见的表单很好地表明了重构的必要性！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T16:05:33.143

我也推荐最后一个选项。为了以最少的更改安全地实施，我会做的如下。

进行备份或将所有内容检查到您的源代码管理中并创建一个分支。

创建一个新的 ActiveX DLL 项目。我将其命名为 UI_Controller 的一些变体

注意：新项目将强制您识别 EXE 中隐藏的依赖项。

让它引用EXE现在的所有内容。

让 EXE 项目引用 UI_Controller。

为应用程序中的每个主要形式创建一个类。

将次要对话框复制到 UI_Controller DLL 中。

对于每个表单，在 UI_Controller DLL 中创建一个接口类（表单将实现它）

例如，如果您有六个主要表单，那么您就有六个表单接口和六个控制器类

浏览每个过程和事件的表单 将过程复制到 UI 控制器类并将其公开。

确保每个控制器类都有一个 Init 过程。

但是有一个例外，那就是如果代码只处理其他控件和表单。例如 Resize 事件重新排列代码。这样做的原因是特定于这种形式的逻辑。使用控制器类的不同表单或 UI 将具有不同的调整大小算法，因此移动该代码是没有意义的。你将不得不使用你最好的判断。

回到控制器类。许多过程需要引用特定表单上的元素或表单上的触发事件。在表单接口类中编写子例程标题或函数以允许该事件发生或检索所需信息。请注意，如果您发现相同的操作组合在一起或检索到的相同系列信息考虑只制作一个子程序而不是多个子程序。

将任何对表单的直接引用更改为对界面的调用。

让您的主要表单实现每个接口。在你的 UI 控制器 DLL 中创建一个 GlobalMultiUse 类，它允许 EXE 使用它的控制器注册每个表单。注册子例程应该只接受表单接口的对象。在您的应用程序初始化中，在您执行任何其他操作之前，已将每个主要表单传递给正确的注册函数。

运行您的项目并更正任何错误。请注意，您的软件的实际功能应该保持与您应该只是复制和实施的相同。

当软件运行无错误时。将其签入您的源代码管理或进行备份。

开始用对控制器表单的相应方法的调用替换您的主要表单之一的每个过程。如果任何其他表单调用您正在处理的表单上的某些内容，则将该调用切换到控制器。

完成后，确保在应用程序初始化部分调用控制器表单初始化。您需要切换到使用 Sub Main 才能正常工作。

当这正常工作时，可以在另一个表单上工作。继续这样做，直到所有表格都被转换。

清理任何不使用的东西。

测试，如果通过，你就完成了。

您现在拥有的是一个应用程序，您可以在其中撕掉当前的 UI 并替换为任何实现表单接口的东西。因此，您可以拥有一个不可见的 EXE、一个单元测试 EXE 和您的常规 EXE。

您必须根据应用程序的复杂性来决定最适合您的方法。您可以进行部分转换，其中您只为一个或两个表单提供控制器类。

# algorithm - 推荐人脸检测工具/SDK/等

> ID：270539
> 
> 赞同：5
> 
> 时间：2008-11-06T22:17:49.553
> 
> 标签：algorithm, image-processing

我正在寻找一种快速检测图片中人脸的方法（存储为 JPG 或任何其他流行的图像格式）。任何流行的编程语言的代码都可以（Python、C#、Java、Matlab 等）。我也愿意自己实现一个算法，只要它被证明是一个很好的工作。

或者，如果有已知的免费软件（最好是开放的，但不是必需的）工具或 SDK 来解决这个问题，我也会尝试它们。

最后，如果一切都失败了，也会考虑商业产品，所以也推荐那些。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T22:25:42.893

[OpenCV](http://opencv.willowgarage.com/wiki/)是一个支持人脸识别的开源库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-07T15:50:02.023

Emgu.CV 是 OpenCV 的 C# 包装器。有一个示例项目可以像在 OpenCV 中一样使用可调整的参数执行人脸识别。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-07-11T20:54:27.257

看看这些家伙，我曾经在一个项目中部分使用过这个。

[http://ayonix.com/en/products/software/ayofa.html](http://ayonix.com/en/products/software/ayofa.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-22T19:15:31.227

[我在这篇文章](https://stackoverflow.com/questions/5412387/face-recognition/10708503#10708503)中写了关于人脸分类的资源和示例代码。

如果您想快速进行人脸识别，请查看 OpenCV for Python 或 C++ 中的人脸识别示例[代码](http://opencv.willowgarage.com/wiki/FaceRecognition)。

还有一个我发现非常有用的 Matlab 代码，只需单击[此处即可运行](http://www.mathworks.com/matlabcentral/fileexchange/17066-fld-based-face-recognition-system)

# algorithm - 在集合中寻找模式

> ID：270541
> 
> 赞同：3
> 
> 时间：2008-11-06T22:18:36.777
> 
> 标签：algorithm, design-patterns, data-mining

我可以使用哪些算法来确定一组字符串中的常见字符？

为了使示例简单，我只关心连续 2 个以上的字符，以及它是否出现在 2 个或更多示例中。例如：

1.  0000abcde0000
2.  0000abcd00000
3.  000abc0000000
4.  00abc000de000

我想知道：

00 用于 1,2,3,4
000 用于 1,2,3,4
0000 用于 1,2,3
00000 用于 2,3
ab 用于 1,2,3,4
abc用于 1,2,3,4
abcd 用于 1,2
bc 用于 1,2,3,4
bcd 用于 1,2
cd 用于 1,2
de 用于 1,4

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-07T00:25:01.543

我假设这不是家庭作业。（如果是，你就是你自己的抄袭！;-)

下面是一个快速而肮脏的解决方案。时间复杂度是`O(m**2 * n)`平均`m`字符串长度，`n`是字符串数组的大小。

的实例`Occurrence`保留包含给定字符串的索引集。该`commonOccurrences`例程扫描一个字符串数组，调用`captureOccurrences`每个非空字符串。该`captureOccurrences`例程将当前索引放入`Occurrence`给定字符串的每个可能的子字符串中。最后，通过仅选择具有至少两个索引`commonOccurrences`的那些来形成结果集。`Occurrences`

请注意，您的示例数据具有比您在问题中确定的更多常见子字符串。例如，`"00ab"`出现在每个输入字符串中。根据内容（例如所有数字、所有字母等）选择有趣字符串的附加过滤器——正如他们所说——留给读者作为练习。;-)

快速而肮脏的 JAVA 源：

```
package com.stackoverflow.answers;

import java.util.Collections;
import java.util.HashMap;
import java.util.Map;
import java.util.Set;
import java.util.TreeSet;

public class CommonSubstringFinder {

    public static final int MINIMUM_SUBSTRING_LENGTH = 2;

    public static class Occurrence implements Comparable<Occurrence> {
        private final String value;
        private final Set<Integer> indices;
        public Occurrence(String value) {
            this.value = value == null ? "" : value;
            indices = new TreeSet<Integer>();
        }
        public String getValue() {
            return value;
        }
        public Set<Integer> getIndices() {
            return Collections.unmodifiableSet(indices);
        }
        public void occur(int index) {
            indices.add(index);
        }
        public String toString() {
            StringBuilder result = new StringBuilder();
            result.append('"').append(value).append('"');
            String separator = ": ";
            for (Integer i : indices) {
                result.append(separator).append(i);
                separator = ",";
            }
            return result.toString();
        }
        public int compareTo(Occurrence that) {
            return this.value.compareTo(that.value);
        }
    }

    public static Set<Occurrence> commonOccurrences(String[] strings) {
        Map<String,Occurrence> work = new HashMap<String,Occurrence>();
        if (strings != null) {
            int index = 0;
            for (String string : strings) {
                if (string != null) {
                    captureOccurrences(index, work, string);
                }
                ++index;
            }
        }
        Set<Occurrence> result = new TreeSet<Occurrence>();
        for (Occurrence occurrence : work.values()) {
            if (occurrence.indices.size() > 1) {
                result.add(occurrence);
            }
        }
        return result;
    }

    private static void captureOccurrences(int index, Map<String,Occurrence> work, String string) {
        final int maxLength = string.length();
        for (int i = 0; i < maxLength; ++i) {
            for (int j = i + MINIMUM_SUBSTRING_LENGTH; j < maxLength; ++j) {
                String partial = string.substring(i, j);
                Occurrence current = work.get(partial);
                if (current == null) {
                    current = new Occurrence(partial);
                    work.put(partial, current);
                }
                current.occur(index);
            }
        }
    }

    private static final String[] TEST_DATA = {
        "0000abcde0000",
        "0000abcd00000",
        "000abc0000000",
        "00abc000de000",
    };
    public static void main(String[] args) {
        Set<Occurrence> found = commonOccurrences(TEST_DATA);
        for (Occurrence occurrence : found) {
            System.out.println(occurrence);
        }
    }

} 
```

样本输出：（请注意，实际上每行只有一次出现；我似乎无法阻止块引用标记合并行）

> “00”：0,1,2,3 “000”：0,1,2,3
> “0000”：0,1,2 “0000a”：0,1
> “0000ab”：0,1 “0000abc”：0 ,1
> "0000abcd": 0,1 "000a": 0,1,2
> "000ab": 0,1,2 "000abc": 0,1,2
> "000abcd": 0,1 "00a": 0,1 ,2,3
> "00ab": 0,1,2,3 "00abc": 0,1,2,3
> "00abc0": 2,3 "00abc00": 2,3
> "00abc000": 2,3 "00abcd" : 0,1
> "0a": 0,1,2,3 "0ab": 0,1,2,3
> "0abc": 0,1,2,3 "0abc0": 2,3
> "0abc00": 2, 3 "0abc000": 2,3
> "0abcd": 0,1 "ab": 0,1,2,3 "abc": 0,1,2,3 “abc0”：2,3 “abc00”：2,3
> “abc000”：2,3 “abcd”：0,1 “bc”：0,1,2,3 “bc0”：2,3 “bc00” : 2,3
> "bc000": 2,3 "bcd": 0,1 "c0": 2,3 "c00": 2,3 "c000": 2,3 "cd": 0,1
> “de”：0,3 “de0”：0,3 “de00”：0,3
> “e0”：0,3 “e00”：0,3

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T22:26:27.710

这很可能是一个 NP 难题。它看起来类似于[多序列比对](http://en.wikipedia.org/wiki/Sequence_alignment)，即。基本上，您可以根据需要调整多维[Smith-Waterman](http://en.wikipedia.org/wiki/Smith-Waterman)（= 局部序列比对）。不过，可能有更有效的算法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T22:47:12.880

构建一棵树，其中通过树的路径是字母序列。让每个节点都包含一个“集合”，将字符串引用添加到其中（或者只保留一个计数）。然后跟踪单词中的 N 个位置，其中 N 是您关心的最长序列（例如，在每个字符处开始一个新句柄，在每个步骤中向下遍历所有句柄，并在 N 步后中止每个句柄）

这对于小型、有限和密集的字母表会更有效（DNA 是我认为第一个使用它的地方）。

*编辑：*如果您事先知道您关心的模式，则可以通过提前构建树然后只检查您是否在树上而不是扩展它来更改上述模式以使其正常工作。

一个例子

输入

```
abc
abd
abde
acc
bde 
```

那个树

```
a : 4
  b : 3
    c : 1
    d : 2
      e : 1
  c : 1
    c : 1
b : 4
  d : 3
    e : 2
  c : 1
c : 3
  c : 1
d : 3
  e : 2 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T22:26:49.957

您是否知道需要提前搜索的“价值观”？或者您是否需要代码来解析字符串，并像您发布的那样为您提供统计信息？

如果您提前知道要查找的内容，则使用 Boyer-Moore 算法是判断子字符串是否存在（甚至定位它们）的一种非常快速的方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-07T00:43:40.977

在网上查找“后缀树”。或者选择 Dan Gusfield 的“字符串、树和序列的算法”。我没有要验证的书，但是[后缀树上的维基百科页面](http://en.wikipedia.org/wiki/Suffix_tree)说，第 205 页包含解决您的问题的方法：“找到一组中至少 k 个字符串共有的最长子字符串”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T22:24:21.037

您可以使用距离矩阵的分析。任何对角线移动（无成本变化）都是完全匹配的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-07T05:15:29.617

您可能会发现[后缀数组](http://en.wikipedia.org/wiki/Suffix_array)比后缀树更简单、更有效，具体取决于数据中常见子字符串的频率——如果它们足够常见，您将需要更复杂的后缀数组构造算法。（天真的方法是只使用您的库排序功能。）

# c++ - 在 Boost Test 框架中测试 assert

> ID：270542
> 
> 赞同：22
> 
> 时间：2008-11-06T22:18:52.983
> 
> 标签：c++, unit-testing, boost, assert, boost-test

我使用 Boost Test 框架对我的 C++ 代码进行单元测试，并想知道是否可以测试一个函数是否会断言？是的，听起来有点奇怪，但请耐心等待！我的许多函数在输入时检查输入参数，断言它们是否无效，对此进行测试会很有用。例如：

```
void MyFunction(int param)
{
    assert(param > 0); // param cannot be less than 1
    ...
} 
```

我希望能够做这样的事情：

```
BOOST_CHECK_ASSERT(MyFunction(0), true);
BOOST_CHECK_ASSERT(MyFunction(-1), true);
BOOST_CHECK_ASSERT(MyFunction(1), false);
... 
```

您可以使用 Boost Test 检查抛出的异常，所以我想知道是否也有一些断言魔法......

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-11-20T19:50:50.960

遇到同样的问题，我翻阅了文档（和代码）并找到了一个“解决方案”。

Boost UTF 使用`boost::execution_monitor`(in `<boost/test/execution_monitor.hpp>`)。这是为了捕捉测试执行过程中可能发生的一切而设计的。当找到一个断言时，execution_monitor 会拦截它并抛出`boost::execution_exception`. 因此，通过使用，`BOOST_REQUIRE_THROW`您可以断言断言的失败。

所以：

```
#include <boost/test/unit_test.hpp>
#include <boost/test/execution_monitor.hpp>  // for execution_exception

BOOST_AUTO_TEST_CASE(case_1)
{
  BOOST_REQUIRE_THROW(function_w_failing_assert(),
                      boost::execution_exception);
} 
```

应该做的伎俩。（这个对我有用。）

但是（或免责声明）：

*   这个对我有用。也就是说，在 Windows XP、MSVC 7.1 上，boost 1.41.0。您的设置可能不合适或损坏。

*   这可能不是 Boost Test 的作者的本意。（虽然它似乎是 execution_monitor 的目的）。

*   它将以相同的方式处理每种形式的致命错误。我可能是您的断言以外的其他东西失败了。在这种情况下，您可能会错过 ega 内存损坏错误，和/或错过失败的失败断言。

*   它可能会在未来的增强版本中中断。

*   我预计如果在发布配置中运行它会失败，因为断言将被禁用并且断言设置为阻止的代码将运行。导致非常不确定的行为。

*   如果在 msvc 的发布配置中，无论如何都会发生一些类似断言或其他致命错误，它不会被捕获。（参见 execution_monitor 文档）。

*   是否使用断言取决于您。我喜欢他们。

看：

*   [http://www.boost.org/doc/libs/1_41_0/libs/test/doc/html/execution-monitor/reference.html#boost.execution_exception](http://www.boost.org/doc/libs/1_41_0/libs/test/doc/html/execution-monitor/reference.html#boost.execution_exception)

*   执行监视器用户指南。

另外，感谢 Gennadiy Rozental（Boost Test 的作者），如果你碰巧读到了这篇文章，干得好！！

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-07-19T17:01:42.590

我喜欢检查两种错误：不变量和运行时错误。

不变量是无论如何都应该始终为真的事物。对于那些，我使用断言。像你这样的事情不应该给我一个你给我的输出缓冲区的零指针。这是代码中的一个错误，简单明了。在调试版本中，它会断言并给我一个纠正它的机会。在零售版本中，它会导致访问冲突并生成小型转储（Windows，至少在我的代码中）或核心转储（Mac/unix）。对于`catch`解除对零指针的引用，我无法做到这一点。在 Windows`catch (...)`上，可以抑制访问冲突，并给用户一种错误的自信感，当事情已经发生了可怕的、可怕的错误时，事情已经好了。

这就是为什么我开始相信这`catch (...)`通常是 C++ 中的代码异味的原因之一，并且我能想到的唯一合理的地方是在您生成核心转储并礼貌地退出应用程序之前的`main`（或）中。`WinMain`

运行时错误是诸如“我不能写这个文件，因为权限”或“我不能写这个文件，因为磁盘已满”之类的东西。对于这些类型的错误，抛出异常是有意义的，因为用户可以对其执行一些操作，例如更改目录的权限、删除一些文件或选择备用位置来保存文件。这些运行时错误可由用户纠正。用户无法纠正对不变量的违反，只能由程序员纠正。（有时两者是相同的，但通常不是。）

您的单元测试应该强制代码抛出您的代码可能生成的运行时错误异常。您可能还希望从协作者那里强制异常，以确保您的被测系统是异常安全的。

但是，我不认为尝试通过单元测试强制您的代码针对不变量进行断言是没有价值的。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-06T23:05:21.127

我不这么认为。您总是可以编写自己的断言来引发异常，然后使用 BOOST_CHECK_NOTHROW() 来处理该异常。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-07-19T19:28:51.280

我认为这个问题以及一些回复将运行时错误检测与错误检测混淆了。他们还混淆了意图和机制。

运行时错误是在 100% 正确的程序中可能发生的事情。它需要检测，需要适当的报告和处理，并且应该进行测试。错误也会发生，为了程序员的方便，最好使用前置条件检查或不变检查或随机断言尽早发现它们。但这是程序员的工具。该错误消息对于普通用户来说毫无意义，并且在正确编写的程序永远不会传递给它的数据上测试函数行为似乎是不合理的。

至于意图和机制，需要注意的是，异常并不是什么魔法。前段时间，Peter Dimov 在 Boost 邮件列表（大约）上说“异常只是非本地跳转机制”。这是非常真实的。如果您的应用程序可以在发生一些内部错误后继续，而不会有在修复之前损坏某些东西的风险，您可以实现引发 C++ 异常的自定义断言。但它不会改变意图，也不会使断言测试更加合理。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-07-26T22:24:29.260

在工作中，我遇到了同样的问题。我的解决方案是使用编译标志。当我的标志 GROKUS_TESTABLE 处于打开状态时，我的 GROKUS_ASSERT 会变成异常，并且使用 Boost，您可以测试引发异常的代码路径。当 GROKUS_TESTABLE 关闭时，GROKUS_ASSERT 被转换为 c++ assert()。

```
#if GROKUS_TESTABLE
#define GROKUS_ASSERT ... // exception
#define GROKUS_CHECK_THROW    BOOST_CHECK_THROW
#else
#define GROKUS_ASSERT ... // assert
#define GROKUS_CHECK_THROW(statement, exception)  {}  // no-op
#endif 
```

我最初的动机是帮助调试，即 assert() 可以快速调试，异常通常在 gdb 中更难调试。我的编译标志似乎很好地平衡了可调试性和可测试性。

希望这可以帮助

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T23:24:42.273

对不起，但你以错误的方式解决你的问题。

“assert”是魔鬼的产物（又名“C”），对于任何有适当例外的语言都是无用的。重新实现带有异常的类似断言的功能会更好。这样，您实际上就有机会以正确的方式处理错误（包括正确的清理程序）或随意触发它们（用于单元测试）。

此外，如果您的代码曾经在 Windows 中运行，那么当您的断言失败时，您会得到一个无用的弹出窗口，让您可以调试/中止/重试。非常适合自动化单元测试。

所以帮自己一个忙，重新编写一个抛出异常的断言函数。这里有一个： [如何在不使用 abort() 的情况下断言 ()？](https://stackoverflow.com/questions/37473/how-can-i-assert-without-using-abort)

将它包装在一个宏中，这样你就可以得到 _ _FILE _ _ 和 _ _ LINE _ _ （对调试有用），你就完成了。

# build-process - 是否有设置 CruiseControl.NET 的分步教程？

> ID：270550
> 
> 赞同：19
> 
> 时间：2008-11-06T22:20:21.170
> 
> 标签：build-process, build-automation, cruisecontrol.net

怎么做 .NET Web 应用程序的自动夜间构建并上传到测试服务器。

或者，如果这个工具太过分了，请提出其他建议。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-10T23:18:58.557

我找到了这个很棒的教程：[如何在几分钟内使用 CruiseControl.NET 连接 VS.NET 2005 解决方案](http://weblogs.asp.net/jdanforth/pages/How-to-Hook-Up-a-VS.NET-2005-Solution-With-CruiseControl.NET-in-a-Few-Minutes.aspx)。它很短，但使用了一个真实的 .Net 项目来说明设置。

[之后，通过阅读CruiseControl.NET](http://confluence.public.thoughtworks.org/display/CCNET/Configuring+the+Server)的每个相关部分来优化您的配置：配置服务器

对于一个非常好的和最近的教程，检查[Integrating MSBuild with CruiseControl.NET](http://www.dougrohm.com/blog/post/2006/01/29/Integrating-MSBuild-with-CruiseControlNET.aspx)。非常好的一个！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-10T23:23:43.850

其他答案都很好，但是您是否也看过[CI 工厂](http://cifactory.org/joomla/)？从 CI 工厂网站：

> CI 工厂是一个持续集成系统，而不仅仅是一个 CI 服务器。它以最少的配置为您创建了一个 CI 系统，包括您的大部分开发环境。它将创建一个开发树，编写您的构建脚本，设置一个超级强大的 CruiseControl.Net 版本，将其全部导入源代码控制等等。它完成了每个人在创建 CI 系统时必须做的所有工作。它甚至内置了自动分支创建功能，因此下次您需要为发布创建分支时，CI Factory 将为您处理。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T22:21:43.727

[CruiseControl.NET 从零开始](http://joefield.mysite4now.com/blogs/blog/articles/146.aspx)

它是一个很棒的工具，我们在这里使用它来执行每小时构建和管理多个项目。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T22:26:33.780

我使用了 CruiseControl.Net 网站上的说明和示例

[从头开始设置第 1 部分](http://confluence.public.thoughtworks.org/display/CCNET/Setting+up+from+scratch++Part+01)。

# sql - 如果我将一个数字集合变成一个表格，那么该列的名称是什么？10gR2

> ID：270552
> 
> 赞同：2
> 
> 时间：2008-11-06T22:21:11.730
> 
> 标签：sql, oracle, collections

如果我想用列名替换 *，它会是什么？

```
create type mytable$t as table of number;
/

declare 

mytmou  mytable$t := myTable$T();

cnt pls_integer ;

begin

    mytmou := myTable$T(1,2,3,4,5,6);

    SELECT count(*) into cnt From Table (mytmou);

    dbms_output.put_line(cnt);

end;

6 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T22:39:08.590

`COLUMN_VALUE`是列的名称

```
SQL> ed
Wrote file afiedt.buf

  1  declare
  2    mytmou  mytable$t := myTable$T();
  3    cnt pls_integer ;
  4  begin
  5      mytmou := myTable$T(1,2,3,4,5,6);
  6      SELECT count(column_value) into cnt From Table (mytmou);
  7      dbms_output.put_line(cnt);
  8* end;
SQL> /
6

PL/SQL procedure successfully completed. 
```

# .net - 如何禁用控制台选项

> ID：270558
> 
> 赞同：0
> 
> 时间：2008-11-06T22:23:39.247
> 
> 标签：.net, console

是否可以禁用 .net 控制台应用程序的选项对话框？或者以某种方式阻止用户更改控制台属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T22:27:09.253

不，这是不可能的。

实际上，可以通过获取控制台窗口的 hWnd 并对其进行修改来实现。但这肯定会在其他 Windows 版本/语言环境中造成灾难。不要这样做。

无论如何，你为什么要这样做？

# asp.net - SQL - 通过可以采用不同值的文本框进行查询

> ID：270561
> 
> 赞同：1
> 
> 时间：2008-11-06T22:23:59.730
> 
> 标签：asp.net, sql, sql-server

开发一个网站并试图回到（聪明的）SQL查询等的摇摆中，今晚我的思绪完全消失了！

有一个网站[http://www.ufindus.com/](http://www.ufindus.com/)有一个文本框，允许您输入地名或邮政编码/邮政编码。我正在尝试做一些类似的事情，但我对 SQL 很垃圾 - 那么你如何构造一个可能查看 2 列（即地点和邮政编码）的 SQL 语句，因为你不能查询两个字段的相同值，例如

```
place = 'YORK' AND postcode = 'YORK' 
```

或者

```
place = 'YO21 5EA' AND postcode = 'YO21 5EA' 
```

因此，您是否必须输入一些逻辑才能足够智能地检测它是否看起来像地名或邮政编码 - 这对我来说似乎太复杂了！任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-06T22:27:44.603

您可以使用“或”来完成工作。例如，

地点 = 'YORK' 或邮编 = 'YORK'

您还可以使用 LIKE 语句做得更好，如

地点如“YORK%”或邮政编码如“YORK%”

（这假设地点和邮政编码都是基于字符的列）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T22:28:13.387

为什么不使用 OR 而不是 AND？

```
place = @textboxvalue OR post = @textboxvalue 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T22:28:15.837

尝试匹配地点和邮政编码有什么问题？如果我输入“York”并且（某处）恰好是一个有效的邮政编码，我应该得到那个结果。至于防止两次输入相同的内容，您可以在进行数据库调用之前在验证中处理它。

啊。猜猜我的吸收速度有点慢。是的...其他人的建议是正确的，“或”就是您要寻找的。我误解了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T08:45:03.313

好的，首先我假设您有一个表，其中包含邮政编码到地名的映射。

让我们将此表称为“*邮政编码*”，列“*邮政编码*”和“*邮政地址*”。这两个都是字符类型。

然后.. 无论您做什么，请确保来自用户的输入不是动态 sql 的一部分。确保它是一个**参数**。否则，您正在招致 SQL 注入攻击，这真的会毁了您的一天。这很**重要**。

我们的用户输入在*@textboxstring*中。

鉴于此，您可以像这样获取邮政编码和邮政地址：

`select @textboxstring = RTRIM(@textboxstring) + '%'; select postcode, postplace from postcode where postcode like @textboxstring or postplace like @textboxstring;`

请注意，我正在修改 @textboxstring 以获得通配符匹配，`like`而无需使用动态 sql。

如果邮政编码是整数，则需要在执行 sql 之前将输入转换为 int。因此，也可以使用@textboxint，您可以这样做：

`select @textboxstring = RTRIM(@textboxstring) + '%'; select postcode, postplace from postcode where postcode = @textboxint or postplace like @textboxstring;`

哦，您需要处理您的搜索可能有多个结果。您可能只想要第一行。

# seo - URL 中的特殊字符

> ID：270570
> 
> 赞同：3
> 
> 时间：2008-11-06T22:26:39.833
> 
> 标签：seo, friendly-url

我们目前正在用连字符 (-) 替换 URL 中的所有特殊字符和空格。从 SEO 和可读性的角度来看，这很好用。但是，在某些情况下，我们会在去掉连字符后将部分 URL 输入到搜索中。当搜索词*应该*有连字符时会出现问题，因为当它们被剥离时它不会返回任何结果。我们可以修改我们正在使用的搜索算法，但这会减慢它的速度（特别糟糕，因为我们将它与 AJAX-ed 搜索框一起使用，这需要*快速*）。

据我们所知，处理这个问题的最佳选择是用管道 (|) 替换预先存在的连字符。我有一种感觉，这将对这些术语的 SEO 产生负面影响，因为管道字符将被视为单词的一部分，而不是分隔符。据我所知，*唯一*被认为是分隔符的字符是连字符和正斜杠 (/)。

所以我的问题是：

1.  我们可以使用替代字符来表示连字符吗？
2.  如果我们不能使用任何其他字符，那么使用竖线字符会对搜索引擎产生多大的影响？

干杯，扎克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T22:49:21.160

〜（[波浪号](http://en.wikipedia.org/wiki/Tilde)）会起作用吗？

编辑：Google 现在将[下划线和破折号视为单词分隔符](http://news.cnet.com/8301-10784_3-9748779-7.html)，因此您可以将破折​​号用作破折号，将下划线用作空格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T22:28:19.110

为什么不使用 URL 编码？大多数框架都内置了实用程序来执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T22:32:02.520

我打算对 URL 编码说同样的话，但如果你想摆脱特殊字符，我想你不想要带有百分号的 URL，对吧？

改变“将部分 URL 输入搜索”的算法怎么样？您不能添加一些逻辑来不替换 URL 的搜索查询部分中的连字符吗？

# windows - 在 Windows 中，如何启动 cygwin shell n 次然后调整其窗口大小？

> ID：270582
> 
> 赞同：2
> 
> 时间：2008-11-06T22:29:29.093
> 
> 标签：windows, cygwin

我的希望是单击一个快捷方式，然后在我面前布置一个 cygwin shell 网格，填满我的整个屏幕。

知道我应该从哪里开始寻找吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-06T22:34:10.830

简短回答： `.pif`文件和批处理文件... 详细回答：编写一些代码来创建进程并找到所需的窗口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T23:05:31.843

rxvt 有一个几何选项：

> rxvt --几何100x10+500+200

为您提供一个 100 列宽、10 行高的 rxvt 窗口，位于（左上）像素位置 500x、200y。

要从批处理文件调用以便在后台调用（如 unix 上的“&”），请使用 start：

> 启动 C:\cygwin\bin\rxvt

要使用 4 个 cygwin rxvt 窗口的网格填充 2560x1600 显示器，您需要制作一个像这样的批处理文件：

> 开始 C:\cygwin\bin\rxvt --geometry 179x65+0+0 -sl 1500 -fn "Lucida Console-12" -bg black -fg gray -sr -e /usr/bin/bash --login -i
> start C:\cygwin\bin\rxvt --geometry 179x65+1280+0 -sl 1500 -fn "Lucida Console-12" -bg black -fg gray -sr -e /usr/bin/bash --login -i
> start C :\cygwin\bin\rxvt --geometry 179x65+0+800 -sl 1500 -fn "Lucida Console-12" -bg black -fg gray -sr -e /usr/bin/bash --login -i
> start C: \cygwin\bin\rxvt --geometry 179x65+1280+800 -sl 1500 -fn "Lucida Console-12" -bg black -fg gray -sr -e /usr/bin/bash --login -i

如果您还没有使用 rxvt，我*强烈*推荐它（或任何其他比 DOS 盒更好的终端）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T15:29:52.057

我对一个名为“openx.bat”的小批处理文件做了类似的事情，它只包含：

```
@c:\cygwin\bin\run -p /usr/bin /bin/bash -c "ps | grep -q XWin && DISPLAY=:0 . ~/.startxwinrc || startxwin.exe &" 
```

这将检查我是否有一个活动的 XWin 服务器正在运行，如果没有则启动一个。如果我这样做了，它只会重新加载我的 .startxwinrc 文件，其中包含以下几行：

```
#!/bin/sh

bash -l -c 'xterm -geometry 144x48+25+50' &
bash -l -c 'xterm -geometry 144x48+715+520' &
bash -l -c 'xterm -geometry 144x48+1615+520' &
bash -l -c 'xterm -geometry 144x48+2300+50' & 
```

这可以（并且应该）进行修改以适合您自己的喜好 - 我在双显示器系统上使用它，这会将两个外壳窗口放在屏幕上我认为方便的位置。

最后一步是我创建了一个桌面快捷方式来启动 openx.bat，我使用 XWin.exe 中的图标作为快捷方式的图标。如果您使用的是 Vista，您也可以将快捷方式拖到“快速启动”栏。

# asp.net - 围绕多个控件使用一个 UpdatePanel 还是单独的 UpdatePanel 更好？

> ID：270590
> 
> 赞同：1
> 
> 时间：2008-11-06T22:31:19.463
> 
> 标签：asp.net, asp.net-ajax

我有一个包含多个 ListBoxes、TextBoxes、DropDowns 的 Web 表单。如果我在整个页面周围放置一个 UpdatePanel，我注意到页面速度较慢。这是因为每个控件都在更新吗？如果我在每个控件周围放置不同的 UpdatePanel，我注意到页面的响应更好。假设这是因为我可以更好地控制页面的哪些部分根据来自 ListBoxes 和 DropDowns 的选择进行更新，这是否正确？

谢谢，

X

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-06T22:32:54.360

每个更新面板都会生成到服务器的往返行程（我假设您正在使用计时器或其他东西来导致这种情况）

一般规则是将*必须*一起更改的更新面板中的控件分组，否则单独的更新面板更有意义

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T01:05:36.517

我使用带有一组相关功能的更新面板。我发现对于我的应用程序，当页面上有相关的内容时，例如搜索工具，最好放在它自己的更新面板中。但是要小心在您的页面上放置太多更新面板，因为客户端必须下载更多代码才能运行。

我使用的一个规则是将所有面板的更新模式设置为仅在更改子项时触发，并且在某些情况下，最好在您的代码中以编程方式执行此操作。如果您在另一个更新面板中有一部分项目但两者都不需要更新，或者父项只需要偶尔更新，这是最好的情况。

通过触发代码中的面板，您将为自己创建更多的工作，但最终您还将对用户体验有更多的控制，这可能有助于您发送更少的比特。

安德鲁

# c++ - 如果抽象基类是接口，派生类构造函数中是否必须调用基类构造函数？

> ID：270592
> 
> 赞同：4
> 
> 时间：2008-11-06T22:31:55.687
> 
> 标签：c++, oop, constructor, class-design, abstract-class

```
class AbstractQuery {
    virtual bool isCanBeExecuted()=0;
public:
    AbstractQuery() {}
    virtual bool Execute()=0;
};

class DropTableQuery: public AbstractQuery {
    vector< std::pair< string, string> > QueryContent;
    QueryValidate qv;
public:
    explicit DropTableQuery(const string& qr): AbstractQuery(), qv(qr) {}
    bool Execute();
}; 
```

是否有必要在派生类构造函数中调用基构造函数？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-06T22:34:05.277

不，事实上，基类没有必要有一个明确定义的构造函数（尽管确保你有一个虚拟析构函数）。

所以对于一个典型的界面，你可以有这样的东西：

```
class MyInterface {
public:
    virtual ~MyInterface() {}
    virtual void execute() = 0;
}; 
```

编辑：这是你应该有一个虚拟析构函数的原因：

```
MyInterface* iface = GetMeSomeThingThatSupportsInterface();
delete iface; // this is undefined behaviour if MyInterface doesn't have a virtual destructor 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-06T22:54:02.227

除非它有参数，否则**永远不需要**显式调用基类构造函数。编译器会自动调用构造函数。从理论上讲，基类仍然有一个构造函数，但是如果它不做任何事情，编译器可能会将其优化为不存在。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T22:36:24.040

不，不在您提供的示例中。在初始化派生类的任何成员之前，将按照声明基类的相同顺序自动调用基类的默认构造函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-27T14:19:46.490

如果基类的构造函数不需要任何参数，则不需要在派生类中调用它，因为它是作为默认构造函数调用的。但是，即使基类为空，您也需要为基类提供虚拟析构函数。否则编译器将生成一个默认的非虚拟析构函数。

# linux - 是否有任何工具可以检查交叉编译的 .so 文件中的符号？

> ID：270598
> 
> 赞同：4
> 
> 时间：2008-11-06T22:33:46.167
> 
> 标签：linux, cross-platform, shared-libraries, testing, symbols

我有一个应用程序在启动时将 .so 文件加载为插件，使用`dlopen()`

构建环境在 x86 硬件上运行，但应用程序正在针对另一个平台进行交叉编译。

如果我可以（作为自动构建过程的一部分）进行检查以确保 .so 文件和应用程序的组合中没有任何未解析的符号，而无需实际部署应用程序，那就太好了。

在我编写脚本来使用 的输出测试符号之前`nm`，我想知道是否有人知道已经这样做的实用程序？

* * *

编辑1：稍微改变了描述——我不只是试图测试.so中的符号，而是结合几个.so和应用程序本身——即。在应用程序加载所有 .so 之后，是否还会有未解析的符号。

正如答案中所建议的那样（感谢 Martin v. Löwis 和 tgamblin），`nm`将很容易识别单个文件中丢失的符号，但不容易识别在其他加载的模块之一中已解决哪些符号。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T22:37:05.507

理想情况下，cross-nm 工具是您的交叉编译器套件的一部分。例如，如果您构建 GNU binutils 用于交叉编译，则还将提供一个 cross-nm（以及一个 cross-objdump）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T22:45:07.953

您可以为此使用递归版本的 ldd 吗？似乎有人[写了一个](http://www.lysium.de/blog/index.php?/archives/35-Recursive-ldd.html)可能有帮助的脚本。这至少告诉您所有依赖库都可以解析，如果它们首先在 .so 中正确指定。您可以使用链接器选项保证在 .so 中引用所有依赖项，并且这个加上递归 ldd 将保证您没有未解析的符号。

链接器通常可以选择使共享库中未解析的符号成为错误，您可以使用它来完全避免检查。对于 GNU ld，您可以只传递 --no-allow-shlib-undefined 并且保证如果它生成 .so，它不会有未解析的符号。来自 GNU ld 文档：

```
 --no-undefined
       Report  unresolved  symbol  references  from regular object files.
       This is done even if the linker is creating a non-symbolic shared 
       library.  The switch --[no-]allow-shlib-undefined controls the 
       behaviour for reporting  unresolved references found in shared
       libraries being linked in.

   --allow-shlib-undefined
   --no-allow-shlib-undefined
       Allows (the default) or disallows undefined symbols in shared 
       libraries.  This switch is  similar  to  --no-undefined  except
       that  it determines the behaviour when the undefined symbols are
       in a shared library rather than a regular object file.  It does 
       not affect how undefined symbols in regular object files are 
       handled.

       The reason that --allow-shlib-undefined is the default is that the 
       shared library being specified  at  link  time may  not  be  the  
       same as the one that is available at load time, so the symbols might 
       actually be resolvable at load time.  Plus there are some systems, 
       (eg BeOS) where undefined symbols in shared libraries is  normal.   
       (The kernel patches them at load time to select which function is most
       appropriate for the current architecture.  This is used for example to
       dynamically select an appropriate memset function).  Apparently it is 
       also normal for HPPA shared libraries to have undefined symbols. 
```

如果您要进行链接后检查，我同意 Martin 的观点，nm 可能是您最好的选择。我通常只是在输出中用 grep 搜索“U”来检查未解析的符号，所以我认为这将是一个非常简单的脚本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T00:45:19.843

事实证明，这些限制`nm`意味着无法用于全面的符号检查器。特别是，`nm`只会列出导出的符号。

但是，`readelf`将生成一个完整的列表，以及所有库依赖项。

使用`readelf`它可以构建一个脚本，它将：创建所有使用的库的列表，在可执行文件（或 .so）中构建符号列表 构建未解析符号列表 - 如果有任何未解析符号此时，加载时会出现错误。

然后重复此操作，直到找不到新库。

如果对可执行文件和所有`dlopen()`ed .so 文件执行此操作，它将很好地检查运行时遇到的未解决的依赖关系。

# wpf - MouseCapture 防止所有基于鼠标的触发器在 WPF 中触发

> ID：270602
> 
> 赞同：1
> 
> 时间：2008-11-06T22:34:15.107
> 
> 标签：wpf

我在拖放操作期间使用 CaptureMouse() 以确保我不会错过 MouseUp 事件，但这似乎可以防止任何鼠标事件到达我的 Canvas 上的任何其他对象。这意味着我的基于 IsMouseOver 的触发器不起作用，但我需要它们指示可以放置对象的有效位置。

我做错了吗，或者有没有办法确保我的画布上的所有东西仍然得到鼠标事件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-07T01:26:53.137

元素是画布子树的一部分吗？还是画布之外？如果它们在其中，那么您可能可以使用采用[CaptureMode](http://msdn.microsoft.com/en-us/library/system.windows.input.capturemode(VS.85).aspx)的 Capture 方法。

```
Mouse.Capture(elementToCapture, CaptureMode.SubTree); 
```

或者，您应该查看[DragDrop 类](http://msdn.microsoft.com/en-us/library/system.windows.dragdrop_members.aspx)并考虑改用[Drop 事件](http://msdn.microsoft.com/en-us/library/system.windows.dragdrop.dropevent.aspx)？

# web-applications - 在确定项目范围时，我如何捕捉营销功能需求以确保项目成功？

> ID：270603
> 
> 赞同：0
> 
> 时间：2008-11-06T22:34:30.767
> 
> 标签：web-applications, project-management

在有一个营销或销售团队发起的项目的情况下，我们如何才能捕捉到项目可营销甚至更好的自我营销的不那么明显的要求？

在许多情况下，营销/销售团队很难列举项目应该做什么的功能规范，更不用说描述跟踪和改进性能指标的功能了。看到成功的项目后，我仍然认识到不仅需要跟踪项目绩效，还需要积极调整和推广产品。如果没有客户听说或找到交易，那么一套新的交易可以为客户省钱有什么好处？？？

为了解决需求过程中的这一不足（这会变成部署过程中的不足），我一直在考虑做的一件事是将项目范围的一部分用于工程师的分析和推广，而不是营销/销售团队。例如，要考虑推出一款产品，它必须由我们 5% 的客户群在“测试模式”下进行审核，并经过一轮优化/调整。然后，我将在项目范围内包括一个 beta 推广和审查期（除了我们已经包括的 QA 期），创建适当的调查和对该调查的工程审查，然后进行任何调整的最终发布. 我意识到这超出了典型的技术产品经理范围界定项目的范围，

我应该做哪些类型的事情？这可以适用于许多领域的项目，但我工作的领域是 Web 应用程序，因此非常感谢针对该领域的答案。当然，请随时为所有领域提供答案。

更新 - 一个例子：最近我们启动了一个优惠项目，以便用户可以获得我们酒店提供的优惠。在构建交易项目时，我们没有向我们的客户提供交易的 RSS 提要，没有为正在寻找特定交易的人提供警报注册，并且可能错过了其他几个向人们提供所需/需要信息的机会以方便使用的格式。然而，交易功能正是许多人想要的，而当他们来到我们的网站时却错过了。我们对迪斯尼乐园的交易的转化率对于每个看到交易的人来说都很棒，因为我们有如此好的定价和组合，但是看到交易的人数较少，因为他们必须知道交易在那里才能找到它们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T23:00:43.523

尽早制作原型，经常制作原型，并确保让客户查看您的早期版本。

如果您正在使用现有系统，则解决方案的一部分是记录和趋势客户投诉和支持请求。很多时候，这些都是真正的增强请求，或者它们可以指出应用程序的痛苦区域。如果您的开发人员不听这个，他们就错过了重要的客户输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T22:43:49.283

突然想到的一件事是至少在*部分时间派一个技术性的，***不是社交无能**的人与销售人员一起做笔记。

 *他甚至可以在现场进行错误修复，因此不会浪费时间。

此外，请确保您在销售人员离开***后***与客户保持联系，以确保您正在实施他们的要求。

# asp.net - ASP.NET - 在全局资源文件中存储 SQL 查询？

> ID：270611
> 
> 赞同：4
> 
> 时间：2008-11-06T22:37:08.097
> 
> 标签：asp.net, sql

将我的 SQL 查询存储在全局资源文件中而不是将其存储在我的代码隐藏中是个好主意吗？我知道存储过程会是一个更好的解决方案，但我在这个项目上没有那么奢侈。

我不想在我的页面上到处查询，并认为中央存储库会是一个更好的主意。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-07T00:01:42.933

资源文件通常用于本地化。但是一个字符串只是一个字符串只是一个字符串，你真的想将资源文件中的任何旧字符串发送到你的数据库吗？

我完全同意其他人的观点，即您应该使用 linq 或类型化数据集等。就我个人而言，这些年来我只需要使用几次文本查询，而当我这样做时，通常如下所示：

您设置了一个小框架，然后您需要做的就是维护一个 Xml 文件。单个特定的 xml 文件比资源 dll 更易于管理和部署。您还有一个众所周知的地方（存储库），用于存储 Sql 查询和一些关于它们的元数据，而不仅仅是一些命名约定。

永远不要低估（简单）类对字符串文字的效用。一旦你开始使用这个类，你就可以添加一些你不能（容易）用一个简单的字符串做的事情。

* * *

记事本编译器，如果这不是 100%，请道歉。这只是一切如何相互作用的草图。

```
public static class SqlResource
{
    private static Dictionary<string,SqlQuery> dictionary;

    public static void Initialize(string file)
    {
        List<SqlQuery> list;

        // deserialize the xml file
        using (StreamReader streamReader = new StreamReader(file))
        {
            XmlSerializer deserializer = new XmlSerializer(typeof(List<SqlQuery>));
            list = (List<SqlQuery>)deserializer.Deserialize(streamReader);
        }
        dictionary = new Dictionary<string,SqlQuery>();
        foreach(var item in list )
        {
            dictionary.Add(item.Name,item);
        }
    }
    public static SqlQuery GetQueryByName(string name)
    {
        SqlQuery query = dictionary[name];

        if( query == null )
            throw new ArgumentException("The query '" + name + "' is not valid.");

        if( query.IsObsolete )
        {
           // TODO - log this.
        }
        return query;

    }
}

public sealed class SqlQuery
{
    [XmlAttributeAttribute("name")]
    public bool Name { get; set; }

    [XmlElement("Sql")]
    public bool Sql { get; set; }

    [XmlAttributeAttribute("obsolete")]
    public bool IsObsolete { get; set; }

    [XmlIgnore]
    public TimeSpan Timeout { get; set;}

    /// <summary>
    /// Serialization only - XmlSerializer can't serialize normally
    /// </summary>
    [XmlAttribute("timeout")]
    public string Timeout_String 
    {
        get { return Timeout.ToString();  }
        set { Timeout = TimeSpan.Parse(value); } 
    }
} 
```

您的 xml 文件可能看起来像

```
<?xml version="1.0" encoding="utf-8"?>
<ArrayOfSqlQuery xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <SqlQuery name="EmployeeByEmployeeID" timeout="00:00:30" >
      <Sql>
SELECT * From Employee WHERE EmployeeID = @T0     
      </Sql>
    </SqlQuery>
    <SqlQuery name="EmployeesForManager" timeout="00:05:00" obsolete="true" >
      <Sql>
SELECT * From Employee WHERE ManagerID = @T0      
      </Sql>
    </SqlQuery>
</ArrayOfSqlQuery> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T22:40:21.927

我会使用 tableadapter 查找强类型数据集，并让 tableadapter 处理所有查询。当您使用它时，您将永远不会回头。

只需将一个数据集添加到您的解决方案中，添加一个连接和一个表适配器，然后开始构建所有查询（更新、选择、删除、搜索等）并在后面的代码中轻松处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T22:58:35.430

好的，我会尝试再次回答，现在当我有更多信息时。

我会创建一个查询类，将所有查询字符串保存为共享属性或函数，这些属性或函数可以很好地命名以便于使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T23:06:36.070

我与一些开发人员的情况相同，他们更喜欢在资源文件中编写查询。我们正在使用亚音速，我更喜欢使用存储过程而不是使用直接查询。

一种选择，即使它很糟糕，也将这些查询放在配置文件中并在需要时读取，但这是一个非常糟糕的选择，如果每个人都不能同意使用存储过程，我们可能会使用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-06-03T00:37:27.060

您也可以使用 XML 配置文件将名称与存储过程相关联。我正在为当前的 C# 项目这样做。“查询”将定义要调用的过程。

由于某些数据库引擎不支持存储查询，这并不总是一种选择。

有时对于小型项目，可以使用参数化的 SQL 查询（不要连接字符串）。对于 select 语句尤其如此。

视图也可用于选择而不是存储过程。

抢

# javascript - 滚动到div的底部？

> ID：270612
> 
> 赞同：967
> 
> 时间：2008-11-06T22:37:30.420
> 
> 标签：javascript, html, ajax, chat

我正在使用 Ajax 请求创建聊天，并且试图让消息 div 滚动到底部，但运气不佳。

我将所有内容都包装在这个 div 中：

```
#scroll {
    height:400px;
    overflow:scroll;
} 
```

有没有办法使用JS默认滚动到底部？

ajax请求后有没有办法让它滚动到底部？

* * *

## 回答 #1

> 赞同：1594
> 
> 时间：2008-11-06T22:42:51.563

这是我在我的网站上使用的：

```
var objDiv = document.getElementById("your_div");
objDiv.scrollTop = objDiv.scrollHeight; 
```

* * *

## 回答 #2

> 赞同：379
> 
> 时间：2010-04-19T02:17:04.453

如果您使用[jQuery scrollTop](https://api.jquery.com/scrollTop/) ，这会容易得多：

```
$("#mydiv").scrollTop($("#mydiv")[0].scrollHeight); 
```

* * *

## 回答 #3

> 赞同：154
> 
> 时间：2015-10-18T02:27:50.817

你可以试试下面的代码：

```
function scrollToBottom (id) {
   var div = document.getElementById(id);
   div.scrollTop = div.scrollHeight - div.clientHeight;
} 
```

要使用 JQuery执行**平滑滚动：**

```
function scrollSmoothToBottom (id) {
   var div = document.getElementById(id);
   $('#' + id).animate({
      scrollTop: div.scrollHeight - div.clientHeight
   }, 500);
} 
```

请参阅[JSFiddle](https://jsfiddle.net/L56wxhqm/10/)上的**示例**

这就是为什么它有效：

[![在此处输入图像描述](https://i.stack.imgur.com/IC85R.png)](https://jsfiddle.net/L56wxhqm/10/)

参考：[scrollTop](https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollTop) , [scrollHeight](https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollHeight) , [clientHeight](https://developer.mozilla.org/en-US/docs/Web/API/Element/clientHeight)

* * *

## 回答 #4

> 赞同：96
> 
> 时间：2012-09-12T15:00:45.017

使用[jQuery 动画](http://api.jquery.com/animate)：

```
$('#DebugContainer').stop().animate({
  scrollTop: $('#DebugContainer')[0].scrollHeight
}, 800); 
```

* * *

## 回答 #5

> 赞同：56
> 
> 时间：2014-10-10T07:08:29.657

[适用于所有当前浏览器](https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollIntoView)的较新方法：

```
this.scrollIntoView(false); 
```

* * *

## 回答 #6

> 赞同：38
> 
> 时间：2014-01-10T15:53:49.233

```
var mydiv = $("#scroll");
mydiv.scrollTop(mydiv.prop("scrollHeight")); 
```

从 jQuery 1.6 开始工作

[https://api.jquery.com/scrollTop/](https://api.jquery.com/scrollTop/)

[http://api.jquery.com/prop/](http://api.jquery.com/prop/)

* * *

## 回答 #7

> 赞同：25
> 
> 时间：2019-04-29T11:57:57.560

**使用 Javascript**平滑滚动：****

 **`document.getElementById('messages').scrollIntoView({ behavior: 'smooth', block: 'end' });`

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2014-06-10T10:58:00.927

如果您不想依赖`scrollHeight`，以下代码会有所帮助：

```
$('#scroll').scrollTop(1000000); 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2017-10-24T16:25:50.843

Java 脚本：

`document.getElementById('messages').scrollIntoView(false);`

滚动到当前内容的最后一行。

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2020-12-19T15:06:01.203

替代解决方案

```
function scrollToBottom(element) {
  element.scroll({ top: element.scrollHeight, behavior: 'smooth' });
} 
```

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2020-05-10T18:46:59.077

我的场景：我有一个字符串列表，我必须在其中附加用户给出的字符串并自动滚动到列表的末尾。我已经固定了列表显示的高度，之后它应该溢出。

我尝试了@Jeremy Ruten 的答案，它有效，但它正在滚动到第 (n-1) 个元素。如果有人遇到此类问题，您可以使用`setTimeOut()`方法解决方法。您需要将代码修改为以下内容：

```
setTimeout(() => {
    var objDiv = document.getElementById('div_id');
    objDiv.scrollTop = objDiv.scrollHeight
}, 0) 
```

这是我创建的 StcakBlitz 链接，它显示了问题及其解决方案：[https ://stackblitz.com/edit/angular-ivy-x9esw8](https://stackblitz.com/edit/angular-ivy-x9esw8)

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2020-03-09T18:58:33.783

您可以像这样使用 HTML DOM scrollIntoView 方法：

```
var element = document.getElementById("scroll");
element.scrollIntoView(); 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2016-07-18T18:44:25.770

Javascript 或 jquery：

```
var scroll = document.getElementById('messages');
   scroll.scrollTop = scroll.scrollHeight;
   scroll.animate({scrollTop: scroll.scrollHeight}); 
```

CSS：

```
 .messages
 {
      height: 100%;
      overflow: auto;
  } 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2014-11-19T19:40:17.590

使用 jQuery，[scrollTop](http://api.jquery.com/scrolltop/)用于为任何给定元素设置 scollbar 的垂直位置。还有一个不错的[jquery scrollTo 插件](https://github.com/flesler/jquery.scrollTo)，用于滚动动画和不同的选项（[演示](http://demos.flesler.com/jquery/scrollTo/)）

```
var myDiv = $("#div_id").get(0);
myDiv.scrollTop = myDiv.scrollHeight; 
```

如果您想在向下滚动时使用[jQuery 的 animate 方法添加动画，请检查以下代码段：](http://api.jquery.com/animate/)

```
var myDiv = $("#div_id").get(0);
myDiv.animate({
    scrollTop: myDiv.scrollHeight
  }, 500); 
```

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2015-09-15T17:56:21.757

发现这真的很有帮助，谢谢。

对于 Angular 1.X 的人来说：

```
angular.module('myApp').controller('myController', ['$scope', '$document',
  function($scope, $document) {

    var overflowScrollElement = $document[0].getElementById('your_overflow_scroll_div');
    overflowScrollElement[0].scrollTop = overflowScrollElement[0].scrollHeight;

  }
]); 
```

仅仅因为 jQuery 元素与 HTML DOM 元素的包装与 angular 有点混淆。

同样对于聊天应用程序，我发现在您的聊天加载后进行此分配很有用，您可能还需要在短暂的超时时间上拍打。

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2015-10-09T06:59:16.400

我遇到了同样的问题，但有一个额外的限制：我无法控制将新元素附加到滚动容器的代码。我在这里找到的所有示例都不允许我这样做。这是我最终得到的解决方案。

它使用`Mutation Observers`（[https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver](https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver)）使其仅可在现代浏览器上使用（尽管存在 polyfills）

所以基本上代码就是这样做的：

```
var scrollContainer = document.getElementById("myId");

// Define the Mutation Observer
var observer = new MutationObserver(function(mutations) {

  // Compute sum of the heights of added Nodes
  var newNodesHeight = mutations.reduce(function(sum, mutation) {
      return sum + [].slice.call(mutation.addedNodes)
        .map(function (node) { return node.scrollHeight || 0; })
        .reduce(function(sum, height) {return sum + height});
  }, 0);

  // Scroll to bottom if it was already scrolled to bottom
  if (scrollContainer.clientHeight + scrollContainer.scrollTop + newNodesHeight + 10 >= scrollContainer.scrollHeight) {
    scrollContainer.scrollTop = scrollContainer.scrollHeight;
  }

});

// Observe the DOM Element
observer.observe(scrollContainer, {childList: true}); 
```

我做了一个小提琴来演示这个概念： [https ://jsfiddle.net/j17r4bnk/](https://jsfiddle.net/j17r4bnk/)

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2014-07-03T13:58:01.920

小附录：仅滚动，如果最后一行已经可见。如果滚动一点点，则将内容留在原处（注意：未使用不同的字体大小进行测试。这可能需要在“>=比较”中进行一些调整）：

```
var objDiv = document.getElementById(id);
var doScroll=objDiv.scrollTop>=(objDiv.scrollHeight-objDiv.clientHeight);                   

// add new content to div
$('#' + id ).append("new line at end<br>"); // this is jquery!

// doScroll is true, if we the bottom line is already visible
if( doScroll) objDiv.scrollTop = objDiv.scrollHeight; 
```

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2014-08-21T12:41:38.643

就像一个奖励片段。当用户选择与用户的不同对话时，我正在使用 angular 并试图将消息线程滚动到底部。为了确保在使用 ng-repeat for messages 将新数据加载到 div 后滚动正常工作，只需将滚动片段包装在超时中即可。

```
$timeout(function(){
    var messageThread = document.getElementById('message-thread-div-id');
    messageThread.scrollTop = messageThread.scrollHeight;
},0) 
```

这将确保在将数据插入 DOM 后触发滚动事件。

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2015-08-13T03:41:29.733

这将让您在文档高度方面一直向下滚动

```
$('html, body').animate({scrollTop:$(document).height()}, 1000); 
```

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2015-10-28T18:17:07.380

您还可以使用 jQuery，`html,body`通过以下方式将动画附加到文档：

`$("html,body").animate({scrollTop:$("#div-id")[0].offsetTop}, 1000);`

这将导致平滑滚动到 id 为“div-id”的 div 的顶部。

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2020-07-08T07:48:43.113

和你一样，我正在构建一个聊天应用程序，并希望滚动查看最新消息。这最终对我很有效：

```
//get the div that contains all the messages
let div = document.getElementById('message-container');

//make the last element (a message) to scroll into view, smoothly!
div.lastElementChild.scrollIntoView({ behavior: 'smooth' }); 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2017-10-26T15:56:16.670

一个非常简单的方法是将 设置为`scroll to`div 的高度。

```
var myDiv = document.getElementById("myDiv");
window.scrollTo(0, myDiv.innerHeight); 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2019-02-03T08:50:22.637

滚动到 div 内的最后一个元素：

```
myDiv.scrollTop = myDiv.lastChild.offsetTop 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2020-02-17T00:21:16.930

在我的 Angular 6 应用程序中，我只是这样做了：

```
postMessage() {
  // post functions here
  let history = document.getElementById('history')
  let interval    
  interval = setInterval(function() {
    history.scrollTop = history.scrollHeight
    clearInterval(interval)
  }, 1)
} 
```

clearInterval(interval) 函数将停止计时器以允许手动滚动顶部/底部。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2020-11-05T17:02:19.490

您可以使用[Element.scrollTo()](https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollTo)方法。

它可以使用内置的浏览器/操作系统动画进行动画处理，因此非常流畅。

```
function scrollToBottom() {
    const scrollContainer = document.getElementById('container');
    scrollContainer.scrollTo({
        top: scrollContainer.scrollHeight,
        left: 0,
        behavior: 'smooth'
    });
}

// initialize dummy content
const scrollContainer = document.getElementById('container');
const numCards = 100;
let contentInnerHtml = '';
for (let i=0; i<numCards; i++) {
  contentInnerHtml += `<div class="card mb-2"><div class="card-body">Card ${i + 1}</div></div>`;
}
scrollContainer.innerHTML = contentInnerHtml;
```

```
.overflow-y-scroll {
  overflow-y: scroll;
}
```

```
<link href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" rel="stylesheet"/>

<div class="d-flex flex-column vh-100">
  <div id="container" class="overflow-y-scroll flex-grow-1"></div>
  <div>
    <button class="btn btn-primary" onclick="scrollToBottom()">Scroll to bottom</button>
  </div>
</div>
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2016-12-12T20:09:43.610

我知道这是一个老问题，但这些解决方案都不适合我。我最终使用 offset().top 来获得所需的结果。这是我用来轻轻地将**屏幕向下滚动**到聊天应用程序中的最后一条消息的内容：

```
$("#html, body").stop().animate({
     scrollTop: $("#last-message").offset().top
}, 2000); 
```

我希望这对其他人有帮助。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2020-10-06T17:11:13.460

我使用第一个项目 div 的 Y 坐标和所选项目 div 的 Y 坐标之间的差异。这是 JavaScript/JQuery 代码和 html：

```
function scrollTo(event){
        // In my proof of concept, I had a few <button>s with value 
        // attributes containing strings with id selector expressions
        // like "#item1".
        let selectItem = $($(event.target).attr('value'));
        let selectedDivTop = selectItem.offset().top;

        let scrollingDiv = selectItem.parent();

        let firstItem = scrollingDiv.children('div').first();
        let firstItemTop = firstItem.offset().top;

        let newScrollValue = selectedDivTop - firstItemTop;
        scrollingDiv.scrollTop(newScrollValue);
    }
```

```
<div id="scrolling" style="height: 2rem; overflow-y: scroll">
  <div id="item1">One</div>
  <div id="item2">Two</div>
  <div id="item3">Three</div>
  <div id="item4">Four</div>
  <div id="item5">Five</div>
</div>
```

* * *

## 回答 #28

> 赞同：-1
> 
> 时间：2019-10-03T12:52:31.593

如果这样做是为了滚动到聊天窗口的底部，请执行以下操作

在聊天中滚动到特定 div 的想法如下

1) 每个由 Person、time 和 message 组成的聊天 div 都在一个 for 循环中运行，其中包含 chatContentbox 类

2) querySelectorAll 找到所有这样的数组。可能是 400 个节点（400 个聊天）

3) 转到最后一个

4) 滚动视图()

```
let lastChatBox = document.querySelectorAll('.chatContentBox'); 
lastChatBox = lastChatBox[lastChatBox.length-1]; 
lastChatBox.scrollIntoView(); 
```

* * *

## 回答 #29

> 赞同：-1
> 
> 时间：2021-07-30T04:24:27.560

仅限 CSS：

```
.scroll-container {
  overflow-anchor: none;
} 
```

使其在添加子元素时滚动条不会停留在顶部。例如，在聊天底部添加新消息时，将聊天滚动到新消息。

* * *

## 回答 #30

> 赞同：-2
> 
> 时间：2019-07-04T04:56:55.143

采用 ：

```
var element= $('element');
var maxScrollTop = element[0].scrollHeight - element.outerHeight();
element.scrollTop(maxScrollTop); 
```

或检查滚动到底部：

```
 var element = $(element);
    var maxScrollTop = element[0].scrollHeight - element.outerHeight();
    element.on('scroll', function() {
        if ( element.scrollTop() >= maxScrollTop ) {
            alert('scroll to bottom');
        }
    }); 
```

* * *

## 回答 #31

> 赞同：-2
> 
> 时间：2020-02-06T22:37:36.293

将距可滚动元素顶部的距离设置为元素的总高度。

```
const element = this.shadowRoot.getElementById('my-scrollable-div')
element.scrollTop = element.scrollHeight 
```

* * *

## 回答 #32

> 赞同：-3
> 
> 时间：2020-01-05T22:00:53.627

有时最简单的就是最好的解决方案：我不知道这是否有帮助，它帮助我滚动它也是我想要的。“y=”越高，向下滚动的越多，当然“0”表示顶部，因此例如“1000”可能是底部，或者“2000”或“3000”等等，具体取决于您的多长时间页是。这通常适用于带有 onclick 或 onmouseover 的按钮。

```
window.scrollTo(x=0,y=150); 
```

# .net - 在 vb6 中使用 .NET COM

> ID：270613
> 
> 赞同：4
> 
> 时间：2008-11-06T22:37:31.463
> 
> 标签：.net, com, vb6

我在 vb6 中使用 .NET COM 时遇到问题，它编译正常，我使用 regasm 注册它，在 vb6 项目中添加对它的引用，它甚至有智能感知。但是当我尝试创建一个实例时，它给了我一个“自动化错误”。任何人都可以帮忙吗？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T22:46:43.020

您可能需要确保您的 .NET 程序集位于 VB6 应用程序的目录中，或者如果在 VB6 IDE 中调试，它们位于 VB6.exe 的目录中。

可以使 COM 与 .NET 程序集的互操作工作更像 COM dll（请参阅[regasm](http://msdn.microsoft.com/en-us/library/tzat5yw6(VS.71).aspx)的代码库选项），但默认情况下，会以通常的方式搜索 .NET 程序集 - 即在 GAC 或应用程序目录中 - 即使在使用时也是如此通过 COM 互操作。

[使用 sysinternals filemon](http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx)实用程序来深入了解程序集的位置的一个非常简单的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T20:44:35.057

我认为您必须以某种方式编译 .Net 项目以供 COM 对象使用。并且 .Net dll 需要与调用它们的 COM 对象在同一目录中（如果它们占据相同的空间，我认为）。

项目属性页\配置属性\构建\注册 COM 互操作 = true

# .net - .Net 3.5 Windows 窗体应用程序：64 位 Vista 上的 x86 与 x64 加载时间

> ID：270614
> 
> 赞同：3
> 
> 时间：2008-11-06T22:37:56.503
> 
> 标签：.net, windows, winforms, windows-vista, 64-bit

我们正在开发一个 Winforms 应用程序，并正在优化启动时间。

该应用程序在 64 位 Vista 机器上运行。在我们的测试中，我们发现了一个看似反直觉的结果。在其他条件相同的情况下，目标 32 位和 64 位加载的时间减半。任何人都可以解释为什么？

谢谢。

[编辑] 我们通过 ClickOnce 部署应用程序，根据我们的研究，它在一个独特的沙箱中启动应用程序。因此它总是冷启动，因此在这里寻求提高性能是徒劳的。

我们的主要问题是项目中存在 32 位 dll。一旦我们将项目定位在 x86（即使它在 x64 上运行），加载时间就会减少一半。[/编辑]

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-07T21:00:18.650

通过不再验证来自受信任位置的程序集的强名称，.NET 3.5 SP1 获得了改进的启动性能。在我的书中有点争议，但有点站得住脚。

我确实检查了 64 位版本的 CLR 是否也绕过了那个耗时的步骤。签署一个 DLL，将其放入 GAC，然后修补一个字节。加载组件时没有投诉。因此，解释差异的不是 SP1 启动首选项的改进。

启动时间中的其他因素是： - 从磁盘加载 CLR（仅限冷启动） - 依赖程序集的 Groveling - JIT 编译启动代码

冷启动很可能是一个因素，您可能没有运行其他加载了 64 位版本的 CLR 的进程。通过在进行测试时运行虚拟 .NET 应用程序可以轻松消除。

Groveling assemblies could take longer for the same reason. It is unlikely that the 64-bit ngen-ed images of the .NET assemblies are in the file system cache. Again, easy to eliminate with the dummy app having a dependency on the same assemblies.

The 64-bit JITter is a tougher nut to crack. An arbitrary call is to assume that MSFT didn't spend as much time making that one performant as the 32-bit JITter. Nothing backed-up by any evidence though. Difficult to measure too, you'd have load an assembly with Assembly.Load, then time Activator.CreateInstance() where the class constructor calls as much code as possible.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T22:42:20.457

64 位版本通常会在堆上使用两倍的内存：每个指针占用两倍的空间，而 .NET 充满了指针。由于启动受内存初始化的影响很大，这可能是额外开销的一部分。另请参阅[Donald Knuth 关于 64 位指针的火焰](http://www-cs-faculty.stanford.edu/~knuth/news08.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T03:27:51.503

请注意，根据 Microsoft 的说法，.Net 3.5 SP1 在启动性能方面做了相当多的工作（某些应用程序提高了 40%），因此您可能会看到这是否也有帮助。

# javascript - 如何在 C++ 中构建可以使用 Javascript 编写脚本的 ActiveX 对象

> ID：270623
> 
> 赞同：0
> 
> 时间：2008-11-06T22:41:05.590
> 
> 标签：javascript, c++, com, interop, activex

我可以使用 VS08 的 MFC/ActiveX 模板来创建一个 C++ ActiveX 对象，我可以将其加载到 HTML 页面中并使用 Javascript 编写脚本。但我不知道如何创建一个接口，允许我使用 Javascript 在我的组件上调用自定义方法。

你能告诉我如何做到这一点吗？我在谷歌上花了两个多小时没有运气。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T23:14:56.117

我对 MFC ActiveX 包装器不是很熟悉，但我可以从一般意义上回答这个问题：

可以通过自动化语言（例如：Javascript）调用具有从 IDispatch 派生的接口的 COM 对象。这些方法还必须是“自动化兼容的”，这意味着参数可以转换为 VARIANT 类型，或者显式地属于 VARIANT 类型。请注意，对于输入/输出参数，类型必须为 VARIANT*，自动化“连接”才能工作。

我不知道如何使 ActiveX 对象在客户端脚本中可访问（例如：将其嵌入到页面中），但如果它具有从 IDispatch 派生的单个接口，则可以从 Javascript（和其他自动化语言）调用它。我希望这会有所帮助...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T12:02:18.553

这适用于将 ActiveX 容器嵌入 html 页面并调用方法：

```
<html> 
<body> 
<object height="0" width="0" id="myControl" classid="CLSID:AC12D6F8-AEB7-4935-B3C9-0E4FB6CF7FB1" type="application/x-oleobject">
</object>
<script>
    var activexObj = document.getElementById('myControl');
    if(activexObj != null)
    {
        var result = myControl.myMethod();
        document.write("Result: " + result + "<br/>");
    }
    else
    {
        document.write("ActiveX component not found!<br/>");
    }
</script>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T00:00:12.497

如果您使用的是 VS08 MFC ActiveX 模板，您可能会在控件的 .h 文件中看到类似这样的片段（在类声明中，它是受保护的）：

```
afx_msg void AboutBox();

DECLARE_DISPATCH_MAP() 
```

在 .cpp 文件中是这样的：

```
// Dispatch map

BEGIN_DISPATCH_MAP(CActiveXOutlookCtrl, COleControl)
    DISP_FUNCTION_ID(yourCtrl, "AboutBox", DISPID_ABOUTBOX, AboutBox, VT_EMPTY, VTS_NONE)
END_DISPATCH_MAP() 
```

我从来没有使用过这个，但这是你的调度接口——也就是你的对象上的方法，其他人可以调用。这是什么意思：

*   “AboutBox”是他们用来称呼它的名称。
*   DISPID_ABOUTBOX 是函数的整数 id（我认为它是任意的。我会使用正数，因为默认情况下会采用很多负数）。
*   AboutBox 是方法名称。
*   VT_EMPTY 是方法的返回类型。
*   VTS_NONE 是它采用的参数类型。

不过，还有 DECLARE_MESSAGE_MAP() 和 DECLARE_EVENT_MAP()，这也可能是您想要的。

# c# - 具有完整集成的 3rd 方密码管理

> ID：270625
> 
> 赞同：0
> 
> 时间：2008-11-06T22:41:28.913
> 
> 标签：c#, asp.net, sql-server, iis, passwords

我使用 C#、IIS、ASP.NET、SQL Server。

是否有可以轻松集成到我的系统中的第三方平台来处理密码管理？

它必须 100% 集成（没有 OpenID），这样用户就不会注意到。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T22:54:11.307

ASP.NET 实际上有一些用于登录和密码管理的内置功能：[登录工具箱控件](http://msdn.microsoft.com/en-us/library/tz6e5ezc.aspx)。功能集不是很大，但它涵盖了所有基础知识：注册、更改密码和恢复密码。

# windows - 在锁定或解锁 Windows XP 时运行脚本

> ID：270629
> 
> 赞同：7
> 
> 时间：2008-11-06T22:43:23.277
> 
> 标签：windows, hook, locking, scripting

我有一台 Windows XP 机器和一台运行 Ubuntu 的 Linux 机器。[我通过Synergy](http://synergy2.sourceforge.net/)从 Windows 机器共享键盘/鼠标。我想做的是在我锁定/解锁 Windows 机器时锁定/解锁 Linux 机器。

所以我希望能够在 Windows 锁定或解锁屏幕时运行一些描述的脚本。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-06T23:14:02.450

Windows 中的标准方法是[编写一个](http://msdn.microsoft.com/en-us/library/aa374783.aspx)订阅[Winlogon 通知事件](http://msdn.microsoft.com/en-us/library/aa380544.aspx)的包（一个*dll* ） 。

我不知道有任何工具可以提供一种简单的方法来挂钩这些事件，但是如果你真的需要你的动作在一个特定的地方，你可以让你的包从某个特定的地方启动一个脚本。

# c# - 在 C# 中使用列表

> ID：270630
> 
> 赞同：3
> 
> 时间：2008-11-06T22:43:24.807
> 
> 标签：c#, .net, list, stl, arraylist

我是一名高级软件工程专业的学生，​​目前正在学习数据结构和算法课程。我们的教授希望我们使用 C++ STL 中的 List 结构编写程序。我一直在尝试越来越多地使用 C#，并且想知道 .NET 中的 ArrayList 结构是否可以很好地替代 STL List 实现。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-06T22:47:54.923

除非您坚持使用 .NET 1.1，否则请使用`List<T>`而不是`ArrayList`. 但你最关心的是什么？假设您没有要引用的 List - 您需要适当的数据结构来做什么？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T22:45:49.857

你应该能够自己回答这个问题。STL 列表中使用的实施策略是什么？ArrayList 是什么？同样，STL 列表提供的抽象 API 是什么（就提供的操作而言）？将此与 STL 列表进行比较：一个提供了另一个没有提供的内容？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T22:46:38.513

如果 STL List 使用模板，您可能需要查看 System.Collections.Generic 中的通用 List 类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T22:48:10.787

ArrayList 类在某种程度上已被弃用。它来自.NET 1.0 时代，当时还没有泛型。

您应该改用 System.Collections.Generic.List。像这样：

```
List<int> myList = new List<int>();
myList.Add(1);
myList.Add(2);
System.Console.WriteLine(myList[0]); 
```

是的，它们都是很好的替代品。不过，您应该使用通用 List，因为它是类型安全的并且可能更快。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T22:48:35.747

嗯，C++ STL 没有名为“List”的结构。我认为有一个“列表”，它是一个链表。相比之下，C# 的 List 类似于 C++ 的向量。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T23:47:57.233

谢谢大家

quertie，我打错了，意思是列表而不是列表...

任务是使用 std::list 使用简单结构列表添加多项式，该结构将保存系数和 x 的幂......我知道，这很容易，但由于该类据说与语言无关，我想尝试使用 c#

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-11-06T22:48:43.267

与 std::list 最接近的 C# 类似物是 System.Collections.List。两者都是通用集合，并实现标准列表类型的操作。

# layout - 表示用于打印的宽网格的最佳方式？

> ID：270633
> 
> 赞同：0
> 
> 时间：2008-11-06T22:45:16.673
> 
> 标签：layout, printing, grid

我们有许多 WIDE html 网格，它们在我们的 Web 应用程序的 DIV 中水平滚动。

我想找到在纵向 A4 页面上打印这些网格的最佳策略。

我想知道的是呈现/显示这样的网格/数据的最佳方式是什么。

这个问题不是 HTML 特定的，我正在寻找设计策略而不是 CSS @page 指令。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-15T17:27:14.043

实际上有一整本书（除其他外）专门用于计算 \pi 的快速方法：“Pi 和 AGM”，作者 Jonathan 和 Peter Borwein（可在亚马逊上获得）。

我对 AGM 和相关算法进行了相当多的研究：这很有趣（尽管有时并不简单）。

请注意，要实现大多数现代算法来计算 \pi，您将需要一个多精度算术库（GMP 是一个不错的选择，尽管我上次使用它已经有一段时间了）。

最佳算法的时间复杂度为 O(M(n)log(n))，其中 M(n) 是两个 n 位整数相乘的时间复杂度（M(n)=O(n log(n) log(log(n))) 使用基于 FFT 的算法，通常在计算 \pi 的数字时需要，这种算法在 GMP 中实现）。

请注意，尽管算法背后的数学可能并不简单，但算法本身通常是几行伪代码，并且它们的实现通常非常简单（如果您选择不编写自己的多精度算术:-)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T01:22:53.457

我想这真的取决于你的目的是什么。

*   **以书本形式**：我通常尝试跨越两个对开的页面。
*   **对于会议或海报**：找一台超宽的打印机并将其打印在一张大纸上。
*   **更非正式的东西**：跨越常规页面并将它们粘在一起。
*   **Powerpoint**：不要显示整个图表，他们无论如何都无法阅读细节，只显示相关信息。

# pdf - 有没有办法在 PDF 文件中使用自定义字体？

> ID：270635
> 
> 赞同：3
> 
> 时间：2008-11-06T22:46:08.763
> 
> 标签：pdf, fonts

好吧，基本上我将在 12 月中旬完成学业，所以我只是在复习我的简历，我想知道是否有办法在 PDF 文件中使用自定义字体（在本例中为 Calibri 和 Cambria）并使其正确呈现所有电脑。

提前致谢！

**编辑：**我正在使用 MS Word 2007，但愿意接受建议

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-06T22:50:57.023

PDF 不像其他文档那样存储文本和字体，它们实际上将字体转换为矢量，这样无论您使用什么字体，文档都会完全按照预期显示。这就是为什么在 PDF 中搜索文本对于第 3 方 PDF 阅读器来说是一个如此大的问题，以及为什么甚至 Adob​​e 自己也使用分发 2 个版本的 Acrobat（一个带有文本搜索，一个没有）。

要记住的另一件事是，PDF 不是像素精确的，而是比例精确的。PDF 阅读器通常不使用 100% 的缩放级别，而是大多数人以“适合屏幕”或“适合页面”的方式阅读它们。我指出这一点是因为我猜测您尝试使用这些新的 Vista/Office 2007 字体的原因是因为它们支持 LCD 子像素（提高了 LCD 屏幕上的可读性）。此功能不会转换为 PDF，因为字母会变成矢量，亚像素信息会丢失，即使不是，也会变得无用，因为矢量的大小将与您在查看时预期的不同。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T22:50:56.570

如果字体已被其创建者标记为可嵌入，则 PDF 格式能够嵌入字体。您必须检查创建 PDF 的软件，以查看它是否具有该功能以及如何启用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T15:33:56.267

从理论上讲，在技术方面，关于字体的嵌入/不嵌入能力是通过字体文件中的特殊标志（ttf或opentype或type1）来确定的

您可以使用任何字体**编辑器**程序查看这个特殊的嵌入标志（我推荐

**FontCreator** (by High-logic)

*   [http://www.high-logic.com/font-editor/fontcreator.html](http://www.high-logic.com/font-editor/fontcreator.html)

免费试用完全可操作且无限制

您也可以更改嵌入/不嵌入标志，但从法律上讲，对于商业发行的 99% 字体，这会破坏字体的许可

# .net - .NET Compact Framework 可执行文件删除自身的最佳方式是什么？

> ID：270640
> 
> 赞同：1
> 
> 时间：2008-11-06T22:47:47.090
> 
> 标签：.net, windows-mobile, compact-framework

我希望我的 .NET Compact Framework 应用程序在完成执行后自行删除。最好的方法是什么？

在 Windows 机器上，可以使用 .bat 文件来执行此操作，但在移动设备上这不是一个选项。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-07T01:13:18.717

在 Windows Mobile 中有目录：

\应用程序数据\易失性

只要设备有电，该目录就会一直保存。

所以我们要做的是：

1.  将 exe 复制到此目录或子目录（我通常使用子目录以确保我们不会与其他应用程序冲突）。
2.  从此目录运行exe。
3.  删除你想要的文件。
4.  （可选）软复位。

为了与所有设备兼容，您应该使用带有 CSIDL_APPDATA 的“SHGetSpecialFolderPath”函数来获取应用程序数据目录并将“\volatile”附加到它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T23:43:52.767

一个想法是你可以使用 wceload：

[http://msdn.microsoft.com/en-us/library/bb158700.aspx](http://msdn.microsoft.com/en-us/library/bb158700.aspx)

编写一个包含自定义步骤的 cab 文件（我认为您可能需要创建一个 setup.dll），该步骤将删除您的应用程序。

让您的应用程序在退出以运行此 cab 时调用 wceload，传递 wce load 的参数以在完成运行后删除 cab。

我知道不是很光滑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T23:44:54.573

编写您自己的 deleter.exe 程序并运行它以删除您的主 exe，但您必须将其留在设备上……除非您的设备有一个您可以从中运行 deleter.exe 的 ram 驱动器，否则它会重启后消失。

# python - Tkinter：在主循环中调用事件

> ID：270648
> 
> 赞同：19
> 
> 时间：2008-11-06T22:49:44.530
> 
> 标签：python, user-interface, communication, tkinter

您如何`event`从单独的对象调用 tkinter？

我正在寻找类似 wxWidgets 的东西`wx.CallAfter`。例如，如果我创建一个对象，并将我的`Tk`根实例传递给它，然后尝试从我的对象调用该根窗口的方法，我的应用程序就会锁定。

我能想到的最好的办法是使用该`after`方法并从我的单独对象中检查状态，但这似乎很浪费。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-11-09T16:26:28.640

要回答“如何从单独的对象调用 TkInter 事件”的具体问题，请使用该`event_generate`命令。它允许您将事件注入根窗口的事件队列。结合 Tk 强大的虚拟事件机制，它变成了一种方便的消息传递机制。

例如：

```
from tkinter import *

def doFoo(*args):
    print("Hello, world")

root = Tk()
root.bind("<<Foo>>", doFoo)

# some time later, inject the "<<Foo>>" virtual event at the
# tail of the event queue
root.event_generate("<<Foo>>", when="tail") 
```

请注意，`event_generate`调用将立即返回。目前尚不清楚这是否是您想要的。一般来说，您不希望基于事件的程序阻塞等待对特定事件的响应，因为它会*冻结 GUI*。

我不确定这是否能解决您的问题；没有看到你的代码，我不确定你真正的问题是什么。例如，我可以在传入根的对象的构造函数中访问根的方法，而不会锁定应用程序。这告诉我你的代码中还有其他事情发生。

这是从其他对象成功访问根窗口上的方法的示例：

```
from tkinter import *

class myClass:
    def __init__(self, root):
        print("root background is %s" % root.cget("background"))

root = Tk()
newObj = myClass(root) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-04-21T19:25:28.033

下面只是一些文档和链接，以更好地理解上面布莱恩的回答。

[New Mexico Tech](https://web.archive.org/web/20190527174904/http://infohost.nmt.edu:80/tcc/help/pubs/tkinter/web/universal.html)的功能说明：

`w.event_generate(sequence, **kw)`

> 此方法导致事件在没有任何外部刺激的情况下触发。对事件的处理与由外部刺激触发一样。序列参数描述要触发的事件。您可以通过提供关键字=值参数来设置事件对象中选定字段的值，其中关键字指定事件对象中字段的名称。

tcl/tk 事件属性的列表和描述[here](https://www.tcl.tk/man/tcl/TkCmd/event.htm)

# logging - 您遵循哪些准则来编写良好的日志记录语句

> ID：270651
> 
> 赞同：24
> 
> 时间：2008-11-06T22:50:54.433
> 
> 标签：logging

我最近在我的项目代码库中发现了一条日志语句，上面写着“我在这里使用搜索参数==>===========11/30/2008===1====00:00 AM "

对于在应用程序中编写良好的日志消息，您遵循哪些准则？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-06T23:42:29.540

'log' 语句看起来更像是一个跟踪语句。

日志记录：显示正常事件和错误

跟踪：显示执行路径以及所有日志记录事件

就个人而言，我希望通过日志记录来了解我的程序已经完成了哪些工作，并且我希望跟踪语句来验证执行路径并找出问题所在。我会将跟踪语句路由到一个单独的文件，该文件包含两种类型的上下文日志消息。

因此，您至少应该有 2 个日志级别，并且能够关闭跟踪以提高性能。您应该能够将这些事件流路由到不同的位置。这使您可以轻松地保留历史记录的日志，同时不会让它们与您只想用于跟踪问题的调试信息混在一起。

这里的很多答案都集中在您将包含在日志消息中的字段上，但我认为日志调用的位置和日志级别更为重要。如果您使用 log4net，您将能够通过配置文件随意包含/排除日期戳，但您将无法在不重新编译的情况下放置或删除日志语句，因此仔细考虑它们的去向是有意义的。除了时间戳和线程 ID 等标准字段之外，您还想知道调用的类和方法名称。如果您按照他们关注的类型命名记录器的最佳实践，Log4net 等人已经处理了类名。除此之外，我通常包括方法名称。这对于跟踪尤其必要，但我将它包含在我的所有日​​志消息中。

**记录**：

您想知道有关将要执行什么操作的足够信息，以便在出现问题时返回并四处寻找。好的候选者是消息 ID、电子邮件地址，以及唯一标识工作项的东西。此类数据应在此类数据可用时立即出现，因此当您阅读日志文件时，您会看到类似“尝试用 y 执行 x”之类的信息，然后如果我们看到异常，我们知道需要查看哪个工作项才能了解失败的原因。

记录异常应与“尝试”日志消息配对，以便在读取日志时异常消息在上下文中有意义。这意味着要考虑异常处理的结构。如果您使用的是 .net，并且只想记录一个异常，而不是处理它，您想重新抛出*同一个*异常，而不是一个新异常，所以只需执行 'throw' 而不是 'throw e' 其中 'e' 是您的异常实例。如果没有意义，请查看这个。

**追踪**：

这实际上更简单，通常我会在感兴趣的方法的开头和结尾有一条消息，比如书挡。在条目中，您可以打印影响程序流程的关键方法参数。在方法末尾记录一条消息是一种可选的方式，通常您会对查看类似于堆栈跟踪的跟踪感兴趣。你可以找出没有它们的执行路径。

**性能**：

对于字符串性能，如果您使用 log4net 或类似的东西，请使用 '*Format' 方法。这在内部将使用 StringBuilder，这样您就不会一直支付不可变的字符串惩罚。通常，尽管关键是能够关闭跟踪以提高性能，并让日志记录足够简洁以保持打开状态，即使日志消息很昂贵。如果正确完成，它们应该不会成为问题。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-11-06T22:59:47.143

日志语句中最有用的部分（当然日期和时间除外）是唯一 ID。我们所有的日志条目都以 MSG-xxxxx 开头，其中 xxxxx 是一个唯一的整数。这个 MSG-xxxxx 标签总是硬编码在源代码中，从不在资源文件中，因此很容易找到它。它也是文档中一个非常简单的搜索关键字。

另外有用的是始终将变量字符串内容括在双引号中，以轻松区分消息本身：

MSG-12345 试图打开“myfile.txt”，返回错误代码“123 - 找不到文件”。

当您尝试使用一些正则表达式从日志中提取信息时，这也很有帮助。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-06T23:00:44.490

不要在日志语句中进行字符串连接，至少在调试语句中。

我不久前正在开发的一个 Java 应用程序的性能很差。所以我们破解了分析器来查看瓶颈在哪里。事实证明，这主要是由于组装调试级别日志记录语句引起的字符串连接操作，这些语句总是在嵌套的内部循环等中发生（哈，并认为首先添加它们是为了弄清楚为什么性能如此糟糕！）

**不要这样做**

```
LOGGER.debug("The variable was " + myVariable + " and we are doing " + foo); 
```

而是**这样做**

```
if (LOGGER.isDebugEnabled()) {
  LOGGER.debug("put your debug statement here " + foo + " and " + bar);
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-06T23:38:55.663

有 5 个方面对我来说很重要（从不太重要的开始）：

1.  在日志条目中包含时间戳
2.  提供过滤不太重要的“垃圾邮件”条目的可能性。好的，旧的方括号标签对于 grep 来说应该足够了。如果其中一些能够自动生成，那就太好了——这取决于日志类型（消息、警告、断言等）和可选的消息重要性级别（垃圾邮件、正常、高、关键）。IMO 还建议手动添加额外的上下文缩小标签。
3.  使日志函数/宏尽可能易于使用。
4.  立即刷新输出缓冲区。
5.  提供即时和明确确定日志条目生成位置（源文件名 + 行号）的可能性。在某些语言中这可能很困难，但通常确切地知道哪个断言失败意味着立即修复错误。此外，您不会浪费时间手动添加日志位置标识符（例如“SomeClass::SomeMethod: Message”）

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-06T23:10:58.497

在我的日志中，我需要日期和时间、创建日志的进程以及 PID。没有什么比查看日志并想知道它们是否在五分钟前进入，或者它们是否在您更改之前的 5 年前被抛在后面更糟糕的了。日期和时间很重要。

当我报告错误时，我会简明扼要地说明调用了什么、发生了什么以及返回了什么错误代码。如果是errno，我也会报告strerror(errno)。我正在阅读这篇文章来寻找问题，通常我会急于找到问题。我不想查资料。我想让它告诉我发生了什么，我更喜欢冗长而不是无用。如果我正在调试，即使我没有调试，我也会记录所有数据，如 SQL 语句或低级记录、键，以及任何能帮助我尽快找到问题的东西。

有时我们会疯狂地登录，它会稍微减慢系统速度。但是，当事情发生了，我们收到了传票，就松散的诉讼提起了诉讼，婴儿杀手的指控被抛出，我们喜欢我们有足够的日志可以准确地显示发生了什么以及为什么以及是谁造成的。这是责任管理。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-06T23:24:32.993

编码可变级别的日志记录，因此您可以在无内容、程序流程的基本信息和内部工作的极其详细的信息之间切换。然后通过调整控制日志记录级别的变量，您可以控制要接收多少输出。

在您希望能够从遇到问题的客户那里接收日志记录的大型项目中，如果您可以控制应用程序的哪些部分将记录日志，这也会有所帮助；例如，如果读取 AD 用户信息时出现问题，您可以添加“AD_LOGGING=EVERYTHING”并接收详细的日志信息，而无需查看程序其他所有部分的日志信息。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-06T23:35:54.497

我们使用“二维”日志记录，即按单个模块和按级别进行日志记录。在尝试调试客户问题时，这使我们能够真正控制。

每个日志条目都有一个唯一的 id 加日期加时间加模块加调试级别。id 反映（如果需要）在向用户显示的异常/错误消息中。因此，如果用户记录了一个事件，我们可以快速调出该部分的日志并查看该点附近发生了什么。

调试级别消息不使用“无效输入”之类的通用性，我们记录导致问题的实际值。如果该字段与其他字段有关系，我们也会记录它们。

# database-design - 内容的 CMS 版本控制策略

> ID：270658
> 
> 赞同：12
> 
> 时间：2008-11-06T22:52:43.120
> 
> 标签：database-design, content-management-system, versioning

我正在考虑将基本的 CMS 功能构建到我们的 Web 产品中，并且正在研究版本控制内容的技巧和设计理念。我正在专门寻找今天使用的数据库模式。

您使用什么进行内容版本控制？如果您有不同类型的内容需要存储版本，则适用哪些模式？Stack Overflow 上如何处理问题版本控制？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-07T00:35:53.830

文献为此使用了一个 5 维模型：

*   版本（想要更改）
*   状态（生命周期：创建、测试、部署、退役）
*   视图（html、pdf、文件系统、可导出性）
*   层次结构（页、节、段）
*   变体（非常相似，描述差异，产品系列）

大多数系统只处理其中的几个维度。要处理所有这五个问题，您必须描述（修复）您的开发过程。

参考资料：

*管理设计数据：CAD 框架、配置管理、产品数据管理五个维度。*
van den Hamer，P. Lepoeter，K.
Philips Res.，埃因霍温；

本文发表于：*IEEE*
出版日期： 1996 年 1 月
卷： 84，期数： 1
页数： 42-56
ISSN： 0018-9219引用的
参考文献： 26
代码： IEEPAD
INSPEC 登录号： 5175049
数字对象标识符: 10.1109/5.476025
当前版本发布时间: 2002-08-06

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T23:43:49.083

作为参考，[drupal](http://drupal.org)使用以下内容：

```
node         node_revision
----         -------------
nid*         vid*
vid          nid
...          body
             ... 
```

（节点本质上是主要的内容类型）。所以每个修订都被记录下来，并获得最新的你`vid`从节点中获取当前版本。如果您对差异感兴趣，也可以添加到您的版本中`node_revision`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T23:31:25.723

我的直觉是，最好的办法是（按最佳顺序）：

1.  一个现成的版本控制系统。[一个不错的清单在这里。](http://en.wikipedia.org/wiki/List_of_revision_control_software)
2.  存储差异。[这里有什么区别。](http://en.wikipedia.org/wiki/Diff)
3.  我猜想具有“ContentVersion”表的明显数据库解决方案，其中每个唯一“内容”有多个“版本”。

# asp.net - 准系统 asp.net

> ID：270668
> 
> 赞同：0
> 
> 时间：2008-11-06T22:55:30.710
> 
> 标签：asp.net

是否可以在不使用服务器控件或在 html 控件上设置 runat 属性的情况下进行 Web 表单？你如何调用函数背后的代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T00:17:09.533

是的，可以这样做。仅当您使用回发和服务器控件时，才需要带有 runat server 的表单。

如果您不使用服务器控件，您应该能够将表单添加到 POST 到其他页面的页面（它甚至可以发布到自身）。在您的 page_load 中，您将被限制使用普通的 request.form 和 request.querystring 来检索表单值，但您应该能够调用页面上的其他方法。

如果你熟悉经典的 ASP，你可以用 asp.net 做同样的事情。

另外，看看 asp.net MVC 框架（[http://www.asp.net/mvc](http://www.asp.net/mvc)）。它允许您在不使用 webforms 的情况下使用 asp.net。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T23:00:56.957

至少不能在没有 runat="server" 标记的情况下调用代码隐藏函数。如果您创建了一个 Web 服务，则可以创建一个纯 html/javascript 页面，该页面通过 AJAX 与服务器交互。据我所知，这是您使用 ASP.Net 的唯一两种选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T00:22:37.337

您可以将 HTTPHandler 用于准系统 ASP.NET。

你不会有一个标记文件，你只会有一个类运行并将你暴露给 HttpContext 以写出到 HTTP 流。

[http://msdn.microsoft.com/en-us/library/f3ff8w4a(VS.71).aspx](http://msdn.microsoft.com/en-us/library/f3ff8w4a(VS.71).aspx)

事实上，HttpHandler 是所有 .NET Web 框架的构建块。

# unicode - 后记中的 unicode

> ID：270672
> 
> 赞同：11
> 
> 时间：2008-11-06T22:58:00.503
> 
> 标签：unicode, postscript

无论如何在 PostScript 中使用 unicode 字符串（很可能是 UTF-8，但可以是任何编码）？

到目前为止，我一直在使用这个函数将字体转换为 Latin1 编码：

```
/latinize {
  findfont
  dup length dict begin
  { 1 index /FID ne {def}{pop pop} ifelse }forall
  /Encoding ISOLatin1Encoding def
  currentdict
  end
  definefont pop
}bind def

/HelveLat /Helvetica latinize
/HelveLatbold /Helvetica-Bold latinize 
```

但我真的不喜欢它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T10:37:32.263

不是真的或以任何简单的“开箱即用”方式。有关详细信息，请参阅[此常见问题解答条目](https://web.archive.org/web/20120322112530/http://en.wikibooks.org/wiki/PostScript_FAQ#Does_PostScript_support_unicode_for_CJK_fonts.3F)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-21T04:40:30.667

这可能符合您的要求，也可能不符合您的要求，但我编写的解释器 ( [xpost](http://code.google.com/p/xpost/) ) 使用 Cairo 的所有图形和字体功能，包括`show`. 因此，无论开罗必须提供什么支持，xpost 都不会妨碍您。但在您过于兴奋之前，这是一个单人项目，还没有完全提供完整的 Level-1 Postscript。

编辑：最新版本不支持这个。[这](http://code.google.com/p/xpost/downloads/detail?name=xpost2g.zip)是最后一个版本（[列表](http://code.google.com/p/xpost/downloads/detail?name=xpost2.pdf)）。

* * *

这是我的表演操作员本身的 C 代码。

```
OPFN_ void show(state *st, object s) {
    char str[s.u.c.n+1];
    memcpy(str, STR(s), s.u.c.n); str[s.u.c.n] = '\0';
    //printf("showing (%s)\n", str);
    if (st->cr) {
        cairo_show_text(st->cr, str);
        cairo_surface_flush(st->surface);
        XFlush(st->dis);
    }
} 
```

来自[开罗文档](http://cairographics.org/manual/)：

> cairo_show_text ()
> 
> void cairo_show_text (cairo_t *cr,
> const char *utf8);
> 
> 一个绘图操作符，它从一串 UTF-8 字符生成形状，根据当前的 font_face、font_size (font_matrix) 和 font_options 呈现。
> 
> 该函数首先为文本字符串计算一组字形。放置第一个字形，使其原点位于当前点。每个后续字形的原点从前一个字形的原点偏移前一个字形的提前值。
> 
> 在此调用之后，当前点将移动到下一个字形将在同一进程中放置的原点。也就是说，当前点将位于最终字形偏移其提前值的原点。这允许通过多次调用 cairo_show_text() 轻松显示单个逻辑字符串。
> 
> 注意：cairo_show_text() 函数调用是 cairo 设计者所称的“玩具”文本 API 的一部分。它对于简短的演示和简单的程序很方便，但对于严重的文本使用应用程序来说，它并不足够。请参阅 cairo_show_glyphs() 以了解 cairo 中的“真实”文本显示 API。
> 
> [http://www.cairographics.org/manual/cairo-text.html#cairo-show-text](http://www.cairographics.org/manual/cairo-text.html#cairo-show-text)

所以它是 Postscript 中的 UTF-8，我可以想象！:)

# c# - 从 ASP.Net 打印 PDF 而无需预览

> ID：270674
> 
> 赞同：16
> 
> 时间：2008-11-06T22:58:26.850
> 
> 标签：c#, asp.net, pdf, printing

我已经使用 iTextSharp 生成了一个 pdf，我可以在 ASP.Net 中很好地预览它，但我需要将它直接发送到打印机而不进行预览。我希望用户单击打印按钮并自动打印文档。

我知道可以使用 javascript window.print() 将页面直接发送到打印机，但我不知道如何为 PDF 制作它。

编辑：它没有嵌入，我像这样生成它；

```
 ...
                FileStream stream = new FileStream(Request.PhysicalApplicationPath + "~1.pdf", FileMode.Create);
                Document pdf = new Document(PageSize.LETTER);
                PdfWriter writer = PdfWriter.GetInstance(pdf, stream);
                pdf.Open();
                pdf.Add(new Paragraph(member.ToString()));
                pdf.Close();

                Response.Redirect("~1.pdf");
                ... 
```

我在这里。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-07T04:37:47.383

最后我做到了，但是我必须使用一个IFRAME，我在aspx中定义了一个IFrame并且没有设置src属性，在我制作的cs文件中生成了pdf文件并将iFrame的src属性设置为生成的pdf文件名，像这样；

```
Document pdf = new Document(PageSize.LETTER);
PdfWriter writer = PdfWriter.GetInstance(pdf, 
new FileStream(Request.PhysicalApplicationPath + "~1.pdf", FileMode.Create));
pdf.Open();

//This action leads directly to printer dialogue
PdfAction jAction = PdfAction.JavaScript("this.print(true);\r", writer);
writer.AddJavaScript(jAction);

pdf.Add(new Paragraph("My first PDF on line"));
pdf.Close();

//Open the pdf in the frame
frame1.Attributes["src"] = "~1.pdf"; 
```

这就是诀窍，但是，我认为我应该实施您的解决方案 Stefan，问题是我是 asp.net 和 javascript 的新手，如果我没有完整的源代码，我无法编写您的建议，但是至少是第一步，我很惊讶我需要学习多少 html 和 javascript 代码。谢谢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T23:15:28.783

pdf 是嵌入在带有 embedd-tag 的页面中还是只是在框架中打开或者您如何显示它？

如果它是嵌入的，只需确保选择了对象，然后执行 print()。

获取嵌入文档的引用。

```
var x = document.getElementById("mypdfembeddobject");  
x.click();
x.setActive();
x.focus();
x.print(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-07-19T15:32:24.123

如果您使用的是 pdfsharp，这会有点棘手，但非常可行

```
PdfDocument document = new PdfDocument();
PdfPage page = document.AddPage(); 
XGraphics gfx = XGraphics.FromPdfPage(page); 
XFont font = new XFont("Verdana", 20, XFontStyle.BoldItalic); 
// Draw the text 
gfx.DrawString("Hello, World!", font, XBrushes.Black, 
    new XRect(0, 0, page.Width, page.Height), 
    XStringFormats.Center); 

// real stuff starts here

// current version of pdfsharp doesn't support actions 
// http://www.pdfsharp.net/wiki/WorkOnPdfObjects-sample.ashx
// so we got to get close to the metal see chapter 12.6.4 of 
// http://partners.adobe.com/public/developer/pdf/index_reference.html
PdfDictionary dict = new PdfDictionary(document); // 
dict.Elements["/S"] = new PdfName("/JavaScript"); // 
dict.Elements["/JS"] = new PdfString("this.print(true);\r");
document.Internals.AddObject(dict);
document.Internals.Catalog.Elements["/OpenAction"] = 
    PdfInternals.GetReference(dict);
document.Save(Server.MapPath("2.pdf"));
frame1.Attributes["src"] = "2.pdf"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T00:03:54.737

您可以在 pdf 中嵌入 javascript，以便用户在浏览器加载 pdf 后立即获得打印对话框。

我不确定 iTextSharp，但我使用的 javascript 是

```
var pp = this.getPrintParams();
pp.interactive = pp.constants.interactionLevel.automatic;
this.print(pp); 
```

对于 iTextSharp，请查看[http://itextsharp.sourceforge.net/examples/Chap1106.cs](http://itextsharp.sourceforge.net/examples/Chap1106.cs)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T23:25:35.283

另外，试试这个宝石：

```
<link ref="mypdf" media="print" href="mypdf.pdf"> 
```

我还没有测试过它，但是我已经读过它，它可以用这种方式来打印 mypdf.pdf 而不是页面内容，无论您使用什么方法来打印页面。

搜索 media="print" 以查看更多信息。

# manpage - 人节

> ID：270677
> 
> 赞同：13
> 
> 时间：2008-11-06T22:58:48.083
> 
> 标签：manpage

如何访问手册页的特定部分？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-06T23:01:53.507

将章节编号放在您要参考的项目前面。例如，要从库部分访问 sysctl 函数，您可以编写：

```
man 3 sysctl 
```

要从系统管理员部分访问 sysctl 工具，您可以编写：

```
man 8 sysctl 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T23:10:06.827

为了补充[Jason](https://stackoverflow.com/questions/270677/man-sections#270694)所说的：如果您不确定某些内容在哪个部分，您还可以通过键入来查看给定主题的*所有手册页*

```
man -a topic 
```

这对于诸如 之类的主题很有用`printf`，其中有一个命令和一个 C 函数可以做类似的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T23:13:37.803

使用 -s 标志，例如：

```
man -s 2 read 
```

你可能想看看

```
man intro 
```

了解什么在哪里。

HTH。

干杯，

抢

# vb.net - 从插入语句返回一个值

> ID：270695
> 
> 赞同：6
> 
> 时间：2008-11-06T23:01:58.327
> 
> 标签：vb.net, oracle, asp.net-2.0

使用 OLEDB 从 ASP.NET 2.0 (VB) 应用程序处理 Oracle 9i 数据库。有没有办法让插入语句返回一个值？我有一个序列设置为进入数据库时​​对条目进行编号，但我需要在插入后返回该值，以便我可以对刚刚在代码隐藏 VB 中输入的集合进行一些操作。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-07T10:00:40.947

一些可能性：

1) 使用 RETURNING 子句：

```
INSERT INTO emp (empno, ename) VALUES (emp_seq.NEXTVAL, 'ANDREWS')
RETURNING empno INTO :variable; 
```

2) 使用序列 CURRVAL：

```
INSERT INTO emp (empno, ename) VALUES (emp_seq.NEXTVAL, 'ANDREWS');
SELECT emp_seq.CURRVAL INTO :variable FROM DUAL; 
```

CURRVAL 返回会话生成的最后一个序列值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T23:13:27.383

Oracle 似乎有一个名为“returning”的关键字，它可以返回插入行的给定列，但是这可能需要您通过调用序列中的下一个值来手动设置“autoincrement”字段。

检查有关它的讨论：

[http://forums.oracle.com/forums/thread.jspa?threadID=354998](http://forums.oracle.com/forums/thread.jspa?threadID=354998)

但是，您始终可以在第二个查询中选择当前序列号，有点像 MySQL`last_insert_id()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T23:03:12.443

如果这个值是数据库创建的键，那么您就遇到了一个很好的例子，为什么应该使用 UUID 作为表键，并在代码中生成它们。

此方法将为您的设置提供更快的性能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T00:43:24.020

首先使用**SELECT**语句获取下一个序列。您可以使用[Oracle 双表](http://www.adp-gmbh.ch/ora/misc/dual.html)来执行此操作。

```
SELECT my_seq.nextval FROM dual 
```

使用您在后续**INSERT**语句中检索到的序列。

```
INSERT ...
INSERT ... 
```

# apache-flex - 关于在 Flex 中将对象从其布局中“打破”的任何建议 - 出于动画目的？

> ID：270697
> 
> 赞同：1
> 
> 时间：2008-11-06T23:03:10.990
> 
> 标签：apache-flex, layout, animation

如果我在 Flex 的布局中有一个对象，那么从该布局中“打破”它以便能够对其进行动画处理是一种好方法。

例如，我有一个以一定角度排列的图像和标题。当鼠标滚过它时，我想让图像稍微“缩小”。因为如果我要调整它的大小，它在布局容器中是活动的，那么显然它会在其他所有东西上移动。

我不认为我可以通过设置来实现我想要的`includeinlayout=false`。

有这方面的最佳实践经验吗？

我想知道的最好的想法是使用屏幕坐标转换功能使图像不可见并在同一位置创建另一个图像。这个 jsut 看起来很笨拙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T14:00:53.007

将您的对象包裹在固定大小的 Canvas 中，以便上游的布局保持不变。然后在该容器中手动定位对象，然后将其 includeInLayout 设置为 false。那时，您可以对内部对象做任何您想做的事情。哦，还要将 clipContent 设置为 false。无论您希望它增长还是缩小，这都应该有效。

如果这是一个 itemrenderer 或您已经包装到一个类中的东西，您可以在类定义中处理所有这些并使其对对象的使用者透明。您还可以编写一个 mouseOver 函数，对应该缩放的内部对象执行您想要的操作。

# linux - 创建 PDF 发票 - 是否有任何模板解决方案？

> ID：270703
> 
> 赞同：19
> 
> 时间：2008-11-06T23:05:05.073
> 
> 标签：linux, pdf, open-source, templating, invoice

我们公司正在寻求将发票整合到我们正在开发的新系统中。

我们需要一种解决方案来创建发票布局，然后转换为 pdf。

我们考虑过在 html/css 中列出发票，然后转换为 pdf。我们也考虑过使用 SVG->PDf 转换。

这两种解决方案都很好地集成到了我们现有的用于 Web 应用程序的模板语言中。

从历史上看，我们一直是一家基于 Microsoft 的企业，并使用 Crystal Reports 来完成此类任务，但我们正在为该项目寻找开源 Linux 解决方案。

有人对我们可以用于此类任务的方法或技术有任何建议吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-06T23:11:04.703

试试这个...用 Word（或任何你想要的）创建一张空白发票并将其保存为 PDF。

然后使用 PDF 库修改 PDF（在特定坐标处插入文本）。我们在 Microsoft 世界中这样做，这非常容易。

最大的好处是我们可以使用自己的工具来创建和修改模板。如果我们想添加一些静态文本，我们只需打开 Word，进行更改并将其保存到 PDF 文件（用作模板）。

对于 Microsoft，我们使用[iTextSharp](http://sourceforge.net/projects/itextsharp/)，它实际上是[iText 原始 Java 版本的C# 端口](http://www.lowagie.com/iText/docs.html)

* * *

此外...

您可以使用 Adob​​e Acrobat 在 PDF 中插入字段（地址、电话、发票号码、第 1 行、第 2 行等），然后在运行时使用 iText/iTextSharp 填充这些字段。

更详细地说，这就是我们所做的……而且非常简单。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-06T23:26:29.103

正常的方法是安装 (La)TeX（可能已经在 linux 机器上）并运行 pdflatex 来获取 pdf。如果您更喜欢 xslt 和 xsl-fo，也可以使用 Apache FOP。

如果要创建的发票数量很少，您可能希望使用开放式办公室（直接或作为工具包）。

如果您想要高精度定位和低级访问，那么低级 pdf 库（我不知道 iTextSharp 是否适用于单声道）可能是您想要的。

我会先尝试 LaTeX，因为它可以让您以最少的努力获得结果。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-06T23:12:20.753

我以前通过模板化 PostScript 文件生成发票，然后使用 Ghostscript`ps2pdf`将它们转换为 PDF。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-06T23:22:00.563

我们将[Reportlab](http://www.reportlab.org/)与 Python 一起使用。如果您环顾四周，那里有大量现成的表格/发票/等。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-07T12:01:17.070

有几个 OSS 报告引擎（[Jasper Reports](http://www.jaspersoft.com)、[Pentaho](http://www.pentaho.com/)和[BIRT](http://www.eclipse.org/birt/phoenix/)仅举三例），您可以像过去使用 Crystal Reports 一样使用它们。其他海报之一提到[ReportLab](https://stackoverflow.com/questions/270703/creating-pdf-invoices-are-there-any-templating-solutions#270748)，如果您使用 Python 或可以在应用程序中嵌入 Python 运行时，这是一个选项。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-06T23:22:46.817

可能最灵活的解决方案是使用发票数据创建 XML，然后使用 XSLT 将其转换为 PDF、HTMls 等等……

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-06T23:22:49.407

这取决于您的环境。如果您可以访问 Java，您可能会查看 iText ( [http://www.lowagie.com/iText/](http://www.lowagie.com/iText/) )，这是一个允许您即时生成 PDF 文件的库。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-08-14T15:00:37.130

如果我理解正确，有两个步骤：
1）使用占位符创建 PDF 模板以编程方式填充数据
2）在运行时以编程方式填充 PDF 模板

对于 #1，OpenOffice 允许创建 PDF 模板，然后可以通过编程方式填充这些模板。创建可能不涉及数据网格/表格之类的简单发票就足够了。

对于 #2，您已经在这里找到了答案 - iText、iTextSharp。

希望这可以帮助！

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-05-14T17:43:02.017

我喜欢 wkhtmltopdf [http://code.google.com/p/wkhtmltopdf/](http://code.google.com/p/wkhtmltopdf/)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-06T23:22:42.247

不知道你的目标是什么，但有一个名为 fpdf 的开源 php 库，它还有一个扩展，可以将预制的 pdf 作为布局，然后用更多内容填充它，用该信息生成一个新的 PDF。

但是，我会寻求一个可以很好地集成到您正在构建的平台中的解决方案，但我不会采用 HTML-> PDF 解决方案，因为您不会知道什么适合一块有关这种环境中大小的论文，这意味着您不知道何时应该将内容拆分为两个单独的模板。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-02T20:55:24.340

您也可以尝试使用 XSL:FO。XSL:FO 是用于描述页面布局的文档化标准：http: [//www.w3.org/TR/xsl/#fo-section](http://www.w3.org/TR/xsl/#fo-section)。

通过创建定义“PDF”内容的 XML 模式，我在创建文档的两个项目上取得了成功。然后我使用 XSD 工具（来自 Microsoft）来生成一个代表该文档的类。然后，我将我的数据映射到该结构中，将填充的类序列化为 XML，以及定义如何将数据映射到 FO 的 XSL 样式表，并将其传递给 FO 格式化程序。对于格式化程序，我成功地使用了 Alt-Soft 的 Xml2Pdf。还有其他几个。有一些工具可用于帮助创建 XSL 到 FO 样式表（即 stylusstudio 和 XmlSpy），但我建议学习 FO 构造，因为这些工具似乎会产生臃肿的样式表。FO 类似于 HTML（其中 P 标记是 FO 中的 BLOCK 标记），但可能很棘手。FO的这件好事，

其他选项：

1.  iTextSharp（iText 的 C# 端口）。刚开始阅读这个。开源和免费。我不认为有任何“模板”支持这个，但我可能错了。

2.  SQL Server 报告服务。假设您的发票数据采用或可以放入报告服务（SQL Server、Web 服务等）可以读取的格式，在 SSRS 中定义布局，然后发布到报告服务器。使用 SSRS Web 服务或查询参数执行来执行报告并将其输出为 PDF。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-06T23:09:12.540

这个 html-2-pdf 站点可能是一个有用的起点：[http ://maarten.lippmann.us/?p=101](http://maarten.lippmann.us/?p=101)

我的一个朋友建立的一个站点也使用脚本将 HTML 页面转换为可打印的 PDF - [http://philambdaupsilon.org](http://philambdaupsilon.org)。不确定它的确切细节，但他是 SO 用户，我也会将这个问题发送给他。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-06T23:17:07.220

不幸的是，市场上最好的系统（目前）是将 HTML 和 CSS 传递到 ColdFusion 服务器并让它返回呈现的 PDF。因此，如果钱不是一个大问题，这是部署最快的解决方案，可以带来最好的结果。

我已经非常努力地让 FPDF、TCPDF、R&OS pdf 类，甚至[CodeIgniter 的推荐](http://codeigniter.com/news/codeigniter_community_voice_generating_pdf_files_using_codeigniter/)工作，但除了最基本/平淡的 HTML 文件之外，没有任何稳定的输出。

老实说，如果 ColdFusion 解决方案不可行，我会使用 html2ps，然后使用 ps2pdf 将您的文件转换为 PDF。

（这都是假设您不想花时间使用 PHP 中的原生 PDF 创建器代码来设计每个 PDF。这就是像 SugarCRM 这样的系统所使用的。虽然它非常实用且结果稳定，但每个文件的实际创建PDF 生成器文件是一个最痛苦的过程）

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-11-06T23:30:27.193

我们之前使用过 Jasper Reports。这不是您所说的用户友好，但它会直接与您的数据库对话。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-20T03:12:11.417

我现在正在摆弄[Black Sheep Invoices](http://www.blacksheepsoft.com/invoices/)，起初这很好，但现在我在实际使用它来渲染 PDF 时遇到了麻烦。很多安装困难——在你自己的服务器上可能要容易得多，但我在与它共享主机上。不过，HTML 输出和数据管理部分做得很好，这是您仅通过创建 postscript 模板就无法解决的问题。我希望找到一个有一个活跃的开发团队的库的参考（Black Sheep 目前没有更新）。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-09-07T00:30:41.747

我在服务器上使用开放式办公室，然后为文档生成 XML（只需解压缩文档并破解）

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-11-14T13:15:16.567

[html2pdf](http://html2fpdf.sourceforge.net/)效果很好。您可以使用它从同一来源生成 HTML 和 PDF 报告。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2010-01-03T19:00:31.333

我将[TROFF](http://www.gnu.org/software/groff/groff.html#introduction)用于我的发票，因为它非常简单的文本编码。逻辑是几行 Perl。保持简单。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-01-20T03:54:37.057

如果您希望将浏览器完美的 HTML 转换为 PDF，请尝试[commandlineprint](http://torisugari.googlepages.com/commandlineprint2)

您需要在 linux 发行版上安装 firefox，禁用所有 firefox 警报，然后通过虚拟显示器运行它。[检查此线程](http://forums.mozillazine.org/viewtopic.php?f=27&t=661813&st=0&sk=t&sd=a&start=15)以获取更多详细信息。

运行良好令人恼火，但确实为您提供了我所见过的 HTML 到 PDF 转换的最佳结果。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-01-20T04:19:09.097

好的，谷歌代码项目的搜索出现了[Simple Invoices](http://code.google.com/p/simpleinvoices/)，它很棒而且维护得很好。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2014-07-17T14:22:52.100

有些人可以使用 Dhek 模板编辑器为现有 PDF 定义区域/占位符，而不更改现有文档，然后填充它以生成最终文档（例如，使用表单中的用户值）：[https](https://github.com/applicius/dhek) ://github.com/applicius/dhek 。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2010-09-07T00:22:03.043

对于 Ruby 解决方案，请尝试 Prawn： http: [//prawn.majesticseaacreature.com/](http://prawn.majesticseacreature.com/)

# c - 末尾带有垃圾字符的字符串数组

> ID：270708
> 
> 赞同：12
> 
> 时间：2008-11-06T23:06:06.553
> 
> 标签：c, string, cstring, null-terminated

我有一个 char 数组缓冲区，用于存储用户将一一输入的字符。我下面的代码有效，但有一些我无法弄清楚的小故障：

1.  当我执行 printf 以查看 Buffer 中的内容时，它确实填满了，但最后我得到了垃圾字符
2.  尽管被声明为 char Buffer[8]，但它不会在 8 个字符处停止；

有人可以向我解释发生了什么，也许我该如何解决这个问题？谢谢。

```
char Buffer[8]; //holds the byte stream
int i=0;

if (/* user input event has occurred */) 
{
        Buffer[i] = charInput;
        i++;

        // Display a response to input
        printf("Buffer is %s!\n", Buffer);

} 
```

输出：

```
tagBuffer 是 1┬┬w！
tagBuffer 是 12┬w！
tagBuffer 是 123w！
tagBuffer 是 1234！
tagBuffer 是 12345！
tagBuffer 是 123456=!
tagBuffer 是 1234567！
tagBuffer 是 12345678！
```

tagBuffer 是 123456789！

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-11-06T23:07:35.897

您必须以 \0 字符结束字符串。这就是为什么它们被称为零终止字符串。

分配 1 个额外的字符来保存 \0 也是明智的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-06T23:10:14.207

您传递给 printf() 函数的唯一内容是指向字符串第一个字符的指针。printf() 无法知道数组的大小。（它甚至不知道它是否是一个实际的数组，因为指针只是一个内存地址。）

printf() 和所有标准的 c 字符串函数都假定字符串末尾有一个 0。例如 printf() 将在内存中保留打印字符，从您传递给函数的字符开始，直到它达到 0。

因此，您应该将代码更改为以下内容：

```
char Buffer[9]; //holds the byte stream
int i=0;

if( //user input event has occured ) 
{
        Buffer[i] = charInput;
        i++;

        Buffer[i] = 0; // You can also assign the char '\0' to it to get the same result.

        // Display a response to input
        printf("Buffer is %s!\n", Buffer);

} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-06T23:20:11.050

除了前面关于零终止的评论之外，您还必须承担不溢出自己的缓冲区的责任。它不会在 8 个字符处停止，因为您的代码没有停止！您需要以下内容（支持 Jeremy 的建议）：

```
#define DATA_LENGTH 8
#define BUFFER_LENGTH (DATA_LENGTH + 1)

char Buffer[BUFFER_LENGTH]; //holds the byte stream
int charPos=0;  //index to next character position to fill

while (charPos <= DATA_LENGTH  ) { //user input event has occured
    Buffer[i] = charInput;

    Buffer[i+1] = '\0';

    // Display a response to input
    printf("Buffer is %s!\n", Buffer);

    i++; 

} 
```

换句话说，请确保在达到最大长度时停止接受数据，无论环境试图向您推送什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T23:11:58.023

如果您使用 C 或 C++ 编程，您必须记住：1) 字符串以 \0 字符结尾。2) C 对字符串没有边界检查，它们只是字符数组。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-07T06:28:56.910

奇怪的是没有人提到这种可能性：

```
char Buffer[8]; //holds the byte stream
int i = 0;

while (i < sizeof(Buffer) && (charInput = get_the_users_character()) != EOF)
{
    Buffer[i] = charInput;
    i++;

    // Display a response to input
    printf("Buffer is %.*s!\n", i, Buffer);
} 
```

printf() 格式字符串中的这个符号指定了要显示的字符串的最大长度，并且不需要空终止（尽管空终止最终是最好的方法——至少在你离开这个循环之后）。

`while`循环比简单的更合理，`if`并且此版本确保您不会溢出缓冲区的末尾（但不能确保您为尾随 NUL 留出足够的空间`'\0'`。如果您想处理它，请使用`sizeof(Buffer) - 1`然后添加 NUL循环之后。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-12-12T13:36:18.213

由于`Buffer`未初始化，它以所有 9 个垃圾值开始。从观察到的输出中，第 2、第 3、第 4、第 5、第 6、第 7、第 8 和第 2 个直接下一个内存位置（数组外）元素显然是`'T'`, `'T'`, `'W'`, `'\0'`, `'\0'`, `'='`, `'\0'`, `'\0'`, `'\0'`.

字符串会消耗所有字符，直到它们看到 NULL 字符。这就是为什么在每次迭代中，当数组元素被一一分配时，缓冲区被打印到存在垃圾 NULL 的部分。

也就是说，如果字符数组不以 . 结尾，则 string 具有未定义的行为`'\0'`。`'\0'`您可以通过在缓冲区末尾留出额外空间来避免这种情况。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-11-06T23:14:36.367

您可能还想研究使用`stringstream`.

# delphi - Delphi 2009 泛型编译问题

> ID：270724
> 
> 赞同：2
> 
> 时间：2008-11-06T23:13:10.270
> 
> 标签：delphi, generics, delphi-2009

我正在查看 Delphi 2009 Trial，但马上就遇到了泛型问题。

以下代码无法编译，我一点也不知道为什么它给我 E2015 用于 Equals() 方法：

```
type
  TPrimaryKey<T> = class(TObject)
  strict private
    fValue: T;
  public
    constructor Create(AValue: T);
    function Equals(Obj: TObject): boolean; override;
    function GetValue: T;
  end;

constructor TPrimaryKey<T>.Create(AValue: T);
begin
  inherited Create;
  fValue := AValue;
end;

function TPrimaryKey<T>.Equals(Obj: TObject): boolean;
begin
  Result := (Obj <> nil) and (Obj is TPrimaryKey<T>)
    and (TPrimaryKey<T>(Obj).GetValue = fValue);
end;

function TPrimaryKey<T>.GetValue: T;
begin
  Result := fValue;
end; 
```

为什么编译器认为 fValue 和 GetValue() 的结果不能比较？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-06T23:57:37.340

如果 T 是一个字符串呢？如果是 TSize 记录怎么办？

如果没有约束 T（例如使用 <T :class>），您无法确定比较是否有意义。

相反，如果您想比较 T 类型的两个值，则可以使用 Generics.Defaults 单元并使用：

```
TEqualityComparer<T>.Default.Equals(x, y) 
```

比较类型 T 的值 x 和 y。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T23:37:58.020

您不能将运算符与无类型的泛型一起使用。请参阅[此处](https://forums.codegear.com/message.jspa?messageID=26273)进行讨论。

如果您将其更改为：

```
TPrimaryKey<T: class> = class(TObject) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T23:46:51.747

我认为原始海报试图围绕简单类型（整数、双精度等）创建一个对象包装器，因此将 T 限制为 Class 可能不适用于他想要的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T23:48:39.463

编译器无法确定两个“T”是否相同。但是通过一个小技巧，你可以让它工作：

```
type
  TPrimaryKey<T> = class(TObject)
  public
    type
      TCompare<T1> = reference to function(const A1, A2: TPrimaryKey<T1>): Boolean;
  private
    fValue: T;
    fCompare : TCompare<T>;
  public
    constructor Create(AValue: T; ACompare: TCompare<T>);
    function Equals(Obj: TPrimaryKey<T>): Boolean; reintroduce;
    function GetValue: T;
    function CreateNew(const AValue: T): TPrimaryKey<T>;

  end;

constructor TPrimaryKey<T>.Create(AValue: T; ACompare: TCompare<T>);
begin
  inherited Create;
  fValue := AValue;
  fCompare := ACompare;
end;

function TPrimaryKey<T>.Equals(Obj: TPrimaryKey<T>): Boolean;
begin
  Result := FCompare(self, Obj);
end;

function TPrimaryKey<T>.GetValue: T;
begin
  Result := fValue;
end;

function TPrimaryKey<T>.CreateNew(const AValue: T): TPrimaryKey<T>;
begin
  Result := TPrimaryKey<T>.Create(AValue, FCompare);
end; 
```

你实例化它：

```
var
  p1, p2 : TPrimaryKey<Integer>;
begin
  p1 := TPrimaryKey<Integer>.Create(10,
    function(const A1, A2: TPrimaryKey<Integer>): Boolean
    begin
      Result := (A1<>nil) and (A2<>nil) and (A1.GetValue=A2.GetValue);
    end);
  p2 := p1.CreateNew(10);

  p1.Equals(p2);
end; 
```

# asp.net - 我将如何计算我的服务器可以处理的最大负载？

> ID：270737
> 
> 赞同：4
> 
> 时间：2008-11-06T23:18:07.310
> 
> 标签：asp.net, sql-server, iis, testing, load

在 Joel 为 Inc. 撰写的题为[How Hard Can Be?: The Unproven Path](http://www.inc.com/magazine/20081101/how-hard-could-it-be-the-unproven-path.html)的文章中，他写道：

> ...事实证明，杰夫和他的程序员非常出色，以至于他们建立了一个每天可以为 80,000 名访问者提供服务的网站（大约 755,000 次页面浏览量）

我将如何计算我的服务器可以处理的最大负载？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T23:52:02.250

对您的软件进行基准测试通常比看起来要困难得多。当然，很容易产生一些说明软件性能的数字，但除非它是使用非常准确地表示最终用户的实际使用模式来计算的，否则它可能与您将获得的实际结果完全不同在野外。众所周知，网站很难正确进行基准测试。当然，您可以运行一个脚本来测量生成页面所需的时间，但它与您在实际使用中看到的数字会有很大不同。

为了为您的服务器可以处理的内容创建一个可靠的基准，您首先需要弄清楚您的用户的使用模式是什么。如果您的网站已经在运行，您可以轻松地从日志中收集这些数据。接下来，您需要创建一个模拟，该模拟将模拟与您的真实用户展示的完全相同的模式......即 - 查看首页、登录、查看状态页面等等。不同的页面将在服务器上产生不同的负载，要求您在模拟服务器上的负载时实际获取正确的页面集。最后，您需要确定用户缓存了哪些资源，您可以通过查看访问日志或使用诸如 firebug 之类的工具再次执行此操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-07T00:44:10.727

JMeter、ab 或[httperf](http://www.hpl.hp.com/research/linux/httperf/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-07T00:17:22.760

您可以创建几个“压力测试”并按照其他海报所说的那样运行它们。

Apache 有一个名为 JMeter 的工具，您可以在其中创建这些测试并多次运行它们。

[http://jmeter.apache.org/](http://jmeter.apache.org/)

问候。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T23:19:46.607

Apache 有一个名为的工具`ab`，您可以使用它来对服务器进行基准测试。它可以为您模拟负载请求和并发情况。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-06T23:45:05.057

基本上，您需要模仿用户的行为并不断增加被模仿的用户数量，直到服务器响应不再可接受为止。

有多种工具可以做到这一点，但基本上你想在你的网站上记录一些会话活动，然后多次回放这些会话（添加一些随机化以反映真实的用户行为）。

您需要记录每个会话的性能并不断增加负载，直到性能变得无法接受。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-07T05:24:02.033

Jason，您是否查看过 Visual Studio 2008 Team System 中内置的负载测试？查看[此视频](http://www.youtube.com/watch?v=nIeKeFWdfh8)以查看演示。

编辑：这是[另一个](http://www.asp.net/learn/vsts-videos/video-157.aspx)分辨率更高的视频。

# python - 当我有多个 NIC 时，如何确定我的所有 IP 地址？

> ID：270745
> 
> 赞同：42
> 
> 时间：2008-11-06T23:20:28.647
> 
> 标签：python, sockets, ip-address

我的电脑上有多个网络接口卡，每个都有自己的 IP 地址。

当我使用`gethostbyname(gethostname())`Python 的（内置）`socket`模块时，它只会返回其中一个。我如何获得其他人？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2008-11-08T11:43:25.980

使用[`netifaces`](https://pypi.org/project/netifaces/)模块。因为网络很复杂，使用 netifaces 可能有点棘手，但这里是如何做你想做的事：

```
>>> import netifaces
>>> netifaces.interfaces()
['lo', 'eth0']
>>> netifaces.ifaddresses('eth0')
{17: [{'broadcast': 'ff:ff:ff:ff:ff:ff', 'addr': '00:11:2f:32:63:45'}], 2: [{'broadcast': '10.0.0.255', 'netmask': '255.255.255.0', 'addr': '10.0.0.2'}], 10: [{'netmask': 'ffff:ffff:ffff:ffff::', 'addr': 'fe80::211:2fff:fe32:6345%eth0'}]}
>>> for interface in netifaces.interfaces():
...   print netifaces.ifaddresses(interface)[netifaces.AF_INET]
...
[{'peer': '127.0.0.1', 'netmask': '255.0.0.0', 'addr': '127.0.0.1'}]
[{'broadcast': '10.0.0.255', 'netmask': '255.255.255.0', 'addr': '10.0.0.2'}]
>>> for interface in netifaces.interfaces():
...   for link in netifaces.ifaddresses(interface)[netifaces.AF_INET]:
...     print link['addr']
...
127.0.0.1
10.0.0.2 
```

这可以像这样变得更具可读性：

```
from netifaces import interfaces, ifaddresses, AF_INET

def ip4_addresses():
    ip_list = []
    for interface in interfaces():
        for link in ifaddresses(interface)[AF_INET]:
            ip_list.append(link['addr'])
    return ip_list 
```

如果您想要 IPv6 地址，请使用`AF_INET6`而不是`AF_INET`. 如果你想知道为什么`netifaces`到处都使用列表和字典，那是因为一台计算机可以有多个 NIC，每个 NIC 可以有多个地址，每个地址都有自己的一组选项。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-05-07T06:56:09.153

```
import socket
[i[4][0] for i in socket.getaddrinfo(socket.gethostname(), None)] 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2017-04-18T17:25:57.153

为了完整起见，另一种选择是使用[psutil](https://pypi.python.org/pypi/psutil)。

## **tldr;**

```
import socket
import psutil

def get_ip_addresses(family):
    for interface, snics in psutil.net_if_addrs().items():
        for snic in snics:
            if snic.family == family:
                yield (interface, snic.address)

ipv4s = list(get_ip_addresses(socket.AF_INET))
ipv6s = list(get_ip_addresses(socket.AF_INET6)) 
```

## 解释

您需要的功能是[`net_if_addrs`](https://pythonhosted.org/psutil/#psutil.net_if_addrs). IE：

```
import psutil
psutil.net_if_addrs() 
```

结果是这样的（Python 3）：

```
{'br-ae4880aa80cf': [snic(family=<AddressFamily.AF_INET: 2>, address='172.18.0.1', netmask='255.255.0.0', broadcast='172.18.0.1', ptp=None),
                     snic(family=<AddressFamily.AF_PACKET: 17>, address='02:42:e5:ae:39:94', netmask=None, broadcast='ff:ff:ff:ff:ff:ff', ptp=None)],
 'docker0': [snic(family=<AddressFamily.AF_INET: 2>, address='172.17.0.1', netmask='255.255.0.0', broadcast='172.17.0.1', ptp=None),
             snic(family=<AddressFamily.AF_PACKET: 17>, address='02:42:38:d2:4d:77', netmask=None, broadcast='ff:ff:ff:ff:ff:ff', ptp=None)],
 'eno1': [snic(family=<AddressFamily.AF_PACKET: 17>, address='54:be:f7:0b:cf:a9', netmask=None, broadcast='ff:ff:ff:ff:ff:ff', ptp=None)],
 'lo': [snic(family=<AddressFamily.AF_INET: 2>, address='127.0.0.1', netmask='255.0.0.0', broadcast=None, ptp=None),
        snic(family=<AddressFamily.AF_PACKET: 17>, address='00:00:00:00:00:00', netmask=None, broadcast=None, ptp=None)],
 'wlp2s0': [snic(family=<AddressFamily.AF_INET: 2>, address='192.168.1.4', netmask='255.255.255.0', broadcast='192.168.1.255', ptp=None),
            snic(family=<AddressFamily.AF_PACKET: 17>, address='00:21:27:ee:d6:03', netmask=None, broadcast='ff:ff:ff:ff:ff:ff', ptp=None)]} 
```

（Python 2）：

```
{'br-ae4880aa80cf': [snic(family=2, address='172.18.0.1', netmask='255.255.0.0', broadcast='172.18.0.1', ptp=None),
                     snic(family=17, address='02:42:e5:ae:39:94', netmask=None, broadcast='ff:ff:ff:ff:ff:ff', ptp=None)],
 'docker0': [snic(family=2, address='172.17.0.1', netmask='255.255.0.0', broadcast='172.17.0.1', ptp=None),
             snic(family=17, address='02:42:38:d2:4d:77', netmask=None, broadcast='ff:ff:ff:ff:ff:ff', ptp=None)],
 'eno1': [snic(family=17, address='54:be:f7:0b:cf:a9', netmask=None, broadcast='ff:ff:ff:ff:ff:ff', ptp=None)],
 'lo': [snic(family=2, address='127.0.0.1', netmask='255.0.0.0', broadcast=None, ptp=None),
        snic(family=17, address='00:00:00:00:00:00', netmask=None, broadcast=None, ptp=None)],
 'wlp2s0': [snic(family=2, address='192.168.1.4', netmask='255.255.255.0', broadcast='192.168.1.255', ptp=None),
            snic(family=17, address='00:21:27:ee:d6:03', netmask=None, broadcast='ff:ff:ff:ff:ff:ff', ptp=None)]} 
```

**注意**：由于每个接口可以有多个相同系列的地址，因此字典值是列表。

每个`snic`都是一个[`namedtuple`](https://docs.python.org/3/library/collections.html#collections.namedtuple)，其中包括 5 个字段：

*   `family`：地址族，要么`AF_INET`，`AF_INET6`要么`psutil.AF_LINK`，指的是MAC地址。
*   `address`：主网卡地址（始终设置）。
*   `netmask`：网络掩码地址（可能为无）。
*   `broadcast`：广播地址（可能为无）。
*   `ptp`：代表“点对点”；它是点对点接口（通常是 VPN）上的目标地址。broadcast 和 ptp 是互斥的（可能是 None）。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-11-26T20:05:35.750

借助`netifaces`模块将所有地址集中在一行：

```
[netifaces.ifaddresses(iface)[netifaces.AF_INET][0]['addr'] for iface in netifaces.interfaces() if netifaces.AF_INET in netifaces.ifaddresses(iface)] 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-12-15T22:11:42.500

[https://docs.python.org/3.4/library/socket.html#socket.if_nameindex](https://docs.python.org/3.4/library/socket.html#socket.if_nameindex)

socket.if_nameindex()

返回网络接口信息（索引 int，名称字符串）元组的列表。OSError 如果系统调用失败。

可用性：Unix。

**3.3 版中的新功能。**

* * *

使此代码可在 Python 3.4、UNIX / Linux 上运行

```
#!/env/python3.4
import socket
import fcntl
import struct

def active_nic_addresses():
    """
    Return a list of IPv4 addresses that are active on the computer.
    """

    addresses = [ip for ip in socket.gethostbyname_ex(socket.gethostname())[2] if not ip.startswith("127.")][:1]

    return addresses

def get_ip_address( NICname ):
    s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
    return socket.inet_ntoa(fcntl.ioctl(
        s.fileno(),
        0x8915,  # SIOCGIFADDR
        struct.pack('256s', NICname[:15].encode("UTF-8"))
    )[20:24])

def nic_info():
    """
    Return a list with tuples containing NIC and IPv4
    """
    nic = []

    for ix in socket.if_nameindex():
        name = ix[1]
        ip = get_ip_address( name )

        nic.append( (name, ip) )

    return nic

if __name__ == "__main__":

    print( active_nic_addresses() )
    print( nic_info() ) 
```

* * *

将打印如下内容：

```
['192.168.0.2']
[('lo', '127.0.0.1'), ('enp3s0', '192.168.0.2')] 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-02-11T11:09:21.213

正如这个线程所表明的，有很多方法可以获得相同的结果，我建议的方法是利用内置的家庭过滤器`getaddrinfo()`并解析标准化的元组，如下所示：

```
from socket import getaddrinfo, AF_INET, gethostname

for ip in getaddrinfo(host=gethostname(), port=None, family=AF_INET):   
    print(ip[4][0]) 
```

示例输出：

```
192.168.55.1
192.168.170.234 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-06T23:32:44.567

您应该直接获取所有 IP 配置的 IP 地址，例如通过运行 ifconfig 并解析其输出（也可以执行[ifconfig 直接在 Python 中](http://pypi.python.org/pypi/netifaces/0.3)执行的操作，[看看它是如何在 C 中完成的](https://stackoverflow.com/questions/259389/finding-an-ip-from-an-interface-name)）。如果您需要主机名，请使用 gethostbyaddr。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-07T18:36:31.750

它只是 linux，但这里有一个非常简单的食谱[http://code.activestate.com/recipes/439094/](http://code.activestate.com/recipes/439094/)

[它可能使用与另一个答案中提到的netifaces 包](http://pypi.python.org/pypi/netifaces/)类似的代码（但当前版本链接在这里）

socket.getaddrinfo() 实际上并不返回设备的绑定 IP 地址。如果您的 hosts 文件包含“127.0.1.1 yourhost.example.com yourhost”行，这是一个常见配置，getaddrinfo 只会返回 127.0.1.1。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-09-29T09:59:20.443

这是查找所有 IPv4 和 IPv6 接口的例程。正如之前的海报所指出的，socket.gethostbyname_ex() 不适用于 IPv6，Python 文档建议使用[socket.getaddressinfo()](http://docs.python.org/library/socket.html#socket.getaddrinfo)代替。

此例程添加回调 IPv4 接口 (127.0.0.1)，如果有任何 IPv6 接口，则它还添加回调 IPv6 接口 (::1)。在我的机器上，socket.getaddrinfo() 会给我一个或两个，但前提是我没有其他可用的接口。

出于我的需要，我想尝试在每个可用接口上的指定端口上打开一个 UDP 套接字，这就是代码中包含“端口”和 socket.SOCK_DGRAM 的原因。更改它们是安全的，例如，如果您没有考虑端口。

```
addrinfo_ipv4 = socket.getaddrinfo(hostname,port,socket.AF_INET,socket.SOCK_DGRAM)
addrinfo_ipv6 = []
try:
    addrinfo_ipv6 = socket.getaddrinfo(hostname,port,socket.AF_INET6,socket.SOCK_DGRAM)
except socket.gaierror:
    pass
addrinfo = [(f,t,a) for f,t,p,cn,a in addrinfo_ipv4+addrinfo_ipv6]
addrinfo_local = [(socket.AF_INET,socket.SOCK_DGRAM,('127.0.0.1',port))]
if addrinfo_ipv6: 
    addrinfo_local.append( (socket.AF_INET6,socket.SOCK_DGRAM,('::1',port)) )
[addrinfo.append(ai) for ai in addrinfo_local if ai not in addrinfo] 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-10-10T03:53:27.703

此代码段将提供系统中所有可用 IPV4 地址的列表。

```
import itertools
from netifaces import interfaces, ifaddresses, AF_INET

links = filter(None, (ifaddresses(x).get(AF_INET) for x in interfaces()))
links = itertools.chain(*links)
ip_addresses = [x['addr'] for x in links] 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-03-03T15:17:34.583

你可以像这样很容易地做到这一点：

```
import netifaces

for interface in netifaces.interfaces():
    print netifaces.ifaddresses(interface) 
```

有关更多信息，您可以查看[netifaces 文档](https://pypi.python.org/pypi/netifaces)。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-01-24T03:28:37.937

我认为@Harley Holcombe 的答案是可行的，但是如果您有一些没有 ip 的虚拟网卡，则会出错。所以这是我修改的：

```
def get_lan_ip():
for interface in interfaces():
    try:
        for link in ifaddresses(interface)[AF_INET]:
            if str(link['addr']).startswith("172."):
                return str(link['addr'])
    except:
        pass 
```

这只会返回你的局域网 ipv4

# computer-science - 36进制后用什么符号

> ID：270747
> 
> 赞同：24
> 
> 时间：2008-11-06T23:21:31.953
> 
> 标签：computer-science

由于Hex（base 16）使用0-9A-F，并且（我在这里假设）Base 17使用0-9A-G等等。0-9A-Z用完后用什么符号。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-11-06T23:23:33.523

好吧，看看[base 64](http://en.wikipedia.org/wiki/Base64) : 0-9, AZ, az 然后是几个符号，具体取决于上下文。（Web 的 Base64 往往与其他方案不同，以避免 URL/HTML 编码问题。）

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-11-06T23:28:09.210

你的问题没有标准答案。“Base 36”恰巧说起来很方便，因为：

1.  十六进制通常使用 0-9a-f，因此继续遍历字母表是“显而易见的”。
2.  罗马/ASCII 字母在“z”处用尽。
3.  从数学的角度来看，以 36 为底（不管你如何表示它）有点有趣，因为 36 有很多除数。

但是，对于在“z”之后可以冒险进入的字符序列，没有普遍接受的约定。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-11-06T23:28:39.863

数字时钟（以 60 为基数）使用以 10 为基数的数字作为符号，并用分隔符（如“:”）分隔它们。这样你就永远不会用完符号！

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-07-30T07:28:59.690

巴比伦人使用以 10 为基数的六十进制数学分组来形成各个 60 位的以 60 为基数的数字。（这是我们获得角度和时间中使用的所有以 60 为底的数学的地方。）这可能是使用以 10 为底的数字创建某种形式的以 N 为底的数字的方法的最古老的先例。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-11-06T23:23:13.150

[Base64](http://en.wikipedia.org/wiki/Base64)添加小写字符和 + 和 /。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-10-06T11:20:39.953

编写 IPv4 地址的标准方法可以视为以 256 为基数的表示形式，其中十进制数以点分隔。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2010-06-04T04:22:36.553

好吧，有base64，然后是口袋妖怪角色

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-14T09:15:49.670

我会选择 0-9，然后是 AZ 大写字母，然后是小写字母的 alpha 到 omega。这会让你达到 60 岁。在那之后，我会接受杰里米的回答。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-06-04T04:26:29.543

这很简单：0..9 ++ A..Z ++ a..z ++ 阿..中。再简单不过了。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-10-21T11:41:57.177

我想说希腊语和希伯来语是两个可能的候选者，因为它们用于数学。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-10-14T17:03:55.943

可能是中文？维基百科说康熙字典有47035个字！

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-10-28T02:33:04.403

[RAD50](http://en.wikipedia.org/wiki/RADIX-50)达到 40（八进制为 50），并没有完全遵循这个顺序。但当时十六进制并不常见。也不是小写。

# java - soundex算法的数据结构？

> ID：270771
> 
> 赞同：2
> 
> 时间：2008-11-06T23:28:49.007
> 
> 标签：java, data-structures, soundex

谁能建议我使用[soundex 算法](http://en.wikipedia.org/wiki/Soundex)程序的数据结构？使用的语言是Java。如果有人以前在 Java 中做过这方面的工作。该程序应具有以下功能： 能够阅读大约 50,000 个单词 应该能够阅读一个单词并返回具有相同 soundex 的相关单词

我不希望程序实现只是关于使用什么数据结构的一些建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T23:34:44.063

提示：如果您使用 SQL 作为数据后端，那么您可以让 SQL 使用两个 sql 函数 SOUNDEX 和 DIFFERENCE 来处理它。

也许不是你想要的，但是很多人不知道 MSsql 有这两个功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T23:35:13.750

soundex 可以通过字符串直接传递来实现，因此不需要任何特殊的东西。

之后，可以将 4 个字符的代码视为整数键。

然后只需构建一个字典来存储由该整数键索引的单词集。50,000 个单词应该很容易被记忆，所以不需要花哨的东西。

然后查字典，每个桶都是一组发音相似的单词。

实际上，这是 perl 中的整个程序：

```
#!/usr/bin/perl
use Text::Soundex;
use Data::Dumper;
open(DICT,"</usr/share/dict/linux.words");
my %dictionary = ();
while (<DICT>) {
        chomp();
        chomp();
        push @{$dictionary{soundex($_)}},$_;
}
close(DICT);
while (<>) {
        my @words = split / +/;
        foreach (@words) {
            print Dumper $dictionary{soundex($_)};
        }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T00:13:18.103

```
class SpellChecker
{

  interface Hash {
    String hash(String);
  }

  private final Hash hash;

  private final Map<String, Set<String>> collisions;

  SpellChecker(Hash hash) {
    this.hash = hash;
    collisions = new TreeSet<String, Set<String>>();
  }

  boolean addWord(String word) {
    String key = hash.hash(word);
    Set<String> similar = collisions.get(key);
    if (similar == null)
      collisions.put(key, similar = new TreeSet<String>());
    return similar.add(word);
  }

  Set<String> similar(String word) {
    Set<String> similar = collisions.get(hash.hash(word));
    if (similar == null)
      return Collections.emptySet();
    else
      return Collections.unmodifiableSet(similar);
  }

} 
```

散列策略可以是 Soundex、Metaphone 或你有的。某些策略可能是可调的（输出多少字符等）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T23:34:30.320

我相信您只需要将原始字符串转换为 soundex 键到哈希表；表中每个条目的值将是映射到该 soundex 的原始字符串的集合。

[Google Collections](http://code.google.com/p/google-collections/)中的 MultiMap 集合接口（及其实现）对您很有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T23:35:18.727

由于 soundex 是一个哈希，我会使用一个哈希表，其中 soundex 作为键。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-01T15:48:38.760

你想要一个 4 字节的整数。

soundex 算法总是返回一个 4 个字符的代码，如果您使用 ANSI 输入，您将返回 4 个字节（表示为 4 个字母）。

因此，将返回的代码存储在哈希表中，将您的单词转换为代码并在哈希表中查找。它真的那么容易。

# perl - 我可以将 cperl 模式与 perl 模式着色一起使用吗？

> ID：270772
> 
> 赞同：9
> 
> 时间：2008-11-06T23:29:46.147
> 
> 标签：perl, emacs, cperl-mode

Emacs cperl 模式似乎比 perl 模式更容易混淆，但吃喝玩乐效果让我无法使用它。有没有人知道或知道一个 .emacs 块的示例，它导致 cperl-mode 使用 perl-mode 的着色，理想情况下以足够可读的形式，我可以返回并一次打开一个元素的默认颜色直到我找到我喜欢的东西？

特别是对于一些我觉得很不可读的内置函数，有一种可怕的浅绿色阴影，我更喜欢我的变量没有前导`$`，`$$`并且与变量名一起被染成红色。其余的大部分只是分散注意力。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-14T10:38:27.647

按 Mx customize-group RET cperl-faces RET 并根据自己的喜好更改颜色。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-05-05T19:48:31.387

对于颜色主题，问题仅限于数组和散列 - 事实证明，这是因为 cperl-mode 将这些面定义为粗体，颜色主题似乎不会影响（[Solarized](http://ethanschoonover.com/solarized)不会）。

在 Mac OS 上的 Emacs 23.3 中，以下内容将颜色恢复为颜色主题定义它们的方式：

```
(custom-set-faces
 '(cperl-array-face ((t (:weight normal))))
 '(cperl-hash-face ((t (:weight normal))))
) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-26T03:58:42.083

您还可以通过使用 perl 模式覆盖字体锁定设置来使用“真正的”perl 模式着色。

```
(require 'perl-mode)

(add-hook 'cperl-mode-hook
          (lambda ()
            (setq font-lock-defaults
                  '((perl-font-lock-keywords perl-font-lock-keywords-1 perl-font-lock-keywords-2)
                    nil nil ((?\_ . "w")) nil
                    (font-lock-syntactic-face-function . perl-font-lock-syntactic-face-function)))
            (font-lock-refresh-defaults))) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T07:20:08.320

如果您不喜欢特定的默认颜色，可以更改[颜色主题。](http://www.emacswiki.org/emacs/ColorTheme)

# java - 推荐的 Java/AJAX 设计模式？

> ID：270778
> 
> 赞同：2
> 
> 时间：2008-11-06T23:33:31.477
> 
> 标签：java, ajax

我们需要一些关于在 Java 应用程序中使用 AJAX 的良好设计模式的意见。

**考虑一个简单的场景：**

1.  用户单击一个按钮，该按钮向 Java 方法发送请求以从 DB 获取数据。
2.  Java对象是方法返回的，需要转换成HTML表格。
3.  HTML 表格显示在 JSP 上。

**我们目前所做的：**

1.  在 JSP 页面上，用户单击“显示用户”按钮
2.  使用 Prototype.js 的按钮调用“中间人”JSP，该 JSP 将请求转发到 Java 方法以从数据库中获取数据。
3.  该方法将 Java 对象返回给将 Java 对象转换为 HTML 的“中间人”JSP（因为来自调用 JSP 的 AJAX 调用将无法直接处理 Java 对象）。
4.  然后将 HTML 返回到 Prototype 调用，该调用会更新调用 JSP 上的 div。

**我们的担忧是：**

1.  我们希望保持业务/表示逻辑的分离，并且不希望在我们的 Java 方法中使用 HTML/JavaScript 代码。
2.  牢记 (1)，拥有一个“中间人”JSP 是一种可行的方法吗？还是应该将 Java 对象作为 XML/XSLT 返回给 AJAX 请求？
3.  我们正在做的上述方式只有很少的 JavaScript 并且适用于所有浏览器。
4.  我们查看了其他一些包——DWR、GWT，但要么对 JavaScript 有太多依赖，要么需要 UI 组件才能出现在 Java 类中。

我们上面的做事方式OK吗？还是有其他更好的方法？

任何帮助/想法将不胜感激。

谢谢，

SP

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-07T00:03:48.637

听起来不错。您正在将视图组件与模型组件分开。不管调用是如何到达服务器的，AJAX 与否，它都应该由与模型交互的控制器（例如 servlet）接收，这就是你的 Java 类，它从数据库中获取数据并转发到用于呈现视图的 JSP 页面。

有些框架可以简化样板代码，但您描述的设计听起来不错。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T02:35:54.150

我不确定您是否注意到，但您的解决方案与文森特提出的方案之间存在显着差异。这就是请求最初应该由 servlet（或控制器，或 Struts 动作等）而不是“中间人”JSP 接收。

MVC 规定 JSP 应该仅用于从模型数据生成视图，流控制在 Java 代码中更好地处理。

# jms - 有没有办法从 JMS 消息中获取源 IP 地址？

> ID：270788
> 
> 赞同：6
> 
> 时间：2008-11-06T23:36:33.577
> 
> 标签：jms

我有一个系统，其中不同的服务器进程正在处理通过 JMS 代理从各种客户端作为 JMS 消息传递的请求。

我正在尝试确定消息的来源。有没有办法获取 IP 或一些关于来源的识别信息？

澄清：我已经有未知用户部署的客户端，所以我试图避免更改消息类......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-10T10:55:33.130

There is an optional JMS header mentioned in the JMS specification called *JMSXUserID* which which identifies the user sending a message (which the broker validates and ensures is correct to avoid spoofing) which some JMS providers support.

For example here is [how to enable it in Apache ActiveMQ](http://activemq.apache.org/jmsxuserid.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T01:18:38.957

我不相信。至少我找不到方法。

如果您需要将回复发送回消息源，您可以让发送方设置“JMSReplyTo”属性并回复回该目的地。

或者，您可以稍微更改您的消息传递模式并嵌入源信息消息本身。发送者将在消息中表明自己的身份，而接收者可以从那里读取它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T03:51:32.190

如果您可以控制正在发送的消息的构造，则始终可以将 IP 地址作为属性添加到消息中。然后您可以使用Message 上的[getStringProperty](http://java.sun.com/j2ee/sdk_1.3/techdocs/api/javax/jms/Message.html#getStringProperty(java.lang.String))方法检查该值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T03:51:55.557

如果您控制发送消息的客户端的代码，您可以发明一些属性名称，例如“IPOfSender”，并使用 Message.setStringProperty() 在每条消息中包含该属性。

```
// client code
String myIPString = ...;
Message m = session.createTextMessage();
m.setStringProperty("IPOfSender", myIPString);
... 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-07T04:52:44.453

它取决于您的 JMS 服务器。某些服务器具有允许您查看连接详细信息的管理工具/API。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-09T21:19:32.227

Using glassfish, if you look at the getJMSMessageID() of the message, you should see a string to the effect of "ID:40-192.168.0.242(f5:62:c6:58:22:6f)-52506-122885191641". It appears as though the IP is a substring of the message id.

Please note that this is what I can see under our setup, so there may be other factors at play (ie. spring), but I know that string wasn't created by us programatically.

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-01-02T16:06:08.463

Short answer: NO

# xml - 如何使用 XmlSerializer 类反序列化这个简单的 xml 配置？

> ID：270792
> 
> 赞同：0
> 
> 时间：2008-11-06T23:39:09.657
> 
> 标签：xml, xml-serialization, xsd.exe

我有以下 xml 我想反序列化为一个类

```
<?xml version="1.0" encoding="utf-8" ?>
<root>
  <element1>String1</element1>
  <element2>String2</element2>
</root> 
```

我正在尝试将其序列化为以下类：

```
 [XmlRoot("root")]
    public class root
    {
        [XmlElement("element1")]
        internal string element1 { get; set; }

        [XmlElement("element2")]
        internal string element2 { get; set; }
    } 
```

当我尝试使用以下代码对其进行反序列化时，配置对象被实例化，但字符串为空。

```
 using (TextReader reader = new StreamReader(configFile))
        {
            XmlSerializer serializer = new XmlSerializer(typeof(root));
            this.config = (root)serializer.Deserialize(reader);
        } 
```

我尝试使用 xsd.exe 创建一个 xsd，然后基于它创建一个类，但是该工具产生了太多混乱。我想我在这里很近。我错过了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-06T23:46:31.747

您不能序列化/反序列化内部属性 - 它们必须是公开的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-06T23:51:26.837

关于您问题的性质，我同意布罗迪的观点。但是，您可能反对公开这些字段。我过去处理这个问题的方法是创建一个可序列化的类，其唯一目的是读/写 .xml 并使其所有字段都公开。然后创建一个新类，它是外部接口。它将可序列化类作为构造函数的参数，外部类提供公共属性来控制对可序列化类的访问。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-10T19:50:31.393

为了跟进我的实现......我最终放弃了一起使用 XmlSerializer 类。我反序列化的类非常复杂，并且包含需要序列化的其他对象的列表。我必须添加到我的类中的属性数量使[代码很臭](http://en.wikipedia.org/wiki/Code_smell)

我最终使用 Linq to XML 进行反序列化......类声明的复杂性下降了，但 linq 语句最终变得相当复杂。

如果我再做一次，我可能会考虑使用 WCF 和 datacontract 序列化程序......这也可能很难做到。

我很好奇这些天人们是如何将 xml 文档反序列化为对象的。在了解了 Linq 语句之后，我认为这可能是要走的路。对象的创建要简单得多，而且它们不需要公开。看起来 XmlSerializer 是“老派”，而 Linq to XML 更像是“新派”。

我很想听听别人怎么说。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-13T01:22:40.053

您可以使用 XSD.exe 从 XSD（XML 架构定义）生成一个类。这会产生一个可用的类结构，可以序列化和反序列化相关的 XML。

# c# - 需要一个等效的 XNA 框架，可以与 system.windows.forms 一起使用（它不必与 XBox 360 一起使用）

> ID：270798
> 
> 赞同：-1
> 
> 时间：2008-11-06T23:40:15.377
> 
> 标签：c#, winforms, forms, frameworks, xna

下学期我将参加“软件实践 II”课程。在那堂课上，我的教授要我们学习 XNA。我玩 XNA 已经有一段时间了，喜欢它的功能性和简单性。但是，XNA 没有利用 System.Windows.Forms。使用[CEGUI#](http://www.nuclex.org/news/2007/01/14/ceguisharp)我能够让 XNA 与 System.Windows.Forms 一起工作，但它的功能有限（例如，虽然鼠标有“左键单击”和“左键双击”，但它没有“拖”）。

因此，我放弃了 XNA，转而使用了一个新框架。这是我的问题——>是否有一个 C# 框架具有 XNA 的所有功能和简单性，但也与 System.Windows.Forms 完全兼容（或者，如果我使用的话，至少与 System.Windows.Forms 完全兼容第三方工具）？该框架不必与 XBox360 一起使用 - 它只需要与 Windows XP 和 Windows Vista 一起使用。我希望它具有与 XNA 相似的语法（换句话说，具有类似的方法，如 LoadContent、Draw 和 Update）。

感谢您的时间，

~本舒姆斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-07T04:04:03.473

我会推荐 SlimDX

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T04:19:40.743

我很想知道你为什么要解雇 XNA。您能否详细说明您正在尝试做什么以及为什么与 Windows 窗体的连接如此重要——以及更准确地说是什么不起作用？我的建议是至少尝试坚持使用 XNA——它似乎无处可去，只能向上，而且从我所看到的情况来看似乎真的很光滑。我会调查你觉得不能使用 XNA 的各种原因，看看是否可以以某种方式解决这些问题。

但是，我也完全有可能不明白你想要做什么。如果是这样，我很抱歉！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T04:25:52.383

拖动只是鼠标按钮按下时移动的包装器，这当然很容易做到。我也很好奇 Windows 窗体有哪些你不能在 XNA 中做的事情（除了很明显的绘制 UI 窗口，你可以在 XNA 中做，但不能用于主窗口）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T17:35:59.857

如果你只是使用 SpriteBatch，在 Windows 窗体中创建兼容的 API 可能不会那么难，但如果你想做 3D 或着色器，那就更难了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T23:52:00.613

您可以尝试 Managed DirectX（MDX - 在那里转向“不受支持”的领域）、[SlimDX](http://slimdx.mdxinfo.com/)甚至 WPF 3D ...

# mysql - 为什么 Hibernate/JDBC/MySQL 在一天左右后会断开连接？

> ID：270800
> 
> 赞同：14
> 
> 时间：2008-11-06T23:41:43.940
> 
> 标签：mysql, hibernate

我有几个服务器进程偶尔会响应来自客户端的消息并执行只读事务。

服务器运行大约几天后，它们停止正常工作，当我检查时发现有一大堆关于连接被关闭的消息。

当我检查它时，事实证明默认情况下休眠在某种开发模式下工作，几个小时后连接就会断开，我开始使用 c3po 进行连接池。

但是，即使使用 c3po，在服务器启动后大约 24 小时左右我也会遇到这个问题。

有没有人遇到过这个问题并知道如何解决？我对配置休眠的复杂性不够熟悉。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-07T00:08:10.563

MySQL JDBC 驱动程序在 8 小时不活动后超时并断开连接。

您可以`autoReconnect=true`在 JDBC URL 中设置，如果您在断开连接后尝试查询，这会导致驱动程序重新连接。但这有副作用；例如会话状态和事务不能通过新连接维护。

如果使用`autoReconnect`，将重新建立 JDBC 连接，但它不会自动重新执行出现异常的查询。因此，您确实需要`SQLException`在您的应用程序中捕获并重试查询。

阅读[http://dev.mysql.com/doc/refman/5.0/en/connector-j-reference-configuration-properties.html](http://dev.mysql.com/doc/refman/5.0/en/connector-j-reference-configuration-properties.html)了解更多详情。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-11T07:13:43.783

MySql 基本上默认在**8 小时内**超时。

我遇到了同样的异常并在忙碌了 3 天后解决了这个问题。检查你是否使用 I hibernate3。在此版本中，需要明确提及连接类名称。还要检查 jar 是否在类路径中。检查以下链接中的步骤和评论

[http://hibernatedb.blogspot.com/2009/05/automatic-reconnect-from-hibernate-to.html](http://hibernatedb.blogspot.com/2009/05/automatic-reconnect-from-hibernate-to.html)

消除`autoReconnect=true`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-08-04T23:21:23.397

我通过添加这些行更改了我的休眠配置文件，它现在可以工作：

```
 <property name="connection.autoReconnect">true</property>
    <property name="connection.autoReconnectForPools">true</property>
    <property name="connection.is-connection-validation-required">true</property> 
```

我认为使用 c3p0 池更好并且被推荐，但是这个解决方案现在正在工作并且不存在蚂蚁问题。
我让 Tomcat 开启 24 小时，连接没有丢失。
请试一试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-07T01:11:02.077

我建议，在几乎任何客户端/服务器设置中，在不需要时保持连接打开是一个坏主意。

我正在专门考虑 DB2/z 连接，但它同样适用于所有服务器（数据库和其他）。这些连接消耗了服务器上的资源，而这些资源可以在其他地方得到最好的利用。

如果您要在有数以万计的客户端连接到数据库的公司环境中保持连接打开，您甚至可能会让大型机屈服。

我完全赞成连接池的想法，但不太赞成尝试永远保持单个会话打开的想法。

我的建议如下：

1/ 在你的连接池中有三种连接：

*   关闭（因此实际上不在**您**的游泳池中）。
*   准备好，意思是打开但没有被客户使用。
*   活跃的，意思是客户正在使用。

2/ 让您的连接池保持少量就绪连接，最小 N 和最大 M。N 可以根据客户端请求连接的峰值速度进行调整。如果就绪连接数下降到零，则需要更大的 N。

3/当客户端想要一个连接时，给他们一个准备好的（使其处于活动状态），然后如果现在准备好的少于N个，则立即打开一个新的（但不要让客户端等待此完成，或者您将失去汇集的优势）。这确保始终有至少 N 个就绪连接。如果当客户想要一个时没有准备好，他们将不得不等待你创建一个新的。

4/ 当客户端完成一个活动连接时，如果准备好的连接少于 M 个，则将其返回到准备好的状态。否则关闭它。这可以防止您拥有超过 M 个准备好的连接。

5/ 定期回收准备好的连接以防止陈旧的连接。如果有超过 N 个就绪连接，只需关闭最旧的连接。否则关闭它并重新打开另一个。

这样做的好处是在您的连接池中有足够的就绪**和年轻的连接可用，而不会使服务器过载。**

# windows - 在 Windows 中，如何从命令提示符将快捷方式运行到后台？

> ID：270811
> 
> 赞同：1
> 
> 时间：2008-11-06T23:47:44.427
> 
> 标签：windows, dos

```
cmd /C "myshortcut1.lnk"
cmd /C "myshortcut2.lnk" 
```

工作，但给了我一个弹出的 DOS 窗口，当它关闭时，会杀死我的两个加载的程序。这也是如此：

```
start /B cmd /C "1.lnk"
start /B cmd /C "2.lnk"
start /B cmd /C "3.lnk"
start /B cmd /C "4.lnk" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T23:49:10.213

尝试`start`：

```
start myshortcut1.lnk
start myshortcut2.lnk 
```

我现在附近没有要测试的 Windows 机器，但应该可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T23:56:57.293

你试过这个吗？

```
C:\> my_shortcut.lnk 
```

# sql - 我应该在 SQL Server 创建的表上删除并创建索引吗？

> ID：270817
> 
> 赞同：2
> 
> 时间：2008-11-06T23:49:32.707
> 
> 标签：sql, sql-server, indexing, defragmentation

为了摆脱重建和碎片整理留下的一些碎片，我们认为我们会删除并创建索引，所以我开始编写一个脚本。

它识别需要工作的聚集索引并删除索引和主键并重建表的索引和主键。

这是我遇到的问题：SQL Server 使用自己独特的命名系统根据统计信息创建了很多自己的索引。

问题：我只想删除和创建我们创建的索引，还是我想删除所有索引并只创建我们创建的索引，或者我们想删除所有索引，包括 SQL Server 制作的索引，并创建所有索引，包括SQL Server 制作的那些？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-07T00:05:20.803

您始终可以对索引进行碎片整理，这比删除和重新创建要容易。[在这篇文章中](http://www.mssqlcity.com/Articles/Adm/index_fragmentation.htm)有一个关于如何做到这一点的不错的解释。

# php - 可扩展的基于规则的访问模式

> ID：270822
> 
> 赞同：3
> 
> 时间：2008-11-06T23:51:49.957
> 
> 标签：php, design-patterns, oop, refactoring, rule-engine

我使用一些 PHP 逻辑控制对我的一些静态 Web 资源的访问。因为通过网络服务器的基于目录的授权不适合或不容易实现。

事物的组合决定了访问是被授予还是被拒绝。而且这些规则会不时改变。

一开始它是一个简单的正则表达式路径匹配，以及一个会话变量的检查。现在更复杂了，因为涉及到更多变量。

我想知道如何进行重构，以便快速轻松地更改规则。当它是一个简单的“如果这个和这个，然后交付，否则 403”。直接用 PHP 就可以了。现在条件更加复杂，并且有几个嵌套级别，每个嵌套都有共同但略有不同的条件。这一切都很容易重构，但它不是最直观和最容易更新的。

我在想两件事之一。

1.  为每个顶级条件建立类，并使用策略工厂来选择正确的授权。从包含公共位的基类中派生它们，并重载任何必要的东西。我认为当某些条件发生变化时，这仍然容易出现一些混乱。

2.  制作一个简单的引擎来迭代一个 2d 有序规则数组，类似于防火墙规则。就像是：`<allow|deny>, <auth_group>, <path_regex>, <other vars>`

我还没有完全考虑过这一点，但它似乎更容易更新，也更容易作为人类阅读。

你会怎么做？我可以为此使用已建立的模式或库吗？

前段时间我在另一个应用程序中遇到了类似的问题。我想要一种基于多个条件级别将规则和结果链接在一起的简单更新方式。这并不像那个应用程序那么复杂，但我很想听听人们用来解决这类问题的模式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T00:12:29.510

您可能想查看[Zend_Acl](http://framework.zend.com/manual/en/zend.acl.html)，它是一个面向对象的 PHP 类，用于管理资源层次结构的权限层次结构。您可能无法按原样使用此组件，但它可以让您深入了解如何实现自己的系统。

Zend_Acl 是 Zend Framework PHP 5 类库的一部分，但与 ZF 中的许多类一样，Zend_Acl 可以独立使用。无需使用 Zend Framework 的其余部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T00:12:25.097

您还可以使用小型逻辑引擎（想想 prolog）来轻松陈述事实和规则，这将允许您快速查询是否应该允许访问资源。像这样的基于逻辑的规则引擎通常非常有效，并且应该允许您非常轻松地为此类问题域建模解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T18:03:17.093

我会使用[规范模式](http://en.wikipedia.org/wiki/Specification_pattern)。它允许您组合规则。您甚至可以创建一个类来表示将在`IsSatisfiedBy()`方法中运行（遵循模式）的复合规则。

# c# - Delegate calling generic method inside of a generic class pegs CPU during deserialization

> ID：270825
> 
> 赞同：2
> 
> 时间：2008-11-06T23:52:56.693
> 
> 标签：c#, generics, serialization

Has anyone else run into this problem before? I've got a method that calls a generic method with a delegate, inside of a generic class. I've marked the class as Serializable, and it serializes without complaint. But, when I try to deserialize an object of this class, it pegs the CPU and hangs the machine.

Code example:

```
public delegate T CombinationFunctionDelegate<T,U,V>(U a, V b);

    [Serializable]
public class SDictionary<TKey, TValue> : Dictionary<TKey, TValue>
{
    public SDictionary()
        : base()
    {
    }

    protected SDictionary(SerializationInfo info, StreamingContext context)
        : base(info, context)
    {}

    [SecurityPermissionAttribute(SecurityAction.LinkDemand, Flags = SecurityPermissionFlag.SerializationFormatter)]
    public override void GetObjectData(SerializationInfo info, StreamingContext context)
    {
        base.GetObjectData(info, context);
    }

    public List<ListItem> ToListItems()
    {
        return Convert(delegate(TKey key, TValue value)
        {
            return new ListItem(key.ToString(), value.ToString());
        });
    }

    public List<U> Convert<U>(CombinationFunctionDelegate<U, TKey, TValue> converterFunction)
    {
        List<U> res = new List<U>();
        foreach (TKey key in Keys)
            res.Add(converterFunction(key, this[key]));

        return res;
    }
} 
```

I can put an instance of this class into ViewState (for example) just fine, but when I try to extract the object from ViewState again, the CPU on the machine spikes and the deserialization call never returns (ie, infinite loop).

When I remove the ToListItems() method, everything works wonderfully. Is this really weird, or do I just not understand serialization? =)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T00:31:54.027

This is the code I currently have, which works fine?

```
 [Serializable]
    public class SDictionary<TKey, TValue> : Dictionary<TKey, TValue>
    {
        public SDictionary()
            : base()
        {
        }

        protected SDictionary(SerializationInfo info, StreamingContext context)
            : base(info, context)
        {
        }

        public List<ListItem> ToListItems()
        {
            return this.Convert(delegate(TKey key, TValue value)
            {
                return new ListItem(key.ToString(), value.ToString());
            });
        }

        public List<U> Convert<U>(CombinationFunctionDelegate<U, TKey, TValue> converterFunction)
        {
            List<U> res = new List<U>();
            foreach (TKey key in Keys)
                res.Add(converterFunction(key, this[key]));

            return res;
        }

    }

    class Program
    {

        static void Main(string[] args)
        {
            SDictionary<string, string> b = new SDictionary<string, string>();
            b.Add("foo", "bar");

            System.IO.MemoryStream memStream = new System.IO.MemoryStream();
            System.Runtime.Serialization.Formatters.Binary.BinaryFormatter f = new System.Runtime.Serialization.Formatters.Binary.BinaryFormatter();
            f.Serialize(memStream, b);
            memStream.Position = 0;

            b = f.Deserialize(memStream) as SDictionary<string, string>;
        }

    } 
```

Does that help at all?

Edit: Tweaked again.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T00:08:35.290

First of all, Dictionary<> already implements ISerializable, so you don't need to specify that explicity!

Second, you override GetObjectData(), but you don't seem to call Dictionary.GetObjectData(), so the dictionary may not be getting deserialised? Hence, when you access this.Keys, you end up with "an issue".

Yes, I'm thinking out loud here ;)

Perhaps you could try this:

```
public override void GetObjectData(SerializationInfo info, StreamingContext context)
{
  // deserialize the dictionary first
  base.GetObjectData(info, context);

  // the rest of your code
  // ...
} 
```

I haven't tried or compiled this, but it could be something to consider?

Good luck :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T01:47:19.367

Could it be that the anonymous method has a reference to the instance that it resides in? I can't answer that.

Your comment indicates that this is possible. Here's the simplest way out: don't use anonymous methods.

```
public ListItem ToListItem(TKey key, TValue value)
{
  return new ListItem(key.ToString(), value.ToString());
} 
```

* * *

What I can answer, is that the methods on this class can be issued against the public contract of Dictionary< T, U >, and so there is no need for this class when you could write extension methods against Dictionary< T, U > (assuming C# 3)

Something like this (freehand code so may not be 100% correct)

```
public static List<ListItem> ToListItems(this Dictionary<T, U> source)
{
  return source
    .Select(x => new ListItem(x.key.ToString(), x.value.ToString()))
    .ToList();
}

public static List<V> Convert<V>
(
  this Dictionary<T, U> source,
  Func<T, U, V> converterFunction
)
{
  return source
    .Select(x => converterFunction(x.Key, x.Value))
    .ToList();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T13:55:09.663

Are you using VS2008 SP1? There's a known problem with SP1.
[https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=361615](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=361615)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-07T18:25:46.310

Here's the [knowledge base article](http://support2.microsoft.com/kb/957543) on the bug, too, if anyone needs it:

> On a computer that is running the Microsoft .NET Framework 3.5 Service Pack 1 (SP1), you have an application that serializes and deserializes a generic class. If the generic class has at least one static member, you may encounter one of the following symptoms:
> 
> *   If the application is running as a 32-bit process, the thread that performs the deserialization may enter a loop. Therefore, the application fails, and the application consumes lots of CPU resources.
> *   If the application is running as a 64-bit process, an exception is thrown, and you receive an error message that resembles the following:

# wpf - 几年内将桌面应用程序国际化……我们现在应该做什么？

> ID：270829
> 
> 赞同：17
> 
> 时间：2008-11-06T23:55:09.747
> 
> 标签：wpf, winforms, internationalization

因此，我们确信我们将把我们的产品推向国际，并最终需要将其国际化。在我们进行的过程中，您建议我们进行多少国际化？

我想换句话说，是否有任何国际化现在很容易，但如果我们让代码库成熟，并且如果我们选择现在开始这样做不会让我们非常慢，那么国际化会变得更糟吗？

使用的技术：C#、WPF、WinForms

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-11-06T23:58:30.163

现在就准备好，然后再将所有字符串写入代码库本身。

现在以后的一切都为时已晚。机不可失，勿失良机！

确实，现在做好准备需要付出一些额外的努力，但不这样做最终会变得更加昂贵。

如果您不遵循以下链接中的所有指南，请至少注意摘要的第 1,2 和第 7 点，这些点现在做起来非常便宜，并且在我的经验中会导致最大的痛苦。

查看这些指南，亲自了解为什么现在开始并做好一切准备会更好。

1.  [开发世界就绪的应用程序](http://msdn.microsoft.com/en-us/library/h6270d0z(VS.71).aspx)

2.  [开发世界就绪应用程序的最佳实践](http://msdn.microsoft.com/en-us/library/w7x1y988(VS.71).aspx)

少量提取物：

1.  将所有可本地化的资源移动到单独的纯资源 DLL。可本地化资源包括用户界面元素，例如字符串、错误消息、对话框、菜单和嵌入式对象资源。*（之后将资源移动到 DLL 会很痛苦）*
2.  不要硬编码字符串或用户界面资源。*（如果你不准备，你知道你会硬编码字符串）*
3.  不要将不可本地化的资源放入纯资源 DLL。这给翻译者带来了困惑。
4.  不要使用在运行时从连接的短语构建的复合字符串。复合字符串很难本地化，因为它们通常采用不适用于所有语言的英语语法顺序。*（界面设计后，词组变难了）*
5.  避免模​​棱两可的结构，例如“空文件夹”，其中的字符串可以根据字符串组件的语法角色进行不同的翻译。例如，“empty”可以是动词也可以是形容词，这会导致意大利语或法语等语言的不同翻译。*（同样的问题）*
6.  避免在应用程序中使用包含文本的图像和图标。它们的本地化成本很高。*（使用在图像上渲染的文本）*
7.  在用户界面中为字符串长度留出足够的空间来扩展。在某些语言中，短语可能需要多出 50-75% 的空间。*（同样的问题，如果你现在不打算，重新设计会更贵）*
8.  使用 System.Resources.ResourceManager 类根据文化检索资源。
9.  使用 Microsoft Visual Studio .NET 创建 Windows 窗体对话框，以便可以使用 Windows 窗体资源编辑器 (Winres.exe) 对它们进行本地化。不要手动编写 Windows 窗体对话框。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-07T00:04:23.800

恕我直言，声称“几年后”会发生某些事情，字面意思是“我们希望有一天”，这实际上意味着“永远不会”。尽管我仍然会浏览各种教程以确保您不会犯任何可怕的错误。现在做正确的国际化支持将意味着未来的工作量更少，一旦你习惯了它，它不会对今天的生产力产生任何实际影响。但如果你可以用几年来衡量目标，也许现在根本不值得去做。

我参与了两个国际化项目：一个 C# ASP.NET（在我加入项目之前就存在）应用程序和一个 PHP 应用程序（使用免费的国际化控件和我自己的管理应用程序自制了我自己的方法）。

您应该将所有文本（标签、按钮文本等）作为数据存储在数据库中。用键引用这些（我更喜欢使用前 4 个单词，大写，转换为下划线的空格和去除非字母数字），当你有重复时，在末尾附加一个数字。这种密钥方法的好处是程序员只需看一下密钥就可以很好地理解文本的内容。

编写一个实用程序来提取数据并构建您添加到项目中以进行编译的 .NET 资源文件。为每种语言创建一个单独的资源文件。在您的代码中，使用键指向正确的条目。

我会浏览有关该主题的 MS 文档：http: [//www.microsoft.com/globaldev/getwr/dotneti18n.mspx](http://www.microsoft.com/globaldev/getwr/dotneti18n.mspx)

一些基本的事情要避免：

*   从未使用过翻译软件，聘请专业人士或实习生在当地大学学习该语言
*   永远不要尝试通过附加两个现有条目来创建文本，因为每种语言的语法差异很大，这永远不会奏效。因此，如果您有一个显示“单击”的字符串并且想要一个显示“立即单击”的字符串，请不要尝试创建一个合并两个条目的设置，或者在翻译过程中，复制单击的单词并立即翻译该单词。从头开始将每个字符串视为全新的翻译

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-07T00:38:36.243

我将添加以 Unicode（MS SQL 中的 NVARCHAR）存储和操作字符串数据。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T11:45:01.990

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-03-29T09:34:30.143

您可以使用 NGettext.Wpf （它可以从 NuGet 安装，是的，我是作者，但我是从其他答案中列出的挫折中做出来的）。

它托管在这个[github 存储库](https://github.com/robert-j-engdahl/ngettext-wpf)中，这是撰写本文时的入门部分：

NGettext.Wpf 旨在使用依赖注入。您需要在应用程序的入口点调用以下命令：

```
NGettext.Wpf.CompositionRoot.Compose("ExampleDomainName"); 
```

`"ExampleDomainName"`字符串是域名。这意味着当当前文化设置为时，`"da-DK"`翻译将从`"Locale\da-DK\LC_MESSAGES\ExampleDomainName.mo"`相对于您的 WPF 应用程序运行的位置加载（您必须在应用程序中包含 .mo 文件并确保将它们复制到输出目录）。

现在您可以在 XAML 中执行以下操作：

```
<Button CommandParameter="en-US" 
        Command="{StaticResource ChangeCultureCommand}" 
        Content="{wpf:Gettext English}" /> 
```

这展示了这个库的两个特性。最重要的是 Gettext 标记扩展，它将确保`Content`设置为相对于当前文化的“英语”翻译，并在当前文化更改时更新它。它演示的另一个功能是`ChangeCultureCommand`将当前文化更改为给定文化，在这种情况下`"en-US"`。

我还强烈建议阅读gettext 实用程序手册中的[Preparing Strings](https://www.gnu.org/software/gettext/manual/gettext.html#Preparing-Strings)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-29T09:44:44.143

如果您使用测试数据，请使用非英语（例如：俄语、波兰语、挪威语等）字符串。编码在每个角落都可以看到它的小丑头。如果不在您自己的库中，则在外部库中。

我个人偏爱俄语，因为虽然我不会说俄语（尽管我的名字来自于我的名字），但它里面有外国字符，而且它比英语占用更多的空间，因此也测试了你的间距。
不知道这是否是特定于语言的东西，或者仅仅是因为我们的俄语翻译喜欢冗长的字符串。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-29T10:39:10.507

国际化将使您的产品在其他国家/地区可用，这很容易并且应该从一开始就完成（这样全世界说英语的人都可以使用您的软件），这 3 条规则将帮助您顺利实现目标：

1.  支持国际字符 - 在文件和数据库中仅使用 Unicode 数据类型。
2.  支持国际日期、时间和数字格式 - 将数据存储到文件或计算机可读存储时使用 CultureInfo.InvariantCulture，在显示数据或解析用户输入时使用 CultureInfo.CurrentCulture，永远不要自己解析，永远不要使用任何其他文化对象。
3.  用户输入的文本数据应该被认为是一个黑盒子，不要试图将其分解成单词或字母，尤其是在向用户显示时 - 不同的语言有衍射规则，操作系统知道如何从左到 - 显示正确的文字，你没有。

本地化是将软件翻译成不同的语言，这既困难又昂贵，一个好的开始是永远不要硬编码字符串，永远不要用较小的字符串构建句子。

# sharepoint - SharePoint 搜索外部数据库

> ID：270830
> 
> 赞同：3
> 
> 时间：2008-11-06T23:55:22.180
> 
> 标签：sharepoint, search, sharepoint-2007

我们正在考虑创建一个 MOSS 2007 站点，该站点将具有相当动态的组件（外部产品目录）。外部产品将存储在数据库中（不由 SharePoint 管理），所有交互都将通过 Web 部件进行。

是否可以配置 SharePoint 搜索以索引文本内容*和*外部数据库？或者可以编写一个自定义搜索提供程序，它也用于查询外部数据库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T00:21:44.780

业务数据目录旨在作为这种情况下的解决方案。BDC 解决方案可开箱即用。

不幸的是，BDC 需要 SharePoint 的企业许可证，价格大幅上涨。

任何其他解决方案都需要通过将数据包含在 SharePoint 网页本身或一组自定义页面中来连接数据库的 html 接口。

我没有尝试使用自定义搜索提供程序，所以我无法对此发表评论。

由于 OOB SharePoint 提供了区分内容源的能力，并且能够创建允许基于内容类型或 url 创建规则的搜索范围，因此很容易在两个内容源上进行搜索。

# apache-flex - 如何在 Actionscript 中以编程方式将函数绑定到组件？

> ID：270835
> 
> 赞同：3
> 
> 时间：2008-11-06T23:57:20.680
> 
> 标签：apache-flex, actionscript-3, actionscript, flex3

我正在尝试以编程方式为 CategoryAxis 提供我自己的 labelFunction，但我完全被难住了。常规方法是在您的 MXML 文件中执行此操作，但我想在我的 Actionscript 文件中执行此操作。

常规的做法是：

```
<mx:Script>
    <![CDATA[
       private function categoryAxis_labelFunc(item:Object, 
                prevValue:Object, 
                axis:CategoryAxis, 
                categoryItem:Object):String {
                return "Some String";
            }
      ]]>
</mx:Script>

<mx:CategoryAxis labelFunction="categoryAxis_labelFunc" /> 
```

但我想在我的 CategoryAxis 子类中实现相同的目标，例如：

```
public class FauxDateAxis extends CategoryAxis {

    public function FauxDateAxis() {
        super();
        labelFunction = categoryAxis_labelFunc // Doesn't work of course.
    }

        private function categoryAxis_labelFunc(item:Object, 
                prevValue:Object, 
                axis:CategoryAxis, 
                categoryItem:Object):String {
            return "Another String";
    }   

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-10T19:15:53.633

好吧，我对你的问题感到困惑，因为它对我来说绝对没问题。

我从 Adob​​e Flex 站点获取了 CategoryAxis 的示例应用程序：http: [//livedocs.adobe.com/flex/3/langref/index.html](http://livedocs.adobe.com/flex/3/langref/index.html?mx/charts/CategoryAxis.html&mx/charts/class-list.html) ?mx/charts/CategoryAxis.html&mx/charts/class-list.html ，添加了您的代码逐字逐句（除了添加包和导入语句），它的工作方式就像您想要的那样。

在示例中，我修改了该行

```
<mx:CategoryAxis id="haxis" categoryField="Date" title="Date"/> 
```

读书

```
<local:FauxDateAxis id="haxis" categoryField="Date" title="Date"/> 
```

它在每列的底部显示“另一个字符串”。

如果这很重要，我正在使用 Flex 3。

祝你好运，兰迪·施泰格鲍尔

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T06:00:31.350

这个问题让我很好奇，所以我去尝试了。

CategoryAxis 上的 labelFunction 与我在这里看到的签名略有不同。对我来说，这是有效的：

```
function(item:Object, field:String, index:int, pct:Number) 
```

我不是 Flex 图表向导，所以也许你知道一些我不知道的事情，但是当我在这件事上使用那个签名时，

```
public function FauxDateAxis() {
    super();
    labelFunction = function(item:Object, field:String, index:int, pct:Number) {
       return "string";
    }
} 
```

它适用于 Flex 3 Pro。

我看到您提供的代码示例看起来很像[http://blog.flexexamples.com/2007/11/16/creating-a-custom-label-function-on-a-flex-linechart-controls-category-轴/](http://blog.flexexamples.com/2007/11/16/creating-a-custom-label-function-on-a-flex-linechart-controls-category-axis/)（我试图看看是否可以找到您提供的签名示例）。我也看到其他人使用这个签名。

这不是一个很好的答案。我不记得这部分图表 API 在 Flex 2 和 Flex 3 之间发生了变化，但也许这篇文章可以帮助您解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-11T12:58:55.187

只是我，我认为这不会有所作为，但也许将您的标签功能范围更改为受保护而不是私有？？？

# domain-driven-design - 我们都在寻找相同的 IRepository 吗？

> ID：270845
> 
> 赞同：11
> 
> 时间：2008-11-07T00:02:57.423
> 
> 标签：domain-driven-design, design-patterns, irepository

我一直在尝试想出一种方法来编写适用于各种数据存储的通用存储库：

```
public interface IRepository
{
    IQueryable<T> GetAll<T>();
    void Save<T>(T item);
    void Delete<T>(T item);
}
public class MemoryRepository : IRepository {...}
public class SqlRepository : IRepository {...} 
```

我想针对每个中的相同 POCO 域类工作。我也在考虑一种类似的方法，每个域类都有自己的存储库：

```
public interface IRepository<T>
{
    IQueryable<T> GetAll();
    void Save(T item);
    void Delete(T item);
}
public class MemoryCustomerRepository : IRepository {...}
public class SqlCustomerRepository : IRepository {...} 
```

我的问题：1）第一种方法是否可行？2）第二种方法有什么优势吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-07T04:04:26.467

1.  第一种方法是可行的，我过去在编写自己的针对 RDBMS 和`XmlWriter`/的映射框架时做过类似的事情`XmlReader`。您可以使用这种方法来简化单元测试，尽管我认为现在我们拥有出色的 OSS 工具可以做到这一点。

2.  第二种方法是我现在使用的[IBATIS.NET 映射器](http://ibatis.apache.org/dotnetdownloads.cgi)。每个映射器都有一个接口，每个映射器 [可以] 提供您的基本 CRUD 操作。优点是域类的每个映射器还具有由接口表示并在具体映射器中定义的特定功能（例如`SelectByLastName`或）。`DeleteFromParent`因此，我不需要像您建议的那样实现单独的存储库 - 我们的具体映射器以数据库为目标。为了执行单元测试，我使用[StructureMap](http://structuremap.sourceforge.net/Default.htm)和[Moq](http://code.google.com/p/moq/)创建内存存储库，作为您的`Memory*Repository`做。对于一个非常可测试的方法，它的实现和管理类更少，整体工作更少。`WithXXX`对于跨单元测试共享的数据，我为每个具有方法和`AsSomeProfile`方法的域类使用构建器模式（`AsSomeProfile`只返回一个带有预配置测试数据的构建器实例）。

这是我通常在单元测试中最终得到的示例：

```
// Moq mocking the concrete PersonMapper through the IPersonMapper interface
var personMock = new Mock<IPersonMapper>(MockBehavior.Strict);
personMock.Expect(pm => pm.Select(It.IsAny<int>())).Returns(
    new PersonBuilder().AsMike().Build()
);

// StructureMap's ObjectFactory
ObjectFactory.Inject(personMock.Object);

// now anywhere in my actual code where an IPersonMapper instance is requested from
// ObjectFactory, Moq will satisfy the requirement and return a Person instance
// set with the PersonBuilder's Mike profile unit test data 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-06T23:27:43.933

实际上，现在人们普遍认为域存储库不应该是通用的。您的存储库应该表达您在持久化或检索实体时可以执行的操作。

有些存储库是只读的，有些是仅插入的（不更新，不删除），有些只有特定的查找......

使用 GetAll 返回 IQueryable，您的查询逻辑将泄漏到您的代码中，可能会泄漏到应用程序层。

但是使用您提供的接口来封装 Linq`Table<T>`对象仍然很有趣，以便您可以将其替换为内存中的实现以用于测试目的。

所以我建议，调用它，给它与 linq对象`ITable<T>`相同的接口，并**在**你的特定域存储库中使用它（而不是代替）。`Table<T>`

 **然后，您可以通过使用内存`ITable<T>`实现来使用内存中的特定存储库。

在内存中实现的最简单方法`ITable<T>`是使用 a`List<T>`并`IQueryable<T>`使用 .AsQueryable() 扩展方法获取接口。

```
public class InMemoryTable<T> : ITable<T>
{
    private List<T> list;
    private IQueryable<T> queryable;

   public InMemoryTable<T>(List<T> list)
   { 
      this.list = list;
      this.queryable = list.AsQueryable();
   }

   public void Add(T entity) { list.Add(entity); }
   public void Remove(T entity) { list.Remove(entity); }

   public IEnumerator<T> GetEnumerator() { return list.GetEnumerator(); }

   public Type ElementType { get { return queryable.ElementType; } }
   public IQueryProvider Provider {     get { return queryable.Provider; } }
   ...
} 
```

您可以独立于数据库进行测试，但使用能够提供更多领域洞察力的真正特定存储库。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-03-10T17:20:05.723

This is a bit late... but take a look at the IRepository implementation at [CommonLibrary.NET](http://commonlibrarynet.codeplex.com) on codeplex. It's got a pretty good feature set.

Regarding your problem, I see a lot of people using methods like GetAllProducts(), GetAllEmployees() in their repository implementation. This is redundant and doesn't allow your repository to be generic. All you need is GetAll() or All(). The solution provided above does solve the naming problem though.

This is taken from CommonLibrary.NET documentation online:

0.9.4 Beta 2 has a powerful Repository implementation.

```
* Supports all CRUD methods ( Create, Retrieve, Update, Delete )
* Supports aggregate methods Min, Max, Sum, Avg, Count
* Supports Find methods using ICriteria<T>
* Supports Distinct, and GroupBy
* Supports interface IRepository<T> so you can use an In-Memory table for unit-testing
* Supports versioning of your entities
* Supports paging, eg. Get(page, pageSize)
* Supports audit fields ( CreateUser, CreatedDate, UpdateDate etc )
* Supports the use of Mapper<T> so you can map any table record to some entity
* Supports creating entities only if it isn't there already, by checking for field values. 
```

# .net - 是否可以共享 DataTrigger？

> ID：270874
> 
> 赞同：3
> 
> 时间：2008-11-07T00:21:40.350
> 
> 标签：.net, wpf, xaml, datatrigger

我在 XAML 中定义了一个 DataTrigger，我想在多个地方使用它。是否可以将其定义为资源然后共享？

这是我的触发器：

```
<TextBlock.Style>
    <Style>
        <Style.Triggers>
            <DataTrigger Binding="{Binding HasCurrentTest}" Value="True">
                <Setter Property="TextBlock.Visibility" Value="Hidden" />
            </DataTrigger>
        </Style.Triggers>
    </Style>
</TextBlock.Style> 
```

虽然我可以在我的 Window.Resources 中定义它并给它一个键，但我如何在我的 XAML 的其余部分中引用它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-07T01:47:26.777

作为对我自己帖子的评论，我刚刚看到了一个更好的方法来做到这一点——我应该使用内置的 BooleanToVisibilityConverter，然后我可以这样做：

```
<Window.Resources>
    <BooleanToVisibilityConverter x:Key="BoolToVis" />
</Window.Resources> 
```

然后...

```
<TextBlock Visibility="{Binding HasNoCurrentTest, 
           Converter={StaticResource BoolToVis}}" /> 
```

这是一个更好的解决方案！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T00:45:25.527

如果样式在 Windows.Resources 中带有键，则每个元素都可以像这样将其添加到自己的样式中。

```
<Window.Resources>
    <Style x:Key="YourStyleKey">
        <!-- Your Style -->
    </Style>
</Window.Resources>

<TextBox Text="SomeText" Style="{StaticResource YourStyleKey}"/>
<TextBox Text="SomeOtherText" Style="{StaticResource YourStyleKey}"/> 
```

# python - 使用 SQLAlchemy ORM 高效更新数据库

> ID：270879
> 
> 赞同：140
> 
> 时间：2008-11-07T00:24:04.777
> 
> 标签：python, orm, sqlalchemy

我正在启动一个新应用程序并考虑使用 ORM——特别是 SQLAlchemy。

假设我的数据库中有一个“foo”列，我想增加它。在直接的 sqlite 中，这很容易：

```
db = sqlite3.connect('mydata.sqlitedb')
cur = db.cursor()
cur.execute('update table stuff set foo = foo + 1') 
```

我想出了等效的 SQLAlchemy SQL-builder：

```
engine = sqlalchemy.create_engine('sqlite:///mydata.sqlitedb')
md = sqlalchemy.MetaData(engine)
table = sqlalchemy.Table('stuff', md, autoload=True)
upd = table.update(values={table.c.foo:table.c.foo+1})
engine.execute(upd) 
```

这有点慢，但没有太多。

这是我对 SQLAlchemy ORM 方法的最佳猜测：

```
# snip definition of Stuff class made using declarative_base
# snip creation of session object
for c in session.query(Stuff):
    c.foo = c.foo + 1
session.flush()
session.commit() 
```

这样做是正确的，但它需要的时间是其他两种方法的不到 50 倍。我认为那是因为它必须先将所有数据带入内存，然后才能使用它。

有没有办法使用 SQLAlchemy 的 ORM 生成高效的 SQL？或者使用任何其他python ORM？还是我应该回去手动编写 SQL？

* * *

## 回答 #1

> 赞同：206
> 
> 时间：2008-11-10T17:40:42.797

SQLAlchemy 的 ORM 旨在与 SQL 层一起使用，而不是隐藏它。但是在同一事务中使用 ORM 和普通 SQL 时，您必须牢记一两件事。基本上，从一方面来看，ORM 数据修改只会在您从会话中刷新更改时才会影响数据库。另一方面，SQL 数据操作语句不会影响会话中的对象。

所以如果你说

```
for c in session.query(Stuff).all():
    c.foo = c.foo+1
session.commit() 
```

它会按照它说的去做，从数据库中获取所有对象，修改所有对象，然后在将更改刷新到数据库时，一一更新行。

相反，您应该这样做：

```
session.execute(update(stuff_table, values={stuff_table.c.foo: stuff_table.c.foo + 1}))
session.commit() 
```

这将像您期望的那样作为一个查询执行，并且因为至少默认会话配置会在提交时使会话中的所有数据过期，所以您没有任何陈旧数据问题。

在即将发布的 0.5 系列中，您还可以使用此方法进行更新：

```
session.query(Stuff).update({Stuff.foo: Stuff.foo + 1})
session.commit() 
```

这将基本上运行与前一个片段相同的 SQL 语句，但还会选择更改的行并使会话中的任何陈旧数据失效。如果您知道更新后没有使用任何会话数据，您还可以添加`synchronize_session=False`到更新语句并摆脱该选择。

* * *

## 回答 #2

> 赞同：112
> 
> 时间：2010-12-27T16:28:03.490

```
session.query(Clients).filter(Clients.id == client_id_list).update({'status': status})
session.commit() 
```

试试这个 =)

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2015-11-10T19:53:27.213

有几种使用 sqlalchemy 进行更新的方法

```
1) for c in session.query(Stuff).all():
       c.foo += 1
   session.commit()

2) session.query(Stuff).update({"foo": Stuff.foo + 1})
   session.commit()

3) conn = engine.connect()
   table = Stuff.__table__
   stmt = table.update().values({'foo': Stuff.foo + 'a'})
   conn.execute(stmt)
   conn.commit() 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2015-09-08T00:10:34.817

以下是如何解决相同问题而无需手动映射字段的示例：

```
from sqlalchemy import Column, ForeignKey, Integer, String, Date, DateTime, text, create_engine
from sqlalchemy.exc import IntegrityError
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm import sessionmaker
from sqlalchemy.orm.attributes import InstrumentedAttribute

engine = create_engine('postgres://postgres@localhost:5432/database')
session = sessionmaker()
session.configure(bind=engine)

Base = declarative_base()

class Media(Base):
  __tablename__ = 'media'
  id = Column(Integer, primary_key=True)
  title = Column(String, nullable=False)
  slug = Column(String, nullable=False)
  type = Column(String, nullable=False)

  def update(self):
    s = session()
    mapped_values = {}
    for item in Media.__dict__.iteritems():
      field_name = item[0]
      field_type = item[1]
      is_column = isinstance(field_type, InstrumentedAttribute)
      if is_column:
        mapped_values[field_name] = getattr(self, field_name)

    s.query(Media).filter(Media.id == self.id).update(mapped_values)
    s.commit() 
```

因此，要更新 Media 实例，您可以执行以下操作：

```
media = Media(id=123, title="Titular Line", slug="titular-line", type="movie")
media.update() 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-07T01:08:04.187

如果是因为创建对象的开销，那么 SA 可能根本无法加速。

如果是因为它正在加载相关对象，那么您可以通过延迟加载来做一些事情。由于引用而创建了很多对象吗？（IE，获取 Company 对象也会获取所有相关的 People 对象）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-07T00:35:19.697

没有经过测试，我会尝试：

```
for c in session.query(Stuff).all():
     c.foo = c.foo+1
session.commit() 
```

（IIRC，commit() 在没有 flush() 的情况下工作）。

我发现有时进行大型查询然后在 python 中进行迭代可能比大量查询快 2 个数量级。我假设遍历查询对象的效率低于遍历查询对象的 all() 方法生成的列表。

[请注意下面的评论-这根本没有加快速度]。

# java - 使用 DataOutputStream 编写大字符串

> ID：270884
> 
> 赞同：7
> 
> 时间：2008-11-07T00:29:59.567
> 
> 标签：java, dataoutputstream

我一直在做一些套接字编程来通过网络传输信息。我遇到了 DataOutputStream.writeUTF() 的问题。它似乎允许高达 64k 的字符串，但我有一些情况可以运行。是否有任何支持更大字符串的好选择，或者我需要自己滚动？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-07T00:59:33.707

它实际上使用两个字节来写入字符串的长度，然后使用将其压缩为每个字符一个、两个或三个字节的算法。（请参阅 java.io.DataOutput 上的文档）它接近 UTF-8，但即使记录为如此，也存在兼容性问题。如果您并不十分担心要写入的数据量，您可以通过先写入字符串的长度，然后使用 getBytes 方法写入字符串的原始数据来轻松编写自己的数据。

```
// Write data
String str="foo";
byte[] data=str.getBytes("UTF-8");
out.writeInt(data.length);
out.write(data);

// Read data
int length=in.readInt();
byte[] data=new byte[length];
in.readFully(data);
String str=new String(data,"UTF-8"); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-01-31T02:22:02.390

`ObjectOutputStream.writeObject()`正确处理长字符串（通过查看源代码进行验证）。以这种方式写出字符串：

```
ObjectOutputStream oos = new ObjectOutputStream(out);
... other write operations ...
oos.writeObject(myString);
... other write operations ... 
```

这样读：

```
ObjectInputStream ois = new ObjectInputStream(in);
... other read operations ...
String myString = (String) ois.readObject();
... other read operations ... 
```

另一个不同之`DataOutputStream`处是 using`ObjectOutputStream`在实例化时自动写入一个 4 字节的流标头，但通常需要支付相当小的代价。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T00:54:43.823

您应该能够使用带有 UTF-8 编码的[OutputStreamWriter 。](http://java.sun.com/j2se/1.4.2/docs/api/java/io/OutputStreamWriter.html)没有显式的 writeUTF 方法，但您可以在构造函数中设置字符集。尝试

```
Writer osw = new OutputStreamWriter(out, "UTF-8"); 
```

`out`您现在包装的 OutputStream 在哪里。

# php - CakePHP 1.2：如何锁定一个给定的控制器，不让管理员以外的任何人访问？

> ID：270889
> 
> 赞同：2
> 
> 时间：2008-11-07T00:33:10.093
> 
> 标签：php, authentication, cakephp, cakephp-1.2

我不是在寻找整个 ACO-ARO 实现......我只想使用 Auth，并检查用户的角色......

为了简单地拒绝给定控制器的用户，我应该把什么放在哪里，除非他们具有特定的角色。

我正在尝试使用 $this->Auth->authorize = 'controller'; ...但我什至不知道该放在哪里？

任何帮助都是极好的！

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-11T09:26:35.210

**简短回答**：听起来您需要创建`app_controller.php`代码并将其放入方法中`beforeFilter`。`

**更长的答案：**在您的应用程序目录中创建一个`app_controller.php`文件并将以下代码放入`beforeFilter()`.

```
if (isset($this->params[Configure::read('Routing.admin')])) { //User is trying to access a page using the admin route
    if ($this->Session->check('someSessionVariable')) { //Check user has some session variable set.                 
        // User is accessing an admin page and has permission, do something, or in most cases do nothing.
     } else { //No sessions set for user, redirect to login page.           
        $this->redirect('/yourLoginPage'); //Redirect
    }
} 
```

这不能替代 Auth 组件的正确用户，但应该做你需要的。确保在将其投入生产之前检查其安全性。

# perl - 为什么 Perl 中的这个 map 语句不能编译？

> ID：270895
> 
> 赞同：10
> 
> 时间：2008-11-07T00:38:29.833
> 
> 标签：perl, hash, map

这失败了：

```
my @a = ("a", "b", "c", "d", "e");
my %h = map { "prefix-$_" => 1 } @a; 
```

出现此错误：

```
Not enough arguments for map at foo.pl line 4, near "} @a" 
```

但这有效：

```
my @a = ("a", "b", "c", "d", "e");
my %h = map { "prefix-" . $_ => 1 } @a; 
```

为什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-07T00:45:51.690

因为 Perl 猜测的是 EXPR（例如哈希引用）而不是 BLOCK。这应该有效（注意“+”符号）：

```
my @a = ("a", "b", "c", "d", "e");
my %h = map { +"prefix-$_" => 1 } @a; 
```

请参阅[http://perldoc.perl.org/functions/map.html](http://perldoc.perl.org/functions/map.html)。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-07T02:41:01.333

我更喜欢把它写成

```
my %h = map { ("prefix-$_" => 1) } @a; 
```

为了显示意图，我将返回一个 2 元素列表。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-11-07T00:48:44.040

来自`perldoc -f map`：

```
 "{" starts both hash references and blocks, so "map { ..."
           could be either the start of map BLOCK LIST or map EXPR, LIST.
           Because perl doesn’t look ahead for the closing "}" it has to
           take a guess at which its dealing with based what it finds just
           after the "{". Usually it gets it right, but if it doesn’t it
           won’t realize something is wrong until it gets to the "}" and
           encounters the missing (or unexpected) comma. The syntax error
           will be reported close to the "}" but you’ll need to change
           something near the "{" such as using a unary "+" to give perl
           some help:

             %hash = map {  "\L$_", 1  } @array  # perl guesses EXPR.  wrong
             %hash = map { +"\L$_", 1  } @array  # perl guesses BLOCK. right
             %hash = map { ("\L$_", 1) } @array  # this also works
             %hash = map {  lc($_), 1  } @array  # as does this.
             %hash = map +( lc($_), 1 ), @array  # this is EXPR and works!
             %hash = map  ( lc($_), 1 ), @array  # evaluates to (1, @array)

           or to force an anon hash constructor use "+{"

             @hashes = map +{ lc($_), 1 }, @array # EXPR, so needs , at end

           and you get list of anonymous hashes each with only 1 entry. 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-07T02:42:53.373

另外，做你正在做的事情的另一种方法是初始化哈希，你可以这样做：

```
my @a = qw( a b c d e );
my %h;
@h{@a} = (); 
```

这将为五个键中的每一个创建 undef 条目。如果您想为它们提供所有真实值，请执行此操作。

```
@h{@a} = (1) x @a; 
```

您也可以使用循环显式执行此操作；

```
@h{$_} = 1 for @a; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-07T06:24:22.693

我觉得

```
map { ; "prefix-$_" => 1 } @a; 
```

就指定它是语句块而不是哈希引用而言，它更惯用。你只是用一个空语句开始它。

# tfs - 从 PowerBuilder IDE 将标签附加到 TFS 中的项目？

> ID：270916
> 
> 赞同：4
> 
> 时间：2008-11-07T00:55:18.113
> 
> 标签：tfs, powerbuilder

我们现在使用`Advanced`签入对话框上的按钮（带有`Merant`, `nee PVCS`）执行此操作，但是当我设置为我的提供者时该`Advanced`按钮被禁用。我们可以在任一侧翻转开关来启用它吗？ `TFS``SCC`

*   还是我们需要编写一些自定义扩展？
*   或者我可以得到`TFS changeset`与 PB 变化相关联的数字吗？
*   还是我完全错误地进行选择性构建？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-17T17:08:23.570

我们可以通过在 TFS 中创建一个 Note 字段并在签入时将其设为必需来实现我们想要的。SCC 界面将使 TFS 签入对话框出现并强制开发人员在该字段中输入一个值。然后，我们可以使用 Note 查找关联的变更集并根据变更集进行提取。感谢所有看过这个的人。

# c++ - 为什么要在 C++ 中为抽象类声明虚拟析构函数？

> ID：270917
> 
> 赞同：172
> 
> 时间：2008-11-07T00:55:30.390
> 
> 标签：c++, inheritance, virtual-destructor

我知道在 C++ 中为基类声明虚拟析构函数是一个好习惯，但是`virtual`即使对于充当接口的抽象类，声明析构函数也总是很重要吗？请提供一些原因和例子。

* * *

## 回答 #1

> 赞同：205
> 
> 时间：2008-11-07T01:01:13.157

对于界面而言，它甚至更为重要。您类的任何用户都可能持有指向接口的指针，而不是指向具体实现的指针。当他们来删除它时，如果析构函数是非虚拟的，他们将调用接口的析构函数（或编译器提供的默认值，如果你没有指定），而不是派生类的析构函数。即时内存泄漏。

例如

```
class Interface
{
   virtual void doSomething() = 0;
};

class Derived : public Interface
{
   Derived();
   ~Derived() 
   {
      // Do some important cleanup...
   }
};

void myFunc(void)
{
   Interface* p = new Derived();
   // The behaviour of the next line is undefined. It probably 
   // calls Interface::~Interface, not Derived::~Derived
   delete p; 
} 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2008-11-07T02:39:47.980

您的问题的答案通常是，但并非总是如此。如果您的抽象类禁止客户端在指向它的指针上调用 delete（或者如果它在其文档中这样说），您可以自由地不声明虚拟析构函数。

您可以通过保护其析构函数来禁止客户端对指向它的指针调用 delete。像这样工作，省略虚拟析构函数是完全安全和合理的。

您最终将没有虚拟方法表，并最终向您的客户表明您打算通过指向它的指针使其不可删除，因此在这些情况下您确实有理由不将其声明为虚拟。

*[参见本文第 4 项：[http](http://www.gotw.ca/publications/mill18.htm) ://www.gotw.ca/publications/mill18.htm ]*

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2011-07-09T11:18:21.487

我决定做一些研究并尝试总结你的答案。以下问题将帮助您决定需要哪种析构函数：

1.  **您的类是否打算用作基类？**
    *   否：声明公共非虚拟析构函数以避免类^*的每个对象上的 v 指针。
    *   是：阅读下一个问题。
2.  **你的基类是抽象的吗？（即任何虚拟纯方法？）**
    *   否：尝试通过重新设计类层次结构来使您的基类抽象
    *   是：阅读下一个问题。
3.  **你想允许通过基指针进行多态删除吗？**
    *   否：声明受保护的虚拟析构函数以防止不必要的使用。
    *   是：声明公共虚拟析构函数（在这种情况下没有开销）。

我希望这有帮助。

^*重要的是要注意，在 C++ 中没有办法将类标记为最终类（即不可子类化），因此如果您决定将析构函数声明为非虚拟和公共的，请记住明确警告您的程序员同事不要源自您的课程。

参考：

*   “S. Meyers。更有效的 C++，第 33 项 Addison-Wesley，1996 年。”
*   [草本萨特，虚拟，2001](http://www.gotw.ca/publications/mill18.htm)
*   [C++ 常见问题解答，20.7，“我的析构函数什么时候应该是虚拟的？”](http://www.parashift.com/c++-faq-lite/virtual-functions.html#faq-20.7)
*   这个问题的答案，当然。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-11-07T01:01:39.147

是的，它总是很重要。派生类可以分配内存或持有对在对象被销毁时需要清理的其他资源的引用。如果您不为接口/抽象类提供虚拟析构函数，那么每次通过基类句柄删除派生类实例时，都不会调用派生类的析构函数。

因此，您打开了内存泄漏的可能性

```
class IFoo
{
  public:
    virtual void DoFoo() = 0;
};

class Bar : public IFoo
{
  char* dooby = NULL;
  public:
    virtual void DoFoo() { dooby = new char[10]; }
    void ~Bar() { delete [] dooby; }
};

IFoo* baz = new Bar();
baz->DoFoo();
delete baz; // memory leak - dooby isn't deleted 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-11-07T01:02:46.927

这并不*总是*必需的，但我发现这是一种很好的做法。它的作用是允许通过基类型的指针安全地删除派生对象。

例如：

```
Base *p = new Derived;
// use p as you see fit
delete p; 
```

如果`Base`没有虚拟析构函数，则格式错误，因为它将尝试删除对象，就好像它是一个`Base *`.

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-11-07T01:03:13.213

这不仅是好的做法。这是任何类层次结构的规则#1。

1.  C ++中层次结构的最基类必须具有虚拟析构函数

现在来看看为什么。以典型的动物等级为例。虚拟析构函数像任何其他方法调用一样通过虚拟调度。举个例子。

```
Animal* pAnimal = GetAnimal();
delete pAnimal; 
```

假设 Animal 是一个抽象类。C++ 知道要调用的正确析构函数的唯一方法是通过虚拟方法分派。如果析构函数不是虚拟的，那么它将简单地调用 Animal 的析构函数而不破坏派生类中的任何对象。

在基类中使析构函数为虚拟的原因是它只是从派生类中删除了选择。默认情况下，它们的析构函数变为虚拟的。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-12-27T14:27:55.343

答案很简单，你需要它是虚拟的，否则基类将不是一个完整的多态类。

```
 Base *ptr = new Derived();
    delete ptr; // Here the call order of destructors: first Derived then Base. 
```

您更喜欢上述删除，但如果基类的析构函数不是虚拟的，则只会调用基类的析构函数，派生类中的所有数据都将保持未删除状态。

# php - 如何在 php 中获取远程域的 HTTP 状态码？

> ID：270918
> 
> 赞同：6
> 
> 时间：2008-11-07T00:55:34.837
> 
> 标签：php

我想创建一个批处理脚本，通过数据库中的 20,000 个链接，并清除所有 404 等。如何获取远程 URL 的 HTTP 状态代码？

最好不要使用 curl，因为我没有安装它。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-07T01:20:06.720

CURL 将是完美的，但由于你没有它，你将不得不用套接字弄脏它。该技术是：

1.  打开一个到服务器的套接字。
2.  发送 HTTP HEAD 请求。
3.  解析响应。

这是一个简单的例子：

```
<?php

$url = parse_url('http://www.example.com/index.html');

$host = $url['host'];
$port = $url['port'];
$path = $url['path'];
$query = $url['query'];
if(!$port)
    $port = 80;

$request = "HEAD $path?$query HTTP/1.1\r\n"
          ."Host: $host\r\n"
          ."Connection: close\r\n"
          ."\r\n";

$address = gethostbyname($host);
$socket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);
socket_connect($socket, $address, $port);

socket_write($socket, $request, strlen($request));

$response = split(' ', socket_read($socket, 1024));

print "<p>Response: ". $response[1] ."</p>\r\n";

socket_close($socket);

?> 
```

**更新：我添加了几行来解析 URL**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-07T01:40:59.410

如果我没记错的话，php 内置函数都没有返回远程 url 的 http 状态，所以最好的选择是使用套接字打开与服务器的连接，发送请求并解析响应状态：

伪代码：

```
parse url => $host, $port, $path
$http_request = "GET $path HTTP/1.0\nHhost: $host\n\n";
$fp = fsockopen($host, $port, $errno, $errstr, $timeout), check for any errors
fwrite($fp, $request)
while (!feof($fp)) {
   $headers .= fgets($fp, 4096);
   $status = <parse $headers >
   if (<status read>)
     break;
}
fclose($fp) 
```

另一种选择是在 php 中使用已经构建的 http 客户端类，它可以在不获取完整页面内容的情况下返回标题，网络上应该有一些开源类可用......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T01:25:38.660

[这个页面](http://www.bin-co.com/php/scripts/load/)看起来有一个很好的设置，可以使用 curl 或 fsockopen 下载页面，并且可以使用任何一种方法获取 HTTP 标头（这确实是您想要的）。

使用该方法后，您需要检查 $output['info']['http_code'] 以获取所需的数据。

希望有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-07T01:28:02.227

您可以使用 PEAR 的 HTTP::head 函数。
[http://pear.php.net/manual/en/package.http.http.head.php](http://pear.php.net/manual/en/package.http.http.head.php)

# vb.net - 使用并行扩展和 VB.net 传递值

> ID：270919
> 
> 赞同：1
> 
> 时间：2008-11-07T00:55:58.160
> 
> 标签：vb.net, parallel-processing, parallel-extensions

我正在寻找如何在 VB.net 中使用 Parallel Extensions 执行以下操作的示例。

```
Dim T As Thread = New Thread(AddressOf functiontodowork)
T1.Start(InputValueforWork) 
```

我遇到困难的地方是如何将我的参数 InputValueforWork 传递给任务

```
Dim T As Tasks.Task = Tasks.Task.Create(AddressOf functiontodowork) 
```

欢迎任何建议和可能的编码示例。

安德鲁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-09T16:48:56.767

我解决了我自己的问题。你必须传入一个带有值的数组。

```
Dim A(0) as Int32
A(0) = 1
Tasks.Task.Create(AddressOf TransferData, A) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T04:47:17.800

不一定是我知道的最有用的答案，但在 C# 中，您可以通过闭包来做到这一点：

```
var T = Tasks.Task.Create( () => functionToDoWork(SomeParameter) ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T14:36:26.097

这里真正的问题是[VB 9 不支持`Action<T>`](http://www.paulstovell.com/blog/vbnet-wheres-actiont-support)，只有 Funcs

您可以通过在 C# 中使用帮助程序来解决此限制，如下所示：

```
public class VBHelpers {
    public static Action<T> FuncToAction<T>(Func<T, object> f) {
        return p => f(p);
    }
} 
```

然后你像这样从VB中使用它：

```
Public Sub DoSomething()
    Dim T As Task = Task.Create(VBHelpers.FuncToAction(Function(p) FunctionToDoWork(p)))
End Sub

Public Function FunctionToDoWork(ByVal e As Object) As Integer
    ' this does the real work
End Function 
```

# asp.net - PageRequestManager 未定义

> ID：270920
> 
> 赞同：0
> 
> 时间：2008-11-07T00:58:23.863
> 
> 标签：asp.net, asp.net-ajax

我间歇性地看到这个错误。我的应用程序抛出 PageRequestManager 未定义，因此无法加载。奇怪的是，这只发生在 Firefox 中，即加载正常。任何人都知道这个错误是什么意思。我已经在应用程序上工作了一段时间，我今天才开始看到这个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-10T01:00:19.680

这可能意味着页面上某处存在 javascript 错误，该错误命中 FF 但未命中 IE。您是否在 FF 中安装了 FireBug，您能否查看是否存在导致 javascript 无法完全解析的 javascript 错误？

# c# - 名称装饰/修饰和属性装饰之间有区别吗？

> ID：270924
> 
> 赞同：1
> 
> 时间：2008-11-07T01:00:40.833
> 
> 标签：c#

我一直在阅读一篇关于 C# 扩展的文本，有一次它说“属性装饰 X 只能应用于 Y 类型的字段”。

我一直无法找到属性装饰的定义，通过交换两者我没有多大意义。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T02:25:21.160

它可能指的是 Attribute 类。例如，您可以通过 SerializableAttribute 将类型标记为可序列化。应用属性时，可以省略“属性”后缀。

```
[Serializable]
public class SomeClass {

} 
```

属性提供了一种添加有关代码的元数据的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T02:48:52.190

属性用于以结构化方式将元数据添加到 .NET (C#) 代码。然而，很多人没有意识到的是，实际上有*两种类型*的属性。

最简单的是自定义属性，您可以在其中定义特定类寻找的属性来改变它们的工作方式。一个常见的例子是`System.Xml.Serialization`读取的属性`XmlSerializer`来改变它的输出，例如一个类可以被标记如下来指定它的命名空间并且这个字段应该是一个属性：

```
[XmlType(Namespace = "http://mycompany.com/")]
public class MyClass
{
    [XmlAttribute]
    public string MyField;
} 
```

像这样的自定义属性对编译器或运行时没有任何意义，它们只是作为元数据的一部分添加到类中，并且可以通过调用`Type.GetCustomAttributes`.

另一组主要属性是伪自定义属性，它们实际上对编译器或运行时都有意义。**Haacked** with的帖子中的`SerializableAttribute`示例实际上是伪自定义属性的示例。它实际上是作为类型定义的一部分存储的，不能使用`Type.GetCustomAttributes`. 您不能创建自己的伪自定义属性。

因此，您在这里处理的可能是特定工具正在寻找的自定义属性。

# c# - 如何确定在 Web 服务中调用了什么 WebMethod

> ID：270927
> 
> 赞同：3
> 
> 时间：2008-11-07T01:02:16.117
> 
> 标签：c#, asp.net, web-services

情况是这样的。我有一个 asp.net webservice 应用程序...比如说一个名为 api.asmx 的页面

在后面的代码中，我有几种方法，例如：

```
[WebMethod(Description="Method1")]
public int GetSomething(int num1, int num2){
  try{
    return SomeObject.DatabaseCall.DoSomething(num1, num2);
  }
  catch(Exception ex){
    object[] pars = new object[] { num1, num2 };
    LogError("GetSomething", pars, ex);
  }
}

[WebMethod(Description="Method2")]
public int GetSomething2(string w, string j, int f){
  try{
    return AnotherObject.DoSomething(w, j, f);
  }
  catch(Exception ex){
    object[] pars = new object[] { w, j, f };
    LogError("GetSomething2", pars, ex);
  }
} 
```

当然这只是两个简单的例子，如果抛出异常，我可以记录方法调用和传入的参数。

还有另一种方法可以做到这一点吗？有什么方法可以提取被调用的方法和/或参数。我想我希望有人会告诉我我可以拥有某种功能，例如：

```
LogError(ex); 
```

在该函数中，我可以访问一些服务器或环境变量，这些变量将公开被调用的方法。也许类似于 CurrentContext.WebServiceCall.Magic 属性...我是否需要将所有调用包装在 try/catch 中，然后输入方法名称和参数，或者是否有其他方法可以访问此信息。

希望这个问题不会太愚蠢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-07T01:23:26.090

任何未处理的异常都会冒泡到 Global.asax 文件中的 Application_Error 事件。从那里，您可以调用 Server.GetLastError() 来检索 Exception 实例。

一旦出现异常，您可以查看堆栈跟踪。您还可以访问 Request 对象，这样您就可以准确地看到来自客户端的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T01:22:02.333

异常对象具有 StackTrace 属性。你的入口方法应该在堆栈中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T01:20:45.987

您的 LogError 方法可以调用[Environment.StackTrace](http://msdn.microsoft.com/en-us/library/system.environment.stacktrace.aspx)。然后它会“知道”什么方法调用它。

# visual-studio - Visual Studio 是否有可用的调试符号？

> ID：270928
> 
> 赞同：4
> 
> 时间：2008-11-07T01:02:29.050
> 
> 标签：visual-studio, debug-symbols

我想追踪 Visual Studio 中可能存在的错误，但如果没有 Visual Studio 本身的调试符号，这将非常困难。Microsoft 是否提供这些服务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-06-04T07:18:34.850

最新的 Visual Studio 应该已经可以选择从 Microsoft 加载符号（检查：工具->选项->调试->符号）。当谈到调试 Visual Studio 本身时，请查看这篇[博文](http://blogs.msdn.com/b/calvin_hsia/archive/2009/06/08/9711306.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T01:59:03.337

不，最接近的是库的调试符号，可以按照此处的步骤[下载](http://support.microsoft.com/kb/311503)。但就像我说的，这些不适用于视觉工作室本身。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-10T07:14:25.150

根据我的经验，大多数 Visual Studio Dll 在符号服务器中都有符号。msenv.dll 是最重要的文件之一。

# emacs - 使用 Emacs 在尚未打开的文本文件中递归查找和替换

> ID：270930
> 
> 赞同：221
> 
> 时间：2008-11-07T01:02:58.347
> 
> 标签：emacs, editor

[作为这个问题](https://stackoverflow.com/questions/269812/how-to-quickly-get-started-at-using-and-learning-emacs)的后续，它试图找出如何做这样的事情，这应该很容易，这尤其阻止我更习惯使用 Emacs，而是启动我已经熟悉的编辑器。我在编辑多个文件时经常使用这里的示例。

在 Ultraedit 中，我会执行 Alt+s 然后 p 以显示一个对话框，其中包含以下选项：查找（包括在多行中使用正则表达式）、替换为、在文件/类型中、目录、匹配大小写、仅匹配整个单词、列表更改的文件和搜索子目录。通常我会先用鼠标点击并拖动选择我想要替换的文本。

仅使用 Emacs 本身（在 Windows XP 上），而不调用任何外部实用程序，如何将所有 foo\nbar 替换为 bar\nbaz`*.c`以及`*.h`某个文件夹中的文件及其下的所有文件夹。也许 Emacs 不是最好的工具，但如何用最少的命令轻松完成呢？

* * *

## 回答 #1

> 赞同：394
> 
> 时间：2008-11-07T03:13:35.790

1.  `M-x find-name-dired`：系统将提示您输入根目录和文件名模式。
2.  按下`t`以“切换标记”找到所有文件。
3.  按`Q`“文件中的查询替换...”：系统将提示您输入查询/替换正则表达式。
4.  继续`query-replace-regexp`：`SPACE`替换并移动到下一场比赛，`n`跳过一场比赛等。
5.  按`C-x s`保存缓冲区。（然后您可以按`y`是、`n`否或`!`全部都按是）

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2011-11-04T21:40:19.680

*   `M-x find-name-dired RET`
    *   所有文件可能需要一些时间才能出现在列表中，滚动到底部 ( `M->`) 直到`find finished`出现 " " 以确保它们都已加载
*   按下`t`以“切换标记”找到所有文件
*   按`Q`“文件中的查询替换...”：系统将提示您输入查询/替换正则表达式。
*   与 query-replace-regexp 一样继续：SPACE 或`y`替换并移动到下一个匹配项，n 跳过匹配项等。
    *   类型 ！无需询问即可替换当前文件中的所有匹配项，`N`跳过当前文件其余部分的所有可能替换。（`N`仅 emacs 23+）
    *   要在不进一步询问的情况下对所有文件进行替换，请键入`Y`.
*   调用“ibuffer”（`C-x C-b`如果绑定到 ibuffer，或者`M-x ibuffer RET`）列出所有打开的文件。
*   键入`* u`以标记所有未保存的文件，键入`S`以保存所有标记的文件
*   `* * RET`取消标记所有标记，或键入`D`以关闭所有标记的文件

这个答案结合了[这个答案](https://stackoverflow.com/questions/270930/using-emacs-to-recursively-find-and-replace-in-text-files-not-already-open/271136#271136)，来自[这个网站](http://xahlee.org/emacs/find_replace_inter.html)，和我自己的笔记。使用 Emacs 23+。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2016-12-02T19:00:30.377

弹丸真的很好：Cc pr 运行命令弹丸替换

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2013-10-16T07:13:31.553

提供的答案很棒，但是我想我会添加一种稍微不同的方法。

这是一种更具交互性的方法，并且需要`wgrep`,`rgrep`和`iedit`. 两者都`iedit`必须`wgrep`通过 MELPA 或 Marmalade 安装（使用`M-x package-list-packages`）

首先运行`M-x rgrep`以查找您要查找的字符串。

您将能够指定文件类型/模式和要递归的文件夹。

接下来，您需要运行以`wgrep`启动它`C-s C-p`。

Wgrep 将允许您编辑`rgrep`结果，因此在字符串上设置一个区域以匹配并开始`iedit-mode`（`C-;`取决于您的终端，您可能需要重新绑定它）

所有事件都可以立即编辑。`C-x C-s`承诺`wgrep`。然后`C-x s !`保存更改的文件。

这种方法的主要好处是您可以`iedit-mode`用来关闭某些匹配项`M-;`。您还可以使用结果`rgrep`跳转到文件中，例如，如果您有意外匹配。

我发现它对于在项目中进行源代码编辑和重命名符号（变量、函数名等）非常有用。

如果您还不知道/使用 iedit 模式，它是一个非常方便的工具，我强烈建议您看看。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2008-11-07T01:52:04.643

我通常使用其他工具来执行此任务，并且似乎[EmacsWiki 的 Find and Replace Across Files 条目](http://www.emacswiki.org/emacs/CategorySearchAndReplace#toc4)中提到的许多方法都被淘汰了，但[Findr 包](http://www.emacswiki.org/emacs/FindrPackage)看起来很有前途。

窃取部分[源文件](http://www.emacswiki.org/cgi-bin/emacs/findr.el)：

```
(defun findr-query-replace (from to name dir)
  "Do `query-replace-regexp' of FROM with TO, on each file found by findr. 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2013-12-23T09:52:28.683

信息来源：[1](http://ergoemacs.org/emacs/find_replace_inter.html)

**对于 emacs 专业用户：**

1.  调用 dired 列出 dir 中的文件，如果需要所有子目录，则调用 find-dired。
2.  标记您想要的文件。您可以通过输入【% m】来使用正则表达式进行标记。
3.  键入 Q 调用 dired-do-query-replace-regexp。
4.  键入您的查找正则表达式并替换字符串。〔☛常见的elisp regex模式〕</li>
5.  对于每次出现，键入 y 替换，n 跳过。按【Ctrl+g】中止整个操作。
6.  类型 ！替换当前文件中的所有出现而不询问，N 跳过当前文件其余部分的所有可能替换。（N 仅是 emacs 23）
7.  要在不进一步询问的情况下对所有文件进行替换，请键入 Y。（仅限 Emacs 23）
8.  调用 ibuffer 列出所有打开的文件。输入【* u】标记所有未保存的文件，输入S保存所有标记的文件，输入D关闭所有文件。

**Emacs 初学者分步指南**

选择目标文件

通过在命令行界面提示符下键入“emacs”来启动 emacs。（或者，如果您在图形用户界面环境中，请双击 Emacs 图标）

选择目录中的文件

首先，您需要选择要替换的文件。使用图形菜单〖File ▸ Open Directory〗。Emacs 会要求您提供目录路径。键入目录路径，然后按 Enter。

现在，您将看到文件列表，现在您需要标记您希望正则表达式查找/替换处理的文件。通过将光标移动到所需文件来标记文件，然后按 m。按 u 取消标记。（要列出子目录，请将光标移到目录并按 i。子目录的内容将列在底部。） 要使用正则表达式标记所有文件，请键入【% m】，然后键入您的正则表达式模式。例如，如果要标记所有 HTML 文件，则键入【%m】，然后键入 .html$。（您可以在图形菜单“Mark”中找到标记命令列表（当您处于 dired 模式时会出现此菜单。）

选择目录及其所有子目录中的文件

如果您想查找/替换目录中的文件，包括数百个子目录，这里有一种选择所有这些文件的方法。

调用 find-dired。（按【Alt+x】调用命令）然后，输入目录名，⁖ /Users/mary/myfiles

注意：如果您在 unix 非图形文本终端上使用 emacs，并且如果【Alt+x】不起作用，则等效的按键是【Esc x】。

Emacs 会通过提示“Run find (with args): ”询问您。如果您需要对所有 HTML 文件进行替换，请键入 -name "*html"。如果你不关心什么类型的文件，只关心那个目录下的所有文件，那么给“-type f”。

现在，如上所述标记文件。

交互式查找/替换

现在，您已准备好进行交互式查找替换。为简单起见，假设您只想将单词“quick”替换为“super”。现在，调用 dired-do-query-replace-regexp。它将提示您输入正则表达式字符串和替换字符串。输入“quick”，输入，然后输入“super”。

现在，emacs 将使用您的模式并检查文件，并在发生匹配时停止并向您显示。发生这种情况时，emacs 会提示您，您可以选择进行更改或跳过更改。要进行更改，请键入 y。要跳过，请键入 n。如果您只是希望 emacs 继续并对当前文件进行所有此类更改，请键入 !。

如果您想取消整个操作而不保存您所做的任何更改，请键入【Ctrl+g】，然后使用菜单〖File ▸ Exit Emacs〗退出 emacs。

保存更改的文件

现在，在您经历了上述磨难之后，您还需要做一个步骤，那就是保存更改的文件。

如果你使用的是 emacs 22 或更高版本，则调用 ibuffer 进入缓冲区列表模式，然后输入【* u】标记所有未保存的文件，然后输入 S 将它们全部保存。（这是shift-s）

如果您使用的是 emacs 版本 21，那么您可以这样做：调用 list-buffers，然后将光标移动到要保存的文件并键入 s。它将标记文件以供以后保存操作。输入 u 取消标记。完成后，键入 x 以执行所有标记为保存的文件的保存。（在 emacs 中，打开的文件称为“缓冲区”。忽略那里的其他内容。）

除了上述选项，您还可以调用 save-some-buffers 【Ctrl+xs】。然后 emacs 将显示每个未保存的文件并询问您是否要保存它。

注意：emacs 的正则表达式与 Perl 或 Python 的不一样，但相似。有关摘要和常见模式，请参阅：Emacs Regex。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-11-07T12:56:02.840

对于此任务，使用 dired 向下递归深层目录树会有点慢。您可以考虑使用[tags-query-replace](http://www.gnu.org/software/emacs/manual/html_node/emacs/Tags-Search.html)。这确实意味着要创建一个标签表，但这通常很有用，而且很快。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-07-27T15:36:38.227

对于开放缓冲区，这就是我所做的：

```
(defun px-query-replace-in-open-buffers (arg1 arg2)
  "query-replace in all open files"
  (interactive "sRegexp:\nsReplace with:")
  (mapcar
   (lambda (x)
     (find-file x)
     (save-excursion
       (goto-char (point-min))
       (query-replace-regexp arg1 arg2)))
   (delq
    nil
    (mapcar
     (lambda (x)
       (buffer-file-name x))
     (buffer-list))))) 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-10-22T20:02:17.843

`M-X Dired`, 和 t 标记所有文件，并`Q`查询替换所有文件中的文本。`i`您可以使用查询替换之前的命令展开子目录。我要添加的关键信息是，如果您为 i 命令提供前缀 (control-u)，它将提示您输入 arg，并且 -R 参数将递归地将所有内容扩展`subdirs` 到`dired`缓冲区中。因此，现在您可以查询搜索整个目录中的每个文件。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-11-16T05:46:06.750

另一种选择是使用[Icicles 搜索](http://www.emacswiki.org/emacs/Icicles_-_Search_Commands%2c_Overview)。这是一种不同类型的增量搜索，它使用完成您的迷你缓冲区输入来对抗搜索命中。当您修改当前输入时，匹配命中的集合会在 buffer 中更新`*Completions*`。

您可以搜索任意数量的文件、缓冲区或书签位置，您可以使用 minibuffer 模式（例如 regexp）匹配来选择这些位置。

当您访问搜索命中时，您可以按需[替换整个命中或仅替换与当前微型缓冲区输入匹配的部分。](http://www.emacswiki.org/emacs/Icicles_-_Search-And-Replace)按需替换意味着您不会依次询问每个搜索命中；您可以按任意顺序直接访问您想要的点击量。如果要进行的替换数量有限，这种方法可能比查询替换更有效：跳过详尽的`y/n`提示。

搜索超出了您定义的搜索*上下文*——您不限于搜索目标文件中的所有文本（例如，您可以跳过注释或特定类型的程序部分）。搜索上下文的一个简单示例是一行，如 中`grep`，但上下文可以是您喜欢的任何模式匹配的文本块。通常，您使用正则表达式定义搜索上下文，但您也可以使用函数。除了定义您自己的之外，还有针对不同类型上下文的预定义 Icicles 搜索命令：文本属性块或覆盖属性块、事物点事物等。

您还可以按各种*排序*顺序对搜索命中进行排序，以便于访问/导航。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2014-01-26T20:52:34.403

`find-name-dired`可以，但是：

*   您获得的所有文件都匹配相同的单个正则表达式。
*   `find-dired`在这方面更灵活，但它也适用于使用一般规则（即使它们可以任意复杂）。当然`find`还有自己的复杂语言。
*   如果您随后只想对一些名称被收集在`find(-name)-dired`缓冲区中的文件执行操作，则需要标记它们或删除/省略您不想执行操作的行。

另一种方法是使用[***Dired+***](http://www.emacswiki.org/cgi-bin/wiki/DiredPlus)*命令，这些命令作用于 (a) 标记的文件和 (b)标记的子目录*中的所有标记文件（或所有文件，如果没有标记） ... 以*递归*方式找到。这为您提供了对文件选择的通用性和轻松控制。这些“here-and-below”命令都**`M-+`**在 Dired 模式下的前缀键上。

例如，**`M-+ Q`**与`Q`--- query-replace 相同，但目标文件是所有标记在当前目录和任何标记的子目录中的文件，向下，向下，向下...

是的，使用此类此处和下方命令的替代方法是递归地*插入*所有子目录及其子目录，然后使用顶级命令，例如`Q`. 但是不打扰插入的子目录通常很方便。

为此，您无论如何都需要一种快速的方法来*递归地插入所有此类子目录*。在这里，**Dired+**也可以提供帮助。 **`M-+ M-i`**递归地插入所有标记的子目录和它们自己标记的子目录。也就是说，它就像（在**Dired+**`M-i`中插入标记的子目录），但它递归地作用于子目录。

 **（所有此类“此处和下方” **Dired+**命令都在菜单**Multiple** > **Marked Here and** below 上。）

您还可以对 Emacs 文件集执行 Dired 操作，该*文件集*是保存在任何位置的文件名集。如果您使用[***Icicles***](http://www.emacswiki.org/emacs/Icicles_-_Dired_Enhancements)，那么您可以只为文件集中的文件或其他类型的已保存文件列表打开 Dired 缓冲区。

您还可以为任何 Dired 缓冲区添加**书签**，包括使用`find(-name)-dired`. 这为您提供了一种稍后返回此类集合（例如项目集合）的快速方法。如果您使用[***Bookmark+***](http://www.emacswiki.org/cgi-bin/wiki/BookmarkPlus)，那么为 Dired 缓冲区记录 (a) 它的`ls`开关、(b) 标记了哪些文件、(c) 插入了哪些子目录以及 (d) 隐藏了哪些（子）目录。当您“跳转”到书签时，所有这些都会恢复。 **Bookmark+**还允许您为整个 Dired 缓冲区树添加书签 --- 跳转到书签会恢复树中的所有缓冲区。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-05-25T03:35:09.753

我想推荐一个尚未提及的好工具，即**[Helm](https://emacs-helm.github.io/helm/)**。

它是许多涉及完成、搜索等的标准 Emacs 操作的绝佳替代品。特别是，它`helm-find-files`允许在多个选定文件中执行查询替换（包括正则表达式）。

只需打开`helm-find-files`，标记相关文件，`M-SPC`然后使用`F6`or`F7`在所选文件中运行查询替换或查询替换正则表达式。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-10-28T02:42:09.103

1.  `M-x` `project-query-replace-regexp` `RET`（确保您的文件已保存！）。

2.  `M-x` `rgrep` `RET`然后`query-replace`在每个缓冲区内。很好，因为您可以跟踪所有事件，并且因为它可以让您将搜索限制为某些扩展。

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2012-08-15T16:12:54.640

它不是 Emacs，但 xxdiff 带有一个名为 xx-rename 的工具，它可以一次处理多个字符串（例如 From To from to FROM TO），具有交互式提示，保存所有修改文件的备份，并生成一个简短的使用上下文所做的更改的日志。这就是我在进行大型/全局重命名时倾向于使用的。

# .net - 高度复杂的集成网络应用程序 - 您会使用哪种语言？

> ID：270932
> 
> 赞同：2
> 
> 时间：2008-11-07T01:03:29.437
> 
> 标签：.net, dll, jar

假设您必须开发一个基于 Web 的应用程序，该应用程序需要能够读取 .NET DLL 的内容，然后使用所有命名空间、类等的列表填充本地数据库。

它也必须对 Java JAR 文件做同样的事情。

我可以使用哪种语言来开发它有限制吗？

我倾向于.NET，但如果它更合适，我可能会考虑另一种语言/框架。我是初级到中级的 PHP。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-07T01:15:44.967

我认为“从 DLL 中获取此信息”和“从 JAR 文件中获取此信息”活动彼此之间或与显示信息的 Web 应用程序没有任何共同之处。当然，已经存在转储这些信息的工具。

您可能应该用您熟悉的任何语言编写其中的 Web 部分，并执行预先存在的工具来完成提取任务......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T01:15:06.513

重新考虑答案：最好用 .NET 语言来做。读取 DLL 将是困难的部分。JAR 文件只是一个 ZIP 文件，可以使用任何语言编写的工具轻松检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T01:06:26.843

我想知道你是否想要那个？我的意思是，首先人们写了很多看起来不太好看的代码，其次，有些人可以对那里的代码进行混淆，什么说你可以“获取内容”然后理解呢？

但是可以肯定的是，有一些工具可以读取 dll 并确定获得您想要的内容。

# linux - 防止 'cp' 从 bash 脚本输出文件名

> ID：270933
> 
> 赞同：0
> 
> 时间：2008-11-07T01:03:32.463
> 
> 标签：linux, bash, shell, scripting

我有一个 shell 脚本，它将一些文件复制到当前目录，压缩它们，并将压缩文件流式传输到标准输出。

在客户端，我使用 plink 执行脚本并将 stdin 流式传输到文件。

这几乎可以工作。

似乎 cp 命令在从脚本内部执行时输出正在复制的文件名。如果我执行 ' **cp /path/to/file1 。**' 在 shell 中它会安静地执行它；如果我在脚本中执行它，它会输出“file1”。

我该如何防止这种情况？我尝试将 cp 命令的输出通过管道传输到 /dev/null 和一个虚拟文本文件，但没有成功。

谢谢你的帮助。

### 剧本

```
#!/bin/bash

cp /path/to/file1 .
cp /path/to/file2 .
cp /path/to/file3 .

tar -cvzf package.tgz file1 file2 file3

cat package.tgz 
```

### 输出

```
file1
file2
file3
<<binary data>> 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-07T01:06:20.243

不是cp，是tar。您正在传递它 -v，这使它打印文件的名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-07T05:55:06.667

啊哈！我一直认为 tar 发出的文件名 go to `stderr`，但情况并非总是如此：只有当您编写 tar 文件来`stdout`执行`-v`go to写入的文件时`stderr`：

```
$ tar cvf - share > /dev/null
share/                         # this must be going
share/.DS_Store                # to stderr since we
share/man/                     # redirected stdout to
share/man/.DS_Store            # /dev/null above.
share/man/man1/
share/man/man1/diffmerge.man1 
```

反例：

```
$ tar cvf blah.tar share > /dev/null 
```

这没有产生文件名列表，因为它们被发送到`/dev/null`. 我猜你每天都会学到一些新东西。:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-11-12T03:33:39.103

正如其他人指出的那样，tar 的 -v （详细）选项将文件名踢出到 STDERR。您还可以通过让 tar 将压缩文件流写入 STDOUT 来提高脚本的效率：

```
tar zcf - file1 file2 file3 
```

在此示例中，作为文件名传递的“-”选项使 tar 将输出写入 STDOUT。

# mysql - MySQL C API 使用结果

> ID：270940
> 
> 赞同：2
> 
> 时间：2008-11-07T01:07:30.867
> 
> 标签：mysql, c

我正在使用 MySQL C API 来查询数据库，并将结果存储在 MYSQL_ROW 类型中。我可以将结果打印到控制台

```
printf("%s", row[0]); 
```

但是，根据 MySQL C API 文档，我不能将它们用作以空字符结尾的字符串。

[在功能概述](http://dev.mysql.com/doc/refman/5.0/en/c-api-function-overview.html)的底部，他们说我可以使用`mysql_store_result()`or来“提取”信息`mysql_use_result()`。但是，我仍然对这是如何完成的感到困惑。

理想情况下，我想将结果用作字符串，这样我就可以做类似的事情`strcmp`，但否则我肯定需要以某种方式使用这两个函数的信息。

有人可以告诉我一个如何做到这一点的例子吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-07T01:20:15.300

基本上，您调用 mysql_store_result() 或 mysql_use_result() 来访问结果集，前者将所有行加载到客户端的内存中，后者从服务器一次访问一行。如果使用 mysql_use_result()，则需要调用 mysql_fetch_row() 来访问每一行，直到函数返回 NULL。每次成功调用 mysql_fetch_row() 都会返回一个 MYSQL_ROW ，您可以使用它来访问各个字段值。

由于字段不是以 nul 结尾的，因此您需要使用 mysql_fetch_lengths() 来获取每个字段的长度，以便您可以通过 memcpy 等将它们复制到其他地方。

由于字段值不是以 nul 结尾的，因此如果要将其用作字符串，则需要在制作副本时添加自己的 NUL 字符。请注意，字段值可能包含二进制数据，因此如果您确实将其视为字符串，则预期 C 字符串的函数如果遇到数据中的空字符将停止处理数据。

这是文档中的一个示例，可以帮助您将所有这些放在一起：

```
MYSQL_ROW row;
unsigned int num_fields;
unsigned int i;

num_fields = mysql_num_fields(result);
while ((row = mysql_fetch_row(result)))
{
   unsigned long *lengths;
   lengths = mysql_fetch_lengths(result);
   for(i = 0; i < num_fields; i++)
   {
       printf("[%.*s] ", (int) lengths[i], 
              row[i] ? row[i] : "NULL");
   }
   printf("\n");
} 
```

# c# - 如何在事件发生时中断，或确定关联的处理程序？

> ID：270941
> 
> 赞同：0
> 
> 时间：2008-11-07T01:07:56.277
> 
> 标签：c#, .net, debugging

我正在使用大型开源控件，但似乎找不到处理双击事件的代码。当双击发生或以其他方式了解与该事件关联的代码时，我是否可以让调试器中断？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-07T01:43:07.750

好吧，我偶然发现了我要找的代码。

顺便说一句，在 DoubleClick 事件发生之前，第二次单击会发生 MouseDown 事件，MouseEventArgs.Clicks == 2。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T04:56:56.520

您可能正在寻找的事件是[Control.MouseDoubleClick](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.mousedoubleclick.aspx)，每当鼠标双击控件时都会引发该事件。或者，如果您从 Control 派生，则可以覆盖[OnMouseDoubleClick](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.onmousedoubleclick.aspx)。

# .net - 对 Web 服务进行身份验证的最佳方式是什么

> ID：270945
> 
> 赞同：6
> 
> 时间：2008-11-07T01:12:11.073
> 
> 标签：.net, web-services, authentication

我们有一个 .NET Web 服务 API。目前，人们使用 SOAP 定义来使用 API，因为我们需要通过 SOAP 标头中的自定义 Authentication 元素进行身份验证。完美运行。美好的。

SOAP 要求请求是 POST。我们希望允许用户使用 GET 动词（因此它可以被缓存）。

那么，提供一个简单的 GET API（不一定是 Web 服务！）同时提供身份验证的最佳方式是什么？

示例 API 路由：

> `http://www.blah.com/api/Search?query=Foo`

这是可接受的常见做法吗？

> `http://www.blah.com/api/Search?query=Foo&Key=<some guid>`

注意：我也不想实现 SSL，也不想在 IIS 等中安装额外的软件或插件等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T03:37:56.570

如果需要保护 Web 服务，并且我假设它确实如此，因为您当前有一个 Authentication 标头，那么您应该重新考虑使用 GET 而不是使用 SSL，至少对于身份验证部分。至少我会通过 SSL 将授权请求发布到 Web 服务/应用程序。如果您不想为每个请求提供身份验证，那么您将需要接受（并在服务中生成）消费者可用于后续请求的授权 cookie。

出于您想要支持 GET 的确切原因，我会避免在 URL 中使用身份验证——如果可以缓存 URL，那么也会缓存凭据。这破坏了 Web 服务的安全性，因为任何人都可以重用缓存的凭据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-24T13:45:23.913

如果您的客户端在同一个域中，您可以在 IIS 应用程序中打开集成 Windows 身份验证。您的应用程序现在将只接受 Windows 身份验证的用户。添加您自己的 RoleProvider 以获得更精细的、基于角色的粒度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-24T08:55:18.413

如果您使用的是 WCF，则可以在内置安全机制的基础上进行构建。如果你不想使用标准的安全框架，你很可能会通过默默无闻的方式来做安全。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-23T12:50:21.077

使用 GET only API，我将有一个获取唯一会话 ID 的第一个方法。

例如： GET /api?action=auth&username=user&password=hashedpassword 将返回一个 16 个字符的令牌，您将其存储在您身边，并且每次后续调用都需要此唯一令牌。

如果 API 是在 PHP 中完成的，您可以使用 PHP 的会话处理功能来实现这一点（它具有超时/垃圾收集）。ASP.NET 中也有类似的功能。

它很容易受到重放攻击（有人抓取或猜测会话 ID），但如果你想要一些简单的东西，那就是要走的路。任何非 HTTPS 网站都会以同样的方式受到攻击。您可以将会话 ID 与用户的 IP 地址联系起来以提高安全性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-24T15:21:47.930

类似于 Thomas Eyde 的回答：您可以使用像 siteminder 这样的单点登录系统来保护 URL。调用者请求需要包含一个令牌，该令牌通常存储在 cookie 中，但可以添加到查询字符串中。

如果不使用 SSL，任何 SSO 或 Web 服务管理平台都会故意使身份验证变得困难。

# c++ - 任何人都可以为我提供 C++ 中的 Singleton 示例吗？

> ID：270947
> 
> 赞同：39
> 
> 时间：2008-11-07T01:12:21.980
> 
> 标签：c++, design-patterns, singleton

我按以下方式编写了一个单例 C++：

```
class A {
    private:
        static A* m_pA;
        A();
        virtual ~A();

    public:
        static A* GetInstance();
        static void FreeInstance();

        void WORK1();
        void WORK2();
        void WORK3();
    }
}

A* A::GetInstance() {
    if (m_pA == NULL)
        m_pA = new A();
    return m_pA;
}

A::~A() {
    FreeInstance()  // Can I write this? are there any potential error?
}

void A::FreeInstance() {
    delete m_pA;
    m_pA = NULL;
} 
```

谢谢！Evan Teran 和 sep61.myopenid.com 的回答是正确的，而且非常好！我的方法是错误的，我希望任何编写此类代码的人都能避免我的愚蠢错误。

我的项目中的单例A有一个智能指针向量，另一个线程也可以编辑这个向量，所以当应用程序关闭时，即使我添加了大量的CMutex，它总是变得不稳定。多线程错误 + 单例错误浪费了我 1 天。

//------------------------------------------------ ------------ 一个新的单例，如果您认为以下示例有任何问题，欢迎您编辑：

```
class A {
    private:
        static A* m_pA;
        explicit A();
        void A(const A& a);
        void A(A &a);
        const A& operator=(const A& a);
        virtual ~A();

    public:
        static A* GetInstance();
        static void FreeInstance();

        void WORK1();
        void WORK2();
        void WORK3();
    }
}

A* A::GetInstance() {
    if (m_pA == NULL){
        static A self;
        m_pA = &self;
    }
    return m_pA;
}

A::~A() {
} 
```

* * *

## 回答 #1

> 赞同：206
> 
> 时间：2008-11-07T02:51:26.193

为什么每个人都想返回一个单例作为指针？
将其作为参考返回似乎更合乎逻辑！

您永远不能手动释放单例。你怎么知道谁在引用单例？如果您不知道（或不能保证）没有人有引用（在您的情况下是通过指针），那么您没有释放对象的业务。

在函数方法中使用静态。
这保证了它只被创建和销毁一次。它还免费为您提供延迟初始化。

```
class S
{
    public:
        static S& getInstance()
        {
            static S    instance;
            return instance;
        }
    private:
        S() {}
        S(S const&);              // Don't Implement.
        void operator=(S const&); // Don't implement
 }; 
```

请注意，您还需要将构造函数设为私有。还要确保覆盖默认的复制构造函数和赋值运算符，这样你就不能复制单例（否则它不会是单例）。

另请阅读：

*   [https://stackoverflow.com/a/1008289/14065](https://stackoverflow.com/a/1008289/14065)
*   [单例：应该如何使用](https://stackoverflow.com/questions/86582/singleton-how-should-it-be-used)
*   [C++ 单例设计模式](https://stackoverflow.com/questions/1008019/c-singleton-design-pattern/1008289#1008289)

确保您出于正确的原因使用单例。

虽然在一般情况下技术上不是线程安全的，但请参阅：
[C++ 函数中静态变量的生命周期是多少？](https://stackoverflow.com/questions/246564/what-is-the-lifetime-of-a-static-variable-in-a-c-function)

GCC 有一个明确的补丁来弥补这一点：http:
[//gcc.gnu.org/ml/gcc-patches/2004-09/msg00265.html](http://gcc.gnu.org/ml/gcc-patches/2004-09/msg00265.html)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-07T01:16:56.947

您可以避免使用这样的静态对象来删除它：

```
if(m_pA == 0) {
    static A static_instance;
    m_pA = &static_instance;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-07T01:22:30.010

C++ 中的单例可以这样写：

```
static A* A::GetInstance() {
    static A sin;
    return &sin;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-07T01:24:40.237

只是不要忘记将复制构造函数和赋值运算符设为私有。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-07T01:20:24.507

我不认为有任何理由写那行没有。您的析构函数方法不是静态的，您的单例实例不会以这种方式被破坏。我认为析构函数不是必需的，如果您需要清理对象，请使用您已经创建的静态方法 FreeInstance()。

除此之外，您创建单身人士的方式与我创建单身人士的方式大致相同。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-07T11:41:25.223

在对 Meyers 风格的单例（在之前的一些答案中使用本地静态对象）充满热情之后，我完全厌倦了复杂应用程序中的生命周期管理问题。

我倾向于发现您最终会在应用程序初始化的早期故意引用“实例”方法，以确保在您需要时创建它们，然后由于不可预测（或至少非常复杂且有些隐藏）事物被破坏的顺序。

当然是 YMMV，这在一定程度上取决于单例本身的性质，但是关于聪明的单例（以及围绕聪明的线程/锁定问题）的许多华夫饼被高估了 IMO。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-07T11:56:00.373

如果您阅读“现代 C++ 设计”，您会意识到单例设计可能比返回静态变量要复杂得多。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-07T11:10:57.403

有一个很棒的 C++ 库，ACE，它基于模式。有很多关于不同类型模式的文档，所以看看他们的工作： [http ://www.cs.wustl.edu/~schmidt/ACE.html](http://www.cs.wustl.edu/~schmidt/ACE.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-07T12:10:25.070

只要你能回答这些问题，这个实现就很好：

1.  你知道什么时候会创建对象（如果你使用静态对象而不是新对象？你有 main() 吗？）

2.  您是否有任何在创建时可能尚未准备好的依赖项？如果使用静态对象而不是new，此时已经初始化了哪些库？您的对象在可能需要它们的构造函数中做了什么？

3.  什么时候会被删除？

使用 new() 更安全，因为您可以控制创建和删除对象的位置和时间。但是随后您需要明确删除它，并且系统中可能没有人知道何时这样做。如果有意义的话，您可以使用 atexit() 。

在方法中使用静态对象意味着不知道何时创建或删除它。您也可以在命名空间中使用全局静态对象并完全避免 getInstance() - 它不会增加太多。

如果你确实使用线程，那么你就有大麻烦了。在 C++ 中创建可用的线程安全单例几乎是不可能的，因为：

1.  getInstance 中的永久锁定非常重 - 在每个 getInstance() 处进行完整的上下文切换
2.  由于编译器优化和缓存/弱内存模型，双重检查锁失败，实现起来非常棘手，并且无法测试。我不会尝试在真实系统中执行此操作，除非您非常了解您的架构并希望它不可移植

这些可以很容易地用谷歌搜索，但这里有一个关于弱内存模型的很好的链接：[http](http://ridiculousfish.com/blog/archives/2007/02/17/barrier) ://ridiculousfish.com/blog/archives/2007/02/17/barrier 。

一种解决方案是使用锁定，但要求用户缓存他们从 getInctance() 获得的指针，并为 getInstance() 变重做好准备。

另一种解决方案是让用户自己处理线程安全。

另一种解决方案是使用具有简单锁定功能的函数，并在调用 new() 后将其替换为另一个函数，而无需锁定和检查。这可行，但完整的实现很复杂。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-01-09T21:01:36.110

```
//! @file singleton.h
//!
//! @brief Variadic template to make a singleton out of an ordinary type.
//!
//! This template makes a singleton out of a type without a default
//! constructor.

#ifndef SINGLETON_H
#define SINGLETON_H

#include <stdexcept>

template <typename C, typename ...Args>
class singleton
{
private:
  singleton() = default;
  static C* m_instance;

public:
  singleton(const singleton&) = delete;
  singleton& operator=(const singleton&) = delete;
  singleton(singleton&&) = delete;
  singleton& operator=(singleton&&) = delete;

  ~singleton()
  {
    delete m_instance;
    m_instance = nullptr;
  }

  static C& create(Args...args)
  {
    if (m_instance != nullptr)
      {
    delete m_instance;
    m_instance = nullptr;
      }
    m_instance = new C(args...);
    return *m_instance;
  }

  static C& instance()
  {
    if (m_instance == nullptr)
      throw std::logic_error(
        "singleton<>::create(...) must precede singleton<>::instance()");
    return *m_instance;
  }
};

template <typename C, typename ...Args>
C* singleton<C, Args...>::m_instance = nullptr;

#endif // SINGLETON_H 
```

# sql - 如何在 SQL 2005 上使用 FOR XML PATH 时保留与号 (&)

> ID：270948
> 
> 赞同：34
> 
> 时间：2008-11-07T01:12:25.053
> 
> 标签：sql, xml, sql-server-2005

是否有任何技巧可以防止 SQL Server 实体化 &、< 和 > 等字符？我正在尝试在我的 XML 文件中输出一个 URL，但 SQL 想要用 ' ' 替换任何 '& `&amp;`'

进行以下查询：

```
SELECT 'http://foosite.com/' + RTRIM(li.imageStore)
        + '/ImageStore.dll?id=' + RTRIM(li.imageID)
        + '&raw=1&rev=' + RTRIM(li.imageVersion) AS imageUrl
FROM ListingImages li
FOR XML PATH ('image'), ROOT ('images'), TYPE 
```

我得到的输出是这样的（&s被实体化了）：

```
<images>
  <image>
    <imageUrl>http://foosite.com/pics4/ImageStore.dll?id=7E92BA08829F6847&amp;raw=1&amp;rev=0</imageUrl>
  </image>
</images> 
```

我想要的是这个（&s 没有实体化）：

```
<images>
  <image>
    <imageUrl>http://foosite.com/pics4/ImageStore.dll?id=7E92BA08829F6847&raw=1&rev=0</imageUrl>
  </image>
</images> 
```

如何防止 SQL 服务器将 '&' 实体化为 ' `&amp;`'？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2011-12-31T06:16:54.297

在某些情况下，人们可能不想要格式良好的 XML——我（也许是原始发帖人）遇到的情况是使用 For XML Path 技术通过递归查询返回“子”项的单个字段列表。有关此技术的更多信息，请参见此处（特别是在“黑盒 XML 方法”部分）： [在 Transact-SQL 中连接行值](https://www.simple-talk.com/sql/t-sql-programming/concatenating-row-values-in-transact-sql/)

对于我的情况，看到“H&E”（一种病理染色）转换为“格式良好的 XML”真是令人失望。幸运的是，我找到了一个解决方案......以下页面帮助我相对轻松地解决了这个问题，并且没有重新设计我的递归查询或在表示级别添加额外的解析（对于这个以及我的孩子的其他/未来情况-rows 数据字段包含保留的 XML 字符）：[使用 FOR XML PATH 处理特殊字符](http://blogs.lobsterpot.com.au/2010/04/15/handling-special-characters-with-for-xml-path/)

* * *

编辑：下面的代码来自引用的博客文章。

```
select
  stuff(
     (select ', <' + name + '>'
     from sys.databases
     where database_id > 4
     order by name
     for xml path(''), root('MyString'), type
     ).value('/MyString[1]','varchar(max)')
   , 1, 2, '') as namelist; 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-07T01:44:35.080

SQL Server 生成的内容是正确的。您期望看到的不是格式良好的 XML。原因是`&`字符表示实体引用的开始，例如`&amp;`. 有关详细信息，请参阅[XML 规范](http://www.w3.org/TR/REC-xml/#sec-references)。

当您的 XML 解析器从 XML 中解析出这个字符串时，它将理解`&amp;`实体引用并以您想要的形式返回文本。因此，除非您使用有缺陷的 XML 解析器或尝试手动解析，否则 XML 文件中的内部格式不会给您带来问题（在这种情况下，您当前的解析器代码目前相对于 XML 来说实际上是有缺陷的）规格）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-04-08T11:05:47.913

试试这个....

```
select 
  stuff( 
     (select ', <' + name + '>' 
     from sys.databases 
     where database_id > 4 
     order by name 
     for xml path(''), root('MyString'), type 
     ).value('/MyString[1]','varchar(max)') 
   , 1, 2, '') as namelist; 
```

# java - 链表移除方法

> ID：270950
> 
> 赞同：9
> 
> 时间：2008-11-07T01:14:30.273
> 
> 标签：java, data-structures, linked-list

什么是双向链表的删除方法？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-07T01:47:44.467

[蜥蜴比尔](https://stackoverflow.com/questions/270950/linkedlist-remove-method#270962)所说的相同算法，但以图形方式:-)

[![从链接列表中删除](https://i.stack.imgur.com/dbGK6.gif)](https://i.stack.imgur.com/dbGK6.gif)
[（来源：[jaffasoft.co.uk](http://www.jaffasoft.co.uk/feature/ll/fig4.gif)）]

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-11-07T01:18:51.153

一般算法如下：

*   找到要删除的节点。
*   node.previous.next = node.next
*   node.next.previous = node.previous
*   node.previous = null
*   node.next = null
*   如果您在非 GC 环境中，请处理节点

您必须检查前一个和下一个节点是否为空，以查看您是删除头部还是尾部，但这些都是简单的情况。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-07T01:49:29.063

```
public void remove ()
{
    if (getPreviousNode () != null)
        getPreviousNode ().setNextNode (getNextNode ());
    if (getNextNode () != null)
        getNextNode ().setPreviousNode (getPreviousNode ());    
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-10T17:24:20.113

双向链表实现删除方法（来自我的第二个编程作业）：

```
public void remove(int index) {
    if(index<0 || index>size())
    throw new IndexOutOfBoundsException("Index out of bounds. Can't remove a node. No node exists at the specified index");
    if(size()==0) {
        throw new NullPointerException("Empty list");
    }
    if(!isEmpty()) {
        Node current;
        //starting next one to our head
        current = head.next;
        for(int i=0;i<index;i++) {
            current = current.next;
        }
        current.previous.next = current.next;
        current.next.previous = current.previous;
        numOfNodes--;
        sizeChangeCount++;
    }
}

public boolean remove(T o) {
    Node current = head;
    for(int i=0;i<size();i++) {
        current=current.next;
        if(current.data.equals(o)) {
            current.previous.next = current.next;
            current.next.previous = current.previous;
            numOfNodes--;
            sizeChangeCount++;
            return true;
        }           
    }
    return false;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-07T01:20:02.527

您是在询问 api 中方法的名称吗？假设您询问 java.util.LinkedList 实际上是一个双链表，那么该答案将被删除。

...或者您是在问从该类型的数据结构中删除元素的算法的名称是什么？嗯.. 答案也是删除一个元素。现在让实际的算法来做到这一点......实际上只是改变前一个节点中的下一个指针和下一个节点中的最后一个指针的问题。但是，如果您从多个线程使用数据结构，则需要同步 remove 方法，或者按照对数据结构的使用模式有意义的顺序执行删除步骤。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-09T17:31:56.043

那么当前指针指针呢？您必须将 crnt 移动到下一个节点。 [http://pastebin.ca/1249635](http://pastebin.ca/1249635)

# ruby-on-rails - 使用 RSpec 在测试数据库中创建/重新创建迁移生成的记录

> ID：270969
> 
> 赞同：3
> 
> 时间：2008-11-07T01:20:36.487
> 
> 标签：ruby-on-rails, ruby, rspec

我在 Rails 中有一个将记录插入数据库的迁移。类别模型取决于此记录。由于 RSpec 在每个示例之前都会清除数据库，因此该记录会丢失，而且似乎永远不会创建，因为 RSpec 似乎不会从迁移中生成数据库。在数据库中创建/重新创建此记录的最佳方法是什么？它会使用 before(:all) 吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-07T05:21:02.617

不是 RSpec 清除数据库，而是 Rails 的 rake:db:prepare 任务将您的开发数据库的*模式*（但不是内容）复制到您的 *_test 数据库中。

是的，您可以使用`before(:all)`，因为事务是围绕每个单独的示例进行的 - 但是一个简单的夹具文件也可以完成相同的工作。

（这个问题有一个更复杂的通用解决方案：迁移到面向服务的架构，您的“开发”和“测试”服务将是完全独立的实例。然后您可以将您的测试数据库配置指向开发数据库您的测试服务，禁用 rake:db:prepare，并在重新生成时从迁移构建您的测试服务。然后您可以测试迁移和数据转换。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-07T05:30:17.230

我喜欢做的是在 db/migration 中创建一个名为 data 的文件夹，然后将 yml 固定装置放在那里，在您的情况下为 categories.yml

然后我使用以下内容创建迁移

```
def self.up
 向下
 目录 = File.join( File.dirname(__FILE__), "data" )
 Fixtures.create_fixtures（目录，“类别”）
结尾

def self.down
  类别.delete_all
结尾

```

# python - 如何使用 urllib2 将经过身份验证的代理异常应用于开启程序？

> ID：270983
> 
> 赞同：4
> 
> 时间：2008-11-07T01:29:14.783
> 
> 标签：python, windows, proxy

在 Windows 上使用 urllib2（可能还有 urllib）时，python 似乎神奇地获取了应用于 InternetExplorer 的经过身份验证的代理设置。但是，它似乎没有检查和处理高级设置“例外”列表。

有没有办法让它处理例外列表？或者，忽略 IE 代理设置并应用我自己的代理开启器来解决这个问题？

我之前玩过创建代理开启器，但无法让它工作。这是我设法挖掘出来的内容，但我仍然看不到如何/在哪里应用任何例外，我什至不确定这是否正确：

```
proxy_info = {
                      'host':'myproxy.com',
                      'user':Username,
                      'pass':Password,
                      'port':1080
                      }                                                   

http_str = "http://%(user)s:%(pass)s@%(host)s:%(port)d" % proxy_info

authInfo = urllib2.HTTPBasicAuthHandler()
authInfo.add_password()
proxy_dict = {'http':http_str}
proxyHandler = urllib2.ProxyHandler(proxy_dict)

# apply the handler to an opener
proxy_opener = urllib2.build_opener(proxyHandler, urllib2.HTTPHandler)

urllib2.install_opener(proxy_opener) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-07T01:58:09.577

默认情况下`urllib2`，从环境变量中获取代理设置，这就是它使用 IE 设置的原因。这非常方便，因为您不需要自己设置身份验证。

您不能像您想要的那样应用例外，最简单的方法是拥有两个`opener`s 并根据域是否在您的例外列表中来决定使用哪一个。

当你想使用代理时使用默认值`opener`，当你不需要它时使用没有代理：

```
>>> no_proxy = urllib2.ProxyHandler({})
>>> opener = urllib2.build_opener(no_proxy)
>>> urllib2.install_opener(opener) 
```

从[这里](http://docs.python.org/howto/urllib2.html?highlight=proxyhandler#proxies)。

**编辑：**

这是我的做法：

```
exclusion_list = ['http://www.google.com/', 'http://localhost/']

no_proxy = urllib2.ProxyHandler({})
no_proxy_opener = urllib2.build_opener(no_proxy)

default_proxy_opener = urllib2.build_opener()

url = 'http://www.example.com/'

if url in exclusion_list:
    opener = no_proxy_opener
else:
    opener = default_proxy_opener

page = opener.open(url)
print page 
```

您最大的问题是将 url 与排除列表匹配，但这是一个全新的问题。

# c++ - g ++部分链接而不是档案？

> ID：270984
> 
> 赞同：8
> 
> 时间：2008-11-07T01:30:03.580
> 
> 标签：c++, g++, linker

我对 C++ 构建流程很陌生，我正在考虑切换到对我的库使用部分链接而不是创建`ar`档案。我希望在不可避免的最终编译步骤中减少链接时间，并且我认为部分链接一些库一次可以节省我在最后一步链接所有内容的时间。

我描述的可能吗？我认为它应该是大体上的东西`ld -Ur -o mylib.o [components]`。是否有我没有考虑到的重要构建注意事项？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-07T01:41:18.520

您失去了将对象文件保存在`ar`存档中的一个重要影响，即只有引用的对象将被链接。

如果您在存档中同时`foo.o`拥有符号`foo`和 bar.o ，并且仅引用该符号，则只会被链接。如果您改为进行部分链接，则两者的内容都将最终出现在可执行文件中，甚至if从未在任何地方引用。`bar``ar``foo``foo.o``bar`

您还可以尝试更快的链接器，例如[gold](http://lwn.net/Articles/274859/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-10-16T01:55:52.180

您想使用 ld -r 进行部分链接的另一次是如果您有一些包含提供某些功能所需的静态初始化的目标文件，但任何代码都不会直接调用。

如果您愿意，我可以编写一份文档来展示它的工作原理以及它的工作原理！

（例如，请参阅运行时 C++ 类注册，它使用静态注册函数将自身注册到注册表中，然后可以使用该函数创建并返回具有多态行为的 Base*，因为它创建了一个从 Base 继承的新对象。请参阅[类的 C++ 运行时知识，](https://stackoverflow.com/questions/77817/c-runtime-knowledge-of-classes/77911#77911)这是我提出的问题的答案。）

# search - 是否有不使用搜索索引文件的开源 Web 搜索库？

> ID：270997
> 
> 赞同：0
> 
> 时间：2008-11-07T01:42:26.037
> 
> 标签：search

我正在寻找一个不使用搜索索引文件的开源网络搜索库。你知道任何？

谢谢，肯尼斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T01:54:01.787

原始发帖人在对该回复的评论中澄清说，他正在寻找的本质上是“greplike search but through HTTP”，并提到他正在寻找使用小磁盘的东西，因为他正在使用嵌入式系统。

我不知道有任何相关项目，但您可能想查看您选择的语言中的 html 解析器和 xquery 实现。您应该能够使用前者处理 html 的“现实生活”混乱，并编写一个几乎与您对后者的期望一样详细的搜索。

我假设您将使用一组将提供或已经存储在本地的 url，因为在嵌入式设备中实际爬取整个网络、发现链接等的想法是完全不现实的。

尽管有一个很好的 html/xquery 实现，但您确实拥有提取所有链接的工具。

*我原来的回答，真的是要求澄清*：

不明白你的意思。您如何想象没有索引的搜索？为每个查询爬网？通过管道连接到谷歌？还是您指的是您要避免的特定类型的搜索索引文件？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T02:14:03.680

你的意思是：

搜索.cgi

```
#/bin/sh
arg=`echo $QUERY | sed -e 's/^s=//' -e 's/&.*$//'`
cd /var/www/httpd
find . -type f | xargs egrep -l "$arg" | awk 'BEGIN { 
        print "Content-type: text/html"; 
        print "";
        print "<HTML><HEAD><TITLE>Search Result</TITLE></HEAD>";
        print "<BODY><P>Here are your search results, sorry it took so long.</P>";
        print "<UL>";
    }
    { print  "<LI><A HREF=\"http://yourhost.com/" $1 "\">" $1 "</A></LI>"; }
    END {
        print "</UL></BODY>";
    }' 
```

未经测试...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T08:50:08.343

我想没有（至少这对于这里的用户来说足够流行）。

我们已经着手编写我们自己的搜索系统。********``