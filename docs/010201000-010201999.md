# StackOverflow 问答 10201000-10201999

# c# - 将单个数据添加到多个列表框？

> ID：10201000
> 
> 赞同：0
> 
> 时间：2012-04-18T00:13:51.630
> 
> 标签：c#, winforms

我正在为一个程序编写代码，该程序要求用户输入有关他们家的数据。他们有两个选择。他们可以输入关于他们的家或公寓的信息。他们输入有关房产 ID、地址、卧室、建造年份、价格和平方英尺的数据，并在两个单独的文本框中输入有关其是否配备的信息（这是用于公寓选项）或他们输入车库容量（这是对于房子选项）。这六个参数适用于基类，家具或车库容量是公寓或房屋的两个子类。当用户单击“添加公寓”或“添加房屋”按钮时，地址应该进入公寓列表框或家庭列表框。这是我遇到障碍的地方。

```
private void btnAddApartment_Click(object sender, EventArgs e)
{
    //instantiate appartment and add it to arraylist
    try
    {
        Apartment anApartment = new Apartment(txtID.Text, txtAddress.Text, int.Parse(txtYearBuilt.Text), int.Parse(txtBedrooms.Text),
            double.Parse(txtSquareFootage.Text), double.Parse(txtPrice.Text), txtFurnished.Text);
        Home.Add(anApartment);
        ClearText(this);
    }
    catch (Exception)
    {
        MessageBox.Show("Make sure you entered everything correctly!", "Error", MessageBoxButtons.OK);
    }            

}

private void btnAddHouse_Click(object sender, EventArgs e)
{
    try 
    {
        House aHouse=new House(txtID.Text, txtAddress.Text, int.Parse(txtYearBuilt.Text), int.Parse(txtBedrooms.Text),
            double.Parse(txtSquareFootage.Text), double.Parse(txtPrice.Text),int.Parse(txtGarageCapacity.Text));
        Home.Add(aHouse);
        AddHouseToListBox();
        ClearText(this);
    }
    catch (Exception)
    {
        MessageBox.Show("Make sure you entered everything correctly!", "Error", MessageBoxButtons.OK);
    }
}

private void ClearText(Control controls)
{
    foreach (Control control in controls.Controls)
    {
        if (control is TextBox)
        {
            ((TextBox)control).Clear();
        }
    }
}

private void AddHouseToListBox()
{
    lstHouse.Items.Clear();
    foreach (House person in Home)
    {
        lstHouse.Items.Add(person.GetAddress());
    }
}

private void AddApartmentToListBox()
{
    lstApartment.Items.Clear();
    foreach (Apartment persons in Home)
    {
        lstApartment.Items.Add(persons.GetAddress());
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T00:57:07.670

您需要调用`AddApartmentToListBox`btnAddApartment_Click

```
private void btnAddApartment_Click(object sender, EventArgs e)
{
//instantiate appartment and add it to arraylist
try
{
    Apartment anApartment = new Apartment(txtID.Text, txtAddress.Text, int.Parse(txtYearBuilt.Text), int.Parse(txtBedrooms.Text),
        double.Parse(txtSquareFootage.Text), double.Parse(txtPrice.Text), txtFurnished.Text);
    Home.Add(anApartment);
    AddApartmentToListBox();
    ClearText(this);
}
catch (Exception)
{
    MessageBox.Show("Make sure you entered everything correctly!", "Error", MessageBoxButtons.OK);
} 
```

}

也不是每次可以替换时都清除并添加到列表`AddApartmentToListBox`框

```
lstApartment.Items.Add(anApartment.GetAddress()); 
```

并`AddHouseToListBox`与

```
lstHouse.Items.Add(aHouse.GetAddress()); 
```

# php - 用php显示mysql表

> ID：10201007
> 
> 赞同：2
> 
> 时间：2012-04-18T00:14:22.073
> 
> 标签：php, mysql

我无法使用 php 代码显示我的 mysql 表。它显示的只是列名，而不是与它们关联的值。我知道我的用户名密码和数据库都是正确的，但就像我说的表格没有显示我添加的值。任何帮助将不胜感激这是我的mysql代码：

```
CREATE TABLE Guitars
(
  Brand  varchar(20)  NOT NULL,
  Model  varchar(20)  NOT NULL,
  PRIMARY KEY(Brand)
);

insert into Guitars values('Ibanez','RG');
insert into Guitars values('Ibanez','S');
insert into Guitars values('Gibson','Les Paul');
insert into Guitars values('Gibson','Explorer'); 
```

这是我的 php 代码：

```
<?php
$db_host = '*****';
$db_user = '*****';
$db_pwd = '*****';

$database = '*****';
$table = 'Guitars';

if (!mysql_connect($db_host, $db_user, $db_pwd))
    die("Can't connect to database");

if (!mysql_select_db($database))
    die("Can't select database");

// sending query
$result = mysql_query("SELECT * FROM {$table}");
if (!$result) {
    die("Query to show fields from table failed");
} 

$fields_num = mysql_num_fields($result);

echo "<table border='1'><tr>";
// printing table headers
for($i=0; $i<$fields_num; $i++)
{
    $field = mysql_fetch_field($result);
    echo "<td>{$field->name}</td>";
}
echo "</tr>\n";
// printing table rows
while($row = mysql_fetch_row($result))
{
    echo "<tr>";

    // $row is array... foreach( .. ) puts every element
    // of $row to $cell variable
     foreach($row as $cell)
        echo "<td>$cell</td>";

    echo "</tr>\n";
}
mysql_free_result($result);
?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T00:27:00.220

试试这个：

```
// printing table rows
while($row = mysql_fetch_row($result))
{
    echo "<tr>";

    echo "<td>$row[0]</td>";
    echo "<td>$row[1]</td>";

    echo "</tr>\n";
} 
```

***更新：***

注意：您不能将品牌作为主键，因为您将为不同的型号添加相同的品牌名称。

![在此处输入图像描述](../Images/98f158ff71647771e28b1d1fa0270232.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T00:49:01.493

我不明白你为什么要使用这个`fetch_field`电话。我假设您在调用数据*之前提前知道表中每个字段的实际名称是什么？*我认为为简单起见（更少的循环和嵌套循环），您应该手动编写字段的名称，然后遍历输入值的数据。

```
$feedback .= "<table border='1'><tr>";
$feedback .= "<th>Brand</th><th>Model</th></tr>";

while ($row = mysql_fetch_array($result)) {
   $feedback .= "<tr><td>" . $row['Brand'] . "</td>";
   $feedback .= "<td>" . $row['Model'] . "</td></tr>";
}

$feedback .= "</table>";

echo $feedback; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T00:21:26.463

当您完成显示标题时，查询结果的内部指针将到达最后一行，因此您的`mysql_fetch_row()`调用失败，因为没有更多行可获取。在打印表格行之前调用`mysql_data_seek(0);`，将内部指针移回第一行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T00:38:11.063

您也可以尝试获取数据

```
while ($fielddata = mysql_fetch_array($result))
{
    echo '<tr>';
    for ($i = 0; $i<$fields_num; $i++) // $fields_num already exists in your code
    {
        $field = mysql_fetch_field($result, $i);
        echo '<td>' . $fielddata[$field->name] . '</td>';
    }
    echo '</tr>';
} 
```

# python - 连续两次使用“readlines()”

> ID：10201008
> 
> 赞同：5
> 
> 时间：2012-04-18T00:14:32.193
> 
> 标签：python, io, readlines

我正在尝试做这样的事情：

```
Lines = file.readlines()
# do something
Lines = file.readlines() 
```

但第二次`Lines`是空的。这正常吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-18T00:17:15.077

是的，因为`.readlines()`将文件指针推进到文件末尾。

为什么不将行的副本存储在变量中？

```
file_lines = file.readlines()
Lines = list(file_lines)
# do something that modifies Lines
Lines = list(file_lines) 
```

这比敲击磁盘两次要高效得多。（请注意，该`list()`调用是创建列表副本所必需的，这样对 的修改`Lines`不会影响`file_lines`。）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-18T00:17:22.947

您需要使用重置文件指针

```
file.seek(0) 
```

使用前

```
file.readlines() 
```

再次。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-01T15:59:01.597

为了不必一次又一次地使用 seek 方法来重置，请使用 readlines 方法，但您必须将其存储在变量中，如下例所示：

```
%%writefile test.txt
this is a test file!
#open it
op_file = open('test.txt')
#read the file
re_file = op_file.readlines()
re_file
#output
['this is a test file!']
# the output still the same
re_file
['this is a test file!'] 
```

# perl - 如何检测更改的网页？

> ID：10201009
> 
> 赞同：2
> 
> 时间：2012-04-18T00:14:48.033
> 
> 标签：perl, webpage, crc, lwp

在我的应用程序中，我使用 LWP 定期获取网页。无论如何要检查网页是否在两次连续获取之间在某些方面发生了变化（除了明确地进行比较）？是否有任何在较低协议层生成的签名（例如 CRC）可以被提取并与旧签名进行比较以查看可能的变化？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T05:28:01.737

有两种可能的方法。一种是使用页面的摘要，例如

```
use strict;
use warnings;

use Digest::MD5 'md5_hex';
use LWP::UserAgent;

# fetch the page, etc.
my $digest = md5_hex $response->decoded_content;

if ( $digest ne $saved_digest ) { 
    # the page has changed.
} 
```

*如果*服务器为请求的资源提供了一个 HTTP ETag，另一种选择是使用 HTTP ETag 。您可以简单地存储它，然后将您的请求标头设置为`If-None-Match`在后续请求中包含一个字段。如果服务器 ETag 保持不变，您将获得一个`304 Not Modified`状态和一个空的响应正文。否则，您将获得新页面。（以及新的 ETag。）请参阅RFC2616 中的[实体标签](http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html)。

当然，服务器可能在撒谎，即使内容发生了变化，也会发送相同的 ETag。除非你看，否则没有办法知道。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T09:24:35.143

您应该使用`If-Modified-Since` [请求标头](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)，注意 RFC 中的问题。您将此标头与请求一起发送。如果服务器支持它并认为内容较新，则会将其发送给您。如果它认为您拥有最新版本，它会返回`304`没有消息正文的消息。

但是，正如其他答案所指出的那样，服务器不必告诉您真相，因此您有时会卡住下载内容并自行检查。许多动态事物总是声称拥有新内容，因为许多开发人员从未想过在他们的 Web 应用程序中支持基本的 HTTP 事物。

对于 LWP 位，您可以创建带有额外标头的单个请求：

```
use HTTP::Request;
use LWP::UserAgent;

my $ua = LWP::UserAgent->new;
my $request = HTTP::Request->new( GET => $url );
$r->header( 'If-Modified-Since' => $time );

$ua->request( $request ); 
```

对于所有请求，您可以设置请求处理程序：

```
$ua->add_handler(
    request_send => sub { 
        my($request, $ua, $h) = @_; 
        # ... look up time from local store
        $r->header( 'If-Modified-Since' => $time );
        }
    ); 
```

`mirror`但是，如果您想保存文件，LWP 可以为您完成大部分工作：

```
$ua->mirror( $url, $filename ) 
```

# actionscript-3 - 在 actionscript 中查找未引用的公共方法

> ID：10201017
> 
> 赞同：0
> 
> 时间：2012-04-18T00:15:34.073
> 
> 标签：actionscript-3, actionscript, static-analysis, public-method

是否有任何工具可以从 actionscript 代码中找到未引用的公共方法？我知道 FlexPMD，但它只提供未使用的私有方法列表。

# javascript - 检查是否有超时等待运行？

> ID：10201020
> 
> 赞同：5
> 
> 时间：2012-04-18T00:15:57.557
> 
> 标签：javascript, settimeout

我正在处理一个无限滚动样式页面（对于无限滚动的示例，请单击[此处](http://mylittlefacewhen.com)并向下滚动），它运行一个在`update()`每次用户滚动时调用的函数，等等。

我可以`setInterval`改为使用并检查每 x 毫秒，但是通过调用自身的超时，页面响应更快、更可靠。

基本上，`update()`向页面添加一些内容，然后，如果该内容不足以让您向下滚动更多，请设置超时以`update()`再次调用。如果您只滚动一个像素，这会很好，但当然，当您滚动时，它会发送数十或数百个滚动事件。这会成为一个问题，因为一次会有数十个（或数百个）超时运行。有太多的超时会破坏我想要添加新内容的一致动画。

所以我想使用我拥有的 ID 检查超时是否已经在等待执行，但是似乎没有一个函数可以用于 JavaScript。有没有办法检查超时 ID 是否已经执行？如果没有，有替代方案吗？我有 jQuery。

...或者我应该只做一个间隔并牺牲响应能力？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T00:53:18.820

当函数触发时，清除间隔并将您保存初始值的变量设置为 null。然后检查空值。如果你正在做一堆这些，你可以通过你拥有的 id 将它们存储在一个数组中。

例如：

```
var intervals = [];

if(intervals[id] != null){
    intervals[id] = setTimeout(some_func, 1000);

    var some_func = function(){
        // do stuff
        clearTimeout(intervals[id]);
        intervals[id] = null;
    }
} 
```

# css - 在 emacs 中，如何向 css 派生模式添加第二种类型的注释？

> ID：10201022
> 
> 赞同：1
> 
> 时间：2012-04-18T00:16:03.330
> 
> 标签：css, emacs, comments, cheetah

我有一个模板 css 文件类型，它允许注释以“##”开头，尽管我尝试了什么，但它似乎在我的派生模式中无法识别这一点。这是我到目前为止所拥有的

```
(define-derived-mode cheetah-css-mode css-mode "cheetah-css"
   (make-face 'cheetah-css-variable-face)
   (font-lock-add-keywords
    nil
    '(("\\(##.*\\)\n" font-lock-comment-face)) (font-lock-mode 1))) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T02:17:28.833

您真正想要做的是修改您的模式的语法表以识别`##`为注释。然后 Emacs 将能够在所有方面都这样对待它（而不仅仅是突出显示）。

看：

*   `M-:` `(info "(elisp) Syntax Descriptors")` `RET`
*   `M-:` `(info "(elisp) Syntax Flags")` `RET`
*   `M-:` `(info "(elisp) Syntax Class Table")` `RET`

在您的派生模式定义中尝试此操作：

```
(modify-syntax-entry ?# "' 12b" cheetah-css-mode-syntax-table)
(modify-syntax-entry ?\n "> b" cheetah-css-mode-syntax-table) 
```

# javascript - Google Maps API v3 自定义标记未出现

> ID：10201026
> 
> 赞同：0
> 
> 时间：2012-04-18T00:16:25.800
> 
> 标签：javascript, google-maps, google-maps-markers, directions

我想在我的网站上显示类似于谷歌地图公交路线的东西，所以我试图在同一张地图上显示多种不同类型的路线。例如，我想展示一个旅行，你步行到公共汽车，乘公共汽车到其他街道，然后步行到你的最终目的地。

为此，我试图使用自定义标记在同一张地图上获取多个方向请求的结果。我有一个名为 change_map() 的函数，它应该在地图上显示其中一次旅行的信息。

我有两个问题：

1.  标记未显示在地图上。
2.  当未注释 fitbounds 时，我收到超出堆栈限制的错误

我是 javascript 新手，如果我的代码很糟糕，我很抱歉，感谢您的帮助！

```
 var trip_map

  function renderDirections(result) {
    var directionsDisplay = new google.maps.DirectionsRenderer;
    directionsDisplay.setMap(trip_map);
    directionsDisplay.suppressMarkers = true;
    directionsDisplay.setDirections(result);
  } 

  function requestDirections(start, end) {
    var directionsService = new google.maps.DirectionsService;
    directionsService.route({
      origin: start,
      destination: end,
      travelMode: google.maps.DirectionsTravelMode.DRIVING
    }, function(result) {
      renderDirections(result);
    });
  }

  function change_map(pk) {
      var myOptions = {
        center: new google.maps.LatLng(-34.397, 150.644),
        zoom: 8,
        mapTypeId: google.maps.MapTypeId.ROADMAP
      };
      trip_map = new google.maps.Map(document.getElementById("trip_map"), 
                                     myOptions);

      var bounds = new google.maps.LatLngBounds();       
      for (var j = 0; j < latlngpairs.length; j++) {
      var GPS = new google.maps.LatLng({lat:latlngpairs[0],
                                            lng:latlngpairs[1]});
          var end_marker = new google.maps.Marker({position: GPS, 
                                                   map: trip_map, 
                                                   title: "Hello World!"});
          bounds.extend(end_GPS);
        }
        requestDirections(parts[j], parts[j+1]);
    }
    //trip_map.fitBounds(bounds);
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T00:46:19.260

我认为问题在于您将单个对象作为参数传递给循环内的 LatLng 的构造函数

改变

```
var GPS = new google.maps.LatLng({lat:latlngpairs[0],lng:latlngpairs[1]}); 
```

和

```
var GPS = new google.maps.LatLng(latlngpairs[0],latlngpairs[1]); 
```

希望能解决它。

# php - 如何计算数字的百分比？

> ID：10201027
> 
> 赞同：68
> 
> 时间：2012-04-18T00:16:49.997
> 
> 标签：php, percentage

我想用 PHP 计算一个数字的百分比。例如：

```
$percentage = 50;
$totalWidth = 350; 
```

对于此示例，350 的 50% = 175

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：171
> 
> 时间：2012-04-18T00:23:42.610

```
$percentage = 50;
$totalWidth = 350;

$new_width = ($percentage / 100) * $totalWidth; 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-04-18T00:17:51.313

除以`$percentage`100 并乘以`$totalWidth`。简单的数学。

# node.js - 使用椭圆曲线密钥创建服务器和客户端时使用 Node JS TLS 密码和密码选项（无共享密码套件错误）

> ID：10201030
> 
> 赞同：2
> 
> 时间：2012-04-18T00:17:18.470
> 
> 标签：node.js, cryptography, openssl, ssl, elliptic-curve

关于[这个问题](https://stackoverflow.com/questions/10185110/key-generation-requirements-for-tls-ecdhe-ecdsa-aes128-gcm-sha256)，我试图在 node.js 中启动一个 TLS 服务器，以反映我在 OpenSSL 中创建的那个。我已经从命令行使用 OpenSSL 测试了客户端和服务器，它们成功建立了连接。当我尝试将服务器移植到 node.js（并且仍然使用 OpenSSL 客户端连接到它）时，我收到“无共享密码”错误。我想知道在使用该`passphrase`选项时是否需要做一些特别的事情`tls.createServer()`

下面是我分别针对服务器和客户端的成功 OpenSSL 命令，请注意 passphrase.txt 文件包含一行密码：

```
$ openssl s_server -accept 8888 -cert server.cert -key server.key -pass file:passphrase.txt -CAfile ca.cert
$ openssl s_client -connect 127.0.0.1:8888 -cert client.cert -key client.key -pass file:passphrase.txt -CAfile ca.cert 
```

如果我使用附加参数为客户端和/或服务器指定密码，我也可以建立成功的连接`-cipher 'ECDHE-ECDSA-AES128-GCM-SHA256'`。我正在使用由 CA 生成`openssl ecparam`并签名的椭圆曲线密钥，该 CA 是使用`openssl ca`我在[上一个问题](https://stackoverflow.com/questions/10185110/key-generation-requirements-for-tls-ecdhe-ecdsa-aes128-gcm-sha256)中讨论的。

用 node.js 编写的服务器代码如下所示：

```
var tls = require('tls');
var fs = require('fs');
var msg = '***********\n\nHello there secure client!\n\n***********';
var port = 8888;
var host = 'localhost'; 

var options = {
    cert : fs.readFileSync('server.cert'),
    key : fs.readFileSync('server.key'),
    passphrase :  (fs.readFileSync('passphrase.txt')).toString(),
    ca : fs.readFileSync('ca.cert'),

//  ciphers: 'ECDHE-ECDSA-AES128-GCM-SHA256',
//  requestCert : true,
//  rejectUnauthorized : true
};

tls.createServer(options, function(cleartextStream) {
    if (cleartextStream.authorized) {
        console.log('Server-side connection authorized by a Certificate Authority.');
    } else {
        // TODO this code does not appear to get executed even on failed connections
        console.log('Server-side connection not authorized: ' + cleartextStream.authorizationError);
    }

    // send the server message to the client
    cleartextStream.write(msg);
    cleartextStream.setEncoding('utf8');
    cleartextStream.pipe(cleartextStream);
}).listen(port, function() {
    console.log('Server started on port: ' + port);
}).on('clientError', function(err){
    console.log('A failed client connection attempt occurred.');
    console.error(err);
    console.log();
}); 
```

在命令行上调用上述代码`node tlsServer.js`并尝试连接 OpenSSL 客户端后，我收到以下消息。

服务器：

```
$ node tlsServer.js
Server started on port: 8888

<< client started here >>

A failed client connection attempt occurred.
[Error: 6396:error:1408A0C1:SSL routines:SSL3_GET_CLIENT_HELLO:no shared cipher:openssl\ssl\s3_srvr.c:1132:
] 
```

客户：

```
$ openssl s_client -connect 127.0.0.1:8888 -cert client.cert -key client.key -pass file:passphrase.txt -CAfile ca.cert
CONNECTED(00000003)
2674688:error:140790E5:SSL routines:SSL23_WRITE:ssl handshake failure:s23_lib.c:177:
---
no peer certificate available
---
No client certificate CA names sent
---
SSL handshake has read 0 bytes and written 320 bytes
---
New, (NONE), Cipher is (NONE)
Secure Renegotiation IS NOT supported
Compression: NONE
Expansion: NONE
--- 
```

我正在使用节点 v0.6.15。当我在发送到的选项列表中取消注释`ciphers`、`requestCert`和时，错误不会改变。我也有客户端的 node.js cersion，当我尝试连接到节点服务器时，我得到一个套接字挂起代码 ECONNRESET，在尝试连接到 OpenSSL 服务器时出现以下错误：`rejectUnauthorized``tls.createServer()`

```
Connection to localhost:8888 could not be made.
[Error: 6968:error:14077410:SSL routines:SSL23_GET_SERVER_HELLO:sslv3 alert handshake failure:openssl\ssl\s23_clnt.c:602:
] 
```

提前感谢您的帮助和想法！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T01:03:06.383

如果密码错误，也许。尝试删除它。

但是，[no_shared_cipher](http://www.openssl.org/docs/ssl/SSL_CTX_set_cipher_list.html)是当客户端无法与服务器就密码套装达成一致时引发的错误。首先尝试删除服务器上的密码套装限制，并查看它协商使用什么来隔离问题。如果这可行，那么将一个与客户放在一起，看看会发生什么。

此外，您能否检查该节点是否使用与 openssl 命令相同的 openssl 库。

# asp.net-mvc - 视图如何知道要使用哪种布局？默认在哪里？

> ID：10201033
> 
> 赞同：9
> 
> 时间：2012-04-18T00:17:30.210
> 
> 标签：asp.net-mvc, layout, razor

在默认 mvc 应用程序中。有布局和内容页面，你懂的（_Layout、Home、Contact等）

并且内容页面不包含布局参考，因为：

```
Layout = "~/Views/Shared/_Layout.cshtml"; 
```

在内容页面中缺少此代码。但它们有效。在没有布局参考的情况下如何做到这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-18T00:22:14.113

因为您`_ViewStart.cshtml`包含对默认布局的引用，当视图中未说明特定布局时将使用该默认布局。

当您想要更改单个视图的布局时，您可以`Layout = "...";`在该视图中包含一个。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-18T03:46:06.140

如果您想要特定于文件夹的布局，即（主页、帐户、产品等），您可以将 _ViewStart.cshtml 放在该文件夹中并指出该文件中要使用的任何布局，它将覆盖根级布局。

[在此处](http://weblogs.asp.net/scottgu/archive/2010/10/22/asp-net-mvc-3-layouts.aspx)和[此处](http://weblogs.asp.net/scottgu/archive/2010/12/30/asp-net-mvc-3-layouts-and-sections-with-razor.aspx)查找 ScottGu 的博客以获取有关布局和部分的更多详细信息

# c# - 数据访问层中的静态与实例写入方法

> ID：10201036
> 
> 赞同：1
> 
> 时间：2012-04-18T00:17:47.803
> 
> 标签：c#, asp.net, data-access-layer

我正在 C# 中为 SQL Server 数据库表创建数据访问层。数据访问层包含表中每一列的属性，以及从数据库读取和写入数据的方法。让读取方法基于实例似乎是有意义的。我的问题是关于处理数据库生成的主键属性 getter/setter 和 write 方法。据我所知，我有三个选择...

选项 1：使用静态方法同时只允许在主键上使用 getter 将允许我强制将所有正确的值写入数据库，但作为开发人员来说很笨拙。

选项 2：使用和基于实例的写入方法将更易于维护，但我不确定如何处理主键上的 get/set，并且我可能必须在写入之前对实例进行某种验证数据库。

选项 3：别的东西，但我对 LINQ 和拖放的东西很警惕，他们以前烧过我。

这里有标准做法吗？也许我只需要一个可靠教程的链接？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T01:37:14.250

您可能想阅读[活动记录模式](http://en.wikipedia.org/wiki/Active_record_pattern)及其一些示例，然后实现您自己的类/类。

这是一个包含一些基本概念的简单类的粗略草图（如下）。

按照这种方法，您可以扩展该模式以满足您的需求。您可以从数据库中检索记录作为对象，更改其值，然后更新记录（选项 2）。或者如果开销太大，则使用直接更新数据库中记录的静态方法（选项1）。对于插入，如果需要，数据库（SP/查询）应验证表上的自然/唯一键，并可能返回指示唯一约束错误的特定值/代码）。对于更新，如果允许更新自然键字段，则需要执行相同的检查。

这在很大程度上取决于您的应用程序将允许特定表的哪些功能。

我倾向于从数据库中检索对象，然后更改值并保存，而不是静态方法。对我来说，调用代码更容易使用，并且可以更轻松地处理类内的神秘业务逻辑。

```
public class MyEntityClass
{
    private int _isNew;
    private int _isDirty;
    private int _pkValue;
    private string _colValue;

    public MyEntityClass()
    {
        _isNew = true;
    }

    public int PKValue
    {
        get {return _pkValue;}
    }

    public string ColValue
    {
        get {return _colValue;}

        set
        {
            if (value != _colValue)
            {
                _colValue = value;
                _isDirty = true;
            }
        }
    }

    public void Load(int pkValue)
    {
        _pkValue = pkValue;

        //TODO: query database and set member vars based on results (_colVal)

        // if data found
        _isNew = false;
        _isDirty = false;
    }

    public void Save()
    {
        if (_isNew)
        {
            //TODO: insert record into DB
            //TODO: return DB generated PK ID value from SP/query, and set to _pkValue
        }
        else if (_isDirty)
        {
            //TODO: update record in DB
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T00:31:08.103

你有没有看过[实体框架](http://msdn.microsoft.com/en-us/library/bb399572.aspx)。我知道您说过您对 LINQ 持谨慎态度，但 EF4 处理了您提到的很多事情，并且是 DAL 的相当标准的做法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T01:31:47.903

我会坚持使用 ORM 工具（EF、Telerik 的 OpenAccess 等），除非您需要一个您需要（不想要）完全控制的自定义 dal。对于辅助项目，我使用 ORM - 在工作中，我们有自己的自定义 DAL，其中包含提供者抽象以及对象和数据库之间的自定义映射。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T02:03:11.017

Nhibernate 也是一个非常可靠的久经考验的真正 ORM，有一个大型社区支持它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-14T15:10:53.640

Entity Framework 是您最初的 DAL 的方法，然后在您需要的地方进行优化：我们公司实际上在比较 EF 与 SQL 阅读器时做了一些基准测试，发现对于查询数据库以获取一两个表的信息，速度大约是 6 秒（两者都没有明显快于另一个）。在两张表之后，性能受到了影响，但并不是非常显着。编写自己的 SQL 语句变得有价值的一个地方是批量提交操作。此时 EF 允许您直接编写 SQL 查询。因此，请节省一些时间并使用 EF 进行基本的繁重工作，然后使用其直接连接进行更复杂的操作。（这是两全其美）

# ms-access - 涉及 3 个表时在表单中创建新记录

> ID：10201039
> 
> 赞同：1
> 
> 时间：2012-04-18T00:18:10.377
> 
> 标签：ms-access, ms-access-2010

我创建了一个显示用户详细信息的表单，数据已拆分为三个表（table1、table2、table3） table1 具有链接到其他表中数据的外键

仅插入 table1 时，默认的上一个、下一个和新记录选择器工作正常。但是，在插入其他两个表后，表单无法创建新记录。

我相信这是因为 table2 和 table3 试图链接到 table1 中的外键。

当按下“新记录”时，它会返回“您无法转到指定记录”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T12:01:08.883

正如一位用户已经指出的那样，存储过程（如果可用）绝对是进行多表条目和编辑的首选方式。它基本上是一个事务，事务通常允许您在遇到错误时回滚。

[Access 2010 在数据库引擎中内置了存储过程功能](https://stackoverflow.com/questions/3287545/how-do-i-make-a-stored-procedure-in-ms-access)，但之前的 Access 版本没有。SQL Server 和 MySQL 等其他流行的数据库服务器也具有存储过程功能。要在这些数据库之一中运行/调用存储过程，您必须使用传递查询或使用 ADO。

Access 在表单级别确实有一个选项，可以将您的 Recordset Type 更改为 Dynaset Inconsistent Updates。这允许表单忽略查询中作为记录集基础的关系，但仍将遵守在关系窗口中定义的任何关系。你可以在这里看到一个讨论：[http ://www.utteraccess.com/forum/Dynaset-Inconsistent-Upd-t1664392.html](http://www.utteraccess.com/forum/Dynaset-Inconsistent-Upd-t1664392.html)

正如在那次讨论中所指出的，我还设计了我的数据输入表单，即使我使用的是查询，它们也只构建在一个表上。然后，我将子表单用于相关表中的数据。我认为这几乎是 MS Access 中的标准设计实践。在 .NET 等环境中设计的软件更容易违反这一点，因为通常开发人员无论如何都必须为所有 CRUD 操作编写代码。这为开发人员提供了更大的灵活性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T00:24:18.200

我不确定您使用的是什么控件，但是我建议为 crud 操作编写存储过程。这是更新多个表的好方法

# java - 套接字编程 - Java 服务器、C（或其他）客户端 - 服务器给出“无效的流标头”

> ID：10201043
> 
> 赞同：2
> 
> 时间：2012-04-18T00:18:26.060
> 
> 标签：java, sockets, socketserver

服务器（Java）：

```
public static void main(String[] args) {

//single threaded for now

try {

    //very magic #
    ServerSocket service = new ServerSocket(33000); 

    while(true) {

    debug("Begin waiting for connection");

    //this spins
    Socket connection = service.accept();

    debug("Connection received from " + connection.getInetAddress().getHostName());

    ObjectOutputStream out = new ObjectOutputStream(connection.getOutputStream());
    ObjectInputStream in = new ObjectInputStream(connection.getInputStream());

// ... 
```

客户端 (C) - 这正是来自[http://www.linuxhowtos.org/data/6/client.c的示例代码](http://www.linuxhowtos.org/data/6/client.c)

```
int main(int argc, char *argv[])
{
int sockfd, portno, n;
struct sockaddr_in serv_addr;
struct hostent *server;

char buffer[256];
if (argc < 3) {
   fprintf(stderr,"usage %s hostname port\n", argv[0]);
   exit(0);
}
portno = atoi(argv[2]);
sockfd = socket(AF_INET, SOCK_STREAM, 0);
if (sockfd < 0)
    error("ERROR opening socket");
server = gethostbyname(argv[1]);
if (server == NULL) {
    fprintf(stderr,"ERROR, no such host\n");
    exit(0);
}
bzero((char *) &serv_addr, sizeof(serv_addr));
serv_addr.sin_family = AF_INET;
bcopy((char *)server->h_addr,
     (char *)&serv_addr.sin_addr.s_addr,
     server->h_length);
serv_addr.sin_port = htons(portno);
if (connect(sockfd,(struct sockaddr *) &serv_addr,sizeof(serv_addr)) < 0)
    error("ERROR connecting");
printf("Please enter the message: ");
bzero(buffer,256);
fgets(buffer,255,stdin);
n = write(sockfd,buffer,strlen(buffer));
if (n < 0)
     error("ERROR writing to socket");
bzero(buffer,256);
n = read(sockfd,buffer,255);
if (n < 0)
     error("ERROR reading from socket");
printf("%s\n",buffer);
close(sockfd);
return 0;
} 
```

Java 不高兴：

```
Begin waiting for connection
Connection received from localhost
Fatal Exception: invalid stream header: 68657920
java.io.StreamCorruptedException: invalid stream header: 68657920
        at java.io.ObjectInputStream.readStreamHeader(ObjectInputStream.java:801)
        at java.io.ObjectInputStream.<init>(ObjectInputStream.java:298)
        at Scanner.main(Scanner.java:243) 
```

第 243 行是：

```
ObjectInputStream in = new ObjectInputStream(connection.getInputStream()); 
```

C 客户端与 C 服务器一起工作，而 C 服务器与我的 Python 客户端一起工作。我编写的类似 Java 服务器也与 Java 客户端一起工作。据我所知，有一些神奇的词可以让 Java 服务器 -> 非 Java 客户端。抱歉，尽管它显然非常基本和简单，但我在谷歌上没有运气。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T00:37:09.347

您在`ObjectInputStream`Java 端使用 an ，它需要一个非常特定的序列化 Java 对象协议。除非您从 C 客户端向套接字写入正确的格式，否则这正是您将得到的错误。你还没有展示你如何尝试从流中读取，但我怀疑你只是想要一个`BufferedInputStream`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T00:39:00.827

问题是您使用的是用于 Java 对象的 ObjectInputStream，而不是像 68657920 这样的原语。

# jquery - 链接到特定的 jQuery 手风琴 UI

> ID：10201047
> 
> 赞同：0
> 
> 时间：2012-04-18T00:18:39.433
> 
> 标签：jquery, accordion

我正在使用 jQuery 手风琴 UI - [http://jqueryui.com/demos/accordion/](http://jqueryui.com/demos/accordion/) ...并希望链接到页脚中的特定手风琴，以便链接将您带到特定页面并打开特定的手风琴。

在插件中，标题是链接，所以我添加了：name="contact"，然后我链接到 / *pagename* #contact 但它不会打开手风琴，所以它变得毫无意义。

我能做些什么？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T00:28:18.863

我很确定您应该为`<a href="#contact">`您链接到的手风琴项目的内容制作标题。

您还必须像这样设置手风琴：`.accordion({ navigation:true })`

编辑：http: [//jsfiddle.net/M5JQn/](http://jsfiddle.net/M5JQn/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T00:30:02.080

来自：http: [//jqueryui.com/demos/accordion/#method-activate](http://jqueryui.com/demos/accordion/#method-activate)

.accordion（“激活”，索引）

以编程方式激活 Accordion 的内容部分。索引可以是零索引数字以匹配要关闭的标题的位置，也可以是与元素匹配的选择器。

传递 false 以关闭所有（仅适用于 collapsible:true）。

所以当点击页脚中的链接时：onclick"打开页面；$('accname').accordion('activate',2)"

更新：因为激活就像每次点击一样，它不会总是打开它，所以你必须先得到它的状态，使用： if($('#accordion').accordion('option', 'active')! =1) {$('#accordionp').accordion('option', 'active', 1);} 这将确保每次你去它时它都是打开的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T00:30:31.000

忘记我在下面说的话。这是除 jquery ui 之外的通用方法。正如“Joe Flateau”所提到的，有一个更好的方法，[这](http://www.michaeljacobdavis.com/tutorials/statesavingaccordion/statesavingaccordion.html#2)是一个很好的例子。

* * *

文档中有这样的东西。这是你需要的吗？$( ".selector" ).accordion({ active: 2 });

您可以定义一个数组，如：

```
var pages=new Array(); 
pages['main']=1;
pages['contact']=2;
pages['help']=3;
//and whatsoever 
```

然后您可以使用来自 url 哈希的信息打开该页面：

```
var hash = window.location.hash
$( ".selector" ).accordion({ active: pages[hash] }); 
```

# iphone - UIImageView 如何跟踪顺时针或逆时针用户运动

> ID：10201048
> 
> 赞同：0
> 
> 时间：2012-04-18T00:19:04.537
> 
> 标签：iphone, ios, xcode, ipad

我已经使用这篇文章中的代码成功实现了旋转 uiimageview

[iPhone - 车轮跟踪手指跳到相同的起始位置？](https://stackoverflow.com/questions/4188744/iphone-wheel-tracking-finger-jumps-to-same-starting-position/4209190#comment13012666_4209190)

我对其他开发人员的问题是，触摸用户可以顺时针和逆时针旋转图像。有没有办法可以检测到用户在哪个方向移动视图？

它对我很重要，因为我正在制作一个时钟应用程序。我让用户将分钟手从 0 分钟一直移动到 60 分钟。当它到达那里时，我将时针向上移动一个。但是用户可以逆时针旋转分针，在这种情况下我需要将时针向下移动一个。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T01:47:38.113

您可以设置一个名为“lastPoint”的成员变量来记录您上次移动的点

你可以计算下一次的方向

```
 CGPoint lastPoint;

- (void) touchedBegin:(NSSet *)touches withEvent:(UIEvent *)event {
    lastPoint = [touch locationInView:self.view];
}

-(void) touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {
NSSet *allTouches = [event allTouches];

//you can save the point , then used in next time you want

int tInput = [allTouches count]-1;

UITouch *touch =[[allTouches allObjects] objectAtIndex:tInput];
CGPoint location = [touch locationInView:self.view];
float theAngle = atan2( location.y-imageX.center.y, location.x-imageX.center.x );

**float theLastAngle =  atan2( lastPoint.y-imageX.center.y, lastPoint.x-imageX.center.x );**

**lastPoint = location;**

// compare theAngle & theLastAngle , so you can know it is clockwise or counterclockwise.
} 
```

# c# - 计算sql数据库中同一列中的总行数

> ID：10201051
> 
> 赞同：0
> 
> 时间：2012-04-18T00:19:11.037
> 
> 标签：c#, winforms, linq-to-sql, c#-4.0

我有一个名为费用的 sql 表，其中有一个名为 cost 的 int 列。在我的应用程序中，这些数据显示在网格上，每次我使用 linq2sql 插入新行时，该网格都会刷新。我想做的是在我的应用程序中有一个整数变量，它是每次插入一行时成本列中所有字段的总和。

每次我进行插入时，是否有一种简单的方法可以将这些字段与 linq2sql 相加。请尽量避免使用 lambda，因为我还没有开始学习。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T04:31:59.893

假设您使用查询语法而不是 lambdas，那么您是：

```
var totalCost = (from expensesRow in dataContext.Expenses
             select expensesRow.cost)
             .Sum(); 
```

实际上与以下内容相同：

```
var totalCost = dataContext.Expenses
                  .Sum(x => x.cost); 
```

这`dataContext`是您的 Linq2Sql`DataContext`类的一个实例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T00:26:04.933

你今天开始学习 lambdas。[http://www.theabsent](http://www.theabsentmindedcoder.com/2010/06/linq-sum.html) mindcoder.com/2010/06/linq-sum.html*正是*你想要的，并使用一个非常简单的 lambda 来实现。通过让你的选择只收集你想要求和的一列整数，你可以在没有 lambda 的情况下逃脱，但为什么要做额外的工作来不学习东西呢？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T00:22:45.107

假设我有一个名为 users 的表，其结构如下：

```
[Table users] -  id | username | points_awarded 
```

然后，我可以通过运行查询找到我授予每个用户的总积分数：

```
SELECT SUM(points_awarded) as total_points FROM users 
```

您还可以计算有多少用户的点数大于等于 N。例如，说 N = 500，那么我可以运行：

```
SELECT COUNT(id) as num_users_with_points FROM users WHERE points_award >= 500 
```

查看：

```
http://dev.mysql.com/doc/refman/5.1/en/counting-rows.html
http://dev.mysql.com/doc/refman/5.0/en/func-op-summary-ref.html 
```

了解更多信息。

# ruby-on-rails - Rails 资产：如何引用其他应用程序中的图像？

> ID：10201058
> 
> 赞同：2
> 
> 时间：2012-04-18T00:19:48.020
> 
> 标签：ruby-on-rails, ruby-on-rails-3, nginx, assets

在预编译期间将图像名称移动到 /public/assets 目录时，Rails 会为图像名称添加 md5 哈希。问题是这些哈希是不可预测的，所以我怎么知道在尝试链接到它们时会调用什么？

例如，如果我托管一个名为 flowers.jpg 的图像，然后尝试在 www.mysite.com/flowers.jpg 访问它，它会失败，因为该文件已重命名为 flowers-4182172ae014ec23dc02739229c08dcc。

我知道 Rails 有可以自动找到这些图像的助手。但是，如果您尝试从完全不同的网站或应用程序链接到这些图像怎么办？有没有办法让 Rails 说：“我找不到flowers.jpg 的预编译版本，所以我不会从 /public/assets 提供服务，而是从 /app/assets 提供服务。”？

编辑：根据这篇文章（http://stackoverflow.com/questions/10045892/rails-compiles-assets-both-with-and-without-md5-hash-why），Rails 应该同时编译我的资产版本有和没有 md5 哈希？知道为什么我的 Rails 副本没有生成没有指纹的版本吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T00:30:35.763

Rails 使用 image_tag 为您处理：

```
image_tag "myimage.jpg" 
```

这将为您提供正确的网址。您也许可以编写一个小服务，为您的 as（未经测试）生成图像 url：

```
Class AssetsService < ApplicationController  
  def index
  end
end 
```

index.js.haml

```
= image_tag "myimage.jpg" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T01:24:52.287

答案不在于 Rails。我认为 Rails 不*应该*编译没有指纹的图像。但是，它应该仍然能够为它们服务，并且我在我的 nginx 配置文件中添加了一些代码，以防止这种情况发生。这是有问题的代码：

```
location ~* ^/assets/ {
    # Per RFC2616 - 1 year maximum expiry
    # http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html
    expires 1y;
    add_header Cache-Control public;

    # Some browsers still send conditional-GET requests if there's a
    # Last-Modified header or an ETag header even if they haven't
    # reached the expiry date sent in the Expires header.
    add_header Last-Modified "";
    add_header ETag "";
    break;
} 
```

# project-management - 估计完成任务的时间

> ID：10201061
> 
> 赞同：2
> 
> 时间：2012-04-18T00:19:53.243
> 
> 标签：project-management, estimation

我知道这个问题已经在这里/程序员上被问过好几次了，这是一个很常见的经典问题：

你如何准确地估计一项任务需要多长时间？

我遇到的问题是 Windows 中的点击式任务，我可以给出准确的估计。为了编写新的代码（比如使用我不熟悉的 API），我无法估计准确的时间来挽救我的生命。这是一个思考并说出我脑海中的第一个数字（天/周/无论如何）的案例。对于使用我熟悉的 API 的代码和我可以立即说我可以开发的应用程序（例如记事本类型的应用程序），我可以给出准确的估计。

任何帮助表示赞赏。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T04:32:48.117

专注于碎片。当您尝试在高水平上估计一项任务时，不仅令人生畏，而且您将无法准确地考虑构成总时间的所有因素。

相反，甚至不要试图猜测总数（它不仅没有用，而且它实际上会影响您对单个任务的估计），而是坐下来尝试思考构成任务的所有子任务。如果这些感觉太大，请将它们分解为更小的子任务。

完成此操作后，对每个子任务进行估算。如果其中任何一个大于大约 4 小时，则子任务可能还没有被充分分解。将所有这些子估计加起来。这是你的估计。

使用这种方法会迫使您推理出完成任务实际需要什么，并让您产生更好的估计。

确保您也考虑完成任务所需的非明显步骤。如果您正在编写一段代码，您是否包括了编写相关单元测试的时间估算？用于测试代码？为了记录它？

将小时数转换为天数时，请使用现实的期望值来确定您实际埋头工作的时间。普遍的共识是，开发人员可以在任何给定的 8 小时工作日内完成 4-6 小时的工作。这大致符合我的个人经验。

如果您有其他团队成员，您可以尝试一种称为[Planning Poker](http://en.wikipedia.org/wiki/Planning_poker)的技术。最简单的想法是让团队中的每个成员开始并单独评估每个任务。一旦完成，团队就会聚在一起，比较估计值，寻找较大的偏差。如果任务不够清晰，如果团队中的某些成员拥有其他人没有的相关信息，或者如果不同的团队成员做出不同的假设，这往往会暴露出来。

在进行估算时，请注意您的假设并将其记录为估算的一部分。假设 x、y 和 x，任务 q 应该花费 n 小时。这些可能是假设 QA 工程师可以测试该功能，假设开发环境可以部署该功能以进行测试，假设两个尚未一起测试的第三方框架的兼容性，假设任务所依赖的特征 z 已在某个日期前准备就绪......等等。我们一直在做出大量这些假设，而没有意识到它们。记录它们会迫使您了解它们并允许其他方验证您的假设是否正确。如果估计结果确实是错误的，你就有更多的信息来分析原因。

即使遵循所有这些建议，您仍然会经常做出不准确的估计，但不要感觉太糟糕，因为我们的大脑天生就对抽象任务产生可怕的估计。我们有许多认知偏见，这些偏见会影响我们衡量任务规模和努力的能力。

我建议阅读这篇文章以获得更多信息和建议：

[http://blog.muonlab.com/2012/04/12/why-you-suck-at-estimating-a-lesson-in-psychology/](http://blog.muonlab.com/2012/04/12/why-you-suck-at-estimating-a-lesson-in-psychology/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T00:32:29.000

我主要从事持续时间“较短”的项目，但对我来说效果很好的方法是将任务分解为足够小的子任务，我认为我可以在大约一天内完成每个子任务。对于某些项目，这意味着只有两个或三个子任务，对于其他项目，这可能意味着数十或数百个。加上一些浪费在非生产性活动上的开销百分比，一些用于探索错误方向的开销，希望你能得到一个在最终结果合理范围内的数字。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T04:57:25.347

我通常做的是将任务分解为小任务。最大的任务不应超过 2 天。估计小任务并不难。每个小任务的测试时间都包含在估算中，因此我不会在项目结束时得到大量未经测试的代码。

只有在有高级设计的情况下才可能将任务分解成小块，否则估计只是粗略的猜测，通常是 2 周，这是大多数开发人员使用的著名的 2 周；）

在项目结束时添加一些时间来进行集成稳定错误修复使其成为合理的估计。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T05:55:33.300

与**sarnold**提到的类似，分解任务是关键……但如果您不了解所涉及的领域/技术，将其归结为细粒度的 1 天增量可能会更加困难。在您的情况下，我会建议以下内容（特别是如果这显然不是一项需要不到几天时间才能完成的任务）：

1）首先，您需要询问您的团队/同事，看看他们是否可以提供一些启示（和/或他们是否使用了您正在使用的相同 API/技术）。如果没有人知道任何事情，您将不得不承认您根本没有足够的数据来进行合理的猜测，并且需要花费 X 天来调查（调查的时间需要是与您正在使用的 API/域的复杂性保持一致）

2) 在您分配研究新技术的时间结束时，您应该能够使用 API 做一个非常基本的 hello、world-ish 类型的应用程序（编译、链接和运行良好）。到这个时候，你应该可以很好地确定你的任务是需要几天、几周还是几个月的时间。

3）接下来要做的关键事情是**尽快**确定任何会破坏您的预测的主要障碍/打嗝......这是关键。你能做的最糟糕的事情就是在到期日不断地去找你的经理/客户，并提到你需要大量的额外时间来交付。他们需要尽快抬起头来帮助纠正这种情况和/或制定 B 计划。

差不多就是这样......这不是火箭科学，但你基本上提供了一个估计，一旦你有能力给出一个，然后确保你根据对你有重大影响的新的、意料之外的事件来更新这个估计。制定预期日期的能力。

# java - Java 主类在线程执行之前结束

> ID：10201063
> 
> 赞同：0
> 
> 时间：2012-04-18T00:20:10.747
> 
> 标签：java, multithreading

我有一个多线程执行，我想跟踪并打印出执行时间，但是当我执行代码时，子线程比主执行花费更长的时间，因此输出不可见，也不会打印正确的值，因为它是提前终止。

这是代码：

```
public static void main(String[] args) throws CorruptIndexException, IOException, LangDetectException, InterruptedException {

    /* Initialization */
    long startingTime = System.currentTimeMillis();
    Indexer main = new Indexer(); // this class extends Thread
    File file = new File(SITES_PATH);
    main.addFiles(file);

    /* Multithreading through ExecutorService */
    ExecutorService es = Executors.newFixedThreadPool(4);
    for (File f : main.queue) {
        Indexer ind = new Indexer(main.writer, main.identificatore, f);
        ind.join();
        es.submit(ind);
    }

    es.shutdown();

    /* log creation - code I want to execute when all the threads execution ended */
    long executionTime = System.currentTimeMillis()-startingTime;
    long minutes = TimeUnit.MILLISECONDS.toMinutes(executionTime);
    long seconds = TimeUnit.MILLISECONDS.toSeconds(executionTime)%60;
    String fileSize = sizeConversion(FileUtils.sizeOf(file));

    Object[] array = {fileSize,minutes,seconds};
    logger.info("{} indexed in {} minutes and {} seconds.",array);
} 
```

我尝试了几种解决方案，例如 join()、wait() 和 notifyAll()，但都没有奏效。

我在 stackoverflow 上找到了这个[Q&A](https://stackoverflow.com/questions/5066160/java-threads-and-main-thread)来解决我的问题，但是 join() 被忽略了，如果我把

> es.awaitTermination（超时，TimeUnit.SECONDS）；

实际上执行器服务从不执行线程。

哪个可以是仅在 ExecutorService 块中执行多线程并在最后完成主要执行的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T00:35:52.247

该`ExecutorService#submit()`方法返回一个`Future`对象，该对象可用于等待提交的任务完成。

这个想法是你收集所有这些`Future`s，然后调用`get()`它们中的每一个。这可确保在您的主线程继续之前所有提交的任务都已完成。

像这样的东西：

```
ExecutorService es = Executors.newFixedThreadPool(4);
List<Future<?>> futures = new ArrayList<Future<?>>();
for (File f : main.queue) {
    Indexer ind = new Indexer(main.writer, main.identificatore, f);
    ind.join();
    Future<?> future = es.submit(ind);
    futures.add(future);
}

// wait for all tasks to complete
for (Future<?> f : futures) {
    f.get();
}

// shutdown thread pool, carry on working in main thread... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T00:41:03.873

鉴于您的用户案例，您不妨使用该`invokeAll`方法。来自 Javadoc：

> 执行给定的任务，返回一个 Futures 列表，在所有完成时保存它们的状态和结果。Future.isDone() 对于返回列表的每个元素都是 true。请注意，已完成的任务可能已经正常终止，也可能通过引发异常终止。如果在此操作进行时修改了给定的集合，则此方法的结果是不确定的。

要使用：

```
final Collection<Indexer> tasks = new ArrayList<Indexer>();
for(final File f: main.queue) {
    tasks.add(new Indexer(main.writer, main.identificatore, f));
}

final ExecutorService es = Executors.newFixedThreadPool(4);
final List<Future<Object>> results = es.invokeAll(tasks); 
```

这将执行所有提供的任务并等待它们完成处理，然后再继续主线程。您将需要调整代码以适应您的特定需求，但您明白了要点。快速说明，有一个`invokeAll`接受超时参数的方法的变体。如果您想在继续之前等待最长时间，请使用该变体。并确保检查完成后收集的结果`invokeAll`，以验证已完成任务的状态。

祝你好运。

# tdd - 是否有一个 NoSQL 系统也可以在 Windows 上运行并可用于内存单元测试？

> ID：10201066
> 
> 赞同：2
> 
> 时间：2012-04-18T00:20:18.960
> 
> 标签：tdd, nosql, couchdb, redis, in-memory-database

我正在寻找在 Windows 上运行（至少用于开发）并能够在内存模式下运行（无需磁盘访问）的 NoSQL/键值存储/无模式数据存储系统。内存模式对于快速执行我们正在构建的客户端软件的测试套件是必要的。

在生产中，数据将是巨大的，并且必须存储在磁盘上。

例如**riak**有一个 in-memory 选项，但 riak 不能在 windows 上编译和运行。

应该有各种可用语言的客户端库，或者 http 或 xml-rpc 接口或类似的接口。

我相信**couchDB** [不能在内存中运行，](http://www.rubyflow.com/items/3441) mongoDB[也](https://jira.mongodb.org/browse/SERVER-1153%22neither%20mongoDB%22) **不能**。

**Cassandra**安装在 Windows 上，但对于非 Java 客户端，我不确定是否需要 Thrift，[这将很难编译](http://nosql.mypopescu.com/post/503354792/getting-started-with-cassandra-on-windows%22to%20difficult%20to%20compile%20Thrift%22)

**Hadoop**可以设置为 Windows 上的开发系统，但它似乎只在磁盘上运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T02:45:36.383

由于您放宽了对 map/reduce 的要求，Redis 似乎很合适。

1.  Redis 是一个内存数据存储，因此您的单元测试会很快。
2.  官方不支持它在 Windows 中。但是，Windows 端口是可用的，并且普遍的结论是这些端口对于本地开发来说已经足够好了。
3.  Redis 本身不支持 Map Reduce，但后来你放宽了这个要求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T19:32:00.403

你可以看看[RavenDB](http://ravendb.net/)。它是用 .NET 编写的，可以在 Windows 上运行，[而且它有一个内存选项](http://ayende.com/blog/4662/ravendb-managed-storage)

# ios - 将现有的 UINavigationController 嵌入到新的视图控制器中

> ID：10201070
> 
> 赞同：2
> 
> 时间：2012-04-18T00:21:07.353
> 
> 标签：ios, ios5, uinavigationcontroller, storyboard, uistoryboard

假设我有一个带有导航控制器和几个视图控制器的故事板。

一切都很好，直到我尝试添加一个新的视图控制器并希望将它与现有的`UINavigationController`. 当我转到编辑器>嵌入>导航控制器时，Xcode 会帮助创建一个新控制器，这正是我不想要的。当我尝试拖动以创建线框时，我创建了一个转场关系，这也是我不想要的。

有没有办法让新的视图控制器与现有的导航控制器配合得很好？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-21T01:15:55.980

我认为您正在错误地考虑 UINavigationController。UINavigationController 只是一个容器视图控制器，用于管理视图控制器的层次结构。你从一个 UINavigationController 开始，它只有一个根视图控制器（听起来你想要多个，这不会发生）。当你推送一个新的视图控制器时，它会被推送到同一个 UINavigationController 上。因此，如果您希望多个视图控制器与单个 UINavigationController 关联，它们必须分层堆叠到根视图控制器上。

# java - Java - 接口，实例化接口？

> ID：10201081
> 
> 赞同：6
> 
> 时间：2012-04-18T00:23:10.400
> 
> 标签：java, interface, instantiation, anonymous-inner-class

所以我刚刚在网上找到了这个代码示例，我又重新看了一遍，但很困惑。

通过查看它，我收集到的（可能是错误的）是它传递给 NumberPrinter 类中的 print 方法一个 Printer 对象。但是这个接口也叫Printer，那我们不就是实例化一个Printer接口的匿名类，定义方法然后传递吗？

我的基本问题是，我最初的假设是否正确？如果是这样，我认为您无法实例化接口？

```
public class NumberPrinter {

    public interface Printer {
        public void print (int idx);
    }

    public static void print (Printer p) {
        for (int i = 0; i < 4; i++) {
            p.print(i);
        }
    }

    public static void main(String[] args) {
        print(new Printer() {

            @Override
            public void print(int idx) {
                System.out.println(idx);
            }

        });
    }

} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-18T00:26:41.120

这称为*匿名内部类*。

`Printer`它创建了一个实现接口的未命名类。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T00:27:51.040

您的假设是正确的，您无法实例化接口。但是，您可以实例化一个匿名类，这就是代码正在做的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T00:31:29.210

NumberPrinter 的打印功能需要一个 Printer 对象。当您调用该函数时，您实际上并没有实例化 Printer 接口，而是实例化了它的实现，这就是它起作用的原因。

顺便说一句，你的假设是正确的。

# web - 如何在网站上添加编辑直播网站？

> ID：10201082
> 
> 赞同：1
> 
> 时间：2012-04-18T00:23:21.097
> 
> 标签：web, live, edit, ipb

如果您曾经使用过 IPB 论坛，您就会知道您可以在 ACP（管理控制面板）中对您的站点进行更改，我想做的就是制作类似于他们用于“外观和感觉”部分的内容在论坛中，您可以从一个小区域对整个网站进行更改，我想将其添加到我的主站点上的 ACP 中，以便更轻松地进行更改。

是的，我已经拥有 IPB 它的 v3.2.3 的副本，如果它有任何不同，我感谢任何和所有的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T00:32:31.717

考虑在您的网站/论坛的某处添加“就地编辑”功能。查看：

```
http://www.appelsiini.net/projects/jeditable 
```

只要您了解超级基础的 mySQL、PHP，并听说过 jQuery/知道如何将 jQuery 插件添加到您的代码中，那么您就已经准备好了！

这是他们的（上面提供的链接）演示页面：

```
http://www.appelsiini.net/projects/jeditable/default.html 
```

# java - Java：仅在不可变对象的 equals() 中检查 hashCode

> ID：10201083
> 
> 赞同：8
> 
> 时间：2012-04-18T00:23:21.690
> 
> 标签：java, equals, immutability, guava, hashcode

我有一个不可变的对象，例如笛卡尔空间中的一个节点。该类是不可变的，所以我缓存了`hashCode`非常快速的散列。

```
private final int hashCode;

private final double x, y, z;

public Node(final double x, final double y, final double z)
{
    this.x = x;
    this.y = y;
    this.z = z;
    this.hashCode = Objects.hashCode(this.x, this.y, this.z);
}

@Override
public boolean equals(final Object obj)
{
    if (this == obj) { return true; }
    if (obj == null) { return false; }
    if (!(obj instanceof Node)) { return false; }
    final Node other = (Node) obj;
    return Objects.equal(this.x, other.x) && Objects.equal(this.y, other.y) && Objects.equal(this.z, other.z);
}

@Override
public int hashCode()
{
    return this.hashCode;
} 
```

由于`hashCode`是唯一的并且依赖于类的所有字段并且该类是不可变的，因此仅`Node`基于 来检查相等性是否正确`hashCode`？

```
@Override
public boolean equals(final Object obj)
{
    if (this == obj) { return true; }
    if (obj == null) { return false; }
    if (!(obj instanceof Node)) { return false; }
    final Node other = (Node) obj;
    return this.hashCode == other.hashCode;
} 
```

这通过了我写的关于属性和它们的交互的所有单元测试`equals()`，`hashCode()`但也许我缺少一些东西？

注意： Guava`Objects.hashCode()`类`Objects.equal()`是否对各自的方法有帮助。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-18T00:24:40.857

没有; 那是行不通的。

您有 2 ^(32 个)可能的哈希码和 2 ^(192 个)可能的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T18:10:02.407

不是，但..

我想您可以检查哈希码以查看对象**是否不相等**并在那里获得一些性能：

```
public boolean equals(final Object obj) {
   if (this == obj) { return true; }
   if (!(obj instanceof Node)) { return false; }
   final Node other = (Node) obj;

   if (this.hashCode != other.hashCode) {
      return false; // If hashcodes differ, we're sure the objects are not equal
   }
   // remainder of the actual equals implementation
} 
```

当然，这只会在您的大多数比较结果为假的情况下提高性能。在对象相等的情况下，这将带来性能损失。在您的示例中（仅比较三个值），我不建议这样做。

# java - 如何在 Java 中 Ping WSDL

> ID：10201085
> 
> 赞同：0
> 
> 时间：2012-04-18T00:23:40.770
> 
> 标签：java, wsdl, ping

如何在 Java 中为我的 WSDL 执行 Ping？

我已经尝试过了：

```
InetAddress.getByname(my_wsdl).isReachable(3000); 
```

但没有用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-08-20T20:21:04.310

尝试这个

```
 private boolean isWSDLAvailable(String wsdlAddr) {
        HttpURLConnection c = null;
        try {
            URL u = new URL(wsdlAddr);
            c = (HttpURLConnection) u.openConnection();
            c.setRequestMethod("HEAD");
            c.getInputStream();
            return c.getResponseCode() == 200;
        } catch (Exception e) {
            return false;
        } finally {
            if (c != null) c.disconnect();
        }    
} 
```

# javascript - 在jquery循环中将数字添加到运行总数

> ID：10201096
> 
> 赞同：2
> 
> 时间：2012-04-18T00:25:32.470
> 
> 标签：javascript, jquery, numbers

我有一个变量应该包含一个运行总计。在此循环的每次传递中，应将金额添加到运行总数中。我必须遗漏一些东西，因为我得到未定义或 NaN。

```
$('#btnSubmit').click(function(e) {
    var totalSqft;
    $('.fieldset').each(function() {
        var sqft;
        var width = $(this).find('input:eq(0)').val();
        var height = $(this).find('input:eq(1)').val();
        var type = $(this).find('select').val();
        if (type == 'tri') {
            sqft = (width * height) / 2;
        } else {
            sqft = (width * height);
        };
        totalSqft += sqft;
        alert('this ' + type + ' is ' + width + ' wide and ' + height + ' high, for a total of ' + sqft + ' square feet');
    });
    alert('Done.  Total Sq Ft is ' + totalSqft);
})​ 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T00:26:55.797

您需要将值初始化为 0：

```
var totalSqft = 0; 
```

否则，它会被初始化为`undefined`，并且`undefined`+ 一个数字是`NaN`。

# java - 使用 Spring Security 3.1 分别管理的两个并发身份验证？

> ID：10201098
> 
> 赞同：1
> 
> 时间：2012-04-18T00:26:08.800
> 
> 标签：java, servlets, spring-security

我正在构建一个具有两种类型用户的应用程序：

*   普通用户（具有角色“用户”）
*   管理用户（具有“管理员”角色，但没有“用户”权限）

如何允许某人分别以用户和管理员身份登录/注销？

我使用两个 http 元素定义了两个领域（我有两个领域来允许单独的登录页面和用户数据库）：

```
<security:http pattern="/admin/**" authentication-manager-ref="adminAuthManager"
    entry-point-ref="adminLoginUrlAuthEntryPoint" use-expressions="true">
    <security:intercept-url pattern="/admin/**" access="hasRole('admin')" />
    <security:access-denied-handler error-page="/admin/login" />
    <security:logout logout-url="/admin/logout" logout-success-url="/" />
    ...
</security:http>
<security:http pattern="/**" authentication-manager-ref="userAuthManager"
    entry-point-ref="userLoginUrlAuthEntryPoint" use-expressions="true">
    <security:intercept-url pattern="/**" access="permitAll" />
    <security:intercept-url pattern="/settings" access="hasRole('user')" />
    <security:access-denied-handler error-page="/login" />
    <security:logout logout-url="/logout" logout-success-url="/" />
    ...
</security:http> 
```

使用当前设置，我无法允许单个会话同时成为经过身份验证的用户和经过身份验证的管理员。当某人在以管理员身份登录时以用户身份登录时，他/她的管理员身份验证将丢失（或被替换），反之亦然。

我曾考虑将这两个领域分成两个不同的网络应用程序，但如果可能的话，我不希望这样做。

编辑：这是我希望它如何工作的示例：

1.  人员导航到站点，假设路径 / 对所有用户开放
2.  人点击登录并在 /login 进行身份验证；人现在有角色“用户”
3.  人员决定导航到 /admin/* 页面并显示 /admin/login 页面
4.  个人在 /admin/login 处使用另一组凭据进行身份验证；人现在有角色“管理员”和“用户”
5.  从服务器的角度来看，当用户在 /admin/** 页面时，用户的主体是他用于 /admin/login 的用户名；在 /** 页面上，用户的主体是他用于 /login 的用户名
6.  人员完成管理活动并决定在 /admin/logout 退出他的管理会话；人失去了“管理员”角色，但留下了“用户”角色
7.  Person 最终决定退出用户角色并进入路径 /logout；这个人现在是匿名的

我希望这可以在不编写太多自定义功能的情况下实现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T20:07:02.000

我不明白您为什么希望同一个人拥有两套凭据？这种情况通常使用递升式身份验证来实现，即用户始终相同，但在尝试访问应用程序的管理区域时会提示他重新进行身份验证。例如，您可能会提示他输入一些附加信息或使用双因素令牌进行身份验证。

过去，我使用自定义 AccessDecisionManager/Voter 实现了这一点，它检查用户是否试图访问站点的“更安全”区域，如果他没有正确的角色，则抛出[InsufficientAuthenticationException 。](http://static.springsource.org/spring-security/site/docs/3.1.x/apidocs/index.html)然后入口点处理这个异常并提示用户重新认证和spring分配新角色

# meteor - 订阅集合中的更改但不在模板中

> ID：10201106
> 
> 赞同：4
> 
> 时间：2012-04-18T00:27:00.913
> 
> 标签：meteor

我对流星很陌生，所以如果我在这里遗漏了一些非常基本的东西，我深表歉意。

我认为创建一个非常简单的文本板样式的应用程序来检查流星会很有趣。我使用 todo 应用程序并将数据结构更改为“文件夹”和“文档”而不是“列表”和“待办事项”，所以我有一个文件夹列表，当你点击文件夹时，你会得到一个文档列表在那个文件夹中。

然后，当单击列表中的一个文档时，我添加了一些代码来显示单个“文档”的“内容”属性。

我正在使用 ace 为文档的内容添加一些漂亮的打印（[https://github.com/ajaxorg/ace](http://github.com/ajaxorg/ace)）。我已经将 ace 设置为使用包含我的文档的纯文本版本的隐藏文本区域，并且编辑器对象获取此文本并漂亮地打印它。

ace 的问题是，我不希望每次文档内容更改时都替换包含 ace 编辑器的模板（因为重新初始化需要半秒钟，在键入每个字符后这是一种糟糕的体验！） . 相反，我想更新 textarea 模板，然后使用 ace API 告诉编辑器根据 textarea 中的内容更新它的输入。

现在，这可能是解决问题的错误方法，但我最终使用了两个模板。第一个包含一个包含 doc.contents 的 textarea，它对底层模型是反应性的：

```
<template name="doc_content">
  <textarea name="editor">{{content}}</textarea>
</template> 
```

第二个包含 ace 用来显示漂亮打印文本的“编辑器”div。

```
<template name="doc_init">
  <div id="editor"></div>
</template> 
```

这个想法是第一个模板将在每次用户输入时更新（在所有客户端上），第二个模板只会为我们加载的每个新文档重新加载。

```
Template.doc_content.content = function() {
  var doc_id = Session.get('viewing_itemname');
  if (!doc_id) {
    return {}; 
  }

  var doc = Docs.findOne({_id:doc_id});
  if (doc && doc.content) {
    // #1 Later
    var editor = Session.get('editor');
    if (editor) {
      editor.getSession().setValue(doc.content);
    }   

    return doc.content;
  } else {
    return ''; 
  }
}; 
```

当您在编辑器 div 中输入文本时，我会调用`Docs.update(doc_id, {$set: {content: text}});`，它会更新每个客户端上 textarea 中的值。到目前为止一切都很好。

```
editor.getSession().on('change', function(){
    var text = editor.getSession().getValue();
    Docs.update(doc_id, {$set: {content: text}});
}); 
```

对于进行更改的客户端以外的所有客户端，我想要做的是订阅该文档的更改并使用刚刚更改的文本调用 editor.getSession().setContent()，获取文本从文本区域并使用它来填充编辑器。

我试图通过从包含 textarea 的模板中进行调用来做到这一点（因为每当更新文档时它都会改变 - 请参见上面的 #1）。但是，这会使客户端陷入无限循环，因为更改编辑器中的值会导致再次调用`Docs.update`.

显然，当您渲染模板时不会发生这种情况，所以我假设流星中有一些魔法可以防止这种情况发生，但我不确定如何。

有什么想法吗？

蒂亚！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T20:41:48.607

您的问题需要吸收很多内容，但如果我理解正确，您可能只是在追求`Deps.autorun`：

```
Deps.autorun(function () {
    var doc_id = Session.get('viewing_itemname');
    if (!doc_id) {
        return {};
    }

    var doc = Docs.findOne({_id:doc_id});

    // do stuff with doc
}); 
```

`Deps.autorun`非常有用，因为如果它的任何依赖项发生更改，它将重新运行。这些依赖项仅限于那些“反应式”的，例如集合和会话，或任何实现反应式 API 的东西。

在您的情况下，两者`Session.get`和`findOne`都是反应性的，因此如果它们的值发生变化，`Deps.autorun`将再次运行该函数。

# sql - 有没有更简单的方法来编写这个查询？

> ID：10201108
> 
> 赞同：0
> 
> 时间：2012-04-18T00:27:48.427
> 
> 标签：sql, subquery

我有三张桌子。类别、主题和帖子。每个主题都有一个外键引用它所属的类别。每个帖子都有一个外键引用它所在的主题。

此查询的目的基本上是作为首页查询。我想要每个类别以及每个类别中的主题数量和帖子数量。这是我的查询，它有效。这是最简单的方法吗？

```
SELECT      c.*,
            COUNT(t.idCategory) AS tCount,
            p.pCount
FROM        categories AS c
  LEFT JOIN topics AS t
  ON        c.id = t.idCategory
  LEFT JOIN (SELECT      t.idCategory,
                         COUNT(p2.idTopic) AS pCount
             FROM        topics AS t
               LEFT JOIN posts AS p2
               ON        t.id = p2.idTopic
             GROUP BY    t.idCategory) AS p
  ON         c.id = p.idCategory
GROUP BY     t.idCategory
ORDER BY     c.id 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T00:52:18.470

如果您说的是简单，我想这可能是一个答案：

```
Select 
      c.*,
      (Select count(*) from topic t where c.id = t.idCategory) as tCount,
      (Select count(*) from posts p join topics t2 on t2.id = p.idTopic where c.id = t2.idCategory) as pCount
From categories c 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T01:16:22.850

您可以先将派生表中的主题和帖子放在一起，然后再加入类别：

```
SELECT 
    c.id,
    COUNT(tp.id) AS TotalTopics,
    tp.TotalPosts
FROM categories AS c
    LEFT JOIN (
        SELECT 
            t.id,
            t.idCategory,
            COUNT(p.id) AS TotalPosts
        FROM topics AS t 
            LEFT JOIN posts AS p ON t.id = p.idTopic
        GROUP BY    
            t.id,
            t.idCategory) AS tp ON c.id = tp.idCategory
GROUP BY 
    c.id,
    tp.TotalPosts
ORDER BY c.id 
```

# javascript - 如何打开弹出窗口并绑定到弹出窗口关闭？

> ID：10201110
> 
> 赞同：0
> 
> 时间：2012-04-18T00:28:06.810
> 
> 标签：javascript, jquery

我正在打开一个弹出窗口，如下所示：

```
popup = window.open(url, "", "width=600,height=300,status=no,scrollbars=no,resizable=no");
popup.focus(); 
```

我想要做的是在弹出窗口关闭时刷新开启器。这可能吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T00:39:14.903

以下应该做到这一点（将其放在 内`<head>...</head>`）：

```
<script>
window.onunload=function(){
  if(window.opener && !window.opener.closed)
    window.opener.location.reload(true);
};
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T00:58:21.470

如果您不能在弹出窗口中放置任何内容，那将是一个问题。如果您无法更改弹出窗口，那么您的选择有限。您基本上可以在窗口首次打开时设置会话变量（使用 PHP 或任何您的服务器语言），并在获得焦点后自动刷新页面（假设弹出窗口关注初始加载）。让您的服务器代码检测会话变量，如果已设置，则不要将脚本写入头部。

# c# - C#自动化应用程序

> ID：10201111
> 
> 赞同：0
> 
> 时间：2012-04-18T00:28:15.983
> 
> 标签：c#, email, automation, console-application

我想用 C# 为我的公司创建一个自动电子邮件分发应用程序。通常，我会创建一个控制台应用程序并设置一个时间表以从服务器任务调度程序运行该程序。除了控制台应用程序之外，还有其他方法可以构建这种应用程序吗？与控制台应用程序相比，它有什么好处。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T00:33:03.737

它可以用于每种应用程序类型。Asp.net\Silverlight\WCF\WPF\WinForm...

`Console Application`是最简单的方法，因为

*   它没有 UI 层（或几乎没有……）。
*   无需配置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T00:34:52.687

如果您有一个强大的调度应用程序（例如任务调度程序），那么在您的应用程序中重建它几乎没有意义。如果调度应用程序不足以满足您的需求，您需要将该逻辑嵌入到您的应用程序中。

无论哪种方式，控制台应用程序都很好。后一种情况只需要更多配置（可能以配置文件的形式）。除非配置很复杂，否则仍然不需要 UI。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T00:42:37.193

你可以写一个服务。在 .Net 中编写服务太简单直接了，然后您需要使用计时器来按计划调用操作。

服务将在后台执行，并且可以配置为在计算机打开时立即执行。

因为服务没有用户界面，所以您需要使用数据库或消息传递系统向它们提供请求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T00:42:45.500

控制台应用程序的 Windows 计划是可以的。

如果您的日程安排是连续的（每分钟），那么您最好使用 Windows 服务，请参阅[此处](http://msdn.microsoft.com/en-us/library/zt39148a%28v=vs.80%29.aspx)。

请参阅此 stackoverflow 问题以进行比较[这里](https://stackoverflow.com/questions/390307/windows-service-vs-scheduled-task)

# ruby - 需要帮助理解 ruby 的 Process.detach

> ID：10201115
> 
> 赞同：9
> 
> 时间：2012-04-18T00:28:35.580
> 
> 标签：ruby

我正在通过 ruby​​ 学习系统编程，但我无法理解这种行为：

```
pid = fork do
  Signal.trap("USR1") do  
    puts "hello!"
  end
  Signal.trap("TERM") do
    puts "Terminating"
    exit
  end
  loop do
  end
end

Process.detach(pid)

Process.kill("USR1", pid)
Process.kill("USR1", pid)
Process.kill("USR1", pid)
Process.kill("USR1", pid)

Process.kill("TERM", pid) 
```

这输出如我所料：

```
hello!
hello!
hello!
hello!
Terminating 
```

但是，如果我注释掉 Process.detach，子进程似乎只响应一次信号（并且在终止之后？）：

```
Terminating
hello! 
```

我很困惑为什么当我不分离进程时会发生这种情况，即使我发送了 USR1 四次。有人可以帮助解释这种行为吗？我想我不明白分离流程意味着什么。

非常感谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-18T01:36:47.520

我怀疑这完全取决于时间 - 也就是说，差异在于您的主进程和分叉进程的指令如何安排相对于彼此运行。

当您执行 Process.detach 时，会创建一个新线程，该线程等待给定进程的退出结果。您可以将 Process.detach 替换为

```
Thread.new { Process.wait(pid) } 
```

并获得相同的效果。我怀疑调用 detach （并产生一个新线程）会给你的分叉进程，作为一个副作用，一个被安排的机会。

如果你没有分离，那么我猜你的分叉进程在你告诉它死亡时没有机会运行。

您可以通过在代码中插入一些睡眠调用来了解我所说的相对时间的含义，以查看是否可以在不分离的情况下获得相同的观察行为。

例如，这似乎对我有用，尽管您的里程可能会因您的主机平台而异：

```
pid = fork do
  Signal.trap("USR1") do
    puts "hello!"
  end
  Signal.trap("TERM") do
    puts "Terminating"
    exit
  end
  loop do
  end
end

sleep(1)

Process.kill("USR1", pid)
Process.kill("USR1", pid)
Process.kill("USR1", pid)
Process.kill("USR1", pid)

sleep(1)

Process.kill("TERM", pid) 
```

这会产生：

```
hello!
hello!
hello!
hello!
Terminating 
```

# vbscript - 使用VB脚本进行字符串过滤和设置权限

> ID：10201118
> 
> 赞同：0
> 
> 时间：2012-04-18T00:28:55.623
> 
> 标签：vbscript

请帮我做两件事。

I. 执行此脚本时，文件夹会像这样创建，例如：“CN=Astra,OU=aaa,OU=bbb,OU=ccc,DC=ddd,DC=com” 但我需要使用 Astra (CN) 创建文件夹只要。

代码：

```
On Error Resume Next
Dim objFSO, objFolder

Set objGroup = GetObject _
("LDAP://cn=UserCreation,ou=aaa,ou=bbb,ou=ccc,dc=ddd,dc=com")
objGroup.GetInfo

arrMemberOf = objGroup.GetEx("member")

For Each strMember in arrMemberOf

Set objFSO = CreateObject("Scripting.FileSystemObject") 
Set objFolder = objFSO.CreateFolder(strMember)

Next 
```

二、请帮我设置各个文件夹的用户权限。用户正在从 AD 组获取。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T00:51:23.960

```
sFilterString = "CN=Astra,OU=aaa,OU=bbb,OU=ccc,DC=ddd,DC=com"

'here we break the string into an array of values:
'  aJustCN(0) = "CN=Astra"
'  aJustCN(1) = "OU=aaa"
'  aJustCN(2) = "OU=bbb"
'  ...
'  aJustCN(5) = "OU=com"
aJustCN = Split(sFilterString)

'Here we just truncate the CN= from the string
sJustCN = Replace(aJustCN(0),"CN=","")

'This will return "Astra"
Wscript.Echo sJustCN 
```

# sql - 数据库架构设计（Visio 正向工程错误）：子列形成键

> ID：10201119
> 
> 赞同：0
> 
> 时间：2012-04-18T00:29:01.627
> 
> 标签：sql, database-design

我已经在 Visio 2010 中构建了一个数据库 Molde 图，并试图将该图转发工程为 Schema。

我坚持修复我收到的以下警告：

```
 warning : 'User_Screen_SCREENS_FK1' : Relationship has cardinality other than either zero-or-one or exactly-one, yet the child columns form a key. 
```

有问题的两个表如下：

![在此处输入图像描述](../Images/8b9d94b6c69c8ff89ebe7794704f12f7.png)

该`Screens`表是我存储此应用程序中可用的所有“屏幕”的地方，`User_Screens`用于控制用户可以访问的屏幕。（有单独`Users`的表有`1 to 0 or more`关系`User_Screen`）。

我不确定问题出在哪里以及如何解决？谁能告诉我我哪里出错了？

## 更新：

修改了关系并包含了所有相关表，以更好地说明下图中的问题：

![在此处输入图像描述](../Images/ac0e5f654083bb543cef43232b0886d6.png)

我有错误：

```
 error : 'User_Screen_SCREENS_FK1' : Child column(s) not specified. 
```

我无法摆脱的警告：

```
warning : 'POSITION_USERS_FK1' : Relationship has a cardinality of either zero-or-one or exactly-one, yet the child columns form part of a key.

 warning : 'User_Screen_SCREENS_FK1' : Child columns overlap with child columns of USERS_SCREENS_FK1.

 warning : 'USERS_SCREENS_FK1' : Relationship has cardinality other than either zero-or-one or exactly-one, yet the child columns form a key. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T01:01:38.380

我认为这很困惑，因为您试图将每个表中的 PK 添加为每个表中的 FK。尝试为每个表提供一个 PK、一个基本的自动编号 INT，并消除您的多列主键：

**屏幕**：PK：ScreenID INT | FK：位置 ID

**职位**: PK: PositionID INT | 职位名称 VARCHAR

**User_Screens** : PK: UserScreenID INT | FK：用户 ID | FK：屏幕ID

这将屏幕级信息和用户级信息分开：例如，您不需要两个表中的 positionID（如果我理解那是什么意思），它只是属于屏幕。您可以从您的加入中获取职位信息。这将为您提供给定用户的所有屏幕位置：

```
SELECT [PositionName] FROM UserScreens t1 JOIN Screens t2 ON t1.ScreenID = t2.ScreenID JOIN Positions t3 ON t2.PositionID = t3.PositionID WHERE t1.UserID = 12345 
```

* * *

更新：您仍然在不需要的地方定义了太多外键。例如，Screens 表不需要 UserPK 上的 FK，因为 UserScreens 表将成为它们之间的链接。忽略非 PK 和非 FK 字段：

```
[Users]: UserPK
[Screens]: ScreenPK, PositionPK_FK
[UserScreen]: UserScreenPK, UserPK_FK, ScreenPK_FK 
```

如果位置可以在用户之间更改，请将 PositionPK_FK 移动到 [UserScreen]。

# c++ - 我可以将 boost::bind() 与 mem_fun_ref() 一起使用吗？

> ID：10201120
> 
> 赞同：3
> 
> 时间：2012-04-18T00:29:06.560
> 
> 标签：c++, boost-bind, mem-fun

我的问题很简单：我可以做这样的事情吗？

假设类 foo 包含以下成员函数：

```
foo foo::DoSomething(input_type1 input1, input_type2 input2)
{
    ... // Adjust private datamembers
    return *this;
} 
```

使用 foo：

```
std::vector<foo> foovec;
input_type1 in1;
input_type2 in2;
...
std::transform(foovec.begin(), foovec.end(), foovec.begin(), std::mem_fun_ref(boost::bind(&foo::DoSomething, in1, in2))); 
```

那么这可能吗？问题几乎在于它是否`boost::bind()`会影响它所处理的功能的成员/非成员性质。我认为我不能像这样反过来：

```
std::transform(foovec.begin(), foovec.end(), foovec.begin(), boost::bind(std::mem_fun_ref(&foo::DoSomething), _1, in1, in2))); 
```

因为`std::mem_fun_ref()`采用一元或零元函数并且`DoSomething()`是二元的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T00:49:39.570

你不需要`std::mem_fun_ref`，只需使用：

```
std::transform(foovec.begin(),
               foovec.end(),
               foovec.begin(),
               boost::bind(&foo::DoSomething, _1, in1, in2)); 
```

或者你可以`boost::bind`用

```
std::bind(&foo::DoSomething, std::placeholders::_1, in1, in2) 
```

# java - Java morphia - 按列表字段中的值查询

> ID：10201122
> 
> 赞同：0
> 
> 时间：2012-04-18T00:30:21.707
> 
> 标签：java, json, mongodb, morphia

不确定这是否可能，但这里有。

我有一个 MongoDB（使用 morphia 来访问它），它有一个如下表（对于这个例子进行了简化，但概念是相同的）：

```
{ Name : "Robert", NickNames : [ "Bob", "Twinkletoes" ] }
{ Name : "Trevor", NickNames : [ "Bob", "Mad man", "Tweedledee" ] }
{ Name : "Samuel", NickNames : [ "Sam" ] }
{ Name : "Patrick", NickNames : [ "Bob", "Mad man" ] }
{ Name : "Mark", NickNames : [ "Adam", "Bob", "Georg" ] } 
```

为了这个例子的目的，假设昵称总是按字母顺序排列，并且昵称所在的位置是相关的。

因此，正如我们所见，每个人的记录在列表中可以有不同数量的昵称。如何执行以下搜索：

*   给我所有第一个昵称“Bob”和第二个昵称“Mad man”的人（即 Person.Nicknames[0] = "Bob" && Person.Nicknames[1] = "Mad man"）

    应该返回 2 条记录 - Trevor 和 Patrick。

*   给我所有第一个昵称“Bob”的人（即 Person.Nicknames[0] = “Bob”）

    应该返回 3 条记录 - Robert、Trevor 和 Patrick。

请注意，没有返回 Mark，因为他的昵称“Bob”不在第一个索引中。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T15:12:55.173

一旦元素被插入到数组中，它们的顺序将被保留。

查询应该像您期望的那样工作：（为简洁起见，省略了_id）

```
> db.people.find({"NickNames.0":"Bob", "NickNames.1":"Mad man"}, {_id:0})
{ "Name" : "Trevor", "NickNames" : [ "Bob", "Mad man", "Tweedledee" ] }
{ "Name" : "Patrick", "NickNames" : [ "Bob", "Mad man" ] }
> db.people.find({"NickNames.0":"Bob"}, {_id:0})
{ "Name" : "Robert", "NickNames" : [ "Bob", "Twinkletoes" ] }
{ "Name" : "Trevor", "NickNames" : [ "Bob", "Mad man", "Tweedledee" ] }
{ "Name" : "Patrick", "NickNames" : [ "Bob", "Mad man" ] }
> 
```

在“Dot Notation (Reaching into Objects)”文档的“Array Element by Position”部分对此有一个简短的说明： [http ://www.mongodb.org/display/DOCS/Dot+Notation+%28Reaching+into +Objects%29#DotNotation%28ReachingintoObjects%29-ArrayElementbyPosition](http://www.mongodb.org/display/DOCS/Dot+Notation+%28Reaching+into+Objects%29#DotNotation%28ReachingintoObjects%29-ArrayElementbyPosition)

以上是在 JS shell 中完成的。我不熟悉 Morphia，因此您必须自己将查询转换为正确的 Morphia 语法。希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T01:10:45.550

职位是否相关？第一个查询是否也应该找到以下内容？

```
{ Name : "Mark", NickNames : [ "Adam", "Bob", "Georg" ] } 
```

如果确切的位置不相关，您可以使用`hasThisElement`and `hasAllOf`（仅相关部分）：

```
.field("NickNames").hasThisElement("Bob")
.field("NickNames").hasAllOf(Arrays.asList(yourArrayOfStrings)) 
```

# scala - 我可以为基于 Play 2.0 的 Java 应用程序使用 groovy 模板而不是 scala 吗？

> ID：10201130
> 
> 赞同：6
> 
> 时间：2012-04-18T00:31:10.727
> 
> 标签：scala, jakarta-ee, groovy, playframework, playframework-2.0

我是新的 Play 2.0，我很难理解用于创建视图的 scala 模板。我可以切换回 groovy，因为它存在于早期版本的 Play 框架中。例如：播放 1.2、播放 1.2.4

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-18T01:11:51.407

是的，有一个可用于 groovy 的模块： [https ://github.com/manuelbernhardt/play2-groovy-templates](https://github.com/manuelbernhardt/play2-groovy-templates)

在玩了一周之后，我发现 Scala 模板使用起来还不错——尤其是如果您在控制器部分使用 Scala。您可能会考虑坚持学习曲线。

**添加评论：**

```
object ApplicationBuild extends Build {

...

    val appDependencies = Seq(
      "eu.delving" %% "groovy-templates-plugin" % "1.1"
    )

    val main = PlayProject(appName, appVersion, appDependencies, mainLang = SCALA).settings(
      resolvers += "Delving Snapshot Repository" at "http://development.delving.org:8081/nexus/content/repositories/snapshots",
      resolvers += "Delving Releases Repository" at "http://development.delving.org:8081/nexus/content/groups/public"
    )

} 
```

为我工作。

# php - PHP 逗号数以千计，不以 .00 结尾

> ID：10201131
> 
> 赞同：0
> 
> 时间：2012-04-18T00:31:15.310
> 
> 标签：php

我需要为数千个地方添加逗号，而无需将函数添加 .00 结束。就像这样 10,000.00 我想要 10,000

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T00:33:29.317

采用[`number_format()`](http://us2.php.net/manual/en/function.number-format.php)

```
$number = 1234.56;
echo number_format($number); // 1,235 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T00:33:57.463

尝试[`number_format`](http://php.net/manual/en/function.number-format.php)：

```
$num = 10000;
$formatted = number_format($num); // '10,000' 
```

[这是一个演示。](http://ideone.com/NdzGi)

# facebook - 通过开放图发布给喜欢我们网页的用户

> ID：10201132
> 
> 赞同：1
> 
> 时间：2012-04-18T00:31:21.687
> 
> 标签：facebook, facebook-opengraph

我知道，如果用户在我们的某个网页上单击“赞”按钮，我们的网页可以用作粉丝页面，该网页设置有正确的打开图形标签。

发生这种情况时，我们如何向这些用户发布更新？

我知道它必须来自 Facebook 页面，即相应开放图形标签中的管理员。但是，我们实际上如何从管理员 Facebook 帐户向喜欢我们网站上具有正确打开图形设置的特定网页的用户发布更新。

谢谢

# android - 移动网络问题

> ID：10201133
> 
> 赞同：0
> 
> 时间：2012-04-18T00:31:28.363
> 
> 标签：android, websocket, wifi, 3g, 4g

我已经使用 websocket 协议编写了​​一个应用程序。我想确保我的应用程序的持久连接。当手机成功连接到我的服务器时，我的手机会振动。现在，只要我通过 wi-fi 建立连接，它就可以工作，但是每当我关闭 wi-fi 时，4g 服务的连接就会失败。此外，如果我随后打开 wi-fi，手机会振动。是否有我必须处理的特殊事件以确保通过 4g/3g 服务连接？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T00:35:58.750

您是否尝试过 ConnectivityManager？

看看这个：[确定和监控连接状态](http://developer.android.com/training/monitoring-device-state/connectivity-monitoring.html)

# c# - 使用 C# WebDriver 时，可以禁用 IE 原生事件吗？

> ID：10201135
> 
> 赞同：0
> 
> 时间：2012-04-18T00:31:28.977
> 
> 标签：c#, internet-explorer, webdriver, selenium-webdriver

我在 C# WebDriver 没有焦点时不执行点击事件有很多问题。

这是因为[InternetExplorerDriver](http://code.google.com/p/selenium/wiki/InternetExplorerDriver)使用必须具有真正焦点的本机事件，否则它将默默地失败。

那么，是否可以完全禁用 IE 的本机事件，类似于使用 Firefox 可以完成的操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T06:29:06.773

不，目前不可能。目前，您可以使用 JavaScript 而不是使用`WebElement.click()`. 即将推出允许您在 IE 中禁用本机事件的实现，但我无法提供其可用性的时间表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-03T21:30:27.513

对于 C# 绑定 NuGet 包“Selenium.WebDriver”（我使用的是 2.48.2 版）提供以下内容

```
var internetExplorerOptions = new InternetExplorerOptions {
                  IgnoreZoomLevel = true, 
                  EnableNativeEvents = false
               };
var driver = new new InternetExplorerDriver(internetExplorerOptions); 
```

这解决了我们开发环境中的问题。

# jquery - 如何嵌套多个keydown事件？

> ID：10201138
> 
> 赞同：0
> 
> 时间：2012-04-18T00:31:43.797
> 
> 标签：jquery

我的总体目标是能够使用 TAB 键盘键在 3 个 div 之间导航，每个 div 的 CSS id 分别为 #sectionA、#sectionB 和 #sectionC。在每个 div 中，我有一个无序列表，我想使用左右箭头键在列表中导航。

我的 HTML 标记是这样的：

```
 <div id="sectionA">
            <ul id="ul_sectionA">
                    <li> Section A -  Test B</li>
                    <li> Section A -  Test B</li>
            </ul>
    </div>
    <div id="sectionB">
            <ul id="ul_sectionB">
                    <li> Section B -  Test B</li>
                    <li> Section B -  Test B</li>
            </ul>
    </div>
            <div id="sectionC">
            <ul id="ul_sectionC">
                    <li> Section C -  Test B</li>
                    <li> Section C -  Test B</li>
            </ul>
    </div> 
```

到目前为止，我能够获得以下 jquery 代码，但在添加第二个 $(document).keydown(function() 代码后无法正常工作。

```
 $(document).ready(function()
    {
        var divs = ["sectionA","sectionB","sectionC"];
        var startIndex = 0;

        $(document).keydown(function(e)
        {
            alert("test");
                if (e.which == 9)
            {
                 $("div").css("border", "");
                    $("#"+divs[startIndex]).css("border","1px solid blue");
                var divID = $("#" +divs[startIndex]).attr("id");
                $(document).keydown(function(event)
                {
                    if(event.which == 37)
                    {
                        if("#"+divID+"ul li").addClass() == "highlight")
                        {
                            $(this).next().addClass("highlight");
                        } else
                        {
                            $(this).addClass();   
                        }
                    }
                });
                startIndex++;

                    if(startIndex === divs.length)
                    {
                            startIndex = 0;                  
                    }
                }
        });
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T01:04:07.893

希望这会让你朝着正确的方向前进。它无论如何都不是完美的。

您遇到的基本问题是尝试嵌套 keydown 事件。你就是不能那样做。相反，您需要为左右箭头设置单独的 keydown 事件，每个事件都需要确定用户“选择”了哪个 div，然后滚动浏览该 div 中的这些列表项。下面的代码将启动该过程，但它只处理左箭头，甚至还没有完成。

```
 <script type="text/javascript">
    $(document).ready(function()
    {
        var divs = ["sectionA","sectionB","sectionC"];
        var startIndex = 0;
        var startListItemIndex = 0;
        var divID;
        $(document).keydown(function(e)
        {
            if (e.which == 9)
            {

              $("div").css("border", "");

              $("#" + divID + " ul li").css("border", "0px"); //remove all borders 
              $("#"+divs[startIndex]).css("border","1px solid blue"); //now add border to selected div
              divID = $("#" +divs[startIndex]).attr("id");

              startListItemIndex = 0; //reset startIndex each time tab is pressed. 
              startIndex++;

              if(startIndex === divs.length)
              {
                      startIndex = 0;                  
              }

            }
              //left arrow click
              if(event.which == 37)
              {
                startListItemIndex++; 

                //remove all highlights first
                 $("#" + divID + " ul li").removeClass("highlight");

                //now add highlight to the next li element. 
                $("#" + divID + " ul li:nth-child(" + startListItemIndex + ")").addClass("highlight"); 
               }
        });

    });   
  </script> 
```

# asp.net-mvc - ASP.NET MVC：重定向仅对图像第一次起作用

> ID：10201139
> 
> 赞同：1
> 
> 时间：2012-04-18T00:32:05.310
> 
> 标签：asp.net-mvc, redirect

我有一个用于检索用户图片的操作方法，但是我的一些用户可能已经使用 Facebook 登录，我不想返回存储的图片而是来自 Facebook 的图片，所以我正在尝试这样的事情：

```
public ActionResult Picture(long id)
{
  var user = UsersService.GetUser(id);

  if (user.IsConnectedWithFacebook)
  {
    var url = "http://graph.facebook.com/" + user.GetFacebookId() + "/picture?type=square";
    return Redirect(url);
  }

  return File(user.PictureData, user.PictureContentType);
} 
```

在我刚刚使用的网页上：

```
<img src='@Url.Action("Picture", new {User.Id})' /> 
```

这在我第一次加载页面时非常有效，但是第二次没有显示图像。我检查了是否只调用了该操作，第二次它显示了一个页面

```
"Object moved to here." 
```

这就是 img 标签不加载任何图像的原因。

有没有办法防止这种情况发生？我在其他一些线程中读到人们建议返回 301（而不是 Redirect 返回的 302），但它返回与链接相同的页面（并且实际请求返回 200 而不是 301 或 302）。

关于如何强制它始终返回重定向的任何想法？

我真的不想添加逻辑来选择要加载到页面的图像，我也不想请求服务器上的数据然后将其返回到页面，因为它可能会很慢并成为带宽问题.

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T00:43:34.613

```
if (user.IsConnectedWithFacebook)
{
  var url = "http://graph.facebook.com/" + user.GetFacebookId() + "/picture?type=square";
  return Redirect(url);
} 
```

我认为这段代码应该返回 new ContentResult() { Content = url }; 反而。

同样在 UI 层，我建议您提供操作参数中指定的 ID。

```
<img src='@Url.Action("Picture")' /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T01:53:45.000

与其在图像控制器中使用重定向，不如将 img src 指向模板中的 facebook url ......不确定语法是否正确（事实上，我确定它不是），但类似：

```
@if(user.IsConnectedWithFacebook)
{
    <img src="http://graph.facebook.com/"......
}
else
{
    <img='@Url.Action("Picture")' />
} 
```

或者，为了更优雅和可重用，将逻辑移动到控制器上的静态方法中：

```
<img src="@ProfileController.GetUserImageUrl(id) /> 
```

在哪里

```
public static string GetUserImageUrl(long id)
{
    var user = UsersService.GetUser(id);

    if (user.IsConnectedWithFacebook)
    {
       return "http://graph.facebook.com/" + user.GetFacebookId() + "/picture?type=square";
    }
    return Url.Action("Picture");
} 
```

# php - 如何重用 Doctrine 2 实体中的列和事件？

> ID：10201140
> 
> 赞同：1
> 
> 时间：2012-04-18T00:32:23.767
> 
> 标签：php, oop, doctrine-orm, observer-pattern, composition

假设我正在编写一个博客应用程序：我的`Posts`实体应该有一个`createddate`、`modifieddate`、`name`和[`slug`](http://en.wikipedia.org/wiki/Slug_%28web_publishing%29)属性（当我为实体调用 setName() 时会生成 slug）。我想重用这段代码，但我也想*按需*重用它。例如，我可能有一个`Log`想要使用`createddate`但不想`modifieddate`使用`slug`功能的实体。

类继承，无论是通过[特征](http://php.net/manual/en/language.oop5.traits.php)（mixins）还是抽象类，似乎都不足以或至少是不正确的重用此功能的方法，因为它没有通过*is-a*测试。毕竟，实体*有一个*createddate，但它本身不是一个 createddate.. 所以我们应该使用组合而不是继承，对吗？但是，[observer](http://en.wikipedia.org/wiki/Observer_pattern)似乎在这里不起作用，因为虽然我想*按需使用此功能，但在不使用*[Reflection](http://php.net/manual/en/book.reflection.php)的情况下，Doctrine 对注释和对象属性的使用似乎使水平注入变得困难（而且成本高昂？）。

为了显示一些代码并稍微简化问题：**我可以立即将以下定义和功能注入实体而不破坏[DRY](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)或良好的 OOP（正确使用组合/继承）实践吗？**

```
/**
 * @var DateTime $createddate
 *
 * @ORM\Column(type="datetime")
 */
private $createddate;

/**
  * @ORM\PrePersist
  */
public function createddatePrePersist() {
    $this->createddate = new \DateTime('now');
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T17:33:19.100

我个人的看法是，你正在努力为你的锤子找到钉子。您不必*为*每个实体使用组合、继承、特征或任何 OOP 模式。

我倾向于认为这`creationDate`是我的实体的固有属性，任何需要创建日期的实体都具有此属性。有人可能会说这是在重复我自己，但在我看来，这使得整个实体更容易阅读。

哦，如果可以的话，我不会使用不属于我的域模型的特定于 ORM 的方法来初始化创建日期。这将在我的构造函数中完成：

```
/**
 * @var DateTime $createddate
 *
 * @ORM\Column(type="datetime")
 */
private $createddate;

public function __construct()
{
    $this->createddate = new \DateTime();
    // ... and other business rules that need to be enforced in the constructor
} 
```

# sql - SQL Server - 插入触发器与每分钟作业

> ID：10201141
> 
> 赞同：1
> 
> 时间：2012-04-18T00:32:23.900
> 
> 标签：sql, sql-server, performance, triggers

我的问题主要是关于“什么对性能最好”，但也有点“哲学上”（如果它有所作为的话）......所以让我们直接进入。

[TableA].[ColumnB] 存储了一个需要存在于 [TableC].[ColumnD] 中的值。马上，**没有涉及外键的答案**- 只是假设它们在这个环境中是“不允许的”，无论出于何种原因。

但是由于“情况 x,y,z”，[TableA].[ColumnB] 有时会得到 [TableC].[ColumnD] 中不存在的值，因为，比方说，[TableA] 是从存在的对象中填充的在将代码作为“序列化 blob”运行时，内存中的数据表示形式和 [ColumnB] 值在被其他进程从 [TableC].[ColumnD] 中删除这些值之前填充。无论如何，这是为了举例，所以不要陷入“为什么会发生这种情况”，只要接受它。

要“解决”问题，这两种方法中哪种方法最好： 1\. 在 [TableA] 上创建一个触发 on-INSERT 的触发器，将 [ColumnB] 更新为它应该是的值（并假设我有一个“映射”的坏值到好值）。或者，2\. 每隔一小时/一分钟/运行更新查询的任何时间运行一个计划作业，以将所有可能的“坏”值更改为其相应的“好”值。

更一般地说，什么对性能更好和/或什么是最佳实践：触发器或定期计划作业？在上下文中，假设 [TableA] 通常大约有数十万行，一次插入 10-100 条记录，频率可能每隔几分钟到一天几次。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-18T00:37:51.703

在插入。

执行触发器就像回调——它们在逻辑上更合理，并且它们将任何延迟分散到每个查询中。进行持续检查（称为轮询或 cron-jobs）时，您会时不时地遇到更严重的滞后时刻。在几乎所有情况下，使用触发器/回调是更好的方法，因为在每个查询中添加 1 毫秒的延迟优于看似随机间隔的 100 毫秒的延迟。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T00:36:27.850

触发器既是最佳性能也是实践，因为它们保持引用完整性并允许服务器优化性能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T01:15:58.367

通常不鼓励使用触发器，但是您的负载很轻，并且您的案例似乎是一个自然的触发器案例。考虑使用而不是触发器来避免对同一行进行两次操作（一次插入而不是插入和更新）。它可能是最简单和最可靠的解决方案（只要您在触发器中编写了不会导致整个操作崩溃的可靠代码）。

由于您正在考虑批处理作业，因此您不必担心时间问题。也就是说，您的应用程序可以在 1 分钟甚至 1 小时内不同步表。这是与触发器方法的主要区别，它将保证表始终保持同步。潜在的时间问题会让我感到不舒服。从好的方面来说，您不会面临使用触发器导致原始插入操作崩溃的风险。

如果您走这条路线，请考虑更改跟踪功能。更改跟踪将指示自上次检查以来已插入哪些行，因此您不必扫描整个表以查找新记录。或者，如果您的 TableA 有一个 INDENITY 主键或唯一键，您可以实现类似的设计，而无需更改跟踪功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T15:03:15.647

您没有说您使用的是什么版本的 SQL Server，但如果是 2008+，您可以使用[更改数据捕获](http://msdn.microsoft.com/en-us/library/bb522489%28v=sql.100%29.aspx)来跟踪对“主”表的数据更改。然后，您可以定期在更改表上运行批处理，并对该小集合执行所需的任何处理。

# jquery - jquery cookie 和 div 样式显示块/无

> ID：10201145
> 
> 赞同：1
> 
> 时间：2012-04-18T00:32:40.753
> 
> 标签：jquery, html, jquery-cookie

我之前的脚本在调用时隐藏和显示某些 div，但我希望 cookie 记住要显示哪个，这样用户就不必不断单击每个页面上的链接，但到目前为止我未能获得 jquery.cookie插入与我的编码一起工作，任何帮助都会很棒。

工作单页：旧代码 jquery：

```
function language(chosenlanguage) {
 $('div[name|="lang"]').each(function(index) {
      if ($(this).attr("class") == chosenlanguage) {
           $(this).show(0);
      }
      else {
           $(this).hide(0);
      }
 });
} 
```

旧代码 html（仅缩写为 href 和 div）：

```
<div class="language">
<a href="javascript:language('english');">english</a>
<a href="javascript:language('spanish');">spanish</a>
<a href="javascript:language('german');">german</a>
</div>
<div name="lang" class="english" style="display:block;">content</div>
<div name="lang" class="spanish" style="display:none;">content</div>
<div name="lang" class="german" style="display:none;">content</div> 
```

我使用 jquery.cookie.js 插件的新代码如图所示，但它完全没有任何作用。

带有 cookie 脚本的 jquery：

```
$(document).ready(function() { 
if($.cookie("language")) {
    $('div[name|="lang"]').each(function(index) {
      if ($(this).attr("class") == $.cookie("language")) {
           $(this).show(0);
      }
      else {
           $(this).hide(0);
      }
 });
}
$(".language a").click(function() { 
    $('div[name|="lang"]').each(function(index) {
      if ($(this).attr("class") == $(".language a").attr("name")) {
           $(this).show(0);
      }
      else {
           $(this).hide(0);
      }
 });
$.cookie("language",$('.language a').attr('name'), {expires: 365, path:      '/'});
    return false;
});
}); 
```

html（缩写）：

```
<div class="language">
<a href="javascript:language('english');" name="english">english</a>
<a href="javascript:language('spanish');" name="spanish">spanish</a>
<a href="javascript:language('german');" name="german">german</a>
</div>
<div name="lang" class="english" style="display:block;">content</div>
<div name="lang" class="spanish" style="display:none;">content</div>
<div name="lang" class="german" style="display:none;">content</div> 
```

所以我只是想知道我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T01:01:47.163

```
$.cookie("language",$('.language a').attr('name'), {expires: 365, path:      '/'});
    return false;
}); 
```

总是将 cookie 的值设置为，`english`因为它总是返回第`name`一个`<a />``.languages`

此外，您不应以这种方式将类与字符串进行比较：`.attr('class') == lang`，而应使用`hasClass`，例如：`.hasClass(lang)`

```
$(".language a").click(function() { 
    $('div[name|="lang"]').each(function(index) {
      if ($(this).attr("class") == $(".language a").attr("name")) {
           $(this).show(0);
      }
      else {
           $(this).hide(0);
      }
 }); 
```

应该看起来像：

```
$(".language a").click(function() { 
    var clicked = this;
    $('div[name|="lang"]').each(function(index) {
      if ($(this).hasClass($(clicked).attr("name"))) {
           $(this).show();
      }
      else {
           $(this).hide();
      }
    });
    $.cookie("language", $(clicked).attr('name'), {expires: 365, path: '/'});
}); 
```

请注意，在循环遍历 div 之前，我将单击的项目保存在变量中，您需要这样做才能引用单击的项目

# iphone - 表格视图不显示数据，iphone

> ID：10201154
> 
> 赞同：2
> 
> 时间：2012-04-18T00:33:17.840
> 
> 标签：iphone, objective-c, ios, cocoa-touch

我现在正在使用 UITableView，我拥有的是

> 我的类.h
> 
> @interface MyClass : UIViewController {
> 
> }
> 
> @property (strong , strong) UILabel *name;
> 
> @property (strong , strong) UILabel *add;

和

> 我的班级.m
> 
> -(NSInteger)tableView:(UITableView *)atableView numberOfRowsInSection:(NSInteger)section{
> 
> ```
> return 3 ;
>  } 
> ```
> 
> -(UITableViewCell *)tableView:(UITableView *)aTableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
> 
> ```
> static NSString *CellIdentifier = @"cell";
> tableCell = [aTableView dequeueReusableCellWithIdentifier:CellIdentifier];
> ...................................................
> 
> return tableCell; 
> ```
> 
> }

**当我在numberOfRowsInSection**设置断点时，它似乎根本没有被执行。现在让我很困惑。有遇到过的请指教。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T00:44:14.240

最常见的原因是没有将视图控制器设置为表视图委托和数据源。如果它内置在故事板中，您可以通过选择表上的连接检查器并将这些属性拖到视图控制器来执行此操作。

否则，在这样的代码中设置它：

```
self.tableView.delegate = self;
self.tableView.datasource = self; 
```

# c - 使用流在 *nix 进程之间传递输入/输出

> ID：10201164
> 
> 赞同：0
> 
> 时间：2012-04-18T00:34:53.377
> 
> 标签：c, linux, stream, exec, fork

我正在使用 C 语言开发一个相当简单的应用程序。最终目标是在 *nix 环境中将一个进程的输出通过管道传输到另一个进程的输入（是的，我知道 pipe() 命令和 dup/dup2 但是我正在尝试使用这些命令四处寻找）。我想知道是否有任何方法可以连接流而不是使用文件描述符（不能保证系统符合 POSIX）。

所以基本上我想做这样的事情（伪代码）

```
pid = fork()

if pid == 0 
    // assign this process's stdin to the parents stdout.
    stdin = parent.stdout;
    exec() // launch new process that receives the parents stdout as stdin
    // child stuff....
else
    // parent stuff.... 
```

我知道它可能不会像上面那样简单，但是有没有办法只使用流来做到这一点？我试着环顾四周，但找不到任何东西。。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T00:41:50.807

抱歉，如果我在这里遗漏了重点，但 *nix 的整个理念是一个程序，一份工作。如果您需要一个程序将程序的内容转储到屏幕上，那么您可以使用 cat 命令。如果文件太大并且您需要分页符，则将 cat 的输出通过管道传递给 more 命令：

猫 myfile.txt | 更多的

如果您需要在两个终端应用程序之间进行管道传输，那么您应该使用命令行来执行此操作：

myprog1 | myprog2

显然这是哲学方法，所以如果这没有帮助，那么你能否澄清你试图管道的内容以及你为什么要在过程中这样做？

# gwt - GWT 应用程序在开发模式下运行但无法编译

> ID：10201165
> 
> 赞同：3
> 
> 时间：2012-04-18T00:35:02.543
> 
> 标签：gwt, gwt-gin, gwt-platform

我的 GWT 应用程序在开发模式下工作，但是当我编译时出现此错误：

```
[ERROR] Errors in generated://F1C9BA113391FC353E7321372D77396D/com/mygwtapp/client/gin/ClientGinjectorImpl.java'
[ERROR] Line 64:  Rebind result 'com.mygwtapp.client.core.presenter.ResponsePresenter.MyView' must be a class
[ERROR] Line 2319:  Rebind result 'com.mygwtapp.client.core.presenter.MainPagePresenter.MyView' must be a class
[ERROR] Cannot proceed due to previous errors 
```

我正在使用 GWT 2.4.0 和 GwtPlatform。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T03:09:10.833

这表明您已经注入`MainPagePresenter.MyView`，`ResponsePresenter.MyView`但未绑定到具体类型。它在开发模式下工作（我假设您只有一个模块）但未编译的事实表明 ginjector 正在寻找您在运行开发模式时没有碰到的注入点。

确保这两个都绑定在您的 ginjector 中（或者您`replace-with`为它们定义了规则），或者删除对它们的引用。

（如果一切正常，考虑发布一些代码，比如你的 ginjector 接口，也许是生成的代码，你的模块等）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T10:47:21.613

请参阅文档：将[所有内容绑定在一起](http://code.google.com/p/gwt-platform/wiki/GettingStarted?tm=6#Binding_everything_together)。您必须将演示者、视图和代理绑定在一起。尽管如此，我很惊讶它在开发模式下工作。

# objective-c - UIScrollView 中的 UIImageVIew 中的 UIImage

> ID：10201166
> 
> 赞同：0
> 
> 时间：2012-04-18T00:35:19.193
> 
> 标签：objective-c, ios, uiscrollview, uiimageview, uiimage

我放弃。似乎无法使这个非常基本的事情起作用。请帮忙...

我正在尝试将图像从 URL 加载到可滚动的、捏合/缩放的屏幕上。

这是我的代码片段，它产生一个空白的白色屏幕。我选择将它放在 viewDidAppear 中：

```
@property (weak, nonatomic) UIScrollView *scrollView;
@property (weak, nonatomic) UIImageView *imageView; 
```

...

```
- (void)viewDidAppear:(BOOL)animated {

    NSData *photoData = [[NSData alloc] initWithContentsOfURL:[NSURL URLWithString:urlForImage]];
    UIImage *photoImage = [[UIImage alloc] initWithData:photoData];

    self.scrollView = [[UIScrollView alloc] initWithFrame:self.view.frame];
    [self.scrollView setContentSize:photoImage.size];
    [self.scrollView setMinimumZoomScale:1];
    [self.scrollView setMaximumZoomScale:5];
    [self.view addSubview:self.scrollView];

    self.imageView = [[UIImageView alloc] initWithImage:photoImage];
    [self.imageView setContentMode:UIViewContentModeScaleAspectFit];
    [self.imageView setFrame:self.view.frame];
    [self.scrollView addSubview:self.imageView];

} 
```

我还实现了 viewForZoomingInScrollView：

```
- (UIView *)viewForZoomingInScrollView:(UIScrollView *)scrollView
{ 
    return self.imageView;
} 
```

我得到一个白屏。我错过了什么？先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T02:41:31.477

正如@jonkroll 建议的那样，问题在于您将保留对象分配给弱变量。它不像 IBOutlet，[它通常应该是 weak](https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/LoadingResources/CocoaNibs/CocoaNibs.html#//apple_ref/doc/uid/10000051i-CH4-SW6)。在这里，您肯定想将其更改为强，它应该可以解决您的问题。

为了演示当前的问题，例如，如果您在 alloc/init 语句之后为 scrollView 放置以下语句，您可能会惊讶地看到它是 nil，因为 ARC 已经为您发布了它，例如：

```
NSLog(@"scrollView = %p", scrollView); 
```

让他们坚强，你就没事了。如果你只用 scrollView 和 imageView 替换你的 self.scrollView 和 self.imageView，你可能会看到编译器警告。

或者，如果您出于其他原因不需要这些变量，您也可以完全忘记将它们设置为属性，并将它们设置为 viewDidLoad 方法的本地变量（当您将它们添加为子视图时，视图本身将被保留......不除非出于某种原因在其他方法中需要 vars，否则有理由将它们设为属性或 ivars）。除非需要，否则我不喜欢添加属性或 ivars。如果您需要它们，很好，您需要它们，但如果您不需要，请将它们设为本地 viewDidLoad 变量。

# c# - 在 C# 中迭代 泛型列表时的性能问题

> ID：10201168
> 
> 赞同：3
> 
> 时间：2012-04-18T00:35:26.437
> 
> 标签：c#, visual-studio-2008, list, generics

假设我们有这些具有一些共同属性的业务对象：

```
public class A
{
    // Properties in common
    public int Common { get; set; }
    public string aValue { get; set; }
    // Some other goes here.
}

public class B
{
    // Properties in common
    public int Common { get; set; }
    public string bValue { get; set; }

    // Some other goes here.
} 
```

在我们的业务逻辑中，我们有两个类似这样的列表：

```
List<A> aList = new List<A>();
List<B> bList = new List<B>(); 
```

（假设我们为这些列表填充了至少 100 个实例） 好的，让我们从我们的问题开始，我们需要遍历 aList 以便为 bList 中的每个实例设置一个属性，该属性当然与共有属性，如下所示：

```
foreach (A a in aList)
{
    B b = bList.Find(x => x.Common == a.Common);
    if (b != null)
        b.bValue = a.aValue;
} 
```

有谁知道改进此操作的更好方法，因为它导致我们的应用程序需要太多时间才能完成？

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T00:39:44.750

这表现不佳，因为`Find`列表是线性的。得到的算法是`O(n^2)`。

您应该`Dictionary`从`bList`common 属性上创建一个，并通过 key 查找而不是使用`Find`; 字典查找是`O(1)`摊销的，所以它会使你的算法在列表的长度上是线性的。

```
var dict = bList.ToDictionary(b => b.Common);
foreach (A a in aList) {
    B b;
    if (dict.TryGetValue(a.Common, out b) {
        b.bValue = a.aValue;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T00:42:02.270

为了有效地查找值，给定某个键，您不会使用列表，而是使用字典。要在列表中查找特定项目需要 O(N)，在字典中需要 O(1)。

```
Dictionary<int, B> bDict = new Dictionary<int, B>();
foreach (B b in bList) bDict.Add(b.Common, b);

foreach (A a in aList) {
  if (bDict.ContainsKey(a.Common)) 
    bDict[a.Common].bValue = a.aValue;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T00:38:35.663

将您的 bList 复制到以 Common 作为键的字典类型容器中，并在循环中使用它而不是 bList 本身。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T00:47:53.473

我相信，如果您在 linq 中进行联接，它将在两个列表中为您进行哈希联接，这将节省您手动创建字典的时间，如其他答案中所建议的那样。我在这台机器上没有工作室来为您制作样本，稍后会尝试更新。

如果项目的数量非常少，Linq 甚至可能足够聪明，不会启动散列连接。

编辑：给这样的东西一个旋转：

```
var joined = from a in aList
                    join b in bList on a.Common equals b.Common
                    select new {
                            A = a,
                            B = b
                    };

            foreach (var item in joined)
            {
                    item.B.bValue = item.A.aValue;
            } 
```

# php - 循环遍历另一个数组php中的数组

> ID：10201170
> 
> 赞同：0
> 
> 时间：2012-04-18T00:35:58.613
> 
> 标签：php

我想将一个数组嵌套在另一个数组中，我的代码将与此类似

```
array(
'type' => 'FeatureCollection',
'features' => array(
    array(
        'type' => 'Feature',
        'geometry' => array(
            'coordinates' => array(-94.34885, 39.35757),
            'type' => 'Point'
        ), // geometry
        'properties' => array(
            // latitude, longitude, id etc.
        ) // properties
    ), // end of first feature
    array( ... ), // etc.
) // features
) 
```

外部（功能）封装了许多其他数组。我需要遍历从我已经解码的 json 文件中提取的变量——我将如何遍历这些数据集？一个`foreach()`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T01:25:53.647

你知道数组的孩子的深度/数量吗？如果您知道深度是否始终保持不变？如果这两个问题的答案都是肯定的，那么 foreach 应该可以解决问题。

```
$values = array(
'type' => 'FeatureCollection',
'features' => array(
    array(
        'type' => 'Feature',
        'geometry' => array(
            'coordinates' => array(-94.34885, 39.35757),
            'type' => 'Point'
        ), // geometry
        'properties' => array(
            // latitude, longitude, id etc.
        ) // properties
    ), // end of first feature
    array('..'), // etc.
) // features
);

foreach($values as $value)
{
    if(is_array($value)) {
        foreach ($value as $childValue) {
            //.... continues on 
        }
    }
} 
```

但是，如果这两个问题中的任何一个的答案是否定的，我都会使用递归函数和 foreach，类似这样的东西。

```
public function myrecursive($values) {
    foreach($values as $value)
    {
        if(is_array($value)) {
            myrecursive($value);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T00:39:38.783

嵌套的foreach。

```
$myData = array( array( 1, 2, 3 ), array( 'A', 'B', 'C' ) )

foreach($myData as $child) 
  foreach($child as $val)
    print $val; 
```

将打印 123ABC。

# ios - AVMediaTypeMuxed 是什么意思？

> ID：10201176
> 
> 赞同：9
> 
> 时间：2012-04-18T00:37:18.710
> 
> 标签：ios

简单的问题：什么`AVMediaTypeMuxed`意思？

我正在查看一些示例代码（如下），但它在我的 iPad 2 上没有返回任何内容。那么`AVMediaTypeMuxed`设备媒体类型是否仅存在于 iPhone 上？

```
AVCaptureDevice *muxedDevice = [AVCaptureDevice defaultDeviceWithMediaType: AVMediaTypeMuxed];
if (muxedDevice) {
    NSLog (@"got muxedDevice");
    AVCaptureDeviceInput *muxedInput = [AVCaptureDeviceInput deviceInputWithDevice:muxedDevice
                                                                             error:&setUpError];
    if (muxedInput) {
        [captureSession addInput:muxedInput];
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-18T01:26:30.083

mux 是 Multiplex 的缩短版本；因此，多路混合媒体是将多个流组合成一个流的媒体——通常这意味着音频和视频流被组合成一个字节流。

因此，如果没有默认的多路媒体输出设备，我不会感到惊讶，因为 Apple 可能只是决定默认输入分别是摄像头和麦克风。

# java - int 到字节，“无法解析为变量”。怎么了？

> ID：10201178
> 
> 赞同：0
> 
> 时间：2012-04-18T00:37:50.673
> 
> 标签：java, int, byte

这有什么问题；

```
public class cast {

    public static void main(String args[]){
        double x, y; 
        int i;
        char c; 

        x = 10.0; 
        y = 3.0; 

        i = (int) (x / y); 
        System.out.println("Integer outcome of x / y = " + i); 

        i = 100; //Assaigning new value to i. 

        b = (byte) i;  
        System.out.println("The value of i is: " + b); 

    }

} 
```

它给了我以下错误信息；b 无法解析为变量。

虽然我完全按照他们在书中所做的（我认为，重新阅读书籍说明五遍......）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T00:39:20.543

*b*在您的示例中不是声明的变量。在你可以使用一个变量之前，你必须声明它。如果你不这样做，Java 不知道*b*代表什么，也不知道如何处理它。尝试

```
byte b = (byte) i; 
```

反而。或者，您也可以添加该行

```
byte b; 
```

到程序的开头。这告诉 Java 你希望*b*是一个可以保存一个字节的变量。

# ios - 带有圆角、阴影和背景图案的 UILabel

> ID：10201180
> 
> 赞同：9
> 
> 时间：2012-04-18T00:37:51.667
> 
> 标签：ios, uilabel, calayer, shadow

我一直在尝试我找到的每一种方法，但我无法做到。我只想制作一个带有圆角的标签，一个带有背景图案的阴影。只有当我不想要圆角时，阴影才有效。我不能让他们两个在一起！

这是我的阴影代码：

```
label.text = msg;
label.textAlignment = UITextAlignmentCenter;
label.frame = CGRectMake(20,10,280,40);
label.backgroundColor 
    = [[UIColor alloc] initWithPatternImage:[UIImage imageNamed:@"msg_box_bg.png"]];

[label.layer setCornerRadius:10];
[label.layer setMasksToBounds:NO];

/* Shadow */
label.layer.shadowColor = [UIColor blackColor].CGColor;
label.layer.shadowOpacity = 0.6;
label.layer.shadowOffset = CGSizeMake(0,0);
label.layer.shadowRadius = 3; 
```

这给了我没有圆角的阴影。但是如果我使用

```
[label.layer setMasksToBounds:YES]; 
```

这会给我没有阴影的圆角。我接受了使用阴影路径的建议，因此带有阴影路径的代码如下所示：

```
label.text = msg;
label.textAlignment = UITextAlignmentCenter;
label.frame = CGRectMake(20,10,280,40);
label.backgroundColor 
    = [[UIColor alloc] initWithPatternImage:[UIImage imageNamed:@"msg_box_bg.png"]];

[label.layer setCornerRadius:10];
[label.layer setMasksToBounds:YES];

/* Shadow */
label.layer.shadowColor = [UIColor blackColor].CGColor;
label.layer.shadowOpacity = 0.6;
label.layer.shadowOffset = CGSizeMake(0,0);
label.layer.shadowRadius = 3;
label.layer.shadowPath = [[UIBezierPath bezierPathWithRoundedRect:label.frame cornerRadius:10]CGPath];
label.layer.shouldRasterize = YES; 
```

这段代码确实给了我圆角但没有阴影。有什么建议么？

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-20T05:09:38.207

![在此处输入图像描述](../Images/a8f65f2a19557276ebf77e66223231e7.png)

我使用下面的代码来获得您想要的结果。

```
CGSize size = CGSizeMake(280, 40);

/** Shadow */
CALayer *shadowLayer = [CALayer new];
shadowLayer.frame = CGRectMake(20,100,size.width,size.height);
shadowLayer.cornerRadius = 10;

shadowLayer.backgroundColor = [UIColor clearColor].CGColor; 
shadowLayer.shadowColor = [UIColor blackColor].CGColor;
shadowLayer.shadowOpacity = 0.6;
shadowLayer.shadowOffset = CGSizeMake(0,0);
shadowLayer.shadowRadius = 3;

/** Label */
UILabel *label = [UILabel new];
label.text = @"Hello World";
label.textAlignment = UITextAlignmentCenter;
label.frame = CGRectMake(0, 0, size.width, size.height);
label.backgroundColor = [UIColor clearColor]; 
label.layer.cornerRadius = 10;
[label.layer setMasksToBounds:YES];
//  customLabel.backgroundColor = [UIColor whiteColor]; 
label.backgroundColor = [[UIColor alloc] initWithPatternImage:[UIImage imageNamed:@"options.png"]];

/** Add the Label to the shawdow layer */
[shadowLayer addSublayer:label.layer];

[self.view.layer addSublayer:shadowLayer];      

[shadowLayer release]; 
```

# mysql - Mysql存储优化

> ID：10201184
> 
> 赞同：0
> 
> 时间：2012-04-18T00:38:22.490
> 
> 标签：mysql, optimization

我在每个 mysql 数据库行中存储一个大约 1500 个字符长的大字符串。这个值不经常使用，使得性能不是很重要，但是来自数据库其他列的值被频繁使用。

将这些大字符串存储到此表中与其他数据相同的行中（我将更频繁地访问）对我来说不是最佳选择吗？这会以某种方式损害性能吗？

我应该将这些大字符串存储在单独的表中吗？我只是不清楚mysql如何优化这些事情，也不确定我是否需要担心。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T00:53:34.287

如果您“不触摸它们”，则无需将这些字符串保存在其他表中。

不要使用这样的东西 -

```
SELECT * FROM `my_table` 
```

这将使您从数据库中读取那个长字符串。尝试这样做。

```
SELECT field1, field2 FROM `my_table` 
```

其中 field1 和 field2 不是长字符串字段。当然，如果您需要，也可以将其包含在 SELECT 查询中。通过这种方式，您可以节省从数据库中获取的时间。

当您没有大量数据时，您无需担心这一点。

尝试阅读以下内容：

[http://dev.mysql.com/doc/refman/5.0/en/select-optimization.html](http://dev.mysql.com/doc/refman/5.0/en/select-optimization.html)

# php - CakePHP 在保存到数据库之前更改数据

> ID：10201185
> 
> 赞同：2
> 
> 时间：2012-04-18T00:38:25.667
> 
> 标签：php, cakephp

所以我在控制器中有对象 $this->data['VideoForm']['filename'] ，但我想在将它保存到数据库之前将 getExtension($filename) 的返回值附加到它。这就是我正在尝试的：

```
$this->data['VideoForm']['filename'] = $this->data['VideoForm']['filename'] . "." . getExtension($this->data['VideoForm']['file']['name']); 
```

当我尝试使用“=”或“=>”运算符为其分配新值时，它会引发错误。知道怎么做吗？我敢肯定，我错过了一些非常简单的事情...

编辑：这是错误：

```
Notice (8): Indirect modification of overloaded property MediaController::$data has no effect [APP/Controller/MediaController.php, line 31] 
```

编辑：我继续环顾四周，如果我上传 xxx.jpg，getExtension() 函数肯定会返回“jpg”，所以这不是问题。有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T07:32:02.723

该错误是由于 PHP 5.2+ 更改了 __get() 的工作方式——它不返回对值的引用，而是返回只读版本。Cake 2.0+ 将 __get() 用于某些控制器属性。

在这种情况下，解决方案是写入`$this->request->data`而不是`$this->data`.

参考：[Mark Story 在 Google 群组上的帖子](http://groups.google.com/group/cake-php/browse_thread/thread/49afb69bde427b33/9ae5c50bd48d3a2b?pli=1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T03:45:57.370

你说你想追加：

```
getExtension($filename) 
```

但是然后在您的代码中，您使用：

```
getExtension($this->data['VideoForm']['file']['name']) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T01:21:04.067

我不知道您遇到了什么错误，但我会重新格式化您的代码并让您发现不同之处：

```
$this->data['VideoForm']['filename'] =
$this->data['VideoForm']['filename'] . "." . getExtension(
$this->data['VideoForm']['file']['name']
); 
```

# gcc - 默认为 gcc 添加一些标志（最好使用 specs 文件）

> ID：10201192
> 
> 赞同：7
> 
> 时间：2012-04-18T00:39:07.893
> 
> 标签：gcc, g++

我想让我`gcc`总是默认添加一些标志，有没有一种干净的方法可以做到这一点？

基本上，我每次调用时都会传递一些标志`gcc`，例如（但不限于）`-g`（以便它具有调试信息）。

有几种解决方法，但它们很难看：

1.  `alias g++=...`，但我不喜欢这种方法；
2.  写一个环绕g++的脚本，类似1；
3.  ...

我宁愿只修改规范文件，以便一切都是无缝的。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-03T12:47:22.903

运行`strace gcc | grep specs`以查看它在哪里搜索 specs 文件，然后去那里运行`gcc -dumpspecs > specs`. 您现在有一个可以编辑的规格文件。使用此参考：[https ://gcc.gnu.org/onlinedocs/gcc/Spec-Files.html](https://gcc.gnu.org/onlinedocs/gcc/Spec-Files.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T00:44:23.457

修改 specs 文件的麻烦在于你曾经改变对某个选项的想法，你不能从命令行取消它；你必须去修改规范文件。您还必须记住在升级编译器时重新修改新的规范文件。

另外，您多久从命令行运行一次编译器？我知道我唯一一次直接这样做是当我需要临时修改命令行并且我懒得解决如何修复 makefile 中的编译器选项时，所以我从make 的输出，然后运行编译器。一个问题`alias`是它不能在`makefile`. 因此，对我来说，问题将减少到确保在每个 makefile 中都使用编译器选项。

# php - php Gmagick 保存 jpeg 质量

> ID：10201195
> 
> 赞同：2
> 
> 时间：2012-04-18T00:39:23.820
> 
> 标签：php, jpeg, gmagick

在保存或使用 Gmagick PHP 扩展时我找不到任何属性。 [http://php.net/manual/en/book.gmagick.php](http://php.net/manual/en/book.gmagick.php)

如何在 Gmagick 中更改 JPEG 质量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T00:46:09.947

setCompressionQuality() 已添加“2 年 3 个月前”，但似乎尚未记录在案。见[PHP 的 ViewVC](http://svn.php.net/viewvc?view=revision&revision=293077)

# c++ - QTestLib 单元测试框架 + Gmock (创建 QTCPServer - Mock Object)

> ID：10201199
> 
> 赞同：4
> 
> 时间：2012-04-18T00:39:51.627
> 
> 标签：c++, qt, qtestlib, gmock

我正在使用 Qt 的 QTestLib 单元测试框架 + GMOck。

我正在尝试使用 gMock 设置模拟服务器，以便在单元测试中简单地从 QTcpSocket 接收数据到 VerifySendData() 方法。

如果有人能给我一个例子，我如何创建模拟对象 gMOCK（期望调用，创建模拟对象）

```
#ifndef TST_TCPCOMMTEST_H
#define TST_TCPCOMMTEST_H

#include <QtCore/QString>
#include <QtTest/QtTest>
#include <QTcpSocket>
#include <QTcpServer>

class TcpCommTest : public QObject
{
    Q_OBJECT

private:
    QTcpSocket* pTestSocket;
    QTcpSocket* pMockSocket;
    QTcpServer* pMockServer;

public:
        TcpCommTest();

public slots:
    void connectMockServer();

private Q_SLOTS:
    void initTestCase();    
    void VerifySendData();    
    void cleanupTestCase();
};

#endif // TST_TCPCOMMTEST_H

#include "tst_tcpcommtest.h"
#include <QtDebug>
#include <QtCore/>
#include <QtTest/QtTest>
#include <QtNetwork/QtNetwork>
#include <gmock/gmock.h>

void TcpCommTest::connectMockServer()
{
    cout << "connection attempt" << endl;
    pMockSocket = pMockServer->nextPendingConnection();
}

void TcpCommTest::initTestCase()
{
    pMockSocket = NULL;
    pMockServer = new QTcpServer();

    //I want to use gMock here to create MockTCP Server
    EXPECT_CALL(pMockServer,someMethod(1).Times(AtLeaset(1));
     EXPECT_CALL(pMockServer,someMethod(2).Times(AtLeaset(1));
    //pMockServer->listen( QHostAddress("127.0.0.1"), 2000 );
    //connect( pMockServer, SIGNAL(newConnection()), SLOT(connectMockServer()) );

    pTestSocket = new QTcpSocket();
    pTestSocket->connectToHost( QHostAddress("127.0.0.1"), 2000 );

    QVERIFY( pTestSocket->waitForConnected( 1000 ) );
    QVERIFY( pTestSocket->state() == QTcpSocket::ConnectedState );
}

void TcpCommTest::VerifySendData()
{
    int i=0;
    QVERIFY( pMockSocket != NULL );
}

QTEST_MAIN(TcpCommTest); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-18T14:46:22.267

我没有足够的声誉发表评论，但我不知道你想要达到什么目的。您尝试测试的应用程序是主机还是客户端？

无论如何，你不能打电话：

```
pMockServer = new QTcpServer();
EXPECT_CALL(pMockServer,someMethod(2)) 
```

pMockServer 必须通过 MOCK_METHOD1 宏模拟 someMethod。如果 someMethod 在 QTcpServer 中是虚拟的，那么 QTcpServerMock 可以从 QTcpServer 派生并且只有

```
MOCK_METHOD1(someMethod, void(int)) 
```

如果不是所有要模拟的方法都是虚拟的，则不能使用 MOCK_METHOD1 覆盖它。我将创建由 TcpServer 和 TcpServerMock 派生的 TcpServerInterface。someMethod 在 TcpServerInterface 中是虚拟的，在 TcpServer 中实现为真实的，并由 TcpServerMock 中的宏模拟。Real TcpServer 可以将 QTcpServer 作为私有成员并将其包装起来。

# java - 不接受 Android 代码 - OnItemClickListener() - “...必须实现继承的..”

> ID：10201201
> 
> 赞同：2
> 
> 时间：2012-04-18T00:40:36.577
> 
> 标签：java, android, listview, click, onitemclicklistener

我的 OnItemClickListener 有问题。请注意，我是按照 android 开发者网站提供的指南编写的：http: [//developer.android.com/resources/tutorials/views/hello-listview.html](http://developer.android.com/resources/tutorials/views/hello-listview.html)

设置监听器时：

```
lv.setOnItemClickListener(new OnItemClickListener() { 
```

我为新的“OnItemClickListener”显示了以下错误

> “类型 new AdapterView.OnItemClickListener(){} 必须实现继承的抽象方法 AdapterView.OnItemClickListener.onItemClick(AdapterView, View, int, long)”

我尝试了 eclipse 的建议并添加了明显未实现的方法，但它只是生成了一个除了参数中的实际细节之外几乎相同的方法，例如我有

```
"int position" 
```

自动生成的代码有

```
"int arg2" 
```

并且通过使用这种方法，它使我的方法变得多余，因为它不会被调用（我认为......）

我试图更改代码的各个部分，例如参数的内容等，但我没有运气。所以我基本上是在寻找一些帮助来解决这个问题，任何建议/方向将不胜感激。我的完整代码如下所示：

```
import android.app.Activity;
import android.app.ListActivity;
import android.os.Bundle;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.ArrayAdapter;
import android.widget.ListView;
import android.widget.TextView;
import android.widget.Toast;

public class View extends ListActivity{
static final String[] entriesArray = new String[]{
    "One", "Two", "Three", "GO"};

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setListAdapter(new ArrayAdapter<String>(this, R.layout.dbrowviewer, entriesArray));

    ListView lv = getListView();
    lv.setTextFilterEnabled(true);

    lv.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
            //When clicked show toast
            Toast.makeText(getApplicationContext(), ((TextView) view).getText(),
            Toast.LENGTH_SHORT).show();
        }

    });

}
} 
```

和布局以防万一.. (R.layout.dbrowviewer)

```
<?xml version="1.0" encoding="utf-8"?>
<TextView xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:padding="10dp"
android:textSize="16sp" >
</TextView> 
```

Also if anyone has a spare second to give advice..I have an error with "(TextView) view.getText()" in the toast which states that I cannot cast from View to TextView. Have had a quick look into it with no luck but Im currently trying to solve the first and more important problem!

Thanks in advance,

Josh

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T00:52:45.653

First, this is the code I modified and it worked.

```
lv.setOnItemClickListener(new AdapterView.OnItemClickListener() {

    @Override
    public void onItemClick(AdapterView<?> parnet, android.view.View view,
            int position, long id) {
        Toast.makeText(getApplicationContext(), ((TextView) view).getText(),
                Toast.LENGTH_SHORT).show();
    }

}); 
```

The problem here is your "class" name, you've chosen "View" as your class name, which happens to be the same as android.view.View, so if you use View as the type of the second parameter of your listener, the compiler gets confused.

My suggestion is that, you'd better choose another name for your activity class. I usually use the functionality of the activity plus a "Activity" postfix as activity class name, for example, if you want to display a list of users, you can choose UserListActivity, here I choose the "ListActivity" as the postfix to indicate that the activity actually derives from ListActivity.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T00:45:54.393

Can you try adding:

`@Override`

above onItemClick():

```
lv.setOnItemClickListener(new OnItemClickListener() {

@Override
public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
         //When clicked show toast
         Toast.makeText(getApplicationContext(), ((TextView) view).getText(),
         Toast.LENGTH_SHORT).show();
}

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T01:12:55.837

View is already a class that exists, try renaming it to something else....

# java - Java计算二维数组中的重复数字

> ID：10201212
> 
> 赞同：0
> 
> 时间：2012-04-18T00:42:00.360
> 
> 标签：java, multidimensional-array

我正在尝试创建一个 java 方法，该方法将查看 2d 数组并查看多次输入数字的次数，然后输出计数。

所以给定这个数组

```
1   2   3   3   
5   6   7   8   
8   45  9   45  
10  17  18  13 
```

该方法将返回一个计数`3`。

到目前为止，这就是我所拥有的

```
int dupe=0;
    int chk1=0, chk2=0;

    for (int row =0; row < dataTable.length; row ++)
    {//for 1

        for ( int col = 0; col < dataTable[row].length; col++)
        {//for 2

            if (dataTable[row][col] ==  dataTable [chk1][chk2])
            {//if

             dupe++;
            }//end if 

        chk1++;
        chk2++;

    }//end for 2 

}//end for 1
    dupe=dupe-1;
return dupe; 
```

但是它不会运行，除非我在第二个 4 中声明 chk1 和 chk2，每次运行检查时都会重新声明它们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T00:52:16.747

如何实现：

1.  创建一个地图来存储看到的数字。
2.  循环遍历二维数组中的每一行。
3.  循环遍历二维数组中的每一列
4.  如果之前没有见过数字（不在地图中），则插入值为 1 的地图
5.  如果之前（在地图中）看到过数字，则在地图入口处增加值
6.  循环遍历map中的值，并且计数> 1；这个值就是你的答案

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T00:52:23.540

策略：遍历整个数组，并将每个元素与所有其他元素进行比较。将结果收集到一个变量中。由于我认为这是作业，我不能给你代码，但策略应该足以让你开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T01:17:04.113

两种解释：

```
/**
 * The number of entries that are double of others.
 * When 4 threes occure, 3 threes are counted.
 */
public static int moreThanOnce(int[][] matrix) {
    Set<Integer> uniqueNumbers = new HashSet<Integer>();
    int n = 0;
    for (int row = 0; row < matrix.length; ++i) {
        n += matrix[i].length;
        Collections.addAll(uniqueNumbers, matrix[i]);
    }
    return n - uniqueNumbers.size();
}

/**
 * The number of different numbers appearing more than once.
 * When four appears 3 times and eight 4 times, then the result is 2.
 */
public static int moreThanOnce2(int[][] matrix) {
    Set<Integer> usedNumbers = new HashSet<Integer>();
    Set<Integer> doubleNumbers = new HashSet<Integer>();
    for (int[] row : matrix) {
        for (int x : row) {
            if (!usedNumbers.add(x)) { // Not added, already used
                doubleNumbers.add(x);
            }
        }
    }
    return doubleNumbers.size();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T00:56:09.263

好吧，您可以通过查看每一行来遍历数组...

```
for(int i = 0; i < rows; i++) {
    for(int j = 0; j < columns; j++) {
        // check
    }
} 
```

然后通过将其与所有其他数字进行比较来检查一个数字是否重复，您可以将其存储在其他地方。

# c++ - 使用自定义分配器调用对象构造函数/析构函数

> ID：10201214
> 
> 赞同：11
> 
> 时间：2012-04-18T00:42:24.083
> 
> 标签：c++, memory, memory-management, new-operator

我一直在研究自定义分配器，我经常看到它们使用某种函数来分配内存。出于测试目的和进一步教育我自己，我试图做一个“简单”的例子。但是，我了解如何做一件基本的事情。`malloc`vs的主要区别之一`new`是使用 new 调用构造函数。如果我想编写自己的分配器，它本质上是替换`new`，我将如何让构造函数在使用时被调用`malloc`？

我知道在类上我可以重载`new`和`delete`类，所以我想问题的很大一部分是，`new`在分配期间如何调用对象构造函数？同样，我对如何`delete`调用析构函数感兴趣。

我创建了一个示例测试代码，希望`SomeClass`在分配期间调用构造函数，但我不知道如何。

```
#include <malloc.h>

void* SomeAllocationFunction(size_t size) {
    return malloc(size);
}

class SomeClass
{
public:
    SomeClass() {
        int con = 1000;
    }

    ~SomeClass() {
        int des = 80;
    }
};

int main(void){
    SomeClass* t = (SomeClass*)SomeAllocationFunction(sizeof(SomeClass));
    return 0;
} 
```

（作为说明，我知道我可以只使用`new`。但是，出于学习的目的，我正在尝试创建一个不只是调用的自定义分配器`new`or `placement new`）。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-18T02:47:15.117

本质上，当您使用类似的新表达式时`T *t = new T;`，它大致相当于：

```
void *temp = operator new(sizeof(T));
T *t = new(temp) T; 
```

因此，首先它使用分配函数分配一些原始内存，然后在该内存中构造一个对象。同样，当您使用像这样的删除表达式时`delete t;`，它大致相当于：

```
t->~T();
operator delete(t); 
```

因此，如果您重载`new`并且`delete`对于特定类：

```
class T { 
    int data; 
public:
    // I've made these static explicitly, but they'll be static even if you don't.
    static void *operator new(size_t size) { 
        return malloc(size);
    }
    static void operator delete(void *block) { 
        free(block);
    }
}; 
```

然后当你使用一个新的表达式时，它会调用类'`operator new`来分配内存，这将调用`malloc`，因此`T *t = new T();`最终将通过分配内存`malloc`（同样，当你`delete`使用它时，它会使用`operator delete`，这将调用`free`）。

至少正如通常使用的术语一样，分配器非常相似，只是它由容器而不是其他代码使用。它还将分配函数和删除函数封装在一个类中，所以当你向容器传递一个时，你只需要传递一个对象，分配和删除函数不匹配的可能性很小。

暂时忽略关于事物使用名称的细节，标准库中的 Allocator 类*大部分*都做同样的事情，所以稍微重命名`T`上面类中的函数，你大约完成了一半的编写标准分配器。为了进行分配和删除，它具有`rebind`一些内存的功能（将一块内存更改为另一种类型），就地创建一个对象（基本上只是一个放置 new 的包装器）并销毁一个对象（再次，琐碎的包装器围绕析构函数调用）。当然，它使用`operator new`and`operator delete`而不是`malloc`and`free`就像我上面使用的那样。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-18T00:53:50.177

使用placement new，您可以将已分配的内存位置传递给new 运算符。然后 new 将在给定位置构造对象而不对其自身进行分配。

编辑：

这就是它的实现方式：

```
int main(void){
    // get memory
    void * mem_t = SomeAllocationFunction(sizeof(SomeClass));
    // construct instance
    SomeClass* t = new(mem_t) SomeClass;

    // more code

    // clean up instance
    t->~SomeClass();
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T01:27:51.253

要调用构造函数，请使用placement new（请注意，您不能覆盖placement new）。对于删除和所有[问题，FAQ 很好地解释了它。](http://www.parashift.com/c++-faq-lite/dtors.html#faq-11.14)

# php - 为什么对 bindec($val) 的调用返回的结果与 hexdec(bin2hex($val)) 不同？

> ID：10201215
> 
> 赞同：0
> 
> 时间：2012-04-18T00:42:31.023
> 
> 标签：php

我有以下代码：

```
<?php
$val = fread($fp,1);
echo 'bindec: '.bindec($val)."\n";
echo 'bin2hex: '.bin2hex($val)."\n";
echo 'bin2hex/hexdec: '.hexdec(bin2hex($val))."\n";
?> 
```

正在读取的字节在我的十六进制编辑器中显示为`0F`. 我的输出如下所示：

```
bindec: 0
bin2hex: 0f
bin2hex/hexdec: 15 
```

我的问题是，为什么要`bindec`返回`0`？当然它应该返回`15`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T00:49:17.310

使用[`ord()`](http://php.net/manual/en/function.ord.php)函数而不是`bindec()`第一行。需要一个仅包含或类似“110101”`bindec()`的输入字符串。它不将“真实”二进制数据作为输入。`1``0`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T00:49:16.380

糟糕，误解了您的问题：P

Bindec 会消耗一个实际的二进制字符串，而您正在给它一个正常的数字。

# java - 从文本文件中删除行

> ID：10201218
> 
> 赞同：-5
> 
> 时间：2012-04-18T00:42:39.917
> 
> 标签：java

我有一个包含 5000 万封电子邮件的文本文件，我想创建一个程序来帮助我从该文件中删除行。

程序要求我输入一个字符串：`@gmail.com`. 然后我想删除所有包含字符串的行`@gmail.com`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T00:46:33.597

这应该适合你。

编辑：代码已删除。文字解释了每一步。

创建一个带有两个参数的方法 removeLineFromFile，第一个参数是要从中删除的文件，第二个参数是要删除的行的内容。

除了与第二个参数匹配的内容外，将创建并写入一个临时文件。

提示：使用 bufferReader 读取文件，您可以使用 PrintWriter 或 FileWriter 写入临时文件。

这种方式可以处理非常大的文件，而不需要太多的内部存储器。然后删除原始文件并将临时文件重命名为原始文件名。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T00:49:04.673

一般说明：

*   打开文件中的`Scanner`一个。`BufferedReader``FileReader`
*   打开一个`BufferedWriter`新`FileWriter`文件。
*   对于 中的每一行`Scanner`：
    *   如果行字符串不包含您的字符串
        *   写行给作家
*   关闭所有可关闭的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T01:33:12.233

```
IO readline while(....){
if(str.indexof("@gmail")){
ioHelp.deleteline(str)
}} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T00:02:21.833

非常感谢您的所有回答，嗯，这不是家庭作业......我只需要它为我自己！我知道如何用 Pascal 编程，我知道它可以做到，但问题是我有一台 64 位计算机，所以 Turbo pascal 和 Borland Pascal 都不适合我，但我的计算机中有 Eclipse，我查看了 Internet 和最接近我的情况的代码是这样的：

[http://pastebin.com/fyic6HqY](http://pastebin.com/fyic6HqY)

# ruby-on-rails - 旧版本 rails 的 rails 错误

> ID：10201223
> 
> 赞同：-1
> 
> 时间：2012-04-18T00:43:33.130
> 
> 标签：ruby-on-rails

我正在尝试像本教程那样做

```
http://www.noupe.com/ajax/create-a-simple-twitter-app.html 
```

，但是当尝试测试这个简单的导轨时，它给了我一些错误。有人知道如何解决吗？

```
< %= render :partial => "message_form" %> < %= render :partial => @posts %> 
```

![在此处输入图像描述](../Images/68c18218d08dfa1da0e8308dd74613a1.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T00:47:05.873

也许去掉 < 和 %= 之间的空间

# php - Wordpress + PHP：查询帖子以查找包含包含特定键的自定义字段数组的帖子

> ID：10201225
> 
> 赞同：2
> 
> 时间：2012-04-18T00:43:41.790
> 
> 标签：php, arrays, wordpress

我有两种帖子类型：艺术家和活动。

我通过在事件编辑器中放置所有艺术家的检查列表来关联艺术家和事件，以便多个艺术家可以与多个事件相关联。事件编辑器上的艺术家自定义字段保存为艺术家帖子 ID 的数组。

在活动页面上，我会显示每个活动的艺术家列表，其中包含以下内容：

```
 //Get Event Artists
    $postID = $post->ID;
    $meta = get_post_meta($postID, $_artistMeta->$postID, TRUE);
    $artists = unserialize($meta['_artistMeta'][0]);

    $output = array();
    foreach ($artists['artistName'] as $artist) {
        $theArtist = get_post($artist);
        $output[] = '<li><a href="'.get_permalink($theArtist->ID).'">'.$theArtist->post_title.'</a></li>';
    }

<?php if($output) { ?>
                                <div class="tw-event-artists bg1">
                                    <ul class="nav-inl group me c2 comma-list">
                                        <li class="bo"><?php echo $featured; ?>:</li>
                                        <?php echo implode('', $output); ?>
                                    </ul>
                                </div>
<?php } ?> 
```

我现在试图找到的问题是尝试“反向”。所以在我的艺术家档案中，我想找到每个艺术家的最新活动。

我需要创建一个自定义查询来查找其艺术家数组包含当前艺术家 slug 的事件帖子。

我认为[http://css-tricks.com/snippets/wordpress/custom-loop-based-on-custom-fields/](http://css-tricks.com/snippets/wordpress/custom-loop-based-on-custom-fields/)该教程是一个很好的起点，但我的 PHP 技术还不足以破解它。

如何编写这个查询来得到我想要的？

谢谢！

* * *

我目前实现这一点的方法是这样的，放置在我的艺术家存档模板的循环中，但我想这将非常缓慢且效率低下，因为它必须为每个艺术家获取每一个事件。

```
<?php 
    $artistID = $post->ID;

    $args = array(
        'eventDisplay'=> 'upcoming',
        'posts_per_page' => -1
    );  
    $events = tribe_get_events($args);

    $has_date = false;

    if ($events):
        global $post;
        foreach ($events as $post):
            setup_postdata($post);
            //Get Event Artists
            $postID = $post->ID;
            $meta = get_post_meta($postID, $_artistMeta->$postID, TRUE);
            $artists = unserialize($meta['_artistMeta'][0]);

            foreach ($artists['artistName'] as $artist) {
                if($artist == $artistID) {$has_date = true;}    
            }
        endforeach;
    endif;
?>

<?php if($has_date) {echo 'HAS DATE';} ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T02:20:00.213

一些想法...

根据您的示例，尚不清楚您是否使用 WP_Query 类来检索您的事件帖子。传递给`tribe_get_events()`函数的参数表明您只是`get_posts()`用来检索事件帖子。

我建议使用`WP_Query`. 这使您可以轻松地通过 meta_key/value 查询帖子：

```
$query_args = array( 'post_type' => 'event', 'meta_key' => '_artist_id', 'meta_value' => '5' );

$event_query = new WP_Query( $query_args );

if( $event_query->have_posts() ) {
    while( $event_query->have_posts() ) {
        $event_query->the_post();
        ...
        // standard loop stuff goes here 
```

这将仅返回`_artist_id`值为 5 的事件帖子。

有关详细信息，请参阅此页面：http: [//codex.wordpress.org/Class_Reference/WP_Query#Custom_Field_Parameters](http://codex.wordpress.org/Class_Reference/WP_Query#Custom_Field_Parameters)

需要注意的是，您不能将它与序列化的后元值一起使用。如果您想按元值查询，则需要修改存储事件/艺术家数据的方式，以将您要查询的字段分解为他们自己的单个帖子元字段。

然而，使用的一个好处`WP_Query`是，当从数据库中检索帖子时，所有相关的帖子元数据也会被提取并缓存在内存中。这意味着`get_post_meta()`从`WP_Query`循环内部调用不会产生额外的数据库查询，因为这些值存储在内存中，并且`get_post_meta()`总是首先检查那里是足够明智的。

您的问题暗示的一个更大的问题是许多人认为是 WordPress 的一个缺点——它没有提供一种防弹的内置标准化机制来将帖子与帖子相关联。

有关血腥细节，请查看此 trac 票的评论线程：http: [//core.trac.wordpress.org/ticket/14513](http://core.trac.wordpress.org/ticket/14513)

一个流行的插件，通过创建一个新的数据库表来保存多对多关系来解决这个问题： [http ://wordpress.org/extend/plugins/posts-to-posts/](http://wordpress.org/extend/plugins/posts-to-posts/)

# c# - 在列表框中的消息框中显示信息

> ID：10201226
> 
> 赞同：0
> 
> 时间：2012-04-18T00:43:44.020
> 
> 标签：c#, winforms, listbox

我正在编写一个程序，要求我从列表框中选择一个家庭地址。当我单击显示按钮时，应该会出现一个消息框并显示地址和存储在该地址的数组列表中的其他几位信息。我对列表框相当不熟悉，无法从列表框中的一个选择中弄清楚如何在消息框中显示所有这些信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T00:52:51.410

您可以在一个`ListBox`

```
string curItem = listBox1.SelectedItem.ToString(); 
```

您可以处理`onClick`您的 btn 事件，然后在消息框中显示信息

```
 MessageBox.Show (curItem ); 
```

MessageBox 的更多信息在[这里](http://www.functionx.com/vcsharp/general/messagebox.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-28T14:58:45.520

或者你可以写

```
MessageBox.Show(listBox1.SelectedItem.ToString()); 
```

如果不需要，则无需初始化任何变量

# r - 使用 ggplot2 在 R 中绘制多面数组时添加海岸线

> ID：10201227
> 
> 赞同：1
> 
> 时间：2012-04-18T00:43:46.507
> 
> 标签：r, map, ggplot2, cartography

我在下面整理了一个玩具示例。

我的问题是，我怎样才能添加海岸线（就像你可以从`maps`包裹到下面的多面图一样？

我可以使用`contour()`and来做到这一点`filled.contour()`，但我不确定`ggplot2`在使用 facet 图层时如何使用 -style 绘图来解决这个问题。当我有一个情节时，我可以毫无问题地绘制海岸。

[您可以在此处](http://www.esrl.noaa.gov/psd/thredds/fileServer/Datasets/kaplan_sst/sst.mon.anom.nc)从 NOAA 下载 netCDF 文件“sst.mon.anom.nc” （~ 10mb）。

```
library(ncdf4)
library(ggplot2)
library(reshape)

# The data is 5x5 degree reconstructed sea-surface temperature anomalies.
# Exciting stuff.
sst <- ncvar_get(nc = nc_open("sst.mon.anom.nc"),
                 varid = "sst",
                 start = c(1, 1, 1),
                 count = c(-1, -1, -1))

# Drawing out four layers from the sst array.
d1 <- melt(sst[, , 1])
d1$drought <- rep("d1", dim(d1)[1])
d3 <- melt(sst[, , 3])
d3$drought <- rep("d3", dim(d3)[1])
d5 <- melt(sst[, , 5])
d5$drought <- rep("d5", dim(d5)[1])
d6 <- melt(sst[, , 6])
d6$drought <- rep("d6", dim(d6)[1])

# Combining the layers into a single data.frame:
d <- rbind(d1, d3, d5, d6)
names(d) <- c("lon", "lat", "ERSST", "layer")

p <- ggplot(data = d, aes(x = lon, y = lat, fill = ERSST))
print(p + geom_tile() + 
      scale_fill_gradient2(high = "red", low = "blue") + 
      facet_wrap(~ layer) ) 
```

![上述脚本的输出](../Images/91066cfce8ccdedc201e95915bb13364.png)

非常感谢！

PS 另外，我刚刚注意到颜色图例的顺序是颠倒的。唔...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T07:40:48.737

其美妙之`ggplot2`处在于无需对每个方面执行特定操作。只需添加一个`geom_path`with 作为`data`包含海岸线的 data.frame 将在所有方面绘制它。有关使用包中的多边形集的示例，请参阅[文档`coord_map`](http://had.co.nz/ggplot2/coord_map.html)。请注意，当且仅当您的网格数据和多边形/折线数据位于同一投影中时，这将起作用。通过支持开箱即用的坐标变换。或者，您可以在将数据提供给 ggplot2 之前使用包中的执行坐标转换（我倾向于这样做）。`geom_path``maps``coord_map` `ggplot2``spTransform``rgdal`

# arrays - 将元胞数组的每个元胞中的第一个值替换为另一个元胞数组中的值 MATLAB

> ID：10201228
> 
> 赞同：1
> 
> 时间：2012-04-18T00:43:52.493
> 
> 标签：arrays, matlab, image-processing, watermark

我有一个包含一组矩阵的特征值的单元格数组。我已经从这个数组中的每个单元格中删除了第一个值，并将它们放在一个矩阵中。然后通过基于水印图像的一组阈值来操纵这些值。然后，我将值矩阵重新转换为元胞数组。我现在想将这些新单元格中的值放入旧数组中单元格的相应第一个位置。关于如何做到这一点的任何想法？我见过很多基于规则进行搜索和替换的方法，但没有一个只是简单地进行一对一替换。我只是希望这是可能的。

功能代码如下：（最后一行有问题）

```
 function D = fun(D,W)
    Q = 5;
    [i,j] = size(D)
    F = cellfun(@(c) c(1), D); % grab the first value from each cell
    disp(F); % Debug check
    for a = 1:i % Process the values
       for b = 1:j
       Z = mod(F(a,b),Q); 
         if W(a,b) == 0
             if Z<(3*Q)/4;
                F(a,b) = F(a,b)+Q/4-Z;
             else
                F(a,b) = F(a,b)+5*Q/4-Z;
             end 
         else 
             if Z<Q/4;
                F(a,b) = F(a,b)-Q/4+Z;
             else
                F(a,b) = F(a,b)+3*Q/4-Z;
             end
         end
      end
   end
   disp(F); % Debug check
   F = num2cell(F); % Make the new cell array
   disp(F); % Debug Check
   D{1,1} = cellfun(@(F) F{1,1}, F);    % No clue what to do here
   end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T14:12:11.097

在我看来，您想要实现的最简单的解决方案如下：

```
 function D = fun(D,W)
    Q = 5;
    [i,j] = size(D)
    F = cellfun(@(c) c(1), D); % grab the first value from each cell
    disp(F); % Debug check
    for a = 1:i % Process the values
       for b = 1:j
       Z = mod(F(a,b),Q); 
         if W(a,b) == 0
             if Z<(3*Q)/4;
                F(a,b) = F(a,b)+Q/4-Z;
             else
                F(a,b) = F(a,b)+5*Q/4-Z;
             end 
         else 
             if Z<Q/4;
                F(a,b) = F(a,b)-Q/4+Z;
             else
                F(a,b) = F(a,b)+3*Q/4-Z;
             end
         end
         D{a,b}(1) = F(a,b)
      end
   end

   end 
```

所以我所做的只是将 F(a,b) 的值分配给 D{a,b} 的第一个元素，在你操作 F 的循环中 - 你可以这样做，因为 F 的元素无论如何都是独立的。无论如何，使用 matlab 内置函数`cellfun`并不总是比显式循环快。希望这可以帮助。

# php - mysql_result() 期望参数 1 是资源，布尔值给定错误

> ID：10201232
> 
> 赞同：-2
> 
> 时间：2012-04-18T00:44:15.767
> 
> 标签：php, mysql

> **可能重复：**
> [mysql_fetch_array() 期望参数 1 是资源，选择中给出的布尔值](https://stackoverflow.com/questions/2973202/mysql-fetch-array-expects-parameter-1-to-be-resource-boolean-given-in-select)

我的 SQL 查询如下。它在我的本地主机上运行良好，但是当我上传到我的 linux 服务器时出现上述错误。怎么了？

这适用于我的本地主机，那么为什么它不能在我的服务器上运行？是文件路径错误吗？MySQL 数据库是相同的，我有一个特定的服务器连接文件，与本地主机不同。我的其他数据库查询正在工作。

这不是 $id 变量的问题，因为我尝试通过将其替换为 1 来测试它，并且我的错误消息是相同的。

与数据库的连接也不是问题。此文件有许多其他正常工作的查询。

```
 return (mysql_result(mysql_query("SELECT COUNT('id') FROM POSTS WHERE id=$id"),0)==0)?false:true;// this query works. because it doesnt have '' on the words posts/id 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T01:16:51.057

错误检查是一件很棒的事情：

```
function getResult() 
{
   try {
      $q = mysql_query( ... );

      if ($q === FALSE)
         throw new Exception(mysql_error(), mysql_errno());

      // Do stuff with the query results here.
   } catch(Exception $e) {
      // Do the error handling here
      //   Message is kept in $e->getMessage();
      //   MySQL specific error code is in $e->getCode();
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T09:31:25.873

对此的解决方案是查询正在搜索 POST 表。而不是 post 表。

表名在我的服务器上显然区分大小写，但在 localhost 上不区分大小写。

# objective-c - 适合 NSDictionary 的键

> ID：10201233
> 
> 赞同：13
> 
> 时间：2012-04-18T00:44:17.123
> 
> 标签：objective-c, ios, macos, cocoa-touch, cocoa

有没有办法确定一个类是否适合作为键并且可以按预期工作，例如我想使用**NSIndexPath**作为**NSDictionary**中的键，但我不确定两个不同的**NSIndexPath**实例是否具有相同的整数values 将始终返回相同的哈希值。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-18T01:51:44.523

苹果的 NSObject 的 isEqual 文件说：

> 如果两个对象相等，则它们必须具有相同的哈希值。如果您在子类中定义 isEqual: 并打算将该子类的实例放入集合中，那么最后一点尤其重要。确保您还在子类中定义哈希。

看下面的代码：

```
NSIndexPath *indexPath1 = [NSIndexPath indexPathForRow:0 inSection:0];

NSIndexPath *indexPath2 = [NSIndexPath indexPathForRow:0 inSection:0];

NSObject *obj1 = [[NSObject alloc] init];
NSObject *obj2 = [[NSObject alloc] init];

NSLog(@"NSIndexPath isEqual's Result: %d", [indexPath1 isEqual:indexPath2]);
NSLog(@"NSObject isEqual's Result: %d", [obj1 isEqual:obj2]); 
```

输出结果：

> NSIndexPath isEqual 的结果：1
> 
> NSObject isEqual 的结果：0

**NSObject isEqual**的实现 是comare两个对象的地址，hash实现是返回对象的地址。

**NSIndexPath**继承自**NSObject**，根据 NSIndexPath isEqual 输出结果，NSIndexPath 的 isEqual 实现应该覆盖超类的 isEqual 方法，NSIndexPath 也覆盖超类的 hash 方法。

另外，NSIndexPath 也符合 NSCopying 协议。

所以 NSIndexPath 可以作为 NSDictionary 的 Key 类。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-18T00:59:21.387

对象如何作为键取决于它如何实现 isEqual:。这将确定两个键是否碰撞。

例如，当路径具有相同的索引集时，索引路径是相等的 - 因此会发生冲突。所以描述相同路径的两个不同对象将被字典视为相同的键......可能是您希望的样子。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-18T01:15:34.567

NSDictionary 键有三个要求：

1.  支持 NSCopying 协议
2.  合理的-hash方法
3.  是平等的

NSIndexPath 应该没问题。

# ruby-on-rails-3 - 州和城市模型之间的关联

> ID：10201235
> 
> 赞同：0
> 
> 时间：2012-04-18T00:44:38.950
> 
> 标签：ruby-on-rails-3, model-associations

希望创建一个可以先按州然后按城市排序的业务目录（类似于 Craigslist）。

我应该分别创建州模型和城市模型，还是创建一个将州和城市作为位置表中单独列的位置模型？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T00:58:28.043

我会选择 2 列：`state`和`city`.

为了去像：

`Collection.order('state ASC')`或者 `Collection.order('city ASC')`

之后取决于你想要的东西有多复杂。

# java - Java获取关键监听器来监听帧

> ID：10201236
> 
> 赞同：0
> 
> 时间：2012-04-18T00:44:44.893
> 
> 标签：java, awt, keylistener

主班

```
public class Main {
    public static void main(String[] args) {
        new Display("Graphic Window","icon.gif",800,600,true,false,2,60);
    }
} 
```

显示类的顶部

```
public class Display extends Frame { 
```

键盘类

```
public class Keyboard implements KeyListener {

//.addKeyListener();
public void keyPressed(KeyEvent key) {
    System.out.println("Pressed "+key);
}

public void keyReleased(KeyEvent key) {
    System.out.println("Released "+key);
}

public void keyTyped(KeyEvent key) {
    System.out.println("Typed "+key);
}
} 
```

我不知道如何让键监听器来监听框架，因为我想让键盘成为它自己的类，然后让另一个类获取正在按下的键并根据它执行诸如移动之类的动作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T02:02:32.660

尝试：

```
new Display(.....).addKeyListener(new Keyboard); 
```

# jquery-plugins - 如何使用 jquery lazyload 插件获得正确的图像宽度？

> ID：10201246
> 
> 赞同：0
> 
> 时间：2012-04-18T00:46:25.347
> 
> 标签：jquery-plugins, lazy-loading

在延迟加载中，您可以像这样放置图像：

```
<img data-original=“img/example.jpg” src=“img/loader.gif”&gt; 
```

所以当我使用： `$(selector).width()`

我得到加载器图像的宽度，而不是我将加载的图像的宽度。我也找不到插件上的任何回调。

有谁知道如何解决这个问题？

谢谢您的帮助

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-18T11:33:25.727

我不知道是否有更好的解决方案，但我现在所做的是使用 display:none 样式加载原始图像，然后我从那里得到宽度。

# javascript - 谷歌地图不显示

> ID：10201250
> 
> 赞同：3
> 
> 时间：2012-04-18T00:46:51.553
> 
> 标签：javascript, html, google-maps, google-maps-api-3

我试图在我的网站上放置一个谷歌地图，但它不起作用。这是我拥有的代码。谁能告诉我我做错了什么。谢谢

```
<head>
<title>Environment Impact</title>
<link rel="stylesheet" href="style.css" type="text/css">
<script>src="http://maps.googleapis.com/maps/api/js?key=MY_API_KEY=TRUE"></script>

 <script type="text/javascript">
  function initialize() {
          var california = new google.maps.LatLng(-122.23354, 37.48787);
          var myOptions = {
            center: california,
            zoom: 8,
            mapTypeId: google.maps.MapTypeId.ROADMAP
          };
          var map = new google.maps.Map(document.getElementById("map-canvas"), myOptions);
        }
</script>
 </head>
 <body onload="initialize()">
    <div id="map-canvas" style="width:800px; height:600px; border:1px solid #000;"></div>
 </body> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T00:50:12.540

您有错误的格式和可能错误的参数：

```
<script>src="http://maps.googleapis.com/maps/api/js?key=MY_API_KEY=TRUE"></script> 
```

应该是这样的：

```
<script src="http://maps.googleapis.com/maps/api/js?key=MY_API_KEY&sensor=TRUE"></script> 
```

确保`MY_API_KEY`替换为您的 Google Map API 密钥，或者如果您不需要它，则直接忽略此参数。不确定你想要`sensor`to `TRUE`，我只是猜到了，因为你有一个孤儿`=TRUE`参数

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T00:49:35.037

您的脚本行应该是

`<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>`

`california`也不是一个有效的中心，你需要一个像这样的 latLng ：

`center: new google.maps.LatLng(37.19533058280067, -120.234375),`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-18T00:49:38.743

错误的

```
<script>src="http://maps.googleapis.com/maps/api/js?key=MY_API_KEY=TRUE"></script> 
```

对

```
<script src="http://maps.googleapis.com/maps/api/js?key=MY_API_KEY&sensor=true"></script> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T00:50:48.337

```
<script>src="http://maps.googleapis.com/maps/api/js?key=MY_API_KEY=TRUE"></script> 
```

这根本不对

```
<script src="http://maps.googleapis.com/maps/api/js?key=MY_API_KEY&sensor=false"></script> 
```

会更接近，如果这是问题的话

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-28T06:09:11.080

是的，脚本标签需要是

```
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script> 
```

并设置 sensor=false

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-13T18:26:05.463

顺便说一句，`sensor`Url 中的参数必须根据应用设置为 true 或 false。如果该应用程序使用诸如 GPS 发射器之类的传感器来查找用户位置，则它是`true`. 更多信息[在这里](https://developers.google.com/maps/documentation/javascript/tutorial?hl=de)

[仅当网站/应用程序还没有Google](https://developers.google.com/console/help/?hl=de#UsingKeys) oauth 访问令牌并且不会导致对用户进行任何验证而不是 oauth 令牌时，才需要将密钥作为参数。

# java - 使用递归查找斐波那契数列中的数字

> ID：10201253
> 
> 赞同：2
> 
> 时间：2012-04-18T00:47:15.523
> 
> 标签：java, fibonacci

基本上，我正在寻找一个程序，它会给我序列但最多一定数量。所以假设我想上升到第 20 个数字或其他数字。我想知道如何递归地迭代它，以便它只需使用`if()`语句就可以找到序列中每个数字的值，直到该数字。我没有任何代码，因为我只知道如何使用`for`循环来完成，这不是我需要的方法。

我至少知道这一点：

```
if n = 1 || n = 0
   return n;
else 
    return F(n-1) + F(n-2); 
```

代码：

```
class Fibonocci {

    public static int factorial(int i,int n) { 
        System.out.println(i);

        if(i==n || n==0 || n==1) {  // base case;  when i = n, we're done.
            return n; 
        } else {
            return i + 1 + factorial(i+2,n); // iterative case; we're still adding values up.
        }
    }

    public static void main(String[] args)
    {
        Fibonocci test= new Fibonocci();
        System.out.println( test.factorial(0,10) );
    }
} 
```

我一直在尝试那个和一大堆其他尝试，但我仍然很难过。我知道它去`0 1 1 2 3 5 8 13 21 34...`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T01:01:23.837

你会感到惊讶，但你的代码几乎就在那里。我的感觉是你对递归还不满意。

## 你可以迭代地做的任何事情都可以递归地做。

可以这样想：一个循环（for、while、do-while）有一个迭代步骤，以及一个检查它是否完成的条件。例如，如果我将 1 到 n 的所有数字相加：

```
int sum = 0;
for(int i = 1; i <= n; i++) { // Condition to check completion
    sum += i;  // iterative step
} 
```

要将其转换为递归函数，我需要一个完成条件（称为**基本案例**）和一个迭代步骤或**迭代案例**。总而言之，我的基本情况是 when `i==n`。

```
public int sum(int i, int n) {
    if(i == n) {  // base case;  when i = n, we're done.
        return n; 
    } else {
        return i + sum(i+1, n); // iterative case; we're still adding values up.
    }
} 
```

将此应用于您的斐波那契方法，我认为您会没事的。不，真的，用适当的参数将它包装在一个函数调用中，你会没事的。

* * *

## 进一步澄清：电话是如何扩大的？

回到求和方法，假设我想对 1 到 10 之间的数字求和。调用是如何扩展的？

### 迭代地

真的，调用堆栈上没什么用。它正在经历一个循环。但是，我们可以综合每次通过时发生的事情。

```
int sum = 0;
for(int i = 1; i <= 10; i++) {
    sum += i;
} 
```

通过循环看起来像这样：

```
Cycle #1: sum=1
Cycle #2: sum=3
Cycle #3: sum=6
Cycle #4: sum=10
Cycle #5: sum=15
Cycle #6: sum=21
Cycle #7: sum=28
Cycle #8: sum=36
Cycle #9: sum=45
Cycle #10: sum=55
Sum = 55 
```

到目前为止似乎是对的。

我们只是每次取**一个元素并将其添加到一个集体总和值中。**本质上，1+2+3+4+5+6+7+8+9+10 被分解为以下方式：

```
sum += 1 // 1 now
sum += 2 // 3 now
sum += 3 // 6 now
...
sum += 10 // 55 now 
```

递归地，值的收集方式没有任何区别，但它的完成方式略有不同。

### 递归

检查对此的调用：

```
public int sum(int i, int n) {
    return n == i ? n : i + sum(i+1, n); // ternary if-else statement, the exact same as the if-else in the above sum method.
}

1 + sum(2, 10)
1 + 2 + sum(3, 10)
1 + 2 + 3 + sum(4, 10)
1 + 2 + 3 + 4 + sum(5, 10)
1 + 2 + 3 + 4 + 5 + sum(6, 10)
1 + 2 + 3 + 4 + 5 + 6 + sum(7, 10)
1 + 2 + 3 + 4 + 5 + 6 + 7 + sum(8, 10)
1 + 2 + 3 + 4 + 5 + 6 + 7 + 8 + sum(9, 10)
1 + 2 + 3 + 4 + 5 + 6 + 7 + 8 + 9 + sum(10, 10)
1 + 2 + 3 + 4 + 5 + 6 + 7 + 8 + 9 + 10
55 
```

本质上，它在递归调用中的作用与在串行调用中的作用相同。扩展有点有趣，但是一旦你习惯了它，它就不会是一个挑战。

从这里开始，我强烈建议您尝试一下。不要害怕尝试；此处提供的信息足以让您入门。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T00:56:40.940

让我通过编写递归阶乘函数来帮助您：

阶乘方法定义为：

```
 if n == 0 || n == 1 return 1; else return n * F(n - 1); 
```

可以用Java编写为：

```
public int factorial(int n) { 
   if(n == 0 || n == 1) { 
       return 1;
   } else { 
       return n * factorial(n - 1);
   }
} 
```

因此，鉴于您所知道的，我认为这足以让您适应和测试斐波那契数列。

# c# - 在 UnitOfWork 中存储对通用存储库的引用

> ID：10201254
> 
> 赞同：4
> 
> 时间：2012-04-18T00:47:17.280
> 
> 标签：c#, entity-framework, unit-of-work

我正在使用以下**UnitOfWork**类，以便通过使用泛型获取我的实体的存储库。

```
public class UnitOfWork : IUnitOfWork
{
  private readonly EfDbContext _context;

  public UnitOfWork()
  {
    _context = new EfDbContext();
  }

  public IRepository<T> RepositoryFor<T>() where T : Entity
  {
    return new Repository<T>(_context);
  }

  public void Save()
  {
    _context.SaveChanges();
  }
} 
```

但是，我遇到了一些问题，我有两个单独的类为单个实体独立地实例化 UnitOfWork，这意味着为该实体创建了两个存储库。当我尝试保存实体时， 这会导致实体框架抛出“**一个实体对象不能被多个 IEntityChangeTracker 实例引用”错误的问题。**

我认为我需要更密切地遵循**[Tom Dykstra](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net-mvc-application)**在“创建工作单元类”部分下的这篇文章中描述的 UOW 模式，其中存储库存储在私有字段中，如果存在则重用，如果为空则创建。我遇到的问题是我希望我的 UOW 继续使用泛型 -`Repository<T>`而不必为我在代码中拥有的所有实体类型声明私有存储库字段。

我如何能够存储给定类型的存储库已经实例化的事实并重新使用它而不是创建它的新实例？

**---编辑：这是修复---**

使用 Ninject，我调整了我的绑定，通过指定仅实例化存储库和 UOW 的单个实例`InRequestScope`

```
kernel.Bind(typeof(IRepository<>)).To(typeof(Repository<>)).InRequestScope();
//kernel.Bind<IUnitOfWork>().To<UnitOfWork>().InRequestScope(); // Removed based on comment below
kernel.Bind(typeof(EfDbContext)).ToSelf().InRequestScope(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T04:02:20.500

问题不在多个存储库中，而是在多个`DbContext`实例中。EF 告诉您不能一次将同一个实体实例添加到多个上下文中。因此共享存储库无济于事。此外，拥有多个 UoW 共享单例存储库是通往地狱的道路。处理并发（EF 不是线程安全的）、状态等将非常困难。

要解决此问题，您应该执行以下任一操作：

1.  共享工作单元，以便您`DbContext`在单个业务操作中使用相同的 UoW（和）实例
2.  在将实体实例添加到另一个 UoW 之前创建它们的副本。

选择取决于您的具体情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-02-28T18:07:05.820

你觉得这个解决方案怎么样？

```
public class UnitOfWork
    {
        private IRepository<Animal> _animalRepository;
        public IRepository<Animal> Animals => _animalRepository ??= new Repository<Animal>();

        public IRepository<T> Repository<T>()
        {
            var result = GetType()
                .GetProperties()
                .FirstOrDefault(r => typeof(IRepository<T>) == r.PropertyType)?
                .GetValue(this, null);

            return (IRepository<T>)result;
        }
    } 
```

# django - Django：如何测试自定义请求属性？

> ID：10201256
> 
> 赞同：2
> 
> 时间：2012-04-18T00:47:30.820
> 
> 标签：django

我有一个 django 应用程序，它使用自定义中间件模块在所有请求中创建子域属性。该属性被分配了一个字符串。在系统测试期间一切正常，但我想对此属性运行自动化测试，所以我的问题是：

在单元测试期间生成请求时，如何将 request.subdomain 设置为字符串值以便测试代码？我是否需要创建自定义请求，然后将其提供给测试客户端？谢谢你的时间。

## 解决方案如下

自定义中间件读取 HTTP_HOST 字符串并将子域保存在属性 request.subdomain 中。我的问题是如何在单元测试期间将子域请求喷射到客户端。就是这样：

测试客户端对象允许您在 request.META 字典中预设任何键：值对。运行测试时，如果要将主机名设置为子域，请执行以下操作：

```
host = 'subdomain1.test.com:8000' 
c = Client(HTTP_HOST=host)
response = c.get(path='/home') 
```

并且测试将像有人`subdomain1.test.com:8000/home`在浏览器中键入一样执行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T03:31:46.083

所有中间件在测试期间正常工作。因此，您可以测试整个视图（并检查它是否返回特定于您的请求的内容） - 这是功能测试。或者您可以创建一个`MockRequest`并将其直接传递给您的中间件`process_request`- 它是单元测试。实际上，我会同时使用两者。

# xcode - 基于 UITableView 单元格/条目数的图标徽章

> ID：10201258
> 
> 赞同：0
> 
> 时间：2012-04-18T00:48:02.847
> 
> 标签：xcode, uitableview, cells, badge, viewwillappear

我正在使用 Core Data 和 UITableView 开发一个 Todo 风格的应用程序。我希望主屏幕上的应用程序图标显示 TableView 中条目数的徽章，但我遇到了问题。当我添加一个新单元格时，它会更新得很好。徽章与 TableView 中的单元格数量相匹配，但是当我删除一个单元格时，徽章上的数字不会减少。有谁知道当我删除一个单元格时我可以做些什么来更新徽章，而不仅仅是添加一个？帮助将**不胜感激。**

这是我当前的代码：

```
NSInteger section = [self.tableView numberOfSections] - 1;
id <NSFetchedResultsSectionInfo> sectionInfo = [[self.fetchedResultsController sections]      objectAtIndex:section];
[[UIApplication sharedApplication] setApplicationIconBadgeNumber:[sectionInfo numberOfObjects]]; 
```

我在 [super viewWillAppear:animated] 下的 ViewWillAppear 中有它；那是放置它的正确位置吗？

**提前感谢任何可以帮助我的人！**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T00:54:32.267

在您的部分中创建一个项目数组，然后将其用作徽章编号。

```
[[UIApplication sharedApplication] setApplicationIconBadgeNumber:[myArray count]]; 
```

# android - (SensorManager)getSystemService(SENSOR_SERVICE) 在预发布的 Android 设备上崩溃

> ID：10201260
> 
> 赞同：1
> 
> 时间：2012-04-18T00:48:09.103
> 
> 标签：android, sensormanager

正如标题所说，

```
mSensorManager = (SensorManager)getSystemService(SENSOR_SERVICE); 
```

在预发布的 Android 平板电脑上崩溃。SENSOR_SERVICE 被定义为“传感器”，在其他方面看起来不错。预发布设备非常接近发布，fwtw。

我想知道 /system/etc/permissions 中是否有一些权限文件可能丢失，或者我是否需要在清单中指定一些使用权限值或???

我将在另一台（华硕）平板电脑上运行测试应用程序以帮助隔离问题。但欢迎任何有用的见解。

# php - 需要澄清 __VIEWSTATE __EVENTVALIDATION __EVENTTARGET ， __EVENTARGUMENT

> ID：10201264
> 
> 赞同：2
> 
> 时间：2012-04-18T00:48:42.837
> 
> 标签：php, asp.net, curl

我正在尝试使用[cURL成功](http://en.wikipedia.org/wiki/CURL)[POST](http://en.wikipedia.org/wiki/POST_%28HTTP%29)到 ASPX ( [ASP.NET](http://en.wikipedia.org/wiki/ASP.NET) ) 页面（外部站点）。

因为我不太关心页面的外观（这一切都在服务器端完成），所以我没有发送任何参数 `__VIEWSTATE`、`__EVENTVALIDATION`、`__EVENTTARGET`和`__EVENTARGUMENT`，甚至不是空的，但我确实发送了真实数据。

将这些参数发布到 ASP.NET 服务器有多重要？

我不是 ASP.NET 程序员，但我可能怀疑这`__EVENTVALIDATION`可能会给我带来一些困难（？）。或者这是浏览器和服务器之间我不需要太关心的东西？

如果这很关键，我如何模仿这些变量以便服务器接受 POSTS？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T01:22:56.263

通常，您无法消除这些值。

**ViewState 和 EventValidation 很关键**——除非对方禁用了它们。如果对方使用它们并且在回发时没有找到它们，则会出现抛出错误，这取决于程序如何处理它。

ViewState 包含回发后页面需要使用的信息。

EventValidation 包含一个验证回发控件的键，以确保您不会尝试触发任何没有权限的命令，或发送任何没有运行权限的参数。

让我们举个例子：假设我有一个发送数字 43 的控件和一个触发回发的按钮，我询问 id 43 的信息。EventValidation 会注意您不能编写脚本并询问对于具有任何 id 的所有数字，并获得您可能认为的任何结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-13T11:54:29.370

有可能的。只是没有[cURL](http://en.wikipedia.org/wiki/CURL)。

最好的方法是使用浏览器模拟器，例如[Python](http://en.wikipedia.org/wiki/Python_%28programming_language%29)中的*mechanize*。这是一个示例脚本。试一试。您始终可以使用命令行调用此脚本并让它返回结果[HTML](http://en.wikipedia.org/wiki/HTML)。

```
import mechanize
import cookielib

# Browser
br = mechanize.Browser()

# Cookie Jar
cj = cookielib.LWPCookieJar()
br.set_cookiejar(cj)

# Browser options
br.set_handle_equiv(True)
br.set_handle_gzip(True)
br.set_handle_redirect(True)
br.set_handle_referer(True)
br.set_handle_robots(False)

# Follows refresh 0, but it does not hang on refresh > 0
br.set_handle_refresh(mechanize._http.HTTPRefreshProcessor(), max_time=1)

# Want debugging messages?
#br.set_debug_http(True)
#br.set_debug_redirects(True)
#br.set_debug_responses(True)

# User-Agent (this is cheating, OK?)
br.addheaders = [('User-agent', 'Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.1) Gecko/2008071615 Fedora/3.0.1-1.fc9 Firefox/3.0.1')]

# Open some site, let's pick a random one, the first that pops in mind:
r = br.open('http://www.example.com/')
html = r.read()

# Show the source
print html
# or
print br.response().read()

# Show the HTML title
print br.title()

# Show the response headers
print r.info()
# or
print br.response().info()

# Show the available forms
for f in br.forms():
    print f

# Select the first (index zero) form
br.select_form(nr=0)

# Let's search
br.form['field']='value'
br.submit()

# Show HTML of results
print br.response().read() 
```

# jquery - 是否可以在不指定每一行的类的情况下全局文本对齐表格列？

> ID：10201267
> 
> 赞同：5
> 
> 时间：2012-04-18T00:48:49.950
> 
> 标签：jquery, css

想知道提高效率的最佳方法是什么，也许是 jQuery。我可以接受不符合 ie7 的解决方案，如果需要，即使不支持 ie8 也可以。

```
<style type="text/css">
.cal {text-align:center}
.ral {text-align:right}
</style>
<table>
 <th>
  <td class="cal">center</td>
  <td>left</td>
  <td class="cal">center</td>
  <td>left</td>
  <td class="ral">right</td>
 </th>
 <tr>
  <td class="cal">center</td>
  <td>left</td>
  <td class="cal">center</td>
  <td>left</td>
  <td class="ral">right</td>
 </tr>
 <tr>
  <td class="cal">center</td>
  <td>left</td>
  <td class="cal">center</td>
  <td>left</td>
  <td class="ral">right</td>
 </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T00:54:12.413

您可以使用 jQuery 在每行的第五个 td 中添加一个类，并设置该类的样式以使文本向右对齐。

或者（以及我这样做的方式）是使用第[n 个子选择器](https://developer.mozilla.org/en/CSS/%3anth-child)。

```
tr td:nth-child(odd) {
    text-align: center;
}

tr td:nth-child(5) {
    text-align: right;
} 
```

它与 IE 8.0 不兼容，但它比基于 JavaScript 的解决方案简单得多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T00:53:56.970

这行得通吗？

```
table td { text-align: center; }
table td:last-child { text-align: right; } 
```

不幸的是，IE8 不支持此功能。另一种选择是使用 JavaScript（例如 jQuery，因为你已经用它标记了这篇文章）：

```
$(function(){ $('table tr').each(function(){ $('td:last', this).css({textAlign: 'right'}); } )} 
```

这个问题似乎得到了很好的接受，尽管它是你能得到的最丑陋的黑客：[使用 css 为表格中的最后一个 td 设置样式](https://stackoverflow.com/questions/359821/styling-the-last-td-in-a-table-with-css)

最后，您可以稍微作弊，将最后一列的单元格作为一个`<th>`元素，然后使用以下命令轻松设置样式：

```
table th { text-align: right; } 
```

它不一定在语义上是正确的，但它是另一种快速简便的选择。我假设`<th>`您原始帖子中的现有元素是拼写错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-26T18:39:45.580

```
$('td:first-child').css('text-align', 'left');
$('td:nth-child(2)').css('text-align', 'center');
$('td:last-child').css('text-align', 'right'); 
```

有关其他过滤器，请参阅[http://api.jquery.com/category/selectors/child-filter-selectors/](http://api.jquery.com/category/selectors/child-filter-selectors/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-18T06:26:06.047

```
<style>
td:first-child, td:first-child + td + td {
  text-align: center;
}
td:first-child + td + td + td + td {
  text-align: right;
}
</style>
<table>
<col align=center>
<col align=left>
<col align=center>
<col align=left>
<col align=right> 
```

样式表适用于相当新的浏览器。我省略了将对齐设置为左的规则，因为这是 的默认设置`td`，但如果其他样式表可能影响对齐，您可能需要添加此类规则。

标签充当备份：根据`col`规范，它们使用的方法不应该工作，但实际上适用于旧版本的 IE（以及在 Quirks 模式下的较新版本）。

# c# - 对字典进行排序 , 具有多个级别

> ID：10201271
> 
> 赞同：1
> 
> 时间：2012-04-18T00:49:08.950
> 
> 标签：c#, linq, dictionary, lambda

这个问题是基于以前的帖子[https://stackoverflow.com/a/8425200/737076](https://stackoverflow.com/a/8425200/737076)

问题是您将如何对创建后的 Dictionary 及其所有子项和子项的子项进行排序。

我正在考虑一个比较器，但想得到一些建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T01:08:28.567

您正在寻找实现为二叉搜索树而不是哈希图的[SortedDictionary 。](http://msdn.microsoft.com/en-us/library/f7fta44c.aspx)除了以与上一个问题相同的方式实现它之外，您还需要提供一个比较器来描述如何对您的集合进行排序。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-18T00:55:46.063

无法对字典进行排序。没有像列表或数组那样的索引顺序。但是，您可以获取字典的键并对键进行排序。

```
List<string> dictionaryKeys = new List<string>(dict.Keys);
dictionaryKeys.Sort(); 
```

然后遍历列表，按顺序检索值。

```
for (i = 0; i < dictionaryKeys.Count; i++)
{
    string key = dictionaryKeys[i];
    string value = dict[key];
} 
```

这将是一种模拟的字典。

在具有多个级别的字典的情况下，您必须遍历所有级别并使用某种逻辑来执行此操作。

但是，如果您的目标是排序字典，我相信有更好的方法来存储您的信息，也许是`List<class_you_created_to_hold_all_the_information>`:)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-18T01:37:22.033

使用 `SortedDictionary`类。

# php - PHP Curl 上传图片，在 IIS 7 上，图片未完全上传

> ID：10201274
> 
> 赞同：1
> 
> 时间：2012-04-18T00:49:20.897
> 
> 标签：php, rest, iis-7, curl, image-uploading

我有一个包含文件上传的 html 表单。发送表单后，我用 curl 重新发送。我的 REST API 收到请求，当我检查`$_FILES['image']['error']`它时给了我 3，即“仅上传了部分文件”。在 REST 服务之前，我曾经在我的网站上上传图片，没有任何问题。

显然我在 localhost 上测试了它，但我使用的是 apache，它工作得很好。

现在我在 IIS 7 上。我检查了 iis 的 curl 库，并且请求发送没有问题......

正在寻找 IIS 配置或代码来解决此问题...

```
$header = array("Content-type: multipart/form-data");

$tmpfile = $_FILES['image']['tmp_name'];
$filename = basename($_FILES['image']['name']);
$type = $_FILES['image']['type'];
$size = $_FILES['image']['size'];

$data = array(
            'image' => '@' . $tmpfile . ';filename='.$filename.';type='.$type.';size='.$size.';' );

 curl_setopt($ch,CURLOPT_HTTPHEADER,$header);
 curl_setopt($ch, CURLOPT_POST, 1);  

 curl_setopt($ch, CURLOPT_POSTFIELDS, $data); 
 $this->doExecute($ch); 
```

编辑：似乎不是文件太大的问题，无法上传 600 字节的 jpg

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T12:43:24.950

知道了 ！所以这是一个文件夹权限问题。由于某些未知原因，文件上传在服务实施之前工作正常......

所以我编辑了默认上传文件夹 C:\Windows\Temp 并为 iis_iusrs 添加了完全控制权限。

谢谢

# wcf - 工作流服务作为 WCF 服务上的服务参考

> ID：10201275
> 
> 赞同：0
> 
> 时间：2012-04-18T00:49:23.710
> 
> 标签：wcf, workflow-foundation-4, workflowservice

我添加了工作流服务作为对 wcf 服务的引用，它使用客户端端点创建了 web.config 文件。在创建代理对象时遇到问题。它无法识别合同并抛出错误 -

在 ServiceModel 客户端配置部分中找不到引用合同“servicerefname.interfacename”的默认端点元素。这可能是因为没有为您的应用程序找到配置文件，或者因为在客户端元素中找不到与此合同匹配的端点元素。

我检查了reference.cs 文件和配置，一切看起来都很好。有人可以将我重定向到 WCF 引用工作流服务的示例吗？

注意 - 它在 .Net 4.0 中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T22:00:35.447

确保调用项目中有 web.config。例如，如果您添加了对名为 MyGateway.proj 的项目的服务引用。然后你就有了一个使用 MayGatway.proj 中的类的网站。如果是 wbesite 调用网关，网关又调用 web 服务 - 重要的是 web.config 设置应用于网站。

# ajax - Atom 到 JSONP 的转换问题

> ID：10201282
> 
> 赞同：1
> 
> 时间：2012-04-18T00:50:10.180
> 
> 标签：ajax, cross-domain, jsonp, feed, atom-feed

因此，我正在开发一个存在于另一台服务器上的新闻提要以及该提要描述的静态 PDF 文档。

我正在尝试实现仅客户端的提要解析，因为我不确定后端服务器的功能是什么。

作为一种快捷的解决方法，我使用[Blastcasta.com将 Atom 提要解析为 JSON](http://www.blastcasta.com/convert-feed-to-json.aspx)

```
url = "http://www.blastcasta.com/feed-to-json.aspx?feedurl=http://[atomLocation]/newsletter.atom"

data = {}
$.ajax({
  url: url + "?callback=?",
  dataType: "jsonp",
  data: data,
  success: function(data) { onSuccess(data); },
  error: function() { alert('Failed to parse feed'); },
}); 
```

如果我将 dataType 设置为“application/json”，我会收到一个跨源错误。如果我将它设置为“jsonp”，我会得到“语法错误：意外令牌：”。

据我了解， jsonp 是 json 包装在一个函数或类似的东西中。

是否有合理的解决方法，或者我将不得不“接受它”并开发服务器端 atom-to-jsonp 服务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T01:21:56.000

该服务返回 JSON 或类似的东西：

```
variable = {...} 
```

如果`param`设置了 url 参数，但没有设置 JSON-P :(

使用`dataType: "jsonp"`不能工作，`dataType: "json"`也不能工作，因为该服务不允许跨域 ajax 请求（因为没有设置 Access-Control-Allow-Origin 标头 -> 请参阅：[CORS](https://developer.mozilla.org/en/http_access_control)）

一种解决方法是插入这样的`<script>`标签：

```
<script type="text/javascript" src="http://www.blastcasta.com/feed-to-json.aspx?feedurl=<your url here>&param=myVariable"></script> 
```

然后`myVariable`包含返回的对象。

示例演示：http: [//jsfiddle.net/kFL9G/](http://jsfiddle.net/kFL9G/)

# c# - 从数据库程序访问保存的数据

> ID：10201288
> 
> 赞同：0
> 
> 时间：2012-04-18T00:51:12.410
> 
> 标签：c#, ms-access, ado.net

这可能是一个愚蠢的问题，如果是，那么我道歉。我有一个程序，其中用户将数据输入到 Windows 窗体并单击一个按钮。该按钮将输入的数据保存到 MS Access 2010 数据库中。

我的问题是：单击按钮并保存数据后，如果我从 Access 打开数据库，是否可以看到保存的数据？当我运行程序时，我没有收到任何错误消息并且一切似乎都在工作，但是当我从 Access 打开表时，它是空的。这是因为从 Access 打开数据库会打开一个不同的实例，还是只是没有保存数据？

下面是 Form 类的代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace P90XProgram
{
    public partial class AbRipperXForm : Form
    {
        private AbRipperXBOL busObject = 
           new AbRipperXBOL();        

        //default constructor
        public AbRipperXForm()
        {
            InitializeComponent();
            busObject.InitializeConnection();
        }

        //event handler for data input
        private void btnEnterAbRipperXInfo_Click(object sender, EventArgs e)
        {
            //convert input data to int datatype and assign to properties
            busObject.InAndOuts = int.Parse(this.txtInAndOuts.Text);
            busObject.ForwardBicycles = int.Parse(
                this.txtForwardBicycles.Text);
            busObject.ReverseBicycles = int.Parse(
                this.txtReverseBicycles.Text);
            busObject.CrunchyFrog = int.Parse(this.txtCrunchyFrog.Text);
            busObject.CrossLegWideLegSitups = int.Parse(
                this.txtCrossLegWideLegSitups.Text);
            busObject.FiferScissors = int.Parse(this.txtFiferScissors.Text);
            busObject.HipRockNRaise = int.Parse(this.txtHipRockNRaise.Text);
            busObject.PulseUpsHeelsToHeaven = int.Parse(
                this.txtPulseUpsHeelsToHeaven.Text);
            busObject.VUpRollUpCombos = int.Parse(this.txtVUpRollUpCombos.Text);
            busObject.ObliqueVUps = int.Parse(this.txtObliqueVUps.Text);
            busObject.LegClimbs = int.Parse(this.txtLegClimbs.Text);
            busObject.MasonTwists = int.Parse(this.txtMasonTwists.Text);

            //call method to save input data
            busObject.SaveData();

            //clear text boxes of data
            this.txtInAndOuts.Clear();
            this.txtForwardBicycles.Clear();
            this.txtReverseBicycles.Clear();
            this.txtCrunchyFrog.Clear();
            this.txtCrossLegWideLegSitups.Clear();
            this.txtFiferScissors.Clear();
            this.txtHipRockNRaise.Clear();
            this.txtPulseUpsHeelsToHeaven.Clear();
            this.txtVUpRollUpCombos.Clear();
            this.txtObliqueVUps.Clear();
            this.txtLegClimbs.Clear();
            this.txtMasonTwists.Clear();
    } 
```

这是我的业务对象层的代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Data.OleDb;
using System.Configuration;

namespace P90XProgram
{
    public class AbRipperXBOL
    {
        int inAndOuts = 0,
            forwardBicycles = 0,
            reverseBicycles = 0,
            crunchyFrog = 0,
            crossLegWideLegSitups = 0,
            fiferScissors = 0,
            hipRockNRaise = 0,
            pulseUpsHeelsToHeaven = 0,
            vUpRollUpCombos = 0,
            obliqueVUps = 0,
            legClimbs = 0,
            masonTwists = 0;

        OleDbConnection aConnection = 
            new OleDbConnection(
                "Provider=Microsoft.ACE.OLEDB.12.0;" +
                "Data Source=P90XDatabase.accdb;");       

        public AbRipperXBOL()
        {            
        }

        //property for inAndOuts variable
        public int InAndOuts
        {
            get { return inAndOuts; }
            set { inAndOuts = value; }
        }

        //property for forwardBicycles variable
        public int ForwardBicycles
        {
            get { return forwardBicycles; }
            set { forwardBicycles = value; }
        }

        //property for reverseBicycles variable
        public int ReverseBicycles
        {
            get { return reverseBicycles; }
            set { reverseBicycles = value; }
        }

        //property for crunchyFrog variable
        public int CrunchyFrog
        {
            get { return crunchyFrog; }
            set { crunchyFrog = value; }
        }

        //property for crossLegWideLegSitups variable
        public int CrossLegWideLegSitups
        {
            get { return crossLegWideLegSitups; }
            set { crossLegWideLegSitups = value; }
        }

        //property for fiferScissors variable
        public int FiferScissors
        {
            get { return fiferScissors; }
            set { fiferScissors = value; }
        }

        //property for hipRockNRaise variable
        public int HipRockNRaise
        {
            get { return hipRockNRaise; }
            set { hipRockNRaise = value; }
        }

        //property for pulseUpsHeelsToHeaven
        public int PulseUpsHeelsToHeaven
        {
            get { return pulseUpsHeelsToHeaven; }
            set { pulseUpsHeelsToHeaven = value; }
        }

        //property for vUpRollUpCombos variable
        public int VUpRollUpCombos
        {
            get { return vUpRollUpCombos; }
            set { vUpRollUpCombos = value; }
        }

        //property for obliqueVUps variable
        public int ObliqueVUps
        {
            get { return obliqueVUps; }
            set { obliqueVUps = value; }
        }

        //property for legClimbs variable
        public int LegClimbs
        {
            get { return legClimbs; }
            set { legClimbs = value; }
        }

        //property for masonTwists variable
        public int MasonTwists
        {
            get { return masonTwists; }
            set { masonTwists = value; }
        }

        public void InitializeConnection()
        {
            AbRipperXDAL.InitializeConnection(aConnection);
        } 

        public void SaveData()
        {
            AbRipperXDAL.SaveData(this);
        }        

        public static void BackToMainSchedule()
        {
            P90xScheduleForm f1;            

            if (Application.OpenForms["P90xScheduleForm"] == null)
            {
                f1 = new P90xScheduleForm();
                f1.Name = "P90xScheduleForm";
            }
            else
            {
                f1 = Application.OpenForms["P90xScheduleForm"] as P90xScheduleForm;
            }

            f1.Show();
        }
    }
} 
```

这是我的数据访问层的代码：

```
using System;
using System.Collections.Generic;
using System.Collections;
using System.Text;
using System.Data;
using System.Data.OleDb;

namespace P90XProgram
{
    class AbRipperXDAL
    {
        static OleDbConnection aConnection = null;

        public static void InitializeConnection(OleDbConnection aDbConnection)
        {
            aConnection = aDbConnection;
            aConnection.Open();
        }

        public static void SaveData(AbRipperXBOL busObject)
        {
            try
            {
                String sSQLCommand = "INSERT INTO AbRipperX (InAndOuts, " +
                    "ForwardBicycles, ReverseBicycles, CrunchyFrog, " +
                    "CrossLegWideLegSitups, Fiferscissors, HipRockNRaise, " +
                    "PulseUpsHeelsToHeaven, VUpRollUpCombos, ObliqueVUps, " +
                    "LegClimbs, MasonTwists) VALUES ('" + busObject.InAndOuts +
                    "','" + busObject.ForwardBicycles + "','" + 
                    busObject.ReverseBicycles + "','" + busObject.CrunchyFrog +
                    "','" + busObject.CrossLegWideLegSitups + "','" + 
                    busObject.FiferScissors + "','" + busObject.HipRockNRaise +
                    "','" + busObject.PulseUpsHeelsToHeaven + "','" +
                    busObject.VUpRollUpCombos + "','" + busObject.ObliqueVUps +
                    "','" + busObject.LegClimbs + "','" + 
                    busObject.MasonTwists + "')"; 

                if (aConnection.State == ConnectionState.Closed)
                {
                    aConnection.Open();
                }

                OleDbCommand cmd = aConnection.CreateCommand();
                cmd.CommandText = sSQLCommand;
                // Execute the SQL command
                cmd.ExecuteNonQuery();
                aConnection.Close();
            }
            catch (Exception ex)
            {
                Console.WriteLine(ex.ToString());
            }                
        }        
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T01:47:41.313

一切看起来都不错！我会在你的 Console.WriteLine(ex.ToString()); 上设置一个断点 看看你是否错过了一个例外

# javascript - 学习 Django 中的 AJAX

> ID：10201289
> 
> 赞同：0
> 
> 时间：2012-04-18T00:51:14.100
> 
> 标签：javascript, jquery, django

我正在尝试弄清楚如何编写 AJAX 函数，但找不到一个不在我脑海中的教程。

我的 HTML 是：

```
<a href="{% url pay_provider id=statement.statement_id %}" id="pay_provider">Pay</a> 
```

当用户单击“支付”时，将通过 AJAX 执行以下 django：

```
def pay_provider(request, statement_id):
    FinancialStatements.objects.get(statement_id=statement_id).update(paid=1)
    return redirect(...) 
```

为了在最基本的层面上做到这一点，必要的 url.py、views.py 和 js 是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T01:04:35.060

好吧，你有几个问题：

1.  你没有任何ajax。
2.  你没有任何jquery。
3.  据我所知，您正在使用一个`a`元素来触发一个 ajax 事件。这不是一个可怕的想法，但它有你可能想要避免的开销。

最后，我`href`是否正确阅读了您的内容，因为您将其设置为返回 ajax 响应的脚本？或者您是否试图获取它，以便当他们点击链接时，它会将他们带到一个新页面，同时发送一个 ajax 请求？

如果是后者，我会避免它。如果是 ajax 响应者的 URL，试试这个：

### HTML/Python：

```
<a href="{% url pay_provider id=statement.statement_id %}" id="pay_provider">Pay</a> 
```

### 查询：

```
$("#pay_provider").on("click" function(e) {
    e.preventDefault();  // Prevent browser from following link.
    post_url = $("this").attr("href");
    $.post(post_url, function(data) {
         // do whatever with the returned data.
    });
}); 
```

通过`post_url`在事件处理程序之后设置 right，它可以避免`$(this)`被`post()`函数覆盖的问题，并允许您将 ajax URL 存储在链接中。虽然这对于表现不佳的浏览器来说可能是一个问题，但它确实提供了为多个此类链接重用相同 ajax 函数的好处，例如：

```
<a href="{% url pay_provider id=statement.statement_id %}" 
class="provider_action">Pay</a>
<a href="{% url save_provider id=statement.statement_id %}" 
class="provider_action">Save</a>
<a href="{% url cancel_provider id=statement.statement_id %}" 
class="provider_action">Cancel</a> 
```

现在你可以这样做：

```
$(".provider_action").on("click" function(e) {
   e.preventDefault();  // Prevent browser from following link.
    post_url = $("this").attr("href");
    $.post(post_url, function(data) {
         // do whatever with the returned data.
    });
}); 
```

这将适用于所有 3 个“动作”链接，但会触发他们自己的动作脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T21:14:08.990

这是我能想到的最基本的例子。它涵盖了添加/删除功能：

HTML：

```
<select name="test_add" id="test_add">
    {% for position in all_positions %}
    <option value="{{ position.id }}">{{ position }}</option>
    {% endfor %}
</select>

{% for position in user_positions %}
    <span id="positions">
        {{ position }}
        <input type="hidden" class="position_id" value="{{ position.id }}">
        <a class="delete-position" href="#;">X</a>
    </span>
{% endfor %} 
```

网址：

```
 url(r'^ajax_test_delete/$',
                            'ajax_test_delete',
                            name='ajax_test_delete'),

                        url(r'^ajax_test_add/$',
                            'ajax_test_add',
                            name='ajax_test_add'),

                        url(r'^ajax_test_page/$',
                            'ajax_test_page',
                            name='ajax_test_page'), 
```

意见：

```
def ajax_test_page(request):
    profile = request.user.get_profile()
    all_positions = Position.objects.all_with_gender().filter(id__lt=50).order_by('position')
    user_positions = profile.positions.order_by('positiontimestamp__timestamp')
    return render(request, 'videos/ajax_test_page.html', {'user_positions': user_positions, 'all_positions': all_positions})

def ajax_test_delete(request):
    position_id = int(request.POST['position_id'])
    position = Position.objects.get(id=position_id)
    profile = request.user.get_profile
    PositionTimestamp.objects.get(profile=profile, position=position).delete()
    return HttpResponse()

def ajax_test_add(request):
    position_id = int(request.POST['position_id'])
    position = Position.objects.get(id=position_id)
    profile = request.user.get_profile()
    add_new = PositionTimestamp(profile=profile, position=position)
    add_new.save()
    return HttpResponse() 
```

JS：

```
// TEST AJAX //
$("a.delete-position").live('click', function(){
   // use named variables in the outer function -- $(this) refers to the response in the inner function
   var span = $(this).parent();
   var position_id = $(this).siblings('input.position_id').val();
   $.post('/ajax_test_delete/', {'position_id': position_id}, function(response) {
       span.remove();       
   });
});

$("#test_add").change(function(){
    var position_id = $(this).find('option:selected').val();
    $.post('/ajax_test_add/', {'position_id': position_id}, function(response) {
        var position_name = $("#test_add option:selected").text();
        var span = $('<span>' + position_name + '</span>');
        span.append($('<input type="hidden" class="position_id" value="' + position_id + '">' ));
        span.append($('<a class="delete-position" href="#;">X</a>'));
        $('#positions').append($(span));   
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T01:00:25.360

通过将 href 设置为该 URL，浏览器将同步向该 URL 发出请求。您可以使用 jQuery 来使用链接的单击事件来发出 ajax 请求。

```
$(function() {
    $('#pay_provider').click(function(e) {
        e.preventDefault();
        $.post('{% url pay_provider id=statement.statement_id %}', function() {
            // alert('ajax call complete');
        });
    });
}); 
```

# ruby-on-rails-3.1 - 设计邀请的 destroy_if_previously_invited 失败，没有提供密码

> ID：10201290
> 
> 赞同：0
> 
> 时间：2012-04-18T00:51:17.697
> 
> 标签：ruby-on-rails-3.1, devise, attr-accessible

我在 devise + devise_invitable + cancan 配置上遇到问题：如果用户在没有邀请的情况下以正常方式注册，则不执行此处描述的工作的最后一步： [https ://github.com/scambra/devise_invitable/ blob/master/lib/devise_invitable/controllers/registrations.rb](https://github.com/scambra/devise_invitable/blob/master/lib/devise_invitable/controllers/registrations.rb)

原因是这些属性在没有密码的情况下是无法编辑的，而 attr_accessible 是为它们设置的。

如何解决这个障碍？知道我花了多少时间试图弄清楚这一点，但仍然不明白，真是太遗憾了:)

PS 各自的值也不能通过控制台更改。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T23:48:09.970

我终于发现了这种奇怪行为的原因：这是我不小心将其放入 User 模型的验证语句：

```
validates :password, :presence => true 
```

当然，这不是必需的。

我要留下这个问题，以防万一其他人陷入同样愚蠢的境地。

# vb.net - 我的插件不会在断点处停止

> ID：10201292
> 
> 赞同：0
> 
> 时间：2012-04-18T00:51:41.510
> 
> 标签：vb.net, breakpoints

我看到我正在开发的 Readsoft 插件出现奇怪的行为。

我希望它在断点处停止，但它没有。就在我放置断点的位置之前的 msgbox 显示正确，它之后的那个也是。

我需要你的帮助，因为我不知道问题出在哪里。

谢谢你的帮助！

[这是我要停止的断点的类](http://screencast.com/t/Fn8SkYeCu)

[这是 ReadSoft 程序，在调试没有停止的断点行之后显示 Msgbox](http://screencast.com/t/2CAptUlld)

PS：我正在使用 Visual Studio 2010 Professional，在 VB.NET 中编码

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T05:56:53.887

我终于可以找到答案并认为它可以提供帮助。

所以我的问题来自于我在 Visual Studio 2010 下运行我的项目，但这个项目最初是在 Visual Studio 2005 上创建并在 .NET 框架 2 上运行的。

只需将框架更改为框架 4 即可解决我的问题。

希望这有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T02:46:01.470

当我启动我的应用程序时，它会自动启动 ReadSoft 程序，它将在此运行

[这是启动将要运行的 ReadSoft 程序的属性文件](http://screencast.com/t/vgHZghETs)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T02:16:05.300

每当我遇到这个问题时，我通常可以通过选择 Build > Clean Solution，然后选择 Build > Rebuild Solution 来解决它。我认为这是调试符号与代码不同步引起的。

如果这不起作用，我将确保我处于调试模式（发布模式启用优化，偶尔会进行更改，因此您无法在所需的行上设置断点），我将清除所有断点 - 调试 > 删除所有断点，然后再次设置断点。

# python - 如何向不需要模型实例的模型添加函数？

> ID：10201293
> 
> 赞同：0
> 
> 时间：2012-04-18T00:52:08.853
> 
> 标签：python, django, class, models

所以我一直试图在 Django 中添加一个模型函数，它接受参数，然后将 X 条新记录插入数据库。

为什么不能做`MyModel.MyFunction()`？我需要先创建一个实例吗？

如果是这样，是否有更好的方法来实现我想要的结果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T00:55:52.900

你当然可以这样做，你只需要把它变成[`classmethod`](http://docs.python.org/library/functions.html#classmethod)：

```
class MyModel(models.Model):
    @classmethod
    def my_function(cls):
        new_instance = cls(...)
        new_instance.save()
        # etc... 
```

# css - 在运行时消失的 DIV？

> ID：10201294
> 
> 赞同：0
> 
> 时间：2012-04-18T00:52:15.607
> 
> 标签：css, html

在 DreamWeaver 中，一切都编译得很好，在设计选项卡上看起来很正常，但是当我切换到 localhost 时，我满足的 DIV 只在左侧显示文本，而它们应该在中间。

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
 <html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="/css/style.css" type="text/css">       
    <title>Title</title>
  </head>
  <body>

    <img src="images/barColor.jpg" width="1" height="71" alt="barColor" />

    <p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p>   

    <div class="wrdLatest" id=1> content of id 1   <p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p>              </div>                                                                     
<div class="wrdLatest" id=2> content of id 2   <p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> </div>
<div class="wrdLatest" id=3> content of id 3   <p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p>              </div>
<div class="wrdLatest" id=4> content of id 4   <p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> </div>
<div class="wrdLatest" id=5> content of id 5   <p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> </div>
<div class="wrdLatest" id=6> content of id 6   <p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> </div>
<div class="wrdLatest" id=7> content of id 7   <p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> </div>
<div class="wrdLatest" id=8> content of id 8   <p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> </div>
<div class="wrdLatest" id=9> content of id 9   <p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> </div>
<div class="wrdLatest" id=10> content of id 10 <p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> </div>
<div class="wrdLatest" id=11> content of id 11 <p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> </div>
<div class="wrdLatest" id=12> content of id 12 <p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> </div>

  </body>
</html> 
```

然后是 style.css

```
 #wrdLatest {
        background: url('../images/spacing.png') repeat-y;
        z-index: -1;
        padding: 20px;
        margin-left: auto;
        margin-top: auto;
        width: 75%;
        height: 100%;
        min-height: 25px;
        min-width: 25px;
        background-repeat: repeat-y;
        style="text-align: center;"
    } 
```

1[我想要](http://i.imgur.com/6nSbK.png)什么 1[我得到什么](http://i.imgur.com/wnYcE.png)

非常感谢任何帮助......是的，我是 HTML 新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T01:13:20.830

您的代码中有错误，您没有使用结束标签关闭所有 div，`</div>`而且您的 css`style="text-align: center;"`也不正确，请关闭所有 div

```
<div>Content</div> 
```

并从中删除该行`style="text-align: center;"`，`#wrdLatest`否则应该是

```
text-align: center; 
```

`wrdLatest`是您的 HTML 中的类，但您`#`在 css 中使用了 ID。一个类应该如下

```
.wrdLatest{
    background: url('../images/spacing.png') repeat-y;
    z-index: -1;
    padding: 20px;
    margin-left: auto;
    margin-top: auto;
    width: 75%;
    height: 100%;
    min-height: 25px;
    min-width: 25px;
    background-repeat: repeat-y;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T01:44:12.640

已修改 CSS 以实现您想要的布局。看看这个[**jsFiddle**](http://jsfiddle.net/neo108/8pG5s/3/)。

已使用左边框来显示左橙色边框。而且您还必须使用`.wrdLatest`而不是`#wrdLatest`for`div class`

CSS的修改版本...

```
.wrdLatest {
    background: url('../images/spacing.png') repeat-y;
    z-index: -1;
    padding: 5px 20px 70px 20px;
    margin-left: auto;
    margin-top: auto;
    width: 75%;
    height: 100%;
    min-height: 25px;
    min-width: 25px;
    background-repeat: repeat-y;
    text-align: left;
    border-left: 2px solid #FE642E;
} 
```

并删除了所有多余的空`<p>`的。

希望这可以帮助。

# windows - Windows driver.sys 文件位置不是 system32\drivers

> ID：10201295
> 
> 赞同：5
> 
> 时间：2012-04-18T00:52:16.777
> 
> 标签：windows, driver, inf

将 Windows 驱动程序 sys 文件保留在 system32\drivers 目录之外是否合法？看来，如果驱动程序是通过 CreateService 使用 driver.sys 文件的绝对路径“手动”配置的。但是，当 INF 文件用于使用 InstallHinfSection 安装驱动程序并且驱动程序位置不是 system32\drivers InstallHinfSection 将失败并出现错误

！！！dvi：驱动程序路径不在系统根目录中！inf: {Install Inf Section [DefaultInstall.NT.Services] exit(0xe0000217)} !!! inf：错误 0xe0000217：此 INF 中的服务安装部分无效。inf: {Install Inf Section [DefaultInstall.NT]} 当 ServiceBinary = %1%\MyDriverdrv.sys ; 当前目录并在 ServiceBinary = %12%\MyDriverdrv.sys 时成功；system32\驱动程序

INf 文件：

```
;
; INF file to install MyDriver registry filter driver
;

[Version]
signature = "$Windows NT$"
Provider    = %MyDriverInc%
CatalogFile =

; Distribution Media information
;
[SourceDisksNames]
1 = %MyDriverdrv.MediaDesc%

[SourceDisksFiles]
MyDriverdrv.sys = 1

[DestinationDirs]
DefaultDestDir = 12
MyDriver.DriverFiles = 12

[DefaultInstall.NT]
CopyFiles = MyDriver.DriverFiles

[DefaultUninstall.NT]
DelFiles = MyDriver.DriverFiles

[MyDriver.DriverFiles]
MyDriverdrv.sys

[DefaultInstall.NT.Services]
AddService = %ServiceName%, , MyDriverdrv_Service_Inst

[DefaultUninstall.NT.Services]
AddService = %ServiceName%, 0x200

[MyDriverdrv_Service_Inst]
DisplayName    = %MyDriverdrv.SvcDesc%
ServiceType    = 1; SERVICE_KERNEL_DRIVER
StartType      = 3; SERVICE_DEMAND_START
ErrorControl   = 1; SERVICE_ERROR_NORMAL
ServiceBinary  = %1%\MyDriverdrv.sys

[Strings]
MyDriverInc        = "MyDriver, Inc"
ServiceName = "MyDriverdrv"
MyDriverdrv.SvcDesc = "MyDriver Trace Kernel Mode Driver"
MyDriverdrv.MediaDesc = "MyDriver Trace Kernel Mode Driver" 
```

由于 INF 文件是现在安装驱动程序的官方方式，我看不到将驱动程序文件保存在本地的方法。

谢谢！

# c# - 为在同一文件中工作的多个用户寻求设计建议

> ID：10201298
> 
> 赞同：1
> 
> 时间：2012-04-18T00:52:19.823
> 
> 标签：c#, ms-access, serialization, sql-server-express

我正处于编写供多个用户使用的桌面应用程序的最早阶段。我正在寻找有关解决此问题的最佳方法的建议。

# 规格

我会将我的模型保存在一个文件中，该文件通常会在映射的网络驱动器上使用。（用于设计道路和其他线性特征，如铁路和溪流。）

各种最终用户需要能够同时连接和编辑文件。例如，Billy Bob 正在研究名为 US321 的道路，而 Rupert 正在研究 I40。每条道路的模型都存在于同一个文件中。最终用户可以“声明”任何道路名称，其中只有声明者可以编辑给定的道路。当比利鲍勃声称时，鲁珀特无法编辑 US321，但鲁珀特可以阅读 US321 以供参考。一旦用户完成对道路数据的编辑，他可以发布声明，其他人可以对其进行编辑。

# 序列化的限制？

我对序列化的理解非常有限（请参阅我的个人资料）。但在我看来，对象和序列化文件之间存在一对一的关联。因此，如果我使用序列化来实现这一点，就不可能只声明它的一部分，也不可​​能只更新它的一部分。（这是正确的吗？如果不是，那么我可以使用序列化，对吗？）

# 我正在考虑的解决方案

我正在考虑使用 SQL Server Express，并且我对社区对此的警告、更正或确认感兴趣。

最终用户不必知道我在后台使用 SQL Server Express。（我什至会将文件扩展名更改为适合我的应用程序的内容。）我会将道路加载到列表中，并且每条道路都是“可声明的”。声明一条道路将在数据库中标记它，以便应用程序的其他实例做出相应的反应，有点像它是一个共享的 MS Excel 文件，多人可以同时编辑，但（类似于 Excel）能够锁定个人工作表。

[编辑] 请参阅下面的 Micah Armantrout 的内容丰富的回复。所以现在我想知道使用 Microsoft Access 作为中介数据库应用程序。

[编辑]

# 结论

感谢大家提供有用的答案和评论。Micah 的回答非常有帮助，因为我没有意识到我会被限制为仅由一台服务器控制的文件。虽然现在它很有意义，但我没有预料到，如果我走那条路，我会在朝那个方向工作几个小时后搁浅。

当我第一次阅读 urbadave 的想法时，我认为它是我已经考虑过但不喜欢的东西。但仔细想想，这显然是最简单的方法。我只是使用一个目录，就像它是一个文件一样，但对我的顶级子对象具有用户透明度。但显然，将我的整个模型封装到一个文件中是很有吸引力的。

所以这就是我决定做的事情：就像 urbadave 建议的那样，从写入目录开始。然后稍后测试将其放入 zip 目录并使用 ZipPackage 类提取并插入单个序列化文件（或 XML 文件——我必须有一天做出另一个决定）。

*   保罗

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T01:15:13.667

SQL Server 可以满足您的需求，但如果您要拥有多个用户，则需要将机器设置为服务器。**在每台机器上安装 sql server express 对您没有任何好处**它可能是用户机器之一或带有 SQL server express 的实际服务器，您需要将其设置为可在当前机器之外访问按照本教程执行此操作。

如果您使用 Windows XP SP2 之前的任何设备，则需要按照这些说明打开防火墙的端口，这也在下面的链接中进行了讨论。

[http://blogs.msdn.com/b/sqlexpress/archive/2005/05/05/415084.aspx](http://blogs.msdn.com/b/sqlexpress/archive/2005/05/05/415084.aspx)

就共享数据而言，我的意思是看到其他人的工作。如果您不想在服务器上安装 sql server，您可以使用 MS Access 我会向您推荐一篇关于何时使用的文章

[http://www.techrepublic.com/article/should-you-use-sql-server-express-edition-or-microsoft-access-for-your-small-business-applications/6140859](http://www.techrepublic.com/article/should-you-use-sql-server-express-edition-or-microsoft-access-for-your-small-business-applications/6140859)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T04:21:43.923

虽然我可以在工作中访问一个不错的数据库，但我的大部分个人编程都不使用数据库。我过去使用的技巧之一是文件扩展名是为了传达意义。在您的情况下，您可以利用文件扩展名来指示声明并控制对主文件的写入。

没错，您可能希望将每个道路对象序列化到自己的文件中。主文件将是包含所有这些单独道路对象的集合对象的序列化。

用户选择并打开这些道路文件。在打开文件之前，用户的应用程序会重新命名文件，添加扩展名（可能是用户的 id）。这样，您可以使用目录扫描来查找已声明和未声明的文件。

只有当用户在他们正在工作的道路上发布他们的声明时，才会写入主文件。用户的应用程序打开所有道路文件，使用道路对象组装一个主对象，然后将该对象序列化到主文件中。完成后，用户应用程序通过重命名来释放用户对道路文件的声明。

在写入主文件之前，用户的应用程序会重命名文件，表明它即将被写入。如果用户的应用程序需要写入，它可以检查文件是否被重命名，并等待文件名恢复为可写名称。

这是我将如何攻击此规范的草图。祝你好运。

# python - 如何在 Google App Engine (GAE) 上运行的 Web2py 上创建新的 auth_user 和 auth_group？

> ID：10201300
> 
> 赞同：2
> 
> 时间：2012-04-18T00:52:35.263
> 
> 标签：python, google-app-engine, wsgi, web2py, web2py-modules

我用 Web2py 在我的本地计算机上创建了一个应用程序，它通过 WSGI 和 SQLite 运行。我可以成功地将我的应用部署到 Google App Engine，使用我自己的域并执行我需要的所有 url 重写。

现在我需要一种方法来创建负责更新某些表的特定管理用户。

**具体问题：**

1.  当我的应用程序在 GAE 上运行时，有没有办法可以使用 Web2py 管理界面？
2.  即使我不想创建新闻应用程序或编辑文件，是否可以使用 Web2py 管理界面来管理在 Google App 引擎上运行的应用程序的数据库？
3.  如果没有，在 GAE 上使用 Web2py 时，这种用户管理是如何完成的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T13:12:51.930

我以前从未使用过 GAE，但我通常在我的 db.py 中执行类似的操作来创建初始管理用户：

```
def check_initialize():
    if not db().select(db.auth_user.ALL).first():        
        db.auth_user.insert(
            username = 'administrator',
            password = db.auth_user.password.validate('admin1234')[0],
            email = 'null@null.com',
            first_name = 'System',
            last_name = 'Administrator',
            is_admin = True,
        )

# do initialization check
cache.ram('db_initialized', lambda: check_initialize(), time_expire=None) 
```

请注意，“is_admin”是我添加到 auth_user 表的字段，但我也可以轻松添加一个名为“administrators”的新 auth_group 记录，然后使用“auth.add_membership( 1, 1)”。

对于管理功能，如果您无法让 web2py 管理员工作（如果您将 web2py 设置为通过 HTTPS 运行，这应该是可能的），那么您始终可以使用以下内容创建自己的编辑器：

```
def users():
    form = SQLFORM.grid(db.auth_user)
    return dict(form=form) 
```

这将创建一个列出所有用户的网格控件，并允许您添加和删除用户。您可以对 db.auth_group 和 db.auth_membership 执行相同的操作。不过，您可能需要稍微调整一下。或者，您总是可以使用这样的东西：[Instant Admin](http://sramana.in/web2py-appadmin2/)或[Badmin](https://github.com/rochacbruno/badmin)

# android - 如何解析在android中具有节点值的xml

> ID：10201301
> 
> 赞同：0
> 
> 时间：2012-04-18T00:52:40.520
> 
> 标签：android, android-listview, android-xml

我真的很困惑如何将 xml 解析到我的 android 列表中。我用`NodeList`with`getElementsByTagName`来获取组件`<segment>`。当我运行和调试时，错误发生在行中。`NodeList nL = doc.getElementsByTagNameNS(KEY_SEGMENT, "segment_id");`有关更多详细信息，这里是我在 android 中的 java 代码：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.listsegment_main);

    ArrayList<HashMap<String, String>> menuItems = new
            ArrayList<HashMap<String, String>>();

    String xml = XMLParser.getXmlFromUrl();
    Document doc = XMLParser.getDomElement(xml);

    NodeList nL = doc.getElementsByTagNameNS(KEY_SEGMENT, "segment_id");
    for (int i = 0; i < nL.getLength(); i++) {
        HashMap<String, String> map =  new HashMap<String, String>();
        Element e = (Element) nL.item(i);
        map.put(KEY_SEGMENT_ID, XMLParser.getValue(e, KEY_SEGMENT_ID));
        map.put(KEY_MAIN_SEGMENT, XMLParser.getValue(e, KEY_MAIN_SEGMENT));
        menuItems.add(map);
    } 
```

我的 xml 文件：

```
<map>
 <segment segment_id="1050">
   <segment_id>1050</segment_id>
   <route_id>103</route_id>
   <canvasser_id>13</canvasser_id>
   <order>1</order>
   ....
 </segment> 
```

请帮助我。您的建议、参考、链接和所有论点都迫切需要和对我有用。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T02:50:41.167

我正在使用 DOM 解析器。试试下面的代码

```
public class XMLParsingDOMExampleActivity extends Activity {
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    try{
    URL url = new URL("http://www.androidpeople.com/wp-content/uploads/2010/06/example.xml");
            DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
            DocumentBuilder db = dbf.newDocumentBuilder();
            Document doc = db.parse(new InputSource(url.openStream()));
            doc.getDocumentElement().normalize();

            NodeList nodeList = doc.getElementsByTagName("item");

            Node node = nodeList.item(0);

            Element fstElmnt = (Element) node;
            NodeList nameList = fstElmnt.getElementsByTagName("name");
            Element nameElement = (Element) nameList.item(0);
            nameList = nameElement.getChildNodes();
            Log.i("Name", ((Node) nameList.item(0)).getNodeValue());

            NodeList websiteList = fstElmnt.getElementsByTagName("website");
            Element websiteElement = (Element) websiteList.item(0);
            websiteList = websiteElement.getChildNodes();
            Log.i("Website",((Node) websiteList.item(0)).getNodeValue());

            Log.i("Website Category", websiteElement.getAttribute("category"));

    }
    catch(Exception e) {

        e.printStackTrace();

    }
} 
```

}

[您也可以在此博客上找到 SAXParser](http://blog.valaypatel.info/?p=58)

# mvc-mini-profiler - MiniProfiler - 在内存消耗方面有什么影响？

> ID：10201312
> 
> 赞同：3
> 
> 时间：2012-04-18T00:54:29.490
> 
> 标签：mvc-mini-profiler

在内存消耗方面，运行 Mini-Profiler 有什么影响？

另外，如果我们使用包含的***SqlServerStorage***提供程序，分析结果是否也存储在内存中？

# jquery - 可以在表单下拉列表中创建列吗？

> ID：10201316
> 
> 赞同：1
> 
> 时间：2012-04-18T00:54:52.680
> 
> 标签：jquery, html, css

有人知道在表单下拉列表中创建对齐列的解决方案吗？

也许用 css

跨浏览器会很方便......例如

```
<select size="1">
<option> John Smith      | 24 | United States</option>
<option> Johnny Vegas    | 34 | United Kingdom</option>
<option> Andrew Townsend | 34 | Canada</option>
</select> 
```

垂直条只是列对齐的表示..

希望这是有道理的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T00:56:51.667

它不能用 css 完成，你可以添加空格来缩进它，就像你对问题所做的那样。

```
<select size="1">
    <option> John Smith &thinsp; &thinsp; &thinsp; &thinsp;&thinsp;&thinsp;&thinsp;&thinsp;  | 24 | United States</option>
    <option> Johnny Vegas&thinsp;&thinsp;&thinsp;&thinsp;&thinsp;&thinsp;&thinsp; &thinsp;| 34 | United Kingdom</option>
    <option> Andrew Townsend | 34 | Canada</option>
</select>​​​​​​​​​​​​​ 
```

[**现场演示**](http://jsfiddle.net/7sUqq/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T01:01:41.593

解决此问题的最佳方法是，如果您对以库的形式向页面加载添加额外请求持谨慎态度，则使用 CSS 创建一个 ul-li 可见的自定义下拉菜单并将点击事件附加到每个 li 到操纵隐藏的选择。使用 CSS 和 jQuery / javascript 很容易做到（我更喜欢 jQuery 只是因为它打字少而且我已经习惯了）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T01:16:22.377

gdoron 让我思考，所以我写了一个快速的 PHP hack 给那些后来发现这个线程的人

```
$name = str_replace("_", "&nbsp;", str_pad($name , 50 ,"_")); 
```

我确定在 php 中还有其他方法可以做到这一点。

很确定这可以跨浏览器进行测试！

确保你的风格

```
select style="font-family: monospace;" 
```

# c++ - 复制构造函数省略？

> ID：10201321
> 
> 赞同：4
> 
> 时间：2012-04-18T00:55:57.187
> 
> 标签：c++, constructor, copy

不太明白为什么当我使用 VC2010 以调试模式构建时不调用此复制构造函数。

```
class SomeClass
{
public:
    SomeClass(int meaningless){}

    SomeClass(const SomeClass& sc)
    {
        cout << "Copy Constructor invoked!" << endl;
    }
};

int main()
{
    SomeClass test(SomeClass(9999));  // Copy constructor not invoked. 
} 
```

我认为这与 RVO 无关，因为我没有返回任何值。

更有趣的是，当我将复制构造函数设为私有时，即使省略了复制构造函数，编译器也不会编译。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T01:00:34.527

它是由编译器完成的优化。根据语言规范，允许编译器尽可能省略对复制构造函数的调用。

一个可访问的复制构造器仅用于语义检查，即使它*实际上*并没有被调用。语义检查是在优化之前完成的。

但是，如果您`-fno-elide-constructors`使用 GCC 选项编译它，则不会执行复制省略，而是会调用复制构造函数。[GCC 文档](http://gcc.gnu.org/onlinedocs/gcc-4.4.4/gcc/C_002b_002b-Dialect-Options.html)说，

> **-fno-elide-constructors**
> 
> C++ 标准允许实现省略创建仅用于初始化相同类型的另一个对象的临时对象。**指定此选项会禁用该优化，并强制 G++ 在所有情况下调用复制构造函数。**

使用 MSVC10，您可以使用[/Od](http://msdn.microsoft.com/en-us/library/aafb762y(v=vs.100).aspx)，根据 MSDN，它会关闭程序中的所有优化。

*注意*：维基百科有一篇关于[复制省略的文章](http://en.wikipedia.org/wiki/Copy_elision)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-18T01:05:24.993

根据 C++11 标准，§12.8.31：

> …This elision of copy/move operations, called *copy elision*, is permitted in the following circumstances (which may be combined to eliminate multiple copies):
> 
> …</p>
> 
> *   when a temporary class object that has not been bound to a reference would be copied/moved to a class object with the same cv-unqualified type, the copy/move operation can be omitted by constructing the temporary object directly into the target of the omitted copy/move

Temporary objects get a lot of leeway in C++, and compilers will be pretty aggressive when removing them. If your object had a lifetime of its own in any way, then the copy constructor *would* end up being called.

However, I would definitely expect it to check the copy constructor's access modifier, though I can see an argument that you shouldn't (after all, you just aren't calling the copy constructor). But that probably wouldn't be very good practice, since copy elision is optional.

# vb.net - 动态控件不在 WinForm 中呈现

> ID：10201324
> 
> 赞同：1
> 
> 时间：2012-04-18T00:56:25.370
> 
> 标签：vb.net, dynamic, controls

我正在尝试创建标签和文本框列表。没有错误，但它们没有呈现在表单上。我已经确认我的循环有值

```
Private Sub AddLabels_Load(sender As Object, e As EventArgs) Handles MyBase.Load
    'MsgBox(strNumberOfLabels + " " + strOrderNum)
    TableLayoutPanel1.AutoSize = True
    TableLayoutPanel1.Visible = False
    TableLayoutPanel1.SuspendLayout()
    For i As Integer = 0 To strNumberOfLabels

        'MsgBox(i)
        Dim txtBox As New TextBox
        Dim txtLabel As New Label
        txtLabel.Text = "Label " + i
        txtBox.Name = "txt" + i
        TableLayoutPanel1.Controls.Add(txtLabel)
        txtLabel.Show()
        txtBox.Show()
        TableLayoutPanel1.ResumeLayout()
        TableLayoutPanel1.Visible = True
    Next
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T01:07:05.593

尝试使用另一个`Add`重载，它指定控件应该进入哪一列和哪一行：

```
Dim txtLabel As New Label
txtLabel.Text = "Label" + i.ToString
'\\ TableLayoutPanel1.Controls.Add(txtLabel)
TableLayoutPanel1.Controls.Add(txtLabel, 0, 0) 
```

这不是必需的：

```
'\\ txtLabel.Show() 
```

这应该移到循环之外：

```
 Next
TableLayoutPanel1.ResumeLayout()
'\\ TableLayoutPanel1.Visible = True 
```

控件永远不会被`txtBox`添加到`TableLayoutPanel`控件或窗体中。

我认为在此`OnLoad`过程中没有必要让您的 TableLayoutPanel 可见或不可见，表单尚不可见。

唯一需要确认的是 的值`strNumberOfLabels`。我怀疑它是零。

# c# - PropertyChangedEvent 和 CanExecute 问题

> ID：10201325
> 
> 赞同：3
> 
> 时间：2012-04-18T00:56:28.973
> 
> 标签：c#, wpf, mvvm, prism, wpf-4.0

我正在使用 MVVM (prism) 开发 wpf 应用程序。

我的模型类之一“StandardContact”的属性直接绑定到视图。我使用 IDataErrorInfo 来跟踪并通知模型是否有任何错误。如果模型中有任何错误，我会禁用“保存”命令。

当用户输入一些数据时，我使用 StandardContact.PropertyChanged 处理程序来查看“保存”命令是否可以执行（即用户输入的模型数据是否有效）。问题是 StandardContact.PropertyChanged 处理程序是在 IDataErrorInfo 的验证代码之前调用的，因此“Save”命令的 CanExecute 不能正确反映该命令是否可以执行。我正在寻找的是，在 CanExecute 执行之前，应该运行 IDataErrorInfo 验证，以便 CanExecute 将查询模型中的最新数据并决定是否启用它。这是我正在使用的示例代码

模型：

```
public class StandardContact :EntityBase, IDataErrorInfo
{
    public virtual string Name 
    {
        get { return _name; }
        set { SetField(ref _name, value, () => Name); }
    }

    //...
    //Validators
    public string this[string propertyName] 
    {
        get 
        {
            string error = null;
        //....
    } 
```

视图模型

```
public class SContactEditViewModel : NotificationObject, INavigationAware 
{
    //....
        StandardContact.PropertyChanged += 
            new PropertyChangedEventHandler(StandardContact_PropertyChanged);

    void StandardContact_PropertyChanged(object sender, PropertyChangedEventArgs e) 
    {
        //Requery if command can execute
        SaveNewCommand.RaiseCanExecuteChanged(); 
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T02:04:54.310

我不使用棱镜，但如果它公开了某种 IsValid 方法或属性，您可以使用它来触发错误检查。如果没有，您可以自己编写。

没有棱镜的基本思想是必须通过做来利用 IDataErrorInfo.Error

```
bool IsValid{ get{return string.IsNullOrEmpty(Error) }  // trigger validation 
```

然后在您的 Save.CanExecute 方法中

```
return IsValid;    // trigger validation on demand 
```

HTH，
绿柱石

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T11:21:34.650

我刚刚检查了我们专有的 MVVM 库。在 ViewModels 索引器（在您的情况下是 Models 索引器）中验证了请求的属性：

```
public string this[string propertyName]
{
    get
    {
        string result = null;

        if (CanDataErrorValidated(propertyName))
        {
            int errorCount = CurrentValidationAdapter.ErrorCount();
            result = ValidateProperty(propertyName, GetValidateValue(propertyName));

            // if the error flag has been changed after validation
            if (errorCount != CurrentValidationAdapter.ErrorCount())
            {
                RaisePropertyChanged(PropHasError);
                RaisePropertyChanged(PropError);
            }
        }
        else
        {
            RaisePropertyChanged(PropHasError);
            RaisePropertyChanged(PropError);
        }

        return result;
    }
} 
```

因此，您的问题的解决方案似乎可以即时验证请求的属性。

# python - Timer_fd 蟒蛇？有没有等价物

> ID：10201326
> 
> 赞同：1
> 
> 时间：2012-04-18T00:56:34.767
> 
> 标签：python, linux, asynchronous, epoll

我想知道如何使用python设置计时器。我目前正在使用 select.poll/epoll 并创建一个 timerfd 将是最简单的方法。

我看到的另一种方式是在循环检查我的任何事件是否经过时间并执行它们的功能之后。

其他方法：

```
import select,time

timeout =0
epoll.register(rpm_file.fileno(), select.EPOLLPRI)

while True:
  events = epoll.poll(0)
  for fileno,event in events:
    #processing fd events...

  now = time.time()
  if now > timeout:
    # timeout events 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-12-04T04:29:23.853

此答案仅适用于 Linux。您可以尝试下面的名为 linuxfd 的 python 包，其中包括 timerfd 的包装器：
[https ://github.com/FrankAbelbeck/linuxfd](https://github.com/FrankAbelbeck/linuxfd)

它由python包索引索引：
[https ://pypi.python.org/pypi/linuxfd/1.4.4](https://pypi.python.org/pypi/linuxfd/1.4.4)

作者的一些例子：
[https ://abelbeck.wordpress.com/2014/01/24/more-on-linuxfd-an-example/](https://abelbeck.wordpress.com/2014/01/24/more-on-linuxfd-an-example/)

# c - MPI 2x 打印

> ID：10201330
> 
> 赞同：0
> 
> 时间：2012-04-18T00:56:45.980
> 
> 标签：c, parallel-processing, printf, mpi

我正在研究一点 MPI，并决定通过制作一个调用对象的程序来进行测试，例如`main.c`-> 主程序，`function.c`-> 任何函数

仅使用 MPI 的 function.c。编译我如下：

```
gcc-c main.c 
```

创建`main.o`，`mpicc-c`创建`function.c` `function.o`，当然我`function.h`也创建了文件。

`mpicc-o`我用程序编译`main.o` `function.o`

这是`main.c`

```
#include <stdio.h>
#include "function.h"

void main(int argc, char *argv[])
{
  printf("Hello\n");
  function();
  printf("Bye\n");
} 
```

只是函数有 MPI 代码，但是当我运行程序时，`mpiexe -np 2`我得到

```
Hello
Hello
----- function job here -----
Bye
Bye 
```

但我希望它是

```
Hello
------ function job -----
Bye 
```

我能做些什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T01:09:42.667

您的整个程序在您使用`-np 2`. 防止重复打印输出、最终结果等的一种常用方法是让一个线程通过首先检查线程 ID 来执行这些操作。喜欢：

```
int id;
MPI_Comm_rank(MPI_COMM_WORLD, &id);
if (id == 0) {
  printf("only process %d does this one\n", id);
}

printf("hello from process %d\n", id);  // all processes do this one 
```

当我开始使用 MPI 时，我发现打印出这些 id 编号以及每个线程正在处理的任何部分结果或数据很有帮助。帮助我更了解正在发生的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T01:06:20.810

基本上`mpirun -np 2`启动 2 个相同的进程，你必须使用`MPI_Comm_rank`函数来检查进程等级。

这是一个快速的片段：

```
int main(int argc, char **argv)
{
  int myrank;
  MPI_Init(&argc, &argv);
  MPI_Comm_rank(MPI_COMM_WORLD, &myrank);
  if (myrank == 0) {
    printf("Hello\n");
    function();
    MPI_Barrier(MPI_COMM_WORLD);
    printf("Done\n");
  } else {
    function();
    MPI_Barrier(MPI_COMM_WORLD);
  }
  MPI_Finalize();
  return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T05:54:43.267

我通常更喜欢这种打印数据的方法。它涉及障碍。所以你在使用的时候一定要小心。

```
if(1)
do
  for(i = 0 to num_threads)
  do
     if(i==my_rank)
     do
       do_printf
     done

      ******* barrier ********
  end for
done 
```

如果打印值的线程集不包括所有线程，只需将相关线程添加到屏障。

另一种方法是让每个线程将其输出写入专用文件。这边走 ：

1.  您不必访问障碍
2.  您不会丢失任何线程的 printfs
3.  你的输出是明确的。因此在调试程序时不会造成混乱。

代码 ：

```
sprintf(my_op_file_str, "output%d", myThreadID);
close(1)
open(my_op_file_str)

Now use printf's anywhere you may like. 
```

# java - 平衡检查永远不会在 Avl 树插入中终止

> ID：10201336
> 
> 赞同：1
> 
> 时间：2012-04-18T00:57:33.443
> 
> 标签：java, binary-search-tree, avl-tree

为我的数据结构课程编写一个 AVL 树来保存泛型；在我的 add() 方法中，在实际插入一个元素之后，我会通过它的祖先检查他们的分数。对于最初的几个添加，它可以工作，但是（大概是在确实需要进行平衡的地方），备份路径的循环无法终止。我已经尝试了我能想到的一切来确保树的父节点的根没有被设置为另一个节点或类似的东西。我将平衡分数计算为右减左，所以正数表示树右重，负数表示左重。这是我的添加（）：

```
public void add(T e){
    if (e == null)
        return;
    if (root == null) {
        root = new TNode<T>(null, e);
        return;
    }
    boolean added = false;
    TNode<T> current = root;
    while (current != null && added != true) {  //insertion loop
        if (current.compareTo(e) == 0)
            return;
        else if (current.compareTo(e) < 0) {
            if (current.getRight() == null) {
                current.setRight(new TNode<T>(current, e));
                added = true;
            }
            else                
                current = current.getRight();
        }   
        else if (current.compareTo(e) > 0) {
            if (current.getLeft() == null) {
                current.setLeft(new TNode<T>(current, e));
                added = true;
            }
            else
                current = current.getLeft();
        }
    }
    if (useAVL == false)
        return;

    //balancing, checking up from added node to find where tree is unbalanced; currently loop does not terminate
    //current is now parent of inserted node
    while (current.hasParent()) {       
        if (current.getAvl() > 1) {
            if (current.getRight().getAvl() > 0)
                current = rotateLeft(current);
            else if (current.getRight().getAvl() < 0) {
                current.setRight(rotateRight(current.getRight()));
                current = rotateLeft(current);
            }
        }
        if (current.getAvl() < -1) {
            if (current.getLeft().getAvl() < 0)
                current = rotateRight(current);
            else if (current.getLeft().getAvl() > 0) {
                current.setLeft(rotateLeft(current.getLeft()));
                current = rotateRight(current);
            }
        }
        current = current.getParent();
    }
    root = current;
    root.setParent(null);
} 
```

这是正确的旋转方法：

```
private TNode<T> rotateRight(TNode<T> old) {
    TNode<T> oldRoot = old;
    TNode<T> newRoot = old.getLeft();
    TNode<T> rightChildNewRoot = newRoot.getRight();    //was right child of what will become root, becomes left child of old root
    newRoot.setRight(oldRoot);
    oldRoot.setParent(newRoot);
    oldRoot.setLeft(rightChildNewRoot);
    if (rightChildNewRoot != null)
        rightChildNewRoot.setParent(oldRoot);
    newRoot.setParent(oldRoot.getParent());
    return newRoot;
} 
```

# php - preg_match 中的符号是什么意思？

> ID：10201337
> 
> 赞同：7
> 
> 时间：2012-04-18T00:58:11.767
> 
> 标签：php, preg-match

我在离线借用的代码片段中有这个表达式。它强制新用户的密码不仅需要大写+小写+数字，而且必须按照这个顺序！如果我输入低+大+数字，它会失败！

```
if (preg_match("/^.*(?=.{4,})(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z]).*$/", $pw_clean, $matches)) { 
```

我在网上搜索过，但找不到能告诉我某些字符含义的资源。我可以看到模式是 preg_match("/some expression/",yourstring,your match)。

**这些是什么意思：**

```
1\.  ^          -  ???
2\.  .*         -  ???
3\.  (?=.{4,})  -  requires 4 characters minimum
4\.  (?.*[0-9]) -  requires it to have numbers
5\.  (?=.*[a-z])-  requires it to have lowercase
6\.  (?=.*[A-Z])-  requires it to have uppercase
7\.  .*$        -  ??? 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-18T04:44:08.630

以下是直接答案。我把它们写得很短，因为如果不了解正则表达式，它们就没有意义。这种理解最好在regular-expressions.info 中获得。我建议您也尝试那里列出的[正则表达式帮助工具](http://www.regular-expressions.info/tools.html)，它们允许您进行实验 - 在您编辑模式时查看实时捕获/匹配，非常有帮助。

* * *

1：插入符号`^`是一个锚点，它的意思是“草垛/字符串/线的开始”。

*   如果插入符号是字符类中的第一个符号`[]`，则它具有不同的含义：它否定类。（所以在`[^ab]`插入符号中使该类匹配任何*不是*ab的东西）

2：点`.`和星号`*`有两个不同的用途：

*   点匹配除换行符以外的任何单个字符`\n`。
*   星号表示“允许零个或多个前面的类型”。

当这两者结合起来时，`.*`它基本上读作“零个或多个任何东西，直到换行符或其他规则生效”。

7：美元`$`也像插入符号一样是锚，功能相反：“大海捞针”。

* * *

**编辑：**

围绕某事物的简单括号`( )`使其成为一个*组*。在这里你有`(?=)`一个断言，特别是一个*积极的前瞻性断言*。它所做的只是检查里面的内容是否从大海捞针中的当前光标位置向前移动。还在我这儿？
**示例：** 仅当后跟 时才`foo(?=bar)`匹配。从不匹配，只返回。`foo``bar``bar``foo`

考虑到这一点，让我们剖析您的正则表达式：

```
/^.*(?=.{4,})(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z]).*$/

Reads as:
        ^.* From Start, capture 0-many of any character
  (?=.{4,}) if there are at least 4 of anything following this
(?=.*[0-9]) if there is: 0-many of any, ending with an integer following
(?=.*[a-z]) if there is: 0-many of any, ending with a lowercase letter following
(?=.*[A-Z]) if there is: 0-many of any, ending with an uppercase letter following
        .*$ 0-many of anything preceding the End 
```

您说密码字符的顺序很重要-在我的测试中并不重要。请参阅下面的测试脚本。希望这能解决一两件事。如果您正在寻找另一个更宽容的正则表达式，请参阅[正则表达式密码验证](https://stackoverflow.com/questions/5023599/regex-password-validation)

```
<pre>
<?php
// Only the last 3 fail, as they should. You claim the first does not work?
$subjects = array("aaB1", "Baa1", "1Baa", "1aaB", "aa1B", "aa11", "aaBB", "aB1");

foreach($subjects as $s)
{
    $res = preg_match("/^.*(?=.{4,})(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z]).*$/", $s, $matches);
    echo "result: ";
    print_r($res);

    echo "<br>";
    print_r($matches);
    echo "<hr>";
} 
```

用于检查和测试正则表达式的优秀在线工具： [https ://regex101.com/](https://regex101.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T11:50:00.880

要首先使用正则表达式，您需要学习语法。这种语法由一系列字母、数字、点、连字符和特殊符号组成，我们可以使用不同的括号将它们组合在一起。

查看此链接[Getting Started with PHP Regular Expressions](http://www.noupe.com/php/php-regular-expressions.html)。学习正则表达式的简单方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-18T01:00:06.633

如果你不知道这个网站，你应该立即去那里。

这就像正则表达式的圣经。

[正则表达式.info](http://www.regular-expressions.info/)

# ios5 - NSUrlConnectionDelegate 不调用方法来加载数据

> ID：10201339
> 
> 赞同：0
> 
> 时间：2012-04-18T00:58:17.020
> 
> 标签：ios5, asynchronous

我已经查看了[NSURLConnectionDelegate connection:didReceiveData not working](https://stackoverflow.com/questions/2824993/nsurlconnectiondelegate-connectiondidreceivedata-not-working)，但似乎没有任何好的结果，所以我很好奇为什么我无法获取任何数据。

我在`didReceiveResponse`and中设置了断点`didReceiveData`。

它确实打印出“连接成功”，所以我知道连接已启动。

我正在使用 ARC 进行内存管理。

```
- (void)load {
        request = [NSMutableURLRequest requestWithURL:myURL
                                                           cachePolicy:NSURLRequestReloadIgnoringLocalCacheData
                                                       timeoutInterval:60];

    NSURLConnection *conn = [[NSURLConnection alloc] initWithRequest:request delegate:self];
    if (conn) {
        [conn start];
        NSLog(@"connection succeeded, %s", [myURL description]);  
        responseData = [NSMutableData data];
    } else {
        NSLog(@"connection failed");
    }
}

- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response {
    responseData = [[NSMutableData alloc] init];
}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {
    [responseData appendData:data];
} 
```

**更新：**

要了解我如何测试它，请查看[SenTestCase 未调用异步单元测试](https://stackoverflow.com/questions/10184056/asynchronous-unit-test-not-being-called-by-sentestcase)。

我确实实现了 jonkroll 提到的两种方法，在他的回答中，我只是没有展示它们，但是，它们也没有被调用。

我添加`[conn start]`只是因为它不起作用，我希望这可以解决它，但没有这样的运气。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T01:49:31.713

当您像这样声明您的连接时：

```
NSURLConnection *conn = [[NSURLConnection alloc] initWithRequest:request delegate:self]; 
```

您正在创建一个本地指针。当你的方法完成时，因为它是对 的最后一个强引用，所以`NSURLConnection`释放`ARC`它。您需要使用强大的 ivar（和/或）属性来保持对`NSURLConnection`您创建的强大引用。

**编辑**

这是我在示例项目中测试的基本代码示例。试一试。详细日志记录会有所帮助。

```
@implementation <#Your class here#> {
    // With ARC ivars are strong by default 
    NSMutableData *_downloadedData;
    NSURLConnection *_connection;
}
-(void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response{
    NSHTTPURLResponse *realResponse = (NSHTTPURLResponse *)response;
    if (realResponse.statusCode == 200){ 
        // Really any 2** but for example
        _downloadedData = [[NSMutableData alloc] init];
        NSLog(@"Good response");
    } else {
        NSLog(@"Bad response = %i",realResponse.statusCode);
    }
}
-(void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data{
    if (connection == _connection){
        [_downloadedData appendData:data];
        NSLog(@"Getting data...");
    }
}
-(void)connectionDidFinishLoading:(NSURLConnection *)connection{
    if (connection == _connection){
        _connection = nil;
        NSLog(@"We're done, inform the UI or the delegates");
    }
}
-(void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error{
    _connection = nil;
    NSLog(@"Oh no! Error:%@",error.localizedDescription);
}
- (void)load {
    NSURL *url = [NSURL URLWithString:@"http://www.google.com/"];
    NSURLRequest *request = [NSMutableURLRequest requestWithURL:url
                                      cachePolicy:NSURLRequestReloadIgnoringLocalCacheData
                                  timeoutInterval:60];
    // Assign strong pointer to new connection
    _connection = [[NSURLConnection alloc] initWithRequest:request delegate:self];
    NSLog(@"Connection was initialized? = %@",(!!_connection)?@"YES":@"NO");
}
@end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T01:26:40.950

NSURLConnection 方法`initWithRequest`从 url 开始对数据的异步请求。因为请求是异步完成的，所以您不能期望以调用请求的相同方法处理响应。相反，您需要在 NSURLConnection 的委托回调方法中这样做。您已经实现了`didReceiveResponse:`and `didReceiveData:`，但还有其他一些对您有用的。

如果你想查看响应的内容，你应该这样做`connectionDidFinishLoading:`

```
- (void)connectionDidFinishLoading:(NSURLConnection *)connection
{
    // response is complete, do something with the data
    NSLog(@"%@", responseData);
} 
```

您的代码打印出“连接成功”这一事实并不意味着请求成功，只是表示成功创建了 NSURLConnection 对象。要测试连接是否有问题，您可以实现委托方法`connection:didFailWithError:`

```
- (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error
{
    NSLog(@"Connection failed! Error - %@ %@",
          [error localizedDescription],
          [[error userInfo] objectForKey:NSURLErrorFailingURLStringErrorKey]);
} 
```

也没有必要打电话`[conn start]`。当您调用时，请求将自动启动`initWithRequest:`

我建议阅读 Apple 关于[Using NSURLConnection](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/URLLoadingSystem/Tasks/UsingNSURLConnection.html)的文档以获取更多详细信息。

# mysql - 按数字顺序拥有主键在性能方面有什么优势吗？

> ID：10201341
> 
> 赞同：0
> 
> 时间：2012-04-18T00:58:23.077
> 
> 标签：mysql, indexing

我有一个运行 MISAM 的 MySQL 数据库。我正在用另一个程序处理大量数据......问题是它不会用数字顺序的键输出它。

两个问题......是否有任何性能损失：

1.  使用 data infile 加载主键随机顺序的数据（但仍然是数字和唯一的）？
2.  查询那个主键？

似乎主键查找总是比索引查找快...我不确定这是否是因为主键通常按数字顺序排列。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T01:08:22.713

在我所知道的大多数数据库中，您“看到”的顺序可能与数据库系统实际存储数据的方式没有任何关系，所以不，让您的主键“按顺序”不会为您做任何事情. 您的数据库很可能已经以某种优化的顺序存储它们。

现在，关于您对索引的评论，主键通常也是索引。索引可以提高性能，但它取决于许多因素，例如数据库的大小、数据的变化量等。我不是dba，所以我不能给你一个完美的答案。没有任何特定顺序的数字主键将比基于字符的主键更快，因为总是可以更快地搜索数字。

# javascript - 是否可以创建一个使用选择器名称的 jQuery 函数？

> ID：10201342
> 
> 赞同：2
> 
> 时间：2012-04-18T00:58:27.100
> 
> 标签：javascript, jquery

我正在尝试以一种形式为“剩余字符数”创建一个计数器：

```
<input type="text" id='username_input'>
<input type="text" id='password_input'> 
```

是否可以创建一个参数将成为选择器一部分的函数？因此，您可以更好地理解我的问题，我将向您展示一个我做过的示例，但这不起作用。

我正在尝试做的事情似乎很明显。这意味着我必须标准化所有 id。我知道我可以在函数中创建一个 maxChar 参数，但我留下了错误`field+'_maxChar'`，以便您可以告诉我为什么它不可能。

非常感谢提前

```
var username_maxChar=20,password_maxChar=30;

function countLeft(field,minCharacters){
$('#'+field+'_input').keyup(function(){
    var input_length = $('#'+field+'_input').val().length;
    var input_count = field+'_maxChar' - input_length;
    $('#'+field+'_counter').text(input_count);

    }); 
    }

countLeft(username,6); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T01:02:22.357

由于您`var`在函数范围之外使用关键字定义了这些，因此它们成为`window`对象的属性并且可以使用`[]`表示法访问：

```
var input_count = window[field + '_maxChar'] - input_length; 
```

但是，您可能会考虑只使用该`maxlength`属性：

```
<input type="text" id='username_input' maxlength='20'>
<input type="text" id='password_input' maxlength='30'> 
```

这些可通过 jQuery 获得`.attr()`

```
var input_count = $('#' + field + '_input').attr('maxlength') - input.length; 
```

# javascript - Globals 的注册表模式 | 验证

> ID：10201344
> 
> 赞同：4
> 
> 时间：2012-04-18T00:58:39.750
> 
> 标签：javascript

对于下面的代码，我想使用模块模式来保持成员私有并通过 getter 访问它们。它是如此简单，无需在构造函数中进行任何初始化。这个可以吗？

```
/**
 *Global - in process of removing
 */

var Globals = ( function () 
{
    var globals = 
    {
        tag_array:          [],
        load_on:            0,
        current_tag:        0,             
        TIME:               4000,
        PASS:               0,
        FAIL:               1,
        NOTDEFINED:         2
    };
    var GlobalsInternal = function ( ) 
    {
    };
    GlobalsInternal.prototype.get = function( type ) 
    {
        return globals[ type ];
    };
    return GlobalsInternal;
} () ); 
```

**利用**

```
new Globals().get( 'TIME' ); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T01:01:02.780

JavaScript 没有类。

所以没有构造函数意味着没有构造函数，空的构造函数仍然是构造函数。

因此，如果`new X`需要，则`X` *必须*评估为构造函数（它实际上只是一个知道如何在上下文中表现的函数）。

无论如何，这都是“好的”。请记住，只有一个名为 by 的对象`globals`（并且它在`get`具有这样名称的函数中被封闭）。

* * *

（我认为 josh3736 的答案只是一个“全局转储”的优点。JS 中全局命名的对象*是*其他 OO 语言意义上的单例。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T01:10:24.833

简单地做有什么问题：

```
var Globals = {
        tag_array:          [],
        load_on:            0,
        current_tag:        0,             
        TIME:               4000,
        PASS:               0,
        FAIL:               1,
        NOTDEFINED:         2
    }; 
```

然后就

```
Globals.TIME 
```

老实说，您的示例似乎使事情变得不必要地复杂化，并且试图将经典 OO 强加到 JavaScript 上，*这不是经典的 OO 语言*。

# c - 在 C 中使用动态数组进行 bsearch

> ID：10201345
> 
> 赞同：1
> 
> 时间：2012-04-18T00:59:12.010
> 
> 标签：c, arrays, binary-search, dynamic-arrays, bsearch

您好，我的 bsearch() 函数有一些问题。我收到“访问冲突读取位置”异常。我使用它如下：

```
typedef char **arstr;

int compareexp(const void *a, const void *b){ 
    return strcmp(*(const arstr)a, *(const arstr)b);
}

binsrch = bsearch(&key, file_array, linecount, WORDMAX+2, compareexp); 
```

**'file_array'**是我的动态字符串数组，包含 2401 个元素。从 *.txt 文档导入的每个元素最长为 22 个字符。

**'linecount'**是整数 2402，指的是同一 *.txt 文档中的行号。

**'WORDMAX'**定义为 20

我真的不明白我的功能失败的原因。我猜 linecount 或 WORDMAX 的值有问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T01:10:52.360

从类似的示例中查看示例后，您似乎可能在比较中缺少 * 或 WORDMAX +2 不是正确的方法。尝试更改该 WORDMAX 以获取您正在使用的结构的大小。

# ajax - Primefaces Ajax 调用 Javascript

> ID：10201346
> 
> 赞同：2
> 
> 时间：2012-04-18T00:59:13.570
> 
> 标签：ajax, jsf, primefaces

我想知道你是否可以在 ajax 语句中调用 javascript，特别是我试图让以下工作。

```
 <p:commandLink id="saveButton" value="Save" >
            <p:ajax event="click" actionListener="#{bean.saveButtonPressed()}" />
            <p:ajax event="click" actionListener="if(#{cbean.showSaveOverlay}){saveOverlay.show();}" />
        </p:commandLink> 
```

并且 showSaveOverly 在 saveButtonPressed 中设置。

知道我会怎么做吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-18T02:25:32.427

使用 PrimeFaces 提供的[`RequestContext`](http://www.primefaces.org/showcase/ui/misc/requestContext.xhtml)API。

首先标准化您的 ajax 侦听器：

```
<p:ajax event="click" listener="#{cbean.showSaveOverlay}" /> 
```

然后相应地将脚本添加到`RequestContext#getScriptsToExecute()`动作侦听器方法中：

```
public void showSaveOverlay() {
    if (...) {
        RequestContext.getCurrentInstance().getScriptsToExecute().add("saveOverlay.show()");
    }
} 
```

如果您还没有使用 PrimeFaces 7.0，请`RequestContext#execute()`改用：

```
public void showSaveOverlay() {
    if (...) {
        RequestContext.getCurrentInstance().execute("saveOverlay.show()");
    }
} 
```

# joomla - 页面上的 CloudFlare 错误

> ID：10201348
> 
> 赞同：2
> 
> 时间：2012-04-18T00:59:23.373
> 
> 标签：joomla, cloudflare

在我的域上使用 cloudflare 时，我似乎遇到了错误。无论我做什么它都不会消失，我尝试关闭 cloudflare 和我的 joomla CP 中的各种选项，使用 jbetolo 来缩小、合并和压缩 js 和 css 文件。

错误如下：`Failed to Load Resource` `http://website.com/cdn-cgi/pe/bag?r[]=http%3A%2F%2Fwebsite.com%3A80%2Fcdn-cgi%2Fnexp%2Fv%3D1443929931%2Fapps%2Fga_key.js` `cloudflare.min.js:35`

我找不到有关此错误的任何资源。这是控制台报告错误的更多输出。谁能告诉我为什么会发生这种情况，如何解决，或者这是否正常？谢谢。

`a.function.a.object.a.object.d.(anonymous function).object.d.(anonymous function).(anonymous function)cloudflare.min.js:37`

`a.function.a.object.a.object.d.(anonymous function).object.d.(anonymous function).(anonymous function)cloudflare.min.js:37`

浏览链接返回 405 Not Allowed 错误，我想这有点明显。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-03-11T19:10:54.407

对于其他正在寻找解决方案的人，将 SPEED 菜单下的“Rocket Loader”设置从“Automatic”更改为“Off”为我解决了这个问题。在“自动”模式下，我的 JavaScript 被包装在 CDATA 块中，这导致了错误，但禁用“Rocket Loader”会删除包装器。

请注意，您仍然可以在关闭“Rocket Loader”时使用 JavaScript 缩小。

[![CloudFlare 火箭装载机](../Images/c4d24a82f442ea7026bab21922562ba9.png)](https://i.stack.imgur.com/3aEC3.png)

发布时的“火箭装载机”仍处于 Beta 模式，因此可能存在一些错误。目前尚不清楚为什么一个 javascript 文件会导致问题，而其他文件不会。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T02:59:56.637

这似乎是由 CloudFlare 的 Auto Minify 选项引起的。你把这个关掉了吗？

注意：您不想使用另一个选项打开 CloudFlare 的缩小（肯定会看到问题）。

如果关闭 Auto Minify 无法解决问题，请与域[联系 CloudFlare ，我们可以让工程师检查一下。](http://support.cloudflare.com/cgi/discussion/new)

# python - GAE Channel API 安全吗？什么是底层实现？

> ID：10201350
> 
> 赞同：2
> 
> 时间：2012-04-18T00:59:43.363
> 
> 标签：python, security, google-app-engine, https, channel-api

我正在使用 GAE + Python 创建一个需要向客户端发送敏感数据实时更新的应用程序，我想知道[App Engine Channel API](https://developers.google.com/appengine/docs/python/channel/overview)是否安全。使用 HTTPS 就足够了，还是通道需要自己的安全协议？

[另外， App Engine Channel API](https://developers.google.com/appengine/docs/python/channel/overview)的底层实现是什么？Websockets，SSE？看起来它实际上只提供了一种通过通道从服务器到客户端的通信方式，然后让客户端使用标准的 HTTP 请求与服务器通信。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T05:29:25.943

与通道 API 的连接是通过 HTTPS 进行的，无论您的页面是如何加载的，因此不可能窃听通道 API 连接的内容。只要您对通道密钥保密，那么您的通道就是您的应用程序和客户端之间的安全通信通道。

通道是使用长轮询（彗星）实现的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T03:21:54.183

由于通道是服务器和客户端之间的长期有效连接，因此出于性能考虑，通道在许多情况下不允许使用资源消耗安全方法。正如[官方手册](https://developers.google.com/appengine/docs/python/channel/overview)中所声明的，服务器只通过HTTP请求接收来自客户端的更新消息。据我所知，即使 Dropbox 也通过 HTTP 发送其长期通知消息，使用非常短的通知来判断是否有新内容。

幸运的是，有两种方法可以确保您的安全。

1.  仅在某些状态发生变化时通过 HTTP 通道通知您的客户端。之后，让客户端决定是否应该发出一个可以是安全通信的进一步请求。这是最常用的渠道使用方式。

2.  虽然这不是我个人推荐的方式，但是你可以自己加密你的数据，然后把这些加密的数据放在不安全的 HTTP 通道上运行。

# javascript - 如何在 javascript 中访问父函数闭包？

> ID：10201367
> 
> 赞同：2
> 
> 时间：2012-04-18T01:01:26.613
> 
> 标签：javascript, scope, closures

在以下情况下，我将如何访问父函数“var”变量（我只能编辑重置函数的定义）：

```
_.bind(function(){
    var foo = 5;

    var reset = function(){
        foo = 6;  //this changes foo,
        bar = 7;  //**I want this to add another "var", so I don't pollute global scope
    }
    reset();
    console.log(foo); //6
    console.log(bar); //7
}, window); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T01:03:11.257

对不起，但你不能。

访问命名空间的唯一方法是`with`语句。

例如，如果您*能够*重写整个内容，则*可以*这样完成：

```
_.bind(function(){
    var parentNamespace = {
        foo: 5,
    };

    with (parentNamespace) {
        var reset = function(){
            foo = 6;  //this changes foo,
            parentNamespace.bar = 7;  //**I want this to add another "var", so I don't pollute global scope
        }
        reset();
        console.log(foo); //6
        console.log(bar); //7
    }
}, window); 
```

但这是~~最有可能的~~几乎可以肯定是个坏主意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T01:03:51.967

这对你有用吗？

```
_.bind(function(){
    var foo = 5, bar;

    var reset = function(){
        foo = 6;  //this changes foo,
        bar = 7;  //**I want this to add another "var", so I don't pollute global scope
    }
    reset();
    console.log(foo); //6
    console.log(bar); //7
}, window); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T01:59:00.353

我不确定我是否理解你的问题，所以我的答案可能不是你想要的。

```
var reset = function(){
    foo = 6;  
    reset.bar = 7;   
}
reset.bar = 13;
reset();  // reset.bar is back to 7. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T03:14:25.570

ECMA-262 明确地阻止访问函数的变量对象（函数实际上不必有一个，它们只需要表现得好像它们有），所以你不能访问它。

您只能通过在适当的范围内声明变量或将它们包含在*FunctionDeclaration*或*FunctionExpression*的形式参数列表中来添加属性，没有其他方法。

# windows-phone-7 - 当我使用渐变画笔作为背景时，我得到了条纹

> ID：10201368
> 
> 赞同：1
> 
> 时间：2012-04-18T01:01:31.530
> 
> 标签：windows-phone-7, lineargradientbrush

我正在为电话页面背景使用渐变画笔，但我没有得到平滑的渐变，而是在背景中得到彩色边缘。边缘大约 16 像素宽。我只是在使用。

```
 <Grid.Background>
        <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
            <GradientStop Color="#FF489048" Offset="0" />
            <GradientStop Color="#FF489048" Offset="1" />
            <GradientStop Color="#FFB7DBB7" Offset="0.5" />
        </LinearGradientBrush>
    </Grid.Background> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T01:53:12.223

您需要在您的 WMAppManifest.xml 文件中稍作更改，该文件可以在 Properties 文件夹中找到。

确保在 App 标签中设置每像素位数，如下所示：

```
<App BitsPerPixel="32" ... > 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T04:18:15.367

由于 LCD 屏幕的类型，WP7 手机目前使用 16 位系统。一个像素得到：5 位代表红色，5 位代表蓝色，6 位代表绿色（人类看到的绿色光谱范围更广）。这个问题的唯一好的解决方案是......停止使用导致“条纹”的渐变，但有时它可能会提供良好的用户体验。

# mysql - 如何在vb中搜索和更新记录mysql

> ID：10201369
> 
> 赞同：0
> 
> 时间：2012-04-18T01:01:35.537
> 
> 标签：mysql, vb.net

我在搜索和更新记录数据库 sql 时遇到问题。这是我的代码。我使用 mysql 数据库和 Microsoft Visual Basic 2008

```
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click

    Dim t As New Threading.Thread(AddressOf closeMsgbox)
    objconn = New MySqlConnection("server=localhost;database=AAA;userid=root;password= 'root'")
    Dim username As Boolean = True
    objconn.Open()
    Dim sqlquery As String = "SELECT * FROM daftar WHERE nid = '" & FormRegister.TextBox1.Text & "';"
    Dim data As MySqlDataReader
    Dim adapter As New MySqlDataAdapter
    Dim command As New MySqlCommand
    command.CommandText = sqlquery
    command.Connection = objconn
    adapter.SelectCommand = command
    data = command.ExecuteReader
    If data.HasRows() = True Then
        While data.Read()
            FormRegister.Show()
            tkhupd = Now.ToString("yyyy-MM-dd HH:mm:ss")
            command.Connection = objconn
            command.CommandText = "UPDATE visitor SET tkhupd  ='" & tkhupd & "' WHERE                      nokp = '" & FormRegister.TextBox1.Text & "';"
            command.ExecuteNonQuery()
            MessageBox.Show("You're has logout")
            FormRegister.TextBox1.Text = ""
            username = False
            Me.Close()
        End While
    Else
        FormRegister.Show()
        username = True
    End If
    data.Close()
    If username = True Then
        Dim sqlquery2 As String = "INSERT INTO visitor (nid)VALUES ('" & FormRegister.TextBox1.Text & "')"
        Dim data2 As MySqlDataReader
        Dim adapter2 As New MySqlDataAdapter
        Dim command2 As New MySqlCommand
        command2.CommandText = sqlquery2
        command2.Connection = objconn
        adapter2.SelectCommand = command2
        data2 = command2.ExecuteReader
        MessageBox.Show("You're has login")
        Form4.Show()
        FormRegister.TextBox1.Text = ""
        Me.Close()
    End If
End Sub 
```

但我在 Word 命令上有错误。ExecuteNonQuery(): MySqlException was unhandled。已经有一个打开的 DataReader 与此 Connection 关联，必须先关闭它

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T14:01:53.867

我会在一次调用数据库中完成这一切，包括两个语句。我更习惯 Sql Server，所以这个语法可能有点不对，但看起来像这样：

```
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click

    Dim sqlquery As String = _
         "DECLARE @RowCount Int;" & _
         " UPDATE FROM visitor v" & _
            " INNER JOIN daftar d ON d.nid = v.nokp" & _
            " SET v.tkhupd = current_timestamp" & _
            " WHERE d.nid = ?NID;" & _
         " SELECT row_count() INTO @RowCount;" & _
         " IF @RowCount = 0 THEN " & vbCrLf & _
            " INSERT INTO visitor (nid) VALUES (?NID);" & vbCrLf & _
         " END IF"

    Using conn As New MySqlConnection("server=localhost;database=AAA;userid=root;password= 'root'"), _
          cmd As New MySqlCommand(sqlquery, conn)

        cmd.Parameters.Add("?NID", MySqlDbTypes.Int).Value = Integer.Parse(FormRegister.TextBox1.Text)
        conn.Open()
        cmd.ExecuteNonQuery()
    End Using
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T01:05:32.230

您需要使用一个单独的`MySqlCommand`对象，比如`command2`在您的`While`语句中，因为`command`它已经在使用中：

```
Dim command2 As New MySqlCommand
..
While data.Read()
    ..
    command2.Connection = objconn
    ..
End While 
```

# vb.net - 将文本颜色分配给单个下拉框列表项

> ID：10201379
> 
> 赞同：0
> 
> 时间：2012-04-18T01:02:32.127
> 
> 标签：vb.net, winforms, visual-studio-2010

这是 VB 中的 WinForms 应用程序。在我的应用程序中，我试图让用户更容易根据项目文本颜色快速选择列表中的项目。所以我试图使用如下的 select case 语句为每个项目分配颜色......问题是我收到一条错误消息，提示“未找到类型‘字符串’的公共成员‘属性’。” VB 用 Attribute.Add 参数标记行并出现此错误。这是我目前拥有的代码...

```
 For Each u In _units
                _counter += 1
                u_lookupNumber_box.Items.Add((Convert.ToString(u.UnitId)) + " - " + (Convert.ToString(u.perMonthCost)))
                Select Case u.occupied
                    Case Is = 0
                        u_lookupNumber_box.Items(_counter - 1).Attributes.add("style", "color: Yellow")
                    Case Is = 1
                        u_lookupNumber_box.Items(_counter - 1).attributes.add("style", "color: Green")
                    Case Is = 2
                        u_lookupNumber_box.Items(_counter - 1).attributes.add("style", "color: Red")
                    Case Is = 3
                        u_lookupNumber_box.Items(_counter - 1).attributes.add("style", "color: Blue")
                    Case Is = 4
                        u_lookupNumber_box.Items(_counter - 1).attributes.add("style", "color: Orange")
                    Case Is = 5
                        u_lookupNumber_box.Items(_counter - 1).attributes.add("style", "color: Purple")
                End Select
            Next 
```

任何想法为什么我会收到此错误？我确实注意到，当我点击“。”时，我做了 .attributes 部分。并键入“att”它没有出现在 vb 的 intelisense 框中。这让我觉得我需要先以某种方式将名称“attributes”分配给下拉框。感谢所有帮助...

需要注意的是 u_lookupNumber_box 是我表单上下拉框的名称..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T01:49:47.813

`attributes`不是[`ListBox.Items`](http://msdn.microsoft.com/en-us/library/system.windows.forms.listbox.items.aspx)属性的方法。查看[`ListBox.ObjectCollection`](http://msdn.microsoft.com/en-us/library/system.windows.forms.listbox.objectcollection.aspx)Class 文档，它提供了一个`OwnerDrawn ListBox`. 我相信这个或类似的东西将是你唯一的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T02:14:05.777

好的，那么长的面包屑搜索和一些试验和错误，我让它完全工作......由于 drawItem 事件 arg 的不断处理，我对它不太满意，但除此之外它按预期工作。 .. 首先，我将下拉菜单的 DrawMode 属性设置为 OwnerDrawFixed。然后在我的表单类中创建了一个结构，如下所示：

```
Public Structure ColoredUnitItem
    Dim text As String
    Dim color As Color
    Dim bold As Boolean
    Public Overrides Function ToString() As String
        Return text
    End Function
End Structure 
```

这实际上将包含每个项目的所有属性..

接下来，我将原始发布的代码更改为以下内容：

```
For Each u In _units
                _counter += 1
                Dim myItem As New ColoredUnitItem
                With myItem
                    .text = (Convert.ToString(u.UnitId)) + " - " + (Convert.ToString(u.perMonthCost))
                    Select Case u.occupied
                        Case Is = 0
                            .color = Color.Yellow
                        Case Is = 1
                            .color = Color.Green
                        Case Is = 2
                            .color = Color.Red
                        Case Is = 3
                            .color = Color.Blue
                        Case Is = 4
                            .color = Color.Orange
                        Case Is = 5
                            .color = Color.Purple
                    End Select
                End With
                u_lookupNumber_box.Items.Add(myItem)
            Next 
```

接下来，我只需在表单上绘制下拉列表，如下所示：

```
Private Sub uLookUpNumberBox_Draw(ByVal sender As Object, ByVal e As System.Windows.Forms.DrawItemEventArgs) Handles u_lookupNumber_box.DrawItem
    e.DrawBackground()
    If Not e.Index = -1 Then
        Dim myItem As ColoredUnitItem = DirectCast(u_lookupNumber_box.Items(e.Index), ColoredUnitItem)
        Dim FontToUse As Font = e.Font
        If myItem.bold Then
            FontToUse = New Font(e.Font, FontStyle.Bold)
        End If
        e.Graphics.DrawString(myItem.text, FontToUse, New SolidBrush(myItem.color), e.Bounds)
        e.DrawFocusRectangle()
    End If
End Sub 
```

流程很容易遵循并且确实有效..

# .net - LINQ 查找部分匹配项

> ID：10201383
> 
> 赞同：0
> 
> 时间：2012-04-18T01:03:11.233
> 
> 标签：.net, linq

有来自 OCR 的单词，并且需要一个紧密匹配的列表。没有maxFrom也可以。示例代码是蛮力的，但希望它定义了要求。针对 600,000 的列表，这需要 2 秒。FTSword.Word 是一个字符串。

理想情况下，“findd”只会给第二个 d 额外的功劳。一旦它找到一个 i 那么 f 就没有信用了。蛮力我可以做到的。我希望减少 2 秒。将测试并报告提出的任何解决方案。

问题？？是。如何让它更快？（更聪明）

谢谢

```
 char[] find = new char[] { 'f', 'i', 'n', 'd' };
            char[] word;
            int maxFrom = 10;
            int minMatch = 3;
            int count;
            List<FTSword> matchWords = new List<FTSword>();
            foreach (FTSword ftsw in fTSwords)
            {
                if (ftsw.Word.Length < maxFrom)
                {
                    word = ftsw.Word.ToCharArray();
                    count = 0;
                    foreach (char fc in find)
                    {
                        foreach (char wc in word)
                        {
                            if (char.ToLower(wc) == char.ToLower(fc))
                            {
                                count++;
                                break;
                            }
                        }
                    }
                    if (count >= minMatch)
                    {
                        // Debug.WriteLine(count.ToString() + ftsw.Word);
                        matchWords.Add(ftsw);
                    }
                }
            }
            Debug.WriteLine(matchWords.Count.ToString()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T03:44:55.263

您当前的核心算法是 O(n^2)，因为您有两个嵌套循环来寻找匹配的字符。您可以使用包含字符串中每个字符的字符计数的 Dictionary 轻松地制作该部分 O(n) `find`：

```
string find = "find";
var findMap = new Dictionary<char, int>();
foreach (char c in find)
{
    if (findMap.ContainsKey(c))
    {
        findMap[c] = findMap[c] + 1;
    }
    else
        findMap.Add(c, 1);
}
//findMap is pre-generated once

string word = "pint";
int count = 0;

//runs for each word in list, now in O(n)
foreach(char c in word)
{
    int charCount;
    if(findMap.TryGetValue(c, out charCount))
    {
        if(charCount > 0)
        {
            charCount--;
            findMap[c] = charCount;
            count++;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T04:09:53.127

`char.ToLower()`如果在开始之前确保它是小写的，则可以删除on fc。

您也可以尝试使用`IndexOf()`来查找第一个（然后是随后出现的字符），因为 BCL 实现在内部可能比您使用自己的循环管理的速度更快。

您也可以尝试反向运行循环，这可以提供加速：

```
 for (int i = arr.Length - 1; i >= 0; i--) 
```

但实际上，对于 OCR，为什么要总结字符串中任意位置的匹配字符，而不是像[Damerau-Levenshtein](http://en.wikipedia.org/wiki/Damerau%E2%80%93Levenshtein_distance)那样进行真正的编辑距离？

# ruby-on-rails - 在heroku cedar错误的rails上部署ruby

> ID：10201384
> 
> 赞同：2
> 
> 时间：2012-04-18T01:03:12.680
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, deployment, heroku

我在部署时似乎遇到了真正的麻烦，我不太确定错误以及触发它的原因。一切似乎也在本地使用生产模式。请帮助我了解此错误并部署我的应用程序。

现在，我删除了 .git 文件夹并创建了一个新的 cedar 应用程序，然后再次尝试，但像往常一样有一些错误。但是，这次错误看起来不同。我的 gem 文件和最近的 heroku 日志如下；

**宝石文件**

```
source 'https://rubygems.org'
gem 'rails', '3.2.2'
group :test, :development do
  gem 'sqlite3'
  gem 'rspec-rails'
  gem 'factory_girl'
  gem 'spork'
  gem 'annotate', :git => "https://github.com/ctran/annotate_models.git"
end

group :production do
  gem 'pg'
  gem 'thin'
end
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'
  gem 'uglifier', '>= 1.0.3'
  gem 'haml'
end
gem 'jquery-rails'
gem 'heroku' 
```

**最近的日志**

```
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.3.1/lib/thin/connection.rb:38:in `receive_data'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.3.1/bin/thin:6:in `<top (required)>'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/bin/thin:19:in `load'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/bin/thin:19:in `<main>'
2012-04-18T13:59:38+00:00 app[web.1]: Completed 500 Internal Server Error in 128ms
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_view/lookup_context.rb:109:in `find'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal/compatibility.rb:50:in `render_to_body'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal/instrumentation.rb:39:in `render'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/abstract_controller/callbacks.rb:17:in `process_action'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/abstract_controller/rendering.rb:45:in `process'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/journey-1.0.3/lib/journey/router.rb:56:in `call'
2012-04-18T13:59:38+00:00 app[web.1]: Processing by PagesController#home as HTML
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/session/abstract/id.rb:200:in `call'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_dispatch/middleware/callbacks.rb:27:in `call'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/lock.rb:15:in `call'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.3.1/lib/thin/server.rb:159:in `start'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_view/renderer/template_renderer.rb:29:in `determine_template'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal/instrumentation.rb:40:in `block (2 levels) in render'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/abstract_controller/base.rb:167:in `process_action'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.2/lib/active_support/notifications.rb:123:in `block in instrument'
2012-04-18T13:59:38+00:00 app[web.1]: 
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal.rb:246:in `block in action'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.2/lib/active_record/connection_adapters/abstract/connection_pool.rb:443:in `call'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_view/renderer/renderer.rb:36:in `render_template'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.2/lib/active_support/core_ext/benchmark.rb:5:in `block in ms'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal/rendering.rb:10:in `process_action'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.2/lib/active_support/notifications/instrumenter.rb:20:in `instrument'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_dispatch/middleware/static.rb:61:in `call'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.3.1/lib/thin/connection.rb:80:in `block in pre_process'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_dispatch/routing/route_set.rb:67:in `call'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/etag.rb:23:in `call'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.3.1/lib/thin/controllers/controller.rb:86:in `start'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.2/lib/rails/rack/logger.rb:26:in `call_app'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:245:in `fetch'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.3.1/lib/thin/connection.rb:78:in `pre_process'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.3.1/lib/thin/runner.rb:151:in `run!'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_view/path_set.rb:58:in `find'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal/renderers.rb:28:in `render_to_body'
2012-04-18T13:59:38+00:00 app[web.1]: ):
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/abstract_controller/rendering.rb:103:in `render_to_body'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_view/renderer/template_renderer.rb:10:in `render'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal/instrumentation.rb:83:in `cleanup_view_runtime'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.2/lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.2/lib/active_record/railties/controller_runtime.
rb:18:in `process_action'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/journey-1.0.3/lib/journey/router.rb:68:in `block in call'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.2/lib/active_record/railties/controller_runtime.rb:24:in `cleanup_view_runtime'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.2/lib/active_support/callbacks.rb:81:in `run_callbacks'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/abstract_controller/base.rb:121:in `process'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/journey-1.0.3/lib/journey/router.rb:56:in `each'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal/rendering.rb:16:in `render'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal/implicit_render.rb:5:in `send_action'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_view/renderer/abstract_renderer.rb:3:in `find_template'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/abstract_controller/rendering.rb:88:in `render'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal/implicit_render.rb:10:in `default_render'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_dispatch/middleware/flash.rb:242:in `call'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.2/lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/runtime.rb:17:in `call'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/session/abstract/id.rb:205:in `context'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.2/lib/active_support/callbacks.rb:81:in `run_callbacks'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.2/lib/rails/application.rb:220:in `call'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.2/lib/active_record/query_cache.rb:64:in `call'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal/rescue.rb:29:in `process_action'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_controller/metal.rb:203:in `dispatch'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_dispatch/routing/route_set.rb:594:in `call'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_dispatch/middleware/cookies.rb:338:in `call'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.2/lib/rails/engine.rb:479:in `call'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/eventmachine-0.12.10/lib/eventmachine.rb:256:in `run_machine'
2012-04-18T13:59:38+00:00 app[web.1]: 
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/eventmachine-0.12.10/lib/eventmachine.rb:256:in `run'
2012-04-18T13:59:38+00:00 app[web.1]: 
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:136:in `forward'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.3.1/lib/thin/connection.rb:78:in `catch'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor
/bundle/ruby/1.9.1/gems/thin-1.3.1/lib/thin/runner.rb:185:in `run_command'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.2/lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.2/lib/active_support/cache/strategy/local_cache.rb:72:in `call'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.2/lib/rails/railtie/configurable.rb:30:in `method_missing'
2012-04-18T13:59:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.3.1/lib/thin/backends/base.rb:61:in `start'
2012-04-18T13:59:38+00:00 app[web.1]: cache: [GET /] miss
2012-04-18T13:59:38+00:00 app[web.1]: cache: [GET /favicon.ico] miss, store
2012-04-18T13:59:38+00:00 heroku[router]: GET k6skrd.herokuapp.com/favicon.ico dyno=web.1 queue=0 wait=0ms service=7ms status=200 bytes=0
2012-04-18T14:01:49+00:00 heroku[web.1]: State changed from up to bouncing
2012-04-18T14:01:49+00:00 heroku[web.1]: State changed from bouncing to created
2012-04-18T14:01:49+00:00 heroku[web.1]: State changed from created to starting
2012-04-18T14:01:51+00:00 heroku[web.1]: Stopping process with SIGTERM
2012-04-18T14:01:57+00:00 heroku[web.1]: Starting process with command `bundle exec thin start -R config.ru -e production -p 13819`
2012-04-18T14:01:59+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/01/04/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:5)
2012-04-18T14:01:59+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/01/04/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:5)
2012-04-18T14:02:01+00:00 heroku[web.1]: Error R12 (Exit timeout) -> Process failed to exit within 10 seconds of SIGTERM
2012-04-18T14:02:01+00:00 heroku[web.1]: Stopping process with SIGKILL
2012-04-18T14:02:03+00:00 heroku[web.1]: Process exited with status 137
2012-04-18T14:02:03+00:00 app[web.1]: >> Thin web server (v1.3.1 codename Triple Espresso)
2012-04-18T14:02:03+00:00 app[web.1]: >> Maximum connections set to 1024
2012-04-18T14:02:03+00:00 app[web.1]: >> Listening on 0.0.0.0:13819, CTRL+C to stop
2012-04-18T14:02:04+00:00 heroku[web.1]: State changed from starting to up 
```

您的帮助将不胜感激。预先感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T01:35:58.970

测试从 Gemfile 中删除 gem 'thin'

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T01:29:19.170

嗯，我刚刚访问了您的网站，但它已关闭，但出现了一个奇怪的 404 页面。检查日志并立即查看。另外，尝试重新启动。这听起来很愚蠢，但谁知道呢。也许您的瘦设置也是错误的？

# php - 当我手动为 $_POST 数组赋值时，为什么 filter_input() 返回 NULL？

> ID：10201395
> 
> 赞同：6
> 
> 时间：2012-04-18T01:04:26.860
> 
> 标签：php, filter, validation

我正在关注一些关于数据验证的练习，并决定搞乱这个`filter_input()`功能。当我尝试运行此代码时：

```
$_POST['var'] = 10;

$filtered = filter_input(INPUT_POST, 'var', FILTER_VALIDATE_FLOAT);

var_dump($filtered); 
```

`var_dump($filtered)`返回 NULL。我知道如果`$_POST['var']`通过提交表单为代码分配了一个值，那么代码就可以工作，但我只是想知道为什么手动为`$_POST[]`数组分配一个值不会返回`float(10)`？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-18T01:06:38.523

`filter_input()`不从 _POST/_GET/_COOKIE/_SERVER/_ENV 超全局数组中读取。它分别从这些值的原始来源中读取（也用于填充超全局变量）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-18T01:19:49.907

这是因为`INPUT_POST`对原始 POST 值起作用，在您的脚本中对它们的修改无效。但是，如果要过滤该 var，可以使用：

```
filter_var($_POST['var'], FILTER_VALIDATE_FLOAT); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T01:14:29.160

如果要设置默认输入值和过滤器，请使用`filter_var`. 因为 filter_input 不过滤超全局变量的当前值。

# python - 使用 xml.dom.minidom 从 Mysql XML 转储中提取数据

> ID：10201398
> 
> 赞同：1
> 
> 时间：2012-04-18T01:04:52.573
> 
> 标签：python, mysql, xml, dom, minidom

我使用 phpmyadmin 将 mysql 数据库导出到 xml，现在我想用 minidom 解析它，但我无法以我需要的形式获取内容。

摘要：我需要将变量分配给`title`其中包含的文本`<column name="news_title">This is the title</column>`

提取的数据库如下所示：

```
<pma_xml_export version="1.0" >
    <database name="dbname">
        <!-- Table newsbox -->
        <table name="newsbox">
            <column name="news_id">1</column>
            <column name="news_title">This is the title</column>
            <column name="news_text">This is the news text</column>
            <column name="date">Thu, 28 Feb 2008 20:10:30 -0500</column>
            <column name="author">author</column>
            <column name="category">site_announcement</column>
        </table>
    </database>
</pma_xml_export> 
```

我可以使用以下脚本提取文本，但它不是我需要的形式：

```
doc = parseString(document)

pmaexport = doc.getElementsByTagName("pma_xml_export")[0]
columns = pmaexport.getElementsByTagName("column")

for item in columns:
    name = item.getAttribute("name")
    text = item.firstChild.data.strip()
    print name, text 
```

我需要的是可以将这些元素的文本内容分配给可以传递的变量的东西，例如，

```
for item in columns:
    title = ???
    text = ???
    date = ???
    author = ??? 
```

如果 db 输出的形式是`<title>Here's the Title</title>`我将有很多示例可以关闭，但我找不到任何类似的参考`<column name="news_title">This is the title</column>`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T01:10:05.787

我已经有一段时间没有使用了`xml.dom.minidom`，但这应该可以工作......

```
columns = [c.firstChild.data for c in pmaexport.getElementsByTagName('column') if c.getAttribute('name') == 'news_title'] 
```

另外，例如，列表理解！

# jquery - jquery验证插件addClass到无效字段

> ID：10201400
> 
> 赞同：0
> 
> 时间：2012-04-18T01:05:05.340
> 
> 标签：jquery, plugins, validation

有没有办法为使用 jquery 的验证插件时返回无效的表单的所有输入添加一个类？

如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T01:17:43.530

正如 Surreal Dreams 所说，验证器插件会自动将错误类应用于失败的字段。但是你可以自定义这个。您可以在验证代码中使用几个钩子（与错误相关的和其他的）[。](http://docs.jquery.com/Plugins/Validation/validate#options)以下是与您的问题相关的几个：

*   `errorClass`

    > “使用此类创建错误标签，查找现有错误标签并将其添加到无效元素中。”

*   `errorPlacement`

    > “自定义创建的错误标签的位置。第一个参数：创建的错误标签作为 jQuery 对象。第二个参数：无效元素作为 jQuery 对象。”

这是一个例子：

```
$("whatever").validate({
    errorClass: "yourErrorClassHere",
    errorPlacement: function(error, element) {
        // You can do all sorts of stuff to the individual error elements, like adding classes
    }
}); 
```

# javascript - Fancybox v2：未显示加载动画

> ID：10201401
> 
> 赞同：0
> 
> 时间：2012-04-18T01:05:22.560
> 
> 标签：javascript, jquery, fancybox

在我的场景中，我链接到相当大的图像（尺寸和文件大小）。可以理解的是，fancybox 必须加载几秒钟才能显示它们。问题是加载动画没有显示出来，所以当用户点击缩略图时，它给人的印象是什么都没有发生。Fancybox 最终会在几秒钟后出现。

还有一个次要问题。通过“rel”属性将图像设置为显示为画廊。即使用户正在查看一个图像，浏览到下一个图像也需要一段时间（同样，由于文件大小），但由于 throbber 没有出现，似乎 prev/next 按钮不起作用。有任何想法吗？

我应该补充一点，我正在使用fancybox v2。

我的代码（当然包括必要的 css 和用于 fancybox 和按钮助手的脚本之后）： http: [//pastebin.com/u3g8U8FS](http://pastebin.com/u3g8U8FS)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T19:52:57.947

Updating to the latest version (2.0.6) did the trick.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T05:23:15.873

确保文件`fancybox_loading.gif`以及`fancybox_sprite.png`文件与文件位于同一文件夹`jquery.fancybox.css`中

# ios - 无法在 Xcode 4.3.2 中构建，因为退出代码 254 导致 clang 失败

> ID：10201404
> 
> 赞同：1
> 
> 时间：2012-04-18T01:05:50.173
> 
> 标签：ios

我突然开始在 LLVM 3.1 编译器中遇到以下错误。请帮助您了解如何调试它。请让我知道我是否应该为此发布更多信息。

命令 /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang 失败，退出代码为 254

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T17:18:10.463

在我搞砸了一些字符串处理后，我最终得到了同样的错误：Broken:

```
// 7.30.12 Unspaced/Original - remove windows \r, replace with " " (space) - let textbox wrap
// [mutTempString setstring: [mutTempString stringByReplacingOccurrencesOfString:@"\r" withString:" "]];
// 7.30.12 - Need some 'padding' at the top of the textbox (I copied and pasted above and generated the !code 254 error)
[mutTempString setString:[NSString stringWithFormat:@"\n\n%@", [mutTempString setString:[mutTempString stringByReplacingOccurrencesOfString:@"\r" withString:" "]]]]; 
```

我摆脱了 'nested' 或 'deep-inline' [mutable setstring...] 并且一切都恢复正常了：修复：

```
// 7.30.12 - Need some 'padding' at the top of the textbox (remove the 'inside' setstring)
[mutTempString setString:[NSString stringWithFormat:@"\n\n%@", [mutTempString stringByReplacingOccurrencesOfString:@"\r" withString:" "]]]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T09:23:10.940

我也通过调用不在 Objective-C 中的方法得到了这个错误

**我正在使用：**

```
NSString *redirectUrl = [NSString stringWithFormat:@"%@%@", @"http", **components[2]**]; 
```

并意识到这是一种访问数组值的 PHP 方式。

**所以我把它改成这样：**

```
NSString *redirectUrl = [NSString stringWithFormat:@"%@%@", @"http", [components objectAtIndex:2]]; 
```

现在它工作正常：D

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T05:51:32.313

好的，所以我自己调试了这个问题，因为这是一篇没有答案的帖子，我想我会解释一下我是如何解决它的。

在我的情况下，错误是由于**试图获取没有分配标签的 UIImageView 的标签引起的。**

首先我尝试了明显的解决方案： - 退出 xcode 和模拟器，重新打开，再次尝试构建 - 重新启动计算机，重新打开，再次尝试构建 - 执行清理（cmd + shift + K）。这些都不起作用，所以我回顾了我在代码中所做的看似无辜的更改。

这导致了崩溃：

```
if (!([[buttonsArray objectAtIndex:i] tag] > 299 )) {
   //NSLog(@"removed [buttonsArray removeObjectAtIndex:i]:%@",[buttonsArray removeObjectAtIndex:i]);
   [buttonsArray removeObjectAtIndex:i];
} 
```

这没有：

```
if ([[buttonsArray objectAtIndex:i] class] != [UIButton class] ) {
   //NSLog(@"removed [buttonsArray removeObjectAtIndex:i]:%@",[buttonsArray removeObjectAtIndex:i]);
   [buttonsArray removeObjectAtIndex:i];
} 
```

我的数组包含 3 个 UIButton，每个都有大于 299 的标签和一个 UIImageView。数组的 NSLog 显示：

```
2012-05-10 01:46:14.555 My Application[542:fe03] buttonsArray:(
    "<UIImageView: 0x6b7f940; frame = (0 0; 252 272); opaque = NO; userInteractionEnabled = NO; layer = <CALayer: 0x6b71dc0>>",
    "<UIButton: 0x6b7ae70; frame = (8 8; 53 53); opaque = NO; tag = 300; layer = <CALayer: 0x6b6fb70>>",
    "<UIButton: 0x6b8be00; frame = (69 8; 53 53); opaque = NO; tag = 301; layer = <CALayer: 0x6b8bd70>>",
    "<UIButton: 0x6b8c1b0; frame = (130 8; 53 53); opaque = NO; tag = 302; layer = <CALayer: 0x6b8c140>>"
) 
```

所以问题是 UIImageView 没有分配给它的标签。当我试图将其符号与 299 进行比较时，编译器抛出了这个错误。我认为这没关系（我在某处读到未分配标签默认为 0），但我猜不是！

# android - 如何在按下两个按钮的情况下制作吐司消息

> ID：10201406
> 
> 赞同：-5
> 
> 时间：2012-04-18T01:06:15.063
> 
> 标签：android, toast

如何用 2 个按钮制作敬酒消息...如果按两个按钮然后敬酒消息...请帮帮我...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T01:42:15.643

Toast 永远不会获得焦点。这个想法是尽可能不引人注目。看到这个链接：http: [//developer.android.com/reference/android/widget/Toast.html](http://developer.android.com/reference/android/widget/Toast.html)

您可能想要使用 alertdialog 而不是 toast。看到这个链接：http: [//developer.android.com/guide/topics/ui/dialogs.html#AlertDialog](http://developer.android.com/guide/topics/ui/dialogs.html#AlertDialog)

# emacs - 只为 font-lock-keywords 中的关键字指定新的背景颜色

> ID：10201408
> 
> 赞同：3
> 
> 时间：2012-04-18T01:06:28.690
> 
> 标签：emacs, emacs-faces

我想突出显示具有特定背景颜色的代码的某些部分，但我希望其余代码突出显示保持在原位。即，关键字仍应通过 font-lock 突出显示为关键字，只是它们的背景应该改变。

目前，我正在使用 font-lock-add-keywords 进行此操作，其中正则表达式匹配我想要突出显示的任何内容，并且对于每个匹配项，它都会预先定义如下定义的面：

```
(:background "#d1eaff") 
```

但是当它添加这个面时，它并没有保留之前的前景色等属性，而只是使用带有这个背景色的默认面。

有没有办法让它使用当前的面孔并且只用新的面孔替换它们的背景颜色？喜欢为现有面孔添加新属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T02:10:22.607

您正在寻找的是`overlays`.

以下代码片段将`compilation-error`在当前缓冲区中的字符 1 到 3 上添加人脸：

```
(overlay-put (make-overlay 1 4)
             'face 'compilation-error) 
```

代替数字，您可以放置​​正则表达式搜索的结果或用于确定覆盖边界的任何内容。

# xml - 使用 xPath 获取包含粗体标签的锚点？

> ID：10201410
> 
> 赞同：1
> 
> 时间：2012-04-18T01:06:41.373
> 
> 标签：xml, parsing, xpath, html-parsing, domxpath

我正在使用 xpath，并且试图从如下所示的链接中获取锚文本：

```
<a href="http://link.com"><b>anchor</b> text</a> 
```

我尝试使用 xPath 获取锚文本：

```
.//a/text() 
```

但我只得到“文本”，而不是“锚文本”。

**我如何获得全文？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T04:05:54.110

> ```
> .//a/text() 
> ```

包含“anchor”的文本节点的原因是因为该文本节点是子节点`b`——不是`a`. 上面的表达式只选择作为当前上下文节点后代的任何文本节点的*子节点。*`a`

**使用**：

```
.//a//text() 
```

这将选择作为当前上下文节点*后代*的所有`a`元素的后代的所有文本节点。

# javascript - 自定义图像洗牌器不起作用？

> ID：10201412
> 
> 赞同：1
> 
> 时间：2012-04-18T01:07:03.120
> 
> 标签：javascript

基本上，我想做的是使用一些 JavaScript 代码对图像进行洗牌。它所做的只是将当前图像的显示样式更改为`block`，同时将之前的图像更改为`none`。

HTML 代码：

```
<body>
<img src="http://bit.ly/yOqqbg" id="image1" style="display: block;">
<img src="http://bit.ly/dezBUZ" id="image2" style="display: none;">
<img src="http://bit.ly/IvM5HE" id="image3" style="display: none;">
</body>​ 
```

JavaScript 代码：

```
var id = ["image1", "image2", "image3"]; //Array with the id's in the document you want        
to shuffle through
var i = 0; //Set inital array element
initiateTimer(); //Get the loop going

function initiateTimer() {       
if (i > id.length) {
    i = 0;
    initiateTimer();
}
setTimeout(function() { changeElement(); }, 2000); //2000 = 2 seconds
}

function changeElement() {  
if (id === 0) {
    document.getElementById(id[2]).style.display = 'none';
    document.getElementById(id[i]).style.display = 'block';
} else {
    document.getElementById(id[i - 1]).style.display = 'none';
    document.getElementById(id[i]).style.display = 'block';
}
i += 1;
initiateTimer();
} ​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T01:13:31.853

当`i === 3`你遇到问题时

```
if (i > id.length) { 
```

应该成为

```
if (i >= id.length) { 
```

更新：http: [//jsfiddle.net/HgNuc/](http://jsfiddle.net/HgNuc/)

# c - 整数表示为浮点数，需要澄清

> ID：10201416
> 
> 赞同：3
> 
> 时间：2012-04-18T01:07:18.307
> 
> 标签：c, floating-point, number-formatting

拿

```
int x = 5;
float y = x;

//"I know it's a float .. you know it's a float .. but take it's address
// and pretend you're looking at an integer and then dereference it"

printf("%d\n", *(int*)&y); //1084227584 
```

**为什么我看到这个号码？**

*   二进制中的 5 是`0101`
*   5 可以被认为是`(1.25 * 2^2)`，这意味着

可以表示为：

```
[sign bit]                              - 0
[8 bits worth of exp] - 129 (129-127=2) - 1000|0001
[23 bits of .xxxxxxx] - 25              - 1100|1 
```

放在一起，我有

```
[sign bit][8 bits worth of exp][23 bits worth of .xxx]
0         10000001             11001000000000 //2126336 
```

请问我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T01:35:38.263

其他人指出它不可移植......但您已经知道这一点，并且您已经指定了 64 位 OS X。基本上，您的尾数错误。`1.25`用 的隐式前导位表示`1.0`。尾数的第一个显式位表示`0.5`和第二个位`0.25`。所以尾数实际上是：`01000000000000000000000`。

符号位`0`和有偏指数`10000001`，后跟尾数给出： `0x40a00000`这是`1084227584`十进制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T01:25:19.900

**为什么我看到这个号码？**因为您将浮点数打印为 int。

我知道，我知道，您显然已经知道这一点，但最重要的是行为是未定义的。在您的系统上，整数和浮点数的大小相同吗？您是否查看过编译器用于存储浮点的标准？

# android - Android，使动态生成的表格行可点击

> ID：10201418
> 
> 赞同：0
> 
> 时间：2012-04-18T01:07:53.720
> 
> 标签：android, android-layout, android-dialog, android-tablelayout

我试图在单击我的表格行时显示一个对话框。我的表格行是动态生成的，有 3 个列。1 个 ImageView 和 2 个 TextView。

我的表格行是由这个循环生成的

```
for (i = 0; i < name.length; i++) 
{
    tr = new TableRow(this);

    ImageView iv = new ImageView(this);
    tr.setClickable(true);
    tr.setOnClickListener(this);
    try {
        url = new URL(image_url[i]);
    } catch (MalformedURLException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    InputStream content = null;
    try {
        content = (InputStream)url.getContent();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    Drawable d = Drawable.createFromStream(content , "src"); 
    iv.setImageDrawable(d);
    tr.addView(iv,new LayoutParams(150,150));
    tv2 = new TextView(this);
    tv3 = new TextView(this);

    tv2.setText(name[i]);
    tv3.setText(location[i]);

    tv2.setPadding(10, 0, 0, 0);

    tv3.setPadding(10, 0, 0, 0);
    tr.setPadding(0, 1, 0, 1);

    tr.addView(tv2); // add TextView to row.
    tr.addView(tv3); // add TextView to row.

    tl.addView(tr);
} 
```

我已经尝试了很多方法来使行可点击，但似乎没有任何效果。onclicklistner 方法调用我在代码中定义的 onClick() 方法，但它从未被调用。请让我知道我可以通过什么方式在单击特定行时调用显示对话框方法。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T01:21:21.067

好吧，我怀疑您没有`View.OnClickListener`在您的类中实现接口，您将其作为“this”传递给`tr.setOnClickListener(this);`您不应该自己调用 onClick。

你应该做

```
class MyActivity implements View.OnClickListener {

@Override
public void onClick(View view) {

 // your click event
}

//for loop with dynamically generated rows
public void createTable() {
 // your code with tr.setOnClickListener(this); 
} 
```

# android - 是否可以从 android 活动运行 ui 自动化？

> ID：10201421
> 
> 赞同：1
> 
> 时间：2012-04-18T01:08:03.987
> 
> 标签：android, automation, monkeyrunner

我做了很多搜索，很多帖子都在谈论从主机工作站 (PC) 向连接的设备发送 UI 事件（如触摸、按键）。

我的问题是，我需要从设备启动自动化测试，我没有要测试的 apk 的源代码访问权限。我查看了robotium，它修改了apk的签名签名以进行仪器测试，但我的客户禁止我修改包。

我的问题是，是否可以在 android 活动中使用猴子跑步者（或猴子）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T01:58:31.430

不，这超出了应用程序的权限。如果您的设备已植根，理论上您可以这样做。

# java - 如何使用用户输入退出无限循环？

> ID：10201426
> 
> 赞同：1
> 
> 时间：2012-04-18T01:08:49.413
> 
> 标签：java

这听起来像是以前被问过的，但它与规范有点不同。我不想要典型的（用户运行程序后，我希望它问“你想再去一次吗？”）。我想启动一个进程（通过键入我已经完成的某个字符串）并让它运行无限时间，直到用户停止它。没有办法知道它会运行多长时间。这个程序恰好是一个计时器。所以我需要它来计算它运行了多长时间，能够在任何给定时刻被用户停止，并打印出它运行了多长时间。

截至目前，我没有使用任何 UI/GUI。保持尽可能简单。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T01:13:10.453

设置关闭挂钩（JVM 停止时运行的代码）：

```
Runtime.getRuntime().addShutdownHook(new Thread(new Runnable() {
    @Override
    public void run() {
        // print stuff here
    }
})); 
```

让用户`ctrl``c`在命令行中键入以停止执行 - 当 JVM 关闭时，您的钩子将运行以打印您喜欢的内容。

### 编辑：

以上是残酷但简单的，但是如果您不想终止整个 JVM，那么您将进入“服务器事件”的领域来驱动行为，这可以采取多种形式来引发动作：

*   在单独的线程中运行您的工作任务并等待终端上的命令以停止（或其他操作）该线程 - 这是我首先尝试的，这样做对您来说非常有教育意义
*   监视文件系统以查找文件的存在/不存在（蹩脚，但它可以使用最少的代码）
*   监听消息的端口，Web 服务器的 HTTP 端口通常是首选武器，但我们开始在服务器端变得更重
*   监控 JMS 队列中的消息 - 我们现在处于 Java EE 空间中，但更加繁重
*   您希望实施的任何其他“状态变化”

### 编辑2：

这是一个使用关闭钩子工作的最小实现（从命令行开始，然后按`ctrl``c`结束并运行计算代码）：

```
public static void main(String[] args) throws Exception {
    final long start = System.currentTimeMillis();
    Runtime.getRuntime().addShutdownHook(new Thread(new Runnable() {
        @Override
        public void run() {
            double hours = (System.currentTimeMillis() - start) / 3600000d;
            System.out.println("Please enter the hourly rate");
            double hourlyRate = new Scanner(System.in).nextDouble();
            System.out.format("Program ran for %01.3f hours and cost $%02.2f", hours, hourlyRate * hours);
        }
    }));
    Thread.sleep(Long.MAX_VALUE); // Sleep "forever"
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T01:36:17.037

你能不能用 daemon true 启动一个线程，然后在 System.input 中读取一行，然后中断线程。`java.util.Timer`也是可能的。

# javascript - javascript正则表达式地址编号

> ID：10201427
> 
> 赞同：0
> 
> 时间：2012-04-18T01:08:52.823
> 
> 标签：javascript, regex

我正在创建一个网站，我正在使用 javascript 来验证信息这是我遇到 address_number 问题的代码错误是无效的地址号

如果还有其他错误请说

谢谢 =)

```
function validateForm()
{
    var form = document.forms['inputForm'];
    var formats = 
        {
            first_name: /^[a-zA-Z]+[\-'\s]?[a-zA-Z]+$/,                             /*works for a-Z allows - and '*/
            surname: /^[a-zA-Z]+[\-'\s]?[a-zA-z]+$/,                                /*works for a-Z allows - and '*/
            postcode: /^\d{4}$/,                                                    /*4digit post code australia wide*/
            email: /^\w+([\.-]w+)*@\w+([\.-]?\w+)*(\.\w{2,4})+$/,                   /*allows all word characters and normal email formats*/
            address_number: /^\d[0-9]{\?12}$/,                                                  /*allows any number of digits*/
            address_name: /^\w?\s?[a-zA-Z]+(,?\s([a-zA-Z])*)*$/,            /*allows numbers space capital letters and other word characters*/
            suburb: /^\w?\s?[a-zA-Z]+(,?\s([a-zA-Z])*)*$/,          /*allows numbers space capital letters and other word characters*/
            phone: /^\d{10}$/,                                                      /*8 number phone number*/
            length: /^\d[0-9]$/,
            height: /^\d[0-9]$/,
        }
        var length = form.length.value;
        var height = form.height.value;
        var area = length*height;

        var elCount = form.elements.length;
        for(var i = 0; i<elCount; i++)
        {
            var field = form.elements[i];
            if(field.type == 'text')
            {
                if(!formats[field.name].test(field.value))
                {
                    alert('invalid '+ field.name.replace('_',' ')+'.');             /*alerts the name of the area not filled right in a pop up box*/
                    field.focus();
                    return false;
                }
            }
        }
        alert('All fields correct, the form will now submit.')
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T01:12:07.687

`\d+`应该是任何数字，至少一次，但喜欢，只要你喜欢。

# objective-c - iOS Obj-C。提出正确的解决方案？

> ID：10201428
> 
> 赞同：9
> 
> 时间：2012-04-18T01:08:54.443
> 
> 标签：objective-c, ios

我在我的应用程序中的一个地方，基本上每个 ViewController 都有一个本地 NSManagedObjectContext：

```
@property (strong, nonatomic) NSManagedObjectContext *managedObjectContext; 
```

并且每个 segue 通过同一个 setter 传递 managedObjectContext

```
[segue.destinationViewController setManagedObjectContext:self.managedObjectContext]; 
```

来自 Java，很容易创建每个 ViewController 实现的抽象类。在 Objective-c 中，这似乎是不可能的。我想做的是有一个基类来执行这个传递，但基本上任何实现 UIViewController 的东西都会有这个（包括一个普通的 UIViewController 和一个 UITableViewController）。创建一个冒充 UIViewController 的“抽象”类是否可能/正确？

更新：

UIViewController+ManagedObjectContext.h

```
@interface UIViewController (ManagedObjectContext)
@property (strong, nonatomic) NSManagedObjectContext *managedObjectContext;
@end 
```

UIViewController+ManagedObjectContext.m

```
#import "UIViewController+ManagedObjectContext.h"
@implementation UIViewController (ManagedObjectContext){
    NSManagedObjectContext *context;    // This is not valid, cant have local variables
}
@synthesize managedObjectContext; // This is not valid, must be @dynamic
-(void)setManagedObjectContext:(NSManagedObjectContext *)context{
    //How do you have a local NSManagedObjectContext?
}
@end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T01:52:47.473

您可以使用属性创建自己的子类`UIViewController`，比如说。然后让所有其他视图控制器成为子类而不是直接子类化。`MOCViewController``managedObjectContext``MOCViewController``UIViewController`

如果你真的想用一个类别来做，你的类别可以`objc_setAssociatedObject`用来将托管对象上下文附加到视图控制器。

如果你真的只有一个托管对象上下文并且你只是到处传递它，考虑把上下文放在你的应用程序委托的一个属性中，或者放在一个全局变量中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-18T02:04:09.723

您可以从托管对象获取 managedObjectContext 而不是单独传递它。通常，传递托管对象更合乎逻辑。

例如：假设您有一个名为 thing 的托管对象，您可以通过调用来获取 managedObjectContext

```
NSManagedObjectContext *moc=[thing managedObjectContext]; 
```

或者，您可以从应用程序委托中获取托管对象上下文：

```
AppDelegate *delegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];
NSManagedObjectContext *moc = delegate.managedObjectContext; 
```

# bash - 如何在 bash 中快速滚动到命令历史的最新/结尾？

> ID：10201430
> 
> 赞同：11
> 
> 时间：2012-04-18T01:09:10.660
> 
> 标签：bash

很多时候我会使用 Ctrl-R 进行反向搜索并错误输入一些字母。Bash 跳了数百行，而我正处于一周前使用的命令的中间。

有没有跳回我输入的最新命令的快捷方式？

编辑：在 CentOS 服务器和 Mac OS X 上对其进行测试后，看起来这只发生在 OS X 上。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-01-01T01:32:00.587

我一直在努力解决同样的问题。

您可以通过使用 ctrl-c 中止来解决此问题。无论您是在反向搜索中还是使用箭头滚动历史，中止都会在最后一个命令之后返回带有历史滚动的提示。

**更新**

这是我刚刚学到的一个不错的技巧。Bash 和许多其他程序在后台使用 Readline 进行命令行解释。可以在 .inputrc 文件中或使用 bind 命令配置 Readline 的键绑定。绑定可以利用 Readline 提供的一些功能。例如，我在 vi 模式下使用 Bash，但我仍然喜欢使用 Emacs 样式的 ctrl-A，所以我的 .bashrc 文件中有这一行：

绑定 '\Ca:beginning-of-line'

列出所有可用的 Readline 函数： bind -l

其中的功能是历史终结。该功能确实像它的名字所暗示的那样。这种方法与仅使用 abort 命令之间的区别在于，这使您始终处于相同的提示状态。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T01:17:17.357

如果使用 libreadline，Alt->（或 Meta->）。[有关Readline 快捷方式](http://www.bigsmoke.us/readline/shortcuts)的更多信息或在手册页中搜索*用于操作历史记录的命令。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-02-10T18:53:27.440

在 Mac 上，试试`command + .` 它对我有用。我正在尝试`alt+.`，`alt+shift+.`但都不适合我。然后发现`command + .`确实有效

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-10T00:55:02.823

您可能想尝试类似“建议框”的历史[HSTR](https://github.com/dvorka/hstr)。它读取 bash 历史记录并允许快速导航和过滤 - 您可以查看类似历史记录条目的上下文。一旦您选择了一个历史条目，就可以在命令行上对其进行编辑。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-18T01:11:51.017

也许不完全是您想要的，但是当您处于 CTRL-r（反向搜索）模式时，您可以通过使用退格来修复您输入错误的字符。

# php - PHP 性能：内存密集型变量

> ID：10201431
> 
> 赞同：0
> 
> 时间：2012-04-18T01:09:16.840
> 
> 标签：php, performance, memory

假设一个多维关联数组，当打印为带有 的文本时`print_r()`，会创建一个 470 KiB 的文件。如果每个用户的变量不同，假设所讨论的变量每个实例占用服务器内存的一半 MiB 是否合理？因此，如果 1000 个用户同时访问服务器，将消耗几乎半 GiB 的内存？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T01:48:11.080

IBM 有一篇关于这个主题的优秀文章：http: [//www.ibm.com/developerworks/opensource/library/os-php-v521/](http://www.ibm.com/developerworks/opensource/library/os-php-v521/)

更新

原来的页面被撤了，现在JP版本还在[https://www.ibm.com/developerworks/jp/opensource/library/os-php-v521/](https://www.ibm.com/developerworks/jp/opensource/library/os-php-v521/)

基本要点是，您可以使用它`memory_get_usage()`来检查您的脚本当前占用了多少内存：

```
// This is only an example, the numbers below will differ depending on your system
echo memory_get_usage () "\ n";. // 36640
$ A = str_repeat ( "Hello", 4242);
echo memory_get_usage () "\ n";. // 57960
unset ($ a);
echo memory_get_usage () "\ n";. // 36744 
```

此外，您可以使用`memory_get_peak_usage()`.

作为对您的问题的回答：`print_r()`是数据的表示，其中包含大量的文本和格式。占用的内存本身会小于 的字符数`print_r()`。多少取决于数据。你应该像上面的例子一样检查它。

无论您得到什么结果，都将针对每个执行脚本的用户，所以是的 - 如果 1000 个用户同时请求它，您将需要该内存。

# c# - 在 C# 中识别空对象

> ID：10201432
> 
> 赞同：3
> 
> 时间：2012-04-18T01:09:33.543
> 
> 标签：c#, xna

我正在进行一个方法调用，它将另外四个方法调用的结果作为参数——但是进行这些调用的方法可能为空，也可能不为空（抱歉，如果这是一个无法理解的句子）。这是代码，如果它使事情更清楚：

```
 public void Inform(Room north, Room south, Room east, Room west)
    {
        this.north = north;
        this.south = south;
        this.east = east;
        this.west = west;

        node.Inform(north.GetNode(), south.GetNode(),
                    east.GetNode(), west.GetNode());
    } 
```

基本上，我想知道是否有一种快速简便的方法来检查对象是否为空，并且只需将“空”传递给除条件之外的方法——我宁愿不必为空/的所有 16 种可能变体显式编码不为空。

编辑：为了应对混乱，我想澄清这一点：大多数情况下，我传递给方法的对象不会为空。通常，`Room`对象存在于北、南、东和西，如果`Room`存在，GetNode() 方法将返回适当的对象。我想确定一个给定的是否`Room`存在以避免在尝试进行方法调用时出现空引用异常。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-18T01:16:54.480

创建[扩展方法](http://msdn.microsoft.com/en-us/library/bb383977.aspx)

```
static Node GetNodeOrNull(this Room room)
{
  return room == null ? null : room.GetNode();
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-18T01:21:17.470

```
 public void Inform(Room north, Room south, Room east, Room west)
    {
        this.north = north;
        this.south = south;
        this.east = east;
        this.west = west;

        node.Inform(GetNode(north), GetNode(south),
                    GetNode(east),GetNode(west));
    } 

    private Node GetNode(Room room)
    {
        return room == null ?  null : room.GetNode();
    } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-18T01:12:20.027

忽略其余代码（我必须这样做:)）-您可以开始使用 Null 模式。例如，有一个 NullRoom 类并让它的 GetNode() 返回一些有意义的东西。基本上从不允许实际的空引用。

# java - 有没有办法在可运行对象中抛出 IOException ？

> ID：10201437
> 
> 赞同：1
> 
> 时间：2012-04-18T01:09:55.753
> 
> 标签：java

我有一些代码不起作用（这对我来说很常见），但是因为我没有收到错误，所以它只是继续使用错误数据运行。我认为的问题是它一直告诉我将部分代码包装在 try/catch 块中（我的测试是基本的，我只是在 try 区域输出一条消息，如果它被输出，我假设一切顺利。一切似乎都没有在我的代码中很好）。我了解在生产中，放置 try/catch 语句有助于代码继续运行，但它使我难以排除故障，因为我正在尝试排除我的代码部分。

有没有办法解决这个问题，这样我才能真正看到尝试区域内出现故障的时间？

这是我的代码示例：

```
 try {
        ByteArrayInputStream baos_back = new ByteArrayInputStream(message);
        ObjectInputStream oos_back = new ObjectInputStream(baos_back);
        i = oos_back.readInt();
        d = oos_back.readDouble();
        list_of_ints = (int[]) oos_back.readObject();
        oos_back.reset();
        baos_back.reset();
    } catch (ClassNotFoundException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T01:13:12.803

发生此错误时，您是否试图让您的程序崩溃？如果是这样，您应该能够将您的包裹`IOException`在 a 中[`RuntimeException`](http://docs.oracle.com/javase/6/docs/api/java/lang/RuntimeException.html)，然后将其扔掉。它们未经检查，因此您无需声明它们，它应该会很好地杀死您的程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T01:20:41.617

如果您希望您的代码抛出适当的异常，我建议您根本不要使用 try-catch 块。Try-catch 用于处理出现的异常，然后继续运行程序，但听起来你根本不想处理它们。

如果您确实想使用 try-catch 块，您总是可以在 catch 块的末尾手动抛出 RuntimeException 。就像是：

```
throw new IOException();
try {
    // Some code...
} catch(Exception e) {
    // Error handling code...
    throw new RuntimeException(e.getMessage());
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T01:40:40.823

正如我在评论中提到的，您可以使用一揽子 catch 语句捕获 Java 中的所有异常：

```
try {
    // code
} catch (Exception e) {
    e.printStackTrace();
} 
```

这将捕获块`Exception`中的每个抛出，`try`唯一不会捕获的东西是`Error`s。

在实践中，您会希望限制捕获的异常类型，并捕获更具体的异常，因此您可以将异常链如下：

```
try {
    // code
} catch (IOException ioe) {
    // we expected this
    ioe.printStackTrace();
} catch (SomeOtherException soe) { // just an example...
    soe.printStackTrace();
} catch (Exception e) {
    // Did we expect this? Maybe not!
    e.printStackTrace();
} 
```

上面还表明您预计会发生某些类型的异常，然后是一个笼统的笼统声明，可能会捕获您没有预料到的事情。

您还可以将异常记录到文件或其他内容中，而不是像现在此代码那样将它们输出到标准输出。一个基本的日志记录实用程序是[`java.util.logging`](http://docs.oracle.com/javase/7/docs/technotes/guides/logging/overview.html).

* * *

不过，我仍然建议学习使用调试器。调试器可以做很多事情，比如在抛出异常时暂停程序执行，并允许您在程序执行的任何时候检查变量和字段的值。如果您使用 Eclipse 或 Netbeans 或 IntelliJ 或其他 IDE，它们都有调试器。如果使用命令行，则有`jdb`命令行 java 调试器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T01:42:52.820

我建议编辑您的代码生成模板来执行此操作

```
catch ( $ExceptionClass e )
{
  // TODO: Autogenerated catch block
  e.printStackTrace();
  throw new RuntimeExcepton( e );
} 
```

这样你就有了一个 TODO 提醒，一个标准输出上的 barf，并确保如果你不提供正确的异常处理程序，你的程序将会崩溃。

# wix - 如何使用 WIX DTF 更新已安装产品信息？

> ID：10201446
> 
> 赞同：0
> 
> 时间：2012-04-18T01:11:16.930
> 
> 标签：wix, windows-installer, dtf

使用 DTF，我可以使用以下代码很好地安装产品。

```
 var product = (from p in ProductInstallation.AllProducts
                       where p.Publisher == CompanyName && p.ProductName == ProductName
                       select p).FirstOrDefault(); 
```

但是我要更新的属性没有设置器。喜欢版本。DTF 中的其他所有内容似乎都针对 MSI 而不是已安装的产品

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T11:10:02.450

它没有设置器，因为那没有意义如果我有 FOO.MSI 1.0 并安装它，它会在 MSI 中注册。为什么我应该能够告诉 MSI 它真的是 1.1？我必须获得 FOO.MSI 1.1 并执行升级才能做到这一点。

# c# - 覆盖 NCalc 中的“if”语句

> ID：10201449
> 
> 赞同：0
> 
> 时间：2012-04-18T01:11:58.053
> 
> 标签：c#, ncalc

我很难理解 NCalc，我有几个问题。

1) 如果我有一个像“if(CLOSE<2.3,ROC(OPEN),HIGH)”这样的表达式并且 ROC 是一个自定义函数。在评估条件“CLOSE<2.3”时，“ROC(OPEN)”的结果是否可用？

2）我如何覆盖“如果”语句？对于下面的情况，我想对“listOpen”中的每个元素进行条件检查。如果条件评估为 TRUE，则我需要从“listROC”返回条件评估为 true 的索引处的值，否则从 listHigh 返回相同索引处的值。

例子 ：

```
List<double> listResult =  new List<double>();
for(int index = 0; index< listClose.count;index++)
{
    if(listClose[index]<2.3)
         listResult.Add(listROC[index]);
    else
         listResult.Add(listHigh[index]);

}

return listResult; 
```

这是我试图评估表达式的示例代码。我坚持覆盖/定义自定义 if 语句。

```
 private List<double> listOpen = new List<double>();
    private List<double> listClose = new List<double>();
    private List<double> listHigh = new List<double>();
    public void PrepareData()
    {
        for (int index = 0; index < 10; index++)
        {
            Random rnd = new Random();
            double open = rnd.NextDouble() * (2.5 - 2.0) + 2.0;
            listOpen.Add(open);
            double close = rnd.NextDouble() * (2.5 - 2.0) + 2.0;
            listClose.Add(close);
            double high = rnd.NextDouble() * (2.5 - 2.0) + 2.0;
            listHigh.Add(high);

        }
    }
    private void EvaluateExpression()
    {
        PrepareData();

        Expression ex = new Expression("if(CLOSE<2.3,ROC(OPEN),HIGH)");
        ex.EvaluateFunction += delegate(string name, FunctionArgs args)
        {
            if (name == "ROC")
            {
                List<double> listROC = new List<double>();
                string argument = args.Parameters[0].Evaluate().ToString();
                List<double> listParam = new List<double>();
                switch (argument)
                {
                    case "OPEN":
                        listParam = listOpen;
                        break;
                    case "CLOSE":
                        listParam = listClose;
                        break;
                    case "HIGH":
                        listParam = listHigh;
                        break;
                }
                foreach (double dbl in listParam)
                {
                    double result = dbl * 2;
                    listROC.Add(result);
                }
                args.Result = listROC;
            }
            if (name == "if")
            {
               //Override the if function
            }
        };

        object ob = ex.Evaluate();
    } 
```

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-28T15:09:43.537

我的理解是：

1) 表达式被一起解析，然后根据深度进行评估。所以`if`谓词`CLOSE<2.3`将被评估为真，然后如果为真`ROC(OPEN)`将被评估。如果您在声明参数之前尝试使用参数，这将是一个问题 - 就像您编写自定义的情况一样`MAP(arg_array, callback([i]))`，它会解析`callback([i])`预期参数*从评估开始时就*`[i]`存在。

 *2) 只要​​您处理函数名称并设置结果，它就应该覆盖任何可能发生的本机处理。我犯了一个错误，即创建一个总是设置结果的便利处理程序（或者如果它无法识别该函数则抛出异常），这会在无法识别的`if`语句上抛出异常。`IF`您也可以始终使用（区分大小写）定义自己的 if 语句。

* * *

但我认为你的问题是`CLOSE`并且应该是静态值，因此`OPEN`应该像字符串一样转义。或声明为参数并进行相应处理。[https://ncalc.codeplex.com/wikipage?title=parameters](https://ncalc.codeplex.com/wikipage?title=parameters)`'CLOSE'``'OPEN'`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T04:44:54.103

无法弄清楚你想要达到的目标，也许如果你能解释更多，就能更好地帮助你。你不能覆盖“if”，如果你不希望行为像内置的那样在表达式中使用其他词，如 IF() 或 Filter()*

# sql - 以下实体关系模型的有效性？

> ID：10201452
> 
> 赞同：4
> 
> 时间：2012-04-18T01:12:14.850
> 
> 标签：sql, database-design, entity-relationship, er-diagrams

在我继续将我的实体关系图转换为 SQL 语句之前，我想我会问是否有人可以验证这个模型是否不包含一旦我拥有 SQL 数据库模式就会出现的任何荒谬和异常。

我特别不确定客户和 VIP 之间关系的基数。此外，供应商和 CD 的关系。**VIP 实体的start_date** - 它应该是弱键吗？**除了Song**实体的*name*属性之外，还有其他潜在的弱键吗？

 **![E/R 模型](../Images/6ad36d00066fb94e79cb59b4c11ac70e.png)

# 传奇

*   实体![在此处输入图像描述](../Images/4c0e1a9ec65bdbaeeb81eff47484c165.png)
*   属性![在此处输入图像描述](../Images/acf81b1ca581fa11ea0c5f8e029cb7c3.png)
*   弱实体![在此处输入图像描述](../Images/c485246f52838739ac3e81c9e2a51576.png)
*   关系![在此处输入图像描述](../Images/110c4654c28143508269667d82444bdb.png)
*   识别关系![在此处输入图像描述](../Images/78cd3da9dfd663007ab418a61baaf303.png)
*   基数比![在此处输入图像描述](../Images/710aac033615ab333a317e95a44f617a.png)

我使用以下网站作为参考来构建我的图表：

1.  [http://en.wikipedia.org/wiki/File:ERD_Representation.svg](http://en.wikipedia.org/wiki/File:ERD_Representation.svg)
2.  [http://en.wikipedia.org/wiki/Entity-relationship_model](http://en.wikipedia.org/wiki/Entity-relationship_model)
3.  [http://www.cse.ohio-state.edu/~gurari/course/cse670/cse670Ch2.xht](http://www.cse.ohio-state.edu/~gurari/course/cse670/cse670Ch2.xht)

用于创建图表的软件：[Dia (Linux)](http://projects.gnome.org/dia/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T02:32:28.870

抱歉，这是一个迟到的答案，但如果它有用，您可以进行两项改进。

1）“VIP”和“CUSTOMER”之间的“is-a”关系表示存在超类（客户）和子类（vip）。您可能希望将 VIP 建模为子类。

2）由于您正在跟踪关系“租金”的日期，因此必须“随时间”采用基数。因此双方的基数都是“N”（即，客户一方不是“1”）

小改进：在“Song”（弱实体类）中将部分标识符设置为“track”而不是“name”；这将允许在一张 CD 上对同一首歌曲进行多次录制（例如，2 个版本）。曲目编号在 CD 中始终是唯一的**

# ruby - 如何在执行 OCRA 打包的 Ruby 可执行文件时关闭控制台窗口？

> ID：10201453
> 
> 赞同：3
> 
> 时间：2012-04-18T01:12:15.510
> 
> 标签：ruby, windows

**背景：**
使用 OCRA 1.2 将 Ruby 脚本打包成可执行文件。

脚本结构如下：

```
begin
  <some code that runs for a while>
ensure
  <cleanup code>
end 
```

**问题：**
当我在 Windows 上运行可执行文件时，它会打开一个控制台窗口，并照常运行。如果我按 Ctrl-C，清理代码将运行。但是如果我要关闭控制台窗口，清理代码就不会运行。

无论如何，即使在这种情况下，是否也可以确保清理代码运行？

* * *

*旁注：我来自 Java 背景，第一次使用 Ruby。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T01:19:16.357

有点。您需要后台处理，但不幸的是（1）在 Windows IO.popen 下不是很可靠。（2）即使是 Windows“start /B”命令也只是在（共享）控制台中运行代码。

所以...如果你真的需要这个，并且你需要查看你的程序的输出，你会想要安装一个 Windows 服务。您可以将关键代码直接放入服务中，也可以将可执行文件的名称传递给它，瞧！它会在后台运行。

所以用户必须付出一些真正的努力来杀死应用程序，如果你需要程序的输出到控制台，你可以让服务返回必要的文本。

如果您不需要查看输出，您可以使用 ruby​​w.exe 运行应用程序并抑制控​​制台。`start rubyw my_app.rb`根据您的要求，您可能会让您的应用程序使用类似的东西启动第二个 .rb 文件。

可能不是您想要的答案，但应该可以。如果你真的，真的需要它。

# c# - C# hashtable 添加我自己创建的类

> ID：10201458
> 
> 赞同：1
> 
> 时间：2012-04-18T01:12:41.220
> 
> 标签：c#, hash, foreach, hashmap, hashtable

我从 excel 中读取数据并确定要执行的事件。

事件都是我自己创建的类（登录和注销）

如果我读取的值 = 1 ，则执行登录

如果我读取的值 = 2 ，则执行注销

我使用 switch 但我的老板说我必须在 Java 中使用 hashmap 之类的东西。

在 Java 中，我可以编写如下代码：

table.Add("one", login.class);

那么如何使用 c# 将类添加到哈希表中？

以及如何读取值并调用哈希表中的类方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T01:19:32.450

您可以使用委托。例如，如果您有以下方法：

```
public void Login() {
    // ...
}

public void Logout() {
    // ...
} 
```

你可以使用这个`Dictionary`：

```
Dictionary<string, Action> actions = new Dictionary<string, Action>() {
    {"Login", Login},
    {"Logout", Logout}
}; 
```

然后这样称呼它：

```
actions[myAction](); 
```

当然，您需要确保密钥存在。您可以以与调用常规方法几乎相同的方式调用委托。如果它们有参数或返回值，只需使用适当的`Action<T1, T2...>`or `Func<T1, T2... TOut>`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T01:35:07.357

实际上，C# 编译器会将`switch`字符串实现为哈希表，因此您不太可能通过手动执行来获得任何东西。

看到[这个帖子](https://stackoverflow.com/a/3366497/533120)。

你甚至可以告诉你的老板你已经做到了，而且你不会撒谎；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T03:05:30.450

以下代码允许您`DoSomething`在对象中实现一个方法，该方法可从 Dictionary 索引中调用：

```
public interface ICallable
{
    void Execute();
}

public class Login : ICallable
{
    // Implement ICallable.Execute method
    public void Execute()
    {
        // Do something related to Login.
    }
}

public class Logout : ICallable
{
    // Implement ICallable.Execute method
    public void Execute()
    {
        // Do something related to Logout
    }
}

public class AD
{
    Dictionary<string, ICallable> Actions = new Dictionary<int, ICallable>
    {
        { "Login", new Login() }
        { "Logout", new Logout() }
    }

    public void Do(string command)
    {
        Actions[command].Execute();
    }
} 
```

示例用法

```
AD.Do("Login"); // Calls `Execute()` method in `Login` instance. 
```

# wpf - 与 Dataview 的 WPF 绑定不起作用

> ID：10201467
> 
> 赞同：1
> 
> 时间：2012-04-18T01:13:23.787
> 
> 标签：wpf, xaml, data-binding, ado.net

当我为数据表创建多个数据视图时，我遇到了问题，然后绑定对于新实例无法正常工作。请帮我解决这个问题......

有没有人有这个问题的解决方案？请参阅下文了解更多详情

上一篇：

“我们在 DataRowView 上遇到 PropertyChange 事件，没有为新的 Dataview 实例引发。这似乎是 ADO 错误，而不是 WPF。在应用程序创建新 DataView 后，WPF 订阅来自 DataView 唯一成员（DataRowView）的更改事件, 并取消订阅旧 DataRowView 的更改事件。然后不知何故 ADO 在没有任何通知的情况下更改新 DataView，用旧 DataRowView 替换新 DataRowView。现在对 Name 列的更改会影响旧 DataRowView，并且 WPF 从未听说过它们，因为它是收听新的 DataRowView。”

提前致谢..

# 代码 ：

```
<Window x:Class="WpfStudy.GridView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:local="clr-namespace:WpfStudy"
         Height="400" Width="500" Title="Binding Listview with Mulit ItemSource Options">
    <Window.Resources>
        <local:NameConverter  x:Key="NameConverter"/>
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition />
            <RowDefinition />
            <RowDefinition />
        </Grid.RowDefinitions>

        <StackPanel>
            <Button Click="Button_Click">Click</Button>
            <ListView Name="ListviewALL" >
                <ListView.View>
                    <GridView>
                        <GridViewColumn Width="140" Header="Binding Label" >
                            <GridViewColumn.DisplayMemberBinding>
                                <MultiBinding Converter="{StaticResource NameConverter}">
                                    <Binding  Path="LastName" />
                                    <Binding  Path="FirstName" />
                                </MultiBinding>
                            </GridViewColumn.DisplayMemberBinding>
                        </GridViewColumn>

                        <GridViewColumn Width="140">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBox Name="FirstName" FontFamily="Lucida Console" Text="{Binding FirstName,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Width="200" />
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>
                        <GridViewColumn Width="140">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBox Name="LastName" FontFamily="Lucida Console" Text="{Binding LastName,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Width="200" />
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>

                    </GridView>
                </ListView.View>
            </ListView>

        </StackPanel>
        <ListView Name="Listview" Grid.Row="1">
            <ListView.View>
                <GridView>
                    <GridViewColumn Width="140" Header="Binding Label" >
                        <GridViewColumn.DisplayMemberBinding>
                            <MultiBinding Converter="{StaticResource NameConverter}">
                                <Binding  Path="LastName" />
                                <Binding  Path="FirstName" />
                            </MultiBinding>
                        </GridViewColumn.DisplayMemberBinding>
                    </GridViewColumn>

                    <GridViewColumn Width="140">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBox Name="FirstName" FontFamily="Lucida Console" Text="{Binding FirstName,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Width="200" />
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Width="140">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBox Name="LastName" FontFamily="Lucida Console" Text="{Binding LastName,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Width="200" />
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>

                </GridView>
            </ListView.View>
        </ListView>

        <ListView Name="Listview1" Grid.Row="2">
            <ListView.View>
                <GridView>
                    <GridViewColumn Width="140" Header="Binding Label" >
                        <GridViewColumn.DisplayMemberBinding>
                            <MultiBinding Converter="{StaticResource NameConverter}">
                                <Binding  Path="LastName" />
                                <Binding  Path="FirstName" />
                            </MultiBinding>
                        </GridViewColumn.DisplayMemberBinding>
                    </GridViewColumn>

                    <GridViewColumn Width="140">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBox Name="FirstName" FontFamily="Lucida Console" Text="{Binding FirstName,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Width="200" />
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Width="140">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBox Name="LastName" FontFamily="Lucida Console" Text="{Binding LastName,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Width="200" />
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>

                </GridView>
            </ListView.View>
        </ListView>

    </Grid>
</Window> 
```

# 转换器：

```
namespace WpfStudy
{
    public class NameConverter : IMultiValueConverter
    {
        public object Convert(object[] values, Type targetType, object parameter,
            System.Globalization.CultureInfo culture)
        {

            StringBuilder sb=new StringBuilder();

            foreach(string val in values)
            {

                if (sb.Length != 0)
                    sb.Append(" ");

                    sb.Append(val);

            }

            return sb.ToString();
        }

        public object[] ConvertBack(object value, Type[] targetTypes, object parameter,
            System.Globalization.CultureInfo culture)
        {
            throw new NotImplementedException();
        }
    }

} 
```

# 绑定源

```
- i am binding datatable source with 3 list view with differnet dataview. if we create more view instance then two way binding is not working.xaml not getting updated from source.

  private void loadDatatable()
        {
            DataTable dt = new DataTable();
            dt.Columns.Add("FirstName");
            dt.Columns.Add("LastName");
            dt.Columns.Add("Userid");

            DataRow dr = dt.NewRow();
            dr[0] = "Siva";
            dr[1] = "Jagan";
            dr[2] = "JS";
            dt.Rows.Add(dr);

            DataRow dr1 = dt.NewRow();
            dr1[0] = "Raam";
            dr1[1] = "John";
            dr1[2] = "RJ";
            dt.Rows.Add(dr1);

            ListviewALL.ItemsSource = dt.DefaultView;

            dv1 = new DataView(dt);
            dv1.RowFilter = "FirstName like'S%'";

            dv2 = new DataView(dt);
            dv2.RowFilter = "FirstName like 'R%'";

            Listview.ItemsSource = dv1;
            Listview1.ItemsSource = dv2;

        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T06:28:57.293

当您使用 BindingListCollectionView 或 ICollectionView 而不是 Dataview 来过滤您的东西时会发生什么？

编辑：

我试了一下，下面的作品：

```
 public BindingListCollectionView View1 { get; set; }
    public BindingListCollectionView View2 { get; set; }

    View1 = new BindingListCollectionView(new DataView(Dt) { RowFilter = "FirstName like 'R%'" });
    View2 = new BindingListCollectionView(new DataView(Dt) { RowFilter = "FirstName like 'S%'"}); 
```

添加、修改和删除作品。

EDIT2 我的示例代码：更新以满足您的要求。通过任何列表视图中的文本框进行编辑工作！

```
public class Viewmodel
{
    public DataTable Dt { get; set; }
    public BindingListCollectionView View1 { get; set; }
    public BindingListCollectionView View2 { get; set; }

    public Viewmodel()
    {
        Dt = new DataTable();
        Dt.Columns.Add("Name");
        Dt.Columns.Add("VorName");

        DataRow dr = Dt.NewRow();
        dr[0] = "Siva";
        dr[1] = "Jagan";
        Dt.Rows.Add(dr);

        DataRow dr1 = Dt.NewRow();
        dr1[0] = "Raam";
        dr1[1] = "John";
        Dt.Rows.Add(dr1);

        View1 = new BindingListCollectionView(new DataView(Dt) { RowFilter = "Name like 'R%'" });
        View2 = new BindingListCollectionView(new DataView(Dt){RowFilter = "Name like 'S%'"});

    }
} 
```

窗口.xaml.cs

```
public partial class MainWindow : Window
{
    private Viewmodel _data;
    public MainWindow()
    {
        InitializeComponent();
        this._data = new Viewmodel();

        this.DataContext = _data;
    }
} 
```

窗口.xaml

```
 <Window.Resources>
    <local:NameConverter  x:Key="NameConverter"/>
</Window.Resources>
<Grid>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="138*" />
        <ColumnDefinition Width="209*" />
        <ColumnDefinition Width="156*" />
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
        <RowDefinition Height="76*" />
        <RowDefinition Height="235*" />
    </Grid.RowDefinitions>     
    <ListView ItemsSource="{Binding Dt}" Grid.Column="0" Grid.Row="1">
        <ListView.View>
            <GridView>
                <GridViewColumn Width="140" Header="Binding Label" >
                    <GridViewColumn.DisplayMemberBinding>
                        <MultiBinding Converter="{StaticResource NameConverter}">
                            <Binding  Path="Name" />
                            <Binding  Path="VorName" />
                        </MultiBinding>
                    </GridViewColumn.DisplayMemberBinding>
                </GridViewColumn>
                <GridViewColumn Header="Name" > 
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBox Name="FirstName" FontFamily="Lucida Console" Text="{Binding Name,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Width="200" />
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>    
                </GridViewColumn>
                <GridViewColumn Header="VorName" DisplayMemberBinding="{Binding VorName}">
                </GridViewColumn>
            </GridView>
        </ListView.View>
    </ListView>
    <ListView ItemsSource="{Binding View1}" Grid.Column="1" Grid.Row="1">
        <ListView.View>
            <GridView>
                <GridViewColumn Width="140" Header="Binding Label" >
                    <GridViewColumn.DisplayMemberBinding>
                        <MultiBinding Converter="{StaticResource NameConverter}">
                            <Binding  Path="Name" />
                            <Binding  Path="VorName" />
                        </MultiBinding>
                    </GridViewColumn.DisplayMemberBinding>
                </GridViewColumn>
                <GridViewColumn Header="Name"  > 
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBox Name="FirstName" FontFamily="Lucida Console" Text="{Binding Name,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Width="200" />
                        </DataTemplate>
                    </GridViewColumn.CellTemplate> 
                </GridViewColumn>
                <GridViewColumn Header="VorName" DisplayMemberBinding="{Binding VorName}">
                </GridViewColumn>
            </GridView>
        </ListView.View>
    </ListView>
    <ListView ItemsSource="{Binding View2}" Grid.Column="2" Grid.Row="1">
        <ListView.View>
            <GridView>
                <GridViewColumn Width="140" Header="Binding Label" >
                    <GridViewColumn.DisplayMemberBinding>
                        <MultiBinding Converter="{StaticResource NameConverter}">
                            <Binding  Path="Name" />
                            <Binding  Path="VorName" />
                        </MultiBinding>
                    </GridViewColumn.DisplayMemberBinding>
                </GridViewColumn>

                <GridViewColumn Header="Name"  > 
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBox Name="FirstName" FontFamily="Lucida Console" Text="{Binding Name,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Width="200" />
                        </DataTemplate>
                    </GridViewColumn.CellTemplate> 

                </GridViewColumn>
                <GridViewColumn Header="VorName" DisplayMemberBinding="{Binding VorName}">

                </GridViewColumn>
            </GridView>
        </ListView.View>
    </ListView>
</Grid> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T08:13:53.017

每次添加后试试这个...

```
 dt.AcceptChanges(); 
```

如果这不起作用，则重置行过滤器

```
 var tempFilter = dt.DefaultView.RowFilter;
  dt.DefaultView.RowFilter = string.empty;
  dt.DefaultView.RowFilter = tempFilter; 
```

# c++ - 使用 C++/WinAPI/MFC 捕获编辑/文本框控件上的特殊单击事件

> ID：10201469
> 
> 赞同：0
> 
> 时间：2012-04-18T01:13:38.367
> 
> 标签：c++, winapi, textbox

我在 Windows 平台上使用 C++/MFC 进行编码（使用 MS VS2008。）我有这个设置为只读的编辑控件（基本上是一个文本框）。控件显示一些基本信息。我想在我的应用程序中添加一个“复活节彩蛋”，即当用户 Ctrl+Shift 单击此编辑控件时，它必须显示一些附加信息。问题是如何使用 MFC/本机 WinAPI 捕获这样的点击事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T01:30:17.157

最直接的方法是使用[`SetWindowLong`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633591%28v=vs.85%29.aspx)和捕获[`WM_LBUTTONDOWN`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms645607%28v=vs.85%29.aspx)事件对编辑控件进行子类化。然后，您需要调用[`GetAsyncKeyState`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646293%28v=vs.85%29.aspx)或等效检查特定键是否被按下，并显示消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-08-01T18:12:23.920

无需进行子类化。抓住[`WM_PARENTNOTIFY`](https://docs.microsoft.com/en-us/previous-versions/windows/desktop/inputmsg/wm-parentnotify)

```
case WM_PARENTNOTIFY: {
    if (LOWORD(wParam) == WM_LBUTTONDOWN)
        printf("x: %i, y: %i\n", LOWORD(lParam), HIWORD(lParam));
}
break; 
```

默认情况下，对话框中的子窗口具有`WS_EX_NOPARENTNOTIFY`样式，因此不会通知父窗口。您应该删除此样式。

```
case WM_INITDIALOG: {
    HWND hChildWnd = GetDlgItem(hWnd, IDC_CHILD);
    LONG style = GetWindowLong(hChildWnd, GWL_EXSTYLE);
    style &= ~WS_EX_NOPARENTNOTIFY;
    SetWindowLong(hChildWnd, GWL_EXSTYLE, style);
    ... 
```

PS我希望还不算太晚:D

# ruby-on-rails - 使用 Omniauth 登录 Facebook

> ID：10201470
> 
> 赞同：1
> 
> 时间：2012-04-18T01:13:39.457
> 
> 标签：ruby-on-rails, facebook

我正在按照[http://blog.railsrumble.com/blog/2010/10/08/intridea-omniauth](http://blog.railsrumble.com/blog/2010/10/08/intridea-omniauth)上的教程在 rails 3 中使用omniauth-facebook gem 。

我正在检查 Facebook 的回复使用

```
render :text => request.env['omniauth.auth'] 
```

仅返回以下内容：

```
# extra=#> info=#> provider="facebook" uid="12345678"> 
```

换句话说，只有 uid 被返回。我无法弄清楚为什么没有其他基本信息可供用户使用，特别是因为 UID 出现了。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T01:54:01.980

`request.env['omniauth.auth']`是由 Omniauth 生成的散列，其中包含提供者发送的所有数据。它还包含另一个名为的散列`extra`，该散列还包含另一个名为的散列`raw_info`- Facebook 的 Graph API 发送的所有数据（在本例中）。

例如，您可以使用访问用户的电子邮件

```
request.env['omniauth.auth']['extra']['raw_info']['email'] 
```

[来源](https://github.com/plataformatec/devise/wiki/OmniAuth%3a-Overview)

# java - mkstemp 的 java 等效项

> ID：10201472
> 
> 赞同：6
> 
> 时间：2012-04-18T01:13:52.607
> 
> 标签：java

Java中有什么方法可以安全地写出临时文件吗？

据我所知，创建临时文件（createTempFile）的唯一方法实际上不会同时打开它，因此文件打开和文件写入之间存在竞争条件。我错过了什么吗？我在 UnixFileSystem.java 中找不到 createFileExclusively(String) 背后的 C 源代码，但我怀疑它真的可以做任何事情，因为在创建临时文件后，文件打开发生在 Java 代码中（除非它尝试用文件锁？）。

**问题**

在创建临时文件和打开它之间，恶意攻击者可以取消该临时文件的链接并将恶意内容放在那里。例如，攻击者可以创建命名管道来读取敏感数据。或者类似地，如果您最终通过读取文件来复制文件，那么命名管道可能会忽略所有写入的内容并提供要读取的恶意内容。

我记得在过去 10 多年中阅读过大量临时文件攻击示例，这些示例利用名称出现在命名空间中和文件实际打开时之间的竞争条件。

希望缓解因素是 Java 正确设置了 umask，因此权限较低的用户无法读取/写入文件，并且 /tmp 目录通常会正确限制权限，因此您无法执行取消链接攻击。

当然，如果您为受感染的低权限用户拥有的临时文件传递自定义目录，则该用户可能会对您进行取消链接攻击。地狱，使用inotify，利用竞争条件可能比仅仅执行目录列表的蛮力循环更容易。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T18:45:23.047

[http://kurt.seifried.org/2012/03/14/creating-temporary-files-securely/](http://kurt.seifried.org/2012/03/14/creating-temporary-files-securely/)

爪哇

使用 java.io.File.createTempFile() - 一些有趣的信息在[http://www.veracode.com/blog/2009/01/how-boring-flaws-become-interesting/](http://www.veracode.com/blog/2009/01/how-boring-flaws-become-interesting/)

对于目录，[如何在 Java 中创建临时目录/文件夹？](https://stackoverflow.com/questions/617414/create-a-temporary-directory-in-java)

爪哇 7

对于文件使用 java.io.File.createTempFile()

对于目录使用 createTempDirectory()

[http://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T22:34:02.853

对其他普通用户名安全吗？是的，在任何正常运行的多用户系统上。

保护您自己的用户 ID 或超级用户？不。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T02:10:53.773

请记住，在许多系统上，仅仅因为文件没有名称并不意味着它是不可访问的。例如，在 Linux 上，打开的文件描述符在`/proc/<pid>/fd/<fdno>`. 因此，即使有人知道/有对打开文件的引用，您也应该确保您对临时文件的使用是安全的。

如果您准确指定您要阻止的攻击类别，您可能会得到更有用的答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-02T11:10:33.743

从 Java 7 开始，我们拥有[`OpenOption`](https://docs.oracle.com/javase/8/docs/api/index.html?java/nio/file/OpenOption.html).

> 配置如何打开或创建文件的对象。
> 
> 这种类型的对象由诸如`newOutputStream`、`newByteChannel`、`FileChannel.open`、`AsynchronousFileChannel.open`打开或创建文件之类的方法使用。

特别感兴趣的是[`StandardOpenOptions.CREATE_NEW`](https://docs.oracle.com/javase/8/docs/api/java/nio/file/StandardOpenOption.html#CREATE_NEW).

> 创建一个新文件，如果文件已经存在则失败。检查文件是否存在以及如果文件不存在则创建文件对于其他文件系统操作而言是原子操作。

因此，您可以执行以下操作：

```
FileChannel mkstemp() {
    Path path = Files.createTempFile(null, null);
    Files.delete(path);
    return FileChannel.open(path, WRITE, CREATE_NEW);
} 
```

实现相同的模板行为留给读者作为练习。

# kohana - 在 kohana 控制器内部时，Uploadify 脚本不起作用

> ID：10201474
> 
> 赞同：0
> 
> 时间：2012-04-18T01:14:05.697
> 
> 标签：kohana, uploadify

您好我正在尝试在 kohana 2.3.4 中实现 uploadify 脚本，当我将 uploadify 脚本放在根目录上然后在我的视图文件中指出它时它可以工作。但是当我将脚本指向一个控制器时，它会返回一个 http 错误。下面是js脚本：

```
 <script type="text/javascript">
// <![CDATA[
$(document).ready(function() {
$('#file_upload').uploadify({
'uploader'  : '<?=url::base()?>uploadify/uploadify.swf',
'script'    : '<?=url::base()?>uploadify', /*Even tried     http://localhost/directory/uploadify*/
'cancelImg' : '<?=url::base()?>uploadify/cancel.png',
'folder'    : '<?=url::base().$directory?>',
'multi'       : true,
'removeCompleted' : false,
'auto'      : true
 });
 });
 // ]]>
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T06:11:38.357

不确定您收到了什么错误，但如果您的页面需要身份验证并且控制器无法验证用户身份，那么您可以按照我的解决方案进行操作。问题是uploadify 使用flash 并且flash 中存在错误，它不会将cookie 发送到服务器。

我改变了它如下图所示让它工作。在 js 中（用于 kohana）

```
$('#file_upload').uploadify({
    uploader: base_url+"upload/image?sess=<?php Session::instance()->id(); ?>",
}); 
```

在普通的php中

```
$('#file_upload').uploadify({
    uploader: base_url+"upload/image?sess=<?php session_id();?>",
}); 
```

并在 kohana 控制器中从会话读取身份验证时，初始化会话如下

```
 $sess_id = Arr::get($_GET,'sess',null);
  $sess = Session::instance(null,$sess_id); 
```

或者在普通的php中

```
session_name($_GET['sess']);
session_start(); 
```

将来如果闪存中的错误已修复，则无需执行此操作

# c - 不知道为什么我收到链接错误

> ID：10201475
> 
> 赞同：0
> 
> 时间：2012-04-18T01:14:24.800
> 
> 标签：c, linker, x86, linker-errors

我不知道为什么会出现此链接错误，我很确定所有内容都已正确链接

```
gcc -Wall -Wextra -o test driver.c target.c 
driver.c:8: warning: unused parameter ‘argc’
ld: duplicate symbol _first in /var/folders/yx/31ddgzsj4k97jzvwhfx7tkz00000gn/T//ccw2n48G.o and /var/folders/yx/31ddgzsj4k97jzvwhfx7tkz00000gn/T//ccKZdUlG.o for architecture x86_64
collect2: ld returned 1 exit status 
```

我有以下代码，这是一个简单的链表，但我不知道为什么它不会编译

驱动程序.c

```
 #include "target.h"
 #include <stdio.h>
 #include <stdlib.h>

char * prog;
int main(int argc, char * argv[]){
  prog = argv[0];
  print_target_list(1);
  ..... 
```

目标.c

```
#include "target.h"
/* This function returns true if there is a target with name in the target linked list */
bool is_target(char * name){
    struct target_node * ptr = first;
   while(ptr != NULL){
    if(strcmp(ptr->name,name) == 0){
      return true;
    }
    ptr = ptr->next;
  }
  return false;
}
...... 
```

目标.h

```
#ifndef TARGET_H
#define TARGET_H

//#include "source.h"
#include <stdbool.h>
#include <stdio.h>
#include <errno.h>
#include <stdlib.h>
#include <string.h>

/*-----------------------------------------*/

extern char * prog;

/*-----------------------------------------*/

struct source_node{
  char * name;
};

struct target_node{
  char * name;
  struct target_node * next;
  struct source_node * src_node;
};

struct target_node * first = NULL;

/*-----------------------------------------------------*/

/* return 1 if name is in the target linked list 0 otherwise */
bool is_target(char * name);
/* returns a new target_node */ 
struct target_node * new_target_node(char * name);
/* insert a new target_node into the list */
void insert_target_node(char * name);
/* remove a target_node from the list */
void remove_target_node(char * name);
/* print the current linked list */
void print_target_list(int opts);

#endif 
```

任何帮助都会被应用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T01:17:27.147

`target.h`使用中：

```
extern struct target_node * first; 
```

并将以下内容放在相应的 target.c 文件中：

```
struct target_node * first = NULL; 
```

如果`first`在 之外不需要，则可以将其完全`target.c`删除（如果您想避免将其不必要地放入全局命名空间，则可以将其放入）。`target.h``static``target.c`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T01:17:51.637

具有外部链接的对象只需在整个程序中定义一次。

您`struct target_node * first`在头文件中定义，然后将该头文件包含在两个不同的实现文件中。现在您的程序中有两个定义`first`。并且`first`是具有外部链接的对象。因此错误。

# xml - 魔兽争霸 1.12 客户端的魔兽世界“exportInterfaceFiles 代码”语法

> ID：10201477
> 
> 赞同：1
> 
> 时间：2012-04-18T01:14:34.463
> 
> 标签：xml, syntax, lua, add-on, world-of-warcraft

我正在查看 wowwiki 并能够提取 cata 的接口文件以查看其代码，但无法使用 1.12 客户端控制台中的“exportInterfaceFiles 代码”语法来执行此操作。如果有人知道如何，将不胜感激，因为我想研究为香草创建一个或两个插件，主要是为了有趣。

另外，如果有人可能对 1.12 魔兽 API 有参考，那将不胜感激。您认为我应该知道的有关为 1.12 创建插件的过程的任何其他内容将不胜感激，因为文档似乎很难获得。谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T10:56:06.033

[http://wow.go-hero.net/framexml/builds](http://wow.go-hero.net/framexml/builds)的历史可以追溯到 1.1.2.4115。对于 API 的历史数据，[Wowpedia](http://wowpedia.org/API) /Wowwiki 本身会这样做，只需将相关页面倒回到 2004 年底 - 2005 年开始的修订。

# jquery - 将 jQuery UI 进度条与搜索功能联系起来

> ID：10201481
> 
> 赞同：0
> 
> 时间：2012-04-18T01:15:28.003
> 
> 标签：jquery, progress-bar

当我单击表单上的搜索时，我需要显示进度条而不是微调器。这需要几秒钟，我想在显示结果时显示搜索的实际进度。我正在尝试为此使用 jQuery 进度条。
如何将搜索事件功能与进度条联系起来。搜索事件是内部的休眠条件查询调用。
我如何准确地显示搜索的进度（条形大小正确增加）。
我看到我必须设置进度条的 value() 函数以反映彩色条的大小，但是如何增加这个值？我可以将值与结果集大小或其他东西联系起来吗？

提前致谢..

# c++ - 如何使用 boost::filesystem 检查文件是常规文件还是符号链接？

> ID：10201483
> 
> 赞同：5
> 
> 时间：2012-04-18T01:15:49.520
> 
> 标签：c++, boost, boost-filesystem

我想检查字符串是否`name`引用了我可以打开和读取的文件，因此它可以是常规文件或符号链接。

我第一次使用这个：

```
std::ifstream in(name.c_str());
if (!in.is_open()) {
  // throw exception!
} 
```

`name`但是在引用目录名称时它没有抛出异常。

现在我正在使用这个：

```
if (!fs::exists(name) || fs::is_directory(name)) {
  // throw exception!
} 
```

但如果它是指向目录的符号链接，它将（可能）不会抛出。这也是如此：

```
if (!fs::is_regular_file(name) && !fs::is_symlink(name)) {
  // throw exception!
} 
```

有没有更好的办法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-12-31T17:47:55.313

从 Boost.Filesystem v3 开始，检查它是否是常规文件已经可以满足您的需求。下面是一个简单的代码：

```
#include <boost/filesystem.hpp>

#include <iostream>

namespace fs = boost::filesystem;

int main(int argc, char* argv[]) {
  if (argc > 1) {
    auto status = fs::status(argv[1]);

    if (status.type() == fs::regular_file)
      std::cout << argv[1] << " is a valid path." << std::endl;
    else
      std::cout << argv[1] << " is not a valid path." << std::endl;

    if (fs::symlink_status(argv[1]).type() == fs::symlink_file)
      std::cout << "It is also a symlink." << std::endl;

  } else {
    std::cerr << "A path must be given." << std::endl;
  }

  return 0;
} 
```

以下是一些输出：

```
% ./fstest /bin # it is a symlink path
/bin is not a valid path.
It is also a symlink.
% ./fstest /bin/ # it is a symlink path but dereferenced? (trailing /)
/bin/ is not a valid path.
% ./fstest /bin/zsoelim # it is a symlink                                                                                                               
/bin/zsoelim is a valid path.
It is also a symlink.
% ./fstest /bin/soelim # it is not a symlink 
/bin/soelim is a valid path. 
```

如您所见，`boost::filesystem::status(path)`返回有关实际路径的信息，无论它是否是符号链接（跟随到实际位置）。另一方面，`boost::filesystem::symlink_status(path)`如果文件本身是符号链接，则返回信息。

更多信息可以在[boost 文档](http://www.boost.org/doc/libs/1_57_0/libs/filesystem/doc/reference.html#is_regular_file)中找到。

# menu - 在love2d中制作菜单

> ID：10201486
> 
> 赞同：3
> 
> 时间：2012-04-18T01:16:21.087
> 
> 标签：menu, love2d

我目前正在使用love2D 游戏引擎，并且很好奇如何创建一个简单的用户菜单。也许只有几个选项，例如：播放、选项、关于、退出。

有没有创建自定义游戏菜单的好教程？我只是想开始。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-05T06:48:50.467

要制作一个基本的菜单系统，您可以这样做：

*   创建一个包含按钮标签、回调和其他一些数据的表格
*   在`love.draw`中，循环遍历该表并绘制按钮
*   在`love.update`（如果需要，也可以在 .draw 中），检查鼠标是否悬停在按钮上
*   如果鼠标悬停在按钮上并按下按钮，则调用按钮的回调

现在我不能给你所有需要的代码，因为它取决于你的其余代码。但是，我可以给你一个函数来检查鼠标是否悬停在一个按钮上：

```
function pointInRectangle(pointx, pointy, rectx, recty, rectwidth, rectheight)
    return pointx > rectx and pointy > recty and pointx < rectx + rectwidth and pointy < recty + rectheight
end 
```

以及检查用户是否按下鼠标的逻辑：

*   中`love.load`，添加`pressed = false`
*   中`love.mousereleased`，添加`pressed = true`
*   在最后`love.draw`，就在之前`end`，添加`pressed = false`

现在，如果按下等于 true，您就知道用户刚刚释放了鼠标按钮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T04:05:38.017

我建议使用[LoveFrames](https://github.com/NikolaiResokav/LoveFrames)。太好了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-19T19:44:48.137

我前段时间为 löve2d制作[了一个菜单系统。](https://love2d.org/forums/viewtopic.php?f=5&t=3636)随意使用它，并且知道您可以并且应该修改绘图功能以适合您的游戏图形。

# masstransit - Masstransit - 当接收器服务未启动时，没有消息添加到 MSMQ

> ID：10201490
> 
> 赞同：11
> 
> 时间：2012-04-18T01:16:33.027
> 
> 标签：masstransit

我的应用程序由一个 ASP.NET MVC 3 应用程序和一个 Windows 服务组成，它们都在同一个盒子上。MVC 应用程序使用 MassTransit 将消息放置在 MSMQ 队列上。该服务使用 MassTransit 从 MSMQ 读取这些消息并执行一些工作。当我加载服务和应用程序并让它们同时运行时，一切似乎都运行良好。但是，如果我只加载 Web 应用程序，我的消息不会被添加到 MSMQ 并且基本上会消失。奇怪的是，如果我加载我的 Web 应用程序，然后启动并立即停止所述服务，则从 Web 应用程序发送的后续消息将添加到队列中。

将 MassTransit 与 StructureMap 和/或 MVC 结合使用的优秀/现代示例并不多，因此我的配置可能存在问题，但经过几个小时的反复试验后，我不确定如何继续。我也可能在滥用 MassTransit - 我真正需要的是来自 Web 应用程序的“一劳永逸”解决方案......

我的服务如下所示：

```
class Program
{
    static void Main(string[] args)
    {
        Bus.Initialize(sbc =>
        {
            sbc.UseMsmq();
            sbc.VerifyMsmqConfiguration();
            sbc.UseMulticastSubscriptionClient();
            sbc.ReceiveFrom("msmq://localhost/receiver");
        });

        ObjectFactory.Initialize(x =>
        {
            x.AddRegistry(new EmailSenderRegistry());
        });

        var host = HostFactory.New(c =>
        {
            c.SetServiceName("MyApp.EmailMessageReader");
            c.SetDisplayName("MyApp.EmailMessageReader");
            c.SetDescription("MyApp.EmailMessageReader");

            c.Service<ClientService>(a =>
            {
                a.ConstructUsing(service => new ClientService());
                a.WhenStarted(o => o.Start());
                a.WhenStopped(x=>x.Stop());
            });
        });

        host.Run();
    }
}

internal class ClientService 
{
    public void Start()
    {
        Bus.Instance.SubscribeConsumer<EmailPrepService>();
    }

    public void Stop()
    {
        // do nothing
    }
}

public class EmailPrepService : Consumes<EmailMessage>.All
{
    public void Consume(EmailMessage message)
    {
        PrepareEmailForSending(message);
        var emailService = ObjectFactory.GetInstance<IEmailSender>();
        emailService.SendEmail(message);
    }
} 
```

我的 Web 应用程序如下所示：

```
public class BusRegistry : Registry
{
    public BusRegistry()
    {
        For<IServiceBus>().Singleton().Use(context => ServiceBusFactory.New(sbc =>
        {
            sbc.ReceiveFrom("msmq://localhost/sender");             
            sbc.UseMsmq();
            sbc.UseMulticastSubscriptionClient();
            sbc.UseControlBus();
            sbc.Subscribe(subs => { subs.LoadFrom(context.GetInstance<IContainer>()); });
        }));            
    }
} 
```

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-24T15:45:18.560

当您使用 MulticastSubscriptionClient 时，您的订阅是“暂时的”而不是“永久的”，即它们在总线关闭时自动取消订阅。

您的选择是 a) 使用[RabbitMQ](http://www.rabbitmq.com/)作为传输或 b) 如果您需要使用 MSMQ，则使用 MassTransit 的 SubscriptionServices 进行订阅，因为它们随后存储在数据库中并在总线实例之间持续存在。

有关详细信息，请参阅[http://docs.masstransit-project.com/en/latest/overview/subscriptions.html 。](http://docs.masstransit-project.com/en/latest/overview/subscriptions.html)

# php - mysql查询根据状态按entry_date对帖子进行排序

> ID：10201496
> 
> 赞同：0
> 
> 时间：2012-04-18T01:17:19.347
> 
> 标签：php, mysql

我想按 entry_date 降序对帖子进行排序。有些帖子可能处于活动状态，所以我想根据进入日期对活动帖子进行排序。

所以输出应该如下所示：

```
id  post          entry_date       status
1   abc..         15-april-2012    1
5   xyz           12-april-2012    1 
2   art...        14-april-2012    0 
```

如何排序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T01:19:34.373

试试下面：

```
SELECT * FROM tablename ORDER BY if(status=1,0,1), entry_date desc 
```

# hadoop - Hadoop 使用 Datajoin 减少侧连接

> ID：10201500
> 
> 赞同：3
> 
> 时间：2012-04-18T01:17:51.430
> 
> 标签：hadoop

我正在使用以下代码进行减少侧连接

```
/*
 * HadoopMapper.java
 *
 * Created on Apr 8, 2012, 5:39:51 PM
 */

import java.io.DataInput;
import java.io.DataOutput;
import java.io.IOException;
// import org.apache.commons.logging.Log;
// import org.apache.commons.logging.LogFactory;
import org.apache.hadoop.mapred.FileInputFormat;
import org.apache.hadoop.mapred.FileOutputFormat;
import org.apache.hadoop.mapred.JobClient;
import org.apache.hadoop.mapred.JobConf;
import org.apache.hadoop.mapred.TextInputFormat;
import org.apache.hadoop.mapred.TextOutputFormat;
import org.apache.hadoop.util.GenericOptionsParser;
import org.apache.hadoop.util.Tool;
import org.apache.hadoop.util.ToolRunner;
import org.apache.hadoop.fs.Path;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.io.Writable;
import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.conf.Configured;
import org.apache.hadoop.contrib.utils.join.*; 

/**
 *
 * @author 
 */
public class DataJoin extends Configured implements Tool 
    {
        public static class MapClass extends DataJoinMapperBase 
            {
                protected Text generateInputTag(String inputFile) 
                    {
                        String datasource = inputFile.split("-")[0];
                        return new Text(datasource);
                    }
            protected Text generateGroupKey(TaggedMapOutput aRecord) 
                {
                    String line = ((Text) aRecord.getData()).toString();
                    String[] tokens = line.split(",");
                    String groupKey = tokens[0];
                    return new Text(groupKey);
                }
            protected TaggedMapOutput generateTaggedMapOutput(Object value) 
                {
                    TaggedWritable retv = new TaggedWritable((Text) value);
                    retv.setTag(this.inputTag);
                    return retv;
                }
            }
        public static class Reduce extends DataJoinReducerBase 
            {
                protected TaggedMapOutput combine(Object[] tags, Object[] values) 
                    {
                        if (tags.length < 2) return null;
                        String joinedStr = "";
                        for (int i=0; i<values.length; i++) 
                        {
                            if (i > 0) joinedStr += ",";
                            TaggedWritable tw = (TaggedWritable) values[i];
                            String line = ((Text) tw.getData()).toString();
                            String[] tokens = line.split(",", 2);
                            joinedStr += tokens[1];
                        }
                        TaggedWritable retv = new TaggedWritable(new Text(joinedStr));
                        retv.setTag((Text) tags[0]);
                        return retv;
                    }
            }
        public static class TaggedWritable extends TaggedMapOutput 
            {
                private Writable data;
                public TaggedWritable(Writable data) 
                    {
                        this.tag = new Text("");
                        this.data = data;
                    }

                public Writable getData() 
                    {
                        return data;
                    }
                public void write(DataOutput out) throws IOException
                    {
                        this.tag.write(out);
                        this.data.write(out);
                    }
                public void readFields(DataInput in) throws IOException 
                    {
                        this.tag.readFields(in);
                        this.data.readFields(in);
                    }
            }
        public int run(String[] args) throws Exception 
            {

                                Configuration conf = getConf();
                JobConf job = new JobConf(conf, DataJoin.class);
                                String[] otherArgs = new GenericOptionsParser(conf, args).getRemainingArgs();
                                if (otherArgs.length != 2) 
                                {
                                  System.err.println("Usage: wordcount <in> <out>");
                                  System.exit(2);
                                }

                Path in = new Path(args[0]);
                Path out = new Path(args[1]);
                FileInputFormat.setInputPaths(job, in);
                FileOutputFormat.setOutputPath(job, out);
                job.setJobName("DataJoin");
                job.setMapperClass(MapClass.class);
                job.setReducerClass(Reduce.class);
                job.setInputFormat(TextInputFormat.class);
                job.setOutputFormat(TextOutputFormat.class);
                job.setOutputKeyClass(Text.class);
                job.setOutputValueClass(TaggedWritable.class);
                job.set("mapred.textoutputformat.separator", ",");
                JobClient.runJob(job);
                return 0;
            }
        public static void main(String[] args) throws Exception 
            {
                int res = ToolRunner.run(new Configuration(),
                new DataJoin(),
                args);
                System.exit(res);
            }
    } 
```

我能够编译我的代码。当我在 hadoop 中运行时，组合器出现以下错误

```
12/04/17 19:59:29 INFO mapred.JobClient:  map 100% reduce 27%
12/04/17 19:59:38 INFO mapred.JobClient:  map 100% reduce 30%
12/04/17 19:59:47 INFO mapred.JobClient:  map 100% reduce 33%
12/04/17 20:00:23 INFO mapred.JobClient: Task Id : attempt_201204061316_0018_r_000000_2, Status : FAILED
java.lang.RuntimeException: java.lang.NoSuchMethodException: DataJoin$TaggedWritable.<init>()
        at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:115)
        at org.apache.hadoop.io.serializer.WritableSerialization$WritableDeserializer.deserialize(WritableSerialization.java:62)
        at org.apache.hadoop.io.serializer.WritableSerialization$WritableDeserializer.deserialize(WritableSerialization.java:40)
        at org.apache.hadoop.mapred.Task$ValuesIterator.readNextValue(Task.java:1136)
        at org.apache.hadoop.mapred.Task$ValuesIterator.next(Task.java:1076)
        at org.apache.hadoop.mapred.ReduceTask$ReduceValuesIterator.moveToNext(ReduceTask.java:246)
        at org.apache.hadoop.mapred.ReduceTask$ReduceValuesIterator.next(ReduceTask.java:242)
        at org.apache.hadoop.contrib.utils.join.DataJoinReducerBase.regroup(DataJoinReducerBase.java:106) 
```

我用来运行 hadoop 的命令是 /hadoop/core/bin/hadoop jar /export/scratch/lopez/Join/DataJoin.jar DataJoin /export/scratch/user/lopez/Join /export/scratch/user/lopez/Join_Output

并且 DataJoin.jar 文件中打包了 DataJoin$TaggedWritable

我检查了一些论坛，发现错误可能是由于非静态类而发生的。我的程序没有非静态类！

有人可以帮我吗

* * *

谢谢克里斯，我按你说的编辑了。我更新了我的代码以接收两个文件。但我收到相同的错误消息

我收到相同的消息 INFO mapred.FileInputFormat: Total input paths to process : 2

错误是

```
 Status : FAILED
    java.lang.ArrayIndexOutOfBoundsException: 1
    at DataJoin$Reduce.combine(DataJoin.java:69)
    at org.apache.hadoop.contrib.utils.join.DataJoinReducerBase.joinAndCollect(DataJoinReducerBase.java:205)
    at org.apache.hadoop.contrib.utils.join.DataJoinReducerBase.joinAndCollect(DataJoinReducerBase.java:214)
    at org.apache.hadoop.contrib.utils.join.DataJoinReducerBase.joinAndCollect(DataJoinReducerBase.java:214)
    at org.apache.hadoop.contrib.utils.join.DataJoinReducerBase.joinAndCollect(DataJoinReducerBase.java:181)
    at org.apache.hadoop.contrib.utils.join.DataJoinReducerBase.reduce(DataJoinReducerBase.java:135)
    at org.apache.hadoop.mapred.ReduceTask.runOldReducer(ReduceTask.java:468)

{

    Configuration conf = getConf();
    JobConf job = new JobConf(conf, DataJoin.class);
    String[] otherArgs = new GenericOptionsParser(conf, args).getRemainingArgs();
    if (otherArgs.length != 3) 
    {
      System.err.println("Usage: wordcount <in> <in1> <out>");
      System.exit(2);
    }

    Path in = new Path(args[0]);
    Path in1 = new Path(args[1]);
    Path out = new Path(args[2]);
    FileInputFormat.setInputPaths(job,in,in1);
    FileOutputFormat.setOutputPath(job, out);
    job.setJobName("DataJoin");
    job.setMapperClass(MapClass.class);
    job.setReducerClass(Reduce.class);
    job.setInputFormat(TextInputFormat.class);
    job.setOutputFormat(TextOutputFormat.class);
    job.setOutputKeyClass(Text.class);
    job.setOutputValueClass(TaggedWritable.class);
    job.set("mapred.textoutputformat.separator", ",");
    JobClient.runJob(job);
    return 0;

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T03:03:26.480

您需要 TaggedWritable 的默认构造函数（Hadoop 使用反射来创建此对象，并且需要默认构造函数（无 args）。

您还有一个问题，即您的 readFields 方法调用`data.readFields(in)`了可写接口 - 但不知道`data`.

我建议您在输出数据对象本身之前写出数据类名称，或者查看 GenericWritable 类（您需要对其进行扩展以定义可以使用的允许可写类集）。

所以你可以修改如下：

```
public static class TaggedWritable extends TaggedMapOutput {
    private Writable data;

    public TaggedWritable() {
        this.tag = new Text();
    }

    public TaggedWritable(Writable data) {
        this.tag = new Text("");
        this.data = data;
    }

    public Writable getData() {
        return data;
    }

    public void setData(Writable data) {
        this.data = data;
    }

    public void write(DataOutput out) throws IOException {
        this.tag.write(out);
        out.writeUTF(this.data.getClass().getName());
        this.data.write(out);
    }

    public void readFields(DataInput in) throws IOException {
        this.tag.readFields(in);
        String dataClz = in.readUTF();
        if (this.data == null
                || !this.data.getClass().getName().equals(dataClz)) {
            this.data = (Writable) ReflectionUtils.newInstance(
                    Class.forName(dataClz), null);
        }
        this.data.readFields(in);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-26T13:52:20.743

由于您的代码仅适用于文本，因此在 TaggedWritable 中链接默认构造函数应该这样做：

```
public TaggedWritable() {
    this(new Text(""));
} 
```

# coldfusion - 新实例创建新的 /CFIDE 映射

> ID：10201502
> 
> 赞同：2
> 
> 时间：2012-04-18T01:17:52.100
> 
> 标签：coldfusion, instance, jrun

我创建了一个新的 ColdFusion 实例，无论出于何种原因，它都有一个指向 /CFIDE 的映射：

```
C:\JRun4\servers\{instance}\cfusion.ear\cfusion.war\CFIDE 
```

即使我的默认实例具有：

```
C:\Program Files (x86)\Apache Software Foundation\Apache2.2\htdocs\CFIDE 
```

我宁愿让它指向 Apache 下的 CFIDE，但我无法编辑映射。如果我在 neo-runtime.xml 中手动更改它，它会在我重新启动实例时自动切换回 WAR 位置。

请不要建议只依赖 Apache 虚拟目录。虽然这适用于脚本等，但并不能真正解决问题。如果我想使用 Admin API 甚至创建 Admin 扩展，我会担心 2 个单独的 CFIDE 目录。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T07:30:23.573

托德，如果您无法解决您的特定问题（根据直接针对您的初始问题的评论），您可能只是一个目录连接：完全摆脱新实例的 CFIDE 目录，并在该位置创建一个指向您希望在实例之间共享的那个。

这是一个小技巧，但如果所有其他方法都失败了，它会起作用。

但要明确：我*没有*您在 CF9.0.1 上遇到的问题：您尝试做的应该有效。所以我认为这里还有其他事情可能需要解决。

# vb.net - VB.net 动态过滤数据网格

> ID：10201505
> 
> 赞同：0
> 
> 时间：2012-04-18T01:18:28.393
> 
> 标签：vb.net, search, gridview, csv, filter

我是编程新手，尤其是 VB，我正在尝试制作一个 CSV 阅读器，我可以在其中使用单个搜索框过滤所有内容。这是我用来将 CSV 文件加载到数据网格中的代码：

```
 Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        SetupDataGridView()
        'Dim csvpath As String = Application.StartupPath & "\csvtest.csv"
        Dim csvpath As String = "c:\songs.csv"
        Using MyReader As New Microsoft.VisualBasic.FileIO.TextFieldParser(csvpath)
            MyReader.TextFieldType = FileIO.FieldType.Delimited
            MyReader.SetDelimiters(",")
            Dim currentRow As String()
            While Not MyReader.EndOfData
                Application.DoEvents()
                Try
                    currentRow = MyReader.ReadFields()
                    With songsDataGridView
                        .ColumnCount = 2
                        Dim row As String() = New String() {currentRow(0), currentRow(1)}
                        .Rows.Add(row)
                    End With
                Catch ex As Microsoft.VisualBasic.FileIO.MalformedLineException
                    MsgBox("Line " & ex.Message & _
                      "is not valid and will be skipped.")
                End Try

            End While
        End Using
    End Sub 
```

这会将艺术家和标题加载到具有 2 列的网格视图中，我可以单击列标题并进行排序。我现在想做的是使用我的搜索框（TextBox1），当我输入任何内容时，不匹配的结果就会消失，只留下我的搜索词。我想匹配艺术家或标题。然后，当您清除搜索框时，我想返回显示 CSV 文件（原始网格视图）的所有内容。

我到处搜索，找不到我想要的东西。很多数据库和 SQL 的东西，但不是我想要的数据网格。

有没有人有什么可以帮助的？另外，处理这个问题的最好方法是我处理它的方式吗？将所有条目加载到 gridview 需要几秒钟，所以我不知道是否最好先将它们加载到数组中并过滤它或它应该如何工作。有 12,000 首歌曲，所以需要一点时间。这会是一个太大的数组吗？

所以我想我有一个两部分的问题：

1.  我这样做是最有效/最好的方式吗？

2.  如何按需过滤结果（无论它是否在我的网格中以某种方式通过数组）。编程也超级新手。

非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T01:24:34.420

您可以尝试将数据存储在`DataTable`对象中，而不是将其直接嵌入到`DataGridView`. 然后将您`DataGridView`的数据源链接到`DataTable.DefaultView`. 然后，您可以使用[此处](http://msdn.microsoft.com/en-us/library/system.data.datatable.defaultview.aspx)`DefaultView.RowFilter`演示的方式过滤表。此外，您可以利用事件根据输入的值应用过滤器。`TextBox.Changed`

# c# - 向服务请求 Oauth Google 授权

> ID：10201508
> 
> 赞同：0
> 
> 时间：2012-04-18T01:19:21.673
> 
> 标签：c#, oauth, google-api, dotnetopenauth

我在 Web 服务环境中，并且正在与 Google API for OAuth 进行交互。我从他们调用的 ASPX 模型中看到了一些样本

```
GoogleConsumer.RequestAuthorization(googleClient,ANY GOOGLE APP Scope); 
```

它工作正常。但是当我在服务环境中时。它返回“未经授权的令牌”。基本上，在 Web 环境中，用户将被重定向到他/她将输入他/她的凭据的网页，GogoleAPI 将为此返回 accesstoken。

当 RequestAuthorization() 驻留在服务端时，我不确定这应该如何工作。有人可以指导我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T23:44:24.407

`RequestAuthorization`必须在用户授权服务时进行调用。之后，可以存储站点获得的令牌，以便服务环境以后可以使用该令牌。

# node.js - 如何在 Windows 上安装 now.js

> ID：10201515
> 
> 赞同：2
> 
> 时间：2012-04-18T01:19:51.897
> 
> 标签：node.js, nowjs-sockets

我正在尝试使用节点包管理器在 Windows 上安装 now.js，但出现错误。这是我所拥有的： ![在此处输入图像描述](../Images/ad1e25b31f07b9e5c2949d159c24ab70.png)

你能告诉我我的安装有什么问题吗？我想在安装 now.js 之前已经获取了所有依赖项这就是我没有这样做的`npm install node-proxy`原因`npm install socket.io`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T04:27:06.413

从错误消息看来，您缺少“make”命令。您可以从 cygwin.com 下载一整套工具。请注意以下事项：

[http://cygwin.com/faq/faq-nochunks.html#faq.setup.what-packages](http://cygwin.com/faq/faq-nochunks.html#faq.setup.what-packages)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T05:07:12.627

目前`now`在 Windows 上不受支持，尽管他们正在处理它（[请参阅他们的问题](https://github.com/Flotype/now/issues/185)）。问题确实说有一个可以安装的分支，但它似乎随后会中断`node-proxy`。

您也许可以使用 cygwin 解决它，但 npm 不支持 cygwin，我记得有很多问题。

我想说你最好的选择（如果你不能安装 Linux VM 或使用 Mac）是检查[Cloud9](http://c9.io)并将其用于开发。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T14:29:28.500

对于尝试现在安装 js 的 Windows 开发人员。这是答案： http: [//blog.nowjs.com/running-nowjs-natively-on-windows](http://blog.nowjs.com/running-nowjs-natively-on-windows)

有时在项目 github 页面上查看问题非常有用

# c++ - 在 C++ 中打印列表元素的组件

> ID：10201516
> 
> 赞同：0
> 
> 时间：2012-04-18T01:19:57.963
> 
> 标签：c++, list

我有一个带有 3 个浮点 xyz（3-D 空间中的坐标）的 point3 结构。

我创建了几个 point3 的实例，然后创建一个列表并将这些实例推送到列表中。然后我将翻译功能应用于整个列表。

**问题：**应用翻译后，如何打印列表中某个点的 X 坐标以检查我的翻译功能是否符合我的要求？

这是我的代码：

```
int main()
{   
    point3 p1 = point3(0.0f, 0.0f, 0.0f);
    point3 p2 = point3(1.0f, 1.0f, 1.0f);
    point3 p3 = point3(2.0f, 2.0f, 2.0f);

    list<point3> myList;
    myList.push_front(p1);
    myList.push_front(p2);
    myList.push_front(p3);

    list<point3> myList2 = translateFact(myList, 1, 1, 1);

    std::cout << myList2.front.x; //<--- This is the line I'm having trouble with
}

//Translates the face by dx, dy, dz coordinates
list<point3> translateFact(list<point3> lop, float dx, float dy, float dz)
{
    list<point3>::iterator iter;

    for (iter = lop.begin() ; iter != lop.end(); iter++){
        point3 p = *iter;
        iter->x - dx;
        iter->y - dy;
        iter->z - dz;
    }
    return lop;
} 
```

尝试打印 myList2.front.x 时收到的错误是

```
IntelliSense: a pointer to a bound function may only be used to call the function 
```

所以我认为我的问题与指针有关，但我不确定如何。我最近刚开始学习 C++，所以我对诊断/修复错误的指针知之甚少。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T01:21:22.417

您需要括号来表示您要调用该`front`方法：

```
std::cout << myList2.front().x; 
```

# c# - 从列表框到消息框的选定索引

> ID：10201519
> 
> 赞同：0
> 
> 时间：2012-04-18T01:20:52.193
> 
> 标签：c#, winforms

> **可能重复：**
> [在列表框中的消息框中显示信息](https://stackoverflow.com/questions/10201226/displaying-information-in-messagebox-from-listbox)

我正在编写一个程序，要求用户为他们的房子或公寓输入七个不同的参数。提交信息后，输入的地址将进入列表框。当用户单击单独的按钮时，七个参数应显示在消息框中。我已经有一个名为 DisplayInfo() 的方法，当它被调用时，它会在一列中显示信息，所以我只需要它的选定索引部分的帮助。

```
public virtual string DisplayInfo()
{
  return string.Format("Property ID: {0}\nProperty Address: {1}\nYear Built: {2}\nNumber of Bedrooms: {3}\nSquare Footage: {4}\nPrice: {5}",
    GetID(),
    GetAddress(),
    GetYearBuilt(),
    GetBedrooms(),
    GetSquareFootage(),
    GetPrice());
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T01:26:26.387

对于按钮，连接`Click`事件：

```
public Form1() {
  InitializeComponent();
  button1.click += new EventHandler(button1_Click);
}

void button1_Click(object sender, EventArgs e) {
  if (listBox1.SelectedIndex > -1) {
    MessageBox.Show(DisplayInfo());
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T03:36:14.430

嗨，在列表框的 selectedIndex 更改事件方法上调用您的“DisplayInfo”方法

```
Protected Void listBox1_SelectedIndexChanged(object sender, EventArgs e)
{
  if(listBox1.SelectedIndex!=-1)
  { 
     DisplayInfo(listBox1.SelectedItem.ToString());
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T01:28:11.103

```
if(lbox.SelectedItem != null)
 {
    DisplayInfo(lbox.SelectedItem);
 } 
```

# lambda - Lambda 表达式与 C# 中的语句混合

> ID：10201520
> 
> 赞同：0
> 
> 时间：2012-04-18T01:21:02.637
> 
> 标签：lambda, conditional, expression, operator-keyword

我有一部分代码，我必须在其中使用带有通过 lambda 语句获得的参数的函数（为简化起见，类似于此）：

```
Item.Move(Array.Exists(mainArray, arrayItem => 
(variable == secondArray[Array.IndexOf(mainArray, arrayItem)]))
? secondArray[Array.IndexOf(mainArray, arrayItem)
: new Vector2(-variable.X, variable.Y)); 
```

但是，问题在于，在条件运算符的第一个操作中，arrayItem 带有下划线，并且显示错误“当前上下文中不存在名称'arrayItem'”，即使它是在 lambda 的开头定义的.

因此，我尝试在 lambda 中添加一条语句，为外部定义的变量提供 arrayItem 的值，但它带来了许多错误。

有没有办法从 lambda 表达式中引用这个变量？我无法弄清楚为什么它没有在条件运算符中结转。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T05:36:38.683

尝试这个：

```
Array.Exists(mainArray, (arrayItem) =>
    {
        return variable == secondArray[Array.IndexOf(mainArray, arrayItem)];
    }); 
```

# jsf-2 - 带有 EL 2.2 的 JSF 2.x 为何允许将 MethodExpression 用于 ValueExpression？

> ID：10201522
> 
> 赞同：2
> 
> 时间：2012-04-18T01:21:09.840
> 
> 标签：jsf-2, el, rendered-attribute

我看到几个问题询问如何将参数传递给 JSF 方法。使用 EL2.2 和 servlet 3.0，它使用户能够将参数传递给方法调用。一个例子：[如何将参数从渲染的 h:outputText 传递给方法？](https://stackoverflow.com/questions/9436088/how-to-pass-an-argument-to-method-from-rendered-houtputtext)问题是：在 JSF 2.x 中，每个标记属性都应该采用 ValueExpression 或 MethodExpression。在链接的示例中，“rendered”应该只采用 ValueExpression。但是，我确实看到它仍然可以与 MethodExpression 一起使用，如果我们放置 () 以明确它是一个方法调用而不是一个属性。这是 JSF 2.x 规范刚刚搞砸的东西还是我遗漏了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T02:31:23.113

在值表达式中使用新的 EL 2.2 invoking-methods-with-arguments 语法不会自动使其成为方法表达式或其他东西。它仍然是一个价值表达。值表达式使用给定 EL 表达式的返回值作为值。方法表达式在与组件关联的操作事件上调用给定的 EL 表达式。

EL 表达式本身是否调用属性 getter 方法或带有参数的任意方法对于如何处理整个 EL 表达式实际上并不重要。

# jquery-ui - jQuery UI Draggable + css Line-Height 问题

> ID：10201527
> 
> 赞同：0
> 
> 时间：2012-04-18T01:21:49.700
> 
> 标签：jquery-ui, jquery-ui-draggable

我将 'Line-height' 属性设置为 .8，它会影响`<div id="bigtextContainer">`.

我的问题是 div 可以从其 [top + bottom] 边界之外拖动。我将 div 背景设置为“红色”，您可以在到达 [top + bottom] div 区域之前看到“移动”光标出现。Draggable 似乎正在使用原始行高，因为当使用删除行高时，div 可以在其正确范围内拖动。

这是我的例子：[我的 jsfiddle](http://jsfiddle.net/niczoom/6BRkE/13/)

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T01:28:18.353

开启`overflow:hidden;`_`#bigtextContainer`

# php - 带分页的php sql结果

> ID：10201529
> 
> 赞同：2
> 
> 时间：2012-04-18T01:21:53.743
> 
> 标签：php, mysql, pagination

我一直在这里和那里做一些代码，这些代码基本上从mysql中提取数据并通过php显示。结果在页面上一次显示 3 个，我从来没有遇到任何问题。

但是，我最近在数据库项目中添加了一个字段：“已售罄”和“有货”，并且正在尝试（悲惨地）进行两次搜索-首先我想显示库存中的项目，然后是那些已售罄的项目. 不幸的是，我多年来使用的分页代码不喜欢我运行两个 php 查询，而只是在页面中添加了 3 个额外的项目（如果适用）。

完整代码是：

```
 <form name="form1" method="get" action="products.php">
            <?php 
      if(!empty($msg)) {
      echo $msg[0];
      }
      ?>

             <input name="q" class="textInput2" input type="search" id="q" placeholder="search image name..." autosave="applestyle_srch" results="5" onKeyUp="applesearch.onChange('srch_fld','srch_clear')" />     

              <input name="doSearch" type="hidden" id="doSearch2" value="Search">

        <?php if ($get['doSearch'] == 'Search') {
      // find out how many rows are in the table 
$sql = "SELECT COUNT(*) FROM products";
$result = mysql_query($sql) or trigger_error("SQL", E_USER_ERROR);
$r = mysql_fetch_row($result);
$numrows = $r[0];

// number of rows to show per page
$rowsperpage = 3;
// find out total pages
$totalpages = ceil($numrows / $rowsperpage);

// get the current page or set a default
if (isset($_GET['currentpage']) && is_numeric($_GET['currentpage'])) {
   // cast var as int
   $currentpage = (int) $_GET['currentpage'];
} else {
   // default page num
   $currentpage = 1;
} // end if

// if current page is greater than total pages...
if ($currentpage > $totalpages) {
   // set current page to last page
   $currentpage = $totalpages;
} // end if
// if current page is less than first page...
if ($currentpage < 1) {
   // set current page to first page
   $currentpage = 1;
} // end if

// the offset of the list, based on current page 
$offset = ($currentpage - 1) * $rowsperpage;

      if($get['q'] == '') {  
    $sql = "SELECT * FROM products WHERE status='sold' ORDER BY `price` ASC LIMIT $offset, $rowsperpage";
      } 
      else { 
      $sql = "select * from products where `title` like '%$_REQUEST[q]%' LIMIT $offset, $rowsperpage";
      }

$result1 = mysql_query($sql) or trigger_error("SQL", E_USER_ERROR);

       if($get['q'] == '') {  
    $sql = "SELECT * FROM products WHERE status='in stock' ORDER BY `price` ASC LIMIT $offset, $rowsperpage";
      } 
      else { 
      $sql = "select * from products where `title` like '%$_REQUEST[q]%' LIMIT $offset, $rowsperpage";
      }

$result2 = mysql_query($sql) or trigger_error("SQL", E_USER_ERROR);

      ?></form></div>
 <div id="pagination" style="float:right; display:inline; margin-right:10px;">
          page:<?php

/******  build the pagination links ******/
// if not on page 1, don't show back links
if ($currentpage > 1) {
   // show << link to go back to page 1
   echo " <a href='{$_SERVER['PHP_SELF']}?q=&doSearch=Search&currentpage=1'><<</a> ";
   // get previous page num
   $prevpage = $currentpage - 1;
   // show < link to go back to 1 page
   echo " <a href='{$_SERVER['PHP_SELF']}?q=&doSearch=Search&currentpage=$prevpage'><</a> ";
} // end if
      // range of num links to show
$range = 3;

// loop to show links to range of pages around current page
for ($x = ($currentpage - $range); $x < (($currentpage + $range)  + 1); $x++) {
   // if it's a valid page number...
   if (($x > 0) && ($x <= $totalpages)) {
      // if we're on current page...
      if ($x == $currentpage) {
         // 'highlight' it but don't make a link
         echo " [<b>$x</b>] ";
      // if not current page...
      } else {
         // make it a link
         echo " <a href='{$_SERVER['PHP_SELF']}?q=&doSearch=Search&currentpage=$x'>$x</a> ";
      } // end else
   } // end if 
} // end for

// if not on last page, show forward and last page links        
if ($currentpage != $totalpages) {
   // get next page
   $nextpage = $currentpage + 1;
    // echo forward link for next page 
   echo " <a href='{$_SERVER['PHP_SELF']}?q=&doSearch=Search&currentpage=$nextpage'>></a> ";
   // echo forward link for lastpage
   echo " <a href='{$_SERVER['PHP_SELF']}?q=&doSearch=Search&currentpage=$totalpages'>>></a> ";
} // end if
/****** end build pagination links ******/
?>
          </div>

    </div>
    </div>

</div></p>

<div class="category-products">

  <form name "searchform" action="products.php" method="post">

   <?php while($rrows = mysql_fetch_array($result2))
{
    echo '<div><div id="searchimage"><a class="product-image" href="productspec.php?productcode=' . $rrows['productcode'] . '" title="' . $rrows['title'] . '">';
    echo '<img src="' . $rrows['photo'] . '" width="225" height="150" alt="" title="' . $rrows['title'] . '" /></a></div>';
    echo '<div id="searchdetails">
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr>
    <td height="30"><h3 class="product-name"><a href="productspec.php?productcode=' . $rrows['productcode'] . '" title="' . $rrows['title'] . '">' . $rrows['title'] . '</a></h3>';
    echo '</td>
  </tr>
  <tr>
    <td>' . $rrows['desc'] . '';
    echo '</td>
  </tr>
   <tr>
    <td><h3 class="price">&pound;' . $rrows['price'] . '&nbsp;' . $rrows['pandp'] . '</h3>'; echo '</td>
  </tr>
</table></div>';
echo '</div>';
}
?>

 <?php while($rrows = mysql_fetch_array($result1))
{
    echo '<div><div id="searchimage"><a class="product-image" href="productspec.php?productcode=' . $rrows['productcode'] . '" title="' . $rrows['title'] . '">';
    echo '<img src="' . $rrows['photo'] . '" width="225" height="150" alt="" title="' . $rrows['title'] . '" /><img src="soldout.png" id="soldout" /></a></div>';
    echo '<div id="searchdetails">
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr>
    <td height="30"><h3 class="product-name"><a href="productspec.php?productcode=' . $rrows['productcode'] . '" title="' . $rrows['title'] . '">' . $rrows['title'] . '</a></h3>';
    echo '</td>
  </tr>
  <tr>
    <td>' . $rrows['desc'] . '';
    echo '</td>
  </tr>
   <tr>
    <td><h3 class="price">&pound;' . $rrows['price'] . '&nbsp;' . $rrows['pandp'] . '</h3>'; echo '</td>
  </tr>
</table></div>';
echo '</div>';
}
?>

  </form> <?php } ?> 
```

我完全可以理解代码可以更简洁——（我多年来一直没有修改分页过程，因为它一直有效）——但我假设必须有一种更简单的方法来显示表格中的所有项目而不必运行 $result1 和 $result2 查询。

非常感谢任何帮助！

京东

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T20:57:58.980

这是我为我编写的电路板制作的功能。我希望这对您有所帮助。（对我来说）有点乱，因为我有一段时间没有更新了。

此函数要求的 5 个必需变量是行数、页面的 url 以使链接正常工作、“每页帖子”基本上意味着每页需要多少个结果（默认 20）、名称链接，因此如果您希望下一页出现在页面链接上，最后如果您想更改 $_GET 要将页面更改为的内容。默认为 $_GET['page']。

```
 function pagelinks($numrows, $primaryurl, $ppp=20, $aname="", $getpage="default")
   {
    global $baseurl; //this is for something like http://somesite.com/

    //If the GET method is not defined, $_GET[page] is used.
   if ($getpage == "default")
    {
     $page = intval($_GET['page']);
     $getpage = "page";
    }
   else
    {
     $page = intval($_GET[$getpage]);
    }
    $ppp = intval($ppp);

   if ($aname != "")
    {
     $linkname = "#$aname";
     //$linkname2 = "<a name=\"next_page\"></a>";
    }

    //If we don't define the posts/articles per page, we go to a postsperpage user default.
   if ($ppp == 0)
    {
     $ppp = 20;
    }

    //If the page is negative, we define it 1.
   if (intval($page) < 0)
    {
     $page = 1;
    }

    //If the GET page is higher than the highest possible, we make it the highest limiting page.
   if (($numrows / $ppp + 1) < intval($page))
    {
     $page = intval($numrows / $ppp + 1);
    }

    //If the url doesn't point to any page, we just set it to the first group of the query limit.
   if (!$page)
    {
     $page = 1;
    }
    $min = (($page - 1) * $ppp);
    $maxnum = floor($numrows / $ppp);
    $pages = "<center><small>Pages:</small><br>";
    //If we are on the first page, don't link to any previous pages because there are none
    //Else we link the arrow to the page one less than current.
   if (($page - 1) <= 0)
    {
     $pages .= "<img src=\"$baseurl/boardfiles/images/previous_mono.gif\" border=\"0\" alt=\"\">";
    }
   else
    {
     $pages .= "<a href=\"".$primaryurl."&amp;$getpage=".($page-1)."$linkname\"><img src=\"$baseurl/boardfiles/images/previous.gif\" border=\"0\" alt=\"<\"></a>";
    }
   for ($i = 0; $i <= $maxnum; $i++)
    {
     $i2 = $i+1;
    if ($i != $maxnum || ($numrows / $ppp) != (floor($numrows / $ppp)) || !$numrows)
     {
      //If the page number matches our page, it isn't linked.
      //Else we keep linking all existing page numbers.
     if ($page == $i2)
      {
       $pages .= " $i2";
      }
     else
      {
       $pages .= " <a href=\"".$primaryurl."&amp;$getpage=".($i + 1)."$linkname\">".($i + 1)."</a>";
      }
     }
    else
     {
      $lastcutoff = 1;
     }
    }
    //If we are on the last page, don't link to the next page because we are on the top one.
    //Else we link the arrow to the page one more than current.
   if ($page > $maxnum || ($lastcutoff && $page > $maxnum - 1))
    {
     $pages .= " <img src=\"$baseurl/boardfiles/images/next_mono.gif\" border=\"0\" alt=\"\">";
    }
   else
    {
     $pages .= " <a href=\"".$primaryurl."&amp;$getpage=".($page+1)."$linkname\"><img src=\"$baseurl/boardfiles/images/next.gif\" border=\"0\" alt=\">\"></a>";
    }
    $pages .= "</center>";
    $return['pages'] = $pages;
    $return['querylimit'] = " LIMIT $min, $ppp";
    $return['min'] = $min; //Used in users.php
    return $return;
   } 
```

现在您需要稍微更改代码以适应您的需要，但接下来您需要将其放在查询中。这是一些示例用法：

```
 #-- Page Stuff --#  
  $articlesperpage = 10;
  $numrows = $misc['totalarticles'];

  $p = pagelinks($numrows, "$baseurl/?p=news", $articlesperpage);
  $pages = $p['pages'];
  #-- Page Stuff --#  

  $allnews = sql_query("SELECT * FROM `news` ORDER BY `id` DESC$p[querylimit]"); 
```

重要的是使用 $p[querylimit] 来限制您的查询并使用 $pages 作为分页链接。希望这是有用的！

编辑：我最近还创建了另一个您可能想要的分页功能，而不是上面的，因为这个功能使用选择选项列表而不是一堆链接。我还修复了一个小时前注意到的错误。有趣的是，当我再次讨论这个问题时，我是如何抓住它的。

```
 function pagination2($numrows, $primaryurl, $ppp=20)
   {
    global $baseurl;

    $page = intval($_GET['page']);
    $ppp = intval($ppp);

    //If we don't define the posts/articles per page, we go to a postsperpage user default.
   if ($ppp == 0)
    {
     $ppp = 20;
    }

    //If the page is negative, we define it 1.
   if (intval($page) < 0)
    {
     $page = 1;
    }

    //If the GET page is higher than the highest possible, we make it the highest limiting page.
   if (($numrows / $ppp) < intval($page))
    {
     $page = intval($numrows / $ppp);
    }

    //If the url doesn't point to any page, we just set it to the first group of the query limit.
   if (!$page)
    {
     $page = 1;
    }
    $min = (($page - 1) * $ppp);
    $maxnum = floor($numrows / $ppp);

    $pages = "<select onchange=\"window.location.href=this.value;\" style=\"font-size: 8pt;\">";

   for ($i = 0; $i <= $maxnum; $i++)
    {
     $i2 = $i + 1;
    if ($i != $maxnum || ($numrows / $ppp) != (floor($numrows / $ppp)) || !$numrows)
     {
     if ($page == $i2)
      {
       $pages .= "<option value=\"$primaryurl&amp;page=$i2\" selected>Page $i2</option>";
      }
     else
      {
       $pages .= "<option value=\"$primaryurl&amp;page=$i2\">Page $i2</option>";
      }
     }
    }

    $pages .= "</select>";

    $return['pages'] = $pages;
    $return['querylimit'] = " LIMIT $min, $ppp";
    $return['min'] = $min; //Used in users.php
    return $return;
   } 
```

# c - 评论标准 C

> ID：10201534
> 
> 赞同：3
> 
> 时间：2012-04-18T01:22:31.270
> 
> 标签：c, comments

我与佐治亚理工学院的一个名为 Solar Jackets 的团队合作，我们一直处于“评论危机”之中。我们有很多成员毕业了，留下了无注释的代码。我正在寻求实施一个评论标准，这样就不会发生这种情况，我需要一些建议来确保我已经涵盖了所有的基础。

我想要的是以下功能：

*   一个统一的地方，您可以在其中查看每个函数的描述，包括包含、参数、返回类型和代码的一般描述。（从代码中的注释生成）

*   在代码本身中，逐行（或接近）描述。

对我可能遗漏的内容有什么建议吗？有没有可以自动生成代码编译的程序？我怎样才能让程序员更容易做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-18T01:26:45.310

你的描述让我想起了 Doxygen。它有一种格式，用于注释代码中的所有实体，包括函数、参数、变量……它可用于通过检查 Doxygen 生成的警告来强制记录所有内容。它以不同格式（如 HTML、Latex、PDF 等）从源代​​码生成完整的文档...

许多 IDE 都知道 Doxygen 标签，并且可以与 Doxygen 集成以帮助开发人员对代码进行注释。

这是 Doxygen 评论的示例：

```
/**
 * @brief This function does blah blah.
 * @param test blah blah parameter.
 * @return 0 if blah blah passed.
 */
uint32_t TestFunction( uint32_t test )
{
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T01:30:07.013

*   养成良好的编码习惯。变量名称和方法标题应该是描述性的，并特别关注他们正在执行的任务。例如，如果您有一个交换两个元素的方法，调用它就`swap()`足够了。

*   使用文档生成工具，例如[Doxygen](http://www.doxygen.nl/)或[Sphinx](http://sphinx.pocoo.org/)。

*   鼓励使用其他 API（例如[Java 7 API](http://docs.oracle.com/javase/7/docs/api/)）作为可读性指南，以及该做什么（或不做什么）。

我可能应该强调，*过多的*文档会非常分散注意力。让程序员——他们是他们的软件在做什么方面的专家——给出一个高层次的概述，以便于记录。如果他们想要或必须这样做，那么让他们按照自己的方式解释复杂或令人费解的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T01:32:38.370

在我的新工作中，我们尽量避免使用评论。代码应该是自记录的。允许对棘手的代码或错误修复等进行一些小的注释，但日常编程根本不包含任何注释。

我们使用代码审查会议，以便所有团队成员都可以阅读和研究新代码，如果它不干净且不易于阅读，则会对其进行重构。通常，在命名表达式中包含局部变量，而不是重用变量并为常量文字添加#defines 就可以完成这项工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T01:50:30.073

对代码的逐行注释听起来很可怕。

*   您需要在函数的开头添加注释来确定它的作用。
    *   如果参数等不明显，则应进行讨论。
    *   否则，它应该尽可能简短，最好只有一行。
    *   如果函数比较复杂，注释大一点可能比较合适；使用判断。
*   您通常需要包含公司或项目的许可证和版权标识的文件标题注释，以及有关文件总体用途的注释。
*   您应该记录定义的变量（应该主要是`static`变量；您不使用全局变量，对吗？）。
*   您可能需要对函数内的代码段进行注释，最好使用简短（一行）注释。
*   有时，您需要记录不明显或晦涩难懂的内容（可能参考相关的错误报告）。
*   除了局部变量定义之外，您应该很少需要尾部注释。

否则，代码应该在很大程度上解释自己，使注释变得多余。

请注意，未描述当前代码的注释是令人讨厌的。就在昨天，我删除了一条在 1990 年明确添加的评论——日期在评论中——描述了 1990 年的现状，当时一个特定的函数正在模拟“可变参数”。代码早已更新，因此函数被视为具有 7 个固定参数；最后四个在不需要时可以为空。因此，评论不再准确，而是十年或更长时间。它去。为什么其他人没有注意到？可能是因为没有人第一次阅读该文件时没有导师指导他们越过错误的评论。或者可能是因为注释离函数太远了（在注释和它错误描述的函数之间有一个完全独立的，尽管很小的函数）。所以，

还要注意，对于同一段代码，专家需要什么和新手需要什么可能完全不同。您必须判断什么级别的评论才有意义，但我建议您在文章中犯错，因为当需要修改代码时，两个描述中的一个将无法正确维护，并且很可能是未维护的评论。对于新手来说，误导性的评论比专家更可怕！因此，请确保您不会因为没有任何可避免的评论而获得不准确的评论。

# php - PHP：获取调用引用的数组名称

> ID：10201538
> 
> 赞同：2
> 
> 时间：2012-04-18T01:22:59.027
> 
> 标签：php, function

假设以下函数和调用：

```
function doSomething( &$someArray ) {
    // Do something to $someArray
}

$names=array("John", "Paul", "George", "Ringo");
doSomething($names); 
```

有没有办法从函数中获取引用数组的名称（在本例中为“名称”）？我知道我可以重构为函数添加另一个参数作为数组变量的名称，但这只是招致错误。用例是对于每个数组 $someSillyName，函数需要访问数据库表 someSillyName。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T01:27:02.080

否。*
如果`"names"`是`doSomething`完成其工作的必要信息，请将其作为参数传递。

[* 你可以使用调试回溯和大量的自省，但这太*疯狂*了。调用者范围内的变量名应该绝对不会影响任何事情。]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T01:35:03.580

在 PHP 中没有办法做到这一点。

此外，您应该避免在应用程序逻辑中使用变量名。想象一下，有人将您的 $name 重构为其他内容。您可以像这样修改数组：

```
$dbData = array(
    'names' => array("John", "Paul", "George", "Ringo")
); 
```

这也应该对您应用程序的其他部分有所帮助。如果你真的想这样做，我建议创建一个封装这个数组并提供类似`getDatabaseName();`和`getData();`

# arduino - 如何使用 I2C 为液晶 LCD 屏幕编程 Arduino？

> ID：10201539
> 
> 赞同：0
> 
> 时间：2012-04-18T01:22:59.477
> 
> 标签：arduino, lcd

我试图让文本字符出现在我的液晶 LCD 屏幕上。这是一个 16x2 的屏幕。它只使用四个引脚……GND、5 V、SCL 和 SDA 引脚。我不确定如何对其进行编程，因为我在网上找到的只是如果我的屏幕有 16 个引脚可以连接以进行编程，那么如何对其进行编程。我相信我的 LCD 屏幕的地址是 0x27。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T05:48:06.707

在 Arduino 游乐场上查看[此页面，该页面](http://arduino.cc/playground/Code/LCDi2c)有一些用于某些 LCD I2C 显示器的库。

您的特定型号可能没有 Arduino 库。

# python - 使用 python 请求和 json 发布文件

> ID：10201540
> 
> 赞同：1
> 
> 时间：2012-04-18T01:23:05.990
> 
> 标签：python, json, post, curl, python-requests

作为 API 文档的一部分，我得到了以下 curl 命令，我正在尝试使用 requests 库来实现它。

```
curl -v --cookie cookie.txt -X POST -H 'Accept: application/json' -F 'spot[photo]'=@rails.png -F 'spot[description]'=spot_description -F 'spot[location_id]'=9  -F 'spot[categories][]'='See the Sights' -F 'spot[categories][]'='Learn Something' http://some.server.com/api/v1/spots 
```

我的 python 代码看起来像这样：

```
import requests
import json

_user = 'redacted'
_password = 'redacted'
_session = requests.session()
_server = 'http://some.server.com'

_hdr = {'content-type': 'application/json', 'accept': 'application/json'}

_login_payload = {
    'user': {
        'email': _user,
        'password': _password
    }
}
r = _session.post(_server + "/users/sign_in", data=json.dumps(_login_payload), headers=_hdr)
print json.loads(r.content)

_spot_payload = {
    'spot': {
        'photo': '@rails.gif',
        'description': 'asdfghjkl',
        'location_id': 9,
        'categories': ['See the Sights',]
    }
}
r = _session.post(_server + '/api/v1/spots', data=json.dumps(_spot_payload), headers=_hdr)
print json.loads(r.content) 
```

我听说你可以使用 open('file').read() 来发布文件，但是 json 编码器不太喜欢这样，我不确定是否有解决方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T19:59:33.133

```
C:\>cat file.txt
Some text. 
```

当您发出此命令时：

```
C:\>curl -X POST -H "Accept:application/json" -F "spot[photo]=@file.txt"
-F "spot[description]=spot_description" http://localhost:8888 
```

发送的内容如下所示：

> POST / HTTP/1.1 用户代理：curl/7.25.0 (i386-pc-win32) libcurl/7.25.0 OpenSSL/0.9.8u zlib/1.2.6 libssh2/1.4.0 主机：localhost:8888 接受：application/ json 内容长度：325 预期：100 继续内容类型：multipart/form-data；边界=----------------------------e71aebf115cd
> 
> ------------------------------e71aebf115cd 内容处置：表单数据；名称=“地点[照片]”；filename="file.txt" 内容类型：文本/纯文本
> 
> 一些文字。------------------------------e71aebf115cd 内容处置：表单数据；名称=“地点[描述]”
> 
> spot_description ------------------e71aebf115cd--

如您所见， curl 发送`Content-Type`设置为`multipart/form-data;`Requests的请求[支持](http://docs.python-requests.org/en/latest/user/quickstart/#post-a-multipart-encoded-file)使用相同的`Content-Type`. 您应该`files`为此使用参数。

```
(2.7) C:\>python
Python 2.7.3 (default, Apr 10 2012, 23:24:47) [MSC v.1500 64 bit (AMD64)] on win32
Type "help", "copyright", "credits" or "license" for more information.
>>> import requests
>>> requests.__version__
'0.11.1'
>>> requests.post('http://localhost:8888', files={'spot[photo]': open('file.txt', 'rb')}, data={'spot[description]': 'spot_description'})
<Response [200]> 
```

发送的内容如下所示：

```
POST http://localhost:8888/ HTTP/1.1
Host: localhost:8888
Content-Length: 342
Content-Type: multipart/form-data; boundary=192.168.1.101.1.8000.1334865122.004.1
Accept-Encoding: identity, deflate, compress, gzip
Accept: */*
User-Agent: python-requests/0.11.1

--192.168.1.101.1.8000.1334865122.004.1
Content-Disposition: form-data; name="spot[description]"
Content-Type: text/plain

spot_description
--192.168.1.101.1.8000.1334865122.004.1
Content-Disposition: form-data; name="spot[photo]"; filename="file.txt"
Content-Type: text/plain

Some text.
--192.168.1.101.1.8000.1334865122.004.1-- 
```

# python - Tkinter GUI 中的菜单、按钮等栏

> ID：10201541
> 
> 赞同：2
> 
> 时间：2012-04-18T01:23:15.483
> 
> 标签：python, tkinter

我正在尝试启动一个 Tkinter 应用程序，该应用程序遵循[Tkinter Gui 中的 Class 菜单以](https://stackoverflow.com/questions/3520494/class-menu-in-tkinter-gui)保持整洁，但也为按钮栏、RadioButton 栏等添加此功能。例如：

```
from Tkinter import *

def clickTest():
    print "Click!"

class App(Tk):
    def __init__(self):
        Tk.__init__(self)
        menuBar = MenuBar(self)
        buttonBar = ButtonBar(self)

        self.config(menu=menuBar)
        buttonBar.grid(row=0, column=0) ???

class MenuBar(Menu):
    def __init__(self, parent):
        Menu.__init__(self, parent)

        fileMenu = Menu(self, tearoff=False)
        self.add_cascade(label="File", menu=fileMenu)
        fileMenu.add_command(label="Exit", command=clickTest)

class ButtonBar(Frame):
    def __init__(self, parent):
        Frame.__init__(self, parent)

        firstButton = Button(parent, text="1st Button", command=clickTest)
        secondButton = Button(parent, text="2nd Button", command=clickTest)

if __name__ == "__main__":

    app = App()
    app.mainloop() 
```

但我不确定如何让所有这些都显示在同一个窗口中。当然，原样的代码是行不通的。任何建议表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T01:41:02.777

用`pack()`. 我相信它也可以完成，`grid()`但我对它不太熟悉。

```
from Tkinter import *

def clickTest():
    print "Click!"

class App(Tk):
    def __init__(self):
        Tk.__init__(self)
        menuBar = MenuBar(self)
        buttonBar = ButtonBar(self)

        self.config(menu=menuBar)
        buttonBar.pack()

class MenuBar(Menu):
    def __init__(self, parent):
        Menu.__init__(self, parent)

        fileMenu = Menu(self, tearoff=False)
        self.add_cascade(label="File", menu=fileMenu)
        fileMenu.add_command(label="Exit", command=clickTest)

class ButtonBar(Frame):
    def __init__(self, parent):
        Frame.__init__(self, parent)

        firstButton = Button(self, text="1st Button", command=clickTest).pack()
        secondButton = Button(self, text="2nd Button", command=clickTest).pack()

if __name__ == "__main__":

    app = App()
    app.mainloop() 
```

* * *

另一件事是，您应该将按钮的父级设置为 Frame，如下所示：

```
firstButton = Button(self, text="1st Button", command=clickTest).pack() 
```

在这里我改变`parent`了`self`。`self`是框架本身，而不是整个顶层窗口。通过`pack()`功能，我将按钮打包在其父级中，在本例中为 Frame。

然后`buttonBar.pack()`我在顶层窗口中打包了buttonBar。您也可以在此处和 Frame 中使用网格。

# java - 如何使用 GSON 指定序列化？

> ID：10201544
> 
> 赞同：3
> 
> 时间：2012-04-18T01:23:51.277
> 
> 标签：java, android, json, gson

编辑：已解决，当我允许时将标记我的答案:)

我正在使用 greenDAO 生成一堆类，当我尝试让 GSON 序列化它们时，它似乎试图序列化 greenDAO 生成的一些字段（我不感兴趣）并崩溃。我希望序列化的对象引用其他生成的对象和生成的对象列表。

GSON 说它允许由 toString() 方法描述的序列化，我尝试了不同的方法，但是当我检查文件的输出时，它只是显示为 toString() 方法。有人可以告诉我如何从 toString() 方法生成 JSON 对象，或者建议另一种方法来进行自定义序列化。

我的感谢:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T22:39:09.047

最后想通了 :) 原来我需要为我的每个对象实现一个 JsonSerializer 并手动指定序列化。很乏味！对其他对象的引用需要嵌套，我通过使用该`toJsonTree()`方法来做到这一点。这是我最易读的序列化程序

```
private class InfoSerializer implements JsonSerializer<Info>
{
    @Override
    public JsonElement serialize(Info src, Type typeOfSrc,
            JsonSerializationContext context)
    {
         JsonObject obj = new JsonObject();
         obj.addProperty("details", src.getDetails());
         obj.addProperty("hostId", src.getHostId());
         obj.addProperty("dateCreated", src.getDateCreated().toString());
         obj.addProperty("expiryDate", src.getExpiryDate().toString());
         obj.add("alternativeInfo", getGsonInstance().toJsonTree(src.getAlternativeInfo()));
         obj.add("alternativeTimes", getGsonInstance().toJsonTree(src.getAlternativeTimes()));
         return obj;
    }   
} 
```

注意：`getGsonInstance()`是我编写的返回单例 Gson 对象的方法。

它被称为：

```
public String infoToJson(Info i)
{
    GsonBuilder gson = new GsonBuilder();
    gson.registerTypeAdapter(Info.class, new InfoSerializer());
    return gson.create().toJson(i);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T22:44:28.107

如果您只是想避免序列化某些字段，请记住您可以用`transient`关键字标记它们。这意味着它们不会被 Gson 序列化。

# mupdf - 如何构建共享的 MuPDF 库？

> ID：10201548
> 
> 赞同：2
> 
> 时间：2012-04-18T01:24:46.450
> 
> 标签：mupdf

[根据较旧的Makfile](http://mupdf.com/repos/mupdf/Makefile)和 Internet 资源 ，默认情况下[MuPDF](http://www.mupdf.com)应构建静态库。

我现在想构建其他项目所需的 MuPDF 共享库，它甚至不包括当前[Makefile](http://git.ghostscript.com/?p=mupdf.git;a=blob;f=Makefile;h=a5fdbc4959b95e6897376b0689b686a8d0668b3b;hb=HEAD)中静态库的规则。
可以看出它仅包含规则`libfitz.a`（也许 mupdf 库包含在其中，我不知道，因为除了浏览源代码我没有看到任何文档）

以防万一，我在 Makerules 文件中添加了 CFLAGS 变量，但除了静态库和各种 mupdf 可执行`-fPIC`文件外，我什么也没得到。`libfitz.a`

如何构建 MuPDF 共享库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-06T09:29:44.583

见：[http ://bugs.ghostscript.com/show_bug.cgi?id=693009](http://bugs.ghostscript.com/show_bug.cgi?id=693009)

# php - 使用 jquery fullcalender 按数据库值将值附加到粗体

> ID：10201553
> 
> 赞同：0
> 
> 时间：2012-04-18T01:25:52.173
> 
> 标签：php, jquery, mysql, css, json

我正在使用带有 jQ​​uery 的 fullcalender，我想知道它是否可能，如果我的数组有，`'bold' = true/false,`我可以使用 jquery 将一个新类附加到它。

```
$(document).ready(function() {
    $('#calendar').fullCalendar({
        editable: false,
        allDay: false,
        events: "json-events.php",
        eventDrop: function(event, delta) {
            alert(event.title + ' was moved ' + delta + ' days\n' +
                '(You cannot update these fields!)');
        },
        loading: function(bool) {
            if (bool) $('#loading').show();
            else $('#loading').hide();
        },
    });
}); 
```

如果我有一个数据库值 id 'bold'，我可以让 jquery 添加一个样式'title'。

```
$result = $dbh->query($sql)->fetchAll(PDO::FETCH_ASSOC);

foreach ($result as $row){
$return[]=array('id'=>$row['id'],
                'title'=>$row['title'],
                'start'=>$row['start'].' '.$row['time'],
                'end'=>$row['end'],
                'url'=>$row['url'],
                'backgroundColor'=>$row['backgroundColor'],
                'textColor'=>$row['textColor'],
                'borderColor'=>$row['borderColor'],
                'description'=>$row['description'],
                "allDay" => false);
}
$dbh = null;

header('Content-type: application/json');
echo json_encode($return); 
```

我想使用 jQuery 或编辑 phpscript 可能。但我不想编辑 fullcalender.js 文件。

**编辑**

我一直在研究这个，如果 events:"json-events.php" 我可以添加一个函数来为 css 添加粗体样式。

```
 $(document).ready(function() {
    $('#calendar').fullCalendar({
        editable: false,
        allDay: false,
        events: function() {... 
```

也许通过添加 getElementById 的变量，如果它是真的，让它附加一个样式到 css。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T02:39:11.970

不完全确定它是否是您需要的，但是当您将鼠标悬停在日期上时，我使用此代码将类添加到 jquery 日历中的某些元素。如果您将鼠标悬停的日期包含一个元素，则会打开一个工具提示，其中包含有关该特定元素的详细信息。

```
/// <reference path="jquery-1.7.1-vsdoc.js" />

$(document).ready(function () {
    $.getJSON("getProductJSON.json", null,
        function (data) {
            $('#calendar').fullCalendar({
                editable: false,
                theme: true,
                header: {
                    left: 'prev,next today',
                    center: 'title'
                },
                events: data,
                eventMouseover: function (calEvent, jsEvent) {
                    xOffset = 1;
                    yOffset = 8;

                $("body").append(GetEventDetails(calEvent));
                $("#tooltip")
                        .css("top", (jsEvent.clientY + yOffset) + "px")
                        .css("left", (jsEvent.clientX - xOffset) + "px")
                        .fadeIn("fast");
            },
            eventMouseout: function (calEvent, jsEvent) {
                $("#tooltip").remove();
            },
            eventClick: function (calEvent, jsEvent) {

                w = window.open('', 'More details Event: ', 'width=300,height=200')
                w.document.write(GetEventDetails(calEvent));
                w.focus();
                return false;
            }
        });
    }
);
});

function GetEventDetails(e) {
    var output = "<p id='tooltip'>";
    output += "<label class='tt'> Heure :</label>" + e.heure + "<br />";
    output += "<label class='tt'> Durée :</label>" + e.duree + "<br />";
    output += "<label class='tt'> Description :</label><br />" + e.desc + "</p>";
    return output;

}

JSON data :
[
 {  "title":"souper pizza", "desc":"5 a 7 pizza, initiation", "start":"2012/02/29","heure":"17:00:00","duree":"120",
    "url": "#"
 },
 {  "title":"cours","desc":"cours6gei470","start":"2012/02/12","heure":"16:00:00","duree":"180",
    "url": "#"},
 {  "title":"Cool","desc":"Cool Yo","start":"2012/02/1","end":"2012/02/4","heure":"16:00:00","duree":"999",
    "url": "#"}
] 
```

# linq - 可以在存储库之外使用 Linq 而不会泄漏提供程序并且仍然在数据库内部进行过滤吗？

> ID：10201563
> 
> 赞同：0
> 
> 时间：2012-04-18T01:27:39.807
> 
> 标签：linq, linq-to-entities, repository-pattern

是否使用 Linq 在存储库外部构建查询，同时仍然可以过滤数据库中的数据，而无需将 Linq 暴露/泄漏到存储库外部的实体？显然，我可以将 Lamba 表达式构造为 Query() 方法甚至规范对象的参数，但我希望以某种方式使用 Linq 创建高效的即席查询，而不管存储库中使用什么数据提供者。

例如：

```
var myProductID = myRepo.Query()
                  .Where( p => p.color.Contains("green") )
                  .Select( p => p.ID.ToString() ); 
```

这些概念似乎相互排斥。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T01:38:18.560

> 但我希望以某种方式使用 Linq 创建高效的临时查询，而不管存储库中使用什么数据提供程序。

这个想法注定要失败。看，问题是不是每个 lambda 表达式都可以被每个 LINQ 提供程序翻译成该提供程序可以处理的东西。这就是可怕的“LINQ to Entities 无法识别该方法......”或其他 LINQ 提供程序的类似异常消息的来源。LINQ to SQL 可以处理某些表达式，但 LINQ to Entities 不能，反之亦然。为 NHibernate 中的 LINQ 提供程序抛出类似的问题。

简而言之，公开一种 LINQy 方式来通过存储库进行查询是一种泄漏抽象。避免，避免，避免。

# java - 计算目录中的图像

> ID：10201565
> 
> 赞同：4
> 
> 时间：2012-04-18T01:27:52.720
> 
> 标签：java, file, count, detect

我想计算一个目录中有多少图像。我有一些来自互联网的代码副本，可以检测目录中的总文件。

```
import java.io.*;

public class CountFilesInDirectory {
      public static void main(String[] args) {
            File f = new File("/home/pc3/Documents/ffmpeg_temp/");
            int count = 0;
            for (File file : f.listFiles()) {
                    if (file.isFile()) {
                            count++;
                    }
            }
            System.out.println("Number of files: " + count);
    }
} 
```

我想计算一个特定的文件类型，比如 jpg/txt。我该怎么办？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T01:30:57.320

改变这个

```
if (file.isFile()) { 
  count++; 
} 
```

到

```
if (file.isFile() &&
    (file.getName().endsWith(".txt") || file.getName().endsWith(".jpg"))) { 
  count++; 
} 
```

这段代码所做的不仅仅是检查由 表示的实体是否`file`实际上是一个文件（而不是一个目录），您还检查它的名称是否以您正在寻找的特定扩展名结尾

注意：您可以使用 String.toLowerCase() 方法在比较之前将名称转换为更准确。

更新（基于注释）：对于更多 OOP 解决方案，您可以实现`java.io.FilenameFilter`接口并将其实例传递给`f.listFiles()`- 从而使您能够在程序的另一部分重用该过滤器而无需太多代码重复。如果使用这种方法，则需要将`endsWith`逻辑移动到`FilenameFilter`实现中

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-18T04:51:28.527

请参阅类似的方法[`File.listFiles(FilenameFilter)`](http://docs.oracle.com/javase/7/docs/api/java/io/File.html#listFiles%28java.io.FilenameFilter%29)。一旦`FilenameFilter`创建了 并且您将父目录设置为`File`，就可以使用 .. 获取计数。

```
int filesOfInterest = parentDir.listFiles(textAndJpegFilenameFilter).length; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T01:30:55.573

您需要的是一种数据结构，可用于存储每个扩展名的文件数。`Map<String /*extension*/, Integer /*count*/>`将是一个不错的选择。

对于每个文件，您首先将其扩展名确定`.`为其名称中最后一个之后的所有内容。然后检查地图是否有该扩展名的条目。如果存在，则将其加一，如果不存在，则创建一个计数为 1 的新条目。

当然，这将告诉您每个扩展名的文件数，要查找图像数，您需要知道哪些扩展名将具有图像文件，这几乎是不可能的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T01:32:55.213

下面的方法是检查 MIME 类型的方法：

```
InputStream is = new BufferedInputStream(new FileInputStream(file));
mimeType = URLConnection.guessContentTypeFromStream(is); 
```

查看这篇文章了解更多详情：[Getting A File's Mime Type In Java](https://stackoverflow.com/questions/51438/getting-a-files-mime-type-in-java/847849#847849)

即使不是所有类型的文件都有所有 MIME 类型，我认为它会解决您的问题。 **这样，您可以确保它是图像并继续计数。**

希望能帮助到你！=D

# javascript - 编辑脚本以包含复选框以订购总计

> ID：10201568
> 
> 赞同：1
> 
> 时间：2012-04-18T01:28:13.613
> 
> 标签：javascript, checkbox, sum

我有这个脚本：

```
//CODE BELOW THIS POINT IS NOT MINE//

/* This script is Copyright (c) Paul McFedries and 
Logophilia Limited (http://www.mcfedries.com/).
Permission is granted to use this script as long as 
this Copyright notice remains in place.*/

function CalculateTotal(frm) {
var order_total = 0

// Run through all the form fields
for (var i=0; i < frm.elements.length; ++i) {

    // Get the current field
    form_field = frm.elements[i]

    // Get the field's name
    form_name = form_field.name

    // Is it a "product" field?
    if (form_name.substring(0,4) == "PROD") {

        // If so, extract the price from the name
        item_price = parseFloat(form_name.substring(form_name.lastIndexOf("_") + 1))

        // Get the quantity
        item_quantity = parseInt(form_field.value)

        // Update the order total
        if (item_quantity >= 0) {
            order_total += item_quantity * item_price

    //My attempt at updating order total for checkbox
           if(document.checkbox.select[i].checked)  
        {
            order_total = item_price

       }

        }
    }
}

// Display the total rounded to two decimal places
frm.TOTAL.value = round_decimals(order_total, 2)
}

function round_decimals(original_number, decimals) {
var result1 = original_number * Math.pow(10, decimals)
var result2 = Math.round(result1)
var result3 = result2 / Math.pow(10, decimals)
return pad_with_zeros(result3, decimals)
 }

function pad_with_zeros(rounded_value, decimal_places) {

// Convert the number to a string
var value_string = rounded_value.toString()

// Locate the decimal point
var decimal_location = value_string.indexOf(".")

// Is there a decimal point?
if (decimal_location == -1) {

    // If no, then all decimal places will be padded with 0s
    decimal_part_length = 0

    // If decimal_places is greater than zero, tack on a decimal point
    value_string += decimal_places > 0 ? "." : ""
}
else {

    // If yes, then only the extra decimal places will be padded with 0s
    decimal_part_length = value_string.length - decimal_location - 1
}

// Calculate the number of decimal places that need to be padded with 0s
var pad_total = decimal_places - decimal_part_length

if (pad_total > 0) {

    // Pad the string with 0s
    for (var counter = 1; counter <= pad_total; counter++) 
        value_string += "0"
    }
return value_string
}
//CODE ABOVE THIS POINT IS NOT MINE// 
```

你定义了一个项目的价格，它的 id 是这样的：

```
 <input type="text" name="PROD_CH_35.00" onChange="CalculateTotal(this.form)"> 
```

这是复选框功能代码：

```
function totalcheckbox() {
document.checkbox.TOTAL.value = ''; //I set the value of all the checkboxes equal to nothing
var total = 0;
//For loop iterates through all the checkboxes. ++ adds one each time to i.
for (i=0;i<document.checkbox.select.length;i++) {
      if (document.checkbox.select[i].checked) {
        total = total + parseInt(document.checkbox.select[i].value); //take whatever they selected and make it into an integer
      }
    }
document.checkbox.TOTAL.value = total; //total value box equal to the sum
} 
```

我的复选框是这样的：

```
 <input type="checkbox" name="select" value="15" onchange="totalcheckbox()"> 
```

我遇到的问题是其中两个字段是复选框。我想要它，所以当我选择这些复选框时，它会添加到订单总额中。当我取消选中复选框时，它将减去复选框的价格。

例如，我可以有一个这样的复选框：

```
 <input type="checkbox" name="PROD_CH_15.00" value="15" onchange="totalcheckbox()"> 
```

复选框的功能本身可以添加总计，订单总计功能也可以使用。最大的问题是编辑订单总计脚本，以便复选框将更改总价，如果您在文本框中输入数量，它将更新总价。

这是工作复选框代码的 JS Fiddle：http: [//jsfiddle.net/7uzr4/](http://jsfiddle.net/7uzr4/)

这是订单总代码的 JS Fiddle：http: [//jsfiddle.net/X2wMR/](http://jsfiddle.net/X2wMR/)

如何组合这两个代码，以便复选框代码也将添加到订单总数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T03:47:04.313

您必须`item_quantity`根据字段类型进行设置。您的电流`CalculateFunction`应该只需要稍作改动即可工作：

```
// Get the quantity
if(form_field.type == 'checkbox') {
    // Will be 0 for unchecked, 1 for checked
    item_quantity = form_field.checked;
} else {
    item_quantity = parseInt(form_field.value, 10);           
} 
```

然后只需从复选框中调用相同的函数`onchange`：

```
<input type="checkbox" name="PROD_CH_15.00" value="15" onchange="CalculateTotal(this.form)"> 
```

[jsfiddle 上的工作版本](http://jsfiddle.net/X2wMR/1/)

# regex - 这是怎么回事？操作员在正则表达式中工作？

> ID：10201571
> 
> 赞同：4
> 
> 时间：2012-04-18T01:29:10.617
> 
> 标签：regex

`^.*(?=.*[0-9]).*$`

我在某人的代码中看到了这个。这是一个有效的正则表达式吗？我知道`?`应该在它可选之前使项目`abc?`成为`c`可选的。但是`?`在捕获括号的开头。这意味着什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-18T01:31:33.487

`?`单独意味着：可选地匹配以前的内容。

但是，`(? .. )`用于断言...

在您的情况下，`(?=`是一个前瞻断言，意思是：如果只有（括号中的内容）遵循，则匹配。

> ## 参考
> 
> * * *
> 
> **（？：……）**
> 
> 非捕获括号。对包含的模式进行分组，但不提供匹配文本的捕获。比捕获括号更有效。
> 
> **(?> ... )**
> 
> 原子匹配括号。括号内的子表达式的第一个匹配是唯一尝试过的；如果它没有导致整体模式匹配，则将匹配搜索备份到“（？>”之前的位置
> 
> **(?# ... )**
> 
> 自由格式评论 (?# comment )。
> 
> **(?= ... )**
> 
> 前瞻断言。如果括号中的模式在当前输入位置匹配，但不推进输入位置，则为真。
> 
> **（？！……）**
> 
> 负前瞻断言。如果括号中的模式在当前输入位置不匹配，则为真。不推进输入位置。
> 
> **(?<= ... )**
> 
> 后视断言。如果括号中的模式匹配当前输入位置之前的文本，则为真，匹配的最后一个字符是当前位置之前的输入字符。不改变输入位置。由后视模式匹配的可能字符串的长度不能是无限的（没有 * 或 + 运算符。）
> 
> **(?<! ... )**
> 
> 否定的后视断言。如果括号中的模式与当前输入位置之前的文本不匹配，则为真，匹配的最后一个字符是当前位置之前的输入字符。不改变输入位置。由后视模式匹配的可能字符串的长度不能是无限的（没有 * 或 + 运算符。）

# jquery - HTML JQuery 在滚动框项目符号点中显示数组数据

> ID：10201573
> 
> 赞同：0
> 
> 时间：2012-04-18T01:29:43.143
> 
> 标签：jquery, html, scroll

我有一组名称`["John", "Jack", "Jill",...]`，我想在可滚动的 HTML/Jquery 文本框中显示它们。IE

*   约翰
*   杰克
*   吉尔...

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T01:35:40.570

做一个`<ul>`：

```
<ul id="stuff"></ul> 
```

设置样式使其可滚动：

```
#stuff {
    height: 200px;
    overflow: auto;
} 
```

将物品放入：

```
var items = ["John", "Jack", "Jill", "James", "Jacqueline", "Jordan", "Joel", "Jay", "Jim"];

$.each(items, function() {
    $('#stuff').append($('<li>').text(this));
});​ 
```

[这是一个演示。](http://jsfiddle.net/minitech/9auSD/)

# c# - EF 代码优先 - 插入或更新；表不存在时出错

> ID：10201575
> 
> 赞同：0
> 
> 时间：2012-04-18T01:29:47.467
> 
> 标签：c#, .net, orm, ef-code-first, code-first

通过以下方式使用 Entity Framework - Code First 时出现错误。

Global.asax.cs 文件内部（在开发期间）

```
void Application_Start(object sender, EventArgs e)
{
    // Code that runs on application startup
    Database.SetInitializer<Investments>(new DropCreateDatabaseIfModelChanges<Investments>());
} 
```

Investments 类相对简单：

```
public class Investments : DbContext
{
    public Investments() : base("Investments") { }
    public DbSet<Holding> Holdings { get; set; }
} 
```

如果表中存在记录（仅当表存在时），我可以更新记录，如果记录不存在（即使表不存在），我也可以使用以下代码插入记录：

```
Decimal totalPercentage;
List<Holding> mergedHoldings = GetMergedHoldings(fund, out totalPercentage);

try
{
    Investments inv = new Investments();
    foreach (Holding h in mergedHoldings)
    {
        if (inv.Holdings != null && inv.Holdings.Count<Holding>() > 0)
        {
            var record = inv.Holdings.FirstOrDefault(m => m.Name == h.Name);

            if (record != null)
            {
                record.Percentage = h.Percentage;
                record.Symbol = h.Symbol;
                record.Sector = h.Sector;
                inv.Holdings.Attach(record);
                inv.Entry(record).State = System.Data.EntityState.Modified;
            }
        }
        else
            inv.Holdings.Add(h);
    }
    inv.SaveChanges();
}
catch (Exception e)
{
    throw;
} 
```

当表还不存在时，我的问题就来了。我无法检查是否有任何记录匹配，因为该表不存在！有什么简单的方法可以解决这个问题吗？我知道我想在其中保留 if-exists-then-update-else-add 代码，但我必须在初始加载运行期间注释掉对 if-exists-then-update 的检查。这在开发过程中很烦人。

错误是：System.Data.SqlClient.SqlException：无效的对象名称'dbo.Holdings'

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T02:15:27.937

您似乎能做的最好的事情是[运行一些代码来检查表是否存在](https://stackoverflow.com/questions/6100969/entity-framework-how-to-check-if-table-exists)。但是，这里有很多开销。真的，我建议让你的异常处理捕获它并在那时处理它。你多久没有一张桌子。

如果你真的想要这个检查，那么你应该在应用程序启动时检查它，然后相信它在那之后存在。

# sql-server - 仅当另一列也相同时，是否可以使用 ROW_NUMBER() OVER/PARTITION BY？

> ID：10201576
> 
> 赞同：17
> 
> 时间：2012-04-18T01:29:55.883
> 
> 标签：sql-server, sql-server-2005, common-table-expression, row-number

我正在使用这段代码：（来自这个问题：[如何在 SQL 中获取每组的最后一条记录，](https://stackoverflow.com/questions/6201253/how-to-get-the-last-record-per-group-in-sql)替换我自己的列）

```
WITH e AS
(
 SELECT *,
     ROW_NUMBER() OVER
     (
         PARTITION BY ApplicationId
         ORDER BY theDate DESC
     ) AS Recency
 FROM [Event]
)
SELECT *
FROM e
WHERE Recency = 1 
```

只有当两个字段相同时才可以“分区”吗？例如我有这样的数据：

```
ID      Name    theDate
123     John    01/01/2012
123     John    01/02/2012
123     Doe     01/01/2012
456     Smith   02/04/2012
789     Smith   02/01/2012
789     Smith   02/09/2012
789     Roger   02/08/2012 
```

从我想返回的数据中：

```
ID      Name    theDate
123     John    01/02/2012
123     Doe     01/01/2012
456     Smith   02/04/2012
789     Smith   02/09/2012
789     Roger   02/08/2012 
```

谢谢你的帮助。

托马斯

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-04-18T01:45:08.113

您可以有几列用逗号分隔

```
WITH e AS 
( 
 SELECT *, 
     ROW_NUMBER() OVER 
     ( 
         PARTITION BY ApplicationId , Name
         ORDER BY theDate DESC 
     ) AS Recency 
 FROM [Event] 
) 
SELECT * 
FROM e 
WHERE Recency = 1 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-18T02:10:33.463

我在这里找到了答案：[Table partitioning using 2 columns](https://stackoverflow.com/questions/4671161/table-partitioning-using-2-columns)

您只能在 1 列上进行分区，但是可以生成该列以创建“多分区”，如下所示：

```
WITH e AS 
( 
 SELECT *, 
 ROW_NUMBER() OVER 
 ( 
     PARTITION BY CONVERT(VARCHAR(100),ApplicationId) + ' ' + Name
     ORDER BY theDate DESC 
 ) AS Recency 
 FROM [Event] 
) 
SELECT * 
FROM e 
WHERE Recency = 1 
```

将两列加在一起作为一个字符串可确保仅在两列相同时才进行分区。

# css - Div 不会保留高度属性或中心

> ID：10201579
> 
> 赞同：1
> 
> 时间：2012-04-18T01:30:24.997
> 
> 标签：css, html, margin, centering

我现在正在做一个项目，无法让我的内容区域居中。我相信这是由于在我的浏览器中检查时主要的#content div 没有高度。我在#content 中的CSS 中分配了高度，但是这个div 似乎没有保留分配的属性。

这是包含#content div的HTML片段：

```
<div id="content">
    <div id="mainbox">
        <h1>title</h1>
        <h3>title</h3>
        <p>text</p>
        <ul>
            <li>Vivamus vestibulum nulla nec ante.</li>
            <li>Praesent placerat risus quis eros.</li>
        </ul>
    </div>
    <div id="relatedbox">
        <h1>Related</h1>
        <p>text</p>
    </div>
</div> 
```

那么压缩后的 CSS 代码是：

```
#content {
    height: 500px;
    width: 825px;
    margin-left: auto;
    margin-right: auto;
}
#content #relatedbox {
    width: 200px;
    font-size: 10pt;
    background-color: white;
    margin: 1em 0.5em 1em;
    border: 3px solid #00824c;
    float: left;
} 
```

我已经尝试了很多东西，包括“位置：相对”（和绝对），这看起来像是许多其他类似问题的解决方案。但是不能解决我的问题。框呈现右侧，但粘在 div 的左侧。

提前感谢您的任何想法或帮助！

**编辑（解决方案）：**我似乎找到了解决方案，尽管我不确定它是否是最好的。在我的 HTML 中，我实际上只是将样式添加到 div 本身，然后它就将其拾取。我可以清除 #content div 中的所有 CSS 代码，但由于其他一些依赖项，我需要保留 #content id。再次感谢大家的帮助！修复它的代码： `<div id="content" style="height: 500px; width: 850px; position: relative; margin-left: auto; margin-right: auto;">`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T01:33:31.100

尝试添加`overflow: hidden;`到您的#content 样式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T01:34:54.293

我发现有时当我的 div 无法保持其高度时，我可以使用`max-height`and`min-height`来解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T12:42:49.533

将 CSS 从文件直接移动到 div，如：`<div id="content" style="height: 500px; width: 850px; position: relative; margin-left: auto; margin-right: auto;">`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T02:01:33.297

如果您使用的是 IE，请在`<html>`标签前添加以下内容：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-09T23:42:12.620

如果显示是`inline`，我发现它忽略了`width`。我将其更改为`inline-block`并且它似乎有效。

# java - 如何设置已经有背景图像的 JButton 的大小？

> ID：10201580
> 
> 赞同：1
> 
> 时间：2012-04-18T01:30:41.673
> 
> 标签：java, swing, jpanel, jbutton, setbounds

每次我创建一个带有构建图像的 JButton 时，它都会将 JButton 的大小设置为比图像大小稍大的大小。我尝试使用 button.setBounds(x,y,width,height)，然后在此之后重新绘制按钮，但它没有做任何事情。我想将 JButton 设置为图像的确切大小，而不是略大于它，并且我还想将 JButton 向下移动到屏幕底部。这两者都可以通过 setBounds 实现，但它不会对带有图像的预先构建的 JButton 执行任何操作。你有什么建议？感谢您的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T04:58:37.820

> 如何设置已经有背景图像的 JButton 的大小？

不要那样做。相反，只需调用`setBorderPainted(false)`& `setContentAreaFilled(false)`，如[本例](https://stackoverflow.com/a/6743726/418556)所示。

![](../Images/e70015c172a5705298550149241e0629.png)

如果图像本身是“错误尺寸”，我可以想到 3 种替代方案。让我知道是否是这种情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T03:19:54.490

尝试：

```
setMargin(new Insets(0,0,0,0)); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-18T01:55:13.897

设置边界后尝试调用（JButton 的容器）.Invalidate()

# asp.net - 如何更改用户控件中的默认标记前缀

> ID：10201584
> 
> 赞同：2
> 
> 时间：2012-04-18T01:31:20.500
> 
> 标签：asp.net

当您将 Web 用户控件拖到设计图面上时，它会自动分配 tagprefix = uc1。

有谁知道如何更改您拖到 Web 表单上的所有 Web 用户控件的默认标记前缀？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T03:09:15.253

[**将用户控件添加到 Web 窗体页**](http://msdn.microsoft.com/en-us/library/5d0t5fak%28v=vs.71%29.aspx)

你必须`Register`在下面的控件`Page directive`下面。

```
<%@ Register TagPrefix="Guest" TagName="GuestExample" Src="~/YourControl.ascx" %> 
```

然后根据您的要求更改`TagPrefix`and 。`TagName`

例子

```
<Guest:GuestExample ID="ID" runat="server" /> 
```

* * *

![在此处输入图像描述](../Images/6bf5204e7eab145e3c85c5173a74b0a2.png)

* * *

> 无需在所有页面上复制它们，只需在应用程序的 web.config 文件的新 pages->controls 部分中声明它们一次：

```
<?xml version="1.0"?>
<configuration>
  <system.web>
    <pages>
      <controls>
        <add tagPrefix="Guest" src="~/YourControl.ascx" tagName="GuestExample"/>
      </controls>
    </pages>
  </system.web>
</configuration> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-16T17:52:00.917

实际上，这可以使用程序集级属性 TagPrefix 来实现。

```
<Assembly: TagPrefix("MyCompany.Web", "SomeFancyTagPrefix")> 

Public Class MyCustomControl
    Inherits WebControl

        'class implementation

End Class 
```

第一个参数是控件的命名空间，第二个参数是你喜欢的标签前缀。

将自定义控件拖放到页面上时的结果：

```
<%@ Page Language="vb" AutoEventWireup="false" CodeBehind="WebForm1.aspx.vb" Inherits="MyCompany.Web.WebForm1" %>

<%@ Register Assembly="My Company" Namespace="MyCompany.Web" TagPrefix="SomeFancyTagPrefix" %>

<!DOCTYPE html>

<html>
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <SomeFancyTagPrefix:MyCustomControl ID="MyCustomControl1" runat="server">
        </SomeFancyTagPrefix:MyCustomControl>
    </div>
    </form>
</body>
</html> 
```

# java - Linux下查找一个java进程的pid

> ID：10201589
> 
> 赞同：24
> 
> 时间：2012-04-18T01:32:24.893
> 
> 标签：java, linux, pid, ps

我有一个在 Linux 计算机上运行的 Java 程序，并且想查找其进程的进程 ID (pid)。我知道该`ps`命令可以提供此信息，但它的输出令人困惑，因为它包含太多无关信息。我怎样才能得到 pid？

* * *

我在 Java 程序中使用 MPJ 库进行 Pagerank 算法。我编译它

```
javac -cp .:$MPJ_HOME/lib/mpj.jar MpiPageRank.java 
```

并运行

```
mpjrun.sh -np 2 MpiPageRank 
```

`-np`进程数在哪里

现在我必须找到它的 pid

```
ps -ef|grep java 
```

喜欢

```
mpjrun.sh -np 2 MpiPageRank & sleep 2
ps -ef | grep java 
```

我明白了

```
pnewaska 27866 27837 99 21:28 pts/45   00:00:09 java -cp /u/pnewaska/mpj-v0_38/lib/smpdev.jar:/u/pnewaska/mpj-v0_38/lib/xdev.jar:/u/pnewaska/mpj-v0_38/lib/mpjbuf.jar:/u/pnewaska/mpj-v0_38/lib/loader2.jar:/u/pnewaska/mpj-v0_38/lib/starter.jar:/u/pnewaska/mpj-v0_38/lib/mpiExp.jar runtime.starter.MulticoreStarter /nfs/nfs1/home/pnewaska/DistributedSystems/Project3 10 smpdev useLocalLoader EMPTY MpiPageRank -i input.500k0 -n 10 -o 
```

现在我只想`MpiPageRank`从 1 个 linux comman 中提取它的 pid ie `27866`。我怎么做 ？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-04-18T02:02:57.510

### 使用`ps`

`ps``-o`允许用户使用开关为其输出定义自己的格式，并`-C`通过给定命令选择条目。我会去：

```
ps -C java -o pid 
```

从手册页：

```
 -C cmdlist      Select by command name
                   This selects the processes whose executable name is given in cmdlist.

   -o format       user-defined format.
                   format is a single argument in the form of a blank-separated or comma-separated list, which offers a way to specify
                   individual output columns. The recognized keywords are described in the STANDARD FORMAT SPECIFIERS section below. Headers
                   may be renamed (ps -o pid,ruser=RealUser -o comm=Command) as desired. If all column headers are empty
                   (ps -o pid= -o comm=) then the header line will not be output. Column width will increase as needed for wide headers; this
                   may be used to widen up columns such as WCHAN (ps -o pid,wchan=WIDE-WCHAN-COLUMN -o comm). Explicit width control
                   (ps opid,wchan:42,cmd) is offered too. The behavior of ps -o pid=X,comm=Y varies with personality; output may be one
                   column named "X,comm=Y" or two columns named "X" and "Y". Use multiple -o options when in doubt. Use the PS_FORMAT
                   environment variable to specify a default as desired; DefSysV and DefBSD are macros that may be used to choose the default
                   UNIX or BSD columns. 
```

通过指定更多限制（即进程运行的用户等）可以获得更准确的结果。查看手册页以获取更多信息和其他开关。

例子：

```
$ sleep 10 &
[1] 12654
$ ps -C sleep -o pid
12654 
```

* * *

### 使用外壳

我不知道为什么你使用`.sh`脚本来运行你的代码而不是`java`直接调用，但是如果你在任何情况下使用`&`（后台）操作符，你可以`pid`通过你的 shell来获取`$!`变量。

例如：

```
$ sleep 5 &
[1] 12395
$ echo $!
12395 
```

`java -jar .. &`命令也是如此，`$!`将设置为最后一个后台作业的 pid。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-04-18T01:40:55.027

您可以使用 awk 获取 pid：

```
ps -ef | grep MpiPageRank | awk '{print $2}' 
```

我注意到有时会找到 grep 本身，将其删除：

```
ps -ef | grep MpiPageRank | grep -v grep | awk '{print $2}' 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-09-12T15:57:56.037

jps 与 ps 相同，只是它只查看 java 进程。

如果您随后需要 PID，则可以执行以下操作：

```
jps | grep JAVA_NAME | awk '{print $1}' 
```

运行 jps，然后使用 grep 按您要杀死的 java 应用程序或 jar 进行过滤。之后，awk 只捕获 pid 并将其打印到控制台。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2019-04-10T09:17:58.127

一个简单的方法是运行这个：

```
pgrep java 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-30T05:12:24.107

```
ps -ef | grep java | grep MpiPageRank | grep -v grep | awk '{print $2}'

This will return exact pid of the MpiPageRank out of all java processes running   
ps -ef --> Returns all active processes
grep java --> Filter only java processes from all active processes
grep MpiPageRank --> Select only process related to MpiPageRank         
grep -v grep --> Remove the process related to Grep   
awk '{print $2}' --> select 2nd part of selected line 
```

# bluetooth - Arduino 串行中断

> ID：10201590
> 
> 赞同：5
> 
> 时间：2012-04-18T01:32:28.397
> 
> 标签：bluetooth, arduino, microcontroller, serial-communication, interrupt

我正在做一个 Arduino Mega 2560 项目。在 Windows 7 PC 上，我使用的是 Arduino1.0 IDE。我需要建立一个波特率为 115200 的串行蓝牙通信。当数据在 RX 可用时，我需要接收中断。我见过的每段代码都使用“轮询”，即在 Arduino 的循环中放置一个 Serial.available 条件。如何在 Arduino 循环中为中断及其服务程序替换这种方法？似乎 attachInterrupt() 没有提供此目的。我依靠中断将 Arduino 从睡眠模式唤醒。

我开发了这个简单的代码，它应该打开连接到引脚 13 的 LED。

```
 #include <avr/interrupt.h> 
    #include <avr/io.h> 
    void setup()
    {
       pinMode(13, OUTPUT);     //Set pin 13 as output

       UBRR0H = 0;//(BAUD_PRESCALE >> 8); // Load upper 8-bits of the baud rate value into the high byte of the UBRR register 
       UBRR0L = 8; // Load lower 8-bits of the baud rate value into the low byte of the UBRR register 
       UCSR0C |= (1 << UCSZ00) | (1 << UCSZ10); // Use 8-bit character sizes 
       UCSR0B |= (1 << RXEN0) | (1 << TXEN0) | (1 << RXCIE0);   // Turn on the transmission, reception, and Receive interrupt      
    }

    void loop()
    {
      //Do nothing
    }

    ISR(USART0_RXC_vect)
    {    
      digitalWrite(13, HIGH);   // Turn the LED on          
    } 
```

问题是子程序永远不会被服务。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-19T02:54:59.767

最后我发现了我的问题。我将中断向量“USART0_RXC_vect”更改为`USART0_RX_vect`. 我还添加`interrupts();`了启用全局中断，它工作得很好。

代码是：

```
#include <avr/interrupt.h> 
#include <avr/io.h> 
void setup()
{
   pinMode(13, OUTPUT); 

   UBRR0H = 0; // Load upper 8-bits of the baud rate value into the high byte of the UBRR register 
   UBRR0L = 8; // Load lower 8-bits of the baud rate value into the low byte of the UBRR register 
   UCSR0C |= (1 << UCSZ00) | (1 << UCSZ10); // Use 8-bit character sizes 
   UCSR0B |= (1 << RXEN0) | (1 << TXEN0) | (1 << RXCIE0);   // Turn on the transmission, reception, and Receive interrupt      
   interrupts();
}

void loop()
{

}

ISR(USART0_RX_vect)
{  
  digitalWrite(13, HIGH);   // set the LED on
  delay(1000);              // wait for a second
} 
```

感谢您的回复！！！！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T14:25:16.927

您是否尝试过该代码但它不起作用？我认为问题在于您没有打开中断。您可以尝试调用`sei();`或`interrupts();`在您的`setup`函数中。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2019-01-26T18:13:19.200

就在`UBRR0L = 8`这之后：

```
 UCSR0C |= (1 << UCSZ00) | (1 << UCSZ01); 
```

改为：

```
 UCSR0C |= (1 << UCSZ00) | (1 << UCSZ10); 
```

# mysql - 在 Centos 上安装 MySQL Workbench 的问题

> ID：10201594
> 
> 赞同：2
> 
> 时间：2012-04-18T01:33:02.640
> 
> 标签：mysql, installation, centos, mysql-workbench

我正在安装 MySQL Workbench 并收到以下消息：

```
checking for python2.6... yes
checking for python2.7... no
checking for Python libraries... -L/usr/lib64 -lpython2.6
checking for CAIRO... configure: error: Package requirements (cairo >= 1.5.12 gl) were not met:

No package 'gl' found

 Consider adjusting the PKG_CONFIG_PATH environment variable if you
 installed software in a non-standard prefix.

 Alternatively, you may set the environment variables CAIRO_CFLAGS
and CAIRO_LIBS to avoid the need to call pkg-config.
See the pkg-config man page for more details. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T14:10:45.553

`mesa-libGL-devel`为我解决了这个特殊的依赖。我正在使用 Fedora 17，fwiw。

# c# - 显示使用 OAuth2 服务（服务器到服务器）帐户的任何示例

> ID：10201598
> 
> 赞同：1
> 
> 时间：2012-04-18T01:33:20.623
> 
> 标签：c#, oauth-2.0

我见过的所有示例都只支持用户必须在场的“用户”帐户。

看起来最新版本的 OAuth2 支持服务器到服务器身份验证的服务帐户，但我正在努力寻找任何支持它的库或正在使用的示例。

[https://developers.google.com/accounts/docs/OAuth2ServiceAccount](https://developers.google.com/accounts/docs/OAuth2ServiceAccount)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T23:24:04.130

我（还）没有任何通过服务帐户授权的 C# 示例，但 Google API 支持服务帐户授权流程。这是一个使用 Java 和 Python 中的 Google BigQuery API 的授权流程的示例，使用这些语言的 Google API 客户端库 (http://code.google.com/p/google-api-python-client/ 和[http://code.google.com/p/google-api-java-client/](http://code.google.com/p/google-api-java-client/)）。

```
import com.google.api.client.http.HttpTransport;
import com.google.api.client.http.javanet.NetHttpTransport;
import com.google.api.client.json.JsonFactory;
import com.google.api.client.json.jackson.JacksonFactory;

import com.google.api.client.googleapis.auth.oauth2.GoogleCredential;
import com.google.api.services.bigquery.Bigquery;
import com.google.api.services.bigquery.Bigquery.Datasets;
import com.google.api.services.bigquery.model.DatasetList;

import java.io.File;
import java.io.IOException;
import java.security.GeneralSecurityException;

public class BigQueryJavaServiceAccount {

  private static final String SCOPE = "https://www.googleapis.com/auth/bigquery";
  private static final HttpTransport TRANSPORT = new NetHttpTransport();
  private static final JsonFactory JSON_FACTORY = new JacksonFactory();

  public static void main(String[] args) throws IOException, GeneralSecurityException {
    GoogleCredential credential = new GoogleCredential.Builder().setTransport(TRANSPORT)
        .setJsonFactory(JSON_FACTORY)
        .setServiceAccountId("XXXXXXX@developer.gserviceaccount.com")
        .setServiceAccountScopes(SCOPE)
        .setServiceAccountPrivateKeyFromP12File(new File("my_file.p12"))
        .build();

    Bigquery bigquery = Bigquery.builder(TRANSPORT, JSON_FACTORY)
        .setApplicationName("Google-BigQuery-App/1.0")
        .setHttpRequestInitializer(credential).build();

    Datasets.List datasetRequest = bigquery.datasets().list("publicdata");
    DatasetList datasetList = datasetRequest.execute();
    System.out.format("%s\n", datasetList.toPrettyString()); 
} 
```

在 Python 中实现的相同代码段：

```
import httplib2

from apiclient.discovery import build
from oauth2client.client import SignedJwtAssertionCredentials

# REPLACE WITH YOUR Project ID
PROJECT_ID = 'XXXXXXXXXXX'
# REPLACE WITH THE SERVICE ACCOUNT EMAIL FROM GOOGLE DEV CONSOLE
SERVICE_ACCOUNT_EMAIL = 'XXXXX@developer.gserviceaccount.com'

f = file('key.p12', 'rb')
key = f.read()
f.close()

credentials = SignedJwtAssertionCredentials(
    SERVICE_ACCOUNT_EMAIL,
    key,
    scope='https://www.googleapis.com/auth/bigquery')

http = httplib2.Http()
http = credentials.authorize(http)

service = build('bigquery', 'v2')
datasets = service.datasets()
response = datasets.list(projectId=PROJECT_ID).execute(http)

print('Dataset list:\n')
for dataset in response['datasets']:
  print("%s\n" % dataset['id']) 
```

# actionscript-3 - 动态变量名称

> ID：10201600
> 
> 赞同：0
> 
> 时间：2012-04-18T01:33:28.323
> 
> 标签：actionscript-3, variables, dynamic

我需要创建一个变量：

```
var numDots0:Number=0; 
```

但是当单击按钮时，变量`numDots0`变为`numDots1`，然后`numDots2`在第二次单击时，依此类推。然后我需要能够获取该新变量名并在函数中使用它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T02:10:05.217

这是一个非常非常奇怪的要求，但无论如何：

您可以使用 Object 的键名来存储属性，然后更改它：

```
var obj:Object = { numDots0: 0 }; 
```

然后当你想更改名称时：

```
delete obj.numDots0;
obj.numDots1 = 1; 
```

或者为了轻松地增加你可以使用这个：

```
var i:int = 0;
function increase():void
{
    delete obj["numDots" + i];
    obj["numDots" + (++i)] = i;
} 
```

访问：

```
trace(obj.numDotsX); // where X is the most recent variable name. 
```

我认为这绝对没有任何好处或需要，因此我强烈建议您查看您正在尝试做的事情并确保它有意义并且没有不同的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T05:30:32.003

答案是*不要*做你想做的事情，而是使用数组、散列或向量。给我们更多的背景信息，或者你想要达到你想要的目的的原因，以及为什么你可能认为你需要一个这样的动态变量名。你不应该使用 eval 或任何在运行时更改变量名的东西，因为编程之神会让你失望。即，您的程序将要中断，当它发生时，肯定会更难调试。

如果你确定这是你想要做的，那我错了，哈哈。祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T02:11:50.677

我很确定您在尝试解决的问题上走错了路。动态变量名称不是您在最佳实践书中阅读的内容。

无论如何，要在 AS2 中回答您的问题，您可以使用命令 eval 将字符串评估为 ActionScript，因此您可以使用以下内容：

```
function onClicked(e:MouseEvent):void
{
     counter++;
     eval("var numDots" + counter +"+:Number=0;");
} 
```

在 AS3 中，该命令已被删除（**因为它会导致错误的编码实践**- 就像您正在尝试做的事情一样），但是有人在 AS3 中实现了一个评估器：

[http://eval.hurlant.com/](http://eval.hurlant.com/)

使用此评估器将库添加到您的项目中，并将以下内容添加到上面的代码段中：

```
function eval(expression:String):void
{
    var evaluator:com.hurlant.eval.Evaluator = new com.hurlant.eval.Evaluator();
    var bytes:ByteArray = evaluator.eval(expression);
    bytes = ByteLoader.wrapInSWF([bytes]);

    var context:LoaderContext = null
    var loader:Loader = new Loader();

    loader.loadBytes(bytes, context);
} 
```

# joomla - 获取 Joomla 中某个类别的链接

> ID：10201603
> 
> 赞同：0
> 
> 时间：2012-04-18T01:33:51.483
> 
> 标签：joomla, hyperlink, external, categories

即使只是 30 分钟谷歌论坛并没有发现任何东西......我感兴趣 - 实际上我看到一个新链接到一个不是我创建的类别，同时也可以访问数据库（直接查看它）只能访问管理面板。请帮帮我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T20:51:46.350

如果要创建指向确定类别的链接，则必须了解有一个组件负责显示内容，如果看到此[链接](http://docs.joomla.org/Developing_a_Model-View-Controller_Component/1.5/Introduction#Creating_the_Entry_Point)，则可以在 url 中传递参数，因此指向类别的链接将是这样的：

`index.php?option=com_content&view=category&layout=blog&id=4&Itemid=6`

其中 category 是视图的类型。
如果要将文章显示为博客表单，您可以将类别或部分
放入布局参数
中

# java - 如何解决代理示例交通锁和 ssl 握手锁的死锁？

> ID：10201604
> 
> 赞同：1
> 
> 时间：2012-04-18T01:33:56.833
> 
> 标签：java, netty

我结合了大部分网络示例 HexdumpProxy (http://netty.io/docs/stable/xref/org/jboss/netty/example/proxy/) 和 SecureChat (http://netty.io/docs/stable/ xref/org/jboss/netty/example/securechat）形成一个支持 SSL（和非 SSL）的代理（到非 SSL 后端）。这似乎是一个好主意，事实证明很简单，这正是我目前所需要的。

代理示例代码使用交通锁锁作为 2010 年报告的竞争条件 (http://markmail.org/message/x7jc6mqx6ripynqf) 的解决方案，该竞争条件发生在饱和通道周围，并设置传入和传出通道的可写和可读状态。

现在，在我的组合示例中，在较高负载下，这会导致死锁，因为 SSL 代码中的另一个锁“握手锁”是交织在一起的。请参阅下面的分析器诊断输出。

我担心，即使在阅读了原始讨论之后，我也无法理解流量锁的潜在问题足以找到解决此死锁的直接解决方案。

（这是netty 3.2.6）

```
Java-level deadlock has been detected

This means that some threads are blocked waiting to enter a synchronization block or
waiting to reenter a synchronization block after an Object.wait() call, where each thread
owns one monitor while trying to obtain another monitor already held by another thread.

Deadlock:

New I/O client worker #1-2 is waiting to lock java.lang.Object@7900f3c9 which is held by New I/O server worker #1-2
New I/O server worker #1-2 is waiting to lock java.lang.Object@2d854f2f which is held by New I/O client worker #1-2

Thread stacks

New I/O client worker #1-2 [BLOCKED; waiting to lock java.lang.Object@7900f3c9]
org.jboss.netty.handler.ssl.SslHandler.wrap(SslHandler.java:665) <== sync handshakelock
org.jboss.netty.handler.ssl.SslHandler.handleDownstream(SslHandler.java:461)
org.jboss.netty.channel.DefaultChannelPipeline.sendDownstream(DefaultChannelPipeline.java:591)
org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendDownstream(DefaultChannelPipeline.java:776)
org.jboss.netty.channel.Channels.write(Channels.java:632)
org.jboss.netty.handler.codec.oneone.OneToOneEncoder.handleDownstream(OneToOneEncoder.java:70)
org.jboss.netty.channel.DefaultChannelPipeline.sendDownstream(DefaultChannelPipeline.java:591)
org.jboss.netty.channel.DefaultChannelPipeline.sendDownstream(DefaultChannelPipeline.java:582)
org.jboss.netty.channel.Channels.write(Channels.java:611)
org.jboss.netty.channel.Channels.write(Channels.java:578)
org.jboss.netty.channel.AbstractChannel.write(AbstractChannel.java:251)
com.activevideo.frontend.ProxyInboundHandler$OutboundHandler.messageReceived(ProxyInboundHandler.java:162) <== sync trafficlock
org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:80)
org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)
org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:783)
org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:302)
org.jboss.netty.handler.codec.frame.FrameDecoder.unfoldAndFireMessageReceived(FrameDecoder.java:317)
org.jboss.netty.handler.codec.frame.FrameDecoder.callDecode(FrameDecoder.java:299)
org.jboss.netty.handler.codec.frame.FrameDecoder.messageReceived(FrameDecoder.java:216)
org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:80)
org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)
org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:559)
org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:274)
org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:261)
org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:351)
org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:282)
org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:202)
org.jboss.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108)
org.jboss.netty.util.internal.DeadLockProofWorker$1.run(DeadLockProofWorker.java:44)
java.util.concurrent.ThreadPoolExecutor$Worker.runTask(unknown source)
java.util.concurrent.ThreadPoolExecutor$Worker.run(unknown source)
java.lang.Thread.run(unknown source)

New I/O server worker #1-2 [BLOCKED; waiting to lock java.lang.Object@2d854f2f]
com.activevideo.frontend.ProxyInboundHandler.channelInterestChanged(ProxyInboundHandler.java:138) <== sync trafficlock
org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:116)
org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)
org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:783)
org.jboss.netty.channel.SimpleChannelUpstreamHandler.channelInterestChanged(SimpleChannelUpstreamHandler.java:192)
org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:116)
org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)
org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:783)
org.jboss.netty.channel.SimpleChannelUpstreamHandler.channelInterestChanged(SimpleChannelUpstreamHandler.java:192)
org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:116)
org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)
org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:783)
org.jboss.netty.channel.SimpleChannelUpstreamHandler.channelInterestChanged(SimpleChannelUpstreamHandler.java:192)
org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:116)
org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)
org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:559)
org.jboss.netty.channel.Channels.fireChannelInterestChanged(Channels.java:335)
org.jboss.netty.channel.socket.nio.NioWorker.setInterestOps(NioWorker.java:728)
org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleAcceptedSocket(NioServerSocketPipelineSink.java:129)
org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:76)
org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendDownstream(DefaultChannelPipeline.java:771)
org.jboss.netty.handler.ssl.SslHandler.handleDownstream(SslHandler.java:430)
org.jboss.netty.channel.DefaultChannelPipeline.sendDownstream(DefaultChannelPipeline.java:591)
org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendDownstream(DefaultChannelPipeline.java:776)
org.jboss.netty.handler.codec.oneone.OneToOneEncoder.handleDownstream(OneToOneEncoder.java:60)
org.jboss.netty.channel.DefaultChannelPipeline.sendDownstream(DefaultChannelPipeline.java:591)
org.jboss.netty.channel.DefaultChannelPipeline.sendDownstream(DefaultChannelPipeline.java:582)
org.jboss.netty.channel.Channels.setInterestOps(Channels.java:652)
org.jboss.netty.channel.AbstractChannel.setInterestOps(AbstractChannel.java:222)
org.jboss.netty.channel.AbstractChannel.setReadable(AbstractChannel.java:244)
com.activevideo.frontend.SSLProxyInboundHandler$BackendConnector$1.operationComplete(SSLProxyInboundHandler.java:92)
org.jboss.netty.channel.DefaultChannelFuture.notifyListener(DefaultChannelFuture.java:381)
org.jboss.netty.channel.DefaultChannelFuture.addListener(DefaultChannelFuture.java:148)
com.activevideo.frontend.SSLProxyInboundHandler$BackendConnector.operationComplete(SSLProxyInboundHandler.java:87)
org.jboss.netty.channel.DefaultChannelFuture.notifyListener(DefaultChannelFuture.java:381)
org.jboss.netty.channel.DefaultChannelFuture.notifyListeners(DefaultChannelFuture.java:367)
org.jboss.netty.channel.DefaultChannelFuture.setSuccess(DefaultChannelFuture.java:316)
org.jboss.netty.handler.ssl.SslHandler.setHandshakeSuccess(SslHandler.java:1040)
org.jboss.netty.handler.ssl.SslHandler.wrapNonAppData(SslHandler.java:838)
org.jboss.netty.handler.ssl.SslHandler.unwrap(SslHandler.java:907)    <=== sync handshakelock
org.jboss.netty.handler.ssl.SslHandler.decode(SslHandler.java:620)
org.jboss.netty.handler.codec.frame.FrameDecoder.callDecode(FrameDecoder.java:282)
org.jboss.netty.handler.codec.frame.FrameDecoder.messageReceived(FrameDecoder.java:214)
org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:80)
org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)
org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:559)
org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:274)
org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:261)
org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:351)
org.jboss.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:282)
org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:202)
org.jboss.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108)
org.jboss.netty.util.internal.DeadLockProofWorker$1.run(DeadLockProofWorker.java:44)
java.util.concurrent.ThreadPoolExecutor$Worker.runTask(unknown source)
java.util.concurrent.ThreadPoolExecutor$Worker.run(unknown source)
java.lang.Thread.run(unknown source) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T18:41:35.477

好吧，我想我修好了。

代理示例中早期竞争条件的解决方案不必要地包括在同步块中调用 write()。

最初的问题是传出线程（TO）和传入线程（TI）之间存在这种（罕见的）竞争条件：

1.  TO：inboundChannel.write()（在 messageReceived 处）
2.  TO：inboundChannel.isWritable() 返回 false（在 messageReceived 处）
3.  然后刷新在 (1) 发出的未决写入
4.  TI：inboundChannel.isWritable() 返回 true（在 channelInterestChanged）
5.  TI：outboundChannel.setReadable(true)（在 channelInterestChanged）
6.  TO：outboundChannel.setReadable(false)（在 messageReceived 处）

2010 年的解决方案是在 inboundChannel 和 outboundChannel（以及 InterestChanged 处理程序）的 messageReceived() 处理程序中设置可读标志时引入同步（使用“trafficlock”），如下所示：

```
synchronized (trafficLock) {
  outboundChannel.write(msg);
  // If outboundChannel is saturated, do not read until notified in
  // OutboundHandler.channelInterestChanged().
  if (!outboundChannel.isWritable()) {
    e.getChannel().setReadable(false);
  }
} 
```

这确实解决了竞态条件，因为您可以防止步骤 3、4 和 5 干扰步骤 2 和 6。但是，将步骤 1（write()）留在同步块之外是安全的。

对 write() 的调用导致了死锁，因为在 SSLHandler 中调用的过程中，它使用了另一个锁握手锁。

所以.. 我将调用 write() 移到两个位置的同步块之外。现在僵局已经过去了。我建议相应地更改“官方”代理示例。

# javascript - 如何向这个 jquery 脚本添加平滑滚动（到页面顶部）？

> ID：10201605
> 
> 赞同：1
> 
> 时间：2012-04-18T01:33:59.813
> 
> 标签：javascript, jquery, validation, smooth-scrolling

谁能告诉我如何向这个 jquery 脚本添加平滑滚动（到页面顶部）？

非常感谢。

```
<script type="text/javascript">
$(function () {
    $('#rbSubmit').formValidator({
        scope: '#form_register',
        onError: function () {
            if ($('#input_2     input').hasClass('error-input')) {
                $('#r2 div, #r2 input').css('background-color', '#C1272D').css('color', '#FFF');
                $("#error-div").show();
            } else {
                $('#r2 div').css('background-color', '#2F2F2F');
                $("#error-div").hide();
            }
        }
    });
});
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T03:26:48.893

嗨，埃里克，你为什么不试试**jquery easing**

[jquery 缓动示例](http://jqueryui.com/demos/effect/easing.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T01:54:29.107

尝试：

```
$('html, body').animate({ scrollTop: 0 }, 'slow'); 
```

# python - Python Crawler - 检查是否存在 javascript 行，如果存在，则解析它

> ID：10201607
> 
> 赞同：1
> 
> 时间：2012-04-18T01:34:10.647
> 
> 标签：python

我正在使用 lxml.html 在 python 2.7 中抓取一个页面，我需要执行以下操作...

1）找出这条线是否在页面上。我实际上是想看看 parent_asin 是否存在。它不是在每一页上。

```
DetailPage.StateController.setState('parent_asin', 'B0000DB87U'); 
```

2) 如果确实存在，我如何获得 B0000DB87U？当 parent_asin 在页面中时，每个页面都会改变。这一切都在 javascript 中，我正在使用 lxml 来获取和解析 html。JS需要另一种方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T04:16:13.013

您可以使用 lxml 提取`<script>`标签的所有内容，然后使用正则表达式对其进行解析。

未经测试的例子：

```
doc = lxml.html.parse(url)
scripts = doc.xpath('//script')
for script in scripts:
    match = re.findall(r"DetailPage\.StateController\.setState\('parent_asin', '(.*)'\);", script.text)
    if match:
        print match[0] 
```

# c++ - 如果我在未使用的 pthread_t 上调用 pthread_join() 会发生什么？

> ID：10201609
> 
> 赞同：3
> 
> 时间：2012-04-18T01:34:23.743
> 
> 标签：c++, c, pthreads

假设我有一个声明的 pthread_t 结构，如下所示：

```
pthread_t newThread; 
```

然后我打电话：

```
pthread_join(&newThread, NULL, myMethod, NULL); 
```

pthread_join() 会做什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T01:42:33.273

根据 ISO C，该`newThread`变量是一个“不确定值的对象”，使用它会触发未定义的行为。它可能具有触发 CPU 异常的“陷阱表示”。

或者它可能只是被解释为该类型的随机值，API 可以通过以下两种方式之一处理：要么没有这样的线程，并且`ESRCH`被返回，要么侥幸有这样的线程。然后会出现各种情况：是否可以加入等等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T01:40:13.397

如果将 pthread_join 称为未初始化的 pthread_t，则行为未定义。

# java - 通过 Java 使用 UDP 多播小图像。

> ID：10201612
> 
> 赞同：0
> 
> 时间：2012-04-18T01:34:57.567
> 
> 标签：java

我们的老师让我们修改 MulticastImageSender (MIS) 和 MulticastImageReceiver (MIR) 类中的两个程序。唯一的问题是，我似乎无法弄清楚如何让它们像他给我们时那样正常工作。我一直被告知我的地址不是多播地址。

MIS 的参数：java -jar MIS.jar 127.0.0.0 1234 4 "/home/kevin/Pictures/ME.png" MIR 的参数：java -jar MIR.jar 127.0.0.0 1234

然后我先运行接收器，但我不断得到这些输出

MIS 的输出：

```
Sent /home/kevin/Pictures/ME.png to 127.0.0.0 on port 1234 
```

MIR 的输出：

```
Exception in thread "main" java.lang.IllegalArgumentException: Not a multicast address
at MulticastImageReceiver.main(MulticastImageReceiver.java:35) 
```

现在我知道多播地址是 244.xxx 并保留了一些地址，但我想我需要使用本地机器地址将其发送给自己。或者通过使用 244.xxx 地址创建我的多播套接字，我的路由器（计算机网络接口卡？）知道我的地址是 127.0.0.0，并且发送者使用相同的路由器（NIC？）创建多播套接字知道发送它又给我了？

使用 Ubuntu Oneric、Eclipse IDE、Java

资源：

```
MIS

public class MulticastImageSender 
{
private static final int TIMEOUT = 3000; // Time between sends (milliseconds)
private static final int MAXFILELEN = 65000; // File must fit in single datagram

public static void main(String[] args) throws IOException, InterruptedException 
{
    if (args.length < 4) // Test for correct # of args
        throw new IllegalArgumentException("Parameter(s): <Multicast Address> <Port> <TTL> <Image File> [<Image File>...]");

    InetAddress multicastAddress = InetAddress.getByName(args[0]);
    int destPort = Integer.parseInt(args[1]);
    // Destination port of multicast packets
    int TTL = Integer.parseInt(args[2]);
    // Create a UDP multicast socket with any available local port
    MulticastSocket socket = new MulticastSocket();
    socket.setTimeToLive(TTL);
    // Set the TTL
    for (int i=3; i < args.length; i++)
    {
        RandomAccessFile file = new RandomAccessFile(args[i], "r");
        if (file.length() > MAXFILELEN)
            throw new IOException("File too big");
        byte [] fileBuffer = new byte[(int) file.length()];
        file.read(fileBuffer);
        file.close();
        // Create a datagram to send
        DatagramPacket sendPacket = new DatagramPacket(fileBuffer, fileBuffer.length, multicastAddress, destPort);
        socket.send(sendPacket); // Send the echo string
        System.out.println("Sent " + args[i] + " to " + sendPacket.getAddress().getHostAddress() + " on port " + sendPacket.getPort());
        Thread.sleep(TIMEOUT);
    }
    socket.close();
}
} 
```

MIR 及其支持线程

```
import java.awt.event.*;
import javax.swing.*;
import java.net.*;
import java.io.*;

public class MulticastImageReceiver extends JFrame 
{

private static final long serialVersionUID = 1L;
private JLabel picture;
// Label to contain image
public MulticastImageReceiver() 
{
    super("Multicast Image Receiver"); // Set the window title
    setSize(300, 300);
    // Set the window size
    picture = new JLabel("No image", SwingConstants.CENTER);
    JScrollPane scrollPane = new JScrollPane(picture);
    getContentPane().add(scrollPane, "Center");
    addWindowListener(new WindowAdapter() { public void windowClosing(WindowEvent evt){ System.exit(0);}});
}

public JLabel getPicture() 
{
    return picture;
}

public static void main(String[] args) throws IOException 
{
    if (args.length != 2) // Test for correct # of args
        throw new IllegalArgumentException( "Parameter(s): <Multicast Address> <Port>");

    final InetAddress multicastAddress = InetAddress.getByName(args[0]);
    if (!multicastAddress.isMulticastAddress())
        throw new IllegalArgumentException("Not a multicast address");

    int port = Integer.parseInt(args[1]);
    // Destination port of multicast packets
    MulticastImageReceiver multicastImageReceiver = new MulticastImageReceiver();
    multicastImageReceiver.setVisible(true);
    new Thread(new MulticastImageReceiverThread(multicastImageReceiver, multicastAddress, port,"No Image")).start();
}
} 
```

米尔螺纹

```
import java.awt.*;
import javax.swing.*;
import java.net.*;
import java.io.*;

class MulticastImageReceiverThread implements Runnable 
{
private static final int MAXFILELEN = 65000;
// File must fit in single datagram
private InetAddress multicastAddress;
// Sender multicast address
private int port;
// Sender port
Runnable updateImage;
// Anonymous class for Swing event queue to update label
String imageText;
// Label text
byte[] image = new byte[MAXFILELEN];
// Bytes of image
boolean imageValid = false;
// True if image contains valid bytes

public MulticastImageReceiverThread(final MulticastImageReceiver frame, InetAddress multicastAddress, int port, String initialImageText) 
{
    this.multicastAddress = multicastAddress;
    this.port = port;
    this.imageText = initialImageText;
    updateImage = new Runnable() 
    {
        public void run() 
        {
            JLabel picture = frame.getPicture();
            picture.setText(imageText);
            if (imageValid) 
            {
                ImageIcon newImage = new ImageIcon(image);
                picture.setIcon(newImage);
                picture.setPreferredSize(new Dimension(newImage.getIconWidth(), newImage.getIconHeight()));
            } 
            else
                picture.setIcon(null);

            picture.revalidate();
        }
    };
}

public void changeImage() 
{
    try 
    {
        SwingUtilities.invokeAndWait(updateImage);
        // Put update in queue and wait until handled
    } 
    catch (Exception e) 
    { 
        System.out.println(e.getMessage());}
}

public void run() 
{
    // Create a datagram to receive
    DatagramPacket recvPacket = new DatagramPacket(image, MAXFILELEN);
    MulticastSocket socket;
    // Create a UDP multicast socket with the specified local port
    try 
    {
        socket = new MulticastSocket(port);
        socket.joinGroup(multicastAddress); // Join the multicast group
    } 
    catch (IOException e) 
    {
        imageText = "Problem with multicast socket";
        imageValid = false; changeImage(); return;
    }
    for (;;) 
    {
        try 
        {
            socket.receive(recvPacket); // Receive the image
        } 
        catch (IOException e) 
        { break; }
        // Assume exception due to file closing
        imageText = "";
        imageValid = true;
        changeImage();
        recvPacket.setLength(MAXFILELEN);
        // You have to reset this!!!
    }
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T01:55:22.073

显然，异常消息来自这一行：

```
if (!multicastAddress.isMulticastAddress())
    throw new IllegalArgumentException("Not a multicast address"); 
```

那是因为你给的地址（127.0.0.1）不是多播地址，你可以点击这个链接[多播地址](http://en.wikipedia.org/wiki/Multicast_address "多播地址")找出什么是正确的多播地址。

# visual-c++ - 尝试使用二进制外部库时出现链接器错误

> ID：10201615
> 
> 赞同：0
> 
> 时间：2012-04-18T01:35:18.747
> 
> 标签：visual-c++

我是 C++ 新手，最近参加了一门课程向我介绍该语言，因此我了解了语法的基础知识，但没有讨论如何使用外部库并将它们连接到我们的代码。

我正在尝试使用 CLP COIN 库从...解决线性程序 [http://www.coin-or.org/Clp/userguide/clpuserguide.html#id4766717](http://www.coin-or.org/Clp/userguide/clpuserguide.html#id4766717)

从我在那里读到的内容，它建议使用预编译的二进制库而不是下载源代码，因为我在 Windows 7 平台上，因为他们建议在 Windows 上重新编译有时会引入问题。

我只是想让相当于 Hello World 的工作。这是他们提供的用于测试的示例代码......

```
* Copyright (C) 2004, International Business Machines Corporation 
   and others.  All Rights Reserved.

   This sample program is designed to illustrate programming 
   techniques using CoinLP, has not been thoroughly tested
   and comes without any warranty whatsoever.

   You may copy, modify and distribute this sample program without 
   any restrictions whatsoever and without any payment to anyone.
*/

/* This shows how to provide a simple picture of a matrix.
   The default matrix will print Hello World
*/

#include "ClpSimplex.hpp"

int main (int argc, const char *argv[])
{
  ClpSimplex  model;
  int status;
  // Keep names
  if (argc<2) {
    status=model.readMps("hello.mps",true);
  } else {
    status=model.readMps(argv[1],true);
  }
  if (status)
    exit(10);

  int numberColumns = model.numberColumns();
  int numberRows = model.numberRows();

  if (numberColumns>80||numberRows>80) {
    printf("model too large\n");
    exit(11);
  }
  printf("This prints x wherever a non-zero elemnt exists in matrix\n\n\n");

  char x[81];

  int iRow;
  // get row copy
  CoinPackedMatrix rowCopy = *model.matrix();
  rowCopy.reverseOrdering();
  const int * column = rowCopy.getIndices();
  const int * rowLength = rowCopy.getVectorLengths();
  const CoinBigIndex * rowStart = rowCopy.getVectorStarts();

  x[numberColumns]='\0';
  for (iRow=0;iRow<numberRows;iRow++) {
    memset(x,' ',numberColumns);
    for (int k=rowStart[iRow];k<rowStart[iRow]+rowLength[iRow];k++) {
      int iColumn = column[k];
      x[iColumn]='x';
    }
    printf("%s\n",x);
  }
  printf("\n\n");
  return 0;
} 
```

我已将 Include 和 Lib 目录与我在 Visual Studio 中的项目相关联，但是当我尝试构建时，会出现许多链接器错误，例如：

```
Simplex(void)" (??1ClpSimplex@@QAE@XZ) referenced in function _main
1>hello.obj : error LNK2019: unresolved external symbol "public: virtual __thiscall CoinPackedMatrix::~CoinPackedMatrix(void)" (??1CoinPackedMatrix@@UAE@XZ) referenced in function _main
1>hello.obj : error LNK2019: unresolved external symbol "public: void __thiscall CoinPackedMatrix::reverseOrdering(void)" (?reverseOrdering@CoinPackedMatrix@@QAEXXZ) referenced in function _main
1>hello.obj : error LNK2019: unresolved external symbol "public: __thiscall CoinPackedMatrix::CoinPackedMatrix(class CoinPackedMatrix const &)" (??0CoinPackedMatrix@@QAE@ABV0@@Z) referenced in function _main
1>hello.obj : error LNK2019: unresolved external symbol "public: int __thiscall ClpSimplex::readMps(char const *,bool,bool)" (?readMps@ClpSimplex@@QAEHPBD_N1@Z) referenced in function _main
1>hello.obj : error LNK2019: unresolved external symbol "public: __thiscall ClpSimplex::ClpSimplex(bool)" (??0ClpSimplex@@QAE@_N@Z) referenced in function _main 
```

作为一个新手，我对如何解决这个问题一无所知，因为我的课程只涉及与代码语法相关的调试，而不是链接器问题。

任何提示或指向其他线程的链接都会有很大帮助。我一直在谷歌上搜索一整天，但不知所措......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T01:42:59.647

我不确定您究竟做了什么将 Lib 目录与项目相关联，但您需要确保这些都已完成（第一个经常被忽略）：

*   您需要将库文件名添加到项目的“链接器/输入/附加依赖项”属性中。

*   您可能还需要将库的位置放置在项目的“链接器/常规/附加库目录”属性中 - 取决于您是否提供了正确的路径或仅提供上述属性的文件名。这可能是你已经做过的。

* * *

更新：

在您发布的 dumpbin 输出中，您将看到以下条目：

```
4C3 0000AE4A SECT98 notype () External | ?readMps@ClpSimplex@@QEAAHPEBD_N 1@Z (public: int __cdecl ClpSimplex::readMps(char const *,bool,bool)) 
```

在错误消息中，您将看到：

```
1>hello.obj : error LNK2019: unresolved external symbol "public: int __thiscall ClpSimplex::readMps(char const *,bool,bool)" (?readMps@ClpSimplex@@QAEHPBD_N1@Z) referenced in function _main 
```

比较两条消息中的 de-mangled 名称：

```
public: int __cdecl ClpSimplex::readMps(char const *,bool,bool)     // what's in the .lib
public: int __thiscall ClpSimplex::readMps(char const *,bool,bool)  // what hello.obj is asking for 
```

您会看到这两种调用约定是不同的。在 coin-or.org 网站上查看，该库似乎是使用 VC 2005 构建的。对于 Microsoft 编译器，这些库不能始终与不同的编译器版本一起使用。如果你想使用这个预构建的库，我建议你使用 VC 2005（你应该仍然可以在这里获得免费的 Express 版本：http: [//go.microsoft.com/fwlink/](http://go.microsoft.com/fwlink/?linkid=57034) ?linkid=57034 ）。

FWIW，我尝试使用几个 MS 编译器编译示例并得到以下结果（仅构建 - 程序抱怨我尝试运行它时缺少某些文件：

*   工作：VC 2005 和 VC 2008
*   失败：VC 6 和 VC2010

# facebook - Facebook 上的 ?ref=rua 是什么？

> ID：10201616
> 
> 赞同：3
> 
> 时间：2012-04-18T01:35:21.403
> 
> 标签：facebook

每隔一段时间，我就会在我的统计数据中看到一个条目，说用户使用 ?ref=rua 作为查询字符串从 Facebook 访问了我们的网站——我查看了所有明显的位置以及他们的文档：

[http://fbdevwiki.com/wiki/Ref](http://fbdevwiki.com/wiki/Ref)

似乎没有任何东西显示 ?ref=rua 指的是什么。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T01:48:49.050

它是出现在用户时间轴上的“最近使用的应用程序”单元（附示例） ![单位样本](../Images/e34bebcf1e031d25c68cc49552b8feb3.png)

顺便说一句，这不是您链接到的官方文档，它是第三方网站

# php - 使用其中一个值对多维数组进行排序，同时尊重其顺序 php

> ID：10201617
> 
> 赞同：1
> 
> 时间：2012-04-18T01:35:29.283
> 
> 标签：php

我有这个数组，它已经按“名称”ASC 排序。

```
array 
  0 => 
    array
      'id' => '4'
      'name' => 'iPad'
      'games' => 5
  1 => 
    array
      'id' => '5'
      'name' => 'iPhone'
      'games' => 5
  2 => 
    array
      'id' => '6'
      'name' => 'Nintendo DS'
      'games' => 5
  3 => 
    array
      'id' => '1'
      'name' => 'Playstation 2'
      'games' => 2
  4 => 
    array
      'id' => '7'
      'name' => 'Playstation 3'
      'games' => 2
  5 => 
    array
      'id' => '7'
      'name' => 'Xbox 360'
      'games' => 1 
```

如果“游戏”的值相同，我想按“游戏”的值排序，同时尊重排序的“名称”的顺序。

结果应如下所示：

```
array
  0 => 
    array
      'id' => '7'
      'name' => 'Xbox 360'
      'games' => 1
  1 => 
    array
      'id' => '1'
      'name' => 'Playstation 2'
      'games' => 2
  2 => 
    array
      'id' => '7'
      'name' => 'Playstation 3'
      'games' => 2
  3 => 
    array
      'id' => '4'
      'name' => 'iPad'
      'games' => 5
  4 => 
    array
      'id' => '5'
      'name' => 'iPhone'
      'games' => 5
  5 => 
    array
      'id' => '6'
      'name' => 'iPod Touch'
      'games' => 5 
```

我几乎尝试了所有排序函数和用户定义的比较函数，但找不到合适的。

如果可能的话，如果我想要“游戏” DESC，而如果游戏的值相同，我该如何处理它，同时保持排序的“名称”ASC？例子：

```
array
  0 => 
    array
      'id' => '6'
      'name' => 'Nintendo DS'
      'games' => 5
  1 => 
    array
      'id' => '5'
      'name' => 'iPhone'
      'games' => 5
  2 => 
    array
      'id' => '4'
      'name' => 'iPad'
      'games' => 5
  3 => 
    array
      'id' => '1'
      'name' => 'Playstation 2'
      'games' => 2
  4 => 
    array
      'id' => '7'
      'name' => 'Playstation 3'
      'games' => 2
  5 => 
    array
      'id' => '7'
      'name' => 'Xbox 360'
      'games' => 1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T01:41:11.617

```
usort($array, function ($a, $b) {
    if ($a['games'] == $b['games']) {
        return strcmp($a['name'], $b['name']);
    } else {
        return $a['games'] - $b['games'];
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T01:45:58.017

还有其他使用自定义比较函数的方法，但最简单的方法是使用[`array_multisort`](http://php.net/manual/en/function.array-multisort.php).

首先使用要对数组进行排序的键创建数组。然后将这些带有排序参数的数组提供给`array_multisort`.

```
// first collect the sorting keys
// ensure that $thearray[$n]['key'] corresponds to $sortkey[$n]
$games = array();
$name = array();
foreach ($thearray as $item) {
    $games = $item['games'];
    $name = $item['name'];
}

// now sort
array_multisort($games, SORT_NUMERIC, SORT_ASC,
                $name, SORT_STRING, SORT_ASC,
                $thearray);
// $thearray is now sorted first by games, then by name. 
```

# javascript - 如果 then 语句在 jquery 中不起作用

> ID：10201620
> 
> 赞同：1
> 
> 时间：2012-04-18T01:35:55.973
> 
> 标签：javascript, jquery, css

我正在尝试创建一个 if then 语句来为幻灯片创建一个循环，幻灯片在没有 if then 语句但不会循环的情况下工作。有了声明，它就是行不通的。这是代码

```
var $num = null;
$num = parseInt(0, 10);
$("document").ready(function onReady() {
    If($num = 6) {
        $num = parseInt(0, 10);
        $num = parseInt($num, 10) + 1;
        var final = "#img" + $num;
        $(final).fadeTo(3000, 1, function() {
            $(final).fadeTo(3000, 0, onReady);
        });
    }
    Else {
        $num = parseInt($num, 10) + 1;
        var final = "#img" + $num;
        $(final).fadeTo(3000, 1, function() {
            $(final).fadeTo(3000, 0, onReady);
        });
    }

});​ 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T01:38:43.883

JavaScript 区分大小写。 `if/else`，不是`If/Else`。比较是用`==`. 当您打算检查时，您错误地分配`6`给。`$num``if ($num = 6)``($num == 6)`

```
// No need for this:
// $num = parseInt(0,10);
// Just initialize to zero
var $num = 0;
// However, since you initialized it, it will _never_ be 6 on page load as you test for...
// So maybe you don't actually want this...    

// Fix the $(document).ready()  
$(document).ready(function() {

   // Never going to be 6 since you initialized to zero...
   if ($num == 6 ){
        $num = parseInt(0,10);
        $num = parseInt($num,10) + 1;
            var final = "#img" + $num;
            $(final).fadeTo(3000,1, function() {$(final).fadeTo(3000,0, onReady);});
    }
    else{
        $num = parseInt($num,10) + 1;
        var final = "#img" + $num;
        $(final).fadeTo(3000,1, function() {$(final).fadeTo(3000,0, onReady);});
    }
}); 
```

习惯使用 Web 浏览器的错误控制台。Firefox 11 内置了一个，或者 Firebug 是一个出色的扩展。Chrome/Safari 有开发者工具，IE 按 F12 进入控制台。错误将在控制台上报告。

### 更新：

在第二次阅读时，也许您实际上是在尝试将其定义`onReady`为函数并将其传递给`$(document).ready()`. 在这种情况下，这是合适的方法。

```
// If this is the correct intent, then it _does_ make sense to initialize $num 
// since it will be modified when onReady is called
var $num = 0;

// Define the onReady function
function onReady() {
   // Never going to be 6 since you initialized to zero...
   if ($num == 6 ){
        $num = parseInt(0,10);
        $num = parseInt($num,10) + 1;
            var final = "#img" + $num;
            $(final).fadeTo(3000,1, function() {$(final).fadeTo(3000,0, onReady);});
    }
    else{
        $num = parseInt($num,10) + 1;
        var final = "#img" + $num;
        $(final).fadeTo(3000,1, function() {$(final).fadeTo(3000,0, onReady);});
    }
}
// Pass the defined function to ready()
$(document).ready(onReady); 
```

# c# - 如何防止 3rd 方库中的吞噬异常触发 VS 调试器？

> ID：10201622
> 
> 赞同：1
> 
> 时间：2012-04-18T01:36:06.637
> 
> 标签：c#, visual-studio-debugging

```
 using System;
 using System.Diagnostics;
 using NUnit.Framework;

 namespace TestExperiment
 {
     [TestFixture]
     internal class TestAAA
     {
         [Test]
         public void Test_ThrowSwallowThirdParty()
         {
             ThrowSwallowThirdParty();
         }

         [Test]
         public void Test_ThrowSwallowLocal()
         {
             ThrowSwallowLocal();
         }

         [DebuggerStepThrough]
         [DebuggerNonUserCode]
         [DebuggerHidden]
         public void ThrowSwallowThirdParty()
         {
             ThirdPartyLibrary.ThrowEmbedded();
         }

         [DebuggerStepThrough]
         [DebuggerNonUserCode]
         [DebuggerHidden]
         public void ThrowSwallowLocal()
         {
             try
             {
                 throw new Exception();
             }
             catch (Exception e)
             {
             }
         }
     }

     // imagine this is a 3rd party library provided in a dll which I am referencing
     internal static class ThirdPartyLibrary
     {
         public static void ThrowEmbedded()
         {
             try
             {
                 throw new Exception();
             }
             catch (Exception e)
             {
             }
         }
     }
 } 
```

根据[here](https://stackoverflow.com/questions/1420390/dont-stop-debugger-at-that-exception-when-its-thrown-and-caught)和[here，](https://stackoverflow.com/questions/4499473/how-to-tell-the-debugger-to-ignore-breaking-on-thrown-exceptions)我了解您可以使用该`[DebuggerHidden]`属性来防止调试器在被吞下的异常处停止，即使它被告知要中断所有抛出的异常。这适用于`Test_ThrowSwallowLocal()`. 但是，我想在第 3 方库中调用代码时复制它，该库抛出并吞下自己的异常——我试图在其中进行模拟`Test_ThrowSwalloThirdParty()`——此时调试器继续在抛出异常时中断。

有没有办法在不编辑 ThirdPartyLibrary 代码的情况下避免这种情况（我不能轻易做到？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T01:53:05.960

我会研究[VS 中的 Just My Code 选项](http://blogs.msdn.com/b/zainnab/archive/2010/10/25/understanding-just-my-code.aspx)

# php - 面向 Web 的语言：类似 C 的语法、强类型和静态类型。任何人？

> ID：10201628
> 
> 赞同：2
> 
> 时间：2012-04-18T01:37:06.553
> 
> 标签：php, c

我已经使用 PHP 5+ 有一段时间了。

我正在寻找一种替代方案，因为我想学习一些新东西，而且我觉得 PHP*有点乱*，尽管我确实喜欢它的易于部署/使用。

这种替代方案应该：

*   具有类似**C 的语法**
*   具有**强大的静态类型**
*   兼容Linux**和**开源网络服务器，例如 Nginx/Apache

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T01:40:51.310

试试“玩！” 框架，它使用 Java / Scala 进行编程。

主页：[Playframework](http://www.playframework.org/)

# google-maps - Sencha Touch 2 谷歌地图什么都不做

> ID：10201632
> 
> 赞同：1
> 
> 时间：2012-04-18T01:37:16.787
> 
> 标签：google-maps, sencha-touch, sencha-touch-2

我有一个 sencha touch 1 应用程序，我刚刚升级到 sencha touch 2，除了谷歌地图之外，我什么都可以工作。

在 ST1 中，我在 index.html 中添加了这一行：

```
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script> 
```

然后我将其添加到面板中：

```
 {
                xtype: 'map',
                useCurrentLocation: false,
                fullscreen: false,
                layout: 'auto',
                id: 'jobmap',
                height: 400,
                mapOptions: {
                    zoom: 12,
                    navigationControl: true,
                    navigationControlOptions: 
                    {
                        style: google.maps.NavigationControlStyle.DEFAULT
                    }
                }                    
            } 
```

在 ST2 中，文档说仍然添加对 index.html 的引用，尽管他们的论坛似乎也说使用 app.json。我已经尝试使用上面的代码并且面板上没有任何内容。它之前和之后的控件彼此相邻。

我什至刚刚尝试过：

```
 {
                xtype: 'map',
                useCurrentLocation: true
            } 
```

我仍然一无所获。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T06:09:57.523

应该设置包含您的地图的面板`layout: 'card'`。

此外，没有必要（或可能导致错误）设置`fullscreen: false`或`layout: 'auto'`，只需将它们从地图配置中删除即可。

希望能帮助到你。

# ruby-on-rails-3 - Rails 3.2 中的验证

> ID：10201634
> 
> 赞同：1
> 
> 时间：2012-04-18T01:37:40.680
> 
> 标签：ruby-on-rails-3

我在徘徊，为什么在书中`Agile Web Development with Rails`没有提到`validates_whatever_of`验证方式，所有验证示例都是使用`validates :attr, :whatever => true`? 我刚开始学习 Rails，这让我很困惑！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T01:44:13.377

`validates`语法只是同一件事的[新快捷方式。](http://api.rubyonrails.org/classes/ActiveModel/Validations/ClassMethods.html#method-i-validates)当您验证一堆具有相似限制的属性时，它特别有用。所以这：

```
validates_presence_of :one
validates_presence_of :two
validates_presence_of :three
validates_presence_of :four 
```

可以简化为

```
validates :one, :two, :three, :four, :presence => true 
```

它也是自定义验证器的一个很好的、一致的接口。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T01:45:16.753

在 Rails 2.x 中，您可能会这样说：

```
validates_presence_of :user_name 
```

在 3.x 中，您现在可以：

```
validates :username, :presence => true 
```

我认为仍然支持旧方式，但已弃用。

这实际上只是表达同一事物的不同方式。虽然较旧的书籍和教程将使用前者，但将其转换为 3.x 风格应该相当简单。例如，参见[http://api.rubyonrails.org/classes/ActiveModel/Validations/ClassMethods.html#method-i-validates 。](http://api.rubyonrails.org/classes/ActiveModel/Validations/ClassMethods.html#method-i-validates)

# php - 防止旧缩略图调整大小？

> ID：10201635
> 
> 赞同：0
> 
> 时间：2012-04-18T01:37:51.940
> 
> 标签：php, image

如何防止第一个之后的帖子调整大小？理想情况下，无论发布顺序如何，所有图像都应为 590 像素宽。

[这是现场直播。](http://dapculture.com/)

在我看来，这段代码与它有关，但无论我将宽度更改为什么，问题仍然存在。

```
add_theme_support( 'post-thumbnails' );  
set_post_thumbnail_size( 590, 275, true ); // 590 pixels wide by 275 pixels tall, hard crop mode
add_image_size( 'following-post-thumbnails', 250, 200, true ); // 250 pixels wide by 200 pixels tall, hard crop mode 
```

全功能.php

```
<?php

if ( ! isset( $content_width ) )
    $content_width  = '590';

/**
* Add Menu Support
**/

add_theme_support('automatic-feed-links');
register_nav_menu('main', 'Main Nav');

/**
* Add editor style - recommended according to Theme-Check
**/
add_editor_style('editor-style.css');

/**
* Add custom background with custom background colour fix 
* as shown here: http://devpress.com/blog/custom-background-fix-for-theme-developers/
**/

add_custom_background( 'grisaille_custom_background_callback' );

function grisaille_custom_background_callback() {

    /* Get the background image. */
    $image = get_background_image();

    /* If there's an image, just call the normal WordPress callback. We won't do anything here. */
    if ( !empty( $image ) ) {
        _custom_background_cb();
        return;
    }

    /* Get the background color. */
    $color = get_background_color();

    /* If no background color, return. */
    if ( empty( $color ) )
        return;

    /* Use 'background' instead of 'background-color'. */
    $style = "background: #{$color};";

?>
<style type="text/css">body { <?php echo trim( $style ); ?> }</style>
<?php

}

/**
* Add custom header
**/

define('HEADER_TEXTCOLOR', '334759');
define('HEADER_IMAGE', ''); // %s is the template dir uri
define('HEADER_IMAGE_WIDTH', 960); // use width and height appropriate for your theme
define('HEADER_IMAGE_HEIGHT', 200);

// gets included in the site header

function grisaille_header_style() {

    ?><style type="text/css">
        #site-title {
            background: url(<?php header_image(); ?>) 0 0 no-repeat;
            min-height: <?php echo HEADER_IMAGE_HEIGHT; ?>px;
            margin: 20px 0;          
        }
        #site-title h1 a {
            color:#<?php header_textcolor(); ?> ;
            min-height: <?php echo HEADER_IMAGE_HEIGHT; ?>px;
        }
        #site-description {
            color:#<?php header_textcolor(); ?> ;
        }
        <?php if ( 'blank' == get_header_textcolor() ) { ?>
        #site-title h1 {
            padding: 0;
        }
        #site-title h1 a  {
            display:block;
            text-indent:-99999px;
        }
        #site-description {
            display: none;
            text-indent:-99999px;
        }

<?php } ?>
</style>
<?php
}
// gets included in the admin header
function grisaille_admin_header_style() {
    ?>
        <style type="text/css">
            @font-face {
            font-family: 'WoodenNickelBlackRegular';
    src: url('<?php echo get_template_directory_uri(); ?>/type/WOODENNI-webfont.eot?') format('eot'),
         url('<?php echo get_template_directory_uri(); ?>/type/WOODENNI-webfont.woff') format('woff'),
         url('<?php echo get_template_directory_uri(); ?>/type/WOODENNI-webfont.ttf') format('truetype'),
         url('<?php echo get_template_directory_uri(); ?>/type/WOODENNI-webfont.svg#webfontDYhQeecV') format('svg');
    font-weight: normal;
    font-style: normal;
}

        #headimg h1 {
            margin-bottom: 0;
        }
        #headimg h1 a{
            font:80px WoodenNickelBlackRegular, "Times New Roman", Times, serif;
            padding-left: 30px;
            text-transform:uppercase;
            text-decoration:none;
            width: <?php echo HEADER_IMAGE_WIDTH; ?>px;
            height: <?php echo HEADER_IMAGE_HEIGHT; ?>px;
        }
        #desc {
            font:26px  Geneva, Verdana, sans-serif;
            padding-left: 30px;
        }
    </style><?php
}
add_custom_image_header('grisaille_header_style', 'grisaille_admin_header_style');

/**
* Change Excerpt length
**/
function grisaille_new_excerpt_length($length) {
    return 20;
}
add_filter('excerpt_length', 'grisaille_new_excerpt_length');

/**
* Change excerpt [...] to something else
**/

function grisaille_new_excerpt_more($more) {
    global $post;
    return ' ... <br /><a class="more-link" href="'. get_permalink($post->ID) . __('">keep reading</a>', 'grisaille');
}
add_filter('excerpt_more', 'grisaille_new_excerpt_more');

/**
* Thumbnail support
**/

add_theme_support( 'post-thumbnails' );  
set_post_thumbnail_size( 590, 275, true ); // 590 pixels wide by 275 pixels tall, hard crop mode
add_image_size( 'following-post-thumbnails', 250, 200, true ); // 250 pixels wide by 200 pixels tall, hard crop mode

// THIS LINKS THE THUMBNAIL TO THE POST PERMALINK
add_filter( 'post_thumbnail_html', 'grisaille_post_image_html', 10, 3 );
function grisaille_post_image_html( $html, $post_id, $post_image_id ) {

    $html = '<a href="' . get_permalink( $post_id ) . '" title="' . esc_attr( get_post_field( 'post_title', $post_id ) ) . '">' . $html . '</a>';

    return $html;
}

/**
* Google font API - adding Ubuntu font
**/
function grisaille_enqueue_scripts_styles() {
         wp_enqueue_style( 'Marvel', 'http://fonts.googleapis.com/css?family=Marvel');                                                 
}     
add_action('wp_enqueue_scripts', 'grisaille_enqueue_scripts_styles'); 

/**
* checks if the visitor is browsing either a page or a post and adds the 
* JavaScript required for threaded comments if they are
**/
function grisaille_queue_js(){
  if (!is_admin()){
    if ( is_singular() AND comments_open() AND (get_option('thread_comments') == 1))
      wp_enqueue_script( 'comment-reply' );
  }
}
add_action('get_header', 'grisaille_queue_js');

/**
* register_sidebar()
**/

add_action( 'widgets_init', 'grisaille_register_sidebars' );

function grisaille_register_sidebars() {

    /* Register the 'primary' sidebar. */
    register_sidebar(
        array(
            'id' => 'grisaillesidebar',
            'name' => __( 'Grisaille Sidebar', 'grisaille' ),
            'description' => __( 'Main right sidebar.', 'grisaille' ),
            'before_widget' => '<div class="sidebaritem">',
            'after_widget' => '</div>',
            'before_title' => '<h3 class="widget-title">',
            'after_title' => '</h3>'
        )
    );

}   

/**
* Load the Theme Options Page for social media icons
*/
require_once ( get_template_directory() . '/inc/theme-options.php' );

/**
* Loads the theme's translated strings
*/

add_action('after_setup_theme', 'grisaille_language_theme_setup');
function grisaille_language_theme_setup(){
    load_theme_textdomain('grisaille', get_template_directory() . '/lang');
}   
?> 
```

索引.php

```
<?php

  get_header();

  if (have_posts()): ?>

  <ol id="posts">
  <?php while (have_posts()) : the_post(); ?>

    <li id="post-<?php the_ID(); ?>" <?php post_class(); ?>>

      <h2 class="postTitle"><a href="<?php the_permalink() ?>" rel="bookmark"><?php the_title(); ?></a></h2>
       <span class="comments"><?php comments_popup_link('0', '1 ', '%'); ?></span>
       <div class="clearfix"></div>
       <p class="theDate"><a href="<?php the_permalink() ?>" rel="bookmark"><?php the_time('F j, Y'); ?></a> <?php _e('by', 'grisaille'); ?> <?php the_author(); ?></p>

      <div class="post-wrap">
      <?php the_post_thumbnail('following-post-thumbnails'); ?>
      <?php the_excerpt(__('keep reading', 'grisaille')); ?></div>
      <?php wp_link_pages(
                array(  'before'           => '<p class="pages-links">' . __('Pages:', 'grisaille'),
                        'after'            => '</p>',
                        'next_or_number'   => 'number',
                        'nextpagelink'     => __('Next page', 'grisaille'),
                        'previouspagelink' => __('Previous page', 'grisaille'),
                        'pagelink'         => '%')); ?>
      <p class="postMeta"><small><?php _e('Category', 'grisaille'); ?> <?php the_category(', ') ?> | <?php _e('Tags', 'grisaille'); ?>: <?php the_tags(' '); ?></small></p>

      <hr class="noCss" />
    </li>

    <?php comments_template(); // Get wp-comments.php template ?>

    <?php endwhile; ?>

  </ol>

<?php else: ?>

  <p><?php _e('Sorry, no posts matched your criteria.', 'grisaille'); ?></p>

  <?php endif; ?>

    <div class="pagination-older"><?php next_posts_link( __('&laquo; Older Entries', 'grisaille')); ?></div>
    <div class=" pagination-newer"><?php previous_posts_link( __('Newer Entries &raquo;', 'grisaille')); ?></div> 

  <?php
  get_footer();
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T02:57:06.800

You should remove this line, it is used for defining a custom thumbnail size:

```
add_image_size( 'following-post-thumbnails', 250, 200, true ); // 250 pixels wide by 200 pixels tall, hard crop mode 
```

Then change the following line in index.php (it's telling the thumbnails to use the custom image size defined above):

```
<?php the_post_thumbnail('following-post-thumbnails'); ?> 
```

To this:

```
<?php the_post_thumbnail(); ?> 
```

That should result in your thumbnails using the default size specified on this line:

```
set_post_thumbnail_size( 590, 275, true ); 
```

I'm not sure how Wordpress' thumbnails work, but try uploading new images to see if the thumbnails get resized correctly. It looks like the subsequent posts' thumbnails are cropped permanently and would not resize by changing the code.

If that doesn't work, hopefully the documentation here should help: [http://codex.wordpress.org/Function_Reference/the_post_thumbnail](http://codex.wordpress.org/Function_Reference/the_post_thumbnail)

# python - SqlAlchemy 不接受 DateTime 列中的 datetime.datetime.now 值

> ID：10201648
> 
> 赞同：19
> 
> 时间：2012-04-18T01:40:45.020
> 
> 标签：python, sqlalchemy, flask-sqlalchemy

我应该首先提到我正在通过 Flask-SqlAlchemy 使用 SqlAlchemy。我不相信这会影响问题，但如果确实如此，请告诉我。

这是我在 SqlAlchemy 中运行 create_all 函数时收到的错误消息的相关部分

`InterfaceError: (InterfaceError) Error binding parameter 4 - probably unsupported type. u'INSERT INTO podcasts (feed_url, title, url, last_updated, feed_data) VALUES (?, ?, ?, ?, ?)' (u'http://example.com/feed', u'Podcast Show Title', u'http://example.com', '2012-04-17 20:28:49.117000'`

这是我的模型：

```
class Podcast(db.Model):
    import datetime
    __tablename__ = 'podcasts'
    id = db.Column(db.Integer, primary_key=True)
    feed_url = db.Column(db.String(150), unique=True)
    title = db.Column(db.String(200))
    url = db.Column(db.String(150))
    last_updated = db.Column(db.DateTime, default=datetime.datetime.now)
    feed_data = db.Column(db.Text)

    def __init__(self, feed_url):
        import feedparser

        self.feed_url = feed_url
        self.feed_data = feedparser.parse(self.feed_url)
        self.title = self.feed_data['feed']['title']
        self.url = self.feed_data['feed']['link'] 
```

有人能告诉我如何让它工作吗？我也尝试过以下模型，但这也行不通。同样的错误。

```
class Podcast(db.Model):
    import datetime
    __tablename__ = 'podcasts'
    id = db.Column(db.Integer, primary_key=True)
    feed_url = db.Column(db.String(150), unique=True)
    title = db.Column(db.String(200))
    url = db.Column(db.String(150))
    last_updated = db.Column(db.DateTime)
    feed_data = db.Column(db.Text)

    def __init__(self, feed_url):
        import feedparser

        self.feed_url = feed_url
        self.feed_data = feedparser.parse(self.feed_url)
        self.last_updated = datetime.datetime.now()
        self.title = self.feed_data['feed']['title']
        self.url = self.feed_data['feed']['link'] 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-11-20T00:42:00.380

尝试使用`datetime.datetime.utcnow()`. 这对我有用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-11-27T05:42:39.817

```
last_updated = db.Column(db.DateTime, default=db.func.current_timestamp()) 
```

我认为这会奏效

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-03-09T14:41:16.833

设置导入类。

```
from datetime import datetime

last_updated = db.Column(db.DateTime, default=datetime.now()) 
```

或者

```
import datetime

last_updated = db.Column(db.DateTime, default=datetime.datetime.now()) 
```

我做了这个

* * *

## 回答 #4

> 赞同：-9
> 
> 时间：2012-04-24T16:39:13.420

看看你的线：

```
last_updated = db.Column(db.DateTime, default=datetime.datetime.now) 
```

python中没有`datetime.datetime.now`属性。但是， python中**有**一个`datetime.datetime.now()` **函数**。你只是少了一对括号。

# python - 试图找出一种方法让我的图像在与物体碰撞时向相反方向移动

> ID：10201649
> 
> 赞同：1
> 
> 时间：2012-04-18T01:40:47.233
> 
> 标签：python

有点长，但我不是在寻找复制和粘贴的答案。我只想知道如何解决这个问题的好方法。粘贴代码以获得视觉偏好。

更好的说法。我的图像与另一个图像发生碰撞，该对象代表瓷砖（地板/屋顶/墙壁/等）。

我将这些图块放置在整个屏幕的不同位置。我使用 rect 对象存储这些位置，并将它们存储到一个名为`terrain`. 所以我遍历我的列表，当我遇到我的英雄和一些地形对象的碰撞时，停止移动。

我现在意识到这是一个问题。当发生这种情况并且我确实发生了碰撞时，我无法再移动我的对象，它被卡住了。

那么我怎样才能让我的对象仍然移动，但是当它与某个对象发生碰撞时。不允许继续朝同一方向进一步移动。

这是运动控制的主要部分：

该`moveDown`声明是我尝试实现它的部分。
`floorCollusion`是 5 个 False 布尔值的列表。

```
#0 represents - no collision
#1 "       "  - top face has collided
#2 "       "  - right face has collided
#3 "       "  - bottom face has collided
#4 "       "  - left face has collided 
```

我看到我有二进制操作。要么我搬家，要么不搬家。我只是想不出另一种方法来实现这一点。

您无需添加到代码中。关于如何看到这一点的基本想法将不胜感激。

```
moveDown  = False
moveUp    = False
moveLeft  = False
moveRight = False
#when key down either move the hero or quit game
        elif event.type == KEYDOWN:
            if event.key in (K_UP, K_w):
                moveDown = False
                moveUp = True
        playerObj['jumping'] = True #@@@@@@

    elif event.key in (K_DOWN,K_s):
       moveUp = False
       moveDown = True

            elif event.key in (K_LEFT, K_a):
                moveRight = False
                moveLeft = True

        #if the image is not facing left, display the left img
        if (playerObj['facing']) != LEFT:
        playerObj['surface'] = L_HERO_IMG
        playerObj['facing'] = LEFT

    elif event.key in (K_RIGHT, K_d):
        moveLeft = False
        moveRight = True

        #if the image is not facing right, display the right img
        if (playerObj['facing']) != RIGHT:
        playerObj['surface'] = R_HERO_IMG
        playerObj['facing'] = RIGHT

            elif event.key == K_ESCAPE:
                terminate()

    #testing hit point system
    elif event.key == K_SPACE:
        playerObj['health'] -= 3

        if playerObj['health'] <= 0:
        gameOver = True

    #when key is lifted stop movement
    elif event.type == KEYUP:
    if event.key in (K_UP, K_w):
       moveUp = False

    elif event.key in (K_DOWN, K_s):
       moveDown = False

    elif event.key in (K_LEFT,K_a):
       moveLeft = False

    elif event.key in (K_RIGHT,K_d):
       moveRight = False

#moving the hero
if not gameOver:

        if moveLeft:
    playerObj['x'] -= MOVERATE

        if moveRight:
    playerObj['x'] += MOVERATE

    #if the player pressed key up or 'w' and hero isn't jump
    #the hero will seems to have a jumping affect
        if moveUp:
    playerObj['y'] -= MOVERATE
        if moveDown:
    playerObj['y'] += MOVERATE
    for i in range(len(terrain)):
        tile = terrain[i]
        if playerObj['rect'].colliderect(tile):
           floorCollusion[2] = True
           break
        else:
           floorCollusion[2] = False
    if floorCollusion[2]:
        playerObj['x'] -= MOVERATE 
```

# javascript - 我可以从不同的页面传递过滤器值吗？

> ID：10201655
> 
> 赞同：1
> 
> 时间：2012-04-18T01:41:06.800
> 
> 标签：javascript, jquery, jquery-isotope

我在一个项目中使用[jQuery Isotope 。](http://isotope.metafizzy.co/)

我可以将过滤器值从不同页面上的 href 链接传递给它吗？因此，当我登陆带有同位素的页面时，它会根据 a href 过滤布局。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T01:45:46.200

是的。您可以使用 Isotope 的[哈希历史插件](http://isotope.metafizzy.co/demos/hash-history.html)，它使用[jQuery BBQ](http://benalman.com/projects/jquery-bbq-plugin/)。

这个例子只是来自 Isotope 文档上的哈希历史页面源的 copypasta。

```
$(window).bind( 'hashchange', function( event ){
    // get options object from hash
    var hashOptions = window.location.hash ? $.deparam.fragment( window.location.hash, true ) : {},
        // do not animate first call
        aniEngine = hashChanged ? 'best-available' : 'none',
        // apply defaults where no option was specified
        options = $.extend( {}, defaultOptions, hashOptions, { animationEngine: aniEngine } );
// apply options from hash
$container.isotope( options );
// save options
isotopeOptions = hashOptions;

// if option link was not clicked
// then we'll need to update selected links
if ( !isOptionLinkClicked ) {
  // iterate over options
  var hrefObj, hrefValue, $selectedLink;
  for ( var key in options ) {
    hrefObj = {};
    hrefObj[ key ] = options[ key ];
    // convert object into parameter string
    // i.e. { filter: '.inner-transition' } -> 'filter=.inner-transition'
    hrefValue = $.param( hrefObj );
    // get matching link
    $selectedLink = $optionSets.find('a[href="#' + hrefValue + '"]');
    changeSelectedLink( $selectedLink );
  }
}

isOptionLinkClicked = false;
hashChanged = true;
})

    // trigger hashchange to capture any hash data on init
    .trigger('hashchange');

}); 
```

# sproutcore - SproutCore 在将 ListView 内容绑定到 ArrayController 时令人困惑

> ID：10201657
> 
> 赞同：0
> 
> 时间：2012-04-18T01:42:07.887
> 
> 标签：sproutcore

在 SproutCore 中，将 ListView.content 绑定到 ArrayController 是一种常见的方法：

```
Todos.todosController = SC.ArrayController.create({
});

SC.ListView.design({
    contentBinding: SC.Binding.oneWay('Todos.todosController'),
    exampleView: SC.CheckboxView.design({
      ..........
    })
}) 
```

但是从 SC.CollectionView 扩展的 ListView 的“内容”字段是 SC.Array，不应该是：

```
contentBinding: SC.Binding.oneWay('Todos.todosController.content') 
```

任何解释将不胜感激。对不起英语不好。

@TopherFangio 我查看了实现`SC.ArrayController`并发现这`.arrangedObjects`是一个非常简单的计算属性，它返回它所属的对象：

```
arrangedObjects: function() {
    return this;
}.property().cacheable() 
```

所以绑定到`.arrangeObjects`实际上与绑定到相同：`App.arrayController.arrangeObjects`

我还发现`SC.ArrayController`扩展`SC.Array`并实现了两个必需的方法“replace()”和“objectAt()”。

> 要在您自己的类中支持 SC.Array，您必须重写两个原语才能使用它：replace() 和 objectAt()。

这两个方法的实现`SC.ArrayController`将做一些数组控制器特定的检查并将请求转发到`.content`属性。

因此，就像@TopherFangio 所说的那样，`SC.ArrayController`它是其基础`.content`属性的代理。如果我直接绑定到`App.arrayController.content`而不是控制器本身，我想我将失去所有 arrayController 的优点。

再次感谢您的大力帮助@TopherFangio。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:59:53.073

[SC.ArrayController](http://docs.sproutcore.com/#doc=SC.ArrayController&src=false)实际上是一个代理对象，它为你做了一些好事。

您当然可以绑定到该`.content`属性，但您也可以绑定到该`.arrangedObjects`属性并设置该`orderBy`属性。这将让您修改`orderBy`并让绑定列表自动更新。一般来说，这就是你想要做的。

此外，我相信这`Todos.todosController.length`将永远是一个数字，即使内容为空。相反，如果为 null ，则调用`Todos.todosController.content.length`将引发错误。`content`

希望这可以帮助 ：-）

# c++ - 为什么调用这个复制构造函数而不是移动构造函数？

> ID：10201659
> 
> 赞同：8
> 
> 时间：2012-04-18T01:42:10.700
> 
> 标签：c++, visual-c++, c++11, copy-constructor, move-constructor

以下代码片段导致在我期望调用移动构造函数的位置调用复制构造函数：

```
#include <cstdio>

struct Foo
{
    Foo() { puts("Foo gets built!"); }
    Foo(const Foo& foo) { puts("Foo gets copied!"); }
    Foo(Foo&& foo) { puts("Foo gets moved!"); }
};

struct Bar { Foo foo; };
Bar Meow() { Bar bar; return bar; }
int main() { Bar bar(Meow()); } 
```

在 VS11 Beta 上，在调试模式下，会打印：

```
Foo gets built!
Foo gets copied!
Foo gets copied! 
```

我检查了标准，`Bar`似乎满足了自动生成默认移动构造函数的所有要求，但除非有其他原因导致无法移动对象，否则这似乎不会发生。我在这里看到了很多与移动和复制构造函数相关的问题，但我认为没有人遇到过这个特定问题。

关于这里发生了什么的任何指示？这是标准行为吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-18T01:53:41.600

不幸的是，VS11 没有提供默认的移动构造函数。请参阅备注部分中的[移动语义](http://msdn.microsoft.com/en-us/library/dd293668%28v=vs.110%29.aspx)- 引用：

> 与默认的复制构造函数不同，编译器不提供默认的移动构造函数。

# c# - 使用 C# 或 SQL 复制 Access 表结构和约束

> ID：10201661
> 
> 赞同：1
> 
> 时间：2012-04-18T01:42:28.403
> 
> 标签：c#, database, ms-access, schema

有人能告诉我如何使用 .NET 或 SQL 复制 MS Access 表的表结构及其所有约束、键等吗？我已经搜索并找到了许多复制列和类型的方法，但我需要引入约束以及主键等约束。

我有一个包含一堆表的数据库，我需要用新名称创建（仅结构）的副本。这需要从 C# 应用程序中执行，但我不在乎它是使用 ADO 还是 SQL 完成的，只要我能找到方法即可。任何提示将非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T01:50:47.897

我会使用带有 MS Access 的升迁向导

[http://support.microsoft.com/kb/237980](http://support.microsoft.com/kb/237980)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T16:09:29.953

您可以“导出”到同一个数据库，这将创建一个包含所有索引等的副本，但不是关系。

```
 // Start a new instance of Access for Automation
        oAccess = new Access.Application();

        // Open a database
        oAccess.OpenCurrentDatabase(@"z:\docs\test.accdb");
        oAccess.DoCmd.TransferDatabase(
            Access.AcDataTransferType.acExport,
            "Microsoft Access",
            @"z:\docs\test.accdb",
            Access.AcObjectType.acTable, 
            "table1",
            "newtable",true,false); 
```

# wpf - 怎么指定Datacontext 看不懂

> ID：10201662
> 
> 赞同：0
> 
> 时间：2012-04-18T01:42:31.630
> 
> 标签：wpf, mvvm

在`mMaterialCentreGroupListView.xaml`文件中，这一行是为`MaterialCentreGroupView`. 但我看不到任何用于访问 viewmodel 属性的数据上下文。它运作良好。下面是代码。

```
<vw:MaterialCentreGroupView
            Style="{StaticResource DetailedViewStyle}"
            DataContext="{Binding SelectedMaterialCentreGroup}"/> 
```

风景

```
<UserControl x:Class="MyBooks.View.MaterialCentreGroupView"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
MinWidth="290" MaxWidth="290" Padding="20"
Background="#eee">

<UserControl.Resources>
    <ResourceDictionary Source="ViewResources.xaml" />
</UserControl.Resources>

<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto"/>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="*"/>
    </Grid.ColumnDefinitions>

    <Label
        Grid.Row="0" Grid.Column="0"
        Content="{Resx ResxName=MyBooks.Properties.Strings, Key=AccountCategoryListView_Name_Label}"
        HorizontalAlignment="Right"/>
    <TextBox
        x:Name="CategoryName"
        MaxLength="50"
        Style="{StaticResource FormControlStyle}"
        Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="2"
        Text="{Binding Path=Name, ValidatesOnDataErrors=True, UpdateSourceTrigger=PropertyChanged}"/> 
```

请向我解释发生了什么以及绑定是如何发生的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T01:47:29.880

我假设 DataContext 在代码隐藏中设置（文件名称与 .xaml 文件相同，但扩展名为 .cs）。寻找像 DataContext = new SomeViewModel(); 这样的代码

或者，如果此 UserControl 正在另一个控件中使用，则可以在其上显式设置 DataContext，或者，如果没有，它将从其父级继承（可能从父级继承，也可能不从父级继承，依此类推，如果未在 XAML 或代码隐藏中显式设置）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T01:54:56.753

看 'Resx' 绑定

```
<Label 
    Grid.Row="0" Grid.Column="0" 
    Content="{Resx ResxName=MyBooks.Properties.Strings, Key=AccountCategoryListView_Name_Label}" 
    HorizontalAlignment="Right"/> 
```

有关 resx 绑定和使用的更多信息，请参阅下面的链接 [Resx 绑定和使用](http://robertoschiabel.wordpress.com/2010/01/31/wpf-add-localization-via-resx-files/)

# android - 按下主页按钮Android时没有重置editorInfo

> ID：10201666
> 
> 赞同：0
> 
> 时间：2012-04-18T01:42:57.697
> 
> 标签：android, editor, back-button, android-homebutton

我有两个不同的编辑器，我根据变量来区分它们`editorInfo.privateImeOptions`。每个编辑器都为此变量设置了不同的值。当我打开一个编辑器并按后退按钮然后打开另一个编辑器时，一切正常。但是，如果我打开一个编辑器，按主页按钮并打开另一个编辑器，`editorInfo.privateIMEOptions`仍然会给我旧值，即与第一个打开的编辑器相关联的值，而不是新打开的那个。有没有办法刷新`editorInfo`或使主页按钮的工作方式与 android 上的后退按钮完全一样。

如果有人可以让我知道如何使主页按钮像 android 中的后退按钮一样工作，那也会很有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T06:50:05.720

Back 和 Home 键之间的区别在于，当 Home 键被​​按下时，它`Activity`被移动到活动堆栈的后面，而 Back 键将其从活动堆栈中移除（这实际上意味着`Activity`完成）。

要模拟 Home 键按下的 Back 键行为，您需要`Activity`在它被发送到活动堆栈的后面时完成。请看一下[Activity Lifecycle](http://developer.android.com/reference/android/app/Activity.html#ActivityLifecycle)。

您可以在`Activity`课堂上尝试以下方法：

```
@Override
protected void onPause() {
    super.onPause();
    finish();
} 
```

# javascript - 将 camelCaseWords 从数据属性转换为“Camel Case Words”

> ID：10201669
> 
> 赞同：4
> 
> 时间：2012-04-18T01:43:52.577
> 
> 标签：javascript, jquery

我有一组带有自定义 HTML5 数据属性的链接，如下所示：`data-test="justExample"`

```
<a href="#" data-test="somethingSpecial">
    This should output "Something Special"
</a> 
```

我想返回这个值`"Just Example"`而不是 " `justExample"`。

随意编辑我创建的[这个 jsfiddle 。](http://jsfiddle.net/28NpS/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T02:08:53.733

```
$('a').click(function() {
    var str = $(this).data('test'); // get the concated string
    var arr = str.split(""); // Convert the string to array
    for (var i = arr.length - 1; i >= 0; i--) {  // iterate over the characters 
        if (arr[i].match(/[A-Z]/))  // if the char is uppercase
            arr.splice(i, 0, " "); // add a space before it
    }

    arr[0] = arr[0].toUpperCase();    // upper the first char.
    var splitedString = arr.join(""); // convert the array to string
    alert(splitedString); // alert the string.
});​ 
```

[**现场演示**](http://jsfiddle.net/WTMKn/1)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T01:49:27.997

像这样的东西？

```
$('a').click(function(){
  var input = $(this).data('test'),
      output = input.slice(0, 1).toUpperCase() + input.slice(1).replace(/[A-Z][a-z]/, ' $&');
  alert(output);
});​ 
```

编写一个通用函数将骆驼大小写转换为整洁的字符串可能会更好，但是上面的示例演示在这里工作：http: [//jsfiddle.net/rjzaworski/mFbHK/](http://jsfiddle.net/rjzaworski/mFbHK/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T02:53:10.247

这是一个简短的版本：

```
$('a').click(function(){
  var t = $(this).data('test');
  alert(t.replace( /^[a-z]|[a-z][A-Z]/g, function(s){
    return s.length==1 ? s.toUpperCase() : s.replace(/^./,'$& ');
  });
}); 
```

或者，包装成一个更可重用的函数，该函数也可以自我记录您的意图：

```
$('a').click(function(){
  alert(deCamel($(this).data('test')));
});

function deCamel(str){
  return str.replace( /^[a-z]|[a-z][A-Z]/g, function(s){
    return s.length==1 ? s.toUpperCase() : s.replace(/^./,'$& ');
  });
} 
```

# java - 使用 HZ 处理 Java 声音样本

> ID：10201670
> 
> 赞同：1
> 
> 时间：2012-04-18T01:44:01.537
> 
> 标签：java, arrays, audio, javasound, sampling

是否可以从 java 程序中为空（hz 太低）的音频样本中剪切样本。

想法是获得可以组合在一起的样本，而不会出现可听见的停顿。

例如示例 1.audiofile 说“一” 示例 2.audiofile 说“二”

然后我们在一个java程序中结合说“onetwo”而不是“one two”。

我找不到任何可以将样本的 hz 值作为整数 [] 的东西？

# php - 奇怪的 PHP 行为 - 发生了什么？

> ID：10201672
> 
> 赞同：1
> 
> 时间：2012-04-18T01:44:05.113
> 
> 标签：php, reference, foreach

> **可能重复：**
> [foreach 的奇怪行为](https://stackoverflow.com/questions/4969243/strange-behavior-of-foreach)

最近在一个 PHP 应用程序中遇到了这个错误。不知道发生了什么。

基本上，它在使用两个组合时出现`foreach`（一个带 &，一个不带）。

这是重现问题的测试代码：

```
$items = array(

    array('id'=>1, 'name'=>'foo', 'value'=>150),

    array('id'=>2, 'name'=>'bar', 'value'=>190)
);

foreach($items as &$item)
{

    $item['percentage'] = $item['value'] * 0.75;

}

var_dump($items);   // All Good

foreach($items as $item)
{

    var_dump($item);    // Shows 1st item twice
} 
```

第二个`foreach`循环按预期运行该块两次，但`$item`仍停留在第一个项目上。

我知道这可能是由于在第一个循环中使用了引用*引起*`&`的，但我不明白为什么它应该表现得像这样..

任何想法？那是一个错误吗？

在 5.3.8、5.3.10 和 5.4 上获得相同的结果

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T02:00:06.347

首先，这不是 Rasmus 所说的错误。见[https://bugs.php.net/bug.php?id=29992](https://bugs.php.net/bug.php?id=29992)

在此，使用 & 的循环变量修改数组的正确实现。

```
<?php
$arr = array(1, 2, 3, 4);
foreach ($arr as &$value) {
    $value = $value * 2;
}
// $arr is now array(2, 4, 6, 8)
unset($value); // break the reference with the last element

var_dump($arr);   // All Good

foreach($arr as $value) {
   var_dump($value);    // All good
}

?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T01:50:20.653

这是一种奇怪的 PHP 行为，几乎一直存在，当您混合使用变量作为引用而不是像您所做的那样引用时，就会发生这种情况。

我使用如下命名约定来处理它：当我使用`foreach`a时`&$item`，我将其命名为`&$refItem`. 这使我无法混合类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T14:28:32.127

这是正常的，不是奇怪的行为。只需阅读[此处](http://www.php.net/manual/en/language.references.php)的参考资料。

当您在变量前面添加 & 时，您将存储对变量的引用。所以，当你重新使用它时，它也会改变被引用变量的内容。

```
foreach($items as &$item) // You have $item here, prefixed with &.
{
    $item['percentage'] = $item['value'] * 0.75;
}

var_dump($items);

foreach($items as $item) // And your re-use it here.
{
    var_dump($item);
} 
```

为了解决这个问题，在第一个循环中添加 unset($item) ：

```
foreach($items as &$item)
{
    $item['percentage'] = $item['value'] * 0.75;
    unset($item); // add this, because you use &$item previously.
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T01:48:17.820

在将 foreach 与引用数组一起使用后，您需要取消设置指针。

[http://php.net/unset](http://php.net/unset)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-18T02:09:21.700

这可能是看起来比较理解foreach的问题

```
$last_value_of_first_foreach = 1;
$item = 2;
$c = 3;
$item = &$last_value_of_first_foreach ; // Think that this statement is first foreach loop
// Here $item is pointer to $last_value_of_first_foreach 
// To Better understanding, let change the name ($reference_to_last_value = $item;) 
```

现在，新循环是

```
$item = $c;
// Here, what it do is update value where the $item pointer refer to 
// (mean $last_value_of_first_foreach )
// so, at here $last_value_of_first_foreach has value of $c 
```

现在，回到你的例子，从第一个 foreach 开始， $item 引用到数组的最后一个元素。现在，当你在第二个 foreach 中为 $item 分配一些东西时，它所做的就是在那个里面放一些东西。

在第一个循环结束时，$item 是**指向**$items[1] 的指针。第二个循环的第一个循环会将第一个元素推送到 $item 指向的位置（这意味着 $items[1]，所以为什么 $items [1] 被 $items[0] 取代。

如果您想阻止这个，只需在下次使用之前**取消设置$item 变量。**

# php - 在 linux shell 上运行 php 的最正确方法

> ID：10201678
> 
> 赞同：0
> 
> 时间：2012-04-18T01:45:09.893
> 
> 标签：php, linux, shell

是否有从命令行使用 php 的正确方法……或者更确切地说……一种方法比另一种更正确？

如果您创建一个文件，请使用以下代码说 test.php：

```
#!/usr/bin/php
<?php
print "This is a test".PHP_EOL;
print "This is another test!!";
?> 
```

然后**chmod +x text.php**（使其在 linux 上可执行）。

然后可以通过以下方式运行..... **./test.php** 或 **php test.php**

我更喜欢只使用**./test.php**，但经常在示例中看到**php test.php 。**

还

以下是 shebang 行的正确语法 #!/usr/bin/php 还是更正确的 #!/usr/bin/php -q

我已经看到了这两种情况，并且看到 -q 标志是为了让 html 内容安静，但是想知道使用 cli 兼容性编译的 php 是否真的需要 -q 标志？
谢谢你的帮助 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T01:57:36.533

如果您为自己的目的编写小 php 脚本，那`#!`很好。

如果它们要在某种世界可见的盒子（例如网络服务器）上，那么我会说不太好 - 因为您已经使它们可执行，它们现在是一个安全风险。

我倾向于使用`#!`perl、sh（它们总是很少的私有的、非生产的东西）和`php somefile.php`PHP（可能会或可能不会在服务器上结束）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T02:02:47.200

```
#!/usr/bin/php 
```

在解释器脚本的第一行，“#!”是应该用来解释文件内容的程序的名称。例如，如果第一行包含

> “#！/bin/sh”

, 然后文件的内容作为 shell 脚本执行。

在您的情况下，这意味着使用 /usr/bin 位置中的 php 文件执行脚本。

使用`php test.php`意味着您正在使用 php 运行 test.php，因此您不需要第一行。至于 ./test.php 您的文件需要是可执行文件并且需要第一行。

关于 -q 标志，请[特别](http://php.net/manual/en/features.commandline.php) 查看

> 抢 2007 年 3 月 23 日 11:48

如果你看到 -q 会有更好的扩展。这是[另一个](https://stackoverflow.com/questions/5777792/what-does-it-mean-to-run-php-in-quiet-mode)

# architecture - 哪个不是架构级别？

> ID：10201682
> 
> 赞同：0
> 
> 时间：2012-04-18T01:45:56.470
> 
> 标签：architecture, software-design

我正在参加一个模拟架构测试，我遇到了一个问题

```
Which of the following is not a level of architecture:

    a) Design Patterns
    b) Requirements Analysis
    c) Application Architecture
    d) Enterprise Architecture
    e) Application Framework 
```

我没看懂问题在说什么？任何想法？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T04:11:58.797

**需求分析**找出软件应该实现的功能**。**

**架构**是**如何**实现的大图——它是设计的一部分。

**b**是唯一不关心**如何**问题的点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T01:53:10.450

正如评论者所暗示的那样，讲师在某些时候给出了“架构级别”的列表，您应该在这里咳出它们。如果我不得不猜测，我会说“b”，需求分析，这是一个奇怪的结果：它是一个过程，而所有其他都是软件实现或设计的方面

# android - Coverflow：做无限循环（像启动器一样，到达最后一个项目时可以返回第一个项目）

> ID：10201685
> 
> 赞同：0
> 
> 时间：2012-04-18T01:46:05.823
> 
> 标签：android, loops, user-interface, coverflow

CoverFlow 是画廊小部件的实现。

图片：http: [//4.bp.blogspot.com/_UW2f-eaiXZs/S4lCNH-wpyI/AAAAAAAAAJE/0Ce8jGe8fSA/s200/coverflowv2.png](http://4.bp.blogspot.com/_UW2f-eaiXZs/S4lCNH-wpyI/AAAAAAAAAJE/0Ce8jGe8fSA/s200/coverflowv2.png)

当您在 android 或 iOS 中使用音乐播放器时，它就像专辑封面一样工作。

基于此 url > [http://www.inter-fuser.com/2010/02/android-coverflow-widget-v2.html](http://www.inter-fuser.com/2010/02/android-coverflow-widget-v2.html)，我为我的项目实现了coverflow作为主菜单UI，但我遇到了问题使项目在到达最后一项时循环回第一项。

我所说的无限循环的意思是，例如：如果coverflow有5个项目，那么当应用程序启动时，屏幕中心将显示项目#3。当我向右滑动 2 次时，我会发现最后一个项目在右侧，并且无法再向右滑动，因为没有提供更多项目。我想要的是它能够循环回到项目#1 等等。

例如，这里我们有五个项目[1] [2] [3] [4] [5]

插图（项目 - 请想象它显示在屏幕上）：当第一次启动时，显示的 UI 将是

2] [3] [4 -- (5 等待显示)

当我向右滑动一次时，它会显示

3] [4] [5 -- （5后无其他项目）

当我再次向右滑动时：

4] [5] -- （没有更多的项目，所以它会在 5 之后显示空白）

我想要的是：

4] [5] [1 -- (2 正在等待)

5] [1] [2 -- (3 正在等待

我希望它可以双向工作（向右移动：最后一项到第一项，向左移动：第一项到最后一项）。真的需要一个想法来解决这个问题。任何建议将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T02:35:18.373

查看[如何创建封闭（圆形）ListView 的答案？](https://stackoverflow.com/questions/2332847/how-to-create-a-closed-circular-listview). 您可能可以使用类似的概念来为您的coverflow 视图提供适配器。

# php - 如何比较字符串中的版本号？

> ID：10201688
> 
> 赞同：3
> 
> 时间：2012-04-18T01:46:18.127
> 
> 标签：php, comparison, versioning

我需要比较两个版本#，看看一个是否大于另一个，并且很难做到这一点。

版本 1：test_V10.1.0.a.1@example 版本 2：test_V9.7.0_LS@example

我已经尝试去除所有非数字字符，所以我会留下：

版本1：10101 版本2：970

这会从 10.1.0.a.1 中删除“a”，所以这不好，我尝试在“test_”和“@”之间取所有内容，然后删除下划线“_”和下划线右侧的所有内容本身，但是我仍然必须去掉字符串开头的“V”。

即使我可以降到只有 10.1.0.a.1 和 9.7.0，我如何比较这两个？我怎么知道 10.1.0.a.1 是否大于 9.7.0？如果我去掉小数，我仍然在 1010a1 中留下一个非数字字符，但我需要那个字符，以防我比较的发行版本是 10.1.0.b.1，这将大于10.1.0.a.1。

这让我发疯了，以前有人处理过吗？你是如何比较这些值的？我正在使用 php。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T19:29:00.793

你不应该使用吗？版本比较（版本 1，版本 2）

[http://php.net/manual/en/function.version-compare.php](http://php.net/manual/en/function.version-compare.php)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-18T01:54:58.550

我认为您想考虑使用正则表达式来解析版本号的“数字”部分 - “10.1.0.a.1”和“9.7.0”。之后，你可以用'.'[分割。](http://php.net/manual/en/function.split.php)得到两个“版本数组”。

使用版本数组，您可以从它们中弹出元素，直到找到更高的数字。无论它来自哪个数组都是更高的版本号。如果任一数组用完，则它的版本号较小（除非所有剩余元素都是“0”或“a”或您用来表示“基本版本”的任何语义，例如“10.0.0.a.0”== “10.0”）。如果两者同时用完，那么它们是相等的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-18T02:07:55.200

利用`explode('.', $versionNum)`

```
$ver1 = '10.1.0.a.1';
$ver2 = '10.1.0';
$arr1 = explode('.', $ver1);
$arr2 = explode('.', $ver2);

$min = min(count($arr1), count($arr2));

for ($i = 0; $i < $min; $i++)
{
    if ($i + 1 == $min)
        echo ($min == count($arr1)) ? $ver2 : $ver1;
    if ($arr1[$i] > $arr2[$i])
    {
        echo $ver1;
        break;
    }
    elseif ($arr1[$i] < $arr2[$i])
    {
        echo $ver2;
        break;
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T01:56:25.317

以下正则表达式将匹配 "test_V" 和 "@example" 之间的所有内容，并将其放入名为 $matches[1] 的数组中

```
$pattern = '/test_V(.*?)(?:_.*?)?@example/i';
$string = 'version 1: test_V10.1.0.a.1@example version 2: test_V9.7.0_LS@example';
if(preg_match_all($pattern,$string,$matches))
{
  print_r($matches[1]);
} 
```

返回

```
Array
(
    [0] => 10.1.0.a.1
    [1] => 9.7.0
) 
```

这将使您在弄清楚要如何分解相当复杂的版本号方面占得先机。

# iphone - 将图像数组放入圆柱体中？

> ID：10201689
> 
> 赞同：0
> 
> 时间：2012-04-18T01:46:19.560
> 
> 标签：iphone, ios

我在这里为我的数组准备了代码：

```
for (int i = 0; i < imgCount; i++) {
        // Load image from the bundle

        NSString * fileName = [NSString stringWithFormat: @"Image-%d", i];
        NSString * filePath = [[NSBundle mainBundle] pathForResource: fileName ofType: @"jpeg"];

        UIImage * img = [UIImage imageWithContentsOfFile: filePath]; 
```

是否可以将我的阵列变成圆柱型或带过渡的 calayer？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T02:20:56.077

我试过研究这个：[iCarousel](https://github.com/nicklockwood/iCarousel)

这也有一个图层转换示例：[CA360](https://github.com/neror/CA360)

希望这对任何人都有帮助。

# python - 在python中，双星后跟变量名是什么意思？

> ID：10201703
> 
> 赞同：8
> 
> 时间：2012-04-18T01:48:20.547
> 
> 标签：python, zsi

> **可能重复：**
> [**（双星）和*（星）对python参数有什么作用？](https://stackoverflow.com/questions/36901/what-does-double-star-and-star-do-for-python-parameters)

我正在阅读 ZSI 为 python 生成的一些代码。有这样一条线

`def verifyVehicle(self, request, **kw): ....`

我想知道这个 **kw neams 是做什么的。这是 neam 字典类型吗？谢谢

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-18T01:50:14.720

它指的是传递给函数但不在方法定义中的所有关键字参数。例如：

```
>>> def foo(arg, **kwargs):
...     print kwargs
... 
>>> foo('a', b="2", c="3", bar="bar")
{'c': '3', 'b': '2', 'bar': 'bar'} 
```

它类似于只使用一个星号，它指的是所有非关键字参数：

```
>>> def bar(arg, *args):
...     print args
... 
>>> bar(1, 2, 3, 'a', 'b')
(2, 3, 'a', 'b') 
```

你可以结合这些（人们经常这样做）

```
>>> def foobar(*args, **kwargs):
...     print args
...     print kwargs
... 
>>> foobar(1, 2, a='3', spam='eggs')
(1, 2)
{'a': '3', 'spam': 'eggs'} 
```

# android - 如何在设备上拥有不同版本的 android 项目？

> ID：10201708
> 
> 赞同：0
> 
> 时间：2012-04-18T01:49:12.507
> 
> 标签：android, intellij-idea

当我开发我的 android 应用程序时，我的设备上需要有不同版本的代码。我想在一周左右的时间内获得一份最新代码的副本。原因是有时您对代码进行更改并使其变得更糟一段时间，然后您会完善您的代码以包含这些功能。所以我需要在设备上拥有我的代码的最新*正确*运行版本的副本。

我尝试更改应用程序名称，以查看 ide 是否部署了我的代码的新副本，但它不起作用，并且 ide 似乎比这更聪明，它用新名称替换了应用程序。我怀疑我需要更改有点令人沮丧/有风险的包裹。有人知道解决方案吗？

现在，我正在使用 Intellij 来实现我的 android 项目，但我认为这并不重要。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T02:03:28.973

您需要更改包名称。

我使用 ant 构建脚本很容易做到这一点。我创建了一个 ant 任务来重命名包名并进行构建。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T02:00:09.373

我实现这个目标的方法是：

```
- configure the original project as library
- create another project specifying a different package name in the manifest
- you also need to declare all the activities, receivers, etc with the full name in the new manifest 
```

这样，通过不同的分支切换原始项目的代码，您可以创建不同的 apk，并在您的设备上同时安装不同版本的应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T02:00:30.800

您需要更改包名称，而不是应用程序名称，这在 Eclipse 中非常容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T04:36:20.543

如果您的包名现在是 'com.sina.perch'，那么只需将其重命名为 'com.sina.perch1' 或文件 'AndroidManifest.xml' 中的其他名称，如下所示：

这将是工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-18T01:53:46.457

通常我使用 svn 来跟踪更改并标记哪些是有效的，然后添加功能并使用 svn merge 命令将新功能与工作代码结合起来。然后，如果您想撤消某些操作，您可以回滚修订。

# iphone - iOS中自定义键盘实现有什么好的教程吗？

> ID：10201709
> 
> 赞同：6
> 
> 时间：2012-04-18T01:49:19.860
> 
> 标签：iphone, ios, keyboard, tamil

我需要为区域语言“泰米尔语”制作自定义键盘，如果用户按下自定义键盘键，我必须引入泰米尔语字体。那可能吗？如果是这样，有可用的教程或资源吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T02:49:35.830

[http://cocoacontrols.com/platforms/ios/controls/amkeyboardnumberpad](http://cocoacontrols.com/platforms/ios/controls/amkeyboardnumberpad)，它是一个简单的键盘，但您可以看到它是如何实现的，以便快速入门。

这个站点有非常好的 IOS 开源控件。希望能帮助到你

# css - 火狐和 垂直对齐

> ID：10201710
> 
> 赞同：0
> 
> 时间：2012-04-18T01:49:23.230
> 
> 标签：css, firefox, html-lists, cross-browser

我正在尝试制作一个与屏幕顶部齐平的水平菜单栏。它在 Chrome 中运行良好，但在 Firefox 中，LI 被截断了一半。

[这是一个小提琴](http://jsfiddle.net/efq2u/1/)。

如何让它正常工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T01:55:53.783

```
 .topmenu li:hover a, .topmenu a:hover { position:absolute; display:inline-block; 
  width:inherit; height:30px; background:inherit; text-align:center; } 
```

那应该对你有用。只需将绝对位置添加到此部分即可。

# google-app-engine - 节奏模板引擎和GAE

> ID：10201712
> 
> 赞同：3
> 
> 时间：2012-04-18T01:49:29.713
> 
> 标签：google-app-engine, rythm

有没有人设法让 Rythm 模板引擎与 Google Appengine 一起工作？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T00:02:57.977

Rythm 现在（版本[1.0.0-20120505](http://rythmengine.com/public/rythm-1.0.0-20120505-dist.zip)）适用于 GAE。在[http://play-rythm-demo.appspot.com/上有一个演示应用程序正在运行](http://play-rythm-demo.appspot.com/)

以及演示应用的源代码：[https ://github.com/greenlaw110/play-rythm-demo](https://github.com/greenlaw110/play-rythm-demo)

# c++ - 使用 C++/WinAPI 在对话窗口中释放资源的适当消息是什么

> ID：10201714
> 
> 赞同：1
> 
> 时间：2012-04-18T01:49:37.067
> 
> 标签：c++, winapi, mfc, dialog

我在原生 WinAPI 世界中使用 C++/MFC 进行编程。比如说，我有一个对话框窗口类（在 MFC 中创建并从 CDialog 派生）。我还在 OnInitDialog() 中创建了一个计时器，当窗口即将显示时，使用 SetTimer 方法。我的问题是何时需要正确释放此计时器（或其他分配的资源）？

PS。我尝试在 PostNcDestroy() 中执行此操作，但 KillTimer 失败。但是当我在 OnClose/WM_CLOSE 中执行此操作时，它可以工作，但当用户单击“确定”按钮关闭对话框时则不行。有统一的通知吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T02:03:10.957

我在 ON_WM_DESTROY 处理程序中执行此操作。在 WM_CLOSE 和 PostNcDestroy 方法之间调用。这是您应该销毁所有窗口资源的地方。

请记住，例如 GDI 资源应该尽可能快地释放，重新创建实际上不再花费时间，而且 GDI 资源的数量非常少。我认为整个系统的默认值是 10000，即使在 64 位 Windows 下也是如此。

# c - Kurose 模拟网络环境，Go-Back-N

> ID：10201718
> 
> 赞同：0
> 
> 时间：2012-04-18T01:50:16.083
> 
> 标签：c, network-protocols, infinite-loop, go-back-n

我正在尝试为在 C 中使用 Go-Back-N 进行类的模拟网络环境编写代码。但是，我不断陷入某种涉及我的`A_timerinterrupt()`方法的无限循环。下面是C文件，你可以看看它和我的方法。

请注意，我在模拟消息数 = 10、丢包概率 = 0.1、损坏概率 = 0.1、平均时间 = 5 和 TRACE = 0 的情况下运行了这个。

我得到的是一个无限循环的`A: Timer Stopped!`消息，只有在`A_timerinterrupt`被调用时才会发生。

```
#include <stdio.h>

/* ******************************************************************
ALTERNATING BIT AND GO-BACK-N NETWORK EMULATOR: VERSION 1.1  J.F.Kurose

This code should be used for PA2, unidirectional or bidirectional
data transfer protocols (from A to B. Bidirectional transfer of data
is for extra credit and is not required).  Network properties:
- one way network delay averages five time units (longer if there
    are other messages in the channel for GBN), but can be larger
- packets can be corrupted (either the header or the data portion)
    or lost, according to user-defined probabilities
- packets will be delivered in the order in which they were sent
    (although some can be lost).
**********************************************************************/

#define BIDIRECTIONAL 0     /* change to 1 if you're doing extra credit */
            /* and write a routine called B_output */

/* a "msg" is the data unit passed from layer 5 (teachers code) to layer  */
/* 4 (students' code).  It contains the data (characters) to be delivered */
/* to layer 5 via the students transport level protocol entities.         */
struct msg {
    char data[20];
};

/* a packet is the data unit passed from layer 4 (students code) to layer */
/* 3 (teachers code).  Note the pre-defined packet structure, which all   */
/* students must follow. */
struct pkt {
    int seqnum;
    int acknum;
    int checksum;
    char payload[20];
};

/********* STUDENTS WRITE THE NEXT SEVEN ROUTINES *********/
#define winSize 8
#define maxBuffer 50
#define NACK -1

/* expected seqnum at receiver side */
int expectnum;
/* next seqnum to use in sender side */
int nextnum;
/* the head of sender window */
int base;

/* window packets buffer */
struct pkt winBuffer[winSize];
/* start and end points of window buffer */
int winStart, winEnd;
/* packet number of window buffer */
int pNum;

/* sender message buffer */
struct msg buffer[maxBuffer];
/* message count of buffer */
int msgnum;
/* front and rear pointers of buffer */
int bufStart, bufEnd;

/* computes checksum for packet */
void csum(packet)
struct pkt *packet;
{
    int checksum;
    int i;
    checksum = packet->seqnum;
    checksum = checksum + packet->acknum;
    for (i = 0; i < 20; i++)
        checksum = checksum + (int)(packet->payload[i]);
    checksum = 0 - checksum;
    packet->checksum = checksum;
}

/* checks if packet is corrupt */
int Corrupted(packet)
struct pkt packet;
{
    int checksum;
    int i;
    checksum = packet.seqnum;
    checksum = checksum + packet.acknum;
    for (i = 0; i < 20; i++)
        checksum = checksum + (int)(packet.payload[i]);
    if ((packet.checksum + checksum) == 0)
        return (0);
    else
        return (1);
}

/* called from layer 5, passed the data to be sent to other side */
A_output(message)
struct msg message;
{
    int i;
    struct pkt sendpkt;
    /* if window is not full */
    if (nextnum < base + winSize) {
        /* create packet */
        sendpkt.seqnum = nextnum;
        sendpkt.acknum = 0;
        printf("A: Sending message\n");
        for (i = 0; i < 20; i++)
            sendpkt.payload[i] = message.data[i];
        /* get checksum */
        csum(&sendpkt);
        /* send packet */
        tolayer3(0, sendpkt);
        /* copy packet */
        pNum++;
        winEnd = (winEnd + 1) % winSize;
        winBuffer[winEnd] = sendpkt;
        for (i = 0; i < 20; i++)
            winBuffer[winEnd].payload[i] = sendpkt.payload[i];
        /* start timeout for packet */
        if (nextnum == base) {
            starttimer(0, 20);
            printf("A: Starting timer\n");
        }
        /* increment nextnum */
        nextnum = nextnum + 1;
    }
    /* if window is full */
    else {
        printf("A: Send window is full! \n");
        /* exit if full */
        if (msgnum == maxBuffer) {
            printf("A: Buffer is full! \n");
            exit(1);
        }
        /* if not full, buffer message */
        else {
            printf("A: Buffering message\n");
            bufEnd = (bufEnd + 1) % maxBuffer;
            for (i = 0; i < 20; i++)
                buffer[bufEnd].data[i] = message.data[i];
            msgnum++;
        }
    }
}

B_output(message)       /* need be completed only for extra credit */
struct msg message;
{
}

/* called from layer 3, when a packet arrives for layer 4 */
A_input(packet)
struct pkt packet;
{
    int i;
    struct pkt sendpkt;
    /* if received packet is not corrupted and NACK is not received */
    if ((Corrupted(packet) == 0) && (packet.acknum != NACK)) {
        printf("A: ACK, B got the packet\n");
        /* empty window buffer */
        winStart = (winStart + (packet.acknum + 1 - base)) % winSize;
        pNum = pNum - (packet.acknum + 1 - base);
        /* change base */
        base = packet.acknum + 1;
        stoptimer(0);
        if (base < nextnum) {
            starttimer(0, 20);
            printf("A: Sending packets\n");
        }
        /* send new packets */
        while ((msgnum != 0) && (nextnum < base + winSize)) {
            /* make packet */
            sendpkt.acknum = 0;
            sendpkt.seqnum = nextnum;
            bufStart = (bufStart + 1) % maxBuffer;
            for (i = 0; i < 20; i++)
                sendpkt.payload[i] = buffer[bufStart].data[i];
            /* checksum */
            csum(&sendpkt);
            /* start timeout */
            if (base == nextnum) {
                starttimer(0, 20);
                printf("A: Sending packets\n");
            }
            /* send packet */
            tolayer3(0, sendpkt);
            /* copy packet */
            winEnd = (winEnd + 1) % winSize;
            winBuffer[winEnd] = sendpkt;
            pNum++;
            /* increment nextnum */
            nextnum = nextnum + 1;
            /* decrement messages */
            msgnum--;
        }
    } else
        printf("A: NAK, B Requested a resend\n");
}

/* called when A's timer goes off */
A_timerinterrupt()
{
    int i;
    //printf("A: Timer stopped!\n");
    /* start timer */
    starttimer(0, 20);
    /* resend */
    for (i = 1; i <= pNum; i++) {
        tolayer3(0, winBuffer[(winStart + i) % winSize]);
    }
}

/* the following routine will be called once (only) before any other */
/* entity A routines are called. You can use it to do any initialization */
A_init()
{
    nextnum = 0;
    msgnum = 0;
    base = 0;
    pNum = 0;
    winStart = 0;
    winEnd = 0;
    bufStart = 0;
    bufEnd = 0;
}

/* Note that with simplex transfer from a-to-B, there is no B_output() */

/* called from layer 3, when a packet arrives for layer 4 at B*/
B_input(packet)
struct pkt packet;
{
    struct pkt sendpkt;
    int i;
    /* if not corrupted and packet number is expected */
    if ((Corrupted(packet) == 0) && (packet.seqnum == expectnum)) {
        printf("B: Packet received, Sending ACK");
        /* send an ACK */
        /* make packet */
        sendpkt.seqnum = 0;
        sendpkt.acknum = expectnum;
        for (i = 0; i < 20; i++)
            sendpkt.payload[i] = '0';
        /* get checksum */
        csum(&sendpkt);
        /* send packet */
        tolayer3(1, sendpkt);
        /* increment expected packet number */
        expectnum = expectnum + 1;
        /* send packet up */
        tolayer5(1, packet.payload);
    }
    /* send NACK */
    else {
        printf("B: Sending NACK, packet not received or was corrupt");
        /* make packet */
        sendpkt.seqnum = 0;
        sendpkt.acknum = NACK;
        for (i = 0; i < 20; i++)
            sendpkt.payload[i] = '0';
        /* get checksum */
        csum(&sendpkt);
        /* send packet */
        tolayer3(1, sendpkt);
    }
}

/* called when B's timer goes off */
B_timerinterrupt()
{
    int i;
    printf("B: Timer was interrupted!\n");
    /* start timer */
    starttimer(1, 20);
    /* resend */
    for (i = 1; i <= pNum; i++) {
        tolayer5(1, winBuffer[(winStart + i) % winSize]);
    }
}

/* the following rouytine will be called once (only) before any other */
/* entity B routines are called. You can use it to do any initialization */
B_init()
{
    expectnum = 0;
}

/*****************************************************************
***************** NETWORK EMULATION CODE STARTS BELOW ***********
The code below emulates the layer 3 and below network environment:
- emulates the tranmission and delivery (possibly with bit-level corruption
and packet loss) of packets across the layer 3/4 interface
- handles the starting/stopping of a timer, and generates timer
interrupts (resulting in calling students timer handler).
- generates message to be sent (passed from later 5 to 4)

THERE IS NOT REASON THAT ANY STUDENT SHOULD HAVE TO READ OR UNDERSTAND
THE CODE BELOW.  YOU SHOLD NOT TOUCH, OR REFERENCE (in your code) ANY
OF THE DATA STRUCTURES BELOW.  If you're interested in how I designed
the emulator, you're welcome to look at the code - but again, you should have
to, and you defeinitely should not have to modify
******************************************************************/

struct event {
    float evtime;       /* event time */
    int evtype;     /* event type code */
    int eventity;       /* entity where event occurs */
    struct pkt *pktptr; /* ptr to packet (if any) assoc w/ this event */
    struct event *prev;
    struct event *next;
};
struct event *evlist = NULL;    /* the event list */

/* possible events: */
#define  TIMER_INTERRUPT 0
#define  FROM_LAYER5     1
#define  FROM_LAYER3     2

#define  OFF             0
#define  ON              1
#define   A    0
#define   B    1

int TRACE = 1;          /* for my debugging */
int nsim = 0;           /* number of messages from 5 to 4 so far */
int nsimmax = 0;        /* number of msgs to generate, then stop */
float time = 0.000;
float lossprob;         /* probability that a packet is dropped  */
float corruptprob;      /* probability that one bit is packet is flipped */
float lambda;           /* arrival rate of messages from layer 5 */
int ntolayer3;          /* number sent into layer 3 */
int nlost;          /* number lost in media */
int ncorrupt;           /* number corrupted by media */

main()
{
    struct event *eventptr;
    struct msg msg2give;
    struct pkt pkt2give;

    int i, j;
    char c;

    init();
    A_init();
    B_init();

    while (1) {
        eventptr = evlist;  /* get next event to simulate */
        if (eventptr == NULL)
            goto terminate;
        evlist = evlist->next;  /* remove this event from event list */
        if (evlist != NULL)
            evlist->prev = NULL;
        if (TRACE >= 2) {
            printf("\nEVENT time: %f,", eventptr->evtime);
            printf("  type: %d", eventptr->evtype);
            if (eventptr->evtype == 0)
                printf(", timerinterrupt  ");
            else if (eventptr->evtype == 1)
                printf(", fromlayer5 ");
            else
                printf(", fromlayer3 ");
            printf(" entity: %d\n", eventptr->eventity);
        }
        time = eventptr->evtime;    /* update time to next event time */
        if (nsim == nsimmax)
            break;  /* all done with simulation */
        if (eventptr->evtype == FROM_LAYER5) {
            generate_next_arrival();    /* set up future arrival */
            /* fill in msg to give with string of same letter */
            j = nsim % 26;
            for (i = 0; i < 20; i++)
                msg2give.data[i] = 97 + j;
            if (TRACE > 2) {
                printf
                    ("          MAINLOOP: data given to student: ");
                for (i = 0; i < 20; i++)
                    printf("%c", msg2give.data[i]);
                printf("\n");
            }
            nsim++;
            if (eventptr->eventity == A)
                A_output(msg2give);
            else
                B_output(msg2give);
        } else if (eventptr->evtype == FROM_LAYER3) {
            pkt2give.seqnum = eventptr->pktptr->seqnum;
            pkt2give.acknum = eventptr->pktptr->acknum;
            pkt2give.checksum = eventptr->pktptr->checksum;
            for (i = 0; i < 20; i++)
                pkt2give.payload[i] =
                    eventptr->pktptr->payload[i];
            if (eventptr->eventity == A)    /* deliver packet by calling */
                A_input(pkt2give);  /* appropriate entity */
            else
                B_input(pkt2give);
            free(eventptr->pktptr); /* free the memory for packet */
        } else if (eventptr->evtype == TIMER_INTERRUPT) {
            if (eventptr->eventity == A)
                A_timerinterrupt();
            else
                B_timerinterrupt();
        } else {
            printf("INTERNAL PANIC: unknown event type \n");
        }
        free(eventptr);
    }

terminate:
    printf
        (" Simulator terminated at time %f\n after sending %d msgs from layer5\n",
         time, nsim);
}

init()
{               /* initialize the simulator */
    int i;
    float sum, avg;
    float jimsrand();

    printf
        ("-----  Stop and Wait Network Simulator Version 1.1 -------- \n\n");
    printf("Enter the number of messages to simulate: ");
    scanf("%d", &nsimmax);
    printf("Enter  packet loss probability [enter 0.0 for no loss]:");
    scanf("%f", &lossprob);
    printf("Enter packet corruption probability [0.0 for no corruption]:");
    scanf("%f", &corruptprob);
    printf
        ("Enter average time between messages from sender's layer5 [ > 0.0]:");
    scanf("%f", &lambda);
    printf("Enter TRACE:");
    scanf("%d", &TRACE);

    srand(9999);        /* init random number generator */
    sum = 0.0;      /* test random number generator for students */
    for (i = 0; i < 1000; i++)
        sum = sum + jimsrand(); /* jimsrand() should be uniform in [0,1] */
    avg = sum / 1000.0;
    if (avg < 0.25 || avg > 0.75) {
        printf
            ("It is likely that random number generation on your machine\n");
        printf
            ("is different from what this emulator expects.  Please take\n");
        printf
            ("a look at the routine jimsrand() in the emulator code. Sorry. \n");
        exit(1);
    }

    ntolayer3 = 0;
    nlost = 0;
    ncorrupt = 0;

    time = 0.0;     /* initialize time to 0.0 */
    generate_next_arrival();    /* initialize event list */
}

/****************************************************************************/
/* jimsrand(): return a float in range [0,1].  The routine below is used to */
/* isolate all random number generation in one location.  We assume that the*/
/* system-supplied rand() function return an int in therange [0,mmm]        */
/****************************************************************************/
float jimsrand()
{
    double mmm = 2147483647;    /* largest int  - MACHINE DEPENDENT!!!!!!!!   */
    float x;        /* individual students may need to change mmm */
    x = rand() / mmm;   /* x should be uniform in [0,1] */
    return (x);
}

/********************* EVENT HANDLINE ROUTINES *******/
/*  The next set of routines handle the event list   */
/*****************************************************/

generate_next_arrival()
{
    double x, log(), ceil();
    struct event *evptr;
    char *malloc();
    float ttime;
    int tempint;

    if (TRACE > 2)
        printf
            ("          GENERATE NEXT ARRIVAL: creating new arrival\n");

    x = lambda * jimsrand() * 2;    /* x is uniform on [0,2*lambda] */
    /* having mean of lambda        */
    evptr = (struct event *)malloc(sizeof(struct event));
    evptr->evtime = time + x;
    evptr->evtype = FROM_LAYER5;
    if (BIDIRECTIONAL && (jimsrand() > 0.5))
        evptr->eventity = B;
    else
        evptr->eventity = A;
    insertevent(evptr);
}

insertevent(p)
struct event *p;
{
    struct event *q, *qold;

    if (TRACE > 2) {
        printf("            INSERTEVENT: time is %lf\n", time);
        printf("            INSERTEVENT: future time will be %lf\n",
               p->evtime);
    }
    q = evlist;     /* q points to header of list in which p struct inserted */
    if (q == NULL) {    /* list is empty */
        evlist = p;
        p->next = NULL;
        p->prev = NULL;
    } else {
        for (qold = q; q != NULL && p->evtime > q->evtime; q = q->next)
            qold = q;
        if (q == NULL) {    /* end of list */
            qold->next = p;
            p->prev = qold;
            p->next = NULL;
        } else if (q == evlist) {   /* front of list */
            p->next = evlist;
            p->prev = NULL;
            p->next->prev = p;
            evlist = p;
        } else {    /* middle of list */
            p->next = q;
            p->prev = q->prev;
            q->prev->next = p;
            q->prev = p;
        }
    }
}

printevlist()
{
    struct event *q;
    int i;
    printf("--------------\nEvent List Follows:\n");
    for (q = evlist; q != NULL; q = q->next) {
        printf("Event time: %f, type: %d entity: %d\n", q->evtime,
               q->evtype, q->eventity);
    }
    printf("--------------\n");
}

/********************** Student-callable ROUTINES ***********************/

/* called by students routine to cancel a previously-started timer */
stoptimer(AorB)
int AorB;           /* A or B is trying to stop timer */
{
    struct event *q, *qold;

    if (TRACE > 2)
        printf("          STOP TIMER: stopping timer at %f\n", time);
    /* for (q=evlist; q!=NULL && q->next!=NULL; q = q->next)  */
    for (q = evlist; q != NULL; q = q->next)
        if ((q->evtype == TIMER_INTERRUPT && q->eventity == AorB)) {
            /* remove this event */
            if (q->next == NULL && q->prev == NULL)
                evlist = NULL;  /* remove first and only event on list */
            else if (q->next == NULL)   /* end of list - there is one in front */
                q->prev->next = NULL;
            else if (q == evlist) { /* front of list - there must be event after */
                q->next->prev = NULL;
                evlist = q->next;
            } else {    /* middle of list */
                q->next->prev = q->prev;
                q->prev->next = q->next;
            }
            free(q);
            return;
        }
    printf("Warning: unable to cancel your timer. It wasn't running.\n");
}

starttimer(AorB, increment)
int AorB;           /* A or B is trying to stop timer */
float increment;
{

    struct event *q;
    struct event *evptr;
    char *malloc();

    if (TRACE > 2)
        printf("          START TIMER: starting timer at %f\n", time);
    /* be nice: check to see if timer is already started, if so, then  warn */
    /* for (q=evlist; q!=NULL && q->next!=NULL; q = q->next)  */
    for (q = evlist; q != NULL; q = q->next)
        if ((q->evtype == TIMER_INTERRUPT && q->eventity == AorB)) {
            printf
                ("Warning: attempt to start a timer that is already started\n");
            return;
        }

    /* create future event for when timer goes off */
    evptr = (struct event *)malloc(sizeof(struct event));
    evptr->evtime = time + increment;
    evptr->evtype = TIMER_INTERRUPT;
    evptr->eventity = AorB;
    insertevent(evptr);
}

/************************** TOLAYER3 ***************/
tolayer3(AorB, packet)
int AorB;           /* A or B is trying to stop timer */
struct pkt packet;
{
    struct pkt *mypktptr;
    struct event *evptr, *q;
    char *malloc();
    float lastime, x, jimsrand();
    int i;

    ntolayer3++;

    /* simulate losses: */
    if (jimsrand() < lossprob) {
        nlost++;
        if (TRACE > 0)
            printf("          TOLAYER3: packet being lost\n");
        return;
    }

    /* make a copy of the packet student just gave me since he/she may decide */
    /* to do something with the packet after we return back to him/her */
    mypktptr = (struct pkt *)malloc(sizeof(struct pkt));
    mypktptr->seqnum = packet.seqnum;
    mypktptr->acknum = packet.acknum;
    mypktptr->checksum = packet.checksum;
    for (i = 0; i < 20; i++)
        mypktptr->payload[i] = packet.payload[i];
    if (TRACE > 2) {
        printf("          TOLAYER3: seq: %d, ack %d, check: %d ",
               mypktptr->seqnum, mypktptr->acknum, mypktptr->checksum);
        for (i = 0; i < 20; i++)
            printf("%c", mypktptr->payload[i]);
        printf("\n");
    }

    /* create future event for arrival of packet at the other side */
    evptr = (struct event *)malloc(sizeof(struct event));
    evptr->evtype = FROM_LAYER3;    /* packet will pop out from layer3 */
    evptr->eventity = (AorB + 1) % 2;   /* event occurs at other entity */
    evptr->pktptr = mypktptr;   /* save ptr to my copy of packet */
    /* finally, compute the arrival time of packet at the other end.
    medium can not reorder, so make sure packet arrives between 1 and 10
    time units after the latest arrival time of packets
    currently in the medium on their way to the destination */
    lastime = time;
    /* for (q=evlist; q!=NULL && q->next!=NULL; q = q->next) */
    for (q = evlist; q != NULL; q = q->next)
        if ((q->evtype == FROM_LAYER3
             && q->eventity == evptr->eventity))
            lastime = q->evtime;
    evptr->evtime = lastime + 1 + 9 * jimsrand();

    /* simulate corruption: */
    if (jimsrand() < corruptprob) {
        ncorrupt++;
        if ((x = jimsrand()) < .75)
            mypktptr->payload[0] = 'Z'; /* corrupt payload */
        else if (x < .875)
            mypktptr->seqnum = 999999;
        else
            mypktptr->acknum = 999999;
        if (TRACE > 0)
            printf("          TOLAYER3: packet being corrupted\n");
    }

    if (TRACE > 2)
        printf
            ("          TOLAYER3: scheduling arrival on other side\n");
    insertevent(evptr);
}

tolayer5(AorB, datasent)
int AorB;
char datasent[20];
{
    int i;
    if (TRACE > 2) {
        printf("          TOLAYER5: data received: ");
        for (i = 0; i < 20; i++)
            printf("%c", datasent[i]);
        printf("\n");
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-10-25T18:30:25.047

您的 starttimer() 参数是 int，并且*float*所以 20.0 而不是 20。由于某种原因，模拟器在将 int 作为 float 传递时会中断。

# iphone - 运行我的应用程序时手机发热

> ID：10201725
> 
> 赞同：6
> 
> 时间：2012-04-18T01:51:37.263
> 
> 标签：iphone, ios, device

当我使用我的应用程序一段时间后，我注意到设备变热了。苹果设备在运行应用程序时通常会变热，所以我想知道是否有一种方法可以检查我的应用程序是否做错了什么。

我认为 Instruments 中的分配工具不能帮助我诊断问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T01:54:03.273

Instruments 绝对可以帮助您解决这个问题。密集的 CPU 活动直接导致您的设备变热，Instruments 可以跟踪并向您显示您的 CPU 使用率和内存分配。

# ruby-on-rails - 如何在一项 rake 任务中删除测试和开发数据库？

> ID：10201729
> 
> 赞同：4
> 
> 时间：2012-04-18T01:52:17.090
> 
> 标签：ruby-on-rails, ruby-on-rails-3.1

我试图从一个 rake 任务中删除测试和开发数据库，​​如下所示：

```
task :regenerate do
  Rails.env = "test"
  Rake::Task["db:drop"].invoke
  Rails.env = "development"
  Rake::Task["db:drop"].invoke
end 
```

测试数据库已成功删除。但是开发数据库并没有被删除。

关于如何使这项工作的任何想法？

注意：这是在 Rails 3.2.3 上

**更新：**

很奇怪，但颠倒顺序有效：

```
task :regenerate do
  Rails.env = "development"
  Rake::Task["db:drop"].invoke
  Rails.env = "test"
  Rake::Task["db:drop"].invoke
end 
```

到底是怎么回事？！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T05:07:12.300

你可以这样写：

```
namespace :db do
  desc "Database custom drop"
  task :mydrop do
    system("rake db:drop RAILS_ENV=test")
    system("rake db:drop RAILS_ENV=development")
  end
end 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-11-19T17:46:22.940

反转它确实有效，因为有一些奇怪的代码`database_tasks.rb`：

```
 def each_current_configuration(environment)
    environments = [environment]
    environments << 'test' if environment == 'development'

    configurations = ActiveRecord::Base.configurations.values_at(*environments)
    configurations.compact.each do |configuration|
      yield configuration unless configuration['database'].blank?
    end
  end 
```

`test`如果 env 是，它总是添加`development`。我解决了想要同时执行自定义`db:rebuild`任务`development`并`test`通过`development`先运行和`test`第二运行的情况。此外，在运行任务之前，我调用了`set_env`确保设置的方法`ActiveRecord::Tasks::DatabaseTasks.env`，如果没有这个，数据库连接似乎不会像预期的那样针对环境进行离散处理。我尝试了所有其他类型的断开连接等，但这无需进一步的代码即可工作。

```
def set_env(env)
  Rails.env = env.to_s
  ENV['RAILS_ENV'] = env.to_s
  ActiveRecord::Tasks::DatabaseTasks.env = env.to_s
end 
```

* * *

[这是我的完整`db.rake`文件的要点，其中包含同时多环境`db:rebuild`和`db:truncate`](https://gist.github.com/rosskevin/7549349)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-17T02:44:15.067

在我使用 Ruby 2 和 Rails 3.2.13 的系统上，我可以运行 rake db:drop

这会同时删除测试和开发数据库。现在比搞乱 rake 任务容易得多

# django - Markdown Python：为什么前面有回车 在降价产生的列表中？

> ID：10201731
> 
> 赞同：0
> 
> 时间：2012-04-18T01:52:48.407
> 
> 标签：django, markdown

我正在使用 python markdown 2.1.1。当我尝试对列表进行降价时，为什么之前有回车

在列表中？例如，

```
text = u" - this is a paragraph\r\n\r\n - this is a line\r\n"
markdown.markdown(text)
# produces: u'<ul>\n<li>\n<p>this is a paragraph</p>\n</li>\n<li>\n<p>this is a line</p>\n</li>\n</ul>' 
```

根据[Markdown 语法](http://daringfireball.net/projects/markdown/syntax#list)，预期的输出应该是

```
u'<ul>\n<li><p>this is a paragraph</p></li>\n<li>\n<p>this is a line</p>\n</li>\n</ul>' 
```

没有元素`\n`之前和之后，对吧？`<p>`这使得页面非常难看，因为我正在使用 设置块的样式`white-space: pre-line`，所以输出看起来像

```
- 
   this is a paragraph

-  this is a line 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T02:45:00.427

Markdown 不完全遵守语法。使用通常表现更好的[markdown2 。](http://pypi.python.org/pypi/markdown2)

```
>>> import markdown2
>>> print markdown2.markdown(u" - this is a paragraph\r\n\r\n - this is a line\r\n")
<ul>
<li><p>this is a paragraph</p></li>
<li><p>this is a line</p></li>
</ul>

# using fenced-code-blocks
>>> print markdown2.markdown('\n\n```python\nprint('Hello')\n```', extras=['fenced-code-blocks'])
<div class="codehilite"><pre><code><span class="k">print</span><span class="p">(</span><span class="s">&quot;Hello&quot;</span><span class="p">)</span>
</code></pre></div> 
```

*注意*，你需要`'\n'`在第一个之前写两个`````来启用[fenced-code-blocks 的正则表达式匹配](https://github.com/trentm/python-markdown2/blob/master/lib/markdown2.py#L1513)。

# c++ - C++，浮点到整数转换

> ID：10201735
> 
> 赞同：1
> 
> 时间：2012-04-18T01:53:20.123
> 
> 标签：c++, types, casting

只是想弄清楚下面的这些案例：

```
#define MAP_CELL_SIZE_MIN 0.1f

float mMapHeight = 256;
float mScrHeight = 320;

int mNumRowMax; 
```

情况1：

```
mNumRowMax = mMapHeight/( MAP_CELL_SIZE_MIN * mScrHeight ); 
```

`mNumRowMax`现在是 7，但实际上它必须是 8 ( 256/32 )，如果我将定义更改`MAP_CELL_SIZE_MIN`为只有`0.1`那么它才成立，`mNumRowMax`是 8，那么有什么问题`'f'`

案例2：

```
float tmp = mMapHeight/( MAP_CELL_SIZE_MIN * mScrHeight );//tmp = 8.0
mNumRowMax = tmp; 
```

`mNumRowMax`现在是 8，所以任何人都可以帮助我理解第一个案例的问题是什么时候`mNumRowMax`是 7

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T12:56:19.960

发生的事情是

## 5 [表达式]

> 10 浮动操作数的值和浮动表达式的结果可以用比类型要求更高的精度和范围来表示；类型不会因此而改变。^(55))
> 
> ^(55))强制转换和赋值运算符仍必须按照 5.4、5.2.9 和 5.17 中的描述执行它们的特定转换。

（C++03；C99 中的 6.3.1.8(2) 和 C11 的 n1570 草案几乎相同；我相信 C++11 中的要点是相同的。）

在下文中，我假设一个类似于 IEEE-754 的二进制浮点表示。

在分数十六进制表示法中，

```
1/10 = 1/2 * 3/15
     = 1/2 * 0.33333333333...
     = 2^(-4) * 1.999999999... 
```

所以当它被四舍五入到`b`精度时，你会得到

```
2^(-4) * 1.99...9a   // if b ≡ 0 (mod 4) or b ≡ 1 (mod 4)
2^(-4) * 1.99...98   // if b ≡ 2 (mod 4) or b ≡ 3 (mod 4) 
```

其中小数部分的最后一个十六进制数字分别在 3、4、1、2 个最高有效位之后被截断。

现在`320 = 2^6*(2^2 + 1)`，所以`r * 320`where的结果`r`被`0.1`四舍五入`b`到位，是全精度（忽略 2 的幂），

```
 6.66...68
 + 1.99...9a
 -----------
   8.00...02 
```

与`b+3`位`b ≡ 0 (mod 4)`或`b ≡ 1 (mod 4)`和

```
 6.66...60
 + 1.99...98
 -----------
   7.ff...f8 
```

与`b+2`位`b ≡ 2 (mod 4)`或`b ≡ 3 (mod 4)`。

在每种情况下，将结果四舍五入到`b`精确位会产生 32，然后您将得到`256/32 = 8`最终结果。但如果使用精度更高的中间结果，则计算结果为

```
256/(0.1 * 320) 
```

略小于或大于 8。

对于具有 24 (23+1) 位精度的典型 32 位`float`，如果中间结果以至少 53 位的精度表示：

```
0.1f = 1.99999ap-4
0.1f * 320 = 32*(1 + 2^(-26))
256/(0.1f * 320) = 8/(1 + 2^(-26)) = 8 * (1 - 2^(-26) + 2^(-52) - ...) 
```

在情况 1 中，结果直接`int`从中间结果转换为¹。由于中间结果略小于 8，因此它被截断为 7。

在情况 2 中，中间结果`float`在转换为 之前存储在 a 中`int`，因此它首先被舍入到 24 位精度，结果正好是 8。

现在如果你去掉`f`后缀, `0.1`is a `double`(大概有 53 位精度), 这两个`float`s 被提升为`double`计算, 和

```
0.1 = 1.999999999999ap-4
0.1 * 320 = 32*(1 + 2^(-55))
256/(0.1 * 320) = 8 * (1 - 2^(-55) + 2^(-110) - ...) 
```

如果计算已经`double`精确执行。`1 + 2^(-55) == 1``0.1 * 320 == 32`

如果以 64 位或更高的精度（想想 x87）以扩展精度执行计算，则字面量可能`0.1`根本没有转换为`double`精度并直接与扩展精度一起使用，这再次导致乘法`0.1 * 320`导致正好 32。

如果文字`0.1`以精度使用但计算以更高的精度执行，则如果中间结果直接从具有更高精度的表示中`double`截断为 7，它将再次产生 7，如果在转换为.`int``int`

（除此之外：gcc/g++ 4.5.1 在所有情况下都会产生 8，无论优化级别如何，在我的 64 位机器上，我还没有在 32 位机器上尝试过。）

¹我不完全确定，但我认为这违反了标准，它应该首先删除多余的精度。有语言律师吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T01:59:38.673

当浮点数转换为整数时，该值被*截断*而不是*四舍五入*，即所有小数都被“截断”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T02:00:52.357

看来您遇到了舍入错误。

一个简单的解决方法可能是使用 double 而不是 float。

如果这不是一个选项，那么您可能需要四舍五入到整数。例如，如果您有一个浮点值 f，请执行以下操作`int x = (int)(f + 0.5);`

# android - 跨越边界的重叠视图（假操作栏）

> ID：10201736
> 
> 赞同：1
> 
> 时间：2012-04-18T01:53:28.173
> 
> 标签：android, view, android-actionbar, overlap, boundary

我正在尝试为 Android 2.1 创建一个自定义标题栏，它在某种程度上模拟了 Android 3.0 及更高版本中的 ActionBar。

到目前为止，我的运气还算不错，但是我找不到一种简单的方法来制作可以显示在 ActionBar 中图标/按钮下方的下拉列表。

我希望这些下拉列表能够跨越标题布局和内容布局之间的边界而不会被剪裁/截断。我还希望下拉列表相对位于 ActionBar 中的图标/按钮下方。我已经看到了使用 FrameLayouts 和 RelativeLayouts 的建议，但这些似乎并没有解决我的特定问题（除非我看错了）。我一直认为这一定是可能的，因为我相信较新版本的 Android 完全支持这种类型的行为。

这是我试图用一些笔记完成的截图。 [http://img217.imageshack.us/img217/3279/67343249.png](http://img217.imageshack.us/img217/3279/67343249.png)

请帮忙。谢谢！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T02:02:06.990

您需要使用[FrameLayout](http://developer.android.com/reference/android/widget/FrameLayout.html)保存您的内容。FrameLayout 可以容纳多个孩子，并且允许它们相互重叠。

可能的布局 xml 可能如下所示：

```
<FrameLayout>
    <LinearLayout android:margin_top="30dip">...</LinearLayout>
    <CustomActionBar />
</FrameLayout> 
```

这`30dip`只是您的 ActionBar 的高度，您可能希望在`values`. 您可以将 LienarLayout 替换为仅用于保存应用程序中其他内容的任何内容。

PS。我不确定 FrameLayout 是先渲染还是最后渲染第一个孩子。如果您发现线性布局的内容与 customactionbar 重叠，请交换它们的位置。

=== 编辑 ===

为了使代码更干净，可以这样做：

```
<CustomActionBar>
    <LinearLayout/>
</CustomActionBar> 
```

它将自定义操作栏替换为使用操作栏的任何 xml 布局的“根”元素。在进行自定义操作栏时，您需要将其从 扩展`FrameLayout`，并相应地分配子级的边距。这个想法与我上面提出的想法非常相似。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T06:49:37.293

我认为最好的方法是创建一个线性布局并将下拉列表项添加到该线性布局中。然后在按钮单击时添加线性布局，并使用相对布局布局参数将其显示在按钮下方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T01:26:07.033

经过几天的研究，我发现实现这一点的最佳方法是使用带有自定义主题的自定义对话框，其中包含 listView。当用户单击按钮时，对话框应直接显示在按钮下方。这提供了良好的用户体验，也意味着您不必完全改变您的基本布局结构来适应此功能。（这与 ActionBar Sherlocke 用于向后兼容菜单的方法基本相同）

这是我正在描述的代码片段（这是用 C# 编写的，使用 Mono for Android，但应该很容易翻译成 Java）：

```
Dialog dlgHome = new Dialog(this, Resource.Style.ActionBarMenu);
dlgHome.SetCanceledOnTouchOutside(true);
dlgHome.SetContentView(Resource.Layout.ActionBarMenu);
ListView lsvHome = (ListView)dlgHome.FindViewById(Resource.Id.lsvHome);
lsvHome.Adapter = new ArrayAdapter<string>(this, Resource.Layout.ActionBarMenuItem, new string[] { "Add Activity", "Edit Log", "Program Details" });

Rect r = new Rect();
btnHome.GetLocalVisibleRect(r);
int x = r.Left + (int)TypedValue.ApplyDimension(ComplexUnitType.Dip, 5, Resources.DisplayMetrics);
int y = r.Bottom;

WindowManagerLayoutParams param = dlgHome.Window.Attributes;
param.Gravity = (int)(GravityFlags.Top | GravityFlags.Left);
param.X = x;
param.Y = y;
dlgHome.Window.Attributes = param; 
```

此外，这里是样式 xml（在 style.xml 中）

```
<style name="ActionBarMenu" parent="android:Theme.Dialog">
<item name="android:windowBackground">@color/actionbar_menu_bg</item>
<item name="android:windowNoTitle">true</item>
<item name="android:backgroundDimEnabled">false</item>
</style> 
```

# java - 目标的Maven默认阶段？

> ID：10201739
> 
> 赞同：5
> 
> 时间：2012-04-18T01:53:44.243
> 
> 标签：java, maven

据我了解，在 Maven 中，插件目标可以附加到生命周期阶段。如果未定义，默认阶段是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T02:49:44.997

以我的经验，这取决于插件目标。例如，maven-assembly-plugin 中的[assembly:single](http://maven.apache.org/plugins/maven-assembly-plugin/single-mojo.html)目标没有列出默认阶段。source : [jar-no-fork](http://maven.apache.org/plugins/maven-source-plugin/jar-no-fork-mojo.html)目标默认绑定到`package`阶段。**通常，每个目标都会在文档的“属性**”部分列出默认阶段。

另一种判断方法是查看源代码（例如：[source:jar-no-fork mojo](http://svn.apache.org/viewvc/maven/plugins/tags/maven-source-plugin-2.1.2/src/main/java/org/apache/maven/plugin/source/SourceJarNoForkMojo.java?revision=945370&view=markup)）。`@phase`在类头注释块中查找。

最后但同样重要的是：您选择的包装（jar、war、ear、pom 等）默认将目标绑定到生命周期阶段。Maven 书描述了[生命周期和绑定目标](http://www.sonatype.com/books/mvnref-book/reference/lifecycle-sect-package-specific.html)。该`maven-core`工件包括配置文件：[`/src/main/resources/META-INF/plexus/artifact-handlers.xml`](http://svn.apache.org/viewvc/maven/maven-3/trunk/maven-core/src/main/resources/META-INF/plexus/artifact-handlers.xml?revision=1244153&view=markup).

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T02:09:17.333

如果我正确阅读[http://maven.apache.org/guides/mini/guide-configuring-plugins.html](http://maven.apache.org/guides/mini/guide-configuring-plugins.html)，则没有默认值。如果您没有定义默认阶段或配置非默认阶段，那么目标将不会被执行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-18T07:22:57.080

目标的默认阶段取决于您使用的插件。例如[appassembler-maven-plugin](http://mojo.codehaus.org/appassembler/appassembler-maven-plugin/assemble-mojo.html)绑定到包阶段。但是还有其他插件不受任何阶段的约束。在这些情况下，您必须自己定义阶段。

# php - 如何从 MySQL 日期输出星期几

> ID：10201742
> 
> 赞同：3
> 
> 时间：2012-04-18T01:53:47.143
> 
> 标签：php, mysql

我无法找到或弄清楚如何将 MySQL 日期字段输出为缩写的星期几。

我不确定是否在 MySQL 或 PHP 中执行此操作。

理想情况下，我想使用 PHP 函数来执行此操作，但更复杂的是，我想作为星期几输出的日期字段正在通过 while 循环运行到表中。这让我觉得我需要在 MySQL 中做这件事。

基本上，我希望能够使用 PHP 的 mktime() 或 MySQL 的 DAYOFWEEK() 之类的东西，除非因为我需要能够在 while 循环中执行此操作，所以我需要能够在功能，而不必输入或提取一个特定的日期进行格式化。

任何帮助是极大的赞赏！

PS 我在下面添加了数据当前来自数据库的方式。### 是我遇到麻烦的地方；这是我需要使用“e_date”列来回显这一天的地方。（下一个日期也使用“e_date”列。）

```
// Get all the data from the "events" table
            $result = mysql_query("
            SELECT *
            FROM events
            WHERE e_type != '' && e_date >= CURDATE() && e_date <= (CURDATE() + 15)
            ORDER BY e_date,e_ampm,e_time") 
            or die(mysql_error());  

            echo "<table border='1' style=\"border:none;font-size:12px;\">";
            echo "<tr> <th>Day</th> <th>Date</th> <th>Time</th> <th>Type</th> <th>Description</th> </tr>";
            // keeps getting the next row until there are no more to get
            while($row = mysql_fetch_array( $result )) {
                // Print out the contents of each row into a table
                echo "<tr><td>";
                ###
                echo "</td><td>";
                echo $row['e_date'];
                echo "</td><td>";
                echo $row['e_time'];
                echo $row['e_ampm'];
                echo "</td><td>";
                echo $row['e_type'];
                echo "</td><td>";
                echo $row['e_name'];
                echo "</td></tr>"; 
            } 

            echo "</table>"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T02:18:09.560

试试这个修改后的版本。您可以使用 DATE_FORMAT，使用日期字段作为输入变量，%a 表示输出的格式。%a 告诉 DATE_FORMAT 返回日期的缩写日期。试一试，看看它是否有效，我有一段时间没有使用 MySQL，所以我可能是错的。

```
// Get all the data from the "events" table
        $result = mysql_query("
        SELECT DATE_FORMAT(e_date, '%a') as day, e_date, e_time, e_ampm, e_type,e_name
        FROM events
        WHERE e_type != '' && e_date >= CURDATE() && e_date <= (CURDATE() + 15)
        ORDER BY e_date,e_ampm,e_time") 
        or die(mysql_error());  

        echo "<table border='1' style=\"border:none;font-size:12px;\">";
        echo "<tr> <th>Day</th> <th>Date</th> <th>Time</th> <th>Type</th>    <th>Description</th> </tr>";
        // keeps getting the next row until there are no more to get
        while($row = mysql_fetch_array( $result )) {
            // Print out the contents of each row into a table
            echo "<tr><td>";
            echo $row['day'];
            echo "</td><td>";
            echo $row['e_date'];
            echo "</td><td>";
            echo $row['e_time'];
            echo $row['e_ampm'];
            echo "</td><td>";
            echo $row['e_type'];
            echo "</td><td>";
            echo $row['e_name'];
            echo "</td></tr>"; 
        } 

        echo "</table>"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T01:56:22.887

我会保留数据库部分来处理数据，并呈现给 PHP。您想要使用`strftime()`或`strptime()`取决于您的数据是如何从 MySQL 中出来的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T02:48:16.880

我的建议总是以 unixtime 格式处理日期。我总是将日期作为整数字段存储在数据库中。

对于您的情况，您可以通过将日期字段转换为 unixtime 来查询日期字段，并让 php date 函数来处理格式。

```
<?php

$query = "
SELECT UNIX_TIMESTAMP(e_date) AS UNIXTIME, *
FROM events
WHERE e_type != '' && e_date >= CURDATE() && e_date <= (CURDATE() + 15)
ORDER BY e_date,e_ampm,e_time";

$result = mysql_query($query) or die("error");
...

while($row = mysql_fetch_array( $result ))
{
    echo "<tr>";
    echo sprintf('<td>%s</td>', date('l', $row["UNIXTIME"])); //day of week
    ...
    echo "</tr>";
}

?> 
```

# linux - 使用 -lpthread 标志时对“pthread_init”的未定义引用：

> ID：10201743
> 
> 赞同：3
> 
> 时间：2012-04-18T01:53:59.243
> 
> 标签：linux, gcc, pthreads

我正在编译使用：

`gcc -o outfile infile.c -lpthread`

唯一未定义的引用是`pthread_init`.

根据网上的一些建议，我尝试过使用`-pthread`而不是。`-lpthread`

我包括**_**`<pthread.h>`

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T02:02:09.560

不要打电话`pthread_init()`。在 Linux 上没有必要。

# blackberry - 指示最低黑莓版本

> ID：10201748
> 
> 赞同：0
> 
> 时间：2012-04-18T01:54:31.583
> 
> 标签：blackberry

如何指示允许我的应用程序运行的最低编译版本？说 OS 5.0 作为最低要求。

我将 Java 与 Eclipse 工具一起使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T05:07:56.640

正如 Remy 所说，您的应用程序支持的最低操作系统版本取决于您用于开发的 Blackberry SDK 版本。

如果您计划通过[Blackberry App World](https://appworld.blackberry.com/isvportal/login_input.do?pageId=0)提供您的应用程序，该平台允许您选择允许下载您的产品的操作系统版本、运营商甚至特定型号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T04:44:47.507

最低操作系统版本由您编译时使用的 BlackBerry JRE 版本决定。如果您安装了多个 JRE 版本，则可以在项目的属性中选择特定版本，在本例中为 5.0 JRE。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T07:59:29.597

Actually, the minimum OS version you can install your app is determined by the tag `fileset` in your .alx file. Example:

```
<fileset Java="1.54" _blackberryVersion="[4.5.0)"> 
```

The important info here is the `Java` attribute, the `_blackberryVersion` is only generated by newer plugin versions.

So you can compile a .cod file for let's say 5.0, and install it on 4.5 tweaking that element in the alx file. The alx is only used for BES and cable installs. You can also use JavaLoader and install the cod without caring about OS versions (no alx or jad file needed).

WARNING: The fact that you can install a "wrong" cod on a BlackBerry OS version it is not intended for doesn't mean you can run it without exceptions. If your app uses an API not present in your OS, it will crash.

Of course, the BB plugin generates the correct alx for the selected target OS, but you can bypass it by manually editing the alx if you wish. For OTA installs, the jad file doesn't contain any minimum version info AFAIK, but if it did, you could edit it as well.

# php - 如何告诉 CodeIgniter ActiveRecord 不要逃避我的插入和更新查询？

> ID：10201749
> 
> 赞同：4
> 
> 时间：2012-04-18T01:54:50.963
> 
> 标签：php, codeigniter, activerecord, codeigniter-2

我需要将一些我信任的 xml（我写的）发送到我的 mysql 数据库。

ActiveRecord 转义了我的很多 XML。当我将它从数据库中提取出来时，我没有使用 CodeIgniter，因此我需要在数据库中使用干净的 XML。

提前致谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-18T02:24:57.317

读取活动记录中[设置的功能。](http://codeigniter.com/user_guide/database/active_record.html)以下是文档中的片段。

> 此功能使您能够设置插入或更新的值。set() 还将接受一个可选的第三个参数 ($escape)，如果设置为 FALSE，它将防止数据被转义。为了说明区别，这里使用了 set() ，有和没有转义参数。

```
$this->db->set('field', 'field+1', FALSE);
$this->db->insert('mytable');
// gives INSERT INTO mytable (field) VALUES (field+1)

$this->db->set('field', 'field+1');
$this->db->insert('mytable');
// gives INSERT INTO mytable (field) VALUES ('field+1') 
```

# c - 在 ncurses 框中滚动内容

> ID：10201757
> 
> 赞同：4
> 
> 时间：2012-04-18T01:55:32.677
> 
> 标签：c, client-server, ncurses, curses

我有一个窗口（用`newwin`）和创建框（`box (WINDOW *, int, int)`）。

我在盒子下读写（在 FD 0 和 1 上），我`(char *)`从一个套接字中得到一个，我在盒子里写了这个标签。

当我写了 195 行时，我到达了盒子的尽头。

如何滚动现有文本，以便在底部打印新文本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T02:21:07.480

使用该`scrollok(WINDOW *win, bool bf);`功能。

```
scrollok(win, TRUE); 
```

从手册页：

> scrollok 选项控制当窗口的光标移出窗口边缘或滚动区域时发生的情况，无论是由于底行上的换行操作，还是键入最后一行的最后一个字符。如果禁用，（bf 为 FALSE），光标将留在底行。如果启用，（bf 为 TRUE），窗口向上滚动一行（注意，要在终端上获得物理滚动效果，还需要调用 idlok）。

* * *

顺便说一句，我在`c`使用`ncurses`（[pic](http://i.imgur.com/hIJLI.png)）时为 irc 客户端编写了一个非常简单的接口，它并不完整，但您可能想查看提示 -[代码](https://github.com/c00kiemon5ter/niii/blob/master/niii.c)。

# solr - 提升日期较新的项目的正确方法是什么？

> ID：10201760
> 
> 赞同：1
> 
> 时间：2012-04-18T01:55:57.173
> 
> 标签：solr, full-text-search, morelikethis

我有一个更像这个查询的查询，我想先更新它以返回较新的文档。根据文档，我需要添加`recip(ms(NOW,mydatefield),3.16e-11,1,1)`到我的查询中。

但是当我尝试将它添加到 mlt.qf 或 bf 参数中时。结果保持完全相同。

这是我的查询：

> /solr/mlt?
> 
> q=id:cms.article.137861
> 
> &defType=edismax
> 
> &rows=3
> 
> &缩进=打开
> 
> &mlt.fl=series_id,标签,标题,文本
> 
> &mlt.qf=show_id 文本^1.1 标题^1.1 标签^90
> 
> &wt=json
> 
> &fl=url,标题,标签,django_id,content_type_id
> 
> &bf=recip(ms(NOW,pub_date),3.16e-11,1,1)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T09:13:08.353

这是从 solr wiki 中获取的（它已关闭，但我已将其缓存）我认为这就是您要寻找的。

如何提高较新文档的分数

按日期进行显式排序（忽略相关性分数） 对较新的文档使用更大的索引时间提升 使用 FunctionQuery 根据日期字段影响分数。在 Solr 1.3 中，使用形式为 recip(rord(myfield),1,1000,1000) 在 Solr 1.4 中，使用形式为 recip(ms(NOW,mydatefield),3.16e-11,1,1) [http ://lucene.apache.org/solr/api/org/apache/solr/search/function/ReciprocalFloatFunction.html](http://lucene.apache.org/solr/api/org/apache/solr/search/function/ReciprocalFloatFunction.html) http://lucene.apache.org/solr/api/org/apache/solr/search/BoostQParserPlugin。 html 查询“ipod”的完整示例，产品越新，得分越高：

[http://localhost:8983/solr/select?q=](http://localhost:8983/solr/select?q=) {!boost b=recip(ms(NOW,manufacturedate_dt),3.16e-11,1,1)}ipod 可以通过将查询分解为多个来简化实现论据：

[http://localhost:8983/solr/select?q=](http://localhost:8983/solr/select?q=) {!boost b=$dateboost v=$qq}&dateboost=recip(ms(NOW,manufacturedate_dt),3.16e-11,1,1)&qq=ipod Now主要的“q”参数以及“dateboost”参数可以在 solrconfig.xml 的搜索处理程序中指定为默认值，并且客户端只需要传递“qq”，即用户查询。

要提升另一种查询类型，例如 dismax 查询，提升查询的值是完整的子查询，因此可以使用 {!querytype} 语法。或者，可以在 boost 本地参数中使用 defType 参数将默认类型设置为 dismax。其他 dismax 参数可以设置为顶级参数。

[http://localhost:8983/solr/select?q=](http://localhost:8983/solr/select?q=) {!boost b=$dateboost v=$qq defType=dismax}&dateboost=recip(ms(NOW,manufacturedate_dt),3.16e-11,1,1)&qf =text&pf=text&qq=ipod 考虑使用降低精度来防止过多的内存消耗。您将改为使用 recip(ms(NOW/HOUR,mydatefield),3.16e-11,1,1)。请参阅本主题以获取更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T05:07:27.410

显然您的日期字段不是 TrieDate

# android - 相对布局打破了缩放控制？

> ID：10201761
> 
> 赞同：0
> 
> 时间：2012-04-18T01:56:06.003
> 
> 标签：android, android-layout, zooming

所以我有一个包含地图视图和缩放控件的线性布局。这工作得很好，当我有一段时间没有触摸地图时，缩放控件会消失。今天我将线性布局更改为相对布局，这样我就可以在地图上放置一个按钮，这样我就可以在向其添加动画后使用缩放控件淡入淡出。但是，现在我的缩放控件永远不会褪色，并且在我点击它们时不起作用（它会亮起但不会缩放）。有没有人以前有过这种情况或知道是什么原因造成的？此外，如果有人有更好的方法来制作褪色按钮，那就太好了。谢谢

编辑：添加 xml，唯一的区别是线性布局被更改为相对，它破坏了缩放控件。我试图添加的按钮甚至还没有。您看到的切换按钮应该位于地图视图下方。线性布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
>
<RelativeLayout android:id="@+id/mapLayout"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:gravity="center"
android:layout_weight="3"
>
<com.google.android.maps.MapView
android:id="@+id/myMap"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:enabled="true"
android:clickable="true"
android:apiKey="0qzcn7Raizqq5MIjDsJKE-AFNV8pfZpDpLxF9dA"
/>
<ZoomControls android:id="@+id/zoomControls"
android:layout_alignParentBottom="true"
android:layout_centerHorizontal="true"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
/>
</RelativeLayout>
<LinearLayout android:id="@+id/buttonLayout"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:gravity="center"

>
<ToggleButton android:text="ToggleButton" 
    android:id="@+id/toggleButton1" 
    android:layout_width="wrap_content" 
    android:layout_height="wrap_content"></ToggleButton>
</LinearLayout>
</LinearLayout> 
```

相对布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
>
<RelativeLayout android:id="@+id/mapLayout"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:gravity="center"
android:layout_weight="3"
>
<com.google.android.maps.MapView
android:id="@+id/myMap"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:enabled="true"
android:clickable="true"
android:apiKey="0qzcn7Raizqq5MIjDsJKE-AFNV8pfZpDpLxF9dA"
/>
<ZoomControls android:id="@+id/zoomControls"
android:layout_alignParentBottom="true"
android:layout_centerHorizontal="true"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
/>
</RelativeLayout>
<LinearLayout android:id="@+id/buttonLayout"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:gravity="center"

>
<ToggleButton android:text="ToggleButton" 
    android:id="@+id/toggleButton1" 
    android:layout_width="wrap_content" 
    android:layout_height="wrap_content"></ToggleButton>
</LinearLayout>
</LinearLayout> 
```

# ios - UITableView reloaddata 和 tableview 是空的

> ID：10201766
> 
> 赞同：0
> 
> 时间：2012-04-18T01:56:49.740
> 
> 标签：ios, uitableview, reloaddata

有一个 navigationViewController，它是 UITableViewController 的子类

```
@interface TodoViewController : UITableViewController 
```

rightBarButtonItem 被称为“Reload”，它可以从

网络服务：

```
 UIBarButtonItem *rightBarButtonItem = [[UIBarButtonItem alloc] initWithTitle:@"Reload" 
                                                                      style:UIBarButtonItemStyleBordered 
                                                                     target:self 
                                                                     action:@selector(reloadTableData)];
rightBarButtonItem.tintColor = [UIColor colorWithRed:0.41176f green:0.41176f blue:0.41176f alpha:1.0];    
self.navigationItem.rightBarButtonItem = rightBarButtonItem; 
```

还有我的重载功能：

```
- (void)reloadTableData
{
    [self.allTodoArray removeAllObjects];
    self.pageIndex = 1;
    [self getTodoList:self.pageIndex sortTpye:self.sortType];

    [self.tableView reloadData];
} 
```

getTodoList() 函数将返回来自远程 WebService 的新数据，并且

值不为零。

我的问题是：当我单击重新加载按钮以请求此 UITableView 的新数据时

tableView 是空的...我不知道如何使它正常！

帮我解决这个问题，提前谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T02:20:17.547

您将需要异步重新加载表视图数据。当 WebService api 调用完成时，创建回调或块以重新加载 tableview。

# objectify - Objectify4 的新功能？

> ID：10201768
> 
> 赞同：0
> 
> 时间：2012-04-18T01:56:58.977
> 
> 标签：objectify

我找不到任何突出 Objectify 4 中新功能的文档。也许有人可以解释一下？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T02:55:38.030

除了梳理邮件列表档案之外，最好的文档在这里：

[http://code.google.com/p/objectify-appengine/wiki/DesignObjectify4](http://code.google.com/p/objectify-appengine/wiki/DesignObjectify4)

我很抱歉还没有推出真正的文档，但创业生活还没有时间。它会。

# ruby-on-rails - 为什么我不能在 RSpec 功能测试中提出 Mongoid::Errors::DocumentNotFound ？

> ID：10201769
> 
> 赞同：7
> 
> 时间：2012-04-18T01:57:25.150
> 
> 标签：ruby-on-rails, ruby-on-rails-3.1, mongoid, rspec-rails

我正在使用 rspec-rails (2.8.1) 对使用 mongoid (3.4.7) 的 rails 3.1 应用程序进行功能测试以实现持久性。我正在尝试在我的 ApplicationController 中为 Mongoid::Errors::DocumentNotFound 错误测试rescue_from，就像匿名控制器的[rspec-rails 文档](https://www.relishapp.com/rspec/rspec-rails/v/2-8/docs/controller-specs/anonymous-controller)表明它可以完成一样。但是当我运行以下测试时......

```
require "spec_helper"

class ApplicationController < ActionController::Base

  rescue_from Mongoid::Errors::DocumentNotFound, :with => :access_denied

private

  def access_denied
    redirect_to "/401.html"
  end
end

describe ApplicationController do
  controller do
    def index
      raise Mongoid::Errors::DocumentNotFound
    end
  end

  describe "handling AccessDenied exceptions" do
    it "redirects to the /401.html page" do
      get :index
      response.should redirect_to("/401.html")
    end
  end
end 
```

我收到以下意外错误

```
 1) ApplicationController handling AccessDenied exceptions redirects to the /401.html page
     Failure/Error: raise Mongoid::Errors::DocumentNotFound
     ArgumentError:
       wrong number of arguments (0 for 2)
     # ./spec/controllers/application_controller_spec.rb:18:in `exception'
     # ./spec/controllers/application_controller_spec.rb:18:in `raise'
     # ./spec/controllers/application_controller_spec.rb:18:in `index'
     # ./spec/controllers/application_controller_spec.rb:24:in `block (3 levels) in <top (required)>' 
```

为什么？我怎样才能提出这个 mongoid 错误？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-18T11:23:48.707

Mongoid 的[异常文档](http://rubydoc.info/github/mongoid/mongoid/master/Mongoid/Errors/DocumentNotFound)显示它必须被初始化。更正后的工作代码如下：

```
require "spec_helper"

class SomeBogusClass; end

class ApplicationController < ActionController::Base

  rescue_from Mongoid::Errors::DocumentNotFound, :with => :access_denied

private

  def access_denied
    redirect_to "/401.html"
  end
end

describe ApplicationController do
  controller do
    def index
      raise Mongoid::Errors::DocumentNotFound.new SomeBogusClass, {}
    end
  end

  describe "handling AccessDenied exceptions" do
    it "redirects to the /401.html page" do
      get :index
      response.should redirect_to("/401.html")
    end
  end
end 
```

# java - 实现公共 API

> ID：10201774
> 
> 赞同：0
> 
> 时间：2012-04-18T01:58:38.270
> 
> 标签：java, api, architecture, spring-mvc

很快我将不得不实现一个公共 API（Web API）。其中一个请求是我们需要提供不同的方法来做同样的事情（例如，REST 和 SOAP），我最初的方法是这样的。

为 REST 创建一个控制器 为 SOAP 创建一个控制器

使用一个通用的 Facade 类来处理来自 REST 和 SOAP 接口的请求，Facade 类将负责访问系统的内部（直接或间接地，可以使用圆顶 DAO……等等）。

代码将用 Java 编写，很可能会使用 Spring-MVC 以及其他技术。

这里的问题是。你能理解这个吗？是不是太荒谬了？你觉得这里有什么过度架构吗？有什么建议/经验/最佳实践吗？

谢谢你的时间 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T04:59:42.487

你能理解这个吗？

是的。

是不是太荒谬了？

不。

你觉得这里有什么过度架构吗？

不。

有什么建议/经验/最佳实践吗？

您可以找到描述您正在做什么的设计模式。例如，[GoF 适配器模式](http://en.wikipedia.org/wiki/Adapter_pattern)说：“在计算机编程中，适配器模式（通常称为包装器模式或简称为包装器）是一种将类的一个接口转换为兼容接口的设计模式。” 您有两个接口中专用的应用控制器（适配器）（适配器）：REST 和 SOAP。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T20:16:03.270

你的方法对我来说很有意义。Spring MVC 自己可以处理 REST 端点，接受和返回 XML 和/或 JSON。对于 SOAP，您将需要一个额外的框架，如[Spring-WS](http://static.springsource.org/spring-ws/sites/2.0/)或[Apache CXF](http://cxf.apache.org/)。

使用 MVC 模式时，最好通过将任何实际工作委托给注入控制器的其他 bean 来使控制器尽可能小。这些其他 bean 通常遵循服务或存储库原型（使用领域驱动设计术语）。这些 Service 和 Repository bean 可以跨 REST 和 SOAP 端点重用。我认为这就是您在第三段中的意思，如果是这样，那么您就在正确的轨道上。

# php - 在用户名中搜索“坏名”的最有效方法

> ID：10201782
> 
> 赞同：2
> 
> 时间：2012-04-18T01:59:12.170
> 
> 标签：php, regex

我有一个正在开发的应用程序，用户可以在其中为自己选择一个名称。我需要能够过滤掉“坏”的名字，所以我现在这样做：

```
$error_count=0;

$bad_names="badname1badname2";

preg_match_all("/\b".$user_name."\b/i",$global['bad_names'],
  $matches,PREG_OFFSET_CAPTURE);

if(count($matches[0])>0)
{
  $error_count++;
} 
```

这会告诉我用户名是否在坏名列表中，但是，它不会告诉我坏名本身是否在用户名中。他们可以将一个坏词与其他东西结合起来，而我不会发现它。

我会为此使用哪种正则表达式（如果我什至使用正则表达式）？我需要能够取任何不好的名字（最好在像 $bad_names 这样的数组中），并搜索用户的名字以查看该词是否在他们的名字中。我对正则表达式不是很好，我能想到的唯一方法就是把它全部通过一个看起来效率很低的循环。有人有更好的主意吗？我想我需要弄清楚如何用数组搜索字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T02:10:30.987

```
$badnames = array('name1', 'name2');

// you need to quote the names so they can be inserted into the
// regular expression safely
$badnames_quoted = array();
foreach ($badnames as $name) {
    $badnames_quoted[] = preg_quote($name, '/');
}

// now construct a RE that will match any bad name
$badnames_re = '/\b('.implode('|', $badnames_quoted).')\b/Siu';

// no need to gather all matches, or even to see what matched
$hasbadname = preg_match($badnames_re, $thestring);
if ($hasbadname) {
    // bad name found
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T02:28:18.200

```
private static $bad_name = array("word1", "word2", "word3");
private static $forbidden_name = array (array of unwanted character strings)

private static function userNameValid($name_in) {
  $badFound = preg_match("/\b(" . implode(self::$bad_name,"|") . ")\b/i", $name_in); // checks array for exact match
  $forbiddenFound = preg_match("/(" . implode(self::$forbidden_name,"|") . ")/i", $name_in); // checks array for any character match with a given name (i.e. "ass" would be found in assassin)

  if ($badFound) {
     return FALSE;
  } elseif ($forbiddenFound) {
     return FALSE;
  } else {
     return TRUE;
  } 
```

这对我来说很棒

# php - 为什么这个 Ajax 需要这么长时间才能渲染？

> ID：10201783
> 
> 赞同：2
> 
> 时间：2012-04-18T01:59:14.253
> 
> 标签：php, javascript, mysql, ajax, setinterval

我有一个页面，其中主要包含由`Ajax`. 它每 30 秒随机一次，并出现来自数据库的新内容。看起来不错，但是我的代码`PHP`似乎`Javascript`有问题，或者数据库有问题导致它滞后（Ajax 需要大约 30 秒才能加载！）

看起来好像`setInterval`我的 Javascript 中的递归调用在执行函数***之前***等待分配的毫秒数，但我在我的 Javascript 中找不到任何错误。

此外，从数据库中检索到两个图像 url 字符串，当 Ajax 必须从外部来源检索信息时，它似乎会滞后。或者也许我对 PHP语法

的使用有滞后`MySQL``ORDER BY rand()`?

这是相关的html：

```
 <html>
    <head>
    <title></title>
    <script type = "text/javascript" src = "randomProducts.js" />
    <script type = "text/javascript">
    setIntervalOnload();
    </script>
    </head>
    <body>
    ...
    ...
    ...
    </body>
    </html> 
```

这是相关的Javascript：

```
 // global static variables
        var subCategory; // initialized from setCategoryTree
        var t; // for setInterval and clearInterval

        var seconds;
        var millisecondsPerSecond;
        var milliseconds;

    function setIntervalOnload()
    {
        getRandomProducts();
        if(typeof t != "undefined")
            clearInterval(t);

        seconds = 30;
        millisecondsPerSecond = 1000;
        milliseconds = seconds * millisecondsPerSecond;

        t = setInterval(getRandomProducts, milliseconds);
    }

    function getRandomProducts()
    {
        //window.alert(subCategory);
        if(typeof subCategory == "undefined")
            subCategory = "all";
        else
        {
            clearInterval(t);
            t = setInterval(getRandomProducts, milliseconds);
        }

        var req = new XMLHttpRequest();

        var products = document.getElementById("products");

        req.onreadystatechange = function()
        {
            if( (req.readyState == 4) && (req.status == 200) )
            {
                var result = req.responseText;
                products.innerHTML = result;
            }
        };
        req.open("GET", "randomProducts.php?category=" + subCategory, true);
        req.send(null);
    }
    function setCategoryTree(link)
    {
        var categoryTree = document.getElementById("categoryTree");

        /* climbing the DOM-tree to get the category name (innerHTML of highest "a" tag) */
        var category = link.parentNode.parentNode.parentNode.getElementsByTagName("a")[0].innerHTML;

        subCategory = link.innerHTML;

        categoryTree.innerHTML = "==>&nbsp;" + category + "&nbsp;&nbsp;==>&nbsp;" + subCategory;

        getRandomProducts();
    } 
```

...这是相关的PHP：

```
<?php

    // connect to MySQL
    $dbName = "blah";
    $db = mysql_connect("localhost", $dbName, "asdf");
        if (!$db)
        {
             echo "<p>Error - Could not connect to MySQL</p>";
             exit;
        }

    // select the blah database
    $blah = mysql_select_db("blah");
        if(!$blah)
        {
            echo "<p>Error  - Could not select the blah database.</p>";
            exit;
        }

    // fix html characters in $subCategory
    $subCategory = $_GET["category"];
    trim($subCategory);
    $subCategory = stripslashes($subCategory);
    $subCategoryFixed = htmlspecialchars($subCategory);

    // for loop for each random product (total of 10 random products)
    for($i = 0; $i < 10; $i++)
    {
        // query the blah database for all products
        if($subCategoryFixed == "all")
        {
            $query = "SELECT * FROM products ORDER BY rand();";
            $result = mysql_query($query);
        }
        else // query the blah database for products in selected subCategory
        {
            $query = "SELECT * FROM products WHERE cat = " . $subCategoryFixed . " ORDER BY rand();";
            $result = mysql_query($query);
        }
            if (!$result)
            {
                echo "<p>Error - the query could not be executed</p><br />";
                $error = mysql_error();
                echo "<p>" . $error . "</p>";
                exit;
            }

        $row = mysql_fetch_array($result);
        $productValues = array_values($row);

        $name = htmlspecialchars($productValues[3]);
        $price = htmlspecialchars($productValues[5]);
        $img = htmlspecialchars($productValues[7]);

        // product info is formatted for home.html here
        $str = '<div>
                    <a href = "' . $link . '" title = "' . $name . '">
                        <table id = "product-table" onmouseover = "darkenProduct(this);" onmouseout = "lightenProduct(this);">
                            <tr>
                                <td>' . $name .'</td>
                            </tr>
                            <tr>
                                <td><img src = "' . $img . '" /></td>
                            </tr>
                            <tr>
                                <td>' . $price . '</td>
                            </tr>
                        </table>
                    </a>
                </div>';
        echo $str;
    } // end of products for loop
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T02:59:14.443

您没有在 onload 方法内运行代码。AJAX 设置代码的运行速度可能比页面加载速度快，因此`var products = ...`为空。您需要执行以下操作：

```
<body onload='setIntervalOnload();'> 
```

或者

```
 window.onload = setIntervalOnload; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T02:03:13.717

`setInterval`不会立即调用该函数。该函数的第一次运行将延迟多少时间间隔。

如果您希望它立即运行以及在计时器上运行，您必须自己专门调用该函数。

# qt - Qt中切换和触发之间的区别？

> ID：10201788
> 
> 赞同：4
> 
> 时间：2012-04-18T01:59:40.447
> 
> 标签：qt, signals

[QAction](http://qt-project.org/doc/qt-4.8/qaction.html)中的切换信号和触发信号有什么区别？我不知道何时使用其中一个或它们之间的关系。

此外，在触发信号的文档中，“激活”是什么意思？和专注是一样的吗？

谢谢...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T03:32:57.783

不同之处在于操作与什么类型的小部件相关联。例如，当您将操作连接到（二进制）复选框时，将应用切换信号。当复选框从“on”更改为“off”或“off”更改为“on”时，它会让您知道。然而，触发信号适用于瞬态动作，不需要存在“开”和“关”状态（即点击菜单项或点击按钮）。这里“激活”与“触发”的用法并不重要，您可以将它们视为没有这种额外状态的信号的同义词。

# javascript - 本地存储数据到服务器

> ID：10201792
> 
> 赞同：1
> 
> 时间：2012-04-18T02:00:15.237
> 
> 标签：javascript, ajax, json, local-storage

我碰巧在我的网络应用程序上有一个功能，可以将数据保存到本地存储中，然后我将其转换为 json 对象。有没有办法让我使用 ajax 将本地存储数据传递到我的服务器。我想让我的网络应用程序的其他客户端访问该数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T10:20:49.967

您可以像传递任何其他参数一样传递`localStorage`值，如下所示：`ajax`

```
 // jQuery ajax call.
 $.ajax({
   url: "test.html?jsonValue=" + localStorage.getItem("foo"),
 }); 
```

没有`localStorage`像 for 那样传递值的特殊方法`cookies`。

# iphone - 在 UITableView 中移动单元格时，如何使单元格保持静止？

> ID：10201794
> 
> 赞同：5
> 
> 时间：2012-04-18T02:00:39.540
> 
> 标签：iphone, objective-c, ios, uitableview

我有一个占据位置的人的名单。我希望用户能够将这些人重新排列到不同的位置，但是，有些位置是不受限制的。我认为使用 UITableView 的重新排列功能最容易做到这一点。但是，我不知道如何使我的不可用点保持静止。

例如，我想将 Activia Boulanger 移动到点 5。灰色单元格应该是不可移动的单元格。

开始的观点：

![开始](../Images/b6de1b1ea5d0fabfb88cfc2b30f8457b.png)

UITableView 自动执行的操作：

![UITableView 做了什么](../Images/8651ed3d809d176d87474ee205afde5f.png)

我希望 UITableView 做什么：

![我想要的是](../Images/1d48508eb23b35bcbb645d439d668ae5.png)

设置`tableView:canMoveRowAtIndexPath:`似乎只是阻止您移动一个单元格，但并不能阻止该单元格响应其他单元格的移动而移动。

任何帮助将不胜感激。谢谢

* * *

更新：下面是一些带有问题设置的示例代码。我没有将我的努力包括在解决方案中，因为它们都失败了并且会使事情变得混乱。

```
#import "LDYViewController.h"

static NSString * unmoveableCellId = @"NoMove";
static NSString * moveableCellId = @"OkMove";

@implementation LDYViewController
@synthesize tableView;
@synthesize peopleList;

- (void)viewDidLoad
{
    [super viewDidLoad];

    peopleList = [[NSMutableArray alloc] initWithObjects:
                  @"Belinda Boomer", @"Activia Boulanger", @"Arnold Carter", [NSNull null], @"Attila Creighton", [NSNull null], @"Bruce Cleary", [NSNull null], nil];
    [tableView setEditing:YES];
    // Do any additional setup after loading the view, typically from a nib.
}

#pragma mark - Table view data source

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return peopleList.count;
}

- (UITableViewCell *)tableView:(UITableView *)theTableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell;

    if([peopleList objectAtIndex:indexPath.row] == [NSNull null]) {
        cell = [tableView dequeueReusableCellWithIdentifier:unmoveableCellId];
        if (cell == nil) {
            cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:unmoveableCellId];
            cell.userInteractionEnabled = NO;
            cell.contentView.backgroundColor = [UIColor grayColor];
        }
    } else {
        cell = [tableView dequeueReusableCellWithIdentifier:moveableCellId];
        if (cell == nil) {
            cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:moveableCellId];
            NSString * name = [peopleList objectAtIndex:indexPath.row];
            cell.textLabel.text = name;
        }        
    }

    return cell;
}

- (void) tableView:(UITableView *)tableView moveRowAtIndexPath:(NSIndexPath *)sourceIndexPath toIndexPath:(NSIndexPath *)destinationIndexPath {
}

- (NSIndexPath *)tableView:(UITableView *)tableView
targetIndexPathForMoveFromRowAtIndexPath:(NSIndexPath *)sourceIndexPath
       toProposedIndexPath:(NSIndexPath *)proposedDestinationIndexPath {
    return proposedDestinationIndexPath;
}

- (BOOL)tableView:(UITableView *)tableView canMoveRowAtIndexPath:(NSIndexPath *)indexPath
{
    if([peopleList objectAtIndex:indexPath.row] == [NSNull null]) {
        return NO;
    }

    return YES;
}    
@end 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-18T04:14:08.763

尝试这个：

```
- (NSIndexPath *)tableView:(UITableView *)tableView targetIndexPathForMoveFromRowAtIndexPath:(NSIndexPath*)sourceIndexPath
       toProposedIndexPath:(NSIndexPath *)proposedDestinationIndexPath 
```

您可以检查providedDestinationIndexPath，如果您不想将行移动到它，您可以返回sourceIndexPath然后将行移回，否则返回providedDestinationIndexPath。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T02:35:41.827

在您的模型上执行正常的重新排列逻辑，然后在完成后将空值放回您想要的位置。发布的代码不包括模型，所以这里有一个合理的模型来说明：

```
// always leave our array with a null at indexes 3,5,7
// i'm sure you have better logic about where nulls go, but just to illustrate
- (void)addNulls {

    NSMutableArray *answer = [NSMutableArray array];
    for (id object in self.peopleList) {
        if (![object isKindOfClass:[NSNull self]]) {
            [answer addObject:object];
        }
    }

    assert(answer.count >= 4);
    [answer insertObject:[NSNull null] atIndex:3];
    [answer insertObject:[NSNull null] atIndex:5];
    [answer insertObject:[NSNull null] atIndex:7];
    self.peopleList = answer;
}

// build a pretend model with nulls
- (NSMutableArray *)peopleList {

    if (!_peopleList) {
        _peopleList = [NSMutableArray array];
        [_peopleList addObject:@"Moe"];
        [_peopleList addObject:@"Larry"];
        [_peopleList addObject:@"Curly"];
        [_peopleList addObject:[NSNull null]];
        [_peopleList addObject:@"Groucho"];
        [_peopleList addObject:[NSNull null]];
        [_peopleList addObject:@"Chico"];
        [_peopleList addObject:[NSNull null]];
        [_peopleList addObject:@"Harpo"];
    }
    return _peopleList;
}

// normal rearrange logic, then fix your array up
- (void)tableView:(UITableView *)tableView moveRowAtIndexPath:(NSIndexPath *)fromIndexPath toIndexPath:(NSIndexPath *)toIndexPath {

    // reorder the list with the typical logic, ignoring nulls
    NSString *stringToMove = [self.peopleList objectAtIndex:fromIndexPath.row];
    [self.peopleList removeObjectAtIndex:fromIndexPath.row];
    [self.peopleList insertObject:stringToMove atIndex:toIndexPath.row];

    // now put nulls into the positions you want them
    [self addNulls];
    [self.tableView reloadData];
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-18T06:03:49.263

我遇到了类似的问题并解决了。

创建 2 部分并将所有灰色行放在第 2 部分中。

```
-(NSIndexPath *)tableView:(UITableView *)tableView targetIndexPathForMoveFromRowAtIndexPath:(NSIndexPath *)sourceIndexPath toProposedIndexPath:(NSIndexPath *)proposedDestinationIndexPath{

if (proposedDestinationIndexPath.section == 1)
    return sourceIndexPath;
else
    return proposedDestinationIndexPath; 
```

}

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T02:15:44.287

您可以使用以下方法执行此操作：

```
- (void)tableView:(UITableView *)tableView moveRowAtIndexPath:(NSIndexPath *)fromIndexPath toIndexPath:(NSIndexPath *)toIndexPath{ 
```

在此方法中，您需要检查 from indexIndexPath 和 toIndexPath 以检查用户是否移动到无效位置。修改 tableview 的数据源以将单元格放回或将其移动到正确的位置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-07-24T10:15:54.867

**快速实施**

```
class TableViewMovable: UITableView, UITableViewDelegate, UITableViewDataSource {

var arrDataSource = [[String:Int]]()

override func awakeFromNib() {
    super.awakeFromNib()
    commonInit()
}

func commonInit(){

    dataSource = self
    delegate = self
    isEditing = true

    register(UITableViewCell.self, forCellReuseIdentifier: "cell")
}

func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -> Int {
    return arrDataSource.count
}

func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {
    if let cell = tableView.dequeueReusableCell(withIdentifier: "cell") {
        cell.textLabel?.text = arrDataSource[indexPath.row].keys.first!
        let val = arrDataSource[indexPath.row].values.first!
        cell.backgroundColor = val % 2 == 0 ? UIColor.gray.withAlphaComponent(0.5) : UIColor.lightGray.withAlphaComponent(0.5)
        return cell
    }else{
        return UITableViewCell()
    }
}

func tableView(_ tableView: UITableView, editingStyleForRowAt indexPath: IndexPath) -> UITableViewCellEditingStyle {
    return .none
}
func tableView(_ tableView: UITableView, shouldIndentWhileEditingRowAt indexPath: IndexPath) -> Bool {
    return false
}

func tableView(_ tableView: UITableView, moveRowAt sourceIndexPath: IndexPath, to destinationIndexPath: IndexPath) {
    let movedObject = arrDataSource[sourceIndexPath.row]
    arrDataSource.remove(at: sourceIndexPath.row)
    arrDataSource.insert(movedObject, at: destinationIndexPath.row)
    debugPrint("\(sourceIndexPath.row) => \(destinationIndexPath.row)")

}

func tableView(_ tableView: UITableView, canMoveRowAt indexPath: IndexPath) -> Bool {
    return true
} 
```

}

希望这可能对某人有所帮助。

# asp.net - 为 Microsoft Dynamics CRM 编写 Web 门户

> ID：10201797
> 
> 赞同：3
> 
> 时间：2012-04-18T02:00:58.227
> 
> 标签：asp.net, vb.net, dynamics-crm-2011

我正在为将连接到 Microsoft Dynamics 的客户开发一个 Web 门户。我不想让 Dynamics CRM 直接成为面向 Internet 的部署 (IFD)，所以我想使用 Web 界面与之交互的单独数据库，然后使用 Web 服务在 Web 门户数据库和 Dynamics 之间移动数据客户关系管理。我只是在寻找关于这是否是最好的方法以及是否有任何好的代码示例等我可以考虑实现它的想法？我看到微软有一个客户门户，但它看起来需要（粗略一瞥）IFD 部署——我不想要。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T06:29:05.733

首先，在创建 ASP.NET 项目（WebForms 或 MVC 3）之后，添加以下引用：

1.  Microsoft.crm.sdk.proxy。
2.  Microsoft.xrm.sdk。
3.  系统.运行时。序列化。
4.  系统.服务模型。

在您的代码隐藏中创建一个类，然后添加以下代码：

```
private IOrganizationService GetCrmService(string userName, string password, string domain, Uri serviceUri)
{
    OrganizationServiceProxy _serviceProxy;

    ClientCredentials credentials = new ClientCredentials();
    credentials.Windows.ClientCredential = new System.Net.NetworkCredential(userName, password, domain);
    //credentials.UserName.UserName = userName;  // uncomment in case you want to impersonate
    //credentials.UserName.Password = password;
    ClientCredentials deviceCredentials = new ClientCredentials();

    using (_serviceProxy = new OrganizationServiceProxy(serviceUri,
                                                        null,
                                                        credentials,
                                                        deviceCredentials))
    {
        _serviceProxy.ServiceConfiguration.CurrentServiceEndpoint.Behaviors.Add(new ProxyTypesBehavior());
        return (IOrganizationService)_serviceProxy;
    }
} 
```

如果要检索多条记录：

```
string fetch = @"My Fetch goes here";
EntityCollection records = getCrmService().RetrieveMultiple(new FetchExpression(fetch)); 
```

我强烈建议下载 SDK 或查看[此](http://msdn.microsoft.com/en-us/library/gg334357.aspx)内容 。您会发现许多示例和演练，它们将帮助您构建良好的门户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T20:11:29.413

我认为这是一个很好的策略，因为：

*   它允许您将在网站上输入的数据异步放入 CRM。这种脱钩确保了 CRM 和网站都不会成为彼此的瓶颈。
*   只有中间服务层是面向 Internet 的，因此如果此服务层受到损害，您将控制哪些 CRM 信息将被披露/开放以供更改。

您所追求的架构让人想起 CRM 异步服务的工作方式（异步插件和工作流以这种方式工作）。：

*   作业被放入 CRM 数据库中的队列（表）中。
*   计划的服务每 x 秒唤醒一次，并从队列表中获取最新的 y 记录。
*   该服务执行每个作业并将结果（成功、错误消息日志）写回到队列表的记录中。

因此，可能最难的事情是编写一个从不抛出异常（但总是消化它）并将结果正确记录回数据库的良好预定服务。

要了解有关 Dynamics CRM 的“异步服务架构”的更多信息，请参阅以下内容：http: [//msdn.microsoft.com/en-us/library/gg334554.aspx](http://msdn.microsoft.com/en-us/library/gg334554.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T03:05:52.367

1.  这看起来是一个很好的方法。
2.  它将提高门户和 CRM 的性能。
3.  门户网站上显示的数据几乎是实时的。即它不是实时的。
4.  在整个开发过程中，您最好不断检查是否没有太多异步处理来保持 CRM 服务器一直忙碌。
5.  我不认为加速器/门户需要 CRM 作为 IFD 实例，我想只有门户部分需要面向国际（当然是为了使其可用于此目的！）
6.  Anwar 是对的，SDK 是此类研究的一个很好的启动板。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T02:04:21.350

客户门户 不需要 IFD 部署。如果您不喜欢客户门户，您可以随时使用 SDK 扩展进行门户开发（microsoft.xrm.client.dll 和 microsoft.xrm.portal.dll 和 portalbase 解决方案），这些都包含在 SDK 中。

关于如何使用 SDK 门户扩展来构建门户有一个很好的资源。

[Dynamics CRM 2011 门户开发](http://zhongchenzhou.wordpress.com/2012/04/05/dynamics-crm-2011-portal-development/)

# java - 将 Ruby 正则表达式转换为 Java

> ID：10201798
> 
> 赞同：0
> 
> 时间：2012-04-18T02:01:23.170
> 
> 标签：java, ruby, regex

我正在重新开始 Java 编程，在查看文档后，似乎没有简单的方法可以实现以下 Ruby 正则表达式。谁能帮我将以下功能转换为 Java，或者至少为我指出一个好的资源？

```
some_string = "ruby$|java$"

text.match(/#{some_string}/i)

text.gsub(/^ny\b/i, " new york ") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T03:07:35.830

贝文布，

查看 Java 教程中的正则[表达式课程](http://docs.oracle.com/javase/tutorial/essential/regex/)。[那里有很多，但特别感兴趣的是“模式类的方法](http://docs.oracle.com/javase/tutorial/essential/regex/pattern.html)”页面底部的“java.lang.String 中的模式方法等效项”部分。该部分的快速浏览表明：

*   对于“匹配”，使用[String#matches](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#matches%28java.lang.String%29)
*   对于“替换”，请使用[String#replace](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#replace%28java.lang.CharSequence,%20java.lang.CharSequence%29)

祝你好运！

# c++ - c++算术字数转换，求指教

> ID：10201803
> 
> 赞同：0
> 
> 时间：2012-04-18T02:01:45.713
> 
> 标签：c++, arrays, string, tokenize, boost-tokenizer

谢谢Joachim，但我无法编译它，我想这可能是我设置它的方式，所以我像你说的那样删除了for循环，并将这些函数合并到我的calculator.cpp文件中。因此，当我编译程序时，会导致以下错误：

错误：“ParseNumberWord”未声明（首先使用此函数）

计算器.h

```
 #ifndef CALCULATOR_H
    #define CALCULATOR_H

    class Calculator {
    //    float a, b;
    public:
        int add(int, int);
        int subtract(int, int);
        int multiply(int, int);
        int divide(int, int);
        int ParseNumberDigit();
        int ParseNumberWord();

    private:
        int n1;
        int n2;
    };

    #endif  /* CALCULATOR_H */ 
```

计算器.cpp

```
#include "Calculator.h"

int Calculator::add(int n1, int n2) {
    return (n1 + n2);
}
int Calculator::subtract(int n1, int n2) {
    return (n1 - n2);
}
int Calculator::divide(int n1, int n2) {
    return (n1 / n2);
}
int Calculator::multiply(int n1, int n2) {
    return (n1 * n2);
}

int Calculator::ParseNumberDigit(std::string &number)
{
    int n = 0;
    for (int i = 9; i >= 0 && !number.empty(); i--) {
        if (number.find(Hund[i]) == 0) {
            n = i * 100;
            number = number.substr(Hund[i].length());
        }
        else if (number.find(Ten[i]) == 0) {
            n = i * 10;
            number = number.substr(Ten[i].length());
        }
        else if (number.find(Teen[i]) == 0) {
            n = i + 10;
            number = number.substr(Teen[i].length());
        }
        else if (number.find(One[i]) == 0) {
            n = i;
            number = number.substr(One[i].length());
        }

        if (n != 0)
            break;
    }

    return n;
}

int Calculator::ParseNumberWord(const std::string &word)
{
    std::string number = word;

    std::transform(number.begin(), number.end(), number.begin(), [](char c) { return std::tolower(c); });
    // If the above line doesn't work, you have to do it the old way:
    // for (int x = 0; x < number.length(); x++) { //input to lower case
    //     number[x] = std::tolower(number[x]);
    // }

    int n = 0;

    while (!number.empty()) {
        // Parse the next "digit"
        n += ParseNumberDigit(number);

        // The '_' is used to bind together digits
        if (number[0] == '_') {
            number = number.substr(1);
        }
    }

    return n;
} 
```

主文件

```
#include <iostream>
#include <sstream>
#include "Calculator.h"
#include <algorithm>

using namespace std;
string Calualtor();

int main() {
    int length, result, OnesR, TensR;
    Calculator calc;
    string word1a, word2a;
    string word1, word2;
//    int result, OnesR, TensR;
    char arithmetic;

std::string One[10] = {"zero", "one", "two", "three", "four", "five", "six",
    "seven", "eight", "nine"};
std::string Teen[10] = {"", "eleven", "twelve", "thirteen", "fourteen", "fifteen", "sixteen",
    "seventeen", "eighteen", "nineteen"};
std::string Ten[10] = {"", "ten", "twenty", "thirty", "forty", "fifty", "sixty",
    "seventy", "eighty", "ninety"};
std::string Hund[10] = {"", "one_hundred", "two_hundred", "three_hundred",
    "four_hundred", "five_hundred", "six_hundred", "seven_hundred", "eight_hundred",
    "nine_hundred"};

    while (cin >> word1 >> arithmetic >> word2) {

        int n1 = ParseNumberWord(word1);
        int n2 = ParseNumberWord(word2);

        switch (arithmetic) { //determines which arithmetic operation to perform
            case '+':
                result = calc.add(n1, n2);
                break;
            case '-':
                result = calc.subtract(n1, n2);
                break;
            case '*':
                result = calc.multiply(n1, n2);
                break;
            case '/':
                result = calc.divide(n1, n2);
                break;
            default:
                cout << 0 << endl;

        }

        // for the teen array
        if (result <= 19 && result >= 11 || result <= 119 && result > 111) {
            result = result % 10;
            cout << Teen[result] << endl;

        } else {
            for (int i = 1; i <= 2; i++) //Save individual digits to individual variables.
            {
                switch (i) {
                    case 1:
                        OnesR = result % 10;
                        result = result / 10;
                        break;
                    case 2:
                        TensR = result % 10;
                        result = result / 10;
                        break;
                }

            }

            if ((OnesR || TensR) < 0) { //To print a negative result

                OnesR = OnesR * -1;
                TensR = TensR * -1;
                cout << "negative " + Ten[TensR] << One[OnesR] << endl;
            } else {
                cout << Ten[TensR] << One[OnesR] << endl;
            }
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T02:09:50.083

首先是一个小提示：用于获取第一个和第二个数字的代码是相同的，最好将这段代码变成一个函数。

至于你的问题，我看到了其中两个：第一个是无论你在循环中匹配什么“数字”字，你总是从`One`数组中删除，即这一行：

```
word1.erase(0, One[i].length()); 
```

应该在相应的`if`-body 内，并且使用正确的数组。

第二个问题是，在删除当前数字字之后，您实际上并没有检查`'_'`应该将数字绑定在一起的字符。

**编辑：**

您需要做的第一件事是使数字字数组全局化。然后只需创建一个接受字符串并返回数字的函数：

```
#include <algorithm>

std::string One[10] = {"zero", "one", "two", "three", "four", "five", "six",
    "seven", "eight", "nine"};
std::string Teen[10] = {"", "eleven", "twelve", "thirteen", "fourteen", "fifteen", "sixteen",
    "seventeen", "eighteen", "nineteen"};
std::string Ten[10] = {"", "ten", "twenty", "thirty", "forty", "fifty", "sixty",
    "seventy", "eighty", "ninety"};
std::string Hund[10] = {"", "one_hundred", "two_hundred", "three_hundred",
    "four_hundred", "five_hundred", "six_hundred", "seven_hundred", "eight_hundred",
    "nine_hundred"};

int ParseNumberDigit(std::string &number)
{
    int n = 0;
    for (int i = 9; i >= 0 && !number.empty(); i--) {
        if (number.find(Hund[i]) == 0) {
            n = i * 100;
            number = number.substr(Hund[i].length());
        }
        else if (number.find(Ten[i]) == 0) {
            n = i * 10;
            number = number.substr(Ten[i].length());
        }
        else if (number.find(Teen[i]) == 0) {
            n = i + 10;
            number = number.substr(Teen[i].length());
        }
        else if (number.find(One[i]) == 0) {
            n = i;
            number = number.substr(One[i].length());
        }

        if (n != 0)
            break;
    }

    return n;
}

int ParseNumberWord(const std::string &word)
{
    std::string number = word;

    std::transform(number.begin(), number.end(), number.begin(), [](char c) { return std::tolower(c); });
    // If the above line doesn't work, you have to do it the old way:
    // for (int x = 0; x < number.length(); x++) { //input to lower case
    //     number[x] = std::tolower(number[x]);
    // }

    int n = 0;

    while (!number.empty()) {
        // Parse the next "digit"
        n += ParseNumberDigit(number);

        // The '_' is used to bind together digits
        if (number[0] == '_') {
            number = number.substr(1);
        }
    }

    return n;
} 
```

在`main`你得到号码的地方，而不是你的`for`-loop 只是使用：

```
int n1 = ParseNumberWord(word1);
int n2 = ParseNumberWord(word2); 
```

*注意：以上功能经过测试可以正常工作。*

# db2 - DB2 V9 ZOS - 性能调优

> ID：10201807
> 
> 赞同：0
> 
> 时间：2012-04-18T02:02:19.977
> 
> 标签：db2, zos

# 背景

目前我使用的是 DB2 V9 版本。我的一个存储过程需要时间来执行。我查看了 BMC apptune 并找到了以下 SQL。我们使用三个表来执行以下查询。
ACCOUNT 表有 3413 条记录 EXCHANGE_RATE 有 1267K 记录 BALANCE 有 113M 记录

最近有人在查询中添加了以下代码。我认为正因为如此，我们遇到了问题。

```
AND (((A.ACT <> A.EW_ACT)             
      AND (A.EW_ACT <> ' ')                    
      AND (C.ACT = A.EW_ACT))         
     OR (C.ACT = A.ACT)) 
```

# 询问

```
SELECT F1.CLO_LED                               
INTO :H :H  
FROM (SELECT A.ACT, A.BNK, A.ACT_TYPE,                                  
             CASE WHEN :H = A.CUY_TYPE THEN DEC(C.CLO_LED, 21, 2)                 
             ELSE DEC(MULTIPLY_ALT(C.CLO_LED, COALESCE(B.EXC_RATE, 0)), 21, 2)         
             END AS CLO_LED                           
      FROM ACCOUNT A                             
      LEFT OUTER JOIN EXCHANGE_RATE B                 
      ON B.EFF_DATE = CURRENT DATE - 1 DAY         
      AND B.CURCY_FROM  = A.CURNCY_TYPE       
      AND B.CURCY_TO = :H          
      AND B.STA_TYPE = 'A'                   
        , BALANCE C                           
      WHERE A.CUSR_ID = :DCL.CUST-ID   
      AND A.ACT = :DCL.ACT
      AND A.EIG_RTN = :WS-BNK-ID                  
      AND A.ACT_TYPE = :DCL.ACT-TYPE    
      AND A.ACT_CAT = :DCL.ACT-CAT 
      AND A.STA_TYPE = 'A'                      
      AND (((A.ACT <> A.EW_ACT)             
            AND (A.EW_ACT <> ' ')                    
            AND (C.ACT = A.EW_ACT))         
           OR (C.ACT = A.ACT))                
      AND C.BNK =  :WS-BNK-ID                
      AND C.ACT_TYPE = :DCL.ACT-TYPE  
      AND C.BUS_DATE = :WS-DATE-FROM) F1                                              
WITH UR 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T16:40:21.297

这个查询中有许多奇怪的事情发生。其中最棘手的是将显式连接与隐式连接语法混合在一起。坦率地说，我不确定系统如何解释它。您似乎也对输入和输出使用了相同的主机变量；请不要。
另外，为什么你的列名这么短？DB2（至少那个版本）支持更长的列名。如果可能的话，请拯救人们的理智。

我们不能完全说明为什么事情很慢 - 我们可能需要查看访问计划。同时，这是您的查询，重组为*可能*更快的形式：

```
SELECT CASE WHEN :inputType = a.cuy_type THEN DEC(b.clo_led, 21, 2)
            ELSE DEC(MULTIPLY_ALT(b.clo_led, COALESCE(c.exc_rate, 0)), 21, 2) END
INTO :amount :amountIndicator  -- if you get results, do you need the indiciator?
FROM Account as a
JOIN Balance as b  -- This is assumed to not be a 'left', given coalesce not used
ON b.bnk = a.eig_rtn
AND b.act_type = a.act_type
AND b.bus_date = :ws-date-from
AND ((a.act <> a.ew_act     -- something feels wrong here, but
      AND a.ew_act <> ' '   -- without knowing the data, I don't
      AND c.act = a.ew_act) -- want to muck with it.
     OR c.act = a.act)
LEFT JOIN Exchange_Rate as c
ON c.eff_date = current_date - 1 day
AND c.curcy_from = a.curncy_type
AND c.sta_type = a.sta_type
AND c.curcy_to = :destinationCurrency
WHERE a.cusr_id = :dcl.cust-id
AND a.act = :dcl.act
AND a.eig_rtn = :ws-bnk-id
AND a.act_type = :dcl.act-type
AND a.act_cat = :dcl.act-cat
AND a.sta_type = 'A'
WITH UR
FECTCH FIRST 1 ROW ONLY 
```

其他一些注意事项：

1.  仅准确指定*所需*的列 - 在某些情况下，这允许仅索引访问，否则可能需要后续表访问。但是，这在这里可能无济于事。
2.  `COALESCE(c.exc_rate, 0)`不知何故感觉不舒服 - 如果不存在汇率，您返回的金额为`0`，否则可能是*有效*金额。您可能需要返回某种指示符，或者将其设为普通连接，而不是外部连接。

此外，请尝试此版本，以及可能*除了*表之间的条件之外还指定主机变量的版本。优化器应该能够自动交换值，但在某些情况下可能不能（实现细节）。

# javascript - IE 与 window.location.href 不兼容

> ID：10201809
> 
> 赞同：4
> 
> 时间：2012-04-18T02:02:38.600
> 
> 标签：javascript, jquery, ajax, internet-explorer

我正在使用来自 AJAX 发布请求的回调来导航到新页面，但它不适用于 Internet Explorer。我的代码如下：

```
$.ajax({ 
    type: "POST",
    url: phpUrl,  
    data: data,  
    async: false, 
    success: function() {       
         if (navigator.appName == 'Microsoft Internet Explorer'){   window.location.href("/step2.php")}
         else{ window.location.href = "/step2.php"}             
    },  
    dataType:'json'         

}); 
```

这在 FF/Safari/Chrome 上运行良好，但是当我在 IE 上测试它时它不起作用。有没有更好的重定向到新页面的方法？我正在使用`async:false`，因为如果我没有使用回调，我的数据没有加载到 Chrome/Safari 上，因为页面只会在`POST`请求完成之前更改。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T02:11:13.683

是括号。 `href`不是一个函数，所以试图调用它`window.location.href("/step2.php")`——是一个`TypeError`.

`href`像你在下一行做的那样分配，或者更好，使用[`location.assign()`](https://developer.mozilla.org/en/DOM/window.location)：

```
location.assign('/step2.php'); 
```

虽然您可以直接分配给`location`的属性 ( `location.href='...';`) 以使浏览器导航，但我建议不要这样做。

在内部，这样做只是调用`location.assign()`，并且分配给属性[并不总是在所有浏览器中表现相同](https://developer.mozilla.org/en/DOM/window.location#Examples)。

* * *

关于, `async:false`,***永远*不要那样做**。如果您发出同步 XHR 请求，[**那么您做错了**](http://kellegous.com/ecrits/001096)**。** [8.4%](http://blogs.msdn.com/b/ieinternals/archive/2011/08/03/do-not-use-xmlhttprequest-in-synchronous-mode-unless-you-like-to-hang.aspx)的报告 IE9 挂起是由于同步 XHR 阻塞浏览器。

鉴于您在回调中有它，在`location`POST 完成之前不会发生分配，所以我不确定您所说的“页面会在 POST 完成之前更改”是什么意思。（您忘记取消表格了`submit`吗？）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T02:05:17.607

`window.location.href = "/step2.php"`很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-20T10:47:07.587

IE 只喜欢完整的 url。

```
var fullURL = 'http://www.your_site.com/step2.php';

$.ajax({ 
    type: "POST",
    url: phpUrl,  
    data: data,  
    async: false, 
    success: function() {

        window.location.href(fullURL);

    },  
    dataType:'json'         
}); 
```

# .net - 如何定义具有空类型签名的 F# 抽象成员

> ID：10201817
> 
> 赞同：2
> 
> 时间：2012-04-18T02:03:27.087
> 
> 标签：.net, class, f#, unit-type

根据这个[页面](http://msdn.microsoft.com/en-us/library/dd483468.aspx)，一个类的所有抽象成员都必须有一个`type-signature`. 但我想定义一个具有 void 输入参数和 void 返回类型的抽象类。并且`void`在这种情况下不是有效的关键字。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T02:30:32.270

在 F# 中，您通常使用在 C# 中使用关键字的`unit`类型。`void`所以你正在寻找的一个例子是：

```
[<AbstractClass>]
type MyAbstractClass() =
    abstract MyMethod : unit -> unit

type MyDerivedClass() =
    inherit MyAbstractClass()
    override this.MyMethod() = printf "Do something here..." 
```

# python - 需要一些编码来输入我的图像吗？

> ID：10201821
> 
> 赞同：0
> 
> 时间：2012-04-18T02:03:48.677
> 
> 标签：python

这就是我的程序应该是这样的：

![预期的](../Images/abc4c0684adb2527f48b115387ec58e4.png)

```
def main():

    from graphics import GraphWin, Point, Rectangle

    win= GraphWin("Apartment Displayer",700,400)

    p1=Point(40,50)

    p2=Point(100,130)

    rec=Rectangle(p1,p2)

    rec.setFill("cyan")

    rec.draw(win)

    p3=Point(100,30)

    p4=Point(280,130)

    rec=Rectangle(p3,p4)

    rec.setFill("yellow")

    rec.draw(win)

    p5=Point(280,30)

    p6=Point(550,130)

    rec=Rectangle(p5,p6)

    rec.setFill("tan3")

    rec.draw(win)

    p7=Point(75,130)

    p8=Point(200,320)

    rec=Rectangle(p7,p8)

    rec.setFill("green3")

    rec.draw(win)

    p9=Point(200,130)

    p10=Point(220,320)

    rec=Rectangle(p9,p10)

    rec.setFill("tan")

    rec.draw(win)

    p11=Point(220,130)

    p12=Point(550,225)

    rec=Rectangle(p11,p12)

    rec.setFill("cyan3")

    rec.draw(win)

    p13=Point(220,225)

    p14=Point(275,320)

    rec=Rectangle(p13,p14)

    rec.setFill("yellow3")

    rec.draw(win)

    p15=Point(275,225)

    p16=Point(550,320)

    rec=Rectangle(p15,p16)

    rec.setFill("green")

    rec.draw(win)

    p17=Point(550,30)

    p18=Point(570,320)

    rec=Rectangle(p17,p18)

    rec.setFill("tan")

    rec.draw(win)

    s=input("close Window?")

    win.close()

main() 
```

这就是我所拥有的，但不知道如何将名称放在我的矩形内，如我的链接中所示。请问有人可以帮我吗？？？

谢谢你...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T02:13:24.077

除了绘制建筑物楼层的布局之外，我不确定您要在这里做什么。也许看看[PyGame](http://pygame.org/news.html)，其中绘制矩形和渲染字体就像您在这里所做的一样简单，并且您将能够获得更多帮助，因为它是一个相当知名的库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T02:17:03.210

一种方法是使用`Text`

```
Text(Point(60, 60), "kitchen").draw(win) 
```

我现在没有窗户，但我认为这是最快的破解。

此外，请查看此[文档](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CCQQFjAA&url=http://mcsp.wartburg.edu/zelle/python/graphics/graphics.pdf&ei=0iOOT_veEoXf0QGmqrGSDw&usg=AFQjCNEMXOo4ZsLRgivN1xwQatTSVyqXuA&sig2=UYeS-OBpZlJDZJeOkjpwGw)并转到`3.7 Text Methods`

# php - 使用php和jquery上传进度条

> ID：10201824
> 
> 赞同：5
> 
> 时间：2012-04-18T02:04:13.910
> 
> 标签：php, jquery, upload, progress-bar, pecl

因此，我尝试使用进度条进行上传，我安装了uploadprogress pecl，如果表单中的操作导致`upload.php`任何其他名称，则上传工作完美，并且它停止工作。

如果名称不是`upload.php`输出只是“100”（这可以在下面的 getprogress.php 文件中看到为什么），这是形式：（这个版本有效，因为文件是 upload.php）

```
<form method="post" action="/test/upload.php" enctype="multipart/form-data" id="upload-form" target="upload-frame">
        <input type="hidden" id="uid" name="UPLOAD_IDENTIFIER" value="<?php echo $uid; ?>">
        <input type="file" name="file">
        <input type="submit" name="submit" value="Upload!">
    </form>
    </div>
    <div style="float:left;width:100%;">
    <div id="progress-bar"></div>
    </div>
    <iframe id="upload-frame" name="upload-frame"></iframe> 
```

这是jQuery：

```
<script>
        (function ($) {
            var pbar;
            var started = false; 
            $(function () {
                $('#upload-form').submit(function() {
                    pbar = $('#progress-bar');
                    pbar.show().progressbar();
                    $('#upload-frame').load(function () {
                        started = true;
                    });
                    setTimeout(function () {
                        updateProgress($('#uid').val());
                    }, 1000);
                });
            });
            function updateProgress(id) {
                var time = new Date().getTime();
                $.get('../uploadprogress/getprogress.php', { uid: id, t: time }, function (data) {
                    var progress = parseInt(data, 10);
                    if (progress < 100 || !started) {
                        started = progress < 100;
                        updateProgress(id);
                    }
                    started && pbar.progressbar('value', progress);
                });
            }
        }(jQuery));
</script> 
```

这是文件`getprogress.php`

```
<?php
if (isset($_GET['uid'])) {
   // Fetch the upload progress data
   $status = uploadprogress_get_info($_GET['uid']);
   if ($status) {
       // Calculate the current percentage
       echo round($status['bytes_uploaded']/$status['bytes_total']*100, 1);
   }
   else {
       // If there is no data, assume it's done
       echo 100;
   }
}
?> 
```

我花了大约 5 个小时试图找出原因，但我不能。帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T16:55:05.970

## 您可以使用此类，而无需使用 jquery：

```
<?php

/**
 * Progress bar for a lengthy PHP process
 * http://spidgorny.blogspot.com/2012/02/progress-bar-for-lengthy-php-process.html
 */

class ProgressBar {
    var $percentDone = 0;
    var $pbid;
    var $pbarid;
    var $tbarid;
    var $textid;
    var $decimals = 1;

    function __construct($percentDone = 0) {
        $this->pbid = 'pb';
        $this->pbarid = 'progress-bar';
        $this->tbarid = 'transparent-bar';
        $this->textid = 'pb_text';
        $this->percentDone = $percentDone;
    }

    function render() {
        //print ($GLOBALS['CONTENT']);
        //$GLOBALS['CONTENT'] = '';
        print($this->getContent());
        $this->flush();
        //$this->setProgressBarProgress(0);
    }

    function getContent() {
        $this->percentDone = floatval($this->percentDone);
        $percentDone = number_format($this->percentDone, $this->decimals, '.', '') .'%';
        $content .= '<div id="'.$this->pbid.'" class="pb_container">
            <div id="'.$this->textid.'" class="'.$this->textid.'">'.$percentDone.'</div>
            <div class="pb_bar">
                <div id="'.$this->pbarid.'" class="pb_before"
                style="width: '.$percentDone.';"></div>
                <div id="'.$this->tbarid.'" class="pb_after"></div>
            </div>
            <br style="height: 1px; font-size: 1px;"/>
        </div>
        <style>
            .pb_container {
                position: relative;
            }
            .pb_bar {
                width: 100%;
                height: 1.3em;
                border: 1px solid silver;
                -moz-border-radius-topleft: 5px;
                -moz-border-radius-topright: 5px;
                -moz-border-radius-bottomleft: 5px;
                -moz-border-radius-bottomright: 5px;
                -webkit-border-top-left-radius: 5px;
                -webkit-border-top-right-radius: 5px;
                -webkit-border-bottom-left-radius: 5px;
                -webkit-border-bottom-right-radius: 5px;
            }
            .pb_before {
                float: left;
                height: 1.3em;
                background-color: #43b6df;
                -moz-border-radius-topleft: 5px;
                -moz-border-radius-bottomleft: 5px;
                -webkit-border-top-left-radius: 5px;
                -webkit-border-bottom-left-radius: 5px;
            }
            .pb_after {
                float: left;
                background-color: #FEFEFE;
                -moz-border-radius-topright: 5px;
                -moz-border-radius-bottomright: 5px;
                -webkit-border-top-right-radius: 5px;
                -webkit-border-bottom-right-radius: 5px;
            }
            .pb_text {
                padding-top: 0.1em;
                position: absolute;
                left: 48%;
            }
        </style>'."\r\n";
        return $content;
    }

    function setProgressBarProgress($percentDone, $text = '') {
        $this->percentDone = $percentDone;
        $text = $text ? $text : number_format($this->percentDone, $this->decimals, '.', '').'%';
        print('
        <script type="text/javascript">
        if (document.getElementById("'.$this->pbarid.'")) {
            document.getElementById("'.$this->pbarid.'").style.width = "'.$percentDone.'%";');
        if ($percentDone == 100) {
            print('document.getElementById("'.$this->pbid.'").style.display = "none";');
        } else {
            print('document.getElementById("'.$this->tbarid.'").style.width = "'.(100-$percentDone).'%";');
        }
        if ($text) {
            print('document.getElementById("'.$this->textid.'").innerHTML = "'.htmlspecialchars($text).'";');
        }
        print('}</script>'."\n");
        $this->flush();
    }

    function flush() {
        print str_pad('', intval(ini_get('output_buffering')))."\n";
        //ob_end_flush();
        flush();
    }

}

echo 'Starting&hellip;<br />';

$p = new ProgressBar();
echo '<div style="width: 300px;">';
$p->render();
echo '</div>';
for ($i = 0; $i < ($size = 100); $i++) {
    $p->setProgressBarProgress($i*100/$size);
    usleep(1000000*0.1);
}
$p->setProgressBarProgress(100);

echo 'Done.<br />';

?> 
```

## 你可以在while进程中调用setProgressBarProgress函数，看你的需要！！！这很棒！。

# github - Github 显示父目录

> ID：10201827
> 
> 赞同：1
> 
> 时间：2012-04-18T02:04:43.980
> 
> 标签：github, tree, project

我有一个正在开发的网站，它的 github 是[https://github.com/samclark2015/Project-Emerald](https://github.com/samclark2015/Project-Emerald)。我在子目录中的用户文件夹下有 repo。现在，当我将站点推送到 github 时，它会将树更新为 Sites/Project Emerald/... 我需要 github 存储库根目录中的项目 emerald 文件夹的内容。如何在我的 PC 上更改我的 repo 的根目录？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T06:11:33.213

由于您刚刚在 GitHub 存储库中进行了第一次提交，因此最简单的方法是：

*   删除您`.git`在“ `Site`”下的本地目录
*   在本地重新创建您的存储库，并强制推送它：

那将给出：

```
# in Site/Project-Emerald
git init . 
git add remote origin https://samclark2015@github.com/samclark2015/Project-Emerald.git
git add .
git commit -m "first commit, again"
git push -force origin master 
```

然后，您将直接在 GitHub 存储库中看到：

```
PHP     
SpryAssets  
pictures    
README  
config.inc
... 
```

[“我的 Git 存储库位于错误的根目录中。我可以移动它吗？（`../`而不是`./`）](https://stackoverflow.com/questions/1918111/my-git-repository-is-in-the-wrong-root-directory-can-i-move-it-intead-of) ”中提到了其他替代方法

# powershell - 获取 ADComputer 和 MemberOf

> ID：10201830
> 
> 赞同：3
> 
> 时间：2012-04-18T02:04:59.870
> 
> 标签：powershell, active-directory, powershell-2.0

我对 Powershell 非常陌生，在使用`Get-ADUser`和`GetADComputer`cmdlet 时遇到问题。

我正在尝试使用`Get-ADComputer`and从所有用户和计算机的 Active-Directory 中`Get-ADUser`检索。`memberOf`它似乎只是从 2 个或更多组中的用户和计算机中检索信息。仅在 1 个组中的任何用户/计算机都不会显示任何内容。

例如：如果 UserA 在组管理员中，我在使用 MemberOf 时没有得到任何输出。但是如果 User2 同时在管理员和域管理员中，我会得到一些输出。但是，它只会输出其中一个组。

Get-ADGroup 做同样的事情。

这是正常的吗？我无法想象它是。

这是我的代码：

```
Get-ADUser -Filter * -Properties * | Select-Object -Property Name,MemberOf | Sort-Object -Property Name 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T06:51:00.823

您的麻烦来自主要组不是`memberOf`属性的一部分这一事实。

所以试试这个：

```
Get-ADUser -Filter * -Properties * | Select-Object -Property Name,MemberOf,PrimaryGroup | Sort-Object -Property Name 
```

您将在[此答案](https://stackoverflow.com/a/5776289/608772)中找到更深入的解释。

# msbuild - TeamCity 在幕后将哪些参数传递给 MSBuild？

> ID：10201832
> 
> 赞同：1
> 
> 时间：2012-04-18T02:05:18.067
> 
> 标签：msbuild, azure, teamcity, teamcity-7.0

我今天刚刚下载了 TeamCity 7，并决定为我的 Azure 解决方案启动并运行它。我还没有尝试做任何花哨的事情，而是从一个非常基本的命令行构建开始：

```
msbuild /t:Publish /p:Configuration=Release;TargetProfile=Production;PublishDir=S:\HoursTracker\Deployments 
```

这会成功构建并生成一个如下所示的包*：

![在此处输入图像描述](../Images/6b1005ee8e7f7f83681c5e046981bfdf.png)

然后我尝试以相同的方式配置 TeamCity：

![在此处输入图像描述](../Images/96e3202faaa919cf70aad7b6ad081a17.png)

这会成功构建并生成一个如下所示的包*：

![在此处输入图像描述](../Images/fb86c11203cb39e03e94411b5fda9bcb.png)

我不明白的是，为什么 MVC 项目的规模会有如此巨大的差异。直接从 Visual Studio 发布会产生与我的 MSBuild 命令完全相同的结果，因此我确信 TeamCity 是个奇怪的人。由于我认为 TeamCity 没有损坏，有人可以教我如何正确配置它，以便获得预期的输出吗？

*我已经用 .zip 重命名了包文件，以便可以查看这篇文章的详细信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T03:49:48.870

明的回答帮我解开了谜团。检查 zip 文件的内容后，我发现不同之处在于我的 MSBuild 包包含 bin 和 obj 文件夹，而 TeamCity 包没有。

![在此处输入图像描述](../Images/bfd829c60ebd2de36dde51e10a0f2cd2.png)

在做出这个发现之后，我意识到我可以为 MSBuild 指定多个目标，并将“Clean”添加到我的目标开关之前，如下所示：

```
msbuild /t:Clean;Publish /p:Configuration=Release;TargetProfile=Production;PublishDir=S:\HoursTracker\Deployments 
```

正如预期的那样，这删除了这些文件夹。显然，TeamCity 为您隐含地指定了“清洁”。谜团已揭开。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T08:25:20.930

Windows Azure 包可能比我们预期的要大。您可以将 cssx 文件重命名为 zip，然后您将找出包内的内容。除了 Web 应用程序的常用文件之外，还有一堆 Windows Azure 文件。例如，如果启用诊断，您将看到一个诊断文件夹，您可以在其中找到 Windows Azure 诊断运行时使用的文件。

最好的祝福，

明旭。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T06:35:17.977

为什么您为 msbuild runner 指定 x64？尝试选择工具版本。您尚未指定 /p:Platform 参数。发布任务是否涉及重建？

TeamCity 以 /p 的数量开始 msbuild：参数取自“属性和环境变量”部分，以及一些众所周知的参数，如配置名称或项目名称。

# php - 从文本文件中选择 6 个和 10 个字符以下的随机字符串

> ID：10201834
> 
> 赞同：3
> 
> 时间：2012-04-18T02:05:39.043
> 
> 标签：php, random

我有一个文本文件，我需要选择一个超过 6 个字符且少于 10 个字符的随机字符串。通常，我会使用这样的脚本[，](https://stackoverflow.com/questions/5904045/pull-random-line-from-txt-file-as-string)它会起作用，但由于它需要有一定的长度，所以它不起作用。有人对此有解决方案吗？

示例输入将是这样的：

```
Apple
Banana
Orange
Strawberry
Blueberry
Pineapple
Somelongfruithere 
```

这些值将位于 .txt 文件中，每个文件都有一个换行符。允许的字符串示例是`pineapple`, but `apple`or`Somelongfruithere`不被允许。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T02:14:08.630

我会把`explode`文本文件说成一个变量，运行你的随机生成器来获取一个放置值（随机字符串的位置）然后在一个循环中（一个 do/while 循环），从分解的变量中拉出字符串，并检查它的长度确保这是你想要的

```
if (strlen($rand_word) > 6 && strlen($rand_word) < 10) {
   //execute function and end loop 
} else {
// keep checking using a new random placement number
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T02:17:00.213

你需要做这样的事情：

```
$lines = array();
$tmpLines = file('random.txt');
for($i = 0; $i < count($tmpLines); ++$i)
{
    if(strlen($tmpLines[ $i ]) > 6 && strlen($tmpLines[ $i ]) < 10)
    {
        $lines[] = $tmpLines[ $i ];
    }
}
$randomWord = $lines[ array_rand($lines) ]; 
```

一种更短的方法，在行数上，是这样的（但安全性要低得多）：

```
$randomWord = '';
$lines = file('random.txt');
while(strlen($randomWord) <= 6 || strlen($randomWord) >= 10)
    $randomWord = $lines[ array_rand($lines) ]; 
```

第一个选项获取文件中的所有行，并且仅将长度在 6 到 10 个字符之间的行复制到另一个数组。从这个数组中选择一个随机元素时，您“保证”了任何随机字符串的合理访问时间。

第二个选项只是继续选择一个随机字符串，直到选择一个合适的长度，但*可能*需要一段时间，具体取决于随机数生成器的心情。不太可能，但我不想冒险。在我的书中，始终将可靠性作为最好的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T02:18:00.923

答案取决于需求。如果您需要从一组字符串中进行选择并且只接受一个符合您标准的字符串，那么您需要使用 strlen 并在长度不正确时重试。

否则，您仍然需要 strlen，以确保它至少为 6 个字符，但是您可以使用 substr 将其减少到 10。如果不计算空格，请在 strlen 和 substr 之前使用 ltrim 和 rtrim。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T02:16:30.533

首先找到正确字符范围内的所有单词，然后从结果数组中随机抽取一个：

```
$fileLines = file('somefile.txt');
$myWords = array();
foreach ($fileLines as $line)
{
    $thisLine = split(" ",$line);
    foreach ($thisLine as $word)
    {
        $length = strlen($word);
        if ($length > 6 && $length < 10)
        {
            $myWords[] = $word;
        }
    }
}

$randomWord = $myWords[array_rand($myWords)]; 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-04-18T02:38:04.097

缩短的方式！

```
for ($i=7; $i<=9; $i++)
    if (strlen($str) == $i )
       echo "bingo! " . strlen($str); 
```

# java - 通知运行然后立即崩溃

> ID：10201835
> 
> 赞同：2
> 
> 时间：2012-04-18T02:06:44.573
> 
> 标签：java, android

我设置了接近警报。（添加崩溃日志）

当接近警报触发时，我想要加载通知。然后当用户点击通知时，应该加载一个新的活动/表单。

现在，通知运行，然后应用程序崩溃。通知文本已成功接收并显示。

有没有人看到我的代码有什么问题会导致它在触发通知时崩溃？

**此代码设置接近警报/通知**

```
 public void SetupProximityAlerts(LocationManager lm, String name, String info, double latitude, double longitude, int range)
{
    Intent intent = new Intent(PROX_ALERT_INTENT);
    intent.putExtra("Name", name);
    intent.putExtra("Info", info);

    PendingIntent pi = PendingIntent.getBroadcast(this, 0, intent, PendingIntent.FLAG_CANCEL_CURRENT);

    lm.addProximityAlert(latitude, longitude, range, -1, pi);
    IntentFilter filter = new IntentFilter(PROX_ALERT_INTENT);

    registerReceiver(new MyBroadcastReceiver(), filter);
} 
```

**这是我的 BroadcastReceiver，它设置要在通知中显示的数据。运行时应用崩溃：nm.notify(0, n);**

直到 nm.notify(0, n); 成功运行。我已经通过日志验证了这一点。

```
public class MyBroadcastReceiver extends BroadcastReceiver
 {

@Override
public void onReceive(Context context, Intent intent)
{
    Bundle extras = intent.getExtras();

    String deal = (String) extras.get("Info");

    Intent notificationIntent = new Intent(context, ViewTarget.class);
    PendingIntent contentIntent = PendingIntent.getActivity(context, 0, notificationIntent, PendingIntent.FLAG_CANCEL_CURRENT);

    NotificationManager nm = (NotificationManager) context.getSystemService(Context.NOTIFICATION_SERVICE);

    Resources res = context.getResources();

    NotificationCompat.Builder builder = new NotificationCompat.Builder(context);
    builder.setContentIntent(contentIntent).setSmallIcon(R.drawable.icon).setLargeIcon(BitmapFactory.decodeResource(res, R.drawable.icon)).setTicker(deal).setWhen(System.currentTimeMillis()).setAutoCancel(true).setContentTitle("Message")
            .setContentText(deal);
    Notification n = builder.getNotification();

    n.defaults |= Notification.DEFAULT_ALL;

    nm.notify(0, n);
}
} 
```

**这是用户单击通知时我要加载的活动**

```
public class ViewTarget extends ListActivity
{

@Override
public ListAdapter getListAdapter()
{
    // TODO Auto-generated method stub
    return super.getListAdapter();
}

@Override
public ListView getListView()
{
    // TODO Auto-generated method stub
    return super.getListView();
}

@Override
public void setListAdapter(ListAdapter adapter)
{
    // TODO Auto-generated method stub
    super.setListAdapter(adapter);

}

@Override
protected void onCreate(Bundle savedInstanceState)
{
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.locations);
    Log.v("db", "Inside ViewTarget");
}

} 
```

这是崩溃日志

```
04-17 21:53:52.407: E/AndroidRuntime(4717): FATAL EXCEPTION: main
04-17 21:53:52.407: E/AndroidRuntime(4717): java.lang.RuntimeException: Error receiving broadcast Intent { act=com.kjdv.gpsVegas.MyBroadcastReceiver (has extras) } in com.kjdv.gpsVegas.MyBroadcastReceiver@44a4bc30
04-17 21:53:52.407: E/AndroidRuntime(4717):     at android.app.ActivityThread$PackageInfo$ReceiverDispatcher$Args.run(ActivityThread.java:905)
04-17 21:53:52.407: E/AndroidRuntime(4717):     at android.os.Handler.handleCallback(Handler.java:587)
04-17 21:53:52.407: E/AndroidRuntime(4717):     at android.os.Handler.dispatchMessage(Handler.java:92)
04-17 21:53:52.407: E/AndroidRuntime(4717):     at android.os.Looper.loop(Looper.java:123)
04-17 21:53:52.407: E/AndroidRuntime(4717):     at android.app.ActivityThread.main(ActivityThread.java:4627)
04-17 21:53:52.407: E/AndroidRuntime(4717):     at java.lang.reflect.Method.invokeNative(Native Method)
04-17 21:53:52.407: E/AndroidRuntime(4717):     at java.lang.reflect.Method.invoke(Method.java:521)
04-17 21:53:52.407: E/AndroidRuntime(4717):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
04-17 21:53:52.407: E/AndroidRuntime(4717):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
04-17 21:53:52.407: E/AndroidRuntime(4717):     at dalvik.system.NativeStart.main(Native Method)
04-17 21:53:52.407: E/AndroidRuntime(4717): Caused by: java.lang.SecurityException: Requires VIBRATE permission
04-17 21:53:52.407: E/AndroidRuntime(4717):     at android.os.Parcel.readException(Parcel.java:1247)
04-17 21:53:52.407: E/AndroidRuntime(4717):     at android.os.Parcel.readException(Parcel.java:1235)
04-17 21:53:52.407: E/AndroidRuntime(4717):     at android.app.INotificationManager$Stub$Proxy.enqueueNotificationWithTag(INotificationManager.java:274)
04-17 21:53:52.407: E/AndroidRuntime(4717):     at android.app.NotificationManager.notify(NotificationManager.java:110)
04-17 21:53:52.407: E/AndroidRuntime(4717):     at android.app.NotificationManager.notify(NotificationManager.java:90)
04-17 21:53:52.407: E/AndroidRuntime(4717):     at com.kjdv.gpsVegas.MyBroadcastReceiver.onReceive(MyBroadcastReceiver.java:51)
04-17 21:53:52.407: E/AndroidRuntime(4717):     at android.app.ActivityThread$PackageInfo$ReceiverDispatcher$Args.run(ActivityThread.java:892)
04-17 21:53:52.407: E/AndroidRuntime(4717):     ... 9 more 
```

谢谢！凯文

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T02:22:09.730

`Caused by: java.lang.SecurityException: Requires VIBRATE permission`

你忘记许可了吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T02:26:03.640

```
Caused by: java.lang.SecurityException: Requires VIBRATE permission 
```

崩溃中的上述行表明您正在使用振动功能，那么您必须在清单文件中添加权限。以下是需要添加的权限

```
<uses-permission android:name="android.permission.VIBRATE" /> 
```

# javascript - 将y轴显示为百分比？

> ID：10201841
> 
> 赞同：15
> 
> 时间：2012-04-18T02:08:12.653
> 
> 标签：javascript, svg, format, d3.js

我正在制作一个图表，我希望我的 y 轴刻度标签显示为百分比（而不是小数）。我怎样才能做到这一点？

我当前的代码看起来像

```
yAxis
  .append("text")
  .attr("class", "ticklabel")
  .attr("x", 0)
  .attr("y", y)
  .attr("dy", ".5em")
  .attr("text-anchor", "middle")
  .text(y.tickFormat(5))
  .attr("font-size", "10px") 
```

我注意到 d3 有一个[格式说明符](https://github.com/mbostock/d3/wiki/Formatting#wiki-d3_format)，但我不确定如何将它们与`tickFormat`.

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-04-18T16:25:33.580

看起来您是手动创作轴的。我建议改用[d3.svg.axis](https://github.com/mbostock/d3/wiki/SVG-Axes)组件，它会为您进行渲染。例如：

*   [http://bl.ocks.org/1166403](http://bl.ocks.org/1166403)

如果要将刻度格式化为百分比，请使用[d3.format](https://github.com/mbostock/d3/wiki/Formatting#wiki-d3_format)的*%*指令：

```
var formatPercent = d3.format(".0%");

var yAxis = d3.svg.axis()
    .scale(y)
    .orient("left")
    .tickFormat(formatPercent); 
```

如果要将百分比四舍五入到有效数字，则可以改用*p指令。*

要更直接地回答您的问题，请使用 d3.format*而不是*刻度的 tickFormat。为方便起见，Scales 提供了默认的 tickFormat，但如果您想要不同的行为，那么您可以使用自定义 d3.format 而不是 scale 的默认值。

# c - 在c中将uint8_t数组转换为char数组

> ID：10201842
> 
> 赞同：2
> 
> 时间：2012-04-18T02:08:13.640
> 
> 标签：c, arrays, hash

最初我想将此`uint8_t`数组转换为`char`c 中的数组。我一直在尝试解决这个问题。我的第一个替代解决方案是将另一个类型值复制到临时值，将 tmp 值复制到可写字符，然后从内存中删除 tmp 值。顺便说一句，这用于伴随 blake 散列函数。这是我的代码片段：

```
char * bl(char *input)
{
    uint8_t  output[64];
    char msg[]= "";
    char *tmp;

    int dInt;

    memset(output,0,64);
    tmp = (char*) malloc(64);
    if (!tmp){
            exit( 1);
    }

    dInt = strlen(input);

    if (dInt > 0xffff){
            exit( 1);
    }
    uint8_t data[dInt];

    memset(data,0, dInt);
    strlcpy(data,input,dInt);
    uint64_t dLen =dInt;
    blake512_hash(output, data,dLen);

    int k;
    for (k=0;k<64;k++){
            tmp[k] = output[k];  //does this "copy" is buggy code?
    }

    memcpy(msg, tmp,64);
    //so here I can to delete tmp value
    // I dont want there were left unused value in memory
    // delete tmp;  
    free(tmp);

    return  msg;
} 
```

我认为上面的代码仍然没有效率，那么您的意见，提示和修复是什么？之前非常感谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T02:18:40.097

首先，您永远不应该返回指向局部变量的指针，因为该变量将在函数退出时被销毁。您可能应该希望将输出数组传递给`bl`函数并使用它来输出字符串。

对于大多数情况（如果 uint8_t IS char，通常是这种情况），`memcpy(msg, output, 64)`应该就足够了。如果您想对此严格要求（坦率地说，如果您一直期望数组作为输出，`blake512_hash`则不应该首先返回数组），您可以简单地调用您的 for 循环并删除。`uint8_t``char``msg[k] = (char)tmp[k]``memcpy`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T02:23:36.467

这里有点不对劲。

```
dInt = strlen(input) + 1; // dInt is the size of the string including the terminating '\0'. 
```

`strlcpy`确实使用大小，而不是 strlen。

味精=tmp；而不是释放 tmp。因为 msg 是 const char* "" （用 C++ 术语）。

# ruby-on-rails - Rails 1.2.3 反序列化数据

> ID：10201843
> 
> 赞同：1
> 
> 时间：2012-04-18T02:08:21.297
> 
> 标签：ruby-on-rails, serialization, checkbox

我被指派修复以前开发人员创建的代码中的一些问题。他将序列化的复选框值存储在数据库中，尽管这些值肯定会存储在所描述的表中，但当表单出现时，不会根据存储在数据库中的内容检查复选框。我假设我需要在表单知道应该选中哪些复选框之前取消序列化该数据。

有没有办法反序列化排除数据，以便以下代码能够将 true 分配给 check_box_tag 方法的选中属性？

```
<p><label for="supplemental_material_type_exclusions">Exclusions</label><br/>
<%= ApplicantBudgetlevel.find(:all).collect { |p|
      if @supplemental_material_type.exclusions
        checked = @supplemental_material_type.exclusions.include?(p.level)
      else
        checked = false
      end
      "#{check_box_tag('supplemental_material_type[exclusions][]', p.level, checked)} #{p.level} - #{p.range}<br />\n"
    } %>
</p> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T00:18:42.047

我认为问题是*范围*问题；该`checked`变量仅存在于 的其中一个分支中，`if`一旦到达该变量就不再存在`end`。尝试这个：

```
<p><label for="supplemental_material_type_exclusions">Exclusions</label><br/>
<%= ApplicantBudgetlevel.find(:all).collect { |p|
      checked = false
      if @supplemental_material_type.exclusions
        checked = @supplemental_material_type.exclusions.include?(p.level)
      end
      "#{check_box_tag('supplemental_material_type[exclusions][]', p.level, checked)} #{p.level} - #{p.range}<br />\n"
    } %>
</p> 
```

我只是删除了`else`分支并将值设置为`false`默认值。

如果仅在分支为真时才显示复选框，这可能会导致进一步的失败`if`——在这种情况下，请尝试以下操作：

```
<p><label for="supplemental_material_type_exclusions">Exclusions</label><br/>
<%= ApplicantBudgetlevel.find(:all).collect { |p|
      if @supplemental_material_type.exclusions
        checked = @supplemental_material_type.exclusions.include?(p.level)
        "#{check_box_tag('supplemental_material_type[exclusions][]', p.level, checked)} #{p.level} - #{p.range}<br />\n"
      end
    } %>
</p> 
```

这两种方法中的哪一种是正确的取决于我无法从这里衡量的——但我会先尝试第一种，然后查看日志以查找新的或不同的错误或警告。

# java - 为什么 JAXB 映射到 JAXBElement 而不是指定类型？

> ID：10201844
> 
> 赞同：5
> 
> 时间：2012-04-18T02:08:26.093
> 
> 标签：java, xml, jaxb

为什么 jaxb 不生成指定类型？它生成通用 List<JAXBElement<?>> 而不是生成指定类型。

案例是我使用 xjc 将我的 xsd 转换为 java Obj，

我的xsd

```
<xs:complexType name="InputType">
    <xs:choice maxOccurs="unbounded">
        <xs:element name="add" type="AddInputType"/>
        <xs:element name="get" type="GetInputType"/>
        <xs:element name="del" type="DeleteInputType"/>
    </xs:choice>
</xs:complexType> 
```

生成的java类，

```
public class InputType {

@XmlElementRefs({
    @XmlElementRef(name = "add", type = JAXBElement.class),
    @XmlElementRef(name = "get", type = JAXBElement.class),
    @XmlElementRef(name = "del", type = JAXBElement.class)
})
protected List<JAXBElement<?>> addOrGetOrDel;

public List<JAXBElement<?>> getAddOrGetOrDel() {
    if (addOrGetOrDel == null) {
        addOrGetOrDel = new ArrayList<JAXBElement<?>>();
    }
    return this.addOrGetOrDel;
}
} 
```

# assembly - 汇编 jmp 内存表达式

> ID：10201846
> 
> 赞同：6
> 
> 时间：2012-04-18T02:08:46.327
> 
> 标签：assembly, gdb, disassembly

我正在为一个项目拆卸一些东西，我遇到了以下行

```
jmp *0x80498c0(,%eax,4) 
```

那条跳转指令到底想做什么？这是在 gdb 环境中。

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-18T08:44:47.463

这是间接跳转。

该指令计算 location `[0x80498c0 + eax*4]`，加载存储在那里的值并跳转到存储在该位置的地址。

这种代码在跳转表中很常见，通常在 C`switch`指令或等效指令之后。

编辑：`*`特定于 AT&T 语法。*它是取消引用*的助记符，就像在 C 中一样。如果大括号中的部分丢失，则需要它 -`jmp 0x80498c0`只需跳转到该地址，该地址`jmp *0x80498c0`跳转到存储在 0x80498c0 中的指针的目标。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T02:16:18.327

参见*Referencing memory:* section [here](http://www.delorie.com/djgpp/doc/brennan/brennan_att_inline_djgpp.html)
32位寻址可以看如下（AT&T格式）

> immed32（基指针、索引指针、索引刻度）

这被翻译为由给出的地址处的值

> immed32 + basepointer + indexpointer * indexscale

例如，要解决“a”是整数数组的 a[i]，您可以编写

> (%eax, %ebx, 4)

这样 eax 寄存器保存 a 的基指针，而 ebx 具有索引 i。

# c# - 使用 DLLImport 时异常如何工作

> ID：10201848
> 
> 赞同：6
> 
> 时间：2012-04-18T02:08:53.827
> 
> 标签：c#, c++, exception

我正在使用 DLLImport 从 C# 应用程序调用 GhostScript 库。

所以我有一些这样的代码，

```
[DllImport("gsdll32.dll", EntryPoint = "gsapi_init_with_args")]
private static extern int gsapi_init_with_args(IntPtr instance, int argc, IntPtr argv);

try 
{ 
    intReturn = gsapi_init_with_args(intGSInstanceHandle, intElementCount, intptrArgs); 
}
catch (Exception ex)
{
    throw new ApplicationException(ex.Message, ex);
} 
```

我将查看用 C 或 C++ 编写的 GhostScript 源代码，但总的来说，我想知道如果 GhostScript 代码抛出未处理的异常会发生什么？那会被那里的渔获物抓住吗，还是必须看起来像这样，

```
catch
{
    // blah
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T05:15:14.117

它不会抛出异常，您应该查看返回码。 [http://pages.cs.wisc.edu/~ghost/doc/AFPL/7.04/API.htm#return_codes](http://pages.cs.wisc.edu/~ghost/doc/AFPL/7.04/API.htm#return_codes)

非常标准的 C 编程方法，错误返回非零代码，有时随后进行第二次 API 调用以检索错误的更多详细信息。

# iphone - UITextView.text 不起作用

> ID：10201857
> 
> 赞同：2
> 
> 时间：2012-04-18T02:10:34.247
> 
> 标签：iphone, ios, xcode

嗨，我正在学习 iOS 编程。

我在使用 UITextView 时遇到了麻烦。

我做了一个项目并打开 viewController.xib

我拖入了 UISearchBar、UITextView 和 UILabel

我的 viewController 跟着 UISearchBarDelegate

我想更改 textView.text 的内容，但它没有。

这是我的代码。

```
-(void)viewDidLoad
{
   [super viewDidLoad];
   self.mySearchbar.delegate = self;
}

- (void)searchBarSearchButtonClicked:(UISearchBar *)searchBar
{
    [searchBar resignFirstResponder];
    self.myLabel.text = @"hoho";
    self.myTextview.text = @"hoho";
} 
```

当我点击搜索栏并输入任何字符并返回时，

myLabel 的文本设置为 hoho。

但 myTextview.text 没有设置。没有效果。

这是为什么？？我很困惑..请帮帮我

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T02:29:34.400

您是否在 Interface Builder 中链接了 Outlet？在 IB 中，单击 File's Owner，在右侧窗格中选择 Outlets，将 myTextview 链接到您放在视图上的 UITextview？

另外，由于您正在调用“self”，因此我假设您在 .h 文件中为 myTextview 创建了一个属性作为 IBOutlet？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T04:23:24.053

您是否也在设置（连接） UITextView 的代表。这可能是问题所在。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-18T07:03:47.590

尝试将 TextView 颜色设置为黑色

```
[YourTextview setTextColor:[UIColor blackColor]]; 
```

有时这会有所帮助。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-04-18T02:16:07.040

我记得，相反，您应该使用

```
[self.myLabel setText:@"hoho"]; 
```

# iphone - 在表格视图单元格中添加值

> ID：10201863
> 
> 赞同：0
> 
> 时间：2012-04-18T02:12:22.063
> 
> 标签：iphone, objective-c, ios5, uitableview

我有两个视图控制器。CardWallet View Controller 是我的表格视图。然后 AddCard 视图控制器是我为名为 Card 的对象的新实例输入值的地方。到目前为止，我正在使用委托将这些 Card 实例添加到名为 myWallet 的数组中，该数组位于我的 CardWallet 视图控制器中，并且它可以工作。

我想要的是，在我的 AddCard View Controller 中单击按钮后，我的 Card Wallet 视图中将出现一个新的表格单元格，其名称取决于最近添加的 Card 实例。下面是我的代码，请检查为什么当我添加完一个新的 Card 实例后，我的表中没有出现任何内容。我做了一些研究并阅读了一些教程，这个很好， http: [//kurrytran.blogspot.com/2011/10/ios-5-storyboard-and.html](http://kurrytran.blogspot.com/2011/10/ios-5-storyboard-and.html)，它对我有很多关于表格视图控制器的帮助. 但是，本教程并没有满足我的主要关注点，因为它的表值仅来自具有静态值的数组。

谢谢！

CardWalletViewController.h

```
#import <UIKit/UIKit.h>

@interface CardWalletViewController : UIViewController <UITableViewDelegate, UITableViewDataSource> {

}

@property (nonatomic, strong) NSMutableArray *myWallet;

-(void) printArrayContents;
@end 
```

CardWalletViewController.m

```
#import "CardWalletViewController.h"
#import "AddCardViewController.h"
#import "Card.h"

@interface CardWalletViewController () <AddCardDelegate>

@end

@implementation CardWalletViewController

@synthesize myWallet = _myWallet;

- (NSMutableArray *) myWallet
{
    if (_myWallet == nil) _myWallet = [[NSMutableArray alloc] init]; 
    return _myWallet;
}

- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"showAddCardVC"]) {
        AddCardViewController *addCardVC = (AddCardViewController *)segue.destinationViewController;

        addCardVC.delegate = self;

    }
}

- (void)printArrayContents 
{
    // I want to show the name of each instance of card

    for ( int i = 0; i < self.myWallet.count; i++) {
        Card *cardDummy = [self.myWallet objectAtIndex:i];
        NSLog(@"Element %i is %@", i,cardDummy.name );
    }

}

- (void)addCardViewController:(AddCardViewController *)sender didCreateCard:(Card *)newCard
{
    // insert a new card to the array

    [self.myWallet addObject:newCard];

    [self printArrayContents];
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
}

- (void)viewDidUnload
{
  // Release any retained subviews of the main view.
}

- (void)viewWillAppear:(BOOL)animated 
{

}

- (void)viewWillDisappear:(BOOL)animated
{

}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {

    //this method will return the number of rows to be shown

    return self.myWallet.count;   
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = (UITableViewCell *) [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier];

    }
    // Configure the cell...

    //---------- CELL BACKGROUND IMAGE -----------------------------
    UIImageView *imageView = [[UIImageView alloc] initWithFrame:cell.frame];
    UIImage *image = [UIImage imageNamed:@"LightGrey.png"];
    imageView.image = image;
    cell.backgroundView = imageView;
    [[cell textLabel] setBackgroundColor:[UIColor clearColor]];
    [[cell detailTextLabel] setBackgroundColor:[UIColor clearColor]]; 

    //this will show the name of the card instances stored in the array

    //

    for ( int i = 0; i < self.myWallet.count; i++) {
        Card *cardDummy = [self.myWallet objectAtIndex:i];
        cell.textLabel.text = cardDummy.name;
    }

    //Arrow 
    cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;

    return cell;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}

@end 
```

AddCardViewController.h

```
#import <UIKit/UIKit.h>
#import "Card.h"

@class AddCardViewController;

@protocol AddCardDelegate <NSObject>

- (void)addCardViewController:(AddCardViewController *)sender
                didCreateCard:(Card *) newCard;

@end

@interface AddCardViewController : UIViewController <UITextFieldDelegate>

@property (strong, nonatomic) IBOutlet UITextField *cardNameTextField;
@property (strong, nonatomic) IBOutlet UITextField *pinTextField;
@property (strong, nonatomic) IBOutlet UITextField *pointsTextField;

@property (nonatomic, strong) id <AddCardDelegate> delegate;

@end 
```

AddCardViewController.m

```
#import "AddCardViewController.h"
#import "Card.h"
#import "CardWalletViewController.h"

@interface AddCardViewController ()

@end

@implementation AddCardViewController 

@synthesize cardNameTextField = _cardNameTextField;
@synthesize pinTextField = _pinTextField;
@synthesize pointsTextField = _pointsTextField;

@synthesize delegate = _delegate;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void) viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];
    [self.cardNameTextField becomeFirstResponder];
}

- (void) viewWillDisappear:(BOOL)animated
{

}

- (BOOL) textFieldShouldReturn:(UITextField *)textField{

    if ([textField.text length]) {
    [self.cardNameTextField resignFirstResponder];

    [self.pinTextField resignFirstResponder];

    [self.pointsTextField resignFirstResponder];

    return YES;
    }

    else {
        return NO;
    }
}

- (void)viewDidLoad
{
    self.cardNameTextField.delegate = self;
    self.pinTextField.delegate = self;
    self.pointsTextField.delegate = self;
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
}

- (void)viewDidUnload
{
    [self setCardNameTextField:nil];
    [self setPinTextField:nil];
    [self setPointsTextField:nil];
    [super viewDidUnload];
    // Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

- (IBAction)addCard:(id)sender 
{
    Card *myNewCard = [[Card alloc] init];

    myNewCard.name = self.cardNameTextField.text;

    myNewCard.pin = self.pinTextField.text;

    myNewCard.points = [self.pointsTextField.text intValue];

    // to check if the text fields were filled up by the user
    if ([self.cardNameTextField.text length] && [self.pinTextField.text length] && [self.pointsTextField.text length]) 
    {

        [[self presentingViewController] dismissModalViewControllerAnimated:YES];

        NSLog(@"name saved %@", myNewCard.name);
        NSLog(@"pin saved %@", myNewCard.pin);
        NSLog(@"points saved %i", myNewCard.points);

        [self.delegate addCardViewController:self didCreateCard:myNewCard];

        // to check if there is a delegate
         if (self.delegate){
            NSLog(@"delegate is not nil");
        }

    }
}

@end 
```

卡片.h

```
#import <Foundation/Foundation.h>

@interface Card : NSObject

    @property (nonatomic, strong) NSString *name;
    @property (nonatomic, strong) NSString *pin;
    @property (nonatomic) int points;

@end 
```

卡.m

```
#import "Card.h"

@implementation Card

@synthesize name = _name;
@synthesize pin = _pin;
@synthesize points = _points;

@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T03:23:44.947

在任何人开始深入探讨这个问题之前，我应该先解决这个明显的问题——在添加新卡后，您是否有某种机制来重新加载数据（例如`tableView reloadData`，从 调用 [ ] `CardWalletViewController`）？我没有看到类似的东西，每当我向表格添加新内容时，我总是使用它。*

*如果表格包含太多数据，您可能只想重新加载其中的一部分。

## 更新 1：类继承

每个Objective C 类都必须从层次结构中的某个其他类继承。默认情况下，除非您另有说明，否则您的所有自定义类都将继承自 NSObject，这是目前最通用的对象（如果您做过 Java 编程，则相当于 Object）。更改父类只需`:`在接口声明之后更改类即可。因此，当您说
`@interface CardWalletViewController : UIViewController <UITableViewDelegate, UITableViewDataSource>`
您所说的是“声明一个`CardWallerViewController`继承`UIViewController`并实现`UITableViewDelegate`and`UITableViewDataSource`协议的自定义类”时（如果您不知道协议是什么，请询问）。

现在，回到你的问题。现在更改父类应该很容易 - 您只需将其更改`: UIViewController`为即可`: UITableViewController`。完成此操作后，您的 CardWallerViewController（也称为“Waller”，真的吗？）将表现得像 a `UITableView`，而不像 generic `UIView`。这样做时，您也不需要告诉它实现委托和数据源协议 -`UITableViewController`默认情况下会这样做。

最后一点，当你向 Xcode 项目添加新文件时，你可以告诉程序你想从哪个类继承。对于视图，它默认为 UIView，但这仅仅是因为这是最通用的视图类。当您开始使用更具体的类（`UITableViewController`、`UIPickerViewController`、`UITableViewCell`等）时，立即更改父类将证明是非常有帮助的。

## 更新 2：UITableViewCells

你要去的那个for循环有很多（相对）你不需要做的工作。由于您的表格直接对应于您的 myWallet 属性，这意味着表格第 N 行中的单元格将代表数组索引 N 处的卡片。你可以利用它来发挥你的优势。在该`tableView:cellForRowAtIndexPath:`方法中，您告诉程序如何处理特定 indexPath 处的单元格（实际上只是该表的部分 + 行）。诀窍是，此方法一次实例化一个单元格。所以不要做for循环，你可以说（最后）
`cell.textLabel.text = [self.myWallet objectAtIndex:indextPath.row].name;`

对于第 N 行中的任何单元格，这将查看内部的第 N 个 Card 对象`myWallet`并使用其名称来设置单元格的`textLabel.text`. 如果它给您带来问题，请保存`[self.myWallet objectAtIndex:indextPath.row]`在一些 tempCard 对象中，然后执行`cell.textLabel.text = tempCard.name`. 这也是在 tableView 中填充单元格的正确方法 - 您一次只关心一个单元格，因为无论如何这就是该方法的工作方式。想象一下，如果您的数组中有 1,000,000 张卡片 - 执行 for 循环将迫使程序为每个单元格遍历数组 1,000,000 次。向 1,000,000,000,000 次操作问好 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T04:53:18.537

我想你可以将图像视图作为子视图添加到单元格

```
 UIImageView *imageView = [[UIImageView alloc] initWithFrame:cell.frame]; 

UIImage *image = [UIImage imageNamed:@"LightGrey.png"];

imageView.image = image;

 [cell addSubview:imageView];  

[[cell textLabel] setBackgroundColor:[UIColor clearColor]];

[[cell detailTextLabel] setBackgroundColor:[UIColor clearColor]]; 
```

# ajax - JSON 返回 AJAX 后 jQuery 未定义

> ID：10201866
> 
> 赞同：0
> 
> 时间：2012-04-18T02:13:03.710
> 
> 标签：ajax, json, validation, jquery-mobile, jsonlint

我正在使用 jQuery 获取名称列表作为 JSON 字符串 -

`

```
$.ajax({ type: 'POST', url: "../Names.aspx", dataType: 'json', contentType: "application/json; charset=utf-8", data: "NAME=ALL_PROFILES", success: function (data, textStatus, jqXHR)` {

                var html = '';

                var obj = jQuery.parseJSON(data);
                $.each(obj, function (key, val) {
                    html += '<option value="' + val + '">' + val + '</option>';
                    alert("Success" + val);
                })
                $('#selName').append(html);
                $('#selName').selectmenu('refresh');

            },
                error: function (jqXHR, textStatus, errorThrown) {
                    alert('Error ' + jqXHR.val + errorThrown.val + textStatus.val);
                }
            }); 
```

后端是一个 asp.net 页面，当我调试时，我得到的字符串为`"{"Name":["Maria","John","Raj","Rosh","Tony","Name","test3","test4","test5","test6"]}"`，我将其放入[JSONLint](http://www.jsonlint.org)并进行了验证。它在上面的 AJAX 请求中返回`undefined`错误。如果我尝试使用单个字符串`"Name":"John"`，它会完美运行。添加选项的函数对于 JSON 字符串数组不正确（一旦进入成功块，我将处理它），但我不明白为什么它`undefined`在返回有效 JSON 字符串时返回错误。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T01:47:46.690

在结果周围加上一个额外的括号，它就可以工作了。这很奇怪，因为 JSONLint 现在没有验证它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T02:33:29.357

如果您的 aspx 页面返回有效的 JSON 并且您正在使用`dataType: 'json'`，则不应`jQuery.parseJSON()`在返回的数据上使用，因为 jQuery 已经将返回的 JSON 字符串解析为对象。

如果使用`"Name":"John"`的是无效的 JSON，那么 JQuery 会进入`error`回调。

# macos - AppleScript 可以在一个应用程序中读取鼠标位置/动作并将其复制到另一个应用程序中吗？

> ID：10201868
> 
> 赞同：0
> 
> 时间：2012-04-18T02:13:28.990
> 
> 标签：macos, applescript, mouse

我一直在为 Mac 寻找鼠标广播器，似乎没有解决方案，所以我现在必须寻找替代解决方案。我想知道 AppleScript 是否能够执行这样的任务。基本上，只要脚本处于活动状态，我想做的是在一个应用程序中执行时读取鼠标位置和动作，并在一个或多个其他应用程序中广播/复制它。AppleScript 能做到这一点吗？

澄清一下，我需要在其他应用程序中模拟鼠标移动......例如，如果我打开一个绘图程序的多个实例，假设该程序具有相同的分辨率，我在主程序中绘制的任何东西，将在其他程序上复制。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T15:17:32.637

真的 applescript 不能做你需要的。它不是为此而生的。Applescript 用于运行应用程序的 applescript 字典中的命令。我假设您要控制的应用程序字典让您无法阅读和控制鼠标。

不过，您确实有一个 applescript 替代方案。我制作了一个命令行工具来读取鼠标位置并移动鼠标。所以理论上你可以用applescript和我的工具做你想做的事。我不相信你会得到你期望的结果。反正你可以试试。这是我的工具的网页链接。我希望它有所帮助。 [在这里得到它。](http://www.hamsoftengineering.com/codeSharing/MouseTools/MouseTools.html) 您的基本方法可能是 1）激活要读取鼠标位置的应用程序，2）在重复循环中运行我的工具并记录鼠标位置，3）激活要复制鼠标移动的第二个应用程序，4）使用我的工具重复循环，使鼠标根据您的记录方式移动。

# hibernate - 如何让hibernate hbm2ddl生成带分号的SQL？

> ID：10201869
> 
> 赞同：5
> 
> 时间：2012-04-18T02:13:59.890
> 
> 标签：hibernate, hbm2ddl

我使用休眠 hbm2ddl 从实体类生成数据库模式脚本。它运行良好，但每一行都没有分号结束，这让我不得不手动添加它们。有什么办法可以让我摆脱这份愚蠢的工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T05:36:23.037

直接使用 SchemaExport 很简单：

```
new SchemaExport(config).setDelimiter(";").Execute(...); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-04-18T18:58:24.890

您可以在 Hibernate 属性中设置为，或者[`hibernate.hbm2ddl.delimiter`](https://docs.jboss.org/hibernate/orm/5.2/userguide/html_single/appendices/Configurations.html)如果您以编程方式配置 Hibernate ，则设置为。`;`[`AvailableSettings.HBM2DDL_DELIMITER`](https://docs.jboss.org/hibernate/orm/5.2/javadocs/org/hibernate/cfg/AvailableSettings.html#HBM2DDL_DELIMITER)`;`

# java - 将字节数组转换为整数

> ID：10201876
> 
> 赞同：0
> 
> 时间：2012-04-18T02:14:30.247
> 
> 标签：java

我有一个字节数组，我想将它们转换为整数。怎么做？我的代码如下：

```
byte[] bytes = new byte[]{(byte)0xFF, (byte)0x01, (byte)0x0F, ...};
int[] integers = new int[bytes.length];
int i;
for(i = 0; i < bytes.length; i++) {
integers[i] = bytes[i];
} 
```

以 {-1, 1, 15, ...} 形式获取整数数组。但我想得到的是 {255, 1, 15, ...}。有什么功能可以到达吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T02:16:23.950

尝试：

```
integers[i] = (int)bytes[i] & 0xff; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-16T18:46:28.007

我创建了这个类供我个人使用，但我认为它可以帮助你解决你的问题。

```
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.lang.reflect.Array;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
import java.util.HashMap;
import java.util.Map;

public class ArrayUtils {

    private static final Logger log = LoggerFactory.getLogger(ArrayUtils.class);
    private static final Map<Class, Class> primitiveMapping = new HashMap<Class, Class>();
    private static final Map<Class, Method> primitiveParseMethodLookup = new HashMap<Class, Method>();
    private static final Map<Class, Method> primitiveArrayGetMethodLookup = new HashMap<Class, Method>();
    private static final Map<Class, Method> valueOfMethodLookup = new HashMap<Class, Method>();

    static {

        // Initialize primitive mappings
        primitiveMapping.put(boolean.class, Boolean.class);
        primitiveMapping.put(byte.class, Byte.class);
        primitiveMapping.put(short.class, Short.class);
        primitiveMapping.put(int.class, Integer.class);
        primitiveMapping.put(float.class, Float.class);
        primitiveMapping.put(long.class, Long.class);
        primitiveMapping.put(double.class, Double.class);

        // Initialize parse, valueOf and get method lookup
        // We do that in advance because the lookup of the method takes the longest time
        // Compared to the normal method call it's 20x higher
        // So we use just the reflective method call which takes double the time of a normal method call
        try {
            primitiveParseMethodLookup.put(boolean.class, Boolean.class.getMethod("parseBoolean", new Class[]{String.class}));
            primitiveParseMethodLookup.put(byte.class, Byte.class.getMethod("parseByte", new Class[]{String.class}));
            primitiveParseMethodLookup.put(short.class, Short.class.getMethod("parseShort", new Class[]{String.class}));
            primitiveParseMethodLookup.put(int.class, Integer.class.getMethod("parseInt", String.class));
            primitiveParseMethodLookup.put(float.class, Float.class.getMethod("parseFloat", String.class));
            primitiveParseMethodLookup.put(long.class, Long.class.getMethod("parseLong", String.class));
            primitiveParseMethodLookup.put(double.class, Double.class.getMethod("parseDouble", String.class));

            valueOfMethodLookup.put(Boolean.class, Boolean.class.getMethod("valueOf", new Class[]{String.class}));
            valueOfMethodLookup.put(Byte.class, Byte.class.getMethod("valueOf", new Class[]{String.class}));
            valueOfMethodLookup.put(Short.class, Short.class.getMethod("valueOf", new Class[]{String.class}));
            valueOfMethodLookup.put(Integer.class, Integer.class.getMethod("valueOf", String.class));
            valueOfMethodLookup.put(Float.class, Float.class.getMethod("valueOf", String.class));
            valueOfMethodLookup.put(Long.class, Long.class.getMethod("valueOf", String.class));
            valueOfMethodLookup.put(Double.class, Double.class.getMethod("valueOf", String.class));

            primitiveArrayGetMethodLookup.put(boolean.class, Array.class.getMethod("getBoolean", new Class[]{Object.class, int.class}));
            primitiveArrayGetMethodLookup.put(byte.class, Array.class.getMethod("getByte", new Class[]{Object.class, int.class}));
            primitiveArrayGetMethodLookup.put(short.class, Array.class.getMethod("getShort", new Class[]{Object.class, int.class}));
            primitiveArrayGetMethodLookup.put(int.class, Array.class.getMethod("getInt", Object.class, int.class));
            primitiveArrayGetMethodLookup.put(float.class, Array.class.getMethod("getFloat", Object.class, int.class));
            primitiveArrayGetMethodLookup.put(long.class, Array.class.getMethod("getLong", Object.class, int.class));
            primitiveArrayGetMethodLookup.put(double.class, Array.class.getMethod("getDouble", Object.class, int.class));
        } catch (NoSuchMethodException e) {

            //******************************
            // This can never happen
            //******************************
        }

    }

    public static boolean isArrayOfPrimitives(Object object) {

        if (object.getClass().isArray()) {
            return object.getClass().getComponentType().isPrimitive();
        }

        return false;
    }

    public static boolean isArrayOf(Object object, Class clazz) {

        if (object.getClass().isArray()) {
            return clazz.isAssignableFrom(object.getClass().getComponentType());
        }

        return false;
    }

    /**
     * Convert any array of primitives(excluding char), strings or numbers into any other array
     * of strings or numbers.
     *
     * @param array                       Array of primitives(excluding char), strings or numbers
     * @param convertedArrayComponentType Converted array component type (String or Number)
     * @param <T>                         To allow implicit casting
     * @return Array of convertedArrayComponentType
     */
    public static <T> T[] convertArray(Object array, Class<T> convertedArrayComponentType) {

        // Collect data regarding arguments
        final boolean arrayOfPrimitives = isArrayOfPrimitives(array);
        final boolean arrayOfCharPrimitives = isArrayOf(array, char.class);
        final boolean arrayOfCharacters = isArrayOf(array, Character.class);
        final boolean arrayOfStrings = isArrayOf(array, String.class);
        final boolean arrayOfNumbers = isArrayOf(array, Number.class);

        // Check if array is an array of strings, primitives or wrapped primitives
        if (!arrayOfPrimitives && !arrayOfNumbers && !arrayOfStrings || arrayOfCharPrimitives || arrayOfCharacters) {
            throw new IllegalArgumentException(array + " must be an array of of strings, primitives or boxed primitives (byte, boolean, short, int, float, long, double)");
        }

        // Check if it's assignable from Number of String
        if (!Number.class.isAssignableFrom(convertedArrayComponentType) && !String.class.isAssignableFrom(convertedArrayComponentType)) {
            throw new IllegalArgumentException(convertedArrayComponentType + " must be a Number or a String");
        }

        try {
            return (T[]) convertArrayInternal(array, convertedArrayComponentType);
        } catch (InvocationTargetException e) {

            // This can happen due to errors in conversion
            throw (RuntimeException) e.getTargetException();
        } catch (Exception e) {

            // This should never happen
            log.error("Something went really wrong in ArrayUtils.convertArray method.", e);
        }

        // To satisfy the compiler
        return null;
    }

    /**
     * Convert any array of primitives(excluding char), strings or numbers into an array
     * of primitives(excluding char).
     *
     * @param array                       Array of primitives(excluding char), strings or numbers
     * @param convertedArrayComponentType Converted array component type primitive(excluding char)
     * @return Array of convertedArrayComponentType
     */
    public static Object convertToPrimitiveArray(Object array, Class convertedArrayComponentType) {

        // Collect data regarding arguments
        final boolean arrayOfPrimitives = isArrayOfPrimitives(array);
        final boolean arrayOfCharPrimitives = isArrayOf(array, char.class);
        final boolean arrayOfCharacters = isArrayOf(array, Character.class);
        final boolean arrayOfStrings = isArrayOf(array, String.class);
        final boolean arrayOfNumbers = isArrayOf(array, Number.class);

        // Check if array is an array of strings, primitives or wrapped primitives
        if (!arrayOfPrimitives && !arrayOfNumbers && !arrayOfStrings || arrayOfCharPrimitives || arrayOfCharacters) {
            throw new IllegalArgumentException(array + " must be an array of of strings, primitives or boxed primitives (byte, boolean, short, int, float, long, double)");
        }

        // Check if it's assignable from Number of String
        if (!convertedArrayComponentType.isPrimitive() || convertedArrayComponentType.isAssignableFrom(char.class)) {
            throw new IllegalArgumentException(convertedArrayComponentType + " must be a primitive(excluding char)");
        }

        try {
            return convertArrayInternal(array, convertedArrayComponentType);
        } catch (InvocationTargetException e) {

            // This can happen due to errors in conversion
            throw (RuntimeException) e.getTargetException();
        } catch (Exception e) {

            // This should never happen
            log.error("Something went really wrong in ArrayUtils.convertArray method.", e);
        }

        // To satisfy the compiler
        return null;
    }

    private static Object convertArrayInternal(Object array, Class convertedArrayComponentType) throws NoSuchMethodException, InvocationTargetException, IllegalAccessException {

        // Lookup the primitive parse method or the boxed primitive valueOf method
        final Method convertMethod;
        if (convertedArrayComponentType.isPrimitive()) {
            convertMethod = primitiveParseMethodLookup.get(convertedArrayComponentType);
        } else {
            convertMethod = valueOfMethodLookup.get(convertedArrayComponentType);
        }

        // If the array is an array of primitives lookup the get method
        final Method primitiveArrayGetMethod = primitiveArrayGetMethodLookup.get(array.getClass().getComponentType());

        // Get length and create new array
        final int arrayLength = Array.getLength(array);
        final Object castedArray = Array.newInstance(convertedArrayComponentType, arrayLength);

        for (int i = 0; i < arrayLength; i++) {

            final Object value;
            if (primitiveArrayGetMethod != null) {
                value = primitiveArrayGetMethod.invoke(null, array, i);
            } else {
                value = Array.get(array, i);
            }

            final String stringValue = String.valueOf(value);
            final Object castedValue = convertMethod.invoke(null, stringValue);
            Array.set(castedArray, i, castedValue);
        }

        return castedArray;
    }

} 
```

您不能在 java 中执行此操作，因为类型都已签名。一个字节可以保存从 -128 到 127 的值。要实现这一点，您可以使用

```
short[] bytes = new short[]{(short)0xFF, (short)0x01, (short)0x0F};
Integer[] integers = ArrayUtils.convertArray(bytes, Integer.class);
int[] ints = (int[]) ArrayUtils.convertToPrimitiveArray(bytes, int.class); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-18T02:23:02.427

整数[i] = (uint8_t)(字节[i] & 0xff);

会给你 255 而不是 -1。〜本

# jquery - jquery缩略图滑块覆盖的弹出菜单

> ID：10201877
> 
> 赞同：0
> 
> 时间：2012-04-18T02:14:48.750
> 
> 标签：jquery, css, layer, overlap

我正在创建一个需要在同一页面上显示弹出菜单和缩略图滑块的站点。

我将这种技术用于弹出菜单： [http ://designshack.net/articles/pop-out-css-menu/](http://designshack.net/articles/pop-out-css-menu/)

还有这个滑块插件：http: [//manos.malihu.gr/jquery-custom-content-scroller](http://manos.malihu.gr/jquery-custom-content-scroller)

它们单独工作正常，但是当我将它们添加到同一页面时，滑块与弹出菜单中的二级菜单项重叠。我试过玩 z-index 但没有帮助。无论如何，是否有次要项目始终显示在所有内容之上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T02:24:31.380

在第 41 行的 menu.css 中，在此处设置 z-index：

```
#menu ul ul ul {
  position: absolute;
  top: 0;
  left: 100%;
  width: 85%;
  z-index: 30;
} 
```

# c++ - 在头文件中执行 const std::string 的正确方法？

> ID：10201880
> 
> 赞同：15
> 
> 时间：2012-04-18T02:15:32.983
> 
> 标签：c++, static, constants, stdstring

我正在编写一个 Cocos2D-X 游戏，其中玩家、敌人和其他角色将他们的属性存储在 a`CCMutableDictionary`中，这在某种程度上是`std::map<std::string, CCObject*>`. 可以通过该`CCMutableDictionary::objectForKey(const std::string& key)`方法访问字典中的值。

现在，在我的许多 .cpp 文件包含的头文件中，我有一些`const char * const`字符串用于访问字典中的值，如下所示：

```
// in Constants.h
const char* const kAttributeX = "x";
const char* const kAttributeY = "y";

// in a .cpp file
CCObject* x = someDictionary->objectForKey(kAttributeX); 
```

所以，如果我错了，请纠正我，但是每次我使用 a 调用上述方法之一时，都会调用`std::string`' 的复制构造函数并且临时在堆栈上，对吗？`std::string``objectForKey``const char* const`

如果是这样，我觉得如果这些常量属性键已经是`std::string`对象，那么在运行时会更有效。但是我该如何以*正确*的方式做到这一点？

像下面这样在 Constants.h 文件中定义它们可以很好地编译，但我觉得有些事情是不对的：

```
// in Constants.h
const std::string kAttributeX = "x";
const std::string kAttributeY = "y"; 
```

如果这个问题已经被问到，我很抱歉。我似乎无法在 StackOverflow 上找到我正在寻找的确切答案。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-04-18T02:22:30.583

您编写的代码非常好，至少因为您只有一个源文件中`#include`的文件。`Constants.h`如果您在多个源文件中使用头文件，您将多次定义相同的变量。头文件中常量的正确使用是将它们拆分为`Constants.h`包含变量*声明*`Constants.cpp`的头文件 ( ) 和包含变量*定义*的源文件 ( ) ：

头文件：

```
#ifndef CONSTANTS_H
#define CONSTANTS_H

extern const std::string kAttributeX;
extern const std::string kAttributeY;

#endif 
```

源文件：

```
const std::string kAttributeX = "x";
const std::string kAttributeY = "y"; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-02-22T13:27:30.703

您的第二个选项会导致在每个翻译单元（包含标头的 cpp 文件）中创建每个变量，这将略微增加代码大小并增加一些运行时成本（在启动期间构建所有这些字符串并在过程中破坏它们终止）。

[Joachim 建议](https://stackoverflow.com/a/10201929/3848)的解决方案有效，但我发现分别声明和定义变量有点麻烦。我个人讨厌重复自己，也不喜欢一遍又一遍地说同样的话……

我不知道在 C++ 中是否有一个好的解决方案，但是我使用过的编译器都支持类似的东西，[`__declspec( selectany )`](https://msdn.microsoft.com/en-us/library/5tkz6s71.aspx)这样您就可以在头文件中定义变量并且只实例化一个对象（而不是每个翻译一个单元）。

```
__declspec( selectany ) extern const std::string kAttributeX = "x"; 
```

（为什么两者都`extern`看 `const`这个[答案](https://stackoverflow.com/a/1358796/3848)）。

您仍然有在进程启动期间支付所有全局变量的初始化价格的缺点。这在 101% 的情况下是可以接受的（给予或接受 2%），但您可以通过使用惰性对象来避免这种情况（我在[这里写过类似的东西](https://lanzkron.wordpress.com/2012/09/27/global-bstrs/)）。

# video - ActionScript：如何将 SWF 视频加载到 MovieClip 并操作视频中的所有帧

> ID：10201885
> 
> 赞同：0
> 
> 时间：2012-04-18T02:15:46.760
> 
> 标签：video, actionscript, flash, frames, movieclip

```
private function onLoadComplete(event:Event) : void
    {
        movieClip = new MovieClip();
        movieClip.addChild(mcLoader);
        addChild(movieClip);
        trace(movieClip.totalFrames);
    } 
```

mcLoader 用于加载外部 .swf 文件，该文件是我从 .flv 转换而来的视频文件。视频播放良好，但跟踪输出 1，这意味着影片剪辑中只有 1 帧，这不是我想要的。我以为我可以操纵视频中的所有帧。

# ruby-on-rails-3.1 - Rails：从 MongoMapper 转换为 Mongoid：为什么我不能使用 Model.find 通过 :_id 找到模型？

> ID：10201887
> 
> 赞同：0
> 
> 时间：2012-04-18T02:16:04.650
> 
> 标签：ruby-on-rails-3.1, mongoid, mongomapper

在带有 Mongoid 2.4、BSON 1.5 的 Rails 3.1 上

我无法使用 Mongoid 的 Model.find 通过 :_id 找到模型

在哪里使用：

```
>> Athlete.where(:_id => BSON::ObjectId.from_string('4f2b22d70f67e90001001edd')).first
=> #<Athlete _id: 4f2b22d70f67e90001001edd, ...> 
```

使用查找：

```
>> Athlete.find('4f2b22d70f67e90001001edd')
=> nil 
```

知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T19:10:21.910

您需要手动构建您的 mongoid 索引：

```
rake db:mongoid:create_indexes 
```

# django - Django 多表继承，Django-model-utils 错误

> ID：10201890
> 
> 赞同：1
> 
> 时间：2012-04-18T02:16:10.420
> 
> 标签：django, inheritance, multi-table

我正在为我的车库商店做一个爱好项目。我被引导到 django-model-utils 来满足我的需要。（我有串口CNC机，串口机有两种流控方式）

我有一个 SerialMachine 的父类（定义地址、波特率、通用 RS-232 定义）

然后我有继承自 SerialMachine 的 HardwareFlowControlMachine 模型（定义 CTS/DTR/等）

因此，当我将机器名称放入表单（例如机器 001）时，我有一个获取机器设置的功能。

```
def getMachineSettings(machine):

    from src.apps.cnc.models import SerialMachine

    machineSettings = SerialMachine.objects.get(machineName=machine).select_subclasses()

    return machineSettings 
```

我得到这个例外：

```
 DatabaseError: no such column: cnc_hardwareflowcontrolmachine.serialmachine_ptr_id 
```

现在进行测试，我在 SoftwareFlowControlMachine 中只有一台机器（硬件中没有）

我想也许 HardwareFlowControlMachine 出于某种原因至少需要一个对象。因此，当我转到 /admin/ 并尝试将机器添加到 SoftwareFlowControlMachine 或 HardwareFlowControlMachine 时，我得到了这个异常：

硬件流量控制机：

```
DatabaseError at /admin/cnc/hardwareflowcontrolmachine/

no such column: cnc_hardwareflowcontrolmachine.serialmachine_ptr_id

Request Method:     GET
Request URL:    http://127.0.0.1:8000/admin/cnc/hardwareflowcontrolmachine/
Django Version:     1.4
Exception Type:     DatabaseError
Exception Value:    

no such column: cnc_hardwareflowcontrolmachine.serialmachine_ptr_id

Exception Location:     C:\Python27\lib\site-packages\django\db\backends\sqlite3\base.py in execute, line 337
Python Executable:  C:\Python27\python.exe
Python Version:     2.7.2 
```

软件流控机：

```
DatabaseError at /admin/cnc/softwareflowcontrolmachine/

no such column: cnc_softwareflowcontrolmachine.serialmachine_ptr_id

Request Method:     GET
Request URL:    http://127.0.0.1:8000/admin/cnc/softwareflowcontrolmachine/
Django Version:     1.4
Exception Type:     DatabaseError
Exception Value:    

no such column: cnc_softwareflowcontrolmachine.serialmachine_ptr_id

Exception Location:     C:\Python27\lib\site-packages\django\db\backends\sqlite3\base.py in execute, line 337
Python Executable:  C:\Python27\python.exe
Python Version:     2.7.2 
```

如果我需要提供更多信息，请告诉我。我真的不确定我错过了什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T06:34:28.273

我让它工作了。我仍然不清楚它为什么会发生。我犯的一个错误是

```
 machineSettings = SerialMachine.objects.get(machineName=machine).select_subclasses() 
```

我需要这个

```
 machineSettings = SerialMachine.objects.get_subclass(machineName=machine) 
```

我也刚刚删除了我的数据库并重新制作了它。

希望这对其他人也有帮助

# autocomplete - 如何在cygwin文件夹自动完成中停用大写检查？

> ID：10201900
> 
> 赞同：9
> 
> 时间：2012-04-18T02:17:19.853
> 
> 标签：autocomplete, cygwin, case-sensitive, case-insensitive

在 Cygwin 下导航文件层次结构`cd + a few characters`时，如果当前文件夹中存在这样的目录，则在之后按 Tab 键将用名称以相同字符开头的目录的名称替换这几个字符。但是，该测试似乎区分大小写。如何禁用区分大小写？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-18T02:20:08.197

尝试：

```
 set completion-ignore-case On 
```

（这是用于 bash 的，我很确定 cygwin 会使用它。）

**编辑：** 此更改仅在您当前的 shell 会话期间生效。要使其永久化，您需要将该行添加到您的`~/.inputrc`文件中。

# python - 将 iterable1 的 n 个元素与 iterable2 的 m 个元素组合

> ID：10201901
> 
> 赞同：0
> 
> 时间：2012-04-18T02:17:20.747
> 
> 标签：python, itertools

如何将 iterable1 中的 n 个项目与 iterable2 中的 m 个项目结合起来？

IE

```
iterable1 = [0,1,2,3,4]
iterable2 = ['a','b','c']
BlackBox(itertools.combination(iterable1, 2),itertools.combination(iterable2, 1)) yields
(0,1,'a'), (0,1,'b'), (0,1,'c'), (0,2,'a'), (0,3,'a'), etc. Order doesn't matter 
```

我收到一个元素列表，其中可能包含一个通配符，然后我需要用通配符的所有可能值替换它。我检查通配符的数量，并需要将这么多元素的组合添加到我的去通配符列表中。换句话说，iterable2 是通配符的所有可能值，m 是通配符的数量，iterable1 是删除了所有通配符的原始列表，n 是减去 m 的所需项目数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T02:36:30.163

```
>>> iterable1 = [0,1,2,3,4]
>>> iterable2 = ['a','b','c']
>>> import itertools as it
>>> list(x+y for x,y in it.product(it.combinations(iterable1, 2), it.combinations(iterable2, 1)))
[(0, 1, 'a'), (0, 1, 'b'), (0, 1, 'c'), (0, 2, 'a'), (0, 2, 'b'), (0, 2, 'c'), (0, 3, 'a'), (0, 3, 'b'), (0, 3, 'c'), (0, 4, 'a'), (0, 4, 'b'), (0, 4, 'c'), (1, 2, 'a'), (1, 2, 'b'), (1, 2, 'c'), (1, 3, 'a'), (1, 3, 'b'), (1, 3, 'c'), (1, 4, 'a'), (1, 4, 'b'), (1, 4, 'c'), (2, 3, 'a'), (2, 3, 'b'), (2, 3, 'c'), (2, 4, 'a'), (2, 4, 'b'), (2, 4, 'c'), (3, 4, 'a'), (3, 4, 'b'), (3, 4, 'c')] 
```

# python - xml定义中的Python BeautifulSoup双问号

> ID：10201910
> 
> 赞同：0
> 
> 时间：2012-04-18T02:18:40.933
> 
> 标签：python, xml, xhtml, beautifulsoup

我认为这一定是一个错误，所以我[在这里](https://bugs.launchpad.net/beautifulsoup/+bug/984258)发布了一个错误报告。另一方面，我可能会遗漏一些东西，所以我需要再看一下代码。

问题是，当我使用 .xhtml 文件的内容初始化 BeautifulSoup 时，xml 定义的末尾会出现两个问号。

你能重现这个问题吗？有没有办法避免它？我是否缺少函数、方法、参数或其他东西？

**Edit0：**它是 Python 2.x 上的 BeautifulSoup 4。

**Edit1：**为什么要投票？

* * *

问题：

```
<?xml version="1.0" encoding="UTF-8"??> 
```

终端输出：

```
>>> from bs4 import BeautifulSoup as bs
>>> with open('example.xhtml', 'r') as f:
...     txt = f.read()
...     soup = bs(txt)
... 
>>> print txt
<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta charset="utf-8"/>
    </head>
    <body>
    </body>
</html>

>>> print soup
<?xml version="1.0" encoding="UTF-8"??>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta charset="utf-8"/>
</head>
<body>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T12:49:48.737

这是一个错误。我已经提交了一个修复，它将在 Beautiful Soup 的下一个版本中发布。

[根本原因：](http://docs.python.org/library/htmlparser.html#HTMLParser.HTMLParser.handle_pi)

> HTMLParser 类使用 SGML 句法规则来处理指令。使用尾随 '?' 的 XHTML 处理指令 会导致'?' 被包含在数据中。

一般来说，正如 ThiefMaster 建议的那样，使用“xml”解析器解析 XHTML 会得到更好的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T06:42:03.917

考虑使用 XML 解析器：

```
soup = bs(txt, 'xml') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T06:33:45.140

在 example.xhtml 文件中使用“txt”中的变量内容我无法重现 Python2.7 和相应的 BeautifulSoup 模块（不是 bs4）的问题。对我来说工作得很好而且花花公子。

```
>>> soup = BeautifulSoup.BeautifulSoup(txt)
>>> print soup
<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta charset="utf-8" />
</head>
<body>
</body>
</html> 
```

你遇到的问题是什么，你的最终目标是什么，也许somoone可以建议一个解决方法

# c++ - project00.exe 中 0x93b3237d 处未处理的异常：0xC0000005：访问冲突

> ID：10201911
> 
> 赞同：0
> 
> 时间：2012-04-18T02:18:43.093
> 
> 标签：c++, assembly, x86

在我的程序中，当我退出 ASM 代码部分并返回到 C++ 代码时，我在 project00.exe 中的 0x93b3237d 处得到未处理的异常：0xC0000005：访问冲突。在 Crtexe.c 中 mainret = main(argc, argv, envp); 并在将 0C 添加到 ESP 时进行反汇编。我认为问题可能是主函数的返回地址在返回之前被损坏并导致它失败。程序找到两个集合的交集和并集。使用 VS10 并没有想法。

```
 include "iostream.h"//modify line to show up in code block

    using namespace std;

    typedef int DWORD;      //4 btye double word
    typedef char BYTE;      //1 byte 
    typedef short WORD;     //2 byte double word

    int main(){ 

    int i =0;
    BYTE str0[50] = "1qaz2wsx3edc4rfv5tgb6yhn7ujm8ik,9ol.0p;/-[?]F!Q"; 
    BYTE str1[50] ="QAZ@WSX#EDC$RFV%TGB^YHN&UJM*IK)P:?_{?}|1`"; 
    DWORD length0 ; 
    DWORD length1 ;
    BYTE IntersectArray[50]; 
    BYTE result [100] ;

    __asm{
    p:
    pusha
    lea eax, str0
    call COUNT 
    mov length0,ecx
    lea eax, str1
    call COUNT 
    mov length1,ecx
    call INTERSECTION
    call JoinSet
    xor eax,eax
    popa
    ret

    COUNT: 
    mov ecx,0;
    Q: mov dl, [eax]
    cmp dl,0h
    JE cEND
    inc eax
    inc ecx
    jmp Q
    cEnd: ret

    INTERSECTION:
        lea edx, str0
        mov ebx, length0
        lea esi, IntersectArray
        first: mov al, [edx]
        mov ecx, length1
        lea edi, str1
        repne SCASB
        cmp ecx,0
        JNZ INTER
    Back:   inc edx
        cmp ebx,0
        JZ EXITSTUFF
        dec ebx
        jmp first

    INTER: mov [esi] , al
       inc esi
       jmp Back

    EXITSTUFF:
        mov [esi], 0
        ret

    JoinSet :
        lea edi, result
        lea esi, str0
        mov ecx, length0
        REP MOVSB   

            lea edx, str1
        mov ebx, length1
        lea esi, result + [ebx]
        f: mov al, [edx]
        mov ecx, length0
        lea edi, str0
        repne SCASB
        cmp ecx,0
        JNZ B
         mov [esi] , al
           inc esi
    B:      inc edx
        cmp ebx,0
        JZ EXITSTU
        dec ebx
        jmp f

    EXITSTU:
        mov [esi], 0
        ret
    } 
```

休息

```
 for(int i =0;i < 50;i++){
cout <<IntersectArray[i];}
cout << endl;
for (int i =0; i<100;i++)
cout <<result[i];
cout << endl;
system("pause");
return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T10:00:35.923

可能是一个愚蠢的评论，因为我从未做过任何 x86 汇编。但我认为 asm 是内联的？那么你的第一个'ret'实际上是从什么返回的？

# jquery - 在rails应用程序中的AJAX链接后使用后退/前进仅显示部分

> ID：10201912
> 
> 赞同：0
> 
> 时间：2012-04-18T02:18:52.003
> 
> 标签：jquery, ajax, ruby-on-rails-3.2

在我的 Rails 应用程序中，我第一次开始修改 AJAX，虽然我的工作非常出色，但它有一个不寻常的行为：使用 AJAX 链接后回击或前进只会给你未渲染的 AJAX 拉取部分以纯文本形式。

如何解决这个问题？我在 Google 上找不到与此特定问题有关的任何内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T02:37:34.067

对于其他有此问题的人，我找到了罪魁祸首。页面上有几个 javascript 链接，它们的 href 设置为`#`在单击时会与浏览器的历史记录混淆。替换`#`为`javascript:void(0)`修复问题，提供预期的 AJAX 历史行为。

# mysql - 为除一个/几个表之外的所有表授予 [几乎] 所有 mySQL 权限

> ID：10201913
> 
> 赞同：4
> 
> 时间：2012-04-18T02:18:57.470
> 
> 标签：mysql, database

# 问题：

我怎样才能给新用户几乎所有的权限，但仍然保护一个或多个表/数据库不受它们的影响。

# 细节：

如果我有一个数据库，

*   `life`

还有三张桌子

*   `passwords`
*   `friends`
*   `hobbies`

如何授予该用户，例如，以下权限：

*   插入
*   更新
*   删除
*   创造
*   降低
*   改变

关于前三个，我将从以下内容开始：

```
GRANT INSERT, UPDATE, DELETE ON life.friends TO username@'localhost' IDENTIFIED BY 'password';
GRANT INSERT, UPDATE, DELETE ON life.hobbies TO username@'localhost' IDENTIFIED BY 'password'; 
```

但我对如何使用`CREATE`and感到困惑`DROP`。如果我像这样授予整个数据库的删除权限：

```
GRANT DROP ON life TO username@'localhost' IDENTIFIED BY 'password'; 
```

然后用户可以删除`passwords`我不想要的表。我可以改为根据如下表格授予它：

```
GRANT DROP ON life.friends TO username@'localhost' IDENTIFIED BY 'password';
GRANT DROP ON life.hobbies TO username@'localhost' IDENTIFIED BY 'password'; 
```

但是，如果我授予`CREATE`这样的权限会发生什么：

```
GRANT CREATE ON life TO username@'localhost' IDENTIFIED BY 'password'; 
```

这是否意味着用户甚至不能删除他/她创建的表？我的问题还与创建/删除数据库有关。如果我想允许用户创建和删除尽可能多的**自己的**数据库，而**不是**数据库，该`life`怎么办？

`passwords`我应该通过将表移动到另一个数据库来改变我的方法吗？

提前谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T16:23:32.787

@TheScrumMeister 使用单独数据库的建议的替代方法是定义一个 wraps 的过程`CREATE TABLE`，但也授予调用用户对其的`DROP`权限：

```
DELIMITER ;;

CREATE PROCEDURE create_table(
  tbl_name VARCHAR(64) -- maximum length of a table name
) BEGIN
  DECLARE EXIT HANDLER FOR SQLEXCEPTION ROLLBACK;
  START TRANSACTION;
    SET @usr = SUBSTRING_INDEX(USER(), '@', 1);  -- invoking username
    SET @tbl = REPLACE(tbl_name, "`", "``");     -- prevent SQL injection

    -- just create some dummy table initially - the user can modify it after
    SET @qry = CONCAT("
      CREATE TABLE `", @tbl, "` (
        id INT NOT NULL AUTO_INCREMENT PRIMARY KEY
      );
    ");
    PREPARE stmt FROM  @qry;
    EXECUTE stmt;
    DEALLOCATE PREPARE stmt;

    -- now grant DROP to the invoking user but only from localhost
    SET @qry = CONCAT("
      GRANT DROP ON life.`", @tbl, "`
      TO CONCAT(?, \"@'localhost'\") IDENTIFIED BY 'password';
    ");
    PREPARE stmt FROM  @qry;
    EXECUTE stmt USING @usr;
    DEALLOCATE PREPARE stmt;

    -- clean up
    SET @qry = NULL;
    SET @usr = NULL;
  COMMIT;
END;;

DELIMITER ; 
```

为了确保用户不会以任何其他方式创建表，他们不应该拥有该`CREATE TABLE`权限。

你也可以对数据库做类似的事情。

# ruby - 为什么我的机架服务器仍在运行？

> ID：10201914
> 
> 赞同：1
> 
> 时间：2012-04-18T02:19:10.540
> 
> 标签：ruby, firefox, sinatra, localhost, rack

前段时间，我在github上克隆了一个应用，本地跑起来看看。这是一个在机架上运行的 ruby​​ 应用程序。我用来查看它的端口是 localhost:9292。

快进到今天。我正在尝试运行我编写的一个非常简单的机架应用程序。基本上只是一个班轮学习架。当我访问 localhost:9292 时，我之前下载的旧应用程序出现在我的浏览器中。我不知道为什么会发生这种情况，因为我不需要该应用程序，所以我关闭了所有内容并从我的计算机中删除了那个旧应用程序。然后我再次尝试了“localhost:9292”，奇怪的是，同样的应用程序出现了。

即使我没有运行任何东西，无论是机架还是其他，只要我访问 localhost:9292，我就会出现那个幽灵应用程序。我试过清除缓存和杀掉机架，重新启动 firefox 等。这只发生在 Firefox 上。只有当我使用另一个浏览器时，我才能在 localhost:9292 上得到正确的响应。所以我想这与 Firefox 以某种方式将该端口绑定到其他应用程序有关。

我的问题是如何从 Firefox 中清除此应用程序？在我运行它之后，Firefox 将端口绑定到一个应用程序（字面意思是几个月）的机制是什么。我不相信这是从机架上发生的，因为我想我可以继续使用另一个浏览器，但我真的很想知道是什么导致了这种情况。我一直在寻找这个几个小时，但什么也找不到。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T02:32:46.127

我猜机架即使在它的控制终端消失后也喜欢留下来。

```
ps auxww |grep ruby 
```

你会得到这样的输出：

```
mslade    9159  0.0  1.0 131964 41436 pts/12   Sl+  Apr17   0:38 /usr/bin/ruby1.9.1 script/rails server -p 3001
mslade   19127  0.0  0.0  10776  1008 pts/11   S+   12:30   0:00 grep ruby 
```

顶部的行是您的旧服务器。通过将其 PID（该行左侧的数字）传递给它来杀死它`kill`：

杀9159

或者

杀死-9 9159

这应该够了吧。

如果做不到这一点，你可以重新启动你的机器，当它重新启动时程序就会消失。

# regex - 一些关于正则表达式的问题

> ID：10201915
> 
> 赞同：2
> 
> 时间：2012-04-18T02:19:33.037
> 
> 标签：regex, date

我想将某些子字符串（例如月份中的日期）匹配为字符串中的“21st”或“22nd”或“23rd”，因此我使用此模式制作了一个正则表达式：

```
((\d{1,2})(st)|(nd)|(rd)|(th)). 
```

我制作这些组是因为我想做替换。但是当我匹配一些像“Monday March 21st 2012”这样的字符串时，它总是匹配两个子字符串：Mo'nd'ay March '21st' 2012。

所以我很困惑为什么它匹配“Mo'nd'ay”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T02:26:03.433

因为您缺少一组括号。尝试：

```
 ((\d{1,2})((st)|(nd)|(rd)|(th))) 
```

你有什么，匹配：

```
 (\d{1,2})(st)
  OR (nd)
  OR (rd)
  OR (th) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T02:26:42.923

您的 s 周围没有正确的括号`|`。你有`((\d{1,2})(st)|(nd)|(rd)|(th))`，但你应该有：`(\d{1,2})(st|nd|rd|th)`。

您正在匹配字符串`nd`、`rd`、`th`或 （后跟一个或两个数字`st`）。

# facebook-graph-api - 使用 facebook 登录 iOS 应用程序会产生“发生错误。请稍后再试”错误

> ID：10201921
> 
> 赞同：3
> 
> 时间：2012-04-18T02:21:03.037
> 
> 标签：facebook-graph-api

我的 iOS 应用程序一直运行良好，直到今天下午它突然开始抛出此错误：“发生错误。请稍后再试”

当我转到应用程序的 facebook 页面时，我收到“过期页面”错误。该应用程序似乎发生了什么？

# cocos2d-iphone - Cocos2d 滚动比例精灵

> ID：10201922
> 
> 赞同：0
> 
> 时间：2012-04-18T02:21:05.717
> 
> 标签：cocos2d-iphone

我为我的英语道歉。精灵大小为 1 x 12 px，在我不得不 scaleX 并尝试滚动之后，我什么都没有。你的任何想法。谢谢！这是代码：

```
-(void) proba
{
    CGPoint pos = ccp(50,100);
    int dlin = 200;
    wall = [CCSprite spriteWithFile:@"wall.png"]; //wall.png 1x12px
    wall.scaleX = dlin;
    wall.anchorPoint  = ccp(0, 0.5);
    wall.position = pos;

    [self addChild:wall];

    [self schedule:@selector(wall_scroll)];
}
-(void) wall_scroll
{
    static float offset = 0.1f;
    wall.textureRect = CGRectMake(wall.textureRect.origin.x - offset ,
                                  wall.textureRect.origin.y ,
                                  wall.scaleX,
                                  wall.textureRect.size.height);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T21:47:38.930

您可以使用 wall.position 滚动整个墙层，而不是尝试滚动纹理矩形吗？

# animation - 如何为 SVG 文本元素设置动画以相对于多边形倾斜

> ID：10201926
> 
> 赞同：1
> 
> 时间：2012-04-18T02:22:03.893
> 
> 标签：animation, text, svg

好的，所以我有一个多边形，我想倾斜文本，所以看起来多边形包含文本。仅仅表明我的意思可能更容易。下面是一个例子，我写了一个动态操作多边形顶点的方法。这个动画是显示一本书折叠的页面。

[http://jsfiddle.net/sdjqw/](http://jsfiddle.net/sdjqw/)

无论如何，如示例中所示，我需要相对于蓝色多边形倾斜文本（目前仅根据蓝色多边形位置对其进行裁剪）。因此，蓝页正确显示了它的含义。如果这是不可能的，有什么好的选择吗？

在旁注中，在这个例子中，我对蓝色元素应用了阴影，但它出现在 3 个面上，有什么简单的方法让它只出现在一个面上吗？

我也一直在考虑只旋转和移动文本，我认为这可能可行，但不是我理想的解决方案。

# python - 阻止greenlets有问题吗？

> ID：10201930
> 
> 赞同：2
> 
> 时间：2012-04-18T02:22:37.887
> 
> 标签：python, asynchronous, nonblocking, green-threads, greenlets

我理解阻塞代码对于事件循环（即 NodeJS）是一种罪过，但是对于 greenlets（我认为是绿色线程）呢？运行调用阻塞函数的代码是否存在问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-05T00:21:44.627

没有 gevent 提供的事件循环的 Greenlets 本身是[非常原始](http://greenlet.readthedocs.org/en/latest/index.html#motivation)的。来自一个greenlet 内的阻塞调用将阻塞所有greenlet，因为greenlet 本身没有能力屈服于IO 操作，也没有调度程序。Gevent 对套接字和文件 IO 的猴子补丁通常足以启用非阻塞 IO，即使数据库是用 python 编写并使用套接字的情况下也是如此。或者，您也可以自己修补库。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-18T03:47:13.907

调用阻塞事件循环的函数当然是问题，因为其他绿色线程将等待这个函数的结束。
但是如果你使用[Gevent](http://gevent.org/)，你可以调用阻塞函数。Gevent 修补了常见的 python 阻塞函数。在程序开始时写下这段代码，Gevent 将修补所有阻塞函数：

```
从 gevent 导入猴子
猴子.patch_all()

```

# uitableview - UITableView 根据另一个 UITableView 同时自动滚动

> ID：10201931
> 
> 赞同：0
> 
> 时间：2012-04-18T02:22:38.477
> 
> 标签：uitableview, autoscroll, simultaneous

是否有可能产生这样的效果：

当我滚动 UITableView 时，另一个 UITableView 会根据我正在移动的 UITableView 同时自动滚动。

NS：由于某些原因，无法将两个 UITableView 合并到一个 UITableView 中...

谢谢。

* * *

我找到了一种方法并进行了测试。只是我不确定这是否是一个好方法。如下执行 UIScrollViewDelegate 的 scrollViewDidScroll。但是我必须取消选中弹跳效果，因为它会使 scrollViewDidScroll 被多次调用以进行一次滚动...

```
- (void)syncTableViews:(UIScrollView *)whatScrollView
{
    int tmpDesY = whatScrollView.contentOffset.y;
    BOOL tmpNeedSetTv00 = NO;
    BOOL tmpNeedSetTv01 = NO;
    BOOL tmpNeedSetTv02 = NO;

    if(whatScrollView == self.TableView00)
    {
        tmpNeedSetTv01 = YES;
        tmpNeedSetTv02 = YES;
    }
    else if(whatScrollView == self.TableView01)
    {
        tmpNeedSetTv00 = YES;
        tmpNeedSetTv02 = YES;
    }
    else if(whatScrollView == self.TableView02)
    {
        tmpNeedSetTv00 = YES;
        tmpNeedSetTv01 = YES;
    }

    if(tmpNeedSetTv00 == YES)
    {
        [self.TableView00 setContentOffset:CGPointMake(self.TableView00.contentOffset.x,tmpDesY) animated:NO];
    }    
    if(tmpNeedSetTv01 == YES)
    {
        [self.TableView01 setContentOffset:CGPointMake(self.TableView01.contentOffset.x,tmpDesY) animated:NO];
    }
    if(tmpNeedSetTv02 == YES)
    {
        [self.TableView02 setContentOffset:CGPointMake(self.TableView02.contentOffset.x, tmpDesY) animated:NO];
    }
}

- (void)scrollViewDidScroll:(UIScrollView *)scrollView
{
    [self syncTableViews:scrollView];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T15:32:19.130

UITableView 作为委托 UIScrollView，将 UIScrollViewDelegate 添加到您刚刚使用的类中：

```
-(void)scrollViewDidScroll:(UIScrollView *)scrollView
{
    UIScrollView *otherScrollView = (scrollView == self.tableViewHours ) ? self.tableViewDay : self.tableViewHours;
    [otherScrollView setContentOffset:[scrollView contentOffset] animated:NO];
} 
```

问候。

# iphone - iOS 向大量用户推送通知

> ID：10201933
> 
> 赞同：3
> 
> 时间：2012-04-18T02:23:01.727
> 
> 标签：iphone, ios, push-notification, push, apple-push-notifications

我将用户的设备令牌保存在数据库中。在推送通知时，我从数据库中加载了所有设备令牌，然后在一个循环中，我一次向一个用户发送推送消息。现在大约有30万用户，我想知道，还有其他更好的方法吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-20T13:35:05.067

苹果没有更好的方法。您需要向每个设备令牌发送相同的消息。Parse.com 之类的服务将通过让您广播到设备组来为您掩盖幕后的肮脏工作，但是您仍然需要最初将每个设备令牌订阅到该组......

因此，要回答您的问题，没有更好的方法，您必须循环并发送到所有设备令牌:(。

# java - 来自 SQLite JDBC 的 Connection.preparedStatement 的 NullPointerException

> ID：10201939
> 
> 赞同：1
> 
> 时间：2012-04-18T02:23:37.197
> 
> 标签：java, sqlite, nullpointerexception, prepared-statement

我想要做的是从 SQL 语句中获取一个 ResultSet，然后我可以从中派生某些值。我似乎遇到的麻烦是准备在这一行发生的准备好的语句。

```
String sql = "SELECT " + dataState + " FROM " + table + whereState + ";";
java.sql.PreparedStatement prep = conn.prepareStatement(sql); // Error here 
```

我已经检查过变量 conn 不为空。语句中的所有值都不为空，堆栈跟踪显示了这一点。

> java.lang.NullPointerException
> at org.sqlite.PrepStmt.(PrepStmt.java:37)
> at org.sqlite.Conn.prepareStatement(Conn.java:231)
> at org.sqlite.Conn.prepareStatement(Conn.java:224)
> at org.sqlite.Conn.prepareStatement(Conn.java:213)
> 在 org.utilities.storagemethods.SQLiteMethod.load(SQLiteMethod.java:223)
> 在 org.utilities.DataManager.load(DataManager.java:97)
> 在 org.utilities .Test.main(Test.java:21)

sql 语句的打印显示它给出了这个。

```
SELECT testString, testBool, testObj FROM testTable WHERE testInt=?; 
```

您可以从给定的字符串中确定值。

我想不通的是我做错了什么，如果你对我使用的 sqlite 系统感到好奇，你可以在这里找到主页：[http ://www.zentus.com/ sqlitejdbc/](http://www.zentus.com/sqlitejdbc/)

提前感谢您对此的任何帮助。我完全被难住了。

注意：为了节省资源，我缓存了我的连接，并在以后重新使用它们。当我尝试重新获得连接时，它工作得很好。有没有办法可以缓存它们，或者每次我想使用它时都需要加载它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T20:53:38.417

我收到此错误，这是因为我关闭了连接。连接不是空的，它只是关闭了。阿雷格！就像 OP 暗示的那样，我从 Zentus 的示例代码开始（现在是 Xerial，因为 Zentus 似乎已经关闭）。示例代码有一个 finally 块，他在其中关闭连接。一旦我取出 finally 块，我的错误就消失了。请记住在退出程序之前关闭连接。

要查看您是否有同样的问题，在给出错误的行之前，尝试添加

```
System.out.println("isClosed = " + conn.isClosed()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T02:30:50.730

如果没有错，我认为是因为';' 在您的 SQL 语句中。请删除并重试？

问候，背后的代码

# java - 字母排序器不工作

> ID：10201940
> 
> 赞同：0
> 
> 时间：2012-04-18T02:23:48.747
> 
> 标签：java, sorting

我正在编写一个程序，按字母顺序对用户输入的名称进行排序`stdin`。名称被正确提取，但排序不起作用。有人可以帮我找出原因。

这是我的代码...

```
public class Sort {
    public static void main(String[] args) {
        while (!StdIn.isEmpty()){
            String names = StdIn.readString();
            String [] name = new String[1]; 

            for (int i = 0; i < 1; i++) {
                name[i] = names;
            }

            Arrays.sort(name);

            for (int i = 0;  i < 1; i ++){
                System.out.println(name[1]);
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T02:28:36.193

除了注释中提到的代码存在明显问题外，我不会使用数组。相反，请使用`java.util.Collection`诸如`java.util.TreeSet<String>`自动排序之类的实现。

# ios - 如何在 UILabel 中点击单词

> ID：10201941
> 
> 赞同：1
> 
> 时间：2012-04-18T02:24:02.230
> 
> 标签：ios

在我正在编写的应用程序中，我认为如果用户可以点击 UILabel 并且我可以看到他们点击了哪个词，那将是最好的。无论如何我可以做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T03:15:37.333

你可以使用**UIWebview**

采用

```
- (void)loadHTMLString:(NSString *)string baseURL:(NSURL *)baseURL; 
```

并对整个消息进行编码，然后将链接包装到

```
[webView.loadHTMLString:@"<a href="tap:Google">Google</a>" baseURL:nil]; 
```

然后在委托方法中

```
- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType 
```

你会知道你点击了哪个词

```
 if ( [request.URL.scheme compare:FeverProtocolIdentifier] == NSOrderedSame ) 
    {    
        NSString *word = request.URL.resourceSpecifier;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T02:55:55.917

我不认为这很容易。我可能会使用[OHAttributedLabel](https://github.com/AliSoftware/OHAttributedLabel)而不是 UILabel 并向 OHAttributedLabel 代码添加一个方法来返回您需要的信息。如果您查看 OHAttributedLabel.m 中的 linkAtPoint 方法[，](https://github.com/AliSoftware/OHAttributedLabel/blob/master/OHAttributedLabel.m)您会看到您需要做什么。我会复制该方法，也许将新的命名为**characterOffsetAtPoint**，然后返回现有代码在第 340 行计算的索引。

# ios - 从 Documents 目录存储和读取文件 iOS 5

> ID：10201944
> 
> 赞同：3
> 
> 时间：2012-04-18T02:24:35.210
> 
> 标签：ios, cocos2d-iphone

在我的游戏中，当一个级别完成时，应用程序会在应用程序的 Documents 目录中的文件中存储一个“1”。当游戏加载时，玩家只有在上一个关卡已经完成的情况下才能玩一个关卡。当我通过 Xcode 在设备上测试游戏时，应用程序可以正常工作，并且在完成上一个关卡之前无法玩关卡。但是，当应用程序获得批准并在 App Store 上发布时，应用程序的行为就像每个级别都已完成（没有锁定级别）。我无法弄清楚这一点，并希望有人的帮助！我正在测试的设备都是 iOs 5.0 或更高版本。

以下是将完成的关卡保存在 Documents 目录中的代码：

```
 NSMutableData* data = [[NSMutableData alloc] init];
        NSKeyedArchiver* coder = [[NSKeyedArchiver alloc] initForWritingWithMutableData:data];
        NSString *levelString = [NSString stringWithFormat:@"Level%d",level];
        [coder encodeInteger:1 forKey:levelString];
        [coder finishEncoding];
        NSString *levelString2 = [NSString stringWithFormat:@"Level%d.save",level];
        ///
        NSFileManager *filemgr;
        NSString *dataFile;
        NSString *docsDir;
        NSArray *dirPaths;

        filemgr = [NSFileManager defaultManager];

        // Identify the documents directory
        dirPaths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);

        docsDir = [dirPaths objectAtIndex:0];

        // Build the path to the data file
        dataFile = [docsDir stringByAppendingPathComponent:levelString2];

        // Check if the file already exists
        if ([filemgr fileExistsAtPath: dataFile])
        {
            [[NSFileManager defaultManager] removeItemAtPath:dataFile error:nil];
        }
        [data writeToFile:dataFile atomically:YES];
        [coder release];
        [data release];
    }
    @catch (NSException* ex) 
    {
        CCLOG(@"level save failed: %@", ex);
    } 
```

下面是读取 Document 目录以查看关卡是否已完成的代码：

```
if ([self loadCompletedLevels:6] == 1) { //// level gets unlocked **** }

-(int) loadCompletedLevels:(int)theLevel; {

int isLevelCompleted;  //1 = completed

NSString* kSaveFile = [NSString stringWithFormat:@"Level%d.save",theLevel];
NSString *levelString = [NSString stringWithFormat:@"Level%d",theLevel];

@try
{

    NSFileManager *filemgr;
    NSString *dataFile;
    NSString *docsDir;
    NSArray *dirPaths;

    filemgr = [NSFileManager defaultManager];

    // Identify the documents directory
    dirPaths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);

    docsDir = [dirPaths objectAtIndex:0];

    // Build the path to the data file
    dataFile = [docsDir stringByAppendingPathComponent:kSaveFile];

    if ([[NSFileManager defaultManager] fileExistsAtPath:dataFile])
    {
        NSData* data = [[NSData alloc] initWithContentsOfFile:dataFile];

        if (data && [data length] > 0)
        {
            NSKeyedUnarchiver* decoder = [[NSKeyedUnarchiver alloc] initForReadingWithData:data];
            isLevelCompleted = [decoder decodeIntForKey:levelString];

            [decoder release];
        }

        [data release];
    }
    if (isLevelCompleted == 1) {
        levelCompleted = YES;

    }
}
@catch (NSException* ex) 
{

    levelCompleted = NO;
}
return isLevelCompleted; } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T03:56:24.573

您可能应该使用不同的方法来存储数据，但真正的问题是您没有初始化返回值 isLevelCompleted。它在堆栈上，没有默认值。它从该堆栈位置发生的任何事情开始。

因此，如果您不设置它，它将具有任意值。

此外，您可能应该使用 BOOL 作为布尔值，但如果您这样做：

```
int isLevelCompleted = 0;  //1 = completed 
```

您将其初始化为“false”，因此您的代码必须将其显式更改为“true”。

# c# - 我如何找到 C# 中泄漏的内容？

> ID：10201945
> 
> 赞同：0
> 
> 时间：2012-04-18T02:24:36.687
> 
> 标签：c#, .net, memory-leaks, memory-leak-detector

我有一些 C# 代码。我使用代码分析来查找我不使用`using(){}`或不调用 dispose 的所有地方。就这样完成了。然而它仍然泄漏。除了两个函数（SetWindowPos、SetForegroundWindow）之外，代码不调用 DllImport，但这些函数从未被调用（主实例不使用它。其他实例使用它，但它们会存活几秒钟）。

不知何故，这段代码正在泄漏。我如何找出问题所在？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T02:31:18.107

托管代码中的内存泄漏通常是由于意外引用将对象保存在内存中。事件处理程序是这里的常见罪魁祸首。

你会想要一个内存分析工具。[SciTech 的 .NET Memory Profiler](http://memprofiler.com/)可能是最好的，尽管[JetBrains 的 dotTrace](http://www.jetbrains.com/profiler/features/index.html#Memory_profiling)和[RedGate 的 ANTS](http://www.red-gate.com/products/dotnet-development/ants-memory-profiler/index2)也都不错。

Microsoft 有一个免费的分析工具[CLR Profiler](http://www.microsoft.com/download/en/details.aspx?id=16273)可以使用，尽管它有点复杂。请参阅[此处](http://msdn.microsoft.com/en-us/library/ff650691.aspx)和[此处](http://geekswithblogs.net/robp/archive/2009/03/13/speedy-c-part-4-using---and-understanding---clr.aspx)以获取一些指导。

.NET的[DRONE profiler](http://www.droneprofiler.com/index.aspx)似乎有一个免费的个人许可证，尽管我自己并不熟悉这个工具。[他们在这里](http://www.droneprofiler.com/articles/finding_memory_leaks_using_drone_profiler.aspx)有一篇关于使用他们的分析器查找内存泄漏的文章。

Visual Studio 的高端版本还包含分析工具。MSDN 包含[有关如何使用它们的文档](http://msdn.microsoft.com/en-us/library/z9z62c29.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T02:27:32.637

使用 Visual Studio（Premium 和 Ultimate）内置的分析器分析您的应用程序，或投资于[ANTS](http://www.red-gate.com/products/dotnet-development/ants-memory-profiler/index2)之类的工具。

# java - 如何使用 SSH java 客户端运行“pbrun pbapp wasapp=ksh”命令？

> ID：10201946
> 
> 赞同：2
> 
> 时间：2012-04-18T02:24:45.703
> 
> 标签：java, ssh, jsch

我想连接到 ssh 服务器。我尝试了 Jsch、Orion、J2ssh java api 的连接。我可以运行 date、pwd、who 等命令。但出于我的目的，我需要使用“ `pbrun pbapp wasapp=ksh`”命令。只有这样，我才能在服务器上使用我剩余的命令。

请让我知道，如何在 java 上使用这个命令。

# c - 在ac程序中，当主线程终止时，整个进程是否终止？

> ID：10201948
> 
> 赞同：1
> 
> 时间：2012-04-18T02:24:58.213
> 
> 标签：c, multithreading, unix, process, linux-kernel

在linux中，无论主线程如何终止，通过函数exit（）或从main返回，整个进程都会在主线程终止时退出。如果主线程从 main() 返回，它将返回到名为 crt.o 或类似名称的“C 运行时”。在 crt.o 中，其 c 代码如下：exit(main(argc, argv)); exit() 最终会被主线程调用，
结果所有线程都终止了。

我的想法看起来对吗？

如果在crt.o中exit()被替换为void thread_exit(int)之类的线程终止函数，只能终止一个有退出状态的线程，crt.o的c源码好像是thread_exit(main(argc, argv))，当主线程终止时，其他线程是否仍然运行？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T07:11:18.710

Returning from`main`相当于调用`exit`，并终止*进程*。要仅终止单个线程，请使用`pthread_exit`. 请注意，调用初始线程是有效的`pthread_exit`（并且在所有线程退出或其中一个线程调用之前，进程不会终止）并且如果您从它们的启动函数返回，`exit`则初始线程以外的线程会隐式调用。`pthread_exit`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-18T02:28:29.140

在 unix 上，进程在最后一个线程终止后终止。请注意，这可以是任何线程，而不仅仅是“主”线程。因此，如果您将 exit 替换为`pthread_exit`，但在返回 main 之前生成了一个线程，您的进程将不会终止。

# ios - 创建不同大小的缩略图网格？

> ID：10201949
> 
> 赞同：0
> 
> 时间：2012-04-18T02:25:13.410
> 
> 标签：ios, ipad, aqgridview

我正在尝试在 iPad 上的网格中显示一组图像缩略图。我可以使用 AQGridView 显示所有 100x100 的图像网格，但我想包括一些 200x200 的图像（基本上，网格中有 4 个点）。

例如，显示 8 张 100x100 图像和 1 张 200x200 图像，如：

```
[1] [2] [3] [4]
[  5  ] [6] [7]
[     ] [8] [9] 
```

AQGridView 有没有办法做到这一点？或者其他具有这种功能的框架？

如果没有，也许有人可以提出一个对他们来说很成功的策略？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T02:48:07.653

AQGridView 的关于[重组跳板](https://github.com/AlanQuatermain/AQGridView/tree/master/Examples/SpringBoard)的示例展示了如何插入空单元格索引以创建空间错觉。只需将 4 个空单元格插入矩阵并覆盖 UIView，或者实现某种标志，将单元格的变换属性设置`CGAffineTransformMakeScale(2.0, 2.0);`为常规单元格。

# c++ - 将字符串转换为 u_char*

> ID：10201950
> 
> 赞同：0
> 
> 时间：2012-04-18T02:25:27.113
> 
> 标签：c++, string, pointers, char

我有两个功能

```
foo(const string &value)
{
  bar(...)
}

bar(const u_char *value, size_t len)
{
  // do something
} 
```

如何将 const 字符串转换为 u_char *？我相信我可以使用 sizeof() 函数获得 size_t 。

非常感谢帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T02:36:19.583

从字符串到 char* 的转换是通过使用`c_str()`.

关于`u_char`转换，我认为没有什么不同。

这将对您有所帮助：[MSDN 字符串转换](http://msdn.microsoft.com/en-us/library/ms235631%28v=vs.80%29.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T02:34:34.537

`c_str()`您可以使用函数获取 std::string 的 c 样式字符串表示。只需调用`bar((u_char)value.c_str(),value.length())`. 签名对于 c 风格的字符串应该无关紧要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T02:35:27.357

`bar`可以如下调用（假设`u_char`是某种`char`）：

```
bar(reinterpret_cast<u_char const*>(value.c_str()), value.size()) 
```

# c++ - c++读取数组cin错误

> ID：10201952
> 
> 赞同：0
> 
> 时间：2012-04-18T02:25:34.150
> 
> 标签：c++, arrays, cin

我已经一年多没有用 C++ 编码了，我看不到这段代码中的错误。

它说 cin 函数有错误，`no such operator >>`

```
int main()
{
    double * array[25];
    bool exitCode = false;
    cout <<"Enter in your Array"<<endl;
    do{
        for(int i = 0; i < 24; i++)
        {
            cout<< "Enter your float number";
            cin >> array[i];

            cout << "Are there any more inputs?: ( Y or N )";
            cin >> exitCode; // error is here
        }
    }while(exitCode == false);

    return array;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T02:32:56.650

确保包含以下内容：

```
<fstream>
<istream>
<iostream>
<string> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T02:43:35.927

尝试这个：

```
#include<iostream>

using namespace std;

int main()
{
    double array1[25];
    char exitCode;
    cout <<"Enter in your Array"<<endl;
    do{
        for(int i = 0; i < 24; i++)
        {
            cout<< "Enter your float number";
            cin >> array1[i];

            cout << "Are there any more inputs?: ( Y or N )";
            cin >> exitCode; // error is here
        }
    }while(exitCode == 'y');

    return 0;
} 
```

我想知道为什么只将指针和数组存储在数组中（而不使用指针）>。>

因此，`exitCode`是`boolean`（我认为这是它出错的原因）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T02:47:42.320

让我们一行一行地看：

改变

> 双 * 数组 [25];

至

> 双数组[25]；

原因： `double *`是一个指向双精度的指针，所以在原文中您声明了一个包含 25 个指针的数组，但没有理由在这里使用指针。你想要一个包含 25 个双精度数的数组。

```
do{
    for(int i = 0; i < 24; i++) 
```

您在 while 循环中声明了一个 for 循环。在您的示例中，您只需要一个循环。

> cout << "还有输入吗?: ( Y or N )";

您要求用户输入字符。但是`cin >> exitCode;`，在阅读 bool 时，您可能想阅读`char`.

> 返回数组；

你返回一个`array`, main 返回一个`int`。

这是具有上述修复的代码，正确包括：

```
#include <iostream>
using namespace std;
int main()
{
double array[25];
cout <<"Enter in your Array"<<endl;

for(int i = 0; i < 24; i++)
{
    cout<< "Enter your float number";
    cin >> array[i];

    cout << "Are there any more inputs?: ( Y or N )";
    char c;
    cin >> c;
    if (c == 'N')
    {
        break;
    }
}

return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T02:48:18.283

您将“array”声明为指向双精度数的指针数组。我怀疑那是你真正想要的，但是，无论如何，'cin' 上的 '<<' 运算符不支持，所以这是无效的：

```
cin >> array[i]; 
```

您必须将其更改为

```
cin >> *array[i]; 
```

使其编译。（由于指针未初始化，它不会运行。）

我认为你可能想要的是'array'只是一个双打数组。

# c++ - 将 std:vector 转换为 NSArray

> ID：10201953
> 
> 赞同：19
> 
> 时间：2012-04-18T02:25:55.703
> 
> 标签：c++, vector, nsarray, objective-c++

`vector<int32_t>`有没有一种将 a 转换为`NSArray`of的好方法，`NSNumber`或者是循环并添加到`NSMutableArray`几乎唯一的方法？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-18T03:27:01.360

如果您有对象向量，则可以执行以下操作：

```
NSArray *myArray = [NSArray arrayWithObjects:&vector[0] count:vector.size()]; 
```

但是，如果您的向量包含原始类型，例如`NSInteger`、`int`、`float`等，您将不得不手动循环向量中的值并将它们转换为`NSNumber`第一个。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-18T05:29:33.587

是的，您*可以*使用以下方法从 a创建一个`NSArray`of ：`NSInteger``std::vector<NSInteger>`

```
// thrown together as a quick demo. this could be improved.
NSArray * NSIntegerVectorToNSArrayOfNSIntegers(const std::vector<NSInteger>& vec) {

  struct MONCallback {
    static const void* retain(CFAllocatorRef allocator, const void* value) {
      /* nothing to do */
      return value;
    }

    static void release(CFAllocatorRef allocator, const void* value) {
      /* nothing to do */
    }

    static CFStringRef copyDescription(const void* value) {
      const NSInteger i(*(NSInteger*)&value);
      return CFStringCreateWithFormat(0, 0, CFSTR("MON - %d"), i);
    }

    static Boolean equal(const void* value1, const void* value2) {
      const NSInteger a(*(NSInteger*)&value1);
      const NSInteger b(*(NSInteger*)&value2);
      return a == b;
    }
  };

  const CFArrayCallBacks callbacks = {
    .version = 0,
    .retain = MONCallback::retain,
    .release = MONCallback::release,
    .copyDescription = MONCallback::copyDescription,
    .equal = MONCallback::equal
  };

  const void** p((const void**)&vec.front());
  NSArray * result((NSArray*)CFArrayCreate(0, p, vec.size(), &callbacks));
  return [result autorelease];  
}

void vec_demo() {
  static_assert(sizeof(NSInteger) == sizeof(NSInteger*), "you can only use pointer-sized values in a CFArray");

  std::vector<NSInteger> vec;
  for (NSInteger i(0); i < 117; ++i) {
    vec.push_back(i);
  }
  CFShow(NSIntegerVectorToNSArrayOfNSIntegers(vec));
} 
```

但是，您需要非常谨慎地使用此集合。Foundation 期望元素为`NSObject`s。如果将它传递给需要 s 数组的外部 API `NSObject`，它可能会导致错误（读取：`EXC_BAD_ACCESS`in `objc_msgSend`）。

通常，人们会将它们转换为`NSNumber`. 只有当另一个 API*需要*它时，我才会在我的程序中使用这个`NSArray`of s （Apple 有一些）——它们只是不能很好地结合在一起。`NSInteger`

# mysql - 我应该在 MySQL 中为 JSON 使用 blob 还是 text？

> ID：10201957
> 
> 赞同：62
> 
> 时间：2012-04-18T02:26:08.940
> 
> 标签：mysql, text, blob, mysql-json

我打算`json_encoded`在我的数据库中存储一个字符串。我不能准确地说出它的长度，但我很确定它会很长。我关心的是我将为此使用哪种字段类型，是它`blob`还是`text`？

我更喜欢可以通过快速搜索尽可能节省空间的那个，无论如何我还有其他列我应该只索引。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2015-12-28T10:59:27.907

[如MySQL](https://dev.mysql.com/doc/refman/5.7/en/json.html)文档中所述，从 5.7.8 开始支持原生 JSON 数据类型。

与将 JSON 格式的字符串存储在字符串列中相比，JSON 数据类型具有以下优势：

*   自动验证存储在 JSON 列中的 JSON 文档。无效的文档会产生错误。
*   优化的存储格式。存储在 JSON 列中的 JSON 文档被转换为允许对文档元素进行快速读取访问的内部格式。当服务器稍后必须读取以这种二进制格式存储的 JSON 值时，不需要从文本表示中解析该值。二进制格式的结构使服务器能够直接通过键或数组索引查找子对象或嵌套值，而无需读取文档中它们之前或之后的所有值。

因此，正如 MySQL 文档所述，应使用 JSON 数据类型而不是文本。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2012-04-18T03:11:37.203

`blob`通常用于图像、二进制文件等。`text`对于您的情况应该足够好，或者`longtext`如果这确实是一个问题，您可以使用具有更大空间容量的东西。

搜索方面，由于您正在存储`json_encode`'d 的东西，您仍然需要调用`json_decode`它才能在您的应用程序中使用它，我认为在这种情况下选择数据类型并不重要。

更好的方法是规范化你的数据库设计，而不是将相关的东西存储在一大串 json 中。

# javascript - addthis.com 通过 ajax 加载按钮（能够动态设置电子邮件变量）

> ID：10201959
> 
> 赞同：0
> 
> 时间：2012-04-18T02:26:49.733
> 
> 标签：javascript, ajax, object

我正在尝试通过 ajax 加载和初始化 addthis.com 小部件，以便能够根据用户输入动态重置 addthis_share 对象内的电子邮件变量。

到目前为止，我成功地通过 ajax 加载小部件，但是当我通过 ajax 加载它时，我最需要的按钮不再是小部件的一部分。这很奇怪，因为我使用完全相同的脚本来加载两个小部件。

我需要的按钮是“电子邮件”按钮。小部件本身有两个电子邮件按钮：一个称为“电子邮件”，另一个称为“电子邮件应用程序”。“电子邮件”是一个接受传递给电子邮件的变量的变量（当我通过 ajax 加载它时没有显示的变量）。您可以通过以下方式验证小部件加载后哪些电子邮件按钮是小部件的一部分：单击小部件（在 + 按钮本身上）并在搜索输入字段中键入“电子邮件”。

我已经设置了两个 js fiddles 来说明这个案例。第一个以标准方式加载小部件（您可以在那里看到两个电子邮件按钮）。第二个通过 jQuery getScript 加载小部件，您可以看到其中仅显示“电子邮件应用程序”按钮。

1）常规：http: [//jsfiddle.net/FLAf4/](http://jsfiddle.net/FLAf4/)

2）阿贾克斯：http: [//jsfiddle.net/6QUWt/5/](http://jsfiddle.net/6QUWt/5/)

我知道这是 addthis.com 的特定问题——我尝试在他们网站的定制/问答部分发布这个问题，但到目前为止没有人对此发表评论。谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T02:32:05.793

显然你不能在 addthis 脚本上设置 pub-id 和 async ，所以你应该设置`#async=1`然后设置一个`addthis_config`包含发布者 ID 的全局变量，你应该`addthis_share`在全局范围内拥有变量，然后将电子邮件模板和电子邮件模板变量分配给按钮单击处理程序内的全局变量。

[http://jsfiddle.net/joeflateau/Bht2b/4/](http://jsfiddle.net/joeflateau/Bht2b/4/)

# list - 遍历 C++ 中的点列表

> ID：10201961
> 
> 赞同：0
> 
> 时间：2012-04-18T02:26:55.703
> 
> 标签：list, iterator

我有一个 point3 结构，它需要 3 个浮点数 x、y、z（3-D 空间坐标）。

我正在尝试编写一个函数来转换点列表中每个元素的 x、y、z 值。

我是 C++ 新手，所以我认为我没有正确编写迭代器，任何人都可以帮助澄清如何迭代列表并修改列表中每个元素的组件吗？

我看了这篇文章[C++ How to loop through a list of structs and access their properties](https://stackoverflow.com/questions/1355531/c-how-to-loop-through-a-list-of-structs-and-access-their-properties)并认为这回答了我的问题，但解决方案不起作用。

这是我的代码：

```
//Translates the face by dx, dy, dz coordinates
list<point3> translateFace(list<point3> lop, float dx, float dy, float dz)
{
    list<point3>::iterator iter;

    for (iter = lop.begin() ; iter != lop.end(); iter++){
        iter->x - dx;
        iter->y - dy;
        iter->z - dz;
    }
   return lop;
} 
```

我也尝试了上面链接中建议的解决方案，仍然没有用。*return lop*应该在 for 循环内部还是外部？我应该退回除 lop 以外的东西吗？

```
for (iter = lop.begin() ; iter != lop.end(); iter++){
    (*iter).x - dx;
    (*iter).y - dy;
    (*iter).z - dz;
    }
return lop; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T02:30:07.243

在我看来，您实际上并没有*存储*计算结果：

```
for (iter = lop.begin() ; iter != lop.end(); iter++){
    iter->x - dx;
    iter->y - dy;
    iter->z - dz;
} 
```

试试这个：

```
for (iter = lop.begin() ; iter != lop.end(); iter++){
    iter->x -= dx;
    iter->y -= dy;
    iter->z -= dz;
} 
```

我希望大多数编译器会就这样的未使用计算发出警告——如果可以的话，提高编译器的警告级别。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T02:39:51.307

让我们来看看：

```
list<point3> translateFace(list<point3> lop, float dx, float dy, float dz)
{
    list<point3>::iterator iter;

    for (iter = lop.begin() ; iter != lop.end(); iter++){
        (*iter).x -= dx;
        (*iter).y -= dy;
        (*iter).z -= dz;
    }

    return lop;
} 
```

应该是正确的选项，假设您知道这样做时，您正在创建 lop 参数的本地副本，然后将其返回并移动 (C++0x) 或复制 (C++03) 到任何变量中您将其设置为。例如（假设 point3 需要 3 个浮点数来构造）：

```
point3 point(0.0, 0.3, 0.5);
list<point3> face;

face = translateFace(list<point3>(point), -0.5, -3.32, -7.5); 
```

应该导致 face 包含一个仅包含点的列表，坐标为 -.5、-3.02 和 -7.0。

# android - 如何从联系人数据库中读取所有联系人并将其存储到列表中？

> ID：10201963
> 
> 赞同：1
> 
> 时间：2012-04-18T02:27:19.817
> 
> 标签：android, android-contacts, sqliteopenhelper

我正在尝试从联系人表中读取联系人并将它们全部存储到列表变量中..但无法弄清楚为什么它似乎不起作用..在执行时强制关闭。需要发送联系人通过 json 对象发送到 Web 服务器。

```
 private static final String TABLE_CONTACTS = "contacts";

// contacts JSONArray
JSONArray contacts = null;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    List<contact> l=new ArrayList<contact>();
    String query="SELECT * FROM"+ TABLE_CONTACTS;

     DBHelper help= new DBHelper(getBaseContext()); 
    SQLiteDatabase db=help.getWritableDatabase();
    Cursor cursor = db.rawQuery(query, null);
    if(cursor.moveToFirst())
    {
        do{
            contact contact = new contact();
            contact.setID(Integer.parseInt(cursor.getString(0)));
            contact.setName(cursor.getString(1));
            contact.setPhoneNumber(cursor.getString(2));
            Toast.makeText(this,contact.name,Toast.LENGTH_LONG);
             l.add(contact);
        }
        while(cursor.moveToNext());
    } 
```

清单文件有2个权限

```
 <uses-permission android:name="android.permission.INTERNET" />
     <uses-permission android:name="android.permission.READ_CONTACTS"/> 
```

和 DBHelper 类，用于将 sqlitopenhelper 扩展为 getWritableDatabase..

```
 class DBHelper extends SQLiteOpenHelper { 
private static final String DATABASE_NAME = "contactsManager";

   // Contacts table name
   private static final String TABLE_CONTACTS = "contacts";
DBHelper(Context context) { 
    super(context,DATABASE_NAME, null,1); 
}

@Override
public void onCreate(SQLiteDatabase db) {
    // TODO Auto-generated method stub      
}

@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
    // TODO Auto-generated method stub      
} 
```

}

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T03:03:18.507

```
private void getDetails(){
    Uri uri = ContactsContract.CommonDataKinds.Phone.CONTENT_URI;
    ContentResolver cr = getContentResolver();
    Cursor cur = cr.query(ContactsContract.Contacts.CONTENT_URI,null, null, null, null);
    String[] projection    = new String[] {ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME,
                        ContactsContract.CommonDataKinds.Phone.NUMBER };
    Cursor names = getContentResolver().query(uri, projection, null, null, null);
    int indexName = names.getColumnIndex(ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME);
    int indexNumber = names.getColumnIndex(ContactsContract.CommonDataKinds.Phone.NUMBER);
    names.moveToFirst();
    do {
       String name   = names.getString(indexName);
       Log.e("Name new:", name);
       String number = names.getString(indexNumber);
       Log.e("Number new:","::"+number);
    } while (names.moveToNext());
} 
```

使用上面的代码从联系人数据库中获取姓名和号码列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T02:38:13.480

试试看。。

[联系人 API](http://developer.android.com/reference/android/provider/Contacts.html) **已弃用**

[联系方式合同](http://developer.android.com/reference/android/provider/ContactsContract.html)

# objective-c - cocoa:我想知道状态栏图标在屏幕上的位置

> ID：10201964
> 
> 赞同：3
> 
> 时间：2012-04-18T02:27:21.327
> 
> 标签：objective-c, xcode, macos, cocoa

我想知道屏幕上状态栏图标的位置

```
-(void)awakeFromNib{
    statusItem = [[[NSStatusBar systemStatusBar] statusItemWithLength:NSVariableStatusItemLength] retain];
    NSBundle *bundle = [NSBundle mainBundle];
    statusImage = [[NSImage alloc] initWithContentsOfFile:[bundle pathForResource:@"r" ofType:@"png"]];
    statusHighlightImage = [[NSImage alloc] initWithContentsOfFile:[bundle pathForResource:@"rh" ofType:@"png"]]; 
    [statusItem setImage:statusImage];
    [statusItem setAlternateImage:statusHighlightImage];
    [statusItem setTitle:@"APP"];
    [statusItem setToolTip:@"You do not need this..."];
    [statusItem setHighlightMode:YES];

    NSRect rect = [[[statusItem view] window ] frame];

    NSLog(@"%f",rect.origin.y);

} 
```

这样做并没有得到

```
NSRect rect = [[[statusItem view] window ] frame];

NSLog(@"%f",rect.origin.y); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T03:45:56.567

您还没有为状态项设置自定义视图，因此调用`view`将返回 nil。

我猜你想知道位置的原因是当你点击状态项时。

如果你要为你的状态项实现一个动作，它可能看起来像这样：

```
- (IBAction)someAction:(id)sender
{
    NSWindow *window = [[[NSApplication sharedApplication] currentEvent] window];
    NSRect rect = [window frame];

    NSLog(@"%f",rect.origin.y);
} 
```

然后你会像这样设置你的状态项的动作：

```
[statusItem setAction:@selector(someAction:)]; 
```

然后每当您单击状态项时，您都会在日志中看到类似的内容：

```
2012-04-17 20:40:24.344 test[337:403] 1578.000000 
```

例如，您可以使用该信息相对于状态项定位窗口（如 Matt Gemmell 的 MAAttachedWindow）。

# jquery - 获取 jQuery 可排序 connectWith 序列化方法的关联 ID

> ID：10201965
> 
> 赞同：1
> 
> 时间：2012-04-18T02:27:30.483
> 
> 标签：jquery, ruby-on-rails-3, jquery-ui

使用 Rails 3。

状态表中的模型：

```
id
country_id
position
created_at
updated_at 
```

Javascript：

```
$(".sortable_country").sortable({
    connectWith: ".sortable_country",
    update: function() {
        console.log($(this).sortable("serialize"));
    }
}); 
```

HTML：

```
<strong>Country 1</strong>
<ul id="country_1" class="sortable_country">
    <li id="state_1">
        State 1
    </li>
    <li id="state_2">
        State 2
    </li>
    <li id="state_3">
        State 3
    </li>
    <li id="state_4">
        State 4
    </li>
</ul>
<strong>Country 2</strong>
<ul id="country_2" class="sortable_country">
    <li id="state_5">
        State 5
    </li>
    <li id="state_6">
        State 6
    </li>
    <li id="state_7">
        State 7
    </li>
    <li id="state_8">
        State 8
    </li>
</ul> 
```

斑点控制器.rb：

```
def sort
  params[:states].each_with_index do |id, index|
    State.update_all([&rsquo;position=?&rsquo;, index+1], [&rsquo;id=?&rsquo;, id])
  end
  render :nothing => true
end 
```

请忽略其他必需的代码，因为我已经简化了代码以进行故障排除。在这个例子中，我排序`State 5`到`Country 1`列表。排序后返回序列化结果为：

```
state[]=6&state[]=7&state[]=8
state[]=1&state[]=2&state[]=3&state[]=5&state[]=4 
```

如何`country_id`在序列化结果中包含关联，以便我的应用程序可以适当地将`State 5`'s更新`country_id`为`1`最初`2`在排序之前的 's？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T13:53:05.210

把它放在里面`.sortable()`：

```
update: function() {
    $.post($(this).data('update-url'), $(this).sortable('serialize'))
    .error(function() { 
    alert("Sorry, could not save the positions. Please refresh this page.");
    })
} 
```

关联的 ID 将在排序后自动发布在单独的帖子中。

# javascript - jQuery插件实践

> ID：10201968
> 
> 赞同：1
> 
> 时间：2012-04-18T02:27:52.083
> 
> 标签：javascript, jquery, html, css, plugins

我正在开发一个 jQuery 插件，我想从更有经验的人那里得到一些关于集成 HTML、CSS 和 JavaScript 代码的良好实践的意见。

具体来说：

1.HTML 代码 - 静态 vs 动态

在插件中只编写最少量的 HTML 标记并通过 JavaScript 动态创建其余所需的 HTML 代码是否很好？

还是手动编写所有需要的 HTML 更好？

只有最小的 HTML 看起来更干净、更容易修改，所有必需的 HTML 可能会更好地完全理解、自定义和使用插件，因为您可以看到代码的整个结构。

2.CSS 代码 - 在 JavaScript 中或外部

是在 JavaScript 中动态创建和应用 CSS 代码，还是在 CSS 文件中将 CSS 代码放在外部？

如果 CSS 是内部的，它是根据插件的指定属性动态创建的。会有更多属性，但所有设置都在插件设置中的一个地方指定。

如果代码是外部的，用户需要编辑 CSS 以修改可用的不同选项。

一方面，拥有最少的 HTML 和动态创建的 CSS 似乎更容易让用户理解，另一方面，拥有所有 HTML 和外部 CSS 似乎更强大，更适合更高级的插件。

我正在寻找来自经验丰富的用户的一些关于在创建插件时集成 HTML、CSS 和 JavaScript 的良好实践的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T02:31:23.317

> 1.  在插件中只编写最少量的 HTML 标记并通过 JavaScript 动态创建其余所需的 HTML 代码是否很好？

是的，这就是 jQuery UI 插件（和大多数其他插件）的工作方式。

> 2.CSS 代码——在 JavaScript 中还是在外部？

这取决于 css 规则的复杂程度，在 jQuery UI 中它们使用 css 文件，在 jQuery Validation 中它们不使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T02:31:49.943

1.  这在很大程度上取决于您的插件将要做什么。如果 JavaScript 不存在并且元素没有 JavaScript 就没有其他功能，我将使用 JavaScript 创建这些元素。

2.  始终，始终，始终将您的 CSS 保存在 CSS 文件中。只需使用 jQuery 添加类。

让自己置身于想要使用您的代码但又不想在每次想要自定义 JS 插件时都编辑它的开发人员的立场上。

作为一般经验法则，您使用 jQuery 插件创建的任何 HTML 都应该可以通过更改插件的默认参数进行自定义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T13:00:24.967

**取决于您是否想要良好的性能并为一个或某些特定项目创建插件，那么您可以遵循以下规则：**

您应该必须将 CSS 放在您已经使用的样式表中。如果您希望将来易于修改，可以通过注释将其分开。

此外，您必须在 HTML 中定义 HTML 标签。如果可以（如果它不是动态的或取决于条件），那么您就可以定位它并做任何您想做的事情。

如果您确实有任何条件 HTML，那么您可以在 JavaScript 中的单独视图部分中创建它。这样任何人都可以找到几乎所有标签，如果他/她将来想编辑它。

**如果您想为每个人提供插件，可以在任何项目中使用它。然后你必须在性能上做出一点妥协。您应该将 HTML 和 CSS 放置在与您的项目不同的位置，以便通过添加对一两个文件的引用来轻松组装（无需从不同位置复制和粘贴代码）。**

如果你确实有很多 CSS，那么你应该为你的 CSS 创建不同的样式表，否则在 JavaScript 中定义它。

您应该必须在 JavaScript 中创建 HTML 并尝试将其组合成一个视图。以便将来可以轻松编辑。

# javascript - 管理可扩展的 java/javascript 应用程序

> ID：10201970
> 
> 赞同：2
> 
> 时间：2012-04-18T02:28:09.670
> 
> 标签：javascript, java, maven, web-applications, version-control

我有一个使用 Maven 构建的 Web 应用程序，由 Java (Spring) 后端和 Javascript (ExtJS/OpenLayers) 前端组成。这个 Web 应用程序已慢慢成为许多衍生或子 Web 应用程序的基础。我的意思是我们有一个单一的 web 应用程序，它的功能已经针对一些特定领域的问题进行了扩展，这导致了一组 web 应用程序都依赖于通用功能。

到目前为止，我们一直在通过 SVN 存储库来“管理”问题，其中包含衍生 webapps 分支的核心代码，并允许我们偶尔合并分支之间的更改。这种方法有各种各样的问题，但选择它是有历史原因的，幸运的是我们现在可以纠正这个问题。

一个更好的解决方案似乎是将公共核心代码变成一个库（不难）并让派生子链接到它。不幸的是，大部分通用功能都存在于 javascript（ExtJS 小部件等）中，因此仅生成 JAR 库是不够的。我们需要一种方法让“核心 javascript”文件进入子 webapps，尽管不可能真正将它们视为 java 类，我们的代码库通过利用 Ext JS 类系统可以做到最好。

我的问题是是否有任何解决方案可以帮助解决这个问题？有没有人有幸用 Maven 做类似的事情？这是一种罕见的情况，我可能不得不求助于创建自己的 Maven 插件，还是应该寻找新的构建工具？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T02:41:56.100

[maven-war-plugin](http://maven.apache.org/plugins/maven-war-plugin/index.html)的[覆盖](http://maven.apache.org/plugins/maven-war-plugin/overlays.html)功能可能会有所帮助。

常见的 js 文件（如果有意义的话，甚至可能是类）可以移动到单独的 war 文件中。如果它不会自行部署，您可以将 war 插件配置为不会在包含该元素的丢失`web.xml`文件上失败。`<failOnMissingWebXml>`然后，将覆盖配置添加到每个衍生战争。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T02:47:33.437

虽然有一个[maven javascript 插件](http://mojo.codehaus.org/javascript-maven-tools/)，但我建议使用比 maven 对您的构建更友好的东西。

您可以查看的一种选择是使用 gradle 及其出色的[js 插件](https://github.com/eriwen/gradle-js-plugin)：

```
// Pull the plugin from a Maven Repo
buildscript {
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath 'com.eriwen:gradle-js-plugin:0.4'
    }
}
// Invoke the plugin
apply plugin: 'js' 
```

您可以从文档中获取示例。请记住，这是 Groovy，因此您可以将“versions”添加为简单属性，例如“file-${file-version}.js”，其中“file-version”可以在单独的“versions”文件中定义，该文件可以是进口：

```
apply from: 'housekeeping/versions.gradle' 
```

这是一个关于如何“[使用 Gradle 合并、缩小和复制 JS 到 .war 文件](http://flashmattic.blogspot.com/2011/11/combine-minify-and-copy-your-jss-to.html)”的示例

再一次，Groovy 就是它听起来的样子 => 它就是 Groovy。在我看来，这是最适合您的 Java 构建的语言。

如果您需要，还有一个 gradle [CSS 插件](https://github.com/eriwen/gradle-css-plugin)。

* * *

另外，如果你有这样的选择，我会转向 git，因为在 git 中管理许多相关项目比在 SVN 中容易得多，因为不同的 repos 或[git submodules](http://book.git-scm.com/5_submodules.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T04:27:07.353

因此，在评估了一些不同的工具 + 想法后，我发现最适合我们项目的是 Maven 和 SVN 外部的组合。我们分别解决前端/后端依赖项：

**后端 - 核心**：将核心构建为典型的 JAR 包（这里没什么特别的）

**前端 - 核心**：将核心前端包含在与核心后端相同的存储库中。它将位于核心 JAR 构建未打包的 webapp 目录中，而是使用 maven 程序集插件将其单独打包到 ZIP 文件中：

*pom.xml*

```
<plugin>
    <artifactId>maven-assembly-plugin</artifactId>
    <version>2.3</version>
    <configuration>
        <descriptors>
            <descriptor>src/assembly/webapp.xml</descriptor>
        </descriptors>
    </configuration>
    <executions>
        <execution>
            <id>make-assembly</id>
            <phase>package</phase>
            <goals>
                <goal>single</goal>
            </goals>
        </execution>
    </executions>
</plugin> 
```

*webapp.xml*

```
<assembly>
    <id>webapp</id>
    <formats>
        <format>zip</format>
    </formats>
    <includeBaseDirectory>false</includeBaseDirectory>
    <fileSets>
        <fileSet>
            <directory>${project.basedir}/src/main/webapp/core/</directory>
            <outputDirectory/>
            <includes>
                <include>**</include>
            </includes>
        </fileSet>
    </fileSets>
</assembly> 
```

**后端 - 子级**：对核心的典型 maven 依赖

**Frontend - Child** : 要么使用 SVN 外部引用核心前端，要么*使用*放入 webapp 某处的预构建包。使用外部允许 Eclipse 透明地开发核心 + 子前端，使用预构建的包更容易管理，但更难迁移更改。

总体而言，该系统相对易于管理，唯一不直观的部分带有使 svn 外部复杂化的版本。但是通过“适当的”发布分支+标记，没有什么是无法处理的。

我还写了一篇博文比较和对比我们考虑的所有选项 - [https://cgsrv1.arrc.csiro.au/blog/2012/06/15/managing-an-extensible-javajavascript-application/](https://cgsrv1.arrc.csiro.au/blog/2012/06/15/managing-an-extensible-javajavascript-application/)

# objective-c - Objective-c中的无名类别和普通类别有什么区别？

> ID：10201974
> 
> 赞同：3
> 
> 时间：2012-04-18T02:28:32.993
> 
> 标签：objective-c, xcode4.2

> **可能重复：**
> [类别和类扩展之间的区别？](https://stackoverflow.com/questions/3499704/difference-between-category-and-class-extension)

我经常被告知，当你想将一个变量声明为私有时，你会在 .m 文件上创建一个无名类别。

与命名类别相比，无名类别有什么本质上的不同吗？

有什么不同？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T02:34:46.033

您所说的“无名类别”称为“类扩展”。

一个区别是编译器期望类扩展中的声明在类`@implementation`块中定义。`@implementation`也就是说，当扩展块与主块处于相同的翻译中时，您不会显式声明扩展`@implementation`块。为了您的方便，它们被合并了。因此，编译器可能会产生警告。

另一个区别是扩展可以声明合成的属性（并因此调整类型的大小），而常规类别则不能。除了属性之外，实例变量也可以在类扩展的`@interface`.

除此之外，这只是惯例。

# python - 如何在 Python 中反转元组？

> ID：10201977
> 
> 赞同：84
> 
> 时间：2012-04-18T02:28:44.193
> 
> 标签：python, loops, iteration, tuples

> **可能重复：**
> [在 Python 中以相反的顺序遍历列表](https://stackoverflow.com/questions/529424/traverse-a-list-in-reverse-order-in-python)

这可能吗？不必就位，只需寻找一种反转元组的方法，以便我可以向后迭代它。

* * *

## 回答 #1

> 赞同：158
> 
> 时间：2012-04-18T02:30:34.003

有两种惯用的方法可以做到这一点：

```
reversed(x)  # returns an iterator 
```

或者

```
x[::-1]  # returns a new tuple 
```

由于元组是不可变的，因此无法就地反转元组。

* * *

**编辑：** 基于@lvc 的评论，返回的迭代器`reversed`相当于

```
def myreversed(seq):
    for i in range(len(x) - 1, -1, -1):
        yield seq[i] 
```

即它依赖于具有已知长度的序列以避免必须实际反转元组。

至于哪个更有效，我怀疑`seq[::-1]`如果你全部使用它并且元组很小，`reversed`当元组很大时，但python中的性能通常令人惊讶，所以测量它！

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-04-18T02:30:46.180

您可以使用`reversed`内置函数。

```
>>> x = (1, 2, 3, 4)
>>> x = tuple(reversed(x))
>>> x
(4, 3, 2, 1) 
```

如果你只是想对元组进行迭代，你可以直接使用返回的迭代器，`reversed`而无需再次将其转换为元组。

```
>>> for k in reversed(x):
...     print(k)
... 
4 3 2 1 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-04-18T02:31:19.853

类似于反转列表的方式，即 s[::-1]

```
In [20]: s = (1, 2, 3)

In [21]: s[::-1]
Out[21]: (3, 2, 1) 
```

和

```
In [24]: for i in s[::-1]:
   ....:     print i
   ....:
3
2
1 
```

# android - 移动到页面时如何刷新片段

> ID：10201979
> 
> 赞同：0
> 
> 时间：2012-04-18T02:28:54.953
> 
> 标签：android, fragment

我在 ViewPager 中有 FragmentA ，FragmentB ，FragmentC

当应用程序第一次运行时，我在 FragmentA 上声明

FragmentB 创建和调用方法 onResume() 自动

当我移动到 FragmentB 时，我想再次调用方法 onResume()

重新开始一些动画。

怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T03:04:59.333

您将需要实现 a [`ViewPager.OnPageChangeListener`](http://developer.android.com/reference/android/support/v4/view/ViewPager.OnPageChangeListener.html)（或 a [`ViewPager.SimpleOnPageChangeListener`](http://developer.android.com/reference/android/support/v4/view/ViewPager.SimpleOnPageChangeListener.html)）并将其附加到 ViewPager。根据您想要的效果，您可以使用以下两个选项之一：

1.  `onPageSelected(int position)`（结合`SCROLL_STATE_SETTLING`） - 当滚动状态改变时调用。
2.  `onPageScrollStateChanged(int state)`- This method will be invoked when a new page becomes selected.

然后，您可以在调用这些方法时（重新）启动动画。

# sql-server-2005 - 使用管道分隔符将 SELECT 查询输出保存到文本文件

> ID：10201982
> 
> 赞同：1
> 
> 时间：2012-04-18T02:29:39.123
> 
> 标签：sql-server-2005

```
EXEC master.dbo.sp_configure 'show advanced options', 1
RECONFIGURE
EXEC master.dbo.sp_configure 'xp_cmdshell', 1
RECONFIGURE 

--EXEC master..xp_cmdshell'bcp "SELECT TOP 5 CUSTOMERID FROM Northwind.dbo.Customers" queryout "c:\text.txt" -c -T -x' 
```

现在我得到了结果，但它不是管道定界符我需要用管道作为定界符来获得结果我怎样才能完成它

谢谢王子

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T03:14:50.040

您可以使用命令行`osql`命令：

```
osql -S server -d database -E ^
  -Q "SELECT TOP 5 CUSTOMERID FROM Northwind.dbo.Customers" ^
  -s "|" -w 500 > c:\text.txt 
```

# java - 当用户点击后退按钮时，如何重建客户端修改的页面？

> ID：10201984
> 
> 赞同：1
> 
> 时间：2012-04-18T02:29:58.657
> 
> 标签：java, client-side, infinite-scroll

假设我使用无限滚动或“加载更多结果”按钮来实现搜索结果，该按钮将更多结果 Ajaxes 到初始结果页面上。因此，用户可以在不离开相同搜索结果页面的情况下浏览结果。

我的用户滚动了一会儿，然后找到一个特定的结果并点击它。这不是他们需要的，所以他们点击返回。

如何让结果页面恢复到他们离开时的状态，并让他们向下滚动页面到正确的位置？最初的搜索可能产生了 10 个结果，如果我们再加载 20 个，那么页面上就有 30 个，并且说当他们离开页面时滚动到结果 23。

这样做的公认方法是什么？

（请注意，这并不特定于搜索结果。通常，如果我在浏览器中加载页面后弄乱了页面，当用户返回该页面时，我如何保留/重建该页面的状态？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T13:33:59.290

有多种方法可以解决这个问题。

*   假设您正在处理搜索结果。每当您将更多结果加载到视图中时，下一个搜索结果的起始索引就会上升。

    在第三次加载 10 个元素后，您的起始索引将为 40。

    现在您可以将此索引作为散列动态放入 URL 中，例如将其扩展为`http://mysite.com/search?q=searchterm#startindex=40`. 现在，如果用户单击搜索结果然后返回，您将能够从 URL 中提取该值并将适当数量的附加结果加载到视图中。
    可以选择将用户滚动到或多或少的最后一个位置。

    这个原则与使用 cookie、localStorage、会话参数或你所拥有的东西而不是 URL 哈希类似。

*   您可以将完整的搜索结果保存在客户端，例如 localStorage 并（在“后退”按钮之后）从那里读取并将其注入页面。这样，您不必再次从服务器请求它，并且反应性可能会更好。

    此时，您还可以保存并恢复用户的滚动位置，使他回到页面上的位置。

我目前正在处理类似的问题，我认为将使用第二种方法。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-18T03:11:14.583

一种方法是以编程方式模拟浏览器。使用**javascript 历史**对象。您可以放置​​一个按钮并在单击时调用 go() 函数，如下所示

```
history.go(-1) 
```

这只会将您带到上一页。

[有关更多详细信息，请参见此处](http://www.crowderassoc.com/javascript/backbutton.html)。

# pthreads - 在 pthread_mutex_t 中存储一个指针

> ID：10201987
> 
> 赞同：2
> 
> 时间：2012-04-18T02:30:14.087
> 
> 标签：pthreads, mutex

我正在使用 C 语言开发一个项目，该项目涉及通过覆盖 pthread.h 创建用户级线程库。我目前正在研究互斥体功能。

在我的实现中，我将互斥锁存储为结构的链接列表。我想在 pthread_mutex_init 中做的是将指针存储到 pthread_mutex_t 互斥变量中新创建的互斥锁元素的指针。不过，这可能吗？这是我的一些代码，因此您可以了解我要做什么：

```
typedef struct mutexList
{
    int mid;
    struct mutexList *prevMutex;
    struct mutexList *nextMutex;
    int locked;
    struct queueItem *owner;
    struct blockedThread *blockedHead;
    struct blockedThread *blockedTail;
} mutexElement;

int mutexCounter = 0;

mutexElement *mutexHead = NULL;
mutexElement *mutexTail = NULL;

int pthread_mutex_init(pthread_mutex_t *mutex, const pthread_mutexattr_t *attr)
{
    mutexElement *newMutex = (mutexElement *) malloc(sizeof(mutexElement));

    fprintf(stdout, "***LOG: Creating new mutex.\n");

    if(newMutex == NULL)
        return ENOMEM;
    newMutex->mid = mutexCounter;
    mutexCounter++;
    newMutex->locked = 0;
    newMutex->nextMutex = NULL;
    newMutex->blockedHead = NULL;
    newMutex->blockedTail = NULL;

    if(mutexHead == NULL)
        mutexHead = newMutex;

    if(mutexTail != NULL)
        mutexTail->nextMutex = newMutex;

    mutexTail = newMutex;

    mutex = (&newMutex);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T09:21:30.830

我认为您的一般想法可以工作，但是您的特定示例至少存在一些问题：

*   您的`mutexCounter`,`mutexHead`和`mutexTail`项目没有以线程安全的方式处理（这种库的一个重要属性）
*   该行`mutex = (&newMutex);`毫无意义 -`mutex`是一个参数，它是用户参数的副本。当你的函数返回时，`mutex`它就不再存在了；它不会返回给调用者。
*   甚至一开始就试图返回`&newMutex`给用户也是一个问题：`newMutex`是一个局部变量，会在函数返回时过期。将指向它的指针存储在应该超过当前函数调用持续时间的东西中是行不通的。

请注意，我并不是说以上是详尽的问题列表——它们只是突然出现的问题。

您可以将`pthread_mutex_t`类型设为 a 的 typedef`struct mutexList*`并将`newMutex`（*不是*的地址`newMutex`）的值放入其中，`*mutex`因为`mutex`将是 a `struct mutexList**`。用户的`pthread_mutex_t`变量将包含一个指向您的链表上的结构的指针。

如果用户忽略调用`pthread_mutex_destroy()`并让他的`pthread_mutex_t`变量超出范围，那么`struct mutexList`分配的元素将永远不会被释放，但这是一个用户错误，您真的无能为力。

就互斥体初始化而言，还有一个您仍然需要考虑的大问题——静态初始化。允许用户执行以下操作：

```
// the following is at file scope, so it has static duration
pthread_mutex_t myMutex = PTHREAD_MUTEX_INITIALIZER; 
```

在这种情况下，用户不需要调用`pthread_mutex_init()`——事实上，这样做是错误的。您的库将需要在首次使用（或等效的东西）时检测并执行这些静态初始化的互斥锁所需的任何适当的动态初始化。而且您必须以线程安全的方式进行 - 第一次使用不仅允许在任意线程上完成，这些静态互斥锁的主要用例之一是允许立即争用互斥锁（例如由碰巧到达它的第一个线程对其他静态数据执行更复杂的初始化）。

总而言之，我认为保留私有互斥数据结构容器并让用户`pthread_mutex_t`变量本质上是指向容器中适当项目的指针（或其他一些间接引用）的一般方法很好。然而，有很多复杂的细节——尤其是确保你的函数是线程安全的——需要考虑和设计。

示例中存在的各种问题表明，到目前为止，该设计还没有得到足够的考虑。那可能没问题——也许你刚刚开始；只是不要低估你需要给予这些东西的对细节的关注。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T02:53:59.170

由于用户可以自由地将他们的互斥体声明为自动变量或将它们声明为指向从 eg 分配的内存的指针`malloc(3)`，我对将互斥体结构存储在全局链表上持怀疑态度——听起来它们中的一个很可能会消失。范围并导致垃圾。（当然，用户应该销毁他们的互斥锁，但我不想相信那么远。）

考虑手册页中的以下代码`pthread_mutex_init(3posix)`：

```
static pthread_mutex_t foo_mutex;

void foo_init()
{
    pthread_mutex_init(&foo_mutex, NULL);
} 
```

此代码使用`static`-allocated `foo_mutex`，但也可以是`auto`-allocated ；当您创建一个新的`mutexElement`并尝试通过`*mutex`指针分配回时，您的代码将不适用于这种情况......

也就是说，我认为您要查找的内容非常简单：

```
int pthread_mutex_init(pthread_mutex_t *m, const pthread_mutexattr_t *attr) {
    m->base_address = m;
    /* ... your other work ... */
} 
```