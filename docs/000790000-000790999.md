# StackOverflow 问答 000790000-000790999

# python - 无法在 dev_server 上运行 appengine-admin

> ID：790001
> 
> 赞同：4
> 
> 时间：2009-04-26T00:26:49.310
> 
> 标签：python, google-app-engine

我决定尝试这个项目：

[http://code.google.com/p/appengine-admin/wiki/QuickStart](http://code.google.com/p/appengine-admin/wiki/QuickStart)

为了进行实验，我使用了 App Engine 随附的演示留言簿。进口园区是这样的：

```
import cgi
import datetime
import wsgiref.handlers

from google.appengine.ext import db
from google.appengine.api import users
from google.appengine.ext import webapp
from google.appengine.ext.webapp.util import run_wsgi_app
from google import appengine_admin 
```

db 模型和管理员如下所示：

```
class Greeting(db.Model):

 author = db.UserProperty()
 content = db.StringProperty(multiline=True)
 date = db.DateTimeProperty(auto_now_add=True)

class AdminGreeting(appengine_admin.ModelAdmin):

 model = Greeting
 listFields = ('author','content','date')
 editFields = ('author','content','date')

appengine_admin.register(AdminGreeting) 
```

然而我得到了这个异常，试图运行该站点：

```
File "/home/<username>/python/google_appengine/google/appengine/tools/    dev_appserver.py", line 2875, in _HandleRequest
    base_env_dict=env_dict)
  File "/home/<username>/python/google_appengine/google/appengine/tools/dev_appserver.py", line 387, in Dispatch
    base_env_dict=base_env_dict)
  File "/home/<username>/python/google_appengine/google/appengine/tools/dev_appserver.py", line 2162, in Dispatch
    self._module_dict)
  File "/home/<username>/python/google_appengine/google/appengine/tools/dev_appserver.py", line 2080, in ExecuteCGI
    reset_modules = exec_script(handler_path, cgi_path, hook)
  File "/home/<username>/python/google_appengine/google/appengine/tools/dev_appserver.py", line 1976, in ExecuteOrImportScript
    exec module_code in script_module.__dict__
  File "/home/<username>/python/google_appengine/demos/guestbook/guestbook.py", line 37, in <module>
    appengine_admin.register(AdminGreeting)
  File "/home/<username>/python/google_appengine/google/appengine_admin/model_register.py", line 120, in register
    modelAdminInstance = modelAdminClass()
  File "/home/<username>/python/google_appengine/google/appengine_admin/model_register.py", line 64, in __init__
    self._extractProperties(self.listFields, self._listProperties)
  File "/home/<username>/python/google_appengine/google/appengine_admin/model_register.py", line 76, in _extractProperties
    storage.append(PropertyWrapper(getattr(self.model, propertyName), propertyName))
  File "/home/<username>/python/google_appengine/google/appengine_admin/model_register.py", line 17, in __init__
    logging.info("Caching info about property '%s'" % name)
  File "/usr/lib/python2.6/logging/__init__.py", line 1451, in info
    root.info(*((msg,)+args), **kwargs)
  File "/usr/lib/python2.6/logging/__init__.py", line 1030, in info
    self._log(INFO, msg, args, **kwargs)
  File "/usr/lib/python2.6/logging/__init__.py", line 1142, in _log
record = self.makeRecord(self.name, level, fn, lno, msg, args, exc_info, func, extra)
  File "/usr/lib/python2.6/logging/__init__.py", line 1117, in makeRecord
rv = LogRecord(name, level, fn, lno, msg, args, exc_info, func)
  File "/usr/lib/python2.6/logging/__init__.py", line 272, in __init__
from multiprocessing import current_process
  File "/home/<username>/python/google_appengine/google/appengine/tools/dev_appserver.py", line 1089, in decorate
return func(self, *args, **kwargs)
  File "/home/<username>/python/google_appengine/google/appengine/tools/dev_appserver.py", line 1736, in load_module
return self.FindAndLoadModule(submodule, fullname, search_path)
  File "/home/<username>/python/google_appengine/google/appengine/tools/dev_appserver.py", line 1089, in decorate
    return func(self, *args, **kwargs)
  File "/home/<username>/python/google_appengine/google/appengine/tools/dev_appserver.py", line 1638, in FindAndLoadModule
description)
  File "/home/<username>/python/google_appengine/google/appengine/tools/dev_appserver.py", line 1089, in decorate
return func(self, *args, **kwargs)
  File "/home/<username>/python/google_appengine/google/appengine/tools/dev_appserver.py", line 1589, in LoadModuleRestricted
description)
  File "/usr/lib/python2.6/multiprocessing/__init__.py", line 83, in <module>
    import _multiprocessing
ImportError: No module named _multiprocessing
INFO     2009-04-25 23:34:27,628 dev_appserver.py:2934] "GET / HTTP/1.1" 500 - 
```

知道可能出了什么问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-26T04:28:38.217

您似乎正在使用 Python 2.6（鉴于某些消息来自 /usr/lib/python2.6 中的文件 ...！），但 Google App Engine 需要 Python 2.5（任何 2.5.x 都适用于任何版本x)，因此您应该安装并使用它来运行 App Engine SDK。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-08-04T04:44:46.647

Google App Engine 仅支持 Python 2.5，并且您使用的是更新版本。

通过查看您的目录，您可能使用的是 Linux（或者是 Mac？）。例如，在 Ubuntu 上，您可以“sudo apt-get install python2.5”（它根本不会影响您的 Python 2.6），然后不是：

```
<path-to-gae>/dev_appserver.py ... 
```

做

```
python2.5 <path-to-gae>/dev_appserver.py ... 
```

这比在 2.6 上愉快地开发和在 2.5 上部署要好，这肯定会在以后带来麻烦。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-11-15T05:10:18.087

正如其他人所说，这个问题发生在 Python 2.6 中。[我在 App Engine 问题跟踪器中](http://code.google.com/p/googleappengine/issues/detail?id=1504#c7)使用了此评论中提出的修复：

```
A quickfix is to create a file in your app's root named `_multiprocessing.py' with 
the contents:

  import multiprocessing

This way it's possible to import the _multiprocessing module.

It worked for me using Python 2.6.2

Cheers,
Kaji 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-09-03T10:03:03.830

为了在我的本地机器（使用 2.6）和 GAE 上完成这项工作，我使用了：

```
import sys, logging
if sys.version[:3] == "2.6": logging.logMultiprocessing = 0 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-16T21:26:49.337

```
import logging
logging.logMultiprocessing = 0 
```

为我工作

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-05T10:28:23.890

只需在您的 something.py 顶部执行以下操作

导入日志记录 logging.logMultiprocessing = 0

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-05T02:42:49.983

它表明我一直在使用带有 python2.6（可能是 2.6.1）的 GAE，并且一切正常。

但是现在我得到了相同的 _multiprocess 导入错误。（python2.6.2）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-04T15:30:55.367

```
import logging
logging.logMultiprocessing = 0 
```

也为我工作。在上传到 GAE 之前，请注释这些行。

# java - 尝试使用 apache commons httpclient 类登录到 https 安全的问题

> ID：790004
> 
> 赞同：4
> 
> 时间：2009-04-26T00:28:28.230
> 
> 标签：java, apache-commons-httpclient

我正在尝试使用 Apache commons httpclient 登录到 https 安全站点。

我没有任何方法可以将证书与我的 httprequest 一起传递，因为我在 HttpClient 包中找不到任何此类。

如果有人可以指导我在哪里需要添加证书处理？

有什么包可以做吗？

我对想法持开放态度，任何其他在java中做到这一点的方式。该平台必须只是java但是..

我在下面发布了我的代码。

```
import java.net.MalformedURLException;
import org.apache.commons.httpclient.*;
import org.apache.commons.httpclient.cookie.CookiePolicy;
import org.apache.commons.httpclient.cookie.CookieSpec;
import org.apache.commons.httpclient.methods.*;
import org.apache.commons.httpclient.protocol.Protocol;
import org.apache.commons.httpclient.protocol.SSLProtocolSocketFactory;

import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.net.URL;

public class TestHttpClient {
public static String formPostUrl ="https://login.findmespot.com/faces/welcome.jsp" ;
public static String LOGON_SITE = "login.findmespot.com";
static final int    LOGON_PORT = 443;
public static void main(String[] args ) throws MalformedURLException
{
   // AuthSSLProtocolSocketFactory ar= new AuthSSLProtocolSocketFactory(uRL, formPostUrl, uRL0, formPostUrl)
     //Protocol authhttps = new  Protocol("https", new AuthSSLProtocolSocketFactory(new URL("D:\key\my.keystore"), "4cKR!Z%p",new URL("D:\key\my.truststore"), "4cKR!Z%p"), 443);

    HttpClient client = new HttpClient();

    client.getHostConfiguration().setHost("login.findmespot.com",443,authhttps);
    HttpMethod authGetmethod = new GetMethod("/index.jsp");
        authGetmethod.setRequestHeader("User-Agent", "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.0.9) Gecko/2009040821 Firefox/3.0.9");
        authGetmethod.setRequestHeader("Accept","text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8");
        authGetmethod.setRequestHeader("Accept-Language","en-us,en;q=0.5");
        authGetmethod.setRequestHeader("Accept-Encoding","gzip,deflate");
        authGetmethod.setRequestHeader("Accept-Charset","ISO-8859-1,utf-8;q=0.7,*;q=0.7");
        authGetmethod.setRequestHeader("Keep-Alive","300");
        authGetmethod.setRequestHeader("Connection","keep-alive");
        authGetmethod.setRequestHeader("Referer","https://login.findmespot.com/faces/welcome.jsp");

    client.getParams().setCookiePolicy(CookiePolicy.BROWSER_COMPATIBILITY);

    try
    {
    //send first request to capture cookie information
    int status = client.executeMethod(authGetmethod);

    BufferedReader br   = new  BufferedReader(new InputStreamReader(authGetmethod.getResponseBodyAsStream()));

      String str ="";
      String resultJsessionid="";
             while((str=br.readLine())!=null )
               {
                 if(str.indexOf("jsessionid=")!=-1)
                 {
                     //capture Session ID
                     resultJsessionid=getJsessionid(str);
                  break;
                 }
               }

      //release connection for final login request
      authGetmethod.releaseConnection();

      //Process the Initial Set of Cookies

      CookieSpec cookiespec = CookiePolicy.getDefaultSpec();
        Cookie[] initcookies = cookiespec.match(
            LOGON_SITE, LOGON_PORT, "/", false, client.getState().getCookies());
        System.out.println("Initial set of cookies:");
        if (initcookies.length == 0) {
            System.out.println("None");
        } else {
            for (int i = 0; i < initcookies.length; i++) {
                System.out.println("- " + initcookies[i].toString());
            }
        }

        //try to login to the form

        PostMethod authpost = new PostMethod("/faces/welcome.jsp?jessionid="+resultJsessionid );
        // Set Headers

        authpost.setRequestHeader("User-Agent", "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.0.9) Gecko/2009040821 Firefox/3.0.9");
        authpost.setRequestHeader("Accept","text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8");
        authpost.setRequestHeader("Accept-Language","en-us,en;q=0.5");
        authpost.setRequestHeader("Accept-Encoding","gzip,deflate");
        authpost.setRequestHeader("Accept-Charset","ISO-8859-1,utf-8;q=0.7,*;q=0.7");
        authpost.setRequestHeader("Keep-Alive","300");
        authpost.setRequestHeader("Connection","keep-alive");
        authpost.setRequestHeader("Referer","https://login.findmespot.com/faces/welcome.jsp");

        // Prepare login parameters
        NameValuePair inputtext1      = new NameValuePair("inputText1","TANGOFOUR");
        NameValuePair inputtext5   = new NameValuePair("inputText5", "4cKR%21Z%25p");
        NameValuePair oafF = new NameValuePair("oracle.adf.faces.FORM", "form11");
        NameValuePair source      = new NameValuePair("source","commandButton1");
        NameValuePair event   = new NameValuePair("event", "update");
        NameValuePair partialTarget = new NameValuePair("partialTarget", "");
        NameValuePair partial = new NameValuePair("partial", "true");

        authpost.setRequestBody(
          new NameValuePair[] {inputtext1,inputtext5,oafF,source,event,partialTarget,partial});

        client.executeMethod(authpost);
        System.out.println("Login form post: " + authpost.getStatusLine().toString());
        // release any connection resources used by the method
        authpost.releaseConnection();
        // See if we got any cookies
        // The only way of telling whether logon succeeded is
        // by finding a session cookie
        Cookie[] logoncookies = cookiespec.match(
            LOGON_SITE, LOGON_PORT, "/", false, client.getState().getCookies());
        System.out.println("Logon cookies:");
        if (logoncookies.length == 0) {
            System.out.println("None");
        } else {
            for (int i = 0; i < logoncookies.length; i++) {
                System.out.println("- " + logoncookies[i].toString());
            }
        }

    System.out.println(resultJsessionid);
    }
    catch(Exception ex)
    {
        System.out.println(ex.getMessage());
    }

}
public static String getJsessionid(String responseText)
{

    String jsession="";
    int start_index= responseText.indexOf("jsessionid=");
    if(start_index!=-1)
    {
       jsession= responseText.substring(start_index+11);
    }
    int last_index=jsession.indexOf("\"");
    if(last_index!=-1)
    jsession=jsession.substring(0,last_index);
 return jsession;
}

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-27T20:07:49.540

好的，最后我做了一些挖掘并自己找到了解决方案，

我正在粘贴工作代码以使用 Http client 3.1 登录 SSL 支持的 https 站点。寻找任何反馈，如果有更好的方法呢？

```
import java.net.MalformedURLException;
import org.apache.commons.httpclient.*;
import org.apache.commons.httpclient.cookie.CookiePolicy;
import org.apache.commons.httpclient.cookie.CookieSpec;
import org.apache.commons.httpclient.methods.*;
import org.apache.commons.httpclient.protocol.Protocol;
import org.apache.commons.httpclient.protocol.SSLProtocolSocketFactory;

import java.io.BufferedReader;
import java.io.FileOutputStream;
import java.io.InputStreamReader;
import java.net.URL;

public class TestHttpClient {
public static String formPostUrl ="https://login.findmespot.com/faces/welcome.jsp" ;
public static String LOGON_SITE = "login.findmespot.com";
static final int    LOGON_PORT = 443;
public static void main(String[] args ) throws MalformedURLException
{
        String nextHref="";
        HttpClient client = new HttpClient();

        HttpMethod authGetmethod = new GetMethod("https://login.findmespot.com/index.jsp");
        authGetmethod.setRequestHeader("User-Agent", "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.0.9) Gecko/2009040821 Firefox/3.0.9");
        authGetmethod.setRequestHeader("Accept","text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8");
        authGetmethod.setRequestHeader("Accept-Language","en-us,en;q=0.5");
        authGetmethod.setRequestHeader("Accept-Encoding","gzip,deflate");
        authGetmethod.setRequestHeader("Accept-Charset","ISO-8859-1,utf-8;q=0.7,*;q=0.7");
        authGetmethod.setRequestHeader("Keep-Alive","300");
        authGetmethod.setRequestHeader("Connection","keep-alive");

        //authGetmethod.setRequestHeader("Referer","https://login.findmespot.com/faces/welcome.jsp");

    try
    {
        //send first request to capture cookie information
       int status = client.executeMethod(authGetmethod);

      BufferedReader br   = new  BufferedReader(new InputStreamReader(authGetmethod.getResponseBodyAsStream()));

       String str ="";
       String resultJsessionid="";
             while((str=br.readLine())!=null )
               {
                 if(str.indexOf("jsessionid=")!=-1)
                 {
                     //capture Session ID
                     resultJsessionid=getJsessionid(str);
                  break;
                 }
               }

           //release connection for final login request
      authGetmethod.releaseConnection();

           client.getParams().setCookiePolicy(CookiePolicy.BROWSER_COMPATIBILITY);

       Cookie[] cookies = client.getState().getCookies();
      for (int i = 0; i < cookies.length; i++) {
        Cookie cookie = cookies[i];
        System.err.println(
          "Cookie: " + cookie.getName() +
          ", Value: " + cookie.getValue() +
          ", IsPersistent?: " + cookie.isPersistent() +
          ", Expiry Date: " + cookie.getExpiryDate() +
          ", Comment: " + cookie.getComment());

        //PostMethod authpost = new PostMethod("https://login.findmespot.com/faces/welcome.jsp?jessionid="+resultJsessionid );
        PostMethod authpost = new PostMethod("https://login.findmespot.com/faces/welcome.jsp");
        // Set Headers
        authpost.setRequestHeader("http.Agent", "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.0.9) Gecko/2009040821 Firefox/3.0.9");
        authpost.setRequestHeader("Accept","text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8");
        authpost.setRequestHeader("Accept-Language","en-us,en;q=0.5");
        authpost.setRequestHeader("Accept-Encoding","gzip,deflate");
        authpost.setRequestHeader("Accept-Charset","ISO-8859-1,utf-8;q=0.7,*;q=0.7");
        authpost.setRequestHeader("Keep-Alive","300");
        authpost.setRequestHeader("Connection","keep-alive");
        authpost.setRequestHeader("Referer","https://login.findmespot.com/faces/index.jsp");

        // Prepare login parameters
        NameValuePair inputtext1      = new NameValuePair("inputText1","TANGOFOUR");
        NameValuePair inputtext5   = new NameValuePair("inputText5", "~CcxpqFR");
        NameValuePair oafF = new NameValuePair("oracle.adf.faces.FORM", "form11");
        NameValuePair source      = new NameValuePair("source","commandButton1");
        NameValuePair event   = new NameValuePair("event", "update");
        NameValuePair partialTarget = new NameValuePair("partialTarget", "");
        NameValuePair partial = new NameValuePair("partial", "true");

        authpost.setRequestBody(
          new NameValuePair[] {inputtext1,inputtext5,oafF,source,event,partialTarget,partial});

        client.executeMethod(authpost);
        System.out.println("Login form post: " + authpost.getStatusLine().toString());
        // release any connection resources used by the method

        String readLine;

          br = new BufferedReader(new InputStreamReader(authpost.getResponseBodyAsStream()));
             while(((readLine = br.readLine()) != null)) {
              System.out.println(readLine);
              nextHref=getNexthref(readLine);
          }

          authpost.releaseConnection();

         Cookie[] cookies1 = client.getState().getCookies();
            for (int i1 = 0; i < cookies1.length; i++) {
        Cookie cookie1 = cookies1[i1];
        System.err.println(
          "Cookie: " + cookie1.getName() +
          ", Value: " + cookie1.getValue() +
          ", IsPersistent?: " + cookie1.isPersistent() +
          ", Expiry Date: " + cookie1.getExpiryDate() +
          ", Comment: " + cookie1.getComment());

       HttpMethod authGetmethodNext = new GetMethod("https://login.findmespot.com"+nextHref);
        authGetmethodNext.setRequestHeader("User-Agent", "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.0.9) Gecko/2009040821 Firefox/3.0.9");
        authGetmethodNext.setRequestHeader("Accept","text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8");
        authGetmethodNext.setRequestHeader("Accept-Language","en-us,en;q=0.5");
        authGetmethodNext.setRequestHeader("Accept-Encoding","gzip,deflate");
        authGetmethodNext.setRequestHeader("Accept-Charset","ISO-8859-1,utf-8;q=0.7,*;q=0.7");
        authGetmethodNext.setRequestHeader("Keep-Alive","300");
        authGetmethodNext.setRequestHeader("Connection","keep-alive");
        authGetmethodNext.setRequestHeader("Referer","https://login.findmespot.com/faces/welcome.jsp");

        client.executeMethod(authGetmethodNext);
         System.out.println("Login form post: " + authGetmethodNext.getStatusLine().toString());

        PostMethod authpost1 = new PostMethod("https://login.findmespot.com/faces/history.jsp");
        // Set Headers
        authpost1.setRequestHeader("http.Agent", "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.0.9) Gecko/2009040821 Firefox/3.0.9");
        authpost1.setRequestHeader("Accept","text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8");
        authpost1.setRequestHeader("Accept-Language","en-us,en;q=0.5");
        authpost1.setRequestHeader("Accept-Encoding","gzip,deflate");
        authpost1.setRequestHeader("Accept-Charset","ISO-8859-1,utf-8;q=0.7,*;q=0.7");
        authpost1.setRequestHeader("Keep-Alive","300");
        authpost1.setRequestHeader("Connection","keep-alive");
        authpost1.setRequestHeader("Referer","Referer: https://login.findmespot.com/faces/trackerunit.jsp");

               client.executeMethod(authpost1);

           br = new BufferedReader(new InputStreamReader(authpost1.getResponseBodyAsStream()));
             while(((readLine = br.readLine()) != null))
             {
              System.out.println(readLine);
              }

      }
      }
    }
  catch(Exception ex)
   {
        System.out.println(ex.getMessage());
    }

}
public static String getJsessionid(String responseText) /// retu
{

    String jsession="";
    int start_index= responseText.indexOf("jsessionid=");
    if(start_index!=-1)
    {
       jsession= responseText.substring(start_index+11);
    }
    int last_index=jsession.indexOf("\"");
    if(last_index!=-1)
    jsession=jsession.substring(0,last_index);
 return jsession;
}

public static String getNexthref(String inputhref)
{
   String result_href="";
   int start_index=inputhref.indexOf("href='");
     if(start_index!=-1)
   {
       result_href=inputhref.substring(start_index+6);
   }
     int last_index=result_href.indexOf("'");
   if(last_index!=-1)
       result_href=result_href.substring(0,last_index);

   return result_href;

}

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T02:52:25.450

我会问你使用的是什么版本的 Java，因为基于很久以前发生在我身上的事情：Java 有它自己的 SSL 证书，它是库的一部分。一段时间后，此证书将过期。修复是更新到更高版本的 Java。请注意，这是很久以前的事了，但我认为这可能是您的问题。

[另请参阅](http://hc.apache.org/httpclient-3.x/sslguide.html)。（同样，高度依赖于 java 和 httpclient 的版本）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T12:14:09.063

在 HttpClient 3.0* 的贡献部分中，有一组 SSL 协议工厂可以让您的生活更轻松。另请查看[commons-ssl](http://juliusdavies.ca/commons-ssl)

# objective-c - 全局变量作为单例的别名？

> ID：790014
> 
> 赞同：0
> 
> 时间：2009-04-26T00:35:36.170
> 
> 标签：objective-c, cocoa, oop, naming-conventions, singleton

我正在开发一个 Cocoa (Touch) 应用程序，并且我必须在不同的视图和控制器之间保留某些数据（如自己的设备信息和位置列表）。

我想把它作为实例变量存储在我的 App Delegate 中，但是对委托进行寻址非常麻烦（每次我想访问位置数组时都没有乐趣`[[[UIApplication sharedApplication] delegate] locations]`，而且它有很多地方），所以我想引入某种别名（a la NSApp）代表，但除了 NSApp 我在其他 Cocoa 应用程序中没有经常看到这种情况。

我还想更进一步，为我的单例类引入别名，所以`[State sharedState]`为什么不将类重命名为`_State`并创建一个名为 State 的单个实例呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T00:42:42.953

我可能会写一个像 LocationManager 这样的类，它给一个带有 [LocationManager sharedManager] 或类似的单例。通过委托调用会破坏封装（并且您通过 3 个对象调用以到达那里）。即使是 NSApp 风格的#define 也不能解决这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T04:07:05.643

使用方法调用来获取单例的主要目的是可以延迟准备单例。例如：

```
static State sharedStateInstance;

@implementation State
+ (id)sharedState {
    if (!sharedStateInstance)
        sharedStateInstance = /* Allocate instance */;
    return sharedStateInstance;
}
@end 
```

因此，这意味着如果没有代码调用`+sharedState`，则不会花费任何资源来创建它。

此外，如果将来出现其他需求，例如确保每个线程有一个实例，或者所有线程都有一个共享实例（然后需要在初始化时锁定代码），则可以在一个地方改进此代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T22:46:29.167

`[Foo sharedFoo]`Cocoa 鼓励使用而不是使用全局 Foo 对象有几个原因。

[Foo sharedFoo] 可以在第一次使用时自动实例化。

用大写字母命名实例非常令人困惑，因为它看起来像一个类，鼓励错误。命名的一致性是良好 Objective-C 的核心。由于 ObjC 是高度动态的，因此编译器无法保护您免受各种错误的影响。良好的命名和一致性的自律是导致无错误的 Cocoa 的原因。

并行性：

```
Foo *foo = [Foo sharedFoo];
Foo *foo = [[[Foo alloc] init] autorelease];
Foo *foo = [Bar fooAtIndex:0]; 
```

所有这三个可能在同一个程序中都是合法的。仅仅因为有一个单例实例并不意味着也没有其他实例。NSNotificationCenter 就是一个很好的例子。这是一个单例，但您可以创建其他实例（并且有理由这样做）。

全局变量可以被全局修改。A`sharedInstance`不可能。例如，如果`State`是一个全局变量（而不是一个类），那么`State=nil`在程序的任何地方都是合法的。这破坏了封装，并且是一个简单的错字，`state=nil`因为编译器无法捕捉到它。如果`State`是一个类，那么编译器可以捕捉到这个简单的错误。

Cocoa 命名的许多规则是为了鼓励高度可读的代码，并在高度动态和松散类型的环境中最大限度地减少错误。像 Perl 一样`use strict`，在放弃我们所拥有的小安全网之前，我们应该非常小心。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-26T00:38:51.217

```
#define FOO [[[UIApplication sharedApplication] delegate] locations] 
```

# c# - C#/.net 中简单游戏图形的最佳解决方案

> ID：790017
> 
> 赞同：5
> 
> 时间：2009-04-26T00:36:07.277
> 
> 标签：c#, graphics

我正在用 C# 制作一个基于回合的自上而下的游戏。图形要求非常简单：它完全是 2D 的，需要绘制一些从图形文件中获取的图像（可能先旋转它们），绘制线以制作六角网格，并且能够将文本放置在屏幕上的任何位置。

我想知道做这些图形的最佳 API 是什么。XNA 是否为此矫枉过正，有更合适的吗？谢谢（我在.net 中的图形或游戏开发经验为零，所以不要害怕回答任何问题）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T01:21:57.633

我会为此推荐 XNA。如果您不想要 XNA 的一些开销，我发现 SlimDX 是一个非常好的小框架。他们还提供了一些基本的游戏类来简化这类事情。

直接在 WPF 中进行绘图也相当容易，但以后更难扩展。XNA 和 SlimDX 让您可以访问着色器、非常精细的 alpha 混合控制，以及在需要时轻松将部分扩展为 3D 的潜力。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T01:11:29.810

我会推荐WPF。加载图形并移动它们应该相当容易。由于 WPF 也是基于矢量的，因此您的线条画是直截了当的。

XNA 将是下一步。对精灵图形的大力支持，还可以让您访问着色器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-26T00:41:16.810

我之前使用过 Farseer Physics 引擎，它非常酷且非常容易上手（我是企业开发人员，而不是游戏开发人员）。它适用于 Silverlight，因此您实际上可以使您的游戏基于 Web。我建议用于 2D 的 silverlight 或 WPF。

[http://www.codeplex.com/FarseerPhysics](http://www.codeplex.com/FarseerPhysics)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-26T01:08:52.627

鉴于您的要求，您可以只使用普通的 C# 和 GDI（用于 2d 光栅）。但是学习 XNA 很容易，一旦您决定制作实时游戏（2d 或 3d），它将为您提供很好的服务。无论哪种方式都很有趣，如果刚开始时 XNA 看起来很复杂，请回到 GDI。制作游戏应该和玩游戏一样有趣 :)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-26T00:46:56.907

如果它像听起来一样简单，甚至不是实时的，也许你不需要这些东西。即使没有游戏引擎，绘制六角网格和一些图像也不难。也许 WPF 会对此有好处。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-26T11:47:03.700

查看[Unity 3D](http://unity3d.com/) - 它基于 C#，可用于 2D。这可能是矫枉过正（包括价格），但对于游戏开发来说，它通常是巨大的帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-26T00:47:20.150

XNA 听起来是个不错的选择（它比使用 DirectX SDK 更好！！而且很容易学习）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-26T02:09:16.473

您可以通过使用`System.Drawing`命名空间内的类来做到这一点。而且`XNA`对于这种类型的东西肯定是矫枉过正。此外，您还会为您的小游戏引入许多依赖项，这对您的游戏玩家来说可能是不受欢迎的。

# python - 如何从 Pylons 应用程序返回 CSV？

> ID：790019
> 
> 赞同：11
> 
> 时间：2009-04-26T00:36:32.937
> 
> 标签：python, csv, pylons

我正在尝试从我的 webapp 中的操作返回 CSV，并提示用户下载文件或从电子表格应用程序中打开它。我可以让 CSV 吐出到屏幕上，但是如何更改文件的类型，以便浏览器识别这不应该显示为 HTML？我可以为此使用 csv 模块吗？

```
import csv

def results_csv(self):

    data = ['895', '898', '897']

    return data 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-26T00:45:28.953

要告诉浏览器您提供的内容类型，您需要将`Content-type`标题设置为“text/csv”。在您的 Pylons 函数中，以下内容应该可以完成这项工作：

`response.headers['Content-type'] = 'text/csv'`

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-26T02:29:20.763

PAG 是正确的，但此外，如果您想为下载的文件建议一个名称，您也可以设置`response.headers['Content-disposition'] = 'attachment; filename=suggest.csv'`

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-09-17T19:56:02.280

是的，您可以为此使用 csv 模块：

```
import csv
from cStringIO import StringIO 
```

...

```
def results_csv(self):
    response.headers['Content-Type'] = 'text/csv'
    s = StringIO()
    writer = csv.writer(s)
    writer.writerow(['header', 'header', 'header'])
    writer.writerow([123, 456, 789])
    return s.getvalue() 
```

# javascript - 当在文本区域中按下回车键时，我如何实现立即文本提交？

> ID：790029
> 
> 赞同：0
> 
> 时间：2009-04-26T00:42:43.983
> 
> 标签：javascript, input, textarea

### 复制：

> [通过点击“Enter”从 textarea 提交数据。](https://stackoverflow.com/questions/789701/submitting-data-from-textarea-by-hitting-enter)

* * *

我有一个 textarea 和一个提交按钮：

```
<textarea id="chat"></textarea>
<input type="submit" value="Submit" onclick="send_msg();"> 
```

按 Enter 时提交 texarea 的值：

```
 textarea.onkeyup = function(e) {
        alert(e.keyCode);
        e = e || window.event;
        if (e.keyCode === 13) {
            send_msg();
        }
        return true;
    } 
```

问题是在让光标跳转到下一行之前让 textarea 提交其值。怎么可能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T00:49:16.120

诀窍是阻止浏览器在按键按下和按键上执行默认行为。为此，只需`return false`在您检测到键码 13 时在您的 onkeypress/onkeyrelease 处理程序中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T01:26:43.097

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-20T16:18:28.950

`e.preventDefault();` This text is here because stack overflow insists that there is no useful answer with less than 30 characters. Guess how I feel about that?

# abstraction - 编写抽象（兼容性）层时应该使用什么：函子、接口或抽象方法？(D语言)

> ID：790041
> 
> 赞同：1
> 
> 时间：2009-04-26T00:52:33.257
> 
> 标签：abstraction, d

例如：脚本对象（如字符串、数组）或脚本引擎（eval()、readFile() 等）之间的兼容性层。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T02:16:35.193

如果没有更多上下文，我也不得不说接口。考虑到您可以将函数或委托表示为具有单个方法的接口，并且抽象类只是具有可能已经实现的某些方法的接口。

也就是说，这实际上取决于您要完成的工作。接口适用于您拥有大量具有通用接口但实现可能不同的对象的情况。例如，如果您正在为插件设计一个非常简单的回调系统（即：让插件挂钩宿主应用程序中的某些事件），那么委托可能更简单且足以满足您的需求。

还要记住，如果你确实使用接口，你可能需要一些方法让主机实例化实例。最简单的方法是使用某个唯一名称向主机注册一个委托。

抽象类仅在您想使用接口并提供某些事物的默认实现时才有用。在这种情况下，更好的解决方案是使用实际接口，并提供默认实现作为 mixin。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T01:22:58.630

接口有我的投票权。这样，只要您定义了接口，任何开发人员都可以相当容易地编写兼容的东西，而不必向他们分发太多代码。

# c# - 有人能告诉我我的班级标题有什么问题吗？

> ID：790049
> 
> 赞同：0
> 
> 时间：2009-04-26T01:03:24.480
> 
> 标签：c#, asp.net

```
<%@ Page Language="C#" AutoEventWireup="true"  CodeFile="Default.aspx.cs" Inherits="_Default" %> 
```

但是我收到了这个错误......尝试让它们匹配以及一切，它应该是什么？

```
Server Error in '/' Application.
    Compilation Error
    Description: An error occurred during the compilation of a resource required to service this request. Please review the following specific error details and modify your source code appropriately.

    Compiler Error Message: ASPNET: Make sure that the class defined in this code file matches the 'inherits' attribute, and that it extends the correct base class (e.g. Page or UserControl).

    Source Error:

    Line 14: namespace FlashCards
    Line 15: {
    Line 16:     public partial class _Default : System.Web.UI.Page
    Line 17:     {
    Line 18:         protected int indexKey = 0;

    Source File: c:\Users\Ryan\documents\visual studio 2008\websites\flashcards\Default.aspx.cs    Line: 16 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-26T01:11:44.087

Inherits 需要类的全名，因此您还需要包含命名空间。尝试更换

```
Inherits="_Default"
with
Inherits="FlashCards._Default" 
```

# php - Exec() 在 Windows 上的 PHP 中没有打开 cmd.exe 安全漏洞？

> ID：790054
> 
> 赞同：2
> 
> 时间：2009-04-26T01:06:06.843
> 
> 标签：php, iis, system, shell-exec

我需要一个 web 脚本来执行一个 exe 文件，然后将 exe 上的结果返回给 web 请求。

我可以回显 exe 的结果或修改 exe 以将其结果保存到文件中，然后读取文件以回显 Web 请求。

问题是在 IIS 下使用 php 所有 exec() shell_execute() system() 类型函数会出现“无法分叉”错误，因为 IIS 匿名用户 IUSER_%COMPUTER_NAME% 无权访问 C:\windows\system32\cmd 。可执行程序

这可以通过更改此 IIS 匿名用户对 cmd.exe 的权限来解决，但这会严重削弱安全性（我相信）。

有什么方法可以通过 IIS 下的 PHP 脚本调用 Exe 而不向 IIS 匿名用户打开 cmd.exe 吗？

帮助表示赞赏。

为什么我需要这样做？我有一个序列号生成器，当某人通过信用卡购买我的产品时，我的支付处理器需要调用一个 url，将许可证名称作为参数传递，并返回该许可证名称的序列号。

我的许可证密钥生成器是 WinLicense，我有一个 exe。

我需要运行类似的东西

shell_exec("C:\inetpub\wwwroot\test.com\testLicense.exe \"".$regName."\""); // 或 exec() 或 system()

（testLicense.exe 将结果存储在我的 php 脚本可以回显的文件中）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T01:50:08.737

非常仔细地过滤您提供给 exec() 的变量。

仅将整数用于数字信息

如果它是一个文件名，使用 file_exists() 来确认它是一个真实的文件名

如果它是字符串，请使用正则表达式并删除 ' 和 " 和 \ 和 ; 这样的字符，因此其中的任何命令都不会运行。

# mysql - 导入大型mysql数据库备份的最快方法是什么？

> ID：790055
> 
> 赞同：4
> 
> 时间：2009-04-26T01:08:21.473
> 
> 标签：mysql, backup, database-backups

使用 innodb 表导出/导入 mysql 数据库的最快方法是什么？

我有一个生产数据库，我需要定期将其下载到我的开发机器上以调试客户问题。我们目前这样做的方式是下载我们的常规数据库备份，这些备份是使用“mysql -B dbname”生成的，然后被 gzip 压缩。然后我们使用“gunzip -c backup.gz | mysql -u root”导入它们。

从阅读“mysqldump --help”中我可以看出，mysqldump 默认使用 --opt 运行，看起来它打开了一堆我能想到的可以加快导入速度的东西，例如关闭索引并将表作为一个庞大的导入语句导入。

有没有更好的方法来做到这一点，或者我们应该做进一步的优化？

**注意：**我主要想优化将数据库加载到我的开发机器（一个相对较新的 macbook pro，有很多内存）所花费的时间。备份时间和网络传输时间目前不是大问题。

**更新：**

要回答答案中提出的一些问题：

*   生产数据库架构每周最多更改几次。我们正在运行 rails，因此在陈旧的生产数据上运行迁移脚本相对容易。

*   我们需要每天或每小时将生产数据放入开发环境中。这完全取决于开发人员正在做什么。我们经常遇到特定的客户问题，这些问题是某些数据分布在数据库中的多个表中的结果，需要在开发环境中进行调试。

*   老实说，我不知道 mysqldump 需要多长时间。不到 2 小时，因为我们目前每 2 小时运行一次。然而，这不是我们想要优化的，我们想要优化到开发人员工作站的导入。

*   我们不需要完整的生产数据库，但将我们需要和不需要的东西分开并不是一件容易的事（有很多表具有外键关系）。这可能是我们最终必须去的地方，但如果可以的话，我们想避免它更长一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T01:32:41.680

这取决于您如何定义“最快”。

正如 Joel 所说，开发人员的时间很昂贵。Mysqldump 可以工作并处理很多情况，否则您必须自己处理或花时间评估其他产品以查看它们是否处理它们。

相关问题是：

**您的生产数据库模式多久更改一次？**

**注意：**我指的是添加、删除或重命名表、列、视图等，即会破坏实际代码的东西。

**您需要多久将生产数据放入开发环境中？**

以我的经验，根本不经常。我通常发现一个月一次就足够了。

**mysqldump 需要多长时间？**

如果少于 8 小时，它可以作为 cron 作业在一夜之间完成。问题解决了。

**你需要所有的数据吗？**

另一种优化方法是简单地获取相关的数据子集。当然，这需要编写自定义脚本来获取实体子集和所有相关的相关实体，但会产生最快的最终结果。该脚本还需要通过模式更改来维护，因此这是一种耗时的方法，应该作为绝对的最后手段使用。生产样本应该足够大，以包含足够广泛的数据样本并识别任何潜在的性能问题。

**结论**

基本上，只使用 mysqldump 直到你绝对不能。花时间在另一个解决方案上的时间不是花在开发上的时间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T01:41:57.257

考虑使用复制。这将允许您实时更新您的副本，即使您必须关闭从属服务器，MySQL 复制也允许赶上。您还可以在普通服务器上使用并行 MySQL 实例，将数据复制到支持在线备份的 MyISAM 表中。只要表具有相同的定义，MySQL 就允许这样做。

另一个值得研究的选项是著名 MySQL 性能专家 Percona 的[XtraBackup](http://www.mysqlperformanceblog.com/2009/02/24/xtrabackup-open-source-alternative-for-innodb-hot-backup-call-for-ideas/)。这是 InnoDB 的在线备份解决方案。不过，我自己还没有看过它，所以我不会保证它的稳定性，或者它甚至是解决您问题的可行解决方案。

# c - qsort 是否需要一致的比较，或者我可以用它来洗牌吗？

> ID：790083
> 
> 赞同：1
> 
> 时间：2009-04-26T01:32:53.333
> 
> 标签：c, sorting, random

**更新**：请在坏主意下归档。您在生活中不会免费获得任何东西，这肯定是证明。一个简单的想法坏了。然而，这绝对是值得学习的东西。

懒惰的编程挑战。如果我传递一个 50-50 为 qsort 的比较函数返回 true 或 false 的函数，我认为我可以有效地对结构数组进行排序，编写 3 行代码。

```
int main ( int argc, char **argv)
{
    srand( time(NULL) );  /* 1 */
    ...
    /* qsort(....) */     /* 2 */
} 
```

...

```
int comp_nums(const int *num1, const int *num2)
{
    float frand = 
          (float) (rand()) / ((float) (RAND_MAX+1.0));  /* 3 */

    if (frand >= 0.5f)
         return GREATER_THAN;
    return LESS_THAN;
} 
```

我需要寻找什么陷阱？是否可以通过交换减少行数，或者这是我得到的最干净的 3 行非平凡行？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-26T01:48:10.613

馊主意。我的意思是真的很糟糕。

您的解决方案给出了**不可预测**的结果，而不是**随机**结果，并且存在**很大**差异。您不知道带有随机比较的 qsort 会做什么以及所有组合是否同样可能。这是洗牌最重要的标准：所有组合的可能性都必须相同。有偏见的结果等于大麻烦。在您的示例中无法证明这一点。

您应该实现[Fisher-Yates shuffle](http://en.wikipedia.org/wiki/Fisher-Yates_shuffle)（也称为 Knuth shuffle）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-26T01:53:47.010

除了其他答案之外，这比简单的 Fisher-Yates 洗牌更糟糕，因为它太慢了。qsort 算法是 O(n*log(n))，Fisher-Yates 是 O(n)。

维基百科中提供了更多详细信息，说明为什么这种“洗牌”通常不像[Fisher-Yates 方法](http://en.wikipedia.org/wiki/Fisher-Yates_shuffle)那样有效：

> 与其他洗牌算法的比较
> 
> Fisher-Yates 洗牌非常有效；事实上，它的渐近时间和空间复杂度是最优的。结合优质无偏随机数源，也保证产生无偏结果。与其他一些方案相比，它还有一个优点是，如果只需要生成的置换的一部分，可以中途停止，甚至可以反复停止和重新启动，根据需要增量生成置换。在具有快速内置排序算法的高级编程语言中，另一种方法在实践中可能更快[需要引用]，尽管渐近时间复杂度更差（O(n log n) vs. O(n)）。像 Fisher-Yates shuffle 一样，如果正确实施，这种方法也会产生无偏的结果，并且可能更能容忍随机数中的某些类型的偏差。但是，必须注意确保分配的随机数永远不会重复，因为排序算法通常不会在出现平局的情况下随机排序元素。上述方法的一个变体已经在支持使用用户指定的比较函数进行排序的语言中有所使用，它是通过使用返回随机值的比较函数对列表进行排序来对列表进行排序。然而，这并不总是有效：对于许多常用的排序算法，由于排序实现中的内部不对称性，结果最终会出现偏差。 [7] 如果正确实施，这种方法也将产生无偏的结果，并且可能更能容忍随机数中的某些类型的偏差。但是，必须注意确保分配的随机数永远不会重复，因为排序算法通常不会在出现平局的情况下随机排序元素。上述方法的一个变体已经在支持使用用户指定的比较函数进行排序的语言中有所使用，它是通过使用返回随机值的比较函数对列表进行排序来对列表进行排序。然而，这并不总是有效：对于许多常用的排序算法，由于排序实现中的内部不对称性，结果最终会出现偏差。 [7] 如果正确实施，这种方法也将产生无偏的结果，并且可能更能容忍随机数中的某些类型的偏差。但是，必须注意确保分配的随机数永远不会重复，因为排序算法通常不会在出现平局的情况下随机排序元素。上述方法的一个变体已经在支持使用用户指定的比较函数进行排序的语言中有所使用，它是通过使用返回随机值的比较函数对列表进行排序来对列表进行排序。然而，这并不总是有效：对于许多常用的排序算法，由于排序实现中的内部不对称性，结果最终会出现偏差。 [7] 并且可能更能容忍随机数中的某些类型的偏差。但是，必须注意确保分配的随机数永远不会重复，因为排序算法通常不会在出现平局的情况下随机排序元素。上述方法的一个变体已经在支持使用用户指定的比较函数进行排序的语言中有所使用，它是通过使用返回随机值的比较函数对列表进行排序来对列表进行排序。然而，这并不总是有效：对于许多常用的排序算法，由于排序实现中的内部不对称性，结果最终会出现偏差。 [7] 并且可能更能容忍随机数中的某些类型的偏差。但是，必须注意确保分配的随机数永远不会重复，因为排序算法通常不会在出现平局的情况下随机排序元素。上述方法的一个变体已经在支持使用用户指定的比较函数进行排序的语言中有所使用，它是通过使用返回随机值的比较函数对列表进行排序来对列表进行排序。然而，这并不总是有效：对于许多常用的排序算法，由于排序实现中的内部不对称性，结果最终会出现偏差。 [7] t 在平局的情况下随机排列元素。上述方法的一个变体已经在支持使用用户指定的比较函数进行排序的语言中有所使用，它是通过使用返回随机值的比较函数对列表进行排序来对列表进行排序。然而，这并不总是有效：对于许多常用的排序算法，由于排序实现中的内部不对称性，结果最终会出现偏差。 [7] t 在平局的情况下随机排列元素。上述方法的一个变体已经在支持使用用户指定的比较函数进行排序的语言中有所使用，它是通过使用返回随机值的比较函数对列表进行排序来对列表进行排序。然而，这并不总是有效：对于许多常用的排序算法，由于排序实现中的内部不对称性，结果最终会出现偏差。 [7]

这链接到[这里](http://szeryf.wordpress.com/2007/06/19/a-simple-shuffle-that-proved-not-so-simple-after-all/)：

> 还有一件事 在写这篇文章时，我尝试了各种版本的方法，并在原始版本中发现了另一个缺陷（我将其重命名为`shuffle_sort`）。当我说“每次调用它都会返回一个很好的混洗数组”时，我错了。</p>
> 
> 结果根本没有很好地改组。他们有偏见。很糟糕。这意味着元素的某些排列（即排序）比其他元素更有可能。这是另一个证明它的代码片段，再次从新闻组讨论中借用：

```
N = 100000
A = %w(a b c)
Score = Hash.new { |h, k| h[k] = 0 }
N.times do
  sorted = A.shuffle  
  Score[sorted.join("")] += 1
end

Score.keys.sort.each do |key|
  puts "#{key}: #{Score[key]}"
end 
```

> 这段代码洗牌了 100,000 次由三个元素组成的数组：a、b、c，并记录每个可能的结果被实现的次数。在这种情况下，只有六个可能的排序，我们应该得到每个排序大约 16666.66 次。如果我们尝试`shuffle` (`shuffle`或`shuffle_sort_by`) 的无偏版本，结果如​​预期：

```

 美国广播公司：16517
 编号：16893
 后：16584
 bca: 16568
 出租车：16476
 工商银行：16962

```

> 当然，有一些偏差，但它们不应超过预期值的百分之几，并且每次运行此代码时它们都应该不同。可以说分布是均匀的。
> 
> 好的，如果我们使用 shuffle_sort 方法会发生什么？

```
美国广播公司：44278
 编号：7462
 后：7538
 bca: 3710
 出租车：3698
 工商银行：33314

```

> 这根本不是一个均匀分布。再次？

它显示了排序方法是如何有偏见的，并详细说明了为什么会这样。最后他链接到[编码恐怖](http://www.codinghorror.com/blog/archives/001015.html)：

> 我们来看看正确的 Knuth-Fisher-Yates shuffle 算法。

```
for (int i = cards.Length - 1; i > 0; i--)
{
  int n = rand.Next(i + 1);
  Swap(ref cards[i], ref cards[n]);
} 
```

> 你看得到差别吗？我第一次错过了。比较 3 张牌组的交换：

```

天真的洗牌 Knuth-Fisher-Yates 洗牌
rand.Next(3); rand.Next(3);
rand.Next(3); rand.Next(2);
rand.Next(3);

```

> 天真的洗牌会产生 3^3 (27) 种可能的牌组组合。这很奇怪，因为数学告诉我们实际上只有 3 个！或 3 张牌组的 6 种可能组合。在 KFY 洗牌中，我们从初始顺序开始，从第三个位置与三张牌中的任何一张交换，然后从第二个位置再次与剩余的两张牌交换。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-26T01:45:37.903

不，这不会正确地打乱数组，它几乎不会在原始位置周围移动元素，呈指数分布。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-26T01:49:42.480

比较函数不应该返回布尔类型，它应该返回一个负数、一个正数或零，`qsort()`用于确定哪个参数大于另一个。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-08T21:18:07.930

[旧新事物](http://blogs.msdn.com/oldnewthing/archive/2009/05/08/9595334.aspx)承担了这个

我认为在下降过程中递归地随机划分集合并在上升过程中连接结果的基本思想将起作用（它将平均 O(n*log n) 二进制决策，这非常接近 log2(fact(n) ) 但 q-sort 不一定会使用随机谓词来做到这一点。

顺便说一句，我认为对于任何 O(n*log n) 排序策略都可以说相同的论点和问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-26T01:43:19.970

兰德不是最随机的东西......如果你想洗牌或其他东西，这不是最好的。Knuth shuffle 也会更快，但如果它不会永远循环，您的解决方案就可以了

# iphone - 让 initWithNibFile 被调用的技巧？

> ID：790085
> 
> 赞同：0
> 
> 时间：2009-04-26T01:35:00.597
> 
> 标签：iphone

我已经实现了一个视图控制器，我正在尝试在 initWithNibFile 中进行一些非常基本的初始化......我理解它是视图控制器对象的指定初始化程序。

我尝试在代码上放置断点，并且也将非常简单的 NSLog 语句放入其中。无论如何......我没有看到它被执行（并且我试图在函数内分配/初始化的对象也没有被分配 - 所以我大约 99% 确定我没有碰到代码。

我需要在其他地方做些什么来调用这个方法吗？

我得到一个干净的构建，没有警告或错误。并且应用程序成功加载了视图，我可以调用我编写的 ButtonClick 方法并连接到同一个视图控制器。

任何建议，将不胜感激。

TC

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-26T02:05:28.323

我最终将分配逻辑移至 viewDidLoad，并且效果很好。

不知道为什么 initWithNibFile 不起作用......但我会取得小小的胜利！

感谢您提供查看代码 bpapa。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T04:47:16.157

您可能需要`initWithCoder:` 它是 SDK 在启动期间用于从 nib 文件中读取的内容。

`initWithNibFile:`几乎从不被系统调用。通常你手动调用它。该文档在这一点上非常具有误导性。

在任何情况下，都要小心在 initWithXXXX 方法中进行*过多的初始化。*视图的目标和操作不太可能设置和连接。 `viewDidLoad`无论如何，几乎总是进行 viewController 设置的正确位置。

# php - 在基于 ZF 的应用程序中创建管理部分的最佳实践

> ID：790086
> 
> 赞同：2
> 
> 时间：2009-04-26T01:35:10.783
> 
> 标签：php, security, zend-framework, admin

在每个大型应用程序中都有一个 ADMIN 部分。
在这种情况下，当不使用 ZF 时，我通常将所有管理内容放在一个单独的目录中，并采取额外的安全措施（例如添加基于 .htaccess 的身份验证和/或第二次登录等）。这也使得文件树中的文件是什么非常明显。

如何在 ZF 中实现相同的设计？或者是否有任何创建管理部分的最佳实践？
我应该在路由器级别执行吗（如果 url 中有“admin”，那么我使用不同的 index.php/bootstrap 文件....）
我想最简单的方法就是使用控制器来处理所有的管理内容，但我有太多了。所以我有几个管理控制器与常规应用程序控制器并排。它在我的控制器目录中弄得一团糟——哪个控制器是管理员，哪个不是？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-26T03:17:47.823

我已经把它作为一个[模块](http://framework.zend.com/manual/en/zend.controller.front.html)完成了。除了 Brett Bender 提供的模块链接，请参阅我提供的链接中的第 12.3.2.2 节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T01:49:21.000

我通常为整个管理系统创建一个单独的“应用程序”文件夹 - 包含它自己的控制器和视图目录以及静态内容的公共目录。管理部门通常对访问管理等关键事项有不同的要求，并且可能在许多其他方面与实际应用程序有所不同。因此，我认为完全分离源代码是个好主意。不过，一些源代码仍然很常见。示例包括库文件夹和数据库模型。

在决定管理实用程序应在何处可用时，此方法还为您提供了更大的灵活性。您可以使用 apache 别名指令将其放在同一域的子目录中，或者将其放在单独的虚拟主机上。全取决于你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T02:42:45.567

您应该使用 ZF 的模块进行检查。你可以有一个默认模块来包含非管理员的东西，以及一个管理模块来包含所有管理的东西。使用默认模块不会更改您当前的 URL，并且管理模块 URL 看起来像`server.com/admin/controllername/actionname/params`. 这将解决您的控制器都在同一个地方并且变得混乱的问题。此外，您可以在模型中进行子类化`Zend_Controller_Action`和创建`Master_Controller`以保持共享功能。然后只需创建一个`Admin_Controller`扩展主控制器以实现共享管理功能，并让您的管理模块中的每个控制器都对其进行子类化。您可以使用类似的结构在其他模块中组织共享的非管理员功能。

[Zend Framework - 模块化目录结构](http://framework.zend.com/manual/en/zend.controller.modular.html)

# c# - 如何查看用户在他/她的个人资料框中是否有您的 Facebook 应用程序？

> ID：790093
> 
> 赞同：2
> 
> 时间：2009-04-26T01:43:41.543
> 
> 标签：c#, asp.net, facebook

有没有办法检查应用程序的用户是否为该应用程序添加了配置文件框？这是可能的，因为我在 iLike 上看到了它，在主页上显示一个窗口，询问用户是否要添加配置文件框，如果用户还没有这样做的话。任何帮助，将不胜感激。如果 API 无法做到这一点，那么如何在 FBML 中完成？

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T05:53:18.840

您无法判断用户是否将您的应用添加到他们的个人资料中。我不确定 iLike 在后端做了什么，但似乎他们会在安装时提示您发布到您的个人资料。默认情况下，配置文件没有任何内容，您需要向其发布内容。

通常这是通过显示一个特殊按钮来完成的，如果 Facebook 的配置文件中没有该应用程序，则该按钮会显示该按钮。但如果个人资料没有内容，Facebook 也不会显示特殊按钮。所以这是一个先有鸡还是先有蛋的场景？

您可以查询用户配置文件中当前的内容 (getProfileFBML)，因此您可以使用它来检查他们是否已将您的应用添加到配置文件中。如果它是空的，则您从未发布过任何内容。但是您无法判断他们是否随后将其删除，或者将其移至 Boxes 选项卡（这是无用的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-24T23:33:35.327

我没有使用过 iLike，但是 <fb:add-section-button section="profile" /> 标签会在用户单击它并授予应用程序发布到他们的个人资料的权限后自动消失。

在我的应用程序中，每次用户更新应用程序时，我都会向配置文件对象写入一些内容 - 如果他们没有授予配置文件对象出现的权限，它仍然是不可见的。就这样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-24T23:36:44.043

你不能

# iphone - delay loading of UIWebView in UITabBar app

> ID：790096
> 
> 赞同：0
> 
> 时间：2009-04-26T01:46:53.830
> 
> 标签：iphone

I have an UITabBar based iPhone app with 4 different UIWebViews under every tab. Right now all the UIWebViews load on startup and it takes a little bit too long.

I would like to load the default tab's UIWebView first, then load the others in the background. What is the best way to do this?

I have seperate ViewControllers set up for each tab and have this in every .m file:

```
- (void)viewDidLoad {

NSString *urlAddress2 = @"http://google.com ";

//Create a URL object.
NSURL *url2 = [NSURL URLWithString:urlAddress2];

//URL Requst Object
NSURLRequest *requestObj2 = [NSURLRequest requestWithURL:url2];

//Load the request in the UIWebView.
[webView2 loadRequest:requestObj2];

} 
```

Is there a simple way to tell the other 3 tabs to start loading a few seconds after launch instead of at launch? Would that be a good idea?

Thanks a lot!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T08:52:54.960

If you use [`ASIHTTPRequest`](http://allseeing-i.com/ASIHTTPRequest-CFNetwork-wrapper-for-HTTP-requests) instead of `NSURLRequest`, you can fire a [synchronous request](http://allseeing-i.com/ASIHTTPRequest/How-to-use) for the first URL. Once that request is complete, you can then fire off the other three URL requests asynchronously (i.e., in the background).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-26T15:45:05.137

I've gotten around this issue by implementing a model layer through which all requests pass. Requests are queued and serviced in priority order, generally one at a time. I've added specific methods to allow a controller to escalate the priority of requests so that, if necessary, two or more requests will be active at once. When a request finishes, it alerts it delegate (the WebView's controller) that data is ready to be loaded.

Depending on how you want to set things up, you can put a callback in "webViewDidFinishLoad" (or, perhaps, shouldStartLoadWithRequest or webViewDidStartLoad) that triggers the model layer to dequeue and service the next request. For safety, you'll also want a timeout in the model layer.

Note: you'll also need to add some custom code into shouldStartLoadWithRequest to differentiate between clicks and the model layer pushing data in. I.e. you'll want to return NO or YES depending on the navigationType.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T02:25:46.000

You can use `NSTimer`, or do the loading in `viewDidAppear` or similar.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-26T08:54:34.893

Use viewDidAppear. This will be sent to the controller after the view fully appears and animations end.

# python - 是否可以从 ObjC 调用 Python 模块？

> ID：790103
> 
> 赞同：8
> 
> 时间：2009-04-26T01:52:07.030
> 
> 标签：python, objective-c, pyobjc

使用 PyObjC，是否可以导入 Python 模块、调用函数并将结果作为（例如）NSString 获取？

例如，执行以下 Python 代码的等效操作：

```
import mymodule
result = mymodule.mymethod() 
```

..在伪ObjC中：

```
PyModule *mypymod = [PyImport module:@"mymodule"];
NSString *result = [[mypymod getattr:"mymethod"] call:@"mymethod"]; 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-26T15:45:38.290

正如 Alex Martelli 的回答中提到的（虽然邮件列表消息中的链接已损坏，但应该是[https://docs.python.org/extending/embedding.html#pure-embedding](https://docs.python.org/extending/embedding.html#pure-embedding)）.. C 调用方式。 .

```
print urllib.urlopen("http://google.com").read() 
```

*   将 Python.framework 添加到您的项目中（右键单击`External Frameworks..`, `Add > Existing Frameworks`. 中的框架`/System/Library/Frameworks/`
*   添加`/System/Library/Frameworks/Python.framework/Headers`到您的“标题搜索路径”( `Project > Edit Project Settings`)

以下代码应该可以工作（尽管它可能不是有史以来最好的代码..）

```
#include <Python.h>

int main(){
    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
    Py_Initialize();

    // import urllib
    PyObject *mymodule = PyImport_Import(PyString_FromString("urllib"));
    // thefunc = urllib.urlopen
    PyObject *thefunc = PyObject_GetAttrString(mymodule, "urlopen");

    // if callable(thefunc):
    if(thefunc && PyCallable_Check(thefunc)){
        // theargs = ()
        PyObject *theargs = PyTuple_New(1);

        // theargs[0] = "http://google.com"
        PyTuple_SetItem(theargs, 0, PyString_FromString("http://google.com"));

        // f = thefunc.__call__(*theargs)
        PyObject *f = PyObject_CallObject(thefunc, theargs);

        // read = f.read
        PyObject *read = PyObject_GetAttrString(f, "read");

        // result = read.__call__()
        PyObject *result = PyObject_CallObject(read, NULL);

        if(result != NULL){
            // print result
            printf("Result of call: %s", PyString_AsString(result));
        }
    }
    [pool release];
} 
```

[这个教程](http://www.linuxjournal.com/article/8497)也不错

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-26T02:24:26.017

不完全是，AFAIK，但你可以用“C 方式”来做，例如[http://lists.apple.com/archives/Cocoa-dev/2004/Jan/msg00598.html](http://lists.apple.com/archives/Cocoa-dev/2004/Jan/msg00598.html)中的建议- 或“Pyobjc方式”，根据[http://osdir.com/ml/python.pyobjc.devel/2005-06/msg00019.html](http://osdir.com/ml/python.pyobjc.devel/2005-06/msg00019.html)（另请参阅该线程上的所有其他消息以获得进一步说明）。

# c# - SQL Server 2005 上的 ADO.NET 2.0 事务是否会在异常时自动回滚？

> ID：790105
> 
> 赞同：1
> 
> 时间：2009-04-26T01:54:05.403
> 
> 标签：c#, ado.net, transactions

如果我们开始一个事务，然后执行一些数据库操作，比如插入，然后发生异常，如果我不在捕获/异常处理程序中调用 transaction.rollback()，事务是否会自动回滚？

即使事务回滚，是否会导致内存泄漏，即事务对象和连接对象以其原始状态在内存中徘徊，直到垃圾收集器启动？

* * *

```
CREATE TABLE [Friend]

(
[ID] [int] IDENTITY(1,1) NOT NULL,
[FullName] [varchar](50) NOT NULL,
[Phone] [varchar](50) NULL,
) 
```

客户：

```
namespace Client
{
    class Program
    {
        static void Main(string[] args)
        {
            DaContract Impl = new Impl();
            Impl.AddFriend(new Friend("Someone", "100"));
            Impl.AddFriend(new Friend("Someone else"));
            Console.ReadLine();
        }
    }
} 
```

服务器：

```
using System;
using MyLib.DataAccess;
using System.Data;

namespace TestTransactionAndConnectionStateOnException
{
    public class Friend
    {
        public string FullName;
        public string Phone;

        public Friend(string fullName): this(fullName, null) {}
        public Friend(string fullName, string phone)
        {
            this.FullName = fullName;
            this.Phone = phone;
        }
    }

    public interface DaContract
    {
        int AddFriend( Friend f );

        int UpdatePhone(string fullName, string phone);
    }

    public class Impl: DaContract
    {
        Mediator _m;
        public Impl() { this._m = new Mediator(); }

        public int AddFriend( Friend f )
        {
            int ret = 0;

            try
            {
                ret = this._m.AddFriend( f );
            }
            catch(Exception ex)
            {
                HandleException(ex);
            }

            return ret;
        }

        public int UpdatePhone(string fullName, string phone)
        {
            int ret = 0;

            try
            {
                ret = this._m.UpdatePhone(fullName, phone);
            }
            catch(Exception ex)
            {
                HandleException(ex);
            }

            return ret;
        }

        public void HandleException(Exception ex)
        {
            /* see the transaction state */

            /* see connection state */

            /* do nothing and let the client call another method to initiate a new
             * transaction and a new connection */

        }
    }

    public class Mediator
    {
        private string _connectionString = "Data Source=localhost;Integrated Security=SSPI;Initial Catalog=MyFriends";
        private Manager _m = new Manager();

        public int AddFriend( Friend f )
        {
            int ret = 0;
            using (ISession session = SessionFactory.Create(SessionType.Ado, this._connectionString))
            {
                session.BeginTransaction();
                ret = this._m.AddFriend(f, session);
                session.CommitTransaction();
            }

            return ret;
        }

        public int UpdatePhone(string fullName, string phone)
        {
            int ret = 0;
            using (ISession session = SessionFactory.Create(SessionType.Ado, this._connectionString))
            {
                session.BeginTransaction();
                ret = this._m.UpdateFriend(fullName, phone, session);
                session.CommitTransaction();
            }

            return ret;
        }
    }

    public class Manager
    {
        public int AddFriend(Friend f, ISession session) { return Handler.Instance.AddFriend(f, session); }
        public int UpdateFriend(string fullName, string phone, ISession session) { return Handler.Instance.UpdatePhone(fullName, phone, session); }
    }

    public class Handler
    {
        private static Handler _handler = null;
        private Handler() {}
        public static Handler Instance
        { 
            get
            {
                if (_handler == null)
                    _handler = new Handler();

                return _handler;
            }
        }

        public int AddFriend( Friend f, ISession session )
        {
            /* check session, transaction and connection states here */
            Console.WriteLine(session.Connection.State.ToString());

            int ret = 0;

            /* Add the friend */
            IDbCommand command = session.CreateCommand();
            command.CommandType = CommandType.Text;
            command.CommandText = string.Format("INSERT INTO Friend(FullName, Phone) values('{0}', '{1}')", f.FullName, f.Phone);
            ret = command.ExecuteNonQuery();

            /* throw an exception just for the heck of it (don't dispose off ISession yet) */
            if (string.Compare(f.FullName, "Someone", true) == 0)
                throw new Exception("Fake exception. Friend value can't be 'Someone'");

            return ret;
        }

        public int UpdatePhone(string fullName, string phone, ISession session )
        {
            return 0;
        }

    }
} 
```

由于字数限制以及它搞砸了所有格式，我无法在评论部分发布代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T02:08:59.533

如果在未提交的情况下处理该事务，则该事务将被回滚。因此，只要您执行 using() 来开始您的事务，或者有一个调用 Dispose() 的 finally 块，它就会在发生异常时自动回滚。

如果你不处理事务/连接，它最终会被垃圾收集器回收，但在那之前会一直留在内存中。（事实上​​，托管的 SqlTransaction 对象将在内存中徘徊，直到 GC 启动为止；但处置可确保及早清理非托管事务/连接资源，释放服务器端资源并释放连接以供重用。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T02:21:22.577

```
CREATE TABLE [Friend]

(
[ID] [int] IDENTITY(1,1) NOT NULL,
[FullName] [varchar](50) NOT NULL,
[Phone] [varchar](50) NULL,
) 
```

## CLIENT

```
namespace Client
{
    class Program
    {
        static void Main(string[] args)
        {
            DaContract Impl = new Impl();
            Impl.AddFriend(new Friend("Someone", "100"));
            Impl.AddFriend(new Friend("Someone else"));
            Console.ReadLine();
        }
    }
} 
```

## SERVER

```
using System;
using MyLib.DataAccess;
using System.Data;

namespace TestTransactionAndConnectionStateOnException
{
    public class Friend
    {
        public string FullName;
        public string Phone;

        public Friend(string fullName): this(fullName, null) {}
        public Friend(string fullName, string phone)
        {
            this.FullName = fullName;
            this.Phone = phone;
        }
    }

    public interface DaContract
    {
        int AddFriend( Friend f );

        int UpdatePhone(string fullName, string phone);
    }

    public class Impl: DaContract
    {
        Mediator _m;
        public Impl() { this._m = new Mediator(); }

        public int AddFriend( Friend f )
        {
            int ret = 0;

            try
            {
                ret = this._m.AddFriend( f );
            }
            catch(Exception ex)
            {
                HandleException(ex);
            }

            return ret;
        }

        public int UpdatePhone(string fullName, string phone)
        {
            int ret = 0;

            try
            {
                ret = this._m.UpdatePhone(fullName, phone);
            }
            catch(Exception ex)
            {
                HandleException(ex);
            }

            return ret;
        }

        public void HandleException(Exception ex)
        {
            /* see the transaction state */

            /* see connection state */

            /* do nothing and let the client call another method to initiate a new
             * transaction and a new connection */

        }
    }

    public class Mediator
    {
        private string _connectionString = "Data Source=localhost;Integrated Security=SSPI;Initial Catalog=MyFriends";
        private Manager _m = new Manager();

        public int AddFriend( Friend f )
        {
            int ret = 0;
            using (ISession session = SessionFactory.Create(SessionType.Ado, this._connectionString))
            {
                session.BeginTransaction();
                ret = this._m.AddFriend(f, session);
                session.CommitTransaction();
            }

            return ret;
        }

        public int UpdatePhone(string fullName, string phone)
        {
            int ret = 0;
            using (ISession session = SessionFactory.Create(SessionType.Ado, this._connectionString))
            {
                session.BeginTransaction();
                ret = this._m.UpdateFriend(fullName, phone, session);
                session.CommitTransaction();
            }

            return ret;
        }
    }

    public class Manager
    {
        public int AddFriend(Friend f, ISession session) { return Handler.Instance.AddFriend(f, session); }
        public int UpdateFriend(string fullName, string phone, ISession session) { return Handler.Instance.UpdatePhone(fullName, phone, session); }
    }

    public class Handler
    {
        private static Handler _handler = null;
        private Handler() {}
        public static Handler Instance
        { 
            get
            {
                if (_handler == null)
                    _handler = new Handler();

                return _handler;
            }
        }

        public int AddFriend( Friend f, ISession session )
        {
            /* check session, transaction and connection states here */
            Console.WriteLine(session.Connection.State.ToString());

            int ret = 0;

            /* Add the friend */
            IDbCommand command = session.CreateCommand();
            command.CommandType = CommandType.Text;
            command.CommandText = string.Format("INSERT INTO Friend(FullName, Phone) values('{0}', '{1}')", f.FullName, f.Phone);
            ret = command.ExecuteNonQuery();

            /* throw an exception just for the heck of it (don't dispose off ISession yet) */
            if (string.Compare(f.FullName, "Someone", true) == 0)
                throw new Exception("Fake exception. Friend value can't be 'Someone'");

            return ret;
        }

        public int UpdatePhone(string fullName, string phone, ISession session )
        {
            return 0;
        }

    }
} 
```

I couldn't post the code in the comments section due to the word limit and because it screwed up all the formatting.

# c - 任何人都记得名为 TCXL 的旧 C 库吗？

> ID：790107
> 
> 赞同：1
> 
> 时间：2009-04-26T01:56:44.943
> 
> 标签：c

早在 1990 年代初期，我使用了一个名为 TCXL 的 C 例程库。我只是想知道制作那个的人发生了什么事。当时我大约 25 岁，从我在点阵打印机上打印的手册中学习了 C。我想是在使用 Turbo C，我想我是从某个公告板下载 TCXL，或者可能是 Compuserve？

该库有很酷的例程来为弹出窗口创建“窗口”并在屏幕上创建区域，还有许多其他很酷的东西，我无法完全回忆起来。当然，所有这些都在 DOS 中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T02:38:34.110

[http://cd.textfiles.com/swheaven1/UTILITY/](http://cd.textfiles.com/swheaven1/UTILITY/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-10-03T15:23:11.603

Mike Smedley，CXL 的原作者： http: [//www.mikesmedley.com/](http://www.mikesmedley.com/)

# java - JAXB 类型问题

> ID：790118
> 
> 赞同：3
> 
> 时间：2009-04-26T02:09:21.013
> 
> 标签：java, xml, code-generation, jaxb

我有一个看起来像这样的 xsd（片段）：

```
<xs:complexType name="IDType">
  <xs:choice minOccurs="1" maxOccurs="2">
    <xs:element name="FileID"    minOccurs="0" maxOccurs="1" type="an..35" />
    <xs:element name="IDNumber1" minOccurs="0" maxOccurs="1" type="an..35" />
    <xs:element name="Number"    minOccurs="0" maxOccurs="1" type="an..35" />
    <xs:element name="PNumber"   minOccurs="0" maxOccurs="1" type="an..35" />
    <xs:element name="SS"        minOccurs="0" maxOccurs="1" type="an..35" />
    <xs:element name="Player"    minOccurs="0" maxOccurs="1" type="an..35" />
    <xs:element name="Prior"     minOccurs="0" maxOccurs="1" type="an..35" />
    <xs:element name="BIN"       minOccurs="0" maxOccurs="1" type="an..35" />
    <xs:element name="Mutual"    minOccurs="0" maxOccurs="1" type="an..35" />
  </xs:choice>
</xs:complexType>
<xs:simpleType name="an..35">
  <xs:restriction base="an">
    <xs:maxLength value="35" />
  </xs:restriction>
</xs:simpleType>

<xs:simpleType name="an">
   <xs:restriction base="xs:string">
     <xs:pattern value="[ !-~]*" />
   </xs:restriction>
</xs:simpleType> 
```

出于某种原因，这是生成的 Java 代码：

```
@XmlAccessorType(XmlAccessType.FIELD)
@XmlType(name = "IDType", propOrder = {
    "fileID"
})
public class PatientIDType {
    @XmlElementRefs({
        @XmlElementRef(name = "FileED", namespace = "http://www.surescripts.com/messaging", type = JAXBElement.class),
        @XmlElementRef(name = "IDNumber1", namespace = "http://www.surescripts.com/messaging", type = JAXBElement.class),
        @XmlElementRef(name = "Number", namespace = "http://www.surescripts.com/messaging", type = JAXBElement.class),
        @XmlElementRef(name = "PNumber", namespace = "http://www.surescripts.com/messaging", type = JAXBElement.class),
        @XmlElementRef(name = "SS", namespace = "http://www.surescripts.com/messaging", type = JAXBElement.class),
        @XmlElementRef(name = "Plaer", namespace = "http://www.surescripts.com/messaging", type = JAXBElement.class),
        @XmlElementRef(name = "Prior", namespace = "http://www.surescripts.com/messaging", type = JAXBElement.class),
        @XmlElementRef(name = "BIN", namespace = "http://www.surescripts.com/messaging", type = JAXBElement.class),
        @XmlElementRef(name = "Mutual", namespace = "http://www.surescripts.com/messaging", type = JAXBElement.class)
    })
    protected List<JAXBElement<String>> fileID;
    /**
     * Gets the value of the fileID property.
     * 
     * <p>
     * This accessor method returns a reference to the live list,
     * not a snapshot. Therefore any modification you make to the
     * returned list will be present inside the JAXB object.
     * This is why there is not a <CODE>set</CODE> method for the fileID property.
     * 
     * <p>
     * For example, to add a new item, do as follows:
     * <pre>
     *    getFileID().add(newItem);
     * </pre>
     * 
     * 
     * <p>
     * Objects of the following type(s) are allowed in the list
     * {@link JAXBElement }{@code <}{@link String }{@code >}
     * {@link JAXBElement }{@code <}{@link String }{@code >}
     * {@link JAXBElement }{@code <}{@link String }{@code >}
     * {@link JAXBElement }{@code <}{@link String }{@code >}
     * {@link JAXBElement }{@code <}{@link String }{@code >}
     * {@link JAXBElement }{@code <}{@link String }{@code >}
     * {@link JAXBElement }{@code <}{@link String }{@code >}
     * {@link JAXBElement }{@code <}{@link String }{@code >}
     * {@link JAXBElement }{@code <}{@link String }{@code >}
     */
    public List<JAXBElement<String>> getFileID() {
        if (fileID == null) {
            fileID = new ArrayList<JAXBElement<String>>();
        }
        return this.fileID;
    } 
```

为什么类是这样生成的，而不是某种字符串数组？我真的不想每次都创建 JAXBElements 吗？

我怎样才能让它为每个简单地表示字符串或类似的类型生成类？

提前致谢，

伊恩

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-03T19:52:23.753

生成此代码是因为您的复杂类型 IDType 包含一个 maxOccurrence 大于 1 的选项，此处：

<xs:choice minOccurs="1" maxOccurs="2">

此列表的内容是*名称*不同但*类型*相同的元素。这在标准的面向对象模型中没有等价物。然后 JAXB 使用`JAXBElement`该类来解决这个问题： a`JAXBElement`包装一个包含数据的简单对象，并将其分配给`QName`.

因此，您可以通过提供以下内容来明确地读取该列表并写入该列表：

*   数据对象（在您的情况下为字符串，因为来自字符串的所有限制都表示为 Java 字符串）
*   一个`JAXBElement`其`getValue()`方法返回字符串

JAXB 规范包含关于如何处理重复选择和重复序列的相当详细且相当复杂的解释。请注意，如果您的序列包含不同类型和不同名称的对象，您最终会得到*List<Object>*。

这是很长的解释，现在这里有一些选项：

*   如果您可以修改架构，请在 8 个项目周围放置一个包装器元素，例如“Wrapper”。Wrapper 将包含单个选择的元素；然后使 IDType 包含一系列 Wrapper 元素，其中 minOccurs = 1 和 maxOccurs = 2。
*   自己创建一些辅助函数来快速创建 JAXBElements。JAXB 在您的目标包中放置了一个可以帮助您的 Factory 类 - 例如，它包含对 Schema 命名空间的引用等。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-12-21T22:14:04.953

您的 ObejctFActory 类应该具有用于​​ thosr 值的 createMethod，类似于

```
@XmlElementDecl(namespace = "http://www.surescripts.com/messaging", name = "SocialSecurity", scope = PatientIDType.class)
public JAXBElement<String> createPatientIDTypeSocialSecurity(String value) {
    return new JAXBElement<String>(_PayerIDTypeSocialSecurity_QNAME, String.class, PatientIDType.class, value);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T21:59:13.447

如果您使用的是 Sun JAXB 实现，您可以尝试在启用 xjc:simple 模式的情况下进行编译。有关示例，请参阅有关[简化绑定的文档。](https://jaxb.dev.java.net/2.1.9/docs/vendorCustomizations.html#simple "简单绑定")应该转

```
public class PatientIDType {
    protected List<JAXBElement<String>> fileID;
} 
```

进入

```
public class PatientIDType {
    String fileID;
    ...
} 
```

您需要使用绑定自定义文件编译您的架构。有关如何执行此操作的示例，请参阅[Kohsuke 的博客。](http://weblogs.java.net/blog/kohsuke/archive/2006/03/simple_and_bett.html "小介的博客")

# django - 在 Django 中，如何从模型/子项中预填充编辑表单，但将提交保存为新实例？

> ID：790119
> 
> 赞同：4
> 
> 时间：2009-04-26T02:10:43.430
> 
> 标签：django, django-models, django-forms

我正在尝试使用模型的实例预填充 ModelForm 和 inlineformset_factory，但是当用户提交表单时，我需要创建模型的新实例及其相关的子记录。

示例模型：

```
class Artist(models.Model):
    artist = models.CharField(max_length=100)

class Song(models.Model):
    artist = models.ForeignKey(Artist)
    song = models.CharField(max_length=200) 
```

我希望用户看到基于 Artist 实例的编辑表单，以及该 Artist 相关歌曲的 InlineFormSet。该表格将预先填充现有数据，用户可以更改艺术家的姓名和歌曲名称。但是，当用户提交表单时，我不想覆盖现有记录。相反，我想创建一个新的 Artist 实例并为这个新艺术家添加新的歌曲。

在保存之前，我尝试将艺术家的主键设置为无 - 这会强制创建一个新的 Artist。但是，我失去了 Artists 和 Songs 之间的 ForeignKey 关系。

示例视图：

```
def edit(request, artist_id=None):
    if  artist_id == None:
        artistsubmission = Artist()
    else:
        artistsubmission = Artist.objects.get(id = artist_id)
        artistsubmission.pk = None

    if request.method == 'POST':
        form = ArtistEditForm(request.POST, instance=artistsubmission)
        formset = SongFormSet(request.POST, instance=artistsubmission)

        if form.is_valid() and formset.is_valid():
            form.save()
            formset.save()
            return HttpResponseRedirect('/success/')    
    else:
        form = ArtistEditForm(instance=artistsubmission)
        formset = SongFormSet(instance=artistsubmission)

    return render_to_response('edit.html', {'form':form, 'formset':formset}) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-26T06:24:36.440

您可以遍历表单集中的各个表单，更改您需要的内容并保存。

```
if form.is_valid() and formset.is_valid():
    artist = form.save()
    for f in formset.forms:
        song = f.save(commit=False)
        song.artist = artist.id
        song.save() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T05:55:28.053

我认为最简单的方法是通过将字典作为第一个参数传递给表单来设置默认值。您可以通过以下方式获取模型实例的所有字段：

```
d_initial = Artist.objects.filter(pk=artist_id).values()[0] 
```

这是您要传递给表单的字典。

```
form = ArtistEditForm(d_initial) 
```

如果您已从表单中排除任何内容，您可能希望将其从字典中删除。对`id`. 但这应该会生成一个包含现有实例中所有值的表单，但会保存到新实例中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-14T10:23:06.387

我有一个类似的问题，我是这样解决的：

```
def edit(request, artist_id=None):
    if artist_id == None:
        artistsubmission = Artist()
    else:
        artistsubmission = get_object_or_404(Artist, id = artist_id)

    if request.method == 'POST':
        form = ArtistEditForm(request.POST, instance=artistsubmission)
        formset = SongFormSet(request.POST, instance=artistsubmission)

        if form.is_valid() and formset.is_valid():
            artistsubmission.pk = None

            artist = form.save(commit=False)
            artist.id = None
            artist.save()

            for f in formset.forms:
                song = f.save(commit=False)
                song.artist_id = artist.id
                song.id = None
                song.save()
            return HttpResponseRedirect('/success/')
    else:
        form = ArtistEditForm(instance=artistsubmission)
        formset = SongFormSet(instance=artistsubmission)
    return render_to_response('edit.html', {'form':form, 'formset':formset}) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-27T21:04:25.993

我发现了这个片段，我认为它更符合您的要求。 [http://www.djangosnippets.org/snippets/1246/](http://www.djangosnippets.org/snippets/1246/)

# html - 需要帮助来修复此 HTML 表格

> ID：790122
> 
> 赞同：0
> 
> 时间：2009-04-26T02:15:17.863
> 
> 标签：html

我正在尝试制作这样的 HTML 表格：

```
Name                    Price                 Original Value
RED              ALL         50                         10 
                 A           980                        100
                 B           75                         45

YELLOW           ALL         500                        100
                 A           550                        150
                 B           80                          40 
```

我想出了这个，但它错了，看起来很丑:( [http://jsbin.com/ayixi](http://jsbin.com/ayixi)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T02:23:24.273

**[您的示例已更新并正在运行](http://jsbin.com/ulife)。**

我不知道您在示例中在做什么，因为您缺少数据等......最简单的事情就是向您展示如何去做。只有一列需要 colspan，只有一列需要行跨度来跨越行...（名称列和行的颜色分组）

```
<style>
  th {
   text-align:left;
  }
  .endofrow td {
   padding-bottom:1em;
  }
</style>

<table width="50%" border=1>
  <tr><th>Name<th colspan=2>Price<th>Original Value</tr>
  <tr><td rowspan=3 valign=top>Red<td>ALL<td>50<td>10</tr>
  <tr><td>A<td>980<td>100</tr>  
  <tr class="endofrow"><td>B<td>80<td>50</tr>    
  <tr><td rowspan=3 valign=top>Yellow<td>ALL<td>500<td>100</tr>
  <tr><td>A<td>980<td>100</tr>  
  <tr class="endofrow"><td>B<td>80<td>50</tr>    
</table> 
```

（注意，我省略了结束标签，因为它们将被填写，没有它们更容易阅读表格）

如果您想要行之间的空间，请不要使用 a `<br> or a <br />`，它们都不是解决问题的方法。您想在该组的最后一行添加一个类并在其中放置一些填充。这是语义上最正确的做法，并且您避免在不属于它们的地方混入换行符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T02:25:03.253

您需要查看 colspan 和 rowspan 值。例如，在您的表中有以下条目：

```
<td  CLASS="trheadermain" colspan=2 rowspan=3 align="center" height=17>
<B>NAME</B></td> 
```

使标签`rowspan=3`占用`NAME`太多空间

有些`<br>`元素不属于它们：

```
 </tr>
<br><br><br>
       <tr height=20  bgColor=> 
```

您可能希望对 HTML 进行现代化改造：使用`<br />`in place of `<br>`、`<strong>`in place of `<b>`、`colspan="2"`in place of`colspan=2`等。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-26T02:21:56.147

名称、价格和原始值单元格上的行跨度破坏了您的布局。没有这些它应该可以正常工作。

```
<td  CLASS="trheadermain" colspan=2 rowspan=3 align="center" height=17 ><B>NAME</B></td>
<td  rowspan=2 CLASS="trheadermain" ><B>Price</B></td>
<td  rowspan=2 CLASS="trheadermain" ><B>Original Value</B></td>

->

<td  CLASS="trheadermain" colspan=2 align="center" height=17 ><B>NAME</B></td>
<td  CLASS="trheadermain" ><B>Price</B></td>
<td  CLASS="trheadermain" ><B>Original Value</B></td> 
```

# c# - 命名空间不存在

> ID：790126
> 
> 赞同：1
> 
> 时间：2009-04-26T02:20:02.690
> 
> 标签：c#, visual-studio, namespaces

我想试用 Microsoft Visual C# Express Edition 中的代码，但出现此错误：

> 命名空间“EducationalSuite.Core”中不存在类型或命名空间名称“Properties”（您是否缺少程序集引用？）

我右键单击参考，但我没有找到“属性”或“EducationalSuite.Core”。

这是代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.IO;
using System.Text;
using System.Windows.Forms;
using System.Media;
using System.Resources;

namespace EducationalSuite.Core.Plugins
{
    public delegate void RectangleItemClickedDelegate(Rectangle rect, int index);

    public partial class GeoSafariItem : Control
    {
        protected List<Rectangle> lastFlashingItems = new List<Rectangle>();
        protected int lastHeight = 0;

        private Image imageFile = null;
        protected List<Rectangle> hotspots = new List<Rectangle>();
        protected Dictionary<int, string> textItems = new Dictionary<int, string>();
        protected Dictionary<int, FileInfo> audioItems = new Dictionary<int, FileInfo>();
        protected Rectangle lastRectangle;
        protected int selectedIndex = 0;
        protected int countItemsLeft = 6;
        protected int countItemsRight = 6;
        protected int imageOffsetTop = 0;
        protected int imageOffsetBottom = 0;
        protected bool paintHotSpots = false, colorSwitch = false, paintItemLabels = false;
        protected Timer timer = new Timer();

        public event RectangleItemClickedDelegate HotspotClick;
        public event RectangleItemClickedDelegate QuestionItemClick;
        public event RectangleItemClickedDelegate QuestionItemRightClick;

        protected void OnHotspotClick(Rectangle rect, int index)
        {
            if (HotspotClick != null)
            {
                HotspotClick(this.RectangleToScreen(rect), index);
            }
        }

        protected void OnQuestionItemRightClick(Rectangle rect, int index)
        {
            if (QuestionItemRightClick != null)
            {
                QuestionItemRightClick(this.RectangleToScreen(rect), index);
            }
        }

        protected void OnQuestionItemClick(Rectangle rect, int index)
        {
            if (QuestionItemClick != null)
            {
                QuestionItemClick(this.RectangleToScreen(rect), index);
            }
        }

        public GeoSafariItem()
        {
            this.imageFile = EducationalSuite.Core.Properties.Resources.singlepixel;

            timer.Interval = 100;
            timer.Tick += new EventHandler(timer_Tick);
            timer.Enabled = true;

            this.MouseUp += new MouseEventHandler(GeoSafariItem_MouseUp);

            // Activates double buffering
            SetStyle(ControlStyles.UserPaint, true);
            SetStyle(ControlStyles.AllPaintingInWmPaint, true);
            SetStyle(ControlStyles.DoubleBuffer, true);
            SetStyle(ControlStyles.ResizeRedraw, true);

            this.DoubleBuffered = true;

            //InitializeComponent();
        }

        public void SetItemText(int index, string text)
        {
            if (string.IsNullOrEmpty(text))
            {
                if (this.textItems.ContainsKey(index)) textItems.Remove(index);
            }
            else
            {
                this.textItems[index] = text;
            }

            if (PaintItemLabels)
            {
                this.Invalidate();
            }
        }

        public string GetItemText(int index)
        {
            if (this.textItems.ContainsKey(index))
            {
                return this.textItems[index];
            }
            else
            {
                return string.Empty;
            }
        }

        public void SetItemAudio(int index, FileInfo file)
        {
            if ((file == null) && !file.Exists)
            {
                if (this.audioItems.ContainsKey(index)) audioItems.Remove(index);
            }
            else
            {
                this.audioItems[index] = file;
            }
        }

        public FileInfo GetItemAudio(int index)
        {
            if (this.audioItems.ContainsKey(index))
            {
                return this.audioItems[index];
            }
            else
            {
                return null;
            }
        }

        #region Recording Regions
        bool isRecording = false;
        int recordingIndex = 0;
        Point recordTopLeft = Point.Empty;
        Point recordBottomRight = Point.Empty;
        List<Rectangle> recordedRectangles = new List<Rectangle>();

        public void StartRecording()
        {
            isRecording = true;
            recordingIndex = 0;
            selectedIndex = 0;
            recordedRectangles.Clear();
            this.MouseUp += new MouseEventHandler(GeoSafariItemRecord_MouseUp);

            this.Invalidate();
        }

        public List<Rectangle> FinishRecording()
        {
            isRecording = false;
            this.MouseUp -= new MouseEventHandler(GeoSafariItemRecord_MouseUp);
            this.Invalidate();

            this.Hotspots.Clear();
            foreach (Rectangle r in recordedRectangles)
            {
                this.Hotspots.Add(r);
            }

            return recordedRectangles;
        }

        private void GeoSafariItemRecord_MouseUp(object sender, MouseEventArgs e)
        {
            if (isRecording)
            {
                Rectangle size = SizeRect;
                double ratio = (double)imageFile.Height / (double)size.Height;

                if (recordTopLeft == Point.Empty)
                {
                    recordTopLeft = new Point(
                        (int)(((double)e.Location.X - (double)size.Left) * ratio),
                        (int)(((double)e.Location.Y - (double)size.Top) * ratio)
                        );
                }
                else
                {
                    recordBottomRight = new Point(
                       (int)(((double)e.Location.X - (double)size.Left) * ratio),
                       (int)(((double)e.Location.Y - (double)size.Top) * ratio)
                       );

                    Rectangle r = new Rectangle(recordTopLeft,
                        new Size(recordBottomRight.X - recordTopLeft.X, recordBottomRight.Y - recordTopLeft.Y));

                    this.recordedRectangles.Add(r);
                    recordingIndex++;
                    selectedIndex++;

                    recordTopLeft = Point.Empty;
                    recordBottomRight = Point.Empty;
                }
            }
            this.Invalidate();
        }
        #endregion

        void timer_Tick(object sender, EventArgs e)
        {
            colorSwitch = !colorSwitch;

            if (lastRectangle.Width > 0)
            {
                this.Invalidate(lastRectangle);
            }
            else
            {
                this.Invalidate();
            }
        }

        private Rectangle SizeRect
        {
            get
            {
                int rw, rh,
                cw = (this.Width - 42),
                ch = (this.Height - 2),
                ox = 21,
                oy = 1;

                rw = cw;
                rh = ch;

                double imageRatio = (double)imageFile.Width / (double)imageFile.Height;
                double controlRatio = (double)cw / (double)ch;

                if (controlRatio > imageRatio)
                {
                    rw = (int)Math.Round((double)rh * imageRatio);
                    ox += Math.Abs(rw - cw) / 2;
                }
                else if (controlRatio < imageRatio)
                {
                    rh = (int)Math.Round((double)rw / imageRatio);
                    oy += Math.Abs(rh - ch) / 2;
                }

                return new Rectangle(ox, oy, rw, rh);
            }
        }

        void GeoSafariItem_MouseUp(object sender, MouseEventArgs e)
        {
            Rectangle size = SizeRect;
            for (int i = 0; i < hotspots.Count; i++)
            {
                Rectangle hotspot = hotspots[i];
                double ratio = (double)size.Height / (double)imageFile.Height;
                Rectangle adjustedRectange = new Rectangle(
                    size.Left + (int)(hotspot.X * ratio),
                    size.Top + (int)(hotspot.Y * ratio),
                    (int)(hotspot.Width * ratio),
                    (int)(hotspot.Height * ratio));

                if (adjustedRectange.Contains(e.Location))
                {
                    OnHotspotClick(hotspot, i);
                    return;
                }
            }

            for (int i = 0; i < lastFlashingItems.Count; i++)
            {
                if (lastFlashingItems[i].Contains(e.Location))
                {
                    if (e.Button == MouseButtons.Right)
                        OnQuestionItemRightClick(lastFlashingItems[i], i);
                    else
                        OnQuestionItemClick(lastFlashingItems[i], i);

                    return;
                }
            }
        }

        public List<Rectangle> Hotspots
        {
            get { return hotspots; }
        }

        public Image ImageFile
        {
            get { return imageFile; }
            set
            {
                imageFile = value;
                lastFlashingItems.Clear();
                this.Invalidate();
            }
        }

        public int SelectedIndex
        {
            get { return selectedIndex; }
            set { selectedIndex = value; this.Invalidate(); }
        }

        public int CountItemsLeft
        {
            get { return countItemsLeft; }
            set
            {
                countItemsLeft = value;
                lastFlashingItems.Clear();
                this.Invalidate();
            }
        }

        public int CountItemsRight
        {
            get { return countItemsRight; }
            set
            {
                countItemsRight = value;
                lastFlashingItems.Clear();
                this.Invalidate();
            }
        }

        public int ImageOffsetTop
        {
            get { return imageOffsetTop; }
            set
            {
                imageOffsetTop = value;
                lastFlashingItems.Clear();
                this.Invalidate();
            }
        }

        public int ImageOffsetBottom
        {
            get { return imageOffsetBottom; }
            set
            {
                imageOffsetBottom = value;
                lastFlashingItems.Clear();
                this.Invalidate();
            }
        }

        public bool PaintHotSpots
        {
            get { return paintHotSpots; }
            set { paintHotSpots = value; this.Invalidate(); }
        }

        public bool PaintItemLabels
        {
            get { return paintItemLabels; }
            set { paintItemLabels = value; this.Invalidate(); }
        }

        protected override void OnPaint(PaintEventArgs pe)
        {
            Graphics g = pe.Graphics;

            string itemText;
            SizeF sizeItemText;
            double topOffset = imageOffsetTop;
            double bottomOffset = imageOffsetBottom;
            double topOffsetPct = (double)topOffset / (double)imageFile.Height;
            double bottomOffsetPct = (double)bottomOffset / (double)imageFile.Height;

            Rectangle size = SizeRect;

            SolidBrush brush = new SolidBrush(this.BackColor);
            g.FillRectangle(brush, 0, 0, this.Width - 1, this.Height - 1);

            g.FillRectangle(Brushes.Ivory, size.X - 25, size.Y, size.Width + 50, size.Height);
            g.DrawRectangle(Pens.DarkKhaki, size.X - 25, size.Y - 1, size.Width + 50, size.Height + 1);
            g.DrawImage(imageFile, size.X, size.Y, size.Width, size.Height);

            Rectangle rect, rectItemText;
            Brush selectedColor = (colorSwitch ? Brushes.Crimson : Brushes.Red);
            topOffset = topOffsetPct * size.Height;
            bottomOffset = bottomOffsetPct * size.Height;
            int tmpHeight = (size.Height - (int)topOffset - (int)bottomOffset) / countItemsLeft;
            if (size.Height != this.lastHeight || this.lastFlashingItems.Count == 0)
            {
                lastHeight = size.Height;
                lastFlashingItems.Clear();

                int actualIndex = 0;
                for (int i = 0; i < countItemsLeft; i++)
                {
                    int yy = size.Y + (tmpHeight * i) + (int)topOffset;
                    int xx = size.X - 18;
                    rect = new Rectangle(xx, yy, 16, 8);
                    this.lastFlashingItems.Add(rect);

                    g.FillRectangle((actualIndex == selectedIndex ? selectedColor : Brushes.Khaki), rect);
                    g.DrawRectangle(Pens.DarkKhaki, rect);

                    if (actualIndex == selectedIndex)
                    {
                        lastRectangle = rect;
                    }

                    itemText = this.GetItemText(actualIndex);
                    if (PaintItemLabels && !string.IsNullOrEmpty(itemText))
                    {
                        // Draw Text next to each notch
                        sizeItemText = g.MeasureString(itemText, this.Font);

                        int xxx = size.X + 10;
                        rectItemText = new Rectangle(xxx, yy, Convert.ToInt32(sizeItemText.Width), Convert.ToInt32(sizeItemText.Height));
                        PaintHotspot(g, Color.White, rectItemText, 200);

                        g.DrawString(itemText, this.Font, Brushes.Black, (float)xxx, (float)yy);
                    }

                    actualIndex++;
                }

                tmpHeight = (size.Height - (int)topOffset - (int)bottomOffset) / countItemsRight;
                for (int i = 0; i < countItemsRight; i++)
                {
                    int yy = size.Y + (tmpHeight * i) + (int)topOffset;
                    int xx = size.X + size.Width + 2;
                    rect = new Rectangle(xx, yy, 16, 8);
                    this.lastFlashingItems.Add(rect);

                    g.FillRectangle((actualIndex == selectedIndex ? selectedColor : Brushes.Khaki), rect);
                    g.DrawRectangle(Pens.DarkKhaki, rect);

                    if (actualIndex == selectedIndex)
                    {
                        lastRectangle = rect;
                    }

                    itemText = this.GetItemText(actualIndex);
                    if (PaintItemLabels && !string.IsNullOrEmpty(itemText))
                    {
                        // Draw Text next to each notch
                        sizeItemText = g.MeasureString(itemText, this.Font);

                        int xxx = size.X + size.Width - 10 - Convert.ToInt32(sizeItemText.Width);
                        rectItemText = new Rectangle(xxx, yy, Convert.ToInt32(sizeItemText.Width), Convert.ToInt32(sizeItemText.Height));
                        PaintHotspot(g, Color.White, rectItemText, 200);

                        g.DrawString(itemText, this.Font, Brushes.Black, (float)xxx, (float)yy);
                    }
                    actualIndex++;
                }
            }
            else
            {
                lastHeight = size.Height;
                for (int i = 0; i < lastFlashingItems.Count; i++)
                {
                    g.FillRectangle((i == selectedIndex ? selectedColor : Brushes.Khaki), lastFlashingItems[i]);
                    g.DrawRectangle(Pens.DarkKhaki, lastFlashingItems[i]);

                    if (i == selectedIndex)
                    {
                        lastRectangle = lastFlashingItems[i];
                    }
                }

                if (PaintItemLabels)
                {
                    int actualIndex = 0;
                    for (int i = 0; i < countItemsLeft; i++)
                    {
                        itemText = this.GetItemText(actualIndex);
                        if (!string.IsNullOrEmpty(itemText))
                        {
                            int yy = size.Y + (tmpHeight * i) + (int)topOffset;
                            // Draw Text next to each notch
                            sizeItemText = g.MeasureString(itemText, this.Font);

                            int xxx = size.X + 10;
                            rectItemText = new Rectangle(xxx, yy, Convert.ToInt32(sizeItemText.Width), Convert.ToInt32(sizeItemText.Height));
                            PaintHotspot(g, Color.White, rectItemText, 200);

                            g.DrawString(itemText, this.Font, Brushes.Black, (float)xxx, (float)yy);
                        }

                        actualIndex++;
                    }

                    tmpHeight = (size.Height - (int)topOffset - (int)bottomOffset) / countItemsRight;
                    for (int i = 0; i < countItemsRight; i++)
                    {
                        itemText = this.GetItemText(actualIndex);
                        if (!string.IsNullOrEmpty(itemText))
                        {
                            int yy = size.Y + (tmpHeight * i) + (int)topOffset;
                            // Draw Text next to each notch
                            sizeItemText = g.MeasureString(itemText, this.Font);

                            int xxx = size.X + size.Width - 10 - Convert.ToInt32(sizeItemText.Width);
                            rectItemText = new Rectangle(xxx, yy, Convert.ToInt32(sizeItemText.Width), Convert.ToInt32(sizeItemText.Height));
                            PaintHotspot(g, Color.White, rectItemText, 200);

                            g.DrawString(itemText, this.Font, Brushes.Black, (float)xxx, (float)yy);
                        }
                        actualIndex++;
                    }
                }
            }

            // Calling the base class OnPaint
            base.OnPaint(pe);

            if (this.isRecording)
            {
                for (int i = 0; i < this.recordedRectangles.Count; i++)
                {
                    rect = recordedRectangles[i];
                    double ratio = (double)size.Height / (double)imageFile.Height;
                    Rectangle adjustedRectange = new Rectangle(
                        size.Left + (int)(rect.X * ratio),
                        size.Top + (int)(rect.Y * ratio),
                        (int)(rect.Width * ratio),
                        (int)(rect.Height * ratio));

                    PaintHotspot(g, Color.LightBlue, adjustedRectange, (i + 1).ToString());
                }
            }
            else if (this.paintHotSpots)
            {
                for (int i = 0; i < hotspots.Count; i++)
                {
                    Rectangle hotspot = hotspots[i];
                    double ratio = (double)size.Height / (double)imageFile.Height;
                    Rectangle adjustedRectange = new Rectangle(
                        size.Left + (int)(hotspot.X * ratio),
                        size.Top + (int)(hotspot.Y * ratio),
                        (int)(hotspot.Width * ratio),
                        (int)(hotspot.Height * ratio));

                    PaintHotspot(g, Color.LightGreen, adjustedRectange, (i + 1).ToString());
                }
            }
        }

        protected virtual void PaintHotspot(Graphics g, Color c, Rectangle hotspot, int alpha)
        {
            PaintHotspot(g, c, hotspot, alpha, null);
        }

        protected virtual void PaintHotspot(Graphics g, Color c, Rectangle hotspot, string txt)
        {
            PaintHotspot(g, c, hotspot, 100, txt);
        }

        protected virtual void PaintHotspot(Graphics g, Color c, Rectangle hotspot, int alpha, string txt)
        {
            SolidBrush brush = new SolidBrush(Color.FromArgb(alpha, c));
            g.FillRectangle(brush, hotspot);
            if (!string.IsNullOrEmpty(txt))
                g.DrawString(txt, this.Font, Brushes.DarkGreen, hotspot.Location);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-26T02:31:35.423

**更新**

我想以下行导致错误。

```
this.imageFile = EducationalSuite.Core.Properties.Resources.singlepixel; 
```

该代码指的是图像资源“单像素”。此图像必须位于 EducationalSuite.Core 程序集的默认资源文件中。首先通过打开项目属性并检查应用程序页面上的默认命名空间来确认您当前正在编辑所述程序集。这应该说明“EducationalSuite.Core”。如果不是这种情况，您很可能缺少对所述程序集的引用。

如果您打开 EducationalSuite.Core 项目，添加单像素资源的最简单方法是打开项目属性、资源选项卡并创建一个新的默认资源文件。从顶部打开“添加资源”下拉菜单，然后根据您是否已经拥有该文件或是否需要创建它来选择现有文件或新图像。将资源命名为“单像素”。

Visual Studio 将为您在 Properties 命名空间下生成 Resources 帮助器类，以便您可以通过代码中 EducationalSuite.Core 下的 Properties.Resources.singlepixel 访问资源。

**旧答案**

一般来说，Properties 命名空间是包含应用程序或用户特定设置的命名空间。您可以通过导航到项目属性中的设置选项卡来添加这些设置（和命名空间）。

不幸的是，根据这些信息很难说更多。您能提供导致此错误的代码吗？

如果您双击错误消息，IDE 会将您带到导致错误的行。

这段代码很可能需要一个未添加到项目中的设置变量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T02:30:10.200

看起来您缺少参考。如果它不在解决方案资源管理器中的引用下，我会在 Windows 中搜索“EducationalSuite.Core”的文件，以查看它在系统上的位置并添加它。您可能还缺少“使用”语句？如果您将鼠标悬停在“属性”文本上，您应该会看到一个小的下拉菜单，它将为您添加使用的。

如果这没有帮助，更多信息会有所帮助吗？

希望这可以帮助！

# date - 为什么我的 Falcon 脚本打印提前一个月的日期而不是今天的日期？

> ID：790130
> 
> 赞同：2
> 
> 时间：2009-04-26T02:22:03.887
> 
> 标签：date, falcon

今天是 2009 年 4 月 25 日，在美国格式中缩写为月-日-年，所以今天是 04-25-09。这条线

```
> CurrentTime().toString("%m-%d-%y") 
```

应该打印“04-25-09”。相反，它打印“05-25-09”。这是为什么？根据[文档](http://www.falconpl.org/project_docs/core/_functions.html#CurrentTime "文档") `CurrentTime()`返回一个`TimeStamp`实例。`TimeStamp`有一个`toString()`接受日期/时间格式作为参数的方法，它应该是 [strftime 格式](http://linux.die.net/man/3/strftime)。我对代码的理解有问题吗？我在 Windows Vista（64 位）上使用 Falcon 0.8.14.2("Vulture")

[2](http://linux.die.net/man/3/strftime)： http: [//linux.die.net/man/3/strftime](http://linux.die.net/man/3/strftime) strftime 格式

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-26T16:23:39.963

我还在 Falcon [Google Group](http://groups.google.it/group/falconpl/browse_thread/thread/21525a601a90de4d)上发布了这个问题。显然，这是 Falcon 本身的问题，在 0.9.1 版中已修复。根据我从 Falcon 编程语言的发明者 Giancarlo Niccolai 收到的回复，0.9.1 版本将在一两周内正式发布。

# vb6 - Process Explorer 的内存指标：WS Private、WS Shareable、WS Shared 列是如何计算的？

> ID：790138
> 
> 赞同：2
> 
> 时间：2009-04-26T02:26:56.277
> 
> 标签：vb6, memory-management

我正在继续我的[传奇](https://stackoverflow.com/questions/742671/tools-to-identify-memory-hogs-in-vb6-applications)以了解 VB6 应用程序的内存消耗。目前看来效果最好的选项是在运行时监控关键点的各种内存指标，并了解大内存占用的位置。研究这一点的衡量驱动因素是了解终端服务器 (Citrix) 中的多用户环境中的应用程序可扩展性如何因内存消耗的变化而受到影响（简单来说，您使用的内存越多，服务器上可以容纳的用户越少）。

[我可以使用GetProcessMemoryInfo](http://msdn.microsoft.com/en-us/library/ms683219(VS.85).aspx)获取进程的大多数内存指标。Process Explorer 报告其他指标 WS Private、WS Shareable、WS Shared——这对我的调查来说似乎很有趣。

所以问题是，是否有标准/隐藏的 API 来获取流程的这些指标？我想以编程方式查询这些指标，以便在应用程序运行期间在关键点捕获它们并更好地了解内存使用情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T03:16:35.643

请参阅 QueryWorkingSet API。不过，这看起来相当讨厌，因为它会按每页返回信息，因此由您自己来汇总总数。如果有更好的方法，请发表评论，我将删除此答案。

此外，如果您想在特定位置监控工作集中的更改，您可能需要查看 InitializeProcessForWsWatch 和 GetWsChanges API——这些可能更容易查看有多少页面出现错误，而不是让前后遍历整个页面集。

# html - W3C Validating an HTML Page with & in URLs

> ID：790144
> 
> 赞同：2
> 
> 时间：2009-04-26T02:35:34.900
> 
> 标签：html, validation, url

I have a page in which users submit URLs, some of which contain &, = etc. Now if I want it to validate it with W3C I need to write it as & = etc. How can I automatically do this? Also, should I even bother?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-13T22:11:39.113

you should encode the urls on server side then. not knowing what backend language you use, here's a list:

```
* htmlentities() - PHP
* HttpUtility.UrlEncode() - ASP.net
* URI.escape() - Ruby
* URLEncodedFormat() - Coldfusion
* urllib.urlencode() - Python
* java.net.URLEncoder.encode() - Java 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T02:54:12.357

Yes, you should bother, and it's quite simple. Saying, "Oh, look how many invalid pages there are" does not excuse your contributions to the problem. Every major language either has this functionality built-in (as Can noted for PHP) and/or can implement it trivially.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T02:43:42.163

I'd say don't even bother. See Jeff's post on the subject: [HTML Validation: Does It Matter?](https://blog.codinghorror.com/html-validation-does-it-matter/)

On the other hand, if you're a perfectionist, properly escaping query strings should be pretty trivial in any language. For example, you can use `htmlspecialchars`, `htmlentities`, `urlencode` or `rawurlencode` in PHP.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-26T03:15:23.383

If users are submitting urls and you want to assist them in not making errors, then I'd validate the url by calling it. Use the http head method to validate the url.

This will take more programming than statically looking at the url string. You'll want to think about using a helper process, returning the result asynchronously to the original submit, etc. But that's the sort of stuff which separates the students from the professionals.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T23:02:27.643

您需要使用`%26`而不是`&`.

但在一般情况下，无论您使用哪种语言，都可以找到一个 URL 编码器函数。

# ruby-on-rails - RoR：如何创建“有效注册码”查找？

> ID：790155
> 
> 赞同：1
> 
> 时间：2009-04-26T02:53:46.227
> 
> 标签：ruby-on-rails, ruby, routes

我希望能够以电子邮件链接的形式向潜在用户提供代码（例如 mysite.com/signup?beta=rapunzel）

当有人单击该链接时，它会使用该值填充一个 hidden_​​field（仅使用 :params[:beta] 会起作用吗？）

然后在它创建用户之前，它通过检查另一个我有不同 beta 代码的表来验证。

然后继续存储哪些代码或者只是 beta.id。

建议？插件已经存在？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T03:25:46.680

当您的用户点击 mysite.com/signup 时，与该路由关联的操作将具有存储在 params[:beta] 中的值“rapunzel”。您可以通过将其分配给实例变量（@beta）将其传递到您的视图，按计划通过隐藏字段将其传递回您的用户控制器，并在保存用户对象之前将其与您的表进行比较。

或者，如果用户传入有效的 beta 代码，您可以只允许他们访问注册页面，在这种情况下，您不需要任何特殊的表单字段：

```
def signup
  unless BetaCode.find_by_code(params[:beta])
    flash[:notice] = "You can't sign up without a beta code!"
    redirect_to root_path 
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T03:25:58.553

您从 URL 中获得的参数取决于您的路由设置方式。使用您当前的路线，您将获得：

```
params[:beta] = "rapunzel" 
```

如果您将路线指定为：

```
map.connect '/signup/:beta', :controller => 'signup', :action => 'beta' 
```

您可以向他们发送一个链接，例如：mysite.com/signup/rapunzel，您将获得与以前相同的 beta 参数。

要将 beta 字段添加到表单中，只需将其作为隐藏字段包含在表单页面模板中即可。

在控制器中放置如下内容：

```
@beta_id = params[:beta] 
```

然后在视图模板中放置：

```
hidden_field_tag 'beta', @beta_id 
```

然后，当他们注册并创建正确的 id 时，您可能希望将用户表中的行与“beta”表中包含 beta id 的行关联起来。如果您只想允许单个用户使用每个 beta id 注册，这可能是 beta 表上的 has_one 关联，或者如果多个人可以注册它，则可能是 has_many。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T07:25:19.233

我会通过验证来做到这一点。

```
class User < ActiveRecord::Base
  validate_on_create {|r|
    beta_code = BetaCode.find_by_code(r.beta_code)

    beta_code && beta_code.destroy ||
      r.errors.add(beta_code, "is invalid")
  }

  attr_accessor :beta_code
end 
```

在您的表格中：

```
<% form_for(@user) do |f| %>
  # fields...
  <%= f.text_field :beta_code %>
<% end %> 
```

这假设您有一个 BetaCode 模型，其表包含一个 beta 代码列表。

# jquery - JQuery if then else using URL parser plugin quest for beautiful take 2

> ID：790158
> 
> 赞同：2
> 
> 时间：2009-04-26T02:54:34.073
> 
> 标签：jquery, firefox, url

这是我关于这个主题的第二个问题，原始问题可以在这里找到： [JQuery if then else using URL parser plugin，必须有一个更优雅的解决方案！](https://stackoverflow.com/questions/788068/jquery-if-then-else-using-url-parser-plugin-there-must-be-a-more-elegant-solutio)

如果你坐得舒服，我就开始！

我已经建立了一个包含问题列表的网页。每个问题后面都有一个包含在 Div 中的答案。HTML 如下所示：

```
<div class="questions_main_box">
   <h2>common questions:</h2>
   <ul>
      <li>
         <h3 id="question1">question number 1</h3>
     <div id="answer1"> answer number 1</div>
      </li>
      <li>
         <h3 id="question2">question number 2</h3>
     <div id="answer2"> answer number 2</div>
      </li>
      etc etc...
   </ul>
</div> 
```

我已经使用 jQuery 编写了一些代码来调整此列表的行为方式。这个想法是所有答案 Div 都被 jQuery 隐藏，然后以两种方式之一显示它们：

用户点击相关的 h3 标题

或者

用户从另一个页面单击指向其中一个问题的链接。

如果用户来自另一个页面，则应显示他们单击的问题并隐藏所有其他问题。

我已经完成了这项工作，但我的代码效率很低。在我之前解释这个问题时，我得到了一个答案，但我收到的答案有一个不良的副作用：除非 URL 中有锚链接，否则他们会阻止菜单显示任何答案。例如：

[http://mydomain.com/questions.html](http://mydomain.com/questions.html)不起作用

但

[http://mydomain.com/questions.html#question1](http://mydomain.com/questions.html#question1)会工作！

我需要两者都工作！正如我所说，我的版本在这两种方式上都有效，但非常笨拙，我相信一定有更好的表达方式。这是可能更有效的代码：

```
if 
($.url.attr('anchor') == 'question1'){
        $('#answer2, #answer3, #answer4, #answer5, #answer6, #answer7, #answer8').hide();
        $.scrollTo('#question1');
}
else if
($.url.attr('anchor') == 'question2'){
        $('#answer1, #answer3, #answer4, #answer5, #answer6, #answer7, #answer8').hide();
        $.scrollTo('#question2');
}
else if
($.url.attr('anchor') == 'question3'){
        $('#answer1, #answer2, #answer4, #answer5, #answer6, #answer7, #answer8').hide();
        $.scrollTo('#question3');
}
else if
($.url.attr('anchor') == 'question4'){
        $('#answer1, #answer2, #answer3, #answer5, #answer6, #answer7, #answer8').hide();
        $.scrollTo('#question4');
}
else if
($.url.attr('anchor') == 'question5'){
        $('#answer1, #answer2, #answer3, #answer4, #answer6, #answer7, #answer8').hide();
        $.scrollTo('#question5');
}
else if
($.url.attr('anchor') == 'question6'){
        $('#answer1, #answer2, #answer3, #answer4, #answer5, #answer7, #answer8').hide();
        $.scrollTo('#question6');
}
else if
($.url.attr('anchor') == 'question7'){
        $('#answer1, #answer2, #answer3, #answer4, #answer5, #answer6, #answer8').hide();
        $.scrollTo('#question7');
}
else if
($.url.attr('anchor') == 'question8'){
        $('#answer1, #answer2, #answer3, #answer4, #answer5, #answer6, #answer7').hide();
        $.scrollTo('#question8');
}
else if
($.url.attr('anchor') != 'question1, question2, question3, question4, question5, question6, question7, question8'){
        $('.questions_main_box ul li div').hide();
}; 
```

它工作正常，但相当笨重，在它目前的化身中，这也意味着如果我想添加更多问题和答案，我必须将它们明确添加到 ID 列表中。最好不要这样做！

就这样你有整个画面是其余的代码：

```
$('.questions_main_box h3').addClass('js_main_box');
    $('.questions_main_box h3').hover(
        function(){
            $(this).addClass('js_main_box_highlight');
        },
        function(){
            $(this).removeClass('js_main_box_highlight');
        }
    );

    $('.questions_main_box h3').click(
            function(){
                if ($(this).next().is(':visible')){
                    $(this).next().hide('fast');
                    }
                else if ($(this).next().is(':hidden')){
                    $(this).next().show('fast');
                    }
            }
    ); 
```

所以所有这些都按原样工作，我真的只是在寻找提高效率的方法。

~~我发现我正在做的事情有一个问题，对于我的一生，我无法弄清楚它为什么会发生或我将如何解决它：~~

问题仅在 Firefox 中（我测试过 3.0.9 和 3.1b3）

当我单击要转到相关问答的锚链接之一时，Firefox 将跳转到正确的页面，并且正确的答案将可见但页面不会垂直滚动到锚标记所在的正确位置开始。这意味着当用户第一次到达问答页面时，用户点击的问题通常在屏幕上不可见！这只发生在 Firefox 中。Safari 和 Opera 去对了地方。我确信它必须与隐藏的 Divs 有关，因为当 javascript 关闭并且列表正常显示时，锚标签在 Firefox 中工作正常。我觉得这真的很奇怪，我不知道如何修复它，或者它是否只是一个没有解决方法的错误。我们将不胜感激地收到有关我的任何一个问题的任何信息。

感谢您花时间看这个！

伊恩。

附言

我正在使用此处找到的 JQuery URL 解析器插件：[http ://projects.allmarkedup.com/jquery_url_parser/](http://projects.allmarkedup.com/jquery_url_parser/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T03:13:19.567

我建议使用 CSS 选择器来隐藏您的答案。为此，您必须在答案中添加一个类属性。

```
<div class="questions_main_box">
   <h2>common questions:</h2>
   <ul>
      <li>
         <h3 id="question1">question number 1</h3>
     <div id="answer1" class="answer">answer number 1</div>
      </li>
      <li>
         <h3 id="question2">question number 2</h3>
     <div id="answer2" class="answer">answer number 2</div>
      </li>
      etc etc...
   </ul>
</div> 
```

然后使用 jquery 你可以使用这个隐藏所有答案

```
$('.answer').hide(); 
```

因此，与您的其他问题*[JQuery 一起使用 URL 解析器插件，必须有一个更优雅的解决方案！](https://stackoverflow.com/questions/788068/jquery-if-then-else-using-url-parser-plugin-there-must-be-a-more-elegant-solutio/788069#788069)*这将是：

```
var match = jQuery.url.attr('anchor').match(/^question([0-9]+)$/);
if (match && match.length > 0) {
    $('.answer').hide();
    $('#answer' + match[1] ).show();
} 
```

或者像这样的单行。

```
 $('.answer').hide().is('#answer' + match[1]).show(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T03:22:42.117

*要解决您的 Firefox 问题，您可以尝试在取消隐藏后*使用 jQuery 滚动到您的锚点。我想这有点骇人听闻，但它应该可以工作。

jQuery 的“接口”插件包括一个 scrollTo 方法。[关联](http://interface.eyecon.ro/)

示例用法。[jQuery 平滑滚动到锚链接](http://snipplr.com/view/5988/jquery-smotth-scroll-to-anchor-links/)

为了解决优雅问题，这里有一个想法：

```
var targetDiv = $('#'+($.url.attr('anchor'))).next().attr('id');
$("div[id!='"+targetDiv+"'][id^='answer']").hide();
$("div[id='"+targetDiv+"']").show();
$.scrollTo('#'+($.url.attr('anchor'))); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T05:41:44.670

我的建议是最初不要使用 jQuery 来隐藏答案，因为动态地这样做似乎可能会使浏览器混淆页面的长度。

相反，我会使用一个类和 CSS 来隐藏它们，例如

```
<li>
  <h3 id="question1">Foo?</h3>
  <div id="answer1" class="answer">Bar!</div>
</li> 
```

并添加`.answers { display: none; }`到页面的样式中，以便浏览器知道这些在页面首次呈现时不会出现。然后，添加`$('#answer1').show()`将显示适当的。

当然，这仅在您的用户启用了 Javascript 时才有效，这可能是一个有效的假设。如果他们可能没有，那么您需要在页面完全呈现之前将此 CSS 动态添加到页面顶部。这是通过在`<script>`添加样式的主体顶部添加 a 来完成的：

```
<body>
  <script type="text/javascript">
    var style = document.createElement('style');
    style.type = 'text/css';
    style.innerHTML = '.answers { display: none; }';
    document.getElementsByTagName('head')[0].appendChild(style);
  </script>
  ... 
```

这将确保没有 Javascript 的人可以看到所有答案。

在我的测试中，这样做可以确保页面正确滚动到正确的问题，至少在 FF3 中是这样。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T00:04:58.247

你应该添加一个类，用css将它们全部隐藏起来会更干净。但是使用您现有的 html ...

```
$("div.questions_main_box div").hide(); 
```

在没有主播的情况下，您似乎希望第一个问题显示...

```
var question = jQuery.url.attr('anchor') | "question1";
var match = question.match(/^question([0-9]+)$/);
if (match && match.length > 0) {
    $('#answer' + match[1] ).show().scrollTo();
} 
```

我不确定您的代码中的 .scrollTO 是什么，但我认为它是一个插件，并且 $.scrollTo(selector) 应该与 $(selector).scrollTo() 相同

由于您使用的是锚点，因此您应该使用浏览器内置的带有锚点的滚动机制，而忘记 jQuery 滚动。为每个问题添加相应的锚标记，例如：

```
<li>
    <a name="question1" /> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T03:13:33.050

```
$('.questions_main_box h3').addClass('js_main_box');

$('.questions_main_box h3').bind('mousenter mouseleave',function(){
    $(this).toggleClass('js_main_box_highlight');
});

$('.questions_main_box h3').click(function(){
    var answer = $(this).parent().find("div");
    if (answer.is(':visible')) {
      answer.hide('fast');
      return;
    }
    answer.show('fast');
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T13:30:16.937

好的，所以我要回答我自己的问题！此解决方案使用 scrollTo 修复了 Firefox 滚动错误，并且代码更加优雅和可扩展。它仍然不完美，但我已经设法将 if 循环浓缩为：

```
if 
  ($.url.segment(1) == 'questions.html'||'terms.html') {
    $('.questions_main_box ul li div').hide();
    $('#'+($.url.attr('anchor'))).next().show();
    $.scrollTo('#'+($.url.attr('anchor')));
}; 
```

## 优点：

*   代码更加优雅/浓缩/干燥
*   URL 锚现在可以工作，无论它们被称为什么
*   不依赖于匹配的问题和答案 ID
*   将扩展到任意数量的条目

## 缺点：

*   在 URL 解析用于显示任何匹配项之前，所有 div 都被隐藏。这比找到一种测试方法并仅隐藏必要的 div 效率略低。

就是这样！我希望这可以帮助那些脑子里有类似难题的人！如果有人能想出一种方法来改进此代码以删除最终的骗局，那么我真的很想看看您的解决方案。

最后感谢 Steven Richards 通过建议使用 scrollTo 来解决 Firefox 错误问题。一个无痛且简单的解决方案，谢谢！[https://stackoverflow.com/users/96089/steven-richards](https://stackoverflow.com/users/96089/steven-richards)

# html - Submit form via image

> ID：790159
> 
> 赞同：1
> 
> 时间：2009-04-26T02:54:54.133
> 
> 标签：html, firefox

Is there any way that user submits the form using image instead of the form button while the request made is still the POST rather than GET? It seems that submitting form via image will result into the GET request. I do not want to post it in this manner as I will be posting the account credentials . For instance, I want to log in. Any help would be highly appreciated!

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-26T03:13:46.540

You need:

```
<input type="image" name="blah" ... > 
```

Clicking that will submit the form. You'll get extra fileds of blah_x and blah_y to indicate the coordinates the user actually clicked.

More [here](http://www.htmlcodetutorial.com/forms/_INPUT_TYPE_IMAGE.html).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T02:57:18.793

As long as you have:

```
 <form method=POST> 
```

The type of submit should be post for the form.

# oop - Terminology - parts of a composite relationship

> ID：790160
> 
> 赞同：0
> 
> 时间：2009-04-26T02:55:30.733
> 
> 标签：oop, composition

Assume I have a *composite* relationship, say a Customer having a collection of Orders (and assuming an Order cannot exist without an "owning" Customer.) So, I'm **not** talking about *aggregation*.

What terms are used to describe the roles in this relationship? I might say the Customer is the "owner" of an Order and maybe the Order is "owned", but surely there are better terms, terms that can be stated without referring to the other role.

I'm trying to determine these terms so I can propertly name attributes in a meta model. I can "make something up", but would like to use names that will be easily understood.

Thanks in advance for suggestions and/or pointers to definitive sources.

Bill

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T04:05:02.733

你想要“有”关系；我们的东西“有一个”没有附加的东西，而不是“是一个”关系的继承。您可以围绕这两种关系构建相当稳健的模型。但。

进一步假设，在主题地图（因为我们正在谈论元模型）中，我们有一些内置关系，它们也具有全局标识符（您可以将其用于全局知识/数据交换），它们是超类型 - 子类型（表示层次结构）和类型实例（表示典型化，强类型“是一个”）关系。这些是相当全球性的（意思是，也在主题地图世界之外）。[查看主题地图数据模型](http://www.isotopicmaps.org/sam/sam-model/)的末尾以了解更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T03:03:40.820

This is also called the "has a" relationship. The `Customer` object "has a" collection of `Order` objects. Where as in inheritance, you'd say the `Customer` "is a" `Person`. You could also say the collection of `Order`s is a field or member or whatever you're language calls member variables. You'd just call the `Customer` an object (or a composite type). Most classes are composite types anyway, unless there's no state (i.e. just methods/behavior).

# iphone - iphone - open and close sqlite database every time I use it

> ID：790163
> 
> 赞同：8
> 
> 时间：2009-04-26T02:58:03.847
> 
> 标签：iphone, sqlite

I am writing an iPhone app that uses SQLite. I am use to opening and closing my connections every time I use a database. However, I do not know if that is a good practice in the iPhone/SQLite environment. I want to know if I should open the database 1 time or if it is OK to open and close the database each time I use it. Please let me know.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-26T03:15:23.400

I believe you should keep it open as long as you can, so data is cached in DRAM. Of course, you should also organize your transactions so you commit at logical points in time and maintain transactional integrity.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T03:45:16.493

我会按照 Matthew 的建议做：只要您的程序正在运行，就保持一个连接打开。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T12:53:00.797

这两个答案似乎都是正确的，但实际上这取决于您使用它的频率以及它的大小。如果数据库很大，您应该设置更大的页面缓存，但这会导致更大的内存消耗，并且如果访问很少 - 没有理由一直保持它（但如果使用量也很小 - 大页面缓存也无济于事）。

如果它很小 - 即使不经常使用，也没有理由每次都打开/关闭它。但平均而言，定期打开/关闭您的资源消耗会更高。所以总而言之 -**不要在每次使用时重新打开 db**。

# language-agnostic - How to implement a single sign-on authentication server?

> ID：790172
> 
> 赞同：4
> 
> 时间：2009-04-26T03:14:45.897
> 
> 标签：language-agnostic, http, authentication

I want to implement a discrete remote authentication server that handles login for many sites. Somewhat similar to OpenID.

Basically, I have site-1 and site-2 and they're both reliant on the same user database, which is on a separate auth-site. So, auth-site handles user authentication for them, and during this process, makes information on the authenticating user available to the requesting system.

Each site can be on a completely separate domain name, on completely separate machines.

This is all via HTTP(S), there can be no direct database access.

There's one last quirk: once an user has logged in to site-1, when accessing any other site reliant on auth-site, the site must treat the user as already authenticated.

This whole business must be entirely fuss-free to the end-user. It should work like a simple everyday login form.

As a concrete example, say we're talking about `stackoverflow.com` and `serverfault.com`, and they both authenticate via `authentic-overflow-server-stack.com`. Again, once logged in to either site, I can go to the other and do my business without logging in again.

What I'd like to know are the general interaction mechanism between the sites behind this scenario.

In my particular setup, I'm using Rails, but I'm not looking for code[1], just general best practice and guidance, so feel free to answer in pseudo-code or any generally readable language. OTOH, bear in mind that I'll have decent MVC, REST, and meta-programming in my toolkit.

* * *

[1]: unless you happen to know an existing tiny neat free MIT/BSD-licensed app/plugin/generator that handles this.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T16:15:54.533

看起来[CAS](http://www.jasig.org/cas)对我来说已经足够好了，并且有 ruby​​ 实现，以及其他几十种较小的语言，例如一种与股骨愤怒押韵的语言。

*   [http://code.google.com/p/rubycas-server/](http://code.google.com/p/rubycas-server/)
*   [http://code.google.com/p/rubycas-client/](http://code.google.com/p/rubycas-client/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T04:00:34.087

听起来（特别是强调无忧无虑），你想要像维基媒体基金会正在做的事情。基本上，您登录到 en.wikipedia.org，然后该服务器与其他服务器（例如 en.wikinews.org）通信并获取身份验证令牌。最后，这些令牌嵌入到图像中，例如[http://en.wikinews.org/wiki/Special:AutoLogin?token=xxxxxxxxxxxxxxx](http://en.wikinews.org/wiki/Special:AutoLogin?token=xxxxxxxxxxxxxxx)，当您的浏览器访问该 url (img src) 时，它会获得一个 Wikinews 的身份验证 cookie。当然，您可以在[http://www.mediawiki.org/wiki/Extension:CentralAuth](http://www.mediawiki.org/wiki/Extension:CentralAuth)获得源代码。

OpenID 也是一个不错的选择，但它确实需要用户“有意识地”访问两个域。Canonical 就是一个具有两个域的实体的示例。例如，如果您访问[https://help.ubuntu.com/community/UserPreferences](https://help.ubuntu.com/community/UserPreferences)，他们会将您重定向到 Launchpad ( [https://login.launchpad.net/+openid](https://login.launchpad.net/+openid) ) 进行身份验证。

请注意，Wikipedia 是通过 http 执行此操作的，但您可以全部执行 https 以确保不拦截 img src 令牌。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T03:19:12.093

听起来您想实际使用 OpenID 协议本身。没有理由不能将身份验证提供程序限制在您自己的服务器上，并执行一些使身份验证过程透明的快捷方式。此外，OpenID 协议支持您所描述的有关登录的内容，即登录所有服务。

# css - 如何让图像拉伸 DIV

> ID：790176
> 
> 赞同：1
> 
> 时间：2009-04-26T03:16:08.000
> 
> 标签：css

我正在尝试在我的新 Tumblr 博客主题中获取图像以扩展 div 元素。

目前，我的照片 div 正在调整其父容器的全宽。我遇到的问题是我在照片下方还有一个标题 div，如果照片不是其包含 div 的全宽，我不希望标题溢出照片的边缘。

[问题 ！](http://dl.getdropbox.com/u/973862/test/index.html "问题 ！")

这就是我所追求的： [alt text http://dl.getdropbox.com/u/973862/problem.jpg](http://dl.getdropbox.com/u/973862/problem.jpg) [这是一幅画！](http://dl.getdropbox.com/u/973862/problem.jpg)

这是我的代码：

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">

<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>untitled</title>
    <meta name="generator" content="TextMate http://macromates.com/">
    <meta name="author" content="Brant Winter">
    <!-- Date: 2009-04-26 -->
</head>

<style type="text/css">

.container {
    width: 520px;
    margin-left: auto;
    margin-right: auto;
}

.photo {
    border: solid 1px #ccc;
    margin-left: auto;
    margin-right: auto;
}

</style>

<body>

<div class="container">
  <div class="photo">
    <img src="http://8.media.tumblr.com/mFYIJY2I7mpit79h73TC9xa7o1_400.jpg">
    <div class="caption">Sausage dog airtime</div>
  </div>
</div>

</body>
</html> 
```

这就是它在我的浏览器中的样子： [alt text http://dl.getdropbox.com/u/973862/Picture%202.png](http://dl.getdropbox.com/u/973862/Picture%202.png) [这就是它的样子](http://dl.getdropbox.com/u/973862/Picture%202.png)

容器 div 应该居中，图像应该居中，并且标题文本不应该越过照片的边缘（如果有足够的文本可以这样做）

不知道我是否有任何意义，但任何帮助将不胜感激 - 我今天花了几个小时！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T04:37:04.293

如果你不介意使用 jQuery 来调整它的大小，你可以尝试这样的事情：

```
 <script type="text/javascript" 
src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function() {
            $(".container").css("width", $(".photo img").css("width"));
        });
    </script> 
```

这会找到具有“photo”类的 div 内图像的宽度（注意“.photo”和“img”之间的空间），并将该宽度应用于具有“container”类的 div。为了安全起见，如果可能，您可能希望使用 ID，但只要类名是唯一的，这将起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T03:25:17.243

你的意思是让照片居中？

```
.photo {
border:1px solid #CCCCCC;
margin-left:auto;
margin-right:auto;
text-align:center; <--- 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T03:29:21.087

我认为最简单的解决方案就是固定容器的宽度。为什么呢`520px`？

但是，如果必须是`520px`，那么只需将容器中的内容居中并为标题添加自动边距：

```
<style type="text/css">

.container {
    width: 520px;
    margin-left: auto;
    margin-right: auto;
    text-align: center;
}

.photo {
    border: solid 1px #ccc;
    margin-left: auto;
    margin-right: auto;
}

.caption {
    max-width: 333px;
    margin-left: auto;
    margin-right: auto;
}

</style> 
```

特别是，该`max-width`属性将防止标题溢出照片的边缘。

# linux - rm 无法通过通配符从脚本中删除文件，但可以在 shell 提示符下工作

> ID：790195
> 
> 赞同：65
> 
> 时间：2009-04-26T03:41:45.537
> 
> 标签：linux, bash, shell

我在使用 Linux shell 脚本时遇到了一个非常愚蠢的问题。我想删除目录中所有扩展名为“.bz2”的文件。在我调用的脚本中

```
rm "$archivedir/*.bz2" 
```

其中 $archivedir 是目录路径。应该很简单，不是吗？不知何故，它设法因以下错误而失败：

```
rm: cannot remove `/var/archives/monthly/April/*.bz2': No such file or directory 
```

但是该目录中有*一个*名为 test.bz2 的文件，如果我将脚本更改为

```
echo rm "$archivedir/*.bz2" 
```

并将该行的输出复制/粘贴到终端窗口中，文件已成功删除。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2009-04-26T04:38:53.353

**TL;博士**

仅引用变量，而不是使用通配符的整个预期路径

```
rm "$archivedir"/*.bz2 
```

**解释**

*   在 Unix 中，程序本身通常不解释通配符。shell 解释不带引号的通配符，并用匹配的文件名列表替换每个通配符参数。如果 $archivedir 可能包含空格，则`rm $archivedir/*.bz2`可能不会执行您的操作

*   您可以通过引用通配符、使用双引号或单引号或在它之前的反斜杠来禁用此过程。但是，这不是您想要的 - 您确实希望通配符扩展到它匹配的文件列表。

*   写作时要小心`rm $archivedir/*.bz2`（不带引号）。单词拆分（即，将命令行分解为参数）发生*在*替换 $archivedir 之后。因此，如果 $archivedir 包含空格，那么你会得到你不想要的额外参数。说 archivedir 是`/var/archives/monthly/April to June`. 然后你会得到相当于 writing `rm /var/archives/monthly/April to June/*.bz2`，它试图删除文件“/var/archives/monthly/April”、“to”和所有匹配“June/*.bz2”的文件，这不是你想要的.

正确的解决方案是这样写：

```
rm "$archivedir"/*.bz2
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-26T06:18:15.860

你原来的线

```
rm "$archivedir/*.bz2" 
```

可以重写为

```
rm "$archivedir"/*.bz2 
```

达到同样的效果。通配符扩展未在您现有的设置中正确进行。通过将双引号移到文件路径的“前面”（这是合法的），您可以避免这种情况。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-26T04:02:22.803

稍微扩展一下，bash 有相当复杂的规则来处理引号中的元字符。一般来说

*   几乎没有任何东西用单引号解释：

    ```
     echo '$foo/*.c'                  => $foo/*.c
     echo '\\*'                       => \\* 
    ```

*   shell 替换在双引号内完成，但文件元字符不展开：

    ```
     FOO=hello; echo "$foo/*.c"       => hello/*.c 
    ```

*   反引号内的所有内容都传递给解释它们的子shell。未导出的 shell 变量不会在子 shell 中定义。所以，第一个命令回显空白，但第二个和第三个回显“再见”：

    ```
    BAR=bye echo `echo $BAR`
    BAR=bye; echo `echo $BAR`
    export BAR=bye; echo `echo $BAR` 
    ```

（要让它以你想要的方式打印出来，SO~~需要多次尝试~~显然是不可能的......）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-26T03:45:42.857

引号导致字符串被解释为字符串文字，请尝试删除它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-09-09T13:13:52.763

当从另一个 shell 脚本调用**./shell_script.sh 之**类的 shell 脚本时，我看到了类似的错误 。这可以通过将其调用为 **sh shell_script.sh 来解决**

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-12-26T11:13:07.430

为什么不只是`rm -rf */*.bz2`？在 OSX 上为我工作。

# serial-port - 半双工串行连接的含义是什么？

> ID：790196
> 
> 赞同：3
> 
> 时间：2009-04-26T03:42:10.510
> 
> 标签：serial-port, duplex

使用半双工串行连接与全双工串行连接有何不同？如果双方同时尝试发送数据会发生什么？您最终会收到损坏的数据吗？流量控制对您有帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T05:11:57.237

在线数据会出现乱码，这可能会导致设备接收到乱码数据，也可能不会。有时这将用于检测传输由于冲突而失败。

通常，您不会以与全双工相同的方式使用半双工以异步模式发送单个字符。相反，您会使用一些数据包协议来确定谁有权在何时发送，并且其中包括一些校验和（通常是 CRC）来检测损坏。

流量控制对此没有多大帮助。其目的是确保接收器不会被太多数据溢出。有使用 ASCII 字符 XON 和 XOFF 来启动和停止传输的软件流控制，以及使用 RTS（请求发送）和 CTS（清除发送）控制线的硬件流控制。XON/XOFF 风格的软件流控制不适用于半双工。

现在你看不到使用普通 RS-232 和调制解调器的半双工（我在 80 年代将它与声耦合器一起使用，即使在那时也很少见）。但 RS-485 很常见，用于各种协议的工业控制。还有许多其他以半双工方式运行的数据传输标准，主要是当有两个以上的设备连接到同一条线路时（古老的 10base2 以太网、CAN、LIN、FlexRay、I2C ......）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T04:07:00.513

我的天，你在这个时代从哪里找到半双工线？

无论如何，答案是，如果两端都驱动线路，那么一切都会变得混乱。出于这个原因，有指定的 ASCII 字符位于~~Clear to Send 和 Data Terminal Ready（CTS 和 DTR）~~用于进行握手。有关更多信息，请参阅[本教程](http://www.wcscnet.com/Tutorials/SerialComm/Page1.htm)。

啊，我应该去睡觉了。教程对了，我笨。

# regex - AS3 RegExp 匹配带有边界类型字符的单词

> ID：790202
> 
> 赞同：1
> 
> 时间：2009-04-26T03:46:40.360
> 
> 标签：regex, apache-flex, actionscript-3, word-boundary

我想匹配一个单词列表，当这些单词是真正的单词时，这很容易。例如`/\b (pop|push) \b/gsx`，当针对字符串运行时

> pop推了门，但它又弹回来了

将匹配单词 pop 和 push 但不弹出。

对于包含通常符合单词边界的字符的单词，我需要类似的功能。所以我需要`/\b (reverse!|push) \b/gsx`在对着绳子跑的时候

> 反向推！反向！推

只匹配反向！并推动但不匹配反向！推动。显然这个正则表达式不会那样做，那么我需要使用什么来代替 \b 来使我的正则表达式足够聪明来处理这些时髦的要求？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T06:30:30.513

在单词的末尾，\b 表示“前一个字符是单词字符，而下一个字符（如果有下一个字符）不是单词字符。您要删除第一个条件，因为可能存在非-“单词”末尾的单词字符。这会给您留下否定的前瞻：

```
/\b (reverse!|push) (?!\w)/gx 
```

我很确定 AS3 正则表达式支持前瞻。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T04:07:00.420

您的第一个问题是您需要交替使用三个（可能是四个）案例，而不是两个。

*   `/\breverse!(?:\s|$)/`逆转！通过它自己
*   `/\bpush\b/`自己推
*   `/\breverse!push\b/`一起
*   `/\bpushreverse!(?:\s|$)/`这是可能的情况

您的第二个问题是 a`\b`在 a 之后不匹配，`"!"`因为它不是 a `\w`。以下是[Perl 5 的内容`\b`](http://perldoc.perl.org/perlre.html)，您可能需要查阅您的文档以查看他们是否同意：

> 单词边界（“\b”）是两个字符之间的一个点，它的一侧有一个“\w”，另一侧有一个“\W”（以任意顺序），计算虚构字符字符串的开头和结尾与“\W”匹配。（在字符类中，“\b”表示退格而不是单词边界，就像它通常在任何双引号字符串中所做的那样。）

因此，您需要的正则表达式类似于

```
/ \b ( reverse!push | reverse! | push ) (?: \s | \b | $ )+ /gx; 
```

我省略了，`/s`因为这个正则表达式中没有句点，所以将其视为单行是没有意义的。如果`/s`不意味着将其视为引擎中的单行，则您可能应该将其添加回来。此外，您应该阅读您的引擎如何处理交替。我知道在 Perl 5 中要获得正确的行为，您必须以这种方式排列项目（否则反向！总是会胜过反向！推）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T07:56:34.160

您可以将 \b 替换为等效但不那么严格的东西：

```
/(?<=\s|^)(reverse!|push)(?=\s|$)/g 
```

这样，限制因素`\b`（它只能在实际`\w`单词字符之前或之后匹配）被删除。

现在空格或字符串函数的开始/结束作为有效分隔符，并且内部表达式可以在运行时轻松构建，例如从搜索词列表中构建。

# .net - .net gzip 解压流的问题

> ID：790203
> 
> 赞同：1
> 
> 时间：2009-04-26T03:46:43.870
> 
> 标签：.net, compression, gzip

这些方法可能有什么问题？

```
 byte[] bytes;

        using (var memory_stream = new MemoryStream())
        using (var gzip_stream = new GZipStream(memory_stream, CompressionMode.Compress))
        {
            var buffer = Encoding.Default.GetBytes("Hello nurse!");
            gzip_stream.Write(buffer, 0, buffer.Length);
            bytes = memory_stream.ToArray();
        }

        int total_read = 0;

        using (var input_stream = new MemoryStream(bytes))
        using (var gzip_stream = new GZipStream(input_stream, CompressionMode.Decompress, true))
        {
            int read;
            var buffer = new byte[4096];
            while ((read = gzip_stream.Read(buffer, 0, buffer.Length)) != 0) {
                total_read += read;
            }
        }

        Debug.WriteLine(bytes);
        Debug.WriteLine(total_read); 
```

gzipStr 是一个有效的 Gzipped Stream（我可以使用 GzipStream() Compress 成功压缩它）。

为什么total_read总是0？？？gzip 流是否在解压缩我的流？难道我做错了什么？

我在这里做错了什么？？？！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T04:54:08.433

你忘了冲洗。:) 请注意，Encoding.Default 通常不应在生产中使用。在下面，将其替换为 Encoding.UTF8 （或任何合适的）。最后，当然，下面的 santiy-check 仅在所有内容都适合单个缓冲区时才有效。但现在你应该明白了。

kementeus 表示我之前的代码在这里没有帮助，所以下面是我使用的确切代码：

```
public class GzipBug
{
    public static void Main(String[] a)
    {
        byte[] bytes;
    byte[] buffer;

    Encoding encoding = Encoding.UTF8;

        using (var memory_stream = new MemoryStream())
        using (var gzip_stream = new GZipStream(memory_stream, CompressionMode.Compress))
        {
            buffer = encoding.GetBytes("Hello nurse!");
            gzip_stream.Write(buffer, 0, buffer.Length);
        gzip_stream.Flush();
        bytes = memory_stream.ToArray();
        }

        int total_read = 0;

        using (var input_stream = new MemoryStream(bytes))
        using (var gzip_stream = new GZipStream(input_stream, CompressionMode.Decompress, true))
        {
        int read;
            buffer = new byte[4096];
            while ((read = gzip_stream.Read(buffer, 0, buffer.Length)) != 0) {
        total_read += read;
            }
        }

        Debug.WriteLine(encoding.GetString(buffer, 0, total_read));
        Debug.WriteLine(total_read);

    }
} 
```

它使用： gmcs -d:DEBUG -langversion:linq -debug+ GzipBug.cs 编译并运行为： MONO_TRACE_LISTENER=Console.Out GzipBug.exe

（您可以删除 MONO_TRACE_LISTENER 位）

# c# - 日期时间到单用 C#

> ID：790204
> 
> 赞同：0
> 
> 时间：2009-04-26T03:47:42.340
> 
> 标签：c#, sqlite, datetime, type-conversion

我正在尝试在 iTunes 和 MediaMonkeys 之间建立一个接口。当我将曲目从 iTunes 导入 MM 时，没有考虑 LastPlayed 字段。

所以我决定构建一个从 iTunes 读取值并更新 MM 数据库的接口。

我正在使用 phxsoftware 的包来访问 MM 使用的 SQLite 数据库。

数据库字段是 REAL 数据类型，映射为 DbType.Single。当我进行更新时，我使用 Convert.ToSingle(DateTime) 将 DateTime 对象（由 IITTrack 提供）转换为 Single。

但我收到一个错误，告诉那个 `Invalid cast from 'DateTime' to 'Single'.`

对此有任何提示吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-26T11:14:24.230

1.  SQLite 没有使用 Single（单精度 32 位），它实际上使用的是双精度（64 位）。
2.  根据[http://www.mediamonkey.com/wiki/index.php/ISDBSongData::LastPlayed](http://www.mediamonkey.com/wiki/index.php/ISDBSongData::LastPlayed)您需要执行以下操作：

    LastPlayed.Subtract(new DateTime(1899, 12, 30, 0, 0, 0, DateTimeKind.Utc)).TotalDays;

实际上，最好将该常量日期移至某个静态只读值...

PS 评论说 SQLite 不区分整数和浮点数是错误的 - 它只有 2 种数字类型 - 8 字节浮点数和 8 字节整数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T03:49:08.950

DateTime 具有 long 类型的 Ticks 属性，因此您可以轻松地将其转换为 Single

```
Convert.ToSingle(DateTime.Ticks); 
```

# php - 查找数据库中距离一组经纬度点一定距离内的所有记录

> ID：790206
> 
> 赞同：4
> 
> 时间：2009-04-26T03:49:18.917
> 
> 标签：php, mysql, distance, latitude-longitude

我已经看过所有的例子，这就是我到目前为止所得到的。

我的表很简单：

学校（表名） - School_ID - 纬度 - 经度 - 县 - extrainfo

这是我的代码：

```
<?php

 $con = mysql_connect("xxx","xxx","xxx");

 if (!$con) {

            die('Could not connect: ' . mysql_error());

 } else {}

 mysql_select_db("xxx", $con);

 $latitude = "36.265541";

 $longitude = "-119.207153";

 $distance = "1"; //miles

 $qry = "SELECT *, (3958.75 * ACOS(SIN(" . $latitude . " / 57.2958)*SIN(lat / 57.2958)+COS(" . $latitude . " / 57.2958)*COS(lat / 57.2958)*COS(long / 57.2958 - " . $longitude . " / 57.2958))) as distance FROM schools WHERE (3958.75 * ACOS(SIN(" . $latitude . " / 57.2958)*SIN(lat / 57.2958)+COS(" . $latitude . " / 57.2958)*COS(lat / 57.2958)*COS(long / 57.2958 - " . $longitude . " / 57.2958))) <= " . $distance;

 $results = mysql_query($qry);
 if (mysql_num_rows($results) > 0) {
            while($row = mysql_fetch_assoc($results)) {
                            print_r($row);
            }
 } else {}

 mysql_close($con);

 ?> 
```

但是当我尝试运行它时出现此错误：

警告：mysql_num_rows()：提供的参数不是有效的 MySQL 结果资源

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T04:12:23.183

首先，'long' 是 MySQL 中的保留关键字。您需要将其括在反引号中，如下所示：

```
SELECT `long`,lat FROM schools 
```

保留关键字的完整列表可在此处找到：[保留字](http://dev.mysql.com/doc/refman/5.0/en/reserved-words.html)

如果您可以使用 phpMyAdmin 之类的工具，我建议您在那里运行您的查询测试。

否则，请在运行 mysql_query() 后尝试在代码中执行此操作：

```
print(mysql_errno().' '.mysql_error()); 
```

这应该会给你 MySQL 生成的错误代码和错误消息。除了关键字问题之外，查询看起来还可以，但这会明确地告诉您。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T03:54:51.073

老实说，我建议您只获取所有学校的所有纬度/经度，并通过您的 PHP 代码循环运行 Haversine 函数。

# sharepoint - Sharepoint - 可连接接收，XSLT 可编辑 Web 部件？

> ID：790215
> 
> 赞同：1
> 
> 时间：2009-04-26T04:01:35.207
> 
> 标签：sharepoint, connection, web-parts

您可以使用“数据视图”webpart 从数据库调用中获取数据，然后您可以手动编辑 XSLT 以使其看起来并在该数据和 XSLT 功能的范围内执行您想要的任何操作。

是否有一个 Web 部件允许我做同样的事情，但使用连接的 Web 部件源而不是数据库集接收的数据？

例如：我希望能够引入一个数据视图 webpart，它可以查询一堆数据并使其在整个页面中都可用。然后，我想隐藏那个数据视图。隐藏后，我希望能够获取另一个可自定义的 Web 部件，并通过 Web 部件连接从数据视图 Web 部件中提取一个字段（或多个字段，如果可能）。这将允许我以创意格式显示各种字段，而不必由不同的 Web 部件在同一页面上多次调用相同的查询。

是否有内部 webpart 可以让我这样做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-26T23:28:13.000

不可以，您必须为每种显示样式和位置添加不同的数据视图 Web 部件。

数据视图 Web 部件是否存在实际性能问题？

# c# - Asp.net，Xml 错误

> ID：790227
> 
> 赞同：1
> 
> 时间：2009-04-26T04:12:56.130
> 
> 标签：c#, .net, asp.net, xml

我正在使用 asp.net 和 xml 创建一个页面，但它给了我一个错误

System.Web.HttpException：DataBinding：“System.Data.DataRowView”不包含名为“para”的属性。

```
**AdminWelcomeMsg.aspx**
<%@ Page Language="C#" MasterPageFile="ContentMasterPage.master" Debug="true"%>

<%@ Import Namespace="System.Xml"%>
<%@ Import Namespace="System.Xml.Xsl" %>
<%@ Import Namespace="System.Xml.XPath" %>
<%@ Import Namespace="System.Data" %>
<%@ Import Namespace="System.IO" %>

<asp:Content ID="Content2" ContentPlaceHolderID="ContentPlaceHolder1" Runat="Server">
<script runat="server">
    void Page_load(object sender, System.EventArgs e)
    {
        if (!Page.IsPostBack)
        {
            WelcomeData.DataSource = LoadWelcome();
            WelcomeData.DataBind();
        }

        if (Session["error_msg"] != null)
        {
            ErrorMessage.Text = Session["error_msg"].ToString();
            Session["error_msg"] = null;
            ErrorMessage.Visible = true;
        }
    }

    protected DataSet LoadWelcome()
    {
        string sourceXML = Server.MapPath("../App_Data/DefaultMsg.xml");

        if ((!File.Exists(sourceXML)))
        {
            return null;
        }

        DataSet cachedDataSet = (DataSet)Session["MyWelcome"];

        if (((cachedDataSet != null)))
        {
            return cachedDataSet;
        }

        DataSet dataSet = new DataSet();

        try
        {
            dataSet.ReadXml(sourceXML);
            Session["MyWelcome"] = dataSet;
        }
        catch (Exception e)
        {
            ErrorMessage.Text = e.Message;
            dataSet = null;
        }

        return dataSet;
    }

    public void Welcome_Edit(object Sender, DataGridCommandEventArgs E)
    {
        WelcomeData.EditItemIndex = (int)E.Item.ItemIndex;
        WelcomeData.DataSource = LoadWelcome();
        WelcomeData.DataBind();
    }

    public void Welcome_Update(object Sender, DataGridCommandEventArgs E)
    {
        DataSet dataSet = LoadWelcome();
        int row = (int)E.Item.ItemIndex;
        TextBox EditText;
        EditText = (TextBox)E.Item.FindControl("txtpara");
        dataSet.Tables[0].Rows[row]["para"] = EditText.Text;

        dataSet.WriteXml(Server.MapPath("../App_Data/DefaultMsg.xml"));
        Session["MyWelcome"] = null;
        WelcomeData.EditItemIndex = -1;
        WelcomeData.DataSource = LoadWelcome();
        WelcomeData.DataBind();

        Session["error_msg"] = "The message was updated successfully";
        Response.Redirect("AdminWelcomeMsg.aspx");
    }

    public void Welcome_Cancel(object Sender, DataGridCommandEventArgs E)
    {
        WelcomeData.EditItemIndex = -1;
        Session["MyImage"] = null;
        WelcomeData.DataSource = LoadWelcome();
        WelcomeData.DataBind();
    }

    public void Welcome_Delete(object Sender, DataGridCommandEventArgs E)
    {
        DataSet dataSet = LoadWelcome();
        int row = (int)E.Item.ItemIndex;
        dataSet.Tables[0].Rows[row].Delete();
        dataSet.WriteXml(Server.MapPath("../App_Data/DefaultMsg.xml"));
        Session["MyWelcome"] = null;
        WelcomeData.EditItemIndex = -1;
        WelcomeData.DataSource = LoadWelcome();
        WelcomeData.DataBind();

        Session["error_msg"] = "The message was deleted successfully";
        Response.Redirect("AdminWelcomeMsg.aspx");
    }

    public void Welcome_Add(object Sender, EventArgs E)
    {
        DataSet dataSet = LoadWelcome();
        DataRow newRow;
        newRow = dataSet.Tables[0].NewRow();
        newRow["para"] = "";
        dataSet.Tables[0].Rows.Add(newRow);
        dataSet.WriteXml(Server.MapPath("../App_Data/DefaultMsg.xml"));
        Session["MyWelcome"] = null;
        WelcomeData.DataSource = LoadWelcome();
        WelcomeData.DataBind();
        WelcomeData.EditItemIndex = WelcomeData.Items.Count - 1;
        WelcomeData.DataSource = LoadWelcome();
        WelcomeData.DataBind();
    }

</script>
<div id="content">
    <div class="about">

<h2>Home Page Message</h2><hr />
        On this page you can add a message to the home page, update the 
        existing message or delete the message.<br /><br />
        <b><i><asp:Label ID="ErrorMessage" runat="server" ForeColor="Red" /></i></b><br /><br />
        <asp:LinkButton ID="LinkButton5" OnClick="Welcome_Add" Text="Add a welcome message" runat="server" /><br />

        <b><i><asp:Label ID="WelcomeMsg" runat="server" /></i></b><br />    

<asp:DataGrid ID="WelcomeData" AutoGenerateColumns="false" Width="100%" runat="server" 
 OnEditCommand="Welcome_Edit" OnUpdateCommand="Welcome_Update" OnCancelCommand="Welcome_Cancel" 
 OnDeleteCommand="Welcome_Delete">

<HeaderStyle ForeColor="White" BackColor="Maroon" Font-Bold="true" />
<ItemStyle BackColor="White" />
<AlternatingItemStyle BackColor="AntiqueWhite" />

<Columns>

<asp:TemplateColumn HeaderText="Welcome Msg">
    <ItemTemplate>
        <%# DataBinder.Eval(Container.DataItem, "para")%>
    </ItemTemplate>
    <EditItemTemplate>
        <asp:TextBox ID="txtpara" Size="25" Text='<%# DataBinder.Eval(Container.DataItem, "para")%>' runat="server"/>
        <asp:RequiredFieldValidator ID="RequiredFieldValidator1" ControlToValidate="txtpara" Font-Italic="true"
         Display="Dynamic" runat="server" ErrorMessage="(Required)" ForeColor="Red" ValidationGroup="Paras" />
    </EditItemTemplate>
</asp:TemplateColumn>

<asp:TemplateColumn>
    <ItemTemplate>
        <asp:LinkButton ID="LinkButton1" CommandName="Edit" Text="Edit" runat="server" ValidationGroup="Paras" />
        <asp:LinkButton ID="LinkButton2" CommandName="Delete" Text="Delete" runat="server" />
    </ItemTemplate>
    <EditItemTemplate>
        <asp:LinkButton ID="LinkButton3" CommandName="Cancel" Text="Cancel" runat="server"/>
        <asp:LinkButton ID="LinkButton4" CommandName="Update" Text="Update" runat="server" ValidationGroup="Paras" />
    </EditItemTemplate>
</asp:TemplateColumn>

</Columns>

</asp:DataGrid>

   </div>
        <img src="../App_Themes/theme/html/images/phone.jpg" alt="" width="953" height="87" /><br />
    </div>
</asp:Content>

**DefaultMsg.xml**
<?xml version="1.0" standalone="yes"?>
<welcome>
  <para>
    text text text
  </para>
  <para>
   text text text
 </para>
  <para>
    text text text
  </para>
  <para>
    text text text
  </para>
</welcome> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T23:44:51.197

我认为问题在于您缺少 XML 文件中的架构信息，这是设置列所必需的，您也许可以尝试更改该行：

```
dataSet.ReadXml(sourceXML); 
```

至：

```
dataSet.ReadXml(sourceXML, XmlReadMode.InferSchema); 
```

或添加 XML 模式信息。这里有更多关于 ReadXml 方法的信息：http: [//msdn.microsoft.com/en-us/library/system.data.dataset.readxml.aspx](http://msdn.microsoft.com/en-us/library/system.data.dataset.readxml.aspx)和这里[http://msdn.microsoft.com/en-us/库/system.data.xmlreadmode.aspx](http://msdn.microsoft.com/en-us/library/system.data.xmlreadmode.aspx)

# c# - LINQ Confusion - 应用程序关闭后数据库不持久？

> ID：790228
> 
> 赞同：3
> 
> 时间：2009-04-26T04:17:22.283
> 
> 标签：c#, sql-server, database, linq

我正在用 C# 制作一个 WinForms 应用程序。当我去创建我的数据库对象时，我看到了两个选项：

*   本地数据库
*   基于服务的数据库

我想要的只是一个用于我的项目的简单本地数据库。

但是，如果我选择“本地数据库（精简版）”，那么在创建表并将它们拖到 LINQ-To-SQL 类创建器之后，它会显示：

> 所选对象使用不受支持的数据提供程序。

所以，我不知道为什么在将表拖到对象关系设计器时，创建本地数据库会被视为不受支持的提供程序。

所以，我尝试了第二种类型，“基于服务的数据库”。我按照我想要的基本应用程序布置我的表格并制作我的表格。当我拖动这些表并继续在我的应用程序中编写代码以插入和更新数据库条目时，LINQ-To-SQL 设计器工作正常。

然而，有了这第二个“基于服务的数据库”，只要应用程序正在运行，我的插入和更新就可以工作。但是，一旦我关闭它，它就会恢复到以前的状态。如果我通过服务器资源管理器手动添加数据，它会持续存在，但我不会保存任何插入。

为什么我不能通过 LINQ 创建和使用本地数据库？

如果这不是一个选项，那么为什么“基于服务的数据库”（无论是什么）在应用程序关闭之后不存在？

谢谢你的时间！

* * *

编辑：显然 LINQ-To-SQL 对象设计器不适用于精简版本地数据库。它仍然可以完成，但是您显然必须使用 SqlMetal 来生成 dmbl 文件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-26T05:20:57.810

编译时，旧数据库被删除，新数据库被复制到 bin 文件夹中。因此尝试链接（使用 linq）到 bin 文件夹中的数据库。尝试更改您的连接字符串。

# c# - 如何使用 LINQ 匹配两个相同的数据库表？

> ID：790230
> 
> 赞同：4
> 
> 时间：2009-04-26T04:19:41.857
> 
> 标签：c#, sql, linq, linq-to-sql

我想匹配 2 个相同的表：

```
sourceProducts (productName, ProductionDate, ManID, shipper, distributer)
CommProducts   (productName, ProductionDate, ManID, shipper, distributer) 
```

但行数和记录内容可能不同。如何从一个表中选择某个记录 = raw 并从另一个表中获取其克隆记录（例如，检查是否存在相同的记录）？我如何使用 LinQ 做到这一点？

更新：这是 LINQ 代码：

```
 protected void checkBtn_Click(object sender, EventArgs e)
    {

        MyProductsDataContext mySdb = new MyProductsDataContext();

        Product   mypro = new Product  { ManId = int.Parse(TxtManI.Text), ProductName = TxtProN.Text, ProductionDate =DateTime .Parse ( TxtProDat.Text), Shipper = TxtShipI.Text, Distributer = TxtDistI.Text };

        var spro = (from p in mySdb.Products
                        select new { p.ManId, p.ProductName, p.ProductionDate, p.Shipper, p.Distributer }).
                        Intersect(from s in mySdb.SourceProducts  select new { s.ManId, s.ProductName, s.ProductionDate, s.Shipper, s.Distributer });

        if (spro != null)
        {
            LblMessage.Text = "Acceptable product Data Inserted Sucessfully";
            InsertData();
        }
        else
        {
            LblMessage.Text = "Invalid Product or bad Entry Please retype";
        }
   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-31T12:19:32.407

我会加入`ManId`，然后比较 where 子句中的其余值：

```
bool productExists = (
    from p in mySdb.Products
    join s in mySdb.SourceProducts
      on p.ManId equals s.ManId
    where p.ProductName == s.ProductName
       && p.ProductionDate == s.ProductionDate
       && p.Shipper == s.Shipper
       && p.Distributer = s.Distributer
    select new { p.ManId, p.ProductName, p.ProductionDate, p.Shipper, p.Distributer }
    ).Any();

if (productExists)
{
    LblMessage.Text = "Acceptable product Data Inserted Sucessfully";
    InsertData();
}
else
{
    LblMessage.Text = "Invalid Product or bad Entry Please retype";
} 
```

我曾经`Any()`生成一个高效的`EXISTS`SQL 查询。如果您确实需要使用退回的产品，您可以使用`SingleOrDefault()`or代替。`FirstOrDefault()`

我也看不到您正在使用新产品 ID 的任何地方 - 您可能还需要将该过滤器添加到查询中：

```
Product   mypro = new Product  { ... };

bool productExists = (
    from p in mySdb.Products
    where p.ManId equals mypro.ManId
    join s in mySdb.SourceProducts
      on p.ManId equals s.ManId
    ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-18T19:46:38.217

您可能可以使用连接来执行此操作，但我已经将一个单元测试拼凑在一起，它显示了一种方法

```
public class TestProduct
{
    public int ManId { get; set; }
    public string ProductName { get; set; }
    public DateTime ProductionDate { get; set; }
    public string Shipper { get; set; }
    public string Distributor { get; set; }
}

[TestMethod]
public void TestSourceTable()
{
    // Set up a test list
    var list = new List<TestProduct>();
    for (int i=0;i<5;i++)
    {
        var p = new TestProduct
            {
                Distributor = "D" + i,
                ManId = i,
                ProductionDate = DateTime.Now,
                ProductName = "P" + i,
                Shipper = "S" + i
            };
        list.Add(p);
    }

    // Get an existing product
    var existingProduct = list[4];

    // Get an unknown product
    var unknownProduct = new TestProduct()
        {
            ManId = -1,
            Distributor = "",
            ProductionDate = DateTime.Now.AddDays(-1),
            ProductName = "",
            Shipper = ""
        };

     // product found
     Assert.True(list.Any(p => p == existingProduct));

     // product not found
     Assert.False(list.Any(p => p == unknownProduct));
} 
```

# c# - C# SHA-1 与 PHP SHA-1 ...不同的结果？

> ID：790232
> 
> 赞同：38
> 
> 时间：2009-04-26T04:23:41.753
> 
> 标签：c#, php, cryptography, sha1, cryptographic-hash-function

我正在尝试从字符串计算 SHA-1 哈希，但是当我使用 php 的 sha1 函数计算字符串时，我得到的结果与我在 C# 中尝试时不同。我需要 C# 来计算与 PHP 相同的字符串（因为来自 php 的字符串是由我无法修改的第 3 方计算的）。如何让 C# 生成与 PHP 相同的哈希？谢谢！！！

字符串 = s934kladfklada@a.com

C# 代码（生成 d32954053ee93985f5c3ca2583145668bb7ade86）

```
 string encode = secretkey + email;
        UnicodeEncoding UE = new UnicodeEncoding();
        byte[] HashValue, MessageBytes = UE.GetBytes(encode);
        SHA1Managed SHhash = new SHA1Managed();
        string strHex = "";

        HashValue = SHhash.ComputeHash(MessageBytes);
        foreach(byte b in HashValue) {
            strHex += String.Format("{0:x2}", b);
        } 
```

PHP 代码（生成 a9410edeaf75222d7b576c1b23ca0a9af0dffa98）

```
sha1(); 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-04-26T04:38:43.400

使用 ASCIIEncoding 而不是 UnicodeEncoding。PHP 使用 ASCII 字符集进行哈希计算。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-20T12:34:19.720

.NET 中的这个方法相当于 php 中的 sha1：

```
string sha1Hash(string password)
{
    return string.Join("", SHA1CryptoServiceProvider.Create().ComputeHash(Encoding.UTF8.GetBytes(password)).Select(x => x.ToString("x2")));
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-02-24T11:15:26.557

我也有这个问题。以下代码将起作用。

```
string dataString = "string to hash";
SHA1 hash = SHA1CryptoServiceProvider.Create();
byte[] plainTextBytes = Encoding.ASCII.GetBytes(dataString);
byte[] hashBytes = hash.ComputeHash(plainTextBytes);
string localChecksum = BitConverter.ToString(hashBytes)
.Replace("-", "").ToLowerInvariant(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-05-18T12:37:31.460

有同样的问题。这段代码对我有用：

```
string encode = secretkey + email;
SHA1 sha1 = SHA1CryptoServiceProvider.Create();
byte[] encodeBytes = Encoding.ASCII.GetBytes(encode);
byte[] encodeHashedBytes = sha1.ComputeHash(passwordBytes);
string pencodeHashed = BitConverter.
ToString(encode HashedBytes).Replace("-", "").ToLowerInvariant(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-02-17T15:07:13.087

FWIW，我在 Java 中遇到了类似的问题。事实证明，我必须使用“UTF-8”编码在 Java 中`sha1`生成与 PHP 5.3.1（在 XAMPP Vista 上运行）中生成的函数相同的 SHA1 哈希值。

```
 private static String SHA1(final String text) throws NoSuchAlgorithmException, UnsupportedEncodingException {
        final MessageDigest md = MessageDigest.getInstance("SHA-1");
        md.update(text.getBytes("UTF-8"));
        return new String(org.apache.commons.codec.binary.Hex.encodeHex(md.digest()));
    } 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-02-21T11:54:50.300

试试以下！我认为它会很好用：

```
public static string SHA1Encodeb64(string toEncrypt)
    {
        //Produce an array of bytes which is the SHA1 hash
        byte[] sha1Signature = new byte[40];

        byte[] sha = System.Text.Encoding.Default.GetBytes(toEncrypt);
        SHA1 sha1 = SHA1Managed.Create();
        sha1Signature = sha1.ComputeHash(sha);

        /**
        * The BASE64 encoding standard's 6-bit alphabet, from RFC 1521,
        * plus the padding character at the end.
        */
        char[] Base64Chars = {
            'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H',
            'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P',
            'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X',
            'Y', 'Z', 'a', 'b', 'c', 'd', 'e', 'f',
            'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n',
            'o', 'p', 'q', 'r', 's', 't', 'u', 'v',
            'w', 'x', 'y', 'z', '0', '1', '2', '3',
            '4', '5', '6', '7', '8', '9', '+', '/',
            '='
            };
        //Algorithm to encode the SHA1 hash using Base64
        StringBuilder sb = new StringBuilder();
        int len = sha1Signature.Length;
        int i = 0;
        int ival;
        while (len >= 3)
        {
            ival = ((int)sha1Signature[i++] + 256) & 0xff;
            ival <<= 8;
            ival += ((int)sha1Signature[i++] + 256) & 0xff;
            ival <<= 8;
            ival += ((int)sha1Signature[i++] + 256) & 0xff;
            len -= 3;
            sb.Append(Base64Chars[(ival >> 18) & 63]);
            sb.Append(Base64Chars[(ival >> 12) & 63]);
            sb.Append(Base64Chars[(ival >> 6) & 63]);
            sb.Append(Base64Chars[ival & 63]);
        }
        switch (len)
        {
            case 0: // No pads needed.
                break;
            case 1: // Two more output bytes and two pads.
                ival = ((int)sha1Signature[i++] + 256) & 0xff;
                ival <<= 16;
                sb.Append(Base64Chars[(ival >> 18) & 63]);
                sb.Append(Base64Chars[(ival >> 12) & 63]);
                sb.Append(Base64Chars[64]);
                sb.Append(Base64Chars[64]);
                break;
            case 2: // Three more output bytes and one pad.
                ival = ((int)sha1Signature[i++] + 256) & 0xff;
                ival <<= 8;
                ival += ((int)sha1Signature[i] + 256) & 0xff;
                ival <<= 8;
                sb.Append(Base64Chars[(ival >> 18) & 63]);
                sb.Append(Base64Chars[(ival >> 12) & 63]);
                sb.Append(Base64Chars[(ival >> 6) & 63]);
                sb.Append(Base64Chars[64]);
                break;
        }
        //Encode the signature using Base64
        string base64Sha1Signature = sb.ToString();
        return base64Sha1Signature;
    } 
```

# c# - 如何通过 C# 在 GPO 中创建 WMI 过滤器

> ID：790233
> 
> 赞同：3
> 
> 时间：2009-04-26T04:27:31.820
> 
> 标签：c#, wmi

我正在尝试通过 C# 代码使用 GPMC COM 对象以编程方式创建 GPO。我可以创建 GPO，但在将 WMI 过滤器“插入”到 GPO 时遇到问题。有谁知道我如何为 GPO 创建/更新 WMI 过滤器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T05:38:33.897

这是示例代码：

```
GPMGMTLib.GPM gPM = new GPMGMTLib.GPM(); 
GPMConstants gPMConstants = gPM.GetConstants(); 
GPMDomain gPMDomain = gPM.GetDomain(domainName, DC, gPMConstants.UseAnyDC); 
GPMGPO obj = gPMDomain.CreateGPO(); 
obj.DisplayName = "New GPO";

//replace with the appropiate GUID
var strWMIFilterID = "{D715559A-7965-45A6-864D-AEBDD9934415}";
var sWMIFilter = string.Format("MSFT_SomFilter.Domain=\"{0}\",ID=\"{1}\"", domainName, strWMIFilterID);

var oWMIFilter = gPMDomain.GetWMIFilter(sWMIFilter); 
obj.SetWMIFilter(oWMIFilter); 
```

**以下是一些包含其他信息的链接：**
[WMIFilters](http://grouppolicy.editme.com/WMIFilters)
[Active Directory Cookbook](http://searchwinit.techtarget.com/searchWin2000/downloads/adcookbook_ch09.pdf)

# c# - c# 自定义卸载程序

> ID：790235
> 
> 赞同：1
> 
> 时间：2009-04-26T04:29:35.500
> 
> 标签：c#, installation, uninstallation

我正在尝试编写自定义卸载程序脚本；但是，我被困在“程序和功能”对话框中。是否有任何书面文档说明我需要添加哪些注册表项才能在此处显示我的应用程序？或者 - 或者 - 是否有任何本机 WINAPI / .NET 函数可以直接在那里创建快捷方式？

附录：有业务要求不允许我使用第三方工具，例如默认的 MSI 安装程序。提供的答案应该可以在安装了 .NET 2.0 的干净 XP 虚拟机上运行，​​无需引用任何外部 .dll。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T04:35:54.377

我想 MSI 安装程序是最好的解决方案，但如果必须，作为添加/删除程序对话框中项目来源的注册表项在这里：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall 
```

我不知道是否有关于这个键的结构的好文档，但我相信你可以弄清楚，这并不难

# c++ - 获取文件版本信息失败——但不适合我

> ID：790239
> 
> 赞同：0
> 
> 时间：2009-04-26T04:35:07.857
> 
> 标签：c++, winapi, version

我正在尝试从文件中获取版本信息。我的代码非常适合我，但在其他几台机器上却失败了。因为我无法重现该错误，所以我花了很长时间才找到问题。

有没有人认为这有什么大问题？

```
LPBYTE versionInformationBlock;
struct LANGANDCODEPAGE {
    WORD wLanguage;
    WORD wCodePage;
} *langBlockPointer;
UINT translationsCount;

void fileData::enumVersionInformationBlock()
{
    bits.set(VERSIONINFOCHECKED);
    disable64.disableFS(); //Shut down WOW64
    DWORD zero = 0;
    DWORD lengthOfVersionData =
    GetFileVersionInfoSize(getFileName().c_str(),&zero);
    if (!lengthOfVersionData)
    {
        disable64.enableFS();
        return;
    }
    versionInformationBlock = new BYTE[lengthOfVersionData];
    GetFileVersionInfo(getFileName().c_str(),zero,lengthOfVersionData,versionInformationBlock);
    VerQueryValue(versionInformationBlock,L"\\VarFileInfo\\Translation",(LPVOID*)&langBlockPointer,&translationsCount);
    translationsCount /= sizeof(struct LANGANDCODEPAGE);
    disable64.enableFS();
}
std::wstring fileData::getVersionInformationString(const std::wstring& str)
{
    if (!bits[VERSIONINFOCHECKED])
        enumVersionInformationBlock();
    if (!versionInformationBlock)
        return L"!VERINFO: NOT PE FILE!";
    LPCTSTR retString;
    UINT retStringLength;
    std::wstring result;
    static const wchar_t hexChars[] = L"0123456789ABCDEF";
    wchar_t hexLanguage[26] = L"\\StringFileInfo\\        \\";
    for( size_t idx = 0; idx < translationsCount; idx++ )
    {
        hexLanguage[16] = *(hexChars + ((langBlockPointer[idx].wLanguage >> 12) & 0x0F));
        hexLanguage[17] = *(hexChars + ((langBlockPointer[idx].wLanguage >> 8 ) & 0x0F));
        hexLanguage[18] = *(hexChars + ((langBlockPointer[idx].wLanguage >> 4 ) & 0x0F));
        hexLanguage[19] = *(hexChars + ( langBlockPointer[idx].wLanguage        & 0x0F));
        hexLanguage[20] = *(hexChars + ((langBlockPointer[idx].wCodePage >> 12) & 0x0F));
        hexLanguage[21] = *(hexChars + ((langBlockPointer[idx].wCodePage >> 8 ) & 0x0F));
        hexLanguage[22] = *(hexChars + ((langBlockPointer[idx].wCodePage >> 4 ) & 0x0F));
        hexLanguage[23] = *(hexChars + ( langBlockPointer[idx].wCodePage        & 0x0F));
        std::wstring targetResource(hexLanguage,25);
        targetResource.append(str);
        if (!VerQueryValue(versionInformationBlock,targetResource.c_str(),(LPVOID *)&retString,&retStringLength))
        {
            return std::wstring(L"!DOESN'T APPER TO EXIST IN FILE! ERROR: ").append(boost::lexical_cast<std::wstring>(GetLastError()));
        }
        retStringLength--;
        if (!result.empty())
            result.append(L" / ");
        std::wstring toAppend;
        toAppend.assign(retString,retStringLength);
        boost::algorithm::trim(toAppend);
        result.append(toAppend);
    }
    return result;
}
std::wstring fileData::getVerCompany()
{
    return getVersionInformationString(L"CompanyName");
}
~fileData()
{
    if (versionInformationBlock)
        delete [] versionInformationBlock;
}; 
```

真正困扰我的是它没有抛出我的任何错误消息......它一直在返回垃圾。

有任何想法吗？

比利3

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-26T04:49:09.680

尝试以下操作：

*   `GetFileVersion`通过使用检索 's 失败的原因`GetLastError`
*   告诉我们它在什么操作系统上运行，在什么操作系统上不运行
*   检查是否`GetFileVersionInfo`成功（再次`GetLastError`）
*   反复阅读上述功能的 MSDN 文档的**备注**部分，并检查您是否没有遗漏任何内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-26T04:44:57.770

看起来您没有检查您正在使用的许多系统调用的错误。例如，`GetFileVersionInfo`如果获取数据时出错，将返回零，此时您可以调用`GetLastError`以找出具体的故障是什么。同样，`GetFileVersionInfoSize`如果有错误，将返回零。看起来您检查了该故障，但不费心记录系统错误代码（再次，用于`GetLastError`检索该值）。

我建议您为正在使用的系统调用添加错误处理代码。其中一个很可能失败了，并且可能会留下一个非常有意义的错误代码供您使用`GetLastError`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T03:35:38.820

非易失性。如果没有回答，似乎 Stackoverflow 会让我大吃一惊.....

比利3

# search - StackOverflow 是否使用 Lucene 进行标记搜索？

> ID：790240
> 
> 赞同：0
> 
> 时间：2009-04-26T04:35:13.817
> 
> 标签：search, lucene, tags, tagging

SO是如何实现标记搜索的？是否使用 Lucene 或任何其他开源搜索引擎库进行标记搜索？

搜索文档（PDF、XML、HTML、MS Word）或数据库的最佳方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-01-14T02:47:24.467

搜索标签与搜索文本有很大不同。标记搜索正在搜索所有问题都与特定标记相关联的关联。这可以通过全文引擎实现，其中所有标签都附加在一个大条目中，但在这种情况下，关系数据库可能是最好的（假设标记的数据一开始就在关系数据库中）。

要搜索 PDF、XLS、HTML 等其他文档，则需要 Lucene 等全文。您将需要一个解析器，它可以仅从每个源中提取相关文本（即，将文本与标记分开）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T05:21:13.003

所以，是的，它使用的是 Lucene.NET，尽管我不确定具体如何。“最好的”方式是一个完整的“另一个故事”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-14T02:54:08.853

上次讨论这个问题时（在播客上）提到 Stackoverflow 使用 SQL Server 的全文搜索功能，而不是 Lucene。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-14T02:59:43.857

所以不使用Lucene。

如果您想要索引文档并且正在运行 Windows，那么[IFilters](http://www.codeproject.com/KB/cs/IFilter.aspx)将是我的首选。

# mysql - 如何将端口添加到mysql服务器

> ID：790242
> 
> 赞同：3
> 
> 时间：2009-04-26T04:36:25.543
> 
> 标签：mysql, tcp

我想向 MySql 添加另一个 tcp 端口，我可以从我的应用程序连接到该端口

我有我的应用程序的副本，并且我在同一台机器上运行它们。它们都连接到在同一台机器上运行的 MySql 服务器。问题是默认端口 3306 已经被占用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-26T08:31:20.427

你不能绑定 mysqld 来监听多个端口。实现此目的的唯一方法是使用内部路由规则，将目标端口转发到 3306。

如果你在 linux 上，你可以使用 iptables 来实现。iptables 是一个通常为系统管理员保留的乐趣。

您的应用程序的两个副本无法连接到同一个端口 3306 是否有原因？通常，您应该能够连接任意数量的客户端。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-06-16T00:28:55.330

你可以这样做：

```
iptables -t nat -A PREROUTING -i eth0 -p tcp --dport 9005 -j REDIRECT --to-port 9000 
```

其中 eth0 是您的网络开发，9005 是您的“源端口”，而 9000 是您的服务运行的端口。哦，该示例仅适用于 TCP 协议。

[您可以在此处](http://www.cyberciti.biz/faq/linux-port-redirection-with-iptables/)找到有关端口重定向的更多示例 。Linux 的有用站点，顺便说一句。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T07:03:25.393

单个 mysql 实例可以托管多个数据库。因此，您的另一种选择是，每个应用程序都连接到在端口 3306 上运行的同一个 mysql 实例，但每个应用程序都使用不同的数据库名称。

# xml - 这个 XML 最简单/最清晰的 XSD 是什么？

> ID：790248
> 
> 赞同：0
> 
> 时间：2009-04-26T04:44:41.797
> 
> 标签：xml, xsd, grammar

对于这种 XML，最简单/最清晰的 XSD 样式是什么？（来自[这个答案](https://stackoverflow.com/questions/784767/xml-schema-for-class-containing-a-datatable/786688#786688)）

```
<object name="contact">
  <object name="home">
    <object name="tel">
       <string name="area" value="910"/>
       <string name="num" value="1234 5678"/>
    </object>
  </object>
  <object name="work">
    <object name="tel">
       <string name="area" value="701"/>
       <string name="num" value="8888 8888"/>
    </object>
    <object name="fax">
       <string name="area" value="701"/>
       <string name="num" value="9999 9999"/>
    </object>
  </object>
</object> 
```

*编辑*我将我的示例 XSD 和说明移到了答案中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T05:04:57.427

如果您的数据不是完全免费的格式，我会让 XML 特定于您的数据模型：

```
<contact>
  <home>
    <tel>
       <area>910</area>
       <num>1234 5678</num>
    </tel>
  </home>
  <work>
    <tel>
       <area>701</area>
       <num>8888 8888</num>
    </tel>
    <fax>
       <area>701</area>
       <num>9999 9999</num>
    </fax>
  </work>
</contact> 
```

但是，假设您有理由按照您的方式进行操作（例如，假设您的数据确实是完全自由格式的结构化数据），您可以通过执行类似的操作使 XSD 更清晰一点这：

```
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="object">
    <xs:complexType>
      <xs:choice minOccurs="0" maxOccurs="unbounded">
        <xs:element ref="string"/>
        <xs:element ref="object"/>
      </xs:choice>
      <xs:attribute name="name" type="xs:string"/>
    </xs:complexType>
  </xs:element>

  <xs:element name="string">
    <xs:complexType>
      <xs:attribute name="name" type="xs:string"/>
      <xs:attribute name="value" type="xs:string"/>
    </xs:complexType>
  </xs:element>
</xs:schema> 
```

我更喜欢每个`element`都以独立方式定义的模式——尽可能多地——并且在多个地方使用的任何类型也被单独定义。在您的情况下，没有重用类型。

当 XSD 嵌套很深时，它会变得更难阅读，也更难支持和修改。

注意：您可以通过进行以下更改使对象名称可选：

```
 <xs:element name="object">
    <xs:complexType>
      <xs:choice minOccurs="0" maxOccurs="unbounded">
        <xs:element ref="string"/>
        <xs:element ref="object"/>
      </xs:choice>
      <xs:attribute name="name" type="xs:string" use="optional"/>
    </xs:complexType>
  </xs:element> 
```

但也不要将字符串类型上的名称设为可选！（至少从您向我们展示的内容来看，这样做没有意义。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T06:42:17.823

这是一个 XSD - 它的语法是最清晰的方法吗？

```
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="object">
    <xs:complexType>
      <xs:choice minOccurs="0" maxOccurs="unbounded">

        <xs:element name="string">
          <xs:complexType>
            <xs:attribute name="name" type="xs:string"/>
            <xs:attribute name="value" type="xs:string"/>
          </xs:complexType>
        </xs:element>

        <xs:element ref="object"/>

      </xs:choice>
      <xs:attribute name="name" type="xs:string"/>
    </xs:complexType>
  </xs:element>

</xs:schema> 
```

XML 的基本思想是嵌套对象：

```
V --> string | O      // a Value is a string or an Object
O --> (K V)*          // an Object is list of named values (Key-Value pairs) 
```

但它略有不同，因为根始终是一个对象（而不是字符串），并且它本身被命名（即使它不在另一个对象内）：

```
O ==> (string K | O)* K 
```

我愿意稍微更改格式本身，以提供不同的 XML，如果这会使 XSD 更简单/更清晰。如果一个对象总是有一个名称，这将删除特殊情况，这使得语法和 XSD 更规则 - 更简单。因此，一个对象总是有一个名字似乎更简单。

*澄清*：特殊情况是当 Object 是根时它没有被命名，但在所有其他情况下它被命名。这需要一个额外的标题部分，如下所示：

```
O'==> (string K | O)*
O ==> (string K | O)* K 
```

处理这种特殊情况比原始情况更复杂，即使经过重构以最小化这种复杂性：

```
F ==> (string K | O)*
O ==> F K 
```

# java - JSP/HTML 页面到 PDF 的转换

> ID：790256
> 
> 赞同：3
> 
> 时间：2009-04-26T04:50:13.577
> 
> 标签：java, html, jsp, pdf

如何从我的 JSP/HTML 文件转换为 PDF？

我想将网页的特定部分转换为 PDF 文件。是否可以？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-26T05:00:10.463

是的。好好看看展位[Apache FOP](http://xmlgraphics.apache.org/fop/)和[iText](http://www.lowagie.com/iText/)。无论您使用什么，您可能都需要做一些摆弄。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T21:12:20.377

几年前我使用了[HTMLDoc](https://www.msweet.org/projects.php?Z1)，并且很幸运。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T21:02:48.340

试试[wkhtmltopdf](http://code.google.com/p/wkhtmltopdf/)。它是一个命令行实用程序，可以提供 html 文件或网址以及 pdf 的保存位置。非常易于使用，并使用与 safari 相同的渲染引擎。比我使用过的许多其他解析器好得多（它们并不总是支持 CSS 和其他高级布局功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-26T10:21:53.763

看看[html2ps (Perl)](http://user.it.uu.se/~jan/html2ps.html)或[html2ps (PHP)](http://www.tufat.com/s_html2ps_html2pdf.htm "PHP")。但是，这两者都没有在 Java 中实现。

您可能还想阅读[这篇文章](http://www.javaworld.com/javaworld/jw-04-2006/jw-0410-html.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-13T13:35:50.443

飞碟库是最好用的。它在 itext 之上工作，使转换任务变得非常容易。

# sql - SQL：对 INSERT 和 UPDATE 使用相同的字符串？

> ID：790257
> 
> 赞同：3
> 
> 时间：2009-04-26T04:50:18.193
> 
> 标签：sql, insert, sql-update

我一直在使用的 INSERT 语法是这样的

```
INSERT INTO TableName VALUES (...) 
```

我一直在使用的 UPDATE 语法是

```
UPDATE TableName SET ColumnName=Value WHERE ... 
```

所以在我的所有代码中，我必须生成 2 个字符串，这将导致类似这样的结果

```
insertStr = "(27, 'John Brown', 102)";
updateStr = "ID=27, Name='John Brown', ItemID=102"; 
```

然后分别使用它们

```
"UPDATE TableName SET " + updateStr + " WHERE ID=27 " +
"IF @@ROWCOUNT=0 "+
"INSERT INTO TableName VALUES (" + insertStr + ")" 
```

当我使用具有 30 列的表格时，它开始困扰我。

我们不能只生成一个用于 INSERT 和 UPDATE 的字符串吗？

例如。在 UPDATE 语句上使用上面的 insertStr 或在 INSERT 语句上使用 updateStr ，还是一种全新的方式？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-26T05:01:01.163

我认为你需要一种全新的方法。您对**[SQL 注入持](http://en.wikipedia.org/wiki/SQL_injection)**开放态度。向我们提供一些示例代码，了解您如何获取数据输入并将语句发送到数据库。 [替代文字 http://goose.ycp.edu/~weddins/440/S09%20IFS440%20Bobby%20Drop%20Tables.PNG](http://goose.ycp.edu/~weddins/440/S09%20IFS440%20Bobby%20Drop%20Tables.PNG)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-26T05:05:50.433

据我所知，您所描述的内容在 ANSI SQL 或我所知道的任何扩展中是不可能的。但是，我最熟悉 MySQL，它可能完全取决于您使用的 RDBMS。例如，MySQL 具有“INSERT ... ON DUPLICATE KEY UPDATE ...”语法，这与您在此处发布的类似，并将 INSERT 查询与 UPDATE 查询结合在一起。好处是您将两个可能的操作组合到一个查询中，但是，查询的 INSERT 和 UPDATE 部分无疑是不同的。

一般来说，这类事情可以通过应用程序中的 ORM 层抽象出来。就原始 SQL 而言，我会对按照您描述的方式工作的任何语法感兴趣。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-26T05:08:44.250

好吧，没有声明怎么办？你可能想研究一个 ORM 来为你处理这个......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-26T05:45:53.833

一些 DBMS 有一个扩展来做到这一点，但你为什么不提供一个功能来为你做这件事呢？我们以前实际上已经这样做过。

我不确定您使用的是什么语言，但它可能有关联数组，您可以在其中编写如下内容：

```
pk{"ID"}   = "27"
val{"Name"} = "'John Brown'"
val{"ItemID"} = "102"
upsert ("MyTable", pk, val) 
```

并且，如果它没有关联数组，您可以使用多个基于整数的字符串数组来模拟它们。

在我们的`upsert()`函数中，我们只是构造了一个字符串 ( `update`, then `insert`if the `update`failed) 并将其传递给我们的 DBMS。我们将主键与其他字段分开，因为这使得更新语句的构造变得更加容易（主键列在 where 子句中，其他列只是设置）。

上述调用的结果将导致以下 SQL（我们对失败进行了不同的检查，`update`但我已将您`@@rowcount`用于此示例）：

```
update MyTable set
    Name = 'John Brown',
    ItemID = 102
    where ID = 27
if @@rowcount=0
    insert into MyTable (ID, Name, ItemID) values (
        27,
        'John Brown',
        102
    ) 
```

这是一种对我们很有效的解决方案。毫无疑问还有其他人。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-26T05:03:32.420

一些数据库有专门做这个的扩展。

我同意 INSERT 和 UPDATE 的语法可以更加一致，但这只是现在的现实——它现在不会改变。对于许多场景，最好的选择是您的“全新方式”：使用对象关系映射库（甚至是像 .NET DataSets 这样的弱茶层）来抽象出差异，而不必担心低级 SQL句法。当然，对于每个应用程序来说，这不是一个可行的选择，但它只允许您构造或更新对象、调用 Save 方法并让库为您找出 SQL 语法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-26T05:36:10.143

如果你仔细想想，INSERT 和 UPDATE 是完全一样的。它们将字段名称映射到值，但 UPDATE 具有过滤器。通过创建一个关联数组，其中键是字段名称，值是您要分配给该字段的值，您就有了映射。您只需根据 INSERT 或 UPDATE 将其转换为正确的字符串格式。您只需要创建一个函数来根据给定的参数处理转换。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-26T07:12:43.720

SQL Server 2008：

```
MERGE dbo.MyTable AS T
USING
 (SELECT  
  @mykey AS MyKey
  @myval AS MyVal
  ) AS S

ON (T.MyKey = S.MyKey)

WHEN MATCHED THEN 
  UPDATE  SET 
    T.MyVal = S.MyVal
WHEN NOT MATCHED THEN
  INSERT (MyKey, MyVal)
  VALUES (S.MyKey, S.MyVal) 
```

MySQL：

```
INSERT (MyKey, MyVal)
INTO MyTable
VALUES({$myKey}, {$myVal})
ON DUPLICATE KEY UPDATE myVal = {$myVal} 
```

# silverlight - 如何在 Silverlight 中将资源字符串绑定到 Xaml

> ID：790259
> 
> 赞同：3
> 
> 时间：2009-04-26T04:53:42.587
> 
> 标签：silverlight, data-binding, xaml

如何在 Silverlight 中将资源字符串绑定到 Xaml？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-26T07:46:56.477

您需要将此引用添加到 App.xaml

```
xmlns:sys="clr-namespace:System;assembly=mscorlib" 
```

然后您需要将字符串添加到该`<Application.Resources>`部分

```
<sys:String x:Key="ResourceString">Resource String</clr:String> 
```

然后你需要做的就是参考 *{StaticResource ResourceString} 例如：

```
<TextBlock Text="{StaticResource ResourceString}"></TextBlock> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-08-15T14:06:34.357

自从有人提出并回答了这个问题已经有一段时间了，我只想添加一个额外的答案，因为第一个答案并不完全正确。我认为他是在寻求资源，也就是。用 .resx 文件编写的文本。将单个字符串添加到应用程序的 StaticResources 集合中根本没有意义。

我最近写了一篇关于如何简化在 Silverlight 中使用资源的方式的博客，在文化变化时启用自动更新，并提供一个可以让您使用更简单语法的依赖属性。

[http://sondreb.com/blog/post/Simplifying-Text-Resources-in-Silverlight.aspx](http://sondreb.com/blog/post/Simplifying-Text-Resources-in-Silverlight.aspx)

# jquery - 我需要 jQuery 中 $(this) 上下文的帮助

> ID：790270
> 
> 赞同：1
> 
> 时间：2009-04-26T05:06:13.977
> 
> 标签：jquery

我在这个代码块中需要一些帮助：

```
options.imgs.click(function() {
            var allImgs = $("#big img");
            $("#big img").each(function(n) {
                this.index = n;
            })
            animateImage(allImgs);
        })

    };

    function animateImage(images) {
        for(var i = 0; i < images.length; i++) {
            if (images[i].index == 0) {
                alert($(this).index)
            }
        }
    } 
```

我的问题是：

```
$(this).effect('scale', { percent: 200 }, 1000) 
```

不工作。我希望该语句引用索引为 0 的图像，并将其缩放 200%。但`$(this)`根本不是指第一张图片。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T05:14:58.557

一旦你调用你的函数，你的“ *this* ”变量就会改变：

```
function test() {
  alert(this); // this will be the window object
}
$('p b').click(function() {
   alert(this); // this will be the bold element object
   test();
}); 
```

例如，在这个页面上运行这个（使用萤火虫），我可以点击顶部右侧的“询问”和“查看”项目（它们是粗体的）......你得到的是来自的警报测试函数，其中*this*是窗口对象，**而不是**事件处理程序中的粗体元素。

要解决此问题，只需通过函数传递您想要处理的对象：

```
options.imgs.click(function() {
            var allImgs = $("#big img");
            $("#big img").each(function(n) {
                    this.index = n;
            })
            animateImage(allImgs, this);
    })

};

function animateImage(images, img) {
    for(var i = 0; i < images.length; i++) {
            if (images[i].index == 0) {
                    alert($(img).index)
            }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T06:13:40.130

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T06:26:22.690

当您在点击调用中时，第一个参数（“this”）是您点击的 DOM 元素。您的 DOM 元素是否具有“索引”属性？

我还建议您使用“对象转储”功能（此处为示例：[http](http://weblogs.asp.net/skillet/archive/2006/03/23/440940.aspx) ://weblogs.asp.net/skillet/archive/2006/03/23/440940.aspx ）。用法与此类似：

```
$("a").click( function(){ 
   alert( object_dump( this ) ) 
}); 
```

（注意 object_dump() 函数返回一个字符串，您需要“alert()”它或用它做其他事情）。

# c# - ReSharper 抱怨方法可以是静态的，但不是

> ID：790281
> 
> 赞同：68
> 
> 时间：2009-04-26T05:21:23.487
> 
> 标签：c#, resharper, static-methods

为什么 ReSharper 在方法可以变为静态时会抱怨，但不是？

是因为只创建了一个静态方法的实例（在类型上），从而节省了性能吗？

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2009-04-26T05:54:34.890

我发现该评论非常有用，因为它指出了两件重要的事情：

1.  这让我问自己，所讨论的方法是否实际上应该是类型的一部分。由于它不使用任何实例数据，您至少应该考虑是否可以将其移动到自己的类型。它是类型的一个组成部分，还是真的是一种通用的实用方法？

2.  如果将方法保留在特定类型上确实有意义，那么由于编译器将为静态方法发出不同的代码，因此可能会提高性能。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-04-26T05:26:12.070

来自相同警告的 FxCop 文档（已添加重点）：

“不访问实例数据或调用实例方法的成员可以标记为静态（在 Visual Basic 中为共享）。将方法标记为静态后，编译器将向这些成员发出非虚拟调用站点。发出非虚拟调用站点将阻止在运行时对每个调用进行检查，以确保当前对象指针不为空。*这可以为性能敏感的代码带来可衡量的性能提升。在某些情况下，无法访问当前对象实例表示正确性问题。* ”

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-27T02:01:15.813

[关于这个主题的很好的辩论（SO）](https://stackoverflow.com/questions/169378/c-method-can-be-made-static-but-should-it)。我在 if-it-can-be-made-static-make-it-static 的阵营中。我之所以相信这一点，是因为为什么会有一个不使用任何实例数据的实例方法。在这种情况下它真的是一个实例方法还是实际上是一个类方法？

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-26T05:23:34.807

如果该方法被声明为静态，则不需要创建类的（零）个实例来使用该方法……这样可以节省垃圾收集器从堆...

另外，你的问题，正如它所写

“ ...仅创建一个静态方法的实例（在类型上）...”

意味着对于实例方法，该方法的代码会为所创建的类的每个实例重复。那不是真的。无论您为任何类型创建多少实例，方法的代码都只会加载到内存中一次。每个实例存储在堆上的对象仅存储类型的“状态”（非静态字段和一些杂项跟踪变量）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-26T05:24:01.997

这不是抱怨，只是建议。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-26T05:23:28.067

对于静态方法，您不必将“this”推送到函数的堆栈中。这是它更便宜的另一个原因。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-27T01:54:35.503

对我来说，这个 ReSharper 建议的最大好处是（您可以将其设置为警告、建议或提示）。是不是它鼓励我使尽可能多的方法成为静态的。这是一件好事，因为静态方法与它所属的类没有直接依赖关系。这意味着它可以很容易地作为静态成员移动到另一个类。

ReSharper 中使用静态的另一个巧妙技巧是使用“Make Method Static”重构将一组相关方法设为静态。这会将一些依赖项移动到方法参数中。当您稍后查看这组方法时，您可能会发现它们都访问特定类型的特定对象。然后，您可以使用“Make method non-static”重构，并将该对象指定为新的*this*指针。这会将您的方法移动到另一个类中。

由此：

```
internal class ClassA
{
    public ClassB Property { get; set; }

    public int Method()
    {
        var classB = Property;
        return classB.Property1 + classB.Property2;
    }
}

internal class ClassB
{
    public int Property1 { get; set; }
    public int Property2 { get; set; }
} 
```

对此：

```
 public static int Method(ClassB property)
    {
        var classB = property;
        return classB.Property1 + classB.Property2;
    } 
```

对此：

```
internal class ClassA
{
    public ClassB Property { get; set; }
}

internal class ClassB
{
    public int Property1 { get; set; }
    public int Property2 { get; set; }

    public int Method()
    {
        return Property1 + Property2;
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-02-10T11:38:12.740

静态在第一次使用时被实例化，并将保留在内存中。如果它不再使用，它​​可能是一个问题。静态更难测试（moke 等......）。

# php - 虚拟 PHP 表单

> ID：790291
> 
> 赞同：2
> 
> 时间：2009-04-26T05:32:23.397
> 
> 标签：php, forms, post

我有一个吐出表格的 PHP 文件。我想在服务器端调用这个 PHP 文件（目前使用“include”），填写并提交。

这更好，所以我不必干预实际的 PHP 表单，只需处理表示层，以便数据被它自己的 PHP 文件理解。

这可能吗？“方法”的形式是 POST。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-26T05:45:10.810

您将无法填写表格并使用`include()`. 提交表单意味着它必须通过 HTTP 到 Web 服务器，因此您正在寻找的是模拟 POST 请求。PHP 有一个名为 CURL 的流行库来执行此操作。

尝试这样的事情：

```
$ch = curl_init('http://www.example.com/yourform.php');
curl_setopt($ch, CURLOPT_HEADER, 0);
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, 'var1=value1&var2=value2&whatever=stuff');
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
$output = curl_exec($ch); 
```

`$output`将包含页面输出，就像您刚刚提交表单一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T05:35:35.887

所以你想给自己提交一个表格？听起来 CURL 将是这样做的方法，但您将创建另一个 HTTP 会话。否则，您可以模拟 POST 变量并从外部脚本调用表单的操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T06:38:20.603

根据您的评论，听起来您正在尝试在当前请求中模拟此表单的提交。我不确定您是否可以使用 cURL 执行此操作 - 我认为您的 PHP 脚本的每次调用都是独立执行的，因此当前脚本运行的全局变量不会被处理 cURL 请求的运行共享。

我处理这个问题的方法是创建一个函数来处理表单提交：

```
function handle_form($postdata) {
    // whatever you would normally do, just replace $_POST with $postdata
}

// to handle a normal form submission:
handle_form($_POST); 
```

这样，您可以通过创建一个包含表单字段值的数组来模拟表单的提交：

```
$formvals['fieldname1'] = 'fieldvalue1';
$formvals['fieldname2'] = 'fieldvalue2'; 
```

并打电话

```
handle_form($formvals); 
```

# ruby-on-rails - Facebooker：在 fb_user_action 之后重定向

> ID：790293
> 
> 赞同：0
> 
> 时间：2009-04-26T05:32:57.373
> 
> 标签：ruby-on-rails, facebook

我正在尝试使用 Facebooker 将故事发布到 Facebook。当用户在我的网站上提交表单时，我使用[fb_user_action](http://facebooker.rubyforge.org/classes/Facebooker/Rails/Helpers/FbConnect.html#M000143)显示对话框，询问是否可以发布故事。当它被解雇时，我想重定向到不同的页面。

Facebook 的[showFeedDialog 文档](http://wiki.developers.facebook.com/index.php/Facebook.showFeedDialog)讨论了 continuation 参数。它需要一个 JavaScript 函数，该函数将在对话框关闭后调用。我无法调用该函数。

```
<script language="javascript">
var continuation = function () {
  location.href = 'http://target-url.com';
}
</script>

<% init_fb_connect "XFBML","Api" do %>
  <%= fb_user_action(@action, @message, @prompt, 'continuation') %>
<% end %> 
```

除了没有调用延续函数外，一切都运行良好。对于我做错了什么有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T17:45:04.697

我只是更深入地研究了这一点。我相信这是 Facebooker 的错误。我必须将回调参数包装在 page.literal 调用中。修改后的方法如下：

```
def fb_user_action(action, user_message = "", prompt = "", callback = nil)
  update_page do |page|
    page.call "FB.Connect.showFeedDialog",action.template_id,action.data,action.target_ids,action.body_general,nil,page.literal("FB.RequireConnect.promptConnect"),page.literal(callback),prompt,user_message
  end
end 
```

我将跟进 Facebooker 开发人员，尝试在未来的版本中修复此问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T06:24:13.930

好的，我一生中从未使用过 Ruby，但 Facebooker 调用的某些内容在我看来是错误的。这是您链接中的 fb_user_action 的样子：

```
def fb_user_action(action, user_message = "", prompt = "", callback = nil)
  update_page do |page|
    page.call "FB.Connect.showFeedDialog",action.template_id,action.data,action.target_ids,action.body_general,nil,page.literal("FB.RequireConnect.promptConnect"),callback,prompt,user_message
  end
end 
```

因此，根据我对 page.call 的查找，在我看来它会生成这样的 javascript：

```
FB.Connect.showFeedDialog(template_id,data,target_ids,body_general,nil,promptConnect,callback,prompt,user_message); 
```

但是，showFeedDialog 的签名是：

```
FB.Connect.showFeedDialog(template_id,data,body_general,target_ids,callback,prompt,user_message) 
```

Facebooker fb_user_action 函数为 Javascript 生成的参数顺序对我来说似乎完全错误。回调参数看起来会被替换为 nil，因此不会调用任何内容。

如果您不调用 fb_user_action，而是自己使用 page.call，但参数顺序正确，该怎么办？

同样，我可能无法理解 page.call 和/或 Ruby 语法。但我会仔细检查 Facebooker 函数，因为 FB API 一直在变化。

# php - PHP：集中式页面会话验证器

> ID：790295
> 
> 赞同：0
> 
> 时间：2009-04-26T05:35:57.710
> 
> 标签：php, session, centralized

我目前想知道如何实现集中式页面身份验证器。谁能为我推荐一个简洁的算法？我打算实现的是使我的后端管理员页面会话受到保护，而无需为我想要保护的每个页面编写一段会话检查代码。我目前做这样的事情：

登录页面->如果正确的凭据：设置会话->如果查看没有会话的受保护页面：拒绝否则：允许

关于/比这有什么最佳实践（或更好的方法）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T06:36:17.503

我不太想建议一个算法，而是一个库/框架。

如果您的应用程序只有一个入口点，那就是调用会话管理库/框架的地方。例如，使用[Zend 框架](http://framework.zend.com/manual/en/zend.session.html)，您可以在引导程序中启动会话。唯一剩下的就是在登录控制器中验证会话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T14:05:10.217

如果您正在构建一个具有多个入口点的 PHP 应用程序，您会疯狂地尝试复制和粘贴所有这些代码。研究使用真正的 MVC 框架。

在这种情况下，我使用[Zend_Controller](http://framework.zend.com/manual/en/zend.controller.html)来路由我的页面浏览量。

以这种方式构建应用程序后，将一些代码添加到受限控制器的 predispatch() 方法以进行身份​​验证并在未找到或无效时重定向到登录页面变得很简单。

# c++ - 从 C++ MD2 Loader 到 C\Objective-C & Cocoa

> ID：790297
> 
> 赞同：0
> 
> 时间：2009-04-26T05:37:07.333
> 
> 标签：c++, c, file-io

今天下午，我决定根据我在 OpenGL 课程中所做的工作，在 Cocoa 和 OpenGL 上制作一个简单的 3D 游戏。我正在使用在 David Henry 的[“The Quake II 的 MD2 文件格式”](http://tfc.duke.free.fr/old/models/md2.htm)中发布的 MD2 加载代码，我喜欢它的组合方式，给出了很好的解释和漂亮的 C++ 代码。

我希望这适用于所有 Cocoa/Objective-C，这样我就可以感受这些东西，并且我得到了一个我无法翻译成 C 的部分——我只是没有足够的编程经验。

这是有问题的代码，与文件读取有关：

```
// read frame data...
file.seekg( header.ofs_frames, std::ios::beg );
file.read( (char *)buffer, num_frames * header.framesize ); 
```

所以，我的问题是：在我可以使用的 C 文件函数上，seek() 是否有等价物？您认为我可能会觉得有用的任何相关信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T05:40:43.953

看看[`fseek`](http://www.opengroup.org/onlinepubs/000095399/functions/fseek.html)和[`fread`](http://www.opengroup.org/onlinepubs/009695399/functions/fread.html)从`stdio.h`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-30T22:42:30.037

不确定您是否仍在寻找有关如何执行此操作的资源，但我在 Kode80 博客上找到了一个很棒的教程：http: [//kode80.com/2009/09/24/iphone-md2-example/](http://kode80.com/2009/09/24/iphone-md2-example/)

有一个示例项目，其中作者根据 MD2 规范 ( [http://tfc.duke.free.fr/coding/md2-specs-en.html](http://tfc.duke.free.fr/coding/md2-specs-en.html) )为 Objective-C/OpenGL ES 编写了一个 MD2 阅读器

# django - 如何阻止人们故意重新提交表单？

> ID：790300
> 
> 赞同：2
> 
> 时间：2009-04-26T05:39:49.463
> 
> 标签：django, apache, ip-address

我正在使用 Ubuntu、Apache 和 Django 构建一个网站。我想阻止人们在我的网站上多次填写和提交特定表格。我知道要阻止一个坚定的用户更改他的 IP 地址、删除他的 cookie 等等几乎是不可能的。我正在寻找的只是阻止临时用户重新提交的东西。

在我看来，阻止来自同一 IP 地址的多个表单提交是实现我正在寻找的最佳方式。但是，我不确定我应该如何执行此操作，以及我应该从 Apache 还是从 Django 执行此操作。有小费吗？

编辑：我希望防止故意重新提交，而不仅仅是无意的重复提交。例如，我有一个调查，我想阻止人们多次投票。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-26T06:35:29.800

如果您主要关心的是防止有人编写脚本并多次自动提交表单，您可能希望在表单中使用[CAPTCHA](http://en.wikipedia.org/wiki/Captcha)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-26T05:44:32.980

几个国家都被 NAT 了，还有一些（大多数？）大型跨国公司，每个都有几十万用户。通过 IP 阻止任何内容是个*坏*主意。

去吃一个饼干吧，这和它会得到的一样好。您还可以让用户登录，在这种情况下，您会知道表单是否为该登录重复提交。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T05:45:49.153

我将使用会话 ID，并将表单提交存储在带有会话 ID、时间戳和可选的某种表单标识符的表中。然后，当提交表单时，您可以检查表格以确保它在一定时间内没有发生。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-26T05:46:44.737

过滤 IP 地址和/或 cookie 都很容易解决，但它们会防止临时用户由于浏览器卡顿、不耐烦等而意外多次提交相同的内容。

如果您想要更好的东西，您可以实现登录，但这当然会阻止很多用户响应。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-26T05:47:33.220

在隐藏字段中添加一个单调递增的 id 编号。

在提交每个表单时，将 id 记录在“已使用”列表/地图中（或将其标记为已使用，或其他任何实现细节）。

如果您第二次获得相同的 id（如果它已经在您使用的地图中），请通知用户他们重复提交。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-26T06:02:07.540

虽然没有什么是万无一失的，但我会建议这样的事情：当用户加载页面并打开您的表单时，会设置一个 cookie，并且 cookie 的值会附加一个固定的秘密字符串，并将其 md5 值写入表单上的隐藏字段。确保每次用户访问表单时都会生成一个新值。

当用户提交表单时，您检查 cookie 值和表单值是否匹配，用户获得的 cookie 之前没有用于提交表单，以及引用者 ID 是否与表单的 URL 匹配。或者，您可以确保在最后 2 分钟内没有尝试从该 IP 发布（速度足够快，对大多数人来说无关紧要，但速度足够慢，可以减慢机器人的速度）。

为了解决这个问题，用户必须编写一个脚本来加载页面、存储 cookie 并提交正确的值。这比用户只需提交表单要困难得多。

*添加基于编辑*：我会阻止 Django 框架中的用户。这使您可以向用户显示更好的错误消息，并且您只能阻止他们进入该表单。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-26T06:56:14.397

这是一个身份验证和授权的问题，它们是相关的，但并不相同。为了管理授权，您必须首先验证（可靠地识别）用户。

如果您想抵制*故意*滥用，那么您最终不仅会得到用户名和密码，还会要求提供个人识别用户的信息，就像银行在您开户时要求的那样。流血的心和左撇子会无休止地为侵犯隐私而哭泣，但实际上，您所做的与银行完全相同，并且出于完全相同的原因。

工作量很大，可能会受到法律的影响。你真的想做吗？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-26T08:00:35.680

以下方法都相对简单，无论是实现还是破解。任何有 Firebug 和一点知识的人都不会眨眼。

以下 JavaScript 使用 Mootools，我没有检查它是否没有错误。我知道 JQ 语法几乎相同，原始 JS 也足够相似，所以这一点应该很清楚。

1）如果表单是通过 AJAX 提交的，您可以在提交前检查（对不起，如果我只是说明显而易见的）。

```
var sent = 0;
$('myForm').addEvent('submit', function(){
    if(!sent) this.send(); 
}) 
```

这真的很简单，并且在他们重新加载页面之前非常有效。

2) 添加一个 JavaScript cookie。同样，使用 Mootools：

```
$('myForm').addEvent('submit', function(){ 
     if(Cookie.read('submitted')){ alert('once only'); return false;}
     else{ Cookie.write('submitted', 1); return true; }
}) 
```

即使用户重新加载页面，这也会起作用。

3) 添加一个 Python 会话 cookie。我不熟悉 Python，但如果它像 PHP，这将没有方法 2 的优势。在任何一种情况下，用户都可以使用 FireCookie 或 WebDeveloper 工具栏（或它们在其他浏览器上的等效项）删除 cookie 并重新加载页面.

4) 添加一个 Flash cookie（使用 Flex）。这是理想的 - Flash cookie 存储在不同的位置，不明显，并且很难删除。唯一的缺点是您需要创建和嵌入一个很小的 ​​swf。

5）在隐藏字段中存储一个值，并检查该值。可以将散列添加到内部链接，以确保即使页面被导航离开，该值仍保持填充状态。

6) 可以为每个访问者增加一个 URL（或使用 htaccess 的自定义 URL）来玩其他游戏。

swf cookie 是上述方法中最好的方法，尽管它可以与其他方法结合使用。

# php - 如何在图像中嵌入文本链接？

> ID：790305
> 
> 赞同：1
> 
> 时间：2009-04-26T05:45:05.643
> 
> 标签：php, image, text, image-processing, embed

如何在图像中嵌入文本？嵌入的文本应超链接到 URL。用例就像有一个带有“单击此处”链接的图像，它会打开一个新页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T18:58:39.283

如果您想远离 z-indexes 和/或图像映射，您可以使用老式方法，即将图像设置为表格或 div 的背景，然后将文本放入表格或 div 中.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T07:01:38.910

您必须选择完成此操作：

1.  使用您选择的图形程序将文本添加到图像中。（使用[ImageMagick](http://www.imagemagick.org)进行自动化处理）然后创建一个[图像映射](http://en.wikipedia.org/wiki/Image_map)以使部分图像可点击。如果您需要某种“热状态”，那么您必须使用绝对位于原始图像上方的小图像，并使用 Javascript 显示/隐藏它们。根据您的需要，使整个图像可点击可能会更容易。

2.  添加普通图像和普通超链接。您可以使用常规的 img 标签或使用设置容器的背景图像。然后使用绝对定位将超链接移动到图片顶部的所需位置。使用该解决方案，您不需要 Javascript 来创建悬停效果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T06:58:53.207

使用图像编辑器将所需的文本添加到图像本身，然后使用图像映射到文本出现到所需 URL 的区域。如需样品，请在[http://shreedhar.kotekar.com/ImageMapSample.htm查看我的样品](http://shreedhar.kotekar.com/ImageMapSample.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-26T05:50:05.850

如果您使用的是 asp.net，这个[Embed text in Image using ASP.NET](http://www.developerfusion.com/code/4648/embed-text-in-image-using-aspnet/) from developer's fusin 就是一个很好的例子。

**编辑**- 从您的评论中，我看到您正在寻找 php：[使用 PHP 添加文本到图像](http://www.rafaeldohms.com.br/2008/02/12/adding-text-to-images-in-real-time-with-php/en/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-03T16:01:15.367

你可以使用这个工具：

[http://www.jsclasses.org/package/324-JavaScript-Embed-encoded-text-in-images-using-steganography.html](http://www.jsclasses.org/package/324-JavaScript-Embed-encoded-text-in-images-using-steganography.html)

在github上：

[https://github.com/blauharley/LoremImageCryptonator](https://github.com/blauharley/LoremImageCryptonator)

在这个 JS-Object 的帮助下，你可以嵌入任何你想要的文本。它提供了两种方法（getCryptoImage、getTextFromCryptoImage），可用于在图像中插入和提取任何文本。

对于您的用例，您可以插入 URL 并在单击图像后立即提取它。

但首先，您需要创建一个“加密图像”，然后将 URL 插入其中，然后保存图像。然后可以在页面上显示保存的“加密图像”。

希望这可以帮助。

# iphone - 在 iphone 的地图上绘制路径

> ID：790313
> 
> 赞同：5
> 
> 时间：2009-04-26T05:49:51.313
> 
> 标签：iphone, objective-c

我正在使用 iPhone 的[Route-Me](http://code.google.com/p/route-me/)库。例如，我的问题是我想在地图上绘制一条路径。

我在达拉斯，我想去纽约，然后我将在这两个地方放置标记，并在这两个标记之间绘制路径。

任何机构都可以建议我如何做到这一点。

如果有任何其他地图而不是 RouteMe，那么也可以。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-06-21T07:47:51.983

以下代码将绘制 2 点之间的路径。（在您的情况下，您必须添加所有路线点）

```
// Set map view center coordinate
CLLocationCoordinate2D center;
center.latitude = 47.582;
center.longitude = -122.333;
slideLocation = center;
[mapView.contents moveToLatLong:center];
[mapView.contents setZoom:17.0f];

// Add 2 markers(start/end)  and RMPath with 2 points
RMMarker *newMarker;
UIImage *startImage = [UIImage imageNamed:@"marker-blue.png"];
UIImage *finishImage = [UIImage imageNamed:@"marker-red.png"];
UIColor* routeColor = [[UIColor alloc] initWithRed:(27.0 /255) green:(88.0 /255) blue:(156.0 /255) alpha:0.75];
RMPath* routePath = [[RMPath alloc] initWithContents:mapView.contents];
[routePath setLineColor:routeColor];
[routePath setFillColor:routeColor];
[routePath setLineWidth:10.0f];
[routePath setDrawingMode:kCGPathStroke];
CLLocationCoordinate2D newLocation;
newLocation.latitude = 47.580;
newLocation.longitude = -122.333;   
[routePath addLineToLatLong:newLocation];
newLocation.latitude = 47.599;
newLocation.longitude = -122.333;   
[routePath addLineToLatLong:newLocation];
[[mapView.contents overlay] addSublayer:routePath];

newLocation.latitude = 47.580;
newLocation.longitude = -122.333;   
newMarker = [[RMMarker alloc] initWithUIImage:startImage anchorPoint:CGPointMake(0.5, 1.0)];
[mapView.contents.markerManager addMarker:newMarker AtLatLong:newLocation];
[newMarker release];
newMarker = nil;

newLocation.latitude = 47.599;
newLocation.longitude = -122.333;   
newMarker = [[RMMarker alloc] initWithUIImage:finishImage anchorPoint:CGPointMake(0.5, 1.0)];
[mapView.contents.markerManager addMarker:newMarker AtLatLong:newLocation];
[newMarker release];
newMarker = nil; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-11-07T13:05:08.700

Route-me 有一个`RMPath`用于此目的的课程。你玩过它吗？如果是这样，你做了什么，什么做了，什么没用？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-14T05:30:39.783

例如，Route-Me 如何在地图上绘制路径，不完全但接近。

使用 RMPath 在叠加层上绘制多边形

```
//polygonArray is a NSMutableArray of CLLocation
- (RMPath*)addLayerForPolygon:(NSMutableArray*)polygonArray toMap:(RMMapView*)map {
    RMPath* polygonPath = [[[RMPath alloc] initForMap:map] autorelease];
    [polygonPath setLineColor:[UIColor colorWithRed:1 green:0 blue:0 alpha:0.5]];
    [polygonPath setFillColor:[UIColor colorWithRed:1 green:0 blue:0 alpha:0.5]];
    [polygonPath setLineWidth:1];

    BOOL firstPoint = YES;
    for (CLLocation* loc in polygonArray) {
        if (firstPoint) {
            [polygonPath moveToLatLong:loc.coordinate];
            firstPoint = NO;
        } else {
            [polygonPath addLineToLatLong:loc.coordinate];
        } 
    }

    [polygonPath closePath];

    polygonPath.zPosition = -2.0f;

    NSMutableArray *sublayers = [[[[mapView contents] overlay] sublayers] mutableCopy];
    [sublayers insertObject:polygonPath atIndex:0];
    [[[mapView contents] overlay] setSublayers:sublayers];
    return polygonPath;
} 
```

笔记：

最新的 RouteMe 有 addLineToCoordinate:(CLLocationCoordinate2D)coordinate 而不是 addLineToLatLong。

这是在 Route-me 的示例中的 MapTestBed 中找到的较新的

```
- (RMMapLayer *)mapView:(RMMapView *)aMapView layerForAnnotation:(RMAnnotation *)annotation
{
    if ([annotation.annotationType isEqualToString:@"path"]) {
        RMPath *testPath = [[[RMPath alloc] initWithView:aMapView] autorelease];
        [testPath setLineColor:[annotation.userInfo objectForKey:@"lineColor"]];
        [testPath setFillColor:[annotation.userInfo objectForKey:@"fillColor"]];
        [testPath setLineWidth:[[annotation.userInfo objectForKey:@"lineWidth"] floatValue]];

        CGPathDrawingMode drawingMode = kCGPathStroke;
        if ([annotation.userInfo containsObject:@"pathDrawingMode"])
            drawingMode = [[annotation.userInfo objectForKey:@"pathDrawingMode"] intValue];
        [testPath setDrawingMode:drawingMode];

        if ([[annotation.userInfo objectForKey:@"closePath"] boolValue])
            [testPath closePath];

        for (CLLocation *location in [annotation.userInfo objectForKey:@"linePoints"])
        {
            [testPath addLineToCoordinate:location.coordinate];
        }

        return testPath;
    }
    if ([annotation.annotationType isEqualToString:@"marker"]) {
        return [[[RMMarker alloc] initWithUIImage:annotation.annotationIcon anchorPoint:annotation.anchorPoint] autorelease];
    }

    return nil;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T03:33:02.473

抱歉，我没有见过这样的事情 - 我只会注意到，如果人们因为他们认为你在谈论新的 SDK 映射功能而对你投反对票，那么在你谈论第三方库的地方再次阅读你的问题（仍然可能是一个有效的需求，因为您无法使用官方地图 SDK 进行转弯指示）。

# .net - 简单的 SSRS 报告

> ID：790315
> 
> 赞同：1
> 
> 时间：2009-04-26T05:50:25.693
> 
> 标签：.net, sql-server, database, reporting-services

经过一些阅读和发布后，我相当确定我想使用 SSDS 来分析我拥有的一些数据。但是，我可以使用一些指针来帮助我继续前进。

我有一个简单的 SQL Server 表：

```
* PKID (Int)
* ApplicationName (VarChar)
* MethodName (VarChar)
* TimeInMs (Integer)
* DateTime (DateTime) 
```

该表记录了各种方法在各种应用程序中运行所花费的时间长度。该表可能有数万行。

我想设置以下报告：

> 在以下时间段内运行方法的平均时间长度（总计和每个应用程序）：1、2、3、4、5、6、7、8、9、10、20、30、40、50、 60,120,240,360

在此先感谢您的任何指点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-26T06:37:17.203

在不知道你目前处于什么阶段（你安装了 SSRS 吗？）的情况下，很难知道如何回答......

不用太搞笑，有很多入门文章使用世界上最受欢迎的搜索引擎和这些关键字：[报告服务教程](http://www.google.com/search?q=reporting+services+tutorial)

我特别推荐[红门一号](http://www.simple-talk.com/sql/learn-sql-server/beginning-sql-server-2005-reporting-services-part-1/)（搜索结果中的第 5 个）

编辑，评论后

是的，使用您的时间创建一个表，并使用该表连接到主表以获取要显示的数据。您可以发布一些示例数据和示例输出吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T19:12:53.480

您需要开始使用 SSRS 吗？我可以帮你。我实际上在我的博客中写了一个初学者系列（正在进行中）[http://dbalink.wordpress.com/2009/01/17/how-to-report-authoring-in-ssrs-2005-part-i-the-database /](http://dbalink.wordpress.com/2009/01/17/how-to-report-authoring-in-ssrs-2005-part-i-the-database/)

我广泛使用时间变量的数据，等等等等。

Good thing is you can send me sample data. I might be able to help you build the whole thing from the ground up. :-)

# java - 从链表JAVA中删除元素

> ID：790321
> 
> 赞同：1
> 
> 时间：2009-04-26T05:59:54.940
> 
> 标签：java

好的，这是我的问题。我有一个卡片对象的链接列表。

我有以下方法

```
 public void removeCard(Card card){
        cards.remove(card);

  } 
```

如果我创建卡 c = new Card(5,C); 例如

并且在链表（卡片）中有一张具有完全相同值 2 和 C 的卡片。

如果我调用 CardPile.remove(card) 方法
，我不会收到任何错误，但与参数 card 相等的元素不会被删除。有什么想法为什么没有发生？

```
import java.util.LinkedList;

public class CardPile {

    final char [] suit = {'C','D','H','S'};
    final char [] rank = {'A','2','3','4','5','6','7','8','9','T','J','Q','K'};

    LinkedList<Card> cards;

    public CardPile(){
            cards = new LinkedList<Card>();
    }

    public void addCard(Card card){
            cards.addLast(card);
    }
    public void removeCard(Card card){
            cards.remove(card);

    }
    public void removeSpecial(Card card){
            LinkedList<Card> temp = new LinkedList<Card>();
            for(int i=0; i<cards.size(); i++){
                    if(cards.get(i).equals(card)){
                            temp.add(cards.get(i));

                    }
            }
            cards = temp;
    }

    public void listCards(){
            for(int i=0; i<cards.size(); i++){
                    System.out.print(cards.get(i).toString()+" ");
            }
            System.out.println();
    }

    public boolean isEmpty(){
            if(cards.size()==0)
                    return true;
            else
                    return false;
    }

    public Card drawCard(){
            return cards.removeLast();
    }

    public boolean hasCard(Card card){
            int index = 0;
            boolean contained = false;
            if(cards.size()==0){
                    System.out.println("error, cards size is 0");
                    return false;
            }
            else{
                    while(index<cards.size() && !contained){
                            if(cards.get(index).isEqual(card)){
                                    System.out.println("Card found");
                                    contained=true;
                            }
                            index++;
                    }
            }

            return contained;
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-26T06:21:56.163

我敢打赌 Card 类不会覆盖 equals() 和 hashcode() 方法。

Object 类的默认实现只检查“==”，即两个变量是否指向同一个对象实例。您需要覆盖 equals() 和 hashcode() 以提供正确的相等性检查。在此处查看有关该主题的精彩讨论 - [http://java.sun.com/developer/Books/effectivejava/Chapter3.pdf](http://java.sun.com/developer/Books/effectivejava/Chapter3.pdf)

使用适当的 equals() 和 hashcode()，您的代码可以进一步简化。例如，hasCard() 方法可以简单地调用 List 方法 contains()。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T06:03:18.423

那时他们可能不相等。

检查 Card 上的 equals() 方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T06:09:37.490

卡片类中的equals方法很可能只使用'=='运算符。确保进行比较，以便将具有相同面部/套装值的两个对象视为相等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-02-13T07:09:28.660

您的 Card 类是否实现了 equals 和 hashCode 方法？每当需要逻辑相等而不是身份相等时（即两个引用指向同一个对象），程序员应该重写这两个方法。java.lang.Object 中的默认实现仅进行身份相等性检查。

# excel-formula - 根据excel中的第二列创建子列表

> ID：790323
> 
> 赞同：0
> 
> 时间：2009-04-26T06:01:17.040
> 
> 标签：excel-formula, excel, search, excel-2007, vba

我有两列，第一列将有一个对象的名称，第二列是它属于谁。我希望每个人都有一张新表来列出他们分配给他们的内容。这是一个例子：

```
dog F
cat F
bell S
whistle 
bird F 
```

所以弗雷德有一只狗、一只猫和一只鸟；斯科特有铃；没有人在他们的页面上有哨子。现在做一个简单的 IF() 我可以让它看起来像 Fred 的页面

```
TOP OF ROW
dog
cat

bird 
```

斯科特的页面看起来像

```
TOP OF ROW

bell 
```

但是我希望弗雷德看起来像

```
TOP OF ROW
dog
cat
bird 
```

和斯科特是一样的。

我目前的思路是`=VLOOKUP($C$1,Items!A2:C1000,3)`在 D 中的隐藏列中使用来告诉我我的数据在哪一行，（其中 Items 上的 C 列是隐藏列，其中包含行的行号，C1 是搜索参数（S 或F）），然后`=IFERROR(CELL("contents",INDIRECT(ADDRESS($D2,2,1,TRUE,"Items"))),"")`，但是我除了将搜索数组的行索引更改为 1+ 最后找到的项目（我还没有弄清楚如何做）之外，我无法弄清楚如何继续搜索下一个项目。我知道 C++ 和 C#，但以前从未在 VBA 中编写过代码，而且我严重依赖 MSDN，据我所知，没有专门针对 Excel API 的 MSDN 部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T08:42:56.950

在没有任何 VBA 代码的情况下实现您正在寻找的列表的一种方法是使用高级过滤器。

在工作表 1 上，输入列表输入如下

[![替代文字](https://i.stack.imgur.com/DGzbk.jpg)](https://i.stack.imgur.com/DGzbk.jpg)

在 sheet2 上输入过滤条件（此条件表示在“拥有者”列中包含 F）

[![替代文字](https://i.stack.imgur.com/mtbdp.jpg)](https://i.stack.imgur.com/mtbdp.jpg)

最后在 sheet3 上，像这样调用高级过滤器功能

[![替代文字](https://i.stack.imgur.com/ALey6.jpg)](https://i.stack.imgur.com/ALey6.jpg)

确保选择复制到另一个位置

选择 sheet1 输入列表作为列表范围

选择 sheet2 过滤条件作为条件范围

并选择 sheet3 中的某处作为输出范围（复制到条目）

如果您更喜欢走 excel VBA 编程的路线，那么好的第一步是在 excel 中试用宏记录器（工具 - 宏 - 录制宏）

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T08:01:47.943

有一种很好的方法可以使用 excel 中的函数来执行此操作。

本质上，您需要创建一个正在运行的 countif

因此，在 C2 中，您`=COUNTIF($B$2:$B2,"F")`显然会有“F”也可以是对另一个单元格的引用。如果您将此公式填充到范围内，它将扩大范围。例如。在 C3 中它会说`=COUNTIF($B$2:$B3,"F")`

在您的示例中，这将在 C 列中为您提供运行总计，这意味着：

> 狗 F 1
> 
> 猫 F 2
> 
> 铃 S 2
> 
> 哨子 2
> 
> 鸟 F 3

您有 3 个 2 的事实并不重要，因为 vlookup 将始终匹配它找到的第一个匹配项。

这种技术有很多不同的应用。根据数据，您可能会发现将其放在数据的左侧更容易，因此 VLOOKUP 会更容易。

# sql-server - 如何在 SQL Server 中创建 RowNum 列？

> ID：790328
> 
> 赞同：2
> 
> 时间：2009-04-26T06:07:48.117
> 
> 标签：sql-server

在 Oracle 中，我们有“rownum”。我可以在 SQL Server 中做什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T06:15:16.790

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T06:18:17.080

如果你有一个 id 列，你可以这样做：

```
select a.*, 
(select count(*) from mytable b where b.id <= a.id) as rownum
from mytable a
order by id; 
```

当然，这仅适用于您能够以与 id 的顺序相同（或相反）的顺序对 rownum 进行排序的情况。

如果您正在选择适当的行子集，当然您需要将相同的谓词应用于整个选择和子查询：

```
select a.*, 
(select count(*) from table b where b.id <= a.id and b.foo = 'X') as rownum
from table a where a.foo = 'X'
order by id; 
```

显然，这不是特别有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T06:20:50.503

根据我的理解，您需要使用[排名函数](http://msdn.microsoft.com/en-us/library/ms186734.aspx)和/或[TOP 子句](http://msdn.microsoft.com/en-us/library/ms189463(SQL.90).aspx)。SQL Server 功能是特定的，Oracle 结合了这两个概念。

排名功能很简单：这就是您使用 TOP 的原因。注意：您不能直接在 ROWNUMBER 上的 WHERE...

```
'Orable:
select 
  column_1, column_2 
from 
  table_1, table_2
where
  field_3 = 'some value'
and rownum < 5

--MSSQL:
select top 4
  column_1, column_2 
from 
  table_1, table_2
where
  field_3 = 'some value' 
```

# sql - SQL：您是否需要多对多表的自动增量主键？

> ID：790334
> 
> 赞同：16
> 
> 时间：2009-04-26T06:13:42.003
> 
> 标签：sql, database-design

假设您在 Artists 和 Fans 之间有一个 Many-Many 表。在设计桌子时，您是否将桌子设计成这样：

```
ArtistFans
    ArtistFanID (PK)
    ArtistID (FK)
    UserID (FK)

 (ArtistID and UserID will then be contrained with a Unique Constraint 
  to prevent duplicate data) 
```

或者您是否为两个相关字段构建使用复合 PK：

```
ArtistFans
    ArtistID (PK)
    UserID (PK)

(The need for the separate unique constraint is removed because of the 
 compound PK) 
```

* * *

使用前一个模式有什么好处（也许是索引？）？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-26T06:30:09.017

```
ArtistFans
    ArtistID (PK)
    UserID (PK) 
```

使用自动增量 PK 在这里没有优势，即使父表有它们。

我还将自动创建一个“反向 PK”索引`(UserID, ArtistID)`：您将需要它，因为您将按两列查询表。

自动编号/ID 列有它们的位置。在基于物理平台的标准化过程之后，您会选择它们来改进某些事情。但不适用于链接表：如果您的死脑筋 ORM 坚持，那么更改 ORM...

编辑，2012 年 10 月

请务必注意，您仍然需要唯一性`(UserID, ArtistID)`和`(ArtistID, UserID)`索引。添加自动增量只会使用更多不应使用的空间（在内存中，而不仅仅是在磁盘上）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-01-27T17:08:39.707

假设您已经是代理键的忠实拥护者（您有很好的陪伴），那么就有理由一路走下去。

有时被遗忘的关键点是关系本身可以具有属性。通常只说两件事是相关的是不够的。您可能必须描述这种关系的性质。换句话说，关系表说它只能有两列并没有什么特别之处。

如果这些表没有什么特别之处，为什么不像对待其他表一样对待它并使用代理键呢？如果您最终不得不向表中添加属性，您将感谢您的幸运表示层，您不必为了修改这些属性而传递复合键。

我什至不会称其为经验法则，更多的是要考虑的事情。以我的经验，绝大多数关系最终都会携带额外的数据，本质上本身就是实体，值得一个代理键。

问题在于，事后添加这些键可能会很痛苦。额外的列和索引的成本是否值得先发制人，这真的取决于项目。

至于我，一次被咬，两次害羞——我去寻找门外的代理钥匙。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-26T07:12:12.580

即使您创建标识列，它也不必是主键。

```
ArtistFans
    ArtistFanId
    ArtistId (PK)
    UserId (PK) 
```

标识列可用于将此关系与其他关系相关联。例如，如果有一个创建者表指定了创建艺术家-用户关系的人，那么它可能在 ArtistFanId 上有一个外键，而不是组合的 ArtistId+UserId 主键。

此外，某些 ORM 包需要标识列（或大大改进其操作）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-26T06:24:22.337

我想不出任何理由使用您列出的第一个表格。复合主键很好，拥有一个单独的人工主键（以及外键所需的唯一约束）将需要更多时间来计算和存储空间。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-26T06:25:35.110

标准方法是使用复合主键。添加单独的自动增量键只是使用您拥有的东西创建一个已经存在的替代品。正确的数据库规范化模式会忽略使用自动增量。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-26T16:57:25.263

有趣的是，所有答案都支持变体 2，所以我不得不反对并为变体 1 辩护；）

回答标题中的问题：不，你不需要它。但...

在*每个*表中都有一个自动增量或标识列可以简化您的数据模型，以便您知道每个表始终有一个 PK 列。

因此，从一个表到另一个表的每个关系（外键）总是由每个表的单个列组成。

此外，如果您碰巧为表单、列表、报告、日志记录等编写了一些应用程序框架，您只需处理具有单个 PK 列的表，这简化了框架的复杂性。

此外，就磁盘空间而言，额外的 id PK 列不会花费您太多（十亿记录以上的表除外）。

当然，我需要提到一个缺点：在祖父母-孩子关系中，孩子将丢失其祖父母信息并需要 JOIN 来检索它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-04-16T07:48:18.370

在我看来，在纯 SQL 中 id 列是没有必要的，也不应该使用。但是对于像 Hibernate 这样的 ORM 框架，使用复合键等管理多对多关系并不简单，尤其是在连接表有额外列的情况下。

因此，如果我要在数据库上使用 ORM 框架，我更喜欢将自动增量 id 列放在该表中，并将唯一约束放在引用列中。当然，如果需要，非空约束。

然后我像对待项目中的任何其他表一样对待该表。

# winforms - 什么是好的、负担得起的“旋钮”库？

> ID：790341
> 
> 赞同：0
> 
> 时间：2009-04-26T06:18:16.843
> 
> 标签：winforms, graphics, .net-2.0

我目前正在考虑一个新的宠物项目，一个支持 MIDI 的合成器的“编辑器”。我想我已经覆盖了 MIDI 方面，但我现在正在寻找的是可以传递漂亮“拨号”和“旋钮”的东西，就像你在 Ableton Live、Reason、Reaktor 等中看到的那样。

让我的表格充满轨迹栏，有点浪费，你知道吗？

那么，什么样的 .NET 2.0 库具有这种图形组件，价格实惠呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T11:42:27.920

1- [http://www.codeproject.com/KB/cs/industrial_controls.aspx](http://www.codeproject.com/KB/cs/industrial_controls.aspx)有一些相关的控件（C#）

2- [http://www.c-sharpcorner.com/UploadFile/desaijm/KnobControlusingWindowsForms11182005004925AM/KnobControlusingWindowsForms.aspx](http://www.c-sharpcorner.com/UploadFile/desaijm/KnobControlusingWindowsForms11182005004925AM/KnobControlusingWindowsForms.aspx)是另一个基于 C# 的旋钮控件

在一个项目中亲自使用 (2) 并且效果很好（虽然在视觉上不是很强大）。(1) 看起来更酷但尚未探索

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T06:55:24.727

我自己从来没有使用过这个，但发现了[KineticaRT 控件](http://www.kineticart.co.uk/KineticaRTKnob.asp)。67.06 美元。

[![替代文字](https://i.stack.imgur.com/jImbk.gif)](https://i.stack.imgur.com/jImbk.gif)
[（来源：[eclipse.co.uk](http://www.kineticart.eclipse.co.uk/Products/KineticaRT/Images/KnobSplash.gif)）]

[GMSI.Net 旋钮 v2.0](http://www.globalmajic.com/Net-Instrumentation-Controls-c11.html)。169.00 美元。

[替代文字 http://www.globalmajic.com/mc_images/product/thumbnail/net_knob150.jpg](http://www.globalmajic.com/mc_images/product/thumbnail/net_knob150.jpg)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T06:57:31.057

看看其中的一些。如果没有，只需搜索“.net gauges”。大多数主要的 UI 控件库都有仪表或仪表板库。

[http://www.perpetuumsoft.com/Product.aspx?lang=en&pid=44](http://www.perpetuumsoft.com/Product.aspx?lang=en&pid=44) [http://www.brothersoft.com/software_developer/microsoft_.net/.net_dashboard_suite_56186.html](http://www.brothersoft.com/software_developer/microsoft_.net/.net_dashboard_suite_56186.html) [http://www.componentone.com/SuperProducts /GaugesSilverlight/](http://www.componentone.com/SuperProducts/GaugesSilverlight/) [http://www.dundas.com/](http://www.dundas.com/)

# c# - 为什么从 EventArgs 继承有用？

> ID：790344
> 
> 赞同：11
> 
> 时间：2009-04-26T06:20:32.783
> 
> 标签：c#, .net, asp.net

我不明白为什么继承`EventArgs`是有用的。

```
public class ClickedEventArgs : EventArgs
{
    int x;
    int y;
    public ClickedEventArgs (int x, int y)
    { 
        this.x = x; 
        this.y = y; 
    }
    public int X { get { return x; } } 
    public int Y { get { return y; } } 
} 
```

在上面的代码中，如何使用这种继承？

我也想了解如何调用这个代码块`default.aspx`

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-26T08:59:51.963

您是在问为什么从`EventArgs`一开始就派生有用吗？我不得不说，由于委托转换的工作方式，使用 C# 1 并没有多大意义 - 但从 C# 2 开始，它更明智。它允许事件处理程序注册到事件中，即使它不关心事件参数的细节。

例如：

```
void LogEvent(object sender, EventArgs e)
{
    Console.WriteLine("Event sent from " + sender);
}

...

textArea.KeyPress += LogEvent; 
```

即使`Control.KeyPress`是类型的事件，这也有效`KeyPressEventHandler`。C# 和 .NET 不介意 的签名与 的签名`LogEvent`不*完全*匹配`KeyPressEventHandler`- 它足够兼容。

诚然，如果我们根本没有`EventArgs`（您可以只使用`object`），这仍然是可行的，但是考虑到`EventArgs`类和模式，从`EventArgs`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-26T11:43:38.903

这里真正重要的是，您可以稍后轻松升级您的事件以获得更多详细信息，并且不会破坏现有的解耦侦听器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T06:33:08.167

以下是如何使用代码的示例：

```
public class MyClass () {        
    public event EventHandler<ClickedEventArgs> ClickedEvent = delegate {};  //Register the event

    protected void SomethingWasClicked(int x, int y) {    
        ClickedEvent(this, new ClickedEventArgs(x,y));   //Invoke the event that is subscribed to
    }

}

public class AnotherClass () {

    public AnotherClass () {
        MyClass mClass = new MyClass();
        mClass.ClickedEvent += new EventHandler(mClass_clickedEvent);
    }

    protected void mClass_clickedEvent(object sender, ClickedEventArgs e) {
        //Retrieve the X parameter that was passed from the MyClass instance
        int x = e.X;  
    }
} 
```

# c# - 我如何比较（Jagged Arrays、Arrays、ArrayList）的性能？

> ID：790351
> 
> 赞同：-1
> 
> 时间：2009-04-26T06:24:58.950
> 
> 标签：c#, .net, performance, arrays

有没有性能计数器？或者我真的得到这样的结果：

锯齿状阵列：2000 毫秒
阵列：300​​0 毫秒
ArrayList：4000 毫秒

* * *

我如何编码方法来获得性能结果？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-26T06:59:21.893

秒表类对于计时微基准非常有用：

[http://msdn.microsoft.com/en-us/library/system.diagnostics.stopwatch.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.stopwatch.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T09:37:15.040

里科马里亚尼是你的男人。他为 .net 制作了最佳性能静态数据。

所以，要开始如何做，请阅读他的博客。

[如何测试阵列速度](http://blogs.msdn.com/ricom/archive/2006/03/09/performance-quiz-9-ilist-lt-t-gt-list-and-array-speed.aspx)

[这些测试的结果](http://blogs.msdn.com/ricom/archive/2006/03/12/performance-quiz-9-ilist-lt-t-gt-list-and-array-speed-solution.aspx)

基本上，您应该确保的是项目的访问权限。不添加它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T09:56:52.467

你可以看看[这个问题](https://stackoverflow.com/questions/468832/why-are-multi-dimensional-arrays-in-net-slower-than-normal-arrays)，它有一些代码、结果和讨论

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-06T04:41:46.320

老实说，如果你需要一个分析器来告诉你它工作得更好，你可能不需要担心它。因此，只需以三种不同的方式编译您的代码——锯齿状数组、数组列表和经典数组。如果他们中的任何一个持续运行 [job X] 的速度明显更快，那么你就明白了。如果您无法亲身感受到改进，那么您可能只是在浪费您最宝贵的资源：开发人员时间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T00:54:26.033

不同存储结构的性能将根据您需要在所述结构上执行的操作而有所不同。

一般测试可能是
排序：冒泡，合并
搜索：顺序，顺序（带有未排序的数据），二进制

编写一个函数来测试这些将涉及用等量的随机数据填充一些数组，然后执行测试。

使用这些类型的算法生成基于时间的性能指标通常非常简单。

根据语言的不同，您可以使用计时器或简单地存储/输出您选择的每个迭代点的时间戳来计算计算所需的时间。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T19:14:01.693

您可以在应用程序上设置一些性能计数器，然后测量性能..

这是很好的链接。 [http://www.codeproject.com/KB/dotnet/perfcounter.aspx](http://www.codeproject.com/KB/dotnet/perfcounter.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-01-23T18:14:47.297

创建一个包含 2 个锯齿状数组的类，如下所示

```
0    0123     
01   012  
012  01  
0123 0 
```

和两个构造函数。然后创建一个继承 jagged 类的类，其中包含一个二维数组和 2 个方法：

**create_matrix 方法**从两个继承的交错数组创建矩阵，如下所示：

```
0 0 1 2 3
0 1 0 1 2
0 1 2 0 1
0 1 2 3 0 
```

**display 方法**，显示两个锯齿状数组和结果矩阵。

# c# - 我如何在 GoogleChart 中使用任何数据集形式的 SQL？

> ID：790357
> 
> 赞同：0
> 
> 时间：2009-04-26T06:27:54.683
> 
> 标签：c#, .net, asp.net, gchart

我如何在 GoogleChart 中使用任何数据集形式的 SQL？我真的很喜欢 googleChart。但是我想在 C# 中将 Gchart 与来自 Sql' 查询结果的数据集一起使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-26T08:20:58.313

我相信您知道，Google 图表为数据提要采用格式化字符串。

您将需要遍历数据集并生成此字符串，然后将其写入文字控件中的页面。

例如

```
DataSet d = GetDataSet();// returns your data
string percentages = string.Empty;
string names = string.Empty;
string baseUrl = "http://chart.apis.google.com/chart?cht=p3&chs=250x100";

foreach(DataRow row in d.Tables[0].Rows)
{
    string tName = row["name"].ToString();
    int value = (int)row["value"];
    names += name + "|";
    percentages += value.ToString() + ",";
}

names = names.TrimEnd('|');
percentages = percentages.TrimEnd(',');

string fullUrl = baseUrl + "&chd=t:" + percentages;
fullUrl += "&chl=" + namesl

image1.ImageUrl = fullUrl; 
```

# vb.net - 如何在 VB 中计算 pi (π)？

> ID：790365
> 
> 赞同：3
> 
> 时间：2009-04-26T06:31:48.573
> 
> 标签：vb.net, math

有谁知道如何在VB中计算pi（π）？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-26T06:33:57.383

```
System.Math.Pi 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-26T07:02:44.210

假设您实际上想要计算 pi 而不是仅使用内置常量，那么您可以通过多种方式来完成它。以下是一些可能有用的链接：

*   [http://www.codeproject.com/KB/recipes/CRHpi.aspx](http://www.codeproject.com/KB/recipes/CRHpi.aspx)
*   [http://en.wikipedia.org/wiki/Pi#Computation_in_the_computer_age](http://en.wikipedia.org/wiki/Pi#Computation_in_the_computer_age)
*   [http://en.wikipedia.org/wiki/Machin-like_formula](http://en.wikipedia.org/wiki/Machin-like_formula)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-26T15:16:55.957

如果您的意思是 VB6，它没有 pi 常数。您可以使用：

```
Dim pi as Double  
pi = 4 * Atn(1) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-26T14:41:34.390

如果 OP 将算法作为一种学习体验来询问，那对他/她有好处。

如果 OP 需要帮助找到内置值，她/他现在就可以了。

但是，如果目标是一个比内置值更高精度的好值，并且需要最少的努力，那么这里的 pi 是一百万位数：

[http://www.eveandersson.com/pi/digits/1000000](http://www.eveandersson.com/pi/digits/1000000)

这应该足够了。

我希望 OP 不会在每次使用时都询问如何重新计算 Pi 的值。那将是*疯狂*的。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-26T16:19:04.093

嗯，如此高效、准确，最重要的是无聊的近似值……试试[这个](http://www.modula2.org/projects/pi_by_montecarlo.php)吧！伪代码随之而来：

*   *内部*初始化，*总计*为 0
*   重复疯狂的次数：
    *   在 0 和 +1 之间（包括）分配*x*和*y随机值。*
    *   将*距离指定为 (* *x* ² + *y* ² )的平方根
    *   如果*距离*≤1，则*在里面加1*
    *   *总数*加 1

**   将*pi*分配为*内部*/*总计** 4*

 ** * *

## 回答 #6

> 赞同：-6
> 
> 时间：2009-04-26T06:33:16.777

如果您不想使用 .net 数学库中的内置值...

22 / 7

# javascript - 考虑到浏览器兼容性，如何正确创建和使用 XML 文档对象？

> ID：790370
> 
> 赞同：2
> 
> 时间：2009-04-26T06:34:47.210
> 
> 标签：javascript, xml, browser

现在我正在做一个网络项目。我需要在 JavaScript 中使用给定的字符串缓冲区创建一个 XML 文档对象。我已经成功让它在 IE 上顺利运行，但显然我需要做更多的工作来提高它的兼容性。

这是一个描述我想要表达的小例子（注意，全部在 JavaScript 中）首先，我们有一个字符串变量，比如“buffer”，它是从服务器获取的，实际上它的形式如下一个 XML：

```
"<Messages><Item>aaa</Item><Item>bbb</Item></Messages>" 
```

然后，我可以使用下面的代码段来创建一个 IE 可识别的 XML doc 对象：

```
var xmlDoc = new ActiveXObject("Microsoft.xmlDOM");
xmlDoc.async = false;
xmlDoc.loadXML(buffer); 
```

我们得到了它。

所以，我想知道的是如何创建一个考虑浏览器兼容性（firefox、opera等）的对象以及它的用法是否相同。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-26T06:50:53.817

[DOMParser](https://developer.mozilla.org/En/DOMParser)应该可以工作。它不是标准，但至少在 WebKit（Safari、Chrome 等）和 Gecko (Firefox) 上受支持；我不了解 Opera：

```
var buffer = "<Messages><Item>aaa</Item><Item>bbb</Item></Messages>";
var parser = new DOMParser();
var xmlDoc = parser.parseFromString(buffer, "text/xml"); 
```

# php - 来自 FORM 的 PHP 查询

> ID：790374
> 
> 赞同：0
> 
> 时间：2009-04-26T06:37:23.867
> 
> 标签：php, forms

所以我有一个表单，我发布到页面，并在表单中发布某些变量，我使用这些变量构建我的查询，然后在我的页面上调用它们。如何发布数据并构建查询并在一次通话中显示答案？

也许我的措辞不对，我正在学习这些东西，但我只是不知道。我应该先发布到中间页面吗？

示例：表单（变量 A 和 B）到 -> 页面（查询中使用的 A 和 B）然后结果在同一页面上。

可以这样做吗？方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T07:35:56.033

这是基本原则，但您必须清理表单中的输入数据。例如使用`mysql_real_escape_string()`.

但是在一个页面中你可以有这样的代码（它没有经过测试，我不能在这台电脑上）：

```
<?php

if(isset($_POST['name']))
{
   $query = "SELECT * FROM table WHERE firstname = '"+ mysql_real_escape_string($_POST['name']) +"'";
   while($node = mysql_fetch_rows())
   {
      echo "The result: " . $node['id'];
   }
}

?>

<form method="post" action="<?php echo $_SERVER['PHP_SELF']; ?>">
   <input type="text" name="name" />
</form> 
```

这将自行发布，运行查询并回显结果，并再次显示表单。

对于小型工具等，这是一个不错的方法，但对于较大的网站，我建议不要将请求处理代码与 html 混合。研究使用框架来应用 mvc 模式或类似的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T07:17:57.620

没有具体的例子很难写，但它相当简单。

以非常基本的方式：

文件1.php：

```
--your form submits to file2.php-- 
```

文件2.php：

```
function processForm(inputs) [
  --MySql query goes here--
]

function displayResults() [
  --Process your query results--
]

processForm($_POST['vars']...);
displayResults(); 
```

那有意义吗？只需创建一个处理然后再次显示结果的函数。

如果您想真正花哨，您甚至可以在一个文件中完成所有操作，但如果您是第一次学习，您可能应该首先掌握这项技术。

# c# - 如何使文本框只接受字母字符

> ID：790378
> 
> 赞同：3
> 
> 时间：2009-04-26T06:47:03.123
> 
> 标签：c#, winforms

我有一个带有`maskedtextbox`控件的 Windows 窗体应用程序，我只想在其中接受字母值。

理想情况下，这将表现为按下除字母键之外的任何其他键都不会产生任何结果或立即向用户提供有关无效字符的反馈。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-26T08:26:09.940

这个问题可能在每一个可以想象的编程论坛上都被问过和回答了一百万次。提供的每个答案都具有对所述要求唯一的区别。

由于您使用的是`MaskedTextBox`，因此您可以使用其他验证功能，并且不需要处理按键。您可以简单地将 Mask 属性设置为“L”（需要字符）或“？” （可选字符）。为了向用户显示输入不可接受的反馈，您可以使用该`BeepOnError`属性或添加工具提示来显示错误消息。这种反馈机制应该在`MaskedInputRejected`事件处理程序中实现。

该`MaskedTextBox`控件提供了一个`ValidatingType`属性来检查输入是否通过了掩码的要求，但可能不是正确的数据类型。该`TypeValidationCompleted`事件在此类型验证后引发，您可以处理它以确定结果。

如果您仍然需要处理按键事件，请继续阅读...！

在您的情况下，我建议的方法是，不是处理`KeyDown`事件（您表面上不需要高级密钥处理能力）或使用正则表达式来匹配输入（坦率地说，矫枉过正），我会简单地使用的内置属性字符结构。

```
private void maskedTextBox1_KeyPress(object sender, KeyPressEventArgs e)
{
  Char pressedKey = e.KeyChar;
  if (Char.IsLetter(pressedKey) || Char.IsSeparator(pressedKey) || Char.IsPunctuation(pressedKey))
  {
    // Allow input.
    e.Handled = false
  }
  else
    // Stop the character from being entered into the control since not a letter, nor punctuation, nor a space.
    e.Handled = true;
  }
} 
```

请注意，此代码段还允许您处理标点符号和分隔符键。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-26T06:50:21.790

来自[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.keypress.aspx)（此代码显示如何处理 KeyDown 事件以检查输入的字符。在此示例中，它仅检查数字输入。您可以对其进行修改，使其适用于字母输入而不是数字）：

```
// Boolean flag used to determine when a character other than a number is entered.
private bool nonNumberEntered = false;

// Handle the KeyDown event to determine the type of character entered into the control.
private void textBox1_KeyDown(object sender, System.Windows.Forms.KeyEventArgs e)
{
    // Initialize the flag to false.
    nonNumberEntered = false;

    // Determine whether the keystroke is a number from the top of the keyboard.
    if (e.KeyCode < Keys.D0 || e.KeyCode > Keys.D9)
    {
        // Determine whether the keystroke is a number from the keypad.
        if (e.KeyCode < Keys.NumPad0 || e.KeyCode > Keys.NumPad9)
        {
            // Determine whether the keystroke is a backspace.
            if(e.KeyCode != Keys.Back)
            {
                // A non-numerical keystroke was pressed.
                // Set the flag to true and evaluate in KeyPress event.
                nonNumberEntered = true;
            }
        }
    }
    //If shift key was pressed, it's not a number.
    if (Control.ModifierKeys == Keys.Shift) {
        nonNumberEntered = true;
    }
}

// This event occurs after the KeyDown event and can be used to prevent
// characters from entering the control.
private void textBox1_KeyPress(object sender, System.Windows.Forms.KeyPressEventArgs e)
{
    // Check for the flag being set in the KeyDown event.
    if (nonNumberEntered == true)
    {
        // Stop the character from being entered into the control since it is non-numerical.
        e.Handled = true;
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-26T07:14:24.197

此代码将区分字母字符按键与非字母按键：

```
private void maskedTextBox1_KeyPress(object sender, KeyPressEventArgs e)
{
    if (Regex.IsMatch(e.KeyChar.ToString(), @"\p{L}"))
    {
        // this is a letter
    }
    else
    {
        // this is NOT a letter
    }
} 
```

更新：请注意，上面的正则表达式模式将只匹配字母字符，因此它不允许空格、逗号、点等。为了允许更多种类的字符，您需要将它们添加到模式中：

```
// allow alphabetic characters, dots, commas, semicolon, colon 
// and whitespace characters
if (Regex.IsMatch(e.KeyChar.ToString(), @"[\p{L}\.,;:\s]")) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-07-11T17:31:28.607

```
// This is  to allow only numbers.
// This Event Trigger, When key press event occures ,and it only allows the Number and Controls., 
private void txtEmpExp_KeyPress(object sender, KeyPressEventArgs e)
{
    if(Char.IsControl(e.KeyChar)!=true&&Char.IsNumber(e.KeyChar)==false)
    {
        e.Handled = true;
    }
}

//At key press event it will allows only the Characters and Controls.
private void txtEmpLocation_KeyPress(object sender, KeyPressEventArgs e)
{
    if (Char.IsControl(e.KeyChar) != true && Char.IsNumber(e.KeyChar) == true)
    {
        e.Handled = true;
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-10-05T04:43:50.953

//添加一个文本框选择它并转到事件和在事件列表中双击“keypress”事件。

```
 if (!char.IsLetter(e.KeyChar))
        {
            MessageBox.Show("Enter only characters");
        }
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-11T21:01:00.427

这对我有用:)

```
 private void txt_KeyPress(object sender, KeyPressEventArgs e)
    {
        e.Handled = !((e.KeyChar != 'ñ' && e.KeyChar != 'Ñ') && char.IsLetter(e.KeyChar));
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-07-01T09:05:50.223

试试[这个](http://www.freelearningdz.info/2016/06/restrict-textbox-input-c.html)代码

```
 private void textBox1_KeyPress(object sender, KeyPressEventArgs e)
    {
        e.Handled = !(char.IsLetter(e.KeyChar) || e.KeyChar == (char)Keys.Back || e.KeyChar == (char)Keys.Space);
    } 
```

# automation - 如何自动化 Photoshop？

> ID：790392
> 
> 赞同：0
> 
> 时间：2009-04-26T06:59:02.567
> 
> 标签：automation, photoshop, extendscript

我正在尝试在 Photoshop 中自动化扫描/裁剪照片的过程。我需要一次扫描 3 张照片，然后使用 Photoshop 的裁剪和拉直照片命令，该命令会创建 3 张单独的图像。之后，我想将每个新创建的图像保存为 PNG。

我查看了 JSX 脚本，它们似乎很有希望。我所描述的是否可以使用 JavaScript 或 VBScript 或其他任何东西在 Photoshop 中实现自动化？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T17:07:09.657

我实际上在 adobe 的 Photoshop 论坛上得到了答案。事实证明，Photoshop CS4 完全可以通过 JavaScript、VBScript 编写脚本，并带有一个非常出色的开发人员 IDE，它拥有您所期望的一切（调试器、监视窗口、颜色编码等）。我完全被打动了。

以下摘录供参考：

> 您可以运行以下脚本，该脚本将从现有文件夹中创建一个新文件夹，并批量拆分所有命名为 existingFileName#001.png 的文件并将它们放入新文件夹中（已编辑）

```
#target Photoshop
app.bringToFront;
var inFolder = Folder.selectDialog("Please select folder to process"); 
if(inFolder != null){
    var fileList = inFolder.getFiles(/\.(jpg|tif|psd|)$/i);
    var outfolder = new Folder(decodeURI(inFolder) + "/Edited");
    if (outfolder.exists == false) outfolder.create();
    for(var a = 0 ;a < fileList.length; a++){
    if(fileList[a] instanceof File){
        var doc= open(fileList[a]);
        doc.flatten();
        var docname = fileList[a].name.slice(0,-4);
        CropStraighten();
        doc.close(SaveOptions.DONOTSAVECHANGES); 
        var count = 1;
        while(app.documents.length){
            var saveFile = new File(decodeURI(outfolder) + "/" + docname +"#"+ zeroPad(count,3) + ".png");
            SavePNG(saveFile);
            activeDocument.close(SaveOptions.DONOTSAVECHANGES) ; 
            count++;
            }
        }
    }
};
function CropStraighten() {
    function cTID(s) { return app.charIDToTypeID(s); };
    function sTID(s) { return app.stringIDToTypeID(s); };
    executeAction( sTID('CropPhotosAuto0001'), undefined, DialogModes.NO );
};
function SavePNG(saveFile){
    pngSaveOptions = new PNGSaveOptions(); 
    pngSaveOptions.embedColorProfile = true; 
    pngSaveOptions.formatOptions = FormatOptions.STANDARDBASELINE; 
    pngSaveOptions.matte = MatteType.NONE; 
    pngSaveOptions.quality = 1; 
    pngSaveOptions.PNG8 = false; //24 bit PNG
    pngSaveOptions.transparency = true; 
    activeDocument.saveAs(saveFile, pngSaveOptions, true, Extension.LOWERCASE); 
}

function zeroPad(n, s) { 
    n = n.toString(); 
    while (n.length < s) n = '0' + n; 
    return n; 
}; 
```

访问[此处](http://forums.adobe.com/message/1939870)以获取完整的帖子。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-16T14:57:10.937

我刚刚发现这个脚本只是为我完成了工作！它会自动裁剪和拉直照片并将每个结果保存到您指定的目录。

[http://www.tranberry.com/photoshop/photoshop_scripting/PS4GeeksOrlando/IntroScripts/cropAndStraightenBatch.jsx](http://www.tranberry.com/photoshop/photoshop_scripting/PS4GeeksOrlando/IntroScripts/cropAndStraightenBatch.jsx)

将其保存到本地，然后在 PS=>File=>Command=>Browse 中运行它

PS 我在评论中发现它说脚本可以通过双击 Mac Finder 或 Windows 资源管理器直接执行。

[此处脚本的备份要点](https://gist.github.com/cyberrob/5a985bddef34b3c301b1)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T11:55:28.417

您是否尝试过使用 Photoshop 操作？我现在不关心扫描部分，但其余的都可以很容易地通过动作完成。

# c# - 在 C# 中引发外部对象的事件

> ID：790399
> 
> 赞同：8
> 
> 时间：2009-04-26T07:06:15.013
> 
> 标签：c#, .net, events, raise

如果`actions`是一个小组，我可以提出`Click`它的父母事件吗？我现在有这段代码，但`Click`事件不是方法，所以这段代码无效。
有谁知道我怎么能做到这一点？

```
actions.Click += delegate(object Sender, EventArgs e)
{
    ((Panel)Sender).Parent.Click();
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-26T07:10:03.413

不可能`event`直接从另一个提出 C# `class`（即使它是`public`）。您可以提供一个方法（具有足够的访问修饰符），`event`代表您提出 并在另一个中调用该方法`class`。

顺便说一句，这可以通过反射实现，但我认为这是一个肮脏的黑客行为。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-26T07:26:27.990

CLR 中引发事件的大多数类型都有一个受保护的 On[EventName] 方法，该方法负责引发事件。您可以使用反射“从外部”调用此受保护的方法：

```
 Control parent = ((Control)sender).Parent;
 Type parentType = parent.GetType();
 MethodInfo onClickMethod = parentType.GetMethod("OnClick", BindingFlags.Instance | BindingFlags.NonPublic);

 onClickMethod.Invoke(parent, new object[] { e }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-02-07T23:58:37.000

我使用反射和扩展方法实现了这一点，因此我可以通过调用（在这种情况下）调用 LinkLabel 点击事件：

```
var link = new LinkLabel()'
link.Text = "Some link";
link.click(); 
```

click() 方法是 C# 扩展方法：

```
 public static void click(this LinkLabel linkLabel)
{
    var e = new LinkLabelLinkClickedEventArgs((LinkLabel.Link)(linkLabel.prop("FocusLink")));
    linkLabel.invoke("OnLinkClicked", e);
} 
```

它使用另一种扩展方法来：

*   从 LinkLabel 获取私有属性（需要创建 LinkLabelLinkClickedEventArgs 对象）
*   调用 OnLinkClicked 方法（这将触发事件

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-26T07:19:09.897

根据您使用的框架，您可能不必手动调用父级、[WPF](http://msdn.microsoft.com/en-us/library/ms742806.aspx)和[ASP.NET](http://msdn.microsoft.com/en-us/library/aa719644(VS.71).aspx)上的单击事件，例如元素树上的气泡事件。

如果这不是一个选项，您可以像 Mehrdad 建议的那样做。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-26T20:20:05.713

我能想到的为什么要引发 Click 事件的唯一原因是如果您正在模拟用户输入。您是否正在开发自动测试驱动程序或类似的东西？如果是这样，可能有比使用仅测试辅助方法玷污代码更好的解决方案。 [这](http://nunitforms.sourceforge.net/)首先出现在谷歌中，我不知道它是否有任何好处。

如果您试图在应用程序本身中将此作为一种流控制，我会退后一步，看看这是否是正确的做法——它有点“闻起来很糟糕”。

# sql-server - Reporting Services 图表 - 硬编码系列

> ID：790400
> 
> 赞同：1
> 
> 时间：2009-04-26T07:08:40.250
> 
> 标签：sql-server, reporting-services, ssrs-2008

我正在开发一个包含许多简单图表的 SSRS 2008 报告。在 x 轴上，我有今年的 12 个月 - 2009 年 1 月至 2009 年 12 月。在 Y 上是一个整数值，范围从 0 到 100，以 10 为增量。我正在绘制每月发生问题的次数。所以一月的值可能是 10，二月 30 等等。

我希望有一条恒定的水平线/系列，并显示 2008 年的年平均值。因此，假设 2008 年的平均值为每月 30 期，我希望这条线显示在我的图表中。基本上，我想为该值在图表上画一条直线......我可以看到如何添加更复杂的系列，但这个看似简单的任务正在让我变得更好。

有谁知道如何做到这一点？在此先感谢，杰森

**[更新]**为了添加更多细节，我已经在数据集中提取了每一行的平均值，并将其设置为自己的系列。但是，这种方法不是绘制一条线，而是为每个月绘制单独的点。虽然这接近我想要的，但可以这么说，我需要加入这些点。该图表属于误差条（范围）种类。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T17:43:55.017

你可以使用柱/线混合图表吗？如果是这样，则向图表添加一个常量或动态目标值：

设计图表。在图表属性对话框的数据选项卡上，添加一个新数据值（例如，目标）。设置目标值（参见链接上的图 9 中的示例，该示例在所有类别中使用 100000 的恒定目标值，但您也可以动态执行此操作）。确保使用以 =（等于）开头的表达式。否则，该值不会被解释为数值。

[请参阅http://msdn.microsoft.com/en-us/library/aa964128.aspx](http://msdn.microsoft.com/en-us/library/aa964128.aspx)的 MS 图表页面上的示例

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-26T07:16:40.573

将年度平均值添加到基础查询中的每一行。仅在该值上添加数据系列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T22:25:26.293

我设法自己解决了这个问题。

正如我所提到的，我使用的是错误条形图。右键单击感兴趣的系列，我能够更改该特定系列的图表类型 - 本质上给我留下了一个包含多个图表的图表......如果你知道在哪里看特别简单 - 我没有！谢谢大家的建议。

# c++ - 使用 gdb 进行调试 - 最佳实践

> ID：790407
> 
> 赞同：6
> 
> 时间：2009-04-26T07:13:47.337
> 
> 标签：c++, makefile, gdb

我是 GDB 的初学者，我让它正常工作。但是，我想知道如何在大型项目中使用它。我有一个项目，其中使用 makefile 和 g++ 完成构建。为了让 GDB 工作，我们需要使用调试符号进行编译，对吧（g++ -g 文件）？

**问题**

1.  我是否需要在 makefile 中创建一个新目标，比如“debug”，这样我就可以像*make debug*一样进行调试构建。这是最佳做法吗？
2.  假设，我只需要调试 foo.cpp，除了构建包括 main 在内的整个程序之外，是否可以只为它生成调试符号？

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T07:41:57.953

1.  不需要，尽管您可能要考虑始终使用 -g 构建（有时，您甚至可能需要尝试调试优化的（-O1、-O2 等）代码；为什么不保留 -g？对于发布，您总是可以只需在二进制文件上运行 strip 。

2.  是的。使用 -g 仅构建该文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T07:48:59.123

我认为在大、中、小型项目中使用 gdb 并没有太大的区别。但是，对于大型项目，您必须考虑构建所需的空间量，因为调试信息会增加对象和可执行文件的大小。

1.  如果您最初低估了对整个解决方案进行调试的需要，那么您将来可能会因您的决定而受苦。无论是否有调试信息都可以完成构建总是好的，因此请仔细编写构建脚本。
2.  是的，但请考虑我之前的回答。有时问题可能来自您没有调试信息的模块。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T10:58:15.670

在我工作的大型项目中，我们总是使用最详细的调试信息进行构建（例如，'-ggdb3' 用于本地 gdb 格式或 '-gdwarf-2 -g3' 用于访问 gdb 中的宏）。

完成调试后，我们只需使用“strip”命令从二进制文件中删除所有调试信息。

```
gcc -ggdb3 blah.c -o blah
strip blah 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-26T07:38:55.247

gdb 将在没有符号的情况下工作；只是输出的用处要小得多。

1.  这是一个偏好问题。我默认在调试模式下构建所有内容，并在必要时*进行发布*。
2.  是的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-14T03:20:28.300

您始终可以将调试版本保存在某处，如果您需要重新绑定符号信息，则在调试剥离/发布版本后，您只需转到“文件/路径”，gdb 将重新读取符号那个目标。您也可以使用“symbol-file /path”来配置要绑定到剥离文件的符号信息。

# c# - OracleDependency 未触发事件

> ID：790420
> 
> 赞同：3
> 
> 时间：2009-04-26T07:28:41.543
> 
> 标签：c#, oracle, dependencies

我有一个到 ORACLE 10.2 数据库的 Oracle 连接，并且想监听对表的更改。连接的用户被授予“更改通知”权限。

使用以下方法初始化侦听：

```
private OracleDependency SubscribeToTable(string tableName)
{
  string sql = "select * from " + tableName;
  var cmd = new OracleCommand(sql, this.connection) { AddRowid = true };
  var dep = new OracleDependency(cmd);
  cmd.Notification.IsNotifiedOnce = false;
  dep.OnChange += this.dep_OnChange;
  cmd.ExecuteNonQuery();
  return dep;
} 
```

当我在观察到的表中插入一行并提交时，永远不会触发事件 dep_OnChange。我究竟做错了什么？

更新：

检查故障排除列表并发现一切正常后，我以 DBA 身份连接到 Oracle，并检查了发生更改时应通知的 IP 地址（SELECT * FROM user_change_notification_regs）。由于某种原因，ip 地址指向 VMWare 虚拟网络适配器，尽管通知请求是从物理机而不是 VM 发起的。禁用该虚拟网络适配器后，一切正常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T02:24:52.327

您是否完成了[文档](http://www.oracle.com/webfolder/technetwork/tutorials/obe/db/dotnet/changenotification/ChangeNotification.htm)中的故障排除？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-09T14:25:23.980

作为替代方案，您可以使用 oracletabledependency 组件。您可以在 Tabledependency.codeplex.com 上找到它

实例化后，您将收到修改的每个表记录的事件。

# c# - 如何反转该功能

> ID：790422
> 
> 赞同：0
> 
> 时间：2009-04-26T07:34:54.693
> 
> 标签：c#

我之前问过 Bitwise AND(&) 的反义词，你告诉我它不可能逆转。

嗯，情况是这样的：服务器发送一个图像，用我想要反转的函数编码，然后用 zlib 编码。

这就是我从服务器获取图像的方式：

```
 UInt32[] image = new UInt32[200 * 64];
        int imgIndex = 0;
        byte[] imgdata = new byte[compressed];
        byte[] imgdataout = new byte[uncompressed];

        Array.Copy(data, 17, imgdata, 0, compressed);
        imgdataout = zlib.Decompress(imgdata);
        for (int h = 0; h < height; h++)
        {
            for (int w = 0; w < width; w++)
            {
                imgIndex = (int)((height - 1 - h) * width + w);
                image[imgIndex] = 0xFF000000;
                if (((1 << (Int32)(0xFF & (w & 0x80000007))) & imgdataout[((h * width + w) >> 3)]) > 0)
                {
                    image[imgIndex] = 0xFFFFFFFF;
                }
            }
        } 
```

宽度、高度、解压后的图像和压缩后的图像长度始终相同。

完成此功能后，我将图像（UInt32 [] 数组）放入位图中，我得到了它。

现在我想成为服务器并发送该图像。我必须做两件事：

反转该函数，然后使用 zlib 对其进行压缩。

如何反转该功能以便对图片进行编码？

```
 for (int h = 0; h < height; h++)
    {
        for (int w = 0; w < width; w++)
        {
            imgIndex = (int)((height - 1 - h) * width + w);
            image[imgIndex] = 0xFF000000;
            if (((1 << (Int32)(0xFF & (w & 0x80000007))) & imgdataout[((h * width + w) >> 3)]) > 0)
            {
                image[imgIndex] = 0xFFFFFFFF;
            }
        }
    } 
```

编辑：格式为 32bppRGB

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-26T08:14:49.467

`&`算子总是不可逆的假设是不正确的。

是的，一般来说，如果你有

```
c = a & b 
```

并且您只知道 的值`c`，那么您无法知道之前的值`a`或值。`b`

`&`然而，从较长的值中*提取*某些位是很常见的，其中这些位先前与`|`运算符组合在一起，并且每个“位字段”彼此独立。与使此可逆的通用`&`或运算符的根本区别在于，原始位事先*全为零*，而单词中的其他位保持不变。IE：`|`

 *```
0xc0 | 0x03 = 0xc3   // combine two nybbles

0xc3 & 0xf0 = 0xc0   // extract the top nybble
0xc3 & 0x0f = 0x03   // extract the bottom nybble 
```

在这种情况下，您当前的功能似乎是提取每像素 1 位（单色图像）并将其转换为 32 位 RGBA。

你需要类似的东西：

```
int source_image[];
byte dest_image[];

for (int h = 0; h < height; ++h) {
    for (int w = 0; w < width; ++w) {
        int offset = (h * width) + w;
        if (source_image[offset] == 0xffffffff) {
            int mask = w % 8; // these two lines convert from one int-per-pixel
            offset /= 8;      // offset to one-bit-per-pixel
            dest_image[offset] |= (1 << mask); // only changes _one_ bit
        }
    }
} 
```

注意：假设图像是 8 像素宽的倍数，该`dest_image`数组以前全为零。我在那个内部测试中使用了`%`and`/`因为它更容易理解并且编译器*应该*转换为掩码/移位本身。通常我会自己做掩蔽和移动。

# java - 更新 jar 中的文件会引发 ZipException

> ID：790430
> 
> 赞同：8
> 
> 时间：2009-04-26T07:39:59.487
> 
> 标签：java, jar

我正在尝试使用以下命令更新现有 jar（在此示例中为 antlr）中的文件：

```
jar -uf antlrworks-1.2.3.jar org/antlr/codegen/templates/Java/Java.stg 
```

但我收到以下消息

> java.util.zip.ZipException：重复条目：antlr/ANTLRError.class at java.util.zip.ZipOutputStream.putNextEntry(ZipOutputStream.java:175) at java.util.jar.JarOutputStream.putNextEntry(JarOutputStream.java:92)在 sun.tools.jar.Main.update(Main.java:508) 在 sun.tools.jar.Main.run(Main.java:185) 在 sun.tools.jar.Main.main(Main.java:1044 )

有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-26T08:00:38.300

您正在尝试做正确的事情，但 jar 文件有问题 - 它有两次相同的条目 :( （这对于 zip 文件是合法的，但没有真正的帮助 - 正如您所看到的，它会让人`jar`抱怨。）

如果你跑

```
jar tvf antlrworks-1.2.3.jar > contents 
```

然后查看生成的`contents`文件你会看到有各种重复的文件。您可能应该将此报告给 antlr 项目（在检查他们还不知道之后）。

作为一种解决方法，您可以提取 jar 文件的内容，再次将其打包，*然后*您将拥有一个可以更新的“工作”jar 文件。（如果你只需要这样做一次，你可以提取，把你想要的文件放在那里，然后把整个文件打包起来，而不是事后更新它。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T08:06:06.883

您可以对[Ant`jar`任务](http://ant.apache.org/manual/Tasks/jar.html)执行相同的操作。

```
<jar duplicate="preserve" jarfile="...">
   your files
</jar> 
```

具有保留值的重复属性将处理重复的条目。

[如此处所述](http://www.mooreds.com/wordpress/archives/000445)，值为“preserve”的更新属性确实告诉您存在重复项，形式如下：

```
 aPath/aFile already added, skipping 
```

如果您的文件位于列表顶部，则 jar 任务必须自行选择 tp build，则将考虑您的新文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T05:19:33.577

如果您使用的是 OS X，请尝试使用[Jar Inspector](http://www.codeland.org/)应用程序。我用它来修补检票口中的 javascript 错误。您可以打开一个 jar 文件，它会列出所有内容。导航到要保存的文件（在本例中为 .js 文件）并修改文件，然后保存内容，它会为您修改 .jar 文件。不确定这是否适用于 .java 文件。

# php - 需要从数据库中获取值并使用 jQuery 填充下拉列表

> ID：790433
> 
> 赞同：3
> 
> 时间：2009-04-26T07:42:17.250
> 
> 标签：php, javascript, jquery

当我选择某个值并且需要从数据库中查询选项时，我需要填充一个下拉列表。

我可以从 jQuery 实现这一点吗？如果可以的话，我会很感激任何帮助..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T11:17:20.120

你可以用 jQuery 和 AJAX 做到这一点

```
jQuery.post('dropdownValues.php', {parameterSentToServer1:'value', param2:'value2'}, function(data){jQuery('#mydropdown option').remove(); //Remove current options
for (var option in data.results){
    jQuery('#mydropdown').append('<option value="'+option.value+'">'+option.name+'</option>');
}}, 'json'); 
```

在 dropdownValues.php 中，您需要使用 sql 查询的结果构建一个 json 对象，该对象必须采用这种格式（以便与上述脚本一起工作）：

```
echo '{results:[{value:1, name:'Option1'}, {value:2, name:'Option2'}]}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T07:46:44.090

“下拉列表”是指弹出菜单（例如`<select>`元素）吗？如果是这样，您可以按如下方式填充它：

```
var data = ["Hello World!", 42, true, "Foo"];
var select = document.getElementById("myPopupMenu");

for (var i = 0, l = data.length; i < l; i++)
{
    var option = new Option();
    option.innerHTML = data[i];
    select.appendChild(option);
} 
```

然而，这是在纯 JavaScript 中的——我不确定 jQuery 语法是什么。

史蒂夫

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T08:13:29.470

你绝对可以做到这一点。您需要使用 AJAX。

Ajax 本身就是一门学科，但基本上您要做的就是在从下拉列表中进行选择时调用 javascript 函数。javascript函数将通过Ajax从您的服务器请求一个页面，服务器将返回一小块数据，然后您可以使用（再次从Javascript）重新填充第二个下拉列表（或其他）。

谷歌搜索如何使用 Jquery 进行 Ajax。这是一个可以帮助您入门的页面： ~~[http ://www.ajaxlines.com/ajax/stuff/article/use_jquery_ajax_to_create_options_in_a_dropdown_menu.php](http://www.ajaxlines.com/ajax/stuff/article/use_jquery_ajax_to_create_options_in_a_dropdown_menu.php)~~

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-14T07:53:41.530

请注意，将每个附加`<option>`到`<select>`将重新加载每个附加的 DOM。如果您有很多选择，这可能会变得非常慢。`<select>`使用字符串中的选项构建整体然后替换现有选项会更有效。

# .net - 是否有用于运行 .net 代码的命令行界面或解释器？

> ID：790436
> 
> 赞同：1
> 
> 时间：2009-04-26T07:45:04.390
> 
> 标签：.net, read-eval-print-loop

我需要它，但不想重新发明热水。

通过示例提问，语法尽可能示例：

```
.net> load myLibrary.dll
myLibrary.dll loaded

.net> Person p "John" "Doo" 32
Instance of myLibrary.Person created (p)

.net> print p.Age
32 
```

所以我正在寻找一个命令行界面来访问程序集的公共方法和属性。（在此示例中，调用了 Person(string,string,int) 的 Ctor，然后将属性 Age 打印到控制台。）

虽然我很高兴有任何解决方案，

*   我需要源文件，所以我可以调整它们......（我非常喜欢 c#）
*   我需要它是免费和可再分发的

有任何想法吗？

更新：如果我找不到好的解决方案，我会自己编程，任何有兴趣的人都可以通过 gmail 与我联系，即 pelsen at。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-26T07:58:22.377

对于 C#（原始标签），这是“编译器即服务”将在未来版本中启用的类型。但是，您可以在单声道（提供源代码）中完成其中的一些操作 - [CsharpRepl](http://mono-project.com/CsharpRepl)。它应该打印最后一个命令的值 -与您想要的描述*不太*一样`Person`（我希望它会使用`ToString()`）。

[![CsharpRepl](https://i.stack.imgur.com/rmivb.png)](https://i.stack.imgur.com/rmivb.png)
[（来源：[mono-project.com](http://mono-project.com/files/thumb/9/96/320px-Xbyhja.png)）]

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-26T07:46:47.520

您可能想查看[Powershell](http://www.microsoft.com/windowsserver2003/technologies/management/powershell/default.mspx)，尽管据我所知没有可用的资源。语法并不完全是 C#，但它很容易上手。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-26T07:57:08.980

[F#](http://fsharp.net)有一个命令行 REPL (fsi.exe)。并且 F# 的代码可用。

（有关旧屏幕截图，请参阅[http://strangelights.com/fsharp/wiki/default.aspx/FSharpWiki/FSI.html](http://strangelights.com/fsharp/wiki/default.aspx/FSharpWiki/FSI.html)。）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-26T08:36:19.757

[IronPython](http://www.codeplex.com/IronPython)也有一个 REPL。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-26T07:47:38.330

您是否尝试过[PowerShell](http://www.microsoft.com/windowsserver2003/technologies/management/powershell/default.mspx)（以前的代号为 Monad）？它是一个基于 .NET 的 CLI，并且可以完全访问程序集，尽管它的模型与您指定的“加载程序集”过程不同。

# php - 使用 php 和 ajax 的下拉菜单

> ID：790447
> 
> 赞同：0
> 
> 时间：2009-04-26T07:50:08.933
> 
> 标签：php, ajax

一段时间以来，我一直在努力解决这个问题，但我没有得出任何结论，所以想在这里寻求帮助。问题是我得到一个空白下拉列表，而不是我应该从数据库中获取城市列表。数据库连接很好，但我的下拉列表中没有任何内容。

这就是我正在做的事情：

```
 <?php

require 'includes/connect.php'; - database connection
$country=$_REQUEST['country']; - get from form (index.php)
$q = "SELECT city FROM city where countryid=".$country;    
$result = $mysqli->query($q) or die(mysqli_error($mysqli));    
if ($result) {
?>  
    <select name="city">
    <option>Select City</option>
    $id = 0;
    <?php while ($row = $result->fetch_object()) { 
       $src = $row->city;
       $id = $id + 1;      
    ?>      
    <option value= <?php $id ?> > <?php $src ?></option>
<?php } ?>
</select>
<?php } ?> 
```

ajax 脚本是这样的：

```
 <script>
    function getXMLHTTP() { //function to return the xml http object
            var xmlhttp=false;  
            try{mlhttp=new XMLHttpRequest();}
            catch(e)    {       
  try{ xmlhttp= new ActiveXObject("Microsoft.XMLHTTP"); }
  catch(e){ try{
                    xmlhttp = new ActiveXObject("Msxml2.XMLHTTP");
                    }
                    catch(e1){
                        xmlhttp=false;
                    }
                }
            }

            return xmlhttp;
        }

        function getCity(strURL) {          
            var req = getXMLHTTP();         
            if (req) {              
                req.onreadystatechange = function() {
                    if (req.readyState == 4) {                      
                        if (req.status == 200) {                        
                            document.getElementById('citydiv').innerHTML=req.responseText;  

                        } else {
                            alert("There was a problem while using XMLHTTP:\n" + req.statusText);
                        }
                    }               
                }           
                req.open("GET", strURL, true);

                req.send(null);

            }

        }
    </script> 
```

这是我的表单代码：

```
<form method="post" action="" name="form1">
<table width="60%" border="0" cellspacing="0" cellpadding="0">
  <tr>
    <td width="150">Country</td>
    <td  width="150"><select name="country" onChange="getCity('findcity.php?country='+this.value)">
    <option value="">Select Country</option>
    <option value="1">New Zealand</option>
    <option value="2">Canada</option>
        </select></td>
  </tr>
  <tr style="">
    <td>City</td>
    <td ><div id="citydiv"><select name="city">
    <option>Select City</option>
        </select></div></td>
  </tr>

</table>
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T08:05:37.757

我认为问题在于您在哪里输出`<option>`标签。

尝试在您的`<select>`标签之间使用此代码块。

```
 <option>Select City</option>
    <?php 
       $id = 0;
       while ($row = $result->fetch_object()) { 
       $src = $row->city;
       $id = $id + 1;      
    ?>          
    <option value="<?php echo htmlspecialchars($id,ENT_QUOTES) ?>"><?php echo htmlspecialchars($src) ?></option>
<?php } ?> 
```

编辑：为了澄清，您在and变量之前没有任何`echo`语句。我作为一种习惯添加了生成正确转义的 html。`$id``$src``htmlspecialchars()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T08:04:33.797

有几件事要尝试：

1.  如果您在浏览器中手动请求 findcity.php 并使用您知道数据库中存在的城市，我会返回正确的 HTML 吗？

2.  尝试使用 FireBug 或其他 javascript 调试器，在 onreadystatechange 函数中设置断点并查看返回值是否符合预期。在函数的第一行设置断点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-02T08:58:07.037

```
<input name="acname" type="text" id="acname" value="" maxlength="9">
Account Name </p>

<select name="src">
  <option value="number"> :::: Select ::::</option>
  <option value="did">DID</option>
  <option value="tfn">TFN</option>
</select>
<span id="errmsg"></span> DID/TFN </p>

<select name="did" onchange='OnChange(this.form1.did);' >
  <option value=""> :::: Select ::::</option>
  <? $qry1 = mysql_query("SELECT * FROM ".NUMBERS." where Flag='1'") or die(mysql_error()) ;
     while($res1 = mysql_fetch_array($qry1)) {  ?>
     <option value="<?=$res1['Numbers'] ?>"><?=$res1["Numbers"]?></option>
      <? } ?>
</select> 
```

[来源](http://ftlif.com)

# asp.net - 从 Web 控制访问页面上的数据

> ID：790459
> 
> 赞同：0
> 
> 时间：2009-04-26T08:03:13.550
> 
> 标签：asp.net

我创建了一个 Web 控件，它需要来自其父页面的一些数据。
它如何访问这些数据？

**更新：**感谢您的快速解决方案，但它们对我不起作用。Visual Studio 无法将页面名称识别为类。我从定义类的地方取了名字：

```
public partial class Apps_Site_Templates_CollegesMain : cUICommonFeatures 
```

（cUICommonFeatures 继承自 System.Web.UI.Page）

但是在控制中，当我定义

```
 protected System.Web.UI.Page parentPage;
        parentPage = (Apps_Site_Templates_CollegesMain)Page; 
```

我收到一个编译错误：

找不到类型或命名空间名称“Apps_Site_Templates_CollegesMain”（您是否缺少 using 指令或程序集引用？）

我觉得我在这里遗漏了一些非常基本的东西，当我得到答案时我可能会非常尴尬，但我确实需要帮助......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T08:30:30.897

如果父页面类命名为 ParentPage，您可以在控件中执行此操作：

```
ParentPage page = (ParentPage)this.Page; 
```

然后您可以访问 ParentPage 上的属性和方法。如果您有多个页面使用相同的控件，则应使用父页面上的接口来访问页面上的属性。

```
IParentPage page = (IParentPage)this.Page; 
```

这是否回答你的问题？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T08:30:44.983

有很多方法可以做到这一点。我认为最好的方法是为数据控制需求添加一个属性，并在您的页面中设置此属性。

您也可以像这样从您的控件访问您的页面：

```
string dataYouWant = ((YourParentPageName)Page).GetData(); 
```

或者您可以将数据添加到视图状态，并从子控件中读取它。

但正如我所说，我会选择第一个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T08:34:59.433

所有控件（服务器控件、用户控件和自定义控件）都公开了一个属性，该属性`Page`允许您从控件的代码中访问包含的 Page 实例。

因此，您可以简单地执行以下操作：

```
// In Usercontrol code:
MyParentPage parentPage = this.Page as MyParentPage;
if (parentPage != null)
{
  // Access the properties of the Parent page.
  string t = parentPage.Title;
} 
```

文章“[掌握页面-用户控件通信](http://www.codeproject.com/KB/user-controls/Page_UserControl.aspx)”为初学者提供了控件-页面交互的良好介绍。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T01:40:32.057

控件的编写应与它们所在的页面无关。如果控件需要一段数据，那么它应该公开一个公共属性，该属性属于它需要的数据类型。然后它所在的页面会将该属性设置为控件需要的数据。这允许在另一个页面上使用该控件，甚至可以将其作为 UserControl 的一部分，然后在父页面上使用该 UserControl。

# asp.net-mvc - 访问 ASP.NET MVC 应用程序中的控制器/操作列表

> ID：790464
> 
> 赞同：9
> 
> 时间：2009-04-26T08:05:52.640
> 
> 标签：asp.net-mvc, reflection, controller, action

我们知道，在幕后，ASP.NET MVC 框架将使用反射来确定哪些控制器/动作可以执行，基于哪些类派生自`System.Web.Mvc.Controller`这些类，以及这些类中哪些方法返回一个`ActionResult`对象。

对于我的问题 - 是否可以从我的 MVC 应用程序中访问此控制器/操作列表？

（我可以自己做，通过对当前程序集使用反射，但如果列表已经由 ASP.NET MVC 构建，我宁愿重用这项工作，也不愿自己重新发明轮子。）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-27T01:35:11.510

`new ReflectedControllerDescriptor(typeof(TController)).GetCanonicalActions()`将返回 ActionDescriptor 对象的集合，显示控制器上的所有操作。理解诸如选择属性或命名属性之类的东西还不够聪明，因此不能保证它返回的每个操作都是可网络调用的。但如果您需要直接执行操作，您可以对您感兴趣的任何操作调用 ActionDescriptor.Execute()。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-26T08:16:29.073

这是在程序集中的一个名为的`internal`类中完成的。`System.Web.Mvc``System.Web.Mvc.ControllerTypeCache`

顺便说一句，操作方法不需要返回`ActionResult`。例如，他们可以`void`愉快地返回。

# javascript - 是否可以在一页上使用多个 AJAX 库？

> ID：790466
> 
> 赞同：0
> 
> 时间：2009-04-26T08:08:26.173
> 
> 标签：javascript, ajax, open-source

我只是好奇。有许多现成的 AJAX 库，例如[Mootools](http://mootools.net/)、[Scriptaculuos](http://script.aculo.us/)、[Prototype](http://www.prototypejs.org/)、[YUI](http://developer.yahoo.com/yui/)等

我的问题是，是否可以将它们结合起来？如果我下载所有代码并将它们放在同一页面上，会导致错误吗？

您会向初学者推荐哪个开源 AJAX 库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T00:41:49.953

如果您在后端使用Java，[ZK 框架](http://www.zkoss.org/)声称提供完整的AJAX 功能，即无需混合和匹配一堆不同的库。从我到目前为止所做的测试来看，他们似乎是对的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T08:18:30.970

当然，但就像任何时候你组合框架一样，你会发现有时你必须编写自己的胶水代码。对于初学者来说，只使用一个可能更简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T08:43:16.810

这取决于您使用的框架的选择。如果他们试图定义相同的变量，那么其中一个将覆盖另一个的部分。[jQuery](http://jquery.com/)通过定义核心函数的别名来避免这种情况，因此它有两个名称，而[YUI](http://developer.yahoo.com/yui/)则通过首先没有[爆破的美元函数](http://blog.dorward.me.uk/2009/02/19/the-dollar-function-must-die.html)来避免这种情况。

库往往相对较大，因此您可能应该避免使用多个库，而不是其他任何东西。

使用两个不同的库很少有用 - 主要原因是希望使用依赖于不同库的多个第三方模块。在这种情况下，我会尝试找到使用所选库的替代方案。

> 您使用什么开源 ajax 代码？

YUI 通常。它是健壮的、经过良好测试的、有据可查的且功能强大的——尽管学习曲线的初始部分比其他一些更陡峭。

但是，将其称为“ajax 代码”是一种伤害——Ajax 只是这些库中的一小部分。

> 你会向 ajax 初学者推荐什么？

优。

> 有哪些 ajax 特性可以打动人？

这取决于人们是谁。很多人会对能够快速产生滑动、渐变、旋转动画效果印象深刻……但它们并不是那么有用。一个好的事件处理系统不会做任何会让外行人印象深刻的事情，但它会让程序员更容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-26T11:27:15.183

我推荐你使用 jQuery 框架，因为在我看来它是 AJAX 最好和最容易理解的实现之一。

一个例子：

```
 jQuery.post('thescript.php', parametersInJson, function(response){
        alert('The server response: '+response);
    }); 

```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T00:54:54.943

是的，你可以，但你可能会遇到一些麻烦（你可能需要[覆盖 $ 函数](http://docs.jquery.com/Using_jQuery_with_Other_Libraries)......）

我推荐 jQuery

# c - shell 加密程序如何使用更少的用户时间？

> ID：790475
> 
> 赞同：2
> 
> 时间：2009-04-26T08:18:31.877
> 
> 标签：c, profiling

**更新2：**

移植到 autotools 并上传到[SourceForge](https://sourceforge.net/projects/shellcrypt/)。

**更新：**

我将对此进行一些更严格的测试，但我相信这个问题与缓存有关，两个测试用例的排序可能很重要。另外我知道加密是可悲的，在两个文件中重复，并且代码低于初稿质量。我也知道我应该使用 makefile 等。我不建议在任何地方使用它。我把它拼凑起来并简化了它，以尽可能地从其他人那里获得最好的输入。

**原始问题：**

我完全被难住了。我根据[前面的问题](https://stackoverflow.com/questions/728706/recommendations-for-encrypting-decrypting-scripts-elegantly)创建了一个包装器来加密 shell 脚本，它运行良好；然而，在确定它的性能问题时，加密脚本需要更少的用户时间！你能帮我解释一下吗？我只是不明白。我已将所有内容简化为基础并尽可能简化。如果你拿起我的文件，你将必须拥有文件 /usr/bin/shelldecrypt 的写权限。

```
    ojblass@XXXXX:~/source/shellcrypt>./build
    ojblass@XXXXX:~/source/shellcrypt>./run

    example.sh.bin 已加密运行它以查看输出
    ojblass@XXXXX:~/source/shellcrypt>./profile
    例子.sh
    实际0m0.107s
    用户 0m0.048s
    系统 0m0.052s

    例子.sh.bin
    实际0m0.118s
    用户 0m0.036s
    系统 0m0.068s
    ojblass@XXXXX:~/source/shellcrypt>

```

**[建造]**

```
    gcc shellencrypt.c
    mv a.out shellencrypt
    gcc shelldecrypt.c
    mv a.out shelldecrypt
    cp shelldecrypt /usr/bin

```

**[例子.sh]**

```
    #!/bin/bash
    ls -lt >> /dev/null
    ls -lt >> /dev/null
    ls -lt >> /dev/null
    ls -lt >> /dev/null
    ls -lt >> /dev/null
    ls -lt >> /dev/null
    ls -lt >> /dev/null
    ls -lt >> /dev/null
    ls -lt >> /dev/null
    ls -lt >> /dev/null
    ls -lt >> /dev/null
    ls -lt >> /dev/null
    ls -lt >> /dev/null
    ls -lt >> /dev/null
    ls -lt >> /dev/null
    ls -lt >> /dev/null
    ls -lt >> /dev/null
    ls -lt >> /dev/null

```

**[轮廓]**

```
    回声示例.sh
    时间例子.sh
    回显示例.sh.bin
    时间例子.sh.bin

```

**[跑]**

```
    rm -rf example.sh.bin
    ./shellencrypt example.sh
    chmod 755 example.sh.bin
    echo example.sh.bin 已加密运行它以查看输出

```

[shelldecrypt.c]

```
#include        <stdio.h>
#include        <stdlib.h>
#include        <string.h>
#include        <limits.h>
#include        <unistd.h>
/* #define DEBUG */
static int    flip( int a)
{
        int b;
        b = a;
        b ^= 0x000C;
        return b;
}

static void    trace ( char * szMessage )
{
#ifdef DEBUG
     if (szMessage != NULL)
     {
       printf("DEBUG Message %s\n",szMessage);
     }
#endif
    return;
}

int     main(int argc, char     *argv[]) {

        FILE    *fp = NULL;
        int     ch=(char) 0;
        int     foundnl=0;
        char    shellpath[4096]; /* what happened to PATH_MAX? */
        char    *ptest;
        FILE    *pipe = NULL;

        /* TODO REMOVE memset(bangline, 0, sizeof(bangline)); */

        trace("STARTING");
        trace(argv[0]);
        trace("ARGUMENT");

        /* get the shell environment variable */
        ptest = getenv("SHELL");
        if (ptest == NULL)
        {
            trace("could not get shell environment variable");
            return (EXIT_FAILURE);
        }
        else
        {
            strcpy(shellpath, getenv("SHELL"));
            trace(shellpath);
        }

        if ((argc >=1) && (argv[1]!=NULL))
        {
            trace(argv[1]);
        }
        else
        {
            trace("(null)");
        }

        if (argc == 2) {
                fp = fopen(argv[1],"r");
                if (fp == NULL) {
                        fprintf(stderr,"Unable to open file %s. Exiting.\n",argv[1]);
                        exit(EXIT_FAILURE);
                }
        }
        else
        {
               printf("Usage: %s <filename>\n",argv[0]);
               exit (EXIT_SUCCESS);
        }

        /* strip out the bangline which is not encryped */
        while ((ch = fgetc(fp)) != EOF) {
              if (ch == 10)
              {
                 foundnl = 1;
                 break;
              }
        }

        if (foundnl!=1)
        {
           (void) fclose(fp);
           trace("FOUND NO NEWLINE BEFORE END OF FIRST LINE");
           return (EXIT_SUCCESS);
        }

        pipe = popen(shellpath, "w");
        if (pipe == NULL)
        {
            trace("popen failed");
            (void) fclose(fp);
            return (EXIT_FAILURE);
        }
        else
        {
            trace("writing string to pipe");

            while ((ch = fgetc(fp)) != EOF) {
               (void) fputc(flip(ch),pipe);
            }
/*            (void) fputc(EOF,pipe); */
        }

        if (pipe != NULL)
           (void) pclose(pipe);
        if (fp != NULL)
           (void) fclose(fp);
        exit (EXIT_SUCCESS);
} 
```

[shellencrypt.c]

```
#include        <stdio.h>
#include        <stdlib.h>
#include        <string.h>

static int    flip( int a)
{
        int b;
        b = a;
        b ^= 0x000C;
        return b;
}

int     main(int argc, char     *argv[]) {

        FILE    *fp = NULL, *fpOut=NULL;
        int             ch;

        char szOutputFileName[2000];
        strcpy(szOutputFileName,"");

        if (argc == 2) {
                fp = fopen(argv[1],"r");
                if (fp == NULL) {
                        fprintf(stderr,"Unable to open file %s. Exiting.\n",argv[1]);
                        exit(EXIT_FAILURE);
                }
        }
        else
        {
               printf("Usage: %s <filename>\n",argv[0]);
               exit (EXIT_SUCCESS);
        }

        strcpy(szOutputFileName, argv[1]);
        strcat(szOutputFileName, ".bin");

        fpOut = fopen(szOutputFileName,"wt");
        if (fpOut == NULL)
        {
             fprintf(stderr,"Unable to open file %s.  Exiting.\n",szOutputFileName);
             if (fp)
                 (void) fclose(fp);
             exit(EXIT_FAILURE);
        }

        /* print the header */
        fprintf(fpOut,"#!/usr/bin/shelldecrypt\n");

        /* read until the end of file, encrypting characters and writing them out to target file */
        while ((ch = fgetc(fp)) != EOF) {
              (void) fputc(flip(ch),fpOut);
        }
        if (fp)
           (void) fclose(fp);
        if (fpOut)
           (void) fclose(fpOut);

        return(EXIT_SUCCESS);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-26T08:54:56.063

这不是一个足够显着的差异，我会得出结论有任何影响。更好的“个人资料”是：

```
#!/bin/bash

echo example.sh
/usr/bin/time sh -c 'for i in $(seq 1 1000); do ./example.sh; done'

echo example.sh.bin
/usr/bin/time sh -c 'for i in $(seq 1 1000); do ./example.sh.bin; done' 
```

在我的机器上，我得到：

```
example.sh
39.46user 33.22system 1:16.92elapsed 94%CPU (0avgtext+0avgdata 0maxresident)k
0inputs+0outputs (0major+8547221minor)pagefaults 0swaps
example.sh.bin
42.33user 42.13system 1:33.98elapsed 89%CPU (0avgtext+0avgdata 0maxresident)k
0inputs+0outputs (0major+9376313minor)pagefaults 0swaps 
```

这还不足以*明确*表明“加密”的速度较慢（尽管我显然认为是这样），但它肯定表明，在简单的基准测试中，加密*并不会始终花费更少的用户时间。*

此外，您的代码还有一些其他严重问题。最明显的是，这并不接近于声音加密。正如其他人所说，您正在错误地解决问题。您“在几个小时内”提出的加密算法并不能替代合理的权限。

此外，您需要使用 makefile 而不是增加不必要的 shell 脚本。学习基本的 gcc 选项，例如 -o。不要试图复制到 /usr/bin/ 除非用户运行安装目标（在这种情况下 /usr/local/bin 会更好）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T08:49:28.183

我怀疑这基本上表明加密不是这个特定脚本性能的重要组成部分。

然而，让文件系统*第一次*加载目录的内容是很重要的。一旦加载，它可能会被缓存。这可以解释为什么你第一次运行两者时，无论哪个先执行都会变慢。之后，它们可能非常相似，使用文件系统缓存。

如果您重新启动（以确保您正在清除缓存）并以相反的方式运行它，我希望加密版本需要更长的时间，因为它将进入磁盘而不是缓存。

# sharepoint - 使用来自 alist 的 CAML 查询获取最大日期

> ID：790477
> 
> 赞同：3
> 
> 时间：2009-04-26T08:21:51.180
> 
> 标签：sharepoint, caml

如何从列表日期列中获取最大日期和最小日期

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T10:36:23.807

蛮力方法是创建两个查询，它们将检索按日期 asc 和 desc 排序的列表内容。我知道这很糟糕，但至少你可以继续你的项目并稍后完善查询。

如果有可能检索到前 1 名，那么它甚至可以在生产中工作。

# vim - 我只是无法弄清楚 VIM 中的项目插件

> ID：790478
> 
> 赞同：13
> 
> 时间：2009-04-26T08:23:14.157
> 
> 标签：vim, plugins, text-editor, project

我正在尝试使用 VIM 进行一些编程。我是 VIM 的初学者。你们能帮我弄清楚[项目插件吗](http://www.vim.org/scripts/script.php?script_id=69)

我无法理解文档。如果你使用过这个插件，你能告诉我入门的基本步骤吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-26T11:04:42.710

为了配置项目插件，您必须编辑 .vimprojects 文件。帮助中给出了一个例子

```
:help project-example 
```

如您所见，您必须编写类似这样的内容

```
Name_of_project = path/to/your/project CD=. flags=flags_you_want{
  file1
  file2
  ...

  Name_of_Subcategory = path/to/your/subcategory filter=files_you_want{
   subcategory_file1
   subcategory_file2
   ...
  }
} 
```

现在您可以调用您的项目：

```
:Project 
```

这将打开一个带有您刚刚配置的文件的垂直窗口。单击您添加的任何文件以将其打开。

对于标志和过滤器，所有内容都在帮助文件中进行了解释。还有其他的微妙之处你必须自己去发现。我希望这能帮到您。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-10-28T20:45:32.170

You can also have the plugin generate the file for you: invoke `:Project` in normal mode, and then hit `\C` which will prompt you for the name of the project, the directory of the project (i.e., ~/Projects/Foobar if ~/Projects/Foobar contains all your code, et cetera), the `cd` parameter (always the same as the directory, for me) and a standard file filter (`*.cpp` or what have you).

You can then write this projects file out with `:w filename` and load it later on.

# c# - 检索多个结果集

> ID：790483
> 
> 赞同：-1
> 
> 时间：2009-04-26T08:30:28.773
> 
> 标签：c#, .net, linq-to-sql

我从多个结果集中获取数据后出现问题我更新数据并将其保存并在 Sql 中更新，但是当我再次检索它时，它会带来旧数据我能做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-26T08:37:17.913

您没有提供很多线索，您是如何执行此操作的，以及您是如何进行保存的（这可能很重要）。但是，这里的一个常见问题是使用作为项目一部分的本地数据库文件。如果项目说“始终复制”，那么每次构建它时，数据库都会从未更改的状态重新写入。

如果这不是问题 - 您是否可能让交易处于开放状态？

（编辑）现在我们已经确定您正在使用 LINQ-to-SQL；你在打电话`SubmitChanges()`吗？了解您使用的是单个数据上下文、多个数据上下文还是什么也将有所帮助？数据上下文只会跟踪它创建的对象的变化。

# php - PHP 从函数调用函数

> ID：790486
> 
> 赞同：0
> 
> 时间：2009-04-26T08:30:51.377
> 
> 标签：php

什么是 PHP 代码会先做一件事，然后再做第二件事。

第一个：我想要 $_GET 一个变量，然后对其运行查询并返回变量。

接着

第二：在查询中使用那些“其他”变量。

我想我想用两个函数来做到这一点 b/c 我的查询基于我从表单发送的值。所以它必须从 url 中获取值，然后运行查询。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-26T08:34:56.843

```
$variables = $_GET['variable'];

mysql_query("SELECT * FROM `table` WHERE `field` = '".mysql_real_escape_string($variables)."' LIMIT 20"); 
```

你想要上面的东西吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T09:07:39.527

是的，通常您可以从任何其他方法中调用任何方法（= 函数）。

```
function getVars($vars)
{
    foreach ($vars as $key => $value)
    {
        doSomethingWithMyVars($key, $value)
    }
}

function doSomethingWithMyVars($key, $value)
{
    $sql = 'SELECT this, that FROM mytable WHERE '.$key.' = '.$value;
    //get data
}

getVars($_GET); 
```

但请注意，这只是示例代码，您可能不会那样做。该查询也不适用于字符串。这只是一个示例，说明如何根据您的任务似乎或多或少从函数内部调用函数。

# sql-server - 找不到定位行？

> ID：790493
> 
> 赞同：2
> 
> 时间：2009-04-26T08:39:29.830
> 
> 标签：sql-server, delphi, sql-server-2005, ado, advantage-database-server

我正在使用 D2009、dbGo (ADO) 将现有的 Advantage 数据库服务器应用程序转换为 SQL Server 2005。有时我会遇到错误`row cannot be found for locating`。我用谷歌搜索了它，根据我需要设置每个 ADOTable 的更新标准属性并将光标位置设置为动态的结果。我这样做了，但有时我仍然会遇到同样的错误。所有的表都有主键，所以我一直在使用

```
Query.Requery(); 
Query.Locate('ID',ID,[]); 
```

在更新记录之前避免错误，但必须有更好的解决方案。有任何想法吗？还是我应该继续使用 MyDAC 或 Zeoslib？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T12:17:03.720

dbGO/ADO 是访问 MS-SQL 数据库的自然方式。你确定这是确切的错误信息吗？因为我从来没有听说过它，但是我听说过“无法**定位**更新**行**”。

该错误消息表明 ADO 找不到要删除或更新的记录。最常见的原因是表没有定义主键，或者表中至少没有列的内容都是唯一的。

确保在 MS-SQL 表中定义主键。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T08:37:44.847

如果其他人在使用触发器时遇到同样的问题，请将 SET NOCOUNT ON 添加到触发器的开头，将 SET NOCOUNT OFF 添加到触发器的末尾。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T12:47:08.687

无法更新行的通常情况是您对表有默认值约束。请务必为 OnNewRecord 中的字段设置值。您可能还想使用 myAdoDataset.Properties['Update Criteria'].Value := 0; 然后 ADO 应该只使用密钥进行更新。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-26T07:34:36.357

简单的 adotable1.refresh; 发布后应该可以解决问题...

# c++ - 您遇到过的最出色的模板用途是什么？

> ID：790494
> 
> 赞同：3
> 
> 时间：2009-04-26T08:40:31.043
> 
> 标签：c++, templates

我们都知道通常使用模板来设计容器，并且我们都知道您可以使用模板做一些让您头晕目眩的事情。

当我第一次遇到静态多态性时，我真的很惊讶你可以用模板做什么。很明显，模板不仅仅用于设计容器。我买了 Andrei 的“现代 C+ 设计”，但遗憾的是还没有时间或精力去阅读它，但我确信它提供了丰富的模板用法。

恕我直言[，这](https://stackoverflow.com/questions/731832/interview-question-ffn-n/733474#733474)也是一个非常聪明的模板使用。

你遇到过的最巧妙的模板用法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-26T08:56:02.707

[Boost`foreach`由其作者解释。](http://www.artima.com/cppsource/foreach.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-26T09:11:58.767

[boost 的 Spirit](http://spirit.sourceforge.net/distrib/spirit_1_8_5/libs/spirit/doc/quick_start.html)元编程，用于创建解析器的语法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-26T09:37:04.947

使用模板特化[编译时断言。](http://my.safaribooksonline.com/0201704315/pref01#snippet)我认为模板的使用如此简单，但又如此美丽。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-26T13:02:56.670

Alexandrescu 在模板方面的工作令人着迷。[Loki](http://sourceforge.net/projects/loki-lib/)库充分展示了他可以用模板编织的魔力。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-26T13:13:56.673

我更喜欢微软的“智能指针”，它精心使用模板来使 COM 不再像猪一样，代码也更易读。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-13T02:36:15.820

我不记得库名称，但想法是使用由整数参数化的模板类型，以便在执行物理量计算时执行一致性时强制执行一致性。这个概念很简单，采用一个简单地嵌入双精度浮点数的模板类型。参数化为三个整数，一个代表质量，一个代表距离，一个代表时间。例如速度是距离参数 = 1 和时间参数 = -1。加速度是距离参数 = 1，时间参数 = -2。然后重载所有的运算符，这样你就只能加减具有相同参数的类型，并且你在做产品时对参数求和。所以如果velocity是Type<1,-1,0>并且时间是Type<0,1,0>，那么velocity x time是Type<1+0,1+-1,0+0>，所以velocity*time -> 距离。

Not only it is smart but it is one of the very few examples of a good use of templates with parameters other than typename

# .net - 在哪里可以找到 .NET 版本使用统计信息？

> ID：790499
> 
> 赞同：18
> 
> 时间：2009-04-26T08:43:50.427
> 
> 标签：.net, statistics, version

有一些像 LINQ 和 WPF 这样的技术很好，但是 .NET 3.5 的安装仍然是一个缓慢的过程。了解这一点很重要 - 在 Windows 用户中，有多少人安装了 .NET 3.5？

**是否收集了有关 .NET版本**可用性/使用情况的最新统计数据？我搜索了很多，但找不到。

**更新：** .NET 版本至少存在于 FF 和 IE 的网络代理字符串中。所以应该有人知道这些信息。**任何人都可以访问非常大的网站日志？**

**更新 2：**我也理解 Vista 意味着用户拥有 3.5，但 XP 仍然占据市场主导地位。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-05-26T12:51:33.333

您可以在此处获取统计信息：http: [//www.statowl.com/microsoft_dotnet.php](http://www.statowl.com/microsoft_dotnet.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T09:03:14.450

[Scott Wiltamuth 的 Visual Studio 博客](http://blogs.msdn.com/scottwil/archive/2005/03/09/391199.aspx)包含 2005 年的一些数据。显然对 3.5 数据没有帮助，但可能是一个开始。

我还从 2008 年的论坛帖子中发现了这一点：

> 例如，通过分析网站的日志，我发现在所有使用 Vista/XP/2000 的访问者中，只有 51% 使用 .NET 2.0，只有 13% 使用 .NET 3.0

像这样的有价值的数据似乎真的很短缺。一周前有人问我有多少百分比的 Vista 安装是 64 位的，我只能找到[这篇文章](http://itmanagement.earthweb.com/entdev/article.php/11070_3782171_1/Windows-7-May-Trigger-64-bit-OS-Adoption.htm)，基本上说数据不可用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-11-07T12:52:28.993

还有另一个[统计数据，日期为 2010 年 1 月](http://www.hanselman.com/blog/HowManyPCsInTheWorldHaveTheNETFrameworkInstalled.aspx)，由 Scott Hanselman 发表。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-08-31T20:14:13.223

来自 Nemo Documents 的 [2011 年 1 月和 4 月的统计数据。](http://www.nemo-docs.com/blog/usage-statistics/)[Stat Owl](http://www.statowl.com/microsoft_dotnet.php)也有一些数据。

# perl - 如何在 Perl 中禁用自动生存？

> ID：790516
> 
> 赞同：8
> 
> 时间：2009-04-26T09:00:27.390
> 
> 标签：perl, autovivification

假设您有一个由一个大团队“开发”的巨大应用程序；）。这是当有人检查数据结构过深时可能发生的潜在灾难的简化模型。如果无法完全或在范围内禁用自动验证，如何解决这个问题？非常感谢你 ：） ！！！！

```
use strict; use warnings;use Data::Dumper;

my $some_ref = {akey=>{deeper=>1}};
print Dumper($some_ref );
if($some_ref->{deep}{doot} == 1){
    print 'too deep '.$/;
}

if($some_ref->{deep}){
    print 'Already in a deep doot'.$/;
}

print Dumper($some_ref ); 
```

这将输出以下内容：

```
$VAR1 = {
          'akey' => {
                      'deeper' => 1
                    }
        };
Use of uninitialized value in numeric eq (==) at autovivify_test.pl line 5.
Already in a deep doot
$VAR1 = {
          'deep' => {},
          'akey' => {
                      'deeper' => 1
                    }
        }; 
```

是的，我知道有警告，但是……可能为时已晚。

说我的 hashref 引用了一个绑定的 HASH 会有所帮助。

可能如果我实现一个好的 FETCH 方法来检查结构中更深的检查，我会轻松解决我的问题吗？

* * *

我查看了[Tie::StrictHash](http://search.cpan.org/%7Ekvail/Tie-StrictHash-1.0/StrictHash.pm)、[Tie::Hash](http://perldoc.perl.org/5.8.8/Tie/Hash.html)和[perltie](http://perldoc.perl.org/perltie.html#Tying-Hashes)。这是我的解决方案的简化版本：

```
#!/usr/bin/env perl;
#test_tie.pl

package StrictHash;
use strict; use warnings;
use Tie::Hash;
our @ISA = qw(Tie::StdHash);
use Carp;

sub TIEHASH {
    my $class = shift;
    my $hash = bless {@_}, $class;
    return $hash;
}
##========================================================================
## FETCH fails if applied to a member that doesn't exist.
##========================================================================
sub FETCH {
    my ($hash, $key) = @_;
    Carp::confess "key '$key' does not exist" unless exists $hash->{$key};
    return $hash->{$key};
}
##========================================================================
package main;
use strict;use warnings;use Data::Dumper;
#Imagine StrictHash is in ./StrictHash.pm
#use StrictHash;
my %hash;
tie %hash, 'StrictHash', akey => {deeper=>1} ;  

my $some_ref =\%hash;
print Dumper($some_ref );
if($some_ref->{deep}{doot} == 1){
    print 'too deep '.$/;
} 
```

我实现的是只触摸应用程序中的一个地方。现在所有像 if($some_ref->{deep}{doot}) 这样的地方都会导致堆栈跟踪死亡。所以我会很容易地找到它们并纠正它们。而且这种新的著作是不可能的。Perl 也适用于大型应用程序，您只需要了解更多；）。

谢谢你们！我希望这对其他人也有帮助。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-07-10T13:24:44.113

相对较新的是[`autovivification`](https://metacpan.org/pod/autovivification)模块，它可以让你这样做：

```
no autovivification; 
```

很简单。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-04-26T09:29:42.110

您可能想要使用对象而不是哈希（请参阅[Moose](https://metacpan.org/module/Moose)）或使用[严格绑定的哈希](http://search.cpan.org/~kvail/Tie-StrictHash-1.0/StrictHash.pm)。或者，如果您真的想要，您可以将警告变成错误：

```
use warnings NONFATAL => 'all', FATAL => 'uninitialized'; 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-26T10:22:02.127

[您可以使用Hash::Util](http://search.cpan.org/perldoc?Hash::Util)（核心模块）中的函数之一锁定哈希。

```
use Hash::Util qw( lock_keys unlock_keys );

my $some_ref = { akey => { deeper => 1 } };
lock_keys %$some_ref;

print "too deep" if $some_ref->{deep}{shit} == 1; 
```

现在最后一条语句将抛出异常：

```
Attempt to access disallowed key 'deep' in a restricted hash 
```

当然，不利的一面是，在检查散列中的键以避免异常时，您必须非常小心，即`if exists ...`在访问它们之前使用 " " 的 lof 来检查键。

如果您稍后需要再次将密钥添加到哈希中，您可以解锁它：

```
unlock_keys %$some_ref;
$some_ref->{foo} = 'bar'; # no exception 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-26T10:42:26.070

我赞成[@zoul](https://stackoverflow.com/questions/790516/how-do-i-disable-autovivification-in-perl/790549#790549)，但你应该更进一步。

**编写测试**

你应该用测试覆盖你的代码，你应该运行其中一些测试

```
use warnings FATAL => 'uninitialized'; 
```

在测试用例本身中声明。这是解决您对开发人员未正确检查事物的担忧的唯一方法。确保他们的代码经过测试。

更进一步，让您可以轻松地在[Devel::Cover](http://p3rl.org/Devel::Cover)下运行测试以获得覆盖率报告。

```
cover -delete
PERL5OPT='-MDevel::Cover' prove -l 
cover -report Html_basic 
```

然后检查测试正在执行的代码行和语句，否则使这些警告致命只会使代码在以后的意外时间死亡。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-27T15:11:01.237

另一种选择是使用[Data::Diver](http://search.cpan.org/dist/Data-Diver/Diver.pm)来访问您的数据结构。

```
if( 1 == Dive($some_ref, qw/ deep structures are not autovivified now / )) {
    Do_Stuff();
} 
```

# php - 需要从表中获取数据，然后使用该数据进行查询

> ID：790521
> 
> 赞同：1
> 
> 时间：2009-04-26T09:04:44.730
> 
> 标签：php, function

我想编写一个调用另一个函数的 PHP 函数

第 1 页。用户从下拉列表中选择项目。

（然后我发布到同一页面。）

第 1 页。（我在页面上有一个基于所选项目的查询）（在这种情况下，我将返回项目的纬度和经度。）

$latitude = $row_farms['lat']; $longitude = $row_farms['long'];

然后

（在同一页面上 - 我正在尝试使用先前查询的数据在另一个表上运行另一个查询）

我希望这是有道理的。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T09:33:55.470

那么，您想在同一个 PHP 页面的“页面”之间传递参数吗？

好吧，全局 $_REQUEST 数组是你的朋友，除非我不理解你的问题（顺便说一句，这不是一个问题）。你的 URL 是 example.php?lat=xxx&long=yyy，你用 $_REQUEST['lat'] 和 $_REQUEST['long'] 在你的脚本中提取那些，如果你也想要一个“寻呼机”，您可以执行与 $_REQUEST['page'] 中相同的操作。

但是我很难理解您真正遇到的问题，所以如果您可以添加或编辑信息，希望有一些代码，那就太好了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T09:34:16.263

假设您已全局声明数据库连接（在您的函数之外），您可以执行以下操作：

```
function get_data()
{
   global $con;

   // Run first query, get data

   second_function($latitude, $longitude);
}

function second_function($latitude, $longitude)
{
   global $con;

   $result = mysql_query("SELECT * FROM other_table WHERE `lat`={$latitude} AND `long`={$longitude}");

   // Process result
} 
```

# web-services - Mono2.0.1中的Web方法响应格式

> ID：790524
> 
> 赞同：1
> 
> 时间：2009-04-26T09:08:19.010
> 
> 标签：web-services, json, mono, asmx

我写了一个 [WebMethod]，它返回一个存储序列化对象的字符串

```
[WebMethod]
public string doStuffs() {
...
return JavaScriptConvert.SerializeObject(myObj); 
// JSON Serializer library is JSON.NET 1.3.1, for MONO
} 
```

当我使用来自 JQuery 的 $.post 调用该方法时：

```
 $.ajax({
    type: "POST",
    url: "/web/doStuffs",
    data: "{}",
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function(msg) {
      // Do stuffs
    }
  }); 
```

问题在于反应。这是我得到的：

```
<?xml version="1.0" encoding="utf-8"?>
<string xmlns="http://localhost:8080/papi">{
 "field1" : "value1", "field2 : "value2", etc etc}</string> 
```

为什么 JSON 响应被封装在 XML 中？我可以从 HTTP 响应标头中看到（错误地？）设置为：

```
Content-Type text/xml; charset=utf-8 
```

如何切换响应内容类型？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-02T02:52:04.387

AFAIK WebMethods 返回由 ASP.NET 自动序列化的对象。默认序列化程序是 SOAP，因为它曾经是 Web 服务的预期格式。

但是，System.Web.Extensions 中的 ASP.NET AJAX 具有使用 JSON 序列化程序的替换处理程序。请参阅[http://vampirebasic.blogspot.com/2009/04/aspnet-ajax-in-mono.html](http://vampirebasic.blogspot.com/2009/04/aspnet-ajax-in-mono.html)了解如何注册它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T12:04:16.670

如果我做：

```
$.post(
    "/web/doStuffs",
    { username: $("#username").val() },
    function(data){
      var obj = $(data).children();
    },           
    "xml"
); 
```

我将在 var obj 中准备好 JSON，以便用 JS 进行解析。这应该运作良好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-20T12:08:33.607

Mono 是否支持[DataContractJsonSerializer](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.json.datacontractjsonserializer.aspx)？

更新：[看起来是这样](http://www.mail-archive.com/mono-bugs@lists.ximian.com/msg59844.html)，但也许有错误？

# .net - 如何在 .NET 中找到路径分隔符？

> ID：790525
> 
> 赞同：9
> 
> 时间：2009-04-26T09:08:43.423
> 
> 标签：.net

路径分隔符是否有一些内置常量（即\ vs /）

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-26T14:33:57.277

System.IO.Path 为此目的有两个只读字段：

*   [Path.DirectorySeparatorChar](http://msdn.microsoft.com/en-us/library/system.io.path.directoryseparatorchar.aspx)：在 Windows 上包含“\”，在 UNIX 上包含“/”
*   [Path.AltDirectorySeparatorChar](http://msdn.microsoft.com/en-us/library/system.io.path.altdirectoryseparatorchar.aspx)：在 Windows 上包含“/”，在 UNIX 上包含“\”

然后还有两个额外的字段用于卷分隔符和路径分隔符：

*   [Path.VolumeSeparatorChar](http://msdn.microsoft.com/en-us/library/system.io.path.volumeseparatorchar.aspx)：用于将卷名/驱动器号与路径的其余部分分开的字符（Windows 上的“:”，UNIX 上的“/”）
*   [Path.PathSeparator](http://msdn.microsoft.com/en-us/library/system.io.path.pathseparator.aspx)：用于分隔多个路径的字符（';'）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-26T09:10:33.700

System.IO.Path 有这些信息。

[http://msdn.microsoft.com/en-us/library/system.io.path.directoryseparatorchar.aspx](http://msdn.microsoft.com/en-us/library/system.io.path.directoryseparatorchar.aspx)

# asp.net-mvc - ASP.NET、MVC 和动态数据

> ID：790528
> 
> 赞同：1
> 
> 时间：2009-04-26T09:10:40.003
> 
> 标签：asp.net-mvc, dynamic-data

ASP.NET MVC 会支持动态数据或其他一些脚手架方式吗？我知道 MVC Web 应用程序支持从 linq 上下文（以及我认为的实体）构建 CRUD 页面。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T19:44:08.317

此后，动态数据已作为 Html.DisplayFor、[Html.EditorFor](http://msdn.microsoft.com/en-us/library/system.web.mvc.html.editorextensions.editorfor%28v=vs.100%29.aspx)和[MVC EditorTemplates](http://coding-in.net/asp-net-mvc-3-how-to-use-editortemplates/)被吸收到 ASP.Net MVC 中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-10-31T18:40:24.597

Scott Hanselman 有一个关于让这些技术并行运行的页面。

查看：[ASP.NET WebForms 和 ASP.MVC 以及 ASP.NET Dynamic Data Side By Side](http://www.hanselman.com/blog/PlugInHybridsASPNETWebFormsAndASPMVCAndASPNETDynamicDataSideBySide.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T22:57:23.400

MVC 支持是[Dynamic Data Futures](http://www.codeplex.com/aspnet/Release/ProjectReleases.aspx?ReleaseId=15459)项目的一部分。这最初是在 2008 年 7 月发布的。它有点错误，因为它是一个旨在产生反馈的早期版本，但底线是他们正在努力。

# php - php数组帮助。获取正确的内容

> ID：790532
> 
> 赞同：0
> 
> 时间：2009-04-26T09:13:50.637
> 
> 标签：php

我有一个像这样的数组：

```
Array
(
    [level] => Array
        (
            [0] => Array
                (
                    [lvlName] => name
                    [lvlEnt] => ent
                )

        )

    [title] => Array
        (
            [0] => Array
                (
                    [title] => a title
                    [titleDesc] => desc here
                )

        )

    [navBar] => Products
    [pageContent] => About
) 
```

有人可以告诉我如何获取 pageContent 吗？

这是我正在使用的代码，但我得到了未定义的索引。我不知道我哪里出错了。

```
foreach($bigArr as $key=>$val)
{
  if($key['pageContent'] != null)
  {
    foreach($val as $fkey=>$fval)
    {
      echo $fkey['pageContent'];
    }
  }
} 
```

循环给了我：

```
PHP Notice:  Undefined index:  pageContent
PHP Warning:  Invalid argument supplied for foreach() 
```

有人可以帮我解决这个问题吗？谢谢

编辑：无效的论点让我感到困惑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T09:17:25.447

您可以使用 访问该值`$bigArr['pageContent']`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T09:25:46.817

您的第一个调用`foreach`是每次迭代为您提供两条数据：键和值。键是一个字符串，而不是一个数组（这是您在第 3 行尝试使用的。

因此，在该数组的最后一次迭代中，`$key`将包含`'pageContent'`并且`$val`将包含“关于”

在任何情况下，对你正在做的事情使用 foreach 似乎是不必要的。您可以使用直接检查数组中是否存在“pageContent”键[`array_key_exists()`](http://us2.php.net/array_key_exists)，然后直接拉出该值。

```
if(array_key_exists('pageContent', $bigArr) && $bigArr['pageContent'] != null)
{
    echo $bigArr['pageContent'];
} 
```

# python - Paste.Template 有替代品吗？

> ID：790534
> 
> 赞同：1
> 
> 时间：2009-04-26T09:14:44.393
> 
> 标签：python, templates, generator

我已经厌倦了粘贴模板的所有小问题，维护模板很糟糕，它无法更新旧项目并且很难测试。

我想知道是否有人知道快速启动生成器的替代方案，因为它们已被证明是有用的。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-04-26T09:33:49.153

我没有使用粘贴模板，所以我不确定它的比较，但[Mako](http://www.makotemplates.org/)似乎是一个相当不错的系统。

他们首页的模板语言片段：

```
<%inherit file="base.html"/>
<%
    rows = [[v for v in range(0,10)] for row in range(0,10)]
%>
<table>
    % for row in rows:
        ${makerow(row)}
    % endfor
</table>

<%def name="makerow(row)">
    <tr>
    % for name in row:
        <td>${name}</td>\
    % endfor
    </tr>
</%def> 
```

# jmx - 如果 jvm 中的内存消耗超过某个阈值，我如何使用 jmx 生成邮件警报/通知

> ID：790535
> 
> 赞同：1
> 
> 时间：2009-04-26T09:15:17.683
> 
> 标签：jmx, notifications

如何为 jvm 中的以下更改生成邮件警报

1）内存 2）线程 3）数据库连接

通过使用 jmx

任何帮助都会有用

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T11:23:48.420

我会回答你的问题：记忆。要在给定内存池超过阈值时收到通知，请执行以下操作。要获取所有内存池的列表，请调用 ManagementFactory.getMemoryPoolMXBeans()。然后选择对您重要的（那些）。一台我的机器，清单是：

```
Code Cache
Eden Space
Survivor Space
Tenured Gen
Perm Gen
Perm Gen [shared-ro]
Perm Gen [shared-rw] 
```

但我认为这方面故意没有标准，它们在版本和实现之间有所不同。所以首先得到一个你感兴趣的池：

```
MemoryPoolMXBean memPool = ...; // Get a MemoryPoolMXBean 
```

然后，检查是否允许使用阈值。如果是这样，设置一个（以字节为单位）

```
if(memPool.isUsageThresholdSupported())
{
  memPool.setUsageThreshold(5000000);
} 
```

然后，当超过阈值时，通过将 NotificationListener 传递给 MemoryMXBean 的 addNotificationListener 来请求通知（实际上，您必须先将其强制转换为 NotificationEmitter）。在示例中，NotificationListener 是一个匿名内部类，但它可以是任何你想要的，只要它实现了 javax.management.NotificationListener 接口。基本上，我在下面所做的是将愚蠢的消息打印到 stdout/stderr，具体取决于正在使用的内存量。当然，您可以连接到 JavaMail 或第三方邮件框架来发送邮件。

```
NotificationEmitter memBean = (NotificationEmitter)(ManagementFactory.getMemoryMXBean());
memBean.addNotificationListener(new NotificationListener()
{
  public void handleNotification(Notification n, Object handback)
  {
    CompositeData cd = (CompositeData)n.getUserData();
    MemoryNotificationInfo mni = MemoryNotificationInfo.from(cd);
    MemoryUsage memUsage = mni.getUsage();
    long bytesUsed = memUsage.getUsed();
    if(bytesUsed > 512000000)
      System.err.println("Oh, no, we're using more than 512M!");
    else
      System.out.println("It's okay.  We're only using " + bytesUsed + " bytes.");
  }
} 
```

至于线程，相关的 bean 显然是 ThreadMXBean，您可以从 ManagementFactory.getThreadMXBean() 中获得它。但看起来没有内置的方法来设置阈值或添加侦听器，因此您必须轮询。您可以仅从 ManagementFactory.getThreadMXBean().getAllThreadIds().length 获取线程数，当然，bean 中还有更多可用信息。

最后，“数据库连接”只是模糊的。你用的是什么数据库系统？有问题的 JVM 是服务器还是客户端等。

如果您需要有关后两个资源的更多信息，我建议您提出一个新问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-08-25T21:38:53.973

+1 马修斯的回答

但是，如果任何 Java 7.40 + 用户偶然发现这一点，则有一个面向 UI 的解决方案。

我们可以利用 Java Mission Control (JMC) 来生成这些警报。

JMC 现在已打包在 Java 发行版中，因此只需调用 JMC 并连接到 JMX 远程端口（如果此 JVM 是本地的，则在调用 JMC 时应该已经连接）。

在初始屏幕（MBeanServer）上，您应该会在底部看到“触发器”选项卡，单击此处您应该能够为上述所有 3 个条件设置电子邮件触发器 - 事实上，您可以做的不仅仅是发送电子邮件。

# licensing - LGPL/GPL 许可

> ID：790537
> 
> 赞同：8
> 
> 时间：2009-04-26T09:16:07.040
> 
> 标签：licensing, gpl, lgpl

我有一个使用 LGPL 下的组件的商业网络应用程序。由于该组件具有插件架构，因此我现在为该组件创建了一个使用库 (LGPL) 的插件。该库使用 GPL 数据源。

这是否意味着我必须为我的网络应用程序释放源？还是只需要释放插件的源代码？

感谢您的任何意见和建议，并原谅我的英语不好。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-26T09:31:28.893

为 100% 确定，您应该阅读[常见问题解答](http://www.gnu.org/licenses/gpl-faq.html)，然后联​​系熟悉软件许可的律师。不要与不这样做的律师交谈，因为他们会告诉你不要使用任何免费/开源的东西，只是为了安全起见，任何人都可以这么说。

无论如何，“数据源是 GPL”是什么意思？GPL 源代码是否链接到您的应用程序中？

FAQ 中有几个关于插件和 GPL 的问题。

> **我可以发布一个旨在加载 GPL 涵盖的插件的非自由程序吗？**
> 
> 这取决于程序如何调用其插件。例如，如果程序只使用简单的fork和exec来调用插件并与之通信，那么插件就是独立的程序，插件的许可对主程序没有要求。
> 
> 如果程序动态链接插件，它们之间进行函数调用并共享数据结构，我们认为它们形成了一个单独的程序，必须将其视为主程序和插件的扩展。为了使用 GPL 涵盖的插件，主程序必须在 GPL 或与 GPL 兼容的自由软件许可下发布，并且在分发主程序与这些插件一起使用时必须遵循 GPL 的条款插件。
> 
> 如果程序动态链接插件，但它们之间的通信仅限于通过一些选项调用插件的'main'函数并等待它返回，这是一种边缘情况。
> 
> 使用共享内存与复杂的数据结构进行通信几乎等同于动态链接。

正如其他人指出的那样，未分发的网络应用程序似乎被视为在普通 GPL 下私人使用（不是在 Affero GPL 中？）。

> **一家公司正在网站上运行 GPL 程序的修改版本。GPL 是否规定他们必须发布修改后的源代码？**
> 
> GPL 允许任何人制作修改版本并使用它，而无需将其分发给其他人。这家公司正在做的是一个特例。因此，该公司不必发布修改后的来源。
> 
> 人们必须有自由进行修改并私下使用它们，而无需发布这些修改。然而，将程序放在服务器机器上供公众交谈几乎不是“私人”使用，因此在这种特殊情况下要求发布源代码是合法的。希望解决此问题的开发人员可能希望将 GNU Affero GPL 用于为网络服务器设计的程序。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-26T13:30:45.323

> 这是否意味着我必须为我的网络应用程序释放源？

不*

> 还是只需要释放插件的源代码？

如果您分发应用程序，那么是的，您还必须分发其 LGPL 部分的源代码。

您还需要确保收到您的申请的任何人都有机会修改它。这对于已编译的应用程序很重要——您需要包含必要的目标文件，以便您的应用程序可以与修改后的 LGPL 代码版本重新链接。或者，使用动态链接。这个想法是人们需要能够修改您的代码部分 LGPL 并将其与您的应用程序重新组合。

用我的话来说，以下是 LGPL 的一些要求（我不是律师）：

*   LGPL 代码和其他代码之间必须有某种明确的分隔。特别是，接收者必须可以修改 LGPL 代码，甚至可以将其完全替换为其他代码，例如库的修改版本或更高版本。因此，如果它是一个已编译的程序，那么 LGPL 代码必须是动态链接的（例如，一个单独的 DLL 或共享文件），以便它可以很容易地替换为类似的库并且仍然可以互操作；或者，如果它是静态链接的，则必须提供最低要求的源文件和/或目标文件，以允许使用替代库重新编译。非 LGPL 部分可能不包含 LGPL 代码的任何部分，除了非常简单的头文件。
*   必须明确指出代码的哪一部分是 LGPL 涵盖的，包括其原始版权声明和 LGPL 的文本（包括它所基于的 GPL）。
*   如果组合软件在运行过程中显示版权声明，则 LGPL 涵盖部分的版权声明也必须显示在此处，以及指向 LGPL 和 GPL 的链接。
*   在某些情况下，您需要提供详细说明如何在组合应用程序中使用 LGPLd 代码的修改版本的安装信息。

这些只是一些限制，但 LGPL 还为您提供了许多自由，而 GPL 等其他许可证则没有。如果您要分发包含其他人的 LGPL 许可代码的组合作品：

*   您不需要为应用程序的其余部分（即非 LGPL 部分）发布源代码。唯一的例外是如上所述 - 如果它都是静态链接的，那么您需要提供足够的代码（和/或目标文件），以便能够将其与 LGPL 代码的替代或修改版本重新链接。如果您正在动态链接并通过普通 API 进行交互，则无需担心这一点。
*   您无需根据 GPL 发布应用程序的其余部分。您可以使用任何您想要的许可证，包括更严格的专有许可证，只要您在分发它时遵守规则。
*   与 GPL 版本 3 不同，如果您正在实施复制保护或 DRM 软件，则禁止使用该代码，您可以在包含复制保护或 DRM 的应用程序中使用 LGPL 版本 3 许可代码。

我最近写了一篇[对 LGPL 许可证的分析——你可以阅读这篇文章以获取更多信息。](http://bitdepth.wordpress.com/2009/01/17/looking-at-the-lgpl-license/)

另外，请阅读[LGPL 的实际文本](http://www.gnu.org/copyleft/lesser.html)。时间不会太长。

*您提到您正在使用的库具有 GPL 数据源。大概这意味着您实际上不会使用它来分发此 GPL 数据，而只是使用它的 LGPL 库。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-26T09:31:07.677

我不是律师，但是.. 只要您不分发该程序（使其可用作网络应用程序不是分发），您就不必发布任何东西的源代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-26T09:33:41.353

如果通过网络应用程序您的意思是您只是在您的服务器上运行该软件并且您不将其分发给您的用户，那么它应该很简单。无需分发，无需放弃源代码。

（可能与 GPL3 不同）

# c++ - 在 C++ 中将值从文件添加到哈希类型结构

> ID：790538
> 
> 赞同：0
> 
> 时间：2009-04-26T09:17:10.783
> 
> 标签：c++, templates, hash, parameters

我有一个空格分隔的文件，其中包含一些键-> 值对。这些将被加载到下面给出的类型的结构中：

```
#define FV_PARAM1 "A"
#define FV_PARAM2 "B"

parameter_t & parameterFeatureVector (
        parameter_t     & param,
        int             param1,
        int             param2,
) {

    param.addParam(FV_PARAM1, param1);
    param.addParam(FV_PARAM2, param2);

    return param;
} 
```

因此，对于上述内容，我可以传递以下值：

```
parameterFeatureVector( 10, 20 ); 
```

我希望同样的内容被加载到“参数”结构中。上述值取自文件。我将如何实施相同的。如果以上内容不明确，请随时返回。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T09:24:25.023

我认为您是在问如何将名称“A”翻译为特定的结构字段？如果是这样，C++ 没有内置的方法 - 你必须编写一个函数：

```
void Add( parameter_t & p, const std::string & name, int value ) {
  if ( name == "A" ) {
      p.param1 = value;
  }
  else if ( name == "B" ) {
      p.param2 = value;
  }
  else if ( .... ) {   // more name tests here
  }

} 
```

但是，我建议不要这样做，而是使用地图：

```
std::map <std::string, int> params; 
```

然后你可以说：

```
params["A"] = 42; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T09:56:24.900

我假设您正在尝试管理一组键值对。我不确定文件中使用的键值对的类型。

您可以为此目的使用关联容器[std::map 。](http://www.sgi.com/tech/stl/Map.html)

```
std::map<Ta,Tb> aCollectionOfKeyValuePairs; 
```

在哪里

*   Ta - 参数 A 的类型
*   Tb - 参数 B 的类型

例如：如果 Ta 和 Tb 都是`int`，那么，

```
std::map<int,int> aCollectionOfKeyValuePairs;

void parameterFeatureVector (  int param1, int param2)
{
     //insert into the map key==>value
    aCollectionOfKeyValuePairs[param1] = param2;
} 
```

然后为了插入，您可以调用：

```
parameterFeatureVector( 10, 20 ); 
```

# c# - 用更好的浏览器（如 Chrome）替换 .NET WebBrowser 控件？

> ID：790542
> 
> 赞同：466
> 
> 时间：2009-04-26T09:20:30.043
> 
> 标签：c#, .net, winforms, webbrowser-control

是否有任何相对简单的方法可以将现代浏览器插入 .NET 应用程序？

据我了解，该`WebBrowser`控件是**IE**的包装器，这不会是一个问题，只是它看起来像是一个非常旧的版本**IE**，所有这些都涉及 CSS 错误、潜在的安全风险（如果渲染引擎没有打补丁，我真的可以期望修复无数的缓冲区溢出问题吗？），以及其他问题。

我正在使用*Visual Studio C#*（速成版 - 这里有什么不同吗？）

我想在我的应用程序中集成一个好的网络浏览器。在某些情况下，我只是用它来处理用户注册过程，与我的网站的一些功能和其他类似的东西交互，但我有另一个应用程序需要更多的错误...控制。

我需要：

*   可以集成在我的应用程序窗口中的浏览器（不是单独的窗口）
*   对 CSS、js 和其他 Web 技术的良好支持，与任何现代浏览器不相上下
*   基本的浏览器功能，如“导航”、“返回”、“重新加载”......
*   自由访问页面代码和输出。

我在考虑 Chrome，因为它属于 BSD 许可证，但我会对最新版本的 IE 感到满意。

尽可能地，我想保持简单。最好的办法是修补现有的`WebBrowser`控件，它已经完成了我需要的大约 70%，但我认为这是不可能的。

我找到了 Mozilla 的 activeX 控件（[http://www.iol.ie/~locka/mozilla/control.htm](http://www.iol.ie/~locka/mozilla/control.htm)），但它看起来像是旧版本，所以不一定是改进。

我愿意接受建议

* * *

## 回答 #1

> 赞同：188
> 
> 时间：2010-12-03T17:42:50.643

结帐**CefSharp** *.Net*绑定，这是我不久前开始的一个项目，幸运的是被社区接受并变成了一些很棒的东西。

该项目封装了*Chromium Embedded Framework*，并已在许多主要项目中使用，包括 Rdio 的 Windows 客户端、Windows 版 Facebook Messenger 和 Windows 版 Github。

它具有*WPF*和*Winforms*的浏览器控件，并具有大量功能和扩展点。基于 Chromium，它的速度也非常快。

从 NuGet 获取它：`Install-Package CefSharp.Wpf`或`Install-Package CefSharp.WinForms`

查看示例并给出您的想法/反馈[/pull-requests：https://github.com/cefsharp/CefSharp](https://github.com/cefsharp/CefSharp)

*BSD 许可*

* * *

## 回答 #2

> 赞同：84
> 
> 时间：2009-04-26T09:24:55.787

如果您不知道，Chrome 使用（一个分支）Webkit，Safari 也使用它。这里有几个相同的问题：

*   [用 C# 嵌入 Webkit](https://stackoverflow.com/questions/142184/is-there-an-embeddable-webkit-component-for-windows-c-development)
*   [用 C# 嵌入 Gecko（Firefox 引擎）](https://stackoverflow.com/questions/26147/is-it-possible-to-embed-gecko-or-webkit-in-a-c-net-win-form-just-like-a-webview)

webkit 一个并不像其他答案所说的那样好，一个版本不再有效（谷歌代码一），而 Mono 一个是实验性的。如果有人努力为它制作一个体面的 .NET 包装器，那就太好了，但这似乎不是任何人都想做的事情——这令人惊讶，因为它现在支持 HTML5 和 IE（8 ) 引擎不足。

**更新 (2014)**

有一个新的双许可项目，允许您将 Chrome 嵌入到您的 .NET 应用程序中，称为[Awesomium](http://awesomium.com/)。它带有一个 .NET api，但需要一些技巧来渲染（示例将浏览器窗口绘制到缓冲区，将缓冲区绘制为图像并在计时器上刷新）。

我*想*这是战地3中Origin使用的浏览器。

**更新（2016 年）**

现在有[DotnetBrowser](https://www.teamdev.com/dotnetbrowser)，这是 Awesomium 的商业替代品。它基于 Chromium。

* * *

## 回答 #3

> 赞同：68
> 
> 时间：2013-02-02T23:41:15.157

几天来，我一直在测试 C# Web 浏览器组件的替代品，这是我的清单：

**1\. 使用较新的 IE 版本 8,9：**

[Web 浏览器组件是 IE7 不是 IE8？如何改变这个？](https://stackoverflow.com/questions/1786905/c-sharp-web-browser-component-is-ie7-not-ie8-how-to-change-this)

优点：

*   运行它不需要太多工作
*   如果 IE9 则支持一些 HTML5/CSS3，如果 IE10 则完全支持

缺点：

*   目标机器必须安装目标IE版本，IE10在Win7上仍处于预览状态

这不需要太多工作，您可以获得一些 HTML5 和 CSS3 支持，尽管 IE9 缺少一些最好的 CSS3 和 HTML5 功能。但我相信你可以让 IE10 以同样的方式运行。问题是目标系统必须安装 IE10，并且由于在 Windows 7 上仍处于预览状态，我建议反对它。

**2.OpenWebKitSharp [_](http://code.google.com/p/open-webkit-sharp/)**

OpenWebKitSharp 是基于 WebKit.NET 0.5 项目的 webkit 引擎的 .net 包装器。WebKit 是 Chrome/Safari 使用的布局引擎

优点：

*   积极开发
*   HTML5/CSS3 支持

缺点：

*   许多功能未实现
*   不支持 x64（必须为 x86 构建应用程序）

OpenWebKit 非常好，虽然许多功能还没有实现，但我在 Visual Studio 中使用它时遇到了一些问题，它在这里抛出空对象引用，然后在设计模式下，有一些 js 问题。每个使用它的人几乎都会立即注意到 js alert 什么也没做。mouseup、mousedown 等事件不起作用，js 拖放是错误的等等。

我在安装它时也遇到了一些困难，因为它需要安装特定版本的 VC 可再发行组件，所以在异常之后我查看了事件日志，找到了 VC 版本并安装了它。

**3\. [GeckoFX](https://bitbucket.org/geckofx)**

优点：

*   适用于单声道
*   积极开发
*   HTML5/CSS3 支持

缺点：

*   D̶o̶e̶s̶n̶'̶t̶̶s̶u̶p̶p̶o̶r̶t̶̶x̶6̶4̶(̶A̶p̶p̶̶m̶u̶s̶t̶̶b̶e̶̶b̶u̶i̶l̶t̶̶f̶o̶r̶̶x̶8̶6̶)̶ - 见下方评论

GeckoFX 是一个跨平台的 Webbrowser 控件，用于嵌入到 WinForms 应用程序中。这可以与 Windows 上的 .NET 和 Linux 上的 mono 一起使用。Gecko 是 Firefox 使用的布局引擎。

我偶然发现 GeckoFX 没有积极开发的信息，这是不正确的，当然它总是落后于 Firefox 的一两个版本，但这很正常，活动和控件本身给我留下了深刻的印象。它做了我需要的一切，但我需要一些时间来让它运行，这里有一个小教程让它运行：

1.  下载[GeckoFx-Windows-16.0-0.2](https://bitbucket.org/geckofx/geckofx-16.0/downloads)，在这里您可以检查是否有更新的[GeckoFX](https://bitbucket.org/geckofx)
2.  添加对两个下载的 dll 的引用
3.  由于 GeckoFX 是包装器，因此您需要 XulRunner，请转到[版本列表](https://bitbucket.org/geckofx/geckofx/wiki/Version_lists)查看您需要哪一个
4.  现在我们知道我们需要哪个版本的 XulRunner，我们转到 [Mozilla XulRunner 版本](ftp://ftp.mozilla.org/pub/xulrunner/releases/)，转到版本文件夹 -> 运行时 -> xulrunner-(your_version).en-US.win32.zip，在我们的例子中是[xulrunner-16.0.en-美国.win32.zip](ftp://ftp.mozilla.org/pub/xulrunner/releases/16.0/runtimes/xulrunner-16.0.en-US.win32.zip)
5.  解压缩所有文件并将所有文件复制到您的 bin\Debug （如果您的项目设置为发布，则发布）
6.  转到表单的Visual Studio Designer，转到工具箱，在里面单击右键->选择项目->浏览->查找下载的GeckoFX winforms dll文件->确定
7.  现在你应该有新的控制 GeckoWebBrowser

如果你真的必须使用 Chrome，看看这个名为[Awesomium](http://awesomium.com/)的产品，它对非商业项目是免费的，但商业许可是几千美元。

* * *

## 回答 #4

> 赞同：49
> 
> 时间：2015-12-30T23:16:39.983

我遇到了同样的问题，WebBrowser 使用的是旧版本的 IE，通过一些谷歌搜索，我发现了以下代码，该代码更改了注册表并使 WebBrowser 使用最新的 IE 版本成为可能：

```
 public enum BrowserEmulationVersion
    {
        Default = 0,
        Version7 = 7000,
        Version8 = 8000,
        Version8Standards = 8888,
        Version9 = 9000,
        Version9Standards = 9999,
        Version10 = 10000,
        Version10Standards = 10001,
        Version11 = 11000,
        Version11Edge = 11001
    }
    public static class WBEmulator
    {
        private const string InternetExplorerRootKey = @"Software\Microsoft\Internet Explorer";

        public static int GetInternetExplorerMajorVersion()
        {
            int result;

            result = 0;

            try
            {
                RegistryKey key;

                key = Registry.LocalMachine.OpenSubKey(InternetExplorerRootKey);

                if (key != null)
                {
                    object value;

                    value = key.GetValue("svcVersion", null) ?? key.GetValue("Version", null);

                    if (value != null)
                    {
                        string version;
                        int separator;

                        version = value.ToString();
                        separator = version.IndexOf('.');
                        if (separator != -1)
                        {
                            int.TryParse(version.Substring(0, separator), out result);
                        }
                    }
                }
            }
            catch (SecurityException)
            {
                // The user does not have the permissions required to read from the registry key.
            }
            catch (UnauthorizedAccessException)
            {
                // The user does not have the necessary registry rights.
            }

            return result;
        }
        private const string BrowserEmulationKey = InternetExplorerRootKey + @"\Main\FeatureControl\FEATURE_BROWSER_EMULATION";

        public static BrowserEmulationVersion GetBrowserEmulationVersion()
        {
            BrowserEmulationVersion result;

            result = BrowserEmulationVersion.Default;

            try
            {
                RegistryKey key;

                key = Registry.CurrentUser.OpenSubKey(BrowserEmulationKey, true);
                if (key != null)
                {
                    string programName;
                    object value;

                    programName = Path.GetFileName(Environment.GetCommandLineArgs()[0]);
                    value = key.GetValue(programName, null);

                    if (value != null)
                    {
                        result = (BrowserEmulationVersion)Convert.ToInt32(value);
                    }
                }
            }
            catch (SecurityException)
            {
                // The user does not have the permissions required to read from the registry key.
            }
            catch (UnauthorizedAccessException)
            {
                // The user does not have the necessary registry rights.
            }

            return result;
        }
        public static bool SetBrowserEmulationVersion(BrowserEmulationVersion browserEmulationVersion)
        {
            bool result;

            result = false;

            try
            {
                RegistryKey key;

                key = Registry.CurrentUser.OpenSubKey(BrowserEmulationKey, true);

                if (key != null)
                {
                    string programName;

                    programName = Path.GetFileName(Environment.GetCommandLineArgs()[0]);

                    if (browserEmulationVersion != BrowserEmulationVersion.Default)
                    {
                        // if it's a valid value, update or create the value
                        key.SetValue(programName, (int)browserEmulationVersion, RegistryValueKind.DWord);
                    }
                    else
                    {
                        // otherwise, remove the existing value
                        key.DeleteValue(programName, false);
                    }

                    result = true;
                }
            }
            catch (SecurityException)
            {
                // The user does not have the permissions required to read from the registry key.
            }
            catch (UnauthorizedAccessException)
            {
                // The user does not have the necessary registry rights.
            }

            return result;
        }

        public static bool SetBrowserEmulationVersion()
        {
            int ieVersion;
            BrowserEmulationVersion emulationCode;

            ieVersion = GetInternetExplorerMajorVersion();

            if (ieVersion >= 11)
            {
                emulationCode = BrowserEmulationVersion.Version11;
            }
            else
            {
                switch (ieVersion)
                {
                    case 10:
                        emulationCode = BrowserEmulationVersion.Version10;
                        break;
                    case 9:
                        emulationCode = BrowserEmulationVersion.Version9;
                        break;
                    case 8:
                        emulationCode = BrowserEmulationVersion.Version8;
                        break;
                    default:
                        emulationCode = BrowserEmulationVersion.Version7;
                        break;
                }
            }

            return SetBrowserEmulationVersion(emulationCode);
        }
        public static bool IsBrowserEmulationSet()
        {
            return GetBrowserEmulationVersion() != BrowserEmulationVersion.Default;
        }
    } 
```

您只需要创建一个类并将此代码放入其中，然后在程序启动时运行以下代码：

```
 if (!WBEmulator.IsBrowserEmulationSet())
            {
                WBEmulator.SetBrowserEmulationVersion();
            } 
```

**VB.NET：**

```
Imports Microsoft.Win32
Imports System
Imports System.Collections.Generic
Imports System.IO
Imports System.Linq
Imports System.Security
Imports System.Text
Imports System.Threading.Tasks

Public Enum BrowserEmulationVersion
    [Default] = 0
    Version7 = 7000
    Version8 = 8000
    Version8Standards = 8888
    Version9 = 9000
    Version9Standards = 9999
    Version10 = 10000
    Version10Standards = 10001
    Version11 = 11000
    Version11Edge = 11001
End Enum

Public Class WBEmulator
    Private Const InternetExplorerRootKey As String = "Software\Microsoft\Internet Explorer"
    Public Shared Function GetInternetExplorerMajorVersion() As Integer

        Dim result As Integer

        result = 0

        Try
            Dim key As RegistryKey
            key = Registry.LocalMachine.OpenSubKey(InternetExplorerRootKey)
            If key IsNot Nothing Then
                Dim value As Object = If(key.GetValue("svcVersion", Nothing), key.GetValue("Version", Nothing))

                Dim Version As String
                Dim separator As Integer
                Version = value.ToString()
                separator = Version.IndexOf(".")
                If separator <> -1 Then
                    Integer.TryParse(Version.Substring(0, separator), result)
                End If
            End If

        Catch ex As SecurityException
            'The user does Not have the permissions required to read from the registry key.
        Catch ex As UnauthorizedAccessException
            'The user does Not have the necessary registry rights.
        Catch

        End Try
        GetInternetExplorerMajorVersion = result
    End Function
    Private Const BrowserEmulationKey = InternetExplorerRootKey + "\Main\FeatureControl\FEATURE_BROWSER_EMULATION"

    Public Shared Function GetBrowserEmulationVersion() As BrowserEmulationVersion

        Dim result As BrowserEmulationVersion
        result = BrowserEmulationVersion.Default

        Try
            Dim key As RegistryKey = Registry.CurrentUser.OpenSubKey(BrowserEmulationKey, True)
            If key IsNot Nothing Then
                Dim programName As String
                Dim value As Object
                programName = Path.GetFileName(Environment.GetCommandLineArgs()(0))
                value = key.GetValue(programName, Nothing)
                If value IsNot Nothing Then
                    result = CType(Convert.ToInt32(value), BrowserEmulationVersion)
                End If
            End If
        Catch ex As SecurityException
            'The user does Not have the permissions required to read from the registry key.
        Catch ex As UnauthorizedAccessException
            'The user does Not have the necessary registry rights.
        Catch

        End Try

        GetBrowserEmulationVersion = result
    End Function
    Public Shared Function SetBrowserEmulationVersion(BEVersion As BrowserEmulationVersion) As Boolean

        Dim result As Boolean = False

        Try
            Dim key As RegistryKey = Registry.CurrentUser.OpenSubKey(BrowserEmulationKey, True)
            If key IsNot Nothing Then
                Dim programName As String = Path.GetFileName(Environment.GetCommandLineArgs()(0))
                If BEVersion <> BrowserEmulationVersion.Default Then
                    'if it's a valid value, update or create the value
                    key.SetValue(programName, CType(BEVersion, Integer), RegistryValueKind.DWord)
                Else
                    'otherwise, remove the existing value
                    key.DeleteValue(programName, False)
                End If
                result = True
            End If
        Catch ex As SecurityException

            ' The user does Not have the permissions required to read from the registry key.

        Catch ex As UnauthorizedAccessException

            ' The user does Not have the necessary registry rights.

        End Try

        SetBrowserEmulationVersion = result
    End Function

    Public Shared Function SetBrowserEmulationVersion() As Boolean
        Dim ieVersion As Integer
        Dim emulationCode As BrowserEmulationVersion
        ieVersion = GetInternetExplorerMajorVersion()

        If ieVersion >= 11 Then

            emulationCode = BrowserEmulationVersion.Version11
        Else

            Select Case ieVersion
                Case 10
                    emulationCode = BrowserEmulationVersion.Version10
                Case 9
                    emulationCode = BrowserEmulationVersion.Version9
                Case 8
                    emulationCode = BrowserEmulationVersion.Version8
                Case Else
                    emulationCode = BrowserEmulationVersion.Version7
            End Select
        End If

        SetBrowserEmulationVersion = SetBrowserEmulationVersion(emulationCode)
    End Function

    Public Shared Function IsBrowserEmulationSet() As Boolean
        IsBrowserEmulationSet = GetBrowserEmulationVersion() <> BrowserEmulationVersion.Default
    End Function
End Class 
```

你可以像这样使用它：

```
If Not WBEmulator.IsBrowserEmulationSet() Then
    WBEmulator.SetBrowserEmulationVersion()
End If 
```

* * *

## 回答 #5

> 赞同：28
> 
> 时间：2011-10-24T10:05:44.003

您可以使用注册表设置浏览器控制的 IE 版本。转到：HKLM\SOFTWARE\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BROWSER_EMULATION 并添加带有 browser_emulation 值的“yourApplicationName.exe” 要查看 browser_emulation 的值，请参阅链接：http: [//msdn.microsoft.com/en-us /library/ee330730%28VS.85%29.aspx#browser_emulation](http://msdn.microsoft.com/en-us/library/ee330730%28VS.85%29.aspx#browser_emulation)

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2014-05-05T07:56:58.760

我知道这不是“替换”WebBrowser 控件，但是在显示使用 BootStrap 3+ 进行布局等的页面时，我遇到了一些可怕的渲染问题，然后我发现了一篇建议我使用以下内容的帖子。显然，它特定于 IE，并告诉它使用在客户端机器上找到的最新变体进行渲染（因此它不会使用 IE7，我认为这是默认设置）。

所以只要放：

```
<meta http-equiv="X-UA-Compatible" content="IE=Edge" /> 
```

文档头部的某处。

显然，如果它不是您的文档，这将无济于事 - 尽管我个人认为如果您正在阅读不是通过 WebBrowser 控件创建的页面，这是一个安全漏洞 - 为什么不直接使用 Web 浏览器！

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2018-05-11T05:37:21.863

**2020 年 7 月更新**

基于 Chromium 的[WebView 2](https://docs.microsoft.com/en-us/microsoft-edge/webview2/)由 Microsoft 发布。现在您可以将新的 Chromium Edge 浏览器嵌入到 .NET 应用程序中。

**2018 年 5 月更新**

如果您的目标应用程序在 Windows 10 上运行，那么现在您可以使用[Windows Community Toolkit](https://github.com/Microsoft/WindowsCommunityToolkit)将 Edge 浏览器嵌入到您的 .NET 应用程序中。

**WPF 示例：**

1.  安装 Windows 社区工具包 Nuget 包

    ```
    Install-Package Microsoft.Toolkit.Win32.UI.Controls 
    ```

2.  XAML 代码

    ```
    <Window
        x:Class="WebViewTest.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:WPF="clr-namespace:Microsoft.Toolkit.Win32.UI.Controls.WPF;assembly=Microsoft.Toolkit.Win32.UI.Controls"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:local="clr-namespace:WebViewTest"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        Title="MainWindow"
        Width="800"
        Height="450"
        mc:Ignorable="d">
        <Grid>
            <WPF:WebView x:Name="wvc" />
        </Grid>
    </Window> 
    ```

3.  客服代码：

    ```
    public partial class MainWindow : Window
    {
      public MainWindow()
      {
        InitializeComponent();

        // You can also use the Source property here or in the WPF designer
        wvc.Navigate(new Uri("https://www.microsoft.com"));
      }
    } 
    ```

**WinForms 示例：**

```
public partial class Form1 : Form
{
  public Form1()
  {
    InitializeComponent();

    // You can also use the Source property here or in the designer
    webView1.Navigate(new Uri("https://www.microsoft.com"));
  }
} 
```

请参阅[此链接](https://blogs.windows.com/msedgedev/2018/05/09/modern-webview-winforms-wpf-apps/#GPodHHqosoYFZcHw.97)以获取更多信息。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-08-07T21:24:32.560

Geckofx 和 Webkit.net 起初都很有前途，但是随着 Internet Explorer 的改进，它们并没有分别跟上 Firefox 和 Chrome有，但可以通过进入注册表并将其更改为允许 HTML5 的 IE9 来修复。

# iphone - 除了 dataFromPropertyList:format:errorDescription: 之外，还有其他方法不遵循对象所有权策略的基本规则吗？

> ID：790543
> 
> 赞同：1
> 
> 时间：2009-04-26T09:20:56.267
> 
> 标签：iphone, cocoa-touch, memory-management

正如 Apple 所说，dataFromPropertyList:format:errorDescription: 方法不遵循对象所有权策略。方法参考对其进行了描述。我试图搜索“需要由调用者释放”，但没有有用的结果。

这是引用的引述：

> 特殊注意事项 与 Cocoa 的正常内存管理规则不同，errorString 中返回的字符串需要由调用者释放。

我几乎可以肯定，这不是唯一发生该政策例外的情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T09:53:07.187

这是一个文档错误，各种各样。对于 Mac OS X 10.4 和更早版本来说是这样，但对于针对 10.5 SDK 编译的 Mac 程序来说不是这样。我相信 iPhone 也不是这样，但还没有测试过。（为了测试，产生一个错误，释放字符串，看看你是否崩溃。）

我知道的唯一其他解决相同问题的方法是`+propertyListFromData:mutabilityOption:format:errorDescription:`，它是同时修复的。

当 10.5 SDK 发布时，我在文档中提交了一个错误 ( [rdar://5563963](http://openradar.appspot.com/radar?id=35402) )，其中包含您引用的两种方法的警告。该警告已被删除，但似乎已被读取。我已要求重新打开该错误。

# c++ - 调用具有传递给应用程序的不同线程数的函数

> ID：790552
> 
> 赞同：1
> 
> 时间：2009-04-26T09:32:25.350
> 
> 标签：c++, multithreading, boost-thread, boost-bind

我有一个函数，每次都需要用不同数量的线程调用（我正在做一些性能计算，所以需要知道性能何时开始恶化）。示例如下：

```
getTime() {
    return 0;
}

int main() {
    boost::threadpool::thread_pool<> threads(nThreads);

    for(int j = 0; j <= nLines; j++){
        threads.schedule(boost::bind(&getTime, nThreads, 1));
    }

    threads.wait();
} 
```

其中，nThreads：在命令行中给出的值

我的问题是，这是否会给我想要的结果，至于每次程序访问 for 循环时是否会使用“nThreads”调用“getTime”函数？还是我需要一些其他方法来找出相同的？

我真正想做的是：

```
boost::threadpool::thread_pool<> threads(nThreads); 
// start a new thread that calls the "getTime" function 
for(int j = 0; j <= nLines; j++){ 
    //threads.schedule(boost::bind(&getTime, nThreads, 1));
    threads.schedule(boost::bind(&getTime, 0, nLines, pc)); 
} 
```

（不确定以上哪个是正确的。）

getTime() 函数将以我从文本文件中获取的指定行数运行，并将每一行提供给我希望计算其性能的 api。但这与我的问题无关。

我希望每次调用具有不同线程数的函数并计算每个线程完成的时间。1 个线程所花费的总时间是多少，2 个线程完成所花费的总时间是多少，等等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T10:16:28.957

如果我理解正确，你真正想做的是这样的：

```
int main() 
{
    int nbThreads = 20;
    boost::threadpool::thread_pool<> threads(nbThreads);

    for(int threadId = 0; threadId <= nbThreads ; ++threadId)
    {
        threads.schedule(getTime);
    }
    threads.wait();  
} 
```

如果我是对的，你不需要在这里使用 boost::bind 。

请注意，Boost.ThreadPool 不是 Boost 的一部分（但是？它）。它将被[审查](http://www.boost.org/community/review_schedule.html)，但尚未计划审查日期。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T10:53:50.037

[使用类似OpenMP](http://www.openmp.org/)的东西怎么样？如果可扩展性是您的目标，那么它可能是一个更好的选择。

# c++ - 线程安全的 C++ 堆栈

> ID：790553
> 
> 赞同：14
> 
> 时间：2009-04-26T09:32:43.023
> 
> 标签：c++, multithreading, boost, stack, thread-safety

我是 C++ 新手，正在编写一个多线程应用程序，不同的编写者将对象推送到堆栈上，而读者将它们从堆栈中拉出（或至少将指针推送到对象）..

是否有任何内置于 C++ 中的结构可以在不添加锁定代码等的情况下处理这个问题？如果没有，那么 Boost 库呢？

编辑：

你好。感谢您最初的精彩回答。我想我认为这可能是内置的一个原因是我纯粹在 x86 空间中思考，并认为指针的 PUSH/POP 应该是指令级别的原子操作。

我不确定我最初的预感是否正确，但我想这不一定在所有平台上都是正确的。虽然如果在 x86 上运行，您是否将原子 PUSH 和 POP 放入堆栈，如果是，这是否实质上使其无锁？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-26T11:50:16.530

是的：[Boost.Thread](http://www.boost.org/doc/html/thread.html)很棒，应该非常适合您的需求。（现在，很多人说您几乎可以将 Boost 视为内置功能。）

仍然没有可以开箱即用的类，但是一旦掌握了同步原语，就可以非常简单地实现自己的线程安全包装器，例如`std::stack`. 它可能看起来像这样（不实现每个方法......）：

```
template <typename T> class MyThreadSafeStack {
  public:
    void push(const T& item) {
      boost::mutex::scoped_lock lock(m_mutex);
      m_stack.push(item);
    }
    void pop() {
      boost::mutex::scoped_lock lock(m_mutex);
      m_stack.pop();
    }
    T top() const { // note that we shouldn't return a reference,
                    // because another thread might pop() this
                    // object in the meanwhile
      boost::mutex::scoped_lock lock(m_mutex);
      return m_stack.top();
    }

  private:
    mutable boost::mutex m_mutex;
    std::stack<T> m_stack;
} 
```

* * *

如果您是 C++ 新手，请了解[RAII](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)。与这种情况相关，Boost.Thread 具有“作用域锁”类，以防止忘记释放锁而使自己陷入困境。

如果你发现自己在编写这样的代码：

```
void doStuff() {
  myLock.lock();
  if (!condition) {
    reportError();
    myLock.unlock();
    return;
  }
  try {
    doStuffThatMayThrow();
  }
  catch (std::exception& e) {
    myLock.unlock();
    throw e;
  }
  doMoreStuff();
  myLock.unlock();
} 
```

，那么你应该说不，然后转而使用 RAII（不是直接来自 Boost 的语法）：

```
void doStuff() {
  scoped_lock lock;
  if (!condition) {
    reportError();
    return;
  }
  doStuffThatMayThrow();
  doMoreStuff();
} 
```

关键是当`scoped_lock`对象超出范围时，它的析构函数会释放资源——在本例中是锁。无论您是通过抛出异常退出范围，还是通过执行`return`您的同事在函数中间偷偷添加的奇怪语句，或者只是通过到达函数末尾，这种情况总是会发生。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-26T09:41:12.783

当前的 C++ 标准根本不涉及线程，因此您的第一个问题的答案是否定的。通常，将锁定构建到基本数据结构中是一个坏主意，因为它们没有足够的信息来正确和/或有效地执行它。相反，锁定应该在使用数据结构的类中执行 - 换句话说，在您自己的应用程序类中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T09:41:47.293

AFAIK，在 C++ 中没有内置支持。您必须使用简单的同步工具来同步堆栈操作。如果线程属于同一进程，CriticalSection 会这样做，否则就使用 Mutex。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-26T11:54:12.467

在 C++ 和 Boost 库中都没有内置机制来支持这一点（注意：有些人[以 Boost 风格编写了线程安全堆栈/等](http://svn.int64.org/svnroot/int64/snips/lockfree/)）。您将不得不借用一些代码或在自己的同步中做饭。

请注意，您的情况可能需要一个单写者多读者保护 (SWMRG)，其中多个写者线程可以访问堆栈（但在给定时间点只有一个）并且多个读者可以访问堆栈（许多在给定的时间点）。Richter 有[参考实现](http://ymei.freeshell.org/gopher/Book/Programming%20Applications%20for%20MS%20Windows%204thed/ch10d.htm)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-26T12:12:39.427

如果不想使用锁定，则需要使用无锁堆栈。这实际上并不难（无锁队列更难）。您确实需要一个特定于平台的比较交换原语，例如 Windows 上的 InterlockedCompareExchange，但这并不难抽象。

请参阅此处以获取 C# 中的示例：

[http://www.boyet.com/Articles/LockFreeRedux.html](http://www.boyet.com/Articles/LockFreeRedux.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-09-14T09:21:34.290

C++ 11 标准引入了内存模型以及用于线程安全编程的标准工具。

[Reuanen](https://stackoverflow.com/users/19254/reunanen)的[优秀示例](https://stackoverflow.com/a/790704/4121151)可以使用这些工具重写，这些工具在使用上与 boost 示例中的非常相似。

您需要这些标题：

```
#include <mutex> // defines mutexes and locks
#include <stack> 
```

然后你可以创建你的线程安全堆栈：

```
template <typename T> class MyThreadSafeStack {
  public:
    void push(const T& item) {
      std::lock_guard<std::mutex> lock(m_mutex);
      m_stack.push(item);
    }
    void pop() {
      std::lock_guard<std::mutex> lock(m_mutex);
      m_stack.pop();
    }
    T top() const { // note that we shouldn't return a reference,
                    // because another thread might pop() this
                    // object in the meanwhile
      std::lock_guard<std::mutex> lock(m_mutex);
      return m_stack.top();
    }

  private:
    mutable std::mutex m_mutex;
    std::stack<T> m_stack;
}; 
```

当然，您也可以使用具有原子操作的非锁定结构，但是，这更复杂。当人们感兴趣时，我可以添加一个示例。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-28T10:15:20.467

如果您在 Windows 上运行，SLIST 实现了无锁堆栈（带有结构`SLIST_HEADER & SLIST_ENTRY`）。

该算法是通过使用互锁函数的相当简单的 push/pop 单链表堆栈实现的。唯一不明显的项目是计数器增量以避免 ABA 问题。

# javascript - Javascript for循环中的变量范围

> ID：790558
> 
> 赞同：22
> 
> 时间：2009-04-26T09:35:06.170
> 
> 标签：javascript

有什么区别：

```
function bar()
{
  for (x=0; x< 100; x++) {}
} 
```

和

```
function bar()
{
  var x;
  for (x=0; x< 100; x++) {}
} 
```

如果 x 没有在该函数之外声明，那么它不是全局变量？我总是想知道这一点，因为我通常不会声明仅在循环中使用的一次性变量，但我想知道这是否会破坏浏览器等中的可比性。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-04-26T09:46:28.107

第一个示例将添加或修改全局变量 x，如果不是预期的结果，通常应避免这样做。

虽然您的第二个示例按预期工作（无副作用），但我认为看起来更好的替代方案是

```
function bar()
{
  for (var x=0; x< 100; x++) {}
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-04-26T11:08:11.577

在您声明/使用它时会创建一个变量。如果省略 var 关键字，则变量会在全局范围内自动创建。所以你会产生副作用。这通常是要避免的。

假设您使用全局变量，然后您选择了软件的其他部分已经使用的变量名称。这将导致代码片段覆盖其值的情况。这会产生错误，并且大多数时候很难调试。在您的示例中，您可能会覆盖另一个软件正在使用的全局变量 x。

使用 var 也更快。如果您访问一个全局变量，它必须扫描所有范围直到全局变量名称。通过使用 var 它绑定到您的本地范围。

始终使用 var 是一种很好的做法。或者更好：为变量选择最窄的范围总是好的。现在你有了 global 和 var。var 声明在整个函数中都是可见的，无论你在哪里声明它。在 javascript 1.7 中引入了新的关键字：let。让我们进一步缩小范围。如果你声明你的 for 循环

```
for(let x = 0; x < 100; i++) {} 
```

比 x 仅在 {} 块内可见。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-05-01T05:32:21.283

永远记住，在 JavaScript 中，作用域是由函数定义的。在示例中

```
function () {
    var x = 15;
    bar();
    function bar() {
      for (x=0; x< 100; x++) {}
    }
    //here x will be 100
} 
```

您可能会意外访问更高的范围。我所说的更高范围的意思是包装函数或 window.x（如果没有更多的包装函数）。如果您只想将 x 用于循环，最好坚持第二个示例。

```
function () {
    var x = 15;
    bar();
    function bar() {
        var x;
        for (x=0; x< 100; x++) {}
    }
    //here x will be 15
} 
```

# c# - 如何在 C# 中从 HTML 文件中提取图像 url

> ID：790559
> 
> 赞同：9
> 
> 时间：2009-04-26T09:35:39.960
> 
> 标签：c#, .net, html, parsing, extract

谁能帮助我解释如何从 C# 中的 HTML 文件中提取图像 url

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-04-26T09:43:28.990

[HTML Agility Pack](http://www.codeplex.com/htmlagilitypack)可以做到这一点 - 只需使用类似 //img 的查询并访问 src - 就像这样：

```
string html;
using (WebClient client = new WebClient()) {
    html = client.DownloadString("http://www.google.com");
}
HtmlDocument doc = new HtmlDocument();        
doc.LoadHtml(html);
foreach(HtmlNode img in doc.DocumentNode.SelectNodes("//img")) {
    Console.WriteLine(img.GetAttributeValue("src", null));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T09:45:04.087

您必须解析 HTML 并检查 img 标签，使用以下链接它包括用于解析 HTML 标签的 C#[库](http://www.developer.com/net/csharp/article.php/10918_2230091_2)

# python - 对象类覆盖或修改

> ID：790560
> 
> 赞同：4
> 
> 时间：2009-04-26T09:36:41.953
> 
> 标签：python

是否可以向对象类添加方法，并在所有对象上使用它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-26T10:04:12.060

在 Python 中，属性是使用字典实现的：

```
>>> t = test()
>>> t.__dict__["foo"] = "bla"
>>> t.foo
'bla' 
```

但是对于“对象”，它使用“dictproxy”作为接口来防止这种分配：

```
>>> object.__dict__["test"] = "test"
TypeError: 'dictproxy' object does not support item assignment 
```

所以不，你不能。

注意：您也不能直接修改元类类型。但是由于 Python 非常灵活，我相信 Guru 可以找到一种方法来实现您想要的。这里有任何黑巫师:-)？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-26T16:07:06.273

不，Python 的内部非常注意使内置类型不可变——与 Ruby 的设计选择非常不同。如果不彻底弄乱 C 编码的内部结构并重新编译 Python 运行时以制作一个非常不同的版本，就不可能使对象“monkeypatchable”（这是针对经典的 CPython，但我相信完全相同的原则适用于其他好的实现，例如作为 Jython 和 IronPython，分别只是 s/C/Java/ 和 S/C/C#/；-)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T09:48:28.727

```
>>> object.test = "测试"
回溯（最近一次通话最后）：
  文件“”，第 1 行，在
TypeError：无法设置内置/扩展类型“对象”的属性

```

看起来不像。(Python 2.5.1)

# objective-c - 在目标 C 中调用汇编程序

> ID：790569
> 
> 赞同：0
> 
> 时间：2009-04-26T09:44:50.203
> 
> 标签：objective-c, xcode, assembly, nasm

我在汇编文件 math.nasm 中编写了一个函数 nabs，如下所示

```
%ifdef USE_x86_ASM
SECTION .text

    cglobal nABS
;*------------------------*
;* int nABS(int a)        * 
;* return value in eax    * 
;*------------------------*
ALIGN 16
    nABS:
        push ebx
        ......
                ......
                 pop ebx        
        ret
%endif 
```

我正在从文件 myfunc.c 中的 c 函数 func1 调用此函数
我正在使用 nasm 汇编程序来处理汇编文件 我正在使用 X-code 3.1 版本和 gcc 4.0 编译器 我已经定义了 USE_x86_ASM

在 Xcode 设置 Project Settings/Build/NASM BUILD OPTIONs/OTHER FLAGS AS -DUSE_X86_ASM
我还在头文件 myfunc.h 中定义了这个预处理器，
我也在 myfunc.h 中声明了 nABS

```
#define USE_x86_ASM 
int nABS(int a); 
```

并将 myfunc.h 包含在 myfunc.c 中
myfunc.c 和 math.nasm 都被编译并生成 math.o 和 myfunc.o，但我得到一个链接错误

```
Undefined symbols:
  "_nABS", referenced from:
      _func1 in myFunc.o 
```

谁能告诉我为什么会出现链接错误？

* * *

我做了修改建议另外我删除了 %ifdef 条件修改后的代码如下

```
.text
.align 2
.globl _nABS   
.private_extern _nABS 
```

_nABS: push ebx ...... ...... pop ebx
ret 仍然出现相同的链接错误，文件已编译，但出现相同的链接错误。我检查了生成的 .o 是否包含 app.LinkFileList。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T14:32:56.687

Mehrad 是对的 这应该可以

```
%ifdef USE_x86_ASM
SECTION .text

;*------------------------*
;* int nABS(int a)        *     
;* return value in eax    *     
;*------------------------*
ALIGN 16
global _nABS
    nABS:
        push ebx
        ......
                ......
                 pop ebx        
        ret
%endif 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T09:58:56.800

一些 C 编译器会在 C 符号前添加下划线。只需将下划线添加到程序集文件中的标签（`globl`当然还有指令）。

# php - 模块的单个集中式或分离式日志表？

> ID：790577
> 
> 赞同：3
> 
> 时间：2009-04-26T09:51:47.487
> 
> 标签：php, logging, crm

我正在为中型企业设计一个 Intranet 系统。我应该为所有模块保留一个日志表还是分开？

审计日志保留所有管理员/员工活动（创建、更新、删除对象），并且日志结构对于任何类型的模块都是通用的。

如果我根据日志记录提取报告也是一个好主意吗？我的日志表保留了对象类型和对象 ID，因此我可以随时根据事件、对象名称和对象 ID 获取任何对象的数据。

在这种情况下报告的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T10:02:58.380

请参阅[log4php](http://www.vxr.it/log4php/)。[log4j](http://logging.apache.org/log4j/1.2/manual.html)通过引入日志层次结构和级别解决了大部分日志记录问题。我不知道log4php有多好，但它应该是一个初学者。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-26T10:22:42.670

我会说一张桌子。

例如，您可能希望在所有模块中查找用户活动（如果我理解正确的话）。这适合一张桌子。

报告您的日志表就可以了。您可以卸载到单独的报告数据库以减少日志记录表上的争用和负载。

最后，我将明确存储对象名称和类型（数据库对象）。如果你 DROP 和 CREATE 那么 ID 将会改变。或者一个表可能会变成一个视图，例如，它的类型和 objectid 都会改变。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-26T11:11:54.487

好吧，当你去查看你的日志时，你更愿意在一个可以看到所有内容的地方查看，还是必须检查几个不同的地方，每个地方都只显示一个孤立的系统？

请记住，对于单个表，过滤掉不相关或用户无权查看的条目是微不足道的。将多个单独的日志组合成一个单一的综合视图有点棘手，而且它还有一个额外的缺点，即在大多数设计下，每次添加新的日志表时都需要重新访问执行组合的代码。

我肯定说单个日志更可取。我能想到的唯一适合多个隔离日志的情况是，如果安全问题足够强大，以至于必须对具有不同可见性的日志条目进行物理隔离 - 在这种情况下，您可能会单独查看日志服务器，而不仅仅是单独的表。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-26T18:34:18.090

We use single table and it proved to be the best solution, particularly in performance. And especially with large data sets. If you're interested in off-the-shelf solution - try [this](http://www.moonlit-software.com).

# .net - 如何选择从 Excel 运行的 .NET 框架版本？

> ID：790580
> 
> 赞同：2
> 
> 时间：2009-04-26T09:54:56.107
> 
> 标签：.net, excel

除了将 excel.exe.config 文件添加到 Office Binary 文件夹之外，如何指定 Excel 在运行 .NET dll 时使用 .NET 框架 2.0 版？

我们的应用程序在 Excel 中运行并使用 VBA 调用 .NET 程序集中的托管代码。我相信这样做的教科书方法是将 excel.exe.config 添加到包含以下内容的 Office 二进制目录：

```
<?xml version="1.0"?>
<configuration>
  <startup>
    <supportedRuntime version="v2.0.50727"/>
  </startup>
</configuration> 
```

我们的客户不能接受此选项，首先因为他们根本不允许我们将文件添加到 Office 目录，即使他们这样做了，我们也不能冒险使用 Excel 的默认选择 .NET v1.1 破坏某些应用程序.

我们认为可行的解决方案是将 Excel.exe 文件从客户端的 Office 目录复制到我们自己的应用程序目录，在其中添加配置文件并执行该文件。它运行良好，但我们遇到了严重的安装问题，安装脚本无法找到正确版本的 Excel。再加上它首先是一个令人讨厌的kludge。

任何想法都会受到欢迎。我想知道 DLL 中的一层非托管（非 .NET）代码是否可以工作。一些关于如何做到这一点的建议或一些更简单的替代方案将不胜感激，因为这不是微不足道的。

### 有关的：

> [.NET app.config 问题](https://stackoverflow.com/questions/436958/-net-app-config-question)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-26T10:05:39.933

配置为 Excel 选择的运行时版本的另一种方法是更改​​以下注册表项：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\.NETFramework\Policy\AppPatch\v2.0.50727.00000\excel.exe 
```

默认情况下，此键强制 Excel 使用 1.1 框架；删除它（或重命名它）会导致 Excel 加载可用的最新版本。

如果您担心在 Excel 中破坏 .NET 1.1，那么您可能不得不运行第二个重命名的 excel.exe 副本。.NET 框架只能在给定的 Windows 进程中加载​​一次，因此在 excel.exe 的单个实例中，您必须在 1.1、2.0 或更高版本之间进行选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-02-02T12:21:12.050

以下文章对这个问题非常详尽。 [http://mcfunley.com/331/a-real-head-scratcher-courtesy-the-clr-and-office-teams](http://mcfunley.com/331/a-real-head-scratcher-courtesy-the-clr-and-office-teams)。我认为 .NET 4.0 将成为那些有选择权的人的救星。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T10:26:22.847

Microsoft 已经发布了一个补丁，应该为每个使用该插件的用户安装该补丁。您可以在此处获取补丁：

> [http://support.microsoft.com/kb/908002](http://support.microsoft.com/kb/908002)

### 看

> [.NET app.config 问题](https://stackoverflow.com/questions/436958/-net-app-config-question)

# c# - 如何牢固地保护 web.config

> ID：790592
> 
> 赞同：3
> 
> 时间：2009-04-26T10:12:08.123
> 
> 标签：c#, asp.net

也许我完全理解错了，但据我所知，保护连接字符串的最佳方法是加密它，现在我得到了这些问题。

**问题一：**

加密可以在共享主机环境中工作吗？

**问题2：**

如果我有 FTP 服务，任何用户都可以上传 ASPX 文件并通过配置管理器命名空间检索连接字符串吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-26T10:19:30.993

**问题一：**

您在保护您的连接字符串免受什么侵害？

如果它是针对黑客等的，如果`web.config`对他们可用，那么您的系统已经受到威胁，您无能为力。

如果它是针对不经意的观察者（即编码人员），那么即使是简单的 base64 编码也会有所帮助。

**问题2：**

您不应该允许您的用户将文件上传到可以执行 aspx 文件的目录 - 这样用户就可以做他们想做的*任何事情。*

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-26T10:21:01.550

1：我不明白为什么不。

2：可能，尽管您应该采取措施防止这种情况发生。我发现最好的方法是使用 Windows 身份验证并将应用程序池的身份设置为在 IIS 中使用专用的、锁定的 Windows 帐户。这样，您的连接字符串将永远不会包含密码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T10:57:26.160

不是您的 2 个问题的答案，但是： 保护连接字符串的最佳方法是没有这种需要在连接字符串中输入密码的连接。NTLM 或类似的东西更安全。除此之外，如果用户可以访问 FTP - 加密是所谓的隐匿安全性，可以很容易地逆转。

# php - 将文本拆分为单个单词

> ID：790596
> 
> 赞同：10
> 
> 时间：2009-04-26T10:21:18.447
> 
> 标签：php, split

我想使用 PHP 将文本拆分为单个单词。您知道如何实现这一目标吗？

我的做法：

```
function tokenizer($text) {
    $text = trim(strtolower($text));
    $punctuation = '/[^a-z0-9äöüß-]/';
    $result = preg_split($punctuation, $text, -1, PREG_SPLIT_NO_EMPTY);
    for ($i = 0; $i < count($result); $i++) {
        $result[$i] = trim($result[$i]);
    }
    return $result; // contains the single words
}
$text = 'This is an example text, it contains commas and full-stops. Exclamation marks, too! Question marks? All punctuation marks you know.';
print_r(tokenizer($text)); 
```

这是一个好方法吗？你有什么改进的想法吗？

提前致谢！

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-04-26T10:24:50.277

使用与任何 unicode 标点字符匹配的类 \p{P}，并结合 \s 空白类。

```
$result = preg_split('/((^\p{P}+)|(\p{P}*\s+\p{P}*)|(\p{P}+$))/', $text, -1, PREG_SPLIT_NO_EMPTY); 
```

这将拆分为一组一个或多个空白字符，但也会吸收任何周围的标点符号。它还匹配字符串开头或结尾的标点符号。这区分了诸如“不要”和“他说'哎哟！'”之类的情况

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-26T10:23:26.973

标记[化-strtok](http://us2.php.net/strtok)。

```
<?php
$text = 'This is an example text, it contains commas and full stops. Exclamation marks, too! Question marks? All punctuation marks you know.';
$delim = ' \n\t,.!?:;';

$tok = strtok($text, $delim);

while ($tok !== false) {
    echo "Word=$tok<br />";
    $tok = strtok($delim);
}
?> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-26T10:35:09.240

在拆分之前，我会先将字符串设为小写。这将使`i`修改器和之后的数组处理变得不必要。此外，我会使用`\W`非单词字符的简写并添加一个`+`乘数。

```
$text = 'This is an example text, it contains commas and full stops. Exclamation marks, too! Question marks? All punctuation marks you know.';
$result = preg_split('/\W+/', strtolower($text), -1, PREG_SPLIT_NO_EMPTY); 
```

* * *

**编辑**   使用[Unicode 字符属性](http://docs.php.net/manual/en/regexp.reference.php#regexp.reference.unicode)而不是`\W` [marcog 建议](https://stackoverflow.com/questions/790596/split-a-text-into-single-words/790602#790602)的那样。（标点符号`[\p{P}\p{Z}]`和分隔符）之类的内容将涵盖比 . 更具体的字符`\W`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-26T10:24:48.950

做：

```
str_word_count($text, 1); 
```

或者，如果您需要 unicode 支持：

```
function str_word_count_Helper($string, $format = 0, $search = null)
{
    $result = array();
    $matches = array();

    if (preg_match_all('~[\p{L}\p{Mn}\p{Pd}\'\x{2019}' . preg_quote($search, '~') . ']+~u', $string, $matches) > 0)
    {
        $result = $matches[0];
    }

    if ($format == 0)
    {
        return count($result);
    }

    return $result;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-26T10:29:45.413

您还可以使用 PHP strtok() 函数从大字符串中获取字符串标记。你可以像这样使用它：

```
 $result = array();
 // your original string
 $text = 'This is an example text, it contains commas and full stops. Exclamation marks, too! Question marks? All punctuation marks you know.';
 // you pass strtok() your string, and a delimiter to specify how tokens are separated. words are seperated by a space.
 $word = strtok($text,' ');
 while ( $word !== false ) {
     $result[] = $word;
     $word = strtok(' ');
 } 
```

查看更多关于[strtok()的 php 文档](http://ir.php.net/manual/en/function.strtok.php)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-10T00:23:46.320

你也可以使用explode方法：http: [//php.net/manual/en/function.explode.php](http://php.net/manual/en/function.explode.php)

```
$words = explode(" ", $sentence); 
```

# algorithm - 了解 Project Euler #31

> ID：790606
> 
> 赞同：4
> 
> 时间：2009-04-26T10:33:47.980
> 
> 标签：algorithm

谁能解释一下[欧拉项目的第31个问题](http://projecteuler.net/index.php?section=problems&id=31)？我没有清楚地理解这个问题。

问题是说以任何顺序计算硬币，例如：

**2*£1**或者**1×£1 + 1×50p + 2×20p + 1×5p + 1×2p + 3×1p**？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-26T10:45:29.230

我也很难理解这个问题，不习惯英国货币。

一磅有100便士。以下硬币（以便士计）可用：1、2、5、10、20、50、100 和 200。

你被问到有多少种不同的方式可以组合这些值来创造 200 便士。

例如，有 4 种方法可以形成 5 便士：

*   1, 1, 1, 1, 1
*   1, 1, 1, 2
*   1、2、2
*   5

祝你好运！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-12-12T20:16:08.947

嘿，简单的dp，使用python：

```
ways = [0]*201
ways[0] = 1
for x in [1,2,5,10,20,50,100,200]:
    for i in xrange(x, 201):
        ways[i] += ways[i-x]
print ways[200] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-26T11:49:22.947

你必须把这个问题分解成你可以用多少种方法用相同或更低价值的硬币使每个硬币价值的问题。这会导致你得到这样的结果（*我希望我的假设是正确的*）：

*   **1便士**

    ```
    A_1p = {{1p}}
    |A_1p| = 1 
    ```

*   **2p**

    ```
    A_2p = {{2p}, {1p,1p}}
    |A_2p| = 1 + 1 = 2 
    ```

*   **5便士**

    ```
    A_5p = {{5p}, {2p,2p,1p}, {2p,1p,1p,1p}, {1p,1p,1p,1p,1p}}
    |A_5p| = 1 + 3 = 4 
    ```

*   **10便士**

    ```
    A_10p = {{10p},
             {5p,5p}, {5p,2p,2p,1p}, {5p,2p,1p,1p,1p}, {5p,1p,1p,1p,1p,1p},
             {2p,2p,1p,2p,2p,1p}, {2p,2p,1p,2p,1p,1p,1p,}, {2p,2p,1p,1p,1p,1p,1p,1p,},
             {2p,1p,1p,1p,2p,1p,1p,1p,}, {2p,1p,1p,1p,1p,1p,1p,1p,1p},
             {1p,1p,1p,1p,1p,1p,1p,1p,1p,1p},
             {2p,2p,2p,2p,2p,2p}
            }
    |A_10p| = 1 + 10 + 1 = 12 
    ```

*   …</p>

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-26T10:46:19.587

问题基本上是当你有 8 种不同类型的硬币可用时，有多少种可能的组合可以获得价值 2 英镑的钱（= 200 便士）。

这里只是一些（微不足道的）可能的组合：

*   1 x 2£
*   2 x 1£
*   200 x 1p
*   1 x 1£ + 100 x 1p
*   ...

问题是：有多少这样的组合是可能的？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-26T11:24:05.423

您可以使用递归来考虑所有少于 2 英镑的金额。（然后将差额添加为便士）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-26T11:33:53.560

我认为问题陈述很清楚。它将硬币列为：

1p、2p、5p、10p、20p、50p、1 英镑 (100p) 和 2 英镑 (200p)

因此，就便士而言，一磅的价值是很清楚的。我认为这个问题更多地是关于问题的最终目标。它问

“使用任意数量的硬币可以有多少种不同的方式来制作 2 英镑？”

这里的混乱似乎与秩序有关。解决了这个问题后，我将说明顺序在解决方案中并不重要。重要的是构成 200 便士所需的每种面额的硬币数量。

我将添加一个建议，即这是一个小问题，可以通过简单的递归来解决。如果您不确定如何进行，可以查看数字的[分区](http://en.wikipedia.org/wiki/Integer_partition)理论。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-26T17:07:59.653

这个问题是一个非常著名的问题的特例，称为子集总和 ( [http://en.wikipedia.org/wiki/Subset_Sum](http://en.wikipedia.org/wiki/Subset_Sum) )

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-05-17T20:32:36.017

这是一个棘手的解决方案，我根本不明白。解决方案位于 [http://blog.csdn.net/No_End_Point/archive/2009/06/26/4301149.aspx](http://blog.csdn.net/No_End_Point/archive/2009/06/26/4301149.aspx)

这里有一个很好的理论：[维基百科中的整数分区](http://en.wikipedia.org/wiki/Partition_%28number_theory%29)。

从这里：[http ://tardate.blogspot.com/2008/10/rolling-project-euler-on-ruby.html](http://tardate.blogspot.com/2008/10/rolling-project-euler-on-ruby.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-01-17T02:32:14.403

比 DP 效率低，但针对这个特定问题以 1/2 秒的速度运行。简单递归：

```
solve    []     s         = 0

solve    (c:ct) 0         = 1

solve    (c:ct) s | c > s = solve ct s

solve cs@(c:ct) s         = (solve cs (s - c)) + (solve ct s)

answer = solve [200,100,50,20,10,5,2,1] 200 
```

# apache - Apache 重写规则 redux

> ID：790608
> 
> 赞同：0
> 
> 时间：2009-04-26T10:35:00.567
> 
> 标签：apache, rest, rewrite

我有一个 REST 框架，当它放入任何目录时应该只是工作（TM），当我在子目录中有项目时它似乎工作正常，但如果它在根目录中则不行。因此，给定一些示例目录；

```
/
/project1
/bingo/project2
/hoopla/doopla/minor/project3 
```

所有这些工作都很好，除了当项目在根目录中运行时我得到“有趣”*（我想有点难以解释，但二级重写无法正常工作）。这是我对通用 .htaccess 文件的尝试：

```
RewriteEngine On
RewriteRule ^static/ - [L]
RewriteCond %{REQUEST_URI} ^$
RewriteRule .* ./ [R,L]
RewriteRule ^index.php - [L]
RewriteRule (.*) index.php?q=$1 [QSA,PT] 
```

（是的，所有项目都有一个子目录 ./static 被重写忽略）我想要实现的是一组适用于大多数情况的重写规则（再次，将项目放在网络服务器的目录中）供应）。我绝不是一个重写规则的专家，任何好的建议和陷阱都将不胜感激（是的，我已经阅读了太多介绍性文章。我需要一些严肃的果汁。）

*   有关搞笑的更多信息；我的网络服务器在一个位置（在 /usr/share/apache2/default-site/ 下）有 docroot，但是一组规则说 /projects 是从其他不是 docroot 子目录（/home/user/项目/）。当我去那里时，我得到 /projects 子目录的列表，如果这些子目录之一被建议的重写规则调用（restmapp），我得到；

    在此服务器上找不到请求的 URL /home/user/Projects/restmapp/index.php。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-26T18:43:25.010

试试这些规则：

```
RewriteRule ^static/ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule .* index.php?q=$0 [L,QSA] 
```

* * *

**编辑**   此外，您可以使用该`R`标志强制外部重定向或激活[mod_rewrite 的日志记录功能，](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewriteloglevel)以查看请求如何在内部重写/重定向。

# python - 使用 Python 集合类型实现 ACL

> ID：790613
> 
> 赞同：1
> 
> 时间：2009-04-26T10:37:33.493
> 
> 标签：python, set, acl, pickle

目前我有这样的表：`Pages, Groups, GroupPage, Users, UserGroup`. 使用腌制集，我只需 3 个表即可实现相同的功能：`Pages, Groups, Users`.

`set`似乎是实现 ACL 的自然选择，因为组和权限相关的操作可以用集合非常自然地表达。如果我将允许/拒绝列表存储为腌制集，它可以消除一些用于多对多关系的中间表，并允许在没有很多数据库操作的情况下进行权限编辑。

如果人类可读性很重要，我总是可以使用 json 而不是 cPickle 进行序列化，并`set`在 Python 中操作权限列表时使用。使用 SQL 直接编辑权限的可能性很小。那么这是一个好的设计理念吗？

我们使用 SQLAlchemy 作为 ORM，所以它很可能用`PickleType`column 来实现。我不打算存储整个腌制的“资源”记录集，只存储`set`由“资源”主键​​值组成的对象。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T11:24:59.243

如果你要腌制集合，你应该找到一个好的对象数据库（比如[ZODB](http://wiki.zope.org/ZODB/FrontPage)）。在纯关系世界中，您的集合存储为 BLOBS，效果很好。尝试在 ORM 情况下腌制集合可能会导致 ORM 映射出现混淆问题，因为它们大多假设纯粹的关系映射没有任何必须解码的 BLOB。

集合和其他一流的对象确实属于数据库。ORM 是一种 hack，因为有些人认为关系数据库“更好”，所以我们在映射层中进行 hack。

使用对象数据库，您会发现事情通常要顺畅得多。

* * *

**编辑**

SQLAlchemy 有它自己的序列化器。

[http://www.sqlalchemy.org/docs/05/reference/ext/serializer.html](http://www.sqlalchemy.org/docs/05/reference/ext/serializer.html)

这既不是泡菜也不是 cPickle。但是，因为它需要可扩展，所以它的行为就像泡菜一样。哪个 - 出于您的目的 - 将与您需要的一样快。您不会一直反序列化 ACL。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T11:18:04.330

您需要考虑 DBMS 为您提供了什么，以及您需要重新实现哪些功能。并发问题是一个大问题。有一些竞争条件需要考虑（例如在不同的线程和进程中发生多个写入并覆盖新数据），性能问题（写入策略？如果您的进程崩溃并且丢失数据怎么办？），内存问题（你的权限集有多大？它们都适合 RAM 吗？）。

如果您有足够的内存并且不必担心并发性，那么您的解决方案可能是一个不错的解决方案。否则我会坚持使用数据库——它会为您解决这些问题，并且已经对它们进行了大量工作以确保它们始终将您的数据从一个一致的状态带到另一个。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-26T19:18:26.313

我，我会坚持以一种独立于用于访问它的特定编程语言的形式将持久性信息保存在关系数据库中——就像我喜欢 Python（而且**很多**）一样，有一天我可能想要访问它来自其他语言的信息，如果我选择特定于 Python 的格式……男孩我会后悔吗……

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-26T11:26:36.510

如果它简化了事情并且您不会大量编辑文件（或者它会不经常编辑），我说去吧。当然，要考虑的第三种选择是使用[sqlite](http://docs.python.org/library/sqlite3.html)数据库来存储这些东西。有一些工具可以使这些易于人类阅读。

# openlaszlo - IDE/编辑器/插件的哪种配置最适合开发 Laszlo 应用程序？

> ID：790614
> 
> 赞同：1
> 
> 时间：2009-04-26T10:38:12.180
> 
> 标签：openlaszlo, laszlo

我正在探索[Laszlo](http://www.openlaszlo.org)技术，您会建议我将哪种 IDE/插件/编辑器配置用于 Laszlo 项目？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T10:48:01.017

[带有Spket IDE](http://www.spket.com/)插件的 Eclipse

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2009-04-26T10:40:22.877

我不编写 Laszlo 代码，但我敢打赌有人会说 emacs。

# grails - Grails Acegi 插件 springsecurity.GrailsDaoImpl - 用户 [admin] 没有 GrantedAuthority

> ID：790619
> 
> 赞同：1
> 
> 时间：2009-04-26T10:44:25.130
> 
> 标签：grails, groovy, login, spring-security

我将我的 grails 1.0.4 + acegi 0.4.1 项目升级到带有 acegi 0.5.1 的 grails 1.1。

我能够无错误地启动我的应用程序，但是当我想登录时，我收到“错误的用户名或密码”消息。Grails-shell 输出为：

> 2009-04-26 12:38:46,997 [403984690@qtp0-0] 错误 springsecurity.GrailsDaoImpl - 用户
> [admin] 没有 GrantedAuthority

也许有人知道我为什么无法登录？用户“admin”是在 Bootstrap 中创建的。

我希望你能帮帮我！感谢来自德国，whitenexx

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T13:46:06.437

我遇到了完全相同的问题。检查以确保在 BootStrap.groovy 中创建用户时首先使用密码和所有字段创建用户，即使它们是可选的（不知道为什么）。然后创建新角色，然后将人员添加到角色中。

检查用户是否被分配到角色的一种方法是查看将用户映射到角色的 role_people 表。

这是我的 BootStrap.groovy 文件：

```
class BootStrap {
    // include this line to encode password for ACEGI
    def authenticateService 

     def init = { servletContext ->
        //create admin user
        def password = authenticateService.passwordEncoder("password") 
        def superadmin = new User(username:"admin",userRealName:"Administrator",passwd:password,enabled:true,emailShow:true,description:"admin user",email:"put email here").save()

        //create admin role
        def sudo = new Role(authority:"ROLE_ADMIN",description:"Site Administrator")
        // now add the User to the role
         sudo.addToPeople(superadmin)
        sudo.save()

        new Role(authority:"ROLE_USER",description:"User").save()

     }
     def destroy = {
     }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T21:38:05.577

我发现了我的问题。我必须自己编辑/编码 passwordEncoder() 或 encodePassword() 方法（使用我的算法等）。passwordEncoder() 已弃用，请使用 encodePassword()！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-23T17:42:41.660

我曾经使用过 acegi 并且遇到了类似的问题。如果您使用 acegi 的默认编码，请调用`passwordEncoder()`. 否则，您应该调用`encodePassword()`.

# drupal-6 - 如何在drupal的自定义模板中打印自定义值

> ID：790621
> 
> 赞同：1
> 
> 时间：2009-04-26T10:45:02.273
> 
> 标签：drupal-6

嗨，我创建了一个名为“mycontent”的内容类型

它有 2 个字段

标签：MyText ，名称：mytext ，类型：文本 标签：MyImage ，名称：myimage ，类型：Image

到目前为止一切都很好，我已经创建了一个自定义主题，其中包括了

'节点-mycontent.tpl.php'

我的问题是，我如何获得变量。

我希望 $mytext

我可以渲染全局变量，即 $content

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T16:05:01.397

您可能会提到您正在使用 cck、imagefield、filefield（或您正在使用的任何东西）。

cck 自动为自定义字段添加模板变量。它们可以通过`$field_<field-name>`例如访问。`$field_mytext`和`$field_myimage`。在你身上做一个`var_dump($variables)`或`var_dump($field_myimage)`等等，`node-mycontent.tpl.php`看看这些变量是如何构成的。

[cck for themers](http://drupal.org/node/62462)也可能会有所帮助。

# mysql - 在 MySQL 中为表提供不同文件的性能

> ID：790625
> 
> 赞同：0
> 
> 时间：2009-04-26T10:47:30.880
> 
> 标签：mysql, performance

在 MySQL 中，我们可以选择为表设置单独的文件。我只是想知道使用此选项是否会降低性能，例如在查询表时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T11:18:47.510

我在 MySQL 中看到的针对 InnoDB 的基准测试显示，写入 (INSERT) 操作的性能适度下降，但读取操作更有利，尤其是随着表的数量和大小的增加。

但是，您的里程可能会因许多其他因素而异。数据库缓冲区大小、文件系统中的索引等。

如果您的表不是很大，那么每个表的文件可能不会有太大的不同，因为您的大部分数据库都在内存中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T11:52:28.397

这实际上取决于表的大小、您允许 MySQL 使用的内存量以及存储（磁盘）的速度。

*但这将产生微不足道的差异。*

其他因素将对速度产生更大的影响：表设计、索引覆盖率、内存、存储速度等。通过解决*这些*问题，您将在性能方面获得*更多、*更多的回报。

 *# ruby - 是否有类似于 Class#inherited 的钩子仅在 Ruby 类定义之后触发？

> ID：790626
> 
> 赞同：23
> 
> 时间：2009-04-26T10:47:45.417
> 
> 标签：ruby, class, inheritance, metaprogramming

`#inherited``class Foo`在语句之后立即调用。我想要只在`end`关闭类声明的语句之后运行的东西。

这里有一些代码来举例说明我需要什么：

```
class Class
  def inherited m
    puts "In #inherited for #{m}"
  end
end

class Foo
  puts "In Foo"
end
puts "I really wanted to have #inherited tiggered here."

### Output:
# In #inherited for Foo
# In Foo
# I really wanted to have #inherited tiggered here. 
```

有这样的东西存在吗？可以创建吗？我完全不走运吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2011-08-18T04:43:48.977

我迟到了，但我想我有一个答案（对任何访问这里的人）。

您可以跟踪直到找到类定义的结尾。我用我称之为的方法做到了`after_inherited`：

```
class Class
  def after_inherited child = nil, &blk
    line_class = nil
    set_trace_func(lambda do |event, file, line, id, binding, classname|
      unless line_class
        # save the line of the inherited class entry
        line_class = line if event == 'class'
      else
        # check the end of inherited class
        if line == line_class && event == 'end'
          # if so, turn off the trace and call the block
          set_trace_func nil
          blk.call child
        end
      end
    end)
  end
end

# testing...

class A
  def self.inherited(child)
    after_inherited do
      puts "XXX"
    end
  end
end

class B < A
  puts "YYY"
  # .... code here can include class << self, etc.
end 
```

输出：

```
YYY
XXX 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-26T13:59:38.623

你可能不走运。但这只是一个警告，而不是明确的答案。

Ruby 挂钩类定义的开头，而不是结尾，因为`Class#inherited`b/c ruby​​ 类定义没有真正的结尾。它们可以随时重新打开。

[几年前](http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/44249)有一些关于添加 const_added 触发器的讨论，但还没有通过。 [从马茨](http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/38713)：

> 我不会实现所有可能的钩子。所以当有人提出更具体的用法时，我会再考虑一下。会的`const_added`，不会`class_added`的。

所以这可能会处理你的情况 - 但我不确定（它也可能在开始时触发，最终实现时）。

你想用这个触发器做什么？可能有另一种方法可以做到这一点。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-01-01T19:26:33.270

用于`TracePoint`跟踪您的班级何时发送`:end`事件。

该模块将允许您在任何类中创建`self.finalize`回调。

```
module Finalize
  def self.extended(obj)
    TracePoint.trace(:end) do |t|
      if obj == t.self
        obj.finalize
        t.disable
      end
    end
  end
end 
```

现在您可以扩展您的类并定义`self.finalize`，它将在类定义结束后立即运行：

```
class Foo
  puts "Top of class"

  extend Finalize

  def self.finalize
    puts "Finalizing #{self}"
  end

  puts "Bottom of class"
end

puts "Outside class"

# output:
#   Top of class
#   Bottom of class
#   Finalizing Foo
#   Outside class 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-08-17T16:28:02.200

看看[`defined`](https://github.com/shuber/defined)宝石。你可以这样做：

```
require "defined"
Defined.enable!

class A
  def self.after_inherited(child)
    puts "A was inherited by #{child}"
  end

  def self.defined(*args)
    superclass.after_inherited(self) if superclass.respond_to?(:after_inherited)
  end
end

class B < A
  puts "B was defined"
end 
```

输出：

```
B was defined
A was inherited by B 
```

但是`self.defined`将在每个类定义后触发。因此，如果您添加以下代码

```
class B < A
  puts "B was redefined"
end 
```

你会看见

```
B was defined
A was inherited by B
B was redefined
A was inherited by B 
```

有一些方法可以避免这种情况，如果您愿意，我可以向您解释。

但是，如上所述，可能有更好的方法来解决您的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-26T15:05:59.900

如果您愿意假设您的 Ruby 实现了 ObjectSpaces，您可以在事后查找所有模型实例，然后适当地修改它们。谷歌建议[http://phrogz.net/ProgrammingRuby/ospace.html](http://phrogz.net/ProgrammingRuby/ospace.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-01T13:47:28.860

Rails 有一个`subclasses`方法，它的实现可能值得一看：

```
class Fruit; end

class Lemon < Fruit; end

Fruit.subclasses # => [Lemon] 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-05-09T17:11:49.397

不，据我所知没有这样的钩子，但好在你可以*自己做*。这是一个可能的实现：

不是超级干净，但它有效：

```
puts RUBY_VERSION # 2.4.1

class Father
  def self.engage_super_setup(sub)
    puts "self:#{self} sub:#{sub}"
    sub.class_eval do
      puts "toy:#{@toy}"
    end
  end

  def self.super_setup
    if self.superclass.singleton_methods.include?(:engage_super_setup)
      superclass.engage_super_setup(self)
    end
  end
end

Son = Class.new(Father) do
  @toy = 'ball'
end.tap { |new_class| new_class.super_setup } # this is needed to:
# 1\. call the super_setup method in the new class.
# 2\. we use tap to return the new Class, so this class is assigned to the Son constant.

puts Son.name # Son 
```

输出：

```
self:Father sub:#<Class:0x0055d5ab44c038> #here the subclass is still anonymous since it was not yet assigned to the constant "Son"
toy:ball # here we can see we have acess to the @toy instance variable in Son but from the :engage_super_setup in the Father class
Son # the of the class has been assigned after the constant, since ruby does this automatically when a class is assigned to a constant 
```

所以这显然不如钩子干净，但我认为最后我们有一个很好的结果。

如果我们试图对 :inherited 做同样的事情，遗憾的是是不可能的，因为 :inherited 甚至在类主体中的执行 entoer 之前就被调用了：

```
puts RUBY_VERSION # 2.4.1

class Father
  def self.inherited(sub)
    puts "self:#{self} sub:#{sub}"
    sub.class_eval do
      puts "toy:#{@toy.inspect}"
    end
  end

end

class Son < Father
  puts "we are in the body of Son"
  @toy = 'ball'
end

puts Son.name # Son 
```

输出：

```
self:Father sub:Son # as you can see here the hook is executed before the body of the declaration Son class runs
toy:nil # we dont have access yet to the instance variables
we are in the body of Son # the body of the class declaration begins to run after the :inherited hook.
Son 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-06-10T17:38:46.463

在尝试自动向所有模型添加通用验证时，我遇到了同样的问题。问题是，如果模型使用了#set_table_name，那么我添加基于数据库数据类型的验证的代码将会崩溃，因为它根据模型的名称猜测表名（因为 #inherited 被调用#set_table_name 之前）。

所以就像你一样，我真的在寻找一种方法让#inherited 在模型中的所有内容都已加载后触发。但我真的不需要走那么远，我所需要的只是在#set_table_name 之后触发的东西。所以它原来是一个简单的别名方法。你可以在这里看到我所做的一个例子： [https ://gist.github.com/1019294](https://gist.github.com/1019294)

在上面的评论中，您说“我正在尝试向 activerecord 模型添加行为，但我需要在搞砸之前完成所有模型自定义”。所以我的问题是你是否关心特定的模型定制，如果是这样，那么也许你可以使用别名方法来实现你想要的结果。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-10-28T16:32:24.860

您可以在所有代码加载后存储要调用的块。

例如，如果您在 Rails 中：

在初始化程序中：

```
module AfterInitialize
  extend self

  @@callbacks = []

  def add(&block)
    @@callbacks << block
  end

  def run
    @@callbacks.each(&:call)
  end
end 
```

在`application.rb`：

```
config.after_initialize { AfterInitialize.run } 
```

然后

```
class Parent
  def self.inherited(subclass)
    p "In inherited for #{subclass} before initialize"

    AfterInitialize.add do
      p "In inherited for #{subclass} after initialize"
    end
  end
end 
```

和

```
class Child
  p "In Child"
end 
```

# c# - 在 NavigateUrl 的中继器控件中放置我的代码后面的变量

> ID：790629
> 
> 赞同：1
> 
> 时间：2009-04-26T10:48:27.663
> 
> 标签：c#, asp.net, vb.net, repeater

这是我的中继器

```
<asp:Repeater ID="blogRepeater" runat="server">
                <ItemTemplate> 
                <br />       
                    <asp:Image ID="Image1" runat="server" Height="56px" ImageUrl='<%= string.Format( My_Variable) %>' Width="64px" />
                    <asp:HyperLink ID="HyperLink2" runat=server NavigateUrl='<%#Eval("Company_ID", "CompanyProfile.aspx?ID={0}")%>'><%#Eval("Name")%></asp:HyperLink>
                    <br /> 
                </ItemTemplate>
                <SeparatorTemplate>
                    <hr />
                </SeparatorTemplate>
            </asp:Repeater> 
```

这是我在页面加载中的代码

```
' Define data objects
        Dim conn As Data.SqlClient.SqlConnection
        Dim Comm As Data.SqlClient.SqlCommand
        Dim reader As Data.SqlClient.SqlDataReader

        conn = New Data.SqlClient.SqlConnection(ConfigurationManager.ConnectionStrings("ConnectionString").ConnectionString)

        Comm = New Data.SqlClient.SqlCommand( _
        ("SELECT Company_ID, Name FROM CompanyTable ORDER BY Name"), conn)

        Dim My_Variable As String

        My_Variable = "~/createthumb.ashx?gu=/images/Logo.bmp" + "&xmax=75&ymax=75"

        ' Open the connection
        conn.Open()
        ' Execute the category command
        reader = Comm.ExecuteReader()

        ' Bind the reader to the repeater.......................
        blogRepeater.DataSource = reader

        blogRepeater.DataBind()

        ' Close the reader
        reader.Close()
        ' Close the connection
        conn.Close() 
```

现在我有一个名为`My_Variable`. 如何将该变量`My_Variable`放在上面的中继器中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T11:04:25.253

通过这种方式，您可以将变量绑定到 repeater ：

```
<a href='<%= string.Format("CompanyProfile.aspx?ID={0}", My_Variable) %>'>
    <%# Eval("Name") %>
</a> 
```

**编辑：**您使用的静态控件不需要是服务器控件。因此，您可以使用 HTML 元素和 response.write 作为全局变量，如下所示：

```
<img id="Image1" style="height:56px;width:64px;" src='<%= My_Variable %>' /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T09:38:41.923

你真的没有代码隐藏中的数据库代码吗？这只是一个例子？您的网站将在五分钟内被黑...

My_Variable 必须声明为字段而不是函数中的局部变量。数据绑定也看不到私有字段。

哦，现在我看到您需要更改每个项目的变量，对吗？

我建议您创建一个数据对象来包含来自 db 的数据，并在每个对象上设置所有相关数据，然后在列表中绑定中继器。我意识到我应该在这里展示一些代码，但是我上次写 vb 已经 2 年了，所以无论如何它都会非常不准确。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T14:22:21.040

要设置图像 url，您必须使用数据绑定表达式。此外，您需要将变量“My_Variable”设为公共类成员。

```
<asp:Repeater ID="blogRepeater" runat="server">
    <ItemTemplate> 
        <br />       
        <asp:Image ID="Image1" runat="server" Height="56px" ImageUrl='<%# My_Variable %>' Width="64px" />
        <asp:HyperLink ID="HyperLink2" runat=server NavigateUrl='<%#Eval("Company_ID", "CompanyProfile.aspx?ID={0}")%>'><%#Eval("Name")%></asp:HyperLink>
        <br /> 
    </ItemTemplate>
    <SeparatorTemplate>
       <hr />
    </SeparatorTemplate>
</asp:Repeater> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-26T11:04:06.360

您需要创建返回字符串的受保护方法，例如：

```
protected string GetCustomString(object MyVariable)
{
    retun string.Format("<a href='{0}'>{0}</a>", MyVaraible.ToString());
} 
```

您可以在此方法上生成 HTML 链接。在你的中继器中，只需在需要的地方绑定它的方法。

```
<asp:Repeater ID="blogRepeater" runat="server">
            <ItemTemplate> 
             <%# GetCustomString(Eval("My_Variable")) %>

   <asp:HyperLink ID="HyperLink2" runat=server NavigateUrl='<%#Eval("My_Variable", "CompanyProfile.aspx?ID={0}")%>'><%#Eval("Name")%></asp:HyperLink>
                <br /> 
```

# asp.net - 在 ASP.NET 和 Javascript 中使用复选框

> ID：790635
> 
> 赞同：1
> 
> 时间：2009-04-26T10:58:48.463
> 
> 标签：asp.net, javascript, input, checkbox, repeater

我有执行此操作的 Javascript 代码：

`var oObjchbox = document.getElementById("CheckBox_" + countyId);` 

CountyId 来自预先制作的图像地图。

另一方面，复选框是由 ASP.NET 创建的。我的第一次尝试是使用带有 asp:checkBox 的 asp.repeater，但这并没有奏效，因为 ASP.NET 坚持创建自己的 ID。另一种尝试是在没有 runat=server 的情况下使用 HTML INPUT，但随后复选框无法在往返中存活。

有没有人可以解决这个问题？我在这里发现了一个类似的问题 [http://www.velocityreviews.com/forums/t301617-hijack-databoundliteralcontrol.html](http://www.velocityreviews.com/forums/t301617-hijack-databoundliteralcontrol.html) 但没有人回答他的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T12:28:15.347

如果问题是从中继器中的复选框获取 ID，那么本文可能会有所帮助，[选择 GridView 中的所有复选框](http://aspnet.4guysfromrolla.com/articles/053106-1.aspx)。它展示了如何在 ASP.Net Gridview 上生成客户端全选功能。

您正在处理的问题并不少见。您想访问一个控件，该控件位于使用 JavaScript 重复布局（GridView、Repeater、DataList 等）的控件中。

要记住的是，您可以在 DataBound 事件（**RowDataBound**，**ItemDataBound**）期间访问生成的 ClientId ，然后可以在客户端使用。

然后在回程中，因为这是一个标准控件，您应该能够找到它。但是，如果您使用的是中继器，那么更新数据可能需要更多的工作，因为控件本身更适合只读类型的显示。

如果问题是将每个控件映射到预定义的 StateCode，那么在 ItemDataBound 或 RowDataBound（如果您从 Repeater 更改为 Something else）事件中，您可以根据需要使用 1 个或 2 个参数调用 JavaScript 方法。currentCheckBoxId 和适当的 StateCode 单独或已经连接并将其用作查找类型功能。

很抱歉这两个答案，但是对于您实际尝试做的事情，这个问题似乎有点模糊，也许我只需要再喝一杯咖啡。希望这些想法之一有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T11:10:52.833

您可以使用 jquery 来解决这个问题，它提供了通过自定义查询选择元素的功能，例如

$("[id*=CheckBox1") - 返回 id 结尾为 CheckBox1 的所有元素。

$("[id^=CheckBox1") - 返回 id 开头为 CheckBox1 的所有元素。

您可以通过 contains word 和许多其他选择器找到。

更多信息 jquery.com，你会喜欢的 =)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T11:42:28.750

如果您的目标是检测服务器上选定的复选框，为什么不创建一个隐藏字段并通过在每次单击时连接国家 ID 来更新客户端以创建一个分隔列表，例如 usa;ca;nl？在回发中读取该值，解析，然后您就有了已选择的国家/地区。

在您的 PageLoad 问题中：RegisterHiddenField("txtCountryCodes","");

# distribution - 如何将 beta 分布转换为统一分布？

> ID：790637
> 
> 赞同：1
> 
> 时间：2009-04-26T11:00:42.377
> 
> 标签：distribution, beta, uniform

我想将形状参数 a=b=0.5 的[beta 分布](http://en.wikipedia.org/wiki/Beta_distribution)转换为统一的分布。这可能吗？如果是，我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T12:08:33.990

首先，让我检查一下我是否了解您想要做什么。这就是我阅读它的方式：您有具有 beta 分布的数据（例如来自随机数生成器）。您想对每个数据点应用一个函数，因此输出数据值具有均匀分布。那正确吗？

如果是这样，累积分布函数（概率密度函数的积分）实际上应该是您需要的映射。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T11:21:25.337

由于均匀分布处处的密度为 1（在区间 (0, 1) 上），您将“只”必须反转 beta 分布的密度公式。

但它包含伽马，经过快速谷歌搜索，似乎这些家伙对逆来说并非易事。

如果你知道你的数学，你可以试一试，否则你仍然可以尝试枫木。如果不花几个小时的努力，我肯定不知道。也许别人会...

# perl - Perl 中是否存在 DBI 的非关系等价物？

> ID：790638
> 
> 赞同：3
> 
> 时间：2009-04-26T11:01:31.453
> 
> 标签：perl, dbi, non-relational-database

Perl [DBI](http://search.cpan.org/dist/DBI)模块让我可以透明地连接到许多不同类型的 SQL 数据库。非关系键值对数据库是否有等效的 Perl 模块？

例如，一个接口可以让我开始使用 BerkeleyDB（甚至只是 Perl 哈希？）但切换到 memcachedb 或 CouchDB 之类的东西，甚至是 Amazon SinmpleDB 或 Google AppEngine Datastore 提供的云数据库。

（这是 Tie::Hash 所做的吗？在这种情况下，我在哪里可以找到实现的摘要？）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-26T14:01:10.243

不确定[KiokuDB](http://p3rl.org/KiokuDB)是否是您想要的。它有 CouchDB、BDB (BerkeleyDB) 和 DBI 后端。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-26T11:43:09.590

[tie](http://perldoc.perl.org/perltie.html)是一种“将对象类隐藏在简单变量中”的通用机制。[Tie::Hash](http://perldoc.perl.org/Tie/Hash.html)是一个方便的实用程序类来实现哈希关系。

因此，将对象绑定到散列中是访问键值对数据库的适当抽象。据我所知，没有通用的基础设施来创建此类关系，因此您应该自己创建一个[工厂](http://en.wikipedia.org/wiki/Factory_method_pattern)，以将您的项目与创建不同关系的各种方式隔离开来。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-26T12:42:30.150

通常，对于每种类型的键值对存储，您都需要单独的模块。

例如：

*   内存缓存通过[`Cache::Memcached`](https://metacpan.org/pod/Cache::Memcached)
*   CouchDB 通过[`DB::CouchDB`](https://metacpan.org/pod/DB::CouchDB)
*   伯克利数据库通过[`BerkeleyDB`](https://metacpan.org/pod/BerkeleyDB)
*   亚马逊 S3 通过[`Amazon::S3`](https://metacpan.org/pod/Amazon::S3)

我不确定 Google AppEngine Datastore 是否有模块 - 通常，在[MetaCPAN](https://metacpan.org/)上搜索适合您的内容。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-26T22:29:09.117

[CHI](http://search.cpan.org/dist/CHI)看起来很有前途，来自[Cache::Cache](http://search.cpan.org/dist/Cache-Cache)的制造商。

# sql - sql server 2005：值截断

> ID：790640
> 
> 赞同：-1
> 
> 时间：2009-04-26T11:02:32.107
> 
> 标签：sql, sql-server-2005

我的表包含一个字段密码，其大小为 Varchar(70)。但是当我输入大小为 40 的密码的哈希值时，最后几个字符被截断。我使用的是 SQL SERVER 2005。为什么会这样？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-13T18:42:00.727

我见过的唯一一次是当你转换为 varchar 而不指定长度时

运行这个：

```
declare @test varchar(70)

set @test = '1111111111222222222233333333334444444444555555555566666666667777777777'
select @test

select 
    cast(@test as varchar) as CastedWithoutLength,
    cast(@test as varchar(40)) as CastedWith40Length,
    cast(@test as varchar(70)) as CastedWith70Length 
```

CastedWithoutLength 将只有 30 个字符长，其余的将是设置的长度。

# iphone - 为什么我应该在我的 setter 方法中将 -autorelease 发送到我的实例变量，而不是 -release？

> ID：790647
> 
> 赞同：1
> 
> 时间：2009-04-26T11:05:43.283
> 
> 标签：iphone, objective-c, cocoa-touch, memory-management

Apple 在实例变量 mainSprocket 的 setter 方法中执行此操作：

```
– (void)setMainSprocket:(Sprocket *)newSprocket {
    [mainSprocket autorelease];
    mainSprocket = [newSprocket retain];
    return;
} 
```

为什么他们发送 -autorelease 而不是 -release？-release 在这里会产生不好的影响吗？实际上它不应该（据我的理解），因为 -release 只是说实例变量 mainSprocket 持有的当前对象不再被该实例变量使用。对于其他人仍然对该对象感兴趣的情况，该方法可以保留它，对吗？所以 -release 应该没问题，我认为？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-26T11:21:16.477

如果`mainSprocket`和`newSprocket`是同一个对象，如果您使用简单的`release`.

如果您不想使用`autorelease`，请使用：

```
– (void)setMainSprocket:(Sprocket *)newSprocket {
    // if newSprocket and mainSprocket were the same object, 
    // it would first be retained and then released
    // and therefore not deleted.
    [newSprocket retain];
    [mainSprocket release];
    mainSprocket = newSprocket;
    // you don't need return in a void-method
    // return;
} 
```

* * *

Why aren't you using properties? They are the Objective-C 2.0 way of doing it.

**SomeObject.h**

```
@interface SomeObject : NSObject {
    Sprocket *mainSprocket;
}

@property(retain) Sprocket *mainSprocket;

@end 
```

**SomeObject.m**

```
@implementation SomeObject

@synthesize mainSprocket;

@end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-26T11:09:52.603

他们在`autorelease`这里做以防万一`newSprocket`，`mainSprocket`碰巧是同一个对象。调用`release`可能会在对象可以保留在下一行之前无意中解除分配，而`autorelease`在事件循环结束时自动释放池耗尽之前不会处理。

考虑这种情况：

```
Sprocket *mySprocket = [Sprocket spacelySprocket];
[sprocketManager setMainSprocket:mySprocket];

Sprocket *anotherPointerToMySprocket = mySprocket;
[sprocketManager setMainSprocket:anotherPointerToMySprocket]; 
```

`mainSprocket`如果没有自动发布，最后一行会导致问题。对于执行相同操作的 setter 代码，您有时可能会看到的另一个约定是：

```
– (void)setMainSprocket:(Sprocket *)newSprocket {
    if (newSprocket != mainSprocket) {
        [mainSprocket release];
        mainSprocket = [newSprocket retain];
    }
} 
```

我会让其他人评论哪个更合适或更美观:-)

# c++ - 使用 RVCT 为 WinCE/Window Mobile 编译 AMR-nb 编解码器

> ID：790650
> 
> 赞同：2
> 
> 时间：2009-04-26T11:07:20.550
> 
> 标签：c++, arm, windows-ce, elf, assembly

我正在研究 amr 语音编解码器（移植/优化） 我有一个来自 voiceage 的 arm（用于 WinCE）优化版本，我将它用作性能测试的参考。到目前为止，使用我的 lib 生成的二进制文件比另一个文件高 20-30%！我使用 Vs2008，但我只能使用 Microsoft 编译器生成的 ARM 指令集。所以我试图寻找替代编译器，看看会有什么性能差异。我有 RVCT 编译器，但它会生成 elf 二进制文件/目标文件。但是，我在 wince 手机 (TyTn 2) 上运行我的测试，所以我需要找到一种方法在 WinCE 上运行使用 RVCT 编译的代码。一些选项是 1) 生成汇编列表（armcc 的 -S 选项），

我的第一次尝试是使用一个导出函数创建一个简单的 c++ 文件，使用 RVCT 对其进行编译，然后尝试在智能手机上运行该函数。发出的程序集无法由 ms 汇编器组装（不仅它们不兼容，而且 ms 汇编器拒绝使用 RVCT 编译器生成的一些指令；在我的情况下为 ASR 操作码）然后我尝试将 ELF 对象转换为 coff 格式，我找不到任何相关信息。有一个用于 ce 的 gcc 端口，并且该工具集中的 objcopy 应该能够完成该任务。但是，我无法让它工作。我尝试了不同的开关，但我不知道我需要为输入和输出格式指定什么作为 bfdname。所以，我也无法让它工作。使用 fromelf 转储并使用生成的 bin 文件似乎有点过头了，所以我决定问你们是否有什么我应该尝试做的，或者也许有人已经完成了类似的任务并且可以帮助我。基本上，我想做的就是用 RVCT 编译器编译我的代码，看看性能差异是什么。我的代码对任何 c 运行时函数的依赖性为零。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-26T23:48:04.153

只是一个更新...我编译了支持 arm-pe 和 arm-elf 的 gnu binutils。将 arm-elf 转换为 arm-coff： **objcopy.exe -I elf32-littlearm -O pe-arm-wince-little test.o test.obj**

现在 test.obj 包含相同的函数： int add(int, int); 问题是 ms 编译器拒绝 test.obj 文件：**test.obj：致命错误 LNK1136：无效或损坏的文件**

我还尝试了另一种方法。我将 test.o 转换为**symbolsrec**格式（我不知道这种格式，但这是唯一有效的格式），然后我将生成的文件转换为 arm-pe。在这种情况下，ms 编译器链接到生成的 test.obj，但生成的机器代码无效。我还用 gcc-ce 编译了 test.cpp 并尝试链接到他生成的 .obj 文件，在这种情况下一切正常。这是VS调试器中显示的汇编代码：

```
 int X2 = add(X, Y);
00012068  ldr         r1, Y, #0x28 
0001206C  ldr         r0, X, #0x2C 
00012070  bl          00011000 
```

如果我能够链接到转换后的 obj 文件，它看起来像这样：

```
 int X2 = add(X, Y);
00011068  ldr         r1, Y, #0x28 
0001106C  ldr         r0, X, #0x2C 
00011070  bl          |WinMain + 0xfffff000 ( 10000h )| 
```

**在最后一条指令中，它跳转到与我的int add(int, int);**无关的某个随机位置。功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-12T02:44:02.200

你提到你正在使用 Vs2008 和“ *......我只能使用微软编译器生成的 ARM 指令集。所以我试图寻找替代编译器*......”

（假设您可以针对 WM7...）我建议您尝试最新的适用于 Windows Mobile 7 的 CTP SDK（请参阅[此处](http://developer.windowsphone.com/windows-phone-7/)）。

与以前的版本相比，C++ 编译器具有**巨大的**代码生成改进。并且可以针对最新的 ARM 架构。相信我，代码生成质量非常高。

PS：也许我已经实现了其中一些功能的事实让我有点偏见。:)

# delphi - Delphi - 共享违规打开文本文件

> ID：790655
> 
> 赞同：6
> 
> 时间：2009-04-26T11:09:58.780
> 
> 标签：delphi, delphi-7, text-files

我正在尝试打开一个文本文件以在 Delphi 7 应用程序中读取，但由于另一个应用程序已经打开了该文件，因此出现 I/O 错误 32（共享冲突）。我尝试将 FileMode 设置为“fmOpenRead 或 fmShareDenyNone”，但现在意识到这无论如何都不适用于文本文件。

有没有办法读取由另一个应用程序打开的文本文件？

```
var
  f: TextFile;
begin
  FileMode := fmOpenRead or fmShareDenyNone;   // FileMode IS NOT APPLICABLE TO TEXT FILES!!
  AssignFile(f, FileName);
  Reset(f); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2010-05-12T02:45:02.777

使用`LoadFromStream`TStringList 的方法，而不是`LoadFromFile`. 您可以通过这种方式控制锁定：

```
var
    slFile: TStrings;
    stream: TStream;
begin
   slFile := TStringList.Create;
   try
      stream := TFileStream.Create(filename, fmOpenRead or fmShareDenyNone);
      try 
         slFile.LoadFromStream(stream);
      finally
         stream.Free;
      end;

      //Use the stringlist
   finally
      slFile.Free;
   end;
end; 
```

该示例使用流加载到`TStringList`. 如果您只想阅读片段，则可以这样做。只需从流中读取。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-26T12:40:49.437

这取决于其他进程如何打开文件......如果它专门打开文件，你根本不会成功。

而且TextFile是老帽子，我认为它将以独占模式打开以兼容旧式DOS。您应该使用 TFileStream 或类似的。

TStringList 也可能起作用，这再次取决于其他进程在做什么。但如果正在写入文件（如 .log 文件），则 fmShareDenyWrite 将不起作用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T08:54:21.820

也许是这样的：

```
 vFileList := TStringList.Create;
  try
    vFileStream := TFileStream.Create('myfile.txt', fmOpenRead or fmShareDenyNone);
    try
      vFileList.LoadFromStream(vFileStream);
    finally
      vFileStream.Free;
    end;
    // Use vFileList
  finally
    vFileList.Free;
  end; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-26T11:24:23.397

这将立即解决您的问题。使用 TStringList 加载文件。只需致电：

```
...
var sl: TStringList;
begin
  sl := TStringList.create();
  try
    sl.loadFromFile(Filename);
    ...do your stuff here...
  finally
    freeAndNil(sl);
  end;
end; 
```

我发现处理文本文件时，最好使用TStringList。否则我会选择 TFileStream ，在那里你可以指定你的打开模式。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-26T12:44:50.177

如果我没记错的话，还有一个 Textfilemode 变量仅适用于文本文件。

# algorithm - NP难？在线扑克合谋检测的算法复杂度？

> ID：790668
> 
> 赞同：10
> 
> 时间：2009-04-26T11:22:46.083
> 
> 标签：algorithm, complexity-theory, poker, np-hard

对于一个拥有 1000 万玩家的在线扑克网站，描述合谋检测算法复杂性的最佳方式是什么？

假设（我认为这些假设没有太大区别，因此请随意忽略它们，但只是为了澄清）：

*   该网站拥有10,000,000个注册用户。
*   即这些玩家一共玩了50亿手牌。
*   您获得的唯一信息是该网站的“主手牌历史数据库”，其中包含所有玩家底牌和每手牌的下注动作。
*   换句话说，您可能不会走捷径，例如检查 IP 地址、寻找不寻常的抽水/盈利模式等等。
*   假设您有一个函数，当传递一组恰好 N（其中 N 在 2 到 10 之间）玩家时，如果该组中的所有玩家都串通在一起，则返回 TRUE。如果部分但不是所有玩家是共谋者，则该函数返回 FALSE。TRUE 的返回值是（例如）75% 的置信度。

Your job is to produce an exhaustive list of every player who's colluded, along with a complete list of the players he's colluded with. I have recently heard this problem described as NP-hard but is this accurate? Sometimes we call things "NP" or "NP-hard" that are merely "hard".

Thanks!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-26T11:49:32.150

我立即看到的蛮力方法是：

```
Set colluders = new Set();
for(Player p1 : allPlayers)
{
  for(Player p2 : allPlayers)
  {
    if(!p1.equals(p2) && haveColluded(p1, p2))
    {
      colluders.add(p1);
      colluders.add(p2);
    }
  }
} 
```

我认为使用大于 2 的参数计数调用 haveColluded 没有意义，因为这可能会产生误报。我想虽然这取决于该功能的成本。但是上面的结果是 O(n^2) 调用 haveColluded （n 是玩家的数量）。该函数本身似乎是 O(m)，其中 m 是他们一起玩的游戏数。因此，该算法似乎*很好地*低于 O(n^3)。要成为 NP-hard，你必须证明“一个问题 H 是 NP-hard 当且仅当存在一个 NP 完全问题 L 是多项式时间图灵可约化为 H [...] 换句话说，L 可以由具有 H 的预言机的预言机在多项式时间内求解。” ( [http://en.wikipedia.org/wiki/NP-hard](http://en.wikipedia.org/wiki/NP-hard)）。我研究过 NP 完全问题（例如 3-SAT、旅行推销员问题等），但我不知道您将如何证明这一点。但话又说回来，它似乎确实与[集团问题](http://en.wikipedia.org/wiki/Clique_problem)相似。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-27T07:23:54.557

看起来像[clique detection](http://en.wikipedia.org/wiki/Clique_problem)，这是 NP 难的。另一方面，集团的规模在这里受到限制（10），所以蛮力在最坏的情况下是 n^10。

编辑：这里的关键问题是合谋函数的属性是什么。是否可以通过在两个较小的集合（比如 5 个）玩家上调用该函数来始终检测到 10 个玩家串通在一起？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T02:25:30.613

在您的模型下，您描述的内容应该相当容易。给你一个隐式图（顶点是玩家，边对应于一起玩过游戏）。您想要该图的子图。

如果合谋函数完全可靠，您只需在图中的每一对顶点上调用它，就可以得到子图。

该子图可能相当不连贯。我希望结果图是断开的或连接非常弱的；通过做一些最小切割，大型连接良好的子图将很快消失。

请注意，我们*可以*限制自己只查看对，因为合谋函数应该服从（就置信水平而言）Collude(A,B,C)<Collude(A,B)。

构建这个全球共谋功能似乎很难。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-07T01:23:33.263

我会将其分为两个步骤：

1.  迭代超过 50 亿手牌，检查每手牌的玩法。在每只手上使用一些算法，我们称之为*算法 A 。*随着您的进行，您将构建一个共谋图，其中顶点代表玩家，无向加权边代表两个玩家之间共谋的一些置信度。当*算法 A*因怀疑玩家 X 与玩家 Y 勾结而触发时，会在勾结图中的加权边 XY 上添加一些值。随着您在已经玩过的手牌中前进，边缘权重会随着时间的推移而累积。当达到某个阈值时，边缘表示 X 和 Y 之间的勾结。

2.  然后，确定 N 个玩家顶点列表是否*全部*勾结在一起的函数是验证包含 N 个顶点的子图是全连接的（意味着每个节点的边权重大于子图中每个其他节点的勾结阈值）。IIRC，确定这是 O(n*lg(n) )。

# c# - WCF Web 服务中的委派

> ID：790676
> 
> 赞同：3
> 
> 时间：2009-04-26T11:26:38.880
> 
> 标签：c#, wcf, ssl, active-directory, xbap

我有一个 WCF Web 服务，目前通过具有传输安全性和 Windows 客户端凭据类型的 WSHttpBinding 端点提供服务。该服务托管在 IIS 5.1 之上，并使用来自域证书颁发机构的证书配置 SSL。IIS 本身在域计算机上以 test@domain.com 的身份运行。匿名访问被禁用，集成 Windows 身份验证是唯一的身份验证方式。

该服务有一个返回当前 Windows 身份名称和模拟级别的方法。该方法在其 OperationBehaviourAttribute 中将 Impersonation 设置为 Required。

```
[OperationBehavior(Impersonation = ImpersonationOption.Required)]
public IEnumerable<string> GetInformation()
{
    WindowsIdentity identity = WindowsIdentity.GetCurrent();
    return new List<string>()
    {
        identity.Name,
        identity.ImpersonationLevel.ToString()
    };
} 
```

我正在客户端中手动构建 WCF 通道并允许服务委托。

```
WSHttpBinding binding = new WSHttpBinding();
binding.Security.Mode = SecurityMode.Transport;
binding.Security.Transport.ClientCredentialType =
    HttpClientCredentialType.Windows;

EndpointAddress endpoint =
    new EndpointAddress("https://host/DelegateService/Service.svc");

ChannelFactory<ServiceInterface.IService> cf =
    new ChannelFactory<ServiceInterface.IService>(binding, endpoint);

cf.Credentials.Windows.AllowedImpersonationLevel =
    TokenImpersonationLevel.Delegation;

ServiceInterface.IService service = cf.CreateChannel(); 
```

客户端是使用域证书签名的完全受信任的 XBAP，该域证书已移至受信任的发布者证书存储区。

主机 test@domain.com 和 current@domain.com 在域中设置了允许委派，并且没有一个用户被标记为敏感。SeImpersonatePrivilege 不应该是问题，因为模拟工作。

当客户端调用服务方法时，该方法返回“domain\current”和“Impersonation”。我需要的是“域\当前”和“委托”。根据[http://msdn.microsoft.com/en-us/library/ms730088.aspx](http://msdn.microsoft.com/en-us/library/ms730088.aspx)上的第二个表，这意味着客户端或服务无法委派。

该域具有 Windows 2000 Mixed 的功能级别。我在某处读到这意味着 NTLM 身份验证，但我相信这指的是域控制器之间的流量。当不在 https 上运行时，Wireshark`supportedMech: 1.2.840.48018.1.2.2 (MS KRB5 - Microsoft Kerberos 5)`会在 http 响应中显示，因此似乎启用了 Kerberos。

从技术上讲，我们可以将功能级别提升到 Windows 2003，因为我们拥有的两个域控制器都是 W2K3 服务器，但 IT 部门目前无法将资源分配给备份操作以及他们在提升功能之前想要做的事情等级。

我们确实有一个虚拟测试域，可以升级到 Windows Server 2003 的功能级别，但是该域缺少证书颁发机构或安装了 IIS 的客户端计算机，因此可以提高功能级别以进行测试，设置其余的基础架构工作量很大。

这是我一段时间以来一直无法解决的问题。网络上似乎到处都是“这就是你的做法”之类的文章，但我对这些没有任何运气。有什么想法有什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-12-24T10:04:36.180

您是否在同一台 IIS 主机上运行 XBAP 和服务？

如果我理解正确 - 你有：客户端-> XBAP-> WCF。

客户端正在连接到托管在 IIS 上的 XBAP。这可能是通过 Kerberos 进行身份验证的，而您似乎建议这样做。

第二个跃点是连接到 WCF 服务的 XBAP。如果这两个托管在同一 IIS 主机上，则不会尝试使用 kerberos，而是使用 NTLM。仅当 WCF 在另一台主机上时*才会*尝试使用Kerberos 。

如果您将 XBAP 和 WCF 托管在单独的盒子上，那么您就有了经典的 kerberos over 2nd hop 身份验证设置，并且任何“这就是你如何做”的文章都应该解释它。

（我意识到这个问题是前段时间 - 但我最近才发现它，直到最近才了解 Kerberos 和 2-hop 问题。）

# assembly - 查找多核系统中启用了多少线程的汇编指令

> ID：790682
> 
> 赞同：5
> 
> 时间：2009-04-26T11:31:07.340
> 
> 标签：assembly, x86, multicore

我正在开发一个准系统，我需要在启动后的某个时间确定启用了多少内核和线程，以便我可以向它们发送 SIPI 事件。我还希望每个线程都知道它是哪个线程。

例如，在启用了 HT 的单核配置中，我们有（例如，Intel Atom）：

```
thread 0 --> core 0 thread 0
thread 1 --> core 0 thread 1 
```

在没有 HT 的双核配置中（例如，Core 2 Duo）：

```
thread 0 --> core 0 thread 0
thread 1 --> core 1 thread 0 
```

确定这一点的最佳方法是什么？

**编辑：** 我发现每个线程如何找到它是哪个线程。我还没有找到如何确定有多少核心。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-26T12:28:20.480

我研究了一下，得出了这些事实。 `cpuid`with`eax = 01h`返回 APIC ID in`EBX[31:24]`和 HT enable in `EDX[28]`。

这段代码应该可以完成工作：

```
 ; this code will put the thread id into ecx
    ; and the core id into ebx

    mov eax, 01h
    cpuid
    ; get APIC ID from EBX[31:24]
    shr ebx, 24
    and ebx, 0ffh; not really necessary but makes the code nice

    ; get HT enable bit from EDX[28]
    test edx, 010000000h
    jz ht_off

    ; HT is on
    ; bit 0 of EBX is the thread
    ; bits 7:1 are the core
    mov ecx, ebx
    and ecx, 01h
    shr ebx, 1

    jmp done

ht_off:
    ; the thread is always 0
    xor ecx, ecx

done: 
```

# linux - 了解 Linux 目录权限推理

> ID：790686
> 
> 赞同：16
> 
> 时间：2009-04-26T11:38:17.793
> 
> 标签：linux, unix, permissions, directory

嗨，我有 2 个关于 linux 目录权限的问题，我不明白。

我从名为 Documents 的文件夹中删除了执行标志。之后我不能在上面使用 cd 但我仍然可以从父目录执行“ls Documents”，它仍然列出了 Documents 目录中的文件。我虽然丢失的 x-flag 拒绝读取这个目录？

然后我想知道为什么发明了目录上的粘性位。我听说它被用来让用户无法删除其他用户创建的临时文件。但是这个 IMO 违反了删除文件的规则，我们只需要这个目录的权限。为什么不简单地给每个用户一个单独的 /tmp/ 目录而不是在规则系统中引入异常？我知道标志的作用，但我想知道为什么发明标志的原因。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-26T11:48:42.650

**执行位：****遍历**目录需要执行位。**读取**目录的权限由读取位控制。

有关这种差异的示例，请参见此 shell 对话：

作为根：

```
# 查找 foo/ -ls
drwxr-xr-- 3 root root 4096 Apr 27 12:57 foo/
drwxr-xr-x 2 root root 4096 Apr 27 12:57 foo/bar
-rw-r--r-- 1 根根 0 Apr 27 12:57 foo/bar/file

```

作为用户：

```
$ ls foo/
酒吧
$ 查找 foo/ -ls
drwxr-xr-- 3 root root 4096 Apr 27 12:57 foo/
查找：foo/：权限被拒绝
$

```

通常的用法是相反的：删除读取权限但允许遍历，例如允许 Web 服务器进入 ~/public_html 但不让它通过设置来执行默认索引列表`--x`。

**粘性位：**这正是为了避免在目录中删除的默认规则而发明的`/tmp`。`/tmp`可能驻留在不同的卷上`/home`和​​/或受不同的配额管理。

[FHS](http://proton.pathname.com/fhs/pub/fhs-2.3.html#TMPTEMPORARYFILES)将/tmp 编码为“用于需要临时文件的程序”，而“[他们] 不得假定 /tmp 中的任何文件或目录在调用之间保留”。

就我个人而言，我认为 /tmp 是`vi globals.h && make install`被认为是安装程序的异教徒时代的遗产。现在的程序应该尊重`$TMPDIR`，它应该指向一个用户私有的系统管理目录，至少在重新启动时应该清理它。甚至像[tmpfile(3)](http://linux.die.net/man/3/tmpfile)这样的标准化函数也没有规定实际路径。[尽管/tmp](http://sources.redhat.com/ml/libc-alpha/1999-04/msg00075.html)似乎存在重要的兼容性和安全问题。但请注意，最后一封邮件是 1999 年的，所以从那以后情况可能会发生变化。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-01-16T10:13:32.970

只是偶然发现了这个，因为它的谷歌搜索评级很高。执行位问题还没有真正得到解答，所以......

如果未在目录上设置执行位，则它不是“可遍历的”，这意味着外壳和文件浏览器应设计为不允许您将该目录设置为当前目录，尽管该功能不能由文件强制执行-系统本身。文件系统在非执行目录*上不允许的是除包含文件的文件名**之外*的任何信息- 因此没有这些文件的日期戳或文件权限，即使它们已读取设置也无法读取这些文件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-26T11:59:55.713

[粘性位](http://en.wikipedia.org/wiki/Sticky_bit)

粘性位今天最常见的用途是在目录上，当设置时，目录中的项目只能由项目的所有者、目录的所有者或超级用户重命名或删除；如果不设置粘性位，任何对目录具有写入和执行权限的用户都可以重命名或删除包含的文件，而不管所有者是谁。通常这是在 /tmp 目录中设置的，以防止普通用户删除或移动其他用户的文件。此功能于 1986 年在 4.3BSD 中引入，如今已在大多数现代 Unix 系统中找到。

此外，Solaris（从 Solaris 2.5 开始）定义了在非可执行文件上设置了粘滞位时的特殊行为：这些文件在访问时不会被内核缓存。这通常在交换文件上设置，以防止对文件的访问从系统缓存中刷新更重要的数据。它也偶尔用于基准测试。

自动挂载程序也会设置粘性位，以指示文件尚未挂载。这允许像 ls 这样的程序忽略卸载的远程文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-21T09:20:14.913

对于 CD 目录应该是模式 0555 和文件 0444。Unix 组可以被认为是一个角色。你的角色是你的补充组。如果您不是所有者，则控制是强制性的。如果你是，他们是自由裁量的。如果您对每个路径元素都具有执行/搜索权限，则只能遍历该路径。这与易受目录遍历影响的 Microsoft Windows 不同。发明它是为了实现 Rainbow 系列“DoD 可信计算机系统评估标准”。

# c++ - 在静态初始化时使用免费的“char const*”

> ID：790687
> 
> 赞同：1
> 
> 时间：2009-04-26T11:39:06.310
> 
> 标签：c++, initialization-order

自由对象的初始化顺序在 C++ 中是未定义的。但是下面的呢？

```
namespace foo {
    char const* str = "hey";
    struct A {
        A() { cout << str; }
    } obj;
} 
```

这仍然是未定义的行为，还是对使用字符串文字初始化的指针有特殊规定？

**除此之外**：如果 str 是“char const []”类型怎么办？如果它是一个 std::string？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-26T12:52:47.490

即使它们位于不同的翻译单元中，初始化顺序仍然是定义的。

这是因为`str`用常量表达式 ( `address constant expression`) 初始化并且`str`具有 pod 类型。如果你有一个数组，它仍然适用。但如果你有一个`std::string`. 这些是动态初始化的（因为`std::string`是非 POD）。

因此，如果您`str`是 a `std::string`，如果在不同的翻译单元中定义，您将遇到未定义的行为`obj`，但这是您列出的唯一会导致麻烦的情况。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-26T11:40:54.557

定义了初始化顺序 - 它们按照它们在编译单元中出现的顺序进行初始化 - 参见 C++ 标准的第 3.6.2 节。正在初始化的事物的类型没有影响。

# ruby-on-rails - 条件视图/布局

> ID：790693
> 
> 赞同：2
> 
> 时间：2009-04-26T11:44:19.010
> 
> 标签：ruby-on-rails, dry

假设有一个产品控制器，您想要一个索引（列出产品）操作。简单的。现在假设您有一个管理员并在您的项目中存储部件。两者都需要列出产品，但方式略有不同（例如，商店不应该有这个编辑产品链接）。他们还使用不同的布局。

到目前为止，我的想法是在不同的命名空间下拥有两个产品控制器 -`app/controllers/admin/products_controller.rb`并且`app/controllers/store/products_controller.rb`- 每个都有自己的视图和布局。但我怀疑这可能会导致 WET 代码。或者对其他控制器视图的引用（imo 破坏了模块化，因此应该避免）。

那么，实际的问题是：是否有更干燥（或实际上正确）的方式来实现上述目标？

我不确定标题是否真的反映了这个问题。但是，另一方面，如果是的话，我可能可以用谷歌搜索答案。

**编辑** 从 3.1 开始，Rails 支持模板继承。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T12:30:54.110

如果您在管理部分和商店部分之间显示产品的方式是不变的，除了管理链接（创建、编辑、销毁），那么我认为为您的产品创建一个部分是最简单的。我假设您有办法判断用户是否是管理员（为了简单起见，我将只使用 admin? 下面）。在你的局部你做这样的事情......

```
<div class="product">
    <div class="productheader">
        <%=h product.title %>
    </div>
    <div class="productdescription>
        <%=h product.description %>
    </div>
    <% if admin? %>
    <div class="productadmin">
        <%= link_to "Delete", destroy_product_url %>
        <%= link_to "Edit", edit_product_url %>
    </div>
    <% end %>
</div> 
```

请务必将此部分命名为 _product.html.erb（下划线告诉 rails 该模板是部分模板）。在应用程序的 app/views 目录中创建一个名为 shared 的文件夹，并将部分内容存储在那里。

要在其他视图中渲染此部分，只需调用 render 方法并传递部分参数。

单品：

```
<%= render(:partial => "shared/product", :object => @a_product) %> 
```

多种产品：

```
<%= render(:partial => "shared/product", :collection => @products) %> 
```

通过添加布局参数，可以将布局应用于局部。部分布局必须以下划线为前缀，但存储在与控制器关联的 app/views 目录中。

```
<%= render(:partial => "shared/product", :object => @a_product, :layout => "somelayout" %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T12:33:16.723

我采用的方法是为产品创建一个控制器，并在其中添加代码以检测用户扮演的角色，并根据该角色有条件地设置视图数据。这包括实际模型数据和仅由视图用于确定要显示界面的哪些位的数据。然后，视图本身包含少量代码，这些代码能够作用于基于角色的数据并仅呈现与特定角色相关的那些位。有人可能会争辩说，这是将一些业务逻辑注入到视图中，或者将一些显示逻辑注入到控制器中——这些论点具有一定的有效性。但是，我发现它实际上更像是一种原则之间的平衡行为，我更喜欢价值 DRY 而不是 MVC 纯度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T12:29:43.817

您正在描述模型-视图-控制器模式，其中模型视图和控制器可以正交变化（或或多或少正交，取决于其实现方式）。

基本上，您有一个允许编辑的视图和一个不允许编辑的视图。同样，根据实现，可编辑视图*可以*从不可编辑视图派生。在任何一种情况下，控制器或一些更高级别的代码都会有条件地选择正确的视图。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T22:46:25.410

如果只有某种视图继承......这样就可以继承控制器而无需提供其所有视图。好在有这个[补丁](http://dev.rubyonrails.org/ticket/7076)。糟糕的是，它在很长一段时间内都无法进入核心。

将它应用到我的 rails 2.2 后，我设法对原始问题得到了以下答案。

**子类化控制器**

ProductController 有幸拥有这对双胞胎：

```
class Products::AdminController < ProductsController
  layout 'admin'
  before_filter :authenticate
end 
```

和

```
class Products::StoreController < ProductsController
  layout 'store'
  before_filter :find_cart
end 
```

这本身看起来很不错，因为它们中的每一个都带有自己的初始化部分。

**改变路线**

```
 map.resources :products, :controller => 'products/admin', :path_prefix => 'admin',
    :name_prefix => 'admin_'
  map.resources :products, :controller => 'products/store', :path_prefix => 'store',
    :only => [:show, :index], :name_prefix => 'store_' 
```

不是一条容易的路线，defo。但是，嘿，在这一点之后，一切都可以使用 ProductController 视图和部分工作（假设您修复了路径助手）。

**共享视图更改**

每个子类控制器都有自己的 index.html.erb 版本。其他所有内容都在基类中共享。

谈论共享模板中的路径助手。曾经是什么

```
<% form_for @product ... %> 
```

变成

```
<% form_for [controller_name, @product] ... %> 
```

并且像

```
<%= link_to products_path %> 
```

变成

```
<%= link_to send("#{controller_name}_products_path") %> 
```

我不知道这是否值得，但这是一种方式。任何人都知道为什么如果计划很快将这个补丁包含在 Rails 中？

# wpf - WPF 颜色插值

> ID：790699
> 
> 赞同：2
> 
> 时间：2009-04-26T11:49:05.740
> 
> 标签：wpf, colors

我正在尝试根据调色板绘制 WPF 控件的背景，其中每种颜色都分配有值（例如 Red = 0、DarkGreen = 10、Green = 20、LightGreen =30）和用户选择的值（例如 25）会给结果颜色。我希望得到的颜色是两个最接近的颜色值之间的插值（例如，对于 25 的值，它应该给出绿色和浅绿色之间的颜色）

为此，我正在考虑在 WPF 中使用现有的 LinearGradientBrush；设置 GradientStops、偏移量并获取指定值的颜色。有没有办法做到这一点，或者我应该实现自己的颜色插值功能？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-26T12:11:30.833

使用 LinearGradientBrush 听起来会有点开销。虽然没有知识。但是，颜色插值函数并不难编写。

为简单起见，我假设您的调色板具有可被 10 整除的值。

```
public static Color GetColor(int value)
{
    int startIndex = (value/10)*10;
    int endIndex = startIndex + 10;

    Color startColor = Palette[startIndex];
    Color endColor = Palette[endIndex];

    float weight = (value - startIndex)/(float)(endIndex - startIndex);

    return Color.FromArgb(
        (int)Math.Round(startColor.R * (1 - weight) + endColor.R * weight),
        (int)Math.Round(startColor.G * (1 - weight) + endColor.G * weight),
        (int)Math.Round(startColor.B * (1 - weight) + endColor.B * weight));

} 
```

如果定义的颜色不能被 10 整除，则查找开始颜色和结束颜色的逻辑会稍微复杂一些。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T22:34:28.927

I'm not sure if this was the case back then but in .NET 4.0 getting a color from a LinearGradientBrush can be done.

```
private Color GetColor(double ratio)
{
    if (ratio < 0) ratio = 0;
    else if (ratio > 1) ratio = 1;

    //Find gradient stops that surround the input value
    GradientStop gs0 = ColorScale.GradientStops.Where(n => n.Offset <= ratio).OrderBy(n => n.Offset).Last();
    GradientStop gs1 = ColorScale.GradientStops.Where(n => n.Offset >= ratio).OrderBy(n => n.Offset).First();

    float y = 0f;
    if (gs0.Offset != gs1.Offset)
    {
        y = (float)((ratio - gs0.Offset) / (gs1.Offset - gs0.Offset));
    }

    //Interpolate color channels
    Color cx = new Color();
    if (ColorScale.ColorInterpolationMode == ColorInterpolationMode.ScRgbLinearInterpolation)
    {
        float aVal = (gs1.Color.ScA - gs0.Color.ScA) * y + gs0.Color.ScA;
        float rVal = (gs1.Color.ScR - gs0.Color.ScR) * y + gs0.Color.ScR;
        float gVal = (gs1.Color.ScG - gs0.Color.ScG) * y + gs0.Color.ScG;
        float bVal = (gs1.Color.ScB - gs0.Color.ScB) * y + gs0.Color.ScB;
        cx = Color.FromScRgb(aVal, rVal, gVal, bVal);
    }
    else
    {
        byte aVal = (byte)((gs1.Color.A - gs0.Color.A) * y + gs0.Color.A);
        byte rVal = (byte)((gs1.Color.R - gs0.Color.R) * y + gs0.Color.R);
        byte gVal = (byte)((gs1.Color.G - gs0.Color.G) * y + gs0.Color.G);
        byte bVal = (byte)((gs1.Color.B - gs0.Color.B) * y + gs0.Color.B);
        cx = Color.FromArgb(aVal, rVal, gVal, bVal);
    }
    return cx;
} 
```

This would work with a brush configured as follows (for example):

```
var brush = new LinearGradientBrush();
brush.StartPoint = new Point(0, 0);
brush.EndPoint = new Point(1, 0);

//Set brush colors
brush.GradientStops.Add(new GradientStop() { Color = Color.FromRgb(102, 40, 0), Offset = 0 });
brush.GradientStops.Add(new GradientStop() { Color = Color.FromRgb(254, 167, 80), Offset = 0.25 });
brush.GradientStops.Add(new GradientStop() { Color = Color.FromRgb(0, 153, 51), Offset = 0.5 });
brush.GradientStops.Add(new GradientStop() { Color = Color.FromRgb(232, 165, 255), Offset = 0.75 });
brush.GradientStops.Add(new GradientStop() { Color = Color.FromRgb(66, 0, 89), Offset = 1 }); 
```

Source: [http://dotupdate.wordpress.com/2008/01/28/find-the-color-of-a-point-in-a-lineargradientbrush/](http://dotupdate.wordpress.com/2008/01/28/find-the-color-of-a-point-in-a-lineargradientbrush/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T14:17:05.087

谢谢大家的回复。似乎没有办法在指定点获得 GradientBrush 的“值”。我希望这在框架的某些更高版本中得到纠正。所以我想现在唯一的选择是按照 Mikko 的建议实现插值算法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-26T12:11:20.677

你从哪里想出深绿色/绿色/浅绿色的值 10/20/30。

您需要在分配的调色板值和颜色的真实数字表示之间建立某种相关表......例如

```
Color             Pal-Code     RGB            HSL
Red               0            255,0,0        0,240,120
Dark Green        10           0,128,0        80,240,60
Green             20           0,255,0        80,240,120
Light Green       30           128,255,128    80,240,180 
```

从该相关表中，您可以获取任何用户“调色板代码”，从上表中找到封闭匹配的调色板代码对，并在其上找到最佳匹配范围。例如，如果输入了一些`25`（为方便起见，我们使用 HSL），那么公式将是......

```
Green             20           0,255,0        80,240,120
Light Green       30           128,255,128    80,240,180 
```

25 在两个代码之间，所以

```
Palette Code     Hue        Sat      Luminence
20               80         240      120
30               80         240      180
-------------------------------------------------
25               80         240      150 
```

如果他们选择了`6`，您需要在每个值之间找到 0.6 的颜色范围。

```
Red               0            255,0,0        0,240,120
Dark Green        10           0,128,0        80,240,60

Palette Code     Hue        Sat      Luminence
0                0          240      120
10               80         240      60
-------------------------------------------------
6                48         240      84

0->80      = +80 * 60%   = +48    So 0+48   = 48
240->240   =   0 * 60%   = 0      So 240+0  = 240
120->60    = -60 * 60%   = -36    So 120-36 = 84 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-26T12:40:04.227

我认为您最好使用值转换器，只需采用其他答案中建议的插值函数之一并放入值转换器，使用此转换器将背景属性绑定到值即可。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-03-17T02:48:32.793

正确的方法是使用颜色的色调、饱和度和亮度。您可以使用以下方法将 RGB 颜色转换为其 HSB 值：

```
public static (int Hue, double Saturation, double Brightness)GetHSB(this Color color) {
  int max = Math.Max(color.R, Math.Max(color.G, color.B));
  int min = Math.Min(color.R, Math.Min(color.G, color.B));
  int hue = 0;//for black, gray or white, hue could be actually any number, but usually 0 is 
              //assign, which means red
  if (max-min!=0) {
    //not black, gray or white
    int maxMinDif = max-min;
    if (max==color.R) {
      #pragma warning disable IDE0045 // Convert to conditional expression
      if (color.G>=color.B) {
      #pragma warning restore IDE0045
        hue = 60 * (color.G-color.B)/maxMinDif;
      } else {
        hue = 60 * (color.G-color.B)/maxMinDif + 360;
      }
    } else if (max==color.G) {
      hue = 60 * (color.B-color.R)/maxMinDif + 120;
    } else if(max == color.B) {
      hue = 60 * (color.R-color.G)/maxMinDif + 240;
    }
  }

  double saturation = (max == 0) ? 0.0 : (1.0-((double)min/(double)max));

  return (hue, saturation, (double)max/0xFF);
} 
```

色调定义颜色，如 0 到 360 度的红色或蓝色。如果您想要蓝色（240 度）和红色（360 度）之间的渐变，请将 120 度除以步数并将其转换回 RGB。但这有点复杂。更简单的是使用不同的权重混合两种颜色：

```
/// <summary>
/// Mixes factor*color1 with (1-factor)*color2.
/// </summary>
public static Color Mix(this Color color1, double factor, Color color2) {
  if (factor<0) throw new Exception($"Factor {factor} must be greater equal 0.");
  if (factor>1) throw new Exception($"Factor {factor} must be smaller equal 1.");

  if (factor==0) return color2;
  if (factor==1) return color1;

  var factor1 = 1 - factor;
  return Color.FromArgb(
    (byte)((color1.A * factor + color2.A * factor1)),
    (byte)((color1.R * factor + color2.R * factor1)),
    (byte)((color1.G * factor + color2.G * factor1)),
    (byte)((color1.B * factor + color2.B * factor1)));
} 
```

我在 CodeProject 上写了一篇关于这个主题的长文章：[WPF 颜色、颜色空间、颜色选择器和为普通人创建自己的颜色的权威指南](https://www.codeproject.com/Articles/5296124/Definitive-Guide-to-WPF-Colors-Color-Spaces-Color)

# language-agnostic - 用许多分支重构一段代码的技巧（if/then/else）

> ID：790703
> 
> 赞同：4
> 
> 时间：2009-04-26T11:50:13.600
> 
> 标签：language-agnostic, refactoring

我很难尝试用许多分支重构一些代码。有很多 if/then/else 块，其中一些是嵌套的。

是否有任何技巧可以用来重构代码，而不会浪费大量时间首先尝试理解功能的每个次要方面？

现在我基本上使用布尔代数（德摩根定律）。我正在尝试修改 if 语句中的条件，以便可以在 if/then/else 块之外弹出小代码片段。这在某种程度上有所帮助，但代码仍然是分支的。我知道在某些时候我最终不得不将大问题分解成更小的类方法，但这很复杂，因为代码包含对许多其他类方法的调用并且有很多局部范围的变量，所以我必须处理传递新方法的许多论据。我想知道是否可以在开始将代码分解为不同的较小部分（类方法）之前使用其他一些技巧来提高代码质量。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-26T12:01:46.050

以我的经验，在进入分支和等效的逻辑表达式*之前*，在功能上分解（将事物分解成做一件事并且做得很好的更小的函数）几乎总是更有效率。

> 无需浪费大量时间尝试首先了解功能的每个小方面？

除其他外，功能分解的行为将导致您了解代码的作用，从而导致进一步的分解机会。你想得到只接受几个参数的函数，并返回没有、一个或几个值。

通过分解，您将更好地了解哪些部分在算法上是必不可少的（必须以这种方式完成才能正确）以及哪些部分只是实现细节（必须完成，但可以通过各种不同的方式完成，而无需改变输出）。

通常，您会发现许多深度嵌套`if`的 s 要么是不必要的，要么是重复重复的，要么是足够相似的，如果您在其他重复的代码中排除微小差异，它们可以简化为一个或几个函数。

换句话说，您想要掌握的不是代码的细节，而是代码正在处理的抽象事物。许多问题归结为一些数据结构（列表、队列、树、集合）和对该结构的一些操作。在某种程度上，您可以梳理数据结构和算法，您可以获得简化事物的抽象级别。或者你可以发现你必须做的任何事情都更适合其他结构或算法，然后你可以吹走很多垃圾。

我记得几年前的一位同事，他总是写数据库游标，做任何事情，因为这就是他所知道的一切。设置和拆除游标需要一些样板文件，以及带有一些错误检查的循环，所以他的代码总是看起来很复杂。他会在存储过程中执行此操作，这当然会增加更多样板。

现在，碰巧的是，这是在 Sybase T-SQL 中，它有一个全局的错误和一个全局的游标状态，他会检查两次，当他得到第一个游标行时，然后在循环中检查一次迭代所有其他行。他一直将错误变量 ( `@@error`) 与游标状态变量 ( `@@sqlstatus`，成功时为零（获得游标行），失败为 1，如果游标中没有更多行，则为 2）混淆。他的代码在标称路径上工作，因为如果他得到一行，那么两者都为零，当他试图在最后一行之后得到该行时，他会得到一个错误。因此，如果您仔细查看他的代码，您会呻吟（再一次！）并为他解决这个问题。

但是当你仔细观察时，你会发现他正在做一些事情，比如在所有行的集合`where x = 1`和每一行设置中进行游标`y = y * 2`，你最终会告诉他，“只写一个更新语句！”。

您对他对全局变量的检查的更正虽然是*正确*的，但并没有解决真正的问题，即他无缘无故地使用游标和存储过程，而他本可以从客户端代码发送更新语句。

弄清楚这一点更加困难，因为您不仅要查看全局变量的本地使用，还必须查看两个位置：声明光标的位置（`declare cursor_foo cursor for select * from table where x = 1 for update;`）和发生更新的二十行以下的位置（`update table set y = y * 2 where current of cursor_foo`）。（所有这些都将以非常样板的方式多行。）

弄清楚它也更加困难，因为您只是假设没有人会为了更新而经历所有这些；*当然*，所有这些样板都必须是因为更新中发生了一些特别的事情，对吧？或者因为`where`谓词是动态的还是什么？所以你会看到这个，作为一个尊重同事的谦虚的程序员，你的第一反应是，“*我*在这里遗漏了什么，使用光标一定是有*原因的？”*

（尽管我和他的老板都解释了@@error 和@@sqlstatus 之间的区别，但他从来没有得到它，更不用说他几乎总是可以做一个的想法`update`；他从程序代码的角度思考，从来没有“得到” 数据库，尽管表面上有“数据库程序员”的经验。）

教训是在您首先确认需要细节（实施细节）之前不要陷入细节。通过首先分解代码，您有更好的机会理解您正在处理的抽象，并真正改进代码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-26T12:51:43.280

代码当前是否有足够的单元测试，以便您知道您的更改是否破坏了某些东西？如果没有，请在进行任何重构之前先编写它们。没有单元测试的重构有点像不先看就走上街头。

如果代码有单元测试，你可以依靠它们来理解。如果没有，那么您将必须充分理解代码才能编写单元测试。这可能并不意味着您需要达到了解细节的程度。但是您必须了解各种不同条件下的期望。您需要通过代码知道标称路径。您需要了解各种替代路径和错误路径。

老实说，我没有看到在什么情况下您不会非常熟悉这段代码——或者至少是它背后的意图。一旦你达到那个水平，希望你不仅能够替换代码位，而且实际上可以设计出更好的解决方案。

祝你好运。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-26T12:47:24.537

在我开始撕裂代码之前，我创建了一个单元测试框架以确保我不会破坏任何东西。然后我开始将所有案例一一移动到单独的函数中。代码突然变得更具可读性，因为我尝试为函数提供易于理解的名称，这也迫使我理解代码。然后，一旦完成，我就开始查看条件以查看它们是否也可以重构，这通常是可能的，因为之前的大量行可能会掩盖一些事情。（我在想我从某人那里继承的一个函数，它基本上是 500 行 if-then-else）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T00:54:18.923

弄清楚您的分支是基于“表”还是基于功能。

某些事情（例如，解析器）归结为本质上是一个大的 switch 语句（对稀疏性进行了轻微的调整），在这种情况下，一个巨大的 switch 语句可能是最易读的选项。

否则，尝试从功能上思考。一旦你分解并分解为函数调用，你就有了必要时重新排列事物的构建块，但你可能会发现它不再需要。这是因为你要选择的函数名应该遵循“做一件事”的原则，所以当你重构这些函数时你已经在考虑了。

# java - java.lang.IllegalArgumentException：setAttribute：不可序列化的属性

> ID：790705
> 
> 赞同：4
> 
> 时间：2009-04-26T11:51:39.040
> 
> 标签：java

我继承了一些代码，当我尝试运行它时出现错误。错误如下：

```
10:08:32,093 ERROR [MyServlet]:260 - Servlet.service() for servlet MyServlet threw exception
java.lang.IllegalArgumentException: setAttribute: Non-serializable attribute
at org.apache.catalina.session.StandardSession.setAttribute(StandardSession.java:1270)
at org.apache.catalina.session.StandardSession.setAttribute(StandardSession.java:1248)
at org.apache.catalina.session.StandardSessionFacade.setAttribute(StandardSessionFacade.java:130)
at uk.co.my.servlet.MyServlet.doPost(MyServlet.java:121)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:647)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:729)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:269)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)
at com.my.ddi.security.SecurityContextServletFilter.doFilter(SecurityContextServletFilter.java:55)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:215)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:213)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:172)
at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:433)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:117)
at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:108)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:174)
at org.apache.coyote.http11.Http11AprProcessor.process(Http11AprProcessor.java:835)
at org.apache.coyote.http11.Http11AprProtocol$Http11ConnectionHandler.process(Http11AprProtocol.java:640)
at org.apache.tomcat.util.net.AprEndpoint$Worker.run(AprEndpoint.java:1286)
at java.lang.Thread.run(Unknown Source) 
```

我想主要的问题是它*在 uk.co.my.servlet.MyServlet.doPost(MyServlet.java:172) 上*的代码。MyServlet 的第 121 行是 session.setAttribute("LISTENER", myListener);

此 myListener 对象来自以下类：

```
public class myListener {
    static Log log = LogFactory.getLog(TerminationListener.class.getName());
    private boolean shouldCancel = false; 
```

我将如何摆脱这个错误？我需要使用瞬态关键字吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-26T11:59:05.310

如果您希望将 的实例`myListener`放置在会话中，则需要使其可序列化。这*可能*涉及使某些字段瞬态，但随后这些字段将不会保存在会话中。您还需要使类实现`Serializable`。

我建议您查看[Serializable 的文档](http://java.sun.com/javase/6/docs/api/java/io/Serializable.html)，其中详细介绍了序列化。

# java - 我应该如何处理 Java 中的多线程？

> ID：790710
> 
> 赞同：3
> 
> 时间：2009-04-26T11:53:35.587
> 
> 标签：java, multithreading, queue

我正在研究一个与 Java 相关的实际场景；一个套接字程序。现有系统和预期系统如下。

**现有系统**- 系统检查是否满足特定条件。如果是这样，它将创建一些要发送的消息并将其放入队列中。

队列处理器是一个单独的线程。它定期检查队列中是否存在项目。如果找到任何项目（消息），它只会将消息发送到远程主机（硬编码）并从队列中删除该项目。

**预期系统**- 这是类似的东西。当满足某个条件但在每种情况下收件人都不相同时，就会创建消息。所以有很多方法。

1.  将消息放入同一个队列，但带有其接收者 ID。在这种情况下，第二个线程可以识别接收者，因此可以将消息发送到该接收者。

2.  有多个线程。在这种情况下，当条件满足并且接收者处于“新”状态时，它会创建一个新队列并将消息放入该队列。并且一个新线程初始化以处理该队列。如果下一条消息被定向到同一个收件人，它应该放入同一个队列，如果不是一个新队列，则应该创建线程。

现在我想实现第二个，有点卡住了。我该怎么做？骨架就足够了，您无需担心如何创建队列等... :)

更新：我也认为方法 1 是最好的方法。我阅读了一些关于线程的文章并做出了这个决定。但也值得学习如何实现方法 2。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-26T12:02:38.670

考虑使用[Java 消息服务 (JMS)](http://java.sun.com/products/jms/)而不是重新发明轮子？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T12:02:46.220

我可以建议你看看[BlockingQueue](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/BlockingQueue.html)吗？您的调度进程可以写入此队列（放置），客户端可以以线程安全的方式获取或查看。所以你根本不需要编写队列实现。

如果您有一个包含不同消息类型的队列，那么您将需要为每个客户端实现一些 peek 类型的机制（即他们必须检查队列的头部并且只取他们的）。为了有效地工作，消费者必须及时、可靠地提取他们所需的数据。

如果每个消息/消费者类型有一个队列/线程，那么这将更容易/更可靠。

您的客户端实现只需循环：

```
while (!done) {
   Object item = queue.take();
   // process item
} 
```

请注意，队列可以使用泛型，并且`take()`是阻塞的。

当然，由于多个消费者接收不同类型的消息，您可能需要考虑基于[空间的架构](http://en.wikipedia.org/wiki/Space_based_architecture)。这不会有队列（FIFO）特性，但会以一种非常简单的方式允许您使用多个消费者。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-26T14:13:03.753

您必须稍微权衡一下是否有很多终端机器和偶尔向每个机器发送消息，或者有一些终端机器和频繁消息发送给每个机器。

如果您有很多终端机器，那么实际上每台终端机器有一个线程听起来有点过头了，除非您真的要不断地将消息流式传输到所有这些机器。我建议拥有一个只会在特定范围内增长的线程池。为此，您可以使用 ThreadPoolExecutor。当您需要发布消息时，您实际上是向将发送消息的执行程序提交了一个可运行文件：

```
Executor msgExec = new ThreadPoolExecutor(...);

public void sendMessage(final String machineId, byte[] message) {
  msgExec.execute(new Runnable() {
    public void run() {
      sendMessageNow(machineId, message);
    }
  });
}

private void sendMessageNow(String machineId, byte[] message) {
  // open connection to machine and send message, thinking
  // about the case of two simultaneous messages to a machine,
  // and whether you want to cache connections.
} 
```

如果您只有几台终端机器，那么每台机器可以有一个 BlockingQueue，每个阻塞队列都有一个线程等待下一条消息。在这种情况下，模式更像是这样（注意未经测试的周日早上的头顶代码）：

```
ConcurrentHashMap<String,BockingQueue> queuePerMachine;

public void sendMessage(String machineId, byte[] message) {
  BockingQueue<Message> q = queuePerMachine.get(machineId);
  if (q == null) {
    q = new BockingQueue<Message>();
    BockingQueue<Message> prev = queuePerMachine.putIfAbsent(machineId, q);
    if (prev != null) {
      q = prev;
    } else {
      (new QueueProessor(q)).start();
    }
  }
  q.put(new Message(message));
}

private class QueueProessor extends Thread {
  private final BockingQueue<Message> q;
  QueueProessor(BockingQueue<Message> q) {
    this.q = q;
  }
  public void run() {
    Socket s = null;
    for (;;) {
      boolean needTimeOut = (s != null);
      Message m = needTimeOut ?
         q.poll(60000, TimeUnit.MILLISECOND) :
         q.take();
      if (m == null) {
        if (s != null)
          // close s and null
      } else {
        if (s == null) {
          // open s
        }
        // send message down s
      }
    }
    // add appropriate error handling and finally
  }
} 
```

在这种情况下，如果该机器的消息在 60 秒内没有到达，我们将关闭连接。

您应该改用 JMS 吗？好吧，你必须权衡这听起来对你来说是否复杂。我个人的感觉是，这不是一项足够复杂的任务，不足以保证一个特殊的框架。但我敢肯定意见不同。

PS 实际上，现在我看看这个，你可能会把队列放在线程对象中，然后映射机器 ID -> 线程对象。无论如何，你明白了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-26T14:27:39.960

您可以尝试使用[SomnifugiJMS](https://somnifugijms.dev.java.net/)，这是一个使用 java.util.concurrent 作为实际“引擎”的虚拟机 JMS 实现。

就您的目的而言，这可能有点矫枉过正，但很可能使您的应用程序无需额外编程（如果适用）即可分发，您只需插入一个不同的 JMS 实现，如[ActiveMQ](http://activemq.apache.org/)，就完成了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-26T12:14:54.430

首先，如果您计划有很多接收器，我不会使用 ONE-THREAD-AND-QUEUE-PER-RECEIVER 方法。你最终可能会导致很多线程大部分时间都没有做任何事情，我可能会损害你的性能。另一种方法是使用工作线程的线程池，只需从共享队列中挑选任务，每个任务都有自己的接收者 ID，也许还有一个共享字典，其中包含到每个接收者的套接字连接以供工作线程使用。

话虽如此，如果你仍然想继续你的方法，你可以做的是：

1）创建一个新类来处理你的新线程执行：

```
public class Worker implements Runnable {
   private Queue<String> myQueue = new Queue<String>();
   public void run()
   {
       while (true) {
          string messageToProcess = null;
          synchronized (myQueue) {
             if (!myQueue.empty()) {
                 // get your data from queue
                 messageToProcess = myQueue.pop();
             }
          }
          if (messageToProcess != null) {
             // do your stuff
          }
          Thread.sleep(500); // to avoid spinning
       }
   }
   public void queueMessage(String message)
   {
      synchronized(myQueue) {
         myQueue.add(message);
      }
   }
} 
```

2) 在您的主线程上，创建消息并使用字典（哈希表）查看接收者的线程是否已经创建。如果是，则将新消息排队。如果没有，则创建一个新线程，将其放入哈希表并将新消息排队：

```
while (true) {
   String msg = getNewCreatedMessage(); // you get your messages from here
   int id = getNewCreatedMessageId();   // you get your rec's id from here
   Worker w = myHash(id);
   if (w == null) {   // create new Worker thread
      w = new Worker();
      new Thread(w).start();
   }
   w.queueMessage(msg);
} 
```

祝你好运。

编辑：您可以使用此方法中提到的[BlockingQueue](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/BlockingQueue.html) Brian 来改进此解决方案。

# indentation - 如何从 IDLE 中的几行中删除制表符缩进？

> ID：790711
> 
> 赞同：45
> 
> 时间：2009-04-26T11:53:44.247
> 
> 标签：indentation, python-idle, code-editor

如果你想在 Python IDLE 中缩进几行，你只需标记这些行并点击 Tab。但是如果你想从几行中删除缩进呢？Shift+Tab 不适用于 IDLE。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-04-26T12:05:22.190

如果你使用 IDLE，你可以使用`Ctrl+]`to indent 和`Ctrl+[`to unindent。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2009-04-26T12:41:58.013

如果您使用的是 IDLE，并且挪威语键盘使 Ctrl-[ 成为问题，您可以更改键。

1.  转到选项-> 配置空闲。
2.  单击密钥选项卡。
3.  如有必要，单击另存为新的自定义密钥集。
4.  使用您的自定义密钥集，在列表中找到“dedent-region”。
5.  单击获取用于选择的新键。
6.  ETC

我尝试放入 shift-Tab 并且效果很好。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2009-04-26T11:55:30.933

取决于你的编辑器。

你试过 Shift+Tab 吗？

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2015-12-09T19:04:19.977

在 pythonwin 中，

SHIFT + TAB 有效

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-01-18T19:57:41.130

对于 IDLE，选择行，然后打开“格式”菜单。（如果您找不到它，请在“编辑”和“运行”之间。）这也会为您提供键盘快捷键，对我来说，原来的快捷键是“Ctrl + [”

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-04-26T11:56:26.673

```
Shift-Tab
Ctrl-Tab
< key 
```

取决于你的编辑器。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-05-21T13:12:44.120

在 Jupyter 笔记本中，

```
 SHIFT+ TAB(to move left) and TAB(to move right) movement is perfectly working. 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-11-18T18:53:18.630

默认情况下，IDLE 将它放在 Shift-Left Bracket 上。但是，如果您愿意，您可以通过单击选项--> 配置空闲--> 键--> 使用自定义键集--> dedent-region --> 获取新键进行选择，将其自定义为 Shift-Tab

然后你可以选择你想要的任何组合。（不要忘记单击应用，否则所有设置都不会受到影响。）

# asp.net - 在 Web 表单上排列动态创建的控件

> ID：790717
> 
> 赞同：2
> 
> 时间：2009-04-26T11:57:11.413
> 
> 标签：asp.net, dynamic, layout, controls

如果涉及网站开发，我是新手。我想创建一个包含在 XML 文件中定义的控件的 Web 表单。这意味着我将在 Page_Load 函数中读取 XML 文件，并按照文件中的定义动态创建和命名所有控件。这看起来很容易。

然而，我还有另一个问题，即布局。当我在表单中添加一个新控件时，它会放置在之前创建的控件旁边。如何将它们放在另一个下方或在它们之前和之间放置一些空格？我认为使用 PlaceHolder 控件会对我有所帮助，但我找不到任何可以更改其父控件位置的属性。

以下是我创建单个控件的方法：

```
Label lbl = new Label();
lbl.ID = "lbl";
lbl.Text = "Test";
PlaceHolderMain.Controls.Add(lbl); 
```

提前感谢您的帮助，

马吕斯。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-26T12:11:22.300

你有几个选择：

1.  添加其他控件，例如[文字](http://www.google.com/search?hl=en&q=asp.net+literal+control&aq=1&oq=ASP.Net+liter)控件，其中文本是您想要的 HTML，例如`<BR/>`标记或`nbsp;`在已添加的控件之间。
2.  每个适当的部分都有多个占位符控件。
3.  使用 CSS 将控件放置在您想要的位置。我不是 CSS 专家，但这可以做到，但需要了解 CSS 定位。
4.  将控件添加到父控件（例如表格）中，以便您可以将控件添加到行内的表格单元格中。这意味着创建行和单元格以添加到表格中，但它可以让您更好地控制布局。

希望这能给你一些可以帮助的想法。

# closures - monad 和闭包有什么区别？

> ID：790719
> 
> 赞同：11
> 
> 时间：2009-04-26T11:57:54.610
> 
> 标签：closures, monads

我有点困惑阅读两者之间的定义。它们实际上可以在定义方面相交吗？还是我完全迷路了？谢谢。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-26T12:33:23.167

闭包，正如这个词所使用的那样，只是函数（或代码块，如果你喜欢的话），你可以像对待一段数据一样对待并传递给其他函数等（“封闭”位是指无论你在哪里最终调用它，它的行为就像你在它最初定义的地方调用它一样）。monad（大致）更像是一个上下文，其中函数可以按顺序链接在一起，并控制数据如何从一个函数传递到下一个函数。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-26T12:04:06.280

它们完全不同，尽管 monad 通常会*使用*闭包来捕获逻辑。

就我个人而言，在担心单子之前，我会尝试对闭包的定义（本质上是一段也捕获其环境的逻辑，即局部变量等）进行深入了解。他们可以稍后来:)

关于 Stack Overflow 上的闭包有各种各样的问题——最能帮助您的问题取决于您正在使用的平台。例如，有：

*   [.NET 中的闭包是什么？](https://stackoverflow.com/questions/428617/what-are-closures-in-net)
*   [函数指针、闭包和 lambda](https://stackoverflow.com/questions/208835/function-pointers-closures-and-lambda)

就我个人而言，我才刚刚开始“了解”单子（感谢我正在帮助的书）。有一天我会抽空写一篇关于它们的文章，当我觉得我足够了解它们时:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T03:42:49.230

“闭包”是一个对象，包括 1) 一个函数，以及 2) 构造它的自由变量的值。

“monad”是一类可以以某种方式组合的函数，即通过使用关联的*绑定*和*返回*高阶函数运算符，以产生其他函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-29T15:00:44.390

我认为 monad 比闭包稍微复杂一些，因为闭包只是从定义的角度记住某些内容的代码块，而 monad 是“扭曲”通常的函数组合操作的构造。

# eclipse - Eclipse IDE：如何放大文本？

> ID：790720
> 
> 赞同：161
> 
> 时间：2009-04-26T11:58:02.957
> 
> 标签：eclipse, eclipse-plugin

当您使用鼠标中的滚动按钮放大和缩小当前视图时，我希望 Firefox 具有相同的行为。日食有类似的东西吗？

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2011-10-19T14:59:48.393

有一个名为“tarlog”的人在这个谷歌代码网站上为 Eclipse 制作了一个插件：[http ://code.google.com/p/tarlog-plugins/downloads/detail?name=tarlog.eclipse.plugins_1 .4.2.jar&can=2&q=](http://code.google.com/p/tarlog-plugins/downloads/detail?name=tarlog.eclipse.plugins_1.4.2.jar&can=2&q=)

它还有一些 Eclipse 的其他功能，其中包括`Ctrl`+`+`和`Ctrl`+`-`来更改字体大小，这真是太棒了。

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2014-08-13T15:03:09.810

为时已晚，但可能会有所帮助：

转到窗口菜单 > 首选项 > 常规 > 外观 > 颜色和字体

然后转到 Java > Java 编辑器文本字体 > 编辑

* * *

## 回答 #3

> 赞同：64
> 
> 时间：2014-01-15T10:15:31.280

[Eclipse-Fonts](https://code.google.com/p/eclipse-fonts/)扩展将添加用于更改字体大小的工具栏按钮和键盘快捷键。然后您可以使用 AutoHotkey 进行**Ctrl+鼠标滚轮**缩放。

在**帮助 | 安装新软件...**在菜单中，将更新 URL ( [http://eclipse-fonts.googlecode.com/svn/trunk/FontsUpdate/](http://eclipse-fonts.googlecode.com/svn/trunk/FontsUpdate/) ) 粘贴到**Works with:**文本框中，然后按**Enter**。展开树并选择**FontsFeature**，如下图所示：

![Eclipse 扩展安装屏幕截图](https://i.stack.imgur.com/R2Ni5.png)

完成安装并重新启动 Eclipse，然后您应该会看到**A**工具栏按钮（在下图中以红色圈出），并且能够使用键盘快捷键**Ctrl+-**和**Ctrl+=**进行缩放（尽管您可能必须从 Eclipse 中取消绑定这些键第一的）。

![带有圈出字体大小工具栏按钮的 Eclipse 屏幕截图](https://i.stack.imgur.com/XHaX5.jpg)

要获得**Ctrl+MouseWheel**缩放，您可以使用[AutoHotkey](http://www.autohotkey.com/)和以下脚本：

```
; Ctrl+MouseWheel zooming in Eclipse.
; Requires Eclipse-Fonts (https://code.google.com/p/eclipse-fonts/).
; Thank you for the unique window class, SWT/Eclipse.
#IfWinActive ahk_class SWT_Window0
    ^WheelUp:: Send ^{=}
    ^WheelDown:: Send ^-
#IfWinActive 
```

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2015-12-02T18:16:53.497

从今晚每晚构建的 4.6/Neon 开始，Eclipse 平台包括一种使用**Ctrl+**和**Ctrl-**增加/减小文本编辑器字体大小的方法（在 Windows 或 Linux 上，**Cmd=**和**Cmd-**在 Mac OS X 上）：[https：/ /www.eclipse.org/eclipse/news/4.6/M4/#text-zoom-commands](https://www.eclipse.org/eclipse/news/4.6/M4/#text-zoom-commands)。该实现随使用该平台的最新版本的任何产品一起提供，并且比上述替代插件中的更可靠。它将在几周内更广泛地提供，届时 Neon M4 的 IDE 包将可用，并将成为 2016 年 6 月公开 Neon 版本的一部分。

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2017-06-10T05:36:53.180

我已经在这里回答了。 [如何在 Eclipse 中为 Java 文本编辑器更改字体大小？](https://stackoverflow.com/questions/4922305/how-can-i-change-font-size-in-eclipse-for-java-text-editors/42083500#42083500)

**对于 Eclipse 霓虹灯**

增加**Ctrl +**

减少**Ctrl -** [![在此处输入图像描述](https://i.stack.imgur.com/4cbMA.jpg)](https://i.stack.imgur.com/4cbMA.jpg)

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2017-06-04T10:56:32.860

要放大 Eclipse，您可以使用：**CTRL** **SHIFT** **+** OR **-**

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2018-07-05T05:32:19.220

根据最近的更改，您可以使用：(1) Ctrl/Shift/(+) 用于放大 (2) Ctrl/Shift/(-) 用于缩小

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2020-09-04T10:07:48.687

**放大：** `CTRL` + `SHIFT`+`+`
**缩小：** ` `CTRL`+ `SHIFT`+`-`

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2011-12-08T21:57:49.700

正如另一个答案中提到的，这个插件

[http://code.google.com/p/tarlog-plugins/downloads/detail?name=tarlog.eclipse.plugins_1.4.2.jar&can=2&q=](http://code.google.com/p/tarlog-plugins/downloads/detail?name=tarlog.eclipse.plugins_1.4.2.jar&can=2&q=)

使 Ctrl-+ 和 Ctrl-- 放大和缩小。在 MacOS 上是 ⌘+ 和 ⌘-。

但至少在 MacOS Lion 和 Eclipse Helios 上，⌘- 有效但⌘+ 无效——没有组合键（我尝试了一堆，包括 ⌘= 以及带有 Ctrl 和 Shift 的变体）会增加字体大小。但是，通过更改键绑定，我能够让它工作。

首选项 => 常规 => 键

命令“缩小”和“减小字体”已经设置为 ⌘-（这似乎有效），所以我将“放大”和“增加字体”设置为 ⌘=（其中一个是那个，另一个是 ⌘ +)，并且有效。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2017-09-06T10:42:34.500

转到 Eclipse > Preferences > General > Appearance > Color and Fonts > Basic > Text Font

我猜字体问题会解决。不需要任何插件。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2020-04-08T03:24:48.430

只需按**Ctrl** + **Shift** + ' **+** ' 或 ' **-** '。

至少，它在 Eclipse“2020-03”版本中对我有用。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2014-07-11T00:45:46.033

这是确保在 Eclipse 编辑器中使用鼠标滚轮进行放大和缩小的一种很酷的方法。这个从上面的解决方案中汲取灵感，来自 naveed ahmad，这对我不起作用。

[1) 首先从http://www.autohotkey.com/](http://www.autohotkey.com/)下载 Autohotkey并安装它，然后运行它。

[2) 然后从https://code.google.com/p/tarlog-plugins/downloads/list](https://code.google.com/p/tarlog-plugins/downloads/list)下载 tarlog-plugins

3) 将下载的 .jar 文件放在 eclipse/plugins 文件夹中。

4) 重启 Eclipse。

5）添加以下Autohotkey脚本，保存然后重新加载（右键单击任务栏中的Autohotkey图标并单击“重新加载此脚本”）

```
; Ctrl + MouseWheel zooming in Eclipse Editor.
; Requires Tarlog plugins (https://code.google.com/p/tarlog-plugins/).
#IfWinActive ahk_class SWT_Window0
^WheelUp:: Send ^{NumpadAdd}
^WheelDown:: Send ^{NumpadSub}
#IfWinActive 
```

你应该完成了。您现在可以使用 ctrl+mousewheel up 和 ctrl+mousewheel down 放大或缩小。唯一需要注意的是 Autohotkey 必须运行才能使该解决方案正常工作，因此请确保它从 Windows 启动或在启动 Eclipse 之前运行它。在 Eclipse Kepler 和 Luna 中运行良好。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-06-08T14:31:08.300

不幸的是，googlecode fontsupdate 不再起作用。但是，您可以从 github 下载代码：

[https://github.com/gkorland/Eclipse-Fonts](https://github.com/gkorland/Eclipse-Fonts)

只需将其下载为 .zip，并将其添加到 eclipse 中：

[添加本地插件](http://i.stack.imgur.com/qSUWN.png)

然后你又看到了熟悉的按钮！

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-06-14T10:08:44.260

在 Mac 上，您可以按“命令”和“+”按钮放大。按“命令”和“-”按钮缩小。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2016-10-11T21:11:55.830

比 @mifmif 更可靠：

转到窗口菜单 > 首选项 > 常规 > 外观 > 颜色和字体

然后去基本。

这部分有大约 5 种不同的字体，所有字体都包含一个大小。如果您转到任何其他部分中的项目（如@mifmif 建议的 Java > Java Editor Text Font），则将启用 Edit Default 和 Go to Default 按钮。单击后者会将您带到“基本”部分中的相应项目。单击前者可让您直接编辑该项目。

据我所知，更改 Basic 字体项不仅可以处理 Java 文本，还可以处理 Eclipse 中几乎所有其他可以调整大小的文本。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-01-19T01:27:19.613

这是一种比多层菜单更快的方法，无需借助插件：

使用左上角的快速访问工具。

输入“字体”，然后从下拉列表中单击“首选项->颜色和字体->常规->外观”链接。

一键取代了通过菜单到达那里所需的 4 个。我经常这样做，我的快速访问工具将它作为先前的选择拉到列表顶部，所以我只需按一下 Enter 键和 Boom! 输入“字体”，我就在那里。

如果您需要键盘快捷键，Ctrl+3 将焦点设置为快速访问工具。更好的是，这甚至会自动显示一个包含您之前选择的列表。您选择的最后一个将在顶部，在这种情况下，一个简单的 Ctrl+3 然后回车将带您直接到达那里！我一直使用它来在长时间的打字或阅读过程中将其放大以缓解眼睛疲劳，或者如果我需要一次在屏幕上显示更多文本以使其更容易找到某些内容，则将其缩小。

它不如使用滚轮缩放那么好，但它比每次都在菜单中导航要好得多！

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-06-20T22:06:06.067

我正在做的是使用 Windows 10 放大镜。与在 Firefox 上缩放不同，但它非常有用。

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2015-02-02T18:16:20.570

tarlog 插件与从 eclipse.ini 中删除 -Dorg.eclipse.swt.internal.carbon.smallFonts 相结合，帮助我在 Eclipse Luna (4.4) 的 MacOS Yosemite 上疲惫的眼睛。

问题：我对 PyDev foo.py Python 文件不起作用。解决方法：打开一个名为 foo.java 的文件 - 更改字体大小。回到 foo.py，瞧！- python 字体大小与 java 字体大小匹配。

# visual-studio - 在 Visual Studio 中添加引用 DLL 问题

> ID：790727
> 
> 赞同：1
> 
> 时间：2009-04-26T12:02:06.423
> 
> 标签：visual-studio, build-process, reference

我正在使用 VSTS 2008。我在一个解决方案文件中有两个项目（都是用 C# 编写的）。项目 1 依赖于项目 2 的输出（DLL2）。所以，在项目 1 中，我使用“引用 --> 添加引用 --> 浏览”，然后找到并选择项目 2 生成的 DLL2。

我的问题是，我不确定使用这种方法添加引用是否会导致我的本地计算机特定的文件路径依赖？更详细地说，假设两个项目都位于文件夹 d:\testprojectsolution（d:\testprojectsolution\project1 和 d:\testprojectsolution\project2）中，我想确保如果我复制整个解决方案文件夹 d:\testprojectsolution (具有与 project1/project2 相同的结构）到不同位置的其他人（例如 c:\my documents\sampleprpjects\projects），他们可以成功构建（不依赖于我本地机器上的任何特定文件路径，例如，不需要在 d:\testprojectsolution\project2 或其他东西下查找文件）。

如果我添加引用依赖项的方法可能会导致某些特定的文件路径依赖项，请告诉我如何解决此问题。:-)

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-26T12:03:21.803

不是使用浏览添加引用，而是使用项目选项卡添加它。它会自动考虑项目依赖（以及构建顺序）和其他东西。

# linq - Linq 和一个带有两个表的选择

> ID：790739
> 
> 赞同：1
> 
> 时间：2009-04-26T12:05:00.897
> 
> 标签：linq, entity-framework

我想使用 linq 进行此选择：

```
Select cd.name from Content c, ContentDetail cd
where c.id_contentTypeID = contentTypeId and
      c.id_contentID = contentID and
      cd.id_contentID = c.contentID; 
```

我已经完成了以下操作，但我不知道如何结束查询：

```
var list =
    from c in guideContext.Content, 
        dc in guideContext.ContentDetail
    where c.id_content == contentID &&

    select dc; 
```

有什么建议吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T12:19:30.393

您可以使用 LINQ 连接来执行此操作，如下例所示：

```
var query = from c in guidecontext.Content
            join cd in guidecontext.ContentDetail
            on c.id_contentID equals cd.id_contendID
            where c.id_contendID = contentId
            && c.contentTypeId = contentTypeId
            select cd.name; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T12:09:49.823

这应该做的工作：

```
var list = from cd in guideContext.ContentDetail
           where cd.id_contentID == contentID && 
                 cd.Content.id_contentTypeID == contentTypeId
           select cd; 
```

# java - 禁用 s:select 中的值

> ID：790742
> 
> 赞同：2
> 
> 时间：2009-04-26T12:06:00.707
> 
> 标签：java, struts

如果我有这样的`Struts`标签...

```
<s:select name="country.id" list="countries" listValue="name" listKey="id" headerValue="Select Country" headerKey="" label="Country" />` 
```

这是输出代码...

```
<select name="country.id" tabindex="12" id="registration_country">
    <option value="">Select Country</option>
    <option value="1">United States</option>
    <option value="2">Afghanistan</option>
    <option value="3">Albania</option>
    <option value="4">Algeria</option>
    ...
    <option value="192">Zambia</option>
    <option value="193">Zimbabwe</option>
</select> 
```

如果我想禁用某些值，例如选项编号 1、3 和 4，我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T13:35:10.623

你不能。只需遍历集合并根据您的条件设置禁用属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-26T08:14:40.170

如果您向用户显示选项，您必须让他/她/它操作。

否则，请禁用选项或隐藏选项。

而且您不能在给定的选择组件中“禁用”特定选项，因此很容易隐藏不需要的选项。

# windows - 推荐的 GnuPG 密钥大小和类型？

> ID：790744
> 
> 赞同：5
> 
> 时间：2009-04-26T12:08:34.320
> 
> 标签：windows, gnupg

[A Practical Introduction to GNU Privacy Guard in Windows](http://www.glump.net/howto/cryptography/practical-introduction-to-gnu-privacy-guard-in-windows)推荐 DSA 和 ElGamal，但我想知道现在 RSA 是否足够好使用，如果是，我应该使用什么最小密钥大小？是否可以使用 SHA-256 进行签名（为了与电子邮件客户端兼容）？

另外，除了[e-ignite: Key Types](http://www.e-ignite.co.uk/html/key_types.html)，你能指出这个主题的其他来源吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-26T12:18:23.517

今天的 RSA/DSA 最小值实际上是 1024 位，因此椭圆曲线的使用越来越多，因为它们更快并且使用更短的密钥。

要获得与 AES256 类似的安全性，您至少需要 3072 位（384 字节）密钥...

现在使用证书的电子邮件客户端 - 所以它是单独的东西（X.509），但与 RSA/DSA 一起使用最常见的选项是 SHA-1（现在有点弱）。

我建议研究：

*   [http://en.wikipedia.org/wiki/Digital_signature](http://en.wikipedia.org/wiki/Digital_signature)
*   [http://en.wikipedia.org/wiki/X.509](http://en.wikipedia.org/wiki/X.509)
*   [http://www.rsa.com/rsalabs/node.asp?id=2264](http://www.rsa.com/rsalabs/node.asp?id=2264)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-03-22T16:30:52.900

我知道这个话题很老了，但是在这个时候，DSA 1024 被认为太弱了，SHA-1 也是如此。您应该使用 RSA 2048（用于签名和加密）和 SHA256（用于摘要）。通常，使用的对称算法是AES256，已经足够好了。

加密时，GPG 压缩数据，创建 AES256 密钥并用它加密数据。然后，它使用接收方 RSA 或 ElGamal 公钥加密 AES 密钥，并以包的形式发送加密的 AES 密钥 + 加密数据。

据说 RSA 2048 可以保护数据到 2015 年左右，而 RSA 4096 可以保护数据到 2020 年，这取决于当时预测的计算机能力。（我不完全确定日期，但 4096 位密钥比 2048 位密钥更难破解是合乎逻辑的）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-26T12:41:47.657

SHA-1 很弱，但没有完全损坏。SHA-256 只是 SHA-1 的扩展，目前它可能也比最初想象的要弱（考虑到同样的弱点被认为会影响整个 sha 家族），但是它仍然需要大量的计算能力才能获得匹配。

无论如何，就数字签名而言，由于这只是最后一步的方式，这不再是一个问题。还是先加密。

至于密钥大小，无论是 RSA 还是 ElGammel/DSA，我现在无论如何都会推荐 2048 位密钥。不同之处在于 RSA 基于阶乘数学，而 ElGammel/DSA 基于对数数学，两者都不一定被认为是更好或更差（尽管我认为基于椭圆曲线的东西与对数的东西密切相关）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-30T02:27:41.030

我会推荐带有 AES256 和 SHA512 的 RSA/RSA 4096

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-09-09T10:55:39.603

GPG 只能使用 RSA 进行签名，不能加密。默认值为 DSA/Elgamal 1024/2048。Elgamal 的默认密钥长度曾经是 1024，但一定有人认为这不够安全。GPG 邮件列表上的人说，大多数人不应该需要超过 2048 个。

我对各种签名算法不太清楚。我知道 SHA-1 存在问题，但这与 DSA/RSA 有什么关系？

多年来，我一直拥有使用上述默认值的相同密钥。我用的不多，但想知道生成一个新的是否合理。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2013-02-10T12:48:19.843

如果你不知道，你应该使用 GPG 默认值！（这就是作者的意图。）

# ios - 如何更改 UITabBar 选择颜色

> ID：790746
> 
> 赞同：38
> 
> 时间：2009-04-26T12:09:20.637
> 
> 标签：ios, iphone, objective-c, cocoa-touch, uitabbar

我需要将 UITabBar 的选择颜色从默认的蓝色更改为红色。我们如何做到这一点。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2015-09-03T08:50:21.760

**2017 年 9 月更新：** 我写这个答案已经两年了，因为它经常收到支持，我应该说这可能是这个问题的最糟糕的答案，它容易出错，可能会因为 iOS 更新而中断，很难调试等，所以请不要做我写的事情并应用更好的解决方案，例如子类化 UITabBar 或 UITabBarController。谢谢。

您可以通过为您的 UITabBar 设置“tintColor”属性（键路径）来做到这一点。

1.  在文档大纲中选择 UITabBar。（**不是**带有黄色图标的控制器。）
2.  在 Utilities 区域中选择 Identity Inspector。
3.  单击“用户定义的运行时属性”中的 +。
4.  添加“颜色”类型的“tintColor”键路径和您想要的颜色。

这应该这样做。您可以对照下面的屏幕截图进行检查。

[![在此处输入图像描述](https://i.stack.imgur.com/nHz9w.png)](https://i.stack.imgur.com/nHz9w.png)

**更多信息：** UITabBar 的 Identity Inspector 中有一个“Tint”属性，我相信它会做同样的事情，但显然，它什么也没做。它的默认值是选择 UITabBarItem 时的确切默认填充颜色，所以我猜它会在稳定版本 Xcode 7 中修复。手指交叉。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-01-16T17:26:26.233

在 IOS5 中，UITabBar 有一个[selectedImageTintColor](http://developer.apple.com/library/ios/documentation/uikit/reference/UITabBar_Class/Reference/Reference.html#//apple_ref/occ/instp/UITabBar/selectedImageTintColor)属性，可以满足您的需要。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-09-25T05:00:38.743

在 iOS 7 中，它只是 tintColor。实现此目的的一种方法是继承 UITabBarViewController，在情节提要中设置自定义类，并在`viewDidLoad`子类化 tabBarVC 的方法中添加：

```
[[self tabBar] setTintColor:[UIColor redColor]]; 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2017-10-17T06:05:10.373

[![在此处输入图像描述](https://i.stack.imgur.com/jLuYQ.jpg)](https://i.stack.imgur.com/jLuYQ.jpg)

要达到上述结果，请执行以下步骤。

**第 1 步：**在 中添加您想要的图像`Assets.xcassets`，并确保它们`Render As`：`Default`

[![在此处输入图像描述](https://i.stack.imgur.com/M7lHK.png)](https://i.stack.imgur.com/M7lHK.png)

**第2步：**选择您的`UITabBar`对象并设置`Image Tint`颜色，此颜色将被选中标签颜色

[![在此处输入图像描述](https://i.stack.imgur.com/PQsJn.png)](https://i.stack.imgur.com/PQsJn.png)

**第 3 步：**选择`UITabBar`对象并在**User Defined Runtime Attributes中添加****Key Path** : `unselectedItemTintColor`, **Type** : `Color`, **Value** : 。`Choose color for unselected item`

 **[![在此处输入图像描述](https://i.stack.imgur.com/fW0xR.png)](https://i.stack.imgur.com/fW0xR.png)

全部完成。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2012-12-03T02:43:48.350

这非常容易

创建一个自定义类的**UITabBarController**并在`-(void)viewDidLoad`方法中添加以下行：

```
[[self tabBar] setSelectedImageTintColor:[UIColor greenColor]]; 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-03-31T15:50:51.653

因为 UITextAttributeTextColor 在 iOS 7 中已被弃用，您应该使用：

```
[UITabBarItem.appearance setTitleTextAttributes:@{NSForegroundColorAttributeName : [UIColor greenColor]} forState:UIControlStateNormal];    
[UITabBarItem.appearance setTitleTextAttributes:@{NSForegroundColorAttributeName : [UIColor purpleColor]} forState:UIControlStateSelected]; 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2016-11-03T09:14:02.097

只需在界面生成器中更改 TabBar 的以下属性

![](https://i.stack.imgur.com/6q28Q.png)

显然在我的情况下它是白色的。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2016-02-04T14:35:56.513

从 iOS 8 开始，它很简单：

```
UITabBar.appearance().tintColor = UIColor.redColor() 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-04-26T17:21:45.267

SDK 并没有使这变得容易，但在*技术上*是可行的。苹果显然认为这是他们一致外观和感觉愿景的一部分。

UITabBar 是 UIView 的子类。你总是可以继承并实现你自己的`-drawRect:`

这不是一项简单的任务，但是，您必须从头开始重新实现该类，否则您将面临一些奇怪的副作用。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2020-07-21T05:54:17.767

## Swift 5 以编程方式

在 Swift 5 中这很容易。

在你`TabBarController`写这个：

```
tintColor = UIColor.red 
```

而已

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2013-04-16T09:01:32.497

我一直在寻找一种方法来设置 UITabBarItem 的选定文本颜色，并找到了一个非常简单的方法，使用 UIAppearance 协议。

```
[UITabBarItem.appearance setTitleTextAttributes:@{
        UITextAttributeTextColor : [UIColor greenColor] } forState:UIControlStateNormal];

[UITabBarItem.appearance setTitleTextAttributes:@{
        UITextAttributeTextColor : [UIColor purpleColor] }     forState:UIControlStateSelected]; 
```

请原谅可怕的颜色！

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-10-05T20:09:33.630

iOS 5.0 修复了这个问题，但解决方案是在保密协议下。在您的文档中查找 UITabBar 以获得一种简单的方法来做您想做的事情。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-06-11T19:25:24.653

我找到了最简单的解决方案 -

1.  在标签栏控制器中选择标签栏

2.  设置图像色调颜色

3.  设置色调颜色

有关参考，请参阅附图。

[![在此处输入图像描述](https://i.stack.imgur.com/SqPAv.jpg)](https://i.stack.imgur.com/SqPAv.jpg)

# json - 将 json 文件导入到沙发 db-

> ID：790757
> 
> 赞同：13
> 
> 时间：2009-04-26T12:17:30.647
> 
> 标签：json, couchdb

如果我有一个看起来像这样的 json 文件：

```
{"name":"bob","hi":"hello"}
{"name":"hello","hi":"bye"} 
```

是否可以将其导入到 couchdb 中？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-19T22:32:51.080

从@Millhouse 答案开始，但我使用的文件中有多个文档

```
cat myFile.json | lwp-request -m POST -sS "http://localhost/dbname/_bulk_docs" -c "application/json" 
```

`POST`是的别名，`lwp-request`但`POST`似乎不适用于 debian。如果你使用`lwp-request`你需要`-m`像上面那样设置方法。

尾随`_bulk_docs`允许一次上传多个文档。

[http://wiki.apache.org/couchdb/HTTP_Bulk_Document_API](http://wiki.apache.org/couchdb/HTTP_Bulk_Document_API)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-03-15T17:14:04.130

如果您使用的是 Linux，您可以编写一个快速的 shell 脚本来将有效 json 文件的内容发布到 Couch。

为了测试沙发，我做了这样的事情：

```
cat myFile.json | POST -sS "http://myDB.couchone.com/testDB" -c "application/json" 
```

myFile.json 有我想要导入数据库的 json 内容。

另一种选择，如果您不喜欢命令行或不使用 Linux，并且更喜欢 gui，则可以使用[RESTClient 之类的工具](https://code.google.com/p/rest-client/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-04-03T11:01:14.063

可能回答有点晚了。但是如果你可以使用 Python，那么你可以使用**couchdb**模块来做到这一点：

```
import couchdb
import json
couch = couchdb.Server(<your server url>)
db = couch[<your db name>]
with open(<your file name>) as jsonfile:
    for row in jsonfile:
        db_entry = json.load(row)
        db.save(db_entry) 
```

我创建了 python 脚本来做到这一点（因为我在 Internet 上找不到）。

完整的脚本在这里：：

[http://bitbucket.org/tdatta/tools/src/](http://bitbucket.org/tdatta/tools/src/)

（名称 --> jsonDb_to_Couch.py​​）

如果您下载完整的 repo 并且：

1.  文本将 json 文件中的所有“_id”替换为“id”

2.  运行 make load_dbs

它将在您的本地沙发安装中创建 4 个数据库

希望对新手有帮助（比如我）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-03-26T07:27:53.617

是的，这不是有效的 JSON ...

要导入 JSON 对象，我使用 curl (http://curl.haxx.se)：

```
curl -X PUT -d @my.json http://admin:secret@127.0.0.1:5984/db_name/doc_id 
```

其中 my.json 是 JSON-Object 所在的文件。当然，您也可以将 JSON-Object 直接放入 couchdb（没有文件）：

```
curl -X PUT -d '{"name":"bob","hi":"hello"}' http://admin:secret@127.0.0.1:5984/db_name/doc_id 
```

如果您没有 doc_id，您可以向 couchdb 索取：

```
curl -X GET http://127.0.0.1:5984/_uuids?count=1 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-26T14:33:52.660

CouchDB 不会接受该 JSON 对象。要使用单个服务器请求存储所有数据，请使用：

```
{
  "people": 
   [
      {
        "name":"bob",
        "hi":"hello"
      },
      { 
        "name":"hello",
        "hi":"bye"
      }
   ]
} 
```

或者，为每一行提交不同的 CouchDB 请求。

使用 cURL 从命令行将文件导入 CouchDB：

```
curl -vX POST https://user:pass@127.0.0.1:1234/database \
  -d @- -# -o output -H "Content-Type: application/json" < file.json 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-09-02T18:12:34.853

这不是我的解决方案，但我发现这可以解决我的问题：

将 CouchDB 数据库导出到文件的一种简单方法是在终端窗口中运行以下 Curl 命令：

```
curl -X GET http://127.0.0.1:5984/[mydatabase]/_all_docs\?include_docs\=true > /Users/[username]/Desktop/db.json 
```

下一步是将导出的 json 文件修改为如下所示（注意 _id）：

```
{
  "docs": [
      {"_id": "0", "integer": 0, "string": "0"},
      {"_id": "1", "integer": 1, "string": "1"},
      {"_id": "2", "integer": 2, "string": "2"}
  ]
} 
```

您需要查看的主要内容是在“docs”代码块中添加文档。完成此操作后，您可以运行以下 Curl 命令将数据导入 CouchDB 数据库：

```
curl -d @db.json -H "Content-type: application/json" -X POST http://127.0.0.1:5984/[mydatabase]/_bulk_docs 
```

复制数据库 如果要将数据库从一台服务器复制到另一台服务器。运行以下命令：

```
curl -H 'Content-Type: application/json' -X POST http://localhost:5984/_replicate -d ' {"source": "http://example.com:5984/dbname/", "target": "http://localhost@:5984/dbname/"}' 
```

原帖： [http ://www.greenacorn-websolutions.com/couchdb/export-import-a-database-with-couchdb.php](http://www.greenacorn-websolutions.com/couchdb/export-import-a-database-with-couchdb.php)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-25T21:12:41.017

[http://github.com/zaphar/db-couchdb-schema/tree/master](http://github.com/zaphar/db-couchdb-schema/tree/master)

我的 DB::CouchDB::Schema 模块有一个脚本可以帮助将一系列文档加载到 CouchDB 数据库中。couch_schema_tool.pl 脚本接受一个文件作为参数并将该文件中的所有文档加载到数据库中。只需将每个文档放入一个数组中，如下所示：

[ {"name":"bob","hi":"hello"}, {"name":"hello","hi":"bye"} ]

它将为您将它们加载到数据库中。一个小小的警告，虽然我没有针对 CouchDB 的最新代码测试我的最新代码，所以如果你使用它并且它坏了，请告诉我。我可能必须更改一些内容以适应新的 API 更改。

杰里米

# flash - 通过 Actionscript 在舞台上放置影片剪辑

> ID：790769
> 
> 赞同：0
> 
> 时间：2009-04-26T12:28:40.650
> 
> 标签：flash, actionscript-2

我有一个任务，有一次我必须在舞台上放一个电影剪辑。我不能只是拖动它并将其放置并在某个时间点将其设置为可见，我必须使用 Actionscript 从库中将其拉出并使其以特定的 X/Y 坐标出现在舞台上。

我的任务说该功能`attachMovie()`很有用，但我不知道如何，因为它用于将影片剪辑附加到其他影片剪辑......

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T12:35:02.930

您可以在舞台上使用 attachMovie。

在 AS2 中是这样的：

```
_root.attachMovie("name_of_the_original_clip", "name_of_the_new_clip", _root.getNextHighestDepth()); 
```

在 AS2 中，舞台本身被视为一个电影剪辑。我希望它有帮助！

# asp.net - 缓存最佳实践

> ID：790774
> 
> 赞同：5
> 
> 时间：2009-04-26T12:31:23.530
> 
> 标签：asp.net, asp.net-mvc, caching

每个人。有人可以分享一些关于 ASP MVC 应用程序中的后端缓存和片段缓存、最佳缓存体系结构等的文章链接。任何有用的建议也将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-26T12:44:51.843

详细快速入门：

*   [部分输出缓存（有些人](http://blog.codeville.net/2008/10/15/partial-output-caching-in-aspnet-mvc/)[在这里](http://blog.rthand.com/post/2009/03/21/Partial-Output-Caching-in-ASPNET-MVC-updated.aspx)重新思考）
*   [ASP.NET MVC 动作过滤器 - 缓存和压缩](http://weblogs.asp.net/rashid/archive/2008/03/28/asp-net-mvc-action-filter-caching-and-compression.aspx)和
*   [ASP.NET MVC 查看位置和性能问题](http://weblogs.asp.net/rashid/archive/2009/04/23/asp-net-mvc-view-location-and-performance-issue.aspx)。

# windows-services - 我的 Windows 服务应用设置项目中出现错误 1001

> ID：790795
> 
> 赞同：7
> 
> 时间：2009-04-26T12:45:27.943
> 
> 标签：windows-services, setup-deployment

我正在尝试使用 Visual Studio 2008 安装和部署项目安装我的 Windows 服务应用程序。我创建了一个具有“作为服务运行”权限的用户帐户，并将 ServiceProcessInstaller.Account 设置为 System.ServiceProcess.ServiceAccount.User 以及我之前创建的用户的用户名和密码。

```
spInstaller.Account = System.ServiceProcess.ServiceAccount.User;
spInstaller.Username = "USER NAME";
spInstaller.Password = "PASSWORD";

sInstaller.ServiceName = "SERVICE NAME";
sInstaller.StartType = System.ServiceProcess.ServiceStartMode.Automatic; 
```

但是在设置过程中，我收到以下错误：

**错误：1001。帐户名无效或不存在，或指定帐户名的密码无效**

任何想法为什么我会收到此错误以及如何解决它？谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-26T12:49:02.380

您是否为您的用户名指定域。即如果你的机器被称为 FASTCAR 你试过了吗

```
spInstaller.UserName = "FASTCAR\\UserName"; 
```

# powershell - 与 Get-ChildItem cmdlet 的 -Include 参数混淆

> ID：790796
> 
> 赞同：12
> 
> 时间：2009-04-26T12:45:47.210
> 
> 标签：powershell, include, get-childitem

从文档：

> -包括
> 
> 仅检索指定的项目。此参数的值限定了 Path 参数。输入路径元素或模式，例如“*.txt”。允许使用通配符。
> 
> Include 参数仅在命令包含 Recurse 参数或路径指向目录的内容时才有效，例如 C:\Windows*，其中通配符指定 C:\Windows 目录的内容。

我的第一个理解是：

```
c:\test\a.txt
c:\test\b.txt 
```

所以要得到 'a.txt' 和 'b.txt' 我可以写：

```
gci -Path "c:\test\*" -Include "*.txt" 
```

这有效。但现在考虑这样的层次结构：

```
c:\test\a.txt
c:\test\b.txt
c:\test\c.txt\c.txt 
```

相同的命令返回：a.txt、b.txt、c.txt

实际的逻辑似乎是：

> -Include 用于匹配 -Path 指定的所有实体。如果匹配的元素是一个文件 - 返回它。如果匹配的元素是文件夹，则查看内部并返回匹配的第一级子级。

此外，文档说：

> Include 参数仅在命令包含 Recurse 参数或路径指向目录的内容时才有效...

这也是错误的。例如

```
gci -Path "c:\test" -Include "*.txt" 
```

它什么也不返回，而没有 -Include 我得到文件夹内容。所以 -Include 绝对是“有效的”。这里到底发生了什么？-Path 指定“c:\test”，-Include 尝试匹配此路径。由于“*.txt”与“test”不匹配，所以没有返回任何内容。但是看看这个：

```
gci -Path "c:\test" -Include "*t" 
```

它返回 a.txt、b.txt 和 c.txt 作为 "*t" 匹配 "test" 并匹配所有子项。

毕竟，即使现在知道 Include 是如何工作的，我也不明白什么时候使用它。为什么我需要它查看子文件夹内部？为什么要这么复杂？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-26T14:05:43.930

您混淆了 -include 的使用。-include 标志应用于路径，而不是路径的内容。如果不使用递归标志，唯一有问题的路径就是您指定的路径。这就是您给出的最后一个示例有效的原因，路径在路径`c:\test`中有 at ，因此为 match `"*t"`。

您可以通过尝试以下方法来验证这一点

```
gci -path "c:\test" -in *e* 
```

这仍然会产生目录中的所有孩子，但它与他们的名字都不匹配。

-include 使用 recurse 参数更有效的原因是您最终将通配符应用于层次结构中的每个路径。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-26T16:57:23.330

试试 -filter 参数（它只支持一个扩展）：

dir -filter *.txt

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-26T14:22:15.700

继续[JaredPar 的回答](https://stackoverflow.com/questions/790796/confused-with-include-parameter-of-the-get-childitem-cmdlet/790895#790895)，为了使用 Get-ChildItem 进行模式匹配，您可以使用常见的 shell 通配符。

例如：

```
get-childitem "c:\test\t?st.txt" 
```

“？”在哪里？是与任何一个字符匹配的通配符或

```
get-childitem "c:\test\*.txt" 
```

这将匹配任何以“.txt”结尾的文件名。

这应该为您提供您正在寻找的“更简单”的行为。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-09-02T21:40:58.283

我刚刚问了一个类似的问题，并得到了三个关于Get-ChildItem的[Get-Help的快速回复。](http://technet.microsoft.com/en-us/library/hh849696.aspx)

> 答案在命令的完整描述中（Get-Help Get-ChildItem -full）：
> 
> ```
> The Include parameter is effective only when the command includes the 
> ```
> 
> 递归参数或路径指向目录的内容，例如 C:\Windows*，其中通配符指定 C:\Windows 目录的内容。
> 
> 因此，以下内容无需递归即可工作。
> 
> PS C:\foo> Get-childitem -path "c:\foo*" -Include *.txt

来自 Stack Overflow 问题*[PowerShell Scripting - Get-ChildItem](https://stackoverflow.com/questions/1370210/)*。

我希望这有帮助 ：-）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-04-08T02:04:58.790

包括`\*`在路径的末尾应该可以解决这个问题

```
PS C:\logfiles> Get-ChildItem .\* -include *.log 
```

这应该从当前工作目录返回 .log 文件 ( `C:\logfiles`)

上面 Alex 的示例表明名称为 foo.log 的目录也将被返回。当我尝试它时，它不是，但它是 6 年后，这可能来自 PS 更新。

但是，您可以使用子项`Mode`来排除我认为的目录。

```
PS C:\logfiles> Get-Childitem .\* -include *.log | where-object {$_.mode -notmatch "d"} 
```

这应该排除设置了“目录”模式的任何内容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-06-16T22:28:32.973

get-childitem -include 仅适用于路径中的 -recursive 或通配符。我认为这是一个错误[认为它在 PS 6 中有所不同]。

# c# - 使用 IsNullOrEmpty 扩展 String 类是否令人困惑？

> ID：790810
> 
> 赞同：12
> 
> 时间：2009-04-26T12:58:13.560
> 
> 标签：c#, string, extension-methods

每个人都知道并喜欢 String.IsNullOrEmpty(yourString) 方法。

我想知道如果我们将 String 类扩展为具有这样的方法，是否会使开发人员感到困惑或使代码更好：

```
yourString.IsNullOrEmpty(); 
```

**临：**

1.  更具可读性。
2.  少打字。

**缺点：**

1.  可能会令人困惑，因为`yourString` 变量可能是`null`并且看起来您正在对 `null`变量执行方法。

你怎么看？

`myObject.IsNull()`关于方法，我们可以问同样的问题。

那我会怎么写：

```
public static class StringExt
{
  public static bool IsNullOrEmpty(this string text)
  {
    return string.IsNullOrEmpty(text);
  }

  public static bool IsNull(this object obj)
  {
    return obj == null;
  }
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-26T15:35:06.833

如果我没记错的话，这里的每个答案都谴责可以在空实例上调用扩展方法的事实，因此他们不支持相信这是一个好主意。

让我反驳他们的论点。

我根本不相信在可能为 null 的对象上调用方法会令人困惑。事实是我们只检查某些位置的空值，而不是 100% 的时间。这意味着我们进行的每个方法调用都有一定比例的时间可能在空对象上。这是可以理解和接受的。如果不是，我们将在每个方法调用之前检查 null。

那么，一个特定的方法调用可能发生在一个空对象上，这会让人感到困惑吗？看下面的代码：

```
var bar = foo.DoSomethingResultingInBar();
Console.Writeline(bar.ToStringOr("[null]")); 
```

你困惑吗？你应该。因为这里是 foo 的实现：

```
public Bar DoSomethingResultingInBar()
{
  return null; //LOL SUCKER!
} 
```

看？您阅读代码示例时完全不会感到困惑。您了解， foo 可能会从该方法调用返回 null，而 ToStringOr 调用`bar`将导致 NRE。你头晕吗？当然不是。它明白这可能发生。现在，那个 ToStringOr 方法并不熟悉。在这些情况下你会怎么做？您要么阅读该方法的文档，要么检查调用的代码。这里是：

```
public static class BarExtensions
{
  public static string ToStringOr(this bar, string whenNull)
  {
    return bar == null ? whenNull ?? "[null]" : bar.ToString();
  }
} 
```

令人困惑？当然不是。很明显，开发人员想要一种检查是否`bar`为空并用非空字符串替换它的速记方法。这样做可以显着减少您的代码并提高可读性和代码重用性。当然，您可以通过其他方式做到这一点，但这种方式不会比任何其他方式更令人困惑。例如：

```
var bar = foo.DoSomethingResultingInBar();
Console.Writeline(ToStringOr(bar, "[null]")); 
```

当您遇到此代码时，您与原始版本有什么不同？您仍然必须检查代码，您仍然必须确定它在`bar`为空时的行为。你仍然必须处理这种可能性。

扩展方法是否令人困惑？只有当你不理解它们时。而且，坦率地说，语言的任何部分都可以这样说，从代表到 lambda。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-26T13:05:55.243

我认为这个问题的根源是 Jon Skeet[在他最喜欢的语言](https://stackoverflow.com/questions/282329/what-are-five-things-you-hate-about-your-favorite-language/282342#282342)(C#) 中所讨厌的事情列表中提到的：C# 不应该自动导入整个*命名空间*中的所有扩展方法。这个过程应该更明确地完成。

我对这个具体问题的个人看法是（因为我们对上述事实无能为力）如果您愿意，可以使用扩展方法。我并不是说它不会令人困惑，但是关于扩展方法（可以在`null`引用上调用）的事实是一个全局性的事情，并且不仅仅影响`String.IsNullOrEmpty`，所以 C# 开发人员应该熟悉它。

顺便说一句，幸运的是，Visual Studio`(extension)`在 IntelliSense 工具提示中清楚地识别了扩展方法。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-26T13:03:10.520

我真的很喜欢这种方法，只要该方法清楚地表明它正在检查对象是否为空。ThrowIfNull、IsNull、IsNullOrEmpty 等，可读性很强。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-26T13:40:37.670

我个人不喜欢这样做。目前扩展方法的最大问题是可发现性。除非您完全了解特定类型上存在的所有方法，否则不可能查看方法调用并知道它是扩展方法。因此，我发现使用扩展方法做任何事情都是有问题的，而这在普通方法调用中是不可能的。否则你最终会让开发人员感到困惑。

C++ 中存在这个问题的必然结果。在几个 C++ 实现中，只要不触及类型上的任何字段或虚拟方法，就可以在 NULL 指针上调用实例方法。我已经使用了几段有意执行此操作的代码，并在“ `this==NULL`”时为方法提供不同的行为。和它一起工作真是令人抓狂。

这并不是说我不喜欢扩展方法。恰恰相反，我喜欢它们并且经常使用它们。但我认为在编写它们时应该遵循两条重要的规则。

*   将实际的方法实现视为只是另一个静态方法，因为它实际上是。例如，为 null this 抛出 ArgumentException 而不是 NullReference 异常
*   不要让扩展方法执行普通实例方法无法做到的技巧

**编辑**回应 Mehrdad 的评论

利用它的问题是我不认为 str.IsNullOrEmpty 比 String.IsNullOrEmpty(str) 具有显着的功能优势。我看到的唯一优势是一个比另一个需要更少的打字。对于一般的扩展方法也可以这样说。但在这种情况下，您还改变了人们对程序流程的看法。

如果更短的输入是人们真正想要的，那么 IsNullOrEmpty(str) 不是更好的选择吗？它既明确又是最短的。True C# 目前不支持此类功能。但是想象一下，如果在 C# 中我可以说

```
using SomeNamespace.SomeStaticClass; 
```

这样做的结果是 SomeStaticClass 上的所有方法现在都在全局命名空间中并且可用于绑定。这似乎是人们想要的，但他们将它附加到我不是一个超级粉丝的扩展方法上。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-26T13:07:17.407

就个人而言，我不会创建一个扩展来执行框架中已经存在的事情，除非它在可用性方面有重大改进。在这种情况下，我认为情况并非如此。另外，如果我要创建一个扩展，我会以一种减少混淆的方式命名它，而不是增加它。同样，我认为这个案例没有通过测试。

说了这么多，我确实有一个字符串扩展，不仅可以测试字符串是否为空或空，还可以测试它是否只包含空格。我称之为`IsNothing`。你可以在[这里](https://stackoverflow.com/questions/786706/why-is-there-no-isnullorempty-overload-method-without-parameters/786806#786806)找到它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-26T13:16:46.790

它不只是看起来像你在一个空变量上调用一个方法。您/正在/调用空变量上的方法，尽管该方法是通过静态扩展方法实现的。我不知道扩展方法（我已经对此持怀疑态度）支持这一点。这甚至可以让你做一些疯狂的事情，比如：

```
public static int PowerLength(this string obj)
{
return obj == null ? 0 : obj.Length;
} 
```

从我现在的立场来看，我会将对null 引用的*任何扩展方法的使用归类为***被认为是有害**的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-26T13:22:24.983

是的，它会混淆。

我认为每个了解它`IsNullOrEmpty()`的人都认为使用它是很自然的。因此，您建议的扩展方法不会增加可读性。

也许对于刚接触 .NET 的人来说，这种扩展方法可能更容易处理，但有~~可能~~她/他不了解扩展方法的所有方面（例如，您需要导入命名空间并且它可以是在 null 上调用）。她/他可能想知道为什么这个扩展方法在另一个项目中不存在。无论如何：即使有人是 .NET 的新手，该`IsNullOrEmpty()`方法的语法也可能会很快变得自然。同样在这里扩展方法的好处不会超过它引起的混乱。

编辑：试图改写我想说的话。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-26T15:05:19.060

让我们看看 pro:s 和 con:s ...

> 1.  更具可读性。

是的，稍微有点，但是可读性的提高被这样一个事实所抵消，因为看起来你正在调用一个不一定是实例的东西的实例方法。实际上它更容易阅读，但更难理解，因此提高的可读性实际上只是一种错觉。

> 2.  少打字。

是的，但这真的不是一个强有力的论点。如果打字是您编程的主要部分，那么您只是没有做一些具有挑战性的事情，足以让您发展成为一名开发人员。

> 1.  可能会令人困惑，因为 yourString 变量可以为 null 并且看起来您正在对 null 变量执行方法。

是的，（如上所述）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-26T13:06:04.493

我认为使用“IsNull”类型调用扩展任何对象有点令人困惑，应尽可能避免。

有争议的是 IsEmptyString 方法可能对 String 类型有用，并且因为您通常将它与 null 测试结合使用 IsNullOrEmpty 可能有用，但我也会避免这种情况，因为字符串类型已经有一个静态方法可以做到这一点，我不确定你是否为自己节省了那么多打字（最多 5 个字符）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-26T13:20:46.563

对 null 变量调用方法通常会导致 NullReferenceException。-Method`IsNullOrEmpty()`以一种仅查看代码无法预测的方式偏离此行为。因此，我建议不要使用它，因为它会造成混乱，并且保存几个字符的好处是微乎其微的。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-26T13:54:15.627

一般来说，如果扩展方法的名称中有“null”或类似的词，我只能对可以安全调用 null 的扩展方法感到满意。这样，我就知道他们可以安全地使用 null 调用这一事实。此外，他们最好在他们的 XML 注释标头中记录这一事实，以便当我将鼠标悬停在呼叫上时我会得到该信息。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-07-09T08:14:10.157

当使用“.IsNull()”将类实例与 null 进行比较时，甚至不比使用“== null”短。当没有约束的泛型类型参数可以是值类型时，泛型类中的情况会发生变化。在这种情况下，与默认类型的比较很长，我使用下面的扩展名：

```
 public static bool IsDefault<T>(this T x)
    {
        return EqualityComparer<T>.Default.Equals(x, default(T));
    } 
```

# visual-studio - 没有提升的 Visual Studio 集成 Web 服务器错误

> ID：790824
> 
> 赞同：0
> 
> 时间：2009-04-26T13:07:43.850
> 
> 标签：visual-studio, windbg

我在 Windows Vista 中运行的 Visual Studio 中有 asp.net 项目，并在标准用户（未提升）中激活了 UAC。

当我尝试在 Visual Studio Web Server 中运行我的 asp.net 项目时，该进程挂起并开始使用如此多的 CPU。如果我运行 Visual Studio 提升它的工作完美。

这是该过程正在执行的操作。似乎它正在尝试访问“Global.net clr network”，但它不起作用。

0:000> !clrstack OS 线程 ID：0xcec (0) ESP EIP
0021f09c 6dd09742 [NDirectMethodFrameGeneric: 0021f09c] Microsoft.Win32.NativeMethods.CreateFileMapping(IntPtr, SECURITY_ATTRIBUTES, Int32, Int32, Int32, System.Stringtics) 0021f0bc 0021f0bc abno .SharedPerformanceCounter+FileMapping.Initialize(System.String, Int32, Int32) 0021f11c 56a02a30 **System.Diagnostics.SharedPerformanceCounter+FileMapping..ctor**(System.String, Int32, Int32) 0021f12c 56a05af7 System.Diagnostics.SharedPerformanceCounter.GetCategoryData() 0021f17c 56a056b8 System.Diagnostics.SharedPerformanceCounter..ctor(System.String, System.String, System.String, System.Diagnostics.PerformanceCounterInstanceLifetime) 0021 56a0456c System.Diagnostics.PerformanceCounter.Initialize() 0021f1d0 56a0437f System.Diagnostics.PerformanceCounter.set_RawValue(Int64) 0021f1ec 569ca4d3 System.Net.NetworkingPerfCounters.Initialize() 0021f230 569c980.Section.Net.Configuration( Configuration.SettingsSection) 0021f270 569e3201 System.Net.Configuration.SettingsSectionInternal.get_Section() 0021f29c 569e2aad System.Net.Sockets.Socket.InitializeSockets() 0021f2ec 569e24e8 System.Net.Sockets.Socket..ctor(System.Net.Sockets.AddressFamily , System.Net.Sockets。SocketType, System.Net.Sockets.ProtocolType) 0021f310 00370758 Microsoft.VisualStudio.WebHost.Server.Start() 0021f33c 0037037b Microsoft.VisualStudio.WebServer.WebServerApp.Main(System.String[]) 0021f594 6dce1b4c [GCFrame: 0021f594] 0: 000> !finalizequeue 要清理的同步块：0 要释放的 MTA 接口：0

## 即将发布的STA接口：0

第 0 代有 104256 个可终结对象 (045e06fc->046463fc) 第 1 代有 1 个可终结对象 (045e06f8->045e06fc) 第 2 代有 22 个可终结对象 (045e06a0->045e06f8) 准备终结 0 对象 (046463fc->046463fc) 统计：MT计数 TotalSize 类名称 573bd7cc 1 20 Microsoft.Win32.SafeHandles.SafeFileHandle 56a4a3f0 1 20 Microsoft.Win32.SafeHandles.SafeLocalMemHandle 57395c34 1 44 System.Threading.ReaderWriterLock 573b8e74 1 56 System.Threading.Thread 56a3e224 1 76 System.Socket. 56a49d30 1 120 System.Diagnostics.PerformanceCounter 57395bdc 8 128 System.WeakReference 57397ba0 8 160 Microsoft.Win32.SafeHandles.SafeRegistryHandle **56a4a448 104257 2085140 Microsoft.Win32.SafeHandles.SafeFileMappingHandle** 共 104279 个对象

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-04-26T13:10:44.590

当您在 VS 中运行 ASP.NET 项目时，调试网络服务器会运行（如您所说）而不会导致问题的提升。调试是 UAC 旨在抑制的那种特权操作。UAC 的整个想法是，如果没有您的明确干预，这种事情就不会发生。

因此，以提升的权限运行 VS。您看到的行为是设计使然。

# sql - mysql 警告

> ID：790826
> 
> 赞同：2
> 
> 时间：2009-04-26T13:08:25.347
> 
> 标签：sql, mysql

我有下表：

```
 CREATE TABLE `events` (
  `evt_id` int(11) NOT NULL AUTO_INCREMENT,
  `evt_name` varchar(50) NOT NULL,
  `evt_description` varchar(100) DEFAULT NULL,
  `evt_startdate` date NOT NULL,
  `evt_enddate` date DEFAULT NULL,
  `evt_starttime` time DEFAULT NULL,
  `evt_endtime` time DEFAULT NULL,
  `evt_amtpersons` int(11) DEFAULT NULL,
  `sts_id` int(11) NOT NULL,
  `adr_id` int(11) DEFAULT NULL,
  `evt_amtPersonsSubs` int(11) DEFAULT NULL,
  `evt_photo` varchar(50) DEFAULT NULL,
  `sys-mut-dt` timestamp NULL DEFAULT NULL,
  `sys-mut-user` varchar(20) DEFAULT NULL,
  `sys-mut-id` int(11) NOT NULL DEFAULT '0',
  PRIMARY KEY (`evt_id`),
  KEY `sts_id` (`sts_id`),
  KEY `adr_id` (`adr_id`),
  CONSTRAINT `sts_id` FOREIGN KEY (`sts_id`) REFERENCES `statusses` (`sts_id`) O
N DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB AUTO_INCREMENT=10 DEFAULT CHARSET=latin1 
```

现在我有两个问题：

这是我的查询：

```
INSERT INTO `events`(`evt_name` , `evt_description` , `evt_startdate` , `evt_enddate` , `evt_starttime` , `evt_endtime` , `evt_amtpersons` , `sts_id` , `adr_id` , `evt_amtPersonsSubs` , `evt_photo` , `sys-mut-user` , `sys-mut-id`) VALUES ('asf' , 'asf' , '2009-04-02' , '2009-04-22' , '00:00:00' , '00:00:00' , '3' , '1' , '' , '' , '' , 'test' , '1') 
```

1.  当我通过我的 php 程序执行此查询时，我没有收到任何错误。但是当我直接在 mysql 数据库上的 shell 中执行查询时，我收到两个警告。我怎样才能让 PHP 在有警告时提醒我，因为如果有警告，mysql 不会执行插入操作。

2.  关于警告：

| 警告 | 第1366章 不正确的整数值：第 1 行的列 'adr_id' 的 '' | 警告 | 第1366章 不正确的整数值：第 1 行的列 'evt_amtPersonsSubs' 的 ''

我怎样才能摆脱这些警告。试图做出一些改变，但到目前为止还没有成功。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-26T13:11:16.383

您正在插入一个空字符串。您应该删除 '' 并在该字段中输入一个数字

如您所说，插入时不必指定该列的值。该事实由表创建时该列的“DEFAULT NULL”指示。然而，这一事实意味着，如果您在*执行INSERT 时* *未*在列列表中指定列名（因此您也不会指定相应的值），那么无论如何都可以插入元组，并且对于该列值，您默认情况下会自动获得 NULL。

但是，在您的查询中，您指定要插入该列值，并且您说的列值是 ''（一个空字符串）。这当然是无效的，因为该列接受整数（或 NULL，因为您没有声明该列 NOT NULL），并且空字符串是空字符串，而不是整数。

SQL 服务器很慷慨，无论如何都会接受空字符串（可能会将其强制转换为零），但会向您报告警告。如果您为服务器设置严格模式（我强烈建议您这样做），您将收到错误并且插入将失败。

请注意，如果您遵循我设置严格模式的建议，这是服务器范围的，涉及您所有的数据库和所有表（至少一年前发布的 mysql）。如果您编写的软件需要一个宽容的服务器，那么您将无法使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T13:12:00.983

错误消息告诉您空字符串 ('') 不是整数字段的有效值 - 在本例中为字段`adr_id`和`evt_amtPersonsSubs`. 你的意思是把 NULL 代替吗？

[在 PHP 中，您可以使用mysql_error()](http://au2.php.net/manual/en/function.mysql-error.php)函数仅针对最近的查询检索错误或警告消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T13:14:08.123

'' 不是整数......如果你真的想要一个空值，那么在查询中使用 NULL 怎么样？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-26T13:14:11.260

警告告诉您您正在尝试将字符串值插入整数列。

在所有你有一个 int 列的地方，你不能把值放在 ' 之间，而只是把值放在原样

[...]'00:00:00' , '00:00:00' , 3 , 1 , [...]

如果您不想为某个列提供值，则应使用 NULL 定义该列。然后你甚至可以留下你的''插入。

但

一般来说，做这样的插入是不好的做法。如果有一天您需要在表格中添加一列怎么办？然后你也必须去重写你的代码。

因此你应该做这样的插入：

```
INSERT INTO tbl_name (col1, col2) VALUES(value1, value2); 
```

这样，即使您决定添加列，您的代码仍然可以工作。加上代码更容易阅读！！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-16T09:21:39.827

> 隐式默认值定义如下：
> 
> *   对于数字类型，默认值为 0，但使用 AUTO_INCREMENT 属性声明的整数或浮点类型除外，默认值为序列中的下一个值。

参考：

*   [MySQL 5.7 参考手册](https://dev.mysql.com/doc/refman/5.7/en/) / [数据类型](https://dev.mysql.com/doc/refman/5.7/en/data-types.html) / [数据类型默认值](https://dev.mysql.com/doc/refman/5.7/en/data-type-defaults.html)

# sql-server - SQL Server 写入一次列

> ID：790840
> 
> 赞同：4
> 
> 时间：2009-04-26T13:19:20.967
> 
> 标签：sql-server, tsql

有没有办法将 SQL 服务器实例配置为不允许更新插入数据库中的值？

例如，一旦插入，值是固定的，同一行中的其他列可能会更改，但该值只写入一次。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-26T13:24:10.283

编写一个更新触发器，检查当前列与插入的新值是否相符，如果值不同，则回滚事务。

```
create trigger dbo.tr_no_updates
on mytable
for update
as
if update(mycolumn)
   rollback transaction 
```

# javascript - Onsubmit 表单验证功能在 IE 中不起作用

> ID：790846
> 
> 赞同：0
> 
> 时间：2009-04-26T13:22:31.927
> 
> 标签：javascript, html, javascript-events

我正在为 html 表单开发一个简单的 javascript 验证功能，但在使用 IE7 时遇到了问题。我没有收到任何错误消息，表单只是提交而无需验证。Firefox 和 Opera 工作正常，所以我真的不知道我在这里做错了什么。我用谷歌搜索，但没有发现任何有用的东西，或者可能没有搜索正确的关键字。

*另外，如果有人可以推荐一个用于在 IE 中调试 javascript 的好工具。

任何帮助将不胜感激。

```
<html>
<head>
  <title>Hello!</title>
<style type="text/css">    
  .error {
  font-family: Tahoma;
font-size: 8pt;
  color: red;
  margin-left: 50px;
  display:none;
  }    
</style>
<script type="text/javascript">    
  function checkForm() {
  age = document.getElementById("age").value;
  name = document.getElementById("name").value;
  comment = document.getElementById("comment").value;
  parent = document.getElementById("parent").value;
  phone = document.getElementById("phone").value;
  sig = document.getElementById("sig").value;
  player = document.getElementById("player").value;
  iagree = document.getElementById("iagree").value;

  if (age == "") {
  hideAllErrors();
document.getElementById("ageError").style.display = "inline";
document.getElementById("age").select();
document.getElementById("age").focus();
  return (false);
  } else if (name == "") {
  hideAllErrors();
document.getElementById("nameError").style.display = "inline";
document.getElementById("name").select();
document.getElementById("name").focus();
  return (false);
  } else if (comment == "") {
hideAllErrors();
document.getElementById("commentError").style.display = "inline";
document.getElementById("comment").select();
document.getElementById("comment").focus();
  return (false);
  } else if (parent == "") {
hideAllErrors();
document.getElementById("parentError").style.display = "inline";
document.getElementById("parent").select();
document.getElementById("parent").focus();
  return (false);
  } else if (phone == "") {
hideAllErrors();
document.getElementById("phoneError").style.display = "inline";
document.getElementById("phone").select();
document.getElementById("phone").focus();
  return (false);
  } else if (sig == "") {
hideAllErrors();
document.getElementById("sigError").style.display = "inline";
document.getElementById("sig").select();
document.getElementById("sig").focus();
  return (false);
  } else if (player == "") {
hideAllErrors();
document.getElementById("playerError").style.display = "inline";
document.getElementById("player").select();
document.getElementById("player").focus();
  return (false);
  } else if (iagree != "I agree") {
hideAllErrors();
document.getElementById("iagreeError").style.display = "inline";
document.getElementById("iagree").select();
document.getElementById("iagree").focus();
  return (false);
  }
  return (true);
  }

  function hideAllErrors() {
document.getElementById("ageError").style.display = "none"
document.getElementById("nameError").style.display = "none"
document.getElementById("commentError").style.display = "none"
document.getElementById("parentError").style.display = "none"
document.getElementById("phoneError").style.display = "none"
document.getElementById("sigError").style.display = "none"
document.getElementById("playerError").style.display = "none"
document.getElementById("iagreeError").style.display = "none"
  }
</script>
</head>

<body>

    <form onsubmit="return checkForm();" action="contact.php" method="post">
    <div style="background: #ffffe5; padding:5px;">
      <label for="isnew"><b>I am a new member:</b></label><input type="checkbox" id="isnew" name="isnew" value="New Member" /><br />
      (If you are re-registering for the year, please leave this box unchecked)
    </div>
    <table>
      <tr>
        <td></td>
      </tr>
      <tr>
        <td>
          <b><label for="age">Your Age:</label></b><br />
          <input type="text" id="age" name="age" maxlength="3" style="width:40px; background: #ffffe5;" value="" />
          <div class="error" id="ageError">
            Required: Please enter your age<br />
          </div>
        </td>
        <td><b>Girl or Boy?:</b><br />
        <select name="gender" size="1">
          <option value="-1" selected="selected">
            Choose One
          </option>

          <option value="Girl">
            Girl
          </option>

          <option value="Boy">
            Boy
          </option>
        </select></td>
      </tr>
      <tr>
        <td><b><label for="name">Your Name:</label></b></td>
      </tr>
      <tr>
        <td>
          <input type="text" name="name" id="name" maxlength="40" value="" />
          <div class="error" id="nameError">
            Required: Please enter your name<br />
          </div>
        </td>
      </tr>
      <tr>
        <td><b>Home Address:</b></td>
      </tr>
      <tr>
        <td>
          <textarea name="address" id="comment">
</textarea><br />
          <div class="error" id="commentError">
            Required: Please enter your address<br />
          </div>
        </td>
      </tr>

      <tr>
        <td><b><label for="parent">Parent/Guardian Name:</label></b></td>
      </tr>
      <tr>
        <td>
          <input type="text" name="parent" id="parent" maxlength="40" value="" />

          <div class="error" id="parentError">
            Required: Please enter your parent or guardian's name<br />
          </div>
        </td>
      </tr>
      <tr>
        <td><b>Address(If different from above):</b></td>
      </tr>
      <tr>
        <td>
        <textarea name="altaddress">
</textarea></td>
      </tr>
      <tr>
        <td><b>Phone Details:</b></td>
      </tr>
      <tr>
        <td>
          <b><label for="phone">Best Contact Number:</label></b><br />
          <input type="text" id="phone" name="contactphone" maxlength="40" value="" />

          <div class="error" id="phoneError">
            Required: Please enter a phone number<br />
          </div>
        </td>
        <td><b>Mobile:</b><br />
        <input type="text" name="contactmob" maxlength="40" /></td>
      </tr>
      <tr style="background: #ffffe5;">
        <td><b>Medical Conditions:</b></td>
      </tr>
      <tr style="background: #ffffe5;">
        <td>
        <textarea name="medical">
</textarea></td>
        <td><small>(If there are any medical conditions that trainers, and the club should know about, please list them here).</small></td>
      </tr>
      <tr>
        <td><b>Player Agreement:</b></td>
      </tr>
    </table>

    <div style="border: 1px solid #e0e0e0; padding:5px;">
      (If under the age of 18 years of age, a parent or legal guardian must sign)<br />
      I, <input type="text" name="agreename" id="sig" maxlength="40" style="border:none; background:#ffffe5;" value="" />

      <div class="error" id="sigError">
        &lt;-(Required: Please enter your parent or guardian's name)
      </div>being the parent/legal guardian of <input type="text" name="playername" maxlength="40" style="border:none; background:#ffffe5;" id="player" value="" />

      <div class="error" id="playerError">
        &lt;-(Required: Please enter your child's name)
      </div>hereby give consent for the above named player to register to play Australian Football.<br />
      <br />
    </div><br />
    <br />

    <div style="background: #ffffe5; padding:5px;">
      By submitting this form, and signing in the field below, I hereby agree that I am <b>over 18yr's of age</b> and/or have all nessecary permissions to legally process this document.

      <div style="maring:0; padding: 0;">
        <div style="margin-bottom:5px;">
          <b><label for="iagree">Please type this in the field below: <input type="text" style="background: #e0e0e0; width:45px; color:#000000;" disabled="disabled" value="I agree" /></label></b><br />
          <br />
          <input type="text" name="iagree" value="" id="iagree" />

          <div class="error" id="iagreeError">
            &lt;-(Required: You must confirm this documents legality)
          </div>
        </div><br />
      </div>
    </div>

    <div>
      <input type="submit" name="submitreg" value="Join Our Club!" />
    </div>
  </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-26T13:50:49.907

问题（奇怪）是由一个名为“parent”的全局变量引起的，您在此处创建它：

```
parent = document.getElementById("parent").value; 
```

JavaScript 有自己的变量，称为“parent”，而您正在覆盖它，从而使浏览器感到困惑。您应该将您的声明为局部变量，如下所示：

```
var parent = document.getElementById("parent").value; 
```

这将使它工作。无论如何，始终对那种变量使用“var”是一个好习惯——对你正在使用的所有变量都这样做。

至于 JavaScript 调试器，您可以使用[FireBug](http://getfirebug.com/)在 FireFox 中进行调试。在 Internet Explorer 中，Visual Studio 不错，但价格昂贵。或者您可以通过此处的说明免费使用[Visual Web Developer ：](http://msdn.microsoft.com/en-gb/express/default.aspx) [http ://www.berniecode.com/blog/2007/03/08/how-to-debug-javascript-with-visual-web-developer-express /](http://www.berniecode.com/blog/2007/03/08/how-to-debug-javascript-with-visual-web-developer-express/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-26T13:54:18.090

乍一看，问题似乎发生在@行 document.getElementById("parent").value

你真的应该`var parent`在这里使用来明确地将其声明为局部变量。

无论如何，你有很多代码可以进行完整性检查和重构+你根本没有异常处理......

此块重复 8 次...对于每个变量...

```
if (age == "") {
  hideAllErrors();
  document.getElementById("ageError").style.display = "inline";
  document.getElementById("age").select();
  document.getElementById("age").focus();
  return (false);
} 
```

这很容易做到

```
if(age == "") {
   DoMyFunction("age", "ageError");
}
...

function DoMyFunction(a, b)
{
  hideAllErrors();
  document.getElementById(b).style.display = "inline";
  document.getElementById(a).select();
  document.getElementById(a).focus();
  return (false);
} 
```

在任何你有 document.getElementById("").value 的地方你都应该在这里检查以确保 getElementById 不返回 null。

```
var name = "";
var nametemp = document.getElementById("name");
if (nametemp != null)
   name = nametemp.value; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T14:00:04.970

Microsoft Visual Studio 可能是最好的 IE 调试器，但它相当昂贵，所以我不建议只为调试器购买它。但是你可能想试试[Visual Studio Express——](http://en.wikipedia.org/wiki/Visual_Studio_Express)我*猜*它也可以在 IE 中调试 JavaScript。

否则，请尝试[Microsoft 脚本编辑器](http://www.jonathanboutelle.com/mt/archives/2006/01/howto_debug_jav.html)。它与 Office XP 和 Office 2003 一起提供，并且该链接具有分步设置说明。

# windows - c:\program 的诀窍是什么？

> ID：790848
> 
> 赞同：2
> 
> 时间：2009-04-26T13:22:52.767
> 
> 标签：windows

我发现获取任何 exe 文件，将其重命名为**program**（不带扩展名）并将其放在 C:\ 根文件夹中可能会在 Windows 中导致奇怪的事情，例如在其他程序启动时显示此应用程序。
它是什么？是某种后门吗？

ps 如果您在这样做后重新启动 Windows - 您会收到有关它的警告。

谢谢，阿迪巴尔达

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-26T13:27:48.480

也许某些程序不知道如何访问 C:/Program Files/ 的事实*。*因为它有一个空间。然后他们试图执行 C:/program，在您的情况下，这就是您创建的文件。

# iphone - iphone全局变量

> ID：790849
> 
> 赞同：2
> 
> 时间：2009-04-26T13:24:09.817
> 
> 标签：iphone, objective-c

我想在我的 appDelegate 类中打开我的 SQLite 数据库，并在需要该数据库的所有其他类中引用该数据库。我试过使用：static sqlite3 *database = nil;

但是，当我尝试使用 appDelegate.database 在我的其他类中引用它时，我得到一个编译错误“错误：在不是结构或联合的东西中请求成员'数据库'”。您如何引用这些类型的属性？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-26T14:41:27.820

您应该通过以下通用公式访问存储在应用程序 Delegate 中的任何变量：

```
YourAppDelegateName *delegate = (YourAppDelegateName *)[[UIApplication sharedApplication]delegate];
//access specific variables in delegate as follows:
sqlite3 *temp = delegate.database; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T14:48:29.160

我建议你对 sqlite 使用 FMDB Objective C 包装器。它将真正简化对您的 sqlite 数据库的访问。你可以从

[http://code.google.com/p/flycode/source/browse/trunk/fmdb#fmdb/src](http://code.google.com/p/flycode/source/browse/trunk/fmdb#fmdb/src)

然后，

您可以使用以下示例代码，并使用 NSString *db_path 变量从其他类访问您的数据库（您使用您的应用程序委托访问 db_path，然后使用

```
FMDatabase *db = [FMDatabase databaseWithPath:db_path]; 
```

访问您的数据库。请参阅下面的示例代码。

```
- (NSString *) initialize_db {
    NSString *DATABASE_RESOURCE_NAME = @"yourDbName";
    NSString *DATABASE_RESOURCE_TYPE = @"db";
    NSString *DATABASE_FILE_NAME = @"yourDbName.db";

    // copy the database from the bundle if necessary
    // look to see if DB is in known location (~/Documents/$DATABASE_FILE_NAME)
    NSArray *searchPaths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentFolderPath = [searchPaths objectAtIndex: 0];
    NSString *dbFilePath = [documentFolderPath stringByAppendingPathComponent: DATABASE_FILE_NAME];
    [dbFilePath retain];

    if (! [[NSFileManager defaultManager] fileExistsAtPath: dbFilePath]) {
        // didn't find db, need to copy
        NSString *backupDbPath = [[NSBundle mainBundle]
                                  pathForResource:DATABASE_RESOURCE_NAME
                                  ofType:DATABASE_RESOURCE_TYPE];
        if (backupDbPath == nil) {
            // couldn't find backup db to copy, bail
            NSLog (@"couldn't init db");
            return NULL;
        } else {
            BOOL copiedBackupDb = [[NSFileManager defaultManager]
                                   copyItemAtPath:backupDbPath
                                   toPath:dbFilePath
                                   error:nil];
            if (! copiedBackupDb) {
                // copying backup db failed, bail
                NSLog (@"couldn't init db");
                return NULL;
            }
        }
    }

    return dbFilePath;

}

- (void)applicationDidFinishLaunching:(UIApplication *)application {

    FMResultSet *item_rs;   

    // copy the database from the bundle if necessary
    db_path = [self initialize_db];
    if (! db_path) {
        // TODO: alert the user!
        NSLog (@"couldn't init db");
        return;
    }

    FMDatabase *db = [FMDatabase databaseWithPath:db_path];
    if (![db open]) {
        NSLog(@"Could not open the db");
    }

    FMResultSet *rs = [db executeQuery:@"select * from yourTable"];
    if ([db hadError]) {
        NSLog(@"Err %d: %@", [db lastErrorCode], [db lastErrorMessage]);
    }

    while ([rs next]) {
        [yourArray addObject:[rs stringForColumn:@"yourColumnName"]];

    }

    [rs close];  

    [db close];

    // Configure and show the window
    [window addSubview:[navigationController view]];
    [window makeKeyAndVisible];
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T15:29:47.033

我需要为数据库创建一个实例属性。我认为静态声明就足够的假设是不正确的。顺便说一句，FMDB/ORM 的建议很棒。我是 ORM 的忠实粉丝。但是，这个项目是我的第一部 iphone，它是少量的数据库工作，我想学习。所以，我打算做旧学校。感谢您的建议。

以下是我为使我的全球参考工作所做的代码更改。希望它对某人有所帮助：

```
/* myAppDelegate.h file */
#import <sqlite3.h>

@interface myAppDelegate : NSObject <UIApplicationDelegate> {
... // you may have windows etc here
    sqlite3 *database;

}

@property (readwrite) sqlite3 *database;

/* myAppDelegate.m file */
@implementation myAppDelegate
...
@synthesize database;

/* some method in some class that uses the database */
- (void) getSomeData
{
    myAppDelegate *appDelegate = (myAppDelegate *) [[ UIApplication sharedApplication ] delegate ];

    const char *sql = "SELECT * FROM myTable";
        sqlite3_stmt *selectstmt;
        if(sqlite3_prepare_v2(appDelegate.database, sql, -1, &selectstmt, NULL) == SQLITE_OK) 
{
// get the data here.
}

} 
```

# php - 如何通过双击Windows XP中的html文件等任何文件夹来运行php文件？

> ID：790858
> 
> 赞同：3
> 
> 时间：2009-04-26T13:33:50.277
> 
> 标签：php, wordpress, windows-xp

有没有什么技巧可以通过双击 HTML 文件从任何文件夹中运行 Windows XP 中的 .PHP 文件？

我使用 XAMPP，但在这里我们需要将文件放在一个特殊的 htdocs 文件夹中。我想通过双击从任何文件夹、桌面运行文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T14:09:57.973

经过大量搜索后，我找到了一种简单的方法来做到这一点

> PHPScriptNet – 非常适合学习 PHP 的人的便携式应用程序。PHPScriptNet 可以在 Windows 机器的任何地方运行您的 PHP 脚本，而无需安装 PHP 或任何网络服务器。

![php脚本网](https://www.digitalcoding.com/artimg/free-software/webmaster-tools/PHPScriptNet-main.jpg)

[http://www.digitalcoding.com/free-software/webmaster-tools/PHPScriptNet-Portable-application-to-run-PHP-Script-from-windows.html](http://www.digitalcoding.com/free-software/webmaster-tools/PHPScriptNet-Portable-application-to-run-PHP-Script-from-windows.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T13:42:41.520

查看 HTML 文件与查看 PHP 文件存在显着差异：

**HTML**文件是由浏览器解释的静态文件。当您打开它们时，HTML 文件的 PATH 作为参数传递给默认浏览器，该浏览器解释并显示该文件。

**另一方面，在浏览器呈现生成的 HTML 之前，**PHP文件需要由 PHP 解释器（在您的情况下为 XAMPP）进行解释。**在这种情况下，必须将本地文件 PATH 转换为相应的本地 URL，然后发送到浏览器。**

 ****示例解决方案**
您可以编写一个简单的脚本，将“/var/www/”替换为“ [http://localhost:8888/](http://localhost:8888/) ”（例如，使用正则表达式）并将其传递给浏览器。然后，将 PHP 文件与您的脚本相关联。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T13:39:06.270

PHP 带有一个名为 php.exe（在 Windows 中）的命令行界面解释器。这可以在 PHP 安装目录的根目录中找到。

您需要将 .php 文件与此解释器相关联。也就是说，进入工具 -> 文件夹选项 -> 文件类型，然后注册`php.exe -f "%1"`为 .php 文件类型的应用程序。

也就是说，想要通过双击来“运行”一个 PHP 文件并不是很常见 - 没有多少人会像他们使用的方式一样使用 PHP，例如，批处理文件或 shell 脚本 - PHP 更适合生成网页，即在网络服务器中使用它。很有可能，在 Web 服务器之外运行 PHP 并不是您真正想做的事情。例如，PHP 文件将在命令窗口中运行，其输出将是纯文本，如果您想查看其输出，您的脚本将需要在终止后暂停或等待来自标准输入本身的输入。

[从命令行使用 PHP 的](http://au2.php.net/features.commandline)更多信息

# python - Python - 文件中的行 - 所有组合

> ID：790860
> 
> 赞同：1
> 
> 时间：2009-04-26T13:35:19.307
> 
> 标签：python, file-io, random

我有两个文件——prefix.txt 和 terms.txt 都有大约 100 行。我想用*笛卡尔积写出第三个文件*

[http://en.wikipedia.org/wiki/Join_(SQL)#Cross_join](http://en.wikipedia.org/wiki/Join_(SQL)#Cross_join)

- 大约 10000 行。

在 Python 中解决这个问题的最佳方法是什么？

其次，有没有办法将10,000行以随机顺序写入第三个文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-26T14:00:12.710

你需要`itertools.product`.

```
for prefix, term in itertools.product(open('prefix.txt'), open('terms.txt')):
    print(prefix.strip() + term.strip()) 
```

打印出来，或者积累起来，或者直接写出来。`.strip()`由于它们每个都带有换行符，因此您需要。

之后，您可以使用 random.shuffle(list(open('thirdfile.txt')) 对它们进行随机播放，但我不知道在您使用的文件大小上会有多快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T13:41:50.087

笛卡尔积枚举所有组合。枚举所有组合的最简单方法是使用嵌套循环。

您不能很容易地以随机顺序编写文件。要写入“随机”位置，您必须使用`file.seek()`. 你怎么知道你将寻求什么职位？你怎么知道每个部分（前缀+术语）会有多长时间？

但是，您可以将整个文件读入内存（100 行不算什么）并以“随机”顺序处理内存中的集合。这将确保输出是随机的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T13:52:35.957

```
from random import shuffle
a = list(open('prefix.txt'))
b = list(open('terms.txt'))
c = [x.strip() + y.strip() for x in a for y in b]
shuffle(c)
open('result.txt', 'w').write('\n'.join(c)) 
```

当然，就速度和内存而言，这不是最好的方法，但是 10000 无论如何都不足以牺牲简洁性。您通常应该关闭您的文件对象，并且您可以循环通过至少一个文件而不将其内容存储在 RAM 中。 ~~这：从and`[:-1]`的每个元素中删除尾随换行符。`a``b`~~

编辑：使用`s.strip()`而不是`s[:-1]`摆脱换行符——它更便携。

# wcf - DataContractSerializer 每个请求多次序列化同一个对象

> ID：790861
> 
> 赞同：4
> 
> 时间：2009-04-26T13:36:19.490
> 
> 标签：wcf, datacontractserializer

我正在编写将由 Silverlight 应用程序使用的 WCF 应用程序。我已经完成了大部分的设计工作，现在我正在实施，这让我想出了这个问题。

这是我的应用程序中存在的示例：

```
[DataContract]
class Person
{
    [DataMember]
    private Towel mostRecentlyUsedTowel;

    [DataMember]
    private Gym gym; //the gym that this person attends

    ...
} 
```

```
 [DataContract]
class Gym
{
    [DataMember]
    private List<Towel> towels; //all the towels this gym owns

    ...
} 
```

这就是我的意思：在我的应用程序中 mostRecentlyUsedTowel 将指向该人健身房的毛巾列表中的某些内容。我的一些请求将序列化一个 Person 对象。

DataContractSerializer 是否足够聪明，可以注意到它被要求序列化完全相同的对象实例两次？如果是这样，它是如何处理的？

如果它只是将同一个实例序列化两次，我应该如何处理这个问题，这样我就不会通过链接发送不必要的数据？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-26T13:59:03.180

以下代码：

```
[TestMethod]
public void CanSerializePerson()
{
    var towel1 = new Towel() { Id = 1 };
    var towel2 = new Towel() { Id = 2 };
    var towel3 = new Towel() { Id = 3 };
    var gym = new Gym();
    gym.towels.Add(towel1);
    gym.towels.Add(towel2);
    gym.towels.Add(towel3);

    var person = new Person()
    {
      recentlyUsedTowel = towel1,
      gym = gym
    };

    var sb = new StringBuilder();
    using (var writer = XmlWriter.Create(sb))
    {
        var ser = new DataContractSerializer(typeof (Person));
        ser.WriteObject(writer, person);
    }

    throw new Exception(sb.ToString());
}

public class Person
{
    public Towel recentlyUsedTowel { get; set; }
    public Gym gym { get; set; }
}

public class Gym
{
    public Gym()
    {
        towels = new List<Towel>();
    }

    public List<Towel> towels { get; set; }
}

public class Towel
{
    public int Id { get; set; }
} 
```

将评估为：

```
<?xml version="1.0" encoding="utf-16"?>
<Person xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://tempuri.org">
  <gym>
    <towels>
      <Towel><Id>1</Id></Towel>
      <Towel><Id>2</Id></Towel>
      <Towel><Id>3</Id></Towel>
    </towels>
  </gym>
  <recentlyUsedTowel><Id>1</Id></recentlyUsedTowel>
</Person> 
```

如果您将 IsReference 属性添加到 Towel 类的 DataContract 属性，如下所示：

```
[DataContract(IsReference=true)]
public class Towel
{
    // you have to specify a [DataMember] in this because you are 
    // explicitly adding DataContract
    [DataMember]
    public int Id { get; set; }
} 
```

你会得到这样的输出：

```
<?xml version="1.0" encoding="utf-16"?>
<Person xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://tempuri.org">
  <gym>
    <towels>
      <Towel z:Id="i1" xmlns:z="http://schemas.microsoft.com/2003/10/Serialization/">
        <Id>1</Id>
      </Towel>
      <Towel z:Id="i2" xmlns:z="http://schemas.microsoft.com/2003/10/Serialization/">
        <Id>2</Id>
      </Towel>
      <Towel z:Id="i3" xmlns:z="http://schemas.microsoft.com/2003/10/Serialization/">
        <Id>3</Id>
      </Towel>
    </towels>
  </gym>
  <recentlyUsedTowel z:Ref="i1" xmlns:z="http://schemas.microsoft.com/2003/10/Serialization/" />
</Person> 
```

希望这可以帮助。

# php - .mp3 文件类型上传

> ID：790873
> 
> 赞同：1
> 
> 时间：2009-04-26T13:53:46.063
> 
> 标签：php, upload, mp3, mime

我正在开发一个 PHP 上传脚本，它允许上传 .mp3 文件等。我创建了一个数组，它指定了允许的文件类型，包括 mp3，并将最大上传限制设置为 500MB：

```
// define a constant for the maximum upload size
define ('MAX_FILE_SIZE', 5120000);

// create an array of permitted MIME types
$permitted = array('application/msword', 'application/pdf', 'text/plain', 'text/rtf', 'image/gif', 'image/jpeg', 'image/pjpeg', 'image/png', 'image/tiff', 'application/zip', 'audio/mpeg', 'audio/mpeg3', 'audio/x-mpeg-3', 'video/mpeg', 'video/mp4', 'video/quicktime', 'video/x-ms-wmv', 'application/x-rar-compressed'); 
```

到目前为止，在测试中，所有指定的文件类型都已成功上传，但由于某种原因，它出现了 .mp3 错误。正如您在上面看到的，我已经包含了音频/mpeg、音频/mpeg3 和音频/x-mpeg-3，但它们似乎都没有什么不同。

有人可以提出问题可能是什么，并指出允许.mp3 上传所需的音频类型吗？

谢谢

**更新：**我用来运行文件检查的代码如下：

```
// check that file is within the permitted size
        if ($_FILES['file-upload']['size'][$number] > 0 || $_FILES['file-upload']['size'][$number] <= MAX_FILE_SIZE) {
            $sizeOK = true;
        }

        // check that file is of an permitted MIME type
        foreach ($permitted as $type) {
            if ($type == $_FILES['file-upload']['type'][$number]) {
                $typeOK = true;
                break;
            }
        }

        if ($sizeOK && $typeOK) {
            switch($_FILES['file-upload']['error'][$number]) {
                case 0:
                    // check if a file of the same name has been uploaded
                    if (!file_exists(UPLOAD_DIR.$file)) {
                        // move the file to the upload folder and rename it
                        $success = move_uploaded_file($_FILES['file-upload']['tmp_name'][$number], UPLOAD_DIR.$file);
                    }
                    else {
                        // strip the extension off the upload filename
                        $filetypes = array('/\.doc$/', '/\.pdf$/', '/\.txt$/', '/\.rtf$/', '/\.gif$/', '/\.jpg$/', '/\.jpeg$/', '/\.png$/', '/\.tiff$/', '/\.mpeg$/', '/\.mpg$/', '/\.mp4$/', '/\.mov$/', '/\.wmv$/', '/\.zip$/', '/\.rar$/', '/\.mp3$/');
                        $name = preg_replace($filetypes, '', $file);
                        // get the position of the final period in the filename
                        $period = strrpos($file, '.');
                        // use substr() to get the filename extension
                        // it starts one character after the period
                        $filenameExtension = substr($file, $period+1);
                        // get the next filename    
                        $newName = getNextFilename(UPLOAD_DIR, $name, $filenameExtension); 
                        $success = move_uploaded_file($_FILES['file-upload']['tmp_name'][$number], UPLOAD_DIR.$newName);
                    }
                    if ($success) {
                        $result[] = "$file uploaded successfully";
                    }
                    else {
                        $result[] = "Error uploading $file. Please try again.";
                    }
                    break;
                case 3:
                    $result[] = "Error uploading $file. Please try again.";
                default:
                    $result[] = "System error uploading $file. Contact webmaster.";
            }
        }
        elseif ($_FILES['file-upload']['error'][$number] == 4) {
            $result[] = 'No file selected';
        }
        else {
            $result[] = "$file cannot be uploaded. Maximum size: $max. Acceptable file types: doc, pdf, txt, rtf, gif, jpg, png, tiff, mpeg, mpg, mp3, mp4, mov, wmv, zip, rar.";
        } 
```

我得到底部的其他结果，告诉我文件大小错误或不允许扩展名。

**更新 2：** 我已经运行了 _FILES 数组的 print_r，希望能提供更多信息。结果是：

数组 ( [file-upload] => 数组 ( [name] => 数组 ( [0] => Mozart.mp3 [1] => [2] => )

```
 [type] => Array
            (
                [0] => audio/mpg
                [1] => 
                [2] => 
            )

        [tmp_name] => Array
            (
                [0] => /Applications/MAMP/tmp/php/phpgBtlBy
                [1] => 
                [2] => 
            )

        [error] => Array
            (
                [0] => 0
                [1] => 4
                [2] => 4
            )

        [size] => Array
            (
                [0] => 75050
                [1] => 0
                [2] => 0
            )

    ) 
```

)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-26T14:02:50.783

MAX_FILE_SIZE 是以字节为单位的值

5120000 不是 500 MB。我估计是5MB。

您还需要检查您没有超过 php.ini 文件中的“post_max_size”和“upload_max_size”变量

其次，mp3 可以是以下任何一种 mimetype

*   音频/MPEG
*   音频/x-mpeg
*   音频/mp3
*   音频/x-mp3
*   音频/mpeg3
*   音频/x-mpeg3
*   音频/mpg
*   音频/x-mpg
*   音频/x-mpegaudio

[http://fileext.com/file-extension/MP3](http://filext.com/file-extension/MP3)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T16:43:36.060

您永远不应该假设 $_FILES[...]['type'] 中的值实际上与文件的类型匹配。客户端可以发送任意字符串，PHP 根本不检查它。见[这里](http://php.net/manual/en/features.file-upload.post-method.php)。

您必须自己完成工作才能实际确定上传的文件类型，除非您有充分的理由根本不关心安全性（您可能不关心）。PHP 默认提供了[fileinfo](http://php.net/fileinfo)包，它为您完成了繁重的工作。请参阅[finfo_file()](http://php.net/manual/en/function.finfo-file.php)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T23:30:09.720

1.  为什么不使用 in_array 而不是 foreach 循环进行类型检查？
2.  当您上传有效文件时，您是否尝试过检查 $sizeOK 和 $typeOK 的值

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-01T19:09:36.863

我怀疑你是否仍然需要这个，但我相信很多人也会面临同样的问题。这就是我所做的，它对我有用。

php代码：

```
if(isset($_POST['submit'])) {

    $fileName = $_FILES['userfile']['name'];
    $tmpName = $_FILES['userfile']['tmp_name'];
    $fileSize = $_FILES['userfile']['size'];
    $fileType = $_FILES['userfile']['type'];

if ($fileType != 'audio/mpeg' && $fileType != 'audio/mpeg3' && $fileType != 'audio/mp3' && $fileType != 'audio/x-mpeg' && $fileType != 'audio/x-mp3' && $fileType != 'audio/x-mpeg3' && $fileType != 'audio/x-mpg' && $fileType != 'audio/x-mpegaudio' && $fileType != 'audio/x-mpeg-3') {
        echo('<script>alert("Error! You file is not an mp3 file. Thank You.")</script>');
    } else if ($fileSize > '10485760') {
        echo('<script>alert("File should not be more than 10mb")</script>');
    } else if ($rep == 'Say something about your post...') {
    $rep == '';
    } else {
    // get the file extension first
    $ext = substr(strrchr($fileName, "."), 1); 

    // make the random file name
    $randName = md5(rand() * time());

    // and now we have the unique file name for the upload file
    $filePath = $uploadDir . $randName . '.' . $ext;

    $result = move_uploaded_file($tmpName, $filePath);
    if (!$result) {
        echo "Error uploading file";
    exit;
    }

    if(!get_magic_quotes_gpc()) {

    $fileName = addslashes($fileName);
    $filePath = addslashes($filePath);

    }

    $sql = "INSERT INTO media SET
            path = '$filePath',
            size = '$fileSize',
            ftype = '$fileType',
            fname = '$fileName'";

if (mysql_query($sql)) {
    echo('');
    } else {
        echo('<p style="color: #ff0000;">Error adding audio: ' . mysql_error() . '</p><br />');
} 
```

你的html代码将是；

```
<form action="<?php $_SERVER['PHP_SELF'] ?>" method="post" enctype="multipart/form-data"">
      <input type="hidden" name="MAX_FILE_SIZE" value="2000000">
      <input type="file" class="file_input" name="userfile" />
      <input type="submit" value="" name="submit" id="submitStatus" class="submit" />
    </form> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-26T14:01:43.237

5MB 限制可能是您的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-26T16:21:02.713

这是一些代码，可以为您的错误提供一些象征意义：

```
class UploadException extends Exception { 
    public function __construct($code) { 
        $message = $this->codeToMessage($code); 
        parent::__construct($message, $code); 
    } 

    private function codeToMessage($code) { 
        switch ($code) { 
            case UPLOAD_ERR_INI_SIZE: 
                $message = "The uploaded file exceeds the upload_max_filesize directive in php.ini"; 
                break; 
            case UPLOAD_ERR_FORM_SIZE: 
                $message = "The uploaded file exceeds the MAX_FILE_SIZE directive that was specified in the HTML form"; 
                break; 
            case UPLOAD_ERR_PARTIAL: 
                $message = "The uploaded file was only partially uploaded"; 
                break; 
            case UPLOAD_ERR_NO_FILE: 
                $message = "No file was uploaded"; 
                break; 
            case UPLOAD_ERR_NO_TMP_DIR: 
                $message = "Missing a temporary folder"; 
                break; 
            case UPLOAD_ERR_CANT_WRITE: 
                $message = "Failed to write file to disk"; 
                break; 
            case UPLOAD_ERR_EXTENSION: 
                $message = "File upload stopped by extension"; 
                break; 

            default: 
                $message = "Unknown upload error"; 
                break; 
        } 
        return $message; 
    } 
} 

// Use 
if ($_FILES['file']['error'] === UPLOAD_ERR_OK) { 
    //uploading successfully done 
} else { 
    throw new UploadException($_FILES['file']['error']); 
} 
```

如果您从最后一个 else 语句中收到错误，则很难说出究竟是什么触发了它。尝试使用类似上面的东西。 [http://www.php.net/manual/en/features.file-upload.errors.php](http://www.php.net/manual/en/features.file-upload.errors.php)

# c# - 在包含在更新面板中的用户控件中使用 Page.IsPostback

> ID：790878
> 
> 赞同：1
> 
> 时间：2009-04-26T13:56:36.820
> 
> 标签：c#, asp.net, ajax, asp.net-ajax, infragistics

我有一个主页，我在其中加载带有网格的用户控件并添加/编辑链接按钮。

如果我通过设置数据源并在页面加载事件中调用 databind() 方法来绑定网格，那么它会正确设置。但是，我想在回发之间保留选定的行，所以我像往常一样将绑定代码包装在“if (!Page.IsPostBack) {}”中。我的问题是页面加载总是将其注册为回发并且我的代码永远不会运行。

我正在使用 2.0 框架，我的网格是 2.0 框架的 2008.1 Infragistics。

我想这一定很简单……或者无论如何希望！

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T14:19:35.550

如果将控件放入 UpdatePanel，则应检查**[Page.IsCallback](http://msdn.microsoft.com/en-us/library/system.web.ui.page.iscallback.aspx)**而不是**[Page.IsPostBack](http://msdn.microsoft.com/en-us/library/system.web.ui.page.ispostback.aspx)**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T10:12:41.403

我发现的两种方法是：

1.  在第一次加载页面时加载用户控件，然后隐藏它们，直到用户选择他们需要查看的内容。
2.  将新页面加载到主页上的 iframe 中，使其在最初加载时具有自己的页面控件含义，而不是回发。

不是最伟大的，但过得去。

谢谢您的帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-19T17:23:03.963

我对删除这么旧的线程有复杂的感觉，但这个问题仍然相关，并且没有提供任何好的解决方案，所以虽然我会添加我最近为解决相同问题所做的事情：

我正在构建的网站也有类似的问题。我的解决方案是向用户控件添加一个名为“OnFirstLoad”的方法，该方法执行我将在“if not Page.IsPostback”块中包装的所有内容。然后，当控件第一次加载到控件树中时，我会从托管页面调用“OnFirstLoad”方法。这样控件本身就不用担心这是否是回发，主页面可以根据需要对其进行初始化。

# c# - 我在 VS 2008 中找不到 ASP.Net MVC 应用程序

> ID：790885
> 
> 赞同：0
> 
> 时间：2009-04-26T14:01:25.640
> 
> 标签：c#, asp.net-mvc

当我单击新项目时，我看不到 ASP.NET MVC Web 应用程序，如下所述：

[http://www.asp.net/learn/mvc/tutorial-21-cs.aspx](http://www.asp.net/learn/mvc/tutorial-21-cs.aspx)

有谁知道为什么我看不到这个？我有 vs 2008 sp1

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-26T14:04:27.020

您需要从[这里](http://go.microsoft.com/fwlink/?LinkId=144444)下载并安装 Asp.Net MVC 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T14:04:21.857

那是因为你需要下载它。今年才正式发布。所以它可能会捆绑在下一个版本中。您可以从 www.asp.net/mvc/ 下载它

# c# - 无法加载 Excel 2003 加载项

> ID：790887
> 
> 赞同：1
> 
> 时间：2009-04-26T14:02:11.737
> 
> 标签：c#, excel, vsto, add-in

我正在尝试使用 Visual Studio 2008 (SP1) 开发 Excel 2003 加载项。我没有为 Visual Studio 添加的样板代码添加任何代码。

当我在 VS 中运行应用程序时，它会加载 Excel，但加载项本身不起作用。“COM 加载项”窗口列出了加载项，但未选中。“加载行为”读取为“未加载。加载 COM 加载项期间发生运行时错误”。即使我启用了“调试”>“异常”下的所有选项，VS 也无法在加载时捕获异常。

我还尝试设置此[MSDN 文章](http://msdn.microsoft.com/en-us/library/ms269003.aspx)中提到的 VSTO_SUPPRESSDISPLAYALERTS 环境变量。令人惊讶的是，它也没有向我显示任何消息。

我在 Windows XP 下运行 Office 2003 (SP3)。如果有人可以帮助我，那就太好了。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T15:29:51.637

您必须安装[**KB908002**](http://support.microsoft.com/kb/908002)。请参见

> *   [.NET app.config 问题](https://stackoverflow.com/questions/436958/-net-app-config-question)
> *   [如何选择从 Excel 运行的 .NET 框架版本？](https://stackoverflow.com/questions/790580/how-to-select-net-framework-version-running-from-excel)

VS 2008 的安装稍微复杂一些。看这里：

> [.NET Word 2003 加载项可以安装在 GAC 之外吗？](https://stackoverflow.com/questions/553794/can-a-net-word-2003-add-in-be-installed-outside-of-the-gac/553886#553886)

# jquery - 使用 Google API 托管的 jQuery 更新 JScript IntelliSense 时出错

> ID：790890
> 
> 赞同：4
> 
> 时间：2009-04-26T14:02:58.880
> 
> 标签：jquery, visual-studio

我通过以下方式在我的应用程序中引用 jQuery：http: [//ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js](http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js)。

这会在 vs.net 中生成错误：“更新 JScript IntelliSense 时出错：c:...jquery.min-fds90[1]..js：对象不支持此属性或方法 @18:9345。

除了将 javascript 文件的本地副本放在我的开发箱上之外，有没有办法解决这个问题？

顺便说一句，带有此修补程序的 VS.Net 2008 SP1 会发生这种情况：[http ://weblogs.asp.net/scottgu/archive/2008/11/21/jquery-intellisense-in-vs-2008.aspx](http://weblogs.asp.net/scottgu/archive/2008/11/21/jquery-intellisense-in-vs-2008.aspx)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-11-23T23:12:42.317

我终于找到了这个问题的答案：

基本上，将以下内容添加到您的 jQuery 包括：

```
<% /* %><script type="text/javascript" src="http://ajax.microsoft.com/ajax/jQuery/jquery-1.3.2-vsdoc.js"></script><% */ %> 
```

通过：[http ://biasecurities.com/blog/2009/get-jquery-intellisense-in-vs-net-when-using-a-cdn/](http://biasecurities.com/blog/2009/get-jquery-intellisense-in-vs-net-when-using-a-cdn/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-27T18:00:35.657

我认为问题在于 jQuery 网站上的 vsdoc 文件有一个稍微不正确的文件名，这让 VS 感到困惑。

见这里： http:
[//patrickyong.net/2009/05/08/error-updating-jscript-intellisense-object-doesnt-support-this-property-or-method-21391/](http://patrickyong.net/2009/05/08/error-updating-jscript-intellisense-object-doesnt-support-this-property-or-method-21391/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-11T17:25:42.617

我也遇到这个问题。
仅当您使用 jQuery 的缩小版本时才会出现此问题。

您可以在开发中使用未压缩的版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-23T23:22:09.780

我发现 Rick Strahl 的文章是 jQuery 的一个非常好的开始，包括他关于智能感知和视觉工作室设置的笔记

[你可以在这里找到他的。](http://www.west-wind.com/presentations/jQuery/default.aspx)

# wpf - 根据子对象类型选择 DataTemplate

> ID：790896
> 
> 赞同：13
> 
> 时间：2009-04-26T14:06:31.353
> 
> 标签：wpf, datatemplate, itemscontrol

我想对 ItemsCollection 进行数据绑定，但不是渲染集合项，而是渲染通过集合项上的属性到达的子对象。

更具体地说：这将是游戏的 2D 地图查看器（尽管在当前状态下它还不是 2D）。我将 ItemsControl 数据绑定到 ObservableCollection<Square>，其中 Square 有一个名为 Terrain（Terrain 类型）的属性。地形是一个基类，并有各种后代。

我想要的是 ItemsControl 从每个集合元素呈现 Terrain 属性，而不是集合元素本身。

我已经可以完成这项工作，但需要一些不必要的开销。我想知道是否有消除不必要开销的好方法。

我目前拥有的是以下类（简化）：

```
public class Terrain {}
public class Dirt : Terrain {}
public class SteelPlate : Terrain {}
public class Square
{
    public Square(Terrain terrain)
    {
        Terrain = terrain;
    }
    public Terrain Terrain { get; private set; }
    // additional properties not relevant here
} 
```

还有一个名为 MapView 的 UserControl，包含以下内容：

```
<UserControl.Resources>
    <DataTemplate DataType="{x:Type TerrainDataModels:Square}">
        <ContentControl Content="{Binding Path=Terrain}"/>
    </DataTemplate>
    <DataTemplate DataType="{x:Type TerrainDataModels:Dirt}">
        <Canvas Width="40" Height="40" Background="Tan"/>
    </DataTemplate>
    <DataTemplate DataType="{x:Type TerrainDataModels:SteelPlate}">
        <Canvas Width="40" Height="40" Background="Silver"/>
    </DataTemplate>
</UserControl.Resources>
<ItemsControl ItemsSource="{Binding}"/> 
```

鉴于此代码，如果我这样做：

```
mapView.DataContext = new ObservableCollection<Square> {
    new Square(new Dirt()),
    new Square(new SteelPlate())
}; 
```

我得到的东西看起来完全符合我的预期：一个 StackPanel，其中包含一个棕褐色盒子（用于 Dirt）和一个银色盒子（用于 SteelPlate）。但我得到了不必要的开销。

我特别关心的是我的 Square 数据模板：

```
<DataTemplate DataType="{x:Type TerrainDataModels:Square}">
    <ContentControl Content="{Binding Path=Terrain}"/>
</DataTemplate> 
```

我真正想说的是“不，不要费心渲染 Square 本身，而是渲染它的 Terrain 属性”。这接近于这个，但是这为每个 Square 的可视化树添加了两个额外的控件：一个 ContentControl，如上面 XAML 中明确编码的那样，以及它的 ContentPresenter。我在这里并不特别想要 ContentControl；我真的很想短路并将 Terrain 属性的 DataTemplate 直接插入到控件树中。

但是我如何告诉 ItemsControl 渲染 collectionitem.Terrain （从而查找上述地形对象的 DataTemplate 之一）而不是渲染 collectionitem （并为 Square 对象寻找 DataTemplate）？

我想将 DataTemplates 用于地形，但完全不一定用于 Square——这只是我发现的第一种有效的方法。事实上，我真正想做的是完全不同的事情——我真的想将 ItemsControl 的 DisplayMemberPath 设置为“Terrain”。这会直接呈现正确的对象（Dirt 或 SteelPlate 对象），而无需添加额外的 ContentControl 或 ContentPresenter。不幸的是，DisplayMemberPath 总是呈现一个字符串，而忽略了地形的 DataTemplates。所以它有正确的想法，但对我来说没用。

这整个事情可能是过早的优化，如果没有*简单*的方法来获得我想要的，我会接受我所拥有的。但是，如果有一种“WPF 方式”我还不知道要绑定到属性而不是整个集合项，它将增加我对 WPF 的理解，这正是我所追求的。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-26T14:15:36.400

我不确定你的模型是什么样的，但你总是可以使用 . 绑定到对象属性。例如：

```
<DataTemplate DataType="TerrainModels:Square">
  <StackPanel>
    <TextBlock Content="{Binding Path=Feature.Name}"/>
    <TextBlock Content="{Binding Path=Feature.Type}"/>
  </StackPanel>
</DataTemplate> 
```

**更新**

虽然，如果您正在寻找一种方法来绑定集合中的两个不同对象，您可能需要查看该[`ItemTemplateSelector`](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.itemtemplateselector.aspx)属性。

在您的场景中，它将是这样的（未经测试）：

```
public class TerrainSelector : DataTemplateSelector
{
  public override DataTemplate SelectTemplate(object item, DependencyObject container)
  {
    var square = item as Square;
    if (square == null) 
       return null;
    if (square.Terrain is Dirt)
    {
      return Application.Resources["DirtTemplate"] as DataTemplate;
    }
    if (square.Terrain is Steel)
    {
      return Application.Resources["SteelTemplate"] as DataTemplate;
    }
    return null;
  }
} 
```

然后要使用它，您将拥有：

**应用程序.xaml**

```
<Application ..>
  <Application.Resources>
    <DataTemplate x:Key="DirtTemplate">
      <!-- template here -->
    </DataTemplate>
    <DataTemplate x:Key="SteelTemplate">
      <!-- template here -->
    </DataTemplate>
  </Application.Resources>
</Application> 
```

**窗口.xaml**

```
<Window  ..>
  <Window.Resources>
    <local:TerrainSelector x:Key="templateSelector" />
  </Window.Resources>
  <ItemsControl ItemSource="{Binding Path=Terrain}" ItemTemplateSelector="{StaticResource templateSelector}" />
</Window> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T15:09:04.587

我相信消除视觉树开销（和冗余）的最佳方法是：

```
<ItemsControl ItemsSource="{Binding Squares}">
    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <ContentPresenter Content="{Binding Terrain}"/>
        </DataTemplate>
    </ItemsControl.ItemTemplate>
</ItemsControl> 
```

我本可以发誓你可以更进一步，直接为 中的每个项目分配生成的`Content`属性：`ContentPresenter``ItemsControl`

```
<ItemsControl ItemsSource="{Binding Squares}">
    <ItemsControl.ItemContainerStyle>
        <Style>
            <Setter Property="ContentPresenter.Content" Content="{Binding Terrain}"/>
        </Style>
    </ItemsControl.ItemContainerStyle>
</ItemsControl> 
```

但是，`ContentPresenter`似乎将父级`DataContext`作为其`DataContext`而不是`Square`. 这对我来说毫无意义。它适用于一个`ListBox`或任何其他`ItemsControl`子类。也许这是一个 WPF 错误 - 不确定。我将不得不进一步调查。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T00:29:45.690

我正在添加另一个答案，因为这与我的另一个答案不同。

如果你想改变 Canvas 的背景，那么你可以像这样使用 DataTrigger：

```
<DataTemplate DataType="{x:Type WpfApplication1:Square}">
    <DataTemplate.Resources>
        <WpfApplication1:TypeOfConverter x:Key="typeOfConverter" />
    </DataTemplate.Resources>
    <Canvas Name="background" Fill="Green" />
    <DataTemplate.Triggers>
        <DataTrigger Binding="{Binding Path="Terrain" Converter={StaticResource typeOfConverter}}" Value="{x:Type WpfApplication1:Dirt}">
            <Setter  TargetName="background"Property="Fill" Value="Tan" />
        </DataTrigger>
        <DataTrigger Binding="{Binding Path="Terrain" Converter={StaticResource typeOfConverter}}" Value="{x:Type WpfApplication1:SteelPlate}">
            <Setter TargetName="background" Property="Fill" Value="Silver" />
        </DataTrigger>
    </DataTemplate.Triggers>
</DataTemplate> 
```

您还需要使用此转换器：

```
public class TypeOfConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        return value.GetType();
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        throw new System.NotImplementedException();
    }

} 
```

# python - pyinotify 在创建时读取文件的错误？

> ID：790898
> 
> 赞同：3
> 
> 时间：2009-04-26T14:07:21.787
> 
> 标签：python, linux

每次在某个目录中创建新文件时，我都想解析一个文件。为此，我正在尝试使用[pyinotify](http://pyinotify.sourceforge.net/)设置一个目录来监视`IN_CREATE`内核事件，并触发该`parse()`方法。

这是模块：

```
from pyinotify import WatchManager,
    ThreadedNotifier, ProcessEvent, IN_CREATE

class Watcher(ProcessEvent):

    watchdir = '/tmp/watch'

    def __init__(self):
        ProcessEvent.__init__(self)
        wm = WatchManager()
        self.notifier = ThreadedNotifier(wm, self)
        wdd = wm.add_watch(self.watchdir, IN_CREATE)
        self.notifier.start()

    def process_IN_CREATE(self, event):
        pfile = self._parse(event.pathname)
        print(pfile)

    def _parse(self, filename):
        f = open(filename)
        file = [line.strip() for line in f.readlines()]
        f.close()
        return file

if __name__ == '__main__':
    Watcher() 
```

问题是 _parse 返回的列表在由新文件创建事件触发时为*空*`watcher.py`，如下所示（文件在运行时在另一个窗口中创建）：

```
$ python watcher.py
[] 
```

...但奇怪的是，它在直接调用时从解释器会话中工作。

```
>>> import watcher
>>> w = watcher.Watcher()
>>> w._parse('/tmp/watch/sample')
['This is a sample file', 'Another line', 'And another...'] 
```

为什么会这样？我调试这个东西最远的地方是知道有什么东西让 pyinotify 不能正确读取文件。但为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T14:14:47.603

可能你想等到文件关闭？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T14:43:42.167

正如@SilentGhost 提到的，您可能在将任何内容添加到文件之前读取文件（即，您收到文件创建而不是文件写入的通知）。

更新：带有 pynotify tarball 的 loop.py 示例会将 inotify 事件序列转储到屏幕上。要确定您需要触发哪个事件，请启动 loop.py 以监控 /tmp，然后执行您要跟踪的文件操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T15:55:54.537

这是一些对我有用的代码，带有 2.6.18 内核、Python 2.4.3 和 pyinotify 0.7.1——你可能使用其中一些的不同版本，但重要的是要确保我们谈论的是相同的版本，我认为...：

```
#!/usr/bin/python2.4

import os.path
from pyinotify import pyinotify

class Watcher(pyinotify.ProcessEvent):

    watchdir = '/tmp/watch'

    def __init__(self):
        pyinotify.ProcessEvent.__init__(self)
        wm = pyinotify.WatchManager()
        self.notifier = pyinotify.ThreadedNotifier(wm, self)
        wdd = wm.add_watch(self.watchdir, pyinotify.EventsCodes.IN_CREATE)
        print "Watching", self.watchdir
        self.notifier.start()

    def process_IN_CREATE(self, event):
        print "Seen:", event
        pathname = os.path.join(event.path, event.name)
        pfile = self._parse(pathname)
        print(pfile)

    def _parse(self, filename):
        f = open(filename)
        file = [line.strip() for line in f]
        f.close()
        return file

if __name__ == '__main__':
      Watcher() 
```

当它在终端窗口中运行时，在另一个终端窗口中我做

```
echo "ciao" >/tmp/watch/c3 
```

这个程序的输出是：

```
Watching /tmp/watch
Seen: event_name: IN_CREATE   is_dir: False   mask: 256   name: c3   path: /tmp/watch   wd: 1   
['ciao'] 
```

正如预期的那样。所以你能不能试试这个脚本（当然，如果需要，在 hashbang 中修复 Python 版本）并告诉我们你正在使用的 Linux 内核、pyinotify 和 Python 的确切版本，你在这些确切的情况下观察到什么？很可能通过更详细的信息，我们可以准确地确定哪个错误或异常给您带来问题。谢谢！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-26T19:58:01.413

`IN_CLOSE_WRITE`我想我通过使用事件解决了这个问题。我不确定在那之前发生的事情使它不起作用。

@Alex：谢谢，我试过你的脚本，但我使用的是更新版本：Python 2.6.1、pyinotify 0.8.6 和 Linux 2.6.28，所以它对我不起作用。

这绝对是在文件写入之前尝试解析文件的问题，因此感谢 SilentGhost 和 DanM 解决这个问题。

# php - jQuery getJSON 到外部 PHP 页面

> ID：790910
> 
> 赞同：9
> 
> 时间：2009-04-26T14:17:02.700
> 
> 标签：php, jquery, ajax, json, getjson

我一直在尝试向外部服务器发出 AJAX 请求。到目前为止，我了解到出于安全原因我需要使用 getJSON 来执行此操作？

现在，我似乎无法简单地调用外部页面。我试图尽可能地简化它，但它仍然无法正常工作。我有 2 个文件，test.html 和 test.php

我的 test.html 像这样调用 localhost 进行测试：

```
 $.getJSON("http://localhost/OutVoice/services/test.php", function(json){
    alert("JSON Data: " + json);
}); 
```

我希望我的 test.php 返回一个简单的“测试”：

```
$results = "test";
echo json_encode($results); 
```

我可能犯了一些令人难以置信的菜鸟错误，但我似乎无法弄清楚。另外，如果这可行，我怎样才能将数据发送到我的 test.php 页面，就像你会做的那样 test.php?id=15 ？

* * *

test.html 页面在本地主机上调用 test.php 页面，同一目录我没有收到任何错误，只是没有警报..

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-26T14:26:44.877

*可能*是您在 test.php 中没有回调。此外，`json_encode`只接受一个数组：

```
$results = array("key" => "value");
echo $_GET['callback'] . '(' . json_encode($results) . ')';
// the callback stuff is only needed if you're requesting from different domains 
```

当`XMLHttpRequest`您使用`http://`. 如果您在同一个域上有 test.html 和 test.php，请尝试使用相对路径（并且没有回调）。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2010-11-19T20:57:15.783

小心moff的回答。它有一个常见的 XSS 漏洞：[http ://www.metaltoad.com/blog/using-jsonp-safely](http://www.metaltoad.com/blog/using-jsonp-safely)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-06T20:45:16.337

最简单的解决方案是在 test.php 文件的任何输出之前添加以下代码，然后您可以更灵活地使用您使用的方法，标准 ajax 调用应该可以工作。

```
header ('Access-Control-Allow-Origin: *'); 
```

但是，当您从无法控制的服务器获取数据时，请使用 json 回调。

# jquery - jQuery 和其他库

> ID：790912
> 
> 赞同：2
> 
> 时间：2009-04-26T14:17:54.460
> 
> 标签：jquery, conflict

我在使用 jQuery 时遇到了这个问题，不知道如何解决它....任何人都可以帮助或提供一些帮助！？

> [异常...“组件返回失败代码：0x80070057 (NS_ERROR_ILLEGAL_VALUE) [nsIDOMXPathEvaluator.evaluate]”nsresult:“0x80070057 (NS_ERROR_ILLEGAL_VALUE)”位置：“JS 框架 :: [http://example.com/wp-content/plugins/ IMM-Glossary/JavaScripts/prototype.js](http://example.com/wp-content/plugins/IMM-Glossary/JavaScripts/prototype.js) :: 匿名 :: line 1081" 数据：无] 来源：[http ://example.com/wp-content/plugins/IMM-Glossary/JavaScripts/prototype.js](http://example.com/wp-content/plugins/IMM-Glossary/JavaScripts/prototype.js)

谢谢

编辑：感谢您的回复:) 问题是我阅读了[http://docs.jquery.com/Using_jQuery_with_Other_Libraries](http://docs.jquery.com/Using_jQuery_with_Other_Libraries) - 我现在使用“jQuery”？所以不确定它为什么会发生？

PS - 关于代码 - 我什至不使用自己的代码。我只是使用这个插件和 jquery - 它会抛出错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T14:28:22.703

1.  您的错误指向原型脚本，而不是 jQuery。
2.  你还没有发布任何代码。
3.  [谷歌搜索。](http://www.google.com/search?hl=en&q=nsIDOMXPathEvaluator.evaluate+error)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T14:29:48.193

首先，从错误消息来看，问题似乎出在 Prototype js 库上，而不是 jQuery 库上。

其次，错误代码（0x80070057）的形式表明这是一个COM组件的问题。

我猜你将一个 jQuery 选择器传递给 Prototype——两者都使用 $()——而原型不知道如何评估它。（原型将它传递给 nsIDOMXPathEvaluator 组件——我猜那是“Netscape Xpath Evaluator”——它对错误的 XPath 格式犹豫不决）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T14:44:55.660

尝试使用`$.noConflict()`-[将 jQuery 与其他库一起使用](http://docs.jquery.com/Using_jQuery_with_Other_Libraries)

# php - 在 PHP 中创建字符串时 " 和 ' 有什么区别？

> ID：790913
> 
> 赞同：1
> 
> 时间：2009-04-26T14:18:00.887
> 
> 标签：php

非常基本，但想知道使用“与”的区别/安全后果等。

有人可以提供一个例子来解释何时使用每一个吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-26T14:19:50.713

有很多细微的差别，你需要阅读[php 文档](http://www.php.net/manual/en/language.types.string.php#language.types.string.syntax.single)来获得很多细节，但重要的细节是：

双引号被解析，而单引号是文字。

您可以使用带双引号的内联变量，但不能使用单引号。

不过有一些问题：

```
<?php
$beer = 'Heineken';
echo "$beer's taste is great"; // works; "'" is an invalid character for variable names
echo "He drank some $beers";   // won't work; 's' is a valid character for variable names but the variable is "$beer"
echo "He drank some ${beer}s"; // works
echo "He drank some {$beer}s"; // works
?> 
```

单引号稍微快一些。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-26T14:20:19.697

当字符串用双引号括起来时，就会解释转义序列`\n`和变量标识符等`$var`。

有关具体细节和示例，请参阅[PHP 字符串手册](http://www.php.net/manual/en/language.types.string.php#language.types.string.syntax.single)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-26T14:21:31.503

**最大**的就是这个。在双引号内，您可以包含变量，但在单引号内，变量名将是文字：

```
$var1 = "hello";

// this will echo "hello world"
echo "$var1 world";

// this will echo $var1 world
echo '$var1 world'; 
```

在许多情况下，使用**双引号变得非常有用**，特别是当您将**{}**放在变量名周围时。这里有一些例子（*当然其他人可以给你更多的例子*）：

```
// array elements
echo "Element 5 is {$myArray[5]}";
echo "Element 2 subelement 3 is {$myArray[2][3]}";
//
// a dynamic key 
$value = "thing";
$someValue = $myArray["some{$value}"]; // returnd $myArray[something] 
```

# python - 如何在 OS X 上进行 PyS60 开发

> ID：790915
> 
> 赞同：1
> 
> 时间：2009-04-26T14:18:13.557
> 
> 标签：python, nokia, s60, pys60

是否可以在 Mac OS X 上进行[PyS60开发？](http://sourceforge.net/projects/pys60)有一个用于 Symbian C++ 开发的 XCode 插件，但我不知道我是否可以用它为我的诺基亚手机创建 Python 应用程序。我说的是更全面的 SDK 体验，而不仅仅是使用 Textmate/Emacs 编辑文件并将它们复制到设备上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-12-03T21:01:52.077

我建议您将 PuTools 添加到您的开发环境中。它让您可以轻松地在手机和电脑之间同步文件，并为您提供比默认蓝牙外壳更多功能的远程外壳。

“官方”PuTools 说明是为 Windows 机器编写的，但这些工具肯定也适用于 Mac。[这些说明](http://www.instructables.com/id/PyS60:-PUTools,-Advanced-Python-console-from-your-/)应该会有所帮助。

（作为一个新用户，我只能发布一个链接。如果您正在寻找原始的 PuTools 网站，这是一个简单的谷歌搜索。祝你好运！）

编辑：如果您在 Symbian 设备上使用 PyS60 v2.x 的警告：不幸的是，PuTools 尚未针对 PyS60 v2 进行更新。:(

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T14:28:17.417

好吧，使用手机上的 python，您需要做的就是能够上传脚本，并使用[MWS](http://mymobilesite.net/)，这是最简单的方法。[MWS](http://mymobilesite.net/)支持 webdav 上传，也可以使用 obexftp 和蓝牙将脚本放到正确的位置。

理论上也可以将它们包装在 SIS 文件中，但我自己还没有这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-26T13:03:17.393

我在 mac 上使用 komodo edit 5 编辑器并将其指向 nokia appfwui 类，然后编辑器将为您自动完成诺基亚 Pys60 api。

我还使用下面给出的步骤将脚本复制到设备上进行测试（因为模拟器无法在 mac os x 上运行）

[http://discussion.forum.nokia.com/forum/showthread.php?t=116771](http://discussion.forum.nokia.com/forum/showthread.php?t=116771)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-05T13:05:54.640

S60模拟器只能在Windows下运行，所以Mac机主在模拟器下运行。听说效果很好。

# windows-vista - DNN 页面在 IE7/Vista 中正确呈现

> ID：790918
> 
> 赞同：0
> 
> 时间：2009-04-26T14:19:14.660
> 
> 标签：windows-vista, internet-explorer-7, dotnetnuke

我有一个 dot net nuke 站点，我已经为其编写了一个自定义模块。它是用户填写以提交信息的表格 - 没什么大不了的。

在表单上，​​我使用 Ajax 和 Ajaxoolkit 进行验证，并使用日历弹出窗口。我根据表单数据启用/禁用控件。

Everthing 在我测试过的每个浏览器/操作系统组合中都运行良好，除了 IE7/Vista。

页面呈现时大多数标签和控件不可见。控件在那里，您甚至可以输入数据，您可以看到它们。

这是一个链接： [http ://www.gpusbc.com/test/tabid/76/Default.aspx](http://www.gpusbc.com/test/tabid/76/Default.aspx)

我在装有 IE7 和 FireFox 的 Win XP 机器上开发，没有任何问题。Vista 上的 FireFox 没有问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T14:37:07.317

仅供参考，这在常规或兼容模式下的 Vista 上的 IE8 中不起作用。这非常奇怪，因为控件在那里，您可以单击它们，但是例如，如果您键入文本框，则看不到数据。

我发现，如果您删除从 .aaInput 类继承的 float:left 样式，您的所有输入都会变得可见。我还删除了你的块显示。在标签和输入上都这样做，你应该很好。

我在 IE8 模式和兼容模式下使用 IE8 的开发人员工具对此进行了测试。

# ruby-on-rails - 如何编写指向公共文件的链接

> ID：790927
> 
> 赞同：1
> 
> 时间：2009-04-26T14:24:23.180
> 
> 标签：ruby-on-rails, hyperlink

在我的 Rails 应用程序中，我在 /public 目录中有一些文件，我想在视图中写入超链接。除了编写旧的 HTML 之外，我该怎么做`<a href...`

有没有简洁的`link_to`方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T14:30:17.443

使用锚元素没有任何问题，毕竟这就是`link_to`输出。但是，您应该能够做到：

```
<%= link_to 'Some File', '/some_file.zip' %> 
```

# windows - 让 Cocoa 应用程序在 Windows 上运行有多难？

> ID：790930
> 
> 赞同：26
> 
> 时间：2009-04-26T14:26:32.757
> 
> 标签：windows, cocoa, macos

在[关于 Cocoa 的维基百科文章中，](http://en.wikipedia.org/wiki/Cocoa_(API))它说：

> Cocoa 框架的主要部分也有开源实现，允许跨平台（包括 Microsoft Windows）Cocoa 应用程序开发，例如[GNUstep](http://en.wikipedia.org/wiki/GNUstep)、[Cappuccino](http://en.wikipedia.org/wiki/Cappuccino_(Application_Development_Framework))和[Cocotron](http://www.cocotron.org/)。

然而，当我研究 Mac 应用程序[Tweetie](http://www.atebits.com/tweetie-mac/)是否可用于 Windows 时，开发人员已经[排除了它](http://getsatisfaction.com/atebits/topics/a_windows_version_of_tweetie)：

> Windows 没有 Cocoa，Tweetie 所在的编程环境，因此，这似乎不太可能。

我想知道 Tweetie 开发人员（以及作为其他可可开发人员的资源）的答案，这会告诉他们：

*   哪种实现最适合让可可应用程序在 Windows 上运行？
*   让应用程序在 Windows 下运行可能需要做多少工作？
*   维护 Mac 和 Windows 的通用代码库有多容易/难？
*   （我错过了任何其他注意事项？）

当然，如果工作量太大，我也想知道这一点，然后再提出建议并可能派其他人进行徒劳的搜索。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-26T14:58:10.497

不要忘记：

1.  “Cocoa 框架的主要部分”与“Cocoa 框架的整体”不同。Tweetie 可能正在使用缺少的东西。
2.  Tweetie 可能（很可能是）使用来自非 Cocoa 框架的 API，例如 Core Foundation、Core Services、Core Graphics 和 Core Animation。仅 Cocoa 框架的一个端口不会包含任何这些 API，甚至更完整的 Mac-API 仿真框架也不会包含所有这些 API。
3.  这些框架永远在追逐苹果。即使他们赶上来，到下一个 Mac OS X 版本时，他们也会立即落后。Mac 开发人员在等待用户升级到这些新版本时，已经推迟在新的 Mac OS X 版本中使用新的 API；现在您要求 atebits*也*等待其他框架开发人员再次赶上 Apple。
4.  现有 API 的任何第二个实现都会有第一个实现没有的错误，反之亦然。这些差异将导致开发和支持问题。
5.  您要求 atebits 将第三个平台添加到已经存在于两个平台上的应用程序中。支持一个平台是一项艰巨的工作。支持两个平台是一项艰巨的工作。支持三？现在你正在进入大公司的领域。

因此，即使使用这些类似 Cocoa 的框架，答案也是：很难。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-26T14:43:37.190

在 GNUstep、Cappuccino 和 Cocotron 中，Cocotron 是将 Mac 应用程序移植到 windows 的唯一可能选择。Cappuccino 是用于 web 的，而 GNUstep 仅在 cygwin 或 mingw 之上运行，这意味着 GUI 看起来不像原生 Windows 应用程序。

理论上可以使用 Cocotron 构建可可 Windows 应用程序。然而，现实情况是它仍然很难使用，并且在 Cocoa API 中仍然相当有限。

因此，有两种可能的解决方案：

*   尽量去除原代码库中Cocotron不支持的代码，进行交叉编译。维护通用代码库会很痛苦。
*   完全启动一个新的 GUI，没有通用的代码库。这里有两个选择
    *   使用 Qt 或 Java 等跨应用程序框架启动跨平台项目。
    *   启动一个仅限 Windows 的项目。这里有很多选择，.Net WinForm 应用程序、MFC 等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T14:36:50.233

有用于 Objective-C （用于编写可可应用程序的编程语言）的[Windows 编译器。](http://www.oreillynet.com/cs/user/view/cs_msg/22037)但是，Cocoa 包含用于呈现 GUI 的框架。这些可视化框架是特定于 Mac OS X 的，因为它们只使用 OS X 的窗口和其他控件。所以有人需要重新实现 Cocoa 中的控件才能使用 Windows 控件。

另外，我相当肯定 Tweetie 只使用 Mac OS X 的技术，比如 Core Animation。这在 Windows 上不存在，因此应用程序中出现的漂亮动画效果必须以完全不同的方式实现。

# text - 如何在 LaTeX 表格中换行？

> ID：790932
> 
> 赞同：555
> 
> 时间：2009-04-26T14:26:47.683
> 
> 标签：text, latex, word-wrap

我正在用 LaTeX 创建一个包含几个表格的报告。我坚持这一点，因为表格中的单元格数据超出了页面的宽度。我可以以某种方式包装文本，使其落入表格同一单元格的下一行吗？

它与表格的宽度有某种关系吗？但是由于它超出了页面的宽度，它会有所作为吗？

* * *

## 回答 #1

> 赞同：661
> 
> 时间：2009-04-26T14:32:46.517

使用 p{width} 作为列说明符，而不是 l/r/c。

```
\begin{tabular}{|p{1cm}|p{3cm}|}
  This text will be wrapped & Some more text \\
\end{tabular} 
```

* * *

编辑：（基于评论）

```
\begin{table}[ht]
    \centering
    \begin{tabular}{p{0.35\linewidth} | p{0.6\linewidth}}
      Column 1  & Column2 \\ \hline
      This text will be wrapped & Some more text \\
      Some text here & This text maybe wrapped here if its tooooo long \\
    \end{tabular}
    \caption{Caption}
    \label{tab:my_label}
\end{table} 
```

我们得到：

[![在此处输入图像描述](https://i.stack.imgur.com/XHn2Z.png)](https://i.stack.imgur.com/XHn2Z.png)

* * *

## 回答 #2

> 赞同：157
> 
> 时间：2009-04-26T14:36:12.607

在常规`tabular`环境中，您希望使用`p{width}`列类型，如 marcog 所示。但这会迫使您给出明确的宽度。

另一个解决方案是`tabularx`环境：

```
\usepackage{tabularx}
...
\begin{tabularx}{\linewidth}{ r X }
    right-aligned foo & long long line of blah blah that will wrap when the table fills the column width\\
\end{tabularx} 
```

* * *

所有 X 列的宽度相同。`\hsize`您可以通过在格式声明中设置来影响这一点：

```
>{\setlength\hsize{.5\hsize}} X >{\setlength\hsize{1.5\hsize}} X 
```

但是我想所有的因素都必须加起来为 1（我从 LaTeX 同伴那里得到了这个）。还有一个包`tabulary`可以调整列宽以平衡行高。`texdoc tabulary`有关详细信息，您可以使用（在 TeXlive 中）获取每个包的文档。

* * *

## 回答 #3

> 赞同：56
> 
> 时间：2010-02-19T01:11:11.783

另一种选择是在需要文本换行的每个单元格中插入一个 minipage，例如：

```
\begin{table}[H]
\begin{tabular}{l}
\begin{minipage}[t]{0.8\columnwidth}%
a very long line a very long line a very long line a very long line
a very long line a very long line a very long line a very long line
a very long line a very long line a very long line %
\end{minipage}\tabularnewline
\end{tabular}
\end{table} 
```

* * *

## 回答 #4

> 赞同：44
> 
> 时间：2014-01-20T14:43:29.747

我喜欢`tabulary`包装的简单性：

```
\usepackage{tabulary}
...
\begin{tabulary}{\linewidth}{LCL}
    \hline
    Short sentences      & \#  & Long sentences                                                 \\
    \hline
    This is short.       & 173 & This is much loooooooonger, because there are many more words.  \\
    This is not shorter. & 317 & This is still loooooooonger, because there are many more words. \\
    \hline
\end{tabulary} 
```

在该示例中，您根据 \textwidth 排列表格的整个宽度。例如 0.4 个。然后其余的由包自动完成。

大部分示例取自[http://en.wikibooks.org/wiki/LaTeX/Tables](http://en.wikibooks.org/wiki/LaTeX/Tables)。

* * *

## 回答 #5

> 赞同：37
> 
> 时间：2018-12-19T19:17:17.020

像一块蛋糕一样简单！

您可以定义一个新的列类型，例如 (`L`在这种情况下)，同时**保持当前对齐方式**( `c`,`r`或`l`)：

```
\documentclass{article}
\usepackage{array}
\newcolumntype{L}{>{\centering\arraybackslash}m{3cm}}

\begin{document}

\begin{table}
    \begin{tabular}{|c|L|L|}
        \hline
        Title 1 & Title 2 & Title 3 \\
        \hline 
        one-liner & multi-line and centered & \multicolumn{1}{m{3cm}|}{multi-line piece of text to show case a multi-line and justified cell}   \\
        \hline
        apple & orange & banana \\
        \hline
        apple & orange & banana \\
        \hline
    \end{tabular}
\end{table}
\end{document} 
```

![在此处输入图像描述](https://i.stack.imgur.com/pcSlA.png)

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-07-19T12:46:55.370

如果要换行但要保持对齐，则可以将该单元格换行在`minipage`or`varwidth`环境中（varwidth 来自 varwidth 包）。Varwidth 将“与它的内容一样宽，但不比 X 宽”。您可以创建一个自定义列类型，其行为类似于“p{xx}”，但通过使用缩小以适应

```
\newcolumntype{M}[1]{>{\begin{varwidth}[t]{#1}}l<{\end{varwidth}}} 
```

这可能需要`array`软件包。然后，当您使用`\begin{tabular}{llM{2in}}`前两列之类的内容时，我们将正常左对齐，第三列将正常左对齐，但如果它比 2in 宽，则文本将被换行。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2019-10-13T12:55:00.437

要将文本更改为`AB`表格`A \r B`单元格中的文本，请将其放入单元格位置：`\makecell{A \\ B}`。

在此之前，您还需要包含 package `makecell`。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2022-01-29T16:52:18.580

新`tabularray`功能使在单元格中换行比以往更容易。

该包支持所有传统使用的列名，如`c`、`l`、`r`等，但也有自己的`Q`列，它接受各种键来控制宽度和垂直和水平对齐。它还提供了一个`X`列，如 tabularx` 中所知，它将自动计算列的宽度以使表格适合可用的文本宽度。

另一个不错的功能是所有设置也可以为单个单元格完成。

```
\documentclass{article}
\usepackage{tabularray}

\begin{document}

\begin{table}
    \begin{tblr}{|c|Q[2cm,valign=m]|X[j,valign=m]|}
        \hline
        Title 1 & Title 2 & Title 3 \\
        \hline 
        one-liner & multi-line text & multi-line piece of text to show case a multi-line and justified cell   \\
        \hline
        apple & orange & banana \\
        \hline
        \SetCell{h,2cm} wrapping text only in a single cell & orange & banana \\
        \hline
    \end{tblr}
\end{table}
\end{document} 
```

[![在此处输入图像描述](https://i.stack.imgur.com/cxg1E.png)](https://i.stack.imgur.com/cxg1E.png)

（感谢[Shayan Amani](https://stackoverflow.com/a/53857840/2777074)在他们的回答中提供了 MWE！）

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2022-03-05T03:11:36.950

只需使用[https://www.tablesgenerator.com/](https://www.tablesgenerator.com/)来包装文本，而不是用疯狂的 LaTeX 命令浪费时间。

* * *

## 回答 #10

> 赞同：-13
> 
> 时间：2013-09-09T05:25:44.853

```
\begin{table}
 \caption{ Example of force text wrap}
 \begin{center}
  \begin{tabular}{|c|c|}
   \hline
   cell 1       &   cell 2 \\   \hline
   cell 3                &       cell 4 & & very big line that needs to be wrap. \\ \hline
   cell 5       &   cell 6 \\   \hline
  \end{tabular}
  \label{table:example}
 \end{center}
\end{table} 
```

# asp.net - asp.net 处理程序和扩展 - 我做错了吗？

> ID：790934
> 
> 赞同：0
> 
> 时间：2009-04-26T14:27:37.620
> 
> 标签：asp.net, httphandler

我的新项目需要在某个日期之后提供一些“隐藏”资产（实际上只是隐藏在 App_Data 目录中）。在此之前，他们应该表现得好像他们不在那里一样。

我已经用 Page 对象做了一百次这种事情，但是当我开始研究这个时，我想我会研究处理程序。从未与他们合作过（并且被他们吓到了），我很高兴地发现他们可以提供我的 XML 和 JPG 文件，而无需整个 Page 类的开销。我已经很高兴我考虑过了。我写它来处理像“MyHandler.ashx?secretfile=blah.xml”这样的功能，它工作得很好。

然后我开始研究特殊的扩展处理，以便处理程序接收对“blah.xml.secret”的请求并在检查日期后返回blah.xml。我脑子里突然亮了几盏灯，我重新编写了代码，以便它处理这种情况。它工作（在 IDE 中）！我很兴奋。

将它放到开发服务器 (IIS) 上有点不同：我必须将 .secret 注册为 .NET 类型（没什么大不了的），直到我取消选中“验证文件存在”复选框之前它仍然无法工作。（blah.xml.secret 显然不存在：blah.xml 存在，但不在要求它的位置，仅在安全的 App_Data 目录中。）这不是什么大不了的事，但现在我的聪明解决方案依赖于两个实现来自 IIS 方面的详细信息。

所以我的问题是：这是 asp.net 中处理程序的预期用途吗？我是否将其扭曲得面目全非？我觉得我过去曾见过网站做这样的把戏，但对于我想做的一件事，IIS 的更改似乎过于复杂。在我对此的研究中，我没有找到一个使用处理程序的灌篮 1-2-3 指南，其中包含这样的示例，所以这让我觉得我可能在滥用它或以错误的方式处理它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T15:28:26.337

是的，这就是它的工作原理。（在 Windows Server 2008 中，您可以通过 web.config 进行设置，这样您就不必在 IIS 中进行任何更改。）

如果您使用尚未注册以由 ASP.NET 引擎处理的扩展，则必须注册它。如果您使用已由 ASP.NET 处理的扩展名，例如 .aspx，则无需在 IIS 中注册任何内容。（当您在 Visual Studio 的集成 Web 服务器中运行它时，一切都已由 ASP.NET 处理，这就是它在那里工作的原因。）

# apache-flex - Adobe Flex 图像缩放质量

> ID：790941
> 
> 赞同：5
> 
> 时间：2009-04-26T14:30:38.673
> 
> 标签：apache-flex, image, scale

我有一个我在 Flex 中编写的图像查看器，它可以根据浏览器的大小缩放您当前正在查看的图像的大小。这就是标签的样子：

```
<mx:Image id="img"
    maintainAspectRatio="true"
    source="{horizontalList.selectedItem.image}-large.jpg"
    height="100%"
    horizontalCenter="0"
    horizontalAlign="center"
    top="5" 
    width="{horizontalList.width}"
    updateComplete="onImageChange()"
    click="onImgClick()"
    /> 
```

原始图像的大小总是大于浏览器的面积，不幸的是，Flex 在缩小图像方面似乎做得并不好。事实上，如果我使用它的图像标签，IE 中的 HTML 会做得更好。是否有我缺少的 Flex 中缩放的“质量”设置？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-05T03:04:38.620

看到这个：[在flex中平滑调整大小的扭曲图像](http://web.archive.org/web/20130606093949/http://askmeflash.com/article/4/smoothing-resized-distorted-images-in-flex)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-09-14T14:34:39.257

了解我几年前发现并在博客中提到的[Flash 平滑问题。](http://npacemo.com/wordpress/2009/07/31/flash-smoothing-issue/)基本上，具有奇数尺寸的图像无法平滑。

要解决此问题，请使用以下代码段：

```
var smoothBitmapData : BitmapData = new BitmapData(
    loadedBitmap.width + (loadedBitmap.width % 2),
    loadedBitmap.height + (loadedBitmap.height % 2),
    true, 0x00FF0000);
smoothBitmapData.draw(loadedBitmap, null, null, null, null, true);

smoothBitmap = new Bitmap(smoothBitmapData, PixelSnapping.NEVER, true); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T03:13:10.503

尝试将控件的宽度和高度设置为图像的尺寸并将 scaleContent 属性设置为 true

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-12-23T05:24:30.817

将 scaleContent 属性设置为 true

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-26T14:50:33.463

这是 Flex 3 的一个麻烦点——在列表控件中使用图像。您必须非常小心才能正确缩放。

为什么不尝试使用控件的不同组合`scaleContent`和`maintainAspectRatio`属性呢？`Image`

[这是关于缩放](http://livedocs.adobe.com/flex/3/html/help.html?content=controls_16.html)图像的教程。

# ruby-on-rails - 学生练习和宠物项目的最佳托管？应该支持导轨

> ID：790947
> 
> 赞同：2
> 
> 时间：2009-04-26T14:33:21.287
> 
> 标签：ruby-on-rails, hosting, portfolio

嗨，我正在寻找最便宜的托管服务，它可以让我部署许多 Rails 和非 Rails 应用程序以及博客和其他好东西。流量可能相当低，但仍然很重要。

就像一个投资组合网站。

什么是好的托管服务提供商？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-26T23:32:18.763

使用 Slicehost（或其他 VPS）。由于您是学生，因此您只能通过自己学习如何设置和使用完整堆栈来帮助自己。因为它是一个 VPS，你必须自己完成大部分工作，而 Slicehost 提供了关于如何完成大部分工作的很好的教程。到目前为止，这对我来说是坚如磐石。

您可以以每月 20 美元的价格获得功能性 256MB 的切片。

Heroku 是一个托管解决方案（他们为你做了很多工作，我还没有计算出价格差异，因为它们只是商业化，但它们应该比 slicehost 贵一点——但我只是在猜测这个） . Dreamhost 没有给你太多的控制权（但要便宜得多）。

所以我的投票是跳过一个月喝酒的夜晚，学习 ubuntu 服务器设置（DNS、vhosts、apache 等、capistrano 部署、SVN 和 mongrel、nginx、乘客，同时学习 Rails。也许还可以加入 SMTP、Starling 和 Workling 以及监视/上帝。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-26T20:17:34.283

[Heroku](http://heroku.com/)刚刚从测试版中出来。他们最便宜的只有一个测功机的计划是免费的。您的存储量非常有限，但部署就像推送到 git 存储库一样简单。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-26T14:52:06.780

尝试[DreamHost](http://dreamhost.com/)或[Slicehost](http://slicehost.com/)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-26T15:17:25.723

免费 ruby​​ on rails 托管列表：
[http ://www.khimhoe.net/2006/07/22/free-ruby-on-rails-hosting/](http://www.khimhoe.net/2006/07/22/free-ruby-on-rails-hosting/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-26T14:52:22.397

因此，您可能需要共享主机帐户。对于便宜的托管，您可以尝试[http://www.hostgator.com/shared.shtml](http://www.hostgator.com/shared.shtml)，它们非常好，我和他们在一起一年了，从来没有遇到过问题。当我取消我的帐户（并转移到 asp.net 托管）时，有人从他们的公司打电话确认取消。

# mercurial - 使用 Mercurial，我如何查看尚未推送的更改？

> ID：790951
> 
> 赞同：5
> 
> 时间：2009-04-26T14:35:11.050
> 
> 标签：mercurial

我习惯了 git，你可以在其中运行 gitk 并获得如下内容：

![gitk 显示本地和远程分支之间的区别](https://1.bp.blogspot.com/_nzN39P0Ykuk/SfRuvDcGsOI/AAAAAAAABEs/nbPb0Jtd-7I/s200/gitk-diff-branch.png)

在这里，您可以看到有一些更改需要推送到远程分支。或者，我可以使用`git log --decorate`，输出将是：

```
b8c2926... (refs/heads/next) Update instructions
6d9f914... Add a first go at generic x compiling
49a6dac... (refs/remotes/github/next) Ignore temp files 
```

Mercurial有类似的东西吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-26T14:42:45.883

`hg outgoing`- 将向您显示等待推送到远程存储库的变更集。

`hg incoming`- 显示远程存储库中的新变更集。

# xslt - xslt 测试变量值是否包含在节点集中

> ID：790952
> 
> 赞同：0
> 
> 时间：2009-04-26T14:35:31.877
> 
> 标签：xslt, xpath

我有以下两个文件：

```
<?xml version="1.0" encoding="utf-8" ?> 
<!-- D E F A U L T H O S P I T A L P O L I C Y -->

<xas DefaultPolicy="open" DefaultSubjectsFile="subjects.xss">
<rule id="R1" access="deny" object="record" subject="roles/*[name()!='Staff']"/> 
<rule id="R2" access="deny" object="diagnosis" subject="roles//Nurse"/>
<rule id="R3" access="grant" object="record[@id=$user]" subject="roles/member[@id=$user]"/> 
</xas> 
```

另一个名为subjects.xss的xml文件是：

```
<?xml version="1.0" encoding="utf-8" ?> 
<subjects>

<users> 
<member id="dupont" password="4A-4E-E9-17-5D-CE-2C-DD-43-43-1D-F1-3F-5D-94-71">

<name>Pierre Dupont</name> 
</member>

 <member id="durand" password="3A-B6-1B-E8-C0-1F-CD-34-DF-C4-5E-BA-02-3C-04-61"> 
<name>Jacqueline Durand</name>

</member>

</users> 
<roles>

<Staff>

<Doctor> 
<member idref="dupont"/>

</Doctor> 
<Nurse>

<member idref="durand"/> 
</Nurse>

</Staff>

</roles> 
</subjects> 
```

我正在编写一个 xsl 表，它将读取 policy.xas 中每个规则的主题值，并且当前登录的用户（可作为样式表中的变量“用户”访问）是否包含在该主题值中（比如角色//护士） ，然后做点什么。

我无法测试当前登录的用户（$user 等于说“durand”）是否包含在主题文件（这是一个不同的 xml 文件）的角色//护士中。希望能澄清我的问题。有任何想法吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T14:54:14.500

我怀疑您的 $user 变量包含一个成员节点，对吗？在这种情况下，测试将是：-

```
/roles/Nurse[member/idref=$user/@id] 
```

顺便说一句，使用标签名称来携带诸如“护士”和“医生”之类的数据并不是一个好习惯。您实际上是在说每个新角色都是一种新类型。更好的是：-

```
<roles>
 <role>
  <name>Nurse</name>
  <member idref="durand" />
 </role>
... 
</roles> 
```

您的测试将是：-

```
/roles/role[name='Nurse' and member/idref=$user/@id] 
```

# sql-server-2005 - SQL 2005 查询的快捷方式

> ID：790954
> 
> 赞同：0
> 
> 时间：2009-04-26T14:36:01.547
> 
> 标签：sql-server-2005, keyboard-shortcuts

在 SQL 2005 中执行日常任务有哪些不同的快捷方式？

例如，`Ctrl`+`T`以文本格式显示结果，`Ctrl`+`D`以数据格式显示结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T14:38:04.427

复制：

[SQL Server Management Studio – 改进 TSQL 编码过程的技巧](https://stackoverflow.com/questions/101079/sql-server-management-studio-tips-for-improving-the-tsql-coding-process)

[SQL Server Management Studio 中的“收藏夹”或“宏”？](https://stackoverflow.com/questions/175944/favorites-or-macros-in-sql-server-management-studio)

列出所有快捷方式的 MSDN 文章：

[SQL Server 2005 Management Studio 键盘快捷键](http://msdn.microsoft.com/en-us/library/ms174205(SQL.90).aspx)

[SQL Server 2008 Management Studio 键盘快捷键](http://msdn.microsoft.com/en-us/library/ms174205.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T14:41:09.833

在您的查询中突出显示一个表名，只要它在同一个数据库中`Alt`+`F1`就会向您显示架构信息。很有用。

# php - 计算 PHP 项目中的行数

> ID：790956
> 
> 赞同：59
> 
> 时间：2009-04-26T14:36:35.943
> 
> 标签：php, count, line

你知道任何可以计算 PHP 项目中所有代码行的工具吗？

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2009-04-26T14:41:44.043

在 POSIX 操作系统（例如 Linux 或 OS X）上，您可以将以下内容写入 Bash shell：

```
wc -l `find . -iname "*.php"` 
```

这将计算当前目录和子目录中所有 php 文件中的行数。（请注意，那些单引号是反引号，而不是实际的单引号）

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-07-23T16:16:48.947

我为自己制作了一个小脚本，以便在我的一个项目中做到这一点。只需在项目根目录中的 php 页面上使用以下代码。该脚本将对子文件夹进行递归检查。

```
<?php
/**
 * A very simple stats counter for all kind of stats about a development folder
 * 
 * @author Joel Lord
 * @copyright Engrenage (www.engrenage.biz)
 * 
 * For more information: joel@engrenage.biz

 */

$fileCounter = array();
$totalLines = countLines('.', $fileCounter); 
echo $totalLines." lines in the current folder<br>";
echo $totalLines - $fileCounter['gen']['commentedLines'] - $fileCounter['gen']['blankLines'] ." actual lines of code (not a comment or blank line)<br><br>";

foreach($fileCounter['gen'] as $key=>$val) {
    echo ucfirst($key).":".$val."<br>";
}

echo "<br>";

foreach($fileCounter as $key=>$val) {
    if(!is_array($val)) echo strtoupper($key).":".$val." file(s)<br>";
}

function countLines($dir, &$fileCounter) {
    $_allowedFileTypes = "(html|htm|phtml|php|js|css|ini)";
    $lineCounter = 0;
    $dirHandle = opendir($dir);
    $path = realpath($dir);
    $nextLineIsComment = false;

    if($dirHandle) {
        while(false !== ($file = readdir($dirHandle))) {
            if(is_dir($path."/".$file) && ($file !== '.' && $file !== '..')) {
                $lineCounter += countLines($path."/".$file, $fileCounter);
            } elseif($file !== '.' && $file !== '..') {
                //Check if we have a valid file 
                $ext = _findExtension($file);
                if(preg_match("/".$_allowedFileTypes."$/i", $ext)) {
                    $realFile = realpath($path)."/".$file;
                    $fileHandle = fopen($realFile, 'r');
                    $fileArray = file($realFile);
                    //Check content of file:
                    for($i=0; $i<count($fileArray); $i++) {
                        if($nextLineIsComment) {
                            $fileCounter['gen']['commentedLines']++;
                            //Look for the end of the comment block
                            if(strpos($fileArray[$i], '*/')) {
                                $nextLineIsComment = false;
                            }
                        } else {
                            //Look for a function
                            if(strpos($fileArray[$i], 'function')) {
                                $fileCounter['gen']['functions']++;
                            }
                            //Look for a commented line
                            if(strpos($fileArray[$i], '//')) {
                                $fileCounter['gen']['commentedLines']++;
                            }
                            //Look for a class
                            if(substr(trim($fileArray[$i]), 0, 5) == 'class') {
                                $fileCounter['gen']['classes']++;
                            }
                            //Look for a comment block
                            if(strpos($fileArray[$i], '/*')) {
                                $nextLineIsComment = true;
                                $fileCounter['gen']['commentedLines']++;
                                $fileCounter['gen']['commentBlocks']++;
                            }
                            //Look for a blank line
                            if(trim($fileArray[$i]) == '') {
                                $fileCounter['gen']['blankLines']++;
                            }
                        }

                    }
                    $lineCounter += count($fileArray);
                }
                //Add to the files counter
                $fileCounter['gen']['totalFiles']++;
                $fileCounter[strtolower($ext)]++;
            }
        }
    } else echo 'Could not enter folder';

    return $lineCounter;
}

function _findExtension($filename) {
    $filename = strtolower($filename) ; 
    $exts = split("[/\\.]", $filename) ; 
    $n = count($exts)-1; 
    $exts = $exts[$n]; 
    return $exts;  
} 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-04-26T14:45:10.043

[SLOCCount](http://www.dwheeler.com/sloccount/)是一个很棒的工具，可以为大量语言生成行数报告。它还通过生成其他相关统计数据（例如预期的开发人员成本）更进一步。

这是一个例子：

```
$ sloccount .
Creating filelist for experimental
Creating filelist for prototype
Categorizing files.
Finding a working MD5 command....
Found a working MD5 command.
Computing results.

SLOC    Directory   SLOC-by-Language (Sorted)
10965   experimental    cpp=5116,ansic=4976,python=873
832     prototype       cpp=518,tcl=314

Totals grouped by language (dominant language first):
cpp:           5634 (47.76%)
ansic:         4976 (42.18%)
python:         873 (7.40%)
tcl:            314 (2.66%)

Total Physical Source Lines of Code (SLOC)                = 11,797
Development Effort Estimate, Person-Years (Person-Months) = 2.67 (32.03)
 (Basic COCOMO model, Person-Months = 2.4 * (KSLOC**1.05))
Schedule Estimate, Years (Months)                         = 0.78 (9.33)
 (Basic COCOMO model, Months = 2.5 * (person-months**0.38))
Estimated Average Number of Developers (Effort/Schedule)  = 3.43
Total Estimated Cost to Develop                           = $ 360,580
 (average salary = $56,286/year, overhead = 2.40).
SLOCCount, Copyright (C) 2001-2004 David A. Wheeler
SLOCCount is Open Source Software/Free Software, licensed under the GNU GPL.
SLOCCount comes with ABSOLUTELY NO WARRANTY, and you are welcome to
redistribute it under certain conditions as specified by the GNU GPL license;
see the documentation for details.
Please credit this data as "generated using David A. Wheeler's 'SLOCCount'." 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2011-05-03T06:42:40.350

不幸的是，SLOCCount 有点长，对于 PHP 项目来说是一件很痛苦的事情，特别是那些有一个`vendor`你不想计算的嵌套目录的项目。此外，它会为每个没有结束标记的 PHP 文件发出警告（如果您没有混合 HTML 和 PHP，则应该是所有这些文件）。

[CLOC](http://cloc.sourceforge.net/)是一个更现代的替代方案，它可以做所有事情（编辑：几乎所有事情） SLOCCount 可以做，但也支持一个`--exclude-dir`选项，它不会受到上述关闭标签问题的影响。它还发出一个 SQLite 数据库，您可以从中提取一些非常高级的指标。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-05-21T10:52:50.353

从命令行在 Windows 上：

```
findstr /R /N "^" *.php | find /C ":" 
```

感谢[这篇文章](http://brett.batie.com/scripting/count-number-of-lines-in-a-file-using-dos/)。

要包含子目录，请使用`\s` ：

```
findstr /s /R /N "^" *.php | find /C ":" 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-09-20T14:08:32.953

PHP 项目的 SLOC 可以使用[sloccount](http://www.dwheeler.com/sloccount/)来计算，如下所示：

```
find . -not -wholename '*/libraries/*' -not -wholename '*/lib/*' -not -wholename '*/vendor/*' -type f xargs sloccount 
```

大型 drupal 项目的示例输出：

```
[...]
SLOC    Directory   SLOC-by-Language (Sorted)
44892   top_dir         pascal=33176,php=10293,sh=1423

Totals grouped by language (dominant language first):
pascal:       33176 (73.90%)
php:          10293 (22.93%)
sh:            1423 (3.17%)

Total Physical Source Lines of Code (SLOC)                = 44,892
Development Effort Estimate, Person-Years (Person-Months) = 10.86 (130.31)
 (Basic COCOMO model, Person-Months = 2.4 * (KSLOC**1.05))
Schedule Estimate, Years (Months)                         = 1.33 (15.91)
 (Basic COCOMO model, Months = 2.5 * (person-months**0.38))
Estimated Average Number of Developers (Effort/Schedule)  = 8.19
Total Estimated Cost to Develop                           = $ 1,466,963
 (average salary = $56,286/year, overhead = 2.40).
SLOCCount, Copyright (C) 2001-2004 David A. Wheeler
SLOCCount is Open Source Software/Free Software, licensed under the GNU GPL.
SLOCCount comes with ABSOLUTELY NO WARRANTY, and you are welcome to
redistribute it under certain conditions as specified by the GNU GPL license;
see the documentation for details.
Please credit this data as "generated using David A. Wheeler's 'SLOCCount'." 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-04-03T11:44:20.697

```
<?php
passthru('wc -l `find . -iname "*.php"`');
?> 
```

只需在放置所有 php 文件的当前目录上运行它，它将在浏览器上显示计数行。

# python - 如何合成声音？

> ID：790960
> 
> 赞同：7
> 
> 时间：2009-04-26T14:37:33.057
> 
> 标签：python, numpy, alsa

我想产生类似于真实乐器音频的声音。问题是我几乎不知道如何获得它。

我所知道的与真实乐器相去甚远的是，它们输出的声音很少是干净的。但是如何产生这种不干净的声音呢？

到目前为止，我已经做到了这一点，它产生了非常简单的声音，我不确定它是否正确使用了 alsa。

```
import numpy
from numpy.fft import fft, ifft
from numpy.random import random_sample
from alsaaudio import PCM, PCM_NONBLOCK, PCM_FORMAT_FLOAT_LE

pcm = PCM()#mode=PCM_NONBLOCK)
pcm.setrate(44100)
pcm.setformat(PCM_FORMAT_FLOAT_LE)
pcm.setchannels(1)
pcm.setperiodsize(4096)

def sine_wave(x, freq=100):
    sample = numpy.arange(x*4096, (x+1)*4096, dtype=numpy.float32)
    sample *= numpy.pi * 2 / 44100
    sample *= freq
    return numpy.sin(sample)

for x in xrange(1000):
    sample = sine_wave(x, 100)
    pcm.write(sample.tostring()) 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-26T14:43:37.177

声音合成是一个复杂的课题，需要多年的学习才能掌握。

这也不是一个完全解决的问题，尽管最近的发展（例如物理建模合成）在模仿现实世界的仪器方面取得了进展。

有许多选项可供您选择。如果您确定要进一步探索合成，那么我建议您从学习 FM 合成开始。它相对容易在软件中学习和实现，至少在基本形式上是这样，并且可以产生各种有趣的声音。另外，请查看 Curtis Roads 的“计算机音乐教程”一书。这是一本关于所有计算机音乐的圣经，虽然它已经有几年历史了，但它是学习基础知识的首选书籍。

如果您想要更快地产生逼真的声音，请考虑使用采样技术：即录制您想要重现的乐器（或使用预先存在的样本库），然后播放样本。这是一种更直接（而且通常更有效）的方法。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-26T16:32:34.277

高兴，如果你想（从头开始）生成听起来真的“有机”的东西，比如一个物理对象，你最好了解一下这些声音是如何生成的。要获得可靠的介绍，您可以看一本书，例如 Fletcher 和 Rossings [The Physics of Musical Instruments](https://rads.stackoverflow.com/amzn/click/com/0387983740)。网上也有很多东西，你可能想看看 James Clark 的入门[书](http://www.cim.mcgill.ca/~clark/emusic.html)

至少浏览一下这类东西会让你知道你要面对什么。准确地为物理仪器建模是非常困难的！

如果你想做的是一些听起来像物理的东西，而不是听起来像乐器 X 的东西，你的工作会更容易一些。你可以很容易地建立频率并将它们叠加在一起，添加一点噪音，你会得到至少听起来不像纯音的东西。

阅读一些有关傅立叶分析的一般知识会有所帮助，调频 (FM) 技术也会有所帮助。

玩得开心！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T15:28:41.420

我同意这是非常重要的，并且没有固定的“正确方法”，但是您应该考虑从（或自己制作）[MIDI](http://en.wikipedia.org/wiki/Musical_Instrument_Digital_Interface) [SoundFont](http://en.wikipedia.org/wiki/SoundFont)开始。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-15T04:46:25.397

正如其他人所说，这根本不是一个微不足道的话题。在事物的编程方面（特别是如果您关心低延迟）和综合部分都存在挑战。声音合成的金矿是 Julius O. Smith 的页面。有*很多*合成技术[http://ccrma-www.stanford.edu/~jos/](http://ccrma-www.stanford.edu/~jos/)。

# sql - 如何按日期顺序从多个 MySQL 表中返回数据？

> ID：790963
> 
> 赞同：1
> 
> 时间：2009-04-26T14:38:56.860
> 
> 标签：sql, mysql

我还有另一个 MySQL 问题。再一次，复杂的查询让我无法理解。

在我的网站上，我*目前*在主页上显示最后 5 款评论过的游戏。现在，已经有一段时间了，我决定将新闻项目也添加到同一页面。

但是，我想将我拥有的系统*更改*为显示新闻条目和评论的系统 - 显示在任一类别中发布的最后一个条目。这两个表完全不相关（新闻、评论）。

以下列是我想要返回的内容：

```
news.newsTitle
news.newsBody
news.postedOn (timestamp)
review.postedOn (timestamp)
review.reviewSummary
review.ourScore
game.gameName
game.gameImage 
```

游戏表通过**gameID**连接到**评论**表，但这些表都没有与**新闻**表关联。

当前查询是这样的：

```
SELECT news.newsTitle, news.newsBody, DATE_FORMAT( review.postedOn,  '%M %d, %Y' ) AS reviewPosted, DATE_FORMAT( news.postedOn,  '%M %d, %Y' ) AS newsPosted, game.gameID, gameName, gameImage, review.reviewSummary, review.ourScore
FROM game
LEFT JOIN news ON news.newsID = news.newsID
LEFT JOIN review ON game.gameID = review.gameID
WHERE game.isPublished =  'y'
ORDER BY game.gameID DESC 
LIMIT 0 , 5 
```

但这所做的只是将新闻项目与游戏信息一起显示 5 次。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T14:45:49.650

您需要调查 UNION - 创建两个输出相同数量（和等效）列的查询，使用 UNION 连接结果，然后按日期排序并将结果限制在前 5 个。

使用上述方法，您可以返回最新的前 5 名，无论它们在新闻/评论之间的组合如何 - 这就是您的意思吗？

以下应返回所需的数据：

```
(SELECT news.newsTitle AS title, news.newsBody AS body, 
DATE_FORMAT( news.postedOn,  '%M %d, %Y' ) AS posted,
news.postedOn, null AS image, null AS score
FROM news)
UNION ALL
(SELECT game.gameName as title, review.reviewSummary AS body,
DATE_FORMAT( review.postedOn,  '%M %d, %Y' ) AS posted,
review.postedOn, game.gameImage AS image, review.ourScore AS score
FROM game LEFT JOIN review ON game.gameID = review.gameID 
WHERE game.isPublished = 'y')    
ORDER BY postedOn DESC
LIMIT 0,5 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T14:56:18.470

为什么要使用同一个查询提取两个完全不相关的数据？您可以通过为评论和新闻中的每个结果生成一个 rowid 来做一些杂技，然后将结果加入 rowids；或者通过从两者中选择类似的列并按照 BrynJ 的建议使用 UNION 。但是，当您只需发出两个查询时，所有这些似乎都完全没有必要。

这些东西属于一起吗？

如果你是使用内存中的对象而不是数据库来编写这个 - 你会有一些包含两者的集合，还是两个单独包含它们的单独集合？

**更新** 我在评论中得到了我的问题的答案；现在我明白你想要做什么了。我见过这种事情有两种方法：一种是从所有来源（评论、评论、新闻、上传的照片等）中选择最新的数据，按日期对它们进行排序，然后得到前 X在客户端。这样做的缺点是查询的数量与数据源的数量成比例地增加，但它的好处是在表示层方面非常灵活——你可以从不同的对象中选择不同的列，根据你的需要设置它们的格式欲望，并在客户端做任何你需要做的事情（在这种情况下，客户端是你的软件，而不是 Web 客户端）。

另一种是强制使用一组一致的列来表示任何对象，这些对象可能为空——通常是“类型、标题、正文、日期、img_id”之类的东西——并使用联合，正如另一张海报所建议的那样。这样做的好处是允许您使用单个查询，从而使您的软件不那么复杂；它的缺点是，当涉及到您可能想要粘贴在提要中的其他类型的事物时，灵活性较低，并且可能会使数据库过载（这部分取决于您的情况下数据库的瓶颈有多大）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T15:59:34.887

好的，我已经成功了一半。问题是日期格式排序，通过选择时间戳作为虚拟 MySQL 现在返回正确的结果集。呸！

```
(
SELECT news.newsTitle AS title, news.newsBody AS body, news.postedOn AS dummy, DATE_FORMAT( news.postedOn,  '%M %d, %Y' ) AS posted
FROM news
)
UNION ALL (

SELECT game.gameName AS title, review.reviewSummary AS body, review.postedOn AS dummy, DATE_FORMAT( review.postedOn,  '%M %d, %Y' ) AS posted
FROM game
LEFT JOIN review ON game.gameID = review.gameID
WHERE game.isPublished =  'y'
)
ORDER BY dummy DESC 
LIMIT 0 , 5 
```

我可以强制 MySQL 返回评论行的其余数据（游戏得分和游戏图像），如果它是新闻行，则返回 null 吗？

我意识到这可能是不可能的，但如果快速破解可以做到这一点，那就更好了。

# javascript - 元素列表解析 JSON 后缺少 ]

> ID：790968
> 
> 赞同：8
> 
> 时间：2009-04-26T14:41:36.777
> 
> 标签：javascript, json, parsing

执行：

```
$.post(
"/url/to/method",
{ },
function(data){
    var obj2 = eval("("+$(data).children()+")");
    // OR var obj = $.evalJSON($($(data).children())); // Jquery-json
    $body = $("#AAA");
    $body.html(obj.fied);
},
 "xml"
); 
```

而在萤火虫中变成“元素列表后缺少]”（在第5行或第6行）错误。方法的 JSON 输出已通过 jsonlint.com/ 进行验证

可能很明显，但请我是 AJAX/JSON 的新手。谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2010-04-15T23:44:37.790

可能发生的情况是您的 $.post 调用已经返回一个 JSON 对象。jQuery 将尝试自动检测 JSON 并为您解析它。当您对这样的 JSON 对象调用 eval 时，您会看到此错误。偷偷摸摸！只需按原样使用数据对象。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-26T14:55:48.100

使用[JSON.parse](http://www.json.org/js.html)方法，或者在传递给 eval 之前确保在你的括号旁边包含一个空格...

```
eval(" (" + data + ") "); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T18:26:00.400

您是在 .NET 2.0 中编写的吗？如果是这样，请尝试将您的数据构造成查询字符串，而不是传递 JSON 对象。

示例：var1=alma&var2=user

其中“var1”和“var2”是您的 webmethod 期望的参数的名称。使用帖子传递这个.. 数据：{querystring} 我在 2.0 中将 JSON 传递给 web 服务时遇到了问题。

祝你好运

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-21T10:15:49.313

事实证明，jQuery 会尝试判断结果是否为 JSON 并自动解析它，但在这种情况下，数据已经是一个 JavaScript 对象，而不是等待解析的 JSON 字符串。因此，您可以按原样使用此对象，而不是使用 eval() 和 JSON.parse。

# path - cons 可以在我的路径中找到可执行文件吗？

> ID：790971
> 
> 赞同：1
> 
> 时间：2009-04-26T14:42:39.673
> 
> 标签：path, cons

我正在尝试调试`cons`脚本，我遇到的问题是我自己的可执行文件`$PATH`似乎没有找到。简而言之：可以`cons`在我的路径中找到可执行文件吗？

这似乎是一个愚蠢的问题，因为常见问题解答[说](http://www.baldmt.com/cons-faq/current.html#SS_6_3)

> Cons 不会将用户的环境传递给它为构建软件而派生的子进程。您需要或想要从用户环境传入的任何内容都必须明确地完成。

但是，我不清楚那`cons`不应该看到我`$PATH`的（上面的措辞是我不希望子进程可以访问任何环境变量）。在执行`Construct`,`$PATH`评估为空但`$ENV{PATH}`确实包含我的路径。

我不知道`cons`也无济于事`Perl`，所以我真的不知道自己在做什么，也不知道从哪里开始寻找导致问题的`:)`原因对于它的价值，对我不起作用的脚本，但确实适用于脚本的原作者，位于[此处](http://www.latex-project.org/svnroot/latex2e-public/Construct)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T03:30:44.663

对于它的价值，常见问题解答中的指南是正确的，因为这样可以解决问题：

```
# A standard construction environment.
$env = new cons(
   ENV => { PATH => $ENV{PATH} }
); 
```

然后可以跟随，例如，

```
Command $env 'foo', qq(echo =`which tex`=); 
```

运行/安装/构建/无论你对`cons`脚本做什么。

# linux - 如何在 Ubuntu 8.10 中为 6.001 设置 MIT 方案

> ID：790976
> 
> 赞同：4
> 
> 时间：2009-04-26T14:44:39.997
> 
> 标签：linux, ubuntu, scheme, lisp, mit-scheme

我通过视频讲座和讲义进行自学 6.001。但是，我在 Ubuntu (intrepid) 中设置 MIT 方案时遇到了一些问题。

我使用包管理并安装了 MIT-Scheme，但它显然是使用错误的版本。它应该是 7.5.1 而不是 7.7.90

我按照这个网站的说明（[http://ocw.mit.edu/OcwWeb/Electrical-Engineering-and-Computer-Science/6-001Spring-2005/Tools/detail/linuxinstall.htm](http://ocw.mit.edu/OcwWeb/Electrical-Engineering-and-Computer-Science/6-001Spring-2005/Tools/detail/linuxinstall.htm)）

到目前为止，我已经下载了 tar 文件，并解压到 /usr/local。我不知道第 3 步是什么意思。

然后我输入命令

> 方案 -large -band 6001.com -edit

错误是

> 此配置没有足够的内存。我尝试在sudo模式下运行，这次的错误是不同的Unable to allocate process table。
> 
> 检测到不一致

我有接近 1GB 的可用内存，以及充足的硬盘空间。我应该怎么做才能成功设置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T15:00:49.927

第 3 步意味着您应该键入`export MITSCHEME_6001_DIRECTORY=${your_problems_path}`. 如果你不想在每次启动 Scheme 时都输入它，你应该把它作为一个字符串放在你的 ~/.bash_profile 文件中（如果你使用 bash）

关于问题本身，谷歌立即提出了一个解决方案：（ `sudo sysctl -w vm.mmap_min_addr=0`取自[http://ubuntuforums.org/showthread.php?p=4868292](http://ubuntuforums.org/showthread.php?p=4868292)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T05:59:36.053

除了包管理器，您可能还想为 Unix 编译可移植的 C 源代码。我很高兴地使用它。

# asp.net - 将用户控件呈现为字符串模板

> ID：790980
> 
> 赞同：2
> 
> 时间：2009-04-26T14:47:14.373
> 
> 标签：asp.net, user-controls

您如何看待将用户控件呈现为字符串模板，基本上是像[Irenderable 实现](http://aspadvice.com/blogs/ssmith/archive/2007/10/19/Render-User-Control-as-String-Template.aspx)这样的实现，你们认为它有什么缺点吗？我遇到的优点之一是我可以使用我的用户控件来简单地返回 ajax 调用所需的 HTML。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T15:31:23.457

您还可以使用这种方法为电子邮件或 PDF 呈现 html。我做了很多hackery来抓取我的页面并将它们的输出呈现给字符串生成器，以便我可以转换它们或发送电子邮件。

当您需要将当前页面打印为 pdf 或通过电子邮件发送此页面并且您想要发送用户当前正在查看的 html 时，我会这样做。

# java - 在哪里寻找开源 Java 库？

> ID：790986
> 
> 赞同：2
> 
> 时间：2009-04-26T14:50:40.670
> 
> 标签：java, open-source, github, google-code, sourceforge

我正在寻找一个 Java 库来合并到一个演示网络应用程序中，并查看了 github、Google Code 和 sourceforge。到目前为止，sourceforge 似乎拥有最多的选择。还有其他地方可以看吗，或者 sourceforge 会是我最好的选择吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-26T14:56:23.947

我相信你应该看看[Java-Source.net](http://java-source.net/)和[OpenSymphony](http://www.opensymphony.com/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-26T15:23:04.320

也许您可以告诉我们您需要什么样的图书馆并听取建议，而不是只是随意徘徊。也就是说，明显的站点包括[Apache](http://apache.org/)，尤其是[Jakarta](http://jakarta.apache.org/)和[Savannah](http://savannah.gnu.org/)。另请注意，并非 GitHub 上托管的所有内容都是 FOSS。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-26T15:00:33.593

[Freshmeat](http://freshmeat.net/)也是开源项目的一大来源。[这](http://freshmeat.net/tags/java-libraries)是标记为 Java 库的项目列表。

# iphone - Iphone 的 MMX 指令

> ID：790988
> 
> 赞同：2
> 
> 时间：2009-04-26T14:51:51.540
> 
> 标签：iphone, assembly, neon

iphone处理器ARMV6是否支持MMX指令？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-26T18:08:01.257

简短的回答是否定的——MMX 是一种英特尔技术。更长的答案是 ARM 支持[Neon SIMD 指令集](http://www.arm.com/products/processors/technologies/neon.php)。它与 MMX 指令的架构相似（即它计算向量），但显然不一样。ARM 提供库来帮助您生成 SIMD 代码（使用[OpenMAX](http://www.khronos.org/openmax/)和 GCC 编译器内部函数）。

iPhone 包括一个不支持 NEON 的 ARMv6KZ，后来的型号包括一个基于 ARM Cortex-A8 内核并支持 Neon 的三星 S5PC100。同样，为 iPad 供电的 Apple A4 是基于 Cortex-A8 的 SoC。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-26T15:09:55.023

[MMX](http://en.wikipedia.org/wiki/MMX_(instruction_set))是 x86 的[SIMD](http://en.wikipedia.org/wiki/SIMD)指令集。iPhone 使用 ARM 处理器，因此您不能使用 MMX。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-11-23T12:54:10.613

正如其他人在这里发布的那样，MMX 是用于 x86 架构的英特尔 SIMD 技术。所以不，iPhone 本身不支持 MMX。

iPhone 配备了 ARM Coretex A8 CPU，特别是[三星 SoC S5PC100](http://www.samsung.com/global/business/semiconductor/support/brochures/downloads/systemlsi/s5pc100_brochure_200902.pdf)，它提供了称为[NEON](http://en.wikipedia.org/wiki/ARM_architecture#Advanced_SIMD_.28NEON.29)（ARM 相当于 MMX）的 SIMD 扩展。

虽然 Apple 尚未明确记录这一点，但工具链似乎支持它。gcc 中有 NEON 的内在函数，因此您应该能够使用 NEON 编写 SIMD 代码。

*   [iPhone SIMD 的 NEON 示例](http://monkeystylegames.com/?p=82)
*   [NEON 参考的 GCC 内在函数](http://gcc.gnu.org/onlinedocs/gcc/ARM-NEON-Intrinsics.html)

请注意，此功能是 3GS 特有的，因此不向后兼容。您需要确保您的应用程序被标记以表明它需要 3GS（我认为您不能访问状态寄存器以进行运行时检测）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-26T15:00:09.600

可能有用的链接：[ARM 处理器指令集架构](http://www.arm.com/products/CPUs/architecture.html)。

看起来ARMV6有*某种*SIMD单元......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-26T15:22:15.413

ARM 有点可配置，因此，iPhone 中的 ARM 可能没有这个。如果 NDA 允许，实际注册该计划的人可能能够回答。

如果你有一些必须工作的东西，我猜你可以构建 bochs。我的猜测是您想使用 mmx 指令来提高速度，而且，显然，这不会有很大帮助。如果您有一些运行缓慢的算法，但是如果没有 mmx 指令，您无法对其进行逆向工程以运行，那么 bochs 可能会解决问题。

# c# - ASP 下拉列表城市选择器

> ID：790999
> 
> 赞同：1
> 
> 时间：2009-04-26T14:56:26.473
> 
> 标签：c#, asp.net, drop-down-menu

我有一个加载了城市/国家的 asp 下拉列表。它们直接在代码中加载

`<asp:ListItem Value="MIA">Miami, Florida</asp:ListItem>`

我想使用 Ajax 扩展控件，以允许用户开始输入并从下面的下拉列表中显示类似的匹配选项。这可能使用此控件和硬编码值吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-26T15:06:54.267

您描述的行为通常是通过扩展文本框控件而不是下拉列表来实现的。

[微软的asp.net 网站](http://www.asp.net/)上有很多有用的教程；试试这个：[http](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/AutoComplete/AutoComplete.aspx) ://www.asp.net/AJAX/AjaxControlToolkit/Samples/AutoComplete/AutoComplete.aspx开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T14:33:35.607

如果您想编写自己的控件，我已经写了一篇关于通过 javascript 向 DropDownList 添加值时的一些问题的博客 [http://blog.runxc.com/post/2009/04/27/Using-jQuery-to -add-values-to-a-DropDownList-and-overcoming-ASPNET.aspx](http://blog.runxc.com/post/2009/04/27/Using-jQuery-to-add-values-to-a-DropDownList-and-overcoming-ASPNET.aspx)*******