# StackOverflow 问答 10905000-10905999

# mysql - Mysql插入查询要修复

> ID：10905002
> 
> 赞同：4
> 
> 时间：2012-06-05T21:08:27.003
> 
> 标签：mysql, sql

我有这个 mysql 查询插入查询，它给出了下面提到的错误，我不知道为什么

# 1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 3 行的 'VALUES ('edinburgh', 'edinburgh*glasgow' ,'Loreum ipsim'), VALUES ('newcastle', ' 附近使用正确的语法

```
INSERT INTO wp_widget_custom (name,centers,description)     
VALUES ('glasgow',  'glasgow*edinburgh' ,'Loreum ipsim'),
VALUES ('edinburgh',    'edinburgh*glasgow' ,'Loreum ipsim'),
VALUES ('newcastle',    'newcastle*middles-brough'  ,'Loreum ipsim'),
VALUES ('leeds',    'leeds' ,'Loreum ipsim'),
VALUES ('manchester',   'manchester'    ,'Loreum ipsim'),
VALUES ('nottingham',   'nottinghamshire*lichfield' ,'Loreum ipsim'),
VALUES ('lichfield',    'lichfield*birmingham*nottinghamshire'  ,'Loreum ipsim'),
VALUES ('birmingham',   'lichfield*birmingham*milton-keynes'    ,'Loreum ipsim'),
VALUES ('milton-keynes',    'milton-keynes*hemel-hempstead*hertfordshire'   ,'Loreum ipsim'),
VALUES ('cardiff',  'cardiff*bristol-international' ,'Loreum ipsim'),
VALUES ('bristol',  'bristol-international*bristol*cardiff' ,'Loreum ipsim'),
VALUES ('plymouth', 'plymouth'  ,'Loreum ipsim'),
VALUES ('southampton',  'southampton*hemel-hempstead*reading*maidenhead*slough' ,'Loreum ipsim'),
VALUES ('reading',  'hemel-hempstead*hertfordshire*reading*maidenhead*slough*guildford' ,'Loreum ipsim'),
VALUES ('slough',   'surrey*hertfordshire*hemel-hempstead*reading'  ,'Loreum ipsim'),
VALUES ('hemel-hempstead',  'slough*surrey*guildford*bromley*london*billericay*hertfordshire*hemel' ,'Loreum ipsim'),
VALUES ('london',   'hempstead*maidenhead'  ,'Loreum ipsim'),
VALUES ('crawley',  'crawley*bromley*guildford*surrey*london'   ,'Loreum ipsim'),
VALUES ('bromley',  'billericay*crawley*london*billiericay*bromley' ,'Loreum ipsim'),
VALUES ('upminster',    'crawley'   ,'Loreum ipsim'),
VALUES ('billericay',   'billericay*london*bromley' ,'Loreum ipsim'),
VALUES ('livingston',   'edinburgh*glasgow' ,'Loreum ipsim'),
VALUES ('renfrewshire', 'edinburgh*glasgow' ,'Loreum ipsim'),
VALUES ('northumberland',   'newcastle' ,'Loreum ipsim'),
VALUES ('west-yorkshire',   'leeds' ,'Loreum ipsim'),
VALUES ('cheshire', 'manchester'    ,'Loreum ipsim'),
VALUES ('nottinghamshire',  'nottinghamshire'   ,'Loreum ipsim'),
VALUES ('staffordshire',    'lichfield*birmingham*nottinghamshire'  ,'Loreum ipsim'),
VALUES ('warwickshire', 'milton-keynes*birmingham'  ,'Loreum ipsim'),
VALUES ('northamptonshire', 'milton-keynes' ,'Loreum ipsim'),
VALUES ('south-gloucestershire',    'bristol-international*bristol*cardiff' ,'Loreum ipsim'),
VALUES ('north-somerset',   'bristol*bristol-international*cardiff' ,'Loreum ipsim'),
VALUES ('devon',    'plymouth'  ,'Loreum ipsim'),
VALUES ('hampshire',    'southampton*guildford*surrey*reading*maidenhead*slough'    ,'Loreum ipsim'),
VALUES ('berkshire',    'southampton*maidenhead*reading*slough*surrey'  ,'Loreum ipsim'),
VALUES ('maidenhead',   'guildford*hemel-hempstead*hertfordshire'   ,'Loreum ipsim'),
VALUES ('surrey',   'surrey*guildford*reading*slough'   ,'Loreum ipsim'),
VALUES ('sussex',   'bromley*crawley'   ,'Loreum ipsim'),
VALUES ('kent', 'crawley'   ,'Loreum ipsim'),
VALUES ('essex',    'bromley*sittingbourne*london*london*billericay*bromley'    ,'Loreum ipsim'),
VALUES ('hertfordshire',    'hemel-hempstead*hertfordshire*slough*milton-keynes*maidenhead*slough'  ,'Loreum ipsim'),
VALUES ('buckinghamshire',  'hemel-hempstead*hertfordshire' ,'Loreum ipsim'),
VALUES ('oxfordshire',  'milton-keynes' ,'Loreum ipsim'),
VALUES ('leicestershire',   'lichfield*nottinghamshire' ,'Loreum ipsim'),
VALUES ('derbyshire',   'nottinghamshire*lichfield' ,'Loreum ipsim'),
VALUES ('portsmouth',   'southampton'   ,'Loreum ipsim'),
VALUES ('gloucester',   'bristol*milton-keynes*birmingham*lichfield'    ,'Loreum ipsim'),
VALUES ('coventry', 'nottinghamshire'   ,'Loreum ipsim'),
VALUES ('stoke-on-trent',   'manchester*lichfield*nottinghamshire'  ,'Loreum ipsim'),
VALUES ('bolton',   'manchester*leeds'  ,'Loreum ipsim'),
VALUES ('huddersfield', 'leeds' ,'Loreum ipsim'),
VALUES ('liverpool',    'manchester'    ,'Loreum ipsim'),
VALUES ('merseyside',   'manchester'    ,'Loreum ipsim'),
VALUES ('leicester',    'birmingham*nottinghamshire'    ,'Loreum ipsim'),
VALUES ('bradford', 'leeds' ,'Loreum ipsim'),
VALUES ('wolverhampton',    'birmingham*lichfield*nottinghamshire'  ,'Loreum ipsim'),
VALUES ('dudley',   'birmingham*lichfield*nottinghamshire*hemel-hempstead*hertfordshire*slough' ,'Loreum ipsim'),
VALUES ('luton',    'maidenhead'    ,'Loreum ipsim'),
VALUES ('preston',  'manchester'    ,'Loreum ipsim'),
VALUES ('sunderland',   'newcastle*middlesbrough*birmingham*lichfield*nottinghamshire'  ,'Loreum ipsim'),
VALUES ('walsall',  'manchester'    ,'Loreum ipsim'),
VALUES ('swansea',  'cardiff'   ,'Loreum ipsim'),
VALUES ('norfolk',  'thetford-forest'   ,'Loreum ipsim'),
VALUES ('norwich',  'thetford-forest'   ,'Loreum ipsim'),
VALUES ('hull', 'hull'  ,'Loreum ipsim');
enter code here 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T21:11:25.460

```
INSERT INTO wp_widget_custom (name,centers,description) VALUES     
('glasgow',  'glasgow*edinburgh' ,'Loreum ipsim'),
('edinburgh',    'edinburgh*glasgow' ,'Loreum ipsim'),
('newcastle',    'newcastle*middles-brough'  ,'Loreum ipsim'),
('leeds',    'leeds' ,'Loreum ipsim'),
('manchester',   'manchester'    ,'Loreum ipsim'),
('nottingham',   'nottinghamshire*lichfield' ,'Loreum ipsim'),
('lichfield',    'lichfield*birmingham*nottinghamshire'  ,'Loreum ipsim'),
('birmingham',   'lichfield*birmingham*milton-keynes'    ,'Loreum ipsim'),
('milton-keynes',    'milton-keynes*hemel-hempstead*hertfordshire'   ,'Loreum ipsim'),
('cardiff',  'cardiff*bristol-international' ,'Loreum ipsim'),
('bristol',  'bristol-international*bristol*cardiff' ,'Loreum ipsim'),
('plymouth', 'plymouth'  ,'Loreum ipsim'),
('southampton',  'southampton*hemel-hempstead*reading*maidenhead*slough' ,'Loreum ipsim'),
('reading',  'hemel-hempstead*hertfordshire*reading*maidenhead*slough*guildford' ,'Loreum ipsim'),
('slough',   'surrey*hertfordshire*hemel-hempstead*reading'  ,'Loreum ipsim'),
('hemel-hempstead',  'slough*surrey*guildford*bromley*london*billericay*hertfordshire*hemel' ,'Loreum ipsim'),
('london',   'hempstead*maidenhead'  ,'Loreum ipsim'),
('crawley',  'crawley*bromley*guildford*surrey*london'   ,'Loreum ipsim'),
('bromley',  'billericay*crawley*london*billiericay*bromley' ,'Loreum ipsim'),
('upminster',    'crawley'   ,'Loreum ipsim'),
('billericay',   'billericay*london*bromley' ,'Loreum ipsim'),
('livingston',   'edinburgh*glasgow' ,'Loreum ipsim'),
('renfrewshire', 'edinburgh*glasgow' ,'Loreum ipsim'),
('northumberland',   'newcastle' ,'Loreum ipsim'),
('west-yorkshire',   'leeds' ,'Loreum ipsim'),
('cheshire', 'manchester'    ,'Loreum ipsim'),
('nottinghamshire',  'nottinghamshire'   ,'Loreum ipsim'),
('staffordshire',    'lichfield*birmingham*nottinghamshire'  ,'Loreum ipsim'),
('warwickshire', 'milton-keynes*birmingham'  ,'Loreum ipsim'),
('northamptonshire', 'milton-keynes' ,'Loreum ipsim'),
('south-gloucestershire',    'bristol-international*bristol*cardiff' ,'Loreum ipsim'),
('north-somerset',   'bristol*bristol-international*cardiff' ,'Loreum ipsim'),
('devon',    'plymouth'  ,'Loreum ipsim'),
('hampshire',    'southampton*guildford*surrey*reading*maidenhead*slough'    ,'Loreum ipsim'),
('berkshire',    'southampton*maidenhead*reading*slough*surrey'  ,'Loreum ipsim'),
('maidenhead',   'guildford*hemel-hempstead*hertfordshire'   ,'Loreum ipsim'),
('surrey',   'surrey*guildford*reading*slough'   ,'Loreum ipsim'),
('sussex',   'bromley*crawley'   ,'Loreum ipsim'),
('kent', 'crawley'   ,'Loreum ipsim'),
('essex',    'bromley*sittingbourne*london*london*billericay*bromley'    ,'Loreum ipsim'),
('hertfordshire',    'hemel-hempstead*hertfordshire*slough*milton-keynes*maidenhead*slough'  ,'Loreum ipsim'),
('buckinghamshire',  'hemel-hempstead*hertfordshire' ,'Loreum ipsim'),
('oxfordshire',  'milton-keynes' ,'Loreum ipsim'),
('leicestershire',   'lichfield*nottinghamshire' ,'Loreum ipsim'),
('derbyshire',   'nottinghamshire*lichfield' ,'Loreum ipsim'),
('portsmouth',   'southampton'   ,'Loreum ipsim'),
('gloucester',   'bristol*milton-keynes*birmingham*lichfield'    ,'Loreum ipsim'),
('coventry', 'nottinghamshire'   ,'Loreum ipsim'),
('stoke-on-trent',   'manchester*lichfield*nottinghamshire'  ,'Loreum ipsim'),
('bolton',   'manchester*leeds'  ,'Loreum ipsim'),
('huddersfield', 'leeds' ,'Loreum ipsim'),
('liverpool',    'manchester'    ,'Loreum ipsim'),
('merseyside',   'manchester'    ,'Loreum ipsim'),
('leicester',    'birmingham*nottinghamshire'    ,'Loreum ipsim'),
('bradford', 'leeds' ,'Loreum ipsim'),
('wolverhampton',    'birmingham*lichfield*nottinghamshire'  ,'Loreum ipsim'),
('dudley',   'birmingham*lichfield*nottinghamshire*hemel-hempstead*hertfordshire*slough' ,'Loreum ipsim'),
('luton',    'maidenhead'    ,'Loreum ipsim'),
('preston',  'manchester'    ,'Loreum ipsim'),
('sunderland',   'newcastle*middlesbrough*birmingham*lichfield*nottinghamshire'  ,'Loreum ipsim'),
('walsall',  'manchester'    ,'Loreum ipsim'),
('swansea',  'cardiff'   ,'Loreum ipsim'),
('norfolk',  'thetford-forest'   ,'Loreum ipsim'),
('norwich',  'thetford-forest'   ,'Loreum ipsim'),
('hull', 'hull'  ,'Loreum ipsim'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T21:11:27.550

只要有一个`VALUES`：

```
Insert into table (..) VALUES (...),(...),... 
```

不要重复`VALUES`关键字。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T21:11:57.680

您无需重复单词 VALUES。

来自[http://dev.mysql.com/doc/refman//5.5/en/insert.html](http://dev.mysql.com/doc/refman//5.5/en/insert.html)

> 使用 VALUES 语法的 INSERT 语句可以插入多行。为此，请包含多个列值列表，每个列表都包含在括号中并用逗号分隔。
> 
> 示例： INSERT INTO tbl_name (a,b,c) VALUES(1,2,3),(4,5,6),(7,8,9);

# c# - 谷歌图表显示数据不可用

> ID：10905008
> 
> 赞同：0
> 
> 时间：2012-06-05T21:08:50.650
> 
> 标签：c#, ajax, json, asp.net-mvc-3, google-visualization

我正在尝试使用理解查询语法从我的数据库中提取数据，然后将其作为 Json 对象传递，以便 Google 图表可以显示数据，但它说数据不可用。我的查询语法看起来不错，我什至在 Mysql 工作台中尝试过，它返回了我想要的结果。但是，它没有返回我在 C# MVC 项目中想要的结果。也许我没有正确返回数据对象。它适用于虚拟数据，但不适用于数据库中的数据。

```
[HttpPost]
    public JsonResult GetChartData()
    {
        //var siteData = new[] { new { time = 2345, tdate = "2012, 3, 1" },
        //                       new { time = 4568, tdate = "2012, 3, 2" },
        //                       new { time = 1237, tdate = "2012, 3, 3" },
        //                       new { time = 9874, tdate = "2012, 3, 4" },
        //};

        var test = from p in _db.page_loads
                    join f in _db.sites
                    on p.site_id equals f.id
                    where f.thirdParty_id == siteId //(siteId is private int declared in my class above
                    select new { time = p.time, created_at = p.created_at };

        return Json(test);           
    } 
```

这就是我的脚本在视图部分的样子

```
<script type='text/javascript' src='http://www.google.com/jsapi'></script>
<script type='text/javascript'>
    google.load('visualization', '1', { 'packages': ['annotatedtimeline'] });

    google.setOnLoadCallback(drawChart);

    function drawChart() {

        $.post('/metrics/GetChartData', {},
        function (data) {
            var tdata = new google.visualization.DataTable();

            tdata.addColumn('datetime', 'Date');
            tdata.addColumn('number', 'Times');

            for (var i = 0; i < data.length; i++) {
                                    var date = new Date(parseInt(data[i].created_at.substr(6)));
                                    var load_time = data[i].time;
                                    tdata.addRow([date, load_time]);
            }

            var chart = new google.visualization.AnnotatedTimeLine(document.getElementById('chart_div'));
            chart.draw(tdata, { displayAnnotations: true });

        });

    } 
```

# asp.net-mvc-4 - Autofac - DDD 分层应用程序 - iRepository 的引用泛型 - 如何？

> ID：10905011
> 
> 赞同：1
> 
> 时间：2012-06-05T21:08:58.277
> 
> 标签：asp.net-mvc-4, autofac

所以我在我的应用程序中使用 Autofac，看起来如下（从上到下的方法）。

该项目在 MVC 4 中，我添加了 AutoFac.MVC4 测试版。

*   Web App Client（Web 应用程序 - 表示层）：namespace = AppBase.Web
*   Web App Core（例如各种 actionresults，...）：namespace = AppBase.Web.Core
*   服务（例如 AuthenticationService、MemberService、TaskService）：命名空间 = AppBase.Service
*   数据（包括存储库，...）：命名空间 = AppBase.Data
*   域（Code Fist 的 POCO 对象）：命名空间 = AppBase.Domain

我将 Autofac 包含在我的 Web App Client 中，并带有以下初始化代码（目前）：

```
public void RegisterContainersUsingAutofac()
    {
        var builder = new ContainerBuilder();
        builder.RegisterModelBinders(Assembly.GetExecutingAssembly());
        builder.RegisterModelBinderProvider();
        builder.RegisterControllers(typeof(MvcApplication).Assembly);

        IContainer container = builder.Build();
        DependencyResolver.SetResolver(new AutofacDependencyResolver(container));
    } 
```

Web App Client 引用核心、域和服务层。服务层引用数据层（对于存储库）。

我的数据层中有一个名为 iRepository 的接口，我所有的存储库都实现了这些

我想知道，我应该在我的“RegisterContainersUsingAutofac”方法中添加什么代码，以自动（以通用方式）添加所有存储库和服务，所以我不应该每次都自己添加它们。请记住，未引用数据层（我可以，但我认为不应该）。

PS。我过去使用过 Unity，但我喜欢 AutoFac 拥有的通用方法（在一个项目中，我有超过 +/-180 行添加存储库和服务，所以这是我不再想要的东西）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T12:55:32.003

直到最近我还在使用 Unity.Mvc 并切换到 Autofac。我对 Unity.Mvc 的问题是，无缘无故，它会工作一分钟而不是下一分钟，它似乎非常不稳定。

Autofac 的使用和配置都很容易，自从我开始使用它以来，我没有遇到过任何问题。

我使用 WebActivator，所以我的大部分配置内容都在它们自己的类中作为引导程序对象，而不是在 Global.asax 文件中乱扔一堆代码。

下面是 Autofac 引导程序的 (VB.NET) 代码。您会看到，最初我在该文件中注册了每个服务对象和每个存储库对象，但现在它们已被注释掉，而我使用自动注册功能。

该项目正在使用 Mvc4。

```
#Region "Imports"

Imports System.Reflection
Imports Autofac
Imports Autofac.Integration.Mvc
Imports MyCompany.Data.Interfaces
Imports MyCompany.Data.Repositories
Imports MyCompany.Services
Imports MyCompany.Services.Interfaces
Imports MyCompany.Web.Mvc.Public.Bootstrap
Imports MyCompany.Web.Mvc.Public.Services

#End Region

#Region "Assembly Meta"

' This tells the app to run the "Start" method prior to running the App_Start method in Global.asax
<Assembly: WebActivator.PreApplicationStartMethod(GetType(AutofacDI), "Initialize")> 

#End Region

Namespace MyCompany.Web.Mvc.Public.Bootstrap

    ''' <summary>
    ''' Class to setup dependency injection and register types/services.
    ''' </summary>
    ''' <remarks></remarks>
    Public NotInheritable Class AutofacDI

        ''' <summary>
        ''' Method to register the Autofac dependency injection component.
        ''' </summary>
        ''' <remarks>
        ''' This line of code below could alternatively be placed in Global.asax App_Start(), doing
        ''' so in this manner ensures that this gets run "PreStart".
        ''' </remarks>
        Public Shared Sub Initialize()

            ' Create Unity dependency container.
            Dim dependencyContainer = BuildIocContainer()

            ' Set DI resolver
            DependencyResolver.SetResolver(New AutofacDependencyResolver(dependencyContainer))

        End Sub

        ''' <summary>
        ''' Registers the IOC types/services.
        ''' </summary>
        ''' <returns></returns>
        ''' <remarks></remarks>
        Private Shared Function BuildIocContainer() As Autofac.IContainer

            Dim builder = New ContainerBuilder

            With builder
                ' Register Controllers
                .RegisterControllers(Assembly.GetExecutingAssembly())

                ' Custom MyCompany/Mvc objects
                .RegisterType(Of FormsAuthenticationService)().As(Of IFormsAuthenticationService)().InstancePerHttpRequest()
                .RegisterType(Of AccountMembershipService)().As(Of IMembershipService)().InstancePerHttpRequest()

                '***************************************************************
                '*  MyCompany service objects.
                '***************************************************************
                ' This is auto registration, it replaces all the individual registration lines of code below.
                builder.RegisterAssemblyTypes(GetType(CatalogCodeService).Assembly).
                    Where(Function(t) t.Name.EndsWith("Service")).AsImplementedInterfaces().InstancePerHttpRequest()

                '.RegisterType(Of CatalogCodeService)().As(Of ICatalogCodeService)().InstancePerHttpRequest()
                '.RegisterType(Of ChargeCodeService)().As(Of IChargeCodeService)().InstancePerHttpRequest()
                '.RegisterType(Of CommentsService)().As(Of ICommentsService)().InstancePerHttpRequest()
                '.RegisterType(Of CommissionService)().As(Of ICommissionService)().InstancePerHttpRequest()
                '.RegisterType(Of ConfigCriteriaService)().As(Of IConfigCriteriaService)().InstancePerHttpRequest()
                '.RegisterType(Of ConfigGroupService)().As(Of IConfigGroupService)().InstancePerHttpRequest()
                '.RegisterType(Of ConfigQuestionService)().As(Of IConfigQuestionService)().InstancePerHttpRequest()
                '.RegisterType(Of ContactService)().As(Of IContactService)().InstancePerHttpRequest()
                '.RegisterType(Of CustomerProductItemService)().As(Of ICustomerProductItemService)().InstancePerHttpRequest()
                '.RegisterType(Of CustomerService)().As(Of ICustomerService)().InstancePerHttpRequest()
                '.RegisterType(Of OrderItemService)().As(Of IOrderItemService)().InstancePerHttpRequest()
                '.RegisterType(Of OrderService)().As(Of IOrderService)().InstancePerHttpRequest()
                '.RegisterType(Of PriceBreakService)().As(Of IPriceBreakService)().InstancePerHttpRequest()
                '.RegisterType(Of PriceService)().As(Of IPriceService)().InstancePerHttpRequest()
                '.RegisterType(Of ProductItemService)().As(Of IProductItemService)().InstancePerHttpRequest()
                '.RegisterType(Of QuoteItemService)().As(Of IQuoteItemService)().InstancePerHttpRequest()
                '.RegisterType(Of QuoteService)().As(Of IQuoteService)().InstancePerHttpRequest()
                '.RegisterType(Of ShipmentItemService)().As(Of IShipmentItemService)().InstancePerHttpRequest()
                '.RegisterType(Of ShipmentService)().As(Of IShipmentService)().InstancePerHttpRequest()
                '.RegisterType(Of ShoppingCartItemService)().As(Of IShoppingCartItemService)().InstancePerHttpRequest()
                '.RegisterType(Of ShoppingCartService)().As(Of IShoppingCartService)().InstancePerHttpRequest()
                '.RegisterType(Of SystemTableItemService)().As(Of ISystemTableItemService)().InstancePerHttpRequest()

                '***************************************************************
                '*  MyCompany repository objects (used by service objects above)
                '***************************************************************
                ' This is auto registration, it replaces all the individual registration lines of code below.
                builder.RegisterAssemblyTypes(GetType(CatalogCodeRepository).Assembly).
                    Where(Function(t) t.Name.EndsWith("Repository")).AsImplementedInterfaces().InstancePerHttpRequest()

                '.RegisterType(Of CatalogCodeRepository)().As(Of ICatalogCodeRepository)().InstancePerHttpRequest()
                '.RegisterType(Of ChargeCodeRepository)().As(Of IChargeCodeRepository)().InstancePerHttpRequest()
                '.RegisterType(Of CommentsRepository)().As(Of ICommentsRepository)().InstancePerHttpRequest()
                '.RegisterType(Of CommissionRepository)().As(Of ICommissionRepository)().InstancePerHttpRequest()
                '.RegisterType(Of ConfigCriteriaRepository)().As(Of IConfigCriteriaRepository)().InstancePerHttpRequest()
                '.RegisterType(Of ConfigGroupRepository)().As(Of IConfigGroupRepository)().InstancePerHttpRequest()
                '.RegisterType(Of ConfigQuestionRepository)().As(Of IConfigQuestionRepository)().InstancePerHttpRequest()
                '.RegisterType(Of ContactRepository)().As(Of IContactRepository)().InstancePerHttpRequest()
                '.RegisterType(Of CustomerProductItemRepository)().As(Of ICustomerProductItemRepository)().InstancePerHttpRequest()
                '.RegisterType(Of CustomerRepository)().As(Of ICustomerRepository)().InstancePerHttpRequest()
                '.RegisterType(Of IOrderItemRepository)().As(Of IOrderItemRepository)().InstancePerHttpRequest()
                '.RegisterType(Of OrderRepository)().As(Of IOrderRepository)().InstancePerHttpRequest()
                '.RegisterType(Of PriceBreakRepository)().As(Of IPriceBreakRepository)().InstancePerHttpRequest()
                '.RegisterType(Of PriceRepository)().As(Of IPriceRepository)().InstancePerHttpRequest()
                '.RegisterType(Of ProductItemRepository)().As(Of IProductItemRepository)().InstancePerHttpRequest()
                '.RegisterType(Of QuoteItemRepository)().As(Of IQuoteItemRepository)().InstancePerHttpRequest()
                '.RegisterType(Of QuoteRepository)().As(Of IQuoteRepository)().InstancePerHttpRequest()
                '.RegisterType(Of ShipmentItemRepository)().As(Of IShipmentItemRepository)().InstancePerHttpRequest()
                '.RegisterType(Of ShipmentRepository)().As(Of IShipmentRepository)().InstancePerHttpRequest()
                '.RegisterType(Of ShoppingCartItemRepository)().As(Of IShoppingCartItemRepository)().InstancePerHttpRequest()
                '.RegisterType(Of ShoppingCartRepository)().As(Of IShoppingCartRepository)().InstancePerHttpRequest()
                '.RegisterType(Of SystemTableItemRepository)().As(Of ISystemTableItemRepository)().InstancePerHttpRequest()
            End With

            Return builder.Build()

        End Function

    End Class

End Namespace 
```

如您所见，Autofac 自动注册功能取代了使用 Unity.Mvc 所需的 40 多行代码（我将这些行留在里面并注释它们以突出显示）！！

享受！！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T20:13:13.813

您是否考虑过使用命名约定？ [http://code.google.com/p/autofac/wiki/Scanning](http://code.google.com/p/autofac/wiki/Scanning)

```
var assemblyToScan = Assembly.GetExecutingAssembly();

builder.RegisterAssemblyTypes(assemblyToScan)
.Where(t => t.Name.EndsWith("Repository"))
.AsImplementedInterfaces();

builder.RegisterAssemblyTypes(assemblyToScan)
.Where(t => t.Name.EndsWith("Service"))
.AsImplementedInterfaces(); 
```

您还可以使用这篇文章[Autofac Scanning Assemblies for certain class type中介绍的基本类型进行注册](https://stackoverflow.com/questions/9159277/autofac-scanning-assemblies-for-certain-class-type)

# vb.net - 线程异常：WaitHandles 的数量必须小于或等于 64

> ID：10905016
> 
> 赞同：2
> 
> 时间：2012-06-05T21:09:24.790
> 
> 标签：vb.net, multithreading, threadpool

标题是为了让其他有此错误的人更容易找到它。我是 Threading 的新手，所以这真的让我见怪不怪。我收到了导致 Cassini 崩溃的运行时错误。这是我维护的代码，最初是在 VS 2003 中作为网站项目开发的，然后转换为 VS 2008 网站项目。

重要信息：

*   在这种情况下，数组中的对象数`manualEvents`为 128。
*   `products`是一个字符串数组
*   需要支持.NET 2.0

```
For Each product As String In products
    If Not product.Trim().ToUpper().EndsWith("OBSOLETE") Then
        calls += 1
    End If
Next
Dim results(calls - 1) As DownloadResults
'Dim manualEvents(calls - 1) As Threading.ManualResetEvent '128 objects in this case.
Dim manualEvents(0) As Threading.ManualResetEvent
manualEvents(0) = New Threading.ManualResetEvent(False)
'NOTE: I don't think this will work because what is not seen here, is that
'    this code is being used to populate and cache a long list of products,
'    each with their own category, etc. Am I misunderstanding something?

'initialize results structures
'spawn background workers
calls = 0
For Each product As String In products
    If Not product.Trim().ToUpper().EndsWith("OBSOLETE") Then
        Dim result As New DownloadResults

        'manualEvents(calls) = New Threading.ManualResetEvent(False)
        'Moved above For Each after declaration of variable

        result.params.product = product
        result.params.category = docType
        'result.ManualEvent = manualEvents(calls)
        result.ManualEvent = manualEvents(0)
        result.Context = Me._context

        results(calls) = result

        Threading.ThreadPool.QueueUserWorkItem(AddressOf ProcessSingleCategoryProduct, results(calls))
        Threading.Interlocked.Increment(calls) 'Replaces below incrementation

        'calls += 1
    End If
Next

Threading.WaitHandle.WaitAll(manualEvents) 'CRASHES HERE 
```

线程辅助函数（为了完成）

```
Public Shared Sub ProcessSingleCategoryProduct(ByVal state As Object)
    Dim drs As DownloadResults = CType(state, DownloadResults)
    Dim adc As New cADCWebService(drs.Context)

    drs.docs = adc.DownloadADC(drs.params.category, drs.params.product)
    drs.ManualEvent.Set()
End Sub 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T21:18:28.330

您不需要包含 128 个手动事件的数组来检查所有 128 个线程是否完成。

仅创建一个手动重置事件和一个从 128 开始的普通整数`Interlocked.Decrement`。在 末尾使用该整数递减`ProcessSingleCategoryProduct`，并且仅在计数达到零时发出事件信号：

```
if (Interlocked.Decrement(ByRef myCounter) = 0) myEvent.Set(); 
```

然后只声明一个`Threading.ManualResetEvent`而不是它们的数组，你可以调用`WaitOne`而不是调用`WaitAll`它，你就完成了。

如果您有 .NET 4，另请参阅 usr 的评论以获得更简单的替代方案。

# javascript - 在javascript中迭代JSON以放入选择选项

> ID：10905018
> 
> 赞同：2
> 
> 时间：2012-06-05T21:09:32.787
> 
> 标签：javascript, html, json, html-select

我一直在迭代一些 JSON 以放入选择选项时遇到问题
（顺便说一句，忽略“标签”的实际值，那些是垃圾 atm）。

这是我的 php 传递给此的示例：

```
[{"value":"1","label":"04-22-12"},{"value":"4","label":"04\/04\/12"}] 
```

我目前正在尝试这个循环：*注意，dateSelect 是在其他地方定义的

```
for (res in JSON.parse(request.responseText)) {
    var date = document.createElement("option");
    date.value = res.value;
    date.text = res.label;
    dateSelect.add(date, null);
} 
```

但是，它在我的选项中添加了“未定义”......我如何得到它，以便正确地将每个值和相应的标签放在那里？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T21:16:58.467

你有一个数组，所以不要`for-in`.

在您的代码中，是a 形式`res`的属性名称*（在这种情况下为 Array 的索引）*`string`，因此您要查找的属性不会在字符串上定义。

像这样做...

```
for (var i = 0, parsed = JSON.parse(request.responseText); i < parsed.length; i++) {
    var res = parsed[i];
    var date = document.createElement("option");
    date.value = res.value;
    date.text = res.label;
    dateSelect.add(date, null);
} 
```

# php - ORDER BY 在 DISTINCT 之前还是之后适用？

> ID：10905026
> 
> 赞同：6
> 
> 时间：2012-06-05T21:10:11.340
> 
> 标签：php, mysql, sql-order-by

在 MySQL 查询中，使用该`DISTINCT`选项时，是否`ORDER BY`在删除重复项后应用？如果没有，有没有办法让它这样做？我认为这会导致我的代码出现一些问题。

**编辑**：
这里有一些关于是什么导致我的问题的更多信息。我明白，乍一看，这个顺序并不重要，因为我正在处理重复的行。但是，情况并非完全如此，因为我使用的`INNER JOIN`是对行进行排序。

假设我有一个论坛线程表，其中包含以下数据：

```
+----+--------+-------------+
| id | userid |    title    |
+----+--------+-------------+
|  1 |      1 | Information |
|  2 |      1 | FAQ         |
|  3 |      2 | Support     |
+----+--------+-------------+ 
```

我在另一个表中也有一组帖子，如下所示：

```
+----+----------+--------+---------+
| id | threadid | userid | content |
+----+----------+--------+---------+
|  1 |        1 |      1 | Lorem   |
|  2 |        1 |      2 | Ipsum   |
|  3 |        2 |      2 | Test    |
|  4 |        3 |      1 | Foo     |
|  5 |        2 |      3 | Bar     |
|  6 |        3 |      5 | Bob     |
|  7 |        1 |      2 | Joe     |
+----+----------+--------+---------+ 
```

我正在使用以下 MySQL 查询来获取所有线程，然后根据最新帖子对它们进行排序（假设具有更高 id 的帖子更新：

```
SELECT t.*
FROM Threads t
INNER JOIN Posts p ON t.id = p.threadid
ORDER BY p.id DESC 
```

这有效，并生成如下内容：

```
+----+--------+-------------+
| id | userid |    title    |
+----+--------+-------------+
|  1 |      1 | Information |
|  3 |      2 | Support     |
|  2 |      1 | FAQ         |
|  3 |      2 | Support     |
|  2 |      1 | FAQ         |
|  1 |      1 | Information |
|  1 |      1 | Information |
+----+--------+-------------+ 
```

但是，如您所见，信息是正确的，但存在重复行。我想删除这样的重复项，所以我`SELECT DISTINCT`改用了。但是，这产生了以下结果：

```
+----+--------+-------------+
| id | userid |    title    |
+----+--------+-------------+
|  3 |      2 | Support     |
|  2 |      1 | FAQ         |
|  1 |      1 | Information |
+----+--------+-------------+ 
```

这显然是错误的，因为“信息”线程应该在顶部。似乎 using`DISTINCT`会导致从上到下删除重复项，因此只剩下最后一行。这会导致排序中的一些问题。

是这种情况，还是我分析错误？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T21:51:22.467

有两点要理解：

1.  一般来说，除非您指定子句，否则结果集是[无序的；](https://stackoverflow.com/a/10418282/623041)`ORDER BY`在您指定[非严格顺序](http://en.wikipedia.org/wiki/Linear_order#Strict_total_order)的范围内（即`ORDER BY`在非唯一列上），在该顺序下相等的记录出现在结果集中的顺序是未定义的。

    `ORDER BY`我怀疑您可能正在指定这样一个非严格的顺序，这是您问题的根源：通过指定一组足以唯一标识您关心其最终位置的记录的列来确保您的顺序是严格的在结果集中。

2.  [`DISTINCT`可以使用`GROUP BY`](http://dev.mysql.com/doc/en/distinct-optimization.html)，这会导致结果按分组列排序；也就是说，`SELECT DISTINCT a, b, c FROM t`将生成一个看起来好像`ORDER BY a, b, c`已应用的结果集。同样，指定足够严格的顺序以满足您的需求将覆盖此效果。

* * *

在您更新之后，请记住我上面的第 2 点，很明显，将结果分组以实现的效果`DISTINCT`使得无法按非分组列排序`p.id`；相反，你想要：

```
SELECT   t.*
FROM     Threads t INNER JOIN Posts p ON t.id = p.threadid
GROUP BY t.id
ORDER BY MAX(p.id) DESC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T21:12:55.113

`DISTINCT`告知 MySQL 如何为您构建行集，`ORDER BY`并提示该行集应该如何呈现。所以答案是：`DISTINCT`第一，`ORDER BY`最后。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T21:28:52.207

`DISTINCT`在大多数情况下，应用和的顺序`ORDER BY`不会影响最终输出。

但是，如果您还使用`GROUP BY`，这**将**影响最终输出。在这种情况下，在`ORDER BY`之后*执行*，`GROUP BY`这将返回意外结果（假设您希望在分组之前执行排序）。

# asp.net-mvc - 不确定参数

> ID：10905028
> 
> 赞同：1
> 
> 时间：2012-06-05T21:10:29.220
> 
> 标签：asp.net-mvc, model-view-controller

我目前正在编写初学者的 MVC 教程。我想知道是否有人可以解释如何或在何处选择此方法的参数？

```
public ActionResult Details(int id)
{
    var album = storeDB.Albums.Find(id);
    return View(album);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T22:40:41.413

有 2 种方式可以填充您的 id 参数：

```
 http://www.example.com/{Controller}/Details/{id} 
```

或者

```
 http://www.example.com/{Controller}/Details?id={id} 
```

其中 {Controller} 是您的控制器的名称，例如。HomeController.cs 的名称将是“Home”，其中 {id} 是一个 int。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T21:59:08.010

我猜你正在使用默认路由，所以你会在 Global.asax 文件中找到以下代码：

```
routes.MapRoute(
                "Default", // Route name
                "{controller}/{action}/{id}", // URL with parameters
                new { controller = "Home", action = "Index", id = UrlParameter.Optional } 
            ); 
```

你的路线就是这样！其中“id”是一个可选参数，假设你的控制器名称是专辑，所以测试`http://mySite/Album/Details/10`

您收到一个请求，其中 10 是您在操作详细信息中指定的 Id 参数

# php - 带有 WSDL 和 ksoap2 的 ANDROID 错误

> ID：10905032
> 
> 赞同：0
> 
> 时间：2012-06-05T21:11:09.577
> 
> 标签：php, android, soap, wsdl, android-ksoap2

我在访问用 PHP 制作的 Web 服务时遇到问题。我尝试了很多代码，但不知道我是否有一个愚蠢的错误让我无法工作。

我认为 Web 服务很好，因为如果我从 PHP 中的页面进行调用，但如果我通过 Android 访问不起作用，那么我在 ANDROID 中进行的调用也是如此。

错误发生在：transporte.call(SOAP_ACTION,envelope,null);

错误是：`org.xmlpull.v1.XmlPullParserException: expected: START_TAG {http://www.w3.org/2003/05/soap-envelope}Envelope (position:START_TAG <definitions name='SMB_GestionBoda' targetNamespace='http://localhost/webservice/SMB_GestionBoda.wdsl'>@8:43 in java.io.InputStreamReader@405d9f50)`

谢谢。

**WSDL：**

```
<definitions 
    name='SMB_GestionBoda'
    targetNamespace='http://localhost/webservice/SMB_GestionBoda.wdsl'
    xmlns:tns='http://localhost/webservice/SMB_GestionBoda.wdsl'
    xmlns:soap='http://schemas.xmlsoap.org/wsdl/soap/'
    xmlns:soap12='http://schemas.xmlsoap.org/wsdl/soap12/'
    xmlns='http://schemas.xmlsoap.org/wsdl/'>   
<message name='GetProvidersRequest'>
    <part name='id_task' type='xsd:int'/>
    <part name='city' type='xsd:string'/>
</message>
<message name='GetProvidersResponse'>
    <part name='result'/>
</message>
<portType name='SMB_GestionBodaPortType'>
    <operation name='GetProviders'>
        <input message='tns:GetProvidersRequest'/>
        <output message='tns:GetProvidersResponse'/>
    </operation>
</portType>
<binding name='SMB_GestionBodaBinding' type='tns:SMB_GestionBodaPortType'>
    <soap:binding style='rpc'
        transport='http://schemas.xmlsoap.org/soap/http'/>
    <operation name='GetProviders'>
        <soap:operation soapAction='urn:localhost-SMB_GestionBoda#GetProviders'/>
        <input>
            <soap:body use='encoded' namespace='urn:localhost-SMB_GestionBoda'
            encodingStyle='http://schemas.xmlsoap.org/soap/encoding/'/>
        </input>
        <output>
            <soap:body use='encoded' namespace='urn:localhost-SMB_GestionBoda'
            encodingStyle='http://schemas.xmlsoap.org/soap/encoding/'/>
        </output>
    </operation>
</binding>
<service name='SMB_GestionBodaService'>
    <port name='SMB_GestionBodaPort' binding='SMB_GestionBodaBinding'>
        <soap:address location='http://localhost/webservice/GetProviders.php'/>
    </port>
</service>
</definitions> 
```

**安卓代码：**

```
//Constantes para la invocacion del web service
        final String NAMESPACE = "http://localhost/webservice/SMB_GestionBoda.wdsl";
        final String URL="http://192.168.0.10/webservice/SMB_GestionBoda.wdsl";
        final String METHOD_NAME = "GetProviders";
        final String SOAP_ACTION = "urn:localhost-SMB_GestionBoda#GetProviders";  

        /*Se crea un objeto SoapObject para poder realizar la peticion
        para consumir el ws SOAP. El constructor recibe
        el namespace. Por lo regular el namespace es el dominio 
        donde se encuentra el web service*/
        request = new SoapObject(NAMESPACE, METHOD_NAME);
        request.addProperty("id_task",0);
        request.addProperty("city","valencia");

        /*Se crea un objeto SoapSerializationEnvelope para serealizar la
        peticion SOAP y permitir viajar el mensaje por la nube
        el constructor recibe la version de SOAP*/
        envelope = new SoapSerializationEnvelope(SoapEnvelope.VER12);
        envelope.dotNet = false; //se asigna true para el caso de que el WS sea de dotNet

        //Se envuelve la peticion soap
        envelope.setOutputSoapObject(request);

        //Objeto que representa el modelo de transporte
        //Recibe la URL del ws
        HttpTransportSE transporte = new HttpTransportSE(URL);
        transporte.debug=true;

        try {   
            System.setProperty("http.keepAlive", "false");
            //Hace la llamada al ws
            transporte.call(SOAP_ACTION, envelope,null);

            //Se crea un objeto SoapPrimitive y se obtiene la respuesta 
            //de la peticion
            resultsRequestSOAP = (SoapPrimitive)envelope.getResponse();
            //result = (SoapObject)envelope.bodyIn;

        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (XmlPullParserException e) {
            // TODO Auto-generated catch block
            Log.d("MI APP","dump : " + transporte.responseDump);
            e.printStackTrace();
        } 
```

**请求转储：**

```
<v:Envelope 
xmlns:i="http://www.w3.org/2001/XMLSchema-instance" 
xmlns:d="http://www.w3.org/2001/XMLSchema" 
xmlns:c="http://www.w3.org/2003/05/soap-encoding" 
xmlns:v="http://www.w3.org/2003/05/soap-envelope">
<v:Header />
<v:Body>
<n0:GetProviders id="o0" c:root="1" xmlns:n0="http://localhost/webservice/SMB_GestionBoda.wdsl">
<id_task i:type="d:int">0</id_task>
<city i:type="d:string">valencia</city>
</n0:GetProviders>
</v:Body>
</v:Envelope> 
```

**响应转储：**

```
 <?xml version="1.0" encoding="utf-8"?>
<definitions 
    name='SMB_GestionBoda'
    targetNamespace='http://localhost/webservice/SMB_GestionBoda.wdsl'
    xmlns:tns='http://localhost/webservice/SMB_GestionBoda.wdsl'
    xmlns:soap='http://schemas.xmlsoap.org/wsdl/soap/'
    xmlns:soap12='http://schemas.xmlsoap.org/wsdl/soap12/'
    xmlns='http://schemas.xmlsoap.org/wsdl/'>

<message name='GetProvidersRequest'>
    <part name='id_task' type='xsd:int'/>
    <part name='city' type='xsd:string'/>
</message>
<message name='GetProvidersResponse'>
    <part name='result'/>
</message>

<portType name='SMB_GestionBodaPortType'>
    <operation name='GetProviders'>
        <input message='tns:GetProvidersRequest'/>
        <output message='tns:GetProvidersResponse'/>
    </operation>
</portType>

<binding name='SMB_GestionBodaBinding' type='tns:SMB_GestionBodaPortType'>
    <soap:binding style='rpc'
        transport='http://schemas.xmlsoap.org/soap/http'/>
    <operation name='GetProviders'>
        <soap:operation soapAction='urn:localhost-SMB_GestionBoda#GetProviders'/>
        <input>
            <soap:body use='encoded' namespace='urn:localhost-SMB_GestionBoda'
            encodingStyle='http://schemas.xmlsoap.org/soap/encoding/'/>
        </input>
        <output>
            <soap:body use='encoded' namespace='urn:localhost-SMB_GestionBoda'
            encodingStyle='http://schemas.xmlsoap.org/soap/encoding/'/>
        </output>
    </operation>
</binding>

<service name='SMB_GestionBodaService'>
    <port name='SMB_GestionBodaPort' binding='SMB_GestionBodaBinding'>
        <soap:address location='http://localhost/webservice/GetProviders.php'/>
    </port>
</service>
</definitions> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T14:46:39.200

将您的 URL 更改为扩展名 .asmx 而不是 .wsdl

# c++ - OpenGL：如何使光独立于旋转？

> ID：10905035
> 
> 赞同：5
> 
> 时间：2012-06-05T21:11:25.403
> 
> 标签：c++, opengl, rotation, shader, lighting

我有一个漫反射照明着色器，当对象不旋转时它似乎可以工作。但是，当我应用旋转变换时，灯光似乎也随着对象旋转。这就像物体和光线保持静止，但相机是围绕物体移动的相机。

这是我的顶点着色器代码：

```
#version 110

uniform mat4 projectionMatrix;
uniform mat4 modelviewMatrix;
uniform vec3 lightSource;

attribute vec3 vertex;
attribute vec3 normal;

varying vec2 texcoord;

void main() {
    gl_Position = projectionMatrix * modelviewMatrix * vec4( vertex, 1.0 );

    vec3 N = gl_NormalMatrix * normalize( normal );
    vec4 V = modelviewMatrix * vec4( vertex, 1.0 );
    vec3 L = normalize( lightSource - V.xyz );

    float NdotL = max( 0.0, dot( N, L ) );

    gl_FrontColor = vec4( gl_Color.xyz * NdotL, 1.0 );

    gl_TexCoord[0] = gl_MultiTexCoord0;
} 
```

这是进行旋转的代码：

```
scene.LoadIdentity();
scene.Translate( 0.0f, -5.0f, -20.0f );
scene.Rotate( angle, 0.0f, 1.0f, 0.0f );
object->Draw(); 
```

我在 object->Draw() 函数中通过 glUniform3f 发送了眼睛空间光的位置。光照位置是静态的，定义为：

```
glm::vec4 lightPos( light.x, light.y, light.z, 1.0 );
glm::vec4 lightEyePos = modelviewMatrix * lightPos;
glUniform3f( uniforms.lightSource, lightEyePos.x, lightEyePos.y, lightEyePos.z ); 
```

这种方法有什么问题？

编辑： glm::lookAt 代码

```
Scene scene;
scene.LoadMatrix( projection );
scene.SetMatrixMode( Scene::Modelview );
scene.LoadIdentity();
scene.SetViewMatrix( glm::lookAt( glm::vec3( 0.0f, 0.0f, 0.0f ), glm::vec3( 0.0f, -5.0f, -20.0f ), glm::vec3( 0.0f, 1.0f, 0.0f ) ) ); 
```

SetViewMatrix 代码：

```
void Scene::SetViewMatrix( const glm::mat4 &matrix ) {
    viewMatrix = matrix;
    TransformMatrix( matrix );
} 
```

然后我只是将我使用的modelviewMatrix更改为viewMatrix：

```
glm::vec4 lightPos( light.x, light.y, light.z, 1.0 );
glm::vec4 lightEyePos = viewMatrix * lightPos;
glUniform3f( uniforms.lightSource, lightEyePos.x, lightEyePos.y, lightEyePos.z ); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T21:27:20.600

> 声明 1：灯的位置是静态的。
> 
> 声明 2：`lightEyePos = modelviewMatrix * lightPos;`

这两种说法是不一致的。如果您的灯光位置应该是静态的，则不应对其应用旋转模型矩阵。

如果您的 lightPos 是在世界坐标中定义的，那么您应该将它与`viewMatrix`not相乘`modelviewMatrix`。modelviewMatrix 包含模型矩阵，其中包含模型的旋转（您不想将其应用于固定光源）。

# multithreading - 退出使用 Swing 的 Jython 应用程序

> ID：10905039
> 
> 赞同：2
> 
> 时间：2012-06-05T21:11:36.707
> 
> 标签：multithreading, jython

我正在使用来自 Jython 的 Swing，我发现 while `System.exit()`(from `java.lang`) or`JFrame.setDefaultCloseOperation(EXIT_ON_CLOSE)`工作正常，调用`sys.exit()`挂起。

`atexit.register`显然，通过等待所有线程退出来注册一个函数，正如 Python 所期望的那样（这实际上与 Java 不同）。

这意味着如果 a`ActionListener`被调用（例如单击 a 时`JButton`），AWT 的 Event Dispatching Thread 将被生成，并且调用`sys.exit()`将永远挂起，等待它退出。

这是一个示例：[https](https://gist.github.com/2877919) ://gist.github.com/2877919 。关闭框架会退出程序，除非先单击该按钮。

退出 Jython 应用程序的最佳方式是什么？使用`EXIT_ON_CLOSE`or`System.exit()`会完全忽略`atexit`...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T23:24:46.230

我认为您不需要为此使用多线程，您只需要确保在您需要之前不会关闭窗口。当您关闭窗口时，您将关闭系统：

```
from javax.swing import JFrame, JButton, JOptionPane
from java.awt.event import ActionListener, WindowAdapter
import sys

class Frame(JFrame, ActionListener):

    def __init__(self):
        self.setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE)
        button = JButton("Hello", actionCommand='button')
        button.addActionListener(self)
        self.getContentPane().add(button)
        self.pack()
        self.setResizable(False)

    def actionPerformed(self, event):
        print event.getActionCommand();

class Adapter(WindowAdapter):
    def windowClosing(self, event):
        if JOptionPane.showConfirmDialog(None, "Wanna exit?","Jython Test", JOptionPane.OK_CANCEL_OPTION) == JOptionPane.OK_OPTION:
            sys.exit(0)

if __name__ == '__main__':
    frame = Frame();
    frame.setVisible(True)
    frame.addWindowListener(Adapter()) 
```

# arrays - 类返回具有可以从主类访问的成员属性的对象数组

> ID：10905040
> 
> 赞同：0
> 
> 时间：2012-06-05T21:11:38.527
> 
> 标签：arrays, object, return

我是 Java 新手，所以概念和术语很模糊，但我正在尝试！我需要创建一个类，该类将获取字符串中的数据，对其进行解析并返回一个具有可以从主类访问的成员属性的对象（数组）。我读过这比拥有多个索引数组（如`pointx[]`, `pointy[]`,`pointz[]`等）更好的解决方案，尤其是在您需要执行交换或排序等操作时。

所以，我想用 , 等从 main 访问数组对象的成员`test[0].x`。`test[100].y`但是，我很沮丧地得到了一个`Exception in thread "main" java.lang.NullPointerException`，我不明白如何继续。

这是我从 main 调用 parse 的方式：

```
parse a = new parse();

parse[] test = a.convert("1 2 3 4 1 2 3 4 1 2 3 4"); // <- ** error here **

System.out.printf("%.2f %.2f %.2f %d\n", test[0].x, test[0].y, test[0].z, test[0].r); 
```

这是解析类：

```
public class parse {

    parse[] point = new parse[1000];
    public float x;
    public float y;
    public float z;
    public int r;

    parse() {

    }

    public parse[] convert(String vertices) {

        // parse string vertices -> object

        point[0].x = 10; // <- ** error here **
        point[0].y = 100;
        point[0].z = 50;
        point[0].r = 5;

        return point;
    }
} 
```

提前感谢您对我的解析类和任何相关的 java 指针的任何帮助，以继续我的学习 java 和享受编程！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T20:47:30.227

当你创建一个`parse`对象数组时，数组本身是空的，实际上不包含任何对象，只有空引用。您还需要自己创建对象并将它们存储在数组中。

此外，当它应该是方法的局部变量时，您`point`是类的成员，它本身应该是，因为它不依赖于特定实例。`parse``convert``static`

然后，您将按如下方式调用转换：

```
parse[] test = parse.convert("this string not used yet");

System.out.printf("%.2f %.2f %.2f %d\n", test[0].x, test[0].y, test[0].z, test[0].r); 
```

这是解析类：

```
public class parse {

    public float x;
    public float y;
    public float z;
    public int r;

    parse() {

    }

    public static parse[] convert(String vertices) {

        // parse string vertices -> object

        parse[] point = new parse[1000];
        point[0] = new parse();
        point[0].x = 10;
        point[0].y = 100;
        point[0].z = 50;
        point[0].r = 5;

        return point;
    }
} 
```

# forms - MS-Access，表格查看一个条目从一对多的关系

> ID：10905041
> 
> 赞同：0
> 
> 时间：2012-06-05T21:11:38.907
> 
> 标签：forms, ms-access, one-to-many

我有一个带有订单的表和一个带有 itemId 的子表（一对多关系）

在表单中，我有一个组合框来选择特定的订单，还有另一个组合框来选择特定的 itemId。

为此，我进行了查询以查看第二个组合框中的所有可用 itemId。

我不知道如何在表单中查看选定的 itemId-data。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T21:21:10.793

您可以使用 Openform 操作的 Where 参数来指定项目。

```
OpenForm FormName, , , "ItemID=" & ComboName 
```

-- [http://msdn.microsoft.com/en-us/library/aa141520(v=office.10).aspx](http://msdn.microsoft.com/en-us/library/aa141520(v=office.10).aspx)

这假定组合的绑定列是与要打开的表单中的 ID 相关的数字 ID。

# c# - C# Marshal byte[] 到带有“ref object”签名的 COM SAFEARRAY 参数

> ID：10905043
> 
> 赞同：2
> 
> 时间：2012-06-05T21:11:47.697
> 
> 标签：c#, marshalling, com-interop, safearray

我一直在谷歌上转来转去，我可以找到各种讨论，很多建议，但似乎没有任何效果。我有一个 ActiveX 组件，它将图像作为字节数组。当我进行 TLB 导入时，它带有以下签名：

```
int HandleImage([MarshalAs(UnmanagedType.Struct)] ref object Bitmap); 
```

我如何将 byte[] 传递给它？

还有另一个函数可以返回具有类似签名的数据，它之所以有效，是因为我可以传入“null”。返回的类型是字节[1..size]（非零有界字节[]）。但即使我尝试传入返回的内容，它仍然会出现类型不匹配异常。

* * *

更多细节：

我一直在编辑 IDispatch 接口签名中的方法（使用 ILSpy 从自动生成的互操作程序集中提取接口）。我几乎尝试了以下每种组合，它总是得到类型不匹配异常：

1.  添加和删​​除“参考”
2.  将参数数据类型更改为“byte[]”或“Array”
3.  编组为 [MarshalAs(UnmanagedType.SafeArray, SafeArraySubType = VarEnum.VT_UI1)]。在玩了一段时间 MarshalAs 之后，我开始确信 IDispatch 不使用这些属性。

还尝试按原样使用“ref object”接口，并传递不同的类型：byte[], Array.CreateInstance(typeof(byte) （我认为它们是相同的，但我发现有人建议它，所以它不能伤害尝试）。

下面是一个 Delphi 代码示例，它创建了一个适当的数组来传递：

```
var
   image: OLEVariant;
   buf: Pointer;

image := VarArrayCreate([0, Stream.Size], VarByte);
Buf  := VarArrayLock(image);
Stream.ReadBuffer(Buf^, Stream.Size);
VarArrayUnlock(image); 
```

这是执行相同操作的 C 代码。我想如果我不能让它在 C# 中工作，我可以通过托管 C++ 调用它，尽管我宁愿将所有东西都放在一个项目中：

```
long HandleImage(unsigned char* Bitmap, int Length)
{
    VARIANT vBitmap;
    VariantInit (&vBitmap);
    VariantClear(&vBitmap);

    SAFEARRAYBOUND bounds[1];
    bounds[0].cElements = Length;
    bounds[0].lLbound = 1;

    SAFEARRAY* arr = SafeArrayCreate(VT_UI1, 1, bounds);
    SafeArrayLock(arr);
    memcpy(arr->pvData, Bitmap, Length);
    SafeArrayUnlock(arr);
    vBitmap.parray = arr;
    vBitmap.vt = VT_ARRAY | VT_UI1;

    long result;
    static BYTE parms[] = VTS_PVARIANT;
    InvokeHelper(0x5e, DISPATCH_METHOD, VT_I4, (void*)&result, parms,
        &vBitmap);

    SafeArrayDestroy(arr);
    VariantClear(&vBitmap);

    return result;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-22T22:59:56.467

我终于想出了如何用 100% C# 代码做到这一点。显然，微软从未考虑过有人可能会使用带有此签名的方法来传递数据，因为它正确地编组到另一个方向（它正确地以字节 [] 的形式返回）。

此外，ICustomMarshaler 不会在 IDispatch 调用中被调用，它永远不会命中自定义封送处理程序中的断点（获取它的实例的静态方法除外）。

Hans Passant 在这个问题中的回答让我走上了正轨： [Calling a member of IDispatch COM interface from C#](https://stackoverflow.com/questions/8068449/calling-a-member-of-idispatch-com-interface-from-c-sharp)

那里的 IDispatch 副本不包含 IUnknown 上的“Invoke”方法，但可以使用 System.Runtime.InteropServices.ComTypes 中的类型酌情将其添加到接口：http: [//msdn.microsoft.com/en -us/library/windows/desktop/ms221479%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms221479%28v=vs.85%29.aspx)

这意味着您可以 100% 控制编组参数。Microsoft 没有公开 VARIANT 结构的实现，因此您必须定义自己的：http: [//limbioliong.wordpress.com/2011/09/19/defining-a-variant-structure-in-managed-code-第2部分/](http://limbioliong.wordpress.com/2011/09/19/defining-a-variant-structure-in-managed-code-part-2/)

Invoke 的输入参数是一个变体数组，因此您必须将它们编组到一个非托管数组，并且有一个变体输出参数。

那么现在我们有了一个变体，它应该包含什么？这就是自动编组失败的地方。它需要一个指向另一个变体的指针，而不是直接嵌入指向 SAFEARRAY 的指针，并且该变体应该指向 SAFEARRAY。

您可以通过 P/Invoking 这些方法构建 SAFEARRAY：http: [//msdn.microsoft.com/en-us/library/windows/desktop/ms221145%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms221145%28v=vs.85%29.aspx)

所以主要变体应该是 VT_VARIANT | VT_BYREF，它应该指向另一个变种 VT_UI8 | VT_ARRAY，它应该指向通过 SafeArrayCreate() 生成的 SAFEARRAY。然后应该将最外层的变体复制到内存块中，并将其 IntPtr 发送到 Invoke 方法。

# sql-server - SSIS 传输数据库任务神秘错误消息 0x80131500

> ID：10905044
> 
> 赞同：8
> 
> 时间：2012-06-05T21:11:57.267
> 
> 标签：sql-server, sql-server-2005, ssis, dts, sql-server-data-tools

我将 SSIS 与 VS2010（shell）和从 SQL Server 2005（32 位）到 SQL Server 2012（64 位）的数据库一起使用。我直接在目标服务器上开发（不是最佳的，但它可以工作）。

当我尝试使用传输数据库任务时，它给了我如下错误消息：“错误：任务上的 Execute 方法返回错误代码 0x80131500（传输数据时发生错误。有关详细信息，请参阅内部异常。） Execute 方法必须成功，并使用“out”参数指示结果。” ![错误信息](../Images/c09648328497696bcae844cb47077f6d.png)

这是问题......我如何查看“内部异常”？它是一个 GUI 界面，无法单步执行代码！我什至尝试[设置日志记录](https://stackoverflow.com/questions/5772667/how-to-create-an-error-log-or-custom-error-log-within-an-ssis-package/6155087#6155087)- 它只记录相同的无用错误消息。

Microsoft 在他们的参考文档（我可以找到）中没有关于此错误代码的信息。

在谷歌搜索错误代码后，我看到其他人有这个错误代码以及与用户、角色和创建它们有关的消息。

*   我仔细检查了我在两台服务器上都有系统管理员权限，并在两台服务器
    上都登录了。
*   我尝试了从每台服务器到自身的相同传输数据库任务（更改数据库名称），并且*它们*自己都工作得很好。
*   我尝试了 DatabaseOnline 和 DatabaseOffline 选项。（双向相同的错误）
*   在执行传输数据库任务之前，我尝试执行“传输登录”任务，该任务有效，但不是传输数据库任务。然后它开始抛出错误，说数据库不存在 - 这意味着我需要在传输数据库后传输登录信息。

这是我的设置：![在此处输入图像描述](../Images/fc261f5a45d273ce664052cb6c02d649.png)

我究竟做错了什么？**或者**我怎样才能得到“内部异常”消息？

另外，请在此处关注我在微软论坛上的帖子：http: [//social.technet.microsoft.com/Forums/en-US/sqlintegrationservices/thread/cda53c80-8da6-4ed1-898a-9f3ff8464ae2](http://social.technet.microsoft.com/Forums/en-US/sqlintegrationservices/thread/cda53c80-8da6-4ed1-898a-9f3ff8464ae2)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-07T19:51:01.847

这个答案让我感到恶心......我希望我能帮别人省去这个麻烦。问题是这样的：

1.  首先也是最重要的：错误消息的描述性不够。错误应该交给接口。
2.  在“传输数据库”任务的“编辑”下，目标文件路径将使用源数据库的文件路径“自动填充”。粗略的一瞥（以及第二次和第三次……）他们看起来很正确。经过进一步检查**，文件路径是错误的**。如果您从一个版本到另一个版本，这是有道理的 - 文件夹的命名根据版本（`MSSQL.1`vs. `MSSQL11.<instanceName>`）有细微的差异。

综上所述，错误是由于路径设置错误导致文件夹不存在造成的。我想像这样的其他低级异常也会被具有相同神秘错误消息的接口吃掉。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-09-26T14:55:52.100

这很旧，但我在 SSMS 17.2 中遇到了同样的神秘消息。我尝试并检查了上述所有建议均无济于事。在我的情况下，问题与 Visual Studio 2017 中 SSIS 项目的 TargetServerVersion 属性有关。默认情况下，这设置为 SQL Server 2017，而我的本地服务器是 SQL Server 2014 - 一旦更改为相同版本，一切都很顺利。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-10T21:16:24.297

我们遇到了这个问题，有人告诉我们一个有效的日期将始终存在于 MySQL 数据库的列中，我们后来发现有日期`'0000-00-00 00:00:00'`和`'0001-01-01 00:00:00'`.

我们在查询中处理了它，该查询使用 case 语句将错误日期转换为 SSIS 可以使用的日期：

```
CASE WHEN Product.PurchaseDate < '1900-01-01 00:00:00' THEN '1900-01-01 00:00:00' ELSE Product.PurchaseDate END AS PurchaseDate 
```

当然，您也可以将其设置为`null`您的选择。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-01-25T15:55:43.463

我也遇到了同样的问题，结果证明是访问问题。尝试将这些访问权限授予 mdf 和 ldf 文件将登陆的文件夹：NT Service\MSSQLSERVER、Owner Creator、System

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-06T09:53:10.887

> “这意味着我需要在传输数据库后传输登录信息。”

并非如此，登录是在服务器（实例）级别上，因此您可以传输登录名，然后传输数据库。当然，您以后需要担心用户

这里有一点，我认为 SSIS 不会准备转移 2005 -> 2012。我的意思是，“跳过”一个版本是没​​有意义的。你说你使用的是 VS 2012，所以它是 SSIS 2012。它认为它只能读取 2008 数据库。您在同一台服务器上测试并且它工作的事实也使这一点更加强大。

# objective-c - 如何强制 NSWindow 出现在每个应用程序的前面？甚至全屏应用程序

> ID：10905045
> 
> 赞同：5
> 
> 时间：2012-06-05T21:11:57.573
> 
> 标签：objective-c, xcode, macos, cocoa, nswindow

我有一个`NSWindow`我想把它放在一切前面（计算机的每个应用程序、全屏应用程序等）。即使我点击后台应用程序，`NSWindow`也无法进入后台。并且`NSWindow`必须跟随用户屏幕，例如，如果用户将桌面切换到桌面2，等等......我该怎么做？
谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-06T00:34:09.013

如果您不需要在其他应用程序的全屏窗口中可见，那并不太难。

首先，要领先于其他一切，只需 setLevel: 使用 NSFloatingWindowLevel 或更高。尝试不同的值，看看哪个值适合您的需要。

接下来，即使用户更改了 Spaces（可能包括 Exposé/Mission Control），也要保持领先，使用适当的标志对 setCollectionBehavior:，或者如果您要在笔尖。可以加入所有空间或移动到活动空间将确保您在每个空间中保持可见，但方式略有不同。您可能希望将 Exposé 设置为固定，或者也可能是瞬态。再次，尝试两种方式，看看。

但是，当用户切换到全屏空间或仪表板或启动板时，Lion 将隐藏所有空间和移动到活动空间窗口。如果你看的话，你会发现它对这三种情况的每一种都以不同的方式做到这一点。雪豹做事有点不同，山狮也是。

如果你想解决最后一个问题，你需要一点黑客技术——以及针对每种情况和每个操作系统版本的不同形式的黑客技术。基本技巧是捕捉与隐藏相关的通知并在适当的时候取消隐藏自己。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-02-11T07:47:25.343

您应该修改 info.plist 并将 Application is Agent 标志设置为 YES。代理的窗口可以显示在全屏窗口的前面。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-09-24T12:40:29.690

在 info.plist 中将“Application is agent (UIElement)”都设置为“YES”

& 窗位：

```
self.view.window?.level = NSWindow.Level(rawValue: kCGMainMenuWindowLevel.hashValue - 1)
self.view.window?.collectionBehavior = [.stationary, .canJoinAllSpaces, .fullScreenAuxiliary] 
```

帮助过我。

# .htaccess - .htaccess 重定向替换并使用搜索签名

> ID：10905048
> 
> 赞同：0
> 
> 时间：2012-06-05T21:12:03.453
> 
> 标签：.htaccess, redirect, replace

```
RedirectMatch 301 /out/link http://www.link.com/?getparam1=something&getparam2=somethingelse&getparam3=more 
```

当您单击 mysite.com/out/link 时，它会转到：

```
http://www.link.com/?getparam1=something/out/linkgetparam2=somethingelse/out/linkgetparam3=more 
```

基本上它用 /out/link 部分替换了 http 'get' 参数的 & 符号

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T21:20:28.940

可能尝试使用 B 标志

> 在应用转换之前转义非字母数字字符。

所以你会有 RedirectMatch 301 /out/link [http://www.link.com/?getparam1=something&getparam2=somethingelse&getparam3=more](http://www.link.com/?getparam1=something&getparam2=somethingelse&getparam3=more) [B]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-27T19:49:11.570

以防万一您绝对想避免转义所有＆符号`&`：如果您编写 a`RewriteRule`而不是`RedirectMatch`指令，则查询中的＆符号将不会被整个匹配项（$ 0）替换。

因此，接下来的两行对用户来说是相同的：（注意第二行有一个未转义的`&`）

```
RedirectMatch ^/product-id/(.*) http://www.example.com/?foo=bar\&product_id=$1 
RewriteRule   ^/product-id/(.*) http://www.example.com/?foo=bar&product_id=$1 [R=301] 
```

如果您希望用户可以看到右侧的 URI，请按照指示使用 [R] 标志。如果您省略该标志，则将向用户显示左侧的 URI（通常是更复杂的 URI，因此您可能不需要该标志）。

它将以相同的方式运行，但性能可能会降低（google RedirectMatch vs. RewriteRule）以获得更多性能。请记住，所有这些正则表达式规则都会针对您网络服务器上的每个请求进行评估。

# android - 在 ActionBarSherlock 中按下刷新按钮时如何显示不确定的进度条？

> ID：10905053
> 
> 赞同：12
> 
> 时间：2012-06-05T21:12:24.337
> 
> 标签：android, actionbarsherlock

如何`Indeterminate ProgressBar`在`Refresh`按下`ActionBarSherlock`按钮时显示并在刷新 ViewGroup 时再次显示刷新按钮？

**更新 1：** 我在这里有一个不完整的答案。我正在悬赏问题，以便更多的开发人员可以帮助建立一个很好的答案，这对未来的其他人有用。

我们如何显示`Indeterminate ProgressBar`如下图所示的![在此处输入图像描述](../Images/ec49f0dfe5a28c10c99a2040ae78ee8e.png)

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-06-06T06:43:19.010

似乎 ActionBarSherlock 没有提供为刷新 MenuItem 设置动画的特定方法。

您可以做的（通过使用经典的 android API）是使用该`setActionView(int resId)`方法并提供带有 ProgressBar 的布局的 id。

在您的刷新操作开始时，只需调用：

```
item.setActionView(R.layout.refresh_menuitem); 
```

当您的刷新操作完成时调用：

```
item.setActionView(null); 
```

这是您的布局文件**refresh_menuitem.xml**可以具有的示例：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
              android:layout_width="wrap_content"
              android:layout_height="wrap_content"
              android:addStatesFromChildren="true"
              android:focusable="true"
              android:paddingLeft="4dp"
              android:paddingRight="4dp"
              android:gravity="center"
              style="?attr/actionButtonStyle">
    <ProgressBar
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:focusable="true"
            style="@android:style/Widget.ProgressBar.Small"/>
</LinearLayout> 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-08T14:19:49.947

这是您如何使用对象添加这种不确定 ProgressBar 的方法`ActionBarSherlock`：（实际上，另一个更容易，但 progressBar 单独显示，而不是在 a 上方`MenuItem`）

1 - 将此行放在 setContentView() 调用之前的 onCreate() 方法中：

```
requestWindowFeature(Window.FEATURE_INDETERMINATE_PROGRESS); 
```

-> 此行指定您将使用不确定的 ProgressBar 函数。

2 - 通过调用启用不确定的 ProgressBar：

```
setSupportProgressBarIndeterminateVisibility(true); 
```

3 - 通过调用禁用不确定的 ProgressBar：

```
setSupportProgressBarIndeterminateVisibility(false); 
```

备注：查看 ActionBarSherlock 文件夹的示例文件夹。我在以下文件中找到了此代码： **JakeWharton-ActionBarSherlock-9598f2b\samples\demos\src\com\actionbarsherlock\sample\demos\IndeterminateProgress.java**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-06-11T17:57:08.877

这是一个完整的代码：

```
private static final int menuItemIdRefresh = 10; //class constant
private boolean refresh;

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    MenuItem refreshItem = menu.add(0, menuItemIdRefresh, 0,
            getString(R.string.action_refresh)).setShowAsActionFlags(
            MenuItem.SHOW_AS_ACTION_ALWAYS);

    if (isRefreshing) {
        refreshItem.setActionView(R.layout.indeterminate_progress);
    } else {
        refreshItem.setActionView(null);
        refreshItem.setIcon(R.drawable.ic_refresh);
    }

    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
    case menuItemIdRefresh: {
            //the user has pressed the refresh button
        if (!isRefreshing) {
            isRefreshing = true;
            new RefreshMyViewAsyncTask().execute("");
        }
    }
        break;

    default:
        break;
    }

    return false;
} 
```

最后一点，为了使上述代码正常工作，您还需要调用 supportInvalidateOptionsMenu()。您可以将其添加到 RefreshMyViewAsyncTask 的 onPreExecute() 方法。

希望这对某人有所帮助。

# objective-c - 块和异步回调，dealloc 对象 - 需要 nil 块

> ID：10905060
> 
> 赞同：3
> 
> 时间：2012-06-05T21:13:05.543
> 
> 标签：objective-c, asynchronous, dealloc, block, nszombie

这里有一个类似的问题，它没有准确解释我想要什么：[Objective C Blocks as Async-callbacks & BAD ACCESS](https://stackoverflow.com/questions/6885514/objective-c-blocks-as-async-callbacks-bad-access)

我有一个视图控制器，它使用异步回调调用服务。回调是使用一个块完成的，该块引用视图控制器上的变量来填充它们。

它看起来像这样：

```
- (void) loadData {
    __block MyViewController *me = self;
    [self.service executeWithCompletion:^(NSArray *result, NSError *error) {
        if (!error) {
            me.data = result;  
        }
    }];
} 
```

但是，如果我解除了视图控制器的分配，则回调会严重访问“我”。

使“我”为空的最简单方法是什么？如果我把它作为一个 iVar，它会带回循环引用......我想？

我想我错过了一些明显的东西......

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T21:16:54.433

您的目标是 iOS 5.0 或更高版本（或 Mac OS X 10.7 或更高版本）吗？如果是这样，您可以使用 ARC 和一个`__weak`变量（而不是`__block`一个）。当引用的对象被释放时，这将自动归零。你的代码看起来像

```
- (void)loadData {
    __weak MyViewController *me = self;
    [self.service executeWithCompletion:^(NSArray *result, NSError *error) {
        if (!error) {
            MyViewController *strongMe = me; // load __weak var into strong
            if (strongMe) {
                strongMe.data = result;
            }
        }
    }];
} 
```

如果您需要对旧操作系统的支持，那么您需要找到不同的解决方案。一种解决方案是继续并让块保持`self`。如果保证服务执行完成块（然后释放它），这只会产生一个临时循环，当完成块运行时会自动中断。或者，如果您有某种方式来取消服务（以保证在取消后无法调用块的方式），您可以坚持使用`__block`并确保在您的`-dealloc`. 还有其他选择，但它们更复杂。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T10:14:22.867

我根据建议做了上述事情的组合。包括消除积木。虽然，我的对象仍然没有立即释放。即我会在MyViewController 的dealloc 上放置一个断点，如果没有__block 变量，它将在更晚的时间点（可能由于异步连接）被调用，有时根本不会调用。

代码相当复杂 - 所以我想还有其他事情让它无法按照上面的建议工作。

我还使用了 Mike Ash 的 MAZeroingWeakRef，我想这与使用 __weak 相同 - @KevinBallard 建议。

下面是我如何实现它，它似乎正在工作。在处理我想要的视图控制器时立即调用 Dealloc。而且我不能让它崩溃......并且通过我输入的日志评论，我已经可以看到我正在躲避子弹。

```
- (void) loadData {
    __block MAZeroingWeakRef *zeroWeakRef = [[MAZeroingWeakRef alloc] initWithTarget:self];
    [zeroWeakRef setCleanupBlock: ^(id target) {
        [zeroWeakRef autorelease];
    }];
    [self.service executeWithCompletion:^(NSArray *result, NSError *error) {
        MyViewController *me = [zeroWeakRef target];
        if (!me) {
            DULog(@"dodged a bullet");
        }
        if (!error) {
            me.data = result;  
        }
    }];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T08:22:57.030

您是否正在尝试避免真正的保留周期问题？有没有一个理由不`self`应该简单地保留到`-executeWithCompletion:`完成？有没有真正的机会不会完成？

只要它真的最终会完成（即使失败）并且只要它在调用它之后释放块（可能通过将属性设置为`nil`），那么保留周期最终会被打破并且一切都会好起来的。

# google-chrome-extension - Chrome 内联安装只有一半的时间有效

> ID：10905061
> 
> 赞同：0
> 
> 时间：2012-06-05T21:13:16.673
> 
> 标签：google-chrome-extension, failed-installation, chrome-web-store

我们为我们的应用程序设置了一个简单的内联[网络商店安装](http://www.capturetocloud.com/testsupport.html)程序。

该应用程序站点已通过验证。内联安装对我们公司内部的一半人来说确实可以正常工作，但对另一半人却不起作用。他们会得到“Uncaught TypeError: Cannot call method 'install' of undefined testsupport.html:15 Uncaught SyntaxError: Unexpected token )。就好像 chrome 或 chrome.web 变量没有初始化一样。

为什么内联安装只在某些机器上有效，而在其他机器上无效？所有这些机器都有相同的 chrome 浏览器版本。

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T03:58:41.367

您的内联安装标记是：

```
<a href="#" onclick="chrome.webstore.install()">
  CaptureToCloud Chrome Extension Installation
</a> 
```

（根据其中一条评论，它以前使用`javascript:void(0)`过，在这种情况下相当于`#`）。

您的`<a>`标签既可以导航页面，也有一个`onclick`处理程序。在某些情况下，导航发生在`onclick`处理程序完成运行之前，这会干扰支持内联安装的代码。

如果您切换到使用普通`<span>`样式（如果您愿意，可以使用类似样式的样式），那么您应该不再有这个问题：

```
<span onclick="chrome.webstore.install()" style="text-decoration: underline; color:blue">
  CaptureToCloud Chrome Extension Installation
</span> 
```

或者，您可以`return false`从您的`onclick`处理程序中阻止导航：

```
<a href="#" onclick="chrome.webstore.install(); return false;">
  CaptureToCloud Chrome Extension Installation
</a> 
```

（尽管由于您实际上并没有链接到任何地方，因此使用`<a>`标签没有多大意义）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T08:50:53.737

我以前没有见过这个问题，但我会尝试提供我用来管理[我网站](http://neocotic.com)上多个 Chrome 扩展的[内联安装](https://developers.google.com/chrome/web-store/docs/inline_installation)的设置的细分。

在`head`每个页面的节点中（可选地，只有可能包含一个或多个安装链接的页面），我将所需的链接添加到 Chrome 网上应用店上的每个扩展程序/应用程序页面。这使我可以轻松地在页面上的任何位置为各种扩展程序/应用程序添加安装链接。一旦 DOM 完成加载，JavaScript 只需将事件处理程序绑定到每个安装链接。此事件处理程序的唯一目的是安装单击时链接到的扩展程序/应用程序，然后更改其状态以防止进一步的安装尝试。

```
<!DOCTYPE html>
<html>
  <head>
    ...
    <!-- Link for each extension/app page -->
    <link rel="chrome-webstore-item" href="https://chrome.google.com/webstore/detail/dcjnfaoifoefmnbhhlbppaebgnccfddf">
    <script>
      // Ensure that the DOM has fully loaded
      document.addEventListener('DOMContentLoaded', function() {
        // Support other browsers
        var chrome = window.chrome || {};
        if (chrome.app && chrome.webstore) {
          // Fetch all install links
          var links = document.querySelectorAll('.js-chrome-install');
          // Create "click" event listener
          var onClick = function(e) {
            var that = this;
            // Attempt to install the extension/app
            chrome.webstore.install(that.href, function() {
              // Change the state of the button
              that.innerHTML = 'Installed';
              that.classList.remove('js-chrome-install');
              // Prevent any further clicks from attempting an install
              that.removeEventListener('click', onClick);
            });
            // Prevent the opening of the Web Store page
            e.preventDefault();
          };
          // Bind "click" event listener to links
          for (var i = 0; i < links.length; i++) {
            links[i].addEventListener('click', onClick);
          }
        }
      });
    </script>
    ...
  </head>
  <body>
    ...
    <!-- Allow inline installation links to be easily identified -->
    <a href="https://chrome.google.com/webstore/detail/dcjnfaoifoefmnbhhlbppaebgnccfddf" class="js-chrome-install">Install</a>
    ...
  </body>
</html> 
```

为了使该系统充分发挥作用，您还需要支持用户在安装您的扩展程序/应用程序后返回您的网站的情况。尽管官方文档建议`chrome.app.isInstalled`在可以从单个页面安装多个扩展程序/应用程序时使用它不起作用。要解决此问题，您只需将内容脚本添加到您的扩展程序/应用程序，如以下 install.js 文件；

```
// Fetch all install links for this extension/app running
var links = document.querySelectorAll('.js-chrome-install[href$=dcjnfaoifoefmnbhhlbppaebgnccfddf]');
// Change the state of all links
for (var i = 0; i < links.length; i++) {
  links[i].innerHTML = 'Installed';
  // Website script will no longer bind "click" event listener as this will be executed first
  links[i].classList.remove('js-chrome-install');
} 
```

然后您只需要修改您的 manifest.json 文件以确保此内容脚本在您的域上执行。

```
{
  ...
  "content_scripts": [
    {
      "js": ["install.js"],
      "matches": ["*://*.yourdomain.com/*"],
      "run_at": "document_end"
    }
  ]
  ...
} 
```

这将导致内容脚本在您网站上的 JavaScript 之前运行，因此在`js-chrome-install`执行该类时将没有安装链接，因此不会绑定任何事件处理程序等。

以下是我如何使用该系统的示例；

**主页： http:** [//neocotic.com](http://neocotic.com)

**项目主页： http:** [//neocotic.com/template](http://neocotic.com/template)

**项目源码：** [https ://github.com/neocotic/template](https://github.com/neocotic/template)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T06:38:23.930

我收到您提到的错误和一个允许我安装扩展程序的弹出窗口。所以可能每个人都会收到错误，但对于某些人来说，它会阻止安装。

`javascript:void()`我通过替换`#`in摆脱了错误`href`。

```
<a href="#" onclick="chrome.webstore.install()">CaptureToCloud Chrome Extension Installation</a> 
```

# linux - 如何在 Linux 中获得 /dev/one 的等价物

> ID：10905062
> 
> 赞同：23
> 
> 时间：2012-06-05T21:13:26.353
> 
> 标签：linux, file, bash

您可以使用

```
dd if=/dev/zero of=file count=1024 bs=1024 
```

将文件归零。

而不是我想填写一个文件。我怎么做？

没有 /dev/one 文件，那么如何通过 bash shell 模拟这种效果？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-08-30T14:09:47.113

```
tr '\0' '\377' < /dev/zero | dd bs=64K of=/dev/sdx 
```

这应该快得多。选择您需要的块大小（或添加计数）。以 99M 的块大小将它们写入 SSD 磁盘直到满，给了我 350M/s 的写入性能。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-06-05T21:17:50.890

试试这个：

```
dd if=<(yes $'\01' | tr -d "\n") of=file count=1024 bs=1024 
```

替换`$'\377'`，或者`$'\xFF'`如果您希望所有位都为 1。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-05T21:16:49.850

好吧，你可以这样做：

```
dd if=/dev/zero count=1024 bs=1024 |
  tr '\000' '\001' > file 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-10-15T20:54:14.550

```
pv /dev/zero |tr \\000 \\377 >targetfile 
```

...其中`\377`是`255`（所有位都设置为 1 的字节）的八进制表示。为什么`tr`只适用于八进制数，我不知道——但请注意不要下意识地将其翻译为**3FF**。

* * *

使用的语法`tr`很容易出错。我建议验证它是否正在进行所需的翻译...

```
cat /dev/zero |tr \\000 \\377 |hexdump -C 
```

注意：[`pv`](https://linux.die.net/man/1/pv)是一个很好的实用程序，可以替换`cat`并添加进度/速率显示。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-10-12T23:36:49.480

我在我的[github](https://github.com/tinmarino/dev_one)创建了一个设备驱动程序。安装它会创建一个`/dev/one`只写入设置为 1 的位的文件。

名为 one.c 的 c 文件（唯一有趣的部分在 中`device_file_read`）：

```
// File Driver to create a devince /dev/one like the /dev/zero

#include <linux/init.h>
#include <linux/module.h>
#include <linux/fs.h>
#include <linux/uaccess.h>

MODULE_LICENSE("GPL");

static int device_file_major_number = 0;
static const char device_name[] = "one";

static ssize_t device_file_read(
        struct file *file_ptr,
        char __user *user_buffer,
        size_t count,
        loff_t *position) {
    printk( KERN_NOTICE "One: Device file is read at offset = %i, read bytes count = %u\n" , (int)*position , (unsigned int)count );

    // Allocate Kernel buffer
    char* ptr = (char*) vmalloc(count);

    // Fill it with one, byte per byte
    // -- Note that byte is the smallest accesible data unit
    memset(ptr, 0xFF, count);

    char res = copy_to_user(user_buffer, ptr, count);
    if (res != 0){ return -EFAULT; }

    // Return number of byte read
    return count;
}

static struct file_operations simple_driver_fops = {
    .owner   = THIS_MODULE,
    .read    = device_file_read,
};

int register_device(void) {
    int res = 0;
    printk( KERN_NOTICE "One: register_device() is called.\n" );
    res = register_chrdev( 0, device_name, &simple_driver_fops );
    if( res < 0 ) {
        printk( KERN_WARNING "One:  can\'t register character device with error code = %i\n", res );
        return res;
    }
    device_file_major_number = res;
    printk( KERN_NOTICE "One: registered character device with major number = %i and minor numbers 0...255\n", device_file_major_number );
    return 0;
}

void unregister_device(void) {
    printk( KERN_NOTICE "One: unregister_device() is called\n" );
    if(device_file_major_number != 0) {
        unregister_chrdev(device_file_major_number, device_name);
    }
}

static int my_init(void) {
    register_device();
    return 0;
}

static void my_exit(void) {
    unregister_device();
    return;
}

// Declare register and unregister command
module_init(my_init);
module_exit(my_exit); 
```

生成文件

```
TARGET_MODULE:=one

BUILDSYSTEM_DIR:=/lib/modules/$(shell uname -r)/build
PWD:=$(shell pwd)
obj-m := $(TARGET_MODULE).o
# See: https://stackoverflow.com/questions/15910064/how-to-compile-a-linux-kernel-module-using-std-gnu99
ccflags-y := -std=gnu99 -Wno-declaration-after-statement

build:
    # run kernel build system to make module
    $(MAKE) -C $(BUILDSYSTEM_DIR) M=$(PWD) modules

clean:
    # run kernel build system to cleanup in current directory
    $(MAKE) -C $(BUILDSYSTEM_DIR) M=$(PWD) clean
    rm -f MOK.priv MOK*.der

key:
    echo "Creating key"
    openssl req -new -x509 -newkey rsa:2048 -days 36500 -keyout MOK.priv -outform DER -out MOK.der -nodes -subj "/CN=TinmarinoUnsafe/"
    #
    echo "\e[31;1mPlease enter a password you will be asked for on reboot:\e[0m"
    mokutil --import MOK.der
    echo "\e[31;1mNow you must: 1/ reboot, 2/ Select Unroll MOK, 3/ Enter password you previously gave\e[0m"

sign:
    cp one.ko one.ko.bck
    /usr/src/linux-headers-$(shell uname -r)/scripts/sign-file sha256 MOK.priv MOK.der one.ko

load:
    insmod ./$(TARGET_MODULE).ko

unload:
    rmmod ./$(TARGET_MODULE).ko

create:
    mknod /dev/one c $(shell cat /proc/devices | grep one$ | cut -d ' ' -f1) 0

delete:
    rm /dev/one

test:
    [ "$(shell xxd -p -l 10 /dev/one)" = "ffffffffffffffffffff" ] \
        && echo "\e[32mSUCCESS\e[0m" \
        || echo "\e[31mFAILED\e[0m" 
```

由于驱动程序签名强制执行，安装时间很长（3 分钟）。如果您在 UEFI 中禁用它，请忽略此部分。

1.  `git clone https://github.com/tinmarino/dev_one.git DevOne && cd DevOne # Download`
2.  `make build # Compile`
3.  `make key # Generate key for signing`
4.  `sudo make sign # Sign driver module to permit MOK enforcement (security)`
5.  `sudo reboot now # Reboot and enable Mok`
    1.  将出现蓝屏（MOK 管理器）
    2.  选择“注册 MOK”
    3.  选择“继续”
    4.  选择“是”（当询问“注册密钥”时）
    5.  输入您在`make sign`
    6.  选择“重新启动”（再次）
6.  `sudo make load # Load`
7.  `sudo make device # Create /dev/one`
8.  `make test # Test if all is ok`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-10-24T03:55:55.720

`/dev/one`您可以在没有特殊设备的情况下使用 FIFO + `printf`（在循环中；慢速）或`yes`（快速）模拟：

```
mkfifo ddfifo
dd if=ddfifo of=<file> iflag=fullblock count=1024 bs=1024 status=progress & while printf '\1'; do printf '\1'; done > ddfifo 
```

或者：

```
mkfifo ddfifo
dd if=ddfifo of=<file> iflag=fullblock count=1024 bs=1024 status=progress & yes "" | tr '\n' '\1' > ddfifo 
```

如果您想要所有位都设置为 1 的字节，请`'\1'`交换`'\377'`.

# javascript - 正则表达式日期格式

> ID：10905065
> 
> 赞同：0
> 
> 时间：2012-06-05T21:13:50.903
> 
> 标签：javascript, regex

以下日期格式的正则表达式字符串表达式是什么？

```
09 Jan 2012
09/01/2012 
```

没有最小值或最大值。我有一个存储所有正则表达式的 javascript 文件，例如：

```
var saNumberRegEx = /(^0[87][23467]((\d{7})|( |-)((\d{3}))( |-)(\d{4})|( |-)(\d{7})))/;
var tagNameRegEx = /^[a-z0-9][-\.a-z0-9]{4,29}$/i; 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T21:20:32.647

```
 /^\d{2}\s\w{3}\s\d{4}$/.test('09 Jan 2012'); // true
 /^\d{2}\/\d{2}\/\d{4}$/.test('09/01/2012'); // true

 /^\d{2}\s\w{3}\s\d{4}\s\d{2}\/\d{2}\/\d{4}$/.test('09 Jan 2012 09/01/2012'); // true 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T21:15:59.147

**编辑：**

**样品 1**

```
/^\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \d{4}$/ 
```

**样品 2**

```
/^\d{2}/\d{2}/\d{4}$/ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T21:23:23.277

第一种（2012 年 1 月 9 日）：

```
/\d{2} [a-z]{3} \d{4}/i 
```

对于第二种（09/01/2012）：

```
/\d{2}\/\d{2}\/\d{4}/ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-29T22:39:09.227

```
 /^(\d{1,2})[\-./ ](\d{1,2})[\-./ ](\d{4})$/.test('09/12/2012');//Just for month taken as number

        /^(\d{1,2})[\-./ ](Jan|Feb|Mars|Avril|Mai|Juin|Juil|Aout|Sept|Oct|Nov|Dec)[\-./ ](\d{4})$/.test('09 Jan 2012');//True just for month taken as word ex: jan/Dec

 /^(\d{1,2})[\-./ ](?:(\d{1,2})|(Jan|Feb|Mars|Avril|Mai|Juin|Juil|Aout|Sept|Oct|Nov|Dec))[\-./ ](\d{4})$/.test('09/12/2012');//True,Mixed month can be any number or word of month

    /^(\d{1,2})[\-./ ](?:(\d{1,2})|(Jan|Feb|Mars|Avril|Mai|Juin|Juil|Aout|Sept|Oct|Nov|Dec))[\-./ ](\d{4})$/.test('09 Jan 2012');// TRue,Mixed month can be any number or word of month

    /^(\d{1,2})[\-./ ](?:(\d{1,2})|(Jan|Feb|Mars|Avril|Mai|Juin|Juil|Aout|Sept|Oct|Nov|Dec))[\-./ ](\d{4})$/.test('09-Jan-2012');//True, Mixed month can be any number or word of month 
```

# asp.net - 在 IIS 7.5 中联系 WCF 服务时由对等方 (502) 重置连接

> ID：10905067
> 
> 赞同：7
> 
> 时间：2012-06-05T21:14:08.843
> 
> 标签：asp.net, wcf, iis

我们有一个 WCF 服务几个月来一直运行良好。就在今天早上，对该服务的调用开始失败，代理服务器报告“对等方重置连接”(502)。奇怪的是，没有 IIS 日志条目记录已断开的连接，尽管我们能够使用 WireShark 检测到它们。因此，似乎线程正在死去，没有留下任何痕迹。

有问题的网络方法是检索 100 条数据库记录。我们发现，通过将结果限制为 20 条记录，它可以按预期工作。我怀疑有一个超时起作用，但无一例外或回溯都很难知道。

有没有人经历过这个？关于如何解决它的任何建议？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-05T22:22:46.337

您可以在您的服务上打开 WCF 诊断以获取有关异常的更多详细信息。

为了让您快速上手 - 在您的网络（或应用程序）配置中：

1) 在配置元素下的任意位置添加 System.Diagnostics 部分。您可以将路径替换为您希望存储文件的路径。

```
<system.diagnostics>
    <sources>
      <source name="System.ServiceModel.MessageLogging" switchValue="Warning, ActivityTracing">
        <listeners>
          <add type="System.Diagnostics.DefaultTraceListener" name="Default">
            <filter type="" />
          </add>
          <add name="ServiceModelMessageLoggingListener">
            <filter type="" />
          </add>
        </listeners>
      </source>
      <source name="System.ServiceModel" switchValue="Warning, ActivityTracing" propagateActivity="true">
        <listeners>
          <add type="System.Diagnostics.DefaultTraceListener" name="Default">
            <filter type="" />
          </add>
          <add name="ServiceModelTraceListener">
            <filter type="" />
          </add>
        </listeners>
      </source>
    </sources>
    <sharedListeners>
      <add initializeData="C:\temp\services_messages.svclog" type="System.Diagnostics.XmlWriterTraceListener, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" name="ServiceModelMessageLoggingListener" traceOutputOptions="LogicalOperationStack, DateTime, Timestamp, ProcessId, ThreadId, Callstack">
        <filter type="" />
      </add>
      <add initializeData="C:\temp\services_tracelog.svclog" type="System.Diagnostics.XmlWriterTraceListener, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" name="ServiceModelTraceListener" traceOutputOptions="LogicalOperationStack, DateTime, Timestamp, ProcessId, ThreadId, Callstack">
        <filter type="" />
      </add>
    </sharedListeners>
  </system.diagnostics> 
```

2) 在 system.ServiceModel 下添加以下内容：

```
<diagnostics wmiProviderEnabled="false">
      <messageLogging logEntireMessage="true" logMalformedMessages="true" logMessagesAtServiceLevel="true" logMessagesAtTransportLevel="true" />
    </diagnostics> 
```

3) 在 C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bin\ 下启动 SvcTraceViewer.exe。加载消息跟踪 (services_messages.svclog) 和服务跟踪日志 (services_tracelog.svclog)。您可以在工具中拖放文件或打开一个然后添加另一个

4) 寻找问题的红色粗体字母。

如果您想让编辑 WCF 配置的体验更令人满意，您可以使用与 SvcTraceViewer.exe (#3) 位于同一文件夹下的 SvcConfigEditor.exe。只需打开配置文件，您应该会看到 Diagnostics 文件夹，它允许您启动/停止和配置诊断。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T22:17:30.217

至于故障排除，[WCF 跟踪](http://msdn.microsoft.com/en-us/library/ms733025.aspx)有时可以帮助找出这些问题。

# jquery - jquery .on() 和 .live() 用于水印 jquery

> ID：10905068
> 
> 赞同：0
> 
> 时间：2012-06-05T21:14:14.607
> 
> 标签：jquery, watermark

如何更改以下内容以便通过 jQuery`.on()`和使用`.live()`？我在转换它以使其在 ajax 加载后绑定时遇到问题。

```
$("#name_search").watermark("Search by name..."); 
```

我正在从 jQuery 版本 1.5 更改为 1.7，这就是为什么我要询问`.on()`和`.live()`. 我知道`.live()`在 1.7 中已弃用。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T23:11:40.747

您是否尝试在将其添加到 DOM 后立即开始`.watermark`工作？`$("#name_search")`如果是这样，您不能仅使用事件（可能）来做到这一点。您需要做的是`.watermark`在将该元素添加到 DOM 时调用。

```
$("body").append("<div id=name_search>");
$("#name_search").watermark('Search by name...'); 
```

# cocoa - 在可可中保持得分

> ID：10905070
> 
> 赞同：-2
> 
> 时间：2012-06-05T21:14:33.337
> 
> 标签：cocoa

我有一个测试学生知识的应用程序。在每个单元之后，它会转换到一个整体级别的视图控制器，我想记录有多少单元是完整的。这样做的最佳方法是什么？如果可能的话，我想在表格视图中显示结果。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T05:14:27.880

正如评论者所说，您的问题相当模糊，所以我只会提供一般性建议。在您测试学生知识的班级（或多个班级）中，您需要有一些方法将该单元的名称（可能还有分数）传递给整体级别的视图控制器。有很多方法可以做到这一点。一种方法是使用 NSNotificationCenter 方法 postNotificationName:object:userInfo: 发布通知。userInfo 可以包括单位名称、分数以及您想要的任何其他信息。整体级别控制器将注册为该通知的观察者。如果每个单元有不同的班级，则可以从其他班级发送相同的通知。

# node.js - 我应该如何在 Node.js 中实现带有 Web 前端的 RESTful API？

> ID：10905075
> 
> 赞同：3
> 
> 时间：2012-06-05T21:14:54.130
> 
> 标签：node.js, rest, express, railway.js, restify

我有一个由多个服务器（用 Java 编写）组成的设置，这些服务器需要与中央服务器通信，每隔一段时间发布一次状态更新。这些状态更新将被写入数据库，可能是 MongoDB/Mongoose，它将由 Web 端通过 REST 处理。

我一直将 Restify 和 Express 作为解决此问题的两种方法。该网站将查询数据库以及 REST api。

我应该如何处理这个？我应该同时使用 Restify 和 Express 来创建一个带有 API 的网站吗？我应该使用铁路吗？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T07:22:22.090

使用像 Rails 这样的复杂框架是没有意义的，它建立在 Express 之上并试图类似于 Ruby on Rails。

您应该选择 Express 或 Restify，而不是同时选择两者。

我会选择 Express 而不是 Restify，因为代码有很好的文档记录，而且该库更成熟且使用率很高。你可以找到一堆关于如何使用 Express 制作此类应用程序的有用教程，并且 API 很棒：

```
var express = require('express')
  , app = express.createServer();

var users = [{ name: 'tj' }];

app.all('/user/:id/:op?', function(req, res, next){
  req.user = users[req.params.id];
  if (req.user) {
    next();
  } else {
    next(new Error('cannot find user ' + req.params.id));
  }
});

app.get('/user/:id', function(req, res){
  res.send('viewing ' + req.user.name);
});

app.get('/user/:id/edit', function(req, res){
  res.send('editing ' + req.user.name);
});

app.put('/user/:id', function(req, res){
  res.send('updating ' + req.user.name);
});

app.get('*', function(req, res){
  res.send('what???', 404);
});

app.listen(3000); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T21:18:17.810

我个人认为 express.js 可以满足我的需求，因为它的路由功能非常棒。查看[http://expressjs.com/guide.html#routing](http://expressjs.com/guide.html#routing)。它可以完成 RESTful api 的工作，而且速度非常快。

还有：[Node-PerfectAPI vs Restify.js vs ExpressJS vs Node-APIServer](https://stackoverflow.com/questions/10468441/node-perfectapi-vs-restify-js-vs-expressjs-vs-node-apiserver)

# iphone - NSUserDefaults 是否会删除暂时不需要的键？

> ID：10905078
> 
> 赞同：1
> 
> 时间：2012-06-05T21:15:16.213
> 
> 标签：iphone, objective-c, ios, xcode, nsuserdefaults

我将所有数据存储在 NSUserDefaults 中。现在我正在尝试将一些具有特定前缀的键存储在一个数组中。因此，我首先将 UserDefaults 加载到 Dictionary 中。

```
NSString *myPrefix = @"prefix";
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
NSDictionary *dict = [defaults dictionaryRepresentation];
for (NSString *keyWithPrefix in dict.keyEnumerator) {
    if ([keyWithPrefix hasPrefix: myPrefix]) {
        [relevantKeys addObject: keyWithPrefix];
    }
} 
```

问题是：当我打印“dict”（代表 UserDefaults）时。缺少一些键。NSUserDefaults 是否会删除暂时不需要的键？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T21:18:16.770

不，它不是，NSUserDefault 是一个持久性存储，请阅读以下答案它有一个很好的解释 [[NSUserDefaults standardUserDefaults] 的持久性如何？](https://stackoverflow.com/questions/3133127/how-persistent-is-nsuserdefaults-standarduserdefaults)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T21:16:42.960

`[NSUserdefaults synchronize]`不，但是您在更新它们时会打电话吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T21:21:06.367

`-synchronize`在存储所需内容时，您可能应该使用方法。IE：

```
[[NSUserDefaults standardUserDefaults] setValue:someDictionary forKey:@"someKey"];
[[NSUSerDefaults standardUserDefaults] synchronize]; 
```

# c# - 如何在函数中分配参数？

> ID：10905079
> 
> 赞同：5
> 
> 时间：2012-06-05T21:15:26.630
> 
> 标签：c#, .net, c#-4.0

我有一个返回对象的方法，也有一个 out 参数。该方法调用另一个方法，该方法接收与另一个输出参数相同的输出参数。这会在 return 语句上产生构建错误：

> 在控制离开当前方法之前，必须将输出参数“param1”分配给

代码如下所示：

```
public TypeA Method1(TypeA param1, out bool param2)
{
  /... some logic here .../
  SubMethod(out param2);
  /... some logic here .../
  return param1;
} 
```

param2 在 SubMethod() 中操作，而不是在 Method1() 中。还有什么我需要做的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T21:19:29.580

在这种情况下，我将分配一个“默认”值。不管 bool、int、myFoo 等 - 设置一个默认值。

```
public TypeA Method1(TypeB param1, out bool param2)
{
  param2 = false;   // default value;
  // or
  param2 = default(bool); // in cases where you are not sure what the default is

  /... some logic here .../
  SubMethod(out param2);
  /... some logic here .../
  return param1; // UPDATE: <- this is where you are receiving the exception
} 
```

但是，当 param1 在此示例中显然没有错误时，您需要确定为什么异常指的是“param1”（*为了澄清*：**假设`TypeB : TypeA`**并受到适当的约束）。

我相信`param2`作为`out`参数传递`SubMethod(...)`可以消除分配的义务`param2`。但是，您尚未将任何内容分配给`param1`. 这里还有更多没有解释的事情吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T21:17:21.373

您可以将其设置`false`为`Method1`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T21:18:54.573

我可以建议将 SubMethod 中的 out 参数移动到返回类型：

```
public TypeA Method1(TypeB param1, out bool param2)
{
  /... some logic here .../
  param2 = SubMethod(param2);
  /... some logic here .../
  return param1;
} 
```

# database - 我可以将 Entity Framework 或 Linq To SQL 与 Windows 8 Metro Style 应用程序一起使用吗？

> ID：10905084
> 
> 赞同：17
> 
> 时间：2012-06-05T21:15:50.567
> 
> 标签：database, entity-framework, orm, windows-8, microsoft-metro

我正在寻找某种可以与 Metro Style 应用程序一起使用的 ORM。我发现很多帖子提到了不同的 SQLite 实现，这些实现似乎与 Metro 风格的应用程序一起工作（或不工作，根据其他帖子），但到目前为止还没有工作示例项目显示 Windows 8 Metro 上的 ORM。其他帖子指的是可能有效但由于禁止 API 调用而未通过 Marketplace 认证的项目。

我发现的很多信息可能已经过时了，所以我不确定我是否正确地用谷歌搜索过。

你们有没有人设法在 Windows Metro 风格的应用程序中启动并运行某种 ORM？如果可能的话，我想使用 EF Code First，但我越来越绝望，所以我不太挑剔。

谢谢你的建议，

阿德里安

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-13T13:13:01.890

我目前在 C# Windows 8 Metro App 上使用 SQLite 使用来自实验分支的代码，正如 Tim Heuer 在[这篇文章](http://timheuer.com/blog/archive/2012/05/20/using-sqlite-in-metro-style-app.aspx)中解释的那样（还有一个[视频](http://timheuer.com/blog/archive/2012/06/05/howto-video-using-sqlite-in-metro-style-app.aspx)），它运行良好，它将通过商店认证（Tim Heuer 在帖子中也提到了这一点）。

它不是实体框架，但它是迄今为止我们可以使用的最好的本地数据库。

其他选择：

*   [IndexedDB](http://www.w3.org/TR/IndexedDB)（它是 HTML5 功能，因此仅适用于 HTML5 应用程序）
*   [SQLite](http://sqlwinrt.codeplex.com) - AFAIK 它可以工作，但尚未通过商店认证
*   [WinRT 基于文件的数据库](http://winrtdatabase.codeplex.com)- 有趣，但不如 SQLite 性能好
*   [Siaqodb](http://siaqodb.com) - 有趣。还没测试
*   [Sterling NoSQL OODB](http://sterling.codeplex.com) - 还不支持 WinRT，但移植起来应该不难……我期待很快发布。不过，它是 NoSQL。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-05T21:47:50.320

据我所知，这是不可能的，因为 Metro 的 .NET[甚至没有 System.Data 命名空间](http://msdn.microsoft.com/en-us/library/windows/apps/br230232%28v=VS.85%29.aspx)和访问数据库所需的所有类。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-05T22:04:05.270

正如拉迪斯拉夫所说，目前这是不可能的。但是，您可以在 WinRT 平台上使用 WCF 数据服务 (OData)。有关详细信息，请参阅 Phani 关于[开发使用 OData 的 Windows 8 Metro 风格应用程序](http://blogs.msdn.com/b/phaniraj/archive/2012/04/26/developing-windows-8-metro-style-applications-that-consume-odata.aspx)的帖子。

# c# - 文件的递归循环突然停止

> ID：10905087
> 
> 赞同：1
> 
> 时间：2012-06-05T21:16:04.410
> 
> 标签：c#, recursion, stack-overflow, callstack

因此，我正在尝试遍历硬盘驱动器上的每个文件，但是一旦到达第 2115 个（我认为）循环，它就会停止。我相信这是由于我使用递归而导致的堆栈溢出，但我是 C# 新手，真的不知道。这是我的代码，非常感谢。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.IO;
using System.Data;

namespace test_data
{
    class Program
    {
        static string drive = Path.GetPathRoot(Environment.CurrentDirectory);

        static void CrawlDir(string dir)
        {
            string[] dir_package = {};
            List<string> dir_list = new List<string>();
            foreach (string scan_dir in Directory.GetDirectories(dir))
            {

                try
                {
                    dir_list.Add(scan_dir);
                }
                catch (System.Exception error)
                {
                    Console.WriteLine(error.Message);
                }

            }

            dir_package = dir_list.ToArray();
            Process_Package(dir_package);
        }

        static void Main(string[] args)
        {
            CrawlDir(drive);
            Console.ReadLine();
        }

        static void Process_Package(string[] package)
        {
            foreach (string dir in package)
            {
                Console.WriteLine(dir);
                try
                {
                    CrawlDir(dir);
                }
                catch (Exception)
                {
                    Console.WriteLine("Error!");
                }
            }
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T21:20:33.620

只需使用内置的 -`Directory.GetDirectories`支持可选参数来指定是否要递归获取所有目录：

```
var dirs = Directory.GetDirectories(drive, "*.*", SearchOption.AllDirectories); 
```

请注意，这是一个阻塞调用 - 相反，您可以`Directory.EnumerateDirectories`在找到目录名称时一一接收它们：

```
var dirs = Directory.EnumerateDirectories(drive, "*.*", SearchOption.AllDirectories);
foreach(string dir in dirs)
{
   Console.WriteLine(dir);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T21:33:38.273

通过使用列表 (dir_list)、数组 (dir_package) 和两个 try/catch 循环，您为每个递归级别增加了大量开销。我不知道你真正想要做什么，但对于这个例子来说，这太过分了。

尽管如此，在现代操作系统上导致堆栈溢出仍然需要很多时间。你得到什么错误信息？

这段代码应该是等价的。

```
using System;
using System.IO;

namespace test_data
{
    class Program
    {
        static string drive = Path.GetPathRoot(Environment.CurrentDirectory);

        static void CrawlDir(string dir)
        {
            foreach (string subDir in Directory.GetDirectories(dir))
            {
                try
                {
                    Console.WriteLine(subDir);
                    CrawlDir(subDir);
                }
                catch (Exception ex)
                {
                    Console.WriteLine(ex.Message);
                }
            }
        }

        static void Main(string[] args)
        {
            CrawlDir(drive);
            Console.ReadLine();
        }

    }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T21:21:36.193

[将此重载](http://msdn.microsoft.com/en-us/library/ms143314.aspx)与[SearchOption.AllDirectories](http://msdn.microsoft.com/en-us/library/ms143448.aspx)一起使用，因此您不必进行任何递归：

```
public static string[] GetDirectories(
    string path,
    string searchPattern,
    SearchOption searchOption
) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T21:24:47.570

递归看起来或多或少没问题，尽管您实际上并不需要 CrawlDir 中的列表。如果你有一个堆栈溢出，你会得到一个讨厌的消息。

我的猜测是 - 程序完成并在 ReadLine() 处停止，等待您按 Enter。

# visual-studio-2008 - Cassini 启动宏/脚本

> ID：10905089
> 
> 赞同：0
> 
> 时间：2012-06-05T21:16:16.330
> 
> 标签：visual-studio-2008, cassini, visual-studio-macros

我正在维护一个旧的 VS 项目，每次编译大约需要 2 分钟。每次进行更改时，我都必须重新编译，并且在调试时遇到 Cassini 的多次崩溃。是否有某种宏可用于重新启动 Cassini 而不是每次都重新编译？这将节省大量时间。

理想情况下，我可以在顶部的工具栏上有一个图标，该图标运行脚本/宏来启动 Cassini；最好为项目使用相同的端口。

谢谢 ;）

# android - 更改 Android 上的应用程序图标

> ID：10905093
> 
> 赞同：0
> 
> 时间：2012-06-05T21:16:46.180
> 
> 标签：android, icons

在安卓设备上，可以在安装后更改应用程序图标吗？可以通过代码从应用程序本身完成吗？如果我的应用程序将使用 Sencha Touch 编写，它会改变什么吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T21:26:22.763

APK 编译完成后，您无法更改应用程序图标（或 Android 清单或任何其他应用程序资源）。做到这一点的唯一方法是重新编译并将更新推向市场。

# python - python更改启动/默认目录

> ID：10905094
> 
> 赞同：4
> 
> 时间：2012-06-05T21:16:48.583
> 
> 标签：python, directory, python-2.7

我是 python 新手。每次我启动 shell 时，它总是给我目录：

> “.../文件名/Python/”

但我想将其更改为：

> “.../文件名/python 程序/”

如何在不更改导入调制内容的情况下做到这一点？我怕弄错了，所以我不能再导入了，但是放在这里太烦人了：

```
import os
os.chdir(".../file name/python program/") 
```

每次打开外壳后。感谢帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T22:20:46.400

结帐： [http ://docs.python.org/using/cmdline.html#envvar-PYTHONSTARTUP](http://docs.python.org/using/cmdline.html#envvar-PYTHONSTARTUP)

这是一个可以设置为文件的环境变量。这是在启动 shell 之前执行的，并且仅在您使用交互式 shell 时才适用。

您可以使用它在 shell 开始时将路径指定为当前目录。

```
import os
os.chdir('/pathto')
del os 
```

写入文件并使用 env 变量指向它。

如果这只是特定于您正在运行的文件，那么您应该更改脚本中的目录

```
os.chdir('/pathto') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T22:09:41.140

如果您尝试设置 python 以便在您导入模块时它会自动在您计算机上的特定目录中搜​​索，请打开您的 /python27/Lib/site.py 文件并将您的路径添加到靠近顶部的 PREFIXES 列表中文件

# google-maps - Google Maps API v3 需要很长时间才能显示 GeoRSS 提要中的更改

> ID：10905101
> 
> 赞同：1
> 
> 时间：2012-06-05T21:17:01.970
> 
> 标签：google-maps, rss, kml, georss

我需要在 Google Maps API v3 上显示 GeoRSS 提要。此提要是通过以下过程创建的：

1.  用户输入关键字
2.  感谢 PHP 代码，通过从 3 个不同的现有 RSS 提要中获取包含关键字的新闻项目来创建 RSS 文件。
3.  此 RSS 文件的链接提供给 Metacarta RSS 地理标记服务 ( [http://labs.metacarta.com/rss-geotagger/](http://labs.metacarta.com/rss-geotagger/) )
4.  获得的 GeoRSS 文件也必须转换为 KML 文件（如果我将 GeoRSS 的链接作为 KmlLayer 函数的参数，Google 地图只会放大到海洋）。为此，我使用 geonames.org 的 GeoRSS 到 KML 转换器
5.  然后将生成的 URL 作为 KmlLayer 函数的参数传递

在我第一次尝试时，一切都很好。但是当我输入一个新的关键字时，谷歌地图会显示我尝试使用前一个关键字的标记。新的 KML 图层显示花了将近 15 分钟（当然，在单击我的 Web 浏览器的刷新按钮之后）。有没有办法解决这个问题，以便在输入新关键字后立即在地图上显示修改后的 GeoRSS 提要？

由于新用户的超链接数量限制，我将在此处输入源代码。您可以从这里访问文件：[http](http://denizseeu.comule.com/) ://denizseeu.comule.com/ 我正在使用的文件是：home.html、my_rss.php、rss.xml 和 map.html

**home.html** - 用于输入和确认关键字的第一页

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Home</title>
    <style type="text/css">
        #keyword
        {
            color:grey;
            font: italic 12pt Arial;
        }
    </style>
</head>
<body>
    <form name ="form1" method ="POST" action = "my_rss.php">
        <input type="Text" onblur="if(this.value=='') { this.value='Enter keyword'; this.style.color='grey'; this.style.font='italic 12pt Arial'; }" onfocus="if(this.value=='Enter keyword') { this.value=''; this.style.color='#111111'; this.style.font='normal 12pt Arial'; }" value="Enter keyword" name="keyword" id="keyword">
        <input type="Submit" name="Submit1" value= "Show news on map" />
    </form>
</body>
</html> 
```

**my_rss.php** - 创建 RSS 文件的 PHP 文件

```
<html>
<head>
<title>Redirecting...</title>
<meta http-equiv="refresh" content="0;URL=map.html">
</head>

<body>
<?php
    $keyword = $_POST['keyword'];
    $URL = array("http://www.nytimes.com/services/xml/rss/nyt/GlobalHome.xml","http://feeds.bbci.co.uk/news/world/rss.xml?edition=uk","http://rss.cnn.com/rss/edition.rss");
    $output = "
<rss version=\"2.0\">
    <channel>
        <title>RSS collection</title>
                ";
for($y=0;$y<count($URL);$y++)
{
    $rss[$y] = simplexml_load_file($URL[$y]);

    foreach ($rss[$y]->channel->item as $item) 
    {
            if(preg_match("/".$keyword."/",$item->title,$result))
            {                       
                $output .= "
                            <item>
                                <title>". $item->title ."</title>
                                <description>". $item->description ."</description>
                                <link>";
                $link=$item->link;
                $link = str_replace('&', '&amp;', $link);
                $output .= $link ."</link>
                           </item>
                            ";
            }
    }
}
$output .= "</channel></rss>";

header ('Content-type: text/html; charset=utf-8');

echo $output; 

$xml = "rss.xml";
$file = fopen($xml, 'w') or die("can't open file");
fwrite($file, $output);
fclose($file);
?>
</body>
</html> 
```

**map.html** - 带有 Google Maps API 的网页

```
<!DOCTYPE html>
<html>
<head>
  <title>Welcome to my GeoRSS map</title>
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta charset="UTF-8">
  <style type="text/css">
    html, body, #map_canvas {
      margin: 0;
      padding: 0;
      height: 100%;
    }
  </style>
  <script type="text/javascript"
    src="https://maps.googleapis.com/maps/api/js?sensor=false"></script>
  <script type="text/javascript">
      var map;
      var initial_point = new google.maps.LatLng(42.02,20.97);
      function initialize() {
        var myOptions = {
        zoom: 2,
        center: initial_point,
        mapTypeId: google.maps.MapTypeId.ROADMAP
      };
      map = new google.maps.Map(document.getElementById('map_canvas'), myOptions);

    var geoRSS = new google.maps.KmlLayer('http://ws.geonames.org/rssToGeoRSS?type=kml&feedUrl=http%3A%2F%2Flabs.metacarta.com%2Frss-geotagger%2Ftag%2F%3Furl%3Dhttp%253A%252F%252Fdenizseeu.comule.com%252Frss.xml');
    geoRSS.setMap(map);
  }

  google.maps.event.addDomListener(window, 'load', initialize);
</script>
</head>
<body>
  <div id="map_canvas"></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T21:24:15.623

KmlLayer 缓存 KML，重新加载显然是同一个文件的文件不会导致 Google 重新加载 KML 并刷新其图层图块。

`Math.random`向您的 KML 网址添加一个随机虚拟参数（可能基于时间，或）。这将确保 Google 每次都能获得一个新的 url，并且是在您的地图中获取正确数据的最佳机会。

注意：Google 的 KML 处理是一个黑盒子。它可能不会被虚拟参数愚弄。

# jquery - 通过ajax动态创建元素时如何使用jquery的.on()方法？

> ID：10905104
> 
> 赞同：1
> 
> 时间：2012-06-05T21:17:21.323
> 
> 标签：jquery, ajax

我有这段代码：

```
$(document).ready(function() {
    $('.mostrar_usuario_link').on('click', function() {
        $("#mostrar_usuario_dialog").dialog({
            modal:false
        }) 
    });
}) 
```

当文档准备好时，属于该类的元素 (.mostrar_usuario_link) 不存在，因为只有在请求时才通过 ajax 动态创建这些元素。无论如何，对话框从未显示，我想知道是否是因为这个。

顺便说一句，.mostrar_usuario_link 类中的元素集是 < a > 标签，我正在使用 DOJO 来支持 Ajax。

我能得到任何帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T21:18:07.810

下面是正确的用法：

```
$("body").on("click", ".mostrar_usuario_link", function() {
    ...
}); 
```

您`body`可以使用`mostrar_usuario_link`.

参考：

*   [jQuery 文档 > on() > 委托事件方法](http://api.jquery.com/on/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T21:20:06.227

> 在加载任何其他 HTML 之前，文档元素在文档头部是可用的，因此在此处附加事件是安全的，而无需等待文档准备好。

[http://api.jquery.com/on/#direct-and-delegated-events](http://api.jquery.com/on/#direct-and-delegated-events)

```
$("document").on("click", ".mostrar_usuario_link", function() {
    ...
}); 
```

另外我不确定你是否已经这样做了，但如果元素是`<a>`标签，你可能想要[preventDefault](http://api.jquery.com/event.preventDefault/)来阻止锚标签的默认操作。

```
$("document").on("click", ".mostrar_usuario_link", function(e) {
    //Prevent Default action from link
    e.preventDefault();
    ...
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T21:35:54.390

使用 AJAX 时，您必须在您请求（异步）的 HTML 准备好后*重新分配事件。*怎么做？看一看：

```
 $.ajax({
      url: '....',
      success: someFunction
   }); 
```

现在，您可能已经有了*someFunction*的代码，即：

```
function someFunction(){
  $('.mostrar_usuario_link').on('click', function() {
      $("#mostrar_usuario_dialog").dialog({
          modal:false
      }) 
  });
} 
```

正如您可能已经知道的那样，您可以通过*data*参数在*success*中获得新的 HTML 。如需进一步参考，请查看[jQuery 的 .ajax 文档](http://api.jquery.com/jQuery.ajax/)。

 ** * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T01:57:02.763

我想出了如何解决我的问题。由于我使用的是 Dojo (< sx:a >) 的锚标记，因此它只执行自己的脚本。但是，您可以使用“afterNotifyTopics”属性来指示要在响应后执行的脚本。

这是HTML：

```
<s:url id="mostrar_usuario_url" action="mostrar_usuario.action">
    <s:param name="id_usuario" value="%{id_usuario}"/>
</s:url>
<sx:a cssClass="mostrar_usuario_link" id="mostrar_usuario_link_%{id_usuario}" targets="mostrar_usuario_dialog" href="%{mostrar_usuario_url}" afterNotifyTopics="lanzarCuadro">
    <s:property value="id_usuario"/>
</sx:a> 
```

这是JavaScript：

```
$(document).ready(function() {
    dojo.event.topic.subscribe("lanzarCuadro", function() {
        $("#mostrar_usuario_dialog").dialog({
            modal:true
        })
    });
} 
```

谢谢大家的支持。*

# vb.net - 将 Dictionary 转换为 SortedDictionary 后为自定义对象实现 iComparer

> ID：10905115
> 
> 赞同：0
> 
> 时间：2012-06-05T21:18:12.453
> 
> 标签：vb.net, icomparer, sorteddictionary

我在实现 IComparer 方法时遇到了麻烦。本质上，我想比较两个自定义对象的属性（属性是整数类型）。

dE 是 Dictionary(Of String, customObj) prTabIndex 是 customObj 的一个属性，并且是 Integer 类型（所有示例都适用）

经过一番搜索后，我发现[这个](https://stackoverflow.com/questions/289/how-do-you-sort-a-c-sharp-dictionary-by-value)线程建议了 3 件事：List 方法、利用 LINQ 和使用一些 C# 3.0 特性。但是，在 vb 中，不确定他们最好的方法是什么。

我尝试了三种不同的方法：

...滚动我自己的 IComparer 实现：

```
Public m As Sub(ByRef d As Dictionary(of String, customObj))

   Dim sortedD As New SortedDictionary(Of String, customObj)(d, myCompare)

End Sub

 Public Class myCompare
     Implements IComparer

    Public Function Compare(ByVal x As Object, ByVal y As Object) As Integer Implements System.Collections.IComparer.Compare
        If TryCast(x, customObj).prTabIndex < TryCast(y, customObj).prTabIndex Then
            Return -1
        Else
            Return 1
        End If
    End Function
End Class 
```

...对列表进行排序（我认为这是可行的——使这个线程有点学术性）。

```
Dim sortedL As List(Of KeyValuePair(Of String, customObj)) = dE.ToList
    sortedL.Sort(Function(firstPair As KeyValuePair(Of String, customObj), nextPair As KeyValuePair(Of String, customObj)) firstPair.Value.prTabIndex.CompareTo(nextPair.Value.prTabIndex)) 
```

...或将 lambda 函数直接合并到到 SortedDictionary 的转换中：

```
 Dim dESorted = From kvp As KeyValuePair(Of String, customObj) In dE.ToDictionary(Function(first As KeyValuePair(Of String, customObj), second As KeyValuePair(Of String, customObj)) first.Value.prTabIndex.CompareTo(nextPair.Value.prTabIndex)) 
```

请注意，VS2008 已在 'dE.ToDictionary...' 下划线（到行尾），并根据我将鼠标悬停的位置给我两条消息：

1）“扩展方法'签名'中类型参数的数据类型作为'System.Linq.Enumerable中定义的签名无法从这些参数中推断出来。明确指定数据类型可能会纠正此错误。看到将鼠标悬停在“ToDictionary”上。

2) 嵌套函数与委托“签名”的签名不同。在“ToDictionary”之后悬停在任何内容上时出现。

诚然，我是 lambda 函数的新手。

Q1）我在每个实现中离我有多远？

Q2) 哪一个是计算成本最低的？为什么？

Q3) 哪一个是计算上最昂贵的？为什么？

温暖的问候，

-sf

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T03:20:43.100

如果您实现通用 IComparable(Of ...)，您可以保存您的自我转换。我认为您还应该处理两个对象相等的可能性。

```
Public Class DemoClass
  Implements IComparable(Of DemoClass)

  Private mstrField1 As String
  Public Property Field1() As String
    Get
      Return mstrField1
    End Get
    Set(ByVal value As String)
      mstrField1 = value
    End Set
  End Property

  Private mstrField2 As String
  Public Property Field2() As String
    Get
      Return mstrField2
    End Get
    Set(ByVal value As String)
      mstrField2 = value
    End Set
  End Property

  Private mstrField3 As String
  Public Property Field3() As String
    Get
      Return mstrField3
    End Get
    Set(ByVal value As String)
      mstrField3 = value
    End Set
  End Property

  ''' <summary>
  ''' Default sort - 1 ASC, 2 ASC, 3 ASC 
  ''' </summary>
  ''' <param name="other"></param>
  ''' <returns></returns>
  ''' <remarks></remarks>
  Public Function CompareTo(ByVal other As DemoClass) As Integer Implements System.IComparable(Of DemoClass).CompareTo
    '-1 = less than other; 0 = same as other; +1 = greater than other'
    Select Case Me.Field1
      Case Is < other.Field1 : Return -1
      Case Is > other.Field1 : Return 1
      Case Else 'equal
        Select Case Me.Field2
          Case Is < other.Field2 : Return -1
          Case Is > other.Field2 : Return 1
          Case Else 'equal
            Select Case Me.Field3
              Case Is < other.Field3 : Return -1
              Case Is > other.Field3 : Return 1
              Case Else : Return 0 'equal
            End Select
        End Select
    End Select
  End Function
End Class 
```

# tsql - 插入和更新会触发删除触发器吗？

> ID：10905119
> 
> 赞同：-1
> 
> 时间：2012-06-05T21:18:24.410
> 
> 标签：tsql

我处于需要向表中添加触发器以跟踪对遗留系统的更改的不幸情况。我在 TABLE_A 上有插入、更新和删除触发器，每个触发器都将两列的值写入 TABLE_B，如果由删除触发器填充，则位标志设置为 1。

TABLE_B 中的每个条目都会出现两次。插入创建两行，更新创建两行（我们相信），删除创建插入然后删除。

是遗留应用程序这样做，还是 SQL 这样做？

编辑（添加更多细节）：

触发器主体：

..删除后

```
INSERT INTO TableB(col1, isdelete) SELECT col1, 1 from DELETED 
```

.. 插入后

```
INSERT INTO TableB(col1, isdelete) SELECT col1, 0 from INSERTED 
```

..更新后

```
INSERT INTO TableB(col1, isdelete) SELECT col1, 0 from DELETED 
```

我试过探查器，没有看到任何重复的语句正在执行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T14:28:58.713

当应用程序看到对其数据的操作时，可能会再次更改数据。

触发器也可能存在于其他地方 - 是否有可能在 TableB 上有一个触发器正在创建额外的行？

需要更多细节才能更全面地解决这个问题。

# sql - 将子查询临时表加入查询表

> ID：10905122
> 
> 赞同：0
> 
> 时间：2012-06-05T21:18:37.717
> 
> 标签：sql, join, subquery

我需要将子查询生成的单列表连接为父查询生成的表的最后一列。

```
SELECT tn.teamtext, sum(case when CONVERT(smalldatetime,dModLast,101) BETWEEN '2012-03-01' AND '2012-03-10' then 1 else 0 end) AS cnt,
    (SELECT sum(case when CONVERT(smalldatetime,dModLast,101) BETWEEN '2012-03-01' AND '2012-03-10' then 1 else 0 end)
      FROM teamnames AS tn 
        JOIN caseaudit AS ca
        ON tn.teamID = ca.referteamID2
      WHERE ca.referteamid1 <> ca.referteamid2
      AND isactive = 1
      AND groupid = 18
      AND accountid = 2) AS cnt2
  FROM teamnames AS tn 
    JOIN caseaudit AS ca
    ON tn.teamID = ca.referteamID2
  WHERE ca.referteamid1 <= 0
  AND ca.referteamid1 <> ca.referteamid2
  AND isactive = 1
  AND groupid = 18
  AND accountid = 2
  GROUP BY tn.teamtext
  ORDER BY tn.teamtext 
```

给我：

```
4H BOSS                   55    430
4H BSG                     0    430
4H SALES AND MKTG          0    430
ACCOUNTS RECEIVABLE        0    430
ASSET MANAGEMENT           9    430
AUDIT                      0    430
BOSS                       4    430
CORPORATE BSG              0    430
CUSTOMER SUPPORT          87    430
NETWORK ENGINEERING       11    430
PRODUCTION ENGINEERING   116    430
PRODUCTION OPERATIONS      0    430
SECURITY                   2    430
SNFAL PRODUCT TEAM         0    430
VOICE SERVICES            18    430
XEROX                      4    430 
```

“430”是 100% 不正确的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T21:27:10.170

看起来您希望总计数与分组计数一起。只需在 FROM CLAUSE 和 CROSS JOIN 中使用内联查询即可。

```
SELECT tn.teamtext, 
       Sum(CASE 
             WHEN CONVERT(smalldatetime, dModLast, 101) BETWEEN 
                  '2012-03-01' AND '2012-03-10' THEN 1 
             ELSE 0 
           END) AS cnt, 
       t.TotalCnt 
FROM   teamnames AS tn 
       JOIN caseaudit AS ca 
         ON tn.teamID = ca.referteamID2 
       CROSS JOIN (SELECT Sum(CASE 
                                WHEN CONVERT(smalldatetime, dModLast, 101) 
                                     BETWEEN 
                                     '2012-03-01' AND '2012-03-10' THEN 1 
                                ELSE 0 
                              END) AS TotalCnt 
                   FROM   teamnames AS tn 
                          JOIN caseaudit AS ca 
                            ON tn.teamID = ca.referteamID2 
                   WHERE  ca.referteamid1 <> ca.referteamid2 
                          AND isactive = 1 
                          AND groupid = 18 
                          AND accountid = 2) t 
WHERE  ca.referteamid1 <= 0 
       AND ca.referteamid1 <> ca.referteamid2 
       AND isactive = 1 
       AND groupid = 18 
       AND accountid = 2 
GROUP  BY tn.teamtext , t.TotalCnt 
ORDER  BY tn.teamtext 
```

[简化演示](http://sqlfiddle.com/#!3/2fd94/4)

当然，如果您想要的只是每个团队文本的 TeamText 以及您可以的总数

*   删除组
*   添加不同的
*   对每个团队文本使用 SUM(Case ..) OVER(Parition by teamtext)
*   使用 SUM(Case ..) OVER(Parition by null) 作为总计
*   移动`ca.referteamid1 <= 0`到第一个 SUM.. OVER

```
 SELECT DISTINCT tn.teamtext, 
       Sum(CASE 
             WHEN CONVERT(smalldatetime, dModLast, 101) BETWEEN '2012-03-01' AND '2012-03-10' AND ca.referteamid1 <= 0 THEN 1 
             ELSE 0 
           END) OVER (PARTITION BY tn.teamtext) AS cnt, 
       Sum(CASE 
             WHEN CONVERT(smalldatetime, dModLast, 101) BETWEEN '2012-03-01' AND '2012-03-10'  THEN 1 
             ELSE 0 
           END) OVER (PARTITION BY NULL) AS Totalcnt

FROM   teamnames AS tn 
       JOIN caseaudit AS ca 
         ON tn.teamID = ca.referteamID2 
WHERE 
        ca.referteamid1 <> ca.referteamid2 
       AND isactive = 1 
       AND groupid = 18 
       AND accountid = 2 
ORDER  BY tn.teamtext 
```

[简化演示](http://sqlfiddle.com/#!3/2fd94/2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T21:50:05.567

这有效：

```
SELECT a.teamtext, a.cnt, b.cnt2
FROM

(SELECT tn.teamtext, tn.teamid, sum(case when CONVERT(smalldatetime,dModLast,101) BETWEEN '2012-03-01' AND '2012-03-10' then 1 else 0 end) AS cnt
 FROM teamnames as tn
    LEFT OUTER JOIN caseaudit AS ca
    ON tn.teamID = ca.referteamID2
 WHERE ca.referteamid1 <= 0 AND ca.referteamid1 <> ca.referteamid2 AND isactive = 1 AND groupid = 18 AND accountid = 2
 GROUP BY tn.teamtext, tn.teamid) AS a

LEFT OUTER JOIN

 (SELECT tn.teamtext, tn.teamid, sum(case when CONVERT(smalldatetime,dModLast,101) BETWEEN '2012-03-01' AND '2012-03-10' then 1 else 0 end) AS cnt2
  FROM teamnames AS tn 
    LEFT OUTER JOIN caseaudit AS ca
    ON tn.teamID = ca.referteamID2
  WHERE ca.referteamid1 <> ca.referteamid2 AND isactive = 1 AND groupid = 18 AND accountid = 2
  GROUP BY tn.teamtext, tn.teamid) AS b
ON a.teamid = b.teamid
ORDER BY a.teamtext 
```

# ruby-on-rails - rails 3中的production.log卡住了

> ID：10905124
> 
> 赞同：0
> 
> 时间：2012-06-05T21:18:43.250
> 
> 标签：ruby-on-rails, logging

我在测试服务器上有一个奇怪的问题......

基本上我的应用程序运行良好，但是如果我检查production.log，由于某种原因卡在昨天，当我在应用程序上出现错误时......从那时起，我已经修复它，再次部署，但日志仍然不会更新。从昨天晚上开始就这样了。

所以如果我尝试

```
tail -f log/production.log 
```

我看到的最后一条日志是昨天的……这是怎么回事？这太奇怪了O___o

这是我的日志：

```
Started GET "/one" for xx.xx.xx.xx at 2012-06-04 09:14:30 -0400
Processing by ParagraphsController#one as HTML
(0.5ms)  SELECT id FROM paragraphs WHERE length = 1
Paragraph Load (0.3ms)  SELECT "paragraphs".* FROM "paragraphs" WHERE "paragraphs"."id" = $1 LIMIT 1  [["id", 1]]
Rendered paragraphs/one.html.erb within layouts/application (0.1ms)
Completed 200 OK in 3ms (Views: 1.0ms | ActiveRecord: 0.8ms)
tail: cannot open `1' for reading: No such file or directory 
```

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T21:21:00.313

也许您的日志文件已轮换？`tail -f`将跟随一个*文件*，而不是一个*文件名*。如果你想跟随*文件名*，那么你应该使用`tail -F`。（注意大写字母`F`。）这样，当文件旋转时，您将获得新的日志文件，而不是盯着旧文件。

# regex - 正则表达式查找两个字符串之间的子字符串

> ID：10905125
> 
> 赞同：0
> 
> 时间：2012-06-05T21:18:43.357
> 
> 标签：regex

我想在这个字符串中捕获初始目录的值：

“等等等等初始目录 = MyCat'”

我希望结果是：**MyCat**

等号前后可以有也可以不可以有空格，单引号之前可以有也可以不可以有空格。

尝试了这个和其他各种但没有去：

```
/Initial Catalog\s?=\s?.*\s?\'/ 
```

使用.Net。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T21:25:18.567

您需要在要匹配的字符串部分周围加上括号：

```
/Initial Catalog\s*=\s*(.*?)\s*'/ 
```

此外，您希望在 之前排除尽可能多的空格`'`，因此您需要`\s*`而不是`\s?`. 这`.*?`意味着提取的字符串部分不占用这些空格，因为它现在是惰性的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T21:24:28.233

这是一个不错的正则表达式

```
= *(.*?) *' 
```

使用这个想法并根据需要添加 \s 和更多文字文本。

在 C# 组 1 中将包含匹配项

```
string resultString = null;
try {
    Regex regexObj = new Regex("= *(.*?) *'");
    resultString = regexObj.Match(subjectString).Groups[1].Value;
} catch (ArgumentException ex) {
    // Syntax error in the regular expression
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T21:29:22.407

```
Regex rgx = new Regex(@"=\s*([A-z]+)\s*'");
String result = rgx.Match(text).Groups[1].Value; 
```

# c++ - 无法使用 packaged_task 在 thread_group 中创建线程

> ID：10905132
> 
> 赞同：1
> 
> 时间：2012-06-05T21:19:25.563
> 
> 标签：c++, multithreading, boost

我想创建一组都有未来的线程（这就是我使用 packaged_tasks 的原因），所以我可以使用它们返回的值。但是，以下代码在编译期间返回错误：

```
boost::thread_group group;

for(int i=0; i<4; i++){
    boost::packaged_task<int> task(std::bind(&matchThis,someStr, anotherStr));
    boost::unique_future<int> fi=task.get_future();

    //add task to task-group
    group.create_thread(boost::move(task));
    group.join_all();
} 
```

这是错误：

> c:\boost\boost\thread\detail\thread_group.hpp:42: 错误: "boost::packaged_task::packaged_task": 无法访问在 boost::packaged_task-class 中声明的私有成员。与 [R=int] ...

当我创建这样的线程时，这段代码运行良好：

```
boost::thread thread(boost::move(task)); 
```

那么使用 thread_groups 有什么问题呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T16:07:53.067

我假设您没有使用 C++11（因为我认为如果您使用它会起作用。）

`boost::thread`已“启用移动”，因此它可以接受由 . 返回的模拟右值引用`boost::move`。 `boost::thread_group`没有以相同的方式“启用移动”，因此参数 to`create_thread`必须是可复制的，而 a`packaged_task`是不可复制的。

我建议检查 Boost Trac 错误数据库，如果还没有添加请求`create_thread`以支持移动的右值。

# msbuild - 如何在 MSBuild 中包含排除的文件类型

> ID：10905138
> 
> 赞同：10
> 
> 时间：2012-06-05T21:19:47.187
> 
> 标签：msbuild, manifest

目前，MSBuild 不会将带有 .manifest 扩展名的文件复制到我的构建放置文件夹中。我已经添加了显式复制文件的命令，但是是否可以设置一个配置标志以便包含 .manifest 文件？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-06T00:00:46.787

您可以将`AllowedReferenceRelatedFileExtensions`属性传递给您的构建。该属性的值应该是一个分号分隔的文件扩展名列表。来自`Microsoft.Common.targets`：

```
<!--
These are the extensions that reference resolution will consider when looking for files related
to resolved references.  Add new extensions here if you want to add new file types to consider.
-->
<AllowedReferenceRelatedFileExtensions Condition=" '$(AllowedReferenceRelatedFileExtensions)' == '' ">
    .pdb;
    .xml
</AllowedReferenceRelatedFileExtensions> 
```

无法将值添加到列表中。您只能提供整个列表，因此请确保包含默认值，例如，

```
MSBuild.exe MyProject.csproj /t:build "/p:AllowedReferenceRelatedFileExtensions=.pdb;.xml;.manifest" 
```

# ios - 如何在将应用程序提交到 App Store 之前更改存档中的图标？

> ID：10905140
> 
> 赞同：1
> 
> 时间：2012-06-05T21:20:01.750
> 
> 标签：ios, xcode, xcode4, app-store

如何设置此图像？

Xcode->组织者->存档

![在此处输入图像描述](../Images/939cea94c5d61722031c187bc395b507.png)

我已经在这里设置了图标

![在此处输入图像描述](../Images/0acdcd1c9fc17a6beff67c2ca49bf67b.png)

图标.png (57x57)

图标@2x.png (114x114)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T21:26:55.437

转到您的项目设置并在此处添加图标： ![项目设置是您可以轻松添加图标的地方](../Images/dcf414dcace756d2a5ca465eb9b3de71.png)

确保图标的大小适合常规和视网膜显示。[可在此处找到 Apple 文档](http://developer.apple.com/library/ios/#documentation/userexperience/conceptual/mobilehig/IconsImages/IconsImages.html)。

# php - 如何将 ::setMaxDepth 用于 RecursiveIteratorIterator？

> ID：10905141
> 
> 赞同：1
> 
> 时间：2012-06-05T21:20:03.530
> 
> 标签：php, recursion, spl

我正在使用这个脚本，但我想为递归函数指定一个最大深度。不知道怎么用，总是报错。我应该如何在这里使用[::setMaxDepth](http://php.net/manual/en/recursiveiteratoriterator.setmaxdepth.php)？

```
public function countFiles($path)
{ 
global $file_count;
$depth=0;
$ite=new RecursiveDirectoryIterator($path);

$file_count=0;
foreach (new RecursiveIteratorIterator($ite) as $filename=>$cur) :
    $file_count++;
    $files[] = $filename;
endforeach;

return $file_count;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-07T06:48:07.150

您需要`setMaxDepth()`调用`RecursiveIteratorIterator`. `RecursiveIteratorIterator`当您在`foreach`语句内构造时，这很困难。相反，使用一个变量来保存它。

```
$files = new RecursiveIteratorIterator($ite);
$files->setMaxDepth($depth);
foreach ($files as $filename => $cur) {
    $file_count++;
    $files_list[] = $filename;
} 
```

* * *

但是请注意，这里不需要使用循环（除非您的代码执行您在上面的示例中删除的其他操作）。您可以使用[**`iterator_count()`**](http://php.net/iterator_count).

```
function countFiles($path)
{
    $depth = 1;
    $ite   = new RecursiveDirectoryIterator($path, RecursiveDirectoryIterator::SKIP_DOTS);
    $files = new RecursiveIteratorIterator($ite);
    $files->setMaxDepth($depth);
    return iterator_count($files);
} 
```

# smalltalk - 如何使用 Gofer 将 Monticello 包以不同的名称复制到另一个存储库

> ID：10905145
> 
> 赞同：10
> 
> 时间：2012-06-05T21:20:10.343
> 
> 标签：smalltalk, pharo, squeak, monticello

上下文是这样的：
一个包在多个存储库中开发了多个分支

*   吱吱声源
*   来源.squeak.org/trunk

开发在 source.squeak.org 中停止，目标是将分支转移回 squeaksource，以便在单个存储库中发布所有版本。
但是为了便于人工浏览和快速识别分支，我希望在 squeaksource 副本的名称中添加一个标准的分支识别。
有没有办法自动化这个操作？可能和Gofer一起？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-06T06:11:47.023

Monticello 包是不可变的。您可以轻松地移动版本，但不应重命名文件。如果这样做，您将破坏历史并失去将版本合并到您的版本树中以及与其他人的贡献合并的能力。

要将包*A*的所有版本从*源 url*移动到*目标 url*，您可以使用：

```
Gofer new
   repository: 'source url';
   package: 'A';
   fetch

" If you understand the concequences you could rename/rebranch the version files in your package-cache at this point. "

Gofer new
   repository: 'target url';
   package: 'A';
   push 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-06T13:14:39.363

一个更神秘的解决方案，它避免了后续的 Monticello 包的序列化和反序列化。这对于非常大的存储库很有用，并且可以大大加快复制速度：

```
| sourceRepositoryUrl destinationRepositoryUrl files |

repositoryUrl := 'http://www.squeaksource.com/PROJECT'.
destinationRepositoryUrl := 'http://smalltalkhub.com/mc/USER/PROJECT/main'.

files := (MCHttpRepository new 
    parseFileNamesFromStream: (ZnClient new get: repositoryUrl; entity) readStream)
    select: [ :each | ZnMonticelloServerDelegate new isValidMczName: each ].

files do: [ :fileName ||entity stream|

    Transcript show: fileName; cr.
    "download version"
    entity := ZnClient new
    beOneShot;
        url: repositoryUrl;
        addPath: fileName;
        get;
        entity.

    "upload the version to gemstone"
    ZnClient new
        beOneShot;
        ifFail: [ :exception | Transcript show: fileName; show: ' '; print: exception ];
        username: 'USER' password: 'PASSWORD';
        entity: entity;
        url: destinationRepositoryUrl;
        addPath: fileName;
        put ]
displayingProgress: [ :fileName| 'Copying ', fileName] 
```

# security - 电子商务的社交登录、安全问题、规范

> ID：10905146
> 
> 赞同：2
> 
> 时间：2012-06-05T21:20:18.387
> 
> 标签：security, login, e-commerce, social

给定一个允许评论、保存愿望清单等的电子商务网站，通过例如[hybridauth](http://hybridauth.sourceforge.net/)进行社交登录似乎是一个很好的补充。

之后，如果用户下订单，电子商务网站还会存储地址信息、订单历史等——但不存储信用卡数据，这些数据由第三方处理。

给定这样的网站，就以下方面而言，最佳实践是什么： 1）社交登录是否足够 - 不需要额外的密码？2）是否应该要求所有用户生成登录密码（因此社交登录除了预先填写注册表单并没有提供太多好处）？3) 用户是否需要稍后生成密码，例如。在他们输入地址信息的地方？

# php - preg_match bbcode

> ID：10905148
> 
> 赞同：0
> 
> 时间：2012-06-05T21:20:23.840
> 
> 标签：php, regex

我目前有这样的bbcode

```
[caption=Some text goes here]image.jpg[/caption] 
```

我想使用php的preg_match，这样我就可以得到image.jpg的值，不管'caption='旁边是什么。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T21:23:23.260

原始正则表达式：

```
]([^\]]+)[/caption]

preg_match("]([^\]]+)[/caption]", myString, $matches) 
```

image.jpg 将在第一组。 `$matches[1]` （我不确定我是否在 php 中正确地转义了它）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T21:25:32.690

您可以使用此正则表达式：

```
$str = '[caption=Some text goes here]image.jpg[/caption]';
if (preg_match('/^\[[^\]]+]([^[]+)/', $str, $arr))
   echo "image: $arr[1]\n"; 
```

### 输出

```
image: image.jpg 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-29T09:10:53.853

如果要匹配完整的 bbcode 标签，包括标题，请使用

`preg_match("/\[caption=(.+)\](.+)\[\/caption\]/", $myString, $matches);`

这将产生以下`$matches`数组：

```
Array
(
    [0] => [caption=Some text goes here]image.jpg[/caption]
    [1] => Some text goes here
    [2] => image.jpg
) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-05T21:26:10.343

**[正则表达式不是魔术。PHP 已经有一个预制的扩展库来处理 BBCode。](http://web.archive.org/web/20180326101236/http://il.php.net/manual/en/book.bbcode.php)**

不要重新发明轮子，也不要让自己难过。

# qt - Qt：“扩展”在布局中不起作用

> ID：10905151
> 
> 赞同：3
> 
> 时间：2012-06-05T21:20:29.433
> 
> 标签：qt

我的目的是创建一个可滚动的控件，里面有一个 QVBoxLayout，上面有各种控件（比如按钮）。该控件放在 *.ui 表单上。在该控件的构造函数中，我编写了以下代码：

```
 MyScrollArea::MyScrollArea(QWidget *parent) :
        QScrollArea(parent)
    {
        // create the scrollable container

        this->container = new QWidget();  // container widget member
        this->container->setSizePolicy(QSizePolicy::Expanding, QSizePolicy::Expanding);
        this->container->setContentsMargins(QMargins(0,0,0,0));

        this->content = new QVBoxLayout(); // layout member
        this->content->setMargin(0);
        this->content->setSpacing(0);

        for (int i=0; i<100; i++)
        {
            QPushButton * widget = new QPushButton();
            widget->setText("button");
            widget->setSizePolicy(QSizePolicy::Expanding, QSizePolicy::Fixed);
            this->content->addWidget(widget);
        }

        this->container->setLayout(this->content);
        this->content->layout();

        this->setWidget(this->container);
   } 
```

我的**问题**：按钮的大小固定，**不能水平扩展**。他们有一个固定的大小。我希望它们水平扩展以填充它们所在的行。如何让它们在其父容器中水平扩展？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T22:12:52.177

试着打电话`this->setWidgetResizable(true);`

# ruby-on-rails - joosy 表格不起作用

> ID：10905157
> 
> 赞同：1
> 
> 时间：2012-06-05T21:20:44.823
> 
> 标签：ruby-on-rails, coffeescript, joosy

我遵循指南[http://guides.joosy.ws/guides/blog/forms.html](http://guides.joosy.ws/guides/blog/forms.html)并尝试为新的和编辑帖子创建表单

所以我`templates/pages/posts/_form.jst.hamlc`用表单创建并添加代码`pages/posts/new.js.coffee`：

```
Joosy.namespace 'Posts', ->

  class @NewPage extends ApplicationPage
    @layout ApplicationLayout
    @view   'new'

  elements:
    'rawForm': 'form'

  @fetch (complete) ->
    @data.post = Post.build()
    complete()

  @afterLoad ->
    @form = Joosy.Form.attach @rawForm,
      resource: @data.post
      success: (data) => @navigate '/' 
```

但是“内在魔法”对我不起作用。当我关注时，`http://localhost:3000/blog#!/posts/new`我会看到新帖子的表格。此表格与往常一样提交。即，如果我输入一些内容并按保存，它会打开新页面`http://localhost:3000/blog?post%5Btitle%5D=test&post%5Bbody%5D=test#!/posts`

所以，我已经停在这一步，不知道该怎么办..

PS如果您可以将此问题重新标记为“joosy”，请执行此操作。[作者承诺在这里](http://borisstaal.com/post/24401343976/joosy-alternative-approach-to-browser-frameworks)通过“joosy”标签回答有关 joosy 框架的问题，但由于缺乏声誉，我无法创建此标签

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T22:51:44.117

你应该检查三件事：

1.  检查控制台是否有整体错误。它可能在 afterLoad 之前失败。这是 javascript，除非您看到错误，否则它只会默默地死去。
2.  尝试在 afterLoad 中添加 console.log @rawForm 以确保绑定正确的 DOM 元素。
3.  尝试将您的代码与工作示例进行比较：[https ://github.com/roundlake/joosy-example](https://github.com/roundlake/joosy-example)

如果 1/2 不起作用并且您没有太多时间，请向我展示您的模板，因为此页面看起来像此页面的副本：[https ://github.com/roundlake/joosy-example/blob/ master/app/assets/javascripts/blog/pages/posts/new.js.coffee](https://github.com/roundlake/joosy-example/blob/master/app/assets/javascripts/blog/pages/posts/new.js.coffee)。但众所周知，后者是有效的。所以麻烦不在这里。

# c# - HttpResponseException 不接受 HttpStatusCode

> ID：10905163
> 
> 赞同：8
> 
> 时间：2012-06-05T21:21:17.920
> 
> 标签：c#, asp.net, http, httpresponse, asp.net-web-api

我正在尝试`HttpResponseException`按照此截屏视频中的描述提出一个（大约 1 分钟）

```
throw new HttpResponseException(HttpStatusCode.Unauthorized); 
```

但是该应用程序不会编译，因为它会引发以下错误：

```
The best overloaded method match for 'System.Web.Http.HttpResponseException.HttpResponseException(System.Net.Http.HttpResponseMessage)' has some invalid arguments 
```

msdn 上的文档说它有一个接受`HttpResponseMessage`枚举的构造函数。[http://msdn.microsoft.com/en-us/library/hh835324%28v=vs.108%29.aspx](http://msdn.microsoft.com/en-us/library/hh835324%28v=vs.108%29.aspx)

我错过了什么？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-05T21:41:14.510

如果您使用的是 RC，这已经改变了。尝试：

```
throw new HttpResponseException(new HttpResponseMessage(HttpStatusCode.Unauthorized)); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-06T17:33:10.647

我自己刚刚遇到这个问题，我很高兴看到 smlync 提供的答案，但是看到这种情况下的 API 变得更加冗长令人失望！恕我直言，以下内容倾向于“可怕”的描述，特别是当这个异常（最重要的是）多次填充每个控制器时：

```
 throw new HttpResponseException(new HttpResponseMessage(HttpStatusCode.NotFound)); 
```

我可能会使用它，也许你们中的一些人会发现它也很有用：

```
 throw new Http404NotFoundException(); 
```

将以下内容放置在您想要的任何位置：

```
public class Http404NotFoundException : HttpResponseException
{
    public Http404NotFoundException()
        : base(new HttpResponseMessage(HttpStatusCode.NotFound)) { }
} 
```

这不是更干净、受人喜爱的 ASP.NET WebApi 团队吗？如果仅针对此状态代码，尽管可能会添加其他一些非常常见的状态代码等效项。

# android - 从游标中的多列填充列表视图，但只有一行？

> ID：10905166
> 
> 赞同：0
> 
> 时间：2012-06-05T21:21:22.853
> 
> 标签：android

对不起，如果这看起来很愚蠢，但我对所有这些东西都很陌生。情况是我有很多数据存储在数据库中，我需要在列表视图中呈现。第一个视图提取 15 行，并且仅使用数据库中 14 列中的两列。我使用这个适配器在列表视图中显示它：

```
private class CustomListAdapter extends SimpleCursorAdapter {

    private Cursor cursor;

    public CustomListAdapter(Context context, int textViewResourceId, Cursor cursor, String from[], int to[]) {
            super(context, textViewResourceId, cursor, from, to);
            this.cursor = cursor;
    }
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        View v = convertView;
            if (v == null) {
                LayoutInflater vi = (LayoutInflater)getSystemService(Context.LAYOUT_INFLATER_SERVICE);
                v = vi.inflate(R.layout.row, null);
            }
            cursor.moveToPosition(position);
            if (cursor != null) {
                    TextView lt = (TextView) v.findViewById(R.id.lefttext);
                    TextView rt = (TextView) v.findViewById(R.id.righttext);
                    if (lt != null) {
                          lt.setText(/*cursor.getString(cursor.getColumnIndex(EwstableContentProvider.TIMESTAMP))*/cursor.getString(cursor.getColumnIndex(EwstableContentProvider._ID)));                            }
                    if (rt != null){
                          rt.setText(cursor.getString(cursor.getColumnIndex(EwstableContentProvider.TOTALEWS)));
                    }

            }
            return v;
    }
} 
```

}

这甚至可能很愚蠢，但至少它有效。现在，在下一个活动中，我需要显示所有列中的数据，但仅来自用户在上一个活动中选择的行。我正在考虑把它放在一个列表视图中，比如[http://www.softwarepassion.com/android-series-custom-listview-items-and-adapters/](http://www.softwarepassion.com/android-series-custom-listview-items-and-adapters/)中的那个，这也是我修改适配器的地方。这样，我会将数据库中两个字段的数据放入列表视图中的每个项目中。这是完美的，它将是一个数据点和一个与之相伴的评论。问题是此时我的游标中只有一行，所以@Override 之后的位只执行一次，所以我得到了一个，而不是列表视图中的 7 个项目。我真的很感激任何帮助，即使是以完全不同的方式来做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:25:49.573

假设您知道列数，您是否可以只使用 for 循环遍历所有列，将每个字符串存储到 String 数组中。

```
String[] arr = new String[cursor.getColumnCount()];
for(int i=0; i < cursor.getColumnCount(); i++)
    arr[i] = cursor.getString(i); 
```

然后将 String[] 与[ArrayAdapter](http://developer.android.com/reference/android/widget/ArrayAdapter.html)一起用于您的列表视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T22:11:51.513

更新：抱歉没有仔细阅读问题；看其他答案。

您需要使用光标适配器。我推荐[SimpleCursorAdapter](http://developer.android.com/reference/android/widget/SimpleCursorAdapter.html)（下面的示例）。

您还需要将“from”参数更改为要显示的文本的列名（键）。下面是我个人代码中的一个示例。这条线，

```
new String[] { DBAdapter.KEY_NAME }, 
```

是重要的。它在 DBAdapter 中定义为：

```
public static final String KEY_NAME = "name"; 
```

它与我自己的数据库中第一列的名称匹配。

```
DBAdapter dba = new DBAdapter(this);
    dba.open();
    Cursor c = dba.list_listMode();

    SimpleCursorAdapter ca = new SimpleCursorAdapter(
            this,
            R.layout.list_item,
            c,
            new String[] { DBAdapter.KEY_NAME },
            new int[] { R.id.list_item_text });

    lv.setTextFilterEnabled(true);
    lv.setAdapter(ca);

    lv.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView<?> parent, View view,
                int position, long id_long) { 
```

# ruby - Ruby 使用正则表达式从字符串中提取数据

> ID：10905168
> 
> 赞同：13
> 
> 时间：2012-06-05T21:21:37.460
> 
> 标签：ruby, regex, jruby

我正在做一些网络抓取，这是数据的格式

```
Sr.No.  Course_Code Course_Name Credit  Grade   Attendance_Grade 
```

我收到的实际字符串是以下形式

```
1 CA727 PRINCIPLES OF COMPILER DESIGN 3 A M 
```

我感兴趣的是 Course_Code、Course_Name 和 Grade，在这个例子中，这些值是

```
Course_Code : CA727
Course_Name : PRINCIPLES OF COMPILER DESIGN
Grade : A 
```

我有什么方法可以使用正则表达式或其他技术来轻松提取此信息，而不是手动解析字符串。我在 1.9 模式下使用 jruby。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-06-05T21:35:37.367

让我们使用 Ruby 的命名捕获和自描述正则表达式！

```
course_line = /
    ^                  # Starting at the front of the string
    (?<SrNo>\d+)       # Capture one or more digits; call the result "SrNo"
    \s+                # Eat some whitespace
    (?<Code>\S+)       # Capture all the non-whitespace you can; call it "Code"
    \s+                # Eat some whitespace
    (?<Name>.+\S)      # Capture as much as you can
                       # (while letting the rest of the regex still work)
                       # Make sure you end with a non-whitespace character.
                       # Call this "Name"
    \s+                # Eat some whitespace
    (?<Credit>\S+)     # Capture all the non-whitespace you can; call it "Credit"
    \s+                # Eat some whitespace
    (?<Grade>\S+)      # Capture all the non-whitespace you can; call it "Grade"
    \s+                # Eat some whitespace
    (?<Attendance>\S+) # Capture all the non-whitespace; call it "Attendance"
    $                  # Make sure that we're at the end of the line now
/x

str = "1   CA727   PRINCIPLES OF COMPILER DESIGN   3   A   M"
parts = str.match(course_line)

puts "
Course Code: #{parts['Code']}
Course Name: #{parts['Name']}
      Grade: #{parts['Grade']}".strip

#=> Course Code: CA727
#=> Course Name: PRINCIPLES OF COMPILER DESIGN
#=>       Grade: A 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-06T01:19:47.290

只是为了好玩：

```
str = "1 CA727 PRINCIPLES OF COMPILER DESIGN 3 A M"
tok = str.split /\s+/
data = {'Sr.No.' => tok.shift, 'Course_Code' => tok.shift, 'Attendance_Grade' => tok.pop,'Grade' => tok.pop, 'Credit' => tok.pop, 'Course_Name' => tok.join(' ')} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-05T21:34:14.623

我是否正确地看到分隔符始终是 3 个空格？然后只是：

```
serial_number, course_code, course_name, credit, grade, attendance_grade = 
  the_string.split('   ') 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-05T21:36:21.763

假设除了课程描述之外的所有内容都由单个单词组成，并且没有前导或尾随空格：

```
/^(\w+)\s+(\w+)\s+([\w\s]+)\s+(\w+)\s+(\w+)\s+(\w+)$/ 
```

您的示例字符串将产生以下匹配组：

```
1\.  1
2\.  CA727
3\.  PRINCIPLES OF COMPILER DESIGN
4\.  3
5\.  A
6\.  M 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-05T21:36:38.977

这个答案不是非常地道的 Ruby，因为在这种情况下，我认为清晰胜于聪明。要解决您描述的问题，您真正需要做的就是用空格分隔行：

```
line = '1   CA727   PRINCIPLES OF COMPILER DESIGN   3   A   M'
array = line.split /\t|\s{2,}/
puts array[1], array[2], array[4] 
```

这假设您的数据是常规的。如果没有，您将需要更加努力地调整您的正则表达式，并可能处理您没有所需数量的字段的边缘情况。

### 留给后代的注意事项

OP 更改了输入字符串，并将分隔符修改为字段之间的单个空格。我将按原样保留对原始问题的回答（包括原始输入字符串以供参考），因为它可能会在不太具体的情况下帮助除 OP 之外的其他人。

# c# - 将方法 Rand(int) Visual Fox Pro 迁移到 C#.net

> ID：10905171
> 
> 赞同：-4
> 
> 时间：2012-06-05T21:21:53.807
> 
> 标签：c#, asp.net, .net, foxpro, visual-foxpro

我正在将 Visual Fox Pro 代码迁移到 C#。网

**是什么让 Visual Fox Pro**：根据文本字符串（在文本框中捕获）生成一个 5 位数字的字符串（“48963”），如果您始终输入相同的文本字符串，则该字符串始终为 5 位数字（不反向），我在 C# 中的代码。NET 应该生成相同的字符串。

我想迁移以下代码（Visual Fox Pro 6 到 C#）

```
gnLower = 1000
gnUpper = 100000
vcad = 1
For y=gnLower to gnUpper step 52
    genClave = **Rand(vcad)** * y
    vRound = allt(str(int(genclave)))
    IF Len(vRound) = 3
            vDec = Right(allt(str(genClave,10,2)), 2)
            finClave = vRound+vDec
            Thisform.txtPass.value = Rand(971);
    Exit
    Endif
Next y 
```

输出：

```
vcad = 1 return: 99905 vcad = 2 return: 10077 vcad = thanks return: 17200 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:24:31.633

正如我在您的其他问题[http://foxcentral.net/microsoft/vfptoolkitnet.htm](http://foxcentral.net/microsoft/vfptoolkitnet.htm)中发布的那样，.net 的 VFP 工具包可能具有相同的 rand 生成器功能

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T01:41:48.193

**如果您确实**需要获得与所述完全相同的行为， 请将 VFP RAND 调用封装在 COM dll 中并从 .net 调用它。

似乎是一个奇怪的设计，但我猜这对你来说是遗留系统。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T21:57:12.370

相当于

```
Rand(vcad) 
```

是

```
(new Random(vcad)).Next(); 
```

相当于

```
x = Rand(seedValue)
y = Rand() 
```

是

```
Random r = new Random(seedValue);
x = r.Next();
y = r.Next(); 
```

但是，如果这些等效语句实际上在 VFP 中产生与在 c#.Net 中相同的结果，您应该认为自己**非常幸运。**底层实现必须相同，这让我非常惊讶。如果它们没有产生相同的结果，而这是您的要求，那么您的任务就是找出 FoxPro 的 Rand 函数的内部实现是什么，并在 c# 代码中复制它。

如果 vcad 的值范围被限制在某个范围内，最简单的解决方案是使用 VFP 生成查找值表并在 c# 转换中使用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T21:58:59.530

您的解决方案实际上可以像 C# .net 4.0 中的两个现有方法一样简单

```
public int MyRandomFunction(string seedString)
{
    int hashCode = seedString.GetHashCode(); // Always returns the same integer based on a string
    Random myGenerator = new Random(hasCode);
    return myGenerator.Next(10000, 99999); // Returns a number between 10000 and 99999, ie 5 digits
} 
```

您将始终获得相同的初始值，因为您总是从相同的种子开始。

# python - 在“os”之后显示功能可能性。在 python 的 IDLE 中

> ID：10905175
> 
> 赞同：1
> 
> 时间：2012-06-05T21:22:11.790
> 
> 标签：python, function, python-idle

我希望 IDLE 在输入“。”后向我显示所有可能的功能。对于任何图书馆。如何才能做到这一点？或者可以做到吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T21:27:33.910

在 IDLE 中，这是最接近的：

```
>>> import os
>>> dir(os)
['F_OK', 'MutableMapping', 'O_APPEND', 'O_BINARY', 'O_CREAT', 'O_EXCL', 'O_NOINHERIT', 'O_RANDOM', 'O_RDONLY', 'O_RDWR', 'O_SEQUENTIAL', 'O_SHORT_LIVED', 'O_TEMPORARY', 'O_TEXT', 'O_TRUNC', 'O_WRONLY', 'P_DETACH', 'P_NOWAIT', 'P_NOWAITO', 'P_OVERLAY', 'P_WAIT', 'R_OK', 'SEEK_CUR', 'SEEK_END', 'SEEK_SET', 'TMP_MAX', 'W_OK', 'X_OK', '_Environ', '__all__', '__builtins__', '__cached__', '__doc__', '__file__', '__name__', '__package__', '_copyreg', '_execvpe', '_exists', '_exit', '_get_exports_list', '_get_masked_mode', '_make_stat_result', '_make_statvfs_result', '_pickle_stat_result', '_pickle_statvfs_result', '_putenv', '_unsetenv', '_wrap_close', 'abort', 'access', 'altsep', 'chdir', 'chmod', 'close', 'closerange', 'curdir', 'defpath', 'device_encoding', 'devnull', 'dup', 'dup2', 'environ', 'errno', 'error', 'execl', 'execle', 'execlp', 'execlpe', 'execv', 'execve', 'execvp', 'execvpe', 'extsep', 'fdopen', 'fsdecode', 'fsencode', 'fstat', 'fsync', 'get_exec_path', 'getcwd', 'getcwdb', 'getenv', 'getlogin', 'getpid', 'getppid', 'isatty', 'kill', 'linesep', 'link', 'listdir', 'lseek', 'lstat', 'makedirs', 'mkdir', 'name', 'open', 'pardir', 'path', 'pathsep', 'pipe', 'popen', 'putenv', 'read', 'readlink', 'remove', 'removedirs', 'rename', 'renames', 'rmdir', 'sep', 'spawnl', 'spawnle', 'spawnv', 'spawnve', 'startfile', 'stat', 'stat_float_times', 'stat_result', 'statvfs_result', 'strerror', 'supports_bytes_environ', 'symlink', 'sys', 'system', 'times', 'umask', 'unlink', 'urandom', 'utime', 'waitpid', 'walk', 'write'] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T21:45:04.050

返回模块中**函数的名称：**

```
def methods(module):
    return [module.__dict__.get(attr).__name__ for attr in dir(module) if isinstance(module.__dict__.get(attr), types.FunctionType)] 
```

例子：

```
import re
methods(re) // ['_compile', '_compile_repl', '_expand', '_pickle', '_subx', 'compile', 'escape', 'findall', 'finditer', 'match', 'purge', 'search', 'split', 'sub', 'subn', 'template'] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T21:27:05.927

像这样：

```
import os
dir(os) 
```

您也可以考虑编写一个小函数，以更易读的方式格式化 dir 的输出

# iphone - Xcode 4.3.1 doxygen 注释生成

> ID：10905180
> 
> 赞同：1
> 
> 时间：2012-06-05T21:22:53.753
> 
> 标签：iphone, objective-c, ios, xcode

我目前正在使用最新版本的 xCode，我希望能够像在 xCode 3 中那样执行[http://www.youtube.com/watch?feature=player_detailpage&v=9u1mrVTRt4w#t=98s 。](http://www.youtube.com/watch?feature=player_detailpage&v=9u1mrVTRt4w#t=98s)

任何人都可以提供可能的解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T21:36:58.993

Xcode 4 没有内置于旧 Xcode 版本中的 Scripts 菜单。然而，有一种解决方法可以利用 OSX 中内置的服务来实现相同的行为。为了添加 Doxygen 脚本，此博客文章中提供了分步指南和 Doxygen.rb 脚本：[Xcode4 中的 Doxygen 快捷方式](http://www.brokenrul.es/blog/?p=761#.T856wD5YtoA)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T18:24:46.587

Duck Rowing 有一个非常不错的宏 cmd-shift-D 可以根据所选代码生成模板。

[在http://www.duckrowing.com/2011/05/14/using-the-doxygen-helper-in-xcode-4/](http://www.duckrowing.com/2011/05/14/using-the-doxygen-helper-in-xcode-4/)了解更多信息

# sql - 同一张表上的Linq查询，行之间存在差异

> ID：10905183
> 
> 赞同：1
> 
> 时间：2012-06-05T21:23:10.810
> 
> 标签：sql, linq, linq-to-sql, linq-to-entities

我一直在尝试开发一个从同一个表返回结果的 linq 查询。

```
ORDERS

YEAR        NumberOfOrders
--------------------------
2009            150

2010            195

2011            180

2012            110 
```

查询必须返回当前和上一年（2012 年和 2011 年）之间的差异，如下所示：

结果：

```
YEAR     NumberofOrders      DIFFERENCE
---------------------------------------
2012         110                -70 
```

谢谢你的帮助，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T21:55:07.637

我自己找到的

```
var query = (from o1 in context.orders
             where o1.year == lastyear
             from o2 in context.orders
             where o2.year == currentyear
             select new
             {
                difference = o2.numberOfOrders - o1.numberOfOrders,
                numberOfOrders =  o2.numberOfOrders,
                year = o2.year                    
             }); 
```

谢谢，

# jquery - 使用 jQuery-File-Upload 成功上传后运行 SQL

> ID：10905195
> 
> 赞同：0
> 
> 时间：2012-06-05T21:24:49.047
> 
> 标签：jquery, jquery-ui, jquery-plugins

我已经离开了我的舒适区，可以使用一些帮助。我正在使用 jQuery-File-Upload 插件将文件上传到目录。上传成功后，我想对我的数据库运行 SQL 查询。我在哪里做这个？与回调有关吗？

我正在使用`upload.class.php`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T23:57:57.467

[您可以使用函数is_uploaded_file](http://php.net/manual/en/function.is-uploaded-file.php)或[move_uploaded_file](http://www.php.net/manual/en/function.move-uploaded-file.php)检查您的文件是否已上传到服务器。 如果这些返回 TRUE，您可以运行查询。

# javascript - jQuery/Javascript 似乎停止工作？

> ID：10905198
> 
> 赞同：0
> 
> 时间：2012-06-05T21:25:10.440
> 
> 标签：javascript, jquery, html

我仍在学习 jQuery（1.6 分钟）和 Javascript，但到目前为止，我对我能够实现的目标感到非常满意，但这个问题让我上当了——我已经看了四个小时了！

我在 a 中包含的页面上有以下链接（其 id 值为“NorthWest”）：-

```
<figure><a href="http://localhost:8888/popup/PFS98394" class="popUpSimple"><img src="http://localhost:8888/98394.jpg" alt="" border="0"></a></figure> 
```

单击它时，将内容正确加载到 a 中，使其可见。它不会重新加载页面，只是使 DIV 在当前内容之上可见。执行此操作的 Javascript 使用标准的 jQuery Fancybox。

一切正常，DIV 可以多次显示和隐藏，每次加载不同的信息。现在有一个 IMG 按钮，允许用户使用最新内容重新加载“NorthWest”DIV - 单击它时会执行以下代码：

```
 $(".RefreshThumb").find("a").click(function(){
   $(".RefreshLoader").show();
   $("#NorthWest").load("/refreshdata");
   setTimeout(RefreshHide,1000);
 }); 
```

setTimeout 行指的是一个小图形（刷新加载程序），它会立即显示以告知用户正在刷新数据。

现在，取出 $("#NorthWest").load 等行，一切正常。重新添加该行，popUpSimple 链接可以正常工作，直到单击 IMG 按钮刷新 NorthWest DIV，之后 popUpSimple 内容作为新页面加载并且不再覆盖 - 在单击弹出覆盖之前无论如何都可以正常工作你点击了多少次。

**编辑：**我应该指出，在单击 IMG 按钮重新加载 NorthWest DIV 后它会成功，只有当您单击 popUpSimple 链接时才会出现问题！

我做错了什么？我正在使用 Safari 并在页面重新加载而不是加载到 DIV 显示后查看 Web Inspector 窗口：

```
<script type="text/javascript">
$(document).ready(function() { 
```

有一条消息说参考错误：找不到变量 $。

谁能指出我正确的方向....拜托！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T21:32:28.273

这听起来像一个事件监听器问题，尝试使用`.on('click',function(){}`而不是`.click(function(){}`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T22:12:39.870

也许 jquery '$' 被另一个 JS 框架覆盖。

只需将您的 '$' 替换为 'jQuery' ，当然不带单引号。您甚至可以尝试使用[http://api.jquery.com/jQuery.noConflict/](http://api.jquery.com/jQuery.noConflict/) 您可以在加载 jQuery 库后立即添加它，例如：

```
<script type="text/javascript" src="other_lib.js"></script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript">
  $.noConflict();
  // Code that uses other library's $ can follow here.
</script> 
```

# payment-gateway - POS 终端能否通过 IP 网络直接连接到支付网关或商户账户？

> ID：10905199
> 
> 赞同：2
> 
> 时间：2012-06-05T21:25:15.530
> 
> 标签：payment-gateway, point-of-sale, javapos

我正在寻找支持签名捕获、pin PAD 和以太网的 POS 终端。使用以太网和 IP 网络的 POS 终端应该能够直接与支付网关/类似系统通信以处理卡支付。步骤是：

1.  PC 软件向 POS 发送命令以处理付款并告诉客户刷卡
2.  客户刷卡，如果需要，请提供签名或 PIN
3.  交易成功后，POS 终端会使用授权码、卡信息（最后 4 位/cvv/exp 日期等）和交易参考更新 PC 软件。数字
4.  如果适用，PC 软件也可以提取签名。

请分享您对此的看法。

提前致谢。问候，虚拟现实

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T15:50:03.370

你的过程是正确的。一般来说，主要的货币演员会给你一个库（dll或jar），它集成了

*   您可以在软件中使用的 pos 接口（不存在真正的标准）（贷记、借记、取消...）
*   外围接口，用于在他们的库和连接的 pin pad 之间进行对话，取决于您的系统系统
*   实现您的 pos 和远程货币网关（pos <-> 货币网关 <-> 银行）之间对话的货币接口
*   一个本地货币服务器，它在您的库和远程货币网关之间实现对话，并让您管理您的交易您可以在论坛 www.kasstore.com 上观看，他们为他们的产品集成了许多货币接口

# emacs - 隐藏emacs tex-shell

> ID：10905200
> 
> 赞同：2
> 
> 时间：2012-06-05T21:25:16.020
> 
> 标签：emacs, latex, pdflatex

有没有一种简单的方法可以让 emacs 将 tex-shell 输出放在后台缓冲区中？即与默认行为相反，它自动使拆分窗口显示tex-shell。

通常情况下，我不需要在渲染后查看 tex-shell 输出，它只是不必要地占用了我必须修复的窗口空间（这是一个公认的小烦恼，但仍然是一个烦恼）。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T06:47:00.877

您应该使用[AUCTeX](http://www.gnu.org/software/auctex/)（它比内置的 tex 模式好得多），它只会在您要求时打开 TeX shell。

# android - 是否可以将 Android 文本转换为不同于设备语言的语音语言？

> ID：10905207
> 
> 赞同：1
> 
> 时间：2012-06-05T21:25:37.897
> 
> 标签：android, multilingual, text-to-speech

例如，我希望将设备中的语言设置为“意大利语”，并让 TTS 在我的应用程序中说英语。

任何想法 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T21:35:48.230

使用 setLanguage 方法

```
TextToSpeech mTts;
mTts = new TextToSpeech(this, this);
mTts.setLanguage(Locale.US);
//mTts.isLanguageAvailable(Locale.FRANCE) 
```

请参阅此[链接](http://developer.android.com/resources/articles/tts.html)部分**语言和区域设置**

我建议您观看 Google I/O[视频](http://www.youtube.com/watch?v=uX9nt8Cpdqg#t=6m17s)

文本到语音的默认设置会覆盖您的应用程序设置

您可以通过使用意图提示用户文本到语音设置并要求他删除默认设置：

```
ComponentName componentToLaunch = new ComponentName(
        "com.android.settings",
        "com.android.settings.TextToSpeechSettings");
Intent intent = new Intent();
intent.addCategory(Intent.CATEGORY_LAUNCHER);
intent.setComponent(componentToLaunch);
intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
startActivity(intent); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T21:36:27.543

看看[Using Text-to-Speech](http://developer.android.com/resources/articles/tts.html)您可以使用**setLanguage设置****TextToSpeech**对象的语言，例如：

 **```
mTts.setLanguage(Locale.US); // here mTs is a TextToSpeech object 
```

所以，你想要的应该不是问题。**

# d - GtkD（D 语言的 Gtk+bindings）为什么要编译它？

> ID：10905212
> 
> 赞同：2
> 
> 时间：2012-06-05T21:25:50.830
> 
> 标签：d, gtkd

我最近一直在使用带有 D 编程语言的 GtkD 来创建本地应用程序。我已经下载了所有必要的文件并让一切运行起来，所以我现在可以编译和生成示例应用程序。

我的问题是，在某些指南中，它告诉您在您使用的平台上编译 GtkD，但有什么意义呢？编译后，您最终会在 Windows 上得到一个 lib 文件 (GtkD.lib)，在 Linux 上得到三个 lib 文件（以 *.a 结尾）。这些文件是做什么用的，它们是如何使用的？就像我说的，一切似乎都在工作，而无需对这些文件做任何事情。

我猜你可以静态链接这些？但那是为了什么？为了避免每次都编译 GtkD 源代码？我确实尝试过使用该`pragma('lib', 'GtkD.lib')`语句，但它似乎没有做任何事情。

任何人都可以对此有所了解或解释为什么需要这些文件吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T21:54:29.837

是的，这是为了避免每次都编译 GtkD 源代码。

尝试使用`pragma(lib, "GtkD");`而不是`pragma('lib', 'GtkD.lib');`

这个对我有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T21:55:51.013

导入的源文件不会被编译，它们只会被解析为符号名称和函数签名（和模板）

创建库是为了避免每次需要重新编译时都需要重新编译整个库，然后编译器只能使用 .di 文件进行导入

这源于过去编译需要很长时间，现在它可以用来保持库的封闭源代码

# c# - 可以在应用程序中强制使用特定的方法签名吗？

> ID：10905215
> 
> 赞同：2
> 
> 时间：2012-06-05T21:26:14.550
> 
> 标签：c#, .net

我们有一个辅助程序集，可帮助开发人员记录信息。用于记录的具体方法有两个签名：

```
LogToULS(string message)
LogToULS(string message, Microsoft.Sharepoint.Administration.SPDiagnosticsCategory category) 
```

在我的应用程序中，我创建了一个包含 SPDiagnosticsCategory 实例的静态类，我希望在应用程序记录某些内容时使用该实例。如果使用第一个签名，则会分配一个通用类别，并且更难找到特定于该应用程序的记录信息。

我的问题是，是否可以强制人们在任何时候`LogToULS`从此应用程序调用第二个签名，或者这是否需要通过程序员教育来完成？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T21:29:29.430

如果您无法从代码库中删除该方法，则可以将其标记为已弃用，因此其他程序员在调用它时会收到编译器警告（并且 IntelliSense 会警告它的使用）：

```
[Obsolete("Use LogToULS(string, SPDiagnosticsCategory) instead."]
public void LogToULS(string message)
{
    // ...
} 
```

根据[`ObsoleteAttribute`文档](http://msdn.microsoft.com/en-us/library/system.obsoleteattribute.aspx)，您可以将`true`其作为第二个参数传递给其构造函数以导致编译器错误（不仅仅是警告），但这可能会破坏现有代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T21:34:19.363

将第一个重载定义为：

```
public void LogToULS(string message)
{
    LogToULS(message, genericErrorCodeHere);
} 
```

然后，使**Resharper**内联此方法，以便更新所有现有的呼叫站点。接下来，删除旧的、过时的重载。

# python - 这有效吗？我哪里出错了？（Python 菜单系统）

> ID：10905220
> 
> 赞同：0
> 
> 时间：2012-06-05T21:26:29.390
> 
> 标签：python, menu, while-loop, function

我正在创建一个简单的深度菜单系统。到目前为止，一切正常，除非您在比初始菜单系统更深的时候点击“0”（即在主菜单中选择任务 1 或任务 2 之后）。如果您在之后选择它，它会将您发送回显示子任务 1 和返回而不是比任务 1 和任务 2。

我的问题是：我该如何解决这个问题，这是一个高效的菜单系统吗？（即使我需要添加更多的“# Comment”行来解释它。）

```
# Multitasker - Deep Menu System
# A Menu that Allows the User to Select Tasks, Subtasks and Deeper Subtasks

# This is the initial screen.
def homescreen():
    print("""
            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
            X                                        X
            X     MULTITASKER - DEEP MENU SYSTEM     X
            X                                        X
            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
            X                                        X
            X             READY TO START?            X
            X          ---------------------         X
            X            PRESS THE 'ENTER'           X
            X              KEY TO BEGIN!             X
            X          ---------------------         X
            X                                        X
            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
         """,end=" ")

def task1():
    task1 = None
    while task1 != "0":
        print(
        """
            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
            X                                        X
            X     MULTITASKER - DEEP MENU SYSTEM     X
            X                                        X
            XXXX TASK OPTIONS XXXXXXXXXXXXXXXXXXXXXXXX
            X                                        X
            X   ----------------------------------   X
            X   1 - SUBTASK 1                        X
            X   2 - BACK                             X
            X   ----------------------------------   X
            X   0 - Quit                             X
            X                                        X
            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
            """, end=" ")

        task1 = input("\n\t\tPick a Choice Between 0-2:\t#")
        print()

# Exit
        if task1 == ('0'):
            homescreen()
            input(" ")
            menu = None

        elif task1 == ('1'):
            subtask1()
        elif task1 == ('2'):
            return
        else:
            notatask()

def subtask1():
    subtask1 = None
    while subtask1 != "0":
        print(
        """
            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
            X                                        X
            X     MULTITASKER - DEEP MENU SYSTEM     X
            X                                        X
            XXXX TASK OPTIONS XXXXXXXXXXXXXXXXXXXXXXXX
            X                                        X
            X   ----------------------------------   X
            X   1 - DEEP SUBTASK 1                   X
            X   2 - BACK                             X
            X   ----------------------------------   X
            X   0 - Quit                             X
            X                                        X
            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
            """, end=" ")

        subtask1 = input("\n\t\tPick a Choice Between 0-2:\t#")
        print()

# Exit
        if subtask1 == ('0'):
            homescreen()
            input(" ")
            menu = None

        elif subtask1 == ('1'):
            deepsubtask1()

        elif subtask1 == ('2'):
            return
        else:
            notatask()
def deepsubtask1():
    print("""
            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
            X                                        X
            X         THIS IS DEEP SUBTASK 1         X
            X                                        X
            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

                     PRESS 'ENTER' TO RETURN!
            """, end=" ")
    input(" ")

# TASK 2 

def task2():
    task2 = None
    while task2 != "0":
        print(
        """
            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
            X                                        X
            X     MULTITASKER - DEEP MENU SYSTEM     X
            X                                        X
            XXXX TASK OPTIONS XXXXXXXXXXXXXXXXXXXXXXXX
            X                                        X
            X   ----------------------------------   X
            X   1 - SUBTASK 2                        X
            X   2 - BACK                             X
            X   ----------------------------------   X
            X   0 - Quit                             X
            X                                        X
            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
            """, end=" ")

        task2 = input("\n\t\tPick a Choice Between 0-2:\t#")
        print()

# Exit
        if task2 == ('0'):
            homescreen()
            input(" ")
            menu = None

        elif task2 == ('1'):
            subtask2()
        elif task2 == ('2'):
            return
        else:
            notatask()

def subtask2():
    subtask2 = None
    while subtask2 != "0":
        print(
        """
            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
            X                                        X
            X     MULTITASKER - DEEP MENU SYSTEM     X
            X                                        X
            XXXX TASK OPTIONS XXXXXXXXXXXXXXXXXXXXXXXX
            X                                        X
            X   ----------------------------------   X
            X   1 - DEEP SUBTASK 2                   X
            X   2 - BACK                             X
            X   ----------------------------------   X
            X   0 - Quit                             X
            X                                        X
            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
            """, end=" ")

        subtask2 = input("\n\t\tPick a Choice Between 0-2:\t#")
        print()

# Exit
        if subtask2 == ('0'):
            homescreen()
            input(" ")
            menu = None

        elif subtask2 == ('1'):
            deepsubtask2()
        elif subtask2 == ('2'):
            return
        else:
            notatask()
def deepsubtask2():
    print("""
            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
            X                                        X
            X         THIS IS DEEP SUBTASK 2         X
            X                                        X
            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

                     PRESS 'ENTER' TO RETURN!
            """, end=" ")
    input(" ")

# Errors

def notatask():
    print("", end=" ")
def final():
    print("No More Tasks!")

# Makes choice equal to no actual selection or choice
homescreen()
menu = None
input(" ")
# Start the Main Menu
while menu != "0":
    print(
        """
            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
            X                                        X
            X     MULTITASKER - DEEP MENU SYSTEM     X
            X                                        X
            XXXX TASK OPTIONS XXXXXXXXXXXXXXXXXXXXXXXX
            X                                        X
            X   ----------------------------------   X
            X   1 - TASK 1                           X
            X   2 - TASK 2                           X
            X   ----------------------------------   X
            X   0 - Quit                             X
            X                                        X
            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
            """, end=" ")

    menu = input("\n\t\tPick a Choice Between 0-2:\t#")
    print()

    # Exit
    if menu == ('0'):
        print("""
            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
            X                                        X
            X     MULTITASKER - DEEP MENU SYSTEM     X
            X                                        X
            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
            X                                        X
            X              READY TO START?           X
            X           ---------------------        X
            X             PRESS THE 'ENTER'          X
            X               KEY TO BEGIN!            X
            X           ---------------------        X
            X                                        X
            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
        """,end=" ")
        input("                         ")
        menu()

    elif menu == ('1'):
        task1()
    elif menu == ('2'):
        task2()
    else:
        notatask() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T22:17:24.803

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T21:51:11.693

几个指针：

1.  干燥（不要重复自己）。每次您看到自己重复代码时，就该抽象出并创建一个函数或一个类，您可以从多个点调用它们，但只能在一个点进行调试和编辑。
2.  尝试找到一个已经可以满足您的需求的软件包，并从头开始编写菜单系统。这样您就可以专注于程序的实质内容。[Python 菜单系统](http://www.mikusa.com/projects/menuSystem)似乎可以提供您需要的一切。

# javascript - 如何根据当前页面高度调整具有渐变的图像大小？

> ID：10905221
> 
> 赞同：0
> 
> 时间：2012-06-05T21:26:34.813
> 
> 标签：javascript, css

我使用图像作为我网站的背景。它具有黑/白渐变，宽度为 1 像素。

CSS：

```
background-image:url('../image/gradient.png'); 
```

这使它重演。图像的高度为 2000 像素。

是否可以动态更改图像的高度，所以它适合所有页面尺寸：如果页面高度小于 2000px，则图像高度应该更小，如果页面高度更大，则图像应该更大。

提前致谢

我尝试了各种浏览器内渐变技术，但它们似乎在所有浏览器上都没有相同的效果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:58:06.860

我通常以两种方式之一来解决这个问题。

如果您可以使用 CSS3，则使用 CSS 渐变（我总是发现[http://colorzilla.com/gradient-editor/](http://colorzilla.com/gradient-editor/)是玩渐变的好选择），然后您可以将其设置为 100% 的窗口高度。

如果 CSS3 不是一个选项，我通常只选择一个高度，比如 500 像素，并为此制作一个渐变。然后，由于渐变通常从颜色 A 变为颜色 B，只需将基础背景颜色设置为与颜色 B 匹配，渐变将在所有显示器上类似地工作。

假设渐变从蓝色到黑色：

```
body {
    /* ensure body always fills viewport */
    min-height: 100%;

    /*gradient fades to black so set underlying BG to black*/
    background: url(/path/to/gradient.gif) repeat-x #000; 
}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T21:31:14.133

使用 CSS3，您可以使用[这里](http://css-tricks.com/how-to-resizeable-background-image/)`background-size: cover`讨论的其他一些技术。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T21:38:49.733

也许我没有得到你问题的正确背景，但这可以通过类似的东西轻松完成

```
#SomeImg.src {
width: 100%;
position: absolute;
top: 0;
left: 0;
} 
```

调整此页面的大小以查看它的操作：[http ://css-tricks.com/examples/ImageToBackgroundImage/](http://css-tricks.com/examples/ImageToBackgroundImage/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T21:49:05.747

您可以创建多个具有不同高度的图像并动态匹配最接近的图像尺寸。如果您这样做，您需要`window.resize`在用户调整窗口大小时绑定事件以更新图像。

```
window.onload = setBackgroundImage;
window.onresize = setBackgroundImage;

function setBackgroundImage() {
    var winH = 500;
    if (document.body && document.body.offsetWidth) {
        winH = document.body.offsetHeight;
    } else if (document.compatMode=='CSS1Compat' && document.documentElement && document.documentElement.offsetWidth ) {
        winH = document.documentElement.offsetHeight;
    } else if (window.innerWidth && window.innerHeight) {
        winH = window.innerHeight;
    }

    if (winH > 400) {
        document.body.style.backgroundImage = "url('../image/gradient800px.png')";
    } else if (winH > 800) {
        document.body.style.backgroundImage = "url('../image/gradient1000px.png')";
    } else if (winH > 1000) {
        document.body.style.backgroundImage = "url('../image/gradient1500px.png')";
    } else if (winH > 1500) {
        document.body.style.backgroundImage = "url('../image/gradient2000px.png')";
    } else {
        document.body.style.backgroundImage = "url('../image/gradient400px.png')";
    }
} 
```

我不认为该解决方案非常漂亮，但它应该可以工作。

# objective-c - 表达式结果未使用objective-c

> ID：10905225
> 
> 赞同：0
> 
> 时间：2012-06-05T21:27:02.153
> 
> 标签：objective-c, xcode

我对此很不满意。有人可以告诉我如何解决这个问题吗？

```
#include <stdio.h>

int main(int argc, const char * argv[])
{    
    int sum;   
    sum = 50 + 25;
    "The sum of 50 and 25 is %i", sum ;

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T21:32:14.747

换行：

```
"The sum of 50 and 25 is %i", sum ; 
```

至：

```
printf( "The sum of 50 and 25 is %i", sum ); 
```

引号中的行本身就是一个语法错误，恰好是由编译器得到的（这显然是在抛出一个警告）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T21:29:55.233

由于未使用总和值，您会收到此警告。打印它使用 NSLog

# mysql - MySQL my.cnf 性能调优建议

> ID：10905226
> 
> 赞同：24
> 
> 时间：2012-06-05T21:27:03.860
> 
> 标签：mysql, optimization, performance, my.cnf

我有点希望有人可以提供一些帮助来优化 my.cnf 文件以用于超大容量的 mysql 数据库服务器。

```
Our architecture is as follows:

Memory     : 96GB
CPUs       : 12
OS & Mysql : 64-bit
Disk Space : 1.2 TB
DB Engine  : MyISAM 
```

我们的 Web 应用程序同时被大约 300 个客户使用。我们需要对 my.cnf 进行调整，以便为该基础架构提供最佳性能。

我完全知道索引和优化查询是其中的一个主要因素，但我们希望从一个配置正确的系统开始，然后相应地系统地重新设计我们的查询。

```
Here is our current my.cnf file content:

[mysqld]
datadir=/home/mysql
socket=/home/mysql/mysql.sock
user=mysql

log-bin=mysql-bin
server-id=1
# Disabling symbolic-links is recommended to prevent assorted security risks
symbolic-links=1

log-slow-queries = /var/log/mysqld_slow_queries.log
long_query_time = 10

max_connections = 500

key_buffer_size = 32768M
#max_allowed_packet = 2M
#table_open_cache = 128
#sort_buffer_size = 1024K
#net_buffer_length = 64K
#read_buffer_size = 1024K
#read_rnd_buffer_size = 1024K
#myisam_sort_buffer_size = 8M
query_cache_size = 128M
query_cache_limit = 128M

interactive_timeout = 300
wait_timeout = 300

# Added values after load testing
thread_cache_size = 8
#tmp_table_size = 256M
#max_heap_table_size = 256M
#table_cache = 512
#join_buffer_size = 512

log-error=/var/log/mysqld.log

innodb_buffer_pool_size=128M
#innodb_file_per_table
#innodb_log_file_size=250M
##innodb_buffer_pool_size=64M
#innodb_buffer_pool_size=1024M
#innodb_log_buffer_size=4M
##log-bin=mysql-bin

[mysqld_safe]
log-error=/var/log/mysqld.log
pid-file=/var/run/mysqld/mysqld.pid

#[myisamchk]
#key_buffer = 64M
#sort_buffer = 64M
#read_buffer = 16M
#write_buffer = 16M 
```

有什么建议么？谢谢各位。

由 RolandoMySQLDBA 编辑

由于您的所有数据都是 MyISAM，请运行此查询并显示输出

```
SELECT CONCAT(ROUND(KBS/POWER(1024,
IF(PowerOf1024<0,0,IF(PowerOf1024>3,0,PowerOf1024)))+0.4999),
SUBSTR(' KMG',IF(PowerOf1024<0,0,
IF(PowerOf1024>3,0,PowerOf1024))+1,1))
recommended_key_buffer_size FROM
(SELECT LEAST(POWER(2,32),KBS1) KBS
FROM (SELECT SUM(index_length) KBS1
FROM information_schema.tables
WHERE engine='MyISAM' AND
table_schema NOT IN ('information_schema','mysql')) AA ) A,
(SELECT 3 PowerOf1024) B; 
```

@ Rolando - 谢谢...该查询的结果是 4G。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-05T21:52:50.283

尝试从 Percona 向导开始，并将他们的建议与您当前的设置一一进行比较。不要担心没有你想象的那么多适用的设置。

[https://tools.percona.com/wizard](https://tools.percona.com/wizard)

**大约在 2020 年更新**：抱歉，此工具已报废：[https ://www.percona.com/blog/2019/04/22/end-of-life-query-analyzer-and-mysql-configuration-generator/](https://www.percona.com/blog/2019/04/22/end-of-life-query-analyzer-and-mysql-configuration-generator/)

每个人都指向`key_buffer_size`你提到的第一个。使用 96GB 内存，我会警惕任何微小的默认值（可能只有 96M！）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-05-18T08:00:18.210

我尝试了这个工具，它给了我很好的结果。

[https://github.com/major/MySQLTuner-perl](https://github.com/major/MySQLTuner-perl)

# php - 用 PHP 构建搜索脚本

> ID：10905228
> 
> 赞同：0
> 
> 时间：2012-06-05T21:27:05.900
> 
> 标签：php, sql, search, autocomplete

我正在尝试在 PHP-SQL 中构建一个搜索脚本，例如 Facebook 或 Stackoverflow 使用。例如，用户可以输入多个条目；用分号分隔并在每个术语上自动完成。另外：这些值将存储在 SQL 中；那么我应该使用什么类型的数据或者我应该如何在 SQL 表中插入这些术语？

```
<script type="text/javascript">
 $().ready(function() {
 $("#job_type").autocomplete("get_job_list.php",
 { width: 224, matchContains: true, selectFirst: false }); });
 </script> 
```

PHP代码::

```
<?php 
require_once "connection.php";
$q = strtolower($_GET["q"]);
if (!$q) return;
$sql = "select DISTINCT itemid as itemid from eportal where itemid LIKE '%$q%'";
$rsd = mysql_query($sql);
while($rs = mysql_fetch_array($rsd)) {
    $cname = $rs['itemid']; echo "$cname\n"; 
} 
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T21:45:04.453

将所选标签添加到具有结构的表中`query_id tag_id`（您还需要一个`tags`具有结构的表`tag_id tag_name`。这样您的查询将更加轻松快捷。此外，您将能够轻松获得最流行的标签。SQL 用于像这样存储数据。使用逗号分隔值违反了 SQL 的基础。

# asp.net-mvc - 分层 ASP.NET MVC Web 应用程序

> ID：10905231
> 
> 赞同：0
> 
> 时间：2012-06-05T21:27:21.490
> 
> 标签：asp.net-mvc, n-tier-architecture, separation-of-concerns

当我开发 WinForms 或 WebForms 应用程序时，我会创建一个解决方案并添加多个项目。BOL 项目是一个用于业务对象的类库，有一个用于 ADO.NET 相关内容的 SQL 和一个 DAL 项目，我有一个实用程序项目，其中包含用于验证等内容的类。现在我通常称之为 GUI 的表示层包含了表单。这些表单直接与 BOL 一起工作，BOL 连接到连接到 DAL 的 SQL 等......

我相信你们都已经知道了，所以这就是我感到困惑的地方。在使用 MVC 时，我看到的项目都包含这种类型的功能，但都在一个项目中，只是分成文件夹。我查看了 Nerd Dinner 应用程序，甚至这一切都在一个项目中。最终结果是一个 DLL 来处理这一切。这是一个好主意，还是你们将这些部分分成不同的项目？通常一个 DLL 必须通过另一个 DLL 才能达到数据访问 DLL 类型的东西。也许我只是对整个概念感到困惑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T21:39:56.570

您始终可以将此逻辑层分成单独的物理层（项目）。您可以为您的实体创建一个单独的项目，为您的数据访问代码创建一个项目等。

这是我为我最近的一个项目所做的结构

**1) UI**：标准的 MVC 项目，带有 UI 相关的东西。控制器和视图以及相关的 CSS 内容和脚本。

**2）实体**：类库项目。我的业务实体在这里。这些只是代表我的域模式的 POCO（我将其用于 CodeFirst 数据库生成）。

**3）数据访问**：类库项目。我在这里有我的数据访问代码。存储库、接口和我的 DBContext 类也是如此。

**4）测试：**我的单元测试在这个项目中。

**UI 项目引用了我的实体和我的数据访问项目。**

**数据访问项目引用了我的实体，因为我的存储库方法返回对象。**

我的 UI 项目 ViewModels 文件夹中也有几个 ViewModel 类。我在某些屏幕上使用它，我必须显示来自多个域对象的数据。我有一个映射/服务类，它将域对象映射到视图模型对象。如果您的项目是 bifg，您可以将其作为一个单独的项目保留在同一解决方案下。

解决方案看起来像这样。（这是我正在做的一个开源项目）

![在此处输入图像描述](../Images/51d9d5ac8da03dafedcd5c6ec9c5bf49.png)

# php - html文件中的php脚本

> ID：10905234
> 
> 赞同：1
> 
> 时间：2012-06-05T21:27:26.093
> 
> 标签：php, html

我正在开发一个应用程序，我在其中从相机捕获图像并将它们在线流式传输。要捕获图像，我正在使用 opencv 代码。它将图像存储（重写）在服务器上的同一图像文件中。然后该图像在线流式传输。但是，如果流式传输和存储同时发生，则图像会损坏。所以我使用系统锁同步了这些进程。检查每 2 秒重新加载图像的 html 页面检查 img 文件是否具有系统锁定。如果是，那么它不会重新加载图像。因此，要检查文件是否被锁定，我必须在我的 html 文件中放入一些 php 代码。我相信我的代码在语法上是正确的。然而，它没有提供所需的输出。

```
 <html>

 <head>

 <!--to keep requesting the server new page without displaying the image from the cache pragma
  is used -->
 <META HTTP-EQUIV="Pragma" CONTENT="no-cache">

 <title>YOUR SITE TITLE GOES HERE</title>
 <style type="text/css">
    #imgJSselbox{
        position: absolute;
        margin: 0px;
        padding: 0px;
        visibility: hidden;
        width: 0px;
        height: 0px;
        border: 1px solid #006;
        color: #fff;
        background-image: url(selection_area.gif);
        z-index: 20;
    }
 </style>
 <script type="text/javascript" src="globalvar.js"></script>
 <script language="Javascript">

       var x = 2;
       var y = 1;
       var now;

  function startClock() {
        x = x-y;
        document.form1.clock.value = x;
   <?php
       $fp1=fopen("a.jpg","r");
       $fp2=fopen("b.jpeg","r");
       if(flock($fp1,LOCK_EX|LOCK_NB)==0 && flock($fp2,LOCK_EX|LOCK_NB)==0)
     $x=1;
       else
     $x=0;
    ?>

    var ch;
    ch=<?php echo $x; ?>

     if (x < 1 && ch==1) reload();
    <?php
        $fp1=fopen("a.jpg","r");
        $fp2=fopen("b.jpeg","r");
        flock($fp1,LOCK_UN); 
        flock($fp2,LOCK_UN);
    ?>
    timerID = setTimeout("startClock()", 1000);
   }

   function reload()
   {
        now = new Date();
         <!-- to pass the new image to the src -->
        var camImg = "a.jpg" + "?" + now.getTime();
        document.campicture.src = camImg;
        var crpImg = "b.jpeg" + "?" + now.getTime();
        document.croppic.src = crpImg;  

  x = 2;
        document.form1.clock.value = x; 
    }

    </script>
    <script type="text/javascript" src="image_cropper.js">
    document.form1.x-coord.value=x1;
    document.write(x1);

    </script>

    <script>
    function window.open('im','imgg')
    {
           window.open('im','imgg');
    }
    </script>
    </head>
     <body bgcolor="white" onLoad="startClock()">

    <center>

     <font size=-1>

     <h1>AYS WEBCAM PAGE</h1>

     <h2>This page loads images and refreshes them after every given interval of time keeping
     the same name of the image file</h2><p><br />
<div id="imgJSselbox"></div>
</center>
      <img name="campicture" src="a.jpg" id="testimage" border=1 width=640 height=480
       alt="AYS    
         founder's IMAGE" onClick="getImageCropSelectionPoint
        'testimage',event,document.form1);">
             ====>>ROI==>> 

<img name="croppic" src="b.jpeg" width=320 height=240 alt="cropped_image">
<center>
       <form NAME="form1"action="image_cropper.php" method="POST"><b><font size="-1"
       face="Arial">AutoReload in :==> </font>

        <input TYPE="text" NAME="clock" SIZE="2" VALUE="5"> <font size="-1"
        face="Arial">seconds.</font></b><br />
<br><br><input type="button" value="Crop" onclick= setImageCropAreaSubmit
       ("image_cropper.php",'testimage')><br><br>
       </center>
       <!-- <input type="text" name="x-coord" value=""><br>
 <input type="text" name="y-coord" value=""><br>
 <input type="text" name="wid" value="" ><br>
 <input type="text" name="hght" value="" ><br>
       -->
       </form>
       </body>

      </html> 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:21:55.777

您的问题出在代码中`timerID = setTimeout("startClock()", 1000);`。

改为使用 `timerID = setTimeout(startClock, 1000);`。

请参阅[window.setTimeout-MDN](https://developer.mozilla.org/en/DOM/window.setTimeout)。

# mysql - 尝试为 rails spree 项目创建 mysql 数据库时出错

> ID：10905236
> 
> 赞同：0
> 
> 时间：2012-06-05T21:27:29.313
> 
> 标签：mysql, ruby-on-rails, activerecord, yaml

当我尝试使用 mysql 数据库将 spree 安装到新的 rails 项目时，出现以下错误。安装 spree 我得到以下错误，我不是 100% 如何解决它：

```
/Users/.rvm/gems/ruby-1.9.2-p290/gems/activerecord-  3.2.5/lib/active_record/connection_adapters/abstract/connection_pool.rb:404:in `retrieve_connection': ActiveRecord::ConnectionNotEstablished (ActiveRecord::ConnectionNotEstablished)
from /Users/.rvm/gems/ruby-1.9.2-p290/gems/activerecord-3.2.5/lib/active_record/connection_adapters/abstract/connection_specification.rb:168:in `retrieve_connection'
from /Users/.rvm/gems/ruby-1.9.2-p290/gems/activerecord-3.2.5/lib/active_record/connection_adapters/abstract/connection_specification.rb:142:in `connection'
from /Users/.rvm/gems/ruby-1.9.2-p290/gems/activerecord-3.2.5/lib/active_record/model_schema.rb:228:in `columns'
from /Users/.rvm/gems/ruby-1.9.2-p290/gems/activerecord-3.2.5/lib/active_record/model_schema.rb:248:in `column_names'
from /Users/.rvm/gems/ruby-1.9.2-p290/gems/rd_searchlogic-3.0.1/lib/searchlogic/named_scopes/ordering.rb:61:in `ordering_condition_details'
from /Users/.rvm/gems/ruby-1.9.2-p290/gems/rd_searchlogic-3.0.1/lib/search logic/named_scopes/ordering.rb:52:in `method_missing'
from /Users/.rvm/gems/ruby-1.9.2-p290/gems/spree_core-0.40.0/lib/spree_core/find_by_param.rb:105:in `<class:Base>'
from /Users/.rvm/gems/ruby-1.9.2-p290/gems/spree_core-0.40.0/lib/spree_core/find_by_param.rb:104:in `<top (required)>'
from /Users/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:251:in `require'
from /Users/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:251:in `block in require'
from /Users/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:236:in `load_dependency'
from /Users/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:251:in `require'
from /Users/.rvm/gems/ruby-1.9.2-p290/gems/spree_core-0.40.0/lib/spree_core.rb:47:in `<top (required)>'
from /Users/.rvm/gems/ruby-1.9.2-p290/gems/spree-0.40.0/lib/spree.rb:1:in `require'
from /Users/.rvm/gems/ruby-1.9.2-p290/gems/spree-0.40.0/lib/spree.rb:1:in `<top (required)>'
from /Users/.rvm/gems/ruby-1.9.2-p290/gems/bundler-1.1.3/lib/bundler/runtime.rb:68:in `require'
from /Users/.rvm/gems/ruby-1.9.2-p290/gems/bundler-1.1.3/lib/bundler/runtime.rb:68:in `block (2 levels) in require'
from /Users/.rvm/gems/ruby-1.9.2-p290/gems/bundler-1.1.3/lib/bundler/runtime.rb:66:in `each'
from /Users/.rvm/gems/ruby-1.9.2-p290/gems/bundler-1.1.3/lib/bundler/runtime.rb:66:in `block in require'
from /Users/.rvm/gems/ruby-1.9.2-p290/gems/bundler-1.1.3/lib/bundler/runtime.rb:55:in `each'
from /Users/.rvm/gems/ruby-1.9.2-p290/gems/bundler-1.1.3/lib/bundler/runtime.rb:55:in `require'
from /Users/.rvm/gems/ruby-1.9.2-p290/gems/bundler-1.1.3/lib/bundler.rb:119:in `require'
from /Users/Downloads/blind-love/blind-love/config/application.rb:7:in `<top (required)>'
from /Users/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.5/lib/rails/commands.rb:24:in `require'
from /Users/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.5/lib/rails/commands.rb:24:in `<top (required)>'
from script/rails:6:in `require'
from script/rails:6:in `<main>'
    precompiling  assets
    rake aborted!
    ActiveRecord::ConnectionNotEstablished 
```

我的数据库yaml文件如下：-

```
development:
adapter: mysql2
encoding: utf8
reconnect: false
database: blind_development
pool: 5
username: root
password:
socket: /tmp/mysql.sock

test:
adapter: mysql2
encoding: utf8
reconnect: false
database: blind_test
pool: 5
username: root
password:
socket: /tmp/mysql.sock

production:
adapter: mysql2
encoding: utf8
reconnect: false
database: blind_production
pool: 5
username: root
password:
socket: /tmp/mysql.sock 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T10:09:00.510

使用delayed_job 时遇到同样的问题，还没有找到解决方法。

编辑：我的问题是当我尝试使用它时，我认为活动记录尚未完全设置。当我通过我需要运行到 application.rb 中的 config.after_initialize 的块时，问题就消失了。

# c# - 带 Prism 区域适配器的 AvalonDock

> ID：10905238
> 
> 赞同：6
> 
> 时间：2012-06-05T21:27:36.693
> 
> 标签：c#, wpf, prism, avalondock

我已经看到了一些关于 SO 的问题，但它们似乎都不适合我。我希望能够将出色的[Avalondock 2.0](http://avalondock.codeplex.com/wikipage?title=Version2Concept&referringTitle=Home)与 Prism 4 一起使用。但是，所有示例区域适配器都适用于 Avalondock 1.x 系列，我无法让它工作。

有没有人有关于如何为 AvalonDock 的 LayoutDocumentPane 和 LayoutAnchorablePane 创建区域适配器的示例代码？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-11T07:02:42.877

不幸的是，据我所知，“LayoutDocumentPane”和“LayoutAnchorablePane”都不允许包含/创建 RegionAdapters，但是“DockingManager”可以。一种解决方案是为 DockingManager 创建一个**RegionAdapter，**然后它将管理可视树中“LayoutDocuments”的实例化。

xaml 如下所示：

```
<ad:DockingManager Background="AliceBlue" x:Name="WorkspaceRegion" prism:RegionManager.RegionName="WorkspaceRegion">
                        <ad:LayoutRoot>
                            <ad:LayoutPanel>
                                <ad:LayoutDocumentPaneGroup>
                                    <ad:LayoutDocumentPane>

                                    </ad:LayoutDocumentPane>
                                </ad:LayoutDocumentPaneGroup>
                            </ad:LayoutPanel>
                        </ad:LayoutRoot>
                    </ad:DockingManager> 
```

请注意，该区域是在 DockingManager 标记中定义的，并且在 LayoutPanel 下存在一个 LayoutDocumentPaneGroup。LayoutDocumentPaneGroup 下的 LayoutDocumentPane 将托管与要添加到“WorkspaceRegion”的视图相关联的 LayoutDocuments。

至于 RegionAdapter 本身，请参阅下面的代码，我提供了解释性注释

```
#region Constructor

        public AvalonDockRegionAdapter(IRegionBehaviorFactory factory)
            : base(factory)
        {
        }

        #endregion  //Constructor

        #region Overrides

        protected override IRegion CreateRegion()
        {
            return new AllActiveRegion();
        }

        protected override void Adapt(IRegion region, DockingManager regionTarget)
        {
            region.Views.CollectionChanged += delegate(
                Object sender, NotifyCollectionChangedEventArgs e)
                {
                    this.OnViewsCollectionChanged(sender, e, region, regionTarget);
                };

            regionTarget.DocumentClosed += delegate(
                            Object sender, DocumentClosedEventArgs e)
            {
                this.OnDocumentClosedEventArgs(sender, e, region);
            };
        }

        #endregion  //Overrides

        #region Event Handlers

        /// <summary>
        /// Handles the NotifyCollectionChangedEventArgs event.
        /// </summary>
        /// <param name="sender">The sender.</param>
        /// <param name="e">The event.</param>
        /// <param name="region">The region.</param>
        /// <param name="regionTarget">The region target.</param>
        void OnViewsCollectionChanged(object sender, NotifyCollectionChangedEventArgs e, IRegion region, DockingManager regionTarget)
        {
            if (e.Action == NotifyCollectionChangedAction.Add)
            {
                foreach (FrameworkElement item in e.NewItems)
                {
                    UIElement view = item as UIElement;

                    if (view != null)
                    {
                        //Create a new layout document to be included in the LayoutDocuemntPane (defined in xaml)
                        LayoutDocument newLayoutDocument = new LayoutDocument();
                        //Set the content of the LayoutDocument
                        newLayoutDocument.Content = item;

                        ViewModelBase_2 viewModel = (ViewModelBase_2)item.DataContext;

                        if (viewModel != null)
                        {
                            //All my viewmodels have properties DisplayName and IconKey
                            newLayoutDocument.Title = viewModel.DisplayName;
                            //GetImageUri is custom made method which gets the icon for the LayoutDocument
                            newLayoutDocument.IconSource = this.GetImageUri(viewModel.IconKey);
                        }

                        //Store all LayoutDocuments already pertaining to the LayoutDocumentPane (defined in xaml)
                        List<LayoutDocument> oldLayoutDocuments = new List<LayoutDocument>();
                        //Get the current ILayoutDocumentPane ... Depending on the arrangement of the views this can be either 
                        //a simple LayoutDocumentPane or a LayoutDocumentPaneGroup
                        ILayoutDocumentPane currentILayoutDocumentPane = (ILayoutDocumentPane)regionTarget.Layout.RootPanel.Children[0];

                        if (currentILayoutDocumentPane.GetType() == typeof(LayoutDocumentPaneGroup))
                        {
                            //If the current ILayoutDocumentPane turns out to be a group
                            //Get the children (LayoutDocuments) of the first pane
                            LayoutDocumentPane oldLayoutDocumentPane = (LayoutDocumentPane)currentILayoutDocumentPane.Children.ToList()[0];
                            foreach (LayoutDocument child in oldLayoutDocumentPane.Children)
                            {
                                oldLayoutDocuments.Insert(0, child);
                            }
                        }
                        else if (currentILayoutDocumentPane.GetType() == typeof(LayoutDocumentPane))
                        {
                            //If the current ILayoutDocumentPane turns out to be a simple pane
                            //Get the children (LayoutDocuments) of the single existing pane.
                            foreach (LayoutDocument child in currentILayoutDocumentPane.Children)
                            {
                                oldLayoutDocuments.Insert(0, child);
                            }
                        }

                        //Create a new LayoutDocumentPane and inserts your new LayoutDocument
                        LayoutDocumentPane newLayoutDocumentPane = new LayoutDocumentPane();
                        newLayoutDocumentPane.InsertChildAt(0, newLayoutDocument);

                        //Append to the new LayoutDocumentPane the old LayoutDocuments
                        foreach (LayoutDocument doc in oldLayoutDocuments)
                        {
                            newLayoutDocumentPane.InsertChildAt(0, doc);
                        }

                        //Traverse the visual tree of the xaml and replace the LayoutDocumentPane (or LayoutDocumentPaneGroup) in xaml
                        //with your new LayoutDocumentPane (or LayoutDocumentPaneGroup)
                        if (currentILayoutDocumentPane.GetType() == typeof(LayoutDocumentPane))
                            regionTarget.Layout.RootPanel.ReplaceChildAt(0, newLayoutDocumentPane);
                        else if (currentILayoutDocumentPane.GetType() == typeof(LayoutDocumentPaneGroup))
                        {
                            currentILayoutDocumentPane.ReplaceChild(currentILayoutDocumentPane.Children.ToList()[0], newLayoutDocumentPane);
                            regionTarget.Layout.RootPanel.ReplaceChildAt(0, currentILayoutDocumentPane);
                        }
                        newLayoutDocument.IsActive = true;
                    }
                }
            }
        }

        /// <summary>
        /// Handles the DocumentClosedEventArgs event raised by the DockingNanager when
        /// one of the LayoutContent it hosts is closed.
        /// </summary>
        /// <param name="sender">The sender</param>
        /// <param name="e">The event.</param>
        /// <param name="region">The region.</param>
        void OnDocumentClosedEventArgs(object sender, DocumentClosedEventArgs e, IRegion region)
        {
            region.Remove(e.Document.Content);
        }

        #endregion  //Event handlers 
```

不要忘记在您的引导程序中添加以下代码，以便 Prism 知道您的 RegionAdapter 的存在

```
protected override RegionAdapterMappings ConfigureRegionAdapterMappings()
        {
            // Call base method
            var mappings = base.ConfigureRegionAdapterMappings();
            if (mappings == null) return null;

            // Add custom mappings
            mappings.RegisterMapping(typeof(DockingManager),
                ServiceLocator.Current.GetInstance<AvalonDockRegionAdapter>());

            // Set return value
            return mappings;
        } 
```

瞧。我知道这不是最干净的解决方案，但它应该可以工作。同样的方法可以很容易地应用于“LayoutAnchorablePane”。

健康长寿·繁荣昌盛！

# vb.net - Visual Basic 中的动态图片框

> ID：10905246
> 
> 赞同：1
> 
> 时间：2012-06-05T21:28:43.750
> 
> 标签：vb.net, winforms

我已经创建了一个带有 PictureBox 的表单，并希望在程序运行时在表单上动态创建另一个 PictureBox（在静态的左侧）。我写了这段代码：

```
Dim temp As PictureBox
temp = New PictureBox
temp.Image = StaticPictureBox.Image
temp.Visible = True
temp.Top = StaticPictureBox.Top
temp.Width = StaticPictureBox.Width
temp.Height = StaticPictureBox.Height
temp.Left = StaticPictureBox.Left - 20
temp.BringToFront() 
```

当我运行这段代码时，我可以检测到临时 PictureBox 确实被创建了。但是，它不会呈现在表单上。它似乎在那里，但却是无形的。

有谁知道我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T21:38:21.780

您需要将其添加到表单的控件集合中：

```
Me.Controls.Add(temp) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T22:47:02.527

为什么不直接删除该代码并在另一个旁边放置一个图片框并设置：

```
newpicturebox.visible = false 
```

然后，每当您完成操作时，您就会对其进行更改：

```
newpicturebox.visible = true 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T04:35:46.073

I know this is old but... you got an error here:

```
temp.Left = StaticPictureBox.Left - 20 
```

should be:

```
temp.Left = StaticPictureBox.right + 20 
```

or:

```
temp.Left = StaticPictureBox.right 
```

hope it helped.

# php - PHP SimpleTest HtmlReporter 详细报告通过

> ID：10905249
> 
> 赞同：1
> 
> 时间：2012-06-05T21:28:55.117
> 
> 标签：php, unit-testing, tdd, simpletest

如何增加 SimpleTest 的 HtmlReporter 的详细程度？

有时查看应用程序通过了哪些测试以及失败的测试是很方便的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-01-22T15:42:56.560

给出的输出仍然很丑陋，这就是我格式化输出的方式：

```
class ShowPasses extends HtmlReporter {
    var $tests = array();

    function paintPass($message) {
        parent::paintPass($message);
        $pass =  "<span class=\"pass\">Pass</span>: ";
        $breadcrumb = $this->getTestList();
        array_shift($breadcrumb);
        if(!in_array($breadcrumb[1],$this->tests))
        {
            echo "<h2><u>".$breadcrumb[1]."</u><h2>";
            $this->tests[] = $breadcrumb[1];
        }
        echo "<h4>$pass".$breadcrumb[2]."</h4>";
    }

    function _getCss() {
        return parent::_getCss() . ' .pass { color: green; }';
    }
}

class AllTests extends TestSuite {
    function AllTests() {
        $this->TestSuite('All tests');
        $this->addFile(dirname(__FILE__).'/testRequest.php');
        $this->addFile(dirname(__FILE__).'/testTraductor.php');
        $this->addFile(dirname(__FILE__).'/testReservar.php');

        //para poder usar por consola
        //$this->run(new TextReporter());
        $this->run(new ShowPasses());
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T21:43:40.210

好吧，看来我需要更多咖啡才能在 Google 取得成功；）

他们实际上在一个教程中回答了我的问题，只是一个索引很差的问题。

要点是我们只需扩展一个 HtmlReporter 并定义我们的报告功能。他们为什么不把它作为一个选项，它一直让我感到困惑。

[http://simpletest.org/en/display_subclass_tutorial.html](http://simpletest.org/en/display_subclass_tutorial.html)

```
class ShowPasses extends HtmlReporter {

    function paintPass($message) {
        parent::paintPass($message);
        print "<span class=\"pass\">Pass</span>: ";
        $breadcrumb = $this->getTestList();
        array_shift($breadcrumb);
        print implode("->", $breadcrumb);
        print "->$message<br />\n";
    }

    protected function getCss() {
        return parent::getCss() . ' .pass { color: green; }';
    }
} 
```

# c++ - 隐藏应用程序资源

> ID：10905250
> 
> 赞同：4
> 
> 时间：2012-06-05T21:28:58.120
> 
> 标签：c++, resources, sfml

我正在用 C++ 中的 SFML 1.6 制作一个简单的游戏。当然，我有很多图片、关卡和数据文件。问题是，我不希望这些文件可见。现在它们只是`res/`子目录中的普通图片文件，我想隐藏它们或加密它们。是否可以将文件中的原始数据放入资源文件或其他东西中？任何解决方案对我来说都可以，我只是不希望文件暴露给用户。

**编辑**

最好的跨平台解决方案，但如果它们不存在，那没关系，我正在使用 Windows。但如果不需要，我真的不想使用图书馆。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T22:07:37.173

大多数环境都带有一个资源编译器，它将图像/图标/等转换为字符串数据并将它们包含在源代码中。

另一种常见的技术是将它们复制到最终 .exe 的末尾，作为构建过程的最后一部分。然后在运行时，将 .exe 作为文件打开并从某个确定的偏移量读取数据，请参阅[在可执行文件中嵌入文件系统？](https://stackoverflow.com/questions/6546651/embedding-a-filesystem-in-an-executable)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T12:58:54.760

理想的方法是制作您自己的存档格式，该格式将包含您的所有文件数据以及在其中明确拆分文件所需的一些额外信息。

# php - 有条件的 .htaccess 重定向 - 根据 url 重定向到两个不同的页面

> ID：10905252
> 
> 赞同：0
> 
> 时间：2012-06-05T21:28:59.790
> 
> 标签：php, .htaccess, redirect, conditional

我的网站功能有点像9gag或damnlol等，当用户访问一个item页面时，例如：site.com/104-funny-thing，重写规则重定向到view.php?id=104-funny-thing。在这里，URL 在第一个“-”之后被删除了所有内容。所以我们只剩下 id，在这种情况下：104，查询获取项目。

这是规则：

```
RewriteRule ^([A-Za-z0-9-]+)$ view.php?id=$1 
```

我想要的是同样的 URL 格式也可以用来打开用户配置文件。例如：site.com/salman，这个 URL 应该打开 profile.php?username=salman。

我想通过 PHP 做到这一点。我可以将同一个文件 view.php 用于这两个目的。一旦完成 URL 的解析，如果我得到一个数值，我将包含 item.php 页面并相应地查询和显示数据。如果它不是数字，那么我可以包含 profile.php 页面并显示配置文件。这在理论上应该可以完美地工作，但我想尝试的是，如果有办法直接使用 .htaccess 进行重定向，我更愿意使用该选项，因为前一个选项需要额外的工作来解决解决方案中的一些问题原因。

擅长 htaccess（正则表达式代码？）的人可能能够提供解决方案。这里有一些进一步的解释：

*   用户名可以包含数字，但不能只包含数字
*   用户名 URL 不能包含“-”
*   项目 ID 不能包含字母
*   URL 104-funny、104- 和 104，都适用于 view.php

感谢您在高级方面的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T10:08:27.257

```
#article urls
RewriteRule ^([0-9]+)(-.*)?$ view.php?id=$1

#profile urls.
RewriteRule ^([A-Za-z0-9]+)$ profile.php?username=$1 
```

# objective-c - 重新加载 TableView 的数据？

> ID：10905265
> 
> 赞同：0
> 
> 时间：2012-06-05T21:30:34.803
> 
> 标签：objective-c, tableview, xcode4.3

我正在尝试使用 Xcode 4.3 构建一个 hello world 应用程序。

到目前为止，我有一个 TableView（从对象列表中拖放）和一个 TableViewCell（也从对象列表中拖放）。

我也有一个数组，我的 TableView 可以工作并从数组中获取数据，但是如何重新加载 TableView 的数据？我试过`[self.tableView reloadData];`了，但它不起作用。当我键入`[self.`时，`tableView`不在我的选项中...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T21:36:41.210

要将 NSTableView 作为类的属性，您必须将其声明为一个。

在你的类的界面中添加：

```
@property (weak) IBOutlet NSTableView *tableView; 
```

在实现中添加：

```
@synthesize tableView; 
```

然后在 Interface Builder 中，通过右键单击“File's Owner”并将“tableView”中的一条线拖到您的表格视图中，将表格视图连接到您的类的 tableView 插座。

# c# - 使用精确的 HTML 搜索或将 HTMLElement 转换为 HTMLNode 获取 HtmlAgilityPack 节点

> ID：10905270
> 
> 赞同：2
> 
> 时间：2012-06-05T21:31:11.363
> 
> 标签：c#, browser, html-agility-pack

我使用默认的 .net WebBrowser 创建了一个 HTMLElement 选择器 (DOM)。用户可以通过单击来选择（选择）一个 HTMLElement。

我想获取与 HTMLElement 对应的 HtmlAgilityPack.HTMLNode。

最简单的方法（在我看来）是使用 doc.DocumentNode.SelectSingleNode(EXACTHTMLTEXT) 但它并没有真正起作用（因为该函数只接受 xpath 代码）。

我怎样才能做到这一点？

用户选择的示例 HTMLElement 如下所示（OuterHtml 代码）：

```
<a onmousedown="return wow" class="l" href="http://site.com"><em>Great!!!</em> <b>come and see more</b></a> 
```

当然，可以选择任何元素，这就是为什么我需要一种获取 HTMLNode 的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T18:53:38.297

相同的概念，但更简单一些，因为您不必知道元素类型：

```
HtmlNode n = doc.DocumentNode.Descendants().Where(n => n.OuterHtml.Equals(text, StringComparison.InvariantCultureIgnoreCase)).FirstOrDefault(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T01:17:37.463

我想出了一个解决方案。不知道这是否是最好的（如果有人知道实现这一目标的更好方法让我知道，我将不胜感激）。

**这是将获取 HTMLNode 的类：**

```
public HtmlNode GetNode(string text)
        {

            if (text.StartsWith("<")) //get the type of the element (a, p, div etc..)
            {
                string type = "";
                for (int i = 1; i < text.Length; i++)
                {
                    if (text[i] == ' ')
                    {
                        type = text.Substring(1, i - 1);
                        break;
                    }
                }

                try //check to see if there are any nodes of your HTMLElement type that have an OuterHtml equal to the HtmlElement Outer HTML. If a node exist, than that's the node we want to use
                {
                    HtmlNode n = doc.DocumentNode.SelectNodes("//" + type).Where(x => x.OuterHtml == text).First();
                    return n;
                }
                catch (Exception)
                {
                    throw new Exception("Cannot find the HTML element in the HTML Page");
                }
            }
            else
            {
                throw new Exception("Invalid HTML Element supplied. The selected HTML element must start with <");
            }
        } 
```

这个想法是您传递 HtmlElement 的 OuterHtml。例子：

```
HtmlElement el=....
HtmlNode N = GetNode(el.OuterHtml); 
```

# python - numexpr 中的自动 float32 提升

> ID：10905272
> 
> 赞同：1
> 
> 时间：2012-06-05T21:31:19.973
> 
> 标签：python, numpy, pytables, numexpr

考虑以下 dtype 的 NumPy 数组`float32`：

```
In [29]: x = numpy.arange(10, dtype=numpy.float32) 
```

当我将它乘以`2`using`pytables.Expr`时，我得到一个`float32`数组：

```
In [30]: tables.Expr('x * 2').eval().dtype
Out[30]: dtype('float32') 
```

然而，当我将它乘以 时`2.0`，我得到一个`float64`数组：

```
In [31]: tables.Expr('x * 2.0').eval().dtype
Out[31]: dtype('float64') 
```

*有没有办法以不会*导致结果提升为的方式在上述表达式中指定浮点文字`float64`？

更一般地说，我有一个使用数组的表达式`float32`，并且我想确保结果也是类型`float32`（我不介意`float64`用于中间计算，但我不能将结果存储为`float64`）。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T10:16:05.567

我很确定它`pytables.Expr`是基于`Numexpr`. Numexpr 的文档对表达式中的提升进行了以下说明：

> 在隐含标量和数组的操作中，在 Numexpr 中使用正常的转换规则，而在 NumPy 中，数组类型优先。例如，如果 'a' 是 float32 类型的数组，而 'b' 是 float64 类型的标量（或 Python 浮点类型，等效），则 'a*b' 在 Numexpr 中返回 float64，但在NumPy（即数组操作数优先确定结果类型）。如果您需要将结果保留为 float32，请确保也使用 float32 标量。

所以这可能就是正在发生的事情。浮点常量负责提升到 64 位浮点数，解决方法是显式指定浮点常量为 float32。

# python - 使用 python 删除重复的 CSV 条目

> ID：10905273
> 
> 赞同：2
> 
> 时间：2012-06-05T21:31:33.297
> 
> 标签：python, csv

我刚刚完成了一个（叹气）终于可以工作的脚本。它在 Twitter 上搜索关键字。将结果写入 csv 中，其中包含 4 列关键字、Tweet、Lat、Lon（位置）。我正在使用的代码是：

```
import tweepy
import csv

keywordList = ['McDonalds', 'Taco Bell', 'Burger King',]
for keyword in keywordList:
    result = tweepy.api.search(q=keyword,rpp=1000,page=2, geocode= "34.085422,-117.900879,500mi" )

    with open(r'C:\Temp\results.csv', 'a') as acsv:
        w = csv.writer(acsv)
        for tweet in result:
            lat, lon = tweet.geo if tweet.geo else ('', '')
            try:
                a = tweet.geo['coordinates']
                print a[0] , a[1]
                print tweet.text
                w.writerow((keyword, tweet.text, a[0] , a[1]))
            except:
                pass 
```

我想使用任务管理器或 python 每 5 分钟运行一次此搜索，但它会重写重复项。我打算使用以下代码删除重复项，但发生了两件事。resutls2.csv 是空白的，当我打开 csv 时，它被锁定，我必须以只读方式查看它。我尝试了 f1.close()、writer.close() 等，但它说“csv.reader”对象没有关闭属性。

我最大的担心是通过写入新的 csv 或在每次搜索时以某种方式删除并写入同一个表来避免重复。任何建议都非常感谢！

```
import csv

f1 = csv.reader(open(r'C:\Temp\results.csv', 'rb'))
writer = csv.writer(open(r'C:\Temp\results2.csv', 'wb'))
tweet = set()
for row in f1:
    if row[1] not in tweet:
        writer.writerow(row)
        tweet.add( row[1] )
f1.close()
writer.close() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T03:34:20.893

这是一个重构版本：

**编辑：** unicode，真有趣——我在 read_csv() 中添加了一个 .decode() 调用，在 append_csv() 中添加了一个 .encode() 调用；这应该可以解决您的问题（我认为-您可能需要决定使用字符串编解码器）。

```
import tweepy
import csv
from collections import defaultdict
import time

FILE = 'c:/temp/results.csv'
KEYWORDS = ['McDonalds', 'Taco Bell', 'Burger King']
WHERE = "34.085422,-117.900879,500mi"
DELAY = 300  # seconds

def _float(s, err=None):
    try:
        return float(s)
    except ValueError:
        return err

def _str(f, err=""):
    return err if f is None else str(f)

def read_csv(fname=FILE):
    data = defaultdict(dict)
    with open(fname, 'rb') as inf:
        incsv = csv.reader(inf)
        for kw,tw,lat,lon in incsv:
            # added .decode() call to handle saved unicode chars
            data[kw][tw.decode()] = (_float(lat), _float(lon))
    return data

def append_csv(data, fname=FILE):
    with open(fname, "ab") as outf:
        outcsv = csv.writer(outf)
        # added .encode() call to handle saved unicode chars
        outcsv.writerows((kw,tw.encode(),_str(lat),_str(lon)) for kw,dat in data.iteritems() for tw,(lat,lon) in dat.iteritems())

def search_twitter(keywords=KEYWORDS, loc=WHERE):
    data = defaultdict(dict)
    for kw in keywords:
        for tweet in tweepy.api.search(q=kw, rpp=1000, page=2, geocode=loc):
            data[kw][tweet.text] = tweet.geo if tweet.geo else (None,None)
    return data

def calc_update(old_data, new_data):
    diff = defaultdict(dict)
    for kw,dat in new_data.iteritems():
        for tw,loc in dat.iteritems():
            if tw not in old_data[kw]:
                diff[kw][tw] = old_data[kw][tw] = loc
    return old_data, diff

def show_data(data):
    for kw,dat in data.iteritems():
        for tw,(lat,lon) in dat.iteritems():
            print("<{},{}> {} [{}]".format(_str(lat,"???"), _str(lon,"???"), tw, kw))

def main():
    data = read_csv()
    while True:
        new_data  = search_twitter()
        data,diff = calc_update(data, new_data)
        append_csv(diff)
        show_data(diff)
        time.sleep(DELAY)

if __name__=="__main__":
    main() 
```

# jquery - 对 Restful Web 服务的 Ajax 调用

> ID：10905274
> 
> 赞同：0
> 
> 时间：2012-06-05T21:31:36.727
> 
> 标签：jquery, ajax, rest

我在尝试从我的 Restful Web 服务接收字符串时遇到问题。我的 ajax 代码看起来像这样

```
 <meta http-equiv="Content-Script-Type" content="text/javascript">
    <script type="text/javascript" src="js/jquery-1.7.2.min.js"></script> 
        <script type="text/javascript">
        function showName(str)
        {   
          if (str=="")
          {
            document.getElementById("playerInfo").innerHTML="Player information will be listed here.";
            return;
          }

    var n =  "path/to/jboss"+str;
         document.getElementById("testURL").innerHTML=n;
    $.ajax({
        type: "GET",
        url: n,
        dataType: "html",
        success:function(resp){
             document.getElementById("playerInfo").innerHTML=resp;
        },
        error:function(e){
            document.getElementById("playerInfo").innerHTML="Error: " + e;
        }
    });
    }

        </script>

</head>
<body>
    <form action=""> 
        <select name="id" onchange="showName(this.value)">
            <option value="">Select an id number:</option>
            <option value="51902">51902</option>
            <option value="51907">51907</option>
            <option value="51916">51916</option>
        </select>
    </form>
  <div id="testURL"></div>
    <div id="playerInfo">Player information will be listed here.</div>
</body>
</html> 
```

正在传递的 str 是该页面上我的应用程序的参数。假设返回一个 HTML 字符串，但它总是出错并且永远不会成功。谁能帮我诊断这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T22:13:04.167

试试这个，如果你已经有 jquery 为什么不在所有东西上使用它，我在 ajax 调用中更改了参数

```
function showName(str) {

        if (str == "") {
            $("#playerInfo").html("Player information will be listed here.");
            return;
        }

        var n = "path/to/jboss" + str;
        $("#testURL").html(n);
        $.ajax({
            type: "GET",
            url: n,
            success: function (resp) {
                $("#playerInfo").html(resp);
            },
            error: function (e) {
                $("#playerInfo").html("Error: " + e);
            }
        });
    } 
```

# save - 将引导加载程序保存到虚拟磁盘

> ID：10905275
> 
> 赞同：0
> 
> 时间：2012-06-05T21:31:38.290
> 
> 标签：save, virtual-machine, bootloader, virtual-disk

希望这听起来不疯狂或什么的

我正在尝试创建一个迷你操作系统（谁没有？，这就像一个穆斯林访问麦加 - 任何程序员都必须在他的生活中至少做一次）

*因此，我创建了一个简单的引导加载程序，当从虚拟机（ Oracle VM Virtual Box*）中的虚拟可引导 ISO 执行时，它工作正常。它现在只显示一条消息。此时，我应该将控制权交给另一个代码，它将开始成为我的操作系统所有这些都将从虚拟光盘执行。我可以将它刻录在 CD 上并在 i386 上运行。

不，要真正做到这一点，我想运行“操作系统”。从硬盘，所以我想知道是否有办法直接在虚拟磁盘（如.vmi、.vhd、.hdd）上“刻录”可引导信息（引导加载程序和其他要加载的文件）

当我在虚拟机上从 ISO 映像安装传统操作系统（如 Windows 或 Linux）时，引导加载程序会启动一个新的代码部分，将操作系统安装在虚拟磁盘上。我也应该这样做：为操作系统创建一个安装程序，它将我的引导部分写入虚拟磁盘。这意味着每次我对我的操作系统进行更改时，我都必须重新安装它。我不喜欢那样。我希望能够直接在虚拟磁盘文件中编写启动代码，在 Virtual Box 中启动机器，然后看到它运行。我用 HEX 编辑器打开了 .vmi 文件，但我不知道应该把代码放在哪里才能被认为是可启动的。

现在，告诉我我是否不知道我在说什么，或者是否有解决方案。谢谢大家！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T22:59:03.770

我发现了如何做到这一点。创建一个 vmdk 磁盘，在 HEX 编辑器中打开并粘贴从 0 开始的可引导信息

# linux - Shell脚本试图并行启动任务？

> ID：10905277
> 
> 赞同：3
> 
> 时间：2012-06-05T21:31:53.023
> 
> 标签：linux, shell, scripting

我需要做的基本任务是多次调用 python 脚本，每次使用不同的参数。例如：

```
script.py -t command1
script.py -t command2
script.py -t command3 
```

等等。现在的问题是 script.py 需要很长时间才能运行，所以只是将上面的内容放在一个 shell 脚本中并连续运行它们（一个接一个）是浪费时间。

相反，我想做的是打开多个终端，并在每个终端中运行

```
script.py -t command_i 
```

对于第 i 个命令参数。有没有办法做到这一点？如果没有，对于我正在尝试做的事情，还有其他有用的并行选项吗？

干杯

编辑 - 刚刚意识到：我可能想要某种分叉，是吗？不过，我从来没有用 shell 脚本做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T21:32:58.367

要在后台运行命令，请`&`在末尾添加：

```
script.py -t command1 &
script.py -t command2 &
script.py -t command3 & 
```

如果您在 shell 脚本中使用它并希望等待所有进程完成，请`wait`不带参数运行。在继续执行脚本之前，它将等待当前 shell 中的所有后台作业完成。

# ruby-on-rails - 需要 aws-sdk 和 aws-s3 gem，但它们相互冲突

> ID：10905284
> 
> 赞同：1
> 
> 时间：2012-06-05T21:32:28.413
> 
> 标签：ruby-on-rails, ruby-on-rails-3, amazon-s3, amazon-web-services, paperclip

在我之前发布[的 AWS::S3::Bucket:Class 的未定义方法 `find' 中，](https://stackoverflow.com/questions/10891891/undefined-method-find-for-awss3bucketclass)我们发现我正在创建的 Amazon S3 上传程序需要 aws-s3 gem，但我也安装了 aws-sdk gem，这两个与彼此。

问题是我也在使用 Paperclip，在删除 aws-sdk 后，我发现我的应用程序坏了。

有解决方法吗？我在 Stackoverflow 上搜索过，但还没有找到好的解决方案。也找到了这个博客，但它似乎过时了： http: [//davesouth.org/stories/paperclip-upgrade-breaks-amazon-s3-upload-and-how-to-fix-it](http://davesouth.org/stories/paperclip-upgrade-breaks-amazon-s3-upload-and-how-to-fix-it)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:18:50.643

我已经成功地使用带有回形针的[雾宝石](http://rubygems.org/gems/fog)在亚马逊上存储图像。事实上，我发现它比 AWS gem 更容易工作。您可以尝试将其换成 aws-sdk。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T06:49:31.710

您使用的是什么版本的回形针和导轨？我遇到了同样的问题，但是当我将 rails 升级到 3.1.10 并将回形针升级到 3.4.0 时，它工作得很好。无需任何工作。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-06T12:03:08.353

不确定这是个好主意，但您可以尝试将 Paperclip 降级到使用 aws-s3 的那个版本......据我所知，[2.4.5](http://rubygems.org/gems/paperclip/versions/2.4.5)是最新的。

# javascript - 从数组中随机加载图像而不重复任何内容的脚本，直到所有图像都被查看

> ID：10905287
> 
> 赞同：0
> 
> 时间：2012-06-05T21:32:50.410
> 
> 标签：javascript

我正在运行一个脚本，该脚本在每次刷新页面时随机从数组中加载图像。该脚本以及我在网上看到的所有其他类似脚本的一个不受欢迎的特性是，尽管数组中有 100 多个图像，但它通常会在数组中的所有图像都加载同一个图像之前多次加载被查看。

我想更改脚本以防止在查看数组中的所有图像之前调用两次相同的图像。如果与我在这里采取的方法完全不同的方法更可取，请告诉我。另外，我对 javascript 的理解是不稳定的，所以对如何纠正这个问题的彻底解释将是最有帮助的。

提前致谢

以下是页面来源：

```
 <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title></title>

    <link href="css/styles.css" rel="stylesheet" type="text/css">
    <!--[if IE]><link href="css/ie-styles.css" rel="stylesheet" type="text/css"><![endif]-->

    <script type="text/javascript">
    <!--
    var xoxo = new Array(); // Array to hold filenames

            xoxo[0] = "images/portrait/fpo/01.jpg"
            xoxo[1] = "images/portrait/fpo/02.jpg"
            xoxo[2] = "images/portrait/fpo/03.jpg"
            xoxo[3] = "images/portrait/fpo/04.jpg"
            xoxo[4] = "images/portrait/fpo/05.jpg"
            xoxo[5] = "images/portrait/fpo/06.jpg"
            xoxo[6] = "images/portrait/fpo/07.jpg"
            xoxo[7] = "images/portrait/fpo/08.jpg"
            xoxo[8] = "images/portrait/fpo/09.jpg"
            xoxo[9] = "images/portrait/fpo/10.jpg"
            xoxo[10] = "images/portrait/fpo/11.jpg"
            xoxo[11] = "images/portrait/fpo/12.jpg"
            xoxo[12] = "images/portrait/fpo/13.jpg"
            xoxo[13] = "images/portrait/fpo/14.jpg"
            xoxo[14] = "images/portrait/fpo/15.jpg"
            xoxo[15] = "images/portrait/fpo/16.jpg"
            xoxo[16] = "images/portrait/fpo/17.jpg"
            xoxo[17] = "images/portrait/fpo/18.jpg"
            xoxo[18] = "images/portrait/fpo/19.jpg"
            xoxo[19] = "images/portrait/fpo/20.jpg"
            xoxo[20] = "images/portrait/fpo/21.jpg"
            xoxo[21] = "images/portrait/fpo/22.jpg"
            xoxo[22] = "images/portrait/fpo/23.jpg"
            xoxo[23] = "images/portrait/fpo/24.jpg"
            xoxo[24] = "images/portrait/fpo/25.jpg"
            xoxo[25] = "images/portrait/fpo/26.jpg"
            xoxo[26] = "images/portrait/fpo/27.jpg"
            xoxo[27] = "images/portrait/fpo/28.jpg"
            xoxo[28] = "images/portrait/fpo/29.jpg"
            xoxo[29] = "images/portrait/fpo/30.jpg"
            xoxo[30] = "images/portrait/fpo/31.jpg"
            xoxo[31] = "images/portrait/fpo/32.jpg"
            xoxo[32] = "images/portrait/fpo/33.jpg"
            xoxo[33] = "images/portrait/fpo/34.jpg"
            xoxo[34] = "images/portrait/fpo/35.jpg"
            xoxo[35] = "images/portrait/fpo/36.jpg"
            xoxo[36] = "images/portrait/fpo/37.jpg"
            xoxo[37] = "images/portrait/fpo/38.jpg"
            xoxo[38] = "images/portrait/fpo/39.jpg"
            xoxo[39] = "images/portrait/fpo/40.jpg"
            xoxo[40] = "images/portrait/fpo/41.jpg"
            xoxo[41] = "images/portrait/fpo/42.jpg"
            xoxo[42] = "images/portrait/fpo/43.jpg"
            xoxo[43] = "images/portrait/fpo/44.jpg"
            xoxo[44] = "images/portrait/fpo/45.jpg"
            xoxo[45] = "images/portrait/fpo/46.jpg"
            xoxo[46] = "images/portrait/fpo/47.jpg"
            xoxo[47] = "images/portrait/fpo/48.jpg"
            xoxo[48] = "images/portrait/fpo/49.jpg"
            xoxo[49] = "images/portrait/fpo/50.jpg"
            xoxo[50] = "images/portrait/fpo/51.jpg"
            xoxo[51] = "images/portrait/fpo/52.jpg"
            xoxo[52] = "images/portrait/fpo/53.jpg"
            xoxo[53] = "images/portrait/fpo/54.jpg"
            xoxo[54] = "images/portrait/fpo/55.jpg"
            xoxo[55] = "images/portrait/fpo/56.jpg"
            xoxo[56] = "images/portrait/fpo/57.jpg"
            xoxo[57] = "images/portrait/fpo/58.jpg"
            xoxo[58] = "images/portrait/fpo/59.jpg"
            xoxo[59] = "images/portrait/fpo/60.jpg"
            xoxo[60] = "images/portrait/fpo/61.jpg"
            xoxo[61] = "images/portrait/fpo/62.jpg"
            xoxo[62] = "images/portrait/fpo/63.jpg"
            xoxo[63] = "images/portrait/fpo/64.jpg"
            xoxo[64] = "images/portrait/fpo/65.jpg"
            xoxo[65] = "images/portrait/fpo/66.jpg"
            xoxo[66] = "images/portrait/fpo/67.jpg"
            xoxo[67] = "images/portrait/fpo/68.jpg"
            xoxo[68] = "images/portrait/fpo/69.jpg"
            xoxo[69] = "images/fashion/fpo/01.jpg"
            xoxo[70] = "images/fashion/fpo/02.jpg"
            xoxo[71] = "images/fashion/fpo/03.jpg"
            xoxo[72] = "images/fashion/fpo/04.jpg"
            xoxo[73] = "images/fashion/fpo/05.jpg"
            xoxo[74] = "images/fashion/fpo/06.jpg"
            xoxo[75] = "images/fashion/fpo/07.jpg"
            xoxo[76] = "images/fashion/fpo/08.jpg"
            xoxo[77] = "images/fashion/fpo/09.jpg"
            xoxo[78] = "images/fashion/fpo/10.jpg"
            xoxo[79] = "images/fashion/fpo/11.jpg"
            xoxo[80] = "images/fashion/fpo/12.jpg"
            xoxo[81] = "images/fashion/fpo/13.jpg"
            xoxo[82] = "images/fashion/fpo/14.jpg"
            xoxo[83] = "images/fashion/fpo/15.jpg"
            xoxo[84] = "images/fashion/fpo/16.jpg"
            xoxo[85] = "images/fashion/fpo/17.jpg"
            xoxo[86] = "images/fashion/fpo/18.jpg"
            xoxo[87] = "images/fashion/fpo/19.jpg"
            xoxo[88] = "images/fashion/fpo/20.jpg"
            xoxo[89] = "images/fashion/fpo/21.jpg"
            xoxo[90] = "images/fashion/fpo/22.jpg"
            xoxo[91] = "images/fashion/fpo/23.jpg"
            xoxo[92] = "images/fashion/fpo/24.jpg"
            xoxo[93] = "images/fashion/fpo/25.jpg"
            xoxo[94] = "images/fashion/fpo/26.jpg"
            xoxo[95] = "images/fashion/fpo/27.jpg"
            xoxo[96] = "images/fashion/fpo/28.jpg"
            xoxo[97] = "images/fashion/fpo/29.jpg"
            xoxo[98] = "images/fashion/fpo/30.jpg"
            xoxo[99] = "images/fashion/fpo/31.jpg"
            xoxo[100] = "images/fashion/fpo/32.jpg"
            xoxo[101] = "images/fashion/fpo/33.jpg"
            xoxo[102] = "images/fashion/fpo/34.jpg"
            xoxo[103] = "images/fashion/fpo/35.jpg"
            xoxo[104] = "images/fashion/fpo/36.jpg"
            xoxo[105] = "images/fashion/fpo/37.jpg"
            xoxo[106] = "images/fashion/fpo/38.jpg"
            xoxo[107] = "images/fashion/fpo/39.jpg"
            xoxo[108] = "images/fashion/fpo/40.jpg"
            xoxo[109] = "images/fashion/fpo/41.jpg"
            xoxo[110] = "images/fashion/fpo/42.jpg"
            xoxo[111] = "images/fashion/fpo/43.jpg"
            xoxo[112] = "images/fashion/fpo/44.jpg"
            xoxo[113] = "images/fashion/fpo/45.jpg"
            xoxo[114] = "images/fashion/fpo/46.jpg"
            xoxo[115] = "images/fashion/fpo/47.jpg"
            xoxo[116] = "images/fashion/fpo/48.jpg"
            xoxo[117] = "images/fashion/fpo/49.jpg"
            xoxo[118] = "images/fashion/fpo/50.jpg"
            xoxo[119] = "images/fashion/fpo/51.jpg"
            xoxo[120] = "images/fashion/fpo/52.jpg"
            xoxo[121] = "images/fashion/fpo/53.jpg"
            xoxo[122] = "images/fashion/fpo/54.jpg"
            xoxo[123] = "images/fashion/fpo/55.jpg"
            xoxo[124] = "images/fashion/fpo/56.jpg"
            xoxo[125] = "images/fashion/fpo/57.jpg"
            xoxo[126] = "images/fashion/fpo/58.jpg"
            xoxo[127] = "images/fashion/fpo/59.jpg"
            xoxo[128] = "images/fashion/fpo/60.jpg"
            xoxo[129] = "images/fashion/fpo/61.jpg"
            xoxo[130] = "images/fashion/fpo/62.jpg"
            xoxo[131] = "images/fashion/fpo/63.jpg"
            xoxo[132] = "images/fashion/fpo/64.jpg"
            xoxo[133] = "images/fashion/fpo/65.jpg"
            xoxo[134] = "images/fashion/fpo/66.jpg"
            xoxo[135] = "images/fashion/fpo/67.jpg"
            xoxo[136] = "images/fashion/fpo/68.jpg"
            xoxo[137] = "images/fashion/fpo/69.jpg"
            xoxo[138] = "images/children/fpo/01.jpg"
            xoxo[139] = "images/children/fpo/02.jpg"
            xoxo[140] = "images/children/fpo/03.jpg"
            xoxo[141] = "images/children/fpo/04.jpg"
            xoxo[142] = "images/children/fpo/05.jpg"
            xoxo[143] = "images/children/fpo/06.jpg"
            xoxo[144] = "images/children/fpo/07.jpg"
            xoxo[145] = "images/children/fpo/08.jpg"
            xoxo[146] = "images/children/fpo/09.jpg"
            xoxo[147] = "images/children/fpo/10.jpg"
            xoxo[148] = "images/children/fpo/11.jpg"
            xoxo[149] = "images/children/fpo/12.jpg"
            xoxo[150] = "images/children/fpo/13.jpg"
            xoxo[151] = "images/children/fpo/14.jpg"
            xoxo[152] = "images/children/fpo/15.jpg"
            xoxo[153] = "images/children/fpo/16.jpg"
            xoxo[154] = "images/children/fpo/17.jpg"
            xoxo[155] = "images/children/fpo/18.jpg"
            xoxo[156] = "images/children/fpo/19.jpg"
            xoxo[157] = "images/children/fpo/20.jpg"
            xoxo[158] = "images/children/fpo/21.jpg"
            xoxo[159] = "images/children/fpo/22.jpg"
            xoxo[160] = "images/children/fpo/23.jpg"
            xoxo[161] = "images/children/fpo/24.jpg"
            xoxo[162] = "images/children/fpo/25.jpg"
            xoxo[163] = "images/children/fpo/26.jpg"
            xoxo[164] = "images/children/fpo/27.jpg"
            xoxo[165] = "images/children/fpo/28.jpg"
            xoxo[166] = "images/children/fpo/29.jpg"
            xoxo[167] = "images/children/fpo/30.jpg"
            xoxo[168] = "images/children/fpo/31.jpg"
            xoxo[169] = "images/children/fpo/32.jpg"
            xoxo[170] = "images/children/fpo/33.jpg"
            xoxo[171] = "images/children/fpo/34.jpg"
            xoxo[172] = "images/children/fpo/35.jpg"
            xoxo[173] = "images/children/fpo/36.jpg"
            xoxo[174] = "images/children/fpo/37.jpg"

    function pickRandom(range) {
        if (Math.random)
            return Math.round(Math.random() * (range-1));
        else {
            var now = new Date();
            return (now.getTime() / 1000) % range;
        }
    }
    // Write out an IMG tag, using a randomly-chosen image name.
    var choice = pickRandom(xoxo.length);
    // -->
    </script> 
```

```
 <div class="menu">

            <a style="color:#000000" href="index.html">Index</a><br>
            <a href="portrait/overview.html">Portrait</a><br>
            <a href="fashion/overview.html">Fashion</a><br>
            <a href="children/overview.html">Children</a><br>
            <a href="clients.html">Clients</a><br>
            <a href="contact.html">Contact</a><br>

    </div>

    <table cellpadding="0" cellspacing="0" border="0" height="100%" width="100%">
    <tr valign="middle"><td align="center">

            <a href="index.html"><script type="text/javascript">document.writeln('<img src="'+xoxo[choice]+'" >');</script></a>

    </td></tr>
    </table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T21:41:06.787

如果您真的想确保在所有图像都显示之前永远不会重复图像，您可以使用 存储已显示的索引列表`localstorage`。

您可以使用

```
localStorage['viewedItems'] = JSON.stringify(viewedItems) 
```

将数组保存到`localstorage`，其中viewedItems （第二个）是包含您已经显示的所有索引的数组的名称。然后你可以使用

```
JSON.parse(localStorage['viewedItems']) 
```

在每个页面加载时检索数组以查看您已经显示的内容。每次，你都在阅读它，添加一个索引（选择一个索引，直到你得到一个不在这个数组中的索引），然后写它。一旦数组的大小达到您拥有的图像数量，清除它并重新开始。

**更新，希望更详细，解释**

首先，您`viewedItems`要从`localStorage`. 然后像你已经做的那样选择一个随机数，并查看该数字是否存在于`viewedItems`. 您可以使用[indexOf](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/indexOf)执行此操作。选择一个数字并检查是否存在代码将在一个循环中，所以你一直这样做，直到你找到一个在你的数组中不存在的数字。显示该索引。然后，您可以使用[push](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/push)方法将此索引添加到您的`viewedItems`数组中。最后，将`viewedItems`数组保存到`localStorage`.

**伪代码**

```
load viewedItems from localStorage

do
    r = random number
while viewedItems.indexOf(r) > -1

show xoxo[r]

viewedItems.push(r)

save viewedItems to localStorage 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T21:45:33.613

这可能不是最好的解决方案，但不妨试一试。有第二个数组和第一个数组一样大，但让它存储布尔值。第二个数组的索引对应于第一个数组的索引。因此，当脚本给出 24 作为随机数时，它应该从`xoxo`数组中返回第 25 个图像，并且应该将第二个数组中的第 25 个元素设置为 false。例如：

```
// assume isAvailable is the array that holds the bools
function pickRandom(range) {
        checkAvailabilities(); // checks to see if all the images have been used
        if (Math.random) {
           while (true) {
               var choice = Math.round(Math.random() * (range-1));
               if (isAvailable[choice]) {
                  isAvailable[choice] = false;
                  return choice;
               }
           }
        }
        else {
            var now = new Date();
            return (now.getTime() / 1000) % range;
        }
}

function checkAvailabilities()
{
   // check if there are still some images that haven't been chosen
   for (var i = 0; i < isAvailable.length; i++)
      if (isAvailable[i])
         return; 
   // all the images have been used, so make all of them available again
   for (var i = 0; i < isAvailable.length; i++)
      isAvailable[i] = true;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T22:28:36.117

由于 JavaScript 数字可以保存超过 50 位的整数，因此 3 个数字可以跟踪 150 个文件。

以下代码提供了用于创建、操作和查询由 50 位数字数组组成的数据结构的函数：

```
function Set (len) {
  // Establish an array of sufficient 50 bit numbers to hold len bits
  this.bits = new Array (Math.floor ((len + 49) / 50));
  this.len = len;
  // Clear all numbers
  for (var i = this.bits.length; i--;)
    this.bits[i] = 0;
}

Set.prototype.full = function () {
  // Check if all bits of the set at 1
  // First check the relevant bits of the last word
  if (this.bits[this.bits.length - 1] === Math.pow (2, this.len + 1) - 1)
    // Then chec tat all remaining numbers are full
    for (var i = this.bits.length - 1; i--;)
      if (bits[i] !== Math.pow (2, 51) - 1)
        return false;
  return true;
}

Set.prototype.check = function (n) {
  // Return value (0 or 1) of bit n of the set
  var m = n % 50; 
  return Math.floor (this.bits [(n - m) / 50] / Math.pow (2, m)) & 1;
}

Set.prototype.add = function (n) {
  // Set bit n of the set to 1 (unless it is already 1)
  if (!this.check (n)) {
    var m = n % 50; 
    this.bits [(n - m) / 50] += Math.pow (2, m);
    return true;
  }
  return false;
}

Set.prototype.remove = function (n) {
  // Set bit of the set to 0 (unless it is already 0)
  if (this.check (n)) {
    var m = n % 50; 
    this.bits [(n - m) / 50] -= Math.pow (2, m);
    return true;
  }
  return false;
}

Set.prototype.clear = function () {
  // Clear all bitsof the set to 0 
  for (var i = this.bits.length; i--;)
    bits[i] = 0;
} 
```

# html - 是否有标准 HTML 的编译器允许在没有服务器端语言的情况下包含？

> ID：10905288
> 
> 赞同：4
> 
> 时间：2012-06-05T21:32:52.623
> 
> 标签：html, compilation, include

我最近有几个需要交付标准 HTML 文件的项目，每个项目的页眉和页脚都有很多通用标记。

我将 SASS 用于 CSS，并且喜欢我可以将一个 .scss 文件包含到另一个文件中，并且最终仍然得到一个 .css 文件。

我希望有一个类似的 HTML 编译器，但我一直找不到。

我虽然 HAML 可能是票，但它似乎没有包含功能。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:00:18.390

首先想到的是玉：

[https://github.com/visionmedia/jade](https://github.com/visionmedia/jade)

简化您的 HTML 并允许编译包含。

# python - 模板标签已成功翻译，但 utils 中的 ugettext_lazy() 未翻译

> ID：10905295
> 
> 赞同：0
> 
> 时间：2012-06-05T21:33:37.757
> 
> 标签：python, django, internationalization

我成功地设法让 trans 和 blocktrans 翻译文本。

然而...

我在 utils.py 中定义了一个函数，它返回一个字典，其中包含我需要将其中一些字符串转换为当前语言的字符串。编辑：*这是我在项目目录中创建的 utils.py，视图调用它以在 dict 上执行某些辅助功能，然后返回更新后的 dict

我做了这样的事情：

```
 try:
     path = default_storage.save(customercode + '/' + file.name, ContentFile(file.read()))
     results['status'] = 'success'
     results['message'] = _(u'Your file has been successfully uploaded')        
    except Exception as e:
     results['status'] = 'error'
     results['message'] = _(u'There was an error uploading your file: ') + str(e)

return results 
```

我还添加了`from django.utils.translation import ugettext_lazy as _ to the top of this utils.py file..`

并且这个“结果”字典用于我的一个视图中，其中整个字典经过进一步处理后作为上下文变量传递给模板。

我已经在 .po 文件中正确设置了翻译。所有其他模板标签都可以完美翻译。只有上面提到的字符串不翻译。

任何帮助将不胜感激。

更新：我在表单提交标签中尝试了相同的过程，它翻译得很好。只有上述区域不会翻译！

PS：这是我关于stackoverflow的第一个问题。如果我在问这个问题时犯了错误，我会提前道歉。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T21:58:59.493

正如我所料，

我犯了一个非常愚蠢的错误。我在尝试打印翻译后的值时访问了模板中的错误变量！>_<

但我想我学到的一件事是远离问题，然后在很长一段时间后重新解决问题。你必须再次学习这个问题，这有时会帮助你找到像这些愚蠢的错误！

# .net - IEnumerable 的预期性能是多少？

> ID：10905297
> 
> 赞同：1
> 
> 时间：2012-06-05T21:33:48.707
> 
> 标签：.net, performance, ienumerable

预计属性的性能类似于字段，即使它们实际上是函数。可以说任意的预期性能是`IEnumerable`什么？

从属性中借用这个概念并说 an`IEnumerable`应该与迭代数组或 的性能大致相同是否公平`List<T>`？

或者，每次迭代都会发生任何事情是否可以：数据库访问、Web 服务调用、耗时的计算等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T21:36:29.580

根据经验，您无法真正推断出任意`IEnumerable`. 例如，它可能是`IQueryable`变相的，每次枚举时都会访问数据库。或者它可能是 的结果`File.EnumerateLines`。

有时重要的是可枚举只枚举一次。

**这与属性相反。**如果一个属性要访问数据库或读取 I 文件，我会认为这是代码异味。对于一个`IEnumerable`这只是正常的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T21:37:43.843

我想说没有关于 an`IEnumerable<T>`应该如何执行的规则 - 只有关于它应该如何表现，这意味着它应该循环通过你的集合。

如果您需要在迭代开始时访问数据库（如 Entity Framework 的`IQueryable<T>`），那很好 - 如果它需要对每个项目进行数据库或文件调用，那很好。对我来说唯一重要的是您可以循环播放它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T21:38:26.530

IEnumerable 没有属性，但如您所知，IEnumerable 返回一个 IEnumerator。

如果您的对象公开了一个 IEnumerable 类型的属性，该属性预计将在恒定时间内返回，但该**枚举器的枚举可能不应该有任何期望**。

当然，**您的情况可能会有所不同**。例如，如果您将一些 WPF 控件绑定到该可枚举，您的用户将希望它快速返回。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T21:39:53.547

An`IEnumerable`当然可以用于访问数据库或爬取文件，但是如果您公开了这样的`IEnumerable`，您应该清楚地记录它这样做。

如果不能立即明确它是否昂贵，您应该适当地封装它，并且只公开一个内存中的枚举。

# jenkins - 如何在 Jenkins 的性能报告中显示 jMeter 断言结果？什么构成绩效报告中的错误？

> ID：10905299
> 
> 赞同：7
> 
> 时间：2012-06-05T21:33:54.090
> 
> 标签：jenkins, jmeter, jenkins-plugins

我已经为 Jenkins 安装了 jMeter 插件，我可以看到基于我的 jmx 文件生成的 jtl 文件的性能报告。在我的 jmx 文件中，我有几个响应断言侦听器。根据它生成的 jtl 文件，断言响应是错误的。但是，当我查看 Jenkins 的性能报告时，错误百分比显示为 0。我的第一个问题是，绩效报告中的错误是什么？其次，如何在 Jenkins 的性能报告中查看哪些响应断言侦听器返回 false？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T02:41:28.393

绩效报告中的错误构成取决于样本发现的错误百分比

要查看错误是什么，请转到最后一次构建-> 性能报告

您应该会看到 jmeter 测试计划中所有样本的列表和结果

然后选择样本名称，您应该会看到所取样本的结果

# makefile - gnu make 3.80 source with eval bug fix

> ID：10905300
> 
> 赞同：0
> 
> 时间：2012-06-05T21:33:54.163
> 
> 标签：makefile

我在哪里可以获得带有“eval”错误修复的 gnu make 3.80？是否有 3.80 + 每日构建的存储库？安装最新的 gnu make 对我来说不是一个选择。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T10:54:47.363

您可以应用原始[错误报告](https://savannah.gnu.org/bugs/?1517)中发布的简单[补丁](https://savannah.gnu.org/bugs/download.php?file_id=120)。

# php - 处理由动态 php/mySql 设置创建的表单

> ID：10905303
> 
> 赞同：0
> 
> 时间：2012-06-05T21:34:11.487
> 
> 标签：php, mysql, forms

我运行一个脚本来创建一个订单，这只是一个非常小的示例。我不太擅长 PHP 和动态表单。它从mysql数据库中提取数据。

```
<td>
<h3>Round Cuts</h3>
<?php while($row = mysql_fetch_array($round_cuts)){
$round_box_value = @$row["meat_names"];
$round_box_value_name = @$row["meat_names"];
echo " <input type=\"checkbox\" name=\"round_box_value\" value=\"$round_box_value_name\">     $round_box_value_name";
echo "<br>";
}?>
</td> 
```

我真的只建立了基本的联系表格，我怎么能处理这样的动态表格。如果所有其他方法都失败了，我将采用所有可能的元素并对其进行编程，就像它不是动态的一样。不过一定有更好的方法。

即使是指向网站的链接也会有所帮助。我一直在寻找解决方案。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T21:46:18.860

我会假设你的表作为主键`id`

从对复选框的微小更改开始：

```
<?php 
while($row = mysql_fetch_array($round_cuts)){
  echo sprintf('<label><input type="checkbox" name="round_box_value[]" value="%s"> %s</label><br>', $row['id'], $row['meat_names']);
}
?> 
```

现在名称`[]`的末尾有一个告诉 php 它是一个值数组 + 为方便起见，我将复选框包装在一个标签中。

然后，当您处理表单时，您可以像这样简单地遍历 round_box_value

```
<?php
foreach ($_POST['round_box_value'] as $id) {
  // $id is the table reference from your previous table
}

// or query all the rows selected
$ids = array_map('intval', $_POST['round_box_value']); // "basic" sql injection handler
$sql = "SELECT * FROM table WHERE id IN (".implode(",", $ids).")"; 
```

应该产生类似的东西：

```
SELECT * FROM table WHERE id IN (2,5,7) 
```

# c - 在 Linux 中为 NTFS 实现 ls 命令

> ID：10905306
> 
> 赞同：0
> 
> 时间：2012-06-05T21:34:46.617
> 
> 标签：c, filesystems, operating-system, 64-bit, ntfs

我正在尝试构建一个类似 bash 的脚本，它提供了一些功能，例如 ls、pwd、cat 等。在 linux 系统中的 NTFS 上工作。假设我有一个 NTFS 映像，并使用 fopen 将其作为文件打开。然后，我读取了一些扇区，例如位于 0x0B 的 BPB，并获取了一些有关 NTFS 映像的一般信息。我需要到达根目录指针，然后遍历文件系统以实现这些功能，尤其是对于 ls 和 pwd。我在谷歌上搜索了很多关于 NTFS 的内部细节和偏移量的信息，但我不知道如何实现这个目标。如果没有可理解的文档或示例，我将无法取得进一步进展。

任何帮助、文档、提示、偏移表等将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T21:53:29.487

我猜这是一个学习练习。所以，首先：

1.  **`bash`**为特定文件系统**编写****类似的解释器是****错误**的做法。*您应该专注于了解 NTFS 文件系统的细节。*

2.  **编写`ls`，`cat`**以便能够使用特定文件系统中的文件是**错误**的做法。*您应该专注于了解 NTFS 文件系统的细节。*

3.  如果您编写文件系统驱动程序（例如使用[FUSE](http://fuse.sourceforge.net/)），那么原始`bash`的`ls`,`cat`将自动与该文件系统一起使用。因为驱动程序将能够将系统调用翻译`open`成`read`文件系统特定的过程。

最后：

1.  了解[FUSE](http://fuse.sourceforge.net/)。*太棒*了。请参阅此[`Hello World`FUSE 模块](http://fuse.sourceforge.net/helloworld.html)。运行它，玩它。

2.  下载[NTFS-3G](http://www.tuxera.com/community/ntfs-3g-download/)的源代码，这是当今大多数 GNU/Linux 发行版使用的 NTFS 驱动程序。它使用保险丝。了解它是如何工作的。

# ruby-on-rails - 在您的登录页面上关闭 csrf/authenticity_token 保护

> ID：10905309
> 
> 赞同：0
> 
> 时间：2012-06-05T21:35:04.350
> 
> 标签：ruby-on-rails, security, ruby-on-rails-3.2, csrf

我们正在考虑在我们的登录页面上关闭 csrf/authenticity 令牌保护。（可能在登录发布操作上有一个skip_before_filter）。这将允许我们从我们网站上的静态 html 页面发布。这对安全有什么影响？看来，如果我们只为登录帖子关闭它，就没有多少恶意可以做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T21:37:44.743

CSRF 代币并非旨在阻止机器人！CSRF（跨站点请求伪造）是一种攻击，其中欺骗的公式/url 被触发，例如由不可见的 iframe。在弱系统上，这会让攻击者更改主页上的配置。

让我描述一个示例攻击：网上商店的管理员登录到他的管理员帐户。攻击者现在向他发送一封邮件，其中包含指向虚假主页的链接。当管理员进入页面时，JavaScript 会向 URL 发送数据，他将在该 URL 发送表单以创建新的管理员用户，并且 JavaScript 会发送所有需要的数据，例如新用户名、新密码等。管理员已登录，因此从网上商店的角度来看，管理员会创建一个常规的新管理员帐户。从管理员的角度来看，什么都没有发生，因为一切都发生在后台。CSRF 令牌可防止表单以此类方式受到攻击。

您可以在 wikipedia 上阅读更多关于 CSRF 的信息：[http ://en.wikipedia.org/wiki/Cross-site_request_forgery](http://en.wikipedia.org/wiki/Cross-site_request_forgery)

# android - 从 DialogFragment 接收结果

> ID：10905312
> 
> 赞同：249
> 
> 时间：2012-06-05T21:35:08.537
> 
> 标签：android, dialog, android-fragments, fragment, dismiss

我将**DialogFragments**用于许多事情：从列表中选择项目，输入文本。

将值（即列表中的字符串或项目）返回给调用活动/片段的最佳方法是什么？

目前，我正在实现调用活动`DismissListener`并为 DialogFragment 提供对该活动的引用。Dialog 然后调用 Activity 中的`OnDimiss`方法，Activity 从 DialogFragment 对象中获取结果。非常混乱，它在配置更改（方向更改）上不起作用，因为 DialogFragment 失去了对活动的引用。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：259
> 
> 时间：2012-11-17T19:01:40.653

从显示对话框的位置使用`myDialogFragment.setTargetFragment(this, MY_REQUEST_CODE)`，然后在对话框完成后，您可以从中调用`getTargetFragment().onActivityResult(getTargetRequestCode(), ...)`，并`onActivityResult()`在包含的片段中实现。

这似乎是对 的滥用`onActivityResult()`，尤其是因为它根本不涉及活动。但是我已经看到了官方谷歌人推荐的，甚至可能在 api 演示中。我认为这`g/setTargetFragment()`是添加的。

* * *

## 回答 #2

> 赞同：143
> 
> 时间：2013-02-11T08:34:09.050

正如您[在此处](http://android-developers.blogspot.in/2012/05/using-dialogfragments.html)看到的，有一种非常简单的方法可以做到这一点。

在您`DialogFragment`添加一个接口监听器，如：

```
public interface EditNameDialogListener {
    void onFinishEditDialog(String inputText);
} 
```

然后，添加对该侦听器的引用：

```
private EditNameDialogListener listener; 
```

这将用于“激活”侦听器方法，并检查父 Activity/Fragment 是否实现此接口（见下文）。

在`Activity`//那个“调用”的地方简单地实现了这个接口`FragmentActivity`。`Fragment``DialogFragment`

在您`DialogFragment`想要关闭`DialogFragment`并返回结果的地方，您需要添加的所有内容是：

```
listener.onFinishEditDialog(mEditText.getText().toString());
this.dismiss(); 
```

`mEditText.getText().toString()`将传递回调用的内容在哪里`Activity`。

请注意，如果您想返回其他内容，只需更改侦听器采用的参数即可。

最后，您应该检查该接口是否实际由父活动/片段实现：

```
@Override
public void onAttach(Context context) {
    super.onAttach(context);
    // Verify that the host activity implements the callback interface
    try {
        // Instantiate the EditNameDialogListener so we can send events to the host
        listener = (EditNameDialogListener) context;
    } catch (ClassCastException e) {
        // The activity doesn't implement the interface, throw exception
        throw new ClassCastException(context.toString()
                + " must implement EditNameDialogListener");
    }
} 
```

这种技术非常灵活，即使您还不想关闭对话框，也可以使用结果进行回调。

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2014-08-15T13:58:20.107

有一种更简单的方法可以从 DialogFragment 接收结果。

首先，在您的 Activity、Fragment 或 FragmentActivity 中，您需要添加以下信息：

```
@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
    // Stuff to do, dependent on requestCode and resultCode
    if(requestCode == 1) { // 1 is an arbitrary number, can be any int
         // This is the return result of your DialogFragment
         if(resultCode == 1) { // 1 is an arbitrary number, can be any int
              // Now do what you need to do after the dialog dismisses.
         }
     }
} 
```

这`requestCode`基本上是您调用的 DialogFragment 的 int 标签，我将在稍后展示它是如何工作的。resultCode 是您从 DialogFragment 发回的代码，告诉您当前等待的 Activity、Fragment 或 FragmentActivity 发生了什么。

下一段代码是对 DialogFragment 的调用。这里有一个例子：

```
DialogFragment dialogFrag = new MyDialogFragment();
// This is the requestCode that you are sending.
dialogFrag.setTargetFragment(this, 1);     
// This is the tag, "dialog" being sent.
dialogFrag.show(getFragmentManager(), "dialog"); 
```

通过这三行，您可以声明您的 DialogFragment，设置一个 requestCode（一旦 Dialog 被关闭，它将调用 onActivityResult(...)，然后您将显示该对话框。就这么简单。

现在，在您的 DialogFragment 中，您只需在 DialogFragment 之前直接添加一行，`dismiss()`以便将 resultCode 发送回 onActivityResult()。

```
getTargetFragment().onActivityResult(getTargetRequestCode(), resultCode, getActivity().getIntent());
dismiss(); 
```

就是这样。请注意，resultCode 定义为`int resultCode`我`resultCode = 1;`在这种情况下设置的值。

就是这样，您现在可以将 DialogFragment 的结果发送回您的调用 Activity、Fragment 或 FragmentActivity。

此外，看起来此信息之前已发布，但没有给出足够的示例，所以我想我会提供更多详细信息。

**编辑 06.24.2016** 对于上面的误导性代码，我深表歉意。但是您肯定无法将结果返回给活动，如下所示：

```
dialogFrag.setTargetFragment(this, 1); 
```

设定一个目标`Fragment`而不是`Activity`。因此，为了做到这一点，您需要使用实现一个`InterfaceCommunicator`.

在你的`DialogFragment`设置一个全局变量

```
public InterfaceCommunicator interfaceCommunicator; 
```

创建一个公共函数来处理它

```
public interface InterfaceCommunicator {
    void sendRequestCode(int code);
} 
```

然后，当您准备好将代码发送回运行完成`Activity`时`DialogFragment`，您只需在您之前添加以下`dismiss();`行`DialogFragment`：

```
interfaceCommunicator.sendRequestCode(1); // the parameter is any int code you choose. 
```

现在，在您的活动中，您必须做两件事，第一件事是删除不再适用的那一行代码：

```
dialogFrag.setTargetFragment(this, 1); 
```

然后实现接口，就大功告成了。您可以通过将以下行添加到`implements`类最顶部的子句中来做到这一点：

```
public class MyClass Activity implements MyDialogFragment.InterfaceCommunicator 
```

然后`@Override`是活动中的功能，

```
@Override
public void sendRequestCode(int code) {
    // your code here
} 
```

您可以像使用该方法一样使用此接口`onActivityResult()`方法。除了接口方法是for `DialogFragments`，另一个是for `Fragments`。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2016-04-09T08:25:29.733

好吧，回答可能为时已晚，但这是我为从`DialogFragment`. 与@brandon 的回答非常相似。在这里我`DialogFragment`从一个片段中调用，只需将此代码放置在您调用对话框的位置。

```
FragmentManager fragmentManager = getFragmentManager();
            categoryDialog.setTargetFragment(this,1);
            categoryDialog.show(fragmentManager, "dialog"); 
```

我要调用`categoryDialog`的我在哪里，然后在您的实现中将此代码放置在您打算设置数据的位置。的值为1 你可以设置它或使用系统定义。`DialogFragment``dialogfragment``resultCode`

```
 Intent intent = new Intent();
            intent.putExtra("listdata", stringData);
            getTargetFragment().onActivityResult(getTargetRequestCode(), resultCode, intent);
            getDialog().dismiss(); 
```

现在是时候回到调用片段并实现这个方法了。如果您想在 if 条件下`resultCode`检查数据有效性或结果是否成功。`requestCode`

```
 @Override
    public void onActivityResult(int requestCode, int resultCode, Intent data) {
        super.onActivityResult(requestCode, resultCode, data);        
        //do what ever you want here, and get the result from intent like below
        String myData = data.getStringExtra("listdata");
Toast.makeText(getActivity(),data.getStringExtra("listdata"),Toast.LENGTH_SHORT).show();
    } 
```

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2020-08-05T09:57:46.987

对于仍在阅读此内容的任何人：`setTargetFragment()`已被弃用。现在建议使用这样的`FragmentResultListener`API：

```
override fun onCreate(savedInstanceState: Bundle?) {
    super.onCreate(savedInstanceState)
    setFragmentResultListener("requestKey") { key, bundle ->
        val result = bundle.getString("resultKey")
        // Do something with the result...
    }

    ...

    // Somewhere show your dialog
    MyDialogFragment.newInstance().show(parentFragmentManager, "tag")
} 
```

然后在你的`MyDialogFragment`设置结果：

```
button.setOnClickListener{
    val result = "some string"
    setFragmentResult("requestKey", bundleOf("resultKey" to result))
    dismiss()
} 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2017-07-30T19:00:39.257

不同的方法，以允许**Fragment**与其**Activity**进行通信：

**1）**在片段中定义一个公共接口并为其创建一个变量

```
public OnFragmentInteractionListener mCallback;

public interface OnFragmentInteractionListener {
    void onFragmentInteraction(int id);
} 
```

**2）**将活动投射到片段中的mCallback变量

```
try {
    mCallback = (OnFragmentInteractionListener) getActivity();
} catch (Exception e) {
    Log.d(TAG, e.getMessage());
} 
```

**3）**在您的活动中实现监听器

```
public class MainActivity extends AppCompatActivity implements DFragment.OnFragmentInteractionListener  {
     //your code here
} 
```

**4）**覆盖活动中的OnFragmentInteraction

```
@Override
public void onFragmentInteraction(int id) {
    Log.d(TAG, "received from fragment: " + id);
} 
```

更多信息：[https ://developer.android.com/training/basics/fragments/communicating.html](https://developer.android.com/training/basics/fragments/communicating.html)

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2015-12-23T22:44:43.653

我发现的一种简单方法如下：实现这是您的 dialogFragment，

```
 CallingActivity callingActivity = (CallingActivity) getActivity();
  callingActivity.onUserSelectValue("insert selected value here");
  dismiss(); 
```

然后在调用 Dialog Fragment 的活动中创建适当的函数，如下所示：

```
 public void onUserSelectValue(String selectedValue) {

        // TODO add your implementation.
      Toast.makeText(getBaseContext(), ""+ selectedValue, Toast.LENGTH_LONG).show();
    } 
```

Toast 是为了证明它有效。为我工作。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2015-10-04T18:20:48.957

`DialogFragment`看到没有人建议使用本地广播进行通信，我感到非常惊讶`Activity`！我发现它比其他建议更简单、更干净。本质上，您注册`Activity`以收听广播并从您的`DialogFragment`实例发送本地广播。简单的。有关如何设置的分步指南，请参见[此处](http://adilatwork.blogspot.co.uk/2015/10/android-how-to-pass-data-from.html)。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2018-10-29T15:00:04.620

或共享 ViewModel，如下所示：

```
public class SharedViewModel extends ViewModel {
    private final MutableLiveData<Item> selected = new MutableLiveData<Item>();

    public void select(Item item) {
        selected.setValue(item);
    }

    public LiveData<Item> getSelected() {
        return selected;
    }
}

public class MasterFragment extends Fragment {
    private SharedViewModel model;
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        model = ViewModelProviders.of(getActivity()).get(SharedViewModel.class);
        itemSelector.setOnClickListener(item -> {
            model.select(item);
        });
    }
}

public class DetailFragment extends Fragment {
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        SharedViewModel model = ViewModelProviders.of(getActivity()).get(SharedViewModel.class);
        model.getSelected().observe(this, { item ->
           // Update the UI.
        });
    }
} 
```

[https://developer.android.com/topic/libraries/architecture/viewmodel#sharing_data_between_fragments](https://developer.android.com/topic/libraries/architecture/viewmodel#sharing_data_between_fragments)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-07-03T08:51:26.597

在我的情况下，我需要将参数传递给 targetFragment。但我得到了异常“片段已经激活”。所以我在我的 DialogFragment 中声明了一个由 parentFragment 实现的接口。当 parentFragment 启动一个 DialogFragment 时，它将自己设置为 TargetFragment。然后在 DialogFragment 我打电话

```
 ((Interface)getTargetFragment()).onSomething(selectedListPosition); 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2018-10-13T22:24:22.970

在科特林

```
 // My DialogFragment
class FiltroDialogFragment : DialogFragment(), View.OnClickListener {

    var listener: InterfaceCommunicator? = null

    override fun onAttach(context: Context?) {
        super.onAttach(context)
        listener = context as InterfaceCommunicator
    }

    interface InterfaceCommunicator {
        fun sendRequest(value: String)
    }   

    override fun onClick(v: View) {
        when (v.id) {
            R.id.buttonOk -> {    
        //You can change value             
                listener?.sendRequest('send data')
                dismiss()
            }

        }
    }
} 
```

// 我的活动

```
class MyActivity: AppCompatActivity(),FiltroDialogFragment.InterfaceCommunicator {

    override fun sendRequest(value: String) {
    // :)
    Toast.makeText(this, value, Toast.LENGTH_LONG).show()
    }
} 
```

我希望它有用，如果你可以改进，请编辑它。我的英文不是很好

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-02-26T02:25:40.887

如果你想发送参数并从第二个片段接收结果，你可以使用 Fragment.setArguments 来完成这个任务

```
static class FirstFragment extends Fragment {
    final Handler mUIHandler = new Handler() {
        @Override
        public void handleMessage(Message msg) {
            switch (msg.what) {
            case 101: // receive the result from SecondFragment
                Object result = msg.obj;
                // do something according to the result
                break;
            }
        };
    };

    void onStartSecondFragments() {
        Message msg = Message.obtain(mUIHandler, 101, 102, 103, new Object()); // replace Object with a Parcelable if you want to across Save/Restore
                                                                               // instance
        putParcelable(new SecondFragment(), msg).show(getFragmentManager().beginTransaction(), null);
    }
}

static class SecondFragment extends DialogFragment {
    Message mMsg; // arguments from the caller/FirstFragment

    @Override
    public void onViewCreated(View view, Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onViewCreated(view, savedInstanceState);
        mMsg = getParcelable(this);
    }

    void onClickOK() {
        mMsg.obj = new Object(); // send the result to the caller/FirstFragment
        mMsg.sendToTarget();
    }
}

static <T extends Fragment> T putParcelable(T f, Parcelable arg) {
    if (f.getArguments() == null) {
        f.setArguments(new Bundle());
    }
    f.getArguments().putParcelable("extra_args", arg);
    return f;
}
static <T extends Parcelable> T getParcelable(Fragment f) {
    return f.getArguments().getParcelable("extra_args");
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-04-15T03:04:33.817

在对话片段上

```
class AbcDialogFragment(private val ondata: (data: String) -> Unit) :  DialogFragment() {} 
```

从片段/活动显示对话框的代码

```
val abcDialogFragment = AbcDialogFragment(ondata = {data->  })

abcDialogFragment.show(requireActivity().supportFragmentManager, "TAG") 
```

在对话框片段中，您可以在对话框片段关闭或任何点击侦听器时调用 onData。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-11-13T21:06:16.230

TL;DR - 使用此**AppDialog**类将数据传递到 DialogFragment 并从中获取结果。

详细解释：

*   **前提**- 片段在配置更改时被销毁并重新创建。查看模型徘徊。使用 Dialog 时，建议将其包装在 DialogFragment 中，这样当用户旋转设备并改变方向时，Dialog 不会意外消失（DialogFragment 会重新创建并重新显示它）。
*   **限制**（因此这个问题） - DialogFragment 的工作方式是它需要一个需要重新实例化配置更改的类 - 这意味着不能将构造函数参数传递给子类来传递参数，通常需要通过视图模型进行自定义回调以传回对话框的结果。这通常意味着每个对话框都有一个新的子类。
*   **解决方案**- 为了帮助解决这一切，这个自定义 AppDialog 片段来救援 - 参数存储在内存中（类似于视图模型，您可以将其视为将 T 保存在内存中并使用它的微型自定义视图模型在配置更改时重新创建对话框），直到对话框片段被解除。回调的正确方法是通过视图模型。如果显示 AppDialog 的片段，那么您可能已经有一个视图模型，并且您可以从用于创建对话框的 lambda 引用它 - 这意味着对视图模型的额外强引用，直到对话框片段被解除。
*   **示例**- 请参阅重构简单 Dialog 以使用此 AppDialog 实用程序类来接收参数并回调 viewModel 以通知结果的示例。

助手类：

```
 class AppDialog<T>: DialogFragment() {
    companion object {

        fun<T> buildDialog(params: T? = null, builder: AppDialogLambda<T>): AppDialog<T> {

            // Setup arguments
            val args = Bundle()
            args.putInt("key", pushDialogArgs(params, builder))

            // Instantiate
            val fragment = AppDialog<T>()
            fragment.arguments = args
            return fragment
        }

        // --------------------
        // Dialog Arguments

        private var lastKey: Int = 0
        private val dialogArgs = mutableMapOf<Int, Pair<Any?, AppDialogLambda<*>>>()

        private fun pushDialogArgs(params: Any?, builder: AppDialogLambda<*>): Int {
            dialogArgs[lastKey] = params to builder
            return lastKey++
        }

        private fun getDialogArgs(key: Int): Pair<Any?, AppDialogLambda<*>> {
            return dialogArgs[key]!!
        }

        private fun deleteDialogArgs(key: Int) {
            dialogArgs.remove(key)
        }
    }

    override fun onCreateDialog(savedInstanceState: Bundle?): Dialog {
        // Get arguments
        val argKey = requireArguments().getInt("key")
        val (params, builder) = getDialogArgs(argKey)

        // We are getting back our arguments we passed AppDialog.buildDialog and
        // the type is guaranteed to be the same. Silence this warning
        @Suppress("UNCHECKED_CAST")
        return (builder as AppDialogLambda<T>)(this, params as T?)
    }

    override fun onDismiss(dialog: DialogInterface) {
        super.onDismiss(dialog)
        val argKey = requireArguments().getInt("key")
        deleteDialogArgs(argKey)
    }
} 
```

示例用法（**后**）：

```
 val info = mapOf("message" to "${error.description}\n\nPlease check your Internet connection and try again.")
        AppDialog.buildDialog(info) { fragment, params ->
            fragment.isCancelable = false // since we are in a DialogFragment
            AlertDialog.Builder(fragment.context)
                .setTitle("Terms Of Service Failed To Load")
                .setMessage(params!!["message"])
                .setPositiveButton("Retry") { _, _ ->
                    // Update the view model instead of calling UserTOSFragment directly 
                    // as the fragment may be destroyed and recreated
                    // on configuration changes. The viewModel will stay alive.
                    viewModel.onTermsOfServiceReload()
                }
                .setNegativeButton("Cancel") { _, _ ->
                    viewModel.onTermsOfServiceDeclined()
                    fragment.findNavController().popBackStack()
                }.create()
        }.show(parentFragmentManager, "TOS Failed Dialog") 
```

示例用法（**之前**）：不使用 DialogFragment（出于说明目的，不要这样做，这是不好的做法，因为对话框将在配置更改时被破坏），UserTOSFragment.kt 中的代码 - 注意用于直接调用 UserTOSFragment 的代码。 loadContent() 重试。在上面的示例中，这必须重写为调用 viewModel.onTermsOfServiceDeclined() ：

```
 AlertDialog.Builder(context)
            .setTitle("Terms Of Service Failed To Load")
            .setMessage("${error.description}\n\nPlease check your Internet connection and try again.")
            .setPositiveButton("Retry") { _, _ ->
                loadContent()
            }
            .setCancelable(false)
            .setNegativeButton("Cancel") { _, _ ->
                viewModel.onTermsOfServiceDeclined()
                findNavController().popBackStack()
            }
            .show() 
```

* * *

## 回答 #15

> 赞同：-3
> 
> 时间：2017-09-20T16:18:36.923

只是将它作为选项之一（因为还没有人提到它） - 您可以使用像 Otto 这样的事件总线。所以在对话框中你这样做：

```
bus.post(new AnswerAvailableEvent(42)); 
```

并让您的调用者（活动或片段）订阅它：

```
@Subscribe public void answerAvailable(AnswerAvailableEvent event) {
   // TODO: React to the event somehow!
} 
```

# sql - sql compact 3.5，从每组中选择前 n 行

> ID：10905316
> 
> 赞同：1
> 
> 时间：2012-06-05T21:35:30.783
> 
> 标签：sql, sql-server-ce

我正在编写一个查询以从每个组中选择前 1 条记录。请记住，我正在使用 sql compact 3.5，因此无法使用 rank 函数。我很确定我的查询不正确，但我不确定如何从每个组中选择顶部。有人有任何想法吗？

这是我试图开始工作的查询

/* * 将 fH.InvoiceNumber 添加到我的查询中以进一步获取下面的结果。 */ 选择 tH。*, t.CustomerNumber, c.CustomerName, fH.Status, fH.InvoiceNumber fromtenderHeader tH join task t ON tH.TaskActivityID = t.ActivityID join finalizeTicketHeader fH ON tH.FinalizeTicketTaskActivityID = fH.TaskActivityID join customer c ON t.CustomerNumber = c .CustomerNumber 其中 fH.Status <> '3' AND t.TripID = '08ea6982-6efd-46fa-9753-0fd8b076f24c';

这是我的表的样子：

```
customer table:

|------------------------------------------------|
| CustomerNumber | CustomerName | Address1 | ... |
|------------------------------------------------|
| 0012084737     | Customer A   | 150 Rd A | ... |
|------------------------------------------------|
| 0012301891     | Customer B   | 152 Rd A | ... |
|------------------------------------------------|

task table

|-----------------------------------------------------------------|
| ActivityID | TripID    | TaskTypeName | Status | CustomerNumber | 
|-----------------------------------------------------------------|
| 4967f6cc   | 08ea6982  | Payment      | 2      | 0012084737     |
|-----------------------------------------------------------------|
| e96469a1   | 08ea6982  | Payment      | 2      | 0012301891     |
|-----------------------------------------------------------------|

finalizeTicketHeader table

|---------------------------------------------------|
| TaskActivityID | InvoiceNumber | Amount  | Status |
|---------------------------------------------------|
| 916082c8       | 1000          | 563.32  | 3      |
|---------------------------------------------------|
| 916082c8       | 1001          | -343.68 | 0      |
|---------------------------------------------------|
| 4b38bf60       | 1002          | 152.29  | 0      |
|---------------------------------------------------|
| 4b38bf60       | 1003          | -35.80  | 0      |
|---------------------------------------------------|

tenderHeader table

|-------------------------------------------------------------------------------------|
| TaskActivityID | InvoiceNumber | PastDue | TodaysDue | FinalizeTicketTaskActivityID |
|-------------------------------------------------------------------------------------|
| 4967f6cc       | 1234567891    | 23.55   | 219.64    | 916082c8                     |
|-------------------------------------------------------------------------------------|
| e96469a1       | 1234567893    | 0.00    | 116.49    | 4b38bf60                     |
|-------------------------------------------------------------------------------------| 
```

我遇到的问题是重复。

像这样：

```
|------------------------------------------------------------------------------------------------------------------------------------|
| TaskActivityID | InvoiceNumber | PastDue | TodaysDue | FinalizeTicketTaskActivityID | CustomerNumber | CustomerName | InvoiceNumber |
|------------------------------------------------------------------------------------------------------------------------------------|
| 4967f6cc       | 1234567891    | 23.55   | 219.64    | 916082c8                     | 0012084737     | Customer A   | 1001         |
|------------------------------------------------------------------------------------------------------------------------------------|
| e96469a1       | 1234567893    | 0.00    | 116.49    | 4b38bf60                     | 0012301891     | Customer B   | 1002         |              
|------------------------------------------------------------------------------------------------------------------------------------|
| e96469a1       | 1234567893    | 0.00    | 116.49    | 4b38bf60                     | 0012301891     | Customer B   | 1003         |
|------------------------------------------------------------------------------------------------------------------------------------| 
```

我已经像这样重写了查询，但是我需要从子查询中获取特定的列。

```
select tH.* from tenderHeader th
inner join task t on tH.TaskActivityID = t.ActivityID
inner join (
    select k.TaskActivityID from finalizeTicketHeader k group by k.TaskActivityID
) as fH on tH.FinalizeTicketTaskActivityID = fH.TaskActivityID
inner join customer c on t.CustomerNumber = c.CustomerNumber 
```

我需要从 fH 获取状态。关于如何做到这一点的任何想法？

```
select tH.*, fH.Status from tenderHeader th
inner join task t on tH.TaskActivityID = t.ActivityID
inner join finalizeTicketHeader fH on tH.FinalizeTicketTaskActivityID = tH.TaskActivityID
inner join customer c on t.CustomerNumber = c.CustomerNumber
where tH.FinalizeTicketTaskActivityID = (
    select top (1) k.TaskActivityID from finalizeTicketHeader k 
); 
```

但似乎 sql compact 3.5 在 where 原因中不支持带有子查询的标量值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T23:37:52.777

这是一个示例，展示了从每个组中选择前 1 名的方法

```
id|time
--------
2 | 1:10
2 | 0:45 
2 | 1:45
2 | 1:30
1 | 1:00
1 | 1:10 
```

该表称为table_1；我们按 id 分组并假设时间应该是 desc 排序的

```
 select table_1.* from table_1
 inner join (
     select id, max(time) as max_time from table_1
     group by id
 ) as t
 on t.max_time = table_1.time and table_1.id = t.id
 order by table_1.id 
```

我们得到的结果是

```
id|time
--------
1 | 1:10
2 | 1:45 
```

# database - 为 postgres 查询设计索引

> ID：10905319
> 
> 赞同：1
> 
> 时间：2012-06-05T21:35:42.623
> 
> 标签：database, performance, postgresql, indexing, profiling

我们有一个从主从简单模式中检索一些数据的查询。*WHERE*子句如下所示：

```
-- These are just random numbers
Where ticket.type_id in ( 2, 3, 4, 5, 7 ) and
      (
         ticket.color_id is null or
         ticket.color_id in ( 1, 2 , 8 )
      ) 
```

我们已经在列中有索引：ticket.type_id 和 ticket.color_id，无论如何 QUERY EXPLAIN ANALYZE 仍然向我们显示 Postgresql 正在进行顺序扫描以满足查询。

这个查询在系统中非常重要且经常出现，所以我们想专门为这种情况创建一个索引。

### 什么索引可以解决这种情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T23:13:46.307

首先，检查索引是否真的可以帮助您。在调用查询之前关闭序列扫描以强制使用索引：

```
SET ENABLE_SEQSCAN TO OFF; 
```

查询运行后：

```
SET ENABLE_SEQSCAN TO ON; 
```

重新启用序列扫描。如果这显示没有性能改进，Postgres 已经在选择正确的执行计划（序列扫描）。我会`explain analyze <query>`在打开和关闭序列扫描的情况下运行整个查询。

您是否`vacuum analyze`在相关表上运行过？计划程序可能没有正确或当前的查询统计信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T21:40:56.583

不太确定-但我认为null正在变得越来越好..

也许像这样一个奇怪的结构

```
Where ticket.type_id in ( 2, 3, 4, 5, 7 ) and
      (
         nvl(ticket.color_id,1) in ( 1, 2 , 8 )
      ) 
```

# asp.net-mvc - 基本的 asp.net MVC

> ID：10905320
> 
> 赞同：0
> 
> 时间：2012-06-05T21:35:45.650
> 
> 标签：asp.net-mvc

我是 MVC 的新手，我学习过的所有教程都非常简单。我想知道的是你如何从另一个文件中的一个类中实现一个动作？例如，我如何在一个单独的类中获得一个 xml 阅读器来工作：

```
 public ActionResult Index()
    {
        return View();
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T22:38:45.387

您将需要使用控制器顶部的“使用”指令来实现该类所属的命名空间。

```
using WhateverNamespace.XmlReaderNamespace; 
```

# android - Mac Android 模拟器没有出现

> ID：10905328
> 
> 赞同：1
> 
> 时间：2012-06-05T21:36:12.467
> 
> 标签：android, command, emulation

我已经在 Windows 上找到了这个问题的解决方案，但在 Mac 上没有。这里是：[Android 模拟器没有启动，显示“无效的命令行参数”](https://stackoverflow.com/questions/6638713/the-android-emulator-is-not-starting-showing-invalid-command-line-parameter)

模拟器以前工作过，但现在我收到这个奇怪的错误：

日志：

```
[2012-06-05 23:29:30 - Together Game Free] ------------------------------
[2012-06-05 23:29:30 - Together Game Free] Android Launch!
[2012-06-05 23:29:30 - Together Game Free] adb is running normally.
[2012-06-05 23:29:31 - Together Game Free] Performing com.motioncoding.togetherfree.TogetherGameActivity activity launch
[2012-06-05 23:29:31 - Together Game Free] Automatic Target Mode: launching new emulator with compatible AVD 'API4'
[2012-06-05 23:29:31 - Together Game Free] Launching a new emulator with Virtual Device 'API4'
[2012-06-05 23:29:31 - Emulator] invalid command-line parameter: emulator.
[2012-06-05 23:29:32 - Emulator] Hint: use '@foo' to launch a virtual device named 'foo'.
[2012-06-05 23:29:32 - Emulator] please use -help for more information 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T15:01:03.183

我重新安装了 eclipse 现在它又可以工作了。

# facebook - 在时间线上发布自定义 facebook 操作作为页面

> ID：10905330
> 
> 赞同：0
> 
> 时间：2012-06-05T21:36:20.847
> 
> 标签：facebook, facebook-opengraph, facebook-page, custom-action

我已经使用 Open Graph 创建了一个自定义对象和自定义操作，并且它们已经获得了 facebook 的批准。我能够以用户身份发布此自定义操作，但不能以页面的形式发布。

我遵循的步骤是：

1.  用户通过登录对话框授权应用程序，授予 publish_actions 权限
2.  我将短命的 user_access_token 换成长命的。
3.  我获取[https://graph.facebook.com/me/accounts?access_token=](https://graph.facebook.com/me/accounts?access_token=) ... 并获取 page_access_token
4.  我尝试代表页面在页面时间轴上发布自定义操作，但没有成功，得到一条神秘`OAuthException`的消息“发生了未知错误”。

身份验证对话框正确询问所有权限，并代表用户在用户墙上发布相同的自定义操作正常工作。

这是一个错误还是我错过了什么？有人设法将自定义操作发布为页面吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T21:42:22.457

我认为您*不能*以页面的形式执行操作——操作需要由真实的人来执行……</p>

# php - 无法根据 traceroute 结果在谷歌地图 v3 中显示多个标记

> ID：10905333
> 
> 赞同：1
> 
> 时间：2012-06-05T21:36:25.900
> 
> 标签：php, google-maps-api-3, traceroute

我是 php mysql 和 google maps v3 的新手。我在谷歌地图 v3 中遇到问题。我制作了基于 web 的 traceroute 并将 traceroute 的结果映射到谷歌地图 v3 中，用于我的大学教育的最终项目。我尝试了很多教程，但没有奏效。我也试过这个论坛的教程，但没有任何效果。所以我的问题是我无法显示从数据库中获取位置数据的多个标记。也许是因为我是新手，不知道该怎么做。我也混淆了循环显示标记。所以这是代码

```
<?php
error_reporting(E_ALL ^ (E_NOTICE));
ini_set('max_execution_time', 360);
$enable_log_user = FALSE;

global $ip, $host_name,  $host_ip;

$host  = @$_POST['host']; 
$trace = @$_POST['trace'];
$self  = $_SERVER['PHP_SELF'];

include("phpsqlajax_dbinfo.php");
$connection = mysql_connect ('127.0.0.1', $username, $password);
if (!$connection) {  die('Not connected : ' . mysql_error());} 

$db_selected = mysql_select_db($database, $connection);
if (!$db_selected) {
  die ('Can\'t use db : ' . mysql_error());
} 

?>
<!DOCTYPE html >
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <title>PHP/MySQL & Google Maps Example</title>
    <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>
    <script type="text/javascript">
    //<![CDATA[

 </script>
  </head>
<body onload="initialize()">
var pinImage = new google.maps.MarkerImage ("http://chart.apis.google.com/chart?chst=d_map_xpin_letter_withshadow&chld=pin_star|%E2%80%A2|CC3300|000000|FF9900",
        new google.maps.Size (70, 83),
        new google.maps.Point (0,0),
        new google.maps.Point (10,34));
    var pinShadow = new google.maps.MarkerImage ("http://chart.apis.google.com/chart?chst=d_map_pin_shadow",
        new google.maps.Size (89, 85),
        new google.maps.Point (0, 0),
        new google.maps.point (12, 35));

    var map;
    function initialize() {
    var myLatlng = new google.maps.LatLng(41.258531,-96.012599);
    var myOptions = {
    zoom: 2,
    center: myLatlng,
    mapTypeId: google.maps.MapTypeId.ROADMAP
    }
    map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
    <!-- var infoWindow = new google.maps.InfoWindow; -->
    } 
    </script>
    <form name="tools" action="<?php $self ?>" method="post">
    <p><font size="2">Your IP is <?php $ip ?> </font></p>
    <input type="text" name="host" value=""></input>
    <input type="submit" name="trace" value="Traceroute!"></input>
    </form>
    <?php
    if ($_POST['submit']) 
{
    if (($host == 'Enter Host or IP') || ($host == "")) {
        echo '<br><br>You must enter a valid Host or IP address.';
        exit; } 

    if(eregi("^[a-z]",  $host))
    {
        $host_name = $host;
        $host_ip = gethostbyname($host);
    }
    else
    {
        $host_name = gethostbyaddr($host);
        $host_ip = $host;
    } 
}

    $host= preg_replace ("[-a-z0-9!#$%&\'*+/=?^_`{|}~]","",$host);
    $command = "tracert $host";
    $fp = shell_exec("$command 2>&1");
    $output .= (htmlentities(trim($fp)));
    echo "<pre>$output</pre>";
    echo '<br/>';

    $array = array($output);
    $space_separated = implode(" ", $array);

    function explodeRows($data) {
      $rowsArr = explode("\n", $data);
      return $rowsArr;
    }
    function explodeTabs($singleLine) {
      $parsed = preg_split('/ +/', $singleLine);
      return $parsed;
    }
    $data     = $space_separated;
    $rowsArr  = explodeRows($data);

    for($a=3;$a<count($rowsArr)-2;$a++) 
    {
        $lineDetails[$a] = explodeTabs($rowsArr[$a]);

        if (empty($lineDetails[$a][9]))
        {
            $ipList[] = $lineDetails[$a][8];
        }
        else
        {
            $ipList[] = substr($lineDetails[$a][9], 1, -1);
        }
    }

    for ($b=0; $b<count($ipList); $b++)
    {
        if ($ipList[$b] != "")
        {
            $arrLine[]=$ipList[$b];
        }
    }

function ip_address_to_number($IPaddress)
{
    if ($IPaddress == "") {
        return 0;
    } else {
        $ips = explode (".", "$IPaddress");
        return ($ips[3] + $ips[2] * 256 + $ips[1] * 256 * 256 + $ips[0] * 256 * 256 * 256);
    }
}
for($c=0; $c<count($arrLine); $c++) {
$integer[] = ip_address_to_number($arrLine[$c]);
}
    foreach ($integer as $lokasi) {
    $query = "SELECT cl.locId, cl.country as country, cl.region as region, cl.city as city, cl.postalCode as postalCode, cl.latitude as latitude, cl.longitude as longitude, cl.metroCode as metroCode, cl.areaCode as areaCode
    FROM (SELECT locId as idcihuy FROM cityblocks WHERE $lokasi BETWEEN startIpNum AND endIpNum) cb, citylocation cl WHERE cb.idcihuy = cl.locId";
    $result = mysql_query($query);
    while ($location = @mysql_fetch_assoc($result)){
    $country[] = $location['country'];
    $region[] = $location['region'];
    $city[] = $location['city'];
    $postalCode[] = $location['postalCode'];
    $latitude[] = $location['latitude'];
    $longitude[] = $location['longitude'];
    $metroCode[] = $location['metroCode'];
    $areaCode[] = $location['areaCode'];
    }
    }
    ?>
    <script type="text/javascript">
     var point = new google.maps.LatLng(<?php echo $latitude ?>, <?php echo $longitude; ?>);
     var icon = pinImage;
     var marker = new google.maps.Marker({
        map: map,
        position: point,
        icon: pinImage,
        shadow: pinShadow
        });
    </script>
<div id="map_canvas" style="width: 900px; height: 500px"></div>
</body>
</html> 
```

好的，这是我的 html 源代码，是的，它似乎有问题：

```
<!DOCTYPE html >

  <head>

    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />

    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>

    <title>PHP/MySQL & Google Maps Example</title>

    <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>

    <script type="text/javascript">

    //<![CDATA[

    var pinImage = new google.maps.MarkerImage ("http://chart.apis.google.com/chart?chst=d_map_xpin_letter_withshadow&chld=pin_star|%E2%80%A2|CC3300|000000|FF9900",

        new google.maps.Size (70, 83),

        new google.maps.Point (0,0),

        new google.maps.Point (10,34));

    var pinShadow = new google.maps.MarkerImage ("http://chart.apis.google.com/chart?chst=d_map_pin_shadow",

        new google.maps.Size (89, 85),

        new google.maps.Point (0, 0),

        new google.maps.point (12, 35));

    var map;

    function initialize() {

    var myLatlng = new google.maps.LatLng(41.258531,-96.012599);

    var myOptions = {

    zoom: 2,

    center: myLatlng,

    mapTypeId: google.maps.MapTypeId.ROADMAP

    }

    map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

    <!-- var infoWindow = new google.maps.InfoWindow; -->

    } 

    </script>

  </head>

<body onload="initialize()">

<form name="tools" action="" method="post">

    <p><font size="2">Your IP is  </font></p>

    <input type="text" name="host" value=""></input>

    <input type="submit" name="trace" value="Traceroute!"></input>

    </form>

    <pre>Tracing route to detik.com [203.190.242.69]
over a maximum of 30 hops:

  1     *        *        *     Request timed out.
  2   199 ms   177 ms   179 ms  192.168.36.11 
  3   385 ms   359 ms   299 ms  192.168.39.8 
  4  2005 ms  1400 ms  1536 ms  192.168.39.8 
  5  1857 ms  1277 ms  1874 ms  192.168.36.11 
  6  2359 ms  3401 ms     *     192.168.39.196 
  7  2477 ms  2641 ms     *     114.127.254.78 
  8  2230 ms  1203 ms  1570 ms  114.127.254.2 
  9  1595 ms  1642 ms  3005 ms  giga-0-0.openixp.net [218.100.27.129] 
 10     *        *        *     Request timed out.
 11     *     2517 ms  3294 ms  203.190.244.6 
 12  1632 ms  2961 ms  1297 ms  203.190.242.69 

Trace complete.</pre><br/>

    <script type="text/javascript">

     var point = new google.maps.LatLng(-5.0000, 120.0000);

     var icon = pinImage;

     var marker = new google.maps.Marker({

        map: map,

        position: point,

        icon: pinImage,

        shadow: pinShadow

        });

    </script>

<div id="map_canvas" style="width: 900px; height: 500px"></div>

</body>

</html> 
```

好吧，如果你们阅读我的代码，我真的很抱歉。看起来很乱。因为我不知道如何很好地显示代码。我想得到帮助的最重要的事情是在地图上。了解如何显示所有标记。尤其是循环。谷歌地图不显示标记。它只显示地图。所以对于所有阅读这个问题的大师。我只是需要你尽快的帮助。如果我的英语不好并且我对你们的错误，我真的很抱歉。提前致谢。

# android - Android：录音和保存音频

> ID：10905337
> 
> 赞同：9
> 
> 时间：2012-06-05T21:36:33.020
> 
> 标签：android, android-intent, android-mediaplayer, voice-recognition, android-audiomanager

我正在开发应用程序，它将记录用户的声音并将文件保存在 SD 卡上，然后允许用户再次收听音频。

我能够允许用户使用 RecognizerIntent 录制他的声音，但我不知道如何保存音频文件并允许用户听到音频。如果有人可以帮助我，我将不胜感激。我在下面显示了我的代码：

```
 // Setting up the onClickListener for Audio Button
    attachVoice = (Button) findViewById(R.id.AttachVoice_questionandanswer);
    attachVoice.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
        Intent voiceIntent = new Intent(RecognizerIntent.ACTION_RECOGNIZE_SPEECH);
        voiceIntent.putExtra(RecognizerIntent.EXTRA_LANGUAGE_MODEL, RecognizerIntent.LANGUAGE_MODEL_FREE_FORM);
        voiceIntent.putExtra(RecognizerIntent.EXTRA_PROMPT, "Please Speak");
        startActivityForResult(voiceIntent, VOICE_REQUEST);
        }
    });

protected void onActivityResult(int requestCode, int resultCode, Intent data) {

  if(requestCode == VOICE_REQUEST && resultCode == RESULT_OK){

} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-05T21:48:04.573

[Android 开发者文档](http://developer.android.com/guide/topics/media/audio-capture.html)中有一个如何使用 MediaRecorder 进行音频捕获的示例。

我建议将文件保存在 SD 卡上，然后让您的画廊代码检查 SD 卡以查看要显示的文件。[您可以使用Environment.getExternalStorageDirectory()](http://developer.android.com/reference/android/os/Environment.html#getExternalStorageDirectory%28%29)方法获取 SD 卡的目录。最好将文件保存在 SD 卡根目录的子目录中。

确保为您的应用程序提供所需的[权限](http://developer.android.com/guide/topics/security/security.html#permissions)。至少它需要[RECORD_AUDIO](http://developer.android.com/reference/android/Manifest.permission.html#RECORD_AUDIO)和[WRITE_EXTERNAL_STORAGE](http://developer.android.com/reference/android/Manifest.permission.html#WRITE_EXTERNAL_STORAGE)。

您还必须查看这些教程：

[http://www.androiddevblog.net/android/android-audio-recording-part-1](http://www.androiddevblog.net/android/android-audio-recording-part-1)

[http://www.androiddevblog.net/android/android-audio-recording-part-2](http://www.androiddevblog.net/android/android-audio-recording-part-2)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T16:38:41.720

如果你*真的*想通过语音识别 API 录制音频，那么你可以使用[RecognitionService.Callback](http://developer.android.com/reference/android/speech/RecognitionService.Callback.html)它有一个方法

```
void bufferReceived(byte[] buffer) 
```

这使您可以在录制和识别语音时访问录制的音频缓冲区。（虽然没有提供有关采样率的信息。）然后您可以将获得的缓冲区保存到文件中以供以后播放。我认为键盘应用程序使用此调用来显示录制语音的波形。您必须自己实现 UI。

bare`RecognizerIntent.ACTION_RECOGNIZE_SPEECH`只返回一组没有任何音频的单词/短语。

# git - 使用 git 存储系统配置

> ID：10905340
> 
> 赞同：1
> 
> 时间：2012-06-05T21:36:45.550
> 
> 标签：git

我想使用 git 来管理我的 linux 机器的配置。我开始将存储库文件夹放入系统根目录：

```
cd /
git init 
```

当我现在移动到 /etc 文件夹并执行操作时，`git status`我得到：“# 目前不在任何分支上。” 并将根文件夹中所有项目的列表视为“未跟踪文件”。

我究竟做错了什么？

奥利弗

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T21:39:58.767

`git init`初始化一个没有提交和没有头（即分支）的*空存储库。*您必须先添加内容并创建至少一个提交才能`master`创建分支 ( )。

例如：

```
git add /etc/.
git commit -m 'Add all /etc/ data' 
```

如果您打算为此使用 git，那么您*确实*应该将许多文件添加到一个文件中，`.gitignore`并且通常只添加那些您确实想要添加到存储库中的文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T22:30:16.973

也许您应该使用 etckeeper，它将您的 etc 配置存储在 git（或任何其他 dvcs）存储库中。它可以与包管理器集成，以便在您安装包时自动创建新快照。

[http://joeyh.name/code/etckeeper/](http://joeyh.name/code/etckeeper/)

# sharepoint - Microsoft SharePoint 2010 一对多

> ID：10905341
> 
> 赞同：1
> 
> 时间：2012-06-05T21:36:51.273
> 
> 标签：sharepoint

是否可以在 Microsoft SharePoint 2010 中的两个列表之间创建某种一对多关系？如果可能的话，我想知道如何。

让我知道，

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T21:53:32.980

这完全取决于您想要什么。您可以使用列表或内容类型中的自定义字段创建对另一个列表的查找。

但是，如果您想通过一对多的关系达到最大值，那么您将不得不使用一些使用 c# 代码的自定义字段来创建一个自定义字段。

# javascript - 在输入类型=“文本”上按“输入”，如何？

> ID：10905345
> 
> 赞同：10
> 
> 时间：2012-06-05T21:37:06.967
> 
> 标签：javascript, jquery, html

我面临一个无法解决 JQuery Javascript 的问题。你能帮助我并帮助我理解吗？首先这是我的代码：

```
 (...)

        <script type="text/javascript">

        // Autocomplete suggestions
        $(function () {
            $("#autoCompInput").autocomplete({
                source: "/Suggestions",
                minLength: 3,
                select: function (event, ui) {
                    if (ui.item) {
                        $("#autoCompInput").val(ui.item.value);
                        $("form").submit();
                    }
                }
            });
        });

        // Provide search results
        $(function () {
            $("#autoCompSearch").click(function () {
                var searchParameters = $("#autoCompInput").val();

                var jsonData = JSON.stringify(searchParameters, null, 2);
                window.location = "/Search?criteria=" + searchParameters;
            });
        });

    </script>

    (...)

    <input class="ui-autocomplete-input" id="autoCompInput" role="textbox" aria-haspopup="true" size="50" autocomplete="off" aria-autocomplete="list" value = "@ViewBag.SearchInfo"/>
            <a id= "autoCompSearch" href = "#" ><img src="@Url.Content("~/Content/Menu/Images/magnifier.png")" alt="Search" /></a>

    (...) 
```

使用此代码，我无法使用“Enter”键执行搜索。当用户在输入 autoCompInput 时，我希望能够检测他是否按下“输入”并启动提交。我读到我必须添加一个 onkeyup="onKeyPressed(event)" 事件，但我不明白如何编写与命令关联的 javascipt。我试过但没有成功......你有我的解决方案吗？

谢谢，

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-05T21:51:06.517

您应该将按键事件绑定到您的输入

```
$("#autoCompInput").bind("keypress", {}, keypressInBox);

function keypressInBox(e) {
    var code = (e.keyCode ? e.keyCode : e.which);
    if (code == 13) { //Enter keycode                        
        e.preventDefault();

        $("yourFormId").submit();
    }
}; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-05T21:55:57.717

使用类似的 HTML：

```
<input type="text" id="myTxt" />
<input type="submit" id="mySubmit" /> 
```

这个脚本（它使用最新的[jQuery 1.7.2](http://blog.jquery.com/2012/03/21/jquery-1-7-2-released/)）应该这样做：

```
$('#mySubmit').click(function() {
    alert('Submitted!');
    return false;
});

$('#myTxt').on('keyup', function(e) {
    if (e.keyCode === 13) {
        $('#mySubmit').click();
    }
}); 
```

这是一个[工作示例](http://jsfiddle.net/S6WXN/)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-05T21:51:47.443

在 jquery 中分配 keyup 事件

```
 $("#autoCompInput").keyup(function(event) {
                if (event.keyCode==13) {
                    alert('enter key');
                }
            }); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-01-20T20:16:45.987

我认为对于这类问题有更好、更标准的解决方案。

您可以围绕这些输入创建一个 GET 表单，并且每当您在该表单内的任何输入上按 Enter 键时，它将被提交给表单的 action 属性中的任何内容。这就是它的样子（我拿走了你的代码，但我正在删除与我的答案无关的位）：

```
<form id="idForJqueryOnly" action="/Search" method="GET">
  <input type="text" name="criteria" value="someuserinput"/>
  <button type="submit"><img src="...")" alt="Search" /></button>
</form> 
```

这是标准的浏览器行为。那么，表格有什么作用呢？当提交时，浏览器会创建一个这样的 URL： [http://yourserverguesedfromthecurrenturl/Search?criteria=someuserinput](http://yourserverguesedfromthecurrenturl/Search?criteria=someuserinput) 发生的事情是浏览器从表单中获取了所有带有名称和值（而不是禁用）的输入，并将它们序列化为 url 表单。现在，只要按钮没有属性 type="button"，就可以通过在里面的任何输入上按 enter 来触发提交事件，包括按钮。

如果您想在进入搜索页面之前使用 javascript 对数据执行更多操作，您可以使用 jquery 执行此操作：

```
$("#idForJqueryOnly").submit(function(){
   // here you can do stuff like serialize the form, or sanitize the input of tue user.
  var data = $("#idForJqueryOnly").serialize();
  $("[name=criteria]").val($("[name=criteria]").val().customSanitizeMethod());

  // if you return false, the form will not submit, say, for validation errors:
  return customValidator.isFormValid("#idForJqueryOnly");
}) 
```

# c# - 使用反射设置控件样式时的效率

> ID：10905347
> 
> 赞同：1
> 
> 时间：2012-06-05T21:37:13.200
> 
> 标签：c#, reflection, double-buffering

**背景**

我目前正在尝试修复一些行为，如果控件太大而无法分配缓冲区，则双缓冲会导致崩溃。

经过多次讨论和反复试验，我们决定最好的做法是为控件启用双缓冲，如果大小将支持它（比如小于 3000x3000 像素），但如果它超过该大小阈值，那么我们将以编程方式关闭双缓冲。

事实证明这样做相当烦人，因为 GetStyle 和 SetStyle 方法受到保护，并且有许多我们需要禁用双缓冲的第 3 方控件。为了克服这个问题，我创建了一个辅助方法，通过反射禁用双缓冲，这似乎是万恶之源。然后我通过 Layout 事件监控控件的大小，并相应地设置 DoubleBuffer 和 OptimizedDoubleBuffer 标志。

**问题**

我对反射并不太熟悉，我的主要问题是我应该期望通过 MethodInfo.Invoke 方法获取/设置 ControlStyles 对性能产生什么样的影响。

特别是，我想知道通过首先读取值来防止设置 DoubleBuffer/OptimizedDoubleBuffer ControlStyles 是否有帮助（这也必须通过反射使用 GetStyle() 来完成）。还是每次只调用 SetStyle() 基本相同。我很担心，因为 Layout 事件被调用了很多，我不想仅仅因为这个双缓冲跟踪逻辑而严重降低性能。

任何输入都将不胜感激，特别是关于我正在做的事情的性能影响，而且如果有人有更好的想法，只有在超过一定大小时才禁用控件的双缓冲。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T21:40:58.250

我建议您先阅读样式，看看是否需要调用 SetStyle。设置样式可能很昂贵。

与分配双缓冲区和绘图相比，少量的反射访问实际上微不足道。别想了。

# wordpress - Wordpress - 帖子页面关联问题

> ID：10905348
> 
> 赞同：0
> 
> 时间：2012-06-05T21:37:20.347
> 
> 标签：wordpress, plugins, associations

对于我正在处理的客户站点，客户希望能够将某些自定义帖子类型与给定页面相关联。我的主管已将我指向以前做过类似事情的客户的网站。他们使用了 Post Page Associator 插件（似乎已从插件列表中删除）。

这是我正在使用的插件的链接：[http ://www.mediafire.com/?2dpbxac73rsn8l6](http://www.mediafire.com/?2dpbxac73rsn8l6)

我已尽力修改插件内的代码以处理我想使用的自定义帖子类型（这些更改包含在下载中）。主要冲突来自这段代码（来自之前客户端的page.php文件）

```
<?php 
    $sidebar = new WP_Query( $args ); //queries for posts
    $sidebar = wp_plugin_post_page_associator::get_associated_posts ($post->ID); //looks for associated posts via the plugin, the main offending line of code
    if ($sidebar!="") : while ( $sidebar->have_posts() ) : $sidebar->the_post();
    ?>
    <div id="sidebar-content"> <!-- sidebar area -->
        <h1 class="blue-text"><?php the_title(); ?></h1> <!-- the title of the associated post -->
        <div class="divider"></div>
        <?php the_content(); ?> <!-- the content of the associated post-->
        <br/><br/>
    </div>
    <?php endwhile;  else:?>

        <br/><br/>
    <?php endif; ?> 
```

我想知道是否有办法确定相关内容的帖子类型，以便我可以相应地更改 WP_Query 设置。如果我用 $sidebar 注释掉第二行代码，那么所有帖子都会显示在侧边栏中。有没有解决这个问题的方法，或者有更好的插件吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T15:35:56.093

我找到了一个替换插件，它完全符合我的需要并向我展示了如何去做：[http ://www.cssigniter.com/ignite/custom-post-types-relationships/](http://www.cssigniter.com/ignite/custom-post-types-relationships/)

# plone - 如何将翻译添加到 Plone 网站首页

> ID：10905349
> 
> 赞同：0
> 
> 时间：2012-06-05T21:37:26.560
> 
> 标签：plone, multilingual, linguaplone

我在一个用英语和西班牙语编写的网站中使用 LinguaPlone。除首页文件夹外，所有网站页面和文件夹都可以翻译。我认为我可以翻译首页文件夹用作视图的页面，但在这种情况下，当用户转到首页时，仅显示文件夹视图（而不是其翻译）。

我正在使用 Plone 4.1.4 和 LinguaPlone 4.1.2。也许我需要尝试使用其他工具，例如 raptus.multilingualplone。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T09:13:57.170

通常，在设置 LinguaPlone 站点时，您让 LinguaPlone 创建作为导航根的顶级每种语言文件夹。站点本身的根设置为使用语言选择器根据访问者的语言偏好和其他因素将访问者重定向到这些根之一。

查看[http://www.norden.org/](http://www.norden.org/)以获取此类站点的示例。请注意，当您访问该 URL 时，您会自动重定向到一种受支持的语言，通常是[http://www.norden.org/en/](http://www.norden.org/en/)以获取英语。您可以在左上角的可用语言之间切换，您会看到 URL 的第一个元素在语言代码之间发生变化。这些是顶级文件夹。

这里的优点是这些文件夹中的每一个都可以有自己的默认视图。另一个是 URL 对访问者来说总是一清二楚。从“关于这个网站”（http://www.norden.org/en/about-this-website）切换到挪威语翻译，你最终会在[http://www.norden.org/no/om- nettstedet](http://www.norden.org/no/om-nettstedet) ; 任何人都可以看到新 URL 使用的是挪威语，即使他们不懂该语言。

您可以在事后设置这些语言文件夹，如[LinguaPlone 安装说明](https://pypi.python.org/pypi/Products.LinguaPlone/4.1.2#installation)中所述；只需访问网址：

```
http://localhost:8080/Plone/@@language-setup-folders 
```

但请务必先备份您的站点并根据您的本地情况调整地址。

# javascript - 为什么 ",,," == Array(4) 在 Javascript 中？

> ID：10905350
> 
> 赞同：120
> 
> 时间：2012-06-05T21:37:33.777
> 
> 标签：javascript

启动您的解释器/控制台并尝试比较

```
> ",,," == Array(4)
True 
```

为什么？起初我想也许因为你可以把“,,”想象成一个由 '\0' 终止切片的四个字符的数组，这可能就是为什么，但是

```
> "..." == Array(4) 
```

返回“假”。所以为什么？我知道这是在 Javascript 中输入一些特殊的鸭子，但只是好奇是什么强调了这种行为。顺便说一句，从 Zed Shaw 的出色[演示](http://vimeo.com/43380467)中收集到这一点。

* * *

## 回答 #1

> 赞同：177
> 
> 时间：2012-06-05T21:40:15.450

因为右手操作数被转换为字符串并且字符串表示`Array(4)`为`,,,`：

```
> Array(4).toString()
  ",,," 
```

如果您使用数组构造函数并传递一个数字，它会将数组的长度设置为该数字。因此，您可以说您有四个空索引（与 相同`[,,,]`），并且数组的默认字符串表示形式是其元素的逗号分隔列表：

```
> ['a','b','c'].toString()
  "a,b,c" 
```

* * *

[规范的第 11.9.3](http://es5.github.com/#x11.9.3)节描述了比较的工作原理。在那里你会看到（`x == y`）：

> 8\. 如果 Type( *x* ) 是 String 或 Number 并且 Type( *y* ) 是 Object，则
> 返回比较结果*x* == [ToPrimitive](http://es5.github.com/#x9.1) ( *y* )。

*[（数组是 JavaScript 中的对象）]*

如果您遵循该`ToPrimitive`方法，您最终会发现它调用了`toString`.

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-06-05T21:40:18.840

尝试使用`===`. 在 Javascript 中使用`==`时，它会尝试转换变量，从而导致像这样的问题。控制台正在转换`Array(4)`为字符串表示形式（即`Array(4).toString`），即`",,,"`. 逗号存在的原因是该`.toString()`函数将它们添加到数组中的单独项目中。

请参阅下面的片段：

```
document.write( Array(4).toString() );
```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2012-06-05T21:40:57.107

在内部它正在运行

```
",,," == Array(4).toString() 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2012-06-05T22:31:22.910

这是因为`Array(4)`初始化了一个由 4 个空值组成的数组，一个`==`隐式转换，所以：

```
 ",,," == Array(4)

 ",,," == Array(4).toString()

 ",,," == ["", "", "", ""] // note 3 commas for 4 values

 ",,," == ["", "", "", ""].toString() 
```

都是相似的。

`==`在比较值之前进行隐式类型转换，这可能会导致不可预测的结果。用于`===`检查类型和值。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-06-05T21:41:00.507

将数组与字符串进行比较会在进行比较之前将数组强制转换为字符串。将一个空的 4 元素数组强制为一个字符串会产生该确切的字符串。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-06-07T21:56:22.250

我一开始以为是“原型”的东西……但经过一番调查，我得出了一个悲伤的结论……

显然这是一个内部和更晦涩的 js 东西，没有太多逻辑......

试试看嘛

```
Array(4)==Array(4) 
```

并且对类型也没有强制...

```
Array(4)===Array(4) 
```

你会得到 FALSE

你知道的，`null==null`甚至`null===null`返回TRUE......所以......它有点晦涩......`undefined==undefined``undefined===undefined`

`Array(4)==[,,,]`也应该是真的

# ruby-on-rails-3 - 按非拉丁字符的名称搜索

> ID：10905355
> 
> 赞同：0
> 
> 时间：2012-06-05T21:38:01.297
> 
> 标签：ruby-on-rails-3

我正在尝试使用，

`Product.order(:name).where("name like ?", params[:term])`

其中 :term 是非拉丁字符（希伯来语）。我的应用程序和数据库都设置为 UTF-8 application.rb

`config.encoding = "utf-8"`

数据库

`utf8_unicode_ci`

我正在搜索的特定名称在数据库中，但搜索结果为空。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T06:32:14.620

我必须在中添加我自己的 %`params[:term:]` 所以现在是

`Product.order(:name).where("name like ?", params[:term]+"%")`

我不确定这是否是实现我想要的最佳方式，但它仍然有效......

# php - 如何在一定时间后采取行动（因用户而异）？

> ID：10905357
> 
> 赞同：0
> 
> 时间：2012-06-05T21:38:03.630
> 
> 标签：php, javascript, mysql, cron

我正在开发一个网页游戏（js php mysql），其中一个人单击一个按钮来开始一个需要时间才能完成的动作（比如说10个小时），当它完成时，一些分数会被添加到该玩家的总数中。问题是即使玩家在动作完成时不在线，我也需要添加这些积分。例如，我需要更新排名，或者向玩家发送电子邮件。

我想过一个 cron 作业不断检查结束动作，但我认为这会杀死资源（不断检查数千名玩家的动作..）。

这个问题有更好的解决方案吗？

感谢您的关注！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T21:42:36.257

您可以在完成后写入您的数据库，当用户登录时，您可以将获得的积分添加到他的帐户中。您也可以使用 cronjob 进行检查。即使您有数百万用户，*这*也不会杀死您的服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T21:42:24.337

Cron 非常适合这个。您可以在存储过程中编写您的任务，然后让 cron 运行一个 SQL 脚本来调用将更新您的玩家记录的存储过程。

数据库旨在有效地处理成千上万条信息，因此我不认为它会杀死系统资源的想法是有效的，除非您的托管系统已经受到限制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T21:48:28.507

如果您想安全地防止作弊，则无论如何都需要在服务器上进行检查。如果“等待”将发生在客户端的 Javascript 中，则可以轻松减少剩余时间。

因此，您需要将作业发送到服务器（假定可以安全地防止时钟修改），服务器将确定结束时间戳。您可以将作业存储在队列中。

如果您只需要用户本人的此信息，则可以在用户登录时查看队列。否则每分钟（左右）运行一次 cron 作业。该作业将标记所有作业在其时间戳过去时已完成（并将它们从数据库中删除）。

如果您需要更精确的检查，您将需要提出一个更频繁地执行此操作的替代服务器端解决方案（例如，每隔几秒轮询一次数据库的简单程序）。

# c# - 为字符串中的每个项目创建正则表达式搜索实例

> ID：10905358
> 
> 赞同：-1
> 
> 时间：2012-06-05T21:38:06.570
> 
> 标签：c#, regex

```
using Visual.Web.Developer.2010.Express; 
```

N00b 在这里，
我将如何为中的每一行文本创建一个搜索实例`string1`？我想全面搜索`string2`，看看它是否在`string1's`搜索实例中包含`string2`. 两者`string1`和`string2`都有由 . 分隔的文本行`'\n'`。有什么明显的方法可以做到这一点吗？有人建议使用正则表达式，但我将如何合并正则表达式来查找和打印..`string2`中每个项目的匹配项。与..`string1``string2``string1`

一些在`string1`：
Part_numbers
1017FOO
1121BAR
*等...*

一些在`string2`：
SUPERCOLA A 51661017FOOAINDO
DASUDAMA C 89891121BARBLO5W
*等...*

可能稍后会解决这个问题，但我希望它们像这样格式化，仅供参考

1017FOO 匹配：
SUPERCOLA A 51661017FOOAINDO
+1017FOO 匹配的另一个 +
*等等...*

提前致谢！
寻找正确方向的指针，我应该使用什么方法

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T21:51:31.850

您的书面要求不需要正则表达式，所以我没有使用它们。如果需要，您应该能够很容易地合并它们...

```
string partNumbers = @"1017Foo
1121BAR
SomethingElse";
string searchText = @"SUPERCOLA A 51661017FOOAINDO
DASUDAMA C 89891121BARBLO5W";

string[] searchTerms = partNumbers.Split('\n');
string[] searchedLines = searchText.Split('\n');

StringBuilder output = new StringBuilder();

foreach(string searchTerm in searchTerms){
    int matchCount = 0;

    output.AppendLine(string.Format("For term: {0}", searchTerm.Trim()));
    foreach(string searchedLine in searchedLines){
        if(searchedLine.Trim().ToLower().Contains(searchTerm.Trim().ToLower())){
            output.AppendLine(searchedLine.Trim());
            matchCount++;
        }
    }

    if(matchCount == 0){
        output.AppendLine("There was no match");
    }

    output.AppendLine("== End of search ==");
}

Console.WriteLine(output.ToString()); 
```

# python - 需要将python库导入网络服务器

> ID：10905368
> 
> 赞同：-3
> 
> 时间：2012-06-05T21:39:14.893
> 
> 标签：python, import, sqlite

我想在使用 sqlite3 库的网络服务器上运行一个 python 文件，但我不知道如何在我的服务器上安装它。

编辑：我们在网络解决方案服务器上使用 python mod CGI。出于某种原因，他们的 Python 安装没有 sqlite 包。我在这里（作为初级开发人员）试图问的是我们如何在他们的服务器上安装一些东西——这可能是不可能的，因为我们没有 SSH 或 root 访问权限来运行`pip install`。尽管如此，请忽略这个问题，因为它非常古老并且没有被正确询问。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T22:00:30.850

sqlite3 是[Python 标准库](http://docs.python.org/library/sqlite3.html)的一部分。因此，如果在应用程序服务器上安装了 python，那么它将使用该库。您的问题似乎是让您的 Web 服务器使用 python。这取决于许多不同的事情，从您的 Web 服务器开始。

这里有几个起点：

[轻量级](http://www.jakehilton.com/?q=node/54)

apache [modwsgi](http://code.google.com/p/modwsgi/)或[mod_python](http://www.modpython.org/)

[nginx](http://kbeezie.com/view/circuits-nginx-uwsgi/)

# css - div 没有堆叠在其他元素之上

> ID：10905370
> 
> 赞同：1
> 
> 时间：2012-06-05T21:39:17.643
> 
> 标签：css

我在获取作为 ftrBottomBanner div 背景的图像时遇到了一些问题，该图像位于我页面上的黑色和绿色区域的顶部。我已经在 999 处尝试了 div 的 z-index，并且没有运气也将溢出属性添加到父 div。我知道这很简单，但找不到我所缺少的。

下图是我想要实现的。将橙色横幅定位在 div 内的黑色上方并与黑色和绿色区域重叠。

示例图片：[http ://www.woodsequipment.com/uploadedimages/layering_question.png](http://www.woodsequipment.com/uploadedimages/layering_question.png)

黑色和绿色带是相对定位的单独 div，并且有一个以黑色区域为中心的容器 div，它将包含一个菜单，然后是橙色横幅。

我想要做的是让橙色横幅重叠到绿色区域。

这是CSS：

```
/**** Footer ****/
div#footer{position:relative; width:100%; bottom:0; border:1px solid blue;}
    div#footerBlackRibbon{position:relative; height:51px; width:100%; background-color:#000000;border:1px solid white;}
    div#bottomMenuContainer{position: relative; top: 0px; left:0px; height:50px; width: 950px; margin: 0 auto; border:1px solid red; }
        div#ftrBottomBanner{position:absolute; top:0px; left:695px; background-image: url(images/footerBanner.png); width:216px; height:137px; background-repeat:no-repeat; border:3px solid aqua; z-index:999;}
        div#ftrBlackMenu{position:relative; top:18px; left:0px; }

div#footerGreenRibbon{position:relative; height:187px; width:100%; background-color:#bed73d; overflow:visible;}

div#footerWhiteRibbon{position:relative; height:30px; width:100%; background-color:#ffffff; } 
```

和 HTML：

```
<div id="footer">
    <div id="footerBlackRibbon">                     
        <div id="bottomMenuContainer">
            <div id="ftrBottomBanner"></div> 
                <div id="ftrBlackMenu">                        
                    <ul id="navlist">
                        <li id="active"><a href="#" id="current">Dealer Login</a></li>
                        <li><a href="#">Contact Us</a></li>
                        <li><a href="#">About Woods</a></li>
                        <li><a href="#">Careers</a></li>
                        <li><a href="#">Privacy Policy</a></li>
                        <li><a href="#">Terms of use</a></li>
                    </ul>                        
                </div>                    
            </div>
        </div>
        <div id="footerGreenRibbon">
        </div>
        <div id="footerWhiteRibbon">
        </div>  
    </div> 
```

我希望这更清楚一点。

这是 jsFiddle [http://jsfiddle.net/tshirts/kAV42/1/](http://jsfiddle.net/tshirts/kAV42/1/)

它似乎在那里工作，但在我的页面上没有任何浏览器中的相同代码。

# iphone - 无法打印分配给 NSScanner 的 NSString

> ID：10905373
> 
> 赞同：1
> 
> 时间：2012-06-05T21:39:25.707
> 
> 标签：iphone, objective-c, xcode, cocos2d-iphone, nsscanner

我正在尝试扫描 html 文件中的特定字符串，将其分配给 NSString，然后使用 NSString 执行操作。如果重要的话，我在 Cocos2d 中这样做。

我的代码如下所示：

```
NSScanner *scanner = [NSScanner scannerWithString: htmlCodeString];
NSString* string;

[scanner scanUpToString:@"HTML CODE" intoString:NULL];
[scanner scanString:@"HTML CODE" intoString:NULL];
[scanner scanUpToString:@"STRING I NEED" intoString: &string];
NSLog(@"%@", string); 
```

当我运行代码时，NSLog 会打印出我正在执行代码的层的名称。

我很困惑，因为我按照 Apple 的这个例子做了一个 T： [https ://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Strings/Articles/Scanners.html#//apple_ref/doc/uid /20000147-BCIEFGHC](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Strings/Articles/Scanners.html#//apple_ref/doc/uid/20000147-BCIEFGHC) （滚动到底部）

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T21:50:05.963

检查`scanUpToString:intoString`返回的内容。如果返回`NO`，则未找到该字符串，并且未修改“into”字符串。由于您没有初始化字符串，因此它包含一些随机垃圾。您应该将其初始化为`nil`然后查看为什么找不到您的字符串。

# php - OS X Lion + PHP + PostgreSQL，pg_connect 什么都不返回

> ID：10905387
> 
> 赞同：1
> 
> 时间：2012-06-05T21:40:30.233
> 
> 标签：php, postgresql, osx-lion

我必须将带有 PostgreSQL 数据库的大型 PHP 应用程序迁移到 Rails。这是 OS X Lion Macbook Pro，使用现有的 Apache + PHP 安装。

我通过 Homebrew 安装了 PostgreSQL。假设主机是“localhost”，用户名是“my_username”，默认数据库是“my_db”。密码为空。结果如下：

我可以从命令行很好地访问数据库

```
psql -h localhost -U my_username -p 5432 my_db 
```

没问题。这也有效：

```
psql -U my_username my_db 
```

也没有问题。我也可以使用 Rails 访问数据库，非常容易，使用以下设置：

```
adapter: postgresql
encoding: sql_ascii
template: template0
database: my_db
pool: 5
username: my_username
password: 
```

这一切都很好。但是在 PHP 中，当我这样做时

```
pg_connect("host=localhost port=5432 dbname=my_db user=my_username") or die(pg_last_error()); 
```

我收到这条消息：

```
LANG_FATAL_ERROR: LANG_DB_COULD_NOT_CONNECT
Access denied for user 'my_username'@'localhost' (using password: YES) 
```

如果我从该行中删除“host=”，则留下：

```
pg_connect("port=5432 dbname=my_db user=my_username") or die(pg_last_error()); 
```

或者

```
pg_connect("dbname=my_db user=my_username") or die(pg_last_error()); 
```

我一无所获。pg_connect 返回false，表示没有连接，但是没有错误！pg_last_error() 什么也不返回。

我还尝试将 password='' 添加到连接字符串，但没有结果。

我非常努力地在 Stack Overflow、Google 等网站上找到有关此问题的任何参考资料，但没有运气。Stack Overflow 上有几个标题相似的问题，但不是这个特定问题。我在网上找到的只是为自己编译 pgsql.so 并确保扩展名列在 php.ini 中。我已经做到了零结果。

显然这不是 PostgreSQL 本身的问题，而是与 PHP 有关的问题。

请帮忙。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T23:54:29.430

此错误消息：

> 用户'my_username'@'localhost'的访问被拒绝（使用密码：是）

是一个众所周知的**MySQL**错误消息，它与 pg_connect() 调用无关。

另请注意，不能期望 pg_last_error() 输出任何对连接失败有用的信息，因为它假定现有连接。必须在 PHP 错误输出中搜索与连接失败相关的错误消息。

# javascript - 将 javascript 保持在外部 - 不起作用

> ID：10905389
> 
> 赞同：1
> 
> 时间：2012-06-05T21:40:47.783
> 
> 标签：javascript, jquery, html

当我将我的 javascript/jquery 保持在外部时，我的代码不起作用。但是当我将它们组合到我的 html 文件中时，一切都很好。

关于为什么会这样的任何建议？

这是代码：

```
<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8" />
       <script type ="text/javascript" src="jquery.js"></script>  
       <script type ="text/javascript" src="program.js"></script>
</head>
<body>
    <div id="clickme">
    Click here
    </div>

    <img id="book" src="book.png" alt="" width="100" height="123" />

    <p>First Paragraph</p>
    <p>Second Paragraph</p>
    <p>Yet one more Paragraph</p>

</body> 
</html> 
```

使用外部 JavaScript

```
$('#clickme').click(function() {
  $('#book').fadeOut('slow', function() {
    // Animation complete.
  });
});
$("p").click(function () {
     $(this).slideUp();
   }); 
```

相对

```
<!DOCTYPE html>
<html>
<head>
    <script type ="text/javascript" src="jquery.js"></script>  
</head>
<body>

    <div id="clickme">
        Click here
    </div>
    <img id="book" src="book.png" alt="" width="100" height="123" />

    <p>First Paragraph</p>
    <p>Second Paragraph</p>  
    <p>Yet one more Paragraph</p>

    <script>
        $('#clickme').click(function() {
      $('#book').fadeOut('slow', function() {
     // Animation complete.
     });
     });

    $("p").click(function () {
    $(this).slideUp();
     });

    </script>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-05T21:44:04.883

我猜你在 DOM 完成加载之前执行了 click 事件。将您的代码包装在 dom[`ready`](http://api.jquery.com/ready/)事件中，它应该可以工作，假设您到外部 javascript 文件的路径是正确的。

```
$(function(){

   $('#clickme').click(function() {
     $('#book').fadeOut('slow', function() {
       // Animation complete.
     });
   });
   $("p").click(function () {
      $(this).slideUp();
   });
}); 
```

如果遇到任何脚本错误，请始终使用 firebug（控制台）查看脚本有什么问题。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-05T21:44:54.663

您的 javascript 在页面上有元素之前执行。您可以通过使用`$(document).ready(function(){...});`或将外部 javascript 文件移动到底部来解决此问题。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-05T21:44:51.770

将您的 js 代码包装在外部文件中

```
$(document).ready(function(){

    //your code goes here

}); 
```

现在您在标头中包含外部 js 文件并执行它。此时没有元素so`$('#clickme')`并且`$("p")`是空集。在第二个示例中，您在使用该元素渲染 html 后运行此代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-05T23:30:29.357

存在差异的原因是，在外部文件中，您的代码在浏览器完全解析 DOM 之前执行，因此您正试图以编程方式访问浏览器尚不知道的页面元素。这正是大多数人已经说过的，但让我进一步详细说明......

虽然很多人都提到了使用 jQuery 的文档就绪处理程序，但我想指出一个可行的解决方案是将脚本标签移动到页面底部。

这不仅会解决您的问题本身，而且还会因为浏览器处理脚本的方式而缩短页面加载时间。当浏览器遇到一个脚本时，它会停止它正在执行的所有其他操作（称为“阻塞”操作），然后解析并执行该脚本。这会导致页面从用户的角度来看只是停滞不前，这意味着糟糕的用户体验。因此，由于脚本仅在遇到时才被解析和执行，通过将脚本移动到底部，您可以让浏览器完全呈现页面，这样 JavaScript 就不会阻塞呈现。

尽管*不仅仅是*将脚本移动到页面底部，我还会遵循其他人的建议，并将整个代码包装在文档就绪处理程序中，以确保您的代码始终在正确的时间执行。

此外，在讨论内联或外部时，通常首选外部脚本，因为它们更易于维护，并且浏览器可以独立于页面缓存它们（前提是存在正确的 HTTP 标头）。

总结一下这里的一些示例代码：

```
<html>
<head></head>
<body>
<!-- all your markup here -->

<!-- script at bottom, markup already rendered by this point -->
<script type="text/javascript" src="jquery.js"></script>

<!-- inline or external, still wrap in document ready handler -->
<!-- though external is better because the browser can cache it independently of the page -->
<script type="text/javascript">
    //wrap in document ready to be extra safe
    $(function() { /*code here*/ });
</script>

</html> 
```

# c++ - 如何有效地将 stl 容器恢复为旧值

> ID：10905390
> 
> 赞同：1
> 
> 时间：2012-06-05T21:40:53.550
> 
> 标签：c++, performance, stl

我有一个代表图表的大类。此类包含多个复杂类型的容器（向量和集合）。在搜索过程中，我需要修改图表以避免结果出现循环。由于我必须运行许多搜索，我需要经常将类恢复到其原始状态。

目前，我只是将保存的 continer 分配给修改后的：

```
 void Graph::restore(){
   mEdges=mSafeEdges; //std::vector<Edge> Edge has no heap based data
   mNodes=mSafeNodes; //std::vector<GraphNode> A Graph Node contains std::set<int>
 } 
```

正如我所说，边和节点很复杂，每个节点都包含一个集合。每对容器具有相同的大小。分析我的代码表明，简单的恢复功能是程序的主要瓶颈，每次运行大约需要 6 毫秒。边缘向量需要 1.5 毫秒来复制，节点需要 4.5。是否有更好、更快的方法来复制复杂类型的容器或至少复制 Edge Vector ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T18:14:06.143

如果您在每次搜索时只修改一些对象，那么您可以查看写时复制是否有帮助。

```
template<typename T>
class Cow {
  std::shared_ptr<T> owned;
  const Node* non_owned;
public:
  explicit Cow(const T& n) : non_owned(n) { }
  const T& get() const { return *non_owned; }
  T& copy() {
    if (!owned) {
      owned = std::make_shared<T>(*non_owned);
      non_owned = owned.get();
    }
    return *owned;
  }
}; 
```

然后用`mEdges`and`mNodes`的容器替换`Cow<Edge>`and `Cow<GraphNode>`（或者只对节点这样做，因为这是复制成本更高的类型）。

您必须修改搜索逻辑以使用包装器类型（或为其提供转换运算符`const T&`），然后`copy()`在需要可修改对象时显式添加调用，但除非必要，否则您将避免复制对象。

# android - Android 的 AlarmManager 间隔

> ID：10905391
> 
> 赞同：3
> 
> 时间：2012-06-05T21:40:55.560
> 
> 标签：android, notifications, alarmmanager, statusbar

这是我到目前为止的代码

```
AlarmManager am = (AlarmManager) getSystemService(Context.ALARM_SERVICE);
setRepeatingAlarm();

public void setRepeatingAlarm() {

    Calendar cal = Calendar.getInstance();
    cal.add(Calendar.SECOND, 10);

    Intent intent = new Intent(this, TimeAlarm.class);
    PendingIntent pendingIntent = PendingIntent.getBroadcast(this, 0, intent, PendingIntent.FLAG_CANCEL_CURRENT);
    am.setRepeating(AlarmManager.RTC_WAKEUP, cal.getTimeInMillis(), (15 * 1000), pendingIntent);
  }

} 
```

这就是我想要完成的所有事情：闹钟要到每分钟过去 30 秒才会打开。一旦你清除它，它直到*下一*分钟后 30 秒才会恢复。因此，如果我打开应用程序，并且是每分钟 25 秒，它将在 5 秒后激活状态栏通知。但是如果已经过去了 40 秒，我将不得不再等 50 秒（到下一分钟）。我不确定如何使用日历功能来实现这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T22:12:30.920

如果我了解您的要求，那么您可以尝试以下操作...

```
Calendar cal = Calendar.getInstance();
if (cal.get(Calendar.SECOND) >= 30)
    cal.add(Calendar.MINUTE, 1);
cal.set(Calendar.SECOND, 30);

// Do the Intent and PendingIntent stuff

am.setRepeating(AlarmManager.RTC_WAKEUP, cal.getTimeInMillis(), 60 * 1000, pendingIntent); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T22:12:44.523

如果您检查文档`AlarmManager`，它会说`RTC_WAKEUP`使用时间相对于`System.currentTimeMillis()`：

> RTC_WAKEUP System.currentTimeMillis() 中的闹钟时间（UTC 挂钟时间），它会在设备关闭时唤醒设备。

因此，只需修改您的`triggerAtTime`参数，例如立即开始：

```
am.setRepeating(AlarmManager.RTC_WAKEUP, System.currentTimeMillis(), 15 * 1000, pendingIntent); 
```

然后警报将每 15 秒重复触发一次。

# java - 使用 UTM 坐标计算面积的精确方法

> ID：10905401
> 
> 赞同：4
> 
> 时间：2012-06-05T21:41:23.900
> 
> 标签：java, polygon, area, utm

我有一个纬度/经度坐标列表，我想用它来计算多边形的面积。在很多情况下我可以得到准确的结果，但是多边形越大，出错的机会就越大。

我首先使用[http://www.ibm.com/developerworks/java/library/j-coordconvert/将坐标转换为 UTM](http://www.ibm.com/developerworks/java/library/j-coordconvert/)

从那里，我使用[http://www.mathopenref.com/coordpolygonarea2.html](http://www.mathopenref.com/coordpolygonarea2.html)来计算 UTM 坐标的面积。

```
private Double polygonArea(int[] x, int[] y) {      
    Double area = 0.0;
    int j = x.length-1;
    for(int i = 0; i < x.length; i++) {
        area = area + (x[j]+x[i]) * (y[j]-y[i]);
        j = i;
    }
    area = area/2;
    if (area < 0)
        area = area * -1;
    return area;
} 
```

我将这些区域与我放入 Microsoft SQL Server 和 ArcGIS 的相同坐标进行比较，但我似乎无法始终完全匹配它们。有谁知道比这更精确的方法？

提前致谢。

**编辑 1**

谢谢你的意见。这是我获取该区域的代码（IBM 链接上面列出了 CoordinateConversion 代码）：

```
private Map<Integer, GeoPoint> vertices;

private Double getArea() {
    List<Integer> xpoints = new ArrayList<Integer>();
    List<Integer> ypoints = new ArrayList<Integer>();
    CoordinateConversion cc = new CoordinateConversion();
    for(Entry<Integer, GeoPoint> itm : vertices.entrySet()) {
        GeoPoint pnt = itm.getValue();
        String temp = cc.latLon2MGRUTM(pnt.getLatitudeE6()/1E6, pnt.getLongitudeE6()/1E6);
        // Example return from CC: 02CNR0634657742
        String easting = temp.substring(5, 10);
        String northing = temp.substring(10, 15);
        xpoints.add(Integer.parseInt(easting));
        ypoints.add(Integer.parseInt(northing));
    }

    int[] x = toIntArray(xpoints);
    int[] y = toIntArray(ypoints); 
    return polygonArea(x,y);
} 
```

这是一个点的示例列表：

```
44.80016800 -106.40808100
44.80016800 -106.72123800
44.75016800 -106.72123800
44.75016800 -106.80123800
44.56699100 -106.80123800 
```

在 ArcGIS 和 MS SQL 服务器中，我得到 90847.0 英亩。使用上面的代码，我得到 90817.4 英亩。

另一个示例点列表：

```
45.78412600 -108.51506700
45.78402600 -108.67972100
45.75512200 -108.67949400
45.75512200 -108.69962300
45.69795400 -108.69929400 
```

在 ArcGIS 和 MS SQL 服务器中，我得到 15732.9 英亩。使用上面的代码，我得到 15731.9 英亩。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T16:31:20.347

事实证明，UTM 无法获得我想要的极端准确性。将投影系统切换到更精确的东西，如 Albers 或 State Plane，可以提供更准确的计算。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T17:32:31.497

您使用的面积公式仅在平面上有效。随着多边形变大，地球的曲率开始产生影响，使面积大于您使用此公式计算的面积。您需要找到一个适用于球体表面的公式。

一个简单的谷歌搜索“球面上的多边形面积”会出现一堆命中，其中最有趣的是[Wolfram MathWorld Spherical Polygon](http://mathworld.wolfram.com/SphericalPolygon.html)

# width - 不使用 100% 宽度的灵活排水沟？

> ID：10905402
> 
> 赞同：1
> 
> 时间：2012-06-05T21:41:39.570
> 
> 标签：width, percentage, css

所以，我正在设计一个固定的宽度。我只是希望排水沟灵活。所以，我尝试只使用 100% 宽度的父 div。正如你在这个小提琴中看到的：

[http://jsfiddle.net/P3Ckk/115/](http://jsfiddle.net/P3Ckk/115/)

我的意图是让固定 div（“nav”div）发生的事情发生。当用户窗口变得太小时，我希望 100% 的宽度折叠在固定宽度的元素上（在本例中为 1000 像素）并启用水平滚动。

但是，我的父 width:100% 不能像相对定位那样工作。“top”、“title”和“container” div 都停在屏幕停止的地方。我想这是 100%，但它使固定宽度的内容溢出这些（现在）较小的父 div！

此外，当垂直滚动条下降时，问题也会出现。垂直滚动条的区域被认为是 100%，其余部分留空。这也创建了一个水平滚动条来查看这个“额外”部分。

这里最好的解决方案是什么？我应该放弃我的父 div 100% 宽度方法吗？

我试过让这些 100% 的 div 具有 min-width:1000px，但这似乎不起作用。我只是有点难过。

任何帮助表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T21:48:14.567

我以前读过这个。在您可以在 div 宽度中使用 100% 之前，您必须将 body 和 html 标签的 css 设置为 100%。

```
 html,body{
 width: 100%;
 } 
```

否则它将停在任何设备的屏幕边缘。

# remote-debugging - 如何在 Xen 中调试 Linux dom0 内核

> ID：10905403
> 
> 赞同：2
> 
> 时间：2012-06-05T21:41:45.827
> 
> 标签：remote-debugging, kernel, xen

我一直在破解 Xen 块驱动程序后端，并且在通过串行方式使用 kgdb 进行调试时遇到了一些困难。这是我的设置。我将 MacOS X 作为主机操作系统运行。我有两个 VirtualBox 虚拟机，称它们为开发和测试。VirtualBox 被配置为给他们每个人一个连接到命名主机管道的 COM1 端口。然后我用它`socat -d -d ./test-com1 ./dev-com1`来连接两个端口。执行此操作后，我已验证我可以通过执行`echo hi > /dev/[ttyS0|hvc0]`或使用 socat 将文本纯文本从一个 VM 发送到另一个 VM。我还可以通过在 dev 上使用 socat 在启动期间从测试中获得控制台输出。

这是我的测试内核的 grub 条目：

```
menuentry 'Debian GNU/Linux, with Linux 3.3.6-xen-ljx-g6304e82 and XEN 4.1.2' --class debian --class gnu-linux --class gnu --class os --class xen {
        insmod part_msdos
        insmod ext2
        set root='(hd0,msdos1)'
        search --no-floppy --fs-uuid --set 0c98efb4-f40e-4f0e-a2d3-2ed39b0a5070
        echo    'Loading Linux 3.3.6-xen-ljx-g6304e82 ...'
        multiboot       /boot/xen-4.1.2.gz placeholder loglvl=all guest_loglvl=all com1=115200,8n1,0x3f8,4 console=com1,vga 
        module  /boot/vmlinuz-3.3.6-xen-ljx-g6304e82 placeholder root=UUID=0c98efb4-f40e-4f0e-a2d3-2ed39b0a5070 ro console=hvc0 console=tty0 earlyprintk=xen nopat quiet
        echo    'Loading initial ramdisk ...'
        module  /boot/initrd.img-3.3.6-xen-ljx-g6304e82
} 
```

这是来自开发：

```
user@jimmy:~/workspace/linux-3.3.6$ stty -F /dev/ttyS0 -a
speed 38400 baud; rows 0; columns 0; line = 0;
intr = ^C; quit = ^\; erase = ^?; kill = ^U; eof = ^D; eol = <undef>; eol2 = <undef>; swtch = <undef>; start = ^Q; stop = ^S; susp = ^Z; rprnt = ^R; werase = ^W; lnext = ^V; flush = ^O; min = 0; time = 10;
-parenb -parodd cs8 hupcl -cstopb cread clocal -crtscts
-ignbrk -brkint -ignpar -parmrk -inpck -istrip -inlcr -igncr -icrnl -ixon -ixoff -iuclc -ixany -imaxbel -iutf8
-opost -olcuc -ocrnl -onlcr -onocr -onlret -ofill -ofdel nl0 cr0 tab0 bs0 vt0 ff0
-isig -icanon -iexten -echo -echoe -echok -echonl -noflsh -xcase -tostop -echoprt -echoctl -echoke 
```

这是来自测试：

```
root@sqtest:~# stty -F /dev/tty0  -a
speed 38400 baud; rows 25; columns 80; line = 0;
intr = ^C; quit = ^\; erase = ^?; kill = ^U; eof = ^D; eol = <undef>; eol2 = <undef>; swtch = <undef>; start = ^Q; stop = ^S; susp = ^Z; rprnt = ^R; werase = ^W; lnext = ^V; flush = ^O; min = 1; time = 0;
-parenb -parodd cs8 -hupcl -cstopb cread -clocal -crtscts
ignbrk -brkint ignpar -parmrk -inpck -istrip -inlcr -igncr -icrnl -ixon -ixoff -iuclc -ixany -imaxbel -iutf8
-opost -olcuc -ocrnl -onlcr -onocr -onlret -ofill -ofdel nl0 cr0 tab0 bs0 vt0 ff0
-isig -icanon -iexten -echo -echoe -echok -echonl -noflsh -xcase -tostop -echoprt -echoctl -echoke
root@sqtest:~# stty -F /dev/hvc0  -a
speed 38400 baud; rows 0; columns 0; line = 0;
intr = ^C; quit = ^\; erase = ^?; kill = ^U; eof = ^D; eol = <undef>; eol2 = <undef>; swtch = <undef>; start = ^Q; stop = ^S; susp = ^Z; rprnt = ^R; werase = ^W; lnext = ^V; flush = ^O; min = 1; time = 0;
-parenb -parodd cs8 hupcl -cstopb cread -clocal -crtscts
-ignbrk -brkint -ignpar -parmrk -inpck -istrip -inlcr -igncr icrnl ixon -ixoff -iuclc -ixany -imaxbel -iutf8
opost -olcuc -ocrnl onlcr -onocr -onlret -ofill -ofdel nl0 cr0 tab0 bs0 vt0 ff0
isig icanon iexten echo echoe echok -echonl -noflsh -xcase -tostop -echoprt echoctl echoke 
```

一个示例开发会话（`echo hvc0,38400 > /sys/module/kgdboc/parameters/kgdboc; echo g > /proc/sysrq-trigger`在测试之后）：

```
user@jimmy:~/workspace/linux-3.3.6$ gdb vmlinux 
GNU gdb (GDB) 7.0.1-debian
Copyright (C) 2009 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "i486-linux-gnu".
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>...
Reading symbols from /home/paton/workspace/linux-3.3.6/vmlinux...done.
(gdb) set remotebaud 38400
(gdb) target remote /dev/ttyS0
Remote debugging using /dev/ttyS0
Ignoring packet error, continuing...
warning: unrecognized item "timeout" in "qSupported" response
Ignoring packet error, continuing... 
```

当我使用 tty0 而不是上面的 hvc0 时，也会发生同样的事情。

尽管串行 TTY 设置不同，但在没有 Xen 的情况下使用我的内核时，我已经能够成功连接调试器。我觉得这与 STTY 报告的选项有关，但我希望对这些事情了解更多的人可以指出问题，以便我理解。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T17:29:42.803

事实证明你做不到。但是，这里有一个 Linux 补丁：

[http://lists.xen.org/archives/html/xen-devel/2012-06/msg00326.html](http://lists.xen.org/archives/html/xen-devel/2012-06/msg00326.html)

那是针对 3.2 内核的。我在同一个线程中发布了 3.3 的一个。此补丁启用通过 hvc 进行 kgdb 调试。

# java - Axis 2 和 Rampart 如何在 policy.xml 中仅指定传出安全性

> ID：10905404
> 
> 赞同：0
> 
> 时间：2012-06-05T21:41:49.077
> 
> 标签：java, web-services, security, axis2, rampart

我正在使用 Rampart 生成请求。我有一个用于应用安全性的 policy.xml。

当 Rampart 正在寻找安全标头时，我的响应出现异常，但不存在。

我是否仍然可以使用我的 policy.xml 并指定我不需要入站安全这一事实，还是我需要做其他事情？

政策：

```
 <wsp:Policy wsu:Id="SigOnly"  
        xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"  
        xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy">  
<wsp:ExactlyOne>  
    <wsp:All>  
        <sp:AsymmetricBinding xmlns:sp="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy">  
            <wsp:Policy>  
                <sp:InitiatorToken>  
                    <wsp:Policy>  
                        <sp:X509Token  
                                sp:IncludeToken="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy/IncludeToken/AlwaysToRecipient">  
                            <wsp:Policy>  
                                <sp:RequireThumbprintReference/>  
                                <sp:WssX509V3Token10/>  
                            </wsp:Policy>  
                        </sp:X509Token>  
                    </wsp:Policy>  
                </sp:InitiatorToken>  
                <sp:RecipientToken>  
                    <wsp:Policy>  
                        <sp:X509Token  
                                sp:IncludeToken="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy/IncludeToken/Never">  
                            <wsp:Policy>  
                                 <sp:RequireThumbprintReference/>  
                                <sp:WssX509V3Token10/>   
                            </wsp:Policy>  
                        </sp:X509Token>   
                    </wsp:Policy>  
                </sp:RecipientToken>  
                <sp:AlgorithmSuite>  
                    <wsp:Policy>  
                        <sp:TripleDesRsa15/>  
                    </wsp:Policy>  
                </sp:AlgorithmSuite>  
                <sp:Layout>  
                    <wsp:Policy>  
                        <sp:Strict/>  
                    </wsp:Policy>  
                </sp:Layout>  
               <!--   <sp:IncludeTimestamp/> -->  
                <sp:OnlySignEntireHeadersAndBody/>  
            </wsp:Policy>  
        </sp:AsymmetricBinding>  
        <sp:Wss10 xmlns:sp="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy">  
            <wsp:Policy>  
                <sp:MustSupportRefKeyIdentifier/>  
                <sp:MustSupportRefIssuerSerial/>  
            </wsp:Policy>  
        </sp:Wss10>  
        <sp:SignedParts xmlns:sp="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy">  
            <sp:Body/>  
        </sp:SignedParts>  
        <ramp:RampartConfig xmlns:ramp="http://ws.apache.org/rampart/policy">  
            <ramp:user>ctr</ramp:user>  
            <ramp:encryptionUser>ctr</ramp:encryptionUser>  
            <ramp:passwordCallbackClass>com.gtnet.rampart.PWCBHandler  
            </ramp:passwordCallbackClass>  

            <ramp:signatureCrypto>  
                <ramp:crypto provider="org.apache.ws.security.components.crypto.Merlin">  
                    <ramp:property name="org.apache.ws.security.crypto.merlin.keystore.type">JKS</ramp:property>  
                    <ramp:property name="org.apache.ws.security.crypto.merlin.file">build\resources\qw.jks</ramp:property>  
                    <ramp:property name="org.apache.ws.security.crypto.merlin.keystore.password">123123</ramp:property>  
                </ramp:crypto>  
            </ramp:signatureCrypto>  
        </ramp:RampartConfig>  

    </wsp:All>  
</wsp:ExactlyOne> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T18:05:44.503

请看这里： [http ://blog.rampartfaq.com/2009/11/how-to-generate-non-secure-response-to.html](http://blog.rampartfaq.com/2009/11/how-to-generate-non-secure-response-to.html)

您可以通过更改axis2.xml 和更改OutFlow 在客户端执行等效操作。

# android - 是否可以将活动绑定到在后台线程上工作并始终运行的服务？

> ID：10905407
> 
> 赞同：1
> 
> 时间：2012-06-05T21:41:51.340
> 
> 标签：android, android-intent, android-activity, android-service

这是我关于 SO 的第一个问题，我希望这个问题不会很糟糕。

我有一项服务，它在用户启动应用程序时开始工作，直到用户通过任务杀手杀死它或关闭他的设备。

该服务有一个后台线程，它对数据进行一些处理。我需要绑定活动（来自活动，而不是通过服务），有时（每 30 秒 1-2 次）将数据发送到绑定的活动。

我的服务结构：

```
public class myserv extends Service {
  public static boolean started=false;
  public class workwithdata extends Thread {
    @Override
    public synchronized void start() {
      super.start();
      //.. Not important.
    }
    @Override
    public void run() {
      if (running) return;
      while (true) {
        if(condition) mythread.sleep(30000);
        else {
          Object data = recieveMyData();
          if (!data.isEmpty()) {
            //.. Some work with recieved data, not important.
            sendDataToBindedActivities(data); //This is what I need.
          }
          mythread.sleep(10000);
        }
      }
    }
  }
  @Override
  public void onCreate() {
    super.onCreate();
    this.started=true;
    mythread = new workwithdata();
    mythread.start();
  }
} 
```

好吧，我发现了一个[问题](https://stackoverflow.com/questions/6352244/revision-2-how-to-pass-data-from-a-background-service-thread-to-some-other-acti)，但我的问题有一点不同：我不需要向服务发送任何数据，我只需向所有绑定的活动发送一些数据（哪个服务根本不知道）。

我正在寻找的结构：

```
public class myact extends Activity {
  @Override
  public void onCreate(Bundle bun) {
    super.onCreate(bun);
    if(!myserv.started) {
      Intent service = new Intent(getApplicationContext(), myserv.class);
      getApplicationContext().startService(service);
    }
    bindToService(this);
  }
  @Override
  public void onRecievedData(Object data) {
    //work with recieved data from service "myserv".
  }
} 
```

我也试图在 android 文档中找到一些解决方案，但我没有找到我需要的东西。

所以，主要问题是：**是否可以处理从服务到活动的通信？**. 如果不是：**我应该为此目的使用什么？**如果是，只是，对不起，我可以要求一些代码或类名，因为我试图找到并且没有......

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T16:04:49.940

您需要使用[RemoteCallbackList](http://developer.android.com/reference/android/os/RemoteCallbackList.html)

当您的客户绑定到服务时，您需要使用`RemoteCallbackList.register()`.

当您想向绑定的客户端发送数据时，您可以执行以下操作：

```
int count = callbackList.beginBroadcast();
for (int i = 0; i < count; i++) {
    try {
        IMyServiceCallback client = callbackList.getBroadcastItem(i);
        client.onRecievedData(theData); // Here you callback the bound client's method
                                  //  onRecievedData() and pass "theData" back
    } catch (RemoteException e) {
        // We can safely ignore this exception. The RemoteCallbackList will take care
        //  of removing the dead object for us.
    } catch (Exception e) {
        // Not much we can do here except log it
        Log.e("while calling back remote client", e);
    }
}
callbackList.finishBroadcast(); 
```

一个例子可以在[这里](http://developer.android.com/resources/samples/ApiDemos/src/com/example/android/apis/app/RemoteService.html)找到它有点复杂，但也许你不需要它提供的一切。无论如何，看看。

# oracle - 存储过程：光标坏了？

> ID：10905408
> 
> 赞同：3
> 
> 时间：2012-06-05T21:42:12.060
> 
> 标签：oracle, stored-procedures, plsql, cursor

我在某处读到 99% 的时间不需要使用光标。

但除了在以下情况下使用光标之外，我想不出任何其他方式。

```
Select t.flag
From Dual t; 
```

假设这会返回 4 行的`'Y'`or 或`'N'`。我希望该过程在找到`'Y'`. 我通常声明一个游标并循环直到`%NOTFOUND`。请告诉我是否有更好的方法。

另外，如果您有任何想法，什么时候是使用光标的最佳时间？

**编辑**：而不是插入标志，如果我想做*“如果`'Y'`然后触发某事”*怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T21:47:30.083

像这样的东西：

```
INSERT INTO TBL_FLAG (col)
SELECT ID FROM Dual where flag = 'Y' 
```

当使用基于集合而不是过程操作时，您通常会看到性能提升，因为大多数现代 DBMS 都设置为执行基于集合的操作。[你可以在这里](http://www.codeproject.com/Articles/34142/Understanding-Set-based-and-Procedural-approaches)阅读更多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T21:56:32.100

你的情况肯定属于99%。

您可以使用`insert into ... select...`. 这只是一个`select`返回您要插入的结果的问题或创建一个。

如果要为每个记录插入一条记录，请`'Y'`使用`where flag = 'Y'`. 如果您只想根据是否至少有一条记录来插入一条记录`'Y'`，那么您可以添加`distinct`到查询中。

当您使事情变得更复杂时，光标很有用。例如，当需要在一个表中插入或更新记录时，我使用游标，并且还为每条记录插入或更新一条或多条记录到其他几张表中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T21:45:47.703

好吧，这个例子不太有意义..

但是你总是可以写一个`insert as select`陈述而不是我认为你所描述的

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-11T09:53:54.657

当一个表中的列值将在不同表的多个查询中重复使用时，最好使用游标。

假设 id_test 列的值是使用游标 CUR_TEST 从 MY_TEST_TBL 获取的。现在这个 id_test 列是 MY_TEST_TBL 中的一个外键。如果我们想使用 id_test 来插入或更新表 A_TBL、B_TBL 和 C_TBL 中的任何行，那么在这种情况下最好使用游标而不是使用复杂的查询。

希望这可能有助于理解游标的用途

# c# - 应用程序设置和 Windows 窗体

> ID：10905414
> 
> 赞同：0
> 
> 时间：2012-06-05T21:43:05.203
> 
> 标签：c#, .net, winforms, application-settings

我学习了本文中描述的技术

[http://www.codeproject.com/Articles/29130/Windows-Forms-Creating-and-Persisting-Custom-User](http://www.codeproject.com/Articles/29130/Windows-Forms-Creating-and-Persisting-Custom-User)

这篇文章的标题是“ **Windows 窗体**- 在 C# 中创建和持久化自定义用户设置”。MSDN上的ApplicationSettingsBase类描述也说

> 作为派生具体包装类的基类，以在**Window Forms** 应用程序中实现应用程序设置功能。

如果在简单的控制台应用程序中没有任何 WinForms 依赖项的情况下（看似）完美地工作，那么这项技术与 Windows 窗体有什么关系？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T07:04:07.740

我能看到的唯一原因是 WinForms 表单设计器允许您立即处理设置：

![存储表单的位置和文本](../Images/1c5030d692f227430f476434ce114be3.png)

在设置中存储表单的位置和文本。

这在您所指的教程中没有提到，而且是一个非常未知的功能。

# sql-server - TempDB 的 TraceFlag 1118

> ID：10905415
> 
> 赞同：2
> 
> 时间：2012-06-05T21:43:05.253
> 
> 标签：sql-server, sql-server-2008

即使在 SQL 2008/R2 或 SQL 2012 的情况下，为 TempDB 启用跟踪标志 1118（作为服务启动参数）以减少与混合范围分配相关的争用有很多优点。为什么在世界上它被禁用开箱即用默认的 SQL 服务器配置？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T21:48:08.537

[对 TF 1118 的误解](http://www.sqlskills.com/BLOGS/PAUL/post/Misconceptions-around-TF-1118.aspx)。阅读关于*为什么在 2005 年和 2008 年不需要那么多跟踪标志的段落？*. 还要考虑到有很多工作负载很少或根本不使用临时表（例如，大多数设计良好的 OLTP 工作负载），其中一些工作负载可能会受到 tempdb 中扩展分配的影响。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T21:51:33.263

> 使用 TF-1118。在此跟踪标志下，SQL Server 为每个 tempdb 对象分配完整范围，从而消除了 SGAM 页面上的争用。**这是以浪费 tempdb 中的一些磁盘空间为代价的。**此跟踪标志自 SQL Server 2000 以来一直可用。随着 SQL Server 2005 中 tempdb 对象缓存的改进，分配结构中的争用应该会大大减少。如果您在 SGAM 页面中看到争用，您可能需要使用此跟踪标志。缓存的 tempdb 对象可能并不总是可用。例如，缓存的 tempdb 对象在与它们关联的查询计划被重新编译或从过程缓存中删除时被破坏。

所以它需要更多的空间，这可能会损害某些工作负载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-09T09:18:05.210

**T1118：** 删除服务器上的大多数单页分配，减少 SGAM 页面上的争用。创建新对象时，默认情况下，前八页是从不同的扩展区（混合扩展区）分配的。之后，当需要更多页面时，会从同一范围（统一范围）分配这些页面。SGAM 页面用于跟踪这些混合范围，因此在发生大量混合页面分配时很快就会成为瓶颈。此跟踪标志在创建新对象时从同一范围分配所有八个页面，从而最大限度地减少扫描 SGAM 页面的需要。有关详细信息，请参阅此 Microsoft 支持文章。

注意：从 SQL Server 2016 (13.x) 开始，此行为由 ALTER DATABASE 的 SET MIXED_PAGE_ALLOCATION 选项控制，跟踪标志 1118 无效。有关详细信息，请参阅 ALTER DATABASE SET 选项 (Transact-SQL)。

范围：仅限全球

# c# - 来电显示 检查来电是否已结束通话

> ID：10905419
> 
> 赞同：1
> 
> 时间：2012-06-05T21:43:41.403
> 
> 标签：c#, serial-port, modem

我有一个程序可以获取来电号码、日期和时间。但是，我想检查给我打电话的人是否已放下电话，我该怎么做？

以下是我目前拥有的代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.IO.Ports;

namespace CallerID
{
    public partial class CallerID : Form
    {
        int timesTicked = 0;
        Point defaultLocation = new Point();
        Point newLocation = new Point();
        public CallerID()
        {
            InitializeComponent();
            port.Open();
            SetModem(); // SetModem(); originally went after WatchModem();
            WatchModem();
            //SetModem();
            telephoneTimer.Interval = 16;
            telephoneTimer.Tick += new EventHandler(telephoneTimer_Tick);
            defaultLocation = pictureBox1.Location;
            newLocation = pictureBox1.Location;

        }

        void telephoneTimer_Tick(object sender, EventArgs e)
        {
            if (timesTicked <= 2)
                newLocation.X++;
            if (timesTicked >= 4)
                newLocation.X--;
            if (timesTicked == 6)
            {
                timesTicked = 0;
                pictureBox1.Location = defaultLocation;
                newLocation = defaultLocation;
            }
            pictureBox1.Location = newLocation;
            timesTicked++;
        }

        protected override void OnPaint(PaintEventArgs e)
        {
            base.OnPaint(e);
            WatchModem();
        }

        private SerialPort port = new SerialPort("COM3");
        string CallName;
        string CallNumber;
        string ReadData;

        private void SetModem()
        {
            port.WriteLine("AT+VCID=1\n");
            //port.WriteLine("AT+VCID=1");
            port.RtsEnable = true;
        }

        private void WatchModem()
        {
            port.DataReceived += new SerialDataReceivedEventHandler(port_DataReceived);
        }

        public delegate void SetCallerIdText();

        private void port_DataReceived(object sender, SerialDataReceivedEventArgs e)
        {
            ReadData = port.ReadExisting();
            //Add code to split up/decode the incoming data
            //if (lblCallerIDTitle.InvokeRequired)
            if (ReadData.Contains("NMBR"))
            {
                lblData.Invoke(new SetCallerIdText(() => lblData.Text = ReadData));
            }
            //else
            //    lblCallerIDTitle.Text = ReadData;
        }

        private void lblData_TextChanged(object sender, EventArgs e)
        {
            telephoneTimer.Start();
            button1.Visible = true;
        }
    }
} 
```

请忽略计时器代码，因为它仅用于动画。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T21:47:55.650

你试过这个[`PinChanged`](http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.pinchanged.aspx)活动吗？通常，当远端断开连接时，Carrier Detect 会变低。

# java - 在 JSP 中调用 java 搜索函数

> ID：10905421
> 
> 赞同：-2
> 
> 时间：2012-06-05T21:43:56.847
> 
> 标签：java, hibernate, jsp

我有一个使用休眠的数据库设置，我想在我的 JSP 页面中调用对表的搜索。如何使用 jsp 页面调用我的 java 函数并存储结果，然后在 jsp 页面上打印它们？

搜索功能（按主题搜索）

```
public Iterable<Layouts> getSelectedLayouts(String subjectName){} 
```

我的jsp页面中有包含这个方法的类作为spring bean

```
custom:useSpringBean var="layoutManager" bean="LayoutManager" 
```

其中 LayoutManager 是类

不知道怎么调用jsp页面中的方法并输出结果

我正在使用 spring/hibernate 连接到数据库，并在本地 tomcat 服务器上运行我的 jsp

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:20:38.497

由于您的问题尚不清楚您正在使用什么框架。我只会给你一个非常笼统和简单的答案，但你可以在你使用的任何框架中使用相同的想法。

您的 jsp 页面中可能有一个按钮，单击该按钮将调用 servlet。在 servlet 中，您将可以访问通过 jsp 页面提交的字段。使用字段创建搜索对象 (DAO) 并使用它查询数据库。

当您从数据库中获取结果时，将其保存在会话范围内。所以现在在您的 jsp 页面中，您可以访问该对象并显示它。您可以使用 jstl 访问对象的字段。

# python - 如何将键盘输入与Python中的字符串进行比较？

> ID：10905423
> 
> 赞同：2
> 
> 时间：2012-06-05T21:44:02.540
> 
> 标签：python

我正在尝试将键盘输入与字符串进行比较：

```
import sys

# read from keyboard
line = sys.stdin.readline()
if line == "stop":
    print 'stop detected'
else:
    print 'no stop detected' 
```

当我在键盘上输入“停止”并输入时，我希望程序打印“检测到停止”，但它总是打印“未检测到停止”。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T21:45:31.583

`sys.stdin.readline()`包括尾随换行符。使用`raw_input()`，或与`line.rstrip("\n")`您要查找的字符串（甚至`line.strip().lower()`）进行比较。

# visual-studio - 如何包含两个同名的文件（在不同的项目中）？

> ID：10905425
> 
> 赞同：0
> 
> 时间：2012-06-05T21:44:09.057
> 
> 标签：visual-studio, visual-c++, include, projects-and-solutions

使用 Visual Studio C++ 2010。我最近重命名了一些文件，现在我在不同的项目中有两个同名的文件（相同的解决方案）。以前我在我的主项目中有类似的代码：

```
#include "MyClass.h"

MyClass x = new MyClass(); 
```

这奏效了。MyClass.h 在 MyLibrary 中，这是一个单独的项目，我将 MyLibrary 文件夹添加为`"Additional Include Directories": $(SolutionDir)MyLibrary;`

现在，由于重命名，我有两个名为“MyClass.h”的文件，MyLibrary 中的原始文件和主项目中的新文件。现在我在编译时遇到错误：

> 7>c:\myproject\mainthing.cpp(81): 错误 C2065: 'MyClass' : 未声明的标识符

我猜我原来的 MyClass.h 文件被我的主项目中的新 MyClass.h 文件遮住了。

我试图做类似的事情：

```
#include "MyLibrary/MyClass.h" 
```

但这会得到红色下划线并且无法编译。

如何获取包含以引用 MyLibrary 项目中的 MyClass.h？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T22:03:09.577

如果我将父目录添加到包含路径中，那么似乎可以使用包含内容：

也就是说，改变：

```
#include "MyLibrary/MyClass.h" 
```

至：

```
#include "../MyLibrary/MyClass.h" 
```

# python - 如何在 Python 脚本中执行 UNIX 命令

> ID：10905427
> 
> 赞同：2
> 
> 时间：2012-06-05T21:44:28.673
> 
> 标签：python, unix

```
#!/usr/bin/python

import os
import shutil
import commands
import time
import copy

name = 'test'

echo name 
```

我有一个像上面这样的简单 python 脚本。当我尝试执行它时，尝试输出名称变量时出现语法错误。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-05T21:49:28.700

您不能在 Python 脚本中使用 UNIX 命令，就好像它们是 Python 代码一样，`echo name`这会导致语法错误，因为`echo`它不是 Python 中的内置语句或函数。相反，使用`print name`.

要运行 UNIX 命令，您需要创建一个运行该命令的子进程。最简单的方法是使用[`os.system()`](http://docs.python.org/library/os.html#os.system)，但[`subprocess`](http://docs.python.org/library/subprocess.html)最好使用模块。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-05T21:47:56.137

您还可以使用子流程模块。

```
import subprocess
proc = subprocess.Popen(['echo', name],
                            stdin = subprocess.PIPE,
                            stdout = subprocess.PIPE,
                            stderr = subprocess.PIPE
                        )

(out, err) = proc.communicate()
print out 
```

阅读： http: [//www.doughellmann.com/PyMOTW/subprocess/](http://www.doughellmann.com/PyMOTW/subprocess/)

# node.js - npm 生成的命令未调用节点

> ID：10905438
> 
> 赞同：2
> 
> 时间：2012-06-05T21:44:57.347
> 
> 标签：node.js, npm

我正在尝试创建一个 node.js 命令行实用程序，但遇到了 npm 生成的包装器问题。我的超级简单演示是一个 package.json 文件：

```
{
    "name": "demo-cli",
    "version": "0.0.1",
    "bin": { "demo": "bin/demo-cli.js" }
} 
```

还有 demo-cli.js 文件：

```
console.log('DEMO WORKED'); 
```

问题是当我`npm install -g`在项目目录中使用安装模块时，它生成的包装器不会以文件作为参数调用节点。这是 demo.cmd 生成的内容：

```
:: Created by npm, please don't edit manually.
"%~dp0\.\node_modules\demo-cli\bin\demo-cli.js"   %* 
```

unix 版本也有同样的问题。查看另一个全局安装的 CLI，我可以看到该节点正在按预期进行测试和调用。

```
:: Created by npm, please don't edit manually.
@IF EXIST "%~dp0\node.exe" (
  "%~dp0\node.exe"  "%~dp0\.\node_modules\mocha\bin\mocha" %*
) ELSE (
  node  "%~dp0\.\node_modules\mocha\bin\mocha" %*
) 
```

npm 生成正确的脚本文件所需的秘诀是什么？我已经尝试了我能找到或想到的所有东西，包括删除 .js 扩展名、首选全局、指定节点版本……不走运。

我在 Windows 7 x64 上使用节点 v0.6.18 和 npm v1.1.21。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-06T02:35:55.280

试着放

```
#!/usr/bin/env node 
```

在`demo-cli.js`文件的顶部。

在 Windows 上，`npm`在创建`.cmd`包装器时查找此 shebang 行。有关更多信息，请参阅源代码中的[cmd-shim.js](https://github.com/isaacs/npm/blob/master/lib/utils/cmd-shim.js)`npm`。

# excel - 自动填充使用一半的核心

> ID：10905442
> 
> 赞同：3
> 
> 时间：2012-06-05T21:45:20.723
> 
> 标签：excel, excel-2010, excel-interop, excel-dna

我正在自动填充 Excel 中的一些列（一次一个）。这些专栏使用了我在 ExcelDna 中编写的 UDF。使用任务管理器，我注意到只有一半的核心被使用。Excel 设置设置为“使用这台计算机上的所有处理器”。所以我不明白为什么只有一半的核心在使用。想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:51:13.317

此页面包含有关 Excel 2007+ 中的多处理的一些有见地的解释 [http://msdn.microsoft.com/en-us/library/office/aa730921(v=office.12).aspx#office2007excelperf_ExcelPerformanceImprovements](http://msdn.microsoft.com/en-us/library/office/aa730921(v=office.12).aspx#office2007excelperf_ExcelPerformanceImprovements)

**参考：《多线程计算》《某些 Excel 功能不使用多线程计算，例如：数据表计算（但对表的结构化引用确实使用 MTC）。用户定义的函数（但 XLL 函数可以启用多线程）。XLM* “ *_*

由于它没有具体描述“自动填充” - 我将从并发的角度对其进行破解。如果其中一些是猜测，请原谅..

某些功能需要一个“有序”的任务，不能轻易地跨处理器拆分，我们可能会怀疑 fill 是其中之一。（它需要在某些模式下进行顺序操作。例如：步进 1、1.2、1.4 等）。在此示例中，处理器 2 不能仅从页面中间开始而不执行新的/自定义的独立计算。必须设计特殊功能。也许他们决定不为这些场景编写代码。使用公式我什至看不到这是可能的，因为您可能正在创建公式树。

其他操作基于公式树是独立的（参见链接）。这强烈暗示 Excel 也不会多处理复杂的公式树 .. 因此，如果您连接了许多公式，它们（该树）将仅由一个处理器按顺序处理。

当然，对于这些情况，有各种复杂的变通方法..（可能类似于编译器、SQL 服务器等）但上面的文档强烈暗示微软设计它只是为了简化独立任务。

# c# - this.Resources["ControlHighlightBrush"] as Brush; 抛出异常

> ID：10905450
> 
> 赞同：0
> 
> 时间：2012-06-05T21:46:06.613
> 
> 标签：c#, windows-8, microsoft-metro

我正在尝试基于 Oreilly 的开发 Windows 8 书创建一个 Metro 应用程序。

我有以下代码，基于空白的地铁模板

```
Type rootType = typeof(DependencyObject); 
TypeInfo rootTypeInfo = typeof(DependencyObject).GetTypeInfo(); 
List<Type> classes = new List<Type>(); 
Brush highlightBrush; 

public MainPage()
{
    this.InitializeComponent();
    highlightBrush = this.Resources["ControlHighlightBrush"] as Brush; 
```

最后一行抛出此异常。据我了解，它将在公共文件夹中搜索 ControlHighlightBrush 但如果它不存在于 StandardStyles.xaml 文件中，它不会工作吗？

我想那是怎么回事？

> mscorlib.dll 中出现“System.Runtime.InteropServices.COMException”类型的异常，但未在用户代码中处理
> 
> 附加信息：对 COM 组件的调用已返回错误 HRESULT E_FAIL。
> 
> 如果有这个异常的处理程序，程序可以安全地继续。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T01:09:31.850

我认为默认情况下它不会在任何公共文件夹中查找资源。资源必须在 MergedDictionary 集合的 App.xaml 中明确指定：

```
<Application.Resources>
    <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>

            <!-- 
                Styles that define common aspects of the platform look and feel
                Required by Visual Studio project and item templates
             -->
            <ResourceDictionary Source="Common/StandardStyles.xaml"/>
            <ResourceDictionary Source="Common/CustomStyles.xaml"/>
        </ResourceDictionary.MergedDictionaries>

        <!-- Application-specific resources -->

        <x:String x:Key="AppName">My App</x:String>
    </ResourceDictionary>
</Application.Resources> 
```

因此，您可以在 CustomStyles.xaml 等文件中添加自定义样式，并将其包含在上面。

# objective-c - Objective-C中的加权随机字母

> ID：10905458
> 
> 赞同：3
> 
> 时间：2012-06-05T21:47:27.190
> 
> 标签：objective-c, random

我需要一种简单的方法来从字母表中随机选择一个字母，并根据我希望它出现的百分比加权。例如，我希望字母“E”在随机函数中出现 5.9% 的时间，但我只希望“Z”出现 0.3% 的时间（依此类推，基于每个函数的平均出现率）字母表中的字母）。有什么建议么？我看到的唯一方法是用 10000 个字母（590 个“E”、3 个“Z”等）填充一个数组，然后从该数组中随机选择一个字母，但这似乎是内存密集型和笨拙的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T21:59:48.407

不确定这是否可行，但似乎它可以解决问题：

1.  获取您的字母和频率列表，并将它们从最小频率排序到最大频率。
2.  创建一个 26 元素数组，其中每个元素 n 包含所有先前权重的总和以及频率列表中的元素 n。记下数组最后一个元素的总和
3.  生成一个介于 0 和您在上面记下的总和之间的随机数
4.  对总和数组进行二进制搜索，直到到达该数字将下降的元素

这有点难以理解，所以它会是这样的：

1.  如果你有一个 5 个字母的字母表，这些频率为 a = 5%、b = 20%、c = 10%、d = 40%、e = 25%，请按频率对它们进行排序：a、c、b、e、d
2.  保持元素的运行总和：5、15、35、60、100
3.  生成一个介于 0 到 100 之间的随机数。假设它是 22。
4.  对 22 下降的元素进行二分搜索。在这种情况下，它将位于元素 2 和 3 之间，即字母“b”（我认为，四舍五入是你想要的）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T22:43:18.183

你已经承认空间和速度之间的权衡，所以我不会讨论这个。

*如果您可以先验*计算每个字母的频率，那么您可以预先生成一个数组（或动态创建并填充一次数组）以按您想要的精度级别进行扩展。

由于您使用了小数点后一位精度的百分比，因此请考虑一个包含 1000 个条目的数组。每个指数代表频率的十分之一。所以你必须等于`letter[0]`，等于`letter[82]`，依此类推，直到等于。（根据[英文字母相对频率的](http://en.wikipedia.org/wiki/Letter_frequency#Relative_frequencies_of_letters_in_the_English_language)值）`'a'``letter[83]``letter[97]``'b'``letter[999]``'z'`

现在生成一个介于 0 和 1 之间的随机数（使用您拥有的任何喜欢的 PRNG，假设分布均匀）并将结果乘以 1000。这将为您提供数组的索引和加权随机字母。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-07T03:38:22.380

使用此处说明的方法。唉，这适用于 Python，但可以为 C 等重写。 [https://stackoverflow.com/a/4113400/129202](https://stackoverflow.com/a/4113400/129202)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-08T02:37:19.620

首先，您需要对字母及其频率进行 NSDicationary；

我会用一个例子来解释它：假设你的字典是这样的：

> {@“a”：@0.2，@“b”，@0.5，@“c”：@0.3}；

所以你字母的频率以这种方式覆盖了 [0, 1] 的区间：

> a->[0, 0.2] + b->[0.2, 0.7] + c->[0.7, 1]

您生成一个介于 0 和 1 之间的随机数。然后通过检查该随机数属于哪个区间并返回相应的字母，您可以轻松获得所需的内容。

您在程序开始时播种随机函数： srand48(time(0));

> -(NSSting *)weightedRandomForDicLetters:(NSDictionary *)letterFreq {

```
double randomNumber = drand48();

double endOfInterval = 0;
for (NSString *letter in dic){
    endOfInterval += [[letterFreq objectForKey:letter] doubleValue];
    if (randomNumber < endOfInterval) {
        return letter;
    }
} 
```

}

# c# - 添加“图片”链接并将其与 ID 相关联

> ID：10905460
> 
> 赞同：1
> 
> 时间：2012-06-05T21:47:30.413
> 
> 标签：c#, mysql, asp.net-mvc, asp.net-mvc-3

我正在做[这个](http://www.asp.net/mvc/tutorials/getting-started-with-aspnet-mvc3/cs/intro-to-aspnet-mvc-3)asp.net的教程，一切都很好，但我想在这个表中添加一个“图片”链接。当它在新页面中单击时，将显示该 ID 的上传文件。

如何将图片与同一行的 ID 关联起来。我是 C# MVC3 的新手，所以一些解释将不胜感激。

谢谢。

注意：我编辑了它，所以它使用 MySQL 作为数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T20:12:16.533

一旦您将模型从控制器传递到您的视图中，您就可以像我在下面所做的那样在表中创建链接。此链接将传递 id 或您已提供或正在使用的任何变量，用于您想要传递回控制器的图片。从控制器使用该 id 来拉取图像并将它们传递到新视图中。

```
@foreach (var item in Model) {
<tr>
    <td>
        @Html.ActionLink("Picture", "Picture", new { id=item.ID }) |
    </td>
</tr> 
```

这是一个非常好的开始 MVC [从控制器访问模型数据的教程](http://www.asp.net/mvc/tutorials/getting-started-with-aspnet-mvc3/cs/accessing-your-model%27s-data-from-a-controller)

# javascript - 如何使用 javascript 从链接 rel="next" 获取 url

> ID：10905461
> 
> 赞同：3
> 
> 时间：2012-06-05T21:47:42.627
> 
> 标签：javascript

如何从中获取网址

```
<link rel="prev" title="Selected 3" href="http://mydomain.com/2.html" /> 
```

在头脑中使用纯javascript？

在 jquery 中，我有一个可行的解决方案：

```
var prevUrl = $('link[rel=prev]').attr("href"); 
```

我无法更改“link rel”的输出或添加 Id，因为它是由 CMS 生成的。

非常感谢任何帮助，谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-05T21:52:11.010

IE8+

```
document.querySelector('link[rel="prev"]').href; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-05T21:50:18.507

```
var links = document.getElementsByTagName( "link" ),
    filtered = [],
    i = links.length;
while ( i-- ) {
    links[i].rel === "prev" && filtered.push( links[i] );
}

alert( filtered[0].href ); 
```

演示：http: [//jsfiddle.net/je7Qr/](http://jsfiddle.net/je7Qr/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T21:52:57.413

```
var links = document.getElementsByTagName("link");
for (var i = 0; typeof(el = links[i]) != "undefined"; i++) {
    if (el.rel == "prev") {
        alert(el.href);
        break;
    }
} 
```

# c - 用方括号和索引而不是 . 引用 c 中的结构字段。和->？

> ID：10905475
> 
> 赞同：9
> 
> 时间：2012-06-05T21:48:32.897
> 
> 标签：c, struct

假设我有一个结构，例如：

```
typedef struct
{
    char * string1;
    char * string2;
} TWO_WORDS; 
```

这样所有的字段都是相同的类型，我的主要有

```
TWO_WORDS tw; 
```

我可以用 tw[0] 引用 string1，用两个 [1] 引用 string2 吗？如果是这样的话：

*   这是c标准的一部分吗？
*   我必须先将结构转换为数组吗？
*   内存中大小不同的字段呢
*   不同类型但大小相同的字段呢？
*   你能在结构中做指针运算吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T21:56:20.290

我对这个结构非常接近：

```
((char**)&tw)[0]; 
```

举个例子：

```
int main()
{
    typedef struct
    {
        char * string1;
        char * string2;
    } TWO_WORDS;

    TWO_WORDS tw = {"Hello", "World"};

    printf("String1: %s\n", ((char**)&tw)[0]);
    printf("String2: %s\n", ((char**)&tw)[1]);

    return 0;
} 
```

它不能保证有效，因为编译器可能会在字段之间添加填充。（许多编译器都有一个`#pragma`可以避免结构填充）

**要回答您的每个问题：**

*   这是c标准的一部分吗？**不**

*   我必须先将结构转换为数组吗？**是的**

*   内存中大小不同的字段呢？
    **这可以通过更“邪恶”的强制转换和指针数学来完成**

*   不同类型但大小相同的字段呢？
    **这可以通过更“邪恶”的铸造和指针数学来完成**

*   你能在结构中做指针运算吗？
    **是** *的（不保证总是按您预期的那样工作，但结构只是一块您可以使用指针和指针数学访问的内存）*

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-05T21:57:11.760

正如@ouah 指出的那样，不，你不能那样做。但是，您可以：

```
typedef union
{ char *a[2];
  struct
  { char *string1;
    char *string2;
  } s;
} TWO_WORDS;

TWO_WORDS t;

t.a[0] = ...;
t.a[1] = ...;
t.s.string1 = ...;
t.s.string2 = ...; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-05T22:12:50.140

不，您不能对结构数据成员使用索引访问，除非您采取特定步骤来模拟它。

在 C++ 中，可以使用称为“指向数据成员的指针”的特定于 C++ 的指针类型来模拟此功能。C 语言没有这种类型，但它可以反过来通过使用标准`offsetof`宏和指针算法来模拟。

在您的示例中，它可能如下所示。首先，我们准备一个特殊的偏移数组

```
const size_t TW_OFFSETS[] = 
  { offsetof(TWO_WORDS, string1), offsetof(TWO_WORDS, string2) }; 
```

这个偏移数组稍后用于组织对结构成员的索引访问

```
*(char **)((char *) &tw + TW_OFFSETS[i]); 
/* Provides lvalue access to either `tw.string1` or `tw.string2` depending on 
   the value of `i` */ 
```

它看起来并不漂亮（尽管可以通过使用宏使它看起来更好），但这就是它在 C 中的方式。

例如，我们可以定义

```
 #define TW_MEMBER(T, t, i) *(T *)((char *) &(t) + TW_OFFSETS[i]) 
```

并在代码中使用它

```
 TW_MEMBER(char *, tw, 0) = "Hello";
 TW_MEMBER(char *, tw, 1) = "World";

 for (int i = 0; i < 2; ++i)
   printf("%s\n", TW_MEMBER(char *, tw, i)); 
```

请注意，这种方法不存在基于将结构重新解释为`char*[2]`数组的解决方案中存在的严重问题（无论它是通过联合还是通过强制转换完成的）。后者是一种 hack，从形式上看是非法的，通常是无效的。基于-`offsetof`的解决方案是完全有效和合法的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-05T21:51:00.433

> 我可以用 tw[0] 引用 string1，用两个 [1] 引用 string2 吗？

不，你不能在 C 中，`tw`是结构而不是指针。

运算符的约束`[]`要求其中一个操作数是指针类型。

要访问`string1`，您可以使用以下表达式：`tw.string1`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-05T21:52:15.167

不，您不能在 C 中这样做。您只能通过名称访问 C 中的结构成员。

您可以做的是构建一个数组，该数组具有指向与结构中相同的字符串的指针，然后使用数组的索引。

但是你为什么要这样做呢？您实际上要解决的问题是什么？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-05T21:54:22.140

`((char **)&tw)[0]`如果你真的想这样做，你可以使用它，但不是`tw[0]`.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-06T07:09:23.353

如果一个 a `struct`which 以所有相同类型的字段开头，则可以声明 a`union`其中包括该类型的结构以及适当字段类型的数组。如果这样做，读取或写入数组的元素将读取或写入适当的结构成员。这种行为适用于我所知道的所有实现，并且我相信如果所有字段的大小相同，它是可移植的。

```
结构 quad_int {int n0; 诠释n1；诠释n2; 诠释 n3;}
union quad_int_union {结构对 p; 诠释 n[4];}

union quad_int_union my_thing;

my_thing.n[0] 与 my_thing.p.n0 同义
my_thing.n[1] 与 my_thing.p.n1 同义
等等

```

# facebook - 关于 FB 对象、JavaScript SDK、OAauth 2.0 和 Graph API 的线程？

> ID：10905476
> 
> 赞同：0
> 
> 时间：2012-06-05T21:48:50.240
> 
> 标签：facebook, facebook-graph-api, facebook-javascript-sdk

我无法理解 FB API。我觉得问题是因为我无法理解协议 OAouth 草稿页面（[来源](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-05#section-3.5.2)，第 19 页）。好吧，首先是这样，但现在我明白了 OAouth 1.0 和 OAuth 2.0 是完全不同的协议，尽管显然是为了同一个目标......

也许最重要的东西是关于身份验证的 FB 文档和[这里](https://developers.facebook.com/docs/authentication/)的博客 [文章](http://benbiddington.wordpress.com/2010/04/23/facebook-graph-api-getting-access-tokens/)。我正在尝试对此处的线程进行分类，以更深入地研究 FB API。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T21:55:52.180

> 我在 Graph API 对象中找不到图片或朋友等内容

那是因为你没有要求他们……</p>

要获取用户的朋友，您必须查询 /userid/friends 连接。

对于用户的图片，您可以使用地址[https://graph.facebook.com/userid/picture](https://graph.facebook.com/userid/picture)作为图片 src——这将重定向到实际图片。

这一切都在这里描述：[https](https://developers.facebook.com/docs/reference/api/user/) ://developers.facebook.com/docs/reference/api/user/在“连接”下</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T11:59:06.873

我正在尝试整理这里的东西。

**试题和一些困惑点**

> > [这里](http://pastie.org/4034445)和历史中的一些代码。登录历史。
> > 
> > 1.  **[已解决]**试用 1 显示来自 FB 的封面图片，但未使用 FB API。FB -object 不存储图片 URL！您需要使用 POST -url。
> >     
> >     
> > 2.  **[已解决]**试用 2`/userId`不请求好友（感谢一个答案），但现在出现了一个新的授权问题，由这里的答案[解决](https://stackoverflow.com/a/5091913/164148)。
> >     
> >     
> > 3.  **[已解决]**由于没有访问令牌，试用 3`/userID/friends`不起作用。解决方案[在这里](http://pastie.org/private/1enk6a7nrpscwzfg8bgtq)。
> >     
> >     
> > 4.  **[已解决]**[这里](https://developers.facebook.com/docs/reference/javascript/FB.login/)很多最里面的FB.login怎么 获取access token呢？把这个 q 移到[这里](https://stackoverflow.com/questions/10906260/explain-many-inner-most-loops-in-fb-login-to-get-the-access-token)。
> >     
> >     
> > 5.  **[已解决]**什么`__PROTO__`意思？- 不可靠，你不会用它（根据历史上的聊天-msg）。

**第三方材料**

> **手册**
> 
> 1.  图形 API[在这里](https://developers.facebook.com/docs/reference/api/)
>     
>     
> 2.  JS SDK[在这里](https://developers.facebook.com/docs/reference/javascript/)
>     
>     
> 3.  关于网络服务器流程的 OAuth 草案文件在[这里](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-05#section-3.5.2)。
>     
>     
> 4.  FB.login [here](https://developers.facebook.com/docs/reference/javascript/FB.login/)
>     
>     
> 
> **也许相关**
> 
> 1.  [URL-method] [facebook graph api 图片](https://stackoverflow.com/questions/9036566/facebook-graph-api-picture)
>     
>     
> 2.  [URL -method] [facebook graph api 照片检索](https://stackoverflow.com/questions/6076752/facebook-graph-api-photos-retrieve)
>     
>     
> 3.  [URL -method] [facebook graph api 检索墙上的照片](https://stackoverflow.com/questions/9044188/facebook-graph-api-retrieve-wall-photos)
>     
>     
> 4.  [PHP][如何使用 Facebook graph API 检索上传到粉丝页面墙的粉丝照片？](https://stackoverflow.com/questions/5083464/how-to-use-facebook-graph-api-to-retrieve-fan-photos-uploaded-to-wall-of-fan-pag)
>     
>     
> 5.  [PHP][通过 Facebook Graph API 拉入照片](https://stackoverflow.com/questions/4319235/pulling-in-photos-via-facebook-graph-api)
>     
>     
> 6.  [未解决] [https://stackoverflow.com/questions/7819091/can-i-retrieve-facebook-photos-through-graph-api-that-are-only-shared-with-frien](https://stackoverflow.com/questions/7819091/can-i-retrieve-facebook-photos-through-graph-api-that-are-only-shared-with-frien)

# mysql - 无法使用 Hibernate Jpa、Tomcat 和 Mysql 通过 persistence.xml 在数据库中添加表

> ID：10905479
> 
> 赞同：0
> 
> 时间：2012-06-05T21:49:03.550
> 
> 标签：mysql, hibernate, tomcat, jpa, persistence

我在 flex、blazeds、hibernate jpa、tomcat 和 mysql 中工作。这是我开始项目时面临的问题：

```
05.06.2012 22:33:29.459  INFO     org.hibernate.cfg.annotations.Version     - Hibernate Annotations 3.4.0.GA
05.06.2012 22:33:29.479  INFO     org.hibernate.cfg.Environment             - Hibernate 3.3.2.GA
05.06.2012 22:33:29.482  INFO     org.hibernate.cfg.Environment             - hibernate.properties not found
05.06.2012 22:33:29.487  INFO     org.hibernate.cfg.Environment             - Bytecode provider name : javassist
05.06.2012 22:33:29.493  INFO     org.hibernate.cfg.Environment             - using JDK 1.4 java.sql.Timestamp handling
05.06.2012 22:33:29.645  INFO     org.hibernate.annotations.common.Version  - Hibernate Commons Annotations 3.1.0.GA
05.06.2012 22:33:29.650  INFO     org.hibernate.ejb.Version                 - Hibernate EntityManager 3.4.0.GA 
```

这是我在 src/META-INF 下的 persistence.xml 文件：

```
<persistence version="1.0"
xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd">

<persistence-unit name="consultant_db">
    <provider>org.hibernate.ejb.HibernatePersistence</provider>

    <class>com.adobe.demo.domain.Permission</class>
    <class>com.adobe.demo.domain.Role</class>
    <class>com.adobe.demo.domain.User</class>

    <properties>
        <property name="hibernate.connection.driver_class" value="com.mysql.jdbc.Driver" />
        <property name="hibernate.connection.url" value="jdbc:mysql://localhost/consultant_db" />
        <property name="hibernate.connection.username" value="root" />
        <property name="hibernate.connection.password" value="" />
        <property name="hibernate.dialect" value="org.hibernate.dialect.MySQL5Dialect" />

        <property name="hibernate.connection.pool_size" value="6" />
        <property name="hibernate.connection.autoReconnect" value="true" />
        <property name="hibernate.generate_statistics" value="false" />
        <property name="hibernate.show_sql" value="true" />
        <property name="hibernate.use_sql_comments" value="false" />
        <property name="hibernate.hbm2ddl.auto" value="update" />
    </properties>

</persistence-unit> 
```

但如果我删除该行： `<class>com.adobe.demo.domain.User</class>` 将创建其他 2 个表。我应该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T18:01:24.443

[这](https://stackoverflow.com/questions/10923904/one-table-is-not-being-created-by-toplink)是一个类似的问题。OP 试图创建一个“用户”表，但失败了。OP 能够通过`User`用`@Table(name = "\"user\"")`.

我还提供了一些有关如何解决此类问题的提示。

# c# - Visual Fox Pro 中的哪种方法等效于 C# 中的 Rand(int)

> ID：10905484
> 
> 赞同：-3
> 
> 时间：2012-06-05T21:49:30.690
> 
> 标签：c#, asp.net, .net, foxpro, visual-foxpro

占用将Visual Fox Pro emigrarlo迁移到C#中的一个方法，我遇到的问题是如何知道Visual Fox Pro中的方法：

```
Rand(intValue) 
```

方法等于 dotNet：

```
Random r = new Random (intValue);
r.Next return (); 
```

假设 intValue = 971 在 dotNET 中生成的结果是 2027119，但我需要等于返回 FoxPro。

**主要问题**：我如何确保得到相同的结果？

**次要问题**：你知道有什么在线工具fox pro可以证明这个方法给我的结果是Rand()吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T21:54:17.000

> 主要问题：我如何确保得到相同的结果？

所以你想保证你得到相同的结果......来自两个不同的随机数生成器......对。

`intValue`在您的 FoxPro 示例中是种子值。为什么你需要保证这两个库使用相同的随机数生成器（提示：它们几乎肯定不会）。说真的，如果你追求随机数，它有什么区别？

如果你想要一个已知的数字系列，那么你真的根本不想要一个随机数。这让我大吃一惊。如果您的代码设置为期望来自随机数生成器的特定字符串，那么就会出现更大的问题。您也可以使用 FoxPro 中的数字生成地图并从那里获取数字。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-06T07:30:21.487

实现此目的的唯一方法是创建一个 Visual FoxPro COM 对象，该对象具有一个获取种子值并返回生成的随机数的方法，然后通过 C# 中的 COM 互操作使用它。

没有办法让原生 C# 做到这一点。所以别问了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-05T21:56:26.263

我不确定您为什么要这样做，但这里有一个 Visual FoxPro Toolkit for .NET [http://foxcentral.net/microsoft/vfptoolkitnet.htm](http://foxcentral.net/microsoft/vfptoolkitnet.htm)它可能具有相同的 rand 生成器功能。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-20T14:44:32.040

你问的是可能的。您只是不能使用 Foxpro 和 .NET 框架提供给您的生成器。

大多数“随机”数字生成器只生成“看起来”或“感觉”随机的数字序列。它们的工作方式是这样的（非常简化）：从“种子”值开始，应用转换并生成一个值，然后将转换应用于该值并获得下一个。根据需要重复。转换是这样的，您可以期望值在给定段内均匀分布，通常是 [0,1)。我可以进一步解释这一点，但是周围有很多文献。搜索它。

现在，显然，如果您为任何给定的生成器提供相同的种子，您将一遍又一遍地获得相同的序列。

因此，要获得您想要的结果，您需要在 VFP 和 C# 中实现自己的伪随机数生成器。请记住，诸如精度差异之类的事情可能会使对生成器的连续调用产生分歧。

无论如何，您将需要一个算法。去这里：[使用 D.Knuth 伪随机生成器](https://stackoverflow.com/questions/3954195/use-of-d-knuth-pseudo-random-generator)

希望这仍然有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-05T21:53:30.127

你不能。您正在设置种子值，但 .NET 和 FoxPro 使用完全相同的方法生成随机数的机会接近于零。但问题是，你为什么要这个？随机应该是随机的。

# sql - 从 mysql 查询中获取正确的结果

> ID：10905486
> 
> 赞同：0
> 
> 时间：2012-06-05T21:49:44.300
> 
> 标签：sql

我有以下表格：

```
**products** which has these fields: id,product,price,added_date
**products_to_categories** which has these fields: id,product_id,category_id
**adverts_to_categories** -> id,advert_id,category_id
**adverts** which has these fields: id,advert_name,added_date,location 
```

我无法执行 sql，它将返回给我所有属于类别 14 并且由位于伦敦的广告拥有的产品。所以我有 4 张桌子和 2 个条件 - 来自第 14 类，产品的所有者来自伦敦。我尝试了许多变体来执行 sql，但没有一个结果是正确的。我是否需要使用 Join 以及 which Join - left，right，full？正确的 sql 会是什么样子？提前感谢您的帮助，抱歉让您感到厌烦:)

这是我到目前为止所尝试的：

```
SELECT p.id, product, price, category_id, 
       p.added_date, adverts.location, adverts.id 
FROM products p, 
     products_to_categories ptc, 
     adverts, 
     adverts_to_categories ac 
WHERE ptc.category_id = "14" 
  AND ptc.product_id=p.id 
  AND ac.advert_id=adverts.id 
  AND adverts.location= "London" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T21:56:27.973

非常基本的逻辑

```
Select * from Products P
INNER JOIN Products_To_Categories PTC ON P.ID = PTC.Product_ID
INNER JOIN Adverts_to_Categories ATC ON ATC.Category_Id = PTC.Category_ID
INNER JOIN Adverts AD on AD.ID = ATC.Advert_ID
WHERE PTC.Category_ID = 14 and AD.Location = 'LONDON' 
```

如果您想要其他表中不存在的表中的记录，则只需要左连接或右连接。
例如，如果您想要所有产品，即使一个记录甚至是那些没有类别的产品，那么您将使用左连接而不是内部连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T22:00:22.620

以下语句应返回产品表中 ID 为 14 的类别中的所有列以及位于伦敦的所有广告：

```
select p.* from products p
inner join products_to_categories pc on p.id = pc.product_id
inner join adverts_to_categories ac on pc.category_id = ac.category_id
inner join adverts a on a.id = ac.advert_id
where pc.category_id = 14
and ac.location = 'London'; 
```

如果您经常执行这些基于字符串的查询，您应该记住将索引添加到列位置。

# php - 在查询字符串中使用括号的逗号分隔列表

> ID：10905489
> 
> 赞同：0
> 
> 时间：2012-06-05T21:49:57.063
> 
> 标签：php, query-string

我有一个查询字符串被发送到一个 php 文件，如下所示：参与者 []=111111111,22222222,333333333 等....

如果我删除 [] 它可以正常工作，但是，如果我将其留在其中，它将忽略每个数组。如何让 PHP 在变量名上使用 [] 遍历逗号分隔值？我尝试了爆炸，除非我删除了[]，否则它也失败了。我需要为每个语句为该 var 返回的值的数量创建一个。

我有以下 PHP 代码：

```
$participants = $_REQUEST["participants"];
foreach($participants as $i=>$value) {
    if($value > 1) {
        // define each variable
        $id = $_REQUEST['participants'][$i];
        print "$id<br />";
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T21:54:20.750

我建议在您的代码中使用explode()。
由于您无法删除查询字符串中的括号，您可以测试以下代码：

```
$participants = explode(',', $_REQUEST["participants"][0]);
foreach($participants as $i=>$value)
{
    if(intval($value) > 1) {
        // define each variable
        $id = $participants[$i];
        print "$id<br />";
    }
} 
```

现在的输出是：
111111111
22222222
333333333

# c# - 保存控制器/动作生成的动作结果

> ID：10905495
> 
> 赞同：1
> 
> 时间：2012-06-05T21:50:07.780
> 
> 标签：c#, asp.net-mvc-3, actionresult

我们有一个内部使用的文档管理系统，我试图找出是否有办法保存调用控制器/操作时生成的结果 HTML。

我需要这个，以便可以将字符串值保存到平面文件中。然后，我们有一个脚本，它以设定的时间间隔运行并将文件导入 DMS，然后将其删除。有谁知道任何地方有这样的例子或有一个代码示例可能让我开始？

此外，我需要保存的方法目前正在返回`ActionResult`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:05:46.660

一种选择是在返回视图之前将结果操作呈现为字符串。这可能会有一点开销，因为从技术上讲，您将渲染您的视图两次，但您可以将输出保存到您之前提到的平面文件中。

有关如何将视图呈现为字符串的详细信息，请参见：[https ://stackoverflow.com/a/10746000/501494](https://stackoverflow.com/a/10746000/501494)

# c# - 为什么长时间运行的任务仍然会阻塞 UI？

> ID：10905500
> 
> 赞同：3
> 
> 时间：2012-06-05T21:50:36.587
> 
> 标签：c#, wpf, task-parallel-library

我正在尝试解决我的 UI 被阻止但我不明白为什么的问题。

```
public Task AddStuff(string myID, List<string> otherIDs)
{
    Action doIt = () =>
    {
        this.theService.AddStuff(myID, otherIDs);
    };

    return Task.Factory.StartNew(doIt, TaskCreationOptions.LongRunning);
} 
```

如果列表很长，调用可能需要 30 秒，并且整个应用程序变得无响应（在 Windows 7 中变成白色）。

有没有不同的方法来做到这一点，所以它不会阻塞用户界面？

* * *

**编辑**

好的，所以有很多关于此的代码，我将尝试保持相关性。我确实意识到回到原始代码，我已经删除了一些可能很重要的东西。我应该使用不同的 TaskScheduler`TaskScheduler.Current`吗？

此外，没有阻止任何此代码的等待语句，并且服务不与 UI 交互。

```
Task.Factory.StartNew(objState =>
    {
        LoadAssets(objState);
    }, state, this.cancellationToken, TaskCreationOptions.LongRunning, TaskScheduler.Current); 
```

* * *

```
private void LoadAssets(object objState)
{
    LoadAssetsState laState = (LoadAssetsState)objState;

    List<string> assetIDs = new List<string>();

    for (int i = 0; i < laState.AddedMediaItems.Count; i++)
    {
        if (laState.CancellationToken.IsCancellationRequested)
            return;

        string assetId = this.SelectFilesStep.AssetService.GetAssetId(laState.AddedMediaItems[i], laState.ActiveOrder.OrderID);

        assetIDs.Add(assetId);

    }

    if (laState.CancellationToken.IsCancellationRequested)
        return;

    this.ApiContext.AddAssetToProduct(laState.ActiveOrder.OrderID, laState.ActiveProduct.LineID, assetIDs, laState.Quantity, laState.CancellationToken).ContinueWith(task =>
    {
        if (laState.CancellationToken.IsCancellationRequested)
            return;

        App.ApiContext.GetOrderDetails(laState.ActiveOrder.OrderID, false, laState.CancellationToken).ContinueWith(orderDetailsTask =>
        {
            if (laState.CancellationToken.IsCancellationRequested)
                return;

            this.activeOrder = orderDetailsTask.Result;

            this.StandardPrintProductsStep.Synchronize(this.activeOrder);

        });
    });
} 
```

* * *

```
public Task AddAssetToProduct(string orderID, string lineID, List<string> assetIDs, int quantity, CancellationToken? cancellationToken = null)
{
    Action doIt = () =>
    {
        if (cancellationToken.IsCancellationRequested())
            return;

        this.ordersService.AddAssetToProduct(orderID, lineID, assetIDs, quantity);
    };

    if (cancellationToken != null)
        return Task.Factory.StartNew(doIt, cancellationToken.Value, TaskCreationOptions.LongRunning, TaskScheduler.Current);
    else
        return Task.Factory.StartNew(doIt, TaskCreationOptions.LongRunning);
} 
```

* * *

**编辑**

我在服务调用之前和之后放置了断点，它是阻塞 UI 的服务调用，而不是任何其他行。

听起来没有理由阻止它，所以我想如果它很长，我会分解列表并进行多次调用。我只是想确保我的任务逻辑没有遗漏任何东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T21:53:14.910

> 有没有不同的方法来做到这一点，所以它不会阻塞用户界面？

此调用本身不应阻塞 UI。但是，如果`theService.AddStuff`与 UI 的 SynchronizationContext 进行一些同步，这可能会导致 UI 被该调用有效地阻止。

否则，问题可能发生在此函数之外。例如，如果您调用`Wait()`从此方法返回的任务，则在 UI 线程中，UI 线程将被阻塞，直到完成。

* * *

您可能想使用[TaskScheduler.Default](http://msdn.microsoft.com/en-us/library/system.threading.tasks.taskscheduler.default.aspx)，而不是`TaskScheduler.Current`. 如果这是在基于 UI 线程的 TaskScheduler 上调度的 Task 中调用的，它将在 UI 线程上自行调度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T13:42:32.267

希望我可以将格式化的代码放在评论中，但由于我不知道如何添加这个片段作为答案。这是我用来确定任务是否在 UI 线程上运行的方法（因为您不希望它运行）并使操作完全不同（简单的 thread.sleep）。

```
var state = new object();
var cancellationTokenSource = new CancellationTokenSource();
var cancellationToken = cancellationTokenSource.Token;

var task = Task.Factory.StartNew(
    objState => { Console.WriteLine ("Current thread is {0}", Thread.CurrentThread.ManagedThreadId); Thread.Sleep(30); },
    state,
    cancellationToken,
    TaskCreationOptions.LongRunning,
    TaskScheduler.Current);

task.Wait(); 
```

# ios - 使用 for 循环设置数组中的值

> ID：10905502
> 
> 赞同：0
> 
> 时间：2012-06-05T21:50:37.757
> 
> 标签：ios, json, for-loop

我有一个`UITableViewController`使用数组，其中包含行中每个条目的值。我想通过迭代从 JSON 文件中读取的值来设置该数组的值。

这是我创建的用于将该数据读入数组并将其返回到我的视图控制器的新方法。我不知道在哪里返回数组，或者如何真正设置它。

```
+(NSArray *)setDataToJson{
NSDictionary *infomation = [NSDictionary dictionaryWithContentsOfJSONString:@"Test.json"];
NSArray *test = [infomation valueForKey:@"Animals"];
for (int i = 0; i < test.count; i++) {
    NSDictionary *info = [test objectAtIndex:i];
    NSArray *array = [[NSArray alloc]initWithObjects:[Animal animalObj:[info valueForKey:@"AnimalName"] 
location:[info valueForKey:@"ScientificName"] description:[info valueForKey:@"FirstDesc"] image:[UIImage imageNamed:@"cat.png"]], nil];
        return array; 
```

我知道当数据是本地字符串（@“Cat”）和我的`dictionaryWithContentsOfJSONString`作品时我的 animalObj 函数起作用，因为我已经测试过，但我没有使用这个函数将数据设置为数组，只设置为 UILabels，所以这就是我很困惑，如何将这些数据设置为数组。但仍然使用 For 循环。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T05:09:36.103

您想使用 的实例 [`NSMutableArray`](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSMutableArray_Class/Reference/Reference.html)，它可以让您在使用 for 循环进行迭代时逐步将元素添加到数组中：

```
...
NSMutableArray *array = [NSMutableArray array];
for (int i = 0; i < test.count; i++) { 
    NSDictionary *info = [test objectAtIndex:i]; 
    Animal *animal = [Animal animalObj:[info valueForKey:@"AnimalName"]  
                              location:[info valueForKey:@"ScientificName"] 
                           description:[info valueForKey:@"FirstDesc"] 
                                 image:[UIImage imageNamed:@"cat.png"]];
    [array addObject:animal];
}
return array; 
```

因为`NSMutableArray`是 的子类`NSArray`，所以不需要更改方法的返回类型。

# python - 什么是“基于内省的代码完成”？

> ID：10905503
> 
> 赞同：6
> 
> 时间：2012-06-05T21:50:45.400
> 
> 标签：python, ide

我正在寻找各种适用于 python 的 IDE。查看官方[列表](http://wiki.python.org/moin/IntegratedDevelopmentEnvironments)，IDE 是根据“**基于内省的代码完成**”进行分类的。

基于内省的代码完成是什么意思？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-05T21:52:14.363

这意味着 IDE 使用自省来确定可以从给定对象访问哪些方法和变量，然后允许快速完成代码，通常是在您在符号后面键入句点后提供选项列表。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-05T22:18:25.067

以下是 WingIDE Pro 不作为的示例。原谅匆忙拼凑在一起的形象。

![这是图像](../Images/60e47c94bdb8b9446b64bf81f47e57f1.png)

您可以看到它`arg1`与`1`第一个示例一样显示，以及显示它可能是`int`.

在第二部分中，您可以看到 IDE`get`在`requests`模块中查看文档字符串以了解该方法的作用。

下面的第二张图片显示 IDE 可以为您“自动完成”代码，包括显示它的作用。![在此处输入图像描述](../Images/912ef0a043a1ff487225259ed9a1cd3b.png)

# windows - .htaccess 做了很多内部循环

> ID：10905507
> 
> 赞同：0
> 
> 时间：2012-06-05T21:51:08.303
> 
> 标签：windows, apache, .htaccess

```
#### BOF SSU 
Options +FollowSymLinks -MultiViews 

RewriteEngine On 

RewriteBase /refm/ 

# Deny access from .htaccess 
RewriteRule ^\.htaccess$ - [F] 

RewriteCond %{SCRIPT_FILENAME} !-f 
RewriteCond %{SCRIPT_FILENAME} !-d 
RewriteRule ^(.*) index.php?/$1 [E=VAR1:$1,QSA,L] 

#### EOF SSU 
```

我一直在 Ubuntu 上使用相同的 .htaccess 代码，它工作正常，现在我在 Windows 机器上工作，它似乎不起作用，当我点击内部页面上的任何内容时，它总是加载主页. 基本上，这个 .htaccess 所做的是为 Zen Cart 页面和产品启用漂亮的永久链接。.htaccess 文件被 Apache 识别，因为我检查了`httpd.conf`配置，我检查了`error.log`，这是我发现的错误：

`[error] [client 127.0.0.1] Request exceeded the limit of 10 internal redirects due to probable configuration error. Use 'LimitInternalRecursion' to increase the limit if necessary. Use 'LogLevel debug' to get a backtrace.`

我还更改了`LogLevel`to`debug`而不是`warn`查看错误的详细信息，这就是我得到的：

`[Tue Jun 05 23:31:09 2012] [error] [client 127.0.0.1] Request exceeded the limit of 10 internal redirects due to probable configuration error. Use 'LimitInternalRecursion' to increase the limit if necessary. Use 'LogLevel debug' to get a backtrace., referer: http://localhost/refm/refm-excel-products-by-property-type-page-38`

`[Tue Jun 05 23:31:09 2012] [debug] core.c(3065): [client 127.0.0.1] r->uri = /index.php/index.php/index.php/index.php/index.php/index.php/index.php/index.php/index.php/index.php/css/style.css, referer: http://localhost/refm/refm-excel-products-by-property-type-page-38`

`[Tue Jun 05 23:31:09 2012] [debug] core.c(3071): [client 127.0.0.1] redirected from r->uri = /index.php/index.php/index.php/index.php/index.php/index.php/index.php/index.php/index.php/css/style.css, referer: http://localhost/refm/refm-excel-products-by-property-type-page-38`

`[Tue Jun 05 23:31:09 2012] [debug] core.c(3071): [client 127.0.0.1] redirected from r->uri = /index.php/index.php/index.php/index.php/index.php/index.php/index.php/index.php/css/style.css, referer: http://localhost/refm/refm-excel-products-by-property-type-page-38`

`[Tue Jun 05 23:31:09 2012] [debug] core.c(3071): [client 127.0.0.1] redirected from r->uri = /index.php/index.php/index.php/index.php/index.php/index.php/index.php/css/style.css, referer: http://localhost/refm/refm-excel-products-by-property-type-page-38`

`[Tue Jun 05 23:31:09 2012] [debug] core.c(3071): [client 127.0.0.1] redirected from r->uri = /index.php/index.php/index.php/index.php/index.php/index.php/css/style.css, referer: http://localhost/refm/refm-excel-products-by-property-type-page-38`

`[Tue Jun 05 23:31:09 2012] [debug] core.c(3071): [client 127.0.0.1] redirected from r->uri = /index.php/index.php/index.php/index.php/index.php/css/style.css, referer: http://localhost/refm/refm-excel-products-by-property-type-page-38`

`[Tue Jun 05 23:31:09 2012] [debug] core.c(3071): [client 127.0.0.1] redirected from r->uri = /index.php/index.php/index.php/index.php/css/style.css, referer: http://localhost/refm/refm-excel-products-by-property-type-page-38`

`[Tue Jun 05 23:31:09 2012] [debug] core.c(3071): [client 127.0.0.1] redirected from r->uri = /index.php/index.php/index.php/css/style.css, referer: http://localhost/refm/refm-excel-products-by-property-type-page-38`

`[Tue Jun 05 23:31:09 2012] [debug] core.c(3071): [client 127.0.0.1] redirected from r->uri = /index.php/index.php/css/style.css, referer: http://localhost/refm/refm-excel-products-by-property-type-page-38`

`[Tue Jun 05 23:31:09 2012] [debug] core.c(3071): [client 127.0.0.1] redirected from r->uri = /index.php/css/style.css, referer: http://localhost/refm/refm-excel-products-by-property- type-page-38`

`[Tue Jun 05 23:31:09 2012] [debug] core.c(3071): [client 127.0.0.1] redirected from r->uri = /css/style.css, referer: http://localhost/refm/refm-excel-products-by-property-type-page-38`

所以似乎有某种循环。你能帮我弄清楚吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T12:54:42.563

尝试用这个替换你的最后一条规则：

```
RewriteCond %{REQUEST_FILENAME} !-f 
RewriteCond %{REQUEST_FILENAME} !-l
RewriteCond %{REQUEST_FILENAME} !-d 
RewriteRule ^(.*)$ /index.php/$1 [E=VAR1:$1,L] 
```

# mongodb - MongoDB $push 运算符是添加嵌入式文档的方式吗？

> ID：10905508
> 
> 赞同：3
> 
> 时间：2012-06-05T21:51:09.807
> 
> 标签：mongodb, spring-3, mongodb-java

我正在使用 MongoDB 和 Spring 3。我有以下域对象：

```
@Document(collection = "users")
public class User {

    @Id
    private String id;

    private List<Post> posts;
} 
```

我想将 a 添加`Post`到 a `User`，但是最好/最有效的方法是什么？我可以看到一种以编程方式执行此操作的方法 - 找到用户，将新的帖子对象添加到列表中并再次保存用户 - 但我认为这不是非常优雅或高效。

从文档来看，我似乎需要使用`$push`运算符，但我似乎找不到任何关于如何使用 Spring 的 MongoTemplate 执行此操作的示例。谁能提供一个例子？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-06T06:18:15.193

$push 是向数组添加新文档的正确方法。

[您可以在此演示文稿](http://www.slideshare.net/chris.e.richardson/mongodb-for-java-developers-with-spring-data)中查看示例代码（幻灯片 22）。相关行将是：

```
mongoTemplate.updateFirst(collection, 
... new Query(where("_id").is(...)),
... new Update().push("field", dbo)); 
```

# php - php sql 登录脚本

> ID：10905512
> 
> 赞同：0
> 
> 时间：2012-06-05T21:51:24.067
> 
> 标签：php, sql, database, login

我想编写一个登录脚本，用户在其中输入电子邮件 ID 和密码，如果电子邮件和密码都正确，则会转到另一个页面。此外，如果电子邮件和密码正确；这些值存储在数据库中。

这是整个更正的工作代码：

```
 <?php
    if($_POST['submit']){
        $email = protect($_POST['email']);
        $password = protect($_POST['password']);
        $md5password=MD5($password);

        if(!$email || !$password){
            echo '<span style="color: red;" /><center>You need to fill in your <b>User Name</b> and <b>Password</b>!</center></span>';
        }else{
            $res = mysql_query("SELECT * FROM `employer` WHERE `email` = '".$email."'");
            $num = mysql_num_rows($res);

            if($num == 0){
                echo '<span style="color: red;" /><center>The <b>E Mail ID</b> you supplied does not exist!</center></span>';
            }else{
            $res = mysql_query("SELECT * FROM `employer` WHERE `email` = '".$email."' AND `password` = '".$md5password."'");
            $num = mysql_num_rows($res);

            if($num == 0){
                echo '<span style="color: red;" /><center>The <b>Password</b> you supplied does not match the one for that E Mail ID!</center></span>';}else{
                $row = mysql_fetch_assoc($res);

                $_SESSION['uid'] = $row['id'];
                echo "<center>You have successfully logged in!</center>";

                $time = date('U')+50;
                mysql_query("UPDATE `employer` SET `online` = '".$time."' WHERE `id` = '".$_SESSION['uid']."'");
                mysql_query("UPDATE employer (date) VALUES (NOW())");

                header('Location: loggedin_employer.php');
                }
            }
        }
    }
?> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T22:00:25.520

[这里](http://www.tutorialized.com/view/tutorial/How-to-Build-a-Full-Featured-Login-System/63367)有一个教程和其他几十个地方。

***但在查看该教程之前***，请查看[OWASP 身份验证备忘单](https://www.owasp.org/index.php/Authentication_Cheat_Sheet)。

太多人构建了不安全的系统。***不要成为那些人中的一员。*** OWASP 是所有 Web 开发人员都应该非常熟悉的优秀资源。

当您这样做时，您可能需要考虑[Jeff Atwood 的出色建议](http://www.codinghorror.com/blog/2010/11/your-internet-drivers-license.html)。

杰夫的文章摘录：

> 整个互联网上的每个 rinky-dink 网站都要求我为他们创建一个特殊的用户名和密码，这总是让我非常痛苦。是的，如果您是 Alpha 极客，那么您可能会使用实用工具带中的特殊软件和 USB 密钥的组合来为您经常访问的数十个网站生成安全的用户名和密码。但是对于绝大多数沉默的普通人来说，他们对安全一无所知，但最重要的是希望方便，这意味着一件事：一遍又一遍地使用相同的用户名和密码。它也可能是一个简单的密码。

Jeff 还有另一篇关于[OpenId](http://www.codinghorror.com/blog/2008/05/openid-does-the-world-really-need-yet-another-username-and-password.html)的好文章值得在开始探索之前阅读。

最后，可能也是最重要的一点，***[不要错误地存储您的密码！](http://www.codinghorror.com/blog/2007/09/youre-probably-storing-passwords-incorrectly.html)*** 鉴于大多数人在任何地方都使用相同的用户名/密码，如果您的网站遭到入侵，那么他们的所有帐户都可能遭到入侵。

![在此处输入图像描述](../Images/5a3baca230074f901806a4c10acc6fbb.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T21:57:28.860

这可能不是最好的方法，但我就是这样做的。

使用登录表单创建一个简单的 html 页面，当他们按下提交时，将他们的条目发送到数据库中。如果它在那里，则将您创建的全局会话变量（假设它称为`validUser`）设置为 true；然后，使用 javascript 将它们发送到主页。以防他们尝试在未登录的情况下访问该页面，请将以下代码段放在每个安全页面的顶部：

```
<?php
   if (!$_SESSION["validUser"])
      // redirect them to the login page however you want...
?> 
```

该代码段基本上只是检查`validUser`变量是否已设置为 true，如果他们已经登录，它应该有。

# java - 还为菜单按钮显示操作栏？

> ID：10905518
> 
> 赞同：0
> 
> 时间：2012-06-05T21:51:48.373
> 
> 标签：java, android, actionbarsherlock

我正在 ICS 上创建一个操作栏。由于间距，仅显示图标。但是，如果按下手机的菜单按钮，我还想将操作栏作为*带有文本的上下文菜单提供。*

我怎样才能做到这一点？

Atm 我有 3 个图标。其中 2 个显示在操作栏的顶部。如果我按下菜单电话按钮，第三个显示为上下文菜单！但我想拥有所有 3 个。

```
class MyActivity extends SherlockFragmentActivity {
    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        MenuInflater inflater = getSupportMenuInflater();

        /* IMPLEMENTATION HERE */
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:30:57.177

从关于[**Menus**](http://developer.android.com/guide/topics/ui/menus.html)的文档：

> 如果菜单项未作为操作项出现，则系统将其置于溢出菜单中。

因此，不可能在操作栏*和*溢出菜单中显示相同的操作项。你*可以*做的是：

1.  检查（在运行时）哪些菜单项适合操作栏，哪些不适合。

2.  对于显示在操作栏中的每个菜单项，动态创建一个新的、相同的菜单项，确保调用`newMenuItem.setShowAsAction(SHOW_AS_ACTION_NEVER)`以确保它显示在溢出菜单（带文本）中。

在我看来，这违反了 Android 的菜单设计标准，我不建议这样做。在您看来，它可能看起来像是更好的设计选择，但用户希望应用程序在整个 Android 平台上保持一致。以奇怪的方式操作菜单会导致混乱，从而对用户体验产生负面影响。

# actionscript-3 - as3 if 语句检查数字范围

> ID：10905519
> 
> 赞同：0
> 
> 时间：2012-06-05T21:51:58.590
> 
> 标签：actionscript-3, flash

谁能告诉我如何修改它，以便我可以检查一个数字是否在一个范围内？比如说 0-10 和 11-20。我已经尝试过 && 和其他东西，但无法得到任何有效的东西。我想让它尽可能简单。谢谢

```
stop();

value_enter.addEventListener(MouseEvent.CLICK, release1);
function release1(evt:MouseEvent):void 
{
    if ( Number(inputfield.text) > 0)
    {
        gotoAndStop(2);
    }
    else if ( Number(inputfield.text) < 21)
    {
        gotoAndStop(3);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T21:57:35.437

```
//check the range 11-20
if (myNum >= 11 && myNum <= 20) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T22:16:22.743

我会写一个函数......并且只投射一次。

```
function inRange(leftBoundary:Number, value:Number, rightBoundary:Number):Boolean
{
  return leftBoundary <= value && value <= rightBoundary;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T22:09:09.353

我会使用 switch 语句而不是多个 else if 语句。
它通常更干净，更易读的代码。
它还可以让您轻松添加更多案例。

```
stop();

value_enter.addEventListener(MouseEvent.CLICK, release1);
function release1(evt:MouseEvent):void 
{

switch(true){
  case ( Number(inputfield.text) >=0 && Number(inputfield.text) <= 11):
    gotoAndStop(2);
    break;
  case ( Number(inputfield.text) >=10 && Number(inputfield.text) <= 21) :
    gotoAndStop(3);
    break;
  default:
    // inputfield.text value not in bounds 
} 
```

# javascript - 在一页上使用 id="submit" 两次

> ID：10905522
> 
> 赞同：0
> 
> 时间：2012-06-05T21:52:04.457
> 
> 标签：javascript, html, forms

我正在为网站创建登录/注册部分。登录和注册表单在页面上。

喜欢：

```
<form name="loginform" style="text-align:center;" method="post" onsubmit="return validateForm();" action="index.php">
                <div class="row">
                        <input type="text" name="email" id="email" autocomplete="off" placeholder="Email Address" />
                </div>
                <br />
                <div class="row">
                        <input type="password" name="password" id="password" autocomplete="off" placeholder="Password" />
                </div>
                <br />
                <div class="row">
                    <button id="submit" type="submit" class="button large arrow-type-2 dark">Log Me In</button>
                </div>
            </form>

<form name="registerform" style="text-align:center;" method="post" onsubmit="return validatethisForm();" action="index.php">
                    <div class="row">
                            <input type="text" name="email" id="email2" autocomplete="off" placeholder="Email Address"/>
                    </div>
                    <br />
                    <div class="row">
                            <input type="password" name="password" id="password2" autocomplete="off" placeholder="Password"/>
                    </div>
                    <br />
                    <div class="row">
                        <button id="submit" type="submit" class="button large arrow-type-2 dark">Create Free Account</button>
                    </div>
                </form> 
```

我的 Js 验证是：（需要工作）

```
function validateForm()
        {
        var x=document.forms["loginform"]["email"].value;
        var atpos=x.indexOf("@");
        var dotpos=x.lastIndexOf(".");
        if (atpos<1 || dotpos<atpos+2 || dotpos+2>=x.length)
          {
          alert("Not a valid e-mail address");
          return false;
          }
         var x=document.forms["loginform"]["password"].value;
            if (x==null || x=="")
              {
              alert("Please enter a Password");
              return false;
              }
        }
        function validatethisForm()
        {
        var x=document.forms["registerform"]["email2"].value;
        var atpos=x.indexOf("@");
        var dotpos=x.lastIndexOf(".");
        if (atpos<1 || dotpos<atpos+2 || dotpos+2>=x.length)
          {
          alert("Not a valid e-mail address");
          return false;
          }
         var x=document.forms["registerform"]["password2"].value;
            if (x==null || x=="")
              {
              alert("Please enter a Password");
              return false;
              }
        } 
```

我遇到的问题是页面验证，一切正常。但是因为我有重复的提交 ID，我需要清理它。

你能提供改进我上面代码的建议吗？

//////////////////////////////////

使用：下面的代码用于跨浏览器占位符

```
$('[placeholder]').focus(function() {
var input = $(this);
 if (input.val() == input.attr('placeholder')) {
   input.val('');
   input.removeClass('placeholder');
  }
  }).blur(function() {
  var input = $(this);
  if (input.val() == '' || input.val() == input.attr('placeholder')) {
    input.addClass('placeholder');
    input.val(input.attr('placeholder'));
   }
  }).blur().parents('form').submit(function() {
  $(this).find('[placeholder]').each(function() {
   var input = $(this);
   if (input.val() == input.attr('placeholder')) {
     input.val('');
    }
   })
   }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T22:03:38.093

我将您的 HTML 代码简化为以下内容：

```
<form name="loginForm" method="post" onsubmit="return validateForm();" action="index.php">
    <label>Email Address: <input type="email" name="email" autocomplete="off" placeholder="Email Address"/></label>
    <label>Password: <input type="password" name="password" placeholder="Password"/></label>
    <button type="submit" class="button large arrow-type-2 dark">Log In</button>
</form>

<form name="registerForm" method="post" onsubmit="return validatethisForm();"
      action="index.php">
    <label>Email Address: <input type="email" name="email" autocomplete="off" placeholder="Email Address"/></label>
    <label>Password: <input type="password" name="password" placeholder="Password"/></label>
    <button type="submit" class="button large arrow-type-2 dark">Create Free Account</button>
</form> 
```

## 积分

*   始终包含标签。并非所有浏览器都支持 HTML5 占位符。
*   这里所有的ID都是不情愿的。表格可以通过

    ```
    var loginForm = document.forms.loginForm; //By name 
    ```

    并通过以下方式形成元素

    ```
    loginForm.email; //Also by name 
    ```

*   不需要`div`s 和`br`s 来管理换行符。使用标签本身。根据需要添加`display: block;`。
*   不要使用内联样式属性。使用 CSS`<style>`元素或外部样式表。
*   密码字段没有自动完成功能。
*   使用 HTML5 的新表单输入类型。`type="email"`将使浏览器本机验证该字段并在电子邮件无效时通知用户。
*   把事情简单化。不需要腹胀。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T21:56:18.910

由于两个函数做同样的事情，只需创建一个函数并将其绑定到两种形式的“onsubmit”事件。

您使用 Mike Alsup 的[jQuery Form Plugin](http://jquery.malsup.com/form/)标记为 jquery，因此，jquery 风格。

```
function validate(formData, jqForm, options) { 
    // formData is an array of objects representing the name and value of each field 
    // that will be sent to the server;  it takes the following form: 
    // 
    // [ 
    //     { name:  username, value: valueOfUsernameInput }, 
    //     { name:  password, value: valueOfPasswordInput } 
    // ] 
    // 
    // To validate, we can examine the contents of this array to see if the 
    // username and password fields have values.  If either value evaluates 
    // to false then we return false from this method. 

    for (var i=0; i < formData.length; i++) { 
        if (!formData[i].value) { 
            alert('Please enter a value for both Username and Password'); 
            return false; 
        } 
    } 
    alert('Both fields contain values.'); 
}
$('form').ajaxForm( { beforeSubmit: validate } ); 
```

这个例子和更多信息[在这里](http://jquery.malsup.com/form/#validation)。

# javascript - 将 div 元素从一个父 div 移动到另一个

> ID：10905525
> 
> 赞同：6
> 
> 时间：2012-06-05T21:52:09.207
> 
> 标签：javascript, jquery

所以让我们假设我有一组嵌套的 div：

```
<div id="likelyToBeCalled">
    <div id="likelyOddHeader" class="row">
        <div id="likelyOddA" class="left" name="test1">Test1</div>
        <div id="LikelyOddB" class="middle"><img src="image002.png"/></div>
        <div id="timeZone" class="right">West</div>
    </div> 
```

并在页面下方：

```
<div id="unlikelyToBeCalled">
    <div id="likelyOddHeader" class="row">
        <div id="likelyOddA" class="left">Test2</div>
        <div id="LikelyOddB" class="middle"><img src="image002.png"/></div>
        <div id="timeZone" class="right">West</div>
    </div> 
```

我如何将 Test1 移动到“unlikelyToBeCalled”。我一直在尝试使用表单/提交按钮来实现这一点，这是代码：

```
<script type="text/javascript">
    function doSubmit() {
        document.getElementById('unlikelyToBeCalled').appendChild(
            document.getElementsByTagName('Test1')
        );
    }
</script>
<br /><br /><br />
<form method="POST" action="file:///C:/wamp/www/index.html" id="submitform" name="submitform">
    <input type="submit" name="Submit" value="Move divs" onClick="doSubmit()"  />
</form> 
```

或者类似的东西。任何帮助都会动摇

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-05T21:58:20.377

利用`.appendTo()`

```
$('#likelyOddA').appendTo('#unlikelyToBeCalled') 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-05T21:57:05.883

如果我明白你想要什么：

```
$('div[name=test1]').appendTo('#unlikelyToBeCalled'); 
```

`getElementsByTagName('Test1')`不会得到带有 s 的元素`name="Test1"`，例如，它应该得到所有`div`的 s （`getElementsByTagName('div')`当然有代码）。接下来，你已经使用了`#likelyOddHeader`and other`id`两次，但`id`必须是唯一的。

# c++ - 其他类的初始化类 - C++

> ID：10905527
> 
> 赞同：0
> 
> 时间：2012-06-05T21:52:11.477
> 
> 标签：c++, design-patterns

我想初始化注册一些值（A，B）的2个类（比如ARegister类，BRegister类）。我想从一个超级（？）类（比如类RegisterALL）初始化这两个类。

例如：RegisterALL 类将初始化 ARegister 和 BRegister。所以使用该模块的任何人都不需要单独创建 ARegister 和 BRegister 对象，而是可以创建 RegisterALL 对象。

我想在构造函数中完成所有这些注册。因此，需要做的就是创建 RegisterALL 类的对象，并且注册会自动发生。

我们在项目中不使用异常。因此，如果注册中有错误，则无法知道。

我应该有单独的成员函数来进行注册还是让构造函数进行注册。

我是 OO 设计的新手。我觉得设计有问题，如果您能指出正确的方法，将会很有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T01:19:40.607

最好的方法是使用 CRTP（奇怪的循环模板模式），派生类 ARegister 和 BRegister 将自己作为模板参数传递给基类 RegisterALL。它看起来像这样：

```
class RegisterAll
{
public:
    template<class DerivedType>
    DerivedType *createType()
    {
        RegisterAll *r = (*(m_creators[DerivedType::id]))();
        return dynamic_cast<DerivedType *>(r); //static_cast will work too if you didn't make a mistake
    }
protected:
    static std::map<int,RegisterAll *(*)()> m_creators;
};

std::map<int,RegisterAll *(*)()> RegisterAll::m_creators = std::map<int,RegisterAll *(*)()>();

template<class Derived>
class CRTPRegisterAll : public RegisterAll
{
public:
    static bool register() 
    {
        RegisterAll::m_creators.push_back(std::make_pair(Derived::id,Derived::create);
        return true;
    }

private:
    static bool m_temp;
};

template<class Derived>
bool CRTPRegisterAll<Derived>::m_temp = CRTPRegisterAll<Derived>::register();

class RegisterA : public CRTPRegisterAll<RegisterA>
{
private:
    static RegisterA *create() 
    {
        //do all initialization stuff here
        return new RegisterA;
    }

public:
    static const int id = 0;
}; 
```

`m_temp`现在静态变量的初始化`CRTPRegisterAll`将每个派生类型的创建者函数推送到`RegisterAll`的列表中。`RegisterAll`了解所有派生类通常不是很好的设计（它不是很可扩展）。这样就可以在每个派生类中实现实际的创建方法，并且创建者函数会自动注册到`RegisterAll`. CRTP 的主要优点之一是派生类不需要知道如何将自己注册到基类的列表中，它是为它们完成的。至于错误处理，也可以在每个派生类的创建者函数中实现。有更好的方法来处理 id 问题，但我不想在这里讨论。如果您想要一个更简单的方法，我建议您阅读有关工厂设计模式的内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-06T02:42:04.250

看来您已经决定了对象之间的某种关系。但是，你只是模糊地描述了这种关系。

如果`RegisterALL`是使用简单的遏制，那么你将有一个非常简单的关系。这种关系可以这样表达（请原谅 ASCII 图形）：

```
 +-------------+
       | RegisterALL |               --> := has
       +-------------+
          |       |
          v       v
+-----------+   +-----------+
| ARegister |   | BRegister |
+-----------+   +-----------+ 
```

优点是两个家属的照片非常简单。但是，如果您要注册许多对象，则图片开始看起来像是`RegisterALL`爆炸成一堆`XRegister`对象。

如果`RegisterALL`要包含`ARegister`and `BRegister`，您可能希望为 and 创建一个公共基类`ARegister`，`BRegister`以便`RegisterALL`可以维护容器。

```
 +-------------+      +------------------+            <>--> := aggregates
      | RegisterALL |<>--->| AbstractRegister |              
      +-------------+      +------------------+              |
                                    |                      _/_\_ := inherits
                                   / \
                               ___/___\___
                               |         |
                    +-----------+       +-----------+
                    | ARegister |       | BRegister |
                    +-----------+       +-----------+ 
```

我们看到，无论有多少新项目被注册， 和 之间的关系都`RegisterALL`保持`AbstractRegister`不变。我们可以更进一步，从模板中派生`ARegister`和派生。`BRegister`

```
 +-------------+      +------------------+
      | RegisterALL |<>--->| AbstractRegister |
      +-------------+      +------------------+
                                    |
                                   / \
                                  /___\
                                    |
                                    |     +--------------+
                           +--------------| RegisterType |
                           |              +--------------+
                           | RegisterTemplate |
                           +------------------+ 
```

好的，OO 设计课就讲这么多。这可以很快转化为代码。让我们从简单的事情开始。`RegisterType`枚举要注册的不同事物。`RegisterTypeName`并且重载的运算符允许代码在打印时打印字符串而不是数字`RegisterType`。

```
enum RegisterType { A, B, MAX_RegisterType };

static inline std::string
RegisterTypeName (RegisterType t)
{
    static const char * names[] = { "A", "B" };
    return names[t];
}

static inline std::ostream &
operator << (std::ostream &output, RegisterType t)
{
    return output << RegisterTypeName(t);
} 
```

`AbstractRegister`提供查询此类型的接口。此外，`poke`还提供了一个带有默认实现的接口。注意在 C++ 中，抽象类型应该提供一个虚拟析构函数。

```
class AbstractRegister {
public:
    virtual ~AbstractRegister () {}
    virtual RegisterType type () const = 0;
    virtual void poke () { std::cout << "Poked " << type(); }
};

typedef std::unique_ptr<AbstractRegister> AbstractRegisterPtr;
static const AbstractRegisterPtr AbstractRegisterNullPtr; 
```

该类`RegisterALL`有一个容器来保存类型的东西`AbstractRegister`。它使用映射关联`RegisterType`到`AbstractRegister`我们将其作为注册的实例。`RegisterALL`被实现为单例，这意味着它只允许它自己的一个实例。该`add`方法执行注册，并且该`find`方法允许找到已注册的实例。构造函数的实现`RegisterALL`被推迟到 a 的定义之后`RegisterTemplate`。

```
class RegisterALL {
    template <RegisterType> friend class RegisterTemplate;
    typedef std::unique_ptr<RegisterALL> SelfPtr;
    typedef std::map<RegisterType, AbstractRegisterPtr> RegisterMap;
    void add (AbstractRegister *r) { all[r->type()] = AbstractRegisterPtr(r); }
    RegisterALL ();
public:
    static const SelfPtr & instance () {
        if (!one) new RegisterALL;
        return one;
    }
    const AbstractRegisterPtr & find (RegisterType t) const {
        RegisterMap::const_iterator i = all.find(t);
        return (i != all.end()) ? i->second : AbstractRegisterNullPtr;
    }
private:
    static SelfPtr one;
    RegisterMap all;
};

RegisterALL::SelfPtr RegisterALL::one; 
```

该类`RegisterTemplate`派生自`AbstractRegister`并由 a 参数化`RegisterType`。它`type`通过返回其模板参数的值来实现虚方法。它也使用单例，但不公开其实例。相反，它的实例由`RegisterALL`. 它提供了向`register_type`注册自己的方法`RegisterALL`，而这个实例只能通过`find`on 的方法找到`RegisterALL`。

```
template <RegisterType RT>
class RegisterTemplate : public AbstractRegister {
    RegisterType type () const { return RT; }
    void poke () {
        std::cout << "Poked " << RegisterTypeName(RT) << std::endl;
    }
    RegisterTemplate () {
        std::cout << "Created " << RegisterTypeName(RT) << std::endl;
    }
    ~RegisterTemplate () {
        std::cout << "Destroying " << RegisterTypeName(RT) << std::endl;
    }
public:
    static void register_type () {
        if (RegisterALL::instance()->find(RT)) {
            std::cout << "Already registered " << RegisterTypeName(RT)
                      << std::endl;
            return;
        }
        RegisterALL::instance()->add(new RegisterTemplate<RT>);
    }
}; 
```

构造函数使用遍历枚举的`RegisterALL`辅助模板，并实例化相应的，从而使所有的 都注册到。`register_all``RegisterType``RegisterTemplate``RegisterType``RegisterALL`

```
template <unsigned X>
struct register_all {
    register_all () {
        RegisterTemplate<static_cast<RegisterType>(X)>::register_type();
        register_all<X+1>();
    }
};

template <> struct register_all<MAX_RegisterType> {};

inline RegisterALL::RegisterALL ()
{
    one = std::move(SelfPtr(this));
    register_all<0>();
} 
```

因此，为了尝试一下，我们使用以下代码：

```
RegisterALL::instance();                  // registers all RegisterType's
RegisterTemplate<B>::register_type();     // try to register B again
RegisterALL::instance()->find(A)->poke(); // poke at A 
```

这是输出：

```
Created A
Created B
Already registered B
Poked A
Destroying B
Destroying A 
```

请注意智能指针如何为我们自动清理已注册的项目。

# c# - 在 Windows 8 Metro App 中基于 WebViewBrush 获取 Stream

> ID：10905531
> 
> 赞同：1
> 
> 时间：2012-06-05T21:52:18.707
> 
> 标签：c#, windows-8, windows-runtime, brush

使用`WebViewBrush`我可以将网页内容（它的屏幕截图）呈现给例如`Rectangle`元素。如何将该屏幕截图（画笔）转换为`Stream`以便我可以将其保存在磁盘上或通过网络发送？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T09:08:07.517

不确定它是否会起作用，但也许您可以尝试 WriteableBitmapEx：[http](http://writeablebitmapex.codeplex.com/) ://writeablebitmapex.codeplex.com/ ？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T19:40:06.007

似乎还不支持：[http ://social.msdn.microsoft.com/Forums/no/winappswithcsharp/thread/dd66c749-efed-4b55-a716-e0aa3a637d28](http://social.msdn.microsoft.com/Forums/no/winappswithcsharp/thread/dd66c749-efed-4b55-a716-e0aa3a637d28)

# mercurial - 在 Mercurial 中列出传入的分支

> ID：10905533
> 
> 赞同：2
> 
> 时间：2012-06-05T21:52:34.783
> 
> 标签：mercurial, pull

我碰巧在一个有很多命名分支的服务器存储库中工作。我通常只提取我目前正在处理的分支，以使我的本地存储库不那么混乱。

有时，我想找出服务器存储库中的哪些分支有我可以提取的任何新变更集。

有什么办法可以列出分支名称或分支负责人？与以下相反的东西：

```
$ hg log -r "outgoing() and head()" 
```

当然，我可以按照以下方式做一些事情：

```
$ hg incoming | grep branch | uniq 
```

但我很乐意找到更多 Mercurial-native 和跨平台解决方案（我在 Windows 上工作）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T18:17:49.120

暂时，我决定坚持下去`grep`。我将此添加到我的`hgrc`：

```
[alias]
remote = !hg incoming | grep branch | sort | uniq 
```

在 Windows 上，我使用`grep`并`uniq`在[UnxUtils](http://unxutils.sourceforge.net/)中找到。

示例输出如下所示：

```
D:\Projects\MyProject>hg remote
branch:      1.4-stable
branch:      next-major
branch:      ticket-199
branch:      ticket-90 
```

不幸的是，这个命令仍然列出了所有的变更集，所以运行它可能需要一些时间。

# dns - 使用 4G 提供冗余

> ID：10905544
> 
> 赞同：1
> 
> 时间：2012-06-05T21:53:31.587
> 
> 标签：dns, load-balancing, redundancy, 4g

我有一个在小办公室运行的网站。DNS 名称由 Network Solutions 管理。我希望该站点始终可用，因此我正在考虑购买一个备用 4G 无线 WAN 适配器。

如果我的主要 DSL 线路出现故障，我希望将所有流量转发到与 4G 连接关联的 IP 地址。有什么方法可以设置“全局”或“虚拟 IP”，如果主 IP 启动，则将流量重定向到我的主 IP，如果主 IP 关闭，则将流量重定向到我的备用 IP？是否有提供此类服务的组织？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T22:22:00.597

您可以使用支持故障转移配置的网络硬件来执行此操作。

您可以设置某种脚本来 ping 您的路由器并在您的主连接断开时更新 DNS 条目。

我认为最好的答案-您可以每月支付几美元，然后将您的网站转移到您根本不必担心这一点的网络主机上。

但是，这可能是更适合 StackExchange 提供的服务器管理/网络站点的问题。

# java - Java 序列化对象的传输

> ID：10905546
> 
> 赞同：1
> 
> 时间：2012-06-05T21:53:33.997
> 
> 标签：java, serialization, data-structures, software-distribution

是否可以在一个 Java 程序/类中声明一个可序列化对象的实例，然后在另一个程序/类中完全重复内部对象的定义，并从数据文件中加载一个大的复杂对象？目标是能够为本地保存在我的构建机器上的项目编写编辑器，然后编写游戏本身并将其分发给想要玩游戏的人。

我正在用 Java 编写一个游戏作为一个业余爱好者项目。在我的游戏中，有一系列类扩展了父类 GameItem。物品可能属于不同的系列，如 HealingPotion、Bomb、KeyItem 等。

```
class GameItem implements Serializable {
String ItemName
String ImageResourceLocation
....} 
```

我想要做的是包括如何在一个特定的项目系列中创建每个项目的定义，然后有一个名为 GameItemList 的大类，它包含在你玩游戏时可能出现的所有可能的项目。

```
class GameItemList implements Serializable {
LinkedList<GameItem>gameItemList;
//methods here like LookUpByName, LookUpByIndex that return references to an item
} 
```

也许在某个时候——当玩家开始一个新游戏时，或者当游戏启动时，做一些类似的事情：

```
//create itemList
FileInputStream fileIn = new FileInputStream("items.dat");
ObjectInputStream in = new ObjectInputStream(fileIn);
GameItemList allItems = (GameItemList)in.readObject();
in.close();
//Now I have an object called allItems that can be used for lookups. 
```

谢谢大家，任何意见或帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T21:59:06.160

序列化对象时，对象的每个字段都会被序列化，除非用`transient`. 而且这种行为当然是递归的。所以是的，你可以序列化一个对象，然后反序列化它，反序列化的对象将与序列化的对象具有相同的状态。不同的行为会使序列化变得无用。

不过，我不会使用本机序列化来长期存储数据。序列化的对象很难检查，无法使用文本编辑器进行修改，并且很难与旧版本的类保持向后兼容性。我会使用更开放的格式，例如 XML 或 JSON。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T22:14:35.193

这将起作用，但是 Java 序列化因难以“进化”类而臭名昭著——内部表示明确地与磁盘格式相关联。您可以使用自定义读取器/写入器方法解决此问题，但您可能会考虑使用更便携的格式，例如 JSON 或 XML，而不是对象序列化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T22:02:05.053

是的，这是可能的。如果一个对象被正确序列化，它可以在任何其他机器上反序列化，只要运行在那里的应用程序知道要反序列化的类的定义。

# java - java正则表达式：单词字符和空格

> ID：10905547
> 
> 赞同：0
> 
> 时间：2012-06-05T21:53:34.813
> 
> 标签：java, regex

我想结合`\w`和`\s`类。所以输入应该只包含字母、数字和空格。

我已经尝试过“ `[\\w\\s]`”和“ `\\w\\s`”等。但它们不起作用。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T22:16:29.507

你需要`(?U)[\p{alnum}\s]`, 在 Java 7 下。否则这两个集合都会出错，因为它只能在 ASCII 上工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T22:12:26.147

尝试这个：

```
^[\w\s&&[^_]]+$ 
```

`\w`除了字母和数字，还包括下划线。如果不想要，你需要做减法。

*   对于`abc abc 123`：是
*   对于`abc_abc 123`：否

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T21:55:00.650

试着把`(\\w|\\s)`它结合起来。这意味着`\\w` `OR` `\\s`，但对我来说

```
 System.out.println("abc def ghi".replaceAll("[\\w\\s]", "X"));
    //out ->            XXXXXXXXXXX 
```

工作正常

# c# - 如何转换一个json字符串？

> ID：10905549
> 
> 赞同：0
> 
> 时间：2012-06-05T21:53:44.503
> 
> 标签：c#, json, string, javascriptserializer

似乎无法让这个工作。我有这个 json 字符串，我想将它转换为 C# 对象：

> {"name":"mousePos","args":[{"mouseDet":{"rid":"1","posx":1277,"posy":275}}]}

我一直在努力`JavaScriptSerializer`，但我没有运气。我不确定如何获取 posx 和 posy 的值。谁能建议我如何做到这一点？谢谢您的帮助。

编辑：

```
public class JsonData
{
    public string name { get; set; }
}
public Form1()
{
    // ---- Other stuff here ----

    string json = data.MessageText; // The json string.

    JavaScriptSerializer ser = new JavaScriptSerializer();
    JsonData foo = ser.Deserialize<JsonData>(json);

    MessageBox.Show(foo.name); // Shows 'mousePos'
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T21:56:11.233

我把它放到[JsonLint 中](http://jsonlint.com/)并得到一个错误。其无效的 JSON

```
{
    "name": "mousePos",
    "args": [
        "mouseDet": {
            "rid": "1",
            "posx": 1277,
            "posy": 275
        }
    }    //-- THIS should not be here.
]
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T21:59:50.433

JSON 无效的原因是您的“args”属性包含方括号内的键/值对，这不是有效的数组。我猜它应该是这样的：

```
{
    "name":"mousePos",
    "args":[{"mouseDet":{"rid":"1","posx":1277,"posy":275}}]
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-10T23:34:31.937

您只需要稍微扩展您的对象模型即可覆盖它。根据您在示例中的内容，它将类似于：

```
public class JsonData
{
    public string name { get; set; }
    public Arguments[] args { get; set; }
}

public class Arguments
{
    public MouseDet mouseDet { get; set; }
}

public class MouseDet
{
    public int rid { get; set; }
    public int posx { get; set; }
    public int posy { get; set; }
}

...

var posx = foo.args[0].mouseDet.posx; 
```

# knockout.js - knockout.mapping、IE9 和序列化

> ID：10905551
> 
> 赞同：0
> 
> 时间：2012-06-05T21:54:12.670
> 
> 标签：knockout.js, knockout-mapping-plugin

在 IE9 中使用敲除 (2.1.0) 和敲除映射 (2.1.2) 出现了一些谜团。由于某种原因，对象的数组索引变成了父对象。例如：

```
ko.mapping.toJSON(attachments); 
```

在 Chrome 中生成如下所示的内容：

```
{
    "UserID": 432,
    "Attachments": [{
        "AttachmentID": 2,
        "OwnerID": 321,
        "DisplayName": "sample.pdf",
        "Description": "desc",
        "PostDate": "2012-06-01T09:24:43.817"
        }, {
        "AttachmentID": 3,
        "OwnerID": 432,
        "DisplayName": "sample3.pdf",
        "Description": "desc",
        "PostDate": "2012-06-05T14:01:00.693"
        }, {
        "AttachmentID": 4,
        "OwnerID": 543,
        "DisplayName": "sample2.pdf",
        "Description": "desc",
        "PostDate": "2012-06-05T14:01:49.18"
        }]
} 
```

...但在 IE9 中，会产生如下内容：

```
{
    "UserID": 432,
    "Attachments": {
    "0": {
        "AttachmentID": 2,
        "OwnerID": 321,
        "DisplayName": "sample.pdf",
        "Description": "desc",
        "PostDate": "2012-06-01T09:24:43.817"
    },
    "1": {
        "AttachmentID": 3,
        "OwnerID": 432,
        "DisplayName": "sample3.pdf",
        "Description": "desc",
        "PostDate": "2012-06-05T14:01:00.693"
    },
    "2": {
        "AttachmentID": 4,
        "OwnerID": 543,
        "DisplayName": "sample2.pdf",
        "Description": "desc",
        "PostDate": "2012-06-05T14:01:49.18"
    }
    }
} 
```

这打破了我的淘汰赛绑定，因为模板期望附件是一阶数组。

有趣的是，json2 的 stringify 在我尝试过的每个浏览器中都会返回第一个输出（这是我所期望的）。

有没有人见过这种行为？关于如何纠正它的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T23:33:42.943

简短的版本是我没有找到问题的答案，但我确实找到了解决方法。它不漂亮。如果我覆盖 JSON 对象并强制它使用 JSON3 using `delete window.JSON;`，然后像这样执行一些字符串化恶作剧：

```
var jsonString = JSON.stringify(objToBind);
var reconstitutedObject = ko.utils.parseJson(jsonString); 
```

...从重构的对象创建映射并绑定到重构的对象，额外的容器似乎消失了。这向我表明，数组定义中有一些额外的东西被解释为一个容器，但是在探索了主项目的核心、嗅探网络流量并试图深入了解服务器如何响应之后，我米来短。

# c++ - 对 wxWidgets 类的大量未定义引用

> ID：10905555
> 
> 赞同：0
> 
> 时间：2012-06-05T21:54:26.640
> 
> 标签：c++, linker, wxwidgets

当我编译我的 wxWidgets 项目时，我收到很多错误，说明类似于：

`undefined reference to _imp___ZN16wxEventHashTableD1EV`

其中有 50 多个，当我尝试将 wxwidgets 静态链接到 exe 时，它​​才开始发生。我在windows下使用wxPack。当我动态链接 wxWidgets 时，这些错误没有出现。有谁知道这里发生了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T22:22:12.367

*imp* * 前缀意味着您仍然将链接器指向与动态 wxWidgets 构建一起导入的库。(.dll 文件位于 lib/gcc_dll/*)

确保您也静态构建了 wxWidgets，然后将链接器指向正确的位置。正确的文件应该在：lib/gcc_lib/*

# ruby-on-rails - 从“Git init 文件夹”恢复删除

> ID：10905558
> 
> 赞同：0
> 
> 时间：2012-06-05T21:54:31.197
> 
> 标签：ruby-on-rails, git, init

我有一个带有 ROR 代码的文件夹，让我们在主文件夹下将其称为“子文件夹”，将其称为“主文件夹”我犯了一个错误并从“主文件夹”运行“git init 子文件夹”该命令删除了除 tmp 之外的大部分代码，记录并清空应用程序目录

我进一步从子文件夹中的 git 远程提取，而没有意识到文件已被删除

然后触摸自述文件

然后加 。然后 commit -m "first commit" 那是我收到文件时的消息

master 34f2e90] 第一次提交 42 个文件更改，84328 插入（+）创建模式 100644 README 创建模式 100644 log/development.log 创建模式 100644 tmp/cache/assets/C7A/6A0/sprockets%2F442a717507a3dde80b7d59671208324c 创建模式 1006/4 /C9F/560/sprockets%2F8e5a9738e9bc15478e026d98335454f9 创建模式 100644 tmp/cache/assets/CBF/380/sprockets%2F4f4c8476962893413bc​​66624ebedc372

然后

git push 起源大师

计数对象：127，完成。Delta 压缩最多使用 2 个线程。压缩对象：100% (85/85)，完成。写入对象：100% (126/126)，389.53 KiB，完成。总计 126（增量 14），重复使用 0（增量 0）

有什么办法可以恢复那些被删除的文件？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T21:57:31.437

Git init 不会删除文件。它只添加了一个 .git 目录。

您一定是不小心运行了另一个命令来删除这些文件。您能否针对围绕此事件的命令显示您的 shell“历史”命令的输出？

# asp.net-mvc-3 - EF 迁移更新数据库：指定脚本名称

> ID：10905559
> 
> 赞同：1
> 
> 时间：2012-06-05T21:54:50.393
> 
> 标签：asp.net-mvc-3, ef-code-first, entity-framework-migrations, sql-scripts

在 EF Code First 中应用迁移之前，您可以要求查看它打算应用的 SQL 脚本：

```
PM> update-database -script 
```

不幸的是，这会在 Visual Studio 中打开一个名为 tmp939D.sql 的脚本，然后冻结 IDE，直到它完成脚本的生成。如果脚本很长，这是一个长时间的冻结。有没有办法将它推送到硬盘驱动器上的文件而不是 IDE 中？一种指定它生成的 SQL 脚本文件名称的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T15:12:42.393

请参阅此答案以获取解决方案：[https ://stackoverflow.com/a/14339379/219187](https://stackoverflow.com/a/14339379/219187)

此解决方案不使用 -Script，而是采用 C# 方法。我们在单元测试中实现了它，因此我们的构建服务器在每次软件更改后生成 SQL 脚本。

# ruby - 如何在 ruby webdriver 中使用等待警报

> ID：10905560
> 
> 赞同：0
> 
> 时间：2012-06-05T21:54:58.700
> 
> 标签：ruby, selenium, webdriver

所以我想`wait`直到显示一个警报，然后通常`switch`的警报和`get text`

Selenium 2 (WebDriver)提供了 Java 中的解决方案 [：在调用 Alert.getText() 之前检查文本是否存在](https://stackoverflow.com/questions/6751433/selenium-2-webdriver-check-that-text-exists-before-calling-alert-gettext)

目前我使用`sleep`，但每个人都知道这有多糟糕。

这就是我所拥有的 -

```
sleep 3
a = $driver.switch_to.alert
begin
  a.text == 'Your alert here.'
rescue
  verify { assert_match "true","false","The alert failed to be displayed"}
end
a.accept 
```

我正在寻找类似的东西

```
$wait.until { a = $driver.switch_to.alert }
begin
  a.text == 'Your alert here.'
rescue
  verify { assert_match "true","false","The alert failed to be displayed"}
end
a.accept 
```

但这不起作用，它基本上忽略了等待（顺便说一句，我有 30 秒的等待时间）。正如我所提到的，我需要知道如何在**`RUBY - Test Unit`**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T11:49:13.433

没有等待警报出现的方法。但是您可以使用下面的代码等到警报出现。一旦警报出现，它将退出循环。

```
status=true
while (status)
alert = driver.switch_to.alert rescue "exception happened"
if (alert == "exception happened")
status = true
alert = "nothing happened"
else
status = false
end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T22:11:54.417

如果你使用 watir 和 watir-webdriver 你可以做类似 $browser.wait_unitil_present

# javascript - 从 JSON 中解析一个数组，其中每个字段键都是一个数字

> ID：10905563
> 
> 赞同：1
> 
> 时间：2012-06-05T21:55:22.380
> 
> 标签：javascript, arrays, json

我基本上需要做的是，给定一个像

```
{
  "1" : "a",
  "7" : "something"
  "3" : {
      "1" : "blah"
  }
} 
```

将这些转换为数组（比如 x）。

```
x[1] = "a"
x[7] = "something"
x[3] = y (where y[1] = "blah") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T22:23:19.727

这对我有用：

```
var obj = JSON.parse('{"1":"a","7":"something","3":{"1":"blah"}}');
var keys = Object.keys(obj).sort();

// Make obj look like it's an array by taking the highest value
// key and using it to give obj a length property.
obj.length = parseInt( keys[keys.length] ) + 1;

var arr = Array.prototype.slice.call(obj, 0); 
```

arr 现在看起来像这样：

```
[undefined, "a", undefined, Object, undefined, undefined, undefined, "something"] 
```

好的，所以它没有将“内部”JSON 对象转换为数组，但是执行与上述相同操作的快速递归循环应该可以解决这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T22:00:53.527

您需要将 JSON 反序列化为非数组对象图，然后将属性复制到数组中。我不知道它有什么捷径。

将 JSON 反序列化后的基本循环`obj`大致是：

```
var ar;
var key;

ar = [];
for (key in obj) {
    if (obj.hasOwnProperty(key)) {
        ar[key] = obj[key];
    }
} 
```

...除了你必须检测到它`obj[key]`是一个对象并递归，我将把它作为练习留给读者。

* * *

请注意，在 JavaScript 中，[数组并不是真正的数组](http://blog.niftysnippets.org/2011/01/myth-of-arrays.html)。根据您的用例，您可能根本不需要进行从对象到的转换`Array`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T22:04:28.973

我很确定在 Javascript 中，您可以访问：

```
x = {
  "1" : "a",
  "7" : "something",
  "3" : {
      "1" : "blah"
  }
} 
```

像这样：

```
alert( x["1"] ); 
```

这应该提醒“a”。正如人们在上面的评论中已经提到的那样，JS 中的数组已经是一个“对象”，这两种不同的方式访问它们没有区别。

编辑：

是的，我刚刚测试过它并且它有效。另外，我试过这个：

```
alert( x[1] ); 
```

也就是说，我尝试使用“数字”1，而不是“字符串”“1”。它仍然有效。是的，它是一种非常奇怪的编程语言。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T22:19:04.403

我认为这非常接近：

```
function parse_obj(obj)
{
    var array = [];
    var prop;
    for (prop in obj)
    {
        if (obj.hasOwnProperty(prop))
        {
            var key = parseInt(prop, 10);
            var value = obj[prop];
            if (typeof value === "object")
            {
                value = parse_obj(value);
            }
            array[key] = value;
        }
    }
    return array;
} 
```

[http://jsfiddle.net/shaggyfrog/DFnnm/](http://jsfiddle.net/shaggyfrog/DFnnm/)

# linux - Linux 下 Haskell 的图形化 shell

> ID：10905566
> 
> 赞同：4
> 
> 时间：2012-06-05T21:55:36.687
> 
> 标签：linux, shell, haskell, user-interface

Haskell 和 Linux 是否有一些图形 shell，例如 ghci？我知道 Winghci，它是非常好的解释器，但它只是 Windows。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T10:29:32.743

关于“WinGHCi 做了哪些 GHCi 没有做的事情？”：

*   命令提示符、用户输入和程序输出是不同的颜色。当您滚动浏览大量文本以查找您键入的最后一个命令时，我无法*告诉您这有多大帮助。*我希望更多的 Haskell 程序能够产生彩色输出......

*   您可以使用实际的 GUI 加载文件，而不必记住 200 英里长的文件路径。

*   它有一大堆用于常见操作的按钮和菜单项，如果您是 GHCi 新手并且不知道相应的命令名称，这可能会很有用。

*   在 Windows 上，终端窗口看起来非常*丑陋*，而 WinGHCi 则不然。Linux 上是否存在这个问题是一个见仁见智的问题。

关于提出的*实际问题*：我不知道 Linux 上有任何用于 GHCi 的好的 GUI 工具。可能你能做的最好的就是使用 Emacs 操作系统。我敢*肯定*，现在有人会为此建立某种 GHCi 支持......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T23:02:02.567

ghci 在 Linux 上运行良好，虽然我不知道它的任何图形版本。

如果您想要更多功能，有几个选项：

1.  使用功能强大的终端模拟器
2.  使用“Emacs Haskell Mode”或“SHIM for Vim”将 ghci 集成到您的编辑器中

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T22:04:16.870

你听说过拥抱吗？我只将它用于 Windows，但在[网站上](http://cvs.haskell.org/Hugs/pages/downloading.htm)您也可以为某些 Linux 发行版下载它。自从我使用它以来已经很久了，但据我所知，它是一个易于使用但功能强大且记录良好的解释器。

希望这可以帮助

# spring - 如何关闭 Spring 3 调试日志记录？

> ID：10905578
> 
> 赞同：8
> 
> 时间：2012-06-05T21:56:31.583
> 
> 标签：spring, log4j

我想关闭 Spring 3.1 的 log4j 日志记录，同时为我自己的代码进行调试。

我尝试将此行粘贴到我的 log4j.properties 中：

```
log4j.category.org.springframework = WARN 
```

要得到这个：

```
# Root Logger Setup:  Includes the level of reporting and appenders -> where
#                     log messages get sent                                              
log4j.rootLogger                            = DEBUG,ca,fa

log4j.category.org.springframework = WARN

#ca - Console Appender - Send messages to the console
log4j.appender.ca                          = org.apache.log4j.ConsoleAppender
log4j.appender.ca.layout                   = org.apache.log4j.PatternLayout
log4j.appender.ca.layout.ConversionPattern = [acme]: [%-5p] - %d{yyyy-MMM-dd HH:mm:ss} -  %c{1}:%M(): %m%n

#fa - File Appender - Send messages to a log file
log4j.appender.fa                            = org.apache.log4j.RollingFileAppender
log4j.appender.fa.File                       = acme.log
log4j.appender.fa.MaxFileSize                = 100KB
log4j.appender.fa.MaxBackupIndex             = 10
log4j.appender.fa.Threshold                  = DEBUG
log4j.appender.fa.layout                     = org.apache.log4j.PatternLayout
log4j.appender.fa.layout.ConversionPattern   = [%-5p] - %d{yyyy-MMM-dd HH:mm:ss} -  %c{2}:%M(): %m%n 
```

不过，关闭 Spring 的调试输出并不走运。

提前感谢您的帮助

史蒂夫

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-06T16:19:43.567

您的所有依赖项都到位了吗？

> 1.3.2.3 使用 Log4J
> 
> 许多人使用 Log4j 作为日志框架来进行配置和管理。它高效且成熟，事实上它是我们在构建和测试 Spring 时在运行时使用的。Spring 还提供了一些用于配置和初始化 Log4j 的实用程序，因此它在某些模块中对 Log4j 具有可选的编译时依赖项。
> 
> 要使 Log4j 使用默认的 JCL 依赖项（commons-logging），您只需将 Log4j 放在类路径中，并为其提供配置文件（类路径根目录中的 log4j.properties 或 log4j.xml）。所以对于 Maven 用户来说，这是你的依赖声明：

```
<dependencies>
   <dependency>
      <groupId>org.springframework</groupId>
      <artifactId>spring-context</artifactId>
      <version>3.0.0.RELEASE</version>
      <scope>runtime</scope>
   </dependency>
   <dependency>
      <groupId>log4j</groupId>
      <artifactId>log4j</artifactId>
      <version>1.2.14</version>
      <scope>runtime</scope>
   </dependency>
</dependencies> 
```

> 这是用于登录控制台的示例 log4j.properties：

```
log4j.rootCategory=INFO, stdout

log4j.appender.stdout=org.apache.log4j.ConsoleAppender
log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
log4j.appender.stdout.layout.ConversionPattern=%d{ABSOLUTE} %5p %t %c{2}:%L - %m%n

log4j.category.org.springframework.beans.factory=DEBUG 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T16:47:29.480

我想通了。

在我的类路径中，我有一个目录 C:\Classes 以方便我在试验时使用。我在那里有另一个 log4.properties 文件，它取代了打包在我的 WAR 中的文件，使它看起来下面的技术不起作用。我在 C:\Classes 中重命名了 log4.properties，一切都很好。

感谢所有看过的人，也感谢 Spring Source 的人们让这样做变得必要。很高兴知道，当我需要它时，我可以轻松地进行广泛的调试，而不仅仅是获得一个黑匣子。

# csv - 导出 CSV 正确打开 Office（将数字另存为 TEXT）

> ID：10905588
> 
> 赞同：13
> 
> 时间：2012-06-05T21:57:31.333
> 
> 标签：csv, numbers, delimiter, openoffice-calc, magmi

我正在使用 OPEN-OFFICE 工作并保存 CSV。我也使用逗号分隔符和'"'。但是，在保存 CSV 时，所有数字都没有被封装。如何强制 Open-Office 将数字视为文本并将它们也封装起来。示例：

```
"store","website","attribute_set","type","sku","name","price","categories","description","qty","sizet","is_in_stock","status","visibility","tax_class_id"
"admin","base","test","simple","T010013-012","Test12","12","test/test","Desc12",12,"S","1","Enabled","Catalog, Search","Taxable Goods"
"admin","base","test","simple","T010013-013","Test13","13","test/test","Desc13",13,"M","1","Enabled","Catalog, Search","Taxable Goods"
"admin","base","test","simple","T010013-014","Test14","14","test/test","Desc14",14,"L","1","Enabled","Catalog, Search","Taxable Goods"
"admin","base","test","simple","T010013-015","Test15","15","test/test","Desc15",15,"XL","1","Enabled","Catalog, Search","Taxable Goods"
"admin","base","test","simple","T010013-016","Test16","16","test/test","Desc16",16,"XXL","1","Enabled","Catalog, Search","Taxable Goods"
"admin","base","test","configurable","T010013","TestParent","5","test/test","DescParent","30","","1","Enabled","Catalog, Search","Taxable Goods" 
```

感谢您的帮助。PS：我正在为 Magento 使用 MAGMI 脚本。上传产品

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-06-06T11:18:22.623

这需要两个步骤：

1.  将包含数字的单元格格式化为文本（因为整个列都需要该格式，只需将该格式应用于整个列，因此如果添加行，则无需格式化每个新单元格）；

2.  修改导出过滤器设置以引用所有文本单元格：

![编辑过滤器设置](../Images/7d5afa143511000da9767989ee5efb12.png)

![引用所有文本单元格](../Images/e5f0a1626f313d9acf0dd571f44c689d.png)

使用此设置，Calc 应保存此工作表：

![床单](../Images/68cd12af695c69c5c1e6f6641c9b0cef.png)

如下：

```
"bar","42"
"foo","57" 
```

顺便说一句，Calc 完全符合标准，默认情况下**不会**引用每个数字。至少，[RFC 4180](https://www.rfc-editor.org/rfc/rfc4180#page-3)不需要引用每个字段。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-31T19:39:47.360

使用正确的 SQL 导入语法有一种更简单的方法来回避这个问题。考虑以下：

```
LOAD DATA LOCAL INFILE '/yourfile.csv' 
INTO TABLE yourtable  
FIELDS TERMINATED BY ',' 
OPTIONALLY ENCLOSED BY '"'; 
```

OPTIONALLY ENCLOSED BY '"' 行应该解决数字行的问题，而不必花时间弄乱从 Open/LibreOffice 等辅助应用程序导出时 CSV 的格式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-31T21:22:44.540

为此编写了一个小红宝石脚本，而不是尝试在 OpenOffice 或 Excel 中找到选项。还是找不到他们。

```
require 'csv'

rows = CSV.open(ARGV[0]).readlines
CSV.open("#{ARGV[0].split('.')[0]}_qgisfriendly.csv", "w", {:force_quotes => true}) do |csv|
  rows.each do |row|
    csv << row
  end
end 
```

# batch-file - 将标准输出重定向到屏幕和文本文件

> ID：10905591
> 
> 赞同：2
> 
> 时间：2012-06-05T21:58:00.100
> 
> 标签：batch-file, windows-server-2008, dos

我正在编写一个dos批处理脚本，我想做的一件事是将命令行重定向到标准输出和文本文件。我可以做任何一个，但不能两者兼而有之。另外，我不能用另一个批处理脚本调用它或在命令行调用它。

我要执行的命令是`reg add "%regKey%" /f` ，输出是`The operation completed sucessfully.`，我希望它显示在标准输出上并附加到文本文件中。

到目前为止，我已经尝试过：

`reg add "%regKey%" /f>>%logfile%>CON`<-- 仅附加到文本文件

`reg add "%regKey%" /f>CON>>%logfile%`<-- 只在标准输出中显示

我看到了这个[SO](https://stackoverflow.com/questions/7372993/redirect-to-both-screen-and-pipe)，但它是用于 bash 的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T22:15:41.777

```
reg add "%regKey%" /f>>%logfile%
type %logfile% 
```

对于您自己以及其他任何会来看您的脚本的人来说，这更容易理解。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T22:53:16.327

我解决了。这是魔术，虽然性能不是那么好，并且它不适用于某些事情：

```
@echo off
SETLOCAL ENABLEDELAYEDEXPANSION
set logfile=test.out
echo. 2>%logfile% 
set /A count=0
set /A lastline=0
:loop
if not %count%==100 (
  set /A count += 1
  SET PR >> %logfile%
  CALL :printlog
  goto :loop
)
goto :pause
:printlog
SET incount=0
FOR /F "delims=" %%M in (%logfile%) DO (
    set /A incount +=1
    if %incount% GEQ %lastline% (
      ECHO %%M
      SET /A lastline=%incount%
    )
)
ECHO -
EXIT /B 0
:pause
pause 
```

# linux - mmap 搞砸了 - 导致内核挂起

> ID：10905593
> 
> 赞同：2
> 
> 时间：2012-06-05T21:58:11.827
> 
> 标签：linux, kernel, mmap

我正在为使用 Microblaze 作为处理器的嵌入式板构建应用程序。我为此进行了 Linux 交叉编译。主板有 512 MB 内存，但内核只知道其中的 256 MB（DDR3 的下半部分）。

这是系统的内存映射：

```
0x4000_0000 to 0x5FFF_FFFF -> Physical range of DDR3 (verified with cat /proc/meminfo)
0x4000_0000 to 0x4FFF_FFFF -> Known to linux and used by the kernel
0x5000_0000 to 0x5FFF_FFFF -> Mmaped using "/dev/mem" for my application 
```

我必须直接访问 DDR 中的一个区域，特别是 DDR 的第二半。所以我写了一个应用程序，mmap的物理内存是这样的：

```
typedef struct 
{
  int fd;                      // File descriptor
  unsigned long *hw_addr;      // Hardware base address
  unsigned long *vaddr;        // Virtual address pointer
  unsigned long memsize;       // Size of physical region
  off_t page_offset;
  off_t page_address;
  off_t page_size;
} mem_region_t ;

mem->vaddr = (unsigned long *) mmap(0, 
                  mem->memsize, 
                  PROT_READ|PROT_WRITE, 
                  MAP_SHARED, 
                  mem->fd, 
                  mem->page_address); 
```

为了测试工作，我对请求的区域进行了简单的内存测试（memtest）。

以下是我注意到的一些问题：

1.  我可以分配任意数量的内存并对其进行映射，没有问题。当我为 memtest 使用一个 0x100 字节的小区域时，测试成功运行。

2.  当我分配更大的区域（0x1000、0x1_0000 等）时，内核不会出现段错误，它会挂起！这种行为正常吗？

你能建议解决这个问题的方法吗？我什至正确地映射它。

我的怀疑是任何小于一页内存的东西都可以工作，而更多的东西会严重搞砸。我需要在内核中启用某个功能吗？

感谢您的关注。如果您需要更多信息，请告诉我。

RRS

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T15:51:46.357

好的......所以我解决了这个问题。

我看到内核没有足够的页面供我工作。所以我使用“memmap”创建了一个禁区（参见内核参数）。这让我可以使用上面提到的 mmap。

它似乎适用于连续物理内存的大量分配。

# c# - 用户在搜索字段中输入时如何显示搜索词

> ID：10905595
> 
> 赞同：1
> 
> 时间：2012-06-05T21:58:27.497
> 
> 标签：c#, asp.net, html

我正在为学生创建一个搜索工具，他们可以根据他们在搜索字段中输入的内容查找课程。

例如。假设我在“课程”表中存储了以下值：

1.  数学 - 微积分我
2.  数学 - 微积分 II
3.  数学 - 概率
4.  数学 - 微分方程
5.  数学 - 随机
6.  科学 - 物理
7.  科学 - 生物学
8.  科学 - 化学

因此，只要任何学生开始在搜索字段中输入内容，我就想显示他们可能正在寻找的可能搜索项的列表（例如 Google）。因此，如果他们输入“Mat”，我想在搜索字段正下方显示包含“Mat”的所有文本的列表 - 同样，类似于谷歌在搜索字段下方显示列表的方式。

我怎样才能做到这一点？

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T22:00:20.030

听起来您正在寻找可以放在客户端的代码。查看[jQuery 自动完成功能](http://jqueryui.com/demos/autocomplete/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T22:09:37.117

Microsoft 发布的 AJAX 控件工具包包含一个名为 AutoCompleteExtender 的控件，供个人使用，它正是您想要的，它速度很快，而且不需要大量设置。

这是工具包的基本信息页面：[http ://www.asp.net/web-forms/tutorials/ajax-control-toolkit/getting-started/get-started-with-the-ajax-control-toolkit-cs](http://www.asp.net/web-forms/tutorials/ajax-control-toolkit/getting-started/get-started-with-the-ajax-control-toolkit-cs)

这是专门针对 AutoCompleteExtender 的操作方法： [http ://www.ajaxtutorials.com/ajax-tutorials/using-autocomplete-in-the-ajax-toolkit/](http://www.ajaxtutorials.com/ajax-tutorials/using-autocomplete-in-the-ajax-toolkit/)

# sql-server-2008 - 获取最后插入记录的 ID - Access DAO、ODBC、SQL Server 2008 身份字段

> ID：10905596
> 
> 赞同：3
> 
> 时间：2012-06-05T21:58:45.753
> 
> 标签：sql-server-2008, ms-access, vba, odbc

这是一个非常常见的问题，但我无法获取最后插入的记录的 ID。我正在使用带有 ODBC 链接表的 DAO 来复制一条记录，它是子记录。我的表在 SQL Server 2008 中，并且有 ID 字段的标识字段。

这是我到目前为止所尝试的。我这里的第一段代码导致错误 3167，记录已删除。如果我进行 debug.Print 记录集实际上包含 3 条记录。

```
Dim r as DAO.Recordset, db as DAO.Database
Set db = CurrentDb
Set r = db.OpenRecordset("SELECT TOP 2 * FROM item ORDER BY DateTimeModified DESC", dbOpenDynaset, dbSeeChanges)
r.AddNew
'Set field values here
r.Update 'Completes without error
r.Bookmark = r.LastModified
Debug.Print r("ItemID") 'Error 3167, Record is deleted 
```

这是我尝试的下一件事：

```
Debug.Print db.OpenRecordset("SELECT @@identity FROM item")(0) 
```

最后一个完成没有任何问题，但返回的值不正确。如果实际的新 ItemID 为 321，则返回值 614。它返回的值似乎是增量的（随着我不断测试它会发生变化），但它似乎与我的表完全无关。没有值为 614 的字段。我已经仔细检查以确保我正在查找正确的表。

我知道我可以使用 DLookup 或 DMax 之类的东西，但我认为这在多用户环境中不会被视为防弹。

我想我可以使用带有 ADO 的存储过程来解决这个问题。我想知道这是否是我唯一的选择？

**Edit1：**
我现在正在使用以下代码，它正在做我需要/想要的事情。我怀疑这与使用 DMax 基本相同。

```
Dim r as DAO.Recordset, db as DAO.Database
Set db = CurrentDb
Set r = db.OpenRecordset("SELECT TOP 1 * FROM item ORDER BY ItemID DESC", dbOpenDynaset, dbSeeChanges)
r.AddNew
'Set field values here
r.Update
r.Requery
r.MoveFirst
Debug.Print r("ItemID") 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-06T00:18:19.373

据我所知`@@IDENTITY`，不适用于基于光标的插入。DAO 和 ADO 都在幕后使用游标。

在您`.Update`记录之后，您应该能够通过读取值来获取标识值。

通过使用键集语义打开的 ADO 记录集，以下内容对我来说很好：

```
r.Update
Debug.Print r("ItemID") 
```

以下通过使用动态集语义打开的 DAO 记录集对我来说很好：

```
r.Update
r.Bookmark = r.LastModified
Debug.Print r("ItemID") 
```

您应该避免`.Requery`and `.MoveFirst`，您正在引入并发问题。考虑：

```
Dim r as DAO.Recordset, db as DAO.Database
Set db = CurrentDb
Set r = db.OpenRecordset("SELECT TOP 1 * FROM item ORDER BY ItemID DESC", dbOpenDynaset, dbSeeChanges)
r.AddNew
''// Set field values here
r.Update
''// At this point another user adds a new record
r.Requery
r.MoveFirst ''// ORDER BY ItemID DESC means that you're going to see the new user's row
Debug.Print r("ItemID") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-11-02T17:03:34.947

以下按预期工作（使用 Office 2013 和 SQL Server 2014）

```
Set rsProjects = db.OpenRecordset("JobProjects", dbOpenDynaset, dbSeeChanges Or dbAppendOnly)
rsProjects.AddNew
rsProjects.Name = 'xyz'
rsProjects.Update
rsProjects.Bookmark = rsProjects.LastModified
lNewProjectID = rsProjects!ProjectID.Value 
```

关键点：我没有使用“SELECT TOP 2”或“SELECT TOP 1”等。我使用了“dbSeeChanges**或 dbAppendOnly** ”。我在 sql profiler 中验证了打开记录集不会生成对 SQL Server 的任何查询。

当您发出更新时，access 会生成一个插入语句，然后立即使用 SELECT @@IDENTITY 来获取新记录的 id。

已编辑：添加缺少的 .AddNew，删除重复的 .Update。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-29T18:11:44.637

它不适用于 sql server 后端（在多用户应用程序中）。对于访问表，它适用于 sql 使用存储过程。使用这种方式

```
CREATE PROCEDURE dbo.AddAsset

  @Name VARCHAR(500),
  @URL  VARCHAR(2000),
  @new_identity INT = NULL OUTPUT
AS
BEGIN
    SET NOCOUNT ON;

INSERT dbo.Assets(Name, URL) SELECT @Name, @URL;
SET @new_identity = SCOPE_IDENTITY();

END 
GO 
```

然后在前端使用这个 sp

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-24T22:03:28.123

`Update`只需在执行语句之前获取关键字段的值。正如下面评论中所指出的，如果您使用的后端与 Microsoft Access 不同，则此过程将不起作用。但是，如果这是您的用例，并且您只是在寻找有关如何获取最后插入记录的 ID 的一般问题的答案，我会在此处留下此回复。

对于您的示例，您可以使用 Microsoft Access 执行此操作：

```
Dim r as DAO.Recordset, db as DAO.Database
Dim lKey As Long
Set db = CurrentDb
Set r = db.OpenRecordset("SELECT TOP 2 * FROM item ORDER BY DateTimeModified DESC", dbOpenDynaset, dbSeeChanges)
r.AddNew
    'Set field values here
    'Retrieve the key value before executing the Update
    lKey = r!ItemID
r.Update
Debug.Print lKey 
```

# ruby-on-rails - Rails：如何使用文件系统以外的其他地方的模板？

> ID：10905598
> 
> 赞同：1
> 
> 时间：2012-06-05T21:59:00.583
> 
> 标签：ruby-on-rails, templates, actionview

我有一个应用程序需要支持一小部分受信任的用户上传新模板。我会将它们存储在数据库或 S3 中。我的问题是：我如何告诉控制器呈现给定的模板？当然，我可以通过手动 ERB 调用来做到这一点：

```
class MyController < ApplicationController
  def foo
    template_source = find_template(params[:name])
    template = Erubis::Eruby.new(template_source)
    render :text => template.result({ :some => @data })
  end
end 
```

但是后来我失去了诸如帮助器和实例变量的自动复制之类的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:17:37.330

你可以使用 render :inline

```
render :inline => find_template(params[:name]) 
```

# android - 三星移动 mtp 设备安装失败

> ID：10905599
> 
> 赞同：1
> 
> 时间：2012-06-05T21:59:01.400
> 
> 标签：android, tablet, device-driver, samsung-mobile

我正在尝试在 android 版本 4.0.3 的三星 s2 手机上测试我的 android 应用程序，我从官方网站下载了 USB 驱动程序，但程序没有检测到手机，返回一条消息告诉我三星移动 mtp 设备失败

请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T17:58:48.823

嗨，我已按照链接中的确切步骤操作：[http ://androidforums.com/samsung-galaxy-s2-international/559858-samsung-mobile-mtp-device-cannot-installed.html](http://androidforums.com/samsung-galaxy-s2-international/559858-samsung-mobile-mtp-device-cannot-installed.html)

以下是步骤：（适用于 Windows 特定说明）：

1.  确保手机未连接到 PC。
2.  从 PC 卸载 KIES。重启你的电脑，然后重新安装 KIES。只是为了衡量...打开 KIES，转到工具 | 解决连接错误。按照说明并等待它完成故障排除过程。
3.  重新启动手机（或关闭然后再次打开手机）。暂时不要将其连接到您的 PC。
4.  重新启动后，转到手机的拨号器，键入 *#7284# - 将出现一个配置窗口。在那个窗口的USB部分，如果默认是PDA，点击MODEM，然后回到PDA，（如果一开始是MODEM，改成PDA）然后按返回键退出。最重要的是，退出时必须设置为PDA。
5.  关闭手机中的 USB 调试。
6.  （可选）将手机的屏幕超时设置为较长时间。（最少 1-2 分钟 - 建议 5 分钟到 30 分钟）它在设置 | 展示。您可以稍后更改此设置。
7.  使用 USB 数据线将手机连接到您的 PC，然后让 Windows 加载您的驱动程序...并等待重新安装驱动程序。
8.  重新安装后，将手机从 USB 断开。在您的手机设置中重新打开 USB 调试，然后重新连接手机 - 您将看到 Windows 为您的手机加载另一组驱动程序。等到它完成。（此步骤是一项预防措施，以确保您的手机被所有必要的驱动程序识别）
9.  完成后，拔下手机，关闭 USB 调试...这是为了确保 MTP 将初始化。此外，按手机的主屏幕键，直到显示您的主屏幕。只有在完成所有这些之后，才能将手机重新连接到 PC。
10.  使用 Windows 资源管理器测试并查看 MTP 是否工作。如果有，您将看到手机的 USB 存储和 SDCard 内容。

经过两天的谷歌搜索后，这绝对帮助了我.....希望它也能帮助其他人......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-01T18:00:34.177

我不得不对我的 SCH-S738C 三星手机使用稍微不同的程序。以下是我为让手机与 Windows XP 通信所采取的步骤：

1.  确保手机未连接到 PC。
2.  从 PC 卸载 KIES。重启你的电脑，然后重新安装 KIES。只是为了衡量...打开 KIES，转到工具 | 解决连接错误。按照说明并等待它完成故障排除过程。
3.  在您的 SCH-S738C 三星手机上输入谷歌搜索：[root SCH-S738C]。这将显示以下网址： [http](http://forums.droidbeans.com/tutorials/(how-to)(root-micromax-qualcomm-phones-without-pc)/?action=thankyoupostlist;msg=813) ://forums.droidbeans.com/tutorials/(how-to)(root-micromax-qualcomm-phones-without-pc)/?action=thankyoupostlist;msg=813 然后导航到这个地址。
4.  在您的 SCH-S738C 三星手机上，从页面上的位置选择 poot.apk：下载 poot.apk。
5.  按照网页上的其余说明进行操作，即： 1) 下载并安装 poot.apk 2) 现在打开 poot 应用程序，然后它会要求您安装 Ministro II，只需点击 Google Play 商店的链接即可。3) 然后你需要更新 ministro 库，请更新它。4) 一旦您更新了 Ministro Library，您将面临两个选择；1.“Press here to Poot” 2.“Built in root check” 5）点击第一个选项“Press here to Poot”，过了一会儿，你将面临三个选项。1\. 获取超级用户 2\. 获取 root-checker 3\. 内置 rootchecker 当您看到这些选项时，这仅意味着您的手机已成功植根。然后单击获取超级用户以完成该过程.. 6）最后重新启动以生效：P 7）恭喜您现在已将手机植根
6.  确保 Samsung Kies 正在您的 Windows XP 机器上运行。
7.  使用 USB 数据线将手机连接到您的 PC，然后让 Windows 加载您的驱动程序...并等待重新安装驱动程序。

我现在能够停止 Samsung Kies，只需使用 Windows XP 文件管理器在 SCH-738C 三星手机上加载和复制文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-01T10:49:48.530

当我安装新的 Windows XP 时，我在三星设备上遇到了类似的问题。我发现我无法通过 Windows 更新站点安装“SAMSUNG Mobile MTP 设备驱动程序”，所以我：

1.  [从http://catalog.update.microsoft.com/v7/site/ScopedViewRedirect.aspx?updateid=523dde6f-6efb-47ac-9aac-8f53732e45c9](http://catalog.update.microsoft.com/v7/site/ScopedViewRedirect.aspx?updateid=523dde6f-6efb-47ac-9aac-8f53732e45c9)下载驱动程序
2.  将设备连接到 PC
3.  当 Windows 通知新硬件时，我从下载的包中安装了驱动程序（用于 USB、MTP 等）
4.  adb 工作正常，但在 MTP 上仍然看不到设备，所以我通过 Windows Update 安装了 Windows Media Plaery 11

这解决了问题。MTP 模式需要 WMP 11。否则三星凯斯会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-21T09:26:37.917

转到三星 Kies 软件，在窗口左上方，单击菜单 > 驱动程序恢复。让它重新安装驱动程序安装完成后，进入手机，设置>应用程序>开发，勾选USB调试模式。在 USB 调试模式下，通过 USB 将手机连接到 PC。它安装正确！与PC断开连接取消USB调试模式重新连接

# c++ - Stringstream - 将对象转换为字符串

> ID：10905601
> 
> 赞同：2
> 
> 时间：2012-06-05T21:59:06.870
> 
> 标签：c++, stringstream

我有一个复杂的对象，我希望它能够像字符串或 int 一样`std::ostringstream`使用运算符传递给 a。`<<`我想为 ostringstream 提供对象的唯一 ID（int）和/或名称（字符串）。我可以在我的类中实现一个运算符或方法来允许它工作吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T23:29:49.740

在与您的类相同的命名空间中定义运算符重载：

```
template<typename charT, typename traits>
std::basic_ostream<charT, traits> &
operator<< (std::basic_ostream<charT, traits> &lhs, Your_class const &rhs) {
    return lhs << rhs.id() << ' ' << rhs.name();
} 
```

如果输出函数需要访问您的类的私有成员，那么您可以将其定义为友元函数：

```
class Your_class {
    int id;
    string name;

    template<typename charT, typename traits>
    friend std::basic_ostream<charT, traits> &
    operator<< (std::basic_ostream<charT, traits> &lhs, Your_class const &rhs) {
        return lhs << rhs.id << ' ' << rhs.name;
    }
}; 
```

请注意，这不会产生成员函数，它只是一次声明和定义友元函数的便捷方式。

# javascript - Jquery - 在 Jquery 中获取多个选择的数据

> ID：10905607
> 
> 赞同：1
> 
> 时间：2012-06-05T21:59:53.433
> 
> 标签：javascript, jquery

这源于[我原来的问题](https://stackoverflow.com/questions/10904829/jquery-how-to-grab-specific-data-type-of-option-after-that-option-is-selected)。我正在扩展它。

Html 选择选项

```
 <select id="1d" name="camp" multiple="multiple">
    <option data-url0="week_1" value="Week 1">30th July</option>
    <option data-url1="week_2" value="Week 2">6th August</option>
    </select>
    <input type="hidden" name="camp_url0" id="1e">
    <input type="hidden" name="camp_url1" id="1f"> 
```

我正在努力解决的 Jquery 脚本。

```
 $("#1d").on("change", function () {
    var url1 = $(this).children(":selected").data("url0");
    var url2 = $(this).children(":selected").data("url1");
    $("#1e").val(url0);
    $("#1f").val(url1);
}); 
```

除了一个重要问题外，这段代码运行良好（也许不是最干净的？）。即使它是一个多重选择器，当两个选项都被选中时，只有一个`option`被标记为`:selected`DOM，这意味着只有一个`data-url{row_id}`被输入。如果两者都被选中，我需要两者。

我希望这是有道理的。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:30:21.367

**更新**：

向 html 添加一些额外的“路由”数据

```
<select id="1d" name="camp" size="5" multiple>
    <option data-url="week_1" data-id="1e" value="Week 1">30th July</option>
    <option data-url="week_2" data-id="1f" value="Week 2">6th August</option>
</select> 
```

并使用它

```
$("#1d").on("change", function () {
    $('input[type=hidden]').val('');

    $('option:selected', this).each(function() {
        $('#' + $(this).data('id')).val($(this).data('url'))
    })
}) 
```

[http://jsfiddle.net/5ctDC/1/](http://jsfiddle.net/5ctDC/1/)

**旧**：

只要[`.map`](http://api.jquery.com/map/)它，你就会得到一个包含数据的数组。

```
$('option:selected', this).map(function() {
    return $(this).data('url')
}) 
```

`["week_1", "week_2"]`

[http://jsfiddle.net/5ctDC/](http://jsfiddle.net/5ctDC/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T22:46:05.703

在不相关的注释中，您不应该使用不以字母开头的 id。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T22:03:06.120

遍历**所有**选定的元素：

```
$("#1d").on("change", function () {
    var allurl1 = '', allurl2 = '';
    $(this).children(":selected").each(function(){
        allurl1 += $(this).data("url0");
        allurl2 += $(this).data("url1");
    });
    $("#1e").val(allurl1);
    $("#1f").val(allurl2);
}); 
```

工作演示： http: [//jsfiddle.net/maniator/mtAgS/](http://jsfiddle.net/maniator/mtAgS/)（我做了输入显示，所以你可以直观地看到发生了什么）

# wcf - 使用 Metro 和 WCF 在 Visual Studio 2012 中进行远程机器调试

> ID：10905609
> 
> 赞同：0
> 
> 时间：2012-06-05T22:00:13.197
> 
> 标签：wcf, remote-debugging

我正在尝试从我的桌面调试平板电脑上的 Metro 应用程序，但是当它启动并尝试从我的 wcf 服务获取数据时，我收到此错误：

mscorlib.dll 中出现“System.ServiceModel.EndpointNotFoundException”类型的异常，但未在用户代码中处理

附加信息：没有`http://localhost:39855/MyService.svc`可以接受消息的端点监听。这通常是由不正确的地址或 SOAP 操作引起的。有关更多详细信息，请参阅 InnerException（如果存在）。

我认为这是因为该服务托管在我的桌面上的 iis express 中，并且平板电脑应用程序正在尝试在 localhost 上查找该服务，该服务不是托管服务的位置，它必须是 ip我的桌面什么的。但是我将如何将我在 Visual Studio 中的服务更改为托管在我的 ip 而不是 localhost 上？我已经禁用了两个防火墙，因此在这方面应该没有任何问题。

我对 WCF 的经验非常有限:(

还是我必须设置 IIS，在本地机器上部署我的服务，然后将平板电脑指向该地址？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T22:06:54.170

在 iis express 中托管服务应该没问题，但是您必须修改客户端（平板电脑应用程序）以明确指向您的主机（使用机器的 IP 或网络主机名）。您可以通过修改应用程序的配置文件或通过在代码中创建客户端绑定并指定主机来做到这一点。

# javascript - Javascript - 如果 url 包含 X，则忽略脚本，否则，运行脚本

> ID：10905620
> 
> 赞同：1
> 
> 时间：2012-06-05T22:01:05.020
> 
> 标签：javascript, url

我对 Javascript 比较陌生，我似乎无法让脚本在某些页面上运行/不运行。

我的主页上有这个脚本来隐藏和取消隐藏内容：

```
$(document).ready(function() {
$(".hidden").hide();
$(".show").html("[+]");
$(".show").click(function() {
    if (this.className.indexOf('clicked') != -1 ) {
        $(this).prev().slideUp(0);
        $(this).removeClass('clicked')
        $(this).html("[+]");
        }
        else {
        $(this).addClass('clicked')
        $(this).prev().slideDown(0);
        $(this).html("[–]");
        }
    });
}); 
```

我需要一些这样的编码：

如果 url 包含“/post/”，则忽略脚本，否则运行脚本

这应该是一个简单的修复。我只是无法让它工作。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T22:04:35.717

`if`您正在寻找的是：

```
if (window.location.indexOf('/post/') == -1){
    // don't run, the '/post/' string wasn't found
}
else {
    // run
} 
```

`indexOf()`如果未找到字符串则返回`-1`，否则返回字符串中找到字符串第一个字符的索引。

上面重写了 Jason 提供的附加常识（在下面的评论中）：

```
if (window.location.indexOf('/post/') > -1){
    // run, the '/post/' string was found
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-10-23T19:58:03.110

根据[这个答案](https://stackoverflow.com/a/13669486/4107296)，

> `window.location`是一个对象，而不是一个字符串，所以它没有 `indexOf`函数。

......所以`window.location.indexOf()`永远不会工作。

但是，按照相同答案的指导，您可以将 URL 转换为字符串，`window.location.href`然后执行搜索。或者您可以访问部分 URL，如下所示：

`if (window.location.pathname === '/about/faculty/'){`...`}` 精确匹配

或者

`window.location.pathname.split( '/' )`[如this answer](https://stackoverflow.com/a/1931716/4107296)中所述，获取部分网址。

# html - 什么 Haskell Web 框架将用于 HTTP/Websocket 数据和消息传递平台？

> ID：10905621
> 
> 赞同：6
> 
> 时间：2012-06-05T22:01:12.727
> 
> 标签：html, haskell, websocket, paas

只是看看 Haskell 和 Web 框架，想知道使用 Haskell 强大的线程/事件功能来为编写 HTML5 和 REST 应用程序的平台提供支持是否有意义，这些应用程序公开了数据的 HTTP API 和 WebSocket（可能 SockJS 支持适当的回退) 事件 API？“大”网络框架似乎并不支持将 WebSockets 作为一等公民，尽管它们似乎还有很多其他的事情要做。

我关心的是利用可用的内核，Haskell 可以做得很好，但也为验证和服务器端逻辑在服务器端提供了简单的用户集成（可能通过嵌入 Lua 或类似的方法？）。如果在 JVM 上编写此代码，则可以利用多种服务器端语言支持和大量库来处理这类事情。

我确信人们正在为他们自己的应用程序使用一次性解决方案做这样的事情，但我正在考虑一种 PaaS 类型的方法，在这种方法中，人们可以使用数据编写 HTML5 应用程序（包括离线使用的适当同步）并将“免费”赛事作为平台的基本组成部分。大多数逻辑将驻留在浏览器中，但有些逻辑可以使用适当的钩子和合理的可嵌入性在服务器上运行（JavaScript 似乎不可能，并且不确定在 Haskell 中嵌入解释器，因为我对 Haskell 非常熟悉） .

到目前为止，我在 Haskell 上遇到的部分问题是我不是数学专家。我在大学没有学过计算机科学，我是一个有创造力的思想家。所以很多教程和文档让我很迷茫，尤其是在处理数学问题时。

有人已经走过这条路了吗？我迟到了吗？:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T12:57:42.983

Gregory Collins[去年在 CUFP 上](http://gregorycollins.net/posts/2011/10/01/cufp-tutorial-slides)提供了一个关于使用 Snap 使用长轮询（不是 websockets）构建交互式聊天网站的教程。源代码在[这里](https://github.com/snapframework/cufp2011)。

在 websockets 部门，Jasper Van der Jeugt 编写了一个[Haskell websockets 库](http://jaspervdj.be/websockets/)。它在[hackage](http://hackage.haskell.org/package/websockets)上可用，并附带提供 Snap 框架支持的[websockets-snap 。](http://hackage.haskell.org/package/websockets-snap)还有[wai-websockets](http://hackage.haskell.org/package/wai-websockets)提供与 Warp 的集成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T08:37:49.690

我相信所有主要框架都具有一定程度的 websockets 支持，因此根据您的要求，它们都应该是一个公平的选择。对于 Yesod，书中提供了一个创建聊天系统（使用事件源，而不是 websockets）的示例：

[http://www.yesodweb.com/book/wiki-chat-example](http://www.yesodweb.com/book/wiki-chat-example)

# asp.net - 正在将存储在 Viewstate 中的 DataTable 转换为 List 一个糟糕的选择？

> ID：10905625
> 
> 赞同：3
> 
> 时间：2012-06-05T22:01:54.350
> 
> 标签：asp.net, list, datatable

我刚刚开始了一份新工作并继承了一个噩梦般的 WebForms .net 4.0 项目，该项目在很多地方都出错了。

我有一个在 ViewState 中存储 DataTable 的用户控件。该代码通过索引号引用整个代码中的列，这使得它完全不可读。我知道我可以按名称引用列以使其更具可读性，但我更愿意将其分解为一个列表。

之前的开发者将列表存储在 ViewState 中，因为更改无法持久化回数据库，我们读入数据，销售人员可以对定价进行修改，然后将信息推送到 XML 格式以生成销售订单表单PDF格式。所以我们需要一种临时存储的机制。

如果我有从头开始的奢侈，我会在 JSON 中提取数据并在客户端完成所有操作，但我还没有那种奢侈。

1.  自从我使用 DataTables 已经很久很久了，我很确定将它放在 ViewState 中并不好，对吗？它会给 ViewState 带来什么样的负载；我们正在查看 44 列，通常大约 25 行。：秒

2.  其次，如果在 ViewState 中放置一个 List 与在 DataTable 中放置一个很大的区别，或者它们是否都一样糟糕 - 在这种情况下，我从当前位置切换出来不会造成伤害？

3.  第三个问题，对行的更新是在 ViewState DataTable 中自动更新的，这和 List 一样吗？

4.  最后一个，更多寻求建议。存储此信息（最好是列表）服务器端的最佳位置在哪里 - 会话或缓存会更好吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T22:13:03.020

1.  你是对的。将 DataTable 存储在 ViewState 中是一个糟糕的主意。

2.  在 ViewState 中存储 List 仍然很糟糕，并且可能比存储 DataTable 稍微好一些。

3.  不清楚您所说的“更新在 DataTable 上自动发生”是什么意思。除非您从 ViewState 检索 DataTable 并以编程方式应用任何更新，否则我怀疑情况是否如此。如果您使用列表，则必须这样做。

4.  Session 可能会更好，但是您可能会遇到可伸缩性问题。坦率地说，我会将其存储在 Session 中，但会选择使用 Out of Proc 状态提供程序之一。这样，您的序列化数据表不会在每次请求时都发送到客户端，从而使您的页面大小非常大，同时让您可以选择将此序列化数据存储在不同的位置，例如 SQL 服务器或 ASP.NET 状态服务器。

# c# - 从 C# 通过 PInvoke 调用 _msize()

> ID：10905628
> 
> 赞同：3
> 
> 时间：2012-06-05T22:02:47.590
> 
> 标签：c#, pinvoke

我正在编写一个 C# 库，其中调用应用程序将传入大量连续的非托管内存。此调用应用程序可以来自 .Net 或 Visual C++（如果从 C++ 调用我的库，它将通过中间 C++/CLI 库）。验证是否有足够的内存很有用，所以我决定调用 _msize() 函数。不幸的是，_msize 似乎总是给我错误的尺寸。我回去修改了我的示例应用程序中的分配例程，然后立即调用_msize。这是我的代码片段：

```
public unsafe class MyMemory
{
    /// <returns></returns>
    [DllImport("msvcrt.dll", SetLastError = true)]
    public static extern int _msize(IntPtr handle);

    public static IntPtr MyAlloc(int size)
    {
        IntPtr retVal = Marshal.AllocHGlobal(size);

        ...

        int memSize = MyMemory._msize(retVal);
        if (memSize < size)
        {
        ...
        }
        return retVal;
    } 
```

当我传入大小 199229440 时，我得到了 199178885 的 memSize。我已经看到不同数字的类似结果。它低于 0.01% 的折扣，如果它结束了，我会完全理解，但事实是它低于，这意味着 _msize 认为分配的内存小于要求的内存。有人知道这是为什么吗？任何关于我应该做什么的建议也将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T22:12:52.700

`LocalSize`改为P/Invoke函数。

`_msize`用于确定分配给`malloc`（及其朋友）的块的大小。是or`AllocHGlobal`的包装器（取决于您相信的参考；但我认为两者是等价的），并且您希望该函数确定实际返回的块的大小。据我所知，它不包含 包装，但您可以使用 P/Invoke 调用它。`GlobalAlloc``LocalAlloc``LocalSize``Marshal``LocalSize`

因此，似乎只有纯粹的好运才能`_msize`返回对您有用的任何东西。也许总是或仅在要求大块时`malloc`使用`GlobalAlloc`（或），并请求一些额外的簿记空间；`LocalAlloc`在这种情况下`_msize`将试图弥补这一点。

# javascript - 如何从具有混合值的较大数组中返回具有相等值的多个数组？

> ID：10905634
> 
> 赞同：1
> 
> 时间：2012-06-05T22:03:09.387
> 
> 标签：javascript, arrays, sorting, string-matching, array-push

*我有一个排序后*的数组，如下所示：

```
var arr = ["a", "a", "b", "b", "b", "b", "c", "c", "c"]; 
```

有 2 个`"a"`字符串、4 个`"b"`字符串和 3 个`"c"`字符串。

我试图返回 3 个单独的数组，从循环中一次返回一个，**只**包含匹配的值。因此，在第一次迭代时，返回的数组将显示为`newArr = ["a", "a"]`，第二次为`newArr = ["b", "b", "b", "b"]`  ，第三次迭代时为`newArr = ["c", "c", "c"]`。   *但是，这是一个预定义值的小数组，我需要一种算法，它可以对未知*大小、*未知*元素以及*未知*数量的类似元素

的数组执行相同的操作。（请记住，在这种情况下，数组已经开始排序） ***这是我的疯狂代码，它显示了一些不寻常且不正确的结果：*** 

 ***```
var arr = ["a", "a", "b", "b", "b", "b", "c", "c", "c"];

for(var index = 0; index < arr.length; index++)
{
  var test = "";
  var newArr = []; // resets the new array upon each iteration
  var str = arr[index]; // initialized as the next unique index-value

  for(var i = index; i < arr.length; i++)
  {
    if(arr[i] == str)
    {
      newArr.push(arr[k]);
      test += arr[i] + " ";
    }
    else
    {
      index = i; // changing the outer loop variable
      break; // exiting the inner loop
    }
  } // end of inner loop

  window.alert(test);
  setValues(newArr);

} // end of outer loop

function setValues(arrSorted)
{
  var here = document.getElementById("here");

  for(var i = 0; i < arrSorted.length; i++)
  {
    here.innerHTML += arrSorted[i] + "&nbsp;";
  }

  here.innerHTML += "<br />";

} // end of setValues function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T22:11:00.743

```
var arr = ["a", "a", "b", "b", "b", "b", "c", "c", "c"];
var arrays = {};
for (var i=0;i<arr.length;i++) {
  if (!arrays[arr[i]]) arrays[arr[i]] = [];
  arrays[arr[i]].push(arr[i]);
} 
```

这会给你相当于

```
arrays = {};
arrays['a'] = ['a','a'];
arrays['b'] = ['b','b','b','b','b'];
arrays['c'] = ['c','c','c']; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T22:17:16.583

您可以使用这样的函数将数组分成几个数组：

```
function divide(arr) {

  var subArrays = [];
  var current = null;
  var subArray = null;

  for (var i = 0; i < arr.length; i++) {
    if (arr[i] != current) {
      if (subArray != null) subArrays.push(subArray);
      current = arr[i];
      subArray = [];
    }
    subArray.push(arr[i]);
  }
  if (subArray != null) subArrays.push(subArray);
  return subArrays;
} 
```

演示：http: [//jsfiddle.net/Guffa/d8CBD/](http://jsfiddle.net/Guffa/d8CBD/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T22:46:05.540

我会这样做：

```
var arr = ["a", "a", "b", "b", "b", "b", "c", "c", "c"];

var out = [], prev;
for (var i = 0, j = 0, len = arr.length; i < len; i++) {
    if (arr[i] !== prev || !out.length) {
        out[j++] = [prev = arr[i]];
    } else {
        out[j - 1].push(prev);
    }
}

//out -> [["a","a"],["b","b","b"],["c","c","c"]] 
```

## [演示](http://jsfiddle.net/eM9Et/)

**注意：**`|| !out.length`检查只是处理以正确开头的数组，`undefined`但如果永远不会出现这种情况，请随意删除它***

# android - 尝试在电晕 Sdk 中平铺地面时出现异常

> ID：10905643
> 
> 赞同：0
> 
> 时间：2012-06-05T22:03:36.043
> 
> 标签：android, iphone, lua, coronasdk

我正在使用以下代码：

```
ground1.x = ground1.x - 10
   ground2.x = ground2.x - 10
   ground3.x = ground3.x - 10
   ground4.x = ground4.x - 10
   ground5.x = ground5.x - 10
   ground6.x = ground6.x - 10
   ground7.x = ground7.x - 10
   ground8.x = ground8.x - 10

   if(ground1.x < ( 0 - 75 ) ) then
          ground1:removeSelf()              
          ground1 = ground2
          ground2 = ground3
          ground3 = ground4
          ground4 = ground5
          ground6 = ground7
          ground7 = ground8
          local num = math.random ( 1, 4 )
          ground8 = display.newImage( group, "normalground"..num..".png", ground7.x + ground7.contentWidth/2, display.contentHeight - 52 ) 
```

为移动的地面设置动画。我正在使用 8 个瓷砖，ground1-ground8。此代码在我的动画函数中，该函数在“enterFrame”上调用。

我要做的是检测“ground1”何时离开左边缘。然后，我将地块ground2 重新分配给ground1，将地块3 重新分配给ground2，以此类推，最后，创建一个新地块并将其分配给ground8。

我对背景滚动做了类似的事情，效果很好。但是，当我尝试运行此代码时，它工作了一段时间（它成功滚动了前 4 个图块）但是一旦它尝试将图块 5 分配给 ground1 并返回动画过程，我得到以下异常：

尝试对字段“x”（零值）执行算术运算

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T05:11:46.283

你忘了切换`ground6`到 down to `ground5`。

我不知道 Corona，所以我不知道`removeSelf`内部做什么，但我猜它会破坏对象和/或删除它的元表，从而`x`不再是有效的索引。由于您将对象引用复制`ground5`到`ground4`, 那么`3`, `2`，`1`它最终会以这种方式被销毁，此时`ground5.x`返回`nil`并且您会看到您看到的异常。

* * *

提示：您永远不应该拥有仅按数字（v1、v2、v3 等）不同的变量列表。这就是数组的用途。与其用 8 个变量来保存地面图像，不如用一个数组来保存所有 8 个图像。然后您可以使用循环来执行操作，例如将它们全部移动 N 个像素。

例如，如果我们将您的 8 张图像放在一个列表中`ground`（例如`ground = {ground1,ground2,ground3,ground4,ground5,ground6,ground7,ground8}`，尽管您可能不会那样初始化它），您可以重写您的代码：

```
-- shift the ground 10 pixels to the right
for i,tile in pairs(ground) do
  tile.x = tile.x - 10
end

if ground[1].x < (0 - 75) then
  -- shift out the first tile
  ground[1]:removeSelf()              
  for i=1,#ground-1 do
    ground[i] = ground[i+1]
  end
  -- add a new tile to the end
  local num = math.random ( 1, 4 )
  ground[#ground] = display.newImage( group, "normalground"..num..".png", ground[#ground-1].x + ground[#ground-1].contentWidth/2, display.contentHeight - 52 )
end 
```

代码更简洁，如果您切换到 10 个地砖或 100 个地砖，则无需更改，并且避免了像您在 OP 中所做的错误。

# mysql - 停止 mysql 导入后，我是否必须重新开始，还是可以从上次中断的地方开始？

> ID：10905645
> 
> 赞同：0
> 
> 时间：2012-06-05T22:03:40.153
> 
> 标签：mysql

我停止了 mysql 导入，我想知道是否必须删除该表并重新开始，或者只是再次运行命令`load data local infile...`，它将继续从我离开的地方插入记录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T22:10:14.493

它不会从中断的地方继续，它将从文件的开头开始（它不知道它在哪里中断），但是因为您使用的`LOCAL`是文档中的关键字：

> 如果您指定 IGNORE，将跳过与唯一键值上的现有行重复的输入行。... 对于 LOCAL，默认行为与指定 IGNORE 相同

因此，已经加载的数据将被简单地忽略。您可以阅读`LOAD DATA` [此处](http://dev.mysql.com/doc/refman/5.0/en/load-data.html)的文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T22:10:40.797

使用[此处](http://dev.mysql.com/doc/refman/5.1/en/load-data.html)`IGNORE`指定的关键字。

# visual-studio-2010 - 您可以为所有使用 ClickOnce VS2010 的用户安装程序吗？

> ID：10905646
> 
> 赞同：3
> 
> 时间：2012-06-05T22:03:43.603
> 
> 标签：visual-studio-2010, publish

您可以使用 Visual Studio ClickOnce Publishing 为“所有用户”安装程序吗？

我运行了安装程序，但没有给出“为所有用户安装”选项 => 然后我检查了实际的安装目录，它位于文件夹中：

```
C:\Users\Patrick\AppData\Local\Apps\2.0\Z5AWACYL.000\4EQB7LVJ.RXP\mapl..tion_0000000000000000_0001.0000_d31e4ada0d11807b\ 
```

所以我认为不会允许其他用户运行它。如何创建一个向所有用户安装程序的项目安装程序？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-07T16:02:11.447

经过大量研究，答案是否定的。

我想出了一个真正的黑客方法来实现它。但是在生产中出现了问题，具体来说，我接到这个家伙的电话，他说“我必须为每个用户安装应用程序吗？”，然后他会说，“用户1运行版本XXX1，但用户2正在运行XXX2" 所以为了令人失望的结果付出了很多努力。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T15:54:17.003

你看过这个吗？[http://msdn.microsoft.com/en-us/library/dd997001.aspx](http://msdn.microsoft.com/en-us/library/dd997001.aspx)

# c++ - 如何在 QT Creator 中检查 ShellExecute 命令返回（HINSTANCE）代码

> ID：10905648
> 
> 赞同：2
> 
> 时间：2012-06-05T22:04:00.333
> 
> 标签：c++, qt, winapi

我正在使用 Shell 命令来启动一个进程。我的开发环境是 C++/QT Creator/QT Libraries 和 Windows API。

如何处理 HINSTANCE 返回值？if (hInstance < 32) 代码抛出编译错误

```
 437: error: ISO C++ forbids comparison between pointer and integer

    HINSTANCE hInstance = ShellExecute(0, QString("open").toStdWString().c_str(), Path.toStdWString().c_str(), 0, 0, SW_SHOWNORMAL);
   if (hInstance < 32)
      qDebug() << "Error"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-04-06T13:42:05.737

如果有人仍在为此苦苦挣扎，这是一个避免警告的解决方案：

```
int retValue = static_cast<int>(reinterpret_cast<uintptr_t>(ShellExecute(<etc>))); 
```

请参阅[uintptr_t 何时优于 intptr_t？](https://stackoverflow.com/questions/29800256/when-is-uintptr-t-preferred-over-intptr-t)有关 uintptr_t 的更多评论

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-23T02:17:01.173

您可以使用 reinterpret_cast 转换返回值：

```
int retValue  = reinterpret_cast<int>(ShellExecute(0, QString("open").toStdWString().c_str(), Path.toStdWString().c_str(), 0, 0, SW_SHOWNORMAL));
   if (retValue  < 32)
      qDebug() << "Error"; 
```

虽然它也可能导致警告：

> 警告 C4302：“reinterpret_cast”：从“HINSTANCE”截断到“int”

但至少它有效。在 MSDN 中，它还建议强制转换为 int。

[https://msdn.microsoft.com/en-us/library/windows/desktop/bb762153(v=vs.85).aspx](https://msdn.microsoft.com/en-us/library/windows/desktop/bb762153(v=vs.85).aspx)

'如果函数成功，则返回大于32的值。如果函数失败，则返回指示失败原因的错误值。返回值被转换为 HINSTANCE 以向后兼容 16 位 Windows 应用程序。然而，这不是一个真正的 HINSTANCE。它只能转换为 int 并与 32 或以下错误代码进行比较。

# android - 为什么我会收到这个 ClassCastException (Android)？

> ID：10905651
> 
> 赞同：0
> 
> 时间：2012-06-05T22:04:10.820
> 
> 标签：android, exception, classcastexception

我更改了一些我认为不相关的东西，运行了程序，然后遇到了这个错误：

```
 06-05 14:53:33.286: ERROR/AndroidRuntime(29084): FATAL EXCEPTION: main
06-05 14:53:33.286: ERROR/AndroidRuntime(29084): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.prattia.webs.cheaterphysics/com.prattia.webs.cheaterphysics.Vectors}: java.lang.ClassCastException: android.widget.TextView
06-05 14:53:33.286: ERROR/AndroidRuntime(29084):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
06-05 14:53:33.286: ERROR/AndroidRuntime(29084):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
06-05 14:53:33.286: ERROR/AndroidRuntime(29084):     at android.app.ActivityThread.access$2300(ActivityThread.java:125)
06-05 14:53:33.286: ERROR/AndroidRuntime(29084):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
06-05 14:53:33.286: ERROR/AndroidRuntime(29084):     at android.os.Handler.dispatchMessage(Handler.java:99)
06-05 14:53:33.286: ERROR/AndroidRuntime(29084):     at android.os.Looper.loop(Looper.java:123)
06-05 14:53:33.286: ERROR/AndroidRuntime(29084):     at android.app.ActivityThread.main(ActivityThread.java:4627)
06-05 14:53:33.286: ERROR/AndroidRuntime(29084):     at java.lang.reflect.Method.invokeNative(Native Method)
06-05 14:53:33.286: ERROR/AndroidRuntime(29084):     at java.lang.reflect.Method.invoke(Method.java:521)
06-05 14:53:33.286: ERROR/AndroidRuntime(29084):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:858)
06-05 14:53:33.286: ERROR/AndroidRuntime(29084):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:616)
06-05 14:53:33.286: ERROR/AndroidRuntime(29084):     at dalvik.system.NativeStart.main(Native Method)
06-05 14:53:33.286: ERROR/AndroidRuntime(29084): Caused by: java.lang.ClassCastException: android.widget.TextView
06-05 14:53:33.286: ERROR/AndroidRuntime(29084):     at com.prattia.webs.cheaterphysics.Vectors.onCreate(Vectors.java:52)
06-05 14:53:33.286: ERROR/AndroidRuntime(29084):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
06-05 14:53:33.286: ERROR/AndroidRuntime(29084):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
06-05 14:53:33.286: ERROR/AndroidRuntime(29084):     ... 11 more 
```

我在网上搜索，发现最有可能的情况是两个小部件具有相同的 id。我在我的 XML 中没有找到这个。这是XML：

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView  xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_height="wrap_content" 
    android:layout_width="match_parent">
    <LinearLayout 
         android:layout_width="fill_parent" 
         android:layout_height="fill_parent"
         android:background="@drawable/background" 
         android:orientation="vertical">

         <ImageView android:layout_height="wrap_content" 
            android:src="@drawable/vectors" 
            android:layout_width="wrap_content"
            android:layout_gravity="center"
            android:paddingTop="5dp"
            android:paddingBottom="5dp"
            android:adjustViewBounds="true">
         </ImageView>
         <LinearLayout android:layout_height="wrap_content" 
            android:layout_width="match_parent"
            android:orientation="horizontal">
            <Button android:text="Choose Program" 
                android:id="@+id/bChsProgV" 
                android:layout_width="wrap_content" 
                android:layout_height="wrap_content"
                android:layout_marginBottom="5dp"
                android:layout_marginLeft="97dp"
                android:adjustViewBounds="true">
            </Button>
            <ImageButton android:layout_height="wrap_content" 
                android:src="@drawable/help" 
                android:id="@+id/ibHelpV" 
                android:layout_width="wrap_content"
                android:layout_marginLeft="65dp"
                android:background="@null" 
                android:layout_marginTop="10dp">
            </ImageButton>
         </LinearLayout>
         <LinearLayout android:layout_width="match_parent" 
            android:layout_height="wrap_content" 
            android:orientation="horizontal">
             <TextView android:text="Value" 
                android:layout_width="wrap_content" 
                android:layout_height="wrap_content"
                android:paddingLeft="5dp"
                android:paddingRight="5dp"
                android:textColor="#fffafa">
             </TextView>
             <EditText android:text="" 
                android:id="@+id/etValueV" 
                android:layout_height="wrap_content"
                android:inputType="numberSigned|numberDecimal"
                android:layout_width="100dp" >
             </EditText>
             <Button android:text="Next" 
                android:id="@+id/bNextV" 
                android:layout_width="65dp" 
                android:layout_height="wrap_content"
                android:layout_marginLeft="10dp">
             </Button>
         </LinearLayout>
         <LinearLayout android:layout_width="match_parent" 
            android:layout_height="wrap_content" 
            android:orientation="horizontal">
             <TextView android:text="Angle" 
                android:layout_width="wrap_content" 
                android:layout_height="wrap_content"
                android:paddingLeft="5dp"
                android:paddingRight="5dp"
                android:textColor="#fffafa">
             </TextView>
             <EditText android:text="" 
                android:id="@+id/etAngleV" 
                android:layout_height="wrap_content"
                android:inputType="numberSigned|numberDecimal"
                android:layout_width="100dp" >
             </EditText>
             <Button android:text="Prev" 
                android:id="@+id/bPrevV" 
                android:layout_width="65dp" 
                android:layout_height="wrap_content"
                android:layout_marginLeft="10dp">
             </Button>
         </LinearLayout>
        <TextView android:text="" 
            android:id="@+id/tvAnsValV"
            android:textColor="#fffafa" 
            android:layout_width="wrap_content" 
            android:layout_height="wrap_content"
            android:gravity="center"
            android:layout_gravity="left"
            android:paddingLeft="5dp">
         </TextView>
         <LinearLayout android:layout_height="wrap_content" 
            android:layout_width="match_parent"
            android:orientation="horizontal">
            <LinearLayout android:layout_height="wrap_content" 
            android:layout_width="wrap_content"
            android:orientation="vertical">
                <RadioGroup
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content" >              
                    <RadioButton android:layout_height="wrap_content"
                        android:layout_width="wrap_content"
                        android:checked="true"
                        android:text="Degrees"
                        android:layout_marginLeft="5dp"
                        android:id="@+id/rbDegV">
                    </RadioButton>
                    <RadioButton android:layout_height="wrap_content"
                        android:layout_width="wrap_content"
                        android:checked="false"
                        android:text="Radians"
                        android:layout_marginLeft="5dp"
                        android:id="@+id/rbRadV">
                    </RadioButton>
                </RadioGroup>
            </LinearLayout>
            <RadioButton android:text="π" 
                android:id="@+id/rbPiV" 
                android:layout_width="wrap_content"
                 android:layout_height="wrap_content"
                android:checked="false"
                android:visibility="invisible"
                android:layout_marginTop="50dp">
            </RadioButton> 
            <RadioGroup
                android:layout_width="match_parent"
                android:layout_height="wrap_content" >  
                <LinearLayout android:layout_height="wrap_content" 
                    android:layout_width="wrap_content"
                    android:orientation="horizontal">
                    <LinearLayout android:layout_height="wrap_content" 
                        android:layout_width="wrap_content"
                        android:orientation="vertical">
                        <RadioButton android:layout_height="wrap_content"
                            android:layout_width="wrap_content"
                            android:checked="false"
                            android:text="Q2"
                            android:layout_marginLeft="30dp"
                            android:id="@+id/rbQ2V">
                        </RadioButton>
                        <RadioButton android:layout_height="wrap_content"
                                android:layout_width="wrap_content"
                                android:checked="false"
                                android:text="Q3"
                                android:layout_marginLeft="30dp"
                                android:id="@+id/rbQ3V">
                        </RadioButton>
                    </LinearLayout>
                    <LinearLayout android:layout_height="wrap_content" 
                        android:layout_width="wrap_content"
                        android:orientation="vertical">
                        <RadioButton android:layout_height="wrap_content"
                            android:layout_width="wrap_content"
                            android:checked="true"
                            android:text="Q1"
                            android:layout_marginLeft="5dp"
                            android:id="@+id/rbQ1V">
                        </RadioButton>
                        <RadioButton android:layout_height="wrap_content"
                                android:layout_width="wrap_content"
                                android:checked="false"
                                android:text="Q4"
                                android:layout_marginLeft="5dp"
                                android:id="@+id/rbQ4V">
                        </RadioButton>
                    </LinearLayout>
                </LinearLayout> 
            </RadioGroup>                                                       
         </LinearLayout>
         <Button android:text="Submit" 
            android:id="@+id/bSubmitV" 
            android:layout_width="75dp" 
            android:layout_height="wrap_content"
            android:layout_gravity="center">
         </Button>
         <TextView android:text="" 
            android:id="@+id/tvErrorV" 
            android:layout_width="wrap_content" 
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:textColor="#fffafa">
         </TextView>
         <LinearLayout android:id="@+id/llCanvasV" 
            android:layout_height="wrap_content" 
            android:layout_width="match_parent">
         </LinearLayout>
    </LinearLayout>

</ScrollView> 
```

这是标记第 52 行的代码的一部分。如果您需要更多代码，我会放上来。很长，很遗憾。VectorsView 尚未完成，可能无法正常工作。这甚至不是我正在研究的程序的一部分。任何帮助都会很棒。

```
 public void onCreate(Bundle savedInstanceState) {
            // TODO Auto-generated method stub
            super.onCreate(savedInstanceState);
            setContentView(R.layout.vectors);
            vectorsView = new VectorsView(this);
            l = (LinearLayout) findViewById(R.id.llCanvasV);  //Line 52
            l.addView(vectorsView);
...}

public class VectorsView extends View{

        public VectorsView(Context context) {
            super(context);
        }
        @Override
        protected void onDraw(Canvas canvas) {
            // TODO Auto-generated method stub
            super.onDraw(canvas);       

            Paint paint = new Paint();
            paint.setColor(Color.WHITE);

            canvas.drawLine(0, 0, 100, 100, paint);
            vectorsView.draw(canvas);
            vectorsView.setLayoutParams(new LayoutParams(25, 25)); 
        }
    }

public void Initialize(){
        chsprog = (Button) findViewById(R.id.bChsProgV);
        next = (Button) findViewById(R.id.bNextV);
        prev = (Button) findViewById(R.id.bPrevV);
        submit = (Button) findViewById(R.id.bSubmitV);
        value = (EditText) findViewById(R.id.etValueV);
        angle = (EditText) findViewById(R.id.etAngleV);
        help = (ImageButton) findViewById(R.id.ibHelpV);
        deg = (RadioButton) findViewById(R.id.rbDegV);
        rad = (RadioButton) findViewById(R.id.rbRadV);
        q1 = (RadioButton) findViewById(R.id.rbQ1V);
        q2 = (RadioButton) findViewById(R.id.rbQ2V);
        q3 = (RadioButton) findViewById(R.id.rbQ3V);
        q4 = (RadioButton) findViewById(R.id.rbQ4V);
        pi = (RadioButton) findViewById(R.id.rbPiV);
        error = (TextView) findViewById(R.id.tvErrorV);
        ansval = (TextView) findViewById(R.id.tvAnsValV);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T22:09:05.260

> 引起：java.lang.ClassCastException：android.widget.TextView

您正在尝试将 a`TextView`转换为 a `LinearLayout`。但是您的 XML 似乎是正确的，因此请检查*清理整个项目*是否有帮助，有时*Eclipse/ADT*会搞砸并且无法正确重建资源，从而导致 id 指向错误的位置。

# ios - Ipad 在我的应用程序上禁用默认多手势

> ID：10905656
> 
> 赞同：0
> 
> 时间：2012-06-05T22:04:42.290
> 
> 标签：ios, ipad, gesture

我想为婴儿开发一个 ipad 应用程序，我注意到当婴儿使用 ipad 时，她会使用很多手指，使 ipad 的手势激活，如切换活动、检查跳板或关闭活动或通知

如何在我的应用程序中禁用此手势？（然后我会实现我自己的手势）

那么可以禁用默认手势吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:11:14.977

禁用默认手势是不可能的，您只能从设置中禁用它们，但您仍然可以制作自己的手势但请记住，系统全局手势将优先于您自己的手势

# php - 将查询更改为计算唯一值的数量而不是总行数

> ID：10905658
> 
> 赞同：0
> 
> 时间：2012-06-05T22:04:47.423
> 
> 标签：php, mysql

对于下面的查询，某些行在名为“zip”的字段中具有相同的值。如何计算“zip”而不是总行数的唯一值？

```
$presult = mysql_query("SELECT COUNT(*) from submission ") or die(mysql_error()); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T22:06:05.050

```
SELECT COUNT(DISTINCT zip) AS unique_zip_cnt
  FROM submission 
```

# xml - Xpath substring-before 只获取一个元素

> ID：10905659
> 
> 赞同：3
> 
> 时间：2012-06-05T22:04:55.677
> 
> 标签：xml, xpath, substring

```
<row transactionDateTime="2012-06-04 02:42:44" transactionID="2519826732" quantity="5000" typeName="Caldari Navy Mjolnir Rocket" typeID="27321" price="988.72" clientID="92026367" clientName="N Clover" stationID="60003760" stationName="Jita IV - Moon 4 - Caldari Navy Assembly Plant" transactionType="buy" transactionFor="personal" journalTransactionID="5956192510"/> 
```

你好，

以上是我尝试从中提取数据的 XML 文件的示例。我要提取的数据是；

```
transactionDateTime="2012-06-04" 
```

现在 - 使用以下 Xpath 查询我没有问题；

```
substring-before(//row[@transactionfor='personal']/attribute::transactiondatetime, ' ') 
```

这正是我想要的——“2012-06-04”，但它只给了我一个元素！如果我删除 substring-before 它会得到我所有的元素，但包括时间。

任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T04:01:36.083

```
substring-before(//row[@transactionfor='personal']/attribute::transactiondatetime, ' ') 
```

在 XPath 1.0 中，如果将节点集作为参数传递，其中需要单个值（字符串），则节点集中的第一个节点用作参数。规则是将函数**[`string()`](http://www.w3.org/TR/xpath/#function-string)**应用于传递的节点集，并且根据定义`string($nodeset)`与`string($node-set[1])`.

在 XPath 2.0 中，上述表达式应该会导致错误。

**当节点数大于 1 时，不可能使用单个 XPath 表达式生成应用于所有选定节点的函数的结果**。

因此，必须在第二步中处理每个选定的节点（可能在托管 XPath 的编程语言中指定的循环中）。

**在 XPath 2.0 中，可以使用函数调用作为表达式的最后一个定位步骤**。

因此，可以使用此 XPath 2.0 表达式生成*所有需要的字符串序列：*

```
//row[@transactionfor='personal']
           /attribute::transactiondatetime
                           /substring-before(., ' ') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T22:14:15.507

它不起作用，因为第一个参数`substring-before()`是一个字符串，并且您正在向它传递`transactionDateTime`所有行的属性。

试试这个：

```
//row[@transactionFor='personal']/substring-before(@transactionDateTime,' ') 
```

# php - 如何检查密码是否包含用户名

> ID：10905661
> 
> 赞同：2
> 
> 时间：2012-06-05T22:05:04.177
> 
> 标签：php

我正在尝试添加一个步骤，如果输入的密码包含输入的用户名，那么它会返回错误，即 pass cannot contain username。我说的是“包含”，而不是密码。在那种情况下，我可以简单地做`elseif($password == "$user_username") $error .= $lang['46'];}`

```
$user_username = cleanit($_REQUEST['username']);
STemplate::assign('user_username',$user_username);
$password = cleanit($_REQUEST['password']);
STemplate::assign('password',$password);
if($user_username == "")
{
    $error .= $lang['41'];  //Error: Please enter your username
}
elseif(strlen($user_username) < 4) //Your username should have 4 chars 
{
    $error .= $lang['42'];  
}
elseif(!preg_match("/^[a-zA-Z0-9]*$/i",$user_username)) //name only contains letters and numbers
{
    $error .= $lang['43'];
}
elseif(!verify_email_username($user_username)) //username already taken
{
    $error .= $lang['44'];
}
elseif($password == "") //no password entered
{
    $error .= $lang['45'];  
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T22:07:42.000

只需将此附加到您的条件：

```
elseif(stristr($password, $username) !== false) // password contains username
{
    $error .= $lang['46'];  
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T22:07:49.380

最简单的事情是[stripos](http://php.net/stripos)：

```
$username = "Corbin";
$password = "mynameiscorbin";
if (stripos($password, $username) !== false) {
    //password contains username
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T22:07:28.070

我想你正在寻找[`stripos()`](http://us.php.net/manual/en/function.stripos.php).

# python - Django：如何在 FileField 中保存原始文件名？

> ID：10905674
> 
> 赞同：13
> 
> 时间：2012-06-05T22:07:08.897
> 
> 标签：python, django

我希望文件名是随机的，因此我使用`upload_to`返回随机文件名的函数，如下所示：

```
from uuid import uuid4
import os
def get_random_filename(instance, filename):
    ext = filename.split('.')[-1]
    filename = "%s.%s" % (str(uuid4()), ext)
    return os.path.join('some/path/', filename)

# inside the model
class FooModel(models.Model):
    file = models.FileField(upload_to=get_random_filename) 
```

但是我想将原始文件名保存到模型内的属性中。像这样的东西不起作用：

```
def get_random_filename(instance, filename):
    instance.filename = filename
    ext = filename.split('.')[-1]
    filename = "%s.%s" % (str(uuid4()), ext)
    return os.path.join('some/path/', filename)

# inside the model
class FooModel(models.Model):
    file = models.FileField(upload_to=get_random_filename)
    filename = models.CharField(max_length=128) 
```

我该怎么做？

谢谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-06T14:24:29.587

发布的代码正常工作，也许实际的代码是

```
class FooModel(models.Model):
    filename = models.CharField(max_length=128)
    file = models.FileField(upload_to=get_random_filename) 
```

注意上面字段顺序的切换。

这不起作用，因为： 由`upload_to()`调用`pre_save()`，[在代码](https://github.com/django/django/blob/master/django/db/models/sql/compiler.py#L870)中 ，当需要 的实际值`FileField`时。您会发现，在插入 sql 中生成第一个参数之后，对属性`filename`的赋值。因此，分配不会在生成的 SQL 中生效，只会影响实例本身。`upload()``filename`

如果这不是问题，请发布您在 shell 中键入的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T23:40:32.393

您可以在保存过程中使用填充文件名的路径。显然，当您的 get_random_filename 运行时，您必须将原始文件名存储在内存中。

```
# inside the model
class FooModel(models.Model):
    file = models.FileField(upload_to=get_random_filename)
    filename = models.CharField(max_length=128)

    def save(self, force_insert=False, force_update=False):
        super(FooModel, self).save(force_insert, force_update)
            #Do your code here... 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-05T23:50:45.400

只需重新排序您的命令。 [https://docs.djangoproject.com/en/dev/topics/db/models/](https://docs.djangoproject.com/en/dev/topics/db/models/)

```
def save(self, *args, **kwargs):
        do_something()
        super(Blog, self).save(*args, **kwargs) # Call the "real" save() method.
        do_something_else() 
```

# objective-c - 如何用短裤数组初始化 NSData？

> ID：10905675
> 
> 赞同：1
> 
> 时间：2012-06-05T22:07:22.563
> 
> 标签：objective-c, xcode

如何创建带有短裤数组的 NSData 实例？据我了解 [NSData dataWithBytes] 方法需要输入为无符号字符数组吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T22:11:46.623

`dataWithBytes:`需要一个`void *`. 你可以传入任何你想要的东西；如果跨架构是一个问题，请确保您考虑字节序。

# jquery - jquery - 所需的表单验证规则取决于

> ID：10905676
> 
> 赞同：2
> 
> 时间：2012-06-05T22:07:25.750
> 
> 标签：jquery, jquery-validate

有人能给我介绍一下如何使用`validate`, `rules`, `required`, `depends`. 我有一些部分代码，但不确定它是如何工作的。

```
$("#form2").validate({
    rules: {
        firstname: {
            required: {
                depends: function () {
                    $(this).val($.trim($(this).val()));
                    return true;
                }
            },
            minlength: 2
        }, 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T22:21:32.063

```
$("#form2").validate({
rules: {
    firstname: {     //This rule applies to the $('#form2 input[name="firstname"]') selector

        required: {  //This can be a true/false boolean, string, or a complex field using depends.

            depends: function () { //depends takes a function pointer that
                                   //returns a value, informing the rule 
                                   //if it is required. In this case, always true.

                $(this).val($.trim($(this).val()));

                return true;
            }
        },

        minlength: 2 // the minimum length of text in the field is 2 characters.
    }, 
```

# ms-access - 强制所有用户断开与 2010 Access 后端数据库的连接

> ID：10905680
> 
> 赞同：5
> 
> 时间：2012-06-05T21:24:34.380
> 
> 标签：ms-access

我们有多用户前端/后端 MS Access 2010 应用程序。我们添加了一个进程，当我们想在后端进行诸如压缩和修复之类的工作时，该进程将关闭远程前端。这是基于计时器的对表字段的检查，如果具有特定值将关闭应用程序。

我做了两次检查以查看用户是否连接到数据库：

*   我有登录/注销过程，可以看到谁仍然登录（它的基于表单的所以是错误的，例如他们关闭表单但前端仍然打开）。

*   我使用 .ldb 文件查看器查看是否仍有连接

两个问题：

*   如果使用 ldb 查看器无法查看到 backed 的连接，是否有可能存在？

*   是否有任何 100% 的防弹方法可以强制断开与后端的所有连接？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-08-08T10:10:38.157

用户将“锁”放入 LDB。LDB 是一种用于 MS Access 的锁数据库。

用户还把“锁”放在 LDB 和 MDB 上。这些锁是 Windows 和 Windows 网络提供的本地数据库原语的一部分。

*如果ldb*中没有锁，则用户没有写入 MDB。

*如果mdb*上没有锁，则用户没有使用该 Windows/网络服务。

要在 MDB 上获得独占锁定，您需要两者。MSAccess 不会让您在 LDB 具有显示其他人正在使用数据库的条目时进行排他锁，并且 Windows 不会在它具有显示其他人正在使用数据库的锁时为您提供排他锁。

要 100% 防弹清空 LDB，请删除 LDB。这就是为什么 Access 总是尝试在关闭时删除 LDB。如果 Access 崩溃，或网络断开，或 PC 或服务器关闭，LDB 将有尚未删除的数据（“锁”）。您可以通过删除 LDB 来摆脱它们。

如果用户在 LDB 上仍有 Windows/网络锁，则 Access 将无法删除 LDB。由于 Access 忽略了现有的“锁定”条目以清除损坏的“锁定”条目，这就是 Access/Windows 阻止 Access 在另一个用户仍在使用它时删除 LDB 的方式。

如果存在 Windows 锁或 Access/LDB“锁”，则您无法获得独占所有权。如果只存在 Access/LDB“锁”，您可以删除 LDB，然后获得独占所有权。

如果存在任何 Windows/网络锁，则您对 Access 所做的任何操作都不能让您断开其他人与网络的连接。您需要转到托管文件的服务器/PC，然后强制断开连接。Access 不是为您执行此操作的网络管理程序。

最后我看了一下，默认情况下，Windows Server 设置为在网络会话丢失 15 分钟后超时断开文件连接。因此，如果您关闭 PC，请等待 15 分钟，然后 Windows/网络锁定将解除（默认时间）。或者：管理工具、计算机管理、系统工具、共享文件夹、会话。选择要解锁的文件，然后删除会话。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-03-17T12:22:44.300

存在一个修复程序，我已经为我维护的 MS-Access 应用程序安装了它。但是不方便，实现起来也不简单。

首先，关于锁定文件和锁定文件的一些背景知识。

锁定文件是一个有用的工具，但它是一个指示器，而不是实际的锁定：您可以编辑它，但没有任何效果。

如果实时 MS-Access 会话编辑数据、更改对象（例如：索引表）或执行维护任务，则可以在 .accdb 或 .mdb 后端数据库文件上保持文件锁定。该列表中的最后两项很少见 - 影响您在会话中打开的文件之外的另一个数据库文件需要一些努力，但有时会在野外观察到 - 但关闭这些会话应该释放锁定并且*几乎*总是将要。

崩溃的 MS-Access 会话可以保持对 .accdb 或 .mdb 后端数据库文件的文件锁定。强制重启有问题的机器应该释放锁，而且*大部分*都会释放。

您可以使用锁定文件（.ldb 或 .laccdb）跟踪那些

使用 ODBC 或 ADO 连接 Access 数据库的第三方报告应用程序应将其连接设置为只读，以便它们无法锁定文件。*如果幸运*的话，系统所有者使用您控制的 dsn 文件，您可以看到该设置。

一些报告应用程序，如 QLikView，是不透明的界面，需要完整的文件名，没有人知道接下来会发生什么：可能会锁定，也可能不会。**你没有办法知道**。

一些报告应用程序 - 和 Excel 数据透视表 - 可能会链接到您的数据库，而所有者根本不会告诉您。如果他们的连接配置错误，他们可以在检索时锁定您的表：并且终止客户端会话可以使锁定保持在原位。无聊的 Excel 用户一直在观看缓慢的枢轴“刷新”。

更糟糕的是，一些第三方系统可能需要写入数据：应该避免这种情况 - 通过 Access 客户端应用程序！- 但你并不总是能做出那个决定。

如果幸运的话，连接对象配置正确，因此机器 ID 在连接字符串中，确保它会出现在锁定文件中，并允许您找到带有锁的机器......

*也许*他们会这样做：通常他们不会。

...请注意，对于您关心的问题，行锁定查询、页面锁定查询和表锁定查询在功能上是相同的：如果您需要在“文件”级别执行某些操作（如压缩和修复），该文件已锁定您。在该锁被释放之前，您将被锁定。

您可能无法识别机器。您可能会也可能无法强制他们离开网络。它们在正常操作中可能会或不会成功释放锁，如果它们崩溃，它们几乎肯定不会。

所以：这不是一张漂亮的照片。

**在公司环境中，您最好的解决方案是使用“手指”工具直接与网络管理员联系，以确定谁在锁定数据库文件、联系用户的能力以及断开有问题的会话的能力。**

失效模式有：

*   如果您的组织结构不允许您建立这种沟通渠道，那您就完蛋了。
*   如果您组织的网络管理员没有能力或权限在有用的时间范围内执行此操作，那么您就完蛋了。
*   如果您组织的网络管理员选择不这样做，那您就完蛋了。

## 但是，我确实为我的 MS-Access 应用程序进行了修复：

我使用的解决方法非常激进 - 不是将铁锹穿过建筑物的电源的“核选项”，或者屈服于系统管理员对人类牺牲的要求，但是非常不愉快并且实施大量荒谬的工作：

1.  配置客户端 - 您的 MS-Access 前端应用程序 - 在命名的后端数据库之间轻松切换。
2.  **同样，您编写并允许其他应用程序使用**的 dsn 文件应该可以由预先存在的脚本访问，以将“DBQ=”或“数据源=”子句编辑为新文件名。
3.  获取数据库文件的副本，将其保存到本地临时文件夹以进行所需的维护工作，然后以新名称将其重新发布到应用程序的“数据”文件夹中。
4.  现在运行“更改后端”脚本或 VBA 函数...
5.  ......还有其他任何使用旧的、锁定的后端文件的人。

**提示**：实现您的前端应用程序，以便它定期轮询后端数据库（或其他一些资源，您最坏的情况是完全锁定）以执行“*维护关闭*”或“*更改数据库*”指令是明智的放入您的“主菜单”表单的计时器事件。

此外，还有代码可以自动切换链接表的源数据库。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-05T23:09:59.543

> 如果使用 ldb 查看器无法查看到 backed 的连接，是否有可能存在？

是的，我曾多次遇到后端被锁定的问题，但我用 ldb 查看器看不到任何东西。在这些情况下，我们甚至对用户访问数据库的机器进行了硬关机。糟糕的解决方案，但在需要的时候，你有时会绝望。

> 是否有任何 100% 的防弹方法可以强制断开与后端的所有连接？

不，我还没有找到 100% 的方法来强制所有人退出后端数据库。我发现最接近完美的是使用[位于 Utter Access 上的 Chris Symonds Timeout-Force Out 代码](http://www.utteraccess.com/forum/TimeOut-Forceoff-re-edit-t672964.html&mode=threaded)

> 该数据库完成多项任务：
> 
> 1.  允许开发人员使用 db 去任何 PC 并强制所有用户关闭拆分 db，以便开发人员可以独占打开 db 以修改/维护 db。
> 2.  如果用户在开发人员设置的指定分钟数内未使用 db，则将用户踢出 db。
> 3.  允许开发人员每天指定一个时间来强制所有用户关闭拆分数据库并关闭数据库以进行备份、编译或其他操作。
> 4.  所有功能都是可选的，无需额外编码即可绕过，仅使用每个数据库所需的功能。

我实现了他的代码，它在大约 99% 的时间里都能正常工作，但在某些情况下，MS Access 还是有点棘手，我看不出为什么数据库被锁定或强制所有人退出。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-05T23:58:14.527

“*我做了两次检查，看看用户是否连接到数据库*”

如果您需要独占打开数据库，您可以跳过其他检查，只需检查您是否可以这样做。

```
Public Function CheckExclusive(ByVal pFullPath As String) As Boolean
    Dim blnReturn As Boolean
    Dim cn As Object
    Dim strConnection As String

On Error GoTo ErrorHandler

    strConnection = "Provider=" & _
        CurrentProject.Connection.Provider & _
        ";Data Source=" & pFullPath & ";"
    Set cn = CreateObject("ADODB.Connection")
    cn.Mode = 12& ' adModeShareExclusive '
    cn.Open strConnection
    blnReturn = True
    cn.Close

ExitHere:
    On Error Resume Next
    Set cn = Nothing
    On Error GoTo 0
    CheckExclusive = blnReturn
    Exit Function

ErrorHandler:
    blnReturn = False
    GoTo ExitHere
End Function 
```

然后使用 db 文件的完整路径调用该函数。

```
If CheckExclusive("C:\SomeFolder\YourDb.mdb") = True Then
    ' do what you need here which requires exclusive access: '
    '     make backup; compact; whatever '
End If 
```

# javascript - javascript onblur/onfocus 功能不起作用

> ID：10905684
> 
> 赞同：1
> 
> 时间：2012-06-05T22:08:21.237
> 
> 标签：javascript

我有以下两个 html 表单输入：

```
<input type="text" class="faded" name="mobile" value="012-245-6789" onfocus="hideDefault(this)" onblur="showDefault(this)"/> 
```

和

```
<input class="faded validation_required" type="text" name="dob" value="MM/DD/YYYY" onfocus="hideDefault(this)" onblur="showDefault(this)"/> 
```

和以下javascript：

```
function hideDefault(input)     
{
if(input.name == "dob")
{
    if (input.value == "MM/DD/YYYY")
    {
        input.value = "";
        input.style.color = "black";
    }
}
else if(input.name == "mobile")
{
    if (input.value == "012-345-6789")
    {
        input.value = "";
        input.style.color = "black";
    }
}
    else
{input.value ="hello";}

}
function showDefault(input)
{
if(input.name = "dob")
{
    if (input.value == "")
    {
        input.value = "MM/DD/YYYY";
        input.style.color = "#A3A3CC";
    }
}
else if(input.name == "mobile")
{
    if (input.value == "")
    {
        input.value = "012-345-6789";
        input.style.color = "#A3A3CC";
    }
}

} 
```

“dob”输入工作正常，当您单击它时，默认文本消失，当您移开它时，它又回来了。但它不适用于第一个，即“移动”。为什么是这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T22:12:32.590

你有一个值不匹配：

```
 value="012-245-6789"
...    
    if (input.value == "012-345-6789")
...
    input.value = "012-345-6789"; 
```

请注意，第 4 位是 2 在一个地方，3 在其他地方。

而且，您在这里缺少等号：

```
if(input.name = "dob") 
```

# jquery - 将 jqGrid 行高设置为 23px 以下

> ID：10905685
> 
> 赞同：2
> 
> 时间：2012-06-05T22:08:35.143
> 
> 标签：jquery, jqgrid

我知道这里有关于如何设置行高的问题。我已经阅读了他们并按照他们的建议做了，但他们都没有真正解决我想要解决的问题。我的用户希望一次在网格上查看更多数据。因此，我尝试将行高更改为 15px。

jqGrid 忽略任何低于 23px 的行高。当传入的高度值为 23 或更大时，以下代码有效：

```
self.grid.setRowData(row[self.keyColumn], false, { height: cssRowHeight }); 
```

再低一点，对 html 的检查显示该行的高度为 21px，顶部和底部有 1px 的边框。

所以我的问题是，如何将 jqGrid 行高设置为低于 23px 的值？

谢谢，杰罗姆

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T22:41:46.867

这是个好问题！我认为这对其他用户来说会很有趣。

查看显示[的演示](http://ok-soft-gmbh.com/jqGrid/SmallRowHeight.htm)

![在此处输入图像描述](../Images/6d7c43ee5a8ba1b23518163814ff53b7.png)

我使用了以下 CSS：

```
.ui-jqgrid tr.jqgrow td { height: 15px; } 
```

确切的结果可能取决于您使用的其他格式器。例如，列`formatter: 'checkbox'`可见的相同网格（请参见[此处](http://ok-soft-gmbh.com/jqGrid/SmallRowHeight0.htm)）看起来，尤其是在 IE 中，不是那么紧凑：

![在此处输入图像描述](../Images/92da4f741c2f88788d528eb5b22970a8.png)

它在任何方面都比原始网格更紧凑（参见[演示](http://ok-soft-gmbh.com/jqGrid/SmallRowHeight_.htm)）：

![在此处输入图像描述](../Images/740367e95b6486d687e27f6b71e972a4.png)

例如，如果您需要减小具有组合框的行的大小，则必须使用其他 CSS，例如

```
.ui-jqgrid tr.jqgrow td { height: 15px; padding-top: 0px;}
.ui-jqgrid tr.jqgrow td input { padding: 0px; height: 11px; width: 11px; } 
```

看[这里](http://ok-soft-gmbh.com/jqGrid/SmallRowHeight1.htm)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-30T14:21:38.807

在您的 jQGrid 文件中添加以下 css 样式作为样式标记之间的内部样式

```
<style>
.ui-jqgrid tr.jqgrow td{height:40px;}
</style> 
```

并通过以下[链接自定义网格高度、宽度、字体大小和字体系列](http://www.smarttutorials.net/pagination-previous-next-first-and-last-button-using-jqgrid-php-mysql-jquery-and-ajax/)。

# .htaccess - .htaccess 重写规则冲突

> ID：10905693
> 
> 赞同：2
> 
> 时间：2012-06-05T22:10:04.900
> 
> 标签：.htaccess, mod-rewrite, url-rewriting

请用 ReWriteRule 帮助我...我的问题是我有一个链接，我必须清理甚至成功，但是当我为另一个链接应用相同的 ReWriteRule 时，数据不会显示.. 例如：

链接 1：localhost:8080/domain/index.php?subj=about_us 为此我写了这条规则.. RewriteRule ^(.*).html/?$ index.php?subj=$1 [NC,L]

链接 2：localhost:8080/domain/brands_content.php?brand=about_brand 为此我写了这条规则.. RewriteRule ^(.*).html/?$brands_content.php?brand=$1 [NC,L]

第一个链接规则是完美的，我得到了干净的链接，但是对于第二个链接，规则不起作用，页面加载但没有内容....

等待您的友好回复....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:39:18.467

（根据我们在评论中的交流对答案进行了第二次修改）

首先，不要使用 L 标志，因为您告诉 Apache 这是“最后一个”规则，它将停止处理。

其次，我在这里理解你的目标仍然有点困难。直到/除非你能更好地描述你的实际目标，恐怕我无能为力。这里有几个选项，也许你可以选择一个？

**选项一：**

您希望用户单击 src 为“index.php?subj=about_us”的导航链接，并让他们转到该页面，但让 URL 栏显示“about_us.html”。

**选项二：**

您希望用户单击 src 为“index.php?subj=about_us”的导航链接，并让他们转到实际页面“about_us.html”，但仍然在 URL 中说“index.php?subj=about_us”酒吧。

**选项三：**

您希望用户单击 src 为“about_us.html”的导航链接，但让他们转到实际页面“index.php?subj=about_us”并在 URL 栏中查看“index.php?subj=about_us”。

**选项四：**

您希望用户单击 src 为“index.php?subj=about_us”的导航链接，但让他们转到实际页面“about_us.html”并在 URL 栏中查看“about_us.html”。

如果你能告诉我其中哪一个最接近你的目标，我会再做一次尝试来帮助你。:)

# jquery-ui - jQuery UI DatePicker 默认为日期范围内的最后一个日期

> ID：10905694
> 
> 赞同：0
> 
> 时间：2012-06-05T22:10:09.090
> 
> 标签：jquery-ui, jquery-ui-datepicker

即使提供了默认日期，日期选择器也会默认为最大日期。以下代码设置日期选择器的最小值、最大值和默认日期。但是，当显示文本框时，日期选择器中的默认日期设置为最大日期。

这是一个日期选择器错误吗？

```
 var from = new Date(parseInt(dict["from"].substr(6)));
  var to = new Date(parseInt(dict["to"].substr(6)));
  $("#PlanDate").datepicker('option', {
                dateFormat: "mm/dd/yy",
                defaultDate: $.datepicker.formatDate("mm/dd/yy", from),
                minDate: from,
                maxDate: to
            }); 
```

# scala - 播放框架和 sbt：将凭据传递到受密码保护的 repo

> ID：10905695
> 
> 赞同：6
> 
> 时间：2012-06-05T22:10:10.663
> 
> 标签：scala, playframework, dependencies, sbt

我需要将以下库定义为依赖项：

网址：[http ://deploy.cloud.testmx.com:8081/nexus/content/groups/public/](http://deploy.cloud.testmx.com:8081/nexus/content/groups/public/)

用户：testmx

通过：testmx@testmx

组 ID：testmx

artifactId：testmxcommons

版本：1.0.0-SNAPSHOT

所以我定义了以下项目/Build.scala

```
import sbt._
import Keys._
import PlayProject._

object ApplicationBuild extends Build {

    val appName         = "testmxproject"
    val appVersion      = "1.0-SNAPSHOT"

    val appDependencies = Seq(
      "mysql" % "mysql-connector-java" % "5.1.18",
      "testmx" % "testmxcommons" % "1.0.0-SNAPSHOT"
    )

    val main = PlayProject(appName, appVersion, appDependencies, mainLang = SCALA).settings(
      credentials += ("testmx public", "deploy.cloud.testmx.com:8081", "testmx", "testmx@testmx"),
      resolvers += "testmx public" at "http://deploy.cloud.testmx.com:8081/nexus/content/groups/public/"
    )

} 
```

我收到以下错误：

```
[warn]  module not found: testmx#testmxcommons;1.0.0-SNAPSHOT

[warn] ==== testmx public: tried
[warn]   http://deploy.cloud.testmx.com:8081/nexus/content/groups/public/testmx/textmxcommons/1.0.0-SNAPSHOT/textmxcommons-1.0.0-SNAPSHOT.pom 
```

我尝试了几种替代方法，但它们给了我同样的错误......

我已经检查了[这篇文章](http://code.google.com/p/simple-build-tool/wiki/Publishing)和这个[SO question](https://stackoverflow.com/questions/4342079/how-can-i-retrieve-snapshot-dependencies-from-nexus-using-sbt)

并且还尝试将用户名和密码保存在外部文件中，如此[处](https://cloudbees.zendesk.com/entries/20836643-sbt-publish-to-repositories)和[此处](https://github.com/harrah/xsbt/wiki/Publishing)所述。

任何的想法？

-- 编辑澄清 --

我更改了真实的网址，因为它不是我正在使用的公共回购......真实的网址在那里，并且 sbt 试图找到的 pom 确实存在......

ps：顺便说一句.. sbt scaladocs 在哪里？？？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-06T02:55:21.420

您需要告诉 SBT 您要发布到哪个存储库：

```
publishTo := Some("testmx public" at "http://deploy.cloud.testmx.com:8081/nexus") 
```

此外，如果您不想将凭据保留在 Build 文件中，可以通过添加以下行告诉它在本地检索它们：

```
credentials += Credentials(Path.userHome / ".ivy2" / ".credentials"), 
```

并在您的`~/.ivy2`目录中创建一个`.credentials`像这样的文件：

```
realm=Sonatype Nexus Repository Manager
host=deploy.cloud.testmx.com
user=testmx
password=testmx@testmx 
```

有关更多信息，请参见[https://github.com/harrah/xsbt/wiki/Publishing](https://github.com/harrah/xsbt/wiki/Publishing)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-06T06:26:41.057

传递凭据时有两个问题。

首先是我通过了错误的领域。（感谢 Alex Varju 的这个）

您必须通过服务器在尝试登录时向您发送的相同领域（只需在铬上按 ctrl-shift-I 或 F12 并进入网络查看它）

第二个问题是我传递了端口号，而 sbt 似乎不喜欢那样......

所以，最后我这样做了，它工作正常：

```
val main = PlayProject(appName, appVersion, appDependencies, mainLang = SCALA).settings(
  credentials += ("Sonatype Nexus Repository Manager", "deploy.cloud.testmx.com", "testmx", "testmx@testmx"),
  resolvers += "testmx public" at "http://deploy.cloud.testmx.com:8081/nexus/content/groups/public/"
) 
```

正如预期的那样，将您的凭据设置在不同的文件中，同样的修改也可以正常工作......

感谢大家的回答

# java - Java产生xml版本1.1

> ID：10905696
> 
> 赞同：4
> 
> 时间：2012-06-05T22:10:13.437
> 
> 标签：java, xml, sax

我有一个 xml 文件，它具有以下标头：`<?xml version="1.1" encoding="UTF-8"?>`. 这也是强制性的，该文件是 1.1 版，因为其中包含一些字符，这些字符在 1.1 版中是不允许的。

我的任务是从文件中提取一些实体并将其再次保存为 xml 文件。如果我生成一个新的 xml 文件，它将是 1.0 版。由于新文件中存在一些编码错误，我认为问题是错误的 xml 版本。是否有可能在 1.1 版中生成 xml 文件（包括正确的标头）？

这是我当前代码的片段：

```
//read the file
SAXParserFactory factory = SAXParserFactory.newInstance();
SAXParser saxParser = factory.newSAXParser();
DefaultHandler handler = new DefaultHandler() {
...
}

//write the output file
SAXTransformerFactory fac = (SAXTransformerFactory)TransformerFactory.newInstance();
final TransformerHandler tfh = fac.newTransformerHandler();
Transformer transformer = tfh.getTransformer();
transformer.setOutputProperty(OutputKeys.METHOD, "xml");
transformer.setOutputProperty(OutputKeys.INDENT, "yes"); 
```

我希望有人能帮助我。

最好的，迈克尔

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T22:24:12.080

您可能希望将版本指定为输出属性。

请参阅[OutputKeys.VERSION](http://docs.oracle.com/javase/1.5.0/docs/api/javax/xml/transform/OutputKeys.html#VERSION)。

# jquery - 使用 jQuery Quicksand 过滤时出现尴尬的跳转

> ID：10905699
> 
> 赞同：0
> 
> 时间：2012-06-05T22:10:34.620
> 
> 标签：jquery, quicksand

我正在使用流沙和 jquery 开发一个可过滤的站点。我已经设置好了一切（imgs 现在是通用的）。一组图像上方有一组类别，当您选择一个类别时，应该只显示该类别中的项目。它确实过滤并显示了正确的项目，但是在过滤时它以一种非常尴尬的方式上下跳跃 - 当它应该放松时。

链接是[http://lllh.dk/filtering/work3.html](http://lllh.dk/filtering/work3.html)

部分html：

```
<div id="content">
    <div class="txtdiv">
    <h1>A selection of work</h1>
    <h2>2009-present</h2>
    </div>

        <div id="workleft">

            <ul class="filterOptions">  
              <txt>
                <li class="active"><a href="#" class="all">All</a></li>
                <li><a href="#" class="graphicdesign">Graphic Design</a></li>
                <li><a href="#" class="printmatters">Design of Printed Matters</a></li>
                <li><a href="#" class="designlanguages">Design for Languages</a></li>
                <li><a href="#" class="typo">Typography and Lettering</a></li>
                <li><a href="#" class="visualidentity">Visual Identity</a></li>
              </txt>
            </ul>
        </div>

        <div id="workright">
            <ul class="filterOptions">  
              <txt>
                <li><a href="#" class="photo">Photography</a></li>
                <li><a href="#" class="camless">Cameraless Photography</a></li>
                <li><a href="#" class="co-socialdesign">Co-Design / Social Design</a></li>
                <li><a href="#" class="conceptualdesign">Conceptual Design</a></li>
                <li><a href="#" class="criticaldesign">Critical Design</a></li>
              </txt>
            </ul>
        </div>

    <div class="workdiv">

    <ul class="ourHolder">

<li class="item" data-id="id-1" data-type="graphicdesign typo">
<a href="work/braille_calendar.html" onMouseOver="document.braille.src='workbuttons/braille2.jpg';" onMouseOut="document.braille.src='workbuttons/braille1.jpg';"> <img src="workbuttons/braille1.jpg" name="braille"> </a>
</li>
<li class="item" data-id="id-3" data-type="camless photo">
<a href="work/braille_calendar.html" onMouseOver="document.RapaNui.src='workbuttons/braille2.jpg';" onMouseOut="document.RapaNui.src='workbuttons/braille1.jpg';"> <img src="workbuttons/braille1.jpg" name="RapaNui"> </a>
</li>

<li class="item" data-id="id-2" data-type="graphicdesign">
<a href="work/braille_calendar.html" onMouseOver="document.Name.src='workbuttons/braille2.jpg';" onMouseOut="document.Name.src='workbuttons/braille1.jpg';"> <img src="workbuttons/braille1.jpg" name="Name"> </a>
</li>
<li class="item" data-id="id-2" data-type="typo">
<a href="work/braille_calendar.html" onMouseOver="document.Something.src='workbuttons/braille2.jpg';" onMouseOut="document.Something.src='workbuttons/braille1.jpg';"> <img src="workbuttons/braille1.jpg" name="Something"> </a>
</li>           
    </ul>
    </div>  
</div> 
```

还有一些css

```
/* Load headline fonts */
@font-face {
 font-family: 'ACPRegular';
 src: url('acaslonpro-regular-webfont.eot');
 src: url('acaslonpro-regular-webfont.eot?#iefix') format('embedded-opentype'),
     url('acaslonpro-regular-webfont.woff') format('woff'),
     url('acaslonpro-regular-webfont.ttf') format('truetype');
 font-weight: normal;
 font-style: normal;
}
@font-face {
 font-family: 'ACPBold';
 src: url('acaslonpro-bold-webfont.eot');
 src: url('acaslonpro-bold-webfont.eot?#iefix') format('embedded-opentype'),
     url('acaslonpro-bold-webfont.woff') format('woff'),
     url('acaslonpro-bold-webfont.ttf') format('truetype');
 font-weight: normal;
 font-style: normal;
}

/* Page content */
#content {
margin-top:75px;
position:absolute;
width:850px;
z-index:0;
border-bottom:45px;
border-bottom-style:solid;
border-bottom-color:#FFF;
}

.txtdiv {
width:400px;
margin: 0px auto 0px auto;
text-align:center;
}

/* Typography */

h1 {
font-family:ACPBold;
letter-spacing:1px;
font-size:2em;
font-weight:normal;
padding:0px;
margin:0px;
margin-bottom:3px;
}

h2 {
font-family:ACPRegular;
font-size:1.2em;
font-weight:normal;
padding:0px;
margin-top:0px;
margin-bottom:15px;
}

txt {
font-family:Arial, Helvetica, sans-serif;
font-size:0.7em;
line-height:160%;
margin-left:auto;
margin-right:auto;
}

ul {
list-style-type: none;
padding: 0px;
margin: 0px;
overflow: auto;
}

/* Work page */
#workleft {
width:421px;
margin: 0px 8px 0px 0px;
text-align:right;
float:left;
}

#workright {
width:421px;
text-align:left;
overflow:hidden;
}

.workdiv {
width:741px;
margin: 0px auto 0px auto;
margin-top:45px;
}

/*- PORTFOLIO -*/
ul.ourHolder {
width: 800px;
height: 850px;
overflow: hidden;
}
ul.ourHolder li.item {
width: 247px;
height: 164px;
float: left;
text-align: center;
overflow: hidden;
} 
```

最后是js..

```
$(document).ready(function() {
  // get the action filter option item on page load
  var $filterType = $('.filterOptions li.active a').attr('class');

  // get and assign the portfolio element to the
// $holder varible for use later
  var $holder = $('ul.ourHolder');

  // clone all items within the pre-assigned $holder element
  var $data = $holder.clone();

  // attempt to call Quicksand when a filter option
// item is clicked
$('.filterOptions li a').click(function(e) {
    // reset the active class on all the buttons
    $('.filterOptions li').removeClass('active');

    // assign the class of the clicked filter option
    // element to our $filterType variable
    var $filterType = $(this).attr('class');
    $(this).parent().addClass('active');

    if ($filterType == 'all') {
        // assign all li items to the $filteredData var when
        // the 'All' filter option is clicked
        var $filteredData = $data.find('li');
    } 
    else {
        // find all li elements that have our required $filterType
        // values for the data-type element
        var $filteredData = $data.find('li[data-type~=' + $filterType + ']');
    }

    // call quicksand and assign transition parameters
    $holder.quicksand($filteredData, {
        duration: 800,
        easing: 'easeInOutQuad'
    });
    return false;
});
}); 
```

似乎布局的一部分破坏了宽松。在我尝试进行故障排除时，图像上方部分中的某些东西似乎是问题所在，可能是 txtdiv div。如果我删除了除应用于过滤器功能之外的所有 css，则缓动和过滤工作正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T23:33:21.297

注释掉`$(this).parent().addClass('active');`并添加`adjustHeight: false`到流沙的选项对我有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T22:20:55.870

我知道这个问题。这里已经是一个问题： [CSS bubbling while using jQuery Quicksand](https://stackoverflow.com/questions/10302280/css-bubbling-while-using-jquery-quicksand)

对我来说，当我更改多条 css 行时，它会起作用。但是我不知道了，也许你可以看一下源码：[http](http://www.annagebhardt.de/) : //www.annagebhardt.de/（看效果点击'PROJEKTE'然后一个子条目）

# svg - 是否可以使用使用路径绘制的内联 svg 来掩盖图像？

> ID：10905704
> 
> 赞同：4
> 
> 时间：2012-06-05T22:10:53.277
> 
> 标签：svg, mask, masking

我需要用 SVG 元素屏蔽图像。我的页面上有一个非常详细的内联 SVG 元素，我想将其用作将要加载的图像的掩码。我的 SVG 是用`<path>`. 我想要类似于此示例[http://jsfiddle.net/pjgalbraith/cnLHE/](http://jsfiddle.net/pjgalbraith/cnLHE/)的内容。*我确实注意到这个例子不适用于我的 Chrome 或 IE9，只有 FF。

这是我的基本结构。

```
 <div>
     <svg width="500" height="500">
        <mask id="myMask'>
           <g>
              <path/>
           </g>
        </mask>
     </svg>
     <img src="http://myImage.jpg" style="mask:url(#myMask);">
  </div> 
```

我尝试`<mask>`在包装 group 的 SVG 内添加一个标签`<g>`，但没有成功。

这使我的 SVG 图形完全透明，所以我认为它正在尝试工作，并且 SVG 充当蒙版，但图像根本没有被蒙版，只是覆盖了位置。是否`<img>`需要在里面`<svg>`或类似的东西？

有没有人有 SVG 经验并且知道如何做到这一点？我看到的每个示例都使用简单的 rect 或 svg 图形来掩盖，但没有路径。也许这就是为什么？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T18:03:35.717

如果将图像放在 svg 中，您几乎可以在任何地方使用它，如下所示：

```
<svg width="220" height="220">
    <mask maskUnits="objectBoundingBox" maskContentUnits="objectBoundingBox" id="m1">
      <linearGradient id="g" gradientUnits="objectBoundingBox" y2="0.5" x2="1" y1="0.5" x1="0">
        <stop stop-color="white" offset="0"/>
        <stop stop-color="white" stop-opacity="0" offset="1"/>
      </linearGradient>
      <rect id="svg_1" height="1" width="1" y="0" x="0" stroke-width="0" fill="url(#g)"/>
    </mask>
<image xlink:href="http://upload.wikimedia.org/wikipedia/en/thumb/0/08/DioHolyDiver.jpg/220px-DioHolyDiver.jpg" width="100%" height="100%" class="target"/>
</svg> 
```

这是显示此内容的更新小提琴：http: [//jsfiddle.net/cnLHE/34/](http://jsfiddle.net/cnLHE/34/)

要回答有关在掩码中包含路径的问题，这很好，并且所有支持 svg 的浏览器 AFAIK 都支持。

# delphi - 使用 dropdowncombo 在表格中进行一些计算

> ID：10905705
> 
> 赞同：1
> 
> 时间：2012-06-05T22:10:58.130
> 
> 标签：delphi, delphi-7, delphi-xe2, delphi-xe

我的数据库中有一个名为“Stock”的字段。它显示还有多少物品待售。现在我有一个下拉组合，其值为 1、2、3 等...所以现在当我在网格中选择一个物品并单击“出售”按钮时，我想要“库存”相关项目的字段（在网格中）以减少组合中的数量。因此，如果“库存”是 100 并且我卖出 5（下拉组合值），我希望网格值现在显示为 95。我希望你知道我的意思......我可以通过插入计算字段来做到这一点，但我没有想要。更好的更新...任何想法像 UPDATE MyTable set STOCK = (Mytable.fieldbyname('stock').asInteger - dropdowncombo1.value) 我这里没有delphi，所以不确定这是否适用于网格中的选定记录.. .

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T03:36:07.920

```
abstable1.edit;
    abstable.FieldByName('stock').value := abstable.FieldByName('stock').value - strtoint(cxcombobox1.text);
    abstable1.Refresh; 
```

这完成了工作......

# c++ - 如何检查 TCP 端口是否已被监听？

> ID：10905714
> 
> 赞同：5
> 
> 时间：2012-06-05T22:12:24.573
> 
> 标签：c++, c, winapi, sockets, tcp

我有一个充当 HTTP 服务器的第三方库。我将一个地址和端口传递给它，然后它用它来监听传入的连接。这个库以这样一种方式进行侦听，即它不接收端口的独占使用和它绑定到的地址。结果，我可以多次监听同一个端口。

我需要在同一个进程中运行这个 HTTP 服务器的多个实例。每个实例都有一个默认端口，但如果该端口不可用，则应使用下一个可用端口。这就是我的问题所在；我最终可以让两个 HTTP 服务器在同一个端口上侦听。

我无法更改 HTTP 服务器的代码，如果 HTTP 服务器无法侦听我给它的端口，它不会提醒我，因此我必须能够在启动每个 HTTP 服务器之前检查端口是否已在使用中。我尝试通过绑定我自己的套接字并将 SO_REUSEADDR 设置为 FALSE 和 SO_EXCLUSIVEADDRUSE 设置为 TRUE 来检查端口是否已经被监听，但是当现有的 HTTP 服务器已经在该端口上监听时，绑定和监听调用都会成功。

这个HTTP服务器是如何达到这个效果的，我怎样才能准确地检查一个端口是否正在以这种方式被监听？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T22:57:40.773

快速而肮脏的方法是尝试访问`connect()`本地主机上的端口。如果`connect()`调用成功，那么您就知道该端口当前正在被监听（接收连接的人）。如果连接调用失败（尤其是`ECONNREFUSED`），那么您可以确定没有人在监听该端口。

当然，这里有一个竞争条件：在您运行上述测试之后，但在您自己绑定到端口之前，没有什么能真正阻止另一个程序突然进入并抢占端口。因此，您应该将测试结果更多地视为一种提示，而不是绝对规则，并且（希望）如果您后来发现该端口毕竟正在使用中，则可以通过某种方式来处理它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T22:21:25.503

使用端口号 0。操作系统将选择一个空闲端口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T23:00:55.063

[http://msdn.microsoft.com/en-us/library/windows/desktop/ms740621(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms740621(v=vs.85).aspx)解释了不同选项如何交互。

您没有向我们提供几乎足够的信息来准确地告诉我们您的用例中发生了什么，但我可以处理一个看起来像您所看到的任意用例。

假设您使用的是 Win 2003 或更高版本，并且您的主 NIC 是 10.0.0.1，并且一切都在同一个用户帐户下运行。

您的应用程序的第一个实例出现，您的测试代码尝试将 10.0.0.1:12345 与 SO_EXCLUSIVEADDREUSE 绑定。当然，这行得通。

您关闭套接字，然后告诉 HTTP 服务器侦听端口 12345。它将 0.0.0.0:12345 与 SO_REUSEADDR 绑定，这当然有效。

现在您的应用程序的第二个实例出现了，您的测试代码尝试将 10.0.0.1:12345 与 SO_EXCLUSIVEADDREUSE 绑定。根据 MSDN 文章中的图表，这是可行的。

您关闭套接字，然后告诉 HTTP 服务器侦听端口 12345。它将 0.0.0.0:12345 与 SO_REUSEADDR 绑定，这是有效的。

如果这是问题所在，假设您无法让 HTTP 服务器绑定特定地址，您可以通过在测试代码中使用 0.0.0.0 来解决问题。（当然，如果它是其他数百个可能的问题之一，那么该解决方案将不起作用。）

如果您不知道 HTTP 服务器正在使用哪些套接字选项、地址等，并且没有源，只需在调试器中运行它并为相关调用设置断点即可。

# c++ - 不能使用结构作为地图的索引

> ID：10905716
> 
> 赞同：1
> 
> 时间：2012-06-05T22:12:26.570
> 
> 标签：c++, map

我试图编写这段代码：

```
#include <iostream>
#include <map>

using namespace std;

typedef struct 
{
    int x;
    int y;
}position;

int main(int argc, char** argv)
{
    map<position, string> global_map;
    position pos;
    pos.x=5;
    pos.y=10;
    global_map[pos]="home";
    return 0;
} 
```

事实上，这不是原始代码，而是它的简化版本（我正在尝试使用 OpenGL 制作俄罗斯方块游戏）。
无论如何，问题是我说的那一行的语法错误：“global_map[pos]="home";”。
我不明白错误的原因，我在这里发布它以供需要更多详细信息的人使用：

```
invalid operands to binary expression (' position const' and 'position const') 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T22:17:55.037

*关联容器*的要求是其中`std::map`之一，即用作键的元素之间必须有顺序。默认情况下，这`std::less`只是调用`operator <`. `struct`因此，在 a 中使用 your作为键所需要做的`std::map`就是实现`operator <`它。

```
struct position
{
    int x;
    int y;
};

bool operator <( position const& left, position const& right )
{
    return left.x < right.x || ( left.x == right.x && left.y < right.y );
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T22:23:08.810

假设您实际上想要`position`一维结构，例如`std::map`（而不是某种二维结构），您可以在 C++11 中这样做：

```
#include <iostream>
#include <map>

using namespace std;

typedef struct 
{
    int x;
    int y;
}position;

int main(int argc, char** argv)
{
    auto cmp = [](const position& a, const position& b) -> bool {
        if (a.x == b.x)
            return a.y < b.y;
        return a.x < b.x;
    };

    map<position, string, decltype(cmp)> global_map(cmp);
    position pos;
    pos.x=5;
    pos.y=10;
    global_map[pos]="home";
    return 0;
} 
```

请`cmp`根据自己的喜好调整。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T22:18:04.570

您需要重载“<”比较运算符，以便 map （除其他外）插入新元素。

`bool operator<(const position&, const position&);`

# android - 对于 SQLiteConstraintException 错误代码 19，我该怎么办？

> ID：10905724
> 
> 赞同：0
> 
> 时间：2012-06-05T22:12:44.743
> 
> 标签：android, sql, error-handling, constraints

错误代码 19 我该怎么办？我已经发布了 LogCat、我的 DatabaseAdapter (RemindersDbAdapter) 和一些我认为会导致问题的 RemindersEditActivity 代码（第 316-336 行）

这是我的 LogCat：

```
06-05 23:57:53.607: E/AndroidRuntime(549): android.database.sqlite.SQLiteConstraintException: error code 19: constraint failed
06-05 23:57:53.607: E/AndroidRuntime(549):  at android.database.sqlite.SQLiteStatement.native_execute(Native Method)
06-05 23:57:53.607: E/AndroidRuntime(549):  at android.database.sqlite.SQLiteStatement.executeUpdateDelete(SQLiteStatement.java:92)
06-05 23:57:53.607: E/AndroidRuntime(549):  at android.database.sqlite.SQLiteDatabase.updateWithOnConflict(SQLiteDatabase.java:1810)
06-05 23:57:53.607: E/AndroidRuntime(549):  at android.database.sqlite.SQLiteDatabase.update(SQLiteDatabase.java:1761)
06-05 23:57:53.607: E/AndroidRuntime(549):  at com.xyz.android.taskreminder.RemindersDbAdapter.updateReminder(RemindersDbAdapter.java:204)
06-05 23:57:53.607: E/AndroidRuntime(549):  at com.xyz.android.taskreminder.ReminderEditActivity.saveState(ReminderEditActivity.java:333)
06-05 23:57:53.607: E/AndroidRuntime(549):  at com.xyz.android.taskreminder.ReminderEditActivity.access$0(ReminderEditActivity.java:316)
06-05 23:57:53.607: E/AndroidRuntime(549):  at com.xyz.android.taskreminder.ReminderEditActivity$3.onClick(ReminderEditActivity.java:161)
06-05 23:57:53.607: E/AndroidRuntime(549):  at android.view.View.performClick(View.java:3511)
06-05 23:57:53.607: E/AndroidRuntime(549):  at android.view.View$PerformClick.run(View.java:14105)
06-05 23:57:53.607: E/AndroidRuntime(549):  at android.os.Handler.handleCallback(Handler.java:605)
06-05 23:57:53.607: E/AndroidRuntime(549):  at android.os.Handler.dispatchMessage(Handler.java:92)
06-05 23:57:53.607: E/AndroidRuntime(549):  at android.os.Looper.loop(Looper.java:137)
06-05 23:57:53.607: E/AndroidRuntime(549):  at android.app.ActivityThread.main(ActivityThread.java:4424)
06-05 23:57:53.607: E/AndroidRuntime(549):  at java.lang.reflect.Method.invokeNative(Native Method)
06-05 23:57:53.607: E/AndroidRuntime(549):  at java.lang.reflect.Method.invoke(Method.java:511)
06-05 23:57:53.607: E/AndroidRuntime(549):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
06-05 23:57:53.607: E/AndroidRuntime(549):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
06-05 23:57:53.607: E/AndroidRuntime(549):  at dalvik.system.NativeStart.main(Native Method) 
```

这是我的数据库适配器：

```
public class RemindersDbAdapter {

//
// Databsae Related Constants
//
private static final String DATABASE_NAME = "data";
private static final String DATABASE_TABLE = "reminders";
private static final int DATABASE_VERSION = 10;

public static final String KEY_TITLE = "title";
public static final String KEY_BODY = "body";
public static final String KEY_IMAGE = "image";
public static final String KEY_DATE_TIME = "reminder_date_time"; 
public static final String KEY_ROWID = "_id";

private static final String TAG = "ReminderDbAdapter";
private DatabaseHelper mDbHelper;
private SQLiteDatabase mDb;

/**
 * Database creation SQL statement
 */
private static final String DATABASE_CREATE =
        "create table " + DATABASE_TABLE + " ("
                + KEY_ROWID + " integer primary key autoincrement, "
                + KEY_TITLE + " text not null, " 
                + KEY_BODY + " text not null, " 
                + KEY_IMAGE + " text not null, "
                + KEY_DATE_TIME + " text not null);"; 

private final Context mCtx;

private static class DatabaseHelper extends SQLiteOpenHelper {

    DatabaseHelper(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
    }

    @Override
    public void onCreate(SQLiteDatabase db) {

        db.execSQL(DATABASE_CREATE);
        db.execSQL("PRAGMA foreign_keys = OFF;");
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        Log.w(TAG, "Upgrading database from version " + oldVersion + " to "
                + newVersion + ", which will destroy all old data");
        db.execSQL("DROP TABLE IF EXISTS " + DATABASE_TABLE);
        onCreate(db);
    }
}

/**
 * Constructor - takes the context to allow the database to be
 * opened/created
 * 
 * @param ctx the Context within which to work
 */
public RemindersDbAdapter(Context ctx) {
    this.mCtx = ctx;
}

public RemindersDbAdapter open() throws SQLException {
    mDbHelper = new DatabaseHelper(mCtx);
    mDb = mDbHelper.getWritableDatabase();
    return this;
}

public void close() {
    mDbHelper.close();
}

public long createReminder(String title, String body, String path, String reminderDateTime) {
    ContentValues initialValues = new ContentValues();
    initialValues.put(KEY_TITLE, title);
    initialValues.put(KEY_BODY, body);
    initialValues.put(KEY_IMAGE, path);   
    initialValues.put(KEY_DATE_TIME, reminderDateTime); 

    return mDb.insert(DATABASE_TABLE, null, initialValues);
}

public boolean deleteReminder(long rowId) {

    return mDb.delete(DATABASE_TABLE, KEY_ROWID + "=" + rowId, null) > 0;
}

public Cursor fetchAllReminders() {

    return mDb.query(DATABASE_TABLE, new String[] {KEY_ROWID, KEY_TITLE,
            KEY_BODY, KEY_IMAGE, KEY_DATE_TIME}, null, null, null, null, null);
}

public Cursor fetchReminder(long rowId) throws SQLException {

    Cursor mCursor =

            mDb.query(true, DATABASE_TABLE, new String[] {KEY_ROWID,
                    KEY_TITLE, KEY_BODY, KEY_IMAGE, KEY_DATE_TIME}, KEY_ROWID + "=" + rowId, null,
                    null, null, null, null);
    if (mCursor != null) {
        mCursor.moveToFirst();
    }
    return mCursor;

}

// Fetches a single image
public Cursor fetchImage(long rowId) throws SQLException {

    Cursor mCursor =

            mDb.query(true, DATABASE_TABLE, new String[] {KEY_ROWID,
                    KEY_IMAGE}, KEY_ROWID + "=" + rowId, null,
                    null, null, null, null);
    if (mCursor != null) {
        mCursor.moveToFirst();
    }
    return mCursor;

}

public boolean updateReminder(long rowId, String title, String body, String path, String reminderDateTime) {
    ContentValues args = new ContentValues();
    args.put(KEY_TITLE, title);
    args.put(KEY_BODY, body);
    args.put(KEY_IMAGE, path);
    args.put(KEY_DATE_TIME, reminderDateTime);

    return mDb.update(DATABASE_TABLE, args, KEY_ROWID + "=" + rowId, null) > 0;
} 
```

}

这是我的 RemindersEditActivity 的第 316-336 行：

```
//
// Saves the content by communicating with the RemindersDbAdapter.
//
private void saveState() {
    String title = mTitleText.getText().toString();
    String body = mBodyText.getText().toString();

    String path = (String)mImageView.getTag();

    SimpleDateFormat dateTimeFormat = new SimpleDateFormat(DATE_TIME_FORMAT);
    String reminderDateTime = dateTimeFormat.format(mCalendar.getTime());

    // Creates a new reminder if the value is null.
    if (mRowId == null) {
        long id = mDbHelper.createReminder(title, body, path, reminderDateTime);
        if (id > 0) {
            mRowId = id;
        } 
    // Updates the reminder if the content is not null.     
    } else {
        mDbHelper.updateReminder(mRowId, title, body, path, reminderDateTime);

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T22:19:14.537

好吧，您拥有的唯一约束是“非空”，因此请尽量不要插入具有空值的列。

它来自您的更新，因此请使用调试器检查所有传入的参数是否为空。

您的其他选择当然是删除非空约束（需要更新/重新创建数据库）。

# asp.net - 传递了错误的模型项（部分视图）

> ID：10905731
> 
> 赞同：1
> 
> 时间：2012-06-05T22:13:08.080
> 
> 标签：asp.net, asp.net-mvc-2, partial-views

我正在使用 ASP.NET MVC 2 和 VS 2010。我有两个视图：
**view1**用于在数据库中创建记录。
**view2**用于列出数据库中的数据。

我正在尝试*合并*这些视图，以便我可以使用 4 个 .aspx 文件在一个 .aspx 文件中看到它们：
Views/Shared/view1.aspx
Views/Shared/view2.aspx
Views/Home/index.aspx（这里是部分视图的代码）
Views/Shared/ChartLayout.Master （这个根本不是必需的，它只是用于 CSS 测试）

**错误**：传入字典的模型项的类型为“System.Data.Objects.ObjectSet`1[BookingApp.Models.BookingTableSet]”，但此字典需要“BookingApp.Models.BookingTableSet”类型的模型项。

如果我将 view1 留空，一切正常。

这是我的代码，

**索引.aspx**：

```
<%@ Page Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage" %>
<asp:Content ID="indexTitle" ContentPlaceHolderID="TitleContent" runat="server">
Home Page
</asp:Content>

<asp:Content ID="indexContent" ContentPlaceHolderID="MainContent" runat="server">
<h2><%= Html.Encode(ViewData["Message"]) %></h2>
<div style="float:left"><%Html.RenderPartial("view1"); %></div>
<div style="float:left"><%Html.RenderPartial("view2"); %></div>
<div style="clear:both">
</div>  
</asp:Content> 
```

**视图1.aspx**：

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master"      Inherits="System.Web.Mvc.ViewPage<BookingApp.Models.BookingTableSet>"  %>
<asp:Content ID="Content1" ContentPlaceHolderID="TitleContent" runat="server">
Create
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">
<h2>Create</h2>
<% using (Html.BeginForm()) {%>
    <%: Html.ValidationSummary(true) %>

    <fieldset>
        <legend>Fields</legend>

        <div class="editor-label">
            <%: Html.LabelFor(model => model.Id) %>
        </div>
        <div class="editor-field">
            <%: Html.TextBoxFor(model => model.Id) %>
            <%: Html.ValidationMessageFor(model => model.Id) %>
        </div>

        <div class="editor-label">
            <%: Html.LabelFor(model => model.Name) %>
        </div>
        <div class="editor-field">
            <%: Html.TextBoxFor(model => model.Name) %>
            <%: Html.ValidationMessageFor(model => model.Name) %>
        </div>

        <div class="editor-label">
            <%: Html.LabelFor(model => model.Quality) %>
        </div>
        <div class="editor-field">
            <%: Html.TextBoxFor(model => model.Quality) %>
            <%: Html.ValidationMessageFor(model => model.Quality) %>
        </div>

        <div class="editor-label">
            <%: Html.LabelFor(model => model.IsBooked) %>
        </div>
        <div class="editor-field">
            <%: Html.TextBoxFor(model => model.IsBooked) %>
            <%: Html.ValidationMessageFor(model => model.IsBooked) %>
        </div>

        <div class="editor-label">
            <%: Html.LabelFor(model => model.DataBooked) %>
        </div>
        <div class="editor-field">
            <%: Html.TextBoxFor(model => model.DataBooked) %>
            <%: Html.ValidationMessageFor(model => model.DataBooked) %>
        </div>

        <div class="editor-label">
            <%: Html.LabelFor(model => model.TimeBooked) %>
        </div>
        <div class="editor-field">
            <%: Html.TextBoxFor(model => model.TimeBooked) %>
            <%: Html.ValidationMessageFor(model => model.TimeBooked) %>
        </div>
        <p>
            <input type="submit" value="Create" />
        </p>
    </fieldset>
<% } %>
<div>
    <%: Html.ActionLink("Back to List", "Index") %>
</div>
</asp:Content> 
```

我敢打赌这与继承有关，但我不知道是什么。谢谢你的帮助。

**编辑**
Site.Master：

```
<%@ Master Language="C#" Inherits="System.Web.Mvc.ViewMasterPage" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
<title><asp:ContentPlaceHolder ID="TitleContent" runat="server" /></title>
<link href="../../Content/Site.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div class="page">
    <div id="header">
        <div id="title">
            <h1>My MVC Application</h1>
        </div>              
        <%-- %> <div id="logindisplay">
            <% Html.RenderPartial("LogOnUserControl"); %>
        </div> %>            
        <div id="menucontainer">          
           <%-- %> <ul id="menu">              
                <li><%: Html.ActionLink("Home", "Index", "Home")%></li> 
                <li><%: Html.ActionLink("About", "About", "Home")%></li> 
            </ul> --%>          
        </div>
    </div>
    <div id="main">
        <asp:ContentPlaceHolder ID="MainContent" runat="server" />
        <div id="footer">
        </div>
    </div>
</div>
</body>
</html> 
```

**控制器：**

```
[HttpPost]
    public ActionResult Create([Bind(Exclude = "Id")] BookingTableSet movieToCreate)
    {
        if (!ModelState.IsValid)
            return View();

        _db.AddToBookingTableSets(movieToCreate);
        _db.SaveChanges();
        return RedirectToAction("Index");
    } 
```

# **编辑2**：

基本上我所拥有的是这两个教程合并在一起： [http ://www.asp.net/mvc/tutorials/older-versions/movie-database/create-a-movie-database-application-in-15-minutes-with -asp-net-mvc-cs](http://www.asp.net/mvc/tutorials/older-versions/movie-database/create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-cs)

[http://jeffreypalermo.com/blog/asp-net-mvc-and-the-templated-partial-view-death-to-ascx/](http://jeffreypalermo.com/blog/asp-net-mvc-and-the-templated-partial-view-death-to-ascx/)

也许这将有助于理解我想要做什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T23:01:58.913

您需要像 Html.RenderPatial("view1", Model.BookingSet); 那样明确地传递模型

其中 BookingSet 是 view1 所需的模型

传递给控制器​​视图的视图数据字典只有一个模型，而 view1 的 aspx 需要一个不同类型的模型

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T17:04:23.130

在 Index.aspx 中做

```
 <% foreach(BookingTableSet set in Model)
     {
        Html.Render("view1", set);
     }%> 
```

再次记住，您的 view1 也有一个母版页，其中包含 html 标记，Index.aspx 也是如此。即使浏览器会呈现它，这也不是好的 html。您应该为 view1 创建一个局部视图，然后将该局部视图包含在您的视图中（Index.aspx）

# gcc - 我定义了一个名为“free”的 C 函数：如何阻止 glibc 的 printf 使用它？

> ID：10905733
> 
> 赞同：1
> 
> 时间：2012-06-05T22:13:18.737
> 
> 标签：gcc, ubuntu, glibc, ubuntu-11.10, libc

我的操作系统类分配需要定义一个名为的 C 函数`free`，它的工作方式与 libc 不同`free`。（我们正在做一个内存分配器练习。）

我所有的代码都使用我自己的变体`free`，所以在我自己的代码中这不是问题。然而，当 glibc 在`free`内部使用时（例如用于 vprintf），它最终会使用 my`free`而不是它自己的。

我正在使用 Ubuntu 11.10（libc6 版本 2.15-0ubuntu10）。我听说它不会发生在其他 Ubuntu 版本上，我想知道我是否可以通过一些编译/链接标志来获得其他版本的行为。

顺便说一句，命名自己的函数`free`不是最佳实践，但假设我别无选择:-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T22:27:20.057

如果您的函数具有外部链接，请不要命名`free`它，函数名称保留作为具有外部链接的标识符。

> （C99，7.1.3p1）“在以下任何子条款（包括未来的库方向）中具有外部链接的所有标识符始终保留用作具有外部链接的标识符。”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T22:15:55.093

如果您要替换`free`和`malloc`使用与标准函数不同的函数，那么您可能*不*应该使用 C 库中的任何其他“方便”函数。只需坚持`read(2)`并`write(2)`为您的 IO - 或编写您自己的包装器并`read(2)`提供`write(2)`各种便利功能。`getc(3)``printf(3)`

# codeigniter - Codeigniter Tank Auth 在注册时添加文件夹

> ID：10905736
> 
> 赞同：0
> 
> 时间：2012-06-05T22:13:25.197
> 
> 标签：codeigniter, tankauth

我已经下载了 Tank Auth 并尝试在用户注册时创建一个文件夹。我已经像这样在 users.php 模型中编辑了 create_user() 函数，但没有创建文件夹。我在 Windows 7 上，所以我认为这可能是一个许可问题。我关闭了UAC，但它仍然不起作用。

我希望该文件夹以 index.php 所在的根目录结尾（在应用程序文件夹之外）。

```
function create_user($data, $activated = TRUE)
    {
        $data['created'] = date('Y-m-d H:i:s');
        $data['activated'] = $activated ? 1 : 0;

        if ($this->db->insert($this->table_name, $data)) {
            $user_id = $this->db->insert_id();
            if(!is_dir("./uploads/".$user_id)){
                mkdir("./uploads/".$user_id , 0777);
            }

            if ($activated) $this->create_profile($user_id);
            return array('user_id' => $user_id);
        }
        return NULL;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T22:23:16.447

您的问题是该目录与 index.php 无关 - 它必须是绝对的 index.php

改变

```
 if(!is_dir("./uploads/".$user_id)){
            mkdir("./uploads/".$user_id , 0777); 
```

到

```
if(!is_dir(FCPATH.$user_id)){
            mkdir(FCPATH.$user_id , 0777); 
```

# oracle - 什么时候在 Oracle 的查询中评估用户定义的函数？

> ID：10905738
> 
> 赞同：6
> 
> 时间：2012-06-05T22:13:35.663
> 
> 标签：oracle, plsql, oracle9i

在 SELECT 语句中使用用户定义的函数时，我遇到了一些有趣的行为。

我有几个存储过程可以从单个表中读取和清除数据。这些存储过程被多个来源使用。

在我的观察中，似乎用户定义的函数有时会被任意评估，并不总是在执行它所使用的 SELECT 语句之后或期间立即进行评估。

例如，在一个存储过程中，我有一个 select 语句可能看起来像这样：

```
SELECT Something, MyFunction(Something) FROM Somewhere; 
```

随后调用另一个存储过程，从表中清除数据。清除的数据量由另一个表控制，该表存储读取的最大 ID。这样一来，清除不应删除尚未被正在执行的存储过程的另一个实例读取的任何数据。

在我的测试代码中，MyFunction 只返回某处表中的行数。因此，我想它应该总是等于 SELECT 语句返回的行数。但是，在我运行此存储过程的两个实例的情况下，我会得到如下结果：

第一个查询实例：

```
Something  MyFunction(Something)
---------  ---------------------
A          3
B          3
C          3 
```

第二个查询实例：

```
Something  MyFunction(Something)
---------  ---------------------
A          0
B          0
C          0 
```

为什么第二个查询返回所有行，但对同一张表进行操作的用户定义函数报告表中没有更多行？

无论如何我可以确保第二个查询实例是一致的，因为用户定义的函数仍然看到父存储过程看到的相同数据？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-05T23:28:56.790

一般来说，您看到的问题是由于 Oracle 的多版本读取一致性确保单个 SQL 语句将始终看到一致的数据视图，但相同的一致性并不意味着每个 SQL 语句都由一个原始 SQL 语句调用的函数将看到与原始语句相同的数据集。

实际上，这意味着类似

```
SELECT something,
       COUNT(*) OVER ()
  FROM table_name 
```

如果您将完全相同的逻辑放入函数中，将始终返回正确答案（如果查询返回 3 行，则返回 3）

```
CREATE OR REPLACE FUNCTION count_table_name
  RETURN NUMBER
AS
  l_cnt INTEGER;
BEGIN
  SELECT COUNT(*)
    INTO l_cnt
    FROM table_name;
  RETURN l_cnt;
END; 
```

那个 SQL 语句

```
SELECT something,
       count_table_name
  FROM table_name 
```

不一定会返回与表中的行数匹配的值（也不一定会为每一行返回相同的结果）。如果您在函数中构建延迟以便您可以在单独的会话中修改数据，您可以看到这一点。例如

```
SQL> create table foo( col1 number );

Table created.

SQL> insert into foo select level from dual connect by level <= 3;

3 rows created. 
```

创建一个函数，每行添加 10 秒延迟

```
SQL> ed
Wrote file afiedt.buf

  1  create or replace function fn_count_foo
  2    return number
  3  is
  4    l_cnt  integer;
  5  begin
  6    select count(*)
  7      into l_cnt
  8      from foo;
  9    dbms_lock.sleep(10);
 10    return l_cnt;
 11* end;
 12  /

Function created. 
```

现在，如果在会话 1 中，我开始声明

```
select col1, fn_count_foo
  from foo; 
```

然后切换到会话 2，在其中插入新行

```
SQL> insert into foo values( 4 );

1 row created.

SQL> commit;

Commit complete. 
```

您可以看到该函数在第二次执行期间看到了新提交的行，尽管 SQL 语句本身只看到 3 行

```
SQL> select col1, fn_count_foo
  2    from foo;

      COL1 FN_COUNT_FOO
---------- ------------
         1            3
         2            4
         3            4 
```

您可以通过让会话在执行 SQL 语句之前使用可序列化事务隔离级别来避免该问题。所以，例如，

在会话 1 中，将事务隔离级别设置为可序列化并启动查询

```
SQL> set transaction isolation level serializable;

Transaction set.

SQL> select col1, fn_count_foo
  2    from foo; 
```

在会话 2 中，插入一个新行

```
SQL> insert into foo values( 5 );

1 row created.

SQL> commit;

Commit complete. 
```

当 Session 1 在 40 秒后返回时，一切都是一致的

```
SQL> select col1, fn_count_foo
  2    from foo;

      COL1 FN_COUNT_FOO
---------- ------------
         1            4
         2            4
         3            4
         4            4 
```

# git - 如何仅使用推送直接推送到远程服务器？

> ID：10905739
> 
> 赞同：-1
> 
> 时间：2012-06-05T22:13:36.880
> 
> 标签：git, branch, push

我有一个远程`git`存储库，我将它克隆到我的本地存储库，进行了本地更改，当我推送时，我收到了我无法推送到主分支的消息：

> [远程拒绝] master -> master（当前已签出分支）

我读到如果我改变它工作的分支，我就会这样做并且工作，但我不能那样工作；我需要当我将更改从本地存储库推送到远程存储库时，更改同时应用于远程存储库上的文件，我不想返回主分支或合并分支。

我也读到我可以使用裸存储库，它对我不起作用。

我看到一些视频，人们直接推送到远程存储库，只需要输入密码，但我不知道如何做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:28:51.600

> 我也读到我可以使用裸存储库，它对我不起作用。

但是，如果您发现[使用 Git 管理网站](http://toroid.org/ams/git-website-howto)中描述的过程正在使用带有 post-receive 钩子的**裸**仓库（您推送到该仓库），它应该对您有用：

```
$ mkdir /var/www/www.example.org
$ cat > hooks/post-receive
#!/bin/sh
GIT_WORK_TREE=/var/www/www.example.org git checkout -f
$ chmod +x hooks/post-receive 
```

在您的情况下，优点是钩子可以检查您需要的任何分支。

注意：密码短语可能与使用 ssh 推送地址和使用受密码保护的私有 ssh 密钥有关。

# c++ - volatile 不适合任何范式

> ID：10905741
> 
> 赞同：0
> 
> 时间：2012-06-05T22:13:48.527
> 
> 标签：c++, c, thread-safety, mutex, volatile

只有我这么想吗？[一秒钟的真正问题。]

除了关于它的巨大混乱，以及它与互斥锁或其他锁定机制的混合，当我处理线程安全情况时，我总是不得不放弃任何使用`volatile`，因为它根本没有做任何有用的事情。

`volatile`“禁止对读/写进行任何重新排序或缓存”，但这并没有多大用处，只要`volatile` *标记一个对象*（并污染它，因为它不再是“正常”对象）。

考虑一下：

```
Thread A            Thread B
reads vars
                    locks mutex (gets access)
locks mutex (waits)
                    writes some vars
                    releases mutex
reads vars again
releases mutex 
```

现在，编译器可能想要优化两个线程 A 的读取，将一些结果保存在寄存器中。你说我应该将这些变量声明为`volatile`. 我说我不想将所有内容都标记为`volatile`，因为`volatile`它是透明的，我必须复制 50% 的代码来支持`volatile`类型。你（[他](https://stackoverflow.com/a/1682309/1073006 "他")) 说锁定互斥锁（至少是 POSIX 互斥锁）要么是编译器可以识别并正确管理的东西，要么是对可以改变世界的库（编译器无法访问）的调用，因此编译器不会假设在这样的电话之后的任何事情。我说这太依赖于实现，非常低级的东西（我不想浏览开发文档进行日常编程）。更糟糕的是，如果由于某种原因“外部库”，出于任何合法原因，编译器可以访问，它可能会突然改变（也许作者将函数转换为必须包含在头文件中的模板......无论如何） .

因此，在我看来，`volatile`这是完全没用的（并且具有误导性），除非对于一些非常低级的东西（可能是设备读取，但我在这个领域不胜任）。

更好的是用其他方式*明确*告诉编译器它必须放弃关于*任何变量的**任何*假设，并且每次后续读取都必须是从内存中真正读取。但我想不出有什么比调用一个虚拟外部函数更好的了，这会产生我之前概述的相同问题。有没有一种优雅的方式来做到这一点？

 ** * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-05T22:19:46.423

我使用低级的东西，这是一个有用的例子。

```
volatile uint32_t *foo = <<<a register on a pci device>>> 
```

有可能在`foo`多次阅读时，我会得到不同的结果。这是因为外部源（pci 设备）正在修改它。例如，`foo`可能表示当前时间。

也有可能当我写信给`foo`时，它与可能发生的事情几乎没有关系。例如，我可能有一个存储一些警报位的寄存器。我将写入这些位以清除它们。因此，如果一个寄存器`foo`具有 value `0x72`，我可能会写入`0x2`该寄存器，这可能导致该寄存器中的结果值为`0x70`。

`volatile`允许我使用这些语义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T22:20:53.127

Volatile 并不是一种解决多线程代码问题的方法。当变量或内存位置的值可以在编译器（甚至 CPU）没有任何方式知道的情况下更改时使用它

请参阅[C++ 中的 Volatile 类以](https://stackoverflow.com/questions/3854992/volatile-classes-in-c)获得更完整的解释

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-05T22:21:16.313

新的 C 标准 C11 满足您的要求。首先，它有一个线程模型和一个延伸到线程的详细的“之前发生过”关系。它有一个`atomic_thread_fence`可以做你正在搜索的操作。*

# android - DDMS Android 文件资源管理器显示点文件夹

> ID：10905744
> 
> 赞同：3
> 
> 时间：2012-06-05T22:14:23.300
> 
> 标签：android, eclipse, ddms

如何让 DDMS 中的文件资源管理器显示以点开头的文件夹。

例如，/mnt/.test 不会出现在 DDMS 中。有没有办法显示它？

我知道我可以使用`adb shell`. 我在问是否有办法用 DDMS 做到这一点。

**编辑：** 我在 DDMS 中提交了一个补丁来解决这个问题：[https](https://android-review.googlesource.com/#/c/37801/) : //android-review.googlesource.com/#/c/37801/ 基本上你可以用补丁重建 ddmlib 并将其放入 eclipse 中，你将能够看到以点开头的文件和文件夹。

**编辑 2：** 我已经上传了修补的[ddmlib.jar](http://carlosrendon.me/wp-content/uploads/2012/06/ddmlib.jar)，因为仅为这个补丁构建 Android 需要大量的工作。

要使用，你只需要弄清楚 eclipse 从哪里加载这个 jar 并将它放在那里。在我的 Windows 机器上是`eclipse\configuration\org.eclipse.osgi\bundles\355\1\.cp\libs`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T01:03:48.017

看起来*至少*你需要做一些改变

```
Thread t = new Thread("ls " + entry.getFullPath()) { //$NON-NLS-1$ 
```

到

```
Thread t = new Thread("ls -a" + entry.getFullPath()) { //$NON-NLS-1$ 
```

在 DDMS 源中 com.android.ddmlib.FileListingService 的 doLsAndThrow() 方法中的 getChildren() 方法和对 ls -la 的类似更改。

您可能还必须在其他地方进行更改才能获得以 . 要全面处理。

（就我个人而言，我会坚持使用外壳）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T22:42:18.863

我不认为这很容易。请参阅此[帖子](https://stackoverflow.com/questions/6838880/pulling-hidden-files-in-android-sd-card)。更多信息在[这里](http://developer.android.com/guide/developing/tools/adb.html#shellcommands)。

他们的解决方案是使用命令行遍历文件。试试看。

# c++ - 使用 SWIG 包装 octave 的 C++ API

> ID：10905750
> 
> 赞同：3
> 
> 时间：2012-06-05T22:14:55.450
> 
> 标签：c++, d, swig, octave

使用 SWIG 包装 octave 的 C++ API 的最佳方法是什么？

我所需要的只是接口文件（类似于 wrap_octave.i），它可用于为另一种语言生成包装器（在我的情况下为 D，但没关系）。

我可以通过在接口文件中显式编写单个函数来包装单个函数，但这很费力。如果我在接口文件中 %include 头文件，则不清楚要包含哪些头文件而不产生编译器错误。注意：包装器的目标语言不是八度；相反，我想通过 C++ api 在另一种语言中使用嵌入式八度音程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T20:20:42.437

我不确定您想要什么，但 SWIG 不提供简单的快捷方式，例如“不要包装任何不受支持的东西”。它不会 %include 递归，这通常可以避免包装您不想要的东西，但这意味着您需要手动管理 %include 订单。如果您以错误的顺序提供依赖项，SWIG 可能会生成不正确的代码而不会发出错误或警告消息。

在我的库中，我可以控制头文件，因此我可以轻松排除我不想要的东西，例如

```
#ifdef SWIG
#define INTERNAL protected
#else
#define INTERNAL public
#endif

class Foo {
public:
    void Bar();
INTERNAL: // hide from SWIG
    void Baz();
}; 
```

因此，一种选择是复制标题并修改它们，直到它们适合 SWIG，或者只是去掉你不想包装的所有内容。在许多情况下，您还可以 % 包含未修改的标头，并 % 忽略您不想要的类和函数。

如果您想对某些数据类型进行特殊处理，请准备好使用类型映射。

# sed - sed 除了 \U 还有什么其他参数？

> ID：10905751
> 
> 赞同：2
> 
> 时间：2012-06-05T22:15:13.230
> 
> 标签：sed

我已经知道`sed`'s `\1`, `\2`, ... ，`\n`最近[发现](https://stackoverflow.com/questions/10899545/using-sed-to-change-only-consecutive-repeated-letters)它有一个有用的`\U`选项来创建大写。除了这些有用的“反斜杠选项”还有`\U`哪些？

我检查了`sed`手册页，但在那里没有找到对它的引用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T23:01:02.403

根据[CodeGnome](https://stackoverflow.com/users/1301972/codegnome)传递的链接，这些是：

`\L` 将替换变为小写，直到找到 \U 或 \E，

`\l` 将下一个字符转为小写，

`\U` 将替换变为大写，直到找到 \L 或 \E，

`\u` 将下一个字符转为大写，

`\E` 由 \L 或 \U 启动的停止大小写转换。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-05T22:29:08.413

很可能您想要这些优秀的 GNU sed 文档部分之一：

*   [反向引用，在正则表达式中](http://www.gnu.org/software/sed/manual/sed.html#index-Backreferences_002c-in-regular-expressions-103)
*   [正则表达式中转义的 GNU 扩展](http://www.gnu.org/software/sed/manual/sed.html#Escapes)

# javascript - Rails 3 - 从 textarea 识别属性并获取它（如果可用）

> ID：10905756
> 
> 赞同：1
> 
> 时间：2012-06-05T22:16:23.430
> 
> 标签：javascript, regex, ruby-on-rails-3, textarea, quotes

我真的很想从头开始构建它，这不是对完整代码工作解决方案的要求，但我根本不知道从哪里开始以及我需要使用和处理什么。

我有一个评论模型，目前我正在努力让用户引用其他用户的评论。每个评论都有一个迭代ID，用户应该简单地写“#24”，例如，在他们的评论表单文本区域中，引用评论#24。我希望我的应用程序在评论表单文本区域中查找这类片段“#[id]”，如果可用，对它们执行操作。

正如我所说，我不希望任何人向我提供此功能所需的所有代码，但我不确定如何实现此功能。
除其他外，我会使用 Regex 函数来执行此操作吗？

还有另一个相关的问题，我不想为此创建自己的主题：我希望用户能够简单地单击显示为“#16”链接的评论 ID，然后单击“#16”应该出现在评论表单中，在用户开始实际写评论之前。我会用 Javascript 处理这样的事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T09:43:59.557

**对于您的第一个问题**：

我将使用正则表达式来捕获以 # 开头并后跟数字的字符串。您可以在 rubular 上尝试您的正则表达式：[http: //rubular.com/](http://rubular.com/)

例如，这个正则表达式应该可以工作：

```
\s(#[1-9]+)\s 
```

（它使用“空格”+“#”+任何数字+“空格”来占用您的文本的所有部分

**对于您的第二个问题**，我将使用 javascript 将字符串 #16 添加到您的文本区域

在 jQuery 中：

```
$('textarea').val($('textarea').val()+' #16'); 
```

# list - 如何将带有集合的元组列表转换为字典？

> ID：10905758
> 
> 赞同：2
> 
> 时间：2012-06-05T22:16:35.063
> 
> 标签：list, tuples, python, set

我有这个数据集。我想更新 MySQL 表。我可以以当前的形式做到这一点，但我认为转换为字典会缩小要更新的列表。

**我的数据集：**

```
dataset = [('121', set(['NY'])), ('132', set(['CA', 'NY'])), ('198', set(['NY'])), ('676', set(['NY'])), ('89', set(['NY', 'CA']))] 
```

**期望的输出：**

一本字典 ：

```
output = {'set(['NY'])':121,198,676, 'set(['CA', 'NY'])':132,89} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T22:41:38.287

您***必须***使用 freezeset 作为密钥。不能保证具有相同元素的集合总是会变成相同的`repr`，或者`tuple`因为集合是无序的。当然，除非您首先对集合元素进行排序，但这似乎很浪费

```
from collections import defaultdict

dataset = [('121', set(['NY'])), ('132', set(['CA', 'NY'])), ('198', set(['NY'])), ('676', set(['NY'])), ('89', set(['NY', 'CA']))]
output = defaultdict(list)
for value, key in dataset:
    output[frozenset(key)].append(value) 
```

或使用排序的元组

```
from collections import defaultdict

dataset = [('121', set(['NY'])), ('132', set(['CA', 'NY'])), ('198', set(['NY'])), ('676', set(['NY'])), ('89', set(['NY', 'CA']))]
output = defaultdict(list)
for value, key in dataset:
    output[tuple(sorted(key))].append(value) 
```

一个随机的例子来说明这一点

```
>>> s,t = set([736, 9753, 7126, 7907, 3350]), set([3350, 7907, 7126, 9753, 736])
>>> s == t
True
>>> tuple(s) == tuple(t)
False
>>> frozenset(s) == frozenset(t)
True
>>> hash(tuple(s)) == hash(tuple(t))
False
>>> hash(frozenset(s)) == hash(frozenset(t))
True 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T22:20:33.247

我认为您不能将 a`set`作为字典键，所以也许是元组？

```
from collections import defaultdict

dataset = [('121', set(['NY'])), ('132', set(['CA', 'NY'])), ('198', set(['NY'])), ('676', set(['NY'])), ('89', set(['NY', 'CA']))]
output = defaultdict(list)
for value, key in dataset:
    output[tuple(key)].append(value)
    # or output[str(key)].append(value) if you want a string as the key 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T22:22:55.340

尝试这个：

```
dataset = [('121', set(['NY'])), ('132', set(['CA', 'NY'])), ('198', set(['NY'])), ('676', set(['NY'])), ('89', set(['NY', 'CA']))]
from collections import defaultdict
d = defaultdict(list)

for val, key in dataset:
    d[repr(key)].append(int(val))

d
> {"set(['NY', 'CA'])": [132, 89], "set(['NY'])": [121, 198, 676]} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-05T23:08:38.587

这是一个替代方案`defaultdict`：

```
dataset = [('121', set(['NY'])), ('132', set(['CA', 'NY'])), ('198', set(['NY'])), ('676', set(['NY'])), ('89', set(['NY', 'CA']))]    

output = {}
for value, key in dataset:
   output.setdefault(frozenset(key), []).append(value) 
```

结果：

```
>>> output
{frozenset(['NY', 'CA']): ['132', '89'], frozenset(['NY']): ['121', '198', '676']} 
```

由于以下行为，我更喜欢`setdefault()`在这里使用：`defaultdict`

```
>>> output = defaultdict(list, {frozenset(['NY', 'CA']): ['132', '89'], frozenset(['NY']): ['121', '198', '676']})
>>> output[frozenset(['FL'])]    # instead of a key error, this modifies output
[]
>>> output
defaultdict(<type 'list'>, {frozenset(['NY', 'CA']): ['132', '89'], frozenset(['FL']): [], frozenset(['NY']): ['121', '198', '676']}) 
```

# c++ - C++ 在 STL 列表上打印数据

> ID：10905761
> 
> 赞同：0
> 
> 时间：2012-06-05T22:17:06.003
> 
> 标签：c++, list, printing, stl

我有一个基类和一个派生类；另一方面，我制作了一个使用 STL 的 List 类。基类有一个名为 的虚函数`PrintData()`，它打印一个属于基类的整数。在派生类中；同一个函数`printData()`打印一个属于 Derived 的整数和另一个来自 Base 类的整数。

问题是，在 List 类中，我只是从 Base 获取数据，无论我是否在列表中插入了 Derived 实例。

我需要打印派生数据，也应该有基础数据。这是代码：

```
 #pragma once;
#include <iostream>
#include <sstream>
using namespace std;

class Base{
protected:
    int x;

public:
    Base(){
        x=3;
    }
    void setX(int a){
        x=a;
    }
    int getX(){
        return x;
    }
    virtual string printData(){
        stringstream f;
        f<<getX()<<endl;
        return f.str();
    }
};

class Derived : public Base{

    int a;

public:
    Derived(){
        this->Base::Base();
        a=4;
    }
    void setA(int x){
        a=x;
    }
    int getA(){
        return a;
    }
    string printData(){
        stringstream a;
        a<<getA()<<getX()<<endl;
        return a.str();
    }

}; 
```

这是 List 类：

```
 #pragma once;
#include "Prueba.cpp"
#include <list>

    class Lista{
        list<Base*> lp;
    public:
        Lista(){

        }

        void pushFront(Base* c){
            lp.push_front(c);
        }

        void pushBack(Base* c){
            lp.push_back(c);
        }

        void printList(){

            list<Base*>::const_iterator itr;
                for(itr=lp.begin(); itr!=lp.end(); itr++){ 
                    cout<<(*itr)->printData(); 

                }
        }

         ~Lista(){

        }
    };

    int main(){
        Derived* d=new Derived();
        Lista* l=new Lista();
        l->pushFront(d);
        l->printList();
        system("Pause");
        return 0;
    } 
```

我只是获取基类数据，即值为 3 的整数。但我没有从 Derived 获取值为 4 的整数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T22:27:13.270

代替

```
 a<<getA()<<getX()<<endl; 
```

和

```
 a<<getA()<<" "<<getX()<<endl; 
```

并再次运行它。我怀疑您的代码确实打印了这两个值，只是它掩盖了事实。可以这么说，新线剥去了伪装。

顺便说一句，@MarkRansom 是对的。没有必要显式调用 Base 构造函数。（事实上​​，当我尝试你的代码时，我的编译器甚至不允许它。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T17:50:20.410

我编译了您的代码代码，它在`Derived`构造函数中导致编译错误。尝试将`Derived`构造函数更改为

```
Derived() : Base()
{
    a = 4;
} 
```

我试过了，它可以正常工作。

**注意：**如果您想同时打印 3 和 4，您应该插入`Lista`唯一的`Derived*`对象。

# php - PHP/MYSQL - 函数 mysqli_data_seek() 和 mysqli_fetch_assoc() 在实时站点上产生错误，但在本地开发中不产生错误？

> ID：10905762
> 
> 赞同：-1
> 
> 时间：2012-06-05T22:17:10.780
> 
> 标签：php, function, mysqli

我的一个脚本有问题。基本上发生的是我使用`mysqli_data_seek()`并`mysqli_fetch_assoc()`产生以下错误：

```
Warning: mysqli_data_seek() expects parameter 1 to be mysqli_result, boolean given in /usr/home/myacc/includes/html/shop/categoryMain.html.php on line 49
Warning: mysqli_fetch_assoc() expects parameter 1 to be mysqli_result, boolean given in /usr/home/myacc/includes/html/shop/categoryMain.html.php on line 50 
```

这是与这两行相关的代码：

```
mysqli_data_seek($subsSql, 0);
while($rowSubs = mysqli_fetch_assoc($subsSql)) 
```

这些错误仅在脚本在我的托管（实时）网站上运行时发生。在我的本地开发（最新版本的 WAMP）中，这个脚本运行没有错误并产生预期的效果......

这是完整上下文中的脚本：

```
//categories to local array
$catsQuery = "
    SELECT id, category, catDirPath
    FROM categories
    ORDER BY category
";
$catsSql = mysqli_query($link, $catsQuery);
$cats = array();
mysqli_data_seek($catsSql, 0);
while($rowCats = mysqli_fetch_assoc($catsSql))
{
    $cats[$rowCats['id']]['catName'] = $rowCats['category'];
    $cats[$rowCats['id']]['catPath'] = $rowCats['catDirPath'];
}

// subCats to local array
$subsQuery = "
    SELECT id, subCat, category_id, subDirPath
    FROM subCats, sub_categories
    WHERE subCats.id = sub_categories.sub_id
    ORDER BY subCat
";
$subsSql = mysqli_query($link, $subsQuery);
$subs = array();
mysqli_data_seek($subsSql, 0);
while($rowSubs = mysqli_fetch_assoc($subsSql))
{
    $subs[$rowSubs['id']]['subName'] = $rowSubs['subCat'];
    $subs[$rowSubs['id']]['catId'] = $rowSubs['category_id'];
    $subs[$rowSubs['id']]['subPath'] = $rowSubs['subDirPath'];
}

// loop through categories and if subs exist, add to resultset and display
foreach ($cats as $catId => $cat)
{
    ...
            foreach ($subs as $subId => $sub)
            {
                ...
            }
    ...
} 
```

有人会偶然发现我编写此脚本的方式存在问题，或者可能提出一个原因，说明为什么这将通过 wamp 而不是与我的网络主机一起使用的 apache 服务器工作？

任何与此相关的建议或意见将不胜感激！

感谢您花时间阅读本文！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:22:59.043

mysqli_query[的文档说](http://ca2.php.net/mysqli_query)

> 失败时返回 FALSE。对于成功的 SELECT、SHOW、DESCRIBE 或 EXPLAIN 查询，mysqli_query() 将返回一个 mysqli_result 对象。对于其他成功的查询，mysqli_query() 将返回 TRUE。

这意味着您的查询失败。确保**$link**连接正常，并仔细检查**$subsQuery**和**$catsSql**的语法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T22:34:56.917

我发现对 table: 的引用`subCats`不正确。此表的实际名称是`subcats`. 在本地版本中，它似乎不区分大小写，而在托管版本中，它是区分大小写的。

如果有人可以向我解释这背后的原因，答案将是这样！

谢谢！

# html - django：如何将动态变量添加到 HTML 中的地址？

> ID：10905763
> 
> 赞同：0
> 
> 时间：2012-06-05T22:17:13.477
> 
> 标签：html, django

我需要将一个动态变量放入 django 表单上的地址中。表格是：

```
<form action='/disciplinas/{{disciplina_id}}/edit/' method='submit'>{% csrf_token %}
<input type='submit' value='Voltar'>
</form> 
```

问题出在我写“{{disciplina_id}}”的“动作”上，我该如何表示？

view.py 函数

```
def detail(request, disciplina_id):
  nome = disciplina.objects.filter(id__exact=disciplina_id)
  if request.method == 'POST':
    return HttpResponseRedirect('^(?P<disciplina_id>\d+)')
  if request.method == 'POST':
    nome.delete()
    return HttpResponseRedirect('/disciplinas/success')
  return render_to_response('/home/zephir/Template/disciplinas/detail.html', {'nome': nome}, context_instance=RequestContext(request)) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T22:35:41.993

`url`使用模板标签构建映射到模板中特定视图的 url ： [https ://docs.djangoproject.com/en/1.4/ref/templates/builtins/#url](https://docs.djangoproject.com/en/1.4/ref/templates/builtins/#url)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T22:48:08.283

听起来您想将上下文变量注入模板。

```
def my_view(request, disciplina_id):
    nome = disciplina.objects.get(id__exact=disciplina_id)
    return render_to_response('/home/zephir/Template/disciplinas/detail.html', {'nome': nome, 'disciplina_id': disciplina_id}, context_instance=RequestContext(request)) 
```

看到那本字典了吗？其中包含可用于您的模板的变量映射。或者更简单地说：

```
def my_view(request, disciplina_id):
    nome = disciplina.objects.get(id__exact=disciplina_id)
    return render_to_response('/home/zephir/Template/disciplinas/detail.html', {'nome': nome}, context_instance=RequestContext(request))

<form action='/disciplinas/{{nome.id}}/edit/' method='submit'>{% csrf_token %}
    <input type='submit' value='Voltar'>
</form> 
```

由于您已经通过`disciplina`实例，只需`id`在模板中访问它的属性。

我故意避免评论您的视图结构（两次检查`method=='POST'`），但您可能想要修复它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T03:07:23.807

由于您将 nome 对象传递给模板，因此您应该通过其名称引用 itsd 属性，如下所示，

```
<form action='/disciplinas/{{nome.disciplina_id}}/edit/' method='submit'>{% csrf_token %}
<input type='submit' value='Voltar'>
</form> 
```

# asp.net-mvc-3 - 自定义 WebMatrix.Security

> ID：10905769
> 
> 赞同：0
> 
> 时间：2012-06-05T22:17:40.247
> 
> 标签：asp.net-mvc-3, webmatrix

在我的 MVC 应用程序中，我使用了来自 WebMatrix 的一些安全功能 (OAuth)。
但是，我需要进行一些更改，因此我使用[CodePlex](http://aspnetwebstack.codeplex.com/)上提供的代码分叉了该项目并向**WebMatrix.WebData**程序集添加了一些功能。

现在我尝试在我的应用程序上使用这些功能，我发现**WebMatrix.Security**程序集的源代码不可用，因此我添加的新功能无法使用，因为它们位于**WebMatrix.Security后面（通过**[这个 NuGet](http://nuget.org/packages/WebMatrix.Security)添加到我的项目中）。

关于如何利用 WebMatrix.Security 中内置的功能并能够根据我的某些特定需求对其进行自定义的任何想法？
或者我可以获得 WebMatrix.Security 源代码吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T16:26:23.277

作为*部分*答案，我可以说**WebMatrix.Security**的源代码实际上是可用的，但程序集已重命名为**Microsoft.Web.WebPages.OAuth**，正如[Marcin Dobosz](https://stackoverflow.com/users/358970/marcind)在此[讨论](http://aspnetwebstack.codeplex.com/discussions/359176)中指出的那样。

# jquery - 从嵌套的小部件触发事件

> ID：10905770
> 
> 赞同：0
> 
> 时间：2012-06-05T22:17:46.643
> 
> 标签：jquery, jquery-ui, jquery-plugins

我构建了一个非常简单的 jquery ui 小部件，它只创建一个滑块并尝试使幻灯片事件冒泡。代码如下。但是， this._trigger 在此上下文中未定义。在这种情况下，我将如何重新触发事件？

```
(function($) {
    $.widget("ui.timelineSlider", {
        options : {
        },

        _create : function() {
            var self = this;
            var element = self.element;
            var options = self.options;

            element.slider({
            slide:function (e, ui) {
                        this._trigger("slideHappened", null, {date: ui.value});
                }
            });
        },

        destroy : function() {
            this.element.next().remove();
        },

        _setOption : function(option, value) {
        }
    });
})(jQuery); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T01:34:05.403

`this`jQuery 将在通过它绑定到事件发生所在的 DOM 节点的事件上设置调用上下文（即）。在这种情况下，它将是`div.ui-slider`幻灯片发生的位置。

要从`slide`处理程序引用小部件，必须保存该`slide`方法可以访问的引用。幸运的是你已经有了一个`var self = this;`in `_create`。

因此，您可以简单地替换`this`为`self`并且您很好。

**现场示例**- [http://jsfiddle.net/kQYWf/](http://jsfiddle.net/kQYWf/)

# java - 在内存缓存中缓存单例

> ID：10905773
> 
> 赞同：0
> 
> 时间：2012-06-05T22:17:58.640
> 
> 标签：java, google-app-engine, memcached, jdo, datanucleus

自一年前以来，我一直在使用 Google App Engine 进行开发，并且我了解实例的预热时间有多重要。所以我最终有了一个想法：是否可以在 memcache 中缓存单例？例如，我将单例模式用于 JDO PersistenceManagerFactory。

这是我的实际代码（如文档中所述）：

```
 private static PersistenceManagerFactory pmfInstance = JDOHelper.getPersistenceManagerFactory(<my-name>); 
```

扩展 JDOHelper 并编写如下函数是否有任何意义：

```
public static PersistenceManagerFactory getPersistenceManagerFactoryCached(String name) {
    MemcacheService cache = MemcacheServiceFactory.getMemcacheService();;
    PersistenceManagerFactory staticPMF= null;
    if (cache.contains("JDO_PMF")) {
        staticPMF = (PersistenceManagerFactory) cache.get("JDO_PMF");
    } else {
        staticPMF = JDOHelper.getPersistenceManagerFactory(name);
        cache.put("JDO_PMF", staticPMF);
    }
    return staticPMF;
} 
```

我的想法应该是缓存 PersistenceManagerFactory 以加速第一个实例，然后将其用作单例：

```
private static PersistenceManagerFactory pmfInstance = JDOHelperCached.getPersistenceManagerFactory(<my-name>); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T23:53:00.057

编辑：刚刚找到这个链接，似乎不同的实例无法根据 Ikai Lan 在[https://groups.google.com/group/google-appengine-java/browse_thread/thread/1b90fae408b52d49共享 PersistenceManagerFactory 实例](https://groups.google.com/group/google-appengine-java/browse_thread/thread/1b90fae408b52d49)

==================================================== =========================

我喜欢这个主意，并且我已经立即尝试了我的代码，但不幸的是我遇到了这样的错误：

```
javax.jdo.JDOFatalUserException: No available StoreManager found for the datastore URL key "". Please make sure you have all relevant plugins in the CLASSPATH (e.g datanucleus-rdbms?, datanucleus-db4o?), and consider setting the persistence property "datanucleus.storeManagerType" to the type of store you are using e.g rdbms, db4o 
```

也许这只是我的问题，但现阶段我无法判断。

我已经考虑了更多：

因此，让我们假设您建议的方式是有效的，并且您可以获得所需的正确工厂。真正的性能取决于你如何使用你的内存缓存。

1）如果你的内存缓存中有很多写入，那么这意味着 PersistenceManagerFactory 可能会经常被踢出缓存，这意味着你需要重新创建它。

2) 每次创建新的 PersistenceManagerFactory 时，您都会将缓存放入缓存，根据我处理 GAE 的经验，缓存非常不稳定，有时放入的部分可能比您预期的要长得多。

# javascript - 用javascript替换类名

> ID：10905774
> 
> 赞同：0
> 
> 时间：2012-06-05T22:18:00.637
> 
> 标签：javascript

我需要帮助查找具有特定类名的元素，然后将其替换为新的类名。这是我想出的代码。我没有得到任何结果。类名没有变化，控制台也没有错误。

**更新代码**：

```
var classMatches = document.querySelectorAll(".crux.attachFlash");
for (var i = 0; i < classMatches.length; i++) {
    classMatches[i].className = " ";
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T22:19:59.433

因为您需要修改匹配元素的类名，而不是元素数组：

```
var classMatches = document.querySelectorAll(".crux.attachFlash");
for (var i = 0; i < classMatches.length; i++) {
    classMatches[i].className = " ";
} 
```

您忘记了`[i]`索引，因此您试图`className`为整个数组设置（正如您所发现的那样，这不起作用）。

# android - Android LayoutInflater 问题

> ID：10905777
> 
> 赞同：5
> 
> 时间：2012-06-05T22:18:06.097
> 
> 标签：android, layout-inflater

这是我的类 DownloadableProjectsFromWebAdapter 的 getView 方法：

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {
    View row = convertView;
    DownloadableProjectsFromWebHolder holder = null;

    if(row == null)
    {
        LayoutInflater inflater = ((Activity)context).getLayoutInflater();
        row = inflater.inflate(layoutResourceId, parent, false);

        holder = new DownloadableProjectsFromWebHolder();
        holder.txtPid = (TextView)row.findViewById(R.id.tvAllProjectsPid);
        holder.txtName = (TextView)row.findViewById(R.id.tvAllProjectsName);
        holder.txtShareable = (TextView)row.findViewById(R.id.tvAllProjectsShareable);

        row.setTag(holder);
    }
    else
    {
        holder = (DownloadableProjectsFromWebHolder)row.getTag();
    }

    String share_text;
    AllProjectListInfo li = data.get(position);
    holder.txtPid.setText("ID: " + Integer.toString(li.getId()));
    holder.txtName.setText(li.getName());
    if (li.getShareable()){
        share_text = "Public Project";
    } else {
        share_text = "Private Project";
    }
    holder.txtShareable.setText(share_text);

    return row;
} 
```

导致问题的行：

```
35:    LayoutInflater inflater = ((Activity)context).getLayoutInflater();
36:    row = inflater.inflate(layoutResourceId, parent, false); 
```

这里来自 LogCat 的信息：

```
FATAL EXCEPTION: main
java.lang.ClassCastException: android.app.ContextImpl cannot be cast to android.app.Activity
    at com.ericbrian.tnc.ConProForAndroid.DownloadableProjectsFromWebAdapter.getView(DownloadableProjectsFromWebAdapter.java:36)
    at android.widget.AbsListView.obtainView(AbsListView.java:2033)
    at android.widget.ListView.makeAndAddView(ListView.java:1772)
    at android.widget.ListView.fillDown(ListView.java:672)
    at android.widget.ListView.fillFromTop(ListView.java:732)
    at android.widget.ListView.layoutChildren(ListView.java:1625)
    at android.widget.AbsListView.onLayout(AbsListView.java:1863)
    at android.view.View.layout(View.java:11278)
    at android.view.ViewGroup.layout(ViewGroup.java:4224)
    at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1628)
    at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1486)
    at android.widget.LinearLayout.onLayout(LinearLayout.java:1399)
    at android.view.View.layout(View.java:11278)
    at android.view.ViewGroup.layout(ViewGroup.java:4224)
    at android.widget.FrameLayout.onLayout(FrameLayout.java:431)
    at android.view.View.layout(View.java:11278)
    at android.view.ViewGroup.layout(ViewGroup.java:4224)
    at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1628)
    at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1486)
    at android.widget.LinearLayout.onLayout(LinearLayout.java:1399)
    at android.view.View.layout(View.java:11278)
    at android.view.ViewGroup.layout(ViewGroup.java:4224)
    at android.widget.FrameLayout.onLayout(FrameLayout.java:431)
    at android.view.View.layout(View.java:11278)
    at android.view.ViewGroup.layout(ViewGroup.java:4224)
    at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:1489)
    at android.view.ViewRootImpl.handleMessage(ViewRootImpl.java:2442)
    at android.os.Handler.dispatchMessage(Handler.java:99)
    at android.os.Looper.loop(Looper.java:137)
    at android.app.ActivityThread.main(ActivityThread.java:4424)
    at java.lang.reflect.Method.invokeNative(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:511)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
    at dalvik.system.NativeStart.main(Native Method) 
```

这里调用适配器：

```
DownloadableProjectsFromWebAdapter adapter = 
    new DownloadableProjectsFromWebAdapter(
        getBaseContext(), 
        R.layout.all_projects_listview_item, 
        results); 
```

最后，结果定义：

```
List<AllProjectListInfo> results 
```

现在，我从另一个使用自定义适配器的地方复制了这段代码。但是，那个工作得很好。我不明白为什么这个没有。

任何帮助表示赞赏。

谢谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-05T22:46:24.087

而不是这个*（这主要是错误的）*：

```
LayoutInflater inflater = ((Activity)context).getLayoutInflater(); 
```

做这个：

```
LayoutInflater inflater = LayoutInflater.from(context); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T22:44:01.960

您在适配器中设置了错误的上下文：

试试这个：

```
DownloadableProjectsFromWebAdapter adapter = 
new DownloadableProjectsFromWebAdapter(
    MyActivityClass.this, 
    R.layout.all_projects_listview_item, 
    results); 
```

# database - 用 VB.net 连接来自两个不同数据库的两个表，可能吗？（访问和 SQL Server）

> ID：10905780
> 
> 赞同：0
> 
> 时间：2012-06-05T22:18:21.297
> 
> 标签：database, vb.net

你能对两个表执行连接吗，一个是 Access 数据库，另一个是 SQL Server 数据库。

我知道我可以在每个数据库上执行 SELECT，然后手动加入结果。这就是我必须要做的吗？

我在 VB.net 中工作，使用 OleDBConnection 的东西。

如果可能（我开始怀疑），您能否提供示例代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-12T01:55:37.073

我想你正在寻找这个。它适用于 VB.NET 3.0，但仍然可以在更高版本的某些变化中应用：http: [//support.microsoft.com/kb/113701](http://support.microsoft.com/kb/113701)

如果您正在寻找使用 VB.NET 4.5 的编程方式，使用 OleDBConnection 和数据集：http: [//msdn.microsoft.com/en-us/library/bh8kx08z.aspx](http://msdn.microsoft.com/en-us/library/bh8kx08z.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T07:18:42.553

您可以尝试将 Linq to SQL 与 2 个不同的数据上下文一起使用 - 请参阅[此](https://stackoverflow.com/questions/898363/simulating-cross-context-joins-linq-c)示例

# c# - 在 C# 中使用存储过程输出参数

> ID：10905782
> 
> 赞同：71
> 
> 时间：2012-06-05T22:18:40.257
> 
> 标签：c#, sql-server, stored-procedures

我在将输出参数从 Sql Server 存储过程返回到 C# 变量时遇到问题。我已经阅读了有关此的其他帖子，不仅在此处，而且在其他站点上，但我无法使其正常工作。这是我目前拥有的。目前我只是想打印返回的值。以下代码返回一个空值。我试图返回的是主键。我尝试过使用`@@IDENTITY`和`SCOPE_INDENTITY()`（即`SET @NewId = SCOPE_IDENTITY()`）。

存储过程：

```
CREATE PROCEDURE usp_InsertContract
    @ContractNumber varchar(7),

    @NewId int OUTPUT
AS
BEGIN

    INSERT into [dbo].[Contracts] (ContractNumber)
        VALUES (@ContractNumber)

    Select @NewId = Id From [dbo].[Contracts] where ContractNumber = @ContractNumber
END 
```

打开数据库：

```
pvConnectionString = "Server = Desktop-PC\\SQLEXPRESS; Database = PVDatabase; User ID = sa;
    PASSWORD = *******; Trusted_Connection = True;";

try
{
    pvConnection = new SqlConnection(pvConnectionString);
    pvConnection.Open();
}
catch (Exception e)
{
    databaseError = true;
} 
```

执行命令：

```
pvCommand = new SqlCommand("usp_InsertContract", pvConnection);

pvCommand.Transaction = pvTransaction;
pvCommand.CommandType = CommandType.StoredProcedure;    

pvCommand.Parameters.Clear();
pvCommand.Parameters.Add(new SqlParameter("@ContractNumber", contractNumber));

SqlParameter pvNewId = new SqlParameter();
pvNewId.ParameterName = "@NewId";
pvNewId.DbType = DbType.Int32;
pvNewId.Direction = ParameterDirection.Output;
pvCommand.Parameters.Add(pvNewId);

try
{
    sqlRows = pvCommand.ExecuteNonQuery();

    if (sqlRows > 0)
        Debug.Print("New Id Inserted =  ", 
            pvCommand.Parameters["@NewId"].Value.ToString()); 
    }
    catch (Exception e)
    {
        Debug.Print("Insert Exception Type: {0}", e.GetType());
        Debug.Print("  Message: {0}", e.Message);
    }
} 
```

* * *

## 回答 #1

> 赞同：142
> 
> 时间：2012-06-06T05:25:23.640

我稍微修改了您的存储过程（使用`SCOPE_IDENTITY`），它看起来像这样：

```
CREATE PROCEDURE usp_InsertContract
    @ContractNumber varchar(7),
    @NewId int OUTPUT
AS
BEGIN
    INSERT INTO [dbo].[Contracts] (ContractNumber)
    VALUES (@ContractNumber)

    SELECT @NewId = SCOPE_IDENTITY()
END 
```

我试过了，它工作得很好（使用修改后的存储过程）：

```
// define connection and command, in using blocks to ensure disposal
using(SqlConnection conn = new SqlConnection(pvConnectionString ))
using(SqlCommand cmd = new SqlCommand("dbo.usp_InsertContract", conn))
{
    cmd.CommandType = CommandType.StoredProcedure;

    // set up the parameters
    cmd.Parameters.Add("@ContractNumber", SqlDbType.VarChar, 7);
    cmd.Parameters.Add("@NewId", SqlDbType.Int).Direction = ParameterDirection.Output;

    // set parameter values
    cmd.Parameters["@ContractNumber"].Value = contractNumber;

    // open connection and execute stored procedure
    conn.Open();
    cmd.ExecuteNonQuery();

    // read output value from @NewId
    int contractID = Convert.ToInt32(cmd.Parameters["@NewId"].Value);
    conn.Close();
} 
```

这也适用于您的环境吗？我不能说为什么您的原始代码不起作用 - 但是当我在这里执行此操作时，VS2010 和 SQL Server 2008 R2，它可以完美地工作......

如果您没有取回一个值 - 那么我怀疑您的表`Contracts`可能实际上没有包含该`IDENTITY`属性的列。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-06T05:52:17.560

在更改存储过程之前，请检查您当前的输出是什么。在 SQL Server 管理中运行以下命令：

```
DECLARE @NewId int
EXEC    @return_value = [dbo].[usp_InsertContract]
            N'Gary',
            @NewId OUTPUT
SELECT  @NewId 
```

看看它返回了什么。这可能会给您一些提示，说明您的 out 参数未填充的原因。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T22:21:12.353

存储过程…………

```
CREATE PROCEDURE usp_InsertContract
    @ContractNumber varchar(7)
AS
BEGIN

    INSERT into [dbo].[Contracts] (ContractNumber)
        VALUES (@ContractNumber)

    SELECT SCOPE_IDENTITY() AS [SCOPE_IDENTITY]
END 
```

C＃

```
pvCommand.CommandType = CommandType.StoredProcedure;

pvCommand.Parameters.Clear();
pvCommand.Parameters.Add(new SqlParameter("@ContractNumber", contractNumber));
object uniqueId;
int id;
    try
    {
    uniqueId = pvCommand.ExecuteScalar();
     id = Convert.ToInt32(uniqueId);
    }
    catch (Exception e)
    {
        Debug.Print("  Message: {0}", e.Message);
    }
} 
```

**编辑：** “我仍然得到一个 DBNull 值....对象不能从 DBNull 转换为其他类型。我明天再处理这个问题。我要去我的另一份工作了，”

**我相信您的 SQL 表中的 Id 列不是标识列。**

![在此处输入图像描述](../Images/b688fca0264043522eaa3b4cf77fdf74.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-06-29T12:09:48.840

我有一个类似的问题，首先关闭连接，然后读取参数，它工作正常。您可以`pvConnection.Close();` 在读取输出参数之前使用 try { pvConnection = new SqlConnection(pvConnectionString); pvConnection.Open(); } catch (Exception e) { databaseError = true; }

```
pvCommand = new SqlCommand("usp_InsertContract", pvConnection);

pvCommand.Transaction = pvTransaction;
pvCommand.CommandType = CommandType.StoredProcedure;    

pvCommand.Parameters.Clear();
pvCommand.Parameters.Add(new SqlParameter("@ContractNumber", contractNumber));

SqlParameter pvNewId = new SqlParameter();
pvNewId.ParameterName = "@NewId";
pvNewId.DbType = DbType.Int32;
pvNewId.Direction = ParameterDirection.Output;
pvCommand.Parameters.Add(pvNewId);

try
{
    sqlRows = pvCommand.ExecuteNonQuery();
    pvConnection.Close();
    if (sqlRows > 0)
        Debug.Print("New Id Inserted =  ", 
            pvCommand.Parameters["@NewId"].Value.ToString()); 
    }
    catch (Exception e)
    {
        Debug.Print("Insert Exception Type: {0}", e.GetType());
        Debug.Print("  Message: {0}", e.Message);
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-22T07:36:26.643

在您的 C# 代码中，您将事务用于命令。只需提交事务，然后访问您的参数值，您将获得该值。为我工作。:)

# r - 没有错误消息的实际图表丢失

> ID：10905786
> 
> 赞同：2
> 
> 时间：2012-06-05T22:18:51.167
> 
> 标签：r, ggplot2

我刚开始尝试通过使用 R 中的 ggplot2 包来可视化我的数据，最后到了一个点，几乎一切看起来都很好。意思是，轴标记正确，具有正确的刻度线等。

现在的问题是，虽然我在运行下面的代码时没有收到错误消息，但图中的实际图形没有显示出来。这让我很难弄清楚到底出了什么问题。任何关于为什么会（不）发生的建议将不胜感激。

```
time <- seq(as.Date("2010-04-01"), as.Date("2012-02-01"), by = "2 months") 
```

日期向量，用作刻度线。每 2 个月标记一次，从数据中最早的日期开始，直到最后一个日期之后。

```
qplot(date, sums/1000, data=sums[(sums$lake=="Gollinsee") & (sums$maize=="no maize"),] ,color=location, group=location, main="Gollinsee without maize") +
    geom_line(size=0.7) + geom_point(size=3) +
    labs(x="Date", y=expression("Total C  [" * g %.% m^-3 * "]")) + 
    scale_x_date(breaks=(time), limits=c(min(time), max(time)), labels=format.Date(time, "%b %Y")) 
```

一切都按预期运行，直到我添加最后一行。没有它，x 轴太杂乱，日期的格式也不理想。好了，生成了以下图像（不幸的是，我还不允许发布图像，但链接应该可以工作）：

[http://i.stack.imgur.com/I6rRY.png](http://i.stack.imgur.com/I6rRY.png)

在没有修改 x 轴的情况下，情节看起来不太像样。

[http://i.stack.imgur.com/WidpZ.png](http://i.stack.imgur.com/WidpZ.png)

亲切的问候！

**编辑：** dput(sums) 的输出

```
structure(list(date = structure(c(1L, 1L, 2L, 2L, 3L, 3L, 4L, 
5L, 6L, 6L, 7L, 7L, 8L, 8L, 9L, 9L, 11L, 11L, 19L, 10L, 10L, 
12L, 12L, 14L, 14L, 16L, 16L, 19L, 15L, 20L, 20L, 13L, 13L, 17L, 
17L, 18L, 20L, 20L, 22L, 22L, 18L, 4L, 21L, 25L, 28L, 25L, 25L, 
23L, 23L, 23L, 23L, 28L, 24L, 24L, 24L, 24L, 22L, 22L, 22L, 22L, 
21L, 25L, 35L, 35L, 37L, 37L, 35L, 35L, 37L, 37L, 39L, 39L, 39L, 
39L, 36L, 28L, 33L, 33L, 33L, 33L, 31L, 31L, 31L, 31L, 29L, 29L, 
29L, 26L, 26L, 26L, 26L, 27L, 27L, 27L, 27L, 30L, 30L, 30L, 30L, 
32L, 32L, 32L, 32L, 34L, 34L, 34L, 34L, 38L, 38L, 38L, 38L, 36L, 
36L), .Label = c("2010-04-06", "2010-04-08", "2010-05-04", "2010-05-06", 
"2010-05-19", "2010-06-01", "2010-06-03", "2010-06-29", "2010-06-30", 
"2010-07-27", "2010-07-29", "2010-08-24", "2010-08-26", "2010-09-21", 
"2010-09-23", "2010-10-19", "2010-10-21", "2010-11-16", "2010-11-18", 
"2011-01-05", "2011-02-24", "2011-03-22", "2011-04-05", "2011-04-07", 
"2011-05-03", "2011-05-05", "2011-05-31", "2011-06-01", "2011-06-28", 
"2011-07-01", "2011-07-26", "2011-07-28", "2011-08-23", "2011-08-25", 
"2011-09-20", "2011-09-22", "2011-10-17", "2011-10-20", "2012-01-10"
), class = "factor"), lake = structure(c(1L, 1L, 2L, 2L, 1L, 
1L, 2L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 1L, 
1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 
2L, 2L, 2L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 
2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L), .Label = c("Gollinsee", 
"Schulzensee"), class = "factor"), location = structure(c(2L, 
1L, 2L, 1L, 2L, 1L, 2L, 2L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 
1L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 
1L, 2L, 2L, 2L, 2L, 2L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 
2L, 2L, 2L, 1L, 1L, 2L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 
2L, 1L, 1L, 1L, 1L, 2L, 1L, 2L, 1L, 2L, 2L, 2L, 1L, 1L, 2L, 2L, 
2L, 1L, 1L, 2L, 2L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 
1L, 1L, 2L, 1L, 2L, 1L, 2L, 2L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 2L
), .Label = c("littoral", "pelagic"), class = "factor"), maize = structure(c(2L, 
2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 
2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, 
2L, 2L, 2L, 2L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 2L, 
1L, 2L, 2L, 1L, 2L, 1L, 2L, 2L, 1L, 1L, 2L, 2L, 2L, 2L, 1L, 1L, 
2L, 2L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, 2L, 1L, 
2L, 1L, 2L, 2L, 1L, 1L, 2L, 1L, 1L, 2L, 2L, 1L, 2L, 1L, 1L, 2L, 
2L, 1L, 1L, 1L, 2L, 2L, 1L, 2L, 2L, 1L, 2L, 1L, 1L, 2L, 2L, 1L
), .Label = c("maize", "no maize"), class = "factor"), sums = c(388.7, 
254.5, 320.4, 373.3, 224.1, 182.4, 245.5, 258.7, 47.7, 60.5, 
58.3, 103.7, 311.9, 207.7, 283.9, 308.3, 237.9, 165.4, 556.4, 
1090.4, 1792.6, 1350.5, 932.4, 526.5, 1157.8, 2343.7, 4570.9, 
393.2, 315.5, 351, 1008, 504.8, 289.9, 113.4, 117.7, 707.9, 193.4, 
122.2, 828.2, 1106.4, 837.8, 148, 777.6, 1824.6, 388, 1658.6, 
636.3, 1434.7, 770.8, 1776.4, 705.9, 1634.5, 1237.1, 1882.5, 
1073.8, 2283, 1030.7, 273, 194.6, 788.6, 1034.9, 420.7, 404.6, 
295.9, 332, 229.3, 381, 304.2, 780.2, 227.3, 50.6, 509.3, 209.7, 
675.8, 691.9, 651.7, 635.1, 560.8, 602.2, 1243.1, 733.8, 669.1, 
574.5, 379.6, 1405.3, 513.6, 612.4, 1396.4, 256.7, 486.8, 521.3, 
55.5, 48.2, 181.7, 281.3, 322.7, 478.1, 208.4, 173.8, 599.2, 
262.9, 760.7, 365.5, 746.6, 790.3, 581.7, 388.9, 826.4, 132.6, 
167.5, 817.6, 425.1, 582.2)), .Names = c("date", "lake", "location", 
"maize", "sums"), class = "data.frame", row.names = c(NA, -113L)) 
```

亲切的问候！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T22:51:55.643

问题是总和中的“日期”目前是一个因素。将其转换为 Date 类型。您可能不必为定义“时间”而烦恼，因为我认为您只是这样做，因此轴看起来不会那么混乱。将日期作为实际日期类型应该稍微清理一下标签。

```
sums$date <- as.Date(sums$date)

qplot(date, 
      sums/1000,
      data=sums[(sums$lake=="Gollinsee") & (sums$maize=="no maize"),],
      color=location, 
      group=location, 
      main="Gollinsee without maize") +
geom_line(size=0.7) + 
geom_point(size=3) +
labs(x="Date", y=expression("Total C  [" * g %.% m^-3 * "]")) 
```

# javascript - Javascript 自定义索引访问器

> ID：10905787
> 
> 赞同：9
> 
> 时间：2012-06-05T22:18:55.020
> 
> 标签：javascript, arrays, json

在 c# 中，您可以像这样创建自定义索引器

```
public object this[string name]
    {

    } 
```

我正在使用一个 javascript 小部件库，该库具有一个小部件，该小部件将一系列对象作为称为标签的属性，如下所示

```
new  Thingy({
      labels: [{value:1, text:"my label"},[{value:2, text:"my next label"}]
      }); 
```

问题是您必须提前计划才能确切知道需要标签的所有值是什么。例如，在上面的示例中，我知道标签将用于值 1 和 2。但如果我不知道值可能是什么，我希望能够根据它的值动态创建文本试图访问

所以当图书馆内部尝试访问时：

```
this.labels[n].text 
```

我希望 this.labels[n] 做类似的事情

```
function(n){return {text: "label for " + n};} 
```

这可能在javascript语言的范围内吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:26:01.330

您可以在最新的 Chrome 中获取[es6 代理](http://wiki.ecmascript.org/doku.php?id=harmony%3aproxies)，并像在 C# 中一样编写处理程序，但它与旧版浏览器不兼容。

同时我建议`getLabel()`在`Thingy.prototype`.

# ruby - Rails Server 需要重新启动才能显示更改

> ID：10905789
> 
> 赞同：0
> 
> 时间：2012-06-05T22:19:05.147
> 
> 标签：ruby, ruby-on-rails-3, sqlite, webrick

我目前正在借助“使用 Rails 进行敏捷 Web 开发”一书学习 Ruby on Rails，但我在第一个应用程序上遇到了问题。

我创建了应用程序 `rails new depot` 并生成了脚手架

```
rails generate scaffold Product \title:string description:text image_url:string price:decimal 
```

然后我跑了`rake db:migrate`

根据这本书，我现在应该能够创建新产品，然后立即显示。但是当添加一个新产品时，它在查看 url 时不会显示，`http://localhost:3000/products`或者`http://localhost:3000/products.json`当我查看数据库文件时，添加的产品就在那里。

重新启动服务器后，添加的产品显示在列表中。有人知道我做错了什么吗？

使用：Rails 3.2.4、Ruby 1.9.3、WEBrick 1.3.1、SQLite 3 和 Mac OSX

编辑：脚手架生成的代码：

```
 products_controller.rb
      # GET /products
      # GET /products.json
      def index
        @products = Product.all

        respond_to do |format|
          format.html # index.html.erb
          format.json { render json: @products }
        end
      end

index.html.erb  
<h1>Listing products</h1>
<table>
  <tr>
    <th>Title</th>
    <th>Description</th>
    <th>Image url</th>
    <th>Price</th>
    <th></th>
    <th></th>
    <th></th>
  </tr>

<% @products.each do |product| %>
  <tr>
    <td><%= product.title %></td>
    <td><%= product.description %></td>
    <td><%= product.image_url %></td>
    <td><%= product.price %></td>
    <td><%= link_to 'Show', product %></td>
    <td><%= link_to 'Edit', edit_product_path(product) %></td>
    <td><%= link_to 'Destroy', product, confirm: 'Are you sure?', method: :delete %></td>
  </tr>
<% end %>
</table>

<br />

<%= link_to 'New Product', new_product_path %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T07:11:52.823

我敢打赌你的 Rails 版本是 3.2.4？只需将您的 Rails 版本更新到 3.2.5+ 就可以了。

这是在 3.2.4 中发生的 Rails 中的回归错误。已修复：[https ://github.com/rails/rails/commit/7056079761eba049bbc6108946a1626fe169dbdf](https://github.com/rails/rails/commit/7056079761eba049bbc6108946a1626fe169dbdf)

# java - Java 7u4 webstart 安全异常：类与信任级别不匹配

> ID：10905790
> 
> 赞同：7
> 
> 时间：2012-06-05T22:19:06.813
> 
> 标签：java, security, java-7, java-web-start, securityexception

我们开始注意到使用 Java 7（尤其是更新 4），我们所有的用户都开始使用我们的 Webstart 应用程序看到这一点：

```
[14:42:58,422] AWT-EventQueue-0(DEBUG) java.lang.SecurityException: class "CLASSNAME" does not match trust level of other classes in the same package
[14:42:58,422] AWT-EventQueue-0(DEBUG) at com.sun.deploy.security.CPCallbackHandler$ChildElement.checkResource(Unknown Source)
[14:42:58,422] AWT-EventQueue-0(DEBUG) at com.sun.deploy.security.DeployURLClassPath$JarLoader.checkResource(Unknown Source)
[14:42:58,422] AWT-EventQueue-0(DEBUG) at com.sun.deploy.security.DeployURLClassPath$JarLoader.getResource(Unknown Source)
[14:42:58,422] AWT-EventQueue-0(DEBUG) at com.sun.deploy.security.DeployURLClassPath.getResource(Unknown Source)
[14:42:58,422] AWT-EventQueue-0(DEBUG) at java.net.URLClassLoader$1.run(Unknown Source)
[14:42:58,422] AWT-EventQueue-0(DEBUG) at java.net.URLClassLoader$1.run(Unknown Source)
[14:42:58,422] AWT-EventQueue-0(DEBUG) at java.security.AccessController.doPrivileged(Native Method)
[14:42:58,422] AWT-EventQueue-0(DEBUG) at java.net.URLClassLoader.findClass(Unknown Source)
[14:42:58,422] AWT-EventQueue-0(DEBUG) at com.sun.jnlp.JNLPClassLoader.findClass(Unknown Source)
[14:42:58,422] AWT-EventQueue-0(DEBUG) at java.lang.ClassLoader.loadClass(Unknown Source)
[14:42:58,422] AWT-EventQueue-0(DEBUG) at java.lang.ClassLoader.loadClass(Unknown Source)...More 
```

其中 CLASSNAME = 应用程序执行中几个 jar 中随机点的几乎每个类，破坏了几种行为。如果我们的用户使用 Java 6，他们没有问题！只有 7 个（更新 4）。我们对所有的 jar 进行签名，包括主应用程序 jar 和库 jar。ie 启动我们的 webstart 应用程序的用户看到蓝色盾牌而不是黄色或红色。

这显然是一个问题，因为用户现在更频繁地升级到 Java 7。我试图通过使用以前的安装（工作）或安装新的来强制我们的应用程序在用户机器上使用 Java 6....在资源周围使用 j2se version="1.6" 标记，但这会导致它自己的问题，最好将其放入它自己的线程（auto-jre-installation 部分）。

Oracle 是否使用 Java 7u4 破坏了 Webstart 安全性？如何解决此安全异常问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-22T13:41:57.483

我在 1.7.07 中遇到了同样的问题：我的 webstart 应用程序在加载类时随机失败，并显示相同的错误消息。我在这个页面上找到了一个有趣的解决方法[oracle forums](https://forums.oracle.com/forums/thread.jspa?threadID=1303543)。最后一个答案描述了该问题的解决方法（Java 6） - 对 jar 签名的引用被保留为软引用，这些可能被垃圾收集，这会导致错误消息。这可以通过一些额外的行用于 Java 7

```
// Java 1.7
callNoArgMethod("getSigningData", jar);
makeHardLink("signingDataRef", jar); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-18T23:48:35.680

只是 jarsigners hack 签入的原始作者。我是由另一个开发人员指导的，我最初与他分享了 hack。

根据他对此的持续调查，您需要将以下内容添加到对 hack 的调用中

```
callNoArgMethod("getSigningData", jar);
makeHardLink("signingDataRef", jar);

callNoArgMethod("getManifest", jar);
makeHardLink("manRef", jar, n); 
```

清单调用不是本文解决方案的一部分。它们是在创建验收测试以重现问题时发现的。

基于这个新信息，我们改变了我们的方法，我们现在使用反射来调用所有“get”方法（如果尚未填充软引用，则需要调用 get 方法来初始填充软引用）

然后反思性地发现 CachedJarFile 类中的所有软引用并创建指向它们的硬链接。

只要 CachedJarFile 保持在原位并且 hack 的基本前提保持不变，这应该会在未来证明进一步内部重命名/重构的解决方案。（即：将软引用变为硬引用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-05T22:29:27.217

我想你可能会遇到[这个错误](http://bugs.sun.com/view_bug.do?bug_id=6967414)。

错误状态表明已在 7u4 中提供了修复。但这与你所说的并不相符。也许“修复”会中断....

与此同时，“squaat”对该错误的评论提到了可能的解决方法。例如，增加初始堆大小和/或使用预加载器强制一些 JAR 提前加载。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-04-20T15:55:31.507

更新到 JRE 8 更新 91 后，我遇到了同样的问题。在以前的版本 1.6、1.7、1.8 更新 77 中，我的应用程序运行良好。

Oracle 是否重新引入了 JRE 1.6 错误中存在的[错误](http://bugs.java.com/view_bug.do?bug_id=6967414)？

我发现的唯一解决方法是从 Java 控制面板禁用混合代码控制。

* * *

我修好了它。问题出在我的应用程序使用的库中。罐子里的 MANIFEST.MF 是这样的：

```
Manifest-Version: 1.0
Ant-Version: Apache Ant 1.7.0
Created-By: 1.5.0_07-87 ("Apple Computer, Inc.")
Built-By: wolf

Name: common
Specification-Title: swixml
Specification-Vendor: swixml.org
Specification-Version: 1.6
Implementation-Title: org.swixml
Implementation-Vendor: swixml.org
Implementation-Version: 1.6 beta 1 (#151) 
```

“名称”属性用于此处所述的资源特定条目[http://docs.oracle.com/javase/7/docs/technotes/guides/jar/jar.html#JAR_Manifest](http://docs.oracle.com/javase/7/docs/technotes/guides/jar/jar.html#JAR_Manifest)

对此 jar 进行签名时，“名称”条目将被解释为资源，但没有要签名的资源。当应用程序启动时，javaws 发现 MANIFEST.MF 中报告的资源与阻塞应用程序的 jar 中的有效资源不匹配

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-26T05:22:58.870

我一直在使用 JRE 7u5 处理相同的症状。完全相同的应用程序 web 使用 JRE 6u33 启动时没有问题。

就我而言，问题是由我的扩展 jnlp 文件之一引起的。主 jnlp 文件指定了所有权限安全，而扩展 jnlp 没有声明任何特定的安全要求（只是一个空的安全标记）。

这导致扩展 jar 被加载到沙箱中。显然，Java 7 不接受混合具有不同安全要求的 jar，即使它们都已签名。

通过确保所有扩展 jnlp 文件指定与主 jnlp 文件相同的安全要求，该问题已得到解决。

# sql-server-express - 桌面 .NET 应用程序中的 SQL Server Express 异常

> ID：10905792
> 
> 赞同：0
> 
> 时间：2012-06-05T22:19:27.733
> 
> 标签：sql-server-express

我开发了一个使用 SQL Server 2005 SP3 Express 的 .NET 桌面应用程序。

在 Windows 7 64 位机器上安装 SQL Server Express 运行时和应用程序后，启动应用程序后出现以下错误：

> System.Data.SqlClient.SqlException：由于启动用户实例的进程失败，无法生成 SQL Server 的用户实例。连接将被关闭。

我在`<application>.exe.config`文件中使用的连接字符串是：

```
<add name="cs" connectionString="Data Source=.\SQLEXPRESS;
    AttachDbFilename=|DataDirectory|\AppData\MWAIWFMLE1.mdf;
    Integrated Security=True;
    User Instance=True"
    providerName="System.Data.SqlClient" /> 
```

该`MWAIWFMLE1.mdf`文件位于`AppData`程序文件下的应用程序安装目录中的一个文件夹中 - 因此`AppData`在`AttachDbFileName`路径中。

我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T04:56:29.347

阅读这篇[关于用户实例真正含义的非常好的概述](http://msdn.microsoft.com/en-us/library/bb264564%28v=sql.90%29.aspx)。

简而言之：

*   SQL Server 允许您在单台计算机上拥有多个自身**实例**- 可以仅使用主机的机器名称（或 IP 地址）访问默认实例 - 所有其他实例都需要由**实例名称**指定（如`SQLExpress`在你的机器上）

*   出于开发目的，您还可以创建一个**用户实例**- 每个用户都有自己单独的 SQL Server 实例（仅适用于**Express 版**），并且数据库通过其文件名 ( `path\Sales_DB.mdf`) 附加到该用户实例。此实例按需启动，然后运行并在不再需要时关闭

虽然这对开发很有用，但它并不是真正打算供以后使用 - 当然不是用于生产用途。

在生产环境中，您希望**将数据库文件附加**到它们应该运行的实际 SQL Server 实例 - 通常使用 SQL Server Management Studio。执行此操作时，您不再通过其**文件名**引用该数据库，而是使用附加到服务器时为数据库提供的**数据库名称。**在这种情况下，SQL Server 将处理所有的操作细节——并且 SQL Server 实例一直处于启动和运行状态（不需要一直“按需”启动），您可以使用权限和登录以控制对数据库的访问。

您的连接字符串将如下所示：

```
<connectionStrings>
    <add name="Sales_DBEntities" 
         connectionString="server=.\SQLEXPRESS;Database=YourDatabaseNameHere;Integrated Security=SSPI;" />
</connectionStrings> 
```

当您将数据库附加到生产（或测试）SQL Server 实例时，您不需要知道构成数据库的文件是什么，也不需要指定这些文件 - SQL Server 会处理那。您只需通过**数据库名称**引用数据库。

# javascript - 为什么这不起作用 - 将 :not() 与事件处理程序一起使用

> ID：10905793
> 
> 赞同：1
> 
> 时间：2012-06-05T22:19:29.983
> 
> 标签：javascript, jquery

我似乎还有另一个我没有解决的问题。真正简单的前提。我有一个 mousedown 事件，基本上如果单击页面上的一个特定元素，我不想发生任何事情，否则我想要 hide() 一些 div。

```
 $(function(){
        $("document :not(#_ignorelement)").mousedown(function(event){
                if($('#_hidethiselement').length){
                    $('#_hidethiselement').hide();
                }
        })
     }) 
```

那根本行不通。我还尝试了以下方法：

```
 $(document).not($("#_ignorelement")).mousedown(function(event){

    $(document).not("_ignorelement").mousedown(function(event){ 
```

如果我能解决这个问题，很好奇我实际上如何让 ":not" 包含父 div，如下所示：

```
$().not("_ignoreelement").parent().closest('div').mousedown(function 
```

因为元素“_ignorelement”是一个 div 中的锚标记。想知道我如何使用父 div，而不是锚标记。

无论如何，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T22:23:53.443

`document`不是您可以选择的节点。试试这个：

```
$(function(){
    $("body :not(#_ignorelement)").mousedown(function(event){
        if($('#_hidethiselement').length){
            $('#_hidethiselement').hide();
        }
        return false;
    })
 }); 
```

这是一个[工作示例](http://jsfiddle.net/9an9U/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T22:38:03.333

这应该有效：

```
var ignoreNode = jQuery('#_ignorelement')[0];

jQuery(document).on('mousedown', function(e) {
  if (ignoreNode === e.target || jQuery.contains(ignoreNode, e.target)) {
    // If the target is, or is inside the ignoreNode, don't
    // do anything.
    return;
  }

  // Do your hiding handling here 
}); 
```

请注意，缓存您的 jQuery 对象确实是一个好主意，这样您就不会在每个事件上运行选择器查询！

# javascript - 禁用翻转和链接的 Java 脚本随机图像

> ID：10905794
> 
> 赞同：0
> 
> 时间：2012-06-05T22:19:41.893
> 
> 标签：javascript, image, random, hyperlink

我希望这有一个简单的解决方案。我有一个 JavaScript 代码，可以在每个页面加载时显示随机图像。`image1.jpg`如您所见，每个图像都链接到它自己的页面`image_1.html`。至于`image3.jpg`我没有该图像的页面。

我想将其留空，并且当图像随机显示时，我不想要任何表明它链接到某个地方的翻转。在下面的 JavaScript 代码中，我指定了我认为需要修改的 JavaScript 区域以获得我正在寻找的内容。

任何提示或建议都会有所帮助。谢谢你。

```
var imagenumber = 1 ;
var randomnumber = Math.random() ;
var rand1 = Math.round( (imagenumber-1) * randomnumber) + 1 ;
images = new Array
images[1] = "assets/image1.jpg"
images[2] = "assets/image2.jpg"
images[3] = "assets/image3.jpg"
images[4] = "assets/image4.jpg"

var image = images[rand1] ;
var linknumber = 1; 
var img1 = Math.round( (linknumber-1) * randomnumber) + 1 ;
links = new Array
links[1] =  "image_1.html" 
links[2] =  "image_2.html" 
links[3] =  "" // <-- what do I place here to NOT have a link?
links[4] =  "image_3.html" 
links[5] =  "image_4.html" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T22:27:17.800

# 将跳转到页面顶部。试试这个。

```
"javascript:void(0);" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T22:31:29.920

链接的指示将来自`<a></a>`在图像周围使用标记对，而不是来自标记对的 HREF 属性的目标。抑制链接`javascript:void(0);`是让链接无处可去/什么都不做的好主意，但不会删除链接存在的指示......除非将`links`数组中的值转换为图像的javascript查找空白或其他值并将其用作吐出`<img>`没有周围`<a></a>`标签对的标签的信号。

因此，请查看您的代码并找出实际 HTML 的生成位置，并了解必须执行哪些操作才能触发非链接输出。如果没有代码可以实现这一点，则需要编写它。

# c# - 在 DataGridView 中查找最高的 ColumnIndex

> ID：10905797
> 
> 赞同：0
> 
> 时间：2012-06-05T22:19:49.840
> 
> 标签：c#, winforms, datagridview

如果我在 DataGridView 中选择多个单元格，我如何（在 MsgBox 中）获得（在所选中）具有最高 ColumnIndex 的单元格的值？

```
List<string> a = new List<string>();

foreach (DataGridViewCell cell in dgvC.SelectedCells)
{
    a.Add(cell.Value.ToString());
} 
```

因此，我需要通过重复通过选择一些单元格创建的列表来填充一行中的其余单元格。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T22:51:41.363

> 如果我在 DataGridView 中选择多个单元格，我如何获得（在 MsgBox 中）具有最高 ColumnIndex 的单元格的值（在所选中）

一种方法是使用 linq 按 ColumnIndex 对选定单元格的集合进行排序，然后获取第一个。

```
var selectedCells =dgvC.SelectedCells;

var MaxColumn = (from DataGridViewCell cell in selectedCells
                    orderby cell.ColumnIndex descending
                    select cell).FirstOrDefault();

MessageBox.Show(MaxColumn.Value.ToString()); 
```

您应该注意，根据用户的选择方式（从上到下或从下到上），您将从第一行或最后一行获取值。如果这很重要，您还应该按 RowIndex 排序

另一种方法是检查集合中的第一个和最后一个单元格并比较索引。我们需要同时查看两者，因为根据用户的选择方式，具有更大列索引的选择会发生变化。

```
var selectedCells = dgvc.SelectedCells;

var cellStart = selectedCells[0];
var cellEnd = selectedCells[selectedCells.Count -1];

if (cellStart.ColumnIndex > cellEnd .ColumnIndex)
    MessageBox.Show(cellStart.Value.ToString());
else
    MessageBox(cellEnd.Value.ToString()); 
```

注意：如果 AllowUsersToAddRow 为真，您应该检查 Null 值

# c# - 在批处理文件中传递 c# 命令行参数

> ID：10905799
> 
> 赞同：-1
> 
> 时间：2012-06-05T22:20:30.863
> 
> 标签：c#, command-line, batch-file, command-line-arguments

我已经构建了 ac# 代码，它基本上需要四个参数 a1 a2 a3 a4。我正在尝试制作一个批处理文件，以便用户可以输入他的参数并且代码给出特定的输出。我不确定如何将这些参数发送到批处理文件。我尝试创建 exe，但它似乎不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T22:25:22.810

要将参数发送到批处理文件，您可以从命令行（或另一个批处理文件）调用它，如下所示：

> 我的文件.bat a1 a2 a3

在批处理文件中，参数由 %1、%2、%3（等）表示，因此在批处理文件中，您可以像这样调用您的 exe：

> myapp.exe %1 %2 %3

这会将原始参数传递给批处理文件 a1 a2 a3 以及可执行文件。

从可执行文件中，您可以访问 Main 函数中的参数

```
static void Main(string[] args) 
```

参数 a1、a2、a3 将分别位于 args[0]、args[1] 和 args[2] 中。

# windows - 提取拉撒路资源

> ID：10905802
> 
> 赞同：4
> 
> 时间：2012-06-05T22:20:38.537
> 
> 标签：windows, delphi, resources, extract, lazarus

我创建了一个文件 .Lrs 并导入到程序中，它可以工作，但是如何从程序中获取资源并将其提取到我的 PC 上的某个位置？这是代码：

```
unit Unit1; 

{$mode objfpc}{$H+}

interface

uses
  Classes, SysUtils, FileUtil, Forms, LResources, Controls, Graphics, Dialogs, ExtCtrls;

type

  { TForm1 }

  TForm1 = class(TForm)
    procedure FormCreate(Sender: TObject);
  private
    { private declarations }
  public
    { public declarations }
  end;

var
  Form1: TForm1;

implementation

{$R *.lfm}

{ TForm1 }

procedure TForm1.FormCreate(Sender: TObject);
begin

end;

initialization
{$I resource.lrs}

end. 
```

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T22:49:05.770

您可以使用作为单元`TLazarusResourceStream`一部分的类`LResources`

试试这个样本

```
var
  Stream: TLazarusResourceStream;
begin
  Stream := nil;
  try
    //load the lazarus resource  
    Stream := TLazarusResourceStream.Create('image', nil);
    //save to a file
    Stream.SaveToFile('C:\Foo\image.png');
   finally
     Stream.Free;
   end;
end; 
```

# android - Android 移动浏览器图像在刷新前像素化

> ID：10905806
> 
> 赞同：1
> 
> 时间：2012-06-05T22:21:09.777
> 
> 标签：android, image, mobile, browser, rendering

我目前正在开发一个移动网站，在上面我有一组图像标记如下：

```
<a href="/link/"><img alt="image" src="/assets/image.jpg" /> Link</a> 
```

当我最初从 Android（多个设备）访问该站点时，这些图像会加载，但呈现颗粒状和像素化。但是，一旦我刷新设备上的页面，图像就会重新加载并按预期显示清晰。我只在 iPhone 上测试过一次，但在第一次加载时看起来还不错，所以我相信这是 Android 特有的。

我尝试通过 CSS 将它们设置为背景图像，而不是通过 HTML 放置它们，我还尝试直接在声明尺寸的图像上放置内联样式。使用这两种方法，问题仍然完全相同。

每个大约 3kb，其中有 9 个，站点的其余部分不是很重，这些图像实际上是该页面上唯一的内容。我相信 Android 必须设置一个限制或约束来使页面加载更快，但如果是这样的话，有没有办法绕过它？

不幸的是，我无法发布屏幕截图或 URL。

提前致谢！

# php - 显示有多少行被分组到同一个字段中

> ID：10905808
> 
> 赞同：0
> 
> 时间：2012-06-05T22:21:13.467
> 
> 标签：php, mysql

下面的查询显示了 MySQL 表中所有“zip”的列表。它将具有相同“zip”的行分组。

我如何创建一个新变量来显示每个“zip”共享多少行？

```
$query2 = "select zip from submission
GROUP BY zip    
order by zip asc"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T22:30:08.847

添加[`COUNT(*)`](http://dev.mysql.com/doc/en/group-by-functions.html#function_count)到您的选择列表：

```
SELECT zip, COUNT(*) FROM submission GROUP BY zip ORDER BY zip ASC 
```

# sql - 如何添加一个不存在的整数？

> ID：10905809
> 
> 赞同：0
> 
> 时间：2012-06-05T22:21:13.513
> 
> 标签：sql, sql-server

如果我有一个包含 INCREMENT_NUMBER 列的表 A。我们会说有五行。

```
1
2
3
4
4 
```

如果用户向表 A 添加新行，则该行的 INCREMENT_NUMBER 列应为 5。（可以是任何值，只要不是数字 1-4。）请记住

```
INCREMENT_NUMBER integer auto_increment primary key 
```

将不起作用，因为我需要允许表格中的重复项，我不认为

```
insert 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T22:27:27.540

如果您想允许重复，请不要将其声明为 a `PRIMARY KEY`（也不要对其施加`UNIQUE`约束）。

在**MySQL**中，在这种`AUTO_INCREMENT`情况下允许有重复项 - 您只需在其上添加一个简单的索引：

```
CREATE TABLE test
( increment_number INTEGER NOT NULL AUTO_INCREMENT
, INDEX inc_index (increment_number)
) ;

INSERT INTO test
VALUES (1),(2),(3),(4),(4); 
```

在 SQL-Fiddle 中测试：[test-1](http://sqlfiddle.com/#!2/31d26/1)

```
INSERT INTO test
VALUES
(NULL);

SELECT *
FROM test ; 
```

结果是：

```
increment_number
----------------
1
2
3
4
4
5 
```

* * *

在**SQL-Server**中，您必须切换`IDENTITY_INSERT`设置`ON`并`OFF`具有类似的行为：

```
CREATE TABLE test
( increment_number INT IDENTITY(1,1) NOT NULL 
, name varchar(20) NOT NULL
) ;

SET IDENTITY_INSERT test ON ;

INSERT INTO test (increment_number, name)
VALUES 
(1, 'Alex'),
(2, 'Bill'),
(3, 'Cathy'),
(4, 'Diana'),
(4, 'Dean'); 
```

然后[test-2](http://sqlfiddle.com/#!6/92b72/1)：

```
SET IDENTITY_INSERT test OFF ;

INSERT INTO test (name)
VALUES
('Elaine') ;

SELECT *
FROM test ; 
```

结果是：

```
increment_number  |  name
---------------------------
1                    Alex
2                    Bill
3                    Cathy
4                    Diana
4                    Dean
5                    Elaine 
```

# iphone - 将子视图添加到视图控制器

> ID：10905810
> 
> 赞同：0
> 
> 时间：2012-06-05T22:21:15.240
> 
> 标签：iphone, ios, uiviewcontroller, uitabbarcontroller, addsubview

我在尝试将视图控制器作为子视图加载到另一个视图控制器时遇到问题。

我所拥有的是一个 NavigationController，它将一些 viewControllers 作为视图（pop 和 push 等）加载，效果很好。然后我决定将 tabBar 放入 viewController 中，然后使用 switch 语句查看所有选择内容，然后此 switch 语句调用出现在 navigationController 中的 viewController 中的一个方法。然后，此视图控制器中的方法尝试将另一个视图控制器设置为导航控制器内部视图控制器的子视图。

这是我的代码。

TabBarViewController.m

```
#import "DetailViewController.h"

- (void)tabBar:(UITabBar *)tabBar didSelectItem:(UITabBarItem *)item
{
    switch (item.tag) {
        case 0:
        {
             NSLog(@"item 1 selected");
            DetailViewController *dVC = [[DetailViewController alloc] init];
            [dVC tabBarSelectedAction];
        }
            break;
        default:
            break;
    }

} 
```

所以这会捕获选项卡栏上的选定项目...然后向 DetailViewController 方法触发一条消息以将新的子视图加载到 DetailViewController.view

```
- (void)tabBarSelectedAction
{
    ButtonOneViewController *b1VC = [[ButtonOneViewController alloc] initWithNibName:@"ButtonOneViewController" bundle:[NSBundle mainBundle]];
    [self.testView addSubview:b1VC.view];

} 
```

这就是我试图将子视图加载到屏幕上的地方..我认为我做得对，但由于某种原因它没有显示..我想做的另一件事是从屏幕底部向上动画这个视图..

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T22:41:21.803

你的方法应该看起来像这样。假设自我`DetailViewController`。

```
- (void)tabBarSelectedAction {

   ButtonOneViewController *b1VC = [[ButtonOneViewController alloc] initWithNibName:@"ButtonOneViewController" bundle:[NSBundle mainBundle]];
   [self presentModalViewController:b1VC animated:YES]; 
```

}

即使这样，我认为你的逻辑有点搞砸了。您分配和初始化`DetailViewController`，但您从未在任何地方呈现它。那么，如果您从未呈现它，您如何期望在 DetailViewController 中看到模态视图。

**编辑：**考虑到您将其添加到的评论`UINavigationController`，您会将其更改为如下所示..

```
 [[self navigationController] presentModalViewController:b1VC animated:YES]; 
```

**EDIT2：**另外，你正在初始化一个类，只是为了调用一个已经是`self`. 你的`-didSelectItem:`方法应该看起来更像这样。

```
- (void)tabBar:(UITabBar *)tabBar didSelectItem:(UITabBarItem *)item {
switch (item.tag) {
    case 0:
    {
         NSLog(@"item 1 selected");
        [self tabBarSelectedAction];
    }
        break;
    default:
        break;
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T22:27:10.057

当您创建新的时`DetailViewController`，您没有通过 push 或 present 类型的方法使其成为视图层次结构的一部分。添加子视图可能有效，也可能无效，但您不会看到它，因为您添加它的对象没有使用屏幕。

# prototypejs - 如何在 PrototypeJS 中找到当前域？

> ID：10905814
> 
> 赞同：0
> 
> 时间：2012-06-05T22:21:27.747
> 
> 标签：prototypejs

有时当前域是 builds，有时是 builds.example.com。我想将 AJAX 请求调用到与当前域相同的域（这样它就不会违反同源策略）。如何找到当前域？如果这不可能，还有其他解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T22:25:49.117

无需查找当前域。只需使用部分 URL：

```
new Ajax.Request("/partial-url-without-domain", {
    method: "post",
    parameters: parameters
}); 
```

# facebook - 在您的 Facebook 页面上获取有关喜欢的更多详细信息

> ID：10905816
> 
> 赞同：0
> 
> 时间：2012-06-05T22:21:33.343
> 
> 标签：facebook

我想在我的 facebook 页面上针对喜欢我的页面的给定用户进行比赛，比如喜欢这个页面的第 100 个用户在这个页面上获得免费服务

即使使用新的 facebook 图表，我也到处检查过，我似乎看不到有关用户页面的更多详细信息，比如他们何时执行此操作，或者某种计数来知道用户是什么数量是喜欢的术语..

谁知道方法或可以提供帮助？...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T22:25:04.933

做不到。对不起。您无法获得第 100 个喜欢 Facebook 页面的用户。

也许您将扇形门应用程序作为“页面选项卡”应用程序，其中每 100 个访问扇形门应用程序的独特人都会得到一些东西。

# facebook - 社交喜欢按钮不会获 取帖子永久链接

> ID：10905818
> 
> 赞同：0
> 
> 时间：2012-06-05T22:21:43.803
> 
> 标签：facebook, plugins, twitter, tumblr, social

我变得绝望了，因为我无法解决这个问题：我已经在我的 tumblr 博客上整合了 Facebook、Twitter 和 Pinterest，没有任何问题。然而，对于欢迎页面上的每个帖子，Facebook 和 Twitter 按钮显示相同数量的点赞和推文（整个帖子都是可见的）。所以这意味着代码不是获取帖子的永久链接，而是获取我的博客 URL。我怎样才能让它计算单个帖子的喜欢？

我为 Facebook 按钮使用了以下代码：

`<div style="float:left" class="fb-like" data-url="{Permalink}" data-send="false" data-layout="button_count" data-width="20" data-show-faces="false" data-colorscheme="light" data-font="arial" style="float:left"></div>`

（当然是附加的开放图形标签和功能）。

我是一个完全的新手，如果有任何帮助，我将不胜感激！！！！请！

最好的，瓦莱丽

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T22:31:56.480

包含 URL 的属性应该是 data- **href**，而不是 data- *url*。

# ruby - `gem install therubyracer` 在 Mac OS X Lion 上失败

> ID：10905820
> 
> 赞同：70
> 
> 时间：2012-06-05T22:21:51.180
> 
> 标签：ruby, rubygems, v8

`gem install therubyracer`我希望能在上班时得到一些帮助。这是错误：

```
$ gem install therubyracer
Building native extensions.  This could take a while...
ERROR:  Error installing therubyracer:
    ERROR: Failed to build gem native extension.

        /Users/david/.rvm/rubies/ruby-1.9.3-p194/bin/ruby extconf.rb
checking for main() in -lobjc... yes
*** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options.

Provided configuration options:
    --with-opt-dir
    --with-opt-include
    --without-opt-include=${opt-dir}/include
    --with-opt-lib
    --without-opt-lib=${opt-dir}/lib
    --with-make-prog
    --without-make-prog
    --srcdir=.
    --curdir
    --ruby=/Users/david/.rvm/rubies/ruby-1.9.3-p194/bin/ruby
    --with-objclib
    --without-objclib
extconf.rb:15:in `<main>': undefined method `include_path' for Libv8:Module (NoMethodError) 
```

以下是我在错误之前运行的一些值得注意的步骤。他们工作得很好：

```
$ gem install libv8
$ brew install v8 
```

我的环境是：

*   Mac OS X 狮子 10.7.4
*   ruby 1.9.3p194（2012-04-20 修订版 35410）[x86_64-darwin11.4.0]（通过 rvm）
*   V8 版本 3.9.24（通过自制软件）

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2012-06-05T22:28:52.547

这对我有用：

```
$ gem uninstall libv8
$ gem install therubyracer 
```

（非常感谢[http://www.ruby-forum.com/topic/4306127](http://www.ruby-forum.com/topic/4306127)）

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2012-12-17T23:31:34.690

```
gem uninstall libv8
brew install v8
gem install therubyracer 
```

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2013-05-24T16:09:31.863

但是，你问*为什么*会这样？为什么卸载`libv8`和重新安装可以`therubyracer`解决问题？

答案在错误消息的底部（来自原始帖子）。忽略有关的东西

```
probably lack of necessary libraries and/or headers 
```

这是编写该错误消息的人的错误假设。在底部，您会看到 Ruby 对此有何评论：

```
undefined method `include_path' for Libv8:Module 
```

就我而言，我试图使用 进行安装`therubyracer-0.9.8`，`bundle install`并且由于某种原因，它试图使用我的副本`libv8-3.11.8.13`，该副本已在某个时候安装，可能作为其他一些 gem 的依赖项。

我不知道它为什么要尝试使用较新的版本，因为`therubyracer.gemspec`包含`s.add_dependency "libv8", "~> 3.3.10"`. 我`Gemfile.lock`说要使用`libv8 (3.3.10.2)`. 但很可惜，这确实是正在发生的事情。

确实`Libv8:Module`没有in 中的方法，但*确实**有*in`include_path``libv8-3.11.8.13`*`libv8-3.3.10.2`*

 *这就是为什么卸载*所有*版本`libv8`然后重新安装的原因`therubyracer`。因为所有*没有*方法的版本`libv8`都被彻底删除，而有*方法*路径的版本在重装的时候会重新安装。*`include_path``libv8`*`include``therubyracer`**

 *** * *

## 回答 #4

> 赞同：15
> 
> 时间：2013-12-03T14:53:11.313

如果以上内容对我 100% 有效，则不考虑，我想我会发布所做的事情（作为 rails 项目的一部分）：

```
gem uninstall libv8
bundle update therubyracer 
```

这确保我获得了最新`therubyracer`的 . 以及更新版本的`libV8`. 并且似乎解决了我遇到的多个问题，从缺少 libv8.a 文件到未定义的方法。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2012-07-29T07:45:02.497

最后我使用了 therubyracer 0.11.0beta5 作为解决方案。

使用 therubyracer (0.11.0beta5)

在 Gemfile 上添加以下内容

```
gem 'therubyracer', '~> 0.11.0beta5'
group :libv8 do
  gem 'libv8', "~> 3.11.8"
end 
```

然后`bundle install`

Mac OSX 10.8 山狮

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2014-07-28T07:33:42.857

如果您需要`0.11.3`并且它失败了，请为 Mac OS X 10.9 试一试...

```
gem uninstall libv8
brew install v8
gem install libv8 -- --with-system-v8
gem install therubyracer -v '0.11.3' -- --with-system-v8 
```

有关详细信息，请参阅[此问题。](https://github.com/cowboyd/therubyracer/issues/215)

你可能不需要`-- --with-system-v8`最后一行的，但我这样做只是为了安全，因为我看到它`Fetching: libv8-3.11.8.17-x86_64-darwin-13.gem (1%)`在我运行命令时开始做......

无论如何，当所有其他事情都没有时，它对我有用。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2012-12-05T00:15:57.780

对于尝试使用 升级其**Gemfile**时在 Mac OSX 10.8 Mountain Lion 上遇到此问题的任何人`gem 'therubyracer', '0.11.0'`，只需升级系统`libv8`gem 对我有用（无需卸载任何其他 gem）：

```
$ gem update libv8
$ bundle install 
```

### 编辑

如果您使用[Travis-CI](https://travis-ci.org/)（或其他服务器上的其他 CI 工具，我假设），您还需要显式地将`libv8`gem 添加到您的**Gemfile**中：

**宝石文件**

```
gem 'libv8', '3.11.8.3' 
```

然后`bundle install`像往常一样。请注意，`libv8`安装可能需要大量时间，而且我注意到它可能最终导致超过[Travis CI 的超时限制](http://about.travis-ci.org/docs/user/build-configuration/#Build-Timeouts)，从而导致构建失败。您可以稍微缓解这种情况，而不是在您的构建中包含开发环境 gem：

**.travis.yml**

```
# ...
bundler_args: --binstubs=./bundler_stubs --without development 
```

### 更新

是的，几乎我所有的 Travis 都会因为这个而超时并失败。如果有人知道解决此问题的方法（我希望“降级`therubyracer`”是最后的手段），请发表评论！

### 更新 2

这可能不适用于所有应用程序，但似乎我的 Rails 3.2.9 应用程序实际上并不需要`therubyracer`或根本不需要`libv8`。从我的**Gemfile**中删除这些 gem 后，我确认我的规范通过，再次推送到 Travis 并成功构建。所以，我想摆脱那些宝石（如果你不确定你是否真的需要它们）至少值得一试。

### 更新 3

感谢[Paul Annesley](https://stackoverflow.com/users/430695/paul-annesley)确认如果您使用的是 Mac OS X 10.8 Mountain Lion，则根本不需要 `therubyracer`gem，因为该操作系统已经捆绑了 Apple JavaScriptCore，它自己的 Javascript 运行程序。在最初回答时，我在雪豹上，因此需要它。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2014-04-19T04:59:28.280

对我来说，删除 Gemfile.lock 文件并运行`bundle install`它很神奇。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-12-08T04:21:33.060

OSX 10.8.2，红宝石 1.9.3p125

以上都不适合我...我厌倦了为我的环境寻找合适的宝石，所以我只是软链接到 g++ 目标，这些东西丢失了：

```
sudo ln -s `which g++` /usr/bin/g++-4.2 
```

对远程部署没有帮助，但可以在我的工作站上完成工作。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-12-19T18:10:06.840

我遇到了类似的问题，但它也抱怨找不到 g++-4.2。我*确实*安装了 XCode 命令行工具，但它正在寻找 /usr/bin/g++-4.2，我有 g++（这是一个指向 llvm-g++-4.2 的符号链接）。无论如何，我刚刚创建了一个指向 g++ 的符号链接并再次尝试了 bundle install ......它成功了！

`$ cd /usr/bin`

`$ sudo ln -s g++ g++-4.2`

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-12-07T00:55:04.233

有同样的错误，这对我有用：

1.  从控制台：`gem uninstall libv8`

2.  在您的 Gemfile 中，添加以下内容：

    ```
    gem 'therubyracer', :platforms => :ruby, :require => 'v8'
    gem 'libv8', '~> 3.11.8'  # Update version number as needed 
    ```

3.  从控制台：`bundle install`

如果您正在升级 ruby​​racer gem，您可能还想在`bundle update therubyracer`此之后运行。（考虑指定版本号）

这是在 Mac 10.6 (Snow Leopard) 上。***

# javascript - 验证 2 个下拉菜单（仅某些组合有效）

> ID：10905824
> 
> 赞同：0
> 
> 时间：2012-06-05T22:22:07.273
> 
> 标签：javascript, drop-down-menu

我对 JavaScript 完全陌生。
我在页面上有尺寸和颜色下拉菜单供用户订购产品，但只有某些组合可用，即粉红色是大尺寸的唯一颜色。
我想我会制作一个允许大小的数组并针对这些测试用户输入。如果选择无效，那么我想要一个弹出窗口告诉用户原因。

在现实世界中，我将使用 SQL 和 PHP 创建允许选择的数组，在下面的示例中，我硬编码了 3 个有效的测试选择。不幸的是，下面的代码没有做任何事情。
我敢肯定这是一个简单的新手错误。我真的不知道我在做什么 :)
有人可以帮帮我吗？

验证功能应该在用户单击表单提交时发生...

```
<form id="form1" name="form1" method="post" onsubmit="return validate_form()"
      action="cart.php"> 
```

这是功能：

```
<script type="text/javascript"> 
function validate_form() {
    var allowed = new Array();
        allowed[0]="10,beige";      
        allowed[1]="10,black";
        allowed[2]="10,pink";

    var chosenColInd = document.getElementById("colID");
    var chosenColText = colID.options[colID.selectedIndex].text;
    var chosenSizeInd = document.getElementById("sizeID");
    var chosenSizeText = sizeID.options[sizeID.selectedIndex].text;
    var chosenSizeCol = chosenSizeText+","+chosenColText; 
    var found = "false";

    for ( var i = 0; i < allowed.length; i++ ) {
        if (allowed[i]=chosenSizeCol) {
            found = "true";
        }
    }
    if (found = "false") {
        alert( 'The variation you have selected is currently unavailable. Please select another.' );
        return false;
    } else {
        return true;
    }
}
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T22:41:19.440

有几行您使用赋值运算符（即单等号`=`）而不是一个等式运算符（即双等或三等，JavaScript 中通常首选三等）。例子：

```
if (found = "false") { 
```

乍一看似乎是问题 - 这是一个分配而不是比较:) 使用三等`===`号而不是单号：

```
if(found === "false") { 
```

此外，请考虑对您的代码进行以下（已注释）更新，这些更新更多地反映了 JavaScript 代码的典型风格：

```
function validate_form() {

    //no need to use new Array(), use array literal instead
    var allowed = [
        "10,beige",      
        "10,black",
        "10,pink"
    ];

    var chosenColInd = document.getElementById("colID");
    var chosenColText = colID.options[colID.selectedIndex].text;
    var chosenSizeInd = document.getElementById("sizeID");
    var chosenSizeText = sizeID.options[sizeID.selectedIndex].text;
    var chosenSizeCol = chosenColText+","+chosenSizeText; 
    var found = "false";

    for ( var i = 0; i < allowed.length; i++ ) {

        //use equality operator instead of assignment
        if (allowed[i]===chosenSizeCol) {
            found = true; //may as well use a boolean rather than string
            break; //exit loop early, no need to continue if we've already found 
        }
    }
    if (!found) { //no need to do a comparison with already boolean values
        alert( 'The variation you have selected is currently unavailable. Please select another.' );
    }
    //may as well just return found here now that we're using a boolean
    return found;
} 
```

# jsp - 在 jsp 中使用搜索时出错

> ID：10905828
> 
> 赞同：0
> 
> 时间：2012-06-05T22:22:15.190
> 
> 标签：jsp, search

我正在开发一个jsp 页面，用户可以通过使用允许他按类别、标题或发行日期搜索的搜索表单来浏览电影集合。如果没有任何搜索条件，则应显示所有电影。我的问题是，只有**按发布年份搜索可以正常工作，但按标题搜索不起作用，它什么也不显示，没有结果**当我把它放在年份搜索的底部时，按标题搜索不起作用，并且反之亦然

```
 <% 

         String s1 = request.getParameter("Ttl");
         String s2 = request.getParameter("Yr");

       out.println("<TABLE >");
      out.println("<TR>");
      out.println("<TH>Category</TH>");
      out.println("<TH>Title</TH>");
      out.println("<TH>Release Year</TH>");
      out.println("<TH>Rental Price</TH>");
      out.println(" <TH></TH>");
      out.println("<TH></TH>");
      out.println(" </TR>");

          String sql = //search if no search condition
        "SELECT *" +
        " FROM users" +
        " WHERE ";

          if (s1!=null && !(s1.equals(""))){ //search by title 
                       sql =  sql +
        "title LIKE '%" +
        s1 + "%'";
                                             } 
              if (s2!=null){                   //search by year
                       sql =  sql +
        " year LIKE '%" +
        s2 + "%'";
                                             }  

     try{  
  Connection con =
        DriverManager.getConnection("jdbc:odbc:UsersData");
      System.out.println("got connection");

    Statement s = con.createStatement();
      ResultSet rs = s.executeQuery(sql);                
      while (rs.next()) {
          out.println("<TR>");
       String id = rs.getString(5);
        out.println("<TD>" + rs.getString(1) + "</TD>");
        out.println("<TD>" +    rs.getString(2) + "</TD>");
        out.println("<TD>" +  rs.getString(3) + "</TD>");
        out.println("<TD>" + rs.getString(4) + "</TD>");
       out.println("<TD><A HREF=Add to shoping cart?id=" + id + ">Add to shoping cart</A></TD>");
        out.println("</TR>");
      }
      s.close();
      con.close();
    }

    catch (SQLException e) {
    }
    catch (Exception e) {
    }
    %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:39:01.230

您是按年份和标题搜索吗？如果是这样，我在这两个条件子句之间看不到“AND”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T22:57:51.200

您的 SQL 中需要一个条件，例如`OR`.

更重要的是，即使您*必须*在 JSP 中使用 scriptlet，这也是一种糟糕的方法：HTML 应该就是 HTML；绝对没有理由在 scriptlet 中这样做。

# javascript - 在 JavaScript 函数运行时加载图像

> ID：10905829
> 
> 赞同：1
> 
> 时间：2012-06-05T22:22:20.150
> 
> 标签：javascript, jquery

有没有办法在 JavaScript 函数运行时显示加载图像。我有一个大约需要 2-5 秒，如果我能有类似 jQuery-ajax 函数的东西会很好

```
$("#loading").bind("ajaxStart", function(){
    $(this).attr("style", "visibility: visible")
}).bind("ajaxStop", function(){
    $(this).attr("style", "visibility: hidden")
}); 
```

澄清编辑：

这个想法是，每当一个 JavaScript 函数运行并接管时，比如 3/4 秒，就会显示加载图像。它实际上与这个 ajax 函数无关，只是始终捕获正在运行的 JavaScript 并对其进行计时的相同原理。

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-05T22:26:34.940

那么......在你发表评论之后，这改变了一切。

你不能让它在*任何 javascript 运行*时自动显示，因为没有真正的钩子。[`.trigger()`](http://api.jquery.com/trigger/)但是，您可以通过使用和使用您自己的自定义事件来利用 jquery 自[`.bind()`](http://api.jquery.com/bind/)定义事件。

```
function myFunctionThatDoesSomething() {
  $('body').trigger('Custom.BeginWork');

  // Do Something ...

  $('body').trigger('Custom.EndWork');
} 
```

尽管**长时间运行的操作可能应该异步完成**，因此它们不会阻塞事件：

```
$("#Something").click(function() {
   $('body').trigger('Custom.BeginWork');
   setTimeout(function() { DoWorkFunction(/* you can pass params here if you need */); }, 0); 
   // Causes it to be executed in the background 0ms from now
});

function DoWorkFunction() {
   // Stuff...

   $('body').trigger('Custom.EndWork');
} 
```

然后注册一个`.bind()`事件，就像`.ajaxStart()`和`.ajaxStop()`

```
$('#Working').bind('Custom.StartWork', function() {
  $(this).show();
});

$('#Working').bind('Custom.EndWork', function() {
  $(this).hide();
}); 
```

这是一个[有效的 jsFiddle 示例](http://jsfiddle.net/UtUFV/2/)。

* * *

更新：

在[您的 jsFiddle 中](http://jsfiddle.net/JYAdp/)，您已经完成了 double `setTimeout`。这里：

```
setTimeout(function() {
        // Call Operation Here
        try { setTimeout(function () { LongRunningOperation(10000);  }, 1000);
        }
        finally
        {
            $("body").trigger('Custom.End');
        }
    }, 50); // 50ms delay because some browsers *cough*IE*cough* are slow at rendering dom changes 
```

这转化为：

![图表](../Images/95f0a23f869f84b9b894d85c1cef0c48.png)

因此，`Custom.End`事件在**安排**长时间运行的函数运行后被触发，而不是在它完成时触发。`setTimeout`是*异步*和非阻塞的。

# internet-explorer-8 - jQuery DatePicker 日历在 IE8 中不起作用

> ID：10905830
> 
> 赞同：0
> 
> 时间：2012-06-05T22:22:33.123
> 
> 标签：internet-explorer-8, jquery-ui-datepicker

这个问题[**引用了之前**](https://stackoverflow.com/questions/10889780/jquery-datepicker-calendar-not-returning-correct-month/)已回答的帖子。现在的问题......它在 IE8 中不起作用。它在 Chrome 和 Firefox 中完美运行。

在 IE8 中，将出现日历，并突出显示当前日期。它似乎没有加载我的 XML，因此事件可以出现在日历中。

有谁知道为什么这在 IE8 中不起作用？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T16:49:13.457

因此，经过大量研究以及用户@Andrew Whitaker 和@Qlimax 的指导，我发现 IE 对我从 XML 文件中提取日期的方式并不满意。

我更改了我的 getSelectedDates 函数来解析发布的日期，以便 IE 对此感到满意。（Chrome 和 Firefox 也很高兴。）

```
function getSelectedDates() {
    return $(data).find('entry').map(function() {
        var dateStr = $('published', this).text();
        var a = dateStr.split("T");
        var d = a[0].split("-");
        var t = a[1].split(":");

        return {
            title: $('title', this).text(),
            published: new Date(d[0],(d[1]-1),d[2])
        };
    }).get();
} 
```

# ruby-on-rails - <> 在 Ruby 中是什么意思？

> ID：10905841
> 
> 赞同：1
> 
> 时间：2012-06-05T22:23:13.257
> 
> 标签：ruby-on-rails, ruby

我有几个月前编写的这段代码：

```
@shipments = Shipment.joins(:invoice).where(:customer_id => @customer.id).where("customer_open_balance <> 0").order("file_number ASC") 
```

我忘了什么`<>`意思。我在网上搜索并浏览了我的 Pickaxe 书，但找不到答案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-05T22:25:23.793

`<>`是[SQL](http://www.w3resource.com/sql/comparison-operators/comparison-not-equal-to-operator.php)，意思是“不等于”，又名`!=`

# c# - 在后台线程上创建表单并使用 Form.ShowDialog

> ID：10905844
> 
> 赞同：8
> 
> 时间：2012-06-05T22:23:23.377
> 
> 标签：c#, winforms, multithreading

使用 Winforms，如果我在一个不是“主”ui 线程的线程上，我可以安全地

1.  创建一个表格，
2.  在该表单上调用 ShowDialog

似乎我会遵守以下规则：必须在创建它们的线程上修改 Winforms 控件。

从我所做的一些阅读来看，ShowDialog 似乎会创建自己的消息泵，这样我就不必担心在已经有消息泵的线程上创建表单。

问题的背景是我收到一个回调，我想在其中显示一些 Winforms UI，但我无权访问可用于调用主线程的任何其他 UI。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-06T00:03:08.467

这大致正确，尽管调用线程的 SetApartmentState() 方法将线程切换到 STA 非常重要。对许多 UI 操作很重要，包括剪贴板、拖放和 shell 对话框。当您在线程上创建的表单不在前台并隐藏在另一个窗口后面时，您通常会遇到糟糕的 Z 顺序问题。或者当用户没有预料到它并意外地抓住鼠标点击或击键时，实际上*确实*在前台移动了令人讨厌的习惯。

这些是很难解决的问题，它们确实会使您的应用程序变得不稳定。没有充分的理由没有引用来调用，您也可以通过某种方式将其传递给类。如果真的有必要，您总是可以使用 Application.OpenForms[0]。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T22:51:43.477

是的，您可以这样做，但是如果您希望对话框实际上像模态对话框一样运行（即，阻止父窗口，我假设您想要这样做，因为您正在调用`ShowDialog`）然后准备好失望。

您实际上要在这里解决什么问题。听起来您想要一个不阻塞的模态对话框，这有点奇怪。如果您解释手头的问题，则可能存在您尚未考虑的解决方案。

# java - Tomcat7 JDBC 池

> ID：10905853
> 
> 赞同：3
> 
> 时间：2012-06-05T22:24:58.857
> 
> 标签：java, mysql, servlets, amazon-web-services, tomcat7

我在 META-INF 中有以下内容

```
<Context>
   <Resource type="javax.sql.DataSource"
        name="jdbc/TestDB"
        factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"
        driverClassName="com.mysql.jdbc.Driver"
        url="jdbc:mysql://localhost:3306/"
        username="mysql_user"
        password="mypassword123"/>
</Context> 
```

在我的 web.xml 我有

```
<resource-ref>
  <description>DB Connection</description>
  <res-ref-name>jdbc/TestDB</res-ref-name>
  <res-type>javax.sql.DataSource</res-type>
  <res-auth>Container</res-auth>
</resource-ref> 
```

在我的 Java 代码中，我有

```
Context initContext = new InitialContext();
Context envContext  = (Context)initContext.lookup("java:/comp/env");
DataSource datasource = (DataSource)envContext.lookup("jdbc/TestDB");
con = datasource.getConnection(); 
```

Tomcat 启动时出现以下错误，并且我的 libs 文件夹中有 mysql-connector-java-5.1.20-bin.jar。知道为什么吗？

```
INFO: Starting Servlet Engine: Apache Tomcat/7.0.27
05-Jun-2012 23:16:29 org.apache.naming.NamingContext lookup
WARNING: Unexpected exception resolving reference
java.sql.SQLException: com.mysql.jdbc.Driver
at org.apache.tomcat.jdbc.pool.PooledConnection.connectUsingDriver(PooledConnection.java:242)
at org.apache.tomcat.jdbc.pool.PooledConnection.connect(PooledConnection.java:175)
at org.apache.tomcat.jdbc.pool.ConnectionPool.createConnection(ConnectionPool.java:684)
at org.apache.tomcat.jdbc.pool.ConnectionPool.borrowConnection(ConnectionPool.java:616)
at org.apache.tomcat.jdbc.pool.ConnectionPool.init(ConnectionPool.java:479)
at org.apache.tomcat.jdbc.pool.ConnectionPool.<init>(ConnectionPool.java:135)
at org.apache.tomcat.jdbc.pool.DataSourceProxy.pCreatePool(DataSourceProxy.java:114)
at org.apache.tomcat.jdbc.pool.DataSourceProxy.createPool(DataSourceProxy.java:101)
at org.apache.tomcat.jdbc.pool.DataSourceFactory.createDataSource(DataSourceFactory.java:501)
at org.apache.tomcat.jdbc.pool.DataSourceFactory.getObjectInstance(DataSourceFactory.java:224)
at org.apache.naming.factory.ResourceFactory.getObjectInstance(ResourceFactory.java:143)
at javax.naming.spi.NamingManager.getObjectInstance(NamingManager.java:304)
at org.apache.naming.NamingContext.lookup(NamingContext.java:843)
at org.apache.naming.NamingContext.lookup(NamingContext.java:154)
at org.apache.naming.NamingContext.lookup(NamingContext.java:831)
at org.apache.naming.NamingContext.lookup(NamingContext.java:168)
at org.apache.catalina.core.NamingContextListener.addResource(NamingContextListener.java:1061)
at org.apache.catalina.core.NamingContextListener.createNamingContext(NamingContextListener.java:671)
at org.apache.catalina.core.NamingContextListener.lifecycleEvent(NamingContextListener.java:270)
at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)
at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)
at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5161)
at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1566)
at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1556)
at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
at java.util.concurrent.FutureTask.run(FutureTask.java:138)
at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
at java.lang.Thread.run(Thread.java:662)
Caused by: java.lang.ClassNotFoundException: com.mysql.jdbc.Driver
at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
at java.security.AccessController.doPrivileged(Native Method)
at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
at java.lang.Class.forName0(Native Method)
at java.lang.Class.forName(Class.java:247)
at org.apache.tomcat.jdbc.pool.PooledConnection.connectUsingDriver(PooledConnection.java:235)
... 29 more 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T22:32:44.373

您缺少 MySQL 的 JDBC 驱动程序。

从 MySQL 的网站下载它们：http: [//dev.mysql.com/downloads/connector/j/](http://dev.mysql.com/downloads/connector/j/)

将驱动程序添加到您的类路径、项目或 Tomcat 的 HOME\lib 目录。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-01-26T09:42:41.393

我在 Ubuntu 上通过 apt-get 机制安装了 Tomcat7 时遇到了这个问题。问题是Tomcat使用的dbcp，更具体地说是commons-dbcp.jar而不是tomcat-dbcp.jar。

为了解决这个问题，我`catalina*.jar`从`tomcat-dbcp.jar`tomcat 站点下载的 Tomcat7 副本中获取并替换了 tomcat 的 lib 文件夹中的文件。（`commons-dbcp.jar`替换为`tomcat-dbcp.jar`）。

请参阅[此链接](https://forums.alfresco.com/forum/installation-upgrades-configuration-integration/installation-upgrades/solved-get-java-error)。

# android - 未显示主要活动的 onCreate 中的进度对话框

> ID：10905856
> 
> 赞同：3
> 
> 时间：2012-06-05T22:25:15.200
> 
> 标签：android, dialog, progressdialog, oncreate

在启动画面之后，在 Main 活动中加载 onCreate 内容大约需要 6 秒。所以我想在加载时显示一个进度对话框，这就是我所做的：

```
import ...

private ProgressDialog mainProgress;

public void onCreate(Bundle davedInstanceState){
    super.onCreate(savedInstanceState);

    setContentView(R.layout.main);

    mProgress = new ProgressDialog (Main.this);
    mProgress.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);
    mProgress.setMessage("Loading... please wait");
    mProgress.setIndeterminate(false);
    mProgress.setMax(100);
    mProgress.setProgress(0);
    mProgress.show();

    ---some code---

    mProgress.setProgress(50);

    ---some code---

    mProgress.setProgress(100);
    mProgress.dismiss();
} 
```

它不起作用......屏幕保持黑色 5-6 秒，然后加载主布局。我不知道我做错了哪一部分:*(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T22:33:42.283

您需要在其他线程（而不是 UI 线程）中启动繁忙的代码。
在您的活动中创建 ProgressDialog 并在线程中关闭它

```
mProgress = new ProgressDialog (Main.this);

Runnable runnable = new Runnable() {
    @Override
    public void run() {
        // code that needs 6 seconds for execution

        // after finishing, close the progress bar
        mProgress.dismiss();
    }
};

new Thread(runnable).start(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T22:36:12.937

这是因为你在 UI 线程上做所有事情，因此阻塞了它。

您应该在一个单独的线程中完成所有繁重的工作，并通过该线程更新进度对话框

# macros - 显示从 lisp 宏生成的代码

> ID：10905857
> 
> 赞同：2
> 
> 时间：2012-06-05T22:25:20.970
> 
> 标签：macros, lisp

我对 lisp 很陌生，这很可能是一个非常愚蠢/显而易见的问题，但通常 lisp 可以显示从宏生成的代码吗？

所以对于这个例子

```
(defmacro nil! (var)
  (list 'setq var nil)) 
```

我希望能够看到扩展代码

```
(setq a nil) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T22:31:21.287

正如迭戈所说... [MACROEXPAND-1](http://www.lispworks.com/documentation/HyperSpec/Body/f_mexp_.htm)。

```
* (macroexpand-1 '(nil! frob))

(SETQ FROB NIL)
T
* 
```

# google-app-engine - 用于企业管理系统的 GAE DataStore 与 Google Cloud SQL

> ID：10905861
> 
> 赞同：14
> 
> 时间：2012-06-05T22:25:32.627
> 
> 标签：google-app-engine, google-cloud-datastore, google-cloud-sql

我正在构建一个使用 gae 的企业管理系统应用程序。我已经使用 gae 和数据存储构建了多个应用程序，但从来没有一个需要大量用户输入事务以及需要管理和管理报告的应用程序。我最大的恐惧是，当我需要创建交叉表和其他详细报告（或商业智能报告和数据操作）时，我将面临 gae 的数据存储查询和数据拉取限制的大量问题。这真的只是架构偏好还是这里有数量问题？

过去，我曾针对 Oracle/MySql/MSSql 使用 C++/c#/Java 构建系统（在复杂或经常访问的数据库结果中添加了一个缓存层以提高性能）。

我一直在读到，我们要抛弃旧的关系数据心态，转向空中大 McHashTable 的新世界……但新的并不总是更好……任何关于上述内容的见解或经验都会有所帮助。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-06T15:05:44.573

从[Cloud SQL 常见问题解答](https://developers.google.com/cloud-sql/faq#choice)：

> 我应该使用 Google Cloud SQL 还是 App Engine Datastore？
> 
> 这取决于应用程序的要求。Datastore 提供高度可扩展的 NoSQL 键值 > 存储，但不支持 SQL 数据库提供的复杂查询。Cloud SQL 支持复杂的查询和 ACID 事务，但这意味着数据库充当“固定管道”并且性能的可扩展性较差。许多应用程序使用这两种类型的存储。

如果您需要对带有分布式密钥的 db 实体进行大量写入（每秒钟约 XXX 次），那么这就是 Google App Engine 数据存储区真正发挥作用的地方。

如果您需要支持复杂且随机的用户制作的查询，那么 Google Cloud SQL 会更方便。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-06T06:09:20.783

在 GAE 数据存储中更让我害怕的是索引数限制。例如，如果您需要按某个字段搜索或排序 - 您需要 +1 索引。总共可以有 200 个索引。如果您有具有 10 个可搜索字段的实体，并且您可以按任何字段排序 - 将有大约 100 个组合。所以你需要 100 个索引。我为 gae 开发了几个小项目——这就是成功案例。但是当大人物来临时 - 这不是为了 gae。

关于缓存——你可以用 gae 来做，但他们的分布式缓存工作很慢。我更喜欢使用 RESTfull API 创建永久后端的私有单个实例，该 API 将缓存值保存在内存中。前端实例调用此 API 来获取/设置值。

也许用 gae 构建复杂的系统是可能的，但这将是一组小型应用程序/服务。

# android - 在 Android 中，如何将维度值转换为精确的浮点值？

> ID：10905865
> 
> 赞同：0
> 
> 时间：2012-06-05T22:25:53.660
> 
> 标签：android

我有一个维度资源值

```
<dimen name="arrowButton_textValue_textSize">20sp</dimen> 
```

我通过以下两种方式使用该值

```
<TextView
android:id="@+id/arrowButton_textValue"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:textSize="@dimen/arrowButton_textValue_textSize"/> 
```

和

```
float _textSize = getResources().getDimension(R.dimen.arrowButton_textValue_textSize);
TextView _textView = (TextView) findViewById(R.id.arrowButton_textValue);
_textView.setTextSize(_textSize); 
```

我认为这两种方法是相同的，尽管它们在真实设备上会导致不同的文本大小。例如，在某些设备（HTC Wildfire S）上，它们看起来相同，但在 HTC Desire 上却不同，第二种方法会生成更大的文本大小

如何根据设备实际显示指标将维度转换为真实设备上的精确浮点？

# c++ - 什么是转换构造函数

> ID：10905866
> 
> 赞同：4
> 
> 时间：2012-06-05T22:25:56.470
> 
> 标签：c++, constructor

```
class Complex
{
private:
double real;
double imag;

public:
// Default constructor
Complex(double r = 0.0, double i = 0.0) : real(r), imag(i) {}

// A method to compare to Complex numbers
bool operator == (Complex rhs) {
   return (real == rhs.real && imag == rhs.imag)? true : false;
}
};

int main()
{
// a Complex object
Complex com1(3.0, 0.0);

if (com1 == 3.0)
   cout << "Same";
else
   cout << "Not Same";
 return 0;
} 
```

输出：相同

为什么这段代码给出的输出相同，转换构造函数如何在这里工作，请解释一下，非常感谢提前

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-05T22:29:34.953

转换构造函数是可以`explicit`使用一个参数调用的任何非构造函数。在您的代码示例中，由于`Complex`构造函数为其参数提供默认值，因此可以使用单个参数（例如`3.0`）调用它。并且由于这样的构造函数没有被标记`explicit`，那么它是一个有效的转换构造函数。

当你这样做时——`com1 == 3.0`假设没有`operator ==`介于`Complex`和`double`——一个转换构造函数被调用。所以你的代码相当于这个：

```
if( com1 == Complex(3.0) ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T22:33:53.923

在您的示例中，编译器看到在对象`==`上使用的运算符`complex`并试图找到一种使其工作的方法。只有一个`operator==`，它需要一个`complex`论点。由于有一个`complex`构造函数接受 double 且未标记`explicit`，因此它使用它来生成一个临时`complex`对象，然后将其传递给`operator==`.

# joomla - 在 Joomla 中将一组表单字段存储在多维数组中

> ID：10905868
> 
> 赞同：0
> 
> 时间：2012-06-05T22:26:13.797
> 
> 标签：joomla, joomla-extensions, joomla2.5, joomla-component

这是设置（使用虚构的场景），但适用于我的真实情况：出于解释的目的，假设我设计 T 恤（我们称它们为 ShirtA、shirtB、shirtC）。我没有自己销售它们，而是有几个供应商为我销售产品（我们将它们称为供应商 X、Y 和 Z）。我的 Joomla 数据库中有一个供应商表格，还有一个 T 恤表格。当客户从该供应商处购买时，他们将访问我的网站并根据 ID url 变量显示不同供应商的页面。每个供应商都可以选择出售我所有的 T 恤，或者只出售其中的一部分。此外，供应商可以用他们自己的价格覆盖我在 T 恤表中设置的价格。在组件的管理部分，每个供应商都需要能够选择他们想要销售的 T 恤，

这就是我想象的样子......每个供应商都会在他们的表中有一列，其中将包含多维数组的序列化数据。主数组包含我的 T 恤表中的每件 T 恤的子数组。这些子数组中的每一个都包含所有覆盖数据（价格、提供的尺寸等）。

我将如何在 Joomla 2.5 组件中编写模型、视图和/或编辑页面，以便供应商可以选择组件管理页面中的所有选项，并将其序列化在一列中？

如果这解释得不好，我很抱歉，请不要犹豫，询问您是否需要进一步的信息来帮助我。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T09:03:24.180

我不想这么说，但我认为在 Joomla 2.5 中没有“标准”方法可以做到这一点。Joomla 有各种方式与数据库交互并使用它们的标准类，但据我所知，没有一个类是为处理序列化数据而设计的，所以你会被困在手工构建所有部分。

话虽如此，一般来说，模型应该处理检索和存储序列化数据，视图会从模型请求数据库中的任何数据，编辑页面应该反序列化数据并以供应商可以添加的方式显示它他们的覆盖。除此之外，您可以以自己的方式对每个部分进行编码。

# ruby-on-rails - 如何将 has_secure_password 与 field_with_errors 一起使用

> ID：10905870
> 
> 赞同：4
> 
> 时间：2012-06-05T22:26:21.080
> 
> 标签：ruby-on-rails, ruby

我正在使用 has_secure_password 来验证我的用户密码及其确认。我遇到的问题是，当有任何错误时，字段没有被 field_with_errors div 包装。我知道我可以添加

```
validates_presence_of :password, :on => :create
validates_presence_of :password_confirmation, :on => :create 
```

但这会产生以下错误消息：

> 密码摘要不能为空。
> 密码不能为空。
> 密码确认不能为空

我想让**has_secure_password**使用 field_with_errors div 包装有错误的字段，**或者**删除“密码摘要不能为空”。完全错误。

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-06T17:05:29.820

具有此功能的[SecurePassword](https://github.com/rails/rails/blob/3-2-stable/activemodel/lib/active_model/secure_password.rb)模块非常简单，值得一看。好消息是，在[master 分支（Rails 4）](https://github.com/rails/rails/blob/master/activemodel/lib/active_model/secure_password.rb)中，它`validates_presence_of :password, :on => :create`可以解决您的问题，但与此同时，您可能希望`has_secure_password`自己在 User 模型上模仿该方法。

```
class User < ActiveRecord::Base
  attr_reader :password
  attr_accessible :password # ...
  validates_confirmation_of :password
  validates_presence_of :password, on: :create
  include ActiveModel::SecurePassword::InstanceMethodsOnActivation
end 
```

还要确保`bcrypt`在 Gemfile 中加载。

```
gem 'bcrypt-ruby', '~> 3.0.0', require: 'bcrypt' 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-08T09:26:47.097

正如@ryanb 所说，`validates_presence_of :password`在 master 中是固定的，但不会被反向移植。该修复程序还清除了`Password digest can't be blank.`消息。

因此，在模型中，您仍然需要添加：

```
validates :password, presence: true, on: :create 
```

正如@henrique-zambon 所说，没有必要添加`validates_presence_of :password_confirmation`. 要突出显示密码确认字段，而不显示其他消息，请在显示错误*后*在该字段上添加错误。

然后，要隐藏多余的`Password digest can't be blank.`消息，您只需在表单顶部将其删除即可。

```
= form_for @user do |f|
  - if @user.errors.any?
    - @user.errors.delete(:password_digest)
    #error_explanation
      %h2= "#{pluralize(@user.errors.count, "error")} prohibited this user from being saved:"
      %ul
        - @user.errors.full_messages.each do |msg|
          %li= msg
    - @user.errors.add(:password_confirmation) if @user.errors.include?(:password) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-06T04:34:14.730

无需验证 的存在`:password_confirmation`，`has_secure_password`为您执行此操作。

您可能需要检查此 RailsCast：[Rails 3.1 中的身份验证](http://railscasts.com/episodes/270-authentication-in-rails-3-1)

# java - 从失败的 Camel Exchange 访问同步

> ID：10905876
> 
> 赞同：2
> 
> 时间：2012-06-05T22:26:58.320
> 
> 标签：java, activemq, apache-camel

我想访问在骆驼路线期间添加到交换中的所有同步。

这样做的原因是，当发生特定类型的异常时，我想将消息路由到错误处理组件，并让该错误处理组件执行这些同步的“onCompletion”，即使出现异常也是如此。

通过使用添加同步

```
exchange.getUnitofWork().addSynchronization(new MySyncAdapter()); 
```

我试图访问它们

```
exchange.handoverCompletions(); 
```

但是，我认为我一定做错了，因为无论我尝试从哪个组件（我的真实组件或错误组件）获取完成，列表都是空的。

编辑：

根据他在下面的回答，这应该有效：

```
exchange.addOnCompletion(new MySyncAdapter());
List<Synchronization> syncs = exchange.handoverCompletions(); 
```

但是，syncs 仍然为空。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T16:27:00.873

在这种情况下，Exchange 没有 Completions/Synchronizations，UnitOfWork 实例在您调用时会这样做，`exchange.handoverCompletions()`您将得到一个空值。您也无权访问 UnitOfWork 中的同步，因为它是在不同的线程中处理的。任何修改它们的尝试，这就是 handoverCompletion 所做的，都会导致并发异常。

实际上，您正试图以非预期的方式使用某些东西。应通过调用[此处](http://camel.apache.org/exception-clause.html)概述的异常子句 DSL 来处理交换错误。它旨在通过允许开发人员定义异常类型并将 Exchange 转发到路由以供错误处理组件进一步处理，从而以细粒度的方式捕获交换错误。

最好的问候，斯科特 ES

# .net - 使用 DataGridView 更新 MySQL

> ID：10905883
> 
> 赞同：0
> 
> 时间：2012-06-05T22:27:25.500
> 
> 标签：.net, mysql, database, datagridview

这要交给天才，让我们看看你能不能帮助我。

```
Imports System
Imports System.Data

' Version 6.5.4.0 Runtime v2.0.50727
Imports MySql.Data.MySqlClient

Public Class MainForm

  ' Config - Main. 
  Private db_host As String = ""
  Private db_username As String = ""
  Private db_userpass As String = ""
  Private db_catalog As String = ""
  Private db_port As String = "3306"

  ' Config - Specific Table.
  Private db_specific_table As String = "SF6SETUP"

  ' Config - Other.
  Private DS As DataSet
  Private DA As MySqlDataAdapter
  Private BS As BindingSource

  ' ***
  '
  ' ***
  Private Sub My_Init()

    Dim conn As String = "Data Source = " & db_host & ";Initial Catalog=" & db_catalog & "; uid=" & db_username & ";password=" & db_userpass
    Dim myConnection As New MySqlConnection(conn)
    Dim cmd As String = "SELECT * FROM " & db_specific_table

    DA = New MySqlDataAdapter(cmd, myConnection)
    ' This line of code to generate update commands automatically.
    ' This update method of would not work without this line of code. 
    Dim MySQLCommandBuilder As New MySqlCommandBuilder(DA)

    myConnection.Open()

    DS = New DataSet()
    DA.Fill(DS, "MyTable")

    BS = New BindingSource
    BS.DataSource = DS.Tables(0)

    Dim BN As BindingNavigator = New BindingNavigator()
    BN.BindingSource = BS
    DataGridView.DataSource = BS

  End Sub

  ' ***
  '
  ' ***
  Private Sub MainForm_Load(sender As Object, e As System.EventArgs) Handles Me.Load

    My_Init()

  End Sub

  Private Sub DataGridView_KeyPress(sender As System.Object, e As System.Windows.Forms.KeyPressEventArgs) Handles DataGridView.KeyPress
    BS.EndEdit()
    DA.Update(DS, "MyTable")
  End Sub
End Class 
```

有一个错误：

System.Data.dll 中出现“System.InvalidOperationException”类型的未处理异常

附加信息：对于不返回任何键列信息的 SelectCommand，不支持为 UpdateCommand 生成动态 SQL。

这段代码工作除了没有保存到 MySQLDatabase 的更改！！！请帮我解决这个问题。

谢谢，

麦克风

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T23:22:23.517

根据错误，您的表没有主键 - 您如何期望 update 知道要更新哪一行（可能有重复）。

# google-docs-api - 区分更改 API 提要中的文件内容更改和元数据更改

> ID：10905889
> 
> 赞同：0
> 
> 时间：2012-06-05T22:28:07.577
> 
> 标签：google-docs-api

我的应用程序在本地缓存 Google Docs 文件并且需要更新它们然后乳清改变。当我请求更改提要时，结果包括所有已更改的项目，无论更改的类型如何。我只需要重新下载那些实际内容发生变化的项目；我不需要下载仅与新人共享或以其他方式更改其元数据的文档。我知道您可以请求将扩展的 ACL 数据包含在更改提要中，但如果它仅帮助我检测权限更改而不是对元数据的其他更改，那可能还不够。

有没有办法做到这一点？正在下载的文件有时非常大（5-10MB），而且我经常跟踪的帐户有数千个文件，所以想象一下如果我的用户连接速度很慢而我的应用程序突然有由于简单的更改（例如与新用户共享文件夹）而重新下载数百个文件。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T01:25:44.160

修订提要怎么样？你可以准确地找到你需要的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T16:06:56.037

好的。我忽略了隐藏在 XML 中的简单答案：所有文档的文档提要中都包含一个校验和元素。

# visual-studio-2010 - 等效于 Windows 的 gettimeday()

> ID：10905892
> 
> 赞同：35
> 
> 时间：2012-06-05T22:28:21.523
> 
> 标签：visual-studio-2010, winapi

有谁知道`gettimeofday()`Windows 环境中该功能的等效功能？我正在比较 Linux 和 Windows 中的代码执行时间。我正在使用 MS Visual Studio 2010，它一直说，标识符“gettimeofday”未定义。

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2014-09-28T14:21:19.987

这是一个免费的实现：

```
#define WIN32_LEAN_AND_MEAN
#include <Windows.h>
#include <stdint.h> // portable: uint64_t   MSVC: __int64 

// MSVC defines this in winsock2.h!?
typedef struct timeval {
    long tv_sec;
    long tv_usec;
} timeval;

int gettimeofday(struct timeval * tp, struct timezone * tzp)
{
    // Note: some broken versions only have 8 trailing zero's, the correct epoch has 9 trailing zero's
    // This magic number is the number of 100 nanosecond intervals since January 1, 1601 (UTC)
    // until 00:00:00 January 1, 1970 
    static const uint64_t EPOCH = ((uint64_t) 116444736000000000ULL);

    SYSTEMTIME  system_time;
    FILETIME    file_time;
    uint64_t    time;

    GetSystemTime( &system_time );
    SystemTimeToFileTime( &system_time, &file_time );
    time =  ((uint64_t)file_time.dwLowDateTime )      ;
    time += ((uint64_t)file_time.dwHighDateTime) << 32;

    tp->tv_sec  = (long) ((time - EPOCH) / 10000000L);
    tp->tv_usec = (long) (system_time.wMilliseconds * 1000);
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-06-05T22:35:22.160

`GetLocalTime()`对于系统时区中的时间，`GetSystemTime()`对于 UTC。那些返回结构中的日期/时间`SYSTEMTIME`，将其解析为年、月等。如果您想要一个自纪元以来的秒数时间，请使用`SystemTimeToFileTime()`or `GetSystemTimeAsFileTime()`。这`FILETIME`是一个 64 位值，自 1601 年 1 月 1 日 UTC 以来的间隔数为 100ns。

对于间隔拍摄，使用`GetTickCount()`. 它返回自启动以来的毫秒数。

要以最佳分辨率（仅受硬件限制）获取间隔，请使用`QueryPerformanceCounter()`.

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2019-09-30T05:51:19.253

这是使用[chrono](http://www.cplusplus.com/reference/chrono/)的 c++11 版本。

谢谢你，[霍华德欣南特](https://stackoverflow.com/users/576911/howard-hinnant)的建议。

```
#if defined(_WIN32)
#include <chrono>

int gettimeofday(struct timeval* tp, struct timezone* tzp) {
  namespace sc = std::chrono;
  sc::system_clock::duration d = sc::system_clock::now().time_since_epoch();
  sc::seconds s = sc::duration_cast<sc::seconds>(d);
  tp->tv_sec = s.count();
  tp->tv_usec = sc::duration_cast<sc::microseconds>(d - s).count();

  return 0;
}

#endif // _WIN32 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-06T03:14:41.223

如果你真的想要一个 Windows gettimeofday() 实现，[这里有一个来自 PostgreSQL](http://git.postgresql.org/gitweb/?p=postgresql.git;a=blob;f=src/port/gettimeofday.c;h=75a91993b74414c0a1c13a2a09ce739cb8aa8a08;hb=HEAD)的，它使用 Windows API 和正确的转换。

但是，如果您想对代码进行计时，我建议您查看[QueryPerformanceCounter()](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644904%28v=vs.85%29.aspx)或者如果您只打算在 x86 上运行，则[直接调用 TSC 。](https://en.wikipedia.org/wiki/Time_Stamp_Counter#C.2B.2B)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-12-16T15:44:31.017

现在，我将在 Windows 上将以下内容用于 gettimeofday()，如果为 Windows 8 或更高版本编译，则使用 GetSystemTimePreciseAsFileTime()，否则使用 GetSystemTimeAsFileTime()：

```
#include <Windows.h>
struct timezone {
    int tz_minuteswest;
    int tz_dsttime;
};

int gettimeofday(struct timeval *tv, struct timezone *tz)
{
    if (tv) {
        FILETIME               filetime; /* 64-bit value representing the number of 100-nanosecond intervals since January 1, 1601 00:00 UTC */
        ULARGE_INTEGER         x;
        ULONGLONG              usec;
        static const ULONGLONG epoch_offset_us = 11644473600000000ULL; /* microseconds betweeen Jan 1,1601 and Jan 1,1970 */

#if _WIN32_WINNT >= _WIN32_WINNT_WIN8
        GetSystemTimePreciseAsFileTime(&filetime);
#else
        GetSystemTimeAsFileTime(&filetime);
#endif
        x.LowPart =  filetime.dwLowDateTime;
        x.HighPart = filetime.dwHighDateTime;
        usec = x.QuadPart / 10  -  epoch_offset_us;
        tv->tv_sec  = (time_t)(usec / 1000000ULL);
        tv->tv_usec = (long)(usec % 1000000ULL);
    }
    if (tz) {
        TIME_ZONE_INFORMATION timezone;
        GetTimeZoneInformation(&timezone);
        tz->tz_minuteswest = timezone.Bias;
        tz->tz_dsttime = 0;
    }
    return 0;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-07-18T12:20:39.367

自 Visual Studio 2015 以来，[`timespec_get`](https://en.cppreference.com/w/c/chrono/timespec_get)可用：

```
#include <inttypes.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

static uint64_t
time_ns(void)
{
    struct timespec ts;

    if (timespec_get(&ts, TIME_UTC) != TIME_UTC)
    {
        fputs("timespec_get failed!", stderr);
        return 0;
    }
    return 1000000000 * ts.tv_sec + ts.tv_nsec;
}

int main(void)
{
    printf("%" PRIu64 "\n", time_ns());
    return EXIT_SUCCESS;
} 
```

编译使用`cl t.c`并运行：

```
C:\> perl -E "system 't' for 1 .. 10"
1626610781959535900
1626610781973206600
1626610781986049300
1626610781999977000
1626610782014814800
1626610782028317500
1626610782040880700
1626610782054217800
1626610782068346700
1626610782081375500 
```

# java - 无法使用来自 Web 服务的二维对象返回值

> ID：10905893
> 
> 赞同：0
> 
> 时间：2012-06-05T22:28:29.287
> 
> 标签：java, web-services, object, arraylist

我有以下网络服务：

```
 @WebMethod(operationName = "getCaseTypeNamesAndIDs")
 public Object [][] getCaseTypeNamesAndIDs() {
    Object [][] nameIDs;
    int [] ids;

    ids = LOKmeth.getAllCaseTypes();
    nameIDs = new Object [ids.length][2];

    for(int ct = 0; ct < ids.length; ct++ )
    {
        nameIDs[ct][0] = LOKmeth.getCaseTypeName(ids[ct]);
    }

    for(int ct = 0; ct < ids.length; ct++ )
    {
        nameIDs[ct][1] = ids[ct];
    }

    return nameIDs;
} 
```

它应该用字符串形式的“案例类型”名称填充第一个维度，并用由整数组成的“案例类型”ID 填充第二个维度。

当我测试它输出的 Web 服务时：

**返回的方法**

```
java.util.List : "[net.java.dev.jaxb.array.AnyTypeArray@4a0cf658, net.java.dev.jaxb.array.AnyTypeArray@19013163, net.java.dev.jaxb.array.AnyTypeArray@1d516768]" 
```

**SOAP 响应**

```
<?xml version="1.0" encoding="UTF-8"?>
<S:Envelope xmlns:S="http://schemas.xmlsoap.org/soap/envelope/">
    <S:Body>
        <ns2:getCaseTypeNamesAndIDsResponse xmlns:ns2="http://LOK_WS/">
            <return>
                <item xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">Bugg</item>
                <item xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:int">3</item>
            </return>
            <return>
                <item xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">Felrapport</item>
                <item xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:int">1</item>
            </return>
            <return>
                <item xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">Printer on fire</item>
                <item xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:int">2</item>
            </return>
        </ns2:getCaseTypeNamesAndIDsResponse>
    </S:Body>
</S:Envelope> 
```

我认为方法返回是对数组的内存引用。

SOAP 响应包含正确的数据。

***我的问题如下：*** 如何在我的 jsp 页面中提取数据？

我试图做类似以下的事情（有一些变化）：

```
<%
try 
{
    lok_ws.CaseManagementWs_Service service = new lok_ws.CaseManagementWs_Service();
    lok_ws.CaseManagementWs port = service.getCaseManagementWsPort();

    java.util.List<net.java.dev.jaxb.array.AnyTypeArray> caseTypeNames = null;

    caseTypeNames = port.getCaseTypeNamesAndIDs();

    Object[][] result = new Object[1][];
    result[0] = caseTypeNames.toArray();

    out.println("<option value=\"\">");
    out.println(result[0][0].toString());
    out.println("</option>");
} catch (Exception ex) 
{
    // TODO handle custom exceptions here
}
%> 
```

[我在访问用 java 编写的 Web 服务方法时](https://stackoverflow.com/questions/3716926/a-java-lang-classcastexception-while-accessing-web-service-method-written-in-jav)阅读了A java.lang.ClassCastException。[jaxb](https://stackoverflow.com/questions/3716926/a-java-lang-classcastexception-while-accessing-web-service-method-written-in-jav)并试图遵循他的解决方案，但它没有帮助。

我必须做什么才能使用该方法给我的参考资料？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T09:35:04.273

我认为您的 Web 服务应该返回一个特定于应用程序的对象列表，而不是一个普通的 2-dim 数组。您的 Web 服务响应包含包含字符串和 int 字段的“案例类型”对象列表。所以最好（在网络服务端）创建一个类似于这样的类：

```
class CaseType {
  private int id;
  private String name;
  // getters, setters
} 
```

并且网络服务基本上应该返回一个 CaseType 对象列表 ( `List<CaseType>`) 。它不仅可以解决您的 Web 服务问题，而且还可以改进总体设计，因为使用显式和命名类是自文档化的，并且更易于阅读和维护。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T08:22:22.857

我和你有同样的问题，我期待 2 个昏暗的阵列。幸好朋友帮了我！

这是我的解决方案：

```
StringArray[] user = response.get_return();

for(int i = 0; i < user.length; i++){
    String[] a = user[i].getItem();

    for(String c:a)
        System.out.println(c);
} 
```

# c++ - C++：如何将数组的元素推送到数组列表中？

> ID：10905897
> 
> 赞同：1
> 
> 时间：2012-06-05T22:28:41.007
> 
> 标签：c++, list

我得到两个变量`a`，`b`并希望将它们直接添加到数组列表中。如何避免定义另一个数组，然后将其推入列表中？

我正在寻找类似于以 . 开头的行的结构`//`。

最小的例子：

```
#include <list>
#include <boost/array.hpp>

using namespace std;

int main()
{
    cout << endl;

    /* given values */
    int a = 1;
    int b = 2;

    /* arrayList contains arrays of integers. */
    list<boost::array<int, 2> > arrayList;

    /* item to add values */
    boost::array<int, 2> item;

    item[0] = a;
    item[1] = b;
    arrayList.push_back(item);

//  arrayList.push_back({{a, b}});

    cout << arrayList.front()[0] << ", " << arrayList.front()[1] << endl;

    return 0;

} 
```

我的 g++ 版本如下 `gcc-Version 4.6.3 (Ubuntu/Linaro 4.6.3-1ubuntu5)`：

编译（在 Eclipse 中）会抛出这个作为错误列出的警告： `Warnung: erweiterte Initialisierungsliste nur mit -std=c++0x oder -std=gnu++0x verfügbar [standardmäßig aktiviert] main.cpp /testArrayListAndFind line 24 C/C++ Problem` 这意味着：`Extended initilization list only with ... or ... available.`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T22:34:50.203

`list`必须创建推送到的数组，问题是您认为您认为可接受的工作/打字是什么。

例如，您可以创建一个辅助函数：

```
boost::array<int, 2> make_array(int a, int b)
{
  boost::array<int, 2> item;
  item[0] = a;
  item[1] = b;
  return item;
} 
```

那么你可以做

```
arrayList.push_back(make_array(a, b)); 
```

这假设您只需要数组中的 2 个元素。如果是这种情况，您也可以使用`std::pair<int, int>`代替`boost::array<>`. 否则，您可以创建一些重载`make_array()`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T22:55:29.153

`boost::assign::list_of`如果您没有 C++11 支持，您可以使用：

```
arrayList.push_back(boost::assign::list_of(1)(2)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T22:50:54.477

您可以将列表调整为您想要的大小并直接在列表中改变数组，例如，

```
arrayList.resize(10);

for(list::iterator iter = arrayList.begin(); iter != arrayList.end(); ++iter) {
  (*iter)[0] = <value_a>;
  (*iter)[1] = <value_b>;
} 
```

请注意，在您的示例中， *resize()*实际上调用了*boost::array*的构造函数，因此性能节省将是最小的。

# hadoop - Hadoop 加载和存储

> ID：10905903
> 
> 赞同：1
> 
> 时间：2012-06-05T22:29:06.460
> 
> 标签：hadoop, apache-pig, hdfs

当我尝试以这种方式运行具有两个“存储”到同一个文件的 Pig 脚本时

```
store Alert_Message_Count into 'out';
store Warning_Message_Count into 'out'; 
```

它挂起，我的意思是在显示完成 50% 后它不会继续。

这是错的吗？我们不能将两个结果存储在同一个文件（文件夹）中吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:49:31.783

HDFS 没有附加模式。因此，在大多数情况下，您正在运行 map-reduce 程序，输出文件打开一次，数据写入然后关闭。假设这种方法您不能同时将数据写入同一个文件。

尝试写入单独的文件并检查 map-red 程序是否没有挂起。如果他们仍然这样做，那么还有其他一些问题。

您可以获取结果和 map-reduce 日志来分析问题所在。

[编辑：]

您不能写入同一个文件或附加到现有文件。HDFS 追加功能正在进行中。

为此，您可以做两件事：

1）如果您在 Alert_Message_Count 和 Warning_Message_Count 中具有相同的架构内容，则可以按照 Chris 的建议使用 union。

2）当架构不同时进行后处理。那就是编写一个 map reduce 程序，将两个单独的输出合并为一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T22:48:36.827

通常 Hadoop MapReduce 不允许您将作业输出保存到已经存在的文件夹中，所以我猜这也是不可能的（看到 Pig 将命令转换为一系列 M/R 步骤） - 但我会期望某种形式的错误消息，而不是仅仅挂起。

如果您打开集群作业跟踪器并查看任务日志，日志是否会产生任何有助于进一步诊断的信息？

也可能值得检查猪邮件列表（如果您还没有）

如果要将一个数据集附加到另一个数据集，请使用`union`关键字：

```
grunt> All_Count = UNION Alert_Message_Count, Warning_Message_Count;
grunt> store All_Count into 'out'; 
```

# ruby-on-rails - 在 Rails 资产管道中使用字体

> ID：10905905
> 
> 赞同：353
> 
> 时间：2012-06-05T22:29:22.677
> 
> 标签：ruby-on-rails, sass, asset-pipeline, font-face, assets

我在我的 Scss 文件中配置了一些字体，如下所示：

```
@font-face {
  font-family: 'Icomoon';
  src: asset-url('icoMoon.eot?#iefix', font) format('embedded-opentype'),
       asset-url('icoMoon.woff', font) format('woff'),
       asset-url('icoMoon.ttf', font)  format('truetype'),
       asset-url('icoMoon.svg#Icomoon', font) format('svg');
} 
```

实际的字体文件存储在 /app/assets/fonts/

我已添加`config.assets.paths << Rails.root.join("app", "assets", "fonts")`到我的 application.rb 文件中

编译CSS源码如下：

```
@font-face {
  font-family: 'Icomoon';
  src: url(/assets/icoMoon.eot?#iefix) format("embedded-opentype"), url(/assets/icoMoon.woff) format("woff"), url(/assets/icoMoon.ttf) format("truetype"), url(/assets/icoMoon.svg#Icomoon) format("svg");
} 
```

但是当我运行该应用程序时，找不到字体文件。日志：

> 在 2012 年 6 月 5 日 23:21:17 +0100 开始获取 127.0.0.1 的“/assets/icoMoon.ttf” 服务资产 /icoMoon.ttf - 404 未找到（13 毫秒）

为什么资产管道不将字体文件扁平化为 /assets？

任何想法的人？

亲切的问候，尼尔

**额外信息：**

在检查 rails 控制台的资产路径和资产预编译时，我得到以下信息：

```
1.9.2p320 :001 > y Rails.application.config.assets.precompile
---
- !ruby/object:Proc {}
- !ruby/regexp /(?:\/|\\|\A)application\.(css|js)$/
- .svg
- .eot
- .woff
- .ttf
=> nil

1.9.2p320 :002 > y Rails.application.config.assets.paths
---
- /Users/neiltonge/code/neiltonge/app/assets/fonts
- /Users/neiltonge/code/neiltonge/app/assets/images
- /Users/neiltonge/code/neiltonge/app/assets/javascripts
- /Users/neiltonge/code/neiltonge/app/assets/stylesheets
- /Users/neiltonge/code/neiltonge/vendor/assets/images
- /Users/neiltonge/code/neiltonge/vendor/assets/javascripts
- /Users/neiltonge/code/neiltonge/vendor/assets/stylesheets
- /Users/neiltonge/.rvm/gems/ruby-1.9.2-p320@neiltonge/gems/jquery-rails-2.0.0/vendor/assets/javascripts
- /Users/neiltonge/.rvm/gems/ruby-1.9.2-p320@neiltonge/gems/coffee-rails-3.2.1/lib/assets/javascripts
- /Users/neiltonge/.rvm/gems/ruby-1.9.2-p320@neiltonge/gems/bourbon-1.3.0/app/assets/stylesheets
- !ruby/object:Pathname
  path: /Users/neiltonge/code/neiltonge/app/assets/fonts
 => nil 
```

* * *

## 回答 #1

> 赞同：660
> 
> 时间：2012-06-06T01:54:55.120

1.  如果您的 Rails 版本介于`> 3.1.0`和之间`< 4`，请将您的字体放在以下文件夹中：

    *   `app/assets/fonts`
    *   `lib/assets/fonts`
    *   `vendor/assets/fonts`

    对于 Rails 版本`> 4`，您**必须**将字体放在 `app/assets/fonts`文件夹中。

    **注意：**要将字体放置在这些指定文件夹之外，请使用以下配置：

    `config.assets.precompile << /\.(?:svg|eot|woff|ttf)\z/`

    对于 Rails 版本`> 4.2`，**建议**将此配置添加到`config/initializers/assets.rb`.

    但是，您也可以将其添加到`config/application.rb`或`config/production.rb`

2.  在 CSS 文件中声明字体：

    ```
    @font-face {
      font-family: 'Icomoon';
      src:url('icomoon.eot');
      src:url('icomoon.eot?#iefix') format('embedded-opentype'),
        url('icomoon.svg#icomoon') format('svg'),
        url('icomoon.woff') format('woff'),
        url('icomoon.ttf') format('truetype');
      font-weight: normal;
      font-style: normal;
    } 
    ```

    确保您的字体名称与声明的 URL 部分中的名称完全相同。大写字母和标点符号很重要。在这种情况下，字体应该具有名称`icomoon`。

3.  如果您在 Rails 中使用 Sass 或 Less `> 3.1.0`（您的 CSS 文件具有`.scss`或`.less`扩展名），则将`url(...)`字体声明中的`font-url(...)`.

    否则，你的 CSS 文件应该有扩展名`.css.erb`，字体声明应该是`url('<%= asset_path(...) %>')`.

    如果您使用的是 Rails `> 3.2.1`，则可以`font_path(...)`使用`asset_path(...)`. 这个助手做同样的事情，但更清楚。

4.  最后，在 CSS 中使用您的字体，就像您在该`font-family`部分中声明的那样。如果它被声明为大写，你可以像这样使用它：

    ```
    font-family: 'Icomoon'; 
    ```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2014-05-12T14:34:00.573

现在有一个转折：

> 您应该将所有字体放入其中`app/assets/fonts/`，因为默认情况下它们将在登台和生产中进行预编译——它们将在推送到**heroku时进行预***编译*。
> 
> 默认情况下，放置的字体文件`vendor/assets`不会在登台或生产中预编译——它们将在**heroku上***失败*。[来源！](https://github.com/rails/rails/pull/7968)

— [@plapier，思想机器人/波旁威士忌](https://github.com/thoughtbot/bourbon/issues/239#issuecomment-26167073)

> 我坚信将供应商字体放入`vendor/assets/fonts` 比放入`app/assets/fonts`. 有了这两行额外的配置，这对我来说效果很好（在 Rails 4 上）：

```
app.config.assets.paths << Rails.root.join('vendor', 'assets', 'fonts')  
app.config.assets.precompile << /\.(?:svg|eot|woff|ttf)$/ 
```

— [@jhilden，思想机器人/波旁威士忌](https://github.com/thoughtbot/bourbon/issues/239#issuecomment-30830589)

我也在`rails 4.0.0`. 实际上最后一行足以从`vendor`文件夹中安全地预编译字体。花了几个小时才弄明白。希望它对某人有所帮助。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2013-06-28T14:36:47.597

如果您不想跟踪移动字体：

```
# Adding Webfonts to the Asset Pipeline
config.assets.precompile << Proc.new { |path|
  if path =~ /\.(eot|svg|ttf|woff)\z/
    true
  end
} 
```

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2014-05-22T17:40:25.840

您需要`font-url`在 @font-face 块中使用，而不是`url`

```
@font-face {
font-family: 'Inconsolata';
src:font-url('Inconsolata-Regular.ttf') format('truetype');
font-weight: normal;
font-style: normal;
} 
```

以及 application.rb 中的这一行，正如你所提到的（对于字体`app/assets/fonts`

```
config.assets.paths << Rails.root.join("app", "assets", "fonts") 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2015-11-24T11:44:29.283

这是我在资产管道中使用字体的方法：

1) 把你所有的字体文件放在 下`app/assets/fonts/`，实际上你不限于把它放在`fonts`文件夹名称下。您可以放置​​您喜欢的任何子文件夹名称。例如`app/assets/abc`或`app/assets/anotherfonts`。但我强烈建议你把它放在下面`app/assets/fonts/`以获得更好的文件夹结构。

2）从您的 sass 文件中，使用 sass 助手`font-path`请求您的字体资源，如下所示

```
@font-face {
    font-family: 'FontAwesome';
    src: url(font-path('fontawesome-webfont.eot') + '?v=4.4.0');
    src: url(font-path('fontawesome-webfont.eot') + '?#iefix&v=4.4.0') format('embedded-opentype'),
         url(font-path('fontawesome-webfont.woff2') + '?v=4.4.0') format('woff2'),
         url(font-path('fontawesome-webfont.woff') + '?v=4.4.0') format('woff'),
         url(font-path('fontawesome-webfont.ttf') + '?v=4.4.0') format('truetype'),
         url(font-path('fontawesome-webfont.svg') + '?v=4.4.0#fontawesomeregular') format('svg');
    font-weight: normal;
    font-style: normal;
} 
```

3)`bundle exec rake assets:precompile`从您的本地机器运行并查看您的 application.css 结果。您应该看到如下内容：

```
@font-face {
    font-family: 'FontAwesome';
    src: url("/assets/fontawesome-webfont-d4f5a99224154f2a808e42a441ddc9248ffe78b7a4083684ce159270b30b912a.eot" "?v=4.4.0");
    src: url("/assets/fontawesome-webfont-d4f5a99224154f2a808e42a441ddc9248ffe78b7a4083684ce159270b30b912a.eot" "?#iefix&v=4.4.0") format("embedded-opentype"), url("/assets/fontawesome-webfont-3c4a1bb7ce3234407184f0d80cc4dec075e4ad616b44dcc5778e1cfb1bc24019.woff2" "?v=4.4.0") format("woff2"), url("/assets/fontawesome-webfont-a7c7e4930090e038a280fd61d88f0dc03dad4aeaedbd8c9be3dd9aa4c3b6f8d1.woff" "?v=4.4.0") format("woff"), url("/assets/fontawesome-webfont-1b7f3de49d68b01f415574ebb82e6110a1d09cda2071ad8451bdb5124131a292.ttf" "?v=4.4.0") format("truetype"), url("/assets/fontawesome-webfont-7414288c272f6cc10304aa18e89bf24fb30f40afd644623f425c2c3d71fbe06a.svg" "?v=4.4.0#fontawesomeregular") format("svg");
    font-weight: normal;
    font-style: normal;
} 
```

如果您想了解更多资产管道的工作原理，可以访问以下简单指南： [https ://designcode.commandrun.com/rails-asset-pipeline-simple-guide-830e2e666f6c#.6lejlayk2](https://designcode.commandrun.com/rails-asset-pipeline-simple-guide-830e2e666f6c#.6lejlayk2)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2018-12-26T22:42:42.817

这是一个 repo，演示了在 Heroku 上使用 Rails 5.2 提供自定义字体。[根据https://www.webpagetest.org/](https://www.webpagetest.org/)，它更进一步并优化了尽可能快地提供字体

[https://github.com/nzoschke/edgecors](https://github.com/nzoschke/edgecors)

首先，我从上面的答案中挑选了一些片段。对于 Rails 5.2+，您不需要额外的资产管道配置。

## 资产管道和 SCSS

*   将字体放入`app/assets/fonts`
*   将`@font-face`声明放在 scss 文件中并使用`font-url`帮助程序

来自`app/assets/stylesheets/welcome.scss`：

```
@font-face {
  font-family: 'Inconsolata';
  src: font-url('Inconsolata-Regular.ttf') format('truetype');
  font-weight: normal;
  font-style: normal;
}

body {
  font-family: "Inconsolata";
  font-weight: bold;
} 
```

### 使用 CORS 从 CDN 提供服务

我正在使用 CloudFront，添加了[Heroku Edge 插件](https://elements.heroku.com/addons/edge)。

首先在中配置 CDN 前缀和默认`Cache-Control`标头`production.rb`：

```
Rails.application.configure do
  # e.g. https://d1unsc88mkka3m.cloudfront.net
  config.action_controller.asset_host = ENV["EDGE_URL"]

  config.public_file_server.headers = {
    'Cache-Control' => 'public, max-age=31536000'
  }
end 
```

如果您尝试从 herokuapp.com URL 访问字体到 CDN URL，您将在浏览器中收到 CORS 错误：

> 从源“ [https://edgecors.herokuapp.com](https://edgecors.herokuapp.com) ”访问“ [https://d1unsc88mkka3m.cloudfront.net/assets/Inconsolata-Regular.ttf](https://d1unsc88mkka3m.cloudfront.net/assets/Inconsolata-Regular.ttf) ”字体已被 CORS 策略阻止：否 'Access-Control-Allow -Origin' 标头存在于请求的资源上。edgecors.herokuapp.com/ 获取[https://d1unsc88mkka3m.cloudfront.net/assets/Inconsolata-Regular.ttf](https://d1unsc88mkka3m.cloudfront.net/assets/Inconsolata-Regular.ttf) net::ERR_FAILED

所以配置 CORS 以允许从 Heroku 访问字体到 CDN URL：

```
module EdgeCors
  class Application < Rails::Application
    # Initialize configuration defaults for originally generated Rails version.
    config.load_defaults 5.2

    config.middleware.insert_after ActionDispatch::Static, Rack::Deflater

    config.middleware.insert_before 0, Rack::Cors do
      allow do
        origins %w[
          http://edgecors.herokuapp.com
          https://edgecors.herokuapp.com
        ]
        resource "*", headers: :any, methods: [:get, :post, :options]
      end
    end
  end
end 
```

## 提供 gzip 字体资源

资产管道构建一个`.ttf.gz`文件但不提供它。此猴子补丁将资产管道 gzip 白名单更改为黑名单：

```
require 'action_dispatch/middleware/static'

ActionDispatch::FileHandler.class_eval do
  private

    def gzip_file_path(path)
      return false if ['image/png', 'image/jpeg', 'image/gif'].include? content_type(path)
      gzip_path = "#{path}.gz"
      if File.exist?(File.join(@root, ::Rack::Utils.unescape_path(gzip_path)))
        gzip_path
      else
        false
      end
    end
end 
```

最终结果是`app/assets/fonts`从长期存在的 CloudFront 缓存中提供自定义字体文件。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2015-03-23T16:31:03.113

我正在使用 Rails 4.2，但无法显示合适的图标。显示了小框，而不是折叠行上的 (+) 和我预期的小排序箭头。研究了这里的资料后，我对我的代码做了一个简单的改动：删除css中的字体目录。也就是说，像这样更改所有 css 条目：

```
src:url('fonts/footable.eot'); 
```

看起来像这样：

```
src:url('footable.eot'); 
```

有效。我认为 Rails 4.2 已经假定了字体目录，因此在 css 代码中再次指定它会使字体文件找不到。希望这可以帮助。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2015-12-15T21:48:14.760

我在 Rails 4.2（使用 ruby​​ 2.2.3）上遇到了这个问题，并且不得不编辑 font-awesome _paths.scss 部分以删除对`$fa-font-path`前导斜杠的引用和删除。以下内容被破坏：

```
@font-face {
  font-family: 'FontAwesome';
  src: font-url('#{$fa-font-path}/fontawesome-webfont.eot?v=#{$fa-version}');
  src: font-url('#{$fa-font-path}/fontawesome-webfont.eot?#iefix&v=#{$fa-version}') format('embedded-opentype'),
    font-url('#{$fa-font-path}/fontawesome-webfont.woff2?v=#{$fa-version}') format('woff2'),
    font-url('#{$fa-font-path}/fontawesome-webfont.woff?v=#{$fa-version}') format('woff'),
    font-url('#{$fa-font-path}/fontawesome-webfont.ttf?v=#{$fa-version}') format('truetype'),
    font-url('#{$fa-font-path}/fontawesome-webfont.svg?v=#{$fa-version}#fontawesomeregular') format('svg');
  font-weight: normal;
  font-style: normal;
} 
```

以下作品：

```
@font-face {
  font-family: 'FontAwesome';
  src: font-url('fontawesome-webfont.eot?v=#{$fa-version}');
  src: font-url('fontawesome-webfont.eot?#iefix&v=#{$fa-version}') format('embedded-opentype'),
    font-url('fontawesome-webfont.woff2?v=#{$fa-version}') format('woff2'),
    font-url('fontawesome-webfont.woff?v=#{$fa-version}') format('woff'),
    font-url('fontawesome-webfont.ttf?v=#{$fa-version}') format('truetype'),
    font-url('fontawesome-webfont.svg?v=#{$fa-version}#fontawesomeregular') format('svg');
  font-weight: normal;
  font-style: normal;
} 
```

另一种方法是简单地删除插值后的正斜杠`$fa-font-path`，然后定义`$fa-font-path`为空字符串或带有尾部正斜杠的子目录（根据需要）。

请记住重新编译资产并根据需要重新启动服务器。例如，在乘客设置上：

```
prompt> rake assets:clean; rake assets:clobber
prompt> RAILS_ENV=production RAILS_GROUPS=assets rake assets:precompile
prompt> service passenger restart 
```

然后重新加载浏览器。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-07-24T16:27:53.467

我最近将 Rails 3 应用程序升级到 Rails 4 时遇到了类似的问题。我的字体在 Rails 4+ 中不能正常工作，我们只允许将字体保存在`app/assets/fonts`目录下。但是我的 Rails 3 应用程序有不同的字体组织。所以我必须配置应用程序，以便它仍然可以与 Rails 4+ 一起使用，我的字体位于`app/assets/fonts`. 我已经尝试了几种解决方案，但是在我找到了[非愚蠢的摘要资产](https://github.com/alexspeller/non-stupid-digest-assets)宝石之后，它变得如此简单。

通过将以下行添加到您的 Gemfile 来添加此 gem：

```
gem 'non-stupid-digest-assets' 
```

然后运行：

```
bundle install 
```

**最后在config/initializers/non_digest_assets.rb**文件中添加以下行：

```
NonStupidDigestAssets.whitelist = [ /\.(?:svg|eot|woff|ttf)$/ ] 
```

就是这样。这很好地解决了我的问题。希望这可以帮助像我一样遇到类似问题的人。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-04-27T15:56:10.060

在我的情况下，最初的问题是使用`asset-url`没有结果而不是普通的`url`css 属性。使用`asset-url`最终在 Heroku 为我工作。加上在文件夹中设置字体并在不添加任何子文件夹或任何其他配置的情况下`/assets/fonts`调用。`asset-url('font.eot')`

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-05-27T13:05:45.223

如果您有一个名为scaffolds.css.scss 的文件，那么就有可能覆盖您在其他文件中执行的所有自定义操作。我注释掉了那个文件，突然一切都正常了。如果该文件中没有任何重要内容，您不妨将其删除！

* * *

## 回答 #12

> 赞同：-6
> 
> 时间：2015-04-20T12:37:25.357

只需将您的字体放在 app/assets/fonts 文件夹中，并在应用程序开始使用在 application.rb 中编写代码时设置自动加载路径

**config.assets.paths << Rails.root.join("app", "assets", "fonts")** 和

然后在css中使用以下代码。

@字体脸{

```
 font-family: 'icomoon';
 src: asset-url('icomoon.eot');
 src: asset-url('icomoon.eot') format('embedded-opentype'),
      asset-url('icomoon.woff') format('woff'),
      asset-url('icomoon.ttf') format('truetype'),
      asset-url('icomoon.svg') format('svg');
 font-weight: normal;
 font-style: normal; 
```

}

试试看。

谢谢

# url - 如何解码这个网址，它非常复杂

> ID：10905910
> 
> 赞同：1
> 
> 时间：2012-06-05T22:30:10.303
> 
> 标签：url, base64, encryption

我在这里遇到了麻烦，我正在尝试解码此网址，

[http://www.fastpasstv.ms/redirect/?url=3uXn46ChlNzr7Z%2Fp3MrqycripNTi4JXVyp3h3N2r3sqo1N4%3D](http://www.fastpasstv.ms/redirect/?url=3uXn46ChlNzr7Z%2Fp3MrqycripNTi4JXVyp3h3N2r3sqo1N4%3D)

这将带您到

[http://www.vidxden.com/ce8mfl8kd6oy](http://www.vidxden.com/ce8mfl8kd6oy)

我已经为“3uXn46ChlNzr7Z%2Fp3MrqycripNTi4JXVyp3h3N2r3sqo1N4%3D”运行base64解码，它是乱码。我是一个 imacros 编码器，需要为我的客户解码这个字符串，请帮我解决这个问题。

问候拉姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T23:11:41.407

它不会解码为该 URL，而是解码为一个 URL，下载后将重定向到您的目标：

```
$ python3 -c "import urllib.parse; print(urllib.parse.unquote('http://www.fastpasstv.ms/redirect/?url=3uXn46ChlNzr7Z/p3MrqycripNTi4JXVyp3h3N2r3sqo1N4='))"
http://www.fastpasstv.ms/redirect/?url=3uXn46ChlNzr7Z/p3MrqycripNTi4JXVyp3h3N2r3sqo1N4=

$ curl -sS http://www.fastpasstv.ms/redirect/?url=3uXn46ChlNzr7Z/p3MrqycripNTi4JXVyp3h3N2r3sqo1N4= -D /dev/tty
HTTP/1.1 302 Moved Temporarily
Server: nginx/1.0.11
Content-Type: text/html
Location: http://www.vidxden.com/ce8mfl8kd6oy
Content-Length: 0
Accept-Ranges: bytes
Date: Tue, 05 Jun 2012 22:54:31 GMT
Connection: keep-alive 
```

注意 302 状态和 Location 标头

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T23:23:26.003

我很好奇，做了一些尝试。

*   用[http://www.vidxden.com/ce8mfl8kd6oy](http://www.vidxden.com/ce8mfl8kd6oy)或 www.vidxden.com/ce8mfl8kd6oy喂[http://www.insidepro.com/hashes.php?lang=eng](http://www.insidepro.com/hashes.php?lang=eng)不会导致 URL 被解释

*   在 3uXn46ChlNzr7Z/p3MrqycripNTi4JXVyp3h3N2r3sqo1N4= 或 3uXn46ChlNzr7Z%2Fp3MrqycripNTi4JXVyp3h3N2r3sqo1N4%3D 上使用[http://code.google.com/p/hash-identifier/](http://code.google.com/p/hash-identifier/)没有给出任何结果

*   然而： 3uXn46ChlNzr7Z 似乎被fastpasstv（谷歌）反复使用。其余的（p3MrqycripNTi4JXVyp3h3N2r3sqo1N4）据说可能是哈希 ID 的 MD5 哈希。

您不会轻易解密 MD5 哈希...

因此，您似乎不走运解密此内容。只需按照重定向...

# c# - 设置为最大化的 WinForm 在周期中显示得太早

> ID：10905912
> 
> 赞同：4
> 
> 时间：2012-06-05T22:30:19.617
> 
> 标签：c#, .net, winforms, .net-4.0, resize

表格代码：

```
public partial class Foo: Form
{
    public Foo()
    {
        InitializeComponent();
    }

    protected override void OnLoad(EventArgs e)
    {
        // Form already visible here when Maximized from calling code
        base.OnLoad(e);
    }
} 
```

调用代码：

```
Foo foo = new Foo();
foo.WindowState = FormWindowState.Maximized;
foo.ShowDialog(); 
```

当代码进入 OnLoad 事件时，Foo 表单已经显示在屏幕上。如果我删除该`foo.WindowState = FormWindowState.Maximized`语句，则 Foo 表单在 OnLoad 事件中不可见（应该如此）。

为什么会这样，我能做些什么来解决这个问题？问题是当表单设置为最大化时，它在周期中显示得太早了。

请注意，有一个[类似](https://stackoverflow.com/questions/9806651/setting-windowstate-to-maximized-causes-window-to-appear-too-early)的问题，但它侧重于 UI 滑稽动作，并没有真正解决问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T22:59:15.320

这类问题通常需要仔细考虑您的工作方式。可能需要重新考虑加载、绑定和显示表单的策略。但是，对于一个简单的解决方案，您可以这样做：

```
Foo foo = new Foo();
foo.Shown += (s, a) => foo.WindowState = FormWindowState.Maximized;            
foo.ShowDialog(); 
```

This way, you won't maximize the form until the `Shown` event is raised, which happens after `OnLoad()`.

# c# - 在视图完成加载之前调用绑定属性的设置器

> ID：10905918
> 
> 赞同：1
> 
> 时间：2012-06-05T22:30:53.823
> 
> 标签：c#, wpf, mvvm, properties, initialization

我目前正在 WPF（Surface 2.0）中开发，并在我的应用程序的大部分部分使用 MVVM 模式。不幸的是，我目前面临一个相当复杂的问题，希望你们能帮助我：

我有一个 View 和一个 ViewModel 属于它。View 包含到 ViewModel 中属性的双向绑定：

```
<pb:PivotBar ItemsSource="{Binding PivotBarEntries}" 
SelectedItemIndex="{Binding SelectedPivotItemIndex, Mode=TwoWay}" />

(...)

<local:SomeOtherView /> 
```

首次加载视图时，将调用 SelectedPivotItemIndex 的设置器。这很好，只是在加载视图的其余部分之前调用了 setter。由于 setter 将消息（通过 MVVMLight 的 Messenger）发送到稍后在视图中创建的其他视图模型，这是一个问题 - 这些消息永远不会到达它们的目的地，因为到目前为止还没有为它们注册接收器。

```
public int SelectedPivotItemIndex
{
    get
    {
        return this.selectedPivotItemIndex;
    }
    set
    {
        if (value != this.selectedPivotItemIndex)
        {
            this.selectedPivotItemIndex = value;
            this.ReportPropertyChanged("SelectedPivotItemIndex");

            (...)

            ChangeSomeOtherViewModelProperty msg = new ChangeSomeOtherViewModelProperty { Property = newValueCalculatedBefore };
            Messenger.Default.Send<ChangeSomeOtherViewModelProperty>(msg);
        }
    }
} 
```

我现在能想到的唯一解决方案是在 ViewModel 中创建一个 LoadedEventHandler 并*再次*调用 SelectedPivotItemIndex 设置器。不过，我真的不喜欢这样：

*   这一次，setter 再次运行（这会创建一个相当大的集合并传递给消息）。不知道它是否真的会影响性能，但似乎仍然没有必要。
*   其次，这对我来说似乎有点骇人听闻和容易出错，因为每个属性都必须在加载的事件中手动初始化。

这个问题有没有比手动调用setter更好的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T09:50:38.813

我首先没有关于 viewmodel 的教程，但我敢肯定那里有很多例子。首先是视图模型，然后您首先拥有视图模型实例，然后让 wpf 创建视图（通过数据模板）。

假设您的主视图应该显示带有 PivotBarEntries 的视图。所以你现在要做的是在你的 mainviewmodel 中创建一个 pivotbarviewmodel（DI、MEF、new() 等等）。您的 mainviewmodel 将 pivotvw 公开为一个属性并将其绑定到您的 mainview 中的 ContentPresenter.Content 。至少您必须为您的 pivotvw DataType 创建一个 DataTemplate。

```
<DataTemplate DataType="{x:Type local:PivotViewModel>
 <view:MyPivotView/>
</DataTemplate> 
```

首先是关于视图模型，您不再依赖视图上的加载事件，因为您的虚拟机是首先创建的。

当然，对于您的具体问题，您只需要确保应该创建所有听信使的组件（VM）

你的xml

```
<ContentPresenter Content="{Binding MyPivotDataVM}" />
<ContentPresenter Content="{Binding MySomeOtherStuffVM}" /> 
```

而不是先查看

```
<pb:PivotBar ItemsSource="{Binding PivotBarEntries}" 
SelectedItemIndex="{Binding SelectedPivotItemIndex, Mode=TwoWay}" />

(...)

<local:SomeOtherView /> 
```

**编辑：首先是视图模型的非常简单的示例。**ps：我使用 DI 和 MEF 来创建我的对象路径。

应用程序.xaml

```
<Application x:Class="WpfViewModelFirst.App"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:WpfViewModelFirst="clr-namespace:WpfViewModelFirst">
<!--StartUp Uri is removed-->
<Application.Resources>
    <!--comment these datatemplates and see what happens-->
    <DataTemplate DataType="{x:Type WpfViewModelFirst:PivotViewModel}">
        <WpfViewModelFirst:PivotView/>
    </DataTemplate>
    <DataTemplate DataType="{x:Type WpfViewModelFirst:OtherViewModel}">
        <WpfViewModelFirst:OtherView/>
    </DataTemplate>
    <DataTemplate DataType="{x:Type WpfViewModelFirst:OtherChildViewModel}">
        <WpfViewModelFirst:OtherChildView/>
    </DataTemplate>
</Application.Resources>
</Application> 
```

应用程序.xaml.cs

```
public partial class App : Application
{
    protected override void OnStartup(StartupEventArgs e)
    {
        //to be fair, sometimes i create the ApplicationRoot(JUST MainWindow with view first, and just the rest with viewmodel first.)
        var mainvm = new MainViewModel();
        var mainview = new MainWindow {DataContext = mainvm};
        this.MainWindow = mainview;
        this.MainWindow.Show();
    }
} 
```

主视图.xaml

```
<Window x:Class="WpfViewModelFirst.MainWindow" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525">
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="auto" />
        <RowDefinition Height="*" />
    </Grid.RowDefinitions>
    <Grid.ColumnDefinitions>
        <ColumnDefinition />
        <ColumnDefinition />
    </Grid.ColumnDefinitions>        
    <TextBlock Text="{Binding MyProp}" Grid.ColumnSpan="2" Grid.Row="0"/>        
    <ContentPresenter Content="{Binding MyPivot}" Grid.Row="1" Grid.Column="0" />
    <ContentPresenter Content="{Binding MyOther}" Grid.Row="1" Grid.Column="1" />        
</Grid>
</Window> 
```

主视图模型.cs

```
public class MainViewModel
{
    public string MyProp { get; set; }
    public PivotViewModel MyPivot { get; set; }
    public OtherViewModel MyOther { get; set; }

    public MainViewModel()
    {
        this.MyProp = "Main VM";
        this.MyPivot = new PivotViewModel();
        this.MyOther = new OtherViewModel();
    }
} 
```

透视视图模型

```
public class PivotViewModel
{
    public string MyProp { get; set; }
    public ObservableCollection<string> MyList { get; set; }

    public PivotViewModel()//Dependency here with constructor injection
    {
        this.MyProp = "Test";
        this.MyList = new ObservableCollection<string>(){"Test1", "Test2"};
    }
} 
```

其他视图模型

```
public class OtherViewModel
{
    public string MyProp { get; set; }
    public OtherChildViewModel MyChild { get; set; }

    public OtherViewModel()
    {
        this.MyProp = "Other Viewmodel here";
        this.MyChild = new OtherChildViewModel();
    }
} 
```

其他儿童视图模型

```
public class OtherChildViewModel
{
    public string MyProp { get; set; }

    public OtherChildViewModel()//Dependency here with constructor injection
    {
        this.MyProp = "Other Child Viewmodel";
    }
} 
```

透视图

```
<UserControl x:Class="WpfViewModelFirst.PivotView"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="auto" />
        <RowDefinition Height="*" />
    </Grid.RowDefinitions>
    <TextBlock Text="{Binding MyProp}" Grid.Row="0"/>
    <ListBox ItemsSource="{Binding MyList}" Grid.Row="1"/>
</Grid>
</UserControl> 
```

其他查看

```
<UserControl x:Class="WpfViewModelFirst.OtherView"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition  />
        <RowDefinition  />
    </Grid.RowDefinitions>
    <TextBlock Text="{Binding MyProp}" Grid.Row="0" />
    <ContentPresenter Content="{Binding MyChild}" Grid.Row="1"/>
</Grid>
</UserControl> 
```

其他子视图

```
<UserControl x:Class="WpfViewModelFirst.OtherChildView"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
<Grid>
    <TextBlock Text="{Binding MyProp}" />
</Grid>
</UserControl> 
```

# powershell - 用于比较文件夹中 TFS 标签的脚本

> ID：10905921
> 
> 赞同：1
> 
> 时间：2012-06-05T22:31:05.590
> 
> 标签：powershell, tfs, msbuild

我在 TFS 中有几个分支（开发、测试、阶段），当我将更改合并到测试分支中时，我想要一个自动化脚本来根据标签查找所有更新的 SQL 文件并将它们部署到 SQL 数据库。

目前我在 TFS 源代码控制资源管理器中手动使用比较来获取更改的文件并使用自定义 powershell 脚本部署到数据库。

我正在寻找一个脚本，它将更改的 sql 文件复制到存储库中，以便我的 powershell 完成剩下的工作。

任何帮助，将不胜感激。

谢谢

尼特

# javascript - 如何让用户将图像上传到 JavaScript 源而不是使用默认图像

> ID：10905925
> 
> 赞同：0
> 
> 时间：2012-06-05T22:31:22.870
> 
> 标签：javascript, html

我有一个 JavaScript 文件，在其中我有一行要编辑的特定代码：

```
outlineImage.onload = resourceLoaded;
        outlineImage.src = "images/watermelon-duck-outline.png"; 
```

我怎样才能让用户在这里上传他们自己的图片？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:36:16.783

没有办法直接让用户在那里指定自己的图像。您需要制作一个表单，用户可以在其中上传图像和服务器端脚本以接收上传图像并将其存储在您的服务器上，然后重写您的代码以输出用户上传的任何内容。为了使其特定于用户，您将需要某种系统来指定图片属于用户，例如登录系统或至少带有 id 的 cookie 或其他东西。换句话说，像这样的事情涉及很多活动部件。

# php - 存储 id 时 PHP 会话使用什么哈希？

> ID：10905930
> 
> 赞同：0
> 
> 时间：2012-06-05T22:31:32.207
> 
> 标签：php, session

算法是什么。我想使用相同的算法来手动创建我自己的 session_ids，我也想在本地存储它。

我意识到我可以在服务器端创建它（使用会话函数）并发送它......但我只是更喜欢自己散列/编码它......+我想要增加我喜欢的复杂性的选项......摆弄它等等

相关： [1](https://stackoverflow.com/questions/10835592/how-are-client-side-session-ids-protected)

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T22:41:20.573

[PHP 默认使用 md5](http://www.php.net/manual/en/session.configuration.php#ini.session.hash-function)，但可以配置为使用 sha-1 以及从 PHP 5.3 开始的许多其他[散列算法](http://www.php.net/manual/en/function.hash-algos.php)。

您可以选择自己的算法，但它至少应该和 md5 一样强大，并且可能应该更强大，因为 md5 有点过时了。

# git - Git for windows 使用 gitk-all 启动 gitk 上下文菜单

> ID：10905932
> 
> 赞同：3
> 
> 时间：2012-06-05T22:31:46.427
> 
> 标签：git, windows-7, gitk

我安装了适用于 Windows 的 Git。当我右键单击一个项目并选择`Git History`我得到 Gitk 窗口时，但每次我这样做时，我都需要设置视图以查看所有分支。即使我编辑视图并将其设置为`Remember`，我仍然没有在后续访问 Gitk 时获得所有分支。

或者，我可以打开 Bash 窗口并输入`gitk --all`相同的结果。

两者都很不方便，我想将 rght click 和 select `Git History`to show 设为默认行为`gitk --all`。

如何实现？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T09:22:57.783

修改该上下文菜单条目的注册表以添加参数“--all”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-25T20:25:42.240

这对我有用：

```
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Classes\*\shell\Open with &gitk --all\command]
@="C:\\Users\\rofro\\scoop\\shims\\gitk.exe --all \"%1\""

[HKEY_CURRENT_USER\Software\Classes\directory\Background\shell\Open with &gitk --all\command]
@="C:\\Users\\rofro\\scoop\\shims\\gitk.exe --all \"%V\"" 
```

# mysql - 在 MySQL 中，如何使用一张表中的信息来更新另一张表

> ID：10905935
> 
> 赞同：0
> 
> 时间：2012-06-05T22:32:07.627
> 
> 标签：mysql, stored-procedures, cursor

我有两个表：团队和人员。

表`teams`有三列, `id`, `name`,`leader`

表`persons`有这些列：`hash`,`team_id`

team.leader 是一个 MD5 哈希，它必须与 people.hash 匹配以确定哪个人是给定团队的领导者。

我需要在 MySQL 上运行执行以下操作的查询：

1）检索一个团队的所有领导者，以及团队ID：

```
SELECT `id`,`leader` FROM `teams`; 
```

2）使用这些信息更新`team_id`表`persons`

这是我当前的查询： SELECT `id`FROM `teams`INNER JOIN `persons`ON `teams`。`leader`= `persons`。`hash`

但我还没有想出一个解决方案，允许我`team_id`用相应的领导者更新列。我一直在考虑可能使用游标，但不确定。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:33:48.000

您可以使用多表`UPDATE`语法来连接表：

```
UPDATE teams JOIN persons ON teams.leader = persons.hash
SET persons.team_id = teams.id 
```

# c# - 伪 IPv4 正则表达式

> ID：10905936
> 
> 赞同：1
> 
> 时间：2012-06-05T22:32:17.113
> 
> 标签：c#, regex

假设最大 IP 可以在每个“点”括号中包含最大数量 999，即 999.999.999.999 是最大可用的。
我检查了计算器中的正则表达式 ([0-9]+.){3}[0-9]。那么，为什么程序会抛出运行时错误“parsing”？（[0-9]+。）{3}[0-9]” - 量词 {x,y} 无所事事。”？

```
using System;
using System.IO;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Text.RegularExpressions;

namespace RegExCs
{
    class Program
    {
        static void Main(string[] args)
        {
            string rawData;
            Regex filter = new Regex(@"?<ip>([0-9]+\.){3}[0-9]"); //run-time error 

            rawData=File.ReadAllText("Query list");

            MatchCollection theMatches = filter.Matches(rawData);

            foreach (Match theMatch in theMatches)
            {
                Console.WriteLine("ip: {0}\n",theMatch.Groups["ip"]);
            }

            Console.ReadKey();

        }
    }
} 
```

[官方帮助页面](http://msdn.microsoft.com/query/dev10.query?appId=Dev10IDEF1&l=EN-US&k=k%28EHARGUMENT%29;k%28TargetFrameworkMoniker-%22.NETFRAMEWORK,VERSION=V4.0%22%29;k%28DevLang-CSHARP%29&rd=true)对我没有太大帮助。

“查询列表”文件内容：

```
来自 212.77.100.101 www.wp.pl 的回复时间：21:37
来自 111.41.130.55 www.dupa.pl 的回复时间：05:33
230.77.100.101 www.whatanannoyingbug.com 回复时间：04:12
来自 65.77.100.101 www.foooo.org 的回复时间：12:55
来自 200.77.100.101 www.example.com 的回复时间：07:56

```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T22:42:58.613

您需要用括号将整个正则表达式括起来，更改`?<ip>([0-9]+\.){3}[0-9]`为以下内容：

```
(?<ip>([0-9]+\.){3}[0-9]) 
```

这是必要的，因为`?<name>`创建命名组的语法仅在左括号后立即起作用，否则`?`意味着“使前一个元素可选”。由于 之前没有先前的元素`?`，因此您会收到错误消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T22:43:45.153

我会用它来确保它是一个真实的（0-255）IP地址：

```
(([01]?[0-9]?[0-9]|2([0-4][0-9]|5[0-5]))\.){3}([01]?[0-9]?[0-9]|2([0-4][0-9]|5[0-5])) 
```

# segmentation-fault - Vala 中的数据损坏与 ThreadPool

> ID：10905937
> 
> 赞同：0
> 
> 时间：2012-06-05T22:32:19.757
> 
> 标签：segmentation-fault, bytearray, threadpool, vala

我目前正在开展一个项目，该项目需要我对要处理的网络数据包进行排队。我有一个最多有 25 个线程的 ThreadPool，当它们可用时处理这些数据包。但是，当将数据包数据（封装在一个类中）传递给与 ThreadPool 关联的 thread_proc 方法时，数据会被破坏。我像这样声明我的 ThreadPool 变量：

```
pool = new ThreadPool<Packet>((Func<Packet>)thread_proc, 25, false); 
```

这是检查可用数据包的线程方法：

```
void* run()
{
    while (true)
    {
        var packet = packets.poll();

        try
        {
            pool.push(packet);
        }
        catch (ThreadError e)
        {
            error(e.message);
        }
    }

    return null;
} 
```

“数据包”是以下类的 BlockingQueue（使用互斥锁的自定义阻塞队列）：

```
class Packet : Object
{
    public unowned ClientHandler client;
    public uint8[] data;
    public int index;
    public int size;

    public Packet(ClientHandler client, uint8[] data, int index, int size)
    {
        this.client = client;
        this.data = data;
        this.index = index;
        this.size = size;
    }
} 
```

上面的类是包含实际数据包数据（“数据”变量）的内容。当 Packet 实例到达 thread_proc 时，变量值都是错误的......

对于为什么会发生这种情况以及可能的解决方案的任何帮助将不胜感激。先感谢您。

〜迈克尔K。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T17:21:43.523

我只是向 valac git 推送[了一个提交](http://git.gnome.org/browse/vala/commit/?id=d284317520032cf6f94529cc87ce95d178618af1)，这将使 Vala 自动管理数据。它会破坏向后兼容性，因此您必须使用新的构造函数（ThreadPool.with_owned_data）和方法（添加而不是推送）。

如果您想避免对 valac git 的依赖，您可以`packet.ref ()`在推送它之前执行 a ，然后`packet.unref ()`在回调结束时执行 ( `thread_proc`)。[https://bugzilla.gnome.org/attachment.cgi?id=214884](https://bugzilla.gnome.org/attachment.cgi?id=214884)有一个例子。

请注意，在 ThreadPool 构造函数中强制转换 thread_proc 可能会破坏新的内存管理内容。坦率地说，你真的应该避免选派代表……这是惹麻烦的好方法。最好只修复你的函数（`thread_proc`在这种情况下）以获得正确的签名。

# ios - AppStore：需要 iOS 4.2 或更高版本？但我将有效架构设置为 armv6 和 armv7 以及 BaseSDK：最新的 iOS 5.0

> ID：10905938
> 
> 赞同：1
> 
> 时间：2012-06-05T22:32:33.807
> 
> 标签：ios, xcode, cocoa-touch, itunes

“需要 iOS 4.2 或更高版本”是什么意思？...它不适用于 iOS 4.3 或更高版本的设备？那时的“有效架构”是什么？还是 BaseSDK：最新的 iOS (iOS 5.0) 用的？

那么我需要做些什么来确保它与 iOS 5.0 兼容呢？

谢谢...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T23:23:14.747

**“需要 iOS 4.2 或更高版本”**是指运行 iOS 4.2 至 iOS 5.1.1 *（截至 2012 年 6 月 5 日）的*任何设备都可以**安装**和运行您的应用程序。

任何运行 iPhone OS 1.0 至 iOS 4.1.x 的用户都将无法安装您的应用程序，并且 AppStore *（设备上）*应用程序将拒绝用户继续进行任何购买或下载。

## 更新

请参阅[SDK 兼容性指南](https://developer.apple.com/library/ios/#documentation/developertools/conceptual/cross_development/Configuring/configuring.html)，特别是**Base SDK 和部署目标设置**。

# java - Java 语言规范的哪一部分描述了省略的可变参数的行为？

> ID：10905942
> 
> 赞同：6
> 
> 时间：2012-06-05T22:32:46.030
> 
> 标签：java, variadic-functions, jls

我正在寻找 Java 语言规范 (JLS) 的相关部分，该部分描述了调用变量 arity (vararg) 方法时的行为。

考虑方法：

```
public static void printVarArgs(String... args) {
    System.out.println(Arrays.toString(args));
} 
```

如果我像这样调用该方法：

```
printVarArgs(); 
```

输出将如下所示：`[]`因为`args`在调用站点的省略已在方法中转换为空数组`printVarArgs`。

我正在寻找定义这种行为的 JLS 的要点。我发现的最接近的是[15.12.4.2 Evaluate Arguments](https://docs.oracle.com/javase/specs/jls/se8/html/jls-15.html#jls-15.12.4.2)，但它没有给出这个例子，我不确定这种情况是否真的被形式/数学描述所涵盖。

JLS 的哪一部分描述了在省略 vararg 时自动创建空数组？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T22:38:08.983

从 JLS 15.12.4.2 开始：

> 对于某些 T，m 的最终形式参数必须具有 T[] 类型，并且 m 必须使用 k >= 0 实际参数表达式来调用。

这是从被调用者的角度来看的。我不确定它从调用者的角度在哪里说明你引用的行为，但它是隐含的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-05T22:55:57.670

该 JLS 部分的文本说：

> 如果被调用的方法是可变参数方法（第 8.4.1 节）`m`，则它必然具有`n > 0`形式参数。的最终形式参数`m`必然具有`T[]`some的类型`T`，并且 m 必然会被`k >= 0`实际参数表达式调用。
> 
> 如果 m 是用 kn 个实际参数表达式调用的，或者，如果 m 是用`k != n`实际参数表达式调用的，并且第 k 个参数表达式的类型与 的赋值不兼容`T[]`，则参数列表`(e1, ... , en-1, en, ...ek)`的评估就像它被写成 一样`(e1, ..., en-1, new T[]{en, ..., ek})`。

在您谈论的情况下，有`k == n - 1`形式参数，`en, ..., ek`空序列也是如此，这意味着该参数被评估为好像它是`(e1, ..., en-1, new T[]{})`.

换句话说，行为是在您正在查看的部分中指定的。

# jquery - 如何使用 JQuery 在网格中取消选择选定的 HTML

> ID：10905943
> 
> 赞同：1
> 
> 时间：2012-06-05T22:33:02.700
> 
> 标签：jquery, html, events

我有一个**基于 JQuery 的** *单页 Web 应用程序*，它具有丰富的基于 Knockout 的网格。

当我双击 Knockout 网格中的一行时，我会加载一个包含所选项目详细信息的虚拟数据页面，当我完成编辑它（或者如果我取消）时，我会返回到网格. 所有这些都发生在一个页面上。

如果我双击网格中的非文本区域，或者将焦点设置到表单中的输入字段，则重新显示网格时一切正常。但是如果我双击一行中的一些文本（如行项目的“名称”），然后立即单击“取消”返回到网格，那么当我重新显示它时，会选择网格的所有 HTML。就好像我在网格中单击并拖动以选择一个巨大的文本区域。

我一直在尝试以**编程方式取消选择这个选定的文本**，但无济于事。我尝试了以下各种组合：

```
$(document).focus();
$("#idBody").focus();
$("#idBody").trigger("click"); 
```

如果我点击网格外的区域，我会得到我想要的行为。我有哪些选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T22:45:10.067

双击时的问题是，通过执行该操作，浏览器默认选择光标下的文本，创建一系列选定文本。

工作[小提琴示例](http://jsfiddle.net/zuul/rq5Wq/)！

**通过删除该范围内的选定文本，这解决了我过去同样的问题：**

```
if (window.getSelection) {
  if (window.getSelection().empty) {  // Chrome
    window.getSelection().empty();
  } else if (window.getSelection().removeAllRanges) {  // Firefox
    window.getSelection().removeAllRanges();
  }
} else if (document.selection) {  // IE?
  document.selection.empty();
} 
```

**你可以阅读它：**

[MDN 上的window.getSelection 和 MDN 上](https://developer.mozilla.org/en/DOM/window.getSelection)的[DOM 选择](https://developer.mozilla.org/en/DOM/Selection#Methods)

[MSDN 中的 removeAllRanges 方法和 MSDN](http://msdn.microsoft.com/en-us/library/ie/ff975178%28v=vs.85%29.aspx)中的[HTMLSelection 对象](http://msdn.microsoft.com/en-us/library/ie/ff974359%28v=vs.85%29.aspx)

* * *

这个解决方案的功劳归功于[这个答案](https://stackoverflow.com/a/3169849/352449)和[Y 先生](http://groups.google.com/group/jquery-ui-layout/browse_thread/thread/875b5f2ae68821b6)。

* * *

# 经测试

**Windows XP 专业版 2002 Service Pack 3**

*   互联网浏览器 8.0.6001.18702
*   歌剧 11.62
*   火狐 3.6.16
*   Safari 5.1.2
*   谷歌浏览器 18.0.1025.168 m
*   K-Meleon 1.5.4

**Windows 7 家庭版服务包 1**

*   Internet Explorer 9.0.8112.164211C
*   歌剧 11.62
*   火狐12.0
*   Safari 5.1.4
*   谷歌浏览器 18.0.1025.168 m

**Linux Ubuntu 12.04**

*   火狐12.0
*   Chromium 18.0.1025.151（开发人员内部版本 130497 Linux）

# c++ - std::vector 元素初始化

> ID：10905944
> 
> 赞同：8
> 
> 时间：2012-06-05T22:33:17.167
> 
> 标签：c++, vector

```
std::vector<int> v1(1000);
std::vector<std::vector<int>> v2(1000);
std::vector<std::vector<int>::const_iterator> v3(1000); 
```

这 3 个向量的元素是如何初始化的？

关于int，我测试了一下，发现所有元素都变成0了，这是标准吗？我相信原语仍未定义。我创建了一个包含 300000000 个元素的向量，给出非零值，删除它并重新创建它，以避免操作系统内存被清除以确保数据安全。重新创建的向量的元素也为 0。

迭代器呢？默认构造函数是否有初始值 (0) 或初始值未定义？当我检查这个时，迭代器指向 0，但这可以是操作系统

当我创建一个特殊对象来跟踪构造函数时，我看到对于第一个对象，vector 运行默认构造函数，而对于所有其他对象，它运行复制构造函数。这是标准吗？

有没有办法完全避免元素的初始化？或者我必须创建自己的向量？（哦，我的上帝，我总是说不是另一个向量实现）我问是因为我使用超大稀疏矩阵进行并行处理，所以我不能使用 push_back()，当然我不想要无用的初始化，稍后我会更改价值。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-05T22:39:16.067

您正在使用此构造函数（for `std::vector<>`）：

```
explicit vector (size_type n, const T& value= T(), const Allocator& = Allocator()); 
```

其中有以下[文档](http://www.cplusplus.com/reference/stl/vector/vector/)：

> 重复序列构造函数：初始化向量，并将其内容设置为`n`的副本的重复次数`value`。

由于您没有指定，`value`它采用参数的默认值，`T()`在`int`您的情况下，所以所有元素*都将为*0

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-05T22:37:10.710

它们是默认初始化的。

> 关于int，我测试了一下，发现所有元素都变成0了，这是标准吗？我相信原语仍未定义。

不，*未初始化* `int`的具有*不确定*的值。这些是默认初始化的，即

```
int i;          // uninitialized, indeterminate value
int k = int();  // default initialized, value == 0 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-05T22:46:43.897

在 C++11 中，构造函数的规范`vector::vector(size_type n)`说`n`元素是默认插入的。这被定义为由表达式初始化的元素`allocator_traits<Allocator>::construct(m, p)`（其中`m`是分配器类型和`p`指向存储在容器中的类型的指针）。对于默认分配器，此表达式为`::new (static_cast<void*>(p)) T()`（请参阅参考资料`20.6.8.2`）。此值初始化每个元素。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-05T22:35:48.557

向量的元素是默认初始化的，在 POD 类型的情况下意味着零初始化。使用标准向量无法避免它。

# android - Android 提示 AlertDialog onBackPressed

> ID：10905945
> 
> 赞同：10
> 
> 时间：2012-06-05T22:33:17.353
> 
> 标签：android, android-alertdialog

我正在尝试在我的应用程序中完成我的主菜单。我认为在 OnBackPressed 方法中添加一个 AlertDialog 会很简单。但是由于某种原因，我遇到了各种错误。

我在 OnBackPressed 中创建了 AlertDialog 并显示它，但是当我按下后退按钮时应用程序刚刚关闭，并且我收到错误消息说窗口正在泄漏。

知道如何解决这个问题吗？我搜索了大约 30 分钟，找不到其他有此问题的人。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-06-06T02:19:52.307

尽量不要调用**super.OnBackPressed()**，这段代码应该有帮助：

```
@Override
public void onBackPressed() {
    AlertDialog.Builder builder = new AlertDialog.Builder(this);
    builder.setMessage("Are you sure you want to exit?")
           .setCancelable(false)
           .setPositiveButton("Yes", new DialogInterface.OnClickListener() {
               public void onClick(DialogInterface dialog, int id) {
                    MyActivity.this.finish();
               }
           })
           .setNegativeButton("No", new DialogInterface.OnClickListener() {
               public void onClick(DialogInterface dialog, int id) {
                    dialog.cancel();
               }
           });
    AlertDialog alert = builder.create();
    alert.show();

} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-10-24T19:34:06.977

如果你想调用 super.onBackPressed() 使用这个代码：

```
@Override
public void onBackPressed() {
    AlertDialog.Builder builder = new AlertDialog.Builder(this);
    builder.setMessage("Are you sure you want to exit?")
            .setCancelable(false)
            .setPositiveButton("Yes", new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int id) {
                    //finish();
                    MyActivity.this.onSuperBackPressed();
                    //super.onBackPressed();
                }
            })
            .setNegativeButton("No", new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int id) {
                    dialog.cancel();
                }
            });
    AlertDialog alert = builder.create();
    alert.show();
    /*
    if (handleCancel()){
        super.onBackPressed();
    }
    */
}

public void onSuperBackPressed(){
    super.onBackPressed();
} 
```

`onSuperBackPressed`我刚刚向 MyActivity 添加了一个带有`super`-method的新公共方法。

感谢[K_Anas](https://stackoverflow.com/users/1327899/k-anas)提供了这个绝妙的主意。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-05T22:43:06.977

> 我在 OnBackPressed 中创建了 AlertDialog 并显示它，但是当我按下后退按钮时应用程序刚刚关闭，并且我收到错误消息说窗口正在泄漏。

如果在您`OnBackPressed`的内部调用`super.OnBackPressed()`，那么应用程序将完成，因为这就是基本实现的`OnBackPressed`作用。不要调用该`super`方法，应用程序不会关闭。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-06-23T15:36:10.050

在对话框中调用 yourActivity.this.onBackPressed()

```
utility.makeAlertDialog("Cancel Verification","Do you want to cancel the verification process","Cancel Verification",new DialogInterface.OnClickListener(){
        @Override
        public void onClick(DialogInterface dialog, int which) {
            utility.failureToast("OTP verification");
            Intent intent = new Intent(MobileOTPActivity.this,MobileNumberLoginActivity.class);
            intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TASK | Intent.FLAG_ACTIVITY_NEW_TASK);
            startActivity(intent);
            finish();
            MobileOTPActivity.this.onBackPressed();
        }
    },"Close"); 
```

# ios5 - IOS。如何将 UIScrollview 滚动限制在有限的范围内？

> ID：10905953
> 
> 赞同：8
> 
> 时间：2012-06-05T22:33:59.233
> 
> 标签：ios5, uiscrollview, uiscrollviewdelegate

对 UIScrollView 的左/右滚动设置限制的最佳方法是什么。我原以为这很容易，但我所有的尝试都没有成功。

因此，需要明确的是，我需要一个解决方案，让我可以在使用我的应用程序期间随时以编程方式限制滚动范围。这通常是为了响应正在显示的数据的变化。

谢谢，
道格

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-05T22:51:52.057

您可以使用滚动视图的 contentSize 属性来控制内容的大小。如果这对您来说还不够（例如，您需要将滚动区域限制在内容中间的某个任意区域），您可以强制 contentOffset 在滚动视图的委托方法中处于所需的限制范围内。

基本上代码可能如下所示：

```
- (void) scrollViewDidScroll:(UIScrollView*)scroll{
    CGPoint offset = scroll.contentOffset;

    // Check if current offset is within limit and adjust if it is not
    if (offset.x < minOffsetX) offset.x = minOffsetX;
    if (offset.y < minOffsetY) offset.y = minOffsetY;
    if (offset.x > maxOffsetX) offset.x = maxOffsetX;
    if (offset.y > maxOffsetY) offset.y = maxOffsetY;

    // Set offset to adjusted value
    scroll.contentOffset = offset;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-05T22:39:53.653

您需要做的就是使用以下代码更改滚动视图的内容大小。

`[scrollView setContentSize:CGSizeMake(width, height)];`

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2012-06-07T14:14:43.323

我采用了在重载的 layoutSubviews 方法中放置平移约束的方法。

伪代码：

```
Calculate criteria for constraining pan
if (pan-constraint-is-met) {

    Calculate pan-limit
    [self setContentOffset:limitedContentOffset];

} 
```

# php - PHP 将 PM 和 AM 变成 24 小时

> ID：10905959
> 
> 赞同：2
> 
> 时间：2012-06-05T22:34:40.693
> 
> 标签：php, date, time

所以我需要在 PHP 中将 pm/am 转换为 24 小时制，我们使用 Yahoo API 来获取货币汇率，但他们似乎是通过 am/pm 给我们的。

我认为 date 可能会起作用，但是当我读入该函数时，它无法将 pm 变成 24 小时。

```
5: 55pm 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-05T22:36:42.817

这应该工作

```
date("H:i", strtotime("5:55 pm")); 
```

如果你想走另一条路，

```
date("g:i a", strtotime("17:55")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T22:40:36.120

如果雅虎！API 确实没有提供在 24 小时内返回时间的方法，您可以按照 sachleen 的建议进行操作，或者使用正则表达式。

```
(\d{1,2}): (\d{2})(am|pm) 
```

如果是“下午”，则只需将小时数加 12。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T22:47:20.943

使用问题，`date`您`strtotime`可能需要担心时区...您从雅虎获得的内容可能与您服务器的时区不符...这是一个正则表达式方法：

```
$time = preg_replace_callback('~^([^:]+)(.*(a|p)m)$~',create_function('$m','return ($m[3]=="p")?(($m[1]+12).$m[2]):$m[0];'),$time); 
```

# c# - 表单无法通过计时器事件顺利调整大小

> ID：10905970
> 
> 赞同：2
> 
> 时间：2012-06-05T22:36:15.653
> 
> 标签：c#, winforms

我的表单底部有一个网格控件，如果用户想要显示/隐藏它，可以显示或隐藏它。所以一种方法是很好地使用表单的 AutoSize 并将该网格的 Visuble 属性更改为 true 或 false，......但我认为让我们让它更酷一点！所以我想让表单调整得更慢一点，就像车库门一样！所以我在表格上放了一个计时器，并在计时器滴答作响的同时开始一点一点地增加表格的高度......

所以当用户说显示/隐藏网格时是这样的：

```
 timer1.Enabled = true;
    timer1.Start(); 
```

在 timer_click 事件中是这样的：

```
 this.Height = this.Height + 5;
    if(this.Height -10 > ErrorsGrid.Bottom )
        timer1.Stop(); 
```

它有点工作，但仍然不完美。例如，它在一开始就滞后，停止调整大小，然后再次开始调整大小......所以现在考虑到这个想法，你建议我应该做哪些改变来使这个东西看起来更好并且更好地工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T23:14:29.917

尝试使用 a`System.Timers.Timer`代替。[您可以在此处](http://msdn.microsoft.com/en-us/magazine/cc164015.aspx)阅读有关可用 .net 计时器之间差异的更多信息，但我认为您的问题归结为：

> “此计时器类引发的 [System.Windows.Forms.Timer] 事件相对于您的 Windows 窗体应用程序中的其余代码是同步的。这意味着正在执行的应用程序代码永远不会被此计时器的实例抢占班级...”

这不会是 System.Timers.Timer 的问题。只需确保将该对象设置`SynchronizingObject`为您的表单，以便在 UI 线程上执行 elapsed 事件。

例子：

```
public partial class Form1 : Form
{
    System.Timers.Timer timer = new System.Timers.Timer(100);

    public Form1()
    {
        InitializeComponent();

        timer.AutoReset = true;
        timer.SynchronizingObject = this;
        timer.Elapsed += timer_Elapsed;
    }

    void timer_Elapsed(object sender, System.Timers.ElapsedEventArgs e)
    {
        this.Height += 5;

        if (this.Height -10 > ErrorsGrid.Bottom)
            timer.Stop();
    }

    void button1_Click(object sender, EventArgs e)
    {
        timer.Start();
    }
} 
```

# shell - 在 shell 脚本中引用当前目录

> ID：10905972
> 
> 赞同：17
> 
> 时间：2012-06-05T22:36:23.723
> 
> 标签：shell

如何在 shell 脚本中引用当前目录？

所以我有这个脚本，它调用同一目录中的另一个脚本：

```
#! /bin/sh

#Call the other script
./foo.sh 

# do something ... 
```

为此我得到了`./foo.sh: No such file or directory`

所以我把它改成：

```
#! /bin/sh

#Call the other script
foo.sh 

# do something ... 
```

但这会调用`foo`默认情况下位于 PATH 中的脚本。这不是我想要的。

所以问题是，`./`在 shell 脚本中引用的语法是什么？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-06-06T01:01:22.160

如果两个脚本都在同一个目录中并且您收到`./foo.sh: No such file or directory`错误，那么最可能的原因是您从与它们所在的目录不同的目录运行第一个脚本。将以下内容放入您的第一个脚本中，以便调用`foo.sh`无论您从哪里调用第一个脚本，都可以工作：

```
my_dir=`dirname $0`
#Call the other script
$my_dir/foo.sh 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-07-16T01:39:47.570

以下代码适用于空格，并且不需要 bash 即可工作：

```
#!/bin/sh

SCRIPTDIR="$(dirname "$0")"

#Call the other script
"$SCRIPTDIR/foo.sh" 
```

此外，如果你想使用绝对路径，你可以这样做：

```
SCRIPTDIR=`cd "$(dirname "$0")" && pwd` 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T22:45:32.867

这可能对您有所帮助： [Unix shell 脚本找出脚本文件所在的目录？](https://stackoverflow.com/questions/242538/unix-shell-script-find-out-which-directory-the-script-file-resides)

但正如 sarnold 所说，“./”是针对*当前**工作**目录*的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-12-02T15:29:40.583

`script_dir="${BASH_SOURCE%/*}" # rm the last / and the file name from BASH_SOURCE`

`$script_dir/foo.sh`

参考：上面 Alex Che 的评论。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-05-11T15:01:39.373

为了使它成为POSIX：

```
a="/$0"; a=${a%/*}; a=${a:-.}; a=${a#/}/; BASEDIR=$(cd $a; pwd) 
```

在许多与 Bourne 兼容的 shell 上进行了测试，包括 BSD 的。

据我所知，我是作者，我把它放到了公共领域。有关更多信息，请参阅： [https ://blog.jasan.tk/posix/2017/05/11/posix_shell_dirname_replacement](https://blog.jasan.tk/posix/2017/05/11/posix_shell_dirname_replacement)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-12-14T02:22:34.970

如果您在包含脚本的目录的路径中有空格，则接受的解决方案不起作用。

如果你可以使用 bash，这对我有用：

```
#!/bin/bash
SCRIPTDIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
"${SCRIPTDIR}/foo.sh" 
```

# java - 操作栏溢出未显示

> ID：10905974
> 
> 赞同：6
> 
> 时间：2012-06-05T22:36:27.570
> 
> 标签：java, android, actionbarsherlock, android-actionbar

我正在用 Sherlock 设置一个带有 3 个项目/图标的操作栏。在 ICS 模拟器上运行，我只能看到 2 个图标。而且：没有溢出菜单（那 3 个点图标）！如果我按下手机的菜单按钮，我只会得到第三个图标。

我是否必须强制溢出图标，如果是，我该怎么做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-05T22:38:43.263

> 我是否必须强制溢出图标，如果是，我该怎么做？

您需要做的就是让您的主题继承自其中一个`.ForceOverflow`主题。请注意，这仅适用于*Android 2.0*和*3.0*。在*4.0*中使用了原生`ActionBar`组件，只有在设备没有菜单键时才会显示溢出项。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-05T22:40:29.773

> 我是否必须强制溢出图标

不。

默认情况下，您的模拟器设置为模拟具有屏幕外 MENU 键的设备，例如 Nexus S。此类设备不会有屏幕溢出菜单按钮 - 用户将使用 MENU 键访问溢出。其中许多设备，如 Nexus S，将是从 Android 2.x 升级的设备，用户已经习惯按 MENU 键来获取过去的选项菜单，现在是溢出菜单。

您可以切换模拟器以模拟没有屏幕外 MENU 键的设备。在您的 AVD 管理器中，对于 AVD，添加“Hardware Back/Home keys”属性（尽管有名称，但也有 MENU 键）并根据需要将其设置为 true 或 false。

# java - 使 @JsonTypeInfo 属性可选

> ID：10905975
> 
> 赞同：3
> 
> 时间：2012-06-05T22:36:30.577
> 
> 标签：java, json, jackson

我`@JsonTypeInfo`用来指示杰克逊在`@class`属性中查找具体类型信息。但是，有时我不想指定`@class`，特别是当可以根据上下文推断子类型时。 **最好的方法是什么？**

这是 JSON 的示例：

```
{ 
    "owner": {"name":"Dave"},
    "residents":[
        {"@class":"jacksonquestion.Dog","breed":"Greyhound"},
        {"@class":"jacksonquestion.Human","name":"Cheryl"},
        {"@class":"jacksonquestion.Human","name":"Timothy"}
    ]
} 
```

我正在尝试将它们反序列化为这些类（全部在`jacksonquestion.*`）：

```
public class Household {
    private Human owner;
    private List<Animal> residents;

    public Human getOwner() { return owner; }
    public void setOwner(Human owner) { this.owner = owner; }
    public List<Animal> getResidents() { return residents; }
    public void setResidents(List<Animal> residents) { this.residents = residents; }
}

public class Animal {}

public class Dog extends Animal {
    private String breed;
    public String getBreed() { return breed; }
    public void setBreed(String breed) { this.breed = breed; }
}

public class Human extends Animal {
    private String name;
    public String getName() { return name; }
    public void setName(String name) { this.name = name; }
} 
```

使用此配置：

```
@JsonTypeInfo(use = JsonTypeInfo.Id.CLASS, include = JsonTypeInfo.As.PROPERTY, property = "@class")
private static class AnimalMixin {
}

//...

ObjectMapper objectMapper = new ObjectMapper();
objectMapper.getDeserializationConfig().addMixInAnnotations(Animal.class, AnimalMixin.class);
Household household = objectMapper.readValue(json, Household.class);
System.out.println(household); 
```

如您所见，所有者被声明为人类，而不是动物，因此我希望能够省略`@class`并让杰克逊像往常一样推断类型。

当我运行这个时，我得到

```
org.codehaus.jackson.map.JsonMappingException: Unexpected token (END_OBJECT), 
   expected FIELD_NAME: missing property '@class' that is to contain type id  (for class jacksonquestion.Human) 
```

由于“所有者”没有指定`@class`.

有任何想法吗？我最初的一个想法是使用`@JsonTypeInfo`属性而不是类型。 ~~但是，这不能用于注释列表的元素类型。~~ （不正确，见答案）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T17:36:57.393

所以事实证明我误解了[Javadoc 为`@JsonTypeInfo`](http://jackson.codehaus.org/1.9.4/javadoc/org/codehaus/jackson/annotate/JsonTypeInfo.html). 当我在我的问题中说

> 我最初的想法是在属性上使用@JsonTypeInfo 而不是类型。但是，这不能用于注释列表的元素类型。

我是基于 Javadoc 中的这句话：

> 当用于属性（字段、方法）时，此注释适用于值：因此，当应用于结构类型（如 Collection、Map、数组）时，将适用于包含的值，而不是容器；对于非结构化类型没有区别。(...) 没有针对容器类型（结构化类型）强制包含类型信息的每个属性的方法；对于容器类型，必须使用注释进行类型声明。

我不知何故误读了相反的意思；类型信息将应用于容器而不是元素。显然那是错误的。所以我能够通过使用以下方法来解决这个问题：

```
public class Household {
   //...

   @JsonTypeInfo(use = JsonTypeInfo.Id.CLASS, include = JsonTypeInfo.As.PROPERTY, property = "@class")
   public void setResidents(List<Animal> residents) { 
      this.residents = residents; 
   }
} 
```

现在`@class`只需要`residents`属性中指定的动物。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T17:10:32.887

您可能实际上不应该这样做——这似乎是针对特殊情况的微优化，使生活复杂化——但如果你真的认为你确实想要这样做，你可以尝试`@JsonTypeInfo`在 Human 上添加覆盖。注释在 Jackson 中是可继承的，您可以覆盖定义。在这种情况下，使用哪一个取决于声明的类型：所以任何声明为的内容都会在;`Human`上看到注释。`Human`以及任何在“动物”中声明为`Animal`唯一的东西。

一个棘手的情况是根值（您直接序列化的值）：由于没有声明类型，它将使用运行时类型。这可能不会按照您想要的方式工作。

另一种可能性是子类化`AnnotationIntrospector`：您也可以更改`@JsonTypeInfo`那里的处理；看看有什么`JacksonAnnotationIntrospector`，覆盖适用的行为。

# actionscript-3 - 如何在 UIComponent 中添加/获取 Sprite

> ID：10905976
> 
> 赞同：0
> 
> 时间：2012-06-05T22:36:38.217
> 
> 标签：actionscript-3, apache-flex, flex4, sprite

如何将 Sprite 添加到 BorderContainer (UIComponent)？

```
var sprite:Sprite = new Sprite();
sprite.graphics.lineStyle(10,0);
sprite.graphics.moveTo(40,40);
sprite.graphics.lineTo(60,60);          

mybordercontainer.addChild(sprite);   
//mybrodercontainer is id of BorderContainer created in mxml 
```

此代码不起作用。我在 BorderContainer 上看不到 Sprite。如何在 UIComponents 上添加 Sprite，以便我可以看到它们？我试过这个，它有点工作：

```
var comp:UIComponent = new UIComponent();
comp.addChild(sprite);
myborderconteiner.addElement(comp); 
```

但我不认为这是将 Sprites 添加到 UIComponents 的正确方法。还有另一种方法吗？

* * *

第二个问题：

当我的 UIComponent（线条/圆圈/图像或其他）添加了几个 Sprite 时，如何从该 UIComponent 接收对象 Sprite，其中包含之前添加到该 UIComponent 的所有 Sprite？

我需要从那个 Sprite 创建位图并做一些事情。

我希望我清楚自己

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T22:43:58.960

使用[SpriteVisualElement](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/spark/core/SpriteVisualElement.html)作为容器。这应该可以很好地用作容器或 Sprite 替代品。您还可以绘制 UIComponent 本身。

# javascript - 无法让 JavaScript 检查空对象

> ID：10905980
> 
> 赞同：0
> 
> 时间：2012-06-05T22:36:49.793
> 
> 标签：javascript

我真的不知道这里有什么问题。据我所知，代码很简单，应该可以正常工作。

```
 var Prices="";
          for (var PriceCount = 1; PriceCount <= 120; PriceCount++) {
              var CurrentPrice = "Price" + PriceCount;
              if (prevDoc.getElementById(CurrentPrice).value != null) {
                  if (Prices == "") {
                      Prices = prevDoc.getElementById(CurrentPrice).value;
                  } else {
                      Prices += "," + prevDoc.getElementById(CurrentPrice).value;
                  }
              } else {
                  break;
              }
          } 
```

表单上最多可以有 120 个隐藏输入。当我们检查一个不存在的输入时，循环应该会中断。我的测试页面有两个被拉出的输入元素。在第三个（null）上，我在 firebug 中收到此错误：

```
prevDoc.getElementById(CurrentPrice) is null

 if (prevDoc.getElementById(CurrentPrice).value != null) { 
```

是的，它是空的……这就是 ಠ_ಠ 的检查</p>

有谁知道我做错了什么？这似乎应该是非常直截了当的。

编辑：为清楚起见，prevDoc=window.opener.document

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T22:38:51.443

```
if (prevDoc.getElementById(CurrentPrice).value != null) { 
```

可以扩展为：

```
var element = prevDoc.getElementById(CurrentPrice);    
var value = element.value; /* element is null, but you're accessing .value */

if (value != null) { 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T22:42:07.280

值永远不会为空。

如果未填写，则值为“”或长度为零。

如果该元素不存在，您将检查该元素是否存在。

```
var CurrentPrice = "Price" + PriceCount;
var elem = prevDoc.getElementById(CurrentPrice);
if (elem && elem.value != null) { 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T22:38:23.333

尝试

```
if (prevDoc.getElementById(CurrentPrice) !== null) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T22:48:48.540

我认为应该是：

```
var Prices="";
for (var PriceCount = 1; PriceCount <= 120; PriceCount++) {
    var CurrentPriceId = "Price" + PriceCount,
        CurrentPrice = prevDoc.getElementById(CurrentPriceId);

    if (CurrentPrice != null) {
        Prices = (Prices == "") ? CurrentPrice.value : (Prices + "," + CurrentPrice.value);
    }
    else break;
} 
```

# python - pyqt QObject：无法为位于不同线程中的父级创建子级

> ID：10905981
> 
> 赞同：2
> 
> 时间：2012-06-05T22:37:03.577
> 
> 标签：python, pyqt, qthread

QObject：无法为不同线程中的父级创建子级。（父是QTextDocument（0x9919018），父线程是QThread（0x97331e0），当前线程是flooderthread（0x97b4c10）错误意味着？对不起，因为我是pyqt的新手，这里是代码：

我知道代码已经完成但它应该可以工作我猜问题出在 myfun.log 函数上......

```
 #! /usr/bin/python
# -*- coding: utf-8 -*-
import urllib, urllib2, itertools, threading, cookielib, Cookie, sys, time, hashlib, os
from PyQt4 import QtCore, QtGui
try:
    _fromUtf8 = QtCore.QString.fromUtf8
except AttributeError:
    _fromUtf8 = lambda s: s
gui=QtGui.QApplication.processEvents
texttoset=""
class fun():
    global texttoset
    def checkpassword(self):
        if ui.passwordcheck.isChecked()==True:
            return 1
        else :
            return 0
    def log(self, text):
        if text != False:
            firsttext=str(ui.console.toPlainText())
            secondtext=firsttext+text+"\n"
            ui.console.setText(secondtext)
            log=open("log.log", "a")
            log.write(text+"\n")
            log.close()
        else :
            firsttext=str(ui.console.toPlainText())
            secondtext=firsttext+texttoset+"\n"
            ui.console.setText(secondtext)
            log=open("log.log", "a")
            log.write(texttoset+"\n")
            log.close()
    def disable(self):
        MainWindow.setEnabled(False)
        pass
    def enable(self):
        MainWindow.setEnabled(True)
        pass
    def checkmethod(self):
        if ui.get.isChecked()==True:
            return 1
        elif ui.post.isChecked()==True:
            return 2
        else :
            return 0
    def main(self):
        connecter()
        gui()
        f1.start()
        gui()
        time.sleep(3)
        gui()
        f2.start()
        gui()
        time.sleep(3)
        gui()
        f3.start()
        gui()
        time.sleep(3)
        gui()
        f4.start()
        gui()
        time.sleep(3)
        gui()
        f5.start()
        gui()
        self.sleep(3)
        gui()
        f6.start()
        gui()
    def killer(self):
        f1.terminate()
        f2.terminate()
        f3.terminate()
        f4.terminate()
        f5.terminate()
        f6.terminate()
    def close(self):
        self.killer()
        os.abort()
        sys.exit()

myfun=fun()
def connecter():
    QtCore.QObject.connect(f1, QtCore.SIGNAL("log(bool)"), myfun.log)
    QtCore.QObject.connect(f1, QtCore.SIGNAL("enable()"), myfun.enable)
    QtCore.QObject.connect(f1, QtCore.SIGNAL("disable()"), myfun.disable)

    QtCore.QObject.connect(f2, QtCore.SIGNAL("log(bool)"), myfun.log)
    QtCore.QObject.connect(f2, QtCore.SIGNAL("enable()"), myfun.enable)
    QtCore.QObject.connect(f2, QtCore.SIGNAL("disable()"), myfun.disable)

    QtCore.QObject.connect(f3, QtCore.SIGNAL("log(bool)"), myfun.log)
    QtCore.QObject.connect(f3, QtCore.SIGNAL("enable()"), myfun.enable)
    QtCore.QObject.connect(f3, QtCore.SIGNAL("disable()"), myfun.disable)

    QtCore.QObject.connect(f4, QtCore.SIGNAL("log(bool)"), myfun.log)
    QtCore.QObject.connect(f4, QtCore.SIGNAL("enable()"), myfun.enable)
    QtCore.QObject.connect(f4, QtCore.SIGNAL("disable()"), myfun.disable)

    QtCore.QObject.connect(f5, QtCore.SIGNAL("log(bool)"), myfun.log)
    QtCore.QObject.connect(f5, QtCore.SIGNAL("enable()"), myfun.enable)
    QtCore.QObject.connect(f5, QtCore.SIGNAL("disable()"), myfun.disable)

    QtCore.QObject.connect(f6, QtCore.SIGNAL("log(bool)"), myfun.log)
    QtCore.QObject.connect(f6, QtCore.SIGNAL("enable()"), myfun.enable)
    QtCore.QObject.connect(f6, QtCore.SIGNAL("disable()"), myfun.disable)
x=0
num=0
class flooderthread(QtCore.QThread):
    global texttoset
    def __init__(self, x, num):
        QtCore.QThread.__init__(self)
        self.x=x
        self.num=num
    def log(self, text):
        texttolog=str(text)
        time.sleep(1)
        self.emit(QtCore.SIGNAL("log(bool)"), False)
        time.sleep(2)
    def enable(self):
        time.sleep(1)
        self.emit(QtCore.SIGNAL("enable()"))
    def disable(self):
        time.sleep(1)
        self.emit(QtCore.SIGNAL("disable()"))
    def run(self):
        connecter()
        self.log("\n\n--------------------------------------------------new session-------------------------------------\n\n")
        itered=False
        gui()
        self.disable()
        gui()
        self.log("setting params...")
        param={ui.dataname1.text():ui.datavalue1.text(),ui.dataname3.text():ui.datavalue3.text(),ui.dataname3.text():ui.datavalue3.text(), }
        self.log("checking password...")
        if myfun.checkpassword()==1:
            itered=True
            self.log("password is true")
        else :
            self.log("password is null ")
            self.log("itered operation")
        self.log("setting url")
        url=str(ui.url.text())
        if url[:4]!="http" and url[:3]!="ftp":
            self.log("url error exiting the whole function")
            self.log("please set a valide protocole!!")
            gui()
            self.enable()
            gui()
            return 1
            pass
        else :
            self.log("valid url")
            gui()
            self.log("url is "+url)
        self.log("setting proxy")
        proxy="http://"+ui.proxyuser.text()+":"+ui.proxypass.text()+"@"+ui.proxyhost.text()+":"+ui.proxyport.text()
        self.log("proxy is "+proxy)
        gui()
        self.log("preparing params...")
        urlparam=urllib.urlencode(param)
        gui()
        self.log("params are "+urlparam)
        self.log("setting up headers...")
        header={'User-Agent':str(ui.useragent.toPlainText())}
        self.log("headers are "+ str(header))
        self.log("setting up proxy handler..")
        proxyhandler=urllib2.ProxyHandler({"http":str(proxy)})
        self.log("checking method")
        if myfun.checkmethod()==1:
            self.log("method is get..")
            self.log("setting request..")
            finalurl=url+urlparam
            gui()
            self.log("final url is"+finalurl)
            req=urllib2.Request(finalurl, None, headers)
        elif myfun.checkmethod()==2:
            self.log("method is post...")
            self.log("setting request..")
            finalurl=url
            gui()
            self.log("final url is "+finalurl)
            req=urllib2.Request(finalurl, urlparam, header)
        else :
            self.log("error has been accourded")
            self.log("please select a method!!")
            gui()
            self.log("exiting the whole functions")
            gui()
            self.enable()
            return 1
            pass
        self.log("intilizing cookies..")
        c1=Cookie.SimpleCookie()
        c1[str(ui.cookiename1.text())]=str(ui.cookievalue1.text())
        c1[str(ui.cookiename1.text())]['path']='/'
        c1[str(ui.cookiename2.text())]=str(ui.cookievalue2.text())
        c1[str(ui.cookiename2.text())]['path']='/'
        c1[str(ui.cookiename3.text())]=str(ui.cookievalue3.text())
        c1[str(ui.cookiename3.text())]['domain']=url
        c1[str(ui.cookiename3.text())]['path']='/'
        c1[str(ui.cookiename4.text())]=str(ui.cookievalue4.text())
        c1[str(ui.cookiename4.text())]['domain']=url
        c1[str(ui.cookiename4.text())]['path']='/'
        self.log("cookies are.. :"+str(c1))
        cj=cookielib.CookieJar()
        cj.set_cookie(c1)
        opener = urllib2.build_opener(proxyhandler, urllib2.HTTPCookieProcessor(cj))
        self.log("insatlling opener")
        urllib2.install_opener(opener)
        self.log("setting the two operations....")
        if itered==Fasle:
            self.log("starting the flooding loop")
            gui()
            while true:
                try:
                    gui()
                    opener.open(req)
                except e:
                    self.log("error connecting : "+e.reason)
                    self.log("will continue....")
                    continue
                gui()

        elif itered==True:
            pass
f1=flooderthread(1, 1)
f2=flooderthread(2, 2)
f3=flooderthread(3, 3)
f4=flooderthread(4, 4)
f5=flooderthread(5, 5)
f6=flooderthread(6, 6)
class Ui_MainWindow(object):
    def setupUi(self, MainWindow):
        MainWindow.setObjectName(_fromUtf8("MainWindow"))
        MainWindow.setMinimumSize(QtCore.QSize(838, 500))
        MainWindow.setMaximumSize(QtCore.QSize(838, 500))
        MainWindow.setWindowTitle(QtGui.QApplication.translate("MainWindow", "memo flooder", None, QtGui.QApplication.UnicodeUTF8))
        self.centralwidget = QtGui.QWidget(MainWindow)
        self.centralwidget.setObjectName(_fromUtf8("centralwidget"))
        self.console=QtGui.QTextEdit(self.centralwidget)
        self.console.setGeometry(10, 350, 800,130)
        self.console.setReadOnly(True)
        self.console.setObjectName("console")
        self.groupBox = QtGui.QGroupBox(self.centralwidget)
        self.groupBox.setGeometry(QtCore.QRect(30, 50, 71, 80))
        self.groupBox.setTitle(QtGui.QApplication.translate("MainWindow", "method:", None, QtGui.QApplication.UnicodeUTF8))
        self.groupBox.setObjectName(_fromUtf8("groupBox"))
        self.post = QtGui.QRadioButton(self.groupBox)
        self.post.setGeometry(QtCore.QRect(10, 20, 61, 22))
        self.post.setText(QtGui.QApplication.translate("MainWindow", "post", None, QtGui.QApplication.UnicodeUTF8))
        self.post.setChecked(True)
        self.post.setObjectName(_fromUtf8("post"))
        self.get = QtGui.QRadioButton(self.groupBox)
        self.get.setGeometry(QtCore.QRect(10, 50, 51, 22))
        self.get.setText(QtGui.QApplication.translate("MainWindow", "get", None, QtGui.QApplication.UnicodeUTF8))
        self.get.setObjectName(_fromUtf8("get"))
        self.url = QtGui.QLineEdit(self.centralwidget)
        self.url.setGeometry(QtCore.QRect(70, 20, 671, 27))
        self.url.setInputMethodHints(QtCore.Qt.ImhUrlCharactersOnly)
        self.url.setObjectName(_fromUtf8("url"))
        self.groupBox_2 = QtGui.QGroupBox(self.centralwidget)
        self.groupBox_2.setGeometry(QtCore.QRect(110, 50, 371, 111))
        self.groupBox_2.setTitle(QtGui.QApplication.translate("MainWindow", "data:", None, QtGui.QApplication.UnicodeUTF8))
        self.groupBox_2.setObjectName(_fromUtf8("groupBox_2"))
        self.dataname1 = QtGui.QLineEdit(self.groupBox_2)
        self.dataname1.setGeometry(QtCore.QRect(20, 30, 101, 27))
        self.dataname1.setObjectName(_fromUtf8("dataname1"))
        self.label = QtGui.QLabel(self.groupBox_2)
        self.label.setGeometry(QtCore.QRect(40, 10, 67, 17))
        self.label.setText(QtGui.QApplication.translate("MainWindow", "name:", None, QtGui.QApplication.UnicodeUTF8))
        self.label.setObjectName(_fromUtf8("label"))
        self.dataname2 = QtGui.QLineEdit(self.groupBox_2)
        self.dataname2.setGeometry(QtCore.QRect(130, 30, 113, 27))
        self.dataname2.setObjectName(_fromUtf8("dataname2"))
        self.dataname3 = QtGui.QLineEdit(self.groupBox_2)
        self.dataname3.setGeometry(QtCore.QRect(250, 30, 113, 27))
        self.dataname3.setObjectName(_fromUtf8("dataname3"))
        self.label_2 = QtGui.QLabel(self.groupBox_2)
        self.label_2.setGeometry(QtCore.QRect(40, 60, 67, 17))
        self.label_2.setText(QtGui.QApplication.translate("MainWindow", "value:", None, QtGui.QApplication.UnicodeUTF8))
        self.label_2.setObjectName(_fromUtf8("label_2"))
        self.datavalue1 = QtGui.QLineEdit(self.groupBox_2)
        self.datavalue1.setGeometry(QtCore.QRect(20, 80, 101, 27))
        self.datavalue1.setObjectName(_fromUtf8("datavalue1"))
        self.datavalue2 = QtGui.QLineEdit(self.groupBox_2)
        self.datavalue2.setGeometry(QtCore.QRect(130, 80, 113, 27))
        self.datavalue2.setObjectName(_fromUtf8("datavalue2"))
        self.datavalue3 = QtGui.QLineEdit(self.groupBox_2)
        self.datavalue3.setGeometry(QtCore.QRect(250, 80, 113, 27))
        self.datavalue3.setObjectName(_fromUtf8("datavalue3"))
        self.groupBox_4 = QtGui.QGroupBox(self.centralwidget)
        self.groupBox_4.setGeometry(QtCore.QRect(670, 50, 151, 111))
        self.groupBox_4.setTitle(QtGui.QApplication.translate("MainWindow", "password:", None, QtGui.QApplication.UnicodeUTF8))
        self.groupBox_4.setObjectName(_fromUtf8("groupBox_4"))
        self.passname = QtGui.QLineEdit(self.groupBox_4)
        self.passname.setGeometry(QtCore.QRect(10, 30, 113, 27))
        self.passname.setObjectName(_fromUtf8("passname"))
        self.passvalue = QtGui.QLineEdit(self.groupBox_4)
        self.passvalue.setGeometry(QtCore.QRect(10, 80, 113, 27))
        self.passvalue.setObjectName(_fromUtf8("passvalue"))
        self.passwordcheck = QtGui.QCheckBox(self.centralwidget)
        self.passwordcheck.setGeometry(QtCore.QRect(670, 180, 97, 22))
        self.passwordcheck.setText(QtGui.QApplication.translate("MainWindow", "password", None, QtGui.QApplication.UnicodeUTF8))
        self.passwordcheck.setChecked(True)
        self.passwordcheck.setObjectName(_fromUtf8("passwordcheck"))
        self.groupBox_5 = QtGui.QGroupBox(self.centralwidget)
        self.groupBox_5.setGeometry(QtCore.QRect(29, 169, 441, 81))
        self.groupBox_5.setTitle(QtGui.QApplication.translate("MainWindow", "proxy:", None, QtGui.QApplication.UnicodeUTF8))
        self.groupBox_5.setObjectName(_fromUtf8("groupBox_5"))
        self.proxyhost = QtGui.QLineEdit(self.groupBox_5)
        self.proxyhost.setGeometry(QtCore.QRect(20, 30, 113, 27))
        self.proxyhost.setObjectName(_fromUtf8("proxyhost"))
        self.proxyport = QtGui.QLineEdit(self.groupBox_5)
        self.proxyport.setGeometry(QtCore.QRect(140, 30, 51, 27))
        self.proxyport.setInputMethodHints(QtCore.Qt.ImhDigitsOnly|QtCore.Qt.ImhPreferNumbers)
        self.proxyport.setObjectName(_fromUtf8("proxyport"))
        self.proxyuser = QtGui.QLineEdit(self.groupBox_5)
        self.proxyuser.setGeometry(QtCore.QRect(200, 30, 113, 27))
        self.proxyuser.setObjectName(_fromUtf8("proxyuser"))
        self.proxypass = QtGui.QLineEdit(self.groupBox_5)
        self.proxypass.setGeometry(QtCore.QRect(320, 30, 113, 27))
        self.proxypass.setObjectName(_fromUtf8("proxypass"))
        self.label_4 = QtGui.QLabel(self.groupBox_5)
        self.label_4.setGeometry(QtCore.QRect(100, 10, 67, 17))
        self.label_4.setText(QtGui.QApplication.translate("MainWindow", "host", None, QtGui.QApplication.UnicodeUTF8))
        self.label_4.setObjectName(_fromUtf8("label_4"))
        self.label_5 = QtGui.QLabel(self.groupBox_5)
        self.label_5.setGeometry(QtCore.QRect(150, 10, 67, 17))
        self.label_5.setText(QtGui.QApplication.translate("MainWindow", "port", None, QtGui.QApplication.UnicodeUTF8))
        self.label_5.setObjectName(_fromUtf8("label_5"))
        self.label_6 = QtGui.QLabel(self.groupBox_5)
        self.label_6.setGeometry(QtCore.QRect(200, 10, 67, 17))
        self.label_6.setText(QtGui.QApplication.translate("MainWindow", "username", None, QtGui.QApplication.UnicodeUTF8))
        self.label_6.setObjectName(_fromUtf8("label_6"))
        self.label_7 = QtGui.QLabel(self.groupBox_5)
        self.label_7.setGeometry(QtCore.QRect(320, 10, 67, 17))
        self.label_7.setText(QtGui.QApplication.translate("MainWindow", "password", None, QtGui.QApplication.UnicodeUTF8))
        self.label_7.setObjectName(_fromUtf8("label_7"))
        self.groupBox_6 = QtGui.QGroupBox(self.centralwidget)
        self.groupBox_6.setGeometry(QtCore.QRect(30, 260, 531, 91))
        self.groupBox_6.setTitle(QtGui.QApplication.translate("MainWindow", "cookies:", None, QtGui.QApplication.UnicodeUTF8))
        self.groupBox_6.setObjectName(_fromUtf8("groupBox_6"))
        self.cookiename1 = QtGui.QLineEdit(self.groupBox_6)
        self.cookiename1.setGeometry(QtCore.QRect(10, 20, 113, 27))
        self.cookiename1.setObjectName(_fromUtf8("cookiename1"))
        self.cookiename2 = QtGui.QLineEdit(self.groupBox_6)
        self.cookiename2.setGeometry(QtCore.QRect(140, 20, 113, 27))
        self.cookiename2.setObjectName(_fromUtf8("cookename2"))
        self.cookiename3 = QtGui.QLineEdit(self.groupBox_6)
        self.cookiename3.setGeometry(QtCore.QRect(270, 20, 113, 27))
        self.cookiename3.setObjectName(_fromUtf8("cookiename3"))
        self.cookiename4 = QtGui.QLineEdit(self.groupBox_6)
        self.cookiename4.setGeometry(QtCore.QRect(390, 20, 113, 27))
        self.cookiename4.setObjectName(_fromUtf8("cookiename4"))
        self.cookievalue1 = QtGui.QLineEdit(self.groupBox_6)
        self.cookievalue1.setGeometry(QtCore.QRect(10, 50, 113, 27))
        self.cookievalue1.setObjectName(_fromUtf8("cookievalue1"))
        self.cookievalue2 = QtGui.QLineEdit(self.groupBox_6)
        self.cookievalue2.setGeometry(QtCore.QRect(140, 50, 113, 27))
        self.cookievalue2.setObjectName(_fromUtf8("cookievalue2"))
        self.cookievalue3 = QtGui.QLineEdit(self.groupBox_6)
        self.cookievalue3.setGeometry(QtCore.QRect(270, 50, 113, 27))
        self.cookievalue3.setObjectName(_fromUtf8("cookievalue3"))
        self.cookievalue4 = QtGui.QLineEdit(self.groupBox_6)
        self.cookievalue4.setGeometry(QtCore.QRect(390, 50, 113, 27))
        self.cookievalue4.setObjectName(_fromUtf8("cookievalue4"))
        self.groupBox_7 = QtGui.QGroupBox(self.centralwidget)
        self.groupBox_7.setGeometry(QtCore.QRect(570, 260, 251, 80))
        self.groupBox_7.setTitle(QtGui.QApplication.translate("MainWindow", "useragents:", None, QtGui.QApplication.UnicodeUTF8))
        self.groupBox_7.setObjectName(_fromUtf8("groupBox_7"))
        self.useragent = QtGui.QTextEdit(self.groupBox_7)
        self.useragent.setGeometry(QtCore.QRect(10, 20, 211, 51))
        self.useragent.setVerticalScrollBarPolicy(QtCore.Qt.ScrollBarAlwaysOn)
        self.useragent.setObjectName(_fromUtf8("useragent"))
        self.start = QtGui.QPushButton(self.centralwidget)
        self.start.setGeometry(QtCore.QRect(750, 20, 71, 27))
        self.start.setText(QtGui.QApplication.translate("MainWindow", "start", None, QtGui.QApplication.UnicodeUTF8))
        self.start.setObjectName(_fromUtf8("start"))
        self.label_3 = QtGui.QLabel(self.centralwidget)
        self.label_3.setGeometry(QtCore.QRect(30, 20, 67, 17))
        self.label_3.setText(QtGui.QApplication.translate("MainWindow", "url :", None, QtGui.QApplication.UnicodeUTF8))
        self.label_3.setObjectName(_fromUtf8("label_3"))
        MainWindow.setCentralWidget(self.centralwidget)
        QtCore.QObject.connect(self.start, QtCore.SIGNAL(_fromUtf8("clicked(bool)")), myfun.main)
        QtCore.QObject.connect(self.passwordcheck, QtCore.SIGNAL(_fromUtf8("clicked(bool)")), self.groupBox_4.setEnabled)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)

def __del__():
    myfun.killer()
    os.abort()
    sys.exit()

app = QtGui.QApplication(sys.argv)
MainWindow = QtGui.QMainWindow()
ui = Ui_MainWindow()
ui.setupUi(MainWindow)
myfun.log("\n\n--------------------------------------------------new session-------------------------------------\n\n")
MainWindow.show()
sys.exit(app.exec_()) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T23:08:13.233

就其意图而言，我几乎不知道您的代码中发生了什么，但这是导致您崩溃的有问题的代码行：

```
class flooderthread(QtCore.QThread):
    ...
    def run(self):
        connecter() # this is the culprit 
```

在您的`fun.main()`中，您已经调用了`connecter()`一次来设置所有信号/插槽连接。此调用发生在您的主线程中。但是随后您让每个线程也调用该方法，该方法试图跨线程建立与对象的重复连接。实际的崩溃可能比这个函数更深，因为它是信号触发的结果，但我发现绕过代码很难深入。很可能您让线程在不应该直接修改 GUI 元素时。

一旦你修复了这个问题，你还有另一个会导致崩溃的错字：

```
def main(self):
    connecter()
    ...
    time.sleep(3)
    gui()
    f5.start()
    gui()
    self.sleep(3)  # should be time.sleep(3)
    gui()
    ... 
```

除此之外，我只想指出这个脚本非常难以遵循。您到处都在使用全局变量，因此很难知道某些变量和函数调用是在哪里定义的。您必须滚动一堆，将它们追下来。您可能希望在它继续滚雪球之前停止并重新组织它。
我**强烈**建议拿起这样一本书：[http](http://www.qtrac.eu/pyqtbook.html)
: //www.qtrac.eu/pyqtbook.html 你应该关注的是组织适当的课程。您当前的类结构需要大量复习，因此您甚至可能想拿起一本好的 Python 书来首先学习如何编写类。我意识到你只是在学习，这就是为什么我希望这个建议能帮助你朝着正确的方向前进。

# java - 检测字符串中的 IRC 颜色

> ID：10905984
> 
> 赞同：2
> 
> 时间：2012-06-05T22:37:46.873
> 
> 标签：java, unicode, utf-8, irc

如何检测字符串中的[IRC 颜色代码？](http://www.mirc.com/colors.html)

这是我尝试过的：

```
int length = message.length();
ArrayList<Object> buffer = new ArrayList<Object>();
for (int i = 0; i < length; i++) {
  char ch = message.charAt(i);
  if (Character.isDefined(ch) && !Character.isLetter(ch)) {
    Methods.log("val " + (int) ch);//Attempt logging the irc color value
  } else {
    buffer.add(ch);
  }
} 
```

然而这失败了。我正在为我的 11 年级编程课编写一个 IRC 客户端，我认为添加颜色将是一个很酷的功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:48:38.993

IRC 颜色[由 mIRC “指定”](http://www.mirc.com/colors.html) ——它很复杂，并且并非所有客户端都以相同的方式解释规范——但您正在寻找`^C`“控制字符”（`0x03`），后跟描述特定前景色和背景色的数字使用。

在文本流中找到它们后，您需要弄清楚如何更改文本小部件上的文本颜色，*并*记住在输出下一条消息之前将文本设置为正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T00:33:34.343

固定的

```
 int length = message.length();
        LinkedList<Object> buffer = new LinkedList<Object>();
        for (int i = 0; i < length; i++) {
            char ch = message.charAt(i);
            if ((byte) ch == 3) {
                String color = "";
                i++;
                while (i < length) {//loop
                    char d = message.charAt(i);
                    if ((d >= '0') && (d <= '9')) {
                        if (color.length() == 2) {
                            i--;
                            break;//break b4 stackoverflow!!!
                        }
                        color += d;
                        i++;
                    } else {
                        i--;
                        break;//break b4 stackoverflow!!!
                    }
                }
                for (IRCModifier m : IRCModifier.values()) {
                    if (m.getCode().equalsIgnoreCase(color)
                            || m.getCode().replace("0", "")
                                    .equalsIgnoreCase(color)) {
                        buffer.add(m.getEffect());
                        break;
                    }
                }
            } else {
                buffer.add(ch);
            }
        } 
```

# git - 未找到 git post-update 挂钩中的 Bash 命令

> ID：10905990
> 
> 赞同：5
> 
> 时间：2012-06-05T22:38:32.523
> 
> 标签：git, bash, amazon-ec2, terminal, githooks

我在一个 git post-update 挂钩中有以下代码，该挂钩位于`cd`我的工作目录中，并从该 git 挂钩所在的裸 git 存储库中提取：

```
cd $HOME/www/firefly

unset GIT_DIR

git pull hub master

combine

npm rebuild

exec git update-server-info 
```

问题是当它运行时`combine`，我得到：

```
hooks/post-update: line 14: combine: command not found 
```

奇怪的是，如果我手动 cd 进入我的工作目录并运行`combine`它会成功执行文件。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-05T22:41:52.913

组合不是 shell 命令。您可能需要完整路径，或者`./combine`如果它位于同一目录中。

错误的原因是运行脚本时您的路径不同。

# asp.net-mvc - ASP.NET MVC - 服务层，每个控制器动作中的单个或多个服务？

> ID：10905992
> 
> 赞同：2
> 
> 时间：2012-06-05T22:38:41.383
> 
> 标签：asp.net-mvc, asp.net-mvc-3

我开始为我的 MVC 项目实现一个服务层，以减少一些臃肿的控制器（它也有存储库/工作单元模式）。

我的问题是，如果您有一个包含大量子对象等的页面的复杂视图模型，并且在幕后进行了大量逻辑（让您了解原始开发人员编写的控制器有近 4000 行代码！ ！）可以让多个服务停止做他们的事情吗？还是我应该只拥有一个可以完成所有工作的大型 ReportService？

我的控制器开始看起来像这样？如果我继续下去，我最终可能会调用很多不同的服务来构建视图模型。

这看起来不错还是开始朝错误的方向发展？

```
public ViewResult Index(int? reportId)
    {
        // get the base report object
        var reportService = new ReportService();
        var report = reportService.GetByReportId(reportId);
        var model = Mapper.Map<Report, ReportViewModel>(report);

        // get the current active user
        var userService = new UserService();
        var user = userService.GetCurrentUser();
        model.User = Mapper.Map<User, ReportViewModel.UserViewModel>(user);

        // get the first unread message
        var messageService = new MessageService();
        var message = messageService.GetFirstUnread(user.Id);
        model.Message = Mapper.Map<Message, ReportViewModel.MessageViewModel>(message);

        // get the category navigation
        var categoryService = new CategoryService();
        var categoryNavigation = categoryService.GetCategoryNavigation(report.Id);
        model.CategoryNavigation = Mapper.Map<IEnumerable<Category>, IEnumerable<ReportViewModel.CategoryNavigationViewModel>>(categoryNavigation);

        return View(model);
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T22:55:17.453

在您的控制器中有多个小型服务很好。但是，这里有一个问题：

您的服务应该在整个控制器中可用，并通过构造函数注入以实现松耦合。

所以是这样的：

```
private readonly IReportService _reportService;
private readonly IUserService _userService;

public SomeConstructor(IReportService reportService, IUserService userService, etc.) 
{
    _reportService = reportService;
    _userService = userService;
    // etc
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T03:48:38.357

这看起来确实是一个不错的方法，另一种方法是通过使用子操作将其中的一部分拆分——不过，最好的解决方案将取决于您的具体用例。

例如，如果视图使用 ViewModel 属性`CategoryNavigation`来创建一种可能在多个不同视图中有用的导航“小部件”，则最好将其拆分为 ChildAction，例如

```
[ChildActionOnly]
public ActionResult CategoryNavigationWidget(int reportId)
{
    // get the category navigation
    var categoryService = new CategoryService();
    var categoryNavigation = categoryService.GetCategoryNavigation(report.Id);

    return PartialView(categoryNavigation);
} 
```

然后，任何 View 都可以通过以下方式呈现该 ChildAction：

```
 @{ Html.RenderAction("CategoryNavigationWidget", "Report", 
           new { reportId = Model.ReportId }); } 
```

这是否是一个好主意可能取决于“小部件”是否可重用。

# javascript - Javascript中有没有办法确定是否没有元素处于焦点？

> ID：10905995
> 
> 赞同：2
> 
> 时间：2012-06-05T22:38:47.163
> 
> 标签：javascript

我正在将一些热键构建到我的 HTML 页面中：

```
 $(document).bind('keypress', function (e) {
        var event = (e.keyCode ? e.keyCode : e.which);

        if (event == LETTER_P) {
            // go to another page
        }
    } 
```

但问题是，如果他们在页面上输入文本（在文本框元素等中）并点击字母“P”，他们就会转到另一个页面。如果它们不在任何元素中，我只希望重定向发生。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T22:47:49.780

`document.activeElement`如今，所有主要浏览器都支持。如果没有元素处于焦点，`activeElement`则将返回文档正文，因此：

```
if (document.activeElement === document.body) {
    // Nothing is in focus
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T22:47:59.530

你可以尝试这样的事情：

```
$(document).bind('keypress', function (e) {
    var event = (e.keyCode ? e.keyCode : e.which);

    if (event == LETTER_P && document.activeElement.tagName == "input") {
        // go to another page
    }
} 
```

我对您的代码的添加不需要任何库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T22:45:29.177

您可以`:focus`在 jQuery 中使用选择器。

```
if ( $( "input:focus, textarea:focus" ).length ) {
   // there is a focused element
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-05T22:49:12.533

```
if ( $('input:focus, select:focus').length){
   // there is a focused element which would respond to a keypress
} 
```