# StackOverflow 问答 1019000-1019999

# iphone - OS 3.0 中的快速枚举

> ID：1019003
> 
> 赞同：2
> 
> 时间：2009-06-19T17:00:05.767
> 
> 标签：iphone, objective-c, iphone-sdk-3.0

我刚刚尝试针对 OS 3.0 编译我的 iPhone 应用程序，但在使用快速枚举时出现编译错误。

我正在尝试通过包含 cComment 类的 NSArray：

```
for (cComment* newComment in comments.comments) 
```

我得到这个错误

错误：访问器的类型与属性“注释”的类型不匹配。

这在使用 OS 2.2.1 编译时可以完美运行。

我理解这个错误，枚举不是强类型的，但据我所知，objective-c 不支持泛型/模板。所以目前我只能看到一种解决方法：

```
for (id commentObject in comments.comments)
{
     cComment *newComment = (cComment *)commentObject;
} 
```

谁能想到另一种方式？为什么这发生了变化？任何关于此更改的苹果文档将不胜感激。

编辑

按照 Grouchal 的建议，我尝试了这个： NSArray* allComments = comments.comments 并且我得到了同样的错误，所以它似乎与枚举无关

这是头文件中的代码：

NSMutableArray *评论；

@property (readonly,nonatomic) NSArray* 注释；

属性综合在实现文件中。

将属性更改为 NSMutableArray 似乎可以解决问题，但我看不出有什么理由会出现这种情况。有任何想法吗。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T17:53:19.600

问题出在属性定义中。您应该将其更改为：

`@property (readonly,nonatomic) NSMutableArray* comments`

不利的一面是，您的数组将被公开为可变的（尽管我想这是您想要防止的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T18:07:34.693

我将结束这个问题，并在 iPhone OS 3.0 的 Objective-c 更改下提出一个新问题。

我自己实现了 getter 方法来返回一个 NSArray，它工作得很好。将属性更改为 NSMutableArray 也可以，但这确实不是我想要做的。

我不知道为什么这会改变。这是客观 c 更改，而不是操作系统更改。在 2.2 API 3.0 API 之间的更改的文档中也没有提及它。

感谢大家的回复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T17:24:53.533

我看不出为什么这段代码不能在 OS 3.0 中运行我已经有类似的代码在运行。

如果将代码更改为

```
NSArray *commentArray = comments.comments;
for (cComment *newComment in commentArray){
.....
} 
```

我刚刚注意到，当我写了这个 * 在你的代码中 - 这是问题吗？它真的应该是 for 声明中的 cComment* 吗？

# sas - 在 SAS 中使用 Retain 语句进行数学运算

> ID：1019005
> 
> 赞同：1
> 
> 时间：2009-06-19T17:00:08.027
> 
> 标签：sas

我有一个数据集，每人有 4 个观察值（行）。

我想创建三个新变量来计算第二行和第一行、第三行和第二行以及第四行和第三行之间的差异。

我认为保留可以做到这一点，但我不知道如何。

还是我需要一个数组？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T17:29:50.080

```
 data test;
  input person var;
  datalines;
1 5
1 10
1 12
1 20
2 1
2 3
2 5
2 90
;
run;

data test;
  set test;
  by person notsorted;
  retain pos;
  array diffs{*} diff0-diff3;
  retain diff0-diff3;
  if first.person then do;
    pos = 0;
  end;
  pos + 1;
  diffs{pos} = dif(var);
  if last.person then output;
  drop var diff0 pos;
run; 

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-08T20:15:18.023

为什么不使用滞后功能。

```
data test;  input person var;
cards; 
1 5
1 10
1 12
1 20
2 1
2 3
2 5
2 90
run;

data test;  set test;
by person; 
LagVar=Lag(Var);
difference=var-Lagvar;
if first.person then difference=.;
run; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-29T04:46:44.140

```
data output_data;   
   retain count previous_value diff1 diff2 diff3;  
   set data input_data    
     by person;  
   if first.person then do;   
     count = 0;  
   end;  
   else do;  
     count = count + 1;  
     if count = 1 then diff1 = abs(value - previous_value);  
     if count = 2 then diff2 = abs(value - previous_value);  
     if count = 3 then do;   
       diff3 = abs(value - previous_value);   
       output output_data;   
     end;  
   end;  
   previous_value = value;  
run; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-23T12:37:29.280

**没有数组**的替代方法。

```
/*-- Data from simonn's answer --*/
data SO1019005;
  input person var;
  datalines;
1 5
1 10
1 12
1 20
2 1
2 3
2 5
2 90
;
run;

/*-- Why not just do a transpose? --*/
proc transpose data=SO1019005 out=NewData;
by person;
run;

/*-- Now calculate your new vars --*/
data NewDataWithVars;
set NewData;

NewVar1 = Col2 - Col1;
NewVar2 = Col3 - Col2;
Newvar3 = Col4 - Col3;

run; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-20T18:21:54.670

为什么不使用 diff() 函数呢？

```
/* test data */
data one;
  do id = 1 to 2;
    do v = 1 to 4 by 1;
      output;
    end;
  end;
run;
/* check */
proc print data=one;
run;
/* on lst
Obs    id    v

 1      1    1
 2      1    2
 3      1    3
 4      1    4
 5      2    1
 6      2    2
 7      2    3
 8      2    4
*/

/* now create diff within id */
data two;
  set one;
  by id notsorted; /* assuming already in order */
  dif = ifn(first.id, ., dif(v));
run;
proc print data=two;
run;
/* on lst
Obs    id    v    dif
 1      1    1     .
 2      1    2     1
 3      1    3     1
 4      1    4     1
 5      2    1     .
 6      2    2     1
 7      2    3     1
 8      2    4     1
*/ 
```

# c# - 修改或隐藏表单的标题工具提示

> ID：1019007
> 
> 赞同：2
> 
> 时间：2009-06-19T17:00:52.753
> 
> 标签：c#, windows, winapi, windows-xp, tooltip

我们有一个 MDI 表单，其中包含一些子表单，这些子表单具有不同的标题，显示当前加载的文档的文件名。当子窗体最大化时，它们的标题文本被放置在父窗口的标题栏中，这通常会导致文本太长而无法放入条中，并且 Windows 足以添加省略号并截断文本。

但是，当您将鼠标悬停在主窗口的标题栏上时，它会显示一个工具提示，其中应该是整个字符串，但工具提示通常包含字符串的一小部分。例如，如果主表单的文本是：

```
程序 1 - 文件名：[Really_long_filename_that_doesnt_fit.file]
```

它会在工具提示中显示如下：

```
程序 1 - 文件名：[Really_long_filename_t
```

编辑：它总是将工具提示截断为 100 个字符，这让我相信它是某处指定的上限。

有没有办法改变它以显示整个字符串，或者如果没有，完全禁用工具提示？

任何语言都是可以接受的，尽管我们在 C# 中这样做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T17:24:00.820

当鼠标移到标题栏上时，它使用手动工具提示和计时器来显示/隐藏标题。

```
public partial class Form1 : Form
{
    private ToolTip toolTip = new ToolTip();
    private Timer toolTipTimer = new Timer();
    private bool canShowToolTip = true;

    protected override void WndProc(ref Message m)
    {
        switch (m.Msg)
        {
            case 0x2A0: // WM_NCMOUSEHOVER
                return;
            case (int)0x00A0: // WM_NCMOUSEMOVE
                if (m.WParam == new IntPtr(0x0002)) // HT_CAPTION
                {
                    if (canShowToolTip)
                    {
                        canShowToolTip = false;
                        toolTip.Show(this.Text, this, this.PointToClient(Cursor.Position), toolTip.AutoPopDelay);
                        toolTipTimer.Start();
                    }
                }
                return;
        }
        base.WndProc(ref m);
    }

    public Form1()
    {
        InitializeComponent();
        Form child = new Form();
        child.Text = "Program1 - Filename:[Really_long_filename_that_doesnt_fit.file] AAAAAAAAAAAAAAAAAAAA BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB";
        child.MdiParent = this;
        child.Show();
        toolTip.AutoPopDelay = 5000;
        toolTipTimer.Interval = toolTip.AutoPopDelay;
        toolTipTimer.Tick += delegate(object sender, EventArgs e)
        {
            canShowToolTip = true;
        };
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T17:06:38.767

我希望我有一些对你更有帮助的东西，但不幸的是，我认为没有办法解决这个问题。您可以缩短文件名或必须处理它:(

# c# - WPF Listview 空文本

> ID：1019017
> 
> 赞同：9
> 
> 时间：2009-06-19T17:03:15.653
> 
> 标签：c#, .net, wpf, listview

如何使用 GridView 在 WPF Listview 中显示一个空文本（如在 ASP.net 中），例如“请选择一个人”或“0 个已创建项目”？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-19T21:33:16.470

这个 XAML 会做类似的事情，它有一个可见的 ListView 显示一个列表和一个隐藏的消息，并在列表为空时使用触发器切换可见性。

下面的代码适用于任何 IList 或 ICollection，但同样的技术可用于任何数据源，就像往常一样，如果您希望在添加或删除需要使用 ObservableCollection 或类似的项目时更新显示。

ContentPresenter 的存在是因为您只能在模板或样式中使用触发器，因此我们将控件放在 DataTemplate 中并使用 ContentPresenter 来显示它。

如果您希望消息出现在 ListView 中，那么您所要做的就是删除隐藏 ListView 的 Setter 并向 TextBlock 添加一些边距以将其定位在 ListVIew 中的第一个项目应位于的位置。

```
<ContentPresenter Content="{Binding}">
    <ContentPresenter.ContentTemplate>
        <DataTemplate>
            <Grid>
                <ListView Name="list" ItemsSource="{Binding MyList}"/>
                <TextBlock Name="empty" Text="No items found" Visibility="Collapsed"/>
            </Grid>
            <DataTemplate.Triggers>
                <DataTrigger Binding="{Binding MyList.Count}" Value="0">
                    <Setter TargetName="list" Property="Visibility" Value="Collapsed"/>
                    <Setter TargetName="empty" Property="Visibility" Value="Visible"/>
                </DataTrigger>                        
            </DataTemplate.Triggers>
        </DataTemplate>
    </ContentPresenter.ContentTemplate>
</ContentPresenter> 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-06-19T17:10:34.223

将它绑定到返回所需文本的 DataSource + 属性？插入一个虚拟对象，其字符串表示是您想要的文本..

# java - Java桌面应用程序的应用程序框架？

> ID：1019030
> 
> 赞同：3
> 
> 时间：2009-06-19T17:06:06.757
> 
> 标签：java, swing, spring, frameworks

我目前正在使用自定义框架来构建通过网络进行事件监控的 Java Swing 应用程序。我想用 JMS 之类的东西替换我们的自定义网络层，但我们的框架与其当前的实现紧密耦合。

这导致我搜索可能已经具有我们需要的功能的现有应用程序框架。Spring 是我考虑的框架之一，因为它似乎是可用的更轻量级的解决方案之一。我们目前正在使用 Guice 来满足我们的 DI 需求，但我发现我也可以从 Spring 容器中获得类似的功能。

Spring 是否适合构建 Java Swing 应用程序，还是我应该考虑其他应用程序框架？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T17:16:50.270

您可以使用 Spring 来执行此操作，请查看以下文章以了解如何使用它来构建 Swing 应用程序：

[http://java.dzone.com/news/spring-enabling-decoupled-swin](http://java.dzone.com/news/spring-enabling-decoupled-swin)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T17:38:39.070

Spring 是执行此操作的最佳框架。

我们在客户端（Swing）以及中间层的大型能源交易应用程序中使用 Spring。它值得所有的起义。

# windows - 如何在 Windows 中创建虚拟打印机？

> ID：1019036
> 
> 赞同：19
> 
> 时间：2009-06-19T17:08:37.533
> 
> 标签：windows, winapi, printing, driver, postscript

我想为 Windows 创建一个虚拟打印机驱动程序。我如何以及在哪里可以正确开始？WDK 有一些打印驱动程序示例，这些示例似乎不是很好的介绍。MSDN 对新手似乎也不是很有帮助。

那里有很多适用于 Windows 的虚拟打印机（主要是生成 PDF），我想知道是否有人可以告诉我我该怎么做？

提前感谢任何指向详细文档的链接。

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-19T17:14:39.587

当我这样做时（大约 12 年前），我从 postscript 驱动程序示例开始，替换了所有 postscript 特定的东西（在我的例子中，写入位图而不是生成 postscript 命令）。

我还编写了一个自定义打印监视器（驱动程序写入后台处理程序，后台程序写入监视器）：我的监视器写入文件而不是并行端口。

但是，从那时起，打印机驱动程序架构和/或示例驱动程序集可能已经改变。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T17:45:20.250

您可以查看 Microsoft (Microsoft MDT) 中的“微型驱动程序”开发，这可能会根据您的具体需求有所帮助。如果您需要处理的端口（即：您要从现有的打印机驱动程序中获取数据并想要处理），您可以查看 RedMon 的源代码。它不支持 Vista/Win7，但可能会为您指明正确的方向。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-29T18:54:17.413

这本书可能会帮助您[使用 Windows® Driver Foundation 开发驱动程序](http://www.microsoft.com/learning/en/us/book.aspx?ID=10512&locale=en-us)

我的链接列表

1.  [http://www.codeproject.com/KB/system/driverdev.aspx](http://www.codeproject.com/KB/system/driverdev.aspx)
2.  [http://www.microsoft.com/whdc/ddk/winddk.mspx](http://www.microsoft.com/whdc/ddk/winddk.mspx)
3.  [http://jungo.com/wdusb.html](http://jungo.com/wdusb.html)
4.  [https://web.archive.org/web/20130717135254/https://msdn.microsoft.com/en-us/library/ff554651.aspx](http://msdn.microsoft.com/en-us/library/ff554651.aspx)
5.  [http://channel9.msdn.com/posts/Rory/Driver-Development-and-Much-More-With-Mike-Calligaro/](http://channel9.msdn.com/posts/Rory/Driver-Development-and-Much-More-With-Mike-Calligaro/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-19T17:23:03.990

您提到的驱动程序之一是开源（GPL），也许您可​​以探索它的源代码或调整它：[http ://www.pdfforge.org/products/pdfcreator/download](http://www.pdfforge.org/products/pdfcreator/download)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-30T09:19:47.013

其他人已经提到了 PDFCreator。这是他们创建打印机、端口和监视器的代码的更具体的链接。尽管在 VB 中，但我可以像更习惯 C++ 的人一样关注它，所以我想你也可以。 [modPrinter.bas](http://pdfcreator.svn.sourceforge.net/viewvc/pdfcreator/trunk/InstallPrinter/modPrinter.bas?revision=388&view=markup)做腿部工作。 [modMain.bas](http://pdfcreator.svn.sourceforge.net/viewvc/pdfcreator/trunk/InstallPrinter/modMain.bas?revision=311&view=markup)大约从第 28 行开始，调用 modPrinter.bas。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-21T01:43:31.450

创建一个打印端口监视器，将该端口与打印机相关联，您将获得打印机驱动程序发送到该端口的数据。

可以在此处找到如何在 Cpp 和 java 中完成的工作示例： [http ://www.mms-computing.co.uk/uk/co/mmscomputing/device/printmonitor/index.php](http://www.mms-computing.co.uk/uk/co/mmscomputing/device/printmonitor/index.php)

# ms-access - MS Access 中的可编辑、可附加组合框（？）

> ID：1019039
> 
> 赞同：1
> 
> 时间：2009-06-19T17:09:54.567
> 
> 标签：ms-access

我的目标：

具有一些下拉选项的表单字段（在 MS Access 中）。如果想要的值不在查找表中，用户应该能够通过输入来添加它。

假设查找表有行：A、B、C、D。用户想要尚不存在的“E”。理想情况下，他们会“覆盖”并输入“E”，然后将其添加到查找表中以供将来输入。

我的 google-fu 在这方面失败了。我应该使用这个术语吗？有哪些好的方法？（到目前为止，我一直在玩组合框及其向导）。

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T17:23:51.213

啊哈，在这里解决了我自己的问题：

[http://allenbrowne.com/ser-27-01.html](http://allenbrowne.com/ser-27-01.html)

> 访问 2007
> 
> 要使用 Access 2007 中的新属性：
> 
> 1.  在设计视图中打开您的表单。
> 2.  右键单击该组合，然后选择“属性”。
> 3.  在“属性”框的“数据”选项卡上，将“允许值列表编辑”设置为“是”，将“列表项编辑表单”设置为用于将项目添加到列表的表单名称。
> 
> 当您使用此表单时，您现在可以右键单击组合，然后选择编辑列表项。

还有针对旧版本 Access 的建议。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-22T14:37:13.493

您可以尝试以下代码：

```
Private Sub Combo33_NotInList(NewData As String, Response As Integer)

   Dim strSql     As String
   If MsgBox(NewData & " not in list, add?", _
      vbYesNo + vbQuestion) = vbYes Then
      strSql = "insert into tblStudents (name) values(" & NewData & ")"
      CurrentDb.Execute strSql
      Response = acDataErrAdded
   End If

End Sub 
```

注意我使用了学生的表名和 Sname 的字段名。因此，只需将表名和字段更改为您使用的任何内容。

# algorithm - N以下有多少个数与N互质？

> ID：1019040
> 
> 赞同：21
> 
> 时间：2009-06-19T17:09:57.797
> 
> 标签：algorithm, math

## 简而言之：

假设如果**GCD(a,b) = 1**（其中 GCD 代表[大公约数），](http://en.wikipedia.org/wiki/Greatest_common_divisor) **a**与**b**互质，那么N 以下有多少正整数与 N 互质？

 **有没有聪明的方法？

* * *

## 不必要的东西

这是最愚蠢的方法：

```
def count_coprime(N):
    counter = 0
    for n in xrange(1,N):
        if gcd(n,N) == 1:
            counter += 1
    return counter 
```

它有效，但它很慢，而且很愚蠢。我想使用一个聪明和更快的算法。我尝试使用 N 的质因数和除数，但我总是得到一些不适用于较大 N 的东西。

~~我认为该算法应该能够计算它们而无需像最愚蠢的算法那样计算所有它们：P~~

## 编辑

看来我找到了一个可行的：

```
def a_bit_more_clever_counter(N):
    result = N - 1
    factors = []
    for factor, multiplicity in factorGenerator(N):
        result -= N/factor - 1
        for pf in factors:
            if lcm(pf, factor) < N:
                result += N/lcm(pf, factor) - 1
        factors += [factor]
    return result 
```

其中 lcm 是最小公倍数。有人有更好的吗？

## 笔记

我正在使用python，我认为即使不了解python的人也应该可以阅读代码，如果您发现任何不清楚的地方，请在评论中提问。我对算法和数学、想法很感兴趣。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-06-19T18:24:12.937

**[编辑]**最后一个想法，哪个（IMO）足够重要，我会把它放在开头：如果你一次收集一堆 totients，你可以避免很多多余的工作。不要费心从大数开始寻找它们的较小因子——相反，迭代较小的因子并为较大的数字累积结果。

```
class Totient:
    def __init__(self, n):
        self.totients = [1 for i in range(n)]
        for i in range(2, n):
            if self.totients[i] == 1:
                for j in range(i, n, i):
                    self.totients[j] *= i - 1
                    k = j / i
                    while k % i == 0:
                        self.totients[j] *= i
                        k /= i
    def __call__(self, i):
        return self.totients[i]
if __name__ == '__main__':
    from itertools import imap
    totient = Totient(10000)
    print sum(imap(totient, range(10000))) 
```

这在我的桌面上只需要 8 毫秒。

* * *

[Euler totient 函数](http://en.wikipedia.org/wiki/Euler_totient_function)的维基百科页面有一些很好的数学结果。

![\sum_{d\mid n}\varphi(d)](../Images/f9f2d647c334f60292794e3112fa9afe.png)计算与 的每个除数互质且小于 的数字![n](../Images/a5abc3b3eecdd8e35f126cc95957e7b4.png)：这有一个平凡的*映射来计算从![1](../Images/ef05d34103d588ffe7c7013d34838f07.png)到的整数![n](../Images/a5abc3b3eecdd8e35f126cc95957e7b4.png)，因此总和为![n](../Images/a5abc3b3eecdd8e35f126cc95957e7b4.png)。

** 按* [平凡的第二个定义](http://meshula.net/wordpress/?p=294)

[这对于莫比乌斯反演公式](http://en.wikipedia.org/wiki/M%C3%B6bius_inversion_formula)的应用来说是完美的，这是一个巧妙的技巧，用于反转这种精确形式的总和。

![\varphi(n)=\sum_{d\mid n}d\cdot\mu\left(\frac nd\right)](../Images/4de62bd796f70b448b09440d3e79e0ae.png)

这自然会导致代码

```
def totient(n):
    if n == 1: return 1
    return sum(d * mobius(n / d) for d in range(1, n+1) if n % d == 0)
def mobius(n):
    result, i = 1, 2
    while n >= i:
        if n % i == 0:
            n = n / i
            if n % i == 0:
                return 0
            result = -result
        i = i + 1
    return result 
```

[莫比乌斯函数](http://en.wikipedia.org/wiki/M%C3%B6bius_function)存在更好的实现，它可以被记忆以提高速度，但这应该很容易理解。

totient函数更明显的计算是

![\varphi\left(p_1^{k_1}\dots p_r^{k_r}\right)=(p_1-1)p_1^{k_1-1}\dots(p_r-1)p_r^{k_r-1}p_1^{ k_1}\dots p_r^{k_r}\prod_{i=1}^r\left(1-\frac1{p_r}\right)](../Images/1da3c4d792b1858a97908e9201cdab3c.png)

换句话说，将数字完全分解为唯一的素数和指数，然后从那里进行简单的乘法运算。

```
from operator import mul
def totient(n):
    return int(reduce(mul, (1 - 1.0 / p for p in prime_factors(n)), n))
def primes_factors(n):
    i = 2
    while n >= i:
        if n % i == 0:
            yield i
            n = n / i
            while n % i == 0:
                n = n / i
        i = i + 1 
```

同样，存在更好的实现`prime_factors`，但这是为了便于阅读。

* * *

`# helper functions`

```
from collections import defaultdict
from itertools import count
from operator import mul
def gcd(a, b):
    while a != 0: a, b = b % a, a
    return b
def lcm(a, b): return a * b / gcd(a, b)
primes_cache, prime_jumps = [], defaultdict(list)
def primes():
    prime = 1
    for i in count():
        if i < len(primes_cache): prime = primes_cache[i]
        else:
            prime += 1
            while prime in prime_jumps:
                for skip in prime_jumps[prime]:
                    prime_jumps[prime + skip] += [skip]
                del prime_jumps[prime]
                prime += 1
            prime_jumps[prime + prime] += [prime]
            primes_cache.append(prime)
        yield prime
def factorize(n):
    for prime in primes():
        if prime > n: return
        exponent = 0
        while n % prime == 0:
            exponent, n = exponent + 1, n / prime
        if exponent != 0:
            yield prime, exponent 
```

`# OP's first attempt`

```
def totient1(n):
    counter = 0
    for i in xrange(1, n):
        if gcd(i, n) == 1:
            counter += 1
    return counter 
```

`# OP's second attempt`

```
# I don't understand the algorithm, and just copying it yields inaccurate results 
```

`# Möbius inversion`

```
def totient2(n):
    if n == 1: return 1
    return sum(d * mobius(n / d) for d in xrange(1, n+1) if n % d == 0)
mobius_cache = {}
def mobius(n):
    result, stack = 1, [n]
    for prime in primes():
        if n in mobius_cache:
            result = mobius_cache[n]
            break
        if n % prime == 0:
            n /= prime
            if n % prime == 0:
                result = 0
                break
            stack.append(n)
        if prime > n: break
    for n in stack[::-1]:
        mobius_cache[n] = result
        result = -result
    return -result 
```

`# traditional formula`

```
def totient3(n):
    return int(reduce(mul, (1 - 1.0 / p for p, exp in factorize(n)), n)) 
```

`# traditional formula, no division`

```
def totient4(n):
    return reduce(mul, ((p-1) * p ** (exp-1) for p, exp in factorize(n)), 1) 
```

使用此代码计算我桌面上从 1 到 9999 的所有数字的总数，平均运行 5 次以上，

*   `totient1`永远需要
*   `totient2`需要 10 秒
*   `totient3`耗时 1.3s
*   `totient4`耗时 1.3s

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-06-19T17:11:21.197

这是[欧拉函数](http://en.wikipedia.org/wiki/Euler_totient_function)phi。

它具有令人兴奋的乘法特性：如果 gcd(m,n) = 1 则 phi(mn) = phi(m)phi(n)。并且 phi 很容易计算素数的幂，因为它们下面的所有东西都是互质的，除了同一个素数的较小幂的倍数。

显然，因式分解仍然不是一个微不足道的问题，但即使是 sqrt(n) 试除法（足以找到所有质因数）也能胜过欧几里得算法的 n-1 次应用。

如果你记忆，你可以降低计算大量它们的平均成本。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-19T18:23:04.310

这是维基百科页面上给出的公式的简单、直接的实现，使用 gmpy 进行简单的因式分解（我有偏见，但如果你关心在 Python 中玩有趣的整数东西，你可能想要 gmpy ......;-)：

```
import gmpy

def prime_factors(x):
    prime = gmpy.mpz(2)
    x = gmpy.mpz(x)
    factors = {}
    while x >= prime:
        newx, mult = x.remove(prime)
        if mult:
            factors[prime] = mult
            x = newx
        prime = prime.next_prime()
    return factors

def euler_phi(x):
    fac = prime_factors(x)
    result = 1
    for factor in fac:
      result *= (factor-1) * (factor**(fac[factor]-1))
    return result 
```

例如，在我的普通工作站上，计算 euler_phi(123456789) [我得到 82260072] 需要 937 微秒（使用 Python 2.5；使用 2.4 为 897），这似乎是一个相当合理的性能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T20:13:15.820

以下是有关此问题的其他讨论的一些链接——包括其他一些语言实现：

[http://www.velocityreviews.com/forums/t459467-computing-eulers-totient-function.html](http://www.velocityreviews.com/forums/t459467-computing-eulers-totient-function.html)

[http://www.google.com/codesearch?q=Euler%27s+totient&hl=en&btnG=代码](http://www.google.com/codesearch?q=Euler%27s+totient&hl=en&btnG=Code)**

# java - Java 中的烹饪单元

> ID：1019042
> 
> 赞同：22
> 
> 时间：2009-06-19T17:10:07.220
> 
> 标签：java, units-of-measurement

是否有任何开源库用于表示 Java 中的茶匙和汤匙等烹饪单位？

我只发现了 JSR-275 ( [https://jcp.org/en/jsr/detail?id=275](https://jcp.org/en/jsr/detail?id=275) )，它很棒，但不了解烹饪单元。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-19T17:54:00.877

JScience 是可扩展的，因此您应该能够创建 javax.measure.unit.SystemOfUnits 的子类。您将创建许多公共静态最终声明，如下所示：

```
public final class Cooking extends SystemOfUnits {
  private static HashSet<Unit<?>> UNITS = new HashSet<Unit<?>>();

  private Cooking() {
  }

  public static Cooking getInstance() {
    return INSTANCE;
  }
  private static final Cooking INSTANCE = new SI();

  public static final BaseUnit<CookingVolume> TABLESPOON = si(new BaseUnit<CookingVolume>("Tbsp"));

  ...

   public static final Unit<CookingVolume> GRAM = TABLESPOON.divide(1000);

}

public interface CookingVolume extends Quantity {
  public final static Unit<CookingVolume> UNIT = Cooking.TABLESPOON;
} 
```

只要您知道转换因子是什么，定义其他单位和转换非常简单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T17:54:28.397

这可能有一些用处：[JUnitConv](http://www.tecnick.com/public/code/cp_dpage.php?aiocp_dp=junitconv)。这是一个用于转换单位（包括烹饪单位）的 Java 小程序，但它是 GPL 许可的，因此您可以下载源代码并调整相关部分以供您自己使用。

另一方面，看起来创建一个`CookingUnits`符合 JSR 275 的类应该不难。（这就是我要做的）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-10-11T15:54:36.377

恐怕，JSR-275 已被拒绝，我们无法为您提供帮助，但[JSR-363](http://unitsofmeasurement.github.io)在 9 月才进入决赛，所以如果您对“烹饪单位”等单位系统有很好的想法，请告诉我们在[UoM-Systems](https://github.com/unitsofmeasurement/uom-systems)下知道。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T17:21:40.060

我想您可以解析 wiki 页面以进行烹饪测量：[烹饪重量和测量](http://en.wikipedia.org/wiki/Cooking_weights_and_measures)

它以表格形式组织了所有度量，因此解析它们应该很容易。

# jquery - 如何在加载来自 jquery 选项卡的内容之前显示“正在加载”

> ID：1019043
> 
> 赞同：8
> 
> 时间：2009-06-19T17:10:22.040
> 
> 标签：jquery, jquery-ui

我正在使用 jquery UI 选项卡，并且加载到选项卡中的内容在另一个页面上。所以它是通过ajax加载的。页面加载之间存在一些延迟，在此期间将加载选项卡内容的屏幕部分完全为空。有没有办法在内容加载之前显示一些消息，例如“正在加载....”？

我的代码是：

```
<script type="text/javascript">
    $(function(){
        $("#tabs").tabs();
    });
</script>

            <div id="tabs">
                <ul>
                    <li><a href="/failedPrescreenReport.jsp</a></li>
                    <li><a href="/failedverificationreport.jsp</a></li>
                    <li><a href="VerificationReport.action</a></li>
                </ul>
            </div> 
```

我试过使用这个插件的[微调器](http://docs.jquery.com/UI/Tabs#option-spinner)选项，但这似乎对我不起作用......（也许我的 css 搞砸了）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-01-29T10:16:49.533

无需做额外的事情，只需添加**跨度**标签 insdie 你的锚。我认为它在 jQuery 的文档中被遗漏了。

例子：

```
<script type="text/javascript">
    $(function(){
        $("#tabs").tabs();
    });
</script>

<div id="tabs">
    <ul>
        <li><a href="/failedPrescreenReport.jsp"><span>Tab 1</span></a></li>
        <li><a href="/failedverificationreport.jsp"><span>Tab 2</span></a></li>
        <li><a href="VerificationReport.action"><span>Tab 3</span></a></li>
    </ul>
</div> 
```

**跨度**标签是重要的部分。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-19T17:16:41.860

我建议听 jquery ajaxStart、ajaxStop 和 ajaxError 事件，在 ajaxStart 上显示“加载”弹出窗口，将其隐藏在 AjaxStop 和 ajaxError 上。这样，您的加载弹出窗口将在 ajax 请求待处理时显示，无需任何额外编程。

例如：

```
$(function() {
  $(this).ajaxStart(function() {
    $("#ajaxLoading").show(); });
  $(this).ajaxStop(function() {
    $("#ajaxLoading").hide(); });
 }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-20T07:29:29.520

最近刚刚写了[jquery 插件](http://code.google.com/p/jquery-loadmask/)，这可能会有所帮助。它在元素上放置一个带有微调器的掩码，因此对于您的 ajax 调用，您可以在调用之前显示掩码并在回调函数中取消掩码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-29T17:30:32.597

blockUI 很棒，但我敢打赌[http://plugins.jquery.com/project/loading](http://plugins.jquery.com/project/loading)更适合这种情况。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-20T17:43:32.643

jquery [blockui](http://malsup.com/jquery/block/)非常适合这个。一个非常快速、优雅的解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-05-22T12:28:38.920

我所做的最好的事情就是针对 ajax 驱动的标签页...希望你会喜欢这个答案

*$("#facilityTabContainer").tabs({ **panelTemplate:"Loading..."** , selected : 0, scrollable : true, cache : false });*

您甚至可以修改 jquery.ui.tabs 中的 panelTemplate ，以便应用程序中的所有选项卡都将自动获取“正在加载文本或图像”。猜猜它也解决了你的第一个标签加载问题。

# html - 如何即时将html textarea中的内容格式化为xml

> ID：1019056
> 
> 赞同：2
> 
> 时间：2009-06-19T17:13:47.823
> 
> 标签：html, formatting

我有一个页面，用户可以将 xml 标记添加到文本区域输入中。我想在他们输入它之后将它进行颜色编码和格式化，因为 xml 会在诸如 Visual Studio 之类的 IDE 中显示。有人知道在客户端浏览器中允许这样做的脚本或工具吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-19T17:23:11.213

看看[CodeMirror](http://marijn.haverbeke.nl/codemirror)，一个用于浏览器的 Javascript 语法高亮编辑器。[这](http://marijn.haverbeke.nl/codemirror/htmltest.html)是 XML 编辑的示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T17:19:20.827

简短的回答：**你不能**。

不是在一个`TEXTAREA`, 作为这里的一个。

SO 中的示例非常好，因为它有一个`TEXTAREA`我们输入文本的位置，以及一个`DIV`下方的框，您可以在其中看到您输入的格式。

你也可以通过`contentEditable = "true"`，但是正确地做真的很痛苦......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-05-26T12:11:09.493

一个不错的选择是：[vkBeautify](http://www.eslinstructor.net/vkbeautify/)

这是一个例子：

```
(function() {

function createShiftArr(step) {

	var space = '    ';

	if ( isNaN(parseInt(step)) ) {  // argument is string
		space = step;
	} else { // argument is integer
		switch(step) {
			case 1: space = ' '; break;
			case 2: space = '  '; break;
			case 3: space = '   '; break;
			case 4: space = '    '; break;
			case 5: space = '     '; break;
			case 6: space = '      '; break;
			case 7: space = '       '; break;
			case 8: space = '        '; break;
			case 9: space = '         '; break;
			case 10: space = '          '; break;
			case 11: space = '           '; break;
			case 12: space = '            '; break;
		}
	}

	var shift = ['\n']; // array of shifts
	for(ix=0;ix<100;ix++){
		shift.push(shift[ix]+space); 
	}
	return shift;
}

function vkbeautify(){
	this.step = '    '; // 4 spaces
	this.shift = createShiftArr(this.step);
};

vkbeautify.prototype.xml = function(text,step) {

	var ar = text.replace(/>\s{0,}</g,"><")
				 .replace(/</g,"~::~<")
				 .replace(/\s*xmlns\:/g,"~::~xmlns:")
				 .replace(/\s*xmlns\=/g,"~::~xmlns=")
				 .split('~::~'),
		len = ar.length,
		inComment = false,
		deep = 0,
		str = '',
		ix = 0,
		shift = step ? createShiftArr(step) : this.shift;

		for(ix=0;ix<len;ix++) {
			// start comment or <![CDATA[...]]> or <!DOCTYPE //
			if(ar[ix].search(/<!/) > -1) { 
				str += shift[deep]+ar[ix];
				inComment = true; 
				// end comment  or <![CDATA[...]]> //
				if(ar[ix].search(/-->/) > -1 || ar[ix].search(/\]>/) > -1 || ar[ix].search(/!DOCTYPE/) > -1 ) { 
					inComment = false; 
				}
			} else 
			// end comment  or <![CDATA[...]]> //
			if(ar[ix].search(/-->/) > -1 || ar[ix].search(/\]>/) > -1) { 
				str += ar[ix];
				inComment = false; 
			} else 
			// <elm></elm> //
			if( /^<\w/.exec(ar[ix-1]) && /^<\/\w/.exec(ar[ix]) &&
				/^<[\w:\-\.\,]+/.exec(ar[ix-1]) == /^<\/[\w:\-\.\,]+/.exec(ar[ix])[0].replace('/','')) { 
				str += ar[ix];
				if(!inComment) deep--;
			} else
			 // <elm> //
			if(ar[ix].search(/<\w/) > -1 && ar[ix].search(/<\//) == -1 && ar[ix].search(/\/>/) == -1 ) {
				str = !inComment ? str += shift[deep++]+ar[ix] : str += ar[ix];
			} else 
			 // <elm>...</elm> //
			if(ar[ix].search(/<\w/) > -1 && ar[ix].search(/<\//) > -1) {
				str = !inComment ? str += shift[deep]+ar[ix] : str += ar[ix];
			} else 
			// </elm> //
			if(ar[ix].search(/<\//) > -1) { 
				str = !inComment ? str += shift[--deep]+ar[ix] : str += ar[ix];
			} else 
			// <elm/> //
			if(ar[ix].search(/\/>/) > -1 ) { 
				str = !inComment ? str += shift[deep]+ar[ix] : str += ar[ix];
			} else 
			// <? xml ... ?> //
			if(ar[ix].search(/<\?/) > -1) { 
				str += shift[deep]+ar[ix];
			} else 
			// xmlns //
			if( ar[ix].search(/xmlns\:/) > -1  || ar[ix].search(/xmlns\=/) > -1) { 
				str += shift[deep]+ar[ix];
			} 

			else {
				str += ar[ix];
			}
		}

	return  (str[0] == '\n') ? str.slice(1) : str;
}

window.vkbeautify = new vkbeautify();

})();

var xmlData = '<note><to>Tove</to><from>Jani</from><heading>Reminder</heading><body>Don\'t forget me this weekend!</body></note>';
xmlData = vkbeautify.xml(xmlData);
$('textarea').val(xmlData);
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<textarea cols="30" rows="10"></textarea>
```

# java - 如何以编程方式取消选择 JTable (swing) 中当前选定的行？

> ID：1019062
> 
> 赞同：27
> 
> 时间：2009-06-19T17:15:51.953
> 
> 标签：java, swing

我想以编程方式取消选择 JTable 中当前选定的行（或行）。

基本上我想要与此相反的：

```
JTable table = ...;
table.setRowSelectionInterval(x,x); 
```

我尝试（几乎没有希望）使用：

```
table.setRowSelectionInterval(-1,-1) 
```

或者

```
table.setRowSelectionInterval(1,0) 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-06-19T19:29:41.260

有一个方法`JTable`被调用`clearSelection`。这反过来又调用`clearSelection`了`ListSelectionModel`表和列模型。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-06-19T17:20:35.817

我相信你可以使用这个：

```
table.getSelectionModel().clearSelection(). 
```

SelectionModel 是实际处理选择的东西。JTable 只是有一些快捷方式。

# iphone - 使用谓词查询核心数据 - iPhone

> ID：1019070
> 
> 赞同：10
> 
> 时间：2009-06-19T17:17:58.643
> 
> 标签：iphone

所以我试图从核心数据中获取对象。我有 80 个对象的列表，我希望能够使用 UISearchBar 搜索它们。它们显示在表格中。

使用关于谓词的苹果文档，我将以下代码放在 UISearchBar 委托方法之一中。

```
- (void)searchBarSearchButtonClicked:(UISearchBar *)searchBar {
  if (self.searchBar.text !=nil)
  {
    NSPredicate *predicate =[NSPredicate predicateWithFormat:@"name LIKE %@", self.searchBar.text];
    [fetchedResultsController.fetchRequest setPredicate:predicate];
  }
  else
  {
    NSPredicate *predicate =[NSPredicate predicateWithFormat:@"All"];
    [fetchedResultsController.fetchRequest setPredicate:predicate];
  }

  NSError *error = nil;
  if (![[self fetchedResultsController] performFetch:&error]) {
        // Handle error
        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
        abort();  // Fail
    }       

  [self.tableView reloadData];

    [searchBar resignFirstResponder];   
    [_shadeView setAlpha:0.0f];
} 
```

如果我在搜索字段中键入与其中一个对象的 name 属性完全匹配的内容，则搜索将起作用，并且它会使用具有对象名称的单个单元格重新填充表。如果我不准确搜索名称，我最终没有结果。

有什么想法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-19T17:50:37.590

似乎 iPhone 不喜欢 LIKE 运算符。我将它替换为“包含 [cd]”，它按我想要的方式工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-10-17T00:05:45.827

使用 contains[cd] 而不是 like，并更改：

`NSPredicate *predicate =[NSPredicate predicateWithFormat:@"All"];`

到：

`NSPredicate *predicate =[NSPredicate predicateWithFormat:@"1=1"];`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T18:02:42.720

您是否使用 MATCH 和正则表达式尝试过？只是好奇看看是否应该在 iPhone 上避免使用 LIKE ......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-01-15T11:38:28.553

在典型的 Core Data 应用程序中，应该删除 NSF fetchedResultsController：

```
[NSFetchedResultsController deleteCacheWithName: [self.fetchedResultsController cacheName]]; 
```

否则你会得到一个异常（理想情况下）或者你会有奇怪的行为。

# vb6 - 如何在 Outlook 属性页 OCX 上使用 VB6 调试器？

> ID：1019071
> 
> 赞同：2
> 
> 时间：2009-06-19T17:18:13.170
> 
> 标签：vb6, outlook, debugging

使用 VB6，我创建了一个 Outlook 插件，它有一个属性页。属性页是一个 OCX 控件。

当我将项目编译为 OCX 文件，然后运行 ​​OUTLOOK 时，一切正常：我可以将 OCX 视为 Outlook 选项中的选项卡。

但是，当我尝试通过在 VB6 中运行 OCX 进行调试时，出现错误。我的调试是这样开始的：1）调试选项设置为等待创建组件“2）在VB6中F5-RUN项目。3）启动Outlook。4）得到错误：“无法显示“MyOcx”页面。此页面将保持可见，但不可用。发生 OLE 注册错误。程序未正确安装。再次为程序运行安装程序”

我怀疑这是因为在调试时，OCX 是在进程外创建的，而 Outlook 不喜欢这样。

在这种情况下，是否有一种在 OCX 上使用 VB6 调试器的好方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-20T16:58:36.677

正如MarkJ所说，您真正能够调试的唯一方法是In Process。使用免费的 Visual Studio 2008 C++ Express Edition（或者更好的 Visual Studio 2008 Professional，如果有的话，它可以[试用 90 天](http://msdn.microsoft.com/en-gb/vstudio/products/cc268305.aspx)）和 PDB。

为确保您正在创建 PDB，请进入 Visual Basic，检查**P** **)roject** / P) 属性并单击**Compile**标记。确保选中“创建符号调试信息”。

接下来启动 Outlook，并从 Visual Studio ( **T)tools** / **Attach To Process 附加到**该进程。确保您的 Ocx 显示在模块窗口中，然后加载 PDB（右键单击模块窗口中的 Ocx）。您可能必须在解决方案属性中添加源代码（有关如何执行此操作的更多详细信息，[请阅读这篇文章](http://blogs.msdn.com/robgruen/archive/2004/11/09/254602.aspx)）。

第一次会有点痛，但是一旦你能做到，它就变得非常容易，而且比试图从日志中确定发生了什么要容易得多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T18:37:11.137

调试 DLL 或 OCX 时，VB6 调试器有时会不稳定。

*   你可以试试[Windbg](http://www.microsoft.com/whdc/devtools/debugging/default.mspx)，一个来自 Microsoft 的免费独立调试器。将您的 VB6 OCX 编译为本机代码，无需优化并“创建符号调试信息”（即创建 PDB 文件），您将能够在 Outlook 中调试您的 OCX 进程。这是 Microsoft 人员[2006 年](http://blogs.msdn.com/marklon/archive/2006/01/28/518616.aspx)关于将 Windbg 与 VB6 结合使用的[博客文章，以及另一位 Microsoft 人员 2004 年](http://mtaulty.com/2004/08/03/m_4656/)关于 Windbg的简要介绍的博客文章。
*   您还可以将 Visual Studio 2008 调试器用于 VB6 和 PDB 文件，例如使用[Visual C++ Express Edition](http://www.microsoft.com/Express/vc/)（免费）。编辑请参阅[Kris 的答案](https://stackoverflow.com/questions/1019071/how-to-use-vb6-debugger-on-outlook-property-page-ocx/1022019#1022019)以获取更多详细信息。
*   编辑：Windbg 和 Visual Studio 都[希望](http://www.wintellect.com/CS/blogs/jrobbins/archive/2009/05/11/pdb-files-what-every-developer-must-know.aspx)源代码在调试机器上的路径与构建 OCX 时在构建机器上的路径完全相同。最简单的方法是在同一台机器上构建和调试。否则，您可能需要[摆弄](http://www.wintellect.com/CS/blogs/jrobbins/archive/2009/05/11/pdb-files-what-every-developer-must-know.aspx)[SUBST](http://technet.microsoft.com/en-us/library/bb491006.aspx)来创建虚拟驱动器 - 或者我被告知严肃的方法是使用[Symbol Server](http://msdn.microsoft.com/en-us/magazine/cc301459.aspx)。
*   （不太严重）你可以不用那些新奇的交互式调试器，只需登录到一个文件，或者使用[来自 VB6 的 DebugMessage 调用](http://visualstudiomagazine.com/articles/2008/11/17/executing-debuggables.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T17:26:57.667

我对OCX没有太多想法。

但是，您可以使用名为“activex control test tool”之类的 Visual Studio 一部分的工具。

据我所知（基于我对文档的理解），OCX 是在进程内创建的。

# php - 如何在 PHP 中的多维数组中按 key=>value 进行搜索

> ID：1019076
> 
> 赞同：161
> 
> 时间：2009-06-19T17:19:57.333
> 
> 标签：php, arrays, search, recursion

有没有什么快速的方法来获取在多维数组中找到键值对的所有子数组？我不能说阵列有多深。

简单示例数组：

```
$arr = array(0 => array(id=>1,name=>"cat 1"),
             1 => array(id=>2,name=>"cat 2"),
             2 => array(id=>3,name=>"cat 1")
); 
```

当我搜索 key=name 和 value="cat 1" 时，该函数应返回：

```
array(0 => array(id=>1,name=>"cat 1"),
      1 => array(id=>3,name=>"cat 1")
); 
```

我猜这个函数必须是递归的才能达到最深层次。

* * *

## 回答 #1

> 赞同：229
> 
> 时间：2009-06-19T17:31:02.590

代码：

```
function search($array, $key, $value)
{
    $results = array();

    if (is_array($array)) {
        if (isset($array[$key]) && $array[$key] == $value) {
            $results[] = $array;
        }

        foreach ($array as $subarray) {
            $results = array_merge($results, search($subarray, $key, $value));
        }
    }

    return $results;
}

$arr = array(0 => array(id=>1,name=>"cat 1"),
             1 => array(id=>2,name=>"cat 2"),
             2 => array(id=>3,name=>"cat 1"));

print_r(search($arr, 'name', 'cat 1')); 
```

输出：

```
Array
(
    [0] => Array
        (
            [id] => 1
            [name] => cat 1
        )

    [1] => Array
        (
            [id] => 3
            [name] => cat 1
        )

) 
```

如果效率很重要，您可以编写它，以便所有递归调用将其结果存储在同一个临时`$results`数组中，而不是将数组合并在一起，如下所示：

```
function search($array, $key, $value)
{
    $results = array();
    search_r($array, $key, $value, $results);
    return $results;
}

function search_r($array, $key, $value, &$results)
{
    if (!is_array($array)) {
        return;
    }

    if (isset($array[$key]) && $array[$key] == $value) {
        $results[] = $array;
    }

    foreach ($array as $subarray) {
        search_r($subarray, $key, $value, $results);
    }
} 
```

关键是`search_r`通过引用而不是值来获取它的第四个参数；& 号`&`是至关重要的。

*仅供参考：如果您有旧版本的 PHP，那么您必须在调用*中`search_r`而不是在其声明中指定传递引用部分。也就是说，最后一行变为`search_r($subarray, $key, $value, &$results)`.

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2009-06-19T18:55:11.310

那么[SPL](http://php.net/spl)版本呢？它会为您节省一些输入：

```
// I changed your input example to make it harder and
// to show it works at lower depths:

$arr = array(0 => array('id'=>1,'name'=>"cat 1"),
             1 => array(array('id'=>3,'name'=>"cat 1")),
             2 => array('id'=>2,'name'=>"cat 2")
);

//here's the code:

    $arrIt = new RecursiveIteratorIterator(new RecursiveArrayIterator($arr));

 foreach ($arrIt as $sub) {
    $subArray = $arrIt->getSubIterator();
    if ($subArray['name'] === 'cat 1') {
        $outputArray[] = iterator_to_array($subArray);
    }
} 
```

很棒的是，基本上相同的代码将通过使用 RecursiveDirectoryIterator 而不是 RecursiveArrayIterator 为您遍历目录。SPL 是 roxor。

关于 SPL 的唯一遗憾是它在网络上的记录很糟糕。但是有几本 PHP 书籍介绍了一些有用的细节，尤其是 Pro PHP；你也可以通过谷歌搜索更多信息。

* * *

## 回答 #3

> 赞同：57
> 
> 时间：2013-02-20T04:52:47.700

```
<?php
$arr = array(0 => array("id"=>1,"name"=>"cat 1"),
             1 => array("id"=>2,"name"=>"cat 2"),
             2 => array("id"=>3,"name"=>"cat 1")
);
$arr = array_filter($arr, function($ar) {
   return ($ar['name'] == 'cat 1');
   //return ($ar['name'] == 'cat 1' AND $ar['id'] == '3');// you can add multiple conditions
});

echo "<pre>";
print_r($arr);

?> 
```

参考： http: [//php.net/manual/en/function.array-filter.php](http://php.net/manual/en/function.array-filter.php)

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2011-06-10T07:02:53.177

回来为任何需要关于这些答案的优化提示的人发布此更新，特别是上面 John Kugelman 的出色答案。

他发布的函数工作正常，但我必须优化这个场景以处理 12 000 行结果集。该函数需要花费 8 秒的时间来遍历所有记录，太长了。

我只需要该函数停止搜索并在找到匹配项时返回。即，如果搜索 customer_id，我们知道结果集中只有一个，一旦我们在多维数组中找到 customer_id，我们就想返回。

这是此功能的速度优化（和大大简化）版本，供有需要的人使用。与其他版本不同，它只能处理一个深度的数组，不递归并且不需要合并多个结果。

```
// search array for specific key = value
public function searchSubArray(Array $array, $key, $value) {   
    foreach ($array as $subarray){  
        if (isset($subarray[$key]) && $subarray[$key] == $value)
          return $subarray;       
    } 
} 
```

这降低了将 12 000 条记录匹配到 1.5 秒的任务。*仍然非常昂贵*，但更合理。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2010-06-28T12:21:16.353

```
if (isset($array[$key]) && $array[$key] == $value) 
```

对快速版本的小改进。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2017-01-16T06:19:51.863

这是解决方案：

```
<?php
$students['e1003']['birthplace'] = ("Mandaluyong <br>");
$students['ter1003']['birthplace'] = ("San Juan <br>");
$students['fgg1003']['birthplace'] = ("Quezon City <br>");
$students['bdf1003']['birthplace'] = ("Manila <br>");

$key = array_search('Delata Jona', array_column($students, 'name'));
echo $key;  

?> 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2012-06-15T04:16:06.807

小心多维数组中的线性搜索算法（以上是线性的），因为它们的复杂性增加，因为它的深度增加了遍历整个数组所需的迭代次数。例如：

```
array(
    [0] => array ([0] => something, [1] => something_else))
    ...
    [100] => array ([0] => something100, [1] => something_else100))
) 
```

使用合适的算法最多需要 200 次迭代才能找到您要查找的内容（如果针在 [100][1] 处）。

在这种情况下，线性算法以 O(n)（整个数组中元素的总数量排序）执行，这很糟糕，一百万个条目（例如 1000x100x10 数组）平均需要 500,000 次迭代才能找到针。另外，如果您决定更改多维数组的结构，会发生什么？如果你的深度超过 100，PHP 会退出递归算法。计算机科学可以做得更好：

在可能的情况下，始终使用对象而不是多维数组：

```
ArrayObject(
   MyObject(something, something_else))
   ...
   MyObject(something100, something_else100))
) 
```

并应用自定义比较器接口和函数来排序和查找它们：

```
interface Comparable {
   public function compareTo(Comparable $o);
}

class MyObject implements Comparable {
   public function compareTo(Comparable $o){
      ...
   }
}

function myComp(Comparable $a, Comparable $b){
    return $a->compareTo($b);
} 
```

您可以使用`uasort()`自定义比较器，如果您喜欢冒险，您应该为可以排序和管理它们的对象实现自己的集合（我总是扩展 ArrayObject 以至少包含搜索功能）。

```
$arrayObj->uasort("myComp"); 
```

一旦它们被排序（uasort 是 O(n log n)，这与它可以处理任意数据一样好），二进制搜索可以在 O(log n) 时间内完成操作，即一百万个条目只需要大约 20 次迭代搜索。据我所知，自定义比较器二进制搜索没有在 PHP 中实现（`array_search()`使用自然排序，它适用于对象引用而不是它们的属性），你必须像我一样自己实现这个。

这种方法更有效（不再有深度）并且更重要的是通用（假设您使用接口强制可比性），因为对象定义了它们的排序方式，因此您可以无限循环代码。好多了=）

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2012-01-25T15:23:11.667

```
$result = array_filter($arr, function ($var) {   
  $found = false;
  array_walk_recursive($var, function ($item, $key) use (&$found) {  
    $found = $found || $key == "name" && $item == "cat 1";
  });
  return $found;
}); 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-03-25T01:42:43.007

[http://snipplr.com/view/51108/nested-array-search-by-value-or-key/](http://snipplr.com/view/51108/nested-array-search-by-value-or-key/)

```
<?php

//PHP 5.3

function searchNestedArray(array $array, $search, $mode = 'value') {

    foreach (new RecursiveIteratorIterator(new RecursiveArrayIterator($array)) as $key => $value) {
        if ($search === ${${"mode"}})
            return true;
    }
    return false;
}

$data = array(
    array('abc', 'ddd'),
    'ccc',
    'bbb',
    array('aaa', array('yyy', 'mp' => 555))
);

var_dump(searchNestedArray($data, 555)); 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2011-05-23T05:37:37.907

```
function in_multi_array($needle, $key, $haystack) 
{
    $in_multi_array = false;
    if (in_array($needle, $haystack))
    {
        $in_multi_array = true; 
    }else 
    {
       foreach( $haystack as $key1 => $val )
       {
           if(is_array($val)) 
           {
               if($this->in_multi_array($needle, $key, $val)) 
               {
                   $in_multi_array = true;
                   break;
               }
           }
        }
    }

    return $in_multi_array;
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-04-09T11:05:28.243

我需要类似的东西，但要按值搜索多维数组......我以约翰为例并写了

```
function _search_array_by_value($array, $value) {
        $results = array();
        if (is_array($array)) {
            $found = array_search($value,$array);
            if ($found) {
                $results[] = $found;
            }
            foreach ($array as $subarray)
                $results = array_merge($results, $this->_search_array_by_value($subarray, $value));
        }
        return $results;
    } 
```

我希望它可以帮助某人:)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2012-02-09T17:14:46.507

这是 John K. 发布的函数的修改后的函数......我只需要获取数组中的特定键，而不需要在其上方获取任何内容。

```
function search_array ( $array, $key, $value )
{
    $results = array();

    if ( is_array($array) )
    {
        if ( $array[$key] == $value )
        {
            $results[] = $array;
        } else {
            foreach ($array as $subarray) 
                $results = array_merge( $results, $this->search_array($subarray, $key, $value) );
        }
    }

    return $results;
}

$arr = array(0 => array(id=>1,name=>"cat 1"),
       1 => array(id=>2,name=>"cat 2"),
       2 => array(id=>3,name=>"cat 1"));

print_r(search_array($arr, 'name', 'cat 1')); 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2017-05-08T09:30:17.280

```
function findKey($tab, $key){
    foreach($tab as $k => $value){ 
        if($k==$key) return $value; 
        if(is_array($value)){ 
            $find = findKey($value, $key);
            if($find) return $find;
        }
    }
    return null;
} 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2021-01-04T06:23:10.613

如果你知道你的密钥，我认为最简单的方法是使用 php 数组函数。

```
function search_array ( $array, $key, $value )
{
   return array_search($value,array_column($array,$key));
} 
```

这将返回一个索引，您可以通过以下方式找到所需的数据：

```
$arr = array(0 => array('id' => 1, 'name' => "cat 1"),
  1 => array('id' => 2, 'name' => "cat 2"),
  2 => array('id' => 3, 'name' => "cat 1")
);

echo json_encode($arr[search_array($arr,'name','cat 2')]); 
```

此输出将：

```
{"id":2,"name":"cat 2"} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2011-09-22T00:31:58.810

另一个版本从找到值的数组元素中返回键值（无递归，针对速度进行了优化）：

```
// if the array is 
$arr['apples'] = array('id' => 1);
$arr['oranges'] = array('id' => 2);

//then 
print_r(search_array($arr, 'id', 2);
// returns Array ( [oranges] => Array ( [id] => 2 ) ) 
// instead of Array ( [0] => Array ( [id] => 2 ) )

// search array for specific key = value
function search_array($array, $key, $value) {
  $return = array();   
  foreach ($array as $k=>$subarray){  
    if (isset($subarray[$key]) && $subarray[$key] == $value) {
      $return[$k] = $subarray;
      return $return;
    } 
  }
} 
```

感谢所有在这里发帖的人。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-03-05T13:35:12.257

如果您想搜索键数组，这很好

```
function searchKeysInMultiDimensionalArray($array, $keys)
{
    $results = array();

    if (is_array($array)) {
        $resultArray = array_intersect_key($array, array_flip($keys));
        if (!empty($resultArray)) {
            $results[] = $resultArray;
        }

        foreach ($array as $subarray) {
            $results = array_merge($results, searchKeysInMultiDimensionalArray($subarray, $keys));
        }
    }

    return $results;
} 
```

键不会覆盖，因为每组键 => 值将在结果数组中的单独数组中。
如果您不想要重复的密钥，请使用此密钥

```
function searchKeysInMultiDimensionalArray($array, $keys)
{
    $results = array();

    if (is_array($array)) {
        $resultArray = array_intersect_key($array, array_flip($keys));
        if (!empty($resultArray)) {
            foreach($resultArray as $key => $single) {

                $results[$key] = $single;
            }
        }

        foreach ($array as $subarray) {
            $results = array_merge($results, searchKeysInMultiDimensionalArray($subarray, $keys));
        }
    }

    return $results;
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2022-01-27T13:44:56.023

2个函数：`array_search_key_value`它返回键数组以到达具有多维数组中的值的键，`array_extract_keys`它返回键数组指向的多维数组中的值。

```
function array_search_key_value($array, $key, $value) {
    if (!is_array($array)) {
        return false;
    }

    return array_search_key_value_aux($array, $key, $value);
}

function array_search_key_value_aux($array, $key, $value, $path=null) {
    if (array_key_exists($key, $array) && $array[$key] === $value) {
        $path[]=$key;

        return $path;
    }

    foreach ($array as $k => $v ) {
        if (is_array($v)) {
            $path[]=$k;

            $p = array_search_key_value_aux($v, $key, $value, $path);

            if ($p !== false) {
                return $p;
            }
        }
    }

    return false;
}

function array_extract_keys($array, $key_list) {
    $v = $array;

    foreach ($key_list as $key) {
        if (!is_array($v) || !array_key_exists($key, $v))
            return false;

        $v = &$v[$key];
    } 

    return $v;
} 
```

这是一个单一的测试：

```
$test_array = array(
    'a' => array(
        'aa' => true,
        'ab' => array(
            'aaa' => array(
                'one' => 1,
                'two' => 2,
                'three' => 3,
                'four' => 4
            ),
            'four' => 4,
            'five' => 5,
        ),
        'six' => 6,
    ),
    'seven' => 7
);

$test_data = array(
    array('one', 1),
    array('two', 2),
    array('three', 3),
    array('four', 4),
    array('five', 5),
    array('six', 6),
    array('seven', 7),
    array('zero', 0),
    array('one', 0),
);

foreach ($test_data as $d) {
    $r = array_search_key_value($test_array, $d[0], $d[1]);

    echo $d[0] . ' => ' . $d[1] . ' ? ', $r ? implode('/', $r) . ' => ' . array_extract_keys($test_array, $r) : 'null', PHP_EOL;
} 
```

# javascript - 如何在 ie8 中使用包含函数的值设置 OnClick 属性？

> ID：1019078
> 
> 赞同：32
> 
> 时间：2009-06-19T17:20:19.920
> 
> 标签：javascript, onclick, setattribute

我的目标是更改`onclick`链接的属性。我可以成功，但生成的链接在 ie8 中不起作用。它确实适用于ff3。

例如，这适用于 Firefox 3，但不适用于 IE8。为什么？

```
<p><a id="bar" href="#" onclick="temp()">click me</a></p>

<script>
    doIt = function() {
        alert('hello world!');
    }
    foo = document.getElementById("bar");
    foo.setAttribute("onclick","javascript:doIt();");
</script> 
```

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-06-19T17:26:20.430

您不需要为此使用 setAttribute - 此代码有效（IE8 也是）

```
<div id="something" >Hello</div>
<script type="text/javascript" >
    (function() {
        document.getElementById("something").onclick = function() { 
            alert('hello'); 
        };
    })();
</script> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-19T17:24:48.433

你最好的选择是使用像 jquery 或原型这样的 javascript 框架，但是，如果失败了，你应该使用：

```
if (foo.addEventListener) 
    foo.addEventListener('click',doit,false); //everything else    
else if (foo.attachEvent)
    foo.attachEvent('onclick',doit);  //IE only 
```

编辑：

另外，你的功能有点偏离。它应该是

```
var doit = function(){
    alert('hello world!');
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-09-21T00:49:18.217

您还可以设置 onclick 来调用您的函数，如下所示：

```
foo.onclick = function() { callYourJSFunction(arg1, arg2); }; 
```

这样，您也可以传递参数。......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-02-27T07:10:46.880

您还可以使用：

```
element.addEventListener("click", function(){
    // call execute function here...
}, false); 
```

# .net - 如何在 .NET 中模拟打印机？

> ID：1019079
> 
> 赞同：6
> 
> 时间：2009-06-19T17:20:25.863
> 
> 标签：.net, mocking

我有一个将许多 PDF 发送到打印机的应用程序。有没有人有过创建代表本地打印机的 Mock 对象的经验？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-19T17:34:34.520

不完全确定您要做什么，但这可能会有所帮助。

为了模拟打印机（或任何其他外部设备），您应该将所有对打印机的调用封装在接口后面，例如

```
interface IPrinter 
{
   void Print(PrintData data);
} 
```

然后，您的所有其他代码必须通过此接口与打印机通信。

然后，您可以实现一个与真实打印机对话的接口版本，以及一个您可以在测试时使用的假对象等。

[使用Rhino Mocks](http://ayende.com/projects/rhino-mocks.aspx)或[Moq](http://code.google.com/p/moq/)等模拟框架可以轻松模拟假对象，或者您可以自己实现一个假对象。

```
public class FakePrinter : IPrinter
{
   public void Print(PrintData data)
   {
      // Write to output window or something
   }
} 
```

**更新：**

所有使用打印机的类都将如下所示：

```
public class ClassThatPrints
{
   private IPrinter _Printer;

   // Constructor used in production
   public ClassThatPrints() : this(new RealPrinter())
   {
   }

   // Constructor used when testing
   public ClassThatPrints(IPrinter printer)
   {
      _Printer = printer;
   }

   public void MethodThatPrints()
   {
      ...
      _Printer.Print(printData)
   }
} 
```

顺便说一句，如果您使用 IoC 容器，那么您不需要第一个构造函数。然后使用 IoC 工具注入打印机类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T17:24:20.900

您可以随时暂停打印机进行打印。

您可以使用写入文件的打印机设备。

您可以编写自己的打印设备。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T17:39:54.203

另一种解决方案是为自己编写一个 LPD 应用程序或简单地监视端口 9100，并让 Windows 打印队列将数据路由到 9100 或 515 (LPD) 上的“自身”。

# c - 如何划分大数？

> ID：1019083
> 
> 赞同：3
> 
> 时间：2009-06-19T17:21:16.130
> 
> 标签：c, largenumber

我有一个大数字（整数，无符号）存储在 2 个变量中（如您所见，数字的高位和低位部分）：

```
unsigned long long int high;
unsigned long long int low; 
```

我知道如何添加或减去其他一些此类变量。

但我需要除以那种数字。怎么做？我知道，我可以减去 N 次，但是，也许，还有更多更好的解决方案。;-)

语言：C

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T18:08:00.560

是的。这将涉及转换，我不建议在 C 中这样做。这是汇编程序仍然可以证明其价值的罕见示例之一，很容易使事情运行速度提高数百倍（而且我不认为我在夸大其词这个。）

我并没有声称完全正确，但以下内容应该可以帮助您：

(1) 将结果初始化为零。

(2) 将除数尽可能多地向左移动，不要让它变得大于被除数。

(3) 从被除数中减去移位的除数，结果加一。

(4) 现在将除数右移一次，直到它小于剩余的被除数，并且对于每个右移，将结果左移一位。除非满足停止条件，否则返回 (3)。（停止条件必须是“除数为零”，但我不确定。）

回到一些真正的编程问题真的很棒:-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T18:00:08.310

> 我知道，我可以减去 N 次，但是，也许，还有更多更好的解决方案。

当 N 很大时，减 N 次可能会很慢。

更好（即更复杂但更快）将是移位和减法，使用您在小学学习的算法对十进制数进行[长除法。](http://en.wikipedia.org/wiki/Long_division)

[也可能有对此类数字的 3rd-party 库和/或特定于编译器的支持。]

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T17:28:04.153

您是否查看过任何大型库，例如[GNU MP BigNum](http://gmplib.org/)？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T18:13:42.813

您可以实现对字符串数组进行除法的“BigInt”类型算法。为每个高低对创建 1 个字符串数组并进行除法。将结果存储在另一个字符串数组中，然后转换回高、低整数对。

由于语言是 C，因此数组可能是字符数组。考虑它类似于我上面提到的“字符串数组”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T18:19:32.040

您可以使用汇编程序循环和“带进位 (adc/sbb) 的加/减”指令对任意大的二进制对象进行加减运算。您可以使用它们实现其他操作。我从来没有调查过除了这两个之外的任何事情。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T18:30:29.073

如果您的处理器（或您的 C 库）具有快速的 64 位除法，则可以将 128 位除法分解为多个部分（与在具有 16 位除法的处理器上进行 32 位除法相同的方式）。

顺便说一句，如果您知道被除数和除数的典型值，您可以使用各种技巧。这些数字的来源是什么？如果你的很多案子都能很快解决，偶尔的案子可能需要很长时间。

此外，如果你能找到一个近似答案是可以的情况，这就为许多快速近似打开了大门。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-19T17:28:13.780

唔。我想如果你有一些“高”的空间，你可以把它全部上移一位，除以数字，然后将余数加到低位剩余的顶部数字，然后除以数字，然后将所有内容移回。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-19T17:28:24.153

根据我下面的评论者，我之前的回答很愚蠢。

很快，我的新答案是，当我过去尝试这样做时，它几乎总是涉及移位，因为它是唯一可以应用于多个“单词”的操作，如果你愿意的话，让它看起来就好像它是一个大字一样（除了必须跟踪结转位）。

有几种不同的方法，但我不知道有什么比使用轮班更好的大方向，除非你的硬件有一些特殊的操作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-19T17:38:50.240

这是另一个做 128 位算术的库。 [GnuCash：Math128](http://svn.gnucash.org/docs/HEAD/group__Math128.html)。

# asp.net - 如何在正确的情况下获取 WebResource.axd 查询字符串？

> ID：1019087
> 
> 赞同：2
> 
> 时间：2009-06-19T17:22:30.823
> 
> 标签：asp.net, query-string, webresource.axd

我正在获取用于缩小和压缩的 css 文件，这些文件适用`QueryString["path"]`于我自己的 css 文件（如 main.css）。但是当我尝试访问网络资源文件时，我收到 500 错误。webresource.axd 之后的参数区分大小写，我从小写接收它`QueryString["path"]`。

这就是我从中得到的`QueryString["path"]`：

```
http://localhost/test/webresource.axd?d=-phgrn6r6zgehvbi697-bxvkl_gidnplxpdeukz5kncgr9hvnfvttpgykwyw05cda-nymtz9od_bbww3ynzxha2&t=633789305460522066 
```

上面的链接生成错误： CryptographicException: Padding is invalid and cannot be removed。

这是正确链接的样子：

```
http://localhost/test/WebResource.axd?d=-pHGRn6r6ZGehvBI697-BxVKl_GIdNPlxPdEUKZ5KNcGR9hvnfVtTpgyKwYw05cDa-NymTz9OD_bBwW3ynZXhA2&t=633789305460522066 
```

唯一的区别在于情况。CryptographicException 似乎很常见，但即使设置 machineKey 也不能解决问题。关于如何在原始案例中获得 webresource.axd 的任何提示？

**编辑**

要求代码：

```
public void ProcessRequest(HttpContext context) {
    Control c = new Control();
    string root = context.Request.Url.GetLeftPart(UriPartial.Authority);
    string path = context.Request.QueryString["path"];
    string content = string.Empty;

    if (!string.IsNullOrEmpty(path)) {
        if (context.Cache[path] == null) {
            List<string> dependencies = new List<string>();
            string[] styles = path.Split(new string[] { "," }, StringSplitOptions.RemoveEmptyEntries);
            foreach (string style in styles) {
                content += RetrieveStyle(root + c.ResolveUrl(style)) + Environment.NewLine;
                dependencies.Add(context.Server.MapPath(style));
            }
            content = StripWhitespace(content);
            context.Cache.Insert(path, content, new CacheDependency(dependencies.ToArray()), Cache.NoAbsoluteExpiration, new TimeSpan(DAYS_IN_CACHE, 0, 0, 0));
        }
    }
} 
```

当我打电话时它在 RetriveStyle 崩溃：

```
using (HttpWebResponse response = (HttpWebResponse)request.GetResponse()) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-06T23:34:19.153

罪魁祸首看起来像是生成“路径”查询字符串 csv 的代码或该源和处理程序之间的某些硬件或过滤器。

如果处理程序请求的来源是浏览器，则处理程序 url 通过查看源或 firebug 看起来像什么？已经小写了吗？

从那开始，您是否在 IIS 管道中注册了任何模块等？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-14T18:43:25.087

我没有答案，但我们遇到了类似的问题，我有几件事要补充，这可能有助于确定问题。所以，这里是：

我们有一个 iHTTPHandler（我们称之为 Login.ashx），它接受一个 GET 请求，其中包含一个 base64 格式的令牌。然后使用 Rijndael 算法对令牌进行解密。

这个过程大部分时间都在工作，但是，在上个月，我们有几个请求由于**System.Security.Cryptography.CryptographicException 失败：填充无效并且无法删除。**错误。当令牌（base64 字符串）为小写且无法解密时，在我们的示例中会引发此错误。

在查看日志和活动记录后，我可以看到特定用户会尝试通过 Login.ashx 来到我们这边，并且由于相关错误，请求将失败。请求的整个查询字符串（不仅仅是令牌）包括名称和值都是小写的。然后，同一用户会在几分钟后尝试登录，并且能够登录，因为查询字符串没有转换为小写。

所以，我觉得这个问题可能与浏览器有关。我不确定代理是否会影响这一点。

**附加信息：** 服务器变量中没有捕获浏览器信息。ALL_HTTP 和 ALL_RAW 变量几乎没有数据：

*   **ALL_HTTP** HTTP_CACHE_CONTROL：无缓存 HTTP_HOST：我们的服务器名称
*   **ALL_RAW** Cache-Control: no-cache Host: 我们的服务器名称

也没有 HTTP_REFFERER。

我试图用不同的浏览器（Safari3、Chrome1、Opera9.2、IE6、7、8、Firefox3）复制这个问题，但没有成功。

我们有一个配置相同的 10 台服务器的网络农场（至少我希望它们是）

如果我有任何进展，我会添加更多信息。

# sharepoint - VSeWSS“附加到 IIS 工作进程”灰显

> ID：1019091
> 
> 赞同：0
> 
> 时间：2009-06-19T17:23:26.453
> 
> 标签：sharepoint, vsewss

这是来自[msdn 论坛](http://social.msdn.microsoft.com/Forums/en-US/sharepointdevelopment/thread/f4e47c06-2c3e-4dd2-9591-f6195ae52732 "这里")的转贴，没有得到好的结果。

在 VS 2008 上的 VSeWSS 1.3 中，“附加到 IIS 工作进程”似乎总是灰显（构建 -> 快速部署解决方案）。

这迫使我从命令行运行 iisapp，记下我的 w3wp 进程的 PID，在 VS 中按 Ctrl-Alt-P 以打开“附加到进程”对话框，按 PID 排序，找到我之前获得的 PID，然后单击“确定” .

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T20:58:13.643

为了使“附加到工作进程”不灰显，我必须在解决方案资源管理器中选择项目节点。（这是此解决方案中的唯一项目。）如果我选择子文件夹或文件，该选项将显示为灰色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T17:34:01.963

出于某种原因，当我运行多个 w3wp 实例时遇到了同样的问题（如果您将 Central Admin 和 SSP 托管在单独的应用程序池中，显然会出现这种情况。）我建议只关闭所有 w3wp 进程没有执行您尝试调试的代码；关闭 VS，重置 IIS，打开 VS 并重试。

# objective-c - 以编程方式唤醒 Mac

> ID：1019094
> 
> 赞同：2
> 
> 时间：2009-06-19T17:24:04.440
> 
> 标签：objective-c, cocoa, macos

我想为 Mac 编写一个自定义警报，将 Mac 从睡眠中唤醒。我认为应该像[Aurora 应用程序](http://metaquark.de/aurora/)那样做。

我需要使用哪些方法/类？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T17:57:53.337

pmset 可以做你需要的，你只需要在它进入睡眠之前设置你的设置

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-22T14:51:20.280

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T17:41:52.640

您的应用程序可以让 mac 休眠并要求它在特定时间醒来，请查看文档中的[Power Manager](http://developer.apple.com/documentation/Carbon/Reference/Power_Manager/Reference/reference.html)。

> 设置定时器以在未来某个时间唤醒计算机

# jquery - 这个 jQuery slideToggle 函数有什么问题？

> ID：1019095
> 
> 赞同：2
> 
> 时间：2009-06-19T17:24:18.433
> 
> 标签：jquery

我有一个票务管理程序，我正在尝试将“手风琴”风格的功能添加到使用 jQuery 中。这个程序是用 PHP 编写的。输出 HTML 如下所示：

```
<div class="eachticketwrapper">
     <div class="simpleticketview">
           <ul class="displayinline ticketsummarybar">
                    <li class="col0"><a href="#" class="toggleLink">E</a></li>
                       //...
           </ul>
      </div> <!-- simpleticketview -->
<br class="clear" />
<div class="toggle"> <!-- hiddenticketview -->
     //...
</div> 
```

这在一个页面上重复了几十次。

我的 jQuery 代码如下所示：

```
$(document).ready(function() {
   $('div.toggle').hide();
   $('.toggleLink').click(function() {
        $(this).next('div.toggle').slideToggle('fast');
   return false;
   });
}); 
```

当我单击 E 时，它不会滑动下一个 div。事实上什么也没发生。

我曾尝试使用： $('div.toggle').slideToggle('slow');

这会导致所有 div 切换。但我需要它来定位下一个 div。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T17:27:51.393

你需要给你的'toggle' div 一个唯一的 id 并将它与你的链接 id 匹配。然后定位那些ID：

```
<div class="eachticketwrapper">     
    <div class="simpleticketview">           
        <ul class="displayinline ticketsummarybar">
                <li class="col0"><a href="#" id="link-1234" class="toggleLink">E</a></li>
                   //...           </ul>
  </div> <!-- simpleticketview -->
  <br class="clear" />
  <div id="ticket-1234" class="toggle"> <!-- hiddenticketview -->     
   //...
  </div> 
```

jQuery：

```
$(document).ready(function() { 
    $('div.toggle').hide(); 
    $('.toggleLink').click(function() { 
        var id = $(this).attr("id").split("-");
        $("#ticket-" + id[1]).slideToggle('fast'); return false; 
    }); 
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T19:08:37.433

您可以在没有 id 的情况下获取 div，但这会有点复杂：

```
$(this).parents().find("div.eachticketwrapper").nextAll().find("div.toggle:first") 
```

这取决于文档的结构。如果您有多个 eachticketwrapper 元素，则可能需要对其进行调整。最好使用 id。

# iphone - UIViewController 实例化的第二个实例，失去了在原始上完成的初始化。为什么？

> ID：1019099
> 
> 赞同：0
> 
> 时间：2009-06-19T17:25:19.820
> 
> 标签：iphone

我对以下代码有问题。你可以创建一个 TripDetailsController（UIViewController 的子类），并使用 initWithNibName 方法对其进行初始化。这个 initWithNibName 需要一个额外的参数（tripDetails），请参见下面的 TripDetailsController 类的代码。变量 td 有一个值，在单步执行代码时，我检查了在执行 initWithNibName 方法时该值是否设置在 tdController 上。但是，当在 TripDetailsController.viewDidLoad 方法（调用 pushViewController() 时执行）中设置断点时，TripDetailsController 的 tripDetails 属性为零？！? 使用调试器我发现我在 initWithNibName 方法中看到的 tdController 实例与我在 viewDidLoad 方法中看到的实例不同？怎么来的？为什么会有一个 TripDetailsController 的新实例以及由谁创建？

在这篇文章的最后，我包含了一个调用堆栈的转储，也许这会给你一个关于这个问题的原因的提示。

代码：

```
// Code from RootViewController.getTripDetails() (see stacktrace below)
TripDetails td = ...;   // td has a value
// Push the detail view controller
TripDetailsController *tdController = [[TripDetailsController alloc] initWithNibName:@"TripDetailsController" bundle:nil tripDetails:td];

             // Checked using the debugger that tdController.tripDetails is set

[self.navigationController pushViewController:tdController animated:YES];
[tdController release]; 
```

代码：

```
@implementation TripDetailsController

@synthesize tripDetails, expectedDurationLabel, normalDurationLabel;

- (void)viewDidLoad {
  [super viewDidLoad];
  self.navigationItem.title = @"Reis Details";  
  expectedDurationLabel.text = [NSString stringWithFormat:@"%@", tripDetails.expectedDuration];
}

- (id)initWithNibName:(NSString *)nibName bundle:(NSBundle *)nibBundle tripDetails:(TripDetails *)td {
  self = [self initWithNibName:nibName bundle:nibBundle];
  self.tripDetails = td;    // self.tripDetails has a value here!
  [self.tripDetails retain];
  return self;
}

- (void)dealloc {
  [self.tripDetails release];
  [super dealloc];
}
@end 
```

[替代文字 http://gerodt.homeip.net/stack.png](http://gerodt.homeip.net/stack.png)

欢迎任何建议。

下吕

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-21T19:48:18.337

[通过遵循 Apple 的SimpleDrillDown 示例](https://developer.apple.com/iphone/library/samplecode/SimpleDrillDown/index.html)中的示例代码，我找到了一种让它工作的方法。

与我的原始代码的主要区别：

*   TripDetailsController 不再在 .xib 文件中定义
*   TripDetailsController 不再从 .xib 文件中加载，而是初始化如下：

代码：

```
TripDetailsController *tdController = 
    [[TripDetailsController alloc] initWithStyle:UITableViewStyleGrouped]; 
```

*   TripDetailsController 不再是 UIViewController，而是 UITableViewController 的子类

结果我不得不稍微调整一下布局，但至少现在可以了。

看起来好像不可能从 XIB 文件初始化视图控制器，然后将其推送到导航控制器。

下吕

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T17:57:06.520

您应该发布调用`initWithNibName:bundle:`.

我的预感是您正在以编程方式创建一个，但实际使用的那个是在 NIB 文件中创建的。也许您的主视图 NIB 创建了一个 TripDetailsController 作为选项卡视图或导航根。在这种情况下，`initWithCoder:`被调用而不是`initWithNibName:bundle:`，这将解释未初始化的`td`ivar。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T17:50:37.043

听起来您没有保留 tripDetails 对象，因此在您尝试使用之前它已被释放。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T22:00:51.563

等等，我以前看过这个：

不要制作自定义初始化程序，而是使用标准初始化程序并尝试以下操作：

```
TripDetails td = ...;   // td has a value
TripDetailsController *tdController = [[TripDetailsController alloc] initWithNibName:@"TripDetailsController" bundle:[NSBundle mainBundle]];
[tdController setTripDetails:td]

[self.navigationController pushViewController:tdController animated:YES];
[tdController release]; 
```

* * *

原答案：在TripDetailsController接口中，thipDetails属性是否设置为retain？（而不是分配）。

# c# - 在单独的类中订阅事件

> ID：1019105
> 
> 赞同：2
> 
> 时间：2009-06-19T17:26:48.087
> 
> 标签：c#, events, subscription

我在订阅我创建的活动时遇到了一些麻烦。事件本身在它自己的类中，我希望能够从单独项目中的单独类订阅它。我可以从创建它的类中订阅它 - 但是当我尝试从不同项目中的不同类订阅时，什么也没有发生。

有人可以给我一些关于如何解决这个问题的建议吗？我一直在谷歌试图找到一个解决方案，但无济于事:(。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T17:31:20.873

这是我创建并订阅的事件的一个简单示例：

```
using System;

class Program
{
    static void Main()
    {
        Foo foo = new Foo();
        foo.Fooing += () => Console.WriteLine("Foo foo'd");

        foo.PleaseRaiseFoo();
    }
}

class Foo
{
    public event Action Fooing;

    protected void OnFooing()
    {
        if (this.Fooing != null)
            this.Fooing();
    }

    public void PleaseRaiseFoo()
    {
        this.OnFooing();
    }
} 
```

希望这应该能够为您指明正确的方向。检查代码的主要内容：

*   您的活动是否标记为公开？
*   你有没有提出这个事件？（例如`this.Fooing()`）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T17:43:10.737

我刚刚使用 EventHandler 委托而不是 Action 尝试了您的示例代码（因为我在 System 命名空间中找不到非泛型 Action 委托）

下面的代码正如你所期望的那样工作：它输出“Foo foo'd”。

也许是 Action 代表，尽管我觉得这有点奇怪。

```
class Program
{
    static void Main()
    {
        Foo foo = new Foo();
        foo.Fooing += (object o, EventArgs e) => Console.WriteLine("Foo foo'd");

        foo.PleaseRaiseFoo();
    }
}

class Foo
{
    public event EventHandler Fooing;

    protected void OnFooing()
    {
        if (this.Fooing != null)
            this.Fooing(null, null);
    }

    public void PleaseRaiseFoo()
    {
        this.OnFooing();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T18:03:20.270

您注意到您的班级在不同的项目中，您能看到事件班级（或该项目中的任何其他班级）吗？也许您没有正确引用您的其他项目。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T17:32:07.177

你试过这个吗？

```
MyInstanceOfMyClass.MyEvent += new EventHandler(MyDelegate);
protected void MyDelegate(object sender, EventArgs e) { ... } 
```

# ffmpeg - 人们可以推荐哪些转码服务？

> ID：1019109
> 
> 赞同：7
> 
> 时间：2009-06-19T17:27:24.937
> 
> 标签：ffmpeg, flv, transcoding

我的一个客户需要接受一堆不同的视频文件并将它们转换为 FLV。我在以前的项目中使用 FFMEG 的经验表明，会有一些麻烦的文件。

根据我的客户将为专业服务支付的价格。

人们在使用什么以及您如何找到服务？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-07-06T21:53:06.520

<biased answer alert> 我推荐 Zencoder ( [http://zencoder.com](http://zencoder.com) )，它是由构建 Flix Cloud ( [http://flixcloud.com](http://flixcloud.com) ) 的同一个人构建的。我们在处理麻烦的文件方面投入了大量工作，并且我们可以支持比任何人都更广泛的输入文件。我们也是市场上最快的服务，并且拥有（我们认为）对开发人员非常友好的 API。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-10-29T16:46:55.077

我无法给出任何建议，因为我正在寻找一种服务来为自己的许多客户实施。但是，也许我可以帮助其他也在寻找的人。

似乎有几种类型的服务：

*   编码
    *   [Zencoder](http://zencoder.com)
    *   [编码网](http://encoding.com)
    *   [熊猫流](http://www.pandastream.com)
    *   [安科德](http://www.ankoder.com)
    *   [嘿看](http://heywatch.com)
*   编码、托管和视频播放器
    *   [奥亚拉](http://www.ooyala.com/)
    *   [明洞](http://www.brightcove.com)
    *   [23 视频](http://www.23video.com)

在查看这些服务时，需要考虑以下几点：

*   API 支持的功能
    *   进度调用、编码完整 ping、作业跟踪、输出格式
    *   XML 或 JSON 或两者兼有
    *   身份验证技术（oauth 等）
*   直接客户端上传（没有代理到您的服务器）
*   完整视频的存储
    *   临时存储、FTP 到您的服务器、Amazon S3
    *   每种格式的直接（如果托管）网址的可用性
*   编码格式
    *   所有 HTML 5 格式（mp4 h264、ogg 等）
    *   移动编码支持（android 的特殊设置）
*   支持
    *   服务水平协议？
    *   电话/电子邮件/交时间？
*   成本（许多不同的付款类型）
    *   视频时间
    *   输出数量和时间
    *   文件大小（输入/输出）
    *   量大优惠

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-28T15:01:58.830

encoding.com 非常好而且便宜。我使用它们将上传的用户文件转换为 FLV。之后 encoding.com 可以通过“ping”请求将文件上传到 AWS S3 或您的 FTP 账户。自动化应该足够了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-29T20:40:24.850

在为此寻找供应商时，我与该领域的主要公司进行了广泛的测试——Encoding.com、Zencoder、Ankoder 和 Heywatch。

我发现 Heywatch 和 Ankoder 不太值得推荐。Encoding.com 是我开始搜索的第一选择（作为一种预感），他们的服务表现非常好，他们的文档也很充足。

Zencoder 对我来说是明显的赢家，也是我们决定采用的。他们有出色的文档和干净的 API。每当出现问题时，他们都会快速处理问题。我会向任何正在寻找转码的人推荐它们，并且由于它们现在是 Brightcove ($$) 的一部分，我只看到服务变得越来越强大。

注意：我不隶属于任何这些公司，并认为我的回答相对公正。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-23T21:46:54.790

我目前也在寻找这方面的服务，

[刚刚从这个问题](https://stackoverflow.com/questions/404322/programmatically-transcode-mpeg-2-videos)的答案中找到 encoding.com

我也一直在关注 CDN，因为我还需要确保视频不会压倒我的服务器，不确定，但我认为其中一些表示包括转码在内的全方位服务媒体。如果您也需要 CDN 来传送视频，它可能会附带转码。

现在我开始研究服务器的东西，也许这个话题应该转移到服务器故障上？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-20T11:29:34.723

flixcloud.com 来自 on2 vp6 编解码器的制造商，质量非常好。我更喜欢 encoding.com，因为他们不收取月费。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-29T12:05:45.720

作为联合创始人，我有偏见，但[Transloadit](http://transloadit.com)也提供客户端集成。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-04-27T09:51:22.390

别忘了[BitsOnTheRun](http://www.bitsontherun.com)，他们提供优质的服务和合理的价格。

# linux - 使用 ls 列出目录及其总大小

> ID：1019116
> 
> 赞同：1020
> 
> 时间：2009-06-19T17:29:00.347
> 
> 标签：linux, unix

是否可以`ls`在 Unix 中使用列出子目录的总大小及其所有内容，而不是通常`4K`（我假设）只是目录文件本身？

```
total 12K
drwxrwxr-x  6 *** *** 4.0K 2009-06-19 10:10 branches
drwxrwxr-x 13 *** *** 4.0K 2009-06-19 10:52 tags
drwxrwxr-x 16 *** *** 4.0K 2009-06-19 10:02 trunk 
```

在搜索了手册页之后，我发现我是空的。

* * *

## 回答 #1

> 赞同：1860
> 
> 时间：2009-06-19T17:30:36.117

尝试类似：

```
du -sh * 
```

短版：

```
du --summarize --human-readable * 
```

### 解释：

`du`:磁盘**U** **sage** _

 **`-s`：显示每个指定文件的摘要。（相当于`-d 0`）

`-h`：“人类可读”输出。使用单位后缀：字节、千字节 (KiB)、**兆字节 (** **MiB** )、千兆字节 ( **GiB** )、千字节 ( **TiB** ) 和**千字节 (** **PiB** )。(基础2)

 ******* * *

## 回答 #2

> 赞同：397
> 
> 时间：2013-04-09T08:50:40.580

`du -sk * | sort -n`将按大小对文件夹进行排序。在寻找清理空间时很有帮助..

或`du -sh * | sort -h`在人类可读模式下使用

* * *

## 回答 #3

> 赞同：139
> 
> 时间：2013-11-08T17:16:28.153

```
du -sh * | sort -h 
```

这将以人类可读的格式显示。

* * *

## 回答 #4

> 赞同：66
> 
> 时间：2015-08-16T22:36:15.137

以人类可读的格式列出当前目录中最大的目录：

`du -sh * | sort -hr`

限制行数的更好方法是

`du -sh * | sort -hr | head -n10`

哪里可以增加`-n`flag的后缀来限制列出的行数

样本：

```
[~]$ du -sh * | sort -hr
48M app
11M lib
6.7M    Vendor
1.1M    composer.phar
488K    phpcs.phar
488K    phpcbf.phar
72K doc
16K nbproject
8.0K    composer.lock
4.0K    README.md 
```

它使阅读更方便:)

* * *

## 回答 #5

> 赞同：33
> 
> 时间：2015-02-18T11:38:06.413

`ls -lh`要以格式显示它，请使用：

```
(du -sh ./*; ls -lh --color=no) | awk '{ if($1 == "total") {X = 1} else if (!X) {SIZES[$2] = $1} else { sub($5 "[ ]*", sprintf("%-7s ", SIZES["./" $9]), $0); print $0} }' 
```

awk 代码解释：

```
if($1 == "total") { // Set X when start of ls is detected
  X = 1 
} else if (!X) { // Until X is set, collect the sizes from `du`
  SIZES[$2] = $1
} else {
  // Replace the size on current current line (with alignment)
  sub($5 "[ ]*", sprintf("%-7s ", SIZES["./" $9]), $0); 
  print $0
} 
```

样本输出：

```
drwxr-xr-x 2 root     root 4.0K    Feb 12 16:43 cgi-bin
drwxrws--- 6 root     www  20M     Feb 18 11:07 document_root
drwxr-xr-x 3 root     root 1.3M    Feb 18 00:18 icons
drwxrwsr-x 2 localusr www  8.0K    Dec 27 01:23 passwd 
```

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2009-06-22T21:29:17.103

你想要的命令是 'du -sk' du = "disk usage"

-k 标志为您提供以千字节为单位的输出，而不是磁盘扇区（512 字节块）的 du 默认值。

-s 标志将仅列出顶级目录中的内容（即，默认情况下为当前目录，或在命令行中指定的目录）。奇怪的是 du 在这方面与 ls 有相反的行为。默认情况下 du 将递归地为您提供每个子目录的磁盘使用情况。相反， ls 只会列出指定目录中的文件。（ls -R 为您提供递归行为。）

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2016-06-25T20:42:08.613

将此 shell 函数声明放在 shell 初始化脚本中：

```
function duls {
    paste <( du -hs -- "$@" | cut -f1 ) <( ls -ld -- "$@" )
} 
```

我之所以调用它`duls`是因为它显示了两者的输出`du`和`ls`（按此顺序）：

```
$ duls
210M    drwxr-xr-x  21 kk  staff  714 Jun 15 09:32 .

$ duls *
 36K    -rw-r--r--   1 kk  staff    35147 Jun  9 16:03 COPYING
8.0K    -rw-r--r--   1 kk  staff     6962 Jun  9 16:03 INSTALL
 28K    -rw-r--r--   1 kk  staff    24816 Jun 10 13:26 Makefile
4.0K    -rw-r--r--   1 kk  staff       75 Jun  9 16:03 Makefile.am
 24K    -rw-r--r--   1 kk  staff    24473 Jun 10 13:26 Makefile.in
4.0K    -rw-r--r--   1 kk  staff     1689 Jun  9 16:03 README
120K    -rw-r--r--   1 kk  staff   121585 Jun 10 13:26 aclocal.m4
684K    drwxr-xr-x   7 kk  staff      238 Jun 10 13:26 autom4te.cache
128K    drwxr-xr-x   8 kk  staff      272 Jun  9 16:03 build
 60K    -rw-r--r--   1 kk  staff    60083 Jun 10 13:26 config.log
 36K    -rwxr-xr-x   1 kk  staff    34716 Jun 10 13:26 config.status
264K    -rwxr-xr-x   1 kk  staff   266637 Jun 10 13:26 configure
8.0K    -rw-r--r--   1 kk  staff     4280 Jun 10 13:25 configure.ac
7.0M    drwxr-xr-x   8 kk  staff      272 Jun 10 13:26 doc
2.3M    drwxr-xr-x  28 kk  staff      952 Jun 10 13:26 examples
6.2M    -rw-r--r--   1 kk  staff  6505797 Jun 15 09:32 mrbayes-3.2.7-dev.tar.gz
 11M    drwxr-xr-x  42 kk  staff     1428 Jun 10 13:26 src

$ duls doc
7.0M    drwxr-xr-x  8 kk  staff  272 Jun 10 13:26 doc

$ duls [bM]*
 28K    -rw-r--r--  1 kk  staff  24816 Jun 10 13:26 Makefile
4.0K    -rw-r--r--  1 kk  staff     75 Jun  9 16:03 Makefile.am
 24K    -rw-r--r--  1 kk  staff  24473 Jun 10 13:26 Makefile.in
128K    drwxr-xr-x  8 kk  staff    272 Jun  9 16:03 build 
```

解释：

该`paste`实用程序根据您提供的规范从其输入中创建列。给定两个输入文件，它将它们并排放置，并以制表符作为分隔符。

我们给它`du -hs -- "$@" | cut -f1`作为第一个文件的输出（实际上是输入流）和`ls -ld -- "$@"`作为第二个文件的输出。

在函数中，`"$@"`将评估所有命令行参数的列表，每个参数都用双引号引起来。因此，它将理解通配符和带有空格的路径名等。

双减号 ( ) 表示和`--`的命令行选项结束。没有这些，说会混淆，任何没有的选项都会混淆（并且两个实用程序中存在的选项可能不是同一件事，而且会很混乱）。`du``ls``duls -l``du``du``ls``ls`

`cut`after只是删除输出的`du`第一列`du -hs`（大小）。

我决定将`du`输出放在左侧，否则我将不得不管理一个不稳定的右列（由于文件名的长度不同）。

该命令将不接受命令行标志。

这已经在`bash`和 中进行了测试`ksh93`。它不适用于`/bin/sh`.

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2019-04-04T15:11:17.107

**`ncdu`（诅咒`du`）**

这个很棒的 CLI 实用程序允许您以交互方式轻松查找大文件和目录（递归总大小）。

例如，从[一个众所周知的开源项目](https://github.com/torvalds/linux/tree/v5.0)的根目录中，我们执行以下操作：

```
sudo apt install ncdu
ncdu 
```

结果是：

[![在此处输入图像描述](../Images/0caa886eab44d1ef83a8f1ffea7c2d06.png)](https://i.stack.imgur.com/lHXP3.png)

然后，我在键盘上向下和向右输入以进入`/drivers`文件夹，我看到：

[![在此处输入图像描述](../Images/3c5a8208971bf17d21dcccd2cf21eba2.png)](https://i.stack.imgur.com/nYonf.png)

`ncdu`仅在启动时为整个树递归计算一次文件大小，因此它很有效。

“总磁盘使用量”与“表观大小”类似`du`，我已经解释过：[为什么 `du` 的输出通常与 `du -b` 如此不同](https://stackoverflow.com/questions/5694741/why-is-the-output-of-du-often-so-different-from-du-b/55514003#55514003)

项目主页：[https ://dev.yorhel.nl/ncdu](https://dev.yorhel.nl/ncdu)

相关问题：

*   [https://unix.stackexchange.com/questions/67806/how-to-recursively-find-the-amount-stored-in-directory/67808](https://unix.stackexchange.com/questions/67806/how-to-recursively-find-the-amount-stored-in-directory/67808)
*   [https://unix.stackexchange.com/questions/125429/tracking-down-where-disk-space-has-gone-on-linux](https://unix.stackexchange.com/questions/125429/tracking-down-where-disk-space-has-gone-on-linux)
*   [https://askubuntu.com/questions/57603/how-to-list-recursive-file-sizes-of-files-and-directories-in-a-directory](https://askubuntu.com/questions/57603/how-to-list-recursive-file-sizes-of-files-and-directories-in-a-directory)
*   [https://serverfault.com/questions/43296/how-does-one-find-which-files-are-taking-up-80-of-the-space-on-a-linux-webserve](https://serverfault.com/questions/43296/how-does-one-find-which-files-are-taking-up-80-of-the-space-on-a-linux-webserve)

在 Ubuntu 16.04 中测试。

**Ubuntu 列表根目录**

您可能想要：

```
ncdu --exclude-kernfs -x / 
```

在哪里：

*   `-x`停止跨越文件系统障碍
*   `--exclude-kernfs`跳过特殊的文件系统，如`/sys`

**MacOS 10.15.5 列出根目录**

要在该系统上正确列出 root `/`，我还需要`--exclude-firmlinks`，例如：

```
brew install ncdu
cd /
ncdu --exclude-firmlinks 
```

否则它似乎进入了一些链接无限循环，可能是由于：[https ://www.swiftforensics.com/2019/10/macos-1015-volumes-firmlink-magic.html](https://www.swiftforensics.com/2019/10/macos-1015-volumes-firmlink-magic.html)

我们为爱而学习的东西。

**`ncdu`非交互式使用**

另一个很酷的功能`ncdu`是您可以首先以 JSON 格式转储大小，然后再重用它们。

例如，要生成文件运行：

```
ncdu -o ncdu.json 
```

然后以交互方式检查它：

```
ncdu -f ncdu.json 
```

如果您正在处理像 NFS 这样非常大且速度很慢的文件系统，这将非常有用。

这样，您可以先只导出一次，这可能需要几个小时，然后浏览文件、退出、再次浏览等。

输出格式只是 JSON，因此很容易在其他程序中重用它，例如：

```
ncdu -o -  | python -m json.tool | less 
```

揭示了一个简单的目录树数据结构：

```
[
    1,
    0,
    {
        "progname": "ncdu",
        "progver": "1.12",
        "timestamp": 1562151680
    },
    [
        {
            "asize": 4096,
            "dev": 2065,
            "dsize": 4096,
            "ino": 9838037,
            "name": "/work/linux-kernel-module-cheat/submodules/linux"
        },
        {
            "asize": 1513,
            "dsize": 4096,
            "ino": 9856660,
            "name": "Kbuild"
        },
        [
            {
                "asize": 4096,
                "dsize": 4096,
                "ino": 10101519,
                "name": "net"
            },
            [
                {
                    "asize": 4096,
                    "dsize": 4096,
                    "ino": 11417591,
                    "name": "l2tp"
                },
                {
                    "asize": 48173,
                    "dsize": 49152,
                    "ino": 11418744,
                    "name": "l2tp_core.c"
                }, 
```

在 Ubuntu 18.04 中测试。

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2014-07-22T00:59:42.910

```
du -h --max-depth=1 . | sort -n -r 
```

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2009-06-19T17:31:02.577

我总是使用`du -sk`(`-k`以千字节显示文件大小的标志) 代替。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2017-01-25T07:31:27.853

这是我喜欢的一个

*更新*：我不喜欢上一个，因为它没有显示当前目录中的文件，它只列出了目录。

`/var`在 ubuntu 上的示例输出：

`sudo du -hDaxd1 /var | sort -h | tail -n10`

```
4.0K    /var/lock
4.0K    /var/run
4.0K    /var/www
12K     /var/spool
3.7M    /var/backups
33M     /var/log
45M     /var/webmin
231M    /var/cache
1.4G    /var/lib
1.7G    /var 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2014-11-04T05:38:16.067

du -sch * 在同一目录中。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2014-04-11T12:27:25.100

递归显示当前目录的文件和子目录大小：

```
du -h . 
```

要显示**相同的大小信息**但**不**递归打印它们的子目录（可能是一个巨大的列表），只需使用*--max-depth*选项：

```
du -h --max-depth=1 . 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2014-05-28T09:31:36.567

这些都是很好的建议，但我使用的是：

```
du -ksh * | sort -n -r 
```

`-ksh`确保文件和文件夹以人类可读的格式列出，以兆字节、千字节等为单位。然后按数字对它们进行排序并反转排序，以便将较大的放在首位。

该命令的唯一缺点是计算机不知道 Gigabyte 大于 MB，因此它只会按数字排序，并且您经常会找到如下列表：

```
120K
12M
4G 
```

只是要小心看单位。

此命令也适用于 Mac（`sort -h`例如，不适用）。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2016-03-03T10:09:47.587

杜-sm * | 排序 -nr

按尺寸输出

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2019-02-26T16:00:05.263

如果您想对要列出目录的内容进行更多控制`size`，可以使用`threshold`( `-t`) 开关，如下所示：

```
$ du -ht 1000000000 | sort --reverse 
```

`du`- `d`isk `u`sage
`h` - 人类可读格式
`t` - 阈值大小

在这里，我们要列出所有大于 1GB 的目录。

```
$ du -ht 1G | sort --reverse 
```

* * *

**说明**：

[wiki](https://en.wikipedia.org/wiki/Terabyte)中描述的单元如下：

> K、M、G、T、P、E、Z、Y（1024 的幂）或
> KB、MB、GB、TB、PB、EB、ZB、YB（1000 的幂）。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2015-09-26T17:03:12.333

```
du -S 
```

*du*有另一个有用的选项： `-S, --separate-dirs`告诉*du*不包括子目录的大小 - 在某些情况下很方便。

示例 1 -*仅*显示目录中的文件大小：

```
du -Sh  * 
3,1G    10/CR2
280M    10 
```

示例 2 - 显示目录中的文件大小和子目录：

```
du -h  * 
3,1G    10/CR2 
3,4G    10 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2016-01-05T11:37:35.327

只是一个警告，如果你想比较文件的大小。du 会根据文件系统、块大小...产生不同的结果。

可能会发生文件大小不同的情况，例如比较本地硬盘和 USB 大容量存储设备上的相同目录。我使用以下脚本，包括 ls 来总结目录大小。将所有子目录考虑在内的以字节为单位的结果。

```
echo "[GetFileSize.sh] target directory: \"$1\""

iRetValue=0

uiLength=$(expr length "$1")
if [ $uiLength -lt 2 ]; then
  echo "[GetFileSize.sh] invalid target directory: \"$1\" - exiting!"
  iRetValue=-1
else
  echo "[GetFileSize.sh] computing size of files..."

  # use ls to compute total size of all files - skip directories as they may
  # show different sizes, depending on block size of target disk / file system
  uiTotalSize=$(ls -l -R $1 | grep -v ^d | awk '{total+=$5;} END {print total;}')
  uiLength=$(expr length "$uiTotalSize")
  if [ $uiLength -lt 1 ]; then
    uiTotalSize=0
  fi
  echo -e "[GetFileSize.sh] total target file size: \"$uiTotalSize\""

fi

exit "$iRetValue" 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-06-19T17:30:09.050

看看`du`那个命令

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2016-02-09T23:49:32.840

嗯，最好的方法是使用这个命令：

```
du -h -x / | sort -hr >> /home/log_size.txt 
```

然后，您将能够在所有服务器上获取所有大小的文件夹。轻松帮助您找到最大的尺寸。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2015-08-25T14:55:09.683

有一段时间，我使用 Nautilus（在 RHEL 6.0 上的 Gnome 桌面上）来删除我的主文件夹中的文件，而不是使用`rm`bash 中的命令。结果，显示的总大小为

```
du -sh 
```

不匹配每个子目录的磁盘使用总和，当我使用

```
du -sh * 
```

我花了一段时间才意识到 Nautilus 将删除的文件发送到它的垃圾文件夹，并且该文件夹未在`du -sh *`命令中列出。所以，只是想分享这个，以防有人遇到同样的问题。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-03-02T16:14:00.443

```
find . -maxdepth 1 -exec du --apparent-size --max-depth=0 --null '{}' ';' |\
  sort -k1 -nr --zero-terminated |\
  cut -f2 --zero-terminated |\
  xargs --null -n 1 du -h --apparent-size --max-depth=0 
```

特征：

*   由于 Linux 文件名可以有换行符或空格，我们使用空字符来分隔文件/目录名称。
*   我们按文件/目录的大小对文件/目录进行排序。
*   我们使用`--apparent-size`with`du`来获得类似于 的行为`ls`。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2020-10-29T20:11:05.613

重要的是要注意这里`du`提供了磁盘使用情况。不同的机器可以使用不同的块大小，因此在一台机器上，一个块可以是 4096 字节，而另一台机器可以包含 2048 块大小。如果我将 10 个 1 字节文件放入使用 4096 字节块的机器中，将 10 个 1 字节文件放入机器中使用 2048 字节块，`du -h`将分别报告 ~40k 和 ~20k。

如果您想知道目录中所有文件的大小，对于每个目录，您可以执行以下操作：

```
for x in ./*;
do
    if [[ -f "$x" ]]; then
        ls -al "$x"
    fi
done | awk '{print $6}' | awk '{s+=$1}END{print s}' 
```

这将为您提供目录中所有文件的总大小。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2016-02-14T18:55:04.763

我遇到了一个类似于 Martin Wilde 描述的问题，在我的例子中，在使用 rsync 镜像后比较了两个不同服务器上的同一目录。

我没有使用脚本，而是将`-b`标志添加到`du`以字节为单位的大小，并且据我所知消除了两台服务器上的差异。您仍然可以使用`-s -h`来获得可理解的输出。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2018-11-29T17:27:15.023

放置在初始化脚本中，如 .bashrc ...根据需要调整 def。

```
duh() {
  # shows disk utilization for a path and depth level
  path="${1:-$PWD}"
  level="${2:-0}"
  du "$path" -h --max-depth="$level"
} 
```

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2020-07-19T00:46:43.900

仅从 ls 检索以字节为单位的大小。

```
ls -ltr | head -n1 | cut -d' ' -f2 
```

* * *

## 回答 #27

> 赞同：-3
> 
> 时间：2016-03-11T17:47:05.977

键入“ls -ltrh /path_to_directory”********

# php - 处理贫血的域模型

> ID：1019118
> 
> 赞同：8
> 
> 时间：2009-06-19T17:29:23.107
> 
> 标签：php, domain-driven-design, domain-model

我试图将我的 DAL 与我的业务层分开，并且在这样做时，我决定避开任何 ActiveRecord 方法并采用 DataMapper 方法。换句话说，我的域对象不会处理自己的持久化。这样做，我似乎在侵犯“贫血域模型”反模式。例如，我的程序中的一个实体是一个组织。

一个组织可以这样表示：

```
class Organization {
    private $orgId;
    private $orgName;

    // getters and setters
} 
```

所以基本上这个组织除了充当一些数据的“包”（正如 Martin Fowler 所说）之外什么都不做。在 PHP 世界中，它只不过是一个美化的数组。与之相关的行为为零。

而在程序中的行为，我一直坚持“服务级别”类，比如 OrganizationService，它主要充当这些对象和 DAL 之间的中介。

除了 PHP 的潜在扩展问题（我确实有其他原因为什么我坚持在这些对象中“装袋”我的数据），这种方法完全不可行吗？

在这些情况下，您如何处理您的领域模型？也许一个组织一开始就不属于我的领域？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T17:40:04.077

好吧，一开始似乎是这样，但是当您更多地重构代码时，您将获得组织类的一些行为......

我现在可能想到的一个例子是，如果您有人员（员工），您可能希望将他们与组织相关联。因此，您可能有一个方法`AssociateEmployee(User employee)`可以在您的组织类中找到它的位置。

或者您可以更改公司的位置，而不是分三步设置地址，城市，州等参数，您可以添加`ChangeLocation(Street, City, State)`方法..

一步一步来，当你在 BL/service 层遇到一些看起来应该属于域的代码时，将它下移到域中。如果您阅读 Fowler，当您在代码中看到它时，您很快就会明白。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T17:36:57.903

现在可能只是贫血？

例如，有一次我正在开发一个会议/会议注册网站。它始于一次会议。

还有一个会议课，只有一个实例，但是第二年我们召开了会议，它被扩大了，并且增加了新的属性（举行两次背靠背会议），所以显然它还没有完全开发，因为我们随后添加了可能包含多个会议的会议组。

所以我认为重要的是要记住域会随着时间而变化，并且您的模型最终可能会被重构，因此即使您可能认为它乏善可陈，它也可能有点过于前瞻性（就像您的组织类将开始获取一些设置、规则或偏好等）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T18:01:54.173

您可能还会考虑，如果您没有很多业务规则，或者域不是那么复杂，那么 DDD 可能对您来说开销太大。DDD 是大型复杂域的出色解决方案，但如果您只是将数据输入、数据输出，则会产生大量开销和复杂性。DDD 更难设计并且固有地增加了复杂性，因此为了证明它的合理性，问题域的复杂性应该超过它。

这就是我要添加到 zappan 和 Epitka 的全部内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T17:37:20.290

你的实体不是贫血的，因为你正在承担一开始就不应该存在的责任。持久化和获取实体是存储库的责任。实际上，您的行为应该在您的实体中而不是在服务层中。但是，解释去向远非简单的答案。Eric Evans 的 DDD 是一个很好的起点。

# asp.net - Reporting Services - 报告参数丢失状态

> ID：1019121
> 
> 赞同：0
> 
> 时间：2009-06-19T17:30:04.557
> 
> 标签：asp.net, sql-server-2005, reporting-services

我正在使用报表查看器控件将报表嵌入到我的 ASP.NET 应用程序中。

当我更改参数值并单击查看报告时，我丢失了参数选择。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T17:35:20.230

检查是否启用了 ViewState（对于页面和控件）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-29T08:42:26.387

问题是我在后面的代码中设置了报告位置，但没有检查是否有回发，因此每次都重置报告。

# php - PHP + PDO/MySQL：如何自动查询 VARCHAR 字段长度？

> ID：1019123
> 
> 赞同：3
> 
> 时间：2009-06-19T17:30:18.847
> 
> 标签：php, mysql, pdo

有没有办法使用 PHP+PDO 来查询 MySQL 数据库并找出一些 VARCHAR 字段的列宽？如果可能的话，我不想将它们硬编码到我的 PHP 文件中。

（目的：确定要插入这些列或与列中现有数据进行比较的字符串的最大长度。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T17:44:35.880

只需向`information_schema`. `columns`表并过滤掉您需要的行。您要查找的值存储在“CHARACTER_MAXIMUM_LENGTH”下。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-19T17:44:16.710

[从INFORMATION_SCHEMA COLUMNS](http://dev.mysql.com/doc/refman/5.1/en/columns-table.html)读取它

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-14T04:48:04.163

从 INFORMATION_SCHEMA.COLUMNS 中选择 CHARACTER_MAXIMUM_LENGTH，其中 COLUMN_NAME='yourcolumn' 和 TABLE_NAME='yourtable';

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T20:43:39.643

运行以下查询： 'DESCRIBE `table_name`' 其中 table_name 是您要查找有关信息的表的名称。它会返回你正在寻找的东西。

# iphone - 您希望可以在 iPhone / iPod Touch 上为哪些配件编程

> ID：1019132
> 
> 赞同：2
> 
> 时间：2009-06-19T17:32:47.050
> 
> 标签：iphone, iphone-accessory

新的 iPhone O/S 3.0 增加了对配件编程的支持——但您想为哪些配件编程？

- 更新 -

您将如何使用血糖监测仪、汽车发动机系统监测仪、信用卡读卡器等配件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T17:41:49.363

可以安装 iPhone 的激光标签式枪、无线模式、GPS、指南针和枪可以组合成一款非常酷的游戏。

骑自行车时使用的心率监测器，用于积累骑行统计数据（可能已经通过蓝牙提供）。

键盘。您可以将 iPhone 插入顶部的其中之一——折叠起来，等等。

你知道，如果有一个你把 ipod 放在“周围”的盒子（就像现有的硬塑料盒子一样），里面有额外的可充电电池和一个内存扩展包来保存额外的音乐（比如一张 64-128gb 的卡），那就太好了）。

更新：虽然我知道血糖监测仪实际上正在开发中，但我不确定它会有什么额外的帮助。我正在观看的演示文稿声称它可以跟踪信息并立即将其发送给您的医生。

我可以很容易地看到它监控汽车性能。我会在仪表板上安装一个 iPhone 风格的支架，然后在我上车时将其滑入。它可以控制和监控燃油效率、发动机性能、正时、排放等。它可以提供图形和其他显示，这些显示会随着性能的变化而更新。

在高性能汽车上，它甚至可以为您换档（我相信较新的手动换档可以电子控制）

这可能也在做。我和一个朋友正在讨论用 DS 做这件事。

CC阅读器也正在制作中。我不确定它是硬件还是照片还是手动输入。他们在讨论血糖监测仪的同一个主题演讲中讨论了这个问题。

我可以看到这非常有用。几周前，我在“客厅”风格的剧院看电影。每排都有无限的腿部空间，前面设置了脚凳。他们在一家提供全方位服务的餐厅供应餐点。接单时，服务员会随身携带这些大东西，看起来有点像 UPS 司机用来签收的东西。饭后他们把你的卡拿走处理它。这两项任务可以使用 iPhone 同时完成（而且更优雅）。

（不幸的是，我和我的妻子花了 70 多美元去看“宿醉”——一部不错的节目，但有点贵）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-19T18:55:44.007

我很期待自己的汽车诊断接口。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-19T17:47:45.253

[盖革计数器](http://en.wikipedia.org/wiki/Geiger_counter)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-19T17:38:44.360

信用卡读卡器、RFID 读写器、外部 wifi 适配器、IR 发射器

编辑：紧凑型闪存/SD 读卡器

另一个编辑：打印机！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-19T18:01:53.533

用于控制无线电遥控飞机和带有第一人称视频的东西的视频/遥控收音机。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-19T17:35:07.920

也许是某种更大的视频屏幕附件。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-21T01:53:50.057

*   家庭自动化
*   汽车自动化
*   该死的键盘
*   任何高清电视
*   我的洗衣机

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-19T17:34:00.123

红外遥控附件？

具有开放标准以便所有游戏都可以使用的视频游戏控制器怎么样？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-19T18:16:47.003

制作建筑物的地图视图会很酷。它的工作原理类似于谷歌地图街景或谷歌地球。它不会将其用于道路，而是显示各种建筑物的走廊和房间。允许用户导航商场、图书馆和其他公共建筑以定位目的地。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-25T13:32:13.247

我认为汽车市场渴望这样的事情。目前，唯一的选择是类似于 Rev 的产品，它使用启用了 wifi 的 OBD-II 连接到 iPhone。一旦你得到一个硬附件，诊断和调整将非常容易，并且应该比 wifi 附件便宜得多。另外，我觉得汽车调谐器市场的很大一部分已经有了 iPhone，所以添加附件和应用程序并不是一个很大的飞跃。我的车里已经为我的手机安装了一个坚固的支架。如果我可以在驾驶时了解我的汽车信息，那只会让事情变得更好！

接下来，我认为有人为 iPhone 编写通用遥控器（家庭自动化/电子产品/任何 rf，如远程扩展器、车库门等的通用含义）会很酷。罗技几乎需要这样做（对于电子方面）。他们已经拥有了 Harmony 遥控器，因此使用这些知识和遥控器代码数据库将其添加到 iPhone 上并不难；他们只需要一个允许 iPhone 发送 IR 和 RF 的小附件，显然 wifi 和蓝牙已经被覆盖。

至于键盘，我认为它不应该是应该插入 iPhone 的东西，我认为它应该是你只需将 iPhone 放在旁边并获得蓝牙键盘的东西。我知道他们已经生产了这样的产品，我只是不确定他们是否可以在 iPhone 上使用。

# asp.net - MOSS 发布页面上的自定义服务器控件

> ID：1019133
> 
> 赞同：0
> 
> 时间：2009-06-19T17:33:59.653
> 
> 标签：asp.net, sharepoint, moss, code-behind

问题是：

> 我在 MOSS 2007 发布站点中有一个使用布局的页面（该页面继承自 `Microsoft.SharePoint.Publishing.TemplatedRedirectionPage`），我需要为此页面编写代码隐藏，但仍然让布局模板机制工作。
> 
> 我的尝试是编写一个继承自的类， `Microsoft.SharePoint.Publishing.TemplatedRedirectionPage`然后将页面更改为从我的类继承。该页面表现正常（即，它像以前一样工作），但我的代码后面的类中的方法不会被调用。
> 
> 有谁知道我应该做什么？

但在这一点上，我很确定它不会起作用。我目前的方向是尝试在发布页面上放置一个自定义服务器控件，但我似乎也无法让它工作。除了通过其布局（这里不是一个选项）之外，是否无法自定义发布页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T22:36:13.687

事实证明，完成我想要的最直接的方法是在页面布局上放置一个 Web 部件区域，然后使用 SharePoint 编辑控件添加我的控件（可以轻松地将其制成 Web 部件） .

一切都很好，我不必做任何奇怪的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-20T07:16:52.260

好的，这就是它的工作原理。我相信您`Microsoft.SharePoint.Publishing.TemplatedRedirectionPage`从站点模板文件夹中的文件中获得了这个类。这些页面只是一种占位符。在站点中创建的实际页面不是基于 TemplatedRedirectionpage，而是基于站点中存在的页面布局实例。

为了解决您的问题，您可以采取

1.  自定义页面布局（继承发布页面布局类并做你想要的东西）但是你说你不想要它。
2.  第二个可用选项是使用功能创建可复制页面并将它们提供给站点（可复制页面和可复制库页面之间存在差异）。这将如何解决您的问题是您可以编写任何自定义代码/从您想要的任何类继承并使用功能来配置它。一个示例是查看文件“C:\Program Files\Common Files\microsoft shared\Web Server Extensions\12\TEMPLATE\SiteTemplates\sts”并查看 onet.xml 以了解其配置方式，C： \Program Files\Common Files\microsoft shared\Web Server Extensions\12\TEMPLATE\SiteTemplates\sts\xml\onet.xml ~163 行号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-20T10:26:17.570

发布页面本质上是由最终用户填充的页面布局（模板）。它的逻辑纯粹来自已添加到页面布局的控件。我没有听说过从发布页面类继承，因为它不应该是必要的 - 修改页面布局是这样做的方法。

如果您无法修改页面布局，这并不能真正帮助您（有什么原因吗？）。我不确定您要向页面添加什么功能，但这里有一些想法：

*   创建一个包含具有您需要的功能的自定义控件的新页面布局，并在此基础上创建一个发布页面。
*   如果您已经在页面布局中使用了自定义控件，请修改它们以提供您需要的功能。
*   调查[委托控制](http://msdn.microsoft.com/en-us/library/ms463169.aspx)，看看它们是否适合你。

# web-services - Web 服务是否应该抛出异常或结果对象

> ID：1019141
> 
> 赞同：12
> 
> 时间：2009-06-19T17:35:57.327
> 
> 标签：web-services, soap, exception-handling, asmx

我不确定我是否完全高兴在 Web 服务中抛出异常是一个好主意。如果不是堆栈跟踪，我不会那么介意。这不是我不想要的。

我已经研究了几种实现，但似乎对此并没有达成共识。例如，CampaignMonitor 确实返回一个 Result 对象，而其他对象则没有。

从架构上讲，我不确定返回返回对象是否有意义，当然异常就是异常，但我喜欢返回对象的地方在于它对最终用户来说是一个更优雅的解决方案。

有没有人有更好的解决方案？

编辑

顺便说一句，我正在使用 ASMX Web 服务，不能选择打开 CustomErrors。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-19T17:50:12.053

不要让您在 Web 服务中的事实混淆了这个问题。这只是一个实现细节。

使用正常的异常处理策略。最佳实践是不要在低级代码中捕获异常——除非您可以在那里解决该异常并正常继续。应向表示层提出异常，以便将错误通知用户。

因此，在应用于 Web 服务时——通常会抛出异常（这会导致 SoapFault）。这允许调用客户端代码使用它的内置异常处理标准来处理它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-19T17:39:22.347

你在说什么堆栈跟踪？你试过这个吗？

在 ASMX 和 WCF 服务中，未捕获的异常将被转换为 SOAP 错误。在这两种情况下，它们都可以配置为不包含任何堆栈跟踪。事实上，这是 WCF 中的默认设置。

因此，返回此类错误的正确方法是通过错误。产生故障的一种方法是抛出而不处理异常。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T17:52:44.343

一种方法是将系统错误和业务错误分开。（系统错误：例如格式错误的请求，用户未授权等；业务错误：例如方法UpdateCars导致错误，用户没有任何汽车）。

如果出现业务错误，返回一个包含错误描述的响应对象；如果出现系统错误，则抛出异常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T17:40:30.880

你能澄清一点吗？Web 服务的服务器端可以抛出异常。Web 服务的服务器端可以向客户端返回消息。该消息可能包含错误信息，并且该错误信息可能具体包括异常详细信息。或者它可能不会。在客户端，您通常有一个生成的代理来处理来自服务器的消息。如果该响应包含错误信息，则此代理可能会生成异常。

你想知道这个场景的哪一部分？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T17:46:02.433

我认为抛出异常通常是比返回结果更好的设计模式。我想你必须做的是在你的 Web 服务中隐藏堆栈跟踪，方法是将以下模式应用于作为 Web 服务公开的每个方法：

> 公共无效MyWebServiceMethod（）{
> 尝试
> {
> 
> ```
>  ///Do something that may cause an error 
> ```
> 
> } catch(Exception ex)
> { throw new ApplicationException("用户友好的异常描述");
> 
> }
> 
> }

或者你也可以

> 捕获（异常前）{ 抛出前；}

如果您重新抛出异常，您将对 Web 服务的客户端隐藏原始堆栈跟踪。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T18:25:31.450

我不明白为什么你不能两者都做？捕获异常，将其记录（记录到数据库或文件），然后返回错误代码。这样，您就可以优雅地执行 web 服务调用，并通知错误，并且您可以在其他地方进一步调试。

# ruby-on-rails - 在 Rails 中按日期子字符串过滤

> ID：1019142
> 
> 赞同：0
> 
> 时间：2009-06-19T17:36:07.547
> 
> 标签：ruby-on-rails, ruby, database, datetime

我们有一个网格控件，允许用户过滤不同字段中的文本。其中许多字段可能是时间戳，例如 created_at 和 updated_at。

现在，用户可以执行许多不同类型的过滤器，包括 >、<、>=、<= 等。因此，来自控件的查询可能如下所示：

“created_at > 2009”，或“created_at >= 2006 和 created_at <= 2010”。

数据库不会将年份识别为有效的时间戳，rails 也不会自动将它们转换为这样的时间戳。是否有任何插件或惯用方法来完成花费一年或更好的时间戳的一部分，对含义做出最佳猜测，并将其转换为可用的数据库时间戳？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T17:45:00.547

看看以下项目

*   [搜索逻辑](http://rdoc.info/projects/binarylogic/searchlogic)
*   [步车](http://github.com/thoughtbot/pacecar/)

例如，searchlogic 支持如下条件。

```
Post.all(:conditions => { :hour_of_created_at => 9 }) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T18:06:52.557

**created_at > 2009**

```
Post.all(:conditions => ["created_at > ?", Date.new(y = 2010, m = 1, d = 1).to_s]) 
```

**created_at >= 2006**

```
Post.all(:conditions => ["created_at >= ?", Date.new(y = 2006, m = 1, d = 1).to_s]) 
```

**created_at <= 2010**

```
Post.all(:conditions => ["created_at <= ?", Date.new(y = 2010, m = 12, d = 31).to_s]) 
```

大概是这样的？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T18:23:08.397

你可以使用 ruby​​ 的 Time 类

```
Time.local(2010) # => Fri Jan 01 -0600 2010 
```

或者

```
Time.gm(2010) # => Fri Jan 01 00:00:00 UTC 2010 
```

# ajax - HTML 5 会指定获取客户位置和文化信息的方法吗？

> ID：1019143
> 
> 赞同：2
> 
> 时间：2009-06-19T17:36:20.727
> 
> 标签：ajax, web-services, internationalization, standards, geolocation

我有这个 Web 服务...它提供 HTML 以响应 AJAX 请求，并且 Web 服务需要注意：

1.  用户的特定语言
2.  用户的时区或位置

我知道这目前是非常不可行的。但...

似乎 HTML 5 将有一个[Geolocation API！](http://www.w3.org/TR/2008/WD-geolocation-API-20081222/) 惊人的。这应该照顾我的时区要求（我可以以某种方式在数据库中查找它）。

但是，我也想知道如何获取他们的文化设置（“en-US”等），以便我可以将我的 Web 服务中的 DateTimes 和数字呈现到他们的特定偏好中。

* * *

注意：这是我的另一个问题的后续问题：[查找客户的时区和文化](https://stackoverflow.com/questions/1017053 "寻找客户的时区和文化")

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T18:51:26.387

这现在在 HTTP 标头中 - [http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.4](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.4) - 每种语言都有获取此信息的方法。您的 Web 服务是用哪种语言实现的？

# .net - 跨多个网站集扩展 SharePoint 面包屑导航

> ID：1019150
> 
> 赞同：1
> 
> 时间：2009-06-19T17:37:44.953
> 
> 标签：.net, sharepoint, sharepoint-2007, navigation, breadcrumbs

我一直在尝试找到一种方法来跨多个网站集扩展 SharePoint 面包屑导航，但一直找不到方法。我可以将网站集上的*门户网站连接*设置设置为链接到其父网站集。但是，这不会只显示一个父网站集。这是我正在创建的设置类型的示例。

根站点 Intranet 有一个称为站点的托管路径。在站点下有一个名为**HR**的站点集合，位于**/sites/hr/**。在 HR 下还有另一个管理路径设置，称为外展。在外展中有一个名为**Recruiting**的网站集，位于**/sites/hr/outreach/recruiting/**。因此，当用户在招聘站点时，我希望他们看到**Intranet > HR > Recruiting**作为面包屑路径。

站点地图示例：

```
<?xml version="1.0" encoding="utf-8" ?>
<siteMap xmlns="http://schemas.microsoft.com/AspNet/SiteMap-File-1.0">
    <siteMapNode title="Intranet" url="http://intranet/Pages/Default.aspx">
    <siteMapNode title="HR" url="http://intranet/sites/hr/default.aspx">
            <siteMapNode title="Recruiting" url="http://inranet/hr/outreach/recruiting/default.aspx"/>
        </siteMapNode>
    </siteMapNode>
</siteMap> 
```

在招聘中设置门户网站连接我可以在招聘时获得**HR > Recruiting**，在 HR 上设置门户网站连接我可以在 HR 网站中获得**Intranet > HR**。不过我不能。

我尝试使用**SPXmlContentMapProvider**来读取站点地图文件，但是当我将其设置为*default.master中**GlobalNavigationSiteMap*的**SiteMapPath**的 SiteMapProvider时，我根本无法让它显示。（*GlobalNavigationSiteMap*是在站点顶部创建面包屑的 SiteMapPath）。但是，相同的体系结构在通用 .NET 应用程序上运行良好，但在 SharePoint 中似乎不起作用。我还正确地将站点地图注册为**defaultProvider** 并能够使用它来替换*TopNavigationMenu*。（*顶部导航菜单********是默认 SharePoint 布局顶部的全局导航菜单/按钮栏）。*******

 *****有没有办法将此功能实际构建到 SharePoint 中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-21T10:20:01.230

既然您正在实现自定义母版页（或自定义默认母版页），为什么不将面包屑控件替换为您自己的？如果您需要将站点地图与 Sharepoint 生成的地图相结合，或者制作自定义站点地图提供程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-21T15:00:06.983

我想了很多关于为什么不能使用**SPXmlContentMapProvider 的问题**，我认为这归结为 SharePoint 如何呈现和使用托管路径。我的理论是这样的：

SharePoint 中的所有网站集位置都是托管路径。由于内容确实存储在数据库中，并且 IIS 将信息呈现为像在文件夹中一样，但页面并不位于文件夹中。相反，该位置位于 SharePoint 的“以太”中的某个位置，无论**SPXmlContentMapProvider**看到的位置本身在哪里，它都在 xml 文件中的条目之后的其他位置。现在 Request.Url 确实知道您在哪里，但该信息似乎并未呈现给**SPXmlContentMapProvider**。

我也想出了一个解决这个问题的方法。您可以手动编辑每个网站集的母版页，以将该网站集的面包屑路径粘贴在*GlobalNavigationSiteMap*前面。因此，具有此导航要求的每个网站集都需要拥有自己的自定义母版页。这是一种丑陋的、蛮力的做事方式，我无意实施。它会起作用，但将是维护的噩梦。*****

# sql-server - 您将使用哪种类型的算法来帮助根据历史数据预测未来的表现？

> ID：1019153
> 
> 赞同：2
> 
> 时间：2009-06-19T17:38:28.150
> 
> 标签：sql-server, algorithm, ssas

过去，我们一直使用“供应商”对历史业绩的*总结来决定我们如何将新业务分配给每个供应商。*

现在我们要做的是将汇总性能分解为较小的子集，例如地理、规模、年龄等，以便更好地分配我们分发给供应商的新业务。

例如，假设现在我有 3 个供应商和 9 个业务要分发。目前，我只是根据他们的业绩总结来分发业务。然而，这并没有考虑到他们在地理、大小、年龄等方面的每一个优势。

因此，假设供应商 A 非常擅长处理德克萨斯州的小型账户，而供应商 B 擅长处理佛罗里达州的大型账户。我想确保每个供应商都能得到他们擅长的东西，而不会得到他们不擅长的业务。

我们在数据库中拥有所有这些信息，但没有真正的算法或方法来提取它并根据我们的决定来决定我们向谁发放多少以及什么样的业务。我们一直在研究 SQL Server Analysis Services 来完成这项任务，但我们可以使用一些非常通用的指针来了解我们应该使用什么算法来完成这项工作。

有没有人碰巧知道一种旨在处理数据分割以做出更好预测的方法或算法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T17:48:42.117

如果您有相当大量的历史数据要处理，您可以使用[朴素贝叶斯分类器](http://en.wikipedia.org/wiki/Naive_Bayesian_classification)。使用帐户的特征作为输入，您可以训练一系列分类器来预测每个供应商的表现。

您选择的语言可能已经存在免费实现，尽管您需要阅读一些基本理论，以确保您正确使用它并让您了解哪些类型的输出是合理的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T18:18:17.250

朴素贝叶斯是一个不错的选择，但我也会考虑决策树。使用决策树的主要优点是：

1.  人类很容易理解正在发生的事情并进行调整。
2.  即使您只有一小部分数据可供训练，它也能很好地发挥作用。

但无论您决定什么，最困难的部分是将您的数据转换为某些属性。这既是为了针对特定算法进行定制，也是为了防止训练变得过于具体。

例如：您可能对指定年龄范围（0-10、11-20、...）更感兴趣，而不是数字作为数字。地理、城市等也是如此。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T17:58:35.660

**将通用数量转换为数值：（**在编辑中添加）

您需要某种方法来从数据中获取质量指标（“好”的度量），并将其中很多东西转换为数字量。可能的指标可能是完成任务的时间（与初始估计相比，看看他们是否对此撒谎）、成本、成本与报价成本（检查他们是否给你真实的报价），以及某种与客户满意度相关的综合体到他们从事的项目。

先前合同的区域/区域可以编码为 GPS 坐标，其中 X,Y 为给定交易的区域中心（即“加利福尼亚”或“美国”以及该区域的宽度-x、宽度-y（误差范围). 要查看地理位置是否重要，您可以在新合同的给定距离内找到所有先前的业务（简单形式：只需检查所有先前交易的距离，具有大量数据的复杂形式：某种聚类算法或 3-d表面提取）。

然后，您对（先前业务交易的质量指标）进行加权平均，减去（当前期望的交易位置与先前的交易位置之间的距离）。复杂，但它会为您提供区域业务指标。

**分析数据以提取意义**

我建议您将数据转换为标准的 CSV 元组（公司 id、地区代码/坐标、帐户规模、绩效指标），然后进行统计回归和数值分析技术。你的目标是用一组方程描述公司在每个特征方面的表现。 [主成分分析](http://en.wikipedia.org/wiki/Principal_components_analysis)可以通过识别公司绩效的最重要特征来简化此过程。

**软件选择：**

老实说，这种分析完全是统计或数据挖掘软件的领域，而不是 SQL 分析引擎，因为它们是纯粹的统计和数学。如果您的指标和特征是数字的并且可以清楚地量化，那么 R、Matlab、Mathematica 等都是不错的选择。如果您的数据集*非常*大，您将希望投资于您可以获得的最强大的软件包。

**挑选最佳候选公司：简单案例**

将业务分配给最佳候选人的问题是一个经典的优化问题。如果变量和性能之间的关系是线性的，那么您就有了一个非常方便的案例。 [线性规划技术](http://en.wikipedia.org/wiki/Linear_programming)旨在优化解决这类问题（假设您可以提取关系）。

**挑选最佳候选公司：复杂案例**

如果性能与特性方程是非线性的，则需要模糊逻辑来找到最佳解决方案。当有很多变量时，这将使用非常非常先进的算法来为业务找到一个非常好的（不一定是最好的）解决方案。根据经验，Mathematica 有一套一流的优化工具（基于遗传算法）用于非线性优化，Matlab 也有用于解决该问题的模糊逻辑/遗传算法。如需更多工具，请查看“全局非线性优化”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T17:55:11.127

一种方法是列出您感兴趣的所有特征，例如地理位置、账户规模、价格、交货时间......

然后根据每个特征对每个供应商进行评分，例如 1 到 10。

然后给每个特性一个优先级，也可以是1到10。

此优先级可以是一般的或针对每个作业。

然后，您“简单地”乘以每个所需特征的供应商分数 * 优先级。总分最高的人得到这份工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T18:21:23.987

计算历史数据的方差。这可以用来“预测”你将来会看到什么。如果假设“未来将像过去一样”对您的流程有意义。它相当简单，许多 sql 服务器都提供内置函数来帮助进行计算。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T18:29:59.150

[回归分析](http://en.wikipedia.org/wiki/Regression_analysis)是您所需要的，尤其是[线性回归](http://en.wikipedia.org/wiki/Linear_regression)。

# javascript - 如何在jqGrid中显示没有任何数据的信息？

> ID：1019155
> 
> 赞同：11
> 
> 时间：2009-06-19T17:38:44.237
> 
> 标签：javascript, jqgrid

当 jqGrid 为空时，我想在网格内显示单个空行，并显示没有任何数据的信息消息。这怎么可能？谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-10-07T21:42:07.790

我一直在寻找这个问题的答案并提出了以下解决方案，但我没有与服务器交谈，所以我必须使用“loadComplete”事件之外的东西。我连接到“gridComplete”事件并检查是否有任何记录。如果没有，请显示您的空文本，否则将其隐藏。

 `````
jQuery('#test').jqGrid({
        ... // some settings
        gridComplete: loadCompleteFunction,
        emptyDataText:'There are no records. If you would like to add one, click the "Add New ..." button below.', // you can name this parameter whatever you want.
        ... // more settings

});

function LoadComplete()
{
    if ($('test').getGridParam('records') == 0) // are there any records?
        DisplayEmptyText(true);
    else
        DisplayEmptyText(false);
}

function DisplayEmptyText( display)
{
    var grid = $('#test');
    var emptyText = grid.getGridParam('emptyDataText'); // get the empty text
    var container = grid.parents('.ui-jqgrid-view'); // find the grid's container
    if (display) {
        container.find('.ui-jqgrid-hdiv, .ui-jqgrid-bdiv').hide(); // hide the column headers and the cells below
        container.find('.ui-jqgrid-titlebar').after('' + emptyText + ''); // insert the empty data text
    }
    else {
        container.find('.ui-jqgrid-hdiv, .ui-jqgrid-bdiv').show(); // show the column headers
        container.find('#EmptyData' + dataObject).remove(); // remove the empty data text
    }
}

````  `* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T18:53:35.477

棘手的一点是让消息显示在列中。我认为没有简单的方法可以做到这一点。例如，您必须隐藏除第一列之外的所有列，设置第一列的宽度以填充网格，然后将消息放在第一列中。然后，当您重新加载时，您必须撤消所有这些。它应该工作，但它有点混乱。

但是，假设您只想将消息放入第一列并将其余部分留空。基本上，您实现“loadComplete”事件函数并操作网格的内容。

像这样向您的网格对象添加一个属性：

```
//Various other grid properties...
loadComplete: function() {
     if (jQuery("#grid_id").getGridParam("records")==0) {
          jQuery("#grid_id").addRowData(
                "blankRow", {"firstCol":"No data was found". "secondCol":"", "thirdCol":""
          );
     }
} 
```

其中“#grid_id”是网格容器的 ID，“blankRow”是您为添加的新行指定的任意 ID，“firstCol”、“secondCol”等是列的名称.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-03-12T13:32:06.697

1.  为 json 数组设置**"rows":[]**
2.  将您的错误容器附加为成功

    ```
    onLoadSuccess: function() {
        **var rows = $(this).datagrid("getRows");**
    if(rows.length == 0)
    {

      $("#errordiv").show();
      $(".datagrid-view").append('<div class="errordiv" id="errordiv">Ur Message</div>');
    }
    else
     $("#errordiv").hide();

     } 
    ```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-09-14T09:26:03.880

```
$('#grid').jqGrid({
     loadComplete: function() {
            if ($("#grid").getGridParam("records")==0) {
                $("#grid").addRowData(
                $("#grid")
                    .empty()
                    .append('<tr class="yourClass"><td>No records to display</td></tr>')
                 );
            }
        }
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-08-16T22:54:34.253

我按如下方式实现它（尽管这确实取决于我使用提供的寻呼机功能这一事实）。没有返回记录时显示的只是标题栏和一个显示“没有要查看的记录”的寻呼栏。

早期设置 jqGrid 默认选项的代码片段（甚至在我的页面上加载网格之前）：

```
// jQuery jqGrid default options
$.extend($.jgrid.defaults, {
    pager: '#gridPager',
    emptyrecords: "No records to view", // Unnecessary (default in grid.locale-en.js)
    recordpos: 'left',
    recordtext: "Viewing {0} - {1} of {2}", // Overriding value in grid.locale-en.js
    viewrecords: true
}); 
```

我加载 jqGrid 的代码片段：

```
$('#grid').jqGrid({
    loadComplete: function () {
        // Hide column headers and top pager if no records were returned
        if ($('#grid').getGridParam('records') === 0) {
            $('#grid_toppager').hide();  // I used top & bottom pagers, so I hid one
            $('.ui-jqgrid-htable').hide();
        }
    }
}); 
```

编辑：您也可以参考这个答案[How can I hide the jqgrid fully when no data returned?](https://stackoverflow.com/questions/1167477/how-can-i-hide-the-jqgrid-completely-when-no-data-returned) 并做以下两件事之一：

1) 将您的消息放在一个 div 中，将网格放在另一个中。隐藏网格并显示消息。

2) 将您的消息放在网格正下方的 div 中。按照我上面的方法，但隐藏所有寻呼机（不仅仅是一个）。在同一个事件处理程序中显示您的 div。您应该看到的只是标题栏和您的消息 div。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-01-13T03:59:04.803

我找到了执行此操作并允许网格处理它的最佳方法是返回不带行的默认参数。例如，我使用的是 JSON 数据，所以这将是返回 JSON。

```
{"d":"{"page":"1","total":"0","records":"0","rows":[]}"} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-22T06:19:20.977

将您的消息放在一个带有 style: hidden 的 div 中。将它放在您的寻呼机 div 中。

在 loadComplete 事件中执行以下操作：

```
if($('#results').getGridParam("records")==0) { 
 $("#noResultsDiv").show();   
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-08-13T14:54:25.753

我知道这个问题有点老了，但对我来说这很好：

```
$('#tableid').jqGrid({
  ...
  datatype: dataLoad,
  ...
})

function dataLoad(postdata, sid) {
  var id = sid.replace('load_', '');
  var result = loadDataFromServer('/my/server/url', postdata);

  if (result) {
    if (result.records > 0) {
      var thegrid = $("#"+id)[0];
      thegrid.addJSONData(result);
    }
    else
      $("#"+id+" tbody")
       .empty()
       .append('<tr><td class="emptyDataMsg">This table is empty</td></tr>');
  }
} 
```

基本上我所做的是从服务器加载数据，检查我是否得到了一些记录，如果没有清空表中的所有行，并在我的自定义文本的一行中添加一个宽度。使用一些 CSS，结果非常简洁：

```
.emptyDataMsg {
  background-color: #EEEEEE;
  border-bottom: 1px solid #CCCCCC;
  color: #666666;
  font-size: 1.2em;
  font-weight: bold;
  padding: 5px;
  text-align: center;
} 
`````

# linux - 控制在虚拟桌面 (linux) 上运行的应用程序

> ID：1019160
> 
> 赞同：0
> 
> 时间：2009-06-19T17:39:23.690
> 
> 标签：linux, desktop, virtual

我需要在虚拟 Xorg 桌面（比如说桌面 #2）上运行一个应用程序，并通过在根桌面（桌面 #1）上运行的另一个应用程序来控制它。这将包括屏幕截图和鼠标移动。所以基本上我从桌面#2 捕获应用程序窗口，将其抓取，然后通过桌面#1 上的应用程序单击按钮。不管怎样，你明白了。

现在我的大问题是：这可行吗？如果是这样，最好的语言是什么？

顺便说一句，我正在使用 Linux

提前致谢

卢克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T18:49:59.850

如果你在谈论文本模式控制台，那就是：[http ://ace-host.stuart.id.au/russell/files/conspy/](http://ace-host.stuart.id.au/russell/files/conspy/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-20T00:33:12.020

大多数窗口管理器通过隐藏不应显示的应用程序来实现桌面管理。

您可以将 xevents 发送到应用程序上的按钮。我怀疑您是否能够捕获应用程序的屏幕内容，因为它没有被映射。

您也许可以在 Xnest 下运行您的应用程序，然后您可以捕获屏幕内容。但是，根据我的经验，Xnest 在某些情况下无法正确呈现应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T17:48:35.190

这当然是可行的。如果你在 linux 上使用 VirtualBox，那么你可以使用远程桌面协议来远程运行和控制虚拟机。

VirtualBox 支持标准远程桌面协议，其中虚拟机可以充当 RDP 服务器，允许您在仅显示 RDP 数据的瘦客户端上远程“运行”虚拟机。

希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T18:40:25.250

从[这篇文章](https://stackoverflow.com/questions/351185/is-there-a-simple-way-to-detect-mouse-or-keyboard-activity-in-linux-xorg-qt4-kde4)中有人提到[记录 X11 事件](http://mtoader.blogspot.com/2005/02/you-want-recording-x11-event-recording.html)，这可能会让你半途而废。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-09T21:22:08.797

你可以`x11vnc`在你想控制的 X 服务器上启动，然后通过 VNC 控制它。

或者我认为 X11 可以直接模拟事件。你当然可以抓取窗口的内容。查看代码以`xwd`获取获取窗口位图图像的示例。

# windows - 开源 Clearcase 替代品

> ID：1019164
> 
> 赞同：4
> 
> 时间：2009-06-19T17:40:03.703
> 
> 标签：windows, svn, workflow, clearcase, dvcs

我正在帮助为一个新程序设置 SCM，我们目前正在决定一个 VCS。

此时的主要竞争者是 SVN、ClearCase、SVN+DVCS，而且只是一个 DVCS。

目前，该团队倾向于 SVN 或 SVN+DVCS。我们希望避免 ClearCase 的费用和管理成本，但希望它提供的工作流程和版本控制选项。我也提出了使用 DVCS 的选项，并且正在考虑这个想法。

对于 DVCS，我们正在考虑 Mercurial、Bazaar 和 Git。团队对 SVN 感到满意，但不认为它会提供所需的多功能性，这就是我们在 SVN 选项之上考虑 DVCS 的原因。

有没有人有任何建议（例如现有的工具、流程）来进行这样的设置？

担忧包括：

*   易于设置
*   设置工作流程（开发 <-> 代码审查 -> 测试 -> 主干，然后是主干 -> 集成测试分支 -> 将错误修复放入发布分支的发布），审计（发现错误，何时引入）
*   生成指标
*   用于习惯 ClearCase 的开发人员的合理学习曲线。
*   视窗开发
*   问题跟踪器集成（可能会是 Redmine，虽然它不是一成不变的）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-19T17:51:20.880

作为 ClearCase 的管理员，除非您有复杂的合并工作流程，否则我会排除该工具。

您提到的**[工作流程](https://stackoverflow.com/questions/216212#216228)**涉及能够轻松分支、修复然后合并回来，这不应该有利于 SVN。

当您习惯使用 ClearCase（尤其是非 UCM ClearCase）时，最大的陷阱是配置规范的“组合”。
如果您选择 DVCS（Mercurial、Bazaar 或 Git，因为它[在 Windows 上运行得非常好](https://stackoverflow.com/questions/783906/git-under-windows-msys-or-cygwin)），您将[*无法*获得相同的“继承效果”——（当您选择具有不同连续选择规则的不同版本时—— -](https://stackoverflow.com/questions/763099/flexible-vs-static-branching-git-vs-clearcase-accurev)：如该答案所述：

> 在纯粹的中央 VCS 中，您可以使用任何您想要的规则来定义您的工作区（在 ClearCase 中，您的“视图”快照或动态）。
> 这在 DVCS 中是不切实际的（如在“分布式”中）：当您使用它创建分支时，您需要在起点和内容明确定义并轻松复制到其他存储库的情况下这样做。

如果您使用 ClearCase UCM，这意味着识别一致的文件集，这只能通过 - 例如 - [Git submodules](https://stackoverflow.com/questions/932586/middle-ground-between-submodules-and-branches)来实现。
这些 DVCS 的复杂性更高，因为它们不像 ClearCase UCM 那样记录模块（或“文件集”）之间的依赖关系。

所以，回顾一下：

*   易于设置：所有提到的 DVCS 都易于设置。必须考虑的是用户访问方面的管理。
*   设置工作流程：DVCS 支持任何类型的工作流程，甚至是集中式工作流程，或公私合营的工作流程，或者.... 关于发现错误，它们都支持某种[平分流程](https://stackoverflow.com/questions/959324/finding-bugs-by-bisecting-searching-revision-history-and-untestable-commits-r)。
*   生成指标：如果你的意思是“关于托管代码的指标”，它们都支持一些完整的日志系统，能够显示关于已更改内容的大量信息。
    但就“关于工具的指标”（进程的速度或数据占用的空间）而言，提到的 DVCS 工具被认为比 SVN 快得多（参见[此处作为示例](http://cafenate.wordpress.com/2008/05/21/more-subversion-vs-mercurial-metrics/)）。
*   习惯于 ClearCase 的开发人员的合理学习曲线：GUI 可以成为缓解学习曲线的一个因素，但 DVCS 与 ClearCase 非常不同，正如这个“[核心概念](https://stackoverflow.com/questions/645008#645771)”答案所示。
*   Windows 开发：它们都在 Windows 平台上运行良好，可能对 Mercurial 或 Bazaar 有一点优势（更好的集成）。
*   问题跟踪器集成（可能会是 Redmine，尽管它不是一成不变的）：Redmine 现在支持其中的大多数（而不是像一开始那样只支持 SVN）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T17:56:29.877

Git有什么问题？我现在在 Windows 上使用 Git。它工作得很好。 如果您想要一些资源管理器集成，如果这是您的问题，[Git Extensions非常有用。](http://sourceforge.net/projects/gitextensions/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T18:16:19.330

我没有使用 clearcase 的经验，但希望以下内容会有所帮助。您的问题遗漏了我在决定之前会考虑的几条信息。首先，您将拥有多少源代码？虽然 SVN 非常适合大中型项目，但对于像 Linux 内核这样的真正大型项目，Git 将提供更好的性能。其次，您使用的是什么 IDE？虽然 Mercurial、Git 和 SVN 都有 Visual Studio 和 Eclipse 插件，但它们的质量非常好。根据有关 Redmine 的 Wikipedia 文章，您正在查看的任何 SCM 系统都将集成。以下博客可能对您有所帮助，因为它写了一个以编写 SCM 系统为生的人。 [http://www.ericsink.com/](http://www.ericsink.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-02-25T15:49:23.103

如果您可以放弃它需要在 Windows 上运行的要求，那么我建议您查看 [Aegis](http://aegis.sourceforge.net)。

# php - 如何使用 PHP 检查一个单词是否包含在另一个字符串中？

> ID：1019169
> 
> 赞同：67
> 
> 时间：2009-06-19T17:41:14.433
> 
> 标签：php, string

伪代码

```
text = "I go to school";
word = "to"
if ( word.exist(text) ) {
    return true ;
else {
    return false ;
} 
```

我正在寻找一个 PHP 函数，如果该单词存在于文本中，则该函数返回 true。

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2009-06-19T17:57:39.670

根据您的需要，您有几个选择。对于这个简单的例子，`strpos()`可能是最简单直接的函数了。如果您需要对结果做一些事情，您可能更喜欢`strstr()`或`preg_match()`。如果您需要使用复杂的图案而不是细绳作为针，您将需要`preg_match()`.

```
$needle = "to";
$haystack = "I go to school"; 
```

[strpos() 和 stripos()](http://us.php.net/strpos)方法（stripos() 不区分大小写）：

```
if (strpos($haystack, $needle) !== false) echo "Found!"; 
```

[strstr() 和 stristr() 方法](http://us.php.net/strstr)（stristr 不区分大小写）：

```
if (strstr($haystack, $needle)) echo "Found!"; 
```

[preg_match 方法](http://us.php.net/preg_match)（正则表达式，更灵活但运行速度较慢）：

```
if (preg_match("/to/", $haystack)) echo "Found!"; 
```

因为您要求一个完整的函数，所以这就是您将它放在一起的方式（针和干草堆的默认值）：

```
function match_my_string($needle = 'to', $haystack = 'I go to school') {
  if (strpos($haystack, $needle) !== false) return true;
  else return false;
} 
```

PHP 8.0.0 现在包含一个 str_contains 函数，其工作方式如下：

```
if (str_contains($haystack, $needle)) {
    echo "Found";
} 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-06-19T22:52:30.833

```
function hasWord($word, $txt) {
    $patt = "/(?:^|[^a-zA-Z])" . preg_quote($word, '/') . "(?:$|[^a-zA-Z])/i";
    return preg_match($patt, $txt);
} 
```

如果 $word 是“to”，这将匹配：

*   “听我说”
*   “到月球”
*   “最新的”

但不是：

*   “一起”
*   “进入太空”

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-06-19T17:46:15.723

利用：

```
return (strpos($text,$word) !== false); //case-sensitive 
```

或者

```
return (stripos($text,$word) !== false); //case-insensitive 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-19T17:44:52.137

[strpos](http://www.php.net/manual/en/function.strpos.php)

```
<?php
$text = "I go to school";
$word = "to"
$pos = strpos($text, $word);

if ($pos === false) {
    return false;
} else {
    return true;
}
?> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-19T17:45:35.663

```
$text="I go to school";
return (strpos($text, 'to')!== false); 
```

[您需要找到正确使用 strpos 的手册页](http://www.php.net/strpos)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-19T17:47:19.543

另一种方法（除了已经给出的 strpos 示例之外是使用“strstr”函数：

```
if (strstr($haystack, $needle)) {
   return true;
} else {
   return false;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-08-27T17:03:07.863

**PHP 8 新函数 str_contains**

```
if (str_contains('Foo Bar Baz', 'Foo')) {
  echo 'Found';
} 
```

**或者**

`strpos`在 php 中使用函数。

```
$text = "I go to school";
$word = "to"
if (strpos($text,$word) !== false ) {
    echo 'true';
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-03-15T12:05:45.170

您可以使用这些字符串函数，

[strstr](http://www.php.net/manual/en/function.strstr.php) — 查找第一次出现的字符串

[strstr](http://www.php.net/manual/en/function.stristr.php) - 不区分大小写的 strstr()

[strrchr](http://www.php.net/manual/en/function.strrchr.php) — 查找字符串中最后一次出现的字符

[strpos](http://www.php.net/manual/en/function.strpos.php) — 查找字符串中子字符串第一次出现的位置

[strpbrk](http://www.php.net/manual/en/function.strpbrk.php) — 在字符串中搜索任何一组字符

如果那没有帮助，那么您应该使用`preg`正则表达式

[preg_match](http://www.php.net/manual/en/function.preg-match.php) — 执行正则表达式匹配

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2011-06-13T08:58:05.007

## @mrclay

不能'我们只是做

```
"/(?:^|\w+)" . preg_quote($word, '/') . "(?:$|\w+)/i" 
```

以便它检查开始或空白，以及结束或空白。

# objective-c - 为自定义 Obj-C 对象创建 Xcode 数据格式化程序包

> ID：1019172
> 
> 赞同：5
> 
> 时间：2009-06-19T17:41:43.640
> 
> 标签：objective-c, xcode, chdatastructures, data-formatters

为了帮助简化 Xcode 调试器窗口中[一些自定义 Objective-C 对象](http://cocoaheads.byu.edu/code/CHDataStructures)的调试，我使用[相关的 Apple 文档](http://developer.apple.com/documentation/DeveloperTools/Conceptual/XcodeDebugging/220-Viewing_Variables_and_Memory/variables_and_memory.html)和 Xcode 的内置数据格式化程序作为指南，为每个对象创建了一组数据格式化程序字符串。

[如果我将自定义摘要字符串](http://dysart.cs.byu.edu/chsvn/trunk/resources/CHDataStructuresFormatters.plist)与 Xcode 附带的数据格式化程序一起放在**/Developer/Library/Xcode/CustomDataViews/中，我的自定义摘要字符串会很好用。**但是，我宁愿不这样做，因为用户可能没有对该目录的写入权限，并且将自定义格式化程序与内置格式化程序混合可能会造成混淆。同样，将我自己的条目添加到**~/Library/Application Support/Apple/Developer Tools/CustomDataViews/CustomDataViews.plist**也可以，但是该文件用于覆盖默认值的用户定义值，并且它的条目被Xcode 调试器 GUI。我真正想要的是能够将带有我的数据格式化程序的文件放在一个位置，以便 Xcode 识别它们，但如果需要，用户仍然可以选择性地覆盖我的设置（在另一个文件中）。

问题是，当我创建一个包（按照[这个 Apple 示例代码](http://developer.apple.com/samplecode/WcharDataFormatter/)的示例）并安装它（在**/Developer/Library/Xcode/CustomDataViews/**或任何**Library/Application Support/Apple/Developer Tools/CustomDataViews/**路径中） , Xcode 无法识别或使用自定义格式化程序。

关于数据格式化程序包细节的文档有点少（主要是**Xcode.app/Contents/PlugIns/GDBMIDebugging.xcplugin**中的单个头文件），可能是因为该功能不是 Xcode 的主要功能之一。;-） 任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-08T05:14:26.383

我最近能够回到这个问题上，我相信我已经找到了答案。

我已经知道数据格式化程序包必须在内部包含属性列表文件，名为“ **Contents/Resources/*.plist** ”。但是，要使包真正工作，**它还必须在****Contents/MacOS/**目录中包含一个与包同名的可执行文件。据我所知，`foo.c`只要您编译和链接二进制文件，即使是一个完全空的文件也足够了。我什至不必在 Xcode 中为股票 CFPlugin Bundle 项目触摸 Info.plist，只需在目标资源中包含 CustomDataViews.plist。

Since I don't need to define C functions to display any of the objects and structs I'm dealing with, the far easier approach is to just put the plist file (any name will do — mine is `CHDataStructures.plist`) into one of two locations:

*   `~/Library/Application Support/Developer/Shared/Xcode/CustomDataViews/`
*   `/Library/Application Support/Developer/Shared/Xcode/CustomDataViews/`

Simple plist files are smaller, trivial to create, and easier to modify. Also, unlike when using bundles, I didn't have to relaunch Xcode when I added, removed, or modified the plist; just starting a new debugging session was sufficient to cause new the data formatters to be updated. I think I was only creating a bundle because that's what the sample code showed, but I can't determine any advantages for my scenario, so I'm sticking with the plist.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T18:35:27.333

从 Xcode 2.5 和 3.0 开始，这些东西的位置已经改变，以支持多个版本的 Xcode 在一个系统上共存。您应该将自定义数据格式化程序放入`Library/Application Support/Developer/Shared/CustomDataViews`本地 ( `/`) 或用户 ( `~`) 域中的目录 " "；那么它们应该在您下次启动 Xcode 时可用。

上面路径中的`Shared`可以是版本号，例如，`3.0`如果`3.1`您正在创建特定于特定 Xcode 版本的内容。

# reporting-services - 打印机交付扩展和空报告

> ID：1019175
> 
> 赞同：2
> 
> 时间：2009-06-19T17:43:03.590
> 
> 标签：reporting-services, reportingservices-2005

我已经基于 SSRS 2005 中的 MS 示例实现了打印机交付扩展。

一切正常，但是，当数据集为空时我遇到了问题。我得到一个空白页。如果没有数据，我宁愿不将作业发送到打印机。

任何人对此有任何经验或想法如何解决我的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-08T22:36:20.720

我通过使用其他人建议的技术解决了这个问题。不幸的是，我现在找不到那个帖子来给予他们适当的信任。

我的解决方案是设置一个数据驱动订阅，传递我拥有的唯一参数（打印机名称）。订阅中使用的查询与报告中的键表连接，因此如果没有数据，则没有打印机可打印，因此不会发生任何事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T23:00:33.923

也许运行 sql 来获取行数，如果它不为零则只打印？

# winforms - 在 Windows 窗体上使用组框而不是面板的设计原因是什么？

> ID：1019196
> 
> 赞同：9
> 
> 时间：2009-06-19T17:46:39.950
> 
> 标签：winforms, user-controls

所以我正在设计一个带有窗口形式的控件。我想将一些控件与标题组合在一起。所以我自然会选择 GroupBox。但是，使用面板是否有一些优势？对于那些对表单设计还有些陌生的人来说，这不是立即显而易见的吗？还有一些“陷阱”怎么样。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-19T17:52:09.273

面板的一些优点：

*   可滚动
*   很多边框样式选项。

GroupBox 的一个优点：

*   组标题

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T17:50:40.460

组框可能有标题，而面板可能没有。面板可能有滚动条，而组框可能没有。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T17:51:36.137

另请注意，groupbox 不可滚动

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T17:54:10.083

组框仅提供容器范围的图形轮廓，并在顶部提供标题。面板可以自动滚动其内容，而如果没有某种形式的干预，组框将无法滚动（组框内的面板）。

[http://bytes.com/groups/net-c/251762-panel-v-groupbox](http://bytes.com/groups/net-c/251762-panel-v-groupbox)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T17:59:25.003

Panel 控件类似于 GroupBox 控件；但是，只有 Panel 控件可以有滚动条，并且只有 GroupBox 控件显示标题。

GroupBox 和 Panel 的边框样式也不同

在大多数情况下，当您想要对多个控件进行分组并为整个组应用锚点或 Dock 时，会使用面板。

很少有面板有边框。如果你喜欢一组控件周围的标题和边框，使用 GroupBox 会更自然。

# python - 如何使用 Python 的内置 .csv 编写器模块替换列？

> ID：1019200
> 
> 赞同：1
> 
> 时间：2009-06-19T17:47:56.300
> 
> 标签：python, file-io, csv

我需要在一个巨大的 Excel .csv 文件中进行查找和替换（特定于一列 URL）。由于我正处于尝试自学脚本语言的开始阶段，我想我会尝试在 python 中实现该解决方案。

我在解决方案的“替换”部分遇到问题。我已经阅读了有关如何使用编写器的[官方 csv 模块文档](http://docs.python.org/library/csv.html)，但是对我来说并没有一个足够清晰的例子（是的，我很慢）。那么，现在的问题是：如何使用 writer 对象遍历 csv 文件的行？

ps为笨拙的代码提前道歉，我还在学习:)

```
import csv

csvfile = open("PALTemplateData.csv")
csvout = open("PALTemplateDataOUT.csv")
dialect = csv.Sniffer().sniff(csvfile.read(1024))
csvfile.seek(0)
reader = csv.reader(csvfile, dialect)
writer = csv.writer(csvout, dialect)

total=0;
needchange=0;
changed = 0;
temp = ''
changeList = []

for row in reader:
    total=total+1
    temp = row[len(row)-1]
    if '/?' in temp:
        needchange=needchange+1;
        changeList.append(row.index)

for row in writer:           #this doesn't compile, hence the question
    if row.index in changeList:
        changed=changed+1
        temp = row[len(row)-1]
        temp.replace('/?', '?')
        row[len(row)-1] = temp
        writer.writerow(row)

print('Total URLs:', total)
print('Total URLs to change:', needchange)
print('Total URLs changed:', changed) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T18:01:33.473

您收到错误的原因是编写器没有要迭代的数据。你应该给它数据 - 大概，你会有某种列表或生成器来生成要写出的行。

我建议将这两个循环结合起来，如下所示：

```
for row in reader:
    row[-1] = row[-1].replace('/?', '?')
    writer.writerow(row) 
```

有了这个，你甚至不需要`total`,`needchange`和`changeList`. （其中有很多优化，遗憾的是我没有时间解释，但我会看看我是否可以稍后编辑这些信息）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T18:02:16.480

您应该只有一个循环并同时读取和写入 - 如果您的替换一次只影响一行，您不需要循环两次数据。

```
for row in reader:
  total=total+1
  temp = row[len(row)-1]
  if '/?' in temp:
    temp = row[len(row)-1]
    temp.replace('/?', '?')
    row[len(row)-1] = temp
  writer.writerow(row) 
```

这只是为了说明循环，不确定替换代码是否会像这样工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-21T15:10:01.587

将 csv 放入大列表后，替换列表中列的一种简单方法是转置矩阵，替换行，然后将其转回：

```
mydata = [[1, 'a', 10], [2, 'b', 20], [3, 'c', 30]]

def transpose(matrix):
    return [[matrix[x][y] for x in range(len(matrix))] for y in range(len(matrix[0]))]

transposedData = transpose(mydata)
print transposedData
>>> [[1, 2, 3], ['a', 'b', 'c'], [10, 20, 30]]

editedData = transposedData[:2] + [50,70,90]
print editedData
>>> [[1, 2, 3], ['a', 'b', 'c'], [50, 70, 90]]

mydata = transpose(editedData)
print mydata
>>> [[1, 'a', 50], [2, 'b', 70], [3, 'c', 90]] 
```

# c# - 如何根据用户角色操作 WPF GUI

> ID：1019204
> 
> 赞同：10
> 
> 时间：2009-06-19T17:48:21.773
> 
> 标签：c#, wpf, security, xaml, identity

我正在使用 .NET 的 IIdentity 和 IPrincipal 对象来实现基于角色的安全性，并且我正在根据当前用户拥有的角色修改显示的控件。

我的问题是在 WPF 窗口中启用/禁用字段的推荐方法是什么 - 显示/隐藏依赖于 IIdentity.IsInRole 类型调用的字段。

这可以在 XAML 中完成，还是我必须将其抽象为代码，而我认为后面的代码有点混乱；

```
this.txtUserName.IsReadOnly = !MyPrincipal.CurrentPrincipal.IsInRole("Administrator");
this.mnuCreateUser.Visibility = MyPrincipal.CurrentPrincipal.IsInRole("Administrator");
 ? Visibility.Hidden : Visibility.Visible; 
```

（注意；我的代码在执行函数时检查角色，我要做的是根据角色修改 GUI，因此用户看不到/看到他们无权访问的只读元素）

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-06-19T22:24:09.097

尽管以前的答案会起作用，但对我来说，检测逻辑对象中的可见性看起来并不难看。我会为此使用转换器...

```
<Control Visibility={Binding Path=CurrentPrincipal, Converter={StaticResource RoleToVisibilityConverter}, ConverterParameter=Administrator}/> 
```

然后是转换器本身

```
public class RoleToVisibilityConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        var principal = value as Principal;
        if(principal != null) {
            return principal.IsInRole((string)parameter) ? Visibility.Visible : Visibility.Collapsed;
        }

        return null;
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
         throw new NotImplementedException();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T18:06:08.707

```
<Control Visibility={Binding ElementName=ThisWindow, Path=AdministratorVisibility, Mode=OneWay}/> 
```

在您的 C# 代码中：

```
public Visibility AdministratorVisibility
{
    get 
    { 
        MyPrincipal.CurrentPrincipal.IsInRole("Administrator") ? Visibility.Hidden : Visibility.Visible; 
    }
} 
```

你可以做同样的事情来实现`IsReadOnly`. 如果用户的角色可以改变（我不确定这些用户角色是如何工作的），您可以实现`INotifyPropertyChanged`and do `NotifyPropertyChanged("AdministratorVisibility")`，否则您可能会更改`BindingMode`to`BindingMode.OneTime`并跳过实现通知。

这可能并不比你已经在做的好很多，但它可能和你将要得到的一样好。

# java - boolean.class？

> ID：1019208
> 
> 赞同：8
> 
> 时间：2009-06-19T17:48:45.550
> 
> 标签：java

前几天我注意到我可以调用 boolean.class，但不能调用 integer.class（或其他原语）。是什么让布尔值如此特别？

注意：我说的是 boolean.class，而不是 Boolean.class（这是有道理的）。

Duh：我尝试了 integer.class，而不是 int.class。我不觉得愚蠢吗：\

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-19T17:57:13.120

不是`integer.class`但是`int.class`。是的你可以。JRE 6：

```
public class TestTypeDotClass{
    public static void main(String[] args) {
        System.out.println(boolean.class.getCanonicalName());
        System.out.println(int.class.getCanonicalName());
        System.out.println(float.class.getCanonicalName());
        System.out.println(Boolean.class.getCanonicalName());
    }
} 
```

输出

```
boolean
int
float
java.lang.Boolean 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-19T17:52:01.770

你可以做到`int.class`。它给出了相同的`Integer.TYPE`。

`int.class.isPrimitive()`, `boolean.class.isPrimitive()`,`void.class.isPrimitive()`等，将给出 的值`true`。`Integer.class.isPrimitive()`,`Boolean.class.isPrimitive()`等，将给出 的值`false`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-19T17:53:06.107

那么你也可以做类似`int.class`的事情

```
System.out.println(int.class); 
```

Java 1.1 引入了 .class 关键字，以便以一致的方式获取类类型和原始数据类型的类对象。

[类：Java 词汇表](http://mindprod.com/jgloss/class.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-19T17:54:21.237

布尔值并不特别。你可以打电话

```
int.class 
```

例如。所有原始类型都有这个字面量。来自 Sun 的[教程](http://www.j2ee.me/docs/books/tutorial/java/nutsandbolts/datatypes.html)：

> 最后，还有一种特殊的字面量，称为类字面量，由类型名称和附加“.class”组成；例如，String.class。这指的是表示类型本身的对象（Class 类型）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-12-08T20:34:49.413

也许是愚蠢的延续，但是为什么可以将 boolean.class 分配给 Class<Boolean>，尽管 hashCodes 不同？

```
final Class<Boolean> c = boolean.class;     
System.out.println("c := "+c);
System.out.println("boolean.class := "+boolean.class);
System.out.println("Boolean.class := "+Boolean.class);
System.out.println("boolean.class == Boolean.class := "+(boolean.class == Boolean.class));
System.out.println("boolean.class.equals(Boolean.class) := "+boolean.class.equals(Boolean.class));
System.out.println("boolean.class.hashCode := "+boolean.class.hashCode());
System.out.println("Boolean.class.hashCode := "+Boolean.class.hashCode()); 
```

# exception - 在 PowerShell 中进行错误处理的正确方法是什么？

> ID：1019213
> 
> 赞同：7
> 
> 时间：2009-06-19T17:50:45.873
> 
> 标签：exception, powershell, error-handling

PowerShell 是 .bat 和 .NET 的奇怪组合。在 .bat 中，您检查命令的错误级别和标准错误输出。在 .NET 中，您可以捕获异常。

cmdlet 如何返回错误？他们失败时会抛出异常还是设置$？反而？这是可配置的吗？

我还假设我在 PowerShell 中调用的 .NET 函数将始终抛出异常，并且不会被 shell 自动捕获并转换为错误。那是对的吗？

也许我真正应该问的是：一篇涵盖所有这些的好文章是什么？似乎有很多像我一样在 cmd 的 .bat 和 .NET 方面有经验的工程师都想知道我们应该如何在这个勇敢的 Posh 新世界中做事。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-19T23:42:28.440

对于单个 cmdlet，有一个名为 -erroraction 的参数。可能的值为 SilentlyContinue、Stop、Continue 或 Inquire。您还可以为这些选项中的任何一个指定一个名为 $errorpreference 的全局变量。

在 V1 中，您可以使用 trap 关键字。有一篇[非常好、简洁的文章](http://blogs.msdn.com/powershell/archive/2009/06/17/traps-vs-try-catch.aspx)描述了陷阱和在 V2 中添加的 try/catch/finally 语法之间的主要区别。

这是一个使用陷阱语句的快速示例，第一个是针对特定类型的异常，第二个是通用的捕获所有错误陷阱

```
trap {"Other terminating error trapped" }
trap [System.Management.Automation.CommandNotFoundException] 
      {"Command error trapped"}
1/$null 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T19:53:34.487

我认为 Posh 就是 .Net。大多数适用于 .Net 的概念应该适用于 Posh。

对于错误处理，您可以使用 Try..catch。也可以“捕获”错误并指定您自己的一组指令以在错误条件下执行。

我强烈推荐内置帮助：

```
Get-Help about_Errors
Get-Help about_Trap 
```

# asp.net - 加载图像或将图像保存到服务器对服务器负载有多大影响？

> ID：1019217
> 
> 赞同：0
> 
> 时间：2009-06-19T17:51:36.340
> 
> 标签：asp.net, security, optimization, image

如果一次（或在一段时间内）从服务器加载太多图像，它会减慢用户的网站速度吗？

将图像保存到服务器怎么样？

对服务器施加很大压力的网站是否会使网站更容易受到 DOS 攻击？

如果我们的网站需要保存和加载大量图片，有什么办法可以减少服务器负载以确保网站不会变慢？

**编辑：**只是为了测量，这可能有点过分夸大了，但我只是想知道一个想法......假设每小时有 10000 张图像，大小约为 700kb - 1MB

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T18:01:10.570

您可以尝试构建 CDN（内容交付网络）之类的。将它们指向一个或多个服务器以进行上传处理。

处理文件并将它们复制到文件服务器集群 (CDN)

然后返回一个指向只提供文件的 CDN 服务器的链接。

## 奖励场景：

让您的内容由与处理数据的服务器不同的服务器提供服务，这样您就可以关闭处理服务器，并且仍然让内容服务器运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T17:54:41.627

图片有多大？你要处理多少？这会给网络服务器带来压力，也需要带宽。至于压力的程度，不知道更多信息是不可能说的。

如果您想减少对您网站的影响，请将网站放在与图像处理服务器不同的服务器上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T18:00:03.880

提供图像与其说是 CPU/存储需求，不如说是带宽需求。您不太可能负担得起足够的带宽来提供足够的图像以使服务器停机。

我见过的一个合理的解决方案是使用单独的媒体服务器，在您的应用程序或站点中可配置基本 URL。这样，您可以从 Internet 上其他地方的不同主机协商不同的带宽速率，而不必担心该主机是否支持您用于开发应用程序的技术。ASP.net Web 托管往往比 vanilla linux 托管贵得多，并且需要对服务器环境进行更多控制。使用 Rich Guy Feature Hosting, LLC 托管您的 ASP.net 应用程序，并使用 Destitute Nerd Basic Hosting, Inc. 托管您的图像服务器，因为它所做的只是提供愚蠢的文件。

您还可以联系[Akamai](http://www.akamai.com/)等内容缓存提供商为您托管和缓存您的图像。他们在地理上分发您的图像，以便用户从物理上更接近他们所在位置的服务器获取您的图像。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T18:00:05.470

从 Web 服务器加载图像基本上与从 Web 服务器加载任何其他文件没有什么不同。从这个意义上说，是的，加载太多图像可能会减慢服务器速度，和/或导致 DOS，但这不是因为您正在使用图像，而是因为您正在达到 Web 服务器的最大吞吐量。（上次我玩弄 IIS Web 服务器时，在一个缓慢的应用程序上，它可以处理 >160 个请求/秒；如果它只加载静态文件，它可能会做更多的事情）

如果您担心应用程序服务器上的负载图像，您可以考虑将静态内容移动到不同的服务器；说 images.mydomain.com 与 mydomain.com 在不同的机器上。

另一个注意事项；如果图像都是图标的形式——通常是小尺寸的，你可以查看一个 css sprite-sheet，例如从 20 个特定于图像的 HTTP GET 到 ~1。

对编辑的回应：10,000 张图像/小时，每张 700k 大约是 2-3/秒（不考虑差异），这使您需要几 mbps 的上传带宽。以这种速度，您可能希望它在不同的服务器上；在负载平衡的集群上；或在 CDN 上。以这种速度，CPU 处理的开销不会导致 DOS 更快，但带宽限制可能会。

# architecture - 技术设计文件的工具和标准

> ID：1019222
> 
> 赞同：7
> 
> 时间：2009-06-19T17:52:58.680
> 
> 标签：architecture

我想知道我的同事现在使用哪些工具和标准来编写技术设计文档。

过去，在我的公司，我们只提供客户端-服务器双赢应用程序，我们的设计文档有文字模板。我们的模板总是从数据库图表开始，然后是 UI 模型、字段映射、功能描述等……有了 Word 和 Visio，我们已经受够了。但最近我们正在结合 Wiki、UML 图、原型工具等……没有真正强有力的标准和工具政策。您认为让建筑师在每个项目的特定时刻自由选择他们认为合适的工具和标准集是好的，还是公司应该强制执行和标准化这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T17:57:53.057

在我看来，主要开发人员或团队成员之间的彻底讨论（可能会记录下来以备后用）比任何文件都更有价值。给他们选择工具的所有自由，并要求他们只在早期写一个关于高级技术决策的简短摘要。这可以成为项目后期文档的基础。技术设计文档很快就会过时并且需要花费太多时间来编写。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T18:10:27.577

我认为应该有一套在架构时指定的工具和标准来描述应该如何记录设计。有一个标准来记录这些东西是非常重要的。否则，他们往往会半途而废；如果设计文档是异构的，那么真正需要最了解设计的人可能无法在他们真正需要的时候找到他们真正需要的设计信息。

也就是说，工具和标准的选择完全取决于每个不同的组织。任何对组织有用的东西都适合他们。只要标准（在某种程度上和工具）保持一致，为单个组织选择的任何东西都适合他们。它只需要决定并执行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T18:25:15.570

任何设计文档背后的原因都是与所有相关人员进行清晰的沟通。因此，从这个角度来看，无论您作为架构师选择什么工具，最终产品都需要现在由所有相关人员阅读，然后由维护人员阅读。因此，至少选择一些相当标准的工具是有意义的，这些工具在几年内仍然存在。

也就是说，设计文档通常用于启动项目或系统。此后记录良好的代码和一些基本文档就足够了。我可能会更加关注文档的组织，以便人们将来可以轻松找到他们正在寻找的内容。它可以帮助强制执行某种标准的存储库结构/系统来存储文档，但不一定坚持使用各种模板来存储文档。关注内容而不是工具。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T17:56:59.657

除非您的项目是千篇一律的，否则只有为手头的工作应用最佳工具组合才有意义。也就是说，可能需要一些松散（粗略的指导方针）或狭窄的（适用于特定情况）标准。

# json - 任何用于在 Classic ASP 中解析 JSON 的好库？

> ID：1019223
> 
> 赞同：77
> 
> 时间：2009-06-19T17:53:00.677
> 
> 标签：json, asp-classic, vbscript

我已经能够找到用于在 Classic ASP (VBScript) 中**生成**JSON 的无数库，但我还没有找到任何用于**解析**的库。

我想要一些可以传递 JSON 字符串并取回某种 VBScript 对象（数组、Scripting.Dictionary 等）的东西

### 谁能推荐一个在经典 ASP 中解析 JSON 的库？

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2009-06-20T15:28:53.717

请记住，Classic ASP 包括 JScript 和 VBScript。有趣的是，您可以使用 JScript 解析 JSON 并直接在 VBScript 中使用生成的对象。

因此，可以在零修改的服务器端代码中使用规范的[https://github.com/douglascrockford/JSON-js/blob/master/json2.js 。](https://github.com/douglascrockford/JSON-js/blob/master/json2.js)

当然，如果您的 JSON 包含任何数组，则在解析完成后，这些数组仍将保留为 JScript 数组。您可以使用点表示法从 VBScript 访问 JScript 数组的内容。

```
<%@Language="VBScript" %>
<%
Option Explicit
%>

<script language="JScript" runat="server" src='path/to/json2.js'></script>

<%

Dim myJSON
myJSON = Request.Form("myJSON") // "[ 1, 2, 3 ]"
Set myJSON = JSON.parse(myJSON) // [1,2,3]
Response.Write(myJSON)          // 1,2,3
Response.Write(myJSON.[0])      // 1
Response.Write(myJSON.[1])      // 2
Response.Write(myJSON.[2])      // 3
%> 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-06-19T18:17:29.327

不确定。你检查过支持 JSON 的[ASP 极端框架吗？](http://framework.lojcomm.com.br/app/docs/files/app/core/lib/json-class-asp.html)

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2010-06-08T14:44:18.767

我无法让极端进化或 Chris Nielson 的建议发挥作用。但是，以下确实对我有用：

[http://tforster.wik.is/ASP_Classic_Practices_For_The_21st_Century/JSON4ASP](http://tforster.wik.is/ASP_Classic_Practices_For_The_21st_Century/JSON4ASP)

将以下内容下载为“json2.min.asp”

[http://tforster.wik.is/@api/deki/files/2/=json2.min.asp](http://tforster.wik.is/@api/deki/files/2/=json2.min.asp)

将以下行添加到 ASP 文件的顶部：

```
<script language="javascript" runat="server" src="json2.min.asp"></script> 
```

然后，您可以在 ASP 中使用 JSON。

```
 Dim car: Set car = JSON.parse("{""brand"":""subaru"",""model"":""outback sport"",""year"":2003," & _
                                 """colour"":""green"",""accessories"":[" & _
                                 "{""foglamps"":true},{""abs"":true},{""heatedSeats"":true}]}")

   Response.Write("brand: " & car.brand & "<br/>")                               
   Response.Write("model: " & car.model & "<br/>")                               
   Response.Write("colour: " & car.colour & "<br/>")                               
   Response.Write("has foglamps: " & CStr(car.accessories.get(0).foglamps) & "<br/>")                               

   car.accessories.get(0).foglamps = false
   Response.Write("has foglamps: " & CStr(car.accessories.get(0).foglamps) & "<br/>")                               
   Response.Write("new Json: " & JSON.stringify(car) & "<br/>")

   Set car = Nothing 
```

注意：要解析一组项目，您需要执行以下操作：

```
 for each iTmp in testing
       if (TypeName(iTmp))<>"JScriptTypeInfo" then 
           Response.Write("Item: " &  iTmp & "<br/>")
       end if
   next 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-05-07T03:24:13.940

我最近实现了一个[**VbsJson**](http://demon.tw/my-work/vbs-json.html#code)类，它具有将JSON 解析为 VBScript的“**解码**”方法和从 VBScript 生成 JSON的“**编码”方法。**代码有点长，这里就不贴了。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-01-23T21:23:50.510

当我在寻找一个轻量级的纯 VBScript 解决方案时，我写了这个答案。

通过将基本的 JSON 到 XML 转换器放在一起，我们可以遍历 JSON 字符串并将其转换为 Microsoft.XMLDOM 文档。

从那里，我们使用 Microsoft 的 XML API（包括 XPath 查询）来提取我们想要的任何值。

这处理简单的 JSON，但是，我从未打算将这个答案用于更复杂的事情。

对于更强大的解决方案，最好的 JSON 解释器是适当的 Javascript 引擎。因此，我强烈推荐这个问题的公认答案，即[在 Classic ASP 中解析 JSON 的任何好的库？](https://stackoverflow.com/questions/1019223/any-good-libraries-for-parsing-json-in-classic-asp/1021848#1021848)

```
Function JSONtoXML(jsonText)
  Dim idx, max, ch, mode, xmldom, xmlelem, xmlchild, name, value

  Set xmldom = CreateObject("Microsoft.XMLDOM")
  xmldom.loadXML "<xml/>"
  Set xmlelem = xmldom.documentElement

  max = Len(jsonText)
  mode = 0
  name = ""
  value = ""
  While idx < max
    idx = idx + 1
    ch = Mid(jsonText, idx, 1)
    Select Case mode
    Case 0 ' Wait for Tag Root
      Select Case ch
      Case "{"
        mode = 1
      End Select
    Case 1 ' Wait for Attribute/Tag Name
      Select Case ch
      Case """"
        name = ""
        mode = 2
      Case "{"
        Set xmlchild = xmldom.createElement("tag")
        xmlelem.appendChild xmlchild
        xmlelem.appendchild xmldom.createTextNode(vbCrLf)
        xmlelem.insertBefore xmldom.createTextNode(vbCrLf), xmlchild
        Set xmlelem = xmlchild
      Case "["
        Set xmlchild = xmldom.createElement("tag")
        xmlelem.appendChild xmlchild
        xmlelem.appendchild xmldom.createTextNode(vbCrLf)
        xmlelem.insertBefore xmldom.createTextNode(vbCrLf), xmlchild
        Set xmlelem = xmlchild
      Case "}"
        Set xmlelem = xmlelem.parentNode
      Case "]"
        Set xmlelem = xmlelem.parentNode
      End Select
    Case 2 ' Get Attribute/Tag Name
      Select Case ch
      Case """"
        mode = 3
      Case Else
        name = name + ch
      End Select
    Case 3 ' Wait for colon
      Select Case ch
      Case ":"
        mode = 4
      End Select
    Case 4 ' Wait for Attribute value or Tag contents
      Select Case ch
      Case "["
        Set xmlchild = xmldom.createElement(name)
        xmlelem.appendChild xmlchild
        xmlelem.appendchild xmldom.createTextNode(vbCrLf)
        xmlelem.insertBefore xmldom.createTextNode(vbCrLf), xmlchild
        Set xmlelem = xmlchild
        name = ""
        mode = 1
      Case "{"
        Set xmlchild = xmldom.createElement(name)
        xmlelem.appendChild xmlchild
        xmlelem.appendchild xmldom.createTextNode(vbCrLf)
        xmlelem.insertBefore xmldom.createTextNode(vbCrLf), xmlchild
        Set xmlelem = xmlchild
        name = ""
        mode = 1
      Case """"
        value = ""
        mode = 5
      Case " "
      Case Chr(9)
      Case Chr(10)
      Case Chr(13)
      Case Else
        value = ch
        mode = 7
      End Select
    Case 5
      Select Case ch
      Case """"
        xmlelem.setAttribute name, value
        mode = 1
      Case "\"
        mode = 6
      Case Else
        value = value + ch
      End Select
    Case 6
      value = value + ch
      mode = 5
    Case 7
      If Instr("}], " & Chr(9) & vbCr & vbLf, ch) = 0 Then
        value = value + ch
      Else
        xmlelem.setAttribute name, value
        mode = 1
        Select Case ch
        Case "}"
          Set xmlelem = xmlelem.parentNode
        Case "]"
          Set xmlelem = xmlelem.parentNode
        End Select
      End If
    End Select
  Wend

  Set JSONtoXML = xmlDom
End Function 
```

上述脚本转换以下 JSON：

```
{
  "owningSystemUrl": "http://www.arcgis.com",
  "authInfo": {
    "tokenServicesUrl": "https://www.arcgis.com/sharing/rest/generateToken",
    "isTokenBasedSecurity": true
  }
} 
```

进入：

```
<xml owningSystemUrl="http://www.arcgis.com">
    <authInfo
        tokenServicesUrl="https://www.arcgis.com/sharing/rest/generateToken"
        isTokenBasedSecurity="true" >
    </authInfo>
</xml> 
```

我们现在可以使用 XPath 来提取`tokenServicesUrl`，例如：

```
dom.SelectSingleNode("xml/authInfo").getAttribute("tokenServicesUrl")
' Returns: "https://www.arcgis.com/sharing/rest/generateToken" 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-04-22T13:43:29.997

[http://github.com/nagaozen/asp-xtreme-evolution/](http://github.com/nagaozen/asp-xtreme-evolution/)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-12-13T04:54:16.543

AX 是一个很棒的库，但如果您只需要 JSON 处理功能，它就相当重了。

但是，我确实从 AX 项目中获取了 base.asp 文件和 json.asp 类文件，并成功地使用它们在我的项目中实现了 JSON 解析。

对于 JSON 生成，我发现[aspjson](http://code.google.com/p/aspjson/)更易于集成。它还具有更强大的 json 相关功能。ax 文档有点缺乏，并且需要更多的工作来集成到项目中，但是它在将其 JSON VB 对象序列化回字符串方面做得很好。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-05-07T07:46:34.333

这里的解决方案非常好，但有时有些矫枉过正。如果 JSON 很简单且结构始终相同，您可以自己解析它，它既快速又简单。

```
 'read data from client
 records = Request.Form("records")
 'convert the JSON string to an array
 Set oRegExpre = new RegExp
 oRegExpre.Global = true
 oRegExpre.Pattern = "[\[\]\{\}""]+"
 records = replace(records, "},{","||")
 records = oRegExpre.Replace(records, "" )
 aRecords = split(records,"||")
 'iterate the array and do some cleanup
 for each rec in aRecords
   aRecord = split(rec,",")
   id          = split(aRecord(1),":")(1)
   field       = split(aRecord(0),":")(0)
   updateValue = split(aRecord(0),":")(1)
   updateValue = replace(updateValue,chr(10),"\n")
   updateValue = replace(updateValue,chr(13),"\r")
   updateValue = replace(updateValue,"'","''")
  'etc
next 
```

# c - 远程桌面协议 C 或 Objective-C 库

> ID：1019236
> 
> 赞同：3
> 
> 时间：2009-06-19T17:55:07.180
> 
> 标签：c, objective-c, cocoa, remote-desktop

有谁知道用 C 或非 GPL 的 Objective-C 编写的 RDP 库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-09T03:48:29.380

我是 CoRD 的开发人员，它是一个基于 rdesktop 的 Cocoa RDP 客户端。据我所知，没有松散许可的 RDP 实现。据我所知，rdesktop 是你最好的选择（GPL）。

非常详细的 RDP 协议文档可从 Microsoft 免费获得，但是由于其悠久的历史和无数的添加，从头开始实施它是一个有点困难的协议。它比 RFB 更难实现。

# exception-handling - 为什么 resharper 会说“带有单个 'throw' 语句的 Catch 子句是多余的”？

> ID：1019237
> 
> 赞同：20
> 
> 时间：2009-06-19T17:55:10.097
> 
> 标签：exception-handling, try-catch, resharper, rethrow

我认为抛出异常是一种很好的做法，可以让它冒泡到 UI 或记录异常并通知用户的地方。

为什么 resharper 说它是多余的？

```
try
{
    File.Open("FileNotFound.txt", FileMode.Open);
}
catch
{
    throw;
} 
```

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-06-19T17:58:03.853

因为

```
try {
    File.Open("FileNotFound.txt", FileMode.Open);
} catch {
    throw;
} 
```

没有什么不同

```
File.Open("FileNotFound.txt", FileMode.Open); 
```

如果调用`File.Open(string, FileMode)`失败，那么在任一示例中，完全相同的异常都会到达 UI。

在上面的那个`catch`子句中，您只是捕获并重新抛出异常，而无需执行任何其他操作，例如记录日志、回滚事务、包装异常以向其添加附加信息或任何其他操作。

然而，

```
try {
    File.Open("FileNotFound.txt", FileMode.Open);
} catch(Exception ex) {
    GetLogger().LogException(ex);
    throw;
} 
```

不会包含任何冗余，ReSharper 不应抱怨。同样地，

```
try {
    File.Open("FileNotFound.txt", FileMode.Open);
} catch(Exception ex) {
    throw new MyApplicationException(
        "I'm sorry, but your preferences file could not be found.", ex);
} 
```

不会是多余的。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-06-19T17:56:28.003

因为上面的语句具有与不存在相同的行为。和写法一样：

```
File.Open("FileNotFound.txt", FileMode.Open); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-19T18:00:08.607

因为它是多余的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-19T17:58:08.033

因为 try 中的代码已经在抛出异常。

如果除了重新抛出异常之外，您还打算在 catch 块中执行其他操作时，您只想捕获并重新抛出异常。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T17:58:21.433

你在catch块中没有做任何处理，只是再次抛出了异常。

它会警告您，因为在那里设置 try...catch 块是没有意义的。

另外，另一个很好的提示是“throw ex”不会保留堆栈跟踪，但“throw”会。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-07-23T08:17:55.310

值得注意的是，虽然...

```
try
{
    DoSomething();
}
catch
{
    throw;
} 
```

...是多余的，以下不是...

```
try
{
    DoSomething();
}
catch (Exception ex)
{
    // Generally a very bad idea!
    throw ex;
} 
```

第二个代码片段在我之前继承的几个项目的代码库中很常见，它具有隐藏原始异常堆栈跟踪的讨厌效果。以这种方式抛出刚刚捕获的异常意味着堆栈跟踪的顶部处于该`throw`级别，没有提及`DoSomething`或实际上导致异常的任何嵌套方法调用。

祝你调试代码好运！

# c# - 中继器，自定义分页，PagedDataSource，可能吗？

> ID：1019239
> 
> 赞同：2
> 
> 时间：2009-06-19T17:56:14.917
> 
> 标签：c#, asp.net, paging

嗨，我有一个绑定到 ObjectDataSource 的中继器。我使用 Typed DataSet 检索数据，而我的 TableAdapter 确实根据 startIndex 和 pageSize 查询数据子集。我已经为自定义分页做好了准备，它确实有效。

但是，我想知道我的 TableAdapter 是否可以返回一个 PagedDataSource，将我的 ObjectDataSource 绑定到它，**所有这些都使用自定义分页**并使用 PagedDataSource 的属性编写我自己的寻呼机。

目前，我**在 ViewState 中存储了一堆信息，**例如 CurrentPage、IsFirstPage、IsLastPage 等......这里令人讨厌的是**ObjectDataSource 的 SelectCountMethod 不会公开结果**，这是必须的创建寻呼机...基本上我需要再次调用数据库才能选择该值。

继承 ObjectDataSource 或 ObjectDataSourceView 只是为了公开 TotalRowCount 太复杂了，我几乎无法在不添加任何功能的情况下使其工作。

我已经阅读了一些关于 PagedDataSource 的内容，感觉它不能与中继器一起做很多自定义分页......

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T18:09:53.397

您可以尝试使用 DataList 以及绑定到 ODS 的 DataPager。DataList 类似于转发器，因为您必须显式声明发出的标记，但提供更强大的分页功能，尤其是与 DataPager 控件一起使用。有关如何使用控件的更多信息，请参阅[这些文章集。](http://www.4guysfromrolla.com/articles/122607-1.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T18:10:03.723

这听起来和我几天前刚刚实现的几乎一模一样。[我从 Rolla](http://www.4guysfromrolla.com/articles/081804-1.aspx)的 4 Guys 那里得到了很多帮助。检查那篇文章，它将向您展示如何设置带有分页的中继器。这是另[一篇 4GfR 文章](http://www.4guysfromrolla.com/articles/020905-1.aspx)。

*   **编辑**：另一个似乎尝试同样事情的来源：[ASP.NET Library](http://aspnetlibrary.com/articledetails.aspx?article=Add-paging-to-a-repeater)
*   **编辑 2**：以及来自[ASPNETTutorials的来源](http://www.aspnettutorials.com/tutorials/controls/repeater-pageddatasource-db.aspx)

# iphone - 我该如何解决这个不匹配的 iPhone 配置问题？

> ID：1019241
> 
> 赞同：1
> 
> 时间：2009-06-19T17:56:28.737
> 
> 标签：iphone, xcode, provisioning

我最近升级到了 iPhone 3.0 sdk。一旦我这样做了，我需要在我的 iPhone 上重新安装正确的配置文件。但是，当我需要调试时，我无法再部署到我的设备上。在管理器窗口中，我收到以下错误：

> iPhone“（我的iphone）”没有用于签署应用程序的配置文件。
> 
> 请通过 Organizer 添加配置文件，或检查“代码签名身份”构建设置。

我已验证该配置文件实际上已安装在设备上。我认为我的证书是正确的，因为出于另一个原因我还需要重做整个证书请求过程。有没有其他人遇到过这个错误，有没有办法解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T18:18:43.023

这里没有配置问题 - 但有时我已经改变了一些事情并且忘记将目标和主构建的详细信息更新到新的配置文件/配置证书。

您是否检查过两者现在都在使用新的配置文件/证书组合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-20T18:42:08.540

我不确定我到底做了什么让它工作，但它在我的应用程序的目标信息中调整了产品名称和标识符后它工作了，由于空格/下划线不能作为包标识符工作，我之前已经更改过.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-16T01:29:15.797

在我刚刚从 GitHub 克隆[的项目](http://github.com/jj0b/OverlayViewTester)上简单地执行构建并运行后，我得到了这个错误。执行清理所有目标，然后执行新的构建和运行（这次大概是与我的 prov 教授一起）将其清除。

可能是罕见的情况；YMMV。

# windows - Windows 批处理文件 - 移动文件仅在任务计划程序中不起作用

> ID：1019263
> 
> 赞同：11
> 
> 时间：2009-06-19T18:00:31.820
> 
> 标签：windows, scheduled-tasks

我有一个文件，我试图通过一个批处理文件按时间安排移动。

移动源文件目标文件。

目标文件位于映射的网络驱动器 Z 上。

例如，命令将是：

移动 C:\myfile.txt Z:\myfile.txt

当我通过双击在 Windows 中执行批处理文件时，它工作正常。但是当我通过任务计划程序安排它时，它不起作用。

我添加了：

净使用 Z:\myipaddress

查看问题是否是解决问题，但这也仅适用于直接批处理文件，不适用于任务计划程序。

该任务正在以管理员身份以最高权限运行。

操作系统 = Windows 2008 服务器。

有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-01-15T16:54:28.463

我找到了答案：进入任务的属性并取消选中“以最高权限运行”，它将起作用。

理查德的回答促使我进一步研究这个问题。我以管理员身份运行 cmd，找不到我的映射驱动器。因此，任务调度程序以管理员身份运行时找不到它，这是“最高权限”所做的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-21T10:26:00.950

“任务正在以管理员的最高权限运行。” 让我想起了一些事情，这发生在 Vista 中，并且仍然发生在 Windows 7 中（我刚刚升级）：当我以管理员身份运行命令提示符时，我发现映射的网络驱动器不可用。

您可能想尝试从提升的（管理员）命令提示符中运行您的批处理文件，看看您是否遇到相同的错误，我怀疑您会的。

您也许可以将命令“move”安排为计划任务来运行并将“C:\myfile.txt Z:\myfile.txt”参数传递给它？（这个我没试过）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T18:46:02.620

我不确定问题是什么，但是您可以通过稍微更改批处理文件并添加一些输出日志来帮助自己：

```
net use z: \\ipaddress\shared_folder >c:\debug_log.txt 2>&1
move c:\myfile.txt z:\myfile.txt >>c:\debug_log.txt 2>&1 
```

计划任务运行后，您应该能够查看`c:\debug_log.txt`这两个命令产生的所有输出和错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T18:07:44.227

这听起来像是一个身份验证问题 - 您确定运行任务的用户具有管理员权限（或与“它工作”时登录的用户具有相同的权限）吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T18:12:06.963

您是否尝试过使用 UNC 样式路径而不是映射驱动器？

类似（未经测试）：

```
move \\server\share\file_path \\other_server\other_share\new_file_path 
```

# objective-c - 可可中缺少什么？

> ID：1019280
> 
> 赞同：13
> 
> 时间：2009-06-19T18:05:03.530
> 
> 标签：objective-c, cocoa, cocoa-touch, api-design

如果你可以在 Cocoa 中添加任何东西，那会是什么？您会说 Cocoa 中是否缺少任何主要或次要功能。也许因为框架中的一个遗漏，你不得不一遍又一遍地发明一个轮子？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-19T20:09:10.493

*   内置的正则表达式支持（la [RegexKit](http://regexkit.sourceforge.net/)）将*非常*方便。NSRegularExpression 在 iOS 4.0+ 上可用，但在 Mac OS X 上仍然不可用。

*   一种从大型文本文件中逐步读取 NSString 对象的简单方法，而无需将整个内容加载到内存中。（NSInputStream 和 NSFileHandle 不能满足这一点。）

*   有选择地使 NSSet/NSMutableSet/NSCountedSet 按排序顺序存储和枚举对象（如[二叉搜索树](http://en.wikipedia.org/wiki/Binary_search_tree)）的能力肯定会受到欢迎。Cocoa 数组也是如此——目前我必须调用类似`-[NSArray sortedArrayUsingSelector:]`or`-[NSMutableArray sortUsingSelector:]`来获取排序数组，而对于集合，我必须首先创建数组。

*   堆/优先级队列。[围绕CFBinaryHeap](http://developer.apple.com/documentation/CoreFoundation/Reference/CFBinaryHeapRef/)的 Cocoa 包装器（绝对不像 Cocoa 集合那样容易使用）可能会起作用。

*   可以为每个键存储多个值的字典，通常称为*multiset*。NSCountedSet 几乎是一个多重集/包，对于键值关联（NSMultiDictionary？）有相同的东西会很好，而不必自己滚动。

*   [FSEvents](http://developer.apple.com/documentation/Darwin/Conceptual/FSEvents_ProgGuide/)的友好包装器。（CFFileDescriptor 做了一些工作，但它不是 Cocoa 简单的。）

*   一种从格式字符串和对象数组（不仅仅是可变参数）创建 NSString 的方法。[这个 SO 答案](https://stackoverflow.com/questions/1058736/#1061750)显示了一个例子。让它与原语一起工作会很棘手......也许是一个NSPointerArray？

*   一致的集中式 API，可简化各种语言环境的电话号码格式（和解析）。目前，您必须使用 NSNumberFormatter（或 NSScanner）自行开发，该过程繁琐且容易出错。（例如，请参阅[NSNumberFormatter 格式化美国电话号码](https://stackoverflow.com/questions/665111/)并[从 NSString 中删除除数字之外的所有数字](https://stackoverflow.com/questions/1129521/)。）

当然，总的来说，我绝对是[各种数据结构](http://cocoaheads.byu.edu/code/CHDataStructures)的粉丝，尽管 Cocoa 的简单性与某些语言相比令人耳目一新。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-21T11:26:42.083

一种指定在 dealloc 中自动释放的复制/保留属性的方法。也许

```
@property (nonatomic, copy, dealloc) NSString* name; 
```

当然还有 RegexKit。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-19T21:24:34.677

Core Data 的多用户支持。可以梦想 :)
但至少 Core Data 现在可以在装有 OS 3.0 的 iPhone 上使用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-20T21:52:44.820

一种将整个核心数据*实体*标记为瞬态的方法。这对于实现 Bonjour 共享特别有用。

例如，假设我有一个类似 iTunes 的模型，带有`Playlist`和`Song`实体。目前，为了实现 Bonjour 共享，我创建了两个额外的`NSObject`子类`TransientPlaylist`和`TransientSong`，它们实现了与 Core Data 对应的所有相同方法。

我不应该仅仅为了拥有我的对象的瞬态版本而将模型类的数量*翻倍——而不是当我**希望*它们的行为完全相同时，没有持久性。

（是的，另一种选择是拥有一个内存中的持久存储，其中包含您想要暂时的所有实体。无论哪种方式，这都是不必要的开销）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-05-07T02:46:30.570

[Keychain Services](http://developer.apple.com/mac/library/documentation/Security/Conceptual/keychainServConcepts/01introduction/introduction.html)的更友好的包装器。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-21T02:35:16.137

*   良好的正则表达式支持
*   AppKit 中的布局管理器。自动调整大小并不适合复杂的 GUI。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-24T06:54:30.090

`@property (..,copy)`支持可变类型类（`NSMutableArray`,`NSMutableDictionary`等）。目前，如果您为可变类型类的属性分配值，则创建的对象将是不可变的（由于复制）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-19T18:50:36.480

对 Web 服务的适当支持。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-24T07:04:47.637

从 .NET 世界进入 Cocoa，我有一个要求：LINQ！

在过去的几个月里，我越来越喜欢能够在我附近的任何集合上使用 LINQ。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-20T05:11:37.497

当然，从管理对象上下文到 SQL 数据库服务器的合理接口会非常酷。

我希望看到用程序创建的单元格编写自定义视图的更好示例，所有这些都可以很好地自动滚动。

此外，IB 对带有工作分离器的复杂多窗格窗口的支持似乎存在真正的差距。我想他们正在研究这个？

不管决议独立性发生了什么，对吧？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-05-03T23:22:25.383

对导入/导出的内置 JSON 支持。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-08-21T21:12:12.990

[绝对是Carbon HotKeys](http://developer.apple.com/legacy/mac/library/documentation/Carbon/Reference/Carbon_Spec_Porting/Carbon_Event_Manager.html)的对应物！

# winapi - HWND 创建时间

> ID：1019285
> 
> 赞同：5
> 
> 时间：2009-06-19T18:06:06.053
> 
> 标签：winapi

我是这个社区的新手，在使用我的一个自动化脚本时遇到了一个问题，我想获得 HWND 的创建时间。

我在从 FindWindowEx 检索到的数组中有一组 HWND，我想根据系统时间在数组中找到最后创建的 HWND

我没有足够的窗口挂钩知识，但我读到了一些 CBTproc，它有一些名为“CBT_CREATEWND”的事件，它可以在窗口即将创建时返回 HWND，我非常不确定如何使用窗口挂钩但是如果我会得到 HWND，我可以获取系统时间并与我的阵列的 HWND 进行比较。

任何人都可以提出一些相同的问题，如果我不清楚，也可以要求我进行更多详细说明。

谢谢，马尼什·班萨尔

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T18:20:37.060

Windows 不会以可通过 API 访问的方式存储此信息，因此您必须自己收集这些信息。

如果您可以修改创建 HWND 的代码，则可以在处理 WM_CREATE 或 WM_NCCREATE 时存储当前时间。

如果可能的话，我会避免使用窗口挂钩——它们会将你的 DLL 注入到每个创建窗口的进程中。DLL 中的严重错误将导致桌面上的每个应用程序都死掉。

如果您必须使用 windows 挂钩，请使用[SetWindowsHookEx](http://msdn.microsoft.com/en-us/library/ms644990.aspx)注入挂钩，如下所示：

```
HHOOK myHook = SetWindowsHookEx(WH_CBT, MyHookFunction, myHookDll, 0); 
```

然后，您的钩子 proc 将如下所示：

```
LRESULT CALLBACK MyHookFunction(int nCode, WPARAM wParam, LPARAM lParam)
{
   if (nCode == HCBT_CREATEWND)
   {
        // wParam is new window.
   }
   else if (nCode == HCBT_DESTROYWND)
   {
        // wParam is window being destroyed
   }

   return CallNextHookEx(myHook, nCode, wParam, lParam);
} 
```

hook proc 需要存在于 DLL 中，因此它可以被其他进程加载。由于您的挂钩将在不同的进程中运行，因此您需要将信息编组回原始进程。例如，您可以通过自定义窗口消息来执行此操作。

# django - Django：同一服务器上的实时站点和暂存站点之间的冲突

> ID：1019292
> 
> 赞同：2
> 
> 时间：2009-06-19T18:07:29.250
> 
> 标签：django, staging, multiple-sites

我最近推送了一个 Django 应用程序。我们在服务器上的暂存子域中构建了应用程序。当我上线时，我将登台子域的文件复制到主站点，创建一个登台数据库并将旧登台站点指向新登台数据库（让新活动站点指向原始数据库）。这是在 Apache 下的 mod_python 上。

我已经为这两个站点创建了唯一的 SESSION_COOKIE_NAME 设置，并且我已将实时站点的 SESSION_COOKIE_DOMAIN 设置为“.sitename.com”，而将暂存站点设置为 None。

我们看到的问题是实时管理员中的用户正在进行编辑（看起来）正在保存到临时站点。在请求期间，用户也会“随机”退出管理站点。

我在这里显然做错了什么吗？SESSION_COOKIE_DOMAIN 是否应该是“www.sitename.com”来限制它，因为子域位于“staging.sitename.com”？我是否在现用数据库中留下了旧会话信息（在此问题出现之前，我运行了 ./manage.py clean 并从实时数据库中删除了所有会话）？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-20T02:52:03.160

我们在过去几周遇到了这个问题。有几个地方可以重叠。

**1）你运行单独的python解释器吗？** 有几种方法可以配置 mod_python 以便线程不会互相踩踏。这里的关键点是提供一个独特的 ServerName（在这种情况下，域**staging.sitename.com**和**www.sitename.com**），以及在您的 Apache vhosts 配置文件中提供一个独特的 PythonInterpreter 配置设置。

```
PythonInterpreter mysite 
```

[同一服务器部署上的相关 Django 文档](http://docs.djangoproject.com/en/dev/howto/deployment/modpython/#multiple-django-installations-on-the-same-apache)

**2）您是否在同一端口上运行缓存后端？** settings.py 中有一个配置，可让您在缓存内容前加上几个字符，以将暂存内容与实时内容分开。这是通过 settings.py 中的以下配置实现的：

```
CACHE_MIDDLEWARE_KEY_PREFIX = "STG_" 
```

另一种选择可能是在单独的文件系统缓存上运行一段时间以查看问题是否已解决。在 settings.py 中，尝试添加

```
CACHE_BACKEND = 'file:///var/tmp/django_cache' 
```

**3）您是否尝试过删除所有 .pyc 文件？** 奇怪的是，当上述两种解决方案未能解决我们的问题时，我们在服务器停止时运行了一个 bash 命令来删除所有已编译的 python 文件（.pyc 文件）。

```
find ./ -type f -name "*.pyc" -exec rm -f {} \; 
```

这表明您的部署中的更改由于某种原因没有重新编译。

希望这可以帮助！

# reporting-services - 从报告服务中的报告调用 C# 程序集

> ID：1019295
> 
> 赞同：1
> 
> 时间：2009-06-19T18:07:47.907
> 
> 标签：reporting-services

我在报告服务 (2008) 报告中添加了对自定义程序集的引用。当我从文本框（例如 =Assembly.Class.Function() ）调用时效果很好，但是当我将它包装在自定义代码块中时：

```
Function GetString(ByVal key as String) as String

return Willow.Reporting.Localization.Resource.Get(User!Language, "WAR", "Title", key)

end function 
```

我收到构建错误“对非共享成员的引用需要对象引用。”。

C# 类和函数是静态的。

作为测试，我还创建了类的非静态vrsion，创建了一个实例，并通过自定义代码中的实例名称访问它，但也没有运气。

是否可以从报告服务中的代码块调用自定义程序集？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T18:11:33.253

也许您是 C# 程序员？VB中的“共享”意味着静态。该消息意味着您需要创建类的实例才能调用类的（实例）方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-22T15:26:12.910

VS IDE 仅在加载时加载程序集一次——因此每次更改程序集时都必须关闭/重新打开 VS（删除引用和重置也不起作用）

您也可以同时使用静态调用和实例方法，并且它可以在嵌入代码中正常工作，例如：

```
Function Test() as String
    return Instance.GetString()
End Function

Function Test2() as String
    return WR.StaticTest.GetString()
End Function 
```

# java - 有没有办法从 Doxygen 输出中排除包级函数和成员？

> ID：1019300
> 
> 赞同：0
> 
> 时间：2009-06-19T18:08:58.250
> 
> 标签：java, documentation, static, doxygen

我在工作场所使用 Doxygen，并且遇到了 Java 代码问题。在 EXTRACT_ALL=NO、EXTRACT_PRIVATE=NO、EXTRACT_STATIC=NO、EXTRACT_LOCAL_CLASSES=NO 和 EXTRACT_LOCAL_METHODS=NO 时，输出仍然包括未定义为公共或私有的静态成员。

前任。假设我有以下代码：

```
class EXAMPLE{

public static func1()

private static func2()

static func3()

} 
```

`func3`仅定义为`static`因为它是包级函数。

`func1`并`func3`出现在输出中，而我只想`func1`出现。

有谁知道只显示那些明确定义为公共的功能的方法？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-13T08:47:42.840

你可以把你不想在 doxygen 输出中看到的东西放在一个`\cond ... \endcond`块中：

```
class EXAMPLE{

public static func1()

/// \cond

private static func2()
static func3()

/// \endcond

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-16T12:16:30.857

为 Doxygen 开发一些新的过滤器（HTML、XSLT、BAT ...，请参阅[https://github.com/msillano/filters_dox](https://github.com/msillano/filters_dox)）我创建了许多具有相同名称的伪函数。文件页面没问题，但这使得页面“文件成员/全部”和“文件成员/功能”没有任何兴趣。在 Doxygen-config 中，不可能排除该页面的创建（耻辱）。我找到了 HTML 输出的解决方法（在 1.8.15 版上）。

*   将专家/HTML/HTML_DYNAMIC_MENUS 设置为“是”。
*   构建文档。
*   编辑文件“navtreedata.js”（用于树形菜单）和“menudata.js”（用于选项卡菜单）。使用带有“括号匹配”的编辑器很容易删除“文件列表”之后的所有项目。

不优雅，但它有效。

# python - 从列表更新列表的算法

> ID：1019302
> 
> 赞同：0
> 
> 时间：2009-06-19T18:09:22.913
> 
> 标签：python, google-app-engine, set

我有一个提供对象列表及其属性的数据源（一个 CSV 文件，但这没关系）。每次我的程序运行时，它都需要提取对象列表的新副本，将其与存储在数据库中的对象列表（及其属性）进行比较，并根据需要更新数据库。

处理新对象很容易 - 数据源为每个对象提供一个连续的 ID 号，对照数据库检查新信息中的顶部 ID 号，就完成了。我正在寻找其他情况的建议——当一个对象的某些属性发生变化时，或者当一个对象被删除时。

一个天真的解决方案是从数据库中提取所有对象并获取两个集合（旧的和新的）交集的补集，然后检查这些结果，但如果集合得到，这似乎不是很有效大的。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T18:25:21.780

有没有办法维护“最后一次修改”字段？这就是您真正想要的：基于上次运行备份的增量备份，与上次更改/删除（/添加）对象的时间相比。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T18:33:05.620

您需要在数据库和 CSV 文件中都有时间戳。Timestamp 应该显示记录更新时的数据，您应该比较具有相同 ID 的记录的时间戳以确定是否需要更新它

至于你对交叉点的想法......应该反之亦然！您必须将所有数据从 CSV 导入临时表，并在 2 个 SQL 数据库表之间进行交集。如果您使用 Oracle 或 MS SQL 2008（不确定是否适用于 2005），您会发现一个非常有用的 MERGE 关键字，因此您可以更轻松地编写 SQL，然后您将花费在其他编程语言中合并数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T19:11:13.027

处理大量数据的标准方法就是这样。

我们假设 list_1 是“主”（没有重复），而 list_2 是可能有重复的“更新”。

```
iter_1 = iter( sorted(list_1) ) # Essentially SELECT...ORDER BY
iter_2 = iter( sorted(list_2) )
eof_1 = False
eof_2 = False
try:
    item_1 = iter_1.next()
except StopIteration:
    eof_1= True
try:
    item_2 = iter_2.next()
except StopIteration:
    eof_2= True
while not eof_1 and not eof_2:
    if item_1 == item_2:
        # do your update to create the new master list.
        try:
            item_2 = iter_2.next()
        except StopIteration:
            eof_2= True
    elif item_1 < item_2:
        try:
            item_1 = iter_1.next()
        except StopIteration:
            eof_1= True
    elif item_2 < item_1:
        # Do your insert to create the new master list.
        try:
            item_2 = iter_2.next()
        except StopIteration:
            eof_2= True
assert eof_1 or eof_2
if eof_1:
    # item_2 and the rest of list_2 are inserts.
elif eof_2:
    pass
else:
    raise Error("What!?!?") 
```

是的，它涉及一种潜在的排序。如果将 list_1 写回文件系统时保持排序顺序，则可以节省大量时间。如果 list_2 可以累积在一个保持排序的结构中，那么可以节省大量时间。

对冗长感到抱歉，但您需要知道哪个迭代器引发了`StopIteration`，因此您不能（简单地）将整个 while 循环包装在一个大的旧 try 块中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T18:26:18.063

当您将列表拉入您的程序时，迭代列表，根据数据库表中的列属性进行查询，该属性映射到列表中对象的相同属性，如 ObjectName。或者您可以将整个表格加载到列表中并以这种方式比较列表。我假设您对除了数据库分配的 ID 之外存在的对象有一些独特的东西。

如果通过查询在表中未找到该对象，则创建一个新条目。如果像提到的 FogleBird 那样找到它，则在表中存储该对象的计算哈希或 CRC，您可以将其与列表中的对象进行比较（在对象上运行计算）。如果散列不匹配，则使用列表中的那个更新该对象。

# asp.net - jQuery Ajax

> ID：1019304
> 
> 赞同：1
> 
> 时间：2009-06-19T18:09:47.890
> 
> 标签：asp.net, jquery, ajax

我正在使用 JQuery 对 asp.net 页面方法进行 AJAX 回调。一切正常。但是，当我在长时间运行的回调正在进行时单击超链接转到新页面时，目标页面无法正常响应。似乎它正在等待回调完成，因为目标页面的响应时间与完成回调所需的时间相同。如果没有正在进行的回调，新页面会立即响应。在调试器中单步执行代码，我看到单击超链接时调用了错误处理程序，该处理程序中止回调并将 readyState 设置为 4 并将状态设置为 0。

那么，如果单击超链接时正确中止了长时间运行的回调，为什么要花这么长时间才能到达新页面？

谢谢。查理

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-05-19T00:01:32.667

$.ajax 函数的 'success' 参数（连同 'error'、'dataFilter' 等）实际上是一个回调函数，当您收到来自服务器的响应时执行。

因此，脚本将在您发出 AJAX*请求*后继续运行，然后在您收到*响应*时返回到该回调函数。

例子

```
$.ajax({
  url: 'ajax/test.html',
  success: function(data) {
     //Runs after response is received
     //Put stuff that depends on the response from the server here
  }
});
//Next statement runs immediately after request
//Put stuff here that can run right away 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T18:49:52.113

您是否曾经在您的特定系统上成功执行过 Ajax？如果还没有，那可能是浏览器兼容性问题——我会尝试 JQuery、Dojo 或 Scriptaculous，因为它们可以在常见的浏览器上顺利运行。原始 ajax 可能非常令人沮丧且难以调试。

就像 Yuriy 说的，一些代码会有所帮助。祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T18:28:14.613

自动生成的 JavaScript 中的错误。能不能在离开页面前开启脚本调试，看看有没有报错？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T21:58:26.840

Firebug for Firefox 的诞生就是为了解决这类问题。

启用 Firebug，保持控制台选项卡打开。控制台中的每个 Web 服务调用都会出现一个新行。很酷的想法是您可以检查正在发送和接收的内容。

# regex - 如何为域列表创建正则表达式？

> ID：1019311
> 
> 赞同：0
> 
> 时间：2009-06-19T18:10:59.633
> 
> 标签：regex

这是用于文本框验证。我需要匹配域列表

火柴

> google.com、msn.com、texas.edu.gov.us
> 
> msn.com

不匹配

> google.com、msn.com、
> 
> @msn.com，@google.com
> 
> test@test.com

没有尾随逗号（这就是我卡住的地方）

这是我到目前为止所拥有的，但逗号分隔的部分无法正常工作：

```
^([([a-zA-Z0-9]([a-zA-Z0-9\-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,6}]+\s*)+,$ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T18:15:26.537

在我看来，您最好`\s*,\s*`先使用正则表达式将字符串分成几部分，然后分别验证每个域。如果您稍后尝试更改逻辑，则尝试将其全部推送到单个正则表达式中将使您的生活变得艰难。

您拥有的域验证正则表达式应该可以工作。我不知道您是否故意禁止某些有效域。更通用的域匹配正则表达式是：

```
^[\w-]+(\.[\w-]+)+$ 
```

但即使是这个也不允许`localhost`，在您的情况下可能会或可能不会被允许。对于其他方面的规格来说，它太松散了。可以选择将每个替换`[\w-]+`为`[a-zA-Z0-9][a-zA-Z0-9-]{0,61}[a-zA-Z0-9]?`更严格和更混淆 - 尽管它*仍然*不会使仅数字记录无效，根据规范，这些记录是无效的。你需要它有多精确？

忽略关于首先拆分字符串的内容，根据我上面的示例正则表达式，您*可以*使用以下怪物来匹配域列表：

```
^\s*([\w-]+(\.[\w-]+)+\s*,\s*)*[\w-]+(\.[\w-]+)+\s*$ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T18:50:58.307

“有些人在遇到问题时会想‘我知道，我会使用正则表达式。’现在他们有两个问题。” - 杰米扎温斯基

这是一个正则表达式，可以满足您的要求。它将处理以逗号分隔的域列表，确保域名中没有非法字符，并强制域名的长度（我以为是 63 而不是 61，但你有 61，所以我就这样离开了）

^\s*(([a-zA-Z0-9][a-zA-Z0-9-]{0,61}[a-zA-Z0-9]?(.[a-zA-Z0-9 ]{2,6})+)+\s*,\s*)*([a-zA-Z0-9][a-zA-Z0-9-]{0,61}[a-zA-Z0 -9]?(.[a-zA-Z0-9]{2,6})+)$

*注意 [a-zA-Z0-9] 用于代替 [\w] 因为下划线包含在 \w 中但不允许在域名中

# c# - 匹配正则表达式中的多个零星组

> ID：1019312
> 
> 赞同：2
> 
> 时间：2009-06-19T18:11:04.393
> 
> 标签：c#, regex

我正在处理一些以专有字符串格式存储其数据的遗留代码，并且我正在尝试创建一个正则表达式以使解析这种格式更加容易。

我遇到的问题是格式包含可以偶尔重复多次的组。例如，通常数据看起来像这样 (A)(B)(B)(B)，但有时它可以有多个 (A) 像这样 (A)(B)(B)(B)(A) （B）（B），甚至（A）（A）（B）（B）（B）。(B) 的重复次数也可以变化，少则无，多则多。

发生的事情是，当数据看起来像 (A)(B)(B)... 时，我当前的正则表达式可以正常工作...但是当字符串中稍后有另一个 (A) 时它会中断。第一个 (A) 被抓住，但所有剩余的 (A) 都没有。

所以基本上现在我有一个正则表达式，它有一个用于解析（A）的组和一个用于解析（B）的组，这些组可以独立工作，但我不知道如何将它们与正确的组合它们之间的重复语法，以便找到分散的匹配项，而不是仅忽略第一个匹配项而忽略其余匹配项。

我只是遗漏了一些东西，还是我必须将我的正则表达式分成两个单独的并分别解析出（A）和（B）？（我正在使用 C#/.Net）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T18:14:36.837

如果您有一个匹配的工作模式`(A)`和另一个匹配的工作模式`(B)`，那么匹配任意数量的表达式是

```
(?:(A)|(B))* 
```

如果这就是你所需要的，那就没有必要花哨了。此表达式匹配任意次数`(A)`或`(B)`任意次数，但将组的捕获留给`A`and`B`级别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T18:22:32.627

查看您当前的正则表达式会有所帮助。

要匹配 A 或 B 的任何序列，请使用以下命令

```
 (A*B*)* 
```

任意数量的 A 组后跟任意数量的 B

这将匹配空字符串，以确保至少有一些数据：

```
 (A|B)(A*B*)* 
```

还是数据总是以 A 开头（如所有示例中一样）

```
 A(A*B*)* 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-13T20:55:36.467

我会将您想要匹配的每个单独的部分放在他们自己的组中，放一个 | 字符。然后，我会使用 switch 语句编写一个函数/方法。这样，您可以匹配第 1 组或第 2 组……并对不同的结果做出反应。

# programming-languages - 什么样的项目（除了明显的操作系统的东西）使用汇编语言？

> ID：1019313
> 
> 赞同：10
> 
> 时间：2009-06-19T18:11:15.530
> 
> 标签：programming-languages, assembly, x86

看起来，除了开发设备驱动程序或操作系统内核的核心等之外，现在没有人使用汇编。有人知道它目前用于其他事情吗？

我的意思是 PC 风格和更大的硬件，而不是带有微小处理器的嵌入式东西。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-19T18:14:20.457

或多或少显然，编译器后端和动态重新编译 CPU 模拟器等相关技术需要汇编编程。

汇编语言编程也经常用于视频游戏编程，以利用当前编译器尚未很好支持的新 CPU 功能。然而，现在这种情况很少见，特别是因为在 PC 上，有很多不同的 CPU 需要支持。不过，我希望这在具有统一硬件的控制台上更为常见。

***编辑：***如今，游戏的大部分计算都是在 GPU 中完成的。仅使用 OpenGL 或 DirectX 并不总是能够充分利用这些计算资源，这些处理器的供应商提供了大量工具来充分利用其硬件。尽管 Cuda 或 OpenCL 是众所周知的术语，但它们仍然处于 GPU 硬件上相对较高的抽象级别，所扮演的角色与 C 在典型（冯诺依曼）CPU 上的角色非常相似。查看这些产品的[开发人员](http://developer.nvidia.com/page/tools.html) [页面](http://developer.amd.com/gpu/Pages/default.aspx)，您会发现数十种在每个抽象级别上优化使用 GPU 计算资源的方法。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-19T18:22:26.323

[Boost](http://www.boost.org)与现代 C++ 一样，将内联汇编用于低级性能关键位，如[原子共享计数器](http://svn.boost.org/svn/boost/trunk/boost/smart_ptr/detail/atomic_count_gcc_x86.hpp)。

编辑：正如@TokenMacGuy 正确指出的那样，“性能”在这里是一个错误的词。Boost 使用汇编语言来完成标准 C++ 中无法完成的事情，例如原子（并且编译器内在函数由于某种原因不可用。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-19T18:13:50.970

我相信 Folding@Home 并行计算项目使用优化的汇编代码来实现最高速度。*

 * 注意：这并不意味着汇编总是比 C/C++ 快。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-21T18:52:06.293

Speaking from experience, it's heavily used when testing and verifying new processor designs. The instruction set has to be stressed using code that a compiler won't necessarily generate. Rather than writing in some higher level language that may or may not compile to the instructions one wants to check, it's easier to write the assembly by hand.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-21T18:55:31.250

Just as an anecdote: **Roller Coaster Tycoon** was written entirely (or almost) in x86 assembly by Chris Sawyer ([wikipedia reference](http://en.wikipedia.org/wiki/Roller_Coaster_Tycoon)).

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-19T18:16:13.387

有人为此[代码使用汇编程序将数字转换为单词](https://stackoverflow.com/questions/309884/code-golf-number-to-words)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-19T18:16:26.787

我最后一次遇到汇编程序是在我破解 Quake I 源代码的时候。所有的数学库（尤其是点积的任何东西）都是由 John Carmack 用 MASM 编写的。这些东西是浮点密集型的，当时 C 还不如用于浮点操作的专业手工 ASM。此外，由于计算机对 CPU 的限制要多得多，而且由于 Quake 使用 CPU 进行渲染，所以每一个操作都很重要，所以 ASM 工作得最好。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-19T18:48:53.223

如果您花费大量时间查看您的 C/C++ 源代码的汇编输出，您会很快注意到大多数优秀的优化编译器比优秀的汇编程序员生成更好的汇编。决定何时内联函数、如何处理循环、后增量与预增量（许多编译器现在决定如何为您处理）等。祝你好运，胜过拥有大型社区开发它的编译器和更好的能力至少在正常情况下，比你管理地址和定义。

甚至设备驱动程序和操作系统内核通常也不是使用大量程序集编写的。实时程序的小型性能关键部分是您在当今应用程序中找到汇编的地方。

当您开始谈论 RISC 汇编时，情况会变得更糟，它往往对优化指令（如分支和交换）以及数十个通用寄存器非常有效。大多数人并不比优化编译器聪明。那些通常在编写优化编译器的人。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-19T18:59:55.840

在 C 语言中，从根本上讲，很容易看出一组指令如何成为汇编程序（如果您了解底层架构）。但有时，汇编程序无法被击败。请注意，编写蹩脚的、低效的汇编代码就像编写蹩脚的 C 代码一样容易。汇编程序的可维护性较差。而且它在任何地方都不便携。

这完全取决于您使用的 C 编译器的质量。有些人比其他人做得更好。大多数编译器允许您查看它们生成的汇编代码。如果你认为你可以做得更好，并且代码段很关键，那就去做吧。否则，避免它。精心制作的 C 可以非常接近金属，给定一个体面的编译器。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-20T05:06:44.040

高级语言不希望支持的实用功能。一个老例子是当我在 RSX-11M 上使用 Fortran 时试图获得 C 和 Unix 提供的一些细节。我想传递格式化字符串并使用更简单的 C 风格。printf() 需要执行一些类似转换的操作。Fortran 没有这个概念，所以 icast() 和 rcast() 是用汇编程序编写的。其他实现的函数是 move() 和 clone()。这些并不是为了提高效率，而是将概念扩展到 Fortran 思维之外。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-19T18:14:50.360

我知道汇编用于非常大量的游戏代码。例如，像素着色器的指令预算非常紧张；为了获得你想要的效果，你几乎必须对金属进行编码。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-06-19T18:17:12.947

我认为使用汇编程序的最突出的程序是引导加载程序。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-06-19T18:23:26.103

那天我为一个大型应用程序（供应商销售的产品，由大公司使用）编写了 IBM 370 汇编程序，该程序从操作系统中的挂钩中收集信息。但是，我只在汇编程序中进行简单的简编程：屏幕、报告等。它运行得非常快，但完全是在汇编程序中。我确信它今天仍在运行和销售，价格远高于 Windows 和 Linux 平台软件的典型价格。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-06-19T18:23:43.327

根据 Knuth 的说法，研究算法的效率。他在他的书中提到，没有比用汇编语言编写更好的方法来研究算法的工作原理了。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-06-19T18:36:40.763

有时某些功能无法用高级语言实现，而是使用内联汇编。例如，C++ 库 Qt 中有一些内联汇编；我相信它被用于对象自省系统的一部分。

此外，glibc（gcc 的 C 库）使用汇编进行优化。IIRC 基于软件的浮点数学实现之一具有用汇编语言编写的重要块。

然而，学习汇编的主要原因之一是调试。有几次，我让自己陷入了不知道汇编会阻止我调试一个特别棘手的问题的情况。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-06-23T18:46:17.933

One of the rate determining code (after whatever is needed dynamic for memory management) in nearly every language is the routine used by the runtime (-library) to move memory. Move(), memcpy etc, as well as primitives like searching for a byte (strchr ) etc.

这些也经常用汇编程序编写，带有特殊的专用代码来利用对齐。

# iphone - 在显示视图之前加载 iPhone 键盘

> ID：1019328
> 
> 赞同：2
> 
> 时间：2009-06-19T18:13:59.270
> 
> 标签：iphone, keyboard

我希望在显示视图时已经显示键盘。

我有两个视图控制器，其中键盘是第二个的一部分。但是，当我在第二个视图控制器的 viewDidLoad 方法期间调用 [textField becomeFirstResponder] 时，键盘会在第一个视图的顶部向上滑动。

有什么办法可以让键盘已经滑到位，但仍然被第一个视图覆盖，直到我想发现它？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T18:41:48.727

我本周刚开始使用 iphone dev，但看到了这篇文章。不知道这是否有帮助。

[http://www.iphonedevsdk.com/forum/iphone-sdk-development/2716-uisearchbar-show-keyboard-load.html](http://www.iphonedevsdk.com/forum/iphone-sdk-development/2716-uisearchbar-show-keyboard-load.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T21:32:03.587

键盘是故意作为子视图添加到 UIWindow 实例的，因此您无法执行您所要求的操作。

你也许可以绕过它。有几种方法可以找到键盘：

[http://www.iphonedevsdk.com/forum/iphone-sdk-development/6573-howto-customize-uikeyboard.html](http://www.iphonedevsdk.com/forum/iphone-sdk-development/6573-howto-customize-uikeyboard.html)

拥有键盘后，您可以通过重新排列 UIWindow 实例的子视图将其重新排序到后面，但这不能保证并且绝对不支持。如果你让它工作，它可能会在未来打破。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-16T13:01:18.783

尽管这个问题已有多年历史，但我会回答它并在未来帮助人们。

添加

```
[searchBar becomeFirstResponder]; 
```

在您的 ViewDidLoad 方法中。

“searchBar”是我的搜索栏的出口。

# language-agnostic - 做“程序员”笔记的有效方法是什么？

> ID：1019334
> 
> 赞同：7
> 
> 时间：2009-06-19T18:15:12.403
> 
> 标签：language-agnostic, knowledge-management

我多次遇到一个问题，有人问我有关我工作的错误或功能的问题。我确实需要很长时间才能回忆起它，通常是通过查看 Bugzila 以及我的 CVS 报告。所以我试图找到一个好方法来记录我一直在做的事情，并寻找你的建议。事实上，我通常对我所做的事情做几乎零笔记，尽管我在获得规范或一些技术性的事情时会写笔记。

我听说有些人为他们正在处理的每个问题或错误创建一个新文档，并附加配置信息、日志输出、我的想法和事情。我认为这对每周/每月报告等很有用，而且有助于记住您从事的工作或您已修复的类似错误。

请建议您如何记笔记？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-19T18:16:38.300

共识似乎是博客或物理笔记本是要走的路。除了这些，您可以使用 wiki 或 OneNote 之类的应用程序。

请看这个问题：[https ://stackoverflow.com/questions/78756/what-do-you-use-to-keep-notes-as-a-developer](https://stackoverflow.com/questions/78756/what-do-you-use-to-keep-notes-as-a-developer)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-19T18:17:27.940

书桌 + 绘儿乐

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-19T18:17:42.807

具有良好代码注释和良好签入注释策略的良好源代码控制系统可以创造奇迹。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-19T18:38:05.567

*   有一个博客，即使没有人阅读它。写一篇文章/howto/what-I-d关于任何你想在几个月或几年后记住的事情。谁知道呢，其他人可能也会觉得它有用。
*   使用 Trac 或 Github，它们为每个项目提供了一个不错的 wiki。除了提交消息之外，您还可以在特定于项目的 wiki 中保留注释和操作方法。观察。这有助于文档和团队的其他成员
*   对于短期笔记，请随身携带一个笔记本和一支铅笔。但是如果你像我一样，你很快就会丢失或放错这些东西
*   在每个项目中保留一个 TODO 和 CHANGELOG 文件。有时很难维护，但我有很多次救了我的 a##
*   如果真的很重要，请像 Memento 中的那个人一样将它纹在你的手臂上。

我的记忆力很差，不希望在 2 周后记住任何事情（我经常这样做，但当时你无法预测你是否会记住某件事）。所以这些是我的改编并且工作得很好。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-19T18:23:10.410

我是一个实用的极简主义者。

Notepad++ 每天都在我的右显示器上打开。我会在我认为合适的时候添加它，但我**总是**在提交更改时将注释放入 subversion 中。事情变化很快。

我以前经常使用 tiddlywiki，但 Notepad++ 对我来说效果更好，并且被精简到我需要的地方 - 一个我可以稍后搜索的输入位置。我不喜欢实体笔记本的一点是，当我在一个笔记本中查找内容时，我必须成为搜索引擎。

我就是这样做的。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-19T18:29:56.733

人们提出了许多记笔记的方法，但我认为方法是最重要的。

在我的工作中，我们为许多不同的公司开发定制软件，并且在每个支付期结束时，我们都会向他们发送一份时间表，他们必须在该时间表上签字，以便我们向他们收费。恰好这个时间表概述了开发人员所做的所有工作，通常结构是这样的。

打卡 - 上午 8:00

分析 - 上午 10:30
完成的分析工作的描述。

编码 - 下午 12:30
描述完成的所有编码工作。

这样做的目的是向客户证明，当您向他们计费时，您并非整天都在 StackOverflow 上。结果，您记录了您所做的所有编码、调试等。

尽管我是第一个承认这个过程很痛苦的人，但我数不清有多少次我回去查看我过去的时间表，看看我是如何解决我再次遇到的问题的，或者弄清楚我在一段时间内没有接触过的某个项目上的中断点。这很棒。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-19T18:19:15.363

写博客。或者为开发者笔记设置一个内部 Wiki。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-19T18:20:43.440

你想要简单，这样你就可以很快进入。我使用一个文本文件并将其添加到桌面上，并在添加新条目时保留一个标准名称，例如 NOTES、NOTES2 类型的 README 或 TODO 格式，并带有日期。

只要简单，任何事情都会奏效。如果您开始添加服务器和 wiki 以及所有这些东西，那么您的需求就过于复杂了。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-06-10T15:10:48.470

另一种记笔记的方法是使用思维导图。掌握它需要一点时间，但我发现这些对于组织我对各种主题（包括编程任务）的想法非常有价值。我什至修补了一个工具，将我的思维导图直接转换为可粘贴到 Jira 注释中的嵌套列表：) 使代码阅读注释和设计/估计注释非常易于构建和更改。

一些适用于思维导图的工具：

*   [XMind](http://www.xmind.net/)
*   [vym](http://sourceforge.net/projects/vym/)（查看你的想法）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-19T22:57:37.767

我发现[TiddlyWiki](http://www.tiddlywiki.com/)真的很方便。这是一个独立的 wiki，我用它来记录各种事情的笔记——从我的个人待办事项到关于特定功能实现的笔记。将它与[Dropbox](http://getdropbox.com)结合起来，它就会出现在我的所有系统上。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-19T22:59:39.043

安装桌面搜索引擎。索引文本文件注释、电子邮件和 IM 日志。

此外，我有时会在带有技术说明的错误/功能请求单中添加评论——明确标记为这样，以免混淆非技术观众。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-06-19T18:45:29.563

我从这个网站找到了 TodoList：[http](http://www.abstractspoon.com/) ://www.abstractspoon.com/ 它很容易使用，不需要安装并且有很好的功能。

为了处理更多的笔记，我推荐[WikiPad](http://wikidpad.sourceforge.net/)，它可以让你组织信息。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-06-19T18:17:55.550

除了错误跟踪器或计算机化笔记之外，我总是有一本日志，我会用它来记下每天某种形式的重要事项。这样我就可以轻松地翻页并找到特定的日期并查看我在那里写下的内容。

Paper + Pen 仍然是一个很棒的工具。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-06-19T18:20:59.383

我已经使用 Moleskine 笔记本很长时间了，每当我转向其他东西（我使用过 OneNote、WikidPad、Tomboy 等）时，我总是回到我的笔记本

Moleskine 有各种尺寸，更不用说至少 3 种类型的纸张：普通纸、直纹纸、网格纸

**[http://www.moleskines.com/moleskine-softcover-xlarge-squared.html](http://www.moleskines.com/moleskine-softcover-xlarge-squared.html)**

希望这可以帮助

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-06-19T18:26:08.673

我`cat >> ~/TODO`在笔记本（物理）中使用、写博客或写下来。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-06-19T18:35:56.317

根据您的环境，您可以按照 //TODO 的行制作自定义标签：此外，您应该将源代码控制系统设置为拒绝没有注释的签入。

随着时间的推移记录某些东西，让你知道你做了什么并且下一个人知道如何维护它的绝对最佳方法是针对你的所有更改进行单元测试。切换到单元测试源的注释视图，您就有了日期和时间。

我也喜欢一张便条，它可以轻松拖放任何格式，而且您不必担心打开、保存等任何事情，只需让它运行，它会处理细节。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-06-19T18:41:38.400

我自己的系统是：

*   [索引卡](http://www.43folders.com/2004/09/03/introducing-the-hipster-pda)，用于立即记下我需要记住或参考的事情。（几乎所有这些都会在一天结束时被扔掉。）
*   用于个人笔记的 OmniOutliner
*   OmniFocus 待办事项列表
*   错误跟踪系统注释，以获取有关跟踪和修复错误的信息
*   与团队共享信息的 Wiki
*   博客，内容可能是世界各地的程序员普遍感兴趣的东西

通常，事情从 OmniOutliner 开始，然后根据需要复制并粘贴到其他系统。

我的 Macbook 的 Spotlight 搜索很擅长找东西，所以我不太担心组织问题。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-06-19T22:47:56.243

*   与特定问题调查有关的注释的错误跟踪器。这可以包括测试代码、日志输出、更新您如何缩小范围以及您已排除的内容。我试着假设我会被公共汽车碾过，明天会有人接管这个错误。他们将拥有错误跟踪器注释、我 PC 上当前工作目录中的任何代码，并且可以假定无法读取我的笔迹。他们希望最迟在上午 10 点之前到达我所在的位置。它当然应该包括对导致错误的问题的完整描述，以及它是如何修复的，以供历史记录。当有人问“那个错误修复到底是什么？”时，这就是你会去的地方。如果有人说“我在其他地方看到过类似的问题，
*   使用错误跟踪器、请求跟踪器、设计文档或任何您拥有的任何新功能和更改也是如此。
*   注释中的代码注释解释了实现的原因。
*   文档中的注释用于解释接口为何如此的注释（“基本原理”）。

我不喜欢只为我保留关于我的代码的个人笔记，即使在理论上公开的 Wiki 或博客上也是如此。没有其他人会在需要它们时找到它们，除非可能 (1) 你有一个非常好的内部搜索工具，以及 (2) 每个人都在大量写博客，这样其他人就会期望有一些值得搜索的东西。如果注释与代码有关，那么它们应该在代码或其文档中，或者至少在错误跟踪器中（它解释了以前代码的问题，而注释解释了当前版本的正确之处） .

诸如“我必须做些什么才能安装和运行 IDE”之类的注释，当然，它们会出现在 wiki 或博客中。公开的东西，或者你的同事可以看到和搜索的东西，但它是特定于你的，因为你是最有可能想要它的人。

如果您正在研究开源代码，那么写博客可能是更好的选择，因为世界上任何人都可能想知道它，并且可能会在整个网络上搜索信息。但我从未参与过重要的开源项目。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-06-19T22:50:39.387

我是 Nick Cernis 的[Todoodlist](http://todoodlist.com/)的忠实粉丝。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-06-19T23:01:48.507

[虽然这不是那么技术，但我已经成为Hipster PDA](http://www.43folders.com/2004/09/03/introducing-the-hipster-pda)的忠实粉丝。

（简而言之：一堆 3x5 卡片和一个活页夹。它实际上非常有用。）

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2011-04-21T22:54:07.920

我喜欢**jira**它的设计非常好，但不是免费的

**http://www.atlassian.com/software/jira**

# .net - 创建将字符串转换为可空数字的通用方法

> ID：1019346
> 
> 赞同：6
> 
> 时间：2009-06-19T18:17:15.007
> 
> 标签：.net, vb.net, extension-methods

我有 3 个类似的功能，仅根据数字类型更改：

```
<Extension()> _
Public Function ToNullableShort(ByVal str As String) As Short?
    Dim intReturn As Short
    If Short.TryParse(str, intReturn) Then
        Return intReturn
    Else
        Return Nothing
    End If
End Function

<Extension()> _
Public Function ToNullableByte(ByVal str As String) As Byte?
    Dim intReturn As Byte
    If Byte.TryParse(str, intReturn) Then
        Return intReturn
    Else
        Return Nothing
    End If
End Function

<Extension()> _
Public Function ToNullableLong(ByVal str As String) As Long?
    Dim intReturn As Long
    If Long.TryParse(str, intReturn) Then
        Return intReturn
    Else
        Return Nothing
    End If
End Function 
```

我试图从中制作一个通用功能，但做不到。如何制作一个通用函数，它将采用特定的 T 并使其成为 Nullable(of T)？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-19T18:24:59.610

这里有一个相同的问题（在 C# 中）：[Convert string to nullable type (int, double, etc...)](https://stackoverflow.com/questions/773078/c-convert-string-to-nullable-type-int-double-etc)

```
Public Function ConvertString(Of T As Structure)(ByVal value As String) As System.Nullable(Of T)
    Try
        Return DirectCast(Convert.ChangeType(value, GetType(T)), T)
    Catch
        Return Nothing
    End Try
End Function 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T18:36:10.560

怎么样：

```
Public Shared Function Parse(Of T As Structure)(ByVal value As String) As T?
    If String.IsNullOrEmpty(value) Then
        Return Nothing
    End If
    Return New T?(DirectCast(TypeDescriptor.GetConverter(GetType(T)).ConvertFromInvariantString(value), T))
End Function 
```

（注意我使用反射器从下面的 C# 翻译它）

您可以在 周围添加 try/catch `ConvertFromInvariantString`，但老实说，如果我给它一些愚蠢的东西，我宁愿让代码抛出异常 - 为空白情况留空。

这样做的好处是它可以与您自己的结构一起使用，只要您将类型转换器与它们相关联，您就可以轻松地做到这一点（使用属性或在运行时）。

```
public static T? Parse<T>(string value) where T : struct
{
    if (string.IsNullOrEmpty(value)) return null;
    return (T)TypeDescriptor.GetConverter(typeof(T))
        .ConvertFromInvariantString(value);
} 
```

# jquery - 如何在 jQuery 中存储 JSON 响应？

> ID：1019350
> 
> 赞同：4
> 
> 时间：2009-06-19T18:17:36.690
> 
> 标签：jquery, json, save, response

我想将我的 json 响应存储在一个全局变量中，这样我就可以通过我的应用程序使用它，而无需多次发出 getJSON 请求。

```
var data;
$.getJSON("panorama.json",function(json){
data = json.images[0].src;
console.log(data);          
});

console.log(data); 
```

如果我在实际请求中记录它很好，但我在其他任何地方都得到“未定义”。任何评论appriciated。

编辑[从评论中复制]：试过......

```
$.myglobals = { result: "unset" } 

$(document).ready(function() { 

  $.getJSON( "panorama.json", function(json) { 
    $.myglobals.result = json.images[0].src; 
    console.log($.myglobals.result);     
  });

  console.log($.myglobals.result); 
}) ; 
```

第一个日志没问题，第二个未定义。

编辑[从答案复制]：

> 实际上这两种方法都有效
> 
> 有趣的是我的请求在一个函数中，我试图在同一个函数中的请求之后立即访问我的全局变量
> 
> 当我在功能之外访问它时，它就像一个魅力

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-19T21:45:19.910

如果您的真实代码是这样的结构，那么您在尝试访问尚未设置的数据时会遇到**问题**。仅仅因为您`$.getJSON()`在上面`console.log()`并不意味着您在记录数据值之前就得到了响应。

因此，您的问题不在于范围，而在于时机：引入一些服务器端滞后，您的解决方案也可能会崩溃。

如果收到响应，也许您应该设置一些标志：

```
var data, dataReceived = false;

$.getJSON("panorama.json",function(json){
  data = json.images[0].src;
  dataReceived = true;
  console.log(data);                    
});

// somwhere later
if (dataReceived) {
  console.log(data);
} else {
  // you could use setTimeout() or setInterval here to re-check
  console.log("data not received yet");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T18:21:29.757

您可以将其插入 DOM 中的属性（例如 #ID）并根据需要检索它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T18:23:57.833

这是一种方法，可让您在一个 $(document).ready() 中设置变量并在不同的 $(document).ready() 中使用它。 `myglobals`是一个命名空间对象，可以说它减少了你的全局变量与其他人的冲突的机会，特别是如果你将它命名为比“myglobals”更聪明的东西。

```
$.myglobals = {
  result: "unset" 
}

$(document).ready(function() {

  function pretend_JSON_call() {
    $.myglobals.result = {'a':"hello", 'b':"world" };
  }

  pretend_JSON_call();
});

$(document).ready(function() {
  alert($.myglobals.result['a']);
  alert($.myglobals.result['b']);
}); 
```

jsbin 中上述代码的临时链接[。](http://jsbin.com/ikoqi/edit)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-09T13:13:54.073

$.getJSON 触发 ajax 请求（问题范围内的关键字是异步的）。您的变量未定义，因为它尚未定义，响应尚未完成。其他人建议将您的 console.log 在代码中进一步向下移动，但除非您的逻辑与回调函数同步，否则无法保证它会可用。$.getJSON 接受回调函数作为其参数之一。

```
$.getJSON( "myData.json", function( data ) {
    //Do whatever, this is a callback
    $.each( data, function(key, val) {
       //You can get even more specific like so
    });
}); 
```

# java - 有没有更好的方法来逃避这个字符串？

> ID：1019356
> 
> 赞同：2
> 
> 时间：2009-06-19T18:18:54.083
> 
> 标签：java, algorithm, coldfusion

ColdFusion（或Java）中转换字符串的最快方法是什么：

```
Input:
79827349837493827498

Output:
\79\82\73\49\83\74\93\82\74\98 
```

我正在使用 LDAP GUID 并将其转义以进行查询。

我可以像这样进行一系列 MID 缩减：

```
 <CFSET V1 = "">
  <CFSET RetVal = "">
  <CFLOOP CONDITION="#V1# NEQ''">
      <CFSET RetVal = RetVal & "\" & MID(V1,1,2)>
      <CFSET V1 = MID(V1,3,2000)>
  </CFLOOP> 
```

但似乎会有更优雅的东西，比如正则表达式替换。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-19T18:25:35.960

我还没有测试过这个，所以语法可能是关闭的，但你应该能够做类似的事情：

```
<cfset V1 = REReplace(V1,"([0-9]{2})","\\\1","all")> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T21:59:06.560

在Java中你可以做

```
String text = text.replaceAll("(..)","\\\1"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T22:55:56.583

这是另一种可能的方式。

```
<cfset input = "79827349837493827498"/>
<cfset output = input/>

<cfloop from="#len(output)-2#" to="0" index="i" step="-2">
    <cfset output = insert("\",output,i)/>
</cfloop>

<cfoutput>#output#</cfoutput> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T21:51:05.997

怎么样...

```
<cfset input = "79827349837493827490">
<cfset output = "">

<cfloop from="1" to="#len(input)#" index="count" step="2">
   <cfset output &= "\" & mid(input, count, 2)>
</cfloop> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T22:04:17.750

我不知道 ColdFusion，但这里有一个简单的 Java 方法：

```
private String injectBackslashes(String string) {
    StringBuffer sb = new StringBuffer();
    for(int i = 0; i < string.length() / 2; ++i)
        sb.append('\\').append(string.substring(2*i, 2*i+2));
    return sb.toString();
} 
```

# flash - as3中精灵的最大尺寸？

> ID：1019360
> 
> 赞同：0
> 
> 时间：2009-06-19T18:19:43.583
> 
> 标签：flash, actionscript-3

as3 / flash 10 中的精灵大小是否有上限？

我知道[bitmapData 有局限性](http://www.bit-101.com/blog/?p=1426)......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T19:47:40.957

看来，xScale 和 yScale 可能不会超过 0x8000 ...

大小本身似乎也受到限制...我发现了一个限制 0x6666660 ...

这里的代码：

```
package {
    import flash.display.*;
    public class Main extends Sprite {
        public function Main():void {   
            var size:Number = 1;

            var s:Shape = new Shape();
            s.graphics.beginFill(0xFF00FF);
            s.graphics.drawRect(0, 0, size, size);

            var old:Number = 0;
            while (s.width > old) {
                old = s.scaleX; 
                s.scaleX *= 1.1;
            }
            trace(s.width.toString(16));

            size = 1;
            s.scaleX = 1;
            while (true) {
                size *= 2;
                s.graphics.clear();
                s.graphics.drawRect(0, 0, size, size);
                if (s.width < 0) break;
            }
            var min:Number = size / 2;
            var max:Number = size;

            while (true) {
                size = (min + max) / 2;
                s.graphics.clear();
                s.graphics.drawRect(0, 0, size, size);
                if (s.width < 0) max = size;
                else 
                    if (max - min < 1) break;
                    else min = size;

            }
            trace(s.width.toString(16));
        }
    }   
} 
```

没有找到任何关于它的文档......所以你甚至可以在你的机器上得到其他结果......

问候

back2dos

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-29T22:10:14.770

Back2dos 的帖子似乎信息量很大，但请注意您是否将缓存作为位图（`DisplayObject.cacheAsBitmap = true`应用 a`BitmapFilter`也会导致这种情况），因为您将受到闪存位图大小限制的限制。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-02-21T00:43:43.393

> In AIR 1.5 and Flash Player 10, the maximum size for a bitmap image is 8,191 pixels in width or height, and the total number of pixels cannot exceed 16,777,215 pixels. (So, if a bitmap image is 8,191 pixels wide, it can only be 2,048 pixels high.) In Flash Player 9 and earlier, the limitation is is 2880 pixels in height and 2,880 pixels in width.

Taken from [http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/DisplayObject.html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/DisplayObject.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-20T12:50:33.350

我对 Flash 6 有一些经验，那就是位图的 2880 x 2880 像素限制。

在创建影片剪辑时，拥有 50000 像素宽并没有问题，例如 10 倍缩放也没有问题。

所以我猜你对位图以外的任何东西都很安全，由于文件大小的限制，有时会有点痛苦。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-22T08:58:46.967

实际上，我建议您不要超过一些限制。我不是 100% 确定，但在我的测试中，您不能 BitmapData.draw() 任何宽度超过 4079 像素和高度为 4082 像素的 DisplayObject（实际上可以，但它们的绘制不会超出此限制）。但是，您可以绘制比这更大的 BitmapDatas。

我还发现这些值似乎是任何 DisplayObject 边界框的“安全”边界。比这更大的 DisplayObject 肯定会有很多错误……在这种情况下，边缘的渲染问题和周围的交互式故障很常见。

# iphone - OS 2.2.1 和 OS 3 之间的 Objective-C 变化？

> ID：1019365
> 
> 赞同：7
> 
> 时间：2009-06-19T18:21:11.973
> 
> 标签：iphone, objective-c, iphone-sdk-3.0

当我尝试为 OS 3 编译我的应用程序时，我遇到了以下错误：

错误：访问器类型与属性类型不匹配

错误是针对我尝试访问的属性定义如下：

```
NSMutableArray *myArray

@property (readonly,nonatomic) NSArray* myArray; 
```

该属性在实现文件中为@synthesized。

这在 OS 2.2.1 中工作得很好，但不是 OS 3.0

自己编写getter方法解决了这个问题。

有人知道 OS 2.2.1 和 3.0 之间的 Objective-c 的变化吗？这些更改是否有任何文档？

[API 更改文档](http://developer.apple.com/iphone/library/releasenotes/General/iPhone30APIDiffs/index.html#//apple_ref/doc/uid/TP40008401)似乎没有包含有关此问题的任何内容。

编辑

当您尝试访问该属性时发生错误，例如

```
NSArray *anArray = myClass.myArray; 
```

正如我上面提到的，我找到了一个解决方法：自己编写 getter 方法，但我真正想要的是来自苹果的某种文档，解释这个变化和任何其他与 API 无关的变化。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-23T08:28:30.967

这是一个编译器错误。

尽管您没有完全指定它，但我希望您的代码如下所示：

```
@interface Foo : NSObject {
    NSMutableArray *objects;
}
@property (readonly, copy) NSArray *objects;
@end

@implementation Foo
@synthesize objects;
@end 
```

不幸的是，编译器混淆了`objects` *属性*的声明和`objects` *实例变量*的声明。请记住，属性和实例变量在 Objective-C 中是不同的东西；属性可以由实例变量支持，但它实际上是类的公共接口的一部分。

您可以通过更改代码以明确地将实例变量的定义与属性的定义分开来解决此问题，例如通过为实例变量的名称添加前缀：

```
@interface Foo : NSObject {
    NSMutableArray *_objects;
}
@property (readonly, copy) NSArray *objects;
@end

@implementation Foo
@synthesize objects = _objects;
@end 
```

这样编译器就不会对表达式中的属性和实例变量感到困惑`self.objects`（无论如何它不应该，但显然是这样）。

只是为了避免不可避免的反应：Apple*不会*为实例变量保留下划线前缀。它是为方法保留的。无论如何，如果您不喜欢下划线，请随意使用另一个前缀。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-19T18:51:23.407

**编辑：**原始答案在同行评审后被删除，发现它缺乏。请阅读 Chris Hanson 对此事的评论。我把剩下的留在这里，因为我认为它仍然有效。

* * *

请注意，即使您将属性类型声明为`NSArray`，返回的对象仍然是，并且*为*它定义`NSMutableArray`了可变方法。以这种方式声明属性并*不能*防止某人意外地改变数组。

 **如果您想确保返回的数组不可变，您可以像在原始示例中一样声明该属性，然后滚动您自己的访问器：

```
- (NSArray *)myArray { return [NSArray arrayWithArray:myArray]; } 
```

请注意，这将返回一个未保留的`NSArray`. 如果对象需要持久化，则由调用者来获取对象的所有权。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-19T18:54:30.250

您看到错误是因为 XCode 现在针对以前没有的内容发出警告和错误...

我会争辩说，做你正在做的事情最多应该是一个警告，我理解你试图将数组呈现为对外部世界不可变但让它在类中可变的尝试。您可能需要考虑使用不同名称的不同访问器，专门用于返回可变数组。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T21:35:27.573

它仍然是 Objective-C 2.0；考虑到这种类型会改变错误，编译器可能只是稍微更新了一点。这几乎应该是一个错误。至少它应该警告您，您可能不是故意写的。然后你可以投一些东西让它不警告你，这是你不能用`@synthesize`语句做的。

我只是将您的代码和一个综合语句完全粘贴到我的控制器中，我没有收到任何错误或警告。它建得很好。现在我将基础 SDK 设置为“Simulator 3.0”，并将构建设置为“Simulator 3.0 Debug”。这个项目是在 2.2.1 SDK 开始的，我昨天刚安装了 3.0 SDK；Xcode 是 3.1.3 版。

**更新**：哦，我看到实际上试图设置属性是你得到你提到的错误的地方。

```
 self.myArray = [NSArray arrayWithObject:@"foo"]; 
```

显然，您不能`@synthesize`这样做，并且必须编写自己的访问器。

```
- (NSArray*)myArray {
    return [NSArray arrayWithArray:myArray];
}
- (void)setMyArray:(NSArray*) pMyArray {
    myArray = [NSMutableArray arrayWithArray:pMyArray];
} 
```

填写这些访问器，并没有让消息消失，所以我不得不将访问更改为：

```
 [self setMyArray:[NSArray arrayWithObject:@"foo"]]; 
```

在没有自定义访问器的情况下使用上述语法也不起作用。

PS 哇，还有其他人对您既不能复制消息气泡或构建结果窗口中的文本感到恼火吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T19:05:25.270

所以这真的与@synthesize 调用有关，它不喜欢将 NSMutableArray 公开为 NSArray - 为什么不直接实现 getMethod。

实际上考虑它一定是不高兴的 set 方法 - 你将无法将 NSArray 设置为 NSMutableArray。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-28T08:58:57.600

你的问题是：

> 有人知道 OS 2.2.1 和 3.0 之间的 Objective-c 的变化吗？
> 
> 这些更改是否有任何文档？

确定的答案是：

1) 语言规范没有有意更改，但编译器和其他开发工具发生了变化。克里斯和他的同事是这些变化的专家。

2) 可能不是，因为任何更改都是无意的，或者是为了更好地匹配文档的行为。

您不应该这么快就将克里斯的回答视为“猜测”。Chris 致力于 Apple 的开发人员工具。你可能会得到另一个你更喜欢的答案，但你不会得到更专业的答案。**

# php - 修剪空白区域

> ID：1019369
> 
> 赞同：3
> 
> 时间：2009-06-19T18:21:35.093
> 
> 标签：php, string

在包含引号的字符串中，我总是在结束引号之前得到一个额外的空格。例如

> “这是一个测试” *（字符串包括引号）*

*注意test*之后但在*end quote*之前的空格。我怎样才能摆脱这个空间？

我尝试了 rtrim 但它只适用于字符串末尾的字符，显然这种情况不在末尾。

有什么线索吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T18:24:59.253

好吧，去掉引号，然后修剪，然后把引号放回去。

让我们为此创建一个干净的函数：

```
<?php

function clean_string($string, $sep='"') 
{
   // check if there is a quote et get rid of them
   $str = preg_split('/^'.$sep.'|'.$sep.'$/', $string);

   $ret = "";

   foreach ($str as $s)
      if ($s)
        $ret .= trim($s); // triming the right part
      else
        $ret .= $sep; // putting back the sep if there is any

   return $ret;

}

$string = '" this is a test "';
$string1 = '" this is a test ';
$string2 = ' this is a test "';
$string3 = ' this is a test ';
$string4 = ' "this is a test" ';
echo clean_string($string)."\n";
echo clean_string($string1)."\n";
echo clean_string($string2)."\n";
echo clean_string($string3)."\n";
echo clean_string($string4)."\n";

?> 
```

输出：

```
"this is a test"
"this is a test
this is a test"
this is a test
"this is a test" 
```

这处理不带引号的字符串，仅在开头/结尾处有一个引号，并且完全引用。如果您决定将“'”作为分隔符，则可以将其作为参数传递。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T18:32:43.687

这是另一种方式，它只匹配字符串*末尾*的一系列空格和引号......

```
$str=preg_replace('/\s+"$/', '"', $str); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T18:23:47.053

您可以删除引号，修剪，然后重新添加引号。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T18:26:42.230

如果您的整个字符串用引号引起来，请使用前面的答案之一。但是，如果您的字符串**包含**带引号的字符串，您可以使用正则表达式在引号内修剪：

```
$string = 'Here is a string: "this is a test "';
preg_replace('/"\s*([^"]+?)\s*"/', '"$1"', $string); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T20:37:22.807

PHP 有一些内置函数可以做到这一点。[看这里。](http://us3.php.net/trim)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T18:36:53.320

rtrim 函数接受第二个参数，该参数可让您指定要修剪的字符。因此，如果您将引号添加到默认值，您可以修剪所有空格和任何引号，然后重新添加结束引号

```
$string = '"This is a test "' . "\n";
$string = rtrim($string," \t\n\r\0\x0B\"") . '"';
echo $string . "\n"; 
```

# image - cookie 是否与图像请求一起发送？

> ID：1019370
> 
> 赞同：39
> 
> 时间：2009-06-19T18:21:39.930
> 
> 标签：image, cookies, request

如果我有一个站点（例如 foo.com）并且在 foo.com 的主页上，有一个图像请求，其中 src=bar.com...，将 bar.com 域上的 cookie 发送到bar.com 服务器？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-06-19T18:23:00.270

是的。HTTP 不区分一种资源或另一种资源（图像与 html）。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-06-19T18:29:51.240

cookie 通常包含在任何类型的请求中，但您描述的场景是所谓的*第三方 cookie*（即，cookie 设置在与加载页面的域不同的域上）并且大多数浏览器提供隐私设置来阻止第三方 cookie。

第三方 cookie 允许 bar.com 的所有者在 foo.com 上放置图像（例如横幅广告）并跟踪 foo.com 的用户，即使这些用户从未访问过 bar.com。这是一个隐私问题，许多用户选择阻止此类 cookie。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-11-12T01:03:47.780

如果用户未阻止第三方 cookie，则大多数现代浏览器将在向第三方网站发出请求时设置或发送第三方域的 cookie。IE 6 有一种不同的阻塞机制，称为 leashing。wiki：一个 leashed cookie 是一种第三方 cookie，仅在通过相同的第一方访问第三方文档时由浏览器发送。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2021-09-24T16:49:22.893

这个问题很老，但对我来说是谷歌上的第一个结果，所以我认为有必要澄清一下现在（2021 年）它是如何工作的。

当 bar.com 设置 cookie 时，他们可以指定一个`SameSite`属性。

如果 cookie 设置为**SameSite=Lax**（或未指定 SameSite 属性），则不会为bar.com 上托管的图像 /iframes/etc**的请求发送cookie，但****会**在用户单击链接时发送在将他们带到 bar.com 的 foo.com 主页上

如果 cookie 设置为**SameSite=Strict**，则 cookie**不会**包含在来自其他网站的对 bar.com 的请求中，包括如果用户单击 foo.com 上的 bar.com 链接。

如果 cookie 设置为**SameSite=None**，则 cookie**将**被发送到 bar.com，包括对图像的请求。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-19T18:57:04.300

是的，所有请求都会发送 cookie。这包括“img”和“script”以及来自 javascript 的 XMLHttpRquest 调用，并且可能是脚本标签上的安全问题，因为一个网站加载的脚本可以从另一个网站加载脚本，并且也会发送其身份验证 cookie。这可以被利用来窃取数据。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-12-19T06:32:17.460

是`aspx/js/css/image`的，请求需要 cookie 验证。

# c# - 保护文件上传对话框

> ID：1019378
> 
> 赞同：0
> 
> 时间：2009-06-19T18:23:01.143
> 
> 标签：c#, windows, security, file-upload

我正在使用 C# 在 Windows XP 上开发一个项目，我们必须捕获一个允许用户选择多个文件的文件对话框（如此处所示：[http](http://www.uploadify.com/demo/) ://www.uploadify.com/demo/ ）。是否有可能以某种方式限制对本地驱动器的访问，例如 C: 等...？因此，可用驱动器列表将仅包含未排除的驱动器。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T17:14:15.923

可能最简单的方法是编写您自己的对话框，该对话框仅公开您想要的驱动器。我认为标准对话框不接受控制显示哪些驱动器的标志。

话虽如此，有 /is/ 系统范围的组策略可用于从所有常见文件对话框中隐藏驱动器，但这会影响所有应用程序。

如果你正在建造一个信息亭，请记住坏人经常攻击这些东西。（见[http://ikat.ha.cked.net/Windows/index.html](http://ikat.ha.cked.net/Windows/index.html)，奇怪的是，NSFW）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T18:32:55.043

为什么要将其限制为本地驱动器？这是客户端的工作，而不是服务器的工作。如果他们使用标准的网络浏览器，你不能强迫他们这样做。

# silverlight - 将 ClientBin 文件夹中的文件绑定到 Silverlight 中的组合框？

> ID：1019383
> 
> 赞同：1
> 
> 时间：2009-06-19T18:23:35.340
> 
> 标签：silverlight, data-binding, combobox

我想知道是否可以将 ClientBin 文件夹的给定目录中的一些文件名绑定到 ComboBox。

我正在开发这个有视频教程部分的应用程序。我有一个组合框，可让用户选择他们希望看到的教程视频。

现在并不是所有的视频都完成了（这有点费时），我想部署应用程序。如果我以后可以处理视频并将它们上传到我的 ClientBin/Videos 目录并让我的 Silverlight 应用程序自动拾取它们，而无需进入 XAML 并将新视频添加到 ComboBox，那就太好了。

有谁知道这是否可行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T18:27:44.787

你打赌。不过，您需要在 IIS 中打开目录浏览。一旦你这样做了，

*   使用 WebClient 的 DownloadString 功能并向 /Videos 发出请求。
*   解析结果，你有一个文件列表

# c# - 将全选快捷方式（Ctrl + A）添加到.net listview？

> ID：1019388
> 
> 赞同：20
> 
> 时间：2009-06-19T18:24:03.950
> 
> 标签：c#, .net, listview, keyboard-shortcuts

就像主题说我有一个列表视图，我想向它添加`Ctrl`+`A`全选快捷方式。我的第一个问题是我无法弄清楚如何以编程方式选择列表视图中的所有项目。看起来它应该相对容易，比如`ListView.SelectAll()`or `ListView.Items.SelectAll()`，但事实并非如此。我的下一个问题是如何为`ListView`. 我是否在`KeyUp`活动中这样做，但是您将如何同时检查两台印刷机？还是您设置的属性？

这里的任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-06-19T18:36:34.460

您可以通过以下方式完成两者：

```
private void listView1_KeyDown(object sender, KeyEventArgs e)
{
    if (e.KeyCode == Keys.A && e.Control)
    {
        listView1.MultiSelect = true;
        foreach (ListViewItem item in listView1.Items)
        {
            item.Selected = true;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-07-13T09:03:48.050

这些适用于小列表，但如果虚拟列表中有 100,000 个项目，这可能需要很长时间。出于您的目的，这可能有点矫枉过正，但以防万一::

```
class NativeMethods {
    private const int LVM_FIRST = 0x1000;
    private const int LVM_SETITEMSTATE = LVM_FIRST + 43;

    [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]
    public struct LVITEM
    {
        public int mask;
        public int iItem;
        public int iSubItem;
        public int state;
        public int stateMask;
        [MarshalAs(UnmanagedType.LPTStr)]
        public string pszText;
        public int cchTextMax;
        public int iImage;
        public IntPtr lParam;
        public int iIndent;
        public int iGroupId;
        public int cColumns;
        public IntPtr puColumns;
    };

    [DllImport("user32.dll", EntryPoint = "SendMessage", CharSet = CharSet.Auto)]
    public static extern IntPtr SendMessageLVItem(IntPtr hWnd, int msg, int wParam, ref LVITEM lvi);

    /// <summary>
    /// Select all rows on the given listview
    /// </summary>
    /// <param name="list">The listview whose items are to be selected</param>
    public static void SelectAllItems(ListView list) {
        NativeMethods.SetItemState(list, -1, 2, 2);
    }

    /// <summary>
    /// Deselect all rows on the given listview
    /// </summary>
    /// <param name="list">The listview whose items are to be deselected</param>
    public static void DeselectAllItems(ListView list) {
        NativeMethods.SetItemState(list, -1, 2, 0);
    }

    /// <summary>
    /// Set the item state on the given item
    /// </summary>
    /// <param name="list">The listview whose item's state is to be changed</param>
    /// <param name="itemIndex">The index of the item to be changed</param>
    /// <param name="mask">Which bits of the value are to be set?</param>
    /// <param name="value">The value to be set</param>
    public static void SetItemState(ListView list, int itemIndex, int mask, int value) {
        LVITEM lvItem = new LVITEM();
        lvItem.stateMask = mask;
        lvItem.state = value;
        SendMessageLVItem(list.Handle, LVM_SETITEMSTATE, itemIndex, ref lvItem);
    }
} 
```

你像这样使用它::

```
NativeMethods.SelectAllItems(this.myListView); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-08-22T09:34:57.867

```
private void listView1_KeyDown(object sender, KeyEventArgs e)
{
    if (e.KeyData == (Keys.A | Keys.Control))
        foreach (ListViewItem item in listView1.Items)
            item.Selected = true;
} 
```

*仅*在Ctrl+A 上执行此操作，而不是在 Ctrl+Shift+A 等其他组合上执行此操作。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-12-15T15:03:19.363

`Ctrl`如果用户先释放密钥，第一个解决方案将不起作用。

您应该改用该`KeyDown`事件：

```
private void listView1_KeyDown(object sender, KeyEventArgs e)
{
    if (e.KeyCode == Keys.A && e.Control)
    {
        listView1.MultiSelect = true;
        foreach (ListViewItem item in listView1.Items)
        {
            item.Selected = true;
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-06T13:23:04.060

我无法对第一个问题发表评论，但是使用 KeyDown 的解决方案对我不起作用，因为系统会立即对按下的 LeftCtrl 做出反应，因此会跳过 CTRL+A。从另一边 KeyUp 工作正常。

```
private void listView1_KeyUp(object sender, KeyEventArgs e)
{
    if (e.KeyCode == Keys.A && e.Control)
    {
        listView1.MultiSelect = true;
        foreach (ListViewItem item in listView1.Items)
        {
            item.Selected = true;
        }
    }
} 
```

# vim - 从 Vim 切换到 Emacs 的最佳方法？

> ID：1019406
> 
> 赞同：33
> 
> 时间：2009-06-19T18:27:15.613
> 
> 标签：vim, emacs

尽管是 Vim 用户，但我对开始学习 Emacs 很感兴趣。然而，每当我开始学习 Emacs 教程时，我最终都会意外地使用 Vim 命令并对此感到沮丧。

有没有更好的方法来进行切换？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-06-19T18:31:03.783

我会建议只是在事故发生之前幸存下来，直到事故频率降低。我怀疑添加一个层来尝试“帮助”——比如尝试推断意外的 vi 命令并执行它们——只会使转换变慢。

在版本控制系统之间转换时，我也会做同样的事情。与其创建一个 shell 脚本包装器，让我通过将错误的子命令翻译成新的 VCS 习语来继续使用它们，我真的宁愿被迫“说新系统的语言”冷火鸡。

记住：你是人；你已经建立了适应新情况。只要保持你的智慧，让错误成为错误，你会做得很好。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-06-19T21:12:38.540

练习练习练习。正如您在学习 Vim 时可能知道的那样，Vim 和 Emacs 的流畅性只有通过大量练习才能获得，直到命令成为第二天性。我是一个长期的 V​​immer 并且学习 Emacs 非常痛苦并且花了几个月的时间，但现在我两个都过得很好。值得学习，因为 Emacs 在编辑某些语言和完成某些任务方面比 Vim 更好，反之亦然；可以选择使用其中任何一个都很好。一段时间后，您开始在心理上将两者区分开来，您可能不会遇到太大困难（尽管我仍然偶尔会遇到`:wq`Emacs 和`C-/`Vim，但它发生的频率不足以成为问题）。

*   彻底阅读 Emacs 文档。Vim 和 Emacs 的许多术语和功能是相似的，但只是不同，足以让人感到困惑。本教程是一个好的开始，但[Emacs 手册](http://www.gnu.org/software/emacs/manual/emacs.html)是最佳实践和配置技巧的宝库。

*   [Emacs wiki](http://www.emacswiki.org/)是您的朋友。当您遇到一个您绝对不能接受的 Emacs 功能时，通常有一种方法可以配置该问题。

*   `C-h a`也是你的朋友。就像`:h`在 Vim 中必不可少的一样，Emacs 帮助系统在导航 Emacs 的大量内置命令时是一个巨大的福音。有很多方法可以搜索文档以找到您想要的；[这个页面](http://www.emacswiki.org/emacs/EmacsNewbieHelpReference)有一个很好的总结。

*   不要使用 viper 或 vimpulse，至少一开始不要。Emacs 永远不会像 Vim 那样出色。让自己沉浸在 Emacs 中，直到习惯为止。Emacs 做事的方式非常不同，但与 Vim 的键绑定集相比，它有自己的优势（和劣势）。学习它们，这样您就可以看到这些优势和劣势并做出明智的决定。现在我借用了一堆 Emacs 快捷方式并在 Vim 中映射它们，反之亦然。

*   慢慢来。当（不是如果）Emacs 开始让你怒不可遏时，休息一下，跳进 Vim，稍后再回来。这需要一段时间。

请记住，您不需要“切换”。你不会忘记 Vim 并在你的大脑中用 Emacs 代替它。如果您了解 Vim 并学习 Emacs，那么您将两者都了解。这是一件好事。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-06-19T18:30:41.613

你试过 Emacs 的[viper-mode](http://www.emacswiki.org/emacs/ViperMode)吗？

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-19T18:30:16.577

Vim 与 Emacs 辩论的持续时间和强度相当强烈地表明，这两个编辑器的实用性大致相同。如果你已经知道 vi，你不妨坚持下去。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-19T18:41:07.870

我对此没有任何经验（我使用 Vim），但[Vimpulse](http://www.emacswiki.org/emacs/vimpulse.el)是一个模拟 Vim 的 Emacs 脚本（与模拟 vi的[Viper 模式相对）。](http://www.emacswiki.org/emacs/ViperMode)这可能会使过渡更容易。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-19T18:50:55.543

我认为这取决于你学习 Emacs 的动机。

如果您只是对学习 Emacs 有兴趣，[viper 模式](http://www.gnu.org/software/emacs/manual/html_node/viper/index.html#Top)可能是您要走的路，因为它可能不值得重新训练您的肌肉记忆所带来的痛苦和挫败感。您仍然可以访问所有出色的 Emacs 功能，但可以根据您选择的 viper 级别自定义您的体验。

如果你想学习是因为你想拥有一个完全可定制的编辑器，那么我会选择一个你认为可能有趣的任务，并用它来激励 Emacs 的使用。这种体验对你来说将是独一无二的。在这种情况下，我建议去冷火鸡，只期待几天的痛苦和沮丧。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-09-21T06:11:19.190

作为一个转换者，以及以前的 vim 用户，我强烈推荐 viper-mode。它并不完美，但它会为您提供大部分 vi/vim 键绑定。您将毫不费力地学习在 vim（IME，大多数以 'g' 开头的命令）中习惯使用的几个命令。

总的来说，我真的觉得这是使用 Emacs 的最佳方式。vi 键绑定非常非常有效，而且我认为对于我在文本编辑器中所做的很多事情（简单的移动命令，涉及移动、删除、更改、搜索等的简单命令），vi 模型是与 Emacs 相比，更加精简和高效。我完全可以理解为什么不熟悉 Emacs 的人不想使用 viper 模式，但作为来自 vim 的人，你真的有机会两全其美。

一般来说：习惯 viper 模式并不完美这一事实，学习如何以 Emacs 的方式完成你所缺少的事情，并确保你探索 Emacs 中没有的很酷的功能vim。

至于使用vimpulse，我第一次切换的时候就试过了，不太推荐。因为它是一种主要模式，你会错过很多（大部分？）关于 Emacs 的好东西；无论如何，它仍然不是 100% 忠实于 vim。采用 viper 模式确实要好得多，然后继续前进。

# configuration - 如何在 XML 配置文件之外配置 JBoss JDBC 数据源连接？

> ID：1019410
> 
> 赞同：0
> 
> 时间：2009-06-19T18:29:07.733
> 
> 标签：configuration, jboss, datasource

我想覆盖从 XML 配置文件加载 JDBC 连接信息的 JBoss 部分。我想继续使用 JBoss 的其余连接池/缓存功能。我只想从另一个来源加载连接数据。

**我应该实现哪个 MBean 以及如何在 JBoss 中配置覆盖？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T23:27:56.383

JBoss -ds.xml 描述符实际上涵盖了许多问题。如果您查看 JBoss JVM 控制台，您会发现每个数据源都有 4 或 5 个 MBean。您可能会以编程方式执行此操作，但我不会给出很好的机会。

我的建议是使用第 3 方连接池库（例如[Commons DBCP](http://commons.apache.org/dbcp/)）。使用它定义池，然后[将生成的 DataSource 绑定到 JNDI](http://commons.apache.org/dbcp/guide/jndi-howto.html)。使用池的客户端应用程序不应该知道任何区别。

# c# - 带有存储过程和用户 定义的表类型参数的 LINQ to SQL

> ID：1019414
> 
> 赞同：23
> 
> 时间：2009-06-19T18:29:52.927
> 
> 标签：c#, linq-to-sql, stored-procedures

我在 SQL Server 2008 中将 LINQ to SQL 与存储过程一起使用。除了一个问题外，一切都运行良好。L2S 无法生成以用户定义的表类型为参数的存储过程的方法。dbml 设计面板中的方法签名使用对象作为参数类型而不是表类型，当我尝试编译时出现错误：

```
Error: DBML1005: Mapping between DbType 'Structured' and
Type 'System.Object' in Parameter 'ParaName' of Function 'dbo.StoredProcName'
is not supported. 
```

有没有办法解决这个问题？我不想回到传统的 ADO.NET 数据访问。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-06-19T19:23:13.097

我认为现在没有任何可用的东西——在 SQL Server 2008 中引入了表值参数——在 LINQ 和 LINQ2SQL 已经出现之后。

到目前为止，我还没有在任何博客文章中提到对 .NET 4.0 中 LINQ2SQL 中表值参数的支持。

**更新：**
这是Damien Guard撰写的关于 .NET 4.0 时间范围内 Linq-to-SQL 的修复和改进的[博客文章。](http://damieng.com/blog/2009/06/01/linq-to-sql-changes-in-net-40)

**更新 2：**
不幸的是，根据 Damien 的说法，.NET 3.5 不支持此功能，.NET 4.0 也不支持此功能:-(

*现在不能在 3.5 或 4.0 中完成
:( [)amien*

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-05-08T18:52:26.077

我碰巧看到这篇[文章](http://blog.mikecouturier.com/2010/01/sql-2008-tvp-table-valued-parameters.html)，它提供了一种使用来自 Linq2Sql 的 TVP 参数调用存储过程的方法。这是一个循环方法，它基本上创建了 dataContext 的部分类扩展，并使用 SqlCommand 传递了一个 dataTable。我希望它有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-24T20:30:47.230

我遇到了完全相同的问题，来自以下链接的 Ryan Prechel 的示例代码帮助我解决了这个问题。

[如何从.net代码将表值参数传递给存储过程](https://stackoverflow.com/questions/5595353/how-to-pass-table-value-parameters-to-stored-procedure-from-net-code/10779567#10779567)

# c# - 如何使 LINQ to SQL 使用在运行时修改的连接字符串？

> ID：1019434
> 
> 赞同：7
> 
> 时间：2009-06-19T18:35:02.840
> 
> 标签：c#, sql-server, linq-to-sql, ado.net, app-config

我正在尝试在 LINQ to SQL中使用[**连接字符串生成器 (ADO.NET)时遇到一些困难。**](http://msdn.microsoft.com/en-us/library/ms254947.aspx)让我向你们展示我正在尝试做的事情：

> **app.config**文件：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <configSections>
    </configSections>
    <connectionStrings>
        <add name="LoremIpsum"
             connectionString="Data Source=SomeServer;Initial Catalog=SomeDB;User ID=joe;"
             providerName="System.Data.SqlClient" />
    </connectionStrings>
</configuration> 
```

> 和表单的一个片段：

```
ConnectionStringSettings settings = 
    ConfigurationManager.ConnectionStrings["LoremIpsum"];
if (null != settings)
{
    string connection = settings.ConnectionString;
    SqlConnectionStringBuilder builder = 
         new SqlConnectionStringBuilder(connection);

    // passwordTextBox being the control where joe the user actually 
    // enters his credentials           
    builder.Password = passwordTextBox.Text;
}

LINQTOSQLDataClassDataContext db = new LINQTOSQLDataClassDataContext();

// finally some rather anecdotic LINQ sentence here:
var foo = db.Table.Single(bar => bar.Table == whatever); 
```

> 另一方面检查**即时窗口**：

```
?builder.ConnectionString
"Data Source=SomeServer;Initial Catalog=SomeDB;User ID=joe;Password=swordfish" 
```

我总是遇到异常：用户“joe”登录失败。有任何想法吗？提前非常感谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-19T18:48:06.517

您似乎正在尝试修改存储在 app.config 文件中的连接字符串。当您为数据上下文使用无参数构造函数时，它会读取在设计时配置的内容。

尝试将修改后的连接字符串注入 DataContext 的构造函数：

```
ConnectionStringSettings settings = ConfigurationManager.ConnectionStrings["LoremIpsum"];
SqlConnectionStringBuilder builder;
LINQTOSQLDataClassDataContext db;

if (null != settings) 
{   
    string connection = settings.ConnectionString;  
    builder = new SqlConnectionStringBuilder(connection);

   // passwordTextBox being the control where joe the user actually enters his credentials

    builder.Password =passwordTextBox.Text;  
    db = new LINQTOSQLDataClassDataContext(builder.ConnectionString);
 } } 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-19T18:45:09.733

您忘记将连接字符串发送到 DataContext 构造函数。

例子：

```
LINQTOSQLDataClassDataContext db = new LINQTOSQLDataClassDataContext(builder.ConnectionString); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-19T18:49:21.427

您可以强制 a`DataContext`使用特定的连接字符串

```
DataContext db = new DataContext(myConnectionString); 
```

无参数`DataContext`构造函数将首先使用`App.config`文件中的连接字符串，然后是编译时设置的连接字符串。

# ruby-on-rails - 在 Rails 中运行 Test::Unit 测试时加载 lib 文件？

> ID：1019445
> 
> 赞同：3
> 
> 时间：2009-06-19T18:36:46.720
> 
> 标签：ruby-on-rails, testing

我添加了一些模块并将它们放在我的 /lib 目录中，我认为 lib 目录是由 Rails 神奇地加载的（除非我在项目早期的某个地方加载了 lib 目录并忘记了它）。但是，当我运行需要我的附加模块的单元测试时，它们不会被加载。

运行测试时是否应该自动加载 lib 目录，还是有一种优雅的方式来进行测试？我曾希望 rake 脚本 + Test::Unit 能够准确地加载我的 Rails 环境，但事实并非如此。我只需要在 test_helper.rb 中添加类似这样的内容：

```
require File.expand_path(File.dirname(__FILE__) + "/../lib/foo") 
```

我正在使用标准 rake 脚本运行我的测试，例如：

```
rake test
rake test:units
rake test:functionals 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T18:45:05.727

您的 lib 目录不会由 rails 自动加载。通过覆盖 const_missing 的 ActiveSupport::Dependencies 进行加载。第一次使用常量时，如果它未定义，Rails 会尝试在 lib 目录（以及加载路径中的其他位置）中找到它。为了实现这一点，它使用了一个命名方案，其中被调用`SomeClass`的东西应该在`some_class.rb`. 测试模式下的 Rails 使用相同的机制。检查你的 config/environments/test.rb 和 config/environments/development.rb 看看你是否对需求做了一些有趣的事情。简而言之，检查您的命名方案。

# sharepoint - 在 SharePoint 中嵌入 IronPython 的示例代码？

> ID：1019447
> 
> 赞同：0
> 
> 时间：2009-06-19T18:37:04.553
> 
> 标签：sharepoint, ironpython

我想使用 IronPython 进行 SharePoint 开发，但我还没有看到任何将 IronPython 嵌入到 SharePoint 中的示例。

有没有人有一个可以让我开始的工作示例？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-22T17:34:37.817

嵌入 SharePoint 是什么意思？转换为程序集的 ipy 脚本应该在使用它们的 C# 或 VB.Net 兄弟的任何地方正常运行（假设 IronPython 支持程序集是可引用的。

我个人喜欢将其用作更强大的脚本化 stsadm 解决方案，因为很难使用 SharePoint 正确处理 Powershell 错误。

# iphone - iPhone 3.0 SDK 上的 MPMoviePlayerController

> ID：1019450
> 
> 赞同：1
> 
> 时间：2009-06-19T18:37:13.820
> 
> 标签：iphone, video, sdk

Apple 是否对 iPhone 3.0 SDK 上的 MPMoviePlayerController 类进行了任何更改？当我点击正确的按钮时，我的应用不再弹出视频，没有错误弹出或任何内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T11:29:20.940

我在我的应用程序中也注意到了这一点。但是一段时间后它又开始工作了，没有任何变化！Apple 文档中没有任何内容表明他们进行了任何更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-20T00:25:08.557

通过比较 MPMoviePlayerController 的 2.1 和 3.0 文档，我所看到的没有任何变化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T18:41:40.987

您确定您的 nib 文件最近没有任何变化吗？

当您按下按钮时，您是否确认正在调用您的操作方法？

# get - Bittorrent 跟踪器请求

> ID：1019454
> 
> 赞同：7
> 
> 时间：2009-06-19T18:37:41.760
> 
> 标签：get, request, bittorrent, tracker

使用来自的 torrent 文件

```
http://torrent.ubuntu.com:6969/ 
```

我正在计算它的哈希值，它与页面上的哈希值相匹配。

然后我向跟踪器发出请求。像

```
http://torrent.ubuntu.com:6969/announce?info_hash=9a81333c1b16e4a83c10f3052c1590aadf5e2e20 
```

但我明白了

> d14:failure reason63:请求的下载未被授权用于此tracker.e

根据规范，这应该有效吗？

[追踪器规格](http://wiki.theory.org/BitTorrentTrackerProtocol) [一般规格](http://wiki.theory.org/BitTorrentSpecification)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T19:10:23.263

您指定了十六进制的 info_hash，而不是 URL 编码。SHA-1 哈希的字节应直接编码，如下所示：

```
http://torrent.ubuntu.com:6969/file?info_hash=%9A%813%3C%1B%16%E4%A8%3C%10%F3%05%2C%15%90%AA%DF%5E.%20 
```

此外，对于`announce`URL，`peer_id`通常需要一些附加参数，例如。

# python - 有没有一种简单的方法来转换 std::list 到 Python 列表？

> ID：1019457
> 
> 赞同：2
> 
> 时间：2009-06-19T18:39:23.410
> 
> 标签：python, c, stl

我正在用 C/C++ 编写一个小 Python 扩展，并且我有一个这样的函数：

```
void set_parameters(int first_param, std::list<double> param_list)
{
   //do stuff
} 
```

我希望能够像这样从 Python 调用它：

```
set_parameters(f_param, [1.0, 0.5, 2.1]) 
```

有没有一种相当简单的方法来进行这种转换？理想情况下，我想要一种不需要大量额外依赖项的方法，但是如果没有额外的东西，有些事情是不可能的，所以这没什么大不了的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T19:07:21.227

看看[Boost.Python](http://www.boost.org/doc/libs/1_39_0/libs/python/doc/index.html)。您提出的问题已在本教程的[迭代器](http://www.boost.org/doc/libs/1_39_0/libs/python/doc/tutorial/doc/html/python/iterators.html)章节中介绍

关键是，Boost.Python 提供了 stl_input_iterator 模板，它将 Python 的 iterable 转换为 stl 的 input_iterator，可以用来填充你的 std::list。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T21:29:57.663

事实证明，这比我想象的要少痛苦，一旦我找到了在我提出问题之前我可能应该阅读的文档。我能够在我的包装函数中获得一个 PyList 对象，然后对其进行迭代并将值推送到我需要的向量上。代码如下所示：

```
static PyObject* py_set_perlin_parameters(PyObject* self, PyObject* args)
{
    int octaves;
    double persistence;
    PyObject* zoom_list;
    int zoom_count = 0;
    std::vector<double> zoom_vector;

    if(!PyArg_ParseTuple(args, "idO!:set_perlin_parameters", &octaves, &persistence, &PyList_Type, &zoom_list))
    {
        return NULL;
    }

    if(!PyList_Check(zoom_list)) 
    {
        PyErr_SetString(PyExc_TypeError, "set_perlin_parameters: third parameter must be a list");
        return NULL;
    }

    zoom_count = PyList_Size(zoom_list);

    for(int i = 0; i < zoom_count; i++)
    {
        PyObject* list_val;
        double val;

        list_val = PyList_GetItem(zoom_list, i);

        if(list_val == NULL)
        {
            return NULL;
        }

        val = PyFloat_AsDouble(list_val);

        zoom_vector.push_back(val);
    }

    set_perlin_parameters(octaves, persistence, zoom_vector);

    return Py_None;
} 
```

# flash - 潘多拉网站用户档案系统

> ID：1019460
> 
> 赞同：5
> 
> 时间：2009-06-19T18:39:39.307
> 
> 标签：flash, authentication, cookies, persistence

用户注册后，Pandora 如何保存用户个人资料/帐户？它如何记住用户 - 即使在用户清除了 cookie 和缓存之后。

我发现如果您使用一个浏览器注册并使用另一个浏览器访问 Pandora.com，您就会被识别为注册用户。

他们是如何做到的呢？

chrome、ff3、ie8参与了测试。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-19T18:53:05.913

Pandora 将一些信息存储在 Flash 本地存储中，包括您的用户名和登录凭据。当您清除浏览器中的 cookie 时，它​​不会清除 Flash 本地存储，这就是 Pandora 仍然记得您的原因。

此外，由于 Flash 本地存储在该计算机上的所有浏览器之间共享，因此任何浏览器中的 Flash 都可以使用这些设置。

如果您在任何时候想要清除 Flash 本地存储，您可以右键单击 Flash 应用程序（即 Pandora 音乐播放器）并选择“设置...”，然后在“本地存储”选项卡中将其向下滑动到 0 然后“好的”。请记住，下次启动 Pandora 时，您必须允许它再次存储一些数据，否则它将无法加载。

# xsd - 用于描述关系数据库模式的标准数据库中性 XSD

> ID：1019463
> 
> 赞同：5
> 
> 时间：2009-06-19T18:40:28.713
> 
> 标签：xsd, entity-relationship, relational-database, database-agnostic

有人知道供应商中立的 XSD 来描述关系数据库模式吗？我们的系统需要获取有关数据库结构的信息：

*   表
*   列和类型
*   主键和外键约束
*   索引
*   ETC

以独立于供应商的方式并将其存储在 XML 文件中以供以后处理。

在我们做我们通常做的事情并自己动手之前。我想做一些研究，看看是否存在人们正在标准化的现有 XSD，因为我认为这对建模工具等并不少见。我在谷歌上没有找到任何不是数据库供应商特定的东西。如果您知道现有的公共标准，我将非常感谢您提供链接。

提前致谢，

特伦斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T19:05:30.840

这并不完全是您正在寻找的内容，但[PostgresSQL Wiki](http://wiki.postgresql.org/wiki/XML_Support)有一个关于 XML 导出的有趣部分，描述了它们如何同时支持 SQL 和 XML。它显示了有关如何将表导出为 XML 和支持它的 XSD 的部分，这看起来相当通用。它可以作为您创建自己的模型。

Wiki 讨论了对 ISO/IEC 9075-14:2006 标准的引用，该标准似乎被一些大供应商采用作为基准。我在 ISO 网站上快速浏览说：2006 已[更新](http://www.iso.org/iso/iso_catalogue/catalogue_ics/catalogue_detail_ics.htm?csnumber=45499)到 2008。我相信您可以找到一个涵盖的规范，您无需付费即可下载。

本文还指出了一个有点过时的[SQL/XML 标准](http://www.sqlx.org/)定义，但如果您正在寻找一些基础知识，它可以满足您的需求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T19:08:46.887

有趣的问题 - 我不知道有任何标准或工具来实现这一点。

您几乎必须为您要定位的每个单独的数据库系统提供某种带有适配器的“中和”版本 - 甚至只是映射所有各种数据类型（SQL Server 中的 VARCHAR 和 NVARCHAR，Oracle 中的 VARCHAR2 等等） .

您可能只使用 SQL:2003 标准中定义的类型 - 但即便如此，您可能仍然需要某种特定于供应商的映射/适应类型。更不用说对特定于供应商的实现细节的某种支持（例如 SQL Server 中的 IDENTITY 列与 Oracle 中的 SEQUENCE 等）。

非常有趣的问题！我希望其他人能够更多地了解这个问题，并可能推荐一个现有的工具。

如果没有，并且您决定自己推出 - 考虑在 CodePlex 或 Google Code 上将其开源！相信很多人都会很感兴趣！

马克

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-31T12:41:36.630

OMG 的 UML 信息管理元模型 (IMM) 规范可能值得一试。

# java - 拥有工厂时在哪里放置 getAll() 方法

> ID：1019466
> 
> 赞同：1
> 
> 时间：2009-06-19T18:41:21.083
> 
> 标签：java, factory

我正在做一个java应用程序。

到目前为止，这是我的文件：

## 人机界面。

有一个 setName(String aName) 方法

## PersonImpl

人员界面的实现。

## PersonFactory 接口

有一个 createPerson()

## PersonFactoryImpl

PersonFactory 接口的实现。

问题是我愿意添加一个 getAll() 方法，它返回一个人的集合，但我不知道把它放在哪里。

我正在考虑将其作为静态方法添加到 PersonImpl 或 PersonFactoryImpl，但我不确定。

哪个是最好的方法？

谢谢阅读！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T18:43:57.740

合乎逻辑的方法是将其作为静态方法添加到`PersonFactory`. 那是生成您的`Person`对象的类，如果它保留对所有生成的对象的引用，它应该能够回答您的`getAll()`API。

显然，每个对象都知道其他相似对象是不合理的`Person`，因此这种方法不属于那里。

**编辑：**鉴于它们驻留在数据库中，明智的做法是将`PersonFactory`（创建`Person`对象的作业）与`PersonRepository`实际访问数据库（或您拥有的任何持久性）并返回`Person`对象的对象分离。

同一个类既负责创建对象又负责从数据库中获取对象，这对我来说似乎很尴尬。话虽如此，如果您的应用程序需要这种紧耦合，它可能是可以接受的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T18:48:52.363

如果提供了 PersonFactory 的另一个实现，是否也需要提供 #getAll？如果是这样，它属于接口......然后它不能是Java中的静态方法。

鉴于此，它是您的 PersonFactory 的一个功能，还是您的存储机制也应该有一个抽象？如果是这样，其实现接受 PersonFactory 并为 getAll 类型功能提供自然归宿的 PersonRepository 接口似乎更合适。如果不是，那么作为具体 PersonFactory 的成员可能就足够了......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T19:33:55.883

工厂负责管理 Persons 的实例，所以这是放置它的正确位置。此外，它应该是非静态`createPerson()`的。

# jquery - 如何使用 Jquery 在单选按钮后选择字符串？

> ID：1019474
> 
> 赞同：0
> 
> 时间：2009-06-19T18:42:40.550
> 
> 标签：jquery

代码示例：

```
<table>
<tr>
  <td>
    <input type="radio" name="SomeName" value="3" checked>
    My String $10.00
  </td>
</tr>
</table> 
```

如何选择“我的字符串 $10.00”对客户隐藏？

```
$('???').next().hide(); 
```

编辑：

上面的 HTML 是自动生成的..我无法控制它....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T18:44:18.190

```
$('input[name=SomeName]').parent().text(); 
```

如果您想隐藏该文本，最好将其包含在段落、跨度或标签标签中，因此您可以执行以下操作：

```
$('input[name=SomeName]').parent().find('span').hide(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T18:47:14.553

jQuery 不允许轻松访问文本节点。也许您可以将 HTML 更改为以下内容？

```
...
<input type="radio" id="myID"/>
<label for="myID">My String $10.00</label>
... 
```

然后你可以这样做：

```
$("input[type=radio]").next().hide(); 
```

或者，如果你想让它工作，不管元素的顺序或两者之间的任何其他东西：

```
$("input[type=radio]").closest("td").find("label").hide(); 
```

* * *

由于您编辑了帖子以提及您无法控制 HTML，因此请尝试以下操作：

```
// Tiny jQuery extension to provide $().outerHTML();
jQuery.fn.outerHTML = function() {
    return $($('<div></div>').html(this.clone())).html(); 
} 
var radioButton = $("input[type=radio]");
var parentElement = radioButton.parent();
var radioHTML = radioButton.outerHTML();
var hiddenText = radioButton.parent().text();

// Hide the text:
parentElement.html(radioHTML);

// Display the text again:
parentElement.html(radioHTML + hiddenText); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T19:32:22.610

由于您无法控制 HTML，因此我将使用以下解决方案之一。

**第一个解决方案：**我认为您不能在 jQuery 的文本节点上使用 hide()，因为该函数仅对元素进行操作（我在推测）。但这是删除文本的方法。

```
 $(document).ready(function() {
        $("input[type='radio'][name='SomeName']").parent().contents().filter(function() { return this.nodeType != 1; }).remove();
    }); 
```

[您可以在此处](http://docs.jquery.com/Traversing/contents)阅读有关 contents()的更多信息。

**第二种解决方案：**您可以在文本节点周围注入 span 元素并隐藏 span。

```
var parent = $("input[type='radio'][name='SomeName']").parent();
parent.contents().filter(function() { return this.nodeType != 1; }).wrap("<span></span>");
parent.find("span").hide(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T19:11:08.253

他说他无法控制 HTML。

但这是真的，您无法轻松访问文本节点以在其上使用 hide()。

Hack sol'n：尝试将 in 中的所有内容读入一个 var，用正则表达式删除标记后的所有内容，然后重新加载结果。

```
var chunk = $('input[name="SomeName"]').parent().html();
$('input[name="SomeName"]').parent().empty().append( chunk.replace(/(<[^>]+>).*/, '$1') ); 
```

或类似的东西（未测试）

# sql - MySQL如何删除另一个表中的表中的记录

> ID：1019475
> 
> 赞同：1
> 
> 时间：2009-06-19T18:43:06.023
> 
> 标签：sql, inner-join, subtraction

我有接近 15000 个条目的表 A。我有第二个表 B，其中包含 7900 个条目，表 A 有一个公共字段。

我需要将表 A 中的所有条目提取到第三个临时表 C 中，除了那些也出现在表 B 中的条目。听起来很简单，但我还没有找到方法。我得到的最接近的是：

```
INSERT INTO tableC
SELECT * 
FROM tableA
    INNER JOIN tableB
        ON tableA.field IS NOT tableB.field 
```

此 SQL 仅选择表 A 中的所有内容，甚至是表 B 中的条目。

有什么想法我哪里出错了吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T18:46:27.423

如果你试试这个呢？

```
INSERT INTO tableC 
SELECT * 
FROM tableA 
WHERE tableA.field NOT IN (SELECT tableB.field FROM tableB) 
```

或者您可以尝试替代 EXISTS 语法

```
INSERT INTO tableC 
SELECT * 
FROM tableA 
WHERE NOT EXISTS (SELECT * FROM tableB WHERE tableB.field = tableA.field) 
```

# ruby-on-rails - 是否可以反转类中包含的模块？

> ID：1019477
> 
> 赞同：9
> 
> 时间：2009-06-19T18:43:26.430
> 
> 标签：ruby-on-rails, ruby

您将模块包含在类中以扩展类功能，即向该特定类添加类方法和实例方法。

```
module M
 def self.class_method_from_module
  'from class_method_from_module'
 end

 def instance_method_from_module
  'from instance_method_from_module'
 end
end

class C
 include M

 def self.class_method
  'from class_method'
 end

 def instance_method
  'from instance_method'
 end
end

puts C.class_method => 'from class_method'

puts C.class_method_from_module => 'from class_method_from_module'

puts C.new.instance_method => 'from instance_method'

puts C.new.instance_method_from_module => 'instance_method_from_module' 
```

现在，即使在使用以下命令从内存中删除模块 M 之后：

```
Object.send(:remove_const, :M) #remove the module M

puts C.class_method_from_module => 'from class_method_from_module'

puts C.new.instance_method_from_module => 'instance_method_from_module' 
```

而不是缺少方法。这是为什么？删除模块添加到类的功能的最佳方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-20T17:23:44.243

细节因实现而异，但我知道至少在 JRuby 和 MRI 1.8 中有一个称为 Include Class 的构造，当扩展或包含 Module 时，它​​会插入到类的继承链中。因此，模块不会被垃圾收集，因为 Include Class 仍然引用它，并且方法仍然在您的类中。[Patrick Farley 在他的博客](http://www.klankboomklang.com/category/ruby-internals/)中有一些关于此和相关主题的精彩文章。

因此，要“删除”一个模块，您*可以*单独取消定义来自该模块的每个方法，但为此目的，这是一个非常笨拙的机制。[如果您可以接受使用 gem，那么使用Mixology](https://github.com/dan-manges/mixology)可能会更好，它是专门为动态添加和删除模块而设计的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-19T19:07:21.350

当你在一个类中包含一个 mixin 时，你实际上是将模块中定义的方法添加到类中，或者将类中的方法替换为模块中具有相同名称的方法。该类与模块没有任何联系，这就是为什么“取消定义”`M`模块不会影响 class `C`。所做的只是阻止你在`M`那个点之外混入。

您可以使用[`undef_method`](http://www.ruby-doc.org/core/classes/Module.html#M001675)从 class 中删除方法`C`，但这可能会产生副作用 - 例如，如果通过包含模块来覆盖方法，您将无法取回原始方法。取消定义类方法有点丑陋。

```
C.send(:undef_method, :instance_method_from_module)
class << C
  self
end.send(:undef_method, :class_method_from_module) 
```

# c# - 为 iPhone 应用程序获取 MS SQL Server 数据？

> ID：1019478
> 
> 赞同：3
> 
> 时间：2009-06-19T18:43:31.110
> 
> 标签：c#, iphone, sql-server

我有一个预先存在的桌面应用程序，它从 Microsoft SQL Server 中提取信息。桌面应用程序是用 C#/ASP/.NET 编写的。

我想获取相同的数据并将其呈现在 iPhone 应用程序中。获取和呈现数据的最佳方式是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T19:01:38.333

我建议编写一个公开数据的 Web 服务，然后通过网络与 iPhone 进行交互。

在 iPhone 上调用 Web 服务和进行 HTTP 调用非常容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T19:45:03.303

你认为你的 iPhone 应用程序可以访问网络吗？如果是这样，我会走前面提到的网络服务路线。如果它是您希望在 iPhone 上使用的小型数据库，而无需访问 Internet 来检索数据，您可以考虑将 SQL Server 数据库转换为 SQLite 数据库并将其与您的应用程序打包在一起。

# java - 将物体掉落在地板上

> ID：1019482
> 
> 赞同：0
> 
> 时间：2009-06-19T18:44:04.993
> 
> 标签：java, oop

我正在创建一个单元格编辑器，但我已经在其他代码中完成（并看到了）这个。我正在创建一个对象，然后将其放在地板上，如下所示：
`ButtonCellEditor buttonColumn = new ButtonCellEditor(table, 2);`

此类获取表格并为其设置 TableColumnModel 和自定义单元格渲染器。然后，该方法结束，我不再引用 buttonColumn 对象。

那么，执行上述操作和执行此操作（这也有效）之间有区别吗？
`new ButtonCellEditor(table, 2);`

这样做真的有什么问题吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-19T18:51:40.160

您的代码中不应该有未使用的变量，这使得它不太清楚。此外，构造函数（如其名称所述）是一种用于初始化对象的方法，在您的情况下，这还没有完成。

我建议您改用**静态方法：**

```
ButtonCellEditor.niceNameHere(table, 2); 
```

我能想到的唯一一种构造函数就足够的情况是，当它需要参数来初始化自己，然后稍后执行一些操作时，而不是在内部执行操作，这不像你的那样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T18:48:32.240

这两种创建 ButtonCellEditor 的方式都没有问题。但是，如果您以后想要引用该对象，则使用方法二您将无法这样做。使用方法 1，您至少可以说 buttonColumn.method()。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T18:48:45.313

据我所知，没有明显的区别。

也没有错——我更喜欢更短的形式，如果唯一的原因真的是为了获得构造对象的副作用（这本身不一定是一个非常好的 API 设计，IMO，但这在这里无关紧要）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T18:50:35.933

它们是相同的，但是关于你为什么这样做的评论可能是有序的。否则有人可能会出现并删除它，认为这是没有调查的无操作。

你也可以更明确地打电话

`table.getColumn(2).setCellEditor(new ButtonCellEditor());`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T18:51:39.053

这两种情况没有真正的区别。在第二种情况下，将创建一个通常会被垃圾回收的匿名变量。第二种情况也可以为您节省一些打字，并且更具可读性。读者可能希望在创建的对象上找到一个引用（如果您选择第一个版本），如果他没有找到，他会感到惊讶。

在任何情况下，静态方法可能更适合这种情况。

# iphone - 如何在 iPhone 上实现 slurp 效果？

> ID：1019492
> 
> 赞同：11
> 
> 时间：2009-06-19T18:45:59.313
> 
> 标签：iphone, core-animation

iPhone 有一个 Apple 使用的私人效果列表，例如“genieEffect”和“slurpEffect”。我想知道如何实现啜饮效果（这是当您丢弃邮件或便条时）。

我了解如何使用核心动画，但我不确定他们使用它的哪些部分来获取动画。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-10T02:23:48.393

我会通过应用于视图层的仿射变换来做到这一点。线性代数不是我的强项；）所以我无法指定确切的转换，但我的猜测是动画是这样的：

*   将 alpha 设置为淡入 0.0 或接近 0 的值
*   应用变换以挤压靠近中心的两个底角
*   将视图缩小到非常小
*   将图层的中心向下移动到屏幕底部（或您希望它精灵到的任何位置。

这或多或少是我认为它会起作用的方式。您可能必须在不同的时间为这些东西制作动画，或者在一个块中制作动画，我不太确定。

查看 CALayer、CABasicAnimation 和 CGAffineTransform 的文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T20:08:25.563

这篇文章讨论了使用私有 API 来实现效果： [链接文本](https://stackoverflow.com/questions/428110/how-can-i-replicate-the-trashing-animation-of-mail-app)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-25T03:21:37.693

它似乎是 2D 和 3D 转换的复杂组合。:-\ 你必须深入研究 CoreAnimation 才能模拟这种效果。

# javascript - 带有非平凡 HTML 标记的 jQuery 事件委托？

> ID：1019500
> 
> 赞同：1
> 
> 时间：2009-06-19T18:48:22.833
> 
> 标签：javascript, jquery

我有两个 DIV，第一个有一个链接，其中包含 HREF 属性中第二个 DIV 的 id（[jsbin 上的完整设置](http://jsbin.com/azimo/edit)）。

我想在用户单击第一个 DIV 时为第二个 DIV 设置动画 - 第一个 DIV 的任何位置。我还想使用事件委托，因为我会在一个页面上有很多这样的“DIV 对”（而且我正在使用来自这个[SO 答案](https://stackoverflow.com/questions/663842/jquery-unbinding-events-speed-increases/663886#663886)的 JS 片段）。

如果用户单击 DIV 本身，它将起作用 - 只需检查 firebug 控制台输出。问题是，如果用户单击其中一个 SPAN 或链接本身，它就不再起作用了。

如何概括单击处理程序以管理对 DIV 内任何内容的单击？

这是JS：

```
$('#a').click(function(e) { 
    var n = $(e.target)[0]; 
    console.log(n); 

    if ( n && (n.nodeName.toUpperCase() == 'DIV') ) { 
        var id = $(n).find('a').attr('hash'); 

        console.log(id); 
        $(id).slideToggle(); 
    } 
    return false; 
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T18:49:31.897

我花了很长时间才写出这个问题，我还是决定发布它，也许有人提出了更好的方法。

这是我找到的解决方案（[jsbin 沙箱](http://jsbin.com/iyamo)）：

```
$('#a').click(function(e) {
    var n = $(e.target)[0];

    var name = n.nodeName.toLowerCase() + '.' + n.className.toLowerCase();

    if (n && (name === "div.clicker" || $(n).parents("div.clicker").length )) {
        var id = $(n).find('a').attr('hash');
        if(!id) {
            id = $(n).parents("div.clicker").find('a').attr('hash');
        }
        console.log(id);
    }
    return false;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T19:14:53.613

这是我的解决方案。不确定这是否正是你想要的，但它对我有用。

```
$(document).ready(function() {
    $('#a').click(function() {
        var a = $("a", this);
        $(a[0].hash).slideToggle();
    });
}); 
```

编辑：在 IE7 和 Fx3 中测试

* * *

编辑：在那种情况下......

```
$(function() {
    $("a.tab").click(function() {
        $($(this).attr("hash")).slideToggle();
        return false;
    });
}); 
```

类似的东西可能会起作用（将选项卡类放在任何“附加”了 div 的东西上）。但是，除非我真正看到它的示例，否则我不确定。虽然如果您希望它在单击跨度时工作......您可以将类附加到跨度，而是执行以下操作：

```
$(function() {
    $("span.tab").click(function() {
        var a = $("a",this);
        $(a.attr("hash")).slideToggle();
    });
}); 
```

不确定是否要在打开另一个 div 时关闭一个打开的 div。如果这不能解决您的问题，那么如果您在 jsbin 上举个例子会有所帮助...

# c++ - Qt 中自定义小部件的自定义样式

> ID：1019510
> 
> 赞同：2
> 
> 时间：2009-06-19T18:50:01.990
> 
> 标签：c++, qt, qt4

有没有人有使用 Qt 中自定义样式的自定义小部件的经验？（我使用的是 Qt 4.5）

问题看起来像这样：

我想开发一些不完全基于现有绘图图元和子控件的自定义控件。由于整个应用程序应该是可换肤的，我想依赖自定义样式，也可能在样式表上。

我需要为这些新控件配置以下内容：

*   其他指标
*   额外的调色板条目
*   其他样式选项

在互联网和文档上挖掘，我发现我需要从一个`QStyle`子类派生一个新的样式类，并覆盖波兰方法以添加新的调色板条目，以及`drawControl`（和其他绘制方法）为自定义控件绘制逻辑和定制零件。

我有两个困扰我的问题：

1.  目前，已经在 Qt 中实现了针对不同样式的不同样式类。（例如`QMotifStyle`，`QWindowsStyle`），每个都有不同的设置。通过继承，我需要为每种样式重新实现绘画和附加设置逻辑，以便正确集成所有这些样式。我还有其他选择吗？

2.  我仍然对如何将样式表与这些自定义样式一起使用感到困惑。谁能指出我可以找到比 Qt 文档提供的信息更多信息的地方？（Qt 中的示例对我帮助不大）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-20T17:15:22.100

样式表问题不会得到解决，因为它不会在自定义类上。

已经存在的类不会理解和照顾添加到自定义样式的额外好处。这是因为 C++ 是一种静态语言，并且没有（干净和理智的）方法来对运行时类进行猴子补丁。一个潜在的解决方案是使用包装标准 QStyle 子类的某个实例的代理样式。根据你想用它实现多少，你可以参考两篇文章：[跨平台代码和样式](http://labs.trolltech.com/blogs/2009/06/05/cross-platform-code-and-styles/)和[Look 'n' Feel Q & A](http://doc.trolltech.com/qq/qq09-q-and-a.html#style)。

如果我是你，我不会采用 QStyle 方法。毕竟，您创建了自定义小部件（例如 FooSomething），因此您也可以添加创建完全不同的自定义样式（例如 FooStyle），它甚至不需要模仿 QStyle。当然，您仍然需要复制类似的功能，例如支持样式表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T20:43:02.767

1.  另一种方法是用来`QPalette`获得正确的颜色并[`QStyle`](http://doc.trolltech.com/4.5/qstyle.html)获得正确的间距。

2.  [`QStyle`](http://doc.trolltech.com/4.5/qstyle.html#developing-style-aware-custom-widgets)的Qt 4.5[文档：](http://doc.trolltech.com/4.5/qstyle.html#developing-style-aware-custom-widgets)

    > **警告：**自定义 QStyle 子类目前不支持 Qt 样式表。我们计划在未来的某个版本中解决这个问题。

# asp.net - IIS 上的 ASP.Net 网站通过链接到另一台计算机上的 SharePoint 列表连接到 Access DB

> ID：1019512
> 
> 赞同：1
> 
> 时间：2009-06-19T18:50:34.173
> 
> 标签：asp.net, sharepoint, iis, ms-access

我的问题如下，

我有一个托管在 IIS 上的 ASP.Net 网站。此网站连接到同一服务器上的 Access 2007 DB 文件。DB 文件包含指向同一域中另一台服务器上的共享点列表的链接。如果我在 Visual Studio 内置服务器上运行网站，我可以打开与 DB 文件的连接并检索数据就好了。但是每当我尝试通过 IIS 运行网站时，网站都无法打开与 DB 文件的连接。

你认为问题是什么？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-20T08:47:43.167

这将是一个权限问题。当您使用 Visual Studio 的 Web 服务器运行时，它与您一样运行，另一方面，IIS（默认情况下）作为网络服务运行。这在它可以做的事情上是有限的。

要访问访问数据库（没有双关语），运行 IIS 的帐户需要能够读取、写入、执行、更改和删除数据库所在的目录。默认情况下，这应该授予 APP_DATA 目录，如果您的访问数据库在其他地方，您需要授予这些权限。

通过访问连接到远程计算机是另一个问题，这不太可能有效，因为网络服务帐户是本地帐户，不会存在于共享点服务器上，并且您无法授予访问权限，因为它不存在。

如果你在一个域中，你可以在一个合适的锁定域帐户下运行 IIS，它可能会工作，但坦率地说，这有点混乱！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-22T12:29:29.880

Access 2007 makes connecting to SharePoint a breeze. After you link to a list, then ADO, and even DAO + VBA code and your sql queries work on those lists!

I seen a good number of people thus start using the JET (actually it called ACE in access 2007) as a data connector to SharePoint for this very reason. Since your are building a web based system then we not using ms-access here, but ONLY using the 2007 version of the JET data engine that ships with access 2007\.

Someone does need to come out with a OLEDB provider for SharePoint lists that allows ones web site or .net code to view those lists as standard sql tables like ms-access can. Using JET as the data connector system is likely not such a good idea. I do realize that you not storing nor placing data in the access JET table, but are using the wonderful ability of the new access JET engine to view and use SharePoint lists as regular sql tables. This approach does allow your ASP.net code to execute sql updates on that data or do whatever as if this was a regular sql table. It does make this oh so easy.

The security permissions on the SharePoint site are thus going to view this connection as not as a end user, but always see the USER as the actual web site connecting (or at least the user you were in ms-access when you linked the table to SharePoint). I don’t believe the SharePoint user authentication process can work reliable when you do this. What will happen is you change a few things on the SharePoint site, and next thing you know the JET connection will be trying to prompt you for new logon credentials. You can’t provide nor control those logon credentials at that point in time.

So, as others pointed out, this is going to be problematic and not reliable.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T19:08:26.560

看看这篇文章：

如何从 Active Server Pages
[http://support.microsoft.com/kb/253580连接到远程 Access 数据库](http://support.microsoft.com/kb/253580)

是的，我知道您的数据库在同一台机器上，但是当您运行 IIS 时，文件和文件夹的权限和身份验证存在差异。这篇文章很有可能涵盖了任何让您感到困惑的事情。

混合 Access 数据库和 IIS 是否是一件好事是一个单独的讨论......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-22T11:39:47.780

从长远来看，使用 Access 作为从 ASP.net 站点访问 SharePoint 的软糖会给您带来很多痛苦。

更好的方法是使用 SharePoint 的 Web 服务来访问该数据 - 完全从等式中删除 Access。

[http://www.scribd.com/doc/8634090/Accessing-SharePoint-Data-Using-C-Without-Running-Code-On-the-SharePoint-Server-Part-1](http://www.scribd.com/doc/8634090/Accessing-SharePoint-Data-Using-C-Without-Running-Code-On-the-SharePoint-Server-Part-1)

[MSDN - 使用 ASP.NET Web 服务](http://msdn.microsoft.com/en-us/library/t745kdsh.aspx)

[创建和使用 Web 服务](http://www.4guysfromrolla.com/articles/062602-1.aspx)

# javascript - JavaScript - 测试整数

> ID：1019515
> 
> 赞同：77
> 
> 时间：2009-06-19T18:50:53.127
> 
> 标签：javascript

我有一个文本字段，允许用户输入他们的年龄。我正在尝试使用 JavaScript 对此字段进行一些客户端验证。我已经进行了服务器端验证。但是，我似乎无法验证用户是否输入了实际整数。我目前正在尝试以下代码：

```
 function IsValidAge(value) {
        if (value.length == 0) {
            return false;
        }

        var intValue = parseInt(value);
        if (intValue == Number.NaN) {
            return false;
        }

        if (intValue <= 0)
        {
            return false;
        }
        return true;
    } 
```

奇怪的是，我在文本框中输入了单个字符，比如“b”，这个方法返回 true。如何确保用户只输入一个整数？

谢谢

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2009-06-19T18:53:00.657

```
var intRegex = /^\d+$/;
if(intRegex.test(someNumber)) {
   alert('I am an int');
   ...
} 
```

如果用户输入非负整数以外的任何内容，这绝对会失败。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-06-19T19:02:46.290

对于真正的 int 检查，使用这个：

```
function isInt(value) { 
    return !isNaN(parseInt(value,10)) && (parseFloat(value,10) == parseInt(value,10)); 
} 
```

许多 int 检查的问题是它们返回 1.0 的“false”，这是一个有效的整数。此方法检查以确保 float 和 int 解析的值相等，因此对于 #.00 它将返回 true。

更新：

在评论中讨论了两个问题，我将为未来的读者添加答案：

*   首先，在解析使用逗号表示小数位的字符串值时，这种方法不起作用。（这并不奇怪，怎么可能？例如，在美国给定“1,001”，它是一个整数，而在德国却不是。）
*   其次， parseFloat 和 parseInt 的行为在某些浏览器中发生了变化，因为这个答案是编写的并且因浏览器而异。ParseInt 更具侵略性，会丢弃出现在字符串中的字母。这对于获取数字非常有用，但对于验证不太好。

我的建议和实践是使用像[Globalize.js](https://github.com/jquery/globalize)这样的库来解析 UI 而非浏览器实现的数值，并仅对已知的“以编程方式”提供的值使用本机调用，例如从 XML 文档解析的字符串.

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-06-19T18:55:39.250

使用 isNaN(n)

IE

```
if(isNaN(intValue))
```

代替

```
if (intValue == Number.NaN)
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-09-12T06:58:03.043

**更新**

我已经修复了有错误的代码，并添加了一个名为**key的 var 来使用****keyCode**和**which**来存储按键代码，这取决于浏览器。

```
var key = e.which || e.keyCode; 
```

谢谢唐纳德.麦克莱恩 :)

* * *

如果您想在输入时检查您是否在输入数字（并避免在输入字段中输入其他字符），您可以使用这个简单的功能，您可以定义允许的元素（这包括您想要过滤的任何内容）。通过这种方式，您不仅可以选择整数，还可以选择例如某组字符。该示例基于 jQuery 将其附加到输入字段。

```
$('#myInputField').keypress(function(e)
{
    var key = e.which || e.keyCode;

    if (!(key >= 48 && key <= 57) && // Interval of values (0-9)
         (key !== 8) &&              // Backspace
         (key !== 9) &&              // Horizontal tab
         (key !== 37) &&             // Percentage
         (key !== 39) &&             // Single quotes (')
         (key !== 46))               // Dot
    {
        e.preventDefault();
        return false;
    }
}); 
```

如果您使用定义以外的其他键，它将不会出现在该字段中。而且因为 Angular.js 近来变得越来越强大。这是您可以在 Web 应用程序的任何字段中创建的指令：

```
myApp.directive('integer', function()
{
    return function (scope, element, attrs)
    {
        element.bind('keydown', function(e)
        {
            var key = e.which || e.keyCode;

            if (!(key >= 48 && key <= 57) && // Interval (0-9)
                 (key !== 8) &&              // Backspace
                 (key !== 9) &&              // Horizontal tab
                 (key !== 37) &&             // Percentage
                 (key !== 39) &&             // Single quotes (')
                 (key !== 46))               // Dot
            {
                e.preventDefault();
                return false;
            }
        });
    }
}); 
```

但是，如果您想使用`ng-repeat`并且只需要在一定数量的字段中应用此指令，会发生什么情况。好吧，您可以将上层指令转换为准备接受**真**值或**假**值的指令，以便能够决定哪个字段将受到它的影响。

```
myApp.directive('rsInteger', function() {
    return {
        restrict: 'A',
        link: function (scope, element, attrs) {
            if (attrs.rsInteger === 'true') {
                element.bind('keydown', function(e)
                {
                    var key = e.which || e.keyCode;

                    if (!(key >= 48 && key <= 57) && // Interval (0-9)
                         (key !== 8) &&              // Backspace
                         (key !== 9) &&              // Horizontal tab
                         (key !== 37) &&             // Percentage
                         (key !== 39) &&             // Single quotes (')
                         (key !== 46))               // Dot
                    {
                        e.preventDefault();
                        return false;
                    }
                });
            }
        }
    }
}); 
```

要使用这个新指令，您只需要在这样的输入类型文本中执行它，例如：

```
<input type="text" rs-integer="true"> 
```

希望它可以帮助你。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-12-02T09:52:53.060

我这样做是为了检查数字和整数值

```
if(isNaN(field_value * 1) || (field_value % 1) != 0 ) not integer;
else integer; 
```

***模块化部门***

*示例*
1\. 25.5 % 1 != 0**和 ,**
2\. 25 % 1 == 0

和 if(field_value * 1) NaN if string eg: 25,34 or abcd etc ... else integer or number

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-04-08T15:01:06.460

> 函数 isInt(x) {return Math.floor(x) === x;}

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-03-04T16:46:17.613

如果您的号码在 32 位整数范围内，您可以使用以下内容：

```
function isInt(x) { return ""+(x|0)==""+x; } 
```

按位或运算符强制转换为带符号的 32 位 int。两边的字符串转换确保了真/假想要匹配。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-06-05T10:10:33.383

没有人尝试过这个简单的事情吗？

```
function isInt(value) {
    return value == parseInt(value, 10);
} 
```

那有什么问题？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-04-16T03:55:33.027

您可以使用对象`isInteger()`的方法`Number`

```
if ( (new Number(x)).isInteger() ) {
  // handle integer
} 
```

如果`x`is`undefined`或，此方法可以正常工作`null`。但它目前对浏览器的[支持很差](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/isInteger#Browser_compatibility)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-07-24T10:12:10.407

我发现缺少 NaN 响应，因为它们不接收尾随字符（因此“123abc”被认为是有效数字）所以我尝试将字符串转换为整数并返回字符串，并确保它在转换后与原始字符匹配：

```
if ("" + parseInt(stringVal, 10) == stringVal) { alert("is valid number"); } 
```

这对我有用，直到数字如此之大，它们在转换过程中开始以科学记数法出现。

...所以当然这意味着您可以输入科学计数法的数字，但是如果您愿意，也可以检查最小值和最大值。

如果您使用分隔符（如“1,000”或“1.000”，具体取决于您的语言环境），它当然会失败 - 此处只允许使用数字。

* * *

## 回答 #11

> 赞同：-4
> 
> 时间：2014-08-11T19:37:48.780

```
If (enteredAge < "1" || enteredAge > "130") ...... 
```

简单而且有效....直到他们长生不老

# c# - MDIParents Forms and Childs 中的事件

> ID：1019542
> 
> 赞同：1
> 
> 时间：2009-06-19T18:57:48.327
> 
> 标签：c#, .net, winforms, event-handling

如何处理子表单中的 MDIParent 表单事件？例如，在父表单中，我有一个选项“在子网格上搜索”，当单击该按钮时，在子表单中，网格上的一行获得焦点。

我正在使用 C# 3.5 Windows 窗体应用程序

提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-07-20T17:16:00.043

我看到两种不同的方式可以选择解决这个问题。

如果您可以考虑在 a 中托管命令[`MenuStrip`](http://msdn.microsoft.com/en-us/library/system.windows.forms.menustrip.aspx)，并且它是存在于 MDI 应用程序中的多个实例中的同一个子窗体，您可以将命令添加到`MenuStrip`子窗体中的控件中。这些菜单命令将自动与父窗体中的命令合并，但任何点击事件都将在活动子窗体中执行。

[`MergeAction`](http://msdn.microsoft.com/en-us/library/system.windows.forms.toolstripitem.mergeaction.aspx)您可以通过和[`MergeIndex`](http://msdn.microsoft.com/en-us/library/system.windows.forms.toolstripitem.mergeindex.aspx)属性控制子窗体中的菜单命令在何处以及如何与父窗体中的命令合并。如果使用这种方法，您可能应该在子窗体中设置`Visible`属性，以防止它占用窗体上不必要的空间。`MenuStrip``false`

我建议的第二个选项是创建一个用于定义搜索功能的接口，在支持它的子窗体中实现该接口，并使用[`MdiChildActivate`](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.mdichildactivate.aspx)MDI 父窗体的事件来启用或禁用搜索功能，具体取决于当前是否孩子支持与否。

第二种方法的简化代码示例：

```
interface IGridSearch
{
    void PerformSearch(string criteria);
}

public partial class MdiChildUI : Form, IGridSearch
{
    public MdiChildUI()
    {
        InitializeComponent();
    }

    public void PerformSearch(string criteria)
    {
        // peform the search
    }        
}

public partial class MdiParentUI : Form
{
    public MdiParentUI()
    {
        InitializeComponent();
    }

    private void MdiParentUI_MdiChildActivate(object sender, EventArgs e)
    {
        SetControlStates();

    }

    private void SetControlStates()
    {
        _searchCommand.Enabled = (this.ActiveMdiChild is IGridSearch);
    }

    private void _searchCommand_Click(object sender, EventArgs e)
    {
        IGridSearch child = (this.ActiveMdiChild as IGridSearch);
        if (child != null)
        {
            child.PerformSearch("whatever to search for");
        }
        else
        {
            MessageBox.Show("Can't search in the active form");
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-20T15:59:02.773

这不是太复杂：

```
public partial class Form1 : Form
{
    // other stuff...

    // e.g. some button's click event handler
    private void addChild_Click(object sender, EventArgs e)
    {
        Form2 child = new Form2();

        child.MdiParent = this;

        this.SomeEvent += child.SomeMethod();

        // other init stuff...
    }
} 
```

只需确保子窗体上的处理程序方法的签名与父窗体的事件处理程序委托的签名相匹配。

需要注意的一件事是，如果您只希望活动的子窗体响应事件。在这种情况下，您可以像这样创建一个辅助[扩展方法](http://msdn.microsoft.com/en-us/library/bb383977.aspx)

```
public static bool IsActiveMDIChild(this Form child)
{
    Form mdiParent = Form.ActiveForm;

    Form activeChild = mdiParent.ActiveMdiChild;

    return child == activeChild;
} 
```

然后将这样的代码添加到 SomeMethod() 处理程序：

```
public bool SomeMethod(*/ signature here /*)
{
    if(!this.IsActiveMDIChild()) return;

    //do stuff normally, we're in the active child form
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-20T16:07:38.840

在子窗体中，为父窗体创建一个新事件以调用：

```
Friend Event search(ByVal token As String) 
```

在父窗体中，使用事件声明子窗体的一个实例：

```
Private WithEvents _FChild As frmChild 
```

在父窗体中，当您要调用子窗体时，请引用您声明的变量。该事件应以智能感知出现：

```
Private Sub searchChild_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnSearchChild.Click
               _FChild.search(txtToken) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T19:02:17.210

你有一些代码，所以我们可以更有帮助吗？

在任何情况下，您都可以在子表单上创建自定义事件，并让父表单订阅这些事件

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T19:02:41.640

我现在正在做同样的事情，这就是我的做法：

*   由于父母是引发事件的人，因此事件需要存在于父表单上
*   在加载子窗体的父级代码期间（您在某处有实例化子窗体的代码），在子窗体存在后，使用 AddHandler 将 MDI 父级上的事件与子窗体上的公共子连接起来
*   当父窗体触发事件时，子窗体的实例将处理它。

这有意义吗？我使用的是 VB.NET，所以语言可能略有不同，但这是我使用的一般技术。

# grails - Grails 链接 taglib 在 GSP 之外使用

> ID：1019549
> 
> 赞同：15
> 
> 时间：2009-06-19T19:01:21.847
> 
> 标签：grails, groovy, taglib

我正在尝试使用 taglib 调用，那里有属性参数，还有链接 taglib 使用的标签本身的东西。我找不到传递给 g.link() 调用以使其呈现链接文本的属性。我已经尝试过“body”、“link”、“text”和“linkText”——这些都不起作用。

我希望能够打电话

```
g.link(action:"foo", controller:"bar", _____:"这里的链接文本")
```

但不知道该放什么

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-06-19T19:41:42.077

通常你会这样做：

```
g.link(action:"foo", controller:"bar", "text of the link here") 
```

链接文本不需要是最后一个参数，它可以出现在任何地方：

```
g.link("text of the link here", action:"foo", controller:"bar") 
```

.

闭包用法：

您可以使用返回字符串的闭包代替字符串：

```
g.link(action:"foo", controller:"bar", {"text of the link here"}) 
```

而且，与作为方法调用的最后一个参数的任何 groovy 闭包一样，您可以将其放在右括号之后：

```
g.link(action:"foo", controller:"bar") {"text of the link here"} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-19T19:05:29.607

没有参数可以传入（无论好坏）。

要获取链接中的文本，请将其作为闭包传递。

```
g.link(action:"foo", controller:"bar") { "text of the link here" }
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-19T10:19:16.667

为了完整起见，由于文档中没有提到它：如果您在自己的 taglib 中调用标签（作为 metod 调用），则可以使用闭包输出`out <<`外部标签内的任何其他内容（使用 ）。例如：

```
out << g.form(method: "post", controller: "login") {
    out << "Name: " << g.textField(name: "name") << "<br>"
    out << "Password: " << g.passwordField(name: "password") << "<br>"
    out << g.submitButton(name: "login")
} 
```

# c# - Linq to Sql 非并发更新中的 ChangeConflictException

> ID：1019551
> 
> 赞同：0
> 
> 时间：2009-06-19T19:02:11.580
> 
> 标签：c#, linq-to-sql, conflict

我正在使用 LINQ to SQL，并且在增加视图计数器交叉连接时遇到了一些问题。

我正在使用的一小段代码是：

```
t = this.AppManager.ForumManager.GetThread(id);
t.Views = t.Views + 1;
this.AppManager.DB.SubmitChanges(); 
```

现在在我的测试中，我非同时运行了多次。执行此测试的对象共有 4 个副本。

也就是说，没有锁定问题或类似问题，但有 4 个数据上下文。

现在，我希望它像这样工作：获取一行，修改一个字段，更新行。但是，这会引发 ChangeConflictException。

如果没有任何副本同时运行，为什么更改会发生冲突？

有没有办法忽略某个表上的更改冲突？

**编辑：**找到答案：

您可以在表的所有列上设置“UpdateCheck = Never”，以创建最后获胜的更新样式。这是应用程序在我将其移植到 LINQ 之前所使用的，所以我现在将使用它。

**EDIT2：**虽然我上面的修复确实阻止了异常被抛出，但它并没有解决根本问题：

由于我有多个数据上下文，因此每个对象最终都会有多个缓存副本。我应该在每次页面加载时重新创建我的数据上下文吗？

我宁愿指示数据上下文忘记一切。这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-20T12:39:44.993

我相信 DataContext 是相对轻量级和短命的。IMO，您不应缓存使用 DataContext 加载的数据超过必要的时间。当它短暂存在时，它仍然相对较小，因为（据我了解）DataContext 的内存使用主要与跟踪您对它管理的对象（由它检索）所做的​​更改有关。

在我处理的应用程序中，我们创建上下文，在 UI 上显示数据，等待用户更新，然后更新数据。然而，这主要是因为我们希望更新基于用户正在查看的内容（否则我们可以在用户点击更新时检索数据并立即更新）。如果您的更新相对独立，我认为在更新之前立即检索该行是明智的。

您还可以使用 System.Data.Linq.DataContext.Refresh() 将已检索的数据与数据库中的数据重新同步，以帮助解决此问题。

为了回应您关于让上下文忘记一切的最后评论，我认为没有办法做到这一点，但我怀疑这是因为上下文的所有内容都是跟踪的更改（和连接），它就像好吧，你创建了一个新的上下文（记得处理旧的），因为你真的想扔掉上下文中的所有东西。

# web-applications - 网络爬虫和 GET 与 POST 请求

> ID：1019558
> 
> 赞同：2
> 
> 时间：2009-06-19T19:04:31.340
> 
> 标签：web-applications, search-engine, web-crawler

我听说网络爬虫应该只遵循 GET 请求而不是 POST 请求。

在现实世界中，这是一个有效的假设吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T19:08:50.507

通常他们不做 POST 请求。我相信，这只是当前的事态，并没有在任何地方规定。一些搜索引擎正在[尝试抓取表单](http://googlewebmastercentral.blogspot.com/2008/04/crawling-through-html-forms.html)，但这些仍然是 GET 请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T19:07:55.093

您是否在询问爬虫是否会从表单标签中解析出 URL 并跟踪它们？有些会。这是一个非常安全的假设，尽管他们将始终使用 GET 动词。

垃圾邮件机器人是另一回事。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T20:37:53.510

礼貌的爬虫只使用 GET 请求。就像礼貌的爬虫遵守 bots.txt 一样。

然而，即使谷歌在礼貌的定义上玩得又快又松，他们的爬虫已经对包括 stackoverflow 在内的一些网站造成了严重的带宽损害。

# .net - Visual Studio 单元测试访问器，如何在不关闭 VS 的情况下重新生成它们？

> ID：1019561
> 
> 赞同：6
> 
> 时间：2009-06-19T19:05:04.897
> 
> 标签：.net, visual-studio-2008, unit-testing

有时，当一个类的单元测试已经完成并且方法使用 _Accessor 时，代码发生了变化。无论您编译多少次，它仍然不会“同步” _Accessor 文件。唯一可行的方法是关闭 VS2008 并重新打开它。“重新生成”测试访问器的任何技巧？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-11-06T08:49:32.977

打开私有/受保护方法所在的类。右键单击并选择“创建私有访问器”并选择正确的测试项目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-08-26T02:55:32.157

**重新生成所有访问器**

1.  搜索所有*_accessor。*项目文件夹中的文件并删除它们（确保不要删除您自己创建的任何文件）。其中大部分可以在 VS 创建的 Release/debug 文件夹和 test 文件夹中找到。

2.  重建您的解决方案。

注意：进行清理或重建不会删除访问器 dll/pdb 文件，因此我们在此处手动进行。

# java - Maven 最佳实践：是否包括快照发布的时间戳？

> ID：1019562
> 
> 赞同：4
> 
> 时间：2009-06-19T19:05:08.267
> 
> 标签：java, maven-2

我最近向一个项目添加了 Maven 快照构建功能，配置为在已部署的工件上使用唯一的时间戳版本。但是对于这是否是正确的做法存在一些混淆（有问题的快照被部署到公共存储库之一，而不仅仅是在像公司这样的实体内）：有人说它在尝试使用快照时会导致问题。

所以：鉴于 Maven 有多少是基于约定的，并且遵循公认的最佳实践，我希望有一些关于选择哪个选项的指南。

（注意：我稍微编辑了标题——我对公共快照版本通过部署选项包含唯一时间戳的好处（或缺乏）特别感兴趣；如果包含时间戳，则与其说是否使用时间戳，但这显然是有点相关的问题）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T19:28:22.777

通常，您应该始终针对 -SNAPSHOT 依赖项进行构建。但是，如果产品包含 -SNAPSHOT 依赖项，则应避免发布产品。如果您使用[Maven 发布插件](http://maven.apache.org/plugins/maven-release-plugin/)来自动化您的发布，它将检查以确保您没有使用发布插件或依赖项。

但这并不总是可能的。在我需要基于快照构建发布某些内容的情况下，即当我使用显式时间戳/内部版本号而不是 -SNAPSHOT 版本命名方案时。

您可以使用[版本 Maven 插件](http://mojo.codehaus.org/versions-maven-plugin/)自动执行此操作。它提供了在 POM 中锁定和解锁快照版本的目标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T19:20:27.033

快照的全部意义在于让某人使用最新版本的代码。为什么要使用五个版本的快照？

考虑到这一点，工件名称中的时间戳会给您带来什么？

我已经使用 Maven 大约 5 年了。我从未见过名称中带有时间戳的快照 jar。

# c# - 寻找在调试器中获取对象实例的方法的工具？

> ID：1019567
> 
> 赞同：2
> 
> 时间：2009-06-19T19:05:41.963
> 
> 标签：c#, reflection

现在我正在查看一些 C# 代码中的错误，我需要在某个位置获取给定的对象实例。我坐在调试器中那个位置的断点上，可以跳回堆栈并查看我需要获取的对象实例。我怀疑有一种方法可以从我拥有的（`foo.bar.baz.bla.bla.bla`或类似的东西）中获取该实例，但我对代码的了解不足，无法知道如何找到它。

*假设示例：*

> 我坐在第 2485 行的调试器中，有人简化了代码，并意识到程序需要在这里设置`FooBat`封闭`WizBang`对象的属性（调用函数 27 提升调用堆栈的那个对象）但是我没有对封闭`WizBang`对象的任何直接引用。但是，我怀疑我有权访问的其他对象之一可以访问可以访问可以访问封闭`WizBang`对象的某些内容的内容。但这给了我大约 10K 的东西要查看，哦，顺便说一下，我还可以访问 42 个不同`WizBang`的对象，这些对象不是我想要的，所以我还需要检查它是否真的与 27 个步骤相同的对象堆栈。如果我能找到如何访问它，我可以添加`SomeExp.FooBat = true;`就在第 2485 行并关闭此错误！

*我的问题是：是否有人制作了一种工具，使用反射和暴力来搜索属性和成员链，以找到能够提供所需对象实例的工具？*

是的，我知道这是一个问题，而且通常不会起作用，但这是计算机时间，而不是程序员时间，当它起作用时，那就太棒了！`O(b`^(`d`)`)`

ps 我给它的比我想要的（现在`<g/>`）还要少。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-09T08:49:20.103

也许您应该尝试“立即窗口”，您可以在其中实时输入 c#。它只能评估表达式和赋值（没有声明等）。

您可以从 Debug->Windows->Immediate 找到即时窗口（默认为 Ctrl-Alt-I）

你已经试过了吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-09T08:54:21.670

尽管阅读了您的所有评论和帖子，但我不确定我是否正确理解了您想要的内容。您是否在 Visual Studio 中尝试过条件断点？他们也可能有所帮助。您可以使用它们来检查您的对象是否满足某些条件并在这种情况下停止。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-09T09:03:07.643

我认为你所追求的是你必须自己写的东西。也就是说，我不认为这很困难 - 毕竟，您只需要编写一个使用反射来遍历您正在使用的任何对象结构的方法，检查特定条件。然后，您只需设置一个断点（或点击暂停），然后在您需要的任何对象结构上运行您的方法。您可能可以将方法设置为`[Conditional(DEBUG)]`，使其不会出现在程序的发布版本中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-01T19:54:36.427

也许您可以使用 visual-studio 调试器的监视窗口。您可以插入一次实例并观察每一步。

# iphone - 如何在 Objective-c for iPhone 中创建关系对象

> ID：1019568
> 
> 赞同：1
> 
> 时间：2009-06-19T19:05:54.990
> 
> 标签：iphone, objective-c, core-data, properties

这是我的对象的接口：

```
@interface MyItem : NSObject {
 sqlite3 *database;
 NSInteger *primaryKey;
 NSInteger *accountKey;
 NSInteger *categoryKey;
 NSString *title;
 BOOL hydrated;
 BOOL dirty;
 NSData *data; // Why do I need this?
} 
```

主键将在 Sqlite 中自动生成，我将整数、帐户和类别的外键存储在 MyItem 表中。

帐户和类别将具有有意义的描述。**我也应该为描述添加属性吗？**像这样：

```
NSString *accountDesc;
NSString *categoryDesc; 
```

因此，在我的 Hydrate 方法中，我可以加入类别和帐户。

**这样做的最佳做法是什么？**

我的目标是在应用程序的初始启动时，我将显示一个带有标题和类别描述的 Tableview。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T19:25:40.643

为什么不使用核心数据？然后，您将获得最佳实践 - 再加上它速度快，并且它提供了许多其他好处。

核心数据将为您创建具有公开属性的对象 - 并处理关系 - 并延迟加载对象以使内存管理更加容易。你的代码也变得更容易阅读。

# .net - 为什么我们使用 .NET 属性而不是普通的旧 get/set 函数？

> ID：1019571
> 
> 赞同：17
> 
> 时间：2009-06-19T19:06:54.660
> 
> 标签：.net, oop, properties

我了解提供接口以间接访问类成员的许多好处。我的问题是：这不是你可以用任何 OO 语言使用（类似的东西）完成的事情吗？

```
public int NormalClass::getQuality() {
    return this->quality;
} 
```

和

```
protected void NormalClass::setQuality(int q) {
    this->quality = q;
} 
```

?

除了纯粹的美学之外，.NET 属性还提供了哪些额外的好处？

如果你能提出令人信服的论据，我会接受“可读性”；但就个人而言，我倾向于认为 get/set 函数比属性更具可读性，因为它明确地是一个**函数**，而不是一个直接的值。

**编辑：**感谢大家的回答！这对我来说真的很有帮助；总结一下我从已经说过的所有内容中收集/学到的东西，以下是我到目前为止得出的一些结论：

*   属性的最大好处不是来自属性本身的特定特性，而是来自以特殊方式处理属性的框架和 IDE 特性；例如，属性编辑器、XML 序列化、数据绑定。
*   可以通过某些便捷的方式将属性视为简单值，而 get/set 函数不能：特别是 obj.Prop++ 和 obj.Prop = value。
*   属性可以让你摆脱使用公共成员的快速而肮脏的代码，而不必为以后实现一堆 get/set 函数而烦恼；如果您需要添加一些逻辑和/或将公共成员设为私有，您可以简单地引入一个属性，而不必冒险破坏任何旧代码。

现在，到目前为止，在 2 或 3 个答案中提出了一点，我个人觉得有些可疑：属性意味着廉价的读/写操作，因此可以以与简单变量基本相同的方式使用。我对这一点的问题是，属性中没有任何固有的东西可以真正强制执行这一点。这只是它们**应该**如何使用。对我来说，这类似于“shouldBePrivate”限定符，它指示一个值*只能*由其自己的类直接访问，但无论如何仍可以从外部访问；或巡逻街道的警察，提醒我们*应该*表现我们自己，但在我们开始犯罪时实际上并不干预（如果不强制执行，它对我们真正有什么作用？）。

如果属性有某种内置机制来确保读/写成本低，我会对这一点印象深刻。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-06-19T20:54:02.603

[Jon Skeet 在他的 C# 文章博客中对属性为何重要](http://csharpindepth.com/Articles/Chapter8/PropertiesMatter.aspx)进行了出色的概述。在其中他解释了为什么应该使用属性而不是暴露公共字段。

至于为什么要使用属性而不是 getter/setter 方法，我建议以下想法：

*   属性提供了更清晰、更简洁的语法，易于理解和阅读。
*   属性启用赋值表达式链接： `A.x = B.y = C.z`
*   属性清晰一致地传达了数据访问的语义——消费者期望没有副作用。
*   .NET 中的许多库都可以识别属性，用于诸如 XML 序列化、WPF 绑定、ASP.NET 2 路绑定等任务。
*   IDE 和许多可视化设计器都可以识别属性，并且可以在属性编辑器中显示这些属性。
*   属性启用对递增 (++) 和递减 (--) 运算符的支持。
*   属性可以很容易地与使用反射的方法区分开来，并允许动态消费者提取有关对象公开的数据的知识。
*   C# 3 支持有助于消除样板代码的自动属性。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-19T19:11:08.317

属性（特别是 .net 3.5 中的自动属性）比 setter/getter 更简洁，并且代码行更少 == 需要维护的代码更少 == 错误更少。

我会先说可读性，但你已经说过这对你来说不算数.. :)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-06-19T19:17:26.650

我相信 XML 序列化只读取/写入公共属性，因此您的 get 和 set 方法将被忽略。

此外，如果您有一个通用的对象列表，则可以将其分配给 DataGridView.DataSource，您将获得每个属性的列。这可能就是@LPalmer 所指的。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-06-19T19:15:57.090

不仅在语言中而且在 clr 中具有属性意味着 .NET 上的每个人都可以依赖他们的元数据。属性的含义是 get 没有副作用，并且 get 和 set 都是快速操作。许多工具使用这些假设：winforms 设计器、LINQ to SQL...

因此，这不仅关乎方便，还关乎拥有额外的元数据。

以下是其他典型假设：

```
customer.Name = "a";
Assert.IsTrue(customer.Name == "a");

try { var ignored = customer.Name; }
catch { Assert.Fail("Exceptions are not expected"); } 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-06-19T19:22:37.217

物业的两大优势：

*   它们可以在属性网格中显示和编辑。如果没有属性，您怎么知道要为编辑器显示哪些方法？
*   它们暗示了某些东西的读写成本很低，而且阅读它不会产生副作用。（当然，有可能违反这一点，但是通过将某些东西设为属性，您就声明这是您的意图。）因此，调试器可以接受该提示。如果将鼠标悬停在属性上，调试器将在工具提示中显示其值。对任何可能的方法做同样的事情是没有意义的。太容易不小心做了有副作用的事情。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-06-19T19:23:03.113

查看面向对象编程的一种流行方法是根据我们头脑中的概念对程序中的类进行建模。

我们头脑中的概念是基于我们感知到的周围的实际对象（无论是我们感知它们还是我们与感知它们的其他人交流）。

我们周围的物体——家具、动物、航天飞机等——具有特定的属性并以特定的方式起作用。

这就是我们获得属性和方法的地方。

在 C# 中，属性可能无法简化为单个字段获取或字段集（例如，它可能需要额外的检查，或者可能涉及缓存或任何数量的原因）。因此，我们需要一个单独的属性概念，包括 get-methods 和 set-methods，以使我们的程序更接近我们希望它们建模的概念。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-06-19T19:23:50.553

本质上，属性**是**get/set 方法对。

属性是一种运行时支持的方法，它公开了一对具有元数据支持的 get set 方法，这意味着它们可以使用反射来发现，而无需根据方法名称和签名猜测哪些方法应该形成访问器。

属性的另一个优点是它们在语法上类似于字段，而不是类似于方法，这具有创建更简洁代码的优势。

> 我倾向于认为 get/set 函数比属性更具可读性，因为它明确地是一个函数，而不是一个直接的值。

大多数时候属性是由 Jit 引擎内联的，因为它们非常简单，这意味着大多数时候属性更像字段而不是函数，因此它们更接近字段的行为而不是函数。

在属性的情况下，函数调用和字段访问之间是否存在歧义并不重要，因为在大多数情况下，您无需支付函数调用成本，属性 getter 和 setter，因为它们的简单性，非常适合内联，这意味着成本方面比函数调用更接近字段 *。

*   注意：并非所有属性都很便宜，但一般准则规定它们应该尽可能简单和轻量级。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-06-19T19:29:21.447

除了将属性用于描述对象*属性*的值的语义正确性之外，您不能对此提出异议：

```
obj.SetValue(obj.GetValue() + 1); 
```

对比

```
obj.Value++; 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-06-19T19:11:20.610

对我来说，这很容易：

```
myprop = myvalue;
console.writeline(myprop); 
```

不需要

```
mysetfunc(myvalue);
console.writeline(mygetprop); 
```

1 比 2 更容易记住

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-06-19T19:12:39.220

我知道在某些情况下，您可以像在数据集中一样将属性用作“列”名称。我认为 .NET 通过自省来做到这一点。我不相信使用 get/set 函数可以做到这一点。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-06-19T19:23:14.470

也许是一个小问题，但是对于 getter /setter，我发现当我在带有“intellisense”的 IDE 中循环通过它们时，会出现一大块彼此相邻的“getter”和另一个“setter”块，这很烦人。我发现更难找到我正在寻找的东西。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-06-19T20:15:46.050

使用`get`和`set`方法，您必须从一开始就决定使用它们，并且几乎总是为您的类公开的每个公共属性编写大量样板代码。

```
class Point
{
    private int x, y;

    // Ew, pointless boilerplate!
    public int  getX()      { return x;   }
    public void setX(int x) { this.x = x; }

    public int  getY()      { return y;   }
    public void setY(int y) { this.y = y; }
}

// ...

Point p = new Point();
p.setX(5);
p.setY(10); 
```

使用属性，您可以**消除**90% 仅有微不足道的 getter 和 setter 的属性的样板 getter 和 setter。您可以直接公开公共变量

```
class Point
{
    public int x, y;
}

Point p = new Point();
p.x = 5;
p.y = 10; 
```

稍后，如果您决定要向公共变量添加一些行为，您可以将它们切换为具有`get`or`set`方法中实际行为的属性。这里的好处是您班级的用户根本不会受到影响。什么都没有改变；他们不必从 切换`point.x = 5`到`point.setX(5)`。您的**公共接口是稳定**的，允许您首先使用普通变量，然后在添加一些保护/日志记录/任何内容时切换到较慢的`get`/方法。`set`

```
class Point
{
    public int x { get; set; }
}

// No change! 
Point p = new Point();
p.x = 5;
p.y = 10; 
```

（现在严格来说，你的语法接口没有改变，但是你的类的编译接口已经改变了，所以如果你从变量切换到属性，你必须重新编译所有使用你的类的代码。你不能只重新编译你的类并删除旧类，如果你的类是一个广泛使用的库的一部分，比如说。你的库的用户将不得不针对你的库的新版本重新编译他们的代码。）

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-06-19T19:25:40.580

正如[usr](https://stackoverflow.com/users/122718/)所说：

> “属性的含义是 get 没有副作用，get 和 set 都是快速操作。”

确切地。这意味着 getter/setter 会很快。通过将某些东西公开为属性，您暗示您正在快速获取/放置对象上的属性。方法用于做某种形式的工作，假设涉及更多的周期，而不是简单地获取/设置属性。我们通常会将冗长的操作“属性”放入 GetFoo(...)/SetFoo(...) 方法中，以表明计算操作比属性重。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-06-19T19:20:22.340

至少对于**[DataBinding](http://www.akadia.com/services/dotnet_databinding.html)**
，如果没有它，与 UI 相关的开发会变得更加复杂。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-06-19T19:27:50.780

它们允许该类型的用户使用简化的语法，并允许您创建只读和只写字段。因此 me.SetAge(34); 年龄 = 我.GetAge(); 变成 me.age = 34; 年龄=我的年龄；

# user-interface - 保存图标：还是软盘？

> ID：1019573
> 
> 赞同：278
> 
> 时间：2009-06-19T19:07:06.983
> 
> 标签：user-interface, icons, user-experience

我正在开发一个项目，用户可以在其中保存他们的工作（最有可能保存到 HDD，但也可能保存到任何其他媒体，包括软盘）。当然，流行的**文件**>**保存**选项在那里，但是工具栏按钮呢？

到目前为止，最受欢迎的图标是软盘。然而，用户写入软盘的机会非常渺茫。不过，我认为软盘比文字更具代表性。

最后，我可能会坚持使用软盘图标来保持大多数用户熟悉的惯例，但是......有人对如何更新这个旧图标有任何想法吗？

![替代文字](../Images/9c2dc1adf284b90624e60a5f999400d4.png)

* * *

## 回答 #1

> 赞同：209
> 
> 时间：2009-06-19T19:10:09.787

软盘图标已成为保存文件的标准。这是一个高度可识别的图标，没有理由改变它。应用程序之间的一致性是一件美妙的事情。

我怀疑随着时间的推移，一旦人们开始忘记他们的样子（或从不知道），这个图标会变得更加风格化，而不像真正的软盘。现在的图标代表了保存的概念，而不是代表软盘。

* * *

## 回答 #2

> 赞同：159
> 
> 时间：2009-06-19T19:32:50.207

正如其他人所说，保留软盘图标，不要担心。我住的地方，这是火车穿越的警告标志：

![火车横穿的警告标志](../Images/1d121c64ab511a47e6bffcd6b2504892.png)

50多年没有蒸汽机车了，但大家还是知道这是火车的标志。同样，50 年后，当你的文件存储在轨道上的 Google 服务器上时，每个人都会知道软盘是保存数据的标志。

* * *

## 回答 #3

> 赞同：96
> 
> 时间：2009-06-19T19:10:42.983

考虑一下您使用术语“软盘”的事实，而实际上 3.5" 磁盘根本不是软盘。这只是一个从 5.25" 磁盘继承而来的术语，因为每个人都习惯了它。“磁盘按钮是保存”的概念也是每个人都习惯的。坚持下去。

* * *

## 回答 #4

> 赞同：89
> 
> 时间：2009-06-19T23:50:45.553

[About Face的](https://rads.stackoverflow.com/amzn/click/com/0470084111)[第 17 章：“重新思考文件和保存”](http://books.google.com/books?id=9F7gaZKd2rYC&lpg=PA349&ots=2swuj8avST&dq=Rethinking%20Files%20and%20Save%20alan%20cooper&pg=PA349)涵盖了这一点。[Alan Cooper](http://www.cooper.com/)是众所周知的可用性专家，他的著作很有影响力。他的论点本质上是，当我们强迫用户考虑实施时，我们就会陷入困境。这是一个简短的摘录：

> 在数字技术的世界里，实施模型思维最引人注目的地方是文件管理和“保存”的概念。如果你曾经尝试过教你妈妈如何使用电脑，你就会知道困难并不能真正解决问题。一切都很好：你启动文字处理器并输入几个句子。她一直和你在一起——就像在纸上写字一样。但是当您单击关闭按钮时，会弹出一个对话框，询问“您要保存更改吗？” 你和妈妈一起碰壁。她看着你问：“这是什么意思？一切都好吗？”
> 
> 这个问题是由于软件迫使人们像计算机一样思考，不必要地让他们面对数据存储的内部机制。这不仅仅是你母亲的问题；即使是老练的计算机用户也很容易感到困惑或犯错误。人们在硬件和软件上花费数千美元只是为了面对诸如“你真的要我保存这份你整个下午都在处理的文档吗？”之类的无礼问题。当他们真正想做的是处理文档的副本时，必须记住使用 Save As... 命令。

值得考虑简化或消除“保存”隐喻的方法。

例如，在 Stack Overflow 上，我们可以“发布答案”或“添加评论”或“提问”。每次我们确实是在“保存”到数据库中，但是每次的比喻都略有不同。发布，添加，询问。我想到了像 iTunes 这样的软件，我认为它没有音乐“保存到磁盘”的概念。您只需向其中添加音乐即可保存。根据您的软件执行的任务类型，可能存在比保存更贴切的不同隐喻。

我应该提一下，我并没有真正回答你的问题，我自己在我的网络应用程序中使用了软盘图标，或者一个只显示“保存”的大按钮。目前我们在很多情况下都坚持使用它，但随着软盘驱动器的消亡，它变得越来越荒谬。但是，我们也说我们“[拨号](http://en.wikipedia.org/wiki/Rotary_dial)”电话，而拨号接口电话已经几十年没有普及使用了。

* * *

## 回答 #5

> 赞同：74
> 
> 时间：2009-06-20T00:40:34.657

使用包含两个字符的图标：

```
:w 
```

* * *

## 回答 #6

> 赞同：36
> 
> 时间：2009-06-19T19:11:12.653

查看您全新手机的语音信箱图标。很有可能它仍然是基于磁带的家庭答录机中的“磁带卷轴”图标。

编辑：

好吧，不是*所有*的手机都使用这个图标，但是“倒带”这个词怎么样？我敢肯定，有些人拥有可以让您“倒带”数字音频或视频媒体文件的设备。

* * *

## 回答 #7

> 赞同：30
> 
> 时间：2009-06-19T19:36:56.457

如果您考虑一下，邮件也没有“现代”表示，仍然由纸质信件表示。

![http://cdn.baekdal.com/2008/metaphor.jpg](../Images/fa6f13c01365ba5bb850f6003dfd48e3.png)

^(（图片来自“[是时候改变那个比喻了](http://www.baekdal.com/blog/icon-change-metaphor)”）)

如博客条目“[图标的结尾](http://humanized.com/weblog/2007/06/25/the_end_of_an_icon/)”中所述

> 将视觉类比建立在移动目标上是很危险的。技术会改变。今天清楚明了的事情不会在 10 年后出现；所以今天模糊不清的东西在 10 年后将完全模糊不清。软盘图标的问题（除了不确定的类比）是代沟。

尽管如此，只要潜在的行动是明确的，那个图标就会继续存在。

![http://www.globalnerdy.com/wordpress/wp-content/uploads/2014/01/3d-model-of-the-save-icon.jpg](../Images/59fa9d0f545d8a31bb2169124b9f732e.png)

^(（图片在很多地方都可以找到，包括在[这篇博文](http://www.globalnerdy.com/2014/01/21/a-joke-about-the-floppy-disk-in-2014-and-the-alphabet-of-the-obsolete/)中）)

* * *

## 回答 #8

> 赞同：19
> 
> 时间：2009-06-22T00:08:31.650

为什么我们甚至需要一个“保存”功能？我写的任何东西都应该自动保存，事实上 Microsoft Word 已经这样做了——如果它崩溃并且没有保存，你的数据仍然可以恢复。Google 会自动保存草稿。为什么我们仍然使用“保存”范式？

* * *

## 回答 #9

> 赞同：18
> 
> 时间：2009-06-22T00:25:32.600

Tango 图标集有一个指向硬盘的箭头：

![替代文字](../Images/aabff27ad6fc725dc23f4cb294e18947.png)![替代文字](../Images/ebc1985467b726229f550157677519fb.png)![替代文字](../Images/1a1d3c4fcadb83bd029abf5885088cdc.png)

* * *

## 回答 #10

> 赞同：13
> 
> 时间：2009-06-19T19:19:35.367

像他们在老科幻电影中那样的卷盘磁带驱动器怎么样：

```
+-----+
|() ()|
| \ / |
|  W  |
+-----+ 
```

这个图标将是永恒的！

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2009-06-19T19:12:43.180

只要大多数应用程序继续使用软盘图标，大多数用户就会熟悉它，并且您的应用程序将从熟悉的界面中受益。在经济学中，这被称为[网络外部性](http://en.wikipedia.org/wiki/Network_effect)。

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2009-06-19T23:14:38.247

如果您偏离保存等操作的常用图标，您的用户会说您的程序很难使用。即使你简化了一切，以至于你认为它非常直观并且比其他人所做的要好得多，他们也会说它很难使用，只是因为这不是他们习惯的，也不是他们所期望的。请记住，对于您的用户来说，无论微软和其他大公司做什么都是“正确的”，所以如果您做不同的事情，那么默认情况下，您就是错误的。

此外，即使您的用户需要 5 或 10 秒来确定保存按钮的位置，这也是 5 到 10 秒容易避免的挫败感，您本可以保存他们，这只是阻止他们使用您的应用程序的又一障碍. 显然，他们并没有使用您的应用来陶醉于单击按时间顺序相关的保存图标的乐趣。他们只是想避免失去工作，继续生活中更重要的事情。

坚持使用 3.5" 磁盘；这是一个经济上合理的选择，如果创意不佳的话。

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2009-06-20T13:13:02.867

当某些代码出现问题时，我们会说其中存在“错误”，即使最后一次实际发生是在 60 多年前！

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2009-06-19T19:20:52.853

并不真地。只要它看起来像更现代的“僵硬”而不是软盘。

记忆棒并没有真正的怀旧之情。然而，随着越来越多的现代系统不包括物理硬驱动器，未来的用户可能不知道“硬”代表什么。作为一个青少年，黑胶唱片是什么，他们可能会认为你有一个高级的时刻。

保险箱的图片可能暗示您正在使用一些内部密码进行加密并将其存储得如此安全以至于无法检索。

服务器的图片再次给人的印象是它要在别处复制。

在接下来的 5 年里坚持下去

干杯

* * *

## 回答 #15

> 赞同：7
> 
> 时间：2009-06-19T19:34:15.557

你知道，50 年后，图标将不再需要。如果你想保存你的工作，眨眼两次，或者站在你的头上，或者只是用你选择的语言说“保存”，瞧——它被保存了......不再需要视觉了 :)

*我使用标准的 3.5" 图标投票*。当它让用户感到困惑的那一天到来时，开发人员会收到大量用户的抱怨，说它不够“用户友好”。至于现在，我们已经习惯于寻找它磁盘图标，我曾经用过一个用CD图标代替的应用程序，我花了几天时间才意识到它是用来保存的。这一切都是为了设计一致性和满足期望。

* * *

## 回答 #16

> 赞同：7
> 
> 时间：2010-08-27T14:18:07.777

我认为这种方法有一些意义：

![Helveticons 摘录，显示一个分叉的箭头指向一个 3/4 圆圈以保存](../Images/f58663064703de9b582aed3a8aad7c43.png)

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2009-06-19T19:10:51.127

IMO，图标很有用，因为它们是我们可以与不同动作相关联的常量符号。从这个意义上说，软盘是非常合适的，因为它几乎是通用的。我一生中从未见过带有不熟悉图标的界面（根本没有文字）并且能够弄清楚它的作用（我在看着你，Mac OS）。我认为，即使你想出一个更真实的图像，比如一张硬盘驱动器的图片，你也会比不理会它造成更多的混乱。即使像我这样的人可以将图标识别为硬盘驱动器，但这并不能告诉我们您要做什么，它只是意味着硬盘驱动器以某种方式参与......

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2009-06-19T19:12:00.577

不幸的是，这个软盘图标已成为保存文档的通用符号。它甚至被用在 Microsoft Word 2007 中，几乎没有受到影响。以任何方式更改它，您可能会让用户无法识别它作为保存符号。

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2009-06-19T19:25:05.573

它仍在 Windows 的标准工具栏图像列表中。

没有人见过硬盘驱动器，但这并不能阻止该图标成为一体。对于大多数用户而言：*硬盘驱动器*就是地板上的那个盒子。

重要的是程式化的符号。图片可以是一只红蟋蟀——只要每个人都将这只红蟋蟀与储蓄联系起来。

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2009-06-19T23:12:52.993

老实说，软盘图标对我来说从来没有多大意义。它的意思是“磁盘活动”，也可以是“保存但打开”。

问题是新一代用户从未见过软盘（例如我 11 年的侄子），他必须知道那个奇怪的平方的东西是保存。

我喜欢带有指向它的箭头的文件夹图标。也许是一个指向圆柱体的箭头（a la DB）？

我不太喜欢其他想法*，*所以保留软盘图标是默认解决方案。另外，我讨厌某些应用程序使用的非 MS 大而低质量的软盘图标。

其他解决方案可能是带有硬盘驱动器和从第一个到第二个的箭头的小版本应用程序图标，但在 16x16 图标上看起来不太好。

很明显，图标设计既是科学又是艺术。我非常尊重优秀的图标设计师。

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2009-06-19T23:17:14.933

你用过[HLSS](http://www.hlss.us/)吗？他们使用 SD 卡的图像作为保存图标，但大多数时候，我无法在工具栏上选择它，必须转到文件 -> 保存才能保存。

因此，他们提出了另一种现代等效物，但它的效果不如 ol' 3.5" 软盘图标。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2009-06-19T19:17:56.773

如果您使用软盘图标，使用您的应用程序的用户会发现它更有用。为了一致性，如果它让你感觉更好。它无处不在。

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2009-06-19T19:21:31.150

我认为怀旧是整洁的——每个人都知道这意味着什么。我只是快速浏览了一下，Outlook 仍然使用老式的 honkin 巨大的手机图标来拨打电话。

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2009-06-19T19:25:01.800

好问题。在我积极使用的 4 台计算机中，只有 1 台甚至有 3.5" 驱动器。这是一项过时的技术，我不介意看到即使以图标形式被替换。

可能的替代品：

*   保险库图标。易于识别和节省的象征。
*   光盘符号。更现代，但仍然能够很快过时。
*   ？？？

我对这里的大多数回复感到惊讶。普遍的共识似乎是“继续使用软盘，因为这是一直以来的做法”。程序员的心态从什么时候开始顺从别人的理想了？仅仅因为“这就是它一直以来的方式”而做某事并不是借口，尤其是对于编码人员而言。

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2009-06-19T19:31:19.120

微软在 2007 年的办公套件中摒弃了标准菜单和图标方面做得非常好。几乎每个普通/初学者用户都讨厌它......

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2009-06-24T19:26:22.800

您可以使用上传和下载（红色向上和绿色向下箭头）图标进行保存和加载。此外，在短时间内，网络将成为保存文件的最多地方。

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2009-07-29T20:11:32.040

即使很多人不知道这个图标到底是什么，他们很快就会知道它的含义，所以我会保留它以与其他应用程序保持一致。

将来，我认为随着越来越多的应用程序将避免“保存”操作并自动保存每个用户操作，这个问题将变得没有意义。人们将使用“撤消”作为丢弃更改的主要范例，而不是通过不保存来丢弃更改。

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2011-09-07T23:32:45.773

有趣的是，我发现了这个讨论，因为我正在寻找一个标准的“保存”图标，我可以下载它来替换 UtlraEdit 开始使用的“新的和改进的”图标，并且在工具栏上很难挑选出来。是的，它已经过时了，但每个人都认为 3.5 英寸软盘图像代表“保存”！是的，程序员不应该这样做，因为“一直都是这样”，但图标是语言而不是方法论。不要发明一个新词只是因为它很酷，除非你的目标是向前几代人隐藏你所说的话。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2009-06-19T19:11:50.703

我认为总的来说，软盘图标已成为公认的保存图标，即使它与闪存和 DVD 的普及没有太大关系。坦率地说，如果一个程序有一个用于保存的图标，例如记忆棒或 HDD，大多数用户将无法将其选为保存图标。

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2009-06-19T23:04:04.447

正如其他人所指出的，软盘图标嵌入在人们对计算机用户界面的理解中，它是保存某物行为的标准视觉表示。
软盘图标的使用反映了当时盛行的技术，因此代表了普通用户可以快速将其与保存文件的行为联系起来的东西。

尽管最近软盘迅速消亡，但保存动作仍然以视觉方式表示，这一事实证明了图标与保存文件动作之间的关联强度。如果要尝试更改图标，则需要选择一个图像

1.  很容易与保存为软盘的行为相关联
2.  可能会继续使用，或至少被识别，足够长的时间让足够多的人识别它

虽然我确实承认软盘作为首选存储介质的用途确实已经过时，但我认为它不会在不久的将来成为保存图标的角色。

如果图标要改变，我相信主要的操作系统和硬件供应商需要支持这样的改变，我不认为这样做可能会疏远大量现有用户

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2010-04-05T20:45:59.067

作为对原始帖子的回应，我有点认为磁盘是一个字面概念。即使我们不再使用这种特殊类型的存储，它也代表将数据写入某种类型的存储设备。

最好问“‘保存’是什么意思？” 比“有什么比软盘更好/更现代的图标？”

当您保存某些东西时，您是将其放在某个地方以供以后使用或存储。我们在选择最终都会过时的文字存储设备时陷入困境。文件夹和箭头的想法（在此处的另一篇文章中）似乎不正确，因为我们习惯于文件夹作为组织文件的一种方式，而不是作为存储设备。当然，您不一定需要保存文件夹。

所以这里有一个建议，使用抽象立方体被放置在另一个立方体内的概念 - 或者将一个对象放置在一个盒子里。

想法？不要为“跳出框框思考”的笑话而烦恼，因为我已经想到了:)

糟糕，声望不够，无法在此处发布图片。 [**这是一个链接。**](http://gs166.photobucket.com/groups/u81/O8XP26APXJ/th_2010-04-05_160126_2.png)

# svn - Hudson 花了很多时间才注意到新的 SVN 修订版是正常的吗？

> ID：1019577
> 
> 赞同：0
> 
> 时间：2009-06-19T19:08:02.537
> 
> 标签：svn, hudson

我最近才开始使用 Hudson 作为我的一个项目的 CI 服务器。我已经使用 SVN 存储库建立了一个“工作”。服务器在我的本地机器上运行，SVN 存储库托管在[http://www.unfuddle.com](http://www.unfuddle.com)上。

问题是，当我从本地机器提交代码，然后在 Hudson 中手动触发构建时，需要几分钟才能检测到新版本。因此，提交后的第一个构建始终是不使用新修订的构建。

这是正常的吗？是否有任何设置可以防止这种行为？

提前致谢并致以最诚挚的问候！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T19:13:07.127

我想当您触发构建时，它会执行更新并记录诸如“在修订 xxx”之类的消息，但没有任何更改

当 Subversion 服务器和 Hudson 服务器的时钟不同步时，我已经看到了这种效果。如果是这种情况，Hudson 实际上会在构建期间将此记录为警告。我不知道为什么，但是当时钟不同步时，更新执行异常。

# excel - 当电子表格（.xls）从我的网页下载时，如何在 MS Excel 07 电子表格中显示计数器（即下载次数）？

> ID：1019590
> 
> 赞同：1
> 
> 时间：2009-06-19T19:10:46.023
> 
> 标签：excel, cell, office-2007, spreadsheet

我知道在网页上显示计数器很容易，但我需要实现相同的功能，即，每次有人从我的网页下载数据时，我都需要将数据写入 Excel 2007 电子表格中的单元格。更准确地说，当用户将 excel 文件下载到他的硬盘驱动器并打开它时，我希望电子表格在一个单元格中显示 .xls 文件的下载次数（当然还有其他包含数据）。

我只需要弄清楚我如何以编程方式与 Excel 07 表进行通信。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T19:20:01.513

这听起来像是徒劳的练习，因为一旦下一个人下载文件，这个数字就会过时。这是你真正想做的吗？

如果是，则很有可能使用一些服务器端脚本。PHP、Perl 和其他语言都有可用于以编程方式编辑 Excel 文件的库。选择一个你最舒服的，然后从那里开始。

**编辑：**

我认为，因为您同时控制 Excel 文件和网站，所以最好的方法是向网站添加一个计数器，并通过 Web 查询在您的 Excel 文件中引用它。如果您不熟悉 Web 查询，它们是 excel 中的一个工具，可让您从 Web 导入表格，每次文件加载时都会刷新（或者即使用户点击刷新）。以下是有关[Web 查询工具](http://office.microsoft.com/en-us/excel/HA010450851033.aspx)的更多信息。

让我知道此解决方案是否适合您。

**编辑2：**

这是一个指向更最新教程的[链接。](http://www.homeandlearn.co.uk/excel2007/excel2007s8p5.html)

# scala - 提升片段：前缀未绑定到命名空间

> ID：1019599
> 
> 赞同：3
> 
> 时间：2009-06-19T19:11:42.230
> 
> 标签：scala, lift

我刚从lift和scala开始，有一个我不太明白的问题。

我有以下 index.html

```
<html>
<head><title>title</title></head>
<body>
    <table>
        <lift:Members.list>
            <tr>
                <td><m:nick/></td>
            </tr>
        </lift:Members.list>
    </table>
</body>
</html> 
```

以下代码段：

```
class Members {
  def list(xhtml: NodeSeq) =
  Member.findAll.flatMap(member => bind("m",xhtml
                                       ,"nick" -> member.nickName
    ))
} 
```

出于某种原因，我收到以下错误。我尝试了很多东西，但无法让它发挥作用。怎么了？

```
XML Parsing Error: prefix not bound to a namespace
Location: http://localhost:8080/hazardlift-1.0-SNAPSHOT/
Line Number 8, Column 25:<td><m:nick></m:nick></td>
-----------------------------^ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T19:26:02.373

也许 lift 不知道如何处理您的返回值。尝试通过将其指定为返回类型来强制对 NodeSeq 进行隐式转换。

```
....
def list(xhtml: NodeSeq) : NodeSeq = 
.... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T18:59:17.487

我刚刚发现了这个错误的另一个原因 - 一个未解决的标签。

我有这个 HTML：

```
<div >
    <h3>Request Information</h3>

    <lift:DetailedRequestData.renderContent>
        <f:rowTag></f:rowTag>
    </lift:DetailedRequestData.renderContent>
</div> 
```

我写这个是为了`renderContent`：

```
def renderContent(ns: NodeSeq): NodeSeq = {
  val key = beginTrans(DisplayData.logger)
  var result = ns

  try {
    var requestID = DisplayData.getParameter("request")
    bind("f", ns, "rowTag" -> <p>Request ID: {requestID}</p>)
  }
  catch {
    case t: Throwable => DisplayData.logger.error("[DetailedRequestData$.renderContent] ", t)
  }

  endTrans(DisplayData.logger, key)
  result
} 
```

由于我没有分配`bind`to的结果，所以`result`我返回了未修改的结果`NodeSeq`并得到了同样的`prefix not bound to a namespace`错误。将一个语句更改为：

```
 result = bind("f", ns, "rowTag" -> <p>Request ID: {requestID}</p>) 
```

是的，这是我自己的愚蠢错误，但通过在此处记录问题，希望我能避免其他人遇到同样的问题，但不知道为什么。

# windows - JBoss - ExportException：端口已在使用：1098

> ID：1019615
> 
> 赞同：10
> 
> 时间：2009-06-19T19:17:03.937
> 
> 标签：windows, networking, jboss, tcp

当我尝试启动 JBoss 时出现以下错误

```
10:10:43,298 INFO  [WebService] Using RMI server codebase: http://127.0.0.1:8083/
10:10:43,938 ERROR [AbstractKernelController] Error installing to Start: name=jboss:service=Naming state=Create mode=Manual requiredState=Installed
java.rmi.server.ExportException: Port already in use: 1098; nested exception is: 
    java.net.BindException: Address already in use: JVM_Bind
    at sun.rmi.transport.tcp.TCPTransport.listen(TCPTransport.java:249)
    at sun.rmi.transport.tcp.TCPTransport.exportObject(TCPTransport.java:184)
    at sun.rmi.transport.tcp.TCPEndpoint.exportObject(TCPEndpoint.java:382)
    at sun.rmi.transport.LiveRef.exportObject(LiveRef.java:116)
    at sun.rmi.server.UnicastServerRef.exportObject(UnicastServerRef.java:180)
    at java.rmi.server.UnicastRemoteObject.exportObject(UnicastRemoteObject.java:293)
    at java.rmi.server.UnicastRemoteObject.exportObject(UnicastRemoteObject.java:256) 
```

但是，当我尝试查看正在监听哪些端口时。我没有看到那个端口！

```
H:\>netstat -a -n -o

Active Connections

  Proto  Local Address          Foreign Address        State           PID
  TCP    0.0.0.0:135            0.0.0.0:0              LISTENING       824
  TCP    0.0.0.0:445            0.0.0.0:0              LISTENING       4
  TCP    0.0.0.0:1521           0.0.0.0:0              LISTENING       2036
  TCP    0.0.0.0:3389           0.0.0.0:0              LISTENING       752
  TCP    0.0.0.0:7717           0.0.0.0:0              LISTENING       2944
  TCP    0.0.0.0:8081           0.0.0.0:0              LISTENING       1564
  TCP    0.0.0.0:31038          0.0.0.0:0              LISTENING       1436
  TCP    127.0.0.1:1038         0.0.0.0:0              LISTENING       2036
  TCP    127.0.0.1:1052         0.0.0.0:0              LISTENING       2620
  TCP    127.0.0.1:5998         127.0.0.1:5999         ESTABLISHED     4036
  TCP    127.0.0.1:5999         127.0.0.1:5998         ESTABLISHED     4036
  TCP    127.0.0.1:6000         127.0.0.1:6001         ESTABLISHED     4036
  TCP    127.0.0.1:6001         127.0.0.1:6000         ESTABLISHED     4036
  TCP    142.174.27.74:139      0.0.0.0:0              LISTENING       4
  TCP    142.174.27.74:13148    142.174.12.84:445      ESTABLISHED     4
  TCP    142.174.27.74:13253    142.174.134.33:8080    ESTABLISHED     4036
  TCP    142.174.27.74:13255    142.174.134.33:8080    ESTABLISHED     4036
  TCP    142.174.27.74:13258    142.174.134.33:8080    ESTABLISHED     4036
  TCP    142.174.27.74:13259    142.174.134.33:8080    ESTABLISHED     4036
  TCP    142.174.27.74:13260    142.174.134.33:8080    ESTABLISHED     4036
  TCP    142.174.27.74:13261    142.174.134.33:8080    ESTABLISHED     4036
  TCP    142.174.27.74:13262    142.174.134.33:8080    ESTABLISHED     4036
  TCP    142.174.27.74:13263    142.174.134.33:8080    ESTABLISHED     4036
  UDP    0.0.0.0:445            *:*                                    4
  UDP    0.0.0.0:8081           *:*                                    1564
  UDP    0.0.0.0:8082           *:*                                    1564
  UDP    0.0.0.0:19508          *:*                                    1244
  UDP    127.0.0.1:123          *:*                                    948
  UDP    127.0.0.1:1025         *:*                                    580
  UDP    127.0.0.1:1046         *:*                                    524
  UDP    127.0.0.1:1056         *:*                                    784
  UDP    127.0.0.1:1213         *:*                                    2888
  UDP    127.0.0.1:1257         *:*                                    2404
  UDP    127.0.0.1:2172         *:*                                    3736
  UDP    127.0.0.1:2310         *:*                                    2188
  UDP    142.174.27.74:123      *:*                                    948
  UDP    142.174.27.74:137      *:*                                    4
  UDP    142.174.27.74:138      *:*                                    4

H:\> 
```

有任何想法吗？

谢谢，

谭

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-21T23:23:51.320

尝试 TCPView ( [TCPView v3.05](http://technet.microsoft.com/en-us/sysinternals/bb897437.aspx) )。我经常得到这个“端口已经在使用”，而 TCPView通常~~总是~~会抓住罪魁祸首。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-06-22T11:09:04.397

转到 conf 文件夹下的 jboss-service.xml 并将 RMI 的端口从 1098 更改为 8099

```
8099
```

重新启动服务器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T20:13:08.287

前段时间我们也遇到过这个问题，不仅是 JBoss，还有 MySQL。我在这里更详细地写了它：

[Windows TCP 端口冲突高于 1024](http://www.jroller.com/dschneller/entry/windows_tcp_port_conflicts_above)

归根结底，Windows 将 1000 到 5000 之间的端口范围用于所谓的“临时”端口。这意味着它会从这个范围内为请求随机端口的进程分配端口。

在 Windows 2000/2003 Server 安装以及 Windows XP Pro 上，您可以为您的应用程序保留端口范围（即使它们只覆盖一个端口）。实际上，它们不是为任何特定的东西保留的，而只是从动态分配中排除。为此，请创建或编辑以下注册表值（类型`REG_MULTI_SZ/Multi-String Value`）：

```
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\ReservedPorts 
```

在此值中，以 xxxx-yyyy 格式指定端口范围，其中 xxxx 和 yyyy 是要保留的范围的最低和最高端口。要保留一个端口，只需对两者使用相同的值（例如 1099）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-09-23T15:34:10.600

我猜那个端口还在使用中。您可以使用以下方法找到：

```
netstat -ao 
```

和

```
netstat -b 
```

如果您无法使用该端口，请找到另一个端口并在以下 XML 文件中进行更改：

```
conf/bindings-beans/META-INF/bindings-jboss-beans.xml 
```

JBoss 5 有一个新的 ServiceBindingManager，它使用 bean 注入在运行时分配端口。在此处更改端口可能会为您解决问题。您还可以使用不同的端口配置并按一个因素覆盖端口。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-11-02T08:56:19.937

根据 Sam 引用的文件中提到的端口，以及 Daniel Schneller 引用的注册表项，以下内容应该对 JBoss EAP 5 有用：

1090-1090 1098-1102 1161-1162 3528-3528 4444-4448 4457-4457 4712-4714 5445-5446 8080-8083 8443-8443

翻译成 .reg 文件：

```
Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters]
"ReservedPorts"=hex(7):31,00,30,00,39,00,30,00,2d,00,31,00,30,00,39,00,30,00,\
  20,00,31,00,30,00,39,00,38,00,2d,00,31,00,31,00,30,00,32,00,20,00,31,00,31,\
  00,36,00,31,00,2d,00,31,00,31,00,36,00,32,00,20,00,33,00,35,00,32,00,38,00,\
  2d,00,33,00,35,00,32,00,38,00,20,00,34,00,34,00,34,00,34,00,2d,00,34,00,34,\
  00,34,00,38,00,20,00,34,00,34,00,35,00,37,00,2d,00,34,00,34,00,35,00,37,00,\
  20,00,34,00,37,00,31,00,32,00,2d,00,34,00,37,00,31,00,34,00,20,00,35,00,34,\
  00,34,00,35,00,2d,00,35,00,34,00,34,00,36,00,20,00,38,00,30,00,38,00,30,00,\
  2d,00,38,00,30,00,38,00,33,00,20,00,38,00,34,00,34,00,33,00,2d,00,38,00,34,\
  00,34,00,33,00,00,00,00,00 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-05-17T04:37:37.787

根本原因是JBOSS 没有被人为关闭。如果您使用的是 Windows，请转到任务管理器并终止 JBOSS 进程。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-07-18T07:23:21.267

在注册表中保留端口 1098-1099。如果正在运行，请重新启动 oracle 服务，然后启动 JBOss。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-09-03T07:07:53.847

如果您的默认 IP 地址因某些问题而发生更改，Jboss 也会抛出此错误，即 121\. *。*.89 至 121\. *.* .90 只需检查它并用更新的 IP 地址替换它。它会起作用的。

# perl - 什么时候应该使用包变量和词法变量（有什么区别）？

> ID：1019617
> 
> 赞同：5
> 
> 时间：2009-06-19T19:17:28.803
> 
> 标签：perl, variables, scope, package, lexical

我正在查看[Perl Monks](http://www.perlmonks.org/?node_id=198045)上的一些较旧的 Perl 代码，以了解如何使用 Win32::OLE 和 MS Word 进行编程。分散在整个代码中的是名称如*$MS::Word*之类的变量，它们的声明中没有包含“ *my ”。*在 Google 上阅读了一下之后，我了解到这些被称为“包变量”与使用*my* .

我的第一个问题是'**包变量有什么用？**'。我（认为）我了解词法变量是什么，但我不了解包变量的用途或它们的使用与词法有何不同，所以我的第二个问题是，'**词法变量和包变量有什么区别？**'

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-19T19:31:57.417

您应该阅读MJD 的[Coping with Scoping](http://perl.plover.com/FAQs/Namespaces.html)。

[perldoc perlmod](http://perldoc.perl.org/perlmod.html)也将是有用的阅读。

代码太丑陋了。仅仅因为作者似乎认为 $author::email 很酷，它就践踏了各种各样的命名空间。

更好的方法是使用哈希：

```
my %author = (
   email => 'author@example.com',
   ...
); 
```

没有必要遍历符号表。

我确实有一些`Win32::OLE`例子：[http](http://www.unur.com/comp/) ://www.unur.com/comp/这不是艺术品，但我相信这是对这种风格的改进。另请参阅[为什么在 Perl 和 Word VBA 中 Word 文档的页数不同？](https://stackoverflow.com/questions/820348/why-are-the-number-of-pages-in-a-word-document-different-in-perl-and-word-vba/821569#821569)

*我要吐槽一点*：

```
@pgm::runtime_args = @ARGV ; 
```

所以，我们放弃标准`@ARGV`数组去践踏`pgm`命名空间。不仅如此，每个 Perl 程序员都知道是什么`@ARGV`。无论如何，`@pgm::runtime_args`不​​会在脚本中再次使用。

```
$pgm::maxargs = $#pgm::runtime_args + 1 ; 
```

当然`@pgm::runtime_args`，在标量上下文中会给我们该数组中元素的数量。我不知道为什么`$pgm::maxargs`可能需要，但如果是的话，那么这条线应该是：

```
$pgm::maxargs = @pgm::runtime_args; 
```

我不会引用更多这些东西。我想这就是 Cobol 程序员尝试编写 Perl 时发生的情况。

```
$program::copyright = "Copyright (c) 02002 - Kenneth Tomiak : All rights reserved."; 
```

我很高兴他为这一年分配了五位数。你永远不知道！

PS：我相信我的摘录构成合理使用。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-19T20:10:11.613

包变量存在于符号表中，因此根据其名称，可以从任何其他包或范围读取或修改它。词法变量的范围由程序文本决定。[perlsub 联机帮助页中的“通过 my() 的私有变量”](http://perldoc.perl.org/perlsub.html#Private-Variables-via-my())部分提供了有关定义词法的更多详细信息。

假设我们有以下内容`MyModule.pm`：

```
package MyModule;

# these are package variables
our $Name;
$MyModule::calls = "I do not think it means what you think it means.";

# this is a lexical variable
my $calls = 0;

sub say_hello {
  ++$calls;

  print "Hello, $Name!\n";
}

sub num_greetings {
  $calls;
}

1; 
```

请注意，它包含一个包`$calls`和一个词法`$calls`. 任何人都可以访问前者，但模块控制对后者的访问：

```
#! /usr/bin/perl

use warnings;
use strict;

use MyModule;

foreach my $name (qw/ Larry Curly Moe Shemp /) {
  $MyModule::Name = $name;
  MyModule::say_hello;
}

print MyModule::num_greetings, "\n";

print "calls = $MyModule::calls\n"; 
```

程序的输出是

```
Hello, Larry!
Hello, Curly!
Hello, Moe!
Hello, Shemp!
4
calls = I do not think it means what you think it means. 
```

如您所见，包变量是全局变量，因此所有常见的问题和建议都反对 apply。除非明确提供访问权限，否则 MyModule 包之外的代码不可能访问其 lexical `$calls`。

经验法则是你几乎总是想使用词汇。[*Damian Conway 的Perl Best Practices*](http://oreilly.com/catalog/9780596001735/)是直接的：“**永远不要让变量成为模块接口的一部分**”（强调原文）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-19T19:25:53.390

包变量是全局变量；它们在整个程序（甚至其他模块）中随处可见。当您想要或需要那种级别的可见性和/或外部影响时，它们很有用。例如，Text::Wrap 模块使用它们来允许单个配置点用于换行文本的列数。此外，包变量允许您使用称为“动态作用域”的东西——但这是一个有点高级且有点深奥的概念。

对于您的第二个问题，请参阅[Perl 中的 my 和 our 有什么区别？](https://stackoverflow.com/questions/845060)

# java - 使用 c:out JSP 将撇号转义为 \'

> ID：1019618
> 
> 赞同：3
> 
> 时间：2009-06-19T19:17:53.810
> 
> 标签：java, jsp, jstl

我有一个带有人姓的对象字段。

如果我使用*${person.lastName}*，我会得到*O'Brian*

如果我使用

```
 <c:out value="${person.lastName}"/> 
```

我得到了奥布莱恩

两个输出都破坏了 IE 中的下一个 jsp 代码

```
 <a href="#" 
    class="delete" 
    onclick="if(confirm('<c:out value="${application.lastName}"/> ' + _('Are you sure you want to delete this application?'))) {deleteApplication('${application.identifier}')};return false;"><bean:message key="application.delete"/></a> 
```

因为它被转化为

```
 onclick="if(confirm('O&#039;Brian ' 
```

或者

```
 onclick="if(confirm('O'Brian ' 
```

我需要*O'Brian*以*O\'Brian 的身份逃脱*

知道如何解决这个问题吗？

# 解决方案

最优雅的解决方案似乎使用了一个简单的标签。

```
package view;

import java.io.IOException;
import javax.servlet.jsp.JspException;
import javax.servlet.jsp.tagext.SimpleTagSupport;

public class EscapeJS extends SimpleTagSupport {
    public String str;

    public void doTag() throws JspException, IOException {
        getJspContext().getOut().print(str.replaceAll("\'", "\\\\'"));
    }

    public String getStr() {
        return str;
    }

    public void setStr(String str) {
        this.str = str;
    }

} 
```

然后在 WEB-INF 中放置一个 utils.tld 文件：

```
<!DOCTYPE taglib PUBLIC "-//Sun Microsystems, Inc.//DTD JSP Tag Library 1.1//EN" "http://java.sun.com/j2ee/dtds/web-jsptaglibrary_1_1.dtd">
<taglib>
    <tlibversion>1.2</tlibversion>
    <jspversion>1.1</jspversion>
    <shortname>bean</shortname><uri>utilsTags</uri>
    <uri>utilsTags</uri>
    <tag>
        <name>escapeJS</name>
        <tagclass>view.EscapeJS</tagclass>
        <bodycontent>scriptless</bodycontent>
        <attribute>
            <name>str</name>
            <required>true</required>       
            <rtexprvalue>true</rtexprvalue> 
        </attribute>                
    </tag>      
</taglib> 
```

然后在你的jsp里面：

```
<%@ taglib prefix="utils" uri="utilsTags" %>

<utils:escapeJS str="${application.firstName}"/> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T20:22:44.070

您可以定义一个新的 EL 函数来为您转义字符串。

例如

在 Java 中

```
public class MyStringUtil {
  public static String escapeJs( String str )
  {
    // escape the string (e.g. replace ' with \')
  }
} 
```

在标记库描述符文件中：

```
<function>
 <name>escapeJs</name>
 <function-class>package.to.MyStringUtil</function-class>
 <function-signature>
   java.lang.String escapeJs( java.lang.String )
 </function-signature>
</function> 
```

然后在你的 JSP 中（假设你已经包含了你`.tld`的前缀`foo`：

```
<a href="#" 
  class="delete" 
  onclick="if(confirm('${foo:escapeJs(person.lastName)}' + _('Are you sure you want to delete this application?'))) {deleteApplication('${application.identifier}')};return false;"><bean:message key="application.delete"/></a> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T19:21:45.253

将其作为 O'brian 存储在数据库中，但在显示之前执行查找替换以将任何 ' 转换为 \'

# iis - 安装 IIS 管理工具时 DoCmd.SendObject 失败

> ID：1019623
> 
> 赞同：2
> 
> 时间：2009-06-19T19:19:10.470
> 
> 标签：iis, ms-access, vba

我有一个在 Microsoft Access 2003 中用 VBA 编写的应用程序。我们有一个表单，允许用户向使用以下代码的开发团队发送一封自动电子邮件：

```
DoCmd.SendObject acSendNoObject, , , _
    "email@address.com", "", "", _
    "Helpdesk Submission", msg, False, "" 
```

在我们将应用程序提供给其中一位在他的计算机上安装了 IIS 管理工具的系统管理员之前，这段代码对我们所有的用户都非常有效。应用程序只是拒绝发送来自用户的消息并且会静默失败。

我们花了一段时间才发现问题出在 IIS 管理工具上，但一旦我们发现问题，Internet 搜索就没有任何价值。这基本上是在黑暗中拍摄，希望有人有解决方案的想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-20T23:31:37.817

虽然 SendObject 是一种非常简单的电子邮件发送方式，但它不是很灵活（例如，您不能附加文档）。[Tony Toews 的电子邮件常见问题解答](http://www.granite.ab.ca/access/email.htm)有很多从 Access 发送电子邮件的选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T21:32:43.990

IIS 管理工具是否有它自己的邮件服务器，可能会发生冲突。

您是否通过删除它来确认它是 IIS 管理工具？

IIS 呢？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-20T13:20:25.490

我没有解决方案，但可能会变通。如果每个用户的计算机上都安装了 Outlook，您可以添加对 Outlook 库的引用并使用 Outlook.application 对象发送邮件。有人在[这里](http://www.peterssoftware.com/c_som.txt)开发了一个功能来做到这一点。

# wpf - 多次加载 ListboxItem

> ID：1019625
> 
> 赞同：0
> 
> 时间：2009-06-19T19:19:54.773
> 
> 标签：wpf, storyboard, listboxitem, loaded

我的列表框项目的情节提要上有一个触发器，其中触发器是“已加载”。似乎每次列表框滚动时，项目都会收到“已加载”事件。我真的只希望情节提要在显示列表框项时运行一次。

我假设 Loaded 事件只会被触发一次。

任何帮助都会很棒。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T00:34:18.430

我不确定你是否可以让它只运行一次。大多数时候`ListBox`将 a`VirtualizingStackPanel`用于其`ItemsPanel`. 这只会导致那些`ListBoxItems`可见（或几乎可见）的内容被创建并添加到可视化树中。滚动离开后，可见的项目将被销毁，然后创建新可见的项目。每次滚动到一个项目时，它都会被重新创建，因此它的`Loaded`事件会触发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-20T10:24:52.270

您可以尝试为您的列表框设置 VirtualizingStackPanel.IsVirtualizing="False" ，应该这样做。请注意，这会消耗更多资源，因为无论您是否在列表中看到它们，它们都将始终存在。如果你没有太多的项目，应该不是问题。

# iphone - 大数据集和 AddressBook 的 ABAddressBookCopyArrayOfAllPeople

> ID：1019637
> 
> 赞同：0
> 
> 时间：2009-06-19T19:21:30.700
> 
> 标签：iphone

使用 AddressBook API，如果您不使用“ABPeoplePickerNavigationController”，获取所有人列表的唯一方法似乎是通过“ABAddressBookCopyArrayOfAllPeople”。

ABPeoplePickerNavigationController 的选择一个人并关闭视图行为不是我需要的。相反，我想做的是将通讯簿内容加载到我自己的表格视图中，然后执行一些自定义选择行为。

但是有没有办法处理部分加载地址簿数据而不是整个列表来提供数据作为表的数据源？如果说地址簿包含 3000 个条目，那么我将所有这些数据复制到本地数组中——有没有更优化的方法来实现更好的性能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T19:39:15.250

不确定它是最佳的，但如果你想显示表格中的所有内容，它必须以某种方式“排序”，假设你简单地按字母顺序排序，那么你可以代替复制所有地址簿，只要求它返回一个列表以“a”开头的记录我认为的方法是：CFArrayRef ABAddressBookCopyPeopleWithName (ABAddressBookRef addressBook, CFStringRef name); name 可以是“a*”，它将返回所有以 a 开头的人。从您的表中多次调用此方法可用于避免复制我认为的所有人。

希望这会有所帮助，-t

# c# - Winforms 中的相对路径

> ID：1019641
> 
> 赞同：10
> 
> 时间：2009-06-19T19:21:53.880
> 
> 标签：c#, winforms, relative-path

C# 中的相对路径对我来说很奇怪。在一种情况下，我为我的应用程序处理一组 Texture2d 对象，它获取文件名并使用它来定位文件并将纹理加载到 Image 对象中。然后我从存储在类文件中的相对路径加载图像，并使用需要相对于 Content/gfx 的相对路径。但是如果我不加载这些纹理，这些相对路径将会失败。我如何保证我的 rel 路径不会失败？在网络工作中，所有 rel 路径都相对于我们正在使用的文件所在的文件夹，我可以这样设置它并使所有 rel 路径指向我的应用程序所在的根文件夹吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-06-19T19:29:35.660

我建议首先不要使用相对路径。

使用[Path.Combine](http://msdn.microsoft.com/en-us/library/system.io.path.combine.aspx)将您的相对路径转换为绝对路径。例如，您可以使用它来获取启动 EXE 的完整路径：

```
string exeFile = (new System.Uri(Assembly.GetEntryAssembly().CodeBase)).AbsolutePath; 
```

一旦你有了它，你可以得到它的目录：

```
string exeDir = Path.GetDirectoryName(exeFile); 
```

并将您的相对路径转换为绝对路径：

```
string fullPath = Path.Combine(exeDir, "..\\..\\Images\\Texture.dds"); 
```

这将比尝试使用相对路径可靠得多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T19:29:15.783

如果您希望资源与可执行文件位于同一目录或该目录的子目录中，则最好始终使用

```
string fullPath = System.IO.Path.Combine(System.IO.Directory.GetCurrentDirectory(), subPath); 
```

或者如果您担心工作目录可能是错误的，您可以这样做：

```
string fullPath = System.IO.Path.Combine(System.IO.Path.GetDirectoryName(System.Reflection.Assembly.GetEntryAssembly().Location), subPath); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-12T13:32:31.570

// [命名空间] 是命名空间 //你应该复制你的文件.-- 到调试文件中

```
 string path = (Assembly.GetEntryAssembly().Location + "");
      path = path.Replace("name space", "filename.--");

      // [WindowsFormsApplication4] is name space 
      //you should copy your "mysound.wav" into Depug file 

         //example::
       string path_sound  = (Assembly.GetEntryAssembly().Location + "");
      path_sound  = path_sound.Replace("WindowsFormsApplication4.exe", "mysound.wav");

      SoundPlayer player1 = new SoundPlayer(path_sound);
      player1.Play(); 
```

# geometry - 如何在给定原点、距离和方向（方位角）的情况下在地球表面找到一个点

> ID：1019642
> 
> 赞同：3
> 
> 时间：2009-06-19T19:22:16.673
> 
> 标签：geometry, geospatial

上一个问题[“通过距离和方位从已知位置查找点坐标的地理算法”](https://stackoverflow.com/questions/695065/geoalgorithm-for-finding-coordinates-of-point-from-a-known-location-by-distance-a)提出了同样的问题，但找到的解决方案是一个粗略的近似值。我想要一个更准确的解决方案。我将结果与[大圆距离](http://en.wikipedia.org/wiki/Great-circle_distance)公式进行比较，这是已知的最佳[地理距离](http://en.wikipedia.org/wiki/Geographical_distance)公式之一。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-22T17:39:53.630

这是迄今为止我见过的最好的公式，来自[http://www.movable-type.co.uk/scripts/latlong-vincenty-direct.html](http://www.movable-type.co.uk/scripts/latlong-vincenty-direct.html)

```
a, b = major & minor semiaxes of the ellipsoid   
f = flattening (a−b)/a   
φ1, φ2 = geodetic latitude   
s = length of the geodesic   
α1, α2 = azimuths of the geodesic (initial/final bearing)    

tanU1 = (1−f).tanφ1 (U is ‘reduced latitude’)    
cosU1 = 1/√(1+tan²U1), sinU1 = tanU1.cosU1 (trig identities; §6)     
σ1 = atan2(tanU1, cosα1)    (1)
sinα = cosU1.sinα1  (2)
cos²α = 1 − sin²α (trig identity; §6)    
u² = cos²α.(a²−b²)/b²    
A = 1+u²/16384.{4096+u².[−768+u².(320−175.u²)]} (3)
B = u²/1024.{256+u².[−128+u².(74−47.u²)]}   (4)

σ = s / b.A (1st approximation), σ′ = 2π     
while abs(σ−σ′) > 10-12 { (i.e. 0.06mm)  
        cos2σm = cos(2.σ1 + σ)  (5)
    Δσ = B.sinσ.{cos2σm + B/4.[cosσ.(−1 + 2.cos²2σm) − B/6.cos2σm.(−3 + 4.sin²σ).(−3 + 4.cos²2σm)]} (6)
    σ′ = σ   
    σ = s / b.A + Δσ    (7)
}        
φ2 = atan2(sinU1.cosσ + cosU1.sinσ.cosα1, (1−f).√[sin²α + (sinU1.sinσ − cosU1.cosσ.cosα1)²])    (8)
λ = atan2(sinσ.sinα1, cosU1.cosσ − sinU1.sinσ.cosα1)    (9)
C = f/16.cos²α.[4+f.(4−3.cos²α)]    (10)
L = λ − (1−C).f.sinα.{σ+C.sinσ.[cos2σm + C.cosσ.(−1 + 2.cos²2σm)]} (difference in longitude)    (11)
α2 = atan(sinα, −sinU1.sinσ + cosU1.cosσ.cosα1) (reverse azimuth)   (12)
p2 = (φ2, λ1+L) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T19:28:49.077

这两点相距多远？我很喜欢使用 Gauss-Kruger 投影，如果这两个点在 100 海里左右的范围内，它就可以正常工作。它的优点是可以让您在局部空间中使用常规三角函数，然后将其转换回大地坐标。

如果它们比这更远，我会回到大圆，但圆的半径是地球在沿所需方位的给定点的曲率半径，使用 WGS-84 椭球计算。

# python - 什么是交叉制表的好数据模型？

> ID：1019643
> 
> 赞同：6
> 
> 时间：2009-06-19T19:22:33.567
> 
> 标签：python, algorithm, data-structures, statistics, crosstab

我正在 Python 中实现一个交叉表库作为我的新工作的编程练习，并且我已经实现了一个可行但不优雅和冗余的要求的*实现*。我想要一个更好的模型，它允许在基本模型之间进行良好、干净的数据移动，以表格数据形式存储在平面文件中，以及所有可能被询问的统计分析结果。

现在，我有一个进展，从表中每一行的一组元组，到计算感兴趣元组出现频率的直方图，再到一个序列化器——有点笨拙——将输出编译成一个集合用于显示的表格单元格。然而，我最终不得不比我想要的更频繁地回到表格或直方图，因为没有足够的信息到位。

那么，有什么想法吗？

编辑：这是一些数据的示例，以及我希望能够从中构建的内容。注意 ”。” 表示一点“缺失”的数据，它只是有条件地计算。

```
1   .   1
1   0   3
1   0   3
1   2   3
2   .   1
2   0   .
2   2   2
2   2   4
2   2   . 
```

如果我正在查看上面第 0 列和第 2 列之间的相关性，这就是我拥有的表格：

```
 . 1 2 3 4
1   0 1 0 3 0
2   2 1 1 0 1 
```

此外，我希望能够计算频率/总、频率/小计等的比率。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T23:03:24.147

您可以使用内存`sqlite`数据库作为数据结构，并将所需的操作定义为 SQL 查询。

```
import sqlite3

c = sqlite3.Connection(':memory:')
c.execute('CREATE TABLE data (a, b, c)')

c.executemany('INSERT INTO data VALUES (?, ?, ?)', [
    (1, None,    1),
    (1,    0,    3),
    (1,    0,    3),
    (1,    2,    3),
    (2, None,    1),
    (2,    0, None),
    (2,    2,    2),
    (2,    2,    4),
    (2,    2, None),
])

# queries
# ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-07-15T02:11:19.297

SW[在 activestate.com 上发布了一个很好的基本配方](http://code.activestate.com/recipes/334695-pivotcrosstabdenormalization-of-a-normalized-list/)。

本质似乎...

1.  将 xsort=[] 和 ysort=[] 定义为轴的数组。通过遍历您的数据或其他方式来填充它们。
2.  通过迭代数据并递增 rs[yvalue][xvalue]，将 rs={} 定义为列表数据的字典。如果/需要时创建缺少的键。

那么例如，第 y 行的总数将是`sum([rs[y][x] for x in xsort])`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T19:57:22.373

由于这是 Python 的早期编程练习，他们可能希望您了解哪些 Python 内置机制适合该问题的初始版本。字典结构似乎是一个不错的选择。tab-sep 文件中的第一列值可以是字典的键。该键找到的条目本身可以是一个字典，其键是第二列值。子字典的条目将是一个计数，当您在第一次遇到一对时添加新的子字典时初始化为 1。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-19T19:29:09.403

为什么不使用 HTML 表格来存储它？它可能不是最好的，但您可以非常轻松地在浏览器中查看它。

编辑：

我只是重新阅读了这个问题，您要求的是数据模型，而不是存储模型。要回答这个问题...

这完全取决于您将如何报告数据。例如，如果您要进行大量数据透视或聚合，则以列主要顺序存储它可能更有意义，例如，您可以对列进行求和以获取计数。

如果您解释您要提取的信息类型，将会有很大帮助。

# sql - 如何从数据库表中的一组行中选择顶部记录？

> ID：1019648
> 
> 赞同：0
> 
> 时间：2009-06-19T19:23:21.897
> 
> 标签：sql, sql-server

我正在`SELECT`读取一组记录，但一个列在两个或多个结果中产生不同的值。我只想要`SELECT`最高价值；不是`Min`一个或`Max`值，而是`Top N`SQL Server 2008 遇到的值。是否有任何聚合机制可以执行此操作？

**例如**

**表有： 我执行： SELECT [Name], [Symbol], PriceDate FROM aaa GROUP BY [Name], [Symbol] 想要的结果是：

`Microsoft MSFT 12/21/05
Microsoft MSFT 10/22/05
Microsoft MSFT 11/23/06
Paramount PMNT 02/21/05
Paramount PMNT 01/23/06` 

`*Microsoft MSFT 12/21/05*
*Paramount PMNT 02/21/05*`** 

（`TOP`失败）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T20:03:22.393

嗯，我认为所有的答案都不能回答这个问题（但当然也许我的问题是错误的）：

如果你不分组，你可能会得到两次 MSFT，所以我们从这样的开始

```
select name, symbol, x(date)
from sometable 
group by name, symbol 
```

我得到的问题与函数 x() 有关，该函数将返回相应组中日期列的第一个元素。问题是：关系数据库中没有自然的行顺序。所以这样的函数不能存在，因为它没有被定义。

您需要另一列定义顺序，例如列时间戳：

```
select 
    a.name, 
    a.symbol, 
    (
        select b.date 
        from sometable 
        where b.timestamp = min(a.timestamp) 
        and a.name = b.name
        and a.symbol = b.symbol
    ) as first_date
from sometable as a
group by name, symbol 
```

这至少在甲骨文中有效。如果sqlserver不喜欢这个可以重写为join。另一种方法是分析函数，我被告知由 sqlserver 支持

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T19:24:39.070

```
SELECT TOP 1   [Name], [Symbol], PriceDate
FROM     aaa
GROUP BY [Name], [Symbol] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T19:27:23.977

`Select TOP`如果您不指定订单（使用`ORDER BY`smt）就没有意义，所以您想做 smt 如下：

```
SELECT TOP N *
FROM myTable
ORDER BY anyFields 
```

如果没有 order by，您可能会得到不一致的结果（没有什么可以保证相反的结果）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T19:28:26.987

一种方式，您也可以使用变量而不是 1，因为 sql server 2005

```
select top (1) * 
from SomeTable
order by SomeColumn 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T21:18:40.743

`SELECT [Name], [Symbol], PriceDate
FROM   aaa
WHERE  PriceDate =
(
   SELECT Top 1 aaa_2.PriceDate FROM aaa aaa_2
    WHERE aaa_2.[Name]   = aaa.[Name]
      AND aaa_2.[Symbol] = aaa.[Symbol]
)`

# javascript - 如何使用 jQuery 知道 DOM 元素当前是否在屏幕上

> ID：1019652
> 
> 赞同：0
> 
> 时间：2009-06-19T19:24:28.197
> 
> 标签：javascript, jquery, dom

是否有一个函数或插​​件可以告诉我当前是否显示了超过 50% 的`<div>`块？

我知道有类似的事情，`$.offset()`但我不想每次用户调整窗口大小或滚动到某个区域时都手动进行。

上的东西`:visible`，但目前是可见的。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T19:32:15.903

如果您对“可见”的定义是“屏幕上超过 50% 的 div”，那么您将需要创建自己的函数来计算它。

您将需要准确定义`<div>`您正在计算的部分 - 即边距、边框、隐藏在`scrollTop`/`scrollLeft`中的元素等...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-06-22T09:35:44.347

这个聚会有点晚了，但确实有一个 JQuery 插件：

[Is On Screen](http://plugins.jquery.com/project/isOnScreen)插件可以从这里下载：http: //plugins.jquery.com/node/16506/release[还有](http://plugins.jquery.com/node/16506/release)一个[演示页面](http://spectrum.0sites.net/demos/isOnScreen/isOnScreen_Demo.html)

希望有帮助。

# sql - 从日期编号表（日期持续时间）中查找开始和结束日期

> ID：1019661
> 
> 赞同：1
> 
> 时间：2009-06-19T19:25:41.657
> 
> 标签：sql, vb.net, linq, algorithm, clr

我有两个表：一个包含有关如何安排员工的信息的日程表和一个数字表，其中每个数字对应于一个日期。

表格如下所示：

```
[Employee Schedule]

ID          Employee ID Project ID  Day ID
----------- ----------- ----------- -----------
1           64          2           168
2           64          2           169
3           64          2           170
4           64          2           171
5           64          1           169
6           64          1           170
7           64          1           171
8           64          1           172
9           64          2           182
10          64          2           183
11          64          2           184 
```

和

```
[Day Numbers]

ID          Day
----------- ----------
168         2009-06-18
169         2009-06-19
170         2009-06-20
171         2009-06-21
172         2009-06-22
173         2009-06-23
174         2009-06-24
175         2009-06-25
176         2009-06-26
177         2009-06-27
178         2009-06-28
179         2009-06-29
180         2009-06-30
181         2009-07-01
182         2009-07-02
183         2009-07-03
184         2009-07-04 
```

如您所见，员工 64 计划在 2009-06-19 到 2009-06-22 的项目 1 和从 2009-06-18 到 2009-06-21 的项目 2 以及从 2009-07-02 到 2009- 07-04。

我的问题是：我可以使用什么算法来快速确定员工日程安排的跨度，以便我可以如下显示？

```
 Employee ID Project ID Duration
 ----------- ---------- ------------
 64          1          2009-06-19 to 2009-06-22
 64          2          2009-06-18 to 2009-06-21
 64          2          2009-07-02 to 2009-07-04 
```

我可以在 SQL 端或代码端执行此操作。如果需要，我可以使用 Linq。该表不需要通过 SQL 编译。这将在网站上动态发生，并且应该尽可能高效。如果我不需要的话，我不想遍历每一个并在连续的日子里寻找休息时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T20:39:01.137

假设对于部分解决方案，Day ID 始终是连续的......

```
select *
  from employee_schedule a                    
 where not exists( select *                          
                     from employee_schedule b        
                    where a.employeeid = b.employeeid
                      and a.projectid  = b.projectid 
                      and (a.dayid - 1) = b.dayid ) 
```

列出开始日 ID：

```
 ID      EMPLOYEEID       PROJECTID           DAYID 
 1              64               2             168 
 5              64               1             169 
 9              64               2             182 

select *
  from employee_schedule a                   
 where not exists( select *                         
                     from employee_schedule b       
                    where a.employeeid = b.employeei
                      and a.projectid  = b.projectid
                      and (a.dayid + 1) = b.dayid ) 
```

列出结束日 ID：

```
 ID      EMPLOYEEID       PROJECTID           DAYID 
  4              64               2             171 
  8              64               1             172 
 11              64               2             184 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T20:09:31.897

让我们创建一个视图以使事情变得更容易：

```
create view EmployeeProjectDates
as
select
    e.[Employee ID], e.[Project ID], d.Day
from
    [Employee Scchedule] e
    join [Day Numbers] d on e.[Day Id] = d.ID 
```

您可以执行这样的查询来获取所有开始日期：

```
select
    one.[Employee ID], one.[Project ID], one.Day as StartDate
from
    EmployeeProjectDays one
    left join EmployeeProjectDays two on one.[Employee ID] = two.[Employee ID] and one.[Project ID] = two.[Project ID] and one.Day = DATEADD(DAY, 1, two.Day)
where
    two.Day is null 
```

然后做一个类似的查询来获取结束日期并匹配它们。我认为这样的事情会让你们俩都受益。

```
select
    one.[Employee ID], one.[Project ID], one.Day as StartDate,
    (select
        min(two_end.Day)
    from
        EmployeeProjectDays one_end
        join EmployeeProjectDays two_end on one_end.[Employee ID] = two_end.[Employee ID] and one_end.[Project ID] = two_end.[Project ID] and one.Day = DATEADD(DAY, 1, two.Day)
     where
        one_end.Day is null
        and two_end.Day > one.Day) as EndDate
from
    EmployeeProjectDays one
    left join EmployeeProjectDays two on one.[Employee ID] = two.[Employee ID] and one.[Project ID] = two.[Project ID] and one.Day = DATEADD(DAY, 1, two.Day)
where
    two.Day is null 
```

我没有测试任何这些查询，但类似的东西应该可以工作。在我们在应用程序代码中实现某些内容之前，我必须使用类似的查询来查找开始和结束日期。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T21:29:58.317

这个适用于 oracle，并且从它开始在 SQL Server 中也应该是可能的。（包括测试脚本）

```
create table schedule (id number, employee_id number, project_id number, day_id number);

insert into schedule (id, employee_id, project_id, day_id)
values(1,64,2,168);
insert into schedule (id, employee_id, project_id, day_id)
values(2,64,2,169);
insert into schedule (id, employee_id, project_id, day_id)
values(3,64,2,170);
insert into schedule (id, employee_id, project_id, day_id)
values(4,64,2,171);
insert into schedule (id, employee_id, project_id, day_id)
values(5,64,1,169);
insert into schedule (id, employee_id, project_id, day_id)
values(6,64,1,170);
insert into schedule (id, employee_id, project_id, day_id)
values(7,64,1,171);
insert into schedule (id, employee_id, project_id, day_id)
values(8,64,1,172);
insert into schedule (id, employee_id, project_id, day_id)
values(9,64,2,182);
insert into schedule (id, employee_id, project_id, day_id)
values(10,64,2,183);
insert into schedule (id, employee_id, project_id, day_id)
values(11,64,2,184);
insert into schedule (id, employee_id, project_id, day_id)
values(11,65,3,184);

select * 
FROM (
    select  
        employee_id,
        project_id,
        first_day,
        nvl(last_day, 
            lead(last_day) over (
                partition by employee_id, project_id 
                order by nvl(first_day, last_day)
            )
        ) last_day
    from (
        select -- this identifies start and end rows of an interval
            employee_id,
            project_id,
            decode (day_id - prev_day, 1, null, day_id) first_day, -- uses day_id, if prev_day is not really the previous day, i.e. a gap or null
            decode (day_id - next_day, -1, null, day_id) last_day
        from (
            select -- this select adds columns for the previous and next day, in order to identify the boundaries of intervals 
                employee_id, 
                project_id, 
                day_id, 
                lead(day_id) over ( 
                    partition by employee_id, project_id 
                    order by day_id
                ) next_day,
                lag(day_id) over ( 
                    partition by employee_id, project_id 
                    order by day_id
                ) prev_day
            from schedule
        )
    )
    where first_day is not null 
    or last_day is not null-- just filter the rows, that represent start or end dates
) 
where first_day is not null 
```

产生这个输出：

```
64  1   169 172
64  2   168 171
64  2   182 184
65  3   184 184 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T19:35:33.120

我还没有测试，但尝试：

```
select [Employee ID], [Project ID], start + ' to ' + end
from (
    select s.[Employee ID], s.[Project ID], min(d.Day) start, max(d.Day) end
    from [Employee Schedule] s
    inner join [Day Numbers] d on s.[Day ID] = d.[Day ID]
    group by s.[Employee ID], s.[Project ID]
) a 
```

编辑：更正了一些列名

为了便于查询，我建议您将架构重构为：

```
[EmployeeSchedule]

ID 
EmployeeID 
ProjectID  
StartDate 
EndDate 
```

并彻底摆脱天数。这将使您的查询更简单、更有效，并且如果您愿意，将允许您拥有具有 NULL StartDates 或 EndDates 的记录。

# visual-studio - 视觉源安全 - 如何从解决方案中删除绑定，无需在 Visual Studio 中打开

> ID：1019664
> 
> 赞同：12
> 
> 时间：2009-06-19T19:26:20.300
> 
> 标签：visual-studio, visual-sourcesafe

有谁知道在 Visual Studio 2005 和 2008 解决方案中删除 vss 源代码控制绑定的好方法，而无需在 Visual Studio 中打开它？

我曾经使用：`del /s /f /a: *.*scc` 然后当我打开 Visual Studio 时，它会提示我并让我选择“永久删除绑定”。

现在，当我尝试这样做时，它会重新创建 .vssscc 文件并告诉我我的工作副本包含不同版本的 .vsscc 文件。没有删除源代码控制绑定的选项。

真正的问题是我正在尝试从源代码安全的解决方案的旧标签副本上工作。但是，如果我在它仍然绑定到源代码控制时打开解决方案，它将获得最新版本的网站。即使我未选中“源代码管理--> 环境--> 打开解决方案或项目时获取所有内容”选项，它也会执行此操作。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-06-19T21:25:41.180

我通过编辑解决方案文件以及删除 *.*scc 文件来实现这一点。

这是我从解决方案文件中删除的内容：

在该部分下：

```
ProjectSection(WebsiteProperties) = preProject 
```

我删除了以下 4 行：

```
 SccProjectName = ""$/HOS_amend.root/HOS", ENWBAAAA"
        SccAuxPath = ""
        SccLocalPath = ".."
        SccProvider = "MSSCCI:Microsoft Visual SourceSafe" 
```

还删除了整个部分：

```
GlobalSection(SourceCodeControl) = preSolution 
```

执行此操作后，当我打开解决方案时，我会收到“永久删除绑定”选项的提示。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-06-05T09:18:50.693

**在 Visual Studio 中**

1.  打开你的项目，然后转到
2.  文件--> 源代码管理--> 更改源代码管理。
3.  选择项目和/或解决方案
4.  单击解除绑定。

您还需要将所有文件的只读属性更改为读/写，以便以后能够修改它们。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-05-09T18:59:30.460

这是我用来删除所有源代码控制文件的 .cmd 文件：

```
:: *.scc
:: ===========================================================================

attrib /s -h -s "*.scc"  :: Must get rid of system and hidden attributes
attrib /s -r "*.scc"     :: at same time
del /s "*.scc"

:: *.vssscc
:: ===========================================================================

attrib /s -h -s "*.vssscc"
attrib /s -r "*.vssscc"
del /s "*.vssscc"

:: *.vspscc
:: ===========================================================================

attrib /s -h -s "*.vspscc"
attrib /s -r "*.vspscc"
del /s "*.vspscc"

:: *.vsscc
:: ===========================================================================

attrib /s -h -s "*.vsscc"
attrib /s -r "*.vsscc"
del /s "*.vsscc" 
```

之后，您可以在 Visual Studio 中打开并提示您删除源代码控制绑定（这会删除 Seth Reno 提到的行，即。

```
 SccProjectName = "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
    SccAuxPath = "x"
    SccLocalPath = "xxx"
    SccProvider = "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" 
```

)

或者你可以做某种正则表达式删除，但我没有代码。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-11-10T21:48:52.353

只需在您的项目中搜索 *.scc 和*.vss*，删除所有这些，然后在 Visual Studio 2008 中打开您的项目，它会询问您是否要删除绑定或修复它

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T20:04:33.623

我不确定“最佳”答案，但我可以提供一些信息：首先，我想出的将 VS2005/2008 项目或解决方案与 VSS 分开的唯一可靠方法是创建一个新的解决方案和项目相同的设置，在新文件夹中，复制所有模块、类、表单等成员文件，然后将它们添加到项目中，最后，重置所有项目和解决方案属性以匹配。

如果有人有更好**可靠**的方法来做到这一点，我很想听听，但到目前为止，我尝试过的所有其他事情都导致项目/解决方案和 VSS 集成都被破坏。

AFAIK，其原因是在 solution.SSC、solution.VSSSCC、solution.SLN、mssccprj.scc、vssver.ssc 和 *.%proj 文件中以及可能在 SUO 中的 VSS 和 VS 项目之间的绑定（啊！）。

# iphone - 如何区分 iPhone 上的 Shake 和 Tilt

> ID：1019665
> 
> 赞同：1
> 
> 时间：2009-06-19T19:26:22.483
> 
> 标签：iphone, cocoa-touch, accelerometer

我有一个页面 UIScrollView 将根据手机的倾斜向左或向右滚动 1 页。

我还想实现“随机页面摇动”，但无法弄清楚如何区分摇动运动和 x 轴倾斜的逻辑。

这两种运动可以相互结合使用吗？我不需要任何复杂的东西，比如倾斜时摇晃，我只想让两者独立工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T19:28:43.087

要检测“摇晃”，您将检查生成的 g 力。摇晃比倾斜会更高。

[如何检测有人摇晃 iPhone？](https://stackoverflow.com/questions/150446/how-do-i-detect-when-someone-shakes-an-iphone)

您绝对可以同时使用两者，只需检查 g-force 以获得足够高的值以指示晃动（> 1g - 调整以获得您喜欢的灵敏度），然后如果没有检测到晃动下降到倾斜检查。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T19:50:35.350

iPhone 应用程序编程指南提供了[检测重力](http://developer.apple.com/iphone/library/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/AdvancedFeatures/AdvancedFeatures.html#//apple_ref/doc/uid/TP40007072-CH14-SW7)（倾斜）和突然加速（摇晃）的代码示例

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T19:28:05.147

倾斜度不应超过 1g，而摇晃很容易做到这一点。

# jquery - jQuery 和动态生成的表单

> ID：1019686
> 
> 赞同：1
> 
> 时间：2009-06-19T19:29:43.413
> 
> 标签：jquery, forms, dynamic, field

我正在动态创建表单字段。

* * *

如果我使用

```
<script>
$().ready(function() {

    $("input[name=salesPrice1]").blur(function() {

        var nameID = $("input[name=salesPrice1]").val();

        alert(nameID);

        //var newName = $("input#newName").val();

        $.ajax({
            type: "POST",
            url: "cashPrice.cfm",
            data: "salePrice=" + $("input[name=salesPrice1]").val(),
            cache: false,
            success: function(data) {
                $("#cashPrice1").html(data);
            }
        });
    });
});
</script> 
```

它将部分工作。现在，我必须动态获取 formField 的 ID/名称。我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T19:57:17.193

试试这个 ？

```
$("input[name^=salesPrice]").each(function(){
    var input = $(this); 
    var name = input.attr('name');
    var num = /\d+$/.exec(name)[0];

    $(this).blur(function() {

        var nameID = input.val();

        alert(nameID);

        //var newName = $("input#newName").val();

        $.ajax({
        type: "POST",
        url: "cashPrice.cfm",
        data: "salePrice=" + nameID,
        cache: false,
        success: function(data) {
            $("#cashPrice"+num).html(data);
        }
        });
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T19:39:04.780

你的问题充其量是模糊的。但这有点符合您想要的吗？：

```
$("input").blur(function ()
{
    var that = $(this);

    var id = that.attr("id");
    var name = that.attr("name");
}); 
```

**更新：**

您可以在值上匹配元素：

```
$("input[id^='hello']") 
```

将匹配：

```
<input type="text" id="helloworld" />
<input type="text" id="helloearth" /> 
```

但不是：

```
<input type="text" id="hiworld" /> 
```

请参阅[选择器文档](http://docs.jquery.com/Selectors)。

**注意：**这些选择器很慢，我只会将它们用作最后​​的手段。为了提高性能，您可以对 DOM 节点的子集进行查询：

```
$("complex selector goes here", $("container node in which to query")) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T20:18:05.903

这也有效：

```
<html>
<script type="text/javascript">
    $().ready(function() {
        alert('loaded');
        $('.salesPriceInput').blur(function ()
        {    
            alert($(this).attr("id"));
            var myID = $(this).attr("id").substr(10,1); 
            alert(myID);
            $.ajax({
                type: "get",
                url: "cashPrice.cfm",
                data: "salePrice=" + $('#salesPrice'+myID).val(),
                cache: false,
                success: function(data){
                   $('#cashPrice'+myID).html(data);
                }
            })
         }); 
    });
</script>

<form>
    <cfoutput>
        <cfloop from="1" to="3" index="i">
            <input type="text" name="salesPrice#i#" id="salesPrice#i#" class="salesPriceInput" value="" />
            <div id="cashPrice#i#"></div>
            <hr />
        </cfloop>
    </cfoutput>
</form> 
```

# visual-studio - 塑料单片机与 SVN

> ID：1019687
> 
> 赞同：12
> 
> 时间：2009-06-19T19:29:57.717
> 
> 标签：visual-studio, svn, version-control, plasticscm

我目前正在为一个由 10 名开发人员组成的团队研究新的源代码控制选项。我们在 Visual Studio 2008 中进行 .net 开发。我们目前使用 VSS 进行源代码控制。

我们正在寻找一个集中的源代码控制解决方案（非分布式），带有一个不错的 Visual Studio 插件。我的经理推荐了 Plastic SCM，而我一直都听说过关于 Subversion 的好消息。我正在尝试决定我们是否应该采用 Subversion 或 Plastic SCM。

关于塑料单片机的信息不多（除了他们写的），我想知道这是否是一个好的解决方案。它们听起来好像分支要简单得多。

另一方面，Subversion 有一个强大、成熟的社区，并且已经过彻底的现场测试。

这些工具的优缺点是什么？

还有其他工具可以推荐吗？

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2010-03-27T00:25:09.200

我想为每个仍然做出选择的人添加这个答案。

我正在使用 VS2008 在 C# 中进行开发。我在一个由两个开发人员组成的团队中工作。我们曾经没有源代码控制（恐怖），然后我们使用 Subversion（okish），然后我们切换到 Plastic SCM（好）。

我的比较矩阵：（
请注意我的 Windows 用户观点，YMMV）

专业塑料：

*   Windows 应用程序——漂亮而直观的用户界面
*   很好的学习视频（你可以在大约两个小时的时间内学习所有你需要的东西）
*   标准任务都很容易完成：切换到另一个分支、获取某个文件的旧版本、差异、合并。

反塑料：

*   花钱（开源免费；**编辑（2/2011）：** ~~曾经有免费的商业 2 用户许可证~~有一个免费的 15 用户商业许可证。不过，您需要每年更新它。）
*   没有真正的服务器/管理程序：我不知道数据存储在磁盘上的确切位置；这一切都对我隐藏了。现在，如何备份我的存储库？我知道的唯一“解决方案”是使用客户端的复制功能并将存储库复制到您的本地主机服务器。（我还没有这样做。）[编辑：查看评论以获得真正的解决方案。]

专业颠覆：

*   自由
*   开源
*   庞大的用户群

反颠覆：

*   Subversion 不能真正处理文件重命名。您可以解决，但它（还）不是本机功能。
*   移动目录之类的事情可能会损坏您的工作副本。
*   Tortoise SVN 只是命令行 svn.exe 的外观。对于许多操作，您仍然需要了解命令行命令及其开关。
*   Tortoise SVN 严重减慢了我的 Windows 资源管理器右键单击速度。
*   当存在冲突时，合并需要更多时间。您获得同一个文件的多个副本，然后您必须删除所有不需要的版本（为此保留 Visual Studio），或者您将冲突指示符放入您的代码中，这会使您的代码无法编译，直到您将它们全部删除. 另一方面，在 Plastic SCM 中，合并操作会打开一个类似于 WinMerge 的窗口，您只需单击需要解决冲突的代码块即可。

希望有帮助。如果您需要任何其他具体信息，请告诉我。

菲利克斯

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-19T19:50:37.083

使用 VisualSVNServer 是在 Windows 环境中启动和运行 Subversion 的一种简单方法，他们有一个工具可以提供 Visual Studio 集成，价格约为 50 美元/开发。当我在一家公司工作时，我正处于转型期，决定是在 SVN 和 Perforce 之间做出的。我们最终选择了 SVN，因为我能够轻松获得、使用、测试和使用它。我们可以获得 Perforce 的 WebEx 演示文稿，但如果不购买他们的书就很难学习。我还认为它是开发人员了解的更好工具，因为有很多开源项目都在上面，而且它是一种更易于转移的技能。如果您要转到另一个职位，则不太可能使用塑料单片机。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-07-23T23:44:21.987

看看这里的[表现](http://codicesoftware.blogspot.com/2010/07/version-control-scalability-shoot-out.html)。它将两个系统在非常重的负载下（1、10、20、50，最后是 100 台并发机器与单个服务器进行比较，这肯定比 100 多个真实用户）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-19T19:34:34.010

我提前为我的建议找借口，但是您可以集中使用分布式版本控制系统。这只是开发团队内部的政治问题。

例如，Mercurial 允许通过 TortoiseHG 非常轻松地通过 Web 服务进行拉取和推送。

或者，也许您可​​以尝试使用混合解决方案、集中式（颠覆）服务器以及为每个使用 git 的开发人员提供本地分支，我不得不说，这非常容易。

对于 Subversion <-> VStudio，我使用过 Ankh，我发现它非常易于使用。对于 Git <-> VStudio，我使用了 GitExtensions，但集成不如 Tortoise Shell 扩展或 Ankh 那样好，但您可以自己尝试。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-19T19:36:36.457

我以前没有使用过 Plastic SCM，但 Subversion 过去对我来说效果很好。如果您不受 SVN 等免费解决方案的约束，您可以考虑使用 Team Foundation Server。除了版本控制之外，TFS 还提供了其他不错的功能，例如工作项跟踪、集成报告……您可以想象，Visual Studio 集成非常棒:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-03-16T19:50:48.350

我使用了 GIT、SVN 和 Plastic（SCM 4 之前的版本），然后是 SVN，现在又回到了 Plastic SCM 4。Plastic 不仅比我使用的其他工具更快地签入/签出/更新等，而且它有一个漂亮的用户界面以及直观的（对我而言）导航和功能。当我更改分支等时，我总是遇到 SVN 损坏的工作副本等。Plastic 对我有用。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-07-23T09:07:39.700

VSS 的另一个替代方案是[SourceGear Vault](http://www.sourcegear.com/vault/)（'vss done right'）。最大的优点是它可以工作（与 VSS 不同）。

PlasticSCM 似乎是一种分布式解决方案，而 svn（以及 VSS、TFS、...）是集中式的。如果你想要商业分布式解决方案的替代品，你可能想看看[git](http://www.git-scm.org/)、[mercurial](http://mercurial.selenic.com/wiki/)、[bazaar](http://bazaar-vcs.org/)。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2014-05-31T11:41:02.843

我使用 SVN 的时间最长。我已经习惯了。无论是在办公室还是在我家里的个人网络上。它工作得很好而且很容易。

我最近开始了一份新工作，在这个办公室里我们使用塑料。这是我第一次接触这个产品。我对 Plastic 感到非常震惊，以至于在我自己的服务器上，我放弃了 SVN 并转移到了 Plastic。就是这么好。我不会轻易被说服回到 SVN。塑料是完美的。最多 15 位开发人员可免费使用。它可以与 SQL 服务器集成，因此您可以始终准确地知道您的存储库在哪里。它可以连接以使用 AD 身份验证。我最喜欢 Plastic 的是它的 Branch explorer。它有一个 GUI，可以显示当前项目的所有分支。在此分支资源管理器中，您可以从主分支创建子分支或将子分支合并回主分支。这是经过深思熟虑的。

塑料恕我直言，梦想成真。巴勃罗知道他的东西！

# netbeans - Netbeans Glassfish 在 web 服务上给出 404，但不是 JSP 页面

> ID：1019699
> 
> 赞同：0
> 
> 时间：2009-06-19T19:32:51.097
> 
> 标签：netbeans

我在 NetBeans 中创建了一个“WebApplication”。它有一个 JSP 页面和一个 web 服务。它工作正常。然后我做了一些小改动并重新部署。突然，网络服务给出了 404（未找到）错误。GlassFish 仍在运行，我什至可以在同一个项目中点击 JSP 页面，并且可以识别对 JSP 页面的更改。

这是我的部署输出：

```
在里面：
deps 模块 jar：
deps-ear-jar：
deps-jar：
库包含在存档中：
清单中包含的库：
编译：
编译jsps：
构建 jar：C:\Documents and Settings\randys\My Documents\NetBeansProjects\WebApplication6\dist\WebApplication6.war
启动 GlassFish V3
GlassFish V3 正在运行。
增量部署WebApplication6
完成WebApplication6的增量分发
增量重新部署 WebApplication6
redeploy?name=WebApplication6&properties=keepSessions=true 在 GlassFish V3 上运行
redeploy?name=WebApplication6&properties=keepSessions=true 在 GlassFish V3 上完成
运行部署：
浏览：http://localhost:8080/WebApplication6/
运行显示浏览器：
跑：
构建成功（总时间：41 秒）

```

和

```
信息：在 Apache Felix OSGi 平台上启动 GlassFish
欢迎来到菲利克斯。
==================
信息：开始捆绑 org.glassfish.common.glassfish-mbeanserver [7]
信息：开始捆绑 org.glassfish.core.kernel [103]
信息：开始捆绑 org.glassfish.common.common-util [84]
信息：开始捆绑 GlassFish-Application-Common-Module [68]
信息：APIClassLoader = Bundle [GlassFish-Application-Common-Module [68] ] 的类加载器
信息：注册服务 = org.apache.felix.framework.StartLevelImpl@676437，合同 = org.osgi.service.startlevel.StartLevel，名称 = null
信息：注册服务 = org.apache.felix.framework.PackageAdminImpl@1e808ca，合同 = org.osgi.service.packageadmin.PackageAdmin，名称 = null
信息：开始捆绑 org.glassfish.branding.branding [31]
未找到版本的资源包，使用默认 GlassFish 版本
信息：[Thread[GlassFish Kernel Main Thread,5,main]] 已启动
信息：开始捆绑 org.glassfish.common.internal-api [88]
信息：开始捆绑 org.glassfish.admin.config-api [76]
信息：开始捆绑 org.glassfish.registration.glassfish-registration [98]
信息：开始捆绑 org.glassfish.deployment.deployment-autodeploy [61]
信息：开始捆绑 org.glassfish.deployment.deployment-common [94]
信息：开始捆绑 org.glassfish.flashlight.flashlight-framework [97]
信息：监听 8080 端口
信息：每个 domain.xml 禁用端口 8181 上的网络侦听器 http-listener-2
信息：监听端口 4848
信息：开始捆绑 org.glassfish.common.container-common [106]
信息：管理控制台已安装，但尚未加载。
信息：开始捆绑 org.glassfish.persistence.jpa-connector [65]
信息：开始捆绑 org.glassfish.webservices.jsr109-impl [70]
信息：开始捆绑 org.glassfish.scripting.gf-jruby-connector [60]
信息：开始捆绑 org.glassfish.web.gf-web-connector [121]
信息：开始捆绑 org.glassfish.security.security [63]
信息：security.secmgroff
信息：开始捆绑 org.glassfish.security.securitycommon [19]
INFO: 安全启动服务调用
信息：开始捆绑 org.glassfish.common.glassfish-naming [90]
信息：开始捆绑 org.glassfish.security.realms [74]
信息：开始捆绑 org.glassfish.common.glassfish-api [107]
信息：开始捆绑 org.glassfish.connectors.connectors-runtime [23]
信息：安全服务已成功启动......
信息：注册服务 = org.glassfish.web.DirContextURLStreamHandlerService@12d26d2，合同 = org.osgi.service.url.URLStreamHandlerService，名称 = null
信息：开始捆绑 org.glassfish.web.web-glue [113]
信息：开始捆绑 org.glassfish.transaction.jta [57]
信息：已启动 JMXConnector，JMXService URL = service:jmx:rmi:///jndi/rmi://RANDYS-LAPTOP:8686/jmxrmi
信息：在端口 8080 上创建了 HTTP 侦听器 http-listener-1
信息：在端口 4848 上创建了 HTTP 侦听器管理员侦听器
信息：创建的虚拟服务器服务器
信息：已创建虚拟服务器 __asadmin
信息：开始捆绑 org.glassfish.deployment.dol [8]
信息：开始捆绑 org.glassfish.web.web-core [130]
信息：jndi 流处理程序的双重注册：工厂已定义
信息：未知加载程序 113.0 类 org.apache.felix.framework.searchpolicy.ContentClassLoader
信息：开始捆绑 org.glassfish.web.jstl-connector [119]
信息：开始捆绑 org.glassfish.web.jsf-connector [126]
信息：使用 com.sun.enterprise.transaction.JavaEETransactionManagerSimplifiedDelegate 作为委托
信息：开始捆绑 org.glassfish.connectors.work-management [37]
信息：开始捆绑 org.glassfish.common.glassfish-ee-api [50]
信息：开始捆绑 org.glassfish.connectors.connectors-internal-api [111]
信息：在端口 8080 上创建了 HTTP 侦听器 http-listener-1
信息：在端口 4848 上创建了 HTTP 侦听器管理员侦听器
信息：创建的虚拟服务器服务器
信息：已创建虚拟服务器 __asadmin
信息：未知加载程序 113.0 类 org.apache.felix.framework.searchpolicy.ContentClassLoader
信息：policy.loading
信息：开始捆绑 org.glassfish.web.war-util [122]
警告：注释处理错误：java.lang.NoClassDefFoundError: javax/jms/MessageListener
警告：注释处理错误：java.lang.NoClassDefFoundError: javax/jms/MessageListener
信息：开始捆绑 org.glassfish.security.websecurity [115]
信息：未知加载器 org.glassfish.internal.api.DelegatingClassLoader@1e14a78 类 org.glassfish.internal.api.DelegatingClassLoader
信息：在 /WebApplication6 加载应用程序 WebApplication6
信息：未知加载器 org.glassfish.internal.api.DelegatingClassLoader@1e14a78 类 org.glassfish.internal.api.DelegatingClassLoader
信息：在 /WebApplication6 加载应用程序 WebApplication6
信息：加载 WebApplication6 应用程序完成时间为 10032 毫秒
INFO：GlassFish v3 Prelude 启动时间：Felix(7062ms) 启动服务(13173ms) 总计(20235ms)
信息：classLoader = WebappClassLoader
  代表：真
  存储库：
    WEB-INF/类/
----------> 父类加载器：
org.glassfish.internal.api.DelegatingClassLoader@1e14a78
信息：SharedSecrets.getJavaNetAccess()=java.net.URLClassLoader$7@1ba5016
警告：注释处理错误：java.lang.NoClassDefFoundError: javax/jms/MessageListener
警告：注释处理错误：java.lang.NoClassDefFoundError: javax/jms/MessageListener
信息：未知加载器 org.glassfish.internal.api.DelegatingClassLoader@1e14a78 类 org.glassfish.internal.api.DelegatingClassLoader
信息：在 /WebApplication6 加载应用程序 WebApplication6
信息：未知加载器 org.glassfish.internal.api.DelegatingClassLoader@1e14a78 类 org.glassfish.internal.api.DelegatingClassLoader
信息：在 /WebApplication6 加载应用程序 WebApplication6
信息：WebApplication6 的部署完成时间为 3156 毫秒
信息：服务器关闭已启动
信息：classLoader = WebappClassLoader
  代表：真
  存储库：
    WEB-INF/类/
----------> 父类加载器：
org.glassfish.internal.api.DelegatingClassLoader@1e14a78
信息：SharedSecrets.getJavaNetAccess()=java.net.URLClassLoader$7@1ba5016
严重：PWC3983：Coyote 连接器尚未启动
严重：PWC3983：Coyote 连接器尚未启动
信息：PWC1240：容器 WebModule[] 尚未启动
信息：[线程[GlassFish 内核主线程，5，主]] 退出
信息：停止捆绑 = org.glassfish.common.common-util [84]
信息：停止捆绑 = org.glassfish.registration.glassfish-registration [98]
信息：停止捆绑 = org.glassfish.security.websecurity [115]
信息：停止捆绑 = org.glassfish.web.web-core [130]
信息：停止捆绑 = org.glassfish.deployment.dol [8]
信息：停止捆绑 = org.glassfish.security.securitycommon [19]
信息：停止捆绑 = org.glassfish.persistence.jpa-connector [65]
信息：停止捆绑 = org.glassfish.security.realms [74]
信息：停止捆绑 = org.glassfish.webservices.jsr109-impl [70]
信息：停止捆绑 = org.glassfish.web.war-util [122]
信息：停止捆绑 = org.glassfish.common.container-common [106]
信息：停止捆绑 = org.glassfish.web.jstl-connector [119]
信息：停止捆绑 = org.glassfish.common.glassfish-api [107]
信息：停止捆绑 = org.glassfish.connectors.connectors-internal-api [111]
信息：停止捆绑 = org.glassfish.web.jsf-connector [126]
信息：停止捆绑 = org.glassfish.admin.config-api [76]
信息：停止捆绑 = org.glassfish.scripting.gf-jruby-connector [60]
信息：停止捆绑 = GlassFish-Application-Common-Module [68]
信息：停止捆绑 = org.glassfish.connectors.connectors-runtime [23]
信息：停止捆绑 = org.glassfish.common.glassfish-ee-api [50]
信息：停止捆绑 = org.glassfish.common.glassfish-naming [90]
信息：停止捆绑 = org.glassfish.branding.branding [31]
信息：删除服务 = org.glassfish.web.DirContextURLStreamHandlerService@12d26d2，合同 = org.osgi.service.url.URLStreamHandlerService
信息：停止捆绑 = org.glassfish.web.web-glue [113]
信息：停止捆绑 = org.glassfish.deployment.deployment-common [94]
信息：停止捆绑 = org.glassfish.common.glassfish-mbeanserver [7]
信息：停止捆绑 = org.glassfish.web.gf-web-connector [121]
信息：停止捆绑 = org.glassfish.common.internal-api [88]
信息：停止捆绑 = org.glassfish.deployment.deployment-autodeploy [61]
信息：停止捆绑 = org.glassfish.connectors.work-management [37]
信息：停止捆绑 = org.glassfish.flashlight.flashlight-framework [97]
信息：停止捆绑 = org.glassfish.security.security [63]
信息：停止捆绑 = org.glassfish.transaction.jta [57]
信息：停止捆绑 = org.glassfish.core.kernel [103]
信息：停止捆绑 = com.sun.enterprise.osgi-adapter [6]
信息：在 Apache Felix OSGi 平台上启动 GlassFish
欢迎来到菲利克斯。
==================
信息：开始捆绑 org.glassfish.common.glassfish-mbeanserver [7]
信息：开始捆绑 org.glassfish.core.kernel [103]
信息：开始捆绑 org.glassfish.common.common-util [84]
信息：开始捆绑 GlassFish-Application-Common-Module [68]
信息：APIClassLoader = Bundle [GlassFish-Application-Common-Module [68] ] 的类加载器
信息：注册服务 = org.apache.felix.framework.StartLevelImpl@1982fc1，合同 = org.osgi.service.startlevel.StartLevel，名称 = null
信息：注册服务 = org.apache.felix.framework.PackageAdminImpl@1e4853f，合同 = org.osgi.service.packageadmin.PackageAdmin，名称 = null
未找到版本的资源包，使用默认 GlassFish 版本
信息：开始捆绑 org.glassfish.branding.branding [31]
信息：[Thread[GlassFish Kernel Main Thread,5,main]] 已启动
信息：开始捆绑 org.glassfish.common.internal-api [88]
信息：开始捆绑 org.glassfish.admin.config-api [76]
信息：开始捆绑 org.glassfish.registration.glassfish-registration [98]
信息：开始捆绑 org.glassfish.deployment.deployment-autodeploy [61]
信息：开始捆绑 org.glassfish.deployment.deployment-common [94]
信息：开始捆绑 org.glassfish.flashlight.flashlight-framework [97]
信息：监听 8080 端口
信息：每个 domain.xml 禁用端口 8181 上的网络侦听器 http-listener-2
信息：监听端口 4848
信息：开始捆绑 org.glassfish.common.container-common [106]
信息：管理控制台已安装，但尚未加载。
信息：开始捆绑 org.glassfish.persistence.jpa-connector [65]
信息：开始捆绑 org.glassfish.webservices.jsr109-impl [70]
信息：开始捆绑 org.glassfish.scripting.gf-jruby-connector [60]
信息：开始捆绑 org.glassfish.web.gf-web-connector [121]
信息：开始捆绑 org.glassfish.security.security [63]
信息：开始捆绑 org.glassfish.common.glassfish-naming [90]
信息：开始捆绑 org.glassfish.common.glassfish-api [107]
信息：security.secmgroff
信息：开始捆绑 org.glassfish.connectors.connectors-runtime [23]
信息：开始捆绑 org.glassfish.security.securitycommon [19]
信息：开始捆绑 org.glassfish.transaction.jta [57]
INFO: 安全启动服务调用
信息：开始捆绑 org.glassfish.security.realms [74]
信息：已启动 JMXConnector，JMXService URL = service:jmx:rmi:///jndi/rmi://RANDYS-LAPTOP:8686/jmxrmi
信息：安全服务已成功启动......
信息：注册服务 = org.glassfish.web.DirContextURLStreamHandlerService@162f030，合同 = org.osgi.service.url.URLStreamHandlerService，名称 = null
信息：开始捆绑 org.glassfish.web.web-glue [113]
信息：在端口 8080 上创建了 HTTP 侦听器 http-listener-1
信息：在端口 4848 上创建了 HTTP 侦听器管理员侦听器
信息：创建的虚拟服务器服务器
信息：已创建虚拟服务器 __asadmin
信息：开始捆绑 org.glassfish.deployment.dol [8]
信息：开始捆绑 org.glassfish.web.web-core [130]
信息：jndi 流处理程序的双重注册：工厂已定义
信息：未知加载程序 113.0 类 org.apache.felix.framework.searchpolicy.ContentClassLoader
信息：开始捆绑 org.glassfish.web.jstl-connector [119]
信息：开始捆绑 org.glassfish.web.jsf-connector [126]
信息：使用 com.sun.enterprise.transaction.JavaEETransactionManagerSimplifiedDelegate 作为委托
信息：开始捆绑 org.glassfish.connectors.work-management [37]
信息：开始捆绑 org.glassfish.common.glassfish-ee-api [50]
信息：开始捆绑 org.glassfish.connectors.connectors-internal-api [111]
信息：在端口 8080 上创建了 HTTP 侦听器 http-listener-1
信息：在端口 4848 上创建了 HTTP 侦听器管理员侦听器
信息：创建的虚拟服务器服务器
信息：已创建虚拟服务器 __asadmin
信息：未知加载程序 113.0 类 org.apache.felix.framework.searchpolicy.ContentClassLoader
信息：policy.loading
信息：开始捆绑 org.glassfish.web.war-util [122]
警告：注释处理错误：java.lang.NoClassDefFoundError: javax/jms/MessageListener
警告：注释处理错误：java.lang.NoClassDefFoundError: javax/jms/MessageListener
信息：开始捆绑 org.glassfish.security.websecurity [115]
信息：未知加载器 org.glassfish.internal.api.DelegatingClassLoader@1bb35b 类 org.glassfish.internal.api.DelegatingClassLoader
信息：在 /WebApplication6 加载应用程序 WebApplication6
信息：未知加载器 org.glassfish.internal.api.DelegatingClassLoader@1bb35b 类 org.glassfish.internal.api.DelegatingClassLoader
信息：在 /WebApplication6 加载应用程序 WebApplication6
信息：加载 WebApplication6 应用程序完成时间为 10359 毫秒
INFO：GlassFish v3 Prelude 启动时间：Felix(4500ms) 启动服务(13328ms) 总计(17828ms)
信息：classLoader = WebappClassLoader
  代表：真
  存储库：
    WEB-INF/类/
----------> 父类加载器：
org.glassfish.internal.api.DelegatingClassLoader@1bb35b
信息：SharedSecrets.getJavaNetAccess()=java.net.URLClassLoader$7@ef9d00
警告：注释处理错误：java.lang.NoClassDefFoundError: javax/jms/MessageListener
警告：注释处理错误：java.lang.NoClassDefFoundError: javax/jms/MessageListener
信息：未知加载器 org.glassfish.internal.api.DelegatingClassLoader@1bb35b 类 org.glassfish.internal.api.DelegatingClassLoader
信息：在 /WebApplication6 加载应用程序 WebApplication6
信息：未知加载器 org.glassfish.internal.api.DelegatingClassLoader@1bb35b 类 org.glassfish.internal.api.DelegatingClassLoader
信息：在 /WebApplication6 加载应用程序 WebApplication6
信息：WebApplication6 的部署完成时间为 3360 毫秒

```

我看到几个：

```
警告：注释处理错误：java.lang.NoClassDefFoundError: javax/jms/MessageListener

```

我没有明确使用 java 消息传递。任何想法为什么 WS 没有部署？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T20:23:08.390

使用 ProcessExplorer，我发现一堆 java.exe 正在使用以下命令行运行：

```
"C:\Program Files\Java\jdk1.6.0_14\jre\bin\java" "-Djruby.home=C:\Program Files\NetBeans 6.5.1\ruby2\jruby-1.1.4" -Djdbc.drivers= org.apache.derby.jdbc.ClientDriver "-Djavax.net.ssl.trustStore=C:\Program Files\glassfish-v3-prelude\glassfish\domains\domain1/config/cacerts.jks" "-Djavax.net.ssl .keyStore=C:\Program Files\glassfish-v3-prelude\glassfish\domains\domain1/config/keystore.jks" "-Djava.security.policy=C:\Program Files\glassfish-v3-prelude\glassfish\domains \domain1/config/server.policy" -Dcom.sun.enterprise.config.config_environment_factory_class=com.sun.enterprise.config.serverbeans.AppserverConfigEnvironmentFactory "-Djava.security.auth.login.config=C:\Program Files\glassfish -v3-prelude\glassfish\domains\domain1/config/login.conf" "-Djava.endorsed.dirs=C:\Program Files\glassfish-v3-prelude\glassfish/lib/endorsed" "-Djava.ext.dirs=C:\Program Files\Java\jdk1.6.0_14\jre/lib/ext;C:\Program Files\Java \jdk1.6.0_14\jre/jre/lib/ext;C:\Program Files\glassfish-v3-prelude\glassfish\domains\domain1/lib/ext;C:\Program Files\glassfish-v3-prelude\javadb/ lib" -XX:+UnlockDiagnosticVMOptions -XX:+LogVMOutput "-XX:LogFile=C:\Program Files\glassfish-v3-prelude\glassfish\domains\domain1/logs/jvm.log" -Xmx512m -XX:NewRatio=2 -Xdebug -Xrunjdwp:transport=dt_socket,address=3251,server=y,suspend=n -client -jar "C:\Program Files\glassfish-v3-prelude\glassfish\modules\glassfish.jar" --domain domain1 - -domaindir "C:\Program Files\glassfish-v3-prelude\glassfish\domains\domain1"0_14\jre/lib/ext;C:\Program Files\Java\jdk1.6.0_14\jre/jre/lib/ext;C:\Program Files\glassfish-v3-prelude\glassfish\domains\domain1/lib/ext ;C:\Program Files\glassfish-v3-prelude\javadb/lib" -XX:+UnlockDiagnosticVMOptions -XX:+LogVMOutput "-XX:LogFile=C:\Program Files\glassfish-v3-prelude\glassfish\domains\domain1 /logs/jvm.log" -Xmx512m -XX:NewRatio=2 -Xdebug -Xrunjdwp:transport=dt_socket,address=3251,server=y,suspend=n -client -jar "C:\Program Files\glassfish-v3- prelude\glassfish\modules\glassfish.jar" --domain domain1 --domaindir "C:\Program Files\glassfish-v3-prelude\glassfish\domains\domain1"0_14\jre/lib/ext;C:\Program Files\Java\jdk1.6.0_14\jre/jre/lib/ext;C:\Program Files\glassfish-v3-prelude\glassfish\domains\domain1/lib/ext ;C:\Program Files\glassfish-v3-prelude\javadb/lib" -XX:+UnlockDiagnosticVMOptions -XX:+LogVMOutput "-XX:LogFile=C:\Program Files\glassfish-v3-prelude\glassfish\domains\domain1 /logs/jvm.log" -Xmx512m -XX:NewRatio=2 -Xdebug -Xrunjdwp:transport=dt_socket,address=3251,server=y,suspend=n -client -jar "C:\Program Files\glassfish-v3- prelude\glassfish\modules\glassfish.jar" --domain domain1 --domaindir "C:\Program Files\glassfish-v3-prelude\glassfish\domains\domain1"+LogVMOutput "-XX:LogFile=C:\Program Files\glassfish-v3-prelude\glassfish\domains\domain1/logs/jvm.log" -Xmx512m -XX:NewRatio=2 -Xdebug -Xrunjdwp:transport=dt_socket,address =3251,server=y,suspend=n -client -jar "C:\Program Files\glassfish-v3-prelude\glassfish\modules\glassfish.jar" --domain domain1 --domaindir "C:\Program Files\glassfish -v3-prelude\glassfish\domains\domain1"+LogVMOutput "-XX:LogFile=C:\Program Files\glassfish-v3-prelude\glassfish\domains\domain1/logs/jvm.log" -Xmx512m -XX:NewRatio=2 -Xdebug -Xrunjdwp:transport=dt_socket,address =3251,server=y,suspend=n -client -jar "C:\Program Files\glassfish-v3-prelude\glassfish\modules\glassfish.jar" --domain domain1 --domaindir "C:\Program Files\glassfish -v3-prelude\glassfish\domains\domain1"

```

当我重新启动时，NetBeans 似乎没有关闭它们。除了强行杀死 .exe 之外，NetBeans 是否有一个功能可以在我构建时杀死旧的？

# jquery - 在jQuery中使用单个表达式选择兄弟姐妹的孩子

> ID：1019702
> 
> 赞同：4
> 
> 时间：2009-06-19T19:33:25.667
> 
> 标签：jquery

是否可以使用类似于此的单个表达式在 jQuery 中选择当前上下文的兄弟姐妹的孩子？

```
$('~ div > span', this) 
```

不幸的是，这对我不起作用，所以我不相信 jQuery 在表达式中支持这种类型的链接。但是，我能够使以下方法起作用：

```
$('> span', $('~ div', this))

$(this).siblings('div').children('span') 
```

我正在寻找一种方法来使用以下 API 调用获取兄弟姐妹的孩子，或者解释为什么它不可能：

```
jQuery( expression, context ) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-10-11T17:04:19.203

我知道这有点旧，但我想我会回答以防其他人试图这样做。[find()](http://api.jquery.com/find/)是最好的方法

```
$(this).siblings('div').find('span'); 
```

希望有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T19:52:17.673

你可以试试`$(this + "+div>span");`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T19:38:04.440

尝试使用`$(this).next('div').children('span')`

[http://docs.jquery.com/Traversing/next](http://docs.jquery.com/Traversing/next)

# python - Linux 中的沙盒

> ID：1019707
> 
> 赞同：16
> 
> 时间：2009-06-19T19:35:07.567
> 
> 标签：python, c, linux, security, sandbox

我想创建一个 Web 应用程序，它允许用户上传一些 C 代码，并查看其执行结果（代码将在服务器上编译）。用户不受信任，这显然会带来一些巨大的安全隐患。

所以我需要为应用程序创建某种沙箱。在最基本的层面上，我想将对文件系统的访问限制为某些指定的目录。我不能直接使用 chroot 监狱，因为 Web 应用程序没有以特权用户身份运行。我猜想设置监狱的 suid 可执行文件将是一种选择。

上传的程序会很小，所以它们应该执行得很快（最多几秒钟）。因此，我可以在预设超时后终止该进程，但如何确保它不会产生新进程？或者如果我不能，杀死整个 pgid 是一种可靠的方法吗？

除了“根本不这样做”之外，最好的解决方法是什么？:) 我错过了哪些其他明显的安全问题？

FWIW，网络应用程序将用 Python 编写。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T22:12:13.583

与其他建议一起，您可能会发现这很有用。

[http://www.eelis.net/geordi/](http://www.eelis.net/geordi/)

这是来自[http://codepad.org/about](http://codepad.org/about)，[codepad.org](http://codepad.org)的关于页面。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-19T21:24:28.407

您提供的一些细节暗示您对服务器本身具有管理控制权，所以我的建议是做出这个假设。

我会将其作为批处理系统来处理。Web 服务器接受源文件的上传，进程轮询提交目录，处理文件，然后将结果提交到 Web 应用程序轮询的另一个目录，直到找到结果并显示它。

有趣的部分是如何安全地处理执行。

我选择的操作系统是 FreeBSD，所以我设置了一个预配置的监狱（不要与普通的 chroot 监狱混淆），它可以编译、运行和保存输出。然后，对于每个源文件提交，为每次执行启动一个原始的 jail 副本，其中包含源文件的副本。

如果监狱的 /dev 被修剪到几乎没有，系统资源限制被安全设置，并且流量不能路由出监狱（绑定到不可路由的地址或只是防火墙），我个人会很乐意在上面运行我照顾的服务器。

由于您使用 Linux，我将研究用户模式 ​​Linux 或 Linux-VServer，它们在概念上与 FreeBSD 监狱非常相似（我自己从未使用过它们，但已经阅读过它们）。[这里](http://en.wikipedia.org/wiki/Operating_system-level_virtualization)列出了其他几个这样的系统。

这种方法比普通的 chroot 监狱要安全得多，而且比使用 qemu/kvm 或 VMware 等完全虚拟化要轻得多。

我不是程序员，所以我不知道你可以使用什么样的 AJAX-y 东西来轮询结果，但我相信它可以完成。作为管理员，我会发现这是一个有趣的项目。玩得开心。:)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-19T19:40:48.490

我想说这在很多层面上都非常危险。您实际上是在向您的系统上可以找到的任何漏洞利用敞开心扉（而您通常仅限于人们可以远程利用的漏洞）。如果可以避免，我会说不要这样做。

如果您确实想这样做，您可能需要使用某种虚拟机来运行用户的代码。[使用KVM](http://www.linux-kvm.org)之类的东西，可以使用相同的基本映像设置多个虚拟机（您甚至可以将快照存储在已启动的状态，尽管我不确定它将如何处理被克隆）。然后，您可以按需创建 VM，运行用户的代码，返回结果，然后终止 VM。如果您将虚拟机彼此隔离并与网络隔离，则用户可以造成他们想要的任何破坏，并且不会损害您的物理服务器。在这些情况下，您面临的唯一危险是某种允许它们从 VM 中逃脱的漏洞……这些极为罕见，并且随着硬件虚拟化的改进将更加罕见。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-19T21:00:31.980

尽管它仍处于开发阶段，并且尚未被认为是安全的，但您可以查看[Google Native Client](http://code.google.com/p/nativeclient/)背后的技术。它旨在允许不受信任的本机代码在 Web 浏览器中运行，但可能适用于在 Web 服务器上使用。您可以在其他技术（例如虚拟机）之上使用类似的东西，以提高安全性。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-19T21:01:57.267

在[Fedora 11](http://fedoraproject.org/)上，有一个[SELinux 沙盒](http://danwalsh.livejournal.com/28545.html)，它似乎完全可以满足您的需求（除了可能限制生成新进程；链接的博客文章没有提到这一点）。

当然，总是存在内核错误的风险；即使使用 SELinux，部分内核仍然暴露给所有进程。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-19T22:17:47.893

请参阅[此页面，了解 Google Chrome 的 Linux 沙盒方法](http://code.google.com/p/chromium/wiki/LinuxSandboxing)。正如你所看到的，有很多方法，但它们都不适用于像 Chrome 这样的可分发应用程序，因为某些发行版可能不包含它们。不过，这对于 Web 应用程序来说并不是真正的问题，因为您可以控制服务器上安装的内容。

就个人而言，我最喜欢的是[Seccomp](http://en.wikipedia.org/wiki/Seccomp)，因为与 ptrace （在*每个*系统调用上切换地址空间！）或 KVM （需要大量内存的虚拟机）等其他工具相比，它的开销*非常*低，而且与 SELinux 等工具相比，它非常简单（因此更有可能是安全的）。

 ** * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-07-25T20:26:19.683

我猜[libsandbox](https://openjudge.net/~liuyu/Project/LibSandbox)符合您的目的。它的核心库是为 C/C++ 编写的，但它也有一个 Python 程序的包装器。它提供了选项来自定义可以允许哪些系统调用、可以使用多少内存、可以运行来宾程序多长时间等。它已经在一些在线评委中使用，例如[HOJ](http://acm.hit.edu.cn/judge/)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-19T19:39:42.470

有一个名为[strace](http://sourceforge.net/projects/strace/)的工具——它监视给定进程的系统调用。您只需要注意暗示“非法”功能访问的特定调用。AFAIK，这是编程比赛中用于沙盒参赛者程序的方法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-22T20:45:42.310

我认为您的解决方案必须专注于分析源代码。`C`我不知道任何工具，而且我认为这`Pascal`对 .

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-03-25T06:42:47.383

在 KVM 或 qemu 下生成一个新的 VM 来编译和运行代码看起来像是要走的路。在 jail/LXC 下运行代码可能会破坏机器，如果它利用操作系统的不安全部分（如网络代码）。在虚拟机下运行的优势是显而易见的。一个人只能破解虚拟机，但不能破解机器本身。但副作用是您需要大量资源（CPU 和内存）来为每个请求生成一个 VM。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-04-17T02:27:37.467

不受信任程序的基于 ptrace 的限制可以像 [http://www.cs.vu.nl/~rutger/publications/jailer.pdf](http://www.cs.vu.nl/~rutger/publications/jailer.pdf)，[http://www.cs.vu.nl/~guido中描述的那样使用/mansion/publications/ps/secrypt07.pdf](http://www.cs.vu.nl/~guido/mansion/publications/ps/secrypt07.pdf)。

他们有一个改变根的策略规则，CHRDIR，它的效果类似于 chroot。（“监禁政策”一节）

但是，他们可能还没有发布他们的源代码（部分基于修改后的 strace [http://www.liacs.nl/~wichert/strace/](http://www.liacs.nl/~wichert/strace/) - “实施”部分）......

另请参阅其他可用的基于 ptrace 的 chroot-in-userpace 方法：[https ://unix.stackexchange.com/a/72697/4319](https://unix.stackexchange.com/a/72697/4319)

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2009-06-19T20:53:23.913

您唯一的机会是运行 VirtualMachine，而那些可能存在漏洞。如果您希望您的机器在短期内被黑客入侵，只需使用权限并设置一个可以访问一个目录的特殊用户。如果您想将黑客攻击推迟到将来的某个时间点，请在虚拟机中运行一个网络服务器并将端口转发到该虚拟机。你会想要保留它的备份，因为你可能会在一个小时内被黑客入侵，并且想要每隔几个小时重新启动一个新副本。您还需要保留整台机器的映像，以便每周左右重新映像一次，以克服每周的黑客攻击。不要让那台机器与网络上的任何其他机器通信。到处都是黑名单。我说的是虚拟机和物理机IP地址。对网络上其他机器上的任何其他机器进行定期安全审计。请重命名机器 IHaveBeenHacked1 和 IHaveBeenHacked2 并阻止访问您的主机列表和防火墙中的机器。

这样你可能会暂时避免你的黑客攻击水平。*

# sql - MS Excel 2007 中的 SQL 联合

> ID：1019711
> 
> 赞同：0
> 
> 时间：2009-06-19T19:35:54.820
> 
> 标签：sql, excel, union

我有许多 CSV 数据文件，我想将它们合并到 MS Excel 中的一个表中。所有 CSV 文件都具有相同的名称和列数。

在像 Access 或 SQL 这样的关系数据库中，我可以使用联合查询，但这必须在 Excel 中。如何在 Excel 中快速将所有这些文件合并为一个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T19:39:59.273

您可以在 VBA 中编写一个宏来处理此操作。

只需将 CSV 文件导入临时工作表，然后将其剪切并粘贴到最后一个最终工作表值下方的位置，然后删除新导入的临时工作表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T19:53:09.653

使用以下文本创建批处理文件

`@echo off
for %%1 in (*.csv) do findstr /v "a,b,c" %%1`

这里的“a,b,c”是列标题。

创建批处理文件后（假设批处理文件的名称是 test.bat），您可以在命令提示符下运行以下命令。

`test.bat > combined.txt`

这将运行批处理文件并将输出通过管道传输到新文件（combined.txt）。
您必须打开 combine.txt 文件并将标题（“a,b,c”）粘贴到顶部。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T19:53:39.463

您可以尝试一个简单的 DOS 命令：

复制 file1.csv + file2.csv newfile.csv

# c - 对这个 Y86 汇编代码的内存位置感到困惑

> ID：1019716
> 
> 赞同：3
> 
> 时间：2009-06-19T19:38:29.230
> 
> 标签：c, assembly, y86

我们在一个班级中有一段 C 代码，我们需要将其转换为 Y86，这是由某个人写在黑板上的，当然还有老师的更正。

但是，我混淆了代码初始部分的内存位置和 .pos 指令：

```
int array[100], sum, i;

int main() {
    sum = 0;

    for(i = 0; i < 100; i++) {
        array[i] = i;
        sum += array[i];
    }
}

.pos 0
    irmovl Stack, %esp
    rrmovl %esp, %ebp
    jmp main
array:
.pos 430

sum: .long 0
i: .long 0

main:
  // (rest of the code that doesn't really matter here) 
```

**我从这段代码中了解到的是：**
它从位置 0 ( **.pos 0** ) 开始，**irmovl**指令占用 6 个字节，因此，下**一条 rrmovl**指令从位置 6 开始，该指令占用 2 个字节，我们现在位于位置 8 .

**jmp**指令从8 开始占用 5 个字节，我们现在在位置 13。

现在可以节省堆栈空间来保存**数组**的 100 个整数，为此我们使用 .pos 430 来保存至少 400 个字节（4 个字节 * 100 个整数）和 17 个以上（下一个位置减去当前位置，430 -13=17)。

我们现在在位置 430，我们需要再保存 4 个字节来保存**sum**和另外 4 个字节来保存**i**，它放在位置 438。

在位置 438 是我们程序的主要代码将开始的地方。

**我想我做对了，我唯一的问题很简单：**
为什么我们使用**.pos 430**来为 100 个整数保留空间？我们应该只需要正好 400 个字节来保存所有这些。难道**.pos 413 （因为之前的位置是 13 并且我们需要 400 个字节来存放 100 个整数，因此是 413）是否比****.pos 430**足够且更正确？

我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T19:57:13.200

我不认为 pos 增加了职位。这是一个将代码放在那里的指令。

所以“数组”从位置 13 开始，“总和”从 430 开始。这使得 main 从 438 开始，而数组只剩下 417。

留出一点空间以便以后进行更改总是一个好主意。如果您以后想要增加数组或添加另一条指令，则必须在整个代码中调整 pos 指令。如果访问数组时出错，它还可以避免 sum 被破坏。填充到 430 更具防御性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T19:52:10.777

首先让我说我不是 Y86 的专家。然而，我已经编写了大量的汇编代码。

您可能是正确的，这`.pos 413`将是准确的（并且是正确的）。我想学生或老师只是为了给指令腾出空间而留下“一堆空间”，`irmovl ... jump`以避免像你所做的那样准确计算需要多少空间。

你的思考方式是正确的，它表明你的导师对材料的理解应该感到高兴。

# hibernate - Hibernate Annotation Join 表问题

> ID：1019721
> 
> 赞同：4
> 
> 时间：2009-06-19T19:39:43.750
> 
> 标签：hibernate

当使用休眠注释进行连接表时，如何添加一个不是连接列的额外列，比如，说作为一个弱实体结婚？像一个额外的专栏？

```
@ManyToMany(targetEntity=some.class,
        cascade ={CascadeType.PERSIST, CascadeType.MERGE}, fetch=FetchType.EAGER)
@JoinTable(name = "RELATION", joinColumns ={
        @JoinColumn(name = "HID", unique = true)
    }, inverseJoinColumns = {
        @JoinColumn(name = "FID")
})
Set<PERSON> PEOPLE = new HashSet<PERSON>(); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-20T20:23:59.897

第三列在技术上使该表成为实体，而不是“可连接的”。所以表本身需要是一个实体。从 SQL 的角度考虑它。当连接表不仅包含将其他两个表连接在一起所需的信息时，连接表是否只是一个连接表？

同样作为仅供参考，这种情况在“Java Persistence (JPA) with Hibernate”的第 7 章中进行了介绍：

> 您可以使用两种常用策略将这种结构映射到 Java 类。第一种策略需要一个用于连接表的中间实体类，并使用一对多关联进行映射。第二种策略利用了一个组件集合，以及一个用于连接表的值类型类。

# iphone - iPhone 在运行时创建 SQLite 数据库？

> ID：1019723
> 
> 赞同：11
> 
> 时间：2009-06-19T19:39:55.653
> 
> 标签：iphone, cocoa-touch, sqlite

我发现的大多数 sqlite 示例都是先从命令行创建一个 db 文件，然后将其添加到您的应用程序中。对于我的项目，我希望能够在应用程序第一次启动时在应用程序中创建我的数据库，然后将其保存到用户沙箱中的 db 文件中。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-19T19:48:09.117

您可以在应用程序启动时检查文件（像往常一样）。如果文件不存在，而不是复制预先创建的文件，只需：

1.  像往常一样使用打开文件`sqlite3_open()`
2.  运行您的创建命令（即，创建您的表、视图等）

这就是它的全部。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-20T03:31:30.193

我想我会呼应不断扩大的呼声，如果你想用数据库做任何事情，你应该看看 CoreData。它在底层使用 SQLLite，设置起来*更*简单，以后当您发现数据库中需要一些新东西时，迁移起来也更简单！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-20T05:29:40.190

Core Data 提供了一种简单的方法来管理它——它会在启动时寻找一个数据库文件，如果不存在它会为你创建一个。它还将根据您可以在 xCode 中创建的图表自动为您创建模型。

当您将来使用旧数据库升级人员时，它还将简化数据迁移。

您也可以使用生成的 Data 对象访问数据。Core Data 还将对其创建的对象使用延迟加载，这比手动加载要好得多

有关更多信息，请参阅 Locations 演示项目并阅读文档中的 Core Data。

# c# - ASP.NET 角色和配置文件：查询与自定义配置文件属性匹配的用户集合的最佳方式？

> ID：1019725
> 
> 赞同：1
> 
> 时间：2009-06-19T19:40:06.387
> 
> 标签：c#, asp.net, asp.net-membership, roles, asp.net-profiles

ASP.NET 2.0 成员资格、角色和配置文件是猫的喵喵叫。角色 API 支持方便的方法，例如 GetAllUsersInRole("MyNewsletterSubscriber")，它将返回“MyNewsletterSubscriber”角色中的人员集合。

我想知道返回具有自定义 ASP.NET 配置文件属性的人员集合的最佳方式可能是什么。例如，我可能会创建一个名为 IsNewsletter1SubscriptionUserSelectionTextOnly 的自定义配置文件属性和另一个名为 IsNewsletter1UserSelectionMobileOptimized 的自定义配置文件属性。

那么，我怎样才能最有效地查询类似于 GetAllUsersWithCustomProfileProperty("IsNewsletter1SubscriptionUserSelectionTextOnly", true);

对于我所设想的用途，围绕 Profiles 的 API 似乎不发达——我认为 Scott Guthrie 在他在 Tech Ed 2006 的演讲中提到了一些即将开展的工作，但我不知道已经做了什么。

也可能是我试图不恰当地使用配置文件，最好将所有这些垃圾存储为直接角色。不知道。我喜欢使用角色或配置文件进行列表管理的想法，但我不知道管理它的最简洁方式。

想法，想法，答案？谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T19:53:37.077

好吧，查询配置文件（至少使用默认的 SQL 实现）是很可怕的，因为您实际上是在查询二进制序列化字段，因此每个查询都需要加载数据库中的每一行，反序列化所述二进制文件，然后检查答案。所以不要作弊，用 LINQ to Objects 或其他东西来做，你的 DBA 会开枪的。

无论如何，我的规则是，一旦您想查询个人资料，您最好实现一个可以以正常方式查询的自定义提供程序。通常这最终成为域模型的一部分。

# c# - 一个简单数据库的初学者问题

> ID：1019726
> 
> 赞同：1
> 
> 时间：2009-06-19T19:40:08.117
> 
> 标签：c#, database

我有一个 iPhone 应用程序，可以通过电子邮件将我的 GPS 坐标发送到电子邮件帐户。

我有一些代码（[here](https://stackoverflow.com/questions/1003678/error-using-cmail-dll/1003959#1003959)），用于在该帐户中搜索包含 GPS 坐标的电子邮件。

我想要一个 Windows 窗体应用程序，它允许我将电子邮件的日期、时间、纬度、经度和分辨率信息存储到某种基本数据库中，该数据库既可以是程序的一部分，也可以是程序附带的文件。

我可能可以使用[CSV](http://en.wikipedia.org/wiki/Comma-separated_values)文件，但我想以正确的方式做事，所以我会把它提交给更好的程序员。

存储此数据以供以后查询的最佳方法是什么？

一些想法是制作某个位置被占用的频率的热图。另一个想法是创建一个我以后可以使用的“面包屑”路径。

感谢您提供的任何建议。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T19:45:50.010

如果您不想要一个完整的数据库服务器，我建议您使用[SQLite](http://www.sqlite.org)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T19:48:05.653

您可以使用[SQLite](http://www.sqlite.org)并存储您获得的每个 GPS 定位的数据。然后，您可以使用普通 SQL 查询以您想要的任何方式组合和切片数据。SQLite 可以在 iPhone 应用程序以及 .net 语言中使用，因此您可以将数据直接存储到 iPhone 上的 SQLite 数据库中，而不是通过电子邮件发送数据然后搜索电子邮件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-19T20:03:26.760

您可能想查看使用 XML 文件。它不是数据库，但它肯定比使用 CSV 文件更结构化。

[使用LINQ To XML](http://msdn.microsoft.com/en-us/library/bb308960.aspx)从 .NET 应用程序访问 XML 很简单。

我认为 XML 的性能不如数据库，但对于少量数据，它可能并不重要。

您打算存储多少数据？

我不知道哪个更好（SQLite 或 XML），但我只是想放弃另一种选择。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-19T19:51:17.517

听起来您只需要一个数据库表。没什么特别的。

您将存储为 DateTime 对象的日期和时间。我会然后你可以质疑它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-19T20:05:19.847

SQL Server 嵌入式版本是另一种选择。

免费，将数据库放在一个文件中。

适用于移动应用程序，但许多 WinForm 应用程序在没有数据库服务器时将其用于本地存储。

# model-view-controller - 没有数据库后端的grails中的模型视图控制器？

> ID：1019728
> 
> 赞同：2
> 
> 时间：2009-06-19T19:41:18.663
> 
> 标签：model-view-controller, grails, frameworks

我对 MVC 没有任何经验，并且正在尝试使用 Grails 编写一个简单的 Web 应用程序。我发现的所有示例都假设您有一个数据库来作为您的域类的基础，并且有一个基于数据库的模型。我通过进行套接字通信的 API 获取数据，并且希望模型基于该数据。有没有使用 MVC 应用程序模型组件的数据库以外的源的示例？我更希望这些示例出现在 Grails 中，但我会起诉我可以获得的任何基于 Web 的示例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-20T10:37:11.357

检查[命令对象](http://grails.org/Command+objects+and+Form+Validation)。它们非常像域对象，因为您可以对它们进行验证等简洁的操作，但它们没有映射到任何数据库。

# .net - .NET 记录或查看 SOAP WebService 的调用/响应

> ID：1019730
> 
> 赞同：4
> 
> 时间：2009-06-19T19:42:35.913
> 
> 标签：.net, web-services, logging, soap, debugging

在 .NET 中检查来自 Web 服务的调用和响应的最佳方法是什么？
我正在与用 Perl 编写的 Web 服务交互并遇到问题。
如何捕获呼叫和响应的文本？

**更新：**
根据评论澄清：我想通过 .NET 进行操作，以便在出现问题时记录或通过电子邮件发送。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-19T20:08:36.907

您可以通过在 Web 服务客户端中创建`SoapExtension`并启用它来做到这一点：

> [System.Web.Services.Protocols.SoapExtension 类 (MSDN)](http://msdn.microsoft.com/en-us/library/system.web.services.protocols.soapextension.aspx)

上面的链接提供了将请求/响应记录到文件的示例代码框架。

要在您的应用程序中启用，请将以下内容添加到您的 web.config 或 app.config：

```
<webServices>
    <soapExtensionTypes>
        <add type="YourNamespace.TraceExtension, AssemblyName" 
             priority="0" group="High"/>
    </soapExtensionTypes>
</webServices> 
```

我自己的 SOAP 跟踪扩展在其自己的项目/程序集中实现。每当我需要调试请求/响应时，我只需将 DLL 放在应用程序文件夹（ASP.NET 的 /bin）中，然后像上面一样添加对配置文件的引用。

例如：

```
<webServices>
   <soapExtensionTypes>
      <add 
         type="DebugTools.SOAP.SOAPTrace.SoapTraceExtension, DebugTools.SOAP" 
         priority="0" group="High"/>
   </soapExtensionTypes>
</webServices> 
```

`DebugTools.SOAP.SOAPTrace`是的命名空间`SoapTraceExtension`
`DebugTools.SOAP`是包含肥皂跟踪代码的程序集的名称。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-19T19:45:43.193

[Fiddler](http://fiddler2.com/fiddler2/)是您在不稳定的 Web 服务世界中最好的朋友。

* * *

不，正如指出的那样，它在代码内部没有做任何事情。你也不希望它——调试不应该改变进程的语义，或者你正在调试你的调试代码。

另外，我很喜欢wireshark，但fiddler更适合HTTP的东西，因为它旨在专注于HTTP。如果我从网络上抓取字节，它一直是wireshark。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T19:54:17.857

就个人而言，我喜欢使用数据包嗅探器，例如[Wireshark](http://www.wireshark.org/)。它是检查任何类型的网络流量的好工具。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-20T14:30:46.487

在 WCF Web 服务或客户端中，您可以简单地配置跟踪和/或消息日志记录。这可以在运行时完成，无需更改代码。

# web-applications - 从头开始创建在线法官

> ID：1019731
> 
> 赞同：16
> 
> 时间：2009-06-19T19:42:57.690
> 
> 标签：web-applications

我参加了一些在线编程比赛，发现在线评委在功能上的使用非常出色。

言归正传，我所在的大学也即将举办在线编程大赛，由我负责。我正在评估我实施在线法官的选择。当然，我可以利用一些现有的评委，比如 SPOJ 的评委，但令我震惊的是，我和我的几个朋友也可以尝试建立一个评委。如果我们失败了，我们总是可以依靠这些。

那么任何人都可以给我一些关于我如何得到它的大纲或资源吗？如果我对评委如何实现“沙盒”有所了解，那也会很有帮助。我们手头大约有几个月的时间。

**更新**这是我在 2 周内就 SO 本身提出了更多问题后迄今为止努力的结果[http://github.com/anomit/loki](http://github.com/anomit/loki)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T20:17:00.993

我不确定什么是在线法官，但我认为它是一个评估程序正确性的软件。

我会为此使用一些构建、测试和分析库。例如[Ant](http://en.wikipedia.org/wiki/Apache_Ant)、[JUnit](http://en.wikipedia.org/wiki/JUnit)和[Checkstyle](http://en.wikipedia.org/wiki/Checkstyle)。

您将获取参与者提供的代码，并将其放入文件中。使用构建工具对其进行编译。

*   构建失败：0 分
*   构建成功并出现警告 1 分
*   构建成功，没有警告 2 分

然后运行一些测试，验证解决方案的正确性。

*   每通过一次测试：1分

最后运行一些代码分析工具来判断代码的质量。

*   对公用事业公司的每次投诉减 1 分

当然，您可能希望将点值转移到您的需要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T19:44:58.640

一个搜索词可能是 autograder。

例如：

> [http://www.users.muohio.edu/helmicmt/autograder/index.php](http://www.users.muohio.edu/helmicmt/autograder/index.php)
> [http://prisms.cs.umass.edu/mcorner/autograder](http://prisms.cs.umass.edu/mcorner/autograder)
> 
> [http://74.125.95.132/search?q=cache:VSuCE566d1oJ:www.cs.odu.edu/~gpd/msprojects/cpasupul.0/AutoGrader.ppt+autograder&cd=5&hl=en&ct=clnk&gl=us&client=firefox-a](http://74.125.95.132/search?q=cache:VSuCE566d1oJ:www.cs.odu.edu/~gpd/msprojects/cpasupul.0/AutoGrader.ppt+autograder&cd=5&hl=en&ct=clnk&gl=us&client=firefox-a)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-20T00:48:58.213

我真的不确定你的问题是关于什么的。从头开始为法官编写设计规范并不难。

您使用给定的输入数据运行一个东西，并将输出数据提供给问题作者编写的测试程序（因为并不总是有唯一的答案）。人们通过在干净的机器上远程运行沙盒来进行沙盒。

**添加**：请不要进行代码分析。您有两个选择，要么在比赛期间向参赛者提供此代码分析，要么不提供。

*   如果你这样做：他们会花最后 5 分钟的时间来确保没有下降点。代码在此过程中变得更糟。

*   如果你不这样做：你打破了“法治”：人们知道给予分数的机制（这也是为什么你总是在问题文本中给他们第一个测试）。

**更新：**对不起，我一开始没有注意到你问了一些具体的问题。沙盒可能没有你想象的那么重要——在一个好的竞争中，代码会公开，所以“黑客”会很尴尬。但是，我想我看到了一种实践，您不能直接与系统进行 i/o、文件系统或任何其他交互（它们`main()`为您编写，并且始终相同；您只编写具有给定输入/输出的算法部分流）。您的法官应该只运行它本身从源代码编译的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-09T18:46:21.120

看看[维基百科](http://en.wikipedia.org/wiki/Online_judge)。最后，它拥有丰富的资源。

# c# - 最喜欢的方式来创建一个新的 IEnumerable 来自单个值的序列？

> ID：1019737
> 
> 赞同：105
> 
> 时间：2009-06-19T19:46:00.633
> 
> 标签：c#, linq, c#-3.0

我通常使用数组语法从单个值创建一个序列，如下所示：

```
IEnumerable<string> sequence = new string[] { "abc" }; 
```

或使用新列表。我想听听是否有人有更富有表现力的方式来做同样的事情。

* * *

## 回答 #1

> 赞同：151
> 
> 时间：2009-06-19T19:50:11.843

您的示例不是一个空序列，它是一个包含一个元素的序列。要创建一个空的字符串序列，您可以这样做

```
var sequence = Enumerable.Empty<string>(); 
```

**EDIT** OP 澄清说他们希望创造一个单一的价值。在这种情况下

```
var sequence = Enumerable.Repeat("abc",1); 
```

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2009-06-20T04:40:10.300

我喜欢你的建议，但省略了数组类型：

```
var sequence = new[] { "abc" }; 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2013-02-17T12:13:16.430

甚至更短，

```
string[] single = { "abc" }; 
```

我会做一个扩展方法：

```
public static T[] Yield<T>(this T item)
{
    T[] single = { item };
    return single;
} 
```

甚至更好更短，只是

```
public static IEnumerable<T> Yield<T>(this T item)
{
    yield return item;
} 
```

也许这正是幕后`Enumerable.Repeat`所做的。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-08-18T06:47:59.867

或者只是创建一个方法

```
public static IEnumerable<T> CreateEnumerable<T>(params T[] items)
{
    if(items == null)
        yield break;

    foreach (T mitem in items)
        yield return mitem;
} 
```

或者

```
public static IEnumerable<T> CreateEnumerable<T>(params T[] items)
{
   return items ?? Enumerable.Empty<T>();
} 
```

用法 ：

```
IEnumerable<string> items = CreateEnumerable("single"); 
```

# python - 计算能力的速度（在python中）

> ID：1019740
> 
> 赞同：40
> 
> 时间：2009-06-19T19:46:44.330
> 
> 标签：python, algorithm, performance

我很好奇为什么它的倍增比在 python 中获得权力要快得多（尽管从我读过的内容来看，这在许多其他语言中也可能是正确的）。例如，这样做要快得多

```
x*x 
```

比

```
x**2 
```

我想 ** 运算符更通用，也可以处理分数幂。但如果这就是它慢得多的原因，为什么它不检查 int 指数然后只做乘法？

**编辑：**这是我尝试过的一些示例代码......

```
def pow1(r, n):
  for i in range(r):
    p = i**n

def pow2(r, n):
  for i in range(r):
    p = 1
    for j in range(n):
      p *= i 
```

现在， pow2 只是一个简单的例子，显然没有优化！
但即便如此，我发现使用 n = 2 和 r = 1,000,000，然后 pow1 需要约 2500 毫秒，而 pow2 需要约 1700 毫秒。
我承认对于较大的 n 值，pow1 确实比 pow2 快得多。但这并不奇怪。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-06-19T20:33:46.277

基本上，简单的乘法是 O(n)，具有非常低的常数因子。取幂是 O(log n) ，常数因子更高（有特殊情况需要测试......分数指数，负指数等）。编辑：为了清楚起见，这是 O(n) 其中 n 是指数。

当然，对于小 n，天真的方法会更快，您实际上只是实现了指数数学的一小部分，因此您的常数因子可以忽略不计。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-19T20:07:50.963

添加支票也是一项费用。你总是想要那张支票吗？编译语言可以检查常数指数以查看它是否是一个相对较小的整数，因为没有运行时成本，只有编译时成本。解释性语言可能不会进行检查。

除非语言指定了那种细节，否则这取决于特定的实现。

Python 不知道您要输入的指数分布是什么。如果它将是 99% 的非整数值，您是否希望代码每次都检查整数，从而使运行时间更慢？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-19T22:05:31.070

在指数检查中这样做会稍微减慢它不是简单的 2 幂的情况，因此不一定是胜利。然而，在指数预先知道的情况下（例如使用文字 2），生成的字节码可以通过简单的窥视孔优化来优化。大概这根本不被认为值得做（这是一个相当具体的案例）。

这是进行这种优化的快速概念证明（可用作装饰器）。注意：您需要[byteplay](http://code.google.com/p/byteplay/)模块来运行它。

```
import byteplay, timeit

def optimise(func):
    c = byteplay.Code.from_code(func.func_code)
    prev=None
    for i, (op, arg) in enumerate(c.code):
        if op == byteplay.BINARY_POWER:
            if c.code[i-1] == (byteplay.LOAD_CONST, 2):
                c.code[i-1] = (byteplay.DUP_TOP, None)
                c.code[i] = (byteplay.BINARY_MULTIPLY, None)
    func.func_code = c.to_code()
    return func

def square(x):
    return x**2

print "Unoptimised :", timeit.Timer('square(10)','from __main__ import square').timeit(10000000)
square = optimise(square)
print "Optimised   :", timeit.Timer('square(10)','from __main__ import square').timeit(10000000) 
```

这给出了时间：

```
Unoptimised : 6.42024898529
Optimised   : 4.52667593956 
```

**[编辑]** 实际上，再想一想，没有完成这种优化是有充分理由的。不能保证有人不会创建一个用户定义的类来覆盖`__mul__`and`__pow__`方法并为每个方法做不同的事情。安全地做到这一点的唯一方法是，如果您可以保证堆栈顶部的对象是具有相同结果“x `**2`”和“ `x*x`”的对象，但要解决这个问题要困难得多。例如。在我的示例中这是不可能的，因为任何对象都可以传递给 square 函数。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-07-25T08:25:08.353

二进制求幂的 b^p 实现

```
def power(b, p):
    """
    Calculates b^p
    Complexity O(log p)
    b -> double
    p -> integer
    res -> double
    """
    res = 1

    while p:
        if p & 0x1: res *= b
        b *= b
        p >>= 1

    return res 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T20:20:10.657

我怀疑没有人期望这会如此重要。通常，如果你想做严肃的计算，你可以用 Fortran 或 C 或 C++ 或类似的东西来做（也许从 Python 中调用它们）。

在 n 不是整数或非常大的情况下，将所有内容都视为 exp(n * log(x)) 效果很好，但对于小整数来说效率相对较低。检查 n 是否是一个足够小的整数确实需要时间，并增加了复杂性。

检查是否值得取决于预期的指数、在此获得最佳性能的重要性以及额外复杂性的成本。显然，Guido 和 Python 团队的其他成员认为检查不值得。

如果愿意，您可以编写自己的重复乘法函数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T20:06:00.733

*x x* x *x* x怎么样？它仍然比 x**5 快吗？

随着 int 指数变大，取幂可能比乘法更快。但是实际发生交叉的数量取决于各种条件，所以在我看来，这就是为什么在语言/库级别没有完成（或无法完成）优化的原因。但是用户仍然可以针对一些特殊情况进行优化:)

# sql - 在 SQL 中结合 LIKE 和 IN

> ID：1019745
> 
> 赞同：4
> 
> 时间：2009-06-19T19:48:13.593
> 
> 标签：sql, sql-server-2008

而不是执行：

SELECT a
FROM b
WHERE a LIKE 'a%'
OR a LIKE 'b%'
OR a LIKE 'c%'

有没有办法执行类似这个伪代码的功能？

SELECT a
FROM b
***WHERE a IN ('a%', 'b%', 'c%')***

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-19T19:50:40.390

可能对您的示例过于具体，但您可以执行 LIKE '[ac]%'。除此之外，我不知道任何类似 LIKE 的 IN 语法

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-19T20:03:44.700

您可以将标准值转储到临时表中（不带通配符）。然后做一个像这样的连接：

```
SELECT b.a FROM b INNER JOIN #likevals on b.a LIKE #likevals.value + '%' 
```

WHERE #likevals 看起来像：

```
value
------
a
b
c 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-19T19:57:50.157

你可以使用

```
SELECT a
FROM b
WHERE a >= 'A'
AND a < 'D' 
```

这将确保您最好地使用 a 上的索引。

我敢打赌，另一个答案会给你一个索引扫描或表扫描。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-05T14:07:23.897

才发现这个。有很多方法可以解决它，但这里有一种灵活的方法可以用于报告解决方案。我只是碰巧在过去遇到了同样的问题要解决，并且从不传递问题;o）。如果这不能解析，请提前道歉 - 从内存中插入并摆弄，但你应该明白这个想法

```
CREATE FUNCTION fn_PatList (@PatList VARCHAR(200))
RETURNS @SearchList TABLE (Pattern VARCHAR(100))
AS 
BEGIN
 WHILE @PatList LIKE '%,%'
 BEGIN
  SELECT @PatList = LTRIM(RTRIM(@PatList))
  INSERT INTO @SearchList
   SELECT RTRIM(LEFT(@PatList,PATINDEX('%,%',@PatList)-1))
  SELECT @PatList = SUBSTRING(@PatListmPATINDEX('%,%',@PatList)+1, 8000)
 END
 INSERT INTO @SearchList 
  SELECT LTRIM(RTRIM(@PatList))
 RETURN
END 
```

这是一般要点 - 对迄今为止的任何错误表示歉意。近期要做的事情。

现在..

```
SELECT Names.Person
FROM Names
INNER JOIN Fn_PatList ('Fred%,John%') PatList
ON Names.Person LIKE PatList.Pattern 
```

您可能希望允许空格，即逗号和其他各种垃圾之间的空格。简而言之，您现在可以使用您的函数来满足模式列表的需求。希望这能满足您的要求 - 很容易使用。可能也想考虑索引，但你可以从那里拿起它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T19:56:36.120

不，IN 运算符需要实际值。你能得到的最接近的是：

```
Select a
from b 
where a in (
    select a 
    from b
    WHERE a LIKE 'a%'
    OR a LIKE 'b%'
    OR a LIKE 'c%') 
```

除了只是重复你在这个特殊情况下的努力，所以我不会使用上面的代码。本质上，您需要将实际值传递到您的 IN 语句中。这里的要点是您可以在 IN 语句中使用 select 语句来获取您的值。

另外，我在这里的假设是您不会尝试选择文字值“a”、“b”、“c”等，并且这些值代表您不想向我们展示的其他字符串.

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2011-11-25T04:27:00.477

我有同样的问题，我不得不为它写一个脚本。（如果它还在你的脑海中）

这是我最终使用的：

```
 DECLARE @User INT, @MaskCount INT
     SET @User = 1
     Select @MaskCount = COUNT(*) from BI.dbo.ALL_Access_Masks

     WHILE (@User <= @MaskCount)
        Begin

        DECLARE @ProntoUserID Nvarchar (12)
        Set @ProntoUserID = (select Distinct [USER_ID] from BI.dbo.ALL_Access_Masks where [ID] = @User)

        DECLARE @DB Nvarchar (3)
        Set @DB = (select Distinct DB_Code from BI.dbo.ALL_Access_Masks where [ID] = @User)

        DECLARE @TopFlag INT
        SET @TopFlag = 1

            Drop Table #UserMasks 
            Drop Table #UserMasks1 

            Create Table #UserMasks
            ([RN] [Int] NOT NULL,
            [DB] [Nvarchar] (3) NOT NULL,
            [Mask] [Nvarchar](10) NOT NULL)

            Create Table #UserMasks1
            ([DB] [Nvarchar] (3) NOT NULL,
            [Mask] [Nvarchar](10) NOT NULL)

            Insert Into #UserMasks1 

                select @DB ,PD_Mk_1  from BI.dbo.ALL_Access_Masks where [ID] = @User and PD_Mk_1 is not NULL
                Union All select @DB ,PD_Mk_2  from BI.dbo.ALL_Access_Masks where [ID] = @User and PD_Mk_2  is not null and DB_Code = @DB
                Union All select @DB ,PD_Mk_3  from BI.dbo.ALL_Access_Masks where [ID] = @User and PD_Mk_3  is not null and DB_Code = @DB
                Union All select @DB ,PD_Mk_4  from BI.dbo.ALL_Access_Masks where [ID] = @User and PD_Mk_4  is not null and DB_Code = @DB
                Union All select @DB ,PD_Mk_5  from BI.dbo.ALL_Access_Masks where [ID] = @User and PD_Mk_5  is not null and DB_Code = @DB
                Union All select @DB ,PD_Mk_6  from BI.dbo.ALL_Access_Masks where [ID] = @User and PD_Mk_6  is not null and DB_Code = @DB
                Union All select @DB ,PD_Mk_7  from BI.dbo.ALL_Access_Masks where [ID] = @User and PD_Mk_7  is not null and DB_Code = @DB
                Union All select @DB ,PD_Mk_8  from BI.dbo.ALL_Access_Masks where [ID] = @User and PD_Mk_8  is not null and DB_Code = @DB
                Union All select @DB ,PD_Mk_9  from BI.dbo.ALL_Access_Masks where [ID] = @User and PD_Mk_9  is not null and DB_Code = @DB
                Union All select @DB ,PD_Mk_10 from BI.dbo.ALL_Access_Masks where [ID] = @User and PD_Mk_10 is not null and DB_Code = @DB

            Insert Into #UserMasks

                Select ROW_NUMBER() OVER ( PARTITION BY @DB ORDER BY Mask DESC) AS RN,DB,Mask from #UserMasks1
                where DB = @DB

        WHILE (@TopFlag <=(select COUNT(*) from #UserMasks))

                        BEGIN

                            Insert Into BI.dbo.Masked_Users
                            select @DB,@ProntoUserID,'PD' as 'Mask_Type',Code
                            from BI.dbo.Mask_Lookup M
                            where code like (select Mask + '%' from #UserMasks Where RN = @TopFlag)
                            and [Database] = @DB and M.Mask = 'PD'

        SET @TopFlag = @TopFlag + 1

                    End

        SET @User = @User + 1

End

GO 
```

# sql-server - 插入非标识表的 TSQL 触发器

> ID：1019746
> 
> 赞同：1
> 
> 时间：2009-06-19T19:48:44.950
> 
> 标签：sql-server, tsql

我正在研究一个需要在另一个表上重新插入其数据的触发器。

目标表有一个主键 INT NOT NULL WITHOUT Identity，所以我有 2 个选择：

1.  计算最大值并从此处插入。
2.  从序列表中获取最大值。

我使用总是创建一个具有标识的表变量，并从之前计算的值插入移位。

```
CREATE TRIGGER trg
   ON  [dbo].[table] 
   AFTER INSERT
AS
BEGIN
    SET NOCOUNT ON;

    DECLARE @t TABLE (sec INT IDENTITY(1, 1), id INT)
    DECLARE @ini INT

    SELECT @ini = ISNULL(MAX(id), 0) FROM tableDest
    -- SELECT @ini = value FROM sequencesTable WHERE seqId = 987

    INSERT INTO @t (id) SELECT id FROM inserted

    INSERT INTO tableDest 
        (id, field1, field2) 
    SELECT @ini + t.sec, field1, field2
    FROM @t t
        JOIN inserted ON t.id = inserted.id

    -- SELECT @ini = @ini + MAX(t.sec) FROM @t
    -- UPDATE sequencesTable SET value = @ini WHERE seqId = 987
END 
```

有没有更好的方法来做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T20:45:10.407

假设 SQL 2005+，您可以使用[ROW_NUMBER()](http://msdn.microsoft.com/en-us/library/ms186734.aspx)：

```
CREATE TRIGGER trg
   ON  [dbo].[table] 
   AFTER INSERT
AS
BEGIN
    SET NOCOUNT ON;

    INSERT INTO tableDest
        (id, field1, field2)
    SELECT
        Seed.Value + ROW_NUMBER() OVER(ORDER BY Id), 
        field1, 
        field2
    FROM Inserted
    CROSS JOIN (
       SELECT MAX(id) as Value
       FROM tableDest
    ) as Seed
END 
```

执行 a`CROSS JOIN`而不是直接获取种子值可以让您免于`MAX(Id)`在获取值和插入值之间进行更改的并发头痛。否则，您需要一个`SERIALIZABLE`事务来防止新行在读取后插入到 tableDest 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-08T14:37:11.703

澄清一下，如果我运行这个语句，它是否总是在表 Foo 中给我一个唯一的 Bar，即使许多同时的语句是同时并行执行的？

```
INSERT INTO Foo (Bar)
  SELECT
    CASE WHEN Bar = -1 
    THEN (SELECT Seed.Value + ROW_NUMBER() OVER(ORDER BY AutoId) 
          FROM inserted CROSS JOIN (SELECT MAX(Bar) as Value FROM Foo) as Seed)
    ELSE Bar
    END 
```

在那种情况下，是什么使语句并发安全？是否因为为 Bar 生成新值的 select 嵌套在 insert 语句中？或者是防止同时读取表 Foo 的交叉连接？case语句怎么样，在并发方面对结果有影响吗？

谢谢！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T20:23:35.270

tableDest*真的*需要人工主键吗？

此外，并发性：在计算 @ini 的值和实际执行插入之间是否有可能在 tableDest 上发生其他插入？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T21:26:12.333

我想我会问一个显而易见的问题，为什么不在目标表上设置一个标识值？（注意，如果您这样做，请确保您没有使用 @@identity 从源表中获取标识值，因为这不是您将获得的标识值 - 您将从目标表中获取标识。 )

或者您可以使用源表中的标识作为另一个表的标识。这让我觉得设计的初衷。否则，可能很难将这些记录与原始数据相匹配。

# ruby-on-rails - 如何使用可标记（redux）查找和显示具有特定标记的一组对象？

> ID：1019747
> 
> 赞同：0
> 
> 时间：2009-06-19T19:49:25.290
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-plugins

我想在标签的显示视图中显示文章列表。我在 Rails 2.3.2 和 SQLite3 应用程序中使用充当可标记的 redux 插件。就[基本示例](http://github.com/geemus/acts_as_taggable_redux/blob/8d032f5ac86a36d31478b384226b715192614d5e/README)而言，我已经完成了分配标签，然后在文章中显示它们的列表。

现在我想显示属于某个标签的文章列表，但出现以下错误：

```
undefined method `article' for #<Tag id: 1, name: "various", taggings_count: 1> 
```

## 楷模

/article.rb

```
class Article < ActiveRecord::Base  
  acts_as_taggable
end 
```

/user.rb

```
class Tag < ActiveRecord::Base  
  acts_as_tagger
end 
```

## 控制器

/tags_contoller.rb

```
def show
  @tag = Tag.find(params[:id])
  @articles = @tag.articles
end 
```

## 看法

/tags/show.html.erb

```
<% for article in @articles %>  
   ...  
<% end %> 
```

这是[迁移文件的链接](http://pastie.org/517915)。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T20:27:57.397

我相信插件不是这里的罪魁祸首，是 sqlite 给你带来了麻烦。我以前遇到过这个 - 似乎 sqlite 无法理解 'table_name.column_name' 语法，即使网站上没有提到它。在我的情况下，我刚刚切换到 MySQL，整个事情都没有问题。看看这是否有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-20T16:48:11.370

问题是您有一个名为 Object 的模型。给它一个与 Ruby 系统类不重叠的名称，例如 ApplicationObject 或 MediaObject。

我可以推测为什么会导致问题，但这只是推测。开放类是 Ruby 的一个很棒的特性，但这意味着您需要小心地命名您的类，以便它们与 Ruby 和 Rail 的类不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-20T18:31:45.363

非常感谢 Geemus，作为可标记的 redux 的作者向我解释了这一点。

要显示带有特定标签的文章列表，我只需将 tags_controller 更改为：

/tags_contoller.rb

```
def show
  @tag = Tag.find(params[:id])
  @articles = @tag.articles
end 
```

到：

控制器 /tags_contoller.rb

```
def show
  @tag = Tag.find(params[:id])
  @articles = @tag.tagged
end 
```

# python - 以上下文相关的方式通过分隔符拆分字符串

> ID：1019756
> 
> 赞同：2
> 
> 时间：2009-06-19T19:51:33.400
> 
> 标签：python, regex, split

例如，我想拆分

```
str = '"a,b,c",d,e,f' 
```

进入

```
["a,b,c",'d','e','f'] 
```

（即不要拆分引用的部分）在这种情况下，可以这样做

```
re.findall('".*?"|[^,]+',str) 
```

然而，如果

```
str = '"a,,b,c",d,,f' 
```

我想

```
["a,,b,c",'d','','f'] 
```

即我想要一种类似于python 的split 函数的行为。有什么方法可以在一行（小）中做到这一点，可能使用 Python 的 re 库？

实际上，我刚刚（在这个网站上）意识到 csv 模块非常适合我想做的事情，但我很好奇是否有一个正则表达式也可以用来做它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T20:09:50.867

使用 csv 模块，因为它是一个真正的解析器。对于涉及规则更改的匹配分隔符的大多数事情，正则表达式不是最佳的（或完全不适合）（我不确定这个特定的语法是否是正则的）。您也许可以创建一个适用于这种情况的正则表达式，但它会相当复杂（尤其是处理像“他说，\”你好吗\“”这样的情况）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-20T12:14:01.630

```
re.split(',(?=(?:[^"]*"[^"]*")*[^"]*$)', str) 
```

匹配逗号后，如果前面有奇数个引号，则逗号必须在一对引号内，因此不计入分隔符。显然，这没有考虑转义引号的可能性，但如果需要可以处理 - 它只会使正则表达式变得丑陋两倍。:D

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T20:26:55.497

另一方面，为此编写状态机似乎非常简单。DFA 和正则表达式具有相同的功能，但通常其中一个更适合手头的问题，并且通常非常依赖于您可能需要实现的附加逻辑。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-20T16:21:35.107

Friedl's *Mastering Regular Expressions的*[第 271 页](http://books.google.com/books?id=GX3w_18-JegC&lpg=PA401&ots=PHojQnfpRY&dq=comma-separated%20%22mastering%20regular%20expressions%22&pg=PA271)有一个正则表达式，用于提取可能引用的 CSV 字段，但它需要一些后处理：

```
>>> re.findall('(?:^|,)(?:"((?:[^"]|"")*)"|([^",]*))',str)
[('a,b,c', ''), ('', 'd'), ('', 'e'), ('', 'f')]
>>> re.findall('(?:^|,)(?:"((?:[^"]|"")*)"|([^",]*))','"a,b,c",d,,f')
[('a,b,c', ''), ('', 'd'), ('', ''), ('', 'f')] 
```

与详细标志相同的模式：

```
csv = re.compile(r"""
    (?:^|,)
    (?: # now match either a double-quoted field
        # (inside, paired double quotes are allowed)...
        " # (double-quoted field's opening quote)
          (    (?: [^"] | "" )*    )
        " # (double-quoted field's closing quote)
    |
      # ...or some non-quote/non-comma text...
        ( [^",]* )
    )""", re.X) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T21:00:49.033

您可以使用非贪婪说明符接近。我得到的最接近的是：

```
>>> re.findall('(".*?"|.*?)(?:,|$)',  '"a,b,c",d,e,f')
['"a,,b,c"', 'd', '', 'f', ''] 
```

但是如您所见，最后会得到一个多余的空字符串，这与字符串以逗号结尾时得到的结果无法区分：

```
>>> re.findall('(".*?"|.*?)(?:,|$)', '"a,b,c",d,e,f,')
['"a,,b,c"', 'd', '', 'f', ''] 
```

所以你需要在最后做一些手动调整——比如：

```
matches = regex,findall(s)
if not s.endswith(","): matches.pop() 
```

或者

```
matches = regex.findall(s+",")[:-1] 
```

可能有更好的方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T21:26:25.080

**这是一个可以完成任务的函数：**

```
def smart_split(data, delimiter=","):
    """ Performs splitting with string preservation. This reads both single and
        double quoted strings.
    """
    result = []
    quote_type = None
    buffer = ""
    position = 0
    while position < len(data):
        if data[position] in ["\"", "'"]:
            quote_type = data[position]
            while quote_type is not None:
                position += 1
                if data[position] == quote_type:
                    quote_type = None
                    position += 1
                else:
                    buffer += data[position]
        if data[position] == delimiter:
            result.append(buffer)
            buffer = ""
        else:
            buffer += data[position]
        position += 1
    result.append(buffer)
    return result 
```

**使用示例：**

```
str = '"a,b,c",d,e,f'
print smart_split(str)
# Prints: ['a,b,c', 'd', 'e', 'f'] 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-20T15:38:27.597

这是一个非常简短的函数，可以做同样的事情：

```
def split (aString):
    splitByQuotes = (",%s,"%aString).split('"')
    splitByQuotes[0::2] = [x.split(",")[1:-1] for x in splitByQuotes[0::2]]
    return [a.strip() \
        for b in splitByQuotes \
        for a in (b if type(b)==list else [b])] 
```

它拆分引号所在的字符串，创建一个列表，其中每个偶数元素是引号之外的东西，每个奇数元素是封装在引号内的东西。引号中的东西它留下，它外面的东西在逗号所在的地方分开。现在我们有了一个交替列表和字符串的列表，然后我们用最后一行解包。开头用逗号包裹字符串，中间去掉逗号的原因是为了防止列表中出现多余的空元素。它应该能够处理空格 - 我在最后添加了一个 strip() 函数以使其产生干净的输出，但这不是必需的。

用法：

```
>>> print split('c, , "a,,b,c",d,"moo","f"')
['c', '', 'a,,b,c', 'd', 'moo', 'f'] 
```

# iis-7 - 如何在 IIS7 中使用密码保护虚拟目录

> ID：1019762
> 
> 赞同：0
> 
> 时间：2009-06-19T19:52:37.873
> 
> 标签：iis-7, clickonce, passwords

我在运行 IIS7 的服务器上的虚拟目录中放置了 ClickOnce 部署。

我希望能够对目录进行密码保护，以便可以在 WAN 上测试应用程序，但我似乎不知道如何为包含 ClickOnce 应用程序的目录设置密码。

任何帮助都会非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T19:58:49.750

您要使用哪种类型的身份验证？一个简单的事情是在目录上启用 Windows 身份验证，然后添加允许/拒绝授权规则。这一切都可以通过 IIS 管理控制台来完成。可能未安装 Windows 身份验证，因此您可能需要将其作为一项功能进行安装。

# php - ImageMagick：通过 PHP 转换 png 失败并通过 bash shell 工作

> ID：1019768
> 
> 赞同：5
> 
> 时间：2009-06-19T19:54:07.810
> 
> 标签：php, apache2, imagemagick, mamp

我有一个非常奇怪的错误，我还没有找到解决方案。**更新**见下面的解决方案

我要做的是将全尺寸图片转换为 160x120 缩略图。它适用于任何大小的 jpg 和 jpeg 文件，但不适用于 png。

ImageMagick 命令：

```
/opt/local/bin/convert '/WEBSERVER/images/img_0003-192-10.png' -thumbnail x320 -resize '320x<' -resize 50% -gravity center -crop 160x120+0+0 +repage -quality 91 '/WEBSERVER/thumbs/small_img_0003-192-10.png' 
```

PHP 函数（缩短）

```
...
$cmd = "/opt/local/bin/convert '/WEBSERVER/images/img_0003-192-10.png' -thumbnail x320 -resize '320x<' -resize 50% -gravity center -crop 160x120+0+0 +repage -quality 91 '/WEBSERVER/thumbs/small_img_0003-192-10.png'";
exec($cmd, $output, $retval);
$errors += $retval;
if ($errors > 0) {
    die(print_r($output));
} 
```

当此函数运行 $retval 等于 1 时，这意味着转换命令失败（未创建缩略图）。

这就是有趣的地方，如果我在我的 shell 中运行完全相同的命令，它就可以工作。

```
wedbook:~ wedix$ /opt/local/bin/convert '/WEBSERVER/images/img_0003-192-10.png' -thumbnail x320 -resize '320x<' -resize 50% -gravity center -crop 160x120+0+0 +repage -quality 91 '/WEBSERVER/thumbs/small_img_0003-192-10.png'
wedbook:~ wedix$ 
```

我尝试过使用不同的 PHP 函数，例如 system、passthru，但它没有用。我想也许这里有人知道解决方案。

我正在使用

1.  `MAMP 1.7.2`
    *   `Apache/2.0.59`
    *   `PHP/5.2.6`

谢谢！

**更新**

我更新了以下依赖项

1.  `libpng from 1.2.35 to 1.2.37`
2.  `libiconv from 1.12_2 to 1.13_0`
3.  `ImageMagick 6.5.2-4_1 to 6.5.2-9_0`

但是，它并没有解决我的问题。

**第二次更新**

我终于找到了一些可能有帮助的东西，当函数运行时，这就是 Apache 日志中打印的内容：

```
dyld: Library not loaded: /opt/local/lib/libiconv.2.dylib
  Referenced from: /opt/local/bin/convert
  Reason: Incompatible library version: convert requires version 8.0.0 or later, but libiconv.2.dylib provides version 7.0.0 
```

**第三次更新**

libiconv.2.dylib 是 8.0.0 版...

```
bash-3.2$ otool -L /opt/local/lib/libiconv.2.dylib 
/opt/local/lib/libiconv.2.dylib:
    /opt/local/lib/libiconv.2.dylib (compatibility version 8.0.0, current version 8.0.0)
    /usr/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)
    /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 111.1.4) 
```

**第四次更新**

问题与 MAMP 有关，请参阅下面的解决方案

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-20T09:11:11.327

解决了！

原来环境变量`DYLD_LIBRARY_PATH`没有正确设置。

Mac OS X Leopard 附带 libiconv 7.0.0，但 convert 需要 8.0.0（参见上面的第二次更新）

```
bash-3.2$ otool -L /usr/lib/libiconv.2.dylib 
/usr/lib/libiconv.2.dylib:
    /usr/lib/libiconv.2.dylib (compatibility version 7.0.0, current version 7.0.0)
    /usr/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)
    /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 111.1.1) 
```

ImageMagick 和所有依赖项都与 MacPorts 一起安装在`/opt/local`. 这需要手动将路径 /opt/local/lib 添加到`DYLD_LIBRARY_PATH`.

如果我在 Mac OS X Leopard envvars 文件中添加路径`/opt/local/lib`，它将不起作用。为什么？这是因为我不使用 Mac OS X Leopard 的 apache，而是使用 MAMP。`DYLD_LIBRARY_PATH``apachectl``/usr/sbin/envvars`

MAMP**有自己的**apachectl 脚本**和自己的**envvars 文件。

我在 MAMP envvars 文件`/opt/local/lib`中添加了路径`DYLD_LIBRARY_PATH``apachectl``/Applications/MAMP/Library/bin/envvars`

```
DYLD_LIBRARY_PATH="/opt/local/lib:/Applications/MAMP/Library/lib:$DYLD_LIBRARY_PATH" 
```

现在正在生成我的 PNG 缩略图，并且在 apache 错误日志中没有生成错误！

我希望这会对某人有所帮助，下次我会记得在寻求帮助之前检查每个日志文件！

菲尔

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-01-09T02:35:43.467

我的路径是 /opt/local/bin，但即使将其添加到 DYLD_LIBRARY_PATH 也不起作用。最后，当我只更改普通的 ole PATH 时，它通过 PHP 工作。

;不工作...

;DYLD_LIBRARY_PATH="/opt/local/bin:/Applications/MAMP/Library/lib:$DYLD_LIBRARY_PATH"

; 导出 DYLD_LIBRARY_PATH

; 这行得通！

导出 PATH="$PATH:/opt/local/bin"

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T19:57:40.860

确保运行 php 代码的用户对文件和目录具有相同的权限。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-20T08:55:00.610

这些应该很明显，但请确保检查 PHP 安全模式、open_basedir 以及是否`exec`已禁用等内容。

# emacs - 如何检查 Emacs Lisp 中的字符串是否为空？

> ID：1019778
> 
> 赞同：36
> 
> 时间：2009-06-19T19:57:39.220
> 
> 标签：emacs, elisp

我想写一个 if 语句，它会根据字符串是否为空来做一些事情。例如：

```
(defun prepend-dot-if-not-empty (user-str)
   (interactive "s")
   (if (is-empty user-str)
     (setq user-str (concat "." user-str)))
   (message user-str)) 
```

在这个人为的示例中，我使用 (is-empty) 代替真正的 elisp 方法。这样做的正确方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-06-19T20:08:37.810

由于在 elisp 中，String 是一个 int 数组，因此您可以使用

```
(= (length user-str) 0) 
```

您也可以使用 (string=) 这通常更容易阅读

```
(string= "" user-str) 
```

Equal 也可以，但速度会慢一些：

```
(equal "" user-str) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2018-10-18T16:17:05.040

从 emacs 24.4 开始，有两个不同的函数可供您调用，具体取决于您所说的“空”。

```
(string-empty-p " ")
nil

(string-blank-p " ")
0 
```

我无法找到要链接的文档，但[emacsredux.com](http://emacsredux.com/blog/2014/02/02/a-peek-at-emacs-24-dot-4-new-string-manipulation-functions/)有更多信息。

如果您收到错误`Symbol's function definition is void.`，请包含`(require 'subr-x)`在初始化文件中（它是一个用于修剪和字符串操作的包）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-03-18T04:28:16.197

如果您在代码中大量使用字符串，我强烈建议您使用 Magnar Sveen 的[`s.el`](https://github.com/magnars/s.el)字符串操作库。

[`s-blank?`](https://github.com/magnars/s.el#s-blank-s)检查字符串是否为空：

```
(s-blank? "") ; => t 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-05-14T23:50:37.290

我把这个放在我的`utils.lisp`：

```
(defun empty-string-p (string)
  "Return true if the STRING is empty or nil. Expects string type."
  (or (null string)
      (zerop (length (string-trim string))))) 
```

然后我做：

```
(not (empty-string-p some-string)) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-19T20:09:46.327

我不确定测试它的规范方法是什么，但您可以使用 length 函数并检查字符串的长度是否大于零：

```
(length "abc")  
=> 3
(length "")  
=> 0 
```

如果您想在测试之前删除空格，EmacsWiki elisp 食谱有[一个 trim 函数的示例。](http://www.emacswiki.org/emacs/ElispCookbook)

# python - Python tkInter 入门乐趣

> ID：1019782
> 
> 赞同：3
> 
> 时间：2009-06-19T19:58:15.913
> 
> 标签：python, tkinter

玩 Python - tkInter - Entry 小部件 - 当我使用 validatecommand（如下）时，第一次检查字符串 > Max，但是当我继续输入文本时检查步骤 - 第一次后没有删除或插入？有什么建议吗？（除了不通过 python 构建桌面应用程序）

* * *

```
#!/usr/bin/env python
from Tkinter import *

class MyEntry(Entry):

    def __init__(self, master, maxchars):
        Entry.__init__(self, master, validate = "key",    validatecommand=self.validatecommand)
        self.MAX = maxchars

    def validatecommand(self, *args):
        if len(self.get()) >= self.MAX:
            self.delete(0,3)
            self.insert(0, "no")
        return True

if __name__ == '__main__':
    tkmain = Tk()
    e = MyEntry(tkmain, 5)
    e.grid()
    tkmain.mainloop() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T21:32:54.287

[来自 Tk 人](http://www.tcl.tk/man/tcl8.4/TkCmd/entry.htm#M30)：

> 当您从 validateCommand 或 invalidCommand 中编辑条目小部件时，validate 选项也会将其自身设置为 none。此类版本将覆盖正在验证的版本。如果您希望在验证期间编辑条目小部件（例如将其设置为 {}）并且仍然设置了验证选项，则应包含命令
> 
> 空闲后 {%W config -validate %v}

不知道如何将其翻译成python。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-12-07T02:21:21.117

这是一个将输入限制为 5 个字符的代码示例：

```
import Tkinter as tk

master = tk.Tk()

def callback():
    print e.get()

def val(i):
    print "validating"
    print i

    if int(i) > 4:
        print "False"
        return False
    return True

vcmd = (master.register(val), '%i')

e = tk.Entry(master, validate="key", validatecommand=vcmd)
e.pack()

b = tk.Button(master, text="OK", command=lambda: callback())
b.pack()

tk.mainloop() 
```

我扔了一堆打印语句，这样你就可以在控制台中看到它在做什么。

以下是您可以传递的其他替换：

```
 %d   Type of action: 1 for insert, 0  for  delete,  or  -1  for  focus,
        forced or textvariable validation.

   %i   Index of char string to be inserted/deleted, if any, otherwise -1.

   %P   The value of the entry if the edit is allowed.  If you are config-
        uring  the  entry  widget to have a new textvariable, this will be
        the value of that textvariable.

   %s   The current value of entry prior to editing.

   %S   The text string being inserted/deleted, if any, {} otherwise.

   %v   The type of validation currently set.

   %V   The type of validation that triggered the callback (key,  focusin,
        focusout, forced).

   %W   The name of the entry widget. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T21:25:00.450

我确定确切的原因是什么，但我有预感。每次编辑条目时都会进行验证检查。我做了一些测试，发现它确实执行，并且每次验证期间都可以做各种事情。导致它停止正常工作的原因是当您从 validatecommand 函数中对其进行编辑时。这会导致它停止进一步调用 validate 函数。我猜它不再识别对条目值或其他内容的进一步编辑。

lgal Serban 似乎有关于为什么会发生这种情况的幕后信息。

# actionscript-3 - 如何在 AS3 中停止声音以播放另一个声音？

> ID：1019789
> 
> 赞同：0
> 
> 时间：2009-06-19T20:00:53.740
> 
> 标签：actionscript-3, audio

我有代码

```
if(_snd !=null)
{
    _channel.stop();
}

_snd = new SoundBeep();
_channel = new SoundChannel();
_channel = _snd.play(); 
```

但如果用户快速点击几次，flash 会稍等片刻，然后快速发出哔哔声。我不确定出了什么问题。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T23:26:45.510

尝试这个：

```
if(_channel != null)
{
    _channel.stop();
}

_snd = new SoundBeep();
_channel = _snd.play(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-23T00:13:18.817

我遇到了这个问题——太让人抓狂了！在其他语言（java、C#）中，我会在关键部分周围使用同步。在 Flash 中，我不得不伪造它。它并不完美——第二个声音在第一个声音上播放的可能性仍然很小，但它非常小。

这是关键：实现工厂模式和单例模式的组合。

我发现的一个重要发现是，我需要在对成员变量进行操作之前将其复制到一个临时变量中，以防在我完成清理前一个 Sound 之前对该对象的其他调用尝试换入新 Sound。这是一个片段：

```
 /** Seek into the audio to the given position in milliseconds. */
    public function seek(position:Number, resumePlay:Boolean) {
        trace("--> Seek(" + position + ") " + name);

        var tempAudioChannel:SoundChannel = audioChannel;
        audioChannel = null;
        if (tempAudioChannel != null) {
            tempAudioChannel.stop();
            tempAudioChannel.removeEventListener(Event.SOUND_COMPLETE, onAudioCompleteHandler);
        }
        audioLastPosition = position;

        if (resumePlay) {
            tempAudioChannel = audio.play(audioLastPosition);
            tempAudioChannel.addEventListener(Event.SOUND_COMPLETE, onAudioCompleteHandler);
            audioChannel = tempAudioChannel;
        }                   
    } 
```

请注意，我不仅要从 audioChannel 复制到 tempAudioChannel，而且必须将 audioChannel 清空，直到该方法几乎完成，然后再次设置它的值。除了在我测试 audioChannel 的值和完成复制和归零之间的短暂时间之外，我可以避免同步错误，这应该非常简短。

回到我对工厂模式和单例模式的评论。当一个声音被清理——停止并丢弃——另一个可能正在开始，所以我需要多个 SoundManager。因此，我为每个音频文件名创建了一个 SoundManager。每次我需要对音频文件进行操作时，SoundManager 类都会告诉我要调用哪个管理器实例，因此我不会听到相同声音的重复启动。

以下代码是我当前商业项目中的完整 SoundManager。它引用了另一个未显示的类 - 配置，但该类仅处理从配置文件获取音频文件的路径，以及从另一个 XML 文件获取放大值。（客户端提供的文件未标准化为相同的音量级别，因此我们必须为它们执行此操作。）因此，您必须编辑此代码中对配置对象的所有引用。

注意：我在至少两个成员变量 audio 和 audioChannel 上使用临时变量技巧 ALL OVER THE PLACE。

```
package com.vpg.rns.audio {
    import flash.system.System;
    import flash.events.*;
    import flash.media.Sound;
    import flash.media.SoundChannel;
    import flash.media.SoundTransform;
    import flash.net.NetStream;
    import flash.net.NetConnection;
    import flash.net.URLLoader;
    import flash.net.URLRequest;
    import flash.errors.IOError;

    /** Load a Sound from an MP3 file, then hold onto it and mediate playing and disposing of the object, and keep the several Sounds from interfering with one another. 
     *  This class stores each SoundManager instance in a collection keyed by the step name. 
     *
     *  Do not call the Constructor directly to acquire a SoundManager. Instead, use getInstance.
     */
    public class SoundManager {
        private static var allSounds:Object = new Object();

        public static function getInstance(name:String, config:Configuration) {
            var soundMgr:SoundManager = allSounds[name];
            if (soundMgr == null) {
                soundMgr = new SoundManager(name, config);
                addSoundManager(soundMgr);
            }
            return soundMgr;
        }

        private static function addSoundManager(soundMgr:SoundManager) {
            allSounds[soundMgr.name] = soundMgr;
        }

        private static function removeSoundManager(name) {
            var soundMgr:SoundManager = allSounds[name] as SoundManager;
            allSounds[name] = null;
            if (soundMgr != null) {
                soundMgr.dispose();
            }
        }

        public static function removeAllManagers() {
            var allSoundsTemp:Object = allSounds;
            allSounds = new Object();
            for (var prop:String in allSoundsTemp){
                var soundMgr:SoundManager = allSoundsTemp[prop] as SoundManager;
                if (soundMgr != null) {
                    soundMgr.dispose();
                }
            }
        }

        public static function stopManagers(exceptMgrName:String) {
            for (var prop:String in allSounds){
                var soundMgr:SoundManager = allSounds[prop] as SoundManager;
                if (soundMgr != null && soundMgr.name != exceptMgrName) {
                    soundMgr.stop();
                }
            }
        }

        private var mgrName:String;
        public function get name():String { return mgrName; }

        public var config:Configuration;
        public var audio:Sound;
        public var audioChannel:SoundChannel;
        public var audioLoadStatus:String; // States: no audio, loading, loaded, ready. "loaded" means loaded enough to start playing, but possibly still loading more.

        private var rootPath:String;
        private var dataPath:String;
        private var mediaPath:String;
        public var audioFilename:String;
        private var onLoadHandler:Function; // Called When loading file is complete
        private var onAudioCompleteHandler:Function; // Called When playing audio is complete

        public var duration:Number;
        public var audioLastPosition:Number;

        private var volumeAdjustment:Number;

        /** Construct a SoundManager. Do not call this directy. Use the factory method getInstance instead. */
        function SoundManager(name:String, config:Configuration) {
            mgrName = name;
            this.config = config;
            audioLoadStatus = "no audio";
            duration = 0;
            audioLastPosition = 0;
            volumeAdjustment = 1;
        }

        /*
         * Load the audio, then tigger the loading of the optional cue point xml file, and initialization of the controls.
         *
         * @param rootDirectory ...... Directory containing the config file. 
         * @param dataDirectory ...... Directory where cuepoint data is located. Expect the cuepoints file to be in the xml/cuepoints subdirectory. 
         * @param mediaDirectory ..... Directory where audio files are located. 
         * @param audioFile .......... Name of audio file with extension. Does not include path.
         * @param onLoadHandler ...... Called once the audio is loaded, so the caller can start playing it.
         */
        public function loadAudio(rootDirectory:String, dataDirectory:String, mediaDirectory:String, audioFile:String, onLoadHandler:Function, onAudioCompleteHandler:Function) {
            audioLoadStatus = "loading";
            //Load the audio file.
            this.rootPath = rootDirectory;
            this.dataPath = dataDirectory;
            this.mediaPath = mediaDirectory;
            this.audioFilename = audioFile;
            this.onLoadHandler = onLoadHandler;
            this.onAudioCompleteHandler = onAudioCompleteHandler;
            this.volumeAdjustment = config.getAmplification(this.audioFilename);

            var mySoundReq:URLRequest = new URLRequest(config.osSpecificPath(mediaPath + "/" + audioFilename));

            audio = new Sound();
            audio.addEventListener(IOErrorEvent.IO_ERROR, function(e:IOErrorEvent):void{ trace("SoundLoader.loadAudio ERROR!!!"); trace(e); });
            if (config.platform == "Flash_IDE") {
                audio.addEventListener(Event.COMPLETE, audioReady);
            }
            else {
                // We can't afford to wait for whole audio to load, so wait until some of it is loaded.
                audio.addEventListener(ProgressEvent.PROGRESS, audioProgress1);
                audio.addEventListener(Event.COMPLETE, audioCompletelyLoaded);
            }
            audio.load(mySoundReq);

        }       

        // A sufficient portion of the audio has loaded, so start playing.
        private function audioProgress1(evt:ProgressEvent) {
            var loadPercent:Number = Math.round(100 * evt.bytesLoaded / evt.bytesTotal);
            if (loadPercent > 10 && audioLoadStatus == "loading") { //TODO: Deduce a better threshold.
                var audioTemp:Sound = audio;
                audioTemp.removeEventListener(ProgressEvent.PROGRESS, audioProgress1);
                audioTemp.addEventListener(ProgressEvent.PROGRESS, audioProgress2);
                audioLoaded();
            }
        }       

        // As the audio continues to load, the duration lengthens, affecting the scrubber thumb position.
        private function audioProgress2(evt:ProgressEvent) {
            var loadPercent:Number = Math.round(100 * evt.bytesLoaded / evt.bytesTotal);
            if (audioLoadStatus == "loading" || audioLoadStatus == "loaded") {
                var audioTemp:Sound = audio;
                if (audioTemp != null) {
                    duration = audioTemp.length / 1000; // Convert from milliseconds to seconds.
                }
            }
        }       

        private function audioCompletelyLoaded(evt:Event) {
            var audioTemp:Sound = audio;
            if (audioTemp != null) {
                audioTemp.removeEventListener(Event.COMPLETE, audioCompletelyLoaded);
                audioTemp.removeEventListener(ProgressEvent.PROGRESS, audioProgress1);
                audioTemp.removeEventListener(ProgressEvent.PROGRESS, audioProgress2);
                duration = audioTemp.length / 1000;
            }
        }

        private function audioReady(evt:Event) {
            var audioTemp:Sound = audio;
            if (audioTemp != null) {
                audioTemp.removeEventListener(Event.COMPLETE, audioReady);
                audioLoaded();
            }
        }

        private function audioLoaded() {
            audioLoadStatus = "loaded";

            var audioTemp:Sound = audio;
            if (audioTemp != null) {
                duration = audioTemp.length / 1000; // Convert from milliseconds to seconds.
                var audioChannelTemp:SoundChannel;
                audioChannelTemp = audioTemp.play();
                audioChannelTemp.stop();
                audioChannel = null;
                audioLastPosition = 0;
                audioLoadStatus = "ready";
                onLoadHandler(this);
            }
        }

        public function play() {
            pause();
            trace("--> Play " + name);
            audioChannel = audio.play(audioLastPosition);
            audioChannel.addEventListener(Event.SOUND_COMPLETE, onAudioCompleteHandler);
        }

        /** Seek into the audio to the given position in milliseconds. */
        public function seek(position:Number, resumePlay:Boolean) {
            trace("--> Seek(" + position + ") " + name);

            var tempAudioChannel:SoundChannel = audioChannel;
            audioChannel = null;
            if (tempAudioChannel != null) {
                tempAudioChannel.stop();
                tempAudioChannel.removeEventListener(Event.SOUND_COMPLETE, onAudioCompleteHandler);
            }
            audioLastPosition = position;

            if (resumePlay) {
                tempAudioChannel = audio.play(audioLastPosition);
                tempAudioChannel.addEventListener(Event.SOUND_COMPLETE, onAudioCompleteHandler);
                audioChannel = tempAudioChannel;
            }                   
        }

        public function pause() {
            trace("--> Pause " + name);
            if (audioChannel != null) {
                audioLastPosition = audioChannel.position;
                audioChannel.stop();
                audioChannel.removeEventListener(Event.SOUND_COMPLETE, onAudioCompleteHandler);
                audioChannel = null;
            }
        }

        public function stop() {
            trace("--> Stop " + name);
            audioLastPosition = 0;
            if (audioChannel != null) {
                audioChannel.stop();
                audioChannel.removeEventListener(Event.SOUND_COMPLETE, onAudioCompleteHandler);
                audioChannel = null;
            }
        }       

        /** Elapsed time of audio in seconds. */
        public function get audioElapsed():Number {
            if (audioLoadStatus == "ready") {
                if (audioChannel != null) {
                    return audioChannel.position / 1000.0;
                }
                else {
                    return audioLastPosition / 1000.0;
                }
            }
            else {
                return 0;
            }
        }               

        /** Set the audio volume to a number between zero (mute) and one (loud). */
        public function setVolume(volume:Number, soundTransform:SoundTransform = null) {
            if (audioChannel != null) {
                if (soundTransform == null) {
                    soundTransform = new SoundTransform();
                }
                if (volumeAdjustment != 1.0) {
                    trace("setVolume using volume adjustment of " + volumeAdjustment);
                }
                soundTransform.volume = volume * volumeAdjustment;
                audioChannel.soundTransform = soundTransform;
            }
        }

        public function unloadAudio() {
            dispose();
        }               

        private function dispose() {
            audioLoadStatus = "no audio";
            var audioTemp:Sound = audio;
            audio = null;
            stop();
            if (audioTemp != null) {
                try {
                    audioTemp.close();
                }
                catch (error:IOError) {
                    trace("Error: Couldn't close audio stream: " + error.message);    
                }

            }
        }

    }

} 
```

# c# - 如何找到父非托管win32应用程序的孩子

> ID：1019790
> 
> 赞同：1
> 
> 时间：2009-06-19T20:01:08.670
> 
> 标签：c#, .net, winapi, unmanaged

基本上，我正在寻找一种在 C# 中调用的 win32 方法，以将焦点设置为非托管应用程序的子级。

但首先我需要找到问题所在的子控件的句柄。任何有用的win32函数来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T20:34:32.767

使用[FindWindowEx](http://msdn.microsoft.com/en-us/library/ms633500.aspx)查找您要查找的窗口句柄。一旦你有了那个句柄，使用[EnumChildWindows](http://msdn.microsoft.com/en-us/library/ms633494(VS.85).aspx)来找到你需要的正确的孩子。涉及的代码太多，无法快速编写示例，但网络上有足够的帮助。

[来自](http://www.pinvoke.net/default.aspx/user32/EnumChildWindows.html)Pinvoke.net：http://www.pinvoke.net/default.aspx/user32/EnumChildWindows.html

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T20:07:08.377

您是否尝试过使用 FindWindowEx？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T20:28:16.040

有一个支持枚举和搜索窗口句柄的库，可在[http://mwinapi.sourceforge.net/获得](http://mwinapi.sourceforge.net/)

只是这样您就不必每次都重新发明轮子；）

从...开始

```
SystemWindow.AllToplevelWindows 
```

然后就往下挖（查看类名、进程名、标题、对话框 ID 等等）。

# c# - 如何将 String 转换为 Int？

> ID：1019793
> 
> 赞同：745
> 
> 时间：2009-06-19T20:02:43.877
> 
> 标签：c#, .net, string, int, type-conversion

我有一个`TextBoxD1.Text`，我想将其转换为一个`int`以将其存储在数据库中。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1185
> 
> 时间：2009-06-19T20:04:50.673

试试这个：

```
int x = Int32.Parse(TextBoxD1.Text); 
```

或者更好：

```
int x = 0;

Int32.TryParse(TextBoxD1.Text, out x); 
```

此外，由于[`Int32.TryParse`](http://msdn.microsoft.com/en-us/library/f02979c7.aspx)返回 a`bool`您可以使用它的返回值来决定解析尝试的结果：

```
int x = 0;

if (Int32.TryParse(TextBoxD1.Text, out x))
{
    // you know that the parsing attempt
    // was successful
} 
```

`Parse`如果您好奇，最好将和之间的区别`TryParse`总结如下：

> TryParse 方法与 Parse 方法类似，只是 TryParse 方法在转换失败时不会抛出异常。它消除了在 s 无效且无法成功解析的情况下使用异常处理来测试 FormatException 的需要。- [MSDN](http://msdn.microsoft.com/en-us/library/f02979c7.aspx)

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2009-06-19T20:04:41.533

```
Convert.ToInt32( TextBoxD1.Text ); 
```

如果您确信文本框的内容是有效的，请使用此选项`int`。更安全的选择是

```
int val = 0;
Int32.TryParse( TextBoxD1.Text, out val ); 
```

这将为您提供一些您可以使用的默认值。`Int32.TryParse`还返回一个布尔值，指示它是否能够解析，因此您甚至可以将其用作`if`语句的条件。

```
if( Int32.TryParse( TextBoxD1.Text, out val ){
  DoSomething(..);
} else {
  HandleBadInput(..);
} 
```

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2009-06-19T20:05:05.697

```
int.TryParse() 
```

如果文本不是数字，它不会抛出。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2009-06-19T20:08:03.320

```
int myInt = int.Parse(TextBoxD1.Text) 
```

另一种方法是：

```
bool isConvertible = false;
int myInt = 0;

isConvertible = int.TryParse(TextBoxD1.Text, out myInt); 
```

两者之间的区别在于，如果文本框中的值无法转换，第一个会抛出异常，而第二个只会返回 false。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2009-06-19T20:06:36.910

您需要解析字符串，还需要确保它确实是整数格式。

最简单的方法是这样的：

```
int parsedInt = 0;
if (int.TryParse(TextBoxD1.Text, out parsedInt))
{
   // Code for if the string was valid
}
else
{
   // Code for if the string was invalid
} 
```

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2016-02-03T16:42:37.777

`Convert.ToInt32()`在字符上使用时要小心！它将返回字符的[UTF-16](https://en.wikipedia.org/wiki/UTF-16)代码！

如果您使用索引运算符仅在特定位置访问字符串`[i]`，它将返回 a`char`而不是 a `string`！

```
String input = "123678";
                    ^
                    |
int indexOfSeven =  4;

int x = Convert.ToInt32(input[indexOfSeven]);             // Returns 55

int x = Convert.ToInt32(input[indexOfSeven].toString());  // Returns 7 
```

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2009-06-19T20:11:51.563

```
int x = 0;
int.TryParse(TextBoxD1.Text, out x); 
```

TryParse 语句返回一个布尔值，表示解析是否成功。如果成功，则将解析后的值存储到第二个参数中。

有关更多详细信息，请参阅*[Int32.TryParse 方法（字符串，Int32）](http://msdn.microsoft.com/en-us/library/f02979c7.aspx)*。

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2015-04-11T07:25:34.637

好好享受...

```
int i = 0;
string s = "123";
i =int.Parse(s);
i = Convert.ToInt32(s); 
```

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2015-07-06T11:33:17.640

虽然这里已经有很多描述 的解决方案`int.Parse`，但所有答案中都缺少一些重要的东西。通常，数值的字符串表示因文化而异。数字字符串的元素，如货币符号、组（或千位）分隔符和小数分隔符都因文化而异。

如果您想创建一种将字符串解析为整数的稳健方法，那么考虑文化信息非常重要。如果不这样做，将使用[当前的文化设置](https://msdn.microsoft.com/en-us/library/system.threading.thread.currentculture(v=vs.110).aspx)。如果您正在解析文件格式，这可能会给用户一个非常令人讨厌的惊喜——甚至更糟。如果您只想要英语解析，最好通过指定要使用的文化设置简单地使其明确：

```
var culture = CultureInfo.GetCulture("en-US");
int result = 0;
if (int.TryParse(myString, NumberStyles.Integer, culture, out result))
{
    // use result...
} 
```

有关更多信息，请阅读 CultureInfo，特别是 MSDN 上的[NumberFormatInfo](https://msdn.microsoft.com/en-us/library/system.globalization.numberformatinfo(v=vs.110).aspx)。

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2016-02-05T13:05:09.297

**您可以编写自己的扩展方法**

```
public static class IntegerExtensions
{
    public static int ParseInt(this string value, int defaultValue = 0)
    {
        int parsedValue;
        if (int.TryParse(value, out parsedValue))
        {
            return parsedValue;
        }

        return defaultValue;
    }

    public static int? ParseNullableInt(this string value)
    {
        if (string.IsNullOrEmpty(value))
        {
            return null;
        }

        return value.ParseInt();
    }
} 
```

**在代码中的任何地方都可以调用**

```
int myNumber = someString.ParseInt(); // Returns value or 0
int age = someString.ParseInt(18); // With default value 18
int? userId = someString.ParseNullableInt(); // Returns value or null 
```

**在这个具体案例中**

```
int yourValue = TextBoxD1.Text.ParseInt(); 
```

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2017-01-27T21:40:50.347

```
int x = Int32.TryParse(TextBoxD1.Text, out x) ? x : 0; 
```

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2009-06-19T20:10:41.347

正如[TryParse 文档](http://msdn.microsoft.com/en-us/library/f02979c7.aspx)中所解释的，TryParse() 返回一个布尔值，表示找到了一个有效数字：

```
bool success = Int32.TryParse(TextBoxD1.Text, out val);

if (success)
{
    // Put val in database
}
else
{
    // Handle the case that the string doesn't contain a valid number
} 
```

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2016-05-16T06:01:41.650

可以为：、、和其他反映 .NET 中整数数据类型的数据类型转换`string`为`int``int``Int32``Int64`

下面的示例显示了这种转换：

这显示（用于信息）数据适配器元素初始化为 int 值。可以直接做同样的事情，

```
int xxiiqVal = Int32.Parse(strNabcd); 
```

前任。

```
string strNii = "";
UsrDataAdapter.SelectCommand.Parameters["@Nii"].Value = Int32.Parse(strNii ); 
```

[链接以查看此演示](https://www.youtube.com/watch?v=xcdKTbHT_mY)。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2015-09-07T09:42:18.227

你可以使用任何一个，

```
int i = Convert.ToInt32(TextBoxD1.Text); 
```

或者

```
int i = int.Parse(TextBoxD1.Text); 
```

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2017-01-03T19:36:56.503

```
//May be quite some time ago but I just want throw in some line for any one who may still need it

int intValue;
string strValue = "2021";

try
{
    intValue = Convert.ToInt32(strValue);
}
catch
{
    //Default Value if conversion fails OR return specified error
    // Example 
    intValue = 2000;
} 
```

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2020-10-09T10:35:41.373

您可以在 C# 中将字符串转换为 int 许多不同类型的方法

第一个主要是使用：

```
string test = "123";
int x = Convert.ToInt16(test); 
```

如果 int 值较高，则应使用 int32 类型。

第二个：

```
int x = int.Parse(text); 
```

如果要进行错误检查，可以使用 TryParse 方法。在下面我添加了可为空的类型；

```
int i=0;
Int32.TryParse(text, out i) ? i : (int?)null); 
```

享受你的代码......

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2010-05-29T06:39:55.107

```
int i = Convert.ToInt32(TextBoxD1.Text); 
```

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2013-10-25T16:11:51.487

您也可以使用[扩展方法](http://en.wikipedia.org/wiki/Extension_method)，因此它会更具可读性（尽管每个人都已经习惯了常规的 Parse 函数）。

```
public static class StringExtensions
{
    /// <summary>
    /// Converts a string to int.
    /// </summary>
    /// <param name="value">The string to convert.</param>
    /// <returns>The converted integer.</returns>
    public static int ParseToInt32(this string value)
    {
        return int.Parse(value);
    }

    /// <summary>
    /// Checks whether the value is integer.
    /// </summary>
    /// <param name="value">The string to check.</param>
    /// <param name="result">The out int parameter.</param>
    /// <returns>true if the value is an integer; otherwise, false.</returns>
    public static bool TryParseToInt32(this string value, out int result)
    {
        return int.TryParse(value, out result);
    }
} 
```

然后你可以这样称呼它：

1.  如果您确定您的字符串是整数，例如“50”。

    ```
    int num = TextBoxD1.Text.ParseToInt32(); 
    ```

2.  如果您不确定并想防止崩溃。

    ```
    int num;
    if (TextBoxD1.Text.TryParseToInt32(out num))
    {
        //The parse was successful, the num has the parsed value.
    } 
    ```

为了使其更具动态性，因此您也可以将其解析为 double、float 等，您可以进行通用扩展。

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2017-07-03T06:27:19.130

这会做

```
string x = TextBoxD1.Text;
int xi = Convert.ToInt32(x); 
```

或者你可以使用

```
int xi = Int32.Parse(x); 
```

有关详细信息，请参阅[Microsoft 开发人员网络](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/types/how-to-convert-a-string-to-a-number)

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2017-09-15T02:34:46.630

您可以在没有 TryParse 或内置函数的情况下执行以下操作：

```
static int convertToInt(string a)
{
    int x = 0;
    for (int i = 0; i < a.Length; i++)
    {
        int temp = a[i] - '0';
        if (temp != 0)
        {
            x += temp * (int)Math.Pow(10, (a.Length - (i+1)));
        }
    }
    return x;
} 
```

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2018-05-11T06:16:13.587

您可以使用以下方法将字符串转换为 C# 中的 int：

转换类的函数，即`Convert.ToInt16()`, `Convert.ToInt32()`，`Convert.ToInt64()`或使用`Parse`and`TryParse`函数。[这里](https://www.codeslehrer.com/c-string-to-int/)给出了例子。

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2018-10-17T06:03:12.723

您可以借助 parse 方法将字符串转换为整数值。

例如：

```
int val = Int32.parse(stringToBeParsed);
int x = Int32.parse(1234); 
```

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2016-04-20T15:42:47.713

我总是这样做的方式是这样的：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace example_string_to_int
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            string a = textBox1.Text;
            // This turns the text in text box 1 into a string
            int b;
            if (!int.TryParse(a, out b))
            {
                MessageBox.Show("This is not a number");
            }
            else
            {
                textBox2.Text = a+" is a number" ;
            }
            // Then this 'if' statement says if the string is not a number, display an error, else now you will have an integer.
        }
    }
} 
```

我就是这样做的。

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2020-03-25T09:52:55.477

在 C# v.7 中，您可以使用内联 out 参数，而无需额外的变量声明：

```
int.TryParse(TextBoxD1.Text, out int x); 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2017-06-05T12:37:25.773

如果您正在寻找漫长的道路，只需创建一种方法：

```
static int convertToInt(string a)
{
    int x = 0;

    Char[] charArray = a.ToCharArray();
    int j = charArray.Length;

    for (int i = 0; i < charArray.Length; i++)
    {
        j--;
        int s = (int)Math.Pow(10, j);

        x += ((int)Char.GetNumericValue(charArray[i]) * s);
    }
    return x;
} 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2020-08-06T07:10:00.740

以上所有答案都很好，但对于信息，我们可以使用`int.TryParse`which is safe to convert string to int，例如

```
// TryParse returns true if the conversion succeeded
// and stores the result in j.
int j;
if (Int32.TryParse("-105", out j))
   Console.WriteLine(j);
else
   Console.WriteLine("String could not be parsed.");
// Output: -105 
```

TryParse 从不抛出异常——即使在无效输入和 null 时也是如此。`int.Parse`在大多数程序上下文中，它总体上更可取。

资料来源：[如何在 C# 中将字符串转换为 int？（Int.Parse 和 Int.TryParse 的区别）](https://qawithexperts.com/article/c-sharp/how-to-convert-string-to-int-in-c/159)

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2021-06-25T20:44:52.030

如果您知道字符串是整数，请执行以下操作：

```
int value = int.Parse(TextBoxD1.Text); 
```

如果您不知道字符串是整数，请使用`TryParse`.

在`C# 7.0`您可以使用[内联变量声明](https://docs.microsoft.com/en-us/dotnet/fundamentals/code-analysis/style-rules/ide0018)。

*   如果解析成功 - value = 它的解析值。
*   如果解析失败 - value = 0。

代码：

```
if (int.TryParse(TextBoxD1.Text, out int value))
{
    // Parse succeed
} 
```

退税：

您无法区分 0 值和未解析的值。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2021-09-02T23:44:13.760

这是通过扩展方法执行此操作的版本，如果转换失败，该方法也可以设置默认值。事实上，这就是我用来将字符串输入转换为任何可转换类型的方法：

```
using System;
using System.ComponentModel;

public static class StringExtensions
{
    public static TOutput AsOrDefault<TOutput>(this string input, TOutput defaultValue = default)
        where TOutput : IConvertible
    {
        TOutput output = defaultValue;

        try
        {
            var converter = TypeDescriptor.GetConverter(typeof(TOutput));
            if (converter != null)
            {
                output = (TOutput)converter.ConvertFromString(input);
            }
        }
        catch { }

        return output;
    }
} 
```

对于我的使用，我将输出限制为可转换类型之一：[https](https://docs.microsoft.com/en-us/dotnet/api/system.iconvertible?view=net-5.0) ://docs.microsoft.com/en-us/dotnet/api/system.iconvertible?view=net-5.0 。例如，我不需要疯狂的逻辑来将字符串转换为类。

要使用它将字符串转换为 int：

```
using FluentAssertions;
using Xunit;

[Theory]
[InlineData("0", 0)]
[InlineData("1", 1)]
[InlineData("123", 123)]
[InlineData("-123", -123)]
public void ValidStringWithNoDefaultValue_ReturnsExpectedResult(string input, int expectedResult)
{
    var result = input.AsOrDefault<int>();

    result.Should().Be(expectedResult);
}

[Theory]
[InlineData("0", 999, 0)]
[InlineData("1", 999, 1)]
[InlineData("123", 999, 123)]
[InlineData("-123", -999, -123)]
public void ValidStringWithDefaultValue_ReturnsExpectedResult(string input, int defaultValue, int expectedResult)
{
    var result = input.AsOrDefault(defaultValue);

    result.Should().Be(expectedResult);
}

[Theory]
[InlineData("")]
[InlineData(" ")]
[InlineData("abc")]
public void InvalidStringWithNoDefaultValue_ReturnsIntegerDefault(string input)
{
    var result = input.AsOrDefault<int>();

    result.Should().Be(default(int));
}

[Theory]
[InlineData("", 0)]
[InlineData(" ", 1)]
[InlineData("abc", 234)]
public void InvalidStringWithDefaultValue_ReturnsDefaultValue(string input, int defaultValue)
{
    var result = input.AsOrDefault(defaultValue);

    result.Should().Be(defaultValue);
} 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2015-07-06T11:17:10.457

您可以尝试以下方法。它将起作用：

```
int x = Convert.ToInt32(TextBoxD1.Text); 
```

变量 TextBoxD1.Text 中的字符串值将被转换为 Int32 并存储在 x 中。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2017-10-18T12:46:28.107

方法一

```
int  TheAnswer1 = 0;
bool Success = Int32.TryParse("42", out TheAnswer1);
if (!Success) {
    Console.WriteLine("String not Convertable to an Integer");
} 
```

方法二

```
int TheAnswer2 = 0;
try {
    TheAnswer2 = Int32.Parse("42");
}
catch {
    Console.WriteLine("String not Convertable to an Integer");
} 
```

方法 3

```
int TheAnswer3 = 0;
try {
    TheAnswer3 = Int32.Parse("42");
}
catch (FormatException) {
    Console.WriteLine("String not in the correct format for an Integer");
}
catch (ArgumentNullException) {
    Console.WriteLine("String is null");
}
catch (OverflowException) {
    Console.WriteLine("String represents a number less than"
                      + "MinValue or greater than MaxValue");
} 
```

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2018-01-02T11:10:31.997

此代码在 Visual Studio 2010 中适用于我：

```
int someValue = Convert.ToInt32(TextBoxD1.Text); 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2021-01-21T12:21:31.740

虽然我同意使用该`TryParse`方法，但很多人不喜欢使用`out`参数（包括我自己）。将元组支持添加到 C# 后，另一种方法是创建一个扩展方法，该方法将限制您使用`out`单个实例的次数：

```
public static class StringExtensions
{
    public static (int result, bool canParse) TryParse(this string s)
    {
        int res;
        var valid = int.TryParse(s, out res);
        return (result: res, canParse: valid);
    }
} 
```

（来源：[C# 如何将字符串转换为 int](https://blog.elmah.io/csharp-how-to-convert-a-string-to-int/)）

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2021-12-06T13:24:44.023

```
using System;
class HelloWorld {
static void Main()
{
 int experience = 0;
 Console.WriteLine("How many years of experience do you have?");
 var years = Console.ReadLine();
 Int32.TryParse(years, out experience);
 if (experience == 0)
     Console.WriteLine("Inexperienced");
else if (experience == 1)
     Console.WriteLine("Junior");
else if (experience == 2)
     Console.WriteLine("Intermediate");
else if (experience == 3)
     Console.WriteLine("Advanced");
else
     Console.WriteLine("Senior");
   }
} 
```

* * *

## 回答 #34

> 赞同：-3
> 
> 时间：2016-10-27T11:10:11.323

这可能对你有帮助；D

```
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        float Stukprijs;
        float Aantal;
        private void label2_Click(object sender, EventArgs e)
        {

        }

        private void button2_Click(object sender, EventArgs e)
        {
            MessageBox.Show("In de eersre textbox staat een geldbedrag." + Environment.NewLine + "In de tweede textbox staat een aantal." + Environment.NewLine + "Bereken wat er moetworden betaald." + Environment.NewLine + "Je krijgt 15% korting over het bedrag BOVEN de 100." + Environment.NewLine + "Als de korting meer dan 10 euri is," + Environment.NewLine + "wordt de korting textbox lichtgroen");
        }

        private void button1_Click(object sender, EventArgs e)
        {
            errorProvider1.Clear();
            errorProvider2.Clear();
            if (float.TryParse(textBox1.Text, out Stukprijs))
            {
                if (float.TryParse(textBox2.Text, out Aantal))
                {
                    float Totaal = Stukprijs * Aantal;
                    string Output = Totaal.ToString();
                    textBox3.Text = Output;
                    if (Totaal >= 100)
                    {
                        float korting = Totaal - 100;
                        float korting2 = korting / 100 * 15;
                        string Output2 = korting2.ToString();
                        textBox4.Text = Output2;
                        if (korting2 >= 10)
                        {
                            textBox4.BackColor = Color.LightGreen;
                        }
                        else
                        {
                            textBox4.BackColor = SystemColors.Control;
                        }
                    }
                    else
                    {
                        textBox4.Text = "0";
                        textBox4.BackColor = SystemColors.Control;
                    }
                }
                else
                {
                    errorProvider2.SetError(textBox2, "Aantal plz!");
                }

            }
            else
            {
                errorProvider1.SetError(textBox1, "Bedrag plz!");
                if (float.TryParse(textBox2.Text, out Aantal))
                {

                }
                else
                {
                    errorProvider2.SetError(textBox2, "Aantal plz!");
                }
            }

        }

        private void BTNwissel_Click(object sender, EventArgs e)
        {
            //LL, LU, LR, LD.
            Color c = LL.BackColor;
            LL.BackColor = LU.BackColor;
            LU.BackColor = LR.BackColor;
            LR.BackColor = LD.BackColor;
            LD.BackColor = c;
        }

        private void button3_Click(object sender, EventArgs e)
        {
            MessageBox.Show("zorg dat de kleuren linksom wisselen als je op de knop drukt.");
        }
    }
} 
```

# php - MySQL 无法创建新线程 (errno 12)

> ID：1019799
> 
> 赞同：0
> 
> 时间：2009-06-19T20:03:55.747
> 
> 标签：php, mysql, centos, performance

我正在使用 Plesk 运行 MySQL 5.0.45/PHP 版本 5.2.6/CentOS。

我偶尔会听到“无法创建新线程（errno 12）；如果您没有用完可用内存，您可以查阅手册以了解可能与操作系统相关的错误”

全局内存不是问题，因为我有大约 620M 可用空间。

有谁知道这可能是什么原因？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T08:31:11.313

这是[错误 20815](http://bugs.mysql.com/bug.php?id=20815)，mysql 为线程使用了太多的堆栈空间。尝试至少升级到 5.0.48 或 5.1.21。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T20:05:54.447

任何 ulimit 样式限制？

否则会想到 AppArmor 或类似的东西。

# sharepoint - 需要技术推荐/建议

> ID：1019809
> 
> 赞同：5
> 
> 时间：2009-06-19T20:06:05.960
> 
> 标签：sharepoint, workflow, workflow-foundation, business-process-management

我的公司需要一个任务管理系统来处理从“为X购买一台计算机”到“将一个人转移到另一个国家”这样简单的场景。简单的场景是由一个人处理的单个任务，而更大的任务可以分解为在工作流程中委派给多个人的多个子任务。此外，客户和供应商需要对流程有自己的看法。

我们正在评估不同的解决方案，从基于 Workflow Foundation 构建的自定义应用程序到 SharePoint，再到 Metastorm 和 BPM.Net 等 BPM 产品。

以下是我目前对这些解决方案的理解：

1.  **Workflow Foundation** - 没有宿主环境的低级工作流设计器和/或库。如果我们走这条路，比如容错和文档管理，似乎我们必须重新发明一些轮子。堆栈上的一些答案也引起了一些担忧，例如缺乏版本控制和对 VS10/.NET 4.0 的全面检修
2.  **SharePoint** - 专为文档管理和协作而构建，但试图在此之上创建高级工作流和任务似乎是一种 hack。此外，所有工作流程都必须与文档或列表相关联。我无法想象一个列表（或列表列表）如何解决这个问题。
3.  **BPM 产品**——成熟的工作流引擎，价格看似很高。BPM.Net 是我可以找到某种程度的技术细节的唯一解决方案，但我仍然不确定针对该产品进行开发与针对 Workflow Foundation 进行开发有何不同。

是否有任何工作流引擎专门用于解决所有工作流难题，可以使用自己的托管环境轻松部署并通过 Web 服务启动？

我还有其他选择吗？

提前致谢。

****编辑**

要回答下面的问题，工作流程的需求很轻。将任务基本路由到审批者和分包商。驱使我们比 PM 软件更深入的原因是业务的性质，而不是对高级工作流程的需求。我们基本上从事通过分包商为我们的客户采购商品和服务的业务，其中还包括全部员工搬迁。包的界面应该通过客户品牌以及对该业务线的直观来反映这一点。

基本上，如果我将我的家人搬到世界的另一端，我不确定我是否想与 Jira 或 Sharepoint 或任何其他 PM 软件进行交互以促进这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-13T10:53:17.233

如果您在 Microsoft 堆栈上，我绝对会推荐 SharePoint 用于这种情况。由于它看起来很简单，您可以使用 Windows SharePoint Services 版本，因为它是免费的，并且拥有您需要的一切。

当您说 ShartePoint 工作流程有点受限时，您是对的。恕我直言，克服该限制的最佳方法是购买[Nintex 工作流程](http://www.nintex.com/en-US/Products/Pages/Workflow2007.aspx)来创建您的工作流程。它是一种具有成本效益的解决方案，可以帮助您设计所需的工作流程。您可以在产品内部（作为工作流模板）和网站上找到工作流示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-02T20:39:12.013

无法保证质量，因为我没有使用它，但我确实观看了[Intalio](http://www.intalio.com/)的在线演示视频，它具有 BPM 和工作流功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T21:02:21.493

您提到的任何内容都与工作流程无关。你只是在做项目管理。如果是这种情况，一个简单的错误跟踪器（如 FogBugz！;）会起作用 - 但如果您要在外部展示它，它可能不是最专业的演示。

我能想到的最接近现成的解决方案是[Project Server——](http://office.microsoft.com/en-us/projectserver/HA102032191033.aspx)不过，根据项目和项目经理的数量，与客户端视图同步到 Web 服务器的桌面项目可能就足够了。

如果这太过分了——因为你的项目不需要大量的资源调度、甘特图或其他 PM 工件——你可以使用 Trac 之类的东西并将“bug”替换为“task”。;)（说真的，那可能会让你走完 90% 的路.....）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-24T19:49:40.113

你看过[RT](http://bestpractical.com/rt/)吗？我相信它可以满足您的所有要求，包括它旨在让客户通过电子邮件与系统交互，而不必登录网站。如果您向 IT 支持部门发送了电子邮件，那么您可能在不知情的情况下与其进行了交互……您还可以完全自定义 Web 界面并允许客户访问。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-09-11T04:20:29.777

我们使用 Basecamp 来控制这种“任务管理”的东西。我不确定它是否完全满足您的需求，因为它在文档管理方面有点轻，但它具有 Web 服务 (REST) API、面向客户/供应商的组件以及基本的交互/聊天功能。

关于它的最好的部分是 API 非常简单，您可以通过提供自定义脚本将其大量“管理”卸载给管理支持人员，如助理和实习生。如果你有不是程序员的人使用它，你可能会比 Trac 或 FogBugz 更幸运。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-04T19:20:43.953

下一个版本的 Windows 工作流将拥有自己的运行时环境，代号为 dublin，并将提供一个进入工作流的 WCF 接口。

如果您的时间范围允许，您可以使用它。

有关 Dublin 和 WF 下一版本的信息，请参阅：

[http://www.microsoft.com/net/dublin.aspx](http://www.microsoft.com/net/dublin.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-09T18:34:28.617

我投票给 FogBugz。除非我在您的要求中遗漏了某些内容，否则为什么要通过使用基于代码的工作流解决方案来重新发明轮子，当您可以使用完美的项目依赖解决方案（如 FB 甚至 MS Project Server）时，您必须自己编写流程- 它可以让您为资源和人员创建良好的依赖关系。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-09-09T07:44:32.700

我有/正在经历类似的过程。我们想要一个轻量级的工作流程供我们的销售团队内部使用。我们查看的大多数第三方应用程序，尤其是 K2 和 Skelta BPM.Net，对于我们需要的东西来说都远远超过了顶部。我现在使用 Windows Workflow Foundation 3.0 已经 2 个月了，我不得不说这不是我所拥有的最愉快的编码体验。

如果您的工作流程真的很简单，那么构建工作流程并将其连接到 UI 的某些网页是非常容易的。但是，如果您需要能够即时更改它，或者进行版本控制（即用户说我们想要添加另一个步骤，那么它需要大量的黑客攻击才能让它工作 - 只有当您限制您的工作流程时它才有效变得非常简单），那么你需要做一些工作。如果您使用 Oracle 数据库，请忘记它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-09-09T18:42:33.433

检查[文件网](http://www-01.ibm.com/software/data/content-management/filenet-business-process-manager/)

FileNet 很昂贵，但在内容和流程管理方面做得很好，但我想这不是您想要的。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-06-19T20:11:23.563

我们使用[Captaris Workflow](http://www.captaris.com/workflow/index.html)，它非常好，但对于您的需求来说可能很昂贵。

# .net - 如何自定义 Linq2SQL 实体的属性？

> ID：1019814
> 
> 赞同：1
> 
> 时间：2009-06-19T20:07:34.880
> 
> 标签：.net, linq-to-sql

我知道您可以通过部分类自定义实体，但是修改实体属性的一般方法是什么？如果我想更改 get/set 中的逻辑怎么办？添加属性呢？我不想编辑自动生成的代码 - 人们如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T20:19:02.937

根本不自动生成代码。您可以在不使用设计器的情况下构建自己的 linq to sql 类。

编辑：我这样做的懒惰方式是自动生成代码，将其复制粘贴到非生成文件中，然后删除设计器文件。不过取决于你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T20:19:30.737

Linq2SQL 类是*部分类*，这意味着您可以通过添加自己的单独文件并在其中声明部分类的另一部分来轻松扩展它们。

在该文件中，您可以根据需要自定义类 - 由于它是一个单独的文件，因此代码生成不会覆盖它。

例如，如果您查看 AdventureWorks 数据库中的“Contact”类，Linq2SQL 将在您的 AdventureWorks.designer.cs 文件中生成该类：

```
[Table(Name="Person.Contact")]
public partial class Contact : INotifyPropertyChanging, INotifyPropertyChanged
{ 
```

现在您可以将“Contact.cs”文件添加到您的项目中，并扩展该部分类，例如通过引入新属性“DisplayName”：

```
public partial class Contact 
{
       public string DisplayName
       {  
          get { return string.Format("{0} {1}", FirstName, LastName); }
       }
    } 
```

在编译时，类的这两个部分合并在一起。

另一部分是部分方法 - 可供您实现的方法，但如果它们没有实现，编译器会优化对它们的调用。

对于 Linq2SQL 中的每个对象类，正在创建大量的部分方法（.NET 3.0 中的一个新特性）——由您来实现这些方法！

```
partial void InsertContact(Contact instance);
partial void UpdateContact(Contact instance);
partial void DeleteContact(Contact instance);

partial void OnLoaded();
partial void OnValidate(System.Data.Linq.ChangeAction action);
partial void OnCreated();

partial void OnFirstNameChanging(string value);
partial void OnFirstNameChanged();

partial void OnLastNameChanging(string value);
partial void OnLastNameChanged(); 
```

大量的扩展点！

马克

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-20T00:15:00.917

看一下这个：

它比 sqlmetal 好得多（这是设计师用来生成代码的）

[http://plinqo.com/default.aspx?AspxAutoDetectCookieSupport=1](http://plinqo.com/default.aspx?AspxAutoDetectCookieSupport=1)

虽然需要 Codesmith 许可证，但恕我直言，非常值得。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T20:23:50.870

由于 Linq2Sql 实体不是密封的，您可以从 Linq2Sql 类派生并在派生类中进行更改。

在我的项目中，我不会对 Linq2Sql 类进行任何更改。相反，我建立了自己的一套 POCO，我可以根据自己的需要进行定制。然后我使用 Linq2Sql 仅使用存储库模式填充/持久化我的 POCO。

Rob Connery 在他的博客 ASP.NET MVC Storefront 上有一个很棒的网络广播系列。在第一个网络广播中，他介绍了将 Linq2Sql 与 POCO 结合使用作为存储库

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-09-30T20:52:44.253

如果没有一些严重的黑客攻击，就不可能在未标记为虚拟的类中修改 get/set 属性中的逻辑（查看模拟框架以获取如何绕过这些限制的示例）。这就是将某些东西标记为虚拟的全部意义，使其可以以虚拟调用和性能损失为代价而被消耗掉。

但是，**元数据**类型标签将允许您使用无法修改的属性注释现有类：

**注意：从**[这个相关问题](https://stackoverflow.com/questions/393687/how-can-i-add-my-attributes-to-code-generated-linq2sql-classes-properties)中窃取

```
[MetadataType (typeof (BookingMetadata))]
public partial class Booking
{
 // This is your custom partial class     
}

public class BookingMetadata
{
 [Required] [StringLength(15)]
 public object ClientName { get; set; }

 [Range(1, 20)]
 public object NumberOfGuests { get; set; }

 [Required] [DataType(DataType.Date)]
 public object ArrivalDate { get; set; }
} 
```

# delphi - 志愿者翻译对 Delphi 2009 应用程序进行本地化的过程？

> ID：1019822
> 
> 赞同：7
> 
> 时间：2009-06-19T20:09:06.250
> 
> 标签：delphi, localization, internationalization, delphi-2009, translation

我有一个免费的科学应用程序，被近 100 个国家/地区的数千人使用。许多人提出免费翻译。现在 D2009 使这变得更容易（通过集成和外部本地化工具，加上原生 Unicode 支持），我想为几种语言实现这一点，并稳步添加尽可能多的用户精力支持。

我想我会分发一个包含要翻译的字符串列表（数十个但不是数百个）的电子表格，让他们返回它，并比较 2-3 个用户以相同语言提交的内容，然后通过协商一致解决差异. 然后，我将使用集成翻译环境合并本地化，并分发本地化更新。

有人将翻译委托给用户吗？任何陷阱，特定于 D2009 还是其他？

编辑：有没有人将 D2009 内置的本地化支持与 dxgettext 进行比较？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-20T05:25:07.153

我从来都不是免费软件或开源应用程序的专有本地化工具的朋友。使用[dxgettext](http://dxgettext.po.dk/)，[GNU gettext](http://www.gnu.org/software/gettext/)的 Delphi 端口对我来说似乎是一个更好的选择：

*   集成到程序中（甚至比它的开发晚得多）很容易。
*   可翻译字符串的提取可以通过命令行程序完成，因此很容易引入到自动构建中。
*   只需创建一个具有正确结构的新目录，将空的翻译文件复制到其中，然后开始翻译字符串，就可以添加新的翻译。这是每个用户都可以自己做的事情，不需要原作者参与创建新的翻译。这个过程也有即时的满足感——一旦程序重新启动，新的翻译就会立即显示出来。
*   更改现有翻译比创建新翻译更容易。因此，如果用户发现拼写或其他错误或需要改进翻译，他们可以轻松地更正它们并将更改发送给作者。
*   新的程序版本与旧的翻译一起工作，系统非常优雅地降级 - 新的和未翻译的字符串简单地显示为未修改。
*   只能使用记事本进行翻译，但也有一些免费工具可用于创建和管理翻译文件；请参阅 dxgettext 页面上的链接。它们本身是本地化的，并且与电子表格相比也有一些优势：
    *   可以显示源代码中字符串的位置（当然，仅对开源应用程序有意义）。
    *   显示已翻译字符串的百分比。
    *   对已翻译字符串的修改也会突出显示。
*   整个系统成熟且面向未来——我在 Delphi 4 程序中使用了 dxgettext，甚至对于 Delphi 2009 也不应该进行任何更改——翻译文件一直是 UTF-8 编码的。

一旦您拥有多种语言，使用电子表格进行翻译对我来说似乎不是一个可行的解决方案。假设一个新的程序版本添加了 2 个新字符串并仅稍微更改了 10 个字符串 - 您是否不需要在所有几十个电子表格文件中添加新字符串并突出显示更改的字符串，然后再次将它们发送给您的翻译人员？使用 dxgettext 您只需将更改后的 po 文件邮寄给所有人。

**编辑：**

关于 dxgettext 和库可能存在的问题，有一个有趣的评论。我从来没有遇到过这种情况，因为我已经完全停止使用资源字符串了。我们的课程大部分是德语，只有少数是英语或翻译成多种语言。

我们的内部库在所有可翻译字符串周围使用“_(...)”。有定义`ENGLISH`，并且`USEGETTEXT`是在每个项目的基础上设置的。如果定义`ENGLISH`或`USEGETTEXT`，则将英文文本编译到 DCU 中，否则将德语文本编译到 DCU 中。如果`USEGETTEXT`未定义“_()”被编译为按原样返回其参数的函数，否则使用 dxgettext 翻译查找。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-19T22:16:07.023

我有......可能会有一些挑战。

*   字符串本身并没有多大意义，它需要一个上下文。
*   推论，同一个字符串可能需要有多个翻译。
*   屏幕空间：注意不同语言的长度，例如，法语往往比英语更冗长。
*   除非您精通给定语言，否则您将无法评估差异。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-20T08:40:41.730

我使用[TsiLang Translation Suite](http://www.sicomponents.com/tsilang1.html)使最终用户能够进行翻译。我修改了代码以允许加密，这样如果有人做得很好，他们可以保护他们的名字免受翻译文件的影响，但总的来说，这个想法是人们可以分享他们的翻译，并添加/编辑他们想要的任何小部分。鉴于这一切都发生在应用程序中，并且具有即时可见性，因此它运行得非常好。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-20T08:51:10.150

正如您所提到的，D2009 带有本地化工具。为什么不简单地使用它们？AFAIK 您可以分发外部翻译管理器（etm.exe）。你还需要什么别的吗？

此外，本地化不仅仅是翻译文本。ETM 还支持 .dfm 资源的翻译。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-23T05:49:08.457

为了完整起见，这是我最近发现的另一个名为[Delphi Localizer的 Delphi 本地化工具，它看起来设计和完善。](http://www.wischnewski.tv/en/products/dw32pl.html)该工具可免费用于商业用途，但政府项目除外（不完全确定为什么会例外）。

FWIW 我过去使用过 TsiLang Translation Suite，目前正在使用 DevExpress VCL 附带的本地化工具进行另一个项目。后者与他们的组件以及第三方组件很好地集成。

# c# - 如何模拟 Elmah 的 ErrorSignal 例程？

> ID：1019833
> 
> 赞同：17
> 
> 时间：2009-06-19T20:10:53.720
> 
> 标签：c#, asp.net-mvc, mocking, elmah

我们使用 ELMAH 来处理我们的 ASP.Net MVC c# 应用程序中的错误，并且在我们捕获的异常中，我们正在做这样的事情：

```
ErrorSignal.FromCurrentContext().Raise(exception); 
```

但是当我尝试对捕获的异常进行单元测试时，我收到以下消息：

```
System.ArgumentNullException: Value cannot be null.
Parameter name: context 
```

如何模拟 FromCurrentContext() 调用？还有其他我应该做的事情吗？

仅供参考...我们目前正在使用 Moq 和 RhinoMocks。

谢谢！

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-08-11T20:07:34.177

由于该`FromCurrentContext()`方法是静态方法，因此您不能简单地模拟对它的调用。你还有另外两个选择。

1.  由于`FromCurrentContext()`内部调用`HttpContext.Current`您可以在其中推送一个虚假的上下文。例如：

    ```
    SimpleWorkerRequest request = new SimpleWorkerRequest(
        "/blah", @"c:\inetpub\wwwroot\blah", "blah.html", null, new StringWriter());

    HttpContext.Current= new HttpContext(request); 
    ```

    有了这个，它不应该再抛出异常，因为`HttpContext.Current`它不为空。

2.  围绕对 Raise 的调用创建一个包装器类，然后模拟包装器类。

    ```
    public class ErrorSignaler {

        public virtual void SignalFromCurrentContext(Exception e) {
            if (HttpContext.Current != null)
                Elmah.ErrorSignal.FromCurrentContext().Raise(e);
        } 
    } 
    ```

# python - Python中的子类化

> ID：1019834
> 
> 赞同：-3
> 
> 时间：2009-06-19T20:11:03.530
> 
> 标签：python, subclassing

是否可以动态子类化？我知道有____bases____，但我不想影响该类的所有实例。我希望对象 cf 变形为 DrvCrystalfontz 类的 mixin。进一步进入层次结构的是 gobject 的一个子类，它需要在此级别可用以连接信号，而下面的解决方案是不够的。

```
class DrvCrystalfontz:
    def __init__(self, model, visitor, obj=None, config=None):
        if model not in Models.keys():
            error("Unknown Crystalfontz model %s" % model)
            return
        self.model = Models[model]
        if self.model.protocol == 1:
            cf = Protocol1(self, visitor, obj, config)
        elif self.model.protocol == 2:
            cf = Protocol2(self, visitor, obj, config)
        elif self.model.protocol == 3:
            cf = Protocol3(self, visitor, obj, config)
        for key in cf.__dict__.keys():
            self.__dict__[key] = cf.__dict__[key] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T20:29:59.420

我不确定我是否清楚您在这里想要的用途，但可以动态地进行子类化。您可以使用该`type`对象动态构造一个给定名称、基类元组和方法/类属性字典的类，例如：

```
>>> MySub = type("MySub", (DrvCrystalfontz, some_other_class), 
         {'some_extra method' : lamba self: do_something() }) 
```

MySub 现在是 and 的子类`DrvCrystalfontz`，`some_other_class`继承了它们的方法，并添加了一个新方法（“ `some_extra_method`”）。

# c# - C#防止自定义小部件上的Delete键触发菜单上的快捷方式

> ID：1019835
> 
> 赞同：0
> 
> 时间：2009-06-19T20:11:15.903
> 
> 标签：c#, visual-studio, user-interface

在 C# 桌面应用程序中，我有一个包含文本框的客户小部件。我在菜单条上还有一个菜单项，它的快捷键是 Delete 键。我发现的行为是在文本框中按下删除，用户希望删除一个字符，实际上是触发菜单项并删除他们正在处理的整个对象。

有没有办法让文本框在处理按键而不是菜单项时“首先破解”？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T20:30:19.233

我会将“删除整个事物”菜单项的快捷键更改为 Shift-Del 或 Ctrl-Del ......或者让用户删除整个对象的工作量更大一些。

如果这不是一个选项，您可以在 MenuStrip 的删除代码中检查表单的 ActiveControl，如果它是您的 TextBox，请检查 Textbox.SelectionStart 值以获取光标在文本中的位置并手动删除字符：

```
if (myTextBox.Text.Length() >0) {
  int pos = myTextBox.SelectionStart;
  string txt = myTextBox.Text;
  if (pos < txt.Length()) {
     myTextBox.Text = txt.Substring(0,txt.Substring(0, pos-1) + txt.substring(pos+1);
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T20:31:30.527

您是否在表单级别处理删除键？无论哪种方式，您都可以检查具有焦点的小部件，然后不处理该事件。最好不要将删除用作全局快捷方式，这似乎与重新分配 ctrl+c、alt+f4 或 tab 的作用类似。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-26T14:31:13.010

**我们做了什么**

我们最终使用的解决方案是禁用这些菜单项，从而禁用它们各自的快捷键，当这些菜单项打算作用于控件时。

这解决了在不相关的文本框中单击删除会删除主小部件中的选定项目的问题。但是，它引入了用户必须单击主窗口小部件才能访问这些菜单项的问题。为了稍微解决这个问题，我确实做到了，当带有可隐藏小部件的面板被隐藏时，主小部件重新获得焦点。

我不提倡这种解决方案，只是为了完整性而包含它。

**我会喜欢的**

我的最终解决方案是仅在以下情况下才执行该操作：

1.  主小部件有焦点，或者
2.  事件是通过单击菜单项触发的

但似乎没有办法检测偶数是否由框架内的快捷键触发。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T20:53:29.170

在窗体上将 KeyPreview 设置为 False。

客户小部件可能会打开它，因此您可能必须在文本框获得焦点时禁用表单上的 KeyPreview（并在失去焦点时重新启用它）。

否则，从设计器中禁用它应该可以工作。

# java - Java 编码 SHA-1 字节数组

> ID：1019837
> 
> 赞同：1
> 
> 时间：2009-06-19T20:11:42.640
> 
> 标签：java, encode, sha

我有一个 SHA-1 字节数组，我想在 GET 请求中使用它。我需要对此进行编码。`URLEncoder`需要一个字符串，如果我创建一个字符串然后对其进行编码，它会损坏吗？

澄清一下，这是对我的另一个问题的跟进。（[Bitorrent Tracker Request](https://stackoverflow.com/questions/1019454/bitorrent-tracker-request)）我可以将值作为十六进制字符串获取，但跟踪器无法识别。另一方面，提供的编码答案标记返回 200 OK。

所以我需要转换我得到的十六进制表示：

```
9a81333c1b16e4a83c10f3052c1590aadf5e2e20 
```

编码形式

```
%9A%813%3C%1B%16%E4%A8%3C%10%F3%05%2C%15%90%AA%DF%5E.%20 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T20:43:08.617

**我在回复时编辑了问题，以下是附加代码，应该可以工作（使用我的十六进制转换代码）：**

```
//Inefficient, but functional, does not test if input is in hex charset, so somewhat unsafe
//NOT tested, but should be functional
public static String encodeURL(String hexString) throws Exception {
  if(hexString==null || hexString.isEmpty()){
     return "";
  }
  if(hexString.length()%2 != 0){
    throw new Exception("String is not hex, length NOT divisible by 2: "+hexString);
  }
  int len = hexString.length();
  char[] output = new char[len+len/2];
  int i=0;
  int j=0;
  while(i<len){
      output[j++]='%';
      output[j++]=hexString.charAt(i++);
      output[j++]=hexString.charAt(i++);
  }
  return new String(output);
} 
```

您需要将原始字节转换为十六进制字符或它们使用的任何 URL 友好编码。Base32 或 Base64 编码是可能的，但直接的十六进制字符是最常见的。此字符串不需要 URLEncoder，因为它不应包含任何需要将 URL 编码为 %NN 格式的字符。

下面会将散列（SHA-1、MD5SUM 等）的字节转换为十六进制字符串：

```
/** Lookup table: character for a half-byte */
    static final char[] CHAR_FOR_BYTE = {'0','1','2','3','4','5','6','7','8','9','A','B','C','D','E','F'};
         /** Encode byte data as a hex string... hex chars are UPPERCASE*/
         public static String encode(byte[] data){
             if(data == null || data.length==0){
                 return "";
             }
             char[] store = new char[data.length*2];
             for(int i=0; i<data.length; i++){
                 final int val = (data[i]&0xFF);
                 final int charLoc=i<<1;
                 store[charLoc]=CHAR_FOR_BYTE[val>>>4];
                 store[charLoc+1]=CHAR_FOR_BYTE[val&0x0F];
             }
             return new String(store);
         } 
```

这段代码经过了相当优化和快速，我将它用于我自己的 SHA-1 字节编码。请注意，您可能需要使用 String.toLowerCase() 方法将大写转换为小写，具体取决于服务器接受的格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T20:23:47.297

这取决于您的请求的接收者期望什么。我想它可能是哈希中字节的十六进制表示。字符串可能不是最好的主意，因为哈希数组很可能包含不可打印的字符值。

我会遍历数组并使用 Integer.toHexValue() 将字节转换为十六进制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T20:24:56.717

SHA1 是十六进制格式 [0-9a-f]，应该不需要 URLEncode。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-20T01:14:33.200

使用[Apache Commons-Codec](http://commons.apache.org/codec/userguide.html)来满足您的所有编码/解码需求（ASN.1 除外，这很麻烦）

# regex - 当我第一次发现不需要的东西时，如何使正则表达式不匹配

> ID：1019839
> 
> 赞同：1
> 
> 时间：2009-06-19T20:12:13.747
> 
> 标签：regex

我想使用正则表达式在我的示例中查找特定字符串，但如果我首先找到另一个字符串，我希望正则表达式失败。让我举个例子吧：

`find_me`仅当我们没有第一次遇到时才匹配`stop_here`。（我不在乎是否`stop_here`在示例中稍后发生。）

所以，这应该匹配：

`blah blah find_me blah stop_here`

但这不应该：

`blah blah stop_here blah find_me`

（我正在使用 .NET 正则表达式引擎）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-19T20:15:58.000

```
^(?:(?!stop_here).)*find_me 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T20:26:19.757

不确定 .NET 正则表达式引擎，但我只会对 find_me 或 stop_here 进行正则表达式搜索，然后检查哪个匹配。在 perl 中：

```
if ($stuff =~ /(find_me|stop_here)/) {
  if ($1 == "find_me") {
    ...
  } elsif ($1 == "stop_here") {
    ...
  }
} 
```

# iphone - 试图在没有NIB的情况下让UILabel显示在视图中

> ID：1019843
> 
> 赞同：2
> 
> 时间：2009-06-19T20:15:17.267
> 
> 标签：iphone

我是 iPhone 编程的新手，我正在尝试制作一个没有 NIB 的简单程序。我已经完成了一些 NIB 教程，但我想以编程方式尝试一些事情。

我的代码加载没有错误，使状态栏变黑，并使背景变白。但是，我认为在那之后我没有正确地用标签加载我的视图。我想我在做一些根本错误的事情，所以如果你能指出我正确的方向，我会很感激。我想如果我能让标签显示出来，我会得到一些理解。这是我的代码：

```
//helloUAppDelegate.h
#import <UIKit/UIKit.h>
#import "LocalViewController.h"

@interface helloUAppDelegate : NSObject <UIApplicationDelegate> {
    UIWindow *window;
    LocalViewController *localViewController;
}

@property (nonatomic, retain) UIWindow *window;
@property (nonatomic, retain) LocalViewController *localViewController;

@end

//helloUApDelegate.m
#import "helloUAppDelegate.h"

@implementation helloUAppDelegate

@synthesize window, localViewController;

- (void)applicationDidFinishLaunching:(UIApplication *)application {   
    application.statusBarStyle = UIStatusBarStyleBlackOpaque;
    window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    if (!window) {
        [self release];
        return;
    }
    window.backgroundColor = [UIColor whiteColor];

    localViewController = [[LocalViewController alloc] init];

    [window addSubview:localViewController.view];

    // Override point for customization after application launch
    [window makeKeyAndVisible];
}

//LocalViewController.h
#import <UIKit/UIKit.h>

@interface LocalViewController : UIViewController {
    UILabel *myLabel;   
}

@property (nonatomic, retain) UILabel *myLabel;

@end

//LocalViewController.m
#import "LocalViewController.h"

@implementation LocalViewController

@synthesize myLabel;

// Implement loadView to create a view hierarchy programmatically, without using a nib.
- (void)loadView {
    self.myLabel = [[UILabel alloc] initWithFrame:CGRectMake(50, 100, 200, 100)];      
    self.myLabel.text = @"Lorem...";
    self.myLabel.textColor = [UIColor redColor];
}

- (void)dealloc {
    [super dealloc];
    [myLabel release];
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T20:26:19.740

将标签添加到 LocalViewController 的视图中：

```
- (void)loadView {
    [super loadView];
    self.myLabel = [[UILabel alloc] initWithFrame:CGRectMake(50, 100, 200, 100)];      
    self.myLabel.text = @"Lorem...";
    self.myLabel.textColor = [UIColor redColor];
    [self addSubview:self.myLabel];
    [self.myLabel release];     // since it's retained after being added to the view
} 
```

# python - Python - 配置选项，如何输入/处理？

> ID：1019850
> 
> 赞同：3
> 
> 时间：2009-06-19T20:16:15.923
> 
> 标签：python, options, optional-parameters

当您的应用程序需要几个（〜5）配置参数，并且该应用程序将被非技术用户（即[KISS](http://en.wiktionary.org/wiki/KISS)）使用时，您通常如何处理读取配置选项，然后在对象/函数之间传递参数（多个模块）？

选项示例：输入和输出目录/文件名、详细级别。

我通常使用`optparse`（Python）并将选项/参数作为参数传递；但我想知道使用由所有模块的对象直接读取的配置文本文件是否更常见（但是，这不是像拥有“全局”变量吗？并且没有任何人“拥有”状态？） .

另一个典型问题是单元测试；如果我想独立地对每个模块进行单元测试，一个特定的模块可能只需要 5 个配置选项中的 1 个；您通常如何将单个模块/对象与应用程序的其余部分分离，但仍允许它接受 1 或 2 个必需参数（单元测试框架是否以某种方式调用或接管配置功能）？

我的猜测是，没有一种独特的正确方法可以做到这一点，但是阅读各种方法或众所周知的模式会很有趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T20:23:47.517

您是否通常通过以下方式阅读配置选项： - 命令行/gui 选项 - 配置文本文件

两个都。我们使用 Django 的 settings.py 和 logging.ini。我们还对最常更改的选项使用命令行选项和参数。

多个模块/对象如何访问这些选项？

*   设置.py; logging.ini - 不能说。
*   我们的选项是主程序私有的，用于
    为函数或对象初始化器构建参数。

[共享 optparse 选项是一件令人头疼的事情，并且不必要地将很多东西绑定到无法测试的混乱中。]

在对单个模块（不是“主”模块）进行单元测试时：（例如，指定输入文件名的读取选项）

[我无法解析这个问题。我假设这是“当有选项时你如何测试？”]

答案是——我们没有。由于只有 main 方法解析命令行选项，因此没有其他模块、函数或类对命令行选项有任何了解。没有此模块“需要 5 个配置选项中的 1 个”模块的类（或函数）具有普通参数，仅此而已。

我们只使用`optparse`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T20:17:00.913

```
"Counts answer"
Please update these counts and feel free to add/modify.

Do you usually read config options via:
- command-line/gui options : 1
- a config text file       : 0

How do multiple modules/objects have access to these options?
- they receive them from the caller as an argument: 1
- read them directly from the config text file:     0

When doing unit-testing of a single module (NOT the "main" module)
and the module uses one option, e.g. input filename:
- unit-test framework provides own "simplified" config functionality: 0
- unit-test framework invokes main app's config functionality:        1

Do you use:
- optparse:  1
- getopt:    0
- others?

Please list any config management "design pattern" 
(usable in Python) and add a count if you use it - thanks.
- 
- 
```

# java - Java - 不同的对象列表

> ID：1019854
> 
> 赞同：34
> 
> 时间：2009-06-19T20:17:21.053
> 
> 标签：java, list, collections

我有一个对象列表/集合，这些对象可能具有或不具有相同的属性值。获得具有相同属性的对象的不同列表的最简单方法是什么？一种集合类型最适合此目的吗？例如，在 C# 中，我可以使用 LINQ 执行以下操作。

```
var recipients = (from recipient in recipientList
                 select recipient).Distinct(); 
```

我最初的想法是使用 lambdaj（[链接文本](http://code.google.com/p/lambdaj/ "拉姆巴杰")），但它似乎不支持这一点。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-06-30T13:16:06.833

```
return new ArrayList(new HashSet(recipients)); 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-06-19T20:20:38.537

使用接口的实现`Set<T>`（类 T 可能需要自定义`.equals()`方法，您可能必须`.equals()`自己实现）。通常 a`HashSet`是开箱即用的：它使用`Object.hashCode()`和`Object.equals()`方法来比较对象。对于简单的对象，这应该足够独特。如果没有，您将不得不相应地`T.equals()`实施`T.hashCode()`。

有关帮助实现 equals 和 hashcode 的库，请参阅下面 Gaurav Saini 的评论。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-06-19T20:24:34.440

将它们放在一个包含自定义比较器的 TreeSet 中，该比较器检查您需要的属性：

```
SortedSet<MyObject> set = new TreeSet<MyObject>(new Comparator<MyObject>(){

    public int compare(MyObject o1, MyObject o2) {
         // return 0 if objects are equal in terms of your properties
    }
});

set.addAll(myList); // eliminate duplicates 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2015-04-24T02:16:52.087

爪哇 8：

```
recipients = recipients.stream()
    .distinct()
    .collect(Collectors.toList()); 
```

见[`java.util.stream.Stream#distinct`](http://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html#distinct--)。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2013-03-24T19:56:31.450

上述响应的订单保留版本

```
return new ArrayList(new LinkedHashSet(recipients)); 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-12-20T17:55:45.997

如果您使用的是[Eclipse Collections](https://github.com/eclipse/eclipse-collections)，则可以使用该方法`distinct()`。

```
ListIterable<Integer> integers = Lists.mutable.with(1, 3, 1, 2, 2, 1);
Assert.assertEquals(
    Lists.mutable.with(1, 3, 2),
    integers.distinct()); 
```

使用`distinct()`而不是转换为 Set 然后返回到 List的优点是`distinct()`保留了原始 List 的顺序，保留了每个元素的第一次出现。它是通过使用 Set 和 List 来实现的。

```
MutableSet<T> seenSoFar = Sets.mutable.with();
int size = list.size();
for (int i = 0; i < size; i++)
{
    T item = list.get(i);
    if (seenSoFar.add(item))
    {
        targetCollection.add(item);
    }
}
return targetCollection; 
```

如果您无法将原始 List 转换为 Eclipse Collections 类型，则可以使用`ListAdapter`来获取相同的 API。

```
MutableList<Integer> distinct = ListAdapter.adapt(integers).distinct(); 
```

注意：我是 Eclipse Collections 的提交者。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-06-19T20:34:43.157

您可以使用`Set`. 有几个实现：

*   `HashSet`使用对象的`hashCode`and `equals`。
*   `TreeSet`使用`compareTo`（由 定义`Comparable`）或`compare`（由 定义`Comparator`）。请记住，比较必须与 一致`equals`。有关详细信息，请参阅`TreeSet`JavaDocs。

还要记住，如果你重写`equals`，你必须重写`hashCode`，使得两个 equals 对象具有相同的哈希码。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-06-19T21:10:45.050

执行此操作的普通方法是转换为 Set，然后再转换回 List。但是您可以对[Functional Java 感兴趣](http://code.google.com/p/functionaljava)。如果你喜欢 Lamdaj，你就会喜欢 FJ。

```
recipients = recipients
             .sort(recipientOrd)
             .group(recipientOrd.equal())
             .map(List.<Recipient>head_()); 
```

您需要为收件人定义一个排序，`recipientOrd`. 就像是：

```
Ord<Recipient> recipientOrd = ord(new F2<Recipient, Recipient, Ordering>() {
  public Ordering f(Recipient r1, Recipient r2) {
    return stringOrd.compare(r1.getEmailAddress(), r2.getEmailAddress());
  }
}); 
```

即使您无法控制Recipient 类，`equals()`也可以使用。`hashCode()`

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-08-02T21:27:32.947

实际上 lambdaj 通过 selectDistinctArgument 方法实现了这个特性

[http://lambdaj.googlecode.com/svn/trunk/html/apidocs/ch/lambdaj/Lambda.html#selectDistinctArgument(java.lang.Object,%20A)](http://lambdaj.googlecode.com/svn/trunk/html/apidocs/ch/lambdaj/Lambda.html#selectDistinctArgument(java.lang.Object,%20A))

# c# - 如何在 C# 中将空格（引号内的空格除外）转换为逗号？

> ID：1019855
> 
> 赞同：2
> 
> 时间：2009-06-19T20:17:34.127
> 
> 标签：c#, string

假设我有一个这样的字符串：

```
one two three "four five six" seven eight 
```

我想把它转换成这个：

```
one,two,three,"four five six",seven,eight 
```

在 C# 中执行此操作的最简单方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-19T20:22:25.053

假设引号是不可避免的，您可以执行以下操作。

```
public string SpaceToComma(string input) { 
  var builder = new System.Text.StringBuilder();
  var inQuotes = false;
  foreach ( var cur in input ) {
    switch ( cur ) { 
      case ' ':
         builder.Append(inQuotes ? cur : ',');
         break;
      case '"':
         inQuotes = !inQuotes;
         builder.Append(cur);
         break;
      default:
         builder.Append(cur);
         break;
    }
  }
  return builder.ToString();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T20:31:50.463

```
 static string Space2Comma(string s)
 {
    return string.Concat(s.Split('"').Select
        ((x, i) => i % 2 == 0 ? x.Replace(' ', ',') : '"' + x + '"').ToArray());
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T20:20:56.617

为此，我将使用 Regex 类。

正则表达式可用于匹配您的输入，将其分解为单独的组，然后您可以根据需要重新组合。您可以在[此处找到有关正则表达式类](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regex.aspx)的文档。

```
Regex rx = new Regex( "(\w)|([\"]\w+[\"])" );
MatchCollection matches = rx.Matches("first second \"third fourth fifth\" sixth");
string.Join( ", ", matches.Select( x => x.Value ).ToArray() ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T20:32:12.537

我的第一个猜测是使用已经编写好的解析器，然后简单地更改分隔符和引号字符以满足您的需要（分别是和“）。

看起来这在 C# 中可供您使用：http: [//msdn.microsoft.com/en-us/library/microsoft.visualbasic.fileio.textfieldparser.aspx](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.fileio.textfieldparser.aspx)

也许如果您将分隔符更改为“”，它可能适合您在文件中读取的需要，然后只需为每一行调用 String.Join() a 即可。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T20:54:51.040

这是我想出的一个更可重用的功能：

```
private string ReplaceWithExceptions(string source, char charToReplace, 
    char replacementChar, char exceptionChar)
{
    bool ignoreReplacementChar = false;
    char[] sourceArray = source.ToCharArray();

    for (int i = 0; i < sourceArray.Length; i++)
    {
        if (sourceArray[i] == exceptionChar)
        {
            ignoreReplacementChar = !ignoreReplacementChar;
        }
        else
        {
            if (!ignoreReplacementChar)
            {
                if (sourceArray[i] == charToReplace)
                {
                    sourceArray[i] = replacementChar;
                }
            }
        }
    }

    return new string(sourceArray);
} 
```

用法：

```
string test = "one two three \"four five six\" seven eight";
System.Diagnostics.Debug.WriteLine(ReplaceWithExceptions(test, char.Parse(" "),
    char.Parse(","), char.Parse("\""))); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T21:00:58.203

这可能有点矫枉过正，但如果您认为问题可能泛化，例如需要按其他类型的字符进行拆分，或者有定义标记的附加规则，您应该考虑使用解析器生成器（如[Coco](http://www.ssw.uni-linz.ac.at/Research/Projects/Coco/) ）或编写一个简单的自己。例如，Coco/R 将根据您提供的 EBNF 语法构建生成词法分析器和解析器。词法分析器将是 DFA 或状态机，它是 JaredPar 提供的代码的通用形式。Coco/R 的语法定义如下所示：

```
CHARACTERS
alphanum = 'A'..'Z' + 'a'..'z' + '0'..'9'.

TOKENS
unit   = '"' {alphanum|' '} '"' | {alphanum}. 
```

然后生成的词法分析器将相应地扫描和标记您的输入。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-19T21:26:50.133

根据我对原始问题的评论，如果您不需要最终结果中的引号，这将完成工作。如果您**确实**需要引号，请随时忽略。

```
private String SpaceToComma(string input)
{
    String[] temp = input.Split(new Char[] { '"' }, StringSplitOptions.RemoveEmptyEntries);
    for (Int32 i = 0; i < temp.Length; i += 2)
    {
        temp[i] = temp[i].Trim().Replace(' ', ',');
    }
    return String.Join(",", temp);
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-19T21:36:35.450

@Mehrdad 打败了我，但我想我还是会发布它：

```
static string Convert(string input)
{
    var slices = input
        .Split('"')
        .Select((s, i) => i % 2 != 0
            ? @"""" + s + @""""
            : s.Trim().Replace(' ', ','));

    return string.Join(",", slices.ToArray());
} 
```

LINQified 和测试:-) ... 对于完整的控制台应用程序：http: [//pastebin.com/f23bac59b](http://pastebin.com/f23bac59b)

# c# - 如何在文件中查找二进制序列

> ID：1019862
> 
> 赞同：0
> 
> 时间：2009-06-19T20:19:11.567
> 
> 标签：c#, .net-3.5, binary, compression, search

> **可能重复：**
> [byte[] 数组模式搜索](https://stackoverflow.com/questions/283456/byte-array-pattern-search)

我正在尝试在 C# 和 .NET 3.5 中编写一个简单的压缩算法，并且我需要能够搜索特定文件以查找特定位序列的出现。最快的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T20:20:32.653

由于文件是 8K，我首先将所有字节读入内存数组，如下所示：

```
byte[] bytes = System.IO.File.ReadAllBytes(fileName); 
```

在此堆栈溢出条目中有要搜索的代码示例：

[byte[] 数组模式搜索](https://stackoverflow.com/questions/283456/byte-array-pattern-search)

# excel - 用于将图表插入 ppt 幻灯片的 VBA

> ID：1019864
> 
> 赞同：1
> 
> 时间：2009-06-19T20:19:32.157
> 
> 标签：excel, vba, powerpoint, office-2003

下面是我用来将图表从 excel 电子表格中提取到 ppt 中的过程。但是我无法弄清楚的一件事是如何将图片插入“对象”而不是仅仅将其粘贴到屏幕上。（即，如果我做了一个 ppLayoutFourObjects，并将四个图表发送到这张幻灯片，在添加另一个之前，我需要知道如何将图表粘贴到从 4 个对象选择中显示的每个指定矩形中）。我知道第一个似乎总是矩形五，我无法正确获取代码。请帮忙。这都是2003 Office。

```
sub xls2ppt()
'I use this to pull charts into ppt from excel   
Dim xlApp As Object
Dim xlWrkBook As Object
Dim lCurrSlide As Long
Set xlApp = CreateObject("Excel.Application")
' Open the Excel workbook
Set xlWrkBook = xlApp.Workbooks.Open("X:\Users\Admin\Desktop\Budget Overview.xls")
' Copy picture of the 1st chart object onto the clipboard
xlWrkBook.Worksheets(2).ChartObjects(1).CopyPicture
' Get the slide number
lCurrSlide = ActiveWindow.Selection.SlideRange.SlideNumber
' Paste the picture onto the PowerPoint slide.
ActivePresentation.Slides(lCurrSlide).Shapes.Paste
' Close the open workbook without saving changes
xlWrkBook.Close (False)
xlApp.Quit
Set xlApp = Nothing
Set xlWrkBook = Nothing
End Sub 
```

谢谢你的帮助。PowerPoint 的 VBA 是我最弱的，但我真的需要拿起它来工作！多谢你们！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-20T20:32:11.067

AFAIK，即使通过 UI，您也无法在 PowerPoint 中将图表“粘贴到对象中”。在 Word 中，您可以粘贴到文本框或表格单元格中，但不能在 PowerPoint 中粘贴。

相反，您需要做的是定位 4 个粘贴的图表，使它们的大小和位置正确 - 这很容易做到......

```
Set oSlide = ActivePresentation.Slides(lCurrSlide)
Set oShape = oSlide.Shapes.Paste
oShape.Top = 10
oShape.Left = 10
oShape.Width = 100
oShape.Height = 100 
```

# .net - 视图中的实体框架主键

> ID：1019865
> 
> 赞同：2
> 
> 时间：2009-06-19T20:19:41.907
> 
> 标签：.net, entity-framework, primary-key, sql-view

我必须将视图与 EF 一起使用，但是当我导入它时，视图的主键显示不正确，并且由于某种原因我无法更改它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-19T20:28:30.830

似乎是一个已知问题 - 请参阅其他 StackOverflow 问题及其答案：

[实体框架和 SQL Server 视图](https://stackoverflow.com/questions/1013333/entity-framework-and-sql-server-view-question)

马克

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-08T09:55:02.290

当我想在 linq 中不容易但最终无法工作的视图中进行分组时，我遇到了类似的问题。对我有用的是专门将实体框架设计器中的实体键更改为唯一的 int 列。如果它不存在，则在您的视图定义中创建一个简单的递增 int 字段并将其用作您的键。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-03T11:36:21.220

根据我的经验，视图上的实体键是使用视图的主键（来自 select 子句）定义的。

如果视图中有多个表，则必须选择主键，而不是外键，才能将其视为实体键。

# php - 有没有办法在不等待命令完成的情况下使用 shell_exec ？

> ID：1019867
> 
> 赞同：100
> 
> 时间：2009-06-19T20:20:03.513
> 
> 标签：php, shell

我有一个流程密集型任务，我想在后台运行。

用户点击一个页面，PHP脚本运行，最后，根据一些条件，如果需要，它必须运行一个shell脚本，例如：

```
shell_exec('php measurePerformance.php 47 844 email@yahoo.com'); 
```

目前我使用[shell_exec](http://uk.php.net/shell_exec)，**但这**需要脚本等待输出。有什么方法可以执行我想要的命令**而无需**等待它完成？

* * *

## 回答 #1

> 赞同：157
> 
> 时间：2009-06-19T20:27:34.013

怎么加。

```
"> /dev/null 2>/dev/null &"

shell_exec('php measurePerformance.php 47 844 email@yahoo.com > /dev/null 2>/dev/null &'); 
```

请注意，这也摆脱了 stdio 和 stderr。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-06-19T20:32:31.133

这将执行命令并与正在运行的进程断开连接。当然，它可以是您想要的任何命令。但是对于测试，您可以使用 sleep(20) 命令创建一个 php 文件。

```
exec("nohup /usr/bin/php -f sleep.php > /dev/null 2>&1 &"); 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-05-14T15:03:51.547

您还可以立即将输出返回给客户端，然后继续处理您的 PHP 代码。

这是我用于长时间等待的 Ajax 调用的方法，它对客户端没有任何影响：

```
ob_end_clean();
ignore_user_abort();
ob_start();
header("Connection: close");
echo json_encode($out);
header("Content-Length: " . ob_get_length());
ob_end_flush();
flush();
// execute your command here. client will not wait for response, it already has one above. 
```

你可以在这里找到详细的解释：http: [//oytun.co/response-now-process-later](http://oytun.co/response-now-process-later)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2010-02-18T03:36:44.807

在 Windows 2003 上，无需等待即可调用另一个脚本，我使用了这个：

```
$commandString = "start /b c:\\php\\php.EXE C:\\Inetpub\\wwwroot\\mysite.com\\phpforktest.php --passmsg=$testmsg"; 
pclose(popen($commandString, 'r')); 
```

这仅在授予更改权限后才有效`cmd.exe`- 添加读取和执行`IUSR_YOURMACHINE`（我还将写入设置为拒绝）。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-06-26T19:11:37.770

使用 PHP 的`popen`命令，例如：

```
pclose(popen("start c:\wamp\bin\php.exe c:\wamp\www\script.php","r")); 
```

这将创建一个子进程，脚本将在后台执行，无需等待输出。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2017-02-10T09:20:04.703

当然，`windows`你可以使用：

```
$WshShell = new COM("WScript.Shell");
$oExec = $WshShell->Run("C:/path/to/php-win.exe -f C:/path/to/script.php", 0, false); 
```

* * *

**笔记：**

如果您收到`COM`错误，请将扩展名添加到您的`php.ini`并重新启动`apache`：

```
[COM_DOT_NET]
extension=php_com_dotnet.dll 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-19T20:23:24.147

如果它不在网页上，我建议生成某种信号（也许将文件放在目录中）并让 cron 作业接手需要完成的工作。否则，我们很可能会从 Apache 进程内部进入使用`pcntl_fork()`和使用领域，这就是糟糕的魔力。`exec()`

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-19T23:58:55.570

这将起作用，但您必须小心不要使服务器超载，因为每次调用此函数时它都会创建一个新进程，该函数将在后台运行。如果同时只有一个并发呼叫，那么此解决方法将完成这项工作。

如果没有，那么我建议运行一个消息队列，例如 beanstalkd/gearman/amazon sqs。

# javascript - jquery拖拽图片

> ID：1019873
> 
> 赞同：12
> 
> 时间：2009-06-19T20:22:09.670
> 
> 标签：javascript, jquery, dom, jquery-ui

我想在 jquery 中制作一个可拖动的图像。首先，我对 jquery 的体验是 0。话虽如此，让我描述一下我想要实现的目标。我有固定的宽度/高度 div。并且包含在 div 中的图像尺寸很大。所以我希望图像可以在该 div 内拖动，以便用户可以看到整个图像。

有人可以帮忙吗？考虑到我的 jquery 流畅度，请稍微详细说明一下程序。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-06-19T21:03:12.287

您可以使用以下内容；

```
$(function() {
  $("#draggable").draggable();
});
```

```
.container {
  margin-top: 50px;
  cursor: move;
}

#screen {
  overflow: hidden;
  width: 200px;
  height: 200px;
  clear: both;
  border: 1px solid black;
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>

<div class="container">
  <div id="screen">
    <img src="https://picsum.photos/200/200" class="drag-image" id="draggable" />
  </div>
</div>
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-19T20:23:42.197

您需要 jQuery [Draggable](http://docs.jquery.com/UI/Draggable) UI 工具。与所有 jQuery 一样，此代码非常简单：

```
$(document).ready(function(){
  $("#draggable").draggable();
}); 
```

将从标准 html 标记（`IMG`在您的情况下）创建一个可拖动对象。为了将它的移动性限制在特定区域，您将研究它的[遏制选项](http://docs.jquery.com/UI/Draggable#option-containment)。

### 更新：*“什么是 '#draggable' 和 'ready'”？*

1.  '#draggable' 表示您希望能够拖动的元素。井号 (#) 符号表示 ID。当你添加你的图像标签时，可以给它一个像下面这样的 id：

    `<img src="myimage.jpg" id="draggable" />`

    这将使上面的 javascript 使你的图像可拖动，因为它具有 jQuery 正在寻找的 '#draggable' id。
2.  `'.ready()'`是页面加载完成后浏览器自动引发的方法。jQuery 小组鼓励开发人员将所有 jQuery 代码放在此方法中，以确保页面上的所有元素在任何 jQuery 代码尝试操作它们之前完全加载。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-07-01T23:19:36.233

对于这个例子来说，限制在一个区域内，遏制并没有多大帮助。我已经为仅垂直滚动实现了此功能，需要增强水平限制：

```
stop: function(event, ui) {
    var helper = ui.helper, pos = ui.position;
    var h = -(helper.outerHeight() - $(helper).parent().outerHeight());
    if (pos.top >= 0) {
        helper.animate({ top: 0 });
    } else if (pos.top <= h) {
        helper.animate({ top: h });
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-09T14:44:28.100

```
$('#dragMe').draggable({ containment: 'body' }); 
```

This code will make it posible to drag the div with the ID of dragMe where ever you want inside the body of the document. You can also write a class or id as containment.

```
$('#dragMe').draggable({ containment: '#container' }); 
```

This code will make the div dragMe able to be draggable inside of the id container.

Hope this helps otherwise you should be able to find your answer here [http://jqueryui.com/demos/draggable/](http://jqueryui.com/demos/draggable/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-04-22T02:07:56.623

[扩展PH](https://stackoverflow.com/users/825624/ph)的答案。每当图像被拖动到​​底层容器暴露的点时，这将提供弹性反弹：

```
stop: function(event, ui) {
        var helper = ui.helper, pos = ui.position;
        var h = -(helper.outerHeight() - $(helper).parent().outerHeight());
        var w = -(helper.outerWidth() - $(helper).parent().outerWidth());
        if (pos.top <= h) {
            helper.animate({ top: h });
        } else if (pos.top > 0) {
            helper.animate({ top: 0 });
        }
        if (pos.left <= w) {
            helper.animate({ left: w });
        } else if (pos.left > 0) {
            helper.animate({ left: 0 });
        }
    } 
```

# http - Intranet 域上的 Cookie

> ID：1019876
> 
> 赞同：8
> 
> 时间：2009-06-19T20:22:45.863
> 
> 标签：http, cookies

我的办公室有一个位于防火墙后面的开发服务器。主机名是富兰克林。我们以科学家或发明家的名字命名所有服务器。

当我设置 HTTP cookie 时：

```
 Set-Cookie: user=kenny; expires=1245424860.11; Path=/; domain=franklin 
```

cookie 没有设置。我试过以下没有运气。

```
.franklin
.franklin.local
franklin.local
.franklin.localdomain
franklin.localdomain 
```

我是否必须将主机名设置为不同的名称，或者我可以通过一些我还不知道的魔法来设置这个 cookie？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-19T20:33:35.357

[RFC 2109](https://www.rfc-editor.org/rfc/rfc2109)说：

> 为防止可能的安全或隐私侵犯，如果以下任何一种情况属实，用户代理 将**拒绝**cookie（不应存储其信息）：

> *   Domain 属性的值不包含嵌入的点或不以点开头。
> *   请求主机的值与域属性的域不匹配。

并且：

> 域默认为请求主机。

如果您的主机是`franklin`：

*   带有 的 Cookie`domain=.franklin`将被拒绝，因为它没有嵌入点。
*   cookie`domain=.franklin.local`将被拒绝，因为它与您服务器的实际主机名不匹配。

解决方案是将您的主机名重命名为`franklin.local`or`franklin.<tld>`并相应地设置`domain`cookie 的属性 ( `domain=.franklin.<tld>`)。或者（如您所见），不要指定`domain`, 并让用户代理回退到请求主机。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T20:25:04.690

您是否从正确的域设置 cookie？您应该通过[http://franklin/](http://franklin/)访问该网站，否则它将无法正常工作（请参阅：同源政策）。

# php - 使用 PHP 验证 rfc2616 日期字符串

> ID：1019893
> 
> 赞同：2
> 
> 时间：2009-06-19T20:25:31.880
> 
> 标签：php, http, validation, datetime

为了安全起见，对 PHP Web 服务的请求将需要 Date: 标头。

我需要计算 Date: 标题是否在计算机时钟的 15 分钟内。我可以通过比较轻松做到这一点

```
$dt = new DateTime($_SERVER['HTTP_DATE']); 
```

到实际日期。但是，strotime 也支持诸如“now”之类的格式，它总是“有效”的。

有没有一种直接的方法来确保人们指定一个绝对日期。严格检查 RFC2616 更好，但不是必需的。

请参阅： [http](http://www.ietf.org/rfc/rfc2616.txt) ://www.ietf.org/rfc/rfc2616.txt第 3.3.1 节

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T21:42:38.153

做了一些研究，看起来你可以使用[strptime()](http://us.php.net/manual/en/function.strptime.php)解决这个问题。请注意，这是未经测试的，我只是猜测 strptime() 会根据提供的时区正确地将字符串转换为 GMT。这至少应该让你开始。

```
$in = $_SERVER['HTTP_DATE'];
$out = 0;

$strptime_patterns = array(
    // Matches: Sun, 06 Nov 1994 08:49:37 GMT
    '%a, %d %h %Y %H:%M:%S %z',
    '%a, %d %h %Y %H:%M:%S %Z',
    // Matches: Sunday, 06-Nov-94 08:49:37 GMT
    '%A, %d-%h-%y %H:%M:%S %z',
    '%A, %d-%h-%y %H:%M:%S %Z',
    // Matches: Sun Nov  6 08:49:37 1994
    '%a %h %e %H:%M:%S %Y'
);

foreach ($strptime_patterns as $pat) {
    if ($arr = strptime($in, $pat)) {
        $out = mktime($arr['tm_hour'], $arr['tm_min'], $arr['tm_sec'], $arr['tm_mon'], $arr['tm_mday'], $arr['tmp_year'] + 1900);
        break;
    }
}

if ($out > gmmktime()) {
    // Invalid date - in the future
} elseif ($out >= gmmktime() - (15 * 60)) {
    // Valid, not expired
} elseif ($out > 0) {
    // Valid date, but expired
} else {
    // Invalid date
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T20:52:08.083

```
$request_time = strtotime($_SERVER['HTTP_DATE']);
$server_time = time();
$difference = abs($request_time - $server_time);
if($difference <= (15 * 60)) {
    //good to go
} 
```

这只是将它们都转换为 Unix 时间戳并比较它们以确保它们之间的间隔小于或等于 15 分钟。

# python - 将 Python 字典序列化为 XML

> ID：1019895
> 
> 赞同：64
> 
> 时间：2009-06-19T20:26:00.287
> 
> 标签：python, xml, serialization, xml-serialization

有一个名为“simplejson”的简单 JSON 序列化模块，可以轻松地将 Python 对象序列化为 JSON。

我正在寻找可以序列化为 XML 的类似模块。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2010-11-22T07:40:30.577

有一种精神上[`huTools.structured.dict2xml`](https://github.com/hudora/huTools/blob/master/huTools/structured.py#L171)试图兼容的东西。`simplejson`你可以给它提示如何包装嵌套的子结构。如果[`huTools.structured.dict2et`](https://github.com/hudora/huTools/blob/master/huTools/structured.py#L99)返回`ElementTree`的字符串由`dict2xml`.

```
>>> data = {"kommiauftragsnr":2103839, "anliefertermin":"2009-11-25", "prioritaet": 7,
... "ort": u"Hücksenwagen",
... "positionen": [{"menge": 12, "artnr": "14640/XL", "posnr": 1},],
... "versandeinweisungen": [{"guid": "2103839-XalE", "bezeichner": "avisierung48h",
...                          "anweisung": "48h vor Anlieferung unter 0900-LOGISTIK avisieren"},
... ]}

>>> print ET.tostring(dict2et(data, 'kommiauftrag',
... listnames={'positionen': 'position', 'versandeinweisungen': 'versandeinweisung'}))
'''<kommiauftrag>
<anliefertermin>2009-11-25</anliefertermin>
<positionen>
    <position>
        <posnr>1</posnr>
        <menge>12</menge>
        <artnr>14640/XL</artnr>
    </position>
</positionen>
<ort>H&#xC3;&#xBC;cksenwagen</ort>
<versandeinweisungen>
    <versandeinweisung>
        <bezeichner>avisierung48h</bezeichner>
        <anweisung>48h vor Anlieferung unter 0900-LOGISTIK avisieren</anweisung>
        <guid>2103839-XalE</guid>
    </versandeinweisung>
</versandeinweisungen>
<prioritaet>7</prioritaet>
<kommiauftragsnr>2103839</kommiauftragsnr>
</kommiauftrag>''' 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-19T20:29:14.370

[http://code.activestate.com/recipes/415983/](http://code.activestate.com/recipes/415983/)

[http://sourceforge.net/projects/pyxser/](http://sourceforge.net/projects/pyxser/)

[http://soapy.sourceforge.net/](http://soapy.sourceforge.net/)

[http://www.ibm.com/developerworks/webservices/library/ws-pyth5/](http://www.ibm.com/developerworks/webservices/library/ws-pyth5/)

[http://gnosis.cx/publish/programming/xml_matters_1.txt](http://gnosis.cx/publish/programming/xml_matters_1.txt)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2011-06-07T08:45:18.000

试试这个。唯一的问题我不使用属性（因为我不喜欢它们）
[pynuggets.wordpress.com 上的dict2xml](http://pynuggets.wordpress.com/2011/06/06/dict2xml-4/)
[activestate 上的dict2xml](http://code.activestate.com/recipes/577739-dict2xml/)

```
from xml.dom.minidom import Document
import copy

class dict2xml(object):
    doc     = Document()

    def __init__(self, structure):
        if len(structure) == 1:
            rootName    = str(structure.keys()[0])
            self.root   = self.doc.createElement(rootName)

            self.doc.appendChild(self.root)
            self.build(self.root, structure[rootName])

    def build(self, father, structure):
        if type(structure) == dict:
            for k in structure:
                tag = self.doc.createElement(k)
                father.appendChild(tag)
                self.build(tag, structure[k])

        elif type(structure) == list:
            grandFather = father.parentNode
            tagName     = father.tagName
            grandFather.removeChild(father)
            for l in structure:
                tag = self.doc.createElement(tagName)
                self.build(tag, l)
                grandFather.appendChild(tag)

        else:
            data    = str(structure)
            tag     = self.doc.createTextNode(data)
            father.appendChild(tag)

    def display(self):
        print self.doc.toprettyxml(indent="  ")

if __name__ == '__main__':
    example = {'auftrag':{"kommiauftragsnr":2103839, "anliefertermin":"2009-11-25", "prioritaet": 7,"ort": u"Huecksenwagen","positionen": [{"menge": 12, "artnr": "14640/XL", "posnr": 1},],"versandeinweisungen": [{"guid": "2103839-XalE", "bezeichner": "avisierung48h","anweisung": "48h vor Anlieferung unter 0900-LOGISTIK avisieren"},]}}
    xml = dict2xml(example)
    xml.display() 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2013-04-22T14:13:20.550

我编写了一个将字典序列化为 xml 的简单函数（不到 30 行）。

用法：

```
mydict = {
    'name': 'The Andersson\'s',
    'size': 4,
    'children': {
        'total-age': 62,
        'child': [
            {
                'name': 'Tom',
                'sex': 'male',
            },
            {
                'name': 'Betty',
                'sex': 'female',
            }
        ]
    },
}
print(dict2xml(mydict, 'family')) 
```

结果：

```
<family name="The Andersson's" size="4">
        <children total-age="62">
                <child name="Tom" sex="male"/>
                <child name="Betty" sex="female"/>
        </children>
</family> 
```

完整的源代码（包括示例）可以在[https://gist.github.com/reimund/5435343/上找到](https://gist.github.com/reimund/5435343/)

**注意：**此函数会将字典条目序列化为属性而不是文本节点。修改它以支持文本将非常容易。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-28T15:38:46.693

Python 中的大多数对象在下面表示为 dicts：

```
>>> class Fred(object) : 
...    def __init__(self, n) : self.n = n 
... 
>>> a = Fred(100)
>>> print a.__dict__ 
{'n': 100} 
```

所以这类似于询问如何将 dicts 转换为 XML。有用于将 dict 转换为 XML 的工具，位于：

[http://www.picklingtools.com](http://www.picklingtools.com)

这是一个简单的例子：

```
 >>> import xmltools

    >>> d = {'a':1, 'b':2.2, 'c':'three' }
    >>> xx = xmltools.WriteToXMLString(d)
    >>> print xx
    <?xml version="1.0" encoding="UTF-8"?>
    <top>
      <a>1</a>
      <b>2.2</b>
      <c>three</c>
    </top> 
```

网站上有很多文档显示示例：

[XML 工具手册](http://www.picklingtools.com/html/xmldoc.html)

在 dicts 和 XML 之间进行“精确”转换是很困难的：什么是列表？你用属性做什么？你如何处理数字键？许多此类问题已在 XML 工具文档（上文）中得到解决和讨论。

速度对你重要吗？还是易用性很重要？有一个纯 C++ 模块（全部用 C++ 编写）、一个纯 Python 模块（全部用 Python 编写）和一个 Python C 扩展模块（用 C++ 编写，但经过包装以便 Python 可以调用它）。C++ 和 Python C 扩展模块的速度要快几个数量级，但当然需要编译才能开始。Python 模块应该可以正常工作，但速度较慢：

# c# - 具有任意深度的 ASP.NET MVC 动态路由和操作链接

> ID：1019906
> 
> 赞同：4
> 
> 时间：2009-06-19T20:27:45.247
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-routing

我想用 ASP.NET MVC 组合一个论坛/留言板。在这些类型的论坛上很常见的是分层板类别，例如：

-综合讨论
-技术支持--
网站技术支持--产品
技术支持
--产品A技术支持
--产品B技术支持

然后在每个类别下方是主题，并且消息属于这些主题。我主要关心的是 1.) 在给定 URL 的情况下到达正确的位置，2.) 在我的 URL 中不包括大量不必要的信息，以及 3.) 能够从代码重新创建 URL。

我希望一个 URL 是这样的：

```
mysite.com/Forum/ - 论坛索引
mysite.com/Forum/General-Discussion/ - “一般讨论”的板索引
mysite.com/Forum/Technical-Support/Product/Product-A/ - “产品 A 技术支持”的板索引
mysite.com/Forum/Technical-Support/Website/Topic1004/ - “网站技术支持”板中 ID 为 1004 的主题的主题索引
mysite.com/Forum/Technical-Support/Website/Topic1004/3 - ID 为 1004 的主题的第 3 页

```

现在，我已经排除了动作名称，因为它们可以根据我所在的位置推断出来。我的数据库中的每个 Board 实体都有一个“UrlPart”列，该列已编入索引，因此我希望能够对该表进行相对快速的查询，以确定我在哪里。

问题是：为了找出正确的位置，我应该使用自定义路由处理程序、自定义路由绑定器，还是应该创建模糊的路由规则？

这个建议看起来很不错，但看起来也有很多工作却没有什么好处： [ASP.NET MVC custom routing for search](https://stackoverflow.com/questions/379558/mvcnet-routing#379823)

这似乎表明创建模型绑定会更容易： [MVC Dynamic Routes](https://stackoverflow.com/questions/296284/mvc-dynamic-routes)

为了实现#3，我将不得不创建自己的自定义 URL 生成逻辑，对吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-20T00:00:30.713

如果您需要深度和/或不一致的 URL，我建议您使用基于属性的路由，例如[此处](https://stackoverflow.com/questions/894779/asp-net-mvc-routing-via-method-attributes)讨论的解决方案。

我更喜欢基于属性的方法，而不是把每条路由都放在 Application_Start 中，因为你有更好*的参考局部性*，这意味着路由规范和处理它的控制器是靠得很近的。

[使用我实现的 UrlRoute 框架（在codeplex](http://itcloud.codeplex.com)上可用），您的控制器操作将如何查找您的示例：

```
[UrlRoute(Path = "Forum")]
public ActionResult Index()
{
    ...
}

[UrlRoute(Path = "Forum/General-Discussion")]
public ActionResult GeneralDiscussion()
{
    ...
}

[UrlRoute(Path = "Forum/Technical-Support/Product/{productId}")]
public ActionResult ProductDetails(string productId)
{
    ...
}

[UrlRoute(Path = "Forum/Technical-Support/Website/{topicId}/{pageNum}")]
[UrlRouteParameterDefault(Name = "pageNum", Value = "1")]
public ActionResult SupportTopic(string topicId, int pageNum)
{
    ...
} 
```

使用这种方法，您可以使用相同的帮助程序（Url.Route*、Url.Action*）生成出站 URL，如果您使用默认路由处理程序手动添加路由，则无需额外工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-20T01:05:35.433

您可以让它们全部转到一个控制器操作，该操作通过手动拆分其余 url 并调用 BLL 上的方法来为您处理路由处理，然后将任务委托给其他方法，最终根据您的返回 View()需要。

# c# - 时间序列和相关策略

> ID：1019907
> 
> 赞同：3
> 
> 时间：2009-06-19T20:27:51.797
> 
> 标签：c#, algorithm, time-series

我有各种时间序列，我想关联并呈现为 csv 文件或内存数据表 (.NET)。这些时间序列是时间-值对的数组（实际上这些对象不仅仅包含时间和值）。时间序列可能跨越不同的重叠时期，有些甚至可能有漏洞（给定时间戳的缺失值）。

对于那些感兴趣的人，我正在使用 OPC HDA .NET 库从 OPC HDA 服务器中提取历史时间序列。

生成的数据表应具有每个时间序列的一列，所有时间序列均基于时间戳列按时间顺序排列。请参见下面的示例：

```
|-------|-------|-------|-------|-------|
   TIME    TS1     TS2     TS3     TS4
|-------|-------|-------|-------|-------|
    1       X               X       X
|-------|-------|-------|-------|-------|
    2       X       X       X       X
|-------|-------|-------|-------|-------|
    3       X       X               X
|-------|-------|-------|-------|-------|
    4       X       X       X 
|-------|-------|-------|-------|-------|
    5       X       X       X 
|-------|-------|-------|-------|-------| 
```

实现这一目标的最有效方法是什么？“有效”是指使用最少的代码。但是考虑到时间序列可能会变得非常大，内存使用也可能是一个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T22:52:53.970

您可以首先扫描所有现有系列的不同值（例如，将它们聚合到 HashSet 中），然后简单地将它们转储到日期数组中（将日期和索引位置之间的匹配存储在字典中）。

```
var distinctDates = allSeries
  .SelectMany(s => s.Values.Select(v => v.Date))
  .Distinct()
  .OrderBy(d => d)
  .ToArray();

var datePositions = distinctDates
  .Select((d,index) => new 
    {
      Date = d,
      Index = index
    }).
  .ToDictionary(x => x.Date, x => x.Index); 
```

然后，创建一个锯齿状数组，其宽度为“NumberOfSeries”，长度为“NumberOfDates”。之后，对所有数据进行第二次扫描并将它们转储到它们的位置。

```
var values = new float[allSeries.Length][];
for (var i=0;i<allSeries.Length;i++)
{
  values[i] = new float[distinctDates.Length];
  var currentSerie = allSeries[i];
  foreach(var value in currentSerie.Values)
  {
    var index = datePositions[value.Date];
    values[i][index] = value.Value;
  }      
} 
```

我在没有接触 VisualStudio 的情况下编写了这段代码，所以我可能有一些拼写错误。或者可能使用了一些 .NET 中不存在的 LINQ 方法（只需查看[Lokad.Shared.dll 即可](http://abdullin.com/shared-libraries/)）。但是你应该能够理解这个想法。

还有一些注意事项，当我谈到这个话题时：

1.  如果您必须一次将所有内容保存在内存中，请选择锯齿状数组。它比字典效率更高，内存问题也比矩形数组少得多。

2.  保持 Value 对象尽可能小（即：float 而不是 double）。

3.  如果未来时间序列值的数量预计会变大，那么永远不要将数据库中的值存储在“每个值一行”中。[建议要么使用HDF](http://www.hdfgroup.org/)（具有 .NET 接口）之类的东西，要么在 DB 中使用二进制形式的持久时间序列片段（如[时间序列数据库](http://en.wikipedia.org/wiki/Time_series_database)）

坚持这些应该可以让你在没有很多问题的情况下扩展到数亿个时间值（做到了）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T20:40:49.273

您可能会使用嵌套字典之类的数据结构并迭代内容：

```
Dictionary <TimeSeries, Dictionary<DateTime, Value>> dict = new Dictionary<TimeSeries, Dictionary<DateTime, Value>>();

foreach (TimeSeries series in dict.Keys) {

    //table row output code goes here
    Dictionary<DateTime, Value> innerDict = dict[series];
    foreach (DateTime date in innerDict.Keys) {
        Value seriesValueAtTimeT = innerDict[date];
        //table column output code goes here
    }
} 
```

根据您的需要，您的输出代码在哪里写入其他内容，并且您将数据类型 TimeSeries、Value 等替换为您的实际数据类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-24T03:40:47.043

嘿，克里斯。我意识到您已经接受了答案，但我想我会发布我使用的解决方案。希望它对某人有用。如果不是，至少它为我在未来某个时候找到它提供了一个地方。:-)

这是直接从 Excel 2007 代码模块触发的 VBA 代码。它可以很容易地转换为.Net。

数据操作的关键是数据透视表对象。我发现它在将数据放入您指定的布局方面非常有效。

```
Sub GetIndexData ()
Dim cn as ADODB.Connection, cmd As ADODB.Command, rs As ADODB.Recordset
Dim rPivotTopLeft As Range, rPivotBottomRight As Range

Application.ScreenUpdating = False
Application.Calculation = xlCalculationManual

'Get the data.'
Set cn = New ADODB.Connection
With cn
  .Provider = "SQLOLEDB"
  .ConnectionString = "Database=" & mDBName & ";" & _
                      "Server=" & mDBServerName & ";" & _
                      "UID=" & mDBUserID & ";" & _
                      "Password=" & mDBPassword & ";" & _
                      "Persist Security Info=True;"
  .CursorLocation = adUseClient
  .Open
End With

Set cmd = New ADODB.Command
Set rs = New ADODB.Recordset
With cmd
  .ActiveConnection = adoTools.DBConnection
  .CommandType = adCmdText
  .CommandText = "SELECT YourData From YourSource WHERE YourCritera"
  Set rs = .Execute
End With

If Not (rs.BOF And rs.EOF) Then 'Check that we have some data.'

'Put the data into a worksheet.'
With wsRawData
  .Cells.CurrentRegion.Clear

  Set rPivotTopLeft = .Range("A1")
  With ThisWorkbook.PivotCaches.Add(SourceType:=xlExternal)
    Set .Recordset = rs
    .CreatePivotTable _
        TableDestination:=rPivotTopLeft, _
        TableName:="MyPivotTable"
  End With

  'Massage the data into the desired layout.'
  With .PivotTables("MyPivotTable")
    .ManualUpdate = True

    .PivotFields("Date").Orientation = xlRowField
    .PivotFields("Index").Orientation = xlColumnField
    .AddDataField .PivotFields("Return"), "Returns", xlSum

    .DisplayFieldCaptions = False
    .ColumnGrand = False
    .RowGrand = False

    .ManualUpdate = False
  End With

  mMonthCount = Range(.Range("A3"), .Cells(Rows.Count, "A").End(xlUp)).Count
  mIndexCount = Range(.Range("B2"), .Cells(2, Columns.Count).End(xlToLeft)).Count

  'Convert pivot table to values.'
  Set rPivotBottomRight = .Cells(mMonthCount + 2, mIndexCount + 1)
  With .Range(rPivotTopLeft, rPivotBottomRight)
    .Copy
    .PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
  End With

  'Format the worksheet.'
  .Range("A3").Resize(mMonthCount, 1).NumberFormat = "mmm-yy"
  .Range("B3").Resize(mMonthCount, mIndexCount).NumberFormat = "0.00%"
  Union(.Rows(2), .Columns(1)).Font.Bold = True
  .Cells.ColumnWidth = 7.14
  .Rows(1).Delete

End With

rs.close
Set rs = Nothing
cmd.ActiveConnection = Nothing
Set cmd = Nothing
cn.close
Set cn = Nothing

End Sub 
```

从那里可以相对容易地利用内置的 excel 回归统计来输出相关矩阵。使用这种技术，我将在大约 45 秒内生成一个具有 600x600 相关矩阵的工作表。

请注意，应更改 .PivotFields 参数以适合数据源中数据的列名。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T21:04:59.680

如果内存使用成为问题，您可以做的一件事是从跟踪单个事件转移到给定时间段内的事件列表计数。你会失去一些关于事情发生的确切时间的精确度，但经常像这样总结你的数据可以降低你的图片的复杂性并使趋势更加明显。

如果不是很明显，我的意思是获取如下所示的数据：

```
12:00 event1
12:01 event2
12:10 event1
12:11 event1 
```

对此：

```
12:00-12:15 event1 3
12:00-12:15 event2 1 
```

# linden-scripting-language - 如何用 LSL 中的粒子制作静止图像？

> ID：1019911
> 
> 赞同：3
> 
> 时间：2009-06-19T20:28:48.020
> 
> 标签：linden-scripting-language

LSL（Linden 脚本语言）允许使用 llParticleSystem 函数实现各种粒子效果。为了使基于粒子的非移动图像悬停在 prim 上，该函数的正确参数是什么？

（今天在 Script Academy 讨论组中提出了这个问题。我在这里重新发布问题和我的答案，以帮助更多 LSL 用户加入 Stack Overflow。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T20:31:00.247

以下脚本将使用在 prim 内容中找到的第一个纹理，从粒子中创建一个静止的悬停图像。

```
ParticleImage(string tex, vector scale)
{
   list params;
   //set texture and size
   params += [PSYS_SRC_TEXTURE, tex];
   params += [PSYS_PART_START_SCALE, scale];
   //make particles follow source
   params += [PSYS_PART_FLAGS, PSYS_PART_FOLLOW_SRC_MASK];
   //use drop pattern, which has no velocity
   params += [PSYS_SRC_PATTERN, PSYS_SRC_PATTERN_DROP];
   llParticleSystem(params);
}

default
{
   state_entry()
   {
       //make the prim invisible
       llSetAlpha(0.0, ALL_SIDES);
       if (llGetInventoryNumber(INVENTORY_TEXTURE))
       {
           string tex = llGetInventoryName(INVENTORY_TEXTURE, 0);
           ParticleImage(tex, <1.0, 1.0, 0.0>);
       }
   }
} 
```

# gwt - 如何重建 GWT 历史堆栈？

> ID：1019917
> 
> 赞同：0
> 
> 时间：2009-06-19T20:30:13.757
> 
> 标签：gwt, gwt-history

我正在使用一个更大的应用程序，但[GWT History 文档](http://google-web-toolkit.googlecode.com/svn/javadoc/1.6/com/google/gwt/user/client/History.html)有一个简单的示例来演示该问题。为方便起见，复制了示例：

```
public class HistoryTest implements EntryPoint, ValueChangeHandler
{
    private Label lbl = new Label();

    public void onModuleLoad()
    {
        Hyperlink link0 = new Hyperlink("link to foo", "foo");
        Hyperlink link1 = new Hyperlink("link to bar", "bar");
        Hyperlink link2 = new Hyperlink("link to baz", "baz");

        String initToken = History.getToken();

        if (initToken.length() == 0)
        {
            History.newItem("baz");
        }

        // Add widgets to the root panel.
        VerticalPanel panel = new VerticalPanel();
        panel.add(lbl);
        panel.add(link0);
        panel.add(link1);
        panel.add(link2);
        RootPanel.get().add(panel);

        History.addValueChangeHandler(this);        // Add history listener
        History.fireCurrentHistoryState();
    }

    @Override
    public void onValueChange(ValueChangeEvent event)
    {
        lbl.setText("The current history token is: " + event.getValue());
    }
} 
```

问题是，如果您刷新应用程序，历史堆栈就会被吹走。您如何保留历史记录，以便在用户刷新页面时，后退按钮仍然有用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T10:30:04.180

我刚刚用 Firefox 和 Chrome 对我的应用程序进行了测试，页面刷新并*没有*清除历史记录。您使用哪种浏览器？你有没有

```
<iframe src="javascript:''" id='__gwt_historyFrame' style='position:absolute;width:0;height:0;border:0'></iframe> 
```

在你的 HTML 中？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-10-02T19:45:45.290

GWT 通过提供 History 对象解决了这个问题。通过调用它的静态方法`History.newItem("your token")`，您将能够将令牌传递到您的查询字符串中。

但是，您需要注意，只要 gwt 应用程序中的历史记录发生更改，`onValueChange(ValueChangeEvent event){}`就会触发该事件，并且您可以在该方法中调用相应的页面。以下是我用来解决此问题的步骤列表。

1.  向需要调用新页面的对象添加单击侦听器。在处理事件时，将令牌添加到`history.(History.newItem("new_token")`.

2.  在实现`ValueChangeHandler`您的入口点的类中实现。

3.  将`onValueChangeHandler(this)`侦听器添加到实现 EntryPoint 的类。确保在`onModuleLoad()`实现 EntryPoint 的类的方法中添加该行（在此方法中添加很重要）（很明显哈！）

4.  最后实现`onValueChange(ValueChangeEvent event)`{ //call a new page } 方法。

就是这样

# sql - ASP.Net MVC 数据格式化

> ID：1019922
> 
> 赞同：3
> 
> 时间：2009-06-19T20:31:26.360
> 
> 标签：sql, asp.net-mvc, layout, formatting

假设我有一个如下的数据库表：

```
FileID | FileName | FileSize | Group
-------------------------------------
1        test.txt   100        Group1
2        test2.txt  100        Group1
3        test3.txt  100        Group2 
```

使用以下样式的 MVC 视图显示此数据的最佳方式是什么：

第 1 组

包含 Group1 文件的表

* * *

第 2 组

包含 Group1 文件的表

* * *

我得到的是，当我通过 linq to sql 查询按 Group 对结果进行分组时，如何有效地分节显示文件列表。

感谢您的任何意见。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T20:37:49.233

这是一个快速示例...我假设一个强类型模型包含一个包含相应文件的组列表...

**模型**

```
public class Groups
{
    public List<Files> GroupFiles { get; set; }
    public String Name{ get; set; }
}

public class File
{
    public int FileId { get; set; }
    public String FileName { get; set; }
    public String FileSize { get; set; }
} 
```

**看法**

```
<%
foreach(var group in myModel.FileGroups)
{
%>
      <h2><%= group.Name %></h2>
      <table>
<%   
    foreach(var file in group.Files)
    { %>

         <tr>
             <td><%= file.FileID %></td>
             <td><%= file.FileName %></td>
             <td><%= file.FileSize %></td>
         </tr>

    <%
    } %>
</table>
<%
}
%> 
```

# haskell - Haskell：类型类问题

> ID：1019928
> 
> 赞同：7
> 
> 时间：2009-06-19T20:33:27.403
> 
> 标签：haskell, typeclass

我希望定义以下类型类`Mapping`：

```
{-# LANGUAGE MultiParamTypeClasses #-}

class Mapping k v m where
  empty :: m v
  insert :: k -> v -> m v -> m v
  search :: k -> m v -> Maybe v
  delete :: k -> m v -> m v 
```

一个例子`Mapping`是`Data.Map.Map`

```
{-# LANGUAGE ..., FlexibleInstances #-}

instance Ord k => Mapping k v (Map.Map k) where
  empty = Map.empty
  search = Map.lookup
  insert = Map.insert
  delete = Map.delete 
```

现在我想创建一个类型`Trie :: * -> * -> * -> *`，例如

```
{-# LANGUAGE ..., UndecidableInstances #-}

data Trie m k v = Trie {
  trValue :: Maybe v,
  trChildren :: m (Trie m k v)
}

instance Mapping k (Trie m k v) m => Mapping [k] v (Trie m k) where
  search [] tree = trValue tree
  search (x:xs) tree =
    search xs =<< search x (trChildren tree) 
```

到目前为止一切顺利，现在我也想定义`Trie`'`insert`和`empty`，这就是我遇到问题的地方。

我将讨论`empty`因为它更简单并且`insert`无论如何都需要它..如果我尝试这个：

```
instance Mapping k (Trie m k v) m => Mapping [k] v (Trie m k) where
  empty = Trie { trValue = Nothing, trChildren = empty }
  ... 
```

这让我得到以下错误：

```
Could not deduce (Mapping k (Trie m k1 v) (m k1))
  from the context (Mapping [k1] v (Trie m k1),
                    Mapping k1 (Trie m k1 v) (m k1))
  arising from a use of `empty' at test.hs:27:49-53
Possible fix:
  add (Mapping k (Trie m k1 v) (m k1)) to the context of
    the instance declaration
  or add an instance declaration for (Mapping k (Trie m k1 v) (m k1))
In the `trChildren' field of a record
In the expression: Trie {trValue = Nothing, trChildren = empty}
In the definition of `empty':
    empty = Trie {trValue = Nothing, trChildren = empty} 
```

我已经尝试并尝试解决它但失败了。

有谁知道如何使它工作？甚至可能吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-19T21:35:24.407

添加[功能依赖](http://www.haskell.org/haskellwiki/Functional_dependencies)：

```
{-# LANGUAGE ..., FunctionalDependencies #-}

class Mapping k v m | m -> k where
   ... 
```

您之前遇到的错误是因为程序在某些地方使用哪种键类型不明确，因此出现关于类型变量的错误`k1`。函数依赖允许从映射类型推断出键类型（通过声明只有一个可能的答案），从而解决了这个问题。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-19T22:10:24.243

演示 Ganesh 答案的代码：

```
{-# LANGUAGE FlexibleInstances, FunctionalDependencies, MultiParamTypeClasses, StandaloneDeriving, UndecidableInstances #-}

import qualified Data.Map as Map
import Data.Maybe (fromMaybe)

class Mapping k m | m -> k where             
  empty :: m v
  insert :: k -> v -> m v -> m v
  search :: k -> m v -> Maybe v
  delete :: k -> m v -> m v

instance Ord k => Mapping k (Map.Map k) where
  empty = Map.empty
  search = Map.lookup
  insert = Map.insert
  delete = Map.delete

data Trie m v = Trie {
  trValue :: Maybe v,
  trChildren :: m (Trie m v)
}

deriving instance (Show v, Show (m (Trie m v))) => Show (Trie m v)

trieMod :: Mapping k m => Maybe v -> [k] -> Trie m v -> Trie m v
trieMod val [] trie = trie { trValue = val }
trieMod val (x:xs) trie =
  trie { trChildren = insert x newChild children }
  where
    children = trChildren trie
    newChild = trieMod val xs prevChild
    prevChild = fromMaybe empty . search x $ children

instance Mapping k m => Mapping [k] (Trie m) where
  empty = Trie { trValue = Nothing, trChildren = empty }
  search [] trie = trValue trie
  search (x:xs) trie =
    search xs =<< search x (trChildren trie)
  insert key val = trieMod (Just val) key
  delete = trieMod Nothing

type TernarySearchTree a = Trie (Map.Map a) 
```

顺便说一句：如果不存在函数依赖关系，我们可能需要在烦人的接口上妥协并使用函数表而不是类型类。

# .net - 将对象写入 XML

> ID：1019931
> 
> 赞同：0
> 
> 时间：2009-06-19T20:33:35.623
> 
> 标签：.net, xml, serialization

在 .Net 中进行单向 XML 序列化有哪些方法？XmlSerializer 不会编写没有公共设置器的属性。虽然这种限制对于反序列化是可以理解的，但我会满足于仅对 Web 使用进行序列化。JSON.Net 序列化在这种情况下工作得很好，因为它序列化完整的对象图而不介意，即使某些属性没有定义设置器。

这些类的主要目标是一个普通的 .Net 类库。这些类在 90% 的情况下被其他代码使用，所以我追求的解决方案不会牺牲类的正常可用性。

生成的类库应该支持 .Net 2.0。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T20:35:50.360

我会看看[`DataContractSerializer`](http://www.danrigsby.com/blog/index.php/2008/03/07/xmlserializer-vs-datacontractserializer-serialization-in-wcf/)。虽然此类型是在 .NET 3.0 框架中声明的，但不会阻止您`System.Runtime.Serialization.dll`在项目中使用新版本的 。

为了更好地了解与我有什么`DataContractSerializer`不同，`XmlSerializer`我会查看[Chris Lively 的回答](https://stackoverflow.com/questions/1019931/writing-an-object-to-xml/1019952#1019952)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T20:41:30.007

你可能想看看这个网站：[XmlSerializer vs DataContractSerializer](https://web.archive.org/web/20130528055036/http://www.danrigsby.com/blog/index.php/2008/03/07/xmlserializer-vs-datacontractserializer-serialization-in-wcf/)

除此之外，您可能会考虑覆盖对象的序列化方式，并自行决定 xml 流中应该和不应该包含哪些内容。

# html - 使 TBODY 在 Webkit 浏览器中可滚动

> ID：1019938
> 
> 赞同：70
> 
> 时间：2009-06-19T20:36:16.210
> 
> 标签：html, css, webkit

我知道[这个问题](https://stackoverflow.com/questions/130564/i-need-my-html-tables-body-to-scroll-and-its-head-to-stay-put)，但没有一个答案适用于 Safari、Chrome 等。

公认的策略（[如此处所示](http://www.w3.org/WAI/UA/TS/html401/cp1001/1001-THEAD-TBODY-TFOOT-OVERFLOW.html)）是设置 tbody 高度和溢出属性，如下所示：

```
<table>
    <thead>
        <tr><th>This is the header and doesn't scroll</th></tr>
    </thead>
    <tbody style="height:100px; overflow:auto;">
        <tr><td>content that scrolls</td></tr>
        <tr><td>content that scrolls</td></tr>
        <tr><td>content that scrolls</td></tr>
        <tr><td>content that scrolls</td></tr>
        <tr><td>content that scrolls</td></tr>
        <tr><td>content that scrolls</td></tr>
        <tr><td>content that scrolls</td></tr>
    </tbody>
</table> 
```

不幸的是，这在任何 webkit 浏览器中都不起作用。有一个关于它的[错误报告](https://bugs.webkit.org/show_bug.cgi?id=3239)似乎不是一个高优先级（6 月 5 日报告）。

所以我的问题是：是否有替代策略确实有效？我尝试过两表的方法，但无法保证表头与内容对齐。我只需要等待 Webkit 修复它吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2011-11-10T18:24:46.887

这是一个工作示例：

[http://www.imaputz.com/cssStuff/bigFourVersion.html](http://www.imaputz.com/cssStuff/bigFourVersion.html)

您必须将 display:block 添加到 thead > tr 和 tbody

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-08-19T09:44:48.170

仅当您有 1 列时，才使用 display:block 样式。如果您有多个数据列 - 具有多个字段 - 然后 display:block 似乎使所有数据列可滚动但在第一列下（在 Firefox 中也是如此 - 这是我所知道的唯一一个可以很好地滚动的浏览器）。顺便说一句，在 Firefox 上 - 您可以使用 overflow-x: hidden 样式来抑制水平滚动。

我意识到我提到的问题只有在您没有为 th & td 元素指定宽度时才会出现 - 如果您可以修复列宽，那么它就可以工作。对我来说问题是我无法修复列宽。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2011-04-08T15:39:13.253

尝试此页面的第一种方法，带有单个表格的纯 CSS（表格周围有 2 个 div，并且 thead 是绝对定位的）：[http](http://www.cssplay.co.uk/menu/tablescroll.html) ://www.cssplay.co.uk/menu/tablescroll.html 似乎可以使用FF4/IE9/IE8 除了 IE7/FF3.6。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-07-12T21:12:08.373

我有同样的问题，并为我编写了一个 jQuery 脚本来执行此操作......使用两个表格元素并相应地格式化 css。希望这可以帮助其他有同样问题的人......

[http://jsfiddle.net/pe295/1/](http://jsfiddle.net/pe295/1/)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-10-11T18:42:36.020

我看到了 Sean Haddy 的[出色解决方案](https://stackoverflow.com/questions/1019938/make-tbody-scrollable-in-webkit-browsers/11460752#11460752)，并冒昧地[进行了一些编辑](http://jsfiddle.net/jhfrench/eNP2N/)：

*   使用类而不是 ID，因此一个 jQuery 脚本可以重复用于一页上的多个表
*   添加了对语义 HTML 表格元素的支持，例如标题、thead、tfoot 和 tbody
*   使滚动条可选，因此它不会出现在比可滚动高度“短”的表格中
*   调整滚动 div 的宽度以使滚动条上升到表格的右边缘
*   使概念可通过
    *   在注入的静态表头上使用 aria-hidden="true"
    *   并留下原始的thead，只是用jQuery隐藏并设置`aria-hidden="false"`
*   显示了多个不同大小的表格的示例

不过，肖恩完成了繁重的工作。也感谢 Matt Burland 指出需要支持 tfoot。

请在[http://jsfiddle.net/jhfrench/eNP2N/上亲自查看](http://jsfiddle.net/jhfrench/eNP2N/)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-02-08T16:45:10.477

A很久以前就遇到过同样的问题，我终于提出了两张表的方法。结果如下：http: [//jsfiddle.net/bGr4V/3/](http://jsfiddle.net/bGr4V/3/)，它适用于所有浏览器（IE6+ incl）。

在[这个 jsFiddle](http://jsfiddle.net/5Rdwy/1/)中，您可以使用干净的版本。

我的解决方案是在 中添加一个*修复单元格* `<th class="fix"> </th>`以`thead`填充滚动条的空间`tbody`，然后为一列提供可变宽度 ( `<td class="grow">`)，因此标题*修复单元格*在调整大小时不会不匹配。

**HTML：**

```
<div class="fixed_table">
  <div class="head">
    <table>
      <thead>
        <tr>
          <th>Column header</th>
          <th class="grow">Column header</th>
          <th class="fix"> </th>
        </tr>
      </thead>
    </table>
  <div class="body">
    <table class="full_table">
      <caption class="caption">Caption</caption>
      <tbody>
        <tr>
          <td>Data</td>
          <td class="grow">Data</td>
        </tr>
        <tr>
          <td>...</td>
          <td>...</td>
        </tr>
        <tr>
          <td>...</td>
          <td>...</td>
        </tr>
      </tbody>
    </table>
  </div>
</div> 
```

**CSS:** has `*`and `_`hack for ie6-7, and a `-webkit`specific for header *fix-cell* matching scroll width in each case。

```
.fixed_table table {
  table-layout: fixed;
  width: auto;
  border-width: 0;
  padding: 0;
  border-collapse: collapse;
}

.fixed_table .body {
  overflow: scroll;
  overflow-x: hidden;
  max-height: 10.75em;
  min-height: 2.5em;
  padding-bottom: 0.8em;
  *padding-right: 17px; /*ie7 & ie6*/
  _padding-right: 0; /*ie6*/
  _height: 10em ;
}

.fixed_table th, .fixed_table td {
  width: 4.7em;
}

.fixed_table .grow {
  width: auto;
}

.fixed_table .fix {
  width: 16px;
  *width: 17px; /*ie7 & ie6*/
  _width: 16px; /*ie6*/
}

/* webkit specific */
@media screen and (-webkit-min-device-pixel-ratio:0) {
  .fixed_table .fix{ width: 17px }
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-11-11T02:22:22.900

以为我会把我的解决方案混在一起 - [http://tjvantoll.com/2012/11/10/creating-cross-browser-scrollable-tbody/](http://tjvantoll.com/2012/11/10/creating-cross-browser-scrollable-tbody/)。

它采用与@Michael Koper 的解决方案相同的基本路线，但包含一个解决方法，因此该表在 IE 中看起来正确，回到 IE6。

我通过给出`<table>`a`table-layout: fixed`并为每列中的单元格显式分配宽度来解决宽度问题。不理想，但它确实会生成一个语义表，无论是否需要滚动条，它都会跨浏览器对齐。

演示：[http ://codepen.io/tjvantoll/pen/JEKIu](http://codepen.io/tjvantoll/pen/JEKIu)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-02-02T11:08:10.660

我为上述问题开发了 javascript 解决方案，该解决方案
仅适用于 Firefox 7+，因为我仅在 FF 中进行了测试

我来到这个线程并找到了**Michael Koper指出的解决方案**

在这个解决方案中，完成了三件重要的事情
1) 固定列宽
2) thead > tr display 设置为 block
3) tbody display 设置为 block

正如其他人提到的固定宽度的问题，我也处于相同的位置；
即使我不能静态地固定宽度

所以我想我会动态地固定宽度（在浏览器中呈现表格之后），这就是诀窍:)

以下是仅适用于 FF 的 javascript 解决方案
（我仅在 FF 中测试过，我无法访问其他浏览器）

```
 function test1(){                
            var tbodys = document.getElementsByTagName("TBODY");
            for(var i=0;i<tbodys.length;i++){
                do_tbodyscroll(tbodys[i]);
            }
        }

      function do_tbodyscroll(_tbody){
            // get the table node 
            var table = _tbody.parentNode;

            // first row of tbody 
            var _fr = _tbody.getElementsByTagName("TR")[0];

            // first row cells .. 
            var _frcells = _fr.cells;

            // Width array , width of each element is stored in this array 
            var widtharray = new Array(_frcells.length);

            for(var i=0;i<_frcells.length;i++){                    
                widtharray[i] = _frcells[i].scrollWidth;
            }                

            // Apply width to first row                  
            for(var i=0;i<_frcells.length;i++){
                _frcells[i].width = widtharray[i];                   
            }                 

            // Get the Last row in Thead ... 
            // COLGROUPS USING COLSPAN NOT YET SUPPORTED

            var thead = table.getElementsByTagName("THEAD")[0];
            var _rows = thead.getElementsByTagName("TR");
            var tableheader = _rows[_rows.length - 1];
            var headercells = tableheader.cells;

            // Apply width to header ..                                
            for(var i=0;i<headercells.length;i++){
                headercells[i].width = widtharray[i];
            }

            // ADD 16 Pixel of scroll bar to last column ..
            headercells[headercells.length -1 ].width = widtharray[headercells.length -1] + 16;

            tableheader.style.display = "block";
            _tbody.style.display = "block";  
        } 
```

该解决方案从浏览器中找出列的宽度，
并在设置宽度后再次为列（标题和 tbody 的第一行）设置相同
的宽度；thead > tr 和 tbody 显示设置为阻止

希望这个解决方案对大家有用..
如果您可以将其扩展到其他浏览器，请回复此帖子

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-02-08T22:18:00.630

这真的很hacky，但*也许*它会帮助某个地方的人......

[http://jsfiddle.net/yUHCq/1/](http://jsfiddle.net/yUHCq/1/)

它使用列而不是行，因此处理它基本上是向后完成的。

为 IE 兼容性添加了过渡 DOCTYPE。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-01-31T19:54:01.900

这个问题可能有点矫枉过正，但 YUI 仍然可能提供最好的免费跨浏览器数据表。它也可以用于只读数据。

[YUI 2 数据表](http://developer.yahoo.com/yui/datatable/)

[YUI 3 数据表](http://yuilibrary.com/yui/docs/datatable/)

单击此处的示例以查看可滚动的示例。因为，我是stackoverflow的新手，所以我只能发布这两个链接。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-07-20T16:16:45.123

添加`display:block;`这也将删除 FireFox 中不必要的水平滚动。毫无疑问，您也知道这两个示例都不适用于 MSIE 8。

```
<table>
    <thead>
        <tr><th>This is the header and doesn't scroll</th></tr>
    </thead>
    <tbody style="height:100px; overflow:auto;display:block;">
        <tr><td>content that scrolls</td></tr>
        <tr><td>content that scrolls</td></tr>
        <tr><td>content that scrolls</td></tr>
        <tr><td>content that scrolls</td></tr>
        <tr><td>content that scrolls</td></tr>
        <tr><td>content that scrolls</td></tr>
        <tr><td>content that scrolls</td></tr>
    </tbody>
</table> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-06-13T02:35:55.283

这里有一个适用于 IE5+、Firefox 和 Chrome 的示例。但是，它使用固定宽度的列。 [http://www.cssplay.co.uk/menu/tablescroll.html](http://www.cssplay.co.uk/menu/tablescroll.html)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-09-10T01:09:38.343

如果有人需要它在 IE 怪癖模式下工作，以下是我如何更改和简化 IG Pascual 的代码以使其工作：

```
.fixed_table{
       overflow: scroll;
       overflow-x: hidden;
       max-height: 300px;
       height: 300px;
       min-height: 50px;
       padding-right:0;
}
#datatable td 
{
       padding:3px;
       text-align: center;
       width: 9%;
       vertical-align: middle;
       background-color: #343435; 
       color: #E0E0E3;
       overflow:hidden;
} 
<div class="head">
    <table>
        <thead>
            <tr>
                <th>Time (GMT)</th>
                <th>Price</th>
            </tr>
        </thead>
    </table>
</div>
<div class="fixed_table">
    <table id="datatable" cellspacing="1" cellpadding="1">
        <tbody></tbody>
    </table>
</div> 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-08-14T13:47:30.113

让表格按原样绘制并计算每列的宽度并将其设置到每个标题中。标题是用分区制作的，然后我们可以让表格自由滚动。

```
<!DOCTYPE html>
<html>
<head>
<style>
.t_heading{
  margin-top: 20px;
  font-family: Verdana, Geneva, sans-serif;
  background-color: #4CAF50;
}

.heading{
  background-color: #4CAF50;
  color: white;
  float:left;
  padding: 8px 0PX 8PX 0PX;
  border-bottom: 1px solid #ddd;
  height: 20px;
  text-align: left;
}

.t_data{
  overflow-y: scroll;
  overflow-x: hidden;
  height:0px;
  width: 100%;

}

.t_content{
    border-collapse: collapse;
    font-family: Verdana, Geneva, sans-serif;
    width: 100%;
}

.column1,.column2,.column3,.column4{
    padding: 8px 0PX 8PX 0PX;
    text-align: left;
    border-bottom: 1px solid #ddd;
}
.t_row:hover{
  background-color:#f5f5f5;
}
</style>
<script>
function setBody(){
    var body = document.body,
    html = document.documentElement;

    var height = Math.max( body.scrollHeight, body.offsetHeight, html.clientHeight, html.scrollHeight, html.offsetHeight );
    height = height-300;
    /*
     ** By changing the subtraction value, You can fit the table in to the screen correctly.
     ** Make sure not to come the hscroll.
     ** Or you can set fixed height with css for the div as your wish.
     */
    document.getElementById("t_data").style.height = height+"px";

    setColumnWidth("column1");
    setColumnWidth("column2");
    setColumnWidth("column3");
    setColumnWidth("column4");
}

function setColumnWidth(o){
        var object = o;
        var x = document.getElementsByClassName(object);
        var y = x[0].clientWidth;
        document.getElementById(object).style.width = y+"px";
 }
</script>
</head>

<body onload="setBody()">
<div class="t_heading">
<div class="heading"  id="column1">Heading 1</div>
<div class="heading"  id="column2">Heading 2</div>
<div class="heading"  id="column3">Heading 3</div>
<div class="heading"  id="column4">Heading 4</div>
</div>
<div class="t_data" id="t_data">
<table class="t_content">
    <tr class='t_row'>
        <td class='column1'>Column1 Row 0</td>
        <td class='column2'>Column2 Row 0</td>
        <td class='column3'>Column3 Row 0</td>
        <td class='column4'>Column4 Row 0</td>
    </tr><tr class='t_row'>
        <td class='column1'>Column1 Row 1</td>
        <td class='column2'>Column2 Row 1</td>
        <td class='column3'>Column3 Row 1</td>
        <td class='column4'>Column4 Row 1</td>
    </tr><tr class='t_row'>
        <td class='column1'>Column1 Row 2</td>
        <td class='column2'>Column2 Row 2</td>
        <td class='column3'>Column3 Row 2</td>
        <td class='column4'>Column4 Row 2</td>
    </tr><tr class='t_row'>
        <td class='column1'>Column1 Row 3</td>
        <td class='column2'>Column2 Row 3</td>
        <td class='column3'>Column3 Row 3</td>
        <td class='column4'>Column4 Row 3</td>
    </tr><tr class='t_row'>
        <td class='column1'>Column1 Row 4</td>
        <td class='column2'>Column2 Row 4</td>
        <td class='column3'>Column3 Row 4</td>
        <td class='column4'>Column4 Row 4</td>
    </tr><tr class='t_row'>
        <td class='column1'>Column1 Row 5</td>
        <td class='column2'>Column2 Row 5</td>
        <td class='column3'>Column3 Row 5</td>
        <td class='column4'>Column4 Row 5</td>
    </tr><tr class='t_row'>
        <td class='column1'>Column1 Row 6</td>
        <td class='column2'>Column2 Row 6</td>
        <td class='column3'>Column3 Row 6</td>
        <td class='column4'>Column4 Row 6</td>
    </tr><tr class='t_row'>
        <td class='column1'>Column1 Row 7</td>
        <td class='column2'>Column2 Row 7</td>
        <td class='column3'>Column3 Row 7</td>
        <td class='column4'>Column4 Row 7</td>
    </tr><tr class='t_row'>
        <td class='column1'>Column1 Row 8</td>
        <td class='column2'>Column2 Row 8</td>
        <td class='column3'>Column3 Row 8</td>
        <td class='column4'>Column4 Row 8</td>
    </tr><tr class='t_row'>
        <td class='column1'>Column1 Row 9</td>
        <td class='column2'>Column2 Row 9</td>
        <td class='column3'>Column3 Row 9</td>
        <td class='column4'>Column4 Row 9</td>
    </tr><tr class='t_row'>
        <td class='column1'>Column1 Row 10</td>
        <td class='column2'>Column2 Row 10</td>
        <td class='column3'>Column3 Row 10</td>
        <td class='column4'>Column4 Row 10</td>
    </tr>
<!--
<?php
$data = array();
for($a = 0; $a<50; $a++)
{
    $data[$a] = array();
    $data[$a][0] = "Column1 Row ".$a;
    $data[$a][1] = "Column2 Row ".$a;
    $data[$a][2] = "Column3 Row ".$a;
    $data[$a][3] = "Column4 Row ".$a;
}
/*
 ** supose you have data in an array.. which red from database. The table will draw using array data. Or you can draw the table manualy.
 ** tip: If using manual table, No need of
 ** 'var x = document.getElementsByClassName(object); var y = x[0].clientWidth;'.
 ** You can just set ID of first row's cells in to some name and use it to read width.
 */
for($i=0;$i<sizeof($data);$i++){
    echo "<tr class='t_row'><td class='column1'>".$data[$i][0]."</td><td class='column2'>".$data[$i][1]."</td><td class='column3'>".$data[$i][2]."</td><td class='column4'>".$data[$i][3]."</td></tr>";
}
?>
-->
</table>
</div>
</body>
</html> 
```

# ruby-on-rails - 处理货币/金钱的最佳方法是什么？

> ID：1019939
> 
> 赞同：341
> 
> 时间：2009-06-19T20:36:18.160
> 
> 标签：ruby-on-rails, ruby, currency

我正在开发一个非常基本的购物车系统。

我有一个表`items`，其中有一列`price`type `integer`。

对于包含欧元和美分的价格，我无法在我的视图中显示价格值。就在 Rails 框架中处理货币而言，我是否遗漏了一些明显的东西？

* * *

## 回答 #1

> 赞同：511
> 
> 时间：2009-06-19T20:48:57.167

您可能希望`DECIMAL`在数据库中使用一种类型。在您的迁移中，请执行以下操作：

```
# precision is the total number of digits
# scale is the number of digits to the right of the decimal point
add_column :items, :price, :decimal, :precision => 8, :scale => 2 
```

在 Rails 中，`:decimal`类型返回为`BigDecimal`，这对于价格计算非常有用。

如果您坚持使用整数，您将不得不在`BigDecimal`任何地方手动转换为 s 和从 s 转换，这可能会变得很痛苦。

正如 mcl 所指出的，要打印价格，请使用：

```
number_to_currency(price, :unit => "€")
#=> €1,234.01 
```

* * *

## 回答 #2

> 赞同：119
> 
> 时间：2010-10-02T00:15:14.620

这是一种利用`composed_of`（ActiveRecord 的一部分，使用 ValueObject 模式）和 Money gem的精细、简单的方法

你需要

*   [金钱宝石](https://github.com/RubyMoney/money)（4.1.0 版）
*   一个模型，例如`Product`
*   `integer`例如，模型（和数据库）中的列`:price`

把它写在你的`product.rb`文件中：

```
class Product > ActiveRecord::Base

  composed_of :price,
              :class_name => 'Money',
              :mapping => %w(price cents),
              :converter => Proc.new { |value| Money.new(value) }
  # ... 
```

你会得到什么：

*   没有任何额外的更改，您的所有表格都将显示美元和美分，但内部表示仍然只是美分。表单将接受诸如“$12,034.95”之类的值并为您转换。无需在模型中添加额外的处理程序或属性，或在视图中添加帮助程序。
*   `product.price = "$12.00"`自动转换为 Money 类
*   `product.price.to_s`显示十进制格式的数字（“1234.00”）
*   `product.price.format`显示货币格式正确的字符串
*   如果您需要发送美分（到需要便士的支付网关），`product.price.cents.to_s`
*   货币兑换免费

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-06-19T20:48:39.260

处理货币的常见做法是使用十进制类型。这是“使用 Rails 进行敏捷 Web 开发”的一个简单示例

```
add_column :products, :price, :decimal, :precision => 8, :scale => 2 
```

这将允许您处理从 -999,999.99 到 999,999.99 的价格
您可能还希望在您的项目中包含验证，例如

```
def validate 
  errors.add(:price, "should be at least 0.01") if price.nil? || price < 0.01 
end 
```

理智地检查你的价值观。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2018-09-26T00:05:08.590

对于一些有抱负的 RoR 开发的初级/初学者来说，只需一点更新和所有答案的凝聚力，肯定会来到这里进行一些解释。

### 用钱工作

正如@molf`:decimal`所建议的那样，用于在数据库中存储资金（以及我的公司在处理资金时使用的黄金标准）。

```
# precision is the total number of digits
# scale is the number of digits to the right of the decimal point
add_column :items, :price, :decimal, precision: 8, scale: 2 
```

几点：

*   `:decimal`将被用来`BigDecimal`解决很多问题。

*   `precision`并且`scale`应该根据您所代表的内容进行调整

    *   如果您处理接收和发送付款，`precision: 8`并`scale: 2`给您`999,999.99`最高金额，这在 90% 的情况下都可以。

    *   如果您需要表示财产或稀有汽车的价值，则应使用更高的`precision`.

    *   如果您使用坐标（经度和纬度），您肯定需要更高的`scale`.

### 如何生成迁移

要生成具有上述内容的迁移，请在终端中运行：

```
bin/rails g migration AddPriceToItems price:decimal{8-2} 
```

或者

```
bin/rails g migration AddPriceToItems 'price:decimal{5,2}' 
```

正如这篇[博](http://mitrev.net/rails/2015/04/19/rails-migration-generator-specifying-precision-and-scale/)文中所解释的那样。

### 货币格式

[告别](https://en.wikipedia.org/wiki/KISS_principle)额外的库并使用内置帮助程序。用作@molf`number_to_currency`和@facundofarias 的建议。

要在 Rails 控制台中使用helper，请向's类`number_to_currency`发送调用以访问 helper。`ActiveSupport``NumberHelper`

例如：

```
ActiveSupport::NumberHelper.number_to_currency(2_500_000.61, unit: '€', precision: 2, separator: ',', delimiter: '', format: "%n%u") 
```

给出以下输出

```
2500000,61€ 
```

检查[number_to_currency](https://apidock.com/rails/ActionView/Helpers/NumberHelper/number_to_currency)助手的另一个`options`。

### 放在哪里

您可以将它放在应用程序助手中，并在视图中以任意数量使用它。

```
module ApplicationHelper    
  def format_currency(amount)
    number_to_currency(amount, unit: '€', precision: 2, separator: ',', delimiter: '', format: "%n%u")
  end
end 
```

或者您可以将其作为实例方法放入`Item`模型中，并在需要格式化价格的地方（在视图或助手中）调用它。

```
class Item < ActiveRecord::Base
  def format_price
    number_to_currency(price, unit: '€', precision: 2, separator: ',', delimiter: '', format: "%n%u")
  end
end 
```

并且，我如何使用`number_to_currency`内部控制器的示例（注意`negative_format`选项，用于表示退款）

```
def refund_information
  amount_formatted = 
    ActionController::Base.helpers.number_to_currency(@refund.amount, negative_format: '(%u%n)')
  {
    # ...
    amount_formatted: amount_formatted,
    # ...
  }
end 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2017-02-02T16:35:26.003

如果您使用的是 Postgres（因为我们现在是 2017 年），您可能想`:money`尝试一下他们的列类型。

```
add_column :products, :price, :money, default: 0 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2014-12-30T00:38:26.910

使用[money-rails gem](https://github.com/RubyMoney/money-rails)。它可以很好地处理您模型中的货币和货币，并且还有一堆帮手来格式化您的价格。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2012-09-22T21:08:45.360

使用[虚拟属性（链接到修订（付费）Railscast）](http://railscasts.com/episodes/16-virtual-attributes-revised)，您可以将您的 price_in_cents 存储在一个整数列中，并在您的产品模型中添加一个虚拟属性 price_in_dollars 作为 getter 和 setter。

```
# Add a price_in_cents integer column
$ rails g migration add_price_in_cents_to_products price_in_cents:integer

# Use virtual attributes in your Product model
# app/models/product.rb

def price_in_dollars
  price_in_cents.to_d/100 if price_in_cents
end

def price_in_dollars=(dollars)
  self.price_in_cents = dollars.to_d*100 if dollars.present?
end 
```

来源：[RailsCasts #016：**虚拟属性**](http://railscasts.com/episodes/16-virtual-attributes-revised)：*虚拟属性是一种添加不直接映射到数据库的表单字段的干净方法。在这里，我将展示如何处理验证、关联等。*

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-09-06T09:45:11.663

绝对是[整数](http://www.setfiremedia.com/blog/7-top-tips-for-coding-with-currency)。

即使 BigDecimal 在技术上存在`1.5`，仍然会在 Ruby 中为您提供纯浮点数。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-10-17T10:35:51.260

如果有人使用 Sequel，则迁移看起来像：

```
add_column :products, :price, "decimal(8,2)" 
```

不知何故，续集忽略了 :precision 和 :scale

（续集版本：sequel (3.39.0, 3.38.0)）

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2015-02-10T01:42:20.650

我的底层 API 都使用美分来表示金钱，我不想改变这一点。我也没有用大量资金工作。所以我只是把它放在一个辅助方法中：

```
sprintf("%03d", amount).insert(-3, ".") 
```

这会将整数转换为至少包含三位数字的字符串（必要时添加前导零），然后在最后两位数字之前插入一个小数点，从不使用`Float`. 从那里您可以添加适合您的用例的任何货币符号。

它*肯定*又快又脏，但有时这很好！

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-02-17T17:34:18.083

我以这种方式使用它：

```
number_to_currency(amount, unit: '€', precision: 2, format: "%u %n") 
```

当然，货币符号、精度、格式等取决于每种货币。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-08-23T05:31:53.040

您可以将一些选项传递给`number_to_currency`（标准 Rails 4 视图助手）：

```
number_to_currency(12.0, :precision => 2)
# => "$12.00" 
```

由[Dylan Markow发布](https://stackoverflow.com/a/5968624/737275)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-03-30T08:37:51.400

**Ruby & Rails 的简单代码**

```
<%= number_to_currency(1234567890.50) %>

OUT PUT => $1,234,567,890.50 
```

# performance - 具有多个相同列索引的 Oracle 性能

> ID：1019940
> 
> 赞同：5
> 
> 时间：2009-06-19T20:37:03.743
> 
> 标签：performance, indexing, oracle9i

我正在使用一个新的 Oracle 数据库，其中一个表具有以下索引：

*   索引 1：ColA、ColB
*   索引 2：ColA

第二个索引是多余的吗，这会对性能产生负面影响吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-07-02T07:50:54.007

谷歌是我最好的朋友：

[http://www.orafaq.com/node/926](http://www.orafaq.com/node/926)

这篇文章的主要观点是：

```
If 2 indexes ( I1 and I2 ) exist for a table and
   the number of columns in Index I1 is less or equal to the number of column in index I2 and
   index I1 has the same columns in the same order as leading columns of index I2 
Then
   If index I1 is UNIQUE then
      If index I2 is used to support Foregh Key or for Index Overload then
         Do Nothing
      Else
         Index I2 can be DROPPED
      End If
   Else
      Index I1 can be DROPPED
   End If
End If 
```

我同意这一点！事实上，在 Google 中搜索“重复索引”会有不同的答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-05T07:29:57.013

第二个索引是不同的，并且本身不是多余的。

这个查询怎么样：

```
SELECT DISTINCT ColA FROM TABLE WHERE ColA IS NOT NULL; 
```

Oracle 可以完全从索引 2 回答这个问题。现在，索引 2 应该比索引 1 小（块更少）。这意味着，对于上述查询来说，它是一个更好的索引。

如果您的应用程序从未执行过比 Index1 更适合 Index2 的查询，那么它对您的应用程序来说是多余的。

索引始终是性能权衡。当执行插入、更新或删除时，为了维护每个附加索引，需要做额外的工作。

指数提供的更高性能是否足以弥补这一点？取决于您的应用程序和数据使用情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T20:41:15.530

第二个索引有点多余——任何使用 Index2 的操作都可以使用索引 1。此外，由于还有另一个索引要更新，因此写入会稍微慢一些。

也就是说，Index2 并不是完全多余的，因为它可能会更快一些，因为索引本身可能会明显更小。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T20:55:07.733

如果您的统计信息过时，优化器可能会在需要索引 1 时选择索引 2。（当然，优化器的提示可以解决这个问题。）

# f# - 递归序列会泄漏内存吗？

> ID：1019945
> 
> 赞同：10
> 
> 时间：2009-06-19T20:39:14.940
> 
> 标签：f#, memory-leaks, sequence, tail-recursion

我喜欢递归地定义序列，如下所示：

```
let rec startFrom x =
    seq {
        yield x;
        yield! startFrom (x + 1)
    } 
```

我不确定在实践中是否应该使用这样的递归序列。`yield!` *似乎*是尾递归的，但我不能 100% 确定，因为它是从另一个 IEnumerable 内部调用的。从我的角度来看，代码在每次调用时都会创建一个 IEnumerable 实例而不关闭它，这实际上也会使该函数泄漏内存。

**这个函数会泄漏内存吗？就此而言，它甚至是“尾递归”吗？**

[编辑添加]：我正在摸索 NProf 的答案，但我认为获得有关在 SO 上实现递归序列的技术解释会很有帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-19T21:25:46.923

我现在正在工作，所以我正在查看比 Beta1 稍新的位，但是在我的盒子上处于发布模式，然后使用 .Net Reflector 查看编译的代码，看来这两个

```
let rec startFromA x =    
    seq {        
        yield x     
        yield! startFromA (x + 1)    
    }

let startFromB x =    
    let z = ref x
    seq {        
        while true do
            yield !z
            incr z
    } 
```

在“发布”模式下编译时生成几乎相同的 MSIL 代码。它们的运行速度与以下 C# 代码大致相同：

```
public class CSharpExample
{
    public static IEnumerable<int> StartFrom(int x)
    {
        while (true)
        {
            yield return x;
            x++;
        }
    }
} 
```

（例如，我在我的盒子上运行了所有三个版本并打印了第 100 万个结果，每个版本大约需要 1.3 秒，+/- 1 秒）。（我没有做任何内存分析；我可能遗漏了一些重要的东西。）

简而言之，除非您衡量并看到问题，否则我不会过多思考此类问题。

**编辑**

我意识到我并没有真正回答这个问题......我认为简短的回答是“不，它不会泄漏”。（有一种特殊意义，即所有“无限”IEnumerables（带有缓存的后备存储）“泄漏”（取决于您如何定义“泄漏”），请参阅

[避免堆栈溢出（使用 F# 无限序列）](https://stackoverflow.com/questions/898988/avoiding-stack-overflow-with-f-infinite-sequences-of-sequences)

有关 IEnumerable（又名“seq”）与 LazyList 的有趣讨论，以及消费者如何急切地使用 LazyLists 以“忘记”旧结果以防止某种“泄漏”。）

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-06-19T20:53:24.007

.NET 应用程序不会以这种方式“泄漏”内存。即使您正在创建许多对象，垃圾回收也会释放任何与应用程序本身没有根的对象。

.NET 中的内存泄漏通常以您在应用程序中使用的非托管资源（数据库连接、内存流等）的形式出现。像这样创建多个对象然后放弃它们的实例不被视为内存泄漏，因为垃圾收集器能够释放内存。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-06-19T20:55:33.287

它不会泄漏任何内存，它只会生成一个无限序列，但由于序列是 IEnumerables，因此您可以枚举它们而无需担心内存问题。递归发生在序列生成函数内部这一事实不会影响递归的安全性。请注意，在调试模式下，可能会禁用尾调用优化以允许完全调试，但在发布时不会有任何问题。

# git - 将 repo 克隆到 Windows 上时，如何阻止 git 添加回车符？

> ID：1019946
> 
> 赞同：11
> 
> 时间：2009-06-19T20:39:20.480
> 
> 标签：git, git-config

我的笔记本电脑上仍然有 XP，并且已经安装了 Git，以便我可以在上面做一些工作。当我从我的服务器（即 linux）克隆一个存储库时，它会自动在每一行添加回车符。所以现在 Git 认为每个文件都被修改了，而实际上他们没有。

我尝试将以下行添加到我的 .gitconfig 文件中，但无济于事

```
[core]
    autocrlf = true 
```

或者

```
[core]
    autocrlf = input 
```

我也试过跑步

```
git config core.autocrlf <value> 
```

在有问题的存储库中，然后很难重置。这似乎也不起作用。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-19T20:46:16.533

为什么不是“autocrlf = false？”。

# c# - 是否可以使用 DLR 加载和执行 C# 片段？

> ID：1019947
> 
> 赞同：8
> 
> 时间：2009-06-19T20:39:45.923
> 
> 标签：c#, dynamic-language-runtime, embedded-language

我发现的有关 DLR 的大部分材料都与 IronPython 有关。您可以使用 DLR 解析和执行 C# 吗？如果是这样，是否有开销会阻止您在具有大约 30 个用户的 Web 服务器上尝试此操作？

更具体地说，我想在用户首次启动工作流时编写我的工作流对象的配置脚本。根据全年变化的条件，工作流程可能从不同的步骤开始，因此运行配置脚本似乎是处理变化的好方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T20:49:23.783

听起来您真的在谈论 C#“编译器即服务”（在[本视频](http://channel9.msdn.com/pdc2008/TL16/)的结尾），它有望在 .NET 的 5.0 时间范围内（尽管 Mono[现在已经有了](http://www.go-mono.com/docs/index.aspx?link=N:Mono.CSharp)）。目前，[CSharpCodeProvider](http://msdn.microsoft.com/en-us/library/microsoft.csharp.csharpcodeprovider.aspx)是我们所拥有的最好的（其工作方式很大程度上类似于“csc”）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T21:16:37.987

尽管 Marc 为我提供了替代方案，但我阅读了这个相关的[SO 问题](https://stackoverflow.com/questions/297624/vbx-language-hosting-via-dlr)，并且 C# 和 VB 尚不支持。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-02T16:15:00.420

您可能会发现这很相关……尽管它不在 DLR 本身上运行。

[Mono 编译器即服务 (MCS)](https://stackoverflow.com/questions/3407318/mono-compiler-as-a-service-mcs)

它的优点是运行代码片段而不是像 CodeDom 那样在每次编译时加载新程序集。

# language-agnostic - 用于序列校正的 N-Grams

> ID：1019953
> 
> 赞同：0
> 
> 时间：2009-06-19T20:41:35.170
> 
> 标签：language-agnostic, sequences

对不起这个困难的问题。

我有一大组序列要通过/或添加数字或替换它们（从不删除任何东西）来纠正，如下所示：

*   1,2,,3 => 1,7,4,3
*   4,,5,6 => 4,4,5,6
*   4,7,8,9 => 4,7,8,9,1
*   4,7 => 4,8
*   4,7,1 => 4,7,2

它从填充的原始序列和样本校正开始。

我希望能够通过计算要纠正的不同 n-gram 的频率来自动纠正序列，第一个样本将变为

*   1=>1
*   2=>7
*   3=>3
*   1,2=>1,7
*   2,3=>7,4,3
*   1,2,3=>1,7,4,3

我会收集这些 n-gram 校正的频率，并且我正在寻找一种方法来计算校正样本数据中可能存在或不存在的新输入的最佳方法。

这似乎类似于[SMT](http://en.wikipedia.org/wiki/Statistical_machine_translation)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T21:25:34.660

根据替换的长度和出现的次数为已知替换分配一个分数。天真地，我建议使这个分数与长度的平方成正比（在我能想到的大多数情况下，更长的匹配更罕见）和出现次数的平方根，这样一个 4 项序列就有尽可能多的权重作为一个出现 16 次的 2 项序列。这需要根据您的实际情况进行调整。

给定一个长度为 M 的序列，有 N 个长度为 1 到 M 的子字符串，其中 N=M*(M+1)/2，因此如果字符串相当短，那么您可以遍历每个子字符串并查找可能的替换。我认为，用这些子字符串组成整个字符串的方法数量也与 M^2 成正比。

对于子字符串对原始字符串的每个可能组合，将每个子字符串的最佳（最高分数）替换的总分数相加。

总分最高的组合将是（可能，考虑到我对过程的假设）“最好的”替换后结果。

# c# - 迭代 LINQ 实体结果

> ID：1019956
> 
> 赞同：3
> 
> 时间：2009-06-19T20:43:21.407
> 
> 标签：c#, linq, entity-framework

我有一段我认为非常简单的代码，但结果让我感到困惑。我正在使用 LINQ 查询实体，然后遍历结果以创建一个数组。我正在查看进出数据库的流量，那里的一切看起来都很好。当我将 LINQ 发送到 SQL 的查询复制并直接针对 SQL 运行时，我得到了预期的结果。然而，当我对结果进行迭代时——或者甚至对结果进行观察——每条记录都是完全相同的。这*不是*SQL 返回的内容。我究竟做错了什么？

```
var eventList = from e in entityContext.AuctionSet select e;

ArrayList DayArray = new ArrayList();
int i = 0;

foreach (Auction ae in eventList)
{
    // If I put a watch on eventList all the records are the same!
    Auction temp = ae; // Even tried copying to a temp value per another solution

    // Even though the records are different in the database, 
    // and the correct number of records are returned, EVERY "ae" instance 
    // has the exact same values!
    DayArray.Add(new {
                id = i,
                title = temp.County.ToString()
                });
            i++;
 } 
```

谢谢！

编辑：忘记提及实体来自视图，考虑到有关主键的评论，这是有道理的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-19T20:56:52.800

您是否可能错误地配置了主键，以至于 EF 认为某些东西是主键，而实际上每一行都具有相同的值？重要的是，EF 有义务在每次看到具有与以前看到的相同类型+主键的对象时为您提供**相同的实例。**

因此，如果您的所有记录如下所示：

```
id   | title | ...
-----+-------+-------
1    | Foo   | ...
1    | Bar   | ...
1    | Baz   | ...
... 
```

如果 EF 认为这`id`是一个主键，它每次都会返回相同的对象 - 所以你会看到`Foo`, `Foo`, `Foo`...

# php - 准备好的声明没有返回任何东西

> ID：1019959
> 
> 赞同：3
> 
> 时间：2009-06-19T20:43:40.703
> 
> 标签：php, mysqli, prepared-statement

我知道这个特定的查询有效，因为我用未经准备的程序方法对其进行了测试。这里是：

```
$name = 'introduction';
$mysqli = new mysqli('localhost', 'user', 'pass', 'db') or die('There was a problem connecting to the database.');
$stmt = $mysqli->prepare("SELECT name, content FROM sections WHERE name = ?");
$stmt->bind_param('s', $name);
$stmt->execute();
$stmt->bind_result($content);
$stmt->fetch();
echo  $content;
$stmt->close(); 
```

我意识到，由于我在 section 表中有一个 id 列作为索引，因此我也需要绑定它，因为上面有 php.net 上的声明（再次感谢 Bill）。

这是新代码：

```
$name = 'introduction';
$mysqli = new mysqli('localhost', 'user', 'pass', 'db') or die('There was a problem connecting to the database.');
$stmt = $mysqli->prepare("SELECT name, content FROM sections WHERE name = ?");
$stmt->bind_param('s', $name);
$stmt->execute();
$stmt->bind_result($id, $name, $content);
$stmt->fetch();
echo $content;
$stmt->close(); 
```

再次感谢所有可以提供建议的人。（我很好奇：当以这种方式使用 OOP 样式的预准备语句时，我发现很难调试。例如，是否有一种简单的方法可以简单地查看实际使用的查询？）

如果我执行以下操作，就像一个简单粗暴的例子：

```
$name = 'introduction';
@mysql_connect('host', 'user', 'pass');
@mysql_select_db('db');
$query = "SELECT name,content FROM sections WHERE name = '$name'";
$result = mysql_query($query) or die(mysql_error());
while($row = mysql_fetch_object($result)) {
    $content = $row->content;
    echo $content;
} 
```

我的数据出现了，一切都很好。但是，如果我执行以下操作：

```
$name = 'introduction';
$mysqli = new mysqli('localhost', 'user', 'pass', 'db') or die('There was a problem connecting to the database.');
$stmt = $mysqli->prepare("SELECT name, content FROM sections WHERE name = ?");
$stmt->bind_param('s', $name);
$stmt->execute();
$stmt->bind_result($name, $content);
$stmt->fetch();
echo  $content;
$stmt->close(); 
```

我认为这是正确的（当然，如果不是，请随意大喊），我什么也没得到。更重要的是，使用该代码，当我进行 html 验证（以防万一）时，我收到内部服务器警告（500），我认为这是 sql 代码的问题。我只是疯了吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T20:53:41.107

我看不出你准备语句或使用参数有什么问题，但是你的绑定结果有问题：

[http://php.net/manual/en/mysqli-stmt.bind-result.php](http://php.net/manual/en/mysqli-stmt.bind-result.php)说：

> 请注意，**所有列都**必须在`mysqli_stmt_execute()`调用之后和之前绑定`mysqli_stmt_fetch()`。

（强调我的）

* * *

上述文档应视为查询中的所有列，而不是表中的所有列。

好吧，我自己也试过了。如果我省略该`$name`列，它会给出以下警告：

```
PHP Warning:  mysqli_stmt::bind_result(): Number of bind variables doesn't 
match number of fields in prepared statement in mysqli.php on line 9
PHP Stack trace:
PHP   1\. {main}() /Users/bill/workspace/PHP/mysqli.php:0
PHP   2\. mysqli_stmt->bind_result() /Users/bill/workspace/PHP/mysqli.php:9 
```

但它确实获取数据。

如果我将两者都绑定`$name`到`$content`查询结果，则它可以正常工作而不会出现错误或警告。

所以我不得不问你：你*确定*数据库中有一行符合你的条件吗？也就是说，在哪里`name = 'introduction'`？请记住，在 SQL 中，字符串比较默认区分大小写。

我看到人们经常犯的一个错误是，他们在 PHP 脚本中连接到不同的数据库，而不是他们用于临时查询的数据库。因此，您需要绝对确定您正在验证数据是否存在于正确的数据库中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T20:53:39.717

那不应该是

```
$stmt->bind_result($name, $content); 
```

当您选择 2 列时

# .net - 在 .Net 2.0 库中支持 DataContract

> ID：1019964
> 
> 赞同：1
> 
> 时间：2009-06-19T20:45:43.103
> 
> 标签：.net, .net-2.0, attributes, compatibility, datacontract

是否可以创建一个可以从 .Net 2.0 使用的库，并且如果他们愿意，还允许 .Net 3.0+ 消费者从 DataContracts 中受益？

除了包含不同 DataContract 相关属性的库是 .Net 3.0 库之外，我没有看到任何技术障碍。这些属性可以像 ExtensionMethodAttribute 一样手动实现吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T21:11:44.017

如果您将 .NET 3.0 属性添加到程序集，然后在仅具有 .NET 2.0 的机器上运行它，这相当于在您的代码中具有一个在运行时不可用的程序集的属性。

只要 .NET 2.0 应用程序实际上不尝试读取属性，这大部分都可以正常工作。例如，以下代码将引发 FileNotFoundException，因为如果在具有 .NET 2.0 的机器上运行，它将无法加载 System.ServiceModel.dll：

```
[ServiceContract] // Attribute from System.ServiceModel.dll
class MyClass
{
  ...
}
...
    // this will throw a FileNotFoundException if System.ServiceModel.dll is not available
    object[] attributes = typeof(MyClass).GetCustomAttributes(false); 
```

因此，如果您不知道谁将使用您的类库，则无法保证 100% 不会破坏它们。

可以通过将 System.ServiceModel.dll （或其他包含您正在使用的属性的程序集）的副本与您的应用程序一起发送，或者（我认为）通过使用带有 System.Type 参数的 GetCustomAttributes 的重载来避免上述情况，所以您只读取已知可用的属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T20:47:34.987

由于 .NET 2.0 和 .NET 3.0 和 3.5 使用相同的 CLR (2.0)，因此您应该没有任何困难。

# javascript - javascript淡化动画

> ID：1019965
> 
> 赞同：0
> 
> 时间：2009-06-19T20:45:52.667
> 
> 标签：javascript, dom, animation

我希望某个 DOM 元素淡入我的脚本中。我尝试使用超时功能，但无法让它工作。

```
hover.addEventListener('mouseover',function () {Core.addClass(cpanel,"on");},false); 
```

请告诉我如何为此实现淡入效果。请不要推荐 jquery 或任何其他框架。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T20:49:12.177

您能否提供与您的 JS 一起使用的标记，以便我们知道我们在看什么？

此外，如果您不想使用 jQuery 或其他框架，您仍然可以查看它们的实现以了解如何使这种东西工作。由于 IE6 对透明度的支持参差不齐，淡出是众所周知的难以实现跨浏览器的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T23:12:10.640

这么多优秀的 Javascript 开发人员编写了动画函数，你真的会帮自己一个忙（和你的观众）来使用他们的。人们建议使用 jQuery，这很棒。MooTools 是另一个不错的选择。

但是，如果您想了解如何用 Javascript 编写动画，我在这里很快就做了一些事情。请注意，没有跨浏览器测试，我敢肯定它在 IE6 中不起作用（甚至是 IE7？）。我也不想，我很欣赏其他人已经为我测试过的代码。

这只是关于如何使用本机 Javascript 执行此操作的一个想法：

```
function fadeIn(el, speed) {
    el.style.opacity = 0;
    var interval = setInterval(function(){
        el.style.opacity = parseFloat(el.style.opacity) + 0.1;
        if(el.style.opacity == 1.0) {
            clearInterval(interval);
        }
    },speed / 10);
} 
```

# delphi - delphi 释放多个对象

> ID：1019978
> 
> 赞同：2
> 
> 时间：2009-06-19T20:50:55.167
> 
> 标签：delphi

下面，我插入了 Ray Konopka 编写的代码（Coderage 演示文稿的一部分）。我打算使用它，但是，我不确定如何（即时）清理多个对象。我所有的尝试都没有成功并导致内存泄漏。任何想法表示赞赏。谢谢，

```
 program stringlistDictionary;

{$APPTYPE CONSOLE}

uses
 Classes,
 SysUtils;

 type
   TPlayer = class
  public
   Name: string;
   Position: string;
   Hits: Integer;
   AtBats: Integer;
   constructor Create( Name, Position: string );
 end;

   constructor TPlayer.Create( Name, Position: string );
    begin
      inherited Create;
      Self.Name := Name;
      Self.Position := Position;
      Hits := 0;
      AtBats := 0;
    end;

    var
      Team: TStringList;
      Player, NewPlayer: TPlayer;
      I: Integer;

    function FindPlayer( const Name: string ): TPlayer;
    var
      Idx: Integer;
    begin
      Result := nil;
      if Team.Find( Name, Idx ) then
        Result := TPlayer( Team.Objects[ Idx ] );
    end;

    begin {== Main ==}

      Writeln( 'StringList Dictionary' );
      Writeln( '---------------------' );
      Writeln;

      Team := TStringList.Create;
      try
        NewPlayer := TPlayer.Create( 'Aramis Ramerez', 'Third Base' );
        NewPlayer.Hits := 120;
        NewPlayer.AtBats := 350;

        Team.AddObject( NewPlayer.Name, NewPlayer );

        NewPlayer := TPlayer.Create( 'Derrick Lee', 'First Base' );
        NewPlayer.Hits := 143;
        NewPlayer.AtBats := 329;

        Team.AddObject( NewPlayer.Name, NewPlayer );

        NewPlayer := TPlayer.Create( 'Ryan Theriot', 'Short Stop' );
        NewPlayer.Hits := 87;
        NewPlayer.AtBats := 203;

        Team.AddObject( NewPlayer.Name, NewPlayer );

        Player := FindPlayer( 'Derrick Lee' );
        if Player <> nil then
          Writeln( 'Player Found: ', Player.Name, ', ', Player.Position )
        else
          Writeln( 'Player not found.' );
        Writeln;

        Writeln( 'Active Roster' );
        Writeln( '-------------' );

        for I := 0 to Team.Count - 1 do
          Writeln( TPlayer( Team.Objects[ I ] ).Name, #9,
                   TPlayer( Team.Objects[ I ] ).Position );

        Readln;

      finally
        //!! Need to free the players.
        Team.Free;
      end;

    end. 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-19T21:01:11.170

在 Delphi 2009 中，TStringList 构造函数有一个可选的布尔参数“OwnsObjects”。如果将其设置为 true，则会自动释放对象。

否则，您可以执行以下操作：

```
for i := Team.Count-1 downto 0 do begin
  Team.Objects.Free;
end;
Team.Free; 
```

顺便说一句，不鼓励公共领域。您最好使用属性，这样您就可以控制对字段的访问权限。您可以添加 setter 函数来验证输入。

```
type
  TPlayer = class
  private
    FName     : string;
    FPosition : string;
    FHits     : Integer;
    FAtBats   : Integer;
  public
    constructor Create(const AName, APosition: string );

    property Name: string read FName;
    property Position: string read FPosition;
    property Hits: Integer read FHits write FHits;
    property AtBats: Integer read FAtBats write FAtBats;
 end; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-20T07:05:41.097

有点明显，但仍然 - 您不必在每次要清除 TStringList 对象时编写“for ... Free”代码。您可以将其放入全局函数中。

```
procedure FreeObjects(sl: TStringList);
var
  i: integer;
begin
  for i := 0 to sl.Count - 1 do 
    sl.Objects[i].Free;
end;

FreeObjects(Team); 
```

或者您可以将其放入 TStringList 助手中。

```
TStringListHelper = class helper for TStringList
public
  procedure FreeObjects;
end;

procedure TStringListHelper.FreeObjects;
var
  i: integer;
begin
  for i := 0 to Count - 1 do 
    Objects[i].Free;
end;

Team.FreeObjects; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-20T01:11:46.513

只是对gamecat答案的澄清：我不了解delphi 2009，但通常 Objects 属性需要一个索引，而您实际上并不需要反向循环，所以：

```
for i := 0 to Team.Count-1 do
  Team.Objects[i].Free;
Team.Free; 
```

或者：

```
while Team.Count > 0 do
begin
  Team.Objects[0].Free;
  Team.Delete(0);
end;
Team.Free; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-21T13:27:26.537

使用 D7，我可以将 TStingList 子类化

# ssas - 学习如何在 SSAS 中实现朴素贝叶斯分类器的最佳资源是什么？

> ID：1019979
> 
> 赞同：2
> 
> 时间：2009-06-19T20:51:03.280
> 
> 标签：ssas, data-mining, bayesian

问完这个[问题](https://stackoverflow.com/questions/1019153/what-type-of-algorithm-would-you-use-to-help-forecast-future-performance-based-on)后，我决定尝试使用 SQL Server Analysis Services 实现一些朴素贝叶斯分类器。

谁能给我指出一本关于如何在 SSAS 中实现朴素贝叶斯分类器的好书、网站或任何其他资源？同样，我会对学习决策树感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T20:52:58.970

[使用 SQL Server 2008 进行数据挖掘](https://rads.stackoverflow.com/amzn/click/com/0470277742)——这本书解释了每种算法的作用，并指导您如何应用每种算法。如果您正在进入数据挖掘领域，请务必阅读它。

[SQL Server Data Mining](http://www.sqlserverdatamining.com/ssdm/) - 提供教程、示例等的站点。

# parsing - 如何获取网页上字体的大小？

> ID：1019985
> 
> 赞同：0
> 
> 时间：2009-06-19T20:53:10.310
> 
> 标签：parsing, web-crawler, render

在 webspiders/crawlers 中，如何获取用户在 HTML 文档中看到的字体的实际*初始*渲染大小，*同时牢记 CSS。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T20:59:45.867

渲染文本大小？用户可以使用他/她的浏览器设置随意更改文本大小。更不用说不同的浏览器呈现相同的内容略有不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T21:30:58.627

如果您对“默认”的答案感到满意，没有为此目的的用户自定义视图（这似乎很可能），我相信您正在寻找一个相当痛苦的场景：

*   在你的蜘蛛中嵌入一个支持 CSS 的渲染引擎。更喜欢使用与大多数用户匹配的引擎，或者使用所有三个常见引擎并为所有用户存储信息。嵌入的难易程度因您的消费技术而异。

*   在渲染引擎中加载被爬取的 URI。

*   使用引擎的 API，查询包含您认为具有代表性的文本的元素的字体度量（选择这是一个练习，我什至不会开始预测策略）。您如何访问它将完全取决于您的引擎的嵌入方案。

我希望这是“艰难的方式”，但我不确定是否有“简单”的方式。

# php - 将纬度/经度转换为 X/Y 坐标

> ID：1019997
> 
> 赞同：17
> 
> 时间：2009-06-19T20:56:37.853
> 
> 标签：php, javascript, maps, coordinates, proj4js

我有纽约市的纬度/经度值；40.7560540,-73.9869510 和地球的平面图像，1000px × 446px。

我希望能够使用 Javascript 将 Lat/Long 转换为 X、Y 坐标，该点将反映该位置。

因此，图像左上角的 X，Y 坐标将是；289, 111

注意事项：

1.  不要担心使用什么投影的问题，做出自己的假设或使用你知道可能有用的东西
2.  X,Y 可以形成图像的任何角落
3.  PHP 中相同解决方案的奖励积分（但我真的需要 JS）

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-20T01:04:17.823

您使用的投影将改变一切，但这将在假设墨卡托投影的情况下起作用：

```
<html>
<head>
<script language="Javascript">
var dot_size = 3;
var longitude_shift = 55;   // number of pixels your map's prime meridian is off-center.
var x_pos = 54;
var y_pos = 19;
var map_width = 430;
var map_height = 332;
var half_dot = Math.floor(dot_size / 2);
function draw_point(x, y) {
    dot = '<div style="position:absolute;width:' + dot_size + 'px;height:' + dot_size + 'px;top:' + y + 'px;left:' + x + 'px;background:#00ff00"></div>';
    document.body.innerHTML += dot;
}
function plot_point(lat, lng) {
    // Mercator projection

    // longitude: just scale and shift
    x = (map_width * (180 + lng) / 360) % map_width + longitude_shift;

    // latitude: using the Mercator projection
    lat = lat * Math.PI / 180;  // convert from degrees to radians
    y = Math.log(Math.tan((lat/2) + (Math.PI/4)));  // do the Mercator projection (w/ equator of 2pi units)
    y = (map_height / 2) - (map_width * y / (2 * Math.PI)) + y_pos;   // fit it to our map

    x -= x_pos;
    y -= y_pos;

    draw_point(x - half_dot, y - half_dot);
}
</script>
</head>
<body onload="plot_point(40.756, -73.986)">
    <!-- image found at http://www.math.ubc.ca/~israel/m103/mercator.png -->
    <img src="mercator.png" style="position:absolute;top:0px;left:0px">
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-19T21:54:18.113

js中的一个基本转换函数是：

```
MAP_WIDTH = 1000;
MAP_HEIGHT = 446;

function convert(lat, lon){
    var y = ((-1 * lat) + 90) * (MAP_HEIGHT / 180);
    var x = (lon + 180) * (MAP_WIDTH / 360);
    return {x:x,y:y};
} 
```

这将返回左上角的像素数。该函数假设如下：

1.  您的图像与左上角 (0,0) 正确对齐，与 90* 北 180* 西对齐。
2.  您的坐标以 N 为 -、S 为 +、W 为 - 和 E 为 +

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T21:36:08.977

如果你有一张整个地球的照片，那么投影总是很重要。但也许我只是不明白你的问题。