# StackOverflow 问答 12320000-12320999

# java - 在 Java 中通过套接字有效地发送大 int[]

> ID：12320000
> 
> 赞同：14
> 
> 时间：2012-09-07T14:23:01.487
> 
> 标签：java, android, performance, sockets, casting

我正在开发一个 Java 应用程序，我需要尽快通过套接字连接将 500,000 个整数的数组从一部 Android 手机发送到另一部 Android 手机。主要瓶颈似乎是转换整数以便套接字可以接受它们，无论我使用 ObjectOutputStreams、ByteBuffers 还是低级别的掩码和移位转换。通过套接字从一个 Java 应用程序向另一个应用程序发送 int[] 的最快方法是什么？

这是迄今为止我尝试过的所有代码的代码，以及我正在测试的 LG Optimus V 的基准测试（600 MHz ARM 处理器，Android 2.2）。

**低电平掩码移位：0.2 秒**

```
public static byte[] intToByte(int[] input)
{
    byte[] output = new byte[input.length*4];

    for(int i = 0; i < input.length; i++) {
        output[i*4] = (byte)(input[i] & 0xFF);
        output[i*4 + 1] = (byte)((input[i] & 0xFF00) >>> 8);
        output[i*4 + 2] = (byte)((input[i] & 0xFF0000) >>> 16);
        output[i*4 + 3] = (byte)((input[i] & 0xFF000000) >>> 24);
    }

    return output;
} 
```

**使用 ByteBuffer 和 IntBuffer：0.75 秒**

```
public static byte[] intToByte(int[] input)
{
    ByteBuffer byteBuffer = ByteBuffer.allocate(input.length * 4);        
    IntBuffer intBuffer = byteBuffer.asIntBuffer();
    intBuffer.put(input);

    byte[] array = byteBuffer.array();

    return array;
} 
```

**ObjectOutputStream：3.1 秒（我尝试了使用 DataOutPutStream 和 writeInt() 而不是 writeObject() 的变体，但差别不大）**

```
public static void sendSerialDataTCP(String address, int[] array) throws IOException
{
    Socket senderSocket = new Socket(address, 4446);

    OutputStream os = senderSocket.getOutputStream();
    BufferedOutputStream  bos = new BufferedOutputStream (os);
    ObjectOutputStream oos = new ObjectOutputStream(bos);
    oos.writeObject(array);

    oos.flush();
    bos.flush();
    os.flush();
    oos.close();
    os.close();
    bos.close();

    senderSocket.close();
} 
```

**最后，我用来发送 byte[]: 的代码比 intToByte() 函数多花 0.2 秒**

```
public static void sendDataTCP(String address, byte[] data) throws IOException
{
    Socket senderSocket = new Socket(address, 4446);

    OutputStream os = senderSocket.getOutputStream();
    os.write(data, 0, data.length);
    os.flush();

    senderSocket.close();
} 
```

我在套接字的两侧编写代码，这样我就可以尝试任何类型的字节序、压缩、序列化等。必须有一种方法可以在 Java 中更有效地进行这种转换。请帮忙！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T15:09:14.873

正如我在评论中指出的那样，我认为您正在违反处理器的限制。由于这可能对其他人有帮助，因此我将对其进行分解。这是将整数转换为字节的循环：

```
 for(int i = 0; i < input.length; i++) {
        output[i*4] = (byte)(input[i] & 0xFF);
        output[i*4 + 1] = (byte)((input[i] & 0xFF00) >>> 8);
        output[i*4 + 2] = (byte)((input[i] & 0xFF0000) >>> 16);
        output[i*4 + 3] = (byte)((input[i] & 0xFF000000) >>> 24);
    } 
```

此循环执行 500,000 次。您的 600Mhz 处理器每秒可以处理大约 600,000,000 次操作。因此，循环的每次迭代每次操作将消耗大约 1/1200 秒。

同样，使用非常粗略的数字（我不知道 ARM 指令集，因此每个操作可能或多或少），这是一个操作计数：

*   测试/分支：5（检索计数器、检索数组长度、比较、分支、递增计数器）
*   掩码和移位：10 x 4（检索计数器、检索输入数组基数、加法、检索掩码、移位、乘法计数器、添加偏移量、添加到输出基数、存储）

OK, so in rough numbers, this loop takes *at best* 55/1200 of a second, or 0.04 seconds. However, you're not dealing with best case scenario. For one thing, with an array this large you're not going to benefit from a processor cache, so you'll introduce wait states into every array store and load.

Plus, the basic operations that I described may or may not translate directly into machine code. If not (and I suspect not), the loop will cost more than I've described.

Finally, if you're really unlucky, the JVM hasn't JIT-ed your code, so for some portion (or all) of the loop it's interpreting bytecode rather than executing native instructions. I don't know enough about Dalvik to comment on that.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T14:42:36.353

Java 是 IMO 从来没有打算像你在 C 中那样有效地重新解释内存区域`int[]`。`byte[]`它甚至没有这样的内存地址模型。

您要么需要本地发送数据，要么可以尝试找到一些微优化。但我怀疑你会收获很多。

例如，这可能比您的版本稍快（如果它确实有效）

```
public static byte[] intToByte(int[] input)
{
    byte[] output = new byte[input.length*4];

    for(int i = 0; i < input.length; i++) {
        int position = i << 2;
        output[position | 0] = (byte)((input[i] >>  0) & 0xFF);
        output[position | 1] = (byte)((input[i] >>  8) & 0xFF);
        output[position | 2] = (byte)((input[i] >> 16) & 0xFF);
        output[position | 3] = (byte)((input[i] >> 24) & 0xFF);
    }
    return output;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T14:55:59.040

如果您不反对使用库，您可能需要查看 Google 的[Protocol Buffers](http://code.google.com/p/protobuf/)。它是为更复杂的对象序列化而构建的，但我敢打赌，他们努力弄清楚如何在 Java 中快速序列化整数数组。

编辑：我查看了 Protobuf 源代码，它使用了类似于你的低级掩码和移位的东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-07T15:03:04.753

我会这样做：

```
Socket senderSocket = new Socket(address, 4446);

OutputStream os = senderSocket.getOutputStream();
BufferedOutputStream bos = new BufferedOutputStream(os);
DataOutputStream dos = new DataOutputStream(bos);

dos.writeInt(array.length);
for(int i : array) dos.writeInt(i);
dos.close(); 
```

另一方面，读起来像：

```
Socket recieverSocket = ...;
InputStream is = recieverSocket.getInputStream();
BufferedInputStream bis = new BufferedInputStream(is);
DataInputStream dis = new DataInputStream(bis);

int length = dis.readInt();
int[] array = new int[length];

for(int i = 0; i < length; i++) array[i] = dis.readInt();
dis.close(); 
```

# javascript - Javascript不需要的关闭行为

> ID：12320002
> 
> 赞同：1
> 
> 时间：2012-09-07T14:23:17.080
> 
> 标签：javascript

> **可能重复：**
> [循环内的 Javascript 闭包 - 简单的实际示例](https://stackoverflow.com/questions/750486/javascript-closure-inside-loops-simple-practical-example)

我试图编写类似的代码：

```
var funcs = [];
for (var i=0; i<5 ; ++i) {
    funcs[i]=function() {
        alert(i);
    };
} 
```

显然，调用`funcs[0]`不会`0`像预期的那样发出警报，仅仅是因为该变量`i`被匿名函数捕获，并且调用任何一个`funcs[0..4]`都会发出警报“4”（`i`最后一次迭代后的值并由所有创建的函数共享）。

我想到的第一个解决方法是使用某种函数生成器：

```
var funcs = [];
for (var i=0; i<5 ; ++i) {
    funcs[i]=(function(cap) {
        return function() {alert(cap)};
    })(i);
} 
```

这可以解决问题，但看起来确实令人费解且难以阅读。有没有更好的方法来获得预期的行为而不使用函数包装器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T14:29:49.627

该[`.bind`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind)函数允许您将附加参数预绑定到绑定函数：

```
var funcs = [];
for (var i=0; i<5 ; ++i) {
    funcs[i]=function(i) {
        alert(i);
    }.bind(this, i);
} 
```

这是一个 ES5 函数，所以应该可以在 IE9+、Chrome、Safari、Firefox 上运行：

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T14:30:24.137

您应该尽可能简单地编写它。我认为这很容易理解，但很难阅读。因此，简化它的一种方法是使用嵌套编码样式。我不认为它比现在更简单。

我建议这样：

```
var funcs = [];

for (var i = 0; i < 5; ++i) {
    funcs[i] = (
        function (cap) {
            return function () { alert(cap) };
        }
    )(i);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T14:31:11.800

恕我直言，出于性能和可读性的原因，命名函数通常更优越。为什么不这样做：

```
function foo (cap) {
    return function () { alert(cap) };
}

var funcs = [];
for (var i=0; i<5 ; ++i) {
    funcs[i]=foo(i);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T14:26:43.490

当您不想将代码嵌入那些匿名函数时，一种解决方案是定义（命名）类嵌入状态（i）和函数（在原型中）。那是更多的 LOC，但**有时**更具可读性：

```
var funcs = [];
function MyFunc(i) {
   this.i=i;
}
MyFunc.prototype.doIt = function(){
   alert(this.i);
};
for (var i=0; i<5 ; ++i) {
    funcs[i]=new MyFunc(i);
}

funcs[2].doIt();​ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-07T14:32:16.590

试试这个：

```
var funcs = [0, 1, 2, 3, 4].map(function(i) {
    return function() {alert(i);};
}); 
```

注意：`map`IE8 和更早版本不支持，但有一个[通用](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/map#Compatibility)的 polyfill 。

# c++ - 从 std::thread 获取返回码？

> ID：12320003
> 
> 赞同：9
> 
> 时间：2012-09-07T14:23:16.823
> 
> 标签：c++, multithreading, c++11, return-value

> **可能重复：**
> [C++：来自 std::thread 的简单返回值？](https://stackoverflow.com/questions/7686939/c-simple-return-value-from-stdthread)

无论如何要从 std::thread 获取返回码？我有一个返回整数的函数，我希望能够在线程完成执行时从函数中获取返回码。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-09-07T14:28:04.930

不，这不是`std::thread`目的。

相反，用于`async`获取`future`：

```
#include <future>

int myfun(double, char, bool);

auto f = std::async(myfun, arg1, arg2, arg3);  // f is a std::future<int>

// ...

int res = f.get(); 
```

您可以使用（零超时）的[`wait_for`](http://en.cppreference.com/w/cpp/thread/future/wait_for)成员函数`f`来查看结果是否准备好。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-09-07T15:33:01.560

正如其他人所建议的那样，`<future>`可以使用其中的设施。但是我反对这个答案

> 不，你不能这样做`std::thread`

这是一种方法来做你想做的事`std::thread`。这绝不是唯一的方法：

```
#include <thread>
#include <iostream>

int func(int x)
{
    return x+1;
}

int main()
{
    int i;
    std::thread t([&] {i = func(2);});
    t.join();
    std::cout << i << '\n';
} 
```

这将可移植地输出：

```
3 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-09-07T15:22:29.033

Kerrek SB 的回答是正确的，但我建议添加另一个示例（他建议应该是一个答案，所以在这里）。

我最近发现，至少在 VC11 中，[`std::async`直到应用程序结束才会释放线程的所有资源](https://connect.microsoft.com/VisualStudio/feedback/details/761209/boost-thread-specific-ptr-leaks-on-vs2012-when-using-std-async)，从而可能导致**内存泄漏误报**（如果您正在使用例如 Visual Leak Detector 监视它们）。

在这里我的意思是，在大多数基本应用程序中，不值得看这个答案的其余部分，但**如果像我一样，你需要检查内存泄漏并且不能让误报**，比如静态数据在结束时没有发布主功能。如果是您的情况，那么这可能会有所帮助。

**`std::async`默认情况下不保证在单独的线程中运行，**仅当您`std::launch::async`用作第一个参数时。否则由实现决定做什么，这就是为什么 VC11 实现将使用新的 Microsoft 并发运行时任务管理器将提供的功能作为推送到任务池中的任务来管理，这意味着以透明的方式维护和管理线程。有一些方法可以显式终止任务管理器，但这太特定于平台，**当您想要 1）确保启动一个线程并且 2）稍后获得结果和 3）确保线程完全释放时，异步是一个糟糕的选择你得到结果**。

完全做到这一点的替代方法是使用`std::packaged_task`并`std::thread`与`std::future`. 它的完成方式几乎与 using 相似`std::async`，只是更冗长一些（这意味着您可以根据需要在自定义模板函数中对其进行概括）。

```
#include <packaged_task>
#include <thread>

int myfun(double, char, bool);

std::packaged_task<int(double, char, bool)> task(myfun, arg1, arg2, arg3); 

auto f = task.get_future();  // f is a std::future<int> 
```

首先我们创建一个任务，基本上是一个包含函数和`std::promise`与未来相关联的对象。`std::packaged_task`主要像以下的增强版本一样工作`std::function`：

现在我们需要显式地执行线程：

```
std::thread thread(std::move(task));

thread.detach(); 
```

移动是必要的，因为`std::packaged_task`不可复制。仅当您只想使用未来进行同步时才需要分离线程 - 否则您将需要显式加入线程。如果你不这样做，当线程的析构函数被调用时，它只会调用`std::terminate()`.

```
// ...

int res = f.get(); // Synchronization and retrieval. 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-07T15:15:23.687

这是一个使用示例`packaged_task`：

```
#include <future>
#include <iostream>

void task_waiter(std::future<int>&& f) {
    std::future<int> ft = std::move(f);
    int result = ft.get();
    std::cout << result << '\n';
}

int the_task() {
    return 17;
}

int main() {
    std::packaged_task<int()> task(the_task);
    std::thread thr(task_waiter, task.get_future());
    task();
    thr.join();
    return 0;
} 
```

# java - Java Runtime.getRuntime().exec() youtube2mp3

> ID：12320004
> 
> 赞同：1
> 
> 时间：2012-09-07T14:23:19.407
> 
> 标签：java, servlets, runtime.exec, raspberry-pi, youtube-dl

我正在为我的 Raspberry Pi 开发一个 Java 项目，需要帮助让 Runtime 正常工作。

youtube2mp3 使用 youtube-dl 和 ffmpeg（信息：http: [//jeffreyv.hubpages.com/hub/Youtube-to-MP3-on-Ubuntu-Linux](http://jeffreyv.hubpages.com/hub/Youtube-to-MP3-on-Ubuntu-Linux)）

在 iMac 上编写代码时，我稍微修改了脚本：

```
x=youtube-dl-$RANDOM-$RANDOM.flv
youtube-dl --output=$x --format=18 "$1"
ffmpeg -i $x -acodec libmp3lame -ac 2 -ab 128k -vn -y "$2"
mv "$2" ~/Downloads
rm $x
rm *.mp4 
```

然后我厌倦了在我的 servlet 中调用它来开始下载：

```
try {
        String command = "sudo /usr/local/bin/youtube2mp3 \"" + requestedSong.getTrackUrl() +"\" \"" + requestedSong.getTrackArtist() + "-" + requestedSong.getTrackTitle() + ".mp3\"";
        System.out.println("CMD: " + command);
        //Process child = Runtime.getRuntime().exec( new String[]{"/usr/local/bin/youtube2mp3", "\"" + requestedSong.getTrackUrl() + "\"", "\"" + requestedSong.getTrackArtist() + "-" + requestedSong.getTrackTitle() + ".mp3 \""});
        Process child = Runtime.getRuntime().exec(command);
        child.waitFor();
        InputStream in = child.getInputStream();
        Scanner sc = new Scanner(new BufferedReader(new InputStreamReader(in)));
        String line = "";
        while (sc.hasNextLine()) {
          line = sc.nextLine();
           System.out.println("INFO: " + line);
        }
    } catch (InterruptedException ex) {
        Logger.getLogger(ControlServlet.class.getName()).log(Level.SEVERE, null, ex);
    } catch (IOException ex) {
        Logger.getLogger(ControlServlet.class.getName()).log(Level.SEVERE, null, ex);
    }

} 
```

该命令在运行时非常冗长，但我的扫描仪对象没有获取任何内容。我尝试将此代码保留在 servlet 中并使用线程，但两次都失败了。

该命令不需要 sudo 来运行，我已经更改为 sudoers 文件，不需要管理员的密码（我在程序的前面使用 Runtime() 运行 arp 扫描）

我能够将规则复制并粘贴到“命令”输出的终端中，并且运行良好。

任何帮助将不胜感激。

**更新**

这是运行 youtube2mp3 命令的输出：

```
sudo /usr/local/bin/youtube2mp3 "http://www.youtube.com/watch?v=X_tbksFYhl4" "test-none.mp3"
[youtube] Setting language
[youtube] X_tbksFYhl4: Downloading video webpage
[youtube] X_tbksFYhl4: Downloading video info webpage
[youtube] X_tbksFYhl4: Extracting video information
[download] Destination: youtube-dl-7433-2196.flv
[download] 100.0% of 39.17M at    1.83M/s ETA 00:00
ffmpeg version 0.11.1 Copyright (c) 2000-2012 the FFmpeg developers
built on Sep  6 2012 13:52:52 with clang 4.0 ((tags/Apple/clang-421.0.60))
configuration: --prefix=/usr/local/Cellar/ffmpeg/0.11.1 --enable-shared --enable-gpl --enable-version3 --enable-nonfree --enable-hardcoded-tables --cc=cc --host-cflags= --host-ldflags= --enable-libx264 --enable-libfaac --enable-libmp3lame --enable-libxvid
libavutil      51\. 54.100 / 51\. 54.100
libavcodec     54\. 23.100 / 54\. 23.100
libavformat    54\.  6.100 / 54\.  6.100
libavdevice    54\.  0.100 / 54\.  0.100
libavfilter     2\. 77.100 /  2\. 77.100
libswscale      2\.  1.100 /  2\.  1.100
libswresample   0\. 15.100 /  0\. 15.100
libpostproc    52\.  0.100 / 52\.  0.100
Input #0, mov,mp4,m4a,3gp,3g2,mj2, from 'youtube-dl-7433-2196.flv':
Metadata:
major_brand     : mp42
minor_version   : 0
compatible_brands: isomavc1mp42
creation_time   : 2010-01-17 00:16:32
Duration: 00:09:59.23, start: 0.000000, bitrate: 548 kb/s
Stream #0:0(und): Audio: aac (mp4a / 0x6134706D), 44100 Hz, stereo, s16, 113 kb/s
Metadata:
  creation_time   : 2010-01-17 00:16:32
  handler_name    : (C) 2007 Google Inc. v08.13.2007.
Stream #0:1(und): Video: h264 (Constrained Baseline) (avc1 / 0x31637661), yuv420p, 480x270 [SAR 1:1 DAR 16:9], 432 kb/s, 29.97 fps, 29.97 tbr, 30k tbn, 59.94 tbc
Metadata:
  creation_time   : 2010-01-17 00:16:33
  handler_name    : (C) 2007 Google Inc. v08.13.2007.
Output #0, mp3, to 'test-none.mp3':
Metadata:
major_brand     : mp42
minor_version   : 0
compatible_brands: isomavc1mp42
TDEN            : 2010-01-17 00:16:32
TSSE            : Lavf54.6.100
Stream #0:0(und): Audio: mp3, 44100 Hz, stereo, s16, 128 kb/s
Metadata:
  creation_time   : 2010-01-17 00:16:32
  handler_name    : (C) 2007 Google Inc. v08.13.2007.
Stream mapping:
 Stream #0:0 -> #0:0 (aac -> libmp3lame)
Press [q] to stop, [?] for help
size=    9364kB time=00:09:59.22 bitrate= 128.0kbits/s    
video:0kB audio:9363kB global headers:0kB muxing overhead 0.006039%
rm: *.mp4: No such file or directory 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:10:00.947

来自Process类文档：*由于一些原生平台只为标准输入输出流提供有限的缓冲区大小，未能及时写入子进程的输入流或读取输出流可能会导致子进程阻塞，甚至死锁。*

你提到你得到一个详细的输出，所以我会尝试将 移到块`child.waitFor();`的末尾`try`。你不必担心你会失去任何东西。相反，流数据在操作系统中非常自然。我很确定 InputStream 在进程完成之前不会关闭。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T22:51:40.293

终于让它工作了。必须使用带有“/bin/sh”的字符串数组

```
try {
        String outputInput = requestedSong.getTrackArtist() + "-" + requestedSong.getTrackTitle() + ".flv";
        String cmd1 = "sudo /usr/local/bin/youtube-dl --output=\"" + outputInput +"\" --format=18 \"" + requestedSong.getTrackUrl() +"\"";
        String cmd2 = "sudo /usr/local/bin/ffmpeg -i \"" + outputInput +"\" -acodec libmp3lame -ac 2 -ab 128k -vn -y \"" + requestedSong.getTrackArtist() + " - " + requestedSong.getTrackTitle() +".mp3\"";
        String cmd3 = "mv \"" + requestedSong.getTrackArtist() + " - " + requestedSong.getTrackTitle() +".mp3\" ~/Downloads";
        String cmd4 = "rm -f outputInput";

        String[] cmdList = {cmd1, cmd2, cmd3, cmd4};

        for(int i = 0; i < cmdList.length; i++)
        {
            String[] cmd = {"/bin/sh", "-c", cmdList[i]};
            System.out.println("CMD: " + cmdList[i]);
            Process child = Runtime.getRuntime().exec(cmd);
            InputStream in = child.getInputStream();
            Scanner sc = new Scanner(new BufferedReader(new InputStreamReader(in)));
            String line = "";
            while (sc.hasNextLine()) 
            {
                line = sc.nextLine();
                System.out.println("INFO: " + line);
            }
            child.waitFor();
        }
    } catch (InterruptedException ex) {
        Logger.getLogger(ControlServlet.class.getName()).log(Level.SEVERE, null, ex);
    } catch (IOException ex) {
        Logger.getLogger(ControlServlet.class.getName()).log(Level.SEVERE, null, ex);
    }

    } 
```

# sql - 在 Oracle 中，如何在同一列上使用子条件进行搜索

> ID：12320007
> 
> 赞同：0
> 
> 时间：2012-09-07T14:23:27.767
> 
> 标签：sql, oracle

在 Oracle 中，我如何找到必须具有 Feature1 并且至少具有 Feature2 或 Feature3 之一的汽车。示例表和预期结果应如下图所示。谢谢基兰![在此处输入图像描述](../Images/b0f0d1ab36ef94a8db1263b591f5499a.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T14:34:26.620

这应该有效：

```
select t1.car, t1.feature
from yourtable t1
inner join
(  -- inner select returns the cars with the Feature1 and Feature2 or Feature3
  select car, feature
  from yourtable 
  where feature = 'Feature1'
    and exists (select car
                from yourtable 
                where feature in ('Feature2', 'Feature3'))
) t2
  on t1.car = t2.car
where t1.feature in ('Feature1', 'Feature2', 'Feature3') -- this excludes any other features 
```

# 见[SQL Fiddle with Demo](http://sqlfiddle.com/#!4/20172/15)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T14:56:46.503

我喜欢用 GROUP BY 和 HAVING 来做到这一点：

```
select car
from t
group by car
having max(case when feature = 'Feature1' then 1 else 0 end) = 1 and
       max(case when feature in ('Feature1', 'Feature2') then 1 else 0 end) = 1 
```

此查询返回汽车。要获得这些功能，您必须重新加入 tis：

```
select t.*
from (select car
      from t
      group by car
      having max(case when feature = 'Feature1' then 1 else 0 end) = 1 and
             max(case when feature in ('Feature1', 'Feature2') then 1 else 0 end) = 1
     ) c join
     t
     on t.car = c.car 
```

我喜欢这种方法，因为相同的想法可用于处理许多不同的相似查询——AND 条件、OR 条件、不同的子组和不同的计数。

# sql - T-SQL 返回不起作用

> ID：12320008
> 
> 赞同：4
> 
> 时间：2012-09-07T14:23:32.083
> 
> 标签：sql, tsql, sql-server-2008-r2

我的 T-SQL 有问题，以查看该项目是否存在于表中，但我有错误消息

> 消息 178，级别 15，状态 1，行 2 在此上下文中不能使用具有返回值的 RETURN 语句。消息 178，级别 15，状态 1，第 4 行 在此上下文中不能使用具有返回值的 RETURN 语句。

```
IF EXISTS(SELECT COUNT(timesheetID)
FROM [TaskManagementSystem_DB].[dbo].[Timesheet_entry]
WHERE userID ='12'  AND CONVERT(date, startTimeStamp)=CONVERT(date, getdate())) 
    RETURN 1
else
RETURN 0 
```

整个代码：

```
ALTER PROCEDURE [dbo].[CheckTimesheetIsEXISTS_forUser]  @UserID uniqueidentifier

AS 
BEGIN    
-- SET NOCOUNT ON added to prevent extra result sets from   
-- interfering with SELECT statements.  SET NOCOUNT ON;

IF EXISTS(SELECT COUNT(timesheetID) FROM 
 [TaskManagementSystem_DB].[dbo].[Timesheet_entry] 
 WHERE userID
  ='3fd971f7-e6e8-40fe-a90d-a7c9df8bf7b5'  
 AND CONVERT(date, startTimeStamp)=CONVERT(date, getdate()))

  RETURN 1 
else 
 RETURN 0 
END 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T14:26:41.657

Return 在存储过程/用户定义的函数中工作。

简单的 tsql 只是一批命令。我猜你想写 SELECT 而不是 RETURN。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T14:26:46.617

您只能调用`return`存储过程和函数。我假设这也不是。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-07T14:29:30.947

尝试这个：

```
ALTER PROCEDURE [dbo].[CheckTimesheetIsEXISTS_forUser]  @UserID uniqueidentifier

AS 
BEGIN   

SELECT CASE WHEN COUNT(timesheetID) > 0 THEN 1 ELSE 0 END AS isExists
    FROM [TaskManagementSystem_DB].[dbo].[Timesheet_entry]
    WHERE userID = @UserID  AND CONVERT(date, startTimeStamp)=
     CONVERT(date, getdate())

END 
```

# html - 对齐 Div 中的 li 元素

> ID：12320010
> 
> 赞同：0
> 
> 时间：2012-09-07T14:23:36.070
> 
> 标签：html, css, web

我需要在我的 div 中对齐 3 个不同的元素。它们位于 ul 列表中：Left、Center 和 Right。

我尝试使用 float: right 作为右侧元素，margin: 0 auto 使用宽度作为中心元素。但它仍然不会自动对齐。

元素也可以是图像，而不仅仅是文本。 [http://jsfiddle.net/PwmrC/](http://jsfiddle.net/PwmrC/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T14:29:21.763

`display:table`并且`table-cell`可能是您的解决方案。这是[小提琴演示](http://jsfiddle.net/PwmrC/2/)。

稍后编辑：[重做示例](http://jsfiddle.net/PwmrC/7/)

# c# - 是否可以在 C# 中的复杂数组上使用相交？

> ID：12320013
> 
> 赞同：0
> 
> 时间：2012-09-07T14:23:38.590
> 
> 标签：c#, arrays, linq

我有两个学生姓名和考试成绩数组。

每个数组只包含不同的学生（没有重复），并且结构为`arrStudentGroup1[0][0] = "Bob"`和`arrStudentGroup1[0][1] = "98"`。

给定两个数组，是否可以用来`Intersect`创建存在于`arrStudentGroup1`和中的第三个学生数组`arrStudentGroup2`？

我希望第三个数组有他们的名字和考试成绩。我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T14:38:44.450

如果您*只*想要两个组中的学生姓名而**不是**相关的考试成绩，只需在 name 数组元素上相交：

```
var students1 = arrStudentGroup1.Select(group => group[0]);
var students2 = arrStudentGroup2.Select(group => group[0]);

var studentsInBoth = students1.Intersect(students2); 
```

~~如果您还想要相关的测试分数，您需要实现一个[`IEqualityComparer<T>`](http://msdn.microsoft.com/en-us/library/ms132151.aspx)比较每个数组的第一个元素的方法。~~

如果您想要相关的考试成绩，请加入两个数组：

```
var intersection = from s1 in arrStudentGroup1
      join s2 in arrStudentGroup2 on s1[0] equals s2[0]
      select new {Name = s1[0], Score1 = s1[1], Score2 = s2[1]}

foreach (var item in intersection)
{
    Console.Writeline("{0}: s1={1}, s2={2}", Name, Score1, Score2);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T14:57:03.410

首先将数组压缩（在一般意义上，而不是`Zip`方法上）到一个结构中，该结构将学生与分数分组：

鉴于：

```
string[][] arrStudentGroup1 = new string[][]{new string[]{"Bob","98"}, new string[]{"Alice","98"}, new string[]{"Charles","78"}, new string[]{"Dariah","99"}};
string[][] arrStudentGroup2 = new string[][]{new string[]{"Bob","98"}, new string[]{"Fiona","98"}, new string[]{"Eve","78"}, new string[]{"Dariah","99"}}; 
```

然后：

```
var zipped1 = arrStudentGroup1.Select(student => new {Name = student[0], Score = student[1]});
var zipped2 = arrStudentGroup2.Select(student => new {Name = student[0], Score = student[1]}); 
```

现在得到路口。请注意，如果同一学生姓名在一个但分数不同，则**不会**算作交叉点。这也可以处理，但我将您的问题解释为不想要这种情况。如果我读错了，请告诉我：

```
var inter = zipped1.Intersect(zipped2); 
```

现在，无论如何，您都可以理想地使用它，甚至可以使用`new {Name = student[0], Score = int.Parse(student[1])}`上面的数字而不是字符串（在大多数情况下更有用），坦率地说，这比处理数组数组更好，而且类型更安全。不过，如果您真的希望它采用相同的格式 string[] 格式：

```
var interArray = inter.Select(st => new string[]{st.Name, st.Score}); 
```

如果你真的，真的希望整个事情都采用相同的 string[][] 格式：

```
var interArrays = interArray.ToArray(); 
```

或者对于单行奇迹（主要是可读性较差，但如果在同一方法中还有其他事情发生，有时最好将查询放在一行上）：

```
var interArrays = arrStudentGroup1
  .Select(student => new {Name = student[0], Score = student[1]})
  .Intersect(
    arrStudentGroup2
    .Select(student => new {Name = student[0], Score = student[1]})
  ).Select(st => new string[]{st.Name, st.Score}).ToArray() 
```

输出：

```
{"Bob", "98"},{"Dariah", "99"} 
```

编辑：或者，定义一个`IEqualityComparer<string[]>`like：

```
public class StudentComparer : IEqualityComparer<string[]>
{
  public bool Equals(string[] x, string[] y)
  {
    if(ReferenceEquals(x, y))
      return true;
    if(x == null || y == null)
      return false;
    return x.SequenceEqual(y);
  }
  public int GetHashCode(string[] arr)
  {
    return arr == null ? 0 : arr.Select(s => s == null ? 0 : s.GetHashCode()).Aggregate((x, y) => x ^ y);
  }
} 
```

然后直接使用它：

```
var intersection = arrStudentGroup1.Intersect(arrStudentGroup2, new StudentComparer()); 
```

给出相同的输出。真的更简单，但我看到数组被用作对象时的直觉是尽快将它变成一个真实的对象，而且真的，这不是一个糟糕的直觉 - 它也可以让其他事情变得更容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T14:32:17.167

嗯，你可以做这样的事情，

```
var studentsInGroup1 = arrStudentGroup1.Select(s => new 
                { 
                    Name = s[0],
                    Score = s[1]
                });

var studentsInGroup2 = arrStudentGroup2.Select(s => new 
                { 
                    Name = s[0],
                    Score = s[1]
                });

var studentsInBothGroups = studentsInGroup1.Join(
        studentsInGroup2,
        s => s.Name,
        s => s.Name,
        (one, two) => new 
             { 
                 Name = one.Name, 
                 Scores = new[] { one.Score, two.Score }
             }); 
```

这应该给你一个方便的匿名类型，你可以像这样访问。

```
foreach(var student in studentsInBothGroups)
{
   var Name = student.Name;
   var Group1Score = student.Scores[0];
   var Group2Score = student.Scores[1];
} 
```

# git - Git repo 引用其他 repos

> ID：12320015
> 
> 赞同：0
> 
> 时间：2012-09-07T14:23:48.453
> 
> 标签：git

> **可能重复：**
> [如何将 1 个 git 存储库链接到其他一些存储库？](https://stackoverflow.com/questions/4377573/how-to-link-1-git-repository-to-some-other-repositories)

我正在开发一款可以在不同平台上运行的游戏，比如 Android 和桌面，我有两个存储库，第三个存储库用于游戏逻辑，我想做的是参考 Android 和桌面中的核心存储库repo，然后当我拉取时，例如在 Android repo 中，它将下载 Android 代码和游戏的核心逻辑，我真的是 git 新手，关于这个的帖子对我来说有点混乱。那么有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T14:43:05.137

我们使用 Tortoise Git，我们所做的是在准备好部署时手动拉取该子模块。但是我们只有一个子模块，它并不重要。

我建议看看这个链接。我认为这里有很多解决方案：

[轻松拉出所有子模块的最新版本](https://stackoverflow.com/questions/1030169/git-easy-way-pull-latest-of-all-submodules)

# c# - 验证包含逗号分隔电子邮件的字符串

> ID：12320017
> 
> 赞同：6
> 
> 时间：2012-09-07T14:23:52.300
> 
> 标签：c#, asp.net-mvc-3, validation, fluentvalidation

我正在尝试在 MVC 模型中验证此属性，该模型可以包含零个或多个以逗号分隔的电子邮件地址：

```
public class DashboardVM
{
    public string CurrentAbuseEmails { get; set; }
    ...
} 
```

问题是如何使用电子邮件地址的内置流利验证规则来做到这一点？现在我有一个使用 Must 和正则表达式的解决方案，它有效，但我不觉得它......足够优雅。

```
 public DashboardVMValidator()
    {
        RuleFor(x => x.CurrentAbuseEmails).Must(BeValidDelimitedEmailList).WithMessage("One or more email addresses are not valid.");
    }

    private bool BeValidDelimitedEmailList(string delimitedEmails)
    {
        //... match very very long reg. expression
    } 
```

到目前为止，包括 RuleFor(...).EmailAddress() 在内的最接近的解决方案是在下面创建一个自定义验证器，并从字符串中对每封电子邮件调用验证，但由于某种原因这不起作用（AbuseEmailValidator 无法获取我的谓词 x => x - 在每封电子邮件上调用 validator.Validate 时）。

```
public class AbuseEmailValidator : AbstractValidator<string>
{
    public AbuseEmailValidator()
    {
        RuleFor(x => x).EmailAddress().WithMessage("Email address is not valid");
    }
} 
```

有没有办法以某种简单的方式做到这一点？类似于此解决方案的东西，但使用一个字符串而不是字符串列表，因为我不能使用 SetCollectionValidator（或者我可以吗？）：[如何使用 Fluent Validation 验证列表中的每个字符串？](https://stackoverflow.com/questions/10190316/how-do-you-validate-against-each-string-in-a-list-using-fluent-validation)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-07-01T12:30:48.610

你可以尝试这样的事情：

```
public class InvoiceValidator : AbstractValidator<ContractInvoicingEditModel>
{
    public InvoiceValidator()
    {
        RuleFor(m => m.EmailAddressTo)
            .Must(CommonValidators.CheckValidEmails).WithMessage("Some of the emails   provided are not valid");
    }
}

public static class CommonValidators
{
    public static bool CheckValidEmails(string arg)
    {
        var list = arg.Split(';');
        var isValid = true;
        var emailValidator = new EmailValidator();

        foreach (var t in list)
        {
            isValid = emailValidator.Validate(new EmailModel { Email = t.Trim() }).IsValid;
            if (!isValid)
                break;
        }

        return isValid;
    }
}
public class EmailValidator : AbstractValidator<EmailModel>
{
    public EmailValidator()
    {
        RuleFor(x => x.Email).EmailAddress();
    }
}

public class EmailModel
{
    public string Email { get; set; }
} 
```

如果您使用中介 poco，它似乎工作正常。我的电子邮件由“;”分隔 在这种情况下。希望能帮助到你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2021-08-18T21:00:33.957

从版本 9 开始，FluentValidation 支持这一点，而无需使用[`Transform`](https://docs.fluentvalidation.net/en/latest/transform.html)和[`ForEach`](https://docs.fluentvalidation.net/en/latest/collections.html)方法的自定义验证器。

在 9.0-9.4 版本中，你可以这样写：

```
RuleFor(x => x.List)
    .Transform(list => list.Split(','))
    .ForEach(itemRule => itemRule.EmailAddress()); 
```

在 9.5 及更高版本中，`RuleFor`不与 一起使用`Transform`，因此您可以这样编写：

```
Transform(x => x.List, list => list.Split(','))
    .ForEach(itemRule => itemRule.EmailAddress()); 
```

`Transform`要处理空值，请在委托中使用空合并运算符：

```
list => (list ?? "").Split(',') 
```

要处理空格，您可能需要修剪列表中的每个项目。您可以添加一个`Select`子句：

```
list => (list ?? "").Split(',')
    .Select(item => item.Trim()) 
```

如果要忽略空项，请添加一个`Where`子句：

```
list => (list ?? "").Split(',')
    .Select(item => item.Trim())
    .Where(item => !string.IsNullOrEmpty(item)) 
```

要要求列表中至少有一项，请添加`NotEmpty`规则。所以最终版本 9.5+ 的代码将如下所示：

```
Transform(x => x.List, 
    list => (list ?? "").Split(',')
        .Select(item => item.Trim())
        .Where(item => !string.IsNullOrEmpty(item)))
    .NotEmpty()
    .ForEach(itemRule => itemRule.EmailAddress()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-02-10T21:55:11.203

上面提供的答案很好，但很旧。因此，某些代码不适用于 FluentValidation Nuget 包的非版本。至少我得到了构建错误。解决方案也可以更复杂。推荐使用这个：

模型：

```
public sealed class Email
{
    public string From { get; set; }

    /// <summary>
    /// Email address(es) to (can be settable separated list, default: ;)
    /// </summary>
    public string To { get; set; }

    //.....

    /// <summary>
    /// Separator char for multiple email addresses
    /// </summary>
    public char EmailAddressSeparator { get; set; }

    public Email()
    {
        EmailAddressSeparator = ';';
    }
} 
```

自定义验证器：

```
public static class CommonValidators
{
    public static bool CheckValidEmails(Email email, string emails)
    {
        if(string.IsNullOrWhiteSpace(emails))
        {
            return true;
        }

        var list = emails.Split(email.EmailAddressSeparator);
        var isValid = true;

        foreach (var t in list)
        {
            var email = new EmailModel { Email = t.Trim() };
            var validator = new EmailModelValidator();

            isValid = validator.Validate(email).IsValid;
            if (!isValid)
            {
                break;
            }
        }

        return isValid;
    }

    private class EmailModel
    {
        public string Email { get; set; }
    }
    private class EmailModelValidator : AbstractValidator<EmailModel>
    {
        public EmailModelValidator()
        {
            RuleFor(x => x.Email).EmailAddress(EmailValidationMode.AspNetCoreCompatible).When(x => !string.IsNullOrWhiteSpace(x.Email));
        }
    }
} 
```

用法：

```
 public class EmailValidator : AbstractValidator<Email>
    {
        public EmailValidator()
        {
            RuleFor(x => x.To).NotEmpty()
                .Must(CommonValidators.CheckValidEmails)
                .WithMessage($"'{nameof(To)}' some of the emails provided are not a valid email address.");
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-12T08:36:11.073

我想要一些更简单的东西，并且能够与诸如`.When(), .Unless()`and之类的条件进行链接`.WithMessage()`。所以我在[Burhan Savci](https://stackoverflow.com/a/65808941/10268336)的解决方案的基础上使用了一种扩展方法：

```
public static class ValidatorExtensions
{
    public static IRuleBuilderOptions<T, string> CheckValidEmails<T>(this IRuleBuilder<T, string> ruleBuilder, string separator)
    {
        var emailValidator = new EmailValidator();

        return ruleBuilder.Must(emails => emails.Split(separator).All(email => emailValidator.Validate(email.Trim()).IsValid));
    }

    private class EmailValidator : AbstractValidator<string>
    {
        public EmailValidator()
        {
            RuleFor(x => x).EmailAddress();
        }
    }
} 
```

就我而言，我有一个 CRQS 命令，用于导出具有更多输入选项的数据，包括选择导出类型（文件/电子邮件/其他选项）的下拉列表。

```
 public class Command : IRequest<Result>
    {
        public string EmailAddress{ get; set; }
        public ExportType ExportType{ get; set; }

    } 
```

然后像这样使用它：

```
 public class Validator : AbstractValidator<Command>
    {
        public Validator()
        {
            RuleFor(c => c.ExportOptions.EmailAddress).CheckValidEmails(",").When(c => c.ExportType == ExportType.Email).WithMessage("One or more email addresses are not valid");
        }
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-20T11:47:28.877

您可以编写自定义验证器扩展。通过这种方式，您可以定义您想要的任何分隔符，将其用于每个字符串属性，而不仅仅是特定属性，并根据条件添加不同的消息。

您可以从文档中了解有关自定义验证器的更多信息：[https ://docs.fluentvalidation.net/en/latest/custom-validators.html](https://docs.fluentvalidation.net/en/latest/custom-validators.html)

自定义验证器扩展：

```
public static class ValidatorExtensions
{
    public static IRuleBuilderInitial<T, string> CheckValidEmails<T>(this IRuleBuilder<T, string> ruleBuilder, string separator)
    {
        bool isValid;
        var emailValidator = new EmailValidator();
        return ruleBuilder.Custom((emailsStr, context) =>
        {
            if (string.IsNullOrWhiteSpace(emailsStr))
            {
                context.AddFailure($"'{context.DisplayName}' must not be empty");
                return;
            }

            var emails = emailsStr.Split(separator);
            foreach (var email in emails)
            {
                isValid = emailValidator.Validate(email.Trim()).IsValid;
                if (!isValid)
                {
                    context.AddFailure($"'{email}' is not a valid email address");
                    break;
                }
            }
        });
    }

    private class EmailValidator : AbstractValidator<string>
    {
        public EmailValidator()
        {
            RuleFor(x => x).EmailAddress();
        }
    }
} 
```

如果您希望分隔符作为模型属性，那么您可以像这样编写扩展名：

```
public static IRuleBuilderInitial<T, string> CheckValidEmails<T>(this IRuleBuilder<T, string> ruleBuilder, Func<T, string> separatorSelector)
    {
        if (separatorSelector == null)
            throw new ArgumentNullException(nameof(separatorSelector), $"{nameof(separatorSelector)} cannot be null");

        bool isValid;
        var emailValidator = new EmailValidator();
        return ruleBuilder.Custom((emailsStr, context) =>
        {
            if (string.IsNullOrWhiteSpace(emailsStr))
            {
                context.AddFailure($"'{context.DisplayName}' must not be empty");
                return;
            }

            var separator = separatorSelector.Invoke((T) context.InstanceToValidate);
            var emails = emailsStr.Split(separator);
            foreach (var email in emails)
            {
                isValid = emailValidator.Validate(email.Trim()).IsValid;
                if (!isValid)
                {
                    context.AddFailure($"'{email}' is not a valid email address");
                    break;
                }
            }
        });
    } 
```

样品型号：

```
public class EmailsModel
{

    /// <summary>
    /// emails separated by ;
    /// </summary>
    public string Emails { get; set; }

    public string EmailsSeparator { get; set; } = ";";
} 
```

用法：

```
public class EmailsModelValidator : AbstractValidator<EmailsModel>
{
    public EmailsModelValidator()
    {
        RuleFor(x => x.Emails).CheckValidEmails(";");
        RuleFor(x => x.Emails).CheckValidEmails(x => x.EmailsSeparator);
    }
} 
```

# regex - 在 perl 中操作反向引用以进行替换

> ID：12320024
> 
> 赞同：1
> 
> 时间：2012-09-07T14:24:20.197
> 
> 标签：regex, perl

作为尝试用十进制数替换科学数字的一部分，我想将反向引用保存到字符串变量中，但它不起作用。

我的输入文件是：

```
,8E-6,
,-11.78E-16,
,-17e+7, 
```

然后我运行以下命令：

```
open FILE, "+<C:/Perl/input.txt" or die $!;
open(OUTPUT, "+>C:/Perl/output.txt") or die;

while (my $lines = <FILE>){

  $find = "(?:,)(-?)(0|[1-9][0-9]*)(\.)?([0-9]*)?([eE])([+\-]?)([0-9]+)(?:,)";
  $noofzeroesbeforecomma = eval("$7-length($4)");
  $replace = '"foo $noofzeroesbeforecomma bar"';

  $lines =~ s/$find/$replace/eeg;
  print (OUTPUT $lines);
}

close(FILE); 
```

我明白了

```
foo  bar
foo  bar
foo  bar 
```

我本来期望的地方

```
foo 6 bar
foo 14 bar
foo 7 bar 
```

`$noofzeroesbeforecomma`似乎是空的或不存在的。

即使进行了以下调整，我也会得到一个空的结果

```
$noofzeroesbeforecomma = $2; 
```

只有`$2`直接插入替换字符串才能给我一些东西（不幸的是，这不是我想要的）。

任何人都可以帮忙吗？

我在 64 位 Windows 7 机器上运行 Strawberry Perl (5.16.1.1-64bit)，并且对 Perl 非常缺乏经验

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T14:37:36.013

你的主要问题是没有使用

```
use strict;
use warnings; 
```

`warnings`会告诉你的

```
Use of uninitialized value $7 in concatenation (.) or string at ...
Use of uninitialized value $4 in concatenation (.) or string at ... 
```

我建议您尝试找到一个可以处理科学记数法的模块，而不是尝试破解您自己的模块。

您的代码按正常工作顺序可能看起来像这样。如您所见，我`q()`在您的 eval 字符串周围放置了一个，以避免它在之前被评估`$7`并`$4`存在。我还删除了 eval 本身，因为虽然 eval 上的双重 eval 有点过分。

```
use strict;
use warnings;

while (my $lines = <DATA>) {
    my $find="(?:,)(-?)(0|[1-9][0-9]*)(\.)?([0-9]*)?([eE])([+\-]?)([0-9]+)(?:,)";
    my $noof = q|$7-length($4)|;
    $lines =~ s/$find/$noof/eeg;
    print $lines;
}

__DATA__
,8E-6,
,-11.78E-16,
,-17e+7, 
```

**输出：**

```
6
14
7 
```

作为旁注，不使用`strict`是自找麻烦。在使用变量名时这样做`$noofzeroesbeforecomma`会带来两倍的麻烦，因为很容易打错字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:31:24.033

我建议您使用该模块的插件，该[`Regexp::Common::number`](https://metacpan.org/module/Regexp%3a%3aCommon%3a%3anumber)插件[`Regexp::Common`](https://metacpan.org/module/Regexp%3a%3aCommon)将为您找到所有实数并允许您替换具有指数标记的那些

这段代码显示了这个想法。使用该`-keep`选项使模块将每个组件放入其中一个`$N`变量中。指数标记 -`e`或`E`- 在 中`$7`，因此可以根据是否存在来转换数字

```
use strict;
use warnings;

use Regexp::Common;

my $real_re = $RE{num}{real}{-keep};

while (<>) {
  s/$real_re/ $7 ? sprintf '%.20f', $1 : $1 /eg;
  print;
} 
```

**输出**

给定您的示例输入，此代码将生成以下内容。可以使用替换中的附加代码进一步整理这些值

```
,0.00000800000000000000,
,-0.00000000000000117800,
,-170000000.00000000000000000000, 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T15:26:43.600

这不是关于反向引用，而是原始问题，将数字从科学记数法转换。我敢肯定在某些情况下会失败：

```
#!/usr/bin/env perl

use strict;
use warnings;
use bignum;

for (<DATA>) {
    next unless /([+-]?\d+(?:\.\d+)?)[Ee]([+-]\d+)/;
    print $1 * 10 ** $2 . "\n";
}

__DATA__
,8E-6,
,-11.78E-16,
,-17e+7, 
```

输出：

```
0.000008
-0.000000000000001178
-170000000 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T20:35:26.123

问题是 Perl 可以处理*所有*这些类型的表达式。由于 Perl 中的标准数据项是字符串，因此您只需*捕获*表达式即可使用它。所以，取这个表达式：

```
/(-?\d+(?:.\d+)?[Ee][+-]?\d+)/ 
```

从周围的文本中提取它并使用`sprintf`它来格式化它，就像 Borodin 展示的那样。

*但是*，如果它可以帮助您更好地了解您尝试做的事情，那么效果会更好

```
my ( $whole, $frac, $expon )
    = $line =~ m/(?:,)-?(0|[1-9]\d*)(?:\.(\d*))?[eE]([+\-]?\d+)(?:,)/
    ;
my $num = $expon - length( $frac ); 
```

*   如果你打算用它做算术，为什么不用指数来捕捉符号呢*？*

*   最好命名您的捕获并`eval`在不需要时避开。

*   替换——按原样——没有多大意义。

*   真的，因为符号或数字都不区分大小写，所以只需将 a`(?i)`放在开头，并避免 E "character class" `[Ee]`：

    ```
    /((?i)-?\d+(?:.\d+)?e[+-]?\d+)/ 
    ```

# android - 如何在android的webview中设置鼠标位置（pageX，pageY）？

> ID：12320026
> 
> 赞同：2
> 
> 时间：2012-09-07T14:24:26.003
> 
> 标签：android, webview

我想在android的Webview中手动设置光标位置（pageX，pageY），有人知道怎么做吗？Scrollto 不适用于以下情况：

我在 webview 中使用[FLVPlayer.swf](http://www.platipus.nl/flvplayer/download/1.0/) (http://www.platipus.nl/flvplayer/download/1.0/) 来播放 flv。但是当鼠标悬停在播放器界面时可见，否则不可见，这种方式不适用于手机（带触摸屏的Android手机，播放器界面始终显示）。所以我想知道如何隐藏界面。

# wpf - 用于选择所有文本的 TextBox AttachedProperty 未按预期工作？

> ID：12320029
> 
> 赞同：1
> 
> 时间：2012-09-07T14:24:36.050
> 
> 标签：wpf, textbox, behavior, attached-properties, selectall

我有一个名为“SelectAllOnFocus”的附加属性。真/假值。

```
 public static class TextBoxProps
    {
        private static void MyTextBoxKeyUp(object sender, KeyEventArgs e)
        {
            if (e.Key == Key.Escape)
            {
                ((TextBox)sender).Text = string.Empty;
            }
        }

        public static void SetSelectAllOnFocus(DependencyObject dependencyObject, bool     selectAllOnFocus)
        {
            if (!ReferenceEquals(null, dependencyObject))
            {
                dependencyObject.SetValue(SelectAllOnFocus, selectAllOnFocus);
            }
    }

    public static bool GetSelectAllOnFocus(DependencyObject dependencyObject)
    {
        if (!ReferenceEquals(null, dependencyObject))
        {
            return (bool)dependencyObject.GetValue(SelectAllOnFocus);
        }
        else
        {
            return false;
        }
    }

    private static void OnSelectAllOnFocus(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        bool selectAllOnFocus = (bool)e.NewValue == true;
        var theTextBox = d as TextBox;

        if (selectAllOnFocus && theTextBox != null)
        {
            theTextBox.PreviewMouseDown -= MyTextBoxMouseEnter; theTextBox.PreviewMouseDown += MyTextBoxMouseEnter;
        }
    }

    private static void MyTextBoxMouseEnter(object sender, MouseEventArgs e)
    {
        ((TextBox)sender).SelectAll();
        e.Handled = false;
    }

    public static readonly DependencyProperty SelectAllOnFocus
       = DependencyProperty.RegisterAttached("SelectAllOnFocus", typeof(bool), typeof(TextBoxEscapeProperty),
            new FrameworkPropertyMetadata(false, new PropertyChangedCallback(OnSelectAllOnFocus)));
} 
```

会发生以下情况：

1.  PreviewMouseDown 事件被触发。
2.  MyTextBoxMouseEnter 方法被调用。
3.  SelectAll() 方法被调用。
4.  当我对 ((TextBox)sender).SelectedText 进行“监视”时，该值是正确的（这意味着文本框中的任何内容都显示为 selectedText）。
5.  文本框本身没有改变。未选择任何文本。

这是一般 WPF 样式的一部分。应用程序中的所有文本框都应接收此属性及其相关行为。

我难住了。有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T14:40:34.420

如果你调用 ((TextBox)sender).UpdateLayout(); 会发生什么 SelectAll 命令之后？或者您可能需要将**键盘**焦点设置为文本框。

使用类似的东西可能是一个更好的选择，如果使用鼠标或键盘选择文本框，它会起作用。（您需要对其进行修改以检查您的“SelectAllOnFocus”属性）

在您的 App.xaml.cs

```
 protected override void OnStartup(StartupEventArgs e)
    {
        // Select the text in a TextBox when it receives focus.
        EventManager.RegisterClassHandler(typeof(TextBox), TextBox.PreviewMouseLeftButtonDownEvent, new MouseButtonEventHandler(SelectivelyIgnoreMouseButton));
        EventManager.RegisterClassHandler(typeof(TextBox), TextBox.GotKeyboardFocusEvent, new RoutedEventHandler(SelectAllText));
        EventManager.RegisterClassHandler(typeof(TextBox), TextBox.MouseDoubleClickEvent, new RoutedEventHandler(SelectAllText));
        base.OnStartup(e);
    }

    void SelectivelyIgnoreMouseButton(object sender, MouseButtonEventArgs e)
    {
        // Find the TextBox
        DependencyObject parent = e.OriginalSource as UIElement;
        while (parent != null && !(parent is TextBox))
            parent = VisualTreeHelper.GetParent(parent);

        if (parent != null)
        {
            var textBox = (TextBox)parent;
            if (!textBox.IsKeyboardFocusWithin)
            {
                // If the text box is not yet focused, give it the focus and
                // stop further processing of this click event.
                textBox.Focus();
                e.Handled = true;
            }
        }
    }

    void SelectAllText(object sender, RoutedEventArgs e)
    {
        var textBox = e.OriginalSource as TextBox;
        if (textBox != null)
            textBox.SelectAll();
    } 
```

# jquery - Smoothdivscroll：单击时（重新）定位可滚动区域 div

> ID：12320030
> 
> 赞同：1
> 
> 时间：2012-09-07T14:24:43.197
> 
> 标签：jquery, html

我正在使用 smoothdivscroll 在较小的 div 容器中仅滚动一个宽图像。我还添加了缩略图列表和 jquery 函数，以在单击缩略图时替换大图像。

单击缩略图后，“scrollablearea”容器不幸不会跳回 0,0。直到下一次悬停在滚动热点上。

你可以在这里试试：

[http://instinct-pictures.com/index.php?option=com_content&view=article&id=26&Itemid=139](http://instinct-pictures.com/index.php?option=com_content&view=article&id=26&Itemid=139)

将第一个图像滚动到左侧，然后单击 2\. 缩略图。2\. 图像存储旧的第一张图像的位置，直到下一次悬停。

我尝试使用查询手动定位“scrollablearea”，但它不起作用。有人知道如何实现这一目标吗？由于我只使用一张图像，因此无法使用 moveToElement 函数。

在下面找到我的缩略图点击功能：

```
$('.thumbnail').live("click", function() {

    $('#main_Image').hide();

    var i = $('<img />').attr('src',this.href).load(function() {
        $('#main_Image').attr('src', i.attr('src'));
        $(".scrollableArea").css("width", $('#main_Image').width());
    $(".scrollableArea").css("left", 0);

        $('#main_Image').fadeIn();

    });
    return false; 
}); 
```

# jquery-mobile - 是否可以使用 jquery mobile 和 google maps v3 制作多边形？

> ID：12320031
> 
> 赞同：1
> 
> 时间：2012-09-07T14:24:52.593
> 
> 标签：jquery-mobile, google-maps-api-3, map, polygons

有谁知道是否可以使用 jQuery Mobile 平台和 Google maps v3 围绕标记（特别是半径）制作多边形？

我希望它有点像这样工作：

[https://developers.google.com/maps/articles/mvcfun](https://developers.google.com/maps/articles/mvcfun)

[https://google-developers.appspot.com/maps/articles/mvcfun/step3](https://google-developers.appspot.com/maps/articles/mvcfun/step3)

但格式化为 jQuery 移动。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:17:38.540

是的，如果您只想要像素空间中的一个圆圈，请使用 a[`Symbol`](https://developers.google.com/maps/documentation/javascript/reference#Symbol)作为`icon`in `MarkerOptions`。

如果您想要以实际米为单位，请使用[`Circle`](https://developers.google.com/maps/documentation/javascript/reference#Circle)叠加层。

我不确定您所说的“为 jQuery mobile 格式化”是什么意思 - Google Maps API 在桌面*和*移动设备上运行良好 - 相同的代码应该*可以工作*。

# eclipse - Maven没有将战争文件放到正确的文件夹中

> ID：12320042
> 
> 赞同：1
> 
> 时间：2012-09-07T14:25:33.063
> 
> 标签：eclipse, maven, pom.xml, maven-war-plugin

这是一个片段 pom.xml

```
<build>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-war-plugin</artifactId>
        <version>2.2</version>
        <configuration>
          <webappDirectory>C:/Users/Tom/Desktop</webappDirectory>
        </configuration>
      </plugin>
    </plugins>
  </build> 
```

`target`它会在 Eclipse 工作区中的我的文件夹中创建战争文件。它应该把war文件夹放到我的桌面上，但它只把`WEB-INF, META-INF`文件夹放在那里。为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T14:42:01.360

您应该使用该`outputDirectory`选项，而不是`webappDirectory`

见[http://maven.apache.org/plugins/maven-war-plugin/war-mojo.html](http://maven.apache.org/plugins/maven-war-plugin/war-mojo.html)

# zend-framework - 在 Bootstrap.php 中使用 Zend 翻译

> ID：12320044
> 
> 赞同：2
> 
> 时间：2012-09-07T14:25:47.103
> 
> 标签：zend-framework

我在 Zend 的 Bootstrap.php 中定义了几条路线，我想用 Zend 的 translate 函数进行翻译：

```
$trans = new Zend_View_Helper_Translate();
$router->addRoute(
  'myroute',
  new Zend_Controller_Router_Route(':lang/'.$trans->translate('mytitle').'/',
    array(
      'module' => 'default',
      'controller' => 'index',
      'action' => 'statistics'
    )
  )
); 
```

助手本身似乎可以工作（不会引发异常或错误），但总是返回 mytitle 而不是语言文件中定义的实际翻译（我检查过 - 语言文件在视图中工作）。

**如何让翻译功能在 Bootstrap.php 文件中工作？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T08:29:39.450

请记住，您需要在使用之前加载翻译。加载路由翻译，例如：

```
$router->setDefaultTranslator($yourTranslator);
```

使用路由翻译的最佳方法是在要翻译 fe 的单词之前添加“@”：

```
$router->addRoute(
  '我的路线'，
  新 Zend_Controller_Router_Route(':lang/@mytitle/',
    大批（
      '模块' => '默认'，
      '控制器' => '索引',
      '行动' => '统计'
    )
  )
);
```

# css - 如何使用 CSS 增加访问过的超链接的对比度？

> ID：12320045
> 
> 赞同：2
> 
> 时间：2012-09-07T14:25:54.817
> 
> 标签：css, accessibility

我正在使用浏览器自定义 CSS 将颜色访问的超链接更改为洋红色，只是为了能够看到我点击的内容。

问题是在某些情况下对比度太差了，我确实想在 CSS 的文本周围添加某种发光，只是为了能够提高对比度。

我尝试按照我在网上找到的一些指南来添加它，但我发现对我的测试页面没有任何影响。

```
text-shadow: 2px 2px 3px red !important; 
```

注意：我只在 Safari 和 Chrome (OS X) 上尝试过。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T15:26:54.100

经过一些研究，我发现由于隐私限制，这实际上是预期的行为。你可以风格：

*   颜色
*   背景颜色
*   边框颜色
*   轮廓颜色

这是一篇关于这个主题的文章：[https ://developer.mozilla.org/en-US/docs/CSS/Privacy_and_the_:visited_selector](https://developer.mozilla.org/en-US/docs/CSS/Privacy_and_the_:visited_selector)

# macos - 应用程序可以在通知中心同时使用警报和横幅吗？

> ID：12320051
> 
> 赞同：13
> 
> 时间：2012-09-07T14:26:12.077
> 
> 标签：macos, cocoa, nsusernotification

我正在创建一个 Mac OS X 应用程序来使用通知中心。一些通知应该保留在屏幕上，直到用户与之交互，而其他通知应该在显示后不久消失。

`NSUserNotificationAlertStyle`关键和不断变化的系统偏好允许在横幅和警报之间进行更改。但是，这两种方法都会更改从我的应用程序发送的所有通知。

我可以将一些通知作为警报发送，将其他通知作为横幅发送吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-08T09:24:26.087

`NSUSerNotificationAlertStyle`是开发人员可以为应用程序设置*默认*通知样式的唯一方法，它为来自该应用程序的**所有**通知设置样式。

如果您认为拥有 2 种不同类型的通知对您来说真的很重要，您可以通过使用与主应用程序不同的 NSUserNotificationAlertStyle 隐藏的帮助应用程序来解决该问题。

请记住，尽管您设置了**默认**通知样式，但用户可以随时在通知中心首选项中更改它，从而使您的帮助应用程序无用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T14:31:50.383

不，存在不同的通知类型，以便用户可以选择他/她喜欢的内容，而不是让开发人员可以。

[如果您认为您的应用程序应该具有此功能，您应该在http://bugreporter.apple.com](http://bugreporter.apple.com)提交增强请求并让 Apple 知道。

# asp.net - 如何使 PDF 可下载，使其不在新窗口中打开

> ID：12320060
> 
> 赞同：2
> 
> 时间：2012-09-07T14:26:34.633
> 
> 标签：asp.net, pdf, download

我在 Stack 上找到了一个链接，它解释了如何执行此操作，但它仅用 PHP 术语解释。我想在我的网站上有指向 PDF 文件的链接，以便它自动转到“另存为”屏幕，而不是在网页表单中打开。这样，最终用户将能够更轻松地下载它，因为我的很多客户不知道如何在网页上执行文件/另存为。

所以我想要一个链接，例如：

```
<a href="brochure.pdf" target="_blank">Download Brochure</a> 
```

然后它会直接进入“另存为”框，并允许客户将 PDF 小册子保存到他/她的计算机上，而无需打开另一个网页。任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T14:46:25.383

如果您将“brochure.pdf”替换为在 Page_Load 事件中包含以下代码的 asp.net 页面，您将获得所需的行为：

```
 string filename = "brochure.pdf";
  Response.ContentType = "image/pdf";
  string headerValue = string.Format("attachment; filename={0}", filename);
  Response.AppendHeader("Content-Disposition", headerValue);
  Response.TransmitFile(Server.MapPath(filename));
  Response.End(); 
```

另一种方法是包含一个链接按钮，其中包含上述代码。出于安全目的，请确保验证文件名，但分配它，以便用户无法访问任意文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T14:50:57.777

除非您将 Content-Disposition 标头添加到响应中，否则您不能仅从超链接（或可靠地使用 Javascript）强制下载文件；因此，解决此问题并始终强制下载文件的一种方法可能是拥有一个中间页面，该页面将为您添加标题。

因此，您的链接必须变成这样：

```
<a href="DownloadMgr.aspx?File=brochure.pdf" target="_blank">Download Brochure</a> 
```

`DownloadMgr.aspx`应该是这样的：

```
if(!IsPostback)
{
    if(Request.QueryString["File"]!=null) 
    {  
       if(Request.QueryString["File"].Contains("pdf")))
          Response.ContentType = "application/pdf"; //varies depending on the file being streamed
   Response.AddHeader("Content-Disposition", "attachment; filename=" +  Request.QueryString["File"]);
   Response.WriteFile(Server.MapPath(Request.QueryString["File"]));                
} 
```

不过，更好的方法是创建一个 HTTPHandler 来做同样的事情。您可以查看[此答案](https://stackoverflow.com/a/12306095/345490)以获取有关如何执行此操作的更多详细信息。创建 HTTPHandler 的好处之一是它不涉及常规`aspx`页面所需的所有处理、初始化等。

**完整代码示例：**

```
<%@ Language=C# %>
<HTML>
<head>
    <title>Download Manager</title>
</head>
   <script runat="server" language="C#">
       void Page_Load(object sender, EventArgs e)
       {
           if (!this.Page.IsPostBack)
           {
               if (Request.QueryString["File"] != null)
               {
                   if (Request.QueryString["File"].Contains("pdf"))
                       Response.ContentType = "application/pdf"; //varies depending on the file being streamed
                   Response.AddHeader("Content-Disposition", "attachment; filename=" + Request.QueryString["File"]);
                   Response.WriteFile(Server.MapPath(Request.QueryString["File"]));
               }
           }
       }
   </script>
   <body>
      <form id="form" runat="server">

      </form>
   </body>
</HTML> 
```

# VB.NET版

```
<%@ Language="VB" %>
<HTML>
<head>
    <title>Download Manager</title>
</head>
   <script runat="server" language="VB">
       Sub Page_Load()
           If (Not Page.IsPostBack) Then

               If (Request.QueryString("File") IsNot Nothing) Then
                   If (Request.QueryString("File").Contains("pdf")) Then
                       Response.ContentType = "application/pdf" 'varies depending on the file being streamed
                   End If
                   Response.AddHeader("Content-Disposition", "attachment; filename=" + Request.QueryString("File"))
                   Response.WriteFile(Server.MapPath(Request.QueryString("File")))
               End If
           End If
       End Sub
   </script>
   <body>
      <form id="form" runat="server">

      </form>
   </body>
</HTML> 
```

现在将上面的代码另存为`DownloadMgr.aspx`并将其放入您的网站。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T20:59:21.733

如果有人需要知道，以供将来参考，我使用汤姆和伊卡洛斯的答案组合找到了答案。我只需要将一些 C# 转换为 VB。无论如何，我的超链接是：

```
<a href="DownloadMgr.aspx">Download Brochure</a> 
```

我的 DownloadMgr.aspx.vb 后面的代码是这样的：

```
Partial Class products_DownloadMgr
    Inherits System.Web.UI.Page

 Protected Sub Page_Load(ByVal sender As Object, ByVal e As EventArgs) Handles Me.Load

    Dim filename As String = "USS_Exact_Scan_Introduction.pdf"
    Response.ContentType = "image/pdf"
    Dim headerValue As String = String.Format("attachment; filename={0}", filename)
    Response.AppendHeader("Content-Disposition", headerValue)
    Response.TransmitFile(Server.MapPath(filename))
    Response.[End]()

End Sub

End Class 
```

非常感谢 Tom 和 Iracus 抽出宝贵时间提供帮助！

# jquery - Jquery多维数组：无法转换未定义的对象

> ID：12320063
> 
> 赞同：0
> 
> 时间：2012-09-07T14:26:39.330
> 
> 标签：jquery, arrays, object, multidimensional-array, undefined

我正在尝试用自动增量（listeFormatte.lenght）填充我的数组，它在该行中断`listeFormatte[listeFormatte.length][0] = cartArray[i][0];`并给出无法转换未定义的对象错误。

```
cartArray[i][0] = "ensemble"

listeFormatte = "" (new array)

listeFormatte.length = 0 
```

提前致谢。

```
var listeFormatte = new Array;

for(var i=0;i<cartArray.length;i++)
{
    if(cartArray[i][0] == "ensemble")
    {
        listeFormatte[listeFormatte.length] = [];
        listeFormatte[listeFormatte.length][0] = cartArray[i][0];
    }
} 
```

编辑：什么是 imagemagick-convert 它与我正在做的事情无关，你为什么要用这样的东西编辑我的东西？

答：所以当 listeFormatte[listeFormatte.length] = []; 创建它引发 listeFormatte.lenght 的多维数组，这导致“第二次使用”未定义，因为它现在是：listeFormatte [1] 而不是 [0]。所以我添加了一个变量来获取listeFormatte.length。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T14:49:04.453

你考虑过 `listeFormatte[listeFormatte.length] = new Array;`

我以前从未见过该`listeFormatte[listeFormatte.length] = [];`构造，并且没有类似的东西，您`listeFormatte[listeFormatte.length]`的未定义为数组，因此您不能使用 [0] 索引。

# c++ - 在外部进程中调用函数而不走弯路（Windows）

> ID：12320064
> 
> 赞同：1
> 
> 时间：2012-09-07T14:26:40.220
> 
> 标签：c++, function, process, external

我想用我的 args 调用一个函数，它存在于外部进程中。我知道函数名称、预期参数和地址。我想通过注入我的 dll 来做到这一点，然后使用命名管道发送的命令控制外部进程。

我找到了一种如何调用函数的方法，但是它使用了弯路。如何调用函数不走弯路？

谢谢，米

# vba - 创建 VBA 宏以保存电子邮件副本

> ID：12320072
> 
> 赞同：2
> 
> 时间：2012-09-07T14:27:06.697
> 
> 标签：vba, outlook

我使用 Outlook (MS Exchange) 并拥有一个个人和两个组收件箱（*我正在使用个人配置文件登录，通过该配置文件我也可以访问组收件箱*）。

当我发送电子邮件时，我在该`From`字段中选择了我的个人或两个组电子邮件地址之一。发送电子邮件时，我希望将副本保存在 、 或取决于我使用的电子邮件地址的`myIndividualMailbox`收件`groupAMailbox`箱`groupBMailbox`中`From`。

**示例：**如果我发送电子邮件`From` **groupA@myCompany.com**，我希望将电子邮件副本保存在`groupAMailbox`（*而不是我的个人收件箱*）的收件箱中。

我了解到，通过在 Outlook 中设置规则是不可能的，但可以使用**VBA 宏**来完成。我现在不知道如何编写 VBA 宏，也不知道这是否只是一个简短的脚本或更复杂的脚本。事实上，我从未在 Outlook 中编写过宏，所以我什至不知道如何开始。谁能展示如何做到这一点？

我开始寻找这个问题的解决方案：[Outlook send-rule that filter on the 'From' field](https://stackoverflow.com/questions/12285110/outlook-send-rule-that-filter-on-the-from-field)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:01:39.263

据我所知，我为你做了这个，它有效。您应该将它放在 Microsoft Outlook 对象 - ThisOutlookSession 模块中。

请注意，`myolApp_ItemSend`除非您先运行，否则该事件永远不会触发`enableEvents`。并且您需要确保每次关闭重新打开的 Outlook 时都启用它。这需要一些定制，但它应该给你一个大致的想法。

```
Option Explicit
Public WithEvents myolApp  As Outlook.Application

Sub enableEvents()
    Set myolApp = Outlook.Application
End Sub

Private Sub myolApp_ItemSend(ByVal item As Object, Cancel As Boolean)
    Dim items As MailItem
    Dim copyFolder As Outlook.Folder
    Dim sentWith As String
    'Identify sender address
    If item.Sender Is Nothing Then
        sentWith = item.SendUsingAccount.SmtpAddress
    Else
        sentWith = item.Sender.Address
    End If

    'Determin copy folder based on sendAddress
    Select Case sentWith
        Case "groupA@myCompany.com"
            'get groupAMailbox's inbox
            Set copyFolder = Application.GetNamespace("MAPI").folders("groupAMailbox").folders("Inbox")
        Case "myE-mailAddress"
            'get My inbox
            Set copyFolder = Application.GetNamespace("MAPI").folders("myE-mailAddress").folders("Inbox")
    End Select

    'copy the Item
    Dim copy As Object
    Set copy = item.copy
    'move copy to folder
    copy.Move copyFolder

End Sub 
```

**编辑：**看起来他们现在实际上已经将事件功能直接构建到 Outlook 的 Application 对象中，但是通过测试，您仍然必须执行我上面概述的操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-15T18:12:51.623

Outlook 将所有已发送项目存储在默认已发送项目文件夹中。但是，您可以应用补丁将已发送的项目保存在其自己的文件夹中。 [http://support.microsoft.com/kb/2181579](http://support.microsoft.com/kb/2181579)

# debian - 在debian中自动设置VM的主机名作为VM的名称

> ID：12320076
> 
> 赞同：1
> 
> 时间：2012-09-07T14:27:11.940
> 
> 标签：debian, vmware

我想将虚拟机的主机名（它是一个安装了 open-vm-tools 的 debian 挤压系统）自动设置为我在 vSphere Client 中设置和看到的虚拟机名称。

我试过了

```
 ~# vmtoolsd --cmd "info-get guestinfo.name" 2> /etc/hostname 
```

但命令返回“未找到值”

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-08-15T23:28:04.477

[我使用 VMware 的pyVmomi](https://pypi.python.org/pypi/pyvmomi)模块 在我的 Linux 客户操作系统上使用 Python 脚本完成了这项工作。

首先，我通过读取系统文件来检索系统 UUID `/sys/devices/virtual/dmi/id/product_uuid`。[然后，我根据pyvmomi-community-samples 站点中的](https://github.com/vmware/pyvmomi-community-samples)[find_by_uuid.py](https://github.com/vmware/pyvmomi-community-samples/blob/master/samples/find_by_uuid.py)示例，通过 UUID 在 vCenter 服务器中搜索虚拟机。另一种选择是通过 IP 地址进行搜索，这将更加独立于平台。pyVmomi 模块提供了启用此方法的[FindByIp()](http://pubs.vmware.com/vsphere-55/index.jsp?topic=%2Fcom.vmware.wssdk.apiref.doc%2Fvim.SearchIndex.html)方法。

```
#!/usr/bin/env python
import atexit
import pyVmomi
from pyVmomi import vim, vmodl
from pyVim.connect import SmartConnect, Disconnect

si = SmartConnect(host='<host>', port='<port>', user='<user>', pwd='<password>')
atexit.register(Disconnect, si)
file = open('/sys/devices/virtual/dmi/id/product_uuid')
uuid = file.read().strip().lower()
file.close()

search_index = si.content.searchIndex
vm = search_index.FindByUuid(None, uuid, True, False)
#Alternatively: vm = search_index.FindByIp(None, <ip_address>, True)
print vm.summary.config.name 
```

获得虚拟机名称后，您可以使用客户操作系统的命令（例如`hostname`）来执行重命名。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-02T19:34:33.600

在另一个网站上找到了这个。似乎您必须先设置值才能查询它们。

在某些情况下，您可能希望从 VM 的操作系统中确定 VM 的 vCenter 拨号名称。

如果从 syspreped 模板克隆多个虚拟桌面以启用将计算机名称设置为与 vCenter 显示名称相同的选项，这可能很有用。它在许多其他情况下也很有用。

但是，默认情况下，无法使用安装在虚拟机中的标准 VM 工具来执行此操作。

可以在 vCenter 中的 VM 对象上设置自定义属性，然后从虚拟机的操作系统中查询此属性。

可以使用 vSphere PowerCLI 运行以下脚本，将自定义属性设置为与 vCenter 显示名称相同：

```
$vServer= “vCenter.server.fqdn”
$vmName = “VM display name”

If (-not (Get-PSSnapin VMware.VimAutomation.Core -ErrorAction SilentlyContinue)) {
Add-PSSnapin VMware.VimAutomation.Core
}

Connect-VIServer $vServer | out-null

$vmSet = GET-VM $vmName | Get-View
$vmConfigSpec = New-Object VMware.Vim.VirtualMachineConfigSpec
$gInfo = New-Object VMware.Vim.optionvalue
$ginfo.Key=”guestinfo.hostname”
$gInfo.Value=$vmSet.Name
$vmConfigSpec.extraconfig += $gInfo
$vmSet.ReconfigVM($vmConfigSpec)

Disconnect-VIServer $vServer -Confirm:$false | out-null 
```

一旦设置好，就可以在 VM 中查询它，使用 VM 工具和以下命令：

```
vmtoolsd.exe –cmd “info-get guestinfo.hostname” 
```

当然，这可以添加到脚本中以针对多台机器设置此属性。

归功于理查德·帕米特！ [http://www.parmiter.com/vmware/2012/10/RP781](http://www.parmiter.com/vmware/2012/10/RP781)

# visual-studio-2010 - 是否可以在 WCF 服务解决方案中添加控制台应用程序？

> ID：12320079
> 
> 赞同：1
> 
> 时间：2012-09-07T14:27:17.583
> 
> 标签：visual-studio-2010, wcf, console-application, projects-and-solutions

我目前正在使用 Visual Studio 2010 创建 WCF 服务应用程序。是否可以在同一 WCF 服务解决方案中将控制台应用程序添加为新项目？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T14:30:07.593

是的。只需将控制台应用程序项目添加到您的解决方案中。

# gradle - 梯度清洁 不工作

> ID：12320081
> 
> 赞同：2
> 
> 时间：2012-09-07T14:27:21.207
> 
> 标签：gradle

我有一个自定义任务来执行 Websphere EJBDeploy。我已经定义了输入和输出，并获得了成功的增量编译，但我无法让自动生成的清理任务正常工作。

根据文档，对于具有定义输出的名为“ejbDeploy”的自定义任务，[应该自动生成一个 cleanEjbDeploy 任务](http://mrhaki.blogspot.com/2010/10/gradle-goodness-automatic-clean-tasks.html)。

```
Pattern: clean<TaskName>: Cleans the output files of a task. 
```

所以这是我的自定义任务：

```
task ejbDeploy(dependsOn: 'jar'){
    srcFile = file(jar.archivePath)
    destDir = new File("build/ejbDeploy")

    inputs.file srcFile
    outputs.dir destDir

    def cp = project.files(
        project.sourceSets.main.output.classesDir,
        project.sourceSets.main.resources,
        project.configurations.runtime
        ).getAsPath()

    doLast{
        destDir.mkdirs()

        exec{
            executable = wasEjbDeploy
            workingDir = destDir
            args = [
                jar.archivePath,
                ".",
                jar.archiveName,
                "-cp",
                cp
            ]
        }   
    }
} 
```

任何人都知道为什么清洁规则不起作用？

[编辑]

这是完整的（匿名）文件内容（自最初的问题发布以来已更改）：

```
version = '1.0-SNAPSHOT'
group = 'com.company'

buildscript {
    repositories {
        mavenLocal()
        mavenCentral()
    }
    dependencies {
        classpath group: 'name.benjaminAbbitt', name: 'WASEjbDeploy', version: '1.0-SNAPSHOT'
    }
}

apply plugin: 'java'
apply plugin: 'eclipse'
apply plugin: 'base'

repositories {
    mavenCentral()
    mavenLocal()
}

dependencies {
    compile 'javax.mail:mail:1.4.5'
    compile 'log4j:log4j:1.2.16'
    compile files(fileTree(dir: 'lib', includes: ['*.jar']) )
}

task ejbDeploy(type:name.benjaminAbbitt.WASEjbDeploy, dependsOn: 'jar'){
    wasEjbDeployPath = wasEjbDeploy
} 
```

这是“$gradle tasks”的相关块

```
build - Assembles and tests this project.
buildDependents - Assembles and tests this project and all projects that depend
on it.
buildNeeded - Assembles and tests this project and all projects it depends on.
classes - Assembles the main classes.
clean - Deletes the build directory.
jar - Assembles a jar archive containing the main classes.
testClasses - Assembles the test classes.

Documentation tasks
-------------------
javadoc - Generates Javadoc API documentation for the main source code.

Help tasks
----------
dependencies - Displays the dependencies of project ':project'.
help - Displays a help message
projects - Displays the sub-projects of project ':project'.
properties - Displays the properties of project ':project'.
tasks - Displays the tasks runnable from project ':project' (some of the
displayed tasks may belong to subprojects).

IDE tasks
---------
cleanEclipse - Cleans all Eclipse files.
eclipse - Generates all Eclipse files.

Verification tasks
------------------
check - Runs all checks.
test - Runs the unit tests.

Other tasks
-----------
ejbDeploy

Rules
-----
Pattern: build<ConfigurationName>: Assembles the artifacts of a configuration.
Pattern: upload<ConfigurationName>: Assembles and uploads the artifacts belongin
g to a configuration.
Pattern: clean<TaskName>: Cleans the output files of a task.

To see all tasks and more detail, run with --all.

BUILD SUCCESSFUL

Total time: 3.321 secs 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T17:28:15.423

clean 规则由`base`插件提供。由于许多其他插件（例如`java`）已经应用了该`base`插件，因此您通常不必`base`自己应用该插件。但万一：

```
apply plugin: "base" 
```

# c++ - 与 C++ 2011 不相关的并行随机种子？

> ID：12320083
> 
> 赞同：6
> 
> 时间：2012-09-07T14:27:40.830
> 
> 标签：c++, random, c++11, seed

目前，我在 Fortran 中有一个主要应用程序，需要一个种子来生成伪随机数。我想用完全不相关的种子（以及完全独立的伪随机数链）运行这个应用程序很多次。

我的问题是：如何使用 C++ 2011 生成种子？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-07T14:32:05.260

`/dev/urandom`在您的主线程中，从一个好的随机源（例如，在 Linux 上）提取单个种子（或种子序列）。使用该数据播种单个根 PRNG。然后使用*该*PRNG 为您的线程本地 PRNG 生成种子值。

```
#include <random>
#include <vector>

typedef std::mt19937 rng_type;
std::uniform_int_distribution<rng_type::result_type> udist;

int main()
{
    rng_type rng;

    // seed rng first, and store the result in a log file:
    rng_type::result_type const root_seed = get_seed();
    rng.seed(root_seed);

    // make thread seeds:
    std::vector<rng_type::result_type> seeds(NUMBER_OF_THREADS);
    for (auto & n : seeds) { n = udist(rng); }

    // make threads...
} 
```

中的随机数引擎接口`<random>`允许您从单个整数和整数*序列*中播种。如果您想要额外的随机性，您可以`mt19937`从数百个整数的序列中播种。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-07T17:50:26.170

如果源可用， C++11 提供`std::random_device`了非确定性随机数。你必须检查你的实现以确保它是好的。libc++ 默认使用 /dev/urandom。如果定义了宏，libstdc++ 也可以`_GLIBCXX_USE_RANDOM_TR1`。不幸的是，Visual Studio 的实现不是不确定的。*编辑：从 VS2012 开始，它们的实现使用 Windows 的加密服务。*

如果`std::random_device`提供对不确定性随机源的访问（通常 /dev/urandom 使用加密 PRNG），那么这应该足以生成独立种子。

```
#include <random>

int main() {
    std::random_device r;
    std::seed_seq seed{r(), r(), r(), r(), r(), r(), r(), r()};
    std::mt19937 engine(seed);

} 
```

一些引擎可能不会使用单个值作为种子，而是使用更多种子数据做得更好。种子序列是标准提供的替代方案。引擎可以使用种子序列播种，这些序列是您加载任意数量的数据并基于此生成种子数据的对象。

```
std::random_device r;
std::vector<std::mt19937> engines;

int engines = 50;
for (int i = 0; i < engines; ++i) {
    std::seed_seq s{r(), r(), r(), r(), r(), r(), r(), r()};
    engines.emplace_back(s);
} 
```

八个 32 位值（256 位）就足够了，但如果您真的需要，可以使用更多。每个标准引擎都记录了它从种子序列中使用了多少数据。

例如，每个 mt19937 引擎将从`mt19937::state_size`种子序列中检索 (624) 个 32 位值。从种子序列中检索到的种子与输入数据不同，但它们基于该数据，因此我们可以在序列中使用那么多随机数据。

```
std::random_device r;
std::vector<std::uint_least32_t> data;
std::generate_n(back_inserter(data), 624, std::ref(r));

std::seed_seq seed(begin(data), end(data));

std::mt19937 engine(seed); // 'fully' seeded mt19937 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T14:39:03.433

您永远无法真正*生成*随机种子。你把它们从某个地方拉出来。操作系统可能有一种方法可以检索`/dev/urandom`可用于播种的伪随机值（例如在 Linux 上）。

获取代表当前时间的时间戳也是一种常见的选择——然后为了确保您为每个线程获得不同的种子，只需确保它们在稍微不同的时间请求时间戳，并使用高分辨率计时器来确保它们实际得到不同的值作为种子。

C++11 中没有内置“获得好种子”功能，因为这样的功能本质上是没有意义的。计算机无法生成随机数据。您必须为您的目的选择看起来足够随机的东西，并使用它来为随机生成器提供种子

# database - 存储 HTTP 会话数据的最快方法？

> ID：12320085
> 
> 赞同：0
> 
> 时间：2012-09-07T14:27:45.587
> 
> 标签：database, performance, http, filesystems

我正在寻找存储和读取与 HTTP 会话 cookie 关联的数据的最快方法。

现在，我们有一个充满文件的目录，文件名是会话 cookie（随机约 150 个字符），内容是二进制 blob，通常只有几个字节 - 有时多达 1 或 2 KB。我们还使用 atime（上次读取时间戳）来查找和删除旧会话数据。

目录中的文件数量可能会飙升至数百万，并且服务器会不断检查文件是否存在，时间是什么，读取/写入它们，当然还有删除/创建它们。我怀疑 ext3 不是这种使用模式的理想方法？

存储此类数据的最佳方式是什么？我们测试了 MySQL，但它比 ext3 慢几个数量级（我假设我们没有做错什么？）。即使只是建立一个连接也比执行典型的文件系统存在/atime/fread 周期要长。

任何有经验的人将不胜感激。管理由不相关的小型数据组成的庞大数据库的最快方法是什么？

我们在高端服务器硬件上使用 PHP 和 CentOS（几乎可以买到最好的钱）。不需要集群/负载平衡，我们正在尝试减少中低流量网站的每个请求延迟。我们没有使用 PHP 的内置会话 API，因为它在我们的情况下不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T14:41:21.067

假设您的 PHP 是一流的并且经过优化，我会尝试将文件系统更改为 ext4（或者我应该说，为会话数据创建一个 ext4 挂载）。相比之下，ext3 非常慢，因此这可能是您的瓶颈。

如果您不能支持 ext4，则 ext2 也是一种选择（尽管 ext4 现在已经发布了足够长的时间，所以您应该可以接受）。但是，如果您使用 ext2，请确保您有一个单独的挂载仅用于会话数据，因为它不可靠并且没有日志记录。

ext4 的读取性能比 ext2 好，但是 ext2 的写入性能更好 ext4 （很可能是因为它缺少日志，这会产生“一些”开销，但这是我的理由，我可能错了）。

**编辑：**我还认为值得一提的是，较小的目录比一个大目录要好。但是，除非您使用自定义编译的内核，将每个目录的 32000 个文件限制增加为 ext3 的默认值，否则您可能会这样做。但保持 inode（目录中所有文件的索引）较小会提高性能。像根据文件的前 x 个字符将文件分类到目录这样简单的事情可以实现这一点，而不会增加太多的处理开销，即在能够选择会话文件之前找到正确的目录。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T16:46:56.777

你看过[内存数据库](http://en.wikipedia.org/wiki/In-memory_database)吗？它们速度很快，因为它们不需要在每次操作时都接触磁盘，并且有些可以选择偶尔将数据写入磁盘以使其持久化。

如果您的数据很简单，则键值存储应该更快，因为它更轻量级，例如[Redis](http://redis.io/topics/introduction)或具有持久化磁盘选项的缓存解决方案（不知道 PHP，但一个示例是Java的[EHcache](http://ehcache.org/)）。

# java - 将 File 对象转换为字节数组

> ID：12320087
> 
> 赞同：0
> 
> 时间：2012-09-07T14:27:46.393
> 
> 标签：java, android

我正在开发一个应用程序，我在其中捕获视频。我正在将录制的视频保存到手机中。我想要做的是将保存的文件转换为字节数组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T14:39:23.543

```
 // Serialize to a byte array
    ByteArrayOutputStream bos = new ByteArrayOutputStream();
    ObjectOutput out = new ObjectOutputStream(bos);
    out.writeObject(yourObject);
    out.close();

    // Get the bytes of the serialized object
    byte[] buf = bos.toByteArray();

    //write bytes to private storage on filesystem
    FileOutputStream fos = new FileOutPutStream("/....your path...");
    fos.write(buf);
    fos.close(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:08:04.617

您可以使用此代码来帮助您：

```
public static byte[] getBytesFromFile(File file) throws IOException {

InputStream is = new FileInputStream(file);
System.out.println("\nDEBUG: FileInputStream is " + file);

// Get the size of the file
long length = file.length();
System.out.println("DEBUG: Length of " + file + " is " + length + "\n");

/*
 * You cannot create an array using a long type. It needs to be an int
 * type. Before converting to an int type, check to ensure that file is
 * not loarger than Integer.MAX_VALUE;
 */
if (length > Integer.MAX_VALUE) {
    System.out.println("File is too large to process");
    return null;
}

// Create the byte array to hold the data
byte[] bytes = new byte[(int)length];

// Read in the bytes
int offset = 0;
int numRead = 0;
while ((offset < bytes.length) && ((numRead=is.read(bytes, offset, bytes.length-offset)) >= 0)) {
    offset += numRead;
}

// Ensure all the bytes have been read in
if (offset < bytes.length) {
    throw new IOException("Could not completely read file " + file.getName());
}

is.close();
return bytes;} 
```

# php - 如何从文件基本名称中去除破折号并使用 php 显示？

> ID：12320093
> 
> 赞同：0
> 
> 时间：2012-09-07T14:28:19.440
> 
> 标签：php

我试图通过在该文件夹的索引页面中包含以下代码来列出指向我网站上一个文件夹中所有文件的链接。

使用此代码输出`name-of-file`链接到`name-of-file.html`.

现在如何修改下面的代码以去除斜杠并将文件名显示为`name of file`？

我是一个 php 菜鸟，所以任何帮助将不胜感激。谢谢。

```
<ul>
    <?php
        $files = glob("*.html");
        foreach($files as $file)
        {
            echo '<li><a href="'.basename($file).'">'.basename($file, ".html").'</a></li>';
        }
    ?>
</ul> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T14:29:43.777

利用`str_replace()`

```
<ul>
<?php
$files = glob("*.html");
foreach($files as $file)
{
    echo '<li><a href="'.basename($file).'">'.str_replace('-', ' ', basename($file, ".html")).'</a></li>';
}
?>
</ul> 
```

# c# - 如何创建和填充列表 排队？（C＃）

> ID：12320099
> 
> 赞同：10
> 
> 时间：2012-09-07T14:28:37.670
> 
> 标签：c#

我需要在线创建和填充（有这个操作的词吗？）`List<string[]>`. 我怎么做？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-07T14:29:57.857

```
var list = new List<string[]> 
{ 
    new[] { "One", "Two", "Three" },
    new[] { "Four", "Five", "Six" }
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T14:33:14.303

```
var test = new List<string> { "test", "test2" }; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-07T14:30:45.933

你是这个意思吗？

```
var stringList = new List<string[]> 
{ 
    new string[] { "stringa1", "stringa2", "stringa3" }, 
    new string[] { "stringb1", "stringb2", "stringb3" },
    new string[] { "stringc1", "stringc2", "stringc3" }
}; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-07T14:32:18.100

```
var list_array = new List<string[]> {
   new[]{"a", "b", "c" }, new[] {"f", "g", "h"}}; 
```

# visio - The same C# code produces different output in Visio Professional and Premium

> ID：12320102
> 
> 赞同：0
> 
> 时间：2012-09-07T14:28:44.597
> 
> 标签：visio

I have built a simple conversion Add In, but its behavior is unfortunately different with the different Visio Editions (Visio 2010 Professional and Visio 2010 Premium). The Add In takes a Process-Diagram created with Shapes from Stencil_1.vss and creates a new slightly different Process-Diagram with Shapes from Stencil_2.vsd. It loops through a Visio page and for each shape founded creates a new shapes from new master shape (from Stencil_2.vsd) and drop it into the new page. Geometry, captions etc. are the same, only the shape-appearance is changed. Below is the source diagram:

![the source diagram](../Images/1d61c6bd9a1eae4b64b5fdb155b9f145.png)

When I run the code into Visio 2010 Professional the swimlane shapes are drawn correctly.

![run from Visio 2010 Prof](../Images/269e66c98768b183c3b5793777542682.png)

When I run the same code from Visio Premium the swimlane appearance and layout are mismatched: ![run from Visio 2010 Premium](../Images/68f53a4a8e90d047d15d4dcd03f773ab.png)

Both times i drop the SAME Shape("Swimlane" from the same stencil) into the Page with the SAME Code fragment:

```
Visio.Master vm = swimlane_stencil.Masters.get_ItemU(@"Swimlane");
Visio.Shape TargetShape = targetPage.Drop(vm, shape_x, shape_y); 
```

How could I ensure, that the code produces any time the same (correct) output? Must I disable any (premium)features in the swimlane-shapesheet?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T09:29:26.007

跨功能流程图形状由插件支持，以便形状在泳道和页面等中正确定位。大多数形状都有一个放置事件，该事件调用插件以实现其各自的功能。

从外观上看，插件没有在您的 Visio Premium 实例中正确调用。例如，[EventDrop 单元格](http://msdn.microsoft.com/en-us/library/ff769082.aspx)中有一个函数：

=RUNADDONWARGS("CFF14","/cmd=20001")

..其中 CFF14 是跨功能流程图插件的 2010 版本。

请记住，2010 还在跨职能流程图解决方案中使用[容器形状。](http://msdn.microsoft.com/en-us/library/ff959245.aspx)您使用的是正确的 2010 年“目标”形状吗？

据我所知，就跨功能流程图而言，专业版和高级版之间的功能应该没有区别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T12:59:44.753

感谢您的时间！

> 请记住，2010 还在跨职能流程图解决方案中使用容器形状。您使用的是正确的 2010 年“目标”形状吗？

两种情况下的“目标”形状都是跨职能流程图模具中的泳道。

我在另一台“专业”机器上测试了相同的添加代码，它是成功的，我的意思是“泳道”形状定位正确，没有分隔符和标题部分。我还卸载并再次安装了 Premium 实例，没有任何改变，相同的代码生成上面绘制的相同图表。泳道 PinX 已更改，并添加了分隔符和标题部分。

*   我注意到，在“错误的图表”中，只有第一个下降的泳道形状是正确的
*   以下（后来删除）泳道位置错误，添加了分隔符和标题栏。它们有：User.msvShapeCategories=" **CFF Container** ;DoNotContain"，正确的泳道形状有：User.msvShapeCategories=" **Swimlane** ;DoNotContain"
*   我还注意到，错误的泳道源自 xfunc_m.vss （ User.visMasterStencil = " **xfunc_m.vss** "）
*   我从 User.visMasterStencil 单元中删除值“xfunc_m.vss”并更新模板

现在它工作正常，我希望这个解释对其他人有用，有人可以比我更好地解释这种行为:)

# java - Java: String changes so name for all items change in for-loop

> ID：12320103
> 
> 赞同：2
> 
> 时间：2012-09-07T14:28:47.890
> 
> 标签：java, string, for-loop

I have the following code to send an email with multiple parts

```
 public void sendEmail(String emailAddress, List<String> attachment) throws Exception{
    Properties props = new Properties();

    props.put("mail.transport.protocol", "smtps");
    props.put("mail.smtps.host", SMTP_HOST_NAME);
    props.put("mail.smtps.auth", "true");

    Session mailSession = Session.getDefaultInstance(props);
    mailSession.setDebug(true);
    Transport transport = mailSession.getTransport();

    MimeMessage message = new MimeMessage(mailSession);
    // message subject
    message.setSubject("Automated email from Kieran Herley about Assignments");

    message.addRecipient(Message.RecipientType.TO,
         new InternetAddress(emailAddress));

    Multipart multipart = new MimeMultipart();
    MimeBodyPart messageBodyPart = new MimeBodyPart();

    // message body
    messageBodyPart.setText("This is just a message to say your assignment has been graded.\nAttached is a file with some pointers about your assignment");
    multipart.addBodyPart(messageBodyPart);

    messageBodyPart = new MimeBodyPart();

    for (String singleFile : attachment) {
        DataSource source = new FileDataSource(singleFile);
        messageBodyPart.setDataHandler(new DataHandler(source));
        String nameOfFile = singleFile.substring(singleFile.lastIndexOf('\\') + 1);
        messageBodyPart.setFileName(nameOfFile);
        multipart.addBodyPart(messageBodyPart);
    }
    message.setContent(multipart);

    transport.connect(SMTP_HOST_NAME, SMTP_HOST_PORT, SMTP_AUTH_USER, SMTP_AUTH_PWD);

    transport.sendMessage(message,
        message.getRecipients(Message.RecipientType.TO));
    transport.close();
} 
```

Everything is working fine but the problem i am having is in the for-loop

```
for (String singleFile : attachment) {
        DataSource source = new FileDataSource(singleFile);
        messageBodyPart.setDataHandler(new DataHandler(source));
        String nameOfFile = singleFile.substring(singleFile.lastIndexOf('\\') + 1);
        messageBodyPart.setFileName(nameOfFile);
        multipart.addBodyPart(messageBodyPart);
    }
    message.setContent(multipart); 
```

The problem that i am having is, if the application loops through the for-loop 3 times, it will name all the files attached to the email the name of the file that was passed through the loop the third time. This is also the same with the email attachment itself, even do it is sending 3 attachments, they are all named the same.

This is because all three of the attachments are using the same variable to both name them and retrieve so for all three of them it is naming them and setting them as the last one passed through the loop.

Is there a way to set the name and attachment of each email by using the same name variable and attachment variable for all, or how would I do this?

In this case use

```
String singleFile --- for the attachment
String nameOfFile --- for the name of each file 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T14:42:00.257

我不确定我是否了解您的需求，但是拥有这条线可能很有意义：

```
messageBodyPart = new MimeBodyPart(); 
```

在 for 循环内，而不是之前。目前，您不断将相同的身体部位添加到`multipart`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T14:42:25.277

对于 for-each 循环中的字符串，这看起来没什么问题。我担心您总是使用相同的实例来`messageBodyPart`分配数据处理程序和文件名。尝试`messageBodyPart = new MimeBodyPart()`在循环内移动。

# sql - Populate listbox with alias values using SQL select statment

> ID：12320108
> 
> 赞同：0
> 
> 时间：2012-09-07T14:29:15.410
> 
> 标签：sql, vb.net, visual-studio-2010, select, listbox

I have two columns in MS SQL table (ID, and Name) that I want to use to populate a list box with. I would like to show the Name values (as alias?) in the list box, however when the user selects the item I want the ID value to be returned not the Name value. My code below just adds the values into the list box from the Name column.

```
 Me.listName.Items.Clear()

 Dim strName As String  = "select SetName from " & tb

 Dim con As String = sConnectionString
 Dim com As New SqlCommand(strServiceType, New SqlConnection(con))
 com.Connection.Open()

 Dim dr As SqlDataReader
 Dim ColumnValue As String = Nothing

 dr = com.ExecuteReader
 While dr.Read
   ColumnValue = (dr.GetValue(0)).ToString
   listName.Items.Add(ColumnValue)
   listName.Sorted = True
 End While

 com.Connection.Close() 
```

I'm not sure how to apply the logic above to get the associated ID value besides running another select statement on the list box SelectedIndexChanged event.

Thank you

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T14:36:54.627

如果我没记错的话，您只需要编辑您的 sql 以提取 ID 和名称，然后编辑您在列表框中添加的项目以添加新的列表项。

IE

```
listName.Items.Add(New ListItem("TEXT","VALUE")) 
```

# html - 如何在表格单元格中居中 RadioButtonList

> ID：12320117
> 
> 赞同：1
> 
> 时间：2012-09-07T14:29:34.430
> 
> 标签：html, css, radiobuttonlist

这应该很容易。如何将单选按钮列表居中？过去并不难。下面的 HTML 不起作用。我错过了什么？

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
<title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
    <table style="width:100%">
                  <tr>
                      <td  style="text-align: center">
                          <asp:RadioButtonList ID="radUserType" runat="server" 
                              RepeatDirection="Horizontal">
                          </asp:RadioButtonList>
                      </td>
                  </tr>
           </table>
    </div>
    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-09-23T14:29:00.653

重复布局="流"

在跨度而不是表中呈现 RadioButtonList。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T14:43:50.767

尝试使用 td 属性：

```
<td align="center"> 
      <asp:RadioButtonList ID="radUserType" runat="server" 
       RepeatDirection="Horizontal">
       </asp:RadioButtonList>
</td> 
```

# iphone - 获取经度，纬度而不设置所有应用程序寿命

> ID：12320118
> 
> 赞同：0
> 
> 时间：2012-09-07T14:29:36.827
> 
> 标签：iphone, objective-c, location

我想要在应用程序启动时简单地获取 lan、lon 值，我不想在改变我的位置时每秒更新这些值。我正在使用这段代码：

```
locationManager = [[CLLocationManager alloc] init];
locationManager.delegate = self;
[locationManager startUpdatingLocation];

- (void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation
  {
    latValueNSString = [NSString stringWithFormat: @"%f",newLocation.coordinate.latitude];
    lanValueNSString = [NSString stringWithFormat: @"%f",newLocation.coordinate.longitude];

  } 
```

但问题是我无法传输这些值，因为每毫秒它一次又一次地设置它......我怎么能只设置那些值，就是这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T14:34:54.157

如果您只需要 1 个值，只需获取第一个位置并告诉位置管理器停止更新位置。

```
[manager stopUpdatingLocation]; 
```

在调用委托方法时执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T14:40:32.797

`[locationManager stopUpdatingLocation];`得到结果后打电话。在调用停止之前，您可能需要检查准确性是否是您所需要的。

# spring - 使用 Map 类型的构造函数参数定义 Spring bean

> ID：12320120
> 
> 赞同：3
> 
> 时间：2012-09-07T14:29:43.573
> 
> 标签：spring, grails

在我的 Grails 应用程序中，我试图定义一个 Spring bean，`resources.groovy`它需要一个 Map 类型的构造函数 arg。我试过这个：

```
Map<Class, String> mapArg = [(String): 'foo']
myBean(MyBeanImpl, mapArg) 
```

但我收到错误消息：

> org.springframework.beans.factory.BeanCreationException：创建名为“myBean”的bean时出错：无法解析匹配的构造函数（提示：为简单参数指定索引/类型/名称参数以避免类型歧义）

实现类有一个这样定义的构造函数

```
MyBeanImpl(Map<Class, String> map) {
  // impl omitted 
} 
```

我的猜测是，问题是由于我定义了一个构造函数，该构造函数采用单个`Map`arg，其签名与 Groovy 添加到每个类的默认构造函数具有相同的签名。

如果是这样，解决方案似乎是添加工厂方法，例如

```
MyBean getInstance(Map map) {
  // impl omitted  
} 
```

但我不确定如何调用它来定义一个 bean (in `resources.groovy`)，它是从需要参数的工厂方法构造的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T15:04:32.593

据我所知，您使用的语法应该可以工作。是否替代语法：

```
Map<Class, String> mapArg = [(String): 'foo']
myBean(MyBeanImpl) { bean ->
  bean.constructorArgs = [mapArg]
} 
```

在你的情况下工作得更好吗？如果做不到这一点，将地图本身声明为 bean 绝对应该这样做：

```
import org.springframework.beans.factory.config.MapFactoryBean

classMap(MapFactoryBean) {
  sourceMap = [(String):'foo']
}

myBean(MyBeanImpl, classMap /* this is a RuntimeBeanReference */) 
```

# sql - VB中的选择语句SQL

> ID：12320122
> 
> 赞同：0
> 
> 时间：2012-09-07T14:29:49.433
> 
> 标签：sql, vb.net, select

我知道还有其他诸如此类的帖子，但是我找不到适合我的帖子，而且我真的对此束手无策，我真的不知道该怎么办。

我有一些带有 ID 列和名称列的表，它们通过链接表通过外键等连接。我正在尝试通过 GUI 将数据输入到数据库中，为此我在“常规”中使用插入语句' 表，然后选择语句从常规表中获取自动生成 ID，然后插入到链接表中。

下面的代码是我一直在尝试使用的代码。

```
Imports System.Data.SqlClient
    Public Class Test

Private cs As New SqlConnection(".....")

Private Sub btnInsertNext_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnInsertNext.Click
        Dim ContID As Integer
        Dim FName As Integer

        cs.Open()

Using command As New SqlCommand("Select FamID From Family Where Name = '" & FName & " '", cs)
            command.Parameters.AddWithValue("@FamID", ContID)
            command.ExecuteNonQuery()
        End Using

  Using command As New SqlCommand("Select DocID From Doctors Where DocName LIKE'" & AddFam.Doctor & " '", cs)
            command.Parameters.AddWithValue("@DocID", AddFam.Doctor) ''AddFam is another form I'm using to add a family member to a Doctor
            command.ExecuteNonQuery()
        End Using

cs.close() 
```

我正在使用：VB 2010 SQL 服务器管理 2008 r2

我理解它有点混乱，但任何帮助将不胜感激，如果以前出现过这种情况，我很抱歉。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T14:37:51.733

目前尚不清楚您实际上遇到了什么问题，我假设您不知道如何检索新生成的 ID。

下面是一个关于如何使用 ADO.NET 检索新标识值的不言自明的示例：

```
Using con = New SqlConnection(connectionString)
    Dim newID As Int32
    Using insertCommand = New SqlCommand("INSERT INTO Test(Value)VALUES(@Value);SELECT CAST(scope_identity() AS int)", con)
        insertCommand.Parameters.AddWithValue("@Value", "Value1")
        con.Open()
        newID = DirectCast(insertCommand.ExecuteScalar, Int32)
    End Using

    If newID <> 0 Then
        Using updateCommand = New SqlCommand("UPDATE TEST SET Value='Value1.1' WHERE idTest=@idTest", con)
            updateCommand.Parameters.AddWithValue("@idTest", newID)
            If con.State <> ConnectionState.Open Then con.Open()
            Dim updatedRecordCount = updateCommand.ExecuteNonQuery
        End Using
    End If
End Using 
```

两个重要的部分是：

```
SELECT CAST(scope_identity() AS int) 
```

这将返回新的身份值

```
DirectCast(insertCommand.ExecuteScalar, Int32) 
```

如果插入了新行，它将返回新的标识列值，失败时返回 0。

由于您将使用参数与字符串连接混合使用：使用参数非常重要，因为它会阻止[SQL-Injection](http://msdn.microsoft.com/en-us/library/ms161953.aspx)。

*   [SCOPE_IDENITY](http://msdn.microsoft.com/en-us/library/ms190315.aspx)
*   [ExecuteScalar 方法](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executescalar.aspx)
*   [ADO.NET 中的命令和参数](http://msdn.microsoft.com/en-us/library/ms254953.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T14:37:23.817

不！像这样参数化您的查询。

```
 command = New SqlCommand("Select FamID From Family Where Name = @Fname", cs) 
   command.Parameters.AddWithValue("@Fname", ContID) 
   FamID = command.ExecuteScalar() 
```

理想情况下，您应该使用`Scope_Identity()`从插入语句中获取身份

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T14:41:16.463

您可以根据以下两个查询尝试使用此代码`@ symbol`

```
...
Using command As New SqlCommand("Select FamID From Family Where Name = @FamID", cs)
command.Parameters.AddWithValue("@FamID", ContID)

...

Using command As New SqlCommand("Select DocID From Doctors Where DocName LIKE @DocID", cs)
command.Parameters.AddWithValue("@DocID", AddFam.Doctor) 

... 
```

# regex - 替换 CSV 中的双引号（在限定符内）以进行 SSIS 导入

> ID：12320123
> 
> 赞同：2
> 
> 时间：2012-09-07T14:29:51.587
> 
> 标签：regex, csv, import, ssis, quote

我有一个从 .csv 文件导入数据的 SSIS 包。该文件中的每个条目都有双引号 ( `"`) 限定符，但介于两者之间。我还添加了逗号 ( `,`) 作为列分隔符。我不能给你我正在使用的原始数据，但这里是我的数据如何在平面文件源中传递的示例：

```
"ID-1","A "B"", C, D, E","Today"
"ID-2","A, B, C, D, E,F","Yesterday"
"ID-3","A and nothing else","Today" 
```

正如您所看到的，第二列可以包含引号（和逗号），这会破坏我的 SSIS 导入，并出现指向此行的错误。我不太熟悉正则表达式，但我听说这在这种情况下可能会有所帮助。

在我看来，我需要`"`用单引号（`'`）替换所有双引号（），除了......

*   ...一行开头的所有引号
*   ...一行末尾的所有引号
*   ...报价是其中的一部分`","`

你们中的任何人都可以帮我解决这件事吗？会很好！

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:56:42.220

要根据您的规范用单引号替换双引号，请使用这个简单的正则表达式。此正则表达式将允许行首和/或行尾有空格。

```
string pattern = @"(?<!^\s*|,)""(?!,""|\s*$)";
string resultString = Regex.Replace(subjectString, pattern, "'", RegexOptions.Multiline); 
```

这是模式的解释：

```
// (?<!^\s*|,)"(?!,"|\s*$)
// 
// Options: ^ and $ match at line breaks
// 
// Assert that it is impossible to match the regex below with the match ending at this position (negative lookbehind) «(?<!^\s*|,)»
//    Match either the regular expression below (attempting the next alternative only if this one fails) «^\s*»
//       Assert position at the beginning of a line (at beginning of the string or after a line break character) «^»
//       Match a single character that is a “whitespace character” (spaces, tabs, and line breaks) «\s*»
//          Between zero and unlimited times, as many times as possible, giving back as needed (greedy) «*»
//    Or match regular expression number 2 below (the entire group fails if this one fails to match) «,»
//       Match the character “,” literally «,»
// Match the character “"” literally «"»
// Assert that it is impossible to match the regex below starting at this position (negative lookahead) «(?!,"|\s*$)»
//    Match either the regular expression below (attempting the next alternative only if this one fails) «,"»
//       Match the characters “,"” literally «,"»
//    Or match regular expression number 2 below (the entire group fails if this one fails to match) «\s*$»
//       Match a single character that is a “whitespace character” (spaces, tabs, and line breaks) «\s*»
//          Between zero and unlimited times, as many times as possible, giving back as needed (greedy) «*»
//       Assert position at the end of a line (at the end of the string or before a line break character) «$» 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T18:04:41.607

在使用双引号和逗号加载 CSV 时，有一个限制是添加了额外的双引号，并且数据也包含在双引号中，您可以在源文件的预览中查看。因此，添加派生列任务并给出以下表达式：-

(REPLACE(REPLACE( **RIGHT(SUBSTRING(TRIM(COL2),1,LEN(COL2) - 1),LEN(COL2) - 2))** ,"","@"),"\"\"","\" "),"@",")

粗体部分删除用双引号括起来的数据。

试试这个，如果这有帮助，请告诉我

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T14:52:03.513

您可以使用正则表达式匹配模式拆分列

```
/(?:(?<=^")|(?<=",")).*?(?:(?="\s*$)|(?=","))/g 
```

### 请参阅此[演示](http://ideone.com/1zvGD)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-02-21T15:49:21.350

`"`在将值插入 CSV 目标之前，对 CSV 目标使用文本限定符，添加派生列表达式

```
REPLACE(REPLACE([Column1],",",""),"\"","") 
```

这将保留`"`在您的文本字段中

# java - 具有相同边界的 JTree 子节点

> ID：12320126
> 
> 赞同：1
> 
> 时间：2012-09-07T14:30:08.423
> 
> 标签：java, swing, jtree

我有一个带有自定义模型和自定义渲染器的 JTree。它们似乎工作正常，除了当我展开具有多个子节点的节点时，它将所有子节点绘制到同一个矩形，因此只有最后一个节点可见。我可以遍历子节点并将它们打印到控制台，但 UI 不同。

这是用户界面的草图：

```
// for 1 child node:
ROOT
-- <rendered node>

//for 2 child nodes:
ROOT
|
-- <rendered node - the data of the 2nd node>

//for 3 child nodes:
ROOT
|
|
-- <rendered node - the data of the 3rd node> 
```

我发现 BasicTreeUI 使用 getPathBounds() 来确定某个节点的边界。这是我检查它的方法：

```
doStuffWithTree(JTree tree) {
   tree.expandNode(0);
   for (int i = 0; i < tree.getRowCount(); i++) {
       TreePath tp = tree.getPathForRow(i);
       tree.makeVisible(tp);
       System.out.println("Bounds of row " + i + ": " + tree.getPathBounds(tp));
   }
} 
```

通过此检查，我得到所有节点（节点 0 除外）具有相同的边界。

我尝试了一些扩展树的技巧，例如从第一个开始扩展所有节点；然后从最后开始 - 它们都具有相同的效果。

最后，问题是：我可以修改什么类来修复这种行为？是否有任何已知的解决方法？

更新

显然，需要在 TreeNode 实现上进行一些修复。另外，我需要纠正自己：我没有自定义模型，而是自定义 TreeNode。这是SSCCE：

```
package com.example.jtree;

//lots of obvious imports

public class JTreeBoundsExample extends JFrame {

public static void main(String... args) {
    JTreeBoundsExample m = new JTreeBoundsExample();
    m.setSize(275, 300);
    m.setDefaultCloseOperation(EXIT_ON_CLOSE);
    m.setVisible(true);
}

public JTreeBoundsExample() {
    ValueTreeNode root = new ValueTreeNode(null, "root");
    ValueTreeNode category = new ValueTreeNode(root, "category");
    category.put("k1", new ValueTreeNode(category, "v1"));
    category.put("k2", new ValueTreeNode(category, "v2"));
    category.put("k3", new ValueTreeNode(category, "v3"));
    root.put("category", category);

    JTree tree = new JTree(root);
    tree.setCellRenderer(new ValueCellRenderer());

    tree.setRootVisible(false);
    tree.expandRow(0);
    for (int i = 0; i < tree.getRowCount(); i++) {
        TreePath tp = tree.getPathForRow(i);
        tree.makeVisible(tp);
        System.out.println("Bounds of row " + i + ": " + tree.getPathBounds(tp));
    }

    Container content = getContentPane();
    content.add(new JScrollPane(tree), BorderLayout.CENTER);
}

private static class ValueTreeNode extends HashMap<String, ValueTreeNode> implements TreeNode {

    private List<String> keys = new ArrayList<String>();
    private TreeNode parent;
    private String value;

    public ValueTreeNode(TreeNode parent, String value) {
        this.parent = parent;
        this.value = value;
    }

    @Override
    public ValueTreeNode put(String key, ValueTreeNode val) {
        ValueTreeNode old = super.put(key, val);
        if (old == null) {
            sortKeys();
        }
        return old;
    }

    private void sortKeys() {
        keys.clear();
        keys.addAll(keySet());
        Collections.sort(keys);
    }

    @Override
    public Enumeration children() {
        final Iterator<String> it = keys.iterator();
        return new Enumeration() {
            @Override
            public boolean hasMoreElements() {
                return it.hasNext();
            }
            @Override
            public Object nextElement() {
                return it.next();
            }
        };
    }

    @Override
    public boolean getAllowsChildren() {
        return true;
    }

    @Override
    public TreeNode getChildAt(int pos) {
        return get(keys.get(pos));
    }

    @Override
    public int getChildCount() {
        return size();
    }

    @Override
    public int getIndex(TreeNode arg0) {
        return -1;
    }

    @Override
    public TreeNode getParent() {
        return parent;
    }

    @Override
    public boolean isLeaf() {
        return size() == 0;
    }
}

private static class ValueCellRenderer extends DefaultTreeCellRenderer {
    public Component getTreeCellRendererComponent(JTree tree, Object value, boolean sel, boolean expanded,
            boolean leaf, int row, boolean hasFocus) {
        super.getTreeCellRendererComponent(tree, value, sel, expanded, leaf, row, hasFocus);
        if (value instanceof ValueTreeNode) {
            ValueTreeNode vtn = (ValueTreeNode) value;
            setText(vtn.value);
        }
        return this;
    }
}   
} 
```

# php - ereg_replace 删除空格

> ID：12320128
> 
> 赞同：1
> 
> 时间：2012-09-07T14:30:10.423
> 
> 标签：php

我试图使用`ereg_replace()`只允许大写和小写字母和空格，因为我将使用逗号将其分解。

我在下面有这段代码，但它正在删除空格，我可以弄清楚如何允许 , 通过。

```
$type = ereg_replace("[^A-Za-z\.-:/-]", "", $string); 
```

我也知道`ereg_replace()`不推荐使用，但这是我得到的关闭。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T14:40:34.343

使用以下

```
$new_string = preg_replace('/[^A-Za-z ,]/', '', $string); 
```

这将允许 AZ、az、逗号和空格并删除其他所有内容。

注意。其他所有内容都包括重音字符等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T14:44:10.997

简单地避开逗号和空格

```
$type = ereg_replace("[^A-Za-z\.-:/-\,\ ]", "", $string); 
```

转换为 preg 可以获得相同的结果

```
$type = preg_replace("/[^A-Za-z\.-:\/\,\ ]+/", "", $string); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-07T14:37:41.110

*不要*使用已弃用的功能，它们已被弃用是有原因的。如果您只想允许 az、AZ 和空格，请使用：

```
preg_replace( '~[^a-z ]~i', '', $subject ); 
```

*编辑*：根据您的评论“它仍在删除逗号和空格”，我认为您也希望允许使用逗号。在这种情况下，请使用：

```
preg_replace( '~[^a-z, ]~i', '', $subject ); 
```

# javascript - IE8显示：无；显示：块；导致 div 重叠页脚？

> ID：12320134
> 
> 赞同：0
> 
> 时间：2012-09-07T14:30:41.460
> 
> 标签：javascript, html

我有一个表格，上面出现错误，看起来像

`<div class="form-error" id="optin_error" style="display: none; ">You must opt-in to participate.</div>`

里面有一个表格，里面`<form>`有一堆输入`divs`……没什么特别的。

但是我对我的字段进行了 javascript 验证，将表单错误从`display:none;`调整`display:block;`容器字段的大小调整为正常。问题在于有一个不会向下移动的页脚（也在 div 内）。如果我打开 IE8 开发人员并查看主容器（包含所有内容），它也不会扩展。例如，如果我取消选中主容器宽度样式，然后重新选中它，它会修复所有问题。

当 div 内的元素从 display:none 变为时，是否有办法强制 IE8“调整”其 div 的大小？显示：块；

PS。没有有趣的 CSS，没有浮动，没有绝对定位，没有什么会导致这种情况......

表单错误块 CSS

```
.form-error {
    color: #EB1F25;
} 
```

页脚块 CSS

```
.footer-wrapper {
    border-top: 1px solid #000000;
    margin: 30px 0 10px 0;
}
.footer-wrapper .links {
    width: 960px;
} 
```

**经过一番调查，似乎`inline-block`容器上的属性导致了问题。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T02:59:35.663

最终成为 display:inline-block; 的问题。元素未调整大小。改为浮动有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T14:33:59.817

尝试为包装器提供宽度。记住页脚应该在你的主包装内，还要给其他 div 一个高度... min-height 或类似的东西。

```
.footer-wrapper {
border-top: 1px solid #000000;
margin: 30px 0 10px 0;
width: 960px;
}
.footer-wrapper .links {
  width : 100px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T14:44:05.150

很难说到底是什么造成了问题。但是您可以测试一些我建议您尝试的技巧：

如果您`.form-error`出现在实际之前（上方）`<form ...></form>`，请尝试`<br clear="all"/>`在这两个块之间插入标签。如果没有，添加`clear:all`to`<form ...>`和`width:100%`to `.form-error`。

如果没有，请将`position:relative`and `overflow:hidden`first 添加到`.form-error`，如果没有帮助，也将其添加到`<form...>`。

如前所述，如果我们能看到您的整个代码会容易得多，尝试将 jsbin 与您的整个**css**和**html**源代码一起使用，因为 IE 在 html 渲染方面非常严格。

# c++ - 虚拟析构函数：如果基类动态分配内存，基类是否需要？

> ID：12320135
> 
> 赞同：0
> 
> 时间：2012-09-07T14:30:44.103
> 
> 标签：c++, virtual-destructor

这个问题看起来像[Virtual destructor 中的讨论：不动态分配内存时是否需要？](https://stackoverflow.com/questions/2065938/virtual-destructor-is-it-required-when-not-dynamically-allocated-memory/12292952#12292952)

在一个考试问题中，有人问我： - 维护指向动态分配内存的指针的任何基类应该定义什么？

我回答： - 一个复制构造函数和一个赋值运算符（以确保不仅复制指针...... cf deep copy）和一个析构函数（释放分配的内存）

他们说这是不正确的，因为这个基类还应该定义一个虚拟析构函数而不是普通的析构函数。为什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T14:35:52.920

如果您的类打算以多态方式使用，您可能会有指向派生对象的基类的指针。

`virtual`通过指向没有析构函数的基类的指针删除派生对象会导致未定义的行为。这大概就是她的理由。

### 5.3.5

> 3）在第一种选择（删除对象）中，如果操作数的静态类型与其动态类型不同，则静态类型应为操作数动态类型的基类，并且静态类型应具有虚拟析构函数或行为未定义。[...]

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-07T14:36:26.233

**如果**派生类的对象打算通过基类指针销毁，您的基类需要一个虚拟析构函数，就像这样

```
Base *pointer_to_base_class = new Derived;
delete pointer_to_base_class; 
```

根据您的问题，尚不清楚是否是这种情况。也许问题的另一部分（或先前的问题）清楚地表明这种多态破坏是有意的。或者，也许您在课堂上被教导要始终将这种使用视为最佳实践。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-07T14:41:15.107

它们不是 100% 正确的。虚拟析构函数是必须的，如果

1.  与动态多态一起使用的类层次结构 AND
2.  派生对象通过指向基的指针被销毁。

否则非虚拟析构函数是可以的。但在大多数情况下，即使只打算使用#1，将析构函数设为虚拟也是一种很好的风格，而不管#2 是什么。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-07T16:09:40.323

在标准中，大多数继承层次结构在其基础上都有一个虚拟析构函数。但是，`sub_match`它被定义为公共继承，`std::pair<BidirectionalIterator, BidirectionalIterator>`因此它可以拥有动态分配的内存。在相关领域中，`match_results`不要求但通常实现为`std::vector<...>`明确分配内存的公共继承。

您的考官并非完全不正确，但对动态分配内存的关注是一种转移注意力的做法，暴露出令人担忧的对标准的*无知*；虽然在大多数实现中，通过指向没有虚拟析构函数的基类型的指针删除派生类型将导致破坏切片对象，但根据标准，这是未定义的行为。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-07T14:59:13.340

为了在此处跟进所有好的答案，这是一种良好的做法，即声明一个虚拟析构函数以确保在应该对**类进行子类化以形成层次结构**并且您希望通过指向它的指针删除派生对象时进行适当的清理。C++ 标准对此很清楚：

> 当您想通过基类指针删除派生类对象并且基类的析构函数不是虚拟且结果未定义时

通过未定义的行为，您可能会想到内存泄漏，例如，如果您的派生类分配了一些动态内存，并且您稍后尝试通过此基类删除它。您的老师可能正在考虑这种情况。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-07T14:41:27.587

添加到其他答案：您还可以设想一种情况，您确实需要一个公共基类，但您没有任何实际的接口函数。但是如果你想要 RTTI 和动态转换支持，你需要在你的类中添加一个虚函数。析构函数可以就是那个函数。

例如，假设您是一名正在康复的 Java 程序员，并坚持认为一切都是`Object`. 您可能会像这样启动您的第一个 C++ 程序：

```
class Object
{
public:
   virtual ~Object() { }
}; 
```

现在`Object`确实可以作为每个类的最终多态基类。

[如果您还认为这`Object`应该是抽象的，您甚至可以将析构函数设为纯虚拟：]

```
class Object { public: virtual ~Object() = 0; }; Object::~Object() { } 
```

# java - 如何将文件与java中的程序相关联

> ID：12320138
> 
> 赞同：1
> 
> 时间：2012-09-07T14:30:50.780
> 
> 标签：java, c++, user-interface, file-io, file-association

以记事本为例。您可以使用记事本打开文件（右键单击并打开，如果文件已与记事本关联，则双击文件），它将显示文件的内容。我希望能够使用我正在编写的程序打开一个 xml 文件，以便它可以进行一些解析并提供所需的输出。在java中有哪些方法可以做到这一点？打开程序时，我是否必须要求将参数传递给程序？这在 C++ 或其他语言中会更容易吗？如果您需要任何进一步的信息，请告诉我——这是我能想出的描述我的情况的最佳方式，这可能就是我的谷歌搜索结果为空的原因。预先感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T14:33:29.213

您可以将扩展名与 java jar 相关联，并且文件名将被传递，因为`args[0]`它没有比这更简单的了。我建议您使用“hello world”程序尝试一下。;)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T14:42:56.150

> 显示文件的内容..在java中有哪些方法可以做到这一点？

安装/启动应用程序。使用[Java Web 开始](https://stackoverflow.com/tags/java-web-start/info)。

> Java Web Start (JWS) 是 Oracle Corporation 的技术，用于直接从网络或 Internet 链接启动富客户端（Swing、AWT、SWT）桌面应用程序。它为支持 Java 的平台提供“一键式”安装。
> 
> JWS 提供了许多吸引人的功能，包括但不限于启动屏幕、桌面集成、**文件关联、**自动更新（包括延迟下载和更新的编程控制）、按平台、架构或 Java 版本、配置划分本地和其他资源下载运行时环境（最低 J2SE 版本、运行时选项、RAM 等），使用扩展轻松管理公共资源。

这是一个[演示。的 JNLP API 文件服务](http://pscode.org/jws/api.html#fs)`.zzz`（JWS 应用程序可用的 API。）在启动文件的文件类型中注册兴趣（声明关联） 。关联也可以使用[`IntegrationService`](http://docs.oracle.com/javase/7/docs/jre/api/javaws/jnlp/javax/jnlp/IntegrationService.html)JNLP API 以编程方式完成。

# android - 将正确的重力设置为 ProgressDialog 内的消息

> ID：12320139
> 
> 赞同：3
> 
> 时间：2012-09-07T14:30:56.153
> 
> 标签：android, android-layout, android-intent

我想为我的 ProgressDialog 中的消息设置正确的重力。我试图：

```
dialog = new ProgressDialog(activity);
dialog.getWindow().setGravity(Gravity.RIGHT);
dialog.setMessage(loadDialogMessage); 
```

但是消息的严重性仍然设置在右侧。我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T14:48:13.340

像这样的东西应该可以解决问题：

```
ProgressDialog dialog = new ProgressDialog(getActivity());
dialog.setMessage("42 is the answer to life the universe and everything");
dialog.show();
TextView tvMessage = (TextView)dialog.findViewById(android.R.id.message);
tvMessage.setGravity(Gravity.RIGHT); 
```

我只是查看了源[http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.2_r1.1/android/app/ProgressDialog.java#147](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.2_r1.1/android/app/ProgressDialog.java#147) 并查看在 textview 的 id

# foursquare - user/USER_ID/lists 端点未返回我的所有列表

> ID：12320140
> 
> 赞同：0
> 
> 时间：2012-09-07T14:30:57.170
> 
> 标签：foursquare

user/USER_ID/lists 端点似乎只返回了我的 4 个列表，而不是全部。我创建了 5 个列表（嗯，包括我有 5 个的 TODO 列表），并且该端点仅返回 4 个最近更新的列表。我的所有列表都显示在我的个人资料和单击保存按钮时的foursquare网站上，但是当我在我的应用程序或资源管理器中使用端点时，我只得到4个列表。作为测试，我在列表中添加了一个未显示的场所，现在该列表已返回，但另一个列表不再返回。count 属性显示 5，但 items 数组只包含 4。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T21:28:16.513

我在没有组的情况下调用端点，一旦我添加了 group=created，它就会返回所有内容。我以为我之前已经添加过，但是有两个地方我调用了这个端点，为一个而不是另一个。

# python - Python：ImportError：没有名为 os 的模块

> ID：12320143
> 
> 赞同：7
> 
> 时间：2012-09-07T14:31:04.037
> 
> 标签：python, django, mod-wsgi

**错误日志**

```
...
[Fri Sep 07 16:30:14 2012] [error] import os
[Fri Sep 07 16:30:14 2012] [error] ImportError: No module named os 
```

**-贝壳-**

```
[root@lts5srv1 home]# ldd /root/epd-5.1.0/bin/python
    libpython2.5.so.1.0 => /root/epd-5.1.0/lib/libpython2.5.so.1.0 (0x00002b0829205000)
    libpthread.so.0 => /lib64/libpthread.so.0 (0x0000003da0600000)
    libdl.so.2 => /lib64/libdl.so.2 (0x0000003d9fe00000)
    libutil.so.1 => /lib64/libutil.so.1 (0x0000003dadc00000)
    libm.so.6 => /lib64/libm.so.6 (0x0000003da0200000)
    libc.so.6 => /lib64/libc.so.6 (0x0000003d9fa00000)
    /lib64/ld-linux-x86-64.so.2 (0x0000003d9f600000) 
```

有人知道如何解决这个错误吗？这是我尝试在 redhat 系统中运行 python 脚本或 django.wsgi 脚本时遇到的唯一错误，之后我将在大学服务器中上传我的网络应用程序......而且我已经配置虚拟主机。所以这是唯一的问题，有人可以帮忙吗？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T09:50:58.760

我找到了该问题的解决方案（在 redhat 系统中），这是与 Django 框架相关的解决方案。

我已经安装了 Python 2.6（所以我不再使用默认安装的 python），并使用新版本的 Python 和其他一些所需的模块重新安装了 Django：（**easy_isntall**，**MySQL_python-1.2.3-py2.6 -linux-x86_64** , **setuptools** , **mod_wsgi-2.5** ) 所以安装后所有这些模块应该在 Python 2.6 的 site-packages 目录中进行比较：“ **/usr/local/lib/python2.6/site-packages** ”。

```
[root@lts5srv1 Python-2.6.8]# ./configure --enable-shared --prefix=/usr/local
[root@lts5srv1 Python-2.6.8]# make
[root@lts5srv1 Python-2.6.8]# make install 
```

配置 mod_wsgi 以链接 Python 2.6 共享库

```
[root@lts5srv1 /]# cd /usr/local/lib/python2.6/config/
[root@lts5srv1 config]# ln -s ../../libpython2.6.so .

[root@lts5srv1 mod_wsgi-2.5]# ./configure --with-python=/usr/local/bin/python2.6
[root@lts5srv1 mod_wsgi-2.5]# make 
[root@lts5srv1 mod_wsgi-2.5]# make install 
```

然后设置环境变量：

```
[root@lts5srv1 Python-2.6.8]# export LD_LIBRARY_PATH=/usr/local/lib/python2.6
[root@lts5srv1 Python-2.6.8]# export LD_RUN_PATH=/usr/lib64/httpd/modules 
```

编辑**~/.bashrc**并添加一些行以保持更改永久：

```
[root@lts5srv1 ~]# vi ~/.bashrc

# .bashrc

# User specific aliases and functions

PATH=/root/epd-5.1.0/lib/python2.5:/root/epd-5.1.0/bin:${PATH}
PYTHONPATH=/usr/local/lib/python2.6
LD_LIBRARY_PATH=/usr/local/lib/python2.6
LD_RUN_PATH=/usr/lib64/httpd/modules

alias rm='rm -i'
alias cp='cp -i'
alias mv='mv -i'

# Source global definitions
if [ -f /etc/bashrc ]; then
        . /etc/bashrc
fi 
```

Django 安装：

```
[root@lts5srv1 Django-1.4.1]# /usr/local/bin/python2.6 setup.py install 
```

然后，检查模块是否正确集成：

```
[root@lts5srv1 /]# ldd /usr/lib64/httpd/modules/mod_wsgi.so
[root@lts5srv1 /]# ldd /usr/local/bin/python2.6 
```

# titanium - Titanium 中的自动化用户界面测试

> ID：12320148
> 
> 赞同：4
> 
> 时间：2012-09-07T14:31:15.090
> 
> 标签：titanium, automated-tests

如何为 Titanium 应用程序创建自动化用户界面测试？该框架是否为此提供了一些东西？是否有任何有用的第三方工具？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T21:03:49.860

你看过[钛茉莉花吗？](https://github.com/guilhermechapiewski/titanium-jasmine#readme)

我从未亲自使用过它，但我听说它对这种类型的东西非常有用。我不确定它测试实际视觉元素的能力。

**编辑**：

要在模拟器或设备上测试用户界面和模拟触摸事件，只需将 UIAutomation 与本机工作流程一起使用！由于每个 Titanium 项目都会编译为 XCode 项目（在发布到应用商店之前，可以并且至少*应该使用本机工作流程对内存泄漏进行分析），您可以*[按照此处的步骤](http://blog.manbolo.com/2012/04/08/ios-automated-tests-with-uiautomation)使用 Javascript 编写自己的测试。

第一步，在模拟器中运行你的应用程序，然后`PROJECT_HOME/build/`打开`xcodeproj`文件。进入 XCode 后，按住“运行”按钮，单击“配置文件”，这将打开“仪器”并添加“自动化”小部件，就像我提供的链接中一样！

这不是特定于钛的，它可以用于任何 iOS 应用程序，并且对于每个 iOS 开发人员来说似乎都是一个很棒的工具，以及仪器内部的分配器和内存泄漏小部件。

可能更好的选择是使用[Gorilla Logic 的免费 MonkeyTalk](https://www.gorillalogic.com/monkeytalk)。如果您对 XCode 不是很有经验，这会更简单一些，并且它具有（理论上）能够测试 iOS 和 Android 的好处。

# css - CSS 新手 - 在子容器中对齐文本和照片

> ID：12320149
> 
> 赞同：4
> 
> 时间：2012-09-07T14:31:16.520
> 
> 标签：css, image, text, containers, vertical-alignment

我一直在寻找这个问题的答案，并尝试了多种修复方法，但均无济于事。我在重建网站时自学 CSS，但遇到了一个小问题。

我在父容器中有一个容器——“子容器”（因为没有更好的术语）有它自己的标题，左边有一张照片，右边有复制。副本应与照片顶部对齐，并且在子容器中照片的右边缘和背景图像的右边缘之间等距。我得到的是照片在正确的位置，副本靠在照片的右下角。

我相当肯定这个问题是缺乏知识和对导致什么的误解之间的混合......所以非常感谢任何帮助。

这是我的CSS：

```
#wrapper {
  background-image:url("images/About/Copy-Block.png");
  background-repeat:no-repeat;
  width: 745px;
  height: 339px;
  margin: 0 auto;
  margin-top: 30px;
}

#wrapper head {
  display:block;
  padding-top: 15px;
  padding-bottom: 2px;
}

#wrapper photo {
  float: left;
}

.wrapcopy {
  padding-left: 90px;
  font-size: 13px;
  color: #FFF;
} 
```

这是我的html：

```
<div id="wrapper">
  <div id="wrapper head" align="center">
    <img src="images/About/About-Us-Subhead.png" width="748" height="116" />
  </div>
  <div class="wrapcopy">
    <img src="images/About/image.png" width="257" height="194" class="wrapper photo"/>
    <i>Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat. Ut wisi enim ad minim veniam, quis nostrud exerci tation ullamcorper suscipit lobortis nisl ut aliquip ex ea commodo consequat. Duis autem vel eum iriure dolor in hendrerit in vulputate velit esse molestie consequat, vel illum dolore eu feugiat nulla facilisis at vero eros et accumsan et iusto odio dignissim qui blandit praesent luptatum zzril delenit augue duis dolore te feugait nulla facilisi.</i>
  </div>
</div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T14:50:04.930

你在 CSS 中写了“photo”而不是“img”，像这样编辑它，它会工作的！

```
#wrapper img{
float: left;
} 
```

但是，您的示例中有 2 个图像，这将使它们都浮动。您可以通过为这些图像提供一个 ID/类来解决这个问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T14:59:30.713

首先，您没有正确引用您的类：“#wrapper photo”应该是“#wrapper .photo”。此外，id 中不能有空格（“#wrapper head”）。

有几种方法可以添加所需的间距。最直接的方法是直接向图像添加填充：

```
#wrapper .photo { float: left; padding-right: 10px } 
```

我还想指出，您使用的标记非常差。标题应该放在 h1-h6 标签中（这些标签中仍然允许使用图片！），文本段落应该放在 p 标签中。部分或文章标签可能是您的包装 div 的合适替代品。只知道 CSS 是不够的，您还需要知道相应的 HTML 标记才能使用它。

一个更有效的方法是这样的：

```
section.foo {
    background-image:url("images/About/Copy-Block.png");
    background-repeat:no-repeat;
    width: 745px;
    height: 339px;
    margin: 0 auto;
    margin-top: 30px;
}
section.foo h1 {
    padding-top: 15px;
    padding-bottom: 2px;
    text-align: center;
}
section.foo p {
    padding-left: 90px;
    font-size: 13px;
    color: #FFF;
    font-style: italic;
}
section.foo p img {
    float: left;
    padding-right: 10px;
} 
```

和 HTML：

```
<section class="foo">
<h1><img src="images/About/About-Us-Subhead.png" width="748" height="116" /></h1>

<p><img src="images/About/image.png" width="257" height="194" /> Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat. Ut wisi enim ad minim veniam, quis nostrud exerci tation ullamcorper suscipit lobortis nisl ut aliquip ex ea commodo consequat. Duis autem vel eum iriure dolor in hendrerit in vulputate velit esse molestie consequat, vel illum dolore eu feugiat nulla facilisis at vero eros et accumsan et iusto odio dignissim qui blandit praesent luptatum zzril delenit augue duis dolore te feugait nulla facilisi.</p>
</section> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T14:59:06.543

首先，切勿使用任何空格命名 ID。

所以改成`id="wrapper head"`id=`id="wrapper_head"`

接下来，可以通过标签选择元素。
图像由`<img`标记编码，因此您可以直接在 CSS 中通过`img { }`.

在你的情况下，你想在`#wrapper`分割内选择图像，所以选择它：

```
 #wrapper img 
  {
   /* Code Here... */
  } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T15:00:50.153

您的代码的问题是 id 标签中的空格。
尝试类似的东西

```
<div id="wrapper_head" .... 
```

代替

```
<div id="wrapper head" .... 
```

那应该可以解决您的问题！

# c++ - 生成 *char 缓冲区

> ID：12320151
> 
> 赞同：0
> 
> 时间：2012-09-07T14:31:22.177
> 
> 标签：c++, visual-c++

我需要创建一个包含 300 个符号的缓冲区并将其传递给下面描述的函数：

```
void printThis(char *info); 
```

生成此缓冲区的最佳方法是什么？

如果这很好：

```
char *buffer = new char() 
```

那么，如何向这个缓冲区添加字符呢？以下方法不好，它会引发访问冲突：

```
for (int i=0; i<300;i++)
{
   sprintf(s,"%s",'a');
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T14:59:40.280

```
std::vector<char> buffer(300, 'a');

// I'm guessing that printThis wants a zero-terminated string
buffer.push_back(0);

printThis(&buffer[0]); 
```

如果您使用的是 C++11 库，那么`buffer.data()`可能看起来比`&buffer[0]`.

如果您真的想自己管理内存（提示：您不想），请创建一个自动数组：

```
char buffer[300]; 
```

或动态数组：

```
char * buffer = new char[300];

// Don't forget to delete it, and hope than nothing threw an exception
delete [] buffer; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:06:44.180

> 如果这很好：

它不是。真的，真的，不是。它甚至不是缓冲区。这也不是一个好主意。

```
std::string s;
for(int i = 0; i < 300; i++)
    s.push_back('a'); // good job all round
std::cout << s; // 300*a. Why? Who knows?
printThis(s.c_str()); 
```

# javascript - 是否可以创建带有进度条的跨浏览器 AJAX 照片上传器？

> ID：12320153
> 
> 赞同：0
> 
> 时间：2012-09-07T14:31:43.977
> 
> 标签：javascript, upload

我一直在网上搜索如何做到这一点。

这似乎几乎不可能？？

是否可以创建带有进度条的跨浏览器 AJAX 照片上传器？我可以做动态缩略图生成，但我似乎找不到适用于 IE 和其他浏览器的带有进度条的纯 JavaScript 动态上传的跨浏览器解决方案。

有什么建议吗？：/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T14:41:56.247

我建议将此[http://www.uploadify.com/](http://www.uploadify.com/)与 html 5 后备一起使用。

# appendto - 在表格中添加/删除行

> ID：12320159
> 
> 赞同：0
> 
> 时间：2012-09-07T14:32:02.880
> 
> 标签：appendto

我有以下 jquery 代码来添加和删除表中的一行。我在一页上有多个表格。每个表中的每一行都有这两个类：.row-add 和 .row-delete

现在，当我单击“.row-add”添加新行时，所有表都会受到影响，这意味着该行将添加到同一页面上的所有表中。我应该怎么做才能使它在单击时仅适用于自己的表？

查询：

```
$(document).ready(function () {
    $('.row-delete').click(function () {
      $(this).closest("tr").remove();
    });

    $('.row-add').click(function () {
      $(this).closest("tr").clone(true).appendTo(".table-comparison");
    });

  }); 
```

html:

```
<div id="tab-1" class="tab-section">
                            <div class="container flat rounded-sm bspace">
                          <table cellspacing="0" class="display table-comparison">
                        <thead>
                            <tr>
                              <th><span>Effective Date</span></th>
                              <th><span>Price</span></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><input class="effective-date" type="text" value="01/01/2013"> - <input class="effective-date" type="text" value="06/05/2015">
                <span class="row-add"></span>
                <span class="row-delete"></span>
                  </td>
                <td>
                $<input class="price" value="50">
                /
                <select>
                  <option>Second</option>
                  <option>Minute</option>
                  <option>Hour</option>
                  <option>Day</option>
                  <option>Week</option>
                  <option>Biweek</option>
                </select>
                /
                 <select>
                  <option>Day</option>
                  <option>Week</option>
                  <option>Biweek</option>
                  <option>Month</option>
                  <option>Quarter</option>
                  <option>Year</option>
                </select>
                <span class="row-add"></span>
                <span class="row-delete"></span>
                </td>                           
                </tr>

              <tr class="price-present">
                                <td><input class="effective-date" type="text" value="07/01/2013"> - <span class="effective-date">Present</span>
                <span class="row-add"></span>
                <span class="row-delete"></span>
                  </td>
                <td>
                $<input class="price" value="40">
                /
                <select>
                  <option>Second</option>
                  <option>Minute</option>
                  <option>Hour</option>
                  <option>Day</option>
                  <option>Week</option>
                  <option>Biweek</option>
                </select>
                /
                 <select>
                  <option>Day</option>
                  <option>Week</option>
                  <option>Biweek</option>
                  <option>Month</option>
                  <option>Quarter</option>
                  <option>Year</option>
                </select>
                <span class="row-add"></span>
                <span class="row-delete"></span>
                </td>                           
                </tr>

                <tr>
                                <td><input class="effective-date" type="text" value="01/01/2011"> - <input class="effective-date" type="text" value="06/30/2012">
                <span class="row-add"></span>
                <span class="row-delete"></span>
                  </td>
                <td>
                $<input class="price" value="30">
                /
                <select>
                  <option>Second</option>
                  <option>Minute</option>
                  <option>Hour</option>
                  <option>Day</option>
                  <option>Week</option>
                  <option>Biweek</option>
                </select>
                /
                 <select>
                  <option>Day</option>
                  <option>Week</option>
                  <option>Biweek</option>
                  <option>Month</option>
                  <option>Quarter</option>
                  <option>Year</option>
                </select>
                <span class="row-add"></span>
                <span class="row-delete"></span>
                </td>                           
                </tr>

                        </tbody>
                    </table>
                      </div>
                        </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T14:37:14.810

尝试具体...最接近（“tr”）您正在选择所有trs。

尝试提供一个 ID 或类并使用 jquery 选择该 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T14:39:16.030

问题是你的 jQuery 选择器在类属性上，如果你想引用单个表，你必须通过 id 去。

在这种情况下，我认为最好的方法是，如果您以编程方式生成 html 代码，则将自动生成的 id 添加到每个表中，并将以下代码添加到每个可点击的行中：

```
onclick="addrow(table_id)" 
```

其中 table_id 是表的自动生成的 id。然后：

```
function addrow(table) {$(table).closest("tr").clone(true).appendTo(".table-comparison");} 
```

请注意，也应避免 .table-comparison 切换到 id，但我不知道您的代码的详细信息！

希望这可以帮助！

编辑：更好的是，如果你不生成代码，是绑定函数，比如

```
$("p").bind("click", function(event){ 
```

通过这种方式，您可以事后访问发送事件的人。在你的情况下，你我认为你可以写：

```
$(".row-delete").bind("click", function (event) {
    event.target.closest("tr").remove();
    });

$(".row-add").bind("click", function (event) {
    event.target.closest("tr").clone(true).appendTo(".table-comparison");
    }); 
```

来源：[jQuery 文档](http://api.jquery.com/bind/)

# c++ - 哪些是适合小型数据集的本地数据库（易于使用 C++ 处理）

> ID：12320166
> 
> 赞同：0
> 
> 时间：2012-09-07T14:32:25.627
> 
> 标签：c++, database, oracle, api

电脑上已经安装了ORACLE。但是我之前没有尝试过ORACLE，我只是使用sqlite...所以，现在我想在本地创建一个数据库，并且只插入一个表。我想用一个测试 C++ 程序在这个数据库中读写。使用 API 有什么有用的吗？顺便说一句，在计算机上我看到了 SQL plus 和 SQL developer，但我没有找到我知道可以用来创建表的 DBCA...帮帮我，非常感谢！！

顺便说一句，我的主管要我测试不同类型的数据库，这将写在我的报告中。所以我想测试不同类型的数据库，因为数据很小，一个表100行就够了，但是会应用到一个大程序中，所以我需要在本地尝试不同类型的数据库，并不难让我使用 C++ API...因为我对数据库知之甚少。我需要一些建议，非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T16:20:02.883

虽然我不建议使用 Oracle 处理小型数据集，但我确实有指向 C++ API 文档的指针。

[http://www.oracle.com/pls/db112/portal.portal_db?selected=5&frame=](http://www.oracle.com/pls/db112/portal.portal_db?selected=5&frame=)

...并滚动到页面底部以获取更多信息的链接。

可以选择将 C++ 与 Oracle OCI API 一起使用，或者将 C++ 与 Oracle Pro*C 预编译器一起使用。预编译器实际上会生成使用 OCI API 的代码。

我已经使用 Pro*C 预编译器做了一些工作（使用 C 作为实现语言，但不是 C++），而且还不错。OCI 往往是相当低级的，但显然直接编写 OCI 代码也有其用途。

# function - 如何将引用另一列的函数添加到 libreoffice-calc？

> ID：12320173
> 
> 赞同：3
> 
> 时间：2012-09-07T14:32:43.330
> 
> 标签：function, spreadsheet, libreoffice

很抱歉这个简单的问题，我原以为这是一个 2 分钟的工作，但事实证明它比我计划的要复杂得多，并且“功能向导”没有帮助。

我有一个产品电子表格（一行 = 一个产品，列 = 产品名称 | 库存 | RRP 等）。

D 列给出不包括增值税的成本价格，我需要添加另一列给出包括增值税的成本（D 列 + 20%）。

我已经想出了如何向特定的 cel 添加函数和引用特定的 cel，因此我可以逐个 cel 地执行此操作 =SUM(D2*(1.2)) 但出于显而易见的原因，我宁愿这样做一次列而不是一个一个地做 10k+ 个产品！我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T15:24:06.163

“填充”功能可能对您的情况有用：

*   选择第一个包含公式的单元格以及工作表下应插入公式的所有单元格；
*   选择菜单 " `Edit`" -> " `Fill`" -> " `Down`"，或点击`CTRL`+`D`

这将使 Calc 将公式复制到所有选定的单元格中，更新单元格引用（除非您有使用美元符号的绝对引用）。

对于 10k+ 行，这可能需要很短的时间，因为 Calc 也会计算结果，但它至少应该可以工作。

# jquery - 根据多个子元素查找元素

> ID：12320174
> 
> 赞同：0
> 
> 时间：2012-09-07T14:32:54.050
> 
> 标签：jquery, jquery-selectors

该页面上有多个问题/答案集。每个集合都被分组到一个“questionItem”类的 div 中。在每个集合中，总是有一个名为 answers[idx].SetAnser 的输入，并且可能有一个 answers[idx].Answer，其中 idx 是集合的索引。

需要解决的问题是找到所有问题集 div 元素，其中 SetAnswer 为一个值，Answer 为另一个值。这是示例html：

```
<div class="questionItem format">
    <input name="answers[0].SetAnswer" type="hidden" value="0" />

    <select name="answers[0].Answer">
      <option selected="selected" value="0">(0) No</option>
      <option value="1">(1) Yes</option>
      <option value="-">(-) Not assessed</option>
    </select>
</div>

<div class="questionItem format">
    <input name="answers[1].SetAnswer" type="hidden" value="?" />
    <select name="answers[1].Answer">
        <option selected="selected" value="?">(select item)</option>
        <option value="0">(0) No</option>
        <option value="1">(1) Yes</option>
        <option value="-">(-) Not assessed</option>
    </select>
</div>

<div class="questionItem format">
    <input name="answers[2].SetAnswer" type="hidden" value="?" />
    <input name="answers[2].Answer" type="number" value="" />    
</div>

<div class="questionItem format">
    <input name="answers[3].SetAnswer" type="hidden" value="red" />
    <input name="answers[3].Answer" type="number" value="red" />    
</div> 
```

我能想到的最好的，但不起作用的是这样的：

```
var answerColl = $(this).find(":input").filter(function () {
    return /^answers\[\d+\]\.Answer$/.test(this.name); 
    });

// Make sure there is an 'Answer' input, if there isn't, that is because it is 
// not displayed, so assume not unanswered
if (answerColl.length > 0) {
    var answerElement = answerColl.first();
    var answer = answerElement.value;

    // First check to see if the answer is ?
    if (answer == "?")
        return true;

    // Next check to see if the answer is empty, if so, must check the setAnswer.  
    // If the setAnswer is ^, then this is no unanswered, if it is ? it is unanswered.
    if (!Boolean(answer)) {

        var setAnswerElement = $(this).find(":input").filter(function () { return /^answers\[\d+\]\.SetAnswer$/.test(this.name); }).first();
        var setAnswer = setAnswerElement.value;

        if (setAnswer == "?")
            return true;
    }
}

return false; 
```

问题在于：

```
var answerElement = answerColl.first();
var answer = answerElement.value; 
```

当我在调试器中查看它时，answerElement 是一个 jQuery 对象，但 answer 始终为空。查看 answerElement 时，默认值是我正在寻找的值，即实际答案，但我无法弄清楚如何在代码中得到它。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T20:01:30.113

我认为您不需要为此编写正则表达式。您只需使用 $.each 循环即可轻松解决此问题。首先选择元素..然后在这些元素上运行 $.each 循环以检查对于你所说的条件..试试这个

```
$(function() {

    $('#btn1').on('click', function() {
        var correctAnswer = $('.questionItem input');
        var userAnswer = $('.questionItem select option:selected');

        $.each(correctAnswer, function(i) {
            // This will give the Question Div's Whose SetAnswer and Answers are different..
            if ($(this).val() != $(userAnswer[i]).val()) {

                // Will give a List of all Answers that are set
                console.log('Correct Answer for Question ' + i + ' is  : ' + $(this).val());
                // Will give a List of all Answers that the user Answered
                console.log('User Selection for Question ' + i + ' is  : ' + $(userAnswer[i]).val());

                // This will print the Question Div for Which 
                // SetAnswer and Answer is different..
                console.log('SetAnswer is of one value and Answer is of another value for : ' + $(this).parent().attr('id'));
            }
        });
    });

});​ 
```

检查此[FIDDLE](http://jsfiddle.net/sushanth009/txn2D/)以获取工作示例..

# javascript - 在服务器端脚本执行后关闭选项卡

> ID：12320175
> 
> 赞同：0
> 
> 时间：2012-09-07T14:33:00.690
> 
> 标签：javascript, jquery

我需要一点帮助。我想在执行经典的 asp 脚本后关闭一个 firefox 选项卡，该脚本在一天中的特定时间自动运行。

我尝试了以下代码但没有成功：

```
<% ASP SCRIPT %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<script language="javascript" type="text/javascript">
window.onload = function(){window.close();}
</script>
</head>
</html> 
```

任何想法如何实现？任何帮助将不胜感激。

非常感谢，neojakey

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T14:35:45.370

参考[这个问题](https://stackoverflow.com/questions/8301780/javascript-code-to-close-tab-that-works-in-ie-firefox-and-chrome)。这似乎不可能。

# c# - 如何使用 linq 从列表字典中获取项目

> ID：12320177
> 
> 赞同：0
> 
> 时间：2012-09-07T14:33:06.260
> 
> 标签：c#, linq, data-structures, linq-to-objects

我不太了解LINQ。我发现的每个示例都过于简化，以至于我不知道您为什么还要使用 LINQ，或者太复杂以至于我需要知道 LINQ 的工作原理才能理解它。

所以我想知道你是否以及如何使用 LINQ... 每个能力都有等级要求。如何使用 LINQ 为一组特定类选择处于或低于某个级别的所有能力？

鉴于此数据：

*   第一类
    *   能力1 - 1级
    *   能力 2 - 5 级
    *   能力 3 - 9 级
*   2 类
    *   能力4 - 1级
    *   能力 5 - 2 级
    *   能力6 - 6级
*   三级
    *   能力 7 - 2 级
    *   能力8 - 4级
    *   能力 9 - 6 级

我想要 5 级或以下 Class1 和 Class3 的所有能力列表。结果应该是 { Ability1, Ability2, Ability7, Ability8 }。

```
public class Class1
{

  public class Ability
  {
    public string Name { get; set; }
    public int Level { get; set; }
  }

  public class PlayerClass
  {
    public string Name { get; set; }
    public List<Ability> Abilities { get; set; }
  }

  public List<PlayerClass> Classes { get; set; }

  public Class1()
  {
    PlayerClass oClass;

    Classes = new List<PlayerClass>();

    oClass = new PlayerClass();
    oClass.Name = "Class1";
    oClass.Abilities = new List<Ability>();
    oClass.Abilities.Add(new Ability() { Name = "Ability1", Level = 1 });
    oClass.Abilities.Add(new Ability() { Name = "Ability2", Level = 5 });
    oClass.Abilities.Add(new Ability() { Name = "Ability3", Level = 9 });
    Classes.Add(oClass);

    oClass = new PlayerClass();
    oClass.Name = "Class2";
    oClass.Abilities = new List<Ability>();
    oClass.Abilities.Add(new Ability() { Name = "Ability4", Level = 1 });
    oClass.Abilities.Add(new Ability() { Name = "Ability5", Level = 2 });
    oClass.Abilities.Add(new Ability() { Name = "Ability6", Level = 6 });
    Classes.Add(oClass);

    oClass = new PlayerClass();
    oClass.Name = "Class3";
    oClass.Abilities = new List<Ability>();
    oClass.Abilities.Add(new Ability() { Name = "Ability7", Level = 2 });
    oClass.Abilities.Add(new Ability() { Name = "Ability8", Level = 4 });
    oClass.Abilities.Add(new Ability() { Name = "Ability9", Level = 6 });
    Classes.Add(oClass);

    IEnumerable<Ability> Abilities = 
                   GetAbilitiesForClasses("Class1;Class3".Split(';'), 5);
    //Abilities should contain Ability1, Ability2, Ability7, Ability8
  }

  public IEnumerable<Ability> GetAbilitiesForClasses
       (string[] asClassNames, int iLevel)
  {
    // TODO: Use LINQ to return the abilities for the class names 
           //contained in asClassNames that are at or below level: iLevel
    return null;
  }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T14:36:53.927

```
public IEnumerable<Ability> GetAbilitiesForClasses(string[] asClassNames, int iLevel)
{
    return Classes
           .Where(X => asClassNames.Contains(X.Name))
           .SelectMany(X => X.Abilities)
           .Where(X => X.Level <= iLevel)
           .ToList();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T14:40:05.263

假设您的播放器类由一个`PlayerClass`类表示，其`Abilities`属性为 type `IDictionary<string, int>`：

```
List<PlayerClass> classes = ...
var results =
    from c in classes
    where c.Name == "Class1" || c.Name == "Class2"
    from ab in c.Abilities // ab is of type KeyValuePair<string, int>
    where ab.Value <= 5
    select ab.Key; 
```

但最好用和属性定义一个`Ability`类；该属性将是：`Name``Level``Abilities``IList<Ability>`

```
List<PlayerClass> classes = ...
var results =
    from c in classes
    where c.Name == "Class1" || c.Name == "Class2"
    from ab in c.Abilities
    where ab.Level <= 5
    select ab.Name; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T14:37:36.900

如果你只是存储能力，你可以将它们整合到一个结构中，并有一个你可以执行的类列表`LINQ`。

例如：

```
public List<AbilityClass> Abilities { get; set; } 
```

*林克：*

```
 var level9Abilities = (from a in Abilities
                    where.Level == "Level 9"
                 // where a.Level > 9 (if Level is an int)
                  select a).ToList();

 foreach (var lvl in level9Abilities) {
      Console.WriteLine(lvl);
 } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-07T14:39:45.383

你可以使用`SelectMany`，假设：

```
 public class Class
{
    public List<Ability> Abilities { get; set; }
}

public class Ability
{
    public string Name { get; set; }
    public int Level { get; set; }
} 
```

使用 Linq：

```
var classes = new List<Class>() {class1, class3};

var output = classes.SelectMany(c => c.Abilities)
            .Where(a => a.Level <= 5); 
```

# javascript - 隐藏/显示包含单词的 ul li 项目。但只检查 li 的一个孩子

> ID：12320180
> 
> 赞同：0
> 
> 时间：2012-09-07T14:33:24.420
> 
> 标签：javascript, jquery, filter

标记：（假设列表中有很多孩子，都具有相同的标记）

```
<ul class="notifications messages inbox">   
                <li class=" unread">
                            <div class="avatar">
                                <a href="index.php?userid=94"><img alt="" src="http://profile.ak.fbcdn.net/hprofile-ak-snc4/276073_662982570_5177619_n.jpg"> </a>
                            </div>
                            <div class="txt">
                                <a class="userName" href="index.php?userid=94">Jose ignacio bustamante  <span class="date"> - 2012-09-07 13:49:59</span></a>
                                <div>
                                                                        <a href="messages.php?conversationid=94" class="msj"><span>Esque esto de querer cargar una conversación por defecto... como usuario no ...</span></a>
                                </div>      
                            </div>
                            <span data-id="442" class="close">X</span>          
                    </li> 
```

所以我试图`<li>`根据 .username 标记值（在其中）过滤这些元素

```
/* I have used this before, its a :contains modification to handle uppercase */
$.expr[':'].icontains = function(a, i, m) {
          return jQuery(a).text().toUpperCase()
              .indexOf(m[3].toUpperCase()) >= 0;
};
$('body').on('keyup','.filterFriends',function(){
                $('.inbox li').hide().filter(':icontains("'+this.value+'")').show();
                        /* How to apply this icontains selector to $('.inbox li').find('.userName') ?? */
}); 
```

这有一个问题，我猜它会检查整个 li，我真的不知道如何在 filter() 函数中选择 .userName 类。

谁能给我看灯？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T14:51:47.607

```
$('body').on('keyup','.filterFriends',function(){
    $('.inbox li')
        .hide()
        .find('.userName')
        .filter(':icontains("'+this.value+'")')
        .closest('.inbox li')
        .show();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T14:42:56.960

你可以试试这个：

```
$('body').on('keyup','.filterFriends',function(){
    var li=$('.inbox li').hide();
    $('.userName',li).filter(':icontains("'+this.value+'")').parents('li').show();
} 
```

# javascript - JSON重排

> ID：12320188
> 
> 赞同：-1
> 
> 时间：2012-09-07T14:34:15.783
> 
> 标签：javascript

我有以下要重新排列的对象，以便可以传递给模板。需要帮助将其从以下格式转换

```
var nature = [
  {
    "type": "fruit",
    "name": "apple",
    "color": "red",
  },
  {
    "type": "vegetable",
    "name": "carrot",
    "color": "orange",
  },
  {
    "type": "fruit",
    "name": "grape",
    "color": "green",
  },
  {
    "type": "vegetable",
    "name": "tamato",
    "color": "red",
  },
]; 
```

到这种格式

```
var nature = [{
    "fruit": [
        {
            "type": "fruit",
            "name": "apple",
            "color": "red"
        },
        {
            "type": "fruit",
            "name": "grape",
            "color": "green"
        }
    ],
    "vegetable": [
        {
            "type": "vegetable",
            "name": "carrot",
            "color": "orange"
        },
        {
            "type": "vegetable",
            "name": "tomato",
            "color": "red"
        }
    ]
}]; 
```

寻找实现它的最快方法。感谢您查看帖子。感谢帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T14:41:07.413

**对抗自然！**

```
var goAgainstNature = function(oldNat) {
    var newNat = {}, i;

    for(i = 0; i < oldNat.length; i++) {
        (newNat[oldNat.type] = (newNat[oldNat.type] || [])).push(oldNat[i]);
    }

    return [newNat];
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T14:59:27.463

我认为这是对的

```
var goAgainstNature = function(oldNat) {
    var newNat = {}, i;

    for(i = 0; i < oldNat.length; i++) {
        (newNat["'"+oldNat[i].type+"'"] = (newNat[oldNat.type] || [])).push(oldNat[i]);
    }

    return [newNat];
}; 
```

# jquery - jQuery .each 它计算我从 textarea 复制和粘贴的每个链接

> ID：12320193
> 
> 赞同：0
> 
> 时间：2012-09-07T14:34:49.847
> 
> 标签：jquery, split, each

我有这个表格，当我打开记事本时，会有我的链接列表，我从记事本复制它，然后将所有链接粘贴到 textarea 中，然后它应该计数。

但我试图解决的是，当我复制和粘贴时，它会在我输入时自动计数。

我的代码在下面解释我的作品。

jQuery 代码

```
jQuery.fn.wordCount = function(params) {
    var p =  { counterElement:"display_count" };
    var total_words;

    if(params) {
        jQuery.extend(p, params);
    }

    //for each keypress function on text areas
    this.keypress(function() {
        total_words=this.value.split("\n").length;
        jQuery('#'+p.counterElement).html(total_words);
    });
};

$(document).ready(function(){                           
    $('#txtLinks').wordCount();
}); 
```

我的表格

```
<form method="post">
<textarea name="texturl" rows="10" cols="20" id="txtLinks" class="textarea-addlinks"></textarea>
</form> 
```

链接是

```
http://09-flex-actionscript-it.gnstudio.com/index.php?title=Are_aware_of_the_Uncomplicated_strategies_to_post_sms_to_help_all_people
http://09-flex-actionscript-it.gnstudio.com/index.php?title=Below_To_acquire_pizza_hut_vouchers
http://09-flex-actionscript-it.gnstudio.com/index.php?title=Brand-new_business_model_innovation_specialists
http://09-flex-actionscript-it.gnstudio.com/index.php?title=Ery_at_times_a_good_Pizza_Express_Voucher_Are_usually_for_exciting
http://09-flex-actionscript-it.gnstudio.com/index.php?title=Gain_knowledge_of_on_the_subject_of_signs_of_depression
http://09-flex-actionscript-it.gnstudio.com/index.php?title=Get_yourself_a_dvd_swimming_pool_covers_currently
http://09-flex-actionscript-it.gnstudio.com/index.php?title=Simple_and_standard_symptoms_of_the_flu
http://09-flex-actionscript-it.gnstudio.com/index.php?title=Speaking_about_the_necessities_regarding_tinnitus_miracle:
http://09-flex-actionscript-it.gnstudio.com/index.php?title=The_best_places_to_secure_cheap_supplements_web_based 
```

计数值应该是 9。有什么方法不需要按回车我的意思是它会自动计算链接？顺便说一句——它是如何计算的？它算再见新链接。

多谢你们

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T14:47:43.653

这似乎工作：http: [//jsfiddle.net/js7Qn/](http://jsfiddle.net/js7Qn/)

我用了：

```
$('#txtLinks').keyup(... 
```

# python - 创建具有多个键和值的字典

> ID：12320197
> 
> 赞同：0
> 
> 时间：2012-09-07T14:34:55.043
> 
> 标签：python

我想创建一个具有多个键和值的字典。在这一点上，我不确定我的问题是否正确。但这是我想要创建的示例：

```
patDct = {
           'mkey1':{'key1':'val_a1', 'key2':'val_a2', 'key3':'val_a3'},
           'mkey2':{'key1':'val_b1', 'key2':'val_b2', 'key3':'val_b3'},
           ....
          } 
```

我有两个字典，我正在从中提取“mkey*”和“val*”的信息。'key*' 是字符串。

我有一段代码可以创建没有'mkey *'的字典，但这只会打印出最后一组值。以下是我现在所拥有的。“storedct”和“datadct”是两个给定的字典。在这里，我希望'mkey*' 来获取“item”的值。

```
 patDct = dict()                                                                                                                                                             
 for item in storedct :                                                                                                                                                         
     for pattern in datadct :                                                                                                                                                    
         if pattern in item :                                                                                                                                                     
             patDct['key1'] = datadct[pattern]["dpath"]                                                                                                        
             patDct['key2'] = datadct[pattern]["mask"]                                                                                                                                                                                                                                                
             patDct['key3'] = storedct[item] 
```

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T14:45:30.987

根据我从您的代码中了解到的情况，我猜想：

```
patDct = dict()
i = 0
for item in storedct :
    for pattern in datadct :
        if pattern in item :
            i = i + 1
            new_item = {}
            new_item['key1'] = datadct[pattern]["dpath"]
            new_item['key2'] = datadct[pattern]["mask"]
            new_item['key3'] = storedct[item]
            # I used a counter to generate the `mkey` values,
            # not sure you want it that way
            patDct['mkey{0}'.format(i)] = new_item 
```

应该离您的需求不远...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T14:42:29.460

```
 patDct = dict()    
 n=1                                                                                                                                                        
 for item in storedct :
     patDct["mkey%s"%n] = {}
     p =  patDct["mkey%s"%n]                                                                                                                                                            
     for pattern in datadct :                                                                                                                                                    
         if pattern in item :                                                                                                                                                     
             p['key1'] = datadct[pattern]["dpath"]                                                                                                        
             p['key2'] = datadct[pattern]["mask"]                                                                                                                                                                                                                                                
             p['key3'] = storedct[item] 
     n +=1

print patDct 
```

# r - R包重塑函数融化错误：使用很多因素时在数据中找不到id变量

> ID：12320198
> 
> 赞同：20
> 
> 时间：2012-09-07T14:35:08.153
> 
> 标签：r, reshape, melt, mothur

我正在使用[mothur](http://www.mothur.org/)的稀疏输出，它基本上为我提供了一个数据集，其中包含采样的序列数和多个样本中的唯一序列数。我想使用 ggplot2 来可视化这些数据，因此需要使用`melt`从 a`wide`到`long`格式。

问题是由于`melt`. 这基本上说明

> 错误：在数据中找不到 id 变量：1、3、6、（...等等）

由于原始数据集的大小，在这里共享它是不切实际的，但是应该能够使用以下代码重新创建相同的问题：

```
a<-seq(0,300,3)
b<-runif(length(a))
c<-runif(length(a))
d<-as.data.frame(cbind(a,b,c))
d$a<-as.factor(d$a)
melt(d,d$a) 
```

这给出了完全相同的错误：

> 错误：在数据中找不到 id 变量：0,3,6,9, (...)

我看不到我做错了什么。我在 ubuntu 服务器 12.04 上使用 R 2.15.1。函数`reshape::melt`和`reshape2::melt`结果都导致相同的错误。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-07T14:39:30.207

你应该使用：

```
melt(d, id.vars="a")
      a variable       value
1     0        b 0.019199459
2     3        b 0.693699677
3     6        b 0.937592641
4     9        b 0.299259963
5    12        b 0.485403439
... 
```

* * *

在以下帮助下`?melt.data.frame`：

> 要融化的数据数据框
> 
> id 变量的id.vars
> 向量。可以是整数（变量位置）或字符串（变量名）如果为空，将使用所有非测量变量

因此，您的`id.vars`参数应该是名称的字符向量，例如“a”或数字向量，例如`1`。此向量的长度应等于您想要作为 id 的列数。

相反，您使用的因子包含的元素远多于数据中的列。

# php - PHP：会话不适用于父目录

> ID：12320199
> 
> 赞同：-4
> 
> 时间：2012-09-07T14:35:11.790
> 
> 标签：php

我有设置会话的代码，例如：

```
if($found>0){
    session_start();
    $_SESSION['user_name']=$user;

    session_set_cookie_params(24*60*1,'/','.localhost');

    $expire=time()+60*60*24;
    setcookie("cookiename", $user, $expire);

    header("location:http://localhost/UI/user/userprofile.php");
} else{
    $message =  "Username or  password is not correct.";
    header("Location:index.php?message={$message}");
} 
```

这是我在其中放置登录和注销的标题内容

```
session_start();
if (isset($_COOKIE["cookiename"])){
    $unm = $_SESSION["user_name"];
    echo "User :  " . $_SESSION["user_name"] . "";
    echo " <a href='http://localhost/UI/user/logout.php'>logout</a>";
    echo " <a class='addmeeting' href='http://localhost/UI/user/createmeeting.php' title='Create New Meeting'>Create Meeting</a>";
} else{
    echo "<li><a href='register.php'>Register</a></li>";
    echo " User : Guest!<br />";
} 
```

我的会话适用于子文件夹，但不适用于父文件夹。这是目录结构：

```
UI 
   user
      userprofile.php
      login.php
      logout.php 
   index.php
   headers.php 
```

请告诉我我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T14:43:31.157

我的猜测是 cookie 不起作用，而不是会话（您的会话代码位于`if()`首先检查 cookie 的块内）。

Cookie 默认仅限于当前文件夹，因此不会应用于父文件夹。

如果您希望它应用于整个站点，则需要`/`在 cookie 中指定 a，如下所示：

```
setcookie("cookiename", $user, $expire, '/'); 
```

这将在您的整个站点中设置 cookie，因此您的代码应该可以工作。

但是，我真的不明白为什么您不只是在这里使用会话；为什么 cookie 和会话在同一个上下文中？您也可以在会话中设置所有内容并完成它。（无论如何，会话都是基于 cookie）

# apache - 要使用 ServiceMix，我的项目必须是 OSGi 包？

> ID：12320202
> 
> 赞同：5
> 
> 时间：2012-09-07T14:35:42.873
> 
> 标签：apache, apache-camel, osgi, apache-servicemix

我开始使用 ServiceMix 和 Camel，我已经浏览了很多示例。

似乎OSGi的示例可以通过热部署或控制台部署在ServiceMix中，但我不知道如何部署不是OSGI的项目。可以做到吗？

例如，我正在查看 Camel 2.10.0 中名为 camel-example-cxf-proxy 的示例项目。我做了一些改动，现在我想将它加载到 ServiceMix 中。如果我复制/粘贴到部署目录，它会被加载，但是当我尝试通过 osgi:start id 运行它时它会失败。

但是，如果我从 IDE 独立运行它，它运行得很好，我可以通过 SoapUI 发送和接收请求。

完成示例后，我想在 Eclipse 中创建自己的项目并在 IDE 和 ServiceMix 中进行测试。我还不太了解 OSGi 的优势。所以我并不太被迫在我的项目中使用 OSGi。

我的主要问题是：我可以在 servicemix 中部署一个非 OSGi 非 JBI 兼容的项目吗？像camel-example-cxf-proxy这样的东西。如果是，我该怎么做？如果不是，我如何 OSGi-fy camel-example-cxf-proxy？

谢谢 ：）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-08T08:48:50.923

使用 Apache Karaf 作为内核的 Apache ServiceMix 支持可插拔部署单元。虽然 OSGi 是主要单元。

您可以部署 JBI 工件（例如，JBI 被用作 Apache ServiceMix 3.x 的部署单元）。因此，我们提供了它作为在 SMX 4.x 中运行 JBI 的迁移路径。

也可以部署一个普通的 WAR 文件。例如，您可以将一个 .war 文件放到部署目录中。如果你从 shell 部署，你需要在部署器前面加上 war，这样它就知道使用 war 部署器。

这里有一些关于各种可插拔部署器的文档 [http://fusesource.com/docs/esbent/7.0/esb_deploy_osgi/UrlHandlers.html](http://fusesource.com/docs/esbent/7.0/esb_deploy_osgi/UrlHandlers.html)

例如，要使用 Maven 安装 Apache Wicket WAR 示例，您可以从 shell 执行：

```
osgi:install war:mvn:org.apache.wicket/wicket-examples/1.4.7/war?Web-ContextPath=wicket 
```

关于部署器的 Apache 文档主要记录在 Apache Karaf [http://karaf.apache.org/manual/2.2.9/users-guide/deployer.html](http://karaf.apache.org/manual/2.2.9/users-guide/deployer.html)

现在部署 OSGi 应用程序可能有点麻烦。这就是 FuseSource 创建 FAB 以使其更容易的原因。我在博客上写了一点，其中引用了视频和更多材料：[http ://www.davsclaus.com/2012/08/osgi-deployment-made-easy-with-fab.html](http://www.davsclaus.com/2012/08/osgi-deployment-made-easy-with-fab.html)

使用 FAB，您可以开箱即用地部署常规 Maven 项目，而没有任何 OSGi 痛苦。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T14:50:05.227

如果您的项目是 Maven 项目，您可以尝试：

```
mvn install 
```

然后启动您的 servicemix，并在 servicemix 命令行中：

```
install mvn:groupId/artifactId/version 
```

这将提示捆绑 ID。然后，只需启动捆绑包：

```
start <bundle_id> 
```

您可以使用命令“list”检查捆绑包的状态

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-08T12:57:33.557

该项目必须是要安装在 servicemix / karaf 中的捆绑包。因此，使骆驼项目在 OSGi 中运行的步骤如下。

1.  使用 pom 中的 maven bundle 插件，并在必要时将其配置为导入/导出必要的包。

2.  确保以 OSGi 可以启动的方式定义骆驼上下文。这要么在包的激活器中，要么在正确位置的弹簧配置中，或者在正确位置的蓝图配置中。

有关详细信息，请参阅我的两个 karaf 教程：

CXF：[http ://www.liquid-reality.de/x/EoBk](http://www.liquid-reality.de/x/EoBk)

骆驼：[http ://www.liquid-reality.de/x/G4Bk](http://www.liquid-reality.de/x/G4Bk)

# .htaccess - htaccess 重写 https 删除安全前缀

> ID：12320208
> 
> 赞同：0
> 
> 时间：2012-09-07T14:35:59.433
> 
> 标签：.htaccess, mod-rewrite

我需要使用 htaccess 重写

[https://secure25.securewebsession.com/domain.co.uk/wordpress](https://secure25.securewebsession.com/domain.co.uk/wordpress)

到[http://www.domain.co.uk/wordpress](http://www.domain.co.uk/wordpress)

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T14:41:23.500

是的，有可能，试试这个（确保 mod_rewrite 已启用）：

```
RewriteEngine on
RewriteCond %{HTTPS} on
RewriteCond %{HTTP_HOST} ^secure25\.securewebsession\.com$
RewriteRule ^(www\.)?domain\.co\.uk(.*)$ http://www.domain.co.uk$2 [L,QSA,R=301] 
```

# amazon-ec2 - AWS 和 Shibboleth/SAML

> ID：12320209
> 
> 赞同：0
> 
> 时间：2012-09-07T14:36:00.237
> 
> 标签：amazon-ec2, amazon-web-services, saml, shibboleth

我一直在研究是否可以将 Shibboleth/SAML 与 Amazon Web Services 一起使用。

我发现这方面的信息很少。据我所知，可以在 EC2 服务器上安装 Shibboleth/SAML 作为服务提供者。

我不太确定的是是否有可能将所有 AWS 与 Shibboleth 联系起来——以及这将如何运作。

我对这三个方面的知识都模糊不清——我读了很多书，但我对这项技术一点也不熟悉。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:43:52.463

如果我对您的理解正确，您尝试做的是使用联合身份来授予用户[临时安全凭证](http://awsdocs.s3.amazonaws.com/STS/latest/sts-ug.pdf)以执行 AWS api 调用。您希望您的用户向您自己的身份提供商（在本例中为 Shibboleth）进行身份验证，并根据该身份验证授予对 AWS 服务的访问权限。

[此AWS 示例代码](http://aws.amazon.com/code/1288653099190193?_encoding=UTF8&fromSearch=1&queryArg=searchQuery&searchPath=code&searchQuery=token&x=0&y=0)中就是您可以用作框架的一个很好的示例。

简而言之：

您需要用户连接到的代理，并传入他们的身份验证凭据。然后，您将通过向 Shibboleth、AD、LDAP 或其他方式进行身份验证来验证它们。

您需要一个[令牌自动售货机](http://aws.typepad.com/aws/2011/09/updated-mobile-sdks-for-aws-improved-credential-management.html)，然后您的代理将调用它以使用 GetFederationTokenRequest 获取有效的 AWS 密钥。

然后，您的客户将使用给它的令牌进行 AWS api 调用。

![显示临时凭证工作流程的 AWS 图像](../Images/48aa7171f2ae61696bccb5ff88cd33fc.png)

联合身份的概念包括[STS、SP 和 IdP](http://www.empowerid.com/learningcenter/technologies/service-identity-providers)等术语，如果您正在寻找更多研究该主题的起点。

# ruby-on-rails-3 - Rails 默认图片绝对 URL

> ID：12320212
> 
> 赞同：0
> 
> 时间：2012-09-07T14:36:12.203
> 
> 标签：ruby-on-rails-3

我有一个新手问题：

我将默认 URL（指向存储在服务器上的图像）存储为模型的默认图像，例如`/assets/project_default.png`. 用户也可以将 URL 设置为远程 URL。

如何将 URL 显示为绝对 URL，以便它`http://xxxxxx.com//assets/project_default.png`同时支持用户的远程 URL？

如果我使用`"#{request.protocol}#{request.host_with_port}`，那将始终适用。我只想在 URL 不是远程的情况下申请。

干杯，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T14:51:33.683

假设我没看错你的问题，你可以做类似的事情......

application_helper.rb

```
def absolute_image_url (url)
  if url[0] == "/"
    return "#{request.protocol}#{request.host_with_port}" + url
  else
    return url
  end
end 
```

或者将其添加到模型中等。

# c# - 手动适配 DbFirst 模型

> ID：12320215
> 
> 赞同：1
> 
> 时间：2012-09-07T14:36:18.460
> 
> 标签：c#, entity-framework

我有使用带有 DbFirst 模型的 EF 的项目。需要调整实体的某些属性以适应项目的需要。我通过手动编辑 .edmx Designer 文件来做到这一点。这些调整是较小的字符串操作。问题是：每次从数据库更新模型时，这些更改都会被覆盖。还有另一种方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:13:56.120

根据您想要做的事情，EF 为您提供了很多“钩子”，因此您可以添加自定义代码，而不是在设计器中。所有的类都是部分的，所以你可以创建一个部分类，然后如果想改变设置器，可以挂接到 OnYourPropertyNameChanging。

摘自我的一些代码：

```
[EdmScalarPropertyAttribute(EntityKeyProperty=false, IsNullable=true)]
[DataMemberAttribute()]
public global::System.String EmployeeComment
{
    get
    {
        return _EmployeeComment;
    }
    set
    {
        OnEmployeeCommentChanging(value);
        ReportPropertyChanging("EmployeeComment");
        _EmployeeComment = StructuralObject.SetValidValue(value, true);
        ReportPropertyChanged("EmployeeComment");
        OnEmployeeCommentChanged();
    }
}
private global::System.String _EmployeeComment;
partial void OnEmployeeCommentChanging(global::System.String value);
partial void OnEmployeeCommentChanged(); 
```

因此，如果您想在更改方法中执行自定义逻辑，您可以声明一个部分类，并将您的代码如下：

```
public partial class Comment
{
  partial OnEmployeeCommentChanging(string value)
  {
     /* your code goes here */
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T14:57:13.570

这是正确的，当您从数据库更新模型时，它会被刷新。您需要创建一个单独的类，您可以在其中定义实体并对其进行自定义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T14:38:50.847

不是真的，除了从数据库中进行修改以使这些更改保持停滞，否则在模型更新时创建一个事件，以便每次更新模型时，您的设置都会得到加强。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T15:12:49.693

其他两个答案涵盖了您需要的大部分内容。

您的实体模型都构建为部分类。每次对数据库执行任何操作时，都会更改类定义。这就是为什么他们都有标题说不要更改此代码！

假设您有一个数据项目，我在同一个项目中创建新类。所以如果你的模型是

```
partial class Customer:EntityObject 
```

然后您将创建一个定义为的 CustomerOverload 类库

```
partial class Customer 
```

然后该类将包含您的添加等。只是不要添加方法，这些方法不会传递给客户端。

# php - 将头部标签信息存储在单独的文件中然后包含它是一种好习惯吗？

> ID：12320216
> 
> 赞同：2
> 
> 时间：2012-09-07T14:36:24.573
> 
> 标签：php, html

```
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="css/style.css"/>
    <link rel="stylesheet" type="text/css" href="css/homepage.css"/>
    <link rel="stylesheet" type="text/css" href="css/header.css"/>
    <link rel="stylesheet" type="text/css" href="css/footer.css"/>
    <link rel="stylesheet" type="text/css" href="css/navmenu.css"/>
    <!-- more css here -->
    <script type="text/javascript" src="js/jQuery.js"></script>
    <script type="text/javascript" src="js/navmenu.js"></script>
    <!-- more js here -->
</head> 
```

我在所有页面的标签中都有所有外部css和javascripts `<head></head>`，所有这些在所有页面中都很重要。将所有这些放在一个单独的文件中并使用php包含它们是否合适？因此，如果我想对这些外部进行一些更改，这对我来说很容易，因为它会影响我的所有页面..我只是想知道这是否是一个好习惯..**提前谢谢**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T14:43:12.827

是的。但为什么要停在那里？理想情况下，您应该将所有重复标记放在一个文件中。

在 PHP 中有许多共享通用标记的方法，但最简单的方法是拥有一个全局“Top.php”和“Bottom.php”文件，如下所示：

在 Top.php 中：

```
 <html>
 <head>
      <title><?php echo $pagetitle; ?></title>
      <!-- your <meta /> elements go here -->
 </head>
 <body>
      <!-- common page elements go here --> 
```

在底部.php 中：

```
 </body>
 </html> <!-- This ensures all of the common markup is closed --> 
```

然后对于每个页面，执行以下操作：

```
 <?php $pageTitle = "This page's title";
 require("Top.php"); ?>
 <!-- put your per-page markup and PHP code here -->
 <?php require("Bottom.php"); ?> 
```

简单的。

现在我如何使用`require()`而不是`include()`. require 函数更严格，基本保证包含的文件存在。我认为应用程序明显中断比静默失败要好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:25:02.480

是的，将这样的常见数据提取到单独的文件中是合适的。真正的问题是，既然它在一个单独的文件中，您将如何处理它？

你至少有四个选择。

*   服务器端（基于主机）包含文件
*   php`include`语句
*   php`require`或`require_once`语句
*   制作

服务器端包含通常被认为会损害性能，尤其是在低成本（超卖？）共享网络托管服务器上。还有其他问题。

[php 中的`include`和`require`语句的](http://www.php.net/manual/en/function.include.php)区别主要在于它们如何响应丢失的文件。该`include`语句产生警告；`require`产生致命错误。

make 实用程序不太常用，但它非常有用。使用 make，您可以将任何文件包含在另一个文件中，当具有静态内容有意义时生成具有静态内容的输出，并且当具有动态内容有意义时生成具有动态内容的输出。

对于您正在谈论的信息，您可以使用 make 来生成样式表和 javascript 引用是静态的文件（因此不会影响性能），并且具有单个源文件的所有可维护性。正确构建的 makefile 保证对样式表/javascript 文件的任何更改都将合并到下一个构建中。

其他文本实用程序可以做一些相同的事情，尤其是当您*只*谈论文件包含时。（例如，m4。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T14:40:42.907

将您的片段保存到单独的文件中，然后包含（）它们。

是的，这是一个很好的做法，但更好的是使用一些不错的模板系统。[从Nette Framework](http://doc.nette.org/en/templating)看 Latte 模板系统

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T14:41:15.760

当然这是很好的做法。把它放在一个单独的 PHP 脚本中，即 head.php 然后包含在所有其他页面中

```
<?php include('head.php'); ?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-07T14:43:58.087

直接回答你的问题。

是的！这是一个很好的做法。

一个好的程序员不会在每一页都重新编码（这是导致 CLASS 发明的必要条件之一）。所以。继续！:)

# php - Curl：如何传递包含百分号的密码

> ID：12320219
> 
> 赞同：2
> 
> 时间：2012-09-07T14:36:29.417
> 
> 标签：php, curl, telnet

我没有使用 PHP，而是另一种语言。仅供参考。但是，我将 PHP 作为标签包含在内，以防万一有人有解决方案...

目前，我首先尝试获取正确的字符串（通过 curl 从远程服务器下载文件到本地域）。无论如何，密码包含一个百分号 (%)。当我这样做时，我在命令行上收到以下错误：

```
curl: (67) Access denied: 530 
```

67 是 curl 的错误代码（另请参见[http://curl.haxx.se/docs/manpage.html](http://curl.haxx.se/docs/manpage.html)），表示“用户名、密码或类似信息未被接受，并且 curl 无法登录。”

现在说原始字符串是这样的：

```
curl -u Login:Pass%Word 
```

我尝试了以下在网上找到的解决方案：

```
curl -u Login:Pass%25Word
curl -u Login:Pass%%Word
curl -u Login:Pass^%Word
curl -u Login:Pass^%%Word 
```

但是..我总是拒绝访问。

有人可以帮帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T17:03:43.130

我刚刚重播了您的案例：进行了用户测试 / some%password 并保护了我的网站。

这两个命令有效： `curl -u 'test:some%password'` `curl -u test:some%password`

您似乎只是使用了错误的密码或拼写错误的服务器名称

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T14:52:05.497

你试过用ASCII码吗？

```
curl -u Login:Pass%25Word 
```

[资源](http://curl.haxx.se/mail/archive-2007-10/0150.html)

# git - 在预提交挂钩中测试将要提交的内容

> ID：12320220
> 
> 赞同：16
> 
> 时间：2012-09-07T14:36:35.027
> 
> 标签：git, githooks, pre-commit-hook, pre-commit, git-index

挂钩运行时`pre-commit`，存储库可能不干净。因此，如果您天真地运行您的测试，它们将不会与您正在提交的内容相冲突，而是与您的工作树中发生的任何事情相冲突。

显而易见的事情是`git stash --keep-index --include-untracked`在开头`pre-commit`和`git pop`结尾处。这样您就可以针对（纯）索引进行测试，这正是我们想要的。

`git add --patch`不幸的是，如果您使用（特别是如果您编辑大块），这会生成合并冲突标记，因为`stash@{0}`提交后的内容可能与工作树不匹配。

另一种常见的解决方案是克隆存储库并在新的临时存储库中运行测试。这样做有两个问题：

1.  我们还没有提交，所以我们不能轻易地获得我们将要提交的状态的存储库的副本；和
2.  我的测试可能对当前工作目录的位置很敏感，例如由于本地环境配置。

`git stash --keep-index --include-untracked`如何在不引入合并冲突标记且不修改 post-commit 的情况下将我的工作树恢复到它之前的任何状态`HEAD`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-04-02T14:12:57.373

[git write-tree](https://www.kernel.org/pub/software/scm/git/docs/git-write-tree.html)`pre-commit`在钩子中很有用。它将一棵树写入索引的 repo（如果提交完成，该树将被重用。）

将树写入 repo 后，您可以使用`git archive | tar -x`将树写入临时目录。

例如：

```
#!/bin/bash

TMPDIR=$(mktemp -d)
TREE=$(git write-tree)
git archive $TREE | tar -x -C $TMPDIR

# Run tests in $TMPDIR

RESULT=$?
rm -rf "$TMPDIR"
exit $RESULT 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-29T12:11:32.407

如果您负担得起使用临时目录（即制作当前结帐的完整副本），您可以使用临时目录，如下所示：

```
tmpdir=$(mktemp -d) # Or put it wherever you like
git archive HEAD | tar -xf - -C "$tmpdir"
git diff --staged | patch -p1 -d "$tmpdir"
cd "$tmpdir"
... 
```

这基本上是 William Pursell 的解决方案，但利用`git archive`它使代码更简单，我希望会更快。

或者，通过首先 cd'ing：

```
cd somewhere
git -C path/to/repo archive HEAD | tar -xf -
git -C path/to/repo diff --staged | patch -p1
... 
```

`git -C`需要 Git 1.8.5。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-08T23:28:43.417

如果克隆整个 repo 过于昂贵，也许您只需要工作目录的副本。制作副本比尝试处理冲突更简单。例如：

```
#!/bin/sh -e

trap 'rm -rf $TMPD' 0
mkdir ${TMPD=$PWD/.tmpdir}
git ls-tree -r HEAD | while read mod type sha name; do
    if test "$type" = blob; then
        mkdir -p $TMPD/$( dirname "$name" ) 
        git show $sha > $TMPD/"$name";
        chmod $mod $TMPD/"$name"
    fi
done
cd $TMPD
git diff --cached HEAD | patch
# Run tests here 
```

这将转储树的状态，就像在 $TMPD 中提交之后一样，因此您可以在那里运行测试。您应该以一种比这里更安全的方式获得一个临时目录，但是为了使最终的 diff 工作（或简化脚本和更早的 cd），它必须是工作目录的子目录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-05-10T17:26:42.550

我发现以下内容很有用：

`## bash declare -a files readarray -t files < <(git status --porcelain | perl -ane 'print $F[1],qq(\n) if m/^[ACM] /') # declare -a delfiles readarray -t delfiles < <(git status --porcelain | perl -ane 'print $F[1],qq(\n) if m/^D /') # declare -a huhfiles readarray -t huhfiles < <(git status --porcelain | perl -ane 'print $F[1],qq(\n) if m/^\? /')`

调用 3 次可能效率低下`git status`，但此代码比调用一次、存储在内存中并循环结果要简单。而且我不认为将结果放入临时文件并从磁盘读取三遍会更快。也许。我不知道。这是第一关。随意批评。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-09-14T15:32:25.000

我终于找到了我正在寻找的解决方案。仅检查提交之前的索引状态，并且它使索引和工作树与提交之前完全相同。

如果您发现任何问题或更好的方法，请回复，无论是作为评论还是您自己的答案。

**这假设没有其他东西会在运行时尝试存储或以其他方式修改 git 存储库或工作树。这没有任何保证，可能是错误的，并将您的代码扔到风中。谨慎使用。**

```
# pre-commit.sh
REPO_PATH=$PWD
git stash save -q --keep-index --include-untracked # (stash@{1})
git stash save -q                                  # (stash@{0})

# Our state at this point:
# * clean worktree
# * stash@{0} contains what is to be committed
# * stash@{1} contains everything, including dirt

# Now reintroduce the changes to be committed so that they can be tested
git stash apply stash@{0} -q

git_unstash() {
    G="git --work-tree \"$REPO_PATH\" --git-dir \"$REPO_PATH/.git\"" 
    eval "$G" reset -q --hard             # Clean worktree again
    eval "$G" stash pop -q stash@{1}      # Put worktree to original dirty state
    eval "$G" reset -q stash@{0} .        # Restore index, ready for commit
    eval "$G" stash drop -q stash@{0}     # Clean up final remaining stash
}
trap git_unstash EXIT

... tests against what is being committed go here ... 
```

# php - Symfony2 Forms：从实体字段中检索数据

> ID：12320223
> 
> 赞同：0
> 
> 时间：2012-09-07T14:36:48.380
> 
> 标签：php, symfony

我觉得我在这里遗漏了一些明显的东西，我有一个实体表单字段，它提供了一个可供选择的用户列表，这里的想法是创建一个项目并将其与那个（或多个）用户相关联。我没有太多问题就实现了这一点，但我不知道如何访问和使用该表单字段。

这是我设置表单字段的方式：

```
->add('user', 'entity', array(
'class' => 'DevUserBundle:User',
'label'  => 'Assigned Users: ',
'multiple'=> true,)) 
```

在控制器中，我执行以下操作：

```
$data = $form->getData(); 
```

我可以访问该字段，`$data['user']`但除此之外我迷路了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T06:18:58.330

要查看选择了哪个用户，合成器与您建议的类似：

```
$usersSelected = $form["user"]->getData(); 
```

## 编辑

你的`print_r($userSelected)`语句中有这么长的列表的原因是因为`$userSelected`是一个`User`对象数组。确实，正如您在构建器中看到的那样：`->add('user', 'entity'...)`

您可以通过这种方式验证这一点

```
$i = 1;
foreach ($usersSelected as $user)
{
    echo "User number ".$i;
    echo get_class($user);
    //Assuming that you have the method getUsername() in you User entity
    echo "Username is".$user->getUsername();
    $i++;
} 
```

# sql-server - 使用未登录的 SQL 用户时拒绝访问 SQL Server（通过 Excel VBA）

> ID：12320224
> 
> 赞同：1
> 
> 时间：2012-09-07T14:36:48.053
> 
> 标签：sql-server, sql-server-2008

我在使用 SQL Server 登录时遇到了一些问题。我正在构建一个 Excel 电子表格，它将从 SQL Server (2008) 检索数据，然后以所需的任何方式显示它等等......

我已经设置了一个没有登录“genericReadOnly”和“genericReadWrite”的 SQL 用户，然后我打算使用 environ("username") 捕获 Windows 登录，然后检索允许该人访问的报告。这在我和我的团队工作时工作正常，但我们已经在 SQL Server 上设置为“Windows 用户”。

我现在已将文件发送给未列为 Windows 用户的人，但它失败并显示`ACCESS DENIED FOR DOMAIN\USERNAME`，即使连接字符串使用 genericReadOnly SQL 用户名。

任何想法，因为我无法为需要访问的每个人添加特定的用户名。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T02:14:14.297

我建议创建一个域组并将该组作为 Windows 登录添加到具有适当权限的 SQL 实例。

然后添加需要使用您的 Excel 文件的任何人，只需成为该组的成员，并且不需要更改您的代码或 SQL 设置。

# android - 为什么我在下面给定的代码中得到 SAXException

> ID：12320228
> 
> 赞同：0
> 
> 时间：2012-09-07T14:36:54.847
> 
> 标签：android

为什么我在下面给出的代码中得到 SAXException。XML 文件处理程序和 logcat 如下所示。处理程序是否有任何问题。这个错误是因为下面显示的 XML。

回复：

```
1    
2   <xml version="1.0">
3   <xml>
4   <opcode>
5       <tsip>65.99.254.23:3939</tsip> | 
6       <ssip>207.210.233.180:5060</ssip> |
7       <brand>iVoip Dialer</brand> |
8       <balance>http://207.210.233.180:8888/cdr/get_balance.php?pin=</balance> |
9       <rates>www.democall.com/ratelink</rates> |
10      <domain>www.sabavoip.com</domain> |
11      <operator>0786</operator> |
12      <active>Active</active>
13  </opcode>
14  </xml>
15
16 
```

代码：

```
try {
            HttpClient client = new DefaultHttpClient();
            HttpGet method= new HttpGet();
            method.setURI(new URI(AppConstatnt.OPCODE_URL+code));

            HttpResponse response=client.execute(method);           
            HttpEntity entity=response.getEntity();         
            InputStream stream=entity.getContent();

            Log.e("b4 execute in login","aditya");

            SAXParserFactory spf = SAXParserFactory.newInstance(); 
            SAXParser sp = spf.newSAXParser(); 
            XMLReader xr = sp.getXMLReader(); 
            OPCodeHandler myopcodeHandler = new OPCodeHandler();
            xr.setContentHandler(myopcodeHandler); 

            xr.parse(new InputSource(stream)); 
            objsitelist = myopcodeHandler.getSiteList();
        } catch (ClientProtocolException e) {
            e.printStackTrace();
        } catch (IllegalStateException e) {
            e.printStackTrace();
        } catch (URISyntaxException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        } catch (ParserConfigurationException e) {
            e.printStackTrace();
        } catch (SAXException e) {
            e.printStackTrace();
        } 
```

处理程序：

```
public class OPCodeHandler extends DefaultHandler {

    boolean currentElement = false;
    String currentValue = "";
    SitesList siteobject;

    public SitesList getSiteList() {
        return siteobject;
    }

    public void setSiteList(SitesList objsite) {
        siteobject = objsite;
    }

    @Override
    public void startElement(String uri, String localName, String qName,
            Attributes attributes) throws SAXException {
        currentElement = true;
        currentValue = "";
        if (localName.equalsIgnoreCase("opcode")) {
            siteobject = new SitesList();
        }
    }

    @Override
    public void characters(char[] ch, int start, int length)
            throws SAXException {

        if (currentElement) {
            currentValue = new String(ch, start, length);
            currentElement = false;
        }
    }

    @Override
    public void endElement(String uri, String localName, String qName)
            throws SAXException {
        currentElement = false;
        if (localName.equalsIgnoreCase("tsip")) {
            siteobject.setTsip(currentValue);
        }
        if (localName.equalsIgnoreCase("ssip")) {
            siteobject.setSsip(currentValue);
        }
        if (localName.equalsIgnoreCase("brand")) {
            siteobject.setBrand(currentValue);
        }
        if (localName.equalsIgnoreCase("balance")) {
            siteobject.setBalance(currentValue);
        }
        if (localName.equalsIgnoreCase("rates")) {
            siteobject.setRates(currentValue);
        }

        if (localName.equalsIgnoreCase("domain")) {
            siteobject.setDomain(currentValue);
        }
        if (localName.equalsIgnoreCase("operator")) {
            siteobject.setOperator(currentValue);
        }
        if (localName.equalsIgnoreCase("active")) {
            siteobject.setActive(currentValue);
        }
        if (localName.equalsIgnoreCase("opcode")) {
            setSiteList(siteobject);
        }

    }

} 
```

日志猫：

```
org.apache.harmony.xml.ExpatParser$ParseException: At line 16, column 0: no element found
org.apache.harmony.xml.ExpatParser.finish(ExpatParser.java:550)
org.apache.harmony.xml.ExpatParser.parseDocument(ExpatParser.java:480)

org.apache.harmony.xml.ExpatReader.parse(ExpatReader.java:318)

org.apache.harmony.xml.ExpatReader.parse(ExpatReader.java:275)

com.ievatech.webservice.AppRequestHandler.opCodeRequest(AppRequestHandler.java:53)

com.sample.test.SampleAppActivity$Communicator.doInBackground(SampleAppActivity.java:131)

com.sample.test.SampleAppActivity$Communicator.doInBackground(SampleAppActivity.java:1)
android.os.AsyncTask$2.call(AsyncTask.java:185)
09-07 19:58:36.439: W/System.err(9731):     
java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:306)
java.util.concurrent.FutureTask.run(FutureTask.java:138)

java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088)
java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)

java.lang.Thread.run(Thread.java:1019) 
```

# grails - Grails：如何根据域 id 类型动态更改脚手架代码中的方法签名？

> ID：12320230
> 
> 赞同：2
> 
> 时间：2012-09-07T14:37:00.087
> 
> 标签：grails, scaffolding

我正在尝试在遗留数据库之上构建一个 grails (2.1.0) 应用程序。它有很多表，我非常想只使用动态脚手架。问题是一些表有一个字符串作为主键，但是 src/templates/scaffolding/Controller.groovy 中的模板代码例如 show 是

```
def show(Long id) {
    def ${propertyName} = ${className}.get(id)
    if (!${propertyName}) {
        flash.message = message(code: 'default.not.found.message', args: [message(code: '${domainClass.propertyName}.label', default: '${className}'), id])
        redirect(action: "list")
        return
    }

    [${propertyName}: ${propertyName}]
} 
```

对于字符串键，这似乎将字符串变为 null，并且 get 失败并出现错误`$Domain not found with id null`。

如果我运行生成控制器并将签名更改为`def show(String id)`，它将按预期工作。

那么，有没有办法在“动态脚手架时间”检查域类并相应地编写方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T15:25:10.057

在控制器模板中，您有一个`domainClass`变量，可让您访问要`GrailsDomainClass`为其生成控制器的表示类，因此您可以执行以下操作（同样适用于`edit`,`update`和`delete`）：

```
def show(${domainClass.identifier.type.name} id) { 
```

应生成`def show(java.lang.Long id)`或`def show(java.lang.String id)`酌情生成。

# browser - 浏览器如何从 HTML 页面检测嵌入的 Web 内容？

> ID：12320239
> 
> 赞同：1
> 
> 时间：2012-09-07T14:37:41.630
> 
> 标签：browser, tags, hyperlink

一旦浏览器获得主 html 页面，它如何知道哪些是嵌入内容应该再次从 Web 服务器请求，哪些只是外部链接？它是否基于标签的类型，例如？

如果是这样，有人可以给我这些标签的参考吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T23:43:57.160

HTML5 规范定义了元素类别“[嵌入式内容](http://www.w3.org/TR/html5/content-models.html#embedded-content-0)”：

> **嵌入内容**是将另一个资源导入到文档中的内容，或来自插入到文档中的另一个词汇表的内容。

它列出了以下元素：

*   `audio`
*   `canvas`
*   `embed`
*   `iframe`
*   `img`
*   `math`
*   `object`
*   `svg`
*   `video`

* * *

`link`像or之类的元素`script`（都在[元数据类别中](http://www.w3.org/TR/html5/content-models.html#metadata-content-0)）也可以引用其他资源，用户代理（浏览器、屏幕阅读器等）可以自由链接到或包含或做任何他们想做的事情。例如，Firefox 或 Chromium 等浏览器将（默认情况下）加载并“应用”链接在`link`元素内的 CSS，其`rel`值为 = `stylesheet`。像 Lynx 或 w3m 这样的浏览器不会这样做。他们只是忽略了那个链接。

* * *

对于`link`，HTML5[声明](http://www.w3.org/TR/html5/the-link-element.html#the-link-element)哪些链接类型“是用于扩充当前文档的资源的链接，通常由用户代理自动处理”：

> `link`可以使用该元素创建两类链接：**指向外部资源**的链接和超链接。[链接类型部分](http://www.w3.org/TR/html5/links.html#linkTypes)定义特定链接类型是外部资源还是超链接。

* * *

也许还可以考虑`style`属性（对于内联 CSS），它可能包括一个`background-image` `url`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T14:47:10.650

是的，标签帮助浏览器识别要加载的资源。下载/检索内容后，浏览器根据响应中的内容类型标头确定如何处理内容。

# sql - 我们可以在 C 程序的 SQL 选择查询中使用动态变量吗？

> ID：12320240
> 
> 赞同：0
> 
> 时间：2012-09-07T14:37:47.367
> 
> 标签：sql, c

我实际上想在 C 程序中执行 SQL 查询，查询中的变量`SELECT`是存储在字符串变量中的值。

例如：

```
void fetch_data(char var[])
{
    char COL1[]=var, COL2[]="Address", COL3[]="Name";
    SELECT COL1, COL2, COL3 FROM TABLE WHERE COL4='some value';
} 
```

如您所见，我希望我的代码灵活，以便我可以根据作为函数`var`参数的变量具有不同的列名`fetch_data`。

请告诉我这在 C 中是否可行。

如果上述方法不可行，我想到了另一种方法：我们是否可以将整个 SQL 语句存储在一个字符串中并执行它，以便我可以根据我在函数中得到的参数值随时修改这个字符串`fetch_data()`？

下面的代码将使我的观点更清楚我想要什么：

```
void fetch_data(char var[])
{
    char COL1[]="Name", COL2[]="Address", COL3[]=var;
    char qry1[]="SELECT ", qry2[]=var, qry3=" COL2, COL3 FROM TABLE WHERE COL4='some value';";
    char str[]=strcat(qry1,qry2);
    char query[]=strcat(str,qry3);
    //now query will be having "select (value of var), COL2, COL3 FROM TABLE WHERE COL4='some value';
} 
```

现在在上面的代码中，我可以执行存储在字符串中的查询`query`吗？

请让我知道这两种方法中的任何一种是否可以工作，或者是否可以通过“C”中的任何其他方法来实现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T14:43:34.677

第二种方法肯定会起作用，你只需要小心你的字符串操作。

实际上，您可以使用以下方法简化它[`snprintf`](http://en.cppreference.com/w/cpp/io/c/fprintf)：

```
snprintf(queryStr, MAX_QUERY_LENGTH,
         "SELECT %s, COL2, COL3 FROM TABLE WHERE COL4='some value';", var); 
```

如果查询需要更加动态，即`'some value'`还需要来自变量，则可以添加额外的格式说明符：

```
snprintf(queryStr, MAX_QUERY_LENGTH,
         "SELECT %s, COL2, COL3 FROM TABLE WHERE COL4='%s';", var, someValue); 
```

一旦你准备好这样的查询，你*如何*使用它取决于你的工具链。你在使用[ODBC](http://en.wikipedia.org/wiki/ODBC#Drivers)吗？如果是这样，那么您可以使用 ODBC 调用来处理您的查询，并使用 ODBC 驱动程序来管理与您的数据库的连接。否则，您使用的是哪个数据库，以及提供给您的 API 是什么？例如，MySQL 提供了一个相当大的[C API](http://dev.mysql.com/doc/refman/5.0/en/c.html)，oracle 提供了一个不同的 API，而 SQL Server 提供了另一个。

至于第一个选项，您需要使用[SQL 预处理器](http://en.wikipedia.org/wiki/Embedded_SQL)在 C 代码中使用原始 SQL 语句之类的东西，语法将取决于您使用的工具。

我还应该补充一点，您不能使用以下语句复制非文字 C 字符串：`char COL1[]=var;`。相反，您需要使用字符串库方法，例如`strncpy`.

# html - HTML5 画布元素样式？

> ID：12320244
> 
> 赞同：1
> 
> 时间：2012-09-07T14:38:09.740
> 
> 标签：html, css, canvas

我想为我在画布上绘制的画布元素（如填充文本等）设置样式。

例如，我希望文本有内部阴影。（我认为它被称为插图！）

有没有办法在画布中设置元素样式..使用CSS3？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T14:46:42.530

没有。
css应用于dom元素，而文档对象模型中不存在“*画布中的元素”。*它们只是简单的图像数据。

但是，您始终可以`setShadow`在画布上下文中使用本机 js 函数。你可以[在这里](http://uupaa-js-spinoff.googlecode.com/svn/trunk/uupaa-excanvas.js/demo/9_1_canvas_shadow_text_direction.html)看到它的实际效果。

# php - 使用 php 检测 JSON 中的重复键

> ID：12320247
> 
> 赞同：3
> 
> 时间：2012-09-07T14:38:28.020
> 
> 标签：php, json, validation, duplicates

我从外部合作伙伴处接收 JSON 字符串并使用 php 5.3.3 对其进行解析

```
$jsonObject = json_decode($jsonString);
json_last_error()... 
```

虽然 json_last_error() 检测到无效的 JSON，但它不会检测到重复的键，如下所示：

```
{
  "first" : "First name",
  "last"  : "Last name",
  "info"  : {
     "phone" : "555-555-555",
     "phone" : "222-222-222"
     }
} 
```

请注意，这两个电话号码使用相同的键并且不在数组中。有没有办法在 php 中检测到这样的重复键？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T14:42:09.880

**不能**有重复的密钥！

这就是**键**的定义——它必须是*唯一的*。

第二个将覆盖第一个，因此**不会**有任何真正的重复键。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-11-21T11:38:31.740

正如@Neal 所说，除非您构建自己的 json 解析器，否则这是不可能的。或者用别人的。

例如，您可以使用[seld/jsonlint](https://packagist.org/packages/seld/jsonlint)。

这是[Composer 从今天开始使用的代码，用于警告重复需求](https://github.com/composer/composer/commit/e87190e3da7758023cbcb7c7f4e63530e3866884)。

```
<?php
$jsonParser = new JsonParser;
try {
    $jsonParser->parse(file_get_contents($localConfig), JsonParser::DETECT_KEY_CONFLICTS);
} catch (\Seld\JsonLint\DuplicateKeyException $e) {
    $details = $e->getDetails();
    $io->writeError('<warning>Key '.$details['key'].' is a duplicate in '.$localConfig.' at line '.$details['line'].'</warning>');
} 
```

# iphone - 格式 nsnumber 为用户定义的货币格式

> ID：12320248
> 
> 赞同：0
> 
> 时间：2012-09-07T14:38:33.763
> 
> 标签：iphone, ios, nsnumberformatter

我需要根据一些数据和用户选项格式化一个 NSNumber。首先用户需要选择分组分隔符（“，”或“.”或无），如果分组分隔符是“，”，那么小数分隔符将是“。” ，反之亦然...该数字是一种与其国际货币代码一起存储的货币（USD代表美元，EUR代表欧元等）...如果货币有符号，则应将其放在数字前面，如果并不是说代码会取代它。

所以 1234.50 应该看起来像 $1,234.50 -- 如果货币是 USD 并且分组分隔符是 "," $ 1.234,50 -- 如果分隔符设置为 "." 如果货币代码是 RON（它没有货币符号），则为 RON 1,234.50 ...我了解 NSNumberFormatter 依赖于 iPhone 的设置 ...这可能不是这里的情况，因为用户可以更改应用程序内的格式。 ..有什么好主意怎么做？

我试过了

```
- (NSString *)getFormatedNumber:(NSNumber *)number withCurrency:(NSString *)currencyAbrev andMode:(NSUInteger)mode
{

    NSNumberFormatter *formater = [[NSNumberFormatter alloc] init];

    [formater setCurrencyCode:currencyAbrev];

    if (mode == 1) {
        [formater setGroupingSize:3];
        [formater setGroupingSeparator:@","];
    }else {
        [formater setGroupingSeparator:@"."];
        [formater setGroupingSize:3];
    }

    return [formater stringFromNumber:number];
} 
```

这些是电话

```
 self.label1.text = [[PSCurrencyDisplay sharedInstance] getFormatedNumber:[NSNumber numberWithDouble:12345.67f] withCurrency:@"USD" andMode:1];
    self.label2.text = [[PSCurrencyDisplay sharedInstance] getFormatedNumber:[NSNumber numberWithDouble:12345.67f] withCurrency:@"EUR" andMode:2]; 
```

结果是……相当糟糕……

# php - 在添加进一步的限制语句 CodeIgniter 之前计算行数？

> ID：12320249
> 
> 赞同：9
> 
> 时间：2012-09-07T14:38:38.367
> 
> 标签：php, database, codeigniter

我遇到了一个问题...

我有一堆这样的地方陈述......

```
$this->db->where('Pool', "1");
$this->db->where('Bedrooms >=', "3"); 
```

然后是一个限制语句

```
$this->db->limit($limit, $offset); 
```

最后是我的 get 声明

```
$query = $this->db->get('table-name'); 
```

**我的问题是我需要在我的限制语句之前计算结果，以获得没有限制的总行数..所以我尝试了这个..**

```
$this->db->where('Pool', "1");
$this->db->where('Bedrooms >=', "3");

$num_rows = $this->db->count_all_results();

$this->db->limit($limit, $offset);
$query = $this->db->get('table-name'); 
```

这可以用 where 语句计算我的行数。但是，get 语句现在获取记录，而之前的 where 语句没有工作。

它是不可见的，但是有大量的代码处理更多的 where 语句，并在 url 中抓取东西，所以我不想为了解决这个问题而执行两次数据检索......

干杯!

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-07-10T04:29:19.740

我知道这是一个老问题，但我只是遇到了这个问题并想出了一个不同的解决方案。

这个想法是在限制和偏移之前获取 db 类的副本。

```
$this->db->where('Pool', "1");
$this->db->where('Bedrooms >=', "3");

//here we use the clone command to create a shallow copy of the object
$tempdb = clone $this->db;
//now we run the count method on this copy
$num_rows = $tempdb->from('table-name')->count_all_results();

$this->db->limit($limit, $offset);
$query = $this->db->get('table-name'); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2018-01-18T12:41:44.300

我知道这是一个老问题，但我找到了一个非常简单的解决方案。

```
//do your select, from and where
$this->db->select('your selects');
$this->db->from('your table');

$this->db->where('your where');

//get the filtered rows count
//the trick is the first empty parameter and second false parameter
$filtered_count = $this->db->count_all_results('', false);

//limit your results and get the rows
$this->db->limit($length, $start);
$results = $this->db->get()->result_array(); 
```

希望它可以帮助某人

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-07T22:14:57.753

```
$get_data = $this->your_model->get_data();
$data     = $get_data['data'];
$count    = $get_data['count']; 
```

模型

```
function get_data($limit = 10, $offset= 0)
{
    $table = 'table-name';
    $where = array('Pool' => 1, 'Beedrooms >=' 3);

    $return['data']  = $this->db->from($table)->where($where)->limit($limit, $offset)->get();
    $return['count'] = $this->db->from($table)->where($where)->count_all_results();

    return $return;
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-05-14T07:32:33.350

```
 $this->db->select('*');
    $this->db->from('users');
    $this->db->where('active',$status);

    //open1 here we copy $this->db in to tempdb and apply 
    //count_all_results() function on to this tempdb
    $tempdb = clone $this->db;
    $num_results= $tempdb->count_all_results();   

    // now applying limit and will get actual result 
    $this->db->limit(10);

    $this->db->get();
    $query = $this->db->last_query();
    $res = $this->db->query($query);        

    $data_array = array('num_results' => $num_results, 'results' => $res->result() );
    return $data_array; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-08T18:52:58.883

很明显，您需要使用两个不同的查询。最好使用单个查询尽快完成此操作，但由于您需要在第二个查询之前获取所有记录，因此我们需要使用两个查询。

但是，您可以根据与 MySQL 一起使用的引擎优化第一个查询。如果您使用 InnoDB，那么您应该使用`SELECT COUNT(*) FROM <table-name>`因为总行大小缓存在 InnoDB 中。

我相信`count_all_rows`用于`count(*)`性能，您应该直接使用它进行排序。

使用 MyISAM，您可以使用`COUNT(<column-name>)`.

因此，您的模型类中有一个计数函数，它返回表的计数，然后您可以调用该函数从数据库中插入/更新/获取数据。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-08-22T05:31:04.193

你可以使用`SQL_CALC_FOUND_ROWS`mysql

```
SELECT SQL_CALC_FOUND_ROWS * FROM table1
WHERE
  cond1, cond2, ..., condN
LIMIT 10 
```

选择 FOUND_ROWS();

这是使用 mysql，你可能需要检查如何使用它 codeignitor 方式。

参考：

[https://dev.mysql.com/doc/refman/5.7/en/information-functions.html#function_found-rows](https://dev.mysql.com/doc/refman/5.7/en/information-functions.html#function_found-rows)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-11-17T16:27:19.803

我知道这个问题很老，但我遇到了同样的问题并且得到了比这里显示的更简单的解决方案。无需构建查询两次，也无需克隆`db class`. 添加部件后，只需计算结果而不休息查询生成器`where`，然后添加`limit`并执行查询。

```
$this->db->where('Pool', 1);
$this->db->where('Beedrooms >=' 3);
$count = $this->db->count_all_results('table-name', false); // No reset query builder
$this->db->limit($limit, $offset)
$result = $this->db->get(); 
```

您将有两个变量： `$count`结果数和`$result`结果。

# ruby-on-rails - 使用 json 响应时出现 406 错误

> ID：12320259
> 
> 赞同：10
> 
> 时间：2012-09-07T14:39:01.673
> 
> 标签：ruby-on-rails, ruby-on-rails-3, json, batman.js

我正在尝试通过 batman-rails gem 使用 node.js 框架 batman.js 运行 rails 应用程序。

当我在 Rails 控制器中使用 json 响应时，每次都会收到 406 错误，我不知道为什么。这是我的控制器：

```
 respond_to :json

  def index
    respond_with Sample.all
  end 
```

无论如何，这给了我一个 406。我不认为这与蝙蝠侠有关，而是与轨道本身有关。但为了更好的衡量，这是我的蝙蝠侠代码：

```
 index: (params) ->
    TopNavTemplate.Sample.load (err) -> throw err if err
    @set 'samples', TopNavTemplate.Sample.get('all') 
```

然后我的 index.html.erb 文件只写了“索引”，它还没有真正对蝙蝠侠做任何事情。

有很多 406 JSON 相关的问题，我还没有真正能够将它们应用于我的情况。我做错了什么让rails respond_with JSON？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-09-07T17:26:53.590

好吧，我做了一个非常简单的应用程序来检查你的情况：

SamplesController.rb

```
class SamplesController < ApplicationController
  respond_to :json

  def show
    respond_with Sample.find(params[:id])
  end

  def index
    respond_with Sample.all
  end
end 
```

当我访问`/samples.json`and`samples/1.json`时，它按预期工作。但是，当我转到`/samples`and `/samples/1`（没有 .json 扩展名）时，我收到了 406 错误。

为了使 URL 在没有 .json 扩展名的情况下工作，您需要`config/routes.rb`按如下方式修改您的文件：

```
resources :samples, defaults: {format: :json} 
```

否则，Rails 应用程序将尝试使用 HTML 响应来响应请求。

# iphone - NSTimer 不会更改图像

> ID：12320263
> 
> 赞同：0
> 
> 时间：2012-09-07T14:39:21.127
> 
> 标签：iphone, xcode, ipad

这是我的代码

```
- (void)updateCounterImage:(NSTimer *)theTimer
{
    static int count = 0;
    count += 1;
    int crb = 6 - count;
    UIImage *image = [UIImage imageNamed:[NSString stringWithFormat:@"ipad_game_timer_digit-%d.png", crb]];

    if ( count == 6)
        [timer release];

    [countTime setImage:image];
}

// Implement viewDidLoad to do additional setup after loading the view, typically from a nib.
- (void)viewDidLoad
{
    [super viewDidLoad];
    correctLevel.hidden = YES;
    incorrectLevel.hidden = YES;
    incorrectAnswer.hidden = YES;
    correctAnswer.hidden = YES;
    timer = [NSTimer scheduledTimerWithTimeInterval:1.0f
                                     target:self
                                   selector:@selector(updateCounterImage:)
                                   userInfo:nil
                                    repeats:NO];

}

#import <UIKit/UIKit.h>

@interface GameController : UIViewController
{

    IBOutlet UIImageView *countTime;
    NSTimer *timer;
}

@end 
```

问题是我的 imageView 没有改变它的图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T14:48:34.483

您已设置`repeats`为`NO`，`scheduledTimerWithTimeInterval`这意味着计时器只会滴答一次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T14:51:34.097

你应该写

```
timer = [NSTimer scheduledTimerWithTimeInterval:1.0f
                                 target:self
                               selector:@selector(updateCounterImage:)
                               userInfo:nil
                                repeats:YES]; 
```

# itextsharp - 如何使用 iTextsharp 更改 PDF 中第二页的边距？

> ID：12320267
> 
> 赞同：4
> 
> 时间：2012-09-07T14:39:31.473
> 
> 标签：itextsharp

有没有办法使用 iTextSharp 更改 PDF 中第二页的页边距？

我现在有：

```
Document document = new Document(PageSize.A4, 144f, 72f, 144f, 90f);

PdfWriter.GetInstance(document, ms);

/* first page content */

document.NewPage();
document.SetMargins(72f, 72f, 72f, 100f);

/* second page content */ 
```

但是，第二页上的边距是为第一页设置的边距。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-07T15:54:00.957

切换两行：

```
document.SetMargins(72f, 72f, 72f, 100f);
document.NewPage(); 
```

如文档所述，NewPage() 函数执行大量初始化，其中包括设置边距。因此，您需要在触发新页面之前而不是之后更改边距。

# file - 如何从 Windows 命令行设置键盘快捷键？

> ID：12320268
> 
> 赞同：0
> 
> 时间：2012-09-07T14:39:37.430
> 
> 标签：file, batch-file, keyboard, shortcut, assign

我想创建一个批处理文件来分配键盘快捷键。

例如，如何使用`Alt`+键启动 Internet Explorer `5`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T14:55:16.407

使用 NirCmd
[http://www.nirsoft.net/utils/nircmd.html](http://www.nirsoft.net/utils/nircmd.html)
您可以创建文件快捷方式，并为这些文件指定一个热键 shotrcut

在这里查看 NirCmd 的帮助：http:
[//www.nirsoft.net/utils/nircmd2.html#using](http://www.nirsoft.net/utils/nircmd2.html#using)

```
shortcut [filename] [folder] [shortcut title] {arguments} {icon file} {icon resource number} {ShowCmd} {Start In Folder} {Hot Key}
Creates a shortcut to a file.
The parameters:

    [filename]: Create a shortcut to this filename.
    [folder]: Specify the destination folder that inside it the shortcut will be created. You can specify any valid folder, including the special variables that represent system folders, like ~$folder.desktop$ (Desktop folder), ~$folder.programs$ (Start-Menu-Programs folder), and so on...
    [shortcut title]: The text displayed in the shortcut.
    {arguments}: Optional parameter - Additional arguments to execute the filename.
    {icon file}: Optional parameter - Use this parameter if your want that the shortcut will be displayed with icon other than the default one.
    {icon resource number}: Optional parameter - The resource number inside the icon file.
    {ShowCmd}: Optional parameter - Use this parameter if you want to maximize or minimize the window of the program. Specify "max" to maximize the window or "min" to minimize it.
    {Start In Folder}: Optional parameter - Specifies the "Start In" folder. If you don't specify this parameter, the "Start In" folder is automatically filled with the folder of the program you specify in [filename] parameter.
    {Hot Key}: Optional parameter - Specifies an hot-key that will activate the shortcut. For example: Alt+Ctrl+A, Alt+Shift+F8, Alt+Ctrl+Shift+Y 

Examples:
shortcut "f:\winnt\system32\calc.exe" "~$folder.desktop$" "Windows Calculator"
shortcut "f:\winnt\system32\calc.exe" "~$folder.programs$\Calculators" "Windows Calculator"
shortcut "f:\Program Files\KaZaA\Kazaa.exe" "c:\temp\MyShortcuts" "Kazaa"
shortcut "f:\Program Files" "c:\temp\MyShortcuts" "Program Files Folder" "" "f:\winnt\system32\shell32.dll" 45
shortcut "f:\Program Files" "c:\temp\MyShortcuts" "Program Files Folder" "" "" "" "max" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T18:45:15.817

1) 创建 Internet Explorer 的快捷方式，并将其放在桌面上。
2) 右键单击​​快捷方式，然后单击`Properties`
3) 单击 旁边的框`Keyboard Shortcut`。
4) 按`ALT`+ `5` (方框会显示`CTRL`+ `ALT`+ `5`)
5) 点击 ->`OK`

将快捷方式保留在桌面或开始菜单* 上很重要，否则它将不起作用。
AFAIK，您**必须**使用此方法创建一个`CTRL`++`ALT`快捷`?`方式。

***已编辑**以包括 Andriy M 关于`Start Menu`.

# jstl - 无法使用 JSTL 检索会话/请求范围值

> ID：12320271
> 
> 赞同：1
> 
> 时间：2012-09-07T14:39:49.850
> 
> 标签：jstl

在我的 xhtml 页面中，我在一些`myValue`变量中设置值。代码如下，

```
<body>
<c:set var="myValue" value="someValue" scope="request"></c:set>`
</body> 
```

我从这个 xhtml 页面点击 login.jsp（登录页面）并尝试在我的 login.jsp 上打印值，如下所示，

```
myValue ID retrieved from request <c:out value="${param.myValue}" /> 
```

这不是打印`someValue`。我还通过将其放入会话范围进行检查，如下所示，

```
<c:set var="myValue" value="someValue" scope="session"></c:set> 
```

即使这样也行不通

在 login.jsp 中，

```
myValue ID retrieved from session <c:out value="${sessionScope.myValue}" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T09:45:09.743

您应该只有 ${myValue}，因为 param.myValue 意味着从 URL 参数中查找值。

# python - 通过 selenium 输入 tinymce 时遇到问题

> ID：12320273
> 
> 赞同：1
> 
> 时间：2012-09-07T14:39:51.113
> 
> 标签：python, selenium, tinymce

在 selenium 中，我试图将文本输入到 tinymce 文本区域，但我无法选择文本区域来输入文本。有没有办法选择tinymce后面的文本区域，或者无论如何选择tinymce，这样我就可以输入文本了。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-04T19:15:24.980

使用命令：runScript
目标：tinyMCE.get('text_area_id').setContent('Your text here')

或者您可以使用 tinyMCE.activeEditor.setContent('Your text here') 它将选择第一个或最后一个 mceEditor，我忘了..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T08:43:02.540

您可以使用

```
tinymce.get('your_editor_id').focus(); 
```

如果您的页面上有一个编辑器，您也可以使用

```
tinymce.editors[0].focus(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-23T04:01:51.653

```
 driver.execute_script("tinymce.get('{0}').focus()".format('id_of_textarea'))
    driver.execute_script("tinyMCE.activeEditor.setContent('{0}')".format('your text here')) 
```

它对我有用（不记得我在哪里看到的）

# objective-c - 通过菜单项显示的窗口设置不正确？

> ID：12320274
> 
> 赞同：0
> 
> 时间：2012-09-07T14:39:56.463
> 
> 标签：objective-c, macos, cocoa

在玩了一段时间的 iOS 之后，我正在开发我的第一个本地 Mac 应用程序。

我试图从菜单项启动一个窗口，但我怀疑我做错了。我连接到这个新窗口上的任何`IBAction`按钮都会返回错误。

这就是我正在做的事情。从一个菜单项我启动这个：

```
-(IBAction)displaySAInput:(id)sender{

NSLog(@"Input selected.");
inputSAViewController = [[NSWindowController alloc] initWithWindowNibName:@"InputViewController"];
[inputSAViewController showWindow:self]; 
```

这将启动该类`InputViewController`所拥有的 nib `InputViewController`。我将`InputViewController`类设置为继承自`NSWindowController`.

在`InputViewController.m`我已经测试过`IBAction`，例如：

```
-(IBAction)testButton:(id)sender{

NSLog(@"Data recalled?");

} 
```

我`IBAction`通过 Interface Builder 将它连接到一个按钮。一切看起来都很好。

当我构建并打开`InputViewController`窗口时，我在控制台中收到此错误，然后单击任何内容：

```
Could not connect the action testButton: to target of class NSWindowController 
```

我进行了广泛的搜索，但我的无知使我无法连接这些点。[这个基于与 NSApplication 类似错误的](https://stackoverflow.com/questions/6741564/could-not-connect-the-action-to-target-of-class-nsapplication)线程看起来很有希望，但我不太明白我需要什么才能使与`NSWindowController`错误相关的连接发生。

这应该很简单。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:01:13.073

你的代码：

```
-(IBAction)displaySAInput:(id)sender{
    NSLog(@"Input selected.");
    inputSAViewController = [[NSWindowController alloc]
                  initWithWindowNibName:@"InputViewController"];
    [inputSAViewController showWindow:self];
} 
```

请注意，您正在分配/初始化 的通用实例`NSWindowController`，而不是您实现该`testButton:`方法的自定义子类。我假设您可能希望将其更改为：

```
-(IBAction)displaySAInput:(id)sender{
    NSLog(@"Input selected.");
    inputSAViewController = [[InputViewController alloc]
                  initWithWindowNibName:@"InputViewController"];
    [inputSAViewController showWindow:self];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T14:49:58.287

只需事先加载 NSWindow 并使其不可见，当调用 IBAction 时，只需执行以下操作：

```
[myWindow setIsVisible:YES];
[myWindow setLevel:NSFloatingWindowLevel]; 
```

耶！

# powershell - 如何将 Invoke-Expression 的输出通过管道传输到字符串？

> ID：12320275
> 
> 赞同：11
> 
> 时间：2012-09-07T14:39:57.710
> 
> 标签：powershell

在 Powershell 脚本中，我是这样的：

```
Invoke-Expression "& `"C:\Scripts\psftp.exe`" ftp.blah.com" 
```

我想将它的所有输出、错误等通过管道传输到字符串`$output`

我怎样才能做到这一点？我最后也试过`>`了，`$output = ...`但似乎都没有发现错误和排序。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-07T14:52:36.423

试试这个：

```
$output = Invoke-Expression "C:\Scripts\psftp.exe ftp.blah.com 2>&1" 
```

调用运算符的使用`&`是不必要的，因为在这种情况下引用 exe 路径，因为路径不包含空格。如果路径包含空格，则需要引用它，然后您必须使用调用运算符。也就是说，我不确定为什么`Invoke-Expression`在这种情况下你需要使用。鉴于您的示例，以下内容同样适用。

```
$output = C:\Scripts\psftp.exe ftp.blah.com 2>&1 
```

# visual-studio-2010 - 使用 bonjour sdk 检测新服务

> ID：12320276
> 
> 赞同：1
> 
> 时间：2012-09-07T14:40:01.237
> 
> 标签：visual-studio-2010, sdk, mfc, bonjour

我已经在 Visual C++ 对话应用程序中成功实现了 bonjour sdk。应用程序浏览所有服务并将它们显示在“树”中，但我想知道 bonjour sdk 中是否有一种方法来检测是否添加了新服务然后刷新内容。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T11:11:42.493

假设您使用的是 Apple 提供的适用于 Windows 的 Bonjour SDK，这实际上是自动处理的。

仔细看浏览服务的方法：[DNSServiceBrowser](https://developer.apple.com/library/mac/#documentation/Networking/Reference/DNSServiceDiscovery_CRef/Reference/reference.html#//apple_ref/doc/c_ref/DNSServiceBrowse)。它有一个回调参数，当找到新服务时将调用该参数。只要确保在需要时调用[DNSProcessResults](https://developer.apple.com/library/mac/#documentation/Networking/Reference/DNSServiceDiscovery_CRef/Reference/reference.html#//apple_ref/doc/c_ref/DNSServiceProcessResult)。您可以阻止此调用，也可以使用 Poll/Select 来检测文件描述符何时有数据要读取。

# path - ClearCase 发出两个指向同一资源的文件

> ID：12320283
> 
> 赞同：1
> 
> 时间：2012-09-07T14:40:09.910
> 
> 标签：path, duplicates, clearcase

我们在给定的 ClearCase 视图中有多个项目。不知何故，我们现在有一些文件指向两个不同项目中的相同资源。

我们有一个`JavaTestProject`作为示例项目放在 ClearCase 中的。

该代码被用作创建新项目的模型：`JavaLiveProject`.

对于几段同名的代码，ClearCase 已经指向了同名`JavaTestProject`的`JavaLiveProject`文件。

使用 ClearCase Explorer，查看路径`JavaTestProject/MyJavaProgram.java`看起来像是属于`JavaTestProject`.
但是，如果您使用 Properties of`Element`选项，则完整路径指向`JavaLiveProject/MyJavaProgram.java`.

如果您签出并编辑任一项目中的文件，您实际上是在编辑`JavaLiveProject/myJavaProgram.java`.

我们不确定这是如何发生的（我们在 ClearCase Explorer 中看不到任何符号链接）。
但是，我们想让它`JavaTestProject/myJavaProgram.java`不影响`JavaLiveProject/MyJavaProgram.java`.

在其他情况下，代码具有相同的名称（`MySampleProgram.java`例如），但没有发生这种情况。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T14:55:24.183

解决这种情况的最简单方法是将 GUI 放在一边，然后查看命令行界面返回的内容：

在 DOS 会话中，转到您的（我认为是快照）视图并键入：

```
 cleartool ls 
```

如果有符号链接（不应该是因为您没有通过 GUI 看到它，但我只是在那里查看），它将显示为：

```
JavaTestProject/MyJavaProgram.java --> C:\path\to\JavaLiveProject/MyJavaProgram.java 
```

如果没有，请检查是否有某种基于操作系统的符号链接（如[Junction](http://technet.microsoft.com/en-us/sysinternals/bb896768.aspx)）

`JavaTestProject/MyJavaProgram.java`" " 和 " "的 cleartool descr -l`JavaLiveProject/MyJavaProgram.java`也可以帮助解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T14:05:44.780

在使用 ClearCase 支持（内部，非官方）后，无法确定文件指向同一资源的原因。但是，从 中删除文件`JavaTestProject`似乎已经解决了问题（它没有删除 中的文件`JavaLiveProject`）。

在从 ClearClase 删除文件之前，我确实制作了备份副本，以防万一。

# c# - 从字典中删除项目的有效方法

> ID：12320289
> 
> 赞同：2
> 
> 时间：2012-09-07T14:40:27.340
> 
> 标签：c#, linq, linq-to-objects

我有两个字典 dict1 和 dict2，我想使用它的键从 dict1 中删除 dict2 中存在的项目。不是遍历dict2并使用“ContainsKey”方法，而是有任何其他方法，例如使用linq。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-07T14:47:15.727

执行此操作的适当方法是：

```
foreach(var key in dic2.Keys)
{
    dic1.Remove(key);
} 
```

LINQ 代表语言集成***查询***。它用于对数据执行**查询**。查询不会改变底层结构。由于您想要做的是改变其中一个查询 LINQ 不是一个合适的工具。

另请注意，它`Remove`返回一个布尔值，指示它是否实际删除了密钥。它不会抛出异常。您不需要`ContainsKey`在调用 remove 之前调用（这将为您节省每个项目的额外表查找）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T14:46:53.887

Linq 也在使用循环。Linq 可以帮助您找到要删除的内容。

```
foreach (var kv in dict2.Where(kv => dict1.ContainsKey(kv.Key))) 
    dict1.Remove(kv.Key); 
```

这应该是有效的，因为它使用[`ContainsKey`](http://msdn.microsoft.com/en-us/library/kw5aaea4)which is a O(1) operation, for every `KeyValuePair`in the second `Dictionary`。

[http://msdn.microsoft.com/en-us/library/kabs04ac.aspx](http://msdn.microsoft.com/en-us/library/kabs04ac.aspx)

**编辑**：当然，Servy 的方法通常更好，因为`Dictionary.Remove`即使给定的密钥不存在，您也可以使用。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-09-07T15:02:17.153

正如其他人所提到的，linq 是否是这项工作的正确工具是值得商榷的。但是，如果它必须是 linq，我相信这是适当的解决方案：

```
var dict1 = new Dictionary<int,double>();
var dict2 = new Dictionary<int,double>();

dict1 = dict1.Where(kv => !dict2.ContainsKey(kv.Key))
             .ToDictionary(kv => kv.Key, kv=>kv.Value); 
```

这不会从现有字典中删除键，而是生成一个仅包含所需键的新字典。

如果必须删除大部分键，这实际上可能会更快。

ps ![在此处输入图像描述](../Images/a2cd470d3123fb7d3c2d4aeb1ea065ef.png)

# jquery - 菜单链接在 iPad 上无法正常工作

> ID：12320297
> 
> 赞同：1
> 
> 时间：2012-09-07T14:40:55.303
> 
> 标签：jquery, html, css, ipad, menu

我在这个网站上有一个“坚持顶部”菜单：

[http://www.platform5.ch/~kda/](http://www.platform5.ch/~kda/)

它在桌面浏览器上就像一个魅力，但在我的 iPad 上，我意识到菜单链接并不总是有效。有时我需要稍微滚动一下页面才能使其正常工作。

任何人都可以帮助解决这个问题吗？

![截屏](../Images/75265e28f94a87bbfbf12e4d520b28fa.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T13:40:59.937

我发现这是 iOS 中的一个已知错误。元素`position:fixed`不能很好地处理“点击”和“触摸”事件。

事实上，他们不会在页面“编程”滚动后检测到这些事件。只有在“手动”滚动之后，这些元素才会对点击和触摸做出反应（即使是来自用户的 1px 滚动）。

我最终放弃了`position:fixed`，我使用一些 JS 根据窗口的 scrollTop 属性以编程方式重新定位菜单。

# java - 我应该如何阅读直到 \0/null 与套接字？

> ID：12320301
> 
> 赞同：0
> 
> 时间：2012-09-07T14:41:07.190
> 
> 标签：java, sockets

我正在尝试从套接字读取，直到达到“\0”（空）。这是 Flash 使用的终止符。在 C(++) 中，我也遇到了这个问题。

```
while ((inputLine = in.readLine()) != null) {   
    outputLine = kkp.processInput(inputLine);
    out.println(outputLine);
    if (outputLine.equals("Bye."))
    break;
} 
```

Oracle Java 文档中的这个示例代码在我的情况下不起作用，因为“readLine”只会计算 \r\n 等。我不知道如何读入缓冲区，我对如何做有一些想法，但我不确定如何实现。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T14:57:17.927

您可以使用[DataInputStream](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/DataInputStream.html)对象从套接字读取单个字节。

```
DataInputStream inStream = new DataInputStream(socket.getInputStream());

byte next = inStream.readByte(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:04:19.120

你可以做

```
InputStream in = socket.getInputStream();

for(int b; ((b = in.read()) > 0;) {
   // do something with b.
}
// stops at end of file or b == 0. 
```

# ms-access - Access 2010 查询截断备注字段

> ID：12320302
> 
> 赞同：1
> 
> 时间：2012-09-07T14:41:14.000
> 
> 标签：ms-access, truncate, memo

我在报告中用于数据选择的访问中有以下查询。除了截断 What_happened 字段外，它可以工作。

sql 数据库将 what_happened 字段作为 nvarchar(max) - 访问 2010 将其视为备注字段。

我需要能够在报告表单上看到 what_happened 字段的全部内容

谢谢，

史蒂夫

```
SELECT DISTINCT dbo_all_clients_view.people_id,
                dbo_all_clients_view.full_name,
                dbo_event_log_shack.actual_date,
                dbo_all_clients_view.is_active_client,
                [dbo_all_clients_view query].policy_num,
                dbo_event_log_shack.event_log_id,
                dbo_all_clients_view.dob,
                dbo_event_log_shack.eventtime1,
                dbo_event_log_shack.is_deleted,
                dbo_event_log_shack.staff_name,
                dbo_event_log_shack.staff_supervisor,
                cir_descrip_staff_resp.what_happened
FROM   cir_descrip_staff_resp
       RIGHT JOIN ((dbo_all_clients_view
                    LEFT JOIN dbo_event_log_shack
                           ON dbo_all_clients_view.people_id =
                              dbo_event_log_shack.people_id)
                   LEFT JOIN [dbo_all_clients_view query]
                          ON dbo_all_clients_view.id_no =
[dbo_all_clients_view query].dbo_all_clients_view_id_no)
ON cir_descrip_staff_resp.[event id] = dbo_event_log_shack.event_log_id
WHERE  (( ( dbo_event_log_shack.is_deleted ) = false ))
ORDER  BY dbo_all_clients_view.full_name,
          dbo_event_log_shack.actual_date DESC; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T14:43:09.113

很多事情都会导致备注字段被截断。在报告中，您可以 DlookUp 备忘录或使用其他查询来获取全文。

这里有一个很好的可能原因列表：http: [//allenbrowne.com/ser-63.html](http://allenbrowne.com/ser-63.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-20T18:42:50.480

我一直在寻找这个答案，因为我知道我已经从几年前的帖子中找到了如何解决这个问题。后来我想起了这是我所知道的最令人痛苦的糟糕工作。因为它似乎已经从当前的知识中丢失了，所以我想我会把它放回去。

当您在导出窗口中时，单击高级。它显示了一个字段信息网格。如果将鼠标放在“字段名称”标题上，然后将其向右移动，光标将变为带有 2 个箭头的行，再向右移动，将变为带有空格和 2 个箭头的 2 行。单击并向右拖动，您会魔术般地获得跳过字段，返回字段名称标题，再次执行相同操作，然后魔术索引，重复并魔术宽度，然后是开始和下一次数据类型。啊，数据类型说它将作为短文本字段导出，将其更改为长文本，这就是它导出的内容。如果您使用导入/导出保存的规范来放入您的 vba，您可以类似地公开它将被导出为的数据类型。它适用于旧版本，并且适用于 SQL Server 链接的 odbc 表。一世' 我还刚刚意识到，如果您为不需要的查询选择跳过选项，则可能也不需要这些字段查询。希望这可以帮助某人:)

# magento - Magento 后端产品列表网格

> ID：12320311
> 
> 赞同：1
> 
> 时间：2012-09-07T14:41:38.490
> 
> 标签：magento

有谁知道如何将包含输入类型文本元素或下拉元素的字段添加到 magento 后端产品列表网格？我设法在我的自定义模块后端产品列表网格中添加了一个新列，如下所示：

```
$this->addColumn('blabla', array(
        'header'  => Mage::helper('customer')->__('On Hold?'),
        'width'   => '120',
        'index'   => 'bla',
        'type'    => 'options',
        'options' => array('1' => 'Yes', '0' => 'No')
)); 
```

但是此命令仅将下拉列表添加到我的网格标题中，而我需要将下拉列表显示在该网格上列出的每个产品的左侧（就像当您进入产品编辑页面的后端时出现的复选框一样，您选择相关产品，或追加销售产品）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-04T13:18:31.100

```
 $country = $fieldset->addField('country', 'select', array(
  'name'  => 'country',
  'label'     => 'Country',
  'values'    => Mage::getModel('adminhtml/system_config_source_country') ->toOptionArray()
  )); 
```

试试看！祝你今天过得愉快。谢谢你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:03:45.813

简单快速的解决方案作为下一步研究的技巧 - 重写`Mage_Adminhtml_Block_Catalog_Product_Grid`，功能`_prepareColumns`。示例您将创建您的块`Module_Name_Block_Sample`：

```
class Module_Name_Block_Sample extends Mage_Adminhtml_Block_Catalog_Product_Grid
{
    protected function _prepareColumns()
    {
        $this->addColumn('blabla', array(
            'header' => Mage::helper('customer')->__('On Hold?'),
            'width' => '120',
            'index' => 'bla',
            'type' => 'options',
            'options' => array('1' => 'Yes', '0' => 'No')
        ));

        return parent::_prepareColumns();
    }
} 
```

你会得到它作为第一个字段。它可能需要重写_prepareCollection。

但这可能不是更好的解决方案，我知道。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T16:27:05.523

您需要的是一个自定义渲染器，您可以在其中显示任何您想要的 HTML。像这样的东西：

```
$this->addColumn('blabla', array(
    'header'  => Mage::helper('customer')->__('On Hold?'),
    'width'   => '120',
    'index'   => 'bla',
    'renderer' => 'module/sample_grid_renderer'
)); 
```

然后创建渲染器类，在其中创建所需的 HTML：

```
class Module_Name_Block_Sample_Grid_Renderer 
    extends Mage_Adminhtml_Block_Widget_Grid_Column_Renderer_Abstract
{
    public function render(Varien_Object $row)
    {
        $html = '<select name="row'.$row->getId().'"></select>';
        return $html;
    } 
} 
```

# python - 如何区分类的实例和普通数据类型 int/bool/float/etc

> ID：12320312
> 
> 赞同：0
> 
> 时间：2012-09-07T14:41:40.780
> 
> 标签：python, python-2.7

在 python 中，我试图通过一个对象 wo（用户定义）进行集成，而 wo.obj 是另一个用户定义的对象，我如何判断它是一个类的实例而不是普通数据类型？

```
type(wo.obj)
<class '__main__.test'>

type(wo.obj) is types.InstanceType
False

type(wo.obj) is types.ClassType
False 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T14:48:54.243

要检查实例是否在特定类中，您可以使用 isinstance：

```
mc = MyClass()
isinstance(mc, MyClass) # True 
```

.

注意：对于子类它是 True ，还有一些其他的怪癖，看到[这个](https://stackoverflow.com/a/1549814/1240268)对类似问题的回答。

如果您只是检查`type`，您将看到`<type 'instance'>`无论它是哪个“用户定义”类的实例，结果都是如此。

```
type(notmc).__name__ == 'instance' #True 
```

*我怀疑这应该带有某种形式的健康警告，因为检查该类是否为实例类型似乎不是一项非常密集的检查。*

# javascript - 在 Android 网络应用中查找 SD 卡的路径

> ID：12320313
> 
> 赞同：2
> 
> 时间：2012-09-07T14:41:42.890
> 
> 标签：javascript, cordova, android-sdcard

我正在使用 Cordova（AKA Phonegap）开发一个 Android“浏览器内”应用程序，在设备本身上运行。我在我的模拟器中读取/写入文件到 SD 卡没有问题，但在我看来，我不能依赖它在现实世界中安装在 /sdcard 上，特别是因为一位朋友指出某些设备实际上可能有不止一个。

在四处寻找之后，我可以看到很多关于如何在 Java 中开发应用程序时找到 SD 卡路径的答案，但没有提到如何在我的 Javascript 中做同样的事情。我想知道是否有人能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:26:06.707

如果您尝试使用 PhoneGap 保存照片，则应使用以下属性：

```
destinationType : Camera.DestinationType.FILE_URI, saveToPhotoAlbum: true 
```

该路径下保存的图片：/mnt/sdcard/DCIM/camera

完整的代码如下所示：

```
 navigator.camera.getPicture(onPhotoURISuccess, onFail, { quality: 50, 
    destinationType: destinationType.FILE_URI,
    sourceType: source }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:12:29.747

这就是你使用的原因：

```
window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, onSuccess, onError); 
```

您在 onSuccess 回调中获得的文件系统对象将具有一个根属性，它是一个 DirectoryEntry，在大多数情况下，它指向 Android 上的 /sdcard 目录。此方法调用 Java 代码来确定正确的外部存储目录，它应该对您来说是一致的。

# maven - 一次使用不同的分类器构建多个工件

> ID：12320322
> 
> 赞同：14
> 
> 时间：2012-09-07T14:42:11.907
> 
> 标签：maven, maven-3

W 希望我的 maven 项目一次生成三个具有不同分类器的工件。我知道我可以用模块等来生成它。这实际上是一个资源项目，我想为 DEV、STAGE 和 PROD 环境生成配置。

我想要的是运行`mvn:install`一次并拥有`my.group:resources:1.0:dev`,`my.group:resources:1.0:stage`并`my.group:resources:1.0:prod`在我的仓库中。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-07T15:45:28.950

如果您指定多个插件执行和[资源过滤](http://maven.apache.org/guides/getting-started/index.html#How_do_I_filter_resource_files)，则无需配置文件即可完成此操作。

为每个版本（例如 prod.properties、dev.properties）创建一个属性文件，`${basedir}/src/main/filters`为每个环境保存适当的值。

为您的资源启用过滤：

```
<resources>
  <resource>
    <directory>src/main/resources</directory>
    <filtering>true</filtering>
  </resource>
</resources> 
```

现在添加资源插件执行。注意不同的过滤器文件和输出目录。

```
<plugin>
  <groupId>org.apache.maven.plugins</groupId>
  <artifactId>maven-resources-plugin</artifactId>
  <executions>
    <execution>
      <id>default-resources</id>
      <phase>process-resources</phase>
      <goals>
        <goal>resources</goal>
      </goals>
      <configuration>
        <outputDirectory>${project.build.outputDirectory}/dev</outputDirectory>
        <filters>
          <filter>${basedir}/src/main/filters/dev.properties</filter>
        </filters>
      </configuration>
    </execution>
    <execution>
      <id>prod</id>
      <phase>process-resources</phase>
      <goals>
        <goal>resources</goal>
      </goals>
      <configuration>
        <outputDirectory>${project.build.outputDirectory}/prod</outputDirectory>
        <filters>
          <filter>${basedir}/src/main/filters/prod.properties</filter>
        </filters>
      </configuration>
    </execution>
  </executions>
</plugin> 
```

最后是jar插件；注意分类器和输入目录：

```
<plugin>
  <groupId>org.apache.maven.plugins</groupId>
  <artifactId>maven-jar-plugin</artifactId>
  <executions>
    <execution>
      <id>default-jar</id>
      <phase>package</phase>
      <goals>
        <goal>jar</goal>
      </goals>
      <configuration>
        <classifier>dev</classifier>
        <classesDirectory>${project.build.outputDirectory}/dev</classesDirectory>
      </configuration>
    </execution>
    <execution>
      <id>jar-prod</id>
      <phase>package</phase>
      <goals>
        <goal>jar</goal>
      </goals>
      <configuration>
        <classifier>prod</classifier>
        <classesDirectory>${project.build.outputDirectory}/prod</classesDirectory>
      </configuration>
    </execution>
  </executions>
</plugin> 
```

运行`mvn clean install`应该在工件中生成正确过滤的资源，`dev`并带有`prod`您想要的分类器。

在示例中，我使用了 dev 版本的执行`default-resources`ID `default-jar`。如果没有这个，您在构建时也会得到一个未分类的 jar 工件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-04T01:55:40.743

仅供参考 - 将版本号放在那里以确保您拥有支持自定义过滤器的版本。例如，在 maven 3 中，我像这样设置我的。没有版本就不行。

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-resources-plugin</artifactId>
    <version>2.6</version>
    ...
</plugin> 
```

# c# - LoadLibrary 并定义对 C DLL 的回调（函数指针）

> ID：12320323
> 
> 赞同：2
> 
> 时间：2012-09-07T14:42:15.543
> 
> 标签：c#

我在 DLL 中有这样的代码：

```
int (*callback)(int a, int b);
void mainfunc()
{
    callback(1, 2);
    callback(3, 4);
} 
```

为了从 C 程序访问这个 DLL，我曾经这样做：

```
#include <windows.h>

int callback(int a, int b) {return a+b;}

int main()
{
    HANDLE dll = LoadLibrary("test.dll");
    *(void**)GetProcAddress(dll, "callback") = (void*)callback;
    ((void(*))GetProcAddress(dll, "mainfunc"))();
    FreeLibrary(dll);
} 
```

DLL 仍然是 C 代码，但主程序已切换到 C#。如何处理函数指针？该代码在 C# 中的表现如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T14:55:43.883

`callback`是 dll 中的全局变量，因此您不能 [1] 从 c# 中设置它。

您也不应该从 C 中设置它。如果真的共享回调，您应该拥有的是一个像`SetCallback( MyCallbackType callback )`设置它的函数。

但很可能，您想将该函数传递给 mainfunc。

无论哪种情况，这在 C# 中都很容易做到：

```
// C#
public delegate Int32 Callback( Int32 a, Int32 b );
[DllImport("test.dll")]
static extern void mainfunc( Callback callback );
// Or if you're setting the callback globally, 
[DllImport("test.dll")]
static extern void SetCallback(Callback callback);
[DllImport("test.dll")]
static extern void mainfunc(); 
```

带回家的信息是 DllImport 足够聪明，可以将具有相当接近签名的委托转换为 C 函数指针。

[1] 好的，所以你可以...dll 注入有时会使用这些方法中的许多技巧之一，但在任何其他情况下都是错误的方法。

# encoding - 这是什么类型的编码？我听说它是 Bencode，但它看起来不标准

> ID：12320327
> 
> 赞同：4
> 
> 时间：2012-09-07T14:42:29.803
> 
> 标签：encoding, encode

我正在做一个项目，他们在 mysql 数据库的 BLOB 类型列中存储了以下类型的编码数据。我四处询问并被告知这是Bencode，但是，从我在网上看到的情况来看，它似乎不是标准的Bencode。

**Wiki for Bencode**

[http://en.wikipedia.org/wiki/Bencode](http://en.wikipedia.org/wiki/Bencode)

**编码数据示例**

```
a:11:{i:0;a:3:{s:11:"question_id";s:2:"46";s:6:"answer";s:1:"2";s:7:"correct";b:1;}i:1;a:3:{s:11:"question_id";s:2:"45";s:6:"answer";s:1:"2";s:7:"correct";b:0;}i:2;a:3:{s:11:"question_id";s:2:"44";s:6:"answer";s:1:"2";s:7:"correct";b:0;}i:3;a:3:{s:11:"question_id";s:2:"43";s:6:"answer";s:1:"1";s:7:"correct";b:0;}i:4;a:3:{s:11:"question_id";s:2:"42";s:6:"answer";s:1:"3";s:7:"correct";b:0;}i:5;a:3:{s:11:"question_id";s:2:"41";s:6:"answer";s:1:"2";s:7:"correct";b:0;}i:6;a:3:{s:11:"question_id";s:2:"40";s:6:"answer";s:1:"0";s:7:"correct";b:1;}i:7;a:3:{s:11:"question_id";s:2:"39";s:6:"answer";s:1:"0";s:7:"correct";b:0;}i:8;a:3:{s:11:"question_id";s:2:"38";s:6:"answer";s:1:"1";s:7:"correct";b:1;}i:9;a:3:{s:11:"question_id";s:2:"37";s:6:"answer";s:1:"3";s:7:"correct";b:0;}i:10;a:3:{s:11:"question_id";s:2:"36";s:6:"answer";s:1:"2";s:7:"correct";b:1;}} 
```

**到目前为止我注意到的**

我注意到编码使用类似于 Bencode 的字母和整数来描述不同类型的数据。

例子： `s:11:"question_id";`

我假设`s`代表“字符串”，即`11`定义字符串的长度`question_id`。此外，数据 ( ) 的开头似乎`a:11:`描述了一个长度为 11 的数组。虽然这类似于标准 Bencode，但它似乎没有使用 Bencode 使用的标准语法。

有谁知道这是什么类型的编码？这是非标准的 Bencode 格式，还是完全不同的格式？我正在寻找 PHP 或 Python 中的解析器，并且为编码命名肯定会对我的搜索有所帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T16:02:13.380

它是 PHP 序列化格式，使用[`unserialize`](http://php.net/unserialize).
请参阅[http://codepad.org/l7Z9cITo](http://codepad.org/l7Z9cITo)。

# javascript - document.getElementById.style.backgroundImage 不工作

> ID：12320329
> 
> 赞同：3
> 
> 时间：2012-09-07T14:42:35.683
> 
> 标签：javascript, html, css

我想根据页面的地址为 div 分配不同的背景图像，例如，如果我的 url 是[http://www.mywebsite.com/mysubdirectory/](http://www.mywebsite.com/mysubdirectory/)我使用以下代码：

```
if(document.URL.indexOf("mysubdirectory") >= 0){ 
   document.getElementById("wrapper").style.backgroundImage = "url('bg-wrapper.jpg')";
} 
```

但它不起作用。我什至添加了一个伪造的 document.write 命令，只是为了确保其余代码正常，并且确实在我的浏览器中显示了伪造的行。有什么我忽略的吗？

编辑：谢谢大家的回答 - 当我在我的代码中使用 body 而不是 getElementById("wrapper") 时，图像会显示出来，所以我怀疑这是一个与路径相关的问题。我确实向 body 标记添加了 onload 属性，但它仍然无法与 getElementById 一起使用。有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-07T14:47:54.877

您的

```
document.getElementById("wrapper").style.backgroundImage = "url('bg-wrapper.jpg')"; 
```

代码是正确的。

它在这个 jsfiddle 中运行良好：http: [//jsfiddle.net/hUuN5/](http://jsfiddle.net/hUuN5/)

你确定图像是正确的。请记住，文件的路径是相对于当前页面的位置的。不是 css 目录

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-13T23:44:40.967

我正在使用 Chrome 29.0.1547.66，但也没有任何答案有效。

所以我尝试了：

```
document.getElementById("wrapper").style.backgroundImage = "url(http://media.nu.nl/m/m1fz6dwa6h3w.jpg)"; 
```

它可以从图像网址中删除引号。

这里也可以工作：http: [//jsfiddle.net/xEujg/](http://jsfiddle.net/xEujg/)

[html](/questions/tagged/html "显示标记为“html”的问题") [css](/questions/tagged/css "显示标记为“css”的问题") [背景](/questions/tagged/backgroundimage "显示标记为“背景图像”的问题") [图片 javascript](/questions/tagged/javascript "显示标记为“javascript”的问题")

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T14:44:19.943

试试这个，我认为图片网址很可能是错误的。您可能需要某种相对路径：

```
document.getElementById("wrapper").style.backgroundImage = "url('/bg-wrapper.jpg')"; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-07-06T22:28:02.153

在 chrome 中指定协议对我有用。我无法使用 catch all '//' 让它工作。它必须是 'http://' 我假设它必须匹配用于加载页面或 iframe 的任何协议。

例如 element.style.backgroundImage="url( [http://somedomain.com/images/myimage.jpg](http://somedomain.com/images/myimage.jpg) )" 或 element.style.backgroundImage="url(' [http://somedomain.com/images/myimage.jpg](http://somedomain.com/images/myimage.jpg) ')" 为我工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-09-30T00:40:56.100

如果还有人对此感兴趣。这是一个解决方案：

```
document.getElementById("wrapper").style.background = "url(http://media.nu.nl/m/m1fz6dwa6h3w.jpg)"; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-07-21T12:23:06.307

这对我有用：

```
var pointer =  "url(\'/" + imageArray[imageCounter].toString() + "\')";
document.body.style.backgroundImage = pointer 
```

在花了一点时间之后，它是浏览器的引擎解析CSS。控制台中没有好的错误。

# ruby-on-rails-3 - RSpec 控制器测试-“分配”行为异常

> ID：12320332
> 
> 赞同：6
> 
> 时间：2012-09-07T14:42:44.903
> 
> 标签：ruby-on-rails-3, bdd, rspec-rails

我已经为我的用户模型构建了一个控制器规范，它通过了，尽管我觉得它应该失败。规格如下：

```
describe UsersController do
  include Devise::TestHelpers

  let (:user) do
    FactoryGirl.create(:user)
  end
  let (:other_user) do
    FactoryGirl.create(:user)
  end

  before :each do
    @request.env["devise.mapping"] = Devise.mappings[:user]
    sign_in user
  end

  describe "#index" do
    it "can GET 'index'" do
      get :index
      response.should be_success
    end

    it "populates a list of users" do
      get :index
      expect(assigns(:users)).to eq([user])
    end
  end
end 
```

“expect(assigns(:users)).to eq([user])”行通过了，但我觉得它应该失败。毕竟，我在顶部创建了两个用户（user 和 other_user）。我显然误解了发生了什么，所以有人可以解释一下吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-07T14:52:25.153

`let`懒惰；在第一次调用它之前它不会创建用户（此时结果被记忆）。由于您调用`user`but not `other_user`，因此实际上只创建了第一个用户，并且规范通过了。

如果`let!`您想要急切的评估，或者确保您在`other_user`某个地方打电话，请使用。

[RSpec 文档](https://www.relishapp.com/rspec/rspec-core/docs/helper-methods/let-and-let)

# linq - 如何从 linq to Entities 查询中获取列元数据？

> ID：12320335
> 
> 赞同：1
> 
> 时间：2012-09-07T14:42:54.990
> 
> 标签：linq, entity-framework, linq-to-entities

我需要支持旧客户端并从我们的 Linq 查询中组合 ADO 数据集。问题是如何获取使用反射无法获得的特定列信息（varchar 长度、十进制精度等）。

例如，我有表**Customer**字段**名称为 varchar(80)**

当我从 linq 获取数据到实体查询时：

```
var data = (from c in ctx.Customers select c.Name).ToList() 
```

我无法获取`maxSize`该列`data[i].Name`并且 adodataset 引发错误。

我已经有了简单的解决方案：

1.  通过属性引用从 ObjectContext 中提取列元数据的代码
2.  从 Queryable 解析表达式并将输出属性链接到 edm 列的简单代码。

但是我在解析复杂查询时遇到了很多问题，这些查询包括多个嵌套的 groupbys/unions/joins 等。

有没有人知道任何其他方式（可能使用物化整形器或类似方法）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T21:38:54.833

感谢[Joseph Kowalski 的 EFProviderWrappers，](http://code.msdn.microsoft.com/EFProviderWrappers-c0b88f32#content)我制作了类似的提供者并将其发布在[codeplex](http://efmetaprovider.codeplex.com/)

# sql - 如何在 Cognos 中转义 # 字符？

> ID：12320342
> 
> 赞同：2
> 
> 时间：2012-09-07T14:43:20.690
> 
> 标签：sql, cognos, cognos-8

我在 Cognos 8 Framework Manager 中创建了一个传递查询项，它需要 # 字符作为查询的一部分。不幸的是，这被 Cognos 解释为宏的打开。

如何转义查询项中的 #（数字符号/锐号）字符？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-14T21:03:13.700

There does't seem to be any "official" way in the documentation, but this seems to work.

```
#"#"# 
```

`#'#'#` works too, unless it appears in a literal SQL string in your query, so it's safer to use `#"#"#`.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-18T16:23:12.930

一个反斜杠`\`应该分隔它，我知道它分隔方括号`[]`。

# asp.net - 单击提交时输入字段变为空白

> ID：12320344
> 
> 赞同：0
> 
> 时间：2012-09-07T14:43:28.537
> 
> 标签：asp.net, vb.net

这是一个现有的 Visual Studio 2003 项目（用 VB 编写）。有一个输入表单，其中包含许多字段，包括一个`due date`字段。此字段是根据`Reason type`下拉列表中选择的值填充的，它也是可编辑的。最近，我不得不禁用该`due date`字段，以便无法更改填充的值（基于登录的用户）。我面临的问题是，当单击提交按钮时，会打开一个 IE 弹出窗口，并且“到期日期”字段中的值消失并变为空白。

```
 Private Sub btnSubmitOrdersTab_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnSubmitOrdersTab.Click
        If Not Me.txtPRCEmail.Value.Length = 0 Or Not hPRCEmail.Value.Length = 0 Then
                SubmitClick()
        Else
                RegisterStartupScript("PRCEmail", "<script language=javascript>window.open (""" & CType(Application("cBaseURL"), String) & "administration/supervisors/Orders/prc_email_reason.aspx"",null,""height=200,width=400,status=yes,toolbar=no,menubar=no,location=no"");</script>")
        End If
End Sub 
```

我试图在函数`due date`之前使用 获取 的值，但它是空白的。`RegisterStartupScript()``duedatevalue = Me.txtDueDate.Value`

**有什么方法可以防止该`due date`字段变为空白。`due date`如果该字段未禁用，这不是问题。**

这是我从`onload`事件中调用的 Java Script 函数`<body>`以禁用到期日期。

```
function DisableDueDate()
            {
                                    if (udisable == "true")
                    document.getElementById("divduedate").setAttribute('disabled',true);

                else
                    document.getElementById("divduedate").setAttribute('disabled',false);

            } 
```

我使用 disable 的原因是因为到期日期在`<td>`标签中，旁边有一个 gif（不是服务器控件），单击时会弹出一个日历，以便用户选择日期。我希望禁用标签的全部内容 -`<td>`包括 gif。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T14:54:00.983

如果`btnSubmitOrdersTab_Click`您可以将 的值保存`due date`在 a`Session`中，然后在 中，`Page_Load`您可以从 中获取值`Session`并使用它设置`due date`字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T14:51:25.403

如果要在服务器端读取 texbox 的值，请使用**readonly**而不是**禁用文本框。**

```
document.getElementById("divduedate").setAttribute('readonly',true); 
```

或者

```
 document.getElementById("divduedate").readOnly=true 
```

或者

使用 jQuery：

```
 $('#readonly').attr("readonly", true) 
```

**禁用属性将不允许“divduedate”将其值发布到服务器。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T15:00:57.937

不要将该`Enabled`属性设置为 False。相反，请使用该`ReadOnly`属性并将其设置为 true。

# php - PHPMailer不发送附件？

> ID：12320353
> 
> 赞同：0
> 
> 时间：2012-09-07T14:44:04.733
> 
> 标签：php, phpmailer

我正在使用 PHPMailer 以 pdf 格式向客户发送订单收据。PDF 创建工作就像一个梦想，但它只是不会将其附加到邮件中。我尝试过向我的 gmail 和我自己的服务器发送电子邮件，但它不会发送附件。这是我的代码：

```
<?php   
//Lähetä tilausvahvistus
require_once('mail/class.phpmailer.php');
$bodytext = '
Olemme vastaanottaneet tilauksenne '. $ordernumber .'. 
Tilaamanne tuotteet löytyvät liitteestä.'
  ;
$email = new PHPMailer();
$email->From      = 'no-reply@xxx.fi';
$email->FromName  = 'no-reply@xxx.fi';
$email->Subject   = 'Olemme vastaanottaneet tilauksenne ' . $ordernumber;
$email->Body      = $bodytext;
$email->AddAddress('christian.nikkanen@gmail.com');
$email->AddAttachment('kuitit/kuitti777.pdf','kuitti777.pdf');
return $email->Send();
?> 
```

我试过相对路径和直接路径，但不，它不会发送。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:01:13.300

您是否正确验证了您的路径？

尝试使用 $_SERVER['DOCUMENT_ROOT'] 再次写入您的路径

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T14:56:53.430

检查 PHP 是否正确解释了您的文件路径。尝试将 $pathtofile 粘贴在会话中并使用它，而不是静态分配（或将其转储到输出），这样您就可以确保它不是简单的路径问题。

# spring-security - 使用 Spring Security 的预认证/单点登录

> ID：12320357
> 
> 赞同：3
> 
> 时间：2012-09-07T14:44:12.933
> 
> 标签：spring-security, single-sign-on, pre-authentication

我正在开发两个 Web 应用程序，一个是服务器应用程序，另一个是客户端应用程序，两者都使用 Spring Security。我的用例是，在用户登录服务器应用程序后，用户可以从服务器应用程序中的链接访问客户端应用程序。由于用户在单击这些链接时不必再次登录（我的要求的一部分），我决定使用类似于 Single SignOn 的策略，以便将他们的身份验证信息从服务器应用程序转发到客户端应用程序。

在客户端应用程序上，我使用 Spring Security`RequestHeaderAuthenticationFilter`来查找由服务器应用程序设置的自定义请求标头。

1.  如果找到此自定义标头，我是否需要进一步验证此请求是否可信？在[Spring 的 Pre-Authentication doc](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#preauth)中， `RequestHeaderAuthenticationFilter`不执行任何身份验证，并将假定请求来自`SM_USER`属性中指定的用户。如何确保请求是真实的？

2.  如何使用 http 请求中的自定义标头将用户从一个应用程序发送到另一个应用程序？重定向请求不起作用，因为标头信息将丢失。转发不起作用，因为转发的请求没有通过客户端应用程序上配置的 Spring Security 过滤器，因此请求永远不会“经过身份验证”并且不会创建会话。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-11T19:57:53.157

由于我没有收到任何响应，因此我稍微改变了方法以实现相同的 SSO 行为。我在这里回答我自己的问题以结束这个问题。

我没有使用 ，而是对`RequestHeaderAuthenticationFilter`Spring 进行了子类化`AbstractPreAuthenticatedProcessingFilter`，它从 HttpRequest 中检索 Principal 和 Credentials。然后我实现了一个自定义`preAuthenticatedUserDetailsService`，它将在加载 UserDetails 之前使用服务器应用程序验证凭据。

至于 #2，我不再在初始预认证登录请求中使用自定义标头。我只是将主体（用户名）和凭据作为 url 参数附加到客户端应用程序的初始预身份验证“登录”请求。由于两个应用程序之间的通信是通过 SSL 保护的，我认为这应该是安全的。

这是我的安全配置现在的样子：

```
<b:bean id="http403EntryPoint" class="org.springframework.security.web.authentication.Http403ForbiddenEntryPoint" />
<b:bean id="navigatorPreAuthFilter" class="com.example.NavigatorPreAuthenticatedProcessingFilter">
    <b:property name="authenticationManager" ref="authenticationManager" />
</b:bean>

<http auto-config="false" entry-point-ref="http403EntryPoint">

    <custom-filter position="PRE_AUTH_FILTER" ref="navigatorPreAuthFilter" />
    <session-management session-fixation-protection="newSession" />
    <logout logout-success-url="/logout" delete-cookies="JSESSIONID" />

    <intercept-url pattern="/index.jsp" access="ROLE_QUESTIONNAIRE_ASSIGNEE"/>
</http>

<b:bean id="preAuthenticatedUserDetailsService" class="com.example.NavigatorPreAuthenticatedUserDetailsService" />
<b:bean id="preauthAuthProvider" class="org.springframework.security.web.authentication.preauth.PreAuthenticatedAuthenticationProvider">
    <b:property name="preAuthenticatedUserDetailsService" ref="preAuthenticatedUserDetailsService" />
</b:bean>

<authentication-manager alias="authenticationManager">
    <authentication-provider ref="preauthAuthProvider"/>
</authentication-manager> 
```

# c++ - NetBeans - C++ 构建当前项目

> ID：12320358
> 
> 赞同：0
> 
> 时间：2012-09-07T14:44:14.693
> 
> 标签：c++, netbeans

当您在 NetBeans 上工作时，有一个已定义的主项目。每当您按下项目正在执行的构建或运行按钮时。

我想知道是否有办法构建我正在查看的当前项目。所以说我在项目之间跳转并点击运行按钮，它将运行的项目将是我当前编辑视图中的项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T14:47:00.573

在最新版本的 Netbeans 中，目前是 7.2，没有主项目之类的东西。点击 F11 或图标将自动构建您正在查看的文件的项目。

# html - HTML中的奇怪间距

> ID：12320362
> 
> 赞同：2
> 
> 时间：2012-09-07T14:44:34.740
> 
> 标签：html, css, webpage, spacing

我在开发[网站](http://universal-office.com.ua)时遇到了奇怪的问题。

我计算机上的任何浏览器都会在页面的某些元素上方添加间距（例如，导航栏上方、导航栏中的下拉菜单、容器等）。在 Chrome 开发者工具中，它显示为有一个奇怪的`text`元素（带空格的引号）： ![1](../Images/ec97149a26cfd988d8918c0f6c2d8358.png)

但在源代码中它没有它显示： ![2](../Images/3ad0c571d9cf1fcc96aee0a4628c35ff.png)

如果我从工具中删除引号，间距就会消失。

Javascript或PHP无法添加引号（间距）：它存在于我们评论所有脚本包含并禁用`.html`文件的php预处理（[示例](http://www.universal-office.com.ua/index_noscript.html)）。CSS 无法添加此间距：例如，对于导航栏，我们有规则：

```
.navbar {
  margin-top: 0;
} 
```

我计算机上的所有浏览器中都存在间距（在 Firefox、Chrome、IE 9 中测试）。

此外，Firefox 开发工具不显示任何引号： ![3](../Images/6d4ef6c952baa54d2810b2d849954184.png)

但在 Chrome 开发工具中引号的地方添加了代码间距。

那么，它是什么？如何删除这个间距（我不想使用像负边距这样的丑陋解决方案）？

请评论您的机器上是否有此问题？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T14:58:26.660

在我看来，这些空间就像`&nbsp;`一个“特殊空间”。它们可能看起来像一个普通的空格字符，即使在文本编辑器中也是如此

查看生成 HTML 结构的代码。然后删除请求中的空格。使用空格键放回格式化空格。

* * *

编辑

在我的文本编辑器中仔细观察，我意识到，你的代码中有一个特殊的变音字符。

当您从 Notepad++ 编辑器查看我的屏幕时，在小于字符 ( `<`)`<nav>`和`<li>`我标记为红色的标记处有小“钩子”。

不要只删除空格，还要删除小于号 ( `<`) 并使用键盘重新键入。

![在此处输入图像描述](../Images/e476ae82635d99a359e0bdcd9bb1e610.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T15:27:52.083

`<body>`和元素之间的字符`<nav>`是换行符和 BOM - 字节顺序标记（又名零宽度不间断空格）U+FEFF（UTF-8 中的 EF BB BF）。见下图取自 Hex 编辑器 Neo

![在此处输入图像描述](../Images/0b211255e3df0707e595efd4eee37dc2.png)

这是您需要删除的 BOM。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T14:46:57.260

您的源 HTML 中有空格：在`<body>`和之间`<nav>`。让它消失的唯一方法是将两个标签一起运行，如

```
<body><nav class="..."> ... </nav></body> 
```

HTML 规定，属性值之外的空格被视为一个空格，因此有多少空格，是否是换行符等并不重要。即使您的 HTML 中有一个空格字符，符合标准的浏览器必须将其视为文本节点。Chrome 通过显示引号来暗示这些文本节点。

# iphone - 将 iphone 应用程序转换为通用应用程序时重复的体系结构符号

> ID：12320367
> 
> 赞同：0
> 
> 时间：2012-09-07T14:45:01.057
> 
> 标签：iphone, xcode, ipad, ios5, ios-simulator

在将 iphone 应用程序转换为 ipad 应用程序时，我创建了一个新文件并将其命名为 ipad 作为前缀，这是我的 AppDelegate.m 包括的。所有代码都相同，但类名不同。

```
#import "AppDelegate.h"
#import "ViewController.h"
#import "SearchViewController.h"
#import "LoginViewController.h"
#import "SettingsViewController.h"
#import "ipadSearchViewController.h"
#import "ipadLoginViewController.h"
#import "ipadSettingsViewController.h" 
```

在尝试构建项目时，这是错误：

```
ld: 13 duplicate symbols for architecture i386
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

但是没有重复的变量，我为 iphone 和 ipod 使用了不同的变量名。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T16:19:55.697

用这么少的代码很难回答......我建议进入构建阶段并手动确保每个资源只在“复制捆绑资源”下出现一次

# javascript - 如何在具有清单版本 2 的 Chrome 扩展中使用选项的 localStorage？

> ID：12320371
> 
> 赞同：3
> 
> 时间：2012-09-07T14:45:08.217
> 
> 标签：javascript, google-chrome-extension, manifest

> **可能重复：**
> [将 chrome 扩展程序从清单 v1 更改为 v2 时出现端口错误](https://stackoverflow.com/questions/11913575/port-error-while-changing-chrome-extension-from-manifest-v1-to-v2)

想要制作我的第一个 Chrome 扩展程序，但是当我开始考虑将`option`页面`localStorage`与`www.example.com/example.html`'s一起使用时，我遇到了麻烦`localStorage`。我已经四处寻找如何在两者之间来回传递消息，这个页面在[Message Passing](http://developer.chrome.com/extensions/messaging.html)上，但似乎我需要设置 eventListener，并使用`SendRequest`s in `background.html`which is not allowed in `manifest : 2`：

```
There were warnings when trying to install this extension:
'background_page' requires manifest version of 1 or lower. 
```

编辑：您需要对`manifest` [此处所见](http://developer.chrome.com/extensions/manifestVersion.html)的进行更改，以使用 `bac

[消息传递](http://developer.chrome.com/extensions/messaging.html#connect)页面讨论了创建端口，但不清楚将侦听器放置在哪里。如果我将前半部分放入`content.js`脚本中，然后将另一半放入脚本中，`options.js`监听器仅在打开时才处于活动状态`options.html`。

所以我的问题是：如何传递我选择的设置`options.html` 以在我的`contentscript.js`哪个操作当前网页中使用？

* * *

这是我的整个设置：

背景.html

```
 <!doctype html>
<html>
  <head>
    <title>Background Page</title>
    <script src="jquery.min.js"/>
    <script src='background.js'/>

</script>
  </head>
  <body>
  </body>
</html> 
```

背景.js

```
chrome.extension.onRequest.addListener(function(request, sender, sendResponse) {
    if (request.method == "getLocalStorage")
      sendResponse({data: localStorage[request.key]});
    else
      sendResponse({}); // snub them.
}); 
```

内容脚本.js

```
chrome.extension.sendRequest({method: "getLocalStorage", key: "status"}, function(response) {
  console.log(response.data);
}); 
```

manifest.js

```
{
    "manifest_version": 2,

    "name": "Image replacer",
    "version": "1.0",
    "description": "A script to replace all images in the browser with images from any given Imgur gallery",
    "browser_action": {
        "name": "Image replace BA",
        "icons": ["icon.png"],
        "default_icon": "icon.png"
    },

    "background": {
        "page": "background.html"
    },

    "permissions": ["storage"],

    "content_security_policy": "script-src 'self' https://www.imgur.com; object-src 'self'",

    "content_scripts": [{
        "js": ["jquery.min.js", "contentscript.js"],
        "matches": ["http://*/*", "https://*/*"]

    }],
    "options_page": "options.html"
} 
```

# asp.net - 异步任务 _dlgt.EndInvoke(ar) 对象引用未设置为对象的实例

> ID：12320372
> 
> 赞同：1
> 
> 时间：2012-09-07T14:45:09.787
> 
> 标签：asp.net, asynchronous, object-reference, iasyncresult

我正在开发一个需要执行异步任务的应用程序。[我使用了http://msdn.microsoft.com/fr-fr/library/system.web.ui.page.executeregisteredasynctasks.aspx](http://msdn.microsoft.com/fr-fr/library/system.web.ui.page.executeregisteredasynctasks.aspx)给出的代码的两倍

我只需将其复制并粘贴到我的应用程序中。不幸的是，我有一次抛出了一个错误，而另一个却完美无缺。

错误是：

```
Object reference not set to an instance of an object. 
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.NullReferenceException: Object reference not set to an instance of an object.

Source Error: 

Line 46: 
Line 47:             _taskprogress = "Asynchronous task completed."
Line 48:             _dlgt.EndInvoke(ar)
Line 49: 
Line 50:         End Sub

Source File: clsFormAsync.vb    Line: 48 

Stack Trace: 

[NullReferenceException: Object reference not set to an instance of an object.]
   Samples.AspNet.VB.Controls.MyAsyncTask.OnEnd(IAsyncResult ar) in clsFormAsync.vb:48
   System.Web.UI.PageAsyncTask.CompleteTask(Boolean timedOut, Boolean syncTimeoutCaller) +365

[HttpException (0x80004005): Exception of type 'System.Web.HttpException' was thrown.]
   System.Web.UI.Page.ExecuteRegisteredAsyncTasks() +11440805
ViewProtocols.btnRefreshForm_Click(Object sender, EventArgs e) in ViewProtocols.aspx.vb:98
System.EventHandler.Invoke(Object sender, EventArgs e) +0
System.Web.UI.WebControls.Button.RaisePostBackEvent(String eventArgument) +154
System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +3707 
```

我真的不知道如何摆脱这个错误，欢迎帮助。

# documentation - 忽略 doxygen 注释块中的行

> ID：12320377
> 
> 赞同：6
> 
> 时间：2012-09-07T14:45:36.877
> 
> 标签：documentation, comments, fortran, doxygen

是否可以在 doxygen 注释块中包含将被 doxygen 忽略的内容？换句话说，我们可以在 doxygen 评论块中添加评论吗？

**背景：**

我们正在将 Fortran 项目的代码内注释转换为 doxygen 可解析格式，但是该项目要求代码内注释中的内容由*水平线*划定。例如：

```
!> @brief Lorem ipsum dolor sit amet
!! ---------------------------------------------------------------------
!!
!! @param[in] p1  Description of p1
!! @param[in] p2  Description of p2
!! ---------------------------------------------------------------------
!!
!! More content here ....
!! ---------------------------------------------------------------------
!!
!! More content for another section
!! ---------------------------------------------------------------------
subroutine do_something(p1, p2)
  ! .... the code ...
end subroutine do_something 
```

是否有一个命令/语法我可以在这些行前面加上这样 doxygen 会忽略它们？希望一个不引人注目且不影响评论可读性的内容。

我知道[`INPUT_FILTER`](http://www.doxygen.nl/manual/config.html#cfg_input_filter)可以用来链接预处理脚本的设置，但理想的解决方案是不依赖其他脚本/工具的解决方案。

*PS 我很清楚很多人会认为那些水平线是不必要的和/或分散注意力的。但是，这是付款人规定的要求，我无权更改。*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-10T13:43:38.223

Doxygen 支持一些[HTML 命令](http://www.star.bnl.gov/public/comp/sofi/doxygen/htmlcmds.html)，包括 HTML 注释。该解决方案的好处是不需要对 Doxyfile 进行任何修改，并且比`@I{ ---- }`.

```
!> @brief Lorem ipsum dolor sit amet
!! <!----------------------------------------------------------------->
!!
!! @param[in] p1  Description of p1
!! @param[in] p2  Description of p2
!! <!----------------------------------------------------------------->
!!
!! More content here ....
!! <!----------------------------------------------------------------->
!!
!! More content for another section
!! <!----------------------------------------------------------------->
subroutine do_something(p1, p2)
  ! .... the code ...
end subroutine do_something 
```

* * *

^(*作为记录，这是我最终确定的解决方案。但是，我接受了[DRH 的回答](https://stackoverflow.com/questions/12320377/ignoring-lines-within-a-doxygen-comment-block/12328287#12328287)，因为它为“在 doxygen 块中启用评论”提供了更通用的解决方案。*)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-08T05:11:50.887

如果你对水平线使用哪个字符有灵活性，你可以继续重复注释字符，doxygen 会忽略它。就像是：

```
!> @brief Lorem ipsum dolor sit amet
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!
!! @param[in] p1  Description of p1
!! @param[in] p2  Description of p2
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!
!! More content here ....
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!
!! More content for another section
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine do_something(p1, p2)
  ! .... the code ...
end subroutine do_something 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-08T05:29:23.027

您可以利用 Doxygen 的别名语法来忽略该行，但是它将要求该行带有前缀和后缀附加字符。例如，如果您定义了一个别名，例如：

```
ALIASES                = I{1}="" 
```

您可以在评论中使用别名来隐藏 doxygen 的水平中断：

```
!> @brief Lorem ipsum dolor sit amet
!! @I{-----------------------------------------------------------------}
!!
!! @param[in] p1  Description of p1
!! @param[in] p2  Description of p2
!! @I{-----------------------------------------------------------------}
!!
!! More content here ....
!! @I{-----------------------------------------------------------------}
!!
!! More content for another section
!! @I{-----------------------------------------------------------------}
subroutine do_something(p1, p2)
  ! .... the code ...
end subroutine do_something 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-06-11T15:54:02.000

您可以编写一个简单的过滤器来删除这些行。在 perl 中，它可能看起来像这样：

```
while (<>)
{
    if (m/^!! -{3,}/)
    {
        print "!!\n";
    }
    else
    {
        print;
    }
} 
```

然后`INPUT_FILTER`在您的配置中`Doxyfile`引用此脚本：

```
INPUT_FILTER = path/to/my/perl/script 
```

# xampp - 在 Windows 7 上使用 Codesniffer 和 Xampp

> ID：12320384
> 
> 赞同：0
> 
> 时间：2012-09-07T14:45:49.003
> 
> 标签：xampp, codesniffer

我在尝试让代码嗅探器与 Xampp (1.7.1) 一起工作时遇到了问题。我通过编辑 php.ini 中的 include_path 来运行 pear。

当我尝试运行 phpcs 时，出现以下错误：

```
Warning: include_once(PHP/CodeSniffer/CLI.php): failed to open stream: No such file or directory in C:\xampp\php\phpcs on Line 31

Warning: include_once(): Failed opening 'PHP/Codesniffer/CLI.php' for inclusion (include_path="\xampp\php\pear") in C:\xampp\php\phpcs on line 31

Fatal error: Class 'PHP_CodeSniffer_CLI' not found in C:\xampp\php\phpcs on line 34 
```

有人知道这里发生了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T22:06:44.960

PEAR 可能还在 phpcs 可执行文件 (-d include_path="''") 中设置了一个包含路径，它覆盖了默认值。如果您在安装 phpcs 之前忘记创建默认的 php.ini 文件，这尤其令人讨厌。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T22:38:48.387

听起来 PHP 包含路径肯定是错误的，即使 PEAR 本身正在工作。不过这有点奇怪。

你有`\xampp\php\pear\PHP\CodeSniffer\CLI.php`档案吗？如果没有，你能找到它在`\xampp\php\pear`目录下的位置吗？

例如，如果它实际上是在，`\xampp\php\pear\source\pear\PHP\CodeSniffer\CLI.php`那么您需要将您的 include_path 更改为`\xampp\php\pear\source\pear`. 但这可能会破坏您的 PEAR 安装，这可能意味着 PEAR 配置不正确。

如果是这种情况，值得卸载 PHP_CodeSniffer，更改 PEAR 的 php_dir 配置变量的位置，然后重新安装 PHP_CodeSniffer。

例如：

```
pear uninstall php_codesniffer
pear config-set php_dir \xampp\php\pear
pear install php_codesniffer 
```

（抱歉，我不确定 Windows 上的 pear 是否需要路径中的驱动器号，所以只需检查当前值`pear config-get php_dir`并根据该格式调整路径。）

我希望这些信息可以帮助您前进一点。

# mysql - 在 ASP.NET 2.0 中使用 OdbcDataReader 从 MySQL 数据库中嵌套中继器

> ID：12320385
> 
> 赞同：1
> 
> 时间：2012-09-07T14:45:50.027
> 
> 标签：mysql, data-binding, dataset, relational-database, nested-sets

前阵子问过这个问题，一直没反应，后来一直忙着别的事，今天又来了，还是破解不了。

我原来的问题：[https ://stackoverflow.com/questions/11868289/using-a-one-to-many-relationship-to-show-a-category-menu-using-asp-repeaters-vb](https://stackoverflow.com/questions/11868289/using-a-one-to-many-relationship-to-show-a-category-menu-using-asp-repeaters-vb)

[现在，从那时起，我一直试图查看我在尝试遵循这篇文章http://www.codeproject.com/Articles/6140/A-quick-guide-to-using-nested-repeaters-in](http://www.codeproject.com/Articles/6140/A-quick-guide-to-using-nested-repeaters-in-ASP-NET)时做错了什么 [-ASP-NET](http://www.codeproject.com/Articles/6140/A-quick-guide-to-using-nested-repeaters-in-ASP-NET)和各种 Microsfot 教程

我*想*我在填充数据集时遗漏了一步或误解了一些东西......现在早上花了很多时间在圈子里转，我很困惑。

它把我逼到了墙角。

我已经做到了这一点：（顺便说一下，我正在使用 ASP.NET 2.0 和 MySQL 数据库）

```
Sub getCategories() Handles Me.Load

    Dim DBConnection = ConfigurationManager.ConnectionStrings("dbConnNew").ConnectionString
    Dim connection As OdbcConnection = New OdbcConnection(DBConnection)
    Dim connect As New OdbcCommand("SELECT masterCat.name AS masterCat, masterCat.id as mcId, category.id as cId, category.name AS category, category.mapsTo as catMapsTo, subCat.mapsTo as subCatMapsTo, subCat.name AS subCat FROM masterCat INNER JOIN category ON masterCat.id = category.mapsTo INNER JOIN subCat ON category.id = subCat.mapsTo WHERE masterCat.id <> '9' ORDER BY masterCat.priority", connection)

    Dim DS As New DataSet()
    connection.Open()
    Dim read As OdbcDataReader = connect.ExecuteReader(CommandBehavior.CloseConnection)
    DS.Load(read, LoadOption.OverwriteChanges, "masterCat, category, subCat")

    'DS.Relations.Add("mCatid", DS.Tables("masterCat").Columns("mcId"), DS.Tables("category").Columns("cId")) << This Line Breaks

    connection.Close()

    masterCat.DataSource = DS
    masterCat.DataBind()

End Sub

Private Sub CategoryRepeater_ItemDataBound(sender As Object, e As System.Web.UI.WebControls.RepeaterItemEventArgs) Handles masterCat.ItemDataBound
    Dim item As RepeaterItem = e.Item
    If (item.ItemType = ListItemType.Item) OrElse (item.ItemType = ListItemType.AlternatingItem) Then
        Dim catRpt = DirectCast(item.FindControl("catRepeater"), Repeater)
        Dim drv As DataRowView = DirectCast(item.DataItem, DataRowView)
        catRpt.DataSource = drv.CreateChildView("mcId")
        catRpt.DataBind()
    End If
End Sub 
```

和标记：

```
 <ul>
            <asp:Repeater ID="masterCat" runat="server">
                <ItemTemplate>
                    <li>
                        <%# Container.DataItem("masterCat")%>
                        <ul>                            
                            <asp:Repeater ID="catRepeater" runat="server">
                            <ItemTemplate>
                                <li>
                                <%# Container.DataItem("category")%>
                            </li>
                            </ItemTemplate>
                            </asp:Repeater>
                        </ul>
                    </li>
                </ItemTemplate>
            </asp:Repeater>
         </ul> 
```

回顾一下，我正在尝试生成一个包含主类别、类别和子类别的嵌套中继器。上面的代码只进行了两步，我认为第三步一定是重复的。

我的数据排列在三个表中，看起来像这样

`masterCat`

```
id    |    name    | priority (for sorting) 
```

`category`

```
id    |    name    |    mapsTo (this is the ID of the masterCat to which this relates) 
```

`subCat`

```
 id    |    name    | mapsTo (ID of the category to which this relates) 
```

上面的 SQL 查询正确地返回了包含这些列的整个数据：

```
masterCat   - name of the master category
mcId        - ID of the master category
cId         - ID of a category
category    - name of a category
catMapsTo   - the ID of the masterCategory to which category relates
subCat       - subCategory name
subCatMapsTo - the ID of the category to which the subCategory relates 
```

我最终需要的是看起来像的东西（在这个例子中只有两个层次）

*   猫大师
    *   类别
    *   类别
    *   类别

*   猫大师
    *   类别
    *   类别
    *   类别

*   猫大师
    *   类别
    *   类别
    *   类别

    ```
     </li> 
    ```

帮助将不胜感激！

# c++ - C ++包含警卫似乎不起作用？

> ID：12320387
> 
> 赞同：3
> 
> 时间：2012-09-07T14:45:56.750
> 
> 标签：c++, file, header, include, guard

我以前多次使用过 include 守卫，但从未真正理解它们是如何工作的或为什么工作的。

为什么以下不起作用？

```
#ifndef CAMERA_CLASS_HPP
#define CAMERA_CLASS_HPP

class camera_class
{
....
};

camera_class glcam = camera_class();

#endif // CAMERA_CLASS_HPP 
```

错误是这样的：（您可能可以从这个问题的标题中猜到它会是什么！）

```
-------------- Build: Debug in System ---------------

Linking console executable: bin/Debug/System
/usr/bin/ld: error: obj/Debug/main.o: multiple definition of 'glcam'
/usr/bin/ld: obj/Debug/camera_class.o: previous definition here
/usr/bin/ld: error: obj/Debug/main.glfunc.o: multiple definition of 'glcam'
/usr/bin/ld: obj/Debug/camera_class.o: previous definition here
collect2: ld returned 1 exit status
Process terminated with status 1 (0 minutes, 0 seconds)
0 errors, 0 warnings 
```

另外，有人可以向我解释一下为什么头卫有效吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-07T14:48:20.333

标头保护将防止在单个翻译单元中包含多个内容。标头可以（并且正在）包含在多个翻译单元中：

```
// a.cpp:
#include "camera.hpp"

// b.cpp
#include "camera.hpp" 
```

这将产生 a`a.obj`和 a `b.obj`，每个都包含 的定义`glcam`。当链接在一起以产生最终的二进制文件时，您会得到多重定义错误。

您需要在标头中*声明并在文件中只* *定义*一次：`glcam`*`.cpp`*

 *```
// camera.hpp
...

extern camera_class glcam;

// camera.cpp
#include "camera.hpp"

camera_class glcam; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-07T14:47:37.503

**根本原因：标头保护防止在同一个*****[翻译单元](https://stackoverflow.com/questions/1106149/what-is-a-translation-unit-in-c)***
中多次包含相同的标头，但不能跨不同的翻译单元。当您在多个翻译单元中包含相同的头文件时，确实会在包含该头的每个翻译单元中创建 一个副本。 C++ 标准要求每个符号只能***[定义](https://stackoverflow.com/questions/1410563/what-is-the-difference-between-a-definition-and-a-declaration)***一次（***[一个定义规则](http://en.wikipedia.org/wiki/One_Definition_Rule)***），因此链接器会向您发出错误。
`glcam`

**解决方法：**
不要`glcam`在头文件中创建。相反，它应该以只定义一次的方式创建。正确的方法是***[使用关键字`extern`](https://stackoverflow.com/questions/496448/how-to-correctly-use-the-extern-keyword-in-c)***。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-07T14:52:15.210

看起来您想创建一个`glcam`可以在多个地方使用的单个对象。我会通过公开一个免费函数来返回一个`static`实例来做到这一点。这类似于 using `extern`，但我发现它的意图更加明确。

```
#ifndef CAMERA_CLASS_HPP
#define CAMERA_CLASS_HPP

class camera_class
{
....
};

camera_class& get_camera();

#endif // CAMERA_CLASS_HPP

// in the CPP

camera_class& get_camera()
{
   static camera_class the_camera;
   return the_camera;
} 
```

`camera_class`这使您能够在不依赖的情况下使用单个实例`extern`，但同时不会强迫您将其用作单例，因为代码的其他区域也可以自由创建自己的私有实例。

这可以按原样（自由函数）或`static`作为`camera_class`. 根据 Scott Meyers 的一些极好的建议，我选择了前者：

> 如果您正在编写一个可以实现为成员或非朋友非成员的函数，您应该更喜欢将其实现为非成员函数。

资料来源：[http ://www.drdobbs.com/cpp/how-non-member-functions-improve-encapsu/184401197](http://www.drdobbs.com/cpp/how-non-member-functions-improve-encapsu/184401197)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-07T14:48:56.693

由于您从多个文件中包含此文件，因此您违反了[一个定义规则](http://en.wikipedia.org/wiki/One_Definition_Rule)：

> 在整个程序中，一个对象或非内联函数不能有多个定义

您应该将`glcam`定义放在源文件中，而不是放在头文件中，或者将其声明为`extern`，并在某个源文件中提供定义。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-07T14:48:42.917

包含保护可防止标题中文本的多个实例出现在一个编译单元中（即，您正在构建的单个 .cpp 被构建到 .o 中）

它不会阻止该文本的多个实例出现在多个编译单元中。

所以在链接时，每个包含这个头文件的编译单元都有一个

```
 camera_class glcam = camera_class(); 
```

作为一个象征。当提到“glcam”时，C++ 无法决定您指的是哪个单一全局定义。来自 main.o 的那个还是来自 camera_class.o 的那个？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-07T14:49:41.780

它工作得很好，你在每个源文件中只得到一个定义。

问题是您有多个源文件并且链接器正在查找多个定义。

在头文件中，您应该输入：

```
extern camera_class glcam; 
```

然后在一个且只有一个源文件中将您以前在标题中包含的内容：

```
camera_class glcam = camera_class(); 
```

此时您需要注意初始化顺序问题。不要尝试`glcam`从任何静态对象中使用。*

# css - 如何使我的 ul 列表位于 nav 元素的一行中？

> ID：12320388
> 
> 赞同：-3
> 
> 时间：2012-09-07T14:46:00.630
> 
> 标签：css, html

我有以下代码：

```
<nav>

      <ul>
      <li><a href="#">Home</a></li>
      <li><a href="#">About Us</a></li>
      <li><a href="#">News</a></li>
      <li><a href="#">Contact</a></li>

      </ul>   
      <nav> 
```

我需要每个链接水平而不是垂直显示，哪个 css 属性允许我这样做？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T14:48:35.163

就像其他人已经说过的那样。

应用[`float:left`](http://jsfiddle.net/kfYEL/)一个`li`

```
nav ul li{ float:left; }​ 
```

或者[`display: inline;`](http://jsfiddle.net/kfYEL/1/)

```
nav ul li{ display: inline; }​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:06:57.020

这里给你一个演示：

[http://jsfiddle.net/4C8NP/](http://jsfiddle.net/4C8NP/)

```
<nav>
 <ul>
  <li><a href="#">Home</a></li>
  <li><a href="#">About Us</a></li>
  <li><a href="#">News</a></li>
  <li><a href="#">Contact</a></li>
 </ul>   
</nav>

body {
 padding:30px;
}

nav {
 overflow:auto;
}

nav ul > li {
 display:inline;
 margin-right:2px;
}

nav ul > li > a {
 display:inline-block;
 padding:10px 20px;
 background:#ccc;
 border:1px solid #666;
} 
```

# javascript - 修改fancybox html

> ID：12320390
> 
> 赞同：-2
> 
> 时间：2012-09-07T14:46:16.730
> 
> 标签：javascript, jquery, fancybox

是否可以自定义fancybox HTML 代码？
我想移出 .fancybox-outer 之外的下一个和上一个按钮

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T06:58:28.923

为了移出容器的`next`和`previous`按钮`.fancybox-outer`，您只需要添加这些 CSS 规则（在您自己的自定义 CSS 文件中，并且在您加载了 fancybox CSS 文件之后）

```
.fancybox-nav {
    width: 60px;       
}

.fancybox-nav span {
    visibility: visible;
    opacity: 0.5;
}

.fancybox-nav:hover span {
    opacity: 1;
}

.fancybox-next {
    right: -60px;
}

.fancybox-prev {
    left: -60px;
} 
```

​ 你说`you have looked around in the documentation but haven't found anything`，但是上面的内容在fancyapps.com网站上有很好的记录--> [http://fancyapps.com/fancybox/#useful](http://fancyapps.com/fancybox/#useful) check No. 6，demo就在[这个fiddle](http://jsfiddle.net/Xh3B2/)

...但想知道您是否会将其视为正确答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T10:05:14.937

这是我解决它的方法。我以前不知道您可以扩展/替换 jquery 中的方法。但是这种新方法将（使用一些基本的 css）从右侧滑入并从左侧滑出。

它将按钮呈现在 fancybox-outer 元素之外，并占用文档的宽度。它可能可以优化很多。

```
jQuery('ul a').fancybox({
    margin: 0,
    openMethod : 'afterZoomIn',
    nextMethod : 'slideIn',
    nextSpeed : 1000,
    prevMethod : 'slideOut',
    prevSpeed : 1000
});

(function ($, F) {
    var getScalar = function(value, dim) {
        var value_ = parseInt(value, 10);

        if (dim && isPercentage(value)) {
            value_ = F.getViewport()[ dim ] / 100 * value_;
        }

        return Math.ceil(value_);
    },
    getValue = function(value, dim) {
        return getScalar(value, dim) + 'px';
    };

    F.transitions.afterZoomIn = function () {
        var current = F.current;

        if (!current) {
            return;
        }

        F.isOpen = F.isOpened = true;

        F.wrap.addClass('fancybox-opened').css('overflow', 'visible');

        F.reposition();

        // Assign a click event
        if (current.closeClick || current.nextClick) {
            F.inner.css('cursor', 'pointer').bind('click.fb', function(e) {
                if (!$(e.target).is('a') && !$(e.target).parent().is('a')) {
                    F[ current.closeClick ? 'close' : 'next' ]();
                }
            });
        }

        // Create a close button
        if (current.closeBtn) {
            $(current.tpl.closeBtn).appendTo('.fancybox-overlay').bind('click.fb', F.close);
        }

        // Create navigation arrows
        if (current.arrows && F.group.length > 1) {
            if (current.loop || current.index > 0) {
                $(current.tpl.prev).appendTo('.fancybox-overlay').bind('click.fb', F.prev);
            }

            if (current.loop || current.index < F.group.length - 1) {
                $(current.tpl.next).appendTo('.fancybox-overlay').bind('click.fb', F.next);
            }
        }

        F.trigger('afterShow');

        // Stop the slideshow if this is the last item
        if (!current.loop && current.index === current.group.length - 1) {
            F.play( false );

        } else if (F.opts.autoPlay && !F.player.isActive) {
            F.opts.autoPlay = false;

            F.play();
        }
    };

    F.transitions.slideIn = function () {
        var current   = F.current,
            effect    = current.nextEffect,
            startPos  = current.pos,
            endPos    = { opacity : 1 },
            direction = F.direction,
            distance  = $(document).width(),
            field;

        startPos.opacity = 0.1;

        field = 'left';
        if (direction === 'right') {
            startPos[ field ] = getValue(getScalar(startPos[ field ]) - distance);
            endPos[ field ]   = '+=' + distance + 'px';

        } else {
            startPos[ field ] = getValue(getScalar(startPos[ field ]) + distance);
            endPos[ field ]   = '-=' + distance + 'px';
        }

        // Workaround for http://bugs.jquery.com/ticket/12273
        if (effect === 'none') {
            F._afterZoomIn();

        } else {
            F.wrap.css(startPos).animate(endPos, {
                duration : current.nextSpeed,
                easing   : current.nextEasing,
                complete : F._afterZoomIn
            });
        }
    };

    F.transitions.slideOut = function () {
        var previous  = F.previous,
            effect    = previous.prevEffect,
            endPos    = { opacity : 0 },
            direction = F.direction,
            distance  = $(document).width();

        if (effect === 'elastic') {
            endPos[ 'left' ] = ( direction === 'left' ? '-' : '+' ) + '=' + distance + 'px';
        }

        previous.wrap.animate(endPos, {
            duration : effect === 'none' ? 0 : previous.prevSpeed,
            easing   : previous.prevEasing,
            complete : function () {
                // $(this).trigger('onReset').remove();
                previous.wrap.trigger('onReset').remove();
            }
        });
    }

}(jQuery, jQuery.fancybox)); 
```

# asp.net-mvc-3 - Html.CheckBoxFor() 导致验证消息消失

> ID：12320391
> 
> 赞同：0
> 
> 时间：2012-09-07T14:46:22.383
> 
> 标签：asp.net-mvc-3, razor, checkbox, validation

我在 ASP.NET MVC 3 中工作，但遇到了一个奇怪的问题。我设置了一个复选框，因此用户必须检查它以表明他们已阅读披露并继续。如果他们不检查这一点，他们将无法继续。这一切都有效。

如果他们没有选中该框，则根据需要弹出验证消息，并且标签显示为红色。但是，当我选中该框时，标签会随着验证消息一起消失。什么会导致这个？我希望标签保持不变。;) 这是视图中的代码：

```
 @section StepContent
    {

    <div>
        @Html.LabelFor(m => m.ApplicantAgreesToDisclosure)
        @Html.CheckBoxFor(m => m.ApplicantAgreesToDisclosure)
        @Html.ValidationMessageFor(m => m.ApplicantAgreesToDisclosure, "Please indicate that you agree to the disclosure.")
    </div>

    } 
```

模型中的代码：

```
 [DisplayName("I have read and accept the above disclosure")]
    [ESignatureRequiredValidation(ErrorMessage = "Please indicate that you agree to the disclosure.")]
    public bool ApplicantAgreesToDisclosure { get; set; } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T14:16:30.697

事实证明，有一些内联 CSS 导致元素消失。在 Firefox 中使用 FireBug 并单击消失的元素表明我的 CSS 在其他地方被覆盖。这在我的 MVC 代码中不是问题。我已将我的 CSS 标记为“！important”（意味着我的 CSS 部分是“重要的”）作为临时修复，直到找到内联代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T14:53:24.313

这是因为一旦选中该复选框，它就会通过验证。为什么你认为这是一个问题？你期待什么行为？

# python - 柱状图的百分比值？

> ID：12320395
> 
> 赞同：2
> 
> 时间：2012-09-07T14:46:32.153
> 
> 标签：python, algorithm, histogram

我在 python 中创建一个直方图，我希望 bin 边缘是给定值的百分比（5-10%）。解决这个问题的最佳方法是什么，这样我就不会在 bin 边界上留下间隙，也不必为 bin 边界计算预先设置一些值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T17:18:39.713

[通常，使用numpy.histogram](http://docs.scipy.org/doc/numpy/reference/generated/numpy.histogram.html)等预定义工具创建直方图很方便，尽管您新发布的评论（暗示您正在使用 matplotlib）也完全没问题。无论哪种方式，您都可以创建一组自动确定的等宽箱...

```
import numpy
data = [0,1,1,1,1,1,1,2,3,3]
hist, edges = numpy.histogram( data , bins = 10)
>>> hist
array([1, 0, 0, 6, 0, 0, 1, 0, 0, 2])
>>> edges
array([ 0\. ,  0.3,  0.6,  0.9,  1.2,  1.5,  1.8,  2.1,  2.4,  2.7,  3\. ]) 
```

...或者，在您想要预定义箱（可能具有不同宽度）的奇怪情况下，您可以自己指定箱边缘（阅读文档以获取有关其工作原理的信息）：

```
>>> hist, edges = numpy.histogram( data , bins = [0,.5,1., 1.5,2,3])
>>> hist 
array([1, 0, 6, 0, 3])
>>> edges
array([ 0\. ,  0.5,  1\. ,  1.5,  2\. ,  3\. ])
>>> 
```

但是，请注意使用截然不同**的 bin 大小**。在许多情况下，这种粗粒度可能会扭曲您尝试比较的数字之间的关系。

至于你的价值 +/-10% 边界？

```
preferred_bin_centers = [0,1,2,3]
bin_pairs = [ ( 0.9* v , 1.1*v ) for v in preferred_bin_centers ]
>>> [[0.0, 0.0], [0.9, 1.1], [1.8, 2.2], [2.7, 3.3000000000000003]] 
```

或者，展平为 numpy.histogram 可以使用的列表形式...

```
bin_edges = sum( [  [ 0.9* v , 1.1*v ]  for v in values ]    , [] )

>>> [0.0, 0.0, 0.9, 1.1, 1.8, 2.2, 2.7, 3.3000000000000003] 
```

（请注意，从上面列表的前两项中，如果您的 bin 中心之一为 0，则此代码会给出令人困惑的 bin 边缘；我将其仅作为需要注意的示例）

顺便说一句，上面定义的 bin 边缘也会创建超出所需范围的中间 bin。例如，如果您将项目分类在 1,2 和 3 的 +/- 10% 范围内，那么本质上，也会有一个介于 2.2 和 2.7 之间的分类（您所需分类的“外边缘”），其中 2.5 之类的数字会去。如果在所需的 bin 之间存在值，则可能需要相应地调整截止值或可视化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T14:50:18.017

也许我过于简单化了你的问题？

```
def bins(data, nbins):
    range = max(data) - min(data)
    binsize = range / float(nbins)
    bins = [x * binsize for x in range(nbins)] 
```

# c++ - C++11 - 返回表达式以确定类型

> ID：12320399
> 
> 赞同：0
> 
> 时间：2012-09-07T14:46:57.677
> 
> 标签：c++, types, c++11, return, decltype

***当涉及到类型推断*和*管理时，* **C++11**包含大量出色的功能。例如**auto**和**decltype** -keywords 已被证明是该语言的一个有价值的补充。**

 **当我采用这些简单而有效的特性时，我开始考虑实现某种*反射系统*。这是我到目前为止所取得的成果：

```
/// ------------------------------------------------------------
/// @class  Reflection
/// @brief  General-purpose reflection class.
/// @exmpl  Get type id:
///             auto a = Reflection::get_id_type<int>();
///             auto b = Reflection::get_id_type<Object>();
///         Get type via received id:
///             decltype(Reflection::get_type(a)) d;
/// @note   It is forbidden to create an instance of this class.
/// ------------------------------------------------------------
class Reflection{
public:
    /// Static member functions:
    template<typename T>
    static inline long get_id_type(void){
        return reinterpret_cast<long>(&Database<T>::id);
    }
    static auto get_type(long const type_id) -> decltype(/* UNFINISHED! */){ // This is where I'm having problems.
        // This function body is intentionally left empty.
        // All that matters is the return type.
    }
private:
    /// Inner structures:
    template<typename T>
    struct Database{
        static void* id; // Created void pointer here, because only the address of this variable matters.
    };
    /// Constructors & destructors:
    Reflection(void) = delete;
    ~Reflection(void) = delete;
    /// Member functions (overloaded operators):
    Reflection& operator=(Reflection&&) = delete;
    Reflection& operator=(Reflection const&) = delete;
}; 
```

代码应该足够容易理解。如果您阅读带有注释的整体代码，您应该知道如何使用这个类。但问题是：

> “如何从函数“get_type”返回一个表达式，以便通过**decltype** -specifier 将此表达式转换为可用类型？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T14:49:54.430

您不能拥有取决于参数的*运行时值*的返回类型。时期。你试图做的事情是不可行的。**

# c# - WCF DataContract 中的命名空间与 Xml 反序列化

> ID：12320400
> 
> 赞同：3
> 
> 时间：2012-09-07T14:46:58.317
> 
> 标签：c#, .net, wcf, serialization, xml-serialization

我一直在谷歌搜索和原型设计，但没有成功，我想检查它是否可行。我已经设置了 WCF 服务器客户端。

我有一个带有数据合同和数据成员的对象。我正在对客户端进行脱盐。该方法也在客户端。

```
 [Serializable]
    [DataContract (Namespace = "www.doesnotmatter.com")]
    [XmlRoot("home")]
    public partial class BaseModel
    {
        [DataMember(IsRequired = false)]
        public string prop1
        { get; set; }

        [DataMember(IsRequired = false)]
        public string prop2
        { get; set; }

        [DataMember(IsRequired=false)]
        public string prop3
        { get; set; }

      } 
```

我正在尝试从 xml 反序列化为一个对象，下面的方法是我的函数

```
public T FromXmlString<T>()
{
    var reader = new StringReader(xmlConfiguration);
    var serializer = new XmlSerializer(typeof(T), "www.doesnotmatter.com");
    var instance = (T)serializer.Deserialize(reader);
    reader.Dispose();
    return instance;
} 
```

xml是

```
 <home>
      <prop1>aaaaa</prop1>
      <prop2>bbbbb</prop2>
      <prop3>cccccc</prop3>
    </home> 
```

我不断收到错误

```
InnerException = {"<Task xmlns=''> was not expected."} 
```

所以我将上面的 XML 并想反序列化到上面的 BaseModel 中。编辑：

基本模型对象位于服务器上，我在客户端上，并且有想要反序列化到给定对象（BaseModel）中的 XML。我认为这是一个命名空间问题，它无法正确地从 xml 反序列化到对象中，但不确定。

我真的不确定问题是什么，任何人都可以看到它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:49:01.820

将序列化程序的第二个参数更改为空字符串：

```
var serializer = new XmlSerializer(typeof(BaseModel), ""); 
```

此单元测试通过：

```
using System;
using System.IO;
using System.Runtime.Serialization;
using System.Xml.Serialization;
using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace TestProject1
{
    [TestClass]
    public class UnitTest1
    {
        [TestMethod]
        public void TestMethod1()
        {
            var xml = @"   <home>
      <prop1>aaaaa</prop1>
      <prop2>bbbbb</prop2>
      <prop3>cccccc</prop3>
    </home>";

            var reader = new StringReader(xml);
            var serializer = new XmlSerializer(typeof(BaseModel), "");
            var instance = (BaseModel)serializer.Deserialize(reader);

            Assert.AreEqual("aaaaa", instance.prop1);
            Assert.AreEqual("bbbbb", instance.prop2);
            Assert.AreEqual("cccccc", instance.prop3);
        }
    }

    [Serializable]
    [DataContract(Namespace = "www.doesnotmatter.com")]
    [XmlRoot("home")]
    public partial class BaseModel
    {
        [DataMember(IsRequired = false)]
        public string prop1
        { get; set; }

        [DataMember(IsRequired = false)]
        public string prop2
        { get; set; }

        [DataMember(IsRequired = false)]
        public string prop3
        { get; set; }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:01:57.517

可能是该类已经有一个您未能正确覆盖的 XML 根。很难说，因为没有太多信息。

尝试

```
var serializer = new XmlSerializer(typeof(T), new XmlRootAttribute("home")); 
```

# c - 嵌入式解析器内存使用 XML vs JSON vs？

> ID：12320402
> 
> 赞同：1
> 
> 时间：2012-09-07T14:47:01.657
> 
> 标签：c, xml, json, embedded

我有一个嵌入式 weberver，目前用于通过网络管理各种硬件。

目前它有一个浏览器类型的 Web 界面，但我需要对其进行增强以提供 REST API，以便其功能可以自动化，显而易见的选择是使用 XML 或 JSON。

该设备只有 8MB 的 RAM 和 4MB 的闪存，因此代码大小和内存使用至关重要。

显而易见的选择是接口的 JSON 和 XML，我很想知道您认为哪个是最有效的方法（或其他方法）和最好的库。（它是用C编码的）

我应该提到的一个额外限制是，无论我指定什么我将记录并提供给客户以进行构建，因此人类可读性会更好。

这是我一直在查看的 JSON 库：http: [//zserge.bitbucket.org/jsmn.html](http://zserge.bitbucket.org/jsmn.html)

这是 XML：[http ://expat.sourceforge.net/](http://expat.sourceforge.net/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T15:26:31.823

JSON 通常比 xml 更轻量级和更高效（例如更少的规则、更少的极端情况、更短的数据、更类似于实际的数据类型……）

或者，如果您希望它*真正*高效，您可以使用像 BSON 这样的二进制格式。

# c# - 在 wpf 中制作 StackPanel 及其内容“可拖动”？

> ID：12320406
> 
> 赞同：4
> 
> 时间：2012-09-07T14:47:12.070
> 
> 标签：c#, wpf, xaml

我有一个形式为 UserControl：

```
<UserControl>   
    <Grid>         
          <!-- Content Here-->    
      <StackPanel>   <!-- I want this element to be draggable within the usercontrol. -->    
         <Label Name = "Header" />  
         <Button />
         <Button />
         <Button />             
         </StackPanel>    
   <Grid>             
</UserControl> 
```

我的最终结果是有一个可以拖动的带有按钮（用户控件的一部分）的控件..？也就是说，在 UserControl 内可移动...

我读过关于拇指的书，但我不知道如何使用它......任何想法或例子都会很棒。谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-07T16:11:18.393

一个非常简单的方法是使用鼠标事件

首先，将你`StackPanel`的东西包裹起来，`Canvas`这样它就可以根据用户拖动它的位置轻松定位

接下来，将`MouseDown`和`MouseUp`事件添加到`StackPanel`. 您可能需要为其提供`StackPanel`背景颜色才能接收鼠标事件。

在这种情况`MouseDown`下，将`MouseMove`事件处理程序附加到`StackPanel`并让面板[捕获鼠标](http://msdn.microsoft.com/en-us/library/system.windows.uielement.capturemouse.aspx)，以便所有鼠标事件都将由`StackPanel`.

在`MouseUp`事件中，分离`MouseMove`事件并释放鼠标捕获。

在这种情况`MouseMove`下，根据当前鼠标位置更改面板的`Canvas.Top`和`Canvas.Left`属性。您需要在此处进行检查以确定鼠标是否在屏幕之外，`UserControl`因此`StackPanel`无法将鼠标拖出屏幕。

就是这样，非常基本的拖放:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2021-04-30T00:56:16.930

这是 WPF 中 Draggable Rectangle 的实际工作示例，这正是 Rachel 上面所说的。

你可以在标签里面放任何`UserControl`// etc `StackPanel`。`Grid``Canvas`

我这样做是因为我在拖动 a 时遇到了问题`StackPanel`，问题实际上是我在面板上设置了一个边距，所以它被抵消了。

当您拖动它时，它不会跳过。

```
<Window x:Class="WpfApp1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:WpfApp1"
        mc:Ignorable="d"
        Title="MainWindow" Height="450" Width="800">
    <Grid>
        <Canvas x:Name="canvas" Background="Transparent" PreviewMouseLeftButtonDown="PreviewDown" PreviewMouseLeftButtonUp="PreviewUp" MouseMove="MoveMouse">
            <Rectangle x:Name="Rectangle" HorizontalAlignment="Left" Fill="Black" Height="85" Margin="0" Stroke="Black" VerticalAlignment="Top" Width="82" />
        </Canvas>
    </Grid>
</Window> 
```

`XAML`

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;

namespace WpfApp1
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
        }

        private object movingObject;
        private double firstXPos, firstYPos;

        private void PreviewDown(object sender, MouseButtonEventArgs e)
        {
            firstXPos = e.GetPosition(Rectangle).X;
            firstYPos = e.GetPosition(Rectangle).Y;

            movingObject = sender;
        }

        private void PreviewUp(object sender, MouseButtonEventArgs e)
        {
            movingObject = null;
        }

        private void MoveMouse(object sender, MouseEventArgs e)
        {
            if (e.LeftButton == MouseButtonState.Pressed && sender == movingObject)
            {
                double newLeft = e.GetPosition(canvas).X - firstXPos - canvas.Margin.Left;

                Rectangle.SetValue(Canvas.LeftProperty, newLeft);

                double newTop = e.GetPosition(canvas).Y - firstYPos - canvas.Margin.Top;

                Rectangle.SetValue(Canvas.TopProperty, newTop);
            }
        }
    }
} 
```

`MainWindow.cs`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T14:51:27.223

一种方法是处理按钮上的鼠标单击并在移动鼠标时更改其位置。

所以步骤将是：

1.  向按钮添加处理程序。例如鼠标点击（或鼠标按下）
2.  当您收到鼠标点击时，将处理程序添加到 mousemove。
3.  检查鼠标的移动并更改按钮的位置
4.  释放鼠标按钮后删除处理程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T14:51:42.380

我不知道任何具体的方法，但直观地说，您可以添加一个事件处理程序来拖动您想要移动的控件的方法，并且在该方法中，您可以将控件渲染为位图，使该位图跟随您的鼠标指针，并隐藏原始控件。当放下（鼠标释放）时，它应该简单地将原始控件的坐标设置为鼠标坐标，处理位图，并重新启用控件的可见性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-07T14:54:46.663

在 MSDN 和其他地方有一些可用的教程。尝试使用以下链接进行 WPF 拖放。

[WPF 拖放](http://wpftutorial.net/DragAndDrop.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-07T14:56:27.097

你应该给[avalondock 项目](http://avalondock.codeplex.com/)一个机会。

这允许您创建丰富的布局功能，如 Visual Studio 所做的（浮动、停靠等）。

我相信这会对你有所帮助。

# .net - Save_Changes 的实体框架外键违规

> ID：12320412
> 
> 赞同：2
> 
> 时间：2012-09-07T14:47:34.353
> 
> 标签：.net, entity-framework, foreign-keys, linq-to-entities, sql-server-ce

这绕过了 Entity Framework 拒绝让程序员能够更改数据保存顺序的令人愉快的场景......

最终结果：当我尝试保存我的更改（提交到 SQLCE DB）时，我收到一个内部异常的错误：“无法插入外键值，因为相应的主键值不存在。[外键值键约束名称 = ]"

为什么会这样：我的 VB.Net 程序有一部分允许用户与内存中的数据进行交互。就他们的用户而言，它看起来和感觉就像他们正在与数据库进行交互。完成本节中的工作后，他们可以保存/应用更改或取消更改。我选择这条路线是为了最简单的“退出”并减少与数据库的交互（我不想在用户更改内容时对数据库进行不必要的插入/更新/删除）。

通过取消，我只需使用 Context Refresh 方法从 DB 重新加载 EF 数据，从而消除他们所做的任何事情。通过保存/应用，我只需调用上下文的“Save_Changes”方法来一劳永逸地提交当前信息。该数据库是一个本地 SQLCE，只有一个用户的应用程序正在访问它。我不担心多个连接会导致信息并发问题。

这里的问题是我有 3 个表，每个表都有一对多的层次关系： TableA 1->* TableB 1->* TableC

正在发生的事情是 EF 试图首先将 DB 中的更改保存到 TableC 而不是 TableA，依此类推。嗯.....那种让数据库中的FK约束不开心，因为数据库约束（EF已经设置为匹配）抱怨表C中保存的条目不能存在，因为表B中引用的条目键不存在不存在……还没有。Entity Framework 很高兴，因为所有这些约束都在内存中的 EF 模型中得到满足，但它没有以正确的顺序将它们提交给 DB，因此违反了。

我正在使用 Visual Studio 2010 Express（它限制我使用 SQLCE 3.5）和 .net 4。我已经为 VSE 2010 运行了所有当前的 Service Pack，据我所知，我正在运行此设置允许的最新版本的 EF因为我的项目参考仍然显示.net 4.0.0.0。我尝试实现 EF 5，但它似乎不适用于 VSE 2010。

我是否只需要从数据库中删除我的约束并仅在实体框架模型中使用它们？我真的不喜欢那个选项，但是如果这个 EF 版本有一个错误，它按照关系以错误的顺序提交到数据库，那么我想在 VSE 2012 发布之前我没有太多选择……

**编辑：** 这是负责在内存中填充表的代码。正在读取的文件具有顺序，因此如果没有添加父项，就不会找到子项。

```
 Dim lines() As String = IO.File.ReadAllLines(dlgOpen.FileName)
    For Each line In lines
        'Remove surrounding whitespaces
        line = Trim(line)
        'Identify if line is MIB, Class or an Attribute
        If InStr(line, "MIB:", CompareMethod.Text) > 0 Then 'Found MIB entry

            'Create new entry in the OID_MIB table
            newMIB = SEDB.OID_MIB.CreateObject
            curMIB = Guid.NewGuid
            newMIB.M_ID = curMIB
            newMIB.Name = Split_Line(line, 3)
            newMIB.Description = ""
            SEDB.OID_MIB.AddObject(newMIB)
            MIBCount = MIBCount + 1
        ElseIf InStr(line, "Class", CompareMethod.Text) = 1 Then
            'Found Class entry
            'Create new entry in the OID_Class table
            newClass = SEDB.OID_Class.CreateObject
            newClass.M_ID = curMIB
            newClass.Name = Split_Line(line, 3)
            newClass.OID = Split_Line(line, 2)
            newClass.Description = ""
            newClass.Tip = ""
            SEDB.OID_Class.AddObject(newClass)
            ClassCount = ClassCount + 1
        ElseIf InStr(line, "attribute", CompareMethod.Text) = 1 Then
            'Found Attribute entry
            'Create new entry in the OID_Attribute table
            newAttribute = SEDB.OID_Attribute.CreateObject
            newAttribute.OID = Split_Line(line, 2)
            newAttribute.C_OID = Get_ClassOID(newAttribute.OID)
            newAttribute.Name = Split_Line(line, 3)
            newAttribute.Description = ""
            newAttribute.Tip = ""
            newAttribute.Type = ""
            SEDB.OID_Attribute.AddObject(newAttribute)
            AttributeCount = AttributeCount + 1
        End If
    Next 
```

我会有一张图片来确认我在概念模型和数据库中的约束设置是否正确，但我还没有足够的声誉点来发布图片。

答：嗯，我会的……在做了一些修改之后，我删除了仅针对TableC和TableB的DB端的约束，如果这确实是一个“顺序”问题，那么它仍然会被破坏，只是具有从 TableB 到 TableA 的约束；然而，它并没有坏掉。

遍历数据库中保存的数据使我能够识别来自文本文件的两个条目，其中将在属性表​​ (TableC) 中创建一个条目，该条目在类表 (tableB) 中没有相应的值。因此，FK 违规。

奇怪的是，这在导入过程中如何没有造成违规。

无论如何，我知道问题出在数据源中，我会添加逻辑来解决这个问题。正如 Dabblernl 已经指出的那样，问题不在保存时的 EF 顺序中。

非常感谢大家的耐心等待。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T17:36:03.587

在做了一些修改之后，我删除了仅针对 TableC 和 TableB 的 DB 端的约束，如果这确实是一个“顺序”问题，那么它仍然会被破坏，只是从 TableB 到 TableA 的约束；然而，它并没有坏掉。

遍历数据库中保存的数据使我能够识别来自文本文件的两个条目，其中将在属性表​​ (TableC) 中创建一个条目，该条目在类表 (tableB) 中没有相应的值。因此，FK 违规。

奇怪的是，这在导入过程中如何没有造成违规。

无论如何，我知道问题出在数据源中，我会添加逻辑来解决这个问题。正如 Dabblernl 已经指出的那样，问题不在保存时的 EF 顺序中。

非常感谢大家的耐心等待。

# php - 通过 composer 从 Symfony 2.0 更新到 Symfony2.1 时找不到捆绑包

> ID：12320416
> 
> 赞同：0
> 
> 时间：2012-09-07T14:47:47.693
> 
> 标签：php, symfony, symfony-2.1, composer-php

我正在将我的应用程序从 Symfony2.0 更新到 Symfony2.1。

当我运行 composer install 时，我收到一个关于`JMS/SerializerBundle`在生成自动加载文件步骤时找不到的致命异常。我认为`cache:clear`这是造成这种情况的原因。

我已将其添加到`composer.json`：

```
"jms/serializer-bundle": "dev-master", 
```

在我的*appKernel*中：

```
new JMS\SerializerBundle\JMSSerializerBundle($this), 
```

我基本上按照步骤进行。

我也无法在供应商目录中找到该文件。作曲家说“无需安装或更新”。如果我输入版本号也没关系。认为这与 stof 学说扩展相同。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T07:22:36.200

将 symfony 设置为 2.1.0 允许我安装额外的存储库。

# php - 如何在 Facebook Graph API 中使用分页？

> ID：12320427
> 
> 赞同：2
> 
> 时间：2012-09-07T14:48:31.450
> 
> 标签：php, facebook, facebook-graph-api, paging

当使用 Facebook Graph API 返回超过 500 个元素（如朋友列表）时，需要分页。有什么好方法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T14:48:31.450

这是我在自己的应用程序上使用分页的方式。

[http://developsocialapps.com/facebook-friends-list-and-paging/](http://developsocialapps.com/facebook-friends-list-and-paging/)

该库具有所需的大部分代码。主要方法是**getGraphObjectWithPaging**。它使用图形 API 获取对象，然后只要响应中有下一页或已达到 $maxpages，就会一直循环。一个特点是，有时 Facebook 会返回与您刚刚获得的相同页面的下一页，因此它会检查这一点并在该点停止。

```
class FacebookApp {               

    public $appId;
    private $appSecret;
    private $nameSpace;
    public $userId;
    public $token;
    public $tokenExpires;

    // get your own from http://www.w3.org/P3P/
    public $p3p = 'P3P:CP="IDC DSP COR ADM DEVi TAIi PSA PSD IVAi IVDi CONi HIS OUR IND CNT"'; 

    /*  construct object 
        appid, secret, and namespace from app settings  */
    public function __construct($id, $secret, $namespace) {
        $this->appId = $id;
        $this->appSecret = $secret;
        $this->nameSpace = $namespace;
    }

    /*  return json data from a graph api object using paging   
        $object = object to get
        limit = limit parameter for API object
        maxpages = maximum number of pages to get   */
    function getGraphObjectWithPaging($object,$limit=500,$maxpages=10) {
        $data = array();
        $url = $this->getGraphUrl($object,$limit);
        // loop through API calls until maxpages or no paging->next
        while ($maxpages > 0) {
            $response = $this->makeCurlRequest($url);
            if ($repsonse === false) {
                // something went wrong
                break;
            } else {
                $jsonarray = json_decode($response,true);
                if (isset($jsonarray['error'])) {
                    // something went wrong
                    break;
                } else {
                    // add current data to data array
                    $data = array_merge ($data,$jsonarray['data']);
                    if (isset($jsonarray['paging']['next'])) {
                        if ($url == $jsonarray['paging']['next']) {
                            // for some reason facebook sometimes returns a next url which is the same as we just got, so exit here
                            break;
                        } else {
                            // keep looping
                            $url = $jsonarray['paging']['next'];
                            $maxpages--;
                        }
                    } else {
                        // no more pages
                        break;
                    }
                }
            }
        }
        return array("data"=>$data); // using data so it is the same format as other API repsonses
    }

    /*  constructs graphs url   */
    public function getGraphUrl($object,$limit=false) {
        $url = "https://graph.facebook.com/".$object;
        if (strpos($url,"?") === false) $url .= "?";
        else $url .= "&";
        $url .= "access_token=".$this->token;
        if ($limit !== false) $url .= "&limit=".$limit;
        return $url;
    }

    /*  uses curl to get a url, use $postarray to make a post, otherwise it will get    */
    public function makeCurlRequest($url,$postarray=false) { 
        $return = false;
        try {
            $ch = curl_init(); 
            curl_setopt($ch, CURLOPT_URL, $url);
            curl_setopt($ch, CURLOPT_HEADER, false); 
            curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); 
            if($postarray !== false){ 
                curl_setopt ($ch, CURLOPT_POST, true); 
                curl_setopt ($ch, CURLOPT_POSTFIELDS, $postarray); 
            } 
            $response = curl_exec($ch); 
            $responseInfo = curl_getinfo($ch); 
            curl_close($ch); 
            if ($responseInfo['http_code']==200) { 
                $return = $response; 
            } 
        } catch (Exception $e) {
            $return = false; 
        }
        return $return;
    } 

    /*  sets userid and token from signed request, return true or false if authorized   */
    public function initOauthUserFromSignedRequest() {
        $authorized = false;
        if (isset($_REQUEST['signed_request'])) {
            $data = $this->parseSignedRequest($_REQUEST['signed_request']);
            if ($data !== false) {
                if (isset($data['user_id']) && isset($data['oauth_token'])) {
                    $this->userId = $data['user_id'];
                    $this->token = $data['oauth_token'];
                    $this->tokenExpires = $data['expires'];
                    $authorized = true;
                }
            }
        }
        return $authorized;
    }

    /*  require user to authorize and have permissions for page
        redirect_uri = url to return after user has authorized like redirect.php
        success_uri = url to redirect to on successful authorization like mypage.php
        scope = comma separted list of permissions  */
    function requireAuthorization($redirect_uri,$success_uri=false,$scope=false) {
        if ($success_uri === false) {
            // if no success_uri use current page, all files for app must be in same directory
            $success_uri = substr($_SERVER['REQUEST_URI'],strrpos($_SERVER['REQUEST_URI'],"/")+1); 
        }
        $this->setCookie ("success_uri",$success_uri,0); // we will use this on the redirect_uri page
        $requireauth = true;
        if ($this->initOauthUserFromSignedRequest()) { // user has authorized
            if (($scope === false) || ($this->hasAllPermissions($scope))) { // now check for perms
                $requireauth = false;
            }
        }
        if ($requireauth) { // user is either not authorized or doesn't have permissions
            $url = $this->getAuthUrl($this->getCanvasUrl($redirect_uri),$scope);
            echo "<html>\n<body>\n<script>\ntop.location.href='".$url."';\n</script></body></html>";
            exit();
        }
    }

    /*  checks to see if has permissions, scope is comma separated list */
    public function hasAllPermissions($scope) {
        $return = false;
        $cookiename = "permissions_".$this->appId."_".$this->userId;
        $requiredpermissions = explode(",",$scope);
        // first check cookie
        if (isset($_COOKIE[$cookiename])) {
            $return = true;
            $permissions = json_decode($_COOKIE[$cookiename],true);
            foreach ($requiredpermissions as $perm) {
                if ($permissions['data'][0][$perm] != 1) {
                    $return = false;
                    break;
                }
            }
        }
        // if didn't have all in cookie, then see if it is in graph 
        if ($return == false) {
            $permissions = $this->getGraphObject("me/permissions");
            if ($permissions !== false) {
                $this->setCookie($cookiename,json_encode($permissions),0);
                $return = true;
                foreach ($requiredpermissions as $perm) {
                    if ($permissions['data'][0][$perm] != 1) {
                        $return = false;
                        break;
                    }
                }   
            }
        }
        return $return;
    }

    /*  sets a cookie with p3p headers  */
    public function setCookie($name,$value,$expires) {
        if ($this->p3p != '') {
            header($this->p3p);
            $this->p3p = '';
        }
        setcookie ($name,$value,$expires,"/"); 
    }

    /*  returns url for oauth authorization
        redirect_uri = url to return after user has authorized
        scope = comma separted list of permissions  */
    public function getAuthUrl($redirect_uri,$scope=false) {
        $url = "https://www.facebook.com/dialog/oauth/?client_id=".$this->appId."&redirect_uri=".rawurlencode($redirect_uri);
        if ($scope !== false) $url .= "&scope=".rawurlencode($scope);
        return $url;
    }

    /* returns url to app canvas page, $page like mypage.php?foo=bar    */
    public function getCanvasUrl($page) {
        if ($_SERVER['HTTPS'] == "on") $protocol = "https";
        else $protocol = "http";
        return $protocol."://apps.facebook.com/".$this->nameSpace."/".$page;
    }

    /*  parses signed_request parameter and returns data object, returns false if sigs don't match  */
    public function parseSignedRequest($signed_request) {
        list($encoded_sig, $payload) = explode('.', $signed_request, 2); 
        $data = json_decode(base64_decode(strtr($payload, '-_', '+/')), true);
        $sig = base64_decode(strtr($encoded_sig, '-_', '+/'));
        $expected_sig = hash_hmac('sha256', $payload, $this->appSecret, true);
        if ($sig == $expected_sig) {
            return $data;
        } else {
            return false;
        }
    }

} 
```

以下是如何在页面上使用它：

```
$facebookapp = new FacebookApp($GLOBALS['facebookAppId'],$GLOBALS['facebookAppSecret'],$GLOBALS['facebookNamespace']);

$facebookapp->requireAuthorization($GLOBALS['facebookRedirectPage']);

$friends = $facebookapp->getGraphObjectWithPaging("me/friends"); 
```

# java - java：如何检查整个 ArrayList 的类型

> ID：12320429
> 
> 赞同：7
> 
> 时间：2012-09-07T14:48:32.873
> 
> 标签：java, arraylist

我知道如何硬编码一个算法来检查数组列表中每个对象的类型，但是有没有其他方法可以一次性检查 ArrayList<> 的类型，我的意思是我的应用程序只有三种类型的数组列表. 假设我有一个返回 ArrayList 的函数，它的定义是在变量 o 中（它当然是对象的数组列表）我将添加一个人对象，

```
o.add(person); 
```

并在对象数组列表中添加了所有人员数据，当调用此函数时，我的函数的名称是 getData()，

```
ArrayList <Object> obj = getData(); 
```

所以我知道在我从调用 getData() 返回的那个 ArrayList 中它是所有人员对象，我怎么知道那个 ArrayList 的类型？

只是希望该功能在意义上更通用，但这适用于我的应用程序，通用整个应用程序。

有没有其他方法可以做到这一点，我可以想到一个算法，但是有没有捷径或简单的方法可以做到这一点？..

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-07T15:01:47.313

没有“类型”之类的东西`ArrayList`。

该类`ArrayList`存储`Object`引用列表。它不知道也不关心它们是否都是某种类型。

Java 泛型系统添加了**编译时**检查来帮助您跟踪类型。因此，如果您声明`ArrayList<Person>`，如果您编写的代码可以`Person`在您的列表中插入一个非，您将得到编译错误。

在运行时，唯一的方法来告诉什么是在一个`ArrayList`迭代所有包含的项目和检查他们`instanceof`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-06-18T13:24:38.807

实际上有一种方法不需要手动投射每个项目（虽然它仍然很丑......）

```
//start with an arraylist of unknown generic type
ArrayList <Object> obj = getData();

//Make an array from it(basically the same as looping over the list
// and casting it to the real type of the list entries)
Object[] objArr = obj.toArray();

//Check if the array is not empty and if the componentType of the 
//array can hold an instance of the class Person 
if(objArr.length>0 
    && objArr.getClass().getComponentType().isAssignableFrom(Person.class)) {
    // do sth....
} 
```

这不应该给出任何未经检查的警告。

你可以像这样使用它：

```
private boolean isArrayOfType(Object[] array,Class<?> aClass) {
    return array.length > 0
            && array.getClass().getComponentType().isAssignableFrom(aClass);
}
Object[] personArr = getData().toArray();
if(isArrayOfType(personArr,Person.class) {
   //Do anything...

} 
```

以下是行不通的：

```
// -> This won't work, sry!
       ArrayList<Person> personArrayList = Arrays.asList((Person[])personArr); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-11-13T19:54:09.587

如果列表不为空，则获取第一个元素：

```
type = this.list.get(0).getClass().getSimpleName(); 
```

# c++ - gdb：更改特定对象时中断

> ID：12320432
> 
> 赞同：2
> 
> 时间：2012-09-07T14:48:38.260
> 
> 标签：c++, debugging, gdb, breakpoints

我有一个用 c++ 定义的对象，其中有一个指向它的指针，用于整个项目的各种函数和文件。我在更新数据时遇到问题，因此我想对其进行调试以查看发生了什么。理想情况下，我想在每次访问对象时中断。但是，`watch`需要特定的内存地址。因此，例如，如果我有：

```
class data{
public:
    int a;
    int b;
}; 
```

那么 gdb 只会在`a`被更改时中断，因为指向数据的指针指向`a`，但在`b`更改时不会中断。

每当更改类所涵盖的整个内存范围时，是否有办法中断`data`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T15:28:24.973

> 每当数据类覆盖的整个内存范围发生变化时，是否有办法中断？

也许。

GDB 硬件观察点在硬件中使用特殊的调试寄存器，并且这些寄存器的工作方式通常存在限制。在 上`x86`，您最多可以设置 4 个字大小的硬件观察点，例如，您*可以*`&data->a`在和上设置观察点`&data->b`，这将“覆盖”整个内存`data`。

我猜你的实际`data`有更多的成员，所以 4 个字大小的观察点是不够的。

如果您在支持 Valgrind 的平台上，并且如果您的程序可以在 Valgrind 下执行，那么您可以使用 Valgrind 的内置[gdbserver](http://valgrind.org/docs/manual/manual-core-adv.html#manual-core-adv.gdbserver)在*任意*内存区域设置观察点。

更新：

> 我浏览了您链接到的页面，但找不到我要查找的内容

我不确定你在找什么。这是一个示例会话，展示了它是如何工作的：

```
#include <stdlib.h>

void foo(char *p)
{
  *p = 'a';
}

typedef struct {
  char buf[1024];
} data;

int main()
{
  data *d = calloc(1, sizeof(data));
  foo(d->buf + 999);
}

gcc -g main.c

valgrind --vgdb-error=0 ./a.out
...
==10345== TO DEBUG THIS PROCESS USING GDB: start GDB like this
==10345==   /path/to/gdb ./a.out
==10345== and then give GDB the following command
==10345==   target remote | vgdb --pid=10345 
```

... Valgrind 现在等待调试器附加。

在另一个窗口中：

```
gdb ./a.out
GNU gdb (GDB) 7.4
...
(gdb) target remote | vgdb --pid=10345
relaying data between gdb and process 10345
[Switching to Thread 10345]
0x0000000004000af0 in _start () from /lib64/ld-linux-x86-64.so.2
(gdb) b main
Breakpoint 1 at 0x40053d: file main.c, line 14.
(gdb) c

Breakpoint 1, main () at main.c:14
14        data *d = calloc(1, sizeof(data));
(gdb) n
15        foo(d->buf + 999);
(gdb) watch *d
Hardware watchpoint 2: *d 
```

请注意，已在*整个* `*d`. 仅在 Valgrind 是硬件的意义上，它才是硬件观察点。

```
(gdb) p d.buf[999]
$1 = 0 '\000'
(gdb) c
Hardware watchpoint 2: *d

Old value = {buf = '\000' <repeats 1023 times>}
New value = {buf = '\000' <repeats 999 times>, "a", '\000' <repeats 23 times>}
foo (p=0x51b6457 "a") at main.c:6
6       }
(gdb) q 
```

瞧：调试器在第 999 个元素被修改时停止，证明观察点“覆盖”了整个结构。

# ruby-on-rails - Rails 没有验证

> ID：12320438
> 
> 赞同：0
> 
> 时间：2012-09-07T14:48:50.357
> 
> 标签：ruby-on-rails, ruby, validation

所以我认为这是因为我在创建时将用户 ID 合并到讨论中，因为我正在验证讨论内容和标题......

**讨论模型**

```
class Discussion < ActiveRecord::Base  
  attr_accessible :user_id, :content, :title

  has_many :discussion_comments, :dependent => :destroy
  belongs_to :user

  validate :content, :presence => true,
                     :length => {:minimum => 10, :maximum => 254}
  validate :title, :presence => true,
                   :length => {:minimum => 10, :maximum => 254}
end 
```

**讨论控制器**

```
 def create
    @discussion = Discussion.create(params[:discussion].merge(:user_id => current_user.id))
    if @discussion.save
      redirect_to tasks_path, :flash => {:success => 'Created a new discussion'}
    else
      redirect_to tasks_path, :flash => {:error => 'Cannot create empty discussions.'}
    end
  end 
```

无论如何，每次我尝试保存一个空表单时，它都会在应该给我错误消息时给我成功消息。

**讨论表**

```
<%= form_for @discussion do |f| %>

    <p><%= f.label :title %>
    <%= f.text_field :title %></p>

    <p><%= f.label :content %>
    <%= f.text_area :content %></p>

    <p><%= f.submit %></p>

<% end %> 
```

如前所述，我认为这与我在创建时合并用户 ID 的事实有关，验证应该如何停止整个创建过程 - 不是吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T14:58:50.310

这是 Rails 3.x 吗？尝试使用`validates`not `validate`。可能只是一个简单的错字。

所以...

```
class Discussion < ActiveRecord::Base  
  ...

  validates :content, :presence => true,
                      :length => {:minimum => 10, :maximum => 254}
  validates :title, :presence => true,
                    :length => {:minimum => 10, :maximum => 254}
end 
```

参考： http: [//guides.rubyonrails.org/active_record_validations_callbacks.html#presence](http://guides.rubyonrails.org/active_record_validations_callbacks.html#presence)

我链接到该`presence`示例，但`validates`无论您传递给它的选项都应该是。

# jquery - jQuery 数据表显示 html 内容

> ID：12320443
> 
> 赞同：9
> 
> 时间：2012-09-07T14:49:11.317
> 
> 标签：jquery, html, datatables, server-side

我的页面上有一个 jquery 数据表，它使用服务器端处理来检索数据。在这种情况下，其中一列包含 html 内容，因此我的服务器响应如下所示：

```
"aaData": [ [1, "aaa", "&lt;span class=&quot;myclass&quot;&gt;html here&lt;/span&gt;" ], ... 
```

我试过了

```
"aoColumnDefs": [ "aTargets":[2], "sType": "html" } 
```

但我仍然看到单元格内容就好像它是纯字符串一样。我能做些什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-07T18:29:32.873

制作了一个工作版本

```
"aoColumnDefs": [ 
    { "aTargets": [2], 
      "sType": "html", 
      "fnRender": function(o, val) { 
          return $("<div/>").html(o.aData[2]).text();
      } 
    }
] 
```

用jQuery解码回html。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-12-22T08:42:25.537

我更新了 SamuGG 的答案，以获得新的数据表版本：

```
"aoColumnDefs": [ {
                     "aTargets": [ 5 ],
                     "mRender": function ( data, type, full ) {
                      return $("<div/>").html(data).text(); 
                      }
            } ] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-06-05T03:12:36.027

您只需在 rawColumns() 或 make(true) 之前添加以下行

```
->escapeColumns('aaData') 
```

使用此方法并传递列名就是这样

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-10T12:26:03.293

```
var renderAsHtml = function (data, type, full) {
return decHTMLifEnc(data);
}; 
var isEncHTML = function(str) {
    if(str.search(/&amp;/g) != -1 || str.search(/&lt;/g) != -1 || str.search(/&gt;/g) != -1)
        return true;
    else
        return false;
};

var decHTMLifEnc = function(str){
    if(isEncHTML(str))
        return str.replace(/&amp;/g, '&').replace(/&lt;/g, '<').replace(/&gt;/g, '>');
    return str;
} 
```

将 renderAsHtml 作为函数引用传递给 fnRender。这也是作品

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-14T09:52:41.277

这就是我在数据表列中呈现 HTML 标记的方式：

```
ajax: "getData?userobjid=<%=session.getAttribute("userobjectid")%>&alpha=&selectsuppliersflag="+selectsuppliersflag,
columns: [
            { data:  null, render: function ( data, type, row ) {
                if(data.storeFrontUrl == 'undefined' || data.storeFrontUrl==null){
                        return "<label>"+data.companyName+"</label>";
                         }
                        else{
                        return "<a href='JavaScript:newPopup(\"directorylist/view/"+data.storeFrontUrl+"\");'>"+data.companyName+"</a>";
                     }
                    }}, 
```

# python - 如何在给定的时间段内执行代码

> ID：12320444
> 
> 赞同：0
> 
> 时间：2012-09-07T14:49:21.937
> 
> 标签：python, time, timer, task

我想知道 python 2.7 中是否有一种方法可以在给定的时间内运行代码，比如 3600 秒。时间可以从一次执行到另一次执行不同。欢迎任何想法，因为我遇到了这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:05:12.433

允许出于任何原因中断计算：

```
def compute_something(stopped):
    while not stopped:
        # continue computations

stopped = []
threading.Timer(3600, stopped.append, args=[True]).start()
compute_something(stopped) 
```

# facebook - Facebook喜欢按钮不显示

> ID：12320447
> 
> 赞同：4
> 
> 时间：2012-09-07T14:49:26.030
> 
> 标签：facebook, facebook-like, xfbml

我正在尝试将 facebook like 按钮添加到 ASP.NET 页面。我已使用[Get Like 按钮代码小部件](http://developers.facebook.com/docs/reference/plugins/like/)生成代码并将其复制到我的母版页中。喜欢按钮在大多数情况下都可以正常工作，但对于某些随机页面则不行。我已经使用 Chrome 中的开发人员工具 javascript 控制台检查了 javascript 错误，但似乎没有（我在 FF 和 IE 中也遇​​到了同样的问题）。

更奇怪的是，我可以浏览到诸如 mysite.com/category/12345/some-descriptive-name 之类的 url 并查看问题。但是从 url 末尾敲掉几个字母（例如 mysite.com/category/12345/some-descriptive-na），问题就消失了[我正在使用 url 重定向，只要 id 相同，就一样页已送达]。

我最好的想法是我达到了一些最大的 url 长度，但这似乎不是问题，因为简单地更改上面 url 中的 Id 也可以按预期工作。

我已经尝试过 HTML5 和 XBFML 版本的 like 按钮，都存在同样的问题。

我唯一能想到的另一件事是生成一个 appId，希望这会使它更可靠。

我目前无法将您指向一个公开的网站，但代码如下：

```
...
<body class="clearfix">
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_GB/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
...
<div class="fb-like" data-send="false" data-layout="button_count" data-width="450" data-show-faces="false" data-font="segoe ui"></div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-08T08:07:03.097

[这个 SO 答案](https://stackoverflow.com/questions/6698783/facebook-like-button-not-working#answer-6700317)为我指明了正确的方向。在实际有效的链接上使用该工具会导致点赞按钮进一步停止对该链接的工作。深入研究结果，有一个重定向部分，FB 被重定向到我的登录页面。

这个问题是在一个被锁定的测试站点上发现的。暂时删除表单身份验证，然后通过 lint 运行链接解决了该问题。

# java - 为什么在 Java 中必须初始化嵌套循环控制变量？

> ID：12320449
> 
> 赞同：3
> 
> 时间：2012-09-07T14:49:29.820
> 
> 标签：java, initialization, nested-loops

我写了一个简单的“在多维数组中查找数字”，包含在官方 java 教程中。这是教程中包含的代码：

```
class LabeledBreak {
    public static void main(String[] args) {
        int [][] numbers = {
            {22, 34, 675, 23, 23},
            {34, 76, 98, 23, 11},
            {65, 234, 87, 23, 76}
        };

        int searchFor = 123;
        boolean found = false;
        int i;
        int j = 0;  // <-- this line

search:
        for (i = 0; i < numbers.length; i++) {
               for (j = 0; j < numbers[i].length; j++) {
                if (searchFor == numbers[i][j]) {
                    found = true;
                    break search;
                }
               }
        }

        if (found == true)
            System.out.println("Found " + searchFor + " at index " + i + ", " + j);
        else
            System.out.println(searchFor + " not found!!!");
    } 
```

我不明白在这里初始化“j”有什么意义。我尝试删除初始化语句并使其只是一个声明。但我得到了那个错误：

“变量 j 可能尚未初始化”

为什么我必须初始化“j”？为什么“i”也不需要初始化？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-07T14:52:25.127

好吧，如果`numbers.length`为 0，则内部循环将永远不会运行，因此`j`永远不会被初始化，即您永远不会到达 statement `j = 0;`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T14:59:47.983

我无法将其放入评论中，因此我将代码放在这里。

恕我直言，最好使用不会遇到这些问题的结构。

```
FOUND: {
    for (int i = 0; i < numbers.length; i++)
       for (int j = 0; j < numbers[i].length; j++)
            if (searchFor == numbers[i][j]) {
                System.out.println("Found "+searchFor+" at index "+i+", "+j);
                break FOUND;
            }
    System.out.println(searchFor + " not found!!!");
} 
```

变量的范围仅限于可以安全使用的地方。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T14:54:47.030

考虑这段代码：

```
int j = 1234567;
int end = -100;
for (int i = 0; i < end; i++)
    for (j = 0; j < 10; j++)
        System.println("Hello.");
System.println("j is "+j); 
```

尝试不同的值`end`。注意输出是`1234567`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-09T19:32:47.797

**为什么 Java 关心禁止读取未初始化的变量？**

这样的代码结构往往是不确定的，因此难以调试，因此不可靠。此外，不加选择的堆栈内存重用可能会导致安全漏洞。

Java 语言规范第 16 节定义了使变量“在使用前明确赋值”的原因，主要是通过查看代码流（句法结构），但忽略其他变量的内容，即使已知，也忽略沿方法。

**但我总是初始化`j`.**

是的你是。但为了证明这一点，你需要深入挖掘 的初始内容`numbers`，了解该`length`方法的工作原理，甚至排除其他线程`numbers`在主线程执行时获取对数组的引用和修改数组的可能性。

**但是在设置时我不会访问`j`代码路径之外的内容`found`，因此``j`被初始化。**

正如你所说。但是 JLS 第 16 节只考虑代码结构，而不考虑其他变量的值，例如`found`.

**为什么有`i`什么不同？**

的初始化在`i`语法上完全保证是在外循环中发生的第一件事，即使它的主体（纯粹假设）根本不执行。

**如果我的 Java 编译器足够聪明，可以看到我没有访问任何未初始化的变量怎么办？**

就 JLS 第 16 节而言，这不会改变任何事情。您的编译器不允许您保存此类形式初始化程序，因为该程序可能无法移植到其他可能不那么聪明的 Java 编译器。

# java - 使用 jdbc 在 oracle 中将 InputStream 保存为 clob

> ID：12320450
> 
> 赞同：0
> 
> 时间：2012-09-07T14:49:32.543
> 
> 标签：java, oracle, jdbc, clob, apache-commons-dbcp

我有一个用户上传的 csv 文件，我需要将其作为 Clob 存储在 oracle 表中。

因此我有这个代码：

```
 MultipartHttpServletRequest mr = (MultipartHttpServletRequest) ctx.getRequest();
    final MultipartFile f = mr.getFile("datafile");
    final InputStream is = f.getInputStream();
     ...
   jdbc.getJdbcOperations().execute(sql, new PreparedStatementCallback<Integer>() {
     public Integer doInPreparedStatement(final PreparedStatement psInsert) throws SQLException,
                            DataAccessException {
     ...
    psInsert.setCharacterStream(1, new InputStreamReader(is));
    psInsert.executeUpdate();
   }
}); 
```

另外，我尝试过使用 PreparedStatement 的 setClob 和 setAsciiStream 方法，也尝试过[这种](http://helpdesk.objects.com.au/java/getting-abstractmethoderror-when-calling-setbinarystream)方法（设置文件大小），但结果是一样的 -

```
java.lang.AbstractMethodError
    org.apache.commons.dbcp.DelegatingPreparedStatement.setAsciiStream(DelegatingPreparedStatement.java:338)
    org.apache.commons.dbcp.DelegatingPreparedStatement.setAsciiStream(DelegatingPreparedStatement.java:338)
    org.apache.commons.dbcp.DelegatingPreparedStatement.setAsciiStream(DelegatingPreparedStatement.java:338) 
```

底层 InputStream 是 ByteArrayInputStream （如果这可能会有所不同）

PS：该表确实有 CLOB 字段：

```
P_FILE CLOB NOT NULL, 
```

UPD：我实际上还没有尝试过 Oracle 实现的方法。它有效，唯一的问题是，与 PreparedStatement 接口中的方法相比，oracle 驱动程序并未实现所有方法。查看可能的可用方法的类是 OraclePreparedStatement ...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:14:15.177

从[AbstractMethodError javadoc](http://docs.oracle.com/javase/6/docs/api/java/lang/AbstractMethodError.html)：

> 当应用程序尝试调用抽象方法时抛出。通常，这个错误会被编译器捕获；**如果自上次编译当前执行的方法后某些类的定义发生了不兼容的更改，则此错误只会在运行时发生**。

检查以确保您的所有课程都是最新的。我会对您的整个项目进行清理和重建。此外，请确保您的编译时和运行时类路径是等效的（就库版本等而言）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-08T14:59:20.987

[Sormula通过使用](http://www.sormula.org)[TypeTranslator](http://www.sormula.org/javadoc/org/sormula/translator/TypeTranslator.html)可以轻松读取/写入任何类型。请参阅项目中的 org.sormula.examples.blob 包。CLOB 的代码与此类似。

```
public class WidgetTanslator1 implements TypeTranslator<Widget>
{
    public void write(PreparedStatement preparedStatement, int parameterIndex, Widget parameter) throws Exception
    {
        // convert from domain object to bytes
        ByteArrayOutputStream bos = new ByteArrayOutputStream(1000);
        try (ObjectOutputStream oos = new ObjectOutputStream(bos))
        {
            oos.writeObject(parameter);

            // convert bytes to jdbc blob
            preparedStatement.setBlob(parameterIndex, new SerialBlob(bos.toByteArray()));
        }
    }

    public Widget read(ResultSet resultSet, int parameterIndex) throws Exception
    {
        // convert from jdbc blob to bytes to domain object
        Blob blob = resultSet.getBlob(parameterIndex);
        try (ObjectInputStream ois = new ObjectInputStream(new ByteArrayInputStream(blob.getBytes(1, (int)blob.length()))))
        {
            return (Widget)ois.readObject();
        }
    }
} 
```

像这样注释 CLOB 字段：

```
@ImplicitType(translator=WidgetTanslator1.class)
Widget widget; 
```

# objective-c - UIScrollViewDelegate scrollViewWillEndDragging:withVelocity:targetContentOffset: 警告

> ID：12320460
> 
> 赞同：1
> 
> 时间：2012-09-07T14:50:06.367
> 
> 标签：objective-c, ios, uitableview, uiscrollview

我在一个视图控制器上有两个 UITableViews（视图控制器是他们的代表）。其中之一将取决于 scrollViewWillEndDragging:withVelocity:targetContentOffset: （我想做某种自定义分页）。另一个将 pagingEnabled 属性设置为 YES，当我第一次尝试滚动它时，XCode 给了我警告

```
2012-09-07 16:46:39.672 test[17393:707] Stop offset can not be modified for paging scroll views 
```

即使该方法的代码目前是：

```
-(void)scrollViewWillEndDragging:(UIScrollView *)scrollView withVelocity:(CGPoint)velocity targetContentOffset:(inout CGPoint *)targetContentOffset
{
    return;
} 
```

当我删除方法 scrollViewWillEndDragging:withVelocity:targetContentOffset: 一切似乎都很好。我是否需要尝试制作另一个委托（没有该方法）并使用分页委托制作 UITableView，还是我不应该担心？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-29T18:33:13.010

您在控制台中看到此警告的原因是，`scrollViewWillEndDragging:withVelocity:targetContentOffset:`当滚动视图启用分页时，该方法无效。该文档说明了以下内容。

> 当滚动视图的 pagingEnabled 属性值为 YES 时，不会调用此方法。

换句话说，Xcode 会给你一个警告，但是，正如@tiguero 所指出的，最好在每个委托方法中检查哪个表视图（滚动视图）正在发送委托消息。

至于警告，您可以忽略此警告，因为您的控制器是两个表视图的代表，其中一个启用了分页。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T20:04:53.080

我对您在这里要实现的目标感到有些困惑。不过，如果您有相同的视图控制器作为两个 UITableView 的委托，我建议您实现这些委托方法，并通过检查委托方法的参数中传递的 scrollView 变量来检查您正在处理的滚动视图。

# javascript - 从 jsf / primefaces 将文本复制到剪贴板

> ID：12320462
> 
> 赞同：1
> 
> 时间：2012-09-07T14:50:06.923
> 
> 标签：javascript, jsf, jsf-2, clipboard, zeroclipboard

我正在使用[https://github.com/patricklodder/jquery-zclip](https://github.com/patricklodder/jquery-zclip)来实现复制到剪贴板功能。它应该复制一些文本，但现在我希望它真的是……但它根本不起作用。

我包括在头：

```
<h:outputScript name="js/jquery.zclip.min.js" library="test" />

        <script>
            $(document).ready(function(){
                $('a#copy').zclip({
                    path:'#{resource['/test/js/ZeroClipboard.swf']}',
                    copy:$('div#content').text()
                });
            });                
        </script> 
```

在 JSF 页面中我有一个普通的：

```
<a href="#" id="copy">COPY</a> 
```

Chrome 控制台中没有错误，但单击该链接也无济于事。我真的不知道为什么它不起作用。非常感谢您的任何建议。

- - - - - 编辑

数据网格：

```
<p:dataGrid var="item" columns="3" rows="9" value="#{pictureManagementBean.pictures}" id="gallery" paginator="true">  

<p:column>
    <p:panel header="#{item.pictureName}" style="text-align:center; width:230px;">  
         <h:panelGrid styleClass="shortLink"> 
             <p:graphicImage value="#{item.thumbnailDir}" width="200px" />                             
             <a href="#" id="copy#{item.idpicture}">COPY</a>   
             <p id="copy#{item.idpicture}">LOREM IPSUM</p>
             <p:commandLink value="Delete" action="#pictureManagementBean.removePicture(item.idpicture)}" update="@form"/>

</h:panelGrid></p:panel></p:column></p:dataGrid> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T18:45:12.323

这对我有用：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"  
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core" xmlns:h="http://java.sun.com/jsf/html">
   <h:head>
   </h:head>
   <h:body>
         <h:outputScript library="default" name="js/jquery-1.8.1.min.js"/>
         <h:outputScript library="default" name="js/jquery.zclip.min.js"/>
         <script type="text/javascript">
         $(document).ready(function(){

                $('a#copy-description').zclip({
                    path:"#{resource['default:js/ZeroClipboard.swf']}",
                    copy:$('p#description').text()
                });
         });
         </script>
         <a id="copy-description" href="#">Copy Description</a>
         <p id="description">
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque volutpat venenatis erat 
            eu convallis. Phasellus ut purus dui, in tristique ligula. Fusce a sodales ipsum.
            Proin et commodo lacus. Morbi eget lectus ante, sed interdum orci.
            Nunc rutrum, enim in mattis bibendum, sapien ligula semper nisi, sed ullamcorper justo sem quis felis.
            Duis vehicula arcu non felis convallis eleifend.
         </p>
   </h:body>
</html> 
```

文件夹结构是这样的：

```
-->resources/default/js/jquery.zclip.min.js
-->resources/default/js/ZeroClipboard.swf 
```

# jquery - jQuery CORS 内容类型选项

> ID：12320467
> 
> 赞同：51
> 
> 时间：2012-09-07T14:50:18.800
> 
> 标签：jquery, ajax, cors

我在使用带有自定义内容类型的 jQuery CORS 发送 AJAX 正文请求时遇到问题。这是我的代码：

```
$.ajax({
  url: "http://some-other-domain/my-path",
  type: "POST",
  contentType: "application/json",
  dataType: "json",
  data: JSON.stringify({
    key: 1,
    key2: 2
  }),
  statusCode: {
    200: function(data) {
    }
  },
  xhrFields: {
    withCredentials: true
  },
  crossDomain: true
}); 
```

我需要将 Content-type 设置为“application/json”，因为它需要服务器端。但不是以 POST 的形式发送请求，而是 jQuery 将其作为 OPTIONS 发送。

这是一个标题：

响应标头：

```
HTTP/1.1 200 OK
Server: Apache-Coyote/1.1
Pragma: No-cache
Cache-Control: no-cache
Expires: Thu, 01 Jan 1970 03:00:00 EET
Set-Cookie: JSESSIONID=BB9D6783E58FB0F2ADE1924A2F0CBA52; Path=/
Content-Type: text/html;charset=UTF-8
Content-Length: 6233
Date: Fri, 07 Sep 2012 14:41:13 GMT 
```

请求标头：

```
OPTIONS /my-path HTTP/1.1
Host: MY-HOME-NAME
User-Agent: MY_USER_AGEMT
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-us,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: keep-alive
Origin: HERE-GOES-DOMAIN
Access-Control-Request-Method: POST
Access-Control-Request-Headers: content-type
Pragma: no-cache
Cache-Control: no-cache 
```

CORS 效果很好，所有必需的标头都是由服务器发送的，但如果它是通过 OPTIONS 类型发送的，则不是。是 jQuery 的问题吗？

jQuery - 1.8.1

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2012-09-07T15:06:38.323

此 OPTIONS 请求是 CORS 预检请求。它是在实际请求之前发送到服务器的请求，以请求发出请求的权限。自定义 Content-Type 实际上触发了预检。根据 CORS 规范 ( [http://www.w3.org/TR/cors/](http://www.w3.org/TR/cors/) )，除 application/x-www-form-urlencoded、multipart/form-data 或 text/plain 之外的*任何*Content-Type 都会触发预检。

如果您无法控制远程服务器，那么您需要让他们支持 CORS 预检，或者尝试其他一些选项，例如 JSON-P。

如果您确实可以控制远程服务器，则可以将其更改为处理预检。为了处理预检请求，您应该在对 OPTIONS 请求的响应中发送以下标头：

```
Access-Control-Allow-Origin: *
Access-Control-Allow-Methods: POST
Access-Control-Allow-Headers: Content-Type 
```

响应应该是 HTTP 200。`Access-Control-Allow-Methods`响应标头可以回显 的值`Access-Control-Request-Method`，也可以只是`GET, POST, PUT, DELETE`支持所有方法。`Access-Control-Allow-Headers`响应标头应回显`Access-Control-Request-Headers`请求标头中的值。

一旦浏览器收到这些标头，它就会发出实际的请求。您可以在此处了解有关 CORS 预检请求的更多信息：

[http://www.html5rocks.com/en/tutorials/cors/](http://www.html5rocks.com/en/tutorials/cors/)

# python - Python列表中的条件

> ID：12320469
> 
> 赞同：-1
> 
> 时间：2012-09-07T14:50:22.637
> 
> 标签：python

目前，我的循环中有一个新列表，在大多数情况下，它会创建一个新列表，其中包含原始列表 x 的几乎所有元素。但是，我正在创建一个条件，仅当满足条件 x[5] 时才会增加 xnew 的特定索引。是否有更清洁的方法来执行以下操作？：

```
for x in data:
  xnew = [x[1],x[2],x[3],x[4],0,0,0]
  if(x[5]==2):
    xnew[4] = x[8] 
  elif(x[5]==9):
    xnew[5] = x[8] 
  else:
    xnew[6] = x[8] 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-07T14:54:44.870

```
xmap = {2: 4, 9: 5}

 ...

xnew[xmap.get(x[5], 6)] = x[8] 
```

# database - oracle多用户功能

> ID：12320470
> 
> 赞同：1
> 
> 时间：2012-09-07T14:50:24.790
> 
> 标签：database, oracle, function

如何创建可以从不同用户处使用的功能？它必须像内置的 oracle 函数一样工作，可以从任何用户调用。我想这可以通过授予一些特权来实现..？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T15:28:34.473

这应该针对特定用户执行此操作：

```
GRANT EXECUTE ON your_function TO some_user; 
```

您可以通过这种方式允许所有用户访问：

```
GRANT EXECUTE ON your_function TO PUBLIC; 
```

要从另一个用户帐户引用此函数，请执行以下操作：

```
SELECT owner.your_function FROM dual; 
```

如果您想避免在函数引用中指定拥有模式，请为其创建一个公共同义词：

```
CREATE PUBLIC SYNONYM your_function FOR owner.your_function; 
```

然后任何人都可以通过这种方式引用该函数：

```
SELECT your_function FROM dual; 
```

# python - 优化 Django

> ID：12320472
> 
> 赞同：0
> 
> 时间：2012-09-07T14:50:33.070
> 
> 标签：python, mysql, django, debugging, design-patterns

我对页面加载速度有疑问。

现在加载页面大约需要 7 秒，而 2~3 秒是 Django 处理。

明显的原因是我缺乏架构知识，平均执行 50 个查询，如访问页面时“Django 调试工具栏”所示，但大多数查询类似于“昨天的快照（按某事分组）”或“昨天之前的每日快照（按某事分组）”并且不必每次都更新。

我想出使用内存缓存或为准备可能类型的数据创建新表的想法。

此类问题是否有任何约定或设计模式？

示例查询是这些（我相信他们不能每次都查询昨天的数据或上个月的数据）：

```
SELECT `sample_salestarget`.`id`, `sample_salestarget`.`country_id`,                    `sample_salestarget`.`year`, `sample_salestarget`.`month`, `sample_salestarget`.`sales`  FROM `sample_salestarget` WHERE (`sample_salestarget`.`country_id` = "abc" AND `sample_salestarget`.`month` = 8 AND `sample_salestarget`.`year` = 2012 )

SELECT `sample_dailysummary`.`id`, `sample_dailysummary`.`country_id`, `sample_dailysummary`.`date`, `sample_dailysummary`.`pv_day`, `sample_dailysummary`.`pv_week`, `sample_dailysummary`.`pv_month`, `sample_dailysummary`.`active_uu_day`, `sample_dailysummary`.`active_uu_week`, `sample_dailysummary`.`active_uu_month`, `sample_dailysummary`.`active_uu_7days`, `sample_dailysummary`.`active_uu_30days`, `sample_dailysummary`.`paid_uu_day`, `sample_dailysummary`.`paid_uu_week`, `sample_dailysummary`.`paid_uu_month`, `sample_dailysummary`.`sales_day`, `sample_dailysummary`.`sales_week`, `sample_dailysummary`.`sales_month`, `sample_dailysummary`.`register_uu_day`, `sample_dailysummary`.`register_uu_week`, `sample_dailysummary`.`register_uu_month`, `sample_dailysummary`.`pay_count_day`, `sample_dailysummary`.`pay_count_week`, `sample_dailysummary`.`pay_count_month`, `sample_dailysummary`.`total_user`, `sample_dailysummary`.`inv_access_uu`, `sample_dailysummary`.`inv_sender_uu`, `sample_dailysummary`.`inv_accepted_uu`, `sample_dailysummary`.`inv_send_count`, `sample_dailysummary`.`memo`, `sample_dailysummary`.`first_charge_uu` FROM `sample_dailysummary` WHERE `sample_dailysummary`.`date` = 2012-09-07 AND `sample_dailysummary`.`country_id` = "abc" ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:45:11.440

如果这是一个要暴露在互联网上的生产应用程序，并且您不能减少您进行的查询数量，那么您至少应该重用答案，我建议使用 django 的内置数据库缓存将数据库结果存储在 ram 中内存缓存。如果这是一个本地应用程序，那么我建议使用 django 的基于 ram 的缓存。这样做的原因是 memcached 能够比 django 扩展得更远，但是 django 需要很少的设置

[为 Django 缓存](https://docs.djangoproject.com/en/dev/topics/cache/?from=olddocs "Django缓存")

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T16:02:45.093

使用[Memcached](https://docs.djangoproject.com/en/dev/topics/cache/?from=olddocs#memcached)确实可以为您加快速度。但是，这确实带来了问题。您必须在动态页面上格外小心，在需要时显式地使缓存无效。

与 Memcached 一起，尝试使用[johnny-cache](http://packages.python.org/johnny-cache/)，它在缓存 django ORM 查询方面做得非常好

另外，尽可能使用[Django 的会话变量。](https://docs.djangoproject.com/en/dev/topics/http/sessions/)（如果您使用 Memcached，请尝试使用 cached_db 会话引擎。）您可以保存在整个会话期间保持一致的对象（例如您的用户配置文件设置）。这样，您将再次减少 sql 调用的数量。

如果你真的需要快速页面加载。也许尝试加载你的页面，然后使用[Celery](http://celeryproject.org/)异步调用你的 sql 语句并以 AJAXy 方式加载你的结果。

# iphone - 保留 UITableView 中的条目

> ID：12320473
> 
> 赞同：0
> 
> 时间：2012-09-07T14:50:34.087
> 
> 标签：iphone, ios, xcode, uitableview

我有以下（视图）控制器排列：

一个uitableview——（嵌入）——>导航控制器——（嵌入）——>标签栏控制器——（模态segue to）——>视图中的按钮（uiviewcontroller）。

我的问题描述：

带有按钮的视图是我的应用程序的初始视图。按下此按钮会导致标签栏中的表格视图。一开始表格视图是空的，但您可以手动在单元格上添加信息，例如名称。但是，一旦您返回初始视图（带有按钮）并再次按下按钮，表格视图中的先前条目将被删除。有人可以提示如何使用给定的排列保留这些条目。非常感谢您提前。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T14:59:46.080

这是一个相当大的问题，因为它实际上与界面本身无关。它更多地与一般的面向对象编程和对象的生命周期有关。

基本上，您的数据需要存储在对象层次结构的更高层。它需要在接口对象的构造/销毁中持续存在。这也可以通过将数据存储在可持久存储的数据存储中来完成，例如数据库或文件，但您仍然需要存储从存储中提取数据或数据子集的方法。

如果您希望保留数据，您可以将数据存储在单例数据类中并静态引用它或将其存储在您的 UIApplication 对象中，并在创建每个对象时将其传递到层次结构中。您可能必须对每个对象进行子类化并添加一个新的构造函数，将 ref 传递给数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:01:06.677

您可以使用单例模式。它将创建您的对象的共享实例，您可以在任何地方访问它。然后，当用户在表中添加一行时，您将能够写入它，并在您来到 tableView 时读取它。

这里有一点帮助：[单例模式](http://maniacdev.com/2009/07/global-variables-in-iphone-objective-c/)

**编辑：**您也可以使用核心数据，但它可能不适合您的情况（网络上有大量关于该数据的文档）

# asp.net - IIS 6 不显示默认文档 (default.aspx)

> ID：12320478
> 
> 赞同：4
> 
> 时间：2012-09-07T14:50:47.050
> 
> 标签：asp.net, iis, iis-6

我们有一个问题，即 IIS 不再提供在以前工作正常的服务器上查找默认文档 (default.aspx) 的服务。我们没有自觉地改变机器的配置。

症状是，如果您转到计算机上应用程序的根目录，它会显示 asp.net 404 not found 页面，其中包含以下文本：

> 无法找到该资源。
> 
> 描述：HTTP 404。[等...]
> 
> 请求的 URL：**/folder/eurl.axd/dd4414e526108f45a561b782d54f3ba2/**

我不知道 eurl.axd 是什么，但它似乎是指对 ASP.NET 4.0 的无扩展 URL 支持，但有问题的站点都是 ASP.NET 2.0 站点。

Default.aspx 绝对被设置为站点的默认文档（并且位于列表的顶部）。

如果我手动输入 /folder/default.aspx ，则该站点可以正常工作，因此提供页面不是问题，而仅仅是 IIS 本身没有默认为该页面的问题。

任何解决此问题的想法将不胜感激，因为这会影响实时服务器:(

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-07T15:41:21.077

好的，我现在已经解决了。看来确实是因为 ASP.NET 4.0 的无扩展 URL 支持特性。尽管我的站点正在运行 .NET 2.0 站点，但它似乎仍然会影响它们（可能是因为 URL 过滤发生在更高的位置？）。我禁用了无扩展 URL 支持（请参阅链接），现在它可以找到 default.aspx 页面了。

有关更多信息，请查看这篇文章：http: [//blogs.msdn.com/b/tmarq/archive/2010/06/18/how-to-disable-the-asp-net-v4-0-extensionless-url -feature-on-iis-6-0.aspx](http://blogs.msdn.com/b/tmarq/archive/2010/06/18/how-to-disable-the-asp-net-v4-0-extensionless-url-feature-on-iis-6-0.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-18T06:07:18.473

```
To install and enable ASP.NET:
1> Click Start, and then click Control Panel.
2> Click Add or Remove Programs.
3> Click Add/Remove Windows components.
4> Double-click Application Server, and then click Details.
5> Click to select the ASP.NET check box, and then click OK.
6> Click Next.
7> Click Finish. 
```

# php - CakePHP 长 sql 查询

> ID：12320489
> 
> 赞同：0
> 
> 时间：2012-09-07T14:51:28.253
> 
> 标签：php, mysql, cakephp

我的基于 CakePHP 框架的项目适用于 MySQL DB。有时会运行很长的 sql 查询。在此查询期间，我无法在我的项目中加载任何页面。但是当我在 Adminer（轻量级 PhpMyAdmin）中执行这个 SQL 查询时，我可以从 DB 中加载任何页面和任何选择。你能帮我配置一下吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:16:17.177

您提到有问题的查询是：

```
select a.* from table_b b inner join table_a a on b.id = a.b_id where b.some_field = 'some text' 
```

您需要确保以下字段有索引：

```
b.id
a.b_id
b.some_field 
```

# asp.net-mvc - MVC 允许匿名，登录时仍然获取当前用户

> ID：12320504
> 
> 赞同：2
> 
> 时间：2012-09-07T14:52:07.983
> 
> 标签：asp.net-mvc, authentication, subdomain, asp.net-mvc-routing

我的 MVC 4.0/Razor 站点有问题。

这是我最近继承的（尚未启动的）公共网站。所有页面的 90% 应该可供所有人使用，其余页面供超级用户使用，需要身份验证。

这是通过面向公众的页面上的 AllowAnonymous 属性处理的，实现方式如下；

```
public class RequireAuthenticationAttribute : AuthorizeAttribute
{
    public override void OnAuthorization(AuthorizationContext filterContext)
    {
        var skipAuthorization = filterContext.ActionDescriptor.IsDefined(typeof(AllowAnonymousAttribute), true) ||
                                filterContext.ActionDescriptor.ControllerDescriptor.IsDefined(
                                    typeof(AllowAnonymousAttribute), true);
        if (!skipAuthorization)
            base.OnAuthorization(filterContext);

    }
} 
```

现在，问题是我想要一些面向公众的网站的自定义（为了争论，让我们假设某个地方有一个“当前登录：XYZ”标签）。我尝试的是使用 User.Identity，但在所有使用 AllowAnonymous、User.Identity.Name == "" 的页面上，即使超级用户确实登录了。（如果他将 url 更改为*具有*身份验证的页面，他再次登录，并且 User.Identity.Name 是正确的）。

有没有办法既使用允许匿名又跟踪谁登录？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T13:39:09.977

我想我已经解决了这个问题。

问题是我们的自定义子域路由。我不得不覆盖“域”设置，所以它指向`.example.com`而不是`example.com`cookie（主要是 aspxauth）。

这需要一些时间来实现的原因是许多其他定制部件，可能会干扰应用程序，尤其是：

*   自定义会员提供者
*   自定义 AllowAnonymous 属性（即使现在有标准属性）
*   事实上，我认为这是正常行为，而实际上并非如此。

摘要：如果实施子域路由规则并且需要沿子域进行身份验证，则必须更改 cookie 的基域。

# asp.net - WCF 服务对用户进行身份验证（.NET 成员资格）

> ID：12320514
> 
> 赞同：0
> 
> 时间：2012-09-07T14:52:56.103
> 
> 标签：asp.net, .net, asp.net-membership

我下午的大部分时间都在这个主题上环顾四周，但仍然没有看到这样做的标准方法。

我真的想要一个连接到.NET 会员系统的 WCF 服务，以便由.NET 站点调用（可能不止一个，因此服务） - 应该很容易，对吧？所以...

.NET 站点 ----> WCF 服务（针对 .NET 成员身份进行身份验证）----> .NET 站点

我已经在 IIS 上设置了我的 SSL，并且我完全了解 WCF / .NET 成员资格，但我的问题是将 WCF 服务链接到客户端站点，他们如何真正了解彼此以及 WCF 服务如何认可会员服务？

我看过：

[http://msdn.microsoft.com/en-us/library/bb398990.aspx](http://msdn.microsoft.com/en-us/library/bb398990.aspx)

这经历了我认为我所追求的过程 - 但是在该示例中没有真正制作连接字符串，或者对实际成员资格表的任何引用。此外，没有关于客户端站点如何被服务授权的示例。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:18:31.893

如果我的评论是答案，则会将其作为答案发布。

托管服务的网站必须实现会员服务。

[将 ASP.NET 应用程序配置为使用成员资格](http://msdn.microsoft.com/en-us/library/6e9y4s5t.aspx)

# oracle - 在 Oracle Reports 10g 中更改日期格式

> ID：12320518
> 
> 赞同：1
> 
> 时间：2012-09-07T14:53:24.153
> 
> 标签：oracle, oracle10g, report

我有一份报告要求 BeginDate 和 EndDate 参数的格式为 DD-MON-YYYY。在报表表头中，要求 BeginDate 和 EndDate 参数以 MM/DD/YYYY 格式显示。我尝试添加另一个开始和结束参数，并使用输入掩码和格式掩码尝试转换它，但报告中断。有人有任何线索吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:01:58.660

您可以使用[TO_CHAR](http://www.techonthenet.com/oracle/functions/to_char.php)来格式化您的日期。

要根据您的格式更改日期，即 DD-MON-YYYY，您可以这样做：

```
TO_CHAR(col_name,'DD-MON-YYYY') 
```

查看**[SQLFIDDLE](http://sqlfiddle.com/#!4/9636a/2)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T15:48:53.077

我假设您有带有输入掩码的用户参数，如下所示 -

![在此处输入图像描述](../Images/9ce7594b39632de611f7e892317f43cf.png)

在报告中你可以有类似的东西

```
SELECT TO_CHAR(:P_1,'MM/DD/RR') from dual; 
```

对于`BeginDate`和`EndDate`。

# java - 如何将 swing JTextField 组件转换为扩展它的类型的对象

> ID：12320519
> 
> 赞同：1
> 
> 时间：2012-09-07T14:53:30.137
> 
> 标签：java, swing, inheritance, jtextfield, mouse-listeners

我有一个使用第三方程序包的应用程序，该程序包有一个工厂，它返回给我的 JTextField 对象，然后添加到 GUI 中。这占使用的 JTextField 的大约 10%。

我无法更改第三方包，但需要在所有字段中添加右键单击（剪切、复制和粘贴）选项。

现在我有一个 RightClickTextField，它扩展了 JTextField 并内置了所有功能，这可以解决我 90% 的应用程序的问题。

但是对于使用第三方包获取 JTextFields 的 10%，我想不出一个解决方案，可以让我将字段声明为 RightClickTextFields 但使用工厂，我必须取回盒子。我知道我无法转换结果，因为返回的对象不是层次结构中较高的类型，并且复制构造函数将不起作用，因为我无法复制工厂设置的每个属性，但我不知道一种将 JTextField 向上转换为我的类型的方法。有吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:02:07.860

您是否可以将右键单击功能放入实现[MouseInputListener 接口](http://docs.oracle.com/javase/7/docs/api/javax/swing/event/MouseInputListener.html)的自己的类中，而不是子类化或尝试转换它，并简单地将右键单击处理程序的实例添加到相关的 JTextField 对象？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T15:30:32.667

也许使用[装饰器模式](http://en.wikipedia.org/wiki/Decorator_pattern)。这样您就可以完全停止使用`RightClickTextField`- 开始使用`RightClickTextFieldDecorator`并提供您自己`JTextField`的 s 或您从 3rd 方获得的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T12:01:35.800

感谢所有的评论。我认为我的问题的实际答案是：

你不能。

虽然所有建议都是有效的，但我知道可以做所有这些事情，我只是想知道我是否可以先按照自己的方式去做。

我的解决方案（基于此处的反馈和我自己的偏好）是在下面创建此类，并从单例中管理和公开它的单个实例。

我很感激对这个解决方案的想法？

```
import java.awt.Component;
import java.awt.Dimension;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import java.util.HashMap;
import java.util.Map;

import javax.swing.JMenuItem;
import javax.swing.JPopupMenu;
import javax.swing.text.JTextComponent;

public class CopyPasteTextComponentPopoupMenu extends JPopupMenu implements
    ActionListener {

private JTextComponent lastInvoker;
private JMenuItem cutMenuItem;
private JMenuItem copyMenuItem;
private JMenuItem pasteMenuItem;

private Map<JTextComponent, JTCProperties> managedComponents;

private MouseListener heyListen;

public CopyPasteTextComponentPopoupMenu() {
    super();
    init();
}

public CopyPasteTextComponentPopoupMenu(String label) {
    super(label);
    init();
}

@Override
public void show(Component invoker, int x, int y) {

    JTCProperties props = managedComponents.get(invoker);
    if(props!=null) {
        this.lastInvoker = (JTextComponent) invoker;
        setEnabled(props);
        super.show(invoker, x, y);
    } else {
        this.lastInvoker = null;
    }
}

public void manageTextComponent(JTextComponent jtc, boolean canCut,
        boolean canCopy, boolean canPaste) {

    jtc.addMouseListener(heyListen);

    JTCProperties props = new JTCProperties(canCut,canCopy,canPaste);
    managedComponents.put(jtc,props);

}

public void dispose() {
    for (JTextComponent component : managedComponents.keySet()) {
        component.removeMouseListener(heyListen);
        managedComponents.remove(component);
    }
}

@Override
public void actionPerformed(ActionEvent e) {
    if (lastInvoker != null) {
        if (e.getSource() == cutMenuItem) {
            lastInvoker.cut();
        } else if (e.getSource() == copyMenuItem) {
            lastInvoker.copy();
        } else if (e.getSource() == pasteMenuItem) {
            lastInvoker.paste();
        }
    }
}

private void setEnabled(JTCProperties props) {
    cutMenuItem.setEnabled(props.canCut);
    copyMenuItem.setEnabled(props.canCopy);
    pasteMenuItem.setEnabled(props.canPaste);
}

private void init() {
    this.managedComponents = new HashMap<JTextComponent, JTCProperties>();
    this.setPreferredSize(new Dimension(100, 70));
    cutMenuItem = new JMenuItem("Cut");
    copyMenuItem = new JMenuItem("Copy");
    pasteMenuItem = new JMenuItem("Paste");

    cutMenuItem.addActionListener(this);
    copyMenuItem.addActionListener(this);
    pasteMenuItem.addActionListener(this);

    this.add(cutMenuItem);
    this.add(copyMenuItem);
    this.add(pasteMenuItem);

    heyListen = new MouseAdapter() {
        public void mousePressed(MouseEvent e) {
            if (e.isPopupTrigger()) {
                show(e.getComponent(), e.getX(), e.getY());
            }
        }

        public void mouseReleased(MouseEvent e) {
            if (e.isPopupTrigger()) {
                show(e.getComponent(), e.getX(), e.getY());
            }
        }
    };
}

private class JTCProperties {
    public boolean canCut, canCopy, canPaste;

    public JTCProperties(boolean canCut, boolean canCopy, boolean canPaste) {
        this.canCut = canCut;
        this.canCopy = canCopy;
        this.canPaste = canPaste;
    }
} 
```

}

# c# - 在整数值上搜索子字符串

> ID：12320520
> 
> 赞同：0
> 
> 时间：2012-09-07T14:53:38.653
> 
> 标签：c#, mongodb, 10gen-csharp-driver

假设我们有一个 mongodb 集合，其中的元素包含一个 int 属性值，例如： {"MyCollectionAttribute": 12345}

如何使用`Query<T>.`语法在 int 中搜索字符串“234”？

现在它似乎工作（如解释[here](https://stackoverflow.com/questions/2908100/mongodb-regex-search-on-integer-value)）使用原始查询，如：

```
var query = new QueryDocument("$where", "/234/.test(this.MyCollectionAttribute)");
myCollection.Find(query); 
```

是否最好将值直接存储为字符串而不是整数，因为正则表达式匹配会很慢？你如何处理这些情况？

**编辑**

上下文：公司可以有一些内部代码是数字。在 sql server 中，它们可以存储为 int 类型的列，以便在数据库级别具有数据完整性，然后使用以下内容从 linq 查询到 sql：

```
.where(item => item.CompanyCode.ToString().Contains("234")) 
```

这样，数据库级别的数据完整性和查询的类型安全。

我问这个问题是为了看看如何使用 mongodb 来实现这个场景。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:20:14.567

你问什么没有多大意义。

正则表达式用于在*字符串*内而不是在*整数*内搜索。

如果您想执行子字符串搜索（无论出于何种原因），那么将您的数字存储为字符串而不是整数 - 显然。

# file - 简单的 Bash - for f in *

> ID：12320521
> 
> 赞同：9
> 
> 时间：2012-09-07T14:53:46.073
> 
> 标签：file, bash, loops, for-loop

考虑这个简单的循环：

```
for f in *.{text,txt}; do echo $f; done 
```

我只想回显有效的文件名。在脚本中使用 $f 变量一切正常，除非没有该扩展名的任何文件。在空集的情况下， $f 设置为 *.text 并且上面的行回显：

```
*.text
*.txt 
```

而不是什么都不回应。如果您尝试将 $f 用于任何需要实际真实文件名的东西，而不是得到 *.

如果有任何文件与通配符匹配，因此它不是一个空集，一切都会按我的意愿工作。例如

```
123.text
456.txt
789.txt 
```

我怎样才能做到这一点而不会出现错误，并且第一个字符串与 $f 匹配星号的看似过于复杂？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-07T14:59:47.797

设置`nullglob`选项。

```
$ for f in *.foo ; do echo "$f" ; done
*.foo
$ shopt -s nullglob
$ for f in *.foo ; do echo "$f" ; done
$ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-07T14:56:42.840

您可以测试该文件是否确实存在：

```
for f in *.{text,txt}; do if [ -f $f ]; then echo $f; fi; done 
```

或者您可以使用以下`find`命令：

```
for f in $(find -name '*.text' -o -name '*.txt'); do
  echo $f
done 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T14:58:09.607

此外，如果您负担得起 的外部使用`ls`，您可以通过使用来逃避其结果

```
for f in `ls *.txt *.text`; 
```

# jquery - 出现“正在加载”消息时，我可以更改 JQGrid 的光标和/或背景颜色吗？

> ID：12320525
> 
> 赞同：0
> 
> 时间：2012-09-07T14:54:12.947
> 
> 标签：jquery, jqgrid

当我的 jqgrid 正在“加载”时（最初，在列排序之后，或者当用户单击刷新按钮时）我可以更改光标或网格的背景颜色吗？用户可以看到“正在加载”消息，但有时该消息在网格下方太远而无法非常明显。

谢谢你的帮助。如果您指出正确的资源，我完全愿意阅读此内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T16:01:01.167

您可以使用该选项

```
loadui: "block" 
```

这将显示具有类`"ui-widget-overlay"`和`"jqgrid-overlay"`整个网格的叠加*层。*除了文本“Loading...”（文本在 中定义`$.jgrid.defaults.loadtext`）之外，它还会显示叠加层。覆盖的背景以您使用的 jQuery UI 样式定义。因此用户会清楚地看到加载的通知，并且在加载过程中网格的所有控件都将被阻止。如果您想自定义叠加层的背景，您可以在[Themeroller](http://jqueryui.com/themeroller)中执行此操作（请参阅“叠加层屏幕”部分）。

我建议您另外阅读[答案，该答案](https://stackoverflow.com/a/8778241/315935)显示如何将“正在加载...”文本的位置更改为屏幕的*可见*部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T14:55:52.993

是的你可以。只需覆盖样式：

```
.ui-jqgrid .loading { cursor: wait; } 
```

# visual-studio-2010 - 修改基础文件后，如何以编程方式刷新/重新加载 VS 项目？

> ID：12320527
> 
> 赞同：9
> 
> 时间：2012-09-07T14:54:25.423
> 
> 标签：visual-studio-2010, visual-studio, vsx, vsix, vspackage

我正在开发一个 Visual Studio 包，并且我编写了一些代码，这些代码将使解决方案资源管理器中的一个文件依赖于另一个文件。

这意味着它赋予它们与代码隐藏文件或设计器文件相同的关系，它们以加号/减号图标嵌套在父文件下。

```
+ MainForm.cs

- MainForm.cs
   MainForm.Designer.cs
   MainForm.resx 
```

我成功编写的代码正确地修改了基础项目文件，但是在项目关闭并重新打开之前，更改不会反映在解决方案资源管理器中。

我正在寻找一些将刷新或重新加载项目的代码，以便立即在解决方案资源管理器中看到更改。

更多信息...

这是演示我创建依赖文件的机制的 sudo 代码。

```
IVsBuildPropertyStorage vsBuildPropertyStorage = GetBuildPropertyStorage();
vsBuildPropertyStorage.SetItemAttribute(projectItemIdentifier, "DependentUpon", parentFileName); 
```

我也尝试添加它以尝试重新加载项目，但它没有任何效果。

```
project.Save();
VSProject obj = project.Object as VSProject;
obj.Refresh(); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-08T05:32:32.100

AFAIK 这样做的唯一方法是通过解决方案资源管理器工具窗口的自动化：

```
EnvDTE.DTE dte = ...;

string solutionName = Path.GetFileNameWithoutExtension(dte.Solution.FullName);
string projectName = project.Name;

dte.Windows.Item(EnvDTE.Constants.vsWindowKindSolutionExplorer).Activate();
((DTE2)dte).ToolWindows.SolutionExplorer.GetItem(solutionName + @"\" + projectName).Select(vsUISelectionType.vsUISelectionTypeSelect);

dte.ExecuteCommand("Project.UnloadProject");
dte.ExecuteCommand("Project.ReloadProject"); 
```

请注意，如果项目尚未保存，用户将在“Project.UnloadProject”调用之前获得一个对话框。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-04-08T09:40:37.180

这是我的代码（重新激活旧窗口）：

```
public void RefreshSolutionExplorer(EnvDTE.Project activeProject, string captionOfActiveWindow)
{
  DTE2 dte2 = activeProject.DTE as DTE2;
  string solutionName = Path.GetFileNameWithoutExtension(dte2.Solution.FullName);
  string projectName = activeProject.Name;

  // Activate SolutionExplorer window
  dte2.Windows.Item(Constants.vsWindowKindSolutionExplorer).Activate();
  // Select your project to be updated
  dte2.ToolWindows.SolutionExplorer.GetItem(solutionName + @"\" + projectName).Select(vsUISelectionType.vsUISelectionTypeSelect);
  // Refresh SolutionExplorer window
  dte2.ExecuteCommand("View.Refresh", String.Empty);
  // Reactivate your old window
  dte2.Windows.Item(captionOfActiveWindow).Activate();
} 
```

# c# - 将exe与网页通信

> ID：12320530
> 
> 赞同：0
> 
> 时间：2012-09-07T14:54:46.350
> 
> 标签：c#, exe

我创建了一个用户下载的工具，它从用户系统收集一些信息。我需要在网页上显示该信息。我可以通过调用 webservice 将其从 exe 插入数据库。除了将这些信息从 exe 推送到网页之外，还有其他方法吗？在这种情况下，我必须将信息存储到数据库中。还有其他方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T14:56:25.947

> 除了将这些信息从 exe 推送到网页之外，还有其他方法吗？

是和否。是的，因为您可以创建一个套接字连接，例如，并流式传输数据。不，因为 Web 服务是最好的方法。

# javascript - 使用 jQuery 的 html 表格可编辑和不可编辑单元格

> ID：12320532
> 
> 赞同：0
> 
> 时间：2012-09-07T14:54:51.913
> 
> 标签：javascript, jquery, html-table

是否有插件或方法可以使某些表列（不是行）可编辑而其他不可使用 jQuery 编辑？

我已经看到用于单击单元格以使其可编辑的插件，但我的意思是明确地使单元格/列可编辑或不可编辑。我有办法做到这一点，但感觉有点像黑客工作。

这是使列可编辑的功能：

```
function isEditable(rowArray, headersArray)
{
    var counter = 0;
    var notEditable = ['product code', 'product'];
    for(i in rowArray){
        counter = 0;
        data = headersArray[i].toLowerCase();
        for(a in notEditable){
            if(data == notEditable[a]){
                counter++;
            }
        }
        if(counter > 0){
            rowArray[i] += 'notEditable';
        }
    }
    return rowArray;
} 
```

它将单元格的标题与预定义值数组进行比较，该数组=不可编辑的列。

然后我建立行：

```
function buildHTMLTableRow(row, mutable)
{       
    output = '';
    output += '<tr>';
    for(var i = 0; i < row.length; i++)
    {
        value = trim(row[i]);
        if(mutable){
            index = value.indexOf('notEditable');
            if(index != -1){
                value = value.substring(0, index);
                output += '<td>' + value + '</td>';
            }
            else{
                output += '<td><input size="5" type="text" value="' + value + '" /></td>';
            }
        }
        else{
            output += '<td>' + value + '</td>';
        }
    }
    output += '</tr>';
    return output;
} 
```

参数决定该`mutable`行是否可编辑，并`indexOf('noteditable')`决定函数中的单元格（但几乎是列）`isEditable`。

有没有更好的插件，或者我应该解决我所拥有的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T16:16:55.180

访问这个 jsFiddle 链接：[禁用列](http://jsfiddle.net/hunTQ/)

以下是数据流：

1.  我创建了一个名为“rowsD”的行数组。当页面加载时，我正在用这些行填充我的表 (id=myData)。
2.  现在创建另一个名为**disableHeaders**的数组，其中我正在传递标题，您需要禁用整个列。
3.  我正在调用函数**disableFields**传递**disableHeaders**作为参数
4.  在函数中，首先我获取标头的索引，其值等于**标头**数组中的值
5.  如果我找到一个，那么从**Input**标签中我使用 $(this).find('input') 选择器提取**Value属性**
6.  最后我用**标签**标签替换当前的孩子，传递提取的输入标签值
7.  你也可以注释掉 disableFields(disableHeaders); 实际看到的行，表格最初是如何呈现的

谢谢

# c - massif 工具能否在多线程应用程序中正常工作？

> ID：12320533
> 
> 赞同：2
> 
> 时间：2012-09-07T14:55:04.447
> 
> 标签：c, multithreading, memory-management, valgrind, massif

我正在开发一个多线程应用程序，它似乎在运行期间分配了大量内存。所有内存都在执行结束时被释放，因此 valgrind 没有显示内存泄漏。我尝试使用 massif 工具找出发生了什么，但 ms_print 似乎只显示有关主线程的信息。但是，我相信绝大多数内存是在子线程中分配的。是否可以让地块显示有关它们的信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T05:23:51.607

对我（Ubuntu 12.04）来说，这似乎默认工作。就像在您的应用程序中一样，我的主线程不做任何事情（除了处理我的基于 gtk 的 UI），并且所有（取消）分配都在子线程中完成。

我最初确实遇到了一些困难，因为我正在分析一个基于 autotools 的项目，并且在我的第一次尝试中，我正在分析由 libtool 生成的 shell 脚本，而不是我的应用程序。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-05-28T10:51:18.013

你可以设置`--trace-children=yes [default:no]`

> 启用后，Valgrind 将跟踪通过 exec 系统调用启动的子进程。这对于多进程程序是必要的。

[地块手册](http://valgrind.org/docs/manual/ms-manual.html)

# javascript - 如何以同步方式加载文件？（访问控制允许来源）

> ID：12320535
> 
> 赞同：0
> 
> 时间：2012-09-07T14:55:14.197
> 
> 标签：javascript, jquery, synchronous

以下代码在 Safari 上运行良好。

在 Chrome 上，它失败的原因是：

```
"XMLHttpRequest cannot load file:///Users/jem/Sites/AA/data/articles.csv. Origin null is not allowed by Access-Control-Allow-Origin." 
```

这是什么意思？如何使用同步调用正确读取此文件？

```
function(file) {

    var content;

    $.ajax({
        url : file,
        success : function (data) {
            content = data.split(/\r\n|\n/);

        },
        async: false
    });

    return content;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T14:56:34.010

问题是chrome默认不允许您使用ajax从本地系统加载文件。这是一个安全设置。

使用 --allow-file-access-from-files 参数启动 Chrome 以跳过此安全检查。

chrome.exe --allow-file-access-from-files

# c# - 如何将复杂类绑定到视图，同时保留我的自定义验证属性？

> ID：12320537
> 
> 赞同：1
> 
> 时间：2012-09-07T14:55:16.003
> 
> 标签：c#, asp.net-mvc, razor, asp.net-mvc-4, model-binders

在我的项目中，我有一个使用另一个类的模型类，如下面的示例所示。模型中的属性之一取决于对子对象的一个​​属性的验证——在此示例中，LastName 属性取决于对 Address.PostalCode 属性值的验证。我实现了一个自定义验证属性来验证我的 LastName 属性，它工作得很好。

```
public class User
{
    public static ValidationResult ValidateLastName(string lastName, ValidationContext context)
    {
        // Grab the model instance
        var user = context.ObjectInstance as User;
        if (user == null)
            throw new NullReferenceException();

        // Cross-property validation
        if (user.Address.postalCode.Length < 10000)
            return new ValidationResult("my LastName custom validation message.");

        return ValidationResult.Success;
    }

    [Display(Name = "Last name")]
    [CustomValidationAttribute(typeof(User), "ValidateLastName")]
    public string LastName { get; set; }

    [Display(Name = "First name")]
    public string FirstName { get; set; }

    [Display(Name = "Address:")]
    [CustomValidationAttribute(typeof(User), "ValidateAddress")]
    public AddressType Address { get; set; }
}

public class AddressType
{
    public string streetName = "";

    public string streetNumber = "";
    public string postalCode = "";
} 
```

问题在于控制器中的 Address 属性不是从视图中构造的，并且它始终为 null。在此示例中，无论我在视图中发送什么，user.Address 始终为空。这是控制器代码。

```
 [HttpPost]
    public ActionResult Create(User user)
    {
        if (ModelState.IsValid)
        {
            // creation code here
            return RedirectToAction("Index");
        }
        else
        {
            return View(user);
        }
    } 
```

这是视图：

```
 <div class="editor-label">
            @Html.LabelFor(model => model.Address.postalCode)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Address.postalCode)
            @Html.ValidationMessageFor(model => model.Address.postalCode)
        </div> 
```

为了解决这个问题，我创建了一个自定义的虚拟绑定器，将视图中的字段映射到模型中的属性，如下所示：

```
public class UserBinder : IModelBinder
{
    private string GetValue(ModelBindingContext bindingContext, string key)
    {
        var result = bindingContext.ValueProvider.GetValue(key);
        return (result == null) ? null : result.AttemptedValue;
    }

    public object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
    {
        User instance = new User();
        instance.FirstName = GetValue(bindingContext, "FirstName"); //controllerContext.HttpContext.Request["FirstName"];
        instance.LastName = GetValue(bindingContext, "LastName"); //controllerContext.HttpContext.Request["LastName"];

        instance.Address = new AddressType();
        string streetName = controllerContext.HttpContext.Request["Address.streetName"];

        //ModelStateDictionary mState = bindingContext.ModelState;
        //mState.Add("LastName", new ModelState { });
        //mState.AddModelError("LastName", "There's an error.");

        instance.Address.streetName = streetName;
                    ...
        return instance;
    } 
```

活页夹工作正常，但验证属性不再工作。我认为必须有比这更好的绑定方法，是吗？

这个活页夹只是将 LastName 映射到 LastName 并将 Address.streetName 映射到 Address.streetName，我想应该有一种方法可以实现这一点，而不必编写所有这些繁琐的代码，也不会破坏自定义验证机制。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T14:58:49.023

您需要使用属性而不是公共字段才能使默认模型绑定正常工作。

`AddressType`将您的班级更改为：

```
public class AddressType
{
    public string streetName { get; set; }
    public string streetNumber { get; set; }
    public string postalCode { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T15:21:20.720

一种解决方案是在我的子类中使用属​​性而不是公共字段——感谢 Oded 的回答！

另一种解决方案是在控制器中调用 TryValidateModel，即使存在活页夹，这也可以启用我的验证代码。

```
 [HttpPost]
    public ActionResult Create(User user)
    {
        if (TryValidateModel(user))
        {
            // creation code here
            return RedirectToAction("Index");
        }
        else
        {
            return View(user);
        }
    } 
```

# nhibernate - NHibernate 二级缓存不适用于 HashTableCacheProvider

> ID：12320539
> 
> 赞同：-1
> 
> 时间：2012-09-07T14:55:19.877
> 
> 标签：nhibernate, caching

我基本上只是想重现 Ayende 的一级和二级缓存[http://nhibernate.hibernatingrhinos.com/28/first-and-second-level-caching-in-nhibernate](http://nhibernate.hibernatingrhinos.com/28/first-and-second-level-caching-in-nhibernate)。

我已将配置连接为：

```
<hibernate-configuration xmlns="urn:nhibernate-configuration-2.2">
  <session-factory name="NHibernate.Test">
  <property name="connection.driver_class">NHibernate.Driver.OracleDataClientDriver</property>
  <property name="dialect">NHibernate.Dialect.Oracle10gDialect</property>
  <property name="show_sql">true</property>
  <property name="query.substitutions">true 1, false 0, yes 'Y', no 'N'</property>
  <property name="cache.use_query_cache">true</property>
  <property name="cache.use_second_level_cache">true</property>
  <property name="cache.provider_class">NHibernate.Cache.HashtableCacheProvider</property>
  <property name="cache.default_expiration">1801</property>
</session-factory> 
```

我已将实体映射为：

```
<class name="HeaderDTO" mutable="false" check="none">
<cache usage="read-write"/>
  <id name="Id" type="System.Int32" >
    <column name="id" sql-type="NUMBER" not-null="true" unique="true"/>
    <generator class="assigned"/>
  </id>
  <property name="Description" column="description" type="System.String" />
</class> 
```

我的命名查询如下所示：

```
<sql-query name="GetHeaderDTO">
  <query-param name="id" type="int"/>
  <return class="HeaderDTO" />
  { call MyPackage.get_header(:id) }
</sql-query> 
```

现在我正在尝试做一些测试（忽略测试不是一个很好的测试缓存的事实）。

```
[TestMethod]
public void Cacching_Entity_FirstCallIsCached()
{
DateTime StartTime;
DateTime EndTime;
TimeSpan FirstTry;
TimeSpan SecondTry;
int Id = 2888469;
string key = string.Concat("Id", Id);

using (var session = factory.OpenSession())
{
    //Act
    var query = session.GetNamedQuery("GetHeaderDTO");
    query.SetInt32("in_nom_id", Id);
    query.SetCacheable(true);
    query.SetCacheMode(CacheMode.Normal);
    query.SetCacheRegion(key);
    StartTime = DateTime.Now;
    HeaderDTO MyHeader = query.UniqueResult<HeaderDTO>();
    EndTime = DateTime.Now;
    FirstTry = EndTime - StartTime;
}

using (var session = factory.OpenSession())
{
    //Act
    var query = session.GetNamedQuery("GetHeaderDTO");
    query.SetInt32("in_nom_id", Id);
    query.SetCacheable(true);
    StartTime = DateTime.Now;
    HeaderDTO MyHeader = query.UniqueResult<HeaderDTO>();
    EndTime = DateTime.Now;
    SecondTry = EndTime - StartTime;
}

Assert.IsTrue(FirstTry>SecondTry);
} 
```

但是当我运行测试并查看 NHibernate 日志时：

NHibernate.Impl.SessionImpl：DEBUG [session-id=e9de687f-1ef5-4824-9964-9b94f636a15d] 在时间戳：5517356014678016 处打开会话，对于会话工厂：[NHibernate.Test/ca36467732ff486380672aeb062ef749] NHibernate 设置缓存模式.Impl。 to: Normal NHibernate.Loader.Custom.Sql.SQLCustomQuery: DEBUG 开始处理 sql 查询 [{ call MyPackage.get_header(:id) }] NHibernate.Loader.Custom.Sql.SQLQueryReturnProcessor: DEBUG mapping alias [nh] to entity-后缀 [0_] NHibernate.Cache.StandardQueryCache：INFO 在区域开始查询缓存：Id2888469 NHibernate.Cache.StandardQueryCache：调试在区域检查缓存的查询结果：'Id2888469'; sql: { 调用 MyPackage.get_header(?) }; 参数： []; 命名参数：{'id'='2888469'} NHibernate.Cache.StandardQueryCache：缓存中未找到DEBUG查询结果： sql: { call MyPackage.get_header(?) }; 参数： []; 命名参数：{'id'='2888469'} NHibernate.AdoNet.AbstractBatcher：调试打开新的 IDbCommand，打开 IDbCommands：1 NHibernate.AdoNet.AbstractBatcher：调试为 SqlString 构建 IDbCommand 对象：{ call MyPackage.get_header(?) } NHibernate.Type.Int32Type：调试绑定“2888469”到参数：0 NHibernate.Loader.Loader：INFO { call MyPackage.get_header(:p0) } NHibernate.SQL: DEBUG { call MyPackage.get_header(:p0) };: p0 = 2888469 [Type: Int32 (0)] blah blah NHibernate.AdoNet.ConnectionManager: DEBUG 积极释放数据库连接 NHibernate.Connection.ConnectionProvider: DEBUG 关闭连接 NHibernate.Loader.Loader: DEBUG 水合对象总数: 1 NHibernate.Engine.TwoPhaseLoad ： **NHibernate.Engine.TwoPhaseLoad：调试将实体添加到二级缓存：[MyAssembly.HeaderDTO#2888469] NHibernate.Cache.ReadWriteCache：调试缓存：MyAssembly.HeaderDTO#2888469 NHibernate.Cache.ReadWriteCache：调试缓存：MyAssembly.HeaderDTO#2888469** NHibernate.Engine.TwoPhaseLoad：调试完成实体化 [MyAssembly.HeaderDTO#2888469] NHibernate.Engine.StatefulPersistenceContext：调试初始化非延迟集合 NHibernate.Cache.StandardQueryCache：调试缓存查询结果在区域：'Id2888469'; sql: { 调用 MyPackage.get_header(?) }; 参数： []; 命名参数：{'id'='2888469'} NHibernate.AdoNet.ConnectionManager：自动提交后的调试 NHibernate.Impl.SessionImpl：调试事务完成 NHibernate.AdoNet.ConnectionManager：调试积极释放数据库连接 NHibernate.Impl.SessionImpl：调试设置缓存模式为：正常 NHibernate.Impl.SessionImpl：调试 [session-id=e9de687f-1ef5-4824-9964-9b94f636a15d] 运行 ISession.Dispose() NHibernate.Impl.SessionImpl：调试 [session-id=e9de687f-1ef5-4824-9964-9b94f636a15d] 执行真正的 Dispose(True) NHibernate.Impl.SessionImpl：调试关闭会话 NHibernate.AdoNet.AbstractBatcher：调试运行 BatcherImpl.Dispose(true) NHibernate.Impl.SessionImpl ：DEBUG [session-id=78820256-77e8-4596-8374-98f8b5cc946b] 在时间戳打开会话：5517356016148480，对于会话工厂：[NHibernate.Test/ca36467732ff486380672aeb062ef749] NHibernate.Loader.Custom.sql.SQLCustomQuery 开始处理：查询 [{ call MyPackage.get_header(:id) }] NHibernate.Loader.Custom.Sql.SQLQueryReturnProcessor: DEBUG 映射别名 [nh] 到实体后缀 [0_] NHibernate.Cache.StandardQueryCache: DEBUG 检查区域中的缓存查询结果： 'NHibernate.Cache.StandardQueryCache'; sql: { 调用 MyPackage.get_header(?) }; 参数： []; 命名参数：{'id' **NHibernate.Cache.StandardQueryCache: DEBUG 查询结果未在缓存中找到: sql: { call MyPackage.get_header(?) }; 参数： []; 命名参数：{'id'='2888469'}** NHibernate.AdoNet.AbstractBatcher：调试打开新 IDbCommand，打开 IDbCommands：1 NHibernate.AdoNet.AbstractBatcher：调试为 SqlString 构建 IDbCommand 对象：{ call MyPackage.get_header(?)} NHibernate.Type.Int32Type：调试绑定'2888469'参数：0 NHibernate.Loader.Loader: INFO { call MyPackage.get_header(:p0) } NHibernate.SQL: DEBUG { call MyPackage.get_header(:p0) };:p0 = 2888469 [Type: Int32 (0)] NHibernate .Connection.DriverConnectionProvider：调试从驱动程序 NHibernate.AdoNet.AbstractBatcher 获取 IDbConnection：调试 ExecuteReader 花了 2 毫秒 NHibernate.AdoNet.AbstractBatcher：调试打开 IDataReader，打开 IDataReaders：等等 NHibernate.Loader.Loader：调试完成处理结果集（1 行) NHibernate.AdoNet.AbstractBatcher：调试关闭 IDataReader，打开 IDataReaders：0 NHibernate.AdoNet。AbstractBatcher：调试数据读取器在 27 毫秒后关闭。二级缓存：[MyAssembly.HeaderDTO#2888469] **NHibernate.Cache.ReadWriteCache：调试缓存：MyAssembly.HeaderDTO#2888469 NHibernate.Cache.ReadWriteCache：调试项已缓存：** MyAssembly.HeaderDTO#2888469 NHibernate.Engine.TwoPhaseLoad：调试完成实体化实体 [MyAssembly.HeaderDTO#2888469] NHibernate。 Engine.StatefulPersistenceContext: DEBUG 初始化非惰性集合 NHibernate.Cache.StandardQueryCache: DEBUG 缓存查询结果在 region: 'NHibernate.Cache.StandardQueryCache'; sql: { 调用 MyPackage.get_header(?) }; 参数： []; 命名参数：{'id'='2888469'} NHibernate.AdoNet.ConnectionManager：自动提交后调试等等等等

NHibernate 怎么能说它被缓存了？找不到它然后NHibernate不会缓存它，因为它已经被缓存了？

也许这与 HashTable 提供者有关？任何帮助，将不胜感激。

谢谢，比尔 N

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T14:48:29.973

您应该将代码放入事务中：

```
using (var session = factory.OpenSession())
using (var tx = session.BeginTransaction())
{
    //Act
    var query = session.GetNamedQuery("GetHeaderDTO");
    query.SetInt32("in_nom_id", Id);
    query.SetCacheable(true);
    query.SetCacheMode(CacheMode.Normal);
    query.SetCacheRegion(key);
    StartTime = DateTime.Now;
    HeaderDTO MyHeader = query.UniqueResult<HeaderDTO>();
    EndTime = DateTime.Now;
    FirstTry = EndTime - StartTime;

    tx.Commit();
}

using (var session = factory.OpenSession())
using (var tx = session.BeginTransaction())
{
    //Act
    var query = session.GetNamedQuery("GetHeaderDTO");
    query.SetInt32("in_nom_id", Id);
    query.SetCacheable(true);
    StartTime = DateTime.Now;
    HeaderDTO MyHeader = query.UniqueResult<HeaderDTO>();
    EndTime = DateTime.Now;
    SecondTry = EndTime - StartTime;

    tx.Commit();
} 
```

# c# - 重复代码第一个MVC多对多

> ID：12320540
> 
> 赞同：1
> 
> 时间：2012-09-07T14:55:19.597
> 
> 标签：c#, asp.net-mvc, many-to-many, code-first

我的模型：

```
public class Person
{
    [Key]
    public int IdPerson { get; set; }

    public string Name { get; set; }

    public List<Project> Projects { get; set; }
}

public class Project
{
    [Key]
    public int IdProject {get; set;}

    public string Name { get; set; }

    public ICollection<Person> Members { get; set; }
} 
```

我的背景：

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
    modelBuilder.Entity<Project>()
        .HasMany(p => p.Members)
        .WithMany(e => e.Projects)
        .Map(pe =>
        {
            pe.ToTable("ProjectPersonTable");
            pe.MapLeftKey("IdPerson");
            pe.MapRightKey("IdProject");
        });
} 
```

现在当我这样做时：

```
 Person person = personRepository.GetSingle(Idperson);
 project.Members.Add(person); 
```

将人加倍，我不希望重复或在执行此操作时插入新人。

这是为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:25:08.923

你`project`依附于什么背景？它可能会加倍，因为`person` `entity`您从存储库中获取的内容不在您的`project`对象所属的上下文中。因此，当上下文尝试创建/更新您的`project`实体时，它会加倍。

尝试将 附加`person`到相同的上下文，或者确保您在两个存储库中都有一个上下文。

# eclipse - 无法获取 Oracle 环境句柄

> ID：12320542
> 
> 赞同：0
> 
> 时间：2012-09-07T14:55:24.507
> 
> 标签：eclipse, pydev

环境：Windows 7 上的 Eclipse Indigo 或 Eclipse Juno 4.2。Oracle 11g XE（本地安装） 在 pydev 中运行我的 Django 项目时，尝试页面访问会导致消息“无法获取 Oracle 环境句柄”。

通常，我所要做的就是将 TNS_ADMIN 设置为指向正确的 tnsnames.ora 目录。

如果我从命令行运行 manage.py ，一切都会按预期工作。起初我以为可能是环境变量的差异，但是 TNS_ADMIN 的值是一样的。无论如何，在 Eclipse 运行配置中显式设置 TNS_ADMIN 并没有什么不同。

两者之间的 PYTHONPATH 有点不同，我不厌其烦地在运行配置中覆盖它，看看它是否有所作为。没有。

查看 cx_Oracle 源，该错误似乎来自对 OCIEnvNlsCreate 的调用失败，但我在 Oracle 文档中没有看到任何明显的内容。

谁能给我一个线索，为什么我在 Pydev 中得到这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T17:46:24.337

我想到了。我对 PATH 变量不够仔细。

基本上，有一个虚拟环境需要它的脚本目录（包含 OCI.DLL）在路径中的第一个，但我的 Oracle 安装在它前面。因此，错误消息基本上是调用错误 OCI.DLL 的结果（与我的 Oracle 安装相关的那个，而不是 cx_Oracle 绑定的那个）。

激活虚拟环境有效，因为它改变了路径。Pydev 的工作方式不同，因此 Eclipse 会首先看到我安装 Oracle 的标准路径。

# linux - perl 库路径

> ID：12320543
> 
> 赞同：6
> 
> 时间：2012-09-07T14:55:41.117
> 
> 标签：linux, perl, unix

我需要检索 perl 库 Statistics and Distributions 所在的路径。该路径是运行脚本所必需的。我在计算机集群上。谁能帮我？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-07T19:50:52.040

该答案假定该模块实际上已安装，但未安装在`perl`要查找的位置。

通常，Perl 模块`Statistics::Distributions`将包含在一个名为`Statistics/Distributions.pm`. 在 Linux 和类似系统上，可以使用以下命令快速搜索这些文件`locate`：

```
locate Statistics/Distributions.pm 
```

如果安装了，`locate`会吐出类似的一行

```
/opt/my_perl/lib/Statistics/Distributions.pm 
```

然后，您也可以指示`perl`解释器以各种方式查看此路径。一种是定义环境变量`PERL5LIB`，即来自`bash`：

```
prompt> PERL5LIB=/opt/my_perl/lib/ ./myscript.pl 
```

或者您可以使用`perl -I`开关：

```
prompt> perl -I/opt/my_perl/lib/ ./myscript.pl 
```

或者您可以将脚本修改为`use lib`; 有不止一种方法可以做到这一点;-)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-07T14:59:03.080

如果您的意思是您需要在程序中使用的模块的路径，则存储在`%INC`：

```
$ perl -MLWP::Simple -le 'print $INC{"LWP/Simple.pm"}'
/usr/share/perl5/LWP/Simple.pm 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-22T13:21:28.783

`perldoc -m Your::Module`- 显示模块的来源

`perldoc -l Your::Module`- 如果在 PERL5LIB、-I、@INC 等中安装并找到库，则显示其路径。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-07T16:10:52.423

“ `Can't locate XXX in @INC`”通常表示模块没有安装。您是否安装了[Statistics::Distributions](http://search.cpan.org/perldoc?Statistics%3a%3aDistributions)？

```
cpan Statistics::Distributions 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-01T16:12:49.797

我遇到了同样的麻烦，可以通过两种方式解决：

1）通过运行命令

```
perl -I/blabla/folder_your_module_is_installed/blib/lib/ ./script.pl 
```

对于像我这样的傻瓜，重要的是要注意路径的尽头是`lib/`，而不是`lib/Other_folder/`。因为它后面还有更多的文件夹。

2）在脚本中你可以写：

```
use lib 'blabla/folder_your_module_is_installed/blib/lib/'; 
```

保存并运行 perl scripit.pl

# iphone - 启动 RedLaser 覆盖视图控制器时无法调整控制器大小

> ID：12320544
> 
> 赞同：0
> 
> 时间：2012-09-07T14:55:41.683
> 
> 标签：iphone, ios, ipad

我正在使用 RedLaser SDK。我的应用程序是拆分视图。当在主视图控制器上按下条形按钮时，我正在尝试启动 RedLaser 覆盖。

该方法在按下按钮时被调用，这就是问题开始的地方。我有 3 个不同版本的代码来启动覆盖。每个人都有自己的问题。

选项 1 这是我的基线，我知道它不会起作用，因为我没有初始化覆盖。以下代码正确启动视图控制器，但（显然）没有做我想要的。

```
 // Working Code that brings up dialog but doesn't start camera overlay
SRSScanVINViewController *scanVINViewController y= [[SRSScanVINViewController alloc] init];
UINavigationController *navController = [[UINavigationController alloc] initWithRootViewController:scanVINViewController];
[navController setModalPresentationStyle:UIModalPresentationFormSheet];
[navController setModalTransitionStyle:UIModalTransitionStyleFlipHorizontal];
[self presentViewController:navController animated:YES completion:nil];
[[UIApplication sharedApplication] setStatusBarHidden:YES]; 
```

选项 2 此代码启动覆盖控制器并启动它而不会崩溃。覆盖正在工作并且相机处于活动状态。问题是 viewcontroller/overlay 占据了整个屏幕。我的控件（按钮等）都布置得好像视图控制器占据了屏幕左上角的一部分。如果我可以正确调整叠加层的大小，这将起作用。

```
 // Working code that shows the overlay (camera on) but the overlay takes the whole screen
SRSScanVINViewController *scanVINViewController = [[SRSScanVINViewController alloc] init];
[pickerController setOverlay:scanVINViewController];
UINavigationController *navController = [[UINavigationController alloc] initWithRootViewController:scanVINViewController];
[navController setModalPresentationStyle:UIModalPresentationFormSheet];
[navController setModalTransitionStyle:UIModalTransitionStyleFlipHorizontal];
[self presentViewController:pickerController animated:YES completion:nil];
[[UIApplication sharedApplication] setStatusBarHidden:YES]; 
```

选项 3 此尝试是为了解决选项 2（上图）中的问题。这是代码：

```
 SRSScanVINViewController *scanVINViewController = [[SRSScanVINViewController alloc] init];
[pickerController setOverlay:scanVINViewController];
UINavigationController *navController = [[UINavigationController alloc] initWithRootViewController:pickerController];
[navController setModalPresentationStyle:UIModalPresentationFormSheet];
[navController setModalTransitionStyle:UIModalTransitionStyleFlipHorizontal];
[self presentViewController:pickerController animated:YES completion:nil];
[[UIApplication sharedApplication] setStatusBarHidden:YES]; 
```

它崩溃并出现以下错误（nslog）：

```
 *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason:      'Application tried to present modally an active controller <SRSMasterViewController:      0x1f59f540>.'
 *** First throw call stack:
 (0x37ecb88f 0x331fc259 0x30d86441 0x7f6b5 0x7edf7 0x37e253fd 0x30cbfe07 0x30d855e7      0x37e253fd 0x30cbfe07 0x30cbfdc3 0x30cbfda1 0x30cbfb11 0x30cc0449 0x30cbe92b 0x30cbe319      0x30ca4695 0x30ca3f3b 0x3630522b 0x37e9f523 0x37e9f4c5 0x37e9e313 0x37e214a5 0x37e2136d      0x36304439 0x30cd2cd5 0x7deb5 0x7de50)
 terminate called throwing an exception 
```

任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T18:48:37.063

我得到了代码工作，但仍然有几个问题。这是代码：

```
 SRSScanVINViewController *scanVINViewController = [[SRSScanVINViewController alloc] init];
[pickerController setOverlay:scanVINViewController];
UINavigationController *navController = [[UINavigationController alloc] initWithRootViewController:scanVINViewController];
[navController setModalPresentationStyle:UIModalPresentationFormSheet];
[navController setModalTransitionStyle:UIModalTransitionStyleFlipHorizontal];
[[UIApplication sharedApplication] setStatusBarHidden:YES];
if([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPad)
{
    pickerControllerPopover = [[UIPopoverController alloc] initWithContentViewController:pickerController];
    [pickerControllerPopover setDelegate:self];
    [pickerControllerPopover setPopoverContentSize:CGSizeMake(320.0f, 460.0f)];
    [pickerControllerPopover presentPopoverFromBarButtonItem:sender permittedArrowDirections:UIPopoverArrowDirectionAny animated:NO];
}
else
{
    [self presentViewController:pickerController animated:YES completion:nil];
} 
```

这会将弹出框的大小设置为与我的原始控制器（在笔尖中定义）相同的大小。我仍然有几个问题。

控制器在底部的按钮栏中有 4 个按钮。它还有一个 UIImage。我第一次加载这个控制器时，按钮（和按钮栏和 UIImage）要么丢失，要么位于奇怪的地方。如果我通过触摸控制器外部某处的屏幕来关闭弹出控制器并再次加载控制器，则控件都在正确的位置。事实上，除了第一次之外，它们每次都在正确的位置。

有任何想法吗？

# wpf - 数据网格上的弹出窗口中的按钮未引发单击事件

> ID：12320552
> 
> 赞同：3
> 
> 时间：2012-09-07T14:56:07.840
> 
> 标签：wpf, events, popup, click, itemtemplate

我对 WPF 很陌生，仍然试图弄清楚它的所有细节；）我有一个奇怪的问题，按钮没有引发其点击事件。我有一个名为 PopupButton 的 UserControl，它基本上是一个在单击时显示弹出窗口的按钮。弹出窗口的内容是 ContentPresenter，并绑定到 PopupButton 上名为 PopupContentHolder 的依赖属性。然后在主窗体上，我有一个带有 DataGridTemplateColumn 的 DataGrid， `<DataGridTemplateColumn.CellTemplate> <DataTemplate>`我在其中放置了 PopupButton。然后我分配一个带有 ItemTemplate 的列表框作为我的 PopupButton 的弹出内容。简单来说，这看起来如下

```
<DataGrid HorizontalAlignment="Stretch"
        VerticalAlignment="Stretch"
        HorizontalContentAlignment="Stretch"
        ColumnHeaderHeight="40"
        FontSize="11"
        HorizontalScrollBarVisibility="Disabled"
        ItemsSource="{Binding Pocos}"
        RowHeight="30"
        SnapsToDevicePixels="True"
        VerticalScrollBarVisibility="Disabled">
<DataGrid.Columns>
    <DataGridTemplateColumn MinWidth="70" Header="NAme">
        <DataGridTemplateColumn.CellTemplate>
            <DataTemplate>
                <controls:PopupButton DoPopupOnMainButton="True"
                                        Foreground="{StaticResource HeaderLinkActiveColor}"
                                        MarkButtonOnPopup="True"
                                        PopupBackground="{StaticResource PopupBackground}"
                                        PopupPadding="5"
                                        ShowDownArrow="False"
                                        Text="Some test button">
                    <controls:PopupButton.PopupContentHolder>
                        <StackPanel>
                            <ListBox Background="Transparent" ItemsSource="{Binding Tenders}">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Button Margin="0,2,0,0"
                                                Click="Button_Click"
                                                Command="{Binding RelativeSource={RelativeSource AncestorType={x:Type Window}},
                                                                    Path=DataContext.SaveCommand}"
                                                Content="{Binding .}"
                                                FontSize="11" />
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </StackPanel>
                    </controls:PopupButton.PopupContentHolder>
                </controls:PopupButton>
            </DataTemplate>
        </DataGridTemplateColumn.CellTemplate>
    </DataGridTemplateColumn>
</DataGrid.Columns> 
```

现在问题出在PopupButton 中ListBox 内的按钮上，既没有引发Click 事件，也没有引发Command。此外，当我将 PopupButton 放在 DataGrid 之外时，everythinkg 工作得很好。另外，当我将上面的列表框直接放在网格单元格中时，它就可以工作了。也许是我的 PopupButtonControl 出了点问题。

```
<UserControl x:Class="WpfApplication1.PopupButton"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
         x:Name="userControlRoot"
         Width="Auto"
         Height="Auto">
<UserControl.Resources>
    <BooleanToVisibilityConverter x:Key="BoolToVis" />

    <Storyboard x:Key="PopupCloseStoryBoard">
        <BooleanAnimationUsingKeyFrames Storyboard.TargetName="popup" Storyboard.TargetProperty="IsOpen">
            <DiscreteBooleanKeyFrame KeyTime="0:0:0.1" Value="False" />
        </BooleanAnimationUsingKeyFrames>
    </Storyboard>

    <Storyboard x:Key="PopupOpenStoryBoard">
        <BooleanAnimationUsingKeyFrames Storyboard.TargetName="popup" Storyboard.TargetProperty="IsOpen">
            <DiscreteBooleanKeyFrame KeyTime="0:0:0.0" Value="True" />
        </BooleanAnimationUsingKeyFrames>
    </Storyboard>

</UserControl.Resources>

<Grid>

    <Border x:Name="brdButtonBack"
            Background="Transparent"
            CornerRadius="3,3,0,0"
            Padding="{Binding Padding,
                              ElementName=userControlRoot}" />

    <Button x:Name="btnMain"
            HorizontalAlignment="Center"
            VerticalAlignment="Center"
            Click="btn_Click"
            Command="{Binding MainCommand,
                              ElementName=userControlRoot}"
            Content="{Binding Text,
                              ElementName=userControlRoot}"
            IsEnabled="{Binding IsEnabled,
                                ElementName=userControlRoot}" />

    <Popup x:Name="popup"
           MinWidth="{Binding ActualWidth,
                              ElementName=userControlRoot}"
           AllowsTransparency="True"
           Placement="Bottom"
           PlacementTarget="{Binding ElementName=brdButtonBack}"
           PopupAnimation="Slide"
           StaysOpen="False">
        <Border Background="{Binding PopupBackground,
                                     ElementName=userControlRoot}"
                BorderBrush="White"
                CornerRadius="0,3,3,3"
                Padding="{Binding PopupPadding,
                                  ElementName=userControlRoot}">

            <ContentPresenter Content="{Binding PopupContentHolder, ElementName=userControlRoot}" />
        </Border>
    </Popup>

</Grid> 
```

我已经简化了控制，但该版本也重现了问题。控件背后的代码大多包含依赖属性，唯一的逻辑如下所示

```
public partial class PopupButton : UserControl
{
    //... dependency properties

    public PopupButton()
    {
        InitializeComponent();
    }

    private void btn_Click(object sender, RoutedEventArgs e)
    {
            Storyboard s = (Storyboard)TryFindResource("PopupOpenStoryBoard");
            s.Begin();
    }

    private void popup_PreviewMouseDown(object sender, MouseButtonEventArgs e)
    {
        //trick to close popup when the button inside is clicked
        //this must be done with storyboard and delay
        //since popup can not be closed before the event reaches clicked
        //button
        if (e.Source is Button)
        {
            Storyboard s = (Storyboard)TryFindResource("PopupCloseStoryBoard");
            s.Begin();
        }
    }
} 
```

有没有人知道它有什么问题？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-06T17:55:23.463

我终于通过将 PopupButton 重写为 CustomControl 来解决这个问题。在那里，当单击包含的按钮时，我没有触发 StoryBoard 来关闭弹出窗口，而是使用了以下代码

```
mainPopup.AddHandler(Button.ClickEvent, new RoutedEventHandler(mainPopup_ButtonClick), true); 
```

为主弹出窗口添加按钮单击处理程序，即使事件已由源按钮处理，也会在弹出窗口上调用该处理程序。

```
 void mainPopup_ButtonClick(object sender, RoutedEventArgs e)
    {
        MainPopup.IsOpen = false;
    } 
```

[有关在此处](http://www.eidias.com/Blog/2013/11/21/handling-already-handled-events-in-wpf)处理已处理的路由事件的更多信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T12:42:27.360

也许这只是一个错字，因为您的代码中有一个 btn_Click 和 Button_Click 事件处理程序。您介意提供 PopupContentHolder 或整个 PopupButton 类的代码吗？

# javascript - 如何验证是否在单击按钮之前单击了锚标记（使用 javaScript）

> ID：12320554
> 
> 赞同：1
> 
> 时间：2012-09-07T14:56:11.480
> 
> 标签：javascript, anchor

只是想知道是否有人以前在 JavaScript 中做过类似的事情。我有一个带有链接和按钮的锚标记的页面。我试图做的是显示一条消息，说明在点击按钮后是否点击了链接。

这就是我所拥有的

```
 function validateLink() {
 var link = document.getElementById("vid");
        if (eval(link)) {
            if (link.clicked == true) {
                return true;
            } else {
                window.alert("You have not clicked the link");
                return false;
            }
        }
    } 
```

这是锚标签和按钮

```
 <a href="https://www.joystiq.com/" target="_blank" id="vid">Here</a>  
 <button id="Button1" type="button" value="button" onclick="validateLink()> 
```

再次感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:00:40.720

在锚标记上设置 onclick 以设置全局变量： [Fiddle](http://jsfiddle.net/Schlogen/3scnf/)

```
 a onclick="linkClicked = true;" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:00:24.967

您应该有一个全局变量/标志并将默认值设置为 false。单击超链接时将标志的值设置为 true。单击按钮时读取标志的值，如果标志为假，则不单击超链接，如果标志为真，则单击超链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T15:02:59.703

```
var clicked = false;

function validateLink() {
     var link = document.getElementById("vid");
        if (eval(link)) {
            if (clicked == true) {
                return true;
            } else {
                window.alert("You have not clicked the link");
                return false;
            }
        }
    } 
```

HTML

```
<a href="https://www.joystiq.com/" target="_blank" id="vid" onclick="validateLink()">Here</a>
<button id="Button1" type="button" value="button" onclick="clicked = true">Here</button> 
```

# jsf - 带有托管属性的 JSF 注入，好的模式？

> ID：12320563
> 
> 赞同：2
> 
> 时间：2012-09-07T14:56:33.667
> 
> 标签：jsf, design-patterns, code-injection, managed-bean, postconstruct

我对 JSF 很陌生，并没有真正“习惯”不同的想法，所以我在（我认为）是基本的东西上苦苦挣扎。

假设我有一个类 User，它是一个会话 bean。

假设我有一个包含 10000 个对象的控制器，比如 Factory，它需要能够将其中一些对象设置为“锁定”，在我们的例子中，这意味着“锁定”字段不再变为 null，而是引用“LockedItem”目的。

这是我无法让事情正常工作的地方：LockedItem，当你实例化它时，应该引用当前登录的用户。我应该怎么做？

我尝试使用@managedproperty 进行注入，但在LockedItem.constructor 中它为空（我认为这是正常的）然后我尝试了@PostConstruct 方法，但从未调用过该方法（为什么？即使我将其设为托管bean ... postconstruct 方法是否仅在“.xhtml”创建对象时调用？）或者我应该使用“java se”技巧，比如使用户静态？

* * *

澄清为什么不调用 @PostConstruct 的代码（“Seat”之一）：

**.xhtml**

```
<h:outputLabel id="user" value="Hello #{user.name}" />
<h:outputLabel id="car" value="you have #{car.brand}" /> 
```

**用户**

```
package test;

import java.io.Serializable;

import javax.faces.bean.ManagedBean;
import javax.faces.bean.SessionScoped;

@ManagedBean
@SessionScoped
public class User implements Serializable {
    private String name ;

    public User()
    {
        name = "toto"; 
        System.out.println("User constructor");
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

} 
```

**车**

```
package test;

import java.io.Serializable;

import javax.faces.bean.ManagedBean;

@ManagedBean
public class Car implements Serializable {
    private String brand ;
    private Seat seat ;

    public Car()
    {
        brand = "audi" ;
        seat = new Seat();
        System.out.println("Car constructor") ;
    }

    public String getBrand() {
        return brand;
    }

    public void setBrand(String brand) {
        this.brand = brand;
    }

} 
```

**座位**

```
package test;

import java.io.Serializable;

import javax.annotation.PostConstruct;
import javax.faces.bean.ManagedBean;
import javax.faces.bean.ManagedProperty;

@ManagedBean
public class Seat implements Serializable {
    private int nb ;
    private String userName ;

    @ManagedProperty("#{user}")
    private User user ;

    public Seat()
    {
        nb = 4 ;
        userName="na";
        System.out.println("! Seat constructor ") ;
    }

    @PostConstruct
    public void init()
    {
        System.out.println("!! Seat postconstruct : "+user.getName());
    }

    public User getUser() {
        return user;
    }

    public void setUser(User user) {
        this.user = user;
    }

    public int getNb() {
        return nb;
    }

    public void setNb(int nb) {
        this.nb = nb;
    }
} 
```

谢谢 ！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T15:07:17.427

这`@PostConstruct`是正确的方法。

如果您使用`new`运算符自己实例化 bean（显然），则不会调用它。仅当 JSF 在 EL 上下文中第一次引用它时实例化和管理 bean 本身时才调用它，就像这样`#{bean}`。这确实通常发生在视图端，但这也可能发生在模型/控制器旁边`@ManagedProperty("#{bean}")`or [`Application#evaluateExpressionGet()`](http://docs.oracle.com/javaee/6/api/javax/faces/application/Application.html#evaluateExpressionGet%28javax.faces.context.FacesContext,%20java.lang.String,%20java.lang.Class%29)。

你绝对不应该做`User`静态。它将在应用程序范围内共享，而不是在会话范围内共享。

另一种方法是只传递当前`User`作为构造函数的参数，或者*自己*`LockedItem`调用初始化方法，以确保该类根本不代表合法的 JSF 支持 bean。

# sql - 从查询结果创建一个 sql 变量以在同一查询中使用

> ID：12320564
> 
> 赞同：0
> 
> 时间：2012-09-07T14:56:37.660
> 
> 标签：sql

我想做以下查询：

```
SELECT SUBSTRING(violations, CHARINDEX('X', violations, 0), 5) AS 'violations', definition, value, date 
FROM NewViolations WHERE CHARINDEX('X', violations, 0) > 0 
```

但是，我似乎无法弄清楚如何放入`CHARINDEX('X', violations, 0)`一个变量 ( `VarX`) 中，所以我最终得到了类似的东西：

```
SELECT SUBSTRING(violations, VarX, 5) AS 'violations', definition, value, date
FROM NewViolations WHERE VarX > 0 
```

我这样做是为了避免两次运行 CHARINDEX。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:00:48.683

尝试：

```
select substring(violations, location, 5) as 'violations', definition, value, date
 from (select violations, charindex('x',violations,0) location, definition, value, date
         from NewViolations) a
where a.location>0 
```

为了便于说明和减少打字，可以（尽管大多数人可能会对此皱眉）：

```
select substring(violations, location, 5) as 'violations', definition, value, date
 from (select *, charindex('x',violations,0) location
         from NewViolations) a
where a.location>0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T15:02:26.220

假设 SQL Server 2005+，您可以使用 CTE：

```
WITH cteCharIndex AS (
    SELECT violations, CHARINDEX('X', violations, 0) AS PosOfX
        FROM NewViolations
)
SELECT SUBSTRING(violations, PosOfX, 5) AS 'violations'
    FROM cteCharIndex
    WHERE PosOfX > 0; 
```

# android - 安卓自定义通知栏

> ID：12320571
> 
> 赞同：0
> 
> 时间：2012-09-07T14:56:53.793
> 
> 标签：android, android-notifications, android-notification-bar

我根据通知栏拥有：http: [//developer.android.com/guide/topics/ui/notifiers/notifications.html](http://developer.android.com/guide/topics/ui/notifiers/notifications.html)

我喜欢这个教程：

```
 Notification notification = new Notification();
            notification.flags = Notification.FLAG_ONGOING_EVENT;
            notification.icon = icon;

            RemoteViews contentView = new RemoteViews(getPackageName(),
                    R.layout.custom_notification);
            contentView.setImageViewResource(R.id.image, R.drawable.b_10);
            contentView.setTextViewText(R.id.title, "Custom zgłoszenie");
            contentView.setTextViewText(R.id.text, "test test test");
            notification.contentView = contentView;

            NotificationIntent Intent = new Intent(BatteryInfoService.this,
                    BatteryInfoActivity.class);
            ContentIntent PendingIntent = PendingIntent.getActivity(ta, 0,
                    notificationIntent, 0);
            notification.contentIntent = contentIntent;

            mNotificationManager.notify(BATTERY_ID, notification); 
```

**行中有错误：**

```
 NotificationIntent Intent = new Intent(BatteryInfoService.this,
                    BatteryInfoActivity.class);
            ContentIntent PendingIntent = PendingIntent.getActivity(ta, 0,
                    notificationIntent, 0);
            notification.contentIntent = contentIntent; 
```

错误：

```
NotificationIntent cannot be resolved to a type

Multiple markers at this line
    - ContentIntent cannot be resolved to 
     a type
    - ta cannot be resolved to a variable

contentIntent cannot be resolved to a variable 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:07:17.310

将 NotificationIntent 替换为 Intent（android 不提供 NotificationIntent，除非它是自定义类）。

你要找的是

```
Intent notificationIntent = new Intent(BatteryInfoService.this,BatteryInfoActivity.class);
PendingIntent contentIntent = PendingIntent.getActivity(this, 0, notificationIntent, 0); 
```

请仔细阅读教程。Intent 和 PendingIntent 是 Android 类，而 NotificationIntent 和 ContentIntent 不是。如果您在这些名称下创建了自定义类，则可以导入相应的包。

# java - 构建 EntityManagerFactory 后如何获取 Hibernate 配置？

> ID：12320572
> 
> 赞同：6
> 
> 时间：2012-09-07T14:56:55.390
> 
> 标签：java, hibernate, playframework, playframework-1.x

我的 web 框架 (Play 1.2.5) 创建了一个 EJB3Configuration 本地到它用来创建`EntityManagerFactory` [(source)](https://github.com/playframework/play/blob/1.2.5/framework/src/play/db/jpa/JPAPlugin.java#L108)的方法。我正在编写一个脚本，并希望`generateSchemaUpdateScript()`从 Configuration 运行该方法来制作我可以验证并在生产部署中运行的 SQL 脚本。我遇到的问题是我无法弄清楚如何访问使用的配置对象或如何在`EntityManagerFactory`构建后生成配置对象。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-11T08:55:04.267

您无法从 entitymanagerfactory 取回配置对象，因为休眠实现 EntityManagerFactoryImpl 不包含对配置对象的引用

你的选择是

*   在您的脚本中复制来自 JPAPlugin 的代码以创建您自己的配置对象
*   配置休眠工具以处理您的类。我自己从未使用过这个工具，但我想正确配置他可以为你生成 ddl
*   从您的数据库生成回 ddl 脚本

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T13:19:36.913

一旦创建了实体管理器工厂，您就不应该拥有配置对象的句柄，部分原因是配置应该表现出不可变行为的设计，因为您无法更改其属性。

我指的是 Hibernate 3.6.8 源和 EJB3Configuration 类有方法

```
public AnnotationConfiguration getHibernateConfiguration() {
        //TODO make it really read only (maybe through proxying)
        return cfg;
    } 
```

AnnotationConfiguration 被声明为已弃用，因为它的所有功能都已移至 Configuration 类。

因此，我认为使用它，您可以在创建配置后获取配置的句柄。您必须非常小心，但不要更改该配置中的任何内容。

[这在此处](http://docs.jboss.org/hibernate/orm/3.5/api/org/hibernate/ejb/Ejb3Configuration.html)的 javadocs 中进行了解释

> 调用#buildEntityManagerFactory() 后，您不再可以更改配置状态（不添加类，不更改属性等）

话虽如此，您要实现的目标是**严格不建议**做的事情，尤其是在生产数据库上。看[这里](https://stackoverflow.com/questions/221379/hibernate-hbm2ddl-auto-update-in-production)

Hibernate 有一个名为“hibernate.hbm2ddl.auto”的属性，用于在不断发展的脚本的情况下帮助模式自动生成。您尝试以编程方式实现的效果与在持久性 xml 中为其赋予*更新值***相同的效果，如下所示。**实际上，当您将“hibernate.hbm2ddl.auto”的值设置为“update”时，配置会调用方法 generateSchemaUpdateScript

 *```
<persistence xmlns="http://java.sun.com/xml/ns/persistence"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd"
             version="2.0">
   <persistence-unit name="xyz" transaction-type="RESOURCE_LOCAL">
        <properties>
            ....................
            <property name="hibernate.hbm2ddl.auto" value="update"/>
            ......................
        </properties>
    </persistence-unit>
</persistence> 
```

[您可以在此处](https://stackoverflow.com/questions/438146/hibernate-question-hbm2ddl-auto-possible-values-and-what-they-do?lq=1)参考此属性的其他可能值

但是，Hibernate 文档严格建议不要将其用于生产数据库。

关于 Hibernate 的权威书籍“Java persistence with Hibernate”警告了这一点

> **警告**我们已经看到 Hibernate 用户尝试使用 SchemaUpdate 自动更新生产数据库的模式。这可能很快以灾难告终，并且您的 DBA 不允许这样做。

以及关于更新模式过程的一些限制

> 此配置属性的附加选项 update 在开发过程中可能很有用：它启用了内置的 SchemaUpdate 工具，这可以使模式演变更容易。如果启用，Hibernate 会在启动时读取 JDBC 数据库元数据，并通过将旧模式与当前映射元数据进行比较来创建新表和约束。请注意，此功能取决于 JDBC 驱动程序提供的元数据的质量，这是许多驱动程序所缺乏的领域。因此，在实践中，此功能并没有听起来那么令人兴奋和有用。

**更新 1：**如果您无权访问 EJB3Configuration 并且您的最终目标是为 JPA 注释实体创建更新模式脚本，那么您可以使用包含配置详细信息的持久性 xml 文件以编程方式在 java 主类中创建 EJB3Configuration您的数据库并运行模式导出工具。请参阅[此](http://techblog.bozho.net/?p=935)示例如何执行此操作。因此，通过这种方式，您可以在框架甚至容器之外的 JPA 实体上运行该工具。

**更新 2**

[此处](https://gist.github.com/824042)列出的示例代码显示了在为游戏应用程序创建数据库迁移时如何使用 Hibernate 模式更新。好像这就是你想要的！*

# c++ - C ++中的快速差异实现以获取大文件中的行差异量

> ID：12320578
> 
> 赞同：1
> 
> 时间：2012-09-07T14:57:06.200
> 
> 标签：c++, performance, diff

搜索但似乎没有找到我需要的东西。

我正在寻找运行以下命令的快速 C++ 等效项：

```
diff file1.log file2.log | wc -l 
```

目前，我正在使用文件管道来从命令行运行 diff，但是我需要在一个大型的、多嵌套的循环中执行此操作，并且花费的时间比我预期的要长得多。被区分的文件每个大约 150-200mb，每个 diff 大约需要 1-2 分钟。

是否有可以通过 C++ 推出的更快解决方案？

这是我目前的调用方法：

```
static std::string run_cmd(std::string in)
{
  // run command
  FILE* pipe = popen(in.c_str(), "r");
  if (!pipe)  return "err";

  char buff[128];
  std::string res = "";
  while (!feof(pipe))
  {
    if (fgets(buff, 128, pipe) != NULL)
      res += buff;
  }
  pclose(pipe);
  return res;
}

// diff 2 given files and return line number differences
std::string fileDiff(std::string file1, std::string file2)
{
  std::string f1 = base + file1;
  std::string f2 = base + file2;
  std::string cmd = "diff " + f1 + " " + f2 + " | wc -l";

  std::string res = run_cmd(cmd);
  if (res == "err") 
    return "E: Diff on [" + f1 + "] and [" + f2 + "]";

  return res;
} 
```

* * *

编辑：

我本质上在做的是记录代码覆盖率。我已将日志记录语句插入到我正在使用的代码库的每个角落和缝隙中，并将每次运行写入其自己的日志文件。我试图通过不将它们包含在构造函数、循环等中来最小化写入损失，并缓冲了实际的写入过程。

我运行的程序通常需要大约 10 分钟。随着我添加的日志记录和差异调用，它的规模扩大到大约 1 天。

在这种情况下，我只关心线条差异的数量，因为它在遗传算法中提供了适应度函数。在这一点上，迭代之间执行路径的分布很重要。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:06:59.267

启动外部进程很快。在每个文件 1-2 分钟时，进程生成开销只是很小的一部分。您必须受限于 1) diff 命令的性能或 2) 管道输出数据的读取和存储效率低下。尝试在 shell 中运行 diff 命令并输出到文件中。是不是快很多？如果没有，那么 1)。如果是这样，那么 2）。

我对 Unix 管道了解不多，但 128 字节的缓冲区听起来很小。diff 命令很旧并且被广泛使用，因此您不太可能编写更快的版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T15:27:15.577

我可以看到两种可能性。

一是简化问题。`diff`做了很多工作来找到将一个文件转换为另一个文件的最小编辑集。如果您只想知道两个文件之间有多少行不同，而不关心一个如何转换为另一个，您*可以*通过在每个文件中简单地构建一组行来获得一些速度，并且获取`set_symmetric_difference`它们之间的大小。

第二个是，如果您正在寻找（例如）最相似/最不相似的文件，那么现在您可能正在重新计算每个文件和每个其他文件之间的差异。换句话说，您有一个二次问题，并且给定 N 个文件，您要重新读取每个文件 N 次。

根据您要完成的任务和文件的数量，您很有可能只能读取每个文件一次。例如，如果您对每一行进行哈希处理，并且只存储一组哈希值，您可能可以一次将所有文件的数据放入内存中，因此操作的二次部分可以完全在内存中进行，而不是多次重新读取每个文件次。

# javascript - 脚本可以直接向/从 Google 文档写入/读取吗？

> ID：12320580
> 
> 赞同：0
> 
> 时间：2012-09-07T14:57:09.970
> 
> 标签：javascript, gwt, google-apps-script, google-apps

我想创建一个执行以下操作的脚本：

*   创建一个表格
*   一旦用户填写表单并提交，该脚本将复制
    先前创建的 Google 文档“模板”，并使用提交的信息填写复制模板的字段。

现在我知道您**不能**在“文档”容器中创建脚本（仅限电子表格和站点），但独立的 Google Apps 脚本可以像使用电子表格一样直接读取或写入文档吗？

我在某处读到 Google Apps 脚本**无法**从 Google 文档中读取文本，而只能读取文本和 CSV。最近对 Google Apps 脚本的更新仍然如此吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:47:56.563

是的，您可以使用[DocumentApp](https://developers.google.com/apps-script/class_documentapp)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T15:52:24.220

是的，这是可以做到的。最容易遵循的示例是[Employee of the Week 示例](https://drive.google.com/previewtemplate?id=0AhvDA0t7m3SkdGJFZkgwSlptcklyUUQ2NzNXeC1fbkE&mode=public#)。这会接受用户输入，将其合并到一个文档中，并自动将结果通过电子邮件发送给用户，如果您愿意，您可以将其删除。还有一个[视频教程](http://www.youtube.com/watch?v=OdoDuZfP6a0)。应该让你指出正确的方向。

# biztalk - 未使用出站地图

> ID：12320586
> 
> 赞同：1
> 
> 时间：2012-09-07T14:57:50.590
> 
> 标签：biztalk

我有一个接收端口。它调用存储过程进行传输，然后接收管道只是 passthrureceive（我尝试了 XMLReceive，但这导致了更多问题）。我有一个设置了过滤器的发送端口，因此它可以选择接收端口的类型。发送端口有一个映射和发送管道。该映射将 xml 从接收端口映射到平面文件模式，然后将其发送到它的位置。发送管道有一个平面文件汇编器。

所以地图永远不会运行。我只是从发送管道中收到错误，说它与文档不匹配。不，它不能，因为它没有被映射。我读到您需要在接收位置的接收管道上使用 XML 反汇编程序。我添加了那个，这才开始破坏我的消息。它们只是变成了一条空白消息，或者只是消息中的一个“。所以 XML 反汇编器显然不能正常工作。我现在不知道该怎么做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T16:01:42.197

好的，我想通了。我必须使用 XML 反汇编程序来运行地图。它删除我的消息的原因是，我不知道原因，但是当我将架构设置为“elementFormDefault = Qualified”时，它起作用了。我不太确定那做了什么，因为我真的对整个合格的消息没有很好的理解，但这对我来说是个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T15:41:53.900

Visual Studio 中有一个向导可帮助您创建用于与存储过程通信的架构和绑定。我猜你没用过？（右键单击项目，点击“添加”，然后点击“添加生成的项目”，然后点击“使用适配器服务”）

我从挂接到双向发送/接收端口的编排中调用我的存储过程。我正在为管道使用带有 XMLTransmit 和 XMLReceive 的自定义 WCF 类型端口。这似乎工作正常。需要注意的是，让 WCF 工作总是有点繁琐，因为有很多选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-01T14:37:58.340

为了在端口上从一种格式映射到另一种格式，您需要提升 MessageType。在您的情况下，可以通过在接收管道上使用 XMLReceive 来完成。

# codeigniter - CodeIgniter - 删除文件，路径问题

> ID：12320589
> 
> 赞同：2
> 
> 时间：2012-09-07T14:58:06.537
> 
> 标签：codeigniter

我的根目录中有 3 个文件夹，“应用程序”、“系统”和“上传”。在 application/controllers/mycontroller.php 我有这行代码。

```
delete_files("../../uploads/$file_name"); 
```

该文件没有被删除，我尝试了许多路径选项，如 ../ 和 ../../../ 有什么想法吗？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T18:01:00.597

为此，请使用 CodeIgniter 提供给您的 FCPATH 常量。

```
unlink(FCPATH . '/uploads/' . $filename); 
```

`base_url()`生成 HTTP url，不能用于生成文件系统路径。这就是您必须使用 CI 路径常量之一的原因。它们在前端控制器文件 (index.php) 中定义。

您将使用的三个是：

*   `FCPATH`- 前端控制器的路径，通常是 index.php
*   `APPPATH`- 应用程序文件夹的路径
*   `BASEPATH`- 系统文件夹的路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T14:59:44.917

`$file_name`是一个变量。您应该将其连接到您自己的字符串以执行该函数：

```
delete_files("../../uploads/" . $file_name); 
```

**编辑：**

确保这句话：

```
echo base_url("uploads/" . $file_name); 
```

正在回显有效路径。如果答案是肯定的，试试这个：

```
$this->load->helper("url");
delete_files(base_url("uploads/" . $file_name)); 
```

假设您的“上传”文件夹位于您的根目录中。

**编辑2：**

使用`unlink`功能：

```
$this->load->helper("url");
unlink(base_url("uploads/" . $file_name)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-19T07:10:49.520

试试这个..这只是解决您问题的一个非常简单的解决方案.. 如果您注意到 CI 有定义 base_path 到您的目录，例如在上传库的配置中：

```
$imagePath = './picture/Temporary Profile Picture/';

$config['upload_path'] = $imagePath;

$config['allowed_types'] = 'gif|jpg|jpeg|png';

$this->load->library('upload', $config); 
```

如果您注意到 upload_path 是 './picture/Temporary Profile Picture/'

所以如果你想从目录中删除一个文件，你所要做的就是使用 unlink() 函数。

```
unlink($imagePath . $file_name); 
```

或者

```
@unlink($imagePath . $file_name); 
```

享受..^^

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-03-19T10:08:52.933

这段代码对我有用。在你的模型或控制器中试试这个。根据您的更改文件路径。

> 文件路径 -->> project_name/assets/uploads/file_name.jpg

```
public function delete_file()
{
    $file = 'file_name.jpg';
    $path = './assets/uploads/'.$file;
    unlink($path);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-01T09:24:35.287

你应该试试这段代码：

```
$imagepath = $config['upload_path'];
unlink($imagepath . $images); 
```

或者

```
delete_files($imagepath . $images); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-08-19T10:34:51.880

```
 public function deleteContent($id)
 {  
    $this->db->where('Filename',$id);
    $this->db->delete('tableName',array('Filename'=>$id));
    if (unlink("upload/folderName/".$id)) 
    {
      redirect($_SERVER['HTTP_REFERER']);
    }
  } 
```

# regex - Telnet SMTP 与期望或 shell 脚本

> ID：12320592
> 
> 赞同：1
> 
> 时间：2012-09-07T14:58:24.630
> 
> 标签：regex, linux, shell, expect, ubuntu-12.04

**想用期望脚本**建立一个 Auth Smtp 连接......只是为了测试我想获取 ehlo 参数但期望不能像这样工作

```
#!/usr/bin/expect
set timeout -1
set smtp [lindex $argv 0]
set port [lindex $argv 1]
spawn telnet $smtp $port
expect "[2]{2,}[0]{1,}"
send "ehlo\n" 
```

我希望代码 220 来自邮件服务器以继续发送 ehlo ...就像

```
..../...:telnet smtp.mail.yahoo.de 25
Trying 77.238.184.85...
Connected to smtp2-de.mail.vip.ukl.yahoo.com.
Escape character is '^]'.
220 smtp116.mail.ukl.yahoo.com ESMTP
ehlo
250-smtp116.mail.ukl.yahoo.com
250-AUTH LOGIN PLAIN XYMCOOKIE
250-PIPELINING
250-SIZE 41697280
250 8BITMIME 
```

错误说：

```
spawn telnet smtp.mail.yahoo.de 25
invalid command name "2"
    while executing
"2"
    invoked from within
"expect "[2]{2,}[0]{1,}""
    (file "./login.exp" line 6) 
```

如果我只写**期望“220”**而不是**期望“[2]{2,}[0]{1,}”**它可以工作但忽略**发送“ehlo\n”**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T07:01:53.523

正如上面所建议的，我使用**exp_internal 1**来了解期望真正听到的内容......另外，我可以推荐**autoexpect**，它创建的期望脚本并不完美，但在改进了一些编码之后，它是一个真正的帮助，最后它起作用了。

```
#!/usr/bin/expect
#exp_internal 1
set timeout -1
set smtp [lindex $argv 0]
set port [lindex $argv 1]
spawn telnet $smtp $port
expect -re {[2]{2,}[0]{1,}}
sleep 3;
send -- "Ehlo\r"
expect -re {[2]{1,}[5]{1,}[0]{1,}}
send -- "quit\r"
expect eof 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:36:34.180

发送“ehlo”后需要换行：

```
send "ehlo\n" 
```

编辑：根据您的最新编辑，您还必须转义正则表达式中的前括号，以防止 tcp 尝试将其解释为命令：

```
expect "\[2]{2,}\[0]{1,}" 
```

编辑：另外，您的期望线实际上与您认为的不匹配。在这一点上，我建议运行许多关于 expect 的教程，或者简单地使用[autoexpect](http://linux.die.net/man/1/autoexpect)来生成你的脚本。

# c# - 将数据表传递给存储过程

> ID：12320594
> 
> 赞同：16
> 
> 时间：2012-09-07T14:58:26.320
> 
> 标签：c#, .net, sql, sql-server-2008

我有一个用 C# 创建的数据表。

```
using (DataTable dt = new DataTable())
{
    dt.Columns.Add("MetricId", typeof(int));
    dt.Columns.Add("Descr", typeof(string));
    dt.Columns.Add("EntryDE", typeof(int));
    foreach (DataGridViewRow row in dgv.Rows)
    {
        dt.Rows.Add(row.Cells[1].Value, row.Cells[2].Value, row.Cells[0].Value);
    }

    // TODO: pass dt
} 
```

我有一个存储过程

```
CREATE PROCEDURE [dbo].[Admin_Fill] 
-- Add the parameters for the stored procedure here
@MetricId INT,
@Descr VARCHAR(100),
@EntryDE VARCHAR(20) 
```

我想要的是将数据表传递给这个存储过程，如何？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-07T15:00:52.183

从 SQL Server 2008 / .NET 3.5 开始，您可以使用表值参数......

查看[MSDN 上的指南](http://msdn.microsoft.com/en-us/library/bb675163%28v=vs.90%29.aspx)

此外，由于还有其他可用选项，我比较了将多个值（单个字段）传递给存储过程的 3 种方法（[TVP vs XML vs CSV](http://www.adathedev.co.uk/2010/02/sql-server-2008-table-valued-parameters.html)）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-07T15:15:12.783

1.  您需要定义要在数据库中传递**用户定义的表类型**的表类型。

2.  然后你需要在你的存储过程中添加参数来传递它，如下所示：

    ```
    @YourCustomTable AS [dbo].YourCustomTable Readonly, 
    ```

3.  然后，当您设置好行时，像这样调用它：

    ```
    // Setup SP and Parameters
    command.CommandText = "YOUR STORED PROC NAME";
    command.Parameters.Clear();
    command.CommandType = CommandType.StoredProcedure;
    command.Parameters.AddWithValue("@someIdForParameter", someId);
    command.Parameters.AddWithValue("@YourCustomTable",dtCustomerFields).SqlDbType = SqlDbType.Structured;

    //Execute
    command.ExecuteNonQuery(); 
    ```

这应该可以解决您的问题

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-09-07T15:04:23.407

我们一般将数据喷射到 XML 文档中，并将数据作为 NTEXT 参数传递给数据库。

# regex - 带有单数替换的正则表达式多重模式

> ID：12320595
> 
> 赞同：34
> 
> 时间：2012-09-07T14:58:29.437
> 
> 标签：regex, r, stringr

我正在尝试替换两个“st”。和“ste”。与“圣”。似乎以下应该工作，但它没有：

```
require("stringr")
county <- c("st. landry", "ste. geneveve", "st. louis")
str_replace_all(county, c("st\\.", "ste\\."), "st") 
```

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2012-09-07T15:02:01.557

你可以`|`用来表示“或”

```
> str_replace_all(county, "st\\.|ste\\.", "st")
[1] "st landry"   "st geneveve" "st louis" 
```

或者在基础 R

```
> gsub("st\\.|ste\\.", "st", county)
[1] "st landry"   "st geneveve" "st louis" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-03-04T17:15:29.127

```
> A<-"this string,  contains a handful of,  useless:  punctuation.  Some are to escape.  Aaargh! Some might be needed,  but I want none!"
> gsub(", |: |\\. |!","",A)
[1] "this string contains a handful of useless punctuation Some are to escape Aaargh Some might be needed but I want none" 
```

# jquery - 日期选择器不改变值

> ID：12320597
> 
> 赞同：0
> 
> 时间：2012-09-07T14:58:42.210
> 
> 标签：jquery, jquery-ui, datepicker, velocity

我正在尝试更改 datepicker 值的值，但是每次我在日历上选择它时它都不会更改值，而是保持相同的原始值。我怎样才能解决这个问题？

这是我的代码

```
$('#birthday').datepicker({
    changeMonth: true,
    changeYear: true,
    yearRange: "1901:2012"
});

#set ($formattedDate = $webFormatter.formatDateByPattern($webFormatter.parseDate("yyyy-MM-dd", $localBirthdate), "MM/dd/yyyy"))

<input type="text" id="birthday" name="birthday" value="$formattedDate" /> 
```

# android - 将元数据嵌入 H.264 编码文件

> ID：12320604
> 
> 赞同：4
> 
> 时间：2012-09-07T14:59:09.203
> 
> 标签：android, ffmpeg, metadata, h.264, encode

我目前正在开发一个应用程序，它会针对来自相机的预览帧生成某些元数据。我可以看到这个元数据正在正确生成，我在这里没有问题。

但是，我必须将此元数据嵌入到这些感兴趣的帧中（帧由本机算法处理以生成此元数据）。我正在使用带有 x264 的 ffmpeg 将帧编码为 H.264。我检查了 x264.h 和一些文档，但没有找到我想要的。

我的问题是；是否有任何未使用的 H.264 语法部分可以将我的元数据嵌入到编码帧中？

我希望我足够清楚。提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T17:56:11.850

大多数视频基本流都有“用户数据”的规定。在 h.264 中，这是 SEI 最终单元的一部分。您可以在要关联的每一帧之前添加一个。我认为 x264 不支持从外部添加用户数据。

两种选择：

1.  修改 x264 / ffmpeg 以将 SEI 消息添加到您希望它以您喜欢的某种形式输入的任何位置。
2.  创建您的流，创建您的元数据。现在单独编写一个小程序来读取您的元数据并解析文件并在您想要的帧之前推送一个 SEI NAL。

对于 SEI 语法，您应该能够 google 并获得它。不过，最好的地方是 H.264 标准。更简单的方法是只查看 x264 中的代码。它确实在开头插入了一个用户数据（编码参数）。

# c# - 有没有办法编辑文件夹中的所有类以从某个基类继承？

> ID：12320609
> 
> 赞同：2
> 
> 时间：2012-09-07T14:59:30.670
> 
> 标签：c#, visual-studio, resharper

我在一个文件夹中有 60 个左右的类，我为这些类创建了一个基类来继承。

除了 Visual Studio 中的复制和粘贴方法之外，还有其他自动方法吗？

我希望 resharper 有一些功能，但找不到。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T15:11:40.987

您可以使用 Visual Studio 的搜索和替换功能来自动执行剪切/粘贴过程，以查找所有声明，并将它们替换为从您的基类继承的声明。

*   按 [Ctrl+H] 打开快速替换
*   `public class {:i}`在“查找内容”框中输入
*   `public class \1 : MyBaseClass`在“替换为：”框中输入
*   在“查找范围：”框中选择“当前项目”
*   选中“使用：”复选框，然后在下拉列表中选择“正则表达式”

继续单击`[Find Next]`以查找下一个类声明的出现。如果搜索突出显示您要修改的 60 个声明之一，请单击`[Replace]`，否则继续单击`[Find Next]`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T15:30:04.227

这个正则表达式应该可以解决问题：

```
(.*)?(class .*)?(.*)?{ 
```

它匹配任意数量的字符，后跟单词“class”，后跟任意数量的字符，后跟大括号。

在所有代码文件中执行替换，将其用作替换文本：

```
$1 : yourBaseClassName { 
```

这已经使用[这个](http://www.regular-expressions.info/javascriptexample.html)在线正则表达式验证器进行了测试，它处理 js 正则表达式，并假设您的文件**尚未**实现子类/接口。原始的，但可以作为一个起点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T15:06:52.187

您可以编写一个工具并将其用作[预构建事件](http://msdn.microsoft.com/en-us/library/ke5z92ks.aspx)。

该工具可以是一个简单的静默命令行可执行文件，它`: MyBaseClass`会在任何看起来像这样的内容的右侧写入：`class MyClassName`.
它会将路径作为参数，并针对在其中找到的每个 *.cs 文件执行此操作。

据我所知，这是最接近您想要实现的目标。

您也可以尝试使用 AOP（面向属性的编程），使用[PostSharp](http://www.sharpcrafters.com/)（不是免费的）之类的工具，但是您必须使用属性标记每个类，这违背了您的目的。

# gis - ESRI Shape to GML in os Vector Map 本地格式转换器

> ID：12320610
> 
> 赞同：1
> 
> 时间：2012-09-07T14:59:34.310
> 
> 标签：gis, shapefile, esri, gml

我正在寻找某种转换器。我需要转换`ESRI Shape files (*.shp)`为`GML`（但它必须是 os`Vector Map Local`格式 - `VML`）。有人知道吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-08T15:53:20.800

GDAL 可以做到这一点，使用 ogr2ogr：

[http://www.gdal.org/ogr2ogr.html](http://www.gdal.org/ogr2ogr.html)

有关语法，请参阅[对此问题的评论。](https://gis.stackexchange.com/questions/29169/quantim-gis-python-script-to-convert-shapefile-to-gml)

# javascript - Knockout.js 双向绑定：数字格式化为字符串

> ID：12320622
> 
> 赞同：2
> 
> 时间：2012-09-07T15:00:05.420
> 
> 标签：javascript, knockout.js, knockout-mapping-plugin, knockout-2.0, knockout-validation

我的视图模型中有一堆数量是可观察的，我希望它们存储为数字，因为它们用于多个计算。但是，当我在视图中将它们绑定到文本框时，我希望它们显示为特殊格式的字符串 (1234.5678 => "1,234.57")。在这种情况下完成双向绑定的最佳方法是什么，因为我不能只将值绑定与我的 observable 一起使用？

用户需要能够在文本框中输入“1,234.56”或“1234.56”，这会将数字值 1234.56 存储在 observable 中，如果我通过 javascript 更改数字值（3450），文本框值需要更新为新值，但格式化为字符串（“3,450”）。

感谢您的帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T15:15:16.060

我会实现如下内容：

JavaScript：

```
function ViewModel() {
    var self = this;
    self.dollarAmount = ko.observable();

    self.formattedDollarAmount = ko.computed({
        read: function() {
            return applyFormat(self.dollarAmount()); // pseudocode
        },
        write: function(value) {
            var parsedDollarAmount = parseFloat(value);
            if(!isNaN(parsedDollarAmount)) {
                self.dollarAmount(parsedDollarAmount);
            }
            else {
                // recommend adding validation of some sort 
                // so getting here is less likely
                alert("invalid dollar amount"); 
            }
        },
        owner: self
    });
} 
```

HTML：

```
<input type="text" data-bind="value: formattedDollarAmount" /> 
```

有关更多信息，请参阅有关计算的 observables 的文档：http: [//knockoutjs.com/documentation/computedObservables.html](http://knockoutjs.com/documentation/computedObservables.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-30T15:25:42.800

看 ：

[http://jsfiddle.net/Ty8PG/14/](http://jsfiddle.net/Ty8PG/14/)

```
ko.bindingHandlers.numericValue = {
init : function(element, valueAccessor, allBindingsAccessor) {
    var underlyingObservable = valueAccessor();
    var interceptor = ko.computed({
        read: underlyingObservable,
        write: function(value) {

                underlyingObservable(rawNumber(value));

        } 
    });
    ko.bindingHandlers.value.init(element, function() { return interceptor }, allBindingsAccessor);
},   
update : function(element, valueAccessor, allBindingsAccessor) {
element.value = number_format(valueAccessor()(), 2);

} 
```

};

原帖：

[https://groups.google.com/forum/#!topic/knockoutjs/gvhJt4iSOLk](https://groups.google.com/forum/#!topic/knockoutjs/gvhJt4iSOLk)

# php - 在代理类中显式调用 PHP 析构函数？

> ID：12320624
> 
> 赞同：0
> 
> 时间：2012-09-07T15:00:07.280
> 
> 标签：php

我正在用 PHP 编写一个代理类。

为此，我使用魔术方法来捕获对代理实例的调用/获取/设置...，并将它们转发到该实例。

但是，我不确定在这种情况下该怎么做：

```
class Proxy {

    // Proxied object
    private $instance;

    // ...

    function __destruct() {
        // unset($this->instance); ?
        // $this->instance->__destruct(); ?
        // nothing ?
    }

} 
```

我应该（我可以）显式调用析构函数吗？或者我应该只是取消设置对象，知道它不会真正摧毁它（至少，立即）？

还是我应该什么都不做，等待垃圾收集器销毁实例？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:01:15.293

不要做任何事。垃圾收集器会处理它，可能与代理差不多同时进行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:20:30.830

我强烈建议您不要在代理死亡时释放实例类。我不确定你是如何在你的代码库中做事的，但有可能某些东西仍然会引用你的实例类。让 GC 处理它更安全。析构函数在 PHP 中很少有用。

# php - 对 Doctrine 2 模块“ObjectExists.php”的这条评论稍加说明

> ID：12320625
> 
> 赞同：2
> 
> 时间：2012-09-07T15:00:14.353
> 
> 标签：php, doctrine-orm

我现在正在使用 Doctrine 2 的东西，并使用 Doctrine 模块进行验证，例如`ObjectExists.php`和`NoObjectExists.php`.

我的问题是从原始代码中可以找到[here](https://github.com/doctrine/DoctrineModule/blob/master/src/DoctrineModule/Validator/ObjectExists.php)。

```
 /**
     * Constructor
     *
     * @param array $options required keys are `object_repository`, which must be an instance of
     * Doctrine\Common\Persistence\ObjectRepository, and `fields`, with either
     * a string or an array of strings representing the fields to be matched by the validator.
     * @throws \Zend\Validator\Exception\InvalidArgumentException
     */
    public function __construct(array $options)
    {
        if (!isset($options['object_repository']) || !$options['object_repository'] instanceof ObjectRepository) {
            if (!array_key_exists('object_repository', $options)) {
                $provided = 'nothing';
            } else {
                if (is_object($options['object_repository'])) {
                    $provided = get_class($options['object_repository']);
                } else {
                    $provided = getType($options['object_repository']);
                }
            }

            throw new Exception\InvalidArgumentException(sprintf(
                'Option "object_repository" is required and must be an instance of'
                    . ' Doctrine\Common\Persistence\ObjectRepository, %s given',
                $provided
            ));
        }

        $this->objectRepository = $options['object_repository'];

        if (!isset($options['fields'])) {
            throw new Exception\InvalidArgumentException(
                'Key `fields` must be provided and be a field or a list of fields to be used when searching for'
                    . ' existing instances'
            );
        }

        $this->fields = $options['fields'];
        $this->validateFields();

        parent::__construct($options);
    } 
```

我无法理解这里提到的*“`$options`必需的键是`object_repository`，它必须是`Doctrine\Common\Persistence\ObjectRepository`”的一个实例*

既然`Doctrine\Common\Persistence\ObjectRepository`是接口，我应该如何解码该语句？

或者换句话说，我怎样才能调用这个`ObjectsExists`类的构造函数并传递`object_repository`，它必须是一个实例`Doctrine\Common\Persistence\ObjectRepository`？

有人可以对此有所了解吗，我正在研究这些东西，所以不要对我的问题苛刻。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:10:14.743

由于`Doctrine\Common\Persistence\ObjectRepository`是一个接口，您无法实例化它，但您可以实现它。

```
class MyObjectRepository implements Doctrine\Common\Persistence\ObjectRepository
{
    // ...
} 
```

现在 will的每个实例`MyObjectRepository`都满足.`object_repository``ObjectsExists`

```
new ObjectsExists(array(
    'object_repository' => new MyObjectRepository(),
    // ...
)); 
```

* * *

更多关于[`instanceof`](http://php.net/manual/en/language.operators.type.php)：

> `instanceof`用于判断一个PHP变量是否是某个类的实例化对象。
> 
> `instanceof`也可以用来判断一个变量是否是继承自父类的类的实例化对象。
> 
> `instanceof`也可以用来判断一个变量是否是一个实现了接口的类的实例化对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T21:29:43.193

实现 Doctrine\Common\Persistence\ObjectRepository 的最常见的类是 Doctrine\ORM\EntityRepository。

因此，如果您使用 Doctrine ORM，则 object_repository 选项应该类似于您的 UserRepository （明确定义，或者只是您从中返回的通用选项`$em->getRepository('User')`）

它没有明确定义的原因是因为 [No]ObjectExists 验证器不在 DoctrineORMModule 中，而只是在 DoctrineModule 中。所以如果你*不*使用 ORM，你只需要创建你自己的实现 ObjectRepository 的 UserRepository 类。

# jquery - “直接链接到任何幻想框”，但在地址栏中带有 URL

> ID：12320630
> 
> 赞同：4
> 
> 时间：2012-09-07T15:00:39.440
> 
> 标签：jquery, url, hyperlink, fancybox, address-bar

我看了一下这篇文章[How to create a direct link to any fancybox box](https://stackoverflow.com/questions/9028310/how-to-create-a-direct-link-to-any-fancybox-box)并且我设法实现了它。但是，我注意到每当有人单击图像时，URL 都不会改变。所以，基本上，脚本所做的只是让我将图像的链接提供给人们。如果人们想自己捕捉图像链接并分享它们怎么办？当人们浏览网站时，是否还可以在地址栏中显示不同的图像 URL？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-07T16:48:20.333

如果我理解正确：

*   当访问者点击图片时，图片会在fancybox中弹出。
*   当访问者导航到 page.html#image01 时，页面会加载已显示在 fancybox 中的 image01。
*   当访问者单击 image02 时，您希望 url 更新为 page.html#image02。

在这种情况下，您可以在单击图像时设置 url 哈希片段。

```
location.hash  = "image02"; 
```

使用您提供的示例：

```
var thisHash = window.location.hash;
$(document).ready(function() {
    $('.thumbs').fancybox({
        prevEffect: 'fade',
        nextEffect: 'fade',
        closeBtn: true,
        arrows: true,
        nextClick: true,
        padding: 15,
        helpers: {
            thumbs: {
                width: 80,
                height: 80
            }
        },
        beforeShow: function() {
            var id = this.element.attr("id")
            if (id) {
                window.location.hash = id;
            }
        },
        beforeClose: function() {
            window.location.hash = "";
        }
    });

    if (thisHash) {
        $(thisHash).trigger('click');
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-04T15:34:17.707

我使用了 Greg 的代码，但我使用了这些选项（并以不同的方式引用 id，因为 Greg 的方式对我不起作用）：

```
 onStart: function(selectedArray, selectedIndex, selectedOpts) { 
        var id = $(selectedArray[ selectedIndex ]).attr('id');

        if (id) {
            window.location.hash = id;
        }
    },
    onClosed: function() {
        window.location.hash = "";
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-20T16:19:50.390

```
演出前：函数（）{
    var id = $(this.element).attr("href");

    如果（身份证）{
        window.location.hash = id;
    }
},
关闭后：函数（）{
    history.pushState("", document.title, window.location.pathname + window.location.search);
},
```

# boost - 显式调用 ~boost::lock_guard<> 导致互斥锁死锁

> ID：12320632
> 
> 赞同：2
> 
> 时间：2012-09-07T15:00:42.423
> 
> 标签：boost, mutex

如果这是一个错误，我只是不这样做没有问题，但如果这是预期的行为，我想知道为什么。

我做这样的事情：

```
{
   boost::lock_guard<boost::mutex> lg(tagsToSocketsMtx);
// mutex protected work 
   lg.~lock_guard(); // this causes deadlocks later(combined with ...
  //...other uses of the same mtx, ofc I use different lock guard in other functions)

// rest of the function
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:04:05.357

一旦构建`lg`完成，C++ 保证它的析构函数将在范围退出时被调用，*而不管您是否也在进行显式的析构函数调用*。

通过销毁`lg`两次，您正在调用未定义的行为，在这种情况下，错误表现为死锁。

# delphi - 类型转换 TArray 是否安全 到 X 的数组？

> ID：12320635
> 
> 赞同：16
> 
> 时间：2012-09-07T15:00:48.487
> 
> 标签：delphi, generics, casting, delphi-xe2, dynamic-arrays

今天我发现了一个编译器错误（[QC#108577](http://qc.embarcadero.com/wc/qcmain.aspx?d=108577)）。

以下程序无法编译：

```
program Project1;
{$APPTYPE CONSOLE}

procedure P(M: TArray<TArray<Integer>>);
begin
  SetLength(M, 1, 2);
end;

begin
end. 
```

编译器`SetLength`在线上堵嘴并说：

```
[dcc32 Error] E2029 ')' expected but ',' found 
```

我知道我可以这样修复它：

```
procedure P(M: TArray<TArray<Integer>>);
var
  i: Integer;
begin
  SetLength(M, 1);
  for i := low(M) to high(M) do
    SetLength(M[i], 2);
end; 
```

但自然我很想避免诉诸于此。

以下变体编译并且似乎可以工作：

```
procedure P(M: TArray<TArray<Integer>>);
type
  TArrayOfArrayOfInteger = array of array of Integer;
begin
  SetLength(TArrayOfArrayOfInteger(M), 1, 2);
end; 
```

我对动态数组、`TArray<T>`强制转换、引用计数等的实现细节知之甚少，无法确信这是安全的。

有没有人知道足够的方式来说明这是否会在运行时产生正确的代码？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-07T17:07:30.943

编译器内在过程`SetLength`在堆栈上动态构造一个维度数组，并调用`DynArraySetLength`任何动态数组，无论它是通用的还是非通用的。如果通用数组在结构上与常规动态数组不兼容，则可能不会调用用于设置长度的相同实现。

事实上，作为多维数组的替代品的报价[文档。](http://docwiki.embarcadero.com/Libraries/en/System.DynArraySetLength)也可以用来代替类型转换，但我看不出有任何理由偏爱其中一种。 `DynArraySetLength``SetLength``DynArraySetLength`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T16:33:41.043

*根据*泛型实现的设计，使用手动映射`array of array of Integer`将起作用。

但是在这里使用泛型没有任何好处！

只需代码：

```
type
  TArrayOfArrayOfInteger = array of array of Integer;

procedure P(M: TArrayOfArrayOfInteger);
begin
  SetLength(TArrayOfArrayOfInteger, 1, 2);
end; 
```

另请注意，此类`TArray<>`or`array of ..`是按值传递的，并在堆栈上复制，除非您指定`const`or `var`：

```
procedure P(var M: TArrayOfArrayOfInteger);
begin
  SetLength(TArrayOfArrayOfInteger, 1, 2);
end; // now caller instance of the parameter will be resized

var A: TArrayOfArrayOfInteger;
...
A := nil;
P(A);
assert(length(A)=1);
assert(length(A[0])=2); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-07T23:26:39.357

我最近被以下事实所困扰，`DynamicArray<T>`在`TArray<T>`C++ 中和实际上是不同的实现（`DynamicArray`是一个独立的类，而是`TArray`一个`TObject`后代），这意味着在 Delphi 中`array of T`也`TArray<T>`确实存在一些实现差异。至少，他们肯定会产生不同类型的 RTTI。这是我的一些 C++ 代码中出现问题的根本原因，当 Delphi 编译器开始`TArray`在 HPP 文件中为 Delphi`array of ...`类型而不是`DynamicArray`typedef 输出 typedef 时，该代码开始失败。

# eclipse - eclipse中的代理配置

> ID：12320648
> 
> 赞同：0
> 
> 时间：2012-09-07T15:01:20.197
> 
> 标签：eclipse, ubuntu, proxy, socks

我在 Ubuntu 12.04 中的 Eclipse 3.7.2 中的代理有问题。Eclipse 是从 Ubuntu 存储库安装的。

我已经在 Network Preferences 中配置了 HTTP 和 HTTPS 代理，并按照许多人的建议保持 SOCKS 清晰。但是eclipse无论如何都说需要HTTP代理身份验证。

此致

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:59:37.787

在 Ubuntu 网络配置对话框中设置系统范围的代理设置。

在 eclipse.ini 中添加以下行：-Dorg.eclipse.ecf.provider.filetransfer.excludeContributors=org.eclipse.ecf.provider.filetransfer.httpclient

在 Eclipse 中的 Network Connections 中，将 Active Provider 设置为“native”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T07:58:15.333

我不工作，因为我使用 OpenJDK。如果在标准对话框中使用 oracle 的 java 和 eclipse 代理配置可以正常工作。

# php - 良好的评级/声誉系统？

> ID：12320649
> 
> 赞同：14
> 
> 时间：2012-09-07T15:01:21.857
> 
> 标签：php, mysql, algorithm, rating-system

我正在一个与 Yahoo! 非常相似的网站上工作。答案：用户可以发布问题，等待其他人的答案并选择更好的答案。为了识别最佳用户，有一个信誉系统，它具有以下功能：

*   一个人可以对一个用户投赞成票或反对票；
*   可以对答案投赞成票或反对票；
*   每个主题都有一个“经验”分数，每回答一个问题就会增加。

现在，如果可能的话，我想找到一种算法来结合所有这些因素，并为每个答案给出一个“可信度”分数。

到目前为止，我尝试使用诸如产品之类的东西自己做`Coefficient * (UpVotes / TotalVotes)`，但它太线性了。我也尝试了其他方法，但它们不起作用（贝叶斯算法）。目前，在 Alpha 版本中，我使用的是`Trustability = sqrt(GoodAnswers)`.

注意：算法必须是单独的（无需扫描整个数据库来获取平均值、总和等数据）并且尽可能快。我将在 PHP-MySQL 中实现它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T15:11:12.463

排名系统有很多方法。使用时间维度、赞成/反对票数、赞成票和反对票的评分、点击率以及几乎任何你能想象到的东西。

[Reddit](http://amix.dk/blog/post/19588)中有一篇关于排名系统的好文章。

The most straightforward solution that came up in my mind is to calculate some weight of upvote for individual user. That means that more trusted user is more influential than another one. E.g. user with rating 100 upvote is definitely better than downvote from two users with rating -100\. But we can't say that this is better than 100 downvotes from -100 users. try to experiment wit that.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T15:06:08.083

您可以使用与 google 页面排名相同的想法：当用户为您投票或将您的问题\答案添加为收藏时，您的可信度的增加取决于此用户的可信度。

[http://en.wikipedia.org/wiki/PageRank](http://en.wikipedia.org/wiki/PageRank)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T15:09:03.727

使用类似 ELO/Glicko 的系统。每个用户都从标准值开始，然后考虑像一对一匹配的结果一样投反对票或反对票。

# c# - Linq - 根据属性将列表组合成对

> ID：12320650
> 
> 赞同：7
> 
> 时间：2012-09-07T15:01:28.663
> 
> 标签：c#, linq

我有一个对象列表，该列表具有可用于将对象分成对的属性。我事先知道每个对象都是一对的一部分。

下面是一个例子来说明这种情况：

* * *

我有一个单鞋清单，我想把它们分成几双。

假设我的清单如下：

```
List<Shoe> shoes = new List<Shoe>();

shoes.Add(new Shoe { Id = 19, Brand = "Nike", LeftOrRight = LeftOrRight.L });
shoes.Add(new Shoe { Id = 29, Brand = "Nike", LeftOrRight = LeftOrRight.R });
shoes.Add(new Shoe { Id = 11, Brand = "Nike", LeftOrRight = LeftOrRight.L });
shoes.Add(new Shoe { Id = 60, Brand = "Nike", LeftOrRight = LeftOrRight.R });
shoes.Add(new Shoe { Id = 65, Brand = "Asics", LeftOrRight = LeftOrRight.L });
shoes.Add(new Shoe { Id = 82, Brand = "Asics", LeftOrRight = LeftOrRight.R }); 
```

我想将这些鞋子成对输出，如下所示：

```
一对：
ID：19，品牌：耐克，左或右：L
ID：29，品牌：耐克，左或右：R

一对：
ID：11，品牌：耐克，左或右：L
ID：60，品牌：耐克，左或右：R

一对：
ID：65，品牌：Asics，左或右：L
ID：82，品牌：Asics，左或右：R

```

请注意，单只鞋只能作为单双的一部分存在。

我尝试使用以下代码对鞋子进行分组，但显然缺少配对：

```
var pairsByBrand = shoes.GroupBy(s => s.Brand);
foreach (var group in pairsByBrand)
{
    Console.WriteLine("Pair:");
    foreach (var shoe in group)
    {
        Console.WriteLine(shoe);
    }
    Console.WriteLine();
} 
```

* * *

可以使用哪些语句将这些项目分组？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-07T15:20:57.693

纯函数 LINQ，使用`SelectMany`and `Zip`，产生一个`IEnumerable`s `Tuple`：

```
IEnumerable<Tuple<Shoe, Shoe>> pairs = shoes
    .GroupBy(shoe => shoe.Brand)
    .SelectMany(brand=>
        Enumerable.Zip(
            brand.Where(shoe=>shoe.LeftOrRight == LeftOrRight.L),
            brand.Where(shoe=>shoe.LeftOrRight == LeftOrRight.R),
            Tuple.Create
        )
    ); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T15:13:53.910

```
var shoesByBrand = shoes.GroupBy(s => s.Brand);
foreach (var byBrand in shoesByBrand)
{
    var lefts = byBrand.Where(s => s.LeftOrRight == LeftOrRight.L);
    var rights = byBrand.Where(s => s.LeftOrRight == LeftOrRight.R);
    var pairs = lefts.Zip(rights,(l, r) => new {Left = l, Right = r});

    foreach(var p in pairs)
    {
        Console.WriteLine("Pair:  {{{0}, {1}}}", p.Left.Id, p.Right.Id);
    }

    Console.WriteLine();
} 
```

注意：Zip 只会尽可能多地配对。如果您有额外的权利或权利，他们将不会被举报。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-07T15:23:49.823

一种方法：

```
var pairs = shoes.GroupBy(s => s.Brand)
                 .Select(g => g.GroupBy(s => s.LeftOrRight));
                 .SelectMany(Enumerable.Zip(g => g.First(), g => g.Last(),Tuple.Create)); 
```

这可能是对我最初想法（[由 Thom Smith 很好地实现](https://stackoverflow.com/a/12320989/50079)）的改进，因为对于每个品牌的鞋子，它通过仅迭代一次集合将它们分成左右鞋子。直觉说如果有很多鞋子的品牌应该会更快。

它的作用是按品牌对鞋子进行分组，然后在每个品牌内按左/右分组。然后它继续随机匹配每个品牌的左鞋和右鞋，依次为所有品牌匹配。

# mysql - play框架——连接linux mysql

> ID：12320651
> 
> 赞同：1
> 
> 时间：2012-09-07T15:01:31.423
> 
> 标签：mysql, linux, playframework, playframework-1.x

我是新的游戏框架。我正在尝试连接到 linux 服务器上的 mysql 数据库。它不工作！

我收到一个错误：

> 发生数据库错误：无法连接到数据库，通信链路故障最后一个成功发送到服务器的数据包是 0 毫秒前。驱动程序没有收到来自服务器的任何数据包。

无论如何，我可以通过我的 MySQL Work bench 连接 linux 服务器。

```
application.mode=dev
%prod.application.mode=prod

jpa.ddl=update

db.url=jdbc:mysql://<ipaddress>:3306/<database>?useUnicode=false&characterEncoding=ISO-8859-1&connectionCollation=utf8_swedish_ci
db.driver=com.mysql.jdbc.Driver
db.user=<user>
db.pass=<password> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T18:58:11.283

确保您在配置文件中具有正确的 mysql ip 地址和端口号（以及正确的用户名/密码）。

您可以检查 mysql 是否正在侦听端口（尝试 netstat -an | grep 3306）。

# asp.net-mvc-3 - 显示来自 ViewBag 的列表的对象错误

> ID：12320655
> 
> 赞同：0
> 
> 时间：2012-09-07T15:01:47.000
> 
> 标签：asp.net-mvc-3, asp.net-mvc-2, razor

在控制器中，我使用类型（TypeID，名称）填充 ViewBag

```
ViewBag.Types = types.ToList(); 
```

然后在视图中

```
@foreach (var item in ViewBag.Types)
    {
       @item.Name
} 
```

此错误：“对象”不包含“名称”的定义

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:06:49.790

ViewBag , ViewData 或此类动态 Magic 项目是**邪恶**的，因为它们永远不会告诉您您的视图是否由于拼写错误而失败，而使用强类型模型时，当出现问题时您会收到编译时错误。此外，您还可以获得 Intellisense 支持。

为什么不使用**强类型**方法？

```
public ActionResult Create()
{
  return View(types.ToList());
} 
```

并使您的视图强类型化到对象/对象

```
@model IList<Types>
@foreach(var item in Model)
{
  <p>@item.Name</p>
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:17:30.863

假设您的类型是`foo`. 以您的方式通过您`ViewBag.Types`的方式，并在视图中执行此操作：

```
@{
    var TypeList= (List<foo>)ViewBag.Types;
} 
```

然后做：

```
@foreach (var item in TypeList)
    {
       @item.Name
    } 
```

注意：您可能需要写入`foo`实体的完整路径

# sql - SQL在所有具有相同值的列中生成空值

> ID：12320658
> 
> 赞同：0
> 
> 时间：2012-09-07T15:02:05.207
> 
> 标签：sql, sql-server-2005

我有一个场景，我在该表中生成一个临时表，我必须删除重复值，如....

```
id      Ref_No  css_no  haz_no  Emp_no  X-Fac       Y-Fac   Location    street_name     Locale  town_name   admin_area
341139  317000334   NULL    NULL    37101195    588550.00   185922.00       SUTTON ROAD     SOUTHEND-ON-SEA SOUTHEND-ON-SEA
477641  317000334   NULL    NULL    37100003    582297.00   582297.00   ttttttttttttttttttttttttttttttttttttttttttttttttt.....  ABERDEEN GARDENS        LEIGH-ON-SEA    SOUTHEND-ON-SEA
477641  317000334   NULL    NULL    37100003    85000.00    85000.00    ttttttttttttttttttttttttttttttttttttttttttttttttt.....  ABERDEEN GARDENS        LEIGH-ON-SEA    SOUTHEND-ON-SEA
477641  317000334   NULL    NULL    37100003    85000.00    85000.00    ttttttttttttttttttttttttttttttttttttttttttttttttt.....  ABERDEEN GARDENS        LEIGH-ON-SEA    SOUTHEND-ON-SEA
477649  317000334   NULL    NULL    37100004    591278.00   591278.00   aaaaaaaaaaaaaaaaaaaa    ACACIA DRIVE    THORPE BAY  SOUTHEND-ON-SEA SOUTHEND-ON-SEA
477651  317000334   NULL    NULL    37101738    593365.00   593365.00   adfasdsfwerwer  ADJACENT TO 51 SANDPIPER CLOSE  SHOEBURYNESS    SOUTHEND-ON-SEA SOUTHEND-ON-SEA
477661  317000334   NULL    NULL    37100036    589791.00   187149.00       ARCHER AVENUE       SOUTHEND-ON-SEA SOUTHEND-ON-SEA
487012  317000334   NULL    NULL    42203885    359280.00   359280.00   yuiuyiuy    ABERDARE CLOSE  BURTONWOOD AND WESTBROOK    WARRINGTON  WARRINGTON 
```

我希望这个表输出为......

```
id      Ref_No  css_no  haz_no  Emp_no  X-Fac       Y-Fac   Location    street_name     Locale  town_name   admin_area
    341139  317000334   NULL    NULL    37101195    588550.00   185922.00       SUTTON ROAD     SOUTHEND-ON-SEA SOUTHEND-ON-SEA
    477641  317000334   NULL    NULL    37100003    582297.00   582297.00   ttttttttttttttttttttttttttttttttttttttttttttttttt.....  ABERDEEN GARDENS        LEIGH-ON-SEA    SOUTHEND-ON-SEA
                        NULL    NULL                85000.00    85000.00    
                        NULL    NULL                85000.00    85000.00    
    477649  317000334   NULL    NULL    37100004    591278.00   591278.00   aaaaaaaaaaaaaaaaaaaa    ACACIA DRIVE    THORPE BAY  SOUTHEND-ON-SEA SOUTHEND-ON-SEA
    477651  317000334   NULL    NULL    37101738    593365.00   593365.00   adfasdsfwerwer  ADJACENT TO 51 SANDPIPER CLOSE  SHOEBURYNESS    SOUTHEND-ON-SEA SOUTHEND-ON-SEA
    477661  317000334   NULL    NULL    37100036    589791.00   187149.00       ARCHER AVENUE       SOUTHEND-ON-SEA SOUTHEND-ON-SEA
    487012  317000334   NULL    NULL    42203885    359280.00   359280.00   yuiuyiuy    ABERDARE CLOSE  BURTONWOOD AND WESTBROOK    WARRINGTON  WARRINGTON 
```

同样，我需要删除再次返回的值并重新获取相同的信息...任何人都可以帮我解决这个问题...并且每次都会根据条件生成表格，因此值可能不是一直都一样...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T23:20:24.017

这是显示问题，因此最好在客户端应用程序中处理。但是，如果您别无选择，只能在 t-sql 中执行此操作，您可以使用[row_number() over()](http://msdn.microsoft.com/en-us/library/ms186734%28v=sql.90%29.aspx)来隔离某个值的第一次出现，以及[何时](http://msdn.microsoft.com/en-us/library/ms181765%28v=sql.90%29.aspx)将所有其他出现的值替换为空字符串：

```
; with cte as
(
  select *,
         row_number() over(partition by id
         -- determine order by detail table.
         -- I don't know your schema.
                           order by [y-fac]) rn
    from tempTable
)
select case when rn = 1
            then convert(varchar(20), id)
            else ''
        end as id,
       case when rn = 1
            then convert(varchar(20), Ref_No)
            else ''
        end as Ref_No,
       css_no,
       haz_no,
       case when rn = 1
            then convert(varchar(20), Emp_no)
            else ''
        end as Emp_no,
       X-Fac,
       Y-Fac,
       case when rn = 1
            then Location
            else ''
        end as Location,
       case when rn = 1
            then street_name
            else ''
        end as street_name,
       case when rn = 1
            then Locale
            else ''
        end as Locale,
       case when rn = 1
            then town_name
            else ''
        end as town_name,
       case when rn = 1
            then admin_area
            else ''
        end as admin_area
from cte
order by id, rn 
```

由于这看起来像主详细信息，因此您可以在使用左连接插入主详细信息时执行相同操作，前提是这是第一行详细信息：

```
; with ordered as
(
  select *,
         row_number() over (partition by master_id
                            order by detail_id) rn
    from detail
)
insert into tempTable ( ... )
select ...
  from ordered
  left join master
    on ordered.master_id = master.master_id
   and ordered.rn = 1 
```

这只会将主数据添加到第一行明细。其他行将包含空值。

# tcsh - 是否可以删除历史记录中的特定命令？

> ID：12320659
> 
> 赞同：1
> 
> 时间：2012-09-07T15:02:06.773
> 
> 标签：tcsh

我设法在我的命令历史记录中获得了一个*非常长的命令。*有没有办法摆脱它，这样`history`命令就不会变得疯狂？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T15:06:31.427

根据我看到的文档，您可以通过查看文件找出您的历史存储在哪里：

```
/usr/share/init/tcsh/tcsh.defaults 
```

对于线路：

```
set histfile = ~/.tcsh_history # History file 
```

然后（希望）您应该能够编辑`~/.tcsh_history`（或任何实际的历史文件）并删除长命令。

[参考](http://lists.apple.com/archives/darwinos-users/2001/Oct/msg00421.html)

# c# - 如何解密 TrafficScript 加密值

> ID：12320663
> 
> 赞同：0
> 
> 时间：2012-09-07T15:02:10.197
> 
> 标签：c#, encryption, zeus

我们正在使用在 Stingray 流量管理器下运行的 TrafficScript 来加密字符串并将该加密值存储在 cookie 中。像这样：

```
$encrypt = "string to encrypt";
$passphrase = "passphrase";
$encrypted= string.base64encode(string.encrypt($encrypt, $passphrase));

http.setResponseCookie("encrypted", $encrypted, "path=/"); 
```

然后我想做的是在 C# 中解密该 cookie 值，但是，到目前为止我还无法实现它。我怀疑这是因为 TrafficScript 使用的算法的确切细节没有完整记录。参考指南指出：

> **string.encrypt( string, passphrase )** - 使用提供的密码短语加密字符串。返回的字符串使用 AES 分组密码进行加密，使用密码短语的扩展形式作为密码密钥。还添加了 MAC 以确保字符串的完整性。

我试过 AesManaged 但得到一个异常'*要解密的数据长度无效*'。

任何人都可以提供任何指示吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T10:07:37.637

我没有设法找到纯粹使用 TrafficScript 的方法。

所以我最终编写了一个 Java 扩展并从我的 TrafiicScript 规则中运行它。这是通过重用[Joseph Ssenyange](http://zenu.wordpress.com/2011/09/21/aes-128bit-cross-platform-java-and-c-encryption-compatibility/)在博客中发布的一些代码来实现的，该博客详细介绍了如何为 Java 和 C# 编写跨平台加密。

# jquery - jQuery fadeIn fadeOut 并不总是以相同的方式工作

> ID：12320668
> 
> 赞同：2
> 
> 时间：2012-09-07T15:02:35.277
> 
> 标签：jquery, html, jquery-animate

[我对这个http://jsfiddle.net/8ePKP/21/](http://jsfiddle.net/8ePKP/21/)有一个问题， 当单击链接时，我希望活动 div 会随着fadeOut 消失，所选的 div 会随着fadeIn 出现。但是动画在向前和向后点击时的工作方式不同.我希望过渡总是一样的。这有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:20:06.747

使用这个 CSS：

```
.pages_of_menu{
    position: absolute;
    display: none;
}

.pages_of_menu.active {
    display: block;
} 
```

你的 JS 是对的，但它可以像这样变得更好：

```
$(document).ready(function() {

    var menu_index=-1;
    var menu_pages=$(".pages_of_menu");

    $("#left_panel_div a").click(function(){
          menu_index=$(this).parent('li').index();
          menu_pages.fadeOut(500);
          $($(".pages_of_menu").get(menu_index)).fadeIn(500);
    });

}); 
```

演示：http: [//jsfiddle.net/K5bbL/](http://jsfiddle.net/K5bbL/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:05:14.173

您的页面需要绝对定位，以便它们堆叠。

[http://jsfiddle.net/8ePKP/23/](http://jsfiddle.net/8ePKP/23/)

```
.pages_of_menu{
    margin: 0px;
    padding: 0px;
    height: 200px;
    width: 150px;
    position: absolute;
} 
```

否则，您必须等到上一页完全淡出后才能淡入下一页。

# javascript - 你如何平滑地为 twitter-bootstrap 进度条设置动画？

> ID：12320669
> 
> 赞同：11
> 
> 时间：2012-09-07T15:02:37.583
> 
> 标签：javascript, coldfusion, twitter-bootstrap

我在屏幕底部有一个 30 秒计时器的多人游戏。如果 30 秒内没有玩家移动，则表单提交。

```
var ProgressValue = 0;
function showProgress() {
    ProgressValue += 100/30;
    if (ProgressValue > 100) {
        $('form').submit();
    }
    // Ajax is done here to see if anyone has made a move.
    $('.progress .bar').css('width',ProgressValue + '%');
    setTimeout(showProgress, 1000);
}

setTimeout(showProgress, 1000); 
```

每一秒，我都会检查 Application 范围以查看是否有人更改了

```
Application.LastMove 
```

我希望进度条能够流畅地动画，但我不想通过减少超时值来做到这一点。我认为每秒检查是否有人采取了行动，这对服务器来说已经足够负载了。

我听说过 WebSockets，但我当前的服务器是在 ColdFusion 8 上，所以（我认为）我对每秒执行一次 ajax 调用感到满意，除非你觉得 ajax 不那么优雅并且来自不太文明的时代。

问：您如何将 twitter-bootstrap 进度条从 3.3% 平滑地设置为 6.6%？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-08T17:27:16.597

不要使用 jQuery 制作动画，更喜欢 CSS 动画，除非你必须支持旧浏览器。

我已经从 Bootstrap 样式进行了此复制：

```
.bar {
  -webkit-transition: width 30.0s ease !important;
     -moz-transition: width 30.0s ease !important;
       -o-transition: width 30.0s ease !important;
          transition: width 30.0s ease !important;
} 
```

对于这么长的过渡，我建议你尝试不同的动画：[http ://www.the-art-of-web.com/css/timing-function/](http://www.the-art-of-web.com/css/timing-function/)

在我的示例中，我添加了两个可能有用的东西：

1.  动画开始和结束时按钮文本会发生变化（仅用于检查动画时间）
2.  检查浏览器是否支持此动画：您可以使用 jQuery 代码作为后备模式

有关如何检测 CSS 动画支持的更多信息：[https ://developer.mozilla.org/en-US/docs/CSS/CSS_animations/Detecting_CSS_animation_support](https://developer.mozilla.org/en-US/docs/CSS/CSS_animations/Detecting_CSS_animation_support)

示例：http: [//jsfiddle.net/CUbgr/5/](http://jsfiddle.net/CUbgr/5/)

# javascript - 如何使用 zurbs 基金会的轨道滑块显示字幕？

> ID：12320670
> 
> 赞同：2
> 
> 时间：2012-09-07T15:02:37.550
> 
> 标签：javascript, slider, zurb-foundation, captions, orbit

我一直试图解决这个问题。任何建议/修复将不胜感激！

来源：[我的来源](http://gorillagency.com/orbit-test/)

**问题：**字幕不显示

html（用于轨道滑块）：

```
<div><img class="art-work" src="art/2.png" alt="" data-caption="#htmlCaption1" /></div>
<div><img class="art-work" src="art/3.png" alt="" data-caption="#htmlCaption2" /></div>
<div><img class="art-work" src="art/4.png" alt="" data-caption="#htmlCaption3" /></div> 
```

....等等

html（用于轨道滑块标题）：

```
<span class="orbit-caption" id="htmlCaption1">Art #1</span>
<span class="orbit-caption" id="htmlCaption2">Art #2</span>
<span class="orbit-caption" id="htmlCaption3">Art #3</span> 
```

...等等

html中的js：

```
<script type="text/javascript">
   $(window).load(function() {
        $('#featured').orbit({
            bullets: true,
            timer: false,
            captions: true,
            animation: 'fade' 
        });
   });
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T15:27:11.990

这是因为您在“img”标签中拥有“data-caption”属性，而不是包装它的“div”。将其更改为以下内容，它应该可以工作

```
<div data-caption="#htmlCaption1"><img class="art-work" src="art/2.png" alt="" /></div> 
```

# jquery - Jquery 链接语法

> ID：12320672
> 
> 赞同：0
> 
> 时间：2012-09-07T15:02:53.303
> 
> 标签：jquery, delay, mouseenter, mouseleave

调用`mouseenter()`事件...暂停...`mouseleave()`事件的正确方法是什么？

就像是...

```
$('.some_item').each(function(index) {
    $(this).mouseenter().delay(2000*index).mouseleave();
}); 
```

...但这不起作用

[这是一个可以玩的小提琴](http://jsfiddle.net/8enTg/)

Ps 我实际上并不想改变任何东西的颜色，小提琴只是一个例子。它必须是`mouseenter()`和`mouseleave()`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:08:11.573

```
$(document).ready(function() {
    $('.some_item').mouseenter(function() {
        $(this).css('color', 'red');
    });

    $('.some_item').mouseleave(function() {
        $(this).css('color', 'green');
    });

    $('.some_item').each(function(index) {
        var $this = $(this);
        $this.mouseenter();
        setTimeout(function() { $this.mouseleave(); }, 2000*index);
    });
});​ 
```

[http://jsfiddle.net/8enTg/3/](http://jsfiddle.net/8enTg/3/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T15:08:25.943

`.mouseenter`不能耽误。你可以用它[`.queue`](http://api.jquery.com/queue/)来做到这一点

```
$('.some_item').each(function(index) {
    var elem = $(this);
    elem.mouseenter().delay(2000*index).queue(function(next){
       elem.mouseleave();
       if (next) next();
    });
}); 
```

见[小提琴](http://jsfiddle.net/orig/8enTg/2/)

# android - 在android中禁用系统警报框

> ID：12320673
> 
> 赞同：2
> 
> 时间：2012-09-07T15:02:56.167
> 
> 标签：android, sms, messaging

在我正在开发的 Android 应用程序中，有一个功能可以在应用程序运行时自动向给定号码发送短信。该功能正常工作，但在发送消息后，该消息的成本会在警报框上提示。通常，当我发送警报框提示的消息时。但是在我的应用程序中，我想禁用它，因为它会干扰我的应用程序。我怎样才能做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T15:22:52.873

> 但是在我的应用程序中，我想禁用它，因为它会干扰我的应用程序。我怎样才能做到这一点。

您所描述的是您的设备（或可能是设备+运营商）独有的东西。他们修改了 SMS 子系统（或 SMS 客户端——我不确定您是否正在使用`SmsManager`）以显示此对话框。我用过的任何设备都没有在发送短信时显示过这样的对话框。

欢迎您联系您的设备制造商，看看是否有办法禁用该对话框，但我怀疑它是否可行。

# php - Jquery 复杂的多日期选择插件

> ID：12320677
> 
> 赞同：1
> 
> 时间：2012-09-07T15:03:05.113
> 
> 标签：php, jquery, mysql

默认的[jQuery 日期选择器](http://jqueryui.com/demos/datepicker/#default)非常方便。但是，我希望能够选择单个日期、多个日期或定期日期。我的要求包括：

*   能够选择一个日期
*   能够选择 2 个或更多日期
*   能够根据一周中的天数选择定期日期。例如：日期 A 和日期 B 之间的每个星期一
*   有例外的能力。例如：日期 A 和日期 B 之间的每个星期一，日期 C、D 和 E 除外。

我想知道这样的 Jquery 插件是否存在。我也对具有相应 mysql 结构的 PHP 插件感兴趣，用于存储日期。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T19:29:57.720

这里有一些你可能想要研究的 jQuery 插件

*   [http://keith-wood.name/datepick.html](http://keith-wood.name/datepick.html)
*   [http://multidatespickr.sourceforge.net](http://multidatespickr.sourceforge.net)
*   [http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/datePickerMultiple.html](http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/datePickerMultiple.html)

# asp.net - 用于向订阅者发送电子邮件的 Orchard 模块

> ID：12320678
> 
> 赞同：1
> 
> 时间：2012-09-07T15:03:06.153
> 
> 标签：asp.net, .net, asp.net-mvc, email, orchardcms

是否有果园模块可以通过联系人列表向订阅者发送电子邮件，延迟电子邮件发送等？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T20:55:42.873

我不知道，尽管有一个用于 MailChimp 邮件服务集成的[模块。](http://gallery.orchardproject.net/List/Modules/Orchard.Module.NogginBox.MailChimp)您可能想尝试一下。

另一方面，编写这样的模块将非常容易。

# jquery - 如何在 jstree 中获取当前选定节点的文本？

> ID：12320679
> 
> 赞同：5
> 
> 时间：2012-09-07T15:03:17.187
> 
> 标签：jquery, select, text, jstree

这看起来应该很简单，但是 jstree “data.rslt.obj.text()” 方法喜欢返回当前节点的文本以及它的所有子节点。我已经弄清楚如何通过重命名节点（new_name）来获取当前节点名称，但是当我简单地选择它时，如何仅获取当前节点的文本？此外，如果我能深入了解如何使用 chrome 或 firebug 在 jstree 中找到所有这些方法和属性，我将不胜感激。例如，当我选择“data.rslt”时，我会在哪里查看出现的元素列表。谢谢！

```
 $("#RequirementsTree")
    .bind("select_node.jstree", function(event, data) {
            if(is_requirement_node(data))
            {
                var ReqCheck = data.rslt.obj.attr("name");

                @* This is a REQUIREMENT *@
                if(ReqCheck == "requirement")
                {
                    $("#RMSDoc_RequirementFlag").val("EDIT");
                    $("#RMSDoc_RBSRequirement_RequirementsId").val(data.rslt.obj.attr("id").substring(4));
                    $("#RMSDoc.RBSRequirement.RequirementsId").val(data.rslt.obj.attr("id").substring(4));
                    $("#RMSDoc_RBSRequirement_RequirementsText").val($.trim(data.rslt.obj.text()));
                    $("#RMSDoc_TreeBranch_Text").val("");
                    $("#HierarchyText").hide();
                    $("#RMSDoc_TreeBranch_Text").hide();
                    $("#ExistingTreeSubmit").val("@Model.RMSDoc.RMSEditReqButton.ConfigurableLabelDesc");

                }
                else {
                    alert("Requirement node select error");
                }
            }
            @* This is a TREE BRANCH *@
            else
            {
                debugger;
                $("#RMSDoc_RequirementFlag").val("ADD");
                $("#HierarchyText").show();
                $("#RMSDoc_TreeBranch_Text").show();
                $("#RMSDoc_TreeBranch_Text").val($.trim(data.rslt.obj.text()));
                $("#RMSDoc_TreeBranch_id").val(data.rslt.obj.attr("id").substring(4));
                $("#RMSDoc_RBSRequirement_RequirementsText").val("");
                $("#ExistingTreeSubmit").val("@Model.RMSDoc.RMSCreateReqButton.ConfigurableLabelDesc");
            }
     })
    .bind("create.jstree", function(e, data) { 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-07T15:47:05.667

如果您使用带有复选框的 jstree，则可以检查`length`复选框选择器的 。

```
if ($('.jstree-checked').length == 1) {
    alert( 'Checked Item -: ' + $('.jstree-checked').text() );
} 
```

如果您不喜欢复选框，请使用此选择器。

```
if ($('.jstree-clicked').length == 1) {
    alert( 'Selected Item -: ' + $('.jstree-clicked').text() );
} 
```

要获取 jstree 的所有项目和方法的列表，您需要在 jstree.js 文件中的 chrome 或 Firebug 中放置一个调试点。例如，您可以在 .js 中找到 .bind 方法并放置一个该特定行上的调试点..当该点命中时，您可以将鼠标悬停在参数上以一瞥其中的方法..

# windows - PowerShell 等效于 BASH（等）“类型”命令？

> ID：12320682
> 
> 赞同：10
> 
> 时间：2012-09-07T15:03:24.970
> 
> 标签：windows, shell, powershell, powershell-2.0, command-line-interface

在 *nix 上，使用 BASH（等），您可以使用内置的 'type' shell 询问系统命令所在的位置（等），如下所示：

```
$ type cat
cat is /bin/cat 
```

Microsoft PowerShell 2.0 中是否有与此“类型”命令等效的命令？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-07T15:06:10.850

一个等价物是`Get-Command`。

```
PS C:\> Get-Command ls

CommandType     Name       Definition
-----------     ----       ----------
Alias           ls         Get-ChildItem
Application     ls.exe     D:\usr\local\wbin\ls.exe
Application     ls.exe     C:\Program Files (x86)\Git\bin\ls.exe 
```

**Windows 10 更新：**

自从我发布了这个答案以来，似乎 的行为`Get-Command`已经改变。要包括所有结果（以 Un*x) 的样式`type`），现在我需要传递`-All`标志，如下所示：

```
PS C:\> Get-Command -All ls

CommandType     Name                 Version    Source
-----------     ----                 -------    ------
Alias           ls -> Get-ChildItem
Application     ls.exe               0.0.0.0    C:\Program Files (x86)\Git\usr\bin\ls.exe 
```

如评论中所述，这*不*包括`Definition`与先前行为一样的列。我无法确定添加定义列的命令行参数，但正如@voutasaurus 在下面的评论中指出的那样，可以使用：

```
PS C:\> (Get-Command -All ls).Definition
Get-ChildItem
C:\Program Files (x86)\Git\usr\bin\ls.exe 
```

版本信息供参考（我没有与原始答案文本相关的版本信息，但我猜它是 Windows 7）：

```
PS C:\> [System.Environment]::OSVersion.Version

Major  Minor  Build  Revision
-----  -----  -----  --------
10     0      15063  0 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-06-20T03:36:05.360

Get-Command 具有执行此操作的 -ShowCommandInfo 参数。它也适用于 $profile 中定义的函数：

```
PS C:\Users\vp937ll> Get-Command l -ShowCommandInfo

Name          : l
ModuleName    :
Module        : @{Name=}
CommandType   : Function
Definition    : Get-ChildItem | Sort-Object -Property LastWriteTime -Descending
ParameterSets : {@{Name=__AllParameterSets; IsDefault=False; Parameters=System.Management.Automation.PSObject[]}} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-01-01T22:21:17.523

由于您使用 Shell 对此进行了标记，因此除了 PowerShell 之外`Get-Command`，还有`where.exe`：

```
PS C:\> where.exe notepad
C:\Windows\System32\notepad.exe
C:\Windows\notepad.exe 
```

该命令只是通过路径查找具有指定名称的文件：

```
PS C:\> where.exe readme.*
C:\Python31\README.txt
C:\Program Files (x86)\wget\README
C:\Program Files (x86)\SysinternalsSuite\readme.txt 
```

请注意，从 PowerShell 调用此命令时，您必须调用它，`where.exe`因为`Where-Object`别名为`where`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-10-16T08:06:07.017

*   `Get-Command`似乎正确，别名为`gcm`
*   只需通过管道将其`Select-Object *`别名为`select *`

例如，在`$profile`我有一个从 pwd 打开总指挥官的功能（它首先默默地杀死现有实例）

```
function start-totalCommanderhere {
    $here = (Get-Location).path
    kill -n TOTALCMD64 -ErrorAction Ignore
    start "c:\totalcmd\TOTALCMD64.EXE" $here
}
Set-Alias tc start-totalCommanderhere 
```

*   这是有关该函数的所有信息 - 但是它不会直接告诉您它是一个函数，您需要查询它的正确名称而不是别名才能从`CommandType`属性中获取该信息。`type`（这与bash 中的相同`hello_world is a function`，如果它是一个，它会告诉你）

```
▶ gcm tc | select *

HelpUri             :
ResolvedCommandName : start-totalCommanderhere
DisplayName         : tc -> start-totalCommanderhere
ReferencedCommand   : start-totalCommanderhere
ResolvedCommand     : start-totalCommanderhere
Definition          : start-totalCommanderhere
Options             : None
Description         :
OutputType          : {}
Name                : tc
CommandType         : Alias
Source              :
Version             :
Visibility          : Public
ModuleName          :
Module              :
RemotingCapability  : PowerShell
Parameters          : {}
ParameterSets       : 
```

*   `gcm <module_name> | select *`如果您要求`CommandType`哪个是，则为您提供路径`Application`

```
▶ gcm ping | select *

HelpUri            :
FileVersionInfo    : File:             C:\Windows\system32\PING.EXE
                     InternalName:     ping.exe
                     OriginalFilename: ping.exe.mui
                     FileVersion:      10.0.19041.320 (WinBuild.160101.0800)
                     FileDescription:  TCP/IP Ping Command
                     Product:          Microsoft® Windows® Operating System
                     ProductVersion:   10.0.19041.320
                     Debug:            False
                     Patched:          False
                     PreRelease:       False
                     PrivateBuild:     False
                     SpecialBuild:     False
                     Language:         English (United States)

Path               : C:\Windows\system32\PING.EXE
Extension          : .EXE
Definition         : C:\Windows\system32\PING.EXE
Source             : C:\Windows\system32\PING.EXE
Version            : 10.0.19041.1
Visibility         : Public
OutputType         : {System.String}
Name               : PING.EXE
CommandType        : Application
ModuleName         :
Module             :
RemotingCapability : PowerShell
Parameters         :
ParameterSets      : 
```

*   但是`gcm`你没有得到导入模块的路径——因为你需要使用`Get-Module | Select-Object Name, Path`别名作为`gmo | select name,path`

```
▶ gmo | select name, path

Name                            Path
----                            ----
assign-vault-keys-to-env-vars   C:\Users\Admin\Documents\workspace\work.log\kb\powershell\assign-vault-keys-to-env-vars.ps1
CimCmdlets                      C:\Program Files\PowerShell\7\Microsoft.Management.Infrastructure.CimCmdlets.dll
decode-base64                   C:\Users\Admin\Documents\workspace\work.log\kb\powershell\decode-base64.ps1
DnsClient                       C:\WINDOWS\system32\WindowsPowerShell\v1.0\Modules\DnsClient\DnsClient.psd1
... 
```

# html - 如何播放托管在远程网站上的 flv 文件？

> ID：12320684
> 
> 赞同：2
> 
> 时间：2012-09-07T15:03:34.920
> 
> 标签：html, flash, flv, playback

我正在寻找播放托管在远程网站上的 Flash 视频。我尝试了以下方法（并且大量使用 google-ing）：

在[http://fakesite1.com/player.jsp](http://fakesite1.com/player.jsp)的页面源代码中：

```
<embed src = "FlashPlayer.swf?file=http://fakesite2.net/video.flv" /> 
```

我可以浏览到[http://fakesite2.net/video.flv](http://fakesite2.net/video.flv)并确保它在那里，但播放器在 fakesite1 上返回“电影未加载”（右键单击）。我最初的猜测是，这可能是某种安全功能……是否可以播放远程站点上托管的视频？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T22:18:30.833

网页中 SWF 对象的上下文菜单中显示的消息“电影未加载”表示`.swf`浏览器插件未加载该文件。主要原因是该 SWF 文件不存在并且插件出现 404 错误，在这种情况下，请确保 SWF 文件的路径设置正确。

此外，该`<embed>`元素在现代 HTML 中已过时。改为使用`<object>`，如下所示。

请注意，各种版本的 IE（IE9/10 除外，可能包括 IE8）不支持 HTML5`<object data="" />`元素，他们更喜欢 IE4 时代的`<object clsid="" />`元素，因此使用条件注释，如下所示：

```
<!--[if IE]>
<object width="640" height="480" data="http://mysite.com/myflash.swf" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" >
<![endif]-->
<!--[if !IE]>-->
<object width="640" height="480" data="http://mysite.com/myflash.swf" />
<!--<![endif]--> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T15:34:22.063

您的 SWF 文件是否准确命名为“FlashPlayer.swf”？

据我所知，在基于 Windows 的系统中，字母大小写差异并不重要，但在基于 Unix 或 Linux 的系统中，它确实很重要。您的主机可能是 Linux 主机。尝试使用小写字母，例如“flashplayer.swf”。使用将始终在线托管的文件养成这种习惯。也没有空格或特殊字符，使用 - 或 _ 分隔单词。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T15:58:50.030

尝试;

```
<embed
   src="player.swf" 
   width="300"
   height="300"
   allowscriptaccess="always"
   allowfullscreen="true"
   id="player1"
   name="player1"
   file="http://fakesite2.net/video.flv"
/> 
```

# javascript - jQuery切换功能使文本混乱

> ID：12320686
> 
> 赞同：0
> 
> 时间：2012-09-07T15:03:40.767
> 
> 标签：javascript, jquery, html

如果我单击“ *rejt* ”按钮，我有一些功能可以切换 HTML 的 2 个部分。通常它看起来像这样： ![普通的](../Images/66ca7ab262c9cf1463f5cfda31071fc4.png)

但是在使用按钮再次将其切换回来后，它会像这样扭曲： ![扭曲的](../Images/9a91e5fc426d3dc9f79e5db727d473f3.png)

请帮我解决这个问题。

代码示例：

```
function bottom() {
    var value = $('#toggle').attr('value');
    $('#bottomtext1').toggle('slow');
    $('#bottomtext2').toggle('slow');

    if (value == 'rejt'){
        $('toggle').attr('value', 'mutat');
    }
    else if (value == 'mutat') {
        $('toggle').attr('value', 'rejt');
    }
};
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<id id="bottomtext1" style="display:none;">stuff1</id>

<input type="button" value="rejt" id="toggle" onclick="bottom();">

<id id="bottomtext2" style="display:none;">stuff2</id>
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T15:09:55.113

首先，`font`and`id`标签是什么？不确定 jQuery 在切换一个对 ( `id`) 一无所知的标签时会做什么。

更重要的是，这些`id`标签都设置`display:inline-block`在切换之后，例如：

```
<id id="bottomtext2" style="display:inline-block" /> 
```

该元素与 相邻`<id id="bottomtext2" />`，也设置为`inline-block`。这将解释并排显示。

破碎的小提琴：http: [//jsfiddle.net/T8aWV/1/](http://jsfiddle.net/T8aWV/1/)
固定的小提琴：http: [//jsfiddle.net/T8aWV/](http://jsfiddle.net/T8aWV/)

摆脱`id`标签并制作它们`divs`。这解决了我的问题。

另请参阅：[HTML 5 标记的“周期表”（以及何时使用它们）](http://joshduck.com/periodic-table.html)

# php - 以相同的形式添加和编辑php

> ID：12320688
> 
> 赞同：0
> 
> 时间：2012-09-07T15:03:53.063
> 
> 标签：php, forms

我有这个代码：

```
<?php
////////////////////////////////////////
include "../includes/site_includes.php";//
//////////////////////////////////////
$sql = getallsitesettings();
if ($result = $mysqli->prepare($sql)) 
{
$rekza = 1;
$result->bind_param("i",$rekza);
$result->execute(); 
$result->store_result();
$rowsZ = $result->num_rows;
}
if($rowsZ>0)
{
$row = fetch($result);
}
$siteTitle= $row[0]["site_title"];
$sitePeleText= $row[0]["pele"];
?>
<?php

$act = $mysqli->real_escape_string($_GET["act"]);
if($act=="edit")
{
    $folderid = (int)$_GET["id"];
    $sql2 = getfolderbyId();
    if ($result2 = $mysqli->prepare($sql2)) 
    {
    $result2->bind_param("i",$folderid);
    $result2->execute();    
    $result2->store_result();
    $rowsZ2 = $result2->num_rows;
    }
    if($rowsZ2>0)
    {
    $row2 = fetch($result2);
    }
    for($j=0; $j<$rowsZ2; $j++) 
        {
    $foldername = $row2[$j]["fold_name"];
    $foldpath = $row2[$j]["fold_path"];
    $foldpic = $row2[$j]["fold_pic"];
        }
}
?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html dir="rtl">
 <head>
  <title><?=$txt_folders?></title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="Generator" content="EditPlus">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <link href="<?=$site_url?>/css/styles.css" rel="stylesheet" type="text/css" />
 </head>
    <table align="center" cellspacing="0" cellpadding="0" width="1021">
        <tr>
            <td><?php
            include "../site_header.php";
            ?></td>
        </tr>
        <tr>
            <td style="background-color:#dcdbdb;">
                    <table align="center" cellspacing="0" cellpadding="0" width="1021">
                        <tr>
                            <td>
                                <div class="admintitle">
                                <a href="../main.php" style="color:black; text-decoration:none;"><?=$txt_main_admin?></a> > <?=$txt_folders?>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <table align="center" cellspacing="0" cellpadding="0" width="400">
                                    <tr>
                                        <td style="color:Black; font-family:arial; font-weight:Bold;"><?=$txt_folders_name?></td>
                                        <td style="color:Black; font-family:arial; font-weight:normal;"><input type="textbox" name="fold_name" value="<?=$foldername?>" /></td>
                                    </tr>
                                    <tr>
                                        <td style="color:Black; font-family:arial; font-weight:Bold;"><?=$txt_folder_path?></td>
                                        <td style="color:Black; font-family:arial; font-weight:normal;"><input type="textbox" name="fold_path" value="<?=$foldpath?>" /></td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td colspan="2"></td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
            </td>
        </tr>
        <tr>
            <td><?php
            include "../site_footer.php";
            ?></td>
        </tr>
    </table>
 <body>
 </body>
</html> 
```

...你能告诉我有什么问题吗？为什么当 act = add 输入中 value="" 中的变量未定义？....我如何在编辑和添加中定义它们...在添加中我需要它们为空...并在编辑效果很好....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T23:27:11.190

或许...

```
if($act=="edit" || $act=="add") 
```

:)

# javascript - 在 Javascript 中使用 2 个税率百分比计算和显示现有总值

> ID：12320692
> 
> 赞同：0
> 
> 时间：2012-09-07T15:04:22.143
> 
> 标签：javascript, jquery

我有一个现有的 javascript，它根据一系列数组计算总数。然后，该脚本将总计放在一个输入字段中，如下所示：`<input name="total" type="text" class="total" onfocus="this.form.elements[0].focus()" size="10">`

如何添加两个附加值以获取总计并显示计算 6% 和 7% 税的值？

```
function calculatetotal() {
    var order_total = new Number();
    order_total = 0;
    var item_price = new Number();
    var item_quantity = new Number();

    // Run through all the form fields
    for (var i=0; i < document.form1.elements.length; ++i) {

        // Get the current field
        form_field = document.form1.elements[i];

        // Get the field's name
        form_name = form_field.name;

        // Is it a "category" field?

        if (form_name.substring(0,3) == "CAT") {
            var adjust_check = check_price_adjustment(form_name);
            if (adjust_check) {
                item_price = form_field.value;
            } else {
                item_price = 0;
            }
        } else if (form_name.substring(0,4) == "PROD") { // Is it a "product" field?
            // Is the major category of this product checked?
            var category = "CAT_" + form_name.substring(5,7);
            var cat_box = document.getElementById(category);
            if (cat_box.type=="checkbox" && cat_box.checked) {
                // If so, extract the price from the form field value
                item_price = form_field.value;
                // reset negative item prices to 0
                if (item_price < 0) {
                    item_price = 0;
                }
            } else if (cat_box.type.indexOf("select")!=-1) {
                // If so, extract the price from the form field value
                item_price = form_field.value;
                // reset negative item prices to 0
                if (item_price < 0) {
                    item_price = 0;
                }
            } else {
                // Price is set to zero
                item_price = 0;
            }
        } else {
            item_price = 0;
        }         

 // Get the quantity
        if (form_field.type=="checkbox") {
            if (form_field.checked) {
                item_quantity = 1;
            } else {
                item_quantity = 0;
            }
        } else if (form_field.type.indexOf("select")!=-1) {
              item_quantity = 1;
        } else if (form_field.type=="hidden") {
            item_quantity = 1;
        }
        if (form_name == "CAT_EX")
             item_price = 0;        

 // Update the order total
        if (item_quantity >= 0) {
                order_total += item_quantity * item_price;
        }
    }

    // Display the total rounded to two decimal places
    document.form1.total.value = round_decimals(order_total, 2);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T17:14:25.523

我在这里添加了其他带有计算的表单元素：

```
document.form1.total.value = round_decimals(order_total, 2);
document.form1.totalsix.value = order_total * .085; 
document.form1.totalseven.value = round_decimals(order_total * .09, 2); 
```

然后添加以下输入：

```
<p>$<input name="totalsix" type="text" value="" onfocus="this.form.elements[0].focus()" size="10"></p>
<p>$<input name="totalseven" type="text" value="" onfocus="this.form.elements[0].focus()" size="10"></p> 
```

# extjs - EXTJS MVC 中的 Itemclick 和 itemmove

> ID：12320694
> 
> 赞同：0
> 
> 时间：2012-09-07T15:04:24.167
> 
> 标签：extjs, treeview, extjs4, extjs-mvc

在我看来，我有一个树面板及其相应的控制器。发生的事情是有两个控制器，一个用于 itemdblclick，另一个用于 itemmove。itemdblclick 工作正常，但是当我为 itemmove 添加控制器时，itemmove 工作正常，但另一方面， itemdbclick 不工作。如果我删除 itemmove 控制器，itemdblclick 正在工作。希望不要混淆:) 简单来说，这两个控制器是分开工作的，但不是一起工作的。

1.  谁能告诉我我在这里做错了什么。

2.  此外，在控制器的函数 editRegion 中，我尝试使用 getStore.load() 方法重新加载树，但树没有加载，即使我能够看到在 firebug 中调用的商店

编辑：

在双击树节点时打开一个表单，在关闭表单时，我希望重新加载树面板。这就是我想在editregion函数中发生的事情

看法

```
{
            xtype : 'treepanel',
            title : '',
            id : 'hierarchyTree',
            border : false,
            alias : 'widget.hierarchyTree',
            height : 1000,
            viewConfig : {
                enableDD : true,
                plugins : {
                    ptype : 'treeviewdragdrop'
                }
            },
            collapsible : false,
            useArrows : true,
            rootVisible : false,
            store : Ext.create('App.store.HierarchyTree'),
            displayField : 'Title',
            multiSelect : false,
            singleExpand : false,

        } 
```

控制器

```
refs : [{
    ref : 'myHierarchyTree',
    selector : '#hierarchyTree'
}
    init : function() {

    this.getHierarchyTreeStore().load();

'#hierarchyTree' : {
            itemdblclick : this.itemdblclick

        },
        '#hierarchyTree' : {
            itemmove : this.itemmove

        }

itemdblclick : function(view, record, level) {

    if (record.get('LevelID') == 1) {

        this.erWin = Ext.create('App.view.EditRegions');
        var f = this.getEditregionform().getForm();
        f.loadRecord(record);
        this.erWin.showWin();
    } 
else if (record.get('LevelID') == 2) {

        this.eaWin = Ext.create('App.view.EditAreas');
        var f = this.getEditareaform().getForm();
        f.loadRecord(record);
        this.eaWin.showWin();
    }

itemmove : function(v, oldParent, newParent, index, eOpts) {
    var nodeID = v.data.id;
    var oldParent = oldParent.data.id;
    var newParent = newParent.data.id;
    var index = index;
    var level = v.data.LevelID;

Ext.Ajax.request({
        url : 'data/Locations.aspx',
        params : {

            mode : 'MOVENODE',
            currentNode : nodeID,
            oldParentNode : oldParent,
            newParentNode : newParent

        },
        success : function() {
            alert(LANG.SUC);
            Ext.getStore('HierarchyTree').load();

        },
        failure : function() {

        }
    });

editRegion : function(button, record) {

    var fp = button.up('form');

    if (fp.getForm().isValid()) {
        fp.getForm().submit({
            url : 'data/Locations.aspx',
            params : {
                mode : 'EDITREGION',
                userID : ME.UserID,
                RegionID : ME.RegionID
            },
            success : function(response) {
                alert(LANG.SUC);
                this.getHierarchyTreeStore().load();

            },
            failure : function(response) {
                alert('Try again');
            }
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:14:57.567

分别添加它们将导致第一个侦听器对象被覆盖。

使固定：

```
 '#hierarchyTree' : {
            itemdblclick : this.itemdblclick,
            itemmove : this.itemmove
        }, 
```

您应该检查商店是否相同。意思是检查 id 因为我认为控制器初始化一个商店和另一个面板。所以检查是否`this.getHierarchyTreeStore().id`与树面板中的相等。您可以从类似的按钮导航到它`button.up().down('treepanel').getStore().id`。如果它们不同，那么您应该使用第二种方法来获取商店。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:02:38.933

尝试执行以下代码，因为使用 up 和 down 不会引用正确的视图，因为树和表单是完全不同的视图

```
 var view = Ext.widget('hierarchy');
view.down('treepanel').getStore.load(); 
```

现在，即使商店正在重新加载，也会出现错误

```
TypeError: view.down("treepanel") is null

view.down('treepanel').getStore.load(); 
```

# jquery - 从 POST 获取 json 数据

> ID：12320696
> 
> 赞同：0
> 
> 时间：2012-09-07T15:04:33.847
> 
> 标签：jquery

console.log(data) 给出以下结果

```
{
    "ERRORS": [
        {
            "MESSAGE": "Error on API.",
            "CODE": "hermes05"
        }
    ],
    "DATA": {}
} 
```

当我尝试获取价值消息时，我得到了未定义，为什么？

```
error: function(data){

  console.log(data.ERRORS[0].MESSAGE);

} 
```

完整代码

```
 $.ajax({
                type: "POST",
                dataType: "json",
                url: "http://api.domain.com/something",
                data: {
                    // Send value in mobile input field.
                    mobile:  $("#mobileNo").val()
                },

                success: function(data){

                },

        error: function(data){

             console.log(data.ERRORS.MESSAGE);

                }
            });

            // stop button from submitting.
            event.preventDefault(); // cancel default behavior
        }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T15:09:25.757

你想要的是

```
error: function(jqXhr) {
  try {
    data = JSON.parse(jqXhr.responseText);
    console.log(data.ERRORS[0].MESSAGE);
  } catch (err) {
    console.log("Response was not valid JSON");
  }
} 
```

在[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)查看`success`和之间的区别`error`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T15:09:24.093

这是因为`error`回调有`jqXHR`, `textStatus`,`errorThrown`参数 - 你必须参考`jqXHR.responseText`- 请参阅[jQuery doc](http://api.jquery.com/jQuery.ajax/)。

# iframe - 修改 iframe 的内容

> ID：12320697
> 
> 赞同：1
> 
> 时间：2012-09-07T15:04:37.273
> 
> 标签：iframe

如果我在 html 页面中有 iframe，并且在该 iframe 中，我需要删除一个 img 标签。

是否可以操作加载外部站点的 iframe 内容？

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:09:14.517

浏览器中的本机安全性使这非常困难，但可以通过跨域消息传递来完成；看看这个[库](http://easyxdm.net/wp/)：用过很多次；它很有效

# database-design - 如何改进我的数据库结构以进行邮政编码和运输查找？

> ID：12320698
> 
> 赞同：1
> 
> 时间：2012-09-07T15:04:40.213
> 
> 标签：database-design, sqlite

我们有页面显示任何给定邮政编码的运费，我正试图将其翻译成网站上的表格，该表格将完成肮脏的工作并为用户提供邮政编码的费用。我去掉了 zip 的最后 2 位数字，因为我不需要它们来查找该区域。我拥有的数据显示了**一系列**邮政编码。例如，第一个条目是任何以 004 到 006 开头的邮政编码都在 Zone 2 中。

显然，我不想创建我的表，在其中一行中列出“004”、下一行“005”等的数据。有什么好的方法来构建它，以便我可以获取他们输入的 zip并将其与一系列邮政编码进行比较？

我正在使用 PHP 和 sqlite3，但是我无法理解构建它的最佳方法，一旦我这样做了，我就可以毫无问题地对其进行编码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T20:07:03.963

虽然邮政编码包含数字字符，但它作为数字毫无意义 - 您无法将其相加 - 因此您应该将其存储为字符串。

在此基础上，您的邮政编码范围可以与开始和结束范围的字段一起存储......即：

```
Zone |RangeStart | RangeEnd
   2 |       004 |      006 
```

并将您的邮政编码数据与一个`between`子句进行比较

```
select * from address
     inner join zipcoderanges
     on substr(address.zipcode,1,3) between zipcoderanges.RangeStart and zipcoderanges.RangeEnd 
```

# xml - xml 解析问题：Perl LibXML 的命名空间属性

> ID：12320700
> 
> 赞同：2
> 
> 时间：2012-09-07T15:04:45.400
> 
> 标签：xml, perl

我正在尝试解析具有以下内容的 XML 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<sentences>
<lastmodified>none</lastmodified>
<sentencedefs xml:lang="common">
</sentencedefs>
<sentencedefs xml:lang="en-US">
<baselanguage xml:lang="en-US"/>
</sentencedefs>
</sentences> 
```

我用来解析它的 perl 代码如下所示（实际上这是代码关键部分的精简版）：

```
use 5.006_001;
use strict;
use warnings;
use English '-no_match_vars';
use XML::LibXML;

my $SENTENCEDEFS       = "sentencedefs";
my $LANG               = "lang";

my $lParser = XML::LibXML->new;
my $lSentencesDoc  = $lParser->parse_file("sentences.xml");
my $lSentencesRoot = $lSentencesDoc->documentElement();
my @lSentenceDefs = $lSentencesRoot->getElementsByTagName($SENTENCEDEFS);

foreach my $lDefs (@lSentenceDefs)
{
  my @lAttrs = $lDefs->attributes();
  foreach my $lAttr (@lAttrs)
  {
    print("Attr: " . $lAttr->toString(1) . "\n");
  }

  my $lLang = $lDefs->getAttribute($LANG);
  my $lFound = defined($lLang);
  print("Found $LANG? $lFound \n");
} 
```

我以前一直在使用 LibXML V1.58。我现在正在针对 LibXML V1.70 进行测试，发现输出不同：

V1.58：

```
Attr:  xml:lang="common"
Found lang? 1
Attr:  xml:lang="en-US"
Found lang? 1 
```

V1.70：

```
Attr:  xml:lang="common"
Found lang?
Attr:  xml:lang="en-US"
Found lang? 
```

V1.70 仅在我使用 $LANG="xml:lang" 时才找到该属性。

谁能解释为什么 LibXML V1.70 处理我的 XML 的方式不同？我可以对我的代码进行更改以使其在同时运行 V1.58 和 V1.70 时表现相同吗？我无法更改 XML 文档。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T15:16:06.130

我怀疑它与底层 libxml2 库的版本有关，但行为发生了变化，因为它曾经给出错误的答案。（该元素没有`lang`在 null 命名空间中命名的属性。）

正确的调用（定义[在这里](http://www.w3.org/TR/xml-names/#xmlReserved)）是

```
$element->getAttributeNS('http://www.w3.org/XML/1998/namespace', 'lang') 
```

我没有办法测试这是否适用于您的两种环境。如果没有，您总是可以使代码有条件

```
$XML::LibXML::VERSION         # Version of XML::LibXML (e.g. 1.70) 
```

或者

```
XML::LibXML::LIBXML_VERSION   # Version of libxml2 (e.g. 20707 for 2.7.7) 
```

# objective-c - 与模拟器相比，iOS 设备上的 ASCII 字符

> ID：12320704
> 
> 赞同：0
> 
> 时间：2012-09-07T15:04:59.193
> 
> 标签：objective-c, ios, ios-simulator

我有一个测试应用程序来查看 ascii 字符。谁能向我解释为什么模拟器上的 ascii 字符与 iOS 设备不同，以及如何从设备上获取相同的 ascii 字符？

代码：

```
for ( int i = 0; i < 256; i++ ) {
    NSLog(@"%d: %c", i, i);
} 
```

模拟器结果样本： 126：~ 128：Ä 129：Å 130：Ç 131：É

iOS 设备结果示例： 126: ~ 128: √Ñ 129: √Ö 130: √á 131: √â</p>

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:12:51.287

因为大于 127 的值不是 ASCII，也称为 ISO-646。这些字节值根据用于解释它们的编码获得不同的字形，这在真实设备和模拟器之间会有所不同。

# javascript - 在 Fiddler JavaScript 中识别 POST 请求

> ID：12320705
> 
> 赞同：0
> 
> 时间：2012-09-07T15:04:59.877
> 
> 标签：javascript, fiddler

我正在为 Fiddler 编写自定义规则，并且想知道您如何识别请求是 JavaScript 中的 POST（即不是 GET 或其他类型）请求？会话和请求对象似乎都没有提供此数据的属性。

换句话说

```
static function IsPostRequest(oSession : Session) {

    if (oSession. <-- WHAT GOES HERE????? ) 
            return true;
    return false;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:12:04.473

尝试这个：

```
static function IsPostRequest(oSession : Session) {
    return oSession.HTTPMethodIs("POST"); 
} 
```

# email - 从文件中填充 CruiseControl 电子邮件发布者用户地址

> ID：12320711
> 
> 赞同：1
> 
> 时间：2012-09-07T15:05:23.207
> 
> 标签：email, cruisecontrol.net, publisher

目前，我的 CruiseControl.NET 电子邮件发布者将其用户列表硬编码在构建配置文件中

```
<publishers>
    [ ... ]
    <email from="autobuild@domain.com" mailhost="stmp.domain.com" mailport="25" includeDetails="TRUE">
        <replyto>buildserver@domain.com</replyto>
        <users>
            <user name="a.user" group="buildmaster" address="a.user@domain.com"/>
            <user name="b.user" group="developers" address="b.user@domain.com"/>
        </users>
        <groups>
            <group name="developers">
                <notifications>
                    <notificationType>Failed</notificationType>
                    <notificationType>Fixed</notificationType>
                </notifications>
            </group>
            <group name="buildmaster">
                <notifications>
                    <notificationType>Always</notificationType>
                </notifications>
            </group>
        </groups>
        <modifierNotificationTypes>
            <NotificationType>Failed</NotificationType>
            <NotificationType>Fixed</NotificationType>
        </modifierNotificationTypes>
    </email>
</publishers> 
```

我希望能够从外部文件中读取用户列表。我们有几十个构建文件，我想简化添加新用户和删除不再感兴趣的用户的过程。

我可以这样做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T09:34:23.757

是的 - 只需查看配置预处理器，特别是[包含](http://www.cruisecontrolnet.org/projects/ccnet/wiki/Configuration_Preprocessor#Including-files)部分。

您可以将您的`<users/>`节点移动到一个名为 eg 的单独文件`email_users.xml`中并将其维护在一个地方，然后将其包含在`<cb:include href="email_users.xml"/>`

示例`email_users.xml`文件：

```
<?xml version="1.0" encoding="utf-8"?>
<cb:config-template xmlns:cb="urn:ccnet.config.builder"
  xmlns="http://thoughtworks.org/ccnet/1/5">
  <users>
    <user name="a.user" group="buildmaster" address="a.user@domain.com"/>
    <user name="b.user" group="developers" address="b.user@domain.com"/>
  </users>
</cb:config-template> 
```

请记住，要使其正常工作，您的主文件应以

```
<cruisecontrol xmlns:cb="urn:ccnet.config.builder"
  xmlns="http://thoughtworks.org/ccnet/1/5"> 
```

# padding - jQuery before/after 和 Padding 的位置不一致

> ID：12320717
> 
> 赞同：0
> 
> 时间：2012-09-07T15:05:39.027
> 
> 标签：padding, insertion

我正在尝试使用 jQuery（.before 和 .after）在页面上的任意“目标”元素之前和之后插入和定位新的 DIV 在某些情况下，在插入 DOM 之后，浏览器将呈现新的 DIV 而不考虑目标元素的填充，其他时候呢？我意识到还有其他问题可能会使这复杂化（定位、边距等），但我不确定为什么会有差异？它是否与目标元素类型或对共同父元素的某些约束有关？

谢谢，克里斯

# c# - 将 SQL 语句转换为 LINQ-To-SQL

> ID：12320722
> 
> 赞同：6
> 
> 时间：2012-09-07T15:06:02.990
> 
> 标签：c#, sql, linq

我可以帮忙将以下内容转换为 LINQ 语句吗？

```
SELECT reports.* FROM [dbo].[ReportLists] rl
INNER JOIN [dbo].[ReportItems] ri ON rl.Id = ri.ReportListId
INNER JOIN [dbo].[Reports] reports ON ri.Id = reports.ReportItemId
WHERE
    reports.createdDate
IN (
    SELECT 
        MAX(report_max_dates.createdDate) 
    FROM 
        [dbo].[Reports] report_max_dates
    GROUP BY 
        report_max_dates.seedLot
    ) 
```

目前我把它归结为：

```
db.ReportLists.Select(rl => db.ReportItems
                            .Where(ri => ri.ReportListId == rl.Id)
                            .Select(ri => db.Reports
                                          .Where(r => r.ReportItemId == ri.Id)
                                          .GroupBy(r => new { r.seedLot })
                                          .Select(g => g.OrderByDescending(x => x.createdDate).FirstOrDefault()))); 
```

上面的 LINQ 的问题是它返回的条目标题已更改。在数据库中，我保留所有记录的历史记录（因此需要在 createdDate 上按降序排列第一个。当我将报告从标题 x 更改为标题 y 时，当我只想要最新的记录时，它会显示在两个标题下因此成为标题 y 下的那个。

**编辑** 对不起，缺乏细节。我有一个报告表，其中包含有关报告的信息（seedlot 是标识符）。每当编辑报告时，都会插入一条新记录（而不是更新旧记录），以便保留历史记录。在这种情况下，createdDate 的最大条目表示报告是要显示的最新记录。然后将报告分组为标题或 ReportItems。这些报告项目包含标题和相关的报告。这些reportItems 保存在ReportList 中，这样我就可以以所需的格式打印出JSON，并且只包含一个状态列和由ReportItems 链接的id。

如果将报告从标题 a 移动到标题 b，则会输入一条新记录，其中标题外键链接到它更改为的标题。当发生这种情况时，上面给定的 LINQ 在它应该只返回标题 b 的最新条目时返回每个单独的 ReportItem 下的记录（来自上面的示例）。除此之外，LINQ 语句仅返回 createdDate 的最新记录。

这是我的类结构（也模仿了 DB 结构）

```
public class ReportList {
    public int Id {get;set;}
    public string status {get;set;}
    public List<ReportItem> {get;set;}
}

public class ReportItem {
    public int Id {get;set}
    public string title {get;set;}
    public List<Report> {get;set;}
}

public class Report {
    public int Id {get;set;}
    public string Lot {get;set;}
    ... Other data ...
    public DateTime createdDate {get;set;}
} 
```

谢谢，德曼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T21:02:45.533

如果我理解正确，那么您需要 seedLot 的最新报告，那么我将使用下一个：

```
from r in Reports
group r by r.CreateDate into g
select g.OrderByDescending(r1=>r1.CreateDate).FirstOrDefault() 
```

如果您不将 ReportItem 和 ReportList 包含在结果中，则不太确定为什么需要它们，您可以使用 Report 的导航属性遍历它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T22:09:43.333

啊。我懂了。您的 Inner Join 正在剔除 ReportItems 表中没有 Id 的记录和 ReportLists 表中没有 Id 的 ReportItems。由于您没有在 Linq 中使用内部连接语法，因此它们并不等效。你有没有试过这个：

```
var reports = from rl in db.ReportLists
              from ri in rl.ReportItems 
              from r in ri.Reports
              where (
                  from report in db.Reports
                  group report by report.seedLot into g
                  select g.Max(rep => rep.createdDate)).Contains(r.CreatedDate)
              select rl; 
```

我不是 100% 我在包含的那个组上的语法是正确的（我没有每天做很多分组）。而且，如果 LINQ 提供程序不支持 Max（或 Contains，尽管它应该），那么它将拉取客户端的所有内容，并且需要通过网络推送大量数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T22:41:37.360

您提供的详细信息使其更加清晰，尽管并非完全如此，因此我将提供两种选择。导航属性派上用场，因为现在可以使用非常简洁的综合语法：

```
from rl in context.ReportLists
from ri in rl.ReportItems
from r in ri.Reports
group r by r.Lot into g
select g.OrderByDescending(x => x.createdDate).FirstOrDefault() 
```

或（因为您似乎按`Title`in分组`ReportItems`）：

```
from rl in context.ReportLists
from ri in rl.ReportItems
group ri by ri.Title into g
select g.Select(x => x.Reports
                      .OrderByDescending(x => x.createdDate).FirstOrDefault()) 
```

在幕后，这也会产生 SQL 连接，但您不需要笨拙的语法。在 linq 流利的语法中，它归结为`SelectMany()`s。

如您所见，我仍然无法弄清楚 and 的作用，`Lot`但`Title`我希望替代方案能够提供一些实质内容来塑造您自己的规格。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T19:37:08.943

更改了数据库模式以将其展平一点，并去掉很多分支。

报告现在是根，我只有一个附在报告上的标题表。

感谢大家的建议！

# video - 在网站上流式传输视频

> ID：12320723
> 
> 赞同：0
> 
> 时间：2012-09-07T15:06:07.413
> 
> 标签：video, web, streaming, rtsp, ip-camera

我有一个产生 RTSP 流的 IP 摄像机，我想问你将它放到网站上的最佳方式是什么。我首先想到的是直接把它作为一个[对象](http://live.v2.nl/embed.php)，但我担心多个用户查看它会导致问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:14:04.967

JWPlayer 支持它。

[http://www.longtailvideo.com/](http://www.longtailvideo.com/)

像这样的东西：

```
<script src="jwplayer.js" type="text/javascript"></script>
<div id="livecam"></div>
<script type="text/javascript">
jwplayer('livecam').setup({
'flashplayer': 'player.swf',
'file': 'camera.stream',
'streamer': 'rtmp://00.00.00.00:1234/streaming',
'autostart': 'true',
'controlbar': 'bottom',
'stretching': 'exactfit',
'width': '640',
'height': '352'
});
</script> 
```

# perl - SVK 同步和计划任务

> ID：12320726
> 
> 赞同：2
> 
> 时间：2012-09-07T15:06:10.883
> 
> 标签：perl, svk, getpwuid

我正在尝试自动化 SVK 同步过程。
配置完SVK镜像后，我写了一个批处理文件，内容如下

```
svk sync -a >> svk.log &2>1 
```

然后我添加了一个在我的管理帐户下运行的 Windows 计划任务。

在 svk.log 我读过

> getpwuid 函数在 C:\Programmi\svk\bin\svk 第 142 行未实现。

有什么提示吗？

ps 我可以从命令行运行 svn sync -a（同一用户）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T14:40:08.173

当我发布我的问题时，我不知道

1.  在 Windows 调度程序下 HOMEDRIVE 和 HOMEPATH 未初始化 (http://tinyurl.com/9zxbrg8)
2.  getpwuid 函数在 Perl 的 Windows 端口中不可用 (http://tinyurl.com/d56a2mv)

有了以上内容，我通过更改修改了 /bin/svk 文件

```
$ENV{HOME} ||= (
    $ENV{HOMEDRIVE} ? catdir(@ENV{qw( HOMEDRIVE HOMEPATH )}) : ''
) || (getpwuid($<))[7];
$ENV{USER} ||= (
    (defined &Win32::LoginName) ? Win32::LoginName() : ''
) || $ENV{USERNAME} || (getpwuid($<))[0]; 
```

在

```
$ENV{HOME} ||= (
    $ENV{HOMEDRIVE} ? catdir(@ENV{qw( HOMEDRIVE HOMEPATH )}) : 
                      ($ENV{USERPROFILE} ? $ENV{USERPROFILE} : '')
);
$ENV{USER} ||= (
    (defined &Win32::LoginName) ? Win32::LoginName() : ''
) || $ENV{USERNAME}; 
```

现在我可以将我的批处理调用 svk 作为 Windows 计划任务运行

# ios - 在第二个 UITextField 编辑上显示和隐藏键盘

> ID：12320730
> 
> 赞同：0
> 
> 时间：2012-09-07T15:06:16.853
> 
> 标签：ios, xcode

我有很多 UItextField，以及他们喜欢的动画：

```
-(void)textFieldDidBeginEditing: (UITextField *)textField{
NSLog(@"sowing keyboard");

[UIView beginAnimations:nil context:NULL];
[UIView setAnimationDuration:0.27];
scroll1.frame = CGRectMake(0, -604, 768, 1004);
[UIView commitAnimations];

[UIView beginAnimations:nil context:NULL];
[UIView setAnimationDuration:0.47];
scroll2.frame = CGRectMake(0, 414, 768, 1004);
[UIView commitAnimations];

[UIView animateWithDuration:1.0
                 animations:^{ 
                     self.mapView.alpha=0.0;
                 } 
                 completion:^(BOOL finished){
                     self.mapView.hidden=YES;
                 }];

}

 -(void)textFieldDidEndEditing: (UITextField *)textField{
NSLog(@"hiding keyboard");

if (scroll2.frame.origin.y != 414) {

[UIView beginAnimations:nil context:NULL];
[UIView setAnimationDuration:0.27];
scroll1.frame = CGRectMake(0, -340, 768, 1004);
[UIView commitAnimations];

[UIView beginAnimations:nil context:NULL];
[UIView setAnimationDuration:0.47];
scroll2.frame = CGRectMake(0, 678, 768, 1004);
[UIView commitAnimations];

[self.mapView setHidden:NO];

//fade in
[UIView beginAnimations:nil context:nil];
[UIView setAnimationDuration:1.0];
[UIView setAnimationDelegate:self];

[self.mapView setAlpha:1.0];

[UIView commitAnimations];

    }
} 
```

问题是，如果我正在编辑一个字段，并且从我触摸并开始编辑另一个字段，则会调用代码 didEnd 和 DidBegin。我怎么能阻止它？我希望这些动画仅在我开始编辑文本字段并且没有正在编辑文本字段时出现，并且当我需要隐藏键盘时出现 DidEnd（当用户在 iPad 上按下 DownKey 时）

有任何想法吗？？

我试过这个：

```
if (scroll2.frame.origin.y != 414) { 
```

...它可以工作，但是当我按下重新运行键时，没有动画出现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:13:42.620

有问题的 textField 连同参数一起发送给 textFieldDidBeginEditing。

添加一个 if () 块来测试 textField1 和 textField2 即：

```
-(void)textFieldDidBeginEditing:(UITextField *)textField {
if (textField == textField1) {
    //do animation linked to textField1
}
if (textField == textField2) {
    //do animation linked to textField2
}
} 
```

另外，你应该实现这个方法

```
-(BOOL)textFieldShouldReturn:(UITextField *)textField {
    //handles the enter/done key
    //perform whatever action for when user touches return
    if (textField == textField1) {
        [textField2 becomeFirstResponder];
    } else {
        [textField1 becomeFirstResponder];
    }
    return YES or NO;
} 
```

# iphone - iphone：你可以测试使用模拟器访问音乐库吗？

> ID：12320734
> 
> 赞同：0
> 
> 时间：2012-09-07T15:06:33.450
> 
> 标签：iphone, xcode, ios4, ios-simulator

> **可能重复：**
> [我可以在模拟器上访问 iPod 库吗？](https://stackoverflow.com/questions/3159716/can-i-access-ipod-library-on-simulator)

我注意到 iPhone 模拟器中没有 iPod 应用程序。如果我正在使用 MediaPlayer 框架并且我想测试访问设备（模拟器）的音乐库，我可以使用模拟器执行此操作还是需要购买一个帐户才能使用我的实际设备？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:52:49.080

不，无法访问模拟器上的 MPMediaPlayer 框架。您需要成为开发者计划的付费会员并在您的设备上运行您的应用程序。

另请参阅[我可以在模拟器上访问 iPod 库吗？](https://stackoverflow.com/questions/3159716/can-i-access-ipod-library-on-simulator)

# ruby - 是否有 Perl 替代红宝石的保护宝石？

> ID：12320745
> 
> 赞同：2
> 
> 时间：2012-09-07T15:07:07.573
> 
> 标签：ruby, perl, guard

我对[guard](https://github.com/guard/guard) ruby​​ gem 的强大功能感到惊讶，并希望找到类似的东西来监视我的Perl 项目的更改并运行类似的单元测试和livereload，就像ruby gem 一样开箱即用，而无需安装ruby？

有什么想法/建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T15:11:33.490

听起来您想在[File::ChangeNotify](https://metacpan.org/module/File%3a%3aChangeNotify)上进行构建，这是[Catalyst 测试服务器](https://metacpan.org/module/Catalyst%3a%3aScript%3a%3aServer)在代码更改时用于自动重启的内容。

单元测试可能最好由 Test:: 模块之一处理，例如[Test::Most](https://metacpan.org/module/Test%3a%3aMost)。

# .net - Windows 每秒执行一次线程切换的频率是多少？

> ID：12320748
> 
> 赞同：12
> 
> 时间：2012-09-07T15:07:12.380
> 
> 标签：.net, windows, multithreading

Windows（通常）每秒执行一次线程切换的频率是多少？这与 .NET 线程有什么不同？或者反过来问：一个线程（比如说，正常线程优先级）允许运行多长时间？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-07T15:13:40.190

Windows 上下文切换的频率取决于系统“量子”。此时间范围为 10-15 毫秒（每秒 66-100 次），具体取决于操作系统是客户端还是服务器。有关更多详细信息，我建议阅读 Joe Duffy 的书*Concurrent Programming on Windows*；它对诸如此类的事情进行了详细介绍-例如，“客户端操作系统......是2个时钟间隔。......在服务器操作系统上......是12个时钟间隔”。此外，他的文章 [CLR Inside Out：使用并发实现可伸缩性][1] 是必读的。

您可以“编辑”量子长度。如果您将性能选项/系统属性中的高级中的“调整以获得最佳性能：”设置为“程序”，您将获得更短的时间片。如果将其设置为“后台服务”，您将获得更长的时间段。

如果没有理由进行上下文切换，线程将获得所需的时间。

[1] [http://www.360doc.cn/article/28217_2474333.html](http://www.360doc.cn/article/28217_2474333.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T15:12:34.157

`A context switching rate of 300 per second per processor is a moderate amount`[源](http://technet.microsoft.com/en-us/library/cc938613.aspx)中说。

Windows2000 有[Pviewer 实用程序](http://technet.microsoft.com/en-us/library/cc938606.aspx)来测量它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T17:19:31.083

在典型系统上，这高度依赖于 I/O 负载。当线程调用 I/O、被阻塞并稍后再次准备好时，许多磁盘和网络活动将产生大量上下文切换。正在运行的应用程序的复杂性和设计也会影响上下文切换率 - 具有大量线程、许多锁、锁内工作量过多、线程间通信与通信数据大小相比过多、愚蠢的轮询等的应用程序将驱动提高上下文变化率。

在大多数系统上，大多数时候，关于“量子”、“时间片”等的东西是无关紧要的——只是 I/O 驱动的抢占式多任务处理中的一个脚注，它只会在更准备好、CPU 密集型的机器上定期发生，线程比核心，即。那些严重超载或运行 CPU 密集型应用程序的应用程序。

允许正常优先级的线程运行直到它被抢占，通常是通过它选择等待 I/O 或来自另一个线程的信号。即使它没有 I/O 或信号，即。完全受 CPU 限制，如果盒子永远不会超载，它可能仍然永远运行（即永远不会有比内核更多的就绪线程）。

# javascript - 困难的 CSS 样式：按钮对齐和更改字段名和动态文本长度

> ID：12320750
> 
> 赞同：0
> 
> 时间：2012-09-07T15:07:16.210
> 
> 标签：javascript, html, css

我想要的是每个单选按钮集的字段名称是灵活的，例如，它的范围可以从 10-30 个字符，但第一行和第二行的单选按钮位置必须对齐，如下所示。此外，单选按钮名称可能会更改，因此尽管单选按钮名称发生更改，但有没有办法保持对齐。似乎德语的最大值是 4 个字符（'Nein'）和 2 个字符（'Ja'）以及英语的不同数字。

**那么IE中是否有一种通用的方法来保持第一行和第二行之间的单选按钮对齐，并且还对齐字段名称？一个很好的例子如下：**

![在此处输入图像描述](../Images/065277a66abcc335518c8b08e2637643.png)

我对我的 css 样式表所做的是尝试上述样式，但我在每个字段名称前面作为固定长度空格的缩进导致单选按钮未对齐。**以下是我当前的代码结果：**

![我当前的代码](../Images/561d64902eabc0d814470a13489236b9.png)

**我的CSS代码**

```
.sRRBA { font-family:Arial;color:#000000;font-size:9pt; margin-left:190px }
.sRRBJ { font-family:Arial;color:#000000;font-size:9pt; margin-left:190px }
.sRRCI { font-family:Arial;color:#000000;font-size:9pt; margin-left:190px }
.sRRDH { font-family:Arial;color:#000000;font-size:9pt; margin-left:190px } 
```

**查看源代码**

```
<span class="sRRBA">Customer Marketing Permission Postal Address</span>

               <input type="radio" name="" value="N" />
               <span class="readonlytext">No</span>

               <input type="radio" name="" value="Y" />
               <span class="readonlytext">Yes</span>

         <span class="sRRBJ">Customer Marketing Permission Telephone</span>

               <input type="radio" name="" value="N" />
               <span class="readonlytext">No</span>

               <input type="radio" name="" value="Y" />
               <span class="readonlytext">Yes</span>

         <span class="sRRCI">Customer Marketing Permission Mobile Phone</span>

               <input type="radio" name="" value="N" />
               <span class="readonlytext">No</span>

               <input type="radio" name="" value="Y" />
               <span class="readonlytext">Yes</span>

         <span class="sRRDH">Customer Marketing Permission Email</span>

               <input type="radio" name="" value="N" />
               <span class="readonlytext">No</span>

               <input type="radio" name="" value="Y" />
               <span class="readonlytext">Yes</span>

      </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:17:36.387

就我个人而言，我会为每一列创建类，为每一列提供一个宽度并将显示类型设置为内联块。然后划分你的列并将它们的类设置为你刚刚创建的“列”类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:34:41.753

你有几种方法可以做到这一点。这里有两个。

您可以将每列放入自己的标签中，每列将向左浮动并设置为显示内联块。然后每一列都会排成一行。例如：

```
.topcontainer {
    display: inline-block;
    overflow: hidden;
}
.ecolumn {
    float: left;
    margin-right: 6px;
 }

<div class="topcontainer">
    <div class="ecolumn">
        <div>Line1</div>
        <div>Line2</div>
    </div>
    <div class="ecolumn">
        <div><input...></div>
        <div><input...></div>
    </div>
</div> 
```

这种方法的问题是，如果线条的高度不同，它就不会垂直排列。您可以通过在 div 元素上设置显式高度来解决此问题。如果您有屏幕空间，也可以在其中插入一个不间断的空格 ( ) 以使高度与字体保持一致。您还可以将高度设置为 1em 以匹配正在使用的字体高度。

您也可以使用表格——这确实是在不指定宽度和高度的情况下完美排列行和列的唯一方法。表格还有其他问题，例如让屏幕阅读器等内容消费者感到困惑，所以这取决于您：

```
<table>
    <tbody>
        <tr>
            <td>Line1</td>
            <td><input...></td>
        </tr>
        <tr>
            <td>Line2</td>
            <td><input...></td>
        </tr>
    </tbody>
</table> 
```

**编辑：**

作为对您的评论的回应，我不确定您到底在寻找什么，所以这里有一些一般信息。

除非您以某种方式设置它们的宽度，否则 HTML 表格总是占用它们所需的最小空间。您可以设置表格宽度并将左列设置为 100% 宽度以获得您正在寻找的效果。您还可以仅在第一列上设置像素宽度，或者您可以将放入左列的项目设置为具有右边距，以便它们在单元格中占用更多空间。还有其他方法；这完全取决于您正在寻找什么效果。

此外，您可以在表格中的每个单元格上设置样式，以使内容左、右、中、上、下、中对齐。

# java - Swing，AWT-EventQueue 锁定

> ID：12320753
> 
> 赞同：0
> 
> 时间：2012-09-07T15:07:18.510
> 
> 标签：java, swing, swingworker, jconsole, jide

在我的 Swing 应用程序中，当在其中一个节点（只有一个）上调用 click 时，整个应用程序都挂起。`AWT-EventQueue-1`我使用 jconsole 对问题进行了更多调查，并且在发生调用此“挂起事件”时看到的内容

```
locked java.awt.Component$AWTTreeLock@49f8e092 
```

什么会导致这种行为？这是应用程序没有响应的原因吗？

# windows - 为什么将多线程应用程序限制在一个内核使其运行得更快？

> ID：12320754
> 
> 赞同：3
> 
> 时间：2012-09-07T15:07:19.167
> 
> 标签：windows, multithreading, cpu, scheduler, affinity

我有一个用 C++ 编写的本机多线程*Win32*应用程序，它有大约 3 个相对繁忙的线程和 4 到 6 个不做那么多的线程。当它以正常模式运行时，在 8 核机器上的总 CPU 使用率加起来约为 15%，应用程序在大约 30 秒内完成。当我通过将关联掩码设置为`0x01`它来将应用程序限制为仅一个核心时，它会在 23 秒内更快地完成。

我猜这与限制在一个物理内核和/或一些并发内存访问问题时同步更便宜有关。

我正在运行 Windows 7 x64，应用程序是 32 位的。CPU 是 Xeon X5570，具有 4 个内核并启用了 HT。

谁能详细解释这种行为？为什么会发生这种情况以及如何提前预测这种行为？

**更新：**我想我的问题不是很清楚。我想知道为什么它在一个物理核心上变得更快，而不是为什么它在多个核心上没有超过 15%。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-11T12:25:49.060

这个问题非常模糊，所以只是基于典型线程问题的一些随机猜测。

一个明显的候选者是争用，线程争夺锁，实际上是串行运行而不是并行运行。您最终会为线程上下文切换付费并且没有任何好处。这是 C++ 中很容易忽略的问题，CRT 和 C++ 标准库中存在大量低级锁定。两者最初设计时都没有考虑线程。

在具有强内存模型（如 x86 和 x64）的 cpu 内核上常见的一个问题是“错误共享”。当多个线程更新同一 L1 高速缓存行内的内存位置时，就会发生这种情况。然后，处理器会花费大量的精力来保持核心缓存同步。

如果程序实际上是执行绑定的，您只能从多个执行核心中受益。如果它的内存受限，您将无法获得好处。如果您操作的数据无法容纳 cpu 缓存，您的机器仍然只有一条内存总线，这是一个强大的瓶颈。内核将简单地停止，等待总线赶上。它仍然算作 cpu 时间，因此不会在 cpu 使用统计信息中可见，但几乎没有真正的工作完成。

显然，您需要一个好的分析器来解决这类问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T14:14:14.493

如果不说明应用程序，就很难猜测导致应用程序运行缓慢的原因。如果您想进行详细分析，我们可以考虑以下因素 -

*   **InterProcessor Communication**：应用程序中的线程相互通信的程度。如果他们经常交流，那么您将因这种行为而产生开销

*   **处理器缓存架构**：这是另一个值得关注的重要因素。您应该知道由于在不同处理器上运行的线程将如何影响处理器的缓存。共享缓存会发生多少抖动。

*   **页面错误**：由于程序的顺序性质，也许在单处理器上运行会导致更少的页面错误？

*   **Locks**：锁定代码中的开销？这不应导致减速。但除了上述因素之外，这可能会增加一些开销。

*   **处理器上的 NoC**：当然，如果您将不同的线程分配给不同的处理器内核，并且它们正在通信，那么您需要知道它们采用的路径是什么。他们之间有专门的联系吗？也许你应该看看这个[链接](http://terboven.wordpress.com/2010/10/18/examining-the-numa-architecture-of-a-8-socket-nehalem-ex/)。

*   **处理器负载**：最后但并非最不重要的是，我希望您没有在其他处理器内核上运行其他任务，从而导致大量上下文切换。上下文切换通常非常昂贵。

*   **温度**：您应该考虑的一个影响是，如果 cpu 内核升温，处理器时钟会变慢。我想，你不会有这种效果，但这也很大程度上取决于环境温度。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-17T14:21:25.073

考虑到内存延迟对性能的巨大影响，这几乎肯定与缓存有关。

通过在单个内核上，第一级和第二级缓存保持特别热 - 比您分布在多个内核上时更热。

第三级缓存将在所有内核之间共享，因此不会有任何不同，但当然会慢很多，因此通过将局部性移动到第一级和第二级缓存可以获得很多。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-17T15:12:34.060

*“当它在正常模式下运行时，在 8 核机器上总 CPU 使用率加起来约为 15%”*

仅有 15% 的使用率给了我另一种可能的解释：你的线程不做 I/O 吗？我的猜测是 I/O 操作决定了应用程序的整体时间，而不是 CPU 使用率。在大多数情况下，当 I/O 作业是多线程的时，I/O 密集型应用程序会变得更慢（想想同时复制两个文件而不是一个接一个地复制）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-17T08:22:43.693

就问题而言，线程在多个内核上运行时相互通信，导致进程执行速度相对较慢。而将线程限制为单个物理内核不需要线程之间的任何相互通信，因此进程加快了。

这也可能取决于正在执行的任务：如果线程需要低资源，这可能是正确的，否则将物理内核限制为一个内核可能不会在所有情况下都富有成效。

# ruby-on-rails - 带有 AND 和 OR 的 Mongoid 3 复杂查询

> ID：12320756
> 
> 赞同：4
> 
> 时间：2012-09-07T15:07:27.093
> 
> 标签：ruby-on-rails, mongoid, ruby-on-rails-3.2, mongoid3

我有一个 Rails 3.2 博客应用程序，它根据用户的公司和地区向用户显示帖子。我还想显示用户是帖子作者的帖子，即使它是为另一个公司或地区创建的（帖子对象有一个地区和一个公司，以及用户对象）。

我在 MySQL 中使用查询做了类似的事情：

```
SELECT * FROM Post WHERE approved = true AND hold = false AND 
((company_id IN (null, 'user_company_id') AND region IN (null, 'user_region_id')) 
OR author = 'user_id') ORDER BY published_date; 
```

我们现在正在使用 Mongoid gem 将应用程序迁移到 MongoDB，这是我无法弄清楚的最后一个查询。这是我到目前为止使用 Origin 和 Selector 的组合来调用文档的内容：

```
@posts = Post.and(
    {approved: true},
    {hold_publish: false},
    {"$or" => [
        {"$and" => [{:company_id.in => [nil, @user.company.id]}, {:region_id.in => [nil, @user.region.id]}]},{user_id: @user.id}
    ]}).desc(:published_date) 
```

但是，这只会拉取 company_id 和 region_id 为空或与用户属性匹配的帖子。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-08T07:03:25.483

这是您的查询试试这个 -

```
Post.where(approved: true,hold_publish: true)
  .or(:company_id.in => [nil, @user.company.id],:region_id.in => [nil, @user.region.id])
  .or(user_id: @user.id)
  .desc(:published_date) 
```

# c# - 当从 javascript 调用时，UpdatePanel 中的 asp.net 按钮会导致 Firefox 15.0.1 中的整个页面刷新

> ID：12320757
> 
> 赞同：2
> 
> 时间：2012-09-07T15:07:28.763
> 
> 标签：c#, asp.net, .net

好吧，这很奇怪。

我正在使用 .net 框架 4。我在更新面板中有一个 asp.net 按钮，如下所示：

```
<asp:Button id="btNacinMontaze" runat="server" class="buttonOIHidden" value="nm" CausesValidation="false" onclick="btNacinMontaze_Clicked" clientidmode="Static" UseSubmitBehavior="false"/> 
```

如果我在浏览器中单击它，它会正常工作 - updatepanel 会自行更新而不刷新整个页面，会触发正确的服务器事件。

如果我在页面内这样做： `document.getElementById("btNacinMontaze").click();`

整个页面刷新并触发正确的服务器事件。

如果我从 firebug 控制台中发出同一行代码，只会刷新 updatePanel。

如果我在 Chrome 或 IE9 中加载相同的页面，它在所有情况下都可以正常工作。我已经通过在 Firebug 中的调试跟踪了鼠标单击和代码单击之间的不同之处，并在方法中看到了`Sys$WebForms$PageRequestManager$_doPostBack`这一行

```
if (!this._postBackSettings.async) 
```

是不同的。async 在鼠标点击时为真，在代码点击时为假。

我不知道为什么会发生这种情况，非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-02T15:06:07.887

您应该[定义一个`AsyncPostBackTrigger`](http://codeclimber.net.nz/archive/2007/06/26/how-to-refresh-an-updatepanel-from-javascript.aspx)来停止整个页面的刷新。

```
<asp:UpdatePanel runat="server" ID="UpdatePanel1" UpdateMode="Conditional">
   <ContentTemplate>
     <asp:Label ID="label" runat="server"></asp:Label>
   </ContentTemplate>
   <Triggers>
     <asp:AsyncPostBackTrigger ControlID="btNacinMontaze" EventName="Click" />
   </Triggers>
 </asp:UpdatePanel> 
```

# c# - Oracle 数据库的自定义日期时间格式

> ID：12320759
> 
> 赞同：2
> 
> 时间：2012-09-07T15:07:37.020
> 
> 标签：c#, oracle, datetime

我目前正在`DateTime`从 Oracle 数据库中读取格式为 的项目`dd/mm/yyyy hh:mm:ss`，但我需要将它们存储如下`yyyy-mm-dd hh:mm:ss`：

我尝试了两种方法。我尝试的第一个是将日期的字符串版本拆分为多个部分并重新组合它以提供我想要的输出。但是，将其转换为 DateTime 对象会将其还原为原始格式。这是代码：

```
public static DateTime FormatDateTimeForPDB(string dateTimeString)
{
    DateTime formattedDateTime;
    char[] illegals = { '/', ' ', ':' };

    string[] array = dateTimeString.Split(illegals);
    string date = array[2] + "-" + array[1] + "-" + array[0] + " " + array[3] + ":" + array[4] + ":" + array[5];

    formattedDateTime = Convert.ToDateTime(date);      
    return formattedDateTime;
} 
```

断点`Convert.ToDateTime(date)`显示日期为**2012-09-07 15:01:03**，这是我想要的格式，但作为字符串，而不是 DateTime。

我也尝试过使用用户*tatis*在[此处](http://social.msdn.microsoft.com/Forums/en-GB/csharplanguage/thread/af4f5a1e-f81d-47fe-981d-818e785b8847 "这里")讨论的 DateTimeFormatInfo 属性，但所有能做的就是交换月份和日期字段（给我`mm/dd/yyyy hh:mm:ss`）。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:10:09.610

如果您担心在 C# 中将日期字符串解析为 DateTime，请查看 DateTime 的 ParseExact 方法。文档[在这里](http://msdn.microsoft.com/en-us/library/w2sa9yss.aspx)。

像这样的东西：

```
CultureInfo provider = CultureInfo.InvariantCulture;
String format = "dd/MM/yyyy hh:mm:ss";
return DateTime.ParseExact(dateString, format, provider); 
```

# html - 如何在保持 CSS 中的纵横比的同时调整图像大小？

> ID：12320761
> 
> 赞同：38
> 
> 时间：2012-09-07T15:07:49.017
> 
> 标签：html, css, image

我有一张大图。我想在自己的网页上显示它，并且在没有任何 CSS 的情况下执行此操作时，它会填满整个页面并且太大而无法立即显示（出现滚动条）。我想缩小它，使其适合用户屏幕的高度（而不是宽度）。我找到了解决方案，但这些解决方案会拉伸图像以适应整个屏幕——我不希望这样，因为它会破坏纵横比。

基本上，我想在保持纵横比的同时调整图像大小。我该怎么做呢？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-09-07T15:09:20.350

只需设置`width`为`auto`：

```
img {
   width: auto;
   max-height: 100%;
} 
```

这是小提琴：http: [//jsfiddle.net/6Y5Zp/](http://jsfiddle.net/6Y5Zp/)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2015-02-22T11:21:22.147

这是示例之一

```
div{
   width: 200px;
   height:200px;
   border:solid
 }

img{
    width: 100%;
    height: 100%;
    object-fit: contain;
    }
```

```
<div>
  <img src="https://upload.wikimedia.org/wikipedia/meta/0/08/Wikipedia-logo-v2_1x.png">
</div>
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-05-30T13:59:37.660

您可以使用带有背景图像的 div 并设置背景大小：包含：

```
div.image{
    background-image: url("your/url/here");
    background-size:contain;
    background-repeat:no-repeat;
    background-position:center;
} 
```

现在您可以将您的 div 大小设置为您想要的任何大小，并且图像不仅会保持其纵横比，而且还会垂直和水平集中。只是不要忘记在 css 上设置大小，因为 div 在标签本身上没有宽度/高度属性。

background-size 属性只是 ie>=9 而已。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-05T02:56:20.863

我认为您需要在要显示的图像中粘贴一个类

```
< image  class="image" > 
```

这就是课堂

```
.image 

 text align: center
 max width:pixels you want
 max height pixels you want 
```

但要确保两者的数量相同，这样就不会在高度和宽度上超出屏幕。

或者你可以玩宽度和高度

# sql - 当@filter=1 ....时是否可以写一个where case？

> ID：12320762
> 
> 赞同：1
> 
> 时间：2012-09-07T15:07:52.493
> 
> 标签：sql, sql-server, subquery, case

与

*   SQL 服务器 2005
*   程序
*   参数

我有一个正常的查询：

```
select column1, column2
from table1
where column3 in ( select columnb from table2 ) 
```

现在我有一个过滤器，例如一个 int

```
declare @filtertype int /*@filtertype=1 then column3,@filtertype=2 then column2*/ 
set @filtertype int 
```

我喜欢这样的东西

```
select column1, column2
from table1
where
   case when @filtertype=1 then (column3 in (select columnb from table2))
   else (column2 in (select columnb from table2)) 
```

如果你看到它，你会看到独特的变化是 column3 的 column2

我不想像这样复制我的大查询：

```
if(@filtertype=1)
begin
   first query
end
else
   other query
begin
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T15:10:15.123

试试这个：

```
 select column1, column2 
    from table1 
    where 
    (@filtertype=1 AND (column3 in (select columnb from table2)))
    OR
    (@filtertype=2 AND (column2 in (select columnb from table2))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T15:13:08.090

```
select 
...
from ...
where (@filtertype=1 and column3 in (select ... from table2))
or (@filtertype<>1 and column2 in (select ... from table2)) 
```

# c - 禁用 WinAPI

> ID：12320763
> 
> 赞同：5
> 
> 时间：2012-09-07T15:07:53.223
> 
> 标签：c, winapi, dll

我正在构建一个游戏，每个玩家都必须对他的机器人进行编程。关键的想法是玩家将使用 C（或 C++，或任何兼容的语言）进行编程，构建一个 DLL 并将这个 DLL 发送到服务器，这样任何人都无法获得他的代码。问题是：如何确保他没有调用任何非法函数？就像创建文件或打开套接字一样。DLL 将使用 LoadLibrary 加载并调用一个函数。所有交互都将通过回调函数进行。一个可能的解决方案是放置一个空的 kernel32.dll（和其他），这样所有的 winapi 调用都会失败。这是否安全并且适用于每种情况？有更好的方法吗？

请注意，玩家线程（也就是所谓的 dll）必须仍然能够与游戏通信，可能使用打开的套接字。在 Linux 上，这可以通过[`seccomp`](http://en.wikipedia.org/wiki/Seccomp).

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-07T15:18:55.713

您最好的选择是创建一个具有降低权限的用户，这将允许您非常轻松地控制文件访问，并在以该用户身份运行的子进程中运行机器人代码。

如果你还想限制网络连接，也很容易设置防火墙，使上述进程无权连接到外部主机。

如果您需要更多地控制允许或不允许哪些 API 调用，可以使用一种称为“通过 DLL 重定向的 API 拦截”的技术，例如此处说明：

```
http://109.163.225.194/download/files/other/DLL_Redirection_en.pdf 
```

（通过谷歌找到）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-07T15:36:23.697

如果没有在加载所有 DLL 之前完全分析它们（这基本上是不可能的），或者在与`seccomp`. 考虑到您为限制其访问而采取的任何措施，例如创建一个 dummy `kernel32.dll`，用户提交的 DLL 可以采取对策，例如加载您没有考虑的 DLL，调用由主机进程加载的 DLL（可能通过宿主应用程序！），或直接提交 Windows 系统调用。

一种选择可能是利用 Windows 安全令牌功能，Google Chrome 使用该功能来“沙盒”Web 渲染器进程。不过，这是*非常*神秘的东西，无论如何它都涉及在单独的进程中运行 DLL。如果您仍然感兴趣，您可能需要阅读[Windows Chrome 沙盒设计文档](http://dev.chromium.org/developers/design-documents/sandbox)。不过请记住，谷歌已经花费了大量的开发时间来“正确”沙盒，但仍然存在一些引人注目的妥协——你可以在你的自己很苗条，尤其是以前没有丰富的 Windows 安全经验。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-07-26T16:17:35.917

也许我的回答不会很有帮助，但我认为使用 DLL 或任何其他包含机器代码的可执行文件是不安全的，即使它以受限用户身份运行，甚至在虚拟机中运行，它仍然会打开攻击向量。首先想到的是使用现成的解释器并用它来编译你自己的字节码。但是，如果您坚持使用 DLL，您可以编辑 DLL 导入地址表并丢弃不需要的功能。听起来很复杂，有一个[库](https://www.reversinglabs.com/open-source/titanengine.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-01T18:04:07.710

本地防火墙可以解决网络方面的问题 - 但我认为您问题的其他部分没有简单的防弹解决方案。我也相信放置一个“空”的 kernel32 和 ntdll 可能会对许多合法进程造成一些严重的问题。

# c# - 碰撞时阻止运动

> ID：12320764
> 
> 赞同：2
> 
> 时间：2012-09-07T15:07:53.980
> 
> 标签：c#, xna, physics, blocking, collision

我正在 XNA 中开发一个 2d 游戏，我目前正在学习我的物理课。我目前的任务是在一个物体与另一个物体碰撞时停止它。当两个物体发生碰撞时，我已经让我的游戏调用了这个函数：

```
public void BlockMovement(gameObject target) {
    //you can call width by just typing width. same for height
    owner.position.X += (owner.position.X - target.position.X);
    owner.position.Y += (owner.position.Y - target.position.Y);
} 
```

问题是，而不是停止。移动的物体被推回它的宽度。有人可以告诉我/告诉我如何做到这一点，我在许多项目中已经坚持了很长时间。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T19:20:01.110

您没有将目标和所有者的宽度和高度计算在内。目标/所有者的 X、Y 在哪里？中间？左上角？

如果碰撞是面对面的，那么

```
velocity=sqrt(x_velocity*x_velocity+y_velocity*y_velocity); //some pseudo   

public void BlockMovement(gameObject target) {
    //you can call width by just typing width. same for height
    owner.position.X -=owner.x_velocity*penetration_length/(owner.velocity);
    owner.position.Y -=owner.y_velocity*penetration_length/(owner.velocity);
} 

//so, if big part of speed is in x-direction then the position will
//change mostly on x-direction and opposite to velocity 
```

如果您没有速度变量，您可以引入 2 次迭代的位置历史来计算实际速度方向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T18:06:04.820

你有两个选择：

1）在移动之前预测碰撞并防止碰撞发生或 2）移动，检测碰撞，然后相应地解决碰撞

我的游戏使用方法 2 在物体与不可通过的瓷砖碰撞时停止物体。下面描述这样的过程。

```
objectPreviousPosition = object.position
object.move()
if(object.isCollidingWith(wall))
    object.position = objectPreviousPosition 
```

这是非常基本的，并没有描述如何检测碰撞，只描述了如果您的碰撞逻辑返回 true 时该怎么做。此外，如果玩家的更新导致碰撞，此方法将阻止任何和所有移动。因此，您将无法使用此方法实现沿墙壁的“滑动”效果。

如果需要，为了实现滑动效果，您需要确定玩家移动的方向并通过根据该方向调整玩家的位置来解决碰撞。

例如：

```
if(object.movementDirection == movementDirection.UpRight)
    if(player colliding with wall to right)
        keep Y coordinate and set X coordinate to put player on left side of wall 
```

这都是伪代码，所以不要把代码当作文字。

# java - 如何设置 log4j 以使用 NTLM 身份验证发送电子邮件？

> ID：12320766
> 
> 赞同：0
> 
> 时间：2012-09-07T15:07:57.137
> 
> 标签：java, log4j

有没有办法通过只允许基于 NTLM 身份验证的交换服务器使用 Java log4j 发送电子邮件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T21:34:41.190

默认附加程序仅依赖于 SMTP 身份验证，因此它不会自行生成。[您可以按照此处](http://horrikhalid.wordpress.com/2010/06/20/how-to-use-log4j-with-gmail/)所述创建自定义电子邮件附加程序（链接只是为了说明谁首先分享了这个想法，这不是我的）。它基本上创建了完成身份验证的附加程序

```
import java.util.Properties;

import javax.mail.Authenticator;
import javax.mail.PasswordAuthentication;
import javax.mail.Session;

import org.apache.log4j.net.SMTPAppender;

/**
* @author DEV
*
*/
public class GmailAppender extends SMTPAppender {
private boolean startTLS = false;

@Override
protected Session createSession() {
Properties props = null;
try {
props = new Properties(System.getProperties());
} catch (SecurityException ex) {
props = new Properties();
}
String prefix = "mail.smtp";
if (this.getSMTPProtocol() != null) {
props.put("mail.transport.protocol", this.getSMTPProtocol());
prefix = "mail." + this.getSMTPProtocol();
}

if (this.getSMTPHost() != null)
props.put(prefix + ".host", this.getSMTPHost());
if (this.getSMTPPort() > 0)
props.put(prefix + ".port", String.valueOf(this.getSMTPPort()));
if (this.startTLS)
props.put("mail.smtp.starttls.enable", "true");

Authenticator auth = null;
if (this.getSMTPPassword() != null && this.getSMTPUsername() != null) {
props.put(prefix + ".auth", "true");
auth = new Authenticator() {
... 
```

然后，在配置文件中，

```
#email appender
log4j.appender.mail=com.horri.GmailAppender
#defines how othen emails are send
log4j.appender.mail.BufferSize=1
log4j.appender.mail.SMTPHost=smtp.gmail.com
log4j.appender.mail.From=yourmail@servermail.com
log4j.appender.mail.To=yourmail@gmail.com
log4j.appender.mail.startTLS = true
log4j.appender.mail.SMTPUsername=yourgmailusername
log4j.appender.mail.SMTPPassword=yourgmailpasswd
log4j.appender.mail.Subject=Log ...
log4j.appender.mail.threshold=error
log4j.appender.mail.layout=org.apache.log4j.PatternLayout
log4j.appender.mail.layout.ConversionPattern=%d{ABSOLUTE} %5p %c{1}:%L - %m%n 
```

**编辑：有时有用会与“支持懒惰”混为一谈。因此，这是一个 apache 许可的 NTLM auth 实现。[http://code.google.com/p/ntlm-java/](http://code.google.com/p/ntlm-java/)希望它能正常工作。

# c# - 如何在.net 上为 WebClient 设置超时？

> ID：12320768
> 
> 赞同：6
> 
> 时间：2012-09-07T15:08:00.430
> 
> 标签：c#, timeout, webclient, webrequest, downloadfileasync

我下载了一些文件，但我也想为 webclient 设置超时。正如我所看到的，我们可以使用覆盖 WebRequest 没有任何变化。我已经这样做了，但它不起作用。我的意思是覆盖 GetWebRequest 方法不起作用..这是我的代码

```
 public class VideoDownloader : Downloader
{
    /// <summary>
    /// Initializes a new instance of the <see cref="VideoDownloader"/> class.
    /// </summary>
    /// <param name="video">The video to download.</param>
    /// <param name="savePath">The path to save the video.</param>
    public VideoDownloader(VideoInfo video, string savePath)
        : base(video, savePath)
    { }

    /// <summary>
    /// Starts the video download.
    /// </summary>
    public override void Execute()
    {
        // We need a handle to keep the method synchronously
        var handle = new ManualResetEvent(false);

        var client = new WebClient();

        client.DownloadFileCompleted += (sender, args) => handle.Set();
        client.DownloadProgressChanged += (sender, args) =>
        this.OnProgressChanged(new ProgressEventArgs(args.ProgressPercentage));

        this.OnDownloadStarted(EventArgs.Empty);

      client.DownloadFileAsync(new Uri(this.Video.DownloadUrl), this.SavePath);

        handle.WaitOne();
        handle.Close();

        this.OnDownloadFinished(EventArgs.Empty);
    }

    protected override WebRequest GetWebRequest(Uri address)
    {
        WebRequest w = base.GetWebRequest(address);
        w.Timeout = 10*1000; // 20 * 60 * 1000;
        return w;

    }

} 
```

**和下载类**

```
 public abstract class Downloader: WebClient
{
    /// <summary>
    /// Initializes a new instance of the <see cref="Downloader"/> class.
    /// </summary>
    /// <param name="video">The video to download/convert.</param>
    /// <param name="savePath">The path to save the video/audio.</param>
    protected Downloader(VideoInfo video, string savePath)
    {
        this.Video = video;
        this.SavePath = savePath;
    }

    protected override WebRequest GetWebRequest(Uri address)
    {
        WebRequest w = base.GetWebRequest(address);
        w.Timeout = 10 * 1000; // 20 * 60 * 1000;
        return w;

    }

    /// <summary>
    /// Occurs when the download finished.
    /// </summary>
    public event EventHandler DownloadFinished;

    /// <summary>
    /// Occurs when the download is starts.
    /// </summary>
    public event EventHandler DownloadStarted;

    /// <summary>
    /// Occurs when the progress has changed.
    /// </summary>
    public event EventHandler<ProgressEventArgs> ProgressChanged;

    /// <summary>
    /// Gets the path to save the video/audio.
    /// </summary>
    public string SavePath { get; private set; }

    /// <summary>
    /// Gets the video to download/convert.
    /// </summary>
    public VideoInfo Video { get; private set; }

    /// <summary>
    /// Starts the work of the <see cref="Downloader"/>.
    /// </summary>
    public abstract void Execute();

    protected void OnDownloadFinished(EventArgs e)
    {
        if (this.DownloadFinished != null)
        {
            this.DownloadFinished(this, e);
        }

    }

    protected void OnDownloadStarted(EventArgs e)
    {
        if (this.DownloadStarted != null)
        {
            this.DownloadStarted(this, e);
        }
    }

    protected void OnProgressChanged(ProgressEventArgs e)
    {
        if (this.ProgressChanged != null)
        {
            this.ProgressChanged(this, e);
        }
    }
} 
```

我的错误在哪里？注意：我想做异步下载

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-07T15:18:10.787

来自 MSDN 文档：

> Timeout 属性仅影响使用 GetResponse 方法发出的同步请求。要使异步请求超时，请使用 Abort 方法。

因此，如果您要执行异步请求，我认为您需要管理自己的计时器，并在任何时间后在实例上调用 .Abort() 。

该方法的[此 MSDN 页面](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.abort.aspx)上有一些示例代码`.Abort()`。

# batch-file - 如何将文本文件的每一行输入到多个输出文本文件中？

> ID：12320770
> 
> 赞同：2
> 
> 时间：2012-09-07T15:08:05.810
> 
> 标签：batch-file, text-files

所以我使用批处理脚本。我需要做的是：我有一个 servers.txt 文件，其中包含 100 多个服务器名称（每行 1 个......所以文本文件中有 100 多行）。我需要在不同的文本文件中输出服务器名称。所以基本上，我想要 100 多个文本文件，每个文件中都有服务器名称。

我如何使用批处理来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T15:19:26.067

如果服务器名称是唯一的，我认为您可以执行以下操作：

```
@Echo Off
Set _InputFile=servers.txt
for /f %%a in (_InputFile) do ECHO %%a >> %%a.txt 
```

或者，如果它们都在一个带有分隔符的行上，请说一个逗号：

```
@Echo Off
Set _InputFile=servers.txt    
for /f "delims=," %%a in _InputFile do ECHO %%a >> %%a.txt 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T06:24:59.243

使用记事本++，您可以使用宏快速键入大部分内容。

```
@echo off
set Counter=1
(
set /p Server1=
set /p server2=
set /p server3=
set /p server4=
::This pattern continued for every line in the file or longer
)<Servers.txt
SETLOCAL ENABLEDELAYEDEXPANSION
:loop
echo !Server%Counter%!>!Server%Counter%!.txt
set /a Counter=%Counter%+1
if /i %Counter% GTR (Insert Number of files to be made here) goto out
goto loop
:out
ENDLOCAL
echo Job Successful!
pause 
```

你有它。还可以使用记事本++ 打开您的 servers.txt 文件并快速找出有多少行。数字位于屏幕底部。

# java - 在java中显示字符串的第二行

> ID：12320771
> 
> 赞同：2
> 
> 时间：2012-09-07T15:08:09.337
> 
> 标签：java, string, printing, line

给定一个像这样的字符串：

```
String str= "line1
line2
line3
line4"; 
```

如何显示一个特定的行？例如第三个，比如

```
System.out.println([...]str[...]); 
```

在终端中将显示：

```
line3 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:13:18.657

您可以使用 split 语句。它通过给定的正则表达式分隔字符串。在这种情况下，正则表达式将是 \n：

```
String[] lines;

  String regex= "\\n";
  lines = str.split(regex); 
```

然后，您可以使用以下命令访问第 3 行：

```
String line3 = lines[2]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T15:09:24.033

根据其格式拆分输入字符串..

```
System.out.println(str.split('\\n')[2]); 
```

[请参阅此处](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#split%28java.lang.String%29)`split()`的方法文档。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T15:10:03.440

```
String[] strings = str.split('\\n');
if (strings.length > 1){
  return strings[1];
} 
```

# android - 操作栏 - 菜单按钮 - 缺失

> ID：12320775
> 
> 赞同：4
> 
> 时间：2012-09-07T15:08:21.770
> 
> 标签：android, android-actionbar, missing-features

通过删除一些东西（我怀疑），我设法搞砸了我的一个 Android 项目。以下是我的清单和菜单资源。由于某种原因，当我运行应用程序时，我的操作栏没有显示菜单按钮。

```
<menu xmlns:android="http://schemas.android.com/apk/res/android">
<item android:id="@+id/menu_settings"
    android:title="@string/menu_settings"
    android:orderInCategory="100"
    android:showAsAction="never" />
</menu> 
```

显现：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.myapp"
android:versionCode="6"
android:versionName="2.1.0" >

<uses-permission android:name="android.permission.WRITE_SETTINGS"/>
<uses-permission android:name="android.permission.INTERNET"/>
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="15" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name=".MyActivity"
        android:label="@string/title_activity" 
        android:screenOrientation="portrait">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application>

</manifest> 
```

我的活动代码中也有这个

```
 @Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity, menu);
    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    // Handle item selection
    switch (item.getItemId()) {
        case R.id.menu_settings:
            return true;
        default:
            return super.onOptionsItemSelected(item);
    }
} 
```

但是在应用程序运行时仍然没有创建菜单/选项按钮。有任何想法吗？

**编辑 1**

经过一些重大试验后，我发现向我的应用程序添加本地化支持导致了这个问题。

我删除了所有本地化的 values-* 目录并且操作栏回来了，然后我将 values 目录复制到 values-en 并在我的英语设备上运行它。然后操作栏消失了。这对任何人都有启发吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-07T16:10:12.113

屏幕溢出菜单按钮仅出现在缺少屏幕外菜单按钮的设备的操作栏中。尝试按设备或模拟器上的 MENU 按钮。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-10T09:45:05.727

好的，找出导致问题的原因，如果有人以前遇到过这个问题，我可能没有在我的原始帖子中提供足够的信息。

我犯的致命错误是

```
cp -r res/values res/value-en 
```

我对所有语言环境都这样做了，这也复制了`styles.xml` 文件。在目录中有这个会导致这个非常烦人的头痛！

删除它并仅将`styles.xml`文件放在`res/values`目录和`res/values-v*`目录中解决了该问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T15:18:02.643

我认为您的`onCreateOptionsMenu`-`MenuInflater`是问题，更改为以下内容，看看是否适合您：

```
public boolean onCreateOptionsMenu(Menu menu) {
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.activity, menu);
    return true;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-16T22:17:21.540

```
 android:showAsAction="never" 
```

将此行更改为：

```
 android:showAsAction="ifRoom" 
```

# c# - 使用 OpenXML 合并 PowerPoint 幻灯片

> ID：12320777
> 
> 赞同：2
> 
> 时间：2012-09-07T15:08:30.053
> 
> 标签：c#, .net, powerpoint, openxml, openxml-sdk

我想要做的就是使用 OpenXML SDK 将一些幻灯片合并到一个主演示文稿中，我不想使用 Introp，因为它在服务器环境中并不理想，我尝试了很多代码示例，但合并的演示文稿总是向我显示修复消息，当我将损坏的文件与修复的文件进行比较时，我发现没有正确生成 id。

是否有任何真正有效的开源库或示例代码。我听说过 Aspose，但它是一个付费图书馆。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T06:06:08.030

The Microsoft MSDN article

[http://msdn.microsoft.com/en-us/library/office/ee361883(v=office.12).aspx](http://msdn.microsoft.com/en-us/library/office/ee361883(v=office.12).aspx)

gives a step by step instruction on how to merge powerpoint presentations together.

It takes care of ensuring the ID's are unique. The only disadvantage is that it also copies the slide masters for each and every slide, making the final powerpoint file larger than expected.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-05-11T22:37:53.687

[在http://openxmldeveloper.org/](http://openxmldeveloper.org/)尝试演示生成器代码。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2016-02-24T07:14:19.737

是的，如果 id 不是唯一的，你会遇到问题，下面是我正在使用的工作代码。我知道它的旧线程，但如果有人正在寻找答案，

```
public static void MergeSlides(string presentationFolder, string sourcePresentation, string destPresentation)
{
    int id = 0;

    // Open the destination presentation.
    using (PresentationDocument myDestDeck = PresentationDocument.Open(presentationFolder + destPresentation, true))
    {
        PresentationPart destPresPart = myDestDeck.PresentationPart;

        // If the merged presentation does not have a SlideIdList element yet, add it.
        if (destPresPart.Presentation.SlideIdList == null)
            destPresPart.Presentation.SlideIdList = new SlideIdList();

        // Open the source presentation. This will throw an exception if the source presentation does not exist.
        using (PresentationDocument mySourceDeck = PresentationDocument.Open(presentationFolder + sourcePresentation, false))
        {
            PresentationPart sourcePresPart = mySourceDeck.PresentationPart;

            // Get unique ids for the slide master and slide lists for use later.
            uniqueId = GetMaxSlideMasterId(destPresPart.Presentation.SlideMasterIdList);

            uint maxSlideId = GetMaxSlideId(destPresPart.Presentation.SlideIdList);

            // Copy each slide in the source presentation, in order, to the destination presentation.
            foreach (SlideId slideId in sourcePresPart.Presentation.SlideIdList)
            {
                SlidePart sp;
                SlidePart destSp;
                SlideMasterPart destMasterPart;
                string relId;
                SlideMasterId newSlideMasterId;
                SlideId newSlideId;

                // Create a unique relationship id.
                id++;
                sp = (SlidePart)sourcePresPart.GetPartById(slideId.RelationshipId);

                relId = sourcePresentation.Remove(sourcePresentation.IndexOf('.')) + id;

                // Add the slide part to the destination presentation.
                destSp = destPresPart.AddPart<SlidePart>(sp, relId);

                // The slide master part was added. Make sure the relationship between the main presentation part and
                // the slide master part is in place.
                destMasterPart = destSp.SlideLayoutPart.SlideMasterPart;
                destPresPart.AddPart(destMasterPart);

                // Add the slide master id to the slide master id list.
                uniqueId++;
                newSlideMasterId = new SlideMasterId();
                newSlideMasterId.RelationshipId = destPresPart.GetIdOfPart(destMasterPart);
                newSlideMasterId.Id = uniqueId;

                destPresPart.Presentation.SlideMasterIdList.Append(newSlideMasterId);

                // Add the slide id to the slide id list.
                maxSlideId++;
                newSlideId = new SlideId();
                newSlideId.RelationshipId = relId;
                newSlideId.Id = maxSlideId;

                destPresPart.Presentation.SlideIdList.Append(newSlideId);
            }

            // Make sure that all slide layout ids are unique.
            FixSlideLayoutIds(destPresPart);
        }

        // Save the changes to the destination deck.
        destPresPart.Presentation.Save();
    }
}

   public static void FixSlideLayoutIds(PresentationPart presPart)
    {
        //Need to make sure all slide layouts have unique ids
        foreach (SlideMasterPart slideMasterPart in presPart.SlideMasterParts)
        {
            foreach (SlideLayoutId slideLayoutId in slideMasterPart.SlideMaster.SlideLayoutIdList)
            {
                uniqueId++;
                slideLayoutId.Id = (uint)uniqueId;
            }
            slideMasterPart.SlideMaster.Save();
        }
    } 
```

# html - 使用 clear:both 使 div 内容的全高？

> ID：12320781
> 
> 赞同：4
> 
> 时间：2012-09-07T15:08:58.797
> 
> 标签：html, css

您是否需要`<div style="clear:both">&nbsp;</div>`在任何浮动内容之后使用类似的东西来确保您的 div 达到内容的全部高度，或者有没有更简单的方法来做到这一点？

下面是我目前使用的代码

HTML

```
<div class="socialmedia">
<h2>Stay Connected</h2>
<ul>
<li><img src="images/twitter.png" width="32" height="32" alt="Twitter" /></li>
<li><img src="images/googleplus.png" width="32" height="32" alt="Google Plus" /></li>
<li><img src="images/behance.png" width="32" height="32" alt="Behance" /></li>
<li><img src="images/dribble.png" width="32" height="32" alt="Dribble" /></li>
<li><img src="images/pinterest.png" width="32" height="32" alt="Pintrest" /></li>
<li><img src="images/email.png" width="32" height="32" alt="Email" /></li>
</ul>
<div style="clear:both">&nbsp;</div>
</div><!-- close social media --> 
```

CSS

```
 .socialmedia {
width:960px;
background-color:#C69;

 }

 .socialmedia ul {
margin:0;
padding:0;
clear:both;
}

 .socialmedia ul li {
float:left;
list-style:none;
margin-right:20px;
 } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T15:11:03.853

您可以将溢出：自动添加到您的容器 DIV。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-07T15:11:15.210

您可以给出`.socialmedia`一种样式`overflow:hidden`并删除清除 div。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T15:21:28.237

使用`li { display: inline-block; }`- 为您提供将列表居中的灵活性，并且不需要任何浮动清除方法。

见：http: [//jsfiddle.net/Wexcode/NKzm2/](http://jsfiddle.net/Wexcode/NKzm2/)

*请注意，在我添加的小提琴中`ul { font-size: 0; }`- 这是为了否定内联元素会导致标记中的空白在其字体大小不为零时显示的事实。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T15:18:08.037

添加

```
.socialmedia ul:after {
    content:'';
    display:block;
    clear:both;
} 
```

# javascript - d3.tree => 转换似乎不起作用

> ID：12320786
> 
> 赞同：8
> 
> 时间：2012-09-07T15:09:09.367
> 
> 标签：javascript, firebug, d3.js

我使用 d3js 创建了一个树形布局图。节点可单击以切换显示子节点。子节点应插入到预定义的位置，然后转换到所需的位置。问题是插入坐标总是关闭的。使用 Firebug 进行调试时，它显示直接在附加新节点后，其坐标为 x = 51.42857142857142 和 y = 200.0，即使该行
`.attr("transform", "translate(90,100)" )`应该改变它们（我在这里使用固定值，以进一步确定问题。

我的错误在哪里？

完整代码：

```
// Toggle children.
function toggle(d) {
   if (d.children) {
     d._children = d.children;
     d.children = null;
   } else {
     d.children = d._children;
     d._children = null;
  }
} 

function toggleAll(d) {
   if (d.children) {
      d.children.forEach(toggleAll);
      toggle(d);
   }
}

function update(source) {
   // Node movement delay
   var duration = d3.event && 1500;

   // Compute the new tree layout.
   var nodes = tree.nodes(root).reverse();

   // Normalize for fixed-depth.
   nodes.forEach(function(d) { d.y = d.depth * 100; });

   // Update the nodes…
   var node = vis.selectAll("g.node")
     .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent's previous position.
   var nodeEnter = node.enter().append("svg:g")
    .attr("class", "node")
    .attr("transform", "translate(90,100)" )
    .on("click", function(d) { toggle(d); update(d); });

  nodeEnter.append("svg:circle")
    .attr("r", 1e-6);

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
    .duration(duration)
    .attr("transform", function(d) { return "rotate(" + (d.x - 90) + ")translate(" + d.y + ")"; })

  nodeUpdate.select("circle")
    .attr("r", 4.5)
    .style("fill", function(d) { return d._children ? "red" : "#fff"; });

  // Transition exiting nodes to the parent's new position.
  var nodeExit = node.exit().transition()
     .duration(duration)
     .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
    .remove();

 // While moving the nodes, they need to shrink
 nodeExit.select("circle")
   .attr("r", 1e-6);

    // Stash the old positions for transition.
    nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
   });
}

var i = 0, root;
var radius = 960 / 2;
var tree = d3.layout.tree()
   .size([360, radius - 120]);
var diagonal = d3.svg.diagonal.radial()
   .projection(function(d) { return [d.y, d.x / 180 * Math.PI]; });

var vis = d3.select("#body").append("svg:svg")
   .attr("width", radius * 2)
   .attr("height", radius * 2 - 50)
   .append("g")
   .attr("transform", "translate(" + radius + "," + radius + ")");

d3.json("flare.json", function(json) {
  root = json;
  root.x0 = 0;
  root.y0 = 0;

  // Initialize the display to show a few nodes.
  root.children.forEach(toggleAll);
  toggle(root.children[1]);

  update(root);
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-18T16:51:36.710

您可以通过调整初始坐标来更改插入坐标`transform`，即更改

```
.attr("transform", "translate(90,100)") 
```

例如，如果您想在其父节点的位置插入新节点，您可以通过将父元素的引用传递给`update`函数并获取其`transform`值来实现：

```
var sourceNode = d3.select(parentElement);

// Enter any new nodes at the parent's previous position.
var nodeEnter = node.enter().append("svg:g")
    .attr("class", "node")
    .attr("transform", parentElement ? sourceNode.attr("transform") : "translate(90,100)")
    .on("click", function (d) {
    toggle(d);
    update(d, this);
}); 
```

[在这里](http://jsfiddle.net/94EWe/7/)完成 jsfiddle 。

# asp.net - ASP.NET 中继器，动态启动新表行

> ID：12320788
> 
> 赞同：1
> 
> 时间：2012-09-07T15:09:11.833
> 
> 标签：asp.net, repeater, newrow

我有以下中继器：

```
<table>
        <asp:Repeater runat="server" ID="rptBrandRepeater">
            <ItemTemplate>
                <tr>
                    <td>
                        <asp:HyperLink runat="server" ID="lnkCompanyLink">
                            <asp:Image runat="server" ID="imgCompanyLogo" />
                        </asp:HyperLink>
                    </td>
                </tr>
            </ItemTemplate>
        </asp:Repeater>
</table> 
```

我想每四个表格单元格开始一个新行。

我不想使用 jQuery 或 Javascript 来完成此操作。

输出的 html 应该看起来像这个页面： [http ://rmtequipment.com/golfandturf.aspx](http://rmtequipment.com/golfandturf.aspx)

我制作了一个界面，允许他们自己添加这些徽标。所以这个页面将是动态构建的。

实现这一目标的最佳方法是什么？

如果列表视图或网格视图是一种更好的方法，我也对此持开放态度。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:37:01.293

在我看来，最好的方法是改用[DataList](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datalist.aspx)。您可以通过属性和要使用的布局来控制`RepeatDirection`项目的数量以及列的数量。`RepeatColumns``RepeatLayout`

所以你的 DataList 将被定义为：

```
<asp:DataList RepeatDirection="Horizontal" RepeatColumns="4" RepeatLayout="Table" ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T15:13:45.683

您最好的方法是摆脱表格并使用浮动`div`元素，因为它不是表格也不包含表格数据。

```
<asp:Repeater runat="server" ID="rptBrandRepeater">
    <ItemTemplate>
        <div class="logo">
            <asp:HyperLink runat="server" ID="lnkCompanyLink">
                <asp:Image runat="server" ID="imgCompanyLogo" />
            </asp:HyperLink>
        </div>  
    </ItemTemplate>
</asp:Repeater> 
```

然后样式化你的 div

```
div.logo{ float: left; width: 200px; display: inline; } 
```

然后，这将根据包含所有这些徽标的元素的宽度自然地中断到下一个“行”。

有关示例，请参见此基本演示：http: [//jsfiddle.net/ygnEa/](http://jsfiddle.net/ygnEa/)

# python - 使用 mod_wsgi 从不从 / 运行 Django 的站点为 Django 应用程序提供服务

> ID：12320803
> 
> 赞同：3
> 
> 时间：2012-09-07T15:10:05.443
> 
> 标签：python, django, apache, mod-wsgi

我有一个网站，我目前正在使用 Django 逐个应用程序重写。服务器是红帽。运行 Apache 2。安装了 mod_wsgi。一切正常。惊人的。

如果我访问[http://www.example.com/](http://www.example.com/)，我会访问预先存在的主站点（在 PHP 中）。

我有 mod_wsgi 运行和工作得很好。如果我访问[http://www.example.com/django/](http://www.example.com/django/)，我会访问我的 Django 主页。

我有几个可以正常工作的应用程序：

*   [http://www.example.com/django/software](http://www.example.com/django/software)：运行我的 Django 软件应用程序就好了。
*   [http://www.example.com/django/newsletter](http://www.example.com/django/newsletter)：运行我的 Django 时事通讯应用程序就好了。

所有反向 url 查找工作正常 - 一切都很好。

Apache 的 httpd.conf 中的全局条目是：

```
WSGIScriptAlias /django /path/to/django/mysite/mysite/apache/django.wsgi 
```

但是，当我将它投入生产时，我不想让 /django 部分涉及到 url。

[因此，对http://www.example.com/software](http://www.example.com/software)的请求将运行 Django 软件应用程序。

[对http://www.example.com/newsletter](http://www.example.com/newsletter)的请求将运行 Django newsletter 应用程序。

我还不能让[http://www.example.com/](http://www.example.com/)重定向到根 Django wsgi 应用程序——这可能会在几个月后整个站点 Django 重写完成后发生。

那么，有什么想法可以让我的 Django 应用程序在当前设置中工作吗？

我是否必须为每个应用程序条目创建每个应用程序 wsgi 文件（例如：/path/to/django/mysite/mysite/apache/software.wsgi 和 /path/to/django/mysite/mysite/apache/newsletter.wsgi）在 httpd.conf 文件中？如：

```
WSGIScriptAlias /software /path/to/django/mysite/mysite/apache/software.wsgi
WSGIScriptAlias /newsletter /path/to/django/mysite/mysite/apache/newsletter.wsgi 
```

我似乎找不到关于这种特定设置风格的那么多具体文档。大多数文档假设您使用一个主 wsgi 文件和 Django（通过 urls.py）来代理所有请求。我会喜欢这种情况，但现在这不可能发生。

这可能是我不得不争论的一些 Apache 指令功夫。如果是这种情况，请告诉我。

TIA。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:29:59.443

我了解到您正在为 www.example.com 上的所有内容逐个推出新内容。在另一个带有新子域的新 Apache 虚拟主机容器中设置整个 Django 项目怎么样`new.example.com`？[您可以从http://new.example.com](http://new.example.com)访问根 Django 应用程序，从[http://new.example.com/software](http://new.example.com/software)等访问软件应用程序。对于主域 www.example.com，只需设置重定向：

```
www.example.com/django -> new.example.com
www.example.com/software -> new.example.com/software
www.example.com/newsletter -> new.example.com/newsletter 
```

您可以在您抛出开关后在相同的 URL 结构上测试您的整个项目，并且抛出开关只是替换`ServerName`两个虚拟主机中的指令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-20T07:31:41.323

我有一个类似的问题，正好相反。我想用 php 安装替换 django 安装部分。

在 Apaches 虚拟主机配置中供站点使用

```
WSGIScriptAliasMatch ^(/(software|newsletter)) /path/to/django/mysite/mysite/apache/django.wsgi$1 
```

代替

```
WSGIScriptAlias /software /path/to/django/mysite/mysite/apache/software.wsgi
WSGIScriptAlias /newsletter /path/to/django/mysite/mysite/apache/newsletter.wsgi 
```

在**urls.py**中让 django 相信，挂载点是根 url `/`，如下所示：

```
...
url(r'^software/', include('software.urls')),
url(r'^newsletter/', include('newsletter.urls')),
... 
```

这样，当您完成站点并想要提供所有内容时，包括来自 django 的根 url，您只需将`WSGIScriptAliasMatch`条目替换为

```
WSGIScriptAlias / /path/to/django/mysite/mysite/apache/django.wsgi 
```

就是这样。

查看这些问答以获取更多信息：

[Django (wsgi) 和 Wordpress 在 Apache 虚拟主机中共存](https://stackoverflow.com/questions/3534678/django-wsgi-and-wordpress-coexisting-in-apache-virtualhost)

[重新配置 Apache 以从新的 php 源和旧 django 站点的特定子 URL 提供网站根目录](https://stackoverflow.com/questions/26800207/reconfiguring-apache-to-serve-website-root-from-new-php-source-and-specific-sub)

# c# - 更改 XmlElement 名称属性

> ID：12320809
> 
> 赞同：1
> 
> 时间：2012-09-07T15:10:12.723
> 
> 标签：c#, xml, replace, c++-cli

我想在 c++/cli 中更改 XmlElement 的 Name 属性。

我想做`myXmlElem.Name = "xyz"`，但编译器告诉我不能对 Name 属性进行设置操作。

IE

```
<abc/> 
```

变成

```
<xyz/> 
```

我怎样才能做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-07T15:16:36.153

您不能像那样更改 XmlElement 的 Name 属性（名称是只读的）。

但是，您可以执行以下操作（C# 中的示例）。

```
XmlElement xyz = myXmlElem.OwnerDocument.CreateElement("xyz");
myXmlElem.ParentNode.ReplaceChild(xyz, myXmlElem); 
```

编辑回应您的评论

```
XmlElement xyz = myXmlElem.OwnerDocument.CreateElement("xyz");

for(int i = 0; i < myXmlElem.ChildNodes.Count; i++){
    XmlNode child = myXmlElem.ChildNodes[i];
    xyz.AppendChild(child.CloneNode(true));
}

myXmlElem.ParentNode.ReplaceChild(xyz, myXmlElem); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-08-07T18:47:00.947

您可以使用支持更改 XElement 名称的 Linq to Xml：

```
XDocument doc = XDocument.Parse("<foo><bar /></foo>");
doc.Root.Name = "changed";//now it will look like <changed><bar /></changed> 
```

# php - Imap_search 很慢

> ID：12320814
> 
> 赞同：4
> 
> 时间：2012-09-07T15:10:25.857
> 
> 标签：php, search, imap

我正在使用 imap_search 从我的收件箱中获取消息列表。我只想要从该地址发送的电子邮件，比如说“somemail@gmail.com”。

我正在这样做：

`$headers = imap_search($box,'FROM "somemail@gmail.com"', SE_UID);`

但这需要很长时间，大约 3 分钟，收件箱只有 700 封电子邮件（我的邮箱是 GMAIL）。问题不在于服务器，因为我在 localhost 中安装了 roundcube 并快速加载电子邮件。

我该怎么做才能让它更快？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-21T07:13:35.030

这种方法在过去对我来说比 imap_search 工作得更快：

```
$stream = imap_open($mailbox,$username,$password);

//imap_num_msg returns the number of messages in the current mailbox, as an integer, so ..
$total_messages = imap_num_msg($stream);

for ($message_number = 0; $message_number < $total_messages; $message_number++)
{
  //get header
  $header = imap_header($stream, $message_number);

  if ($header === NULL)
  continue;

  //check from
  if($header->from == 'somemail@gmail.com')
  {
    // you found one so do something
  }
} 
```

# android - 如何为操作栏按钮设置 onClick 列表？

> ID：12320815
> 
> 赞同：1
> 
> 时间：2012-09-07T15:10:26.503
> 
> 标签：android

我有以下但我得到一个空指针

```
sendButton = (ImageButton) findViewById(R.id.menu_send);

        sendButton.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {

                    fbSendMessageTask.execute("test");

            }
        }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T15:13:43.060

这取决于你如何实现你的`ActionBar`. 如果你正在膨胀包含`ActionBar`你应该使用的视图

```
 sendButton = (ImageButton) inflatedView.findViewById(R.id.menu_send);

    sendButton.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {

                fbSendMessageTask.execute("test");

        }
    }); 
```

# c# - ASP.NET Membership 导致问题并添加多个相似的用户名但具有不同的应用程序 ID

> ID：12320816
> 
> 赞同：0
> 
> 时间：2012-09-07T15:10:27.910
> 
> 标签：c#, asp.net, asp.net-membership

我有一个 ASP.NET 网站，其中我面临登录问题，用户名被添加为多个但具有不同的应用程序 ID，但用户名是相同的。

由于对于这个应用程序，许多开发人员一直在研究它，无论是谁启动它，他都在 Web.config 以及 ASPNET Membership 配置（aspnet_regsql.exe 等）中创建了一个新的应用程序名称，并且一些应用程序名称是仅用于测试
构建/测试目的。

由于上述原因，数据库中添加了各种类似的命名用户，但他们的应用程序ID不同。因此，登录会导致一些失败，并且用户无法登录。

尽管我发现以下一篇文章很有用，但我认为它可能会给试图回答我问题的人一些提示：-

[当使用具有不同应用程序名称的多个角色提供者时，如何防止重复的成员资格用户？](https://stackoverflow.com/questions/3298685/how-do-i-prevent-duplicate-membership-users-when-using-multiple-roleproviders-wi)

在已部署应用程序的服务器中，应用程序中的错误日志显示以下详细信息：- **事件代码：4006 事件消息：成员资格凭证验证失败。**

由于应用程序名称只有一个，即“/FOPortal”，因此不使用其他名称。

请在下面可能需要的 web.config 部分找到：-

```
<add name="utConnString" connectionString="Data Source=blabla\SQLEXPRESS2008;Initial Catalog=FOPortal;User Id=sa;Password=123;Max Pool Size=100;" providerName="System.Data.SqlClient"/>
<membership defaultProvider="SqlProvider" userIsOnlineTimeWindow="20">
<providers>
 <clear/>
<add name="SqlProvider" type="System.Web.Security.SqlMembershipProvider"         connectionStringName="utConnString" enablePasswordRetrieval="false"  enablePasswordReset="true" requiresQuestionAndAnswer="false" passwordFormat="Hashed"  applicationName="/FOPortal"/>
</providers>
</membership>
<roleManager enabled="true"></roleManager> 
```

我想知道我将如何解决这个问题。

此致，
穆扎法尔·阿里·拉纳。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T19:38:13.510

我将根据明确选择的用户名进行更新，并更新您希望其用户名在应用程序当前状态下保持有效的字段的 applicationid。

[Sharepoint 设置线程](http://social.technet.microsoft.com/Forums/zh/sharepoint2010setup/thread/77cee2ee-1721-4696-b7ff-6854213eb2de)

# teamcity - TeamCity - 计划构建未开始

> ID：12320818
> 
> 赞同：1
> 
> 时间：2012-09-07T15:10:34.313
> 
> 标签：teamcity

我已经在 TC 论坛上发布了这个问题，但到目前为止还没有收到任何回复，所以决定在这里碰碰运气。

最近我开始看到非常奇怪的行为，并且会很感激任何可能出错的想法。我在内部数据库上使用 7.1 版（内部版本 23907）。我有两个使用单个构建模板的构建（开发和发布）。因此所有步骤、参数和构建触发器都在模板中定义，特定构建仅更改结帐分支等。

所以这个设置一直工作得很好，每天都按计划触发。但最近其中一个版本停止工作。两个构建的更改都正确汇集（如果我在挂起的更改选项上使用触发器），但只有一个构建被触发并运行。当然，手动运行一切正常，但问题是构建永远不会被触发。

我只向有问题的构建添加了一个触发器（而不是模板），再次，简单的预定触发器，但仍然没有，构建没有开始......

我应该尝试寻找的任何线索或方向都会非常有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T10:54:09.813

是否在触发器配置中选中了“如果它们来自同一个提交者，则在构建中包含多个签入”复选框？

我遇到了类似的问题，当我取消选中该选项时，一切都开始工作了。

# android - Android Zxing - 框架矩形有什么用？

> ID：12320820
> 
> 赞同：0
> 
> 时间：2012-09-07T15:10:47.690
> 
> 标签：android, qr-code, zxing

我知道你应该把代码放在那里，但为什么首先需要它？我的意思是，为什么不使用整个屏幕（我想这是有原因的，我需要它来证明我的客户的行为是合理的）。

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T16:03:54.583

主要原因是：

1.  它可以帮助用户对齐代码，减少轮换。
2.  一个重要的问题：大多数设备无法聚焦太近的任何东西。为了将代码放入取景器内，用户需要在代码和设备之间留出一些空间。这个空间允许相机对焦。

不过，我修改了ZXing的代码，让它全屏扫描，效果很好！但是我还是画了取景器，因为上面提到的两个原因。

# vba - 在访问中更改表单导航上命令按钮的属性

> ID：12320827
> 
> 赞同：2
> 
> 时间：2012-09-07T15:11:15.630
> 
> 标签：vba, ms-access, ms-access-2007

我有一个访问表单，其中包含一个命令按钮，该按钮将对当前记录执行特定操作 onclick。我需要通过导航表单中当前记录之前的记录来禁用按钮功能，换句话说，除非当前记录仅是新记录，否则始终保持按钮属性（启用）= false。

这让我思考如何通知访问 vba 进行导航，如果当前记录是新记录，则启用按钮执行其功能，或者如果它是一个 preivouse 记录，则取消按钮属性（启用）= false .

这可以执行和工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:19:32.770

从 On Current 事件的代码中检查表单的`NewRecord`属性，并使用它来启用/禁用命令按钮。

所以，如果命令按钮被命名为“cmdFoo”：

```
Private Sub Form_Current()
    If Me.NewRecord = True Then
        Me.cmdFoo.Enabled = True
    Else
        Me.cmdFoo.Enabled = False
    End If
End Sub 
```

但是，这种方式更简洁。使用对您来说似乎更清晰的方法。

```
Private Sub Form_Current()
    Me.cmdFoo.Enabled = Me.NewRecord
End Sub 
```

# java - 使用 JAVA 创建新的 SOAP Web 服务

> ID：12320829
> 
> 赞同：-1
> 
> 时间：2012-09-07T15:11:24.640
> 
> 标签：java, xml, web-services, jax-ws, jax-rpc

我们计划使用 RSA 7.5 和 Websphere 7 创建一个新的 Web 服务。但无法理解是使用 JAX-RPC 还是 JAX-WS。

我知道 JAX-RPC 是较旧的，而较新的是 JAX-WS。是否有一些特定的优势，我们可以很容易地理解应该使用哪一个？

我习惯于 JAX-RPC。JAX-WS 对我来说是新的，因此我肯定会喜欢使用我目前熟悉的东西。但我担心 RPC 是否会在未来几天内被弃用，可能会在接下来的 6 个月内，我完全不确定。

请提出建议，以便我可以继续进行并做出正确的决定。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:30:23.803

JAX-WS 最初是作为 JAX-RPC 规范的下一个版本，但包含了足够重要的更改，以至于它成为了一个新规范。如果 JAX-WS 在您的环境中可用，我建议使用它而不是 JAX-RPC。

我的 JAX-WS 示例

*   [http://blog.bdoughan.com/2011/12/eclipselink-moxy-is-jaxb-provider-in.html](http://blog.bdoughan.com/2011/12/eclipselink-moxy-is-jaxb-provider-in.html)

# javascript - JQuery 和 Javascript 在我的项目中不起作用，但在网络上可以

> ID：12320835
> 
> 赞同：1
> 
> 时间：2012-09-07T15:11:50.560
> 
> 标签：javascript, jquery, html, asp.net-mvc-3, jquery-ui

我用我的数据重用了我在 StackOverFlow 上看到的代码：http: [//jsfiddle.net/ctx3H/91/](http://jsfiddle.net/ctx3H/91/)，但是当我在 Visual Studio 10 中导入他时，按钮不起作用。我在头部包含以下声明：

```
<link href="../../../../Content/Areas.css" rel="stylesheet" type="text/css" />
<link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.14/themes/base/jquery-ui.css"
    rel="stylesheet" type="text/css" />

<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.14/jquery-ui.min.js"
    type="text/javascript"></script>
<script src="../../../../Scripts/jquery-1.6.2.js" type="text/javascript"></script> 
```

基本上我的页面包含这个声明+来自该站点[Javascript代码+ HTML]我做错了什么？提前致谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-07T15:14:28.163

逆转

```
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.14/jquery-ui.min.js"
    type="text/javascript"></script>
<script src="../../../../Scripts/jquery-1.6.2.js" type="text/javascript"></script> 
```

始终在 jQueryUI 等依赖包之前导入 jQuery 包

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:26:55.590

```
alert(jQuery); 
```

将测试 jQuery 是否已成功加载。

# jquery - jQuery：每个函数

> ID：12320836
> 
> 赞同：0
> 
> 时间：2012-09-07T15:11:53.213
> 
> 标签：jquery

在这个 codecademy.com 练习中，我应该使用 each 函数来迭代 jQuery 变量，将每个键添加到 id 为 jQueryAttributes 的列表中。我在下面编写了每个函数，但它不正确。我不确定如何使用 jQueryAttributes 将其添加到 id 中。html如下

```
var jQuery = $;

//iterate over jQuery, adding every key
//to the list with id jQueryAttributes
$.each(jQuery, function(index, value){      
$('#'+index).append($('<li></li>').html(value));
}); 
```

html

```
<div id="left">
<h1>$ methods and attributes</h1>
<ul id='jQueryAttributes'>
</ul>
</div> 
```

更新

一件事我忘了提。我应该使用函数的索引为每个列表项分配不同的 id。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:21:56.117

我想你只需要这个：

```
$.each($, function(index, value){      
    $('#jQueryAttributes').append($('<li></li>').html(index));
});​ 
```

[小提琴](http://jsfiddle.net/AuhGV/1/)

该值是实际功能，因此您需要索引

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T15:47:11.173

据我所知，您遇到了两个问题。第一个是您正在尝试使用

```
$('#'+index) 
```

连接到尚未添加到 DOM 的元素。您可以按照 CoolStraw 的建议分配 ID，并添加

```
.attr('id',index) 
```

最后设置要插入的元素的 ID。

第二个问题是您试图将 jQuery 对象的值作为字符串插入而不强制转换它们。当我对此进行探索时，结果中只有非函数和非对象值。所以而不是

```
jQuery('<li></li>').html(value) 
```

采用

```
jQuery('<li></li>').html(''+value) 
```

或者

```
jQuery('<li>'+value+'</li>') 
```

所以这些中的任何一个都可以工作：

```
$.each(jQuery,function(index,value){ $('#jQueryAttributes').append(jQuery('<li></li>').html('' + value).attr('id',index)); }); 
```

在使用 jQuery 创建元素之前将元素构建为字符串：

```
$.each(jQuery,function(index,value){ jQuery('#jQueryAttributes').append(jQuery('<li id="' + index + '">' + value +' </li>')); }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T15:13:24.847

```
$('#jQueryAttributes').append($('<li></li>').html(value)); 
```

如果要为每个项目分配不同的索引，则必须使用从 .each 返回的索引对其进行相应的格式化：

```
$('#jQueryAttributes').append($('<li id="id_'+ index +'"></li>').html(value)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T15:15:31.987

来自 jquery 文档[http://api.jquery.com/each/](http://api.jquery.com/each/)

.each() 方法旨在使 DOM 循环结构简洁且不易出错。当被调用时，它会遍历作为 jQuery 对象一部分的 DOM 元素。每次回调运行时，都会传递当前循环迭代，从 0 开始。更重要的是，回调是在当前 DOM 元素的上下文中触发的，因此关键字 this 指的是该元素。

假设我们在页面上有一个简单的无序列表：

```
<ul>
    <li>foo</li>
    <li>bar</li>
</ul> 
```

我们可以选择列表项并遍历它们：

```
$('li').each(function(index) {
    alert(index + ': ' + $(this).text());
}); 
```

因此，列表中的每个项目都会收到一条消息：

0: 富 1: 酒吧

我们可以通过返回 false 从回调函数中停止循环。

# c# - 读取 X.509 Certificate2 PrivateKey

> ID：12320837
> 
> 赞同：0
> 
> 时间：2012-09-07T15:11:54.633
> 
> 标签：c#, .net, ssl-certificate, x509certificate

尝试输出 PrivateKey 或 PublicKey 时，以下代码失败并显示以下消息。（指纹将输出正常。）：

> 该进程不具备此操作所需的“SeSecurityPrivilege”特权。

如果我以本地管理员身份运行，它可以工作。我该如何解决这个问题。

仅供参考.. 证书 (pfx) 受密码保护——但不确定如何在此代码段中指出这一点。

```
var certStore = new X509Store(StoreName.My, StoreLocation.LocalMachine);
certStore.Open(OpenFlags.ReadOnly);
string thumbprint = "D80FB0BB6485B6A2DE647812C5AA72A8F7ABA14C";

X509Certificate2Collection certCollection = certStore.Certificates.Find(
    X509FindType.FindByThumbprint,
    thumbprint, false);

// Close the certificate store.
certStore.Close();

if (certCollection.Count == 0)
{
    throw new SecurityException(string.Format(CultureInfo.InvariantCulture, "No certificate was found for thumbprint {0}", thumbprint));
}
Console.WriteLine(certCollection[0].PrivateKey); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:24:07.800

您需要授予该帐户“管理审核和安全日志权限”。有关详细信息，请参阅[http://support.microsoft.com/kb/2000257/en-US](http://support.microsoft.com/kb/2000257/en-US)。不过，这对于证书操作来说是很奇怪的。

[如何查看 RSA Key Container 的权限](https://stackoverflow.com/questions/7659402/how-to-view-permissions-for-rsa-key-container)可能与此处相关，因为它讨论了需要相同的权限才能访问私钥。

该帐户可能具有特权，但可能需要启用。有关示例代码，请参阅[获取/设置注册表 ACL“SeSecurityPrivilege”时的 C# Random Exception 。](https://stackoverflow.com/questions/11678810/c-sharp-random-exception-when-getting-setting-registry-acl-sesecurityprivileg)

# javascript - Google Maps Places API 地图未显示

> ID：12320841
> 
> 赞同：2
> 
> 时间：2012-09-07T15:12:04.460
> 
> 标签：javascript, google-maps-api-3, google-places-api

我刚开始使用 google maps places API，并且已经能够将这段代码组合在一起，但地图没有显示出来。我想这是某个地方的一个小错误，但我找不到它。如果有人能指出这将是一个巨大的帮助，并且是否有任何在线或任何免费的 IDE 可以很好地捕捉这样的错误？

代码：http: [//jsbin.com/ifuwel/1/edit](http://jsbin.com/ifuwel/1/edit)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:44:32.513

您有 2 个不同的 ID（“map”和“map_canvas”）。试试看：

```
map = new google.maps.Map(document.getElementById('map_canvas'), {
    mapTypeId: google.maps.MapTypeId.ROADMAP,
    center: pyrmont,
    zoom: 15
}); 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-09-07T16:05:10.450

试试这个基本的例子

HTML

```
 <body onload="initialize()">
   <div id="map_canvas"></div>
 </body> 
```

Javascript

```
 <script>
  function initialize() {
    var mapOptions = {
      zoom: 4,
      center: new google.maps.LatLng(-33, 151),
      panControl: false,
      zoomControl: false,
      scaleControl: true,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    }
    var map = new google.maps.Map(document.getElementById('map_canvas'),
                                  mapOptions);
  }
</script> 
```

CSS

```
 <style>
     html, body {
     height: 100%;
     margin: 0;
     padding: 0;
      }

     #map_canvas {
     height: 100%;
     }

     @media print {
     html, body {
     height: auto;
     }

     #map_canvas {
     height: 650px;
     }
      }
    </style> 
```

如果需要，CSS 有助于获得 100% 的宽度和高度

# asp.net - 与使用 httpS (SSL) 的 PivotViewer 的即时收集服务器代码类似的问题？

> ID：12320845
> 
> 赞同：0
> 
> 时间：2012-09-07T15:12:23.150
> 
> 标签：asp.net, silverlight, ssl, https, pivotviewer

我们正在开发一个工作中的 ASP.NET 应用程序，该应用程序使用带有 PivotViewer 的即时收集服务器代码。使用纯 http 一切正常。但是，ASP.NET 应用程序需要用户登录，这意味着如果我们使用 httpS（SSL）会更好。

我们需要在托管我们应用程序的服务器上安装 Microsoft URL Rewrite Module [http://www.iis.net/download/URLRewrite 。](http://www.iis.net/download/URLRewrite)我们还在 web.config 中添加了以下内容以使自动 80 -> 443 重定向工作

在节之后，这不能去其他任何地方，添加以下代码：

```
 <rewrite>
 <rules>
 <rule name="HTTP to HTTPS redirect" stopProcessing="true">
 <match url="(.*)" />
 <conditions>
 <add input="{HTTPS}" pattern="off" ignoreCase="true" />
 </conditions>
 <action type="Redirect" redirectType="Found" url="https://{HTTP_HOST}/{R:1}" />
 </rule>
 </rules>
 </rewrite> 
```

我们没有 Web 服务，没有 WCF 服务，没有 ASMX 服务。

但是，当我们使用 httpS (SSL) 部署应用程序时，使用 PivotViewer 的即时收集服务器代码无法显示任何内容。没有错误。它只是无法显示任何内容。

请问是否有人在使用 httpS (SSL) 的 PivotViewer 的即时收集服务器代码方面遇到过这样的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T18:09:31.610

听起来代码正在发出直接`http://<whatever>`调用，然后 IIS 将重定向到该调用，`https://<whatever>`但代码未遵循重定向。

您可能会检查您的代码以确保它正在调用`https://`版本而不是`http://`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T14:21:19.647

Pivot Viewer 显示的内容过去由使用 URL 的即时收集服务器代码引用。换句话说，如果您想要显示汽车图像 jpeg，您可以为即时收集服务器提供如下代码：

[http://something.com/ClientBin/Uploads/carimage.jpg](http://something.com/ClientBin/Uploads/carimage.jpg)

或者

[https://something.com/ClientBin/Uploads/carimage.jpg](https://something.com/ClientBin/Uploads/carimage.jpg)

问题是即时收集服务器代码无法用于 httpS (SSL) URL。

因此，我们决定为即时收集服务器代码提供绝对物理目录路径，如下所示：

C:\SomethingWebApplication\ClientBin\Uploads\carimage.jpg

使用绝对物理目录路径与 httpS (SSL) 一起使用，但使用 httpS (SSL) URL 引用失败。

# c# - 关于webapi ActionFilterAttribtes、FilterProvider、依赖注入的一些问题

> ID：12320846
> 
> 赞同：2
> 
> 时间：2012-09-07T15:12:29.247
> 
> 标签：c#, .net, asp.net-mvc, dependency-injection, asp.net-web-api

我看到默认情况下，MVC4 WebApi 项目有 2 个`IFilterProviders`：`ConfigurationFilterProvider`和`ActionDescriptorFilterProvider`. 在设置自定义`IFilterProvider`进行属性依赖注入时，首先从 Filters 集合中删除这两个是否合适？还是只删除`ActionDescriptorFilterProvider`并将 留`ConfigurationFilterProvider`在集合中更合适？

其次，我看到在`ActionFilterAttribute`为特定操作构建 WebApi Http 之后，它似乎仍然存在。例如，当我在 ApiController Get 方法上放置自定义操作过滤器时，它只会在第一次调用该方法时构建。对 api 方法的后续调用似乎重用了相同的过滤器（构造函数断点仅在第一次调用期间被命中）。这是正确的吗？为什么它与 MVC 动作过滤器不同，后者为每个方法调用创建一个新实例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T23:05:45.643

> 首先从 Filters 集合中删除这两个是否合适？

我已经成功地在动作过滤器上实现了依赖注入，而没有删除这些过滤器提供者中的任何一个。事实上，我正在`ActionDescriptorFilterProvider`使用 StructureMap 扩展我的示例。

[http://evolutionarydeveloper.blogspot.co.uk/2012/11/webapi-actionfilter-dependency.html](http://evolutionarydeveloper.blogspot.co.uk/2012/11/webapi-actionfilter-dependency.html)

恐怕我无法解释你的第二个问题:-)

# c++ - __thread 说明符在 C++ 类中不起作用

> ID：12320848
> 
> 赞同：0
> 
> 时间：2012-09-07T15:12:28.823
> 
> 标签：c++, multithreading, thread-local

我正在尝试使用 __thread 说明符来创建线程局部变量。这在以下代码中可以正常工作：

```
#include <stdio.h>
#include <pthread.h>

static __thread int val;

int main()
{
  val = 10;
} 
```

但是，如果我尝试在类中使用 __thread 说明符，如下所示：

```
#include <stdio.h>
#include <pthread.h>

class A
{
public:
  A();
  static __thread int val;
};

A::A()
{
  val = 10;
}

int main()
{
  A a;
} 
```

我得到编译器错误：未定义的对 'A::val' 的引用

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T15:15:28.600

您只声明了静态变量；您还必须在类之外定义它（如果您有多个源文件，则仅在一个源文件中）：

```
int __thread A::val; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:17:26.323

静态变量必须在类声明范围之外定义。像这样：

```
int A::val; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-18T08:37:19.357

你应该像这样定义它：

```
/\*static\*/ __thread int A::val; 
```

`__thread`关键字必须在`int`.

# python - Tornado 中的变量铸造

> ID：12320851
> 
> 赞同：0
> 
> 时间：2012-09-07T15:12:35.113
> 
> 标签：python, variables, casting, tornado

我有这些变量：

```
PERM_READ = 0x01
PERM_WRITE = 0x02
PERM_CMDS = 0x04 
```

以及检查网络或传感器权限的功能。确定用户权限的函数。

这是功能：

```
def check_network_access(self, network, access=None, raise_err=True):
    if access is None:
        access = PERM_READ
    else:
        assert(access > 0)
        assert(access <= (PERM_READ + PERM_WRITE + PERM_CMDS))
    usr = self.get_current_user()
    usr_id = usr['id']
    # Does the network exist?
    net = self.get_network(network)
    if not net:
        raise tornado.web.HTTPError(404, "not found")

    self.lock_tables('read', ['nets_permissions'])
    perms = self.db.get("SELECT * FROM nets_permissions WHERE network_id=%s AND \
                        user_id=%s", network, usr_id)
    self.unlock_tables()
    if (not perms) or ((perms['perm'] & access) != access):
        if (raise_err):
            raise tornado.web.HTTPError(403, "access forbidden")
        else: 
            return False
    return True 
```

现在，例如，当我使用此处理程序调用页面时出现错误：

```
class NetworkStatusHandler(BaseHandler):
# Requires authentication 
@tornado.web.authenticated
def get(self, nid):

    # Retrieve the current user 
    usr = self.get_current_user()
    usr_id = usr['id']

    perm = self.db.query("SELECT n.perm FROM nets_permissions as n \
                          WHERE n.network_id=%s AND n.user_id=%s", nid, int(usr_id))

    # Check whether the user has access to the network 
    perms = self.check_network_access(nid, perm)
    net = self.get_network(nid)
    # Render the networks page
    self.render("networkstatus.html", net=net) 
```

我的错误是：

```
Traceback (most recent call last):
  File "/usr/lib/python2.6/site-packages/tornado/web.py", line 988, in _execute
    getattr(self, self.request.method.lower())(*args, **kwargs)
  File "/usr/lib/python2.6/site-packages/tornado/web.py", line 1739, in wrapper
    return method(self, *args, **kwargs)
  File "./wsn.py", line 663, in get
    perms = self.check_network_access(nid, perm)
  File "./wsn.py", line 250, in check_network_access
    assert(access <= (PERM_READ + PERM_WRITE + PERM_CMDS))
AssertionError 
```

我认为这是变量 perm 的转换中的一个问题，当它被传递给 check_network_access 函数时......

感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T16:03:21.070

您需要使用`self.db.get`而不是`self.db.query`. 像下面这样的东西应该可以工作：

```
class NetworkStatusHandler(BaseHandler):
# Requires authentication 
@tornado.web.authenticated
def get(self, nid):

    # Retrieve the current user 
    usr = self.get_current_user()
    usr_id = usr['id']

    row = self.db.get("SELECT n.perm FROM nets_permissions as n \
                          WHERE n.network_id=%s AND n.user_id=%s", nid, int(usr_id))
    perm = row['n.perm']

    # Check whether the user has access to the network 
    perms = self.check_network_access(nid, perm)
    net = self.get_network(nid)
    # Render the networks page
    self.render("networkstatus.html", net=net) 
```

我希望这有帮助。

# ios - UITableViewCell 中的令牌

> ID：12320855
> 
> 赞同：2
> 
> 时间：2012-09-07T15:12:49.283
> 
> 标签：ios, uitableview, uilabel, token, core-text

我想在我的`UITableViewCell`. 如果它使用正则表达式`@`在字符串中检测到带有 a 的内容，我希望它是这样的。`cell.textLabel.text`它会自动使用如下所示的标记突出显示它。

它也应该是可点击的。

![我想创造这样的东西！](../Images/0c8d4efc518f7faff27c8dab8b26c28f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:29:44.333

使用 CoreText 确定边界框，然后在绘制单元格视图时使用该信息。

# android - 如何获取我的活动上下文？

> ID：12320857
> 
> 赞同：83
> 
> 时间：2012-09-07T15:12:49.477
> 
> 标签：android, android-context

我真的不明白整个事情是如何运作的，所以如果我有一些类`A`需要`B`扩展类的上下文`Activity`，我如何获得该上下文？

我正在寻找一种比将上下文作为参数提供给类`A`构造函数更有效的方法。例如，如果类`A`将有数百万个实例，那么我们最终将拥有数百万个冗余指针，`Context`而我们应该能够以某种方式在某个地方只有一个和一个 getter 函数......

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-09-07T15:24:09.057

好的，我将举一个小例子说明如何按照您的要求进行操作

```
public class ClassB extends Activity
{

 ClassA A1 = new ClassA(this); // for activity context

 ClassA A2 = new ClassA(getApplicationContext());  // for application context. 

} 
```

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2012-09-07T15:45:24.363

您可以使用`Application`类（android.application 包中的公共类），即：

> 需要维护全局应用程序状态的基类。您可以通过在 AndroidManifest.xml 的标记中指定其名称来提供自己的实现，这将导致在创建应用程序/包的进程时为您实例化该类。

要使用此类，请执行以下操作：

```
public class App extends Application {

    private static Context mContext;

    public static Context getContext() {
        return mContext;
    }

    public static void setContext(Context mContext) {
        this.mContext = mContext;
    }

    ...

} 
```

在您的清单中：

```
<application
        android:icon="..."
        android:label="..."
        android:name="com.example.yourmainpackagename.App" >
                       class that extends Application ^^^ 
```

在活动 B 中：

```
public class B extends Activity {

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.sampleactivitylayout);

        App.setContext(this);
                  ...
        }
...
} 
```

A类：

```
Context c = App.getContext(); 
```

**注意**：

> 通常不需要子类化 Application。在大多数情况下，静态单例可以以更模块化的方式提供相同的功能。如果您的单例需要全局上下文（例如注册广播接收器），则可以为检索它的函数提供一个 Context，该上下文在首次构建单例时在内部使用 Context.getApplicationContext()。

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2016-10-22T15:09:58.153

获取活动上下文的最佳且简单的方法是放在`.this`活动名称之后。例如：如果您的 Activity 的名称是`SecondActivity`，它的上下文将是`SecondActivity.this`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-07T15:13:51.293

您将上下文传递给 B 类的构造函数，并确保传递 getApplicationContext() 而不是 activityContext()

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-07T15:25:18.407

您可以使用类 A 的参数 Context 创建构造函数，然后可以使用此上下文。

上下文 c;

A（上下文上下文）{ this.c=context }

从 B 活动中，您使用此构造函数并传递 getApplicationContext() 创建 A 类对象。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-10-09T11:31:43.147

如果您需要 B 中 A 的上下文，则需要将其传递给 B，您可以按照其他人的建议通过将 Activity A 作为参数传递来做到这一点。我看不出有很多 A 的实例有自己的指向 B 的指针的问题，不确定这是否会是那么大的开销。

但是，如果这是问题所在，则一种可能性是将指向 A 的指针保留为类的一种全局变量`Application`，正如@hasanghaforian 所建议的那样。实际上，根据您需要上下文的用途，您甚至可以使用 the 的上下文`Application`。

我建议阅读[这篇](http://www.doubleencore.com/2013/06/context/?utm_source=Android%20Weekly&utm_campaign=78ad4cb95e-Android_Weekly_64&utm_medium=email&utm_term=0_4eb677ad19-78ad4cb95e-328260729)关于上下文的文章，以更好地弄清楚你需要什么上下文。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-05-08T12:22:08.180

在 Kotlin 中将是：

```
activity?.applicationContext?.let {
         it//<- you context
        } 
```

# git - 您如何获取 git diff 文件，并将其应用于作为同一存储库副本的本地分支？

> ID：12320863
> 
> 赞同：608
> 
> 时间：2012-09-07T15:13:23.793
> 
> 标签：git, diff, git-diff

我有一个同事创建的 .diff 文件，并且想将该 diff 文件中列出的更改应用到完全相同存储库的本地分支。我无权访问用于生成此差异文件的该工作人员的 pc 或分支。

显然，我可以逐行重新输入所有内容，但我宁愿不要让系统出现人为错误。最简单的方法是什么？

* * *

## 回答 #1

> 赞同：911
> 
> 时间：2012-09-07T15:17:46.197

将 diff 文件复制到存储库的根目录，然后执行以下操作：

```
git apply yourcoworkers.diff 
```

有关该`apply`命令的更多信息，请参[见其手册页](http://www.kernel.org/pub/software/scm/git/docs/git-apply.html)。

顺便说一句：通过文件交换整个提交的更好方法是组合`git format-patch`发送方和`git am`接收方的命令，因为它还传输作者信息和提交消息。

如果补丁应用程序失败并且生成差异的提交实际上在您的存储库中，您可以使用该`-3`选项`apply`尝试合并更改。

它也适用于 Unix 管道，如下所示：

```
git diff d892531 815a3b5 | git apply 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2021-02-04T08:29:55.283

看来您也可以使用 patch 命令。将差异放在存储库的根目录中并从命令行运行`patch`。

```
patch -i yourcoworkers.diff 
```

或者

```
patch -p0 -i yourcoworkers.diff 
```

如果他们在不使用`--no-prefix`.

如果是这样，那么您可以使用以下方法删除文件夹中不适用的部分：

```
patch -p1 -i yourcoworkers.diff 
```

-p(n) 表示要删除文件夹结构的多少部分。

[有关在此处](https://medium.com/odds-team/create-a-patch-file-from-git-diff-c746be60d1e)创建和应用补丁的更多信息。

你也可以使用

```
git apply yourcoworkers.diff --stat 
```

查看默认情况下差异是否会应用任何更改。如果补丁未正确应用（不同的文件夹结构），它可能会说 0 个文件受到影响。

# php - 需要为链接解析 HTML 文档——使用 html5lib 之类的库或其他库？

> ID：12320872
> 
> 赞同：0
> 
> 时间：2012-09-07T15:14:01.953
> 
> 标签：php, html-parsing, html5lib

我是一个非常新手的网页构建器，目前正在创建一个需要根据目标页面更改链接颜色的网站。链接将根据某些用户输入标准分类为不同的类别（例如好、坏、中性）——例如，用户感兴趣的内容链接为蓝色，用户（可能）不想看到的内容被着色为普通文本等。

我认为我需要一种方法来解析网页的内容链接（存储在 MySQL 数据库中），更改页面上所有链接的颜色（因此我还需要能够更改 HTML 中的链接类）在将调整后的页面输出给用户之前。我读到正则表达式不是找到这些链接的好方法——所以我应该使用一个库，如果是这样，html5lib 对我正在做的事情有好处吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:31:15.927

没有必要让 PHP HTML 解析器复杂化，它会破坏并强制“修复”您的输入 HTML。

以下是如何将 PHP 与 javascript 结合使用，完整的工作和经过测试的解决方案：

```
<?php
$arrBadLinks=array(
    "http://localhost/something.png",
    "https://www.apple.com/something.png",
);
$arrNeutralLinks=array(
    "http://www.microsoft.com/index.aspx",
    "ftp://samewebsiteasyours.com",
    "ftp://samewebsiteasyours.net/file.txt",
);
?>
<html>
    <head>
        <script>
        function colorizeLinks()
        {
            var arrBadLinks=<?php echo json_encode($arrBadLinks);?>;
            var arrNeutralLinks=<?php echo json_encode($arrNeutralLinks);?>;

            var nodeList=document.getElementsByTagName("*");
            for(var n=nodeList.length-1; n>0; n--)
            {
                var el=nodeList[n];

                if(el.nodeName=="A")
                {
                    if(arrBadLinks.indexOf(el.href)>-1)
                        el.style.color="red";
                    else if(arrNeutralLinks.indexOf(el.href)>-1)
                        el.style.color="green";
                    else
                        el.style.color="blue";
                }
            }
        }

        if(window.addEventListener)
            window.addEventListener("load", colorizeLinks, false);
        else if (window.attachEvent)
            window.attachEvent("onload", colorizeLinks);
        </script>
    </head>
    <body>
        <p>
            <a href="http://www.microsoft.com/index.aspx">Neutral www.microsoft.com/index.aspx</a>
        </p>
        <p>
            <a href="http://localhost/something.png">Bad http://localhost/something.png</a>
        </p>
    </body>
</html> 
```

不适用于相对 URL，请确保将它们设为绝对，否则比较将失败（或更新代码以填写现有相对 URL 的[http://current-domain.xxx](http://current-domain.xxx)）。

# php - SugarCRM 如何填充下拉列表

> ID：12320875
> 
> 赞同：1
> 
> 时间：2012-09-07T15:14:06.513
> 
> 标签：php, sugarcrm

我正在使用 SugarCRM v6.5，我非常新手。在线索中，我想在地址类型中添加一个字段来指示地址的类型（即办公室、家庭……）。因此，在工作室中，我将这个字段“type_address”创建为一个简单的下拉列表（不知道英语中的术语，在法语中它是“liste à choix simple”），并且我指出了用于填充它的选项。到目前为止，没关系，如果我在表单上显示它，它会正确填充。但我想在地址字段中添加它，所以我打开了 include\SugarFields\Fields\Address\fr_FR.EditView.tpl 并添加了这样的一行：

```
<tr style="background-color: yellowgreen;">
<td valign="top" width='25%' scope='row' ><label for="{{$typeaddr}}">{sugar_translate label='LBL_{{$key}}_ADRESS_TYPE' module='{{$module}}'}:</label>
{if $fields.{{$typeaddr}}.required || {{if $typeaddr|lower|in_array:$displayParams.required}}true{{else}}false{{/if}}}
<span class="required">{$APP.LBL_REQUIRED_SYMBOL}</span>
{/if}
</td>
<td>
<select name="{{$typeaddr}}" id="{{$typeaddr}}" title=''  >
   {html_options options=$fields.{{$typeaddr}}.options }
</select>
</td>
</tr> 
```

在模板的顶部我放了：

```
{{assign var="typeaddr" value=$displayParams.key|cat:'_adress_type_c'}} 
```

该行显示，标签是好的，但下拉列表不填充。我试图在 \custom\Extension\modules\Leads\Ext\Vardefs\sugarfields_primary_adress_type_c.php 中指示选项列表，如下所示：

```
$dictionary['Lead']['fields']['primary_adress_type_c']['type'] = 'base';
$dictionary['Lead']['fields']['primary_adress_type_c']['options'] = 'list_name_as_created_in_studio'; 
```

我也试着把它放在 \custom\modules\Leads\metadata\editviewdefs.php

```
0 => 
      array (
        'name' => 'primary_adress_type_c',
        'studio' => 'visible',
        'label' => 'LBL_PRIMARY_ADRESS_TYPE',
        'type' => 'base',
        'options' => list_name_as_created_in_studio',
      ), 
```

我尝试了枚举和基础。诀窍是，即使我输入了“枚举”和一系列选项，它也不会填充。

我看不出我可以在哪里干预以使其正常工作，我肯定忘了做点什么。

欢迎任何帮助，甚至是手册的链接（我阅读了它并没有找到任何帮助，但我可能会错过一些东西）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T02:18:56.883

在文件`include\SugarFields\Fields\Address\fr_FR.EditView.tpl`中，替换：

```
<select name="{{$typeaddr}}" id="{{$typeaddr}}" title=''  >
   {html_options options=$fields.{{$typeaddr}}.options }
</select> 
```

和：

```
{html_options name=primary_adress_type_c options=$primary_adress_type_c_options selected=$fields.primary_adress_type_c.value} 
```

创建一个`custom/modules/Leads/views/view.edit.php`包含内容的新文件

```
<?php
require_once('include/MVC/View/views/view.edit.php');
class LeadsViewEdit extends ViewEdit{

    public function LeadsViewEdit(){
        parent::ViewEdit();
    }

  public function preDisplay() {
    parent::preDisplay();
    $this->ss->assign('primary_adress_type_c_options', $GLOBALS['app_list_strings']['list_name_as_created_in_studio']);
  }

    public function display(){
        parent::display();
    }
}
?> 
```

# c# - MVC Razor 需要在每个视图之间传递一个 guid

> ID：12320877
> 
> 赞同：1
> 
> 时间：2012-09-07T15:14:11.133
> 
> 标签：c#, asp.net-mvc, razor, membership-provider

我有一个将当前客户与他们正在登录的公司联系起来的指南。

在每个视图之间传递一致且易于在控制器上检索的信息的最佳方式是什么？我只需要在控制器上使用它，因为我将它与每个查询一起传递给我的服务。

我认为在登录时通过 cookie 存储它，但我不确定。

我正在使用 SqlMembershipProvider，我可以将它存储在该类中吗？

任何投入将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:24:16.223

如果您在正常页面查看期间需要 GUID，请使用 session；这使 cookie 有效负载更轻一些。我通常在内存中保留当前用户的轻量级表示，例如用户 ID、公司 ID 等。

如果您希望 GUID 用于异步操作（例如从页面中的小部件到 WCF 端点的 JavaScript 调用），请考虑使用 cookie 而不是会话。[这将避免串行会话访问](http://msdn.microsoft.com/en-us/library/ms178581%28v=vs.100%29.aspx)的阻塞问题（请参阅“并发请求和会话状态”）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-20T19:23:50.693

我带着这个答案去了：

[MVC 处理站点的 CorpId](https://stackoverflow.com/questions/12354821/mvc-handling-a-corpid-for-the-site)

我问得更好，更详细。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T15:17:46.870

一种方法是使用配置文件功能并为用户创建配置文件。 [这个 stackoverflow 问题](https://stackoverflow.com/questions/2547290/using-asp-net-membership-and-profile-with-mvc-how-can-i-create-a-user-and-set)将解释如何在 MVC 中使用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T15:19:31.127

要存储用户相关信息，请考虑使用 Session 变量...

```
HttpContext.Current.Session 
```

# c# - 如何知道 PropertyInfo 是否为 MEF 导入

> ID：12320879
> 
> 赞同：0
> 
> 时间：2012-09-07T15:14:27.627
> 
> 标签：c#, reflection, mef, propertyinfo

`MyProperty`假设我有一个由 MEF 组成的类如下：

```
class Foo
{
    [Import]
    public Bar MyProperty { get; set; }
} 
```

在使用反射检查此程序集时，是否可以确定该属性是否由 MEF 导入？我注意到课堂上有一个`Attributes`属性，`PropertyInfo`但它是空的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:16:03.820

您应该改用该`GetCustomAttributes()`方法。

# asp.net - 从 GridView 中的文本框存储数据

> ID：12320880
> 
> 赞同：0
> 
> 时间：2012-09-07T15:14:28.990
> 
> 标签：asp.net

这段代码`TextBox tx1 = (TextBox)GridView1.Rows[e.RowIndex].FindControl("TextBox1");`

我知道它从 GridView 中的 textbox1 获取数据，并存储在 Textbox 类型中。我还必须使用上面的代码存储哪些其他选项，例如我可以将它存储在 DateTime 类型中吗？

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:25:47.360

本文介绍了如何使用代码将值存储在数据库中：

```
sqlcon = new SqlConnection(con);
   sqlcon.Open();
   string sql = "update employee set emp_name='" + 
    tx1.Text + "',emp_address='" + tx2.Text + "',salary='" +
    tx3.Text + "',department='" + ddl.SelectedValue.ToString() 
    + "',maritalstatus='" + rbl.SelectedValue.ToString() + "',Active_status='" 
        + chb.SelectedValue.ToString() + "' where emp_id='" +
   lb.Text + "'";
SqlCommand cmd = new SqlCommand(sql);
   cmd.CommandType = CommandType.Text;
   cmd.Connection = sqlcon;
   cmd.ExecuteNonQuery ();
   GridView1.EditIndex = -1;
   showgrid (); 
```

在受保护的 void GridView1_RowUpdating（对象发送者，GridViewUpdateEventArgs e）

您想将值存储在数据库中吗？

# c++ - 语义冲突将指针传递给 const 指针到字节数组

> ID：12320881
> 
> 赞同：2
> 
> 时间：2012-09-07T15:14:31.730
> 
> 标签：c++, const-cast

我想从下面用原型定义的 OpenSSL 库中调用这个函数：

```
X509 *d2i_X509(X509 **px, const unsigned char **in, int len); 
```

第二个参数`in`定义为a `const unsigned char **`，因为：

*   d2i_X509 不会修改指向的缓冲区中的数据`*in`
*   `*in`将从缓冲区解析的数据量增加。

现在这个原型是一个问题，因为据我所知，该函数不能以以下方式调用，据我所知，API 是调用它的正常方式（删除了错误管理代码以使事情变得更简单）：

```
unsigned char buffer[2048];
unsigned char * end = buffer;
unsigned char * p = buffer;

end += read(fd, p, 2048);
certlen1 = parseint(&p);
X509 * cert1 = d2i_x509(NULL, &p, certlen1);
certlen2 = parseint(&p);
X509 * cert2 = d2i_x509(NULL, &p, certlen2); 
```

如果我尝试编译上面的代码，它会说：

```
error: invalid conversion from 'unsigned char**' to 'const unsigned char**' 
```

我理解消息的基本原理（例如[在此处](https://stackoverflow.com/questions/11514688/passing-const-pointer-by-reference)解释），但在这种特殊情况下，此基本原理并不适用，因为函数在其文档中声明它只会增加 的值`*in`，而不会为其分配不相关的指针。

我无法将 p 的类型更改为，`const unsigned char *`因为上面的代码实际上是简化的，指针隐藏在一些执行读取和写入的抽象 IO 对象后面。前一个 IO 对象的好处是保持对称读写代码在一起，可以在我的 IO 对象中使用两个单独的指针进行读写，但这样做的总体好处非常小（如果不是负面的话）并添加很多语法噪音。由一些外部无关的 API 调用强制在 IO 对象中进行那种深度的内部变化，看起来真的很牵强。

一个解决方案可能是执行强制转换，甚至根本不使用返回的指针值（因为我有 size 参数），但感觉也不对。在这种情况下，似乎 d2i_X509 的原型没有包含足够的信息，或者编译器的 const 检查规则过于严格。

应该如何从 C++ 调用这样的 API？现在我只会使用演员表，因为我觉得它是较小的邪恶，但有没有更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:47:17.677

首先，`+=`这段代码中的 没有多大意义：

```
p += read(fd, p, 2048); 
```

您正在修改`p`以指向*刚刚*读取的数据，因此`d2i_x509`将读取垃圾。

我会这样做：

```
unsigned char buffer[2048];
int n = read(fd, buffer, 2048);
if (n < 0) ..error..;
const unsigned char * p = buffer;
X509 * cert1 = d2i_x509(NULL, &p, certlen1);
X509 * cert2 = d2i_x509(NULL, &p, certlen2);
int used = p - buffer;  // # of bytes actually parsed by the two calls 
```

未来的任何更改都可以`buffer`直接进行。

**编辑：**

好的，然后替换这个：

```
X509 * cert1 = d2i_x509(NULL, &p, certlen1); 
```

有了这个：

```
{
  const unsigned char *q = p;
  X509 * cert1 = d2i_x509(NULL, &q, certlen1);
  p += q - p;
} 
```

# ruby-on-rails - 联合两个mongo结果

> ID：12320884
> 
> 赞同：3
> 
> 时间：2012-09-07T15:14:36.823
> 
> 标签：ruby-on-rails, ruby, mongodb, sinatra, kaminari

我有一种情况，我需要从 mongo 返回一个对象集合，但需要使用两个查询来获取结果。这些结果的顺序很重要，因为它们是分页的。

这是第一个查询：（基于类别和价格范围的列表）

```
my_listings = MoListing.where(criteria_a) 
```

第二个查询需要使用第一个查询的结果作为过滤器。所以像：

```
everything_else = MoListing.where(criteria_b) 
```

然后合并结果：

```
my_listings << everything_else 
```

最后，返回分页结果：

```
my_listings.page(1).per(25) 
```

似乎我的部分问题是 mongo 查询在需要之前不会执行。有没有办法让我在给定点触发查询的执行？或者在构建这个结果集时我应该采取另一种方法吗？

**更新更多信息**

我看到的行为是返回的只是`listings`. 我还确认`everything_else`确实包含预期的记录（my_listings 中有 48 条记录，everything_else 中有 52 条记录）。

`.all`如评论中提到的那样应用我的查询时，不会产生任何影响。`puts listings.inspect`结果在

```
10:57:00 web.1   |    #<Mongoid::Criteria
10:57:00 web.1   |    selector: {"price"=>{"$gte"=>25, "$lte"=>75}},
10:57:00 web.1   |    options:  {},
10:57:00 web.1   |    class:    MoListing,
10:57:00 web.1   |    embedded: false> 
```

但是，`listings.count`确实会导致`48`. 我只是错过了一些合并这些结果的愚蠢简单方法吗？一旦我在一个集合中得到结果，这将如何影响随后的分页功能。我`kaminari`用于分页。

**更新 2**

根据下面的答案和我自己的反复试验，我发现 to_a 是一个解决方案，但不是一个理想的解决方案。这确实起作用：

```
#merge the results together as an Array
results = (listings.to_a | everything_else.to_a) 
```

这导致通过 Kaminari 的分页必须更改，因为我们不再使用 mongo 标准，而是使用标准数组。这是新的分页方法：

```
Kaminari.paginate_array(results).page(page).per(per_page) 
```

使用包含 100 条记录的小型数据集，这很好而且花花公子 - 54 毫秒

```
"debug":{"success":true,"pre_render_duration":54.808775999999995,"overall_duration":86.36554100000001,"count":25},"pagination":{"total_pages":4,"current_page":1}} 
```

但是，使用更大的数据集时，使用 .to_a 方法组合这些数据时，我发现时间明显变慢。尽管这些示例并不完全是苹果对苹果，但如此大的差异表明 to_a 返回所有内容的问题，迫使 Kaminari 使用更多的实际数据：

我没有 to_a 的结果，只返回应用了标准的所有记录 - 15ms

```
"debug":{"success":true,"pre_render_duration":15.107164,"overall_duration":18.267599,"count":25},"pagination":{"total_pages":81,"current_page":1}} 
```

我的结果与 to_a，合并两个结果集 - 415ms

```
"debug":{"success":true,"pre_render_duration":415.258199,"overall_duration":450.66537800000003,"count":25},"pagination":{"total_pages":81,"current_page":1}} 
```

总而言之，这不是一个有效的选择。即使使用大型数据集，单独返回每个数据集也需要 <15ms，所以我认为我需要完成的是一种将条件合并在一起的方法，以便针对 Mongo 运行单个查询，从而允许在 db 上发生分页，它应该是。

在 SQL 中，我会做一些大致类似的事情

```
select
  *
from
  listings
where
  field = "blah"
union all
select
  *
from
  listings
where
  field <> "blah" 
```

是否可以在 Mongo 中执行此操作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T17:32:57.143

也许您可以创建一个类来封装有关如何为该特定数组检索数据的详细信息，并且通过使用 Mongo 驱动程序，您可以跳过和限制查询选项以减少传输的数据大小。

使用这种方法，你可以使用这样的东西（命名不是很好，我没有测试代码，但你会明白这一点）：

```
class MoListingDataRetriever
  def initialize(page_size)
    @page_size = page_size / 2 #since you'll have two queries
    driver_instance = MoListing.db #just an exemple. You could use any of your classes that are mongo documents to do this
    @collection_driver = driver_instance.collection("mo_listing") #or whatever you collection name is on mongo
  end

  def retrieve_mo_listings(query_param_a, query_param_b, current_page)
    query_options = {
      limit: @page_size,
      page: current_page,
      skip: (@page_size * (current_page - 1)) #to skip a number of records already retrieved from the query
    }
    results_from_query_a = @driver_instance.find(query_param_a, query_options)
    results_from_query_b = @driver_instance.find(query_param_a, query_options)
    results_from_query_b.to_a.concat(results_from_query_b.to_a)    
  end
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-10T22:28:36.123

不过，这可能是一种粗略的方法：

```
# Let us say the listings is obtained using listing_query_params
listings = MoListing.where(listing_query_params)

# and everything else is from everything_else_query_params
everything_else = MoListing.where(everything_else_query_params)

results = [listings.to_a, everything_else.to_a].flatten

results.page(1).per(25) 
```

这是你想要的吗？我已经在我的一个 mongoid 模型上尝试过它，并且似乎以这种方式工作。

PS：但是 .to_a 对性能有影响 - 整个结果集都被提取和合并。但是看看你提到的记录数量（约 50 条），应该没问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-15T12:52:14.957

试试这个：

```
my_listings = MoListing.where(criteria_a)
everything_else = MoListing.where(criteria_b)
all_listings = MoListing.or(my_listings.selector).or(everything_else.selector).page(1).per(25) 
```

# macos - 应用程序窗口标题栏背景图像

> ID：12320886
> 
> 赞同：1
> 
> 时间：2012-09-07T15:14:42.843
> 
> 标签：macos, cocoa

有没有办法为Mac OS X 应用程序的[应用程序窗口标题栏设置背景图像？](http://developer.apple.com/library/mac/#documentation/userexperience/conceptual/applehiguidelines/Windows/Windows.html#//apple_ref/doc/uid/20000961-TP9)一个例子是在笔记和日历应用程序顶部发现的棕色条。![在此处输入图像描述](../Images/2e91f298bbd7f2e3748d8ccdf58c81b0.png)

我正在从 iOS 过渡到 Mac OS，并希望获得相当于：

```
[[UINavigationBar appearance] setBackgroundImage:[UIImage imageNamed:@"Toolbar_bg_norm~iphone.png"] forBarMetrics:UIBarMetricsDefault]; 
```

我翻遍了文档无济于事。我看到之前有人问过[一个关于标题栏颜色的问题](https://stackoverflow.com/questions/2798605/change-color-of-title-bar-in-cocoa)，但它已经有几年了。我希望从那以后有一个更新，这使得它更容易访问。

感谢您的任何见解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T08:06:04.883

我不知道像 iOS 上的任何开箱即用的方法。但是，您可以查看非常流行的[INAppStoreWindow](https://github.com/indragiek/INAppStoreWindow)（您可以调整标题栏的高度以防万一）。有了它，您可以轻松地提供将在标题栏中使用的 NSView，或者您可以提供自己的[绘图代码](https://github.com/indragiek/INAppStoreWindow#using-your-own-drawing-code)来绘制您想要的图像。

# javascript - 用于显示数据库数据的 AJAX

> ID：12320887
> 
> 赞同：0
> 
> 时间：2012-09-07T15:14:52.613
> 
> 标签：javascript, php, ajax, database

我目前正在设计一个允许我进行监控的 PHP 脚本/AJAX，实际上我想在我的 Intranet 上检索当天​​已存储在数据库中的操作列表。所以我提出了一个请求，我尝试异步查看成员，但它不起作用。

事实上，我想显示成员以进行测试，并在适应恢复今天的行动议程后异步（无需重新加载），因为我必须能够实时观察记录的数据。

所以我做了这个代码：

在 script.js 的标题中，我放了这个：

```
function writeInDiv(text){
    var objet = document.getElementById('monitoring');
    objet.innerHTML = text;
}

function ajax()
{
    var xhr=null;

    if (window.XMLHttpRequest) {
        xhr = new XMLHttpRequest();
    }
    else if (window.ActiveXObject)
    {
        xhr = new ActiveXObject("Microsoft.XMLHTTP");
    }
    xhr.open("GET", "ajax.php", false);
    xhr.send(null);
    writeInDiv(xhr.responseText);
        setInterval("ajax()",5000);
} 
```

然后我有另外两个页面，即显示代码，它包含以下内容：

```
<button onclick='javascript:ajax()'>Afficher</button>
                <div id="monitoring"></div>

<?php

$requette = mysql_query("SELECT * FROM gestionnaire ORDER BY ID DESC LIMIT 0,10");
$result=mysql_query($requette) or die;
While($donne = mysql_fetch_array($requette))
{
$message = htmlentities($donne['nom']);
$pseudo = htmlentities($donne['prenom']);
?>
<b><?php var_dump($donnee); echo $pseudo; ?>:</b> <?php echo $message; ?><br />
<?php
}
?> 
```

问题是什么都没有出现我什至没有错误消息，虽然表中充满了我尝试过的这些字段，`var_dump`但在这种情况下，它什么都没有。

我不知道，或者它可能来自。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T16:03:53.547

Ajax 调用是异步的，可能在您将 responseText 传递给 writeInDiv 时调用尚未完成。尝试以下操作：

```
function writeInDiv(text){
    var objet = document.getElementById('monitoring');
    objet.innerHTML = text;
}

function ajax()
{
    var xhr=null;

    if (window.XMLHttpRequest) {
        xhr = new XMLHttpRequest();
    }
    else if (window.ActiveXObject)
    {
        xhr = new ActiveXObject("Microsoft.XMLHTTP");
    }
    xhr.open("GET", "ajax.php", false);
    xhr.send(null);
    xhr.onreadystatechange=function()
    {
        if (xhr.readyState==4 && xhr.status==200)
        {
             writeInDiv(xhr.responseText);
        }
    }
    setTimeout("ajax()",5000);
} 
```

或使用 jQuery：

```
function ajax() {
    $('#monitoring').load('ajax.php');
    setTimeout("ajax()",5000);
} 
```

另外，我想你`var_dump($donnee);`可能拼错了`var_dump($donne);`

# facebook-graph-api - Facebook-lint-error“无法从 URL 检索数据”

> ID：12320890
> 
> 赞同：0
> 
> 时间：2012-09-07T15:15:10.553
> 
> 标签：facebook-graph-api

我在我的网站上使用 OpenGraph 时遇到问题（当我共享下面列出的 URL 时，我没有得到图像或内容）。当我使用调试器测试[我的 URL](https://developers.facebook.com/tools/debug/og/object?q=http://www.plus-wuustwezel.be)时，我得到了著名的`Could not retrieve data from URL`-error。

我一直在互联网上寻找解决方案，可能的原因可能是代码损坏（根据验证器无效）或缺少`meta`-tags。
我已经修复了所有错误，但 Facebook 调试器仍然无法从 URL 获取数据。

所以也许，这与我的网站结构有关。我有一个`index.php`-file 和一个`content`包含所有内容的目录：

```
<div class="content_container">
    <?php
        // Include the page content
        include_once('content/' . $_PAGE . '.php');
    ?>
</div> 
```

所以我的网址看起来像`www.mysite.com/index.php?page=news&article=12`
这与我的问题有什么关系吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:44:45.497

您的[字符编码字符串不正确](http://validator.w3.org/check?uri=http%3A%2F%2Fwww.plus-wuustwezel.be%2F&charset=%28detect+automatically%29&doctype=Inline&group=0#fatal-errors)。

在生成的源代码的第 6 行在“ISO”和“8”之间添加一个破折号：

```
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T09:40:18.020

当我在 Facebook 中更改应用程序设置时出现此错误，我想我没有刷新我正在开发的页面。如果其他人在更改应用程序设置后收到此错误，只需尝试刷新浏览器并重试。也许这些更改在整个 Facebook 中传播只是需要时间，在出现没有代码更改的错误之后，这个问题不再出现在我身上。

# c# - Task.WaitAll - 不等待？

> ID：12320894
> 
> 赞同：4
> 
> 时间：2012-09-07T15:15:26.790
> 
> 标签：c#, multithreading, parallel-processing, task-parallel-library

我试图在任务并行库中了解 Task.WaitAll(..)。

我正在使用以下代码运行测试以尝试模拟两个任务，一个将运行比指定的等待时间长（10 秒）的时间（10 秒），另一个比指定的运行时间短（3 秒）等待的时间量。指定的时间量是 5 秒。我使用的代码如下：

```
Task<int>[] tasks = new Task<int>[]
{
    Task.Factory.StartNew<int>(()=>
        {
            Thread.Sleep(10000);
            return 1;
        }),
    Task.Factory.StartNew<int>(()=>
        {
            Thread.Sleep(3000);
            return 2;
        })
};

TimeSpan timeSpan = new TimeSpan(0, 0, 5);
Task.WaitAll(tasks,timeSpan);

int[] results = new int[tasks.Length];
for(int i = 0; i < tasks.Length;i++)
{
    Console.WriteLine(tasks[i].Result);
} 
```

至于timeSpan，我也试过直接传入5000而不是timeSpan变量，但它不起作用。我得到以下输出：

```
1
2 
```

我希望只得到以下输出，因为另一个线程的执行时间比预期的等待时间长。

```
1 
```

我误解了这一点，还是做错了这个测试？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-07T15:39:19.930

虽然 Task.Delay 是您通常想要使用的（因此您不会在睡眠期间浪费线程），但您的问题实际上与此无关。

这里发生的情况是，当您打印出结果时，您正在访问每个任务的 Result 属性。这会*阻止*任务完成，因此您在 WaitAll 中等待 5 秒，然后在打印出 10 秒任务的结果时再等待 5 秒。

根据您声明的意图，您需要在访问 Result 之前检查任务状态，因为您的意图不是阻止它，而只是在它碰巧已经完成时打印出来：

```
int[] results = new int[tasks.Length];
for (int i = 0; i < tasks.Length; i++)
{
    if (tasks[i].IsCompleted)
    {
        Console.WriteLine(tasks[i].Result);
    }
} 
```

顺便说一句，您可以通过添加一些简单的时间检查（例如，使用秒表，像这样）来证明“结果块”是原始代码中发生的事情

```
Task<int>[] tasks = new Task<int>[]
{
    Task.Factory.StartNew<int>(()=>
        {
            Thread.Sleep(10000);
            return 1;
        }),
    Task.Factory.StartNew<int>(()=>
        {
            Thread.Sleep(3000);
            return 2;
        })
};

TimeSpan timeSpan = new TimeSpan(0, 0, 5);
var stopwatch = Stopwatch.StartNew();
Task.WaitAll(tasks, timeSpan);
Console.WriteLine("WaitAll took {0} seconds", stopwatch.Elapsed.TotalSeconds);

int[] results = new int[tasks.Length];
for (int i = 0; i < tasks.Length; i++)
{
    stopwatch = Stopwatch.StartNew();
    Console.WriteLine(tasks[i].Result);
    Console.WriteLine("Printing result took {0} seconds", stopwatch.Elapsed.TotalSeconds);
} 
```

这会产生以下控制台输出：

```
WaitAll took 4.9996961 seconds
1
Printing result took 5.0050012 seconds
2
Printing result took 0.0004338 seconds 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T15:17:43.557

不要在任务中使用 Thread.Sleep。`Task`调度程序不保证每个任务一个线程，并且睡眠可能会影响其他任务（请参阅任务[忽略 Thread.Sleep](https://stackoverflow.com/questions/4050538/task-is-ignoring-thread-sleep)）。请改用[Task.Delay()](http://msdn.microsoft.com/en-us/library/hh160377)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T15:21:29.573

尝试将您的时间跨度转换为

```
TimeSpan span = new TimeSpan(0, 0, 0, 10, 0);
//TimeSpan(Days, hours, minutes, seconds, milliseconds); 
```

# python - 将配对值的元组（或列表列表）拆分为独立的完整集？

> ID：12320902
> 
> 赞同：5
> 
> 时间：2012-09-07T15:15:37.587
> 
> 标签：python, algorithm, graph-algorithm, bioinformatics

我在 csv 文件中有配对值。成对的值都不一定是唯一的。我想将这个大列表拆分成独立的完整集以供进一步分析。

为了说明，我的“megalist”就像：

```
megalist = [['a', 'b'], ['a', 'd'], ['b', 'd'],['b', 'f'], ['r', 's'], ['t', 'r']...] 
```

最重要的是，输出将保留配对值列表（即，不合并值）。理想情况下，输出最终会产生不同的 csv 文件，供以后单独分析。例如，这个超级巨星将是：

```
completeset1 = [['a', 'b'], ['a', 'd'], ['b', 'd'], ['b', 'f']]
completeset2 = [['r', 's'], ['t', 'r']]
... 
```

在图论上下文中，我试图获取互斥子图的巨大图（其中配对值是连接的顶点）并将它们拆分为更易于管理的独立图。感谢您的任何意见！

编辑1：这让我处于一个可以前进的地方。再次感谢！

```
import sys, csv
import networkx as nx

megalist = csv.reader(open('megalistfile.csv'), delimiter = '\t')

G = nx.Graph()
G.add_edges_from(megalist)

subgraphs = nx.connected_components(G)

output_file = open('subgraphs.txt','w')

for subgraph in subgraphs:
     output_line = str(G.edges(subgraph)) + '\n'
     output_file.write(output_line)

output_file.close() 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T15:21:47.473

您可以为此使用[networkx](http://networkx.lanl.gov/)。构造图：

```
>>> import networkx as nx
>>> megalist = [['a', 'b'], ['a', 'd'], ['b', 'd'],['b', 'f'], ['r', 's'], ['t', 'r']]
>>> G = nx.Graph()
>>> G.add_edges_from(megalist) 
```

然后获取 subgrahs 列表：

```
>>> subgraphs = nx.connected_components(G)
>>> subgraphs
[['a', 'b', 'd', 'f'], ['s', 'r', 't']]
>>> [G.edges(subgraph) for subgraph in subgraphs]
[[('a', 'b'), ('a', 'd'), ('b', 'd'), ('b', 'f')], [('s', 'r'), ('r', 't')]] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:04:24.957

非常简单的算法与计数器[http://docs.python.org/library/collections.html#collections.Counter](http://docs.python.org/library/collections.html#collections.Counter)

```
from collections import Counter

megalist = [['a', 'b'], ['a', 'd'], ['b', 'd'],['b', 'f'], ['r', 's'], ['t', 'r']]

result = []
for l in megalist:
    cl = Counter(l)
    if not result:
        result.append([l])
    else:
        add = False
        for result_item in result:
            add = bool(filter(lambda e: bool(cl & Counter(e)) , result_item))

            if add and l not in result_item:
                result_item.append(l)
                break                    

        if not add:
            result.append([l])

print result

[[['a', 'b'], ['a', 'd'], ['b', 'd'], ['b', 'f']], [['r', 's'], ['t', 'r']]] 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-09-07T15:21:26.973

您可以使用切片手动定义子列表：

```
completeset1=megalist[0:4]
completeset2=megalist[4:] 
```

但是，听起来您确实想应用一些更深层次的逻辑，或使用额外的数据，以根据某些条件自动创建这些段。如果不了解您想要应用的逻辑，很难给出建议。

编辑：对问题的评论可能是很好的指示。

# scala - Scala 中的哪些类型实现了 flatMap？

> ID：12320903
> 
> 赞同：2
> 
> 时间：2012-09-07T15:15:37.690
> 
> 标签：scala, functional-programming

核心 scala 库中的哪些类型实现了 flatMap？我在 Option 和 collections 中看到过它。任何其他？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T15:33:16.957

简而言之：所有类型都是一元的。

`flatMap`是一种常见的操作，有很多类型可以实现它。实现它的主要有两种类型：容器和对排序有用的类型。一些类型的小概述：

第一类包含

*   像`List`,`Seq`或`Set`(定义为[GenTraversableOnce](https://github.com/scala/scala/blob/v2.9.2/src/library/scala/collection/GenTraversableLike.scala#L213)`Map` )这样的集合`flatMap`
*   容器类型，如[Option](http://www.scala-lang.org/api/current/index.html#scala.Option)、[Either](http://www.scala-lang.org/api/current/index.html#scala.Either)（或更好的 Left- 和 RightProjection ）、[Try](http://www.scala-lang.org/api/milestone/index.html#scala.util.Try) (2.10)、[Future](http://www.scala-lang.org/api/milestone/index.html#scala.concurrent.Future) (2.10)

第二类包含

*   [解析器](http://www.scala-lang.org/api/current/index.html#scala.util.parsing.combinator.Parsers$Parser)（解析器组合器）

找出所有调用的方法名称的一个有用方法`flatMap`是打开[Scaladoc on letter`F`](http://www.scala-lang.org/api/current/index.html#index.index-f)（在搜索栏下方）。然后用你的浏览器搜索`flatMap`，你会找到所有包含该方法的类型。

# assembly - 组装：系统时间打印

> ID：12320905
> 
> 赞同：0
> 
> 时间：2012-09-07T15:15:40.187
> 
> 标签：assembly, time, x86

我需要获取系统时间并打印出来。问题是我不知道如何打印它。我下面有一个代码，我不知道我错在哪里。下面只写了时间的小时部分。谢谢！:)

```
pc macro a    
mov ah, 02    
mov dl, a    
int 21h    
endm

cseg segment para 'code'    
assume cs:cseg; ds:cseg; ss:cseg; es:cseg    
org 100h

start: jmp begin
hr db '0'
begin:
mov ax, 03h     ;clear screen
int 10h

mov ah, 2Ch
int 21h
mov hr1, ch
mov bx, 10
mov ah, 0   
mov al, hr1
idiv bx
add al, '0'
add ah, '0'
mov hr, al
pc hr
mov hr, ah
pc hr

int 20h
cseg ends    
end start 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T17:15:27.453

你只有在那里打印小时的代码。“idiv bx”没有按照评论所说的那样做 - 尝试“idiv bl”。你的宏在“在你背后”破坏啊。修复这些并再试一次......

最好的，弗兰克

# c# - GroupBox 控件中的选项卡索引

> ID：12320906
> 
> 赞同：2
> 
> 时间：2012-09-07T15:15:49.440
> 
> 标签：c#, winforms

我有一个 groupBox，我在其中放了三个 RadioButtons 和一个 TextBox。他们的选项卡索引就像 5,6,7,8 开始表单单选按钮并在文本框中结束，但在我的表单中，当我选项卡时，它转到单选按钮，它的单选按钮被选中，而下一个选项卡则没有转到下一个单选按钮，但它转到该文本框。所以我想知道这是它应该如何工作的正常行为还是我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T15:29:11.980

这是在某些面板中组合在一起的单选按钮的标准行为。您选择其中一个，然后箭头转到其他。对我来说很有意义 - 可能不想让选项卡更改单选按钮组的值，对吗？否则键盘导航会有问题。当您选择一个单选按钮组时，它会选择一个选项卡。

# c++ - 使用 boost::tuple 引用作为 ordered_unique 索引的键来增加多索引插入错误

> ID：12320912
> 
> 赞同：0
> 
> 时间：2012-09-07T15:16:08.973
> 
> 标签：c++, boost-multi-index, boost-tuples

我把它归结为我能想到的最简单的示例代码。

我有一个成员索引的 boost multi：

```
typedef const boost::tuple<const uint32_t &, const uint8_t &> key_type; 
```

这样做似乎使多索引认为每个项目都是相等的（大小永远不会> 1）

我正在存储一个具有 2 个成员的结构，我希望多索引的唯一键是这两个成员。我认为制作一个引用元组可以相当简单地完成此任务。它的行为不像我预期的那样。当元组中的项目被引用时，似乎每个新项目都与现有项目冲突。可能还值得注意的是，简单地远离引用将使代码的行为符合我的预期，但这并不能帮助我理解为什么引用案例不起作用。

```
#include <stdint.h>
#include <iostream>
#include <boost/multi_index_container.hpp>
#include <boost/multi_index/ordered_index.hpp>
#include <boost/multi_index/sequenced_index.hpp>
#include <boost/multi_index/member.hpp>
#include <boost/multi_index/tag.hpp>
#include "boost/tuple/tuple.hpp"
#include "boost/tuple/tuple_comparison.hpp"

namespace bmi = ::boost::multi_index;

class MyMultiIndex {
public:
    MyMultiIndex() {}
    ~MyMultiIndex() {}

    // Switching away from references fixes everything....
    typedef const boost::tuple<const uint32_t &, const uint8_t &> key_type;
    //typedef const boost::tuple<const uint32_t, const uint8_t> key_type;

    struct Item {
        const uint8_t thing1;
        const uint32_t thing2;
        key_type key;

        Item(const uint8_t &a1, const uint32_t &a2)
                : thing1(a1), thing2(a2), key(thing2, thing1)
        {}
    };

    struct key_idx {};

    typedef bmi::multi_index_container<
        Item,
        bmi::indexed_by<
            bmi::ordered_unique<bmi::tag<key_idx>,
                                bmi::member<Item, key_type, &Item::key>
            >
        >
    > imsi_map_type;

    typedef imsi_map_type::index<key_idx>::type key_idx_type;

    void insert(const uint8_t &a1, const uint32_t &a2)
    {
        Item item(a1, a2);

        key_idx_type &idx(mi.get<key_idx>());
        std::pair<key_idx_type::iterator, bool> ret = idx.insert(item);

        if (!ret.second) {
            std::cout << "itr = " << (int)ret.first->thing1 << " " << ret.first->thing2 << std::endl;
        }
    }
private:
    imsi_map_type mi;
};

int
main()
{
    MyMultiIndex mindex;

    mindex.insert(1, 10);
    mindex.insert(1, 20);
    mindex.insert(3, 10);

    return 0;
} 
```

如示例中所述，如果我使元组保持值并且不引用所有内容，则可以按预期工作。

我花了很多时间研究各种可能性（悬空引用、比较 boost:tuples 在一个没有多索引的小程序中的引用等）

这是我的编译命令： g++ -O0 -ggdb -Wall -Werror test.cc -lboost_system -lpthread

运行程序给出：

itr = 1 10 itr = 1 10

表明即使我尝试插入 1,20 和 3,10，multi 似乎也认为它们等于 1,10。

我很困惑。任何和所有的帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T17:41:56.947

的复制语义`Item`，由其默认复制 ctor 实现，是有缺陷的。提供这样的复制ctor：

```
Item(const Item& x)
  : thing1(x.thing1), thing2(x.thing2), key(thing2, thing1)
{} 
```

# mongodb - 如果 Mongo 类被实例化两次，会有问题吗？

> ID：12320915
> 
> 赞同：0
> 
> 时间：2012-09-07T15:16:25.320
> 
> 标签：mongodb, symfony, symfony-2.1, doctrine-odm

我想使用 MongoDB 来存储会话，我需要将`\Mongo`对象注入到会话处理程序中。

我首先认为我可以通过以下方式从教义中获取它：

```
services:
    mongo.connection:
        class: MongoDoctrine\MongoDB\Connection
        factory_service: doctrine.odm.mongodb.document_manager
        factory_method: getConnection
    mongo:
        class: Mongo
        factory_service: mongo.connection
        factory_method: getMongo 
```

但是由于我正在使用的记录器预处理器需要我认为的 request_id ，它会引发循环引用异常，即使我将其关闭，有时它也会返回 null。所以我只是实例化了我自己的 Mongo 实例并且工作正常：

```
services:
    mongo:
        class: Mongo
        arguments: [ %doctrine_mongodb.default_server% , %doctrine_mongodb.options% ] 
```

这会不会有问题？我的意思是教义和会话处理程序将使用两个不同的`\Mongo`.

关于如何在`\Mongo`不陷入循环引用的情况下获取对学说创建的对象的引用的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T20:51:35.843

Mongo 的每个实例都代表一个到集群的单独网络连接。该文档建议对整个应用程序仅使用一个实例。

当你频繁创建新的 Mongo 实例时，每个实例都必须先建立一个新的连接，这需要相当长的时间。但是重用旧实例意味着将使用已经打开的网络连接，这要快得多。

使用多个实例的另一个缺点是 MongoDB 保证通过每个*连接*发送的所有查询都按顺序处理，但不保证来自不同连接的查询相同。因此，当您首先创建一个文档，然后使用相同的连接将其删除时，您可以确定它已经消失了。但是当你通过 Mongo A 创建它然后通过 Mongo B 删除它时，可能会在删除后处理保存，并且对象将保留在数据库中。

# c# - 从 EntityFramework 4 中的多对多关系中删除

> ID：12320925
> 
> 赞同：1
> 
> 时间：2012-09-07T15:16:52.293
> 
> 标签：c#, asp.net-mvc, entity-framework

我正在尝试使用 EntityFramework 4 删除一系列实体。这是我正在使用的代码：

```
var role = (
    from r in context.tblAdminRoles
    where r.AdminRoleId == this.Role.AdminRoleId
    select r
).First();

this.AdminUser.tblAdminRoles.Remove(role);
context.SaveChanges();

context.tblAdminRoles.Remove(role);
context.SaveChanges(); 
```

但是，当我执行它时，我收到以下错误：

> DELETE 语句与 REFERENCE 约束冲突`"FK_tblAdminUserRole_tblAdminRole"`。`"MyMainSite2"`数据库、表`"dbo.tblAdminUserRole"`、列发生冲突`'AdminRoleId'`。
> 
> 该语句已终止。

我的数据库具有以下结构：

```
----------------      --------------------      ----------------
|              |      |                  |      |              |
| tblAdminUser | ---< | tblAdminUserRole | >--- | tblAdminRole |
|              |      |                  |      |              |
----------------      --------------------      ---------------- 
```

谁能指出我可能出问题的正确方向？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T16:15:37.997

Check if *cascading delete* is enabled in the database for the two relationships refering to the link table `tblAdminUserRole`, especially for the `FK_tblAdminUserRole_tblAdminRole` to the `tblAdminRole` table. It looks like it isn't enabled, therefore deleting the role doesn't delete the entries in the link table which finally leads to the FK constraint violation.

# c++ - 是否有从另一个 DLL 加载 DLL 的最佳实践？

> ID：12320926
> 
> 赞同：2
> 
> 时间：2012-09-07T15:16:55.887
> 
> 标签：c++, visual-studio-2010, dll

我需要从另一个 DLL 中加载一个 DLL。诱惑是在 DllMain 中加载它，但已经有令人信服的文档说这是一个“坏主意”。

冒着问一个不是很具体的问题的风险：是否有从另一个 DLL 加载 DLL 的最佳实践？

在我们当前的项目中，我们的主 DLL 有一个类。我从该类的构造函数加载第二个 DLL。但是，由于该类可以在 DLL 中多次实例化，因此我保留了一个变量来指示 DLL 之前是否已加载，以免再次调用 LoadLibrary。这在某种程度上感觉不是一个好的解决方案，因此我提出了问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T15:21:14.980

这取决于您的 DLL。基本上，您有以下选择：

1.  链接到该 DLL 的 LIB 以自动加载它
2.  在加载库时加载另一个 DLL，在卸载之前卸载
3.  使用前加载其他DLL，然后卸载

如果您选择 1，您将收到非常奇怪的消息，如果在您尝试加载 DLL1 时缺少 DLL2，例如“加载 DLL1 失败”。而且客户永远不会知道这是因为缺少 DLL2。所以我不喜欢使用这个解决方案，如果你不能 100% 确定 DLL2 是否正确安装。

但是，当您手动加载 DLL2 (LoadLibrary) 时，您就有机会呈现有意义的消息。

如果您的 DLL 中有明确的入口和出口点，则可以选择 2。如果您的 DLL 导出一个或很少的函数，即为其他对象创建工厂的函数，就会出现这种情况。然后您可以使用工厂加载/卸载。

如果这不会导致您频繁执行此加载/卸载，您可以选择 3。

此外，您无需只保留一个 DLL2 句柄。您可以多次调用 LoadLibrary/FreeLibrary，它是执行引用计数的框架。

因此，在您的情况允许的情况下，您可以选择这 3 种解决方案中的一种。只有当您没有明确的入口点并且您经常调用需要 DLL2 的函数时，您才必须使用原始解决方案。

# database - 我什么时候想使用文档数据存储，什么时候使用键值数据存储？

> ID：12320929
> 
> 赞同：0
> 
> 时间：2012-09-07T15:17:08.377
> 
> 标签：database, nosql, key-value-store, document-database

我什么时候想使用*文档数据存储*以及何时使用*键值数据存储*？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:23:52.880

没有明显的区别。

在键值存储中，您有一个对应于一组位的键（通常是字符串）。一个例子是 Memcached。您可以在“值”部分中放入任何内容：JSON 文档、序列化数据结构、压缩或加密文件等。一般来说，它只是位。

A document store, on the other hand, implies that you need to store data in a certain format. An example is MongoDB, which uses a binary version of JSON. The database might provide indexing by looking at the contents of the document, or might allow some form of querying. You get some extra features, but you're also constrained a bit by the format. For example, if you had a document store that worked with JSON, your data will likely take up way more space than if you stored a compact serialized format like Protobuf, and will be slower to parse.

Ultimately, those categories don't mean much. Every database technology is different, and each has pros and cons (though they'll all claim to be the best thing since sliced bread). Figure out what your needs are, and evaluate DBs based on that. Some things you may want to consider:

*   你的数据是什么样的？你想怎么建模？
*   你需要什么样的复制？一些 NoSQL DB 做主从，另一些有一个控制节点，还有一些是无共享的。
*   他们是否有针对您计划编写代码的语言的 API？
*   还有更多...

# android - Android：选择时如何为Button绘制不同的背景？

> ID：12320932
> 
> 赞同：2
> 
> 时间：2012-09-07T15:17:21.393
> 
> 标签：android

我希望我的 Button 默认使用透明背景绘制，按下时使用深蓝色背景绘制，选择时使用浅蓝色背景绘制。我将按钮的背景设置为下面的选择器，并在`Button.setSelected(!Button.isSelected())`单击按钮时调用。按下状态正常工作，但选择时 Button 以透明背景绘制。

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">
  <item android:state_window_focused="false" android:state_enabled="true" android:drawable="@drawable/tranpsshape" /> 
  <item android:state_window_focused="false" android:state_enabled="false" android:drawable="@drawable/tranpsshape" /> 
  <item android:state_pressed="true" android:drawable="@drawable/pressedbuttonshape" /> 
  <item android:state_focused="true" android:state_enabled="true" android:drawable="@drawable/selectedshape" /> 
  <item android:state_enabled="true" android:drawable="@drawable/tranpsshape" /> 
  <item android:state_focused="true" android:drawable="@drawable/tranpsshape" /> 
  <item android:state_selected="true" android:drawable="@drawable/selectedshape" /> 
  <item android:drawable="@drawable/tranpsshape" /> 
</selector> 
```

选定形状.xml

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android" >
    <solid android:color="#A3DAF2"/>
</shape> 
```

按下按钮形状.xml

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android" >
    <solid android:color="#4ABDE8/>
</shape> 
```

转换形状.xml

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android" >
    <solid android:color="#00000000"/>

</shape> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T15:24:31.697

根据[文档](http://developer.android.com/guide/topics/resources/color-list-resource.html)

> 在每次状态更改期间，从上到下遍历状态列表，并且将使用与当前状态匹配的第一个项目 - 选择不是基于“最佳匹配”，而只是第一个满足最低标准的项目状态。

所以你需要放在`state_selected`上面`state_focused`。所以你的文件看起来像这样

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_window_focused="false" android:state_enabled="true" android:drawable="@drawable/tranpsshape" /> 
    <item android:state_window_focused="false" android:state_enabled="false" android:drawable="@drawable/tranpsshape" /> 
    <item android:state_pressed="true" android:drawable="@drawable/pressedbuttonshape" /> 
    <item android:state_selected="true" android:drawable="@drawable/selectedshape" />         
    <item android:state_focused="true" android:state_enabled="true" android:drawable="@drawable/selectedshape" /> 
    <item android:state_enabled="true" android:drawable="@drawable/tranpsshape" /> 
    <item android:state_focused="true" android:drawable="@drawable/tranpsshape" /> 
    <item android:drawable="@drawable/tranpsshape" /> 
</selector> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T15:23:36.083

> 选择不是基于“最佳匹配”，而只是满足该州最低标准的第一个项目。

[http://developer.android.com/guide/topics/resources/drawable-resource.html#StateList](http://developer.android.com/guide/topics/resources/drawable-resource.html#StateList)

所以我认为它是透明的，因为其中一个状态与当前状态匹配

```
 <item android:state_window_focused="false" android:state_enabled="true" android:drawable="@drawable/tranpsshape" /> 
  <item android:state_window_focused="false" android:state_enabled="false" android:drawable="@drawable/tranpsshape" />
  <item android:state_enabled="true" android:drawable="@drawable/tranpsshape" /> 
  <item android:state_focused="true" android:drawable="@drawable/tranpsshape" /> 
```

试着放

```
<item android:state_selected="true" android:drawable="@drawable/selectedshape" /> 
```

在顶部或将条件添加到以前的案例。

# jquery - jQuery .data() 不更新 DOM

> ID：12320934
> 
> 赞同：15
> 
> 时间：2012-09-07T15:17:27.603
> 
> 标签：jquery

看来 jQuery 1.7.2 并没有为我更新 DOM 数据属性。给定以下标记：

```
<ul id="foo">
    <li data-my-key="12345">ABCDEF</li>
</ul> 
```

运行下面的 JavaScript，我得到了一些我没想到的结果：

```
$('#foo li:first').data('my-key') // Returns 12345 - Expected
$('#foo li[data-my-key="12345"]') // Returns the expected <li>
$('#foo li:first').data('my-key', '54321')
$('#foo li:first').data('my-key') // Returns 54321 - Expected
$('#foo li[data-my-key="54321"]') // Returns an empty array - Not expected 
```

经过进一步调查，我注意到在使用 .data() 函数设置新值后，DOM**没有**被修改（通过 Chrome 21.0.1180.81、Firebug 1.10.3 和 Firefox 14.0.1 中的“检查元素”进行验证）。

从我的预期来看，这种行为是出乎意料的，但这是 jQuery 数据发挥作用的预期方式吗？如果是这样，用 jQuery 更新 data-* 属性的适当方法是什么？只需使用 attr() 函数？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-07T15:18:59.533

`$('#foo li[data-my-key="54321"]')`是一个**属性**选择器。

使用会更改不使用过滤器就无法选择`.data(..)`的元素**属性。**

如果您想获取具有特定属性的**所有**[`filter(...)`](http://api.jquery.com/filter/)元素，您可以这样做（使用）：

```
$('#foo li').filter(function(index) {
  return $(this).data('my-key') === 54321;
}); //returns all `#foo li` with data[my-key] === 54321 
```

* * *

有关更多信息，请参见此处：[.prop() 与 .attr()](https://stackoverflow.com/q/5874652/561731)

# c# - 正则表达式查找和替换不在标签中的文本

> ID：12320936
> 
> 赞同：1
> 
> 时间：2012-09-07T15:17:30.707
> 
> 标签：c#, regex, text

我正在寻找和替换不在标签内的文本。

标签很简单，并遵循以下模式：

```
(<[A-Z_]+>)([^<]+)(</[A-Z_]+>) 
```

*   第 1 组：开始标签
*   第 2 组：标记内容
*   第 3 组：结束标签

我需要查看的文本是这样的（每个文本项 1 行，每行可能有多个标签）：

```
What movie did The programmer watch if he didn't watch <NAME>The Office</NAME>? 
```

我需要在“programmer”之前匹配“The”，而不是 <NAME> 标签内的“The”。我希望将其更改为：

```
What movie did the programmer watch if he didn't watch <NAME>The Office</NAME>? 
```

作为另一个例子，也许更好：

```
What movie did The programmer watch if he didn't watch <NAME>Dawn of the Dead - The Original Director's Cut</NAME>? 
```

基本上，我希望解决标签外文本的大小写问题。我根本不想触摸标签内的任何文本。这是另一个例子：

```
Why Don't You watch <NAME>This is Spinal Tap</NAME> on <DAY>Friday</DAY> or whenever? 
```

在那里，我想找到：

*   别
*   你

但不是“脊柱”等，并以这个结束：

```
Why don't you watch <NAME>This is Spinal Tap</NAME> on <DAY>Friday</DAY> or whenever? 
```

我需要查看的所有字符串都是带有标记文本的句子，它们被放置在字符串内的任何位置。没有标签重叠或包含另一个标签。

任何帮助都将不胜感激。甚至只是一个链接或指向正确路径的指针就跑下来了。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:41:28.500

您的解决方案是：

```
Regex.Replace(s, @"((?<!^)\b[A-Z])(?=[^<>]+<[^\/>][^>]+>)", m => m.Value.ToLower()); 
```

### 检查[这个演示](http://ideone.com/B0ewW)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-07T17:09:22.023

试试这个正则表达式：

```
((?<!^|\.\s*)\b[A-Z])(?![^<>]+(?:<\/[^>]+)?>) 
```

在[Regexhero进行测试](http://regexhero.net/tester/?id=9421f1aa-6442-41d9-a4e0-e9483c344140)

这将确保不匹配同一行中新句子的第一个大写单词。
例如，`The`in`The movies was Not that great`将不匹配。

> 如果程序员不看办公室，他会看什么电影？这部电影不是那么好。

# c# - 通过 AT 命令使用 C#.net 拨打电话

> ID：12320944
> 
> 赞同：2
> 
> 时间：2012-09-07T15:18:05.037
> 
> 标签：c#, at-command

我想制作一个 ac# 程序，通过 USB 线连接到我的手机以拨打电话。我找到了如何通过 SerialPort 进行连接以及如何通过 AT 命令进行调用，但是当我运行我的程序并单击进行调用时，什么也没有发生。这是我的代码，请帮助我：

```
SerialPort SP = new SerialPort("COM3");
SP.BaudRate = 9600;
SP.Parity = Parity.None;
SP.DataBits = 8;
SP.StopBits = StopBits.One;
SP.RtsEnable = true;
SP.DtrEnable = true;
SP.Encoding = System.Text.Encoding.Unicode;
SP.ReceivedBytesThreshold = 1;
SP.NewLine = Environment.NewLine;
SP.Open();
SP.Write("ATDT 0999182542"+ Environment.NewLine);

SP.Close(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T11:12:07.237

首先查看你的调制解调器是否连接，向`AT`端口发送命令。如果您收到`OK`响应，则表示您的调制解调器已连接。

拨打电话的语法是：

`ATDYourphnumber;` //不要忘记**“;”**

例子：`ATD9012345645;`

所以你应该以同样的方式写入端口。

句法：

`SP.WriteLine("ATD"+phonenumber+";");`

您可以使用*WriteLine*，因为它也可以使用`\r\n`。

**更新：**如何查看调制解调器的响应：

在*SP.Open( )*之后；

```
string cmd = "AT";
SP.WriteLine(cmd + "\r");
SP.Write(cmd + "\r");
Thread.Sleep(500);
string ss= SP.ReadExisting();
if(ss.EndsWith("\r\nOK\r\n"))
  {
   MessageBox.Show("Modem is connected");
  } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-30T20:41:05.077

@Cdeez 你的答案是最好的！它工作得很好 XD 我试过了，但我的错误不包括“\r”，它的作用是按“enter”，你需要按 enter 才能让命令采取行动。顺便说一下，这是我的调用方法，再次感谢@Cdeez！：

```
private void Call() {
        SerialPort celu = new SerialPort();
        celu.PortName = "COM13"; // You have check what port your phone is using here, and replace it
        celu.Open();
        string cmd = "ATD";  // Here you put your AT command
        string phoneNumber = "784261259"; // Here you put the phone number, for me it worked just with the phone number, not adding any other area code or something like that
        celu.WriteLine(cmd + phoneNumber + ";\r");
        Thread.Sleep(500);
        string ss = celu.ReadExisting();
        if (ss.EndsWith("\r\nOK\r\n"))
        {
            MessageBox.Show("Modem is connected \r Calling : " + phoneNumber);
        }
        celu.Close();
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T15:24:03.667

COM 端口日志记录工具呢？你用它吗？您的命令是否发送到 COM 端口？

据我所知拨号命令是 ATD[Number]; 所以尝试重写你的代码如下：

```
 SP.Write("ATD0999182542;"+ Environment.NewLine); 
```

尝试使用这个库： [GSM 通信库](http://www.scampers.org/steve/sms/libraries.htm)

# selection - 在 NSMatrix 中以编程方式取消选择单元格不起作用

> ID：12320950
> 
> 赞同：3
> 
> 时间：2012-09-07T15:18:24.513
> 
> 标签：selection, cell, nsmatrix

我希望能够从我的程序中取消选择 NSMatrix 中的所有单元格。
我正在使用`deSelectAllCells`，但它不能正常工作。它总是至少选择一个单元格。

更具体地说，我已经尝试了所有可能的模式设置，但似乎没有效果。我也尝试将allowEmptySelection设置为YES，但没有任何效果。我正在使用 mouseDown、mouseUp 和 mouseDragged 来控制选择的工作方式，并允许用户选择单元格、行或列。也允许与命令键组合。

一旦做出选择，用户就从单独的窗口中选择一个动作。单击窗口时，最后一个选择变为灰色，并且在操作中调用 deSelectAllCells 后，所有选择都将被删除，除了灰色的选择。如果现在单击矩阵窗口，灰色选择将返回默认选择颜色。即使只有一个选择，也会发生相同的行为。

# shell - awk 脚本未列出特定列

> ID：12320951
> 
> 赞同：2
> 
> 时间：2012-09-07T15:18:44.840
> 
> 标签：shell, parameters, awk

使用 awk 我已经编写了这个脚本，但它不能正常工作。即使我只希望它只显示特定列，它会向我显示总列信息。

```
n=0
echo  "Enter which column you want: "
read  n
awk '{print $($n)}' out.txt 
```

我只想为 的值提供特定列`n`。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T15:21:02.543

单引号内没有参数替换。采用

```
awk '{print $'$n'}' out.txt 
```

或使用 awk 变量，如

```
awk -v n="$n" '{print $n}' out.txt 
```

# java - 限制函数调用的时间

> ID：12320952
> 
> 赞同：0
> 
> 时间：2012-09-07T15:18:44.997
> 
> 标签：java, multithreading, time, depth-first-search

> **可能重复：**
> [如何使线程超时](https://stackoverflow.com/questions/2275443/how-to-timeout-a-thread)

我正在使用函数调用在树中进行递归搜索。它在类变量中设置最佳答案，并且函数本身不返回任何内容。

所以我想限制该功能的允许时间。如果时间用完了，它就会停止并且线程被销毁。如果我想将通话限制在两秒内，我应该怎么做：

```
runFunction(search(),2000); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:42:07.217

假设您使用的是 Java 5 或更高版本，我将使用 ExecutorService 接口和提交方法：

```
ExecutorService executor = Executors.newSingleThreadExecutor();
Future<?> future = executor.submit(new Runnable() {

@Override
public void run() {
    search();
    }
});
try {
    future.get(2000, TimeUnit.SECONDS);
} catch (TimeoutException e) {
    // handle time expired
} 
```

使用此方法，您还可以通过提交 Callable 而不是 Runnable 来调整线程以返回值。

# asp.net-mvc - MVC：编辑模型，额外字段

> ID：12320953
> 
> 赞同：0
> 
> 时间：2012-09-07T15:18:45.540
> 
> 标签：asp.net-mvc, model-view-controller

如果被问了很多次，不要打我。
我看过很多关于如何使用 MVC 编辑实体的精彩演示。他们只希望我的编辑表单只包含 3 个字段，这些字段当然是可编辑的，因此能够在客户端和服务器之间轮换数据，直到用户最终输入正确的值。但我的应用程序有点复杂，我需要你的建议。
1）我有一个实体 Product 具有字段 Name 和 CreatedBy
2）唯一可编辑的字段是 Name
3）如果输入不正确，我需要用最好的方式重新填充不可编辑的字段

为此，我需要从 repo 中检索业务对象并将缺失值分配给结果视图模型。可以有很多值。我应该逐步分配它们吗？我应该使用（尝试）UpdateModel 吗？我应该使用 AutoMapper（从未尝试过）之类的东西来指定如何相互更新实体吗？为此使用了哪些常用方法？请在包含超过 3 个可编辑字段的编辑表单上提供任何链接...谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:30:11.417

根据您的评论，“它们没有存储在隐藏中，但如果模型无效，那么我需要向用户返回一个包含可编辑和不可编辑值的视图。在控制器中我只得到可编辑的值，我需要把别人放在我的手上。” 以下是如何做到这一点：

```
<HttpPost()>
Function Create(company As Company) As ActionResult

    If ModelState.IsValid Then

        db.Companies.Add(company)
        db.SaveChanges()
        Return RedirectToAction("Index")

    End If

    ' if model state is not valid
        Return RedirectToAction("MyNewAction")

End Function 
```

如果您的模型状态无效，则发送到另一个操作（或视图，如果您愿意）。如果您需要创建一个单独的模型，您可以这样做，然后将模型与您添加的字段一起发送到新视图。

# ruby-on-rails - Rails - ：所有范围和元编程都不好

> ID：12320958
> 
> 赞同：0
> 
> 时间：2012-09-07T15:18:55.277
> 
> 标签：ruby-on-rails, ruby, activerecord, refactoring

我怎样才能干掉下面的 Rails 代码？该`type`参数将对应于 Rails 范围，我曾认为这`all`也可以工作......但它返回一个数组，我的狡猾计划失败了。

对`if`我来说看起来不对，但我不知道如何让`all`示波器正常工作；有任何想法吗？

不正确地依赖于`all`作用域的原始代码：

```
def readable(type=:all)
  StudyAid.send(type.to_s).authored_by(self)
end 
```

工作但丑陋的版本：

```
def readable(type=:all)
  if type == :all
    StudyAid.authored_by(self)
  else
    StudyAid.send(type.to_s).authored_by(self)
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:41:12.253

我不会尝试修改该`all`方法的行为，因为这可能会意外地改变代码其他部分的语义，并使其他使用您的代码的人感到惊讶。

但是，您可以使用不同的名称定义命名范围，`StudyAid`例如

```
named_scope :every 
```

然后你的方法可能变成：

```
def readable(type=:every)
  StudyAid.send(type).authored_by(self)
end 
```

次要观点：您可以使用符号 with ，因此不需要`send`您的调用。`to_s`

最后，我不认为你的版本像你自己想象的那么丑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T15:42:53.617

除非您只想使用`:all`，否则这应该可以工作：

```
class StudyAid
  scope :all_recs
end

def readable(type = :all_recs)
... 
```

PS虽然我不是第一个...

# ipad - iOS：从英语到不同语言的文本翻译，反之亦然

> ID：12320959
> 
> 赞同：1
> 
> 时间：2012-09-07T15:18:55.677
> 
> 标签：ipad, ios5, multilingual, google-translate

我想通过我的 iPad 应用程序将英文文本翻译成不同的语言。这些文本是从前端网站动态生成的，因此我可以使用英语和其他语言之间的静态映射。基本上我会从服务器收到一行英文文本，我想将其转换为 iPad 的区域设置语言设置并显示它。有没有人可以做到这一点？我可以使用谷歌翻译吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:36:43.513

Google Translate 提供了一个非常简洁的 API，您可以使用它在您的应用程序中快速轻松地在大量不同语言之间翻译文本。这是很好的教程：

[http://www.raywenderlich.com/1448/how-to-translate-text-with-google-translate-and-json-on-the-iphone](http://www.raywenderlich.com/1448/how-to-translate-text-with-google-translate-and-json-on-the-iphone)

# graph - 创建透明网格线

> ID：12320963
> 
> 赞同：0
> 
> 时间：2012-09-07T15:19:18.147
> 
> 标签：graph, sas

我试图让图表的网格线透明，但似乎不受支持：

[http://support.sas.com/documentation/cdl/en/grstatug/63302/HTML/default/viewer.htm#n1f71f6e9v037an1jy274v66z4r1.htm](http://support.sas.com/documentation/cdl/en/grstatug/63302/HTML/default/viewer.htm#n1f71f6e9v037an1jy274v66z4r1.htm)

我正在尝试将网格线与图表背景颜色（在我的代码中可以在颜色之间更改）混合，这将使网格线在背景颜色发生变化时变得微妙而不是刺耳。

这是我的代码：

```
**
** TAKE THE DEFAULT STYLE BEING USED.  MODIFY IT SO THAT 
** GRAPH GRIDLINES WILL BE GREEN AND MOSTLY TRANSPARENT
*;
proc template;
  define style my_style;
    parent = styles.default;
    style GraphGridLines from GraphGridLines / contrastcolor=green transparency=.05;
  end;
run;

**
** LAYOUT TEMPLATE FOR A SIMPLE SERIES CHART
*;
proc template;
 define statgraph mychart;
  begingraph; 
    layout overlay / wallcolor=black
                     xaxisopts=(display=(line) griddisplay=on) 
                     yaxisopts=(display=(line))
                     ;

      seriesplot x=name y=height / lineattrs=(color=white); 

    endlayout;  
  endgraph;
 end;
run;

**
** PLOT SAMPLE DATA USING CUSTOM STYLE AND CHART LAYOUT WE JUST DEFINED
*;
ods graphics / width=640 height=640 ;
ods html style=my_style;

proc sgrender data=sashelp.class template=mychart;
run;

ods html close; 
```

有没有另一种方法可以通过将绿色与背景颜色混合来实现这种效果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T18:52:43.870

我想到了。下面的代码会将灰色阴影与您指定的背景颜色混合在一起。然后它使用混合颜色作为网格线的颜色。

我从这些中获取了一些提示/代码/想法：

*   [http://www2.sas.com/proceedings/sugi29/091-29.pdf](http://www2.sas.com/proceedings/sugi29/091-29.pdf)
*   [RGB 值的加色混合算法](https://stackoverflow.com/questions/726549/algorithm-for-additive-color-mixing-for-rgb-values)

需要一些实用程序宏来执行此操作，它们是：

```
**
** MACRO TO CONVERT RGB->HEX
*;
%macro rgb_to_hex(iR=,iG=,iB=);
  %local r g b hex;

  %let r=%sysfunc(round(&iR,1));
  %let g=%sysfunc(round(&iG,1));
  %let b=%sysfunc(round(&iB,1)); 

  %let hex = CX%sysfunc(putn(&r,hex2.))%sysfunc(putn(&g,hex2.))%sysfunc(putn(&b,hex2.));
  &hex
%mend;

**
** MACRO TO CONVERT HEX->RGB.  RESULTS ARE SAVED TO THE SPECIFIED MACRO VARIABLES
*;
%macro hex_to_rgb(iHex=, iRedMacroVar=rr, iGreenMacroVar=gg, iBlueMacroVar=bb);

  %global &iRedMacroVar &iGreenMacroVar &iBlueMacroVar;
  %local r g b;

  %let r=%substr(&iHex,3,2);
  %let g=%substr(&iHex,5,2);
  %let b=%substr(&iHex,7,2);

  %let &iRedMacroVar   = %sysfunc(putn(%sysfunc(inputn(&r,hex2.)),z3.));
  %let &iGreenMacroVar = %sysfunc(putn(%sysfunc(inputn(&g,hex2.)),z3.));
  %let &iBlueMacroVar  = %sysfunc(putn(%sysfunc(inputn(&b,hex2.)),z3.));

%mend;

**
** MACRO TO BLEND COLORS TOGETHER.
*;
%macro blend_colors(iHexColor1=, iHexColor2=, iBlendType=average);
  %local blended;

  %hex_to_rgb(iHex=&iHexColor1, iRedMacroVar=r1, iGreenMacroVar=g1, iBlueMacroVar=b1)
  %hex_to_rgb(iHex=&iHexColor2, iRedMacroVar=r2, iGreenMacroVar=g2, iBlueMacroVar=b2)

  %if "%upcase(&iBlendType)" eq "AVERAGE" %then %do;
    %let blended = %rgb_to_hex(iR=%qsysfunc(round((&r1 + &r2) / 2,1)),
                               iG=%qsysfunc(round((&g1 + &g2) / 2,1)),
                               iB=%qsysfunc(round((&b1 + &b2) / 2,1)));
  %end;
  %else %if "%upcase(&iBlendType)" eq "ADDITIVE" %then %do;
    %let blended = %rgb_to_hex(iR=%sysfunc(min(&r1 + &r2, 255)),
                               iG=%sysfunc(min(&g1 + &g2, 255)),
                               iB=%sysfunc(min(&b1 + &b2, 255)));
  %end;
  %else %do;
    %put %str(E)RROR: (MACRO.BLEND_COLORS.SAS): INCORRECT PARAMETER PASSED IN FOR IBLENDTYPE.;
  %end;
  &blended
%mend; 
```

这是代码：

```
**
** PARAMETERS - SPECIFY A BACKGROUND COLOR AND THE AMOUNT OF GREY TO BLEND AGAINST IT
*;

* EXAMPLE1;
%let bg_color   = CX000000; *BLACK;
%let grid_color = CX202020; *JUST A LITTLE GREY NEEDED;

* EXAMPLE2;
/*%let bg_color   = CX0FF000; *GREEN;*/
/*%let grid_color = CX080808; * VERY LITTLE GREY NEEDED;*/

/** EXAMPLE3;*/
/*%let bg_color   = CXFF0000; *RED;*/
/*%let grid_color = CX363636; *STRONGER GREY NEEDED;*/

**
** YOU COULD ALSO SPECIFY COLORS USING RGB IF YOU PREFER. 
** USING THE BELOW COMMENTED OUT SYNTAX
*;
/*%let bg_color   = %rgb_to_hex(iR=0  ,iG=0  ,iB=0  );*/
/*%let grid_color = %rgb_to_hex(iR=20 ,iG=20 ,iB=20);*/

**
** BLEND THE COLORS TOGETHER
*;
%let blended = %blend_colors(iHexColor1=&bg_color, iHexColor2=&grid_color, iBlendType=additive);

**
** TAKE THE DEFAULT STYLE BEING USED.  MODIFY IT SO THAT 
** GRAPH GRIDLINES WILL BE GREEN AND MOSTLY TRANSPARENT
*;
proc template;
  define style my_style;
    parent = styles.default;
    style GraphGridLines from GraphGridLines / contrastcolor=&blended; * USE THE BLENDED COLOR AS THE GRID COLOR;
  end;
run;

**
** LAYOUT TEMPLATE FOR A SIMPLE SERIES CHART
*;
proc template;
 define statgraph mychart;
  begingraph; 
    layout overlay / wallcolor=&bg_color
                     xaxisopts=(display=(line) griddisplay=on) 
                     yaxisopts=(display=(line))
                     ;

      seriesplot x=name y=height / lineattrs=(color=white); 

    endlayout;  
  endgraph;
 end;
run;

**
** PLOT SAMPLE DATA USING CUSTOM STYLE AND CHART LAYOUT WE JUST DEFINED
*;
ods graphics / width=640 height=640 ;
ods html style=my_style;

proc sgrender data=sashelp.class template=mychart;
run;

ods html close; 
```

# java - 使用球衣，是否可以隐藏某些类属性？

> ID：12320968
> 
> 赞同：2
> 
> 时间：2012-09-07T15:19:34.507
> 
> 标签：java, json, jersey, jackson

假设我有一个用户类，它有一个密码属性。

当我使用 jersey 在一个安静的 api 调用中公开这个类时，是否可以以某种方式标记“密码”属性，使其不会被公开（转换为 json 或 xml）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T15:49:52.250

你有没有尝试过 ？

```
 @XmlTransient 
```

# c++ - 从 C++ 中的 txt 文件中读取字符

> ID：12320969
> 
> 赞同：0
> 
> 时间：2012-09-07T15:19:44.247
> 
> 标签：c++, arrays, file-io

我有一个程序可以从 txt 文件中读取行数和列数。此外，程序必须从同一文件中读取二维数组的内容。

这是txt文件

```
8 20
 *       
  *
*** 

         *** 
```

8 和 20 分别是行数和列数。空格和星号是数组的内容， `Array[8][20]`例如，`Array[0][1] = '*'`

我确实使程序读取 8 和 20 如下：

```
ifstream myFile;
myFile.open("life.txt");

if(!myFile) {
    cout << endl << "Failed to open file";
    return 1;
}

myFile >> rows >> cols;
myFile.close();

grid = new char*[rows];
for (int i = 0; i < rows; i++) {
    grid[i] = new char[cols];
} 
```

现在，如何将空格和星号分配给数组中的字段？

我做了以下，但没有奏效

```
for (int i = 0; i < rows; i++) {
        for (int j = 0; j < cols; j++) {
            while ( myFile >> ch )
            {
            grid[i][j] = ch;
            }
        }
    } 
```

我希望你明白了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T15:36:51.917

你可以这样做：

```
for (int y = 0; y < rows; y++) {
    for (int x = 0; x <= cols; x++) {
        char ch = myFile.get();
        if (myFile.fail()) <handle error>;
        if (ch != '\n') grid[y][x] = ch;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T18:13:46.133

```
#include <iostream>
#include <fstream>
#include <vector>

using namespace std;

int main()
{
    ifstream myFile("file.txt");

    if(!myFile) { 
      cout << endl << "Failed to open file";
        return 1;
    }

    int rows = 0, cols = 0;
    myFile >> rows >> cols;

    vector<vector<char> > grid(rows, vector<char>(cols));
    for(int i = 0;i < rows;i++)
    {
        for(int j = 0;j < cols;j++)
        {
            if(myFile.fail()) {cout << "Improper data in file" << endl;}
            myFile >> grid[i][j];
        }
    }
    myFile.close();

    //Printing the grid back
    std::cout << "This is the grid from file: " << endl;
    for(int i = 0;i < rows;i++)
    {
        cout << "\t";
        for(int j = 0;j < cols;j++)
        {
            cout << grid[i][j];
        }
        cout << endl;
    }
} 
```

# jquery - 如何使用codeigniter和jquery删除记录？

> ID：12320977
> 
> 赞同：0
> 
> 时间：2012-09-07T15:20:10.173
> 
> 标签：jquery, ajax, codeigniter

我有工作的 codeigniter 控制器并查看成功删除记录的视图。我想用ajax - jquery来做，以避免重新加载页面，果然我需要提示用户，如果他确定要删除记录。

任何代码片段都将不胜感激，因为我不知道从哪里开始：

这是来自控制器的代码：

```
public function deleteUser()
    {
        $this->load->model('backOfficeUsersModel');
        $deleteWhat = array(
            'dpage' => $this->input->post('dpage'),
            'rid'   => $this->input->post('rid')
        );
        $this->backOfficeUsersModel->delete($deleteWhat['rid']);
        redirect($deleteWhat['dpage']);
    } // end of function deleteUser 
```

这是我现在的观点：（为简单起见，仅提供 php 代码）

```
foreach ($users as $key => $user) {
                            echo form_open('backOfficeUsers/deleteUser');
                            echo form_hidden('dpage', 'backOfficeUsers/displayAllUsers');
                            echo form_hidden('rid', $user['userid']);
                            echo "<tr>";
                            echo "<td>";

                            $data = array(
                                'name' => 'row_sel',
                                'id' => $user['userid'],
                                'value' => $user['userid'],
                                'class' => 'select_row'
                            );

                            echo form_checkbox($data);

                            //echo "<input type='checkbox' class='select_row' name='row_sel'>"; 
                            echo "</td>";
                            echo "<td>" . $user['userid'] . "</td>";
                            echo "<td>" . $user['firstname'] . " " . $user['lastname'] . "</td>  ";
                            echo "<td>" . $user['username'] . "</td>  ";
                            echo "<td><a href=mailto:" . $user['email'] . ">" . $user['email'] . "</td>  ";
                            echo "<td style='text-align: center;'>";
                            echo anchor("backOfficeUsers/displayEditUserForm/$user[userid]/", "<i class=splashy-pencil></i>", "class=ext_disabled");     
                            echo "</td>";
                            echo"<td style='text-align: center;'>";
                            $confirm = "class='splashy-remove' style='border:none; width:16px; height:16px;'";

                            echo form_submit('submit', '', $confirm);
                            echo"</td></tr>";

                            echo form_close();
                        } 
```

任何帮助（代码片段或某些示例的链接）将不胜感激

问候，佐兰

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T17:13:52.800

请在`echo`陈述上放轻松。如果您发现自己*过度*使用它们，可能是**因为您应该使用嵌入式 PHP 编写 HTML，而不是使用嵌入式 HTML 编写 PHP。**此外，在 SO 上发布问题时，请删除只会混淆回答者的多余绒毛。您的代码中有很多*废话*并没有触及问题的*核心*。

## 从头开始，这是我要使用的 HTML 脚手架：

```
<table>
    <thead>
        <tr>
            <th>Username</th>
            <th>Actions</th>
        </tr>
    </thead>
<tbody>
    <? foreach($users as $uK => $uV):?>
        <tr>
            <td><?= $uV['username']?></td>
            <td><a class='deleteUser' href='backOfficeUsers/deleteUser/<?= $uV["id"]?>'>Delete</a></td>
        </tr>        
    <? endforeach;?>
</tbody> 
```

## 然后是 jQuery：

```
<script type='text/javascript'>
    $(document).ready(function(){
        $(".deleteUser").click(function(e){
            $this  = $(this);
            e.preventDefault();
            var url = $(this).attr("href");
            $.get(url, function(r){
                if(r.success){
                    $this.closest("tr").remove();
                }
            })
        });
    });
</script> 
```

## 和控制器：

```
class Backofficeuser extends CI_Controller{
    function __construct(){
        ...
    }

    function deleteUser($id){
        $u = new User($id);
        if($u->delete()) return json_encode(array("success" => true));            
    }

} 
```

我这里使用Datamapper的语法进行记录删除，请适应Active Record。该代码未经测试，它是在 SO 编辑器中编写的 - 但这是我处理事情的方式。

# java - 使用 maven 下载每个 Spring 库

> ID：12320979
> 
> 赞同：4
> 
> 时间：2012-09-07T15:20:15.757
> 
> 标签：java, spring, maven

我必须在我的 中一个一个地定义每个弹簧库`pom.xml`，还是有某种合装包？

我发现，比如我让maven下载spring-core的时候，它也下载了spring-asm。

是否有更多这样的包或类似的快捷方式......？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T15:38:31.873

**这里可能有重复：[Maven - 将 pom 的所有子模块作为依赖项包含在另一个模块中](https://stackoverflow.com/questions/7848979/maven-include-all-submodules-of-a-pom-as-dependencies-in-another-module)**

最简洁的答案是不。长答案是，即使你可以，这也不是一个好主意。

Spring 曾经提供捆绑`groupId=org.springframework artifactId=spring`和`groupId=org.springframework artifactId=spring-all`. 由于各种原因（我找不到链接），Spring 认为这是一种不好的做法，我倾向于同意。

最好的办法是，如果你真的想包含所有的 spring 子模块是使用父 pom 和一个属性来表示版本......例如：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>com.snaphop</groupId>
  <artifactId>snaphop-parent</artifactId>
  <version>0.0.53-SNAPSHOT</version>
  <name>snaphop-parent</name>
    <packaging>pom</packaging>
    <properties>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <java.version>1.6</java.version>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <spring.version>3.1.0.RELEASE</spring.version>
    </properties>

..skip some lines

<dependencyManagement>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-test</artifactId>
            <version>${spring.version}</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-context</artifactId>
            <version>${spring.version}</version>
        </dependency> 
```

您必须在此处阅读有关父 pom 的信息：[http](http://maven.apache.org/guides/introduction/introduction-to-the-pom.html#Project_Inheritance_vs_Project_Aggregation) ://maven.apache.org/guides/introduction/introduction-to-the-pom.html#Project_Inheritance_vs_Project_Aggregation （或只是谷歌）。

另一种选择是使用所有弹簧依赖项制作您自己的虚拟项目并依赖它。

**话虽如此，我真的建议您明确选择您的依赖项，因为它确实可以帮助您将来模块化/解耦/重构您的项目。**

# ruby-on-rails - 如何在 FactoryGirl 中为循环关联创建工厂？

> ID：12320984
> 
> 赞同：6
> 
> 时间：2012-09-07T15:20:28.470
> 
> 标签：ruby-on-rails, ruby, unit-testing, associations, factory-bot

我在尝试为我在项目中定义的一些对象和关联创建工厂时遇到了麻烦。我有一种循环类型的关联，其中一个对象与其他两个随后连接在一起的对象关联。

```
+--------------+           +-------------+
|              |           |             |
| TestCase     +---------> | TestDataGrid|
|              |           |             |
+------+-------+           +------+------+
       |                          |
       |                          |
       |                          |
       v                          v
+--------------+           +--------------+
|              |           |              |
|              |           |              |
| TestVariable |           | TestDataSet  |
|              |           |              |
+------+-------+           +------+-------+
       |                          |
       |                          |
       |                          |
       |                          |
       |     +---------------+    |
       |     |               |    |
       |     |               |    |
       +---> | TestDataValue |<---+
             |               |
             +---------------+ 
```

* * *

```
class TestCase < ActiveRecord::Base
  has_many :test_variables, dependent: :destroy
  has_many :test_data_grids
  #...omitted code...
end

class TestVariable < ActiveRecord::Base
  belongs_to :test_case
  has_many :test_data_values
  #...omitted code...
end

class TestDataValue < ActiveRecord::Base
  belongs_to :test_variable
  belongs_to :test_data_set
  #...omitted code...
end

class TestDataSet < ActiveRecord::Base
  belongs_to :test_data_grid
  has_many :test_data_values
  #...omitted code...
end

class TestDataGrid < ActiveRecord::Base
  belongs_to :test_case
  has_many :test_data_sets
  #...omitted code...
end 
```

基本上，该关联在 TestCase 中分裂并在 TestDataValue 中再次加入，我如何创建一个使用相同对象打开和关闭圆圈的工厂？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T17:04:56.937

这未经测试，但是：

```
FactoryGirl.define do

 factory :test_data_value do
  test_data_set
  test_variable
  # attributes
 end

 factory :test_data_set do
  test_data_grid
  # attributes
 end

 factory :test_variable do
  test_case
  # attributes
 end

 factory :test_case do
  # attributes
 end

 factory :test_data_grid do
  test_case
  # attributes
 end
end 
```

然后在规格中：

```
@test_data_value = FactoryGirl.create(:test_data_value)

@test_variable = @test_data_value.test_variable
@test_data_set = @test_data_value.test_data_set 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T14:39:13.063

我的建议是不要在工厂中设置它，而是在测试本身中设置它。

工厂文件（感谢 @veritas1）

```
FactoryGirl.define do

  factory :test_data_value do
    # attributes
  end

  factory :test_data_set do
    # attributes
  end

  factory :test_variable do
    # attributes
  end

  factory :test_case do
    # attributes
  end

  factory :test_data_grid do
    # attributes
  end
end 
```

测试文件

```
@test_case = FactoryGirl.create(:test_case)
@test_data_grid = FactoryGirl.create(:test_case)
@test_variable = FactoryGirl.create(:test_case)
@test_data_set = FactoryGirl.create(:test_case)
@test_data_value = FactoryGirl.create(:test_case)
@test_case.test_data_grids << @test_data_grid
@test_case.test_variables << @test_variable
@test_data_grid.test_data_set << @test_data_set
@test_variable.test_data_values << @test_data_value
@test_data_set.test_data_values << @test_data_value 
```

我知道这可能有点糟糕，但听起来像是这样做的方式。不过，作为一个想法，如果您在测试中遇到困难，这通常表明您将在跟踪过程中遇到困难，您应该重新设计 API。我看不到另一种方法，但您可能能够了解该领域的知识。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-16T20:36:36.233

您可以手动执行此操作：

```
test_case = FactoryGirl.build(:test_case)

test = FactoryGirl.build(:test_data_value,
  :test_variable => FactoryGirl.build(:test_variable,
     :test_case => test_case
  ),
  :test_data_set => FactoryGirl.build(:test_data_set,
    :test_data_grid => FactoryGirl.build(:test_data_grid,
       :test_case => test_case
    )
  )
)

test.test_variable.test_case == test.test_data_set.test_data_grid.test_case
# => true 
```

或者写一些辅助工厂：

```
FactoryGirl.define do
  factory :test_data_value do
    ignore do
      test_case nil
      test_data_grid nil
    end

    test_variable do
      build :test_variable,
        :test_case => test_case 
                      || test_data_grid.try(:test_case) 
                      || build(:test_case)
    end

    test_data_set do
      build :test_data_set, :test_data_grid => test_data_grid || (
        build :test_data_grid, :test_case => test_case || build(:test_case)
      )
    end
  end
end 
```

测试用例作为共同祖先：

```
test = FactoryGirl.create :test_data_value, 
  :test_case => FactoryGirl.build(:test_case)

test.test_variable.test_case == test.test_data_set.test_data_grid.test_case
# => true 
```

作为共同祖先的测试用例和每个实例的相同 test_data_grid ：

```
test_data_grid = FactoryGirl.build :test_data_grid, 
  :test_case => FactoryGirl.build(:test_case)

test = FactoryGirl.create :test_data_value, 
  :test_data_grid => test_data_grid

test.test_variable.test_case == test.test_data_set.test_data_grid.test_case
# => true 
```

# .net - 关闭事件和表单关闭事件之间的区别

> ID：12320987
> 
> 赞同：7
> 
> 时间：2012-09-07T15:20:48.037
> 
> 标签：.net, winforms, events, lifecycle

[只是想知道Windows Application 的事件顺序](http://msdn.microsoft.com/en-us/library/86faxx0d%28v=vs.100%29.aspx)`Form.Closed`和`Form.FormClosed`event之间的最大区别是什么。我已经在 MSDN 文档中阅读过它，但仍然找不到任何彼此不同的东西。请解释。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-07T15:25:51.620

正如[MSDN 所说](https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.form.closed#remarks)：

> 该`Closed`事件在 .NET Framework 2.0 版中已过时；改用`FormClosed`事件。

我认为你甚至不应该考虑使用这个事件。它已被弃用和隐藏，但它只是为了与旧源代码兼容。

它与事件具有相同的含义，`FormClosed`但有一个（不是那么多）细微差别，正如您在 MSDN 上看到的`Closed`那样，当应用程序存在时，由于调用`Application.Exit()`但`FormClosed`is.

此行为也记录在上面的链接中：

> 当调用该方法退出应用程序时，不会引发`Form.Closed`and`Form.Closing`事件 。`Application.Exit`如果您在其中任何一个事件中有必须执行的验证代码，则应在调用该`Form.Close`方法之前分别为每个打开的表单调用该`Exit`方法。

# asp.net - 搜索框、按钮和网格视图

> ID：12320988
> 
> 赞同：0
> 
> 时间：2012-09-07T15:20:56.743
> 
> 标签：asp.net, datagrid

我将如何实现这一点：

用户可以在 中输入任何文本`Textbox1`，然后单击`Submitbtn1`并在 中显示结果`Gridview1`。`Clearbtn1`用于清除 Textbox1 中的所有文本。

这将在 Visual Studio ASP.NET Web 应用程序中完成。

这是我到目前为止所做的：

```
namespace SearchApplication
{
    public partial class _Default : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {

        }

        protected void GridView1_SelectedIndexChanged(object sender, EventArgs e)
        {

        }

        private void EmptyTextBoxValues(Control parent)
        {
            foreach (Control c in parent.Controls)
            {
                if ((c.Controls.Count > 0))
                {
                     EmptyTextBoxValues(c);
                }
                else
                {
                     if (c.GetType().ToString().Equals("System.Web.UI.WebControls.TextBox"))
                     {
                          ((TextBox)(c)).Text = "";
                     }
                     else
                     {
                         //do nothing
                     }
                 }
             }
         }

         protected void Button2_Click(object sender, EventArgs e)
         {
             EmptyTextBoxValues(this.Page);
         }

         protected void Button1_Click1(object sender, EventArgs e)
         {

         }
     }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:43:40.453

一个提示。不要做 ：

```
if (c.GetType().ToString().Equals("System.Web.UI.WebControls.TextBox"))
                     {
                          ((TextBox)(c)).Text = "";
                     }  . 
```

做

```
TextBox tx = c as TextBox. if(c != null) c.Text = ""; 
```

至于其他的。单击提交按钮时，您将获取一些数据/创建一些数据并将其绑定到网格使用

```
grid.DataSource = myData;
grid.DataBind(); 
```

关于清除文本框。如果您使用放置在网格之外的普通 Asp.net TextBox，例如

```
<asp:TextBox id="Textbox1" runat="server"/> 
```

您不需要 EmptyTextBoxValues。你可以做 Textbox1.Text = ""

# c# - 两侧 WCF 服务通信

> ID：12320990
> 
> 赞同：1
> 
> 时间：2012-09-07T15:20:59.577
> 
> 标签：c#, wcf, visual-studio

我正在使用 WCF。

我有两个应用程序：“Main”和“Worker”。

有时应用程序“Main”正在为“Worker”分配任务。“工人”正在工作，当工作完成时，它会给“主要”带来结果。

这种沟通应该如何进行？

我需要从 Main 调用 Worker.AddTask(Task)，从 Worker 调用 Main.AddResult(Result)。有比设置两个服务更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:28:06.457

每次对“Worker”的调用最终都会以“Main”的结果结束吗？如果是这样，您可能只想让“Main”异步调用“Worker”，“Main”可以等待结果然后回来。请参阅：http: [//msdn.microsoft.com/en-us/library/ms730059.aspx](http://msdn.microsoft.com/en-us/library/ms730059.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T15:27:51.973

这对于 WCF 的回调来说听起来很经典——它允许服务器和客户端之间进行双向异步通信（在您的情况下，服务器将是“工作人员”，而“主”应用程序将调用其方法以开始处理。当worker 完成后，它将在 main 上调用回调。）
[LMGTFY](https://www.google.co.il/search?q=wcf%20callback&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla%3aen-GB%3aofficial&client=firefox-a) :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T15:31:04.443

这需要两个组件之间的双向通信。我提供的第一个链接是 MSDN 中的描述，第二个链接指向一个实现示例。享受。

[MSDN 文章](http://msdn.microsoft.com/en-us/library/ms752264.aspx)

[示例链接](http://social.msdn.microsoft.com/Forums/en/wcf/thread/835e7704-55f3-4357-9806-fc938763ae93)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T15:27:50.777

假设两个应用程序是独立的进程并通过服务进行通信......

我认为您可以使用[netTcpBinding](http://msdn.microsoft.com/en-us/library/system.servicemodel.nettcpbinding.aspx)和[Callback 合同](http://msdn.microsoft.com/en-us/library/system.servicemodel.servicecontractattribute.callbackcontract.aspx)

# jquery - jQuery 添加 css 光标类型以形成提交/链接。网站性能/速度的影响？知道“副作用”吗？

> ID：12320992
> 
> 赞同：1
> 
> 时间：2012-09-07T15:21:10.710
> 
> 标签：jquery, css

我为一个大型网站工作（每月 5+ 百万次独立点击，大约 55-60 百万页面浏览量/展示次数）。

我们目前正在更新我们的可用性（tabindex、标签等）。

我正在使用 css 类和 jQuery（参见下面的代码）在表单提交（以及与 ajax 相关的部分页面刷新/更新等）上将光标类型更改为“进度”，以便用户立即知道“某事”正在发生，通过类名“loadWait.

```
 //css class
   body.wait *, body.wait {
    cursor:progress !important;
   }

   //jQuery
   $(document).ready(function() { 
      $('.loadWait').click(function(){
         progerssCursor();
      });
   });
   function progerssCursor(){
    $('body').addClass('wait');
   }
   function removeProgerssCursor(){
    $('body').removeClass('wait');
   }

   //example html   
   <input type="sumbit" class="loadWait" />
   <a href="..." class="loadWait" />

   //in ajax requests by calling functions "progressCursor()" and 
"removeProgressCursor" at the appropriate time/place 
```

所以问题是：

1.  这种方法是否有任何已知的“副作用”？（已经广泛搜索，找不到任何让我不相信的东西）。

2.  我们正在讨论是否还应该将 class="loadWait" 附加到我们所有的链接（显然不是那些带有 target="_blank" 的链接，因为我们不希望光标在这种情况下改变）。你怎么认为？我们的理由是，有时，无论出于何种原因（服务器负载高、互联网连接速度慢等），用户“链接点击”和实际页面开始呈现之间可能会有几秒钟的奇怪延迟，这样用户会立即知道“某事”正在发生（我们知道选项卡中的加载图标在那里，但用户经常错过它）。你怎么认为？对我们所有的链接都这样做是不是太过分了？（这里不讨论工时）。

3.  有谁知道这会增加什么样的额外页面加载时间（如果有）？（$('.loadWait').click(function(){... 是如何工作的？jQuery 是在页面加载时检查整个 DOM 以查找“click”事件，还是在“click by click”基础上检查匹配类名？）。

4.  对此还有其他想法吗？

注意：此代码已由我们在 IE6-9、FF3.6、FF11、FF12、Opera、Safari（Windows）、Chrome 等上测试，没有已知/明显的错误/问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:44:53.820

我将继续通过#回答您的问题：

1.  做你正在做的事情没有直接的副作用。但是，有些情况您是无能为力的，例如禁用 JavaScript 的用户。话虽如此，我知道 Chrome（至少是较新的版本）会在页面加载时自动将光标更改为加载图标，因此 Chrome 浏览器不需要这段额外的 JavaScript。然而，运行 JavaScript 的高流量站点不应该担心（参见 #2），除非 JS 是面向 ajax 的。
2.  如果您尝试在链接点击上添加自定义加载指示器，那么为每个链接添加点击处理程序将是合适的方式。JavaScript 的好处是它纯粹是客户端。因此，尽管页面加载需要多长时间，但当用户点击“loadWait”链接时，它会首先触发 JavaScript，然后等待页面加载。因此，根据您所描述的服务器负载，这对实际单击链接的操作没有影响，因为您的作品都是客户端。
3.  只要您的 JavaScript 位于正文的底部（应该是），页面加载时间就不会受到影响，因为在执行任何 JavaScript 之前所有 HTML 元素都已经加载。但是，如果您真的担心 click 事件不是一个非常繁重的 jQuery 函数，但就像任何 jQuery 函数一样，如果过度使用可能会导致最小的延迟。不过我怀疑这会是个问题，所以我想说，别担心，只要确保你的 JS 位于页面底部即可。
4.  简要回到 #1：确保查看所有浏览器的固有功能，以便确定哪些浏览器（如 Chrome）已经提供此功能。

祝你好运，希望这对你有帮助！

**编辑：**还有一件事我忘了提。如果页面上有任何动态加载的 JavaScript，.click 事件将不会注册到该动态 JavaScript 中的任何链接。这是假设您的代码片段正在 $(document).ready 中触发。如果您要将其移至 $(window).load 会更合适。然而，更好的解决方案是利用 jQuery 的 .on 函数（以前是 .live）。on 函数将允许动态 JavaScript 也被绑定，但要注意：如果定期**有很多动态 JavaScript，这可能会阻碍该 JavaScript 的性能。**

# c - 在 ssl 握手期间，客户端在 FIN、ACK 后向服务器发送 RST

> ID：12320998
> 
> 赞同：3
> 
> 时间：2012-09-07T15:21:24.010
> 
> 标签：c, openssl

编写了一些代码来与网络服务器进行 ssl 握手。我可以看到 SSL 握手正在发生，但是在客户端发送 FIN、ACK 之后，它再次发送 RST。下面是ssl流

编号 时间 源 目的地 协议 信息

```
 33 1.350030    client          server         TCP      45447 > https [SYN] Seq=0 Win=5840 Len=0 MSS=1460 TSV=803408331 TSER=0 WS=7
 34 1.351219    server         client          TCP      https > 45447 [SYN, ACK] Seq=0 Ack=1 Win=5792 Len=0 MSS=1460 TSV=1994962735 TSER=803408331 WS=3
 35 1.351231    client          server         TCP      45447 > https [ACK] Seq=1 Ack=1 Win=5888 Len=0 TSV=803408331 TSER=1994962735
 36 1.351290    client          server         SSLv2    Client Hello
 37 1.352087    server         client          TCP      https > 45447 [ACK] Seq=1 Ack=106 Win=5792 Len=0 TSV=1994962735 TSER=803408331
 38 1.364899    server         client          TLSv1    Server Hello, Certificate, Server Key Exchange, Server Hello Done
 39 1.364905    client          server         TCP      45447 > https [ACK] Seq=106 Ack=1351 Win=8576 Len=0 TSV=803408335 TSER=1994962738
 40 1.391410    client          server         TLSv1    Client Key Exchange, Change Cipher Spec, Encrypted Handshake Message
 41 1.401229    server         client          TLSv1    Change Cipher Spec, Encrypted Handshake Message
 42 1.401351    client          server         TCP      45447 > https [FIN, ACK] Seq=304 Ack=1410 Win=8576 Len=0 TSV=803408344 TSER=1994962747
 43 1.403212    server         client          TLSv1    Encrypted Alert
 44 1.403222    client          server         TCP      45447 > https [RST] Seq=305 Win=0 Len=0
 45 1.403238    server         client          TCP      https > 45447 [FIN, ACK] Seq=1447 Ack=305 Win=6864 Len=0 TSV=1994962748 TSER=803408344
 46 1.403240    client          server         TCP      45447 > https [RST] Seq=305 Win=0 Len=0 
```

请让我知道向服务器发送 RST 的原因。这会引起任何问题吗？导致问题的部分代码：

```
apr_socket_t *sock;
    apr_sockaddr_t *backend;

    // set up the backend apr_sockaddr_t
    rv = apr_sockaddr_info_get( &backend, host, APR_UNSPEC, port,  0, p);
    rv = apr_socket_create( &sock, backend->family, SOCK_STREAM, 0,   p);
    rv = apr_socket_opt_set(sock, APR_SO_NONBLOCK, 1);
    rv = apr_socket_timeout_set(sock, timeout * 1000);

    c = (ssl_connection *)malloc (sizeof (ssl_connection));
    c->ssl = NULL;
    c->ssl_ctx = NULL;

    c->ssl_ctx = SSL_CTX_new (SSLv23_client_method ());//Create a new ssl_ctx structure

    SSL_CTX_set_options(c->ssl_ctx, SSL_OP_ALL);

    c->ssl = SSL_new (c->ssl_ctx);
    ssl_rand_seednum();

    apr_os_sock_get(&fd, sock);

    bio = BIO_new_socket(fd, BIO_NOCLOSE);
    SSL_set_bio(c->ssl, bio, bio);
    SSL_set_connect_state(c->ssl);
    apr_socket_connect(sock, backend);

   while (do_next) {

        ret = SSL_do_handshake(c->ssl);
        ecode = SSL_get_error(c->ssl, ret);
        switch (ecode) {
            case SSL_ERROR_NONE:
                ap_log_perror(APLOG_MARK, APLOG_ERR, 0, p,
                        "connect_ssl_backend_ws()- Handshake Completed SuccessFully ");

                do_next = 0;
                rv = APR_SUCCESS;
                break;
            case SSL_ERROR_WANT_READ:
                do_next = 1;
                break;
            case SSL_ERROR_WANT_WRITE:
                do_next = 1;
                break;
            case SSL_ERROR_WANT_CONNECT:
                do_next = 0;
                rv = APR_INCOMPLETE;
                break;
            case SSL_ERROR_SSL:
                do_next = 0;
                rv = APR_INCOMPLETE;
                break;
            case SSL_ERROR_SYSCALL:
                /* Unexpected result */
                do_next = 0;
                rv = APR_INCOMPLETE;
                break;
        }
    }
  for (i = 0; i < 4 ; i++) {
            if ((rc = SSL_shutdown(c->ssl)))
                break;
        }
        SSL_free(c->ssl);

    }
    if (c->ssl_ctx)
        SSL_CTX_free (c->ssl_ctx);

    free (c);
    c->ssl = NULL;
    c->ssl_ctx = NULL;
    apr_socket_close(sock); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:24:57.583

是的。它可能会导致问题、性能下降等。

在我遇到的情况下，RST 消息是由于错误的网络配置（一侧全双工 100Mbps，另一半双工 10Mbps），导致丢包的其他延迟问题，......必须检查整个解决方案以找到出罪魁祸首。