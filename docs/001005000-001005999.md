# StackOverflow 问答 1005000-1005999

# jquery - jquery 嵌套每个问题

> ID：1005006
> 
> 赞同：1
> 
> 时间：2009-06-17T03:41:59.120
> 
> 标签：jquery, xml

请参阅下面的编辑。我正在尝试让一些 jquery 在我正在构建的 wordpress 插件中工作。（在 wordpress 中使用 jquery 时，使用字符串 'jQuery' 而不是 '$' 习语，仅供参考）

示例 xml：

```
   <人>
        <Name>某个名字</Name>
        <位置>
            <locationName>一个地址</locationName>
        </位置>
        <日期>
            <startDate>01-01-09</startDate>
        </日期>
    </人>

```

示例jQuery：

```
jQuery(text).find("person").each(function(){
    jQuery("#active_list")
        .append(
            "<div id=\'Entry\'>"
            + jQuery(this).find("Name").text()
            + "<b> at </b>"
    ;

    jQuery(this)
        .find("location")
        .each(function(){
            jQuery("#active_list")
                .append(
                    jQuery(this).find("locationName").text()
                    + " <b> on </b>"
                )
            ;
        })
    ;

    jQuery("#active_list")
        .append(
            jQuery(this).find("date").find("startDate").text()
            + "</div>"
        )
    ;
}); 
```

然后产生了不好的标记：

```
<div id="Entry"> Some Name<b> at </b></div>一个地址 <b> on </b>01-01-09

```

如您所见，它在退出第二个嵌套循环后立即插入 /divs 。我显然做错了什么，但我不知道是什么。有任何想法吗？

编辑：如果放

```
jQuery("#active_list").append("<div id=\'ActivityEntry\'>"); 
```

在它自己的行上，它会立即关闭 div。所以我猜我需要用 jquery 构建一个 div 元素，然后打包它，然后附加我的 div 元素。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T04:31:58.720

在 Wordpress 中使用 jQuery 的一个小技巧：将它包含在一个函数中。它将允许您使用熟悉的 $ 函数，并防止您使用变量污染全局命名空间。

例如，您的代码可以重写为：

```
(function($) {

    ... (code with $) ...

})(jQuery); 
```

至于您的问题的答案，如果您使用该变量，则嵌套`each`es 在 jQuery 中不起作用。`this`要解决您的问题，请尝试使用以下完整样式`each`：

```
$(...).each(function(i, val1) { 

    $(...).each(function(j, val2) { ... }

}); 
```

并使用`val1`and`val2`而不是`this`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T04:05:59.843

我对你的问题的建议

```
jQuery(text).find("person").each(function(){
   var html;
   html = jQuery(this).find("Name").text() + "<b> at </b>";

   jQuery(this).find("location").each(function(){
      html += jQuery(this).find("locationName").text() + " <b> on </b>";
   });

   html += jQuery(this).find("date").find("startDate").text();
   jQuery("#active_list").append("<div id=\'Entry\'>" + html + "</div>");
}); 
```

这应该有效。您尝试对其进行微调。您的脚本不起作用的原因是 jquery 将每个字符串转换为一个对象。

# delphi - Delphi 2009 最高效的 Unicode 哈希函数

> ID：1005010
> 
> 赞同：9
> 
> 时间：2009-06-17T03:43:32.220
> 
> 标签：delphi, unicode, assembly, hash, delphi-2009

我需要 Delphi 2009 中可能的最快散列函数，它将从一个 Unicode 字符串创建散列值，该字符串将相当随机地分布到存储桶中。

我最初从 GpStringHash 的[Gabr](https://stackoverflow.com/users/4997/gabr)的 HashOf 函数开始：

```
function HashOf(const key: string): cardinal;
asm
  xor edx,edx     { result := 0 }
  and eax,eax     { test if 0 }
  jz @End         { skip if nil }
  mov ecx,[eax-4] { ecx := string length }
  jecxz @End      { skip if length = 0 }
@loop:            { repeat }
  rol edx,2       { edx := (edx shl 2) or (edx shr 30)... }
  xor dl,[eax]    { ... xor Ord(key[eax]) }
  inc eax         { inc(eax) }
  loop @loop      { until ecx = 0 }
@End:
  mov eax,edx     { result := eax }
end; { HashOf } 
```

但我发现这并没有从 Unicode 字符串中产生好的数字。我注意到 Gabr 的例程没有更新到 Delphi 2009。

然后我在 Delphi 2009 的 SysUtils 中发现了 HashNameMBCS 并将其翻译成这个简单的函数（其中“string”是一个 Delphi 2009 Unicode 字符串）：

```
function HashOf(const key: string): cardinal;
var
  I: integer;
begin
  Result := 0;
  for I := 1 to length(key) do
  begin
    Result := (Result shl 5) or (Result shr 27);
    Result := Result xor Cardinal(key[I]);
  end;
end; { HashOf } 
```

我认为这很好，直到我查看 CPU 窗口并看到它生成的汇编代码：

```
Process.pas.1649: Result := 0;
0048DEA8 33DB             xor ebx,ebx
Process.pas.1650: for I := 1 to length(key) do begin
0048DEAA 8BC6             mov eax,esi
0048DEAC E89734F7FF       call $00401348
0048DEB1 85C0             test eax,eax
0048DEB3 7E1C             jle $0048ded1
0048DEB5 BA01000000       mov edx,$00000001
Process.pas.1651: Result := (Result shl 5) or (Result shr 27);
0048DEBA 8BCB             mov ecx,ebx
0048DEBC C1E105           shl ecx,$05
0048DEBF C1EB1B           shr ebx,$1b
0048DEC2 0BCB             or ecx,ebx
0048DEC4 8BD9             mov ebx,ecx
Process.pas.1652: Result := Result xor Cardinal(key[I]);
0048DEC6 0FB74C56FE       movzx ecx,[esi+edx*2-$02]
0048DECB 33D9             xor ebx,ecx
Process.pas.1653: end;
0048DECD 42               inc edx
Process.pas.1650: for I := 1 to length(key) do begin
0048DECE 48               dec eax
0048DECF 75E9             jnz $0048deba
Process.pas.1654: end; { HashOf }
0048DED1 8BC3             mov eax,ebx 
```

这似乎比 Gabr 的代码包含更多的汇编代码。

速度至关重要。我能做些什么来改进我编写的帕斯卡代码或我的代码生成的汇编程序吗？

* * *

跟进。

我终于使用了基于 SysUtils.HashNameMBCS 的 HashOf 函数。它似乎为 Unicode 字符串提供了良好的散列分布，而且速度似乎相当快。

是的，生成了很多汇编代码，但是生成它的 Delphi 代码非常简单，并且只使用位移操作，所以很难相信它不会很快。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-17T04:02:26.257

ASM 输出并不是算法速度的良好指示。此外，据我所知，这两段代码所做的工作几乎相同。最大的区别似乎是内存访问策略，第一个是使用左滚动而不是等效的指令集（shl | shr——大多数高级编程语言都省略了“滚动”运算符）。后者可能比前者更好。

*ASM 优化是一种魔法，有时更多的指令比更少的指令执行得更快。*

可以肯定的是，*对两者进行基准测试并选择获胜者*。如果您喜欢第二个的输出但第一个更快，请将第二个的值插入第一个。

```
rol edx,5 { edx := (edx shl 5) or (edx shr 27)... } 
```

请注意，不同的机器将以不同的方式运行代码，因此如果速度真的很重要，那么请在您计划运行最终应用程序的硬件上对其进行基准测试。我敢打赌，在数兆字节的数据上，差异将只有几毫秒——这远远小于操作系统从你身上夺走的数据。

* * *

PS。我不相信该算法会创建均匀分布，这是您明确指出的（您是否运行过直方图？）。[您可能会考虑将此哈希函数](http://www.azillionmonkeys.com/qed/hash.html)移植到 Delphi。它可能没有上述算法那么快，但它看起来相当快并且也提供了良好的分布。同样，我们可能谈论的是兆字节数据的毫秒级差异。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-21T22:01:39.147

不久前我们举办了一场不错的小型比赛，改进了名为“ [MurmurHash](http://en.wikipedia.org/wiki/MurmurHash) ”的哈希；引用维基百科：

> 它以异常快而著称，通常比 FNV、Jenkins 的 lookup3 和 Hsieh 的 SuperFastHash 等同类算法快两到四倍，具有出色的分布、雪崩行为和整体抗碰撞性。

[您可以在此处](https://forums.embarcadero.com/thread.jspa?messageID=99863&#99863)下载该比赛的参赛作品。

我们学到的一件事是，有时优化并不能改善每个 CPU 的结果。我的贡献被调整为在 AMD 上运行良好，但在 Intel 上表现不佳。反过来也发生了（英特尔优化在 AMD 上运行次优）。

所以，正如 Talljoe 所说：衡量你的优化，因为它们实际上可能对你的表现有害！

作为旁注：我不同意李；Delphi 是一个很好的编译器，但有时我看到它生成的代码并不是最优的（即使在编译时打开了所有优化）。例如，我经常看到它清除了之前已经清除了两三个语句的寄存器。或者 EAX 被放入 EBX，只是将其移动并放回 EAX。之类的东西。我只是在这里猜测，但是手动优化这种代码肯定会在紧要关头有所帮助。

最重要的是；首先分析你的瓶颈，然后看看是否可以使用更好的算法或数据结构，然后尝试优化 pascal 代码（如：减少内存分配、避免引用计数、终结、try/finally、try/except 块等），然后，仅作为最后的手段，优化汇编代码。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-07-17T13:06:11.980

我在 Delphi 中编写了两个汇编“优化”函数，或者在微调的 Pascal 和 Borland Assembler 中实现了更多已知的快速哈希算法。第一个是[SuperFastHash](http://landman-code.blogspot.com/2008/06/superfasthash-from-paul-hsieh.html)的实现，第二个是由 Tommi Prami 在我的博客上的请求触发的 MurmurHash2 实现，将我的 c# 版本转换为 Pascal 实现。这引发了[在 Embarcadero Discussion BASM 论坛上继续进行的讨论](https://forums.embarcadero.com/thread.jspa?threadID=13902&tstart=0)，最终产生了大约 20 个实现（查看[最新的基准套件](https://forums.embarcadero.com/thread.jspa?threadID=14879&tstart=60)），最终表明由于每个周期时间的巨大差异，很难选择最佳实现。英特尔和 AMD 之间的指令。

So, try one of those, but remember, getting the fastest every time would probably mean changing the algorithm to a simpler one which would hurt your distribution. Fine-tuning an implementation takes lots of time and better create a good validation and benchmarking suite to make check your implementations.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-17T12:45:49.717

Delphi/BASM 论坛中有一些您可能感兴趣的讨论。看看以下内容：

[http://forums.embarcadero.com/thread.jspa?threadID=13902&tstart=0](http://forums.embarcadero.com/thread.jspa?threadID=13902&tstart=0)

# drupal - Where is the best place to put a DB query in drupal?

> ID：1005016
> 
> 赞同：1
> 
> 时间：2009-06-17T03:45:24.603
> 
> 标签：drupal

I have a few forms who's data needs to be written to the main database in their own tables. Just simple name-email collection forms, that are part of regular pages in drupal. I suspect the right way to do this would be to write a module that would have the query in a function, but this is just a guess. I've never written a module before, and don't know how the form would be processed that way.

It's also a guess that to perform the db query within a node would be insecure?

The only other idea I have would be to use a php file on the server to do the form processing, with the db query written there, but that seems very non-drupal, as far as I can tell.

How to??

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T13:00:23.730

[http://drupal.org/node/508](http://drupal.org/node/508) is Drupal's info on module development

You'll be wanting to use the function "db_query()"

You can use Drupal's built in methods to build forms though that will save the data for you. Have a look at the module developers guide though and you should be able to figure it out. Module development sounds intimidating but it's not as hectic as it seems once you actually know what's going on with Drupal (hence, read the guide).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T15:42:14.417

Have you checked what's already out there? [Webform](http://drupal.org/project/webform) may be able to solve your needs without any custom code.

Also, I highly recommend the book Pro Drupal Development if you want to learn more about Drupal and basic module development.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T16:01:18.380

I'd second the Webform module. Create a really simple webform with name and email (results can be emailed or stored automatically in the DB, and can be exported easily in several formats). Then check out the [Webform Block](https://www.drupal.org/project/webformblock) module to put that webform in a block and place wherever you need it on your site. No custom coding required!

Here is an excerpt from the Webform Block project page:

> Allows embedding a webform node into a block which can be positioned in any block region (theme space permitting).
> 
> Handles redirecting back to the current page on validation errors.
> 
> A good use for this is to add a site wide contact form inline on your pages, such as in the footer or sidebar.
> 
> Multiple webforms can appear on the same page. The contents of the block is simply a node, so theme work can be done in the node-webform.tpl.php file as usual.

# image-processing - 如何在不降低质量的情况下缩放图像以进行打印？

> ID：1005019
> 
> 赞同：1
> 
> 时间：2009-06-17T03:46:13.680
> 
> 标签：image-processing, dpi, image-scaling

我想知道你如何打印一个缩放三倍于原始尺寸的图像而不让它看起来像垃圾？如果您将 dpi 更改为 300 并打印它会看起来像废话。有没有办法优雅地转换它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T04:15:36.883

您可能会遇到尝试添加不存在的细节的问题。希望你知道这一点。

我知道放大图像的最佳方法是使用双三次插值。如果有任何帮助，Photoshop 建议使用“双三次平滑器”进行放大。

另外，请注意[DPI 与 PPI](http://photo.net/learn/resize/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T04:18:45.557

这称为超级采样或插值。没有“完美”的算法，因为这意味着在没有信息的地方（“像素之间”）生成新信息；但是有些方法比其他方法更好地欺骗眼睛/大脑来填补空白，或者至少不制作大方盒。

[从有关最近邻](http://en.wikipedia.org/wiki/Nearest-neighbor_interpolation)、[双线性](http://en.wikipedia.org/wiki/Bilinear_interpolation)和[双三次](http://en.wikipedia.org/wiki/Bicubic_interpolation)插值（PhotoShop 提供的三个）的维基百科文章开始。更多[Tricubic interpolation](http://en.wikipedia.org/wiki/Tricubic_interpolation)，[Lanczos 重采样](http://en.wikipedia.org/wiki/Lanczos_resampling)可能是有趣的，还检查[理论](http://sepwww.stanford.edu/public/docs/sep107/paper_html/node20.html)和[比较](http://www.all-in-one.ee/~dersch/interpolator/interpolator.html)链接。

简而言之，这不是一个简单明了的问题。而是一个活跃的调查领域，充满主观性和实际取舍。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T04:10:51.920

您应该对图像进行矢量化、缩放，如果您愿意，可以将其转换回原始格式（jpg、gif、png...）。然而，这最适合简单的图像。你知道如何向量化吗？有一些网站可以在线进行，只需进行一些谷歌研究，您就会找到一些。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T04:12:38.257

如果您的图像中没有足够的像素来满足您正在打印的尺寸，那么更改 DPI 将无关紧要。在商业中，它被称为 GIGO（Garbage In，Garbage Out）。

如果您的图像是 HTML 格式，则创建一个 media="print" 样式表并以这种方式提供高分辨率图像。

# c# - C# WinForms：在无限循环中等待按钮按下

> ID：1005020
> 
> 赞同：0
> 
> 时间：2009-06-17T03:46:16.863
> 
> 标签：c#, events, infinite-loop

我正在用 GUI 制作一个简单的猜数字游戏。我需要等待一个循环，等待用户在文本框中输入一个数字，然后按“确定”。如何等待循环内的事件？

注意：我不想要消息框。这是在主窗口中完成的，因此需要等待输入。

**编辑：**我应该更好地解释自己。我知道 GUI 中有一个循环。我想要的是方法中的*另一个*循环。也许有更好的方法来做到这一点。现在我想了想，我可以在按钮的事件处理程序中编写代码。虽然我需要全局变量。Whataver，我会考虑一下，但我希望我的问题现在更清楚了。

**编辑2：**对不起，我的问题不清楚，编辑并没有太大帮助。首先，代码太大，这里就不贴了。我可能不得不发布 GUI 的屏幕截图，所以它不会有太大用处。基本上，我有两个字段，“最大数量”和“允许猜测的数量”。用户输入这两个并点击“播放”。一个新面板变为可用，带有一个文本框和一个“猜测”按钮。用户输入一个猜测，程序检查它是否正确。

第二个无限循环的目的是避免全局变量。看，每次用户点击“玩”，游戏必须生成一个新的随机数作为正确的猜测。如果一切都在一个方法内完成，那没问题。但是如果多次调用“Guess”按钮的事件处理程序，则该数字必须存储为 Form 的实例变量。当然，这没什么大不了的，但我认为数字应该是指导当前游戏的方法的属性，而不是 Form 的属性。

我还必须跟踪方法之外的剩余猜测次数。再说一次，这没什么大不了的。如果可以的话，我只想避免使用全局变量。

再次，我很抱歉我的问题不太清楚。有点累，不想写太多。如果这仍然不清楚，请不要打扰。我会想办法的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T03:50:39.560

C# 自动无限循环等待事件，直到您的表单关闭。您只需要响应按钮单击事件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T05:12:01.810

Jason Down 的建议是明智的，创建一个新`GuessingGame`类并将其添加到您的项目中。我知道您担心“全局变量”（在学校里每个人都被教导*永远不要*使用它，除非您绝对必须这样做），但请考虑一下您的设计规范。

> 但是如果多次调用“Guess”按钮的事件处理程序，则该数字必须存储为 Form 的实例变量。当然，这没什么大不了的，但我认为数字应该是指导当前游戏的方法的属性，而不是 Form 的属性。

作为替代方案，将`GuessingGame`类的实例存储在表单中。这不是全局变量！您自己说过，游戏的重点是跟踪猜测并在每次单击“播放”时生成新的数字进行猜测。如果您在表单中存储游戏实例然后打开另一个表单（例如帮助或关于框），则游戏实例将不可用（因此，不是全局的）。

该`GuessingGame`对象将类似于：

```
public class GuessingGame
{
    private static Random _RNG = new Random();
    private bool _GameRunning;
    private bool _GameWon;
    private int _Number;
    private int _GuessesRemaining;

    public int GuessesRemaining
    {
        get { return _GuessesRemaining; }
    }

    public bool GameEnded
    {
        get { return !_GameRunning; }
    }

    public bool GameWon
    {
        get { return _GameWon; }
    }

    public GuessingGame()
    {
        _GameRunning = false;
        _GameWon = false;
    }

    public void StartNewGame(int numberOfGuesses, int max)
    {
        if (max <= 0)
            throw new ArgumentOutOfRangeException("max", "Must be > 0");

        if (max == int.MaxValue)
            _Number = _RNG.Next();
        else
            _Number = _RNG.Next(0, max + 1);

        _GuessesRemaining = numberOfGuesses;
        _GameRunning = true;
    }

    public bool MakeGuess(int guess)
    {
        if (_GameRunning)
        {
            _GuessesRemaining--;
            if (_GuessesRemaining <= 0)
            {
                _GameRunning = false;
                _GameWon = false;
                return false;
            }

            if (guess == _Number)
            {
                _GameWon = true;
                return true;
            }
            else
            {
                return false;
            }
        }
        else
        {
            throw new Exception("The game is not running. Call StartNewGame() before making a guess.");
        }
    }
} 
```

这样，所有与游戏相关的数据都封装在类中。在表单的代码隐藏中连接事件很容易：

```
GuessingGame game = new GuessingGame();

private void btnPlay_Click(object sender, EventArgs e)
{
    int numberOfGuesses = Convert.ToInt32(txtNumberOfGuesses.Text);
    int max = Convert.ToInt32(txtMax.Text);
    game.StartNewGame(numberOfGuesses, max);
}

private void btnGuess_Click(object sender, EventArgs e)
{
    int guess = Convert.ToInt32(txtGuess.Text);
    bool correct = game.MakeGuess(guess);

    if (correct) 
        lblWin.Visible = true;

    if (game.GameEnded)
    {
        // disable guess button, show loss label
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T03:52:18.920

您可能应该寻找一本书来实际学习 Windows 编程。

最基本的：

1）Windows代码深处已经存在无限循环。任何 Windows 程序都在不断地循环和扫描输入。

2) 一旦找到输入，这个循环就会触发一个事件。

3）如果您选择接受它，您的任务是编写事件处理程序来处理这些事件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T03:56:15.113

正如已经指出的那样，您很可能做错了，但是您可以使用它

应用程序.DoEvents();

在实际循环中处理事件

以正确的方式做到这一点 - 不要使用循环 - 使用编辑框进行输入，然后使用按钮 - 实现按钮 onclick 事件

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-11-23T15:17:56.633

是的，如果我正在等待语音事件，它可能会在函数运行时随时发生，我需要在不递归调用函数的情况下处理它

# php - 在 php 中，有没有办法将“所有”变量名及其相应值转储？

> ID：1005021
> 
> 赞同：12
> 
> 时间：2009-06-17T03:46:43.040
> 
> 标签：php, debugging

如果标题看起来太模糊.. 嗯，我想显示我用来生成页面的每个变量以及它们的变量名称和值，这是否可能以及如何？

```
 foreach($_SESSION as $varname => $value) {
        print "<b>".$varname."</b> = $value <br/>";
    } 
```

^上面的示例是我用来显示所有会话变量的，如果我需要显示我设置的变量来显示页面怎么办？它们是否也以某种形式的数组注册，还是我也应该单独回显它们？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-06-17T03:55:02.320

您可以使用[`get_defined_vars()`](http://php.net/get_defined_vars)which 将为您提供在调用函数的范围内声明的所有变量的数组，包括全局变量`$_SESSION`和`$_GET`. 我建议像这样打印它：

```
echo '<pre>' . print_r(get_defined_vars(), true) . '</pre>'; 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-17T04:23:30.677

最简单的方法是使用[get_defined_vars()](http://au.php.net/get_defined_vars)。

**从文档**

> 此函数返回一个多维数组，其中包含所有已定义变量的列表，无论是环境变量、服务器变量还是用户定义变量，都在调用 get_defined_vars() 的范围内。

生成此数组的 var_dump 将为您提供一个广泛的列表。

```
var_dump( get_defined_vars() ); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T05:02:44.943

同一领域的其他几个有趣的函数是 get_defined_constants() 和 get_included_files()...

# iphone - C 或 Objective C 中的数学问题

> ID：1005022
> 
> 赞同：6
> 
> 时间：2009-06-17T03:47:21.057
> 
> 标签：iphone, c, objective-c, math

这可能是一个愚蠢而简单的问题，但似乎有时最简单的事情会给我带来更多问题！

这个公式假设给我一个 0 到 100 之间的数字。

```
(200 / 23) * Abs(Mod(2987, 23) - 23 / 2) 
```

在客观 CI 中这样编码：

```
(200 / 23) * abs(2987 % 23) - (23 / 2); 
```

公式有缺陷（并且没有给出 0 到 100 之间的答案）还是我的代码错误？似乎我的模数没有给我正确的结果。它不应该给我一个整数吗？

谢谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-17T03:53:30.387

您的代码在目标 C 中是错误的...

```
(200 / 23) * abs(2987 % 23) - (23 / 2); 
```

应该

```
(200 / 23) * abs((2987 % 23) - (23 / 2)); 
```

这只是 73.9。

但是这个公式也是不正确的，你想要0到100之间的值。你当前的公式没有达到0，因为a%23的范围是0-22，所以如果你减去23/2然后你可以得到的最小值取绝对值为 0.5（11-11.5 和 12-11.5）。在这种情况下，22 将是理想的数字。

此外，通过减去 23/2，你会得到不均匀的分布，如果你只是将 mod 乘以 100/22，你会更好。这将有助于了解您正在尝试什么。

# unit-testing - 如何集成/单元测试软件硬件接口

> ID：1005033
> 
> 赞同：6
> 
> 时间：2009-06-17T03:51:48.733
> 
> 标签：unit-testing, continuous-integration, hardware-interface

我正在做一个有趣的小项目来建造一个机器人。作为程序员，我们与构建机器人的人并行工作。因此，我们经常尝试运行更改后的软件，而构建者已经更改了硬件。如果软件测试没有运行，那么很难确定软件或硬件是否失败，或者如果集成失败则更糟。有一些困难的部分可以自动测试这个问题。

我们已经找到了一些分解的方法，所以我们有 rc 控制让机器人在没有软件的情况下完成一些动作，以确保他仍然可以工作。然后我们开始一些软件测试，让机器人按照一些定义的数字运行，以显示软件的行为方式与以前相同。但这总是归结为一项非常耗时的任务，因为您无法将其自动化，并且必须有人开始测试，观察测试并尝试确定机器人是否做了它应该做的事情。

另一个问题是，对我们真实硬件的不断测试会磨损我们的硬件、关节、电机、齿轮等部件。

但事实证明，不进行测试会造成如此多的麻烦并耗费大量时间，我想知道在其他处理硬件软件交互的项目中使用了哪些技术，以及是否有可用的工具。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-17T08:16:01.790

必须先定义机器人与软件之间的接口；不一定要详尽无遗，这可以逐步完成。从小处着手，例如基本动作（前进、后退），然后，一旦经过全面测试，无论是孤立的还是综合的，添加一些行为（例如左转、右转），然后重新测试。这样，整个团队就可以使用在整个项目中学到的知识来扩展界面，从而最大限度地减少界面返工。

[硬件之前](https://wingman-sw.com/papers/ProgressBeforeHardware.pdf)的进展文章更详细地描述了这样一个过程，重点是测试驱动开发 (TDD) 方面。

另请参阅[How to do TDD with hardware](https://stackoverflow.com/questions/585593/how-to-do-tdd-with-hardware)问题的答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T05:48:07.377

我认为这是一个非常有趣的情况。

我相信你的测试过程没有问题。如果你模拟你的机器人并针对这个模拟进行测试，一切都很好。
如果硬件机器人的行为与您模拟的机器人不同，那么还有另一个大问题：*通信*。

软件和硬件之间的接口是“协议”规范。在我看来，它不能未经讨论就改变。硬件人可能不会改变它，而你们软件人也不会！你只能一起改变它。在你的情况下，每个人都自己改变它。

在您的情况下，您的团队似乎相互对抗。所以试着把你的精力集中在你的界面上，尤其是你的沟通上，而不是在你无论如何都行不通的集成测试上。

我的一个建议是使用机器人的软件模拟作为**唯一的**规范。所以你可以依赖你的模拟，并且有一个中心点定义了硬件和软件之间的连接。
当软件人员想要更改它时，好的。他们必须与您讨论，您将更改软件模拟。如果硬件改变了而模拟没有改变，你有一个道歉，因为你的开发违背了你的规范。

祝你好运！

# sql - 从 SQL 函数获取单个值时，如何将 NULL 更改为 0？

> ID：1005036
> 
> 赞同：66
> 
> 时间：2009-06-17T03:52:32.930
> 
> 标签：sql, tsql, null, sum

我有一个查询，计算两个日期之间所有商品的价格。这是选择语句：

```
SELECT SUM(Price) AS TotalPrice 
FROM Inventory
WHERE (DateAdded BETWEEN @StartDate AND @EndDate) 
```

您可以假设所有表都已正确设置。

如果我在两个日期之间进行选择并且该日期范围内没有项目，则该函数将 NULL 作为 TotalPrice 而不是 0 返回。

如何确保如果没有找到记录，则返回 0 而不是 NULL？

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2009-06-17T03:55:54.553

大多数数据库服务器都有一个[COALESCE](http://msdn.microsoft.com/en-us/library/aa258244.aspx)函数，它将返回非空的第一个参数，所以下面应该做你想要的：

```
SELECT COALESCE(SUM(Price),0) AS TotalPrice
FROM Inventory
WHERE (DateAdded BETWEEN @StartDate AND @EndDate) 
```

因为好像有很多讨论

> 如果没有行匹配，COALESCE/ISNULL 仍将返回 NULL，尝试此查询，您可以直接按原样复制并粘贴到 SQL Server：

```
SELECT coalesce(SUM(column_id),0) AS TotalPrice 
FROM sys.columns
WHERE (object_id BETWEEN -1 AND -2) 
```

请注意，where 子句将 sys.columns 中的所有行排除在考虑范围之外，但“sum”运算符仍会导致返回单行为空，这会将固定为带有 0 的单行。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-06-17T03:56:01.900

您可以使用[`ISNULL()`](https://docs.microsoft.com/en-us/sql/t-sql/functions/isnull-transact-sql?view=sql-server-ver15).

```
SELECT ISNULL(SUM(Price), 0) AS TotalPrice 
FROM Inventory
WHERE (DateAdded BETWEEN @StartDate AND @EndDate) 
```

这应该够了吧。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-06-17T04:11:11.000

```
SELECT 0+COALESCE(SUM(Price),0) AS TotalPrice
FROM Inventory
WHERE (DateAdded BETWEEN @StartDate AND @EndDate) 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-17T03:56:12.883

**编辑：**看起来其他人都打败了我哈哈

找到了答案。

`ISNULL()`确定当你有一个空值时要做什么。

在这种情况下，我的函数返回一个空值，所以我需要指定一个 0 来代替返回。

```
SELECT ISNULL(SUM(Price), 0) AS TotalPrice 
FROM Inventory
WHERE (DateAdded 
BETWEEN @StartDate AND @EndDate) 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2011-12-22T06:58:52.580

```
SELECT COALESCE(
    (SELECT SUM(Price) AS TotalPrice 
    FROM Inventory
    WHERE (DateAdded BETWEEN @StartDate AND @EndDate))
    , 0) 
```

如果表在响应中有行，则返回 SUM(Price)。如果 SUM 为 NULL 或没有行，它将返回 0。

如果没有找到行，则在 MSSQL 中放置 COALESCE(SUM(Price), 0) 不起作用。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-06-17T04:38:36.020

你可以使用

`SELECT ISNULL(SUM(ISNULL(Price, 0)), 0)`.

我有 99% 的把握这会奏效。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-04-25T06:15:17.423

甲骨文/PLSQL：

NVL 功能

```
SELECT NVL(SUM(Price), 0) AS TotalPrice 
FROM Inventory
WHERE (DateAdded BETWEEN @StartDate AND @EndDate) 
```

**`0`如果`SUM(Price)`返回空值，则此 SQL 语句将返回。否则，它将返回该`SUM(Price)`值。**

* * *

## 回答 #8

> 赞同：-5
> 
> 时间：2015-01-23T12:39:04.267

最简单的方法就是在结果中添加零。

IE

```
$A=($row['SUM'Price']+0);
echo $A; 
```

希望这可以帮助！！

# php - PHP / Drupal，会话存储和加密

> ID：1005041
> 
> 赞同：1
> 
> 时间：2009-06-17T03:53:45.707
> 
> 标签：php, session, drupal

我们在许多网站上使用 Drupal。在除一台服务器之外的所有服务器上，会话表中的数据显示为序列化字符串。这是AFAIK的正常行为。

在异常服务器上，会话数据的存储看起来像，

```
_C0c5x_xpVKkya5nD68ChpaKaHYNzWTlEN52gOCkH1fIAvj3ziCydGnNbLXTO75q_pYLhumOYHzxD1D
_ue5tRgeeQR4YUIDWtAZ2hxlJ7QUHS-KvUnYb5tHMFUCpFuGMY4brDUfOwlUScSgC1cVvuT51cm62bD
jmU1XBvVAtZAfNrHpwgcy_-YE9a9ViXd4Jdzy7yzYo8ZGXoh0_p-xs3vfuQnsiCe3KkH89q_YiZwux8 
```

（都是一行，而且比这长得多）

是 PHP 的 session.serialize_handler 配置设置的结果吗？

这是什么？怎么可能禁用？

这是来自站点 A 的示例会话条目 - 这是我希望看到的：

```
captcha|a:1:{s:12:"comment_form";a:3:{s:32:"5ce32afb28f38e2ec854eb2f9340e2e5";b:1;s:7:"success";b:0;s:32:"ba52f551aa38e84111938ef9fc2111e4";b:1;}} 
```

这是来自站点 B 的一个，带有“编码”会话数据：

```
tYeyamtSbI6U_Z5a0DXCwL1pwoY5DUBDNOTDjyftul9Z4TLMMDdVr_8HxPWTleQ8wrTIEPyRAdxb6Ukz69tSEQ.. 
```

编码值始终以句点结尾。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T11:36:41.777

原因是 Suhosin 的透明会话加密。

[php.net（关于 session_set_save_handler()）](http://us.php.net/manual/en/function.session-set-save-handler.php#89564)和[hardened-php.net（关于 suhosin 配置）](http://www.hardened-php.net/suhosin/configuration.html)的相关说明

# delphi - 详细 MAP 文件中的每个源行地址是否是插入 Int3h 的有效地址？

> ID：1005042
> 
> 赞同：3
> 
> 时间：2009-06-17T03:54:08.797
> 
> 标签：delphi, winapi, debugging

我正在尝试使用 Delphi 2007 创建一个代码覆盖率工具。

我的一般方法是使用 Win32 调试 API 为每个源代码行插入断点，然后在传递断点时删除它们 - 这样我就能够跟踪每个执行的源代码行。

我的方法大纲：

*   解析详细的 MAP 文件（由 Delphi 2007 生成）以查找每个源代码行的所有地址（仅适用于 .text 段）
*   使用 OpenProcess API 调用以调试模式打开应用程序
*   遍历每个源代码行并在每行的地址处插入一条[Int3](http://en.wikipedia.org/wiki/INT_(x86_instruction))指令（使用 WriteProcessMemory + FlushInstructionCache 的一个 $cc 字节）
*   继续执行，并随着每个断点被触发，删除相应的断点并将该行标记为已覆盖
*   在传递每个断点或程序存在之后，我生成一份报告，说明哪些行被覆盖，哪些行没有针对每个源模块

现在谈谈我的问题：

**详细 MAP 文件中的每个源行地址是否是插入 Int3 断点的有效地址？**

虽然该方法对于一些简单的单元是成功的，但我遇到了一些较大的应用程序的访问违规，其中违规地址包括 $cc - 这会让我认为我的方法需要一些修改才能工作。

也非常欢迎提供更好方法的提示！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T08:07:35.223

好吧，理论上：是的。实用，我也认为是的。如果 Delphi 可以在每一行上放置一个断点，那么你也可以:-)。

可能您需要针对某些情况进行一些特定的处理（例如：程序的第一行是本地变量的初始化、设置 EBP 等）。那么你能找出在哪种情况下它会失败吗？

顺便说一句：好项目！它是开源的吗？

PS，如果您需要一些汇编代码处理：查看 koldetours.pas（使用谷歌搜索）。

# c# - 如何在 Remoting 中创建透明代理

> ID：1005055
> 
> 赞同：1
> 
> 时间：2009-06-17T03:57:58.377
> 
> 标签：c#, remoting

当我们使用 Activator.GetObject 时，会创建透明代理但未创建服务器实例？有人能告诉我幕后发生了什么吗？我的意思是如果需要创建代理，那么客户端和服务器之间应该有一些通信，以便它可以保存远程对象的引用，但是在使用 Activator.GetObject 服务器/远程对象的 SAO 中没有创建？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-20T09:23:52.420

看看[DynamicProxy](http://www.castleproject.org/dynamicproxy/index.html)。这就是创建类的方式。是的，代理是基于与服务器（客户端）端协商的信息构建的。

# nunit - 我可以围绕 NUnit、MbUnit、xUnit 或其他测试框架创建一个包装器吗？

> ID：1005058
> 
> 赞同：3
> 
> 时间：2009-06-17T03:59:52.823
> 
> 标签：nunit, mstest, wrapper, mbunit, xunit

如何围绕测试框架创建包装器？我们仍然不知道要使用哪个测试框架，但我需要开始编写单元测试。带着这个问题，我想知道如何从 NUnit 切换到 mbUnit、xUnit 甚至 MSTest。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T04:47:27.373

你可以创建一个包装器——但我认为你可以更好地利用你的时间。我会说选择适合您需求的最简单的一个（我个人最喜欢的是战马 NUnit） - 较新的框架添加了帮助您编写更复杂的测试夹具的功能。
然而，我更看重简单而不是“灵活性”。将来，如果您发现自己想要“Y 测试框架中的酷特性 X”，您可以使用 Y 编写特定的测试夹具。（您也可以迁移整个测试夹具以使用 Y 以保持一致性 - 但时间总是稀缺） - 在 2 个单元测试框架之间切换通常是单调的工作（重命名属性），但[有些工作可能更多](http://www.codeproject.com/KB/architecture/gunit.aspx)（免责声明：MbUnit 没有飞行时间）

然而，你的评论让我有点担心。

1.  为什么客户决定您用于开发的测试框架 - 它应该是开发团队的选择。客户不希望您定义产品需求——他/她会吗？测试的质量不取决于使用的框架，所以我看不出这对客户有何影响。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-08T18:20:39.643

您可以使用允许您运行多个单元测试框架的现有包装器，因此即使您切换框架，您仍然可以使用旧的单元测试。对于您列出的单元测试框架，我建议您看看 Gallio。

来自[http://www.gallio.org/](http://www.gallio.org/) ...

> 目前 Gallio 可以从 MbUnit 版本 2 和 3、MSTest、NBehave、NUnit、xUnit.Net、csUnit 和 RSpec 运行测试。Gallio 提供工具支持和与 AutoCAD、CCNet、MSBuild、NAnt、NCover、Pex、Powershell、Resharper、TestDriven.Net、TypeMock 和 Visual Studio Team System 的集成。

# c - 在 C 中调试一个被破坏的静态变量（gdb 损坏？）

> ID：1005059
> 
> 赞同：3
> 
> 时间：2009-06-17T04:00:21.403
> 
> 标签：c, debugging, gdb, segmentation-fault

我已经做了很多编程，但在 C 语言中并不多，我需要有关调试的建议。我有一个静态变量（文件范围），在执行多线程程序（在 OS X 10.4 上使用 pthreads）大约 10-100 秒后被破坏。我的代码看起来像这样：

```
static float some_values[SIZE];
static int * addr; 
```

`addr`指向有效的内存地址一段时间，然后被某个值（有时为 0，有时为非零）破坏，从而在取消引用时导致段错误。`gdb`我已经证实，正如人们所期望的那样，它`addr`立即被布置在内存中`some_values`，所以我的第一个猜测是我使用了一个越界索引来写入`some_values`. 但是，这是一个很小的文件，因此很容易检查这不是问题所在。

显而易见的调试技术是在变量上设置观察点`addr`。但这样做似乎会在`gdb`. 观察点在第一次分配时被触发`addr`；然后在我继续执行之后，我立即在另一个线程中得到一个无意义的段错误......据说是在访问程序不同部分中的静态变量的地址时出现段错误！但是然后`gdb`让我以交互方式读取和写入该内存地址。

```
程序收到信号 EXC_BAD_ACCESS，无法访问内存。
原因：KERN_PROTECTION_FAILURE 地址：0x001d5bd0
0x0000678d 在 mainloop.c:39 处接收（arg=0x0）
39 sample_buf_cleared ++;
(gdb) p &sample_buf_cleared
$17 = (int *) 0x1d5bd0
(gdb) p sample_buf_cleared
18 美元 = 1
(gdb) 设置 sample_buf_cleared = 2
(gdb)

```

`gdb`显然很困惑。有谁知道为什么？或者有人对不使用观察点调试此错误有任何建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T05:10:39.737

1.  您可以在 some_values 和 addr 之间放置一个 uint 数组，并确定您是否超出了 some_values 或者损坏是否影响了您首先想到的更多地址。我会将填充初始化为 DEADBEEF 或其他一些易于区分且不太可能在程序中出现的明显模式。如果填充中的值发生更改，则将其转换为浮点数并查看该数字是否有意义作为浮点数。

静态浮动 some_values[SIZE]; 静态无符号整数填充[1024]；静态整数 * 地址；

2.  多次运行该程序。在每次运行中禁用不同的线程并查看问题何时消失。

3.  将程序进程关联设置为单个核心，然后尝试观察点。如果您没有两个线程同时修改该值，您可能会有更好的运气。注意：此解决方案并不排除这种情况的发生。它可能更容易在调试器中捕获。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T04:15:38.943

`static`变量和多线程一般不要混用。

没有看到你的代码（你应该包括你的线程代码），我的猜测是你有两个线程同时写入`addr`变量。它不起作用。

您要么需要：

*   `addr`为每个线程创建单独的实例；或者
*   提供某种同步`addr`以阻止两个线程同时更改值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T04:46:35.487

您可以尝试的一件事是创建一个单独的线程，其唯一目的是观察 的值`addr`，并在它发生变化时中断。例如：

```
static int * volatile addr;  // volatile here is important, and must be after the *
void *addr_thread_proc(void *arg)
{
    while(1)
    {
        int *old_value = addr;
        while(addr == old_value) /* spin */;
        __asm__("int3");  // break the debugger, or raise SIGTRAP if no debugger
    }
}
...
pthread_t spin_thread;
pthread_create(&spin_thread, NULL, &addr_thread_proc, NULL); 
```

然后，每当值`addr`更改时，`int3`指令就会运行，这会破坏调试器，停止所有线程。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T04:11:41.470

尝试使用 valgrind；我没有在 OS X 上尝试过 valgrind，我不明白你的问题，但是当你说“clobbered”时，我首先想到的是“try valgrind”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T04:14:37.523

gdb 在多线程程序中经常表现得很奇怪。另一个解决方案（如果你负担得起的话）是把`printf()`s 放在所有地方，试图抓住你的价值被破坏的那一刻。不是很优雅，但有时​​很有效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T02:22:13.450

我没有在 OSX 上进行任何调试，但我在 Linux 上的 GDB 中看到了相同的行为：程序崩溃，但 GDB 可以读取和写入程序刚刚尝试读取/写入失败的内存。

这并不一定意味着 GDB 很困惑；而是内核允许 GDB 通过 ptrace() 读取/写入内存，不允许下级进程读取或写入。IOW，这是一个（最近修复的）内核错误。

尽管如此，无论出于何种原因，听起来 GDB 观察点都不适合您。

您可以使用的一种技术是为它们留出`mmap`空间`some_values`而不是为它们静态分配空间，将数组安排在页面边界上*结束*，并安排下一个页面不可访问（通过`mprotect`）。

如果任何代码试图在 结束后访问`some_values`，它将得到一个异常（实际上你正在设置一个不可写的“观察点”刚刚过去`some_values`）。

# powershell - 通过 Powershell 运行时 MSBuild 失败

> ID：1005069
> 
> 赞同：2
> 
> 时间：2009-06-17T04:07:49.703
> 
> 标签：powershell, msbuild

我有一个 MSBuild 脚本，我想在部署过程中从 PowerShell 脚本调用它。如果我通过 bat 文件调用构建脚本一切正常。如果我在 PowerShell 中执行完全相同的操作，则会出现 CS1668 错误，正在寻找我的机器上不存在的奇怪而美妙的路径。我知道我正在进入 MSBuild 脚本，因为这些错误发生在 MSBuild 脚本目标中（日志输出显示了这一点）。bat 文件和 PowerShell 脚本位于同一位置，紧邻构建脚本。

错误：

> 错误 CS1668：警告为错误：“LIB 环境变量”中指定的搜索路径“C:\Program Files\Microsoft Visual Studio 8\VC\AtlMfc\Lib”无效——“系统找不到指定的路径。'错误CS1668：警告错误：'LIB 环境变量'中指定的搜索路径'C:\Program Files\Microsoft Visual Studio 8\VC\PlatformSDK\Lib'--'系统找不到指定的路径。'

我已经检查并且这些路径中的任何一条都不存在于我的机器上。为什么从 PowerShell 运行会改变 MSBuild 查找的路径？

提前致谢

RhysC

编辑-在代码中添加：注意 MSBuild 脚本的名称是 AutomatedDebug.build POWERSHELL SCRIPT：

```
#Begining of script
$CurrentPath = Split-Path (Split-Path $myinvocation.mycommand.path )
#Assign the Build script paths. 1 is for building and testsing, 1 is for deployment (to keep things clean)
$MSBuildScriptBuildAndTestPath = $CurrentPath + "\Tools\AutomatedDebug.build"
$MSBuildScriptDeployPath = $CurrentPath + "\Tools\Deploy.build"

#Run the automated build with tests
Write-Host "*** Run the automated build with tests ***" 
C:\Windows\Microsoft.NET\Framework\v3.5\MSbuild.exe $MSBuildScriptBuildAndTestPath "/t:AllTests" "/l:FileLogger,Microsoft.Build.Engine;logfile=AllTests.log"
if($LastExitCode -ne 0)
{
    throw "AllTests failed"
}
Write-Host "*** FINISHED: Run the automated build with tests ***" 
```

蝙蝠档案

```
@C:\Windows\Microsoft.NET\Framework\v3.5\MSbuild.exe AutomatedDebug.build /t:AllTests /l:FileLogger,Microsoft.Build.Engine;logfile="AllTests.log"
@pause
enter code here 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T07:33:40.970

好的，实际发生的事情是我在很多个月前下载了 Powershell 社区扩展（[http://pscx.codeplex.com](http://pscx.codeplex.com)），并且其中有一个 Environment.VisualStudio2005.ps1 文件，其中添加了不存在的 EnvVar。这是（我假设）因为我不使用 VS2005。我已经对此发表了评论，一切都很好。我试图寻找 2008 年的等价物，但运气太差了。老实说，我没有充分发挥 powershell 的潜力，所以我怀疑我什至需要在我的机器上安装 PSCX。

谢谢大家帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T05:03:19.497

我想知道，基本上你在这里得到“警告为错误”。您可以尝试关闭将警告视为错误（我的意思是，有一个不存在的库路径对我来说听起来并不*那么*糟糕），或者您可以让您的脚本打印出相应的环境变量（分别使用`echo %LIB%`和`$Env:LIB`）从脚本中寻找差异。

但是，由于默认情况下 VS 的 envvars 没有全局设置（这就是为什么有三个 Visual Studio 命令提示符），所以您必须在某处设置所有变量。如果您在脚本中执行此操作，您可能在某处有错字？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T04:26:28.427

这很可能是由于您将参数传递到 MSBuild 脚本的方式。CMD 和 PowerShell 之间存在一些关键参数解析差异，通过使用批处理文件，您隐式使用 CMD 的参数解析引擎将参数传递给 MSBuild。如果您发布您正在使用的命令行，这里的 PowerShell 专家之一可能可以帮助调试参数混淆的地方。

# c++ - Linux 上来自共享对象 (.so) 的异常

> ID：1005072
> 
> 赞同：4
> 
> 时间：2009-06-17T04:10:13.870
> 
> 标签：c++, linux, exception, g++, shared-objects

我有一个名为 ftest 的测试程序。它加载包含测试的 .so 文件并运行它在其中找到的测试。其中一个测试加载并运行一个 .so，其中包含用于我们的 O/RM 的 Postgres 数据库驱动程序。

当 Postgres 驱动程序抛出在该 .so 文件中定义的异常（或它链接到但 ftest 未链接到的文件）并被测试框架捕获时，异常析构函数会触发段错误。

只要编译的异常位于已动态加载（使用 dload）的 .so 中，就会发生此段错误。

这种事情在具有相同架构的 Windows 中运行良好。我们真的不想限制自己只使用来自核心库的异常——插件应该可以自由地创建自己的异常类并正常处理它们。

异常是 std::exception 的子类。有时异常可能在库中定义（例如 libpqxx），这意味着异常有时也超出了我们的控制范围。

使用以下内容引发异常：

```
throw exception_class( exception_arguments ); 
```

并被使用：

```
catch ( std::exception &e ) {
    // handler code
} 
```

是否需要一些特殊的编译器选项才能使其正常工作？我们是否需要通过切换来抛出异常`throw new exception_class( args )`（我们真的不想这样做）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T08:26:20.223

假设您使用 gcc -

在构建调用 dlload() 的可执行文件时附加 -Wl,-E。这会从可执行文件中导出所有类型信息符号，这应该允许 RTTI（捕获异常时）正常工作。

VC++ 使用字符串比较来匹配 typeinfo，导致 dynamic_cast<> 等更慢但二进制文件更小。g++ 使用指针比较。

我在尝试使用在运行时加载的.so 中实现的纯虚拟接口类时遇到了同样的问题。

网上也有一些与该主题相关的文章。

希望有帮助，海曼。

# java - 在一行中初始化 ArrayList

> ID：1005073
> 
> 赞同：3087
> 
> 时间：2009-06-17T04:10:20.000
> 
> 标签：java, collections, arraylist, initialization

我想创建一个用于测试目的的选项列表。起初，我是这样做的：

```
ArrayList<String> places = new ArrayList<String>();
places.add("Buenos Aires");
places.add("Córdoba");
places.add("La Plata"); 
```

然后，我将代码重构如下：

```
ArrayList<String> places = new ArrayList<String>(
    Arrays.asList("Buenos Aires", "Córdoba", "La Plata")); 
```

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：2432
> 
> 时间：2009-06-17T04:15:06.243

如果您只是将其声明为`List`- 它必须是 ArrayList 吗？

```
List<String> places = Arrays.asList("Buenos Aires", "Córdoba", "La Plata"); 
```

或者，如果您只有一个元素：

```
List<String> places = Collections.singletonList("Buenos Aires"); 
```

这意味着它`places`是**不可变**的（试图改变它会导致`UnsupportedOperationException`抛出异常）。

要创建一个具体的可变列表，`ArrayList`您可以`ArrayList`从不可变列表创建一个：

```
ArrayList<String> places = new ArrayList<>(Arrays.asList("Buenos Aires", "Córdoba", "La Plata")); 
```

* * *

## 回答 #2

> 赞同：2193
> 
> 时间：2009-06-17T04:13:36.023

实际上，初始化的“最佳”方法可能`ArrayList`是您编写的方法，因为它不需要以`List`任何方式创建新方法：

```
ArrayList<String> list = new ArrayList<String>();
list.add("A");
list.add("B");
list.add("C"); 
```

需要注意的是，要引用该`list`实例需要进行大量输入。

还有其他选择，例如使用实例初始化器创建匿名内部类（也称为“双括号初始化”）：

```
ArrayList<String> list = new ArrayList<String>() {{
    add("A");
    add("B");
    add("C");
}}; 
```

但是，我不太喜欢这种方法，因为您最终得到的是一个`ArrayList`具有实例初始化程序的子类，并且创建该类只是为了创建一个对象——这对我来说似乎有点矫枉过正。

如果[项目 Coin的](http://openjdk.java.net/projects/coin)[Collection Literals 提案](http://mail.openjdk.java.net/pipermail/coin-dev/2009-March/001193.html)被接受，那将是一件好事（它计划在 Java 7 中引入，但它也不太可能成为 Java 8 的一部分。）：

```
List<String> list = ["A", "B", "C"]; 
```

不幸的是，它在这里对您没有帮助，因为它将初始化一个不可变的`List`而不是一个`ArrayList`，而且，它还不可用，如果有的话。

* * *

## 回答 #3

> 赞同：1036
> 
> 时间：2010-09-09T12:33:15.437

# 简单的答案

## Java 9 或更高版本：

```
List<String> strings = List.of("foo", "bar", "baz"); 
```

这会给你一个*不可变* `List`的，所以它不能改变。
在大多数情况下，这是您预填充它时想要的。

## Java 8 或更早版本：

```
List<String> strings = Arrays.asList("foo", "bar", "baz"); 
```

这将为您提供一个由数组支持的`List`^*，因此它不能更改长度。
但是你可以调用`List.set(...)`，所以它仍然是*可变*的。

^(* [实现细节：它是一个内部的私有嵌套类`java.util.Arrays`，命名为`ArrayList`，
与 不同的类`java.util.ArrayList`，尽管它们的简单名称相同。])

### 静态导入

您可以使用静态导入使 Java 8`Arrays.asList`更短：

```
import static java.util.Arrays.asList;  
...
List<String> strings = asList("foo", "bar", "baz"); 
```

任何现代 IDE ^*都会建议并为您执行此操作。

我不建议将`List.of`方法静态导入 just `of`，因为它很混乱。

^(* [例如，在 IntelliJ IDEA 中，您按下`Alt+Enter`并选择`Static import method...`])

# 使用`Stream`_

为什么它必须是一个`List`？
使用 Java 8 或更高版本，您可以使用`Stream`更灵活的 a：

```
Stream<String> strings = Stream.of("foo", "bar", "baz"); 
```

您可以连接`Stream`s：

```
Stream<String> strings = Stream.concat(Stream.of("foo", "bar"),
                                       Stream.of("baz", "qux")); 
```

或者您可以从 a`Stream`转到 a `List`：

```
import static java.util.stream.Collectors.toList;
...
var strings = Stream.of("foo", "bar", "baz").toList(); // Java 16

List<String> strings = Stream.of("foo", "bar", "baz").collect(toList()); // Java 8 
```

但最好只使用`Stream`而不将其收集到`List`.

# 如果您特别需要`java.util.ArrayList`^*

如果您想预先填充一个*并**在*之后添加到它，请使用`ArrayList`

 *```
List<String> strings = new ArrayList<>(List.of("foo", "bar"));
strings.add("baz"); 
```

或在 Java 8 或更早版本中：

```
List<String> strings = new ArrayList<>(asList("foo", "bar"));
strings.add("baz"); 
```

或使用`Stream`：

```
import static java.util.stream.Collectors.toCollection;

List<String> strings = Stream.of("foo", "bar")
                             .collect(toCollection(ArrayList::new));
strings.add("baz"); 
```

但同样，最好`Stream`直接使用而不是将其收集到`List`.

^(*[您可能不需要专门的`ArrayList`. 引用[JEP 269](http://openjdk.java.net/jeps/269)：])

> [有一**小**部分用例用于使用一组预定义的值初始化可变集合实例。通常最好将这些预定义值放在不可变集合中，然后通过复制构造函数初始化可变集合。]

[（强调我的）]

## 编程接口，而不是实现

您说您已在代码中将列表声明为 an `ArrayList`，但仅当您使用的某些成员`ArrayList`不在`List`.

您很可能不会这样做。

通常，您应该只通过您将要使用的最通用接口（例如`Iterable`，`Collection`或）声明变量，并使用特定实现（例如，或）`List`初始化它们。`ArrayList``LinkedList``Arrays.asList()`

否则，您会将代码限制为该特定类型，并且在您想要更改时会更难。

例如，如果您将 an 传递`ArrayList`给 a `void method(...)`：

```
// Iterable if you just need iteration, for (String s : strings):
void method(Iterable<String> strings) { 
    for (String s : strings) { ... } 
}

// Collection if you also need .size(), .isEmpty(), or .stream():
void method(Collection<String> strings) {
    if (!strings.isEmpty()) { strings.stream()... }
}

// List if you also need random access, .get(index):
void method(List<String> strings) {
    strings.get(...)
}

// Don't declare a specific list implementation
// unless you're sure you need it:
void method(ArrayList<String> strings) {
    ??? // You don't want to limit yourself to just ArrayList
} 
```

另一个例子是总是声明变量 an，`InputStream`即使它通常是 a`FileInputStream`或 a `BufferedInputStream`，因为有一天你或其他人会想要使用其他类型的`InputStream`。

* * *

## 回答 #4

> 赞同：119
> 
> 时间：2011-08-30T04:33:05.330

如果您需要大小为 1 的简单列表：

```
List<String> strings = new ArrayList<String>(Collections.singletonList("A")); 
```

如果您需要多个对象的列表：

```
List<String> strings = new ArrayList<String>();
Collections.addAll(strings,"A","B","C","D"); 
```

* * *

## 回答 #5

> 赞同：62
> 
> 时间：2013-07-29T13:24:44.797

使用[Guava](https://en.wikipedia.org/wiki/Google_Guava)，您可以编写：

```
ArrayList<String> places = Lists.newArrayList("Buenos Aires", "Córdoba", "La Plata"); 
```

在 Guava 中还有其他有用的静态构造函数。[您可以在此处](https://github.com/google/guava/wiki/CollectionUtilitiesExplained)阅读有关它们的信息。

* * *

## 回答 #6

> 赞同：44
> 
> 时间：2017-02-02T17:36:24.513

使用[java-9](/questions/tagged/java-9 "显示标记为“java-9”的问题")及更高版本，如[JEP 269: Convenience Factory Methods for Collections](http://openjdk.java.net/jeps/269)中所建议的那样，现在可以使用*集合文字*来实现-

```
List<String> list = List.of("A", "B", "C");

Set<String> set = Set.of("A", "B", "C"); 
```

类似的方法也适用于`Map`-

```
Map<String, String> map = Map.of("k1", "v1", "k2", "v2", "k3", "v3") 
```

这类似于@coobird 所述的Collection Literals[提案](http://mail.openjdk.java.net/pipermail/coin-dev/2009-March/001193.html)。JEP中也进一步澄清了 -

* * *

**备择方案**

> 语言更改已多次考虑，并被拒绝：
> 
> [项目代币提案，2009 年 3 月 29 日](http://mail.openjdk.java.net/pipermail/coin-dev/2009-March/001112.html)
> 
> [项目代币提案，2009 年 3 月 30 日](http://mail.openjdk.java.net/pipermail/coin-dev/2009-March/001193.html)
> 
> [JEP 186 关于 lambda-dev 的讨论，2014 年 1 月至 3 月](http://mail.openjdk.java.net/pipermail/lambda-dev/2014-January/011671.html)
> 
> 语言提案被搁置，优先于本[信息中总结的基于库的提案。](http://mail.openjdk.java.net/pipermail/lambda-dev/2014-March/011938.html)

相关：[Java 9 中集合的重载便利工厂方法有什么意义](https://stackoverflow.com/questions/41918934/what-is-the-point-of-overloaded-convenience-factory-methods-for-collections-in-j/41918976#41918976)

* * *

## 回答 #7

> 赞同：34
> 
> 时间：2014-04-03T23:21:48.067

集合文字没有进入 Java 8，但可以使用 Stream API 在一行相当长的行中初始化一个列表：

```
List<String> places = Stream.of("Buenos Aires", "Córdoba", "La Plata").collect(Collectors.toList()); 
```

如果您需要确保您`List`是`ArrayList`：

```
ArrayList<String> places = Stream.of("Buenos Aires", "Córdoba", "La Plata").collect(Collectors.toCollection(ArrayList::new)); 
```

* * *

## 回答 #8

> 赞同：32
> 
> 时间：2010-05-12T13:14:16.830

```
import com.google.common.collect.ImmutableList;

....

List<String> places = ImmutableList.of("Buenos Aires", "Córdoba", "La Plata"); 
```

* * *

## 回答 #9

> 赞同：25
> 
> 时间：2010-05-04T00:57:54.097

您可以创建一个工厂方法：

```
public static ArrayList<String> createArrayList(String ... elements) {
  ArrayList<String> list = new ArrayList<String>();
  for (String element : elements) {
    list.add(element);
  }
  return list;
}

....

ArrayList<String> places = createArrayList(
  "São Paulo", "Rio de Janeiro", "Brasília"); 
```

但这并不比您的第一次重构好多少。

为了获得更大的灵活性，它可以是通用的：

```
public static <T> ArrayList<T> createArrayList(T ... elements) {
  ArrayList<T> list = new ArrayList<T>();
  for (T element : elements) {
    list.add(element);
  }
  return list;
} 
```

* * *

## 回答 #10

> 赞同：15
> 
> 时间：2017-10-06T01:16:10.983

`ArrayList`在 Java 9 中，我们可以在一行中轻松地初始化一个：

```
List<String> places = List.of("Buenos Aires", "Córdoba", "La Plata"); 
```

或者

```
List<String> places = new ArrayList<>(List.of("Buenos Aires", "Córdoba", "La Plata")); 
```

Java 9 的这种新方法与以前的方法相比具有许多优点：

1.  [空间效率](https://docs.oracle.com/javase/9/core/creating-immutable-lists-sets-and-maps.htm#JSCOR-GUID-6A9BAE41-A1AD-4AA1-AF1A-A8FC99A14199)
2.  [不变性](https://docs.oracle.com/javase/9/core/creating-immutable-lists-sets-and-maps.htm#JSCOR-GUID-4F3E2B7D-CE90-4862-A78A-414FC08DA6E4)
3.  [线程安全](https://docs.oracle.com/javase/9/core/creating-immutable-lists-sets-and-maps.htm#JSCOR-GUID-DD066F67-9C9B-444E-A3CB-820503735951)

有关更多详细信息，请参阅这篇文章 -> *[List.of 和 A​​rrays.asList 有什么区别？](https://stackoverflow.com/questions/46579074/what-is-the-difference-between-list-of-and-arrays-aslist)*

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2013-09-21T09:43:07.897

只需使用以下代码，如下所示。

```
List<String> list = new ArrayList<String>() {{
            add("A");
            add("B");
            add("C");
}}; 
```

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2014-12-15T11:44:15.160

最紧凑的方法是：

```
Double array[] = { 1.0, 2.0, 3.0};
List<Double> list = Arrays.asList(array); 
```

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2015-01-28T01:30:35.263

使用[Eclipse Collections](https://www.eclipse.org/collections/)，您可以编写以下内容：

```
List<String> list = Lists.mutable.with("Buenos Aires", "Córdoba", "La Plata"); 
```

您还可以更具体地了解类型以及它们是可变的还是不可变的。

```
MutableList<String> mList = Lists.mutable.with("Buenos Aires", "Córdoba", "La Plata");
ImmutableList<String> iList = Lists.immutable.with("Buenos Aires", "Córdoba", "La Plata"); 
```

你也可以对 Sets 和 Bags 做同样的事情：

```
Set<String> set = Sets.mutable.with("Buenos Aires", "Córdoba", "La Plata");
MutableSet<String> mSet = Sets.mutable.with("Buenos Aires", "Córdoba", "La Plata");
ImmutableSet<String> iSet = Sets.immutable.with("Buenos Aires", "Córdoba", "La Plata");

Bag<String> bag = Bags.mutable.with("Buenos Aires", "Córdoba", "La Plata");
MutableBag<String> mBag = Bags.mutable.with("Buenos Aires", "Córdoba", "La Plata");
ImmutableBag<String> iBag = Bags.immutable.with("Buenos Aires", "Córdoba", "La Plata"); 
```

**注意：**我是 Eclipse Collections 的提交者。

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2013-06-06T05:44:26.987

（应该是评论，但太长了，所以新回复）。正如其他人所提到的，该`Arrays.asList`方法是固定大小的，但这不是唯一的问题。它也不能很好地处理继承。例如，假设您有以下内容：

```
class A{}
class B extends A{}

public List<A> getAList(){
    return Arrays.asList(new B());
} 
```

以上会导致编译器错误，因为`List<B>`（Arrays.asList 返回的内容）不是 的子类`List<A>`，即使您可以将 B 类型的对象添加到`List<A>`对象。要解决此问题，您需要执行以下操作：

```
new ArrayList<A>(Arrays.<A>asList(b1, b2, b3)) 
```

这可能是最好的方法，尤其是。如果您需要一个无界列表或需要使用继承。

* * *

## 回答 #15

> 赞同：7
> 
> 时间：2017-02-28T22:50:54.430

这是另一种方式：

```
List<String> values = Stream.of("One", "Two").collect(Collectors.toList()); 
```

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2017-03-28T20:18:03.327

您可以使用以下语句：

### 代码片段：

```
String [] arr = {"Sharlock", "Homes", "Watson"};

List<String> names = Arrays.asList(arr); 
```

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2013-06-17T17:57:24.853

就像[汤姆说的](https://stackoverflow.com/a/1005089/1031312)：

```
List<String> places = Arrays.asList("Buenos Aires", "Córdoba", "La Plata"); 
```

但是既然你抱怨想要一个 ArrayList，你首先应该知道 ArrayList 是 List 的一个子类，你可以简单地添加这一行：

```
ArrayList<String> myPlaces = new ArrayList(places); 
```

虽然，这可能会让你抱怨“性能”。

在那种情况下，这对我来说没有意义，为什么，因为你的列表是预定义的，它没有被定义为一个数组（因为在初始化时大小是已知的）。如果这是您的选择：

```
String[] places = {"Buenos Aires", "Córdoba", "La Plata"}; 
```

如果您不关心细微的性能差异，那么您也可以非常简单地将数组复制到 ArrayList：

```
ArrayList<String> myPlaces = new ArrayList(Arrays.asList(places)); 
```

好的，但是将来您需要的不仅仅是地名，还需要国家代码。假设这仍然是一个在运行时永远不会更改的预定义列表，那么使用`enum`集合是合适的，如果将来需要更改列表，则需要重新编译。

```
enum Places {BUENOS_AIRES, CORDOBA, LA_PLATA} 
```

会成为：

```
enum Places {
    BUENOS_AIRES("Buenos Aires",123),
    CORDOBA("Córdoba",456),
    LA_PLATA("La Plata",789);

    String name;
    int code;
    Places(String name, int code) {
      this.name=name;
      this.code=code;
    }
} 
```

枚举有一个静态`values`方法，该方法返回一个数组，其中包含枚举的所有值，按声明的顺序排列，例如：

```
for (Places p:Places.values()) {
    System.out.printf("The place %s has code %d%n",
                  p.name, p.code);
} 
```

在那种情况下，我猜你不需要你的 ArrayList。

PS [Randyaa 演示](https://stackoverflow.com/a/7238739/1031312)了另一种使用静态实用程序方法[Collections.addAll](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Collections.html)的好方法。

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2016-12-06T09:57:49.613

Java 9 有以下方法来创建*不可变*列表：

```
List<String> places = List.of("Buenos Aires", "Córdoba", "La Plata"); 
```

如果需要，它很容易适应创建一个可变列表：

```
List<String> places = new ArrayList<>(List.of("Buenos Aires", "Córdoba", "La Plata")); 
```

类似的方法可用于`Set`和`Map`。

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2014-06-22T08:12:31.383

```
List<String> names = Arrays.asList("2","@2234","21","11"); 
```

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2016-09-13T05:54:55.537

是的，在 Arrays 的帮助下，您可以在一行中初始化数组列表，

```
List<String> strlist= Arrays.asList("aaa", "bbb", "ccc"); 
```

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2017-06-25T17:48:17.560

您可以`StickyList`从[Cactoos](http://www.cactoos.org)使用：

```
List<String> names = new StickyList<>(
  "Scott Fitzgerald", "Fyodor Dostoyevsky"
); 
```

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2016-05-16T13:45:01.610

试试这个代码行：

```
Collections.singletonList(provider) 
```

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2021-05-19T11:35:46.280

使用 `Arrays.asList("Buenos Aires", "Córdoba", "La Plata");`是正确的。但是任何`Arrays.asList()`带有零参数或只有一个参数的调用都可以替换为调用`Collections.singletonList()`或`Collections.emptyList()`将节省一些内存。

注意：返回的列表`Collections.singletonList()`是不可变的，而返回的列表`Arrays.asList()`允许调用 set() 方法。在极少数情况下，这可能会破坏代码。

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2012-02-13T21:47:34.907

在Java中，你不能这样做

```
ArrayList<String> places = new ArrayList<String>( Arrays.asList("Buenos Aires", "Córdoba", "La Plata")); 
```

正如所指出的，您需要进行双括号初始化：

```
List<String> places = new ArrayList<String>() {{ add("x"); add("y"); }}; 
```

但这可能会迫使您添加注释`@SuppressWarnings("serial")`或生成令人讨厌的串行 UUID。此外，大多数代码格式化程序会将其展开为多个语句/行。

或者你可以做

```
List<String> places = Arrays.asList(new String[] {"x", "y" }); 
```

但是你可能想做一个`@SuppressWarnings("unchecked")`.

同样根据javadoc，您应该能够做到这一点：

```
List<String> stooges = Arrays.asList("Larry", "Moe", "Curly"); 
```

但我无法让它与 JDK 1.6 一起编译。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2015-04-03T09:30:38.747

```
Collections.singletonList(messageBody) 
```

如果您需要**一个项目**的列表！

*Collections*来自*java.util*包。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2016-07-17T18:31:11.010

最好的方法：

```
package main_package;

import java.util.ArrayList;

public class Stackkkk {
    public static void main(String[] args) {
        ArrayList<Object> list = new ArrayList<Object>();
        add(list, "1", "2", "3", "4", "5", "6");
        System.out.println("I added " + list.size() + " element in one line");
    }

    public static void add(ArrayList<Object> list,Object...objects){
        for(Object object:objects)
            list.add(object);
    }
} 
```

只需创建一个可以包含任意数量元素的函数，然后调用它以将它们添加到一行中。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2016-11-28T19:56:37.233

这是[AbacusUtil的代码](https://github.com/landawn/AbacusUtil)

```
// ArrayList
List<String> list = N.asList("Buenos Aires", "Córdoba", "La Plata");
// HashSet
Set<String> set = N.asSet("Buenos Aires", "Córdoba", "La Plata");
// HashMap
Map<String, Integer> map = N.asMap("Buenos Aires", 1, "Córdoba", 2, "La Plata", 3);

// Or for Immutable List/Set/Map
ImmutableList.of("Buenos Aires", "Córdoba", "La Plata");
ImmutableSet.of("Buenos Aires", "Córdoba", "La Plata");
ImmutableSet.of("Buenos Aires", 1, "Córdoba", 2, "La Plata", 3);

// The most efficient way, which is similar with Arrays.asList(...) in JDK. 
// but returns a flexible-size list backed by the specified array.
List<String> set = Array.asList("Buenos Aires", "Córdoba", "La Plata"); 
```

声明：我是AbacusUtil的开发者。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2014-12-07T05:37:12.533

对我来说 Arrays.asList() 是最好和方便的。我总是喜欢这样初始化。如果您是 Java 集合的初学者，那么我希望您参考[ArrayList 初始化](http://www.gitarani.com/classified.htm?classifiedId=3011)

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2017-12-04T11:23:08.107

为什么不做一个简单的实用函数呢？

```
static <A> ArrayList<A> ll(A... a) {
  ArrayList l = new ArrayList(a.length);
  for (A x : a) l.add(x);
  return l;
} 
```

“ `ll`”代表“文字列表”。

```
ArrayList<String> places = ll("Buenos Aires", "Córdoba", "La Plata"); 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2019-10-04T15:04:11.563

**有趣的是，没有列出具有其他重载方法**的单行代码*`Stream::collect`*

 **```
ArrayList<String> places = Stream.of( "Buenos Aires", "Córdoba", "La Plata" ).collect( ArrayList::new, ArrayList::add, ArrayList::addAll ); 
```

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2022-02-13T05:55:56.587

最简单的方法：您可以使用这种方法将多个元素添加到任何类型的集合中，例如 ArrayList 和 HashSet

```
ArrayList<String> allViews = new ArrayList<String>();
Collections.addAll(allViews,"hello","world","abc","def","ghi"); 
```

* * *

## 回答 #32

> 赞同：-1
> 
> 时间：2013-06-02T13:34:17.930

实际上，可以在一行中完成：

```
Arrays.asList(new MyClass[] {new MyClass("arg1"), new MyClass("arg2")}) 
```

* * *

## 回答 #33

> 赞同：-5
> 
> 时间：2012-07-31T13:22:58.980

```
public static <T> List<T> asList(T... a) {
    return new ArrayList<T>(a);
} 
```

这是 的实现`Arrays.asList`，因此您可以使用

```
ArrayList<String> arr = (ArrayList<String>) Arrays.asList("1", "2"); 
```***

# plugins - 开发 Wiki 的有效扩展

> ID：1005080
> 
> 赞同：3
> 
> 时间：2009-06-17T04:12:22.827
> 
> 标签：plugins, mediawiki, wiki

我们由 3-4 名开发人员组成的小型团队使用 wiki 进行文档编制和协作。我正在尝试整理一些可靠的扩展列表，这将有助于使它变得更好。我们正在使用 MediaWiki，但如果您知道另一个平台的好扩展/插件，我也想听听。谢谢。

到目前为止，这是我的清单：

*   [Geshi](http://qbnz.com/highlighter/)用于语法高亮。
*   FCK编辑器
*   标记为类别

对 MediaWiki 1.15.0 不起作用的有希望的扩展

*   分类编辑
*   问题跟踪器

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T04:31:12.420

想到两件事：

*   错误跟踪工具集成
*   单片机工具集成

对于 MediaWiki，已经有

Bugzilla 集成：

*   [http://www.mediawiki.org/wiki/Extension:BugzillaReports](http://www.mediawiki.org/wiki/Extension:BugzillaReports)

SVN 集成：

*   [http://www.mediawiki.org/wiki/Extension:SVNIntegration](http://www.mediawiki.org/wiki/Extension:SVNIntegration)

完整的扩展列表在[这里](http://www.mediawiki.org/wiki/Extension_Matrix)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T04:33:50.047

好吧，我认为一个很好的起点是检查我们在[mediawiki.org](http://mediawiki.org)上使用的内容，因为这是一个开发 Wiki :)

我的第一选择当然是[CodeReview](http://www.mediawiki.org/wiki/Extension:CodeReview)。它不漂亮，但它非常有用。看看[我们如何使用它](http://www.mediawiki.org/wiki/Special:Code/MediaWiki)：它允许将 SVN 集成到 wiki 中，添加对代码的评论，标记提交，并在其上放置状态。在 MediaWiki，我们使用 new/verified/ok 链，当出现问题时添加 fixme/reverted/resolved/deferred；但您可以在这里自由使用自己的状态。

# static - 静态 Web 服务优于非静态

> ID：1005082
> 
> 赞同：1
> 
> 时间：2009-06-17T04:13:02.903
> 
> 标签：static, non-static

目前我有一个 Web 服务 (WCF)，它公开设置为静态的方法。

从严格的内存/GC 角度来看，CLR 和 GC 处理静态对象和非静态对象的方式有何不同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T04:25:10.237

在包含的 AppDomain 关闭之前，不会对静态数据进行垃圾收集；通常这意味着内存将一直分配到应用程序关闭，除非您正在执行某种特殊的 AppDomain 管理。非静态对象将由垃圾收集器按照正常规则收集 - 不再有引用，并且每当 GC 运行时。

# sql - SQL Round 函数不起作用，有什么想法吗？

> ID：1005095
> 
> 赞同：4
> 
> 时间：2009-06-17T04:17:12.203
> 
> 标签：sql, sql-server, rounding

这是 SELECT 语句：

```
SELECT ROUND(ISNULL(SUM(Price),0),2) As TotalPrice
FROM Inventory
WHERE (DateAdded BETWEEN @StartDate AND @EndDate) 
```

关于为什么不四舍五入到小数点后两位的任何想法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-17T04:25:07.227

而不是`ROUND(ISNULL(SUM(Price),0),2)` 你可以尝试`CAST(ISNULL(SUM(PRICE),0) AS DECIMAL (4,2))`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T04:25:08.367

价格是什么数据类型？

[BOL 中的 ROUND](http://msdn.microsoft.com/en-us/library/ms175003.aspx)

```
SELECT ROUND(123.4545, 2); -- = 123.4500
GO
SELECT ROUND(123.45, -2);  -- = 100,00
GO 
```

底层数据类型保持不变：您只需四舍五入但留下尾随零。

对于 2 个小数位*输出*，您需要 CAST to decimal(x, 2)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T04:33:37.957

您的环境中的列可能存在编组问题。可能会尝试显式强制转换 CAST(ROUND(...) AS NUMERIC(18,4)) 甚至只是尝试将 0 设为 0.0。还要确保在应用程序中将列与正确的数据类型绑定。

所有酷的人都使用 COALESCE 而不是 ISNULL。COALESCE 是可移植的，您可以拥有任意数量的参数（不仅仅是两个！！）

无论如何，我不确定这是否只是一个示例，但如果在此阶段尚未四舍五入，您的数据也可能存在 DA 问题。

# javascript - 在Javascript中转义双连字符？

> ID：1005108
> 
> 赞同：4
> 
> 时间：2009-06-17T04:23:05.043
> 
> 标签：javascript, iis, url

我有一个 Javascript 小书签，单击它时，会将用户重定向到新网页，并提供旧网页的 URL 作为查询字符串中的参数。

`page--1--of--3.html`当原始网页的 URL 中有双连字符（例如）时，我遇到了问题。愚蠢，我知道 - 我无法控制原始页面`escape`我正在使用的 javascript 函数不会转义连字符，如果要求服务，IIS 6 会给出文件未找到错误`resource.aspx?original=page--1--of--3.html`

我可以使用替代的 javascript 转义函数吗？解决此问题的最佳方法是什么？有人知道为什么 IIS 会阻塞`resource.aspx?original=page--1`而不是阻塞`page-1`吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T05:22:48.100

不推荐使用“escape”和“unes​​cape”，因为它不编码所有相关字符。 **不要使用 ESCAPE 或 UNESCAPE**。改用“encodeURIComponent”和“decodeURIComponent”。除最古老的最破旧的浏览器外，所有浏览器都支持。这种知识并不常见，这真是一个巨大的耻辱。

（另见 encodeURI 和 decodeURI）

编辑：错误刚刚测试过，但这并没有真正涵盖双连字符。对不起。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T04:30:12.637

您可以使用一些自定义逻辑扩展转义功能以手动编码 hypen 吗？

```
resource.aspx?original=page%2d%2d1%2d%2dof%2d%2d3.html 
```

像这样的东西：

```
function customEscape(url) {
    url = escape(url);
    url = url.replace(/-/g, '%2d');
    return url;
}

location.href = customEscape("resource.axd?original=test--page.html"); 
```

**更新，对于书签：**

```
<a href="javascript:location.href=escape('resource.axd?original=test--page.html').replace(/-/g, '%2d')">Link</a> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T04:32:10.517

你做错了其他事情。-- 在 URL 和文件名中是合法的。也许文件真的没有找到？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T04:55:20.300

-- 用于注释一些脚本语言中的文本。SQL Server 使用它来添加注释。您是否使用任何数据库逻辑来存储这些文件名？或者创建此名称是查询字符串的一部分而不是使用查询参数的任何查询？

# algorithm - 无论大小如何，都可以使用什么算法来识别图像是否“相同”或相似？

> ID：1005115
> 
> 赞同：40
> 
> 时间：2009-06-17T04:26:03.297
> 
> 标签：algorithm, image-processing, computer-vision

[TinEye](http://tineye.com/)，“反向图片搜索引擎”，允许你上传/链接到一个图片，它能够搜索它已经抓取的十亿张图片，它会返回它找到的相同图片的链接。

但是，它不是一个简单的校验和或与之相关的任何东西。它通常能够找到比您提供的原始图像更高分辨率和更低分辨率以及更大和更小的尺寸的图像。这是该服务的一个很好的用途，因为我经常找到一张图像并想要它的最高分辨率版本。

不仅如此，我还让它找到了相同图像集的图像，其中图像中的人处于不同的位置，但背景基本保持不变。

[TinEye](http://tineye.com/)可以使用什么类型的算法，使其能够将图像与其他不同大小和压缩比的图像进行比较，但仍能准确地确定它们是“相同”图像或集合？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-06-17T05:01:19.547

这些算法通常是基于指纹的。指纹是一种相当小的数据结构，类似于长哈希码。然而，指纹函数的目标与哈希函数的目标相反。一个好的散列函数应该为非常相似（但不相等）的对象生成非常不同的代码。相反，指纹函数应该为相似的图像生成相同的指纹。

举个例子，这是一个（不是特别好的）指纹功能：将图片大小调整为 32x32 正方形，标准化和量化颜色，将颜色数量减少到 256 种。然后，你有 1024 字节的指纹为图像。只需保留一张指纹表 => [图像 URL 列表]。当您需要查看与给定图像相似的图像时，只需计算其指纹值并找到相应的图像列表即可。简单的。

不容易——要在实践中有用，指纹函数需要对裁剪、仿射变换、对比度变化等具有鲁棒性。构建良好的指纹函数是一个单独的研究课题。很多时候，它们是手动调整的并使用大量启发式方法（即使用有关典型照片内容、图像格式/EXIF 中的附加数据等的知识）

另一种变化是使用多个指纹功能，尝试应用它们中的每一个并组合结果。实际上，它类似于查找相似的文本。图像相似性搜索不是使用“词袋”，而是使用“指纹袋”并查找一个袋子中的多少元素与另一个袋子中的元素相同。如何使这种搜索高效是另一个话题。

现在，关于文章/论文。我找不到可以概述不同方法的好文章。我知道的大多数公开文章都讨论了对特定方法的特定改进。我可以建议检查这些：

[“使用小波的内容指纹识别”](http://www.mangolassi.org/covell/pubs/cvmp_BalujaCovell.A4color.pdf)。本文是关于使用小波的音频指纹识别，但同样的方法也适用于图像指纹识别。

[排列分组：音频和图像检索的智能哈希函数设计](http://www.esprockets.com/papers/balujaCovellIoffe.pdf)。有关位置敏感哈希的信息。

[大规模部分重复 Web 图像搜索的捆绑功能](http://research.microsoft.com/pubs/80803/CVPR_2009_bundle.pdf)。一篇非常好的文章，讨论了 SIFT 和捆绑功能以提高效率。最后还有一个不错的参考书目

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-02-06T08:11:01.610

FotoForensics 网站的创建者在此主题上发布了这篇博文，它对我非常有用，并展示了可能对您来说足够好的算法，并且比小波和特征提取需要更少的工作。

[http://www.hackerfactor.com/blog/index.php?/archives/529-Kind-of-Like-That.html](http://www.hackerfactor.com/blog/index.php?/archives/529-Kind-of-Like-That.html)

> **aHash**（也称为平均哈希或平均哈希）。这种方法将图像粉碎成灰度 8x8 图像，并根据像素值是否大于图像的平均颜色来设置散列中的 64 位。
> 
> **pHash**（也称为“感知哈希”）。该算法类似于 aHash，但使用离散余弦变换 (DCT) 并基于频率而不是颜色值进行比较。
> 
> **dHash**与 aHash 和 pHash 一样，dHash 实现起来非常简单，而且比它有任何权利要准确得多。作为一种实现，dHash 与 aHash 几乎相同，但性能要好得多。aHash 专注于平均值，pHash 评估频率模式，而 dHash 跟踪梯度。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-17T04:40:20.887

它可能基于对特征提取算法的改进，利用了尺度不变的特征。

看一眼

*   [特征提取](http://en.wikipedia.org/wiki/Feature_extraction)

*   [SIFT](http://en.wikipedia.org/wiki/Scale-invariant_feature_transform) ,[其他网站](http://www.cs.ubc.ca/~lowe/keypoints/)

或者，如果你真的很感兴趣，你可以花大约 70 美元（或者至少看看谷歌预览）

*   [特征提取和图像处理](http://www.elsevier.com/wps/find/bookdescription.cws_home/711559/description#description)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-17T12:45:20.203

[http://tineye.com/faq#how](http://tineye.com/faq#how)

基于此，[Igor Krivokon 的回答](https://stackoverflow.com/questions/1005115/what-algorithm-could-be-used-to-identify-if-images-are-the-same-or-similar-reg/1005190#1005190)似乎是对的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-17T06:17:10.493

[Hough 变换](http://en.wikipedia.org/wiki/Hough_transform)是一种非常古老的特征提取算法，你会觉得它很有趣。我怀疑这是 tinyeye 使用的东西，但它是学习特征提取的一个很好、简单的起点。

还有一些来自多伦多大学的人在[astrometry.net上关于他们工作的精彩](http://astrometry.net/biblio.html)[演讲的幻灯片](http://cosmo.nyu.edu/hogg/research/2006/09/28/astrometry_google.pdf)。他们开发了一种算法，用于将夜空的伸缩图像与星表中的位置进行匹配，以识别图像中的特征。这是一个比 tinyeye 试图解决的更具体的问题，但我希望他们谈论的许多基本思想都适用于更普遍的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T05:10:41.483

查看[这篇博](http://www.somethinkodd.com/oddthinking/2008/08/25/hashes-to-detect-resized-images/)文（不是我的），对一个非常容易理解的算法进行非常容易理解的描述，该算法的简单性似乎得到了很好的结果。它基本上将各个图片划分为一个非常粗略的网格，按红蓝绿蓝比例对网格进行排序，并检查排序是否相同。这自然只适用于彩色图像。

专业人士最有可能使用更先进的算法获得更好的结果。正如该博客的评论中所提到的，一种主要的方法似乎是小波。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-06-17T04:32:15.540

他们很可能正在做一个傅里叶变换来表征图像的复杂性，以及一个直方图来表征色度分布，并与区域分类算法配对以确保相似的复杂和彩色图像不会被错误地配对。不知道这是否是他们正在使用的东西，但似乎这样可以解决问题。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-06-17T06:31:40.097

如何将图片调整为标准的小尺寸并检查 SSIM 或仅亮度 PSNR 值？这就是我要做的。

# python - Python 2.6 中的 ctypes 帮助

> ID：1005117
> 
> 赞同：1
> 
> 时间：2009-06-17T04:26:50.160
> 
> 标签：python, ctypes

我似乎无法让这段代码工作，我的印象是我做对了。

```
from ctypes import *

kernel32 = windll.kernel32

string1 = "test"
string2 = "test2"

kernel32.MessageBox(None,
                       string1,
                       string2,
                       MB_OK) 
```

** 我尝试按照下面的建议将其更改为 MessageBoxA ** ** 我得到错误 :: **

```
Traceback (most recent call last):
  File "C:\<string>", line 6, in <module>
  File "C:\Python26\Lib\ctypes\__init__.py", line 366, in __getattr__
    func = self.__getitem__(name)
  File "C:\Python26\Lib\ctypes\__init__.py", line 371, in __getitem__
    func = self._FuncPtr((name_or_ordinal, self))
AttributeError: function 'MessageBoxA' not found 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T04:32:48.813

MessageBox 是在 user32 而不是 kernel32 中定义的，你也没有定义 MB_OK 所以改用它

```
windll.user32.MessageBoxA(None, string1, string2, 1) 
```

另外我建议使用[python win32 API](http://python.net/crew/mhammond/win32/Downloads.html)而不是它，因为它具有所有常量和命名函数

编辑：我的意思是用这个

```
from ctypes import *

kernel32 = windll.kernel32

string1 = "test"
string2 = "test2"

#kernel32.MessageBox(None, string1, string2, MB_OK)
windll.user32.MessageBoxA(None, string1, string2, 1) 
```

你可以使用 win32 api 做同样的事情

```
import win32gui
win32gui.MessageBox(0, "a", "b", 1) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T06:49:59.490

哦，任何时候你对调用是否需要 kernel32 或 user32 或类似的东西感到困惑。不要害怕在 MSDN 上寻找电话。他们有一个[按字母顺序排列的列表](http://msdn.microsoft.com/en-us/library/aa383688(VS.85).aspx)和一个基于[类别](http://msdn.microsoft.com/en-us/library/aa383686(VS.85).aspx)的列表。希望您发现它们对您有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T04:31:21.983

问题是您尝试调用的函数实际上并未命名`MessageBox()`。有两个函数，named`MessageBoxA()`和`MessageBoxW()`：前者采用 8 位 ANSI 字符串，后者采用 16 位 Unicode（宽字符）字符串。在 C 中，预处理器符号`MessageBox`是`#define`d`MessageBoxA`或`MessageBoxW`，这取决于是否启用了 Unicode（特别是，如果`_UNICODE`定义了符号）。

其次，根据[`MessageBox()`文档](http://msdn.microsoft.com/en-us/library/ms645505(VS.85).aspx)，`MessageBoxA/W`位于`user32.dll`，而不是`kernel32.dll`.

试试这个（我无法验证它，因为我现在不在 Windows 框前）：

```
user32 = windll.user32
user32.MessageBoxA(None, string1, string2, MB_OK) 
```

# jquery - JQuery Ajax 调用被解析到当前控制器文件夹，而不是根文件夹

> ID：1005122
> 
> 赞同：2
> 
> 时间：2009-06-17T04:29:23.013
> 
> 标签：jquery, asp.net-mvc

我想我在 JQuery 和 ASP.NET MVC 中发现了一些很奇怪的东西。

正如[这个问题](https://stackoverflow.com/questions/1004899/jquery-ajax-call-gives-404-resource-not-found-error-but-normal-url-call-is-fine)中提到的，我有以下 JQuery 代码：

```
$(function () {
    $("#username").click(function () {
        $.getJSON("ViewRecord/GetSoftwareChoice", { username: '123' },
            function (data) {
                alert(data);
            });
    });
}); 
```

`ViewRecord`是控制器，`GetSoftwareChoice`是动作方法。但是为此生成的 URl 是

```
http://localhost/ViewRecord/ViewRecord/GetSoftwareChoice?username=123 
```

相当惊人，不是吗？

为什么会这样？

这是我的路线：

```
routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

routes.MapRoute(
    "Default",                                              // Route name
    "{controller}/{action}/{id}",                           // URL with parameters
    new { controller = "Home", action = "Index", id = "" }  // Parameter defaults
); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-17T04:39:33.600

如果没有前导斜杠，则 URL 的路径是本地路径，并且相对于页面的路径进行解析。就像您可能放入 HTML 中的任何其他 URL 一样。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T04:36:03.180

尝试将其用作您的 URL：

```
 $.getJSON("/ViewRecord/GetSoftwareChoice", // etc 
```

请注意前缀正斜杠。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T04:38:41.277

jQuery 对 MVC、控制器或动作一无所知。你告诉它：“这是一个相对 URL - 获取当前页面的 URL 并将相对 URL 附加到它。” 你可能想说这样的话：

```
var newURL = "http://" + document.domain + "/ViewRecord/GetSoftwareChoice"; 
```

# c# - Crystal Report 中的重复行

> ID：1005124
> 
> 赞同：1
> 
> 时间：2009-06-17T04:30:26.680
> 
> 标签：c#, .net, mysql, crystal-reports

我正在使用 MySQL 连接器和 C#。一切都很好，直到我进入报告部分。没有将数据从 MySQL 检索到 CrystalReport 的标准方法。所以我在这个页面中读到我必须做的是在 MySQL 中创建的视图的 XML 文件，然后检索 Crystal Report 的数据。我不知道你是否已经这样做了，但我遇到了这个问题。

当我将信息放在详细信息部分或将信息分组时，信息会重复，这让我发疯。你知道为什么吗？

PD 我不能放任何代码，因为一切都是在水晶报表的 UI 中完成的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T06:10:05.327

我明白了，我认为这是使用 XML 文件然后将其调用到 CrytalReport 的混乱，这里的解决方案：

[http://writer.zoho.com/public/13706/27397](http://writer.zoho.com/public/13706/27397)

使用 mysql odbc 驱动程序在 Crystal Reports 内的数据库专家中建立新连接。

# c# - 从 Web 应用程序错误更新 Active Directory

> ID：1005129
> 
> 赞同：0
> 
> 时间：2009-06-17T04:31:32.543
> 
> 标签：c#, asp.net, security, active-directory

我在基于 Web 的应用程序中收到错误消息，该应用程序允许公司 Intranet 用户更新其活动目录详细信息（电话号码等）。

Web 应用程序托管在运行 Windows Server 2003 (SP1) 的 IIS6 上。IIS 网站正在使用 NTLM 身份验证，并且该网站已启用集成安全性。IIS 应用程序池使用“网络服务”帐户运行。

web.config 包含以下元素

```
<LdapConfigurations server="xxx.internal" root="OU=Staff Accounts,DC=xxx,DC=internal" domain="xxx" />
<identify impersonate=”true” /> 
```

不需要 Active Directory 委派，因为以下 C# (.NET 3.5) 代码应将正确的模拟详细信息（包括安全令牌）传递到 Active Directory。

```
public void UpdateData(string bus, string bus2, string fax, string home, string home2, string mob, string pager, string notes)
{
    WindowsIdentity windId = (WindowsIdentity)HttpContext.Current.User.Identity;
    WindowsImpersonationContext ctx = null;

    try
    {
        ctx = windId.Impersonate();

        DirectorySearcher ds = new DirectorySearcher();
        DirectoryEntry de = new DirectoryEntry();

        ds.Filter = m_LdapUserFilter;

        // i think this is the line causing the error
        de.Path = ds.FindOne().Path;

        this.AssignPropertyValue(bus, ADProperties.Business, ref de);
        this.AssignPropertyValue(bus2, ADProperties.Business2, ref de);
        this.AssignPropertyValue(fax, ADProperties.Fax, ref de);
        this.AssignPropertyValue(home, ADProperties.Home, ref de);
        this.AssignPropertyValue(home2, ADProperties.Home2, ref de);
        this.AssignPropertyValue(mob, ADProperties.Mobile, ref de);
        this.AssignPropertyValue(pager, ADProperties.Pager, ref de);
        this.AssignPropertyValue(notes, ADProperties.Notes, ref de);

        // this may also be causing the error?
        de.CommitChanges();
    }
    finally
    {
        if (ctx != null) 
        {
            ctx.Undo();
        }
    }
}

private void AssignPropertyValue(string number, string propertyName, ref  DirectoryEntry de)
{
    if (number.Length == 0 && de.Properties[propertyName].Value != null)
    {
        de.Properties[propertyName].Remove(de.Properties[propertyName].Value);
    }
    else if (number.Length != 0)
    {
        de.Properties[propertyName].Value = number;
    }
} 
```

可以毫无问题地从 Active Directory 中检索用户详细信息，但是在更新用户 AD 详细信息时会出现问题。将显示以下异常消息。

```
 System.Runtime.InteropServices.COMException (0x80072020): An operations error occurred. 
       at System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail) 
       at System.DirectoryServices.DirectoryEntry.Bind() 
       at System.DirectoryServices.DirectoryEntry.get_AdsObject() 
       at System.DirectoryServices.DirectorySearcher.FindAll(Boolean findMoreThanOne) 
       at System.DirectoryServices.DirectorySearcher.FindOne()    
       at xxx.UpdateData(String bus, String bus2, String fax, String home, String home2, String mob, String pager, String notes) 
       at xxx._Default.btnUpdate_Click(Object sender, EventArgs e) 
```

该代码在我们的开发域中运行良好，但在我们的生产域中却不行。任何人都可以帮助解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T05:18:06.467

这很可能是一个权限问题 - 这里有很多关于模拟和委托及其变幻莫测的文章：http: [//support.microsoft.com/default.aspx](http://support.microsoft.com/default.aspx?scid=kb;en-us;329986) ?scid=kb;en-us;329986和这里：[http ://support.microsoft.com/default.aspx?scid=kb;en-us;810572](http://support.microsoft.com/default.aspx?scid=kb;en-us;810572)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T05:25:37.363

听起来您可能有重复的 SPN 问题？

这就是为什么我认为这可能是一个问题：

1.  它适用于您的开发环境（假设它也使用网络服务，并且在同一个域上）
2.  您已在您的网络配置中模拟。
3.  当存在重复的 SPN 时，它会使安全令牌无效，因此即使您已在代码中正确创建它，AD 也不会“信任”该服务器来模拟，因此接收请求以对 AD 进行更改的服务器（在您的 DC 的）收到请求但随后将其丢弃，因为尚未在 AD 中的计算机帐户上应用 Delagation 权限，或 SPN 问题（重复或不正确的计算机名称/域名）

或者至少在我的经验中，这是问题的 10 次中的 9 次。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T05:30:53.143

我想问题在于它适用于开发环境，因为当您在那里启动您的 web 应用程序时，您使用您可能有权写入 AD 的个人帐户运行它。

在生产环境中，您必须确保运行您的 webapp（网络服务帐户）的进程也有权更新 AD。在我看来，这可能是问题所在，因为我曾经遇到过类似的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-05T00:26:10.827

问题不在于代码，而在于如何在域上设置服务器。由于某种原因，网络管理员没有在活动目录中选择“信任计算机以进行委派”选项。

幸运的是，问题不是“双跳”问题:)

# apache-flex - 禁用按钮栏中的单个按钮

> ID：1005145
> 
> 赞同：3
> 
> 时间：2009-06-17T04:38:36.330
> 
> 标签：apache-flex

如何在 Flex 的按钮栏中禁用单个按钮？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T22:49:51.273

这是示例应用程序。

```
<?xml version="1.0" encoding="utf-8"?>
<mx:WindowedApplication xmlns:mx="http://www.adobe.com/2006/mxml"
    creationComplete="onComplete();">
    <mx:Script>
        <![CDATA[
            import mx.controls.Button;
            private function onComplete():void {
                for ( var i:int=0; i<btns.numChildren; i++ ) {
                    if ( i == 0 || i % 2 == 0 ) {
                        Button(btns.getChildAt(i)).enabled = false;
                    }
                }
            }
        ]]>
    </mx:Script>
    <mx:LinkBar id="btns">
        <mx:dataProvider>
            <mx:ArrayCollection>
                <mx:Array>
                    <mx:Object label="Button 1" />
                    <mx:Object label="Button 2" />
                    <mx:Object label="Button 3" />
                    <mx:Object label="Button 4" />
                    <mx:Object label="Button 5" />
                    <mx:Object label="Button 6" />
                </mx:Array>
            </mx:ArrayCollection>
        </mx:dataProvider>
    </mx:LinkBar>
</mx:WindowedApplication> 
```

基本上，您可以使用访问单个按钮

```
libkBarInst.getChildAt(n) 
```

这给了你一个按钮。希望有帮助。

# c# - 有没有办法从具有内部构造函数的类派生？

> ID：1005149
> 
> 赞同：11
> 
> 时间：2009-06-17T04:39:10.607
> 
> 标签：c#, constructor, design-patterns

我正在使用具有许多出色方法和属性的 3rd 方 c# 类 - 但随着时间的推移，我需要使用我自己的方法和属性来扩展该类。如果是我的代码，我会将该类用作我的基类，并在顶部添加我自己的属性和方法——但是这个类有一个内部构造函数。（在我看来，首先将构造函数放在内部是很短的——为什么要限制子类化的能力？）

我唯一能想到的就是在我的类上创建方法/属性，这些方法/属性只是简单地调用他们的类——但这是大量的代码，而且，它只是“感觉”不正确。

有没有办法使用这个类作为基类？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T05:17:41.477

你问：“为什么要限制子类化的能力？”

因为为继承而设计很棘手，特别是如果您正在为其他开发人员设计从您的类继承时。正如 Josh Bloch 在 Effective Java 中所说，您应该设计继承或禁止继承。在我看来，除非你有充分的理由来设计继承，否则你不应该投机地这样做。

该类是否实现了您也可以实现的接口（可能通过将大多数调用代理回原始实例）？这里通常没有真正优雅的答案 - 最佳解决方案将取决于具体情况，包括您要添加到课程中的内容。

如果您不再添加任何状态 - 只是有效的便捷方法 - 那么扩展方法可能对您很有效。但是它们不会更改对象能够存储的数据，因此如果您需要添加自己的专用数据，那将行不通。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T05:02:48.297

听起来像是扩展方法的完美应用：

[MSDN 扩展方法文档](http://msdn.microsoft.com/en-us/library/bb383977.aspx)

“扩展方法使您能够向现有类型“添加”方法，而无需创建新的派生类型、重新编译或以其他方式修改原始类型。扩展方法是一种特殊的静态方法，但它们被称为实例方法扩展类型。对于用 C# 和 Visual Basic 编写的客户端代码，调用扩展方法和类型中实际定义的方法之间没有明显区别。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T05:08:05.870

如果该类有一个内部构造函数，并且没有公共构造函数，那么这表明设计者不打算将其子类化。在这种情况下，您可以使用封装，也可以使用扩展方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T04:51:46.107

仅当您的类与您要继承的类位于同一程序集中时。内部构造函数将抽象类的具体实现限制为定义类的程序集。不能在程序集之外实例化包含内部构造函数的类。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T09:01:49.640

Resharper 有一个很好的功能来创建委派成员。

[这](http://blog.bittercoder.com/CategoryView,category,ReSharper.aspx)是您可以使用它执行的操作的示例。这需要几秒钟。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T08:53:11.107

我不会讨论你是否可以围绕第 3 方类构建自己的 Facade。以前的作者是对的，图书馆可以以不允许这样做的方式设计。假设他们有一些耦合类具有应该按特定顺序初始化的单例或类似的东西 - 可能有很多第 3 方开发人员从不关心的设计错误（或特性），因为他们不认为你会使用他们的图书馆就是这样。

但是好吧，让我们假设构建外观不是一项不可能完成的任务，而实际上您只有一个问题 -**您必须编写包装器的方法太多**，手动执行此操作并不好。

我看到了 3 个解决方案来解决这个问题

1）我认为.NET 4.0的新“动态”类型将允许您解决该问题而无需编写“英亩代码”您应该将第3方类的实例封装到您的类中作为具有动态关键字的privare成员您类应该从 Dynamic 派生或实现 IDynamicObject 接口。您将必须实现 GetMember/SetMember 函数，将所有调用转发到 3rd 方类的封装实例

好吧，c# 4.0 是一个未来，让我们看看其他解决方案：

2) 如果您有大量公共方法（例如超过 100 个），请不要手动编写代码。我会编写一个小控制台应用程序，它使用反射并找到所有公共成员，然后自动生成代码来调用封装的实例。例如

```
public type MethodName(params)
{
   this.anInstanceOf3rdPartyClass.MethodName(params);
} 
```

3) 您可以执行与 2 相同的操作，但要借助现有的反射工具，例如 RedGate .NET Reflector。它将帮助您列出所有类和方法签名。然后，将所有这些粘贴到 Word 中，一个简单的 VB 宏将让您生成与 2 中相同的代码。 *备注：只要您不复制代码，而只复制公开可用的方法签名，我不要认为你会违反许可协议，但无论如何值得重新检查*

# ruby-on-rails - 获取在rails中测试的方法

> ID：1005150
> 
> 赞同：1
> 
> 时间：2009-06-17T04:39:26.737
> 
> 标签：ruby-on-rails, testing

我正在关注[RailsS​​pace：Michael Hartl 用 Ruby on Rails 构建社交网络网站](http://railsspace.com)。运行轨道 v2.3.2。

我已经到了介绍测试的第 5 章。以下内容应该使用 get 方法将各个页面的标题与字符串匹配：

```
require File.dirname(__FILE__) + '/../test_helper' 
require 'site_controller' 

    # Re-raise errors caught by the controller. 
    class SiteController; def rescue_action(e) raise e end; end 

    class SiteControllerTest < Test::Unit::TestCase 
      def setup 
        @controller = SiteController.new 
        @request     = ActionController::TestRequest.new 
        @response   = ActionController::TestResponse.new 
      end 

      def test_index 
        get :index
        title = assigns(:title) 
        assert_equal "Welcome to RailsSpace!", title 
        assert_response :success 
        assert_template "index" 
        end 

      def test_about 
        get :title
        title = assigns(:title) 
        assert_equal "About RailsSpace", title 
        assert_response :success 
        assert_template "about" 
      end 

      def test_help 
        get :help
        title = assigns(:title) 
        assert_equal "RailsSpace Help", title 
        assert_response :success 
        assert_template "help" 
      end 
    end 
```

在编译时我得到：

```
Loaded suite site_controller_test
Started
EEE
Finished in 0.057 seconds.

  1) Error:
test_about(SiteControllerTest):
NoMethodError: undefined method `get' for #<SiteControllerTest:0x4854b30>
    site_controller_test.rb:23:in `test_about'

  2) Error:
test_help(SiteControllerTest):
NoMethodError: undefined method `get' for #<SiteControllerTest:0x4854b1c>
    site_controller_test.rb:31:in `test_help'

  3) Error:
test_index(SiteControllerTest):
NoMethodError: undefined method `get' for #<SiteControllerTest:0x485470c>
    site_controller_test.rb:15:in `test_index'

3 tests, 0 assertions, 0 failures, 3 errors 
```

其他人也遇到过[这个问题](http://groups.google.com/group/railsspace/browse_thread/thread/2d31abab46f25f38)，唯一建议的解决方案就是重新安装。我对此并不热衷。由于这是一本较旧的书，因此这可能只是rails版本之间的损坏。对于 rails v2.3.2，这相当于什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T12:14:08.080

替换以下**所有**代码

```
# Re-raise errors caught by the controller. 
class SiteController; def rescue_action(e) raise e end; end 

class SiteControllerTest < Test::Unit::TestCase 
  def setup 
    @controller = SiteController.new 
    @request     = ActionController::TestRequest.new 
    @response   = ActionController::TestResponse.new 
  end 
```

和

```
class SiteControllerTest < ActionController::TestCase 
```

您使用的代码是指 Rails 2.0/2.1。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T06:30:30.723

尝试将 Test::Unit::TestCase 更改为 ActionController::TestCase。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T09:57:53.987

您可能想知道的另一件事是 Railspace 已经演变成[Insoshi](http://github.com/insoshi/insoshi/tree/master)，因此可以在那里获得最新的代码。当您遇到其他问题时，可能对您很方便。

# html - 自动检测移动浏览器（通过用户代理？）

> ID：1005153
> 
> 赞同：292
> 
> 时间：2009-06-17T04:40:44.100
> 
> 标签：html, windows-mobile, browser, user-agent

如何检测用户是否正在从移动网络浏览器查看我的网站，以便我可以自动检测并显示我的网站的适当版本？

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2009-10-07T22:54:38.440

[Detect Mobile Browser](http://detectmobilebrowser.com/)上有开源脚本，可以在 Apache、ASP、ColdFusion、JavaScript 和 PHP 中执行此操作。

* * *

## 回答 #2

> 赞同：91
> 
> 时间：2009-06-17T04:48:49.617

是的，阅读 User-Agent 标头就可以了。

有一些已知的移动用户代理[列表](http://www.zytrax.com/tech/web/mobile_ids.html) [，](http://en.wikipedia.org/wiki/List_of_user_agents_for_mobile_phones)因此您无需从头开始。我不得不做的是建立一个已知用户代理的数据库，并在检测到它们进行修订时存储未知数，然后手动找出它们是什么。在某些情况下，这最后一件事可能是矫枉过正。

如果您想在 Apache 级别执行此操作，您可以创建一个脚本，该脚本会定期生成一组检查用户代理的重写规则（或者只需一次并忘记新的用户代理，或者每月一次，只要适合您的情况），例如

```
RewriteEngine On

RewriteCond %{HTTP_USER_AGENT} (OneMobileUserAgent|AnotherMobileUserAgent|...)
RewriteRule (.*) mobile/$1 
```

例如，将对 http://domain/index.html 的请求移动[到](http://domain/index.html)http [://domain/mobile/index.html](http://domain/mobile/index.html)

如果您不喜欢让脚本定期重新创建 htaccess 文件的方法，您可以编写一个模块来检查用户代理（我没有找到已经制作的，但找到了这个特别合适的[示例](http://www.ddj.com/architect/184405150)）并获取用户代理从一些网站更新它们。然后，您可以根据需要使方法复杂化，但我认为在您的情况下，以前的方法会很好。

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2009-11-06T20:19:56.607

只是一个想法，但如果你从相反的方向解决这个问题呢？与其确定哪些浏览器是移动的，为什么不确定哪些浏览器不是？然后将您的网站编码为默认为移动版本并重定向到标准版本。查看移动浏览器时有两种基本可能性。它要么支持javascript，要么不支持。因此，如果浏览器不支持 javascript，它将默认为移动版本。如果确实支持 JavaScript，请检查屏幕大小。任何低于一定大小的东西也可能是移动浏览器。任何更大的东西都会被重定向到您的标准布局。然后，您需要做的就是确定禁用 JavaScript 的用户是否是移动用户。
根据 W3C 的说法，禁用 JavaScript 的用户数量约为 5%，其中大多数用户已将其关闭，这意味着他们实际上知道自己在使用浏览器做什么。他们是你的大部分观众吗？如果没有，那么不要担心他们。如果是这样，最坏的情况是什么？您让这些用户浏览您网站的移动版本，这是一件好事。

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2011-04-14T17:53:46.960

这是我在 JavaScript 中的做法：

```
function isMobile() {
  var index = navigator.appVersion.indexOf("Mobile");
  return (index > -1);
} 
```

[请参阅www.tablemaker.net/test/mobile.html](http://www.tablemaker.net/test/mobile.html)上的示例，其中将手机上的字体大小增加了三倍。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2010-05-21T17:46:11.340

我最喜欢的移动浏览器检测机制是[WURFL](http://wurfl.sourceforge.net/)。它经常更新，并且适用于每个主要的编程/语言平台。

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2011-11-26T19:03:42.390

您是否考虑过使用 css3 媒体查询？在大多数情况下，您可以专门为目标设备应用一些 css 样式，而无需创建单独的移动版网站。

```
@media screen and (max-width:1025px) {
   #content {
     width: 100%;
   }
} 
```

您可以将宽度设置为您想要的任何值，但 1025 将捕获 iPad 横向视图。

您还需要将以下元标记添加到您的头部：

```
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"> 
```

查看HTML5 Rocks 上的[这篇文章，了解一些很好的示例](http://www.html5rocks.com/en/mobile/mobifying.html#toc-media-handheld)

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2011-11-09T17:24:45.523

适用于**安卓、IPHONE、IPAD、BLACKBERRY、PALM、WINDOWS CE、PALM**

```
 <script language="javascript"> <!--
     var mobile = (/iphone|ipad|ipod|android|blackberry|mini|windows\sce|palm/i.test(navigator.userAgent.toLowerCase()));
              if (mobile) {
                  alert("MOBILE DEVICE DETECTED");
                  document.write("<b>------------------------------------------<br>")
                  document.write("<b>" + navigator.userAgent + "<br>")
                  document.write("<b>------------------------------------------<br>")
                  var userAgent = navigator.userAgent.toLowerCase();
                  if ((userAgent.search("android") > -1) && (userAgent.search("mobile") > -1))
                         document.write("<b> ANDROID MOBILE <br>")
                   else if ((userAgent.search("android") > -1) && !(userAgent.search("mobile") > -1))
                       document.write("<b> ANDROID TABLET <br>")
                   else if ((userAgent.search("blackberry") > -1))
                       document.write("<b> BLACKBERRY DEVICE <br>")
                   else if ((userAgent.search("iphone") > -1))
                       document.write("<b> IPHONE DEVICE <br>")              
                   else if ((userAgent.search("ipod") > -1))
                       document.write("<b> IPOD DEVICE <br>")
               else if ((userAgent.search("ipad") > -1))
                       document.write("<b> IPAD DEVICE <br>")
                       else
                   document.write("<b> UNKNOWN DEVICE <br>")
              }
              else
                  alert("NO MOBILE DEVICE DETECTED"); //--> </script> 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-06-17T14:46:18.397

移动设备浏览器文件是检测 ASP.NET 项目的移动（和其他）浏览器的好方法：http: [//mdbf.codeplex.com/](http://mdbf.codeplex.com/)

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2011-07-20T12:41:18.893

```
protected void Page_Load(object sender, EventArgs e)
{
    if (Request.Browser.IsMobileDevice == true)
    {
        Response.Redirect("Mobile//home.aspx");
    }
} 
```

此示例适用于 asp.net

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2013-01-01T06:14:48.733

您可以简单地通过 检测移动客户端 `navigator.userAgent`，并根据检测到的客户端类型加载备用脚本：

```
 $(document).ready(function(e) {

        if(navigator.userAgent.match(/Android/i)
          || navigator.userAgent.match(/webOS/i)
          || navigator.userAgent.match(/iPhone/i)
          || navigator.userAgent.match(/iPad/i)
          || navigator.userAgent.match(/iPod/i)
          || navigator.userAgent.match(/BlackBerry/i)
          || navigator.userAgent.match(/Windows Phone/i)) {

         //write code for your mobile clients here.

          var jsScript = document.createElement("script");
          jsScript.setAttribute("type", "text/javascript");
          jsScript.setAttribute("src", "js/alternate_js_file.js");
          document.getElementsByTagName("head")[0].appendChild(jsScript );

          var cssScript = document.createElement("link");
          cssScript.setAttribute("rel", "stylesheet");
          cssScript.setAttribute("type", "text/css");
          cssScript.setAttribute("href", "css/alternate_css_file.css");
          document.getElementsByTagName("head")[0].appendChild(cssScript); 

    }
    else{
         // write code for your desktop clients here
    }

    }); 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2010-11-14T10:56:12.213

您可以检查用户代理字符串。在 JavaScript 中，这真的很简单，它只是导航器对象的一个​​属性。

```
var useragent = navigator.userAgent; 
```

您可以检查设备是否是 JS 中的 iPhone 或 Blackberry，例如

```
var isIphone = !!agent.match(/iPhone/i),
    isBlackberry = !!agent.match(/blackberry/i); 
```

如果 isIphone 为 true，则您正在从 Iphone 访问该站点，如果 isBlackBerry 您正在从 Blackberry 访问该站点。

您可以使用 firefox 的“UserAgent Switcher”插件来测试它。

如果您也有兴趣，可能值得在这里查看我在 github 上托管的脚本**“redirection_mobile.js”** **https://github.com/sebarmeli/JS-Redirection-Mobile-Site**，您可以在其中之一中阅读更多详细信息我的文章在这里：

[http://blog.sebarmeli.com/2010/11/02/how-to-redirect-your-site-to-a-mobile-version-through-javascript/](http://blog.sebarmeli.com/2010/11/02/how-to-redirect-your-site-to-a-mobile-version-through-javascript/)

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2011-04-18T14:19:33.913

你还没有说你使用的是什么语言。如果是 Perl，那么它是微不足道的：

```
use CGI::Info;

my $info = CGI::Info->new();

if($info->is_mobile()) {
   # Add mobile stuff
}

unless($info->is_mobile()) {
   # Don't do some things on a mobile
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-06-17T04:46:42.833

是的，用户代理用于检测移动浏览器。有很多免费脚本可用于检查这一点。这是一个这样的[php 代码](http://detectmobilebrowsers.mobi/)，它可以帮助您将移动用户重定向到不同的网站。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-07-09T17:07:18.723

我将此演示与包含的脚本和示例放在一起：

[http://www.mlynn.org/2010/06/mobile-device-detection-and-redirection-with-php/](http://www.mlynn.org/2010/06/mobile-device-detection-and-redirection-with-php/)

此示例利用 php 函数进行用户代理检测，并提供额外的好处，即允许用户声明对站点版本的偏好，该版本通常不会根据他们的浏览器或设备类型作为默认版本。这是通过 cookie 完成的（在服务器端使用 php 维护，而不是 javascript。）

请务必查看文章中的下载链接以获取示例。

希望你喜欢！

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-09-15T14:37:21.323

[MobileESP](http://www.mobileesp.org/)具有 PHP、Java、APS.NET (C#)、Ruby 和 JavaScript 挂钩。它还具有 Apache 2 许可证，因此可免费用于商业用途。对我来说，关键是它只识别浏览器和平台，而不是屏幕尺寸和其他指标，这让它变得很小。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2010-11-02T16:10:33.963

有一个使用 Zend 框架的全新解决方案。从 Zend_HTTP_UserAgent 的链接开始：

[http://framework.zend.com/manual/en/zend.http.html](http://framework.zend.com/manual/en/zend.http.html)

# c# - 如何在 WHERE 子句（LINQ）中使用 DateTime？

> ID：1005154
> 
> 赞同：2
> 
> 时间：2009-06-17T04:41:07.233
> 
> 标签：c#, linq, linq-to-sql

如何添加日期是 where 子句。我正在使用以下代码。

```
 var opportunites = from opp in this.DataContext.Opportunities
                            join org in this.DataContext.Organizations on opp.OrganizationID
                            equals org.OrgnizationID
                            select new
                            {
                                org.CreatedDate,
                                org.OrganizationName
                            };
     if (createdDate != string.Empty)
         opportunites = opportunites.Where(opp => 
                            opp.CreatedDate == Convert.ToDateTime(createdDate)); 
```

但是使用此代码，我不会返回任何结果。我认为错误在于 == 运算符。

我想我应该有这样的代码

```
"where createdDate between" + createdDate + "00:00:00" + and createdDate + "23:59:59" 
```

如何在 LINQ 中归档这个东西。

有什么建议吗？？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-17T04:49:56.793

您可以只提取 DateTime 的“日期”部分，如下所示：

```
opp.CreatedDate.Date == Convert.ToDateTime(createdDate).Date 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T15:47:48.237

您可以向条件添加新日期，只需添加 86399 秒：

```
DateTime dtFechaIni = Convert.ToDateTime(filter[0]);
DateTime dtFechaEnd = Convert.ToDateTime(filter[0]).AddSeconds(86399);

var getInfo = from gI in infEnt.tb_FileManagement_RegistrosArchivo
              where gI.tb_FileManagement_Archivo.FechaArchivo > dtFechaIni &&
              gI.tb_FileManagement_Archivo.FechaArchivo < dtFechaEnd
              select gI; 
```

# php - 如何处理 AJAX 请求中的会话超时

> ID：1005155
> 
> 赞同：14
> 
> 时间：2009-06-17T04:41:26.283
> 
> 标签：php, session, error-handling, jquery

我相信你们都熟悉使用 AJAX 的投票系统（嗯...看那边 <----）

我有类似的东西，当您投票赞成或反对时，它使用 AJAX 从 votes.php 请求新值。问题是我正在使用会话来获取用户 ID，因此一个人只能投票一次。如果他们在页面上坐了一个小时然后投票所以会议不再存在会发生什么？处理这种情况的好方法是什么？我应该将他们的页面重定向到登录屏幕吗？如果是这样，我如何从 AJAX 请求引用的 votes.php 页面执行此操作？我是否忽略了处理这种情况的好方法？任何意见将是有益的。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-17T05:03:09.920

考虑返回 401 的 http 状态和详细说明原因的 JSON 对象。如果您使用的是 jQuery，那会让您进入`error()`回调，然后您可以解析您的对象。

```
$.ajax({
  data: {},
  dataType: 'html',
  success: function(data) {
    // do whatever here
  },
  type: 'POST',
  url: 'myserver.com',
  error: function(XMLHttpRequest, textStatus, errorThrown) {
    // XMLHttpRequest.responseText has your json string
    // XMLHttpRequest.status has the 401 status code
    if (XMLHttpRequest.status === 401) {
      location.href = 'login.php';
    }
  }
}); 
```

我不再熟悉 PHP，但这应该适用于几乎任何环境。不过，您*可能*必须禁止任何自动登录表单重定向。在 asp.net mvc 中，框架将看到 401 并将默认登录表单推回，状态为 200。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T05:19:41.940

您应该只在会话中存储指向用户身份的链接。使用会话将用户标识为*x*，然后从数据库中获取用户*x*的信息。

如果您的问题是用户会话超时，那么您应该重新考虑如何使用会话。也许让它们持续到浏览器关闭？如果你真的想让它们成为一个持续时间，那么可能会每隔一段时间对服务器进行 ping 操作以保持会话处于活动状态。

在您的 php 脚本中决定用户是否应该能够投票。如果会话未设置，或者他们已经投票，则返回一条您可以在客户端识别的消息。如果他们已经投票，可能会返回`"voted":"true"`一个 JSON 对象。使用 JS 解析这个对象并理解它的含义，采取适当的行动。如果未设置会话，则可能 return `"session_set":"false"`，然后使用`window.location = "login.php"`等进行 javascript 重定向。

仅在计票成功返回时为用户增加计数器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-07-04T06:38:45.900

这是一个旧线程，但我想分享我的非常有效的解决方案。

在我的框架中，每当用户尝试访问页面并且会话超时或无效时，系统都会将用户重定向到登录表单。我在登录表单的顶部添加了以下 html 注释：

```
<!--LOGINFORM--> 
```

我为 jQuery 的 $.ajax 函数创建了一个包装器，它在每个请求上检查这个字符串，如果它在那里，它会显示一个对话框弹出窗口，说他们的会话已经超时。

你可以通过调用来使用它：

```
ajax.get('http://someurl.com', function(data){
    //Do stuff
}); 
```

希望它可以帮助某人。

```
var ajax = {
    check_login : function(resp){
        if (resp.substring(0, 16) === "<!--LOGINFORM-->"){
            // Show a popup or redirect them to login page!
            return true;
        }
        return false;
    },
    get : function(url, success){       
        if (typeof data =='undefined'){
            data = null;
        }

        $.ajax({
            url: url,
            type : 'GET',
            success : function(resp){
                if (!ajax.check_login(resp)) {
                    success(resp);
                }
            },
        });
    }   
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T04:43:55.220

您构建了使 Ajax 请求接受特殊结果的 Javascript 代码（例如，通常`-1`是`>=0`数字的位置，例如投票计数），以表示“抱歉，您超时了”并重定向到重新-登录页面（它可以作为可选参数向用户解释他们超时的消息，&c）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T06:53:48.733

您可以创建一个 javascript 函数，该函数可以通过类似的方式每 10 分钟 ping 一次服务器

```
setTimeout("Ping()", 60000); 
```

如果您想在用户连接错误会话时将用户导航到登录页面，那么我将首先验证会话，如果失败则发送

```
header("Location: ..."); 
```

[http://ca2.php.net/manual/en/function.header.php](http://ca2.php.net/manual/en/function.header.php)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T12:26:44.997

从用户的角度来看，最好的解决方案是弹出一条消息和登录表单，例如“您未登录或会话超时”之类的内容。Digg 在这方面做得很好。

至于实际的 AJAX 实现，swilliams 的 401 建议是可靠的。或者，您可以简单地在失败时返回特定字符串。

# javascript - 如何将我的网页插入 iframe？

> ID：1005159
> 
> 赞同：0
> 
> 时间：2009-06-17T04:45:14.940
> 
> 标签：javascript, html, iframe

我有一个为客户托管的网页。该页面上有客户的页眉和页脚，我们的内容（一个 Flash 应用程序）放在中间。

客户现在想为我们提供一个 html 页面，其中包含他们的页眉、页脚和一些广告，所有这些都在一个文档中。他们希望我们将此文档作为 iframe 包含在内，然后将我们的内容动态放置在该框架内。

这对我来说似乎很hacky，但我想我会试一试。那么将我的标记放入 iframe 的最佳方式是什么？

谢谢！克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T06:31:53.280

由于 XSS 安全问题，无法在客户端完成......除非它们都在同一个域中，但根据您的描述，我对此表示怀疑。

服务器端，您可以动态读取目标页面，以任何您希望的方式对其进行修改，然后呈现它。如果您确实需要在 iframe 中使用它，您可以动态加载通过以下方式获得的修改后的源代码：

```
<html>
<head></head>
<body>
<iframe id="blah"></iframe>
<script>
var doc=document.getElementById("blah").contentDocument;
doc.open();
doc.write("content");
doc.close();
</script>
</body>
</html> 
```

请记住，还要使用完整的 URL 更改任何链接、图像等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T06:57:47.917

你能为他们提供一些他们可以使用的 API - 这样他们就可以在他们的页面中放置一些东西来调用你的位。当您使用 Flash 时，您可以通过包含策略文件以授予其域的权限来避免跨站点脚本问题。

# vb.net - 如何在 VB.NET 中获取 ASCII 字符串的长度（即字符数）？

> ID：1005164
> 
> 赞同：0
> 
> 时间：2009-06-17T04:47:11.803
> 
> 标签：vb.net, string, ascii, tcpclient

我正在使用此代码从 tcpclient 返回一些字符串，但是当字符串返回时，它有一个前导`"`字符。我正在尝试删除它，但该`Len()`函数正在读取字节数而不是字符串本身。我怎样才能改变它来给我通常使用它的字符串的长度，而不是字符串本身的数组的长度？

```
 Dim bytes(tcpClient.ReceiveBufferSize) As Byte
 networkStream.Read(bytes, 0, CInt(tcpClient.ReceiveBufferSize))

 ' Output the data received from the host to the console.'
 Dim returndata As String = Encoding.ASCII.GetString(bytes)

 Dim LL As Int32 = Len(returndata) 
```

`Len()`报告字节数而不是字符串中的字符数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T05:30:06.670

您的代码目前有些损坏。答案是，无论您*实际*`tcpClient.ReceiveBufferSize`收到多少数据- 因为您忽略了来自. 它可能只返回几个字节，但无论如何您都在使用数组的其余部分创建一个字符串。*始终*检查 的返回值，否则您不知道实际读取了多少数据。您应该执行以下操作：*`networkStream.Read``bytes`*`Stream.Read`**

 **```
Dim bytesRead = networkStream.Read(bytes, 0, CInt(tcpClient.ReceiveBufferSize))

' Output the data received from the host to the console.'
Dim returndata As String = Encoding.ASCII.GetString(bytes, 0, bytesRead) 
```

现在，ASCII 每个字节总是有一个字符（反之亦然），因此字符串的长度将与您收到的数据的长度完全相同。

请注意，任何非 ASCII 数据（即超过 127 的任何字节）都将转换为“？” 由`Encoding.ASCII.GetString`. 您还可以获得控制字符。这绝对是ASCII文本数据开始吗？如果不是，我建议对其进行十六进制编码或使用其他选项以无损方式转储确切的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T04:52:30.990

您可以尝试在对 Len() 的调用中修剪字符串：

```
Dim LL As Int32 = Len(returndata.Trim()) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T05:09:14.030

如果 Len 报告的字节数和字符数不匹配，那么我可以想到两种可能：

*   发送的字符比您想象的要多（即，实际上正在发送额外的字符）

*   编码不是 ASCII，因此每个字符可以有多个字节（其中之一是“奇怪”字符，即正在发送的字符不是“错误数据”）。尝试找出数据是否真的是 ASCII 编码的，如果不是，则相应地更改调用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T05:09:54.263

当我没看错时，你会在开头得到一个单引号，对吧？

如果你一直得到那个，为什么不从字符串长度中减去一个呢？或者使用第二个字符的子字符串：

```
Len(returndata.Substring(1) 
```

而且我不太明白您所说的»字符串的长度，因为我通常会使用它，而不是字符串本身的数组的长度«。你有一个字符串。任何可能在内部表示该字符串的数组都完全依赖于实现，您不应该看到或依赖任何内容。或者我在这里误会你了。该字符串*是*您通常使用的字符串。我的意思是，如果这不是你所做的，那么为什么不把字符串的长度*处理*成你通常使用的东西呢？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T05:24:34.540

也许我在这里遗漏了一些东西，但是有什么问题[`String.Length`](http://msdn.microsoft.com/en-us/library/system.string.length.aspx)？

```
Dim LL As Int32 = returndata.Length 
```**

# delphi - 为 Delphi 翻译 Vista WinAPI C++ 标头 - 有什么建议吗？

> ID：1005165
> 
> 赞同：3
> 
> 时间：2009-06-17T04:47:14.847
> 
> 标签：delphi, winapi, api, windows-vista, translation

我需要从我的 Delphi 应用程序中调用 Vista 中引入的 Windows API 函数，但我没有任何描述该函数的 Delphi 标头。

相关函数已记录在 JEDI Windows API 库中，但没有此函数。

我的 C++ 几乎不存在，我正在努力找出与函数相对应的 Delphi 定义，以及 MSDN 上记录的参数。

来自[http://msdn.microsoft.com/en-us/library/aa814417.aspx](http://msdn.microsoft.com/en-us/library/aa814417.aspx)

```
NETIOAPI_API GetIpInterfaceEntry(__inout  PMIB_IPINTERFACE_ROW Row);

typedef struct _MIB_IPINTERFACE_ROW {
  ADDRESS_FAMILY                 Family;
  NET_LUID                       InterfaceLuid;
  NET_IFINDEX                    InterfaceIndex;
  ULONG                          MaxReassemblySize;
  ULONG64                        InterfaceIdentifier;
  ULONG                          MinRouterAdvertisementInterval;
  ULONG                          MaxRouterAdvertisementInterval;
  BOOLEAN                        AdvertisingEnabled;
  BOOLEAN                        ForwardingEnabled;
  BOOLEAN                        WeakHostSend;
  BOOLEAN                        WeakHostReceive;
  BOOLEAN                        UseAutomaticMetric;
  BOOLEAN                        UseNeighborUnreachabilityDetection;
  BOOLEAN                        ManagedAddressConfigurationSupported;
  BOOLEAN                        OtherStatefulConfigurationSupported;
  BOOLEAN                        AdvertiseDefaultRoute;
  NL_ROUTER_DISCOVERY_BEHAVIOR   RouterDiscoveryBehavior;
  ULONG                          DadTransmits;
  ULONG                          BaseReachableTime;
  ULONG                          RetransmitTime;
  ULONG                          PathMtuDiscoveryTimeout;
  NL_LINK_LOCAL_ADDRESS_BEHAVIOR LinkLocalAddressBehavior;
  ULONG                          LinkLocalAddressTimeout;
  ULONG                          ZoneIndices[ScopeLevelCount];
  ULONG                          SitePrefixLength;
  ULONG                          Metric;
  ULONG                          NlMtu;
  BOOLEAN                        Connected;
  BOOLEAN                        SupportsWakeUpPatterns;
  BOOLEAN                        SupportsNeighborDiscovery;
  BOOLEAN                        SupportsRouterDiscovery;
  ULONG                          ReachableTime;
  NL_INTERFACE_OFFLOAD_ROD       TransmitOffload;
  NL_INTERFACE_OFFLOAD_ROD       ReceiveOffload;
  BOOLEAN                        DisableDefaultRoutes;
}MIB_IPINTERFACE_ROW, *PMIB_IPINTERFACE_ROW; 
```

在其他位中，我正在努力解决的位是 ZoneIndices[ScopeLevelCount] 字段；我无法计算出数组应该是什么大小。

这是我到目前为止所定义的，尽管我还没有计算出原始 C++ 定义中的枚举。我将在 Vista 上显式加载 Windows DLL 并获取要调用的新函数的地址。

```
type
  PMIB_IPINTERFACE_ROW = ^MIB_IPINTERFACE_ROW;
  {$EXTERNALSYM PMIB_IPINTERFACE_ROW}
  _MIB_IPINTERFACE_ROW = record
    Family: ADDRESS_FAMILY;
    InterfaceLuid: NET_LUID;
    InterfaceIndex: NET_IFINDEX;
    MaxReassemblySize,
    InterfaceIdentifier,
    MinRouterAdvertisementInterval,
    MaxRouterAdvertisementInterval: Cardinal;
    AdvertisingEnabled,
    ForwardingEnabled,
    WeakHostSend,
    WeakHostReceive,
    UseAutomaticMetric,
    UseNeighborUnreachabilityDetection,
    ManagedAddressConfigurationSupported,
    OtherStatefulConfigurationSupported,
    AdvertiseDefaultRoute: LongBool;
    RouterDiscoveryBehavior: NL_ROUTER_DISCOVERY_BEHAVIOR;
    DadTransmits,
    BaseReachableTime,
    RetransmitTime,
    PathMtuDiscoveryTimeout: Cardinal;
    LinkLocalAddressBehavior: NL_LINK_LOCAL_ADDRESS_BEHAVIOR;
    LinkLocalAddressTimeout,
    ZoneIndices[ScopeLevelCount],
    SitePrefixLength,
    Metric,
    NlMtu: Cardinal;
    Connected,
    SupportsWakeUpPatterns,
    SupportsNeighborDiscovery,
    SupportsRouterDiscovery: LongBool;
    ReachableTime: Cardinal;
    TransmitOffload: NL_INTERFACE_OFFLOAD_ROD;
    ReceiveOffload: NL_INTERFACE_OFFLOAD_ROD;
    DisableDefaultRoutes: LongBool;
  end;
  {$EXTERNALSYM _MIB_IPINTERFACE_ROW}
  MIB_IPINTERFACE_ROW = _MIB_IPINTERFACE_ROW;
  {$EXTERNALSYM MIB_IPINTERFACE_ROW}
  TMibIpInterfaceRow = MIB_IPINTERFACE_ROW;
  PMibIpInterfaceRow = PMIB_IPINTERFACE_ROW;

const
  iphlpapilib = 'iphlpapi.dll';

var
  HIpHlpApi: THandle = 0;
  GetIpInterfaceEntry: function(const pArpEntry: MIB_IPINTERFACE_ROW): LongInt; stdcall;
  {$EXTERNALSYM GetIpInterfaceEntry} 
```

有没有人有翻译这样的函数定义的建议或提示/技巧？

非常感谢，

康纳

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T13:47:13.930

Win32 的`BOOLEAN`类型是一字节，而 Delphi 的`LongBool`类型是四。改用德尔福的`ByteBool`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T12:39:51.320

我经常使用[Dr. Bob 的 Header Converter](ftp://ftp.delphi-jedi.org/darth/HeadConv.zip)来完成这项任务，但大多数情况下我采用了手动执行转换的漫长而乏味的方式，因为它有助于我更好地理解 API。（因为我要使用它，无论如何我必须熟悉它）

另见这篇文章： http: [//www.delphi-jedi.org/api-howto.html](http://www.delphi-jedi.org/api-howto.html)

一般来说，最好不要对标头转换工具寄予太大希望，因为 C++ 是一种非常强大和复杂的语言。我测试的大多数转换工具只支持 C++ 的一个子集及其预处理器，因此必须手动修复生成的源代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T07:13:41.197

也许你可以试试“C 2 pas”

*   [http://cc.embarcadero.com/Item/26951](http://cc.embarcadero.com/Item/26951)

还发现了这些工具：

*   [http://www.drbob42.com/delphi/headconv.htm](http://www.drbob42.com/delphi/headconv.htm)
*   [http://rvelthuis.de/programs/convertpack.html](http://rvelthuis.de/programs/convertpack.html)
*   [http://rvelthuis.de/articles/articles-convert.html#cconvs](http://rvelthuis.de/articles/articles-convert.html#cconvs)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T05:08:43.203

唔。一个奇怪的结构。但是如果您查看 w2def.h，您可以看到 ScopeLevelCount=16。所以你的数组应该有 16 个元素，

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T13:00:59.860

确保在定义记录时使用打包命令，因为默认情况下 Delphi 在 2、4 或 8 字节边界上对齐复杂数据类型。

```
TExample = record 
 f1: Integer;   // start at offset 0x00
 f2: Char;      // start at offset 0x04 
 f3: Integer;   // start at offset 0x06 or 0x08 depending on alignment
end;

TExample = packed record // this is what c++ would do
 f1: Integer;   // start at offset 0x00
 f2: Char;      // start at offset 0x04 
 f3: Integer;   // start at offset 0x05
end; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-17T20:10:07.710

ZoneIndices 数组应该这样定义：

```
ZoneIndices : array [0..ScopeLevelCount - 1] of Cardinal; 
```

`ScopeLevelCount`是一个常数，即 16

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-18T08:12:25.993

我在翻译中没有看到任何 ULONG64 类型的字段，但我在原文中看到了。

此外，FPC 还有一个适用于结构的标头转换器。通常情况下，windows api 结构是打包好的。

有疑问，使用一些免费的 msvc 产品来编写 sizeof(structure) 并在 pascal 下做同样的事情。如果匹配，并且您仍然有疑问，请使用一些指针魔术计算字段偏移量并进行比较。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-17T09:02:21.337

您可以调查一些已翻译的与该主题相关的 API/结构并自行转换。例如[这个](https://stackoverflow.com/questions/576538/delphi-how-to-get-all-local-ips)

# memory-management - Lua 垃圾回收表，嵌套表

> ID：1005169
> 
> 赞同：3
> 
> 时间：2009-06-17T04:48:14.220
> 
> 标签：memory-management, lua, lua-table

[我已经阅读了 Lua 手册，但它没有提供可靠的答案。]

假设我有一个 Lua 表，充当索引数组：

```
local myArray = {};
myArray[1] = "Foo";
myArray[2] = "Bar"; 
```

我如何最好地处置这张桌子？我只是将 myArray 设置为 nil 吗？还是我必须遍历数组并将每个索引元素设置为零？

同样，假设我有一个 Lua 表，充当字典：

```
local myDictionary = {};
myDictionary["key1"] = "Foo";
myDictionary["key2"] = "Bar"; 
```

我可以将'myDictionary'设置为零，还是必须遍历？

最后，在内存管理方面，我在哪里嵌套了表，我该怎么办？例如

```
local myNestedCollection = {};
myNestedCollection[1] = {1, 2, 3};
myNestedCollection[2] = {4, 5, 6}; 
```

我是否需要遍历每个子表，将它们设置为 nil？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T04:55:03.203

只需将局部变量设置为`nil`;就足够了 无需遍历所有键并将它们设置`nil`为。根据[this page](http://lua-users.org/wiki/GarbageCollectionTutorial)，Lua 使用标记和清除垃圾收集算法。一旦将局部变量设置为`nil`，其表中的键就变得不可访问，因此它们将在下一次收集时被垃圾收集器收集。同样，如果这些对象也是表，它们的键也将变得不可访问，因此它们也将被收集。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-17T04:55:53.313

在大多数 GC 中，当没有对它的引用时，将收集一个对象。将引用链的顶部设置为 nil 会删除对子项的引用。如果这是唯一的参考，那么将收集孩子。

# delphi - Delphi 窗体拖动锁定

> ID：1005180
> 
> 赞同：0
> 
> 时间：2009-06-17T04:52:34.797
> 
> 标签：delphi, firefox, forms, mouse, drag

制作一个 Delphi 2007 应用程序，TForm 作为主窗口。运行应用程序。尝试使用标题栏拖动表单。调试器显示出无穷无尽的错误消息流，抱怨它找不到一些未命名的例程。Escape and Break 不起作用。三指敬礼不起作用。单击其他窗口，然后返回 Delphi 应用程序会停止大量错误消息，并允许应用程序在其原始位置运行（表单本身没有移动）。

奇怪的是，有时我在使用 Firefox 时遇到过相关行为——单击浏览器窗口不起作用，直到我单击某个非 Firefox 窗口，之后浏览器窗口再次处于活动状态。

有人看到相关行为吗？建议？会不会是鼠标驱动的问题？带 ALPS 触摸板鼠标的东芝笔记本电脑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T23:57:26.270

这听起来与 Delphi 无关。“错误消息流，抱怨找不到一些未命名的例程”听起来很奇怪。请您发布一两条实际消息好吗？

与此同时，我的猜测是某种形式的钩子或注入代码。尝试寻找执行此类操作的程序并一一禁用它们：

*   鼠标驱动程序（如上面的海报所说）
*   防病毒软件，尤其是诺顿等“大公司”
*   一些显示驱动程序“增强”实用程序
*   如果您有两个屏幕并且正在运行第二个任务栏程序，请尝试

等等。

可能也值得进行病毒扫描，你永远不知道:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T06:57:14.640

我知道在 Delphi 中启动 Delphi 项目时存在 Logitech 驱动程序挂钩问题：它在 .dpr 的第一行给出了异常。在德尔福之外它工作正常。

那么您是否仅在 Delphi 中遇到这些异常/问题？什么样的错误/异常？

# python - 在Django模型中设置blank=True时如何区分需要null=True的字段？

> ID：1005187
> 
> 赞同：2
> 
> 时间：2009-06-17T04:57:32.360
> 
> 标签：python, django, django-models

当设置了 blank=True 选项时，某些模型字段（例如 DateTimeField）需要 null=True 选项。

我想知道哪些字段需要（可能取决于后端 DBMS），并且有任何方法可以自动执行此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T05:09:16.527

null=True 用于告诉 DB 值可以为 NULL blank=True 仅适用于 django ，因此如果字段为空，则 django 不会引发错误，例如在管理界面中，所以 blank=True 与 DB NULL 要求无关因数据库而异，由您决定是否需要某些列 NULL

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T05:13:44.633

[这篇文章](http://www.b-list.org/weblog/2006/jun/28/django-tips-difference-between-blank-and-null/)应该有助于理解Django`blank`和`null`Django 中的区别

# ios - 在 ObjectiveC 中调用超类方法的时机重要吗？

> ID：1005196
> 
> 赞同：6
> 
> 时间：2009-06-17T05:04:35.110
> 
> 标签：ios, objective-c, iphone, oop, cocoa-touch

我首先还是最后调用超类的方法有关系吗？例如

```
-(void)didReceiveMemoryWarning {
   /* do a bunch of stuff */

   [super didReceiveMemoryWarning];
} 
```

相对

```
-(void)didReceiveMemoryWarning {
   [super didReceiveMemoryWarning];

   /* do a bunch of stuff */
} 
```

对于 viewWillAppear、willRotateToInterfaceOrientation 等其他方法也有同样的问题。

我正在寻找有意义的差异，而不仅仅是风格上或哲学上的差异（尽管也欢迎这些差异）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T05:06:57.153

这取决于功能，您要么想在超类完成它的事情之后或之前做一些事情。

例如，如果超类包含一些 UI 元素并且您扩展它并且您的类将包含更多 UI 元素。要获得适合整个对象的大小，您可能会调用超类来计算其元素的大小，然后将添加的元素的大小添加到该大小。

否则就没有意义了——超类不知道你的元素，所以它会覆盖你的计算。同样，这取决于实施。

在特定情况下，您需要调用 super 方法作为最后一件事：

```
-(void)dealloc
{
    ...
    [super dealloc];
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-17T18:58:01.440

典型的 Cocoa 约定：

1.  如果您正在执行设置，请调用 super FIRST
2.  如果您正在执行拆卸，请调用 super LAST

因此，初始化、viewDidLoad 等属于第一种情况。内存警告、viewDidUnload 和 dealloc 属于第二种情况。

你还应该设计你的类来遵循这个约定。任何偏差都应特别注明。

相关的答案：

[`[super viewDidLoad]` 约定](https://stackoverflow.com/questions/844195/super-viewdidload-convention/844305#844305)

* * *

补充：在设置过程中首先调用 super 的基本原理是，您希望在扩展功能之前确保一切就绪。推论是，当您解除分配时，您不希望您的子类所依赖的任何超类 ivars 在您有机会处理它们之前被解除分配。

这在参考 UI 更新以及在下面的评论中指出时是有意义的。

# iphone - 需要帮助优化我在 iPhone 上的 2d 绘图

> ID：1005200
> 
> 赞同：1
> 
> 时间：2009-06-17T05:06:54.237
> 
> 标签：iphone, optimization, 2d, core-graphics

我正在编写一个游戏，它显示 56 个六边形棋子以棋盘的形状填充屏幕。我目前正在使用单例渲染类绘制每一块，当调用它来绘制一块时，会根据传入的坐标从 6 个点创建一条路径。这条路径填充了纯色，然后是一个 59x59 png 和一个 alpha 到白色渐变覆盖在图纸上，使作品看起来有光泽。请注意，我目前正在 Core Graphics 中执行此操作。

我的第一个想法是每次绘制时创建一条路径成本很高，而且似乎我可以以某种方式执行一次然后重用它，但我不确定最好的方法。当我查看 Shark 的瓶颈时，看起来 png 的绘制是该过程中最费力的部分。我试过只渲染 png 叠加层或只渲染没有叠加层的路径，两者都给了我一些帧增益，尽管删除 png 叠加层会产生最多的帧。

我目前的想法是，在启动时，我应该渲染 6 条路径（我拥有的每个颜色块 1 条）并用 png 覆盖它们，然后存储这些块的图像，然后每次我需要它们时重新绘制这些块。是否有一种有效的机制来存储你曾经绘制过的东西并重新绘制它？听起来我会再次经常遇到整个绘图 png 的事情，但也许有一种不那么费力的方法可以做类似的事情......

任何建议都非常感谢。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T05:24:34.323

一般想法：

*   iPhone 上的游戏编程通常需要 OpenGL。Core Graphics 更容易使用，但 OpenGL 针对速度进行了优化。
*   尽可能多地将这种“闪亮的外观”预渲染到纹理中（例如：在将它们插入项目之前在 Photoshop 中进行）。Alpha 混合是性能的*地狱*。
*   也许尝试[PVRTC](http://en.wikipedia.org/wiki/PVRTC)（也是本[教程](http://developer.apple.com/iphone/library/qa/qa2008/qa1611.html)），因为它是 iPhone 的 GPU 制造商使用的一种格式。再说一次，这可能会使事情变得更糟，具体取决于您的瓶颈所在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T05:42:41.160

如果你真的需要速度，你必须走 OpenGL 路线。如果要混合使用 OpenGL 和 Core Animation，请小心，它们可能会发生冲突。

如果你没有做太多，OpenGL 是一个痛苦。听起来您可以使用核心动画并将每个图块设为图层。除非您更改某些内容，否则 CA 不会再次调用重绘，因此您应该能够移动该图层而不会受到很大影响。另请注意，CA 将图层存储在纹理内存中，因此它应该更快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T07:22:48.713

其他一些人提到您应该使用 OpenGL。这是专门针对 iPhone 的精彩介绍：[OpenGL ES from the Ground Up: Table of Contents](http://iphonedevelopment.blogspot.com/2009/05/opengl-es-from-ground-up-table-of.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T07:27:36.037

您可以尝试[CGLayer](http://developer.apple.com/iphone/library/documentation/GraphicsImaging/Reference/CGLayer/)或[CALayer](http://developer.apple.com/iphone/library/documentation/GraphicsImaging/Reference/CALayer_class/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-18T08:46:37.923

您可能还想查看[cocos2d](http://code.google.com/p/cocos2d-iphone/)。它似乎比在我的测试中使用 CoreAnimation 快得多，并且为游戏提供了许多有用的东西。

# sql - MySQL：是否可以将 GROUP-BY 的结果加入到两个 SELECT 中？

> ID：1005201
> 
> 赞同：6
> 
> 时间：2009-06-17T05:06:56.247
> 
> 标签：sql, mysql, join

我有两个单独的 SELECT 语句，它们都是 GROUP-BY 的，例如：

```
SELECT x, y, z FROM a GROUP BY x
SELECT x, n, o FROM b GROUP BY x 
```

我非常想将这两个 SELECT 连接在一起以组合它们的列，例如：

```
SELECT x as x1, y, z FROM a GROUP BY x 
LEFT JOIN (
  SELECT x as x2, n, o FROM b GROUP BY x)
ON x1=x2; 
```

这可能吗？我问是因为 MySQL 在抱怨

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以获取在 'LEFT JOIN SELECT x as x2 附近使用的正确语法

如果这是可能的，对我的语法有什么问题有任何想法吗？

非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T05:15:19.263

这有效

```
select * from (
    (select 1 a,2 b,3 c) t1 left join (select null a,2 b,5 c) t2 on (t1.b=t2.b)
); 
```

或者，

```
select * from (
    (select 1 a,2 b,3 c) t1 left join (select null a,2 b,5 c) t2 using (b)
); 
```

两者都导致

```
+---+---+---+------+---+---+
| a | b | c | a    | b | c |
+---+---+---+------+---+---+
| 1 | 2 | 3 | NULL | 2 | 5 |
+---+---+---+------+---+---+
1 row in set (0.00 sec) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T05:17:52.850

有几种方法可以实现这一目标：

1.  最佳：在分组之前加入表格，如下所示：

    ```
    选择轴，y，z，n，o
      从 a 内部连接 ​​b ON ax = bx
     按 ax、bx 分组；

    ```

2.  从两个查询中选择子查询，如下所示：

    ```
    选择 *
    FROM (SELECT x, y, z FROM a GROUP BY x) 作为 a
    INNER JOIN (SELECT x, n, o FROM b GROUP BY x) AS b
            开轴 = bx;

    ```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T05:30:39.480

你也可以使用这个查询：
`SELECT a.x, a.y, a.z, b.x, b.o, b.n FROM a, (SELECT x, n, o FROM b GROUP BY x) as b WHERE a.x = b.x GROUP BY a.x;`

# sqlite - SQLite 是否在读取时锁定数据库文件？

> ID：1005206
> 
> 赞同：49
> 
> 时间：2009-06-17T05:08:25.793
> 
> 标签：sqlite

我正在研究 SQLite 作为存储引擎，并且很想知道 SQLite 是否会在读取时锁定数据库文件。

我担心读取性能，因为我计划的项目写入很少，但读取很多。如果数据库确实锁定，是否可以采取措施（例如内存缓存）来缓解这种情况？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-05-16T12:45:08.793

如果将数据库日志模式设置为预写日志记录，则可以在读取时避免锁定（请参阅：[http](http://www.sqlite.org/wal.html) ://www.sqlite.org/wal.html ）。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2009-06-17T05:12:02.777

从其[维基百科页面](http://en.wikipedia.org/wiki/SQLite)：

> 多个计算机进程或线程可以毫无问题地访问同一个数据库。可以同时满足多个读取访问。

更准确地说，来自其[常见问题解答](http://www.sqlite.org/faq.html#q5)：

> 多个进程可以同时打开同一个数据库。多个进程可以同时执行 SELECT。但是，任何时候只有一个进程可以对数据库进行更改。

但是，对数据库的一次写入*确实会*在短时间内锁定数据库，因此根本无法访问它（甚至无法读取）。可以[*在 SQLite 版本 3 中的文件锁定和并发*](http://www.sqlite.org/lockingv3.html)中找到详细信息。基本上读取数据库是没有问题的，除非有人想立即写入数据库。在这种情况下，数据库在执行该事务所需的时间内被独占锁定，然后锁定被释放。但是，关于在 PENDING 或 EXCLUSIVE 锁期间对数据点的读取操作究竟做了什么的细节很少。我的猜测是他们要么返回`SQLITE_BUSY`要么阻止，直到他们可以阅读。在第一种情况下，再试一次应该不会太难，特别是如果您预计写入次数很少。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-01-14T00:11:02.883

为此答案添加更多信息：

## 问：SQLite 是否会在读取时锁定数据库文件？

## 答：不是和是

参考：[https ://www.sqlite.org/atomiccommit.html#_acquiring_a_read_lock](https://www.sqlite.org/atomiccommit.html#_acquiring_a_read_lock)

> 从数据库文件中读取数据的第一步是获取数据库文件的共享锁。“共享”锁允许两个或多个数据库连接同时从数据库文件中读取。但是共享锁会阻止另一个数据库连接在我们读取数据库文件时写入它

# javascript - 均衡列javascript在Chrome中不起作用

> ID：1005236
> 
> 赞同：0
> 
> 时间：2009-06-17T05:19:08.447
> 
> 标签：javascript, mootools

我正在使用这个 mootools javascript 片段来平衡我的列的高度：

```
window.addEvent('domready', function() 
{
    var columns = $$('.equalize');
    var max_height = 0;

    columns.each(function(item) 
    { max_height = Math.max(max_height, item.getSize().y); });

    columns.setStyle('height', max_height);
}); 
```

问题是它在 Chrome 上无法正常工作。它获得了 2 列的最小高度，而不是获得最大值。似乎是什么问题，我该如何解决？提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T05:23:12.903

很抱歉走上不同的轨道——但你为什么要使用 JavaScript 来做这件事？它*可以*用[CSS](http://matthewjamestaylor.com/blog/ultimate-3-column-holy-grail-pixels.htm)来完成，甚至我觉得表格是比用 JS 做的更好的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-04-18T13:55:54.067

你应该使用

`window.addEvent('load', function(){ });`

不是'domready'事件。

触发 'domready' 事件时，某些元素可能尚未加载。

# c++ - 如何使用 C++ 代码维护会话？

> ID：1005242
> 
> 赞同：4
> 
> 时间：2009-06-17T05:21:12.063
> 
> 标签：c++, session, cgi

有一个用 C++ 编写的 cgi 代码。目前在网页中没有进行会话管理。需要在网页中提供会话，以便用户可以登录、维护会话然后注销。虽然这是使用 HttpSession 在 java 中的一项相当简单的任务，但我不知道如何使用 C++ 代码执行此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T05:33:23.140

C++ 在捆绑库的功能广度上与 Java 不同，因此您需要使用一些额外的库来扩展该语言以完成不太常见的任务（例如 C++ CGI 开发）。您可以自己构建库以支持标准库中不存在的功能，也可以使用第三方开发的库。

在这种情况下，我会使用[NCBI C++ Toolkit](http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/)。它提供了一个不错的[CGI 模块](http://www.ncbi.nlm.nih.gov/books/bv.fcgi?rid=toolkit.section.ch_cgi.cg_develop_apps#ch_cgi.cgi_class_overview)和[会话支持](http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/include/cgi/cgi_session.hpp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-01-02T22:50:47.193

另一种选择可能是“FastCGI / CGI C++ 库”，旨在在某一天进行 Boost 集成：http: [//cgi.sourceforge.net/](http://cgi.sourceforge.net/)

它声称自己提供“对强类型会话的可配置支持（可选）”。

# wcf - 在创建 WCF 代理实例时选择配置文件

> ID：1005243
> 
> 赞同：1
> 
> 时间：2009-06-17T05:21:18.977
> 
> 标签：wcf, .net-3.5, configuration, wcf-client

是否可以通过给定的配置文件而不是 app.config 创建 WCF 代理？
非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T06:24:49.797

**[这](http://weblogs.asp.net/cibrax/archive/2007/10/19/loading-the-wcf-configuration-from-different-files-on-the-client-side.aspx)**是一个想法

# security - What are all needs to be covered in Security Architecture?

> ID：1005256
> 
> 赞同：0
> 
> 时间：2009-06-17T05:28:36.017
> 
> 标签：security, architecture

What is the best book for security architecture? is there any security architecture blueprint available?

I am looking from very broad perspective, not just simple authentication, authorization part.

Any suggestions?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T05:45:50.407

*   [Designing Security Architecture Solutions](https://rads.stackoverflow.com/amzn/click/com/0471206024) - Jay Ramachandran
*   [Building Secure Software: How to Avoid Security Problems the Right Way](https://rads.stackoverflow.com/amzn/click/com/020172152X) - J.Viega and G.McGraw

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T05:33:39.817

You can find a lot of good resources if you use the search function on SO. [Here](https://stackoverflow.com/questions/210781/pragmatic-information-security-textbooks) is a result I found under 'Security Book.' Note that there are even links within that post to other questions asked and answered.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T05:48:55.893

Solid theory to apply your own (e.g. commutative ring) from scratch is N.Biggs Discrete mathematics, more applied are have read openbsd.org and insecure.org

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T04:06:24.227

[Security Engineering by Ross Anderson](http://www.cl.cam.ac.uk/~rja14/book.html) is an excellent text, and the first edition is available for free online.

# c# - HTML 的转义文本

> ID：1005264
> 
> 赞同：140
> 
> 时间：2009-06-17T05:31:22.130
> 
> 标签：c#, html, escaping

如何在 C# 中转义文本以供 html 使用？我想要做

```
sample="<span>blah<span>" 
```

并且有

```
<span>blah<span> 
```

仅使用 html 的标签部分显示为纯文本而不是blah :(。使用 C# 而不是 ASP

* * *

## 回答 #1

> 赞同：187
> 
> 时间：2009-06-17T05:36:15.537

```
using System.Web;

var encoded = HttpUtility.HtmlEncode(unencoded); 
```

* * *

## 回答 #2

> 赞同：88
> 
> 时间：2009-12-19T21:59:05.280

此外，如果您不想使用`System.Web`程序集，也可以使用它：

```
var encoded = System.Security.SecurityElement.Escape(unencoded) 
```

根据[本文](http://weblogs.sqlteam.com/mladenp/archive/2008/10/21/Different-ways-how-to-escape-an-XML-string-in-C.aspx)`System.Security.SecurityElement.Escape()`，和之间的区别在于`System.Web.HttpUtility.HtmlEncode()`前者还编码撇号`(')`字符。

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2013-09-16T08:22:16.987

如果您使用的是 .NET 4 或更高版本并且不想引用`System.Web`，则可以使用[`WebUtility.HtmlEncode`](http://msdn.microsoft.com/en-us/library/ee388364.aspx)from`System`

```
var encoded = WebUtility.HtmlEncode(unencoded); 
```

这与 具有相同的效果`HttpUtility.HtmlEncode`并且应该优先于`System.Security.SecurityElement.Escape`.

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2011-10-19T01:38:05.937

在 ASP.NET 4.0 中有执行此操作的新语法。代替

```
<%= HttpUtility.HtmlEncode(unencoded) %> 
```

你可以简单地做

```
<%: unencoded %> 
```

在这里阅读更多：

*[ASP.NET 4（和 ASP.NET MVC 2）中 HTML 编码输出的新 <%: %> 语法](http://weblogs.asp.net/scottgu/archive/2010/04/06/new-lt-gt-syntax-for-html-encoding-output-in-asp-net-4-and-asp-net-mvc-2.aspx)*

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2016-02-04T12:46:35.533

.NET 4.0 及更高版本：

```
using System.Web.Security.AntiXss;
//...
var encoded = AntiXssEncoder.HtmlEncode("input", useNamedEntities: true); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-06-17T05:34:38.740

您可以使用实际的 html 标签`<xmp>`并按`</xmp>`原样输出字符串以显示 xmp 标签之间的所有标签。

或者您也可以在服务器`Server.UrlEncode`或`HttpUtility.HtmlEncode`.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-06-24T09:08:00.340

您可以使用：

```
System.Web.HttpUtility.JavaScriptStringEncode("Hello, this is Satan's Site") 
```

在像这样处理 HTML 时，这是唯一有效的方法（ASP.NET 4.0+）。在HTML 内容中`&apos;`被渲染为`'`（使用*htmldecode*），导致它失败：

```
<a href="article.aspx?id=268" onclick="tabs.open('modules/xxx/id/268', 'It&apos;s Allstars'); return false;">It's Allstars</a> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-04-27T07:33:37.313

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-01-23T03:59:36.847

有关在 Razor 页面中执行此操作的简单方法，请使用以下命令：

在 .cshtml 中：

```
@Html.Raw(Html.Encode("<span>blah<span>")) 
```

在 .cshtml.cs 中：

```
string rawHtml = Html.Raw(Html.Encode("<span>blah<span>")); 
```

# unit-testing - 模拟第 3 方班级

> ID：1005274
> 
> 赞同：1
> 
> 时间：2009-06-17T05:35:38.720
> 
> 标签：unit-testing, rhino-mocks

我想模拟一个我无权访问代码的类（即使用 RhinoMocks）（比如[ManagementObject](http://msdn.microsoft.com/en-us/library/system.management.managementobject.aspx)或[ManagementObjectCollection](http://msdn.microsoft.com/en-us/library/system.management.managementobjectcollection_members.aspx)）以及我感兴趣的方法/属性

*   不是虚拟的
*   未在类实现的接口中定义

我解决这个问题的方法是为这些类实现包装器并模拟（和使用）这些包装器。

这种方法有替代品吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T05:45:20.687

我认为[TypeMock](http://www.typemock.com/)可以处理这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T06:55:20.010

如果您使用 Java，则可以使用[Mockito](http://code.google.com/p/mockito/)。它可以模拟没有接口的类。

# mysql - 如何将外键添加到两个 Innob 表中，以便它们相互自动更新？

> ID：1005276
> 
> 赞同：1
> 
> 时间：2009-06-17T05:36:27.503
> 
> 标签：mysql, database-design, foreign-keys, innodb

我有两个表 users 和 lead_contacts 具有相似的数据。当有人购买产品时，他们就成为了用户。我应该如何修改下面的两个创建状态：

*   当创建用户时，潜在客户表会收到一个包含 first_name、last_name、company 和 email 的新条目。
*   当潜在客户表信息更改时，用户表中的名字、姓氏、公司和电子邮件会自动更新

    CREATE TABLE `lead_contacts`(
    `contact_id`int(11) NOT NULL auto_increment,
    `user_id`int(11) unsigned NOT NULL default '0',
    `email`varchar(100) NOT NULL default '',
    `company`varchar(50) NOT NULL default '',
    `first_name`varchar(50) NOT NULL default '',
    `last_name`varchar(50) NOT NULL default '',
    `address`varchar(100) NOT NULL default '',
    `address_2`varchar(100) NOT NULL default '',
    `city`varchar(50) NOT NULL default '',
    `state`varchar(50) NOT NULL default '',
    `country`varchar(50) NOT NULL default '',
    `postal_code`varchar(30) NOT NULL default '',
    `phone`varchar(30) NOT NULL default '',
    `fax`varchar(30) NOT NULL default '',
    `ship_bill_same`enum('Y', ' N') NOT NULL 默认 'Y',
    `notes`text NOT NULL,
    `admin_notes`text NOT NULL,
    `list_name`varchar(50) NOT NULL default '',
    `lead_list`int(11) 无符号 NOT NULL 默认 '0',
    `is_master_list`enum('N', 'Y') NOT NULL 默认 'N',
    `active_work`enum('Y', 'N') NOT NULL 默认 'Y',
    `parentID`int(11) unsigned NOT NULL default '0',
    PRIMARY KEY ( `contact_id`),
    KEY `user_id`( `user_id`),
    KEY `lead_list`( `lead_list`),
    KEY `is_master_list`( `is_master_list`),
    KEY `active_work`( `active_work`),
    KEY `parentID`( `parentID`)
    ) ENGINE=InnoDB DEFAULT CHARSET=latin1 PACK_KEYS=1;

    CREATE TABLE `users`(
    `userID`int(11) NOT NULL auto_increment,
    `access_level`int(11) NOT NULL default '0',
    `username`varchar(100) NOT NULL default '',
    `password`varchar(100) NOT NULL default '',
    `first_name`varchar(50) NOT NULL default ' ',
    `last_name`varchar(50) NOT NULL default '',
    `company`varchar(100) NOT NULL default '',
    `email`varchar(100) NOT NULL default '',
    PRIMARY KEY ( `userID`),
    UNIQUE KEY `username`( `username`)
    ENGINE=InnoDB DEFAULT CHARSET=latin1 ;

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T05:50:35.407

我认为您误解了外键的工作原理。

从潜在客户到用户的引用意味着用户中必须已经存在一行，然后潜在客户中的一行才能引用它。

SQL 中没有办法让依赖表根据需要在其父表中自动创建一行。

我想你可以用触发器来做到这一点。但没有外键约束。此外，要填写到父表中的值必须来自某个地方。您需要在应用程序或触发器中的 INSERT 语句中指定它们，或者使用为 users 表中的每一列定义的默认值。鉴于您对 有唯一的约束`users.username`，我认为这不可能通过触发器实现。

* * *

回复：您在评论中的后续问题：

不，外键不能做你所描述的。当您修改`leads`表（具有外键的表）中的信息时，如果您尝试将列更改为表中未找到的值，外键**唯一**能做的就是阻止修改。 `leads.user_id``users`

*子 ( ) 表中的外键`leads`不能更改父 ( `users`) 表中的任何内容。*

我不确定您错误理解的根源是什么。您是否在某处读过它或看到有人做这样的事情？

# css - 有人使用 Nicole Sullivan 的面向对象 CSS 框架吗？

> ID：1005277
> 
> 赞同：0
> 
> 时间：2009-06-17T05:36:40.623
> 
> 标签：css, oocss

**编辑：**由于 Kobi 对这个[StackOverflow Question](https://stackoverflow.com/questions/657407/object-oriented-css-catchy-buzz-phrase-or-legitimate-design-approach)的精彩评论，我修改了以下问题：

有没有人尝试过 Nicole Sullivan 的[面向对象的 CSS](http://wiki.github.com/stubbornella/oocss)框架~~或他们自己的一个~~? 如果是这样，有什么优点/缺点？

是否有使用该框架的生产站点~~面向对象的 CSS~~?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T18:30:49.890

我在大多数样式表中都使用 OOCSS 和普通 CSS。我认为使用 OOCSS 来设计排版样式是没有意义的，但是对于列、框和按钮之类的东西，我认为它确实有意义，并且它确实有助于（在我看来）使代码更简单。

使用一个相当做作（而且很糟糕 - 类应该描述功能，而不是形式）的示例：

使用 OOCSS

```
a.button {display: block; background-color: red;}
a.border {border: 1px solid orange;}

<a class="button border" href="#">My bordered button</a>
<a class="button" href="#">My normal button</a> 
```

使用普通 CSS

```
a.button_and_border {display: block; background-color: red; border: 1px solid orange;}
a.button_no_border  {display: block; background-color: red;}

<a class="button_and_border" href="#">My bordered button</a>
<a class="button_no_border" href="#">My normal button</a> 
```

如您所见，OO 示例中的 CSS 较少，我个人觉得它更易于阅读。但我想归根结底，这完全取决于个人喜好和编码风格:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-01-03T04:33:14.183

OOCSS 框架并没有解决一些由它自己的原则定义的问题。OOCSS 仍然包含冗余，并且通过将组件的组合移动到 DOM 中，将其耦合内容回呈现。

OOCSS 确实做出了一些好的设计决策，应该鼓励用户以一致的方式维护他们的 CSS。这是一件好事。但是缺少随附的文档意味着如果它不能完全满足您的需求，您必须对其进行逆向工程。这个过程是不可靠的，所以你最终可能会回到你开始的地方......使用混乱的 CSS。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-09-13T23:26:16.217

您不应该在 oocss 中指定标签，这是她提出的陷阱之一，因此您可以在任何其他标签上使用 .button ，然后扩展该新标签......例如。

```
<button class="button">works on this</button>
<a class="button">works on this also</a>
<input type="submit" class="button" value="and this too"/> 
```

在 css 中指定 a.button 意味着如果你想在另一个标签上使用它，你必须再次在 css 中重复它。重点是不要重复你的样式并避免冗余。你应该下载她github上的例子

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-10T02:59:50.703

我正在使用它并喜欢它。我所在的大学使用丰富的 Intranet Web 应用程序，这些应用程序使用我创建的 list {} 对象。它水平和垂直排列链接，但具有“扩展类”（皮肤）将它们转换为标题栏、菜单、工具栏、选项卡、手风琴和按钮组。List {} 对象不包含颜色或边框，只有一个 clearfix 和一些修饰符。实际外观存储在单独的类中。我也使用预处理器

如果你走这条路，我会提出 3 条建议。

1.  使用 BEM（块/元素/修饰符）命名约定

2.  考虑基本的乐高积木并使用使用类来扩展它们。

3.  使用 LESS 或 SASS 分离出外观

# .net - C# 属性：它们是如何实例化的？

> ID：1005279
> 
> 赞同：1
> 
> 时间：2009-06-17T05:38:00.073
> 
> 标签：.net, properties, compilation

这可能是一个非常简单的问题，但我试图了解编译的一些内部工作原理。

简单地说，想象一个任意*对象*被实例化。然后在堆上分配该对象。该对象有一个PointF 类型的*属性*（它是值类型），带有一个 get 和一个 set 方法。

想象一下 get 和 set 方法，其中包含一些用于完成工作的计算。如何以及在何处（堆栈/堆）以及何时实例化此代码？

* * *

这是这个问题的背景：

我正在为一个对象编写 get 和 set 方法，这些方法需要非常频繁地访问。get 和 set 代码本身就相当庞大，所以我担心在最坏的情况下，这些方法会被实例化为对象或值类型，并且每次访问属性时都包含所有内部代码。另一方面，代码可能在创建主对象时被实例化，并且 CPU 被简单地告知 jmp 到属性代码开始。无论如何，这是我想澄清的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-17T05:49:43.910

方法（或属性）不会被实例化。你似乎在想我曾经做过的方式——创建一个类的实例不仅为数据分配空间，还为代码分配空间。这不是真的。

即使在 C++ 中，它的工作方式是分配数据以及指向函数指针数组的指针 - 虚拟函数表或 vtable。vtable 中的条目将指向虚拟方法。非虚拟方法不需要 vtable 中的条目。

在任何一种情况下，无论实例化了多少对象，都只有一个代码副本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T05:45:36.990

我这里没有[通过 C# 获得的 CLR](https://rads.stackoverflow.com/amzn/click/com/0735621632)副本，但属性的 getter 和 setter 只是具有特殊装饰的类上的方法。杰弗里·里希特 (Jeffery Richter) 的优秀著作将包含所有细节。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T05:49:19.713

可执行代码既不在栈上也不在堆上分配，它由JIT'er在需要时编译，并预留相应的内存*一次*。也就是说，您正在担心本质上不是问题的东西。另外，不要试图猜测垃圾收集器在分配内存方面做了什么——它可以让你摆脱这种担忧。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T05:43:40.440

它们与方法没有什么不同。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T05:44:16.070

我不确定你所说的实例化是什么意思，但如果你担心 getter 的运行时间，你可以考虑缓存响应。不过，在我确认 getter 确实会损害您的程序的性能之前，我不会这样做。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-06-20T18:27:15.793

根据[这个页面上的MSDN](http://msdn.microsoft.com/en-us/library/ms229054.aspx)属性和方法确实有一些本质的区别。特别是在返回数组时，属性在返回之前执行整个数组的浅拷贝，因此这是您想要使用自定义函数的一种情况。

但是，正如我上面解释的那样，我想知道如果我以任何方式使用属性而不是函数，程序是否会受到性能损失。总的来说，我确实发现由于某些无法解释的原因，属性平均比函数慢 5%。这可能是因为属性拥有一系列“不可见”的对象，例如属性描述符等。除此之外，实现似乎非常相似。

# iphone - 从 NSString 的第一行删除换行符

> ID：1005281
> 
> 赞同：16
> 
> 时间：2009-06-17T05:39:10.540
> 
> 标签：iphone, objective-c, cocoa, macos, nsstring

如何从 NSString中删除第一个**\n字符？**

编辑：澄清一下，我想做的是：如果字符串的第一行包含一个 \n 字符，则删除它，否则什么也不做。

即：如果字符串是这样的：

```
@"\nhello, this is the first line\nthis is the second line" 
```

并且反对在第一行中不包含换行符的字符串：

```
@"hello, this is the first line\nthis is the second line." 
```

我希望这更清楚。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-06-17T05:51:22.033

```
[string stringByTrimmingCharactersInSet:[NSCharacterSet newlineCharacterSet]] 
```

如果这是您想要的，将从任何类型的换行符中修剪您的字符串。

```
[string stringByReplacingOccurrencesOfString:@"\n" withString:@"" options:0 range:NSMakeRange(0, 1)] 
```

将完全按照您的要求执行并删除换行符，如果它是字符串中的第一个字符

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-17T05:51:49.070

这应该可以解决问题：

```
NSString * ReplaceFirstNewLine(NSString * original)
{
    NSMutableString * newString = [NSMutableString stringWithString:original];

    NSRange foundRange = [original rangeOfString:@"\n"];
    if (foundRange.location != NSNotFound)
    {
        [newString replaceCharactersInRange:foundRange
                                 withString:@""];
    }

    return [[newString retain] autorelease];
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-17T22:52:07.947

与其创建 NSMutableString 并使用一些保留/释放调用，不如只使用原始字符串并使用以下代码来简化代码：（需要 10.5+）

```
NSRange foundRange = [original rangeOfString:@"\n"];
if (foundRange.location != NSNotFound)
    [original stringByReplacingOccurrencesOfString:@"\n"
                                        withString:@""
                                           options:0 
                                             range:foundRange]; 
```

（详情请参阅[`-stringByReplacingOccurrencesOfString:withString:options:range:`](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/occ/instm/NSString/stringByReplacingOccurrencesOfString:withString:options:range:)。）

**如果**您首先自动释放那里的内容，那么最后一次调用方法调用的结果甚至可以安全地分配回原始位置，这样您就不会泄漏内存。

# java - Java Preferences.app 不会更改默认 Java 版本

> ID：1005284
> 
> 赞同：2
> 
> 时间：2009-06-17T05:39:40.667
> 
> 标签：java, macos

如果 JAVA_HOME 导出为 /Library/Java/Home（这是 /System /Library/Frameworks/JavaVM.framework/Home)

如果未设置 JAVA_HOME，则命令行中 java -version 返回的版本将由 Java Preferences.app 确定。

我通过反复试验弄清楚了这一点。我对记录在哪里感兴趣。

我不确定 CurretntJDK 对于用户更改是否安全。Java Preferences.app 不会改变它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-10T19:35:09.817

不要改变currentJDK，我做了，它搞砸了我的java

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-14T21:41:43.327

设置`JAVA_HOME`环境变量是在会话中指定 Java 版本的正确方法。您可以`JAVA_HOME`在 info.plist 文件中指定，也可以通过创建在启动应用程序之前设置环境变量的加载程序应用程序来指定。

请注意，设置`JAVA_HOME`通常不是一个好主意，因为可用的 Java 版本因平台/操作系统版本而异。例如，只有 64 位 Intel Mac 具有 Java 6 和 Leopard。32 位和 64 位 Intel Mac 都具有 Java 6 和 Snow Leopard。

我发现如果您想支持具有 Tiger 或 Leopard 的 32 位 Intel Core Duo Mac，最好的办法是针对 Java 1.5。Java 1.6 JRE 将运行 Java 1.5 应用程序。如果您需要 Java 1.6，那么您必须向您的用户要求 64 位 Intel with Leopard 或任何 Intel with Snow Leopard。请注意，SoyLatte 为 Tiger 和 Leopard 用户提供了 Java 1.6 32 位替代方案。

“java -version”确实会根据 的设置进行更改`JAVA_HOME`，并且正如您所注意到的，还会根据 Java Preferences 更改。

总而言之，`JAVA_HOME`除非您将 Java JRE 与您的应用程序一起分发，否则您不应该真正设置，例如 SoyLatte。在这种情况下，您知道目标版本和路径将在那里。否则，您不能依赖操作系统提供的特定版本。

您可以在此处找到 Apple 开发人员网站上的文档：http: [//developer.apple.com/mac/library/documentation/Java/Conceptual/Java14Development/01-JavaOverview/JavaOverview.html](http://developer.apple.com/mac/library/documentation/Java/Conceptual/Java14Development/01-JavaOverview/JavaOverview.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-20T21:56:10.620

此外，您应该避免在 .bashrc/.profile 中设置 JAVA_HOME 。如果设置了，Java Preferences.app 没有效果，并且

```
java -version 
```

总是返回它认为的“默认”版本（在我的例子中，在 Mac OS X Leopard 上，这是 Java 1.5）。

# google-app-engine - stackoverflow 永久链接是如何工作的？

> ID：1005290
> 
> 赞同：1
> 
> 时间：2009-06-17T05:43:44.607
> 
> 标签：google-app-engine, friendly-url

stackoverflow 如何管理永久链接。例如一个任意的 qn，如：[ASP.NET + jQuery + 动态创建的超链接控件](https://stackoverflow.com/questions/1002230/asp-net-jquery-dynamically-created-hyperlink-controls)在这种情况下，如果同一用户发布另一个具有相同标题的 qn，会发生什么情况。我认为之前的数字 - /1002230/ 是关键，但它是在什么基础上创建的。它是否表明stackoverflow中有多少问题。

这个疑问与我有关，因为我试图在永久链接中使用博客文章的标题。但是，这将不允许具有相同标题的多篇博文。我也不想使用身份证号码。事实上，我正在为这个应用程序使用 appengine，所以生成的密钥类似于“ahVzYW5qaGFjaG9vbGhhLXNhbmRib3hyCwsSBUFjdG9uGFUM”，这肯定不是很好。所以关于如何美化我的网址的任何提示谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T05:46:58.610

该数字是唯一的问题 ID - 它们只会增加而不是重复使用。当您通过 URL 检索页面时，服务器会忽略人类可读的字符串 - 这是为了方便和美观 - 以解决您的相同任务。因此，每个问题 URL 都有两部分 - 机器可读的（起始部分和问题 ID）和人类可读的 - 之后过滤的问题标题。

不包括已删除的问题，该数字是网站上的问题总数。已删除问题的数量不会重复使用，因此不会发生冲突。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T06:05:41.997

与其使用 Key().str()，不如将 Key 的 id 或 key_name 与 Model.get_by_id() 或 Model.get_by_key_name() 一起使用会更好。这些都更加用户友好（分别为整数或提供的字符串）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T05:49:22.757

ID 号确实可以说明总共有多少帖子。我相信我从播客中记得问题和答案都存储为“帖子”，但评论也可能是帖子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T08:25:23.860

我最喜欢的方法是使用格式为“/1234/slug-goes-here”（如 StackOverflow）或“/1234-slug-goes-here”的 URL。稍微聪明点，您可以忽略 slug 的内容，仅根据 ID 获取，这意味着链接即使被邮件软件、IRC 等截断也可以工作。

App Engine 明智的另一种方法是使用键名 - 将 slug 设为键名，这意味着您可以使用 MyModel.get_by_key_name(slug) 查找它。[博客](http://bloog.billkatz.com/)就是这样做的。

# c# - 如何让按钮调用服务器功能，然后更新更新面板？

> ID：1005296
> 
> 赞同：2
> 
> 时间：2009-06-17T05:45:29.720
> 
> 标签：c#, asp.net, triggers, updatepanel

我有这个布局：

```
<div runat="server" OnClick="ChangeText()" id="button">Ok</div>
<asp:UpdatePanel id="updater" runat="server">
    <ContentTemplate>
        <div id="text">Hello</div>
    </ContentTemplate>
</asp:UpdatePanel> 
```

我想拥有它，以便在单击按钮时，在服务器上调用函数 ChangeText() - 然后该函数像这样更新 UpdatePanel 中的标签......

```
public void ChangeText() {
    text.InnerText = "Goodbye";
} 
```

如何连接按钮以触发更新程序的更新？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T05:49:21.773

如果我正确理解您的问题，请将其添加到您的节点下方（节点内）。

```
 <Triggers>
      <asp:PostBackTrigger ControlID="button" />
   </Triggers> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T05:48:16.580

你为什么用 div 那样做。取而代之的是，您需要执行其他方式，例如使用 asp.net 按钮并为该按钮提供与 div 相同的样式表，并在按钮的单击事件上放置更新面板的触发器。

# javascript - Adobe Air 问题/资源

> ID：1005307
> 
> 赞同：3
> 
> 时间：2009-06-17T05:49:08.840
> 
> 标签：javascript, apache-flex, flash, air, adobe

我最近对开发 adobe air 应用程序非常感兴趣，并且只是有一些问题，也许一些更有经验的 air 开发人员可以回答。

首先，航空项目所需的平均时间框架是多少。主要是我正在计划一个将特定论坛框架移植到空中应用程序的雄心勃勃的项目。您估计我亲自完成这需要多长时间？我想要的不仅仅是应用程序中的标准浏览器，更多的是符合所有标准功能的内置控件/功能。

其次，应用程序可以完全用javascript/html/xml完成​​吗？我对这 3 种技术非常精通，但对 flex/flash 没有真正的经验。这也包括制作镀铬。特定功能是否需要涉及特定语言？

最后，有什么好书/文章推荐吗？最好是更高级的书籍/资源，为制作专业质量的应用程序奠定基础。

非常欢迎您对您认为可能有用的任何其他提示或见解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T06:02:22.110

[开始阅读面向 AJAX 开发人员的 Adob​​e AIR](http://www.adobe.com/products/air/develop/ajax/)，尤其是[入门部分](http://www.adobe.com/devnet/air/ajax/getting_started.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T22:18:19.883

如果不知道您的技能水平，我们怎么知道您个人需要多长时间？

我在业余时间在一周内构建并发布了应用程序，并不意味着您的项目或您在该项目中的技能可以相提并论。

Adobe Air 开发通常快速而简单。

不要重新发明轮子制作按钮和菜单类，利用已经存在的东西。

看看 MadComponents：[http](http://code.google.com/p/mad-components/) ://code.google.com/p/mad-components/用于 UI

除此之外，还有几个强大的补间和图形库。

还有 stage3d 和框架来支持几乎接近原生性能的 2d 和 3d 开发。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-19T06:26:02.363

你可以在这里找到一个 python 脚本：

[http://code.google.com/p/flashcommand/](http://code.google.com/p/flashcommand/)

更多信息在这里：

[http://www.mikechambers.com/blog/2008/05/02/flashcommand-for-os-x-updated-to-work-with-flash-cs3/](http://www.mikechambers.com/blog/2008/05/02/flashcommand-for-os-x-updated-to-work-with-flash-cs3/)

基本上，这只是使用 Flash Pro 中的 JSFL API 从命令行自动编译。但是，它需要安装 Flash Pro（并且脚本会启动它）。

不使用 Flash Pro 就无法编译 FLA。

迈克室

# php - 反色情图片上传

> ID：1005314
> 
> 赞同：1
> 
> 时间：2009-06-17T05:49:57.013
> 
> 标签：php, javascript, html, ajax

> **可能重复：**
> [以编程方式检测色情图片的最佳方法是什么？](https://stackoverflow.com/questions/713247/what-is-the-best-way-to-programatically-detect-porn-images)

我目前在一个网站上工作，我想为用户提供上传图像的自由，以在所述网站上显示。问题是我不想显示色情图片。我知道谷歌和其他网站已经在使用某种算法来做到这一点，但我想知道是否有任何公共解决方案、库或资源可以在我的代码中使用？

谢谢任何想法都表示赞赏 leteatlunch

ps 我在 PHP 中做了很多编码，所以如果我最好在 PHP 中寻找解决方案

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T05:57:13.663

他们有一个程序可以把它放在linux上

[http://www.safesquid.com/html/portal.php?page=80](http://www.safesquid.com/html/portal.php?page=80)

# visual-studio-2008 - 为什么我的 VS2008 保存和重命名文件很慢

> ID：1005317
> 
> 赞同：1
> 
> 时间：2009-06-17T05:50:51.427
> 
> 标签：visual-studio-2008, plugins, performance

Windows Vista - 使用以下插件 - Codesmith 和 CodeKeep。我怀疑它是在安装 CodeSmith 插件后开始的..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-01T05:59:42.527

这是因为插件

# c# - 将 Borland C++ 迁移到 C#

> ID：1005318
> 
> 赞同：1
> 
> 时间：2009-06-17T05:51:06.310
> 
> 标签：c#, c++, borland-c++

我必须执行需要将 Borland C++ 代码迁移到 C# 的项目，我需要遵循哪些重要步骤才能顺利迁移代码？请提出任何提示和技巧？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T06:11:34.000

这实际上意味着完全重写。如果我是你，我会尝试 C++/CLI 而不是 C#。这样，您可以逐渐重写代码并将其转换为托管代码。

需要考虑的事项，无论您是迁移到 C# 还是 C++/CLI：

1.  将您的软件划分为具有干净接口的模块（使用 n 层架构、MVC 等）。如果每个分区都是一个 COM 对象，您甚至可以尝试仅迁移部分并在 .NET 中使用 COM 对象。
2.  确定您依赖的库并检查如何在 .NET 中替换它们
3.  确定在何处使用指针并检查如何在 C++ 中转换此代码
4.  检查您在哪里使用 RAII 对象并找到在 .NET 中获得相同结果的方法。

我无法为您提供更详细的建议，因为我不知道您要迁移哪种类型的程序以及出于什么原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T06:07:27.030

不过，这并不是真正的代码迁移，是吗？您所做的实际上是用语言 b (C#) 重写以语言 a（在本例中为 C++）中存在的系统。这两种语言没有太多共同点，无法进行简单的机械翻译（C# <-> Java 更容易机械翻译），并且根据 C++ 代码的现代程度，您可能无法翻译某些习语直接地。

对于一个合理规模的项目，我的方法是用一种允许简单文本处理的语言编写一个“交叉编译器”（我上次使用 ruby​​）。这个交叉编译器应该能够将大约 80% 的代码机械地翻译成几乎可以用目标语言编译的东西。这还允许您识别需要（大量）程序员关注的代码区域，因为您必须使用现有代码并在 C# 中编写功能等效的代码。不要忘记，对于这个翻译工具，您还需要编写代码，将头文件和实现文件中的必要代码位组合在一起。根据 C++ 代码的组织程度，这是一项非常重要的任务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T06:13:55.367

如果您只想迁移到 .NET，请考虑使用[C++/CLI](http://en.wikipedia.org/wiki/C%2B%2B/CLI)。如果您真的想迁移到 C#，那么我建议不要使用自动迁移路径，而是在迁移到 C++/CLI 之后，在 C# 中进行新开发，并计划将现有代码从 C++ 迁移到 C#一个健壮的测试环境来验证随着时间的推移所做的更改。

但是，如果您只是必须进行大规模迁移，那么您可以考虑移植到 C++/CLI 以构建托管程序集并使用一种 disassmble-IL-to-C# 工具来自动化该过程。我强烈反对这样做——但这是你的时间和项目，而不是我的。

# c++ - 在事件查看器应用程序日志中出现错误模块 OLEACC.dll，版本 4.2.5406.0 错误？

> ID：1005329
> 
> 赞同：0
> 
> 时间：2009-06-17T05:56:25.677
> 
> 标签：c++, windows

我的应用程序崩溃并显示错误消息“演示应用程序 pk/si 组件已停止工作”。系统事件查看器日志显示带有以下详细信息的错误。

**“故障应用程序 Demo.exe，版本 1.0.0.1，故障模块 OLEACC.dll，版本 4.2.5406.0，时间戳 0x4549bd93，异常代码 0xc0000005，故障偏移量 0x00004062，进程 ID 0x154c，应用程序启动时间 0x01c9ee94aab4c550”**

我使用的是 Windows Vista Home Premium 版本，我创建的应用程序是 Vc++ SDI 应用程序。

请让我知道是否有人遇到过这个问题，以及可能的解决方案是什么。

提前致谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T06:04:57.473

对我来说，这看起来像是很好的旧访问冲突。看起来您从应用程序中的无效内存位置写入/读取。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T06:52:58.017

很可能是代码中某处的错误将无效值传递给某些 Windows 函数，并且在更远的地方会导致崩溃。仅仅因为发生崩溃的不是您的 DLL 并不意味着这不是您的错！

尽管这不是很有帮助，但您所能做的就是将调试器连接到您的程序并重现崩溃，然后对其进行调试。

# c# - C# 使用反射创建结构

> ID：1005336
> 
> 赞同：15
> 
> 时间：2009-06-17T05:57:38.203
> 
> 标签：c#, reflection

我目前正在编写一些代码，以使用 c# 中的反射将一般对象保存到 XML。

问题是在某些对象中读回 XML 时，我不知道如何初始化该结构。对于我可以使用的课程

```
ConstructorInfo constructor = SomeClass.GetConstructor(Type.EmptyTypes); 
```

但是，对于结构，没有不带参数的构造函数，因此上面的代码将构造函数设置为 null。我也试过

```
SomeStruct.TypeInitializer.Invoke(null) 
```

但这会引发成员访问异常。谷歌没有给出有希望的命中。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-06-17T05:59:37.717

如果这些值是结构，它们很*可能*是不可变的——因此您不想调用无参数构造函数，而是调用将适当值作为构造函数参数的构造函数。

如果结构不是不可变的*，*那么尽可能快地远离它们，如果可以的话......但如果你绝对*必须*这样做，那么使用`Activator.CreateInstance(SomeClass)`. 但是，当您使用反射在值类型上设置属性或字段时，您必须非常小心 - 如果不小心，您最终会创建一个副本，更改该副本上的值，然后将其丢弃。我*怀疑*如果您始终使用盒装版本，您会没事的：

```
using System;

// Mutable structs - just say no...
public struct Foo
{
    public string Text { get; set; }
}

public class Test
{
    static void Main()
    {
        Type type = typeof(Foo);

        object value = Activator.CreateInstance(type);
        var property = type.GetProperty("Text");
        property.SetValue(value, "hello", null);

        Foo foo = (Foo) value;
        Console.WriteLine(foo.Text);
    }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-07-05T10:01:40.827

CreateInstance 不会帮助您处理没有明确定义的构造函数的结构。

```
FormatterServices.GetUninitializedObject(Type type); 
```

这可以使用空白结构来解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T07:16:40.413

只需添加 - 对于**不可变**结构，您可能必须对构造函数进行参数匹配。不幸的是，当可能有多个构造时，这很棘手，尤其是因为某些类型具有单独的静态“创建”方法而不是公共构造函数。但是**假设**你已经完成了匹配，你仍然可以使用`Activator.CreateInstance`：

```
 Type type = typeof(Padding); // just an example
    object[] args = new object[] {1,2,3,4};
    object obj = Activator.CreateInstance(type, args); 
```

但是 - 选择构造函数的代码（上面有 3...）并不容易。您可以说“选择最复杂的”，然后尝试将参数名称与属性名称匹配（不区分大小写）...

一个天真的例子：

```
static void Main() {
    Dictionary<string, object> propertyBag =
        new Dictionary<string, object>();
    // these are the values from your xml
    propertyBag["Left"] = 1;
    propertyBag["Top"] = 2;
    propertyBag["Right"] = 3;
    propertyBag["Bottom"] = 4;
    // the type to create
    Type type = typeof(Padding);

    object obj = CreateObject(type, propertyBag);

}
static object CreateObject(Type type, IDictionary<string,object> propertyBag)
{
    ConstructorInfo[] ctors = type.GetConstructors();
    // clone the property bag and make it case insensitive
    propertyBag = new Dictionary<string, object>(
        propertyBag, StringComparer.OrdinalIgnoreCase);
    ConstructorInfo bestCtor = null;
    ParameterInfo[] bestParams = null;
    for (int i = 0; i < ctors.Length; i++)
    {
        ParameterInfo[] ctorParams = ctors[i].GetParameters();
        if (bestCtor == null || ctorParams.Length > bestParams.Length)
        {
            bestCtor = ctors[i];
            bestParams = ctorParams;
        }
    }
    if (bestCtor == null) throw new InvalidOperationException(
         "Cannot create - no constructor");
    object[] args = new object[bestParams.Length];
    for (int i = 0; i < bestParams.Length; i++)
    {
        args[i] = propertyBag[bestParams[i].Name];
        propertyBag.Remove(bestParams[i].Name);
    }
    object obj = bestCtor.Invoke(args);
    // TODO: if we wanted, we could apply any unused keys in propertyBag
    // at this point via properties
    return obj;
} 
```

# php - 想在我的网站中添加本地化 - 多语言网站

> ID：1005338
> 
> 赞同：1
> 
> 时间：2009-06-17T05:57:45.083
> 
> 标签：php, ajax, localization

我创建了一个网站，我想为这个网站添加本地化 - 多语言网站。我使用 PHP、javascript 和 ajax 创建了这个。

我曾尝试过谷歌语言翻译 A​​PI。有没有其他方法可以做到这一点。您能否建议我如何在我的网站上实现这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T17:04:04.843

zinigor 的想法对你有用......或者你可以考虑在 PHP 中以某种方式实现资源包。后者会更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-26T08:28:44.680

使用 Google Language API 很简单，而不是我在这里发布它的副本，我建议您浏览 Google 提供的一些教程。它基于 JavaScript 并直接连接到 Google，因此需要下载代码。

但是要小心机器翻译。在某些情况下，这很好，但在其他情况下可能会出现问题，不准确的误导等。

您可以按照建议使用基于标签的方法，并根据用户偏好动态替换文本。但这就是它变得有趣的地方。你怎么知道用户想要什么语言？嗅探浏览器语言设置？问用户？此外，一旦您超越了一种语言，您就有了保持它最新和同步的维护方面。

在开始本地化之前，您确实需要确定您是否真的需要它，以及是否要偿还开发和维护成本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T06:37:52.787

我想到了一个解决方案——你可以使用内部字典之类的东西。但这需要用特殊关键字替换所有文本，这些关键字稍后会自动转换为相应语言的文本。

如何实现它取决于您。我见过使用 Smarty 实现该系统的一种。有一个特殊的函数可以按关键字从数据库中查找文本，在模板中它看起来像这样：

```
<p>{dictionary word="hello_world_text"}</p>
<form action="" method="post">
    <input type="text" name="hello_world[text]" value="{dictionary word="default_text_value"}" />
    <input type="submit" name="submit" value="{dictionary word="submit_text"}" />
</form> 
```

显示模板时，Smarty 的内部函数会查找所有文本并将它们放入页面中。当然，您必须首先将所有不同语言的文本放入数据库中。

# javascript - jQuery没有注册$

> ID：1005340
> 
> 赞同：0
> 
> 时间：2009-06-17T05:58:37.420
> 
> 标签：javascript, jquery

我在网站上使用原型 + jquery。现在原型插件使用 $. 我不希望 jQuery 使用 $. 如何让 jQuery 不注册 $. 另外，我该如何调用 jQuery 函数。

感谢您的时间。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-17T06:00:33.610

jQuery[文档](http://docs.jquery.com/Using_jQuery_with_Other_Libraries)有一篇关于如何使 jQuery 与其他库很好地配合的文章。

这是该文章中建议的一种方式：

```
<html>
<head>
  <script src="prototype.js"></script>
  <script src="jquery.js"></script>
  <script>
    jQuery.noConflict();

    // Put all your code in your document ready area
    jQuery(document).ready(function($){
      // Do jQuery stuff using $
      $("div").hide();
    });

    // Use Prototype with $(...), etc.
    $('someid').hide();
  </script>
</head>
<body></body>
</html> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T06:01:16.823

1.  首先链接 jquery，然后链接原型。这将覆盖 $。
2.  对于 jQuery，使用函数`jQuery(...)`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T06:02:48.757

您可以使用`jQuery.noConflict( );`然后您可以像这样重新映射它`$j = jQuery`：

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T06:03:35.523

如果它只是一小部分 jQuery，这就是我使用的

```
jQuery(function($) {

    // now you can use $ again within here - this block of code is fired on DOM ready

}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T06:03:10.267

您可以使用 jquery 的 noConflict 方法：

```
var jQ=jQuery.noConflict(); 
```

从现在开始，您可以使用 jQ 代替“$”来处理 jQuery 函数并使用 $ 作为原型。

# crystal-reports - 支持托管服务器的水晶报表

> ID：1005344
> 
> 赞同：0
> 
> 时间：2009-06-17T05:59:46.233
> 
> 标签：crystal-reports, report, reportviewer, web-hosting

我正在为 asp.net 应用程序运行共享托管服务器。我想在我的服务器上支持水晶报表。以便用户 web 应用程序使用水晶报表。

谁能知道服务器上支持水晶报表的程序是什么。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-15T02:59:01.483

报告查看器控件（从 XIR2 开始）依赖于 COM。您的托管公司将需要支持 COM 并愿意运行安装包以确保创建正确的注册表项。我确信这存在许可问题，更不用说为 IIS 增加的用于报告处理的额外负担了。您可能需要考虑 BusinessObjects Enterprise。

# java - 使用 Netbeans 设计 GUI 以及从 Web Start 开始的能力

> ID：1005361
> 
> 赞同：2
> 
> 时间：2009-06-17T06:07:11.477
> 
> 标签：java, user-interface, netbeans, java-web-start

我在运行 Vista 的计算机上使用 Netbeans 6.5 设计了一个 GUI 程序。我将它上传到我的服务器并测试了网络启动。它工作得很好。

后来使用Mac时，它无法工作。我在 Ubuntu 中对其进行了测试，但也没有成功。我什至尝试在 Ubuntu 上编译源代码，我得到了这个：

缺少生成 JNLP 文件所需的任务，可能是共享文件夹或 IDE 安装中缺少库“JWS Ant Tasks”。

基本上，Java 桌面应用程序在 Windows 计算机上运行良好，但不会在其他计算机上运行。我刚刚在 Ubuntu 计算机上创建了一个测试应用程序，上传它并且运行良好。

为什么我昨天在运行 Vista 的计算机上编译和运行的程序不能在 Ubuntu 上运行？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T06:56:57.247

我想，你可能在 Ubuntu 上有 64 位 JRE。使用 32 位 JRE，据我所知 JWS 不适用于 64 位。

`java-vm-args`如果您同时拥有 64 位和 32 位版本，请使用该参数。下面是示例。

`<j2se version="1.5+" initial-heap-size="128m" max-heap-size="256m" java-vm-args="-d32"/>`

# programming-languages - 开发 spiceworks 桌面 IT 软件使用什么语言？

> ID：1005370
> 
> 赞同：0
> 
> 时间：2009-06-17T06:10:55.387
> 
> 标签：programming-languages, spiceworks

[开发Spiceworks](http://www.spiceworks.com)使用什么语言/技术？

他们是如何存档的，它就像在浏览器中运行的桌面应用程序，实际上它有自己的网络服务器！

我很好奇他们是如何做到这一点的，因为如果您检查安装目录，您找不到 HTML 文件或 CSS 文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T06:27:29.057

Spiceworks 是用 Ruby 编写的。

来源：[https ://web.archive.org/web/1/http://blogs.techrepublic%2ecom%2ecom/programming-and-development/?p=350](https://web.archive.org/web/1/http://blogs.techrepublic%2ecom%2ecom/programming-and-development/?p=350)

另一方面，他们有一个非常好的用户界面！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T06:20:14.670

他们的网页上有一个[联系链接。](http://www.spiceworks.com/contact/)我不知道为什么你会认为我们会比他们更了解他们的产品。

Web 服务器不需要从单个文件中提取其内容。它们可以保存在一个大文件中并根据需要提取，或者就我们所知，甚至可以作为字符串保存在可执行文件中。

我建议你问问他们。

# delphi - 在运行时创建组件 - Delphi

> ID：1005373
> 
> 赞同：22
> 
> 时间：2009-06-17T06:12:06.010
> 
> 标签：delphi, runtime, components

如何在运行时创建组件然后使用它（更改属性等）？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-06-17T06:18:03.240

这取决于它是可视组件还是非可视组件。原理是一样的，但是对于每种组件都有一些额外的考虑。

**对于非可视组件**

```
var
  C: TMyComponent;
begin
  C := TMyComponent.Create(nil);
  try
    C.MyProperty := MyValue;
    //...
  finally
    C.Free;
  end;
end; 
```

**对于视觉组件：**

本质上，可视组件的创建方式与非可视组件的创建方式相同。但是您必须设置一些额外的属性才能使它们可见。

```
var
  C: TMyVisualComponent;
begin
  C := TMyVisualComponent.Create(Self);
  C.Left := 100;
  C.Top := 100;
  C.Width := 400;
  C.Height := 300;
  C.Visible := True;
  C.Parent := Self; //Any container: form, panel, ...

  C.MyProperty := MyValue,
  //...
end; 
```

对上面代码的一些解释：

*   通过设置组件的所有者（构造函数的参数），当拥有的表单被销毁时，组件也会被销毁。
*   设置`Parent`属性使组件可见。如果您忘记了它，您的组件将不会显示。（很容易错过那个:)）

如果您想要**许多组件**，您可以执行与上述相同的操作，但在循环中：

```
var
  B: TButton;
  i: Integer;
begin
  for i := 0 to 9 do
  begin
    B := TButton.Create(Self);
    B.Caption := Format('Button %d', [i]);
    B.Parent := Self;
    B.Height := 23;
    B.Width := 100;
    B.Left := 10;
    B.Top := 10 + i * 25;
  end;
end; 
```

这将在表单的左边框添加 10 个按钮。如果您想稍后修改按钮，可以将它们存储在列表中。（[TComponentList](http://www.freepascal.org/docs-html/fcl/contnrs/tcomponentlist.html)最适合，但也看看从评论到这个答案的建议）

**如何分配事件处理程序：**

您必须创建一个事件处理程序方法并将其分配给事件属性。

```
procedure TForm1.MyButtonClick(Sender: TObject);
var
  Button: TButton;
begin
  Button := Sender as TButton; 
  ShowMessage(Button.Caption + ' clicked');
end;

B := TButton.Create;
//...
B.OnClick := MyButtonClick; 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-06-17T07:22:42.617

为了简化运行时组件的创建过程，您可以使用[GExperts](http://www.gexperts.org)。

1.  直观地创建一个组件（或多个组件）并设置其属性。
2.  选择一个或多个组件并执行 GExperts, Components to Code。
3.  将生成的代码粘贴到您的应用程序中。
4.  从可视表单设计器中删除组件。

示例（以这种方式生成的 TButton 创建代码）：

```
var
  btnTest: TButton;

btnTest := TButton.Create(Self);
with btnTest do
begin
  Name := 'btnTest';
  Parent := Self;
  Left := 272;
  Top := 120;
  Width := 161;
  Height := 41;
  Caption := 'Component creation test';
  Default := True;
  ParentFont := False;
  TabOrder := 0;
end; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-14T06:56:42.393

我只想在动态添加控件时添加这一点……按照@Despatcher 在<1> 中的建议，将它们添加到对象列表（TObjectList）中是个好主意。

```
procedure Tform1.AnyButtonClick(Sender: TObject);
begin
  If Sender is TButton then
  begin
    Case Tbutton(Sender).Tag of 
    .
    .
    .
// Or You can use the index in the list or some other property 
// you have to decide what to do      
// Or similar :)
  end;
end;

procedure TForm1.BtnAddComponent(Sender: TObJect)
var
  AButton: TButton;
begin
  AButton := TButton.Create(self);
  Abutton. Parent := [Self], [Panel1] [AnOther Visual Control];
  AButton.OnClick := AnyButtonClick;
// Set Height and width and caption ect.
  .
  .
  . 
  AButton.Tag := MyList.Add(AButton);
end; 
```

*您需要将 Unit 'Contnrs' 添加到您的 Uses 列表中。* 即 System.Contnrs.pas 基本 Containers Unit 你可以有许多对象列表。我建议为您使用的每种类型的控件使用 TObjectList，例如

```
Interface
 Uses Contnrs;
Type
 TMyForm = class(TForm)
private
   { Private declarations }
public
   { Public declarations }
end;
 Var
  MyForm: TMyForm;
  checkBoxCntrlsList: TObjectList; //a list for the checkBoxes I will createin a TPanel
  comboboxCntrlsList: TObjectList; //a list of comboBoxes that I will create in some Form Container 
```

这使您可以轻松操作/管理每个控件，因为您将知道它是什么类型的控件，例如

```
Var comboBox: TComboBox;
I: Integer;

begin
 For I = 0 to comboboxCntrlsList.Count -1 do // or however you like to identify the control you are accessing such as using the tag property as @Despatcher said
   Begin
    comboBox := comboboxCntrlsList.Items[I] as TComboBox;
    ...... your code here
   End;
end; 
```

这允许您然后使用该控件的方法和属性不要忘记创建 TObjectLists，也许以创建事件的形式...

```
checkBoxCntrlsList := TObjectList.Create;
comboboxCntrlsList := TObjectList.Create; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T11:20:45.240

> 但是，如果我不确定要创建多少组件，例如，是否取决于用户的决定。那么如何动态声明组件呢？

已经提出了答案 - 最简单的方法是对象（组件）列表。TObjectList 是最简单的使用（以单位 contnrs 为单位）。清单很棒！

```
 In Form1 Public
  MyList: TObjectList;
  procedure AnyButtonClick(Sender: TObject); 
```

// 你可以变得更复杂并声明 //TNotifyevents 并分配它们，但让它保持简单:)。. .

```
procedure Tform1.AnyButtonClick(Sender: TObject);
begin
  If Sender is TButton then
  begin
    Case Tbutton(Sender).Tag of 
    .
    .
    .
// Or You can use the index in the list or some other property 
// you have to decide what to do      
// Or similar :)
  end;
end;

procedure TForm1.BtnAddComponent(Sender: TObJect)
var
  AButton: TButton;
begin
  AButton := TButton.Create(self);
  Abutton. Parent := [Self], [Panel1] [AnOther Visual Control];
  AButton.OnClick := AnyButtonClick;
// Set Height and width and caption ect.
  .
  .
  . 
  AButton.Tag := MyList.Add(AButton);
end; 
```

对象列表可以包含任何视觉对象或不包含任何对象，但这会给您带来额外的开销来分类哪些项目是哪些 - 例如，如果您想要在类似面板上进行多个动态控件，则最好拥有相关列表。

注意：像其他评论者一样，为了简洁起见，我可能过于简化了，但我希望你能理解这个想法。一旦创建了对象，您就需要一种机制来管理对象，并且列表非常适合这些东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T14:07:42.733

某些组件会覆盖“已加载”方法。如果您在运行时创建实例，则不会自动调用此方法。当从表单文件（DFM）加载完成时，它将被 Delphi 调用。

如果该方法包含初始化代码，您的应用程序在运行时创建时可能会显示意外行为。在这种情况下，请检查组件编写器是否使用了此方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-17T15:32:11.083

如果您在 Group Boxes/Page Controls/Etc... 中嵌套 win 控件，我认为让父组框也成为所有者是有益的。我注意到这样做时窗口关闭时间急剧减少，而不是让所有者始终是主要形式。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-19T13:32:18.947

在关于“使用基于 xml 的模板创建 delphi 表单”的研究期间，我发现一些有用的东西指出了 RTTI 并使用了开放工具 api（我认为是 ToolsApi.pas）。查看单元中的接口。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-17T06:14:36.257

很轻松。调用创建。例子：

```
procedure test
var
  b : TButton;
begin
  b:=TButton.Create(nil);
  b.visible:=false;
end; 
```

这会在运行时创建一个组件（TButton 是一个组件）并将属性设置为可见。

* * *

对于构造函数：如果您想自己管理内存，请传递 nil。如果您想在另一个组件被销毁时将其销毁，请将指针传递给另一个组件。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2013-04-03T07:10:34.083

**这是如何在 Evernote 上模拟按钮标签的示例**

```
unit Unit7;

interface

uses
Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes,Vcl.Graphics,
Vcl.Controls, Vcl.Forms, Vcl.Dialogs, CHButton, Vcl.ExtCtrls, RzPanel, CHPanel, RzCommon,RzBmpBtn, Vcl.StdCtrls;

type
  // This is panel Button
  TButtonClose = class (TRzPanel)
   CloseButton : TRzBmpButton;
   procedure CloseButtonClick(Sender: TObject);
   procedure CloseButtonMouseEnter(Sender: TObject);
   procedure MouseDown(Sender: TObject; Button: TMouseButton;
             Shift: TShiftState; X, Y: Integer);
   procedure MouseUp(Sender: TObject; Button: TMouseButton;
             Shift: TShiftState; X, Y: Integer);
public
   constructor Create(AOwner: TComponent); override;
   destructor Destroy; override;
end;

TForm7 = class(TForm)
   CHButton1: TCHButton;
   RzPanel1: TRzPanel;
   RzBmpButton1: TRzBmpButton;
   procedure CHButton1Click(Sender: TObject);
   procedure RzBmpButton1Click(Sender: TObject);
   procedure RzPanel1MouseDown(Sender: TObject; Button: TMouseButton;
     Shift: TShiftState; X, Y: Integer);
   procedure RzPanel1MouseUp(Sender: TObject; Button: TMouseButton;
     Shift: TShiftState; X, Y: Integer);
   procedure RzPanel1MouseEnter(Sender: TObject);
   procedure RzBmpButton1MouseEnter(Sender: TObject);
   procedure FormMouseEnter(Sender: TObject);
   procedure FormCreate(Sender: TObject);
private
  { Private declarations }
public
  { Public declarations }
end;

var
  Form7: TForm7;
  MyCloseButton : TButtonClose;

implementation

{$R *.dfm}

// constructor for on the fly component created
constructor TButtonClose.Create(AOwner: TComponent);
begin
   inherited Create(AOwner);

   // Set Events for the component
   Self.OnMouseEnter := Self.CloseButtonMouseEnter;
   Self.OnMouseDown := Self.MouseDown;
   Self.OnMouseUp := Self.MouseUp;
   Self.Height := 25;

   // Close button on top panel Button
   // Inherited from Raize Bitmap Button
   CloseButton := TRzBmpButton.Create(self);
   // Set On Click Event for Close Button
   CloseButton.OnClick := Self.CloseButtonClick;
   // Place Close Button on Panel Button
   CloseButton.Parent := self;
   CloseButton.Left := 10;
   CloseButton.Top := 5;
   CloseButton.Visible := False;
   // Setting the image for the button
   CloseButton.Bitmaps.Up.LoadFromFile(ExtractFilePath(Application.ExeName)+'\close.bmp');
end;

procedure TButtonClose.CloseButtonClick(Sender: TObject);
begin
   // Free the parent (Panel Button)
   TControl(Sender).Parent.Free;
end;

procedure TButtonClose.CloseButtonMouseEnter(Sender: TObject);
begin
   // Show the Close button
   CloseButton.Visible := True;
end;

procedure TButtonClose.MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
   // Emulate Button down state, since it is panel
   TRzPanel(Sender).BorderOuter := fsLowered;
end;

procedure TButtonClose.MouseUp(Sender: TObject; Button: TMouseButton;
 Shift: TShiftState; X, Y: Integer);
begin
   // Emulate Button up state, since it is panel
   TRzPanel(Sender).BorderOuter := fsRaised;
end;

destructor TButtonClose.Destroy;
begin
   inherited Destroy;
end;

procedure TForm7.FormCreate(Sender: TObject);
begin
   // Create Panel Button on the fly
   MyCloseButton := TButtonClose.Create(self);
   MyCloseButton.Caption := 'My Button';
   MyCloseButton.Left := 10;
   MyCloseButton.Top := 10;
   // Don't forget to place component on the form
   MyCloseButton.Parent := self;
end;

procedure TForm7.FormMouseEnter(Sender: TObject);
begin
   if Assigned(RzBmpButton1) then
      RzBmpButton1.Visible := False;

   // Hide when mouse leave the button
   // Check first if myCloseButton Assigned or not before set visible property
   if Assigned(MyCloseButton.CloseButton) then
      MyCloseButton.CloseButton.Visible := False;
end;

procedure TForm7.RzBmpButton1Click(Sender: TObject);
begin
   TControl(Sender).Parent.Free;
end;

procedure TForm7.RzBmpButton1MouseEnter(Sender: TObject);
begin
   RzBmpButton1.Visible := True;
end;

procedure TForm7.RzPanel1MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
  TRzPanel(Sender).BorderOuter := fsLowered;
end;

procedure TForm7.RzPanel1MouseEnter(Sender: TObject);
begin
   RzBmpButton1.Visible := True;
end;

procedure TForm7.RzPanel1MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
   TRzPanel(Sender).BorderOuter := fsRaised;
end;

procedure TForm7.CHButton1Click(Sender: TObject);
begin
   FreeAndNil(Sender);
end;

end. 
```

# c# - Silverlight 中的 SOAP 消息加密

> ID：1005381
> 
> 赞同：0
> 
> 时间：2009-06-17T06:17:55.440
> 
> 标签：c#, soap, silverlight-2.0, wcf-security

如何在silverlight中加密soap消息..我目前正在寻找想法......因为silverlight不支持WCF消息安全..我已经阅读了[Peter Bromberg](http://www.eggheadcafe.com/tutorials/aspnet/b978c543-cdca-4c88-8d5d-e03ec7a2ee72/silverlight-to-wcf-servic.aspx)的帖子，但它也没有讨论关于何时如何使用的想法交换公钥/私钥或某种......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T06:41:46.710

使用传输层安全性如何？ssl？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T06:48:36.713

帖子中讨论的方法似乎没有进行任何非对称密钥交换（如 TLS 那样）。相反，它依赖于基于某些程序集元数据生成的对称密钥。见文章最后一段：

> 最后，让我解决几个问题：首先，我在这里没有说这比 SSL“更好”。我只提供它作为替代方案。其次，生成的密码密钥的密码或其他组件可能以明文形式显示在代码中这一事实对黑客来说没有用，因为密码和哈希（两者都只能在运行时生成）都是必需的一个有效的密钥。下载反映了使用程序集的 FullName 属性生成 salt 值以及使用 ManifestModule.Name.GetHashCode() 生成密码的更改，如前所述。

这不是一个非常强大的密钥生成机制，因为攻击者可以简单地下载相同的 Silverlight 应用程序并启动调试器并获取密钥。但是，它将保护攻击者只能访问您的 HTTP 流量的任何中间人攻击。

如果目标是获得免费解决方案，我个人会坚持使用 SSL，并使用自签名证书。

# firefox - Flash 和 SWFObject2 在后台选项卡中停止 Flash 音频

> ID：1005383
> 
> 赞同：0
> 
> 时间：2009-06-17T06:18:05.017
> 
> 标签：firefox, flash, swfobject

我使用 SWFObject 2.2 为我制作的基于 AJAX 的游戏播放声音。我曾经使用 SWFObject 1，一切正常，但是当我更新我的游戏时，我更新到了 2.2。现在，当用户在玩游戏时尝试在 Firefox 的另一个选项卡中收听 Youtube 或 Pandora 上的音乐时，除非他们选择了该选项卡，否则他们不能这样做。

有趣的是视频并没有停止播放，只是声音停止了工作。我运行以下 javascript 以停止我的 flash 文件中的声音效果，它似乎在 Youtube 或 Pandora 上同时停止声音：

```
$('myflashid').doStop(); 
```

以下是用于我的 Flash 文件的操作脚本：

```
import flash.external.ExternalInterface;

snd=new Sound();
snd.attachSound("MySound1");

ExternalInterface.addCallback( "doPlay", this, doPlay );
ExternalInterface.addCallback( "doStop", this, doStop );
function doPlay() {
   snd.start();
}
function doStop() {
   snd.stop();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T17:37:29.820

我不确定为什么会修复它，但是如果我将音量设置为 0 而不是 snd.stop(); 然后当我再次启动时将音量设置回100，它似乎工作正常。

# database-design - 如果我有多种类型的对象，object.type 什么时候应该是字符串，什么时候应该是外键？

> ID：1005384
> 
> 赞同：2
> 
> 时间：2009-06-17T06:18:10.400
> 
> 标签：database-design, foreign-keys, associations, lookup-tables

假设我有一些可以是浪漫、小说或神秘的书。我有 2 个现实的选项来存储这些数据。一种是在我的 books 表中有一个 type 列，它是一个值为“romance”、“fiction”或“mystery”的字符串。另一种是创建一个 book_types 表并将类型存储在其中。然后我的书会有一个 type_id 外键引用 book_types 表。

我的问题是如何选择最好的？我已经看到了在 Restful 身份验证 Rails 插件中使用的字符串方法，其中包含有关用户状态的信息 - 'inactive'、'active'、'pending'...

考虑到我将一直查询此信息，使用查找表方法是否会影响性能？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T06:31:05.213

外键方法会表现得更好。字符串比较会减慢速度。比较数字要快得多。

如果您想进一步加快查询速度，请在用于引用外键的列上添加索引。与主键不同，索引不会自动为外键创建。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T06:21:03.903

如果没有更多的信息要存储在某个东西上，字符串通常是可以的（尽管这是一个非瞬态值，所以它不是正常形式的）。

然而，这似乎是一个很好的表格候选者，因此您可能希望对类别进行更多操作，因此它应该是一个参考表，imo。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T12:37:17.160

在大多数情况下，使用单独表的外键的方法是最好的 - 优点：

*   单独的表为您提供了一种可扩展的方式来验证条目。在表定义中放置一个硬编码的检查约束然后需要一个 ALTER TABLE 来添加一个新类型

*   如果您出于某种原因需要更改类型文本（例如，对于一个蹩脚的示例，“浪漫”->“女性小说”），您只需对查找表进行轻量级更新。

*   可以想象，您可能拥有尚无条目的类型，并且单独的表允许您使用外连接将类型包含在 SQL 结果集中。

*   从界面的角度来看，单独的表格让您可以轻松地生成不需要在 UI 中进行硬编码的类型的下拉列表。

就性能而言，通过 FK 上的适当索引，任何 RDBMS 引擎都会表现良好 - 连接是 RDBMS 的设计目的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T06:22:30.220

我会用fk。更少的信息重复。

编辑：更好的解决方案：MySql 代码：

```
CREATE TABLE books
(
    id int AUTO_INCREMENT          not null,
    book_type enum('romance', 'fiction', 'mystery')     not null,
    ....
); 
```

# c# - 在单独的线程上运行表单时 .NET CF 中的内存泄漏

> ID：1005387
> 
> 赞同：0
> 
> 时间：2009-06-17T06:19:50.973
> 
> 标签：c#, .net, compact-framework, memory-leaks

*编辑 - 在测量精加工内存之前清空螺纹*

这都是在 Windows CE 5.0 下运行 .NET Compact Framework 2.0。

我在开发我的应用程序时遇到了一些有趣的行为。每当我尝试创建一个表单并让它运行一个单独的线程时，它似乎在关闭时泄漏了 392 个字节，我不确定为什么。

到目前为止，我的方法是创建一个新线程并让它 a) 创建表单并不断调用 Application.DoEvents 直到它关闭或 b) 创建表单并将其传递给 Application.Run(Form)。

以下是说明问题的示例表单。

```
public partial class TestForm : Form
{
    public TestForm()
    {
        InitializeComponent();
    }

    private void DoMemoryTest(bool useApplicationRun)
    {
        GC.WaitForPendingFinalizers();
        GC.Collect();
        long originalMem = GC.GetTotalMemory(true);

        Thread t;
        if (useApplicationRun)
            t = new Thread(new ThreadStart(AppRunThread));
        else
            t = new Thread(new ThreadStart(DoEventThread));
        t.Start();

        Thread.Sleep(3000);//Dodgey hack
        t.Join();
        t = null;

        GC.WaitForPendingFinalizers();
        GC.Collect();
        long terminatingMem = GC.GetTotalMemory(true);

        MessageBox.Show(String.Format("An increase of {0} bytes was measured from {1} bytes", 
                        terminatingMem - originalMem, originalMem));
    }

    private void button1_Click(object sender, EventArgs e)
    {
        DoMemoryTest(false);
    }

    private void button2_Click(object sender, EventArgs e)
    {
        DoMemoryTest(true);
    }

    private void AppRunThread()
    {
        Application.Run(new OpenCloseForm());
    }

    private void DoEventThread()
    {
        using (OpenCloseForm frm = new OpenCloseForm())
        {
            frm.Show();
            do
            {
                Application.DoEvents();
            } while (frm.Showing);
        }
    }

    /// <summary>
    /// Basic form that opens for a short period before shutting itself
    /// </summary>
    class OpenCloseForm : Form
    {
        public OpenCloseForm()
        {
            this.Text = "Closing Soon";
            this.Size = new Size(100, 100);
            this.TopMost = true;
        }

        public volatile bool Showing = false; //dodgy hack for DoEventThread

        System.Threading.Timer timer;
        protected override void OnLoad(EventArgs e)
        {
            Showing = true;
            base.OnLoad(e);
            timer = new System.Threading.Timer(new TimerCallback(TimerTick), null, 1000, 1000);
        }

        delegate void CloseDelegate();
        private void TimerTick(object obj)
        {
            this.Invoke(new CloseDelegate(this.Close));
        }

        protected override void OnClosed(EventArgs e)
        {
            base.OnClosed(e);
            Showing = false;
        }

        protected override void Dispose(bool disposing)
        {
            if (disposing)
            {
                if (timer != null)
                {
                    timer.Dispose();
                    timer = null;
                }
            }
            base.Dispose(disposing);
        }
    }

    //Designer code to follow....

    /// <summary>
    /// Required designer variable.
    /// </summary>
    private System.ComponentModel.IContainer components = null;

    /// <summary>
    /// Clean up any resources being used.
    /// </summary>
    /// <param name="disposing">true if managed resources should be disposed; otherwise, false.</param>
    protected override void Dispose(bool disposing)
    {
        if (disposing && (components != null))
        {
            components.Dispose();
        }
        base.Dispose(disposing);
    }

    #region Windows Form Designer generated code

    /// <summary>
    /// Required method for Designer support - do not modify
    /// the contents of this method with the code editor.
    /// </summary>
    private void InitializeComponent()
    {
        this.timer1 = new System.Windows.Forms.Timer();
        this.button1 = new System.Windows.Forms.Button();
        this.button2 = new System.Windows.Forms.Button();
        this.SuspendLayout();
        // 
        // button1
        // 
        this.button1.Location = new System.Drawing.Point(32, 47);
        this.button1.Name = "button1";
        this.button1.Size = new System.Drawing.Size(116, 39);
        this.button1.TabIndex = 1;
        this.button1.Text = "DoEvents Loop";
        this.button1.Click += new System.EventHandler(this.button1_Click);
        // 
        // button2
        // 
        this.button2.Location = new System.Drawing.Point(32, 115);
        this.button2.Name = "button2";
        this.button2.Size = new System.Drawing.Size(116, 39);
        this.button2.TabIndex = 2;
        this.button2.Text = "Application.Run";
        this.button2.Click += new System.EventHandler(this.button2_Click);
        // 
        // TestForm
        // 
        this.AutoScaleDimensions = new System.Drawing.SizeF(96F, 96F);
        this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Dpi;
        this.AutoScroll = true;
        this.ClientSize = new System.Drawing.Size(177, 180);
        this.Controls.Add(this.button2);
        this.Controls.Add(this.button1);
        this.Name = "TestForm";
        this.Text = "TestForm";
        this.TopMost = true;
        this.ResumeLayout(false);

    }

    #endregion

    private System.Windows.Forms.Timer timer1;
    private System.Windows.Forms.Button button1;
    private System.Windows.Forms.Button button2;
} 
```

我是否遗漏了有关控制处置的某些内容？有没有人知道从哪里开始？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T14:04:42.663

好吧，关于这段代码，我首先要说的是WTF？！您需要对 Windows 消息的工作方式进行一些研究。我会在这里介绍一点，但在潜入并尝试像我在这里看到的那样疯狂的东西之前，你真的需要理解它。

1.  创建窗口时，该窗口的所有“操作”都通过 Windows 消息传递。当您调用 Refresh 或 Click 或其他方法时，这是一条 Windows 消息。
2.  这些消息是从“消息泵”发送的，它只是一个调用 PeekMessage、GetMEsssage、TranslateMessage 和 DispatchMessage API 的循环。
3.  Application.Run 在托管代码中执行此操作。
4.  窗体的 Windows 消息*必须*在创建窗口时在同一线程上下文中传递。这意味着泵也必须在同一线程上。这就是 Control.Invoke 存在的原因。
5.  一个线程上的泵甚至不会看到另一个线程上窗口的消息

因此，您所做的事情肯定存在一些问题。我不确定你想要实现的“大图”是什么，以及你是如何注意到这个错误的，但这段代码告诉我你的架构中存在一些基本问题。

但是你认为你已经找到了这个泄漏呢？好吧，没有泄漏。您不了解 CF（和托管）内存管理。同样，建议进行研究，但 MSDN 有一个非常好的[网络广播，可以很好地涵盖它](http://msevents.microsoft.com/CUI/WebCastEventDetails.aspx?culture=en-US&EventID=1032318791&CountryCode=US)。

这种情况的短处是您在单独的线程上创建了一些对象。这些线程创建了一堆东西，其中一些是 IDisposable，有些不是。当线程断开时，这些物品不再有根，因此可以收集。当调用 Collect 时，GC 会遍历所有根并记录每个具有根（标记）的对象。那些没有的则被“释放”（清扫）。它们所在的 GC 堆中的区域不再标记为正在使用 - 有关详细信息，请参阅网络广播。如果该项目实现了 IDisposabe，则它*会获得一个新的根*，因此终结器仍然可以存在并*在下一个 GC 周期*中运行。最后，终结器线程运行（非确定性）。

您的代码不考虑这种行为。您没有运行 Collect 两次。在 Collect 调用之后您没有等待终结器（并且仅调用 WaitForPendingFinalizers 可能还不够）。由于您的线程本身没有被标记为后台线程，谁知道它们在生命周期中的位置和 GC 使用状态可能是什么。

所以当我们真正开始着手时，问题是：你到底想解决什么问题？您正在托管内存环境中运行。除非您看到 OOM，否则您几乎总是不应该担心内存级别 - 这就是首先拥有 GC 的全部意义。不要试图建立一个错综复杂的沃尔多学术活动，让我们尝试找出漏洞。

如果您确实遇到了问题，那么您应该首先确保您的应用程序设计符合 Windows 应用程序的编写方式，然后使用[RPM 等工具](http://msdn.microsoft.com/en-us/netframework/cc470067.aspx)来分析哪些根持有内存并修复您创建的泄漏（是的，在托管代码中仍然可以而且确实会发生泄漏）。当然，你也可以在这里就*现实世界*的问题提出合理的问题。

**编辑**

微软似乎已经清除了我上面提到的网络广播内容。希望他们能够找到并重新发布它，但与此同时（如果他们永远找不到的话）我至少有我在 MEDC 最初演讲时使用的 PowerPoint，[它可以在我的博客上找到](http://blog.opennetcf.com/2013/10/24/memory-management-in-the-compact-framework/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T06:27:09.027

我可能是错的，因为我不是 CF 方面的专家，但 .net 不一定会释放它占用的内存，除非系统处于内存压力之下。

我的理解是，如果应用程序需要 x 字节的内存一次，它可能会在某个时候再次需要至少 x 字节。除非操作系统中的其他东西需要它，否则它不会释放该内存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T06:28:03.287

首先，我会问你为什么要在其他线程上创建足够多的表单，而你关心 392 字节，但我猜这不是重点。

我要开始的第一个地方是您没有在 DoMemoryTest 方法中删除的托管线程实例。在 Thread.Sleep(3000) 调用之后调用 t.Join()，然后将其设置为 null（因此即使在调试模式下也可以进行 GC）。

# jquery - 如何使用jquery进行水平滚动

> ID：1005390
> 
> 赞同：0
> 
> 时间：2009-06-17T06:20:41.550
> 
> 标签：jquery

我是使用 jquery 的新手。我需要滚动到该站点[http://www.newworkmag.com/issue1.html](http://www.newworkmag.com/issue1.html)中菜单指示的位置。如果我没记错的话，我可以使用scrollTo。但我找不到如何使用它。希望得到答复。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T06:48:37.340

这可以使用 jQuery [scrollTo 插件](http://flesler.blogspot.com/2007/10/jqueryscrollto.html)来实现，该插件允许您像示例中一样滚动整个窗口。

**编辑：**这是一个类似的[stackoverflow问题](https://stackoverflow.com/questions/832860/how-to-scroll-the-window-using-jquery-scrollto-function)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T06:24:17.130

您可以为此使用 scrollLeft( val) 。[在这里](http://api.jquery.com/)你有很好的文档。

PS。也没有实际需要使用 jQuery，因为您可以使用[scrollBy](http://www.w3schools.com/htmldom/met_win_scrollby.asp)

```
window.scrollBy( x, y); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T06:43:49.530

如果目的是： Scroll Follow 是一个简单的 jQuery 插件，它允许 DOM 对象在用户滚动时跟随页面。链接是：

[http://kitchen.net-perspective.com/open-source/scroll-follow/](http://kitchen.net-perspective.com/open-source/scroll-follow/)

或者

[http://code.google.com/p/jquery-scroll-follow/](http://code.google.com/p/jquery-scroll-follow/)

# php - Magento - 在分组产品表中显示自定义属性

> ID：1005394
> 
> 赞同：4
> 
> 时间：2009-06-17T06:23:28.190
> 
> 标签：php, magento, custom-attributes

我需要找到一种方法来显示自定义属性的值，而不是下图中显示的“产品名称”。

[![分组产品表](../Images/39e450b0742fe2acd4426977810714b2.png)](https://i.stack.imgur.com/qCdw4.gif)
[（来源：[magentocommerce.com](http://www.magentocommerce.com/images/uploads/grouped_prod_front.gif)）]

我正在使用 /app/design/frontend/default/defaultx/template/catalog/product/view/type/grouped.php

下面的代码不起作用（自定义属性是 yearmade）：

```
<?php if (count($_associatedProducts)): ?>  
<?php foreach ($_associatedProducts as $_item): ?>  
    <tr>  
        <td><?php echo $this->htmlEscape($_item->getYearmade()) ?></td> 
```

任何帮助，将不胜感激。

编辑：所以答案很简单。你看我上面没有提到的*是*确实有输出......但它只是一个数字（例如：52）。原来这是该自定义属性值的 ID（它是自定义属性的下拉类型）。

所以总而言之，
这适用于文本类型的自定义属性：

```
echo $this->htmlEscape($_item->getYearmade()) 
```

但是对于所有其他类型的自定义属性（我认为），应该使用以下内容：

```
echo $this->htmlEscape($_item->getAttributeText('yearmade')) 
```

如果没有下面 Alan Storm 提供的最出色的答案，我不会发现这一点。谢谢你，先生。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T06:58:21.597

所有 Magento 模型都有一个可用的“getData”方法，它将返回一个键/值对的 php 数组。在您的 grouped.phtml 文件顶部尝试此操作（在定义 $_product 之后）

```
print('<pre>');print_r($_product->getData());print('</pre>'); 
```

您应该会看到类似于以下内容的输出。

```
Array
(
    [store_id] => 1
    [entity_id] => 3437
    [entity_type_id] => 4
    [attribute_set_id] => 27
    [type_id] => grouped
    [sku] => 
    [category_ids] => 
    [created_at] => 2009-04-16 03:37:51
... 
```

因此，您可以获取一组属性，然后将钥匙拔出。您还可以使用 Magento 的便捷/神奇的 getX 和 setX 方法。在所有 Magento 模型上，您可以通过调用基于名称的驼峰式版本的方法来访问数据数组中的任何属性，

```
$created_at = $_product->getCreatedAt();
$_product->setCreatedAt($date); 
```

因此，无论您的自定义属性名称是什么，您都应该能够使用上面的方法来获取它，如果您不确定只是 print_r 或 var_dump，则可以使用 getData() 返回的数组的内容。

最后，如果自定义属性位于相关产品简单产品之一上，您将需要更像

```
$_associatedProducts[0]->getCreatedAt(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-02-06T16:50:46.240

我有同样的问题。

1.  您必须找到 grouped.phtml `app/design/frontend/base/default/template/catalog/product/view/type/grouped.phtml`

2.  获取项目，示例 `$_item[units]`

3.  在表格中添加一个单元格并粘贴 echo`$_item['units'];`

4.  就这样 ：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-07T11:11:18.870

从版本。1.3\. 在 1.4 中你也必须使用**$_item**而不是**$_product**，对我来说这在可分组表中也可以正常工作。

例子：

```
<?php echo $_item->getAttributeText('your attribute'); ?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-18T10:03:49.197

有些插件可以非常轻松地解决您的解决方案。您可以在此处找到采用产品选项并将其显示在网格中的插件：http: [//www.magemechanics.com/product-grid-options.html](http://www.magemechanics.com/product-grid-options.html)

# java - 我可以将 maven2“目标”文件夹移动到另一台设备吗？

> ID：1005407
> 
> 赞同：22
> 
> 时间：2009-06-17T06:28:40.507
> 
> 标签：java, maven-2

我真的很想让 maven 将“目标”文件夹写入另一个设备（ramdisk），我通常认为这是一个不同的路径。有没有符合 maven2 的方法来做到这一点？

我正在尝试在 Windows 上解决此问题，并且首选符合 maven 的策略。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-06-17T13:41:36.797

如果您碰巧所有项目都扩展了公司父 pom，那么您可以尝试添加另一个间接层，如下所示：

公司POM：

```
<build>
  <directory>${my.build.directory}</directory>
</build>
<properties>
  <!-- sensible default -->
  <my.build.directory>target</my.build.directory>
</properties> 
```

在您的 settings.xml 中：

```
<properties>
  <!-- Personal overridden value, perhaps profile-specific -->
  <my.build.directory>/mnt/other/device/${project.groupId}-${project.artifactId}/target</my.build.directory>
</properties> 
```

如果本地 POM 定义优先于 settings.xml 定义，那么您可以尝试忽略默认值，代价是让您控制的每个 Maven 实例（开发人员、构建机器等）都指定 ${my.build.directory}在其 settings.xml 中。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-17T06:38:13.953

其实 Maven 并没有大家想的那么*受限制*，所有的 POM 都是由一个[Super POM](http://maven.apache.org/guides/introduction/introduction-to-the-pom.html#Super_POM)扩展而来，其中定义了目标文件夹的名称

```
<build>
  <directory>target</directory>
  <outputDirectory>target/classes</outputDirectory>
  <finalName>${artifactId}-${version}</finalName>
  <testOutputDirectory>target/test-classes</testOutputDirectory>
 .
 .
 .
</build> 
```

当然你可以用你想要的任何值覆盖，所以继续在你的 POM 中更改 <directory /> 元素（和其他相关元素）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-31T01:17:08.687

以防万一您想为自己的 Maven3 修复此问题并且不触及项目中的任何内容，请找到文件：

```
$MAVEN_HOME/lib/maven-model-builder-3.X.Y.jar 
```

并在里面更新 super-pom

```
org/apache/maven/model/pom-4.0.0.xml 
```

换线

```
<directory>${project.basedir}/target</directory> 
```

在

```
<directory>/tmp/maven2/${project.groupId}-${project.artifactId}/target</directory> 
```

所以下次当你构建任何 maven 项目时 - 它会将所有类放在 /tmp/ 下

# c# - 如何将网格视图导出到excel？

> ID：1005410
> 
> 赞同：1
> 
> 时间：2009-06-17T06:30:17.277
> 
> 标签：c#, asp.net, gridview

嗨，我正在开发一个应用程序，我正在使用网格来显示数据并添加动态数据表作为网格视图的标题，并且我使用以下代码将网格视图导出到 excel 中，但我无法获取动态添加的数据表将网格导入excel。我正在使用的代码是：

```
 Response.AddHeader("content-disposition", "attachment;filename=Report.xls");
    Response.Charset = String.Empty;
    Response.ContentType = "application/vnd.xls";
    System.IO.StringWriter sw = new System.IO.StringWriter();
    System.Web.UI.HtmlTextWriter hw = new HtmlTextWriter(sw);
    GridView1.DataBind();
    GridView1.RenderControl(hw);
    Response.Write(sw.ToString());
    Response.End(); 
```

你有其他方法可以遵循吗？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-15T05:46:26.593

我看不到您在哪里添加动态数据表作为标题？这应该在数据绑定之后和 GridView1.RenderControl(hw); 之前。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-02-14T08:40:29.417

在按钮单击事件中尝试这个

```
 protected void btnExcel_Click(object sender, ImageClickEventArgs e)
           {
              Response.ClearContent();
              Response.Buffer = true;
              Response.AddHeader("content-disposition", string.Format("attachment; filename=      {0}", "Customers.xls"));
              Response.ContentType = "application/ms-excel";
             StringWriter sw = new StringWriter();
             HtmlTextWriter htw = new HtmlTextWriter(sw);
             gvdetails.AllowPaging = false;
             gvdetails.DataBind();
            //Change the Header Row back to white color
            gvdetails.HeaderRow.Style.Add("background-color", "#FFFFFF");
            //Applying stlye to gridview header cells
            for (int i = 0; i < gvdetails.HeaderRow.Cells.Count; i++)
          {
          gvdetails.HeaderRow.Cells[i].Style.Add("background-color", "#507CD1");
          }
           int j = 1;
           //This loop is used to apply stlye to cells based on particular row
           foreach (GridViewRow gvrow in gvdetails.Rows)
           {
             gvrow.BackColor = Color.White;
             if (j <= gvdetails.Rows.Count)
           {
            if (j % 2 != 0)
      {
        for (int k = 0; k < gvrow.Cells.Count; k++)
          {
        gvrow.Cells[k].Style.Add("background-color", "#EFF3FB");
          }
        }
       }
          j++;
        }
          gvdetails.RenderControl(htw);
            Response.Write(sw.ToString());
           Response.End();
          } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-15T07:43:58.287

这将在格式化的输出文件中导出gridview

```
Response.Clear();
        Response.Buffer = true;
        Response.AddHeader("content-disposition", "attachment; filename=gridSample.xls");
        Response.Charset = "";
        Response.ContentType = "application/vnd.ms-excel";

        using (StringWriter sw = new StringWriter())
        {
            HtmlTextWriter hw = new HtmlTextWriter(sw);

            //to export all pages
            gridSample.AllowPaging = false;
            gridSample.DataSource = progress.getSample();
            gridSample.DataBind();
            //bind again

            gridSample.HeaderRow.BackColor = Color.White;

            foreach (TableCell cell in gridSample.HeaderRow.Cells)
            {
                cell.BackColor = gridSample.HeaderStyle.BackColor;
            }
            foreach (GridViewRow row in gridSample.Rows)
            {
                row.BackColor = Color.White;
                foreach (TableCell cell in row.Cells)
                {
                    if (row.RowIndex % 2 == 0)
                    {
                        cell.BackColor = gridSample.AlternatingRowStyle.BackColor;
                    }
                    else
                    {
                        cell.BackColor = gridSample.RowStyle.BackColor;
                    }
                    cell.CssClass = "textmode";
                }
            }

            gridSample.RenderControl(hw);

            //style to format numbers to string
            string style = @"<style> .textmode { } </style>";
            Response.Write(style);
            Response.Output.Write(sw.ToString());
            Response.Flush();
            Response.End();
        } 
```

# ruby-on-rails - 传递您的 Rails 服务器的域名以进行邮件的最佳方式是什么？

> ID：1005416
> 
> 赞同：4
> 
> 时间：2009-06-17T06:31:16.370
> 
> 标签：ruby-on-rails, ruby, email, dns

我有一个在几个环境中运行的应用程序，即（开发、登台、测试版、实时）

发送邮件时传递应用程序域名的最佳方法是什么，以允许根据服务器使用不同的域名？

我的第一个想法是在各自的 environment.rb 文件中为每个文件添加一些内容，因此`config/environments/beta.rb`将包含

```
ActionMailer::Base.smtp_settings[:domain] = 'beta.domain.com' 
```

并将`config/environments/staging.rb`包含

```
ActionMailer::Base.smtp_settings[:domain] = 'staging.domain.com' 
```

这感觉就像我在做一些非常基本的事情，以至于 Rails 已经有了这个价值，但我没有在我通常期望的任何地方找到它，我也无法在文档中找到它。

在这里采取的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T06:49:21.410

我通常只是将`request.host`in 的值传递给 ActionMailer 方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T06:48:03.610

在您的环境文件中，您要设置：

```
ActionMailer::Base.default_url_options = { :host => "beta.domain.com" } 
```

如果您使用 url_for 而不是命名路由，则还需要指定 :only_path => false ... 这样您就不会获得相对 url。但是，我通常尝试使用命名路由。

# php - 将文件传输到不同服务器的最佳方式是什么？

> ID：1005418
> 
> 赞同：0
> 
> 时间：2009-06-17T06:31:42.407
> 
> 标签：php, scaling

我正在运行一个超出单个服务器容量的文件主机，我需要实现多个服务器的文件存储。我想尽可能便宜地做到这一点，所以那些花哨的大容量存储方法是不可能的。我只是想将用户上传到托管所有 http 和 mysql 的“网关”服务器的文件移动到其中一个媒体服务器。它可以在用户请求结束时完成，也可以每隔几分钟通过 cron 完成。

在这一点上，我真正熟悉的唯一方法是使用 ftp_put php 函数，并将文件通过 ftp 传输到不同的服务器，但我过去曾遇到过这种方法的问题，尤其是对于较大的文件，而且很多将要传输的文件将超过 100mb。

谁能为此提出一个好的解决方案？最好我正在寻找一个纯粹的软件解决方案......希望只不过是一个 php/bash 脚本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T06:35:15.443

您可以编写一个在 cron 中运行的 bash 脚本

并使用 scp 或 sftp 或 rsync 等命令行

例子 ：

```
[bash]# scp filename alice@galaxy.example.com:/home/alice 
```

将“文件名”复制到远程galaxy.example.com 服务器上alice 的主目录中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T06:52:51.823

一种不需要编程设置并且非常安全的方法是从另一台服务器挂载一个文件夹，然后像往常一样使用 php 保存到该目录。

您不必使用 sshfs，还有很多其他方法可以提供相同的解决方案。我会在这种情况下使用 sshfs，因为它可以跨 ssh 工作，因此安全且相对容易设置。

要实现这一点（使用 sshfs）：

1.  安装[sshfs](http://fuse.sourceforge.net/sshfs.html)
2.  将 ssfs 文件挂载到 php 可访问的文件夹中
3.  使用 php 脚本将文件存储在 sshfs 挂载中，因此存储在另一台服务器上。

另一种方法是使用 crontab 在两者之间设置[rsync命令。](http://www.samba.org/rsync/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T06:59:35.700

使用 cron、bash 脚本和 rsync。

**cron：** “Cron 是类 Unix 计算机操作系统中基于时间的作业调度程序。'cron' 是 'chronograph' 的缩写。”

**bash：** “Bash 是为 GNU 项目编写的免费软件 Unix shell。”

**rsync：** “rsync 是用于 Unix 系统的软件应用程序，它可以将文件和目录从一个位置同步到另一个位置，同时在适当的时候使用 delta 编码最小化数据传输。”

总之，*将 rsync 命令放在 bash 脚本中，并让 cron 定期运行它。*

有关一些示例，请参见[此处：](http://www.samba.org/rsync/examples.html)

# iphone - 如何从网络复制 facebook 照片视图并快速显示照片

> ID：1005420
> 
> 赞同：0
> 
> 时间：2009-06-17T06:32:26.693
> 
> 标签：iphone, view

我必须创建与 facebook 相同的功能，就像所有照片都显示在一个视图中，并且用户可以从中选择照片，然后转到大照片。这张照片显示得非常快。我有 5 张来自网络的照片，但这需要很长时间。有谁知道他们如何快速显示照片。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T14:15:17.680

我不知道答案，但我建议你看一下[github上的three20源代码](http://github.com/joehewitt/three20/tree/master)。Joe Hewitt（Facebook 应用程序的编写者）发布了包括照片视图在内的大部分代码。还有[一个 Google 小组](http://groups.google.com/group/three20/)讨论了three20。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T07:48:16.557

我不特别了解 iphone 应用程序，但我知道主要的 facebook 网站会预取相册中的图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T15:33:15.620

Facebook 在上传时会为每张照片创建多种尺寸。他们还将所有照片转换为 png 我很确定，可能会减少原始照片的文件大小。我知道 Creative 在上传到 Facebook 后经常抱怨照片的“质量”。

这允许他们提供适当大小的图像（尺寸和文件大小）以快速显示，而不是提供全尺寸的图像并让客户调整它的大小。

# python - 对不是模型的对象使用 Django JSON 序列化程序

> ID：1005422
> 
> 赞同：2
> 
> 时间：2009-06-17T06:32:57.177
> 
> 标签：python, django, json, google-app-engine, serialization

*   是否可以在没有模型的情况下使用 Django 序列化程序？
*   它是如何完成的？
*   它可以与 google-app-engine 一起使用吗？

我不使用 Django 框架，但由于它可用，我想在这里和那里使用它的资源。这是我尝试过的代码：

```
from django.core import serializers
obj = {'a':42,'q':'meaning of life'}
serialised = serializers.serialize('json', obj) 
```

这会产生错误

```
ERROR ... __init__.py:385] 'str' object has no attribute '_meta' 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-17T07:01:29.690

序列化器仅适用于模型。相反，您可以使用与 Django 捆绑的[simplejson 。](http://code.google.com/p/simplejson/)

```
from django.utils import simplejson
json_str = simplejson.dumps(my_object) 
```

Simplejson 2.0.9 文档在[这里](http://simplejson.googlecode.com/svn/tags/simplejson-2.0.9/docs/index.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T22:37:29.100

这个库中的 GQLEncoder 类可以获取一个 db.Model 实体并将其序列化。我不确定这是否是您正在寻找的，但它对我很有用。

# sharepoint - Sharepoint 迁移后的 HTTP 404 (wss 2 -> wss 3)

> ID：1005432
> 
> 赞同：0
> 
> 时间：2009-06-17T06:43:00.220
> 
> 标签：sharepoint, wss-3.0, wss-2.0, sharepoint-upgrade

我们根据 Microsoft 标准（预扫描、迁移等）升级了 wss 2 站点，并在途中解决了较小的问题。

但是，现在我们没有收到任何错误，并且当我们在 wss 3 中访问该站点时，它给了我们一个 404 - 找不到页面错误。我们现在在根目录下有一个站点，并且 wss 确认...有人知道出了什么问题吗？

顺便说一句：我们还以完全相同的方式升级了另一个站点，它运行良好......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T08:25:50.677

日志文件说什么？

内容数据库是否正确设置？（名称/服务器。）更具体地说，池帐户的权限。

# c# - (C#) 如何为我的屏幕获取点到像素的关系？

> ID：1005435
> 
> 赞同：2
> 
> 时间：2009-06-17T06:43:56.067
> 
> 标签：c#, winforms, fonts, gdi+

据我了解，点与像素的关系将取决于屏幕分辨率。那么如何在 c# 的运行时计算它呢？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T08:25:40.740

如果你想获得屏幕的 DPI，那就有点棘手了。您必须创建一个真正的 Graphics 对象并对其进行查询。

例如，在主窗体的 Load 事件中：

```
using( Graphics g = CreateGraphics() )
{
    _dpiX = g.DpiX;
    _dpiY = g.DpiY; // In practice usually == dpiX
    _points = _dpiX / 72.0f; // There are 72 points per inch
} 
```

当然，大多数显示器都会谎报实际 DPI，并且总是返回 72 或 96，或者在启用大字体时返回 120。如果您真的想将物理英寸映射到屏幕，您必须在用户的帮助下实际校准它 -让他们选择一条他们测量为 1 英寸的线。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T07:01:37.567

这一切都在**Screen**对象中：

```
int bpp = System.Windows.Forms.Screen.PrimaryScreen.BitsPerPixel;
int wid = Screen.PrimaryScreen.WorkingArea.Width;
int ht = Screen.PrimaryScreen.WorkingArea.Height; 
```

在我的机器上它给出：

```
bpp=32
width=1280
height=740 
```

# java - SQL 数据和 JTable

> ID：1005440
> 
> 赞同：-3
> 
> 时间：2009-06-17T06:46:36.547
> 
> 标签：java, sql, swing

我正在尝试一个示例程序进行练习，我想在 JTable 中显示数据库的结果。问题是我不知道该怎么做。我知道如何从数据库中获取数据并将其显示在文本字段或控制台上，但从未尝试过使用 JTable。怎么做 ？

考虑一下我的表格，其中包含人名、年龄、城市和日期等信息。我希望它通过 JTable 显示。如果我添加在程序中添加更多详细信息的选项（我的意思是向 db 添加条目然后将立即显示在 JTable 中），是否可以更新 JTable 显示？

任何建议，关于如何进行的指示表示赞赏。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T06:52:31.513

JDBC + JTable@谷歌：

*   [Hacking Swing：一个 JDBC 表模型](http://www.onjava.com/pub/a/onjava/excerpt/swinghks_hack24/index.html)
*   [掌握 JTable](http://java.sys-con.com/node/36190)
*   [使用 JDBC 进行 SQL 查询并使用 Swing 显示结果](http://www.oreillynet.com/pub/a/oreilly/java/news/javaex_1000.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-09-04T08:36:07.393

这是代码

```
public static TableModel resultSetToTableModel(ResultSet rs) {
try {
    ResultSetMetaData metaData = rs.getMetaData();
    int numberOfColumns = metaData.getColumnCount();
    Vector<String> columnNames = new Vector<String>();

    // Get the column names
    for (int column = 0; column < numberOfColumns; column++) {

    columnNames.addElement(metaData.getColumnLabel(column + 1).toUpperCase());
    }

    // Get all rows.
    Vector<Vector<Object>> rows = new Vector<Vector<Object>>();

    while (rs.next()) {
    Vector<Object> newRow = new Vector<Object>();

    for (int i = 1; i <= numberOfColumns; i++) {
        newRow.addElement(rs.getObject(i));
    }

    rows.addElement(newRow);
    }

    return new DefaultTableModel(rows, columnNames);
} 
catch (Exception e)
{
    e.printStackTrace();

    return null;
} 
```

}

你可以这样调用这个方法

```
void update_Table() throws ParseException 
    {
        // we used this try catch so that values in table  automatically show(without clicking on any button) when the dialog box open          
                    try
                    {
                   Connection con=MSUTIL.getMSConnection();
                    PreparedStatement  pst=con.prepareStatement("select  payment_mode from PaymentMode");   
                 ResultSet  rs=pst.executeQuery();
                   //here i call that method
                    table.setModel(resultSetToTableModel(rs));
                    table.getTableHeader().setFont(new Font("SansSerif", Font.BOLD, 14));
                    while(rs.next())
                    {
                            mp.paymentmode_ComboBox.addItem(rs.getString("payment_mode"));
                    }

                   }
                    catch(SQLException e)
                    {
                        e.printStackTrace();
                    }
                    finally
                    {
                       //this method is for closing the connection
                        MSUTIL.cleanUp(con, pst, rs);
                    } 
```

}

# c# - 剪贴板图像发送到电子邮件

> ID：1005450
> 
> 赞同：0
> 
> 时间：2009-06-17T06:49:53.267
> 
> 标签：c#, .net, javascript, clipboard

如何使用带有 java 脚本 Web 应用程序的 C#.Net 将剪贴板图像发送到电子邮件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T11:05:07.657

看看[这个相关的帖子。](https://stackoverflow.com/questions/999847/client-system-clipboard-print-screen-image-save-in-server-system)

# sifr - sIFR 3+li 菜单

> ID：1005452
> 
> 赞同：1
> 
> 时间：2009-06-17T06:50:06.120
> 
> 标签：sifr

我正在尝试制作一个使用 sIFR 的 li-menu。我想做的是让 sIFR 替换菜单的第一级而不是第二级。菜单只有两个级别。

您可以在以下网址找到菜单：[www.norrlandsoperan.se/default.asp?id=10135](http://www.norrlandsoperan.se/default.asp?id=10135)

如果你能给我一个关于如何完成这项工作的提示，我将不胜感激。

非常感谢。

问候/埃里克·温伯格

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T12:08:51.790

如果子菜单包含在 parent`<li>`中，则需要将 parent 中的文本包装`<li>`在一个`<span>`元素中。然后使用选择器`ul#menu > li > span`来替换那些元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T06:57:44.967

指定一个选择器，例如`ul#menu > li`只获取`<li>`s 的第一级。我认为这应该与 sIFR 自己的选择器引擎一起使用，否则使用 jQuery（您可以在 sIFR 文档中找到如何更改它。）

# c# - 在 Windows 窗体应用程序中使用 switch 语句

> ID：1005454
> 
> 赞同：0
> 
> 时间：2009-06-17T06:51:50.047
> 
> 标签：c#, winforms, switch-statement

我正在做一些关于开关的练习。我只是从控制台应用程序中完成的，我想在窗口窗体应用程序中完成它。我正在寻找有关如何在窗口窗体中进行切换的语法。在控制台中通常是这样的：

```
switch (wordValue)
    {
     case 1:
     Console.WriteLine("You have entered numbered two");
     break;
     default:
     break; 
```

如果我想在 listbox1 中显示这种情况，如何在我的窗口窗体中执行此操作？

谢谢

=======

谢谢你。我试过这个，但我遇到了一个错误。这是我尝试过的：

```
 public static void WriteNumber(int wordValue)
    {
        switch (wordValue)
        {
            case 1:
               listbox.Items.Add("You have entered number one");
                break;
        }
    } 
```

========

这是我想要做的代码：

```
 private void btnOk_Click(object sender, EventArgs e)
    {
        string strUserInputNumber;
        strUserInputNumber = textBox1.Text.Trim();
        Int32 intNumber;
        if (Int32.TryParse(textBox1.Text, out intNumber))
        {
            listBox1.Items.Add(intNumber.ToString());
        }
    }

  public static void WriteNumber(int wordValue)
    {
        switch (wordValue)
        {
            case 1:
               this.listBox1.Items.Add("You have entered numbered one");
                break;
        }
     } 
```

====

这是新代码：

```
 private void btnOk_Click(object sender, EventArgs e)
    {
        string strUserInputNumber;
        strUserInputNumber = textBox1.Text.Trim();
        Int32 intNumber;
        if (Int32.TryParse(textBox1.Text, out intNumber))
        {
            listBox1.Items.Add(intNumber.ToString());
            WriteNumber(intNumber);

        }
        else
        {
           MessageBox.Show("Please enter an integer not a character");
        }
    }

    public void WriteNumber(int wordValue)
    {
        switch (wordValue)
        {
            case 1:
                listBox2.Items.Add("You have entered numbered one");
                break;
            case 2:
                listBox2.Items.Add("You have entered numbered two");
                break;
            case 3:
                listBox2.Items.Add("You have entered numbered three");
                break;
            default:
                listBox2.Items.Add("You have exceeded the range of 1-3\. Please enter the number between 1-3");
                break;
        } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T06:55:57.623

WinForms 和控制台应用程序（或任何其他类型的应用程序或类库）之间的 switch/case 语法相同，唯一的区别是显示数据的方式。如果您想将字符串添加到列表框（这显然是您要问的），它就像

```
listBox1.Items.Add("Here is the text of the list box item"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T07:15:47.653

这应该有效：

```
public void WriteNumber(int wordValue) 
{ 
   switch (wordValue) 
   { 
      case 1: 
         listbox.Items.Add("You have entered number one"); break; 
   } 
} 
```

您需要删除**static**关键字才能访问列表框，它是一个实例变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T06:58:21.987

这工作正常：

```
switch (wordValue)
{
  case 1:
    this.listBox1.Items.Add("You have entered numbered two");
    break;
  default:
    break;
} 
```

# java - 具有静态数据的类何时进行垃圾收集

> ID：1005461
> 
> 赞同：5
> 
> 时间：2009-06-17T06:54:09.170
> 
> 标签：java, static, garbage-collection

我想让一些数据在我的应用程序中很容易获得。我在一个带有静态数据的类中有一些变量，它们在几个不同的点被写入和读取。

这在一段时间内工作得很好，但现在我希望能够检索一个 ArrayList 我得到的只是“null”。

我想知道静态类是否已发送到“垃圾收集器”。不知道发生了什么，如果您能提供帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-17T07:00:00.613

您可以尝试将其设为**final**，然后重新编译代码以查看其他类是否更改了对 null 的引用：

```
public class Global {

    public final static List<String> data = new ArrayList<String>();

} 
```

这允许写：

```
Global.data.add("foo"); 
```

但不是：

```
Global.data = null; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T07:08:54.747

> 我在一个静态类中有一些变量，它们被写入......在几个不同的点。

正如您自己承认的那样，可以在这些不同点中的一个或多个处将 null 分配给变量。:)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T07:14:18.747

正如 Svetlio 所说，GC 仅在堆上没有在任何地方引用的对象上运行。这可能需要 x 个周期，具体取决于您使用的 GC 策略和 VM。由于静态类被无限期地引用，它们永远不会被 GC'd。

所以仍然存在一些问题：

1.  它可能是您的程序设置类的一部分为空吗？每当您的数组列表设置为空时，您可以设置一个调试标志来尖叫吗？
2.  这是否发生在特定时间？启动时？过了一会儿？
3.  一个愚蠢的问题，但你不会`new`在任何时候都在你的静态类上运行？

最后，正如你所说...静态变量除了常量之外的任何东西都很糟糕：PA单例配置真的很便宜而且好多了。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-17T08:27:51.767

原来的问题：

> 静态类什么时候进行垃圾收集？

答：当您的应用程序退出时。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-17T06:59:04.700

如果您可以调用该函数，那么该对象将不会被垃圾回收，因为仍然存在对它的引用。您是存储指向数组列表还是对象本身的指针？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-17T08:10:51.830

如果其类加载器被垃圾收集，则会发生类的垃圾收集。例如，请参阅[此问题](https://stackoverflow.com/questions/453023/are-static-fields-open-for-garbage-collection/453073#453073)。在早期的 Java（我认为是 1.2）中有一个排序时间，GC 没有考虑静态字段，并且大量类卸载/重新加载导致空字段。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-17T07:20:05.787

静态类不像静态变量。这只是关键字“静态”的另一种用途。在这种情况下，它表示该类是顶级的，但在另一个类中声明。

所以这意味着你可以实例化这个类的多个对象，不像静态变量，它只有一个副本。

您是否实例化了其中一个以上并期望它们是同一个？

GC 听起来不像是问题所在。如果对象不再存在，则根本无法从中检索 ArrayList。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-17T07:08:12.830

垃圾收集器不会自行处理静态类。垃圾收集器只有在没有对该类的引用时才能激活。只要能调用类本身，就有引用。您也不能肯定地说垃圾收集器何时开始活动。如果在后台空闲任务，它会以某种方式运行。

我建议您在静态类中添加一些调试跟踪消息，以便您可以看到它何时被调用。在运行时更改 ArrayList 肯定会有一些副作用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-17T07:13:03.010

如果它在不同的线程中，则静态可能为空。否则，如果您不告诉它其他内容，它应该始终存在。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-06-24T10:13:52.900

像这样的东西呢

```
private static List<T> list;

public static List<T> getList() {
    if(list==null)
        initList(); //private static method init list like you want
    return list;
} 
```

# .net - 使用 .NET 从 JPEG 中删除 EXIF 数据的简单方法

> ID：1005463
> 
> 赞同：17
> 
> 时间：2009-06-17T06:54:45.613
> 
> 标签：.net, exif

如何从 JPEG 图像中删除所有 EXIF 数据？

我找到了很多关于如何使用各种库读取和编辑 EXIF 数据的示例，但我只需要一个关于如何删除它的简单示例。

它仅用于测试建议，因此即使是最丑陋和最骇人听闻的方法也会有所帮助:)

我已经尝试搜索 EXIF 开始/结束标记 0xFFE1 和 0xFFE2。最后一个在我的情况下不存在。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-08-09T19:54:02.610

我第一次在我的博客中使用 WPF 库写过这个，但是由于 Windows 后端调用有点混乱，这种失败。

我的[最终解决方案](http://techmikael.blogspot.com/2009/07/removing-exif-data-continued.html)也更快，基本上是字节修补 jpeg 以删除 exif。快速简单:)

**[编辑：博客文章有更多更新的代码]**

```
namespace ExifRemover
{
  public class JpegPatcher
  {
    public Stream PatchAwayExif(Stream inStream, Stream outStream)
    {
      byte[] jpegHeader = new byte[2];
      jpegHeader[0] = (byte) inStream.ReadByte();
      jpegHeader[1] = (byte) inStream.ReadByte();
      if (jpegHeader[0] == 0xff && jpegHeader[1] == 0xd8)
      {
        SkipExifSection(inStream);
      }

      outStream.Write(jpegHeader,0,2);

      int readCount;
      byte[] readBuffer = new byte[4096];
      while ((readCount = inStream.Read(readBuffer, 0, readBuffer.Length)) > 0)
        outStream.Write(readBuffer, 0, readCount);

      return outStream;
    }

    private void SkipExifSection(Stream inStream)
    {
      byte[] header = new byte[2];
      header[0] = (byte) inStream.ReadByte();
      header[1] = (byte) inStream.ReadByte();
      if (header[0] == 0xff && header[1] == 0xe1)
      {
        int exifLength = inStream.ReadByte();
        exifLength = exifLength << 8;
        exifLength |= inStream.ReadByte();

        for (int i = 0; i < exifLength - 2; i++)
        {
          inStream.ReadByte();
        }
      }
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-17T08:30:21.653

我认为将文件读入位图对象并再次写入文件应该可以解决问题。

我记得在执行我的“图像旋转程序”时感到沮丧，因为它删除了 EXIF 数据。但在这种情况下，这正是你想要的！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T08:48:14.017

您应该避免的是对图像进行解码和重新编码，因为这会损害质量。相反，您应该找到一种仅修改元数据的方法。我还没有尝试过，但我认为[InPlaceBitmapMetadataWriter](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.inplacebitmapmetadatawriter.aspx)可以解决问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-09T07:47:10.300

太简单了，从这里使用 jhead.exe：[http ://www.sentex.net/~mwandel/jhead/](http://www.sentex.net/~mwandel/jhead/)

如果需要，请制作一个小批处理文件，例如： `jhead.exe -purejpg *.jpg`

它将从同一文件夹中的所有 jpeg 中删除所有元数据。

# oop - 依赖注入必须以封装为代价吗？

> ID：1005473
> 
> 赞同：135
> 
> 时间：2009-06-17T06:58:01.643
> 
> 标签：oop, dependency-injection, inversion-of-control, encapsulation

如果我理解正确，依赖注入的典型机制是通过类的构造函数或通过类的公共属性（成员）注入。

这暴露了被注入的依赖，违反了 OOP 的封装原则。

我确定这种权衡是否正确？你如何处理这个问题？

*另请参阅下面我对我自己的问题的回答。*

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-11-26T00:11:00.073

还有另一种看待这个问题的方法，您可能会觉得有趣。

当我们使用 IoC/依赖注入时，我们没有使用 OOP 概念。诚然，我们使用 OO 语言作为“宿主”，但 IoC 背后的想法来自面向组件的软件工程，而不是 OO。

组件软件都是关于管理依赖关系的——一个常用的例子是 .NET 的组装机制。每个程序集都会发布它引用的程序集列表，这使得将运行应用程序所需的部分组合在一起（和验证）变得更加容易。

通过 IoC 在我们的 OO 程序中应用类似的技术，我们的目标是使程序更易于配置和维护。发布依赖项（作为构造函数参数或其他）是其中的关键部分。封装并不真正适用，因为在面向组件/服务的世界中，没有“实现类型”可以泄露细节。

不幸的是，我们的语言目前并没有将细粒度的面向对象的概念与粗粒度的面向组件的概念区分开来，所以这是你必须牢记的区别:)

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-06-17T11:17:03.827

这是一个很好的问题——但在某些时候，如果要满足对象的依赖关系，就需要违反*最*纯粹形式的封装。依赖项的某些提供者**必须**知道所讨论的对象需要 a `Foo`，并且提供者必须有一种向`Foo`对象提供 的方式。

正如您所说，通常通过构造函数参数或 setter 方法处理后一种情况。但是，这不一定是正确的——我知道最新版本的 Java 中的 Spring DI 框架，例如，让您注释私有字段（例如 with `@Autowired`），并且依赖项将通过反射设置，而无需您通过暴露依赖项任何类的公共方法/构造函数。这可能是您正在寻找的解决方案。

也就是说，我认为构造函数注入也不是什么大问题。我一直认为对象在构造后应该是完全有效的，因此它们执行其角色所需的任何东西（即处于有效状态）都应该通过构造函数提供。如果您有一个需要协作者工作的对象，那么构造函数公开宣传此要求并确保在创建该类的新实例时满足该要求对我来说似乎很好。

理想情况下，在处理对象时，无论如何您都通过接口与它们交互，并且您这样做的次数越多（并且通过 DI 连接依赖项），您实际上需要自己处理构造函数的次数就越少。在理想情况下，您的代码不会处理甚至创建类的具体实例；所以它只是`IFoo`通过 DI 获得，而不用担心构造函数`FooImpl`表明它需要完成它的工作，实际上甚至不知道`FooImpl`' 的存在。从这个角度来看，封装是完美的。

这当然是一种观点，但在我看来，DI 不一定违反封装，实际上可以通过将所有必要的内部知识集中到一个地方来帮助它。这不仅本身是一件好事，而且更好的是这个地方在您自己的代码库之外，因此您编写的任何代码都不需要了解类的依赖关系。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2010-04-25T18:54:05.540

> 这暴露了被注入的依赖，违反了 OOP 的封装原则。

好吧，坦率地说，一切都违反了封装。:) 这是一种必须善待的温柔原则。

那么，什么违反了封装？

继承**可以**。

> “因为继承将子类暴露给其父类的实现细节，所以人们常说‘继承破坏封装’”。（四人帮 1995:19）

[**面向方面的编程**](http://en.wikipedia.org/wiki/Aspect-oriented_programming) **确实如此**。例如，您注册 onMethodCall() 回调，这为您提供了一个很好的机会将代码注入到正常的方法评估中，添加奇怪的副作用等。

C++ 中的 Friend 声明**确实**.

Ruby 中的类扩展**确实如此**。只需在完全定义字符串类之后的某处重新定义字符串方法即可。

嗯，很多东西**都可以**。

封装是一个很好的重要原则。但不是唯一的。

```
switch (principle)
{
      case encapsulation:
           if (there_is_a_reason)
      break!
} 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-07-21T23:10:34.487

是的，DI 违反了封装（也称为“信息隐藏”）。

但真正的问题是当开发人员以此为借口违反 KISS（保持简短和简单）和 YAGNI（你不需要它）原则时。

就个人而言，我更喜欢简单有效的解决方案。我主要使用“new”操作符来实例化有状态的依赖关系，无论何时何地都需要它们。它简单，封装良好，易于理解，易于测试。那么，为什么不呢？

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-06-17T10:49:09.000

一个好的依赖注入容器/系统将允许构造函数注入。依赖对象将被封装，根本不需要公开。此外，通过使用 DP 系统，您的代码甚至都不“知道”对象是如何构造的细节，甚至可能包括正在构造的对象。在这种情况下有更多的封装，因为几乎所有代码不仅不知道封装对象的知识，而且甚至不参与对象的构造。

现在，我假设您正在与创建的对象创建自己的封装对象的情况进行比较，很可能是在其构造函数中。我对DP的理解是，我们想把这个责任从对象身上拿下来，交给别人。为此，“其他人”，在这种情况下是 DP 容器，确实具有“违反”封装的内知知识；好处是它将知识从对象本身中提取出来。必须有人拥有它。您的应用程序的其余部分没有。

我会这样想：依赖注入容器/系统违反了封装，但您的代码没有。事实上，您的代码比以往任何时候都更加“封装”。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2010-04-25T19:12:29.277

正如 Jeff Sternal 在对该问题的评论中指出的那样，答案完全取决于您如何定义*封装*。

封装的含义似乎有两个主要阵营：

1.  与对象相关的一切都是对象上的方法。所以，一个`File`对象可能有`Save`, `Print`, `Display`,`ModifyText`等的方法。
2.  一个对象是它自己的小世界，不依赖于外部行为。

这两个定义是直接矛盾的。如果一个`File`对象可以打印自己，它将在很大程度上取决于打印机的行为。另一方面，如果它只*知道*可以为它打印的东西（一个`IFilePrinter`或一些这样的接口），那么`File`对象就不必知道任何关于打印的事情，因此使用它会给对象带来更少的依赖。

因此，如果您使用第一个定义，依赖注入将破坏封装。但是，坦率地说，我不知道我是否喜欢第一个定义——它显然不能扩展（如果是，MS Word 将是一个大类）。

另一方面，如果您使用封装的第二种定义，则依赖注入几乎是*强制性的。*

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-06-17T07:57:42.950

它不违反封装。你提供了一个合作者，但班级可以决定如何使用它。只要您遵循[告诉不要问](http://www.pragprog.com/articles/tell-dont-ask)事情就可以了。我发现构造函数注入更可取，但只要他们聪明，setter 就可以了。也就是说，它们包含维护类所代表的不变量的逻辑。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2010-02-25T06:16:09.737

这类似于赞成的答案，但我想大声思考——也许其他人也这样看待事情。

*   经典 OO 使用构造函数为类的消费者定义公共“初始化”契约（隐藏所有实现细节；也称为封装）。这个契约可以确保在实例化之后你有一个可以使用的对象（即用户不需要记住（呃，忘记）额外的初始化步骤）。

*   （构造函数）DI 不可否认地通过此公共构造函数接口泄露*实现细节*来破坏封装。只要我们仍然考虑负责为用户定义初始化合约的公共构造函数，我们就已经创建了一个可怕的封装违规行为。

理论例子：

类**Foo**有 4 个方法并且需要一个整数来初始化，所以它的构造函数看起来像**Foo(int size)**并且类**Foo**的用户立即清楚他们必须在实例化时提供一个**大小**才能使 Foo 工作。

假设 Foo 的这个特定实现可能还需要一个**IWidget**来完成它的工作。这种依赖的构造函数注入会让我们创建一个像**Foo(int size, IWidget widget)这样的构造函数**

令我恼火的是现在我们有一个将初始化数据与依赖项*混合*的构造函数——一个输入是类的用户感兴趣的（**大小**），另一个是一个内部依赖项，它只会混淆用户并且是一个实现详细信息（**小部件**）。

size 参数不是依赖项——它是一个简单的每个实例的初始化值。IoC 对于外部依赖项（如小部件）非常有用，但不适用于内部状态初始化。

更糟糕的是，如果这个类的 4 个方法中的 2 个只需要 Widget 怎么办？即使它可能不被使用，我也可能会产生 Widget 的实例化开销！

如何妥协/调和这个？

一种方法是专门切换到接口来定义操作合约；并废除用户对构造函数的使用。为了保持一致，所有对象都只能通过接口访问，并且只能通过某种形式的解析器（如 IOC/DI 容器）进行实例化。只有容器才能实例化事物。

这处理了 Widget 依赖关系，但是我们如何在不使用 Foo 接口上的单独初始化方法的情况下初始化“大小”？使用此解决方案，我们失去了确保 Foo 实例在您获得实例时完全初始化的能力。太糟糕了，因为我真的很喜欢构造函数注入的*想法和简单性。*

当初始化不仅仅是外部依赖项时，如何在这个 DI 世界中实现有保证的初始化？

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-06-28T16:07:26.163

在进一步解决了这个问题之后，我现在认为依赖注入确实（此时）在某种程度上违反了封装。不过不要误会我的意思——我认为在大多数情况下使用依赖注入是值得的。

当您正在处理的组件要交付给“外部”方（考虑为客户编写库）时，为什么 DI 违反封装的情况变得很清楚。

当我的组件需要通过构造函数（或公共属性）注入子组件时，无法保证

> *“防止用户将组件的内部数据设置为无效或不一致的状态”。*

同时也不能说

> *“组件（其他软件）的用户只需要知道组件做什么，不能让自己依赖于它如何做的细节”*。

两句话都来自[维基百科](http://en.wikipedia.org/wiki/Encapsulation_(computer_science))。

举一个具体的例子：我需要提供一个客户端 DLL，它可以简化和隐藏与 WCF 服务（本质上是一个远程外观）的通信。因为它依赖于 3 个不同的 WCF 代理类，所以如果我采用 DI 方法，我将被迫通过构造函数公开它们。这样我就暴露了我试图隐藏的通信层的内部结构。

一般来说，我都支持DI。在这个特殊（极端）的例子中，我觉得它很危险。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2010-01-14T19:12:40.990

纯封装是永远无法实现的理想。如果所有依赖项都被隐藏，那么您根本不需要 DI。这样想，如果你真的有可以在对象中内化的私有值，例如汽车对象速度的整数值，那么你就没有外部依赖，也不需要反转或注入该依赖。这些纯粹由私有函数操作的内部状态值是您始终想要封装的。

但是如果你正在建造一辆需要某种引擎对象的汽车，那么你就有了外部依赖。您可以在汽车对象的构造函数内部实例化该引擎（例如 new GMOverHeadCamEngine()），保留封装但创建与具体类 GMOverHeadCamEngine 的更隐蔽的耦合，或者您可以注入它，允许您的汽车对象运行例如，在没有具体依赖关系的接口 IEngine 上不可知（并且更健壮）。无论您使用 IOC 容器还是简单的 DI 来实现这一点都不是重点——重点是您拥有一辆可以使用多种引擎而无需耦合任何引擎的 Car，从而使您的代码库更加灵活和不太容易出现副作用。

DI 不是对封装的违反，它是一种在几乎每个 OOP 项目中必然会破坏封装时最小化耦合的方法。从外部将依赖项注入接口可以最大限度地减少耦合副作用，并允许您的类对实现保持不可知论。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2010-01-27T03:33:31.077

这取决于依赖项是否真的是一个实现细节，还是客户希望/需要以某种方式知道的东西。相关的一件事是该类所针对的抽象级别。这里有些例子：

如果你有一个在后台使用缓存来加速调用的方法，那么缓存对象应该是 Singleton 或其他东西，**不**应该被注入。缓存正在被使用的事实是您的类的客户不必关心的实现细节。

如果你的类需要输出数据流，那么注入输出流可能是有意义的，这样类就可以轻松地将结果输出到数组、文件或其他人可能想要发送数据的任何其他地方。

对于灰色区域，假设您有一个类进行蒙特卡罗模拟。它需要随机性的来源。一方面，它需要这个事实是一个实现细节，因为客户端实际上并不关心随机性的确切来源。另一方面，由于现实世界的随机数生成器在客户端可能想要控制的随机程度、速度等之间进行权衡，并且客户端可能想要控制播种以获得可重复的行为，因此注入可能是有意义的。在这种情况下，我建议提供一种在不指定随机数生成器的情况下创建类的方法，并使用线程本地单例作为默认值。如果/当需要更精细的控制时，请提供另一个允许注入随机源的构造函数。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-11-24T19:56:36.547

我相信简单。在域类中应用 IOC/Dependecy 注入并没有带来任何改进，只是通过使用描述关系的外部 xml 文件使代码更难维护。许多技术（如 EJB 1.0/2.0 和 struts 1.1）正在通过减少放入 XML 中的内容并尝试将它们作为注释等放入代码中来逆转。因此，将 IOC 应用于您开发的所有类将使代码变得毫无意义。

当依赖对象在编译时还没有准备好创建时，IOC 有它的好处。这可能发生在大多数基础设施抽象级架构组件中，试图建立一个可能需要适用于不同场景的通用基础框架。在那些地方使用 IOC 更有意义。但这并没有使代码更简单/可维护。

与所有其他技术一样，这也有优点和缺点。我担心的是，我们在所有地方都实施了最新技术，而不管它们的最佳上下文使用情况如何。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2011-07-07T02:52:13.850

只有当一个类既负责创建对象（需要了解实现细节）又使用该类（不需要了解这些细节）时，封装才会被打破。我将解释原因，但首先是一个快速的汽车类比：

> 当我驾驶 1971 年的旧 Kombi 时，我可以踩下油门，它（稍微）快一点。我不需要知道为什么，但是在工厂制造 Kombi 的人就知道为什么。

但回到编码。 **封装**是“对使用该实现的东西隐藏实现细节”。封装是一件好事，因为实现细节可以在类用户不知道的情况下发生变化。

使用依赖注入时，构造函数注入用于构造**服务**类型对象（与建模状态的实体/值对象相反）。服务类型对象中的任何成员变量都表示不应泄露的实现细节。例如套接字端口号、数据库凭据、另一个要调用以执行加密的类、缓存等。

最初创建类时，**构造函数**是相关的。这发生在构建阶段，而您的 DI 容器（或工厂）将所有服务对象连接在一起。DI 容器只知道实现细节。它知道所有关于实施细节的知识，就像 Kombi 工厂的人知道火花塞一样。

在运行时，创建的服务对象被称为 apon 来做一些实际的工作。此时，对象的调用者对实现细节一无所知。

> 那是我开着我的 Kombi 去海滩。

现在，回到封装。如果实现细节发生变化，那么在运行时使用该实现的类不需要改变。封装没有被破坏。

> 我也可以开着我的新车去海滩。封装没有被破坏。

如果实现细节发生变化，DI 容器（或工厂）确实需要改变。首先，您从未试图向工厂隐藏实施细节。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2018-03-22T02:11:08.650

DI 违反了非共享对象的封装 - 句号。共享对象的生命周期在被创建对象之外，因此必须聚合到被创建对象中。对正在创建的对象私有的对象应该组合到创建的对象中 - 当创建的对象被销毁时，它会带上组合的对象。我们以人体为例。什么是合成的，什么是聚合的。如果我们使用 DI，人体构造函数将有 100 个对象。例如，许多器官（可能）是可更换的。但是，它们仍然组成了身体。血细胞每天在体内产生（并被破坏），无需外部影响（蛋白质除外）。因此，血细胞是由身体内部产生的 - new BloodCell()。

Advocators of DI argue that an object should NEVER use the new operator. That "purist" approach not only violates encapsulation but also the Liskov Substitution Principle for whoever is creating the object.

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-06-25T20:02:23.407

我也为这个想法苦苦挣扎。起初，使用 DI 容器（如 Spring）来实例化对象的“要求”感觉就像是在跳跃。但实际上，它真的不是一个箍——它只是另一种“发布”的方式来创建我需要的对象。当然，封装被“破坏”了，因为“类外”的某个人知道它需要什么，但实际上并不是系统的其他部分知道这一点——它是 DI 容器。没有什么神奇的事情发生不同，因为 DI“知道”一个对象需要另一个对象。

事实上，它变得更好 - 通过专注于工厂和存储库，我什至根本不需要知道 DI 参与其中！对我来说，这让盖子重新回到了封装上。哇！

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2010-04-25T19:51:37.540

PS。通过提供**依赖注入**，您***不一定会***破坏**封装**。例子：

```
obj.inject_dependency(  factory.get_instance_of_unknown_class(x)  ); 
```

客户端代码仍然不知道实现细节。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2010-06-04T17:11:04.500

也许这是一种幼稚的思考方式，但是接受整数参数的构造函数和接受服务作为参数的构造函数之间有什么区别？这是否意味着在新对象之外定义一个整数并将其输入对象会破坏封装？如果该服务仅在新对象中使用，我看不出这会如何破坏封装。

此外，通过使用某种自动装配功能（例如 C# 的 Autofac），它使代码非常干净。通过为 Autofac 构建器构建扩展方法，我能够删减大量的 DI 配置代码，随着依赖项列表的增长，我必须随着时间的推移维护这些代码。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2017-10-25T20:20:20.873

我认为不言而喻，至少 DI 显着削弱了封装性。除此之外，还有 DI 的其他一些缺点需要考虑。

1.  它使代码更难重用。客户端可以使用而无需显式提供依赖关系的模块显然比客户端必须以某种方式发现该组件的依赖关系然后以某种方式使它们可用的模块更容易使用。例如，最初创建用于 ASP 应用程序的组件可能期望其依赖项由 DI 容器提供，该 DI 容器为对象实例提供与客户端 http 请求相关的生命周期。在另一个没有与原始 ASP 应用程序相同的内置 DI 容器的客户端中重现这可能并不简单。

2.  它可以使代码更加脆弱。接口规范提供的依赖关系可以以意想不到的方式实现，这会导致一整类运行时错误，而这些错误是静态解决的具体依赖关系所不可能实现的。

3.  从某种意义上说，它可能会使代码的灵活性降低，因为您最终可能会在希望其工作方式方面做出更少的选择。并非每个类都需要在拥有实例的整个生命周期内都存在其所有依赖项，但是对于许多 DI 实现，您别无选择。

考虑到这一点，我认为最重要的问题变成了“**是否需要从外部指定特定的依赖项？** ”。在实践中，我很少发现有必要为了支持测试而在外部提供依赖项。

在真正需要外部提供依赖关系的情况下，这通常表明对象之间的关系是协作而不是内部依赖关系，在这种情况下，适当的目标是封装*每个*类，而不是将一个类封装在另一个类中.

根据我的经验，关于使用 DI 的主要问题是，无论您是从具有内置 DI 的应用程序框架开始，还是将 DI 支持添加到您的代码库中，出于某种原因，人们认为既然您有 DI 支持，那一定是正确的实例化*一切*的方式。他们甚至都懒得问“这种依赖是否需要在外部指定？”。更糟糕的是，他们还开始试图强迫其他人也对所有事情都使用 DI*支持*。

这样做的结果是，你的代码库不可避免地开始演变为一种状态，在你的代码库中创建任何实例都需要大量迟钝的 DI 容器配置，并且调试任何东西的难度都是两倍，因为你有额外的工作量来尝试确定如何以及实例化任何东西的地方。

所以我对这个问题的回答是这样的。**使用 DI，您可以确定它为您解决的实际问题，这是您无法以任何其他方式更简单地解决的问题。**

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2010-07-19T21:39:14.597

我同意极端情况下，DI 可能违反封装。通常 DI 会暴露从未真正封装过的依赖项。这是从 Miško Hevery 的[Singletons are Pathological Liars 中](http://misko.hevery.com/2008/08/17/singletons-are-pathological-liars/)借用的一个简化示例：

您从 CreditCard 测试开始并编写一个简单的单元测试。

```
@Test
public void creditCard_Charge()
{
    CreditCard c = new CreditCard("1234 5678 9012 3456", 5, 2008);
    c.charge(100);
} 
```

下个月你会收到一张 100 美元的账单。你为什么被指控？单元测试影响了生产数据库。在内部，CreditCard 调用`Database.getInstance()`. 重构 CreditCard 使其`DatabaseInterface`在其构造函数中采用 a 暴露了存在依赖的事实。但我会争辩说，从一开始就没有封装依赖关系，因为 CreditCard 类会导致外部可见的副作用。如果你想在不重构的情况下测试 CreditCard，你当然可以观察依赖关系。

```
@Before
public void setUp()
{
    Database.setInstance(new MockDatabase());
}

@After
public void tearDown()
{
    Database.resetInstance();
} 
```

我认为将数据库作为依赖项公开是否会减少封装并不值得担心，因为这是一个很好的设计。并非所有 DI 决策都会如此直接。但是，其他答案都没有显示反例。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2012-08-09T07:39:58.637

我认为这是一个范围问题。当您定义封装（不让知道如何）时，您必须定义什么是封装的功能。

1.  **按原样上课**：您所封装的是班级的唯一责任。它知道该怎么做。例如，排序。如果您注入一些比较器进行排序，比如说客户，那不是封装的一部分：快速排序。

2.  **已配置的功能**：如果您想提供即用型功能，那么您提供的不是 QuickSort 类，而是配置了 Comparator 的 QuickSort 类的实例。在这种情况下，负责创建和配置的代码必须对用户代码隐藏。这就是封装。

当您对类进行编程时，在类中实现单一职责时，您正在使用选项 1。

当你在编写应用程序时，就是做一些可以承担一些有用的*具体*工作的东西，然后你会重复使用选项 2。

这是配置实例的实现：

```
<bean id="clientSorter" class="QuickSort">
   <property name="comparator">
      <bean class="ClientComparator"/>
   </property>
</bean> 
```

这是其他一些客户端代码使用它的方式：

```
<bean id="clientService" class"...">
   <property name="sorter" ref="clientSorter"/>
</bean> 
```

它是封装的，因为如果您更改实现（更改`clientSorter`bean 定义），它不会破坏客户端的使用。也许，当您使用所有一起编写的 xml 文件时，您会看到所有细节。但请相信我，客户端代码 ( `ClientService`) 对它的分拣机一无所知*。*

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2015-05-26T12:53:02.863

可能值得一提的是，这`Encapsulation`在某种程度上取决于视角。

```
public class A { 
    private B b;

    public A() {
        this.b = new B();
    }
}

public class A { 
    private B b;

    public A(B b) {
        this.b = b;
    }
} 
```

从在`A`课堂上工作的人的角度来看，在第二个例子中 `A`，对`this.b`

而没有 DI

```
new A() 
```

对比

```
new A(new B()) 
```

看这段代码的人更了解`A`第二个例子中的本质。

使用 DI，至少所有泄露的知识都集中在一个地方。

# c++ - 如何检测类中是否存在特定的成员变量？

> ID：1005476
> 
> 赞同：76
> 
> 时间：2009-06-17T06:58:38.790
> 
> 标签：c++, visual-studio, templates, g++, sfinae

为了创建算法模板函数，我需要知道作为模板参数的类中的 x 或 X（以及 y 或 Y）。在将我的函数用于 MFC CPoint 类或 GDI+ PointF 类或其他一些类时，它可能很有用。他们都在其中使用不同的 x。我的解决方案可以简化为以下代码：

```
 template<int> struct TT {typedef int type;};
template<class P> bool Check_x(P p, typename TT<sizeof(&P::x)>::type b = 0) { return true; }
template<class P> bool Check_x(P p, typename TT<sizeof(&P::X)>::type b = 0) { return false; }

struct P1 {int x; };
struct P2 {float X; };
// it also could be struct P3 {unknown_type X; };

int main()
{
    P1 p1 = {1};
    P2 p2 = {1};

    Check_x(p1); // must return true
    Check_x(p2); // must return false

    return 0;
} 
```

但它不能在 Visual Studio 中编译，而在 GNU C++ 中编译。使用 Visual Studio，我可以使用以下模板：

```
 template<class P> bool Check_x(P p, typename TT<&P::x==&P::x>::type b = 0) { return true; }
template<class P> bool Check_x(P p, typename TT<&P::X==&P::X>::type b = 0) { return false; } 
```

但它不能在 GNU C++ 中编译。有通用的解决方案吗？

UPD：此处的结构 P1 和 P2 仅作为示例。可能有任何具有未知成员的类。

PS 请不要在此处发布 C++11 解决方案，因为它们很明显且与问题无关。

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2013-04-14T14:38:05.717

[这是一个](https://stackoverflow.com/a/1007175/1137388)比 [Johannes Schaub-litb](https://stackoverflow.com/users/34509/johannes-schaub-litb)的解决方案更简单的解决方案。它需要 C++11。

```
#include <type_traits>

template <typename T, typename = int>
struct HasX : std::false_type { };

template <typename T>
struct HasX <T, decltype((void) T::x, 0)> : std::true_type { }; 
```

**更新**：一个简单的例子和​​它是如何工作的解释。

对于这些类型：

```
struct A { int x; };
struct B { int y; }; 
```

我们有`HasX<A>::value == true`和`HasX<B>::value == false`。让我们看看为什么。

首先回想一下，`std::false_type`并且`std::true_type`有一个`static constexpr bool`名为的成员分别`value`设置为`false`和`true`。因此，上面的两个模板`HasX`继承了这个成员。（第一个模板来自`std::false_type`，第二个模板来自`std::true_type`。）

让我们从简单开始，然后逐步进行，直到我们得到上面的代码。

1) 起点：

```
template <typename T, typename U>
struct HasX : std::false_type { }; 
```

在这种情况下，并不奇怪：`HasX`派生自`std::false_type`and 因此`HasX<bool, double>::value == false`and `HasX<bool, int>::value == false`。

2) 违约`U`：

```
// Primary template
template <typename T, typename U = int>
struct HasX : std::false_type { }; 
```

鉴于`U`默认为`int`,`Has<bool>`实际上意味着`HasX<bool, int>`, 因此`HasX<bool>::value == HasX<bool, int>::value == false`.

3）添加专业：

```
// Primary template
template <typename T, typename U = int>
struct HasX : std::false_type { };

// Specialization for U = int
template <typename T>
struct HasX<T, int> : std::true_type { }; 
```

通常，由于主模板，`HasX<T, U>`派生自`std::false_type`. 但是，存在一个`U = int`衍生自的专业化`std::true_type`。因此，`HasX<bool, double>::value == false`但是`HasX<bool, int>::value == true`。

感谢 , 的默认`U`设置`HasX<bool>::value == HasX<bool, int>::value == true`。

4）`decltype`和一种花哨的说法`int`：

这里有点题外话，但请多多包涵。

基本上（这并不完全正确），`decltype(expression)`产生 *表达式*的类型。例如，`0`有类型`int`因此，`decltype(0)`意味着`int`。类似地，`1.2`有类型`double`，因此，`decltype(1.2)`意味着`double`。

考虑一个具有此声明的函数：

```
char func(foo, int); 
```

`foo`一些类类型在哪里。如果`f`是类型的对象`foo`，则`decltype(func(f, 0))`表示`char`（返回的类型`func(f, 0)`）。

现在，表达式`(1.2, 0)`使用（内置）逗号运算符按顺序计算两个子表达式（即 first`1.2`和 then `0`），丢弃第一个值并产生第二个值。因此，

```
int x = (1.2, 0); 
```

相当于

```
int x = 0; 
```

把它和它放在一起`decltype`给出了那个`decltype(1.2, 0)`意思`int`。这里没有什么特别`1.2`的`double`。例如，`true`也有类型`bool`和`decltype(true, 0)`手段`int`。

类类型呢？例如，这是什么`decltype(f, 0)`意思？很自然地期望这仍然意味着`int`，但可能并非如此。实际上，逗号运算符可能存在重载，类似于`func`上面的函数，它接受 a`foo`和 an`int`并返回 a `char`。在这种情况下，`decltype(foo, 0)`是`char`。

我们如何避免对逗号运算符使用重载？好吧，没有办法为操作数重载逗号运算符`void`，我们可以将任何内容强制转换为`void`. 因此，`decltype((void) f, 0)`意味着`int`。实际上，从to `(void) f`which的转换基本上什么也不做，只是说必须将表达式视为具有 type 。然后使用内置的运算符逗号，结果是which has type 。因此，意味着。`f``foo``void``void``((void) f, 0)``0``int``decltype((void) f, 0)``int`

这个演员阵容真的有必要吗？好吧，如果逗号运算符没有过载，`foo`那么`int`这不是必需的。我们总是可以检查源代码，看看是否有这样的操作符。但是，如果它出现在模板中并且`f`具有`V`作为模板参数的类型，则不再清楚（甚至不可能知道）逗号运算符的这种重载是否存在。为了通用，我们无论如何都会投射。

底线：`decltype((void) f, 0)`是一种花哨的说法`int`。

5）SFINAE：

这是一门完整的科学；-) 好吧，我在夸大其词，但这也不是很简单。所以我会把解释保持在最低限度。

SFINAE 代表替换失败不是错误。这意味着当模板参数被类型替换时，可能会出现非法 C++ 代码，但*在某些情况下*，编译器不会中止编译，而是简单地忽略有问题的代码，就好像它不存在一样。让我们看看它如何应用于我们的案例：

```
// Primary template
template <typename T, typename U = int>
struct HasX : std::false_type { };

// Specialization for U = int
template <typename T>
struct HasX <T, decltype((void) T::x, 0)> : std::true_type { }; 
```

再次，这里`decltype((void) T::x, 0)`是一种奇特的说法，`int`但得益于 SFINAE。

当`T`用类型替换时，可能会出现无效的构造。例如，`bool::x`不是有效的 C++，因此`T`用`bool`in替换会`T::x`产生无效的构造。在 SFINAE 原则下，编译器不会拒绝代码，它只是忽略（部分）它。更准确地说，正如我们所看到的，`HasX<bool>`实际上是指`HasX<bool, int>`。`U = int`应该选择for 的特化，但是在实例化它时，编译器会找到`bool::x`并完全忽略模板特化，就好像它不存在一样。

此时，代码与上面仅存在主模板的情况 (2) 基本相同。因此，`HasX<bool, int>::value == false`。

`bool`用于自成立`B`以来的相同参数`B::x`是无效的构造（`B`没有成员`x`）。但是，`A::x`没关系，编译器在实例化 for `U = int`（或更准确地说， for `U = decltype((void) A::x, 0)`）的专门化方面没有任何问题。因此，`HasX<A>::value == true`。

6) 取名`U`：

好吧，再次查看 (5) 中的代码，我们看到该名称`U`没有在任何地方使用，而是在其声明 ( `typename U`) 中使用。然后我们可以取消第二个模板参数的名称，并获得本文顶部显示的代码。

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2009-06-17T13:52:37.303

另一种方式是这种方式，它也依赖于[SFINAE 的表达式](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2634.html)。如果名称查找导致歧义，编译器将拒绝该模板

```
template<typename T> struct HasX { 
    struct Fallback { int x; }; // introduce member name "x"
    struct Derived : T, Fallback { };

    template<typename C, C> struct ChT; 

    template<typename C> static char (&f(ChT<int Fallback::*, &C::x>*))[1]; 
    template<typename C> static char (&f(...))[2]; 

    static bool const value = sizeof(f<Derived>(0)) == 2;
}; 

struct A { int x; };
struct B { int X; };

int main() { 
    std::cout << HasX<A>::value << std::endl; // 1
    std::cout << HasX<B>::value << std::endl; // 0
} 
```

它基于usenet 上某人的一个绝妙想法。

注意：HasX 检查任何名为 x 的数据或函数成员，具有任意类型。引入成员名称的唯一目的是为成员名称查找提供可能的歧义 - 成员的类型并不重要。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2013-01-25T14:27:20.203

我从一个[问题](https://stackoverflow.com/questions/14522939/check-whether-a-field-exists-in-a-struct)被重定向到这里，该问题已作为该问题的副本关闭。我知道这是一个旧线程，但我只是想建议一个可用于 C++11 的替代（更简单？）实现。假设我们要检查某个类是否有一个名为的成员变量`id`：

```
#include <type_traits>

template<typename T, typename = void>
struct has_id : std::false_type { };

template<typename T>
struct has_id<T, decltype(std::declval<T>().id, void())> : std::true_type { }; 
```

就是这样。以下是它的使用方式（[*现场示例*](http://coliru.stacked-crooked.com/a/8f1b5a38d87de415)）：

```
#include <iostream>

using namespace std;

struct X { int id; };
struct Y { int foo; };

int main()
{
    cout << boolalpha;
    cout << has_id<X>::value << endl;
    cout << has_id<Y>::value << endl;
} 
```

使用几个宏可以使事情变得更加简单：

```
#define DEFINE_MEMBER_CHECKER(member) \
    template<typename T, typename V = bool> \
    struct has_ ## member : false_type { }; \
    template<typename T> \
    struct has_ ## member<T, \
        typename enable_if< \
            !is_same<decltype(declval<T>().member), void>::value, \
            bool \
            >::type \
        > : true_type { };

#define HAS_MEMBER(C, member) \
    has_ ## member<C>::value 
```

可以这样使用：

```
using namespace std;

struct X { int id; };
struct Y { int foo; };

DEFINE_MEMBER_CHECKER(foo)

int main()
{
    cout << boolalpha;
    cout << HAS_MEMBER(X, foo) << endl;
    cout << HAS_MEMBER(Y, foo) << endl;
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-06-12T21:49:30.870

**更新：我最近对我在原始答案中发布的代码做了更多的事情，所以我正在更新它以考虑更改/添加。**

以下是一些用法片段： *所有这些的胆量都在更远的地方

**检查`x`给定类中的成员。可以是 var、func、class、union 或 enum：**

```
CREATE_MEMBER_CHECK(x);
bool has_x = has_member_x<class_to_check_for_x>::value; 
```

**检查成员函数`void x()`：**

```
//Func signature MUST have T as template variable here... simpler this way :\
CREATE_MEMBER_FUNC_SIG_CHECK(x, void (T::*)(), void__x);
bool has_func_sig_void__x = has_member_func_void__x<class_to_check_for_x>::value; 
```

**检查成员变量`x`：**

```
CREATE_MEMBER_VAR_CHECK(x);
bool has_var_x = has_member_var_x<class_to_check_for_x>::value; 
```

**检查成员类`x`：**

```
CREATE_MEMBER_CLASS_CHECK(x);
bool has_class_x = has_member_class_x<class_to_check_for_x>::value; 
```

**检查会员工会`x`：**

```
CREATE_MEMBER_UNION_CHECK(x);
bool has_union_x = has_member_union_x<class_to_check_for_x>::value; 
```

**检查成员枚举`x`：**

```
CREATE_MEMBER_ENUM_CHECK(x);
bool has_enum_x = has_member_enum_x<class_to_check_for_x>::value; 
```

**`x`无论签名如何，检查任何成员函数：**

```
CREATE_MEMBER_CHECK(x);
CREATE_MEMBER_VAR_CHECK(x);
CREATE_MEMBER_CLASS_CHECK(x);
CREATE_MEMBER_UNION_CHECK(x);
CREATE_MEMBER_ENUM_CHECK(x);
CREATE_MEMBER_FUNC_CHECK(x);
bool has_any_func_x = has_member_func_x<class_to_check_for_x>::value; 
```

或者

```
CREATE_MEMBER_CHECKS(x);  //Just stamps out the same macro calls as above.
bool has_any_func_x = has_member_func_x<class_to_check_for_x>::value; 
```

**细节和核心：**

```
/*
    - Multiple inheritance forces ambiguity of member names.
    - SFINAE is used to make aliases to member names.
    - Expression SFINAE is used in just one generic has_member that can accept
      any alias we pass it.
*/

template <typename... Args> struct ambiguate : public Args... {};

template<typename A, typename = void>
struct got_type : std::false_type {};

template<typename A>
struct got_type<A> : std::true_type {
    typedef A type;
};

template<typename T, T>
struct sig_check : std::true_type {};

template<typename Alias, typename AmbiguitySeed>
struct has_member {
    template<typename C> static char ((&f(decltype(&C::value))))[1];
    template<typename C> static char ((&f(...)))[2];

    //Make sure the member name is consistently spelled the same.
    static_assert(
        (sizeof(f<AmbiguitySeed>(0)) == 1)
        , "Member name specified in AmbiguitySeed is different from member name specified in Alias, or wrong Alias/AmbiguitySeed has been specified."
    );

    static bool const value = sizeof(f<Alias>(0)) == 2;
}; 
```

***宏（暗黑破坏神！）：***

**CREATE_MEMBER_CHECK：**

```
//Check for any member with given name, whether var, func, class, union, enum.
#define CREATE_MEMBER_CHECK(member)                                         \
                                                                            \
template<typename T, typename = std::true_type>                             \
struct Alias_##member;                                                      \
                                                                            \
template<typename T>                                                        \
struct Alias_##member <                                                     \
    T, std::integral_constant<bool, got_type<decltype(&T::member)>::value>  \
> { static const decltype(&T::member) value; };                             \
                                                                            \
struct AmbiguitySeed_##member { char member; };                             \
                                                                            \
template<typename T>                                                        \
struct has_member_##member {                                                \
    static const bool value                                                 \
        = has_member<                                                       \
            Alias_##member<ambiguate<T, AmbiguitySeed_##member>>            \
            , Alias_##member<AmbiguitySeed_##member>                        \
        >::value                                                            \
    ;                                                                       \
} 
```

**CREATE_MEMBER_VAR_CHECK：**

```
//Check for member variable with given name.
#define CREATE_MEMBER_VAR_CHECK(var_name)                                   \
                                                                            \
template<typename T, typename = std::true_type>                             \
struct has_member_var_##var_name : std::false_type {};                      \
                                                                            \
template<typename T>                                                        \
struct has_member_var_##var_name<                                           \
    T                                                                       \
    , std::integral_constant<                                               \
        bool                                                                \
        , !std::is_member_function_pointer<decltype(&T::var_name)>::value   \
    >                                                                       \
> : std::true_type {} 
```

**CREATE_MEMBER_FUNC_SIG_CHECK：**

```
//Check for member function with given name AND signature.
#define CREATE_MEMBER_FUNC_SIG_CHECK(func_name, func_sig, templ_postfix)    \
                                                                            \
template<typename T, typename = std::true_type>                             \
struct has_member_func_##templ_postfix : std::false_type {};                \
                                                                            \
template<typename T>                                                        \
struct has_member_func_##templ_postfix<                                     \
    T, std::integral_constant<                                              \
        bool                                                                \
        , sig_check<func_sig, &T::func_name>::value                         \
    >                                                                       \
> : std::true_type {} 
```

**CREATE_MEMBER_CLASS_CHECK：**

```
//Check for member class with given name.
#define CREATE_MEMBER_CLASS_CHECK(class_name)               \
                                                            \
template<typename T, typename = std::true_type>             \
struct has_member_class_##class_name : std::false_type {};  \
                                                            \
template<typename T>                                        \
struct has_member_class_##class_name<                       \
    T                                                       \
    , std::integral_constant<                               \
        bool                                                \
        , std::is_class<                                    \
            typename got_type<typename T::class_name>::type \
        >::value                                            \
    >                                                       \
> : std::true_type {} 
```

**CREATE_MEMBER_UNION_CHECK：**

```
//Check for member union with given name.
#define CREATE_MEMBER_UNION_CHECK(union_name)               \
                                                            \
template<typename T, typename = std::true_type>             \
struct has_member_union_##union_name : std::false_type {};  \
                                                            \
template<typename T>                                        \
struct has_member_union_##union_name<                       \
    T                                                       \
    , std::integral_constant<                               \
        bool                                                \
        , std::is_union<                                    \
            typename got_type<typename T::union_name>::type \
        >::value                                            \
    >                                                       \
> : std::true_type {} 
```

**CREATE_MEMBER_ENUM_CHECK：**

```
//Check for member enum with given name.
#define CREATE_MEMBER_ENUM_CHECK(enum_name)                 \
                                                            \
template<typename T, typename = std::true_type>             \
struct has_member_enum_##enum_name : std::false_type {};    \
                                                            \
template<typename T>                                        \
struct has_member_enum_##enum_name<                         \
    T                                                       \
    , std::integral_constant<                               \
        bool                                                \
        , std::is_enum<                                     \
            typename got_type<typename T::enum_name>::type  \
        >::value                                            \
    >                                                       \
> : std::true_type {} 
```

**CREATE_MEMBER_FUNC_CHECK：**

```
//Check for function with given name, any signature.
#define CREATE_MEMBER_FUNC_CHECK(func)          \
template<typename T>                            \
struct has_member_func_##func {                 \
    static const bool value                     \
        = has_member_##func<T>::value           \
        && !has_member_var_##func<T>::value     \
        && !has_member_class_##func<T>::value   \
        && !has_member_union_##func<T>::value   \
        && !has_member_enum_##func<T>::value    \
    ;                                           \
} 
```

**CREATE_MEMBER_CHECKS：**

```
//Create all the checks for one member.  Does NOT include func sig checks.
#define CREATE_MEMBER_CHECKS(member)    \
CREATE_MEMBER_CHECK(member);            \
CREATE_MEMBER_VAR_CHECK(member);        \
CREATE_MEMBER_CLASS_CHECK(member);      \
CREATE_MEMBER_UNION_CHECK(member);      \
CREATE_MEMBER_ENUM_CHECK(member);       \
CREATE_MEMBER_FUNC_CHECK(member) 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-04-22T20:09:22.440

[Boost.ConceptTraits](https://svn.boost.org/trac/boost/wiki/LibrariesUnderConstruction#Boost.ConceptTraits)提供了一些宏来定义类型特征，例如`BOOST_TT_EXT_DEFINE_HAS_MEMBER(name)`，它定义了以下形式的类型特征：

```
has_member_##name<T> 
```

如果 T 有一个名为 的成员类型，则为真。但是请注意，这不会检测到引用类型成员。

在您的情况下，添加头文件就足够了

```
BOOST_TT_EXT_DEFINE_HAS_MEMBER_TYPE(x) 
```

并检查如下

```
BOOST_STATIC_ASSERT(has_member_x<P1>::value); 
```

使用的技术与前面一些答案中解释的技术相同。

不幸的是，这个库不再维护。现在 C++0x 将不包含概念，这个库与 SFINAE 一起是处理大多数概念的完美替代品。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-17T07:20:36.987

你为什么不使用这样的专业化：

```
struct P1 {int x; };
struct P2 {int X; };

template<class P> 
bool Check_x(P p) { return true; }

template<> 
bool Check_x<P2>(P2 p) { return false; } 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-10-19T18:50:58.573

我们可以使用[C++20 的 requires 表达式](https://en.cppreference.com/w/cpp/language/constraints#Requires_expressions)来解决这个问题。h/t 致[@lefticus](https://twitter.com/lefticus)，他最近在[C++ Weekly - Ep 242 - Design By Introspection in C++20 中发布了此方法（概念 + if constexpr](https://www.youtube.com/watch?v=sy32kAtsIKg&feature=youtu.be)：

```
#include <iostream>

struct P1 {int x;};
struct P2 {float X;};

bool has_x(const auto &obj) {
    if constexpr (requires {obj.x;}) {
      return true;
    } else
      return false;
}

int main()
{
    P1 p1 = {1};
    P2 p2 = {1};

    std::cout << std::boolalpha << has_x(p1) << "\n"; 
    std::cout << has_x(p2) << "\n"; 

    return 0;
} 
```

[你可以在这里](https://godbolt.org/z/EefYM5)看到它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-17T07:22:33.113

为什么不直接创建 Check_x 的模板特化？

```
template<> bool Check_x(P1 p) { return true; }
template<> bool Check_x(P2 p) { return false; } 
```

哎呀，当我想到它的时候。如果你只有两种类型，为什么还需要模板呢？

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-17T10:13:20.400

函数 (x, X, y, Y) 是来自抽象基类，还是可以重构为这样？如果是这样，您可以使用 Modern C++ Design 中的 SUPERSUBCLASS() 宏，以及来自这个问题的答案的想法：

[基于编译时类型的调度](https://stackoverflow.com/questions/145814/compile-time-type-based-dispatch)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-07-27T12:56:27.823

我们可以在编译时得到：`0 - not_member, 1 - is_object, 2 - is_function`对于每个需要的类和成员-对象或函数：http: [//ideone.com/Fjm9u5](http://ideone.com/Fjm9u5)

```
#include <iostream>
#include <type_traits>

#define IS_MEMBER(T1, M)    \
struct {        \
    struct verystrangename1 { bool M; };    \
    template<typename T> struct verystrangename2 : verystrangename1, public T { }; \
    \
    enum return_t { not_member, is_object, is_function }; \
    template<typename T, typename = decltype(verystrangename2<T>::M)> constexpr return_t what_member() { return not_member;  }  \
    template<typename T> typename std::enable_if<std::is_member_object_pointer<decltype(&T::M)>::value, return_t>::type constexpr what_member() { return is_object; }   \
    template<typename T> typename std::enable_if<std::is_member_function_pointer<decltype(&T::M)>::value, return_t>::type constexpr what_member() { return is_function; }   \
    constexpr operator return_t() { return what_member<T1>(); } \
}

struct t {
    int aaa;
    float bbb;
    void func() {}
};

// Can't be in function
IS_MEMBER(t, aaa) is_aaa_member_of_t;
IS_MEMBER(t, ccc) is_ccc_member_of_t;
IS_MEMBER(t, func) is_func_member_of_t;

// known at compile time
enum { const_is_aaa_member_of_t = (int)is_aaa_member_of_t };
static constexpr int const_is_func_member_of_t = is_func_member_of_t;

int main() {        
    std::cout << std::boolalpha << "0 - not_member, 1 - is_object, 2 - is_function \n\n" <<
        "is aaa member of t = " << is_aaa_member_of_t << std::endl << 
        "is ccc member of t = " << is_ccc_member_of_t << std::endl << 
        "is func member of t = " << is_func_member_of_t << std::endl << 
        std::endl;

    return 0;
} 
```

结果：

```
0 - not_member, 1 - is_object, 2 - is_function 

is aaa member of t = 1
is ccc member of t = 0
is func member of t = 2 
```

对于类/结构：

```
struct t {
    int aaa;
    float bbb;
    void func() {}
}; 
```

# asp.net - 从控制器构造函数访问 Request.Cookies

> ID：1005478
> 
> 赞同：4
> 
> 时间：2009-06-17T06:59:24.810
> 
> 标签：asp.net, asp.net-mvc, cookies

我正在使用 FormsAuthenticationTicket 的 UserData 属性来存储一些用户特定的信息。我有一个 HelperClass 将这个 UserData 反序列化为一个自定义对象以进行强类型访问。我的控制器设置如下

```
public class SomeController : Controller
{
    private CookieData _cookieData;

    public SomeController()
    {
        _service = new ForderungsStellerService(new ModelStateWrapper(this.ModelState));
        HttpCookie cookie = Request.Cookies[FormsAuthentication.FormsCookieName];
        FormsAuthenticationTicket ticket = FormsAuthentication.Decrypt(cookie.Value);
        _cookieData= GetSessionData.FromCookie(ticket);
    }
} 
```

问题似乎是，请求在控制器构造时为空。从 ActionMethod 访问 Request.Cookies 时，此代码段正在工作。

出于 DRY 的原因，我希望在构造函数中填充 _cookieData 对象。

有人对这个问题有提示吗？

最好的祝福...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T07:05:58.637

我将创建一个了解 CookieData 以及如何将其从 Request 对象中取出的 ModelBinder。我担心使构造函数满意所必需的单元测试创​​建代码。如果您将其作为具有模型绑定器的控制器的参数，则可以避免该测试开销。

```
public class SomeController : Controller
{
  // only need to pass in the data object for unit testing.
  // ModelBinder takes care of DRY
  public ActionResult Index(CookieData cookieData)
  {
  }
} 
```

为什么它在构造函数中不起作用的答案是此时控制器尚未使用 ControllerContext 初始化。

```
public HttpContextBase HttpContext {
  get {
    return ControllerContext == null 
      ? null 
      : ControllerContext.HttpContext;
  }
} 
```

如果您**真的**想在构造函数中执行此操作（不要），请使用 HttpContext.Request 而不是包装器。但是这样做会使您的代码无法测试，并且您的对齐方式将下降 3 分。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-17T08:17:41.100

覆盖 Controller.Initialize()：

```
protected override void Initialize(RequestContext requestContext) {
  base.Initialize(requestContext);
  // do further initialization here
} 
```

Properties like Request, etc. will be available to you after the call to base.Initialize().

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T07:32:44.187

DRY 很好，但在 ASP.NET MVC 的情况下，它通常意味着使用自定义过滤器属性，或者像 talljoe 显示的模型绑定器。

```
 public override void OnActionExecuting(ActionExecutingContext filterContext)
     {
         HttpCookie cookie = filterContext.HttpContext.Request.Cookies[FormsAuthentication.FormsCookieName];
        FormsAuthenticationTicket ticket = FormsAuthentication.Decrypt(cookie.Value);
        filterContext.ActionParameters["CookieData"] = GetSessionData.FromCookie(ticket);

         base.OnActionExecuting(filterContext);
     } 
```

# java - 查看类依赖图插件？

> ID：1005479
> 
> 赞同：37
> 
> 时间：2009-06-17T06:59:25.450
> 
> 标签：java, eclipse, eclipse-plugin, eclipse-rcp, eclipse-3.4

是否有任何我可以用于 Eclipse 的插件来显示类依赖项的图形视图？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-17T07:29:26.673

**[Classycle](http://classycleplugin.graf-tec.ch/index.html)**可以是一个好的开始（至少对于类之间的静态依赖关系）

（虽然我发现他们的图表有点复杂：[CDA - Class Dependency Analyzer](https://stackoverflow.com/questions/62276/java-package-cycle-detection-how-to-find-the-specific-classes-involved/71610#71610) is an external tool，但产生更具可读性的依赖图）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-12-15T18:35:51.117

[stan4j](http://stan4j.com/)：

*   免费供私人使用
*   用于商业用途需要许可证
*   主页上的视频很好地演示了功能

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-17T10:35:16.533

如需更深入的分析，请查看[nWire](http://www.nwiresoftware.com/)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-28T14:13:06.573

我发现 ispace => [http://ispace.stribor.de/](http://ispace.stribor.de/)非常适合显示循环依赖等。提示：在每次重大重构后清理项目以使其更新图表。

# c# - 重启后台工作者

> ID：1005480
> 
> 赞同：5
> 
> 时间：2009-06-17T06:59:33.000
> 
> 标签：c#, .net, backgroundworker

有没有办法直接“重启”后台工作人员？调用 CancelAsync() 后跟 RunWorkerAsync() 显然不会像他们的名字所暗示的那样做。

背景信息：我有一个后台工作人员，它在我的 .net 2.0 Windows 窗体应用程序中计算总数。每当用户修改属于此总数的任何值时，我想重新启动后台工作程序以防它正在运行，以便直接考虑最新值。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-17T07:11:11.233

背景工作本身不做任何取消。

当您调用`bgw.CancelAsync`它时，它会在后台工作人员上设置一个标志，您需要在 DoWork 处理程序中检查自己。

就像是：

```
bool _restart = false;

private void button1_Click(object sender, EventArgs e)
{
    bgw.CancelAsync();
    _restart = true;
}

private void bgw_DoWork(object sender, DoWorkEventArgs e)
{

    for (int i = 0; i < 300; i++)
    {
        if (bgw.CancellationPending)
        {
            break;
        }
        //time consuming calculation
    }
}

private void bgw_WorkComplete(object sender, eventargs e)  //no ide to hand not sure on name/args
{
    if (_restart)
    {
        bgw.RunWorkerAsync();
        _restart = false;
    }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T07:17:35.340

有几种选择，这完全取决于你想如何给这只猫剥皮：

如果你想继续使用`BackgroundWorker`，那么你需要尊重已经建立的模型，即“进度敏感性”之一。里面的东西`DoWork`显然需要始终知道挂起的取消是否到期（即，需要在`DoWork`循环中进行一定数量的轮询）。

如果您的计算代码是单一的并且您不想弄乱它，那么不要使用`BackgroundWorker`，而是启动您自己的线程——这样您可以在需要时强行杀死它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T07:13:43.227

您可以挂钩更改值的控件的更改事件处理程序，并在处理程序中执行以下操作：

```
if(!bgWrkr.IsBusy)
     //start worker
else if(!bgWrkr.CancellationPending)
  bgWrkr.CancelAsync(); 
```

希望对你有帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-30T22:57:43.837

我想让我的请求继续运行，但不再关心结果。我覆盖了后台工作人员的值（我忙碌的微调器正在使用 isBusy 标志）。

```
 private void SearchWorkerCreate() {
        this.searchWorker = new BackgroundWorker();
        this.searchWorker.DoWork += this.SearchWorkerWork;
        this.searchWorker.RunWorkerCompleted += this.SearchWorkerFinish;
    }

    private void SearchWorkerStart(string criteria){
        if(this.searchWorker.IsBusy){
            this.SearchWorkerCreate();
        }
        this.searchWorker.RunWorkerAsync(criteria);
        this.OnPropertyChanged(() => this.IsBusy);
        this.OnPropertyChanged(() => this.IsIdle);
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-01-08T10:17:38.857

可以这种方法帮助某人...我创建了一个函数来以一种方法重置后台工作人员。我将它用于定期执行的任务。

通过创建一个`Task`，可以使用 停止后台工作程序`CancelAsync`并在任务内重新启动。正如 OP 所描述的，在取消任务之前，不创建任务将再次启动后台工作程序。

**唯一的要求是您的代码通过某个循环运行，该循环在每个时间段 ( `CheckPerMilliseconds`) 中检查 CancellationPending。**

```
private void ResetBackgroundWorker()
{
    backgroundWorker.CancelAsync();

    Task taskStart = Task.Run(() => 
    {
        Thread.Sleep(CheckPerMilliseconds);
        backgroundWorker.RunWorkerAsync();
    });
} 
```

在 backgroundworker 中，我使用了一个检查 CancellationPending 的 for 循环。

```
private void BackgroundWorker_DoWork(object sender, DoWorkEventArgs e)
{
    BackgroundWorker worker = sender as BackgroundWorker;

    while(true)
    {
        if (backgroundWorker.CancellationPending)
        {
            return;
        }

        //Do something you want to do periodically.

        for (int i = 0; i < minutesToDoTask * 60; i++)
        {
            if (backgroundWorker.CancellationPending)
            {
                return;
            }

            Thread.Sleep(CheckPerMilliseconds);
        }
    }
} 
```

# tfs - 如何使用巡航控制在不同的文件夹中发布网站

> ID：1005483
> 
> 赞同：1
> 
> 时间：2009-06-17T07:00:02.157
> 
> 标签：tfs, cruisecontrol.net

我能够使用巡航控制建立一个网站。但我无法在不同的文件夹中发布网站。我正在将巡航控制与 TFS 连接起来。如何使用巡航控制发布网站？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T07:06:21.867

不确定 TFS 如何影响事物，但在您的 ccnet.config 文件中，您的项目应该有两个节点：`workingDirectory`和`artifactDirectory`. `artifactDirectory`是生成的二进制文件等应该结束的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T21:58:12.623

假设项目是 Web 应用程序项目，您可以将 WebProjectOutputDir 参数添加到 CC.net 中的 msbuild 任务。

```
<msbuild>
  <executable>C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\MSBuild.exe</executable>
  <workingDirectory>C:\dev\ccnet</workingDirectory>
  <projectFile>CCNet.sln</projectFile>
<buildArgs>/noconsolelogger /p:Configuration=Debug /v:diag /p:WebProjectOutputDir=Output</buildArgs>
  <targets>Build;Test</targets>
  <timeout>900</timeout>
  <logger>C:\Program Files\CruiseControl.NET\server\ThoughtWorks.CruiseControl.MsBuild.dll</logger>
</msbuild> 
```

# php - 警告：mysql_connect()：无法连接到本地 MySQL 服务器

> ID：1005485
> 
> 赞同：3
> 
> 时间：2009-06-17T07:00:18.630
> 
> 标签：php, mysql

警告：mysql_connect(): Can't connect to local MySQL server through socket '/var/lib/mysql/mysql.sock' (11) in /home/aa/public_html/bb/db.php on line 2 无法连接：

我收到此错误，但问题是此错误出现不规律，有时不是一整天都出现，有时出现无数次。

这可能是什么原因？？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T07:16:52.220

这可能意味着 MYSQL 已关闭，或者您在连接时使用了错误的主机名。另一个可能的原因可能是 php 与 mysql 的套接字配置不同，您可以通过查看 mysql 配置中的入口套接字来检查它。文件并通过查看 phpinfo() 的输出，您只需要比较它。或者您机器上的其他人也可能使用该套接字。

PS。以及我的疯狂猜测，请检查您的代码并检查您是否始终正确关闭连接以及所有查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T08:46:31.930

确保您的 MySQL 正在运行。或创建一个名为：**phpinfo.php**的文件，其中包含以下内容：

```
<?php phpinfo(); ?> 
```

在浏览器中加载文件：**[http://localhost/phpinfo.php](http://localhost/phpinfo.php)**并向下滚动以找到**mysql**。查找**MYSQL_SOCKET**并确保它与您在**my.cnf 文件**中的条目相匹配。

仅供参考，我的 my.cnf 文件位于：**/etc/my.cnf**它包含如下内容：

```
# The MySQL server
[mysqld]
port            = 3306
socket          = /tmp/mysql.sock 
```

# javascript - Javascript AOP 库

> ID：1005486
> 
> 赞同：29
> 
> 时间：2009-06-17T07:01:05.540
> 
> 标签：javascript, aop

您使用哪个 Javascript AOP 库，它的主要功能是什么？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-06-17T08:00:10.917

这是我到目前为止发现的：

*   [dotvoid](http://www.dotvoid.com/2005/06/aspect-oriented-programming-and-javascript/)的实现，简洁的语法，很好用，这篇文章很好地介绍了为什么/如何使用给定的代码，支持介绍，但是有问题，
*   [Dojo 在dojox](http://api.dojotoolkit.org/jsdoc/1.3/dojox.lang.aspect)中似乎有一个很好的内置实现，[这里](http://lazutkin.com/blog/2008/may/18/aop-aspect-javascript-dojo/)有一个关于如何使用它的很好的介绍，
*   有一个 jQuery 插件[jquery-aop](http://code.google.com/p/jquery-aop/)，语法更粗略，在 javascript 对象中传递对象和方法，
*   [具有更粗略语法的AspectJS](http://zer0.free.fr/aspectjs/aspectjs.js)（需要将切入点类型作为参数传递给单个方法）

就像我说的，dotvoid 的代码不起作用。我稍微纠正了一下，得到了一些似乎效果更好的东西：

```
InvalidAspect = new Error("Missing a valid aspect. Aspect is not a function.");
InvalidObject = new Error("Missing valid object or an array of valid objects.");
InvalidMethod = new Error("Missing valid method to apply aspect on.");

function doBefore(beforeFunc,func){
    return function(){
        beforeFunc.apply(this,arguments);
        return func.apply(this,arguments);
    };  
}

function doAfter(func, afterFunc){
    return function(){
        var res = func.apply(this,arguments);
        afterFunc.apply(this,arguments);
        return res;   
    };
}

Aspects = function(){};
Aspects.prototype={
    _addIntroduction : function(intro, obj){
         for (var m in intro.prototype) {
              obj.prototype[m] = intro.prototype[m];
            }
        },

    addIntroduction : function(aspect, objs){
        var oType = typeof(objs);

        if (typeof(aspect) != 'function')
        throw(InvalidAspect);

        if (oType == 'function'){
            this._addIntroduction(aspect, objs);
        }
        else if (oType == 'object'){
            for (var n = 0; n < objs.length; n++){
                this._addIntroduction(aspect, objs[n]);
            }
        }
        else{
            throw InvalidObject;
        }
    },

    addBefore : function(aspect, obj, funcs){
          var fType = typeof(funcs);

          if (typeof(aspect) != 'function')
            throw(InvalidAspect);

          if (fType != 'object')
            funcs = Array(funcs);

          for (var n = 0; n < funcs.length; n++){
            var fName = funcs[n];
            var old = obj.prototype[fName];

            if (!old)
              throw InvalidMethod;

            var res = doBefore(aspect,old)
            obj.prototype[fName] = res;
        }
    },

    addAfter : function(aspect, obj, funcs) {
          if (typeof(aspect) != 'function')
            throw InvalidAspect;

          if (typeof(funcs) != 'object')
            funcs = Array(funcs);

          for (var n = 0; n < funcs.length; n++)
          {
            var fName = funcs[n];
            var old = obj.prototype[fName];

            if (!old)
              throw InvalidMethod;

            var res = doAfter(old,aspect);
            obj.prototype[fName] = res;
          }
        },

    addAround : function(aspect, obj, funcs){
          if (typeof(aspect) != 'function')
            throw InvalidAspect;

          if (typeof(funcs) != 'object')
            funcs = Array(funcs);

          for (var n = 0; n < funcs.length; n++)
          {
            var fName = funcs[n];
            var old = obj.prototype[fName];
            if (!old)
              throw InvalidMethod;

            var res = aspect(old);
            obj.prototype[fName] = res;
          }

          return true;
        }
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-01-30T21:19:12.330

你见过`meld.js`和`aop.js`来自 [https://github.com/cujojs](https://github.com/cujojs)吗？

SpringSource 在那里提供了 AOP 功能，此外还有许多其他对高级 Javascript 程序员有用的东西。

**免责声明**：我为 SpringSource 工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-21T04:20:23.830

基于 dotvoid 解决方案，我为自己的项目需求创建了自己的 JS AOP 版本。我基本上想最小化方面设置成本，所以我在 Function.prototype 中添加了方面设置功能。

```
Function.prototype.applyBefore = function (aspect, targetFuncNames) {
....
} 
```

我还需要支持 aync 回调，例如支持某些方法的身份验证和授权。例如：

```
var authenticateAspect = function (error, success, context, args) {
    logger.log('authenticate (applyBefore async) aspect is being called');
    var request = $.ajax({
        url: "http://localhost/BlogWeb/api/user/authenticate",
        type: "GET",
        data: { username:'jeff', pwd:'jeff' },
        success: function (data) {
            if (data) {
                success();
            } else {
                error();
            }
        },
        error: error
    });
    return request;
};

Person.applyBefore(authenticateAspect, 'sendNotification');

var p1 = new Person();

p1.sendNotification(); 
```

要实现这一点，我需要运行安全性并在成功时继续或在失败时停止执行。

```
var invalidAspect = new Error("Missing a valid aspect. Aspect is not a function."),
    invalidMethod = new Error("Missing valid method to apply aspect on.");

///Parameters: aspect - defines the methods we want call before or/and 
///             after each method call ob target obejct
///            targetFuncNames - target function names to apply aspects
///Return: it should return a new object with all aspects setup on target object
Function.prototype.applyBefore = function (aspect, targetFuncNames) {
    if (typeof (aspect) != 'function')
        throw invalidAspect;

    if (typeof (targetFuncNames) != 'object')
        targetFuncNames = Array(targetFuncNames);

    var targetObj = this;
    //error handling function

    // Copy the properties over onto the new prototype
    for (var i = 0, len = targetFuncNames.length; i < len; i++) {
        var funcName = targetFuncNames[i];
        var targetFunc = targetObj.prototype[funcName];

        if (!targetFunc)
            throw invalidMethod;

        targetObj.prototype[funcName] = function () {
            var self = this, args = arguments;
            var success = function() {
                return targetFunc.apply(self, args);
            };
            var error = function () {
                logger.log('applyBefore aspect failed to pass');
                //log the error and throw new error
                throw new Error('applyBefore aspect failed to pass');
            };

            var aspectResult = aspect.apply(null, Array.prototype.concat([error, success, self], args));
            return aspectResult;
        };
    }
}; 
```

完整的实现可以在[http://www.jeffjin.net/aop-with-javascript](http://www.jeffjin.net/aop-with-javascript)

# python - 关于python排序效率的一个问题

> ID：1005494
> 
> 赞同：1
> 
> 时间：2009-06-17T07:03:14.710
> 
> 标签：python, sorting

好的，所以我正在制作基于命令行的网站搜索功能实现。该网站按字母顺序列出了我需要的所有链接。

用法类似于

```
./find.py  LinkThatStartsWithB 
```

所以它会导航到与字母 B 关联的网页。我的问题是使用用户输入并导航到网页的最有效/最智能的方式是什么？

我最初的想法是使用列表然后获取单词的第一个字母并使用数字标识符来告诉列表索引中的位置。

（A = 1，B = 2...）示例代码：

```
#Use base url as starting point then add extension on end.
Base_URL = "http://www.website.com/"

#Use list index as representation of letter
Alphabetic_Urls = [
       "/extensionA.html",
       "/extensionB.html",
       "/extensionC.html",
       ] 
```

或者字典会是一个更好的选择吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T09:07:57.347

您如何获得此 URL 列表？

如果您的命令行应用程序正在爬取网站的链接，而您只是在寻找单个项目，那么构建字典是没有意义的。构建 dict 所花费的时间至少与边走边检查一样长！例如，只需搜索：

```
for link in mysite.getallLinks():
    if link[0] == firstletter:
        print link 
```

如果您要进行多次搜索（而不仅仅是单个命令行参数），*那么*可能值得使用以下内容构建字典：

```
import collections
d=collections.defaultdict(list)
for link in mysite.getallLinks():
    d[link[0]].append(link)             # Dict of first letter -> list of links

# Print all links starting with firstletter
for link in d[firstletter]:
    print link 
```

尽管考虑到只有 26 个存储桶，但它不会产生太大的影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T07:05:36.423

这里最聪明的方法是使代码最易于阅读。当列表中只有 26 个项目时，谁在乎它使用什么算法来查看它？您必须使用非常*非常*愚蠢的东西才能使其对性能产生影响。

但是，如果您真的对性能感兴趣，则需要对不同的选项进行基准测试。只看复杂性并不能说明全部，因为它隐藏了所涉及的因素。例如，字典查找将涉及计算键的哈希，在表中查找，然后检查相等性。对于短列表，简单的线性搜索有时可能更有效，具体取决于散列算法的成本。

如果你的例子真的很准确，你不能只取输入字符串的第一个字母并从中预测 URL 吗？( `"/extension" + letter + ".html"`)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T07:05:31.600

字典！O(1)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T07:09:18.583

如果您拥有（并且将永远拥有）少量项目，字典将是一个不错的选择。如果 URL 列表将来要扩展，您可能实际上希望按 URL 的字母对 URL 进行排序，然后将输入与该字母进行匹配，而不是为每个字母硬编码字典。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T00:13:37.050

由于听起来您只是在谈论总共 26 个项目，因此您可能不必太担心效率。你想出的任何东西都应该足够快。

一般来说，我建议尝试使用最接近您的问题域的数据结构。例如，听起来您正在尝试将字母映射到 URL。例如，这是“A”网址，这是“B”网址。在这种情况下，像 dict 这样的映射数据结构听起来很合适：

```
html_files = {
    'a': '/extensionA.html',
    'b': '/extensionB.html',
    'c': '/extensionC.html',
} 
```

Although in this exact example you could actually cheat it and skip the data structure altogether -- `'/extension%s.html' % letter.upper()` :)

# .net - 通过远程桌面提高 WPF 应用程序速度？

> ID：1005497
> 
> 赞同：4
> 
> 时间：2009-06-17T07:04:38.373
> 
> 标签：.net, wpf, windows, remote-desktop

在我们的场景中，我们有一个用户通过远程桌面使用的 wpf 应用程序，我们发现用户体验非常缓慢。

在这种情况下改善用户体验有什么建议吗？一点可能是禁用任何动画/故事板，并避免在 UI 中使用渐变。更多的想法表示赞赏。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-17T08:17:11.007

对于渐变，它不像多个渲染层那样成为问题，例如，如果您有一堆嵌套控件都部分不透明。查看可用的 WPF[性能优化](http://msdn.microsoft.com/en-us/library/aa970683.aspx)指南。那里有很多信息需要消化，但是有了那里的渲染技巧和[性能工具](http://msdn.microsoft.com/en-us/library/bb613564.aspx)，你肯定能够做出一些改进。

**更新：**
[Jamie Rodriguez](http://blogs.msdn.com/jaimer/)将在 Microsoft 发布一些关于 WPF 的内部讨论。[今天有一个新帖子，其中包括有关远程处理时性能](http://blogs.msdn.com/jaimer/archive/2009/06/29/wpf-discussions-090626.aspx)的提示和讨论。

> 自 WPF 3.5 SP1 以来的所有 WPF 版本都使用位图远程处理进行了远程处理（包括远程桌面和终端服务器）。
> 
> 位图远程处理的工作原理如下：
> 
> *   应用程序使用 WPF 的软件光栅化器在服务器上呈现
> *   当应用程序运行时，服务器会跟踪应用程序窗口的哪些区域是新脏的并且需要更新
> *   当需要更新区域时，服务器会创建一个仅包含脏区域的压缩位图并将其发送给客户端
> *   一旦客户端将该位图绘制到它自己窗口上的适当位置，客户端窗口就是最新的
> 
> 鉴于这种远程机制的工作原理，可以通过以下几种方式最大化性能：
> 
> *   脏区应尽可能小，以便通过线路发送的数据量最少
> *   环境动画应该关闭
>     *   例如，将窗口背景设置为动画渐变会导致整个窗口无效/每帧重绘
> *   系统不会优化掉应用程序的被遮挡部分
>     *   例如，完全隐藏在其他一些不透明元素后面的动画仍然会导致脏区失效/位图生成发生。从您的应用程序中删除这些。
> *   应尽可能不频繁地创建脏区
>     *   关闭尽可能多的动画
>     *   对于那些无法完全消除的动画，使用 DesiredFramerate 属性降低动画帧率
> *   脏区位图应尽可能简单以最大限度地压缩
>     *   在 TS 上运行的应用程序应该更喜欢纯色而不是渐变或其他奇异的填充（不必要的图像等），尤其是对于将频繁重绘的应用程序片段
> *   避免在软件中渲染时特别慢的操作
>     *   BitmapEffects / Effects / ShaderEffects，尤其是大半径的模糊和阴影，在软件中相当慢
>     *   3D – 3D 软件光栅化器比硬件渲染慢得多

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T16:11:57.430

您可以查询 WPF 性能层 ( [http://msdn.microsoft.com/en-us/library/ms742196.aspx](http://msdn.microsoft.com/en-us/library/ms742196.aspx) ) 并酌情降低动画/图形技巧，以便您的应用在运行时在本地看起来仍然很棒快速超过 RDP。

# c# - asp:Button OnClick 事件的问题

> ID：1005499
> 
> 赞同：3
> 
> 时间：2009-06-17T07:05:16.437
> 
> 标签：c#, asp.net, onclick

这是我的按钮

```
<asp:Button ID="myButton" Text="Click Me" OnClick="doSomething(10)" runat="server" /> 
```

这是服务器功能

```
public void doSomething(int num)
{
    int someOtherNum = 10 + num;
} 
```

当我尝试编译代码时，我收到以下行的错误“Method Name Expected”：

```
<asp:Button ID="myButton" Text="Click Me" OnClick="doSomething(10)" runat="server" /> 
```

我究竟做错了什么？我是否不允许从 OnClick 事件向服务器传递值？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-17T07:08:46.650

这里有两个问题。首先，onclick 事件具有特定的签名。这是

```
MethodName(object sender, EventArgs e); 
```

其次，在标记中，您只需要传递不带括号或参数的方法名称。

```
<asp:Button ID="myButton" Text="Click Me" OnClick="doSomething" runat="server" /> 
```

然后按如下方式更改您的代码隐藏：

```
public void doSomething(object sender, EventArgs e)
{
    ....
} 
```

参数的传递可以在客户端单击事件处理程序（在本例中为 OnClientClick）上完成，但不能在服务器端处理程序上完成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T07:15:12.317

按钮的 OnClick 是一个事件处理程序。要将函数挂钩到事件处理程序，您需要遵守由事件处理程序定义的合同，正如Jose所[提到的。](https://stackoverflow.com/questions/1005499/problems-with-aspbutton-onclick-event/1005514#1005514)OnClick 绑定到格式的一个函数`void doSomething(object sender, EventArgs e)`。所以你的函数应该是相同的格式。

我不确定为什么要将参数传递给事件处理程序。如果您想进行一些操作，则需要使用其他控件进行操作。

```
<asp:TextBox ID="txtNumber" runat="server" /><asp:Button ID="myButton" Text="Click Me" OnClick="doSomething" runat="server" /> 
```

在代码中

```
public void doSomething(object sender, EventArgs e)
{
int AnotherNumber=   Int32.Parse(txtNumber.Text)+10;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-05-09T10:16:05.570

有更简单的解决方案。您可以使用 ASP 按钮 OnCommand 事件。更多关于这里：http: [//msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.button.oncommand.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.button.oncommand.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-26T14:39:34.307

您必须将方法的结构更改为

```
public void doSomething(object sender, EventArgs e)
    {
        ....
    } 
```

对于传递参数，您需要这样的解决方法：

例如，如果您在 Html 控件中，您可以将参数放在属性值中（例如本示例中的 ID），然后在服务器端处理程序中检索它

即使控件更改样式颜色

网页：

```
<a href="" id="Grey" runat="server" onserverclick='ApplyStyleEvent'></a> 
```

代码 ：

```
protected void ApplyStyleEvent(object sender, EventArgs e)
{
    Profile["SelectedStyle"] = ((HtmlControl)sender).ID;
    Response.Redirect("");
} 
```

等等。

# html - 如何使用struts2访问表单数组字段

> ID：1005503
> 
> 赞同：0
> 
> 时间：2009-06-17T07:05:43.707
> 
> 标签：html, arrays, struts2, field

目前我正在研究一种包含 2 个按钮的表单。单击 1 个按钮，我得到如下的 html 字段块。

`

```
<table width="100%">
    <tbody><tr>

      <td class="style4" width="12%" align="center">CODE<span class="style3"> </span></td>
      <td width="18%"><input name="c_code[]" value="" id="c_code__" class="box_border" style="width: 120px;" type="text"></td>
      <td class="style3" width="15%" align="right">Price</td>
      <td width="7%"><input name="c_price[]" value="" id="c_price__" class="box_border" style="width: 40px;" type="text"></td>
      <td class="style3" width="4%" align="right">Qty</td>
      <td width="7%"><input name="c_qty[]" value="" id="c_qty__" class="box_border" style="width: 40px;" type="text"></td>
      <td class="style3" width="9%" align="right">On Sale </td>

      <td width="3%"><input name="c_onsale[]" id="c_onsale__" value="" type="radio">    
<label for="c_onsale"></label>
</td>
      <td class="style3" width="10%" align="center">Exposition</td>
      <td width="15%"><input name="c_exposition[]" size="15" value="" id="c_exposition__" class="box_border" type="text"></td>
    </tr>
  </tbody></table> 
```

`

现在，每次用户单击上面给出的按钮时，整个块都将使用 ajax 方法调用包含在 html 表单中。

1.  现在我的问题是如何在 struts2 动作类中获取所有元素的值作为数组。或者如何为这些数组编写 setter 和 getter 方法。

有没有更好的方法以其他方式执行上述操作，让我的工作更轻松？

2.  如何为这样的数组字段编写struts2验证文件？

任何人都可以在这件事上帮助我。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-10-09T13:38:39.107

好的，如果您可以在每次迭代时使用数组中的索引重命名字段，那么它们将被命名为 c_name[0]、c_name[1] 等...然后您可以在您的操作类中定义一个数组并映射将毫无问题地完成。至于验证，我建议对您的操作进行服务器端验证。

问候，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-02T16:42:17.933

在服务器端使用 List 而不是数组，struts 会自动将新部分（UI 上的新元素块）映射到它。

如果将其定义为数组，则每次都无法初始化新部分，因为大小无法动态增加

# perl - 如何将 Data::Dumper 输出转换回 Perl 数据结构？

> ID：1005507
> 
> 赞同：1
> 
> 时间：2009-06-17T07:06:38.667
> 
> 标签：perl, xml-simple

我想知道您是否可以对我几天来一直在做的代码有所了解。

我一直在尝试使用 XMLout() 和 XMLin() 方法将 Perl 解析的哈希转换回 XML，并且这种格式非常成功。

```
#!/usr/bin/perl -w
use strict;

# use module
use IO::File;
use XML::Simple;
use XML::Dumper;
use Data::Dumper;
my $dump = new XML::Dumper;

my ( $data, $VAR1 );

Topology:$VAR1 = {  
   'device' => {  
    'FOC1047Z2SZ' => {  
      'ChassisID' => '2009-09',  
      'Error' => undef,  
      'Group' => {  
        'ID' => 'A1',  
        'Type' => 'Base'  
      },  
      'Model' => 'CATALYST',  
      'Name' => 'CISCO-SW1',  
      'Neighbor' => {},  
      'ProbedIP' => 'TEST',  
      'isDerived' => 0  
    }  
  },  
  'issues' => [  
    'TEST'  
  ]  
};  

# create object  
my $xml = new XML::Simple (NoAttr=>1,  
                           RootName=>'data',     
                           SuppressEmpty => 'true');  

# convert Perl array ref into XML document  
$data = $xml->XMLout($VAR1);  

#reads an XML file  
my $X_out = $xml->XMLin($data);  

# access XML data  
print Dumper($data);  
print "STATUS: $X_out->{issues}\n";  
print "CHASSIS ID: $X_out->{device}{ChassisID}\n";  
print "GROUP ID: $X_out->{device}{Group}{ID}\n";  
print "DEVICE NAME: $X_out->{device}{Name}\n";  
print "DEVICE NAME: $X_out->{device}{name}\n";  
print "ERROR: $X_out->{device}{error}\n"; 
```

我可以毫无问题地访问 XML 中的所有元素。

但是，当我尝试创建一个包含已解析哈希的文件时，就会出现问题，因为我似乎无法访问所有 XML 元素。我想，我无法使用以下代码解析文件。

```
#!/usr/bin/perl -w
use strict;
#!/usr/bin/perl

# use module
use IO::File;  
use XML::Simple;  
use XML::Dumper;  
use Data::Dumper;  
my $dump = new XML::Dumper;  

my ( $data, $VAR1, $line_Holder );

#this is the file that contains the parsed hash  
my $saveOut = "C:/parsed_hash.txt";  
my $result_Holder = IO::File->new($saveOut, 'r');  
while ($line_Holder = $result_Holder->getline){  
    print $line_Holder;  
}  

# create object  
my $xml = new XML::Simple (NoAttr=>1, RootName=>'data', SuppressEmpty => 'true');  
# convert Perl array ref into XML document  
$data = $xml->XMLout($line_Holder);  
#reads an XML file  
my $X_out = $xml->XMLin($data);  

# access XML data  
print Dumper($data);  
print "STATUS: $X_out->{issues}\n";  
print "CHASSIS ID: $X_out->{device}{ChassisID}\n";  
print "GROUP ID: $X_out->{device}{Group}{ID}\n";  
print "DEVICE NAME: $X_out->{device}{Name}\n";  
print "DEVICE NAME: $X_out->{device}{name}\n";  
print "ERROR: $X_out->{device}{error}\n"; 
```

您知道如何访问文本文件中的 $VAR1 吗？

问候，
newbee_me

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T07:49:10.783

```
$data = $xml->XMLout($line_Holder); 
```

$line_Holder 只有文件的最后一行，而不是整个文件，也没有评估文件产生的 perl hashref。尝试这样的事情：

```
my $ref = do $saveOut; 
```

do 函数为您加载和评估文件。您可能希望在单独的步骤中执行此操作，例如：

```
use File::Slurp "read_file";
my $fileContents = read_file( $saveOut );
my $ref = eval( $fileContents ); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T16:56:48.970

基本上要加载 Dumper 数据，你 eval() 它：

```
use strict;
use Data::Dumper;
my $x = {"a" => "b", "c"=>[1,2,3],};
my $q = Dumper($x);
$q =~ s{\A\$VAR\d+\s*=\s*}{};
my $w = eval $q;
print $w->{"a"}, "\n"; 
```

正则表达式 (s{\A\$VAR\d+\s*=\s*}{}) 用于从字符串的开头删除 $VAR1=。

另一方面 - 如果您需要一种方法来存储复杂的数据结构并再次加载它，那么使用 Storable 模块会更好，它是 store() 和 retrieve() 函数。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-17T20:13:47.063

您可能希望将 Data::Dump 模块视为 Data::Dumper 的替代品；它的输出已经准备好重新评估。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T23:34:20.637

`Data::Dumper`您可以使用 配置输出中使用的变量名称`$Data::Dumper::Varname`。

例子

```
使用 Data::Dumper
$Data::Dumper::Varname = "foo";
我的 $string = Dumper($object);
评估（$字符串）；

```

...将创建变量`$foo`，并且应该包含与 相同的数据`$object`。如果你的数据结构很复杂，结果很奇怪，你可能要考虑 Storable 的`freeze()`和`thaw()`方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-11-07T23:00:18.537

这对我有用，适用于散列的散列。可能不适用于包含引用其他结构的结构。但对于简单的结构，如数组、散列或散列的散列，效果很好。

```
打开（数据，>“，$文件）；
 打印数据转储器（\%g_write_hash）；
 关闭（数据）；

 我的 %g_read_hash = %{ 做 $file };

```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-04-10T02:24:05.340

请使用转储模块代替 Data::Dumper

# sql - 我应该在这个 VB.NET 应用程序中使用什么数据库？

> ID：1005509
> 
> 赞同：1
> 
> 时间：2009-06-17T07:06:56.093
> 
> 标签：sql, vb.net, visual-studio-2008, sql-server-ce

我的数据库必须以任意间隔手动更新，将新信息放在不需要结构修改的标准表上。一个应用程序将更新数据库。
另一个应用程序，我将分发的应用程序（仅分发给朋友和家人，但不需要任何安全功能，例如加密数据库）将读取数据库并将其数据用于标签、列表视图等。

问题是，在任何类型的编程中，我都是成熟的 n00b 的完美定义，但仍然不知道要使用什么数据库。

我认为我应该使用 SQL CE (*.sdf) 文件，并将该数据库内容存储在 FTP 上。然后，每次“客户端”应用程序运行并单击某个按钮（“连接”）时，我都可以下载它并从中获取数据。经过一番硬核谷歌搜索后，我发现了如何使用以下连接字符串连接到 sdf 事物：

```
Provider=Microsoft.SQLSERVER.CE.OLEDB.3.5;Data Source=D:\Documents and Settings\Camilo\JCTM.sdf 
```

所以它连接了，或者至少没有显示任何错误。

我不知道使用 sdf SQL CE 文件作为数据库是否是个好主意，如果太难了，也许我应该使用 XML？你们有什么建议，在 VB.NET 中实现非常简单的数据库的最简单方法是什么？

简单的数据库我的意思是： - 不需要搜索 - 除了将字符串存储在具有列和行的表上之外，没有高级功能 - 不同的 VB.NET 应用程序易于访问、读取、编辑等

sdf 是个好主意吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T15:23:29.930

我会推荐[Sql Server Express](http://www.microsoft.com/express/sql/default.aspx)它是免费的，并且可以作为安装过程的一部分与 .net 应用程序一起重新分发。

挑战将是同步不同客户端之间的更改。如果您有权访问 FTP 服务器，则可能能够在 IIS 中托管网站。如果你能做到这一点，你可以只使用 web 服务并读取一个数据库，而不是复制一个本地数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T08:37:54.197

我会从 Microsoft Access 开始，因为它有自己的 UI，并且可以很好地与 .NET 配合使用。

您还可以尝试 SQLite 的 ADO.Net 实现，我也发现它非常有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T15:12:48.827

幸运的是，您可以不必担心使用哪个后端数据库来存储数据。

诸如 ODBC（开放式数据库连接）和 OLEDB（对象链接和嵌入，数据库）之类的技术允许您将对后端数据存储的关注限制在制作连接字符串的任务上。在您的示例中，连接字符串显示：“我将通过其 OLEDB 提供程序连接到 SQL Server CE 数据库，它的物理位置位于 D:/...

在代码中，您使用标准 OLEDB 机制来访问和管理数据库。由于这种抽象，您可以根据需要使用 SQL Server、Oracle、XML、Access 或逗号分隔文本文件的 OLEDB 提供程序作为您的后备存储，并且您需要对代码进行的唯一更改是连接字符串。然后，您的选择应该是选择您拥有最初设置和管理的工具和专业知识的数据库。

# coldfusion - 当我从 CF6.1 迁移到 CF8 或 Railo3.1 时，会遇到哪些陷阱？

> ID：1005517
> 
> 赞同：8
> 
> 时间：2009-06-17T07:09:08.490
> 
> 标签：coldfusion, migration, middleware, railo, cfml

谷歌并没有真正提供太多内容（或者我的查询很糟糕）。有没有人做过转换并可以分享经验？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T15:55:48.833

我们发现当我们升级到 CF 8 时：

Carraige 退货在纯文本电子邮件中被剥离。我们发现我们必须通过创建这样的 var`<cfset CRLF = "#Chr(13)##Chr(10)#">`并将其插入到我们需要换行符的纯文本电子邮件中来明确换行符。我们最终去了 HTML 电子邮件。

由于 jar 文件的加载顺序，第三方 jar 文件会导致问题。某些 jar 文件必须首先出现在 java 类路径中，如`cfroot/runtime/bin/jvm.config`. 这是一个混乱的解决方法，我们已经停止使用那个 jar。

还要确保立即修补到 8.0.1。[由于这个](http://blog.pengoworks.com/index.cfm/2008/1/30/Two-important-CF8-bugsissues-detailed-yesterday)问题，我们做了一场性能噩梦。

祝你好运！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T12:23:26.610

我们大约在一年前进行了切换，如果您仅在代码方面进行讨论，那么只要您的设置保持不变，从 cf6 到 cf8 的更改不需要任何更改。一个变化是 CF 处理 verity 集合的方式，所以如果你使用 cfsearch 那么它可能是你研究的东西。cf6 有许多改进，您应该寻求实施。我们发现特别有用的几个是 cfdocument、cfimage、cfpdf 和 cffeed。这是与其他关键点的良好链接... [http://www.adobe.com/products/coldfusion/upgrade/](http://www.adobe.com/products/coldfusion/upgrade/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T23:55:46.007

我没有任何 CFMX 6.1 应用程序可以切换，但 Railo 绝对是我选择的 CFML 引擎。

兼容性方面，从 CFMX 6.1 迁移不太可能出现任何重大问题，您可以使用 Express 版本轻松测试 - 无需安装！

Railo 对 CFML 的某些方面可能更严格，因此如果您利用 CF 的错误/弱点，您可能会遇到一些错误，但没有什么可担心的。

而且，如果您确实遇到了任何问题，[Railo 邮件列表](http://groups.google.com/group/railo)很活跃，其中有很多友好乐于助人的人，他们可以帮助您重新开始。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-25T15:48:44.047

如果您从 CFMX 6.1 升级到 Railo 3.1，几乎不会出现任何问题。有些东西我们不支持（例如 CFREPORT 或 C++ CFX 标签）。除此之外，将现有的 CFMX 6.1 代码迁移到 Railo 应该非常容易。默认情况下，Railo 配置为尽可能与 CFMX 兼容。

您可能还需要注意其他一些事项：

*   如果您在 CF 中创建这样的结构： <cfset a["image.x"]> 您将能够使用“。”调用该变量。符号，尽管它具有误导性。所以在 CF 中你可以做 <cfoutput>#a.image.x#</cfoutput> 而在 Railo 你必须写： <cfoutput>#a["image.x"]#</cfoutput>
*   在局部范围内创建变量的内部函数在命名为范围内将在 CFMX 中有效，但在 Railo 中无效。所以这个： <cfset var url = "whatever"> 将在 CF 中工作，但在 Railo 中不起作用。
*   在 Railo 中，在使用 cfapplication 初始化之前，您不能使用应用程序范围或会话范围。那么在 CF 中你也不能，但是 CF 会在变量范围内创建一个名为“应用程序”或“会话”的局部变量。这有时会导致混乱。

除了这些东西，它应该完美无缺。如果您当然有任何问题，请联系我们的 Railo Google 小组或直接访问 www.getrailo.com

格特弗兰兹

* * *

Railo 专业开源

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T12:27:19.600

我不知道从 CF6.1 到 CF8 的任何折旧标签或功能。CF8 已针对性能进行了优化，因此您很可能会看到您的应用程序有所改进，具体取决于所使用的内容。

我成功地将一个大型应用程序从 CF4.5 升级到 CF8，没有任何问题。如果应用程序包含对 ColdFusion 标记和函数的非常直接的使用，那么您应该不会有太大问题。

但是，由于开发人员版本是免费使用的，因此您应该真正设置一个测试环境并通过测试您的应用程序自己确定这个问题的答案。所有数据源、自定义标签等都必须进行迁移和测试。如果任何 CF6.1 应用程序使用了在某些方面可用的任何较低级别的 java api，您可能需要彻底测试以确保冷融合的底层实现没有更改并修复必要的内容。

至于Railo3.1，可能还有一些标签或功能还没有实现。您将再次需要设置测试环境并自行确定。在 Railo 网站的某个地方，应该有一份 CF 和 Railo 不同版本之间的兼容性列表。

# maven-2 - Maven 中父项目的最新版本

> ID：1005519
> 
> 赞同：4
> 
> 时间：2009-06-17T07:09:34.107
> 
> 标签：maven-2, parent, pom.xml

我正在使用 Maven2。我为我的组织创建了一个父 POM。我希望各个小组将其用作他们项目的父级，但我希望他们使用最新版本。出于某种原因，将其用作具有最新版本的父级不起作用，

任何的想法？

谢谢，罗南。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-17T07:16:03.563

您不需要为在 POM 中所做的每一个小更改都定义一个新版本。

版本意味着工件的特定功能（在 POM 中是构建设置），我要做的是声明一个版本并让所有项目都使用该版本（使用 SNAPSHOT 版本是个好主意）。如果您进行小更新，请在该版本中进行。如果您进行更大的更改，您可能希望声明一个新版本并让所有新 POM 使用该版本，这样您就可以避免使用新的超级 POM 破坏旧项目。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-31T04:16:21.633

Maven 版本插件的目标[`version:update-parent`](http://mojo.codehaus.org/versions-maven-plugin/update-parent-mojo.html)是将父版本设置为最新的父版本。

只需执行

```
mvn versions:update-parent 
```

在您要使用最新父版本的项目中，它会为您修改 POM 文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T07:14:48.607

我想你想使用`SNAPSHOT`，例如

```
<version>1.2-SNAPSHOT</version> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-05-07T14:47:11.057

您需要使用参数 -U 运行 mvn 以强制更新包含 LATEST 和 RELEASE 版本的映射的本地元数据文件。

# iphone - 带有 cookie 的 iPhone NSData/NSUrl

> ID：1005521
> 
> 赞同：2
> 
> 时间：2009-06-17T07:11:10.610
> 
> 标签：iphone, http, cookies, nsurlconnection

我正在尝试播放/流式传输网站上托管的 mp3。该站点需要设置 cookie 标头，但我无法设置或让容器为我执行此操作。

```
 NSURL *sampleUrl = [NSURL URLWithString:@"http://domain/files/sample.mp3"];
 NSData *sampleAudio = [NSData dataWithContentsOfURL:sampleUrl]; 
```

到目前为止，我一直在使用 jQuery 来执行/管理 XMLHTTPRequests，但我不得不调用本机代码来流式传输音频。看起来 cookie 并没有被本机 HTTP 请求获取。

无论如何将 cookie 注入上述请求，或以其他方式确保针对给定域添加 cookie？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T07:59:26.707

好的，所以这样做的方法不是注入标头，而是将 cookie 管理器设置为始终接受 cookie。然后，这会将 cookie 传递给后续请求。

```
 NSHTTPCookieStorage *cookieStorage = [NSHTTPCookieStorage sharedHTTPCookieStorage];
    [cookieStorage setCookieAcceptPolicy:NSHTTPCookieAcceptPolicyAlways]; 
```

罗比

# java - 如何在日期中添加一天？

> ID：1005523
> 
> 赞同：249
> 
> 时间：2009-06-17T07:11:34.883
> 
> 标签：java, datetime

我想将一天添加到特定日期。我怎样才能做到这一点？

```
Date dt = new Date(); 
```

现在我想在这个日期上加一天。

* * *

## 回答 #1

> 赞同：568
> 
> 时间：2009-06-17T07:18:16.367

给定一个`Date dt`你有几种可能性：

**解决方案 1：**您可以使用`Calendar`该类：

```
Date dt = new Date();
Calendar c = Calendar.getInstance(); 
c.setTime(dt); 
c.add(Calendar.DATE, 1);
dt = c.getTime(); 
```

**解决方案 2：**您应该认真考虑使用**[Joda-Time 库](http://www.joda.org/joda-time/)**，因为该类的各种缺点`Date`。使用 Joda-Time，您可以执行以下操作：

```
Date dt = new Date();
DateTime dtOrg = new DateTime(dt);
DateTime dtPlusOne = dtOrg.plusDays(1); 
```

**解决方案 3：**使用**Java 8**，您还可以使用新的**JSR 310** API（受 Joda-Time 启发）：

```
Date dt = new Date();
LocalDateTime.from(dt.toInstant()).plusDays(1); 
```

* * *

## 回答 #2

> 赞同：84
> 
> 时间：2009-06-17T11:06:29.607

```
Date today = new Date();
Date tomorrow = new Date(today.getTime() + (1000 * 60 * 60 * 24)); 
```

Date 有一个构造函数，使用自 UNIX 纪元以来的毫秒数。getTime() 方法为您提供了该值。因此，增加一天的毫秒数就可以了。如果您想定期进行此类操作，我建议为值定义常量。

重要提示：并非在所有情况下都是正确的。阅读下面的警告评论。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2017-08-24T09:12:30.010

我找到了一种将任意时间添加到 Date 对象的简单方法

```
Date d = new Date(new Date().getTime() + 86400000) 
```

在哪里：

```
86 400 000 ms = 1 Day  : 24*60*60*1000
 3 600 000 ms = 1 Hour :    60*60*1000 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2014-11-29T02:23:31.100

如最佳答案中所述，自 java 8 以来，可以执行以下操作：

```
Date dt = new Date();
LocalDateTime.from(dt.toInstant()).plusDays(1); 
```

但这有时会导致`DateTimeException`这样的情况：

```
java.time.DateTimeException: Unable to obtain LocalDateTime from TemporalAccessor: 2014-11-29T03:20:10.800Z of type java.time.Instant 
```

只需传递时区即可避免此异常：

```
LocalDateTime.from(dt.toInstant().atZone(ZoneId.of("UTC"))).plusDays(1); 
```

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2014-04-11T06:08:28.307

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2016-04-28T06:05:46.700

您可以在**导入 org.apache.commons.lang.time.DateUtils**后使用此方法：

```
DateUtils.addDays(new Date(), 1); 
```

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2011-12-30T12:28:30.293

这将使任何日期增加一个

```
String untildate="2011-10-08";//can take any date in current format    
SimpleDateFormat dateFormat = new SimpleDateFormat( "yyyy-MM-dd" );   
Calendar cal = Calendar.getInstance();    
cal.setTime( dateFormat.parse(untildate));    
cal.add( Calendar.DATE, 1 );    
String convertedDate=dateFormat.format(cal.getTime());    
System.out.println("Date increase by one.."+convertedDate); 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2016-11-26T10:06:29.243

Java 8 时间 API：

```
Instant now = Instant.now(); //current date
Instant after= now.plus(Duration.ofDays(300));
Date dateAfter = Date.from(after); 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-06-17T11:54:40.897

使用 DateTime 对象 obj.Add 添加您想要的时间等。希望这可行:)

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2012-11-29T17:00:34.420

对于日期和时间算术，我更喜欢[joda](http://joda-time.sourceforge.net/)，因为它的可读性要好得多：

```
Date tomorrow = now().plusDays(1).toDate(); 
```

或者

```
endOfDay(now().plus(days(1))).toDate()
startOfDay(now().plus(days(1))).toDate() 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2017-03-30T01:46:14.693

Java 8 本地日期[API](https://docs.oracle.com/javase/8/docs/api/java/time/LocalDate.html#plusDays-long-)

`LocalDate.now().plusDays(1L);`

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-06-17T08:56:16.623

为了使它不那么特定于 java，基本原则是转换为某种线性日期格式、儒略日、修改的儒略日、自某个纪元以来的秒数等，添加您的日期，然后再转换回来。

这样做的原因是您将“获得闰日、闰秒等正确”的问题交给了一个幸运地没有解决这个问题的人。

我会提醒您，正确执行这些转换程序可能很困难。人们打乱时间的方式有很多种，最近一个备受瞩目的例子是 MS 的 Zune。不过不要太拿 MS 开玩笑，这很容易搞砸。有多种不同的时间格式（例如 TAI 与 TT）并没有帮助。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2014-11-30T05:45:11.580

在非常特殊的情况下，如果您要求参加自己的约会课程，可能来自您的计算机编程教授；这种方法会做得很好。

```
public void addOneDay(){
    int [] months = {31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
    day++;
    if (day> months[month-1]){
        month++;
        day = 1;
        if (month > 12){
            year++;
            month = 1;
        }
    }
} 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2015-08-13T19:27:31.773

最好的使用方法：

```
 long currenTime = System.currentTimeMillis();
      long oneHourLater = currentTime + TimeUnit.HOURS.toMillis(1l); 
```

同样，您可以添加 MONTHS、DAYS、MINUTES 等

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2015-05-04T06:59:35.490

***Java 1.8 版本***对数据时间 API 进行了很好的更新。

这是代码片段：

```
 LocalDate lastAprilDay = LocalDate.of(2014, Month.APRIL, 30);
    System.out.println("last april day: " + lastAprilDay);
    LocalDate firstMay = lastAprilDay.plusDays(1);
    System.out.println("should be first may day: " + firstMay);
    DateTimeFormatter formatter = DateTimeFormatter.ofPattern("dd");
    String formatDate = formatter.format(firstMay);
    System.out.println("formatted date: " + formatDate); 
```

***输出：***

```
last april day: 2014-04-30
should be first may day: 2014-05-01
formatted date: 01 
```

有关更多信息，请参阅此类的 Java 文档：

*   [本地日期](https://docs.oracle.com/javase/8/docs/api/java/time/LocalDate.html)
*   [日期时间格式化程序](https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html)

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2016-06-08T06:31:32.030

你想在几天后找到这个代码尝试..

```
public Date getToDateAfterDays(Integer day) {
        Date nowdate = new Date();
        Calendar cal = Calendar.getInstance();
        cal.setTime(nowdate);
        cal.add(Calendar.DATE, day);
        return cal.getTime();
    } 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2016-08-15T16:56:27.450

我将向您展示我们如何在**Java 8**中做到这一点。干得好：

```
public class DemoDate {
    public static void main(String[] args) {
        LocalDate today = LocalDate.now();
        System.out.println("Current date: " + today);

        //add 1 day to the current date
        LocalDate date1Day = today.plus(1, ChronoUnit.DAYS);
        System.out.println("Date After 1 day : " + date1Day);
    }
} 
```

输出：

```
Current date: 2016-08-15
Date After 1 day : 2016-08-16 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2016-04-28T06:45:59.483

你可以像这样尝试`java.util.Date`图书馆-

```
int no_of_day_to_add = 1;

Date today = new Date();
Date tomorrow = new Date( today.getYear(), today.getMonth(), today.getDate() + no_of_day_to_add ); 
```

根据需要更改值`no_of_day_to_add`。

我已将值设置为`no_of_day_to_add`，`1`因为您只想添加一天。

更多内容可在[**本文档**](https://docs.oracle.com/javase/8/docs/api/java/util/Date.html#Date-int-int-int-)中找到。

# visual-studio - 将菜单项添加到 VS2008 DSL 中的上下文菜单

> ID：1005524
> 
> 赞同：0
> 
> 时间：2009-06-17T07:11:38.517
> 
> 标签：visual-studio, contextmenu, dsl

我目前正在尝试为我工作的公司创建一个双向 DSL，并希望在图表中添加一个上下文菜单，以便为用户提供一种请求代码导入的机制。我知道在 VS2005 中使用 Commands.ctc 文件来实现这一点，而 2008 似乎正在使用 Commands.ctc。然而，试图找出它是如何工作的并不是很容易。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T07:19:21.110

我终于找到了一个非常好的博客，准确地解释了如何做到这一点，希望其他人也会觉得这很有用：[Sebastian Talamoni's Blog](http://stalamoni.blogspot.com/2007/12/adding-menu-to-dsl-using-vsnet-2008-sdk.html)

# bug-tracking - 任何人都可以推荐一个小型、简单且免费的 bugtracker 吗？

> ID：1005525
> 
> 赞同：0
> 
> 时间：2009-06-17T07:12:50.030
> 
> 标签：bug-tracking

我正在为一个小项目寻找一个小而简单（强调**简单**）的 bugtracker。它应该在 Apache/PHP 上运行，但我也会考虑其他替代方案（虽然没有 Windows）。哦，我没有钱花在上面，所以它应该是免费的。:P

有什么建议吗？

**补充：**请不要托管解决方案。我想自己主持。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-17T07:16:01.163

[跟踪](http://trac.edgewall.org/)。它是免费的、简单的，并且在 Apache 上运行。请参阅[演示站点](http://www.hosted-projects.com/trac/TracDemo/Demo)以自己尝试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T07:16:39.180

用 Perl 编写，但[Bugzilla](http://www.bugzilla.org/)很容易设置。安装主要由安装脚本完成。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T07:15:58.650

我真的很喜欢 Mantis： http: [//www.mantisbt.org/](http://www.mantisbt.org/)。[例如，您可以在http://bugs.scribus.net](http://bugs.scribus.net)上看到它的运行情况。

涉及很多个人品味；这只是我的：我认为 Mantis 很简单，仍然为您提供了很多功能，但它并没有让您大吃一惊。我觉得和它一起工作很舒服。

TBH，我从来没有使用过 Mantis 和管理员，就像用户/记者一样，但我确实认为易用性会延续到较低级别的功能。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T07:20:08.080

关键跟踪器：[http ://www.pivotaltracker.com/](http://www.pivotaltracker.com/)

它很简单，也非常适合项目管理。它也是托管和免费的！没有设置。您只需要登录。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T07:18:34.603

如果您独自工作或与他人一起工作，[FogBugz有一个免费的托管版本。](http://www.fogcreek.com/FogBUGZ/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T07:24:55.373

综述追踪器： [http ://roundup.sourceforge.net/](http://roundup.sourceforge.net/)

*   免费
*   它是开源的
*   它有一个内置的网络服务器，所以可以自己托管，或者做 apache 的事情
*   它可以在数据库之上运行，也可以仅在文件之上运行
*   它是用 Python 编写的，如果那是你的事情，它是非常容易破解的
*   它有一个充满活力的社区，由编写插件的人组成——例如问题编辑之类的 wiki

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-17T07:49:39.423

结帐 BugTracker.net。

它易于使用且非常高效。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-02-11T17:33:55.560

看看[辛普顿](http://simplton.com)镇快乐的人们。

# asp.net - 如何在 ASP.NET 的响应流中添加编码信息？

> ID：1005530
> 
> 赞同：17
> 
> 时间：2009-06-17T07:13:59.653
> 
> 标签：asp.net, encoding, response, response.write

我有以下代码：

```
public void ProcessRequest (HttpContext context) 
{
    context.Response.ContentType = "text/rtf; charset=UTF-8";
    context.Response.Charset = "UTF-8";
    context.Response.ContentEncoding = System.Text.Encoding.UTF8;
    context.Response.AddHeader("Content-disposition", "attachment;filename=lista_obecnosci.csv");
    context.Response.Write("ąęćżźńółĄŚŻŹĆŃŁÓĘ");
} 
```

当我尝试打开生成的 csv 文件时，我得到以下行为：

*   在记事本2 - 一切都很好。
*   在 Word - 转换向导打开并要求转换文本。它建议使用 UTF-8，这在某种程度上是可以的。
*   在 Excel 中 - 我真的一团糟。无法显示这些波兰语字符。

我想在我的字符串前面写那些特殊的编码信息字符，即

```
context.Response.Write((char)0xef);
context.Response.Write((char)0xbb);
context.Response.Write((char)0xbf); 
```

但这不会有任何好处。响应流将其视为普通数据并将其转换为不同的东西。

我很感激这方面的帮助。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-09-18T20:00:40.727

我遇到了同样的问题，这是我的解决方案：

```
context.Response.BinaryWrite(System.Text.Encoding.UTF8.GetPreamble());
context.Response.Write("ąęćżźńółĄŚŻŹĆŃŁÓĘ"); 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-06-17T23:26:07.520

你所说的“编码信息”实际上是一个 BOM。我怀疑这些“字符”中的每一个都是单独编码的。要手动编写 BOM，您必须将其编写为三个*字节*，而不是三个字符。我不熟悉 .NET I/O 类，但应该有一种方法可供您使用，它采用 byte 或 byte[] 参数并将它们直接写入文件。

顺便说一句，UTF-8 BOM 是可选的；事实上，Unicode 联盟不鼓励使用它。如果您没有使用它的特定原因，请省去一些麻烦并将其排除在外。

编辑：我只记得您也可以编写实际的 BOM*字符*, `'\uFEFF'`，并让编码器处理它：

```
context.Response.Write('\uFEFF'); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T01:51:20.737

我认为问题在于基于[Microsoft Excel 的 Excel 在 .csv 文件中破坏了变音符号](https://stackoverflow.com/questions/155097/microsoft-excel-mangles-diacritics-in-csv-files)。为了证明这一点，请`ąęćżźńółĄŚŻŹĆŃŁÓĘ`使用您喜欢的编辑器复制您的示例输出字符串并粘贴到测试文件中，然后另存为 UTF-8 编码的 .csv 文件。在 Excel 中打开并查看相同的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-17T13:22:24.580

[Alan Moore](https://stackoverflow.com/users/20938/alan-moore)的答案 翻译成 VB：

```
Context.Response.Write(""c) 
```

# datagridview - DataGridView 以编程方式排序

> ID：1005539
> 
> 赞同：1
> 
> 时间：2009-06-17T07:16:03.347
> 
> 标签：datagridview

我创建了从 DataGridViewTextBoxColumn 类派生的自定义 DataGridViewNumericTextBoxColumn。

当我打电话

```
this.HeaderDataGridView.Sort = Sort.Programmiticaly;
this.HeaderDataGridView.Sort(this.HeaderDataGridView.Columns[Utility.HEAD_X], ListSortDirection.Ascending); 
```

它适用于整数类型值，但当数据包含双精度值时，它不会排序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-03-05T20:19:17.897

如果您使用的是绑定源，您可以简单地将 .Sort 属性设置为要排序的列的名称。例如：

```
myBS = new BindingSource();
myBS.DataSource = DataSet.MY_TABLE;
myBS.Sort = "MY_COLUMN";
myGrid.DataSource = myBS; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T15:10:52.000

DataGridView 的 DataSource 是什么？DataSource 可以以编程方式对 Double 值进行排序吗？

# php - 为网络协作编码

> ID：1005548
> 
> 赞同：3
> 
> 时间：2009-06-17T07:17:52.953
> 
> 标签：php, python, web-services, versioning

过去，我主要是自己完成网络项目的编码部分。现在，由于我们是一个致力于某个项目的团队，无论是 python 还是 php 或......，是否有一些简单的版本控制系统可以使用？

我的主人似乎不支持这种类型的任何一种。另一方面，我觉得在项目的这个阶段开始租用整个服务器来安装版本控制系统还为时过早。

任何简单的想法如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T07:20:25.693

试试[水银](https://www.mercurial-scm.org)。如果您的主机支持 ssh 和 python，您可以在其上运行 Mercurial。

**更新**：顺便说一句，您不需要主机来运行 Mercurial - 它是分布式的，无需任何服务器即可工作。如果您仍然想在您的托管服务器上拥有一个存储库 - 如果您的主机支持 ssh 和 python，您可以拥有它

**更新**：[http](http://bitbucket.org) ://bitbucket.org - 奇妙的 mercurial 托管，免费允许 1 个私有存储库和无限的公共存储库

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T07:20:37.627

看：

*   [https://stackoverflow.com/questions/59791/free-online-private-svn-repositories](https://stackoverflow.com/questions/59791/free-online-private-svn-repositories)
*   [https://stackoverflow.com/questions/146505/can-someone-recommend-a-reliable-cvs-or-svn-hosting-service](https://stackoverflow.com/questions/146505/can-someone-recommend-a-reliable-cvs-or-svn-hosting-service)
*   [https://stackoverflow.com/questions/111292/free-version-control-services](https://stackoverflow.com/questions/111292/free-version-control-services)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T07:42:15.057

[http://github.com](http://github.com) 匿名源代码托管、存储库...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T08:49:04.500

Github 和其他仅对开源项目免费。但是，Xp-dev 就像免费啤酒一样免费，甚至对商业啤酒也是免费的。[http://www.xp-dev.com/](http://www.xp-dev.com/)

# java - 从字符串路径列表构造树结构

> ID：1005551
> 
> 赞同：24
> 
> 时间：2009-06-17T07:18:21.453
> 
> 标签：java, tree

我在列表中有一组字符串路径，例如 ["x1/x2/x3","x1/x2/x4","x1/x5"]。我需要从这个列表中构造一个树状结构，可以对其进行迭代以获得漂亮的打印树。像这样

```
 x1
    /  \
   x5   x2
       /  \
      x3  x4 
```

有什么想法/建议吗？我相信可以通过处理字符串列表首先解决问题编辑：选择的正确答案是一个优雅的实现，其他建议也很好。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-06-17T09:15:08.567

遵循可访问树的朴素实现：

```
class Tree<T> implements Visitable<T> {

    // NB: LinkedHashSet preserves insertion order
    private final Set<Tree> children = new LinkedHashSet<Tree>();
    private final T data;

    Tree(T data) {
        this.data = data;
    }

    void accept(Visitor<T> visitor) {
        visitor.visitData(this, data);

        for (Tree child : children) {
            Visitor<T> childVisitor = visitor.visitTree(child);
            child.accept(childVisitor);
        }
    }

    Tree child(T data) {
        for (Tree child: children ) {
            if (child.data.equals(data)) {
                return child;
            }
        }

        return child(new Tree(data));
    }

    Tree child(Tree<T> child) {
        children.add(child);
        return child;
    }
} 
```

访问者模式的接口：

```
interface Visitor<T> {

    Visitor<T> visitTree(Tree<T> tree);

    void visitData(Tree<T> parent, T data);
}

interface Visitable<T> {

    void accept(Visitor<T> visitor);
} 
```

访问者模式的示例实现：

```
class PrintIndentedVisitor implements Visitor<String> {

    private final int indent;

    PrintIndentedVisitor(int indent) {
        this.indent = indent;
    }

    Visitor<String> visitTree(Tree<String> tree) {
        return new IndentVisitor(indent + 2);
    }

    void visitData(Tree<String> parent, String data) {
        for (int i = 0; i < indent; i++) { // TODO: naive implementation
            System.out.print(" ");
        }

        System.out.println(data);
    }
} 
```

最后（！！！）一个简单的测试用例：

```
 Tree<String> forest = new Tree<String>("forest");
    Tree<String> current = forest;

    for (String tree : Arrays.asList("x1/x2/x3", "x1/x2/x4", "x1/x5")) {
        Tree<String> root = current;

        for (String data : tree.split("/")) {
            current = current.child(data);
        }

        current = root;
    }

    forest.accept(new PrintIndentedVisitor(0)); 
```

输出：

```
森林
  x1
    x2
      x3
      x4
    x5

```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-17T07:22:28.077

只需通过分隔符拆分每个路径，然后将它们一一添加到树结构中。
即如果`'x1'`不存在创建这个节点，如果它确实存在去它并检查是否有一个孩子`'x2'`等等......

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-17T07:21:12.400

我会一次把树做成一根绳子。

制作一棵空树（它有一个根节点——我假设可能有一个像“x7/x8/x9”这样的路径）。

取第一个字符串，将 x1 添加到根节点，然后将 x2 添加到 x1，然后将 x3 添加到 x2。

取第二个字符串，看到 x1 和 x2 已经存在，将 x4 添加到 x2。

为您拥有的每条路径执行此操作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T07:52:51.430

创建一个对象节点，其中包含一个父节点 (Node) 和一个子节点列表 (Node)。

首先使用“，”分割字符串。对于每个拆分的字符串，您使用“/”拆分字符串。在根列表中搜索第一个节点标识符（例如 x1）。如果可以找到，使用节点查找下一个节点标识符（例如 x2）。

如果找不到节点，请将节点添加到您在现有列表中能够找到的最后一个节点。

创建列表结构后，您可以将列表打印到屏幕上。我会让它递归。

**未经测试，只是一个动画**

```
public void print(List nodes, int deep) {
    if (nodes == null || nodes.isEmpty()) {
        return;
    }

    StringBuffer buffer = new StringBuffer();
    for (int i = 0; i < deep; i++) {
        buffer.append("---");
    }

    for (Iterator iterator = nodes.iterator(); iterator.hasNext();) {
        Node node = (Node)iterator.next();

        System.out.println(buffer.toString() + " " + node.getIdentifier());

        print(node.getChildren(), deep + 1);
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-03-17T15:59:35.470

为数组中的每个字符串制作你的树。只需拆分 '/' 的路径，检查该节点是否存在于您的树中，如果存在则继续...否则创建一个新节点并将此节点添加到父节点的子节点中。

使用递归进行迭代。

以下是树节点的模型。

```
Class Node{
    string name;
    List<Node> childrens;

    Node(string name){
        this.name = name;
        this.childrens = new List<Node>();
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-03-13T14:11:51.983

这就是我从路径（文件夹）结构中创建树的方式。也许应该帮助有基本逻辑的人。

节点：

```
public class Node {
    private String path;
    private List<Node> children;

    public Node(String path) {
        this.path = path;
        children = new ArrayList<>();
    }

    public String getName() {
        return getName(path);
    }

    private String getName(String path) {
        String[] split = path.split("\\\\");
        return split[split.length - 1];
    }

    public void addChild(Node child) {
        children.add(child);
    }

    public List<Node> getChildren() {
        return children;
    }

    public String getPath() {
        return path;
    }
} 
```

文件树：

```
public class FilesTree {
    private static final Logger log = Logger.getLogger(FilesTree.class.getName());

    private FilesTree() {}

    private static void createTree(Node root, List<String> paths) {
        for (String path : paths) {
            addNode(root, Arrays.asList(path.split("\\\\")), "");
        }
    }

    private static void addNode(Node node, List<String> path, String nodePath) {
        if (!path.isEmpty()) {
            nodePath = nodePath.equals("") ? path.get(0) : String.format("%s\\%s", nodePath, path.get(0));
        }

        if (node.getChildren().isEmpty() && path.size() == 1) {
            node.addChild(new Node(nodePath));
        } else if (!node.getChildren().isEmpty()) {
            for (Node actual : node.getChildren()) {
                if (actual.getName().equals(path.get(0))) {
                    addNode(actual, path.subList(1, path.size()), nodePath);
                    return;
                }
            }
            node.addChild(new Node(nodePath));
        } else {
            log.info("Without children but with size: " + path.size());
        }
    }
} 
```

# python - SQLite 参数替换和引号

> ID：1005552
> 
> 赞同：11
> 
> 时间：2009-06-17T07:18:25.307
> 
> 标签：python, sqlite

我有这条线可以正常工作：

```
c.execute('select cleanseq from cleanseqs WHERE newID="%s"'%name) 
```

但我想使用 SQLite 参数替换而不是字符串替换（因为我[在这里](http://docs.python.org/library/sqlite3.html)看到这更安全）。

这是我的（失败的）尝试：

```
t = (name,)
c.execute('select cleanseq from cleanseqs WHERE newID="?"',t) 
```

但是这一行返回：

> '提供的绑定数量不正确。当前语句使用 0，并且提供了 1。

所以我的陈述的左边部分不起作用。我提供了一个绑定（名称，在 t 中），但似乎没有解析问号 (?)。如果我删除 ? 周围的引号，它会起作用。但我希望引号保留在那里，因为我记得在某些情况下我需要它们。

所以问题是：我如何转换这一行：

```
c.execute('select cleanseq from cleanseqs WHERE newID="%s"'%name) 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2014-05-22T04:35:40.277

对于任何喜欢我的人都发现了这个线程并且因为人们忽略了一个事实而感到非常沮丧，有时你不能只是忽略引号（因为你正在使用说一个 LIKE 命令）你可以通过做一些事情来解决这个问题：

```
var = name + "%"
c.execute('SELECT foo FROM bar WHERE name LIKE ?',(var,)) 
```

这将允许您在这种情况下替换通配符。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-18T04:43:40.577

我发现命名参数绑定样式更具可读性——并且`sqlite3`支持它：

```
c.execute('SELECT cleanseq FROM cleanseqs WHERE newID=:t', locals()) 
```

注意：传递`{'t': t}`or`dict(t=t)`代替`locals()`会更准确，但在我看来，当有多个参数和/或更长的名称时，它会干扰可读性。无论如何，我确实发现`:t`比`?`;-) 更好。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-06-17T09:37:26.260

关于 """如果我删除 ? 周围的引号，它会起作用。但我希望引号保留在那里，因为我记得有些情况下我需要它们。"""

当你自己构建整个 SQL 语句时，你记得什么是无关紧要的。

新故事是：用 ? 标记 SQL 语句中您希望替换值的每个位置，然后传入一个包含一个值的元组？——就这么简单；包装器将引用任何字符串以确保它们是可接受的 SQL 常量。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-17T07:32:14.780

失去周围的报价？

```
c.execute('select cleanseq from cleanseqs WHERE newID=?',(t,)) 
```

它将其视为字符串“？”。

您是否需要在整个表达式周围使用双引号，而不是单引号？

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-17T09:22:04.323

该库将为您处理引用和转义。只需像这样编写您的查询：

```
c.execute('SELECT cleanseq FROM cleanseqs WHERE newID=?', (name,)) 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2016-11-21T07:14:43.470

# 普通用户

刚刚注意到你必须通过使用不安全的方法来完成本手册 sql_string = "other sql Surger here.. fieldname=\""+value+"\";"

这是你让它正确解析的唯一方法。使用 SQLite 进行 win ce。并且让我别无选择，只需在将它们放入之前转义你的值，否则你很可能最终会从 sql 注入中得到一个非常悲伤的数据库:'( 哈哈

# asp.net - 如何使用 LINQ to SQL 从 MS SQL Server 检索图像以在 Gridview ASP.NET 中绑定？

> ID：1005565
> 
> 赞同：1
> 
> 时间：2009-06-17T07:20:37.707
> 
> 标签：asp.net, sql-server, linq-to-sql, image

我有一个二进制文件，它存储在`customerPicture`CUSTOMERs 表中具有 Image 作为数据类型的列中。

我在 LINQ to SQL 中使用这行代码保存了一张图片。

```
Dim db = new MyCompanyDataContext
Dim newCus = new CUSTOMERs
Dim filebyte As Byte() = fileUploader.FileBytes
Dim fileBinary As New System.Data.Linq.Binary(filebyte)
newCus.customerPicture = fileBinary 
```

然后现在我想通过使用 LINQ to SQL 检索这个二进制文件以在 ASP.NET 的 gridview 中绑定，但我不知道如何。你能告诉我一些解决问题的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-25T15:00:08.120

您可以使用 Httphandler 从数据库中检索图像。

```
 <ItemTemplate>
                <asp:Image ID="imgPhoto" runat="server"/>
            </ItemTemplate> 
```

如果您在数据网格中有一个 Image 作为 ItemTemplate。

在数据网格的 ItemDataBound 事件中，调用“HttpHandler”来显示图像。在下面的代码中，我找到了图像控件并将 imageUrl 作为 HttpHandler 文件路径。我还将 id 作为查询字符串传递给 HttpHandlerFile。

 `````
 System.Web.UI.WebControls.Image photoImage = (System.Web.UI.WebControls.Image)e.Item.FindControl("imgPhoto");
        photoImage.ImageUrl = "ImageHandler.ashx?PhotoID=" + id.ToString(); 
````  `并在 HttpHandler 文件中使用 Linq 检索图像并显示它。

`public void ProcessRequest (HttpContext context)
{
context.Response.ContentType = "image/jpeg";`

 ````
 int photoId = -1;
    //Check the query string.
    if (context.Request.QueryString["PhotoId"] != null && context.Request.QueryString["PhotoId"] != "")
    {
        photoId = Convert.ToInt32(context.Request.QueryString["PhotoID"]);
    }

    if (photoId != -1)
    {
        MovieDataContext db = new MovieDataContext();
        //Get the movie record based on the ID
        MovieTable movie = db.MovieTables.First(m => m.ID == photoId);

        System.Data.Linq.Binary fileBinary = movie.Photo;
        byte[] fileByte = fileBinary.ToArray();
        //displays the Image.
        context.Response.BinaryWrite(fileByte);
    }
} 
````  `由于此 HttpHandler 文件映射到 datagrid 中的 imageURL，您可以看到 datagrid 中显示的图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T07:26:18.223

尝试这个：

```
dim ms as new MemoryStream
ms.Write(fileBinary.ToArray(),0,fileBinary.Length)

dim img as Image
img = Image.FromStream(ms)

newCus.customerPicture = img 
``````

# database - 数据库集群如何工作？

> ID：1005569
> 
> 赞同：5
> 
> 时间：2009-06-17T07:21:15.660
> 
> 标签：database, cluster-computing

我有一个 DBA 的问题：如果我从单个 Web/DB 服务器设置扩展到两个 Web/两个 DB 服务器设置，并且在 Web 服务器前面有一个负载平衡器以均匀地路由传入的查询......如何解决像 MySQL 集群一样工作，以便对一个数据库服务器所做的更改立即被另一个知道（否则，路由到另一个数据库服务器的用户将看不到数据或将过时的数据），或者至少让另一个 Web 服务器是否意识到它正在读取“脏数据”并且应该在 X 秒内再次尝试以获取最新数据？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T07:32:52.080

这样做的两种方法。主动/主动或主动/被动。主动/被动是最普遍的数据在被动节点上保持同步。集群是有用的配置，因为主动节点关闭，被动节点立即切换，因此没有停机时间。集群不断地同步集群中的 2 个节点。

我使用 SQL Server，但我认为集群的基本前提对于 mySQL 是相同的——即硬件故障时没有（或没有明显的）停机时间。

编辑：此外，集群软件处理同步。你不必担心。您将集群节点视为一个虚拟目录，其行为类似于 Windows 中的一台服务器。

这是解释这个的文件

[http://www.sql-server-performance.com/articles/clustering/clustering_intro_p1.aspx](http://www.sql-server-performance.com/articles/clustering/clustering_intro_p1.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T07:46:17.187

在 Windows 服务器集群（区别于高性能集群）中，有一个共享的外部存储阵列。主动节点获得存储的所有权/控制权，当该节点发生故障时，存储“故障转移”到先前的被动节点（现在是主动节点）。还有不同的方案允许在每个节点上独立存储，而不是共享存储。但是，这些要求应用程序有足够的智能来知道它是集群的，并保持两个存储集同步。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T07:53:49.057

集群也是许多节点处理工作负载的地方，这有时被称为主动/主动集群，即所有节点共享工作负载并处于活动状态。这通常由 Oracle RAC ( [RAC@Wikipedia](http://en.wikipedia.org/wiki/Oracle_RAC) ) 等 Oracle RDBMS 数据库的专业软件处理。RAC 允许 Oracle 扩展到非常大的工作负载。

# php - 这里需要一个简单的正则表达式

> ID：1005581
> 
> 赞同：0
> 
> 时间：2009-06-17T07:25:00.707
> 
> 标签：php, regex, string, wiki

我终于解析了维基百科的维基文本。我在这里有以下类型的文本：

```
{{Airport-list|the Solomon Islands}}

* '''AGAF''' (AFT) &ndash; [[Afutara Airport]] &ndash; [[Afutara]]
* '''AGAR''' (RNA) &ndash; [[Ulawa Airport]] &ndash; [[Arona]], [[Ulawa Island]]
* '''AGAT''' (ATD) &ndash; [[Uru Harbour]] &ndash; [[Atoifi]], [[Malaita]]
* '''AGBA''' &ndash; [[Barakoma Airport]] &ndash; [[Barakoma]] 
```

我需要检索以模式开头的单个数组中的所有行

```
* ''' 
```

我认为这里会调用一个正则表达式来订购，但我真的搞砸了我的正则表达式部分。

另外，在另一个示例中，我有以下文本：

```
{{otheruses}}
{{Infobox Settlement
|official_name          = Doha
|native_name        = {{rtl-lang|ar|الدوحة}} ''ad-Dawḥa''
|image_skyline          = Doha Sheraton.jpg
|imagesize              = 
|image_caption          = West Bay at night
|image_map              = QA-01.svg
|mapsize                = 100px
|map_caption            = Location of the municipality of Doha within [[Qatar]].
|pushpin_map            =
|pushpin_label_position = 
|pushpin_mapsize        = 
|subdivision_type       = [[Countries of the world|Country]]
|subdivision_name       = [[Qatar]]
|subdivision_type1      = [[Municipalities of Qatar|Municipality]]
|subdivision_name1      = [[Ad Dawhah]]
|established_title      = Established
|established_date       = 1850
|area_total_km2         = 132
|area_total_sq_mi       = 51
|area_land_km2          = 
|area_land_sq_mi        = 
|area_water_km2         = 
|area_water_sq_mi       = 
|area_water_percent     = 
|area_urban_km2         = 
|area_urban_sq_mi       =
|area_metro_km2         = 
|area_metro_sq_mi       = 
|population_as_of       = 2004
|population_note        = 
|population_footnotes = <ref name=poptotal>[http://www.planning.gov.qa/Qatar-Census-2004/Flash/introduction.html Qatar 2004 Census]</ref>
|population_total       = 339847
|population_metro       = 998651
|population_density_km2 = 2574
|population_density_sq_mi = 6690
|latd=25 |latm=17 | lats=12 |latNS=N 
|longd=51|longm=32 | longs=0| longEW=E 
|coordinates_display    = inline,title
|coordinates_type       = type:city_region:QA
|timezone               = [[Arab Standard Time|AST]]
|utc_offset             = +3
|website                = 
|footnotes              = 
}} <!-- Infobox ends -->
'''Doha''' ({{lang-ar|الدوحة}}, ''{{transl|ar|ad-Dawḥa}}'' or ''{{unicode|ad-Dōḥa}}'') is the [[capital city]] of [[Qatar]].  It has a population of 400,051 according to the 2005 census,<ref name="autogenerated1">[http://www.hotelrentalgroup.com/Qatar/Sheraton%20Doha%20Hotel%20&%20Resort.htm Sheraton Doha Hotel & Resort | Hotel discount bookings in Qatar<!-- Bot generated title -->]</ref> and is located in the [[Ad Dawhah]] municipality on the [[Persian Gulf]].  Doha is Qatar's largest city, with over 80% of the nation's population residing in Doha or its surrounding [[suburbs]], and is also the economic center of the country. 
It is also the seat of government of Qatar, which is ruled by [[Sheikh Hamad bin Khalifa Al Thani]]–the current ruling Emir of Qatar. 
```

我需要在这里提取信息框。信息框是并且包括第一次出现之间的所有文本

```
{{Infobox Settlement 
```

并以第一次出现结束

```
}} <!-- Infobox ends --> 
```

当谈到正则表达式时，我完全迷失了，我可以在这里使用帮助。我正在使用 PHP。

* * *

## 编辑！帮助！

我已经战斗了 40 个小时，但我无法让愚蠢的正则表达式正常工作:( 到目前为止，我只有这个：

{{信息框[^\b(\r|\n)}}(\r|\n)\b]*[\b(\r|\n)}}(\r|\n)(\r| \n)\b]

但它不起作用我希望它读取 {{infobox 之间的所有字符串数据并以 \n}}\n 结尾

我正在使用 Php 并且无法让它工作:( 它只是返回第一次出现的 }} 忽略了我希望它检索 }} 与前面的换行符的事实。在我浪费更多的理智之前请帮助:'(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T14:01:46.163

[MediaWiki](http://www.mediawiki.org/wiki/MediaWiki)是开源的。看看他们的[源代码](http://svn.wikimedia.org/svnroot/mediawiki/trunk/phase3/)... ;-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T07:46:21.150

> 我需要提取信息框...

试试这个，这次确保*启用*dotall 模式：

```
\{\{Infobox.*?(?=\}\} <!-- Infobox ends -->) 
```

再次，对此的解释：

```
(?xs)    # x=comment mode, s=dotall mode
\{\{     # two opening braces (special char, so needs escaping here.)
Infobox  # literal text
.*?      # any char (including newlines), non-greedily match zero or more times.
(?=      # begin positive lookahead
\}\}     # two closing braces
<!-- Infobox ends --> # literal text
)        # end positive lookahead 
```

这将匹配（但不包括）结尾表达式 - 如果需要，您可以删除前瞻本身并仅包含内容以使其包含结尾。

更新，根据评论回答：

```
\{\{Infobox.*?(?=\n\}\}\n) 
```

和上面一样，但是lookahead 在自己的行上查找两个大括号。

要选择允许评论，请使用：

```
\{\{Infobox.*?(?=\n\}\}(?: <!-- Infobox ends-->)?\n) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T07:52:34.707

我认为最好的方法是将所有行合并为一个字符串，尤其是对于信息框。

然后是类似的东西

$reg = "\n(\* '''[^\n]*)";

对于第一部分（以 * ''' 开头且不是新行的新行之后的所有内容）。

对于第二部分，我现在不确定，但这是一个玩的好地方：http: [//www.solmetra.com/scripts/regex/index.php](http://www.solmetra.com/scripts/regex/index.php)

这是正则表达式语法的简短参考： [http ://www.regular-expressions.info/reference.html](http://www.regular-expressions.info/reference.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T07:45:26.097

> 我需要检索以模式开头的单个数组中的所有行`* '''`

启用多行模式并确保*禁用*dotall 模式，然后使用：

```
^\* '''.*$ 
```

剖析的表达式是：

```
(?xm-s) # Flags:
        # x enables comment mode (spaces ignore, hashes start comments)
        # m enables multiline mode (^$ match lines)
        # -s disables dotall (. matches newline)
^       # start of line
\*      # literal asterisk
[ ]     # literal space (needs braces in comment mode, but not otherwise)
'''     # three literal apostrophes
.*      # any character (excluding newline), greedily matched zero or many times.
$       # end of line 
```

# sql-server-2005 - 在 Reporting Service 报告中显示时区信息 (SQL 2005)

> ID：1005582
> 
> 赞同：0
> 
> 时间：2009-06-17T07:25:24.543
> 
> 标签：sql-server-2005, reporting-services, timezone

我有一个 Microsoft SQL 2005 报告项目。我想在页眉上显示当前日期、时间和时区信息。也就是说，我想得到如下显示

2009 年 6 月 17 日下午 12:25:11 +05:30

我在页眉中添加了一个文本框。当将其表达式设置为 =Now 时，使用了 FormatDateTime 函数，但它们要么只显示日期或时间，要么显示日期和时间，但不显示时区。

当我将文本框的 Format 属性设置为“o”时，我得到以下显示 2009-06-17T12:37:36.2347500+05:30。这确实有时区，但日期和时间信息不是很友好。

无论如何我可以按我需要的格式（6/17/2009 12:25:11 PM +05:30）显示当前日期时间和时区信息吗？

谢谢施里达尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T07:39:38.820

使用 DateTime.Now.ToString("MM/dd/yyyy HH:mm:ss tt K")

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T07:36:18.033

请使用这个：

```
DateTime.Now.ToString("MM/dd/yyyy hh:mm:ss tt K") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T08:22:18.283

请注意您定义的“*友好*”格式。由于您想显示时区，我想您的应用程序必须被世界各地的人们使用：对于他们中的大多数人来说，“MM/dd/yyyy”格式根本不友好。
想像“2009 年 6 月 10 日”这样的日期：对于英国人来说显然是 6 月 10 日，但对于拉丁人来说可能是 10 月 6 日。
ISO 格式不是很友好，我同意，但信息是按从大到小的层次顺序显示的。此外，几乎没有人在本地使用它，这可能是一个优势，因为每个人都必须了解它在看什么，而不是根据他/她的语言环境做出错误的假设。

# php - 如何根据所选的产品选项交换购物车中已有的产品图片？

> ID：1005586
> 
> 赞同：0
> 
> 时间：2009-06-17T07:26:34.620
> 
> 标签：php, magento, model-view-controller, magento-1.3

最近我需要增强 Magento (1.3.1) 用户界面。特别是添加一个产品图像切换器（遵循[http://inchoo.net/ecommerce/magento/create-a-color-switcher-in-magento/](http://inchoo.net/ecommerce/magento/create-a-color-switcher-in-magento/)）。

结果： - 图像切换器按预期工作，这很好。

问题： - 产品本身可以容纳多达 15 或 20 种彩色图像可供选择。

目标： - 当用户使用“选择”元素选择产品颜色时，所选产品颜色必须交换默认产品颜色以显示在购物车中。

我正在考虑使用会话来保存选定的数据然后交换它，但它看起来很复杂，因为图像目录作为缓存目录保存，我在查看图像时不知道确切的路径。

第二个想法是使用 /checkout/cart/item/default.phtml 从结帐/购物车控制器交换，但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-02-19T10:04:43.843

如果您将可配置产品与关联的简单产品一起使用，用户将添加到购物车简单产品而不是可配置产品。每个 Simple 产品都可以有不同的属性（例如：颜色）

# javascript - 甘特图在线

> ID：1005587
> 
> 赞同：18
> 
> 时间：2009-06-17T07:27:34.603
> 
> 标签：javascript, python, charts, gantt-chart

我需要在网页中插入水平条形图。我要做的事情与甘特图非常相似。

我想为此目的使用一个 javascript 库。我尝试了jsgantt，但实际上它不是很漂亮。

我还可以评估图表的服务器生成。如果我的服务器端语言是 Python。

它将是无法访问 Internet 的内部项目的一部分，因此不能选择 Google Charts。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-17T07:47:31.160

看看[flot jQuery 插件](http://code.google.com/p/flot/)：

> Flot 是一个用于 jQuery 的纯 Javascript 绘图库。它在客户端即时生成任意数据集的图形图。
> 
> 重点是简单的使用（所有设置都是可选的）、有吸引力的外观和缩放和鼠标跟踪等交互功能。

该库可以生成条形图，并由我们的主机站点使用 - 请查看 Stack Overflow [Reputation History](https://stackoverflow.com/users/6491/gimel?tab=reputation&sort=graph)页面。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-04T08:33:01.500

这是一个完整的基于 jQuery 的甘特图编辑器 Mit 许可

[http://roberto.open-lab.com/2012/08/24/jquery-gantt-editor/](http://roberto.open-lab.com/2012/08/24/jquery-gantt-editor/)

如果您想对可用的进行“完整”审查，请参见此处：

[http://roberto.open-lab.com/2012/06/14/the-javascript-gantt-odyssey/](http://roberto.open-lab.com/2012/06/14/the-javascript-gantt-odyssey/)

我最近添加了基于 SVG 的绘图和折叠/展开树功能。

见[http://roberto.open-lab.com/2014/05/15/jquery-gantt-editor-collapsible-branches/](http://roberto.open-lab.com/2014/05/15/jquery-gantt-editor-collapsible-branches/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-10-11T11:10:54.223

尝试其中之一：

[http://dhtmlx.com/docs/products/dhtmlxGantt/index.shtml](http://dhtmlx.com/docs/products/dhtmlxGantt/index.shtml) - 整洁的图表，编辑任务的选项，一个严重的缺点：缺乏时间尺度变化

[http://dojotoolkit.org/reference-guide/dojox/gantt.html](http://dojotoolkit.org/reference-guide/dojox/gantt.html) - 免费（！！），非常好，但很难定制（除非你修改源代码）

[http://bryntum.com/gantt/](http://bryntum.com/gantt/) - 到目前为止，我的最爱之一 - 很容易定制，但商业项目的许可不清楚，你可以下载试用 45 天

[http://www.tgantt.com/treegrid/www/Gantt.html](http://www.tgantt.com/treegrid/www/Gantt.html) - 实际上，这个看起来像一个太空船的仪表板，所以它是配置，仍然努力把它放在我的应用程序中

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-04-21T00:39:42.223

对我来说，最好的是[http://gantter.com/](http://gantter.com/)你不需要注册过程，它导出到 msproject 或 pdf ......完美！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-05-02T11:11:44.343

我注意到本次讨论中缺少[**RadiantQ 的 jQuery 甘特图包。**](http://www.radiantq.com/)这是相对较新的，但有很多功能，可定制并且可以绑定到任何类型的数据。在线演示在**[这里](http://demos.radiantq.com/jQueryGanttDemo/Demo.htm)**。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-10-27T14:43:55.573

看看[http://www.ext-scheduler.com](http://www.ext-scheduler.com)。100% JavaScript，基于 ExtJS。免责声明：我写的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-03-19T08:47:46.203

[JQuery 甘特图](http://mbielanczuk.com/2011/06/jquery-gantt-chart/)- 我测试过的最好的

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-17T07:36:00.683

有关甘特图生成，请参阅：

*   [http://www.mechanicalcat.net/tech/pytaskplan/](http://www.mechanicalcat.net/tech/pytaskplan/)
*   [http://www.strout.net/python/piddle/](http://www.strout.net/python/piddle/)
*   [http://opensched.sourceforge.net/](http://opensched.sourceforge.net/)

或者有一般的图表库，比如

*   [http://matplotlib.sourceforge.net/](http://matplotlib.sourceforge.net/)
*   [http://home.gna.org/pychart/](http://home.gna.org/pychart/)

或者可能只是使用[gnuplot](http://www.gnuplot.info/)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-17T07:36:45.613

也许您可以通过这些示例对如何完成它有一些印象：

*   [http://www.yuml.me/](http://www.yuml.me/)
*   [http://creately.com/](http://creately.com/)
*   [http://www.chartle.net/](http://www.chartle.net/)
*   [http://www.lovelycharts.com/](http://www.lovelycharts.com/)
*   [http://www.icarts.net/](http://www.icharts.net/)
*   [https://scrumy.com/](https://scrumy.com/)
*   [http://chartgizmo.com/](http://chartgizmo.com/)
*   [http://www.archimy.com/](http://www.archimy.com/)
*   [http://www.gliffy.com/](http://www.gliffy.com/)

我希望这些足以激发一些灵感。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-17T08:07:30.373

另请参阅[Open Flash Chart](http://teethgrinder.co.uk/open-flash-chart/index.php) 它还为最流行的编程语言提供支持助手。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-17T17:39:42.643

[您可以在http://www.fusioncharts.com/widgets/gallery.asp](http://www.fusioncharts.com/widgets/gallery.asp)使用 FusionWidget 。它不是免费的，但它的甘特图对我来说非常有用。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2010-06-17T21:13:19.880

我喜欢这个，仍在开发中，“使用它需要您自担风险”，但它非常拖拽

[http://ganttapp.appspot.com](http://ganttapp.appspot.com)

# python - python列表函数的运行时复杂度是多少？

> ID：1005590
> 
> 赞同：44
> 
> 时间：2009-06-17T07:28:54.537
> 
> 标签：python, complexity-theory

我正在编写一个看起来像这样的python函数

```
def foo(some_list):
   for i in range(0, len(some_list)):
       bar(some_list[i], i) 
```

所以它被称为

```
x = [0, 1, 2, 3, ... ]
foo(x) 
```

我曾假设列表的索引访问是`O(1)`，但惊讶地发现对于大型列表，这比我预期的要慢得多。

那么，我的问题是如何实现 python 列表，以及以下的运行时复杂性是多少

*   索引：`list[x]`
*   从最后弹出：`list.pop()`
*   从头弹出：`list.pop(0)`
*   扩展列表：`list.append(x)`

为了额外的信用，拼接或任意弹出。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-06-17T07:57:35.523

python wiki上有[一个非常详细的表格](http://wiki.python.org/moin/TimeComplexity)可以回答您的问题。

但是，在您的特定示例中，您应该使用它`enumerate`来获取循环内可迭代的索引。像这样：

```
for i, item in enumerate(some_seq):
    bar(item, i) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-17T07:37:59.370

答案是“未定义”。Python 语言没有定义底层实现。以下是您可能感兴趣的邮件列表主题的一些链接。

*   [确实，到目前为止，Python 的列表已经在 Python 的 C 实现中实现为连续向量。](http://mail.python.org/pipermail/python-list/2003-April/199506.html)

*   [我并不是说这些事情的 O() 行为应该保密或任何事情。但是您需要在 Python 一般如何工作的上下文中解释它们。](http://mail.python.org/pipermail/python-list/2003-April/199585.html)

此外，编写循环的更 Pythonic 方式是：

```
def foo(some_list):
   for item in some_list:
       bar(item) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-17T08:49:57.837

列表确实是 O(1) 索引 - 它们被实现为具有比例过度分配的向量，因此执行得如您所愿。您发现此代码比您预期慢的可能原因是对“ `range(0, len(some_list))`”的调用。

`range()`创建一个指定大小的新列表，因此如果 some_list 有 1,000,000 个项目，您将在前面创建一个新的百万项目列表。这种行为在 python3 中发生了变化（范围是一个迭代器），python2 的等效项是[xrange](http://docs.python.org/library/functions.html#xrange)，或者更适合您的情况，[枚举](http://docs.python.org/library/functions.html#enumerate)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-17T07:53:01.417

如果您需要索引和值，请使用枚举：

```
for idx, item in enumerate(range(10, 100, 10)):
    print idx, item 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-03-31T11:04:51.360

Python list 实际上只是数组。因此，

索引需要 O(1)

根据文档，对于 pop 并再次追加，它应该是 O(1)

查看以下链接了解详情：

[http://dustycodes.wordpress.com/2012/03/31/pythons-data-structures-complexity-analysis/](http://dustycodes.wordpress.com/2012/03/31/pythons-data-structures-complexity-analysis/)

# java - 如何将日期时间转换为日期

> ID：1005596
> 
> 赞同：24
> 
> 时间：2009-06-17T07:30:08.903
> 
> 标签：java, datetime, jodatime

我怎样才能转换`Date`成`DateTime`反之亦然？

例如

```
Date dt = new Date(); 
```

现在我想将其转换为`DateTime`.

还

```
DateTime dtim = new DateTime(); 
```

现在我想将其转换为日期。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-06-17T07:37:20.777

你说`Joda Time`的是这个吗？`DateTime`如果是这样，它将是

```
dateTime.toDate() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-07-05T21:23:18.653

正如斯卡夫曼上面所说

```
dateTime.toDate() 
```

应该做的伎俩。但请记住，如果 dateTime 对象的时区与用户当前时区不同， dateTime.toDate() 将返回用户时区中的日期对象。IE

```
DateTime newDate = new DateTime().toDateTime(DateTimeZone.forID("America/Los_Angeles"));
System.out.println(newDate);
System.out.println(newDate.toDate()); 
```

这将打印

2017-07-05T14:19:23.294-07:00

2017 年 7 月 5 日星期三 15:19:23 MDT

因为我的系统时间在 MDT

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T07:34:41.280

我猜你通过 Date.getTime() 将它转换为 UTC。之后，在另一个对象上使用构造函数/设置器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-09T15:34:30.560

转换为`date`：

```
dateTime.toDate() 
```

转换为`DateTime`：

```
new DateTime(new Date()) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-01-03T15:20:17.283

如果要将 DateTime 转换为 Date 而不会丢失时区，请先将 DateTime 转换为 Joda LocalDateTime。

```
DateTime dateTimeUtc = new DateTime(); //because my default timezone is UTC
DateTime dateTimeBerlin = dateTimeUtc.withZone(DateTimeZone.forID("Europe/Berlin"));
Date convertedDate = dateTimeBerlin.toLocalDateTime().toDate(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-08-03T13:44:11.447

最简单的方法是使用内置`toDate()`方法，例如：

```
Date dt = new Date(); 
DateTime datetime = New DateTime(dt);

Date result = dateTime.toDate(); 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-06-18T05:31:38.873

您可以轻松地使用[`toDate()`](http://joda-time.sourceforge.net/apidocs/org/joda/time/base/AbstractInstant.html#toDate%28%29)获取日期时间的函数`java.util.Date`：

```
Date date = MydateTime.toDate(); 
```

# php - c++ 到 php 的转换

> ID：1005597
> 
> 赞同：0
> 
> 时间：2009-06-17T07:31:31.317
> 
> 标签：php

我写了一个用 c++ 编写的 LU，我需要向 php 添加相同的代码，我做到了，这很糟糕，但在 php 中我有不同的结果。c++中的主要计算是：

```
 for (int i=0;i<m;i++)
    {
         for (int j=0;j<m;j++)
         {
             cout << tab1[i][j]<<"\t";    
         }   
         cout <<endl;
    }

      for (int i=0;i<m;i++)
    {
         for (int j=0;j<m;j++)
         {

             if (i==j) 
              {
                       tab2[i][j]=1;
                       tab3[i][j]=0;
                       }
              else
              {
                       tab3[i][j]=0;
                       tab2[i][j]=0;
                       }

         }   
    }
       //glowne dzielenie tego co mamy do rozlozenia
    for (int i=0;i<m;i++)
    {   

        for (int j=0;j<m;j++)
        {
            for (int k=0;k<m;k++)
            {
                pom+=tab2[i][k]*tab3[k][j];   
                pomoc+=tab2[j][k]*tab3[k][i];    
            }    
           if (i<=j)
            tab3[i][j]=tab1[i][j]-pom;

           if (j>=i)
            tab2[j][i]=(tab1[j][i]-pomoc)/tab3[i][i];

            pom=0;
            pomoc=0;
        }    
    } 
```

在 php 中它看起来：

```
 $w= sizeof($this->input['macierz_1']);
        $pom=0;         $pomoc=0;

                            for ($i=1;$i<=$w;$i++)
                {
                for ($j=1;$j<=$w;$j++)
                    {

                        if ($i==$j) 
                        {
                                $tab2[$i][$j]=1;
                                $tab3[$i][$j]=0;
                                }
                    else
                        {
                                $tab3[$i][$j]=0;
                                $tab2[$i][$j]=0;
                                }

                    }   
                }

        //glowne dzielenie tego co mamy do rozlozenia
        for ($i=1;$i<=$w;$i++)
            {   
            for ($j=1;$j<=$w;$j++)
                {
                    for ($k=1;$k<=$w;$k++)
                        {
                        $pom+=$tab2[$i][$k]*$tab3[$k][$j];  
                        $pomoc+=$tab2[$j][$k]*$tab3[$k][$i];

                        }    
                    if ($i<=$j)
                        $tab3[$i][$j]=($this->input['macierz_1'][$i][$j])-$pom;

                    if ($j>=$i)

                    $tab2[$j][$i]=(($this->input['macierz_1'][$i][$j])-$pomoc)/$tab3[$i][$i];

                    $pom=0;
                    $pomoc=0;

                }    
            }
            echo '<b>Macierz wynikowa L:<br> </b>';
        $this->formularz($w,$w,'macierz_L',$tab2);
                echo '<b>Macierz wynikowa U: <br> </b>';
        $this->formularz($w,$w,'macierz_U',$tab3);
                } 
```

我知道我开始使用 php 形式 1 而不是 0 并且在所有算法中都可以。任何人都可以告诉我我在哪里制作了matake或在php中给algorytm LU它工作了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T07:42:21.827

1.  什么是 LU？
2.  你到底是什么意思的错误。运行时错误，意外输出，程序不终止？

乍一看，您的 PHP 代码对我来说是正确的。

你必须更清楚一点，否则人们很难帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T07:58:45.507

1.  LU 它是带有 Lover 和 Upper decay 的数值方法。熟悉阵列的高斯消元法。
2.  我没有运行任何错误程序，但结果不是应该的。他们是不同的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T10:01:44.917

这个例子有帮助吗？[http://au.php.net/manual/en/function.array.php#49054](http://au.php.net/manual/en/function.array.php#49054)

> gmail dot com 的 michael dot bommarito
> 
> 2005 年 1 月 15 日 03:14
> 
> 以防万一其他人在编写 LU 分解函数时寻求帮助，这里有一个简单的例子。
> 
> 注意 所有数组都假定从索引 1 开始，而不是 0。这不难更改，但请确保指定数组（1=>...），而不仅仅是数组（...）。
> 
> 此外，该函数被优化为仅考虑矩阵的可变元素。由于 $L 将是一个下三角矩阵，因此无需计算对角线或上三角的元素；$U 也是如此。
> 
> 此函数也不检查以验证输入矩阵是否非奇异。

```
/*
 * LU Decomposition
 * @param $A initial matrix (1...m x 1...n)
 * @param $L lower triangular matrix, passed by reference
 * @param $U upper triangular matrix, passed by reference
*/
function LUDecompose($A, &$L, &$U) 
{
    $m = sizeof($A);
    $n = sizeof($A[1]);

    for ( $i = 1; $i <= $m; $i++ ) {
        $U[$i][$i] = $A[$i][$i];

        for ( $j = $i + 1; $j <= $m; $j++ ) {
            $L[$j][$i] = $A[$j][$i] / $U[$i][$i];
            $U[$i][$j] = $A[$i][$j];
        }
        for ( $j = $i + 1; $j <= $m; $j++ ) {
            for ( $k = $i + 1; $k <= $m; $k++ ) {
              $A[$j][$k] = $A[$j][$k] - ($L[$j][$i] * $U[$i][$k]);
            }
        }
    }

    return;
} 
```

# javascript - 以编程方式在高冲突环境中包含 JQuery -

> ID：1005600
> 
> 赞同：3
> 
> 时间：2009-06-17T07:32:39.927
> 
> 标签：javascript, jquery, scripting, include

我正在编写一段代码以放在任何第三方网站上，但不知道它将被放入什么环境。我的最终目标是获得徽章

```
<script src="http://example.com/js/badge.js"></script> 
```

我想在我的徽章代码中使用 jQuery 来让我的生活更轻松，但我不想在客户端需要另一个包含（在客户端上更新任何东西都是一种痛苦）。

这是我能想到的最好的。我不希望我的脚本之前或之后的任何东西受到任何剩余变量或奇怪的碰撞的影响。有没有人看到任何问题？

```
(function() {
    function main($) {
        // do stuff with $
        $(document.body).css("background", "black")
    }

    // If jQuery exists, save it
    var old_jQuery = null;
    if (typeof(jQuery) != "undefined") {
        if (typeof(jQuery.noConflict) == "function") {
            old_jQuery = jQuery.noConflict(true);
        }
    }

    var addLibs = function() {
        // Body isn't loaded yet
        if (typeof(document.body) == "undefined" || document.body === null) {
            setTimeout(addLibs, 100);
            return;
        }

        var node = document.createElement("script");
        node.src = "http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js";
        document.body.appendChild(node);
        checkLibs();
    }

    var checkLibs = function() {
        // Library isn't done loading
        if (typeof(jQuery) == "undefined" || jQuery("*") === null) {
            setTimeout(checkLibs, 100);
            return;
        }
        var new_jQuery = jQuery.noConflict(true);
        jQuery = old_jQuery;
        main(new_jQuery);
    }

    addLibs();
})(); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-28T06:54:32.670

我最终选择了[http://yourock.paulisageek.com/js/popup.js](http://yourock.paulisageek.com/js/popup.js)。请参阅测试（可使用控制台日志记录）[http://paulisageek.com/tmp/jquery-programatically.html](http://paulisageek.com/tmp/jquery-programatically.html)。在 jQuery 真正完成加载之前，它不会重置 jQuery 和 $。有什么方法可以在没有无限循环的情况下阻止 javascript（它会阻止 jQuery 加载本身）？

```
// A namespace for all the internal code
var yourock = {};

// Include JQuery programatically
(function() {
    // Don't let the script run forever
    var attempts = 30;

    // If jQuery exists, save it and delete it to know when mine is loaded
    var old_jQuery;
    if (typeof(jQuery) != "undefined") {
        if (typeof(jQuery.noConflict) == "function") {
            old_jQuery = jQuery;
            delete jQuery;
        }
    }

    var addLibs = function() {
        var head = document.getElementsByTagName("head");
        if (head.length == 0) {
            if (attempts-- > 0) setTimeout(addLibs, 100);
            return;
        }

        var node = document.createElement("script");
        node.src = "http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js";
        head[0].appendChild(node);
        checkLibs();
    }

    var checkLibs = function() {
        // Library isn't done loading
        if (typeof(jQuery) == "undefined" || typeof(jQuery) != "function" || jQuery("*") === null) {
            if (attempts-- > 0) setTimeout(checkLibs, 100);
            return;
        }
        yourock.jQuery = jQuery.noConflict(true);
        if (typeof old_jQuery == "undefined")
            jQuery = old_jQuery;
    }

    addLibs();
})(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T10:29:46.870

这有效：

```
(function(){
    if (window.jQuery !== undefined) {
        doStuff(jQuery);
    } else {
        var script = document.createElement('script');
        script.src = 'http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js';
        document.getElementsByTagName('head')[0].appendChild(script);
        var interval = setInterval(function(){
            if (window.jQuery) {
                clearInterval(interval);
                var JQ = jQuery.noConflict(true);
                doStuff(JQ);
            }
        }, 100);
    }
})();

function doStuff($) { /* Do stuff with $ */ } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T07:59:19.093

再次包含 jQuery 将覆盖该`$`变量，该变量可能是旧版本的 jQuery 或其他框架。您可能也应该保存它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-20T15:41:21.973

我没有对这段代码进行太多测试，但它应该可以工作......

```
(function($, window) {
    var version = ($ && typeof($) == 'function' && $().jquery ? ($().jquery).split('.').join('') : 0), // 1.8.1 -> 181
        jBack   = null;
    if (version) console.log('jQuery current version : ', version);
    else         console.log('no jQuery');
    var loaded = function() {
            console.log('loaded()');
            var $ = jQuery.noConflict(true); // LOCAL own jQuery version
            if (jBack)  {
                window.$      = jBack; // Reassign ex-jQuery
                window.jQuery = jBack;
            }
            // OK : now work with OUR new $
            console.log('jQuery new version : ', $().jquery);
        },
        loadJs = function(jsPath) {
            console.log('loadJs()');
            var s = document.createElement('script');
            s.setAttribute('type', 'text/javascript');
            s.setAttribute('src', jsPath);
            s.onload = loaded;
            document.getElementsByTagName('body')[0].appendChild(s);
        };

    if (version) jBack = $;
    if (version < 180) loadJs('http://code.jquery.com/jquery-1.9.1.min.js');
    else loaded();

})((typeof(jQuery) == 'function' ? jQuery : null), window); 
```

# c# - 为持久数据创建和删除编写单元测试

> ID：1005607
> 
> 赞同：3
> 
> 时间：2009-06-17T07:33:55.823
> 
> 标签：c#, database, unit-testing

在为持久存储的数据编写测试时，我想出了一个测试：

```
[TestMethod]
public void DoCreateDeleteTest() {
    PersistentDataStore pds = new PersistentDataStore();
    bool createSuccess = pds.Save("id", "payload");
    Assert.AreEqual(true, createSuccess);
    bool deleteSuccess = pds.Delete("id");
    Assert.AreEqual(true, deleteSuccess);
} 
```

只要一切正常，这似乎很好。该函数没有先前的依赖关系，它会自行清理。问题是：当 .Save() 方法执行保存但返回 false/failure 时。断言触发并且不调用删除，因此它不会自行清理。

在此之后，数据库中存在名为“id”的持久数据，并且所有未来的保存都失败。

我能想到解决它的唯一方法是在保存之前进行预防性删除，但这似乎是一种大黑客的方式。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T07:42:19.267

将删除放在标有[TestCleanup](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.testcleanupattribute(VS.80).aspx)属性的方法中（我假设您使用的是 MSTest）。

顺便说一句，您的测试还测试了两个不同的东西：保存是否有效，它还测试了删除。测试一次只能测试一件事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T07:41:11.533

将两者都包装在一笔交易中？在捕获中删除？

# pdf - Erlang中的PDF处理库

> ID：1005617
> 
> 赞同：8
> 
> 时间：2009-06-17T07:38:13.550
> 
> 标签：pdf, erlang

我正在寻找一个用 Erlang 编写的 PDF 处理库，但我还没有找到。[ErlGuten](http://www.sics.se/~joe/erlguten-2.1/erlguten.html)，我发现的唯一库只能生成 PDF 而不能处理它们。有人知道这样的图书馆吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T10:33:34.743

我认为您最好的选择是与第 3 方 PDF 库连接。例如 Adob​​e 自己的 PDF Library SDK 或其他鲜为人知的供应商。

看; [http://www.adobe.com/devnet/pdf/library/](http://www.adobe.com/devnet/pdf/library/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-03T15:50:08.023

有一个基于 webkit 的开源库：WKHTMLTOPDF
它从 HTML 模板生成 PDF。

这里是我们如何在 Erlang 后端使用它的[小教程。](http://beebole.com/en/blog/general/convert-html-to-pdf-with-full-css-support-an-opensource-alternative-based-on-webkit/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-04-17T08:20:30.743

也许 Jinterface 是最好的方法。尝试使用 Java 处理 PDF。

# iphone - iPhone：如何减小 UIBarButtonItemWidth？

> ID：1005624
> 
> 赞同：2
> 
> 时间：2009-06-17T07:39:48.057
> 
> 标签：iphone, width, uibarbuttonitem

我创建了一个 UIBarButtonItem，然后将 self.navigationItem.rightBarButtonItem 设置为该项目。

## 但是，设置 barButtonItem 的 width 属性似乎对按钮的宽度没有任何影响（我正在尝试减小 barButton 的宽度）

## 如果我为 UIBarButtonItem 使用自定义视图，我可以设置视图的宽度（进而设置 barButton 的宽度）

但是，我想获得标准 UIBarButtonItem 的外观。

有谁知道如何在不使用自定义视图的情况下减小 UIBarButtonItem 的宽度？（或者，有谁知道如何创建一个看起来像 UIBarButtonItem 的 UIView 或 UIButton）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-12-08T11:33:27.930

看起来苹果真的不想要它（人机界面指南）。但是，如果您使用自己的视图，则有一个静态的解决方案：

只需使用图像...使用抓取从 IB 以您想要的宽度复制图像。然后它们看起来就像 UIBarButtons

Apple 向您展示了如何根据状态将两个不同的图像（以及在此示例中的函数）映射到同一个按钮...查看“添加音乐”示例代码：http: [//developer.apple.com/iphone /library/samplecode/AddMusic/index.html](http://developer.apple.com/iphone/library/samplecode/AddMusic/index.html)

这是来自 TechGuru @ [http://discussions.apple.com/thread.jspa?messageID=9822548](http://discussions.apple.com/thread.jspa?messageID=9822548)

# apache-flex - 图像浏览器缓存。柔性

> ID：1005629
> 
> 赞同：1
> 
> 时间：2009-06-17T07:41:02.033
> 
> 标签：apache-flex, image

我试图从不同的地方加载 Flex 中的图像，并且图像总是一次又一次地从服务器加载。

有没有办法从浏览器缓存中加载图像？

谢谢，
弗拉基米尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T08:06:36.257

如果您知道要在 4 个不同的地方加载图像，您是否考虑过将图像嵌入到 swf 中，那么您根本不需要加载它。

如果这不是一个选项，那么您可以创建一个图像字典，使用图像的源作为键。如果尚未填充特定键，则您尚未加载该图像，如果已填充，则可以从字典中引用该图像（这样您只加载一次）。

将 Dictionary 放在一个单例类中，以便可以从应用程序中的任何位置访问它。

肯尼斯。

# java - 如何在 Groovy 中使用 Java 包

> ID：1005638
> 
> 赞同：0
> 
> 时间：2009-06-17T07:43:11.187
> 
> 标签：java, groovy, jar, sum

我在学校，我们正在做这些 java 的东西。我们使用一个名为 sum.kern 的特殊库：[http ://www.mg-werl.de/sum/bjw.zip](http://www.mg-werl.de/sum/bjw.zip)

我想使用 Groovy 而不是 Java。但是我不能很好地使用这个库。如果我在葡萄中添加罐子并尝试导入 sum.kern 并创建一个 sum.kern.Bildschirm 它说它无法找到它。怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T08:03:57.290

我不认为这应该是一个问题，它非常简单。唯一的要求是在你的类路径中有这个库。

你能成功导入包吗？

不过没关系，您使用的是什么 IDE，顺便说一句？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-20T01:38:38.113

您应该有一个“groovy-starter.conf”文件，它指定 groovy 查找 jar 文件的目录。它应该在 groovy.home 中的“conf”目录中（例如，在我的机器上它是“C:\groovy\Groovy-1.5.6\conf\groovy-starter.conf”）。

如果包含要导入的类的 jar 文件位于这些目录之一中，则应该可以毫无问题地导入它。或者，您可以将 jar 当前所在的目录添加到您的 groovy-starter.conf 文件中。

# facebook - Facebook 连接 showFeedDialog

> ID：1005645
> 
> 赞同：1
> 
> 时间：2009-06-17T07:46:35.687
> 
> 标签：facebook

我想使用 FB.Connect.showFeedDialog(...)，但如果没有弹出窗口，这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T19:50:05.893

不，很遗憾，目前无法直接在 iFrame 或 Facebook Connect 应用程序中使用 Feed 表单。唯一的选择是使用 FBJS 内置包装器 FB.Connect.showFeedDialog() 和 FB.Connect.showAddSectionButton()。

您可能还想查看以下内容（如果您还没有，您可能已经拥有）：

[在 IFrame 中创建弹出对话框，将](http://wiki.developers.facebook.com/index.php/Creating_a_Popup_Dialog_in_an_IFrame "在 IFrame 中创建弹出对话框")
[提要故事发布到 Facebook](http://wiki.developers.facebook.com/index.php/Publishing_Feed_Stories_to_Facebook "将动态故事发布到 Facebook")

# java - 日期时间包

> ID：1005646
> 
> 赞同：-2
> 
> 时间：2009-06-17T07:46:49.367
> 
> 标签：java

在哪个包中定义了 DateTime

我需要导入什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T07:50:01.063

如果这是[`DateTime`](http://joda-time.sourceforge.net/api-release/org/joda/time/DateTime.html)来自[Joda Time](http://joda-time.sourceforge.net/)的类，它在`org.joda.time`包下。

它不附带标准的 Java 发行版，因此需要从[Joda Time 站点](http://joda-time.sourceforge.net/)下载。

# html - 在 Microsoft Dynamics CRM 4 的弹出窗口中打开电子邮件

> ID：1005651
> 
> 赞同：0
> 
> 时间：2009-06-17T07:49:11.797
> 
> 标签：html, email, browser, dynamics-crm, dynamics-crm-4

我希望在更改属性值时弹出一个新的电子邮件窗口。有没有人有任何建议如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T15:16:19.680

根据您添加的评论，我会推荐几种解决方案。

1）最简单的实际上可能是向服务活动实体添加一个名为“电子邮件评论”或其他内容的字段，并编辑您的工作流程以包括该字段的内容以及当前在电子邮件中的其余内容。

2）你可以做你最初想做的事并打开一个新的电子邮件活动，但有一些陷阱：

*   如果环境启用了 IFD，则 url 将在这与正常的 CRM 部署之间发生变化，因此您的 javascript 必须考虑到这一点。
*   无法从 url 设置您当前在工作流中填充的字段（to、from、content）。您必须在电子邮件实体上的 onLoad 事件中添加更多代码以调用 Web 服务（通过 javascript，这有点痛苦，或者设置自定义 Web 服务并将它们部署到 CRM 服务器）并填充字段.

`#`1 将更容易获得与您正在寻找的几乎相同的最终结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T07:54:15.377

```
<INPUT NAME="test" onChange="popup(...)" /> 
```

其中 popup 将是一个用于创建弹出窗口的 javascript 函数

或者如果这没有帮助，请更具体地告诉我们什么类型的属性、语言等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T09:35:22.240

你的问题很模糊，但我怀疑你想要。

```
<input onchange="window.open('mailto:you@wherever','myEmailWindow');return true"> 
```

取决于用户的弹出窗口阻止设置，这可能会或可能不会起作用。

# asp.net - 使用 ASP.NET 打印 web 控件时隐藏页眉和页脚

> ID：1005652
> 
> 赞同：0
> 
> 时间：2009-06-17T07:49:28.677
> 
> 标签：asp.net, printing, web-controls, printing-web-page

在 ASP.NET 中打印 webcontol 时，如何隐藏“第 1 页，共 1 页”和页脚 (url) 之类的页眉？

我目前通过在打印按钮上打开一个新页面单击并在其中进行操作

```
protected void Page_Load(object sender, EventArgs e)
{
    if( null != Session["Control"] )
    {
        Control ctrl = ( Control )Session["Control"];
        PrintManager.PrintWebControl( ctrl );
        Session["Control"] = null;
    }
} 
```

这将打印页眉和页脚。如何避免？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T08:14:53.227

该设置由用户在其浏览器中配置。他们无法从代码中禁用它。最好的办法是包含有关如何配置/禁用设置的说明。

在此处查看示例： [http ://www.xheo.com/products/sps/default.aspx?print=true](http://www.xheo.com/products/sps/default.aspx?print=true)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T13:11:21.803

您应该使用 CSS 样式并指定它们适用于打印的媒体类型。请参阅本文寻求帮助；[http://www.cantoni.org/articles/printstyle](http://www.cantoni.org/articles/printstyle)

基本上只为打印样式创建一个单独的样式表。如果您想在页面上隐藏某些内容，请使用`{ display:none }`该元素的样式属性之一。然后在 HEAD 元素中链接您的样式表；

```
<link href="print.css" media="print" type="text/css" rel="stylesheet" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-01T20:07:31.743

如果您使用的是 Firefox，并且您可以让客户端安装[此插件](https://addons.mozilla.org/en-US/firefox/addon/8966)。

否则，如果您使用 Internet Explorer：谷歌搜索“ *MeadCo ScriptX* ”

（FF 选项是免费的，IE 选项是免费的，仅用于基本功能）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-07-30T12:46:19.000

为此，我们正在使用类似的打印类

```
public static void PrintWebControl(Control ctrl)
{
    PrintWebControl(ctrl, string.Empty);
}

public static void PrintWebControl(Control ctrl, string Script)
{
    StringWriter stringWrite = new StringWriter();
    System.Web.UI.HtmlTextWriter htmlWrite = new System.Web.UI.HtmlTextWriter(stringWrite);
    if (ctrl is WebControl)
    {
        Unit w = new Unit(100, UnitType.Percentage); ((WebControl)ctrl).Width = w;
    }
    Page pg = new Page();
    pg.EnableEventValidation = false;
    if (Script != string.Empty)
    {
        pg.ClientScript.RegisterStartupScript(pg.GetType(), "PrintJavaScript", Script);
    }
    HtmlForm frm = new HtmlForm();

    pg.Controls.Add(frm);
    // done changes on below 1 line for unassigned header URL //
    frm.ResolveUrl("");
    frm.Attributes.Add("runat", "server");
    frm.Controls.Add(ctrl);

    pg.DesignerInitialize();

    pg.RenderControl(htmlWrite);
    string strHTML = stringWrite.ToString();
    HttpContext.Current.Response.Clear();        
    HttpContext.Current.Response.Write(strHTML);
    HttpContext.Current.Response.Write("<script>window.print();</script>");
    HttpContext.Current.Response.End();
} 
```

这里只需更改表单属性中的一行并设置

```
frm.ResolveUrl(""); 
```

所以打印页面时 URl 不可见..我成功使用它。

# linux - 在 RHEL 5 (2.6.8-18.el5) 上挂载 NTFS（读/写能力）文件系统

> ID：1005658
> 
> 赞同：1
> 
> 时间：2009-06-17T07:51:39.217
> 
> 标签：linux

我正在使用带有内核 2.6.8-18.el5 的 RHEL 5.0。我想用 NTFS 文件系统挂载我的外部硬盘驱动器。我无法挂载它，因为它不支持 NTFS 文件系统。错误消息：挂载：未知的“ntfs”文件系统。

谁能告诉我挂载这个硬盘？

问候，

萨里特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T08:09:50.943

安装 ntfs-3g 软件包，因为它包含适用于 Linux 的有效 NTFS 驱动程序。然后使用命令挂载：“mount -t ntfs-3g /dev/sda1 /mnt/windows”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T07:57:53.417

你最好在[https://serverfault.com/](https://serverfault.com/)上问这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-01T14:45:17.133

添加到 Niels 的答案中，如果您能够安装 ntfs-3g 软件包，然后使用以下命令，在带有 windows 分区的 redhat 上对我来说完美无缺：

```
sudo ntfsfix /dev/sda9 
```

其中 /dev/sda9 是您的 Windows 分区。在执行此操作之前，请确保：

-> 启动 windows，重新启动它并登录 redhat linux 而不是 windows。

如果上面的 ntfs-3g 驱动程序不起作用，您可能还想查看 bios 设置。

# scala - Scala 演员作为单线程队列

> ID：1005659
> 
> 赞同：2
> 
> 时间：2009-06-17T07:52:12.320
> 
> 标签：scala, message-queue, actor, concurrent-processing

我想在一个节目中使用演员，在这个节目中，我会对一些演员进行某种限制，就好像他们是队列一样。例如，假设我有一些应用更改事件的外部系统以及一些外部系统数据的缓存。所以我有2个演员：

1.  `ChangeApplicationActor`
2.  `CacheActor`

作为 的一部分`ChangeApplicationActor`，当我对外部系统中的某个实体应用更改时`X`，我想发送一些事件来告诉`CacheActor`同步：

```
val changeApplicationActor = actor { 
  loop {
    react {
      case ChangeInstruction(x) => 
        externalSystem.applyChange(x)
        cacheActor ! Sync(x)
    }
  }
} 
```

但我现在有两个要求：

1.  具有`CacheActor`内部状态，理想情况下我希望它`Sync`按顺序处理其指令
2.  如果我最终在`CacheActor`收件箱中包含两个`Sync(x)`相同值的指令`x`，那么我想忽略第二个（即`Sync`对于任何给定的值，我应该只有一个待处理指令`x`）

有没有办法强制一个演员是单线程的？有什么方法可以访问演员的邮箱并删除任何重复的事件？我不能避免实现`CacheActor`as, um, *not an Actor*吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T11:39:15.047

一个actor被保证一次只在一个线程上执行，并且actor邮箱中的消息是FIFO顺序的，所以#1就在那里。

2 比较棘手，因为它没有内置支持。演员有一个属性叫做“邮箱”。您可以直接访问邮箱，而不是通过接收或反应。您所要做的就是在处理完消息之前将匹配的同步消息从邮箱中拉出。执行此操作时，您必须在参与者上进行同步，以防止另一个线程在消息发送期间尝试将内容添加到邮箱。

应该注意的是，在actor上进行同步消除了库提供的死锁自由保证，并且会降低可伸缩性。但从实际的角度来看，你可能会没事的。

# c++ - 双字符串转换和语言环境

> ID：1005663
> 
> 赞同：7
> 
> 时间：2009-06-17T07:53:13.660
> 
> 标签：c++, decimal, locale, decimal-point

一个常见的国际问题是字符串中表示的双精度值的转换。这种东西在很多地方都可以找到。

从 csv 文件开始，这些文件要么被称为

```
comma separated 
```

或者

```
character separated 
```

因为有时它们的存储方式像

```
1.2,3.4
5.6,6.4 
```

在英国地区或

```
1,2;3,4
5,6;6,4 
```

例如在德国地区。

从这个背景来看，有必要知道大多数 std:: 方法都依赖于语言环境。因此，在德国，他们会将“1,2”读为 1.2 并将其写回为“1,2”，但对于英语操作系统，它将“1,2”读为 1 并将其写回为“1”。

因为语言环境是应用程序的全局状态，所以将其切换到不同的设置不是一个好主意；当我必须在英语机器上读取德语 CSV 文件时，我们遇到了一些问题，反之亦然。

编写在所有机器上行为相同的代码也很困难。C++ 流允许对每个流进行区域设置。

```
class Punctation : public numpunct<wchar_t>
{
public:

  typedef wchar_t char_type;
  typedef std::wstring string_type;

  explicit Punctation(const wchar_t& decimalPoint, std::size_t r = 0) : 
    decimalPoint_(decimalPoint), numpunct<wchar_t>(r)
  {
  }

  Punctation(const Punctation& rhs) : 
    decimalPoint_(rhs.decimalPoint_) 
  {
  }

protected:

  virtual ~Punctation() 
  {
  };

  virtual wchar_t do_decimal_point() const 
  { 
    return decimalPoint_; 
  }

private:

  Punctation& operator=(const Punctation& rhs);

  const wchar_t decimalPoint_;
};

...

std::locale newloc(std::locale::classic(), new Punctation(L','));
stream.imbue(newloc); 
```

将允许您使用 std::C 行为初始化流并且仅替换小数点。这使我能够忽略千位分隔符，这也可能会受到影响。德语 1000.12 可能变成“1.000,12”；或英文“1,000.12”最终会完全混乱。甚至将“，”替换为“。” 在这种情况下无济于事。

如果我必须`atof`和朋友一起工作，我可以使用

```
const char decimal_point = *(localeconv()->decimal_point); 
```

拉皮条我的行为。

所以有大量的东西只是为了国际双重行为。甚至我的 Visual Studio 也遇到了问题，因为德语版本想要将 8,0 作为版本写入 vcproj 文件，而英语版本想要将其更改为 8.0，这肯定是偶然发生的，因为在 XML 中它被定义为 8.0世界各国。

所以我只是想稍微描述一下这个问题，以询问我可能忽略的方面。我知道的事情：

*   十进制品脱取决于语言环境
*   千位分隔符取决于语言环境
*   指数取决于语言环境

* * *

```
//                  German       English     Also known
// decimal point       ,            .            
// exponent            e/E          e/E          d/D
// thousand sep        .            , 
```

哪个国家使用哪个设置？也许你可以给我添加一些我现在还没有的有趣的例子。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T08:39:55.470

永远不要使用 atof(s)。这是 strtod( s, 0 ) 没有错误报告的快速而肮脏的快捷方式。（同样适用于 atoi() 和 strtol()。）

*如果一个函数被宣传为在遇到困难时返回一个错误代码，你应该检查那个代码，是的，即使检查是你的代码大小的三倍，并且会让你打字的手指感到疼痛，因为如果你认为它不能发生在我身上”，诸神必定会因你的傲慢而惩罚你。*

（Henry Spencer，“C 程序员的十诫”，诫命 #6）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-06-17T08:32:10.760

我认为您正在寻找[*The C++ Programming Language*](http://www.stroustrup.com/3rd_loc.pdf)[的附录](http://www.stroustrup.com/3rd_loc.pdf)*D。您可能对在一个程序中可以同时使用多个语言环境感兴趣。*

# python - 我可以跟踪在 python 脚本中执行的所有函数/方法吗？

> ID：1005665
> 
> 赞同：9
> 
> 时间：2009-06-17T07:53:23.257
> 
> 标签：python, debugging, trace

有没有办法以编程方式跟踪所有 python 函数/方法的执行？我想看看他们每个人都用什么参数来调用。我真的是说所有，我对跟踪装饰器不感兴趣。

在 Ruby 中，我可以为我想要的方法设置别名并在那里添加额外的行为。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-17T08:03:05.357

看看[跟踪](http://docs.python.org/library/trace.html)模块。

您也可以通过命令行使用它：

```
python -m trace --help 
```

# visual-studio - Visual Studio 2005/2008 IDE（在解决方案资源管理器中自动选择文件）

> ID：1005668
> 
> 赞同：10
> 
> 时间：2009-06-17T07:54:35.157
> 
> 标签：visual-studio

我有一些非常大的解决方案（很多项目，很多文件）。我想知道当从打开的文档中选择一个文档（通过选项卡导航）时，是否有可能在解决方案资源管理器树视图中选择当前文件。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-17T07:56:27.930

你去：[博客](http://blogs.msdn.com/jannemattila/archive/2009/02/21/visual-studio-2008-track-active-item-in-solution-explorer.aspx)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-05-10T10:14:21.653

工具 → 选项 → 项目和解决方案 → 在解决方案资源管理器中跟踪活动项目

# wpf - 为什么 DockPanel.Dock="Bottom" 将元素放在顶部？

> ID：1005670
> 
> 赞同：15
> 
> 时间：2009-06-17T07:55:25.390
> 
> 标签：wpf, xaml, dockpanel

以下代码将两个文本元素放在顶部，即使第二个被标记为“底部”。背景颜色一直到底部，因此 DockPanel 似乎延伸到底部。

我对 DockPanel 有什么不了解的地方？

```
<Window x:Class="TestIndexer934.Views.MainView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:c="clr-namespace:TestIndexer934.Commands"
    Title="Main Window" Height="400" Width="800">
    <DockPanel HorizontalAlignment="Left" Background="Beige">
        <TextBlock DockPanel.Dock="Top" Text="Testing top"/>
        <TextBlock DockPanel.Dock="Bottom" Text="Testing bottom"/>
    </DockPanel>
</Window> 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-06-17T08:02:46.310

默认[情况下](http://msdn.microsoft.com/en-us/library/system.windows.controls.dockpanel.aspx)，DockPanel 的最后一项将填充剩余的可用内容区域。

如果您`LastChildFill="False"`在 DockPanel 上进行设置，您将看到您所期望的行为。您也可以`VerticalAlignment="Bottom"`在 TextBlock 上进行设置。

# .net - 可以从 .NET 使用的数学包

> ID：1005671
> 
> 赞同：2
> 
> 时间：2009-06-17T07:55:52.923
> 
> 标签：.net, mathematical-packages

哪些是可以从 C# 中使用的数学包？我知道 Lutz Roeder 的 Mappack 包，你知道类似的包吗？我主要对数值分析感兴趣：数值积分，线性和非线性方程求解。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T08:41:26.793

一些免费图书馆：

*   Meta.Numerics ( [www.meta-numerics.net](http://www.meta-numerics.net) , [metanumerics.codeplex.com](http://metanumerics.codeplex.com) )
*   Math.NET ( [numerics.mathdotnet.com](http://numerics.mathdotnet.com) )
*   dnAnalytics ( [dnanalytics.codeplex.com](http://dnanalytics.codeplex.com) )
*   ILNumerics.NET ( [ilnumerics.net](http://ilnumerics.net) )

专有图书馆：

*   极限优化 ( [www.extremeoptimization.com](http://www.extremeoptimization.com) )

我是 Meta.Numerics 库的架构师。它通过用于数值集成、求根和最小化/最大化的 API 满足您的主要兴趣。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-07T14:54:00.610

不完全是一个库，而是一个在处理大数时有用的类：[BigInteger](http://www.codeproject.com/KB/cs/biginteger.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T08:09:34.423

看看铱星包：

[铱包](http://iridium.mathdotnet.com/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T08:20:12.983

[NAG](http://www.nag.co.uk/numeric/DT/DTdescription.asp)也有一个库，目前处于测试阶段。

# php - 构建magento模块

> ID：1005673
> 
> 赞同：5
> 
> 时间：2009-06-17T07:57:00.847
> 
> 标签：php, magento, module

我正要开始构建我的第一个 magento 模块，但我找不到任何关于核心中本地文件夹和社区文件夹之间区别的文献。我注意到有些人在本地构建他们的模块，而另一些人在社区构建他们的模块，有什么区别，我为什么要使用其中一个？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-17T15:42:37.537

你会想在本地发展。社区文件夹是/原本是您放置从 Magento 市场下载或购买的模块的地方。据我了解，此文件夹的使用正在逐步淘汰，瓦里安建议将所有模块放置在本地文件夹中，即使是从市场下载的模块也是如此。

从系统的角度来看，唯一的区别是在核心文件夹之后搜索社区文件夹，但在本地文件夹之前。在 app/Mage.php 中检查此路径设置

```
$paths[] = BP . DS . 'app' . DS . 'code' . DS . 'local';
$paths[] = BP . DS . 'app' . DS . 'code' . DS . 'community';
$paths[] = BP . DS . 'app' . DS . 'code' . DS . 'core';
$paths[] = BP . DS . 'lib';

$app_path = implode(PS, $paths);

set_include_path($app_path . PS . Mage::registry('original_include_path')); 
```

所以，如果你有两个文件

```
app/code/community/Companyname/Models/Foo.php
app/code/local/Companyname/Models/Foo.php 
```

Magento 将首先使用社区文件夹中的那个。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-04-13T15:44:15.750

`community`如果您的模块计划向公众发布，您应该使用，以允许其他 Magento 开发人员也可以在他们自己的 Magento 项目中使用您的模块。

这就是 Varien 所说的[Magento Extension](http://www.magentocommerce.com/magento-connect)。

`local`如果您不想向公众分发，而是主要为特定商店（或者可能是您的个人用途）开发模块，则应该使用。

`local`为了更好地理解和文件夹之间的区别，`community`了解 Magento Autoloader 的工作原理会有所帮助：

当 a`class`即将在 Magento 中实例化时，Autoloader 将按照 PHPs 给出的顺序搜索匹配的类[`include_path`](http://www.php.net/manual/en/function.set-include-path.php)。

Magento 最初`include_path`在`app/Mage.php`启动时设置：

```
:

define('DS', DIRECTORY_SEPARATOR);
define('PS', PATH_SEPARATOR);
define('BP', dirname(dirname(__FILE__)));

Mage::register('original_include_path', get_include_path());

:

$paths[] = BP . DS . 'app' . DS . 'code' . DS . 'local';
$paths[] = BP . DS . 'app' . DS . 'code' . DS . 'community';
$paths[] = BP . DS . 'app' . DS . 'code' . DS . 'core';
$paths[] = BP . DS . 'lib';

$app_path = implode(PS, $paths);
set_include_path($app_path . PS . Mage::registry('original_include_path'));

: 
```

Magento Autoloader按照它们出现的**相同**`include_path`顺序搜索路径：

```
1st /app/code/local/
2nd /app/code/community/
3rd /app/code/core/
4th /lib/
: 
```

假设您正在尝试实例化一个名为`Namespace_Module_Block_Hello`example 的类，这将导致 Magentos Autoloader 搜索`include_path`名为`Namespace/Module/Block/Hello.php`* 的文件的路径：

```
1st /app/code/local/Namespace/Module/Block/Hello.php
2nd /app/code/community/Namespace/Module/Block/Hello.php
3rd /app/code/core/Namespace/Module/Block/Hello.php
4th /lib/Namespace/Module/Block/Hello.php
: 
```

找到的**第一个**文件将获胜，即被实例化。因此，如果在`local`AND`community`中存在相同的文件，例如，该文件`local`将被实例化。

这允许开发人员自由扩展/覆盖/重载/忽略类。

* * *

*[名称转换规则][见`lib/Varien/Autoload.php::autoload()`]

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T08:56:00.680

本地文件夹用于存放只有您将使用的模块。community 文件夹用于存放最终将被打包并提供（或出售）给 magento 社区的模块。您下载和安装的任何模块都放在社区文件夹中。Magento 并不真正关心你的模块在哪里，区别主要是为了保持模块的组织性。无论如何，因为从一个切换到另一个很容易，所以它不应该真正打扰你。

如果您不知道您的模块属于哪个类别，您可以从本地文件夹开始，如果要发布，您可以稍后将其移动到社区文件夹。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-28T13:09:06.477

该模块有两种类型的分类。

1.  社区和商业 社区 - 免费为社区 商业 - 为社区付费

2.  本地和核心核心 - 扩展是使用 magento 核心文件开发的。本地 - 扩展是通过将核心文件复制到本地来开发的。实际更改在本地完成

本地的更可取...

# url - URL 方案/主机/路径中的 `+` 是否代表空格？

> ID：1005676
> 
> 赞同：234
> 
> 时间：2009-06-17T07:57:51.920
> 
> 标签：url, encoding, query-string

我知道`+`URL 的查询字符串中的 a 代表一个空格。这也是查询字符串区域之外的情况吗？也就是说，做如下网址：

```
http://a.com/a+b/c 
```

实际代表：

```
http://a.com/a b/c 
```

（因此如果它实际上应该是 a ，则需要对其进行编码`+`），或者它实际上是否代表`a+b/c`？

* * *

## 回答 #1

> 赞同：239
> 
> 时间：2009-06-17T08:06:17.567

[您可以在W3Schools](http://www.w3schools.com/tags/ref_urlencode.asp)上找到一个很好的相应 URL 编码字符列表。

*   `+`变成`%2B`
*   空间变成`%20`

* * *

## 回答 #2

> 赞同：177
> 
> 时间：2009-06-17T09:43:49.040

*   URL 的路径部分中的百分比编码预计会被解码，但是
*   路径组件中的任何`+`字符都应按字面意思处理。

明确地说：`+`只是查询组件中的一个特殊字符。

[https://www.rfc-editor.org/rfc/rfc3986](https://www.rfc-editor.org/rfc/rfc3986)

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2016-10-27T19:00:28.497

空格字符只能在一种情况下编码为“+”：`application/x-www-form-urlencoded`键值对。

RFC-1866（HTML 2.0 规范）第 8.2.1 段第 1 小段说：“表单字段名称和值被转义：空格字符被替换为“+”，然后保留字符被转义”）。

这是 URL 中此类字符串的示例，其中 RFC-1866 允许将空格编码为加号：“http://example.com/over/there?name=foo+bar”。因此，只有在“？”之后，才能用加号替换空格（在其他情况下，空格应编码为“％20”）。这种对表单数据进行编码的方式在后面的HTML规范中也有给出，例如在HTML 4.01规范中寻找相关的段落`application/x-www-form-urlencoded`，等等。

但是，因为很难始终正确地确定上下文，所以最好的做法是永远不要将空格编码为“+”。最好对除 RFC-3986, p.2.3 中定义的“未保留”之外的所有字符进行百分比编码。这是一个代码示例，说明了应该编码的内容。它是用 Delphi (pascal) 编程语言给出的，但是对于任何程序员来说，它是如何工作的很容易理解，无论所拥有的语言如何：

```
(* percent-encode all unreserved characters as defined in RFC-3986, p.2.3 *)
function UrlEncodeRfcA(const S: AnsiString): AnsiString;
const    
  HexCharArrA: array [0..15] of AnsiChar = '0123456789ABCDEF';
var
  I: Integer;
  c: AnsiChar;
begin
 // percent-encoding, see RFC-3986, p. 2.1
  Result := S;
  for I := Length(S) downto 1 do
  begin
    c := S[I];
    case c of
      'A' .. 'Z', 'a' .. 'z', // alpha
      '0' .. '9',             // digit
      '-', '.', '_', '~':;    // rest of unreserved characters as defined in the RFC-3986, p.2.3
      else
        begin
          Result[I] := '%';
          Insert('00', Result, I + 1);
          Result[I + 1] := HexCharArrA[(Byte(C) shr 4) and $F)];
          Result[I + 2] := HexCharArrA[Byte(C) and $F];
        end;
    end;
  end;
end;

function UrlEncodeRfcW(const S: UnicodeString): AnsiString;
begin
  Result := UrlEncodeRfcA(Utf8Encode(S));
end; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-16T06:23:48.740

使用 encodeURIComponent 函数来修复 url，它适用于 Browser 和 node.js

```
res.redirect("/signin?email="+encodeURIComponent("aaa+bbb-ccc@example.com"));

> encodeURIComponent("http://a.com/a+b/c")
'http%3A%2F%2Fa.com%2Fa%2Bb%2Fc' 
```

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2014-01-23T22:50:48.287

试试下面：

```
<script type="text/javascript">

function resetPassword() {
   url: "submitForgotPassword.html?email="+fixEscape(Stringwith+char);
}
function fixEscape(str)
{
    return escape(str).replace( "+", "%2B" );
}
</script> 
```

* * *

## 回答 #6

> 赞同：-5
> 
> 时间：2009-06-17T08:00:58.967

您应始终对 URL 进行编码。

以下是 Ruby 对 URL 的编码方式：

```
irb(main):008:0> CGI.escape "a.com/a+b"
=> "a.com%2Fa%2Bb" 
```

# screenshot - 如何在全屏模式下拍摄命令提示符窗口的快照

> ID：1005678
> 
> 赞同：2
> 
> 时间：2009-06-17T07:58:39.313
> 
> 标签：screenshot, fullscreen, cmd, printscreen

如果命令提示符窗口以全屏模式运行，我需要拍摄快照。

我曾使用 PrintScreen、Ctrl+PrintScreen、Ctrl+Alt+PrintScreen 按钮尝试过，但似乎没有任何效果

还有什么原因导致打印屏幕按钮在全屏命令提示符模式下不起作用？毕竟，它适用于正常条件下的所有窗口。

阿卜杜勒哈利克

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T09:19:47.903

在全屏模式下，您所拥有的只是文本。没有这样的图形“渲染”。如果您可以捕获文本，那就足够了……尽管您以后总是可以从文本中重建 png 图像（如果您真的必须从中获取图像）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T09:00:02.763

为什么不直接使用外部屏幕截图软件？

有很多，例如[greenshot](http://greenshot.sourceforge.net/)，它是免费的（在演讲和啤酒中:-)）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T08:07:49.497

你试过alt +打印屏幕吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T08:51:47.863

单击命令窗口以外的任何窗口，然后单击 PrtScrn。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-30T08:03:27.047

首先以全屏模式打开所有cmd，然后在打开画笔后单击打印屏幕按钮，然后按`ctrl`+ `v`（过去），您可以将其保存在任何地方，无论何时何地（文件类型应为.png）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-04-26T20:08:27.087

我无法找到任何有效的回复，也无法安装未经批准的软件来执行 IT 策略。这是我所做的：

在命令窗口内右键单击。点击全选。右键单击窗口外（在靠近最大化最小化控件的顶部栏上。选择编辑；选择复制。打开记事本窗口并粘贴。这里的优点是您可以稍后将文本复制并粘贴回命令窗口。我希望这可以帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-01-22T19:47:13.507

1.  按`ctrl`+ `a` //全选
2.  按`ctrl`+ `c` // 复制所有文本
3.  写记事本 mytext.txt + 按 entet // 打开记事本
4.  按`ctrl`+ `v` //在记事本中粘贴文本
5.  按`ctrl`+ `s` // 保存文件
6.  按`ctrl`+ `w` // 关闭记事本。

# java - SELinux 和 Java

> ID：1005683
> 
> 赞同：4
> 
> 时间：2009-06-17T08:00:23.617
> 
> 标签：java, selinux

是否有使用 SELinux 处理 Java 应用程序的最佳实践？是否能够为每个 Java 应用程序配置 SELinux，还是只能处理 VM，因为它会进行最后的系统调用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T23:33:47.677

如果您问 Java 和 SELinux 是否可以工作，这取决于策略是如何定义的。您将主要关心 java 进程在哪个域中运行，它如何到达该域以及该域被允许做什么。

域只是一个 SELinux 上下文，用于查看进程正在运行的上下文/域，请尝试使用 ps 的 -Z 选项（即 ps -Z）。同样，要查看文件的上下文，请尝试 ls 的 -Z 选项（即 ls -Z）

您可能有兴趣查看 SELinux 策略源或使用诸如 sesearch 或 apol（来自 setools）之类的分析工具来查看允许哪些策略以及 java 如何进入特定域。

从那里你会关心修复/编写策略，这可能是一个涉及的过程，但是已经编写了工具，例如 SLIDE（eclipse 插件）、seedit（尽管我没有这方面的经验）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T19:56:42.590

您可以拥有任意数量的 JVM 和任意数量的 JVM 版本。如果您愿意，您可以独立配置它们。

我建议将 JVM 的数量保持在您拥有的内核数量左右或更少。如果您开始拥有数百个 JVM，则可能难以管理和配置。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-10-27T13:18:21.717

您需要担心的不仅仅是可执行文件，还有它涉及的所有文件。这是 SElinux 背后的真正力量。我反对关闭这个有价值的工具。我从 Redhat 的 Dan Walsh 那里看出，unconfined_u 将会消失。好吧，这意味着您必须重新对齐数据文件，包括主目录中 .eclipse 中的数据文件。我已将我的主要登录减少到 staff_u，在那里我具有 sudo 访问权限，但已将 fcontext 更改为 /HOME_DIR/.eclipse(/.*)+ 到 staff_java_t

# c++ - C++ 静态初始化顺序

> ID：1005685
> 
> 赞同：75
> 
> 时间：2009-06-17T08:00:35.893
> 
> 标签：c++, static-variables, static-order-fiasco, initialization-order

当我在 C++ 中使用静态变量时，我经常想要初始化一个变量，然后将另一个变量传递给它的构造函数。换句话说，我想创建相互依赖的静态实例。

在单个 .cpp 或 .h 文件中，这不是问题：实例将按照它们声明的顺序创建。但是，当您想用另一个编译单元中的实例初始化静态实例时，似乎无法指定顺序。结果是，根据天气情况，可能会构建依赖于另一个实例的实例，然后才构建另一个实例。结果是第一个实例初始化不正确。

有谁知道如何确保以正确的顺序创建静态对象？我已经搜索了很长时间的解决方案，尝试了所有解决方案（包括 Schwarz Counter 解决方案），但我开始怀疑是否有一个真正有效的解决方案。

一种可能性是使用静态函数成员的技巧：

```
Type& globalObject()
{
    static Type theOneAndOnlyInstance;
    return theOneAndOnlyInstance;
} 
```

确实，这确实有效。遗憾的是，您必须编写 globalObject().MemberFunction()，而不是 globalObject.MemberFunction()，导致客户端代码有些混乱和不雅。

**更新：**感谢您的反应。遗憾的是，似乎我确实已经回答了我自己的问题。我想我得学会忍受它...

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2009-06-17T08:09:05.517

你已经回答了你自己的问题。静态初始化顺序是未定义的，最优雅的解决方法（同时仍然进行静态初始化，即不完全重构它）是将初始化包装在一个函数中。

从[https://isocpp.org/wiki/faq/ctors#static-init-order开始阅读 C++ FAQ 项目](https://isocpp.org/wiki/faq/ctors#static-init-order)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-17T08:12:04.153

也许您应该重新考虑是否需要这么多全局静态变量。虽然它们有时很有用，但将它们重构到更小的本地范围通常要简单得多，尤其是当您发现某些静态变量依赖于其他变量时。

但是你是对的，没有办法确保初始化的特定顺序，所以如果你已经下定决心，像你提到的那样，将初始化保持在一个函数中，可能是最简单的方法。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-17T10:12:07.953

> 确实，这确实有效。遗憾的是，您必须编写 globalObject().MemberFunction()，而不是 globalObject.MemberFunction()，导致客户端代码有些混乱和不雅。

但最重要的是它有效，并且它是失败证明，即。绕过正确的用法并不容易。

程序的正确性应该是您的首要任务。此外，恕我直言，上面的 () 纯粹是文体 - 即。完全不重要。

根据您的平台，请注意过多的动态初始化。动态初始化程序可以进行相对少量的清理（参见[此处](http://www.cplusplus.com/reference/clibrary/cstdlib/atexit/)）。您可以使用包含不同全局对象成员的全局对象容器来解决此问题。因此，您有：

```
Globals & getGlobals ()
{
  static Globals cache;
  return cache;
} 
```

为了清理程序中的所有全局对象，只有一次调用 ~Globals()。为了访问全局，你仍然有类似的东西：

```
getGlobals().configuration.memberFunction (); 
```

如果你真的想要，你可以将它包装在一个宏中，以节省使用宏的一点点输入：

```
#define GLOBAL(X) getGlobals().#X
GLOBAL(object).memberFunction (); 
```

虽然，这只是您最初解决方案的语法糖。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-26T14:42:37.417

大多数编译器（链接器）实际上确实支持指定顺序的（不可移植的）方式。例如，使用 Visual Studio，您可以使用[init_seg](http://msdn.microsoft.com/en-us/library/7977wcck(VS.80).aspx) pragma 将初始化安排到几个不同的组中。AFAIK 无法保证每个组内的顺序。由于这是不可移植的，您可能需要考虑是否可以将您的设计修复为不需要它，但选项就在那里。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-08-12T10:29:29.923

尽管这个线程的年龄，我想提出我找到的解决方案。正如我之前很多人指出的那样，C++ 没有提供任何静态初始化排序机制。我建议将每个静态成员封装在类的静态方法中，该方法依次初始化成员并以面向对象的方式提供访问。让我举个例子，假设我们要定义名为“Math”的类，它在其他成员中包含“PI”：

```
class Math {
public:
   static const float Pi() {
       static const float s_PI = 3.14f;
       return s_PI;
   }
} 
```

s_PI 将在第一次调用 Pi() 方法时初始化（在 GCC 中）。请注意：具有静态存储的本地对象具有依赖于实现的生命周期，有关详细信息，请查看[2](http://www.kouzdra.ru/page/docs/isocpp/stmt.html)中的 6.7.4 。

[静态关键字](http://msdn.microsoft.com/en-us/library/s1sb61xd.aspx)，[C++标准](http://www.kouzdra.ru/page/docs/isocpp/stmt.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-01-29T16:45:07.177

将静态包装在方法中将解决顺序问题，但正如其他人所指出的那样，它不是线程安全的，但如果这是一个问题，您也可以这样做以使其成为线程。

```
// File scope static pointer is thread safe and is initialized first.
static Type * theOneAndOnlyInstance = 0;

Type& globalObject()
{
    if(theOneAndOnlyInstance == 0)
    {
         // Put mutex lock here for thread safety
         theOneAndOnlyInstance = new Type();
    }

    return *theOneAndOnlyInstance;
} 
```

# iphone - iPhone 应用中的表格查询

> ID：1005691
> 
> 赞同：2
> 
> 时间：2009-06-17T08:03:10.973
> 
> 标签：iphone, sqlite, internationalization, diacritics

我有一个表格视图（链接到数据库）和一个搜索栏。当我在搜索栏中输入内容时，我会在数据库中快速搜索并在输入时显示结果。

查询如下所示：

```
SELECT * FROM MyTable WHERE name LIKE '%NAME%' 
```

只要我只使用 ASCII 字符，一切正常。我想要的是输入 ASCII 字符并将它们的等价物与变音符号匹配。例如，如果我输入“Alizee”，我希望它匹配“Alizee”。

有没有办法使查询语言环境不敏感？我对 SQL 中的 COLLATE 选项感到不满，但 SQLite 似乎没有用。我也对 iPhone SDK 3.0 具有“本地化排序规则”感到不满，但我找不到任何有关这意味着什么的文档。 .

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-12-15T22:04:24.420

有几个选项可以解决这个问题：

1.  在执行之前替换查询中的所有重音字符，例如

    > "Psychédélices" => "Psychedelices"
    > "À contre-courant" => "A contre-courant"
    > "Tempête" => "Tempete"
    > 等等。

    但这仅适用于输入，因此您不能在数据库本身中有重音字符。简单的解决方案，但远非完美。

2.  使用第 3 方库，即 ICU（以下链接）。不确定它是否是 iPhone 的最佳选择。

3.  编写一个或多个自定义 C 函数来进行比较。更多在下面的链接中。

StackOverflow 上的一些帖子讨论了各种选项：
[How to sort text in sqlite3 with specified locale?](https://stackoverflow.com/questions/611459/how-to-sort-text-in-sqlite3-with-specified-locale)
[SQLite 的不区分大小写的 UTF-8 字符串排序规则（C/C++）](https://stackoverflow.com/questions/181037/case-insensitive-utf-8-string-collation-for-sqlite-c-c)
[如何在 Sqlite 中实现不区分重音/变音符号的搜索？](https://stackoverflow.com/questions/779853/how-to-implement-the-accent-diacritic-insensitive-search-in-sqlite)

还有几个外部链接：
[C/C++](http://ioannis.mpsounds.net/blog/2007/12/19/sqlite-native-unicode-like-support/)
[sqlite case 和重音不敏感搜索中的 SQLite 和原生 UNICODE LIKE 支持](http://www.mail-archive.com/sqlite-users@sqlite.org/msg42923.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T12:49:45.263

我不确定 SQL，但我认为您绝对可以使用`NSDiacriticInsensitivePredicateOption`来比较内存中的 NSString。

一个示例是一个 NSArray，其中包含您正在搜索的字符串。您可以使用作为比较选项来迭代比较字符串的数组`NSDiacriticInsensitivePredicateOption`并显示成功的匹配项。

# c# - 从 .net 调用存储过程

> ID：1005694
> 
> 赞同：2
> 
> 时间：2009-06-17T08:04:10.520
> 
> 标签：c#, .net, sql-server, sql-server-2005, ado.net

我有一个这样的存储过程：

```
CREATE PROCEDURE up_action
(@id int
,@group varchar(30)=''
,@nom varchar(30)=''
,@compte varchar(30)=NULL
)
 AS
BEGIN
DECLARE @chrono int
......
select @date=date from users where compte=@compte
INSERT INTO dialog
(numappel,auteur,commentaire,etape,etapews,operant)
VALUES
(@numappel,@nomprenom,@dialogue,14,14,@nomoperateur)
SET @chrono = SCOPE_IDENTITY()      
select 'chrono'=@chrono
END 
```

我想从用 C# 编写的应用程序调用此存储过程，并可以提供由 , 分隔的参数（实际上是它们的值），然后最终接收一个记录集 rs，我可以从中获取变量的值，如 rs （“计时”）。

我知道创建每个参数并告诉类型、名称、值等的可能性。但我想要一个像 ASP 中这样的方法，因为我有 100 个参数的程序......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T08:18:09.617

通常，使用 POADO (Plain Old ADO.Net) 你会做这样的事情：

```
using (SqlConnection conn = new SqlConnection(myConnectionString))
using (SqlCommand cmd = conn.CreateCommand())
{
    cmd.CommandType = CommandType.StoredProcedure;
    cmd.CommandText = "up_action"
    cmd.Parameters.AddWithValue("@group", group);
    cmd.Parameters.AddWithValue("@nom", nom);
    cmd.Parameters.AddWithValue("@compte", compte);
    conn.Open();
    using (SqlDataReader rd = cmd.ExecuteReader())
    {
        if (rd.Read())
        {
            chrono = rs["chrono"];
        }
    }
} 
```

但正如理查德指出的那样：您确实最好研究一下 LINQ to SQL 之类的东西，因为这将为每个存储过程生成一个方法（它会自动为您的存储过程的每个参数提供一个参数）。有关更多信息，请参阅[此链接](http://msdn.microsoft.com/en-us/library/bb399357.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T08:06:59.640

Erm 如果您想让任务更轻松，请查看 LINQ to SQL 之类的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T09:27:41.130

所以..解决方案是：

```
SqlCommand sqlCommand = new SqlCommand();
sqlCommand.CommandText = strQuery;
rdr = sqlCommand.ExecuteReader();
rdr.Read();
int chrono = Convert.ToInt32(rdr["chrono"]) 
```

对于 2 个参数

```
rdr.NextResult();
rdr.Read();
int str = Convert.ToInt32(rdr["str"]); 
```

谢谢大家的答案

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T08:27:38.257

您可能还想查看[Enterprise Libray](http://msdn.microsoft.com/en-us/library/cc467894.aspx)中的数据访问应用程序块，因为这为数据访问提供了遵循的良好模式。我还建议您再次查看您的 SP，看看您是否可以重构它们，100 个参数听起来相当多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T09:15:24.540

我想这是一个插入/更新过程... 100 个参数对我来说听起来太多了，但如果这是您需要的，那么您可能需要查看表值参数（仅限 SQL 2008）：

[http://msdn.microsoft.com/en-us/library/bb675163.aspx](http://msdn.microsoft.com/en-us/library/bb675163.aspx)

（不过，首先，我会接受上述建议，看看像 LINQ 这样的 ORM - 这将解决问题的繁重问题）

# javascript - 如何在 mootools 中同时执行多个动画？

> ID：1005698
> 
> 赞同：1
> 
> 时间：2009-06-17T08:06:06.973
> 
> 标签：javascript, animation, mootools

我有两个 div（例如，具有 ids 的 div：div1 和 div2），我需要使用 Fx.Tween 扩展其高度并且我希望动画是同时的。

'#div1' 的 style.height 将从 auto 更改为 0。 '#div2' 的 style.height 将从当前高度更改为由名为*calculateHeight()的函数计算的新高度*

我怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T08:29:50.483

Mootools 动画不会阻塞（JS 中的动画很少会阻塞！）所以简单地按顺序执行两个补间将产生所需的效果（与人类可以感知的一样接近）

```
function go()
{
    $('div1').tween('height', 0);
    $('div2').tween('height', calculateHeight());
}

function calculateHeight()
{
    return 0; //or whatever
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-02T15:36:27.280

我认为这与 wait:false 选项有关。我不是程序员，mootools 很容易，但并不那么擅长，但我记得读过一些文档，上面说你可以控制第二个动画是在第一个动画结束时立即工作还是同时工作。

链式方法：等待在链式事件之间注入暂停。句法

myClass.wait（持续时间）；

参数 1\. duration - (integer) 暂停链栈的持续时间（以毫秒为单位）；默认为 500。

我认为您应该链接变形并使其等待（0）。但我不确定。希望这可以帮助。

# php - PHP 发布文本字段并请求数据 - （我相信这也可能很简单）

> ID：1005707
> 
> 赞同：0
> 
> 时间：2009-06-17T08:08:19.917
> 
> 标签：php, forms, post

我不知道从哪里开始.. 我有 2 页。第一页是一个包含 4 个文本字段的表单，这些文本字段传递到第二页并用逗号分隔每个字段（仅当他们在字段中填写内容时 - 因此如果他们只填写一个字段，则不会有任何逗号）并结束有句号。

我如何在 PHP 中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T08:15:21.260

解释如何在 php 中发送表单的链接

[http://apptools.com/phptools/forms/forms1.php](http://apptools.com/phptools/forms/forms1.php)

如果您收到请求表单，您可以签入 php，根据此显示结果而不是表单 - （在同一 php 页面中）。

4 个字段可以是一个数组，用 [] 为元素命名

比如： text_array[0] ,text_array[1] , text_array[2] , text_array[3]

易于在阵列上运行

昏迷

```
join(',',$_POST['text_array']); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T08:18:23.783

您可以测试您的 4 个文本字段，下面的快速示例：

```
$str = '';
if( $_POST['first'] )
    $str = $_POST['first'];
if( $_POST['second'] )
    $str .= ($str != '' ? ',' : '') . $_POST['second'];
if( $_POST['third'] )
    $str .= ($str != '' ? ',' : '') . $_POST['third'];
if( $_POST['fourth'] )
    $str .= ($str != '' ? ',' : '') . $_POST['second'];
$str .= ($str != '' ? '.' : ''); 
```

或更简单：通过命名所有字段，使您的字段生成一个数组`my_text[]`，然后：

```
$str = '';
if( ! empty( $_POST['my_text'] ) && is_array( $_POST['my_text'] ) )
    $str = join( ',', $_POST['my_text'] ) . '.'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T08:19:31.657

我不确定你是否需要用逗号分隔参数，只要你考虑使用 php，它真的很简单，你可以在互联网上找到大量的教程。一般来说，你需要这样做：

```
<form action="second_page.php" method="get">
    <input type="text" name=text_field[]>
    <input type="text" name=text_field[]>
    <input type="text" name=text_field[]>
    .....
</form> 
```

然后在 second_page.php 中，您可以参考这些文本字段：

```
<?
  $fields = $_GET['text_field'];
?> 
```

# java - java中的filerering /替换单引号

> ID：1005722
> 
> 赞同：1
> 
> 时间：2009-06-17T08:12:51.623
> 
> 标签：java, jsp

如何在java中过滤单引号'？

我有一个搜索框，如果有人在其中输入单引号，我会收到数据库错误。

我不想在 JavaScript 或数据库级别对其进行归档；我只想用Java来做。我怎样才能做到这一点？

我不想完全失去它。还有其他方法吗？用 \' 替换引号会起作用吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T08:15:33.740

我认为您从错误的角度解决问题。我强烈怀疑你正在像这样构建你的 SQL：

```
String sql = "SELECT * FROM TABLE WHERE USERID='" + userInput + "'"; 
```

或类似的东西。不要那样做。请改用参数化查询，并将用户输入作为参数提供。我曾经使用过的每个数据库都知道如何处理它，这是处理用户输入的*安全*方式。

如果你*真的，真的*只是想摆脱引号，你可以使用：

```
text = text.replace("'", ""); 
```

...但请不要。请改用参数化查询。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T08:19:28.413

是的，使用 PreparedStatement.setString()：

```
String sql = "SELECT * FROM table WHERE USERID = ?";
PreparedStatement pstmt = connection.prepareStatement(sql);
pstmt.setString(1, "O'Connor");
ResultSet rs = pstmt.executeQuery(); 
```

数据库的转义规则不同。例如，在 Oracle 中，您可以复制撇号以将其转义。在 MySQL 中，它是反斜杠 + 撇号（我认为）。

所以要么`userInput = userInput.replaceAll("'", "''");`或`userInput = userInput.replaceAll("'", "\\'");`

# c# - 在 SQL Server 中保存浮点值

> ID：1005725
> 
> 赞同：7
> 
> 时间：2009-06-17T08:14:18.487
> 
> 标签：c#, sql, sql-server-2005, floating-point

我有一个简单的网络应用程序，并且想在 SQL 服务器中保存一些浮点或双精度格式。

但是有一个问题，当我尝试保存 123.66 时，在表中我看到 123.6600003662109 存储。

为什么我的浮点数在保存到数据库时会发生变化？我该如何解决这个错误？

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-17T08:19:04.827

您*实际上*并没有尝试保存 123.66，因为您不能将 123.66 完全表示为浮点数或双精度数。数据库保存数据比您习惯的更准确，仅此而已。

如果要准确保存*十进制*`decimal`数字，请使用类型。

有关更多信息，请参阅我关于[浮点二进制点](http://pobox.com/~skeet/csharp/floatingpoint.html)和[浮点小数点](http://pobox.com/~skeet/csharp/decimal.html)类型的文章。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T08:18:59.570

这不是数据库问题，而是[浮点数的一般问题](http://en.wikipedia.org/wiki/Floating_point#Accuracy_problems)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-06T11:02:52.097

我认为这是 VS 问题而不是 Sql 服务器，在这里我将字符串（“12.89”）中的金额传递给存储过程并找到数据保存准确 12.89

## 解决方案-

在属性和方法中将浮点数更改为字符串，过程

笔记

## 不要将列类型 Float 更改为表中的字符串

例子-

## 在您的财产中

```
Public Float Amount { get; set; } 
```

到

```
Public String Amount { get; set; } 
```

## 在你的方法中

```
Public boolAdd(String amount)

{

//Your Logic Like

bool status = false;

DbParam[] param = new DbParam[1];

param[0] = new DbParam("@amount", "", "amount", SqlDbType.VarChar);

status = Db.Update(ds, "sp_Add", "", "", param, true);

return status;

  } 
```

## 在您的程序中

## 注意-金额列是表中的浮点类型，不要更改为 sting

* * *

```
Create Proc sp_Add
(

@amount varchar(20)

)
as

begin

Insert into Price(amount) values (@amount)

end 
```

# asp.net - Asp.net时间输入控制建议

> ID：1005729
> 
> 赞同：3
> 
> 时间：2009-06-17T08:15:22.103
> 
> 标签：asp.net, time, input, controls

任何人都可以为 asp.net Web 应用程序推荐一个时间输入控件吗？

它应该能够处理以下项目

*   上午下午
*   24小时
*   客户端验证
*   客户端完成（如果您以 3 开始小时然后跳到分钟）
*   一个文本框（不是单独的文本框小时和分钟，或下拉）
*   能够实际输入时间，而不是简单地选择它
*   带时间分隔符“：”的提示文本

其他不错的功能

*   能够用箭头增加小时或分钟
*   回发后无需重新接线

提前感谢您的帮助和建议！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T08:52:38.720

尝试使用此代码输入时间

```
 <asp:TextBox ID="txtStartTime" runat="server" Text='<%# Bind("StartTime", "{0:t}") %>'
                                        Width="60px"></asp:TextBox>
                                    <asp:Label ID="lblStartTimeEdit" runat="server" Text="Press 'A' or 'P' to switch AM/PM"></asp:Label>

                                    <cc1:MaskedEditExtender ID="meeStartTime" runat="server" AcceptAMPM="true" MaskType="Time"
                                        Mask="99:99" MessageValidatorTip="true" OnFocusCssClass="MaskedEditFocus" OnInvalidCssClass="MaskedEditError"
                                        ErrorTooltipEnabled="true" UserTimeFormat="None" TargetControlID="txtStartTime"
                                        InputDirection="LeftToRight" AcceptNegative="Left">
                                    </cc1:MaskedEditExtender>
                                    <cc1:MaskedEditValidator ID="mevStartTime" runat="server" ControlExtender="meeStartTime"
                                        ControlToValidate="txtStartTime" IsValidEmpty="False" EmptyValueMessage="Time is required "
                                        InvalidValueMessage="Time is invalid" Display="Dynamic" EmptyValueBlurredText="Time is required "
                                        InvalidValueBlurredMessage="Invalid Time" ValidationGroup="MKE" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T08:26:38.803

您是否考虑过查看 jquery 控件

*   [时间选择器](http://code.google.com/p/jquery-timepicker/)

或者只是在所有插件中进行[“时间”搜索。](http://plugins.jquery.com/?s=time)我只使用了日期选择器，但效果很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-24T12:49:54.547

只需访问链接：[http](http://www.obout.com/calendar/calendar_datetimepicker.aspx) ://www.obout.com/calendar/calendar_datetimepicker.aspx “

您的问题将在几秒钟内得到解决

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-28T14:58:18.270

您可以使用 Telerik RadTimePicker

# vb.net - 发布后构建失败

> ID：1005735
> 
> 赞同：0
> 
> 时间：2009-06-17T08:17:00.710
> 
> 标签：vb.net, cruisecontrol.net, web-deployment-project

我正在使用 Web 应用程序部署在 IIS 上发布。起初，我已将我的网站转换为 Web 应用程序。我的应用程序在我的 VS2005 上编译和构建良好。但是当我尝试通过 CC.net 运行它时。它出现了 100 个错误。以下是在同一文件中不断重复的一些错误的列表。

```
errorBC30284: function 'GetCannotChangeMessage' cannot be declared 'Overrides' because it does not override a function in a base class.
errorBC30451: Name 'GetAndChangesCanBePerformed' is not declared.
errorBC30456: 'GetStatusMessage' is not a member of 'Object'. 
```

任何人请让我知道为什么我的构建因这些错误而失败。因为函数在基类中是可重写的，并且声明的名称也是如此

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T08:35:55.930

您是否尝试将其作为网站（而不是应用程序）上传到您的主机？我总是只上传没有任何构建的网站，它运行良好。

# sql - 在存储过程中如何在哪里设置变量？

> ID：1005748
> 
> 赞同：0
> 
> 时间：2009-06-17T08:18:56.200
> 
> 标签：sql, sql-server

```
CREATE PROCEDURE[BoardID]

 @sParent varchar(8000)

AS

Select Boardid,PONO,ImageStatus
from BoardDetail

Where 
    Boardid=1 and @sParent 
```

为什么@sParent 创建错误如何在哪里使用这个变量......我想提供字符串作为参数，它将被设置在哪里......就像**@sParent**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T08:35:54.683

听起来你真正想要的是创建一个动态 sql 语句，如果这是你想要的，那么试试这个：

```
Create Procedure [BoardID]
    @sParent varchar(8000)
AS

Declare @SQL VarChar(8500)

SELECT @SQL = 'Select Boardid,PONO,ImageStatus from BoardDetail Where 
    Boardid=1 and ' 
SELECT @SQL = @SQL + @sParent 

Exec ( @SQL)

GO 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T08:30:06.003

您需要在 WHERE 子句中为 @sParent 参数设置一个字段：

...

其中 Boardid = 1 和 [fieldNameThatIsMatchingSParent] = @sParent

...

或类似的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T08:38:32.243

如果您想将 where 子句传递到您的 sp 中，请尝试以下操作：

```
CREATE PROCEDURE[BoardID]

 @sParent varchar(8000)

AS

DECLARE @sql ntext

SET @sql = 'Select Boardid,PONO,ImageStatus from BoardDetail Where Boardid=1'

IF (@sParent <> '')
BEGIN
    SET @sql = @sql + ' and ' + @sParent
END

EXEC @sql 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T08:32:10.900

```
WHERE 
    ((@Boardid is null and 1=1) 
    OR 
    (@Boardid is not null and @Boardid = SomeTbl.Boardid)) 
```

这个 WHERE 子句允许我们有一个可选的 SQL 参数，而不必求助于动态构造的 SQL。希望有帮助！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T08:32:37.013

您可以通过 2 种方式在 where 中使用 @sParent（取决于您的需要）

```
where [FieldName] = @sParent 
```

或者

```
where [FieldName] Like @sParent 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T08:33:07.077

```
CREATE PROCEDURE[BoardID]
 @sParent VARCHAR(8000)
AS

SELECT Boardid, PONO, ImageStatus
FROM BoardDetail
WHERE 
     Boardid = 1 
AND  ('0' != @sParent AND [ColumnName] LIKE @sParent) 
```

# sql - 在递归 SQL 表中查找最低公共父级

> ID：1005761
> 
> 赞同：3
> 
> 时间：2009-06-17T08:22:25.600
> 
> 标签：sql, sql-server, tsql, recursion, common-table-expression

假设我有一个递归表（例如，有经理的员工）和一个`0..n`ID 大小的列表。如何找到这些 id 的最低共同父级？

例如，如果我的表如下所示：

```
Id | ParentId
---|---------
 1 |     NULL
 2 |        1
 3 |        1
 4 |        2
 5 |        2
 6 |        3
 7 |        3
 8 |        7 
```

那么下面这组 id 会导致下面的结果（第一个是极端情况）：

```
[]      => 1 (or NULL, doesn't really matter)
[1]     => 1
[2]     => 2
[1,8]   => 1
[4,5]   => 2
[4,6]   => 1
[6,7,8] => 3 
```

这该怎么做？

编辑：请注意，在所有情况下，父母都不是正确的术语。它是树上所有路径中最低的公共节点。最低的公共节点也可以是节点本身（例如，在这种情况下`[1,8] => 1`，节点`1`不是节点的父节点`1`而是节点`1`本身）。

亲切的问候，罗纳德

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T09:11:25.827

这是一种方法；它使用递归 CTE 来查找节点的祖先，并在输入值上使用“CROSS APPLY”来获取共同祖先；您只需更改`@ids`（表变量）中的值：

```
----------------------------------------- SETUP
CREATE TABLE MyData (
   Id int NOT NULL,
   ParentId int NULL)

INSERT MyData VALUES (1,NULL)
INSERT MyData VALUES (2,1)
INSERT MyData VALUES (3,1)
INSERT MyData VALUES (4,2)
INSERT MyData VALUES (5,2)
INSERT MyData VALUES (6,3)
INSERT MyData VALUES (7,3)
INSERT MyData VALUES (8,7)

GO
CREATE FUNCTION AncestorsUdf (@Id int)
RETURNS TABLE
AS
RETURN (
    WITH Ancestors (Id, ParentId)
    AS (
        SELECT Id, ParentId
        FROM MyData
        WHERE Id = @Id
        UNION ALL
        SELECT md.Id, md.ParentId
        FROM MyData md
        INNER JOIN Ancestors a
          ON md.Id = a.ParentId
    )
    SELECT Id FROM Ancestors
);
GO
----------------------------------------- ACTUAL QUERY
DECLARE @ids TABLE (Id int NOT NULL)
DECLARE @Count int
-- your data (perhaps via a "split" udf)
INSERT @ids VALUES (6)
INSERT @ids VALUES (7)
INSERT @ids VALUES (8)

SELECT @Count = COUNT(1) FROM @ids
;
SELECT TOP 1 a.Id
FROM @ids
CROSS APPLY AncestorsUdf(Id) AS a
GROUP BY a.Id
HAVING COUNT(1) = @Count
ORDER BY a.ID DESC 
```

* * *

如果节点不是严格升序，则更新：

```
CREATE FUNCTION AncestorsUdf (@Id int)
RETURNS @result TABLE (Id int, [Level] int)
AS
BEGIN
    WITH Ancestors (Id, ParentId, RelLevel)
    AS (
        SELECT Id, ParentId, 0
        FROM MyData
        WHERE Id = @Id
        UNION ALL
        SELECT md.Id, md.ParentId, a.RelLevel - 1
        FROM MyData md
        INNER JOIN Ancestors a
          ON md.Id = a.ParentId
    )

    INSERT @result
    SELECT Id, RelLevel FROM Ancestors

    DECLARE @Min int
    SELECT @Min = MIN([Level]) FROM @result

    UPDATE @result SET [Level] = [Level] - @Min

    RETURN
END
GO 
```

和

```
SELECT TOP 1 a.Id
FROM @ids
CROSS APPLY AncestorsUdf(Id) AS a
GROUP BY a.Id, a.[Level]
HAVING COUNT(1) = @Count
ORDER BY a.[Level] DESC 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T11:44:40.340

在从 Marc 的回答（谢谢）中对正确方向进行了一些思考和一些提示之后，我自己想出了另一个解决方案：

```
DECLARE @parentChild TABLE (Id INT NOT NULL, ParentId INT NULL);
INSERT INTO @parentChild VALUES (1, NULL);
INSERT INTO @parentChild VALUES (2, 1);
INSERT INTO @parentChild VALUES (3, 1);
INSERT INTO @parentChild VALUES (4, 2);
INSERT INTO @parentChild VALUES (5, 2);
INSERT INTO @parentChild VALUES (6, 3);
INSERT INTO @parentChild VALUES (7, 3);
INSERT INTO @parentChild VALUES (8, 7);

DECLARE @ids TABLE (Id INT NOT NULL);
INSERT INTO @ids VALUES (6);
INSERT INTO @ids VALUES (7);
INSERT INTO @ids VALUES (8);

DECLARE @count INT;
SELECT @count = COUNT(1) FROM @ids;

WITH Nodes(Id, ParentId, Depth) AS
(
    -- Start from every node in the @ids collection.
    SELECT pc.Id , pc.ParentId , 0 AS DEPTH
    FROM @parentChild pc
    JOIN @ids i ON pc.Id = i.Id

    UNION ALL

    -- Recursively find parent nodes for each starting node.
    SELECT pc.Id , pc.ParentId , n.Depth - 1
    FROM @parentChild pc
    JOIN Nodes n ON pc.Id = n.ParentId
)
SELECT n.Id
FROM Nodes n
GROUP BY n.Id
HAVING COUNT(n.Id) = @count
ORDER BY MIN(n.Depth) DESC 
```

它现在返回从最低公共父节点到根节点的整个路径，但这是`TOP 1`在选择中添加 a 的问题。

# apache-flex - 创建白板组件

> ID：1005763
> 
> 赞同：0
> 
> 时间：2009-06-17T08:24:10.587
> 
> 标签：apache-flex, flex3, air, flexbuilder

如何在 Flex 中创建简单的绘图板/白板功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T09:01:51.200

这是您问题的开源解决方案。

**博客文章** [http://www.jamesward.com/blog/2006/08/16/flex-paint-flex-display-object-to-png/](http://www.jamesward.com/blog/2006/08/16/flex-paint-flex-display-object-to-png/)

**SourceForge 的源代码** [http://sourceforge.net/project/showfiles.php?group_id=174131](http://sourceforge.net/project/showfiles.php?group_id=174131)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T08:50:02.690

[http://tv.adobe.com/#vi+f1472v1007](http://tv.adobe.com/#vi+f1472v1007)

这提供了足够多的信息来帮助您入门

# wpf - 如何使 XAML Slider 元素仅吸附到允许的值？

> ID：1005765
> 
> 赞同：2
> 
> 时间：2009-06-17T08:24:55.407
> 
> 标签：wpf, xaml, slider

我有一个最小值**0**和最大值**1**的滑块。

当我当前滑动它时，该值被设置为 0 到 1 之间的十进制值，例如**0.2342343**。

但是，我希望该值仅为**0 或 1**（以便我的 ViewModel 属性仅在它为 0 或 1 时才注册更改，而不是在用户将其从 0 拖到 1 时多次注册）。

**如何使滑块值仅为 0 或 1？**我尝试了 SmallChange、LargeChange 和 SnapsToDevicePixels，但这些都不起作用。

```
<Slider Name="TheLanguageIndexSlider"
        DockPanel.Dock="Bottom" 
        Minimum="0" 
        Maximum="1" 
        LargeChange="1"
        SmallChange="1"
        SnapsToDevicePixels="True"
        Width="100" 
        Margin="5" 
        Value="{Binding LanguageIndex}"
        HorizontalAlignment="Left"/> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-17T08:40:34.453

设置`IsSnapToTickEnabled`to`true`并将值 1 分配给`TickFrequency`属性：

```
<Slider IsSnapToTickEnabled="True"
        Maximum="1" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T08:43:12.890

来自[msdn](http://msdn.microsoft.com/en-us/library/system.windows.controls.slider.aspx)

```
<Slider Width="100" Value="50" Orientation="Horizontal" HorizontalAlignment="Left" 
    IsSnapToTickEnabled="True" Maximum="3" TickPlacement="BottomRight" 
    AutoToolTipPlacement="BottomRight" AutoToolTipPrecision="2" 
    Ticks="0, 1.1, 2.5, 3"/> 
```

在你的情况下：

```
<Slider Name="TheLanguageIndexSlider"
    IsSnapToTickEnabled="True"
    Ticks="0, 1"
    DockPanel.Dock="Bottom" 
    Minimum="0" 
    Maximum="1" 
    LargeChange="1"
    SmallChange="1"
    SnapsToDevicePixels="True"
    Width="100" 
    Margin="5" 
    Value="{Binding LanguageIndex}"
    HorizontalAlignment="Left"/> 
```

# wpf - RegisterAttached String PropertyName 导致 AttachedProperty 不触发

> ID：1005773
> 
> 赞同：1
> 
> 时间：2009-06-17T08:26:25.340
> 
> 标签：wpf, attached-properties

我遇到了附加属性的一个奇怪问题，当我在调用 RegisterAttached 中分配属性名称并正确命名附加属性的名称（比如 TranslateProperty 和“Translate”）时，附加属性实现的代码不会不开火。就是不叫。如果我将字符串名称更改为 Translate 以外的任何其他名称（比如“Translate_”），代码就会被调用。

这是实现：

公共类 TranslateExtension : DependencyObject {

```
public static readonly DependencyProperty TranslateProperty =
    DependencyProperty.RegisterAttached("Translate_",
                                        typeof(bool),
                                        typeof(TranslateExtension),
                                        new FrameworkPropertyMetadata(false, FrameworkPropertyMetadataOptions.AffectsRender));

public static void SetTranslate(UIElement element, bool value)
    {
        AssignKeys(element);
        element.SetValue(TranslateProperty, value);
    }
    public static bool GetTranslate(UIElement element)
    {
        return (bool)element.GetValue(TranslateProperty);
    }

    public bool Translate
    {
        set { base.SetValue( TranslateProperty,  value); }
    }
   ...
} 
```

由于字符串中的属性是 Translate_，因此上述内容实际上有效。如果我将字符串值更改为“翻译”，它会失败。

我在同一个类中有 2 个其他附加属性，它们表现出完全相同的行为 - 与 AttachedProperty 名称相同，它们不会被调用。将其命名为其他名称，它就可以工作。

我不确定这里发生了什么。我的代码实际上是在使用无效的名称，但我不明白为什么，更重要的是我不确定这个错误的命名是否会导致任何副作用。

谁能看到我是否忽略了一些非常明显的东西？我在 AttachedProperties 的文章中重新审视了一些示例，但我没有看到那些使用特殊名称的实现——它们总是将字符串属性命名为与附加属性相同的名称。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T16:03:09.783

您不应该在 SetTranslate 中添加额外的代码，因为它不会被调用。[从这里的](http://msdn.microsoft.com/en-us/library/bb613563.aspx)MSDN ：

> **自定义依赖属性的含义**
> 
> 由于用于属性设置的 XAML 处理器行为的当前 WPF 实现完全绕过包装器，因此不应将任何其他逻辑放入自定义依赖项属性的包装器的集合定义中。如果您将此类逻辑放在集合定义中，那么当在 XAML 中而不是在代码中设置属性时，将不会执行该逻辑。
> 
> 同样，从 XAML 处理中获取属性值的 XAML 处理器的其他方面也使用 GetValue 而不是使用包装器。因此，您还应该避免在 GetValue 调用之外的 get 定义中的任何其他实现。

相反，将 PropertyChangedCallback 添加到您的 FrameworkPropertyMetadata。

# c# - 我应该使用值还是键？

> ID：1005774
> 
> 赞同：0
> 
> 时间：2009-06-17T08:26:36.870
> 
> 标签：c#, architecture, arcgis

我正在使用一个类扭曲 ArcGIS IFeature 对象，该类具有我需要的属性以轻松获取和设置它们。基本上，get 和 set 操作只使用`feature.get_value(index)`and `feature.set_value(indes, value)`，并暴露强类型值。
我有几个字段使用域（基本上是一个`IDictionary<string, object>`）来表示整个应用程序的公共属性。
起初我想我只会在我的包装类中使用域的键（它们是普通的 int 值），并在我的`ToString()`方法中使用域来转换为 UI 的字符串。
后来我发现我可以在我的应用程序中使用字符串（这使得传递空值更容易，因为实际的域字段大部分时间都可以为空），并且只更改这些字段的 getter 和 setter 以使用`GetDomainValue(index)`和`SetDomainValue(index, value)`将在键和值之间转换到底层特征对象的方法。

你认为哪种方法更好？我认为字符串方法有点“持久无知”，因为我的班级不关心值是如何保存的，只关心它们的字符串表示。另一方面，它使代码稍微跳过循环——而不是返回特性中的内容，每个 getter 都需要迭代域。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-22T12:02:06.053

您可能想考虑用[`Nullable< Int32>`](http://msdn.microsoft.com/en-us/library/b3h38hb0.aspx). 这将为您提供一种表示具有指定域值的特征的方法，但它也允许您`null`在适当的地方直接指定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-29T06:23:45.110

我最终坚持使用域值，这样我还可以验证调用代码是否传递了有效值。

# c++ - 继承时的范围规则 - C++

> ID：1005780
> 
> 赞同：7
> 
> 时间：2009-06-17T08:28:13.560
> 
> 标签：c++, scope

我正在阅读 Stroustrup 的 C++0x 常见问题解答，并被这段代码卡住了。考虑以下代码

```
struct A
{
    void f(double)
    {
        std::cout << "in double" << std::endl;
    }
};

struct B : A
{
    void f(int)
    {
        std::cout << "in int" << std::endl;
    }
};

int main()
{
    A a; a.f(10.10);  // as expected, A.f will get called
    B b; b.f(10.10);  // This calls b.f and we lose the .10 here
    return 0;
} 
```

我的理解是当一个类型被继承时，所有受保护的和公共的成员都可以从派生类中访问。但是根据这个例子，看起来我错了。我期待*bf*会调用基类*f*。我通过改变派生类得到了预期的结果

```
struct B : A
{
    using A::f;
    void f(int)
    {
        std::cout << "in int" << std::endl;
    }
}; 
```

*问题*

1.  为什么它在第一个代码中不起作用？
2.  C++ 标准中的哪个部分描述了所有这些范围规则？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T08:49:34.313

这是因为 A::f 是“隐藏的”而不是“重载”或“覆盖”。参考：

[http://www.parashift.com/c++-faq-lite/strange-inheritance.html#faq-23.9](http://www.parashift.com/c++-faq-lite/strange-inheritance.html#faq-23.9)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T08:44:40.093

第一个代码的工作原理是 c++ 旨在工作。

重载决议遵循一套非常复杂的规则。来自 Stroustrup 的 c++ 圣经 15.2.2 “[A] 来自不同基类的函数之间的歧义不是基于参数类型来解决的。”

正如您所描述的，他继续解释“使用”的用法。

这是该语言的设计决策。

我倾向于遵循 Stroustrup 的书而不是标准，但我确信它在那里。

[编辑]

这是（来自标准）：

第十三章

当在同一范围内为单个名称指定两个或多个不同的声明时，该名称称为重载。

进而：

13.2 声明匹配

1 如果两个同名函数声明在同一范围内并且具有等效的参数声明 (13.1)，则它们引用同一个函数。派生类的函数成员与基类中的同名函数成员不在同一范围内。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T08:44:25.883

搜索**重载解决方案**。一个[类似但不相同的问题](https://stackoverflow.com/questions/72010/c-overload-resolution)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T08:45:18.190

在 C++ 中，没有跨范围的重载，派生类中的范围也不例外。 [（根据 C++ 编程语言）](http://www.research.att.com/~bs/3rd.html)

有关更多信息，请查看[http://www.research.att.com/~bs/bs_faq2.html#overloadderived](http://www.research.att.com/~bs/bs_faq2.html#overloadderived)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T08:47:21.383

在第一种情况下，基类方法“f”被派生类方法**隐藏。**在 C++ 中，没有跨范围的重载；这就是它不被调用的原因。C++ 标准在***第 10.2 节成员名称查找 [class.member.lookup]***中解释了所有成员名称查找规则。高温高压

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-17T08:50:35.963

第一个版本的代码应该真正调用 B::f。您在结构“B”中重新定义了符号“f”，因此它从结构“A”中隐藏了原始符号“f”。它不是看起来的过载。

每当编译器遇到 bf() 时，它都会在“B”结构中搜索符号“f”。它存在于此，因此编译器决定调用 B::f(int)，将 double 转换为 int。它认为不需要扫描父类以获得更合适的功能......

然而，当您添加“使用 A::f”时，编译器会显式指令扫描父类中的符号“f”。现在，B 类有两个重载函数：for int 和 for double。

我也相信，您可以编写 bA::f() 而不在原始示例中使用“使用”指令......

# asp.net-mvc - MVC 模型和控制器在哪里写什么

> ID：1005781
> 
> 赞同：1
> 
> 时间：2009-06-17T08:28:25.820
> 
> 标签：asp.net-mvc

我们已经开始使用 MVC 框架，现在我们有点困惑在哪里编写业务逻辑，在控制器或模型中？

对于该项目，我们将使用 WCF 层作为 DAL。

人们对 Model & Controller 有不同的看法，对用“M”或“C”编写业务逻辑的想法也不同。

最佳做法是什么？

我相信我们将在模型中访问 WCF (DAL) 服务并应用所有业务逻辑或过滤，然后控制器从模型中访问数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T09:36:30.987

尽量保持-业务-逻辑和-应用程序流-逻辑分开。大多数人倾向于将它们混合在一起作为-业务逻辑-

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T11:57:56.600

这些是我的规则：

**控制器**

主要是页面流。确定接下来显示的视图。

有权访问服务（即 productService.GetProduct(Model.ProductID) ）

**模型**

我有 2 个。

POCO-Classes - 由所有层使用（BLL，DAL）

ViewModel - 由 View 和 Controller 用于 stronly 类型的视图。

**看法**

希望主要是简单的HTML

我尝试以某种方式进行布局，让不同类型的人在项目中工作：前端人员和后端人员。后端人员将负责服务和存储库。

前端的人会做控制器和视图。他也做ajax。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T09:27:25.547

大多数人将他们的业务逻辑保留在模型中，这被认为是最佳实践。编写 xVal 的 Steve Sanderson 支持这种方法。

> 正如我之前讨论过的，验证规则应该放在你的领域模型中，因为你的模型的作用是代表你的业务运作。它确保规则将始终如一地执行，无论 UI 编码人员是否记住它们。

查看他关于[xVal](http://blog.codeville.net/2009/01/10/xval-a-validation-framework-for-aspnet-mvc/)的帖子，其中讨论了您正在讨论的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T11:45:06.360

不要认为该模型应该仅从数据访问逻辑（在您的情况下为 wcf 服务）构建。我建议您查看[Domain Driven Design](http://en.wikipedia.org/wiki/Domain-driven_design)，它与 MVC 配合得很好。控制器不应包含任何业务逻辑。控制器操作方法应该是 ~20 或更少的行。但这只是我的意见（由无数来源组成）。

# sql - SQL 平均时间

> ID：1005782
> 
> 赞同：1
> 
> 时间：2009-06-17T08:28:29.613
> 
> 标签：sql, datetime, time, average

我在 MSSQL 中有以下查询：

```
select 
TRANSACTION_TYPE_ID
,COUNT(TRANSACTION_TYPE_ID)AS NUMBER_OF_TRANSACTIONS
,CAST(SUM(AMOUNT)AS DECIMAL (30,2)) AS TOTAL
FROM 
    [ONLINE_TRANSACTION] 
WHERE CONVERT(CHAR(8), CREATED_ON, 114) >='17:30' AND AMOUNT IS NOT NULL AND     
TRANSACTION_TYPE_ID !='CHEQUE-STOP-TRANS-TYPE' 
GROUP BY TRANSACTION_TYPE_ID
ORDER BY TRANSACTION_TYPE_ID 
```

我想显示上面的交易类型，`TRANSATION_TYPE_ID`上面每种交易类型的总金额，但还有这些交易发生的平均时间`CREATED_ON`，这是`datetime`我仍然没有找到这样做的好方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T09:07:12.903

根据 Randolph Potter 的回答，您可以找到如下平均时间：

```
avg(DATEPART(hh,created_on)*60 + DATEPART(mi,created_on)) % 24 as AvgHour,
avg(DATEPART(hh,created_on)*60 + DATEPART(mi,created_on)) / 24 as AvgMinute 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T10:38:58.283

```
SELECT FROM_UNIXTIME( ( ROUND((UNIX_TIMESTAMP( floor(timestamp_column)) /   60 ),0) *   60 ) ) rounded_time
FROM mysql_table
WHERE timestamp_column BETWEEN STR_TO_DATE('31/07/2012','%d/%m/%Y') 
AND STR_TO_DATE('01/08/2012','%d/%m/%Y') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T08:33:46.153

一种方法是将时间转换为秒，计算平均值，然后将其转换回小时、分钟和秒以获得结果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-12-02T00:53:44.687

如果您谈论一天中的时间而不是想获得特定日期，即。5:32 而不是 2012 年 1 月 4 日 5:32，以下可能会有所帮助。对不起，这是我习惯于编写 SQL 的方式。

```
CONVERT(VARCHAR,AVG(DATEPART(HH,CREATED_ON)*60 + DATEPART(MI,CREATED_ON)) / 60) + ':' + 
CASE WHEN CONVERT(VARCHAR,AVG(DATEPART(HH,CREATED_ON)*60 + DATEPART(MI,CREATED_ON)) % 60) < 10
    THEN '0'+CONVERT(VARCHAR,AVG(DATEPART(HH,CREATED_ON)*60 + DATEPART(MI,CREATED_ON)) % 60)
    ELSE CONVERT(VARCHAR,AVG(DATEPART(HH,CREATED_ON)*60 + DATEPART(MI,CREATED_ON)) % 60)
END AS AVG_CREATED_ON 
```

# localization - 网站语言：使用浏览器区域设置或 IP 地址

> ID：1005784
> 
> 赞同：7
> 
> 时间：2009-06-17T08:29:06.740
> 
> 标签：localization, browser-detection, country

对于一个网站，我们即将实现自动国家/语言选择，但仍然让用户可以选择更改它。

首先，如果用户使用具有国家级 TLD 的域进入网站，默认情况下会显示正确的语言。但问题是，如果它们来自通用/国际顶级域名（例如 .com），逻辑应该是什么。我们应该更喜欢使用我们通过他们的 IP 地址获得的国家，还是应该使用他们的浏览器区域设置？如果两者都有，按什么顺序？

因此，我在考虑这种层次结构：

1.  如果之前更改过，请使用用户选择。如果用户从未明确设置过：
2.  使用主机名 TLD。如果它是通用的（.com）：
3.  使用浏览器语言环境。如果此语言环境没有设置语言环境或没有相应的语言版本可用：
4.  使用 IP 地址。如果检测到的国家/地区没有对应的语言版本：
5.  使用英语。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-17T08:31:01.103

我建议使用浏览器区域设置而不是 IP 地址，因为一个人可能住在其他地方，但更喜欢该国家/地区的标准语言以外的语言。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-17T08:31:46.703

浏览器区域设置，因为它是用户选择。当一个法国人带着他的笔记本电脑去英国旅行时，他希望尊重浏览器区域设置而不是 IP。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-17T08:35:06.680

浏览器区域设置应在 IP 地址之前，

我是居住在国外的以英语为母语的人，当我的浏览器区域设置为英语时，我对自动为我提供居住国家/地区语言的网站感到恼火。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-17T08:34:37.103

由于大多数国家/地区都有多种官方语言，您应该首先依赖用户偏好，然后依赖浏览器区域设置、TLD、IP，然后将英语作为“默认”（或主要用户群的任何主要语言）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-07-25T01:15:40.503

听着，我不确定你们在哪里，我现在住在芬兰，让我告诉你们，最令人沮丧的事情之一就是使用 IP 地址来选择语言。它绝对把一切都搞砸了，我在扯我的头发，尤其是任何与谷歌有关的东西，事实上，我根本无法使用 Blogger，所以如果你对此有任何影响，请！！！！！！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-17T08:40:16.343

IP 地址匹配将需要一个（昂贵的）地理/IP 查找数据库、一个承诺和基础设施来维护它，在阻止 IP 方面存在重大问题，并且最终甚至不会为您提供您想要的信息，因为没有 1： 1 国家和语言之间的关系（官方：加拿大，或非官方：美国），甚至不密切。

我更喜欢将 cookie 偏好降级到 TLD/子域（或 TLD 与语言无关的本地设置）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-17T08:38:17.330

就我个人而言，我只是在登陆页面上使用您的主要受众的语言，这只是一个语言选择页面，用户必须选择一种语言才能继续。这会设置一个 cookie，以便用户下次访问时（从同一台机器上的同一浏览器）重定向正确的语言站点。

我有几个原因。

1.  编码更容易 - 无需检查 IP 范围或浏览器区域设置等。更少的代码意味着更少的错误。
2.  你没有假设任何关于用户的事情。例如，他们可能是美国人，在日本使用的机器设置为德语。
3.  这可能是正确的:)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-17T08:40:23.503

您还必须允许通过网络代理进入的人不在他们明显的 IP 地址所在的区域设置中。

即使我在新西兰，我也会收到很多圣地亚哥公司的广告，因为我在那里使用网络代理。

# visual-studio-2008 - 在 Windows Vista 上安装 Windows 服务

> ID：1005785
> 
> 赞同：0
> 
> 时间：2009-06-17T08:29:15.710
> 
> 标签：visual-studio-2008

是的，Vista 很烂……我正在使用 .Net 编写 Windows 服务，但在尝试使用 InstallUtil.exe 安装时出现安全错误。

如何在 Windows Vista 中成功安装 Windows 服务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T08:45:22.760

尝试`installutil.exe`从提升的 cmd 运行（在开始菜单中搜索命令提示符，右键单击，以管理员身份运行）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T08:46:02.527

*   按下开始按钮
*   在搜索框中输入 cmd
*   当Command Shell出现时右键单击，选择以管理员身份运行

现在您拥有具有完全管理员权限的命令外壳。InstallUtil 随意。

# c# - 如何将屏幕坐标转换为相对坐标（winforms）？

> ID：1005789
> 
> 赞同：6
> 
> 时间：2009-06-17T08:29:50.357
> 
> 标签：c#, winforms

我有以下功能（这是不正确的）：

```
private void TreeView_DragDrop(object sender, DragEventArgs e)
{
    TreeNode CurrentNode = 
        TreeView.GetNodeAt(e.X - this.Left - NotesView.Left, 
                           e.Y - this.Top - NotesView.Top);
    // [snip]...
} 
```

但这是不正确的，因为它没有考虑到表单装饰......我相信除了硬编码之外，必须有更好的方法来做到这一点（无论如何这都是错误的，这取决于几件事如Vista vs XP vs Win2k），但我找不到它。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-17T08:33:36.357

您可以使用：

```
 Point clientPoint = TreeView.PointToClient( new Point( e.X, e.Y ) ); 
```

获取相对坐标。

# evaluation - 通用标准选项

> ID：1005796
> 
> 赞同：2
> 
> 时间：2009-06-17T08:31:20.853
> 
> 标签：evaluation

有一些关于国际通用标准的批评者，例如 [Under-attack]。[1](http://gcn.com/Articles/2007/08/10/Under-attack.aspx?Page=1)

在您看来，使用 CC 开发 IT 产品的优缺点是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-27T21:50:48.970

我是 BSI（德国）和 NIAPP（美国）计划的通用标准评估员。我有少量经验，但我认为我有足够的资格回答这个问题。

优点：

1.  与CC一起发展的首要优势是能够与美国政府开展业务。每次我对某人说这句话时，我都会死在里面，因为我真的很想成为安全的首要理由。可惜...
2.  其次，它极大地提高了设计文档的质量，因为 CC 的大部分内容都围绕着分析文档展开，而好的文档是必需的。找一个好的实验室，他们可能会为你做所有这些。
3.  它会让您意识到您从未想过的安全问题，例如客户如何知道我运送给他们的产品真的来自我而不是冒充我的人？
4.  最后，遗憾的是，它将提高产品的技术安全性。获得一个好的实验室，您将获得非常强大的安全产品和认证。得到一个坏的，你会带着证书离开。

缺点：

1.  极其昂贵。除非你有足够的金库来吸收数十万美元的冲击，否则你不会被 CC 淘汰。但是，如果您打算与联邦政府合作，如果他们真的喜欢您的产品，您可能会让他们按您的方式付款。
2.  非常耗时。我们的评估持续 9-16 个月，具体取决于产品的复杂性和评估保证级别。给你一个想法，EAL 4 的通用 Linux 发行版可能需要一整年才能完成。
3.  该证书仅适用于您产品的***确切***版本号。进行更新，证书无效。（但是，是否接受打补丁的产品取决于国防部的申请官员，所以并不是所有的希望都落空了。
4.  它的价值在联邦市场以外的任何地方几乎一文不值。
5.  根据您选择的方案，您将面临某些类型的政治、缺乏资源和额外的要求。最好的办法是找到一个可以帮助您完成所有事情的好的实验室。

请注意，我是从开发人员的角度为您提供优缺点。当从技术上谈论标准是如何建立的以及它的有效性是什么时，有一组不同的优点和缺点。

# sql - 在 MS SQL 服务器中编写触发器与在 MS Access 中编写触发器相同吗？

> ID：1005800
> 
> 赞同：0
> 
> 时间：2009-06-17T08:32:07.700
> 
> 标签：sql, sql-server, ms-access, triggers

我在 SQL Server 中编写了以下触发器：

```
create trigger test_trigger
on invoice -- This is the invoice table
for insert
as
declare @invoiceAmount int    -- This is the amount specified in the invoice 
declare @custNumber int       -- This is the customer's id

--use the 'inserted' keyword to access the values inserted into the invoice table
select @invoiceAmount = Inv_Amt from inserted 
select @custNumber = cust_num from inserted

update customer
set amount = @invoiceAmount
where Id = @custNumber 
```

这将能够在 MS Access 中运行还是语法不同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T10:29:11.880

Access 数据库引擎（以前称为 Jet）没有触发器，也没有控制流的语法，例如，PROCEDURE 必须只包含一个 SQL 语句。

告诉我们您真正想要做什么，并且可能有另一种语法。

例如，您可以使用发票上的 UNIQUE 约束 (cust_num, Inv_Amt) 创建一个新键，一个 FOREIGN KEY 客户 (id, amount) 来引用新键，一个在 FOREIGN KEY 列上连接两个表的 VIEW 和公开所有四列，然后 INSERT 到 VIEW 而不是表“发票”；您可能希望使用特权来防止插入基表，但用户级别的安全性已从新的 Access 2007 引擎（称为 ACE）中删除。

但是，如果你不介意我说的话，我认为你的触发器并不反映现实生活中的场景。在“客户”表中模糊命名为“金额”的列用于保存最近的发票金额？如果插入的逻辑表包含多个客户的行怎么办？正如我所说，我认为您需要告诉我们您真正想要实现的目标。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T12:57:56.353

访问没有触发器

您在此处显示的触发器将爆炸，因为它不会在有人更新多行时考虑多行更新（并且不要说它不会发生，因为练习一些防御性编码会更好）

触发器按批次而不是按行触发，请阅读[DML 触发器的多行注意事项](http://msdn.microsoft.com/en-us/library/ms190752(SQL.90).aspx)

加入插入的伪表和发票表来更新值...适用于 1 行和多于 1 行

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-04T21:46:46.597

他们可能会在 Access 2010 中出现？ [http://blogs.msdn.com/access/archive/2009/08/13/access-2010-data-macros-similar-to-triggers.aspx](http://blogs.msdn.com/access/archive/2009/08/13/access-2010-data-macros-similar-to-triggers.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T08:41:12.863

MS Access 没有触发器。

即，Access Jet 引擎（创建 .mdb 文件）。如果 Access 正在连接到数据库服务器，那么它将使用该数据库中的任何触发器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T08:41:53.047

我从来没有在 Access 中遇到过触发器，除非它处理 SQL Server 上的 ADP。所以你的答案是肯定的，如果你在后端的 SQL Server 上是一样的，如果表存储在 Access 中，则不是。

# java - 如何更改此正则表达式以正确提取标签属性 - 应该很简单

> ID：1005803
> 
> 赞同：2
> 
> 时间：2009-06-17T08:32:16.763
> 
> 标签：java, regex

我需要“抓取”自定义 HTML 标记的属性。我知道这种问题以前已经被问过很多次了，但是正则表达式真的让我很头疼，而且我似乎无法让它发挥作用。

我需要使用的 XML 示例是

`<!-- <editable name="nameValue"> --> - content goes here - <!-- </editable> -->`

我希望能够获取 name 属性的值，在本例中为 nameValue。我所拥有的如下所示，但这会返回一个空值。

我的正则表达式字符串（对于 Java 应用程序，因此 \ 转义“）是：
`"(.)?<!-- <editable name=(\".*\")?> -->.*<!-- </editable> -->(.)?"`

我试图用引号抓住属性我认为这是最简单和最普遍的匹配模式。好吧，它只是不起作用，任何帮助都会帮助我保持头发。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T08:36:47.363

你的搜索是[贪婪](http://www.exampledepot.com/egs/java.util.regex/Greedy.html)的。使用`"\<\!-- \<editable name=\"(.*?)\"\> --\>.*?\<\!-- \<\/editable\> --\>"`（添加`?`）。请注意，这不能与嵌套`<editable>`元素一起正常工作。

如果您不想执行语法检查，您也可以简单地使用：`"\<\!-- \<editable name=\"(.*?)\"\> --\>"`甚至`"\<editable name=\"(.*?)\"\>"`更好的简单性和性能。

**编辑：**应该是

```
Pattern re = Pattern.compile( "\\<editable name=\"(.*?)\"\\>" ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T08:37:08.220

我使用 JavaScript，但它应该有助于使表达式尽可能不贪婪，并使用不匹配而不是任何字符匹配。不确定正则表达式与 Java 的相似程度如何，但不要使用表达式，而是`\".*\"`尝试使用`\"[^\"]*\"`. 这将搜索属性值中不是引号的任何字符，这意味着表达式不能匹配超出属性值。

希望有帮助

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T08:42:01.050

我认为您不需要`(.)?`s 在您的正则表达式的开头和结尾。而且您需要放入一个捕获组以仅获取 content-goes-here 位：

这对我有用：

```
String xml = "RANDOM STUFF<!-- <editable name=\"nameValue\"> --> - content goes here - <!-- </editable> -->RANDOM STUFF";
Pattern p = Pattern.compile("<!-- <editable name=(\".*\")?> -->(.*)<!-- </editable> -->");
Matcher m = p.matcher(xml);
if (m.find()) {
    System.out.println(m.group(2));
} else {
    System.out.println("no match found");
} 
```

这打印：

```
 - content goes here - 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T13:58:23.410

正则表达式根本不擅长解析 HTML（请参阅[您能否提供一些示例，说明为什么用正则表达式解析 XML 和 HTML 很困难？](https://stackoverflow.com/questions/701166)为什么）。您需要的是一个 HTML 解析器。请参阅[您能否提供一个使用您最喜欢的解析器解析 HTML 的示例？](https://stackoverflow.com/questions/773340)对于使用各种解析器的示例。

您可能会发现使用[TagSoup的](http://home.ccil.org/~cowan/XML/tagsoup/)[答案](https://stackoverflow.com/questions/773340/can-you-provide-an-example-of-parsing-html-with-your-favorite-parser/774519#774519)很有帮助。

# regex - 在正则表达式匹配血型方面需要帮助

> ID：1005805
> 
> 赞同：5
> 
> 时间：2009-06-17T08:32:55.797
> 
> 标签：regex

我正在尝试提出一个正则表达式来帮助我验证**血型**字段 - 它应该只接受 A[+-]、B[+-]、AB[+-] 和 O[+-]。

这是我想出的正则表达式（并使用**[Regex Tester](http://regexpal.com/)**进行了测试）：

```
[A|B|AB|O][\+|\-] 
```

现在这个模式成功匹配 A,B,O[+-]，但匹配 AB[+-] 失败。

任何人都可以建议一个符合我目的的正则表达式吗？

谢谢，m^e

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-17T08:36:19.160

尝试：

```
(A|B|AB|O)[+-] 
```

使用方括号定义一个[字符类](http://www.regular-expressions.info/charclass.html)，它只能是单个字符。括号[创建一个分组](http://www.regular-expressions.info/brackets.html)，允许它做你想做的事。您也不需要转义`+-`字符类中的 ，因为它们内部没有正则表达式含义。

正如您在评论中提到的，如果您要匹配的字符串具有您正在寻找的确切值，您可能想要这样做：

```
^(A|B|AB|O)[+-]$ 
```

如果没有[字符串的开头和结尾的锚点](http://www.regular-expressions.info/anchors.html)，“helloAB+asdads”之类的东西就会匹配。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T14:11:15.583

当您构建一个交替（例如`(A|B|AB|O)`）时，您应该注意元素的顺序。许多正则表达式引擎将在匹配的第一个替代项处停止（而不是最长的）。如果不是因为`[-+]`强制回溯，`(A|B|AB|O)[-+]`就不会为`"AB+"`. 最好说`(AB|A|B|O)[-+]`（但你应该检查你的正则表达式引擎的文档）。

此外，如果您不打算捕获抗原以供以后使用，您应该使用非捕获分组括号：`(?:AB|A|B|O)[-+]`.

此外，如果你想确保字符串中唯一的东西是血型，那么你需要锚来防止它只匹配字符串的一部分：`^(?:AB|A|B|O)[-+]$`. 关于锚点的快速说明，根据您的正则表达式引擎，`^`如果您将多行匹配选项传递给它，它可能匹配行的开头而不是字符串的开头。类似地，`$`可能匹配一行的结尾而不是字符串的结尾。出于这个原因，还有其他三个共同使用的锚（但不是 %100）：`\A`、`\Z`和`\z`。如果您的正则表达式引擎支持它们，则`\A`始终匹配字符串的开头，`\Z`匹配字符串的结尾或字符串结尾之前的换行符，并且`\z`仅匹配字符串的发送。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T08:41:17.450

方括号 [] 表示一个字符类，意思是“这里的任何字符”。您需要括号 () 进行分组：

```
(A|B|AB|0)(\+|-) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-04-23T19:23:55.517

对于 html 模式属性中不区分大小写的情况，您可以试试这个

```
([AaBbOo]|[Aa][Bb])[\+-]

<input type="text" maxlength="3" pattern="([AaBbOo]|[Aa][Bb])[\+-]" required /> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-06-30T04:03:30.507

^(A|B|AB|O)[+-]?$ 这将产生正确的输出。

# java - 在 ArrayList 上使用 HashSet 来传达意图？

> ID：1005807
> 
> 赞同：10
> 
> 时间：2009-06-17T08:33:10.197
> 
> 标签：java, collections, arraylist, set

想象一下，我需要创建一个元素集合，其中顺序可能重要，也可能不重要。实际上，我计划做的就是使用迭代器。我注意到我的大多数同事都使用 ArrayList 与 LinkedHashSet/HashSet。我的问题是，如果我知道这些元素应该是唯一的，我应该使用 Set 还是 List？实际上它并没有真正产生影响，但是 Set 不是更有效地传达了元素是独一无二的吗？

我发现这对于大型企业应用程序来说是一个有趣的问题，原因如下： 1) 如果您不能保证整体代码的质量，那么使用 Set 可能会很危险。为什么？因为 equals() 和 hashcode 可能被错误地覆盖，因此使用 Set 可能会导致一些非常讨厌的问题。2) 使用列表更能适应未来的变化。如果出于某种原因可能出现重复，则无需担心。

基本上它归结为：如果我知道我应该期待独特的元素，我应该在所有情况下都支持 Set 而不是 List 吗？

编辑：我想我也在问：是否应该使用 Set 来**确保**不添加重复项，或者它是否也可以仅用于**说明**不存在重复项以便于理解？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-17T08:39:21.040

1）完全是假的。不要解决错误，修复它们。因此，如果顺序无关紧要，请使用任何[Set实现，如果顺序很重要，请](http://java.sun.com/javase/6/docs/api/java/util/Set.html)**使用**[SortedSet](http://java.sun.com/javase/6/docs/api/java/util/SortedSet.html)。如果元素不必是唯一的（并且您现在应该确定这一点，并且它通常不应该改变），请随意使用[List](http://java.sun.com/javase/6/docs/api/java/util/List.html)。

 *** * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T08:40:17.653

如果您需要考虑独特的元素，请使用 Set。但是，如果您不相信您的用户能够正确实现 equals/hashCode，那么我建议您记录一下，如果迭代有问题，请检查您的 equals/hashCode！但这实际上取决于数据模型的用例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-07T03:11:55.310

```
 import java.util.*;

    public class Test {
        public void testHashSetAddition() {
            for(int mod=10; mod <= 100; mod=mod+10 ) {
                Set s = new HashSet();
                long start = new Date().getTime();
                for(int i=0; i<100000; i++) {
                    s.add(new Foo(i % mod));
                }
                System.out.println(s.size());
                long end = new Date().getTime();
                System.out.println("Mod: " + mod + " - " + (end - start) + "ms");
            }
        }
        public void testAddingToArrayList() {
            for(int mod=100; mod >= 10; mod=mod-10 ) {
                List l = new ArrayList();
                long start = new Date().getTime();
                for(int i=0; i<100000; i++) {
                    l.add(new Foo(i % mod));
                }
                System.out.println(l.size());
                long end = new Date().getTime();
                System.out.println("Mod: " + mod + " - " + (end - start) + "ms");
            }
        }

        public static void main(String...a){
            new Test().testHashSetAddition();
            new Test().testAddingToArrayList();
        }
        class Foo {
            private int hc;
            public Foo(int i) {
                this.hc = i;
            }
            public int hashCode() {
                return hc;
            }
            public int getHc(){
                return hc;
            }
            public boolean equals(Object o){
                if(!(o instanceof Foo)) return false;
                Foo fo = (Foo)o;
                return fo.getHc() == this.hc;
            }
        }

    }
/*
10
Mod: 10 - 31ms
20
Mod: 20 - 16ms
30
Mod: 30 - 15ms
40
Mod: 40 - 16ms
50
Mod: 50 - 0ms
60
Mod: 60 - 16ms
70
Mod: 70 - 0ms
80
Mod: 80 - 15ms
90
Mod: 90 - 0ms
100
Mod: 100 - 0ms
100000
Mod: 100 - 32ms
100000
Mod: 90 - 31ms
100000
Mod: 80 - 31ms
100000
Mod: 70 - 31ms
100000
Mod: 60 - 32ms
100000
Mod: 50 - 15ms
100000
Mod: 40 - 31ms
100000
Mod: 30 - 32ms
100000
Mod: 20 - 15ms
100000
Mod: 10 - 32ms
*/ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T08:43:05.620

还要考虑代码的可读性。

如果您期望并想要一个唯一的集合，那么使用“SET”数据结构，从长远来看，事情会更加清晰。因此，这也将促进更好的编码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T14:56:48.907

有人说 HashSet 在添加、删除、包含和大小方面提供恒定的时间性能。

**JavaDocs 中的实际声明是“假设散列函数在桶中正确地分散元素**，此类为基本操作（添加、删除、包含和大小）提供恒定的时间性能。”

这意味着，如果它的 hashCode 方法实现不佳，则在向集合中添加某些内容时，添加时间可能会很慢。

以下代码演示了取决于您的 hashCode 实现可能发生的情况。

```
public void testHashSetAddition() {
    for(int mod=10; mod <= 100; mod=mod+10 ) {
        Set s = new HashSet();
        long start = new Date().getTime();
        for(int i=0; i<100000; i++) {
            s.add(new Foo(i % mod));
        }
        long end = new Date().getTime();
        System.out.println("Mod: " + mod + " - " + (end - start) + "ms");
    }
}

class Foo {
    private int hc;
    public Foo(int i) {
        this.hc = i;
    }
    public int hashCode() {
        return hc;
    }
} 
```

计时结果是：

```
Mod: 10 - 22683ms
Mod: 20 - 14200ms
Mod: 30 - 10486ms
Mod: 40 - 8562ms
Mod: 50 - 7761ms
Mod: 60 - 6740ms
Mod: 70 - 5778ms
Mod: 80 - 5268ms
Mod: 90 - 4716ms
Mod: 100 - 3966ms 
```

然后，对 ArrayList 进行完全相同的测试：

```
public void testAddingToArrayList() {
    for(int mod=100; mod >= 10; mod=mod-10 ) {
        List l = new ArrayList();
        long start = new Date().getTime();
        for(int i=0; i<100000; i++) {
            l.add(new Foo(i % mod));
        }
        long end = new Date().getTime();
        System.out.println("Mod: " + mod + " - " + (end - start) + "ms");
    }
} 
```

给出：

```
Mod: 100 - 50ms
Mod: 90 - 30ms
Mod: 80 - 40ms
Mod: 70 - 30ms
Mod: 60 - 30ms
Mod: 50 - 40ms
Mod: 40 - 20ms
Mod: 30 - 30ms
Mod: 20 - 30ms
Mod: 10 - 30ms 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T08:38:49.513

设置是否更可取，因为它将强制执行唯一性并向您显示错误所在。

当方法被错误地覆盖时，您可能会遇到一些问题，但正确的选择是不祈祷并避免调用它们。检测错误并修复它们！

编辑：是的，当您看到 Set 时会更清楚，需要唯一值，甚至更好：强制执行唯一值。永远不要猜测/相信你的代码的使用；）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-17T09:16:37.800

我认为这两种选择都不应该被视为传达意图——你的方法应该被声明为只返回`Collection`带有适当通用参数的 a ，这既是为了灵活性，也是因为正如你所说，它的使用者应该能够迭代不用担心它是什么类型。这带来了额外的优势，即如果需求稍后发生变化，或者结果证明您的初始选择出于某种原因是错误的，您只需在一个地方（初始构造函数调用）更改代码。

其意图应该在方法的文档中指定，该文档应该详细说明集合的迭代器是否会以任何特定顺序返回元素，以及是否会出现重复元素。

而且我也同意上面的帖子说你对第 1 点的推理是错误的——如果有类的实现不正确`equals`和/或`hashcode`你想放入一个集合中，你修复它们然后使用一个集合！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-05-10T10:20:37.747

@Andrzej Doyle——我不认为当你向一个集合添加一个元素时，重复比较就完成了。一个集合在内部使用hashMap，所以任何重复的键都将被覆盖，因此没有特定的检查

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-05-10T10:17:33.863

@Andrzej Doyle——我不认为当你向一个集合添加一个元素时，重复比较就完成了。一个集合在内部使用hashMap，所以任何重复的键都将被覆盖，因此没有特定的检查

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-06-17T08:46:20.667

在 List 实现上使用 Set 实现可能会降低性能。在 Set 中插入元素时，您需要检查它是否重复。如果您打算只使用迭代器，请使用最简单的实现（ArrayList）。

我认为仅使用 Set 来传达信息并不是一个好主意。如果您自己添加项目并且可以保证不会添加重复项，那么使用 Set 毫无意义。使用适当的名称来传达有关集合的信息。此外，通过 Collection 接口公开它是一个好主意，特别是如果您的类的调用者只需要遍历集合。**

# c# - 让 WPF UserControl 删除自身和绑定的 Data-Object？

> ID：1005809
> 
> 赞同：0
> 
> 时间：2009-06-17T08:33:18.370
> 
> 标签：c#, wpf, user-controls

我在我的 MainWindow 中放置了一个 StackPanel，它在运行时动态获取新的 UserControls（UserControl 是一行 TextBoxes 和一个名为“Delete”的按钮）。这是关于我如何创建用户控件：

```
PersonObject p = new PersonObject;
List.Add(p);

UserControlLine usrCtrlLine = new UserControlLine();
usrCtrlLine.DataContext = p;

StackPanel.Children.Add(usrCtrlLine); 
```

现在用户控件包含这样的文本框：
TextBox TextWrapping="Wrap" Grid.Column="1" Text="{Binding Path=Firstname, Mode=TwoWay}"

我的问题是，我怎样才能让 UserControl
- 从 StackPanel 中删除自身（“删除”）
- 删除绑定到它的 PersonObject p？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T08:51:51.610

我不确定我是否理解您在这里要做什么...您想在 StackPanel 中显示人员列表？您应该使用 ItemsControl，将其 ItemsPanel 定义为 StackPanel，并将其 ItemTemplate 定义为 UserControlLine：

```
<ItemsControl ItemsSource="{Binding ListOfPersons}">
  <ItemsControl.ItemsPanel>
    <ItemsPanelTemplate>
      <StackPanel IsItemsHost="True"/>
    </ItemsPanelTemplate>
  </ItemsControl.ItemsPanel>
  <ItemsControl.ItemTemplate>
    <DataTemplate>
      <my:UserControlLine/>
    </DataTemplate>
  </ItemsControl.ItemTemplate>
</ItemsControl> 
```

要删除一个项目，只需将其从人员集合中删除，关联的 UserControlLine 也会从 ItemsControl 中删除（该集合应为 ObservableCollection）

# iphone - 在分组的表格视图中定位 UITableViewCellEditingStyleDelete 图标的任何好方法？

> ID：1005817
> 
> 赞同：1
> 
> 时间：2009-06-17T08:35:08.943
> 
> 标签：iphone

作为标题，我可以将 UITableViewCellEditingStyleDelete 按钮/图标定位在分组 tableview 的 tableviewcell 内而不是在它之外吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T18:42:09.670

[Matt Gallagher](http://cocoawithlove.com/) [博客文章](http://cocoawithlove.com/2009/01/multiple-row-selection-and-editing-in.html)的摘录揭示了一种方法

这是模仿您不想要的行为的原始代码：

```
- (void)setEditing:(BOOL)editing animated:(BOOL)animated
{
    [self setNeedsLayout];
}

- (void)layoutSubviews
{
    [UIView beginAnimations:nil context:nil];
    [UIView setAnimationBeginsFromCurrentState:YES];

    [super layoutSubviews];

    if (((UITableView *)self.superview).isEditing)
    {

        CGRect contentFrame = self.contentView.frame;
        contentFrame.origin.x = EDITING_HORIZONTAL_OFFSET;
        self.contentView.frame = contentFrame;
    }
    else
    {
        CGRect contentFrame = self.contentView.frame;
        contentFrame.origin.x = 0;
        self.contentView.frame = contentFrame;
    }

    [UIView commitAnimations];
} 
```

所以如果我们做出改变，我们可以让它做你想做的事：

```
- (void)setEditing:(BOOL)editing animated:(BOOL)animated
{
    [self setNeedsLayout];
}

- (void)layoutSubviews
{
    [UIView beginAnimations:nil context:nil];
    [UIView setAnimationBeginsFromCurrentState:YES];

    [super layoutSubviews];

    if (((UITableView *)self.superview).isEditing)
    {
        //don't resize and and move your frame here

        CGRect contentFrame = self.contentView.frame;
        contentFrame.origin.x = 0;
        self.contentView.frame = contentFrame;
    }
    else
    {
        CGRect contentFrame = self.contentView.frame;
        contentFrame.origin.x = 0;
        self.contentView.frame = contentFrame;
    }

    [UIView commitAnimations];
} 
```

您可能需要对此进行调整，但这是一个好的开始。

# asp.net-mvc - 我们可以对 MVC 的视图（'V'）进行单元测试吗？

> ID：1005819
> 
> 赞同：8
> 
> 时间：2009-06-17T08:35:29.863
> 
> 标签：asp.net-mvc, unit-testing

> 重复：[对视图进行单元测试？](https://stackoverflow.com/questions/151794/unit-testing-the-views)

有没有办法对视图进行单元测试？我确信我们可以测试模型和控制器，但不知道如何对视图进行单元测试？

这值得测试 View 吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-17T08:56:53.923

您可以 [启用 MVC 视图的编译](http://devermind.wordpress.com/2009/05/03/aspnet-mvc-tip-turn-on-compile-time-view-checking/)。这很有帮助。否则，我认为不值得。毕竟，您只对两件事感兴趣。视图是否编译并且您是否得到任何异常（null、越界异常或类似的）？

有些人声称您不应该在视图中包含*任何*逻辑。为任何事情编写助手。在这种情况下，编译几乎就是你想要的一切。

我们决定投资于 WatiN 测试。它测试视图并同时测试整个应用程序。有一些不错的助手，但需要不断维护。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-17T08:43:06.913

现在还没有查看废弃的代码吗？那你要测试什么？如果您正在测试控制器，那么您只需要一个成功的视图结果来表明该视图有效。而不是去预编译视图或其他什么的麻烦，这将开始拖任何相当大的项目在持续集成和构建方面。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T08:45:44.007

根据我的阅读（在 Steven Sanderson 的 Pro ASP.NET MVC 框架中），视图不被认为值得测试。可以使用各种引擎生成 ASP.NET MVC 视图，例如默认的轻量级 ASPX，或者例如[http://www.stringtemplate.org/](http://www.stringtemplate.org/)。对于 ASPX 输出，您可能会运行一些 HTML 语法检查工具，而对于其他视图引擎，视图编译成功的事实应该是一个足够好的测试；）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-17T08:55:52.070

我看不到对视图进行单元测试的意义，因为它们不包含太多逻辑。[但是，您可以使用WatiN 之](http://watin.sourceforge.net/)类的工具进行一些集成测试/UI 测试。

用 WatiN 编写的测试示例：

```
[Test]
public void SearchForWatiNOnGoogle()
{
   using (IE ie = new IE("http://www.google.com"))
   {
      ie.TextField(Find.ByName("q")).TypeText("WatiN");
      ie.Button(Find.ByName("btnG")).Click();

      Assert.IsTrue(ie.ContainsText("WatiN"));
  }
} 
```

您不应该尝试使用这样的工具测试所有内容。选择应用程序的一些关键功能，并为它们编写测试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-02-08T12:01:01.553

对于那些在测试视图中看不到价值的人......你如何确定视图在元素上具有正确的属性，或者它被正确绑定？

许多人回答“在更高级别”（例如运行站点并使用诸如 selenium 或等效工具之类的工具）。

然而，这些技术几乎不可能证明错误的根源在于视图本身，并且还需要对服务器端代码进行大量更改，以便可以以有针对性的方式呈现视图。

# database - 将数据从一个 Informix 数据库复制到另一个的脚本

> ID：1005824
> 
> 赞同：1
> 
> 时间：2009-06-17T08:36:34.837
> 
> 标签：database, scripting, informix

我需要将数据从一个 Informix 数据库复制到另一个。我不想使用 LOAD 来执行此操作。有什么脚本可以帮助我解决这个问题吗？有没有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T08:55:16.407

如果没有关于您拥有的 Informix 数据库类型的更多信息，很难准确地说出最适合您的选择是什么。

如果是少量表和大量数据，请查看 onunload、onload 和/或 High Performance Loader。（我假设我们在这里不是在谈论标准引擎。）

另一方面，如果您有很多表格并且 HPL 太繁琐，请查看 myexport/myimport（可在 iiug.org 网站上获得）。这些是标准 dbexport/dbimport 实用程序的非锁定等效项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T08:56:14.517

最简单的解决方案是备份数据库实例并将其还原到单独的实例。如果这对您来说不可能，那么还有其他可能性。

*   dbexport/dbimport
*   卸载/加载
*   手工制作的 SQL 插入

如果数据库结构相同，那么您可以使用 dbexport/dbimport，但是这会将数据卸载到平面文件中，无论是在文件系统中还是在磁带上，然后从平面文件中导入。

我通常发现如果数据库结构相同，那么加载/卸载是最简单的解决方案。

如果您不想使用加载/卸载 dbimport/dbexport，那么您可以使用直接 SQL INSERTS，如下所示（未经测试，您需要检查语法）

```
INSERT INTO dbname2@informix_server2:table
SELECT * FROM dbnam1e@informix_server1:table_name 
```

这当然意味着一致的表结构，如果结构不同，您可以使用列列表。

一个会引起问题的领域是参照完整性。如果您有外键，那么这会给您带来问题，因为您需要确保插入以正确的顺序完成。您可能还会遇到 SERIAL 列和 INSERTS 的问题。Load 不会遇到此问题，因为您可以将具有序列值的表加载到表中并保留原始值。

我经常发现最好的解决方案如下

*   从 database1 中获取模式。
*   将其分成两部分，初始部分是所有表创建语句，第二部分是所有 CREATE INDEX、引用完整性等语句。
*   从模式的第一部分创建 database2。
*   使用 UNLOAD/LOAD 将数据加载到 database2。
*   将模式的第二部分应用于 database2

这与 dbimport 经历的过程非常相似，但从历史上看，我一直无法使用 dbimport，因为我的数据库包含另一个数据库的同义词，而 dbimport 确实/不适用于这些。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T16:35:02.350

UNLOAD 和 LOAD 是最简单的方法。通过排除它们，您也排除了使用 DB-Load 和 DB-Access 以及 DB-Export 和 DB-Import。这些是最简单的方法。

如前所述，您可以考虑使用 HPL。

您还可以设置一个 ER 系统 - 它比 UNLOAD 后跟 LOAD 更难，但不使用禁止操作。

如果两台机器基本相同，可以考虑onunload和onload；我不会推荐它。

# objective-c - 屏幕保护程序中的生涩/抖动（核心）动画？

> ID：1005833
> 
> 赞同：4
> 
> 时间：2009-06-17T08:39:07.827
> 
> 标签：objective-c, macos, profiling, core-animation, osx-leopard

我为 Leopard 构建了一个使用核心动画的屏幕保护程序。它不会做任何过于复杂的事情；使用 CALayers 和 CATextLayers 树生成以下结构的数据“表”：

```
- root
  › maincontainer
    › subcontainer
      › row [multiple]
        › cell [multiple]
          › text layer 
```

任何时候屏幕上最多渲染 50 个 CALayer。

一旦我建立了“表”，我将使用 CABasicAnimation 添加动画“子容器”到视图中。同样，我没有做任何花哨的事情——只是一个简单的淡入。

问题是，虽然动画确实发生了，但观看起来很*痛苦。*在我的开发机器上，它是一个 3.06Ghz iMac，具有 4GB 的 RAM，并且似乎将动画分成 10 个步骤而不是显示渐变。

在屏幕保护程序的目标 ppc mac-mini 上情况变得更糟；它甚至拒绝播放动画，通常从动画开始（0％不透明度）到中途（50％）然后完成“补间”。

我对 ObjectiveC 比较陌生，我的经验是基于使用垃圾收集环境，但我不敢相信我在屏幕保护程序开始导致此类问题时泄漏了足够的内存。

另外，我很确定这不是硬件问题。我已经测试了使用核心动画的内置屏幕保护程序，并下载了一些免费的基于 CA 进行比较，它们在两台机器上都可以正常运行。

关于在屏幕保护程序中使用 CA 或在一般情况下使用 CA 的信息在 Google 上非常少，而且关于配置/麻烦屏幕保护程序的建议/教程似乎不存在。因此，社区可以提供的任何帮助都将受到欢迎！

**- - 更新 - -**

似乎隐式动画有助于使事情变得更平滑。仍然有点生涩，但没有像我的解决方案那样尝试使用显式动画为所有内容设置动画那么糟糕。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T23:43:45.187

屏幕保护程序没有什么特别之处。我假设您已经从[核心动画编程指南](http://developer.apple.com/documentation/Cocoa/Conceptual/CoreAnimation_guide/Introduction/Introduction.html)开始？通过 Instruments 运行它会给你很多关于你在哪里花费太多时间的信息。

您用来进行淡入的代码会很有用。对于您所描述的，您甚至不需要 CABasicAnimation；你可以只设置图层的动画属性，默认情况下它们是动画的。确保你已经阅读了[Implicit Animations](http://developer.apple.com/documentation/Cocoa/Conceptual/CoreAnimation_guide/Articles/AnimatingLayers.html#//apple_ref/doc/uid/TP40006085-SW7)。该页面的其余部分可能也有用。

你在 CoreAnimation 中的大部分工作都是不碍事的。我一般都知道它在做什么，而大多数问题来自第二次猜测它试图告诉它太多。

# iis-5 - 将 Web 应用程序部署到 IIS 时无法连接到数据库

> ID：1005845
> 
> 赞同：1
> 
> 时间：2009-06-17T08:41:41.583
> 
> 标签：iis-5

我已经开发了一个应用程序，它工作正常，但是当我在 IIS 中为它创建一个虚拟目录并运行应用程序时，我得到连接失败异常和命名管道异常。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T08:46:24.303

如果没有任何代码或语言的详细信息，很难猜出问题可能是什么，但是在 asp.net 中出现的常见问题可能是您的数据库连接字符串。您是否在应用程序中使用 SQl Server / Sql Server Express 数据库？您需要检查连接字符串。

问题是连接字符串中的 Integrated Security=True 设置。IIS 使用 ASPNET windows 登录，这与从 VS 运行时使用的 Windows 登录不同。你有几个选择：

1.  授予 ASPNET 用户对数据库所需的访问权限
2.  使用 Sql Server 身份验证：在数据库上设置一个用户作为 sql 登录名并将此用户名/密码传入连接字符串并设置 Integrated Security=False
3.  将运行 IIS 的身份更改为有权访问数据库的身份。

可能还有其他选择，但我认为这些是最常见的。选择哪个取决于您要部署到的体系结构，就我个人而言，我几乎总是使用用户名和密码进行 Sql Server 身份验证。如果需要，可以对 web.config 进行加密以提高安全性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T08:51:46.913

看起来您的应用程序的数据库连接存在一些问题。您能否发布您的代码和错误的确切性质。

# php - 如何从存储在变量中的字符串调用函数？

> ID：1005857
> 
> 赞同：325
> 
> 时间：2009-06-17T08:44:22.980
> 
> 标签：php, dynamic-function

我需要能够调用一个函数，但是函数名存储在一个变量中，这可能吗？例如：

```
function foo ()
{
    //code here
}

function bar ()
{
    //code here
}

$functionName = "foo";
// I need to call the function based on what is $functionName 
```

* * *

## 回答 #1

> 赞同：509
> 
> 时间：2009-06-17T08:50:33.297

[`$functionName()`](http://php.net/manual/en/functions.variable-functions.php)或者[`call_user_func($functionName)`](http://php.net/manual/en/function.call-user-func.php)

* * *

## 回答 #2

> 赞同：144
> 
> 时间：2013-09-20T08:42:12.217

我最喜欢的版本是内联版本：

```
${"variableName"} = 12;

$className->{"propertyName"};
$className->{"methodName"}();

StaticClass::${"propertyName"};
StaticClass::{"methodName"}(); 
```

您也可以将变量或表达式放在括号内！

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2018-09-14T18:47:55.487

# 解决方案：使用PHP7

**注意：**有关摘要版本，请参阅答案末尾的 TL；DR。

## 旧方法

**更新**：这里解释的旧方法之一已被删除。有关其他方法的说明，请参阅其他答案，此处不再赘述。顺便说一句，如果这个答案对您没有帮助，您应该返回升级您的东西。PHP 5.6 支持已于 2019 年 1 月结束（现在甚至不支持 PHP 7.1 和 7.2）。有关详细信息，请参阅[支持的版本](https://www.php.net/supported-versions.php)。

正如其他人所提到的，在 PHP5（以及 PHP7 等较新版本）中，我们可以使用变量作为函数名、使用`call_user_func()`和`call_user_func_array()`（我个人讨厌这些函数）等。

## 新方法

从 PHP7 开始，引入了新的方法：

**注意：**括号内的所有内容都`<something>`表示一个或多个表达式来形成某物，例如`<function_name>`表示形成函数名的表达式。

### 动态函数调用：动态函数名称

我们可以一次性使用括号内的一个或多个表达式作为函数名，形式如下：

```
(<function_name>)(arguments); 
```

例如：

```
function something(): string
{
    return "something";
}

$bar = "some_thing";

(str_replace("_", "", $bar))(); // something

// Possible, too; but generally, not recommended, because makes your code more complicated
(str_replace("_", "", $bar))()(); 
```

**注意：**虽然去掉括号`str_replace()`不是错误，但放置括号会使代码更具可读性。但是，有时您不能这样做，例如在使用`.`运算符时。为了保持一致，我建议您始终放置括号。

### 动态方法调用：动态方法名称

就像动态函数调用一样，我们可以对方法调用做同样的事情，用花括号而不是括号括起来（对于额外的形式，导航到 TL;DR 部分）：

```
$object->{<method_name>}(arguments);
$object::{<method_name>}(arguments); 
```

在一个例子中看到它：

```
class Foo
{
    public function another(): string
    {
        return "something";
    }
}

$bar = "another thing";

(new Something())->{explode(" ", $bar)[0]}(); // something 
```

### 动态方法调用：数组语法

PHP7 中添加的更优雅的方式如下：

```
[<object>, <method_name>](arguments);
[<class_name>, <method_name>](arguments); // Static calls only 
```

举个例子：

```
class Foo
{
    public function nonStaticCall()
    {
        echo "Non-static call";
    }
    public static function staticCall()
    {
        echo "Static call";
    }
}

$x = new X();

[$x, "non" . "StaticCall"](); // Non-static call
[$x, "static" . "Call"](); // Static call 
```

**注意：**与前一种方法相比，使用此方法的好处是，您不必关心调用类型（即是否为静态）。

**注意：**如果您关心性能（和微优化），请不要使用此方法。正如我测试的那样，这种方法确实比其他方法慢（10倍以上）。

### 额外示例：使用匿名类

让事情变得有点复杂，您可以使用[匿名类](http://php.net/manual/en/language.oop5.anonymous.php)和上述功能的组合：

```
$bar = "SomeThing";

echo (new class {
    public function something()
    {
        return 512;
    }
})->{strtolower($bar)}(); // 512 
```

## TL;DR（结论）

一般来说，在 PHP7 中，使用以下形式都是可能的：

```
// Everything inside `<something>` brackets means one or more expressions
// to form something

// Dynamic function call
(<function_name>)(arguments)

// Dynamic method call on an object
$object->{<method_name>}(arguments)
$object::{<method_name>}(arguments)

// Dynamic method call on a dynamically-generated object
(<object>)->{<method_name>}(arguments)
(<object>)::{<method_name>}(arguments)

// Dynamic method call, statically
ClassName::{<method_name>}(arguments)
(<class_name>)::{<method_name>}(arguments)

// Dynamic method call, array-like (no different between static and non-static calls
[<object>, <method_name>](arguments)

// Dynamic method call, array-like, statically
[<class_name>, <method_name>](arguments) 
```

特别感谢[这个 PHP 演讲](https://talks.php.net/vienna17)。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2009-06-17T08:46:35.893

是的，有可能：

```
function foo($msg) {
    echo $msg."<br />";
}
$var1 = "foo";
$var1("testing 1,2,3"); 
```

来源：[http ://www.onlamp.com/pub/a/php/2001/05/17/php_foundations.html?page=2](http://www.onlamp.com/pub/a/php/2001/05/17/php_foundations.html?page=2)

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2013-01-31T14:05:11.340

如前所述，有几种方法可以实现这一点，可能是最安全的方法，`call_user_func()`或者如果必须，您也可以采用`$function_name()`. 可以使用这两种方法传递参数

```
$function_name = 'foobar';

$function_name(arg1, arg2);

call_user_func_array($function_name, array(arg1, arg2)); 
```

如果您正在调用的函数属于一个对象，您仍然可以使用其中任何一个

```
$object->$function_name(arg1, arg2);

call_user_func_array(array($object, $function_name), array(arg1, arg2)); 
```

但是，如果您要使用该`$function_name()`方法，如果名称以任何方式动态，则测试该函数的存在可能是一个好主意

```
if(method_exists($object, $function_name))
{
    $object->$function_name(arg1, arg2);
} 
```

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2016-02-27T22:50:47.510

晚了几年，但这是现在最好的方式恕我直言：

```
$x = (new ReflectionFunction("foo"))->getClosure();
$x(); 
```

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2012-05-30T11:29:35.300

万一其他人被谷歌带到这里，因为他们试图在类中使用变量作为方法，下面是一个实际工作的代码示例。以上都不适用于我的情况。关键区别在于`&`声明`$c = & new...`和`&$c`传入`call_user_func`。

我的具体情况是在实现与颜色和两个成员方法`lighten()`以及`darken()`来自 csscolor.php 类有关的某人的代码时。无论出于何种原因，我希望相同的代码能够调用变亮或变暗，而不是用逻辑选择它。这可能是我固执地不只使用 if-else 或更改调用此方法的代码的结果。

```
$lightdark="lighten"; // or optionally can be darken
$color="fcc";   // a hex color
$percent=0.15;  
include_once("csscolor.php");
$c = & new CSS_Color($color);
$rtn=call_user_func( array(&$c,$lightdark),$color,$percent); 
```

请注意，尝试任何方法都`$c->{...}`不起作用。在仔细阅读 php.net 页面底部的读者提供的内容后`call_user_func`，我能够将上述内容拼凑起来。另外，请注意，`$params`作为数组对我**不起作用**：

```
// This doesn't work:
$params=Array($color,$percent);
$rtn=call_user_func( array(&$c,$lightdark),$params); 
```

上述尝试将警告该方法需要第二个参数（百分比）。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2009-06-17T09:00:39.063

为了完整起见，您还可以使用[eval()](http://www.php.net/eval)：

```
$functionName = "foo()";
eval($functionName); 
```

然而，[`call_user_func()`](http://php.net/manual/en/function.call-user-func.php)是正确的方法。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2014-02-02T16:19:30.420

## 动态函数名称和命名空间

只是在使用命名空间时添加关于动态函数名称的一点。

如果您正在使用命名空间，**则以下内容将不起作用**，除非您的函数位于全局命名空间中：

```
namespace greetings;

function hello()
{
    // do something
}

$myvar = "hello";
$myvar(); // interpreted as "\hello();" 
```

## 该怎么办？

您必须`call_user_func()`改用：

```
// if hello() is in the current namespace
call_user_func(__NAMESPACE__.'\\'.$myvar);

// if hello() is in another namespace
call_user_func('mynamespace\\'.$myvar); 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2014-11-26T12:17:38.830

如果要调用对象的方法，可以补充@Chris K 的答案，可以在闭包的帮助下使用单个变量来调用它：

```
function get_method($object, $method){
    return function() use($object, $method){
        $args = func_get_args();
        return call_user_func_array(array($object, $method), $args);           
    };
}

class test{        

    function echo_this($text){
        echo $text;
    }
}

$test = new test();
$echo = get_method($test, 'echo_this');
$echo('Hello');  //Output is "Hello" 
```

[我在这里](https://stackoverflow.com/a/27148640/428640)发布了另一个示例

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2019-03-29T07:46:47.137

## 我从这个问题和答案中学到了什么。谢谢大家！

假设我有这些变量和函数：

```
$functionName1 = "sayHello";
$functionName2 = "sayHelloTo";
$functionName3 = "saySomethingTo";

$friend = "John";
$datas = array(
    "something"=>"how are you?",
    "to"=>"Sarah"
);

function sayHello()
{
echo "Hello!";
}

function sayHelloTo($to)
{
echo "Dear $to, hello!";
}

function saySomethingTo($something, $to)
{
echo "Dear $to, $something";
} 
```

1.  调用**不带参数的函数**

    ```
    // Calling sayHello()
    call_user_func($functionName1); 
    ```

    > 你好！

2.  **使用 1 个参数**调用函数

     **```
    // Calling sayHelloTo("John")
    call_user_func($functionName2, $friend); 
    ```

    > 亲爱的约翰，你好！** 
***   **使用 1 个或多个参数**调用函数 如果您动态调用函数并且每个函数具有不同数量的参数，这将很有用。这是我一直在寻找（并解决）的案例。**`call_user_func_array`**是关键

    ```
    // You can add your arguments
    // 1\. statically by hard-code, 
    $arguments[0] = "how are you?"; // my $something
    $arguments[1] = "Sarah"; // my $to

    // 2\. OR dynamically using foreach
    $arguments = NULL;
    foreach($datas as $data) 
    {
        $arguments[] = $data;
    }

    // Calling saySomethingTo("how are you?", "Sarah")
    call_user_func_array($functionName3, $arguments); 
    ```

    > 亲爱的莎拉，你好吗？** 

 **再见！

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-06-17T08:47:45.360

使用 call_user_func 函数。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2021-04-07T00:44:27.973

如果您在对象上下文中尝试动态调用函数，请尝试以下代码：

```
$this->{$variable}(); 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2015-02-24T09:35:02.777

以下代码有助于在 PHP 中编写动态函数。现在函数名可以通过变量'$current_page'动态改变。

```
$current_page = 'home_page';
$function = @${$current_page . '_page_versions'};
$function = function() {
    echo 'current page';
};
$function(); 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2019-11-25T09:19:07.873

使用存储在变量中的名称安全地调用函数的最简单方法是，

```
//I want to call method deploy that is stored in functionname 
$functionname = 'deploy';

$retVal = {$functionname}('parameters'); 
```

我使用如下方式在 Laravel 中动态创建迁移表，

```
foreach(App\Test::$columns as $name => $column){
        $table->{$column[0]}($name);
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-10-19T07:20:32.860

考虑到这里给出的一些优秀答案，有时您需要精确。例如。

1.  如果一个函数有一个返回值，例如（布尔值、数组、字符串、整数、浮点数等）。
2.  如果函数没有返回值检查
3.  如果函数存在

让我们看看它对给出的一些答案的功劳。

```
Class Cars{
        function carMake(){
        return 'Toyota';
        }
        function carMakeYear(){
        return 2020;
        }
        function estimatedPriceInDollar{
        return 1500.89;
        }
        function colorList(){
        return array("Black","Gold","Silver","Blue");
        }
        function carUsage(){
        return array("Private","Commercial","Government");
        }
    function getCar(){
    echo "Toyota Venza 2020 model private estimated price is 1500 USD";
    }
 } 
```

我们要检查方法是否存在并动态调用它。

```
$method = "color List";
        $class = new Cars();
        //If the function have return value;
        $arrayColor = method_exists($class, str_replace(' ', "", $method)) ? call_user_func(array($this, $obj)) : [];
        //If the function have no return value e.g echo,die,print e.t.c
     $method = "get Car";
        if(method_exists($class, str_replace(' ', "", $method))){
        call_user_func(array($this, $obj))
        } 
```

谢谢

* * *

## 回答 #17

> 赞同：-5
> 
> 时间：2018-06-10T23:53:58.097

我想到的一种非常规方法是，*除非您通过一些超自主的 AI 自己编写来生成整个代码*，否则您想要“动态”调用的函数很有可能已经在您的代码中定义根据。那么，为什么不检查绳子并跳起臭名昭著的`ifelse`舞蹈来召唤……你明白我的意思。

例如。

```
if($functionName == 'foo'){
  foo();
} else if($functionName == 'bar'){
  bar();
} 
```

如果您不喜欢梯子的平淡味道，甚至`switch-case`可以使用。`ifelse`

我知道在某些情况下“*动态调用函数*”是绝对必要的（*就像一些修改自身的递归逻辑*）。但是大多数日常琐碎的用例都可以避开。

它消除了您的应用程序中的许多不确定性，同时让您有机会在字符串与任何可用函数的定义不匹配时执行回退函数。恕我直言。

* * *

## 回答 #18

> 赞同：-10
> 
> 时间：2009-06-17T08:50:51.750

我不知道你为什么要使用它，对我来说听起来一点也不好，但如果只有少量函数，你可以使用 if/elseif 构造。我不知道是否可以直接解决。

类似 $foo = "bar"; $test = "foo"; 回声$$测试；

应该返回吧，您可以尝试一下，但我认为这不适用于函数**

# mysql - MySQL 字段长度错误

> ID：1005862
> 
> 赞同：1
> 
> 时间：2009-06-17T08:45:26.193
> 
> 标签：mysql

刚将一个站点移到新服务器上，我们就开始遇到一些错误。主要是我们传递到 MySQL 表中的一些数据对于该字段来说太长了。通过数据库检查后，旧服务器似乎正在截断数据以适合表，但新服务器会引发 TEP STOP。有什么想法可以重新打开它，暂时让东西重新工作吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T09:05:06.777

MySQL 曾经因默默地“纠正”它无法直接存储的数据（过长的字符串、无效的日期）等而闻名/臭名昭著。幸运的是，这在最近的版本中发生了变化。

您现在可以使用“服务器 SQL 模式”配置此行为。您可能想要关闭 STRICT_ALL_TABLES 或 STRICT_TRANS_TABLES。

有关详细信息，请参阅[MySQL 的文档](http://dev.mysql.com/doc/refman/5.1/en/server-sql-mode.html)。

# c# - 如何使用 C# 删除 Windows 用户帐户文件夹？

> ID：1005871
> 
> 赞同：2
> 
> 时间：2009-06-17T08:47:16.627
> 
> 标签：c#, windows

我有创建一些 Windows 用户帐户的应用程序，卸载时我删除了 Windows 用户帐户，但该用户的文件夹仍然存在（例如 C:\Documents and Settings\UserName\"

如何使用 C# 删除该文件夹？

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T08:55:58.590

类似的东西？

```
DirectoryInfo dir = new DirectoryInfo(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData));
dir = dir.Parent.Parent.Parent;
DirectoryInfo[] userDirs = dir.GetDirectories(userName);

foreach (DirectoryInfo userDir in userDirs)
{
    userDir.Delete(true);
} 
```

# clipboard - 从剪贴板获取图像并保存图像

> ID：1005877
> 
> 赞同：-1
> 
> 时间：2009-06-17T08:48:24.253
> 
> 标签：clipboard

event.clipboardData.setData('image/jpg', "mapImage");

如何使用此代码从剪贴板获取图像以及如何发送电子邮件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-02-04T13:35:46.563

我不太记得 javascript 方法，如果您使用的是 javascript，但无论如何，获取图像很可能就像用 'get' 替换 'set' 一样简单：

```
var img = event.clipboardData.getData("mapImage"); 
```

至于发送电子邮件，我认为它是这样的：

```
<button onclick="mailto:fred@example.com">Send Email</button> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-02-03T17:27:06.713

尽管 AFAIK 在提出这个问题时这是不可能的，但我想指出今天这是可能的，至少在 Google Chrome 中是这样。他们实现了它以在 GMail 中使用，但它适用于所有网站。

[剪贴板中的粘贴图像功能如何在 Gmail 和 Google Chrome 12+ 中工作？](https://stackoverflow.com/questions/6333814/how-does-the-paste-image-from-clipboard-functionality-work-in-gmail-and-google-c)

# jquery - 奇怪的jQuery问题

> ID：1005884
> 
> 赞同：1
> 
> 时间：2009-06-17T08:49:24.610
> 
> 标签：jquery, asp.net-mvc

下面的 jQuery 获取包含地址的 html 表的部分视图。jqModal 然后用于显示地址，鼠标悬停用于突出显示地址。这在我的本地机器上运行良好。当我尝试从服务器（Win 2008，IIS 7）运行它时，地址显示在 jqModal 中，但高亮显示失败。此外，这在从服务器浏览时也能正常工作。

```
<script>
$(document).ready(function() {

    $("#Search").click(function() {
        displayAddressList();
    });
    $('#dialog').jqm();

});

function displayAddressList() {
   var PostCode = $("#tbSearch").val();
   var url = '<%= Url.Action("AddressSearch", "Addresses")%>';
   $.get(url, { PostCode: PostCode }, function(data) {
   $("#dialog").html(data);

       $('table#data_table tr').mouseover(function() {
           $(this).addClass('selectedRow');
       }).mouseout(function() {
           $(this).removeClass('selectedRow');
       });   

   }); 
}
</script>

<style>  
  .selectedRow {   
     background-color: white;   
     cursor: pointer;   
  }   
</style>  

<div class="jqmWindow" id="dialog">
    <a href="#" class="jqmClose">Close</a>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T09:09:22.977

如果您不关心 Internet Explorer 6 支持，则可以改为在 CSS 中实现行突出显示。

```
#data_table tr:hover {
  background-color: white;
  cursor: pointer;
} 
```

如果您这样做，请确保在您的 HTML 页面顶部有一个有效的 DOCTYPE 声明。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T09:09:57.407

你说只有亮点不起作用。通常，您希望为此使用 jQuery 的`live`功能： http: [//docs.jquery.com/Events/live](http://docs.jquery.com/Events/live) - 它旨在在 ajax 调用（或其他 DOM 更改）之后绑定事件。您只需在 调用一次`$(document).ready`，而不是每次加载数据时调用。

另一个常见的选项是页面上有多个`#data_table`（可能是隐藏的），jQuery 只会找到第一个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T09:23:25.257

我同意 DrJokepu 的观点：看起来您的 Ajax 正在从 localhost 请求数据（因此它只能在您的开发机器上工作或在服务器上浏览时）。

你能在诸如[Firebug](http://getfirebug.com/)（或IE 的[Fiddler](http://www.fiddler2.com/fiddler2/)）之类的东西中检查 Ajax 请求，看看它们是否真的被制作了？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T08:55:38.760

也许它不喜欢：

```
$('table#data_table tr') 
```

尝试将该选择器更改为：

```
$('#data_table tr') 
```

否则，尝试使用不同的 CSS 属性，也许那些特定的属性没有被应用。当然，这一切都可能**遥不可及**，但尝试一下也无妨。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T09:15:35.740

我会添加一些警报，以便您查看是否实际发生了任何事情。你也把你的css设置为背景：白色 - 所以你真的会看到任何变化 - 它应该是一种颜色吗？！

乔什

# java - 从 Java 调用 matlab 回调/函数句柄

> ID：1005887
> 
> 赞同：6
> 
> 时间：2009-06-17T08:49:56.480
> 
> 标签：java, matlab, callback, function-handle

如何将 matlab 函数句柄传递给 Java 对象并从 Java 中调用它（也就是说，我希望 Java 在准备好计算时告诉 matlab）。我正在尝试使用 com.mathworks.jmi.Matlab 类来评估 Java 对象中的 Matlab 表达式，但我看不到如何 1）将回调函数句柄传输到 Java，以及 2）从 Java 调用它可能使用com.mathworks.jmi.Matlab 类。

谢谢，雅各布

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T13:04:57.807

唔。看起来 JMI 是 matlab 内部的东西之一，在未来的版本中可能会发生变化。我找到了这些在线文章，不确定它们是否会对您的情况有所帮助。

*   [http://www.mathworks.com/matlabcentral/newsreader/view_thread/239803](http://www.mathworks.com/matlabcentral/newsreader/view_thread/239803)
*   [http://www.mathworks.co.uk/matlabcentral/newsreader/view_thread/250598](http://www.mathworks.co.uk/matlabcentral/newsreader/view_thread/250598)
*   [http://www.cs.virginia.edu/~whitehouse/matlab/JavaMatlab.html](http://www.cs.virginia.edu/~whitehouse/matlab/JavaMatlab.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-30T18:20:43.227

恐怕我不知道有一种方法可以**完全按照**您的要求进行操作，但是您可以通过两种方式执行类似的操作：

1) 如果你在 Matlab 中设置了一个 Java 回调，你可以给它发送一个 Matlab 函数句柄。当引发 Java 回调事件时，将调用您的 Matlab 函数。可以在此处找到一个示例：http: [//UndocumentedMatlab.com/blog/uicontrol-callbacks/](http://undocumentedmatlab.com/blog/uicontrol-callbacks/)。请注意，这不需要 JMI 来运行。

2) JMI 需要一个字符串（函数名或命令行）供 Matlab 评估。如果您事先知道函数名称，则可以使用它。否则，您可以准备一个 Matlab switch-yard 函数（其名称是预先知道的）来动态地将您的回调指向适当的 Matlab 动作。

计划4月中旬在[http://UndocumentedMatlab.com](http://UndocumentedMatlab.com)网站上发表一篇关于JMI的文章，敬请期待……

亚尔奥特曼

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-07-08T23:55:42.110

[matlabcontrol](http://matlabcontrol.googlecode.com)是一个 Java API，可让您执行此操作。它可以使用 feval 调用 MATLAB 函数。它不能直接对函数句柄进行操作，但正如 KitsuneYMG 所说，您可以使用[func2str](http://www.mathworks.com/help/techdoc/ref/func2str.html)将函数句柄转换为字符串。要开始，您可以查看[演练](http://code.google.com/p/matlabcontrol/wiki/Walkthrough)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-29T13:42:43.567

要将回调传递给 matlab，请将 matlab 函数的名称及其参数传递给 com.mathworks.jmi.Matlab.feval("matlabControlcb", ... , 0); ... 是一个 Object[]，其中 [0] = 命令和 [1..end] = 参数。

另见：FEVAL FUNC2STR

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-19T22:13:23.633

试试这个工具：http: [//jamal.sourceforge.net/](http://jamal.sourceforge.net/)

它完全符合您的需要并且有据可查。

它基于的主要原理是对在 Matlab 中运行的服务器部分进行 RMI 调用。输出返回给java程序。同样，这取决于jmi ...

# .net - 如何在 C++/CLI 中转发声明委托？

> ID：1005892
> 
> 赞同：1
> 
> 时间：2009-06-17T08:50:46.883
> 
> 标签：.net, syntax, c++-cli, delegates, forward-declaration

如何？

以下没有工作：

```
delegate MyDelegate;
ref class MyDelegate;
delegate void MyDelegate; 
```

申报工作如下：

```
public delegate void MyDelegate(Object ^sender, MyArgs ^args); 
```

但是使用它作为前向声明给了我

```
error C3756: 'MyNameSpace::MyDelegate': delegate definition conflicts with an existing symbol 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-18T13:18:52.607

这项工作是给我的；

stdafx.h：

```
public delegate void Handler(bool isit); 
```

cli1.cpp：

```
#include "stdafx.h"
using namespace System;

namespace MY {
   namespace Namespace
   {
       public ref class Objeks
       {
           public: Objeks() {}
           public: event Handler^ OnHandler;
           public: void __clrcall Runner(bool checkit)
           {
              if(&Objeks::OnHandler != nullptr) 
                OnHandler(checkit);
           }
       };
   }
} 
```

我大部分时间都单独保留了默认的 VS 2010 C++/CLI 项目，我希望如果您遇到前向声明的麻烦，使用命名空间系统；也会进入标题的:)

也许你不想使用事件？但它似乎只是简单的结构。

我在考虑后添加了错误检查（[Error Compiling C++/CLI Delegate call using Predicate with Array::FindAll()](https://stackoverflow.com/questions/649633/error-compiling-c-cli-delegate-call)）。

# java - 在 Java 中实现抽象方法时是否应该添加 @Override 注释？

> ID：1005898
> 
> 赞同：56
> 
> 时间：2009-06-17T08:52:07.800
> 
> 标签：java, annotations, overriding, abstract

在 Java 中重写非虚拟方法时，`@Override`建议使用注解，但如果我实现抽象方法怎么办？我`@Override`也应该使用吗？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2009-06-17T08:56:13.533

在这种情况下，我倾向于使用`@Override`，以便如果超类发生更改（完全删除该方法或更改其签名等），该方法会在子类中被标记。

唯一真正的区别是，如果没有注释，如果超类/接口中的方法被更改或删除，所讨论的实现只是成为该类的“正常”方法。因此，如果您只是为了履行合同而实施该方法，则应该添加注释；如果该方法在您的类中有意义，则您可能不应该添加它，而不管任何实现的接口或继承的抽象方法。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-06-17T08:56:34.610

是的——它再次告诉编译器，“我真的很想在这里覆盖一个方法。如果*没有*相应的方法可以覆盖，我就犯了一个错误，想被告知！”

就我个人而言，我认为这只是一个注释而不是语言的一部分（就像在 C# 中一样），但这是事后诸葛亮的好处，当然。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-06-17T08:56:26.343

是的。Joshua Bloch 在 Effective Java 中推荐的做法。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-01-05T10:32:21.710

实际上，Joshua Bloch 在*Effective Java (2nd Ed.)*第 178 页的最后一段中说，重写抽象方法的具体类的方法不必使用`Override`注解，因为编译器无论如何都会给出错误。但是，“这样做并无害处”。

我建议选择一种策略并始终如一地坚持下去。

# visual-studio - 如何使用 CMake 和 Visual Studio 设置路径环境变量来运行测试

> ID：1005901
> 
> 赞同：44
> 
> 时间：2009-06-17T08:53:07.893
> 
> 标签：visual-studio, dll, build, cmake

我正在使用 CMake 生成 Visual Studio 项目文件。我想在设置 PATH 环境变量后运行测试可执行文件，以便它能够加载所需的 dll。我按照[http://www.mail-archive.com/cmake@cmake.org/msg21493.html](http://www.mail-archive.com/cmake@cmake.org/msg21493.html)上的讨论进行了尝试，但它不起作用。

您是否为此目的使用了 CMake 和 Visual Studio？请分享您的经验。

此外，我发现调试我的 CMake 脚本没有简单的方法，例如查看它分配给 PATH 变量的值。设置 CMake 详细信息`CMAKE_VERBOSE_MAKEFILE`并没有帮助。我将如何自己调试它？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-08-20T17:47:46.313

要从 CMake 在 Visual Studio 中设置自定义项目设置，您可以使用 XML 文件作为模板，该模板可以从 CMake 配置为用作`.user`文件。
在我的工作中，我们使用它来设置自定义调试参数。

检查包含生成`.vcxproj`文件的目录以获取文件中的用户设置`.user`。这是我们使用的示例`UserTemplate.vcxproj.user`文件的片段。

```
 <?xml version="1.0" encoding="Windows-1252"?>
      <VisualStudioUserFile
        ProjectType="Visual C++"
        Version="9.00"
        ShowAllFiles="false"
        >
        <Configurations>
            <Configuration
                Name="Debug|@USERFILE_PLATFORM@"
                >
                <DebugSettings
                    Command="@USERFILE_COMMAND_DEBUG@"
                    WorkingDirectory="@USERFILE_WORKING_DIRECTORY_DEBUG@"
                    CommandArguments="@USERFILE_COMMAND_ARGUMENTS_DEBUG@"
                    Attach="false"
                    DebuggerType="3"
                    Remote="1"
                    RemoteMachine="@USERFILE_REMOTE_MACHINE_DEBUG@"
                                <!-- More settings removed for snippet -->
                />
            </Configuration>
                <!-- Rest of Configurations --> 
```

`UserTemplate.vcxproj.user`设置 PATH 变量的另一个示例 是：

```
 <?xml version="1.0" encoding="utf-8"?>
    <Project ToolsVersion="15.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
      <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
        <LocalDebuggerEnvironment>PATH=..\Your_path;%PATH%".</LocalDebuggerEnvironment>
        <DebuggerFlavor>WindowsLocalDebugger</DebuggerFlavor>
      </PropertyGroup>
    </Project> 
```

将文件设置在您的`UserTemplate.vcxproj.user`文件旁边`CMakeLists.txt`，您可以将任何需要的变量从 CMake 注入到`.vcxproj.user`您构建的项目的文件中。在 CMake 中，您可以设置适当的 CMake 变量（如果需要，还可以在模板文件中添加更多变量）。接下来，您可以执行类似的操作来配置文件。

```
 # Find user and system name
    SET(SYSTEM_NAME $ENV{USERDOMAIN} CACHE STRING SystemName)
    SET(USER_NAME $ENV{USERNAME} CACHE STRING UserName)

    # Configure the template file
    SET(USER_FILE ${_projectName}.vcxproj.${SYSTEM_NAME}.${USER_NAME}.user)
    SET(OUTPUT_PATH ${CMAKE_CURRENT_BINARY_DIR}/${USER_FILE})
    CONFIGURE_FILE(UserTemplate.vcxproj.user${USER_FILE} @ONLY) 
```

如果你不关心系统和用户名，下面的配置就足够了。

```
 # Configure the template file
    SET(USER_FILE ${_projectName}.vcxproj.user)
    SET(OUTPUT_PATH ${CMAKE_CURRENT_BINARY_DIR}/${USER_FILE})
    CONFIGURE_FILE(UserTemplate.vcxproj.user ${USER_FILE} @ONLY) 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-07-03T12:05:46.573

现在才发现这个问题。要调试我使用的 cmake 文件

```
MESSAGE( STATUS "static text ${variable}" ) 
```

我从来不需要设置路径让我的测试运行。你在用 CTest 吗？看起来您所关注的链接与 ctest 一起使用。

如果我试图让它工作，我会`set_tests_properties`首先明确使用。

```
set_tests_properties(SomeTest PROPERTIES ENVIRONMENT "PATH=c:\somedir;c:\otherdir") 
```

然后让它更通用。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-09-29T10:22:35.293

这是相关的 CMake 功能请求报告：

[http://www.kwwidgets.org/Bug/view.php?id=8884](http://www.kwwidgets.org/Bug/view.php?id=8884)

更新：根据[使用 CMake 设置 Visual Studio 项目“自定义环境变量”设置解决](https://gitlab.kitware.com/cmake/cmake/issues/8884)- 感谢 Florian 在下面的评论。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-11-25T20:55:41.433

[`VS_USER_PROPS`](https://cmake.org/cmake/help/latest/prop_tgt/VS_USER_PROPS.html)您可以使用新的目标属性（版本> = 3.8）全局提供任何选项。

这是一个工作示例：

**CMakeLists.txt**

```
cmake_minimum_required(VERSION 3.0)

project(SetEnvPathTest)

file(WRITE main.cpp [=[
// http://en.cppreference.com/w/cpp/utility/program/getenv
#include <iostream>
#include <cstdlib>

int main()
{
    if(const char* env_p = std::getenv("PATH"))
        std::cout << "Your PATH is: " << env_p << '\n';
}
]=])
add_executable(${PROJECT_NAME} main.cpp)

file(WRITE "${CMAKE_CURRENT_BINARY_DIR}/${PROJECT_NAME}.Cpp.user.props" [=[
<?xml version="1.0" encoding="utf-8"?> 
<Project DefaultTargets="Build" ToolsVersion="15.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <LocalDebuggerEnvironment>PATH=C:\Test</LocalDebuggerEnvironment>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <LocalDebuggerEnvironment>PATH=C:\Test</LocalDebuggerEnvironment>
  </PropertyGroup>
</Project>
]=])

set_target_properties(
    ${PROJECT_NAME}
    PROPERTIES
        VS_USER_PROPS "${PROJECT_NAME}.Cpp.user.props"
) 
```

### 参考

*   [CMake 问题 #8884：使用 CMake 设置 Visual Studio 项目“自定义环境变量”设置](https://gitlab.kitware.com/cmake/cmake/issues/8884)
*   [设置诊断：来自 CMakeLists.txt 的插入符号](https://stackoverflow.com/questions/45328353/set-diagnosticscaret-from-cmakelists-txt)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2019-11-04T05:49:55.840

Cmake has a VS_DEBUGGER_ENVIRONMENT property which can be used to set the custom PATH

[https://cmake.org/cmake/help/v3.13/prop_tgt/VS_DEBUGGER_ENVIRONMENT.html](https://cmake.org/cmake/help/v3.13/prop_tgt/VS_DEBUGGER_ENVIRONMENT.html)

```
set(MY_PATH "PATH=%PATH%" ${MY_CUSTOM_PATH})
set_target_properties(MyTarget PROPERTIES VS_DEBUGGER_ENVIRONMENT "{MY_PATH}") 
```

Some other useful properties are VS_DEBUGGER_COMMAND_ARGUMENTS, VS_DEBUGGER_WORKING_DIRECTORY.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-10-31T10:25:02.043

只是想指出，此链接[https://stackoverflow.com/a/40531167/9253113中提供了一个非常有用的附加功能，它允许您设置多个环境变量，而不是仅设置一个（例如，只有 PATH）](https://stackoverflow.com/a/40531167/9253113)

例如，如果除了设置 PATH 您还想设置另一个变量 OTHERVAR ，则必须修改该行

```
<LocalDebuggerEnvironment>PATH=C:\Test</LocalDebuggerEnvironment> 
```

到

```
<LocalDebuggerEnvironment>PATH=C:\Test &#xA;OTHERVAR="value of OTHERVAR"</LocalDebuggerEnvironment> 
```

其中符号“ `&#xA;`”告诉 xml 解析器引入 LF 字符。因此，如果用 LF 字符分隔多个变量定义是可能的（CR 字符也有效，但组合 CRLF 无效）

`&#xA;`另请注意，和下一个变量之间不能有任何空格。

# file - 生成文档的差异工具？

> ID：1005903
> 
> 赞同：1
> 
> 时间：2009-06-17T08:54:12.447
> 
> 标签：file, comparison, diff

我试过Beyond Compare，它似乎是一个很好的工具。但我还没有找到导出差异概述的方法。

它的格式应该是大多数人都能阅读的格式。文档、Rtf、Pdf、Html...

我需要的是显示两个文件夹的差异。显示哪些文件已更改就足够了。但是，如果可以在文档中更深入地查看文件中的哪些行已被更改，那也将是一件好事。

有什么工具可以做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T09:05:48.290

Beyond Compare 有一些功能可以做到这一点。

例如，在文件夹差异视图中，选择要报告的文件，然后选择操作->文件比较报告。HTML 是那里支持的输出格式之一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T08:49:24.593

Araxis Merge 满足了我的所有需求。

*   使用简单
*   在文件夹结构中生成了一个很好的文件概览
*   可以单击更改的文件以查看内容的更改

颜色可能会更好，但这可以通过插入自定义 CSS 文件来解决。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T09:04:01.897

[这个将diff 输出着色为 HTML](http://www.linuxjournal.com/content/convert-diff-output-colorized-html)的脚本可能很有用。还有许多其他工具，还有一个是[difftool](http://www.arstdesign.com/articles/difftool.html)。

在一个相对不同的地方，我使用了一个代码覆盖工具，它也从`gcov`覆盖信息生成 HTML 代码视图。它称为[lcov](http://ltp.sourceforge.net/coverage/lcov.php)。

# c# - 泛型类和接口的非泛型版本

> ID：1005913
> 
> 赞同：9
> 
> 时间：2009-06-17T08:56:15.250
> 
> 标签：c#, generics, covariance

我经常发现自己处于创建通用接口或类的情况，然后想以非通用方式使用此类或接口的不同版本。例如我可能有这样的界面：

```
interface ICanCreate<T>
{
    T NewObject();
} 
```

这允许一个类成为该类型的工厂。然后我想用一个通用的工厂类注册这些，所以我试着写这样的东西：

```
public class Factory
{
    private Dictionary<Type, ICanCreate> mappings; // what do I put here????

    public void RegisterCreator<T>(ICanCreate<T> creator)
    {            
    }

    public T Create<T>()
    {            
    }
} 
```

在字典中，我使用哪种类型来表示我的价值？我不知道我是否遗漏了某种设计原则，我知道这与 co(ntra?)variance 有很大关系。任何帮助或想法将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-17T08:59:22.887

您要么只需`object`在字典声明中使用（它都是私有的，并且*您*可以验证您永远不会在其中放入错误的东西）或声明一个扩展的非泛型`ICanCreate`接口。`ICanCreate<T>`

基本上，您想要一种无法用 C# 表达的类型关系——无论何时发生这种情况，您最终都会得到一个稍微令人不快的解决方案，但看起来您可以在这里隔离丑陋（即，将其保留在单个类中）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T10:23:53.577

有趣的是，这是在 C# 4.0 中解决的问题：

```
public interface ICanCreate<out T> // covariant
{
    T NewObject();
}

public class Factory
{
    private Dictionary<Type, ICanCreate<object>> mappings = new Dictionary<Type, ICanCreate<object>>();

    public void RegisterCreator<T>(ICanCreate<T> creator) where T:class
    {            
      mappings[typeof(T)] = creator;
    }

    public T Create<T>()
    {            
      ICanCreate<object> creator = mappings[typeof(T)];
      return (T) creator.NewObject(); // I do not think you can get rid of this cast
    }
} 
```

# user-interface - 选项卡式文档界面 Microsoft Word 2007

> ID：1005923
> 
> 赞同：0
> 
> 时间：2009-06-17T08:59:10.767
> 
> 标签：user-interface, ms-word, tabbed-interface

早在 2001 年，有人写了一个脚本来在 Word XP 中创建一个 Doc-Bar，它允许打开 Word 文档的选项卡式界面（从而节省宝贵的任务栏空间）：

[http://msdn.microsoft.com/en-us/library/aa155741(office.10).aspx](http://msdn.microsoft.com/en-us/library/aa155741(office.10).aspx)

但是，包中提到的链接/脚本神秘地消失了。

有谁知道如何以*编程*方式在 Word 2007 中创建一个允许打开文档的选项卡式界面的文档栏？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T09:38:43.527

没有回答同样的问题，但是像 WinTabber 这样的东西呢？( [http://www.wintabber.com/](http://www.wintabber.com/) ) - 在我为 Cygwin 构建 mrxvt 之前，我曾经使用它（或类似的东西）进行标签式 PuTTY 会话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T10:50:27.780

您可以使用 Word 选项执行多项操作：

*   转到*Word 选项*->*高级*->*显示*部分并取消选中*在任务栏中显示所有窗口*

*   使用窗口列表（在功能区的视图选项卡上）在文档之间切换。默认快捷方式是（在英文 UI 上）：`Alt+W+W+<n>`其中 n 是文档的索引。

*   配置自定义键盘快捷键以显示打开的文档列表。

# php - 如何修复 joomla 1.0 中的致命错误？

> ID：1005926
> 
> 赞同：0
> 
> 时间：2009-06-17T09:00:02.497
> 
> 标签：php, joomla, fatal-error

这是错误：

```
Warning: require_once(/home/exhibit/public_html/includes/version.php) [function.require-once]: failed to open stream: No such file or directory in /home2/exhibit/public_html/includes/joomla.php on line 71

Fatal error: require_once() [function.require]: Failed opening required '/home/exhibit/public_html/includes/version.php' (include_path='.:/usr/lib/php:/usr/local/lib/php') in /home2/exhibit/public_html/includes/joomla.php on line 71 
```

如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T09:20:05.343

/home/exhibit/public_html/includes/version.php

有时，上传文件时 FTP 超时，该文件可能未正确上传。检查此文件的文件大小是否大于 0 并且它是否存在。如果不是，那么只需将此文件重新上传到正确的位置。

# asp.net - ASP.NET 在登录页面中显示样式表

> ID：1005929
> 
> 赞同：1
> 
> 时间：2009-06-17T09:00:20.220
> 
> 标签：asp.net

我想在登录页面上使用我的站点样式表。

我的 web.Config 中有以下内容，但除非我登录，否则我不允许进入 css 页面

```
 <location>
    <system.web>
      <authorization>
        <deny users="?" />
        <allow users="*" />
      </authorization>
    </system.web>
  </location>
  <location path="~/App_Themes/Layout.css">
    <system.web>
      <authorization>
        <allow users = "*" />
      </authorization>
    </system.web>
  </location> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T09:10:29.777

你不应该有第一个位置标签 - 删除它。配置应该是（假设您使用的是表单身份验证）：

```
 <configuration>
       <system.web>
         <authentication mode="Forms"> 
         </authentication>
         <authorization>
           <deny users="?" />
         </authorization>
       </system.web>
       <location path="App_Themes/Layout.css">
          <system.web>
            <authorization>
              <allow users="*" />
            </authorization>
          </system.web>
       </location>
    </configuration> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T09:10:37.280

我认为你的问题是关于这里的路径：

```
<location path="~/App_Themes/Layout.css"> 
```

尝试像这样放置css文件的精确位置：

```
<location path="App_Themes/Layout.css"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T09:03:16.063

尝试在 HTML 头标签中包含 CSS 样式表...

```
<link rel="Stylesheet" type="text/css" href="Style.css" /> 
```

希望有帮助**:)**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T09:07:38.363

尝试在您的 CSS 的允许标记中执行此操作：

```
<allow users="*,?" /> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T10:03:03.587

您可以将 id 赋予页面的 head 标签，然后在页面加载时将外部 css 添加到此 head。

# deployment - TLBIMP.EXE - 错误 TI0000 - *.dll 不是有效的类型库

> ID：1005932
> 
> 赞同：4
> 
> 时间：2009-06-17T09:01:12.917
> 
> 标签：deployment, tlbimp

在构建服务器上构建我们的项目时，编译失败并显示错误消息：

```
TlbImp: error TI0000 : The input file 'C:\*.dll' is not a valid type library. 
```

我们尝试通过 VS2005 命令提示符手动调用 TlbImp 命令，并出现相同的错误消息。

为了进行调查，我们尝试在虚拟机 (Vbox) 中创建一个*干净*的构建环境，然后在那里运行构建。一切顺利。

我们还尝试通过 VS2005 命令提示符调用相同的 TlbImp 命令，它成功了。

有了这个，我们假设 DLL 没有任何问题。你知道什么情况会导致这个问题吗？

编辑：发现问题，请参阅我的答案。;)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T09:26:26.890

如果它在一台机器上运行而不在另一台机器上运行，那么很可能您的机器中缺少此 DLL 的某些依赖项。[通过DependencyWalker](http://www.dependencywalker.com/)检查 dll ，您将了解哪个依赖项没有正确构建。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T10:16:18.413

经过仔细检查，我们发现官方构建服务器上的环境变量是FUBAR。

官方构建服务器同时安装了 VS2003 和 VS2005。我们的项目是VS2005。构建脚本使用来自 VS2003 的组件而不是 VS2005，因为 VS2003 路径（路径、LIB、LIBPATH 和 INCLUDE）首先在 VS2005 路径之前声明。

一个简单的 SET 命令用“正确的”覆盖环境变量修复了构建！

谢谢！

# emacs - Emacs - 在 Vista 中安装

> ID：1005934
> 
> 赞同：0
> 
> 时间：2009-06-17T09:01:41.837
> 
> 标签：emacs

我没有使用过 emacs，但听说过它的功能，真的很想尝试一下。所以有人可以发布如何在win vista中安装它的过程。以及下载它的设置和东西的链接，以便我可以在我的腿上设置它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T09:10:42.460

您最好的选择可能是使用[EmacsW32](http://ourcomments.org/Emacs/EmacsW32.html)，它很好地集成到 Windows 中，并带有适当的 Windows 安装程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T09:06:25.493

快速回答：[适用于 Windows 的 GNU Emacs 常见问题解答](http://www.gnu.org/software/emacs/windows/ntemacs.html)

# security - 服务器上的安全数据

> ID：1005941
> 
> 赞同：2
> 
> 时间：2009-06-17T09:02:45.207
> 
> 标签：security, cryptography

我正在设置一个服务器，其中一些重要的代码将驻留。我想确保代码无法访问，以防 HD 被盗。好吧，我知道您永远无法确定，但相当安全。我可以使用哪种方法？如何在没有人工交互的情况下在启动时挂载加密文件系统？

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T09:18:10.667

在没有人工干预的情况下安装加密文件系统最终会削弱您的安全性。小偷只需要窃取您的服务器。对于任何使用 dm_crypt 的基于 Linux 的系统，它都是完全可行的。有许多在线教程向您展示如何做到这一点。

如果这是用于文件服务器，您可能需要考虑使用 FreeNAS。它是一个基于 BSD 的 NAS 操作系统，其中包括加密磁盘的能力。您需要通过 Web 界面输入密码才能挂载磁盘。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T09:25:15.253

我不知道是否有任何加密文件系统解决方案支持这一点，但一种解决方案是让服务器联系另一台服务器以获取密钥。您甚至可以想象在几台服务器之间拆分密钥，因此服务器必须联系 m 个服务器中的 n 个来获取密钥。

如果您将服务器放置在不同的位置，这将使您免受 (n-1) 台服务器被盗。

但是，如果攻击者在服务器仍连接到网络时执行攻击，他当然能够访问加密密钥，但这种实现将使您免受简单的盗窃。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T10:28:42.600

开源[TrueCrypt](http://www.truecrypt.org/)在文件中创建一个虚拟磁盘并将其安装为真正的驱动器，或者它可以加密整个驱动器。加密是透明且快速的。我用过；它实时工作。它可能会使事情变得更容易。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T09:08:33.260

你想要的是[全盘加密](http://en.wikipedia.org/wiki/Full_disk_encryption)。完整的分区/文件系统是加密的，它在安装时由操作系统（或第 3 方软件）解密。

有很多实现，至少 MS Windows 和 Linux 将它作为操作系统的一部分。有关详细信息，请参阅维基百科文章。

能够在没有人工干预的情况下安装它可能是有问题的；毕竟，关键是如果没有人工（即您的）干预，您将无法阅读高清 :-)。您可能可以使用一些硬件令牌来执行此操作，但也可能会被盗。所以这个要求可能不可行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T09:25:11.197

使用硬件令牌可以在没有人工交互的情况下使用，但您需要防止有人与您的服务器一起窃取令牌。

您可以使用内置 GPS 和 10 分钟备用电池或其他东西来实现一些安全性（如果断电超过 10 分钟或服务器移动，请忘记钥匙）。你可以让它以某种方式工作，但它会非常昂贵。

您可能想要一个涉及较少的解决方案，如下所示：

1.  从常规分区启动
2.  在启动时使用随机密钥设置加密交换（重要！）
3.  在加密分区或 RAM 中设置 /tmp 和类似位置（重要！）
4.  通过ssh登录挂载加密数据分区

仍然需要人工干预，但您可以在家中进行操作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-18T12:38:21.793

非常感谢您的帮助回答。

我将尝试使用多个分布式密钥文件（并且没有密码）的 truecrypt 容器。脚本将检索密钥文件，然后挂载卷，然后删除密钥文件。

由于我们只是一小群人，另一种选择可能是在写入/读取之前以编程方式在客户端对数据进行加密/解密。但这在我看来有点令人厌烦。

那么，在终端服务器上有一个密钥文件怎么样？这么多的问题！

再次感谢您的帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-19T12:54:49.083

现在......我只记得[冷启动攻击](http://citp.princeton.edu/memory/)。我们真的需要枪支吗？我们就这样注定了吗？

# jquery - 得到 $.ajax 响应

> ID：1005942
> 
> 赞同：1
> 
> 时间：2009-06-17T09:02:59.120
> 
> 标签：jquery

```
function Profiles() { };

Profiles.prototype.test = function() {
    var opt = {
        url: __profileurl__+'getall/', type: 'get', dataType:'json',
        success:function(response){
          return response;
        }
    };      
    $.ajax(opt);
};

var profile = new Profiles(); 

var r = profile.test(); 
```

// 返回 undefined... 预期的输出应该是来自请求的响应。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T12:05:28.427

您**可以**使用异步请求来做到这一点，但这通常是**一件坏事**

像下面这样的东西应该返回数据。

```
function Profiles() { };

Profiles.prototype.test = function() {
    var returnedResponse;
    var opt = {
        async: false,
        url: __profileurl__+'getall/', type: 'get', dataType:'json',
        success:function(response){
          returnedResponse = response;
        }
    };          
    $.ajax(opt);
    return returnedResponse;
}; 
```

* * *

**但**

除非您真的真的需要能够立即使用 test 的返回值，否则**最好**将回调传递给 test。就像是

```
Profiles.prototype.test = function(callback) {
    var opt = {
        url: __profileurl__+'getall/', type: 'get', dataType:'json',
        success:function(response){
          callback(response);
        }
    };          
    $.ajax(opt);
};

var profile = new Profiles(); 
profile.test(function(data) {
    // do something with the data
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T09:05:51.813

因为您的函数没有返回任何内容，所以“成功”是回调函数的定义，您不能使用它从主函数返回值。此外，由于 ajax 调用是异步的，回调函数将在主函数结束后调用。

您可以定义最初实例化为 null 的全局变量，成功后您会将其分配给该变量，然后您可以检查它是否为 null。你可以做的更复杂，通过重新设计你的对象来拥有负责响应的字段和返回它的方法。但是你仍然有一个问题，因为调用是异步的并且 javascript 没有任何同步，所以你需要使用 setTimeout 函数找到解决方法。

PS。更好的是将您需要的逻辑放入该回调函数中，或者在该回调函数中进行另一个调用，您将在那里处理您的数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T09:16:52.103

您不能将响应“返回”为异步响应。我猜你可以在调用周围放置一个while循环并等待响应，如果你不希望执行进一步移动而不得到响应。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T09:28:27.417

尝试将 AJAX 请求设置为同步。

url：**profileurl** +'getall/'，类型：'get'，dataType：'json'，异步：false

# git - git clone gitosis@host:gitosis-admin.git 的密码问题

> ID：1005947
> 
> 赞同：10
> 
> 时间：2009-06-17T09:04:39.867
> 
> 标签：git, gitosis

尝试在 Ubuntu 上配置 gitosis 时遇到了一些问题。当我运行这个命令

```
git clone gitosis@host:gitosis-admin.git 
```

对于我的本地机器，我使用`git clone git@59.80.70.68:gitosis-admin.git`59.80.70.68 是服务器的 ip。但我遇到密码问题。我尝试输入服务器机器的密码，但它失败了

请帮助我。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-09-01T02:40:37.803

Gitosis 从不使用密码。它总是使用 SSH 密钥。您需要配置使用任何公钥与您在运行 gitosis-init 时提供的私钥一起使用。你可以通过编辑`~/.ssh/config`来包含一个像这样的节来做到这一点

```
Host githost # hostname you use on the commandline, in git remotes, etc.
HostName 12.34.56.78 # actually IP address or DNS name to connect to
User gitosis
IdentityFile ~/.ssh/id_rsa # whatever file stores the private key matching the public key you gave gitosis 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-01-19T16:32:32.440

我有一个类似的问题：我可以从笔记本电脑推送，但不能从 linux 机器推送。

查看服务器上的日志，我看到：

```
Public key b3:f3:... from <SOME IP> blacklisted (see ssh-vulnkey(1)) 
```

问题来自旧版本的 openssl 在我的旧 linux 机器上生成坏（不够随机）密钥。由于我无法升级（嵌入式开发），我在另一台机器上生成了公钥和私钥，并将它们复制到 linux 机器上。一旦新的公钥位于 gitosis-admin 的“keydir”中，一切正常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-04-14T18:09:36.753

我在 Cygwin 之上使用 Git Bash 在 Windows 7 上遇到了这个问题。

问题是我的 SSH 客户端不是安装了 Git 的客户端（我还安装了 Tortoise SVN，它安装了自己的 SSH 客户端）。

您可以检查 $GIT_SSH 的值，这应该设置为使用 git 而不是其他客户端（如 Tortoise SVN/Git 附带的客户端）安装的 SSH 二进制文件。

要在 Cygwin 运行中执行此操作，`echo $GIT_SSH`它应该类似于`"C:\Program Files\Git\bin\ssh.exe"` 如果不是，您可以在环境变量中更新它的值

（在Windows 7上：开始->右键单击“计算机”->属性->高级系统设置->环境变量->选择“GIT_SSH”->单击“编辑...”->输入ssh.exe的路径对于“变量值：”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-22T07:16:38.903

本文中的“设置 gitosis 管理存储库”可能会有所帮助：

[使用 Gitosis 设置 Git 服务器](http://fclose.com/b/linux/1432/setting-up-git-server-using-gitosis/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-05-21T23:02:58.520

我遇到了这个问题，因为我想将 .ssh/id_dsa 存储在其他地方，git 似乎默认情况下会在您的文件夹中查找身份，但我还没有找到一种方法来指定搜索它的路径

# php - 在 PHP/Oracle 中使用日期范围

> ID：1005952
> 
> 赞同：1
> 
> 时间：2009-06-17T09:06:35.883
> 
> 标签：php, oracle, date, range

我需要从许多不同的范围内计算出在不同的一天发生了多少不同的实例。可能最好用一个例子来解释它。

```
18-JAN-09 to 21-JAN-09
19-JAN09 to 20-JAN-09
20-JAN-09 to 20-JAN-09 
```

使用上面的三个示例，我需要它来收集这些信息并显示一些类似...

```
18th Jan: 1
19th Jan: 2
20th Jan: 3
21st Jan: 1 
```

...我将从 Oracle 数据库 fwiw 中获取信息（因此是上面的格式 ^），并且将有数百甚至数千条记录，所以我蹩脚的尝试做各种循环，if 语句将永远跑。

有没有相当简单有效的方法来做到这一点？不幸的是，我真的不确定从哪里开始......

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T09:26:19.497

您可以使用[另一个 SO](https://stackoverflow.com/questions/987610/how-to-iterate-over-a-date-range-in-pl-sql/987788#987788 "如何迭代一个日期范围")中描述的方法：

```
SQL> WITH DATA AS (
  2  SELECT to_date('18-JAN-09', 'dd-mon-rr') begin_date,
  3         to_date('21-JAN-09', 'dd-mon-rr') end_date FROM dual UNION ALL
  4  SELECT to_date('19-JAN-09', 'dd-mon-rr'),
  5         to_date('20-JAN-09', 'dd-mon-rr') FROM dual UNION ALL
  6  SELECT to_date('20-JAN-09', 'dd-mon-rr'),
  7         to_date('20-JAN-09', 'dd-mon-rr') FROM dual
  8  ),calendar AS (
  9  SELECT to_date(:begin_date, 'dd-mon-rr') + ROWNUM - 1 c_date
 10    FROM dual
 11  CONNECT BY LEVEL <= to_date(:end_date, 'dd-mon-rr')
 12                      - to_date(:begin_date, 'dd-mon-rr') + 1
 13  )
 14  SELECT c.c_date, COUNT(d.begin_date)
 15    FROM calendar c
 16    LEFT JOIN DATA d ON c.c_date BETWEEN d.begin_date AND d.end_date
 17   GROUP BY c.c_date
 18  ORDER BY c.c_date;

C_DATE      COUNT(D.BEGIN_DATE)
----------- -------------------
18/01/2009                    1
19/01/2009                    2
20/01/2009                    3
21/01/2009                    1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T09:38:58.550

您的数据库引擎或 PHP 代码将不得不在日期范围内循环。

这是一些用于求和的 PHP 代码。存储天数是`year-month`为了避免在很宽的日期范围内有一个庞大的数组。

```
<?php

// Get the date ranges from the database, hardcoded for example
$dateRanges[0][0] = mktime(0, 0, 0, 1, 18, 2009);
$dateRanges[0][1] = mktime(0, 0, 0, 1, 21, 2009);
$dateRanges[1][0] = mktime(0, 0, 0, 1, 19, 2009);
$dateRanges[1][1] = mktime(0, 0, 0, 1, 20, 2009);
$dateRanges[2][0] = mktime(0, 0, 0, 1, 20, 2009);
$dateRanges[2][1] = mktime(0, 0, 0, 1, 20, 2009);

for ($rangeIndex = 0; $rangeIndex < sizeof($dateRanges); $rangeIndex++)
{
  $startDate = $dateRanges[$rangeIndex][0];
  $endDate = $dateRanges[$rangeIndex][1];

  // Add 60 x 60 x 24 = 86400 seconds for each day
  for ($thisDate = $startDate; $thisDate <= $endDate; $thisDate += 86400)
  {
    $yearMonth = date("Y-m", $thisDate);
    $day = date("d", $thisDate);

    // Store the count by year-month, then by day
    $months[$yearMonth][$day]++;
  }
}

foreach ($months as $yearMonth => $dayCounts)
{
  foreach ($dayCounts as $dayNumber => $dayCount)
  {
    echo $yearMonth . "-" . $dayNumber . ": " . $dayCount . "<br>";
  }
}

?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T15:27:46.037

您需要一张每天有一行的表格

测试日历：

```
Day
16.01.2009
17.01.2009
18.01.2009
19.01.2009
20.01.2009
21.01.2009
22.01.2009
23.01.2009
24.01.2009
25.01.2009
26.01.2009 
```

表测试包含bagin和finish of inctance：

```
DFROM   DTILL
18.01.2009  21.01.2009
19.01.2009  20.01.2009
20.01.2009  20.01.2009 
```

这是您需要的查询：

```
select day, (select count(1) 
  from test where dfrom<=t.day and dtill>=t.day) from test_calendar t
 where day>to_date('15.01.2009','DD.MM.YYYY')
 order by day 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T17:46:25.377

非常感谢提供解决方案的人 - 设法使用上面的一些 SQL 以及第二个解决方案中的一些 PHP 使其工作。

真的很感激，干杯:)

# .net - Windows 7 的 NLS 排序更改

> ID：1005953
> 
> 赞同：1
> 
> 时间：2009-06-17T09:06:43.683
> 
> 标签：.net, windows

根据[这篇文章](http://msdn.microsoft.com/en-us/library/dd464640(VS.85).aspx)，Windows 7 中将会有 NLS 排序更改，可能会影响某些应用程序。

我试图弄清楚我正在处理的应用程序是否会受到这些 NLS 排序更改的影响。如果 NLS 排序功能，我在 msdn 上进行了一些搜索并确定了一个列表：

```
CompareString
CompareStringEx
CompareStringOrdinal
LCMapString
LCMapStringEx
LCMapStringEx
FindNLSString
FindNLSStringEx
FindStringOrdinal 
```

我搜索了我的应用程序的代码库，它没有使用上述任何功能。这足以假设我的应用程序不会受到 NLS 排序更改的影响吗？

在上面的文章中，它指出应用程序兼容性工具包中包含的排序更改鲁棒性诊断工具可用于检查您的应用程序是否可以免受 NLS 更改的影响。我下载了应用程序兼容性工具包，但在工具包中找不到排序更改稳健性诊断工具。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T16:17:40.143

不，因为许多 API 最终隐藏了它们在内部调用这些 API 的事实。

您需要担心 WRT NLS 的真正问题是，如果您正在做一个类似数据库的应用程序，您在其中存储了基于排序顺序的数据索引。最大的危险是以下情况：

1.  数据库在 Vista 上建立索引，使用 Vista 的排序顺序
2.  你升级到Win7，但保留数据
3.  您去查找或添加条目，但使用 Win7 的排序顺序
4.  数据库损坏/返回奇怪的结果

但是，有希望 - 您可以使用 GetNLSVersion API 来确定是否重建索引；当您构建索引时，还要缓存您构建它们的版本。当您启动时，如果您发现版本**不同**（是的，这种情况很少见，但数字可能会下降！），删除索引并重建它们。

**编辑：**如果您使用 SQL Server 或 MySQL 等生产数据库，它们会在幕后为您处理这一切，所以如果您只是查询这些数据库，请不要担心。

# visual-studio - 使用代理身份验证连接到 Team Foundation Server (TFS)

> ID：1005955
> 
> 赞同：3
> 
> 时间：2009-06-17T09:07:27.927
> 
> 标签：visual-studio, tfs, codeplex

昨天我在 Codeplex 中创建了一个新项目。我创建了从 Visual Studio 到分配给我的 TFS 服务器的连接，并成功上传了我的解决方案。今天，我尝试再次连接到 Codeplex TFS 服务器以解决此问题。当我尝试打开它时，我收到错误：

> Team Foundation Server [https://tfs06.codeplex.com/](https://tfs06.codeplex.com/)不存在或目前无法访问。
> 
> 远程服务器返回错误：(407) 需要代理身份验证。

我使用的企业环境确实使用代理身份验证，但这不是昨天的问题。关于它当时为什么起作用以及现在如何使它起作用的任何想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T09:35:51.567

是否要尝试刷新 Visual Studio 中的起始页（视图、其他窗口、起始页）？听起来很奇怪，但以下论坛帖子表明这可能有效......

[http://social.msdn.microsoft.com/Forums/en-US/tfssetup/thread/c46afd34-09ea-4505-a34e-b378cb35138d](http://social.msdn.microsoft.com/Forums/en-US/tfssetup/thread/c46afd34-09ea-4505-a34e-b378cb35138d)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T09:53:51.140

[按照Martin](https://stackoverflow.com/questions/1005955/connecting-to-team-foundation-server-tfs-with-proxy-authentication/1006053#1006053)的建议访问 Start Page（在 View、Other Windows、Start Page 下）似乎以某种方式重置了代理身份验证。

然后，通过转到工具、连接到 Team Foundation Server 并从下拉列表中选择服务器，将出现身份验证提示。转到文件、源代码管理、联机，然后重新连接解决方​​案。

# javascript - 从 php 中搜索“list()”的等效函数/方式

> ID：1005960
> 
> 赞同：1
> 
> 时间：2009-06-17T09:09:03.727
> 
> 标签：javascript

我正在寻找 php 的“list()”的等效函数。我想用“split()”分割一个字符串，并将数组值放在两个不同的变量中。希望有另一种方法可以做到这一点，尽可能短且性能优化。

感谢您的关注！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T09:25:55.143

这是javascript中的列表实现：

[http://solutoire.com/2007/10/29/javascript-left-hand-assignment/](http://solutoire.com/2007/10/29/javascript-left-hand-assignment/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T09:54:05.383

也许[PHP.JS](http://phpjs.org/)值得一看（也许对于未来的东西）。我注意到[list()](http://trac.plutonia.nl/projects/phpjs/browser/trunk/_experimental/array/list.js)只是实验性的，但也许它有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T09:22:41.517

如果你可以不用命名，你可以这样做：

```
var foo = ["coffee", "brown", "caffeine"];
foo[0] + " is " + foo[1] + " and  " + foo[2] + " makes it special"; 
```

或者，使用对象来命名键：

```
var foo = {drink: "coffee", color: "brown", power: "caffeine"};
foo.drink + " is " + foo.color + " and " + foo.power + " makes it special"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T09:24:18.063

我认为你能得到的最接近的是明确的

```
var args = inputString.split(",");

// Error checking, may not be necessary
if (args.length < 3)
{
   throw new Error("Not enough arguments supplied in comma-separated input string");
}

var drink = args[0];
var color = args[1];
var power = args[2]; 
```

因为 Javascript 没有多个赋值运算符。我不会太担心这个效率；我希望`list`PHP 中的函数基本上可以归结为与上面相同的东西，只是语法糖。无论如何，除非您要分配数十万个变量，否则执行上述任何操作的时间可能可以忽略不计。

# linq - LINQ 中的条件多字段搜索和过滤

> ID：1005961
> 
> 赞同：5
> 
> 时间：2009-06-17T09:09:22.260
> 
> 标签：linq

假设我们有下表：

```
Person:
  PersonID,
  Name,
  Age,
  Gender 
```

我们提供了一个搜索功能，允许用户根据名称**和/或**年龄来搜索表格。

编写 SQL（或 LINQ）查询的棘手部分是用户可以选择搜索两个字段、任何一个字段或不搜索字段。如果他想搜索所有内容，那么他​​只需将文本框留空即可。

这样做的逻辑可以写成如下：

```
var p;
if(Name_TextBox=='')
{
   p=from row in person
        select row ;
}
else 
{
  p= from row in person
      where row.Name=Name_TextBox
        select row ;
}
// repeat the same for age 
```

现在过了一会儿，代码变得很长而且很乱......我怎样才能将上面的内容压缩成一个**没有 if-else**的查询？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-17T09:25:08.967

试试这样的代码

```
 string personName = txtPersonName.Text;
       int personAge = Convert.ToInt32(txtAge.Text);
       var opportunites =  from p in this.DataContext.Persons
                            select new
                            {
                                p.PersonID,
                                p.Name,
                                p.Age,
                                p.Gender
                            };

        if (personsID != 0)
            opportunites = opportunites.Where(p => p.PersonID == personID);

        if (personName != string.Empty)
            opportunites = opportunites.Where(p => p.Name.StartsWith(personName));

        if (personAge != 0)
            opportunites = opportunites.Where(p => p.Age == personAge); 
```

这将正常工作。如果 personName 没有给出，它不会被添加到 where，如果给出，那么它会被添加。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-17T09:14:55.680

我在 SQL 中使用的一种替代方法也可以在 Linq 中实现是

```
var p = from p in Person
       where p.Name == Name_TextBox || Name_TextBox == String.Empty
       select p; 
```

（请注意，您的 'linq' 使用的是 SQL 语法，它不会编译。此外，如果不直接分配值，您也不能像正在做的那样声明 var）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-18T18:51:40.680

为什么不使用空合并运算符？例如。

`var products = from a in context.products where a.ID == (productID ?? a.ID) select a;`

这在我的系统上非常有效

# java - wsdl + svutil

> ID：1005971
> 
> 赞同：0
> 
> 时间：2009-06-17T09:11:39.400
> 
> 标签：java, wsdl, svcutil.exe

我需要解决java中的pcakage导入..但是包不存在..后来我发现我必须使用一些wsdl文件来生成pacakage..我有那个wsdl文件的链接..如何使用svcutil 生成该 pacakage/解析导入的 pacakage...

```
D:\Profiles\pdk473\Desktop>svcutil  /t:metadata http://service/metadataEndpoint

SvcUtil V02.04.00cpp  Joe Richards (joe@joeware.net) June 2005

Usage:
 SvcUtil [machine\]service [action]

   machine         Machine to process services on
   service         Key/Display Name of service to view/manipulate
                   . for list of available services
   action          Action to perform
        STOP       Stop Service
        START      Start Service
        PAUSE      Pause Service
        RESUME     Resume Service
        VIEW       View Service
        VIEWX      Extended View Service

 This software is Freeware. Use it as you wish at your own risk.
 If you have improvement ideas, bugs, or just wish to say Hi, I
 receive email 24x7 and read it in a semi-regular timeframe.
 You can usually find me at joe@joeware.net 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T09:28:54.093

您确定 Microsoft`svcutil`正在生成 Java 代码吗？据我所知，它会为您生成一些 C++ 代码，这无济于事。

过去，当我需要从 WSDL 生成 Java 存根时，我使用了 Axis 框架的[wsdl2java](http://ws.apache.org/axis/java/user-guide.html#WSDL2JavaBuildingStubsSkeletonsAndDataTypesFromWSDL)。使用很简单，并在链接的文档中进行了解释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-09-14T13:49:07.843

svcutil 无法生成 java 代码。只能创建 C#、C++ 和 VB 代码。

# python - 查看 Python 中是否存在具有给定 pid 的进程的最简单方法是什么？

> ID：1005972
> 
> 赞同：7
> 
> 时间：2009-06-17T09:12:08.277
> 
> 标签：python, posix

在 POSIX 系统中，我想查看给定进程（例如 PID 4356）是否正在运行。如果我能获得有关该过程的元数据，那就更好了。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-17T09:27:17.247

除了 os.waitpid，您还可以使用带有信号 0 的 os.kill：

```
>>> os.kill(8861, 0)
>>> os.kill(12765, 0)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
OSError: [Errno 3] No such process
>>> 
```

编辑：更广泛地：

```
import errno
import os

def pid_exists(pid):
    try:
        os.kill(pid, 0)
    except OSError, e:
        return e.errno == errno.EPERM
    else:
        return True 
```

这在我的 Linux 机器上运行良好。我还没有验证“信号 0”实际上是 Posix，但它总是适用于我尝试过的每个 Unix 变体。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T09:26:27.187

在 linux 上，至少 /proc 目录包含您要查找的内容。它基本上是来自内核的系统数据，表示为目录和文件。所有数字目录都是进程的详细信息。只需使用基本的 python os 函数来获取这些数据：

```
#ls /proc
1      17    18675  25346  26390  28071  28674  28848  28871  29347  590   851   874  906   9621  9655       devices      iomem     modules ...

#ls /proc/1
auxv  cmdline  cwd  environ  exe  fd  maps  mem  mounts  root  stat  statm  status  task  wchan

#cat /proc/1/cmdline
init [3] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-11-19T22:13:22.370

以可移植的方式，通过使用 psutil ( [https://github.com/giampaolo/psutil](https://github.com/giampaolo/psutil) )

```
>>> import psutil, os
>>> psutil.pid_exists(342342)
False
>>> psutil.pid_exists(os.getpid())
True
>>> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T09:27:09.900

看`/proc/pid`。这仅存在于正在运行的进程，并且包含大量信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T09:19:27.730

[`os.waitpid()`](http://docs.python.org/library/os.html#os.waitpid)可能会有所帮助：

```
try:
    os.waitpid(pid, 0)
except OSError:
    running = False
else:
    running = True 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T09:20:14.033

执行此操作以获取信息的一种方法是：

```
import commands
output = commands.getstatusoutput("ps -ef | awk '{print $2}' | grep MYPID") 
```

请参阅：[http ://docs.python.org/library/commands.html](http://docs.python.org/library/commands.html)

我认为：

```
commands.getoutput(...) 
```

可用于获取“ `ps`”行上可用的元数据。由于您使用的是 POSIX 系统，我想`ps`（或等效的）将可用（例如`prstat`在 Solaris 下）。

# .net - WPF 中的语法着色

> ID：1005975
> 
> 赞同：1
> 
> 时间：2009-06-17T09:13:57.070
> 
> 标签：.net, wpf, syntax-highlighting, rtf

有谁知道是否有免费的 WPF 语法高亮组件？我目前正在使用 AvalonEdit，它是新 SharDevelop 源的一部分。
我遇到的麻烦是它似乎不支持文本内容的绑定。

有谁知道这是否可能，或者是否有任何其他类似的控件支持数据绑定？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T09:27:59.290

除了我评论中提到的帖子，你可以看看[这篇文章](http://blogs.microsoft.co.il/blogs/tamir/archive/2006/12/14/RichTextBox-syntax-highlighting.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-24T13:26:18.807

AFAIK 不可能在自定义 WPF 文本框控件中有效地实现数据绑定。

内置的 WPF 文本框只能通过使用 System.Windows.DeferredReference 来做到这一点；但微软将这个类留在了内部。

您必须手动将值复制进出 AvalonEdit。

# oop - 对象内部的数据结构

> ID：1005977
> 
> 赞同：0
> 
> 时间：2009-06-17T09:14:06.243
> 
> 标签：oop

我有一个关于面向对象设计的简单问题，但我很难弄清楚什么是最佳解决方案。假设我有一个包含一些方法和大量属性的对象，可能是一个 Employee 对象。属性，如 FirstName、Address 等，表示数据结构。然后在 Employee 对象上可能有一些方法，比如 IsDueForPromotion()，这更像是面向对象的性质。

混合这对我来说感觉不对，我想将两者分开，但我不知道如何以一种好的方式做到这一点。我一直在考虑将所有属性数据放在一个结构中，并在员工对象内部有一个内部结构对象，私有 EmployeeStruct employeeData ...

但是，我不确定这是否是一个好主意，也许我应该将所有方法和属性放在同一个类中并继续使用。如果我将数据与方法分开，我会让事情变得复杂吗？

如果有人对此有任何想法，我将不胜感激。

Ĵ

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T09:18:03.240

[OO设计](http://en.wikipedia.org/wiki/Object-oriented_programming#Fundamental_concepts)的思想不就是将数据和相应的方法封装在一起吗？

这里的问题是 Employee 对象如何可能知道 begin due for Promotion。我猜该方法属于某个类的其他地方，该类具有决定该方法的信息。非常愚蠢的例子`Manager m = new Manager(); manager.IsDueForPromotion(employeeobject);`

但是其他访问 Employee 字段的方法属于这个类。

我提出的有关 IsDueForPromotion 的问题取决于您的应用程序，以及您的 Employee 是否只是[POJO](http://en.wikipedia.org/wiki/Plain_Old_Java_Object)或[DTO](http://en.wikipedia.org/wiki/Data_Transfer_Object)，或者它是否也可以关联更多“智能”方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T09:34:26.220

如果您的数据发展比行为慢，您可能想尝试访问者模式：

```
class Employee {

    String name;
    String surName;
    int age;
    // blah blah
    // ...getters
    // ...setters
    // other boilerplate

    void accept(EmployeeVisitor visitor) {
        visitor.visitName(name);
        visitor.visitAge(age);
        // ...
    }
}

interface EmployeeVisitor {

    void visitName(String name);

    void visitAge(int age);
} 
```

通过这种设计，您可以在**不更改**Employee 类的情况下添加新操作。检查也使用规范模式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T05:58:39.507

面向对象编程的基本原则是将诸如 FirstName 和 Address 之类的数据与与之配套的功能（例如 IsDueForPromotion()）进行分组。对象持有多少数据并不重要，它仍然会持有这些数据。唯一要从对象中删除数据的情况是它与该对象无关，例如将公司名称存储在 Employee 对象中，而它应该存储在公司对象中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T09:21:16.323

对象操作（方法）应该使用属性。所以我觉得让他们在一起更好。

如果它不需要属性，它是一种实用方法，应该在其他软件中定义，可能在一些帮助类中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T09:25:12.603

好吧，OO 是一种将属于同一位置的数据和功能分组的方法。我真的不明白为什么“当有大量数据时”会例外。我能想到的唯一原因是易读性。

就我个人而言，我认为你会通过提出一个单独的结构来保存你的数据，从而使事情变得不必要地复杂。对于这是否是一种好习惯，我也很矛盾。一方面，一个类如何实现它的功能，或存储它的数据应该对外界隐藏。另一方面，如果数据属于一个类，那么将其存储在结构之类的东西中感觉很不自然。

查看您拥有的数据并查看是否可以将其建模为更小的域对象可能会很有趣。例如，有一个包含街道、门牌号、州、邮编、国家/地区等值的地址对象。这样，您的 Employee 对象将只包含一个 Address 对象。然后可以将 Address 对象重用于您的 Company 对象等。

# web-services - 通过 Web 服务启用对 SharePoint 列表上的内容类型的管理

> ID：1005984
> 
> 赞同：2
> 
> 时间：2009-06-17T09:16:29.437
> 
> 标签：web-services, sharepoint, list, content-type

我可以在文档库的“高级设置”中启用内容类型的管理。有什么网络服务方法吗？我需要以自动方式而不是手动方式执行此操作。

似乎 Lists.AddList 和 Lists.UpdateList 都无法设置为此所需的“标志”属性的值。我的 Web 服务客户端已经创建了一个新的内容类型并将该内容类型与列表相关联。但是，如果不启用内容类型的管理，新类型将不会出现在“新建”下拉菜单中，例如。

尼克拉斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T11:36:53.087

与使用对象模型可用的服务相比，Web 服务是有限的。如果您在 Web 服务 SDK 中找不到它（我找不到），那么很遗憾它不存在。

如果您可以使用对象模型，请参阅[SPList.ContentTypesEnabled](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.splist.contenttypesenabled.aspx)。否则，您将需要[创建自己的 Web 服务](http://msdn.microsoft.com/en-us/library/ms464040.aspx)来改变这个特定的属性。

# c# - 另一个sql查询语句

> ID：1005985
> 
> 赞同：1
> 
> 时间：2009-06-17T09:16:36.520
> 
> 标签：c#, sql

好的，非常感谢所有帮助我的人，但现在我还有另一个问题，我也想让这个陈述正确

```
if (byNametextBox.Text != null && byBuildingtextBox.Text !=null && seTextBoxPublic1.Text == null)
{
    da = new SqlDataAdapter("SELECT * FROM Students WHERE name='" +     byNametextBox.Text +"and [buil-id]='"+byBuildingtextBox.Text+ "'", MyConn);

} 
```

我想从同一张表中选择两个条件

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T09:33:07.547

请使用参数！如果由于某种原因你反对他们，这应该有效：

```
string strStatement = String.Format("SELECT * FROM Students WHERE [name] = '{0}' AND [buil-id] = '{1}'", byNametextBox.Text, byBuildingtextBox.Text);
da = new SqlDataAdapter(strStatement, MyConn); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T09:20:39.273

如果您在 SQL 查询中使用参数，则安全性会更好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T09:21:58.740

我想你应该创建一个带有 2 个参数的 SqlCommand 。您在此处发布的代码对于 SQL 注入攻击是不安全的。

请关注：

[http://msdn.microsoft.com/en-us/library/ms161953.aspx](http://msdn.microsoft.com/en-us/library/ms161953.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T09:25:16.720

但是，要回答您的问题，您的代码会创建 SQL：

```
SELECT * FROM Students WHERE name='NAMEand [buil-id]='ID' 
```

应该

```
SELECT * FROM Students WHERE name='NAME' and [buil-id]='ID' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-31T02:53:56.007

使用`parameterized`查询来防止 sql 注入，如果你想填充数据表，这里还有一些额外的代码。

```
SqlDataAdapter da = new SqlDataAdapter("SELECT * FROM Students WHERE name = @byName and [buil-id]= @byBuilding " , MyConn)
                           DataTable dt= new DataTable();
                            da.SelectCommand.Parameters.AddWithValue("@byName", byNametextBox.Text); 
                            da.SelectCommand.Parameters.AddWithValue("@byBuilding", byBuildingtextBox.Text);
                           da.Fill(dt); 
```

# .net - 用于规则引擎 GUI 的工具（控件）

> ID：1005989
> 
> 赞同：1
> 
> 时间：2009-06-17T09:17:25.287
> 
> 标签：.net, controls

在评估了现成的产品（MSBRE、Drools 等）之后，我们正在编写自己的规则引擎（这个决定已经做出，请不要推荐其他规则引擎 - 但其中部分会做我想要的细节是最欢迎）。

我想要为用户提供一个简单的 GUI，允许他们获取我们的域“对象”之一，并在 GUI 中制定可以转换为 Xml 或（理想情况下）.net 代码的规则。

因此，例如，用户可能会选择 StaffDuty，并想说“如果员工在管理组中并且今天的值班时间超过 8 小时，请确保明天的签到时间是 08:00 之后”。StaffDuty 对象将具有 Groups、DutyTime 和 NextDuty 属性，而 NextDuty 将是具有 SignOn 属性的类型。

我希望能够以图形方式显示用户“填写位”然后保存它，以便我们可以将其转换为代码（也许通过解释 xml）。

我对这个解释相当开放，因为我不想通过更具体的方式在这一点上排除任何东西。

任何想法表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T13:36:30.973

查看 Windows Workflow Foundation 中规则引擎的规则和表达式设计器。它们都可以在 Visual Studio 之外托管。特别是，我看到了一个示例，其中规则设计器被传递给定类型作为其上下文，并且能够基于该类型的属性以及这些属性引用的类型的属性创建规则和表达式。事实上，可以在对象图的根部传递一个类型，然后引擎可以使用图中所有对象的属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T10:06:23.907

不久前，我为一个大型政府业务规则引擎做了这个。

使用 XML 模式来描述数据，我使用 XML 模式注释来添加所有规则引擎特定的位，以确保模式保持有效。

GUI 提供了传统的 Explorer 样式视图，其中包含显示结构的树视图和显示所选树节点详细信息的右侧窗格。

我使用了一些相当复杂的 XSLT（带有一些自定义扩展）来生成一个表示表单的小型 XML 文档和一个小型引擎，该引擎将从该表单定义中动态呈现控件。

表单后面的代码更新了一个 XML 片段，然后该片段由另一段 XSLT 转换回 XML diffgram，并用于更新模式的内存中表示。

一旦构建了带注释的 XML 模式，编译器就会生成两个 .NET 程序集，一个包含模式的代码表示，另一个包含业务规则的实现。

这是一段相当复杂的代码，但它非常灵活和动态，并且绝大多数 UI 都可以仅通过 XSLT 进行定制。实际上，一些用户需要不同的视图，这些视图完全通过包含 XSLT 的附加动态加载程序集来处理。

请注意，成本约为 250 万英镑并花了两年多的时间来开发（整个事情，不仅仅是 UI）。这仍然是我 28 年来最引以为豪的发展！

如果您愿意，很高兴进一步讨论。