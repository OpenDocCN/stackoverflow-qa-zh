# StackOverflow 问答 000433000-000433999

# oracle - Oracle 序列存储在哪个表空间中？

> ID：433009
> 
> 赞同：4
> 
> 时间：2009-01-11T14:23:03.947
> 
> 标签：oracle, sequence

我和我的同事维护的应用程序在后端有一个 Oracle 数据库。我们正在考虑偶尔以“受限”模式运行应用程序，其中一个数据库表空间设置为只读。我们可以轻松地将必要的表和索引移动到单独的表空间，这些表空间将在“受限”模式下可写。但是，尽管进行了多次 Google 搜索，但我无法确定 Oracle 在哪个表空间中存储序列。

[这个答案](https://stackoverflow.com/questions/373914/what-happens-to-an-oracle-sequence-after-disaster-recovery#374539)提到序列值存储在 SYSTEM.SEQ$ 表中。我现在无法访问 Oracle 数据库，但我猜这个表存在于系统表空间之一中。我们使只读的表空间不是系统表空间，它是我们自己的数据表空间之一。

在开发数据库上，我可以成功地从相关表空间设为只读的序列中选择。

我怀疑让这个表空间只读不会有问题，但我宁愿我的怀疑得到证实，而不仅仅是临时实验。有人可以启发我吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-11T21:50:58.817

序列（大部分）在 SEQ$ 中。零件将在 OBJ$ 中（以及其他地方的赠款）。但是所有这些表都在 SYSTEM 表空间中。一些 SYSTEM 对象位于 SYSAUX 中。DBA_SEGMENTS 是识别对象（例如 SEQ$）驻留在哪些表空间的好视图。

我怀疑 Oracle 不会让您将这些表空间置于只读模式，因为这样做，它需要将该表空间标记为只读，该表空间记录在该表空间的 SYSTEM 表中。有点像把钥匙锁在它解锁的保险箱里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-11T14:45:15.277

我猜是系统，还有哪里可以存储这些信息？

但是你为什么想知道这个？如果表空间是只读的，则您无法插入或更新，因此您根本不必使用序列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-11T15:13:54.843

我现在面前没有 Oracle DB，如果我没记错的话，序列是数据字典的一部分，因此无法手动更新，甚至无法（简单地）在没有特殊语法的情况下查询（这个这就是为什么您不能简单地获取序列的当前值 - 您必须递增它）。显然，数据字典是 SYSTEM 表空间的一部分，应该以任何方式触及。

# .net - 向 ADO .NET Entity Framework 添加业务层

> ID：433022
> 
> 赞同：7
> 
> 时间：2009-01-11T14:39:49.123
> 
> 标签：.net, entity-framework, .net-3.5, orm, ado.net-entity-data-model

我正在开发我的第一个 .NET 项目（.NET 3.5、ADO.NET 和 C#）。我们已经构建了我们的实体模型，并正在尝试构建一个干净的业务对象层。

我们已经有了基本的实体模型，并且我们希望将某些业务级语义添加到默认数据访问器（导航属性等）。

`Person`例如，假设我们在和之间存在多对多关系`BankAccounts`。假设我们想在业务层添加冻结帐户的功能。我们现在希望能够从 Person 导航到：

*   他们所有的银行账户，
*   他们未冻结的银行账户，以及
*   他们冻结的银行账户。

自然，我们希望将名义情况设为默认值：如果我导航`Person.BankAccounts()`，我希望它返回他们未冻结的帐户。我可以添加导航属性`Person.FrozenBankAccounts()`和`Person.AllBankAccounts()`.

我们提出的两种方法似乎都有相当多的代码气味。

1.  我们找不到覆盖实体模型方法的方法。`Person.BankAccounts()`因此，作为返回所有银行账户的访问者离开。然后我们添加 a`Person.FrozenBankAccounts()`和 a `Person.NonFrozenBankAccounts()`。
2.  向代码库添加另一个显式层，该层包含对`BankAccounts`.

对于方法 1，问题在于名义业务案例（访问未冻结的银行账户）是该批次中最不直观的方法名称。

使用方法 2，当我们从实体模型层子类化对象时，我们必须重写每个方法以确保它不会从底层返回对象。所以我们创建了`BL_Person`一个`BankAccounts()`返回`BL_BankAccount`对象集合的方法。但在这种情况下，所有这些代码似乎有点傻。

有没有比我们考虑的两个更好的方法？如果没有更好的方法，我概述的两种方法中的哪一种似乎是更好的解决方案（鉴于我们需要使用 50 多个类）？

**注意：**在进行网络搜索时，我确实找到了一封致 Microsoft 的公开信，标题为[ADO .NET Entity Framework Vote of No Confidence](http://efvote.wufoo.com/forms/ado-net-entity-framework-vote-of-no-confidence/)，这似乎暗示没有添加明确分离关注点的好方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-11T15:39:57.957

我没有使用 LINQ to Entities 的经验，但您的问题敲响了警钟。在我的上一个项目中，我在使用另一个 ORM 时遇到了几乎相同的问题。我没有让业务对象层的客户端直接使用 ORM 生成的类或复制所有类并实现大量转发功能，而是定义了接口。您的业​​务对象层的客户端只能看到这些接口，而您的实体类将实现这些接口，具有以下优点：

*   在直接的情况下（没有业务逻辑），接口的开发开销是最小的。对于大多数成员，您不需要实现转发功能，只需从接口“派生”实体类并完成即可
*   在您提到的情况下，您可以在接口中拥有一个属性 BankAccounts 并通过显式接口实现让它转发到实现实体的 NonFrozenBankAccounts 。你当然也可以添加任何你想要的支票
*   作为一个额外的好处，您可以轻松地交换底层持久层，而无需明显更改客户端代码的任何内容

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-12T07:10:31.597

您可以添加两个从 Account 继承的新实体类型
- RegularAccount 和 FrozenAccount
，并将您的 IsFrozen 字段添加为继承条件（每个层次结构的表）。

然后您可以删除从“Person”到“Account”的关联并创建两个新关联：

Person to RegularAccount，在人“Accounts”上命名导航属性。

人到 FrozenAccount，在人“FrozenAccounts”上命名导航属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T04:30:08.987

一种方法是这样的：

1.  定义您的 AllBankAccounts 属性（甚至可能将其设为私有）。
2.  在部分 Person 类中定义 BankAccounts 属性。该属性可以使用 LINQ 以 AllBankAccounts 的形式表示，即 AllBankAccounts.Where(a => !a.IsFrozen)
3.  在部分 Person 类中定义 FrozenBankAccounts 属性，如步骤 2。

希望有帮助。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-01-11T14:58:05.080

抛弃 EF 转而使用[NHibernate](http://www.nhforge.org)。

NHibernate 的方式是：您创建*业务对象*，然后告诉 NHibernate 如何将这些业务对象保存到数据库中。业务对象本身*不*知道它们是如何保存或加载的，也不知道 NHibernate 正在被使用。这叫做“执着无明”。另外，您可以告诉 NHibernate 以几乎任何您喜欢的方式保存和加载您的业务对象。它对您描述的场景有很好的支持。

停止编写数据访问层并停止生成代码。使用[真人的 ORM](http://www.nhforge.org)。

# ruby-on-rails - OpenID 身份验证进入奇怪的错误循环（Ruby on Rails、ruby-openid、open_id_authentication）

> ID：433025
> 
> 赞同：1
> 
> 时间：2009-01-11T14:43:45.637
> 
> 标签：ruby-on-rails, openid, ruby-openid

我在我的网站上使用 OpenID 已经有一段时间了，一切正常。但是，最近我在错误日志中看到了一些奇怪的错误。显然，对用户来说一切正常，他们可以登录。但是，在后台，OpenID 库似乎进入了导致一堆错误的循环。

此外，仅当我不在 localhost:3000 上访问时才会发生如果我通过我的 DynDns 名称隧道请求，我会收到错误消息。如果我来自 localhost:3000，什么都没有

底部是日志的片段。主要需要注意的是前几行：

```
未提供预先发现的信息
在 http://XXX.myopenid.com/ 上执行发现

```

这在初始 OpenID 请求之后的几秒钟内出现，并立即导致以下错误和堆栈跟踪。这会持续几次，然后停止。

有谁知道怎么回事？

```
未提供预先发现的信息
在 http://XXX.myopenid.com/ 上执行发现

处理 SessionsController#create (for 66.249.70.239 at 2009-01-11 09:20:38) [GET]
  会话 ID：19b48e16d003d796e4b90674b3a2b917
  参数：{"openid.sreg.nickname"=>"ASDF", "openid.claimed_id"=>"http://XXX.myopenid.com/", "openid.mode"=>"id_res", "openid. ns.sreg"=>"http://openid.net/extensions/sreg/1.1", "openid.return_to"=>"http://XXX.homelinux.net:3000/sessions?open_id_complete=1", " openid.sig"=>"Xs3twfOutebf5edn5eXaM0OTMko=", "openid.sreg.fullname"=>"ASDF", "openid.ns"=>"http://specs.openid.net/auth/2.0", "openid. op_endpoint"=>"http://www.myopenid.com/server", "action"=>"create", "openid.response_nonce"=>"2009-01-11T14:20:31Z20d5QU", "method"= >:get, "控制器"=>"会话", "openid.sreg.email"=>"ASDF@FDSA.com", "openid.identity"=>"http://XXX.myopenid.com/", "openid.sreg.country"=>"US", " open_id_complete"=>"1", "openid.assoc_handle"=>"{HMAC-SHA1}{4968a37c}{NUOe7g==}", "openid.signed"=>"assoc_handle,claimed_id,identity,mode,ns,ns .sreg,op_endpoint,response_nonce,return_to,signed,sreg.country,sreg.email,sreg.fullname,sreg.nickname"}身份，模式，ns，ns.sreg，op_endpoint，response_nonce，return_to，签名，sreg.country，sreg.email，sreg.fullname，sreg.nickname"}身份，模式，ns，ns.sreg，op_endpoint，response_nonce，return_to，签名，sreg.country，sreg.email，sreg.fullname，sreg.nickname"}
  OpenIdAuthentication::Association Load (0.002034) SELECT * FROM `open_id_authentication_associations` WHERE (`open_id_authentication_associations`.`server_url` = 'http://www.myopenid.com/server' AND `open_id_authentication_associations`.`handle` = '{HMAC- SHA1}{4968a37c}{NUOe7g==}')
  OpenIdAuthentication::Nonce Load (0.000717) SELECT * FROM `open_id_authentication_nonces` WHERE (`open_id_authentication_nonces`.`server_url` = 'http://www.myopenid.com/server' AND `open_id_authentication_nonces`.`timestamp` = 1231683631 AND `open_id_authentication_noces `.`salt` = '20d5QU') 限制 1

NoMethodError （当你没有预料到它时，你有一个 nil 对象！
评估 nil.claimed_id 时发生错误）：
    /vendor/plugins/open_id_authentication/lib/open_id_authentication.rb:107:in `complete_open_id_authentication'
    /vendor/plugins/open_id_authentication/lib/open_id_authentication.rb:88:in `authenticate_with_open_id'
    /app/controllers/sessions_controller.rb:80:in `open_id_authentication'
    /app/controllers/sessions_controller.rb:16:in `create'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/base.rb:1158:in `send'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/base.rb:1158:in `perform_action_without_filters'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/filters.rb:697:in `call_filters'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/filters.rb:689:in `perform_action_without_benchmark'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
    /usr/lib/ruby/1.8/benchmark.rb:293:in `measure'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/rescue.rb:199:in `perform_action_without_caching'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/caching.rb:678:in `perform_action'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.0.2/lib/active_record/connection_adapters/abstract/query_cache.rb:33:in `cache'
    /usr/lib/ruby/gems/1.8/gems/activerecord-2.0.2/lib/active_record/query_cache.rb:8:in `cache'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/caching.rb:677:in `perform_action'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/base.rb:524:in `send'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/base.rb:524:in `process_without_filters'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/filters.rb:685:in `process_without_session_management_support'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/session_management.rb:123:in `process'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/base.rb:388:in `process'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/dispatcher.rb:171:in `handle_request'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/dispatcher.rb:115:in `dispatch'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/dispatcher.rb:126:in `dispatch_cgi'
    /usr/lib/ruby/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/dispatcher.rb:9:in `dispatch'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:76:in `进程'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:74:in `同步'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/rails.rb:74:在“进程”中
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:159:in `process_client'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:158:in `每个'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:158:in `process_client'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in '初始化'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `new'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `initialize'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `new'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `运行'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel/configurator.rb:282:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel/configurator.rb:281:in `each'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel/configurator.rb:281:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:128:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel/command.rb:212:in `run'
    /usr/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:281
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.0.2/lib/active_support/dependencies.rb:489:in `load'
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.0.2/lib/active_support/dependencies.rb:489:in `load'
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.0.2/lib/active_support/dependencies.rb:342:in `new_constants_in'
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.0.2/lib/active_support/dependencies.rb:489:in `load'
    /usr/lib/ruby/gems/1.8/gems/rails-2.0.2/lib/commands/servers/mongrel.rb:64
    /usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require'
    /usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:31:in `require'
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.0.2/lib/active_support/dependencies.rb:496:in `require'
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.0.2/lib/active_support/dependencies.rb:342:in `new_constants_in'
    /usr/lib/ruby/gems/1.8/gems/activesupport-2.0.2/lib/active_support/dependencies.rb:496:in `require'
    /usr/lib/ruby/gems/1.8/gems/rails-2.0.2/lib/commands/server.rb:39
    /usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require'
    /usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:31:in `require'
    脚本/服务器：3

未提供预先发现的信息
在 http://myid.myopenid.com/ 上执行发现

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-03T21:41:25.507

升级到最新的 ruby​​-openid、open_id_authentication 和 Rails 2.2.2 修复了它！

感谢您的建议。

# java - 调用方法时自动 .toString()？

> ID：433030
> 
> 赞同：0
> 
> 时间：2009-01-11T14:47:52.603
> 
> 标签：java

我得到了一位前雇员的密码。有许多对方法的调用，例如：

```
foo(val,...); 
```

在哪里

```
void foo(String s,...) {
  ...
} 
```

val 是一个整数。

当然，我得到一个错误。

作为一种解决方法，我将 ""+val 传递给 foo. 我想知道是否有更好的方法。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-11T14:53:36.133

根据应该作为参数传递的不同类型，您可以接受一个对象并调用 .toString()

```
void foo(Object o){
   String s=o.toString();
   ...
} 
```

或为特定类型重载 foo

```
void foo(String s) {
  ...
}

void foo(int i){
    foo(Integer.toString(i);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-11T14:53:30.110

String.valueOf(val) 更快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-11T14:52:16.323

很不幸的是，不行。在不修改方法定义的情况下，这是最快和最简单的方法。

# communication - 您如何让您的用户使用适当的渠道报告错误？

> ID：433032
> 
> 赞同：4
> 
> 时间：2009-01-11T14:49:47.967
> 
> 标签：communication, bug-tracking

我们有一个设置，用户可以使用基于 Web 的表单或向特定的电子邮件地址发送电子邮件，以便他们可以报告错误。如果他们这样做，则会在错误跟踪系统中创建记录，并通过电子邮件通知相应的开发人员。

一些用户仍然亲自向我们发送电子邮件，打电话给我们，或者（最糟糕的是）亲自找到我们以口头描述错误。

您如何鼓励您的用户使用您为他们安排的错误报告系统？

*   您是否拒绝接受错误，除非它们是通过批准的途径提交的？
*   您是否接受通过其他方式报告的错误，但温和（或严厉？）提醒用户改用适当的渠道？
*   您是否甚至不为错误报告提供“可接受的路线”而烦恼，而只是拿走你得到的东西？

无论您使用什么方式，您如何解决以下问题：

*   不要让用户觉得你通过限制他们的联系方式来逃避工作
*   鼓励错误报告（令人惊讶的是，有多少用户会在数周或数月后才报告错误）
*   在团队和用户之间培养善意和信任*（咳嗽）*

我正在寻找有关此问题的一般指导。我们曾希望通过让他们更轻松的方式来帮助解决问题，并且在某种程度上确实如此，但是是否有人有一些特别成功（或不成功）的方法可以分享？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-11T14:54:44.943

**毫无疑问地将它们与流程集成**

我会*尝试*的是，当您收到带外报告时，将其正式化为错误，通过电子邮件将错误抄送给他们，然后将错误留在“需要检查”状态，然后要求他们阅读并制作确保它的书面正确。

这不是一个超级解决方案，但它更有可能诱使他们了解系统的好处，并意识到他们尝试以不同的方式做这件事最终对他们来说比仅仅启动他们的网络浏览器并正确报告它更难。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-11T15:01:16.617

我想我们同意最糟糕的部分是打电话或亲自描述错误（一封电子邮件可以很容易地转发到错误跟踪系统）。

我通常要求我需要屏幕截图或需要他们在电脑前的东西，所以他们只使用电子邮件会最方便。如果那时他们将其发送给您而不是跟踪器，您可以轻轻提醒他们，但通常无需打扰，我。

我要求它明确表示如果没有那条信息我就无法解决它。正如我所说，这可能是一个屏幕截图，但也可能是一个日志文件或任何对你来说有意义的东西。

这并不是说这些信息实际上与错误解决相关（尽管可能），这只是让他们习惯于将错误报告与向您​​发送一些无法口头传递的信息相关联的一种手段。

当然，如果它可以自动发送（用户按下按钮并将适当的电子邮件发送到包含相关内容的正确地址），那就太棒了，有一些工具可以集成到你的程序中来做到这一点。

哦，我永远不会拒绝错误报告。正如您所说，要让报告拒绝某些报告已经够难的了。如果描述很糟糕，我要做的是询问更多信息。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-11T15:02:50.343

每当您在非正式渠道上遇到错误时

1.  向他们提及他们可以使用自动化系统（不严厉，但建议作为选项）
2.  自己提交错误，抄送相关用户并让他观看有关错误的讨论。
    几次实例后，您的用户将开始使用此路由，因为这为他们提供了有关他们报告的错误的足够信息和可见性。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-11T15:11:43.210

谁手动报告，为他们创建一个电子问题。确保电子系统尝试让他们下次以电子方式报告，但不要太用力。很高兴他们关心并感谢他们的反馈。

如果这些事情*令人不安，*我怀疑您的真正问题与其他形式的质量有关。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-11T17:10:12.550

*告诉您的客户，当报告上的姓名不是*公司员工时，错误报告对 PM 的影响更大。虽然您可以自己报告错误，但它可能看起来只是在内部遇到并且实际上不会影响客户，但如果它来自外部，则分配时间来修复它的优先级更高，因为客户已经不仅遇到了问题，而且深受其影响，以至于促使他或她去填写正式的错误报告。

# javascript - 为 jQuery 发布你的简短扩展函数好东西

> ID：433044
> 
> 赞同：12
> 
> 时间：2009-01-11T14:58:09.010
> 
> 标签：javascript, jquery, jquery-plugins

与 SO 上的 c# 扩展主题类似，如果我们能将一大堆有用的 jQuery 函数扩展集合在一起，那就太好了。

**请注意，我们的想法是使用简短的代码片段，而不是完整的众所周知的插件或 ui 小部件**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-11T15:01:48.520

```
// Allows chainable logging
// USAGE: $('#someDiv').hide().log('div hidden').addClass('someClass');
// Demo : http://jsbin.com/odeke
jQuery.log = jQuery.fn.log = function (msg) {
      if ( window.console && window.console.log ) {
         console.log("%s: %o", msg, this);
      }
      return this;
}; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-27T23:15:09.910

您可以使用它来查看选择器是否存在。

```
if($.exists('#mydiv')) { }

$.exists = function(selector) {
    return ($(selector).length);
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-09-01T08:37:24.413

将页面上的绝对 URL 解释为外部链接，并将它们设置为在新选项卡中打开，并为特定样式设置友好的标题和类。

```
$("#content [href^='http']:not(a:has('img'))").each(function(){$(this).attr("target", "_blank").addClass("external").attr("title", "External Link to " + $(this).attr("href"))}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-11T18:22:22.403

[验证](http://plugins.jquery.com/project/validate)插件很棒。在 ASP.NET MVC 应用程序中使用它来使用 ajax 动态验证客户端上的内容...甚至根据用户输入返回自定义错误消息...非常酷。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-09-01T08:31:21.120

**快速简单的 AJAX：**

以下允许您制作锚点

```
<a href='http://www.google.com/' rel='#myselector' class='ajax' /> 
```

它对 URL进行 AJAX 查询，`href`并将结果注入到锚`rel`属性中选择器定义的第一个元素中。

```
// Allow hrefs with the class 'ajax' and a rel attribute set with a selector to load content via ajax into the selected element.
$('.ajax').unbind('click').click
(
    function(e)
    {
        $($(this).attr('rel')).load($(this).attr("href"));
        e.preventDefault();
    }
); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T02:03:49.447

[http://plugins.jquery.com/](http://plugins.jquery.com/)托管各种大小的插件，并且将是一个比这个线程更全面和有用的资源，对不起。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-01T08:12:46.773

啊，我离最初的问题有点远，但如果有“get/set an id”片段，那么我有一些代码来创建唯一的 id：

```
$.increment = function (){
    var me = arguments.callee;  
    if (!me.count) me.count = 0;
    return ++me.count;      
}

$.domToSelector = function (jq, options){
    var selectors = [], i = 0; defaults = {}, opts = $.extend(defaults,options);
    $(jq).each(function(){  
        var $node = $(this);    
        if ($node.attr('id')){
            selectors[i] = '#'+$(this).attr('id');      
        }
        else{
             var customId = ''+new Date; 
             customId = customId.replace(/ /g, '').replace(/:/g, '').replace(/\+/g, '');
             customId = customId+'_'+$.increment();
             if (opts.prefix)  customId = opts.prefix+customId;
             $node.attr('id', customId);
             selectors[i] = '#'+customId;        
        }
        i++;    
    });
    if (selectors.length == 1) selectors = selectors[0];    
    return selectors;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-09-01T09:33:30.290

扩展选择器，即编写您自己的自定义选择器。这是两个示例：

```
$(document).ready(function(){
    $.extend($.expr[':'], {
        inputEmpty: inputEmpty,
        inputNotEmpty: inputNotEmpty
    });
});

function inputEmpty(el) {
    return $(el).val() == "";
}

function inputNotEmpty(el) {
    return $(el).val() != "";
} 
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-02-11T19:00:18.267

只是获取/设置元素 ID 的快捷方式。

```
 (function($) {
    $.fn.id = function(newDOMID){
        var $this = $(this); 
        if($this.attr('id')){
            if(!newDOMID){
                $this.id.getID($this);
            }
            else {
                $this.id.setID($this,newDOMID);
            }   
        }
        else {
            alert('The target no longer appears to be a part of the DOM!')
        }
    };
    $.fn.id.getID = function($this){
        return $this.attr('id');
    };
    $.fn.id.setID = function($this,newDOMID){
        $this.attr('id',newDOMID);
        return this
    };
})(jQuery); 
```

它是 jQuery 插件网站上的 jID。

# c# - 如何获取所有当前加载的程序集的列表？

> ID：433049
> 
> 赞同：16
> 
> 时间：2009-01-11T15:00:47.570
> 
> 标签：c#, reflection

> 如何获取所有当前加载的程序集的列表？

**[作为您如何循环浏览当前加载的程序集](https://stackoverflow.com/questions/383686/how-do-you-loop-through-currenlty-loaded-assemblies)的副本而关闭？**

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-01-11T15:03:14.147

```
Assembly[] asms = AppDomain.CurrentDomain.GetAssemblies(); 
```

# c# - .NET winforms 应用程序控件变为红色 x

> ID：433057
> 
> 赞同：2
> 
> 时间：2009-01-11T15:05:23.817
> 
> 标签：c#, .net

我已经将 C#.net 2.0 应用程序部署到 Windows XP SP2 机器上，并且在某些事件期间，许多表单控件变为红色 X。（按钮、标签等...）。我已经粘贴了以下导致问题的程序之一。由于我无法在开发机器上重现它，我只能猜测问题出在线程或绘画上。

```
 private void SearchExistingPeople()
        {
            try { if (_dal == null) { _dal = new DataAccessLayer(); } }
            catch (Exception ex) { throw new Exception("Error creating DataAccessLayer: " + ex.Message); }

            Thread oThread = new Thread(ShowPleaseWait);
            oThread.Start();

            try
            {
                PersonDS _dsPerson = _dal.SearchExistingPersons(dtbSearchDOB.Value, txtSearchFName.Text, txtSearchLName.Text, txtSearchSSN.Text, txtSearchAKA.Text, chkDOBSearch.Checked);
                dgvPeople.DataSource = _dsPerson;
                dgvPeople.DataMember = "People";

                dgvPeople.Columns["PersonID"].Visible = false;
            }
            catch (Exception ex)
            { MessageBox.Show("Error in SearchExistingPeople: " + ex.Message); }
            finally
            { 
                if (_dal != null) { _dal = null; }
                oThread.Abort();
                oThread = null;
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-11T16:08:42.097

当您从另一个线程而不是 UI 线程访问 UI 控件时，红叉通常由 .NET 框架本身绘制。

也许 ShowPleaseWait 或 SearchExistingPersons 内部有一个跨线程调用。（请发布这些例程的代码。）

当资源不可用时，也会显示叉号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-11T15:33:04.150

在黑暗中拍摄。ShowPleaseWait 是如何工作的？它是否尝试触摸当前显示的任何控件？如果是这样，这就是您的问题的根源。在后台线程中使用控件是不合法的。

一种快速而肮脏的测试方法是本质上使用一个空方法而不是 ShowPleaseWait。

# url-rewriting - CMS 如何在目录或纯文件名中显示页面？

> ID：433059
> 
> 赞同：0
> 
> 时间：2009-01-11T15:10:21.980
> 
> 标签：url-rewriting, content-management-system

如果所有 CMS（Drupal、MediaWiki）只是后台 PHP 或 ASP 的集合，那么它们如何在没有扩展名或任何东西的情况下显示**www.example.com/directory/**或**www.example.com/File_name的页面？**

这是一些 .HTACCESS 配置吗？Python？珀尔？这有什么办法？

**我怎么能为我的服务器/网站做到这一点？**（不使用CMS？）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-11T15:16:50.110

你在[URL](http://en.wikipedia.org/wiki/Rewrite_engine) [重写](http://httpd.apache.org/docs/2.2/rewrite/)之后。它使网络服务器能够显示既不直接映射到文件系统中存在的内容也不映射到特定动态内容处理程序（这两种通常是提供内容的标准方式）的 URL 的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-11T15:24:27.083

Web 服务器只是一种侦听传入请求的软件，当它收到请求时，它会发回某种响应。

传统上，服务器（例如提供普通 HTML 文件的 Apache / IIS）会查看传入的请求，在其本地文件系统上找到相应的文件（例如 /home/about.html，它们会在**主**文件夹中查找名为**about.html** )，并将该文件的内容发送回发出请求的客户端。这是快速、轻量级且非常容易实现的——但这只是构建 Web 服务器的一种可能方式。大多数 Web 服务器都提供了覆盖这种行为的能力，并对传入的请求做一些更智能的事情。

您需要做的是配置您的 Web 服务器本身（IIS、Apache、lighttpd 等）以将请求定向到特定脚本或资源。

在 Windows 上的 IIS 中，有两种方法可以实现这一点。

第一个是配置 IIS“自定义错误”功能并将 404 错误页面映射到 /MyCms/FindPage.asp - 这意味着任何时候客户端请求实际不存在的页面，您的 Web 服务器将运行该页面代替 ASP 页面，然后在该页面中，您可以提取原始请求 URL (/home/info/events.html)，在数据库或其他东西中查找它，然后返回它。客户将不知道发生了这种情况。

对于更强大的替代方案，您可以按照[olle](https://stackoverflow.com/users/48383/olle)的帖子中的建议使用通配符应用程序映射 - 这会将每个请求（不仅仅是“未找到”的请求）映射到您的 CMS 脚本或处理程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-11T15:14:45.980

[`DirectoryIndex`](http://httpd.apache.org/docs/1.3/mod/mod_dir.html)如果您使用的是 Apache，请查看指令以更改为目录显示的默认文件。

CMS 倾向于使用[URL 重写](http://httpd.apache.org/docs/1.3/mod/mod_rewrite.html)来获得用户友好的 URL，而不必在 URI 上具有文档 ID。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-11T15:20:17.670

没有扩展名的路径是您在网络服务器级别设置的。在 IIS 中，您可以使用[通配符应用程序映射](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/5c5ae5e0-f4f9-44b0-a743-f4c3a5ff68ec.mspx?mfr=true)。基本上，所有请求都会转到您指定的 ISAPI 扩展。在 Apache 中你可以使用 Roland 他的建议。

大多数这些类型的应用程序还使用一种称为[URL 重写](http://en.wikipedia.org/wiki/Rewrite_engine)的概念，以便在前端显示不同的 URL，然后是由 Web 服务器实际处理的 URL。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-11T15:24:34.947

大多数网络服务器都有[重写引擎](http://en.wikipedia.org/wiki/Rewrite_engine)。这些允许您在内部或外部将某些请求重写/重定向到其他 URL。

对于 Apache，有[mod_rewrite 模块](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html)或提供类似功能的[`AcceptPathInfo`指令。](http://httpd.apache.org/docs/2.2/mod/core.html#acceptpathinfo)

# visual-studio - WSE 客户端项目不断将 WebServicesClientProtocol 恢复为 SoapHttpClientProtocol

> ID：433062
> 
> 赞同：4
> 
> 时间：2009-01-11T15:11:48.733
> 
> 标签：visual-studio, 64-bit, vista64, wse, wse3.0

尽管在 Visual Studio 2005 中的客户端项目上启用了 WSE 3.0，但我所做的 Web 引用总是以从 SoapHttpClientProtocol 派生的服务代理结束。我必须手动将继承更改为 WebServicesClientProtocol，但更新它会恢复为 SoapHttpClientProtocol。我不确定在 Visual Studio 项目属性中的哪个位置可以让它永久使用 WebServicesClientProtocol？

* * *

据我所知，Visual Studio 应该生成常规的基于 SoapHttpClientProtocol 的服务代理，以及另一个后缀为“Wse”的服务代理，该名称源自 Web ServicesClientProtocol。[甚至 Visual Studio .NET 2003 也已具备此功能](http://www.peterprovost.org/blog/post/VSNET-2003-Auto-Generates-WSE-Proxies-2b-WSE-Settings-Tool.aspx)。因此，出于某种原因，我的 Visual Studio 2005 并未与 WSE 3.0 紧密合作以生成额外的 WebServicesClientProtocol 代理。但缺失的环节在哪里？

* * *

2009 年 1 月 13 日更新

我得到了另一台机器来测试这个，看到这个 Visual Studio 2005*可以*生成基于 WebServicesClientProtocol 的代理。这意味着我原来的工作站的 Visual Studio 已经搞砸了；不太确定如何修复它。

添加：嗯，重新安装 WSE 3.0 也没有帮助。也许 WSE 不能在 x64 Windows Vista 上运行...？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T07:37:56.540

看起来像[64位操作系统肯定有它的缺点](http://icelava.net/forums/thread/5224.aspx)。

WSE 3.0 安装程序无法使用以下条目更改 Visual Studio 2005 的配置文件 C:\Program Files (x86)\Microsoft Visual Studio 8\Common7\IDE\devenv.exe.config。

```
<configuration>
  <system.web>
    <webServices>
      <soapExtensionImporterTypes>
        <add type="Microsoft.Web.Services3.Description.WseExtensionImporter,
           Microsoft.Web.Services3, Version=3.0.0.0, Culture=neutral,
           PublicKeyToken=31bf3856ad364e35" />
      </soapExtensionImporterTypes>
    </webServices>
  </system.web>
</configuration> 
```

# java - 测试小程序的最佳机制是什么？

> ID：433065
> 
> 赞同：9
> 
> 时间：2009-01-11T15:13:18.557
> 
> 标签：java, testing, applet, automated-tests, integration-testing

我正在尝试有效地为小程序构建一个功能测试套件，并且我正在尝试为它找到一个好的框架。

过去，当我想设计一个测试套件来对应用程序进行功能测试和负载测试时，它一直是基于 Web 的应用程序，或者至少是某种基于服务的应用程序，我已经使用诸如grinder之类的东西来构建测试脚本并使用它们来模拟用户。

对于 Java 小程序，我不清楚有什么机制（如果有的话）可以让我使用和运行针对 GUI 的使用脚本，从而模拟用户单击表单控件。

有人对这个有经验么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-11T15:46:28.850

看看[FEST Swing](http://docs.codehaus.org/display/FEST/Swing+Module)。它使驱动和测试 Swing GUI 变得容易。它支持小程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-11T17:23:34.613

我们使用 QuickTest Professional（[维基百科链接](http://en.wikipedia.org/wiki/HP_QuickTest_Professional)）在测试小程序方面取得了巨大成功。我们在其自然环境（浏览器）中测试了小程序，并使用了一个专门构建的“底座”，它接管了浏览器部分并将小程序嵌入到 JFrame 中（因此我们可以测试 JavaScript 输入/输出、启动/停止、关闭框架并查找泄漏并激活通常隐藏/禁止的接口）。

披露：我是开发 QuickTest Professional 的 HP 开发人员。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-11T15:36:42.940

我确信这不是现在最好的选择，但几年前我使用 WinRunner 来测试 Java 小程序。

但是您是要创建负载还是要测试小程序的 GUI？因为您可以做一个结束并有一个页面，您可以在其中使用 Javascript 调用小程序，然后使用任何浏览器测试工具来调用您的 JS 方法。

# mysql - 可视化数据库模式的好工具？

> ID：433071
> 
> 赞同：145
> 
> 时间：2009-01-11T15:15:16.150
> 
> 标签：mysql, database, database-design, schema, visualization

是否有任何用于可视化预先存在的数据库模式的好工具？如果重要的话，我正在使用 MySQL。

我目前正在使用 MySQL Workbench 来处理 SQL 创建脚本转储，但它很笨重、缓慢并且需要手动拖动所有表（如果不是那么慢的话也可以）。

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-01-11T15:40:35.883

我发现[SchemaSpy](http://schemaspy.sourceforge.net/)非常好 - 每次模式更改时都必须运行脚本，但这没什么大不了的。

正如评论中所指出的，它还有一个[GUI](http://www.joachim-uhl.de/projekte/schemaspygui/)。

另一个不错的工具是[SchemaCrawler](https://www.schemacrawler.com/)。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2010-11-30T11:03:02.003

我通常使用 SchemaSpy 来做这件事，但最近我在[sqlfairy](http://nsaunders.wordpress.com/2009/01/11/easy-visualisation-of-database-schemas-using-sqlfairy/)上发现了一篇非常简单的文章，它只是使用转储文件来创建结构图

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-06-23T13:23:57.940

我喜欢这个工具，简称为[DbSchema](http://www.dbschema.com/index.html)。它是用 Java 编写的，因此可以在 OS X、Windows 或 Linux 上运行。这有点笨拙，尤其是在打印方面，但根据我的经验，它们都是这样的。这是我试过的几个中最好的一个。它可以制作漂亮、清晰的图表。免费试用。费用约为 120 美元，具体取决于您购买的许可证数量。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-09-19T14:01:09.297

在 Mac OS X 上，您可以使用[Sequel Pro](http://www.sequelpro.com/)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-01-11T15:36:55.763

我会推荐[Toad 数据建模器](http://modeling.inside.quest.com/index.jspa)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-11T16:33:40.487

[SQuirreL SQL 客户端](http://squirrel-sql.sourceforge.net/)怎么样？正如[另一个 SO question](https://stackoverflow.com/questions/408489/anyone-know-of-a-decent-free-db-schema-reverse-engineering-tool#408495)中提到的，这个程序能够生成一个简单的 ER 图。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-11T16:11:50.703

您是否尝试过 MySQL Workbench 中的排列 > 自动排列功能。它可以使您免于手动移动表格。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-03T08:49:37.087

[DeZign for Databases](http://www.datanamic.com)对您来说可能很有趣。您可以对现有数据库进行逆向工程和修改。具有自动布局功能，并且在将数据模型与数据库同步时，图表布局不会网格化。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-06-23T14:12:43.393

Visio *Professional*内置了一个数据库逆向工程工具。您应该能够通过 ODBC 驱动程序将它与 MySQL 一起使用。当您对数据库进行逆向工程，然后通过将图表拖出表格和视图面板来创建图表时，它的效果最好。它将拖动任何外键对象并将它们也放在图表上。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-08-02T07:38:14.973

我开始基于 SQL::Translator 模块 (GraphViz) 创建自己的 Perl 脚本。这是[第一个结果](http://dev.taptinder.org/schema/)。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-06-02T16:22:02.783

一种不同的方法，但如果您使用的是 Ruby on Rails，请尝试 RailRoad：[http: //railroad.rubyforge.org](http://railroad.rubyforge.org)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2010-11-14T17:00:12.017

我找了很长时间来寻找一个不错的，最好是免费的 linux 工具，发现这个 java 应用程序非常好（终于！！）：

[http://sqldeveloper.solyp.com/](http://sqldeveloper.solyp.com/)

作为 Java，它是跨平台的（我在 Linux 上运行它没有问题），它会连接到任何你可以获得 JDBC 驱动程序的数据库。即：[几乎任何数据库](http://developers.sun.com/product/jdbc/drivers/)。

[导入数据库并获得数据库模式的可视化 ( ERM](http://en.wikipedia.org/wiki/Entity-relationship_model) )非常容易。自动布局功能也很好，但请注意，它不是自动完成的，您需要在将对象导入图表后单击“自动布局”按钮。

该应用程序也是一个非常好的通用数据库管理/浏览工具。作为一个小例子，我使用它而不是 pgadmin 进行一些基础开发工作，因为 SQL 查询结果的列宽等简单的细节会自动调整大小以适应内容（这让我在 pgadmin 中发疯）。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-08-02T07:45:54.367

我将[SQL::Translator](http://search.cpan.org/~jrobinson/SQL-Translator-0.09007/lib/SQL/Translator.pm)与[DBIx::Class一起使用](http://search.cpan.org/dist/DBIx-Class/)

无论如何，我的工具链中有 DBIx::Class，将它与 SQL::Translator 结合使用可以将模式转换为许多不同的格式。主要是为不同的数据库服务器初始化 SQL 脚本（使其易于在 SQLite 上开发并转移到 Postgresql 进行生产），但它也可以输出 GraphViz 数据，因此生成图表很简单。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-08-03T18:20:08.923

[Embarcadero 的 ER/Studio](http://www.embarcadero.com/products/er_studio/)是成本较高的模型之一，但它呈现的分层模式是迄今为止理解数据库模型的最佳模式。它使查询编写成为世界上最简单的任务。

规范化、非规范化、仓储、文档等也令人难以置信。

缺点是它是一个非常昂贵的工具，尤其是当您使用多平台时。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2010-07-20T21:44:56.063

用于管理 MySQL 数据库的 Web 应用程序[Adminer （以前称为 phpMinAdmin）绘制了简单的图表。](https://www.adminer.org/en/)

该软件本身与 phpMyAdmin 类似，但具有更多功能、轻量级和单个 PHP 文件。

[![替代文字](https://i.stack.imgur.com/hGGfY.png)](https://i.stack.imgur.com/hGGfY.png)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-01-11T15:22:48.103

当您说可视化数据库架构时，您是指所有表、存储过程等的文本文档，还是指架构和依赖项的可视化表示？

我知道您提到了 MySQL（现在很可能支持它，但我不确定），但 RedGate 有许多工具可以让这变得非常简单。它的 SQL Doc 程序可以获取您的整个数据库并为其创建完整的数据库文档。SQL Dependency Tracker 可以为您提供所有表的可视化表示并显示它们的链接，或者您可以仅加载某些表或存储过程以显示正在使用它们的内容或它们自己使用的内容。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-01-14T13:57:04.450

几年前，我曾经使用过 Data Architect。我不知道它是否还在外面。

您可以将现有模式逆向工程为关系表图表。

或者你可以走得更远，逆向工程实体关系模型并附上图表。在与既不是程序员也不是数据库专家的人讨论数据时，ER 图对我非常有用。

有时需要对 ER 模型和 ER 图进行一些手动修复，然后才能成为与利益相关者的有用沟通工具。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-08-02T07:41:48.710

[SchemaBall](http://mkweb.bcgsc.ca/schemaball/)以自己有趣的方式进行可视化。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2012-02-27T21:48:27.033

我试过 DBSchema。不错的功能，但对于具有大约 75 个表的数据库来说速度非常慢。无法使用。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2012-07-31T14:29:58.127

试试 PHPMyAdmin，它有一些非常好的可视化和编辑功能。我很确定您甚至可以从中导出到 exel。

# flash - Google 如何读取 SWFAddress 深层路径？

> ID：433075
> 
> 赞同：0
> 
> 时间：2009-01-11T15:17:05.837
> 
> 标签：flash, actionscript, seo, deep-linking, swfaddress

[SWFAddress](http://www.asual.com/swfaddress/)声称它对搜索引擎友好，但是应该如何**将深层链接提供给**像谷歌这样的搜索引擎呢？因为在我所有 SWFAddress 支持的网站中， Google 中**没有一个深层链接**出现。

尝试和**失败**的方法：

*   在**hidden-HTML**中，a-href *（超链接）*指向深层链接，例如**www.site.com/#/Topic1**
*   在**[XML 站点地图](http://sitemaps.org/)**中，列出深层链接

久经考验的**方法**：

*   ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-11T15:28:54.563

站点地图方法应该可以工作，如果谷歌自己找不到它，你必须在[http://www.google.com/sitemaps](http://www.google.com/sitemaps)上提交它，然后等待，即使在谷歌之后，页面也可能需要一些时间才能被索引读取站点地图文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T09:59:57.273

Google 不会以任何方式索引/存储深层链接的 URL。

[Flash Search Player 9](https://stackoverflow.com/questions/447565/what-text-inside-flash-is-indexed-by-google#486846)本身不会检索/传递 URL 给虚拟用户（搜索引擎）

有关更多详细信息，请参见[此处](https://stackoverflow.com/questions/447565/what-text-inside-flash-is-indexed-by-google#486983)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-15T12:20:27.100

看看 Google 的[使 AJAX 应用程序可抓取](http://code.google.com/web/ajaxcrawling/docs/getting-started.html)。您可以修改 swfAddress 以使用 #! 而不仅仅是#。问题在于我相信您仍然需要为 Google 创建 HTML 快照页面。

如果您使用 PHP/mySQL 或类似的东西（非常适合让内容可搜索和索引），另一种可行的方法是在 PHP 页面上使用 FlashVar。这样，如果内容出现在搜索结果中并且访问者单击 PHP 页面的链接（并且他们有 Flash 插件），FlashVar/SWFObject 将触发 Flash 内容的显示。如果没有可用的插件，他们将看到从 PHP/mySQL 提供的内容。

真正帮助我理解 Google 如何看待网页的一件事是在 WebmasterTools中使用[Fetch As Googlebot 。](http://www.google.com/support/webmasters/bin/answer.py?answer=158587)我想如果你给它一个 hash-frag swfAddress 页面，它不会看到任何特定于该内容的内容。

站点地图很好，但我不确定它是否真的有效。当 Googlebot 访问这些 url 时会发生什么，那里是否有要索引的内容？

# quickbooks - 自动将 IIF 导入 Quickbooks

> ID：433078
> 
> 赞同：4
> 
> 时间：2009-01-11T15:19:35.347
> 
> 标签：quickbooks

我需要能够通过 .NET 应用程序将 IIF 文件导入 QuickBooks 2008 应用程序。我不知道关于 Quickbook 自动化的第一件事。

我应该去哪里看？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-11T15:26:32.480

IIF 文件已弃用，取而代之的是功能更全面的 API。

请参阅此处的问题 20 - [https://developer.intuit.com/blog/2015/03/03/top-20-intuit-developer-questions](https://developer.intuit.com/blog/2015/03/03/top-20-intuit-developer-questions)或此处的问题 4 - [https://developer.intuit.com/docs/0250_qb /0010_get_orientation/常见问题解答](https://developer.intuit.com/docs/0250_qb/0010_get_oriented/faqs)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T13:13:23.620

如果您正在集成网站，则可以使用此 Web 连接器框架来帮助您开始使用 QuickBooks SDK： http: [//idnforums.intuit.com/messageview.aspx ?catid=56&threadid=11040&enterthread=y](http://idnforums.intuit.com/messageview.aspx?catid=56&threadid=11040&enterthread=y)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T18:42:13.347

我不知道是否有办法自动化 QuickBooks 应用程序本身的实际导入功能。您当然可以在 .NET 代码中导入 IIF 文件，然后通过 SDK 将数据发送到 QuickBooks。

QuickBooks 有一个可以下载的 IIF 导入工具包。在其中，您将找到文件格式的详细信息以及示例 IIF 文件。我现在没有 QuickBooks，但您可以通过在 QuickBooks 在线帮助中搜索 IIF 找到下载链接。

如果这不能满足您客户的需求，那么您可能需要在[Intuit Developer Network 论坛](http://idnforums.intuit.com/)中发帖。他们应该能够明确地回答这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T17:56:38.563

我曾经处于你的位置，我决定使用这个第 3 方组件：[http ://www.nsoftware.com/ibiz/quickbooks/default.aspx](http://www.nsoftware.com/ibiz/quickbooks/default.aspx)

这个组件使得与 QuickBooks 交互几乎是微不足道的。他们还有示例代码、帮助文件和知识库。

# seaside - 如何清理 Seaside URL？

> ID：433087
> 
> 赞同：1
> 
> 时间：2009-01-11T15:26:59.967
> 
> 标签：seaside

所以，如果你下载一个新的 Seaside 镜像并运行 WAKom startOn: 80，那么你新的 seaside 会响应 localhost/seaside/

这个 /seaside-folder 让我很烦，因为我想在[seasidehosting](http://www.seasidehosting.st)上发布。

所以！如何删除这部分 URL？

我希望我的应用程序可以在 myapp.seasidehosting.st 下访问

URL 名称中没有任何路径。

尼可

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-11T16:58:35.070

只需执行：

```
WADispatcher default setName: '' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-11T16:40:29.897

啊哈！我在 seasidehosting 常见问题解答中找到了它。那里说：

> 转到 Seaside 配置页面并选择您的首选应用程序作为默认入口点。将应用程序的基本路径设置为“/”。请注意，这只适用于最新版本的 Seaside。

好的，这应该是可以管理的。

*编辑*：但它并不完全有效。你如何设置基本路径？仍在努力...

# c# - 模拟配置集合

> ID：433102
> 
> 赞同：0
> 
> 时间：2009-01-11T15:48:02.450
> 
> 标签：c#, .net, unit-testing, rhino-mocks

如何使用 Rhino Mocks 模拟 ConfigurationCollection。

我需要创建一个包含 1 个元素的 Expected ConfigurationCollection，以测试我的配置是否包含该元素。

谢谢。

注意：我的 ConfigurationCollection 继承自 IEnumerable。

```
public interface ICapalConfiguration
{
    ICapalRepositoryConfigurationCollection Repositories { get; }
    ICapalServiceConfigurationCollection Services { get; }
}

public interface ICapalRepositoryConfigurationCollection : IEnumerable
{
    string DefaultConnectionString { get; set; }
    ICapalRepositoryConfiguration GetElement(string name);
}

public interface ICapalRepositoryConfiguration
{
    string Name { get; set; }
    string ConnectionStringName { get; set; }
}

    [TestMethod]
    public void Can_Get_One_Repository()
    {
        var config = MockRepository.GenerateMock<ICapalConfiguration>();
        var expected_repositories = MockRepository.GenerateMock<ICapalRepositoryConfigurationCollection>();
        var expected_repository = MockRepository.GenerateMock<ICapalRepositoryConfiguration>();

        config.Expect(p => p.Repositories).Return(expected_repositories).Repeat.Any();
        config.Expect(p => p.Repositories.GetElement("ArticleRepository")).Return(expected_repository);

        var config_repositories = config.Repositories;
        var config_repository = config.Repositories.GetElement("ArticleRepository");

        config.VerifyAllExpectations();

        Assert.IsNotNull(config);
        Assert.IsNotNull(config_repositories);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-11T16:17:12.813

你的系统在测试什么？查看您的测试，我认为它是 ICapalConfiguration 的实现，因此您不应该嘲笑它。

我也倾向于不模拟简单的数据结构，例如集合。只需使用真实的东西。

# api - 如何从 Amazon Book API 获取图书图形和描述？

> ID：433104
> 
> 赞同：22
> 
> 时间：2009-01-11T15:51:29.933
> 
> 标签：api, amazon

[此 URL](http://webservices.amazon.com/onca/xml?Service=AWSECommerceService&AWSAccessKeyId=13529AWJ97PJXSM2K1R2&Operation=ItemLookup&ItemId=1590599659)将 ISBN 号发送到 Amazon 并返回一小部分 XML，包括作者、标题和出版商。

但是，我也想获得标题的小、中、大图形和书籍描述。

问题：无论是在 Google 还是在登录到我在 Amazon Associates 的“AWS 帐户”时，我都找不到有效的 REST URL 示例/文档。

我找到了 2003-2005 年的很多示例，但它们都已过时并给出错误，亚马逊的云网络服务似乎为他们的书籍混淆了他们简单的 REST API 文档。

谁能告诉我一些关于如何通过 REST/XML 获取有关亚马逊书籍的详细信息的文档？

这是我[到目前为止](http://[http://tanguay.info/web/index.php?pg=forays&id=3][2])所尝试的。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-11T16:21:03.833

所以，请允许我回答我自己的问题，在这里的另一个问题中，我发现了这个[有用的 PDF](http://s3.amazonaws.com/awsdocs/ECS/20080819/QRC-AAWS-2008-08-19.pdf)，例如，以下[URL](http://webservices.amazon.com/onca/xml?Service=AWSECommerceService&Version=2005-03-23&Operation=ItemLookup&SubscriptionId=13529AWJ97PJXSM2K1R2&AssociateTag=httpwwwcomput-20&ItemId=B0002ZAILY&IdType=ASIN&ResponseGroup=Images)获取图像，请参阅“ResponseGroup”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T19:28:51.390

ResponseGroup 是关键，如果您指定多个（逗号分隔），结果将拼接在一起

也就是说，“&ResponseGroup=Images,Small”返回有关产品的最少细节和图像

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-12T11:52:55.577

我已经构建了一些函数来使用 php 获取 amazon xml，并使用如下简单的函数进行 curl：

```
 <?php
function Get_Amazon_XML($tag, $api, $secretkey, $region, $department, $query)
{
$time = time() + 10000;
$method = 'GET';
$host = 'webservices.amazon.'.$region;
$uri = '/onca/xml';
$slug["Service"] = "AWSECommerceService";
$slug["Operation"] = "ItemSearch";
$slug["SubscriptionId"] = $api;
$slug["AssociateTag"] = $tag;
$slug["SearchIndex"] = $department;
$slug["Condition"] = 'All';
$slug["Keywords"] = $query;
$params["ItemPage"] = 1;
$slug["TruncateReviewsAt"] = '500';
$slug["ResponseGroup"] = 'Images,ItemAttributes,EditorialReview';
$slug["Timestamp"] = gmdate("Y-m-d\TH:i:s\Z",$time);
$slug["Version"] = "2011-08-01";
ksort($slug);
$query_slug = array();
foreach ($slug as $slugs=>$value)
{
$slugs = str_replace("%7E", "~", rawurlencode($slugs));
$value = str_replace("%7E", "~", rawurlencode($value));
$query_slug[] = $slugs."=".$value;
}
$query_slug = implode("&", $query_slug);
$signinurl = $method."\n".$host."\n".$uri."\n".$query_slug;
$signature = base64_encode(hash_hmac("sha256", $signinurl, $secretkey, True)); // Get Amazon Signature API
$signature = str_replace("%7E", "~", rawurlencode($signature));
$request = "http://".$host.$uri."?".$query_slug."&Signature=".$signature;
$ch = curl_init();
curl_setopt($ch, CURLOPT_USERAGENT, "Mozilla/5.0 (compatible; Konqueror/4.0; Microsoft Windows) KHTML/4.0.80 (like Gecko)");
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_URL, $request);
curl_setopt($ch, CURLOPT_TIMEOUT, 10);
$response = curl_exec($ch);
curl_close($ch);
return $response;
}
?> 
```

# performance - 现代 CPU 到底有多“快”？

> ID：433105
> 
> 赞同：19
> 
> 时间：2009-01-11T15:53:26.853
> 
> 标签：performance, assembly, x86, cpu-architecture, cpu-speed

当我曾经对嵌入式系统和早期的 8/16 位 PC（6502、68K、8086）进行编程时，我对每条指令执行所需的时间（以纳秒或微秒为单位）有很好的把握。根据系列，一个（或四个）周期相当于一个“内存获取”，并且无需担心缓存，您可以根据所涉及的内存访问次数猜测时间。

但是对于现代CPU，我很困惑。我知道它们要快得多，但我也知道如果不知道每条指令需要多少个时钟周期，标题千兆赫的速度是没有帮助的。

因此，任何人都可以为（假设）2GHz Core 2 Duo 上的两个示例指令提供一些时间。最好和最坏的情况（假设缓存中没有任何内容/缓存中的所有内容）将很有用。

**指令#1：**将一个 32 位寄存器加到一秒。

**指令 #2：**将 32 位值从寄存器移动到内存。

**编辑**：我问这个的原因是尝试开发一个“经验法则”，它可以让我查看简单的代码并粗略地衡量最接近的数量级所花费的时间。

**编辑#2：**有很多有趣的答案，但没有人（还）写下一个及时测量的数字。我很欣赏这个问题有“复杂性”，但是来吧：如果我们可以估计[NYC 的钢琴调音师的数量](http://www.google.com/url?sa=t&source=web&ct=res&cd=1&url=http%3A%2F%2Fmathforum.org%2Fworkshops%2Fsum96%2Finterdisc%2Fclassicfermi.html&ei=sE9qSf7LBuTSjAeQpaG2Bw&usg=AFQjCNF42Q4z65LsDYUtWCdbrdBHLLoC6A&sig2=5dsQt_00GjpCcmae6vTDfA)，我们应该能够估计代码运行时间......

采取以下（愚蠢的）代码：

```
int32 sum = frigged_value();

// start timing
 for (int i = 0 ; i < 10000; i++)
 {
   for (int j = 0 ; j < 10000; j++)
   {
     sum += (i * j)
   }
   sum = sum / 1000;
 }

// end timing 
```

我们如何*估算*运行... 1 飞秒需要多长时间？1 千兆年？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-01-11T16:16:48.197

您提到的Core 2 Duo等现代处理器既是*超标量*又是*流水线的*. 它们每个内核有多个执行单元，实际上每个内核一次处理多个指令；这是超标量部分。流水线部分意味着从读入和“发出”指令到完成执行之间存在延迟，该时间取决于该指令与同时通过其他执行单元的其他指令之间的依赖关系。因此，实际上，任何给定指令的时间取决于它周围的东西和它所依赖的东西。这意味着给定指令具有基于多种因素的最佳情况和最坏情况执行时间。由于有多个执行单元，每个核心时钟实际上可以有不止一条指令完成执行，

以上只是从CPU核心本身来看。然后，您将与缓存进行交互，并与其他内核争用带宽。CPU的*总线接口单元*处理将指令和数据输入内核并将结果通过缓存从内核放回内存。

粗略的数量级经验法则与一粒盐一起使用：

*   寄存器到寄存器操作需要 1 个*内核*时钟来执行。这通常应该是保守的，尤其是当更多这些按顺序出现时。
*   内存相关的加载和存储操作需要 1 个*内存总线*时钟来执行。这应该是非常保守的。如果高速缓存命中率较高，它将更像是 2 个*CPU 总线*时钟，这是 CPU 内核和高速缓存之间总线的时钟速率，但不一定是内核的时钟。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-11T16:37:05.567

几乎不可能以对您有用的方式提供您期望的准确时间信息。

以下概念会影响指令时序；有些可能会随时变化：

*   微操作分解
*   操作流水线
*   超标量执行
*   乱序执行
*   SMT/SMP执行
*   浮点模式
*   分支预测/预取
*   缓存延迟
*   内存延迟
*   时钟速度限制
*   ETC

如果您需要对上述概念的任何进一步解释，请查阅有关现代计算机体系结构的书。

衡量代码速度的最佳方法是（惊喜！）衡量代码在“现实世界”中运行相同工作负载和相同条件下的速度。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-11T16:48:55.980

使用主要基于 Intel Pentium 架构的描述来缩短一个非常长的故事：

*   处理器有许多“执行单元”，可以执行不同类型的“微操作”；指令可以分成几个微操作
*   不同的执行单元本质上是并行运行的
*   每个微操作都会占用相应的执行单元一定数量的时钟周期，因此同时没有其他指令可以使用该执行单元：例如“浮点加法”可能会占用“FP 执行”单元 2 个时钟周期
*   执行单元按“端口”分组，每个时钟周期，可以向每个端口发送一个新的微操作（假设此时相关执行单元空闲）；一些单位也可以在循环中途被发送一个“额外的操作”；所以每个时钟周期，一定数量的操作可以*开始*执行；
*   处理器可以在不破坏依赖关系的情况下（或仍然可以重建结果）重新排序微操作，以利用在给定时刻哪些执行单元是空闲的
*   所以指令可以并行执行，但是在任何时候执行的指令的哪些部分是相当复杂的情况
*   因此，给定指令的总时间取决于它必须“等待”必要的执行单元可用的时间、这些操作在给定单元上运行所花费的实际时间，以及“占用结果”

由于指令的时序取决于周围的指令，因此在实践中，通常最好对**具有代表性的代码段进行计时，而**不是尝试担心单个指令。然而：

*   英特尔（可能还有其他制造商）发布指令**吞吐量**和**延迟**时间列表
*   **吞吐量**是相关执行单元上实际需要的时钟周期数
*   **延迟**是“最坏情况”所需的时钟周期数，一旦指令开始执行，在该执行结果可用作另一条指令的输入之前

因此，例如，如果浮点加法和乘法指令的吞吐量为 2，延迟为 5（实际上，乘法我认为它要大一些），这意味着向自身添加一个寄存器或将其乘以本身可能需要两个时钟周期（因为没有其他相关值），而将它添加到先前乘法的结果将需要大约或略小于 2+5 个时钟周期，具体取决于您开始/结束计时的位置，并且关于其他各种事情。（在其中一些时钟周期中，可能会发生另一个加法/乘法运算，因此无论如何您实际上将多少个周期归因于各个加法/乘法指令是有争议的......）

哦，作为一个具体的例子。对于以下 Java 代码

```
public void runTest(double[] data, double randomVal) {
  for (int i = data.length-1; i >= 0; i--) {
    data[i] = data[i] + randomVal;
  }
} 
```

Hotspot 1.6.12 JIT 将内部循环序列编译为以下英特尔代码，包括数组中每个位置的加载-添加-存储（在这种情况下，“randomVal”保存在 XMM0a 中）：

```
 0b3     MOVSD  XMM1a,[EBP + #16]
  0b8     ADDSD  XMM1a,XMM0a
  0bc     MOVSD  [EBP + #16],XMM1a
  0c1     MOVSD  XMM1a,[EBP + #8]
  0c6     ADDSD  XMM1a,XMM0a
  0ca     MOVSD  [EBP + #8],XMM1a
  ... 
```

每组**load-add-store 似乎需要 5 个时钟周期**。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-11T16:01:28.837

没那么简单。您的两条指令的时间安排不会帮助您评估大量指令的性能。这是因为现代处理器可以并行执行许多操作，并且具有大型缓存，因此“将值移动到内存”发生在与指令执行完全不同的时间。

因此，最佳情况为零（与其他指令并行执行时）。但这对你有什么帮助？

[该](http://www.roylongbottom.org.uk/cpuspeed.htm)网页显示了一些基准测试，包括一些 %MIPS/MHz 结果。如您所见，在许多基准测试中，每个时钟周期执行多条指令。这些图表还显示了缓存大小和内存速度的影响。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-01-11T16:38:15.297

现代处理器做的事情甚至更棘手。

乱序执行。如果可以在不影响正确行为的情况下这样做，处理器可能会以与程序中列出的顺序不同的顺序执行指令。这可以隐藏长时间运行指令的延迟。

注册重命名。处理器通常在其指令集中拥有比可寻址寄存器更多的物理寄存器（所谓的“架构”寄存器）。这可以是为了向后兼容，也可以只是为了启用有效的指令编码。当程序运行时，处理器会将其使用的架构寄存器“重命名”为任何空闲的物理寄存器。这允许处理器实现比原始程序中更多的并行性。

例如，如果您对 EAX 和 ECX 进行长序列操作，然后执行将 EAX 和 ECX 重新初始化为新值并执行另一长序列操作的指令，则处理器可以为这两个任务使用不同的物理寄存器，并执行他们并行。

英特尔 P6 微架构同时进行乱序执行和寄存器重命名。Core 2 架构是 P6 的最新衍生产品。

要真正回答您的问题 - 面对所有这些架构优化，您基本上不可能手动确定性能。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-01-11T20:45:32.757

你要求的那种预测是没有希望的。

如果你想要一个经验法则，这里有一些经验法则：

*   在从二级缓存中获取一个字所需的时间内，一个处理器可以执行至少 10 条指令。所以担心内存访问，而不是指令计数——寄存器中的计算几乎是免费的。

*   在从 RAM 中获取一个字所需的时间中，处理器可以执行数千条指令（这个数字会根据您的硬件细节有几个数量级的变化）。确保这只发生在冷缓存上；否则没有其他事情了。

*   如果您在 x86 CPU 上运行，则没有足够的寄存器。任何时候都尽量不要在代码中包含超过 5 个实时变量。或者更好的是，转向 AMD64 ( `x86_64`) 并将寄存器数量翻倍。有 16 个寄存器，并且参数在寄存器中传递，您可以不用担心寄存器。

每年都有一段时间我会问架构师我应该使用什么经验法则来预测我的编译器生成的代码的成本。我已经停下来了，因为我最后一次收到有用的答案是在 1999 年。（答案是“确保你的循环适合重新排序缓冲区”。所有知道什么是重新排序缓冲区的人现在都可以举手。奖金如果您可以发现您当前使用的任何计算机上的重新排序缓冲区的大小，则为积分。）

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-02-21T08:55:31.853

这仅回答了您的部分问题，但我发现 Wikipedia 中关于[参考位置的](http://en.wikipedia.org/wiki/Locality_of_reference)此表很有帮助。它描述了内存层次结构不同级别的访问速度和内存量，使用了大约 2006 次：

*   CPU 寄存器（8-32 个寄存器）——立即访问（0-1 个时钟周期）
*   L1 CPU 缓存（32 KiB 到 128 KiB）——快速访问（3 个时钟周期）
*   L2 CPU 缓存（128 KiB 到 12 MiB）——访问速度稍慢（10 个时钟周期）
*   主物理内存 (RAM)（256 MiB 到 4 GiB）——慢速访问（100 个时钟周期）
*   磁盘（文件系统）（1 GiB 到 1 TiB）——非常慢（10,000,000 个时钟周期）
*   远程内存（例如其他计算机或互联网）（几乎无限制）- 速度各不相同

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-01-26T16:55:48.043

[您可以在此处](http://www.intel.com/products/processor/manuals/)下载 Intel 64 和 IA-32 手册。

但是你真正需要的是来自[Agner Fog](http://www.agner.org/optimize/)的东西。

他有很多额外的信息，例如他的手册[“指令表：Intel 和 AMD CPU 的指令延迟、吞吐量和微操作故障列表”](http://www.agner.org/optimize/instruction_tables.pdf)。

或者测试用于计算时钟周期的程序（他使用*时间戳计数器*）。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-01-27T05:32:21.433

在这个线程上已经有很多很好的答案，但是到目前为止没有提到一个主题：*分支错误预测*。

因为所有现代处理器都是流水线的，所以当指令解码器运行到类似“如果相等时跳转”的指令时，它不知道指令会跳转到哪个方向，所以它只是猜测。然后它继续根据该猜测将指令输入管道。如果它做出了正确的预测，跳转指令的吞吐量和延迟基本上为零。如果猜错了，同一条跳转指令的吞吐量和延迟可能是 50 或 100 个周期。

请注意，同一条指令第一次在循环中执行时可能具有“零成本”，而下一次执行同一条指令时的成本非常高！

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-01-11T17:59:34.667

您所需要的只是相应的 CPU 手册。AMD 和 Intel 都在他们的网站上提供了 PDF，描述了每条指令的延迟。

请记住现代 CPU 的复杂性。它们一次不执行一条指令，每个周期可以加载 3-4 条指令，并且几乎所有指令都是流水线的，因此当加载下一条指令时，当前的指令还远未完成。它还对指令重新排序以实现更有效的调度。现代 CPU 一次可以轻松处理 50 条指令。

所以你问错问题了。一条指令所花费的时间因测量方式和时间而异。除了缓存等简单问题外，这取决于指令解码器的繁忙程度、分支预测器、调度以及正在调度哪些*其他指令。*

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-01-27T05:38:10.000

我建议下载 AMD[软件优化指南](http://www.amd.com/us-en/assets/content_type/white_papers_and_tech_docs/40546.pdf)。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-01-11T16:15:22.833

正如 Doug 已经指出的，最好的情况是零（超标量处理器、多个执行单元、数据已经在 L1 缓存中）。

最坏的情况是长达几毫秒（当操作系统处理页面错误并且必须从磁盘获取数据/指令时）。排除磁盘/交换它仍然取决于您是否有 NUMA 机器，它具有哪种拓扑，数据位于哪个内存节点，是否有来自另一个 CPU 的并发访问（总线锁定和缓存同步协议）等。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-01-11T18:14:33.543

[Alan Kay 在 2004 年](http://queue.acm.org/detail.cfm?id=1039523)的一句有趣的话：

> 顺便说一句，为您提供一个有趣的基准测试——在大致相同的系统上，以相同的方式进行大致优化，Xerox PARC 1979 年的基准测试现在只快 50 倍。摩尔定律在那段时间给我们带来了 40,000 到 60,000 倍的改进。因此，糟糕的 CPU 架构损失了大约 1,000 倍的效率。

这似乎意味着 CPU 性能增强似乎集中在它们对我们真正编写的软件影响相对较小的领域。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-26T17:32:46.830

我不认为最坏的情况仅限于某些平台。当您有多个内核和处理器争夺相同的位置或相邻的内存位置时，您会看到各种性能下降。缓存行必须在处理器之间移动。对于现代平台上的内存操作，我还没有看到一个好的最坏情况数字。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-11-14T01:55:44.743

这花了将近 11 年，但我有一个估计。您的循环大约是 10 `ops`* 1 亿次迭代，所以大约 10 亿次`ops`。在 2.3 GHz 机器上，我估计大约需要 0.4 秒。当我测试它时，我实际上得到了 1.2 秒。所以它在一个数量级之内。

只需获取您的核心频率，估计`ops`，然后划分。这给出了一个非常粗略的估计，每当我进行经验测试时，我的误差从未超过一个数量级。只要确保你的`op`估计是合理的。

# c# - C# 表达式中的溢出 好吗？

> ID：433106
> 
> 赞同：0
> 
> 时间：2009-01-11T15:55:00.347
> 
> 标签：c#

在以下情况下，表达式中的溢出以何种方式是可取的：

1.  计算哈希值
2.  计算校验和

?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-11T16:03:32.293

只要您期望操作可能会溢出，并且您尝试做的事情的定义允许溢出（或因此可能需要溢出），它会让生活变得更轻松。

例如，一种计算哈希的算法是：

*   以素数开头
*   对于对象中的每个字段，将当前结果乘以另一个素数，然后添加字段的哈希

例如：

```
int ret = 37;
ret = ret * 37 + field1.GetHashCode() * 23;
ret = ret * 37 + field2.GetHashCode() * 23;
ret = ret * 37 + field3.GetHashCode() * 23;
return ret; 
```

在这里，任何计算都可能溢出，但这没关系 - 我们对数字的大小并不真正感兴趣，只是目标可能对于不同的对象不同，但对于相同的对象是相同的。

试图在不溢出的情况下做到这一点是一件痛苦的事情——你可以使用 XOR，但这还有其他缺点。

# java - Java 环境中大容量日志事件查看器的建议

> ID：433110
> 
> 赞同：13
> 
> 时间：2009-01-11T15:59:04.300
> 
> 标签：java, logging

我的情况是，我想接受由我控制的大量日志事件——尤其是我正在为 slf4j 准备的日志代理——然后以交互方式分析它们。

我对提供格式化日志文件的工具不感兴趣，但它可以接受日志事件作为对象并允许我在线程和时间线等上进行排序和显示。

Chainsaw 可能是一种选择，但目前与我出于技术原因使用的 logback 不兼容。

是否有任何具有独立查看器或嵌入在 IDE 中的项目适合这种日志处理。我知道我正在接近可能适合探查器的东西，所以如果有适合这种数据采集和显示的探查器项目，我可以在其中提供事件管道，我想听听）。

* * *

2009-03-19 更新：我发现没有日志查看器可以让我查看我想要的内容（事件的可视化显示，坐标由日期和时间等确定），所以我决定创建一个从 log4j XMLLayout 派生的非常简洁的 XML 格式适合尽可能可读，同时仍然是有效的 XML 片段，然后使用 Microsoft LogParser 提取我需要在其他工具中进行后处理的信息。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-16T11:37:31.160

您可以实现一个用于 logback 的适配器，以将 log4j 事件发送到 log4j 接收器。这将使您能够使用电锯。或者构建一个接收 logback 网络事件并将它们公开给 log4j 的适配器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-11T16:20:23.463

看看[splunk](http://www.splunk.com/)，它不会做您正在寻找的特定事情，但也许它可以帮助您实现最终目标。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T21:13:40.077

尝试[**logFaces**](http://www.moonlit-software.com "logFaces")，它应该会有所帮助。

**披露**：我是该产品的作者。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-05T22:32:48.777

鉴于这个问题的主题，我只***需要***提到[Lilith](http://lilith.huxhorn.de)，我正在自己开发的日志事件查看器。

It supports Logback access and logging events over the network (incl. a special high-performance appender implementation) and is able to import LOG4J-XML- and java.util.logging-XML-files.

Best of all, it's free, open source and I'm always curious about what features might be missing ;)

And yes, the site is crap. The app is much better, I promise :)
Just check it out.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-16T20:23:01.750

看看[TraceTool](http://tracetool.sourceforge.net/)（更新版本[在这里](http://www.codeproject.com/KB/trace/tracetool.aspx)）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T12:01:33.577

查看[LogLogic](http://www.loglogic.com/)

...

# git - 如何使 git 将已删除文件和新文件标记为文件移动？

> ID：433111
> 
> 赞同：642
> 
> 时间：2009-01-11T16:01:08.743
> 
> 标签：git

我手动移动了一个文件，然后我修改了它。根据 Git，它是一个新文件和一个已删除文件。有什么方法可以强制 Git 将其视为文件移动？

* * *

## 回答 #1

> 赞同：533
> 
> 时间：2009-01-11T16:18:36.617

如果您的修改不太严重，Git 将自动检测移动/重命名。只是`git add`新文件和`git rm`旧文件。`git status`然后将显示它是否检测到重命名。

此外，对于在目录中移动，您可能需要：

1.  cd 到该目录结构的顶部。
2.  跑`git add -A .`
3.  运行`git status`以验证“新文件”现在是“重命名”文件

如果 git status 仍然显示“新文件”而不是“重命名”，您需要遵循[Hank Gay 的](https://stackoverflow.com/a/433114/107768)建议，并在两个单独的提交中进行移动和修改。

* * *

## 回答 #2

> 赞同：143
> 
> 时间：2009-01-11T16:02:19.740

在单独的提交中进行移动和修改。

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2009-01-12T00:05:36.627

`git diff -M`或者`git log -M`应该自动检测此类更改，例如*带有微小更改的重命名，*只要它们确实如此。如果您的*微小更改*不是微小的，您可以降低相似度阈值，例如

```
$ git log -M20 -p --stat 
```

将其从默认的 50% 减少到 20%。

* * *

## 回答 #4

> 赞同：46
> 
> 时间：2009-01-11T16:25:40.673

这都是感性的事情。Git 通常比较擅长识别动作，因为**GIT**是一个**内容跟踪器**

真正取决于您的“统计”如何显示它。这里唯一的区别是 -M 标志。

**git log --stat -M**

```
commit 9c034a76d394352134ee2f4ede8a209ebec96288
Author: Kent Fredric
Date:   Fri Jan 9 22:13:51 2009 +1300

        Category Restructure

     lib/Gentoo/Repository.pm                |   10 +++++-----
     lib/Gentoo/{ => Repository}/Base.pm     |    2 +-
     lib/Gentoo/{ => Repository}/Category.pm |   12 ++++++------
     lib/Gentoo/{ => Repository}/Package.pm  |   10 +++++-----
     lib/Gentoo/{ => Repository}/Types.pm    |   10 +++++-----
     5 files changed, 22 insertions(+), 22 deletions(-) 
```

**git 日志 --stat**

```
commit 9c034a76d394352134ee2f4ede8a209ebec96288
Author: Kent Fredric
Date:   Fri Jan 9 22:13:51 2009 +1300

    Category Restructure

 lib/Gentoo/Base.pm                |   36 ------------------------
 lib/Gentoo/Category.pm            |   51 ----------------------------------
 lib/Gentoo/Package.pm             |   41 ---------------------------
 lib/Gentoo/Repository.pm          |   10 +++---
 lib/Gentoo/Repository/Base.pm     |   36 ++++++++++++++++++++++++
 lib/Gentoo/Repository/Category.pm |   51 ++++++++++++++++++++++++++++++++++
 lib/Gentoo/Repository/Package.pm  |   41 +++++++++++++++++++++++++++
 lib/Gentoo/Repository/Types.pm    |   55 +++++++++++++++++++++++++++++++++++++
 lib/Gentoo/Types.pm               |   55 -------------------------------------
 9 files changed, 188 insertions(+), 188 deletions(-) 
```

**git帮助日志**

```
 -M
       Detect renames.

   -C
       Detect copies as well as renames. See also --find-copies-harder. 
```

* * *

## 回答 #5

> 赞同：44
> 
> 时间：2009-10-08T23:22:19.333

Here's a quick and dirty solution for one, or a few, renamed and modified files that are uncommitted.

Let's say the file was named `foo` and now it's named `bar`:

1.  Rename `bar` to a temp name:

    ```
    mv bar side 
    ```

2.  Checkout `foo`:

    ```
    git checkout HEAD foo 
    ```

3.  Rename `foo` to `bar` with Git:

    ```
    git mv foo bar 
    ```

4.  Now rename your temporary file back to `bar`.

    ```
    mv side bar 
    ```

This last step is what gets your changed content back into the file.

While this can work, if the moved file is too different in content from the original git will consider it more efficient to decide this is a new object. Let me demonstrate:

```
$ git status
On branch workit
Changes to be committed:
  (use "git reset HEAD <file>..." to unstage)

    new file:   .gitignore
    renamed:    README -> README.md

Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git checkout -- <file>..." to discard changes in working directory)

    modified:   README.md
    modified:   work.js

$ git add README.md work.js # why are the changes unstaged, let's add them.
$ git status
On branch workit
Changes to be committed:
  (use "git reset HEAD <file>..." to unstage)

    new file:   .gitignore
    deleted:    README
    new file:   README.md
    modified:   work.js

$ git stash # what? let's go back a bit
Saved working directory and index state WIP on dir: f7a8685 update
HEAD is now at f7a8685 update
$ git status
On branch workit
Untracked files:
  (use "git add <file>..." to include in what will be committed)

    .idea/

nothing added to commit but untracked files present (use "git add" to track)
$ git stash pop
Removing README
On branch workit
Changes to be committed:
  (use "git reset HEAD <file>..." to unstage)

    new file:   .gitignore
    new file:   README.md

Changes not staged for commit:
  (use "git add/rm <file>..." to update what will be committed)
  (use "git checkout -- <file>..." to discard changes in working directory)

    deleted:    README
    modified:   work.js

Dropped refs/stash@{0} (1ebca3b02e454a400b9fb834ed473c912a00cd2f)
$ git add work.js
$ git status
On branch workit
Changes to be committed:
  (use "git reset HEAD <file>..." to unstage)

    new file:   .gitignore
    new file:   README.md
    modified:   work.js

Changes not staged for commit:
  (use "git add/rm <file>..." to update what will be committed)
  (use "git checkout -- <file>..." to discard changes in working directory)

    deleted:    README

$ git add README # hang on, I want it removed
$ git status
On branch workit
Changes to be committed:
  (use "git reset HEAD <file>..." to unstage)

    new file:   .gitignore
    deleted:    README
    new file:   README.md
    modified:   work.js

$ mv README.md Rmd # Still? Try the answer I found.
$ git checkout README
error: pathspec 'README' did not match any file(s) known to git.
$ git checkout HEAD README # Ok the answer needed fixing.
$ git status
On branch workit
Changes to be committed:
  (use "git reset HEAD <file>..." to unstage)

    new file:   .gitignore
    new file:   README.md
    modified:   work.js

Changes not staged for commit:
  (use "git add/rm <file>..." to update what will be committed)
  (use "git checkout -- <file>..." to discard changes in working directory)

    deleted:    README.md
    modified:   work.js

Untracked files:
  (use "git add <file>..." to include in what will be committed)

    Rmd

$ git mv README README.md
$ git status
On branch workit
Changes to be committed:
  (use "git reset HEAD <file>..." to unstage)

    new file:   .gitignore
    renamed:    README -> README.md
    modified:   work.js

Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git checkout -- <file>..." to discard changes in working directory)

    modified:   work.js

Untracked files:
  (use "git add <file>..." to include in what will be committed)

    Rmd

$ mv Rmd README.md
$ git status
On branch workit
Changes to be committed:
  (use "git reset HEAD <file>..." to unstage)

    new file:   .gitignore
    renamed:    README -> README.md
    modified:   work.js

Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git checkout -- <file>..." to discard changes in working directory)

    modified:   README.md
    modified:   work.js

$ # actually that's half of what I wanted; \
  # and the js being modified twice? Git prefers it in this case. 
```

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2014-07-12T14:13:47.670

If you're talking about `git status` not showing the renames, try `git commit --dry-run -a` instead

* * *

## 回答 #7

> 赞同：21
> 
> 时间：2018-05-07T08:59:22.790

*Or you coud try the answer to this question [here](https://stackoverflow.com/a/4708679/1474291) by [Amber](https://stackoverflow.com/a/4708679/1474291)! To quote it again:*

First, cancel your staged add for the manually moved file:

```
$ git reset path/to/newfile
$ mv path/to/newfile path/to/oldfile 
```

Then, use Git to move the file:

```
$ git mv path/to/oldfile path/to/newfile 
```

Of course, if you already committed the manual move, you may want to reset to the revision before the move instead, and then simply git mv from there.

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2013-05-02T12:01:40.737

If you're using TortoiseGit it's important to note that Git's automatic rename detection happens during commit but the fact that this is going to happen isn't always displayed by the software beforehand. I had moved two files to a different directory and performed some slight edits. I use TortoiseGit as my commit tool and the Changes made list showed the files being deleted and added, not moved. Running git status from the command line showed a similar situation. However after committing the files, they showed up as being renamed in the log. So the answer to your question is, as long as you haven't done anything too drastic, Git should pick up the rename automatically.

Edit: Apparently if you add the new files and then do a git status from the command line, the rename should show up before committing.

Edit 2: In addition, in TortoiseGit, add the new files in the commit dialog but don't commit them. Then if you go into the Show Log command and look at the working directory, you'll see if Git has detected the rename before committing.

The same question was raised here: [https://tortoisegit.org/issue/1389](https://tortoisegit.org/issue/1389) and has been logged as a bug to fix here: [https://tortoisegit.org/issue/1440](https://tortoisegit.org/issue/1440) It turns out it's a display issue with TortoiseGit's commit dialog and also kind of exists in git status if you haven't added the new files.

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2017-05-09T17:38:52.133

Use `git mv` command to move the files, instead of the OS move commands: [https://git-scm.com/docs/git-mv](https://git-scm.com/docs/git-mv)

Please note that `git mv` command only exists in Git versions 1.8.5 and up. So you may have to update your Git to use this command.

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2020-10-09T16:34:29.690

The other answers already cover that you can simply `git add NEW && git rm OLD` in order to make git recognize the move.

However, if you have already modified the file in the working directory, the add+rm approach will add the modifications to the index, which may be undesired in some cases (e.g. in case of substantial modifications, git might not recognize anymore that it is a file rename).

Let's assume you want to add the *rename* to the index, but not any modifications. The obvious way to achieve this, is to do a back and forth rename `mv NEW OLD && git mv OLD NEW`.

But there is also a (slighty more complicated) way to do this directly in the index without renaming the file in the working tree:

```
info=$(git ls-files -s -- "OLD" | cut -d' ' -f-2 | tr ' ' ,)
git update-index --add --cacheinfo "$info,NEW" &&
git rm --cached "$old" 
```

This can also be put as an alias in your `~/.gitconfig`:

```
[alias]
    mv-index = "!f() { \
      old=\"$1\"; \
      new=\"$2\"; \
      info=$(git ls-files -s -- \"$old\" | cut -d' ' -f-2 | tr ' ' ,); \
      git update-index --add --cacheinfo \"$info,$new\" && \
      git rm --cached \"$old\"; \
    }; f" 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2017-06-02T18:46:19.850

I had this problem recently, when moving (but not modifying) some files.

The problem is that Git changed some line endings when I moved the files, and then wasn't able to tell that the files were the same.

Using `git mv` sorted out the problem, but it only works on single files / directories, and I had a lot of files in the root of the repository to do.

One way of fixing this would be with some bash / batch magic.

Another way is the following

*   Move the files and `git commit`. This updates the line endings.
*   Move the files back to their original location, now that they have the new line endings, and `git commit --amend`
*   Move the files again and `git commit --amend`. There is no change to the line endings this time so Git is happy

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-04-08T09:06:54.947

For me it worked to stash save all the changes before the commit and pop them out again. This made git re-analyze the added / deleted files and it correctly marked them as moved.

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-05-13T13:30:35.027

There is a probably a better “command line” way to do this, and I know this is a hack, but I’ve never been able to find a good solution.

Using TortoiseGIT: If you have a GIT commit where some file move operations are showing up as load of adds/deletes rather than renames, even though the files only have small changes, then do this:

1.  Check in what you have done locally
2.  Check in a mini one-line change in a 2nd commit
3.  Go to GIT log in tortoise git
4.  Select the two commits, right click, and select “merge into one commit”</li>

The new commit will now properly show the file renames… which will help maintain proper file history.

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-07-17T19:18:26.177

The way I understand this question is "How to make git recognize a deletion of an old file and creation of a new file as a file move".

Yes in the working directory once you delete an old file and inserted an old file, `git status` will say "`deleted: old_file`" and "`Untracked files: ... new_file`"

But in the staging index/level once you add and remove file using git it will be recognized as a file move. To do so, assuming you have done the deletion and creation using your Operation System, give the following commands:

```
git add new_file
git rm old_file 
```

If the contents of the file are 50% or more similar, running `git status` command should give you:

```
renamed: old_file -> new_file 
```

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2017-07-16T11:00:36.397

When I edit, rename, and move a file at the same time, none of these solutions work. The solution is to do it in two commits (edit and rename/move seperate) and then `fixup` the second commit via `git rebase -i` to have it in one commit.

# web-applications - 编写基于 Web/桌面的应用程序

> ID：433121
> 
> 赞同：1
> 
> 时间：2009-01-11T16:06:25.173
> 
> 标签：web-applications, desktop-application

我想创建一个类似于[http://www.basecamphq.com/](http://www.basecamphq.com/)的简单程序，它允许您跟踪将在计算机网络或网络上运行的项目的进度和完成情况（实际上是最容易完成的）

该程序将相对简单，但需要有一个可以使用简单界面进行编辑的数据库，然后将为所有用户更新。我想用免费软件来做这个。关于语言什么是合适的使用。这可以使用 php 和 MySQl 来实现，还是有更好的选择？

非常感谢任何答案

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-11T16:08:32.813

它可以通过 PHP/MySQL 轻松完成，这完全取决于**您更熟悉哪种语言和系统**。

除了几乎所有流行的网络语言都可以。但是 PHP 和 ASP.NET 或 Ruby On Rails 不会出错。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-11T16:12:10.547

PHP 和 MySQL 足以满足您的需求。如果您需要一个简单的界面来编辑您的数据库，如果您不想使用内置的 MySQL 工具，您可以将[PHPMyAdmin作为您的数据库界面。](http://www.phpmyadmin.net/home_page/index.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-11T16:13:30.247

Basecamp 本身是用 Ruby on Rails 编写的，由将 Ruby on Rails 推向世界的人。所以这显然是一个很好的起点。您认为 Basecamp 中是否缺少什么特别的东西，或者您为什么要重新发明那个特定的轮子？（请注意，它已经被一遍又一遍地发明了。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-11T16:14:36.733

basecamp 是用 ruby​​ on rails 开发的——事实上，rails 本质上是一个框架，它是从那个应用程序和其他应用程序中提取出来的。所以 rails 是一个不错的选择，因为它已经针对这种应用进行了调整。

我还怀疑您可能会惊讶于在您自己的 Rails 应用程序中获得大约 80% 的 basecamp 功能是多么容易和快速。为至少一两个星期的学习曲线做好准备，但这是值得的。

# compact-framework - 如何判断我的应用程序中的任何表单是否在前台

> ID：433135
> 
> 赞同：1
> 
> 时间：2009-01-11T16:15:57.183
> 
> 标签：compact-framework

我希望我的紧凑框架应用程序仅在“在后台”运行时才显示通知气泡。该应用程序有几种形式，可能随时可见，也可能不可见。我希望通知处理程序（在后台单独线程上运行）能够判断我的应用程序中的任何表单当前是否在屏幕上可见。

有没有一种我想念的简单方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-11T18:00:39.670

您可以随时[监控应用程序中的表单和流程何时发生变化](http://community.opennetcf.com/articles/cf/archive/2008/08/13/determining-form-and-process-changes-in-windows-ce.aspx)并采取相应措施。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-11T17:19:28.490

假设有一种方法，这里有一个竞争条件。如果您确定表单在前台，但同时用户刚刚将其他内容移到前台，您会怎么做？您的通知可能会丢失。

# ruby-on-rails - 从 Rails 生成 PDF

> ID：433136
> 
> 赞同：38
> 
> 时间：2009-01-11T16:16:37.777
> 
> 标签：ruby-on-rails, pdf, pdf-generation

[Ruby On Rails Wiki 列出了几个](http://wiki.rubyonrails.org/rails/pages/HowtoGeneratePDFs)有助于在**Rails**中生成**PDF**的库。我需要打印出地址标签（以字母格式，因此每页 12-15 个地址）并且无法决定使用哪一个。有什么建议吗？

 *** * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-01-11T16:52:54.193

到目前为止我见过的最好的是虾：

*   大虾[http://prawn.majesticseaacreature.com/](http://prawn.majesticseacreature.com/)
*   [http://advent2008.hackruby.com/past/2008/12/17/awn_and_the_future_of_ruby_pdf_generation/](http://advent2008.hackruby.com/past/2008/12/17/awn_and_the_future_of_ruby_pdf_generation/)
*   [http://railstips.org/2008/10/14/how-to-generate-pdfs-in-rails-with-prawn](http://railstips.org/2008/10/14/how-to-generate-pdfs-in-rails-with-prawn)
*   Prawn Rails 插件：[http ://www.cracklabs.com/prawnto](http://www.cracklabs.com/prawnto)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-11T20:21:45.317

对虾肯定是Prawnto。DSL 是一种真正的享受，就像在 respond_to 格式块中能够将 PDF 视为任何其他格式一样简单：

```
respond_to do |format|
format.pdf { render :layout => false } 
```

[这里](http://railscasts.com/episodes/153-pdfs-with-prawn)有一个关于虾的教程视频：

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-11T18:20:54.217

还有[RTeX](http://rtex.rubyforge.org/)。如果您愿意先翻译成[LaTeX](http://www.latex-project.org/) ，那效果很好。LaTeX 是一种非常好的存储标记文档的方法。这仅取决于每个文档的静态程度。如果大部分文档是动态的，那么使用 Prawn 或 PDF::Writer 可能会更好。如果大部分是静态的，每个只有几个文本替换，那么 LaTeX 可能是更好的选择。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-10-16T14:37:11.157

大虾是要走的路。现在有了虾标签，这真的很容易做到。

在此处查看项目的 README：

[https://github.com/jordanbyron/prawn-labels#readme](https://github.com/jordanbyron/prawn-labels#readme)

这是一个在 Rails 控制器中使用的超级简单的示例。不要忘记添加`gem 'prawn-labels'`到您的 Gemfile。

```
names = %w{Jordan Kelly Greg Bob}

labels = Prawn::Labels.render(names, :type => "Avery5160") do |pdf, name|
  pdf.text name
end

send_data labels, :filename => "names.pdf", :type => "application/pdf" 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-12-22T23:28:19.713

如果您没有做任何太复杂的事情，您还可以使用 HTMLDOC，它将基本的 HTML 转换为 PDF。这使您不必学习更多专有的布局语法（例如在 Prawn 的情况下）。它可能会为您省去一些麻烦:)

这是 HTMLDOC 的 ruby​​ gem 的链接：

*   [http://htmldoc.rubyforge.org/](http://htmldoc.rubyforge.org/)

此外，这里是使用 HTMLDOC 将 rails 中的视图呈现为 pdf 的一个很好的指南：

*   [http://blog.adsdevshop.com/2007/11/20/easy-pdf-generation-with-ruby-rails-and-htmldoc/](http://blog.adsdevshop.com/2007/11/20/easy-pdf-generation-with-ruby-rails-and-htmldoc/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-10-02T14:41:00.463

还有[PDFKit](https://github.com/pdfkit/pdfkit)。这也很有趣。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-11T17:59:00.580

我同时使用了 PDF::Writer 和 Prawn，发现 Prawn 使用起来更愉快。查看[Ruby Mendicant](http://www.oreillynet.com/ruby/blog/2008/03/the_ruby_mendicant_project.html)进行[比较](http://www.oreillynet.com/ruby/blog/2008/07/ruby_mendicant_permian_prawn.html)，以展示 Prawn w/r/t PDF::Writer 的乐趣。

实际上，不管怎样，只要看看 Ruby Mendicant 就可以找到适合作为开发人员谋生的伟大[设计模式。](http://www.oreillynet.com/ruby/blog/2008/03/the_ruby_mendicant_project.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-04-29T07:27:33.103

虽然不完全是 ruby​​，但您可以使用 OpenOffice .odt 通过结合 serenity 和 docsplit 来生成 PDF。

[http://github.com/kremso/serenity](http://github.com/kremso/serenity)

[http://documentcloud.github.com/docsplit/](http://documentcloud.github.com/docsplit/)

或者您可以使用使用 odt 和 cups-pdf 的 clamsy gem 来生成 PDF。

[http://github.com/ngty/clamsy](http://github.com/ngty/clamsy)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-04-09T19:51:27.510

对于您的用例，我同意大多数其他[`prawn`](http://prawn.majesticseacreature.com/)正确选择的答案，因为您需要对输出进行像素级控制。

要生成带有内置（自有）表格样式、标题等的 PDF 报告，您可以使用[`report`](https://github.com/seamusabshere/report)gem - 查看[Generate pdf from Rails 3 - 选择什么工具？](https://stackoverflow.com/questions/4117884/generate-pdf-from-rails-3-what-tool-to-choose/15817893#15817893)有关如何使用的示例。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-04-10T10:14:06.610

我使用飞碟从 html 生成 pdf。它是一个 java 库，但您可以使用 Ruby-Java Bridge gem 在您的 rails 应用程序中访问它。它与 css 2.1 兼容，并从 css3 中添加了一些内容，以允许对分页进行一些额外的控制。我推荐它，因为它不需要您在 html 中放置“pdf 代码”，您可以使用相同的视图和部分显示到浏览器，就像生成 pdf 一样。

飞碟：[https ://github.com/flyingsaucerproject/flyingsaucer](https://github.com/flyingsaucerproject/flyingsaucer)

Ruby Java 桥：[http ://rjb.rubyforge.org/](http://rjb.rubyforge.org/)

我使用此模块代码生成 pdf

```
require 'rubygems'
require 'rjb'

module Html2Pdf

  def self.included(controller)
      controller.send :helper_method, :create_pdf
  end

  def create_pdf(options = {})
      itext = "#{RAILS_ROOT}/lib/html2pdf/jars/iText-2.0.8.jar"
      core_renderer = "#{RAILS_ROOT}/lib/html2pdf/jars/core-renderer.jar"
      xerces = "#{RAILS_ROOT}/lib/html2pdf/jars/xml-apis-xerces-2.9.1.jar" 
      joinchar = (RUBY_PLATFORM.include? 'mswin') ? ';' : ':'
          classpath = [itext, core_renderer, xerces].join(joinchar)
      Rjb::load(classpath, jvmargs=['-Djava.awt.headless=true'])
      if options[:htmlstring].nil?
      options[:layout] ||= false
          options[:template] ||= File.join(controller_path,action_name+".pdf.erb")
          html_string = render_to_string(:template => options[:template], :layout => options[:layout])
    else
          html_string = options[:htmlstring]
    end
    # Make all paths relative, on disk paths...
    html_string.gsub!(".com:/",".com/") # strip out bad attachment_fu URLs
    html_string.gsub!( /src=["']+([^:]+?)["']/i ) { |m| "src=\"file:///#{RAILS_ROOT}/public/" + $1 + '"' } # re-route absolute paths
    html_string.gsub!( /url\(["']+([^:]+?)["']/i ) { |m| "url\(\"file:///#{RAILS_ROOT}/public/" + $1 + '"' } # re-route absolute paths
    # Remove asset ids on images with a regex // tbh i can't remember what this line is for but i'm sure it did something awesome
    html_string.gsub!( /src=["'](\S+\?\d*)["']/i ) { |m| 'src="' + $1.split('?').first + '"' } 
    filename = "#{RAILS_ROOT}/public/pdfs/"+options[:filename]+".pdf"
    fileOutputStream = Rjb::import('java.io.FileOutputStream')
      iTextRenderer = Rjb::import('org.xhtmlrenderer.pdf.ITextRenderer')
      renderer = iTextRenderer.new
      renderer.setDocumentFromString(html_string)
      os = fileOutputStream.new(filename)
      renderer.layout()
      renderer.createPDF(os)
      os.close()
  end

end 
```

用这样的代码调用它：

```
def generate_pdf  
  htmlsrc = render_to_string(:partial => 'invoice', :layout => false)
  rnd = Time.now.to_s(:datentime).gsub!(/[\/ \.:]/,'')
  filename = "docstore/tmp_#{rnd}"
  create_pdf(:htmlstring => htmlsrc, :filename => filename)
  contents = open("#{RAILS_ROOT}/public/pdfs/#{filename}.pdf", "rb") { |io| io.read }
  File.delete("#{RAILS_ROOT}/public/pdfs/#{filename}.pdf")
  respond_to do | wants |
    wants.html { render :text => contents, :content_type => 'application/pdf' }
  end    
end 
```

# django - 我可以从 Django 中的模板访问 settings.py 中的常量吗？

> ID：433162
> 
> 赞同：418
> 
> 时间：2009-01-11T16:32:47.133
> 
> 标签：django, django-templates, django-settings

我在 settings.py 中有一些我希望能够从模板访问的东西，但我不知道该怎么做。我已经试过了

```
{{CONSTANT_NAME}} 
```

但这似乎不起作用。这可能吗？

* * *

## 回答 #1

> 赞同：493
> 
> 时间：2009-01-11T17:01:03.927

如果您希望每个请求和模板都具有该值，则使用[上下文处理器](https://docs.djangoproject.com/en/stable/ref/templates/api/#writing-your-own-context-processors)更合适。

就是这样：

1.  在您的应用程序目录中创建一个`context_processors.py`文件。假设我想`ADMIN_PREFIX_VALUE`在每种情况下都具有价值：

    ```
    from django.conf import settings # import the settings file

    def admin_media(request):
        # return the value you want as a dictionnary. you may add multiple values in there.
        return {'ADMIN_MEDIA_URL': settings.ADMIN_MEDIA_PREFIX} 
    ```

2.  将您的上下文处理器添加到您的*settings.py*文件中：

    ```
    TEMPLATES = [{
        # whatever comes before
        'OPTIONS': {
            'context_processors': [
                # whatever comes before
                "your_app.context_processors.admin_media",
            ],
        }
    }] 
    ```

3.  `RequestContext`在您的视图中使用以在模板中添加上下文处理器。[`render`快捷方式](https://docs.djangoproject.com/en/stable/topics/http/shortcuts/#render)会自动执行此操作：

    ```
    from django.shortcuts import render

    def my_view(request):
        return render(request, "index.html") 
    ```

4.  最后，在您的模板中：

    ```
    ...
    <a href="{{ ADMIN_MEDIA_URL }}">path to admin media</a>
    ... 
    ```

* * *

## 回答 #2

> 赞同：316
> 
> 时间：2011-10-10T16:58:19.407

我发现最简单的方法是单个[自定义模板标签](https://docs.djangoproject.com/en/stable/howto/custom-template-tags/)：

```
from django import template
from django.conf import settings

register = template.Library()

# settings value
@register.simple_tag
def settings_value(name):
    return getattr(settings, name, "") 
```

用法：

```
{% settings_value "LANGUAGE_CODE" %} 
```

* * *

## 回答 #3

> 赞同：197
> 
> 时间：2009-01-11T17:28:50.500

`settings.MEDIA_URL`如果您使用 django 的内置通用视图或在`render_to_response`快捷函数中传入上下文实例关键字参数， Django 提供对模板的某些常用设置常量的访问，例如和一些语言设置。以下是每种情况的示例：

```
from django.shortcuts import render_to_response
from django.template import RequestContext
from django.views.generic.simple import direct_to_template

def my_generic_view(request, template='my_template.html'):
    return direct_to_template(request, template)

def more_custom_view(request, template='my_template.html'):
    return render_to_response(template, {}, context_instance=RequestContext(request)) 
```

这些视图都将有几个常用的设置`settings.MEDIA_URL`，例如模板可用`{{ MEDIA_URL }}`等。

如果您正在寻找对设置中其他常量的访问，则只需解压缩所需的常量并将它们添加到您在视图函数中使用的上下文字典中，如下所示：

```
from django.conf import settings
from django.shortcuts import render_to_response

def my_view_function(request, template='my_template.html'):
    context = {'favorite_color': settings.FAVORITE_COLOR}
    return render_to_response(template, context) 
```

现在您可以`settings.FAVORITE_COLOR`在您的模板上以`{{ favorite_color }}`.

* * *

## 回答 #4

> 赞同：107
> 
> 时间：2014-09-15T04:54:35.297

退房[`django-settings-export`](https://github.com/jakubroztocil/django-settings-export)（免责声明：我是这个项目的作者）。

例如...

```
$ pip install django-settings-export 
```

### 设置.py

```
TEMPLATES = [
    {
        'OPTIONS': {
            'context_processors': [
                'django_settings_export.settings_export',
            ],
        },
    },
]

MY_CHEESE = 'Camembert';

SETTINGS_EXPORT = [
    'MY_CHEESE',
] 
```

### 模板.html

```
<script>var MY_CHEESE = '{{ settings.MY_CHEESE }}';</script> 
```

* * *

## 回答 #5

> 赞同：47
> 
> 时间：2011-03-08T16:53:00.217

另一种方法是创建一个自定义模板标签，它可以让您从设置中提取值。

```
@register.tag
def value_from_settings(parser, token):
    try:
        # split_contents() knows not to split quoted strings.
        tag_name, var = token.split_contents()
    except ValueError:
        raise template.TemplateSyntaxError, "%r tag requires a single argument" % token.contents.split()[0]
    return ValueFromSettings(var)

class ValueFromSettings(template.Node):
    def __init__(self, var):
        self.arg = template.Variable(var)
    def render(self, context):        
        return settings.__getattr__(str(self.arg)) 
```

然后你可以使用：

```
{% value_from_settings "FQDN" %} 
```

将其打印在任何页面上，而无需跳过上下文处理器箍。

* * *

## 回答 #6

> 赞同：32
> 
> 时间：2014-02-06T03:45:55.783

我喜欢 Berislav 的解决方案，因为在简单的网站上，它既干净又有效。我不喜欢随意公开所有设置常量。所以我最终做的是：

```
from django import template
from django.conf import settings

register = template.Library()

ALLOWABLE_VALUES = ("CONSTANT_NAME_1", "CONSTANT_NAME_2",)

# settings value
@register.simple_tag
def settings_value(name):
    if name in ALLOWABLE_VALUES:
        return getattr(settings, name, '')
    return '' 
```

用法：

```
{% settings_value "CONSTANT_NAME_1" %} 
```

这可以保护您没有在模板中使用的任何未命名的常量，如果您想要真正花哨，您可以在设置中设置一个元组，并为不同的页面、应用程序或区域创建多个模板标签，并且只需根据需要将本地元组与设置元组组合，然后执行列表推导以查看该值是否可以接受。
我同意，在一个复杂的网站上，这有点简单，但是有些值可以很好地普遍存在于模板中，这似乎很好用。感谢 Berislav 的原创想法！

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2018-04-25T09:45:52.493

*使用 Django 2.0+ 添加包含创建自定义模板标签的完整说明的答案以解决此问题*

在您的 app-folder 中，创建一个名为**templatetags**的文件夹。在其中创建**__init__.py**和**custom_tags.py**：

[![自定义标签文件夹结构](https://i.stack.imgur.com/P9AXj.png)](https://i.stack.imgur.com/P9AXj.png)

在**custom_tags.py中创建一个自定义标签函数，该函数提供对***设置*常量中任意键的访问：

```
from django import template
from django.conf import settings

register = template.Library()

@register.simple_tag
def get_setting(name):
    return getattr(settings, name, "") 
```

为了理解这段代码，我建议阅读Django 文档中[关于简单标签的部分。](https://docs.djangoproject.com/en/2.0/howto/custom-template-tags/#simple-tags)

然后，您需要通过将这个文件加载到您将使用它的任何模板中来让 Django 知道这个（以及任何附加的）自定义标签。就像您需要加载内置的静态标签一样：

```
{% load custom_tags %} 
```

加载后，它可以像任何其他标签一样使用，只需提供您需要返回的特定设置。因此，如果您的设置中有 BUILD_VERSION 变量：

```
{% get_setting "BUILD_VERSION" %} 
```

此解决方案不适用于数组，但如果您需要，您可能会在模板中添加大量逻辑。

**注意：一个更干净和故障安全的解决方案可能是制作一个自定义上下文处理器，您可以在其中将所需的设置添加到所有模板都可用的上下文中。这样，您就可以降低在模板中错误地输出敏感设置的风险。**

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2018-12-28T04:09:09.923

将此代码添加到名为的文件中`context_processors.py`：

```
from django.conf import settings as django_settings

def settings(request):
    return {
        'settings': django_settings,
    } 
```

然后，在您的设置文件`'speedy.core.base.context_processors.settings'`中，`'context_processors'`在`TEMPLATES`.

（例如，您可以看到[settings/base.py](https://github.com/speedy-net/speedy-net/blob/master/speedy/core/settings/base.py)和[context_processors.py](https://github.com/speedy-net/speedy-net/blob/master/speedy/core/base/context_processors.py)）。

然后您可以在任何模板代码中使用特定设置。例如：

```
{% if settings.SITE_ID == settings.SPEEDY_MATCH_SITE_ID %} 
```

**更新：**上面的代码向模板公开了所有设置，包括敏感信息，例如您的`SECRET_KEY`. 黑客可能会滥用此功能在模板中显示此类信息。如果您只想向模板公开特定设置，请改用以下代码：

```
def settings(request):
    settings_in_templates = {}
    for attr in ["SITE_ID", ...]: # Write here the settings you want to expose to the templates.
        if (hasattr(django_settings, attr)):
            settings_in_templates[attr] = getattr(django_settings, attr)
    return {
        'settings': settings_in_templates,
    } 
```

* * *

## 回答 #9

> 赞同：13
> 
> 时间：2011-06-14T12:16:23.747

我稍微改进了[chrisdew的答案](https://stackoverflow.com/questions/433162/can-i-access-constants-in-settings-py-from-templates-in-django/5235614#5235614)（创建自己的标签）。

首先，创建`yourapp/templatetags/value_from_settings.py`您定义自己的新标签的文件`value_from_settings`：

```
from django.template import TemplateSyntaxError, Variable, Node, Variable, Library
from yourapp import settings

register = Library()
# I found some tricks in URLNode and url from defaulttags.py:
# https://code.djangoproject.com/browser/django/trunk/django/template/defaulttags.py
@register.tag
def value_from_settings(parser, token):
  bits = token.split_contents()
  if len(bits) < 2:
    raise TemplateSyntaxError("'%s' takes at least one " \
      "argument (settings constant to retrieve)" % bits[0])
  settingsvar = bits[1]
  settingsvar = settingsvar[1:-1] if settingsvar[0] == '"' else settingsvar
  asvar = None
  bits = bits[2:]
  if len(bits) >= 2 and bits[-2] == 'as':
    asvar = bits[-1]
    bits = bits[:-2]
  if len(bits):
    raise TemplateSyntaxError("'value_from_settings' didn't recognise " \
      "the arguments '%s'" % ", ".join(bits))
  return ValueFromSettings(settingsvar, asvar)

class ValueFromSettings(Node):
  def __init__(self, settingsvar, asvar):
    self.arg = Variable(settingsvar)
    self.asvar = asvar
  def render(self, context):
    ret_val = getattr(settings,str(self.arg))
    if self.asvar:
      context[self.asvar] = ret_val
      return ''
    else:
      return ret_val 
```

您可以通过以下方式在模板中使用此标签：

```
{% load value_from_settings %}
[...]
{% value_from_settings "FQDN" %} 
```

或通过

```
{% load value_from_settings %}
[...]
{% value_from_settings "FQDN" as my_fqdn %} 
```

该`as ...`符号的优点在于，这使得`blocktrans`通过简单的`{{my_fqdn}}`.

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2013-04-28T22:38:13.487

如果使用基于类的视图：

```
#
# in settings.py
#
YOUR_CUSTOM_SETTING = 'some value'

#
# in views.py
#
from django.conf import settings #for getting settings vars

class YourView(DetailView): #assuming DetailView; whatever though

    # ...

    def get_context_data(self, **kwargs):

        context = super(YourView, self).get_context_data(**kwargs)
        context['YOUR_CUSTOM_SETTING'] = settings.YOUR_CUSTOM_SETTING

        return context

#
# in your_template.html, reference the setting like any other context variable
#
{{ YOUR_CUSTOM_SETTING }} 
```

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2011-03-28T13:45:44.497

上面来自 bchhun 的示例很好，只是您需要从 settings.py 显式构建上下文字典。下面是一个未经测试的示例，说明如何从 settings.py 的所有大写属性自动构建上下文字典（re: "^[A-Z0-9_]+$"）。

在 settings.py 的末尾：

```
_context = {} 
local_context = locals()
for (k,v) in local_context.items():
    if re.search('^[A-Z0-9_]+$',k):
        _context[k] = str(v)

def settings_context(context):
    return _context

TEMPLATE_CONTEXT_PROCESSORS = (
...
'myproject.settings.settings_context',
...
) 
```

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2018-01-17T13:56:51.330

如果有人像我一样发现这个问题，那么我将发布适用于 Django 2.0 的解决方案：

此标记将一些 settings.py 变量值分配给模板的变量：

用法：`{% get_settings_value template_var "SETTINGS_VAR" %}`

## 应用程序/模板标签/my_custom_tags.py：

```
from django import template
from django.conf import settings

register = template.Library()

class AssignNode(template.Node):
    def __init__(self, name, value):
        self.name = name
        self.value = value

    def render(self, context):
        context[self.name] = getattr(settings, self.value.resolve(context, True), "")
        return ''

@register.tag('get_settings_value')
def do_assign(parser, token):
    bits = token.split_contents()
    if len(bits) != 3:
        raise template.TemplateSyntaxError("'%s' tag takes two arguments" % bits[0])
    value = parser.compile_filter(bits[2])
    return AssignNode(bits[1], value) 
```

## 您的模板：

```
{% load my_custom_tags %}

# Set local template variable:
{% get_settings_value settings_debug "DEBUG" %}

# Output settings_debug variable:
{{ settings_debug }}

# Use variable in if statement:
{% if settings_debug %}
... do something ...
{% else %}
... do other stuff ...
{% endif %} 
```

请参阅 Django 的文档如何在此处创建自定义模板标签：[https ://docs.djangoproject.com/en/2.0/howto/custom-template-tags/](https://docs.djangoproject.com/en/2.0/howto/custom-template-tags/)

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2013-08-23T19:06:53.790

我发现这是 Django 1.3 最简单​​的方法：

1.  **视图.py**

    ```
    from local_settings import BASE_URL

    def root(request):
        return render_to_response('hero.html', {'BASE_URL': BASE_URL}) 
    ```

2.  **英雄.html**

    ```
    var BASE_URL = '{{ JS_BASE_URL }}'; 
    ```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2021-09-30T22:22:51.403

对于那些想要使用带有标签的@Berislav 方法（自定义模板标签）的人`if`：

/app/templatetags/my_settings.py：

```
from django import template
from django.conf import settings

register = template.Library()

@register.simple_tag
def settings_value(name):
    return getattr(settings, name, "") 
```

模板文件：

```
<!-- Load your tags -->
{% load my_settings %}
{% settings_value 'ENABLE_FEATURE_A' as ENABLE_FEATURE_A %}

{% if ENABLE_FEATURE_A %}
<!-- Feature A stuffs -->
{% endif %} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2011-11-23T16:20:51.717

IanSR 和 bchhun 都建议在设置中覆盖 TEMPLATE_CONTEXT_PROCESSORS。请注意，此设置有一个默认值，如果您在不重新设置默认值的情况下覆盖它，可能会导致一些麻烦的事情。在最新版本的 Django 中，默认值也发生了变化。

[https://docs.djangoproject.com/en/1.3/ref/settings/#template-context-processors](https://docs.djangoproject.com/en/1.3/ref/settings/#template-context-processors)

默认的 TEMPLATE_CONTEXT_PROCESSORS ：

```
TEMPLATE_CONTEXT_PROCESSORS = ("django.contrib.auth.context_processors.auth",
"django.core.context_processors.debug",
"django.core.context_processors.i18n",
"django.core.context_processors.media",
"django.core.context_processors.static",
"django.contrib.messages.context_processors.messages") 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2011-12-11T05:29:49.060

如果我们要比较单个变量上的上下文和模板标签，那么了解更有效的选项可能是有益的。但是，您最好只从需要该变量的模板中深入了解设置。在这种情况下，将变量传递给所有模板是没有意义的。但是，如果您将变量发送到通用模板（例如 base.html 模板）中，那么 base.html 模板会在每个请求上呈现，因此您可以使用任何一种方法。

如果您决定使用模板标签选项，请使用以下代码，因为它允许您传入**默认**值，以防有问题的变量未定义。

示例：get_from_settings my_variable as my_context_value

示例：get_from_settings my_variable my_default as my_context_value

```
class SettingsAttrNode(Node):
    def __init__(self, variable, default, as_value):
        self.variable = getattr(settings, variable, default)
        self.cxtname = as_value

    def render(self, context):
        context[self.cxtname] = self.variable
        return ''

def get_from_setting(parser, token):
    as_value = variable = default = ''
    bits = token.contents.split()
    if len(bits) == 4 and bits[2] == 'as':
        variable = bits[1]
        as_value = bits[3]
    elif len(bits) == 5 and bits[3] == 'as':
        variable     = bits[1]
        default  = bits[2]
        as_value = bits[4]
    else:
        raise TemplateSyntaxError, "usage: get_from_settings variable default as value " \
                "OR: get_from_settings variable as value"

    return SettingsAttrNode(variable=variable, default=default, as_value=as_value)

get_from_setting = register.tag(get_from_setting) 
```

# c++ - 在 VS、UNIX/Linux 中擦除 STL 迭代器后会发生什么情况？

> ID：433164
> 
> 赞同：8
> 
> 时间：2009-01-11T16:33:41.780
> 
> 标签：c++, linux, visual-studio-2005, stl, map

请考虑以下场景：

```
 map(T,S*) & GetMap(); //Forward decleration

map(T, S*) T2pS = GetMap();

for(map(T, S*)::iterator it = T2pS.begin(); it != T2pS.end(); ++it)
{
    if(it->second != NULL)
    {
        delete it->second;
        it->second = NULL;
    }
    T2pS.erase(it);
    //In VS2005, after the erase, we will crash on the ++it of the for loop.
    //In UNIX, Linux, this doesn't crash.
}//for 
```

在我看来，在 VS2005 中，在“擦除”之后，迭代器将等于 end()，因此在尝试增加它时会崩溃。编译器之间在此处呈现的行为中真的存在差异吗？如果是这样，“擦除”之后的迭代器在 UNIX/Linux 中等于什么？

谢谢...

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-11T17:00:19.497

是的，如果你删除一个迭代器，那个迭代器就会得到一个所谓的*奇异值*，这意味着它不再属于任何容器。您不能再增加、减少或读出/写入它。执行该循环的正确方法是：

```
for(map<T, S*>::iterator it = T2pS.begin(); it != T2pS.end(); T2pS.erase(it++)) {
    // wilhelmtell in the comments is right: no need to check for NULL. 
    // delete of a NULL pointer is a no-op.
    if(it->second != NULL) {
        delete it->second;
        it->second = NULL;
    }
} 
```

对于在擦除一个迭代器时可能使其他迭代器失效的容器，`erase`返回下一个有效的迭代器。然后你用

```
it = T2pS.erase(it) 
```

这就是它适用于`std::vector`and的方式`std::deque`，但不适用于`std::map`or `std::set`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-11T16:58:04.727

在你调用`erase`一个迭代器到 a`std::map`之后，它就失效了。这意味着您不能使用它。尝试使用它（例如通过增加它）是无效的，并且可能导致任何事情发生（包括崩溃）。对于 a `std::map`，调用`erase`迭代器不会使任何其他迭代器无效，因此（例如）在此调用之后（只要`it`was not `T2pS.end()`），它将是有效的：

```
T2pS.erase( it++ ); 
```

当然，如果您使用这种方法，您不会希望`it`在 for 循环中无条件地递增。

但是，对于这个例子，为什么要在 for 循环中进行擦除呢？为什么不在循环结束时调用 T2pS.clear() 。

另一方面，看起来您在地图的“右侧”有一个原始指针，但地图似乎拥有指向的对象。在这种情况下，为什么不把地图右边的东西做成某种智能指针，比如std::tr1::shared_ptr？

[顺便说一句，我没有看到任何模板参数到`map`. 您是否在本地命名空间中定义了`std::map`as的特定实例化？]`map`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-11T16:44:52.367

[看到这个](http://en.wikibooks.org/wiki/C%2B%2B_Programming/STL#Iteration_over_a_Container)：

```
for (i = v.begin(); i != v.end(); ) {
  //...
  if (erase_required) {
      i = v.erase(i);
  } else {
      ++i;
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-11T16:46:39.913

我认为，如果您修改集合，您的迭代器就会失效。正如您所发现的，您不能依赖这种行为。

# c# - 如何在 .NET 程序集中嵌入文本文件？

> ID：433171
> 
> 赞同：129
> 
> 时间：2009-01-11T16:35:41.387
> 
> 标签：c#, .net, embedded-resource

我想在程序集中嵌入一个文本文件，这样我就可以加载文本而不必从磁盘读取它，并且我需要的所有内容都包含在 exe 中。（这样它更便携）

有没有办法做到这一点？我假设资源文件有什么？

如果可以的话，你是如何做到的，以及如何以编程方式将文本加载到字符串中？

* * *

## 回答 #1

> 赞同：159
> 
> 时间：2009-01-11T16:43:52.183

右键单击项目文件，选择属性。

在打开的窗口中，转到“资源”选项卡，如果选项卡页面中间只有一个蓝色链接，请单击它以创建新资源。

![在此处输入图像描述](https://i.stack.imgur.com/atzRt.png)

然后从标签页上方的工具栏中，选择添加一个新的文本文件，给它一个名字，它将被添加到你的项目中并打开。

如果您做到了这一点，那么您可以在代码中输入 Resources.TheNameYouGaveTheTextFileHere 并访问其内容。请注意，第一次在类中使用 Resources 类时，需要添加 using 指令（在键入 Resources 后按 Ctrl+. 以获取菜单以让 VS 为您执行此操作）。

如果上面的描述有什么不清楚的地方，请发表评论，我会编辑它，直到它完成或有意义:)

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2009-01-11T16:50:29.877

在 Visual Studio 2003、Visual Studio 2005 和可能的更早版本（这在 2008 年也适用）中，您可以在项目中包含文本文件，然后在“属性”面板中，将操作设置为“嵌入式资源”。然后，您可以使用`Assembly.GetManifestResourceStream(string)`.

这里的其他答案更方便。为了完整起见，我将其包括在内。

请注意，此方法适用于嵌入其他类型的文件，例如图像、图标、声音等...

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2012-07-02T05:35:53.230

**嵌入文本文件后，在这样的代码中的任何位置使用该文件...**

```
global::packageName.Properties.Resources.ThatFileName 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-10-24T07:05:36.570

这对我有用。（我需要读取嵌入到可执行 .NET 映像文件中的文件的内容。）

在执行任何操作之前，请将您的文件包含在 Visual Studio 中的解决方案中。（在我的情况下是 VS 2017 社区。）我切换到`Solution Explorer`，然后右键单击`Properties`文件夹，选择`Add Existing Item`并选择文件。（比如说，`FileName.txt`。）然后，当仍在 中时`Solution Explorer`，右键单击包含的文件，选择`Properties`，然后选择`Build Action`as `Embedded Resource`。

然后使用此代码读取其字节：

```
string strResourceName = "FileName.txt";

Assembly asm = Assembly.GetExecutingAssembly();
using( Stream rsrcStream = asm.GetManifestResourceStream(asm.GetName().Name + ".Properties." + strResourceName))
{
    using (StreamReader sRdr = new StreamReader(rsrcStream))
    {
        //For instance, gets it as text
        string strTxt = sRdr.ReadToEnd();
    }
} 
```

请注意，在这种情况下，您**不需要像**[接受的答案](https://stackoverflow.com/a/433182/843732)中建议的那样将该文件添加为资源。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-11T16:43:28.423

是的，你是对的 - 创建一个资源文件。当您这样做时，您不需要“加载”字符串，它将被引用为 Resource.WhateverStringYouDefined。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-04-12T17:35:53.910

这是我所做的：

1.  通过右键单击项目在 Visual Studio 中添加了我的文件（资源）。
2.  右键单击您添加的每个文件并将“构建类型”更改为嵌入式资源。
3.  为了访问资源：

    一种。使用以下函数获取当前程序集：`GetExecutingAssembly()`

    湾。我添加的资源是一个文本文件，所以我使用`GetManifestResourceStream(fileName)`. 我访问文件名的方式是调用`GetManifestResourceNames()`

    C。如果这是您想要的，现在使用一个`StreamReader()`类将文件末尾读入一个变量。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-04-18T12:01:14.100

添加到 Pavan 的答案，**以获得当前的程序集**（在一般部分）：

```
Assembly _assembly; 
```

**GetManifestResourceStream(fileName)**（在代码中，需要从资源中读取）：

```
try
{
    _assembly = Assembly.GetExecutingAssembly();
    _textStreamReader = new StreamReader(_assembly.GetManifestResourceStream("*Namespace*.*FileName*.txt"));
}
catch
{
    Console.WritelLine("Error accessing resource!");
} 
```

# execution - 调用堆栈中更高的东西进行调用

> ID：433188
> 
> 赞同：1
> 
> 时间：2009-01-11T16:48:06.340
> 
> 标签：execution, callstack

当调用者在堆栈中较高时，这意味着什么？例如，假设我启动一个程序，加载一个表单（我们称之为 a），然后这个表单调用另一个表单 (b)。被调用的表单将在堆栈的顶部，所以如果这个表单调用了表单 a，这会是堆栈中更高的调用者调用下面的东西吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-11T16:53:51.460

我认为您对调用堆栈有错误的印象。call stach 只是已调用函数的“列表”。当你有一个像你描述的调用链时，a调用b调用a，你的堆栈就是：

```
a.second
b.first
a.first 
```

你不能真的把“放下”到某事上。你再进行一次调用，它会进入堆栈顶部，即使之前已经调用过，之前的调用也完全不同，新的调用会启动一个全新的“堆栈框架”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-11T16:53:31.663

您需要区分进行调用的对象（如果有）、调用的目标和被调用的方法。例如，您的调用堆栈很容易看起来像这样：

```
FormA.Method3()
FormB.Method2()
FormA.Method1() 
```

这是 FormA 的一个实例，它执行 Method1，在 FormB 的一个实例上调用 Method2。然后在 FormA 的一个实例上调用 Method3 - 与第一个 FormA 相同或不同的 FormA。这并不重要。

这并不是真正调用“下面的东西”的情况，因为堆栈帧不代表对象 - 它们代表方法（以及这些方法中的状态）。这有帮助吗，还是只是让事情更加混乱？

# emacs - 使用模板启动任何带有 .c 扩展名的 Emacs 缓冲区

> ID：433194
> 
> 赞同：15
> 
> 时间：2009-01-11T16:50:44.070
> 
> 标签：emacs, templates

我写了很多简短的一次性程序，我发现自己反复做的一件事就是输入代码，例如

```
#include <stdio.h>
#include <stdlib.h>

int main(void){

} 
```

为了节省一些肌腱命中，我想知道是否可以在创建扩展名为 .c 的缓冲区时在上面插入一个简单的模板。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-11T17:14:49.653

把这样的东西放进去`.emacs`

```
(define-skeleton c-throwaway
  "Throwaway C skeleton"
  nil
  "#include <stdio.h>\n"
  "#include <stdlib.h>\n"
  "\n"
  "int main(void){\n"
  "\n"
  "}\n") 
```

并 eval ( `C-x C-e`) 它。这将为您提供一个`c-throwaway`插入模板的函数 ( )。

要自动插入，您需要激活 `auto-insert-mode`. 一旦你这样做了，你就可以`describe-variable auto-mode-alist`阅读 emacs 如何发挥它的一些打开文件的魔力。然后定义`auto-insert-alist`在找到新文件时应用它。

也许是这样的

```
(define-auto-insert "\\.\\([Cc]\\|cc\\|cpp\\)\\'" 'c-throwaway) 
```

更多详情：

*   [自动插入模式](http://www.emacswiki.org/emacs/AutoInsertMode)

*   [复写](http://www.gnu.org/software/emacs/manual/html_node/autotype/Autoinserting.html)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-11T20:03:11.750

[我使用来自http://emacs-template.sourceforge.net/](http://emacs-template.sourceforge.net/)的 template.el

基本上，我创建了一个名为 ~/.templates/TEMPLATE.c 的文件，然后将其插入到我的 .c 文件中。如果您不只是想将文本转储到缓冲区中，您还可以使用特殊标记和任意 lisp 表达式。我使用这个特性，以便 Perl 模块在命名为 lib/Foo/Bar.pm 时以“package Foo::Bar”开头。非常便利。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-11T17:43:36.477

以下函数将询问文件名，然后插入文件并更改为 c 模式。唯一的问题是你必须调用这个函数来创建缓冲区而不是你的正常方式。

```
(defun defaultCtemplate(cfilename)
    (interactive "sFilename: ")
    (switch-to-buffer (generate-new-buffer cfilename))
    (insert-file-contents "~/Desktop/test.c")
    (c-mode)
) 
```

PS谢谢你的问题，现在我知道如何为自己做这个了:)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-11T20:48:54.040

您还可以使用 Emacs 的[YASnippet 模板系统](http://code.google.com/p/yasnippet/)，它只有一个名为`main`. 因此，在编写代码时，只需键入`main`、点击`TAB`，它就会将其扩展为您想要的形式。（而且您始终可以编写自己的代码段模板。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-11T21:15:24.833

我使用[以下代码](http://xtalk.msk.su/~ott/common/emacs/rc/emacs-rc-auto-insert.el.html)从模板创建文件。有几个模板，它们是实际文件名等的替代品

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-06T01:14:00.620

这个问题很老，但这可能会对某人有所帮助。查看[这个站点](http://www.postsubmeta.net/MyConfig/Emacs)，我将这部分复制并粘贴到我的 .emacs 文件中：

```
;; automatic insertion of templates
(require 'autoinsert)
(auto-insert-mode)  ;;; Adds hook to find-files-hook
(setq auto-insert-directory "~/Documents/Emacs/templates/") ;;; *NOTE* Trailing slash important
;;(setq auto-insert-query nil) ;;; If you don't want to be prompted before insertion
(define-auto-insert "\.tex" "my-latex-template.tex")
(define-auto-insert "\.cpp" "my-cpp-template.cpp")
(define-auto-insert "\.h" "my-cpp-template.h") 
```

更改目录和文件名后，它可以完美运行。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-11T23:04:43.287

这是我的做法（因为我不知道自动插入模式:-)

```
(require 'tempo)

(setq c-new-buffer-template 
      '(
        "#include <stdio.h>\n"
        "#include <stdlib.h>\n"
        "\n"
        "int main(void){\n"
        "\n"
        "}\n"
        ))

(defun my-c-style ()
  "My editing style for .c files."
  (c-mode)
  (if (zerop (buffer-size))
      (tempo-template-c-skeleton)))

(setq auto-mode-alist
      (cons '("\\.c\\'" . my-c-style) auto-mode-alist))

(tempo-define-template "c-skeleton" c-new-buffer-template
               nil
               "Insert a skeleton for a .c document") 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-25T04:25:10.550

我使用[Defaultcontent.el](http://pagesperso-systeme.lip6.fr/Christian.Queinnec/Miscellaneous/defaultcontent.el)和[YASnippet.el](http://code.google.com/p/yasnippet/)的组合。前者用默认内容填充全新的文件。后者是一种轻量级的代码生成宏。键入“for”并按 TAB 并插入 for 循环的骨架。等等你可以很容易地定义你自己的片段。“swi TAB”为您提供完整的 switch 语句。等等。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-07-26T04:02:36.700

[yasnippet](https://github.com/joaotavora/yasnippet)擅长在你的文件中扩展模板，并且很容易创建你的片段。自动插入擅长用模板填充新文件，但编写自己的模板很难。有一个很棒的包[yatemplate](https://github.com/mineo/yatemplate/)弥补了 YASnippet 和自动插入模式之间的差距，我可以用 YASnippet 编写自动插入规则。

# http - 我对 HTTP 缓存感到困惑

> ID：433195
> 
> 赞同：13
> 
> 时间：2009-01-11T16:51:14.383
> 
> 标签：http, rest, caching

我一直在考虑在 RESTful 环境中进行批量读取和写入，我想我已经意识到我对 HTTP 缓存有更广泛的问题。（下面我使用逗号 (",") 来分隔多个记录 ID，但该详细信息并不是讨论的特定内容。）

我从这个问题开始：

## 1\. 单`GET`品因批量更新而失效

```
GET /farms/123         # get info about Old MacDonald's Farm
PUT /farms/123,234,345 # update info on Old MacDonald's Farm and some others
GET /farms/123 
```

客户端和 Farms 服务器之间的缓存服务器如何知道`/farms/123`在看到`PUT`?

然后我意识到这也是一个问题：

## 2.`GET`单次（或批量）更新批量失效

```
GET /farms/123,234,345 # get info about a few farms
PUT /farms/123         # update Old MacDonald's Farm
GET /farms/123,234,345 
```

`GET`当缓存看到 PUT 经过时，它如何知道使多场无效？

所以我认为问题实际上只是批处理操作。然后我意识到任何关系都可能导致类似的问题。假设一个农场有零个或一个所有者，一个所有者可以拥有零个或一个农场。

## 3\. 单`GET`条因更新相关记录而失效

```
GET /farms/123   # get info about Old MacDonald's Farm
PUT /farmers/987 # Old MacDonald sells his farm and buys another one
GET /farms/123 
```

当缓存看到 PUT 经过时，它如何知道使单个 GET 无效？

即使您将模型更改为更加 RESTful，使用关系模型，您也会遇到同样的问题：

```
GET    /farms/123           # get info about Old MacDonald's Farm
DELETE /farm_ownerships/456 # Old MacDonald sells his farm...
POST   /farm_ownerships     # and buys another one
GET    /farms/123 
```

在 #3 的两个版本中，第一个 GET 应该返回类似（在 JSON 中）的内容：

```
farm: {
  id: 123,
  name: "Shady Acres",
  size: "60 acres",
  farmer_id: 987
} 
```

第二个 GET 应该返回如下内容：

```
farm: {
  id: 123,
  name: "Shady Acres",
  size: "60 acres",
  farmer_id: null
} 
```

但它不能！即使您`ETag`适当地使用 s 也不会。您不能指望缓存服务器检查`ETag`s 的内容——内容可以被加密。而且你不能指望服务器通知缓存记录应该失效——缓存不会向服务器注册自己。

那么我缺少标题吗？表明缓存的事情应该在某些资源的`HEAD`任何 s 之前执行？`GET`如果我可以告诉缓存哪些资源可能会频繁更新，我想我可以忍受对每个资源的双重请求。

那么一个缓存接收到`PUT`并知道使其缓存无效而另一个没有看到它的问题呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-11T17:04:45.463

缓存服务器应该在收到 PUT 时使 URI 引用的实体无效（但正如您所注意到的，这并不涵盖所有情况）。

除此之外，您可以在响应中使用缓存控制标头来限制或阻止缓存，并尝试处理询问自上次获取以来 URI 是否已被修改的请求标头。

这仍然是一个非常复杂的问题，实际上仍在研究中（例如，参见[http://www.ietf.org/internet-drafts/draft-ietf-httpbis-p6-cache-05.txt](http://www.ietf.org/internet-drafts/draft-ietf-httpbis-p6-cache-05.txt)）

如果内容是加密的（至少使用 SSL），代理中的缓存实际上并不适用，所以这不应该是一个问题（尽管仍然可能是客户端的问题）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-11T17:00:07.610

HTTP 协议支持一种称为“If-Modified-Since”的请求类型，它基本上允许缓存服务器询问 Web 服务器项目是否已更改。HTTP 协议还支持 HTTP 服务器响应中的“Cache-Control”标头，它告诉缓存服务器如何处理内容（例如从不缓存此内容，或假设它在 1 天后过期等）。

您还提到了加密响应。HTTP 缓存服务器无法缓存 SSL，因为这样做需要它们将页面解密为“中间人”。这样做在技术上具有挑战性（解密页面、存储页面并为客户端重新加密），并且还会违反页面安全性，导致客户端出现“无效证书”警告。从技术上讲，让缓存服务器来做这件事是可行的，但它导致的问题多于它解决的问题，而且是个坏主意。我怀疑任何缓存服务器实际上都会做这种事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-11T17:14:06.020

不幸的是，HTTP 缓存基于精确的 URI，如果不强制客户端进行缓存重新验证，您将无法在您的情况下实现合理的行为。

如果您有过：

```
GET /farm/123
POST /farm_update/123 
```

您可以使用`Content-Location`标头来指定第二个请求修改了第一个请求。AFAIK 你不能用多个 URI 来做到这一点，而且我还没有检查这是否适用于流行的客户端。

解决方法是让页面快速过期并处理`If-Modified-Since`或`E-Tag`带`304 Not Modified`状态。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-11T17:38:50.760

您不能缓存动态内容（没有缺点），因为...它是动态的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-11T17:17:09.433

回复：[SoapBox](https://stackoverflow.com/questions/433195/im-confused-about-http-caching#433206)的回答：

1.  我认为这是我在问题结束时建议`If-Modified-Since`的两个阶段。`GET`在内容很大的情况下，这似乎是一个不错的解决方案（即，请求数量翻倍的成本，因此开销被不重新发送内容的收益所克服。在我的农场示例中，情况并非如此，因为每个农场的信息都很短。）

2.  构建一个通过未加密 (HTTP) 通道发送加密内容的系统是完全合理的。想象一下面向服务架构的场景，其中更新不频繁，`GET`并且 (a) 频繁，(b) 需要*非常*快，并且 (c) 必须加密。您将构建一个需要`FROM`标头（或等效地，请求参数中的 API 密钥）的服务器，并为请求者发回内容的非对称加密版本。非对称加密速度很慢，但如果缓存得当，它会胜过 SSL 握手（非对称加密）和对称内容加密的组合。在此服务器前添加缓存将大大加快`GET`s.

3.  缓存服务器可以在短时间内合理地缓存 HTTPS GET。我的银行可能会在我的帐户主页和最近的交易中设置大约 5 分钟的缓存控制。我不太可能在网站上花费很长时间，因此会话不会很长，而且我可能会在寻找我最近发送的支票时多次访问我的帐户主页到[SnorgTees](http://www.snorgtees.com/)。

# ruby-on-rails - Ruby：时间值的数学函数

> ID：433203
> 
> 赞同：3
> 
> 时间：2009-01-11T16:58:28.893
> 
> 标签：ruby-on-rails, ruby, math, time

我如何添加/减去/等。Ruby 中的时间值？例如，我将如何添加以下时间？

00:00:59 + 00:01:43 + 00:20:15 = ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T00:07:45.160

使用 ActiveSupport，它有大量的内置日期扩展。

```
require 'active_support/core_ext'
t1 = "#{Date.today} 00:00:59".to_time
t2 = "#{Date.today} 00:01:43".to_time
t3 = "#{Date.today} 00:20:15".to_time
t1.since(t2.seconds_since_midnight+t3.seconds_since_midnight) 
```

或者，如果您不关心日期，只关心时间：

```
t1.since(t2.seconds_since_midnight+t3.seconds_since_midnight).strftime("%H:%M:%S") 
```

如需完整列表，请查看[http://guides.rubyonrails.org/active_support_core_extensions.html#extensions-to-date](http://guides.rubyonrails.org/active_support_core_extensions.html#extensions-to-date)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T16:47:56.403

有点难看，但是您可以使用 DateTime.parse(each_interval) 并计算每个秒数。像这样：

```
require 'date'

def calc_seconds(time_string)
  date_time = DateTime.parse(time_string)
  hour_part = date_time.hour * 60 * 60
  minute_part = date_time.minute * 60
  second_part = date_time.second
  hour_part + minute_part + second_part
end 
```

...假设输入有效，它会在几秒钟内为您提供结果。此时您可以将它们添加在一起。

您可以反转该过程以获取原始符号中的间隔。

我真的认为应该有一种更简单的方法，但我不知道有哪一种。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T13:10:46.627

一种方法是将所有内容转换为秒，然后执行操作......然后您需要再次将其转换为时间对象

```
Time.at(seconds_result).strftime('%H:%M:%S') 
```

你会得到很好的格式化时间（作为一个字符串）。

我正在尝试找到可以执行此操作和其他操作的 gem。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-02T23:09:38.753

您可能想要使用与实际日期无关的 gem。您可以使用 DateTime 和/或 Time 来表演杂技，但您会一直在为如何处理日子而苦苦挣扎。

一种可能有用的宝石是 tod (TimeOfDay)，[https://github.com/JackC/tod](https://github.com/JackC/tod)

有了它，您可以直接执行 TimeOfDay.parse "00:01:43"，添加值，然后使用 strftime("%H:%M:%S") 打印结果。

# c# - 在 C#.net 中反转字符串的最快方法

> ID：433211
> 
> 赞同：12
> 
> 时间：2009-01-11T17:02:11.693
> 
> 标签：c#

我目前正在为 Euler Problem #4 编写一个快速解决方案，其中必须从两个 3 位数字的乘积中找到最大的回文数。

要确定一个数字是否是回文，您显然会将数字的反转与原始数字进行比较。

**由于 C# 没有内置的 String.Reverse() 方法，反转字符串的最快方法是什么？**

*我将使用 100,000,000 次迭代循环测试所有建议的解决方案。正确答案将给予提交最快解决方案的人。*

*我将在 C#.Net 3.5 控制台应用程序中测试解决方案*

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-11T17:29:50.390

反转数字不是更快吗？

```
// unchecked code, don't kill me if it doesn't even compile.
ulong Reverse(ulong number) {
    ulong result = 0;

    while (number > 0) {
        ulong digit = number % 10;
        result = result * 10 + digit;
        number /= 10;
    }

    return result;
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-11T17:29:08.190

如果您想将一个数字与其反向进行比较，使用除法而不是将其转换为字符串可能会更快。我仍然需要测试它的速度。

```
 private static int Reverse(int num) {
     int res = 0;
     while (num > 0) {
        int rm ;
        num = Math.DivRem(num, 10, out rm);
        res = res * 10 + rm;
     }
     return res;
  } 
```

编辑： DivRem 比我计算机中的除法和模块快约 1%。如果最后一位为 0，则退出速度优化：

```
 private static int Reverse(int num) {
     int res = 0;
     int rm;
     num = Math.DivRem(num, 10, out rm);
     //Some magic value or return false, see below.
     if (rm == 0) return -1 ; 
     res = res * 10 + rm;
     while (num > 0) {
        num = Math.DivRem(num, 10, out rm);
        res = res * 10 + rm;
     }
     return res ;
  } 
```

使该方法返回一个布尔值比与我计算机中的循环中的布尔值相比要慢一些，但我不明白为什么。请在您的计算机上测试。

乘法和位移应该比除法更快，但可能不够精确。编辑：使用 long 似乎足够精确。

```
 private static int FastReverse(int num) {
     int res = 0;
     int q = (int)((214748365L * num) >> 31);
     int rm = num - 10 * q;
     num = q;
     if (rm == 0) return -1;
     res = res * 10 + rm;
     while (num > 0) {
        q = (int)((214748365L * num) >> 31);
        rm = num - 10 * q;
        num = q;
        res = res * 10 + rm;
     }
     return res;
  } 
```

(214748365L * num) >> 31 等于 i / 10 直到 1,073,741,829，其中 1 / 10 得到 107374182，乘法 + 二进制移位得到 107374183。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-01-11T17:20:29.177

我认为就地进行比较可能会更快。如果你反转字符串，你必须：

1.  实例化一个新的字符串对象（或 StringBuffer 对象）
2.  将数据（反向）从第一个字符串复制到新字符串
3.  做你的比较。

如果您在原地执行比较，则只执行最后一步。即便如此，您的比较只是字符串的一半（或一半 - 0.5，如果字符数为奇数）。像下面这样的东西应该可以工作：

```
static bool IsPalindromic(string s){
    int len = s.Length;
    int half = len-- >> 1;
    for(int i = 0; i < half; i++)
        if(s[i] != s[len - i])
            return false;
    return true;
} 
```

**编辑：**

虽然这回答了 OP 的问题，但通过我的测试， [ggf31416](https://stackoverflow.com/questions/433211/quickest-method-to-reverse-in-string-in-c-net#433257)和[配置](https://stackoverflow.com/questions/433211/quickest-method-to-reverse-in-string-in-c-net#433260)器提供的解决方案解决了 OP 的实际需求大约快了 30%。配置器的解决方案比 ggf31416 的解决方案快一点，如果您将其转换为静态方法并使用`int`s 而不是`ulong`s （但要慢得多，否则）。

* * *

顺便说一句，运行这些示例来解决 OP 提到的问题（找到任何两个三位数的最大回文乘积），使用下面的简单（可能是幼稚的）循环：

```
for(int i = 100; i < 1000; i++)
    for(int j = i; j < 1000; j++) // calculations where j < i would be redundant
        ... 
```

在我的机器上产生以下结果：

```
IsPalindromic(product.ToString()) 耗时 0.3064174 秒。
ggf31416Reverse(product) == product 耗时 0.1933994 秒。
configuratorReverse(product) == product 耗时 0.1872061 秒。

```

每个都产生正确的结果`913 * 993 = 906609`。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-11T17:10:31.350

[性能：最快的字符串反转算法...（最终结果）](http://weblogs.asp.net/justin_rogers/archive/2004/06/10/153175.aspx)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-11T17:17:25.530

```
string test = "ABC";
string reversed = new String(test.ToCharArray().Reverse().ToArray()); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-11T17:09:39.557

```
public static String Reverse(string input) {
  var length = input.Length;
  var buffer = new char[length];
  for ( var i= 0; i < input.Length; i++ ) {
    buffer[i] = input[(length-i)-1];
  }
  return new String(buffer);
} 
```

编辑：哇！忘记将 perf 的长度减半 :)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-10-25T18:01:48.190

我发现在 C# 中反转字符串的最快方法是使用以下代码。一次读取 32 位而不是 16 位字符的长度更快。在调试模式下，它会更快，直到您达到大约 93 个字符。比 Array.Reverse() 更长的任何东西都更快。使用发布版本并在 IDE 之外运行，此方法将以任何字符串长度将 Array.Reverse() 从水中吹出。

```
char[] MyCharArray = MyString.ToCharArray();
UIntStringReverse(ref MyCharArray);     //Code to reverse is below.
string ReversedString = new string(MyCharArray);

private static unsafe void UIntStringReverse(ref char[] arr)
{
    uint Temp;
    uint Temp2;

    fixed (char* arrPtr = &arr[0])
    {
        uint* p, q;
        p = (uint*)(arrPtr);
        q = (uint*)(arrPtr + arr.LongLength - 2);

        if (arr.LongLength == 2)
        {
            Temp = *p;
            *p = ((Temp & 0xFFFF0000) >> 16) | ((Temp & 0x0000FFFF) << 16); 
            return;
        }

        while (p < q)
        {
            Temp = *p;
            Temp2 = *q;

            *p = ((Temp2 & 0xFFFF0000) >> 16) | ((Temp2 & 0x0000FFFF) << 16); 
            *q = ((Temp & 0xFFFF0000) >> 16) | ((Temp & 0x0000FFFF) << 16);

            p++;
            q--;
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-11T17:15:49.933

也试试这个： [http ://weblogs.sqlteam.com/mladenp/archive/2006/03/19/9350.aspx](http://weblogs.sqlteam.com/mladenp/archive/2006/03/19/9350.aspx)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-11T17:18:01.817

```
string Reverse(string s)
{
  return new string(s.ToCharArray().Reverse().ToArray());
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-11T19:37:52.550

使用 ggf31416 的 FastReverse 函数，这里是 Project Euler 的问题 #4 的解决方案，它在我的计算机上在 47 毫秒内完成。

```
using System;
using System.Diagnostics;

namespace Euler_Problem_4
{
    class Program
    {
        static void Main(string[] args)
        {
            Stopwatch s = new Stopwatch();
            s.Start();

            int t = 0;

            for (int i = 999; i > 99; i--)
            {
                for (int j = i; j > 99; j--)
                {
                    if (i*j == FastReverse(i*j))
                    {
                        if (i * j > t)
                        {
                            t = i * j;
                        }
                    }
                }
            }

            Console.WriteLine(t);

            s.Stop();
            Console.WriteLine("{0}mins {1}secs {2}ms", s.Elapsed.Minutes, s.Elapsed.Seconds, s.Elapsed.Milliseconds);
            Console.ReadKey(true);

        }

        private static int FastReverse(int num)
        {
            int res = 0;
            int q = (int)((214748365L * num) >> 31);
            int rm = num - 10 * q;
            num = q;
            if (rm == 0) return -1;
            res = res * 10 + rm;
            while (num > 0)
            {
                q = (int)((214748365L * num) >> 31);
                rm = num - 10 * q;
                num = q;
                res = res * 10 + rm;
            }
            return res;
        }
    }
} 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-06-11T04:11:16.377

秒表类需要在每次运行后重置。下面的代码已更正

```
var d = s.ToCharArray();
Array.Reverse(d);
return s == new string(d); 
```

* * *

```
using System;
using System.Diagnostics;

namespace longeststring_codegolf
{
    class Program
    {
        static void Main(string[] args)
        {
            int t = 0, v = 0;
            var sw = new Stopwatch();

            sw.Start();
            for (int i = 999; i > 99; i--)
                for (int j = 999; j > 99; j--)
                    if ((v = i * j) > t && IsPalindromicMine(v.ToString()))
                        t = v;
            sw.Stop();

            var elapsed = sw.Elapsed;
            var elapsedMilliseconds = sw.ElapsedMilliseconds;
            var elapsedTicks = sw.ElapsedTicks; 
            Console.WriteLine("Ticks: " + elapsedTicks.ToString());//~189000
            Console.WriteLine("Milliseconds: " + elapsedMilliseconds.ToString()); //~9

            sw = Stopwatch.StartNew();
            for (int i = 999; i > 99; i--)
                for (int j = 999; j > 99; j--)
                    if ((v = i * j) > t && IsPalindromic(v.ToString()))
                        t = v;
            sw.Stop();
            var elapsed2 = sw.Elapsed;
            var elapsedMilliseconds2 = sw.ElapsedMilliseconds;
            var elapsedTicks2 = sw.ElapsedTicks; 
            Console.WriteLine("Ticks: " + elapsedTicks2.ToString());//~388000
            Console.WriteLine("Milliseconds: " + elapsedMilliseconds2.ToString());//~20

        }

        static bool IsPalindromicMine(string s)
        {
            var d = s.ToCharArray();
            Array.Reverse(d);
            return s == new string(d);
        }

        static bool IsPalindromic(string s)
        {
            int len = s.Length;
            int half = len-- >> 1;
            for (int i = 0; i < half; i++)
                if (s[i] != s[len - i])
                    return false;
            return true;
        }

    }
} 
```

# asp.net - 离婚 ASP.NET & SQL SERVER 你建议什么替代方案？

> ID：433217
> 
> 赞同：4
> 
> 时间：2009-01-11T17:05:00.563
> 
> 标签：asp.net, vb.net

我一直在 asp.net 中进行开发（之前也是经典的 asp），并且我一直使用 SQL Server 作为我的后端数据库。

经过认真考虑，我现在想更改我使用的语言。考虑到 .NET 平台的 OOP 功能，您建议我开始学习哪些其他语言而不是 ASP.NET，为什么？

另外我应该使用什么作为数据库？我在 SQL Server 以外的数据库方面没有经验。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-11T17:19:51.313

Django 会得到我的投票。

和你一样，我从创建 ASPNET 开始就一直在使用它，然后一份工作迫使我使用 PHP。然后另一个。还有一个。我已经到了 90% 的时间都花在 PHP 上的地步，我不想在两个完全不同的工作流程之间分配我的时间，所以我就顺其自然了。

与 C# 甚至 VB.NET 等语言的相对美相比，PHP，您可能知道也可能不知道，是一种语言的完整阴囊。而且它不会很快好转。开发框架意味着您必须为每个项目上传 50 万个文件，而这一切都是不必要的。

所以大约两个月前，我开始寻找替代方案。我现在使用 Linux，所以我经常接触 Python。它看起来足够漂亮。它的格式总是很好（按设计），并且具有相当出色的 OOP 技术和机会。

然后我了解了 Django ORM，所以我想我会创建一个具有一些基本交互功能的快速站点。我为我女朋友的家人做了一个秘密的圣诞老人网站。多种表单、身份验证、列表和详细信息页面以及 AJAX 飞溅。我（一个完全的超级新手）花了两天时间来获得功能，然后用一周的剩余时间来美化（我是一个缓慢的设计师）。

其他好处包括其出色的内置缓存、真正知道如何编程的社区、预制的、可重用的应用程序，您只需将其插入您的站点即可使用，以及 python 的 easy_install 和 pip 使获取模块变得如此简单。哦，与 ASPNET 不同，它可以在任何操作系统上运行，这可以为个人项目节省大量资金。

从那以后，我将其余的 PHP 站点（以及我必须维护的站点）移植到它，并且我即将开始移植我的 ASPNET 项目。我很高兴。

* * *

数据库在 Django 中几乎不是问题。你选择一个适合你项目大小的，插入它，然后 ORM 处理所有的 DBIO。

我将 SQLite 用于中小型项目，将 MySQL 集群用于大型项目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-11T17:16:28.560

我会为您的数据库使用 PostgresSQL。它是迄今为止功能最完整的开源数据库。虽然 MySQL 似乎被认为是速度上最好的。如果成本不是问题，那么甲骨文显然是一个大玩家。

就语言而言，Java 将是与 .Net 语言相似的最佳选择。它是严格类型的，并且像 C# 一样面向对象。并且广泛用于大型企业，很像.NET。

当然，如果您只是为了改变而改变，那么切换到更不同的东西可能会更好。Ruby 和 Python 是当今的大型动态语言，它们将提供不同的视角。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-11T17:39:38.717

Ruby on Rails 似乎是非常不错的选择。只是它有点太不同了，有点太奇怪了。但似乎也是最有效的。RoR 与数据库无关，因此数据库的选择与语法无关。编写应用程序时无需考虑使用哪个数据库。您只需使用 RoRs 方法访问数据库，它就会自动将其连接到数据库引擎。

或者使用 PHP 和 MySQL，它已被证明并广泛传播。我自己首先使用 MS SQL Server，然后毫无问题地切换到 MySQL。PHP 是一种有点脏的语言，但它使用起来很舒服，并且得到了很好的支持和文档记录。如果您决定采用这种方式，请尝试 ZEND 框架，它可以解决很多问题并使编写 Web 应用程序变得更加容易。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-11T18:34:54.830

使用 Mono，它可以在 Linux、Mac 和 Windows 上运行。它在 Ubuntu 中运行我的 ASP.NET 程序比在我的开发机器上运行时更快（Windows XP 的 IIS，虽然我还没有比较在 Windows 服务器上运行时的速度）

Mono 支持的语言：C#、Java、Boo、Nemerle、VB.NET、PythonNet、IronPython、Oberon、PHP、Object Pascal、Cobra、Component Pascal、Delta Forth、DotLisp、#Smalltalk

对于数据库，使用PostgreSQL，它被称为开源数据库的Oracle。它有许多适合企业型系统的特性。

[http://www.mono-project.com/Main_Page](http://www.mono-project.com/Main_Page)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-11T19:38:57.040

为什么不看看[ASP.Net MVC](http://www.asp.net/mvc/)，您将利用您已经知道的大部分知识，并且在其处理网站的方法方面有很大不同。只是在没有令人信服的理由或目标的情况下切换可能没有那么有用，但是学习另一种语言并没有什么坏处。

该站点基于 ASP.Net MVC 和[Linq to SQL](http://msdn.microsoft.com/en-us/library/bb425822.aspx)构建。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-11T17:39:54.300

你离开 .net 的原因是什么？

改变语言可能无法解决根本原因。

由于我的工作，我自己从 LAMP 切换到 .net，然后逐渐在我的爱好时间让我可以 100% 专注于一种语言。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-11T17:50:35.230

> 由于我的工作，我自己从 LAMP 切换到 .net，然后逐渐在我的爱好时间让我可以 100% 专注于一种语言。

您可能从 LAMP 中学到了一些可以应用于 .NET 的东西。这是探索其他语言和框架的最佳理由。

动态脚本语言可以节省大量开发时间：无需编译、弱类型化和灵活性。

就个人而言，我喜欢 php 的灵活性。没有抽象的、不灵活的、复杂的 Web 控件需要学习。我可以完全控制我的小部件，因为我可以更改底层代码。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-11T18:00:37.707

不知道php还是一门乱七八糟的脚本语言……我不想回到从前……

不，我需要尽可能顺利地进行转换。从我读到的，似乎 ruby​​ 将成为选择......虽然 Django 看起来很有趣。

老实说，我在 JavaScript / jQuery 和 DOM 中发现和体验的越多，我在页面上使用 asp.net 控件和相关垃圾的次数就越少。我已经达到了我知道将 ASP.NET 用于我的项目后端（发送和检索数据的对象和数据类）和前端的标准 HTML 表单和控件，使用 jQuery 进行 DOM 操作和通信的地步（通过ajax) 与服务器。

在我的开发生涯中走到了这一步，我认为学习一门比 asp.net 更快、不依赖于 Windows 并且更容易学习的新语言是一个好主意。

然后我可以买一个macbook放松一下:)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-11T20:36:26.237

SQL Server Express 对我来说工作得很好。我在 c# 中使用了很多不同的数据库，但在生产中只使用了 mysql 和二进制文件。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-11T22:58:51.193

ASP.NET 不是一种语言。它是一个框架，您可以在其上构建网站和 Web 应用程序。

> 原因不是以工作为中心。最近我意识到我有足够的零碎东西让我坚持使用微软。例如，我想买一台 MacBook，但我不能，因为我需要 IIS 和 VS 等。（我知道我可以在 mac 上使用 windows，但有什么意义）

您是否厌倦了一般的 Microsoft 或 ASP.NET？或者你想加入一个需要拥有 MacBook 的邪教组织？或者您对 LAMP 或 Java 开发感兴趣？您仍然想做网络应用程序还是对桌面或移动应用程序更感兴趣？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-11T17:07:10.933

就数据库而言，最明显的替代方案是 MySQL。其他选项是 PostgreSQL 或 SQL Lite

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-03-04T18:38:05.417

我正在创建一个名为 MPDA 的项目。它是一个简单的 Dll 和应用程序，可创建充当数据库的文件。它面向希望使用不会影响其托管系统上的系统性能的数据库的 .NET 开发人员。没有网页依赖。如果您有 FTP 访问权限，则可以托管它。无需安装客户端或网页端。适用于任何具有文件托管能力的平台。缺点是它只能从 .NET 访问。

# linux - linux/x 窗口是否有任何 Spy++ 等价物？

> ID：433218
> 
> 赞同：13
> 
> 时间：2009-01-11T17:05:03.263
> 
> 标签：linux, x11

Spy++ 是一个用于 Windows 的工具，它允许用户监视 Windows 属性、子窗口和它将处理的消息。它是调试 UI 相关代码的便捷实用程序。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-11T20:29:34.537

那时，我使用一个名为`xev`. 它创建一个新窗口，您可以发送事件（通过单击它或按下按钮），这些事件被捕获并打印在标准输出上。根据 jpalecek 的评论，它还可以用于观看其他窗口，而不是新窗口。以下将从您通过单击选择的窗口中观看事件：

```
xev -id $(xwininfo | awk '/Window id/ { print $4 }') 
```

对于收集一般信息，可以使用 xwininfo，它可以显示子项、属性等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-11T18:34:48.073

我看到了[Squish](http://www.froglogic.com/pg?id=Products&category=squish&sub=overview&subsub=overview)的“间谍”功能。这是一个 GUI 测试工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-08T16:31:16.870

[WinFormSpy](https://bitbucket.org/hindlemail/winformsspy/wiki/Home)为使用 mono 运行的 winform 应用程序提供了 Spy++ 提供的一些基本功能。

它允许查看某些窗口属性并将窗口结构显示为树。

# c++ - QNX c++线程问题

> ID：433220
> 
> 赞同：3
> 
> 时间：2009-01-11T17:05:13.653
> 
> 标签：c++, multithreading, qnx

我有一个关于我想在 QNX 上运行的代码的问题：

```
class ConcreteThread : public Thread
{
public:
    ConcreteThread(int test)
    {
        testNumber = test;
    }

    void *start_routine() 
    { 
        for(int i = 0; i < 10; i++)
        {
            sleep(1);
            cout << testNumber << endl;
        }   
    }

private:
    int testNumber;
};

class Thread 
{
public:
    Thread(){};

    int Create()
    {
        pthread_t m_id;
        return pthread_create(&m_id, NULL, &(this->start_routine_trampoline), this);
    }

protected:
    virtual void *start_routine() = 0;

private:

    static void *start_routine_trampoline(void *p)
    {
        Thread *pThis = (Thread *)p;
        return pThis->start_routine();
    }
}; 
```

现在，当我在 *start_routine 中没有休眠的情况下运行此代码时，它会简单地打印数字 10 次，然后继续执行下一行代码（顺序而不是并行）。但是，当我在代码中使用 sleep 时，它根本不会打印任何数字，而是继续执行下一行代码。为什么睡眠不起作用，我怎样才能使这样的线程工作，而不是按顺序运行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-11T17:35:08.117

注意 1：如果您只有 1 个处理器，则无论您创建多少线程，代码都只能按顺序完成。在为下一个线程换出之前，每个线程都会被分配一段处理器时间。

注意 2：如果主线程退出，pthreads 将在所有子线程有机会执行之前将其杀死。

现在来回答你的问题：

没有睡眠。线程一旦启动，在单个切片中就有足够的时间完全执行循环 10 次。

随着睡眠：您的工作线程将睡眠整整一秒钟。所以你的主线程有时间做很多工作。如果此时主线程退出，worker 将被杀死。

我将进行以下更改：

```
//  Remove the Create() method
//  Put thread creation in the constructor.
//  Make the thread variable part of the object

pthread_t m_id;

Thread()
{
    if (pthread_create(&m_id, NULL, &(this->start_routine_trampoline), this) != 0)
    {
        throw std::runtime_error("Thread was not created");
    }
}

// Make sure the destructor waits for the thread to exit.
~Thread()
{
    pthread_join(m_id);
} 
```

如果你去看看**boost 线程**库。你会发现像这样的小错误都已经被处理好了；从而使线程更易于使用。

还要注意。使用静态可能有效，但它是不可移植的。这是因为 pthread 是一个 C 库，因此需要一个带有 C ABI 的函数指针。您在这里为您的平台感到幸运。您需要将其定义为函数并使用 extern "C" 声明 ABI

```
// This needs to be a standard function with C Interface.
extern "C" void *start_routine_trampoline(void *p)
{
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-11T17:44:37.473

尝试使 pthread_t id 成为类成员而不是函数局部变量。这样调用者可以 pthread_join 它。

不这样做在技术上是资源泄漏（除非线程特别不可连接）。加入将避免[Martin York](https://stackoverflow.com/questions/433220/qnx-c-thread-question#433269)所描述的问题。

来自 man pthread_join：

> 加入的线程必须处于可加入状态：它不能使用 pthread_detach(3) 或 pthread_create(3) 的 PTHREAD_CREATE_DETACHED 属性分离。
> 
> 当一个可连接线程终止时，它的内存资源（线程描述符和堆栈）不会被释放，直到另一个线程对其执行 pthread_join。因此，必须为每个创建的可连接线程调用一次 pthread_join 以避免内存泄漏。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-11T20:23:44.687

在这里切线......关于[马丁约克的帖子：](https://stackoverflow.com/questions/433220/qnx-c-thread-question#433269)

> ***还要注意。使用静态可能有效，但它是不可移植的。这是因为 pthread 是一个 C 库，因此需要一个带有 C ABI 的函数指针。您在这里为您的平台感到幸运。您需要将其定义为函数并使用 extern "C" 声明 ABI***
> 
> ***// 这需要是具有 C 接口的标准函数。
> extern "C" void * start_routine_trampoline(void * p) {...}***

我不太确定...

(1) C++ 被设计为尽可能与 C 兼容。 [有一些区别......](http://www.research.att.com/~bs/3rd_compat.pdf) 但我的印象是*extern "C"*  主要用于规避实现 C++ 函数重载所需的名称修改。

(2) 看起来，一旦你有了函数指针，调用约定（什么被压入堆栈以进行函数调用）在 C 和 C++ 之间必须相同。否则，函数指针将如何工作？

例如：

**C代码：**

```
void bar( int i ) { printf( "bar %d\n", i ); } 
```

**C++ 代码：**

```
class Foo
{
public:
  static void foo( int i ) { cout << "foo " << i << endl; }
};

extern "C" { void bar(int); }

int main()
{
  void (*p)(int);

  p = & Foo::foo;
  (*p)(1);

  p = & bar;
  (*p)(2);
} 
```

# delphi - 当我直到运行时才知道长度时如何声明数组？

> ID：433221
> 
> 赞同：34
> 
> 时间：2009-01-11T17:05:50.547
> 
> 标签：delphi, arrays, global-variables, dynamic-arrays, redefine

我最初有一个被定义为全局变量的数组[1..1000]。但是现在我需要将其设为 n，而不是 1000，并且直到稍后我才知道 n。在填充数组之前我知道 n 是什么，但我需要它是全局的，因此需要一种在运行时定义全局数组大小的方法。

上下文正在用文件中字节的线性变换填充数组。我不知道文件有多大，直到有人想要打开它并且文件可以是任意大小。

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2009-01-11T17:55:42.443

从 Delphi 4 开始，Delphi 支持**动态数组**。您可以在运行时修改它们的大小，它们将以旧大小保留您存储在其他元素中的数据。它们可以保存任何同类类型的元素，包括记录和其他数组。您可以像声明普通的“静态”数组一样声明动态数组，但只需省略数组边界：

```
var
  ArthurArray: array of TForm; 
```

尽管静态数组允许您指定下限和上限，但动态数组的下标始终为零。高索引由`High`函数给出，它总是返回比数组长度小一的值。对于任何动态数组`x`，`High(x) = Length(x)-1`.

任何代码都可以访问全局变量，包括本地过程。

动态数组类型的全局变量将被初始化为*空*数组。它的长度为零，`High`在该数组上调用的将为-1。`Low`在该数组上仍将返回零。

您可以随时调整动态数组的大小。使用该`SetLength`函数，就像使用字符串一样：

```
var
  NumElements: Integer;
begin
  NumElements := GetNumberOfArthurForms();
  SetLength(ArthurArray, NumElements);
end; 
```

如果你有一个多维数组，你可以在循环中设置它们的长度：

```
var
  matrix: array of array of Double;
  i: Integer;
begin
  SetLength(matrix, height);
  for i := 0 to height - 1 do
    SetLength(matrix[i], width);
end; 
```

有一个快捷方式可以一次设置所有内部数组的长度：

```
begin
  SetLength(matrix, height, width);
end; 
```

就像我提到的，当你调整动态数组的大小时，它们会保留它们的旧值：

```
var
  data: array of string;
begin
  SetLength(data, 2);
  data[1] := 'foo';
  SetLength(data, 20);
  Assert(data[1] = 'foo');
end; 
```

但是如果你*缩短*数组，任何位于新最后一个元素之外的元素都将永远消失：

```
begin
  SetLength(data, 20);
  data[15] := 'foo';
  SetLength(data, 2);
  // data[15] does not exist anymore.
  SetLength(data, 16);
  writeln(data[15); // Should print an *empty* line.
end; 
```

我上面的演示使用了字符串。字符串在 Delphi 中是特殊的；它们由编译器通过引用计数进行管理。因此，字符串类型的新动态数组元素被初始化为空。但如果我改用整数，则无法保证新元素的值。它们可能为零，但也可能是其他任何值，就像独立局部变量的初始值一样。

有人告诉我，Delphi 7 帮助文件非常好。请在此处阅读有关动态数组的更多信息。您可以在 Delphi 安装中提供的 VCL 和 RTL 源代码以及过去 10 年产生的几乎所有 Delphi 代码示例中找到它们使用的演示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-11T20:19:11.780

首先，这是您问题第一部分的一般答案：

如果您的数组不再是静态的，您可能需要考虑使用 TList、TStringList 或 Contnrs 单元中的许多容器类之一。

它们可能更好地代表您正在做的事情，提供您可能需要的其他功能，例如排序或名称/值对，它们会根据您的需要动态增长，并且已经过很好的优化。

* * *

然后你说：

> “上下文正在用文件中字节的线性变换填充数组。我不知道文件有多大，直到有人想要打开它并且文件可以是任意大小。”

对于您的具体问题，我将使用以下方法加载文件中的字节：

> ```
>  MyFileStream := TFileStream.Create(Filename, fmOpenRead or fmShareDenyWrite);
>   Size := MyFileStream.Size - MyFileStream.Position;
>   SetLength(Buffer, Size);
>   MyFileStream.Read(Buffer[0], Size); 
> ```

然后，您可以轻松地使用 PChar 指针逐个遍历缓冲区中的每个字符甚至每个字节，并按照您需要的方式对其进行转换。

# django - 从 VCS 更新实时服务器

> ID：433222
> 
> 赞同：0
> 
> 时间：2009-01-11T17:06:22.667
> 
> 标签：django, bash

我将所有 Django 站点作为 SCGI 守护进程运行。我不会深入了解我为什么这样做的基础知识，但这意味着当一个站点运行时，有一组进程从以下命令运行：

```
/websites/website-name/manage.py runfcgi method=threaded host=127.0.0.1 port=3036 protocol=scgi 
```

一切都很好，直到我想从 VCS（在我的情况下为 Bazaar）推出一个新版本。我制作了一个别名脚本，它执行以下操作：

```
alias up='bzr up; killall manage.py' 
```

这是通用的，*原因*很简单：我很懒。我想要一个可以在任何站点下使用的命令来更新它。无论如何，我大部分时间都登录到服务器，所以，我只是跳到正确站点的根目录并调用`up`. 从 BZR 更新站点并重新启动。

这样做的第一个缺点是它会杀死机器上的所有 manage.py 进程。目前有6个站点，并且增长迅速。第二个（并且可能更糟——至少对于最终用户而言）是一个非常不优雅的重启。如果有人上传图片或做其他事情需要很长的连接时间，他们的请求就会死气沉沉。

所以我正在寻找的是对单一方法的建议：

1.  对于像我这样的懒人来说是通用的（例如，我可以从任何站点根目录运行它，而不必记住我需要调用哪个命令；`'up'`名字很完美。
2.  只杀死当前站点。我只更新当前站点，所以只有这个应该死。
3.  是否以优雅的方式重新启动。如果可能，它应该等到没有更多的活动连接。我不知道这有多可行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T14:00:23.323

您可以为每个站点编写一个仅终止该站点上的 manage.py 进程的脚本，而不是杀死名称中带有 manage.py 的所有内容吗？（编辑：只需编写脚本并将它们放在每个站点的根目录中（无论如何都要 cd 到）并运行它们——仍然只需要记住一个命令）

我对 SCGI 或 Bazaar 知之甚少，无法提出更多建议……我的方法（我也很懒）使用 Mercurial 和 Fabric 进行部署：[http ://stevelosh.com/blog/entry/2009/1 /15/deploying-site-fabric-and-mercurial/](http://stevelosh.com/blog/entry/2009/1/15/deploying-site-fabric-and-mercurial/) ——也许它会给你一个可以使用的想法？

# web-applications - 在网络应用的封闭测试期间获得良好反馈的最佳方式是什么？

> ID：433231
> 
> 赞同：1
> 
> 时间：2009-01-11T17:12:30.907
> 
> 标签：web-applications, feedback

如果只有电子邮件可用，那么用户似乎没有参与。

应用程序中的反馈框感觉像是朝着正确方向迈出的一步，但没有提供任何建立社区的能力。

Uservoice 和tenderapp 看起来都可以很好地工作，一旦您的应用程序通过了 beta 阶段，GetSatisfaction 似乎是一个更好的选择。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-11T17:42:31.330

Uservoice 之类的东西非常适合提供一般性建议，甚至发现错误，但它们很少回答您的具体问题/疑虑，因为这不是他们要做的。

我也不认为他们擅长将社区团结在一起。严重地。将您的用户推送到他们兴趣有限的另一个站点不在我的社区培养手册中。

你要：

1.  ... 让用户留在*您的*网站上。如果品牌良好，弹出式 JS 就*可以了。*但是他们可能仍然需要登录，然后出现的问题是......

2.  ... 让他们参与到他们提出的问题中。如果有人提出反馈，请向他们提出一些反馈。将他们困在这个过程中。向他们询问更多关于他们认为什么是正确的问题，或者他们为什么一开始就觉得某事不对劲。

3.  ... 使提供反馈是可取的。SO 运作良好的原因之一是它的积分系统。积分意味着奖品（或地位和权力，在这里），这是让人们想要继续前进的好方法。一些用户只会关心和激励只是让交易变得更甜蜜，但大多数用户不会真正关心足够多的人而没有从中受益的前景。

只是跳回到外部服务对于定向反馈来说过于通用的观点。作为开发人员，您有时需要提出具体问题以了解何时需要更改，而这种反馈通常需要在非常具体的时间点提出，通常是在完成一项任务之后。

在任务结束时将反馈问题粘贴*在您的网站上。*例如，如果用户发布了新的东西或其他东西，在流程结束时，将一个不可错过的盒子放在那里，询问他们对他们来说感觉如何。您可以提出相关问题，并且您会发现更多问题，因为人们刚刚完成了任务（与他们在 10 分钟后注意到您的反馈选项卡相反，当他们忘记了一半时）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-11T17:36:13.713

这里有几个单独的问题。如果您谈论的是测试人员，这意味着您正在运行和管理一个 beta 程序，在这种情况下，运行您的 beta 程序的人会定期与您的测试人员联系，无论是通过语音、电子邮件、调查、论坛还是任何。

如果您谈论的是 Web 2.0“测试版”，在其中您出于技术或业务原因限制用户数量，但您没有作为测试人员积极管理他们，那么您只有用户，而反馈框只是会从曲柄、书呆子和*真正*讨厌或喜欢你的应用程序的人那里得到行动。为了解决这个问题，您可以在肉类空间中进行传统的可用性测试。Jakob Nielsen 和 Steve Krug 都对如何廉价而有效地做到这一点有很好的、快速的总结。搜索[丢失了我们的租约可用性测试](http://www.google.com/search?q=lost+our+lease+usability+testing)。

建立社区是一个完全独立的问题，除了您提到的那些之外，您还可以考虑任何数量的创意选项，包括您的应用程序的 Twitter 流和开发者博客。

最后，您拥有的最好的事情之一就是您拥有一个网络应用程序。通过编写一个简单的日志记录和报告框架，您可以收集有关用户在系统上执行的每个操作的实际数据，这样您就可以获得有关用户在做什么以及他们是如何做的问题的经验答案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-05-15T14:31:10.830

作为 CCO @ Instabug 一个应用内反馈机制和移动错误跟踪工具，我想你可能想看看我们的朋友[HelpShift](http://helpshift.com)和[Apptentive](http://apptentive.com)，它们都提供了很好的应用内 CRM 方法和双向对话。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-11T18:47:37.610

我认为没有什么比亲自与客户保持联系（甚至通过电子邮件）并询问他们遇到的任何问题或可用性问题更好的了。与任何“提交您的反馈”框相比，这为改进机会提供了更好的反馈洞察力。

# python - 如何在 Django 中添加自定义内联管理小部件？

> ID：433251
> 
> 赞同：12
> 
> 时间：2009-01-11T17:25:11.333
> 
> 标签：python, django, django-admin

这对于非内联来说很容易。只需在 admin.py AdminOptions 中覆盖以下内容：

```
def formfield_for_dbfield(self, db_field, **kwargs):
    if db_field.name == 'photo':
        kwargs['widget'] = AdminImageWidget()
        return db_field.formfield(**kwargs)
    return super(NewsOptions,self).formfield_for_dbfield(db_field,**kwargs) 
```

我无法弄清楚如何使其适用于内联。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-12T00:44:41.027

它的工作方式完全相同。TabularInline 和 StackedInline 类也有一个 formfield_for_dbfield 方法，您可以在子类中以相同的方式覆盖它。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-05-25T20:35:09.390

从 Django 1.1 开始，formfield_overrides 也在工作

```
formfield_overrides = {
    models.ImageField: {'widget': AdminImageWidget},
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-01T10:52:42.803

工作示例：

```
class PictureInline(admin.StackedInline):
    model = Picture_Gallery
    extra = 3
    def formfield_for_dbfield(self, db_field, **kwargs):
        if db_field.name == 'name':
            kwargs['widget'] = MyWidget()
        return super(PictureInline,self).formfield_for_dbfield(db_field,**kwargs) 
```

# actionscript-3 - AS3：检测长按键

> ID：433254
> 
> 赞同：2
> 
> 时间：2009-01-11T17:27:24.123
> 
> 标签：actionscript-3, keyboard-events

我有一个需要对“长按键”做出反应的界面。这意味着根据键按下的时间长短，对同一键执行 2 种不同的操作：

按左光标：动作 A

按住左光标：动作 B

好吧，事实证明我想的更难。主要问题是，如果您按住键，Keyboard.KEY-DOWN 和 Keyboard.KEY-UP 都会连续触发。这对我来说看起来很奇怪，尽管如果您考虑输入文本可能会有意义（如果您正在输入文本并按住一个键，它会开始填充空间）。

当我试图解决这个问题时，我想在 KEY-DOWN 上启动一个计数器并在 KEY-UP 上重置它。然后，如果它达到某个阈值，则触发一个事件。问题是计数器立即重置，因为它们 KEY-UP 事件一直在触发。

我知道诸如[BigRoom](http://code.google.com/p/bigroom/wiki/KeyPoll)和[Senocular](http://www.senocular.com/flash/actionscript.php?file=ActionScript_3.0/com/senocular/utils/KeyObject.as)之类的键盘轮询类，但它们并没有解决问题，因为它们的状态基于相同的事件。

我可以让定时器在 KEY-DOWN 上启动一个定时器，并在 x 毫秒后检查键是否仍然处于关闭状态，但这会假设该键一直处于关闭状态。我不认为这会是可靠的。

这就是我开始没有想法的地方。我忽略了一个更简单的方法吗？我希望有！

谢谢，

胡安

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T21:26:43.153

只是想知道你是否找到了解决这个问题的方法。我没有同样的经历，所以我继续进行快速测试，看看我是否得到了相同的结果，但我没有——我只有在我真正放开钥匙时才得到 KEY_UP 事件：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" applicationComplete="app_applicationComplete()">

    <mx:Script>
        <![CDATA[

            private function app_applicationComplete():void
            {
                stage.addEventListener(KeyboardEvent.KEY_DOWN, app_keyDown);
                stage.addEventListener(KeyboardEvent.KEY_UP, app_keyUp);

                setFocus(); 
            }       

            private function app_keyDown(event:KeyboardEvent):void
            {
                trace("Down...");
            }

            private function app_keyUp(event:KeyboardEvent):void
            {
                trace("UP!");
            }

        ]]>
    </mx:Script>

</mx:Application> 
```

我的结果看起来更像这样 - 三个水龙头：

```
Down...
UP!
Down...
UP!
Down...
UP! 
```

...和“按住并释放”：

```
Down...
Down...
Down...
Down...
Down...
Down...
Down...
Down...
Down...
Down...
Down...
Down...
UP! 
```

只是想我会分享；我想您的键盘也有可能（尽管不太可能）在不应该的情况下向操作系统发送“向上”消息。但是假设您可以完成这项工作，您可能只需计算连续 KEY_DOWN 通知的数量，当您收到 KEY_UP 时重置计数器，以推断键被按住而不是轻按并松开。希望能帮助到你！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-01T19:35:40.333

抱歉，我花了这么长时间才回来，但当时正处于项目中间，真的没有时间深入研究。现在我有并且我发现没有这样的问题。阅读下面的长答案。

这只是在非常特定的情况下发生，可能没有人责怪 Adob​​e。

我有一台运行 Ubuntu 的 iMac，并在运行 Windows XP 的虚拟机上开发 Flash。此问题仅出现在虚拟 XP 上，在 Ubuntu（可能还有其他系统）上本地运行的同一应用程序不会显示此问题。

而且因为我在使用 VM 时还有其他一些键盘怪癖，所以我认为问题出在 VirtualBox 的键盘驱动程序上。

感谢所有花时间研究此事的人。我希望这对其他人有帮助！

胡安

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-11T18:26:44.440

当您按下某个键时，您确定 KEY_UP 会触发吗？这听起来太奇怪了！我的 Flex 试用版已过期，我还没有设置可以仅使用 SDK 进行编译的环境，因此我无法对此进行试验。但是[这个关于缺少 KEY_UP:s 的 actionscript.org 论坛主题](http://www.actionscript.org/forums/showthread.php3?t=134817)似乎表明这可能是 Flash 播放器的设置问题。这与您遇到的问题不同，但是如果他们遇到您的问题，他们肯定会抱怨...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-11T18:31:37.550

此[http://www.futtock.co.uk/flash/smooth-movieclip-key-control-in-as3/](http://www.futtock.co.uk/flash/smooth-movieclip-key-control-in-as3/)帖子可能包含提示。

顺便说一句：您的系统是否会在不需要的 key_up 之后立即生成新的 key_down？在这种情况下，您的键盘可能处于某种奇怪的设置中，使其自动重复按住的键。只是猜测...

# iphone - 如何处理编译器优化问题

> ID：433261
> 
> 赞同：4
> 
> 时间：2009-01-11T17:30:01.857
> 
> 标签：iphone, xcode, optimization, gcc, arm

我的 iPhone 应用程序有一个烦人的问题。每当我将优化级别设置为“无”以外的其他值时，都会出现计算错误。这只发生在为 iPhone SDK 构建时（iPhone 模拟器总是很好）。

我不介意在发布模式下禁用优化，但是当我这样做时应用程序有点太慢了。

应用程序很复杂，因此很难找到过于积极优化的部分。

我认为问题出在 GCC 方面，因为它似乎在优化 ARM 架构的代码方面存在问题。

有没有办法只对代码的某些部分禁用优化？你会如何处理这样的问题？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-11T17:35:31.610

是的，这完全有可能。GCC 有一个[属性](http://gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html#Function-Attributes)：

```
/* disable optimization for this function */
void my_function(void) __attribute__((optimize(0)));

void my_function(void) {
    /* ... */
} 
```

将该函数的优化级别设置为`-O0`。您可以启用/禁用特定优化：

```
/* disable optimization for this function */
void my_function(void) __attribute__((optimize("no-inline-functions")));

void my_function(void) {
    /* ... */
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-11T18:10:12.977

如果优化改变了程序的行为，您可能会不知不觉地依赖于未定义或实现定义的行为。可能值得仔细查看您的代码，着眼于关于变量值和评估顺序的假设。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-08T10:09:23.383

请检查您是否正确地`return`从您的函数中获取值。根据我的经验，以下方法有时有效：

```
int myFunc()
{
  x+7;
} 
```

*注意 return 关键字的故意和不安全的省略*

由于表达式计算中使用的寄存器与返回寄存器相同。

打开优化时，注册使用更改并且该功能无法执行您想要的操作。

检查您的编译器警告。

# variables - mocking superclass protected variable using jmockit

> ID：433263
> 
> 赞同：2
> 
> 时间：2009-01-11T17:30:59.187
> 
> 标签：variables, for-loop, protected, jmockit

I couldnt able to mock the protected varibale defined in the superclass.i could able to mock the protected method in superclass but couldnt to mock the protected variable in to the subclass ,wherein am writing the testcase for subclass,Please if anybody out there has any soluton for it .please reply.

Thanks Shashi

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-07-07T23:06:02.590

您可以使用该`Deencapsulation.setField`方法执行此操作。例如：

```
@Test public void staticVarOverride() {
    MyClass myClass = new MyClass();
    Deencapsulation.setField(MyClass.class, "myStatic", 2);
    // Assertions, verifications go here.
} 
```

这会将静态变量的值设置`myStatic`为 2。请注意，虽然这适用于静态，但不适用于静态决赛。AFAIK 没有办法覆盖静态决赛。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-20T01:17:38.607

**所有**的模拟工具都只模拟方法。

JMockit 还具有实用方法，这些方法提供对给定测试中不可访问的字段、方法和构造函数的访问。它们可直接用于 和 的子`mockit.Expectations`类`mockit.Verifications`。`mockit.Deencapsulation`静态类中也公开了相同的方法。

# asp.net-mvc - 在使用 MVC 和论坛数据库时，我应该使用会员提供程序吗？

> ID：433264
> 
> 赞同：1
> 
> 时间：2009-01-11T17:32:04.207
> 
> 标签：asp.net-mvc, asp.net-membership

我想使用论坛使用的现有**用户**和**用户组**表。我宁愿不必添加任何额外的表格（除了论坛已有的表格）。

我将使用 MS SQL。

论坛是 PHP，这就是为什么我希望 .net 站点处理所有逻辑。论坛将使用自己的 PHP 逻辑，因为我将设置和删除 cookie。

当用户请求新密码时，我想在电子邮件中指定文本。

我想在用户登录时设置额外的 cookie（以便他们在登录网站时登录论坛）。

是否可以使用 .net 会员提供者来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-11T17:38:48.157

您可以实现自己的提供程序，请参见[此处](http://msdn.microsoft.com/en-us/library/f1kyba5e.aspx)。通过这种方式，您可以选择任何您想要的数据库模式，使用您自己的密码规则等......它只需要您覆盖会员界面。然后您选择在 webconfig 中使用它，如果您将来更改，则具有 100% 的可移植性...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-11T22:38:21.687

我不会。会员提供者的东西是一个有漏洞的抽象。在将用户和组实现为成熟的域对象时，您具有更大的灵活性。

# mysql - Self-referencing updates in HQL

> ID：433268
> 
> 赞同：2
> 
> 时间：2009-01-11T17:34:09.523
> 
> 标签：mysql, hibernate, hql, mysql-error-1093

I have the following query in HQL:

```
update ProjectFile pf1 
set pf1.validUntil.id =123
where pf1 = (
select pf from ProjectVersion pv, ProjectFile as pf 
where pf.validFrom.sequence <= pv.sequence 
and pf.validUntil.sequence >= pv.sequence
and pf.state <> 12
and pf.projectVersion.project.id = 1
and pv.project.id = 1
and pv.id = 12
and pf.id not in (2,3,4)
) 
```

Hibernate parses the query correctly and generates SQL, but the database (MySQL) fails with error:

> You can't specify target table 'ProjectFile' for update in FROM clause

The problem seems to be that the table to be updated is queried in the same context. Is there any way to rewrite the HQL query to produce SQL that can be executed in MySQL correctly? The other approach would be to create an intermediate table, which is what exactly I am trying to avoid.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T13:44:55.173

我遇到了同样的问题并在这里发布了一个问题：[MySQL/SQL: Update with related subquery from the updated table itself](https://stackoverflow.com/questions/839938/mysql-sql-update-with-correlated-subquery-from-the-updated-table-itself)。

要解决您的问题，您需要在 UPDATE 级别加入，请查看我的问题的答案。

# scheduling - Calibrating Development Schedules

> ID：433272
> 
> 赞同：0
> 
> 时间：2009-01-11T17:36:04.713
> 
> 标签：scheduling, estimation

Are there any online repositories of completed real-world projects with their timescales that I can use to callibrate my own development time estimates?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-11T17:39:21.010

If such a repository existed, how would you expect to correlate your project to find matches?

To expand; every software development project has unique aspects - particularly with regard to project participants - and will therefore have unique dynamics that affect estimates, possibly by orders of magnitude.

To apply past project metrics to future projects and hope they hold up you would need to assume a few things;

*   Developers are interchangeable (they aren't)
*   Building software is like building a house or a brick wall (it isn't)
*   Project risks are negligible (maybe you'll get lucky?)

Finally, if all you need is a ball-park number then isn't "calibration" overkill? Just ask your most experienced developer how long they think - they are usually in the ball park.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T17:41:43.750

我不认为将您的项目与一组通用的其他项目相关联以确定时间 est. 将是非常有益的。您可以将缺陷率与其他项目进行比较 - 这是一个很好的起点：[http ://www.scribd.com/doc/7758538/Capers-Jones-Software-Quality-in-2008](http://www.scribd.com/doc/7758538/Capers-Jones-Software-Quality-in-2008)

我的建议是查看贵公司以前具有相同相关技术和资源的项目，并开发一个表格（通过功能点），然后持续重新同步。如果没有先前的信息和/或技术是新的和/或资源不同 - 那么最好使用团队先前工作的先前经验。

这是一本好书：[软件估算：揭开黑色艺术的神秘面纱](https://rads.stackoverflow.com/amzn/click/com/0735605351)

# c++ - std::vector 中堆栈帧之间的 C++ 参数值变化

> ID：433274
> 
> 赞同：4
> 
> 时间：2009-01-11T17:38:42.587
> 
> 标签：c++, debugging, memory, parameters, vector

我遇到了一个非常奇怪的错误，我希望有人能解释一下。我有一个简单的`std::vector<V3x>`，其中`V3x`是一个 3d 向量（线性代数类型）。以下代码导致`std::length_error`抛出异常：

```
std::vector<V3x> vertices;
int vertexCount = computeVertexCount();
vertices.resize(vertexCount); // throws std::length_error 
```

我已经验证了它`computeVertexCount()`返回的值`35`远低于`vector::max_size()`，所以它不可能要求太多的内存。

我将异常追溯到`std::vector`以下两个函数的定义。

```
void resize(size_type _Newsize, _Ty _Val)
    {   // determine new length, padding with _Val elements as needed
    if (size() < _Newsize)
        // NOTE: here, _Newsize - size() = 35
        _Insert_n(end(), _Newsize - size(), _Val); 
    else if (_Newsize < size())
        erase(begin() + _Newsize, end());
    }

void _Insert_n(const_iterator _Where,
    size_type _Count, const _Ty& _Val)
    {   // insert _Count * _Val at _Where
        // NOTE: here, _Count = 3435973836
        ...
    } 
```

因此，当参数在和`_Count`之间传递时，值从 35 变为 3435973836。我假设内存已以某种方式损坏，但我不知道这是怎么回事。`resize()``_Insert_n()`

如果它是问题的一部分，请提供更多上下文，此代码位于我从 Softimage XSI 加载的 .dll 插件中。

有谁知道什么可能导致这样的事情发生？

**编辑：解决方案**

nobugz，我可以吻你。

由于`_HAS_ITERATOR_DEBUGGING`在 VS2008 中，std::vector 的大小在我的 .dll 中发生了变化。搜索使我找到了[遇到同样问题的人](http://social.msdn.microsoft.com/Forums/en-US/vcgeneral/thread/efef799e-5d88-4a95-be39-4cd674be5d14/)，并通过在我的项目顶部添加以下内容来解决此问题：

```
// fix stack corruption errors caused by VS2008
#define _HAS_ITERATOR_DEBUGGING 0
#define _SECURE_SCL 0 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-11T18:43:54.530

值 3435973836 很重要。在十六进制中，即 0xcccccccc。这是堆栈帧初始化代码在调试模式下分配给局部变量的值。当您在调试时看到它时，您会说“啊，变量未初始化”。也许这会让你更接近解决这个问题。

你提到DLL。这也有关系。迭代器调试可能会给您带来麻烦，您不能将已关闭的代码与未关闭的代码混合使用。由于 DLL 可能是在没有它的情况下编译的，请尝试 #define _HAS_ITERATOR_DEBUGGING 0。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-11T18:26:34.393

每当参数或局部变量意外更改时，很有可能是由于堆栈损坏。每当您使用未初始化的局部变量或存储超出分配给本地字符串或数组的内存的数据时，就会发生这种情况。

一个简单的调试方法：

1.  将您的程序加载到调试器中。
2.  在有问题的函数的第一行代码处插入断点。
3.  执行程序直到遇到断点。
4.  对意外更改的变量设置监视。
5.  逐步执行该函数，直到发生意外更改。

当写入未分配（或错误分配）的内存时，将发生更改。写入的目标是有问题的变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-11T17:55:05.517

发布的代码是正确的，您可以假设 std::vector 没有错误。在最纯粹的环境中复制异常（新的空白项目）。在 ComputeVertexCount() 中可能是这样的愚蠢[吗？](https://stackoverflow.com/questions/263906/c-construction-weird-uninitialized-pointer)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-11T18:25:34.083

我建议查看为相关项目配置的 C++ 选项。确保它们都共享相同的对齐和运行时设置。您是否正在构建所涉及的 .DLL？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-11T19:46:29.317

[你可能会发现重新编译世界（一切）有帮助......](https://stackoverflow.com/questions/368262/function-call-jumps-to-the-wrong-function#370228)

# svn - SVN文件夹重命名后如何将其拆分为自己的存储库？

> ID：433276
> 
> 赞同：42
> 
> 时间：2009-01-11T17:38:50.620
> 
> 标签：svn, repository, split

我想将一个大型 Subversion 存储库中的目录拆分为它自己的存储库，并保留该目录中文件的历史记录。

我先尝试了常规的方法

```
svnadmin dump /path/to/repo > largerepo.dump
cat largerepo.dump | svndumpfilter include my/directory >mydir.dump 
```

但这不起作用，因为多年来该目录已被移动和复制，并且文件已被移入和移出到存储库的其他部分。结果是很多这样的：

```
svndumpfilter: Invalid copy source path '/some/old/path' 
```

接下来我尝试将`/some/old/path`它们包含在内，并且在包含一长串文件和目录之后，svndumpfilter 完成，但是导入结果转储不会产生与当前目录相同的文件。

**那么，如何在保留历史记录的同时正确地从该存储库中拆分目录？**

**编辑：**我特别想`trunk/myproj`成为新存储库中的主干加上新存储库不包含其他旧东西，即。任何人都不应该在拆分之前更新到旧版本并获取/查看文件。

我尝试的 svndumpfilter 解决方案可以实现这一点，遗憾的是它不可行，因为路径/文件已被移动。[ng](https://stackoverflow.com/questions/433276/svn-repository-split-problem#433304)的解决方案是不可接受的，因为它基本上是一个克隆+删除额外的东西，它保留了所有的历史，而不仅仅是相关的 myproj 历史。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-22T01:47:21.937

我在拆分存储库时遇到了类似的问题..

```
svndumpfilter: Invalid copy source path /dir/old_dir 
```

我为解决这个问题所做的就是包含正在请求的其他旧目录，或者您知道您已移动。就我而言，我已将 3 个目录移动到另一个目录中。

例如。将文件夹 A、B、C 移入文件夹 D

```
cat project.dump | svndumpfilter include A B C D > new.dump 
```

这似乎解决了我的问题。我能够将文件夹 D 与回购的其余部分分开。另一方面，当排除 DI 没有得到错误时，我猜是因为删除 D 不需要 A、B、C 的链接/历史记录

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-07-23T08:32:51.317

当 svndumpfilter 最初包含的目录/文件之一被复制或从未包含的树的一部分中移动时，会出现此问题。

要解决此问题，请使用此脚本：[svndumpfilter3](http://furius.ca/pubcode/pub/conf/bin/svndumpfilter3.html)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-03-05T10:08:55.737

我已经尝试了至少 4 种不同的应用程序来做到这一点，唯一**真正有效的是使用 [svndumpfilterIN](https://github.com/jasperlee108/svndumpfilterIN)**：

```
cd /usr/local/bin/
sudo wget --no-check-certificate https://raw.github.com/jasperlee108/svndumpfilterIN/master/svndumpfilter.py
sudo chmod +x svndumpfilter.py
# To be sure nothing will happened on the original repo :
cp -au /path/to/repo /tmp/largerepo.repo/
svnadmin dump /path/to/repo > /tmp/largerepo.dump
svndumpfilter.py /tmp/largerepo.dump --repo=/tmp/largerepo.repo --output-dump=/tmp/mydir.dump include my/directory 
```

这是我尝试过**但没有奏效**的方法：

*   [http://furius.ca/pubcode/pub/conf/bin/svndumpfilter3.html](http://furius.ca/pubcode/pub/conf/bin/svndumpfilter3.html)（[来自上一个答案](https://stackoverflow.com/a/1170429/535203)）
*   [包括前面另一个答案](https://stackoverflow.com/a/896076/535203)中所说的有问题的路径。问题：目标转储中仍有我不想要的路径
*   [svndumpsanitizer](https://github.com/dsuni/svndumpsanitizer)（在目标转储中我仍然有我不想要的路径）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-21T16:46:23.987

这可能会对您有所帮助：引用[http://svnbook.red-bean.com/en/1.5/svn.reposadmin.maint.html#svn.reposadmin.maint.replication](http://svnbook.red-bean.com/en/1.5/svn.reposadmin.maint.html#svn.reposadmin.maint.replication)

> 在 Subversion 1.5 中，svnsync 增加了镜像存储库子集而不是整个事物的能力。设置和维护这样一个镜像的过程与镜像整个存储库时完全相同，除了在运行 svnsync init 时不指定源存储库的根 URL，而是指定该存储库中某个子目录的 URL。与该镜像的同步现在将仅复制该源存储库子目录下更改的位。但是，这种支持有一些限制。首先，您不能将源存储库的多个不相交的子目录镜像到单个镜像存储库中——您需要镜像一些两者共有的父目录。二、过滤逻辑完全基于路径，因此，如果您要镜像的子目录在过去的某个时间点被重命名，则您的镜像将仅包含自该目录出现在您指定的 URL 以来的修订。同样，如果将来重命名源子目录，您的同步过程将在您指定的源 URL 不再有效时停止镜像数据。

问题当然是丢失了重命名历史......

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-03-30T19:50:01.447

我遇到了这个问题并最终使用了 svndumpfilter2。

具体来说，这个命令：

```
sudo svnadmin dump /home/setup/svn/repos/main_repl | sudo ./svndumpfilter2.py /home/setup/svn/repos/main_repl Development QA compliance > ~/main_repl_dump.trim 
```

我确实收到了提到的内存不足错误，但是，由于我在 VM 上运行 svn，我只是将内存提高到 2G。虽然我意识到这可能不是每个人的选择，但我注意到它的运行速度比 512M 快得多*。*（2G 可能不是必需的）。

目前，它正在处理修订版 18,631。

万一有人想知道，我需要拆分部分 repo 的原因是因为我们正在创建标签/副本以分发到 repo 的另一个路径中的文件实现。出于某种原因，这个过程导致回购膨胀到巨大的比例。（我们现在是 17G。）

我在 Debian Lenny 5.0.4 的 SVN 版本 1.5.6 的复制存储库中执行此操作。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-03-22T00:35:45.867

我刚刚成功地将一个项目从现有的组合存储库（在 Google 代码）迁移到它自己的存储库。这里的帖子很有帮助。

这终于对我有用了......

1.  使用 svnsync 按照[此处](http://code.google.com/p/support/wiki/SubversionFAQ#How_do_I_download_my_Subversion_history?)的说明制作我的 Google 代码仓库的本地镜像。
2.  `svnadmin dump to foo-dumpfile`
3.  `cat dumpfile | ./svndumpfilter3 --untangle mymirrorrepo trunk/foo > foo-dumpfile`
4.  `svnadmin create foorepo`
5.  `svnadmin load foorepo --ignore-uuid < foo-dumpfile`

第 3 步中的`--untangle`选项设法解决了所有困扰 svndumpfilter 和 svndumpfilter2 的路径问题。

最初，在第 5 步，我遇到了错误：

```
<<< Started new transaction, based on original revision 2
svnadmin: File not found: transaction '1-1', path 'trunk/foo' 
```

但是查尔斯卡尔弗特博客中的这篇[文章](http://www.celticwolf.com/blog/2010/05/03/subversion-svnadmin-load-error-file-not-found-transaction-0-1-path/)解释说，所需要的只是在执行加载之前在 foorepo 中创建主干目录。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-11T17:53:34.740

为什么不复制整个存储库，将其转储到新存储库。然后分支出主干，删除头部并将您想要的部分从分支合并回主干。然后你保留了历史并将你想要的部分拆分到一个新的存储库中。

1.  转储到 /trunk
2.  分支 /trunk 到 /branches/trunk
3.  删除/主干
4.  合并 /branches/trunk/whatever 到 /trunk 或 /trunk/whatever

这样，您就保留了所有历史记录，并有选择地选择了您想要的部分。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-03-22T13:41:13.307

我也在寻找这个问题的答案（必须自己处理）。根据 Alex 的回答，我发现 [http://furius.ca/pubcode/pub/conf/common/bin/svndumpfilter3.html](http://furius.ca/pubcode/pub/conf/common/bin/svndumpfilter3.html) 声称可以修复一些 svndumpfilter2 问题。我相信这是一个部分的解决方案。

**好的：**

> 用纯 Python 重写了 Subversion 的 svndumpfilter，它允许您通过将排除和包含的文件/目录集转换为附加集来解开移动/复制操作。如果您使用此选项，它将从给定存储库中获取原始文件。

**忧虑：**

> **重要的**
> 
> 有些人一直在报告这个脚本的一个错误，它会在一个大型存储库上创建一个空文件。它非常适合我必须在我的存储库上进行的拆分，但我没有时间解决其他人的存储库出现的问题

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-03-22T13:48:36.590

[这是在过于复杂的黑暗中疯狂而疯狂的刺伤，但是如何使用git-svn](http://git-scm.com/docs/git-svn) /[tailor][3]将 SVN 存储库导入 git ，使用[git-split 拆分](http://github.com/rjp/git-split)目录，然后将其导出回svn 与[git-svn](http://git-scm.com/docs/git-svn)？

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-11T19:56:02.527

具体命令如下，我将假设存储库托管在 http(s):// 服务器上，尽管相同的命令适用于 svn:// 或 file://。

```
svnadmin dump /path/to/repository > dumpfile  
svnadmin create /path/to/new_repository 
svnadmin load /path/to/new_repository < dumpfile 
svn co https://localhost/svn/new_repository_url new_repository_checkout 
cd new_repository_checkout 
svn move https://localhost/svn/new_repository_url/trunk  https://localhost/svn/new_repository_url/branches/head -m "Moving HEAD to branches" 
svn move https://localhost/svn/new_repository_url/branches/head/whatever https://localhost/svn/new_repository_url/trunk -m "Creating new trunk" 
svn update 
cd branches 
svn remove head
svn commit 
```

您现在应该将旧存储库中所需的部分作为新存储库的主干。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-27T21:02:18.897

我看到这已经很老了，但是添加“--skip-missing-merge-sources”有帮助吗？好像可能...

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-06T21:32:48.747

如果您不需要整个历史记录，您可以在错误发生后立即获取它。如果您的错误出现在修订版 412 中，那么您可以尝试在之后立即将其捡起：

```
svnadmin dump /path/to/repo -r 413:HEAD > largerepo.dump 
```

我意识到这可能也不是一个完美的解决方案，但在你的情况下它可能已经足够好了。

您可能还想一步完成这一切

```
svnadmin dump /path/to/repo -r 413:HEAD | svndumpfilter include my/directory > mydir.dump 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-01-21T15:01:47.290

有关 svndumpfilter 以及如何修复的更多信息 - [http://blog.rlucas.net/uncategorized/some-gotchas-with-using-svndumpfilter/](http://blog.rlucas.net/uncategorized/some-gotchas-with-using-svndumpfilter/)

或者您可以尝试 svndumpfilter 替换脚本，现在称为 svndumpfilter2 - [http://cogo.wordpress.com/2009/03/10/problems-with-svndumpfilter/](http://cogo.wordpress.com/2009/03/10/problems-with-svndumpfilter/)

我没有尝试过那个脚本，因为我需要一些时间来做一个 repo 备份，来测试它（我有一个备份转储可以玩，但在 Windows 上，它是一个 linux 脚本）。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-05-07T23:14:04.653

刚刚遇到这个问题并编写了一个小脚本来重试转储，直到解决所有无效的源路径。

```
#!/usr/bin/env ruby

require 'open3'
include Open3

paths = [ "/your/path" ]
command = ""

new_path = "xx"
while (! new_path.nil?)
lines = nil
popen3(" svndumpfilter include #{paths.join(' ')} > svn.result.dump < svn.original.dump") do |i, o, err|
  i.close
  puts "Processing, please wait ..."
  lines = err.readlines
end

 new_path = nil
 lines.each do |line|
  if line =~ /Invalid copy source path '(.*)'/
    new_path = $1
  end
 end
 puts "Adding #{new_path}"
 paths << new_path
end 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-05-09T14:31:52.167

基于 ng. 的回答，但过滤和删除空修订。

**步骤 1.**转储和过滤：

```
svnadmin dump /path/to/repository > fulldumpfile
svndumpfilter include trunk/the/part/you/want --drop-empty-revs --renumber-revs < fulldumpfile > dumpfile 
```

**步骤 2.**创建新的仓库。（请注意，这也可以使用 Tortoise SVN 来完成）

```
svnadmin create /path/to/new_repo 
```

请记住添加您需要能够结帐的任何内容（权限等）。

**第 3 步。**结帐并添加基本文件夹（也可以使用 Tortoise SVN 完成）

```
svn checkout http://localhost/new_repo /some/checkout/path/newrepo
cd /some/checkout/path/newrepo
# to be able to create "trunk/the/part/you/want" you will need to add parent dir:
mkdir -p trunk/the/part/you
svn add trunk
svn commit -m "old base" 
```

**步骤 4.**加载过滤后的转储

```
svnadmin load /path/to/new_repo < dumpfile 
```

**步骤 5.**将旧根移动到新根（也可以使用 Tortoise SVN）

```
cd /some/checkout/path/newrepo
svn update
svn move trunk/the/part/you/want/* trunk/
svn move tags/the/part/you/want/* tags/
svn move branches/the/part/you/want/* branches/
svn commit -m "re-structure base" 
```

您现在应该将旧存储库中所需的部分作为新存储库的主干。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-02-03T22:07:45.510

我们开发了[Subdivision](http://subdi.vision)，一个用于拆分 svn 存储库的 GUI 工具。

细分分析存储库并计算文件在整个存储库中被复制和移动时的历史记录。使用此信息，您的选择会得到智能扩充，以避免所有“无效的复制源路径”错误。

除了拆分存储库之外，Subdivision 还可用于从存储库中删除文件以及将文件和文件夹提取到新存储库中。

对于小型存储库，细分是免费的。

# c# - C# 更新绑定到通用列表的组合框

> ID：433281
> 
> 赞同：14
> 
> 时间：2009-01-11T17:40:16.453
> 
> 标签：c#, combobox, datasource, generic-list

我的表单上有一个组合框，它绑定到这样的通用字符串列表：

```
private List<string> mAllianceList = new List<string>();

private void FillAllianceList()
{
    // Add alliance name to member alliance list
    foreach (Village alliance in alliances)
    {
        mAllianceList.Add(alliance.AllianceName);
    }

    // Bind alliance combobox to alliance list
    this.cboAlliances.DataSource = mAllianceList;
} 
```

然后用户可以在组合框中添加或删除项目。
我在其他地方读到，通过简单地添加或删除通用列表中的项目，组合框的内容应该会自动更新；如果我在上面使用 Sort() 也会发生同样的事情。
但由于某种原因，我无法完成这项工作。我可以看到组合框的 DataSource 属性在我添加/删除/排序项目时正确更新，但组合框中显示的内容不是 DataSource 属性中的内容。

我肯定错过了什么或做错了什么。
提前致谢！

编辑：
*我选择的答案解决了添加和删除的问题，但是无法对 BindingList 对象进行排序，这对我来说是必要的。我找到了一个解决方案，其中通过继承 BindingList 并添加排序功能来构建自定义类，但我想知道在我的情况下是否有更简单的解决方案。
有关如何轻松解决此问题的任何建议？*

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-11T17:50:52.140

解决这个问题的最简单方法是简单地使用 BindingList ，如下所示：

```
private List<string> mAllianceList = new List<string>();
private BindingList<string> bindingList;    

private void FillAllianceList()
{
    // Add alliance name to member alliance list
    foreach (Village alliance in alliances)
    {
        mAllianceList.Add(alliance.AllianceName);
    }

    bindingList = new BindingList<string>(mAllianceList);

    // Bind alliance combobox to alliance list
    this.cboAlliances.DataSource = bindingList;
} 
```

然后，从这里开始，只需处理绑定列表即可从那里添加和删除项目。这将从列表和组合框中删除它。

编辑：要回答有关排序的问题，我想最简单（但可能是“hacky”的方法是这样的：

```
mAllianceList.Sort();
bindingList = new BindingList<string>(mAllianceList);
this.cboAlliances.DataSource = bindingList; 
```

所以基本上，在你排序之后，你会创建一个新的绑定列表并重置数据源。也许有一种更优雅的方式来解决这个问题，但这应该可行。

# c# - “TagLib#”库发生了什么？

> ID：433291
> 
> 赞同：5
> 
> 时间：2009-01-11T17:46:25.160
> 
> 标签：c#, mp3, id3, taglib-sharp

TagLib#（TagLib sharp）的现状如何？

官方主页 www.taglib-sharp.com （由于停在该地址的新站点的 NSFW 特性而删除了链接。-BtL）不再存在！

我在[ohloh](http://www.ohloh.net/p/5598)上找到了旧主页仍然链接的项目。下载链接也指向旧站点。

但是 ohloh 开发页面链接到单项目[SVN 存储库](http://anonsvn.mono-project.com/source/trunk/taglib-sharp)，该存储库似乎正在积极开发中（最后提交日期：2009/02/20，当前版本号：2.0.3.2）。

此外，在[developer.novell.com wiki](http://developer.novell.com/wiki/index.php/TagLib_Sharp)上链接了相同的 SVN 存储库。

那么，是否有**最新的主页**，或者至少有**最新的二进制+文档版本**？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-14T07:53:37.550

Novell 上的页面 ( [http://www.novell.com/products/linuxpackages/opensuse11.1/taglib-sharp.html](http://www.novell.com/products/linuxpackages/opensuse11.1/taglib-sharp.html) ) 不再更新。

源代码现在托管在[https://github.com/mono/taglib-sharp](https://github.com/mono/taglib-sharp)上，安装和使用最新版本的最佳方法是使用 NuGet。在 Visual Studio 中打开包管理器控制台并键入：

```
PM> Install-Package taglib 
```

[TagLib# Windows 发行版](https://stackoverflow.com/questions/2181445/taglib-windows-distribution-or-another-good-id3-reader)也回答了这个问题？[或者另一个好的 ID3 阅读器？](https://stackoverflow.com/questions/2181445/taglib-windows-distribution-or-another-good-id3-reader)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-10-15T16:29:38.317

看起来它搬到了这里：[http ://www.novell.com/products/linuxpackages/opensuse11.1/taglib-sharp.html](http://www.novell.com/products/linuxpackages/opensuse11.1/taglib-sharp.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-06T23:50:39.643

由于每个人似乎都专注于 NuGet 或 Novell 的发布版本，我只是建议您从 GitHub 下载整个项目以获取最新版本。

1.  打开解决方案
2.  构建 -> 构建解决方案
3.  在项目中使用类库

我希望不是每个人都还在加载旧的二进制文件，在较新的版本中对容器格式（opus \o/）有更广泛的支持，以及修复和一个或另一个额外的支持标签。

# c++ - How to save and load a text mode game

> ID：433293
> 
> 赞同：2
> 
> 时间：2009-01-11T17:47:23.927
> 
> 标签：c++, load, save

I went in late in a [project of gamedev](http://www.gamedev.net/community/forums/topic.asp?topic_id=409907) of a simple text game in C++.I studied the project and I think I know how to do everything but i get stuck on a thing:how to save and load the game as proposed.I don't want to have the thing done for me,only you show me a way to do it.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-11T17:50:02.970

Well the simplest way I can think of is to have a structure/class which represents the whole games "state." And on save you simply write this entire structure from memory to disk. Loading would be the opposite.

What format it is on disk is entirely up to you, if your state consists entirely of simple data types, you may just want to write a binary blob. Or you might want to go with something more versatile such as serializing it to XML, it's really up to you.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-12T00:04:17.770

我只是快速浏览了帖子，但这是我的建议：

您的游戏状态可能由几个结构和一些数据数组组成。这些结构将定义玩家（姓名、健康、金钱等）、武器（攻击、机会等）、盔甲等……

首先，您将通过保存玩家的结构来写入玩家的状态。接下来是玩家拥有的武器数量，然后是一系列武器结构，盔甲也是如此……

文件格式将是

```
STRUCT player
INT num_of_weapons
STRUCT weapon
STRUCT weapon
STRUCT weapon
INT num_of_armor
STRUCT armor
STRUCT armor 
```

使用 fstream 可以轻松完成。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-11T17:57:05.497

The process you are describing is known as "serialization"- that is, taking an in-memory object and converting it into some form that can be saved to disk. It could be as simple as a raw memory dump, or something complicated like XML.

I suggest taking a look at the wikipedia article on this subject: [http://en.wikipedia.org/wiki/Serialization](http://en.wikipedia.org/wiki/Serialization)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-11T20:16:02.847

我没有阅读您链接到的网站，但您可能想要编写读取/写入基本文本文件的代码以加载/保存您的游戏。

首先，弄清楚如何格式化文本文件。例如，如果我正在编写一个允许玩家保存游戏的 pacman 游戏，那么文本文件可能如下所示：

```
5 
54700
3 
```

我会编写我的代码来一次读取一行文件：

第 1 行：玩家所在的关卡。

第 2 行：玩家拥有的点数。

第 3 行：玩家拥有的生命数。

在 Google 上搜索 C++ 文件输入/输出，以了解如何编写实际代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-11T20:10:08.100

XML 序列化似乎是最简单的解决方案。使用诸如[TinyXML](http://www.grinninglizard.com/tinyxml/)之类的小型轻量级库就更容易了。至于使文件不可读，您可以使用带有短键的简单 XOR 混淆。或者你可以试试[JSON](http://www.json.org/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-11T19:55:58.487

这完全取决于您的保存文件的复杂程度。如果它只是几个整数，那么简单地编写几个函数可能很容易，这些函数会以指定的顺序将这些值写入文件，然后以与写入它们相同的顺序加载它们。如果它需要更复杂并处理保存多个对象的值而不是序列化是你最好的选择。如果您正在寻找人类可读的保存格式，我建议您使用 XML 序列化，否则您可能需要查找一些非人类可读的格式。

# python - Django 查询中的列比较

> ID：433294
> 
> 赞同：14
> 
> 时间：2009-01-11T17:47:51.443
> 
> 标签：python, django, orm

我有以下模型：

```
class Car(models.Model):
    make = models.CharField(max_length=40)
    mileage_limit = models.IntegerField()
    mileage = models.IntegerField() 
```

我想选择里程小于mileage_limit的所有汽车，所以在SQL中它会是这样的：

```
select * from car where mileage < mileage_limit; 
```

在 Django 中使用 Q 对象，我知道我可以将列与任何值/对象进行比较，例如，如果我想获得里程数小于 100,000 的汽车，则类似于：

```
cars = Car.objects.filter(Q(mileage__lt=100000)) 
```

我想使用列名而不是固定值（在我的例子中是mileage_limit）。所以我希望能够做类似的事情：

```
cars = Car.objects.filter(Q(mileage__lt=mileage_limit)) 
```

但是，这会导致错误，因为它需要一个值/对象，而不是列名。有没有办法使用 Q 对象比较两列？我觉得这将是一个非常常用的功能，应该有一种简单的方法来做到这一点，但是在文档中找不到任何关于它的信息。

*注意：这是一个简化的示例，可能不需要使用 Q 对象。然而，真正的模型有更多的列，并且真正的查询更复杂，这就是我使用 Q 的原因。在这个问题中，我只是想具体弄清楚如何使用 Q 比较列。*

**编辑**

显然，在 Django 1.1 发布之后，可以执行以下操作：

```
cars = Car.objects.filter(mileage__lt=F('mileage_limit')) 
```

仍然不确定 F 是否应该像这样与 Q 一起工作：

```
cars = Car.objects.filter(Q(mileage__lt=F('mileage_limit'))) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-11T18:00:30.843

如果没有自定义 SQL，您现在无法执行此操作。django 开发人员正在开发一个 F() 函数，这将使它成为可能：[#7210 - F() 语法，需要设计反馈。](http://groups.google.com/group/django-developers/browse_thread/thread/c8cff7e5e16c692a#)

# c++ - 用于 C/C++ 的可移植且简单的 unicode 字符串库？

> ID：433301
> 
> 赞同：18
> 
> 时间：2009-01-11T17:52:18.020
> 
> 标签：c++, c, unicode

我正在寻找一个可移植且易于使用的 C/C++ 字符串库，它可以帮助我处理 Unicode 输入/输出。在最好的情况下，它将字符串以 UTF-8 存储在内存中，并允许我将字符串从 ASCII 转换为 UTF-8/UTF-16 并返回。除此之外，我不需要更多（好吧，自由许可证不会受到伤害）。我已经看到 C++ 带有一个[`<locale>`](http://dinkumware.com/manuals/default.aspx?manual=compleat&page=locale2.html)标头，但这似乎`wchar_t`只适用于它，它可能是也可能不是 UTF-16 编码的，而且我不确定这实际上有多好。

用例例如：在 Windows 上，unicode API 需要 UTF-16 字符串，我需要转换 ASCII 或 UTF-8 字符串以将其传递给 API。XML 解析也是如此，它可能带有 UTF-16，但我实际上只想在内部使用 UTF-8 进行处理（或者，如果我在内部切换到 UTF-16，我需要转换为反正）。

到目前为止，我已经看过[ICU](http://www.icu-project.org/)了，它非常大。此外，它希望使用它自己的项目文件来构建，而我更喜欢一个有 CMake 项目或易于构建的库（比如编译所有这些 .c 文件、链接和好去处） ，而不是在我的应用程序中运送像 ICU 这样大的东西。

你知道这样一个图书馆，它也在维护吗？毕竟，这似乎是一个非常基本的问题。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-11T18:12:04.953

[UTF8-CPP](https://github.com/nemtrif/utfcpp)似乎正是您想要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-11T17:58:58.177

我建议您查看[GNU iconv](http://www.gnu.org/software/libiconv/)库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-04-05T19:25:50.227

还有另一个可移植的 C 库，用于在 UTF-8、UTF-16、UTF-32、wchar 之间进行字符串转换 - [mdz_unicode](https://github.com/maxdz-gmbh/mdz_unicode)库。

# php - 将字符串转换为变量

> ID：433302
> 
> 赞同：20
> 
> 时间：2009-01-11T17:52:30.640
> 
> 标签：php, arrays, string, variables

我有一个多维关联数组，其中包括像

```
$data["status"]
$data["response"]["url"]
$data["entry"]["0"]["text"] 
```

我有一个像这样的字符串：

```
$string = 'data["status"]';
$string = 'data["response"]["url"]';
$string = 'data["entry"]["0"]["text"]'; 
```

如何将字符串转换为变量以访问正确的数组元素？此方法需要在任何维度的任何数组上工作。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-01-11T17:59:29.970

PHP 的[变量变量](http://us2.php.net/language.variables.variable)将在这里帮助您。您可以通过在变量前面加上另一个美元符号来使用它们：

```
$foo = "Hello, world!";
$bar = "foo";
echo $$bar; // outputs "Hello, world!" 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-01-11T17:57:39.427

又快又脏：

```
echo eval('return $'. $string . ';'); 
```

当然，首先需要对输入字符串进行清理。

如果您不喜欢又快又脏……那么这也可以，并且不需要 eval ，这甚至让我感到畏缩。

但是，它确实对字符串格式做出了假设：

```
<?php
$data['response'] = array(
    'url' => 'http://www.testing.com'
);

function extract_data($string) {
    global $data;

    $found_matches = preg_match_all('/\[\"([a-z]+)\"\]/', $string, $matches);
    if (!$found_matches) {
            return null;
    }

    $current_data = $data;
    foreach ($matches[1] as $name) {
            if (key_exists($name, $current_data)) {
                    $current_data = $current_data[$name];
            } else {
                    return null;
            }
    }

    return $current_data;
} 

echo extract_data('data["response"]["url"]');
?> 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-05-21T14:55:41.400

这可以以更简单的方式完成。您所要做的就是考虑 PHP 提供了哪些函数来创建变量。

```
$string = 'myvariable';
extract(array($string => $string));
echo $myvariable; 
```

完毕！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-11T17:56:02.940

您可以像这样访问它们：

```
print $$string; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-11T18:18:03.380

[在变量变量](http://us2.php.net/language.variables.variable)页面上找到了这个：

```
function VariableArray($data, $string) { 
    preg_match_all('/\[([^\]]*)\]/', $string, $arr_matches, PREG_PATTERN_ORDER); 

    $return = $arr; 
    foreach($arr_matches[1] as $dimension) { $return = $return[$dimension]; }

    return $return; 
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-05-21T05:20:30.147

我也在为此苦苦挣扎，我有这个：

```
$user  =  array('a'=>'alber', 'b'=>'brad'...);

$array_name = 'user'; 
```

我想知道如何进入阿尔伯特。

起初我试过

```
$value_for_a = $$array_name['a']; // this dosen't work 
```

然后

```
eval('return $'.$array_name['a'].';'); // this dosen't work, maybe the hoster block eval which is very common 
```

然后最后我尝试了愚蠢的事情：

```
$array_temp=$$array_name;
$value_for_a = $array_temp['a']; 
```

这只是工作完美！智慧，做简单做傻。

我希望这回答了你的问题

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-02-11T07:48:21.987

您可以使用操作符通过引用传递`&`。所以在你的例子中你会有这样的东西

```
$string = &$data["status"];
$string = &$data["response"]["url"];
$string = &$data["entry"]["0"]["text"]; 
```

否则，您需要执行以下操作：

```
$titular = array();
for ($r = 1; $r < $rooms + 1; $r ++)
{
    $title = "titular_title_$r";
    $firstName = "titular_firstName_$r";
    $lastName = "titular_lastName_$r";
    $phone = "titular_phone_$r";
    $email = "titular_email_$r";
    $bedType = "bedType_$r";
    $smoker = "smoker_$r";

    $titular[] = array(
        "title" => $$title,
        "first_name" => $$firstName,
        "last_name" => $$lastName,
        "phone" => $$phone,
        "email" => $$email,
        "bedType" => $$bedType,
        "smoker" => $$smoker
    );
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-09-25T11:51:53.507

有本机 PHP 函数：使用[http://php.net/manual/ru/function.parse-str.php](http://php.net/manual/ru/function.parse-str.php) (parse_str())。

不要忘记在解析之前从 '"' 中清理字符串。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-04-14T19:27:37.560

也许这个选项也适合：

```
$data["entry"]["0"]["text"];
$string = 'data["entry"]["0"]["text"]';

function getIn($arr, $params)
{
    if(!is_array($arr)) {
        return null;
    }
    if (array_key_exists($params[0], $arr) && count($params) > 1) {
        $bf = $params[0];
        array_shift($params);
        return getIn($arr[$bf], $params);
    } elseif (array_key_exists($params[0], $arr) && count($params) == 1) {

        return $arr[$params[0]];
    } else {
        return null;
}
}

preg_match_all('/(?:(\w{1,}|\d))/', $string, $arr_matches, PREG_PATTERN_ORDER);

array_shift($arr_matches[0]);
print_r(getIn($data, $arr_matches[0])); 
```

Ps 这对我有用。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2022-01-04T17:09:27.223

您还可以使用花括号（复杂变量表示法）来做一些技巧：

```
$h = 'Happy';
$n = 'New';
$y = 'Year';
$wish = ${$h.$n.$y};
echo $wish; 
```

# matlab - 如何在 MATLAB 中绘制没有黑边的曲面图？

> ID：433312
> 
> 赞同：41
> 
> 时间：2009-01-11T17:55:46.607
> 
> 标签：matlab, plot, graph

黑线很可怕，我怎样才能摆脱它们？我只想要彩色表面。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-01-11T20:34:21.750

另一种选择是将表面句柄对象的*edgeColor*和/或*lineStyle属性设置为**none*。

```
>> hSurf = surf(X,Y,Z,'EdgeColor','none','LineStyle','none','FaceLighting','phong'); 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-01-12T15:24:30.423

这是一个更通用的解决方案，您也可以在创建曲面后更改 edgeColor。它不依赖 LineStyle 和 FaceLighting。

```
a= peaks(1000);
h = surf(a)
set(h, ‘edgecolor’,'none’) 
```

请注意，我制作了一个 45 秒的视频，展示了这种情况的发生以及如何解决它。

[http://blogs.mathworks.com/videos/2008/08/13/matlab-basics-setting-edge-color-for-large-surface-plots/](http://blogs.mathworks.com/videos/2008/08/13/matlab-basics-setting-edge-color-for-large-surface-plots/)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-01-11T20:06:55.953

着色命令是你的朋友：

着色平面 - 为您提供没有网格线的表面

shading interp - 在补丁之间插入颜色以提供平滑的效果

着色刻面 - 为您提供带有黑色网格线的表面（类似于平面）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-11-06T17:41:45.160

我相信`shading interp`是你要找的那个。

# c++ - 在 PocketPC 上运行后台服务

> ID：433325
> 
> 赞同：5
> 
> 时间：2009-01-11T18:03:36.500
> 
> 标签：c++, winapi, windows-mobile, pocketpc

我最近给自己买了一部新手机，运行 Windows Mobile 6.1 Professional。当然，我目前正在考虑为它做一些编码，基于爱好。我的计划是让服务作为 DLL 运行，由 Services.exe 加载。这需要收集 som 数据，并定期（每 5-10 分钟）进行 som 处理。

由于我需要定期运行它，这对我来说有点问题，系统通常会在用户短时间不活动后进入睡眠状态（挂起）。

我一直在阅读我可以在 MSDN 上找到的所有文档，以及关于这个主题的 MSDN 博客，在我看来，这个问题有三种可能的解决方案：

1.  通过定期调用**SystemIdleTimerReset**将系统保持在“始终开启”状态。这似乎有点过分，因此是不可能的。

2.  让系统定期用**CeRunAppAtTime**唤醒，并进入无人看管状态，以进行我的处理。

3.  使用无人值守状态而不是进入完全挂起状态。这对用户来说是透明的，但系统永远不会进入睡眠状态。

第二种方法似乎是首选，但是，这需要系统在唤醒时调用可执行文件，唯一的任务是通知我的服务它应该开始处理。这似乎有点不必要，我想避免这个额外的可执行文件。我当然可以将所有处理转移到这个额外的可执行文件中，但是我想使用作为服务运行时提供的一些工具，并且在处理开始时也不会弹出程序（即使它在后台）。

乍一看，第三种方法似乎与第一种方法存在相同的基本问题。但是，我在一些 MSDN 博客上读到，使用这种方法实际上可以节省电池消耗，而不是经常进出挂起模式（对此的论点是 WM 平台的性质是当系统空闲时，电池消耗很少。进出挂起需要相当多的处理）。

所以我想我的问题如下：

*   在我的情况下，您会推荐哪种方法？关于保持最小的电池消耗和一个很好的干净的实现。

*   在方法二的情况下，是否可以消除对通知可执行文件的需要？是通过替代 API 函数，还是通过平台上现有的通用应用程序？

*   在方法三的情况下，您是否知道与声明相关的任何信息/统计数据，当使用无人值守模式而不是进入挂起状态时，可以延长电池寿命。例如，在首选无人值守模式之前，您需要多久将系统从挂起状态中拉出来。

*   实现特定（奖励）问题：是否有必要定期调用**SystemIdleTimerReset**以保持无人值守模式？

最后，如果您认为我过早地取消了方法一，请告诉我原因。

* * *

请在您的回复中包括您的回复是基于知识还是仅仅是猜测（也非常欢迎后者！）。

如果您认为我需要澄清这个问题的任何部分，请发表评论。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-11T20:48:51.190

CERunAppAtTime 是一个很容易被误解的 API（主要是因为这个可怕的名字）。它*不必*运行应用程序。[它可以简单地设置一个命名系统事件（参见MSDN 文档](http://msdn.microsoft.com/en-us/library/aa932775.aspx)中 pwszAppName 参数的描述）。如果您想知道它何时触发（在您的应用程序完成处理后让设备再次进入睡眠状态），只需有一个工作线程在同一个命名事件上执行 WaitForSingleObject 即可。

无人值守状态通常用于需要保持应用程序持续运行（如 MP3 播放器）但通过关闭背光（可能是最耗电的子系统）来节省电量的设备。

显然无人值守模式比挂起使用更多的功率，因为​​在挂起中唯一的功耗是用于 RAM 自刷新。在无人值守模式下，处理器仍处于供电和运行状态（几个外围设备也可能如此 - 取决于 OEM 如何定义其无人值守模式）。

SystemIdleTimerReset 只是防止电源管理器由于不活动而将设备置于低功耗模式。这种模式，无论是暂停、无人值守、飞行还是其他，都由 OEM 定义。谨慎使用它，因为这样做会影响设备的功耗。从用户的角度来看，在无人值守模式下执行此操作尤其成问题，因为他们可能认为设备已关闭（看起来是这样），但现在他们的电池寿命已经缩短。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T17:27:38.940

我有一篇很长的文章详细说明了您不应该期望能够获得可接受的电池寿命，因为 WM 并非旨在支持您正在尝试做的事情，*但是*- 您可以在唤醒时发出服务信号，进行处理，然后使用本文中的方法[立即](https://stackoverflow.com/questions/207542/how-can-i-shutdown-a-windows-mobile-device-programatically)使设备重新进入睡眠状态。通过这种方式，您*应该*能够将准时与睡眠时间的比率保持在非常低的水平——但正如您所说，我只是在猜测。

也可以看看：

[节能应用 (MSDN)](http://msdn.microsoft.com/en-us/library/aa454885.aspx)

[人民的力量](http://blogs.msdn.com/windowsmobile/archive/2005/08/01/446240.aspx)（[开发者 1](http://blogs.msdn.com/windowsmobile/archive/2005/08/03/447404.aspx)，[开发者 2](http://blogs.msdn.com/windowsmobile/archive/2005/08/11/450591.aspx)，[设备](http://blogs.msdn.com/windowsmobile/archive/2005/08/10/450186.aspx)）

[节能的 WM 应用程序（博客文章）](http://blogs.msdn.com/raffael/archive/2008/07/22/power-efficient-applications-on-windows-mobile.aspx)

# matlab - 如何在 MATLAB 中创建一个新图形？

> ID：433326
> 
> 赞同：52
> 
> 时间：2009-01-11T18:03:46.890
> 
> 标签：matlab, plot, figure

通常当我在[MATLAB](http://en.wikipedia.org/wiki/MATLAB)中绘图时，它总是在同一个图形上绘制。我如何让它绘制一个新的图形？

我知道它非常初级，但我没有使用 Google 搜索找到它。

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2009-01-11T18:05:06.760

```
figure;
plot(something); 
```

或者

```
figure(2);
plot(something);
...
figure(3);
plot(something else);
... 
```

等等

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2010-10-27T00:28:07.963

虽然执行“图（1），图（2），...”在大多数情况下会解决问题，但不会在所有情况下都解决。假设您的桌面上有一堆 MATLAB 图形，并且在运行代码之前，您打开的图形数量会不时变化。使用提供的答案，您将覆盖这些您可能不想要的数字。简单的解决方法是在绘图之前使用命令“figure”。

示例：您的桌面上有五个图形，来自您运行并使用的先前脚本

```
figure(1);
plot(...)

figure(2);
plot(...) 
```

您刚刚在桌面上绘制了数字。然而代码

```
figure;
plot(...)

figure;
plot(...) 
```

刚刚使用您想要的地块创建了图 6 和图 7，并单独留下了之前的地块 1-5。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-01-12T22:44:06.073

另一件需要注意的事情是，`clf`当你开始一个新的情节时，使用 (clear figure) 命令。否则，您可能会在一个预先存在的图形上绘图（单独使用命令不可能`figure`，但如果您这样做`figure(2)`，可能已经有一个图形＃2），具有多个轴，或者放置的轴有点有趣。用于`clf`确保您从头开始：

```
figure(N);
clf;
plot(something);
... 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-04-01T18:38:49.257

正如已经说过的：`figure`将为您的下一个情节创建一个新人物。调用`figure`时您也可以配置它。例子：

```
figHandle = figure('Name', 'Name of Figure', 'OuterPosition',[1, 1, scrsz(3), scrsz(4)]); 
```

该示例设置窗口的名称及其相对于所用屏幕的外部大小。这`figHandle`是生成图形的句柄，以后可以用来更改外观和内容。例子：

点符号：

```
figHandle.PaperOrientation = 'portrait';
figHandle.PaperUnits = 'centimeters'; 
```

老款式：

```
set(figHandle, 'PaperOrientation', 'portrait', 'PaperUnits', 'centimeters'); 
```

使用带有点符号或的句柄，`set`此处配置打印选项。

通过保留具有不同名称的图形的句柄，您可以与多个活动图形进行交互。要将现有图窗设置为您的活动图，请调用`figure(figHandle)`。新的地块现在将去那里。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-11-06T05:28:58.193

另一个常见的选项是当您确实希望在一个窗口中显示多个图时

```
f = figure;
hold on
plot(x1,y1)
plot(x2,y2)
... 
```

在同一个（新）图形上绘制多个数据集。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-04-01T18:57:27.053

就这么简单——

```
figure, plot(yourfigure); 
```

# c++ - C++ 的最小 XML 库？

> ID：433327
> 
> 赞同：7
> 
> 时间：2009-01-11T18:03:51.803
> 
> 标签：c++, c, xml

有哪些 XML 库，它们是最小的、易于使用的、几乎没有依赖关系（理想情况下没有）、可以静态链接并带有自由许可证？到目前为止，我一直是[TinyXML](http://www.grinninglizard.com/tinyxml/)的一个非常满意的用户，但我很好奇到目前为止我错过了哪些替代方案。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-11T18:07:31.810

[expat](http://expat.sourceforge.net/)是一个非常快速的 C XML 解析器（尽管存在 C++ 包装器），它被广泛用于许多开源项目中。如果我没记错的话，它几乎没有依赖关系，并且它是在非常自由的 MIT 许可证下获得许可的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-12T06:10:32.990

我推荐[rapidxml](http://rapidxml.sourceforge.net/)。它比 tinyxml 小一个数量级，并且不会像 tinyxml 那样阻塞文档类型。

如果您需要实体支持或任何高级功能，请忘记静态链接并使用 expat 或 libxml2。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-11T19:00:52.797

FWIW 还有一个 TinyXML 版本，其界面更类似于 C++，称为[ticpp](http://code.google.com/p/ticpp/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-11T18:35:00.680

有一个叫`libxml2`。

还有一个仅适用于 Windows 的解决方案，即作为 O/S 一部分的 COM 库，称为`msxml`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T01:06:50.263

在“[在 C++ 中生成 xml 最简单的方法是什么？](https://stackoverflow.com/questions/303371/whats-the-easiest-way-to-generate-xml-in-c) ”中，我写[了一个评论，列出了一些 C++ XML 库](https://stackoverflow.com/questions/303371/whats-the-easiest-way-to-generate-xml-in-c#303724)

[TinyXML++ (ticpp)](http://code.google.com/p/ticpp/)是，恕我直言，最适合在 C++ 中使用的小型、易于使用的 XML 库。

# python - 生成 VCF 文件的 Python 库？

> ID：433331
> 
> 赞同：7
> 
> 时间：2009-01-11T18:05:15.357
> 
> 标签：python, vcf-vcard

知道有什么好的图书馆吗？我做了一些搜索，没有遇到任何东西。以前一定有人做过这个，我讨厌重新发明轮子。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-11T19:13:17.920

我会看：

[http://vobject.skyhouseconsulting.com/usage.html](http://vobject.skyhouseconsulting.com/)（在“使用示例”下查看）

非常容易解析和生成 vCal 和 vCard。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-11T18:45:43.153

PyCoCuMa 似乎内置了一个 VCF 解析器，它会生成 VCard 输出。你可能有一些运气。我玩了一下。它解析了我周围的一些 VCF 文件，没有任何问题。不过，您很可能必须仔细研究源代码才能弄清楚如何使用它。

看：

[http://www.srcco.de/v/pycocuma](http://www.srcco.de/v/pycocuma)

[http://pycocuma.sourcearchive.com/documentation/0.4.5-6-5/vcard_8py-source.html](http://pycocuma.sourcearchive.com/documentation/0.4.5-6-5/vcard_8py-source.html)

# c - Is there is a software caching API out there?

> ID：433334
> 
> 赞同：1
> 
> 时间：2009-01-11T18:07:04.883
> 
> 标签：c, unix, sqlite, caching

I'm looking for an **API or an application** that can **cache** data from a **file or database**. My idea is that I have an application that reads a database, but the access to database is sequential and it is on a disk.

What I basically want to do is get the data from cache first and then if it doesn't exist in cache, then hit the database. Note I'm not using a mainstream database, I'm using [SQLite](http://www.sqlite.org/), but my performance requirements are very high.

So is there any product or API (free or commercial) that I can use for this purpose? Also I must have an API to interface with my cache.

I want to implement something like a web server cache or something like that.

I'm using C and Unix platform.

Thanks

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-11T18:15:13.603

您可能想考虑使用共享内存缓存，例如[memcached](http://www.danga.com/memcached/)，尽管这需要一个单独的守护进程，或者为自己滚动类似的东西。

我要提到的一件事是，您可能应该做一些实际的基准测试来检查您的数据库是否是您的瓶颈，如果那里的性能是一个真正的问题，那么您将不得不考虑扩展到非嵌入式 DBMS . 如果这不是一个选项，那么您仍然可以优化现有的数据库访问（查询优化、索引等）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-11T18:16:15.663

查看[memcached](http://www.danga.com/memcached/)。Brian Aker 为它编写了一个[C 库](http://download.tangent.org/libmemcached-0.2.tar.gz)。

但我也会赞同 Rob 的建议。SQLite 和“性能要求非常高”可能不一定一起使用，具体取决于您所指的性能方面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T01:34:50.550

你可以试试 Zola 的 CaLi 库：http: [//icis.pcz.pl/~zola/CaLi/](http://icis.pcz.pl/~zola/CaLi/)

# ios - 设置 UITextField 的最大字符长度

> ID：433337
> 
> 赞同：486
> 
> 时间：2009-01-11T18:08:11.093
> 
> 标签：ios, objective-c, cocoa-touch, uitextfield

`UITextField`加载 a 时，如何在 iPhone SDK 上设置 a 中的最大字符数`UIView`？

* * *

## 回答 #1

> 赞同：1045
> 
> 时间：2009-11-20T21:10:26.527

虽然`UITextField`该类没有最大长度属性，但通过设置文本字段`delegate`并实现以下委托方法来获得此功能相对简单：

**Objective-C**

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {
    // Prevent crashing undo bug – see note below.
    if(range.length + range.location > textField.text.length)
    {
        return NO;
    }

    NSUInteger newLength = [textField.text length] + [string length] - range.length;
    return newLength <= 25;
} 
```

**迅速**

```
func textField(_ textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String) -> Bool {

    let currentCharacterCount = textField.text?.count ?? 0
    if range.length + range.location > currentCharacterCount {
        return false
    }
    let newLength = currentCharacterCount + string.count - range.length
    return newLength <= 25
} 
```

在文本字段更改之前，UITextField 会询问代理是否*应*更改指定的文本。文本字段此时没有改变，所以我们获取它的当前长度和我们正在插入的字符串长度（通过粘贴复制的文本或使用键盘输入单个字符）减去范围长度。如果此值过长（本例中超过 25 个字符），`NO`则返回禁止更改。

在文本字段的末尾输入单个字符时，`range.location`将是当前字段的长度，并且`range.length`将为 0，因为我们没有替换/删除任何内容。插入到文本字段的中间只是意味着不同`range.location`，粘贴多个字符只是意味着`string`其中有多个字符。

删除单个字符或剪切多个字符由`range`具有非零长度和空字符串的 a 指定。替换只是使用非空字符串进行范围删除。

# 关于崩溃的“撤消”错误的说明

正如评论中提到的，有一个错误`UITextField`可能导致崩溃。

如果您粘贴到该字段中，但您的验证实现阻止了粘贴，则粘贴操作仍记录在应用程序的撤消缓冲区中。如果您随后触发撤消（通过摇动设备并确认撤消），`UITextField`将尝试用空字符串替换它*认为粘贴到自身的字符串。*这将崩溃，因为它*实际上*从未将字符串粘贴到自身中。它将尝试替换不存在的字符串的一部分。

幸运的是，您可以`UITextField`像这样保护自己免于自杀。您只需要确保它建议替换的范围*确实*存在于其当前字符串中。这就是上面最初的健全性检查所做的。

# swift 3.0，复制和粘贴工作正常。

```
func textView(_ textView: UITextView, shouldChangeTextIn range: NSRange, replacementText text: String) -> Bool {
        let str = (textView.text + text)
        if str.characters.count <= 10 {
            return true
        }
        textView.text = str.substring(to: str.index(str.startIndex, offsetBy: 10))
        return false
    } 
```

希望对你有帮助。

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2015-04-22T16:56:04.560

# 斯威夫特 4

```
import UIKit

private var kAssociationKeyMaxLength: Int = 0

extension UITextField {

    @IBInspectable var maxLength: Int {
        get {
            if let length = objc_getAssociatedObject(self, &kAssociationKeyMaxLength) as? Int {
                return length
            } else {
                return Int.max
            }
        }
        set {
            objc_setAssociatedObject(self, &kAssociationKeyMaxLength, newValue, .OBJC_ASSOCIATION_RETAIN)
            addTarget(self, action: #selector(checkMaxLength), for: .editingChanged)
        }
    }

    @objc func checkMaxLength(textField: UITextField) {
        guard let prospectiveText = self.text,
            prospectiveText.count > maxLength
            else {
                return
        }

        let selection = selectedTextRange

        let indexEndOfText = prospectiveText.index(prospectiveText.startIndex, offsetBy: maxLength)
        let substring = prospectiveText[..<indexEndOfText]
        text = String(substring)

        selectedTextRange = selection
    }
} 
```

编辑：内存泄漏问题已修复。

[![在此处输入图像描述](https://i.stack.imgur.com/t8WVj.png)](https://i.stack.imgur.com/t8WVj.png)

* * *

## 回答 #3

> 赞同：56
> 
> 时间：2009-01-11T19:40:02.733

谢谢八月！（[帖子](https://stackoverflow.com/questions/433337/iphone-sdk-set-max-character-length-textfield#433402)）

这是我最终使用的代码：

```
#define MAX_LENGTH 20

- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string
{
    if (textField.text.length >= MAX_LENGTH && range.length == 0)
    {
        return NO; // return NO to not change text
    }
    else
    {return YES;}
} 
```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2009-04-16T07:51:47.467

要完成**8 月**的回答，建议功能的可能实现（请参阅[UITextField 的委托](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UITextFieldDelegate_Protocol/UITextFieldDelegate/UITextFieldDelegate.html)）。

我没有测试**domness**代码，但如果用户达到限制，我的代码不会卡住，并且它与替换更小或相等的新字符串兼容。

```
-(BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {
    //limit the size :
    int limit = 20;
    return !([textField.text length]>limit && [string length] > range.length);
} 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2009-01-11T18:42:29.947

您不能直接执行此操作 -`UITextField`没有*maxLength*属性，但您可以设置`UITextField's`委托，然后使用：

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2012-09-07T07:39:45.630

通常您有多个长度不同的输入字段。

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {
    int allowedLength;
    switch(textField.tag) {
        case 1: 
            allowedLength = MAXLENGTHNAME;      // triggered for input fields with tag = 1
            break;
        case 2:
            allowedLength = MAXLENGTHADDRESS;   // triggered for input fields with tag = 2
            break;
        default:
            allowedLength = MAXLENGTHDEFAULT;   // length default when no tag (=0) value =255
            break;
    }

    if (textField.text.length >= allowedLength && range.length == 0) {
        return NO; // Change not allowed
    } else {
        return YES; // Change allowed
    }
} 
```

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2009-01-11T19:19:37.767

最好的方法是在文本更改时设置通知。在您`-awakeFromNib`的视图控制器方法中，您需要：

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(limitTextField:) name:@"UITextFieldTextDidChangeNotification" object:myTextField]; 
```

然后在同一个类中添加：

```
- (void)limitTextField:(NSNotification *)note {
    int limit = 20;
    if ([[myTextField stringValue] length] > limit) {
        [myTextField setStringValue:[[myTextField stringValue] substringToIndex:limit]];
    }
} 
```

然后将插座连接`myTextField`到您的插座`UITextField`，它不会让您在达到限制后添加更多字符。请务必将其添加到您的 dealloc 方法中：

```
[[NSNotificationCenter defaultCenter] removeObserver:self name:@"UITextFieldTextDidChangeNotification" object:myTextField]; 
```

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2012-08-20T10:10:17.743

这应该足以解决问题（将 4 替换为您想要的限制）。只需确保在 IB 中添加委托即可。

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string
{
     NSString *newString = [textField.text stringByReplacingCharactersInRange:range withString:string];
     return (newString.length<=4);
} 
```

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2014-04-12T22:37:52.287

我创建了[这个](https://github.com/JonathanGurebo/UITextFieldLimit)UITextFieldLimit 子类：

*   支持多个文本字段
*   设置文本长度限制
*   粘贴预防
*   在文本字段内显示左侧字符的标签，停止编辑时隐藏。
*   当没有角色离开时摇动动画。

从这个 GitHub 存储库中获取`UITextFieldLimit.h`和：`UITextFieldLimit.m`

[https://github.com/JonathanGurebo/UITextFieldLimit](https://github.com/JonathanGurebo/UITextFieldLimit)

并开始测试！

标记您的故事板创建的 UITextField 并使用身份检查器将其链接到我的子类：

![身份检查员](https://i.stack.imgur.com/7lbJp.png)

然后您可以将其链接到 IBOutlet 并设置限制（默认为 10）。

* * *

您的 ViewController.h 文件应包含：（如果您不想修改设置，例如限制）

```
#import "UITextFieldLimit.h"

/.../

@property (weak, nonatomic) IBOutlet UITextFieldLimit *textFieldLimit; // <--Your IBOutlet 
```

* * *

您的 ViewController.m 文件应该`@synthesize textFieldLimit`.

* * *

在 ViewController.m 文件中设置文本长度限制：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
// Do any additional setup after loading the view, typically from a nib.

    [textFieldLimit setLimit:25];// <-- and you won't be able to put more than 25 characters in the TextField.
} 
```

希望课堂能帮到你。祝你好运！

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2018-07-26T13:30:35.650

`UITextField`使用以下扩展名设置 a和.的最大字符长度`UITextView`。

**斯威夫特 4.0**

```
 private var kAssociationKeyMaxLength: Int = 0
    private var kAssociationKeyMaxLengthTextView: Int = 0
    extension UITextField {

        @IBInspectable var maxLength: Int {
            get {
                if let length = objc_getAssociatedObject(self, &kAssociationKeyMaxLength) as? Int {
                    return length
                } else {
                    return Int.max
                }
            }
            set {
                objc_setAssociatedObject(self, &kAssociationKeyMaxLength, newValue, .OBJC_ASSOCIATION_RETAIN)
                addTarget(self, action: #selector(checkMaxLength), for: .editingChanged)
            }
        }

        @objc func checkMaxLength(textField: UITextField) {
            guard let prospectiveText = self.text,
                prospectiveText.count > maxLength
                else {
                    return
            }

            let selection = selectedTextRange

            let indexEndOfText = prospectiveText.index(prospectiveText.startIndex, offsetBy: maxLength)
            let substring = prospectiveText[..<indexEndOfText]
            text = String(substring)

            selectedTextRange = selection
        }
    } 
```

# UITextView

```
extension UITextView:UITextViewDelegate {

        @IBInspectable var maxLength: Int {
            get {
                if let length = objc_getAssociatedObject(self, &kAssociationKeyMaxLengthTextView) as? Int {
                    return length
                } else {
                    return Int.max
                }
            }
            set {
                self.delegate = self

                objc_setAssociatedObject(self, &kAssociationKeyMaxLengthTextView, newValue, .OBJC_ASSOCIATION_RETAIN)
            }
        }

        public func textViewDidChange(_ textView: UITextView) {
            checkMaxLength(textField: self)
        }
        @objc func checkMaxLength(textField: UITextView) {
            guard let prospectiveText = self.text,
                prospectiveText.count > maxLength
                else {
                    return
            }

            let selection = selectedTextRange

            let indexEndOfText = prospectiveText.index(prospectiveText.startIndex, offsetBy: maxLength)
            let substring = prospectiveText[..<indexEndOfText]
            text = String(substring)

            selectedTextRange = selection
        }
    } 
```

您可以在下面设置限制。

[![在此处输入图像描述](https://i.stack.imgur.com/CaZPP.png)](https://i.stack.imgur.com/CaZPP.png)

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2011-07-28T04:58:48.637

我模拟即将发生的实际字符串替换来计算未来字符串的长度：

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {

    NSString *newString = [textField.text stringByReplacingCharactersInRange:range withString:string];

    if([newString length] > maxLength)
       return NO;

    return YES;
} 
```

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2016-08-11T12:17:26.457

在 Swift 中有设置最大长度的***通用解决方案。***通过 IBInspectable，您可以在 Xcode 属性检查器中添加新属性。[![在此处输入图像描述](https://i.stack.imgur.com/NcsM3.png)](https://i.stack.imgur.com/NcsM3.png)

```
import UIKit
private var maxLengths = [UITextField: Int]()
extension UITextField {

    @IBInspectable var maxLength: Int {
        get {
            guard let length = maxLengths[self]
            else {
                return Int.max
            }
            return length
        }
        set {
            maxLengths[self] = newValue
            addTarget(
                self,
                action: Selector("limitLength:"),
                forControlEvents: UIControlEvents.EditingChanged
            )
        }
    }

    func limitLength(textField: UITextField) {
        guard let prospectiveText = textField.text
            where prospectiveText.characters.count > maxLength else {
                return
        }
        let selection = selectedTextRange
        text = prospectiveText.substringWithRange(
            Range<String.Index>(prospectiveText.startIndex ..< prospectiveText.startIndex.advancedBy(maxLength))
        )
        selectedTextRange = selection
    }

} 
```

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2016-09-29T15:28:47.293

Swift 3 版本 //***** 这不适用于 Swift 2.x！*****//

首先新建一个 Swift 文件：TextFieldMaxLength.swift，然后添加如下代码：

```
import UIKit

private var maxLengths = [UITextField: Int]()

extension UITextField {

   @IBInspectable var maxLength: Int {

      get {

          guard let length = maxLengths[self] 
             else {
                return Int.max
      }
      return length
   }
   set {
      maxLengths[self] = newValue
      addTarget(
         self,
         action: #selector(limitLength),
         for: UIControlEvents.editingChanged
      )
   }
}
func limitLength(textField: UITextField) {
    guard let prospectiveText = textField.text,
        prospectiveText.characters.count > maxLength
    else {
        return
    }

   let selection = selectedTextRange
   let maxCharIndex = prospectiveText.index(prospectiveText.startIndex, offsetBy: maxLength)
   text = prospectiveText.substring(to: maxCharIndex)
   selectedTextRange = selection
   }
} 
```

然后当您选择任何 TextField 时，您将在 Storyboard 中看到一个新字段（最大长度）

如果您还有更多问题，请查看此链接：[http ://www.globalnerdy.com/2016/05/18/ios-programming-trick-how-to-use-xcode-to-set-a-text-fields -最大长度视觉工作室风格/](http://www.globalnerdy.com/2016/05/18/ios-programming-trick-how-to-use-xcode-to-set-a-text-fields-maximum-length-visual-studio-style/)

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2010-09-16T08:35:52.853

使用界面生成器，您可以在任何功能中链接并获取“编辑更改”事件。现在你可以在那里检查长度

```
- (IBAction)onValueChange:(id)sender 
{
    NSString *text = nil;
    int MAX_LENGTH = 20;
    switch ([sender tag] ) 
    {
        case 1: 
        {
            text = myEditField.text;
            if (MAX_LENGTH < [text length]) {
                myEditField.text = [text substringToIndex:MAX_LENGTH];
            }
        }
            break;
        default:
            break;
    }

} 
```

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2014-08-12T08:02:52.443

以下代码与ickp 的答案类似，但可以正确处理复制粘贴操作。如果您尝试粘贴超过限制的文本，以下代码将截断文本以适应限制，而不是完全拒绝粘贴操作。

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {
    static const NSUInteger limit = 70; // we limit to 70 characters
    NSUInteger allowedLength = limit - [textField.text length] + range.length;
    if (string.length > allowedLength) {
        if (string.length > 1) {
            // get at least the part of the new string that fits
            NSString *limitedString = [string substringToIndex:allowedLength];
            NSMutableString *newString = [textField.text mutableCopy];
            [newString replaceCharactersInRange:range withString:limitedString];
            textField.text = newString;
        }
        return NO;
    } else {
        return YES;
    }
} 
```

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2009-10-13T07:34:32.770

为了使它适用于任何长度的字符串的剪切和粘贴，我建议将函数更改为：

```
#define MAX_LENGTH 20

- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string
    {
        NSInteger insertDelta = string.length - range.length;

        if (textField.text.length + insertDelta > MAX_LENGTH)
        {
           return NO; // the new string would be longer than MAX_LENGTH
        }
        else {
            return YES;
        }
    } 
```

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2018-02-09T17:07:15.257

**斯威夫特 4**

```
func textField(_ textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String) -> Bool {
    guard let text = textField.text else { return true }
    let newLength = text.count + string.count - range.length
    return newLength <= 10
} 
```

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2015-11-27T18:51:52.150

**斯威夫特 2.0 +**

首先为这个过程创建一个类。让我们称之为 StringValidator.swift。

然后只需将以下代码粘贴到其中。

```
import Foundation

extension String {

func containsCharactersIn(matchCharacters: String) -> Bool {
let characterSet = NSCharacterSet(charactersInString: matchCharacters)
return self.rangeOfCharacterFromSet(characterSet) != nil
}

func containsOnlyCharactersIn(matchCharacters: String) -> Bool {
let disallowedCharacterSet = NSCharacterSet(charactersInString: matchCharacters).invertedSet
return self.rangeOfCharacterFromSet(disallowedCharacterSet) == nil
}

func doesNotContainCharactersIn(matchCharacters: String) -> Bool {
let characterSet = NSCharacterSet(charactersInString: matchCharacters)
return self.rangeOfCharacterFromSet(characterSet) == nil
}

func isNumeric() -> Bool
{
let scanner = NSScanner(string: self)
scanner.locale = NSLocale.currentLocale()

return scanner.scanDecimal(nil) && scanner.atEnd
}

} 
```

现在保存课程......

**用法..**

现在转到您的 viewController.swift 类并将您的文本字段的网点设置为..

```
@IBOutlet weak var contactEntryTxtFld: UITextField! //First textfield
@IBOutlet weak var contactEntryTxtFld2: UITextField!   //Second textfield 
```

现在转到文本字段的 shouldChangeCharactersInRange 方法并使用如下。

```
func textField(textField: UITextField, shouldChangeCharactersInRange range: NSRange, replacementString string: String) -> Bool {
    if string.characters.count == 0 {
        return true
    }
    let latestText = textField.text ?? ""
    let checkAbleText = (latestText as NSString).stringByReplacingCharactersInRange(range, withString: string)

    switch textField {

    case contactEntryTxtFld:
        return checkAbleText.containsOnlyCharactersIn("0123456789") && prospectiveText.characters.count <= 5

    case contactEntryTxtFld2:
        return checkAbleText.containsOnlyCharactersIn("0123456789") && prospectiveText.characters.count <= 5

    default:
        return true
    }

} 
```

不要忘记设置文本字段的委托协议/方法。

让我解释一下……我正在使用我在另一个类中编写的字符串的简单扩展过程。现在我只是通过添加检查和最大值从另一个需要它们的类中调用这些扩展方法。

**特征...**

1.  它将设置特定文本字段的最大限制。
2.  它将为特定文本字段设置接受键的类型。

**类型...**

containsOnlyCharactersIn //仅接受字符。

containsCharactersIn //接受字符组合

doesNotContainsCharactersIn //不会接受字符

希望这有帮助....谢谢..

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2016-12-29T13:35:44.490

# 迅捷3.0

当您粘贴的字符串超过字符限制时，此代码可以正常工作。

```
func textView(_ textView: UITextView, shouldChangeTextIn range: NSRange, replacementText text: String) -> Bool {
        let str = (textView.text + text)
        if str.characters.count <= 10 {
            return true
        }
        textView.text = str.substring(to: str.index(str.startIndex, offsetBy: 10))
        return false
    } 
```

感谢您的投票。:)

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2018-02-06T12:51:21.787

我根据@Frouo 给出一个补充答案。我认为他的回答是最美丽的方式。因为它是我们可以重用的通用控件。

```
private var kAssociationKeyMaxLength: Int = 0

extension UITextField {

    @IBInspectable var maxLength: Int {
        get {
            if let length = objc_getAssociatedObject(self, &kAssociationKeyMaxLength) as? Int {
                return length
            } else {
                return Int.max
            }
        }
        set {
            objc_setAssociatedObject(self, &kAssociationKeyMaxLength, newValue, .OBJC_ASSOCIATION_RETAIN)
            self.addTarget(self, action: #selector(checkMaxLength), for: .editingChanged)
        }
    }

    func checkMaxLength(textField: UITextField) {

        guard !self.isInputMethod(), let prospectiveText = self.text,
            prospectiveText.count > maxLength
            else {
                return
        }

        let selection = selectedTextRange
        let maxCharIndex = prospectiveText.index(prospectiveText.startIndex, offsetBy: maxLength)
        text = prospectiveText.substring(to: maxCharIndex)
        selectedTextRange = selection
    }

    //The method is used to cancel the check when use Chinese Pinyin input method.
    //Becuase the alphabet also appears in the textfield when inputting, we should cancel the check.
    func isInputMethod() -> Bool {
        if let positionRange = self.markedTextRange {
            if let _ = self.position(from: positionRange.start, offset: 0) {
                return true
            }
        }
        return false
    }

} 
```

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2013-09-23T15:30:17.993

这是在 UITextField 上处理最大长度的正确方法，它允许返回键退出作为第一响应者的文本字段，并让用户在达到限制时退格

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {
int MAX_LENGHT = 5;
    if([string isEqualToString:@"\n"])
    {
        [textField resignFirstResponder];
        return FALSE;
    }
    else if(textField.text.length > MAX_LENGHT-1)
    {
        if([string isEqualToString:@""] && range.length == 1)
        {
            return TRUE;
        }
        else
        {
            return FALSE;
        }
    }
    else
    {
        return TRUE;
    }
} 
```

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2018-09-04T21:44:22.487

这个简单的方法怎么样。它对我来说工作正常。

```
extension UITextField {

    func  charactersLimit(to:Int) {

        if (self.text!.count > to) {
            self.deleteBackward()
        }
    }
} 
```

然后：

```
someTextField.charactersLimit(to:16) 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2013-04-04T05:39:20.733

其他答案不处理用户可以从剪贴板粘贴长字符串的情况。如果我粘贴一个长字符串，它应该被截断但显示出来。在您的委托中使用它：

```
static const NSUInteger maxNoOfCharacters = 5;

-(IBAction)textdidChange:(UITextField * )textField
{
NSString * text = textField.text;

if(text.length > maxNoOfCharacters)
{
    text = [text substringWithRange:NSMakeRange(0, maxNoOfCharacters)];
    textField.text = text;
}

// use 'text'

} 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2013-11-26T11:30:48.327

现在你想要多少个字符只是给出值

```
 - (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range   replacementString:(NSString *)string {
     NSUInteger newLength = [textField.text length] + [string length] - range.length;
     return (newLength > 25) ? NO : YES;
  } 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2013-12-13T06:16:10.513

将其简化为 1 行代码:)

将文本视图的委托设置为“self”，然后`<UITextViewDelegate>`在 .h 中添加，在 .m 中添加以下代码 .... 您可以将数字“7”调整为您想要的最大字符数。

```
-(BOOL)textView:(UITextView *)a shouldChangeTextInRange:(NSRange)b replacementText:(NSString *)c {
    return ((a.text.length+c.length<=7)+(c.length<1)+(b.length>=c.length)>0);
} 
```

该代码包括输入新字符、删除字符、选择字符然后输入或删除、选择字符和剪切、一般粘贴以及选择字符和粘贴。

完毕！

* * *

或者，使用位操作编写此代码的另一种很酷的方法是

```
-(BOOL)textView:(UITextView *)a shouldChangeTextInRange:(NSRange)b replacementText:(NSString *)c {
    return 0^((a.text.length+c.length<=7)+(c.length<1)+(b.length>=c.length));
} 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2014-11-28T17:48:09.787

我已经实现了一个 UITextField 扩展来向它添加一个 maxLength 属性。

它基于 Xcode 6 IBInspectables，因此您可以在 Interface builder 上设置 maxLength 限制。

这是实现：

> UITextField+MaxLength.h

```
#import <UIKit/UIKit.h>

@interface UITextField_MaxLength : UITextField<UITextFieldDelegate>

@property (nonatomic)IBInspectable int textMaxLength;
@end 
```

> UITextField+MaxLength.m

```
#import "UITextField+MaxLength.h"

@interface UITextField_MaxLength()

@property (nonatomic, assign) id <UITextFieldDelegate> superDelegate;

@end

@implementation UITextField_MaxLength

- (BOOL)textField:(UITextField *) textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {

    //validate the length, only if it's set to a non zero value
    if (self.textMaxLength>0) {
        if(range.length + range.location > textField.text.length)
            return NO;

        if (textField.text.length+string.length - range.length>self.textMaxLength) {
            return NO;
        }
    }

    //if length validation was passed, query the super class to see if the delegate method is implemented there
    if (self.superDelegate && [self.superDelegate respondsToSelector:@selector(textField:shouldChangeCharactersInRange:replacementString:)]) {
        return [self.superDelegate textField:textField shouldChangeCharactersInRange:range replacementString:string];
    }
    else{
        //if the super class does not implement the delegate method, simply return YES as the length validation was passed
        return YES;
    }
}

- (void)setDelegate:(id<UITextFieldDelegate>)delegate {
    if (delegate == self)
        return;
    self.superDelegate = delegate;
    [super setDelegate:self];
}

//forward all non overriden delegate methods
- (id)forwardingTargetForSelector:(SEL)aSelector {
    if ([self.superDelegate  respondsToSelector:aSelector])
        return self.superDelegate;

    return [super forwardingTargetForSelector:aSelector];
}

- (BOOL)respondsToSelector:(SEL)aSelector {
    if ([self.superDelegate respondsToSelector:aSelector])
        return YES;

    return [super respondsToSelector:aSelector];
}
@end 
```

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2015-06-17T01:02:34.157

我已经开源了一个 UITextField 子类[STATextField](https://github.com/Stunner/STAControls/blob/master/STAControls/STAControls/TextField/STATextField.h)，它通过它的属性提供了这个功能（以及更多）`maxCharacterLength`。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2015-09-30T10:36:55.457

在此处使用此代码 RESTRICTED_LENGTH 是您要限制文本字段的长度。

```
 - (BOOL)textField:(UITextField *)textField     shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string
{
    if (textField == nameTF) {
    int limit = RESTRICTED_LENGTH - 1;
    return !([textField.text length]>limit && [string length] > range.length);
    }
   else
   {
    return YES;
   }

return NO;

} 
```

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2016-01-20T20:06:40.843

我在 Swift 中使用数字键盘时限制了 8 个字符。

```
func textField(textField: UITextField, shouldChangeCharactersInRange range: NSRange, replacementString string: String) -> Bool {
    return !(textField.text?.characters.count == MAX_LENGTH && string != "")
} 
```

我必须测试 string != "" 以允许删除按钮在数字键盘上工作，否则在达到最大值后将不允许删除文本字段中的字符。

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2016-03-01T13:41:09.670

对于 Xamarin：

```
YourTextField.ShouldChangeCharacters = 
delegate(UITextField textField, NSRange range, string replacementString)
        {
            return (range.Location + replacementString.Length) <= 4; // MaxLength == 4
        }; 
```

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2016-11-30T06:05:53.997

如果您限制文本计数的目的是确保文本适合其他地方的 UILabel，我会避免使用字符计数。它会因一些表情符号而崩溃（尝试截断双倍大小的表情符号可能会使您的应用程序崩溃）。这也是一些语言（如日语和中文）的问题，它们有两步输入过程，简单的计数是行不通的。

我构建了一个 UITextField 插入子类（[github 上的 MPC_CharacterLimitedTextField](https://github.com/fareast555/MPC_CharacterLimitedTextField)）。你给它提供预期的输出标签宽度，它会处理所有语言、表情符号和粘贴问题。无论字符数如何，它都只会收集适合标签的完整字符。该项目中有一个演示，因此您可以对其进行测试以查看它是否是您所需要的。希望它会帮助任何在输出长度方面遇到与我相同问题的人。

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2018-06-06T12:57:13.187

你也可以在**Swift 4中使用 NotificationCenter**

```
NotificationCenter.default.addObserver(self, selector: #selector(self.handleTextChange(recognizer:)), name: NSNotification.Name.UITextFieldTextDidChange, object: yourTextField)

    @objc func handleTextChange(recognizer: NSNotification) {
            //max length is 50 charater max
            let textField = recognizer.object as! UITextField

            if((textField.text?.count)! > 50) {
                let newString: String? = (textField.text as NSString?)?.substring(to: 50)
                textField.text = newString

            }         
        } 
```

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2019-03-19T21:40:46.207

Swift 4.2 和 UITextFieldDelegate 方法

这对我有用，并将文本字段限制为最大输入 8 个字符。希望 NSRange 最终将更改为 Range，但现在我很高兴使用 NSString，因为从 NSRange 创建 Range 涉及处理另一个可选项。

```
func textField(_ textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String) -> Bool {
    let text = textField.text ?? ""
    let nsString = text as NSString
    let newText = nsString.replacingCharacters(in: range, with: string)
    return newText.count <= 8
} 
```

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2014-03-21T14:36:40.140

上面给出的一些答案的问题是，例如我有一个文本字段，我必须设置输入 15 个字符的限制，然后在输入第 15 个字符后停止。但他们不允许删除。那就是删除按钮也不起作用。因为我面临同样的问题。提出了解决方案，如下所示。非常适合我

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string
{
 if(textField.tag==6)
 {
    if ([textField.text length]<=30)
    {
        return YES;   
    }
    else if([@"" isEqualToString:string])
    {
        textField.text=[textField.text substringToIndex:30 ];
    }

    return NO;
 }
 else
 {
    return YES;
 }
} 
```

我有一个文本字段，我已将其标签设置为“6”，并且我限制了 max char limit = 30 ；在任何情况下都可以正常工作

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2014-05-19T14:48:47.320

```
(BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string
{
    NSString *newString = [textField.text stringByReplacingCharactersInRange:range withString:string];

    if ([txt_name.text length]>100)
    {
        return NO;
    }

    return YES;
} 
```

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2014-05-20T10:51:06.763

我们可以像这样设置文本字段的范围..

```
-(BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range  replacementString:(NSString *)string
{
     int setrange = 20;
     return !([textField.text length]>setrange && [string length] > range.length);
} 
```

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2014-05-27T20:10:43.553

这限制了字符数，但也确保您可以在字段中粘贴直到最大限制。

```
- (void)textViewDidChange:(UITextView *)textView
{
    NSString* str = [textView text];
    str = [str substringToIndex:MIN(1000,[str length])];
    [textView setText:str];

    if([str length]==1000) {
        // show some label that you've reached the limit of 1000 characters
    }
} 
```

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2015-05-01T11:25:10.180

除了回答原始问题并扩展 Frouo 的答案之外，这里有一些扩展来修剪空格字符串和最大长度，并利用这些字符串扩展来修剪 UITextField 到最大长度：

```
// In String_Extensions.swift

extension String {

  func trimmedString() -> String {
    var trimmedString = self.stringByTrimmingCharactersInSet(NSCharacterSet.whitespaceAndNewlineCharacterSet())
    let components = trimmedString.componentsSeparatedByCharactersInSet(NSCharacterSet.whitespaceAndNewlineCharacterSet()).filter { count($0) > 0 }
    return " ".join(components)
  }

  func trimmedStringToMaxLength(maxLength: Int) -> String {
    return trimmedString().substringToIndex(advance(startIndex, min(count(self), maxLength))).trimmedString()
  }

}

// In UITextField_Extensions.swift

private var maxLengthDictionary = [UITextField : Int]()
private var textFieldMaxLength = 20

extension UITextField {

  @IBInspectable var maxLength: Int {
    get {
      if let maxLength = maxLengthDictionary[self] {
        return maxLength
      } else {
        return textFieldMaxLength
      }
    }
    set {
      maxLengthDictionary[self] = newValue < textFieldMaxLength + 1 ? newValue : textFieldMaxLength
    }
  }

  func trimAndLimitToMaxLength() {
    text = text.trimmedStringToMaxLength(maxLength)
  }

}

let someTextField = UITextField()
let someString = "   This   is   a   string   that   is longer than allowable for a text field.   "
someTextField.text = someString
someTextField.trimAndLimitToMaxLength()
println(someTextField.text) // Prints "This is a string tha"
let anotherTextField = UITextField()
anotherTextField.maxLength = 5
anotherTextField.text = someString
anotherTextField.trimAndLimitToMaxLength()
println(anotherTextField.text) // Prints "This" 
```

`trimAndLimitToMaxLength()`可以在 UITextFieldDelegate 中使用，`textFieldDidEndEditing(_:)`以便用户可以输入或粘贴比可接受的更长的字符串，然后将其缩短而不是仅以最大长度切断输入。在这样做时，我还将设置属性文本样式以指示超出可接受长度的文本的任何部分（例如，`[NSBackgroundColorAttributeName : UIColor.redColor(), NSForegroundColorAttributeName : UIColor.whiteColor(), NSStrikethroughStyleAttributeName : NSNumber(int: 1)]`

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2015-11-03T23:54:43.250

对于 Swift 2.1+

```
func textField(textField: UITextField, shouldChangeCharactersInRange range: NSRange, replacementString string: String) -> Bool {

    if (range.length + range.location > textField.text!.characters.count )
    {
        return false;
    }

    let newLength = textField.text!.characters.count + string.characters.count - range.length
    return newLength <= 25
} 
```

希望能帮助到你

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2017-04-07T17:18:41.920

我想补充@sickp 给出的答案。

`Swift`任何多字节文本（例如表情符号）都会在他的代码中出现问题。`NSRange`和`String`in`Swift`不兼容，因此委托类将它们结合起来令人沮丧。诀窍只是将`String`对象转换为`NSString`正确的解决方案，基于@sickp 写的，实际上是这样的：

```
func textField(_ textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String) -> Bool {

    let currentText = (textField.text as NSString?) ?? NSString()
    let currentCharacterCount = currentText.length
    if range.length + range.location > currentCharacterCount {
        return false
    }
    let newLength = currentText.replacingCharacters(in: range, with: string).characters.count
    return newLength <= 25
} 
```

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2017-06-28T12:26:59.643

**适用于 Swift 3.1 或更高版本**

首先添加协议`UITextFieldDelegate`

**像：-**

```
class PinCodeViewController: UIViewController, UITextFieldDelegate { 
.....
.....
.....

} 
```

之后创建你的 UITextField 并设置委托

**完成经验：-**

```
import UIKit

class PinCodeViewController: UIViewController, UITextFieldDelegate {

let pinCodetextField: UITextField = {
    let tf = UITextField()
    tf.placeholder = "please enter your pincode"
    tf.font = UIFont.systemFont(ofSize: 15)
    tf.borderStyle = UITextBorderStyle.roundedRect
    tf.autocorrectionType = UITextAutocorrectionType.no
    tf.keyboardType = UIKeyboardType.numberPad
    tf.clearButtonMode = UITextFieldViewMode.whileEditing;
    tf.contentVerticalAlignment = UIControlContentVerticalAlignment.center
 return tf
  }()

 override func viewDidLoad() {
   super.viewDidLoad()
   view.addSubview(pinCodetextField)
    //----- setup your textfield anchor or position where you want to show it----- 

    // after that 
pinCodetextField.delegate = self // setting the delegate

 }
func textField(_ textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String) -> Bool {
    return !(textField.text?.characters.count == 6 && string != "")
     } // this is return the maximum characters in textfield 
    } 
```

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2021-03-20T01:27:10.547

**在 Swift 5.2 中工作**：

```
 class AngListVC: UIViewController, UITextFieldDelegate {

    @IBOutlet weak var angTextField: UITextField!

    override func viewDidLoad() {
        super.viewDidLoad()
        angTextField.delegate = self
        angTextField.addTarget(self, action: #selector(textFieldDidChange(_:)), for: .editingChanged)

    }

   func textField(_ textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String) -> Bool {
           let userText =  angTextField.text ?? ""
           var newText = ""
           if range.length > 0 {
               let txt = NSString(string: userText)
               if txt.length > 0 {
                   newText = txt.replacingCharacters(in: range, with: "")
               }
           } else {
               newText = userText + ""
           }
           return newText.count <= 3
       }

@objc func textFieldDidChange(_ textField: UITextField) {
        print("textFieldDidChange")
   } 
```

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2021-08-26T08:37:47.553

**对于斯威夫特 5**

添加 UITextfield 的这个扩展，然后选择一个文本字段并检查属性检查器

```
private var __maxLengths = [UITextField: Int]()

extension UITextField {
    @IBInspectable var maxLength: Int {
        get {
            guard let l = __maxLengths[self] else {
               return 150 // (default int limit)
            }
            return l
        }
        set {
            __maxLengths[self] = newValue
            addTarget(self, action: #selector(setMaxLength), for: .editingChanged)
        }
    }

    @objc func setMaxLength(textField: UITextField) {
        let t = textField.text
        textField.text = t?.prefix(maxLength).description
    }
} 
```

[![在此处输入图像描述](https://i.stack.imgur.com/3BvEa.png)](https://i.stack.imgur.com/3BvEa.png)

* * *

## 回答 #44

> 赞同：-1
> 
> 时间：2015-04-29T07:02:03.593

```
-(BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {
    if (textField.text.length >= 50) {
        return NO;
    }
    return YES;
} 
```

* * *

## 回答 #45

> 赞同：-1
> 
> 时间：2019-06-17T08:46:07.160

**斯威夫特 4.2+**

通过**实现** `UITextFieldDelegate`方法

1.  视图控制器：

    ```
    class MyViewController: UIViewController {

        let MAX_LENGTH = 256

        @IBOutlet weak var myTextField: UITextField!

        override viewDidLoad() {
            self.myTextField.delegate = self
        }
    } 
    ```

2.  代表：

    ```
    extension MyViewController: UITextFieldDelegate {

        func textField(_ textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String) -> Bool {
            let userText =  textView.text ?? ""
            var newText = ""
            if range.length > 0 {
                let txt = NSString(string: userText)
                if txt.length > 0 {
                    newText = txt.replacingCharacters(in: range, with: text)
                }
            } else {
                newText = userText + text
            }
            return newText.count <= MAX_LENGTH
        }

    } 
    ```

* * *

## 回答 #46

> 赞同：-6
> 
> 时间：2010-03-19T20:54:28.447

我发现这又快又简单

```
- (IBAction)backgroundClick:(id)sender {
    if (mytext.length <= 7) {
        [mytext resignFirstResponder];
    } else {
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Too Big" 
                                                        message:@"Please Shorten Name"
                                                       delegate:nil 
                                              cancelButtonTitle:@"Cancel"
                                              otherButtonTitles:nil];
        [alert show];
        [alert release];
    }
} 
```

# asp.net - 存储常用值的最佳方式

> ID：433345
> 
> 赞同：3
> 
> 时间：2009-01-11T18:14:19.533
> 
> 标签：asp.net, optimization

在我的 Webforms 3.5 应用程序中，我有一个用户 GridView，显示他们上次登录的时间。这个值以 UTC 格式存储在用户表中。当管理员查看网格时，我希望他们查看管理员在其首选项中选择的时区（也存储在用户表中）。

我让 GridView 正常工作：

```
<ItemTemplate>
    <%# TimeZoneInfo.ConvertTimeFromUtc(Eval("LastLoginDateTimeUTC"), TimeZoneInfo.FindSystemTimeZoneById(UserService.GetUser(HttpContext.Current.User.Identity.Name).DisplayTimeZone))%>
</ItemTemplate> 
```

所以在这种情况下，每次创建一行时，都会创建一个用户对象。

我想做的是确定处理返回常用用户特定数据（例如 user.DisplayTimeZone）的最佳方法。我有几个想法，但我想了解其他人的做法。我正在考虑使用用户特定缓存，但在我有更多想法之前不想实施。

我想避免使用 Session 对象，但这不是必需的。我更喜欢使用 HttpRuntime.Cache。

另外，一旦确定了，代码应该去哪里？在 BasePage 类中？在母版页中？在 MVP BasePresenter 中？

谢谢~S

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-11T18:57:57.717

正如您提到的，我使用用户特定的缓存做了同样的事情。我实际上在一个单独的命名空间中实现了它，尽管它是静态获取属性。例如：

```
namespace MyWeb.Session
  public static class CurrentUser {
    public static int DisplayTimeZone {
      get {
        // Check cache first.
        ...

        // Cache miss, load from database and store in cache.
        ...
      }
    }
  }
} 
```

这样每次我需要我简单调用的值时`MyWeb.Session.CurrentUser.DisplayTimeZone`。

# html - 您认为模板代表了将表示逻辑与业务逻辑分离的最佳方式吗？

> ID：433351
> 
> 赞同：3
> 
> 时间：2009-01-11T18:15:44.883
> 
> 标签：html, business-logic, template-engine

我认为大多数模板引擎对于设计师和前端开发人员来说很难使用，而让程序员承担维护它们的负担。

在设计师更新 html 模型后频繁更新模板是一场噩梦，因为您的模板不再与原始 html 兼容。

[我有这个问题很长时间了](http://www.codeassembly.com/Templates-and-presentation-logic/)，最​​近我有了一个[想法](http://www.codeassembly.com/What-cascading-html-template-sheet-is/)，但我不知道我是不是在重新发明一些东西，或者是否存在更好的东西。

所以，我问你是否找到了解决这个问题的更好的解决方案，如果有，是哪一个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-11T19:31:41.487

自从我切换到内容与演示完全分离以来，我从未回头，原因如下：

*   你的业务逻辑变得非常清晰。如果没有混入 HTML 标记和表示逻辑，代码需要 ½ 的空​​间和不到 ½ 的时间来维护。维护代码和表示之间的链接的负担可以通过指定两者之间的正式接口来减轻，即使是作为文本文件或 Wiki 注释，列出表示层呈现/需要的所有变量和值。

*   频繁地根据设计人员的更改更新模板意味着您的表示层应该细分为各种“块”，例如菜单块、页面布局块和内容块。在大多数页面上，只有内容块不同。当使用 CSS 和其他现代 Web 技术正确划分和实现时，设计中的合理更改将对您的演示代码产生最小的影响。

*   CMS 进一步自动化了这个过程，现在从一致性和易于支持的角度来看，即使是 5-10 个页面的网站也可以从使用 CMS 与手动编码的 HTML 中受益。

*   代码安全 - Smarty 不是 PHP，因此您的设计人员对网站的信任度可能较低（他们不能过多地混淆基础，尽管他们可以将演示文稿破坏为与 DoS 相同的效果，所以无论如何不要惹他们）；如果您不太关心安全性，PHPTal 和其他人几乎以“本机”速度运行。

至于我的工作解决方案，我有两个建议：

*   制定项目范围的文件夹结构和命名约定，并坚持下去。给定您的业务逻辑文件的名称，我应该能够告诉您演示文件是什么，反之亦然。

*   在业务逻辑和表示之间有一个明确的接口规范（同样，一个文本文件或一个 Wiki 条目就是你真正需要的）。知道哪些变量可用，以及它们应该如何（程序员）/（设计师）格式化，让他们在一年后必须维护页面时都非常高兴。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T03:46:38.677

是的，但前提是它们尽可能接近原生 HTML。

Dreamweaver 模板（忽略编辑器）基本上很好地完成了这一点，因为它们基本上用一些 HTML 注释标记了一个普通的旧 HTML (POH™) 页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-11T19:08:03.607

我个人喜欢一些 CMS 解决方案如何使我能够将我的模板分成非常小的部分。SiteCore 通过映射到用户控件的占位符和渲染很好地做到了这一点。

过去我也大量使用 UserControls 来分解常见的功能，如登录、菜单、页脚链接等，以便将来更容易修改或替换功能。(ASP.NET)

你使用什么模板引擎？PHP 的 Smarty 之类的东西？

# c++ - 编辑由 OLE 视图为 C++ 组件创建的 IDL

> ID：433356
> 
> 赞同：0
> 
> 时间：2009-01-11T18:18:27.483
> 
> 标签：c++, idl

执行此操作时我需要考虑哪些事项：

*   **删除/操作/添加**什么

 **问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-11T20:34:20.033

[**在 IDL 中为客户端中立定义接口**](http://edndoc.esri.com/arcobjects/9.0/ExtendingArcObjects/Appendices/EditingIDL.htm#Defining_interfaces_in_IDL_for_client_neutrality)

**上面的链接**中描述了许多问题，请注意

# java - 如何在 Eclipse (for Java) 中获得更紧凑的自动缩进？

> ID：433358
> 
> 赞同：2
> 
> 时间：2009-01-11T18:22:04.900
> 
> 标签：java, eclipse

缩进的代码格式选项是什么：

```
Log.w(TAG, String.format(
    "Upgrading database from version %s to %s which will destroy all old data",
    oldVersion, newVersion)); 
```

而不是：

Log .w( TAG, String .format( "将数据库从版本 %s 升级到 %s 会破坏所有旧数据", oldVersion, newVersion));

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-15T21:32:52.567

我不认为你会在第一个块中得到你想要的，因为`Log.w(`并且`String.format(`可能受相同的格式规则约束。

但是，您可以转到 Window->Preferences->Java->Code Style->Formatter 并选择编辑。您要更改的设置位于换行选项卡上。如果将函数调用换行策略设置为不换行，则会得到以下结果。

```
Log.w(TAG, String.format("Upgrading database from version %s to %s which will destroy all old data", oldVersion, newVersion)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-11T18:33:57.983

我认为我没有触及我的缩进设置，他们肯定会像你想要的那样格式化它（只是试过了）。也许您可以重新安装 Eclipse 并比较设置？我正在使用 Eclipse 3.4，顺便说一句。

编辑：不，我收回了。当我尝试您的示例时，我遇到了很多错误，并且可能会使 Eclipse 感到困惑。现在调整示例，我得到与您的第二个（不需要的）示例相同的示例。很抱歉提出任何希望您可以修复它。=)

# notepad - 为记事本配备拼写检查（键入时）功能——最好的选择？

> ID：433361
> 
> 赞同：2
> 
> 时间：2009-01-11T18:25:16.750
> 
> 标签：notepad, spell-checking

我不需要任何具有一系列功能的替代文本编辑器。我只想在记事本中检查我的文本（在我键入时）以查找任何拼写错误。最好的选择是什么？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-11T18:34:13.067

我问谷歌，谷歌给了我一些链接。[http://www.pcworld.com/downloads/file/fid,68576-page,1-c,downloads/description.html](http://www.pcworld.com/downloads/file/fid,68576-page,1-c,downloads/description.html)看起来像你需要的。它是免费的，它很小，并且没有任何您不需要的额外功能。

# javascript - 在 HTML/Javascript 中自动将数字变成彩色条

> ID：433363
> 
> 赞同：4
> 
> 时间：2009-01-11T18:25:54.193
> 
> 标签：javascript, html, css

我想从一些自定义数据中自动生成一个 HTML 表格。我的数据中的一列是 0-100 范围内的数字，我想以更图形化的方式显示它，最好是彩色水平条。条的长度将代表值，颜色也会改变（即低于 20 为红色等）

像这样的东西（用paint.net创建）：

[![替代文字](https://i.stack.imgur.com/HoUoM.png)](https://i.stack.imgur.com/HoUoM.png)
[（来源：[thegreenplace.net](http://eli.thegreenplace.net/files/temp/df.png)）]

实现此目的的一种方法是生成适当的 .PNG 并将其作为图像放置在那里。但我认为它可能可以通过 HTML/CSS/Javascript 的一些混合物以自动方式完成（即投入表中的值是数字，JS 在显示之前将它们转换为条形）。

也许有人已经做过这样的事情并且可以分享？

提前致谢

PS：如果能在IE6上运行，那就最好了（别问了……）

PPS：它应该离线工作，所以现有的网络服务（如谷歌图表）将无济于事

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-11T18:43:31.503

AListApart 有一篇关于如何使用纯 CSS 生成图表的精彩文章。这很好，因为它是可访问的，这意味着即使没有 CSS，它也会提供有意义的数据。

[http://www.alistapart.com/articles/accessibledatavisualization](http://www.alistapart.com/articles/accessibledatavisualization)

**更新：**根据对此答案的评论者之一，此解决方案也适用于 IE6。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-11T18:40:14.240

这是可行的。

2个选项：

1) 使用 img 标签在每个单元格中放置一个图像，并使用 width 属性调整图像大小

2）放置一个具有预设高度的div，并根据您希望它显示的值更改宽度。使用 div 的背景颜色作为您的颜色 - 不需要图像。

例子：

```
<table style="border: 1px solid black">
<tr><th>name</th><th>value</th></tr>
<tr><td>hi</td><td><div style="height: 10px; width: 35px; background-color: #236611">35</div></td></tr>
<tr><td>yes</td><td><div style="height: 10px; width: 15px; background-color: #236611">15</div></td></tr>
<tr><td>see?</td><td><div style="height: 10px; width: 75px; background-color: #2366aa">75</div></td></tr>
</table> 
```

...您当然可以/应该调整尺寸以看起来更好:-)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-11T18:47:53.413

最好的方法是西蒙帖子的第二部分。将 div 放置在您需要的任何位置，并使用 javascript 或 PHP（取决于您是否希望它动态更改）使用百分比更改宽度。对颜色使用 if 语句。例如，在 javascript 中：

```
function displayGraph(barID, number)
{
    var color;
    if (number <= 20)
    {
        color = "red";
    }
    elseif (number > 20 && number <= 60)
    {
        color = "yellow";
    }
    else
    {
        color = "green";
    }

    var bar = document.getElementById(barID);
    bar.style.width = number + "%";
    bar.style.backgroundColor = color;
} 
```

我没有对此进行完全测试，但类似的东西应该可以工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-11T19:07:17.573

查看提供内联图表的[jQuery Sparkline](http://omnipotent.net/jquery.sparkline/)，类似于您正在寻找的内容。如果您使用[子弹图](http://en.wikipedia.org/wiki/Bullet_graph)，您可以显示与您的数据相关的好/正常/坏范围，从而在非常小的空间内提供大量数据。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-11T18:53:44.540

如果您希望它也可以离线工作，也许可以使用[flot 。](http://code.google.com/p/flot/)

它基于canvas和jquery。

我还没有使用它，但它在我的待办事项列表上。

示例代码看起来很简单：

```
$(function () {
    var d1 = [[0, 3], [4, 8], [8, 5], [9, 13]];
    $.plot($("#placeholder"), [ d1 ]);
}); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-10-27T14:21:28.287

由于您已经将数据保存在表格中，因此您可以查看[jQuery Visualize Plugin](http://www.filamentgroup.com/lab/jquery_visualize_plugin_accessible_charts_graphs_from_tables_html5_canvas/)。包含它后，您只需调用以下内容：

```
$('table').visualize(); 
```

它会根据您的表格构建图表。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-11T18:28:16.947

它不是 HTML，但你看过谷歌图表吗？这真的很神奇。 [http://code.google.com/apis/chart/](http://code.google.com/apis/chart/)

# matlab - 如何绘制（半）对数 3d 图？(Matlab)

> ID：433364
> 
> 赞同：6
> 
> 时间：2009-01-11T18:26:33.020
> 
> 标签：matlab, plot, mesh, surf

我知道用于 2D 绘图的 semilogx 和 semilogy。SURF 和 MESH 有什么等价物？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T20:31:30.173

如提到的链接中所述，要将所有三个轴设置为对数缩放，请使用

```
set(gca, 'XScale', 'log', 'YScale', 'log', 'ZScale', 'log') 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-11T20:45:27.310

你看过*XScale*，*YScale*和*Zscale*轴属性。您可以将它们设置为*linear*或*log*。但是，要设置这些属性以*记录*数据，则需要为正数。有关详细信息，请参阅[http://www.mathworks.com/matlabcentral/newsreader/view_thread/239232 。](http://www.mathworks.com/matlabcentral/newsreader/view_thread/239232)

# math - 椭圆包围矩形

> ID：433371
> 
> 赞同：20
> 
> 时间：2009-01-11T18:29:32.420
> 
> 标签：math

Maths101 问题 - 有谁知道如何计算将包围给定矩形的椭圆（宽度/高度）。显然没有单一的椭圆——我正在寻找一种可以给我各种宽度/高度组合的算法——或者可能是椭圆的最小区域？它是用于 GUI 的，所以我正在寻找一个美观的高度/宽度比率。

提前致谢。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-11T18:57:56.670

如果你给你的椭圆与矩形相同的纵横比，你可以在你想要的是一个包围一个正方形的圆的基础上工作，然后像你已经将正方形转换成所需的矩形一样拉伸。

对于半边长 = 1 的正方形，圆的半径为 sqrt(2)。

因此，从 0 到 360' 扫过*theta*，椭圆的坐标点将是：

*   x = cos(theta) * sqrt(2) * rect.width + x.center;
*   y = sin(theta) * sqrt(2) * rect.height + y.center;

其中 rect.width 和 rect.height 是相关边的*半*宽。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2011-07-16T09:30:00.473

1.  椭圆公式为 (x/A)^2+(y/B)^2=1，其中 A 和 B 是椭圆的半径
2.  矩形边是 Rw 和 Rh
3.  假设我们想要与矩形具有相同比例的椭圆；然后，如果我们在圆形（A=B，Rq=Rh）中成像正方形并挤压它，我们可以很好地保持椭圆 A/B 的比率与矩形边的比率 Rw/Rh 相同；

这导致我们遵循以下方程组：
(x/A)^2+(y/B)^2=1
A/B=Rw/Rh

让我们来解决它： A=B*(Rw/Rh)
(Rh/2B)^2+(Rh/2B)^2=1
Rh=sqrt(2)*B

最终解决方案：
A=Rw/sqrt(2)
B=Rh/sqrt(2)

例子：
[![椭圆](https://i.stack.imgur.com/txd1S.gif)](https://i.stack.imgur.com/txd1S.gif)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-11T19:05:30.493

以原点为中心的椭圆方程为

```
(x/A)^2 + (y/B)^2 = 1 
```

现在，如果您想用日食包围一个 MxN 矩形，您可以将其中心移动到坐标原点。右上角的坐标是`(M/2,N/2)`，在椭圆方程中替换你有一个公式，你可以用它来求解 B 给定 A（或 A 给定 B）。

如果你有一个 4x2 的矩形，右上角的坐标是 (2,1)，代替你有`(2/A)^2 + (1/B)^2 = 1`，然后如果`A=4`求解 B 给出`B=1/sqrt(1-(1/2)^2)`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-12T23:49:21.267

通过实验，我发现由一个比内部矩形大 sqrt(2) 的矩形定义的椭圆是有效的。所以将 sqrt(2) 传递给这个函数，你会得到适当的矩形：

RectangleF boundingEllipse = GetScaledRectangle(innerRect, Convert.ToSingle(Math.Sqrt(2d)));

private RectangleF GetScaledRectangle(RectangleF rect, float scale) { float width = rect.Width * scale; 浮动高度 = rect.Height * 比例；

```
float gap = width - rect.Width;
float left = rect.Left - (gap / 2f);

gap = height - rect.Height;
float top = rect.Top - (gap / 2f);

return new RectangleF(left, top, width, height); 
```

}

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-11T19:03:58.000

假设您的意思是外接（比“封闭”更精确），您可以[在此处阅读有关如何外接矩形的信息](http://en.wikipedia.org/wiki/Circumscribed_circle)。正如 Alnitak 所说，从那里，您可以将其拉伸为矩形。

# c# - 使用字典作为其他字典中的键

> ID：433372
> 
> 赞同：2
> 
> 时间：2009-01-11T18:30:17.927
> 
> 标签：c#, dictionary

我想在另一个`Dictionary`中使用。类似于 python 的东西。我试过这个，但它给了我错误。`TKey``Dictionary`

```
Dictionary<Dictionary<string, string>, int> dict = new Dictionary<Dictionary<string,    string>, int>();
Dictionary<string, string> dict2 = new Dictionary<string, string>();
dict2["abc"] = "def";
dict[dict["abc"] = 20; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-11T18:36:52.530

它给你什么错误？它是在抱怨您在第 4 行缺少括号吗？

第 4 行看起来应该是：

```
dict[dict["abc"]] = 20; 
```

但是，您可能是这个意思，因为“abc”不是 dict 的键：

```
dict[dict2["abc"]] = 20; 
```

但是`dict2["abc"]`是 a `string`，当 dict 的键应该是 a 时`Dictionary<string, string>`。

但是，让我们在这一点上重新审视你最初的目标，然后再走这条路。首先，您不应该将可变类型用作字典键。

这可能是您正在寻找的代码：

```
Dictionary<string, int> dict  = new Dictionary<string, int>();
Dictionary<string, string> dict2 = new Dictionary<string, string>();
dict2["abc"] = "def";
dict[dict2["abc"]] = 20; 
```

但很难确定。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-11T18:41:37.437

只是把它放在那里，我经常发现处理像你描述的复杂字典，使用真实姓名要好得多，而不是试图让代码的读者整理出来。

您可以根据个人喜好选择两种方式之一。使用 using 语句创建编译器别名。请注意，您必须使用完全限定的类型名称，因为这是编译器别名。

```
using ComplexKey = System.Collections.Generic.Dictionary<String, String>;
using ComplexType = System.Collections.Generic.Dictionary<
   System.Collections.Generic.Dictionary<String, String>,
   String
   >; 
```

或者您可以采用完整的类型方式并实际创建一个继承自 Dictionary 的类。

```
class ComplexKey : Dictionary<String, String> { ... }
class ComplexType : Dictionary<ComplexKey, String> { ... } 
```

这样做会让你和你的代码的读者更容易弄清楚你在做什么。我的一般经验法则是，如果我正在创建一个泛型的泛型，那么是时候考虑构建一些一等公民来代表我的逻辑了。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-11T18:34:00.633

这是因为 "dict["abc"] 不是字典，而是 "string"。

正确的，你问的是：

```
Dictionary<Dictionary<string, string>, int> dict = new Dictionary<Dictionary<string,    string>, int>();
Dictionary<string, string> dict2 = new Dictionary<string, string>();
dict2["abc"] = "def";
dict[dict2] = 20; 
```

但我不确定，这是你真正想要/需要的。

# saas - SaaS-公司结构

> ID：433378
> 
> 赞同：-1
> 
> 时间：2009-01-11T18:33:36.423
> 
> 标签：saas

您想要开发多个 Web 服务的最典型的业务结构是什么？应该为他们每个人建立一个公司还是保留一个公司？我想听听您在保持这种情况下的经验，同时牢记全球焦点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-18T21:19:55.637

By far the two most critical sets of issues determining the answer to this question are legal and financial (including, but not mainly, accounting). So it's hard to see how this question fits with the intent of this site.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-11T18:40:54.160

建议提供有关该主题的更多背景信息。SaaS 公司的业务计划范围可以从大型云计算服务供应商（具有集成解决方案）到针对特定市场利基的业务分析提供商。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-18T21:13:25.040

Business is a bit like programming: Keep It Simple (Stupid). Do not create multiple companies, unless there is a good reason to do it.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-02-27T10:36:58.210

如果你打算使用 python，你可以使用 Django 来构建 saas 应用程序，

此视频[在 Python django 中构建 SaaS 应用程序](https://youtu.be/jg4qs9Qs6Fs)将解释如何开始使用 Sass。

谢谢

# capistrano - Capistrano 远程身份验证问题

> ID：433379
> 
> 赞同：3
> 
> 时间：2009-01-11T18:33:39.510
> 
> 标签：capistrano

我正在尝试使用此 config/deploy/production.rb 文件部署到 slicehost 切片。我一无所知，之前没有使用过 capistrano。这是我遵循的步骤。抱歉，我对 capistrano 完全陌生。它不断询问我的密码（已设置无密码 SSH），并抛出此错误：

```
(SocketError: getaddrinfo: Name or service not known)
connection failed for: ---------.com (Net::SSH::AuthenticationFailed: -----) 
```

首先，它是一个“bort”应用程序[http://github.com/fudgestudios/bort/tree/master](http://github.com/fudgestudios/bort/tree/master)

其次，我使用了 ubuntu-machine gem，这里详细介绍：

[http://suitmymind.github.com/ubuntu-machine/#screencast](http://suitmymind.github.com/ubuntu-machine/#screencast)

**配置/部署/production.rb**

```
#############################################################
#   Application
#############################################################

set :application, "---------------"
set :deploy_to, "/var/www/#{application}"

#############################################################
#   Settings
#############################################################

default_run_options[:pty] = true
ssh_options[:forward_agent] = true
set :use_sudo, true
set :scm_verbose, true
set :rails_env, "production" 

#############################################################
#   Servers
#############################################################

set :user, "----------"
set :domain, "--------------------------"
server domain, :app, :web
role :db, domain, :primary => true

#############################################################
#   Git
#############################################################

set :scm, :git
set :branch, "master"
set :scm_user, '---------'
set :scm_passphrase, "----------"
set :repository, "git@github.com:--------/----------.git"
set :deploy_via, :remote_cache

#############################################################
#   Passenger
#############################################################

namespace :deploy do
  desc "Create the database yaml file"
  task :after_update_code do
    db_config = <<-EOF
    production:    
      adapter: mysql
      encoding: utf8
      username: root
      password: ------------
      database: ------------_production
      host: localhost
    EOF

    put db_config, "#{release_path}/config/database.yml"

    #########################################################
    # Uncomment the following to symlink an uploads directory.
    # Just change the paths to whatever you need.
    #########################################################

    desc "Symlink the assets directories"
     task :before_symlink do
       run "mkdir -p #{shared_path}/assets"
       run "ln -nfs #{shared_path}/assets #{release_path}/public/assets"
     end

  end

  # Restart passenger on deploy
  desc "Restarting mod_rails with restart.txt"
  task :restart, :roles => :app, :except => { :no_release => true } do
    run "touch #{current_path}/tmp/restart.txt"
  end

  [:start, :stop].each do |t|
    desc "#{t} task is a no-op with mod_rails"
    task t, :roles => :app do ; end
  end

end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-11T18:58:49.383

我认为问题要么是

*   它无法解析您的主机名
*   您输入错误的`domain`值

以防万一，您是否尝试将`domain`值设置为您的服务器的 IP 地址？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-11T18:35:58.023

**“SocketError: getaddrinfo: Name or service not known”**意味着解决或连接到远程主机的某种问题。您是否检查过是否可以手动连接？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-11T18:41:17.017

开始调试 cap 脚本的一种方法是自己执行该过程的每个步骤。您可以直接从详细上限输出中复制语句。这应该有助于隔离问题，在这种情况下，连接问题出在哪里（slicehost？，github？，两者？）。

# yahoo-pipes - 如何配置 Yahoo! 的更新间隔 管道？

> ID：433386
> 
> 赞同：4
> 
> 时间：2009-01-11T18:35:01.537
> 
> 标签：yahoo-pipes

我正在使用 Yahoo! 创建一些 RSS！管道，但更新间隔太长。我怎样才能改变它？如果不可能改变，究竟是多长时间？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-15T16:38:08.903

Pipes 文档说它[遵循标准的 HTTP 过期标头](http://pipes.yahoo.com/pipes/docs?doc=troubleshooting#q5)，因此它取决于您的来源的标头。

但是，也有一个最小间隔，[这篇文章](http://www.daybarr.com/blog/2008/02/12/yahoo-pipes-caching-and-robotstxt)声称它大约是 10 分钟。

# python - Python-Regex，这是怎么回事？

> ID：433388
> 
> 赞同：6
> 
> 时间：2009-01-11T18:36:21.423
> 
> 标签：python, regex

我最近有一本关于 python 的书，其中有一章是关于 Regex 的，其中有一段我无法真正理解的代码。有人可以准确解释这里发生了什么（本节是关于正则表达式组的）吗？

```
>>> my_regex = r'(?P<zip>Zip:\s*\d\d\d\d\d)\s*(State:\s*\w\w)'
>>> addrs = "Zip: 10010 State: NY"
>>> y = re.search(my_regex, addrs)
>>> y.groupdict('zip')
{'zip': 'Zip: 10010'}
>>> y.group(2)
'State: NY' 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-11T18:54:18.207

正则表达式定义：

```
(?P<zip>...) 
```

创建一个命名组“zip”

```
Zip:\s* 
```

匹配“Zip:”和零个或多个空白字符

```
\d 
```

匹配一个数字

```
\w 
```

匹配一个单词字符 [A-Za-z0-9_]

```
y.groupdict('zip') 
```

groupdict 方法返回一个字典，其中命名组作为键，它们的匹配作为值。在这种情况下，“zip”组的匹配被返回

```
y.group(2) 
```

返回第二组的匹配，这是一个未命名的组“（...）”

希望有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-11T18:52:39.317

**search**方法将返回一个包含正则表达式模式结果的对象。

**groupdict**返回组的字典，其中键是由 (?P...) 定义的组的名称。这里的*name*是组的名称。

**group**返回匹配的组列表。“州：纽约”是您的第三组。第一个是整个字符串，第二个是“Zip：10010”。

顺便说一句，这是一个相对简单的问题。我只是在谷歌上查找了方法文档并找到[了这个页面](http://pydoc.org/1.6/pre.html)。谷歌是你的朋友。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-11T18:57:17.297

```
# my_regex = r' <= this means that the string is a raw string, normally you'd need to use double backslashes
# ( ... ) this groups something
# ? this means that the previous bit was optional, why it's just after a group bracket I know not
# * this means "as many of as you can find"
# \s is whitespace
# \d is a digit, also works with [0-9]
# \w is an alphanumeric character
my_regex = r'(?P<zip>Zip:\s*\d\d\d\d\d)\s*(State:\s*\w\w)'
addrs = "Zip: 10010 State: NY"

# Runs the grep on the string
y = re.search(my_regex, addrs) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-11T18:55:32.073

`(?P<identifier>match)`语法是 Python 实现命名捕获组的方式。这样，您可以通过`match`使用名称而不是仅使用序列号来访问匹配的内容。

由于第一组括号名为`zip`，因此您可以使用 match 的`groupdict`方法访问其匹配项以获取一`{identifier: match}`对。或者，`y.group('zip')`如果您只对匹配感兴趣（这通常是有道理的，因为您已经知道标识符），您也可以使用。您还可以使用其序号 (1) 访问相同的匹配项。下一场比赛是未命名的，因此访问它的唯一方法是它的编号。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-11T19:00:33.123

添加到以前的答案：在我看来，您最好选择一种类型的组（命名或未命名）并坚持下去。通常我使用命名组。例如：

```
>>> my_regex = r'(?P<zip>Zip:\s*\d\d\d\d\d)\s*(?P<state>State:\s*\w\w)'
>>> addrs = "Zip: 10010 State: NY"
>>> y = re.search(my_regex, addrs)
>>> print y.groupdict()
{'state': 'State: NY', 'zip': 'Zip: 10010'} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T18:28:12.970

[strfriend](http://strfrield.com/)是*你的*朋友：

[http://strfriend.com/vis?re=(Zip%3A\s*\d\d\d\d\d)\s*(State%3A\s*\w\w)](http://strfriend.com/vis?re=(Zip%3A%5Cs*%5Cd%5Cd%5Cd%5Cd%5Cd)%5Cs*(State%3A%5Cs*%5Cw%5Cw))

**编辑：**为什么要让整行成为实际评论中的链接，而不是预览？

# android - 如何在 Android 的 SQlite 中使用准备好的语句？

> ID：433392
> 
> 赞同：106
> 
> 时间：2009-01-11T18:38:27.583
> 
> 标签：android, sqlite, prepared-statement

如何在 Android 的 SQlite 中使用准备好的语句？

* * *

## 回答 #1

> 赞同：180
> 
> 时间：2015-04-22T12:13:21.097

对于 Android 中准备好的 SQLite 语句，有[SQLiteStatement](http://developer.android.com/reference/android/database/sqlite/SQLiteStatement.html)。准备好的语句可以帮助您提高性能（尤其是对于需要多次执行的语句），还可以帮助避免注入攻击。有关准备好的语句的一般性讨论，请参阅[本文](http://en.wikipedia.org/wiki/Prepared_statement)。

`SQLiteStatement`旨在与不返回多个值的 SQL 语句一起使用。（这意味着您不会将它们用于大多数查询。）以下是一些示例：

# [创建表](http://www.tutorialspoint.com/sqlite/sqlite_create_table.htm)

```
String sql = "CREATE TABLE table_name (column_1 INTEGER PRIMARY KEY, column_2 TEXT)";
SQLiteStatement stmt = db.compileStatement(sql);
stmt.execute(); 
```

该[`execute()`](http://developer.android.com/reference/android/database/sqlite/SQLiteStatement.html#execute%28%29)方法不返回值，因此适合与 CREATE 和 DROP 一起使用，但不适合与 SELECT、INSERT、DELETE 和 UPDATE 一起使用，因为这些返回值。（但请参阅[这个问题](https://stackoverflow.com/questions/13365558/sqlitestatement-execute-a-select-insert-delete-update)。）

# [插入值](http://www.tutorialspoint.com/sqlite/sqlite_insert_query.htm)

```
String sql = "INSERT INTO table_name (column_1, column_2) VALUES (57, 'hello')";
SQLiteStatement statement = db.compileStatement(sql);
long rowId = statement.executeInsert(); 
```

请注意，使用的[`executeInsert()`](http://developer.android.com/reference/android/database/sqlite/SQLiteStatement.html#executeInsert%28%29)是方法而不是`execute()`. 当然，您不希望总是在每一行中输入相同的内容。为此，您可以使用[bindings](http://developer.android.com/reference/android/database/sqlite/SQLiteProgram.html)。

```
String sql = "INSERT INTO table_name (column_1, column_2) VALUES (?, ?)";
SQLiteStatement statement = db.compileStatement(sql);

int intValue = 57;
String stringValue = "hello";

statement.bindLong(1, intValue); // 1-based: matches first '?' in sql string
statement.bindString(2, stringValue);  // matches second '?' in sql string

long rowId = statement.executeInsert(); 
```

通常，当您想多次快速重复某事（如 INSERT）时，您会使用准备好的语句。准备好的语句使得 SQL 语句不必每次都被解析和编译。[您可以通过使用transactions](https://www.sqlite.org/transactional.html)来加快速度。这允许一次应用所有更改。这是一个例子：

```
String stringValue = "hello";
try {

    db.beginTransaction();
    String sql = "INSERT INTO table_name (column_1, column_2) VALUES (?, ?)";
    SQLiteStatement statement = db.compileStatement(sql);

    for (int i = 0; i < 1000; i++) {
        statement.clearBindings();
        statement.bindLong(1, i);
        statement.bindString(2, stringValue + i);
        statement.executeInsert();
    }

    db.setTransactionSuccessful(); // This commits the transaction if there were no exceptions

} catch (Exception e) {
    Log.w("Exception:", e);
} finally {
    db.endTransaction();
} 
```

查看这些链接以获取有关事务和加速数据库插入的更多信息。

*   [SQLite 中的原子提交](http://www.sqlite.org/atomiccommit.html)（非常深入的解释，转到第 3 部分）
*   [数据库事务](http://www.helloandroid.com/tutorials/database-transactions)
*   [Android SQLite 批量插入和更新示例](http://www.mysamplecode.com/2011/10/android-sqlite-bulk-insert-update.html)
*   [带有 INSERT Prepared Statement 的 Android SQLite 事务示例](https://www.codeofaninja.com/2013/12/android-sqlite-transaction-tutorial.html)
*   [在 Android 上加速你的 SQLite 插入](http://www.techrepublic.com/blog/software-engineer/turbocharge-your-sqlite-inserts-on-android/)
*   [https://stackoverflow.com/a/8163179/3681880](https://stackoverflow.com/a/8163179/3681880)

# [更新行](http://www.tutorialspoint.com/sqlite/sqlite_update_query.htm)

这是一个基本的例子。您还可以应用上一节中的概念。

```
String sql = "UPDATE table_name SET column_2=? WHERE column_1=?";
SQLiteStatement statement = db.compileStatement(sql);

int id = 7;
String stringValue = "hi there";

statement.bindString(1, stringValue);
statement.bindLong(2, id);

int numberOfRowsAffected = statement.executeUpdateDelete(); 
```

# [删除行](https://www.tutorialspoint.com/sqlite/sqlite_delete_query.htm)

该`executeUpdateDelete()`方法也可用于 DELETE 语句，并在 API 11 中引入。[请参阅此 Q&A](https://stackoverflow.com/questions/13365558/sqlitestatement-execute-a-select-insert-delete-update)。

这是一个例子。

```
try {

    db.beginTransaction();
    String sql = "DELETE FROM " + table_name +
            " WHERE " + column_1 + " = ?";
    SQLiteStatement statement = db.compileStatement(sql);

    for (Long id : words) {
        statement.clearBindings();
        statement.bindLong(1, id);
        statement.executeUpdateDelete();
    }

    db.setTransactionSuccessful();

} catch (SQLException e) {
    Log.w("Exception:", e);
} finally {
    db.endTransaction();
} 
```

# [询问](http://www.tutorialspoint.com/sqlite/sqlite_select_query.htm)

通常，当您运行查询时，您希望返回包含大量行的游标。不过，这不是`SQLiteStatement`目的。除非您只需要一个简单的结果，例如数据库中的行数，否则您不会使用它运行查询，您可以使用[`simpleQueryForLong()`](http://developer.android.com/reference/android/database/sqlite/SQLiteStatement.html#simpleQueryForLong%28%29)

```
String sql = "SELECT COUNT(*) FROM table_name";
SQLiteStatement statement = db.compileStatement(sql);
long result = statement.simpleQueryForLong(); 
```

通常你会运行[SQLiteDatabase](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html)`query()`的方法来获取游标。

```
SQLiteDatabase db = dbHelper.getReadableDatabase();
String table = "table_name";
String[] columnsToReturn = { "column_1", "column_2" };
String selection = "column_1 =?";
String[] selectionArgs = { someValue }; // matched to "?" in selection
Cursor dbCursor = db.query(table, columnsToReturn, selection, selectionArgs, null, null, null); 
```

有关查询的更多详细信息，请参阅[此答案](https://stackoverflow.com/a/9857412/3681880)。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-01-12T17:12:21.640

我一直在 Android 中使用准备好的语句，这很简单：

```
SQLiteDatabase db = dbHelper.getWritableDatabase();
SQLiteStatement stmt = db.compileStatement("INSERT INTO Country (code) VALUES (?)");
stmt.bindString(1, "US");
stmt.executeInsert(); 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2010-09-03T14:55:40.830

如果您想要返回光标，那么您可能会考虑这样的事情：

```
SQLiteDatabase db = dbHelper.getWritableDatabase();

public Cursor fetchByCountryCode(String strCountryCode)
{
    /**
     * SELECT * FROM Country
     *      WHERE code = US
     */
    return cursor = db.query(true, 
        "Country",                        /**< Table name. */
        null,                             /**< All the fields that you want the 
                                                cursor to contain; null means all.*/
        "code=?",                         /**< WHERE statement without the WHERE clause. */
        new String[] { strCountryCode },    /**< Selection arguments. */
        null, null, null, null);
}

/** Fill a cursor with the results. */
Cursor c = fetchByCountryCode("US");

/** Retrieve data from the fields. */
String strCountryCode = c.getString(cursor.getColumnIndex("code"));

/** Assuming that you have a field/column with the name "country_name" */
String strCountryName = c.getString(cursor.getColumnIndex("country_name")); 
```

如果您想要更完整的片段，请参阅此片段[Genscripts 。](http://genscripts.net/snippets/view/entry/41)请注意，这是一个参数化的 SQL 查询，因此本质上它是一个准备好的语句。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2010-06-06T09:15:24.650

jasonhudgins 示例不起作用。您无法执行查询`stmt.execute()`并返回值（或 a `Cursor`）。

您只能预编译根本不返回行（例如插入或创建表语句）或单个行和列（并使用`simpleQueryForLong()`or `simpleQueryForString()`）的语句。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-10-14T18:58:00.150

要获取游标，您不能使用已编译的语句。但是，如果您想使用完整的准备好的 SQL 语句，我建议改编 jbaez 的方法...使用**`db.rawQuery()`**而不是**`db.query()`**.

# http - HTTP 规范中的“子范围”是什么意思？

> ID：433393
> 
> 赞同：3
> 
> 时间：2009-01-11T18:40:01.980
> 
> 标签：http, caching, etag

例如，参见[§13.3.3](http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html#sec13.3.3)和[§13.3.4](http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html#sec13.3.4)。

在我看来，这与“媒体范围”（例如[§14.1](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.1)`Accept: text/*`）或“语言范围”（例如[§14.4](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.4)`Accept-Language: da, en-gb;q=0.8, en;q=0.7`）无关。

也许是“接受范围”（[§14.5](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.5)），它对响应施加了字节限制？如果这是真的，那么`ETag`s 有什么关系？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-11T18:49:12.087

我很确定它用于范围检索请求，即请求文档的一部分（例如，恢复文件下载）。

> 14.35.2 范围检索请求
> 
> 使用条件或无条件 GET
> 方法的 HTTP 检索请求可以使用 Range 请求标头请求实体的一个或多个子范围，而不是
> 整个实体，该标头适用于
> 作为请求结果返回的实体：

如果`ETag`是弱的（以 开头`W/`），那么它不能用于范围检索 - 只能使用强验证器，否则客户端可能会得到一个不一致的文件。

# java - 如何从 JVM 获取堆和 permgen 的最大大小？

> ID：433406
> 
> 赞同：7
> 
> 时间：2009-01-11T18:44:16.293
> 
> 标签：java, memory-management, jvm

我试图以编程方式找出调用我的程序的 JVM 的最大 permgen 和最大堆大小，而不是他们当前可用的。

有没有办法做到这一点？

我熟悉 Java Runtime 对象中的方法，但不清楚它们真正提供了什么。

或者，有没有办法询问 Eclipse 为这两个分配了多少？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-12T00:11:15.977

为 max perm gen 尝试这样的操作：

```
public static long getPermGenMax() {
    for (MemoryPoolMXBean mx : ManagementFactory.getMemoryPoolMXBeans()) {
        if ("Perm Gen".equals(mx.getName())) {
            return mx.getUsage().getMax();
        }
    }
    throw new RuntimeException("Perm gen not found");
} 
```

对于最大堆，您可以从运行时获取它，但您也可以使用适当的 MemoryPoolMXBean。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-11T19:23:35.247

试试这个：

```
MemoryMXBean mem = ManagementFactory.getMemoryMXBean();
mem.getHeapMemoryUsage().getUsed();
mem.getNonHeapMemoryUsage().getUsed(); 
```

但他们只提供快照数据，而不是累积值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-11T19:26:02.213

至于eclipse，试着找个分析工具。我认为 NetBeans 默认有一个。

# javascript - Javascript：是否可以在事件处理程序之外获取鼠标位置？

> ID：433409
> 
> 赞同：4
> 
> 时间：2009-01-11T18:46:28.363
> 
> 标签：javascript, events, mouse

我想在超时回调中保持鼠标位置。

据我所知，这不能直接完成。一种解决方法可能是在 document.body 上设置 onmousemove 事件并保存此位置，稍后再获取。然而，这将是相当昂贵的，并且不是最干净的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-11T19:09:26.833

我认为你必须和@Oli 做同样的事情，但是如果你使用 jQuery，它会容易得多。

[http://docs.jquery.com/Tutorials:Mouse_Position](http://docs.jquery.com/Tutorials:Mouse_Position)

```
<script type="text/javascript">
jQuery(document).ready(function(){
  $().mousemove(function(e){
    $('#status').html(e.pageX +', '+ e.pageY);
  }); 
})
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-11T18:56:50.777

直接的答案是**否定**的，但正如您正确地说的那样，您可以将事件附加到所有内容并进行相应的轮询。*对每个 onmousemove 实例进行认真的编程会*很昂贵，因此您可能会发现在页面周围创建多个区域并轮询 onmouseover 事件会更好。

另一种选择是（我不确定这是否有效）将重复超时设置为：

1.  将 onmousemove 处理程序添加到正文
2.  移动整个页面（例如更改正文的页边距顶部）
3.  当 onmousemove 处理程序触发时，获取位置并删除处理程序。您可能也需要对此事件进行超时（当鼠标离开视口时）

Uberhack，但它*可能会*起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-11T20:05:37.533

正如您所描述的，最直接的方法是在主体上设置 onmousemove 事件处理程序。它比您想象的要便宜：存储坐标的计算很少，并且当鼠标移动时，事件每秒触发 50 到 100 次。而且我怀疑一个典型的用户在查看网页时不会经常移动鼠标。

以下脚本有助于计算事件处理程序；在我的机器上，在 Firefox 中移动鼠标，这使我的 CPU 使用率增加了 5% 到 10%。

```
<script type="text/javascript">
jQuery(document).ready(function(){
    var count = 0;
    $().mousemove(function(e){ count += 1; }); 
    $().click(function(e){ $('#status').html(count); });
}); 
</script> 
```

# asp.net - 使用虚拟化进行 Web 开发的优势

> ID：433424
> 
> 赞同：1
> 
> 时间：2009-01-11T18:57:32.210
> 
> 标签：asp.net, windows, virtualization, hyper-v

这是我经常看到但从未真正想到的事情之一。你认为是出于 Web 应用程序开发的目的（特别是 ASP.NET WebForms/MVC）。你认为做这样的事情有好处吗？如果有，会产生什么样的好处？

通过虚拟化，我的意思是使用 Hyper-V 之类的产品来分离 SQL 和 Web 服务器等服务器上下文。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-11T19:06:32.813

我看到的一大优势是，每个开发人员都可以拥有自己的沙箱来工作。如果有人弄乱了他/她的沙箱，他/她可以拍一张干净的图像，一切都好起来了。所以我想这意味着有空间进行试验而不会浪费宝贵的时间回到正常设置，你可以简单地回滚。

我有点怀疑您是否应该在生产环境中使用虚拟化。当然取决于应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-11T19:12:02.210

第一个问题是，*什么*是虚拟化？你是说服务器虚拟化吗？您的意思是在每个开发人员的具有多个操作系统的笔记本电脑上运行 VMWare 吗？你的意思是把所有东西都移到云端吗？

在 Web 应用程序上下文中，服务器的虚拟化与一般 IT 中的虚拟化并没有真正的不同——互联网上的大多数服务器，包括 StackOverload 的，都是为了处理峰值负载而购买的，并且大部分时间都在闲置周期，因此对它们进行虚拟化当您拥有超过一定数量时才有意义。

桌面上的 VMWare（或其他操作系统上的其他并行）非常棒，因为 a）您的开发人员可以运行服务器环境的完整实例，包括连接在虚拟网络中的多个虚拟服务器 - 这与真实情况差不多你可以得到，减去硬件成本，减去开发人员与彼此服务器的关系。对于客户端，您可以使用 Linux 和多个 Windows 安装来快速测试各种浏览器、字体大小等 - 这也是一个巨大的胜利。

在许多情况下，将所有内容迁移到云端是有意义的，但可能是一个[单独的完整问题](https://stackoverflow.com/questions/24885/do-you-use-amazons-cloud-services-for-your-company)的主题:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-11T19:10:03.260

我唯一一次使用虚拟机进行 ASP.Net 开发是应用程序需要特定设置，例如依赖已安装的软件、奇怪的设置或特定共享。每个开发人员都有自己的网络服务器，并且可以运行自己的数据库，所以如果它是一个“基本的”网络应用程序，我认为虚拟应用程序没有多大价值.. 使用基本的网络应用程序部署很难打破任何东西 :)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-11T19:14:01.507

在开发环境中，虚拟环境有助于将多个不同的服务器放在一个盒子上，您可以为您的 Web 应用程序创建一个实例，为您的服务创建一个实例，为您的服务创建一个实例，为数据库创建一个实例，等等。单独的服务器。

在生产中使用虚拟化的好处之一是您的应用程序不依赖于特定的机器。如果您想将您的 Web 服务器实例移动到另一个盒子，那么这样做是微不足道的。您不需要在新服务器上安装或配置任何东西，并希望一切都正确设置。

我在测试虚拟实例时遇到的一个问题是，它对于某些应用程序的运行速度可能会变慢，特别是那些喜欢以 100% 运行 CPU 的工程应用程序。所以在你跳跃之前进行测试。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-11T19:16:38.987

使用虚拟服务器，您可以在类似生产的环境中测试您的代码。也可以快速恢复到原始设置。对于许多应用程序，它在您编写代码之后但投入生产之前的这段时间很有用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-11T20:07:52.503

我是 virtualizaion 的粉丝，并在测试和生产（VMWare 和 Hyper-v）中使用它，但在过去的一年里，我发现它**在开发机器上不太重要**。TFS 为我提供了我需要的所有备份/回滚功能，多个版本的 .net 现在可以存在于同一台机器上，并且 VS2008 可以针对所有这些版本。

# c# - Silverlight：如何从内存中卸载（处置）图像？

> ID：433434
> 
> 赞同：6
> 
> 时间：2009-01-11T19:02:01.140
> 
> 标签：c#, .net, silverlight

我有一个显示大型 jpg 文件并占用大约 50mb 内存的图像控件。当不再需要此控件时，如何处理它？我尝试将其从父容器中删除，将其设置为 null 并将其 Source 属性更改为 null，但内存使用量仍然保持不变......任何建议将不胜感激！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-11T22:57:39.587

我终于找到了我的问题的答案。问题在于 Silverlight 中的内存泄漏错误。我在这里找到了解决此问题的方法：http: [//blogs.msdn.com/silverlight_sdk/pages/silverlight-bugs-and-workarounds.aspx](http://blogs.msdn.com/silverlight_sdk/pages/silverlight-bugs-and-workarounds.aspx)

> 动态添加和删除图像时的内存泄漏
> 
> 解决方法：从应用程序中动态添加或删除 BitmapImages（也就是从树中添加/删除）时，您应该在从树中删除 Image 元素之前设置 Image.Source = null。这将使 BitmapImage 有资格进行垃圾收集。错误状态：活动错误。*

谢谢大家的建议！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-11T19:18:27.160

I think this is an edge case problem with Silverlight due to the reliance on garbage collection. Unfortunately if you are instantiating a lot of objects (and I do mean a lot) then you will get performance degredation (even if you free everything up properly and/or Dispose() of everything) because the GC just doesn't keep up and we don't have the resources to throw around like we do in a "normal" application.

Are you getting an issue, or just memory watching?

# mysql - 语句中没有重复的 Sql 计数

> ID：433437
> 
> 赞同：1
> 
> 时间：2009-01-11T19:05:25.907
> 
> 标签：mysql

我有一个选择一堆数据的 sql 查询。我还想获取查询选择的记录数（在我限制之前）。我看到的所有计数语句示例都重复了选择。我的选择语句长约 50 行，我宁愿不复制它。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-11T19:23:26.477

Your question would be easier to answer if you could give us an example SQL statement, however, from what you have said so far, the following should be correct:

```
Select Columns, Count(Distinct Value) From Table Where x=y Group By Columns 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-11T19:15:32.127

Yes. [http://dev.mysql.com/doc/refman/5.0/en/information-functions.html#function_found-rows](http://dev.mysql.com/doc/refman/5.0/en/information-functions.html#function_found-rows)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-11T19:59:56.483

在不运行查询或其版本的情况下，实际上不可能获得查询将返回的行数。

有 sql_calc_found_rows 可以让您在语句上放置一个限制子句，并返回如果在随后的对 found_rows() 的调用中没有限制子句，它会找到的总行数，但它很昂贵。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-11T20:06:38.077

谢谢大家，我只是在尝试 sql_calc_found_rows，你的大坝是尼克，它很贵。我想我只是创建一个单独的查询，谢谢

# iphone - OpenGL ES 中带有 8 位 Alpha 通道的调色板纹理

> ID：433440
> 
> 赞同：1
> 
> 时间：2009-01-11T19:07:16.543
> 
> 标签：iphone, opengl-es, texturing

我可以在 OpenGL ES 中获得带有 RGB 调色板和 8 位 alpha 通道的调色板纹理吗？（我的目标是 iPhone OpenGL ES 实现。）在查看 OpenGL 文档后，在我看来，调色板中支持带有 alpha 的调色板纹理，即。纹理包含 8 位索引到具有 256 种 RGBA 颜色的调色板中。我想要一个包含 8 位索引到 RGB 调色板*和*独立的 8 位 alpha 通道的纹理。（我试图节省内存，32 位 RGBA 纹理是相当奢侈的。）或者这应该是手工完成的，即。通过创建两个独立的纹理，一个用于颜色，一个用于 alpha 贴图，然后手动组合它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T06:50:18.870

不。一般来说，图形芯片真的不喜欢托盘化纹理（为什么？因为从它读取任何纹素需要两次内存读取，一个索引和另一个到调色板。正常读取的延迟加倍）。

如果您只是在节省内存之后，请查看压缩纹理格式。特别是在 iPhone 中，它支持 2 位/像素和 4 位/像素的 PVRTC 压缩格式。压缩是有损的（就像调色板压缩通常是有损的一样），但内存和带宽节省是可观的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-21T22:55:42.733

调色板纹理将在 iPhone 中的 GPU 加载时扩展，因此除了存储大小之外，您不会通过使用它们获得任何优势。卡通风格游戏的最佳选择是探索使用 PVRTC 压缩纹理（如 NeARAZ 所说）和 16 位纹理（RGBA4444 用于 alpha，RGBA5551 用于穿透，RGB565 用于不透明纹理）。将两者混合使用是我自己的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-11T23:02:19.813

**免责声明：** 此信息基于官方 OpenGL|ES 规范。我不知道 iphone 上的 OpenGL|ES 实现是否支持压缩纹理。从理论上讲，它至少应该模拟压缩纹理，但现在你永远不会。

`glCompressedTexImage2D`您可以通过调用加载 8 位/像素纹理。您最想使用的压缩类型是`GL_PALETTE8_RGBA8_OES`.

与调色板一起存储额外的 alpha 通道是不可能的。要么将第二个纹理单元用于 alpha 分量，要么将颜色量化期间的 alpha 考虑在内，并使用包含 alpha 的调色板格式。

网上某处有一个名为 BRIGHT 的命令行颜色量化工具。它在用 alpha 量化图像方面做得非常出色。你可能想试一试..

# oop - 流畅的接口和有漏洞的抽象

> ID：433450
> 
> 赞同：13
> 
> 时间：2009-01-11T19:11:49.123
> 
> 标签：oop, fluent-interface, leaky-abstraction

什么是流畅的界面？我找不到一个好的定义，但我得到的只是我不太熟悉的语言（例如 C++）的长代码示例。

另外，什么是泄漏抽象？

谢谢

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-11T19:57:49.187

流利的界面是一种 API，它允许您编写读起来或多或少像普通英语的代码。例如：

```
Find.All.Questions(Where.IsAnswered == true); 
```

方法链通常用作实现的一部分，但不止于此。引用[福勒的](http://martinfowler.com/bliki/FluentInterface.html)话：

> 我还注意到一个常见的误解——许多人似乎将流畅的接口等同于方法链。当然，链接是与流畅接口一起使用的常用技术，但真正的流畅性远不止于此。

它也经常被称为内部[DSL](http://www.martinfowler.com/bliki/DomainSpecificLanguage.html)，因为它的语法类似于 DSL，但它是在宿主语言内部实现的，而不是由解析器处理。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-01-11T20:22:28.373

泄漏抽象是底层现实的细节经常“泄漏”的抽象。

[所有](http://c2.com/cgi/wiki?AllAbstractionsLie)的抽象都或多或少地存在，但有时抽象与潜在的现实是如此不匹配，以至于它造成的伤害大于它的帮助。

抽象中“泄漏”的一个简单示例可能是通常的浮点类型。它似乎代表一般实数，您可以使用它来执行基本计算。但是有时您会遇到 1/3*3 != 1 或 1 + 10^-20 = 1 的情况。这就是实际实现细节泄漏并且抽象中断的情况。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-11T19:24:01.127

A fluent interface a term Eric Evans coined and it's just another name for method chaining. Martin Fowler wrote a [couple](http://martinfowler.com/dslwip/InternalOverview.html) of [articles](http://www.martinfowler.com/bliki/FluentInterface.html) on this subject, but it roughly looks like this:

```
m_Window = window::with()
    .width(l_Width)
    .height(l_Height)
    .title("default window")
    .left(200)
    .top(200)
.create(); 
```

Fluent interface are generally used to create named parameters in a language that doesn't support them (the Named Parameter Idiom in C++ for example), or in Domain Specific Languages to make the code read more fluently.

I've seen them being used for everything from image processing libraries, to regular expression libraries, 3D libraries. Other examples include the construction of tree structures, lists, or other datastructures. Everything that requires the construction of complex objects (load of parameters) can make use of Fluent Interfaces to make it more readable. For example, compare the previous example to the CreateWindow function call:

```
 ::CreateWindow(
      "Window class", 
      "Window title", 
      dwStyle, X, Y, 
      nWidth, nHeight, 
      hWndPant, hMenu, 
      hInstance, NULL
 ); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-11T19:27:24.037

Here's a regular every-day interface:

```
public interface NotFluent
{
  void DoA();
  void DoB();
  void DoC();
} 
```

And here's a fluent interface:

```
public interface Fluent
{
  Fluent DoA();
  Fluent DoB();
  Fluent DoC();
} 
```

The most obvious difference is that when we return a void, we return instead an instance of the interface type. What's understood is that the interface returned is the CURRENT INSTANCE, not a new instance of the same type. Of course, this isn't enforceable, and in the case of immutable objects (like string) it is a different instance but can be considered to be the same instance only updated.

Here are examples of their use:

```
NotFluent foo = new NotFluentImpl();
foo.DoA();
foo.DoB();
foo.DoC();

Fluent bar = new FluentImpl();
bar.DoA().DoB().DoC(); 
```

Notice that the fluent interface is easier to use when chaining different calls. IRL, check out the Linq extension methods and how each call is designed to flow into another. None of the methods return void, even if it would be a valid result.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-11T20:14:07.420

如果**为副作用而执行的方法返回**，则面向对象的接口是*流畅*的，因此可以将这些方法链接在一起。**`self`**

我第一次遇到流畅的接口是在 1990 年，当时 Modula-3 接口警察（我没有编造这个）要求所有初始化方法返回已初始化的对象。我相信这种用法早于“流畅界面”一词的诞生。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-11T21:41:26.823

多谢你们。

很棒的描述。

我对流畅接口的想法是为了可读性。我总是可以阅读一系列方法以及其中一个方法与上一个/下一个方法的关系。

例如，就像发布验证示例的发帖人（我已经编写了与之前类似的代码）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-11T19:28:53.597

In a fluent interface, a object's methods will return a reference to the object, so that you can chain the method calls together.

For example, in NValidate, I did this to simplify parameter validation:

```
public City GetCity(string zipCode)
{
   zipCode.Assert("zipCode").IsNotNullOrEmpty().HasLength(5,10).Matches("\\d[5]-\\d[4]");
   // Continue processing
} 
```

I can't speak to leaky abstractions, though.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-07-07T01:57:58.237

[Neal Ford](https://rads.stackoverflow.com/amzn/click/com/0596519788)在他的“Productive Programmer”一书中很好地解释并给出了 Fluent Interface 示例。

带有 getter/setter 的传统对象或“bean”：

```
Car car = new CarImpl();
MarketingDescription des = new MarketingDescriptionImpl();
desc.setType("Box");
desc.setSubtype("Insulated");
desc.setAttribute("length", "50.5");
desc.setAttribute("ladder", "yes");
desc.setAttribute("lining type", "cork");
car.setDescription(desc); 
```

使用流畅的界面满足相同的需求：

```
Car car = Car.describedAs()
  .box()
  .length(50.5)
  .type(Type.INSULATED)
  .includes(Equipment.LADDER)
  .lining(Lining.CORK); 
```

# c - 转换为多线程套接字应用程序

> ID：433461
> 
> 赞同：1
> 
> 时间：2009-01-11T19:15:43.263
> 
> 标签：c, multithreading, posix, unix

因为我目前只用 C 语言做[这个项目](https://stackoverflow.com/questions/409087/creating-a-web-server-in-pure-c)，所以到目前为止我只将我的网络服务器用作单线程应用程序。不过，我不想再这样了！所以我有以下代码来处理我的工作。

```
void BeginListen()
{
        CreateSocket();

        BindSocket();

        ListenOnSocket();

        while ( 1 )
        {
            ProcessConnections();
        }
} 
```

现在我`fork();`在开始之前添加了`ProcessConnection();`这有助于我允许多个连接！[但是，当我添加用于守护此答案](https://stackoverflow.com/questions/411777/getting-the-program-process-service-and-daemon-on-linux-in-c)中找到的应用程序的代码时。我遇到了一个小问题，使用`fork()`将创建我整个正在运行的应用程序的副本，这就是`fork()`. 所以，我想解决这个问题。

我的`ProcessConnection()`长相是这样的

```
void ProcessConnections()
{
        fork();

        addr_size = sizeof(connector);

        connecting_socket = accept(current_socket, (struct sockaddr *)&connector, &addr_size);

        if ( connecting_socket < 0 )
        {
                perror("Accepting sockets");
                exit(-1);
        }

        HandleCurrentConnection(connecting_socket);

        DisposeCurrentConnection();
} 
```

我将如何简单地在上面或之后添加几行`connecting=socket = accept`......以使其同时接受多个连接？我可以使用`fork();`但归结为`DisposeCurrentConnection();`我想终止该进程并让父线程运行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-11T19:33:43.807

我不是 100% 确定你想要做什么，买了我的头，我宁愿在接受后做叉子，然后在你完成后简单地 exit() 。但请记住，当子进程退出时，您需要对 SIGCHLD 信号做出反应，否则您将有大量的僵尸进程徘徊，等待将它们的退出状态传递给父进程。C-伪代码：

```
for (;;) {
  connecting_socket = accept(server_socket);
  if (connecting_socket < 0)
    {
      if (errno == EINTR)
        continue;
      else
        {
          // handle error
          break;
        }
    }

  if (! (child_pid = fork ()))
    {
       // child process, do work with connecting socket
       exit (0);
    }
  else if (child_pid > 0)
    {
      // parent process, keep track of child_pid if necessary.
    }
  else
    {
      // fork failed, unable to service request, send 503 or equivalent.
    }
} 
```

child_pid 需要（如前所述）杀死子进程，但如果您希望使用 waitpid 来收集退出状态。

关于僵尸进程，如果您对该进程发生的事情不感兴趣，您可以为 SIGCHLD 安装一个信号处理程序，然后使用 -1 在 waitpid 上循环，直到它不再有子进程，就像这样

```
while (-1 != waitpid (-1, NULL, WNOHANG))
  /* no loop body */ ; 
```

waitpid 函数将返回退出的子进程的 pid，因此如果您希望将其与有关连接的其他一些信息相关联（如果您确实跟踪了 pid）。请记住，如果捕获到 SIGCHLD，accept 可能会在 errno 设置为 EINTR 的情况下退出，而没有有效的连接，因此请记住在接受返回时检查这一点。

**编辑：**
不要忘记检查错误情况，即 fork 返回-1。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-11T19:42:05.350

在 unix 上谈论 fork() 和线程并不完全正确。Fork 创建了一个全新的进程，它与父进程没有共享地址空间。

我认为您正在尝试实现按请求处理的模型，很像传统的 unix Web 服务器，例如 NCSA httpd 或 Apache 1.x，或者可能构建具有共享全局内存的多线程服务器：

**按请求处理服务器：**

当您调用 fork() 时，系统会创建父进程的克隆，包括文件描述符。这意味着您可以接受套接字请求然后分叉。子进程有套接字请求，它可以回复然后终止。

这在 unix 上相对有效，因为进程的内存不是物理复制的 - 页面在进程之间共享。当子进程写入内存时，系统使用一种称为写时复制的机制来逐页复制。因此，unix 上的每请求进程服务器的开销并不大，许多系统都使用这种架构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-16T08:34:46.033

最好使用 select() 函数，它使您能够在一个程序中侦听和连接不同的请求......它避免了阻塞，但分叉会为程序的副本创建一个新的地址空间，这会导致内存效率低下......

```
select(Max_descr, read_set, write_set, exception_set, time_out); 
```

即你可以

```
fd_set* time_out;
fd_set* read_set;
listen(1);
listen(2);
while(1)
{
  if(select(20, read_set, NULL,NULL, timeout) >0)
  {
    accept(1);
    accept(2); .....
    pthread_create(func);....
  }
  else
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-11T19:27:21.323

检查 fork() 的返回值。如果为零，则您是子进程，您可以在完成工作后退出（）。如果它是一个正数，那么它是新创建的进程的进程 ID。如果子进程由于某种原因停留时间过长，这可以让您 kill() 子进程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-11T19:42:23.787

根据我的评论，这个服务器并不是真正的多线程，它是多进程的。

如果你想要一种简单的方法让它接受多个连接（并且你不太关心性能），那么你可以让它与[inetd](http://en.wikipedia.org/wiki/Inetd)一起工作。这将产生进程和作为守护进程的工作留给inetd，您只需要编写一个处理和处理单个连接的程序。*编辑：或者如果这对你来说是一个编程练习，你可以获取 inetd 的源代码，看看它是如何做到的*

您也可以使用 select 来做您想做的事，而无需线程或新进程。

这是[一篇](http://www.lowtek.com/sockets/select.html)解释如何使用 select 的文章（与 fork 或线程相比开销非常低 - 这是一个以这种方式编写的轻量级 Web 服务器的[示例）](http://www.acme.com/software/thttpd/)

此外，如果您不喜欢在 C 中执行此操作，并且 C++ 也可以，您可以考虑将代码移植到使用[ACE](http://www.cs.wustl.edu/~schmidt/ACE-overview.html)。这也是寻找如何做到这一点的设计模式的好地方，因为我相信它几乎支持任何连接处理模型并且非常便携。

# windows - 如果我为我的程序创建一个新的文件类型，如何正确使用“打开方式”？

> ID：433474
> 
> 赞同：1
> 
> 时间：2009-01-11T19:23:39.740
> 
> 标签：windows, explorer, file-extension, open-with, file-type

我做了一个程序。我还制作了自己的文件类型，程序可以创建、打开和编辑。在资源管理器中，我右键单击这个新文件类型并选择“打开方式”并选择我的程序。当然，它只是打开程序而不加载文件。

如何让我的程序知道它被请求在启动时打开文件？是否有一些“打开方式”发送的命令行参数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-11T19:30:45.713

是的，Windows 资源管理器将文件的路径作为命令行参数发送到应用程序的可执行文件。

您可以`args[0]`在 C# 或`argv[1]`C++ 中使用来阅读它。

# spring - 使用 aop 的性能影响

> ID：433475
> 
> 赞同：47
> 
> 时间：2009-01-11T19:23:52.657
> 
> 标签：spring, performance, aop, spring-aop

我们已经开始将 spring aop 用于我们应用程序的横切方面（目前的安全性和缓存）。

我的经理担心这项技术的性能影响，尽管他完全了解其好处。

我的问题，你有没有遇到过使用aop（特别是spring aop）引入的性能问题？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-01-11T20:02:12.547

只要您*可以控制*AOP，我认为它是有效的。无论如何，我们确实遇到了性能问题，所以根据自己的推理，我们并没有完全控制；）这主要是因为任何编写方面的人都必须*充分*了解系统中的所有*其他*方面以及它们之间的相互关系。如果你开始做“聪明”的事情，你可以瞬间超越自己。在一个大型项目中做一些聪明的事情，很多人只能看到系统的一小部分，这在性能方面是非常危险的。这个建议可能在没有 AOP 的情况下也适用，但是 AOP 让您以一些真正优雅的方式自爆。

Spring 还使用代理进行范围操作，*这*是一个很容易获得不希望的性能损失的领域。

但是鉴于您有控制权，AOP 唯一真正的痛点是对调试的影响。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-01-11T20:15:38.697

如果性能是一个问题，我们使用[AspectJ](http://www.eclipse.org/aspectj/)效果很好。

因为它使用字节码编织（编译时间与运行时有很大不同），所以它是目前最快的 AOP 框架之一。请参阅：[AOP 基准](http://docs.codehaus.org/display/AW/AOP+Benchmark)

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-01-11T19:38:14.390

当我使用它时，我没有——但是我的应用程序不是你的应用程序。

如果您将它用于在非常紧密的循环中使用的调用，则有可能对*性能*造成重大影响。如果它只是用于每个请求检查一次安全性并缓存各种内容，我看不出它有多重要——但这就是为什么你应该对*你的*应用程序进行分析和基准测试的原因。

我意识到“用你的应用衡量”可能不是你要找的答案，但它很可能是你猜到的答案：）

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-11T19:41:47.097

如果您使用的是基于代理的 AOP，那么您所讨论的每个方面都应用了 1 个额外的 Java 方法调用。那里的性能影响可以忽略不计。唯一真正关心的是代理的创建，但这通常只在应用程序启动时发生一次。SpringSource 博客对此有一篇很棒的文章：

[http://blog.springsource.com/2007/07/19/debunking-myths-proxies-impact-performance/](http://blog.springsource.com/2007/07/19/debunking-myths-proxies-impact-performance/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-11T20:21:40.107

我在当前项目的批处理中使用了 Spring AOP 来事务管理数据库。

起初，认为不会有性能问题，但我们没有考虑到我们调用数据库数千次的方程式。aop 中的一个方面调用不会对性能产生太大影响，但是将其乘以数千倍，事实证明，由于这些额外的方法调用，新系统比旧系统更差。

我会说 aop 是一个很好用的系统，但要注意有多少方法调用被添加到你的应用程序中

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-12-13T06:40:49.687

理论上，如果你使用 AOP 来做你可以用硬耦合做的事情，那么就没有性能问题，没有开销，也没有额外的方法调用，除非你什么都不做。AOP 框架为您提供了一种方法来消除硬耦合并分解您的横切关注点。

在实践中，AOP Framework 可以引入 3 种类型的开销：

*   开火时间
*   拦截技师
*   消费者整合（制定建议的方式）

有关更多详细信息，您可以参考[when-is-aop-code-executed](https://stackoverflow.com/questions/18735857/when-is-aop-code-executed/41107923#41107923)。

请注意如何实现建议，因为横向代码是装箱/拆箱和反射的诱惑（在性能方面很昂贵）。

如果没有 AOP 框架（硬耦合您的横切关注点），您可以更轻松地开发假定的建议（专用于每种处理），而无需装箱/拆箱和反射。

您必须知道大多数 AOP 框架不提供完全避免装箱/拆箱和反射的方法。

我开发了一个来响应大部分缺失的需求，集中在三件事上：

*   用户友好（轻量级，易于学习）
*   透明（不包括破坏代码）
*   高效（没有装箱/拆箱，名义上的用户代码没有反射和良好的拦截机制）

你可以在这里找到我的开源项目：[Puresharp API .net 4.5.2+](https://github.com/Virtuoze/NConcern)以前[的 NConcern .NET AOP Framework](https://github.com/Virtuoze/NConcern)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-10-09T11:27:06.803

11年后的问题，看看这种情况是多么堕落。

示例：绝大多数人认为在某个方法上放置一个简单的@Transactional spring java 注解并让 spring 充当调用者和被调用者代理组件之间的桥梁是可以且正常的。现在他们有 20 多个不可调试的“神奇”代码堆栈帧。JIT 编译器很快就被超越了，无法再尝试内联，或者最终导致大量生成的类导致内存膨胀。

在这个“框架用户”的时代，懒惰是没有限制的。难怪微不足道的 http 调用的 e2e 时间从 100 毫秒缩短到 10 秒。难怪你需要 2GB 来运行一个糟糕的 servlet 容器，而这个容器曾经运行在 128MB 中。不要让我开始记录异常堆栈跟踪的成本......

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-01-14T17:38:32.063

你有没有想过一个 AOP 工具可以在需要时在运行时向对象添加方面？.net 有一个“使用动态装饰器向对象添加方面”（http://www.codeproject.com/KB/architecture/aspectddecorator.aspx）。我相信你可以为 Java 写一个类似的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-12-26T12:53:31.937

如果您为方面使用某个框架，则可能会出现一些性能问题。接下来，如果您在某个框架之上创建抽象，并且方面处理是从框架完成的，那么很难找出与性能问题相关的问题的原因。如果你真的关心性能和更关心小时间片，我建议编写自己的方面。没有人想重新发明轮子，但有时更好的是最好的。你可以编写自己的 AOP 联盟抽象实现。

# enumeration - 查找表最佳实践：数据库表...或枚举

> ID：433490
> 
> 赞同：62
> 
> 时间：2009-01-11T19:36:44.143
> 
> 标签：enumeration, lookup, dbtable

如果我们必须存储公司的可用职位（即经理、团队负责人等）。存储它的最佳做法是什么？我有两种意见和评论......“当然，欢迎你的”

 ****1.  将其存储为具有列 ID 和 Name 的 DB 表，并使用查询和连接处理它。
2.  将其存储为 Enum 并忘记数据库表。** 

**在我看来，如果我有更改项目，我会选择第一个解决方案。这样我就不会将这些选项硬编码为 Enum。
如果我确信数据不会改变（例如，性别：男性、女性），我可以选择 Enum 解决方案。

**注意：**我用英语编码，UI 文化可能是阿拉伯语。如果我将使用 Enum 解决方案，我将在表示层中对基于文化的字符串进行硬编码，从最佳实践的角度来看是否可以！！！！

我想知道您的意见，如果我的想法符合最推荐的“最佳实践”？**

 *** * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-01-11T20:27:55.817

一般来说，你应该只在有一组明确的不会改变的项目时使用枚举，例如原色或大陆名称。否则，具有适当实现的外键的查找表几乎总是最好的选择。

查找表选项有一个可能的变体，您可能有大量用于简单 id/值关系的查找表。域/查找表对可以显着减少所需的表数量，尽管会增加一些编码复杂性。在这种情况下，您将拥有一个域表

```
DomainID int 身份
域 varchar(255)

```

和一个键/值表

```
域ID int
ID int 身份
值 varchar(255)

```

因此，在域表中添加了一行，对应于您将使用的每个查找表，并将所有（键域）/值对添加到值表中。除了简化数据库结构之外，这种方法还具有可以在应用程序代码中动态创建“查找表”的优点，这在某些应用程序中非常有用。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-12-17T16:19:47.153

**选项 1：将其存储为具有列 ID 和名称的数据库表，并使用查询和连接处理它**是您应该做的最低限度。

来自“[你应该避免的五个简单的数据库设计错误](https://www.simple-talk.com/sql/database-administration/five-simple-database-design-errors-you-should-avoid/)”：

> 虽然应用程序强制完整性有时受到开发人员的青睐，但 DBMS 仍然必须是所有完整性的集中执行者，这仍然是事实。

推荐的最佳实践是实现您的数据库，就好像它对用户界面一无所知。也就是说，数据库应该强制执行与数据有关的所有规则；在这种情况下，数据库应该强制执行适当的值。为了枚举哪些值是合适的，每种查找值类型的[查找表](https://www.simple-talk.com/sql/t-sql-programming/look-up-tables-in-sql-/)通常是要走的路。很多时候，应用程序来来去去，但数据库仍然存在并被重用。

如果您想在应用程序中强制执行枚举，您当然可以这样做，但无论您做什么，请确保数据库完成其作为数据库的工作并维护数据的完整性。如果麻烦，就去解决它；你正在奠定基础。在“[数据库设计和比萨斜塔](http://rodgersnotes.wordpress.com/2010/09/14/database-design-mistakes-to-avoid/)”中，作者强调了为什么在数据库中正确地打好基础非常重要。

我希望这有帮助。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-13T17:31:12.740

我总是选择数据库选项，因为它有几个优点，其中一个主要优点是您可以更改查找列表中项目的名称/描述，而无需更改任何代码。还同意使用单个表而不是许多小表，这样您就可以编写一个例程来从数据库中检索值，从而降低维护成本。拥有一个单一的例程意味着您可以投入更多的精力来使其表现良好。

除了上面 Cruachan 的回复，如果您有父子关系，其中没有父级的行描述域，您可以使用一张表。属于域的所有记录都将域行作为其父项。

```
ID           int autonumber -- integer primary key for performance
DomainID     int            -- null for domains
Name         varchar(100)   -- Name of the item
Description  varchar(255) 
```

因此，例如，货币列表可能包含：

```
 ID    DomainID   Name              Description

 100   NULL       ISO Currencies    List of ISO Currency codes
 101   100        BHD               Bahrain Dinar
 102   100        GBP               British Pound
 103   100        EUR               Euro  
 104   100        USD               US Dollar 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-11T20:08:09.070

我倾向于选择数据库选项，因为这样可以轻松查询有意义的数据（即名称而不是 ID）。

如果我相当确信这些值不会改变，那么我将在应用程序中枚举它们，并且当您不必记住项目的 ID 并且使代码更具可读性时，它会使开发变得更加容易。

这种方法允许我选择是否在查询中包含查找表。例如，我会将它包含在我想要显示查找值的报告查询中，但如果我可以从枚举中推断它，则在我的应用程序中加载数据时可能不包含它。

显然，如果值可能会发生变化或修改，枚举可能是不可能的。

只有你可以判断 UI 文化的影响，我 100% 确定我的用户的文化，所以不必太担心 :)。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-11T21:46:51.133

您打算将这份雇主名单放入数据库中的唯一事情是什么？

如果是，请将其放入文件中，然后完成。

数据库很棒，但是如果您需要一个简单的键值，它们就大材小用了。他们给你很多东西。但他们也在幕后做了很多事情，他们是你需要支持的另一件事......如果你可以摆脱一个包含 20 个制表符分隔行的文件，那就简单一点。

如果您有很多需要此类查找的内容，或者如果您认为在客户端尝试读取它们时可能需要更新它们，或者如果您以后可能想要交叉引用这些内容 - 那么请选择数据库。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-11T21:35:15.153

我几乎总是把这种东西放在桌子上。如果需要很多，我会缓存它。如果我需要以编程方式引用其中的一些，我将创建一个枚举，其值设置为查找项的键值。

例如，一个代理主键（通常这样我的数据访问层可以无缝地添加/更新它），一个用于项目值的字段，加上一个“候选人”（候选人在引号中，因为它不是必需的，所以它要么是唯一的或空）。这样，我可以使用引号中的枚举来引用表中的特定/重要项目，但仍然可以灵活地让最终用户添加新项目。使用的数据模型的细节实际上取决于您的偏好（有些人现在可能对我大喊大叫，因为不只是使用“候选”字段作为真正的主键）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-11T20:14:11.883

查找，查找，查找（在此处插入猴子跳舞视频）

我*个人*的“最佳实践”是将所有内容都保存在数据库中。公司中的职位绝对是一个查找表。

翻译也是如此，这可能有点棘手，但通常将表与翻译表连接起来的视图定义是一个好的开始。

此外，如果 Position 只是一个 int 值，并且您的应用程序是单语言的，您可以将职位标题直接添加到数据库中。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-04-17T21:57:19.367

我一般都喜欢两者。我在 dal 层中使用 table，因为它们可用于 tableau 等工具，用于报告、SQL 查询和其他目的。

我在前端和业务层使用枚举，因为它易于使用它们进行开发，并且您不必从 dal 中获取列表，也不必记住表中的值。

如果表中的列表和枚举中的列表相同，C# 会自动为您将枚举转换为相应的 ID。

在 MVC 中，您可以在视图中使用带有枚举的下拉列表作为 @Html.EnumDropdownListFor()，这样您就不必为下拉列表访问数据库本身。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-18T19:09:06.480

如果您可以使它们保持同步，我认为没有太多理由不同时拥有两者。当我使用数据库存储开发一些状态机功能时，在我的 IDE 中枚举可用对象状态变得更加容易。

不久前，我为自己编写了一个小的 EnumGenerator Visual Studio Addin，它从您在 IDE 中选择的 DB Tablet 的 ID 和 DESC 列在 C# 中创建了一个枚举代码片段。我还没有发布它，因为这是我第一次使用 VS Addins，它非常垃圾，但我敢打赌，有插件/代码生成经验的人可以接受这个想法并运行它。

# html - 为什么 HTML 要求多个空格在浏览器中显示为单个空格？

> ID：433493
> 
> 赞同：57
> 
> 时间：2009-01-11T19:38:00.507
> 
> 标签：html, formatting, whitespace

我早就认识到 HTML 文件中的任何一组空格都只会显示为一个空格。例如，这个：

```
<p>Hello.        Hello. Hello. Hello.                       Hello.</p> 
```

显示为：

你好。你好。你好。你好。你好。

这非常好，就好像您需要多个预先格式化的文本空格一样，您可以使用 <pre> 标记。但原因是什么？更准确地说，**为什么这会出现在 HTML 规范中？**

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-01-11T19:45:09.820

空格在 HTML 中是压缩的，因为 HTML 的格式化方式和呈现方式之间存在区别。考虑这样的页面：

```
<html>
    <body>
        <a href="mylink">A link</a>
    </body>
</html> 
```

例如，如果 HTML 使用空格缩进，则链接前面将有几个空格。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-01-11T20:15:12.847

尝试解决“为什么”可能是因为 HTML 是基于[SGML](http://en.wikipedia.org/wiki/SGML)以这种方式指定的。它又基于60 年代初的[GML 。](http://en.wikipedia.org/wiki/IBM_Generalized_Markup_Language)空白处理的原因很可能是因为当时数据一次输入一张“卡片”，这可能导致句子和段落的意外中断。旧 GML 的一个区别是它规定句子之间必须有两个空格（就像旧的打字机规则一样），这可能已经确立了空格独立于标记的先例。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-01-11T19:45:17.183

正如其他人所说，它在 HTML 规范中。

如果要在输出中保留空格，可以使用[<pre> 标签](http://www.w3.org/TR/html401/struct/text.html#h-9.3.4)：

```
<pre>This     text has              extra spaces

and

    newlines</pre> 
```

但这通常也会以不同的字体显示文本。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-01-11T19:45:24.610

它不仅在[规范](https://stackoverflow.com/questions/433493/why-do-multiple-spaces-in-an-html-file-show-up-as-single-spaces-in-the-browser#433499) [中](https://stackoverflow.com/questions/433493/why-do-multiple-spaces-in-an-html-file-show-up-as-single-spaces-in-the-browser#433501)，而且有一定的意义。如果没有压缩空格，则必须将所有 html 放在一行中。所以是这样的：

```
<div>
    <h1>Title</h1>
    <p>
       This is some text
       <a href="#">Read More</a>
    </p>
</div> 
```

会与整个地方的空间有一些奇怪的对齐。使其正确的唯一方法是压缩该代码，这将难以维护。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-01-11T19:45:48.773

“为什么将多个空格转换为单个空格？”

首先，“为什么”的问题很难回答。它在规范中。这几乎是它的结束。

考虑有几种空白。

*   标签之间的空白。 `<p>\n<b>hi</b>\n</p>`

*   标记内内容中的空白。 `<p>Hi <i>everyone</i>.</p>`

*   `<pre>`或 CDATA 部分中的空白。

前两个很难区分。标签之间的空格，即使在 XML 中，也是“可选的”。但是，当您拥有所谓的“混合内容模型”——标签与内容混合时——“标签之间”、“在内容中但在标签之间”和“在内容中但不在标签之间”的微妙之处是不可能的整理。

所以他们不整理。标签之间的空格和内容中的空格都是可选的。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-01-11T20:01:44.747

如果浏览器不这样做，可能很难格式化您的 HTML 代码以使其易于阅读。例如，您可能希望像这样格式化您的代码：

```
<html>
<body>
    <div>
        I like to indent all content that is inside div tags.
    </div>
</body>
</html> 
```

如果浏览器没有忽略 div 标签内文本之前的八个左右的空格，您的网页可能看起来不像您想要的那样。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2017-08-02T04:37:42.823

通常，这些设计决策没有记录在任何规范中，只能从碰巧可公开访问或由规范作者自己解释的工作组讨论档案中收集。但是，在这种特殊情况下，[HTML 3.2](https://www.w3.org/TR/REC-html32#sgml)确实声明了以下内容：

> 除了在文字文本中（例如`PRE`元素），HTML 将连续的空白字符序列视为等同于单个空格字符（ASCII 十进制 32）。这些规则允许作者在直接编辑标记文本时具有相当大的灵活性。请注意，未来对 HTML 的修订可能允许相对于由关联样式表定义的制表符规则来解释水平制表符（ASCII 十进制 9）。

您今天看到的行为当然比 HTML 3.2 中指定的要复杂得多，但我相信推理仍然适用。这种灵活性可能有用的一个例子是当你有一个很长的段落你打算硬换行和缩进时：

```
<H1>Lorem ipsum</H1>
<P>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Fastidii oportere
   consulatu no quo. Vix saepe labores an, pri illud mentitum et, ex suas quas
   duo. Sit utinam volutpat ea, id vis cibo meis dolorum, eam docendi
   accommodare voluptatibus no. Id quaeque electram vim, ut sed singulis
   neglegentur, ne graece alterum has. Simul partiendo quaerendum et his. 
```

如果空白没有折叠，您最终会得到一个具有异常大间隙的段落，其中文本由于缩进而被硬换行。

没有其他 HTML 规范建议此设计决策背后的任何类型的推理。特别是[HTML 4](https://www.w3.org/TR/html401/struct/text.html#h-9.1)只描述了折叠行为，而 HTML5 和 live 规范都遵循 CSS，它[也没有解释任何东西](https://www.w3.org/TR/CSS22/text.html#white-space-prop)。早期版本的 HTML 也不包含任何解释，尽管以下摘录确实出现在[HTML 2.0](https://www.rfc-editor.org/rfc/rfc1866#page-18)的示例片段中：

```
<OL>
...
  <UL COMPACT>
  ...
  <LI> Whitespace may be used to assist in reading the
       HTML source.
  </UL>
...
</OL> 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-01-11T19:40:39.830

它在 HTML 规范中。这是关于将单词间空间呈现为 ASCII 空间的部分。

[http://www.w3.org/TR/html401/struct/text.html](http://www.w3.org/TR/html401/struct/text.html)

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-01-11T19:41:01.467

很简单，它在规范中。

从 HTML 规范，[第 9.1 节](http://www.w3.org/TR/REC-html40/struct/text.html#h-9.1)：

> 特别是，用户代理在产生输出字间距时应该折叠输入的空白​​序列。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-01-11T19:43:49.183

HTML 的定义/规范明确声明忽略多余的空格。

如果要包含额外的空格，请使用`<pre>`标签或`&nbsp;`

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-01-11T20:21:03.913

要回答*为什么这在 H​​TML 规范中？*您必须考虑 HTML 的起源。

Tim Berners-Lee 设计了用于共享科学文档的 HTML。他基于 SGML 中预先存在的语法思想，它也有类似的空白处理。

可以想象，CERN 的早期 HTML 编写者在没有所见即所得工具的帮助下这样做，因此以这种方式处理空格的能力有助于此类手写源文件的易读性。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-01-11T20:21:25.160

还有一个排版的答案：无论你在学校的打字老师可能告诉你什么，单词和句子之间应该只有一个空格。

[在句子之间使用一个空格](http://desktoppub.about.com/cs/typespacing/a/onetwospaces.htm)

[在句子之间使用单个单词空间](http://www.webtypography.net/Rhythm_and_Proportion/Horizontal_Motion/2.1.4/)

# programming-languages - 建议用词来描述你的简历中的语言能力水平

> ID：433495
> 
> 赞同：10
> 
> 时间：2009-01-11T19:38:34.590
> 
> 标签：programming-languages, computer-vision

在完善您的简历时，描述您在特定技术（语言、平台、操作系统等）方面的技能水平的最佳方式是什么？
假设我们谈论的是*简短的简历*，您不会详细说明您过去从事的每个项目和系统，但仍希望读者对您对每个主题的掌握程度有一个总体了解。

您能否建议一组明确但足够通用以在整个行业中被理解的标签？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-28T18:19:48.963

作为招聘经理，我喜欢人们说出他们使用一种语言的年限以及上次使用该语言的时间。此外，在描述您从事的项目时，请务必列出您在每个项目中使用的语言。看到有人在简历上使用 C++（或任何语言）但没有在任何项目旁边列出，这令人沮丧。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-28T18:17:07.473

标签是如此模棱两可，以至于毫无意义。相反，请用每种语言描述您实际完成的工作项目。例如，“为 SQL Server 2005 编写了 30 个 T/SQL 存储过程以更新 ORM，以及 10 个触发器用于完整性验证”。“用 C# 为 ASP.Net 3.5 Web 服务编写后端 LINQ to SQL ORM”。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-11T19:41:43.790

多年经验通常是人力资源人员所寻找的，因为它比“专家”等词更具可验证性和表面上的客观性。人。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-28T20:02:35.713

在过去的几年里，我在简历中添加了定性术语，但只是以结构化的方式。因此，例如，我使用了诸如“C#、SQL 和 Delphi 方面的专业知识”之类的内容，然后是“熟悉 Lisp、PHP ......”等。这个想法不一定是为了将自己与他人进行排名——这些年经验和从事的项目类型将做到这一点——它是在你所学的所有技术中，从相对意义上显示你最深入的地方。

当然，另一个好处是你对自己的才能表现出一种分寸感和观点。如果您说您是超过三种技术的“专家”，我会非常怀疑。如果您表示在 2-3 方面具有专业知识并且熟悉更多内容，那么引发的危险信号就会少得多。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-28T18:03:55.143

您可以使用比例系统，例如 1-5，其中 1 是最少的，5 是最多的。定量而不是定性，因为这会带来各种不太可能是您喜欢的定义。

# python - 在 django 中过滤完整的日期？

> ID：433507
> 
> 赞同：0
> 
> 时间：2009-01-11T19:42:06.037
> 
> 标签：python, django, filter, date, django-queryset

日期（年、月、日）有多种过滤方法。如果我想匹配一个完整的日期，比如 2008/10/18，有没有比这更好的方法：

```
Entry.objects.filter(pub_date__year=2008).filter(pub_date__month=10).filter(pub_date__day=18) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-11T19:47:24.463

如何使用[日期时间](http://docs.python.org/library/datetime.html#datetime-objects)对象。例如：

```
from datetime import datetime
Entry.objects.filter(pub_date=datetime(2008, 10, 18)) 
```

# c# - 以编程方式开始移动表单

> ID：433518
> 
> 赞同：0
> 
> 时间：2009-01-11T19:47:02.407
> 
> 标签：c#, vb.net, winforms, sendmessage

我正在尝试通过单击按钮来移动表单（使用标题栏）。

我认为使用 SendMessage 会很简单：

```
Const WM_LBUTTONDOWN As Integer = &H201

Button1.Capture = False
Cursor.Position = Me.Location + New Size(50, 8)

SendMessage(Me.Handle, WM_LBUTTONDOWN, CType(1, IntPtr), IntPtr.Zero) 
```

但是，尽管如果光标位于表单客户区域中，这会发送消息，但它似乎不会将其发送到表单标题栏（表单以某种方式捕获事件，尽管光标位于标题栏而不是客户区域）。

我已经在按钮上的 mousedown 和 click 事件中尝试了上面的代码，移动光标然后按下 button1。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-11T19:56:38.360

您将需要（并传递为）。不过，我仍然不完全确定这会完成你想要做的事情。`WM_`**`NC`**`LBUTTONDOWN``HTCAPTION``wParam`

通常，允许用户在单击标题栏以外的位置时移动表单的方法是处理`WM_NCHITTEST`消息并`HTCAPTION`在光标位于您要开始移动的区域上方时返回。但是，如果该区域被子控件占用，您还必须`WM_NCHITTEST`从子控件处理并返回`HTTRANSPARENT`。

* * *

顺便说一句，完成此操作的更简单（如果稍微不那么正确）的方法是按照 Mehrdad Afshari的[建议](https://stackoverflow.com/questions/433518/progmatically-start-moving-a-form#433522)进行操作，并且只需设置表单的`Location`属性。您对他评论说“它需要在鼠标移动时移动”，而这正是您可以而且应该做的。

```
class MyForm : Form{
    Point downAt;

    MyForm(){
        Label lbl      = new Label();
        lbl.AutoSize   = true;
        lbl.BackColor  = Color.Blue;
        lbl.ForeColor  = Color.White;
        lbl.Location   = new Point(50, 50);
        lbl.Text       = "Drag me to move this form.";
        lbl.Parent     = this;
        lbl.MouseDown += (s, e)=>downAt = e.Location;
        lbl.MouseMove += (s, e)=>{if(lbl.Capture) Location += (Size)e.Location - (Size)downAt;};
    }
} 
```

这种方法的问题在于它绕过了 Windows 用于移动顶级窗口的代码。这意味着如果用户没有在“显示属性”对话框中选择“拖动时显示窗口内容”选项，这将有效地忽略该设置（它不会显示拖动轮廓）。可能还有其他我没有想到的缺点。

不过，总的来说，这是一种简单易行的实现方式，它是一个完全 .NET 的解决方案，不依赖于任何平台调用（因此它应该可以移植到 Unix 上的 Mono）。

* * *

哎呀。我刚刚意识到我给了你 C# 示例代码，但你的代码似乎是 VB.NET。我想你需要的是：

```
Sub New()
    Dim lbl As New Label
    lbl.AutoSize  = True
    lbl.BackColor = Color.Blue
    lbl.ForeColor = Color.White
    lbl.Location  = New Point(50, 50)
    lbl.Text      = "Drag me to move this form."
    lbl.Parent    = Me
    AddHandler lbl.MouseDown, Function(ByVal s As Object, ByVal e As MouseEventArgs)
        Me.downAt = e.Location
    End Function
    AddHandler lbl.MouseMove, Function(ByVal s As Object, ByVal e As MouseEventArgs)
        If lbl.Capture Then
            Me.Location = Me.Location + DirectCast(e.Location, Size) - DirectCast(Me.downAt, Size)
        End If
    End Function
End Sub 
```

这可能不是在 VB.NET 中表达这一点的最简洁的方式。我使用[Reflector](http://www.red-gate.com/products/reflector/)来帮助我翻译它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-11T20:01:52.860

消息的`LParam`值`wm_LButtonDown`接收*客户端*坐标中的鼠标位置。标题栏在非客户区，所以使用[`wm_NCLButtonDown`message](http://msdn.microsoft.com/en-us/library/ms645620.aspx)。我之前已经看到该消息作为此问题的答案，但我希望有一条更直接的路线：向窗口发送[`wm_SysCommand`消息](http://msdn.microsoft.com/en-us/library/ms646360.aspx)，并指定`sc_Move`标志。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-11T20:13:30.637

Mehrdad 是对的，没必要这么做。鼠标已被捕获，因此您永远不能太快移动它。示例代码：

```
Point mLastPos;
private void button1_MouseMove(object sender, MouseEventArgs e) {
  if (e.Button == MouseButtons.Left) {
    this.Location = new Point(this.Location.X + e.X - mLastPos.X,
      this.Location.Y + e.Y - mLastPos.Y);
  }
  // NOTE: else is intentional!
  else mLastPos = e.Location;
} 
```

# xml - XML 关系

> ID：433521
> 
> 赞同：0
> 
> 时间：2009-01-11T19:48:09.143
> 
> 标签：xml

欺骗： [XML 关系](https://stackoverflow.com/questions/433528/xml-relationship)

* * *

我无法定义论文和作者之间的关系。可以定义一个吗？

```
<xsd:complextype name="Researcher'>
</xsd:complextype>
<xsd:complexType name = "Paper" >
      <xsd:extension base = " Researcher " >
      </xsd:extension>
  </xsd:complexType>
<xsd:complexType name = "Author">
      <xsd:extension base = " Researcher ">
      </xsd:extension>
</xsd:complexType> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-11T19:58:51.243

是的。由于 XML 中的“X”代表可扩展，因此有*很多*方法可以做到这一点，因此 James Atkinson 发表了评论。这是一个简单的例子：

```
…
<author id="1">
    <name>
        <first>James</first>
        <last>Joyce</last>
    </name>
</author>
…
<book>
    <title>Ulysses</title>
    <author refid="1" />
</book>
… 
```

当然，您可能不是第一个解决此类问题的人，所以我会四处寻找开放标准。尝试谷歌搜索“都柏林核心”和“ISBN”，看看是否有任何弹出。

# c# - C# 为类和运算符分配默认属性 =

> ID：433523
> 
> 赞同：6
> 
> 时间：2009-01-11T19:50:24.647
> 
> 标签：c#, properties, default

问题1：

我有一个简单的 winforms 应用程序，我想将我的 Person.Name 属性数据绑定到一个文本框。名称是 StringField 类型。我最初将 Name 属性定义为 String。数据绑定在值类型（如字符串）上效果很好。我希望 StringField.Value 属性成为 StringField 的默认属性。我想在文本框中查看 StringField.Value 的值，而不是文本“FieldApp.StringField”。

问题2：

我希望能够使用运算符 = 将字符串分配给 StringField。此分配将导致设置 StringField.Value 成员。

这可以实现吗？

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace FieldApp
{
    public class StringField
    {
        public string Value { get; set; }    
    }

    public class Person
    {

        //private String _Name;
        //public String Name
        //{
        //    get { return _Name; }
        //    set { _Name = value; }
        //}

        //public Person(string name)
        //{
        //    Name = name;
        //}

        private StringField _Name;
        public StringField Name
        {
            get { return _Name; }
            set { _Name = value; }
        }

        public Person(string name)
        {
            Name = new StringField();
            Name.Value = name;
        }
    }

    public partial class FieldAppForm : Form
    {
        Person person = new Person("steve");

        public FieldAppForm()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            //our form contains a button1 and textBox1

            //this compiles
            person.Name.Value = "steve";

            //this does not. Is there anyway to accomplish this?
            person.Name = "steve";

            //steve appears in the textbox 
            textBox1.DataBindings.Add("Text", person, "Name.Value");

            //FieldApp.StringField appears in the textbox 
            textBox1.DataBindings.Add("Text", person, "Name");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-11T20:30:06.327

您可以创建隐式运算符重载。然后你可以`StringField`从这样的字符串创建：

```
StringField field = "value of new object";
string value=(string)field; 
```

知道这会创建一个新`StringField`对象。我不一定会建议你这样做。

```
[System.Diagnostics.DebuggerDisplay("{Value}")]
public class StringField
{
    public string Value { get; set; }
    public static implicit operator StringField(string s)
    {
        return new StringField { Value = s };
    }

    public static explicit operator string(StringField f)
    {
        return f.Value;
    }
    public override string ToString()
    {
        return Value;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-11T20:08:02.457

重新进行数据绑定，对于*某些*绑定目标（`PropertyGrid`、`DataGridView`等），您可以使用 a 来执行此操作`TypeConverter`（见下文）。不幸的是，这似乎不适用于`TextBox`，所以我认为您最好的选择是简单地添加一个 shim 属性（如已经建议的那样）：

```
string NameString
{
   get { return Name.Value; }
   set { Name.Value = value; } // or new blah...
} 
```

（并绑定到`NameString`）

过去，我使用自定义`PropertyDescriptor`实现来回避这一点，但*仅仅*为此并不值得。

无论如何，一个`TypeConverter`示例（与`PropertyGrid`and一起使用`DataGridView`）：

```
[TypeConverter(typeof(StringFieldConverter))]
public class StringField
{
    public StringField() : this("") { }
    public StringField(string value) { Value = value; }
    public string Value { get; private set; }
}

class StringFieldConverter : TypeConverter
{
    public override bool CanConvertFrom(
        ITypeDescriptorContext context, Type sourceType)
    {
        return sourceType == typeof(string)
            || base.CanConvertFrom(context, sourceType);
    }
    public override object ConvertFrom(
        ITypeDescriptorContext context,
        System.Globalization.CultureInfo culture,
        object value)
    {
        string s = value as string;
        if (s != null) return new StringField(s);
        return base.ConvertFrom(context, culture, value);
    }
    public override bool CanConvertTo(
        ITypeDescriptorContext context, Type destinationType)
    {
        return destinationType == typeof(string)
            || base.CanConvertTo(context, destinationType);
    }
    public override object ConvertTo(
        ITypeDescriptorContext context,
        System.Globalization.CultureInfo culture,
        object value, Type destinationType)
    {
        if (destinationType == typeof(string) && value != null
            && value is StringField)
        {
            return ((StringField)value).Value;
        }
        return base.ConvertTo(context, culture, value, destinationType);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-11T20:42:07.537

您可以通过提供转换运算符来实现赋值。鉴于您的类的性质，您还应该覆盖 Object 方法：

```
public class StringField {
  public string Value { get; set; }
  public static implicit operator StringField(string value) {
    StringField sf = new StringField();
    sf.Value = value;
    return sf;
  }
  public override string ToString() {
    return Value;
  }
  public override bool Equals(object obj) {
    if (obj == null || !(obj is StringField)) return false;
    return 0 == string.Compare(Value, (obj as StringField).Value);
  }
  public override int GetHashCode() {
    return Value.GetHashCode();
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-11T19:55:13.840

您可以通过将 Name 属性映射到类内部的 Name.Value 字段来处理 StringField。

因此您可以像这样定义 Name 属性：

```
string Name 
{
   get { return _name.Value; }
   set { _name.Value = value; }
} 
```

这里 _name 是您的 StringField 变量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-11T19:56:15.540

在 C# 中不能重写赋值运算符。但是，您可以拥有一个属性来为您进行类型转换并将该属性公开给类

# xml - 我的 XML 到底有什么问题？

> ID：433524
> 
> 赞同：1
> 
> 时间：2009-01-11T19:52:19.307
> 
> 标签：xml, firefox, browser, safari

我有一个为我运行的游戏自动生成的 XML 文件。然而，它显然有一个错误。

该文件位于：[http ://woarl.com/myXML.xml](http://woarl.com/myXML.xml)

错误显然在第 520 行，这里是第 519-521 行

```
<type>Academy</type>
<typeid>23</typeid>
<completion>4</completion> 
```

关于错误是什么的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-11T19:54:57.600

文件不完整。

通过浏览器下载时，它不会像您显示的那样结束，而是像这样：

```
<city> 
    <id>8</id> 
    <name>Breisgau</name> 
    <xpos>58</xpos> 
    <ypos>934</ypos> 
    <continent>Rayti</continent> 
    <continentid>3</continentid> 
    <size>52297</size> 
    <port>0</port> 
    <walled>1</walled> 
    <building> 
        <type>Academy</type> 
```

就是这样，最后`<type>`一行是第 518 行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-11T19:56:35.460

您链接到的文件在第 520 行结束。没有 typeid 23 和完成 4。

也许您的网络服务器正在做一些愚蠢的事情。

# c# - C# - 泛型和继承问题

> ID：433526
> 
> 赞同：7
> 
> 时间：2009-01-11T19:52:51.363
> 
> 标签：c#, generics, inheritance, casting

我遇到了继承和泛型的问题。这是说明我的问题的代码：

```
namespace TestApplication
{
    public class MyClass<T>
    {
        private T field;

        public MyClass(T field)
        {
            this.field = field;
        }
    }

    public class MyIntClass : MyClass<int>
    {
        public MyIntClass(int field)
            : base(field)
        {
        }
    }
} 
```

当我尝试做这样的事情时：

```
MyClass<int> sth = new MyClass<int>(10);
MyIntClass intsth = (MyIntClass) sth; 
```

我收到强制转换异常：无效的强制转换异常。无法将“TestApplication.MyClass`1[System.Int32]”转换为“TestApplication.MyIntClass”。

更重要的是，我无法创建强制转换运算符：

```
public static implicit operator MyIntClass(MyClass<int> myClass) 
```

因为：'TestApplication.MyIntClass.implicit operator TestApplication.MyIntClass(TestApplication.MyClass)'：不允许用户定义的与基类之间的转换

我需要如上所述创建演员表。我不知道为什么我不能从基类类型转换。我怎么解决这个问题？提前致谢。

**编辑**

感谢您的回答。现在我看到我无法从基类转换为派生类，并且我看到它与泛型没有任何关系。但是为什么我不能从基类创建用户定义的转换？我有一个返回基类的方法。我能够定义一种转换方法，但创建一个强制转换运算符恕我直言将是一个更好的解决方案。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-11T19:59:02.960

如果对象实际上是派生类类型，则只能从基类转换为派生类。我的意思是，您不能将 base ( `MyClass<int>`) 的实例强制转换为`MyIntClass`. 但是，如果它实际上是`MyIntClass`作为`MyClass<int>`实例存储的类型，则可以强制转换它。

```
MyClass<int> foo = new MyIntClass();
MyIntClass bar = (MyIntClass)foo; // this works. 
```

认为：

```
class Base {
   int x;
}

class Derived : Base {
   int y;
}

Base foo = new Base();
Derived bar = (Derived)foo; 
```

如果允许，它的价值`bar.y`是多少？实际上，从`Derived`to`Base`转换根本不是转换。它只是告诉编译器让 type 的变量`Base`指向 type 的对象`Derived`。这是可能的，因为派生具有更多或相同的特征，而`Base`反之则不然。

如果您能够在基类和派生类之间创建转换运算符，C# 编译器将无法将其与为它们定义的内置关系区分开来。这就是为什么您不能沿继承层次结构创建强制转换运算符的原因。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-11T20:08:40.257

到目前为止，其他答案都是正确的，但我想指出您的示例与泛型*无关。*它相当于：

```
using System;

class Base {}
class Child : Base {}

class Test
{
    static void Main()
    {
        Base b = new Base();

        // This will throw an exception
        Child c = (Child) b; 
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-11T20:29:02.587

在你问的评论中：

> 但是为什么不允许从基类转换呢？

很简单——这没有任何意义。考虑这个例子：

```
class BaseClass
{
    public int x;

    public BaseClass(int StartX)
    {
        this.x = StartX;
    }
}
class ChildClass: BaseClass
{
    public int Y;

    public BaseClass(int StartX, StartY): base(StartX)
    {
        this.y = StartY;
    }
}

class Program
{
    public static void Main()
    {
        BaseClass B = new BaseClass(3);
        ChildClass C = (ChildClass)B;
        Console.WriteLine(C.y);
    }
} 
```

假设演员表有效，你认为这个程序会输出什么？更糟糕的是 - 假设`BaseClass`有两个子类 -`ChildClassA`和`ChildClassB`. 你想让这个工作吗？

ChildClassA A = new ChildClassA(); 基类 bc = (基类)A; ChildClassB B = (ChildClassB)bc;

这将有效地允许将`ChildClassA`实例强制转换为`ChildClassB`- 完全错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-11T20:05:15.333

正如 Mehrdad 所说，你不能让一个物体失望。向上转型是隐式的，因此您不能覆盖它。

至于隐式运算符，您仍然可以在派生类中创建一个构造函数，该构造函数接收基类类型的参数。

如果需要自由转换，将变量定义为基类，但实例化派生类。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-11T20:16:32.003

如前所述，您试图将一个对象转换为不是它派生自的类型。您是否可能想要这样做：

```
MyClass<int> sth = new MyIntClass(10);
MyIntClass intsth = (MyIntClass) sth; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-11T20:27:24.867

尝试使用别名，而不是创建 MyIntClass：

```
using MyClass<int> = What.Ever.Namespace.MyIntClass; 
```

这现在是有效的：

```
MyClass<int> foo = new MyClass<int>();
MyIntClass bar = (MyIntClass)foo; 
```

只需了解在使用`using`别名时，您必须在别名类型名称（What.Ever.Namespace）上限定您的命名空间。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-11T20:41:53.590

关于你的第二个问题：

> 但是为什么我不能从基类创建用户定义的转换？

好吧，假设你有这种情况

```
class Base {
}

class Derived {
    public static operator Derived(Base b) { ... }
} 
```

你试图这样做

```
Base x = new Derived();
Derived y = (Derived)x; 
```

应该调用转换吗？当然不是！里面的值`x`实际上是 type `Derived`，所以转换是直接的，没有转换。但是如果值不是 type `Derived`，而是具体的`Base`，那么用户定义的转换必须发生，否则我们会遇到编译器错误。这一切都毫无意义；用户定义的转换是在编译时找到的，而值的类型`x`只有在运行时才知道。因此，编译器不知道该怎么做——调用用户定义的转换或简单地转换值......

希望这对你有点意义。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-11T21:59:30.407

回答您上次的编辑。

此代码已经编译，它只在运行时失败：

> MyIntClass intsth = (MyIntClass) sth;

因此，如果保留显式，以下强制转换运算符将是多余的：

> 公共静态隐式运算符 MyIntClass(MyClass myClass)

因此，编译器应该阻止您添加该转换。我认为该错误可能令人困惑，但我认为它只是禁止将 B 类转换为 A 类，如果 B 是从 A 派生的（在我看来，警告起初似乎是为了防止任何转换为​​ A）。

如果运算符是隐式的，那也是危险的，因为向下转换总是会失败，所以你必须：

1.  通过添加显式强制转换，向编译器显示您知道这一点；
2.  向读者（包括你自己，几分钟后）表明操作可能会失败。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-17T16:17:52.420

如果您将赋值或转换视为逐值复制，则基类到派生类的赋值/转换是有意义的。对于新手来说，c# 令人困惑的是它做事的方式不一致：

### “int”是一个“简单”类型：

```
int i = 5;   // <- this creates an int.  
int j = i;    // <- this creates another int and copies the value of i into j. 
```

### 'Object' 不是一个简单的类型：

```
Object a;                            // <- this does not create a copy of 'Object', only a reference to one
Object b = new Object();   // <- this actually creates an Object
a = b;                                 // <- this sets the reference to an object a to the reference to an object b.
                                          // both of them reference the same Object. No values were copied. 
```

如果它正在复制值，那么将基类复制到派生类将起作用。C# 不像其他语言那样工作。

我认为这可能会让你感到困惑。

# xml - XML 关系

> ID：433528
> 
> 赞同：1
> 
> 时间：2009-01-11T19:53:51.080
> 
> 标签：xml, xsd

我无法定义论文和作者之间的关系。可以定义一个吗？

```
<xsd:complextype name="Researcher'>
</xsd:complextype>
<xsd:complexType name = "Paper" >
      <xsd:extension base = " Researcher " >
      </xsd:extension>
  </xsd:complexType>
<xsd:complexType name = "Author">
      <xsd:extension base = " Researcher ">
      </xsd:extension>
</xsd:complexType> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T15:40:15.723

我假设您希望“论文”有一个“作者”。我在我的模式中这样做的方式是有一个作者列表和一个论文列表。像这样的东西：

```
<papers>

<authorlist>
    <author>Bob Barr</author>
    <author>Ron Paul</author>
    <author>Ralph Nader</author>
</authorlist>

<paperlist>
    <paper>
       <title>How to Revert Your Economy to the Gold Standard</title>
       <author>Ron Paul</author>
    </paper>
    <paper>
        <title>Unsafe at any Speed</title>
        <author>Ralph Nader</author>
    </paper>
     <paper>
         <title>How to be a Viable 3rd Party Candidate</title>
         <author>Bob Barr</author>
     </paper>
 </paperlist>
 </papers> 
```

选项卡搞砸了，但在我的示例中，每篇论文/作者都必须引用作者列表/作者。我会使用与此类似的模式代码来达到预期的效果：

```
<xsd:element name="paper" type="Papers_Type">
    <xsd:unique name="Author_Key">
        <xsd:selector xpath="authorlist/author">
        <xsd:field xpath="text()"/>
    </xsd:key>
    <xsd:keyref name="Paper_Author_AuthorRef" refer="AuthorKey">
         <xsd:selector xpath="paperlist/paper/author"/>
         <xsd:field xpath="text()"/>
    </xsd:keyref>
</xsd:element>

<xsd:complextype name="Papers_Type">
    <!--Enter element definitions to your liking here-->
</xsd:complextype> 
```

所以论文/论文列表/论文/作者必须对应论文/作者列表/作者，否则验证将引发错误。祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T23:19:52.023

这似乎是一个重复的问题。

我用“是一个”或“有一个”的关系来思考事物。我想 C++ 类一直困扰着我。

我看到的关系是 1\. 论文有作者。2\. 作者是研究员（或者作者可能是研究员）。

我不明白一篇论文如何成为一名研究员。它可以有一个作者，他可能是一个研究员。

# cocoa - initWithFrame 未调用，但 awakeFromNib 是

> ID：433539
> 
> 赞同：30
> 
> 时间：2009-01-11T19:56:57.143
> 
> 标签：cocoa

我正在尝试继承 NSOutlineView。这是我的代码：

OutlineViewSublcass.h：

```
#import <Cocoa/Cocoa.h>

@interface OutlineViewSubclass : NSOutlineView {

}

@end 
```

OutlineViewSubclass.m：

```
#import "OutlineViewSubclass.h"

@implementation OutlineViewSubclass

- (id)initWithFrame:(NSRect)frame
{
    self = [super initWithFrame:frame];
    printf("debug A\n");
    return self;
}

- (void)awakeFromNib
{
    printf("debug B\n");
}

@end 
```

调试输出为：

```
debug B 
```

为什么不`(id)initWithFrame:(NSRect)frame`叫？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-01-11T20:19:33.683

Cocoa 控件实现了 NSCoding 协议，用于从 nib 取消归档。不是使用 initWithFrame: 初始化对象然后设置属性，而是 initWithCoder: 方法负责在使用 Interface Builder 配置的序列化属性加载控件时设置控件。这与使用 NSCoding 序列化任何对象的方式几乎相同。

如果您将自定义 NSView 子类粘贴在不实现 NSCoding 的 nib 中，情况会有些不同，在这种情况下会调用 initWithFrame:。在这两种情况下，awakeFromNib 都会在对象加载后被调用，通常是在子类中执行额外初始化的好地方。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-12-09T18:09:53.113

Apple 对此的官方回答是[创建自定义视图](https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/CocoaViewsGuide/SubclassingNSView/SubclassingNSView.html)。

> 在 Interface Builder 中创建的视图实例**在其 nib 文件加载时不会调用 initWithFrame:，**这通常会导致混淆。请记住，Interface Builder 在保存 nib 文件时会归档对象，因此视图实例已经创建并且 initWithFrame: 已经被调用。
> 
> 当由于加载 nib 文件而创建视图时，awakeFromNib 方法提供了对视图进行初始化的机会。加载包含视图对象的 nib 文件时，当所有对象都已取消归档时，每个视图实例都会收到一条 awakeFromNib 消息。这为对象提供了一个机会来初始化未在 Interface Builder 中与对象一起存档的任何属性。

# iphone - Web 应用程序中的 iPhone 加速度计

> ID：433543
> 
> 赞同：1
> 
> 时间：2009-01-11T19:58:21.587
> 
> 标签：iphone

我希望我的网站根据设备位置更改其布局。该网站有 2 种布局类型：垂直（高度 > 宽度）和水平（宽度 > 高度）。

你有什么解决办法吗？

**upd**：我认为更改站点布局没有任何复杂性。我想知道是否有任何事件需要处理。ps 如果我将设备旋转 90 度，iphone 的浏览器会改变它的方向吗？戴夫，tnx 进行修正。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-11T20:43:08.127

`onorientationchange`当方向改变时，有一个称为发送的 javascript 事件，并且`orientation`在`window`对象上调用了一个属性来告诉当前方向是什么。

有关更多信息和示例，请参阅[文档](https://developer.apple.com/webapps/docs/documentation/AppleApplications/Reference/SafariWebContent/HandlingEvents/chapter_7_section_9.html)。

# asp.net - JSON 安全性

> ID：433558
> 
> 赞同：1
> 
> 时间：2009-01-11T20:05:47.483
> 
> 标签：asp.net, javascript, security, json

Pagemethods 和 Json 是否存在安全风险？（我不使用 cookie）。例如，我有一个 pagemethod，我将用户 ID 作为参数发送，但我不想将其显示给用户。用户可以从 pagemethod 获取用户 ID 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-11T20:11:05.337

是的，他们可以（查看用户 ID）。用户可以看到服务器和客户端之间的任何通信。用 fiddler 或 firebug 看看会发生什么。您可以将其视为任何常规获取或发布请求。

我不知道为什么不使用它。在不了解任何背景的情况下，我无法就我是否会选择它给出明确的答案，但总的来说，没有理由不使用它，只需应用与 HTTP 获取和发布请求相同的安全性，就像在常规表单提交中一样.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-11T20:21:56.313

它与规则 GET 和 POST 具有相同的安全风险，它只是另一种来回发送数据的格式。如果您使用的是常规 POST，那么任何人都可以看到相同的用户 ID。

因此，如果您不想让人们弄乱用户 ID，您可以添加某种依赖于用户 ID 的加密字符串以进行验证，以命名许多可能的解决方案之一。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-11T20:12:41.887

JSON 本身没有安全性，它是一种未加密的数据格式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-11T20:23:49.540

JSON 可以像页面一样利用 FormsAuthentication 安全性。如果我不希望最终用户看到标识符，我通常会在 User.Identity.Name 中存储该值（或我可以用来查找该值的东西）。

这种方法最复杂的部分是，如果您未通过身份验证，JSON 可能不会返回任何内容。为了解决这个问题，我倾向于包含一个未经身份验证的页面，让 JSON 告诉你用户是否登录。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-11T20:34:48.473

我在隐藏字段中隐藏用户 ID 参数，只是担心在该过程中可以更改它。感谢您的所有支持

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-03-17T12:23:40.447

如果用户 ID 在隐藏的表单域中，那么它完全暴露给在浏览器中查看源代码的任何人。他们不仅可以看到 userId，还可以看到您如何将其发送到服务器。

通常，您永远不会信任敏感数据的客户端。假设他们总是可以操纵响应。

安全传递消息的方法是以字符串的形式给用户一些会话令牌。此会话令牌应以相当多的随机性生成，并将其用户名包含在算法中。查看有关 md5 和 salting 的资源。有了你给他们的这个令牌，现在的假设是他们不能对内容进行逆向工程。由于他们没有算法（它位于服务器端），因此他们无法篡改它。当然，您的服务器必须解密会话令牌才能检索用户 ID。

这本身并不意味着您的应用程序是完全安全的——它只是解决了许多潜在问题之一。

# .net - 如何分发 .NET 应用程序？

> ID：433567
> 
> 赞同：5
> 
> 时间：2009-01-11T20:08:50.460
> 
> 标签：.net, installation, clr

在我开始开发桌面应用程序之前，我想知道如果我在 .NET 中构建它，安装程序会变成多大？

现在 .NET 可能已经 5 岁了。我们还需要在应用程序中包含运行时间吗？或者我们可以假设大多数用户都会在他们的系统上安装它？Vista 是否预装了 .NET？最后，我们可以安全地假设大多数 XP 用户已经在他们的系统上安装了 CLR 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-11T20:11:59.143

您不需要包含运行时，安装程​​序会检测它是否存在于用户的机器上，如果不存在则要求安装。现在可以安全地假设大多数 XP 用户都拥有 CLR。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-11T20:18:26.587

查看[Clickonce](http://msdn.microsoft.com/en-us/library/t71a733d(VS.80).aspx)部署。如果你问我，真的很好的分配系统。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-11T20:12:52.837

这取决于您希望如何分发应用程序。如果您将它放在 CD 上，那么将可再分发的内容一起发送是有意义的。否则，如果您通过 Web 分发它，.NET 客户端配置文件只有 25 兆字节。如果它不可用，您可以配置您的设置以下载它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-11T20:18:41.967

很容易确定您所针对的 .NET 版本是否已安装，如果未安装，请指导用户在何处下载它。我不喜欢重新发布安装程序引导程序；这是黑客会做的事情。让用户直接从源头获取。

Vista 附带 3.5。 ~~XP SP2 附带 2.0~~ .NET 2.0 需要 XP SP2，但 XP 系统从不默认安装 .NET；它总是可选的。这几乎是任何 MS 桌面系统的最低规格。如果他们运行的是 XP sp1 或更早版本，我会避免使用它们，除非您有特定要求（嵌入式系统、愚蠢/顽固的用户群等）。

*编辑：我可以发誓 SP2 附带 .NET 2.0，但我找不到任何关于此的确切信息。*

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-11T20:17:20.147

.NET 包含在 XP 的 Service Pack 2 中，大约在 2004 年左右..所以我想说可以假设大多数人现在都拥有它。

# linq-to-sql - 实体框架查询与分组（多对多）

> ID：433570
> 
> 赞同：1
> 
> 时间：2009-01-11T20:10:17.943
> 
> 标签：linq-to-sql, ado.net, ado.net-entity-data-model

我有一个经典的多对多场景，其中包含三个表（学生、课程和第三个学生课程分配表）。

我在我的新项目中使用 EF 并且 EF 设计器没有创建第三个表。我需要选择所有课程以及分配给它的学生人数。使用纯 SQL 非常简单：

```
select c.Id, c.Name, Count(sc.*) as StudentCount 
from Courses c left join StudentCourses sc on(c.Id=sc.CourseId)
group by c.Id, c.Name 
```

但我不知道如何将此查询转换为 Linq to SQL。请指教。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T22:01:48.013

EF 设计器隐藏表格。它仍然存在，但它只是为您创建了关联，因此您可以参考课程中的学生，反之亦然。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-09-22T12:11:39.777

你可以这样做：

```
var list = from c in context.Courses
           from s in c.Students
           select new
           {
             StudentName=s.Name,
             Class=s.Class,
           }; 
```

有关更多信息，请查看[此页面](http://learnentityframework.com/LearnEntityFramework/tutorials/many-to-many-relationships-in-the-entity-data-model/)

# language-design - 为什么 C# 和 Java 会为“new”运算符而烦恼？

> ID：433591
> 
> 赞同：18
> 
> 时间：2009-01-11T20:18:17.537
> 
> 标签：language-design, new-operator

为什么[new 运算符](http://msdn.microsoft.com/en-us/library/fa0ab757.aspx)存在于 C# 和 Java 等现代语言中？它是纯粹的自我记录代码功能，还是有任何实际用途？

例如下面的例子：

```
Class1 obj = new Class1();

Class1 foo()
{
    return new Class1();
} 
```

就像 Pythonesque 的写法一样容易阅读：

```
Class1 obj = Class1();

Class1 foo()
{
    return Class1();
} 
```

编辑：[考恩](https://stackoverflow.com/users/17041/cowan)在澄清问题时一针见血：他们为什么选择这种语法？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-11T20:23:20.960

1.  这是一个自我记录的功能。
2.  这是一种可以在其他类中命名方法“Class1”的方法

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-11T20:24:33.967

```
Class1 obj = Class1(); 
```

在 C# 和 Java 中，您需要“new”关键字，因为没有它，它将“Class1()”视为对名为“Class1”的方法的调用。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-11T21:04:44.853

有用的是文档 - 与 Python 相比，区分对象创建和方法调用更容易。

原因是历史性的，直接来自 C++ 语法。*在 C++ 中，“Class1()”是在堆栈上*创建 Class1 实例的表达式。例如：vector a = vector(); 在这种情况下，会创建一个向量并将其复制到向量 a（优化器在某些情况下可以删除冗余副本）。

相反，“new Class1()”*在堆上*创建一个 Class1 实例，就像在 Java 和 C# 中一样，并返回一个*指向*它的指针，使用不同的访问语法，这与 Java 和 C++ 不同。实际上，new 的含义可以重新定义为使用任何特殊用途的分配器，它仍然必须引用某种堆，以便可以通过引用返回获得的对象。

此外，在 Java/C#/C++ 中，Class1() 本身可以引用任何方法/函数，这会造成混淆。Java 编码约定实际上会避免这种情况，因为它们要求类名以大写字母开头，方法名以小写字母开头，这可能是 Python 在这种情况下避免混淆的方式。读者希望“Class1()”创建一个对象，“class1()”是一个函数调用，“x.class1()”是一个方法调用（其中“x”可以是“self”）。

最后，由于在 Python 中他们选择将类作为对象，尤其是可调用对象，因此允许使用没有“new”的语法，并且允许同时使用另一种语法是不一致的。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-11T20:41:39.253

C# 中的 new 运算符直接映射到调用的 IL 指令，该指令`newobj`实际上为新对象的变量分配空间，然后执行构造函数（在 IL 中称为 .ctor）。在执行构造函数时——很像 C++——对初始化对象的引用作为不可见的第一个参数传入（如[thiscall](http://msdn.microsoft.com/en-us/library/ek8tkfbw(VS.71).aspx)）。

类似于 thiscall 的约定允许运行时仅一次为特定类加载和 JIT 内存中的所有代码，并为该类的每个实例重用它。

Java 在它的中间语言中可能有类似的操作码，虽然我不太熟悉。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-11T21:21:12.043

C++ 为程序员提供了在堆上或栈上分配对象的选择。

基于堆栈的分配[更有效](https://stackoverflow.com/questions/161053)：分配更便宜，释放成本真正为零，并且该语言在划分对象生命周期方面提供了帮助，降低了忘记释放对象的风险。
另一方面，在 C++ 中，在发布或共享对基于堆栈的对象的引用时需要非常小心，因为基于堆栈的对象会在堆栈帧展开时自动释放，从而导致指针悬空。

使用**`new`operator**，所有对象都在 Java 或 C# 中的堆上分配。

> Class1 obj = Class1();

实际上，编译器会尝试找到一个名为`Class1()`.

例如，以下是一个常见的 Java 错误：

```
public class MyClass
{
  //Oops, this has a return type, so its a method not a constructor!
  //Because no constructor is defined, Java will add a default one.
  //init() will not get called if you do new MyClass();
  public void MyClass()
  {
     init();
  }
  public void init()
  {
     ...
  }
} 
```

* * *

注意：“所有对象都在堆上分配”并不意味着偶尔不会在后台使用堆栈分配。

例如，在 Java 中，像[**逃逸分析**](http://en.wikipedia.org/wiki/Escape_analysis)这样的热点优化使用堆栈分配。

运行时编译器执行的这种分析可以得出结论，例如，堆上的对象仅在方法中被本地引用，并且没有任何引用可以从这个范围中逃脱。如果是这样，Hotspot 可以应用运行时优化。它可以在堆栈上或寄存器中分配对象，而不是在堆上。

虽然这种优化并不总是[被认为是](http://blog.xebia.com/2007/12/21/did-escape-analysis-escape-from-java-6/) [决定性](http://www.infoq.com/articles/java-threading-optimizations-p1)的......

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-13T22:22:05.417

Java 选择它的原因是因为 C++ 开发人员熟悉该语法。C# 之所以选择它，是因为它为 Java 开发人员所熟悉。

在 C++ 中使用运算符的原因`new`可能是因为在手动内存管理中，明确何时分配内存非常重要。虽然 pythonesque 语法可以工作，但它使得内存分配不太明显。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-11T20:22:53.473

new 运算符为对象分配内存，这是它的目的；正如您所说，它还自我记录您正在使用*的*实例（即新实例）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-07-15T17:14:49.293

正如其他人所指出的，Java 和 C# 提供了`new`语法，因为 C++ 提供了。C++ 需要某种方法来区分在堆栈上创建对象、在堆上创建对象或调用返回指向对象的指针的函数或方法。

C++ 使用这种*特殊*语法是因为早期的面向对象语言 Simula 使用了它。Bjarne Stroustrup 受到 Simula 的启发，并试图在 C 中添加类似 Simula 的功能。C 具有分配内存的函数，但不保证也调用构造函数。

摘自“C++ 的设计和演变”，1994 年，Bjarne Stroustrup 着，第 57 页：

> 因此，我引入了一个运算符来确保完成分配和初始化：
> 
> `monitor* p = new monitor;`
> 
> 调用该运算符是`new`因为那是相应 Simula 运算符的名称。运算符调用一些分配函数来获取内存，然后`new`调用构造函数来初始化该内存。组合操作通常称为实例化或简称为对象创建：它从原始内存中创建一个对象。
> 
> 操作员提供的符号便利性`new`非常重要。……”

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-01-11T22:16:50.573

除了以上 AFAIK 的评论外，他们还计划在早期草案中删除 Java 7 的新关键字。但后来他们取消了。

# function - 函数应用：这里为什么用$？

> ID：433595
> 
> 赞同：8
> 
> 时间：2009-01-11T20:19:21.840
> 
> 标签：function, haskell, operators, pointfree

前段时间，我问了一个[关于 $](https://stackoverflow.com/questions/395995/when-should-i-use-and-can-it-always-be-replaced-with-parentheses)的问题，得到了有用的答案——事实上，我以为我理解了如何使用它。

看来我错了:(

此示例显示在教程中：

```
instance Monad [] where
   xs >>= f = concat . map f $ xs 
```

我一生都无法理解为什么在那里使用 $ ；ghci 也没有帮助我，因为即使我在那里进行的测试似乎也显示出与简单地省略 $ 的版本等价。有人可以为我澄清一下吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-11T21:08:17.343

在`$`这里使用 是因为它的优先级低于普通函数应用程序。编写此代码的另一种方法是：

```
instance Monad [] where
   xs >>= f = (concat . map f) xs 
```

这里的想法是首先构造一个函数 ( `concat . map f`)，然后将其应用于它的参数 ( `xs`)。如图所示，这也可以通过简单地在第一部分周围加上括号来完成。

请注意，`$`在原始定义中省略 是不可能的，这将导致类型错误。这是因为函数组合运算符 (the `.`) 的优先级低于普通函数应用程序，从而有效地将表达式转换为：

```
instance Monad [] where
  xs >>= f = concat . (map f xs) 
```

这没有意义，因为函数组合运算符的第二个参数根本不是函数。尽管以下定义确实有意义：

```
instance Monad [] where
  xs >>= f = concat (map f xs) 
```

顺便说一句，这也是我更喜欢的定义，因为在我看来它更清晰。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-11T22:43:27.057

我想解释一下为什么恕我直言，这不是那里使用的样式：

```
instance Monad [] where
  xs >>= f = concat (map f xs) 
```

`concat . map f`是所谓的pointfree-style写作的一个例子；其中 pointfree 的意思是“没有应用点”。请记住，在数学中，在表达式`y=f(x)`中，我们说那`f`是应用在点上`x`。在大多数情况下，您实际上可以执行最后一步，替换：

```
f x = something $ x 
```

和

```
f = something 
```

喜欢`f = concat . map f`，这实际上是无点风格。哪个更清楚是有争议的，但无点风格给出了不同的观点，这也很有用，所以有时即使在不完全需要时也会使用。

编辑：在我应该感谢 Alasdair 的评论之后，我用 pointfree 替换了无意义的并修复了一些示例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T10:46:20.547

这里使用 $ 的原因是 (.) 的类型签名：

```
(.) :: (b -> c) -> (a -> c) -> a -> c 
```

在这里我们有

```
map f :: [a] -> [[b]] 
```

和

```
concat :: [[b]] -> [b] 
```

所以我们最终得到

```
concat . map f :: [a] -> [b] 
```

(.) 的类型可以写成

(.) :: ([[b]] -> [b]) -> ([a] -> [[b]]) -> [a] -> [b]

如果我们使用`concat . map f xs`，我们会看到

```
map f xs :: [[b]] 
```

因此不能与 (.) 一起使用。（类型必须是 (.) :: (a -> b) -> a -> b

# c++ - （编码）C++ 中的字符串处理 - 问题/最佳实践？

> ID：433618
> 
> 赞同：3
> 
> 时间：2009-01-11T20:26:36.943
> 
> 标签：c++, string, unicode

在 C++ 中处理字符串的最佳实践是什么？我特别想知道如何处理以下情况：

*   文本和 XML 文件的文件输入/输出，可以用不同的编码编写。处理此问题的推荐方法是什么，以及如何检索这些值？我想，一个 XML 节点可能包含 UTF-16 文本，然后我必须以某种方式处理它。

*   如何处理`char*`字符串。毕竟，这可以是无符号的，我想知道我如何确定他们使用什么编码（ANSI？），以及如何转换为 UTF-8？是否有任何推荐阅读，其中记录了 C/C++ 关于字符串的基本保证？

*   UTF-8 等字符串的字符串算法——计算长度、解析等。如何做到最好？

*   什么字符类型是真正可移植的？我了解到它`wchar_t`可以是 8-32 位宽的任何东西，如果我想跨平台保持一致（特别是在不同平台之间移动数据时 - 这似乎是一个问题，例如[EASTL中所述），这不是一个好的选择，请看第 13 条](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2271.html#Appendix)）

目前，我`std::string`到处都在使用，在调用 Unicode-API 时使用一个小的帮助实用程序来转换为 UTF-16，但我很确定这并不是最好的方法。使用 Qt`QString`或 ICU String 类似乎是正确的，但我想知道是否有更轻量级的方法（即，如果我的`char`字符串是 ANSI 编码的，并且使用的 ANSI 子集等于 UFT-8，那么我可以轻松地将数据视为 UTF-8 并提供从/到 UTF-8 的转换器，我已经完成了，因为我可以将它存储在 中`std::string`，除非这种方法存在问题）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-11T22:31:29.017

对于更简短的答案，为了简单起见，我建议使用 UTF-16；为了简单起见，Java/C#/Python 3.0 完全切换到该模型。我一直期望 wchar_t 为 16 位或 32 位宽，许多平台都支持这一点；实际上，像 wcrtomb() 这样的 API 不允许实现支持 wchar_t* 的转换状态，但由于 UTF-8 不需要，因此可以使用它，同时排除其他编码。

然后，我回答关于 XML 的问题。

> 文本和 XML 文件的文件输入/输出，可以用不同的编码编写。处理此问题的推荐方法是什么，以及如何检索这些值？我想，一个 XML 节点可能包含 UTF-16 文本，然后我必须以某种方式处理它。

我不确定，但我不这么认为。在同一个文件中混合两种编码会带来麻烦和数据损坏。以 UTF-16 编码文件通常是一个糟糕的选择，因为大多数程序都依赖于在任何地方使用 ASCII。问题是：XML 文件可能使用任何单一编码，甚至可能使用 UTF-16，但初始编码声明也必须使用 UTF-16，甚至标签。我看到 UTF-16 的问题是：如何可靠地解析初始声明？答案来自规范:, § 4.3.3:

> 在没有外部传输协议（例如 HTTP 或 MIME）提供的信息的情况下，包含编码声明的实体以声明中指定的编码以外的编码呈现给 XML 处理器，或者对于既不以字节顺序标记也不以编码声明开头以使用 UTF-8 以外的编码的实体。请注意，由于 ASCII 是 UTF-8 的子集，普通 ASCII 实体并不严格需要编码声明。

阅读时，请注意 XML 文件也是一个实体，称为文档实体；一般来说，实体是文档的存储单元。从整个规范中，我会说每个实体只允许一个编码声明，并且在阅读它们时我会将所有实体转换为 UTF-16 以便于处理。

网志：

*   [http://www.w3.org/TR/REC-xml/，XML](http://www.w3.org/TR/REC-xml/)规范。
*   [http://www.xml.com/axml/testaxml.htm](http://www.xml.com/axml/testaxml.htm)，带注释的 XML 规范。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-11T22:09:23.540

> UTF-8 等字符串的字符串算法——计算长度、解析等。如何做到最好？

mbrlen 为您提供 C 字符串的长度。我认为 std::string 不能用于多字节字符串，您应该将 wstring 用于宽字符串。

一般来说，您应该在程序中坚持使用 UTF-16，并且仅在 I/O 上使用 UTF-8（我不太了解其他选项，但它们肯定更复杂且容易出错）。

> 如何处理 char* 字符串。毕竟，这可以是无符号的，我想知道我如何确定他们使用什么编码（ANSI？），以及如何转换为 UTF-8？是否有任何推荐阅读，其中记录了 C/C++ 关于字符串的基本保证？

基本上，您可以使用任何编码，并且您会碰巧使用您正在运行的系统的本机编码，只要它是 8 位编码。C 是为 ASCII 而生的，语言环境处理是事后才想到的。多年来，每个系统都主要理解一种本机编码，例如 ISO-8859-x，而来自另一种编码的文件甚至可能无法表示。

因为对于 UTF-8 字符串，一个字节并不总是一个字符，我*想*最安全的选择是对它们使用多字节字符串。我使用的 C 手册抽象地描述了多字节字符串，没有详细说明这些问题（特别是使用的编码）。对于 C，请参见 mbrlen 和 mbrtowc 等函数。在我的 Linux 系统上，注意到它们的行为取决于 LC_CTYPE，这可能意味着多字节字符串的本机类型。从文档中可以推断出他们的 API 也支持编码，您可以在其中从一字节转换为两字节并返回。

> 如何处理 char* 字符串。毕竟，这可以是未签名的，也可以是不签名的，

如果您依赖 char 的签名，那么您做错了。仅当您将 char 用作数字类型时，字符的签名才重要，然后您应该始终使用无符号或有符号字符；实际上，您应该假设普通 char 既不是无符号也不是有符号的，并且像`a > 0`（如果 a 是 char）这样的表达式具有未定义的语义。但无论如何，它有什么用处？

# grails - Grails 域类、String 字段 TEXT 和 LONGTEXT

> ID：433621
> 
> 赞同：41
> 
> 时间：2009-01-11T20:27:39.390
> 
> 标签：grails

在 Grails 域类中，如何设置 String 字段的约束，使其 MySQL 列类型为 TEXT 或 LONGTEXT？

到目前为止，我最好的方法是设置约束的大小：

```
myTextField(size:0..65535) 
```

这导致文本

```
myTextField(size:0..2147483646) 
```

结果为 LONGTEXT (2147483646 = 2^32 / 2 - 1 - 1)

有没有更简洁的方法来指定尺寸？基本上我想要完整的 TEXT 或 LONGTEXT 范围，而不必硬编码一堆大小值。

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2009-01-11T21:42:59.957

您可以在 Domain 类的映射闭包中声明：

```
static mapping = {
   myTextField type: 'text'
} 
```

（参见[ORM DSL 文档](http://grails.org/doc/latest/guide/single.html#ormdsl)）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-03-26T14:26:28.447

使用 sqlType 将允许您进行更细粒度的约束

```
Class Foo{
    String myTxtAsVarchar
    String myTxtAsText
    String myTxtAsLtext

    static mapping = {
       myTxtAsVarchar  sqlType: 'varchar(255)'
       myTxtAsText     sqlType: 'text'
       myTxtAsLtext    sqlType: 'longText' 
    }
    /*applying constraint on DB end + on Domain model(scaffolding/Validation)*/
    static constraints = {
           myTxtAsVarchar  size: 2..255
           myTxtAsText     size: 2..15000
     }
} 
```

使用 SQL 类型还提供了实际的 Blob 类型（默认情况下链接到 tinyBlob 的字节类型）

此处详细介绍了更多映射：[https ://grails.github.io/grails-doc/latest/ref/Database%20Mapping/column.html](https://grails.github.io/grails-doc/latest/ref/Database%20Mapping/column.html)

# javascript - 连接两个 JSON 对象

> ID：433627
> 
> 赞同：92
> 
> 时间：2009-01-11T20:29:54.893
> 
> 标签：javascript, json

我有两个具有相同结构的 JSON 对象，我想使用 Javascript 将它们连接在一起。是否有捷径可寻？

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2009-01-12T00:07:36.327

根据您在评论中的描述，您只需做一个数组连接：

```
var jsonArray1 = [{'name': "doug", 'id':5}, {'name': "dofug", 'id':23}];
var jsonArray2 = [{'name': "goud", 'id':1}, {'name': "doaaug", 'id':52}];
jsonArray1 = jsonArray1.concat(jsonArray2);
// jsonArray1 = [{'name': "doug", 'id':5}, {'name': "dofug", 'id':23}, 
//{'name': "goud", 'id':1}, {'name': "doaaug", 'id':52}]; 
```

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-01-11T20:50:44.587

如果您想复制属性：

```
var json1 = { value1: '1', value2: '2' };
var json2 = { value2: '4', value3: '3' };

function jsonConcat(o1, o2) {
 for (var key in o2) {
  o1[key] = o2[key];
 }
 return o1;
}

var output = {};
output = jsonConcat(output, json1);
output = jsonConcat(output, json2); 
```

上面代码的输出是`{ value1: '1', value2: '4', value3: '3' }`

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2017-06-24T08:26:02.653

实际的方法是使用 JS Object.assign。

```
Object.assign(target, ...sources) 
```

[MDN 链接](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Object/assign)

还有另一个对象扩展运算符，它是为 ES7 提出的，可以与 Babel 插件一起使用。

```
 Obj = {...sourceObj1, ...sourceObj2} 
```

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2018-09-10T23:16:46.873

我用：

```
let x = { a: 1, b: 2, c: 3 }

let y = {c: 4, d: 5, e: 6 }

let z = Object.assign(x, y)

console.log(z)

// OUTPUTS:
{ a:1, b:2, c:4, d:5, e:6 } 
```

从[这里](https://www.quora.com/How-can-I-add-two-JSON-objects-into-one-object-JavaScript)。

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2015-03-24T16:17:34.960

您可以使用 jquery[扩展](http://api.jquery.com/jquery.extend/)方法。

例子：

```
o1 = {"foo":"bar", "data":{"id":"1"}};
o2 = {"x":"y"};
sum = $.extend(o1, o2); 
```

结果：

```
sum = {"foo":"bar", "data":{"id":"1"}, "x":"y"} 
```

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2009-01-11T20:40:33.203

一种解决方案是使用列表/数组：

```
var first_json = {"name":"joe", "age":27};
var second_json = {"name":"james", "age":32};

var jsons = new Array();
jsons.push(first_json);
jsons.push(second_json); 
```

**结果**

```
jsons = [
    {"name":"joe", "age":27},
    {"name":"james", "age":32}
] 
```

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2019-06-14T07:55:40.493

如果使用 TypeScript，您可以使用扩展运算符 ( `...`)

```
var json = {...json1,...json2} 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2018-07-03T18:00:27.703

您可以使用**Object.assign()**方法。Object.assign() 方法用于将所有可枚举自身属性的值从一个或多个源对象复制到目标对象。它将返回目标对象。[[1]](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign)

```
var o1 = { a: 1 }, o2 = { b: 2 }, o3 = { c: 3 };

var obj = Object.assign(o1, o2, o3);
console.log(obj); // { a: 1, b: 2, c: 3 } 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-01-11T21:24:20.807

好的，你可以在一行代码中做到这一点。为此，您将需要 json2.js（您可能已经拥有。）。这里的两个 json 对象是未解析的字符串。

```
json1 = '[{"foo":"bar"},{"bar":"foo"},{"name":"craig"}]';

json2 = '[{"foo":"baz"},{"bar":"fob"},{"name":"george"}]';

concattedjson = JSON.stringify(JSON.parse(json1).concat(JSON.parse(json2))); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-12-08T12:51:24.867

试试这个，使用下划线

```
var json1 = [{ value1: '1', value2: '2' },{ value1: '3', value2: '4' }];
var json2 = [{ value3: 'a', value4: 'b' },{ value3: 'c', value4: 'd' }];
var resultArray = [];
json1.forEach(function(obj, index){
  resultArray.push(_.extend(obj,  json2[index]));
});

console.log("Result Array", resultArray); 
```

结果

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-12T05:05:57.707

```
var baseArrayOfJsonObjects = [{},{}];
for (var i=0; i<arrayOfJsonObjectsFromAjax.length; i++) {
    baseArrayOfJsonObjects.push(arrayOfJsonObjectsFromAjax[i]);
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-11-11T03:21:29.570

我用：

```
let jsonFile = {};    
let schemaJson = {};    
schemaJson["properties"] = {};    
schemaJson["properties"]["key"] = "value";
jsonFile.concat(schemaJson); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-10-02T23:49:28.260

最简单的方法：

```
const json1 = { value1: '1', value2: '2' };
const json2 = { value2: '4', value3: '3' };

const combinedData = {
  json1,
  json2
};

console.log(combinedData) 
```

# c - 为什么我的作业有逻辑错误？

> ID：433628
> 
> 赞同：1
> 
> 时间：2009-01-11T20:29:57.513
> 
> 标签：c, fencepost

我是 IT 专业的大三学生。我面临程序输出的问题。该程序的想法是我应该使用函数来读取 10 个元素的数组，然后获取元素的平均值，然后获取最大值和最小值。我有正确的最大值和最小值，但平均值显示奇怪的东西。请检查代码并告诉我应该做什么或以某种方式帮助我。

输出是（请注意，它请求的是 11 个数字而不是 10，如果我更改循环参数以让它只占用 10 个，那么它会显示奇怪的东西

```
enter the group of integers numbers
1
2
3
4
5
6
7
8
9
0
9
 1 2 3 4 5 6 7 8 9 0the avg is 3.500000
9
1Press any key to continue . . .

// func-sortarray.cpp : Defines the entry point for the console application.
//

#include "stdafx.h"
#define size  10

void readarray(int []);
void average(int []);
void printArray(int []);
void max(int []);
void min(int []);

int _tmain(int argc, _TCHAR* argv[])
{
    int sarray[size];
    readarray(sarray);
    printArray(sarray);
    average(sarray);
    max(sarray);
    min(sarray);
    return 0;
}

void readarray(int a[])
{
    printf("enter the group of integers numbers\n");
    for (int i=0; i<=size-1 ;i++)
        scanf("%d\n",&a[i]);
}

void average(int a[])
{
    int i;
    double avg;
    double total = 0;
    for (i=0; i <= size-1; i++)
    {
        total = total + a[i];
    }

    avg = total /size-1;
    printf("the avg is %f\n",avg);
}

void printArray(int a[])
{
    int j;
    for (j = 0; j <= size - 1; j++) 
        printf( "%2d", a[ j ]);
}

void max(int a[])
{
    int ma =a[0];

    for (int j=0;j<size-1;j++)
    {
        if (ma<a[j])
            ma=a[j];
    }
    printf("%d",ma);
}

void min(int a[])
{
    int mi =a[0];

    for (int j=0;j<size-1;j++)
    {
        if (mi>a[j])
            mi=a[j];
    }
    printf("\n%d",mi);
} 
```

提前谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-11T20:42:58.207

在加法规则之前*从零开始计数*和*乘法*时会遇到一些问题。好吧，让我们开始吧。最常见的是，当您从零开始计数时，您会这样做：

```
for(i=0; i < count; i++)
    /* ... */; 
```

如果你从 1 开始数，你可以这样做：

```
for(i=1; i <= count; i++)
    /* ... */ 
```

如果你混合这些，你会得到相同的结果，但它会让你自己和其他阅读代码的人感到困惑：

```
for(i=0; i <= count-1; i++) /* same, but better don't do this */
    /* ... */; 
```

在计算平均值的代码中，您有两个错误。首先，由于数学原因，您应该使用括号：

```
avg = total / (size-1); /* there is still one bug */ 
```

其次，你*有* `size`元素。所以你必须除以`size`，而不是`size-1`：

```
avg = total / size; /* right ! */ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-11T20:38:03.003

这条线可能是问题所在：

```
avg = total /size-1; 
```

您可能希望改为：

```
avg = total / size; 
```

此外，你的`max()`和`min()`函数有一个这样的循环：

```
for (int j=0;j<size-1;j++) 
```

这可能检查的数字比您想要的少一个。

上述类型的错误通常称为“栅栏错误”。该名称与以下问题有关：如果您要建造 100 m 长的栅栏，并且希望每 1 m 有一个栅栏，您需要多少栅栏？答案不是 100，而是 101。这种类型的错误的另一个名称是“off by one error”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-11T20:50:12.793

由于 scanf() 字符串中的 '\n' ，它正在跳过第一个输入数字。要修复它，请从 scanf 字符串中删除 '\n'，如下所示：

```
scanf("%d", &a[i]); 
```

# .net - WPF 生产准备好了吗？

> ID：433630
> 
> 赞同：11
> 
> 时间：2009-01-11T20:32:06.853
> 
> 标签：.net, wpf

我想知道是否有人有 WPF 应用程序开发经验——也许更有趣——在生产中运行 WPF。

它是否足够成熟，可以在更大的项目中使用？有哪些明显的陷阱？有什么最佳实践吗？（WPF 中的数据绑定看起来很漂亮，但它在“真实”项目中有效吗？）

提前致谢！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-11T20:46:08.557

WPF 与 .NET 3.0 一起出现。我们在 3.5 sp1 上，所以如果它没有准备好生产，MS 有很多 essplainin' 要做。坦率地说，当 3.0 发布时，它已经准备好生产了。

我目前正在开发一个使用 WPF 进行模板和数据绑定的项目（不是用于 UI 显示，但我使用 UI 类来定义模板）。我也将 WPF 用于个人资料。而且，坦率地说，我必须被狠狠地殴打才能考虑使用 Windows 窗体作为 UI。WPF 以其简单性和灵活性而著称。它的数据绑定设施与被破解的窗口表单绑定模型相比是壮观的。恕我直言，XAML 是软件设计中的革命性一步。

WPF 中的数据绑定不仅漂亮，它还允许您实现一些非常好的架构设计。 [这是一篇很好的文章，涵盖了一些更受欢迎的文章。](http://blogs.sqlxml.org/bryantlikes/archive/2006/09/27/WPF-Patterns.aspx) 可以把它想象成类固醇上的 MVC/MVP。

长话短说，跑。不要走路。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-11T21:39:02.850

我不确定它对于大型事物是否成熟，但如果那是你的一杯茶，它肯定已经为中型数据库驱动的应用程序做好了准备。我用WPF+SQL Server 2008做了一个病人管理系统，没那么麻烦。

陷阱 - 我有一种**字体**。说真的，你如何解释你的非技术客户，没有什么可以改善 XP 上的 WPF 字体渲染？这个领域非常痛苦，而且看起来微软并没有解决这个问题。（如果我错了，请纠正我。）

最佳实践？嗯，是的，你提到了数据绑定，它工作得很好，尽管它当然会在一定程度上抑制清晰的层分离。实际上，我认为从 WinForms 时代继承的大多数意识形态仍然适用，前提是您已经设法开始以不同的方式思考 UI。我对 WPF 的最佳实践是使用代码生成将数据库映射到保存在`WrapPanel`. 事实上，这些环绕面板很棒，因为它们可以缩放到*任何*屏幕尺寸，而且布局实际上感觉流畅自然。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-11T22:01:06.737

我会说是的，它已经准备好生产了，并且已经有一段时间了，但是有一些警告：

1.  工具远非完美。Visual Studio 的设计表面很糟糕，尽管文本模式下的自动完成功能很好。Blend 是一款出色的产品，但仍然不稳定（它确实不应该如此），而且它与 XAML 的“松散耦合”可能非常烦人。
2.  表现。如果您开始使用花哨的图形、效果和动画（甚至是微妙的），那么您需要密切关注您的目标平台。很容易将一些东西放在一起，在您的开发平台上运行良好，但在“客户端”PC 上运行就像一头三足驴。
3.  学习曲线。虽然我认为 WPF 陡峭的学习曲线有点过分，但开始以“WPF 方式”思考确实需要一些时间，而且通常有很多方法可以完成大多数事情。例如，大多数开发人员将使用绑定/重新绑定而不是使用 ObservableCollection 等来创建他们的第一个 WPF 应用程序。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-20T12:48:18.457

代表一家主要目的是在应用程序中获取公司业务的小公司。我必须说 wpf 还没有准备好。

不是那么容易维护，也不是（非常）简单，并且开发人员在获得正确的 UI 而不是编写业务代码上浪费了太多时间。

我们将回到智能客户端；）

亲切的问候，维姆

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-11T21:04:19.457

其实我觉得答案是肯定的和否定的……

在我的经验中，没有任何部分是可用于 WPF 的工具。现在，这是一个非常陡峭的学习曲线，迫切需要的东西之一是使技术变得平易近人的好工具，例如表达式混合/工作室和 Visual Studio 的集成水平非常差。IMO简单的任务应该是简单的，复杂的任务应该是可能的，用WPF复杂的任务确实是可能的，但简单的任务也很复杂。

说了这么多，如果您确实完成了学习曲线，并且能够应对低于标准的工具，那么生成的应用程序肯定可以投入生产。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-20T13:56:05.340

重要的是你必须让自己适应 WPF，而不是试图让 WPF 适应你。你必须忘记你所知道的关于 UI 编程（winform 或 spring）的一切。如果您认为 WPF 就像 winform，那么您的生活将会很痛苦...这项技术已准备好用于生产，但可能不是您的代码...花时间了解 WPF 中的良好编程实践以及您使用 WPF 编写的代码将“准备好生产”。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-07-27T18:13:01.373

我在一个小团队中使用 WPF 的经验。

我会同意 Hypo 并说是和不是。

我是 3 位企业开发人员中的一位，我们从事体育行业，其中一个项目是锦标赛软件。我最近在 WPF 中重写了我们的分数/括号显示应用程序。显示器 100% 更漂亮，但这并不容易。来自 WinForms 的学习曲线很大，绑定功能强大但同样复杂。我在 VS 2008 中遇到了很多 WPF 问题，它每天至少使我的 IDE 崩溃一次，我经常不得不删除我的用户文件或打开项目文件上的属性会关闭我的 IDE。在 XP SP3 上运行动画似乎只有 50% 的 XP sp3 机器流畅，另外 50% 存在大量丑陋的伪影，并且表格似乎无法正确重绘。我的 XAML 编辑器有时会崩溃，我必须关闭选项卡并重新打开它。我引用的所有问题都在 4 台不同的机器上持续发生。

我对框架的最终回答是肯定的。拒绝我浪费了太多时间与我的 IDE 对抗的工具。不适合只需要快速推出一些业务应用程序的小型团队。一旦有更多的控件、主题、项目模板，它就可以在 VS 下工作。我可能会改变主意。

尽管我在学习 WPF/XAML 时遇到了激烈的痛苦，但与它一起工作仍然令人兴奋，我经常对你可以做的一些很酷的事情感到震惊。

# sql - 如何使用 Perl 的 DBI 中的绑定查询来选择为空的行？

> ID：433632
> 
> 赞同：6
> 
> 时间：2009-01-11T20:33:29.457
> 
> 标签：sql, perl, dbi

我希望能够将某些内容传递给 SQL 查询，以确定我是否只想选择某个列为空的那些。如果我只是构建一个查询字符串而不是使用绑定变量，我会这样做：

```
if ($search_undeleted_only)
{
    $sqlString .= " AND deleted_on IS NULL";
} 
```

但我想使用绑定查询。这会是最好的方法吗？

```
my $stmt = $dbh->prepare(...
    "AND (? = 0 OR deleted_on IS NULL) ");
$stmt->execute($search_undeleted_only); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-11T21:00:10.747

是的; 一个相关的技巧是，如果你有 X 个潜在的过滤器，其中一些是可选的，就是让模板说`" AND ( ?=-1 OR some_field = ? ) "`，并创建一个特殊的函数来包装执行调用并绑定所有第二个 ?s。（在这种情况下，-1 是一个特殊值，意思是“忽略此过滤器”）。

Paul Tomblin 的更新：我编辑了答案以包含评论中的建议。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-11T21:07:26.720

所以你依赖布尔表达式的短路语义来调用你的`IS NULL`条件？这似乎行得通。

一个有趣的点是，`1 = 0`查询优化器应该排除像这样没有参数的常量表达式。在这种情况下，由于优化器不知道表达式是常量`true`还是`false`直到执行时间，这意味着它无法将其分解。它必须评估每一行的表达式。

因此，相对于使用非参数化常量表达式的成本，可以假设这会为查询增加少量成本。

Then combining with `OR` with the `IS NULL` expression may also have implications for the optimizer. It might decide it can't benefit from an index on `deleted_on`, whereas in a simpler expression it would have. This depends on the RDBMS implementation you're using, and the distribution of values in your database.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-11T21:00:31.663

我认为这是一种合理的做法。它很好地遵循了正常的过滤器模式，并且应该提供良好的性能。

# php - PHP 中的对象和错误处理

> ID：433643
> 
> 赞同：1
> 
> 时间：2009-01-11T20:39:47.743
> 
> 标签：php, object

如果使用对象，处理错误的最佳做法是什么？

**A）**在对象的方法被调用之前，如果有一些错误，甚至没有执行方法，或者

**B）**只需传递参数并在方法本身中执行错误检查，返回错误代码或其他内容。

请选择您的选项和简短描述，为什么？

谢谢 orlandu63，这是一个很好的做法，但是非致命错误怎么办，例如用户应该为某事提供标题，而他/她没有？

```
class Sample {    

var $err_no_title = 1;

function createNewRecord ($title) {
       if (!$title) return $this->err_no_title;
    }
} 
```

或者也对这类错误使用异常？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-11T20:47:43.157

如果您使用的是 OO，那么您不妨使用 Exceptions。我的答案是A和B的混合：

```
class DatabaseConnectionException extends Exception {}

class Database {
    public function connect($user, $pass, $db) {
        //Connection stuff.
        if($baduser) {
            throw new DatabaseConnectionException('Username (' . $user. ') is invalid.')
         }
         if($badpass) {
             //''
         }
    }
}

$db = new Database;
try {
    $db->connect($user, $pass, $db);
catch (DatabaseConnectionException $e) {
    die('I cannot connect to the database:' . $e);
} 
```

这样做有什么好处？我不知道，但它似乎是正确的。

您可以在[http://php.net/exceptions](http://php.net/exceptions)和 google 上阅读更多信息。

关于你的第二部分，

首先，您的示例将其视为错误而不是“警告”，因为您退出了函数，因此如果您没有标题，则不要创建记录。这表明方法 B 是有缺陷的。所以方法A一直。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-11T21:03:58.663

要从您提供的选项中进行选择，它将是 B，但不要使用错误代码并引发[异常](http://cz2.php.net/exceptions)。所有逻辑（甚至输入验证）都应该封装在函数中。

原因是：

1.  功能可能会改变，因此可能会改变对输入的要求。
2.  您的功能的用户可能并不总是知道输入应该是什么样的。
3.  您肯定不想在使用该功能的任何地方重复验证代码。

不过要小心，因为异常仅由面向对象的代码引发。例如，此代码不会引发异常：

```
<?php  
  $number = $number / 0;
?> 
```

你的例子就像：

```
<?php
    class Sample {    
      function createNewRecord ($title) {
       if (!$title) throw new Exception('Title required');
      }
    }

    ...
    try {
      $mysample->createNewRecord($title);
    } catch ($ex) {
      echo "Could not create record. Please try again. (Reason: $ex)";
    }
    ...
?> 
```

首先，这种事情应该在用户界面中进行验证。所以它会是A，但B需要在那里。所以最终的判决是：两者兼而有之。

# svn - 当我尝试提交对目录的更改时，为什么 subversion 会超时？

> ID：433644
> 
> 赞同：1
> 
> 时间：2009-01-11T20:39:55.293
> 
> 标签：svn, file, ssl, filesystems

当尝试在我的工作副本的 jsunit 目录中提交文件时，我等了很长时间并收到如下错误：

```
svn: OPTIONS request failed on '/svn_repo/OSB_Project/trunk/OSB/test/web/jsunit'
svn: timed out waiting for server 
```

为什么服务器会在此时挂起？

在我保留 Subversion 服务器的 VirtualBox 中运行 SuSE 10.3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-13T01:19:12.640

好的，我自己解决了这个问题！

我在 subversion (.svn) 目录中的文件中查找短语“http”只是发现在文件“entries”中目录本身仍然指向不存在的 SSL subversion 服务器。我将文件指向文件系统上的存储库，现在它工作正常！

问题解决了！

# performance - Web 应用程序的可扩展性和性能，方法？

> ID：433647
> 
> 赞同：5
> 
> 时间：2009-01-11T20:41:46.150
> 
> 标签：performance, web-applications, web, scalability

您使用了哪些不同的方法和技术来成功解决网站的可扩展性和性能问题？我是一名 ASP.NET Web 开发人员，正在探索使用带有 SQL 集群的 WCF 进行 .NET 远程处理，并对存在哪些其他方法（例如“云”）感到好奇。在哪种情况下，您会应用各种方法（例如，方法 a 用于大约 x 多个“活跃”用户）。

我的意思的一个例子，一个 myspace 案例研究：[http ://highscalability.com/myspace-architecture](http://highscalability.com/myspace-architecture)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-11T23:11:39.607

这是一个非常广泛的问题，很难回答，但我会尝试提供一些一般性建议。

1 - 除非您做一些严重错误的事情，否则您可能不需要担心性能或规模，直到您达到大量流量（每月超过 100 万次页面浏览量）。

2 - 您最初最大的性能问题可能是来自其他国家/地区的页面加载时间。尝试[Gomez 实例站点测试](http://www.gomez.com/info_center/instant-test.php)以查看来自世界各地的页面加载时间，并使用 YSlow 作为优化指南。

3 - 当您确实开始遇到性能问题时，首先很可能是由于数据库工作。使用 SQL Server Profiler 检查您的 SQL 流量，寻找长时间运行的查询以尝试优化，并`dm_db_missing_index_details`用于查找您应该添加的索引。

4 - 如果您的 Web 服务器开始成为性能瓶颈，请使用分析器（例如 ANTS Profiler）来寻找优化网页代码的方法。

5 - 如果您的 Web 服务器优化得很好并且仍然运行太热，请寻找更多缓存机会，但您可能需要简单地添加更多 Web 服务器。

6 - 如果您的数据库优化得很好并且仍然运行太热，那么请考虑添加分布式缓存系统。在您每月的页面浏览量超过 1000 万之前，这可能不会发生。

7 - 如果您的数据库即使使用分布式缓存也开始不堪重负，那么请查看分片架构。在您每月的页面浏览量超过 1 亿次之前，这可能不会发生。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-11T23:32:50.717

我曾在一些获得数百万/点击次数/月的网站上工作过。以下是一些基础知识：

1.  缓存，缓存，缓存。缓存是减少网络服务器和数据库负载的最简单、最有效的方法之一。缓存页面内容、查询、昂贵的计算以及任何受 I/O 限制的内容。Memcache 非常简单有效。
2.  用完后使用多台服务器。您可以拥有多个 Web 服务器和多个数据库服务器（具有复制功能）。
3.  减少对您的网络服务器的总体请求数。这需要使用过期标头缓存 JS、CSS 和图像。您还可以将静态内容移动到 CDN，这将加快您的用户体验。
4.  衡量和基准。在您的生产机器上运行 Nagios 并在您的 dev/qa 服务器上进行负载测试。你需要知道你的服务器什么时候会着火，这样你才能防止它。

我建议阅读[Building Scalable Websites](https://rads.stackoverflow.com/amzn/click/com/0596102356)，它是由 Flickr 的一位工程师编写的，是一个很好的参考。

查看我关于可扩展性的博客文章，它有很多关于使用多种语言和平台进行扩展的演示链接： [http ://www.ryandoherty.net/2008/07/13/unicorns-and-scalability/](http://www.ryandoherty.net/2008/07/13/unicorns-and-scalability/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-11T20:48:42.127

MS有[速度，](http://blogs.msdn.com/velocity/) [MEMCache](http://code.jellycan.com/memcached/)现在有一个到 .NET 的端口，还有[indeXus.Net](http://www.sharedcache.com/cms/)

# css - 如何在 CSS 中将 RadioButton 图标样式设置为空（在 Flex 3 中）？

> ID：433654
> 
> 赞同：2
> 
> 时间：2009-01-11T20:44:11.183
> 
> 标签：css, apache-flex, flex3, radio-button, skinning

您可以通过在 CSS 中设置以下值来为 Flex 中的 RadioButton 设置外观：

```
upSkin: Embed(...); 
overSkin: Embed(...);
ownSkin: Embed(...);
disabledSkin: Embed(...);
selectedUpSkin: Embed(...);
selectedOverSkin: Embed(...);
selectedDownSkin: Embed(...);
selectedDisabledSkin: Embed(...); 
```

但是，它仍会在您的皮肤内显示小圆圈图标。您可以通过设置以下样式来更改图标：

```
upIcon: Embed(...);
overIcon: Embed(...);
etc... 
```

我的问题是，我怎样才能将这些图标设置为空？而不是 1x1 像素的透明图像之类的？我怎样才能给它一个空的样式？

**编辑：**

在 actionscript 我可以这样做：

```
button.setStyle("icon", null); 
```

在 CSS 中我尝试过：

```
icon: none;
icon: null; 
```

但都没有奏效。

**接受的答案：**

建议[一](https://stackoverflow.com/questions/433654/how-to-set-the-radiobutton-icon-style-to-nothing-in-css-in-flex-3#433852)和[二](https://stackoverflow.com/questions/433654/how-to-set-the-radiobutton-icon-style-to-nothing-in-css-in-flex-3#434540)都有效，但我更喜欢更清洁的解决方案：

```
upIcon: ClassReference(null); 
```

感谢您的两个答案（希望我可以将两者都标记为答案！）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-12T05:26:07.540

Try this:

```
ClassReference(null); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-11T22:22:35.057

I don't think it's possible to set the skin as `null` in Flex CSS. In fact, some Flex component **must** have something set for the skin, and they will throw runtime errors if you use `setStyle("skinName", null)`. I usually use a declaration like this when I want no skin:

```
RadioButton
{
    upIcon: ClassReference("mx.skins.ProgrammaticSkin");
} 
```

The `ProgrammaticSkin` class displays nothing and implements `IFlexDisplayObject` (which is often a requirement for skins in Flex), so I think it's the best choice for when you want a blank skin.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-11T20:49:51.967

If its standard CSS, you can use the following. I'm assuming the styles are classes, if they're IDs replace the . with a #:

```
.upSkin
{
    background: none;
} 
```

The `background` property can be used to set color, positioning, and repeating; if you need to specifically target just the background image use:

```
.upSkin
{
    background-image: none;
} 
```

# python - 后期绑定是否符合“可读性很重要”的理念？

> ID：433662
> 
> 赞同：1
> 
> 时间：2009-01-11T20:47:04.063
> 
> 标签：python, readability

对不起，我不是在这里责怪 Python。这只是对我所相信的是否正确的一种反思。作为两年的 Python 爱好者，我一直只写小应用程序，无论走到哪里，我都对 Python 赞不绝口。我最近有机会阅读 Django 的代码，并开始怀疑 Python 是否真的遵循其“可读性很重要”的理念。例如，

```
class A:
    a = 10
    b = "Madhu"

    def somemethod(self, arg1):
        self.c = 20.22
        d = "some local variable"
        # do something
        ....
        ...
    def somemethod2 (self, arg2):
        self.c = "Changed the variable"
        # do something 2
        ... 
```

`self.c`在使用时创建实例变量的情况下（即在上面的代码段中），很难跟踪代码流。在阅读大量以这种方式编写的代码时，不可能看到定义了哪些实例变量。即使阅读一个只有 6-8 个方法且不超过 100-150 行代码的类，它也会变得非常令人沮丧。

我很想知道我对这段代码的阅读是否受到 C++/Java 风格的影响，因为大多数其他语言都遵循与它们相同的方法。有没有更流利地阅读这段代码的 Pythonic 方式？是什么让 Python 开发人员采用这种策略来牢记“可读性”？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-11T21:21:42.107

您提供的代码片段相当不典型（这也可能是因为您可能编造了它）：

*   你通常不会有一个实例变量（self.c），它在某个点是一个浮点数，而在另一个点是一个字符串。它应该始终是数字或字符串。

*   您通常不会以任意方法将实例变量带入生活。相反，您通常有一个初始化所有变量的构造函数 (__init__)。

*   您通常没有名为 a、b、c 的实例变量。相反，他们有一些会说话的名字。

修复这些后，您的示例将更具可读性。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-11T21:20:38.037

一个足够有才华的恶棍可以用任何语言编写不可读的代码。Python 试图在结构和命名上强加一些规则，以推动编码人员朝着正确的方向前进，但没有办法强制这样做。

对于它的价值，我尝试将局部变量的范围限制在我使用的*每种*语言中使用它们的区域 - 对我来说，不必维护一个巨大的心理字典让自己重新熟悉一些代码容易得多。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-11T21:24:50.617

我同意您所看到的内容可能令人困惑，并且应该附有文档。但是任何语言都可能发生令人困惑的事情。

在您自己的代码中，您应该应用使您更容易维护代码的任何约定。关于这个特定问题，有许多可能的事情可以提供帮助。

*   使用[Epydoc](http://epydoc.sourceforge.net/)之类的东西，您可以指定一个类将具有的所有实例变量。对您的代码进行文档记录时要谨慎，并同样要确保您的代码和文档保持同步。
*   采用鼓励您发现最容易维护的代码类型的编码约定。没有什么比树立一个好榜样更好的了。
*   保持你的类和函数小而明确。如果它们变得太大，请将它们分开。更容易弄清楚发生了什么。
*   如果您**真的**想坚持在引用之前声明实例变量，您可以使用一些元类技巧。例如，您可以创建一个公共基类，使用元类逻辑强制执行这样的约定，即只有在声明子类时声明的变量才能在以后设置。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-11T21:39:50.883

这个问题很容易通过指定编码标准来解决，例如在对象的**init**方法中声明所有实例变量。这对 python 来说并不是一个真正的问题，就像程序员一样。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-11T20:53:15.207

如果代码正在做的事情由于某种原因变得神秘......应该有注释或函数名称应该让它显而易见。

这只是我的意见。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-11T21:00:05.473

我个人认为在 Python 中不必声明变量是危险的事情之一，尤其是在做类的时候。很容易通过简单的错误输入意外地创建一个变量，然后在代码中费尽心思，找不到错误。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-11T21:05:20.047

在您需要它之前添加一个属性会阻止您在它获得值之前使用它。就个人而言，我*总是*发现仅从阅读源代码就很难遵循课程 - 我阅读了文档并找出它应该做什么，然后当我再次阅读源代码时通常是有意义的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-11T22:05:35.247

允许使用此类东西的事实仅在极少数情况下对原型设计有用；虽然 Javascript 倾向于允许任何事情，也许这样的例子可以被认为是正常的（我真的不知道），但在 Python 中，这主要是省略类型声明的负面副产品，它可以帮助加快开发速度——如果你在某个时候改变你对变量类型的想法，修复类型声明可能比修复实际代码花费更多时间，在某些情况下，包括重命名类型，但也包括使用不同类型和一些类似方法但没有的情况超类/子类关系。

# c# - 如何在 C# 中为泛型类创建别名？

> ID：433668
> 
> 赞同：36
> 
> 时间：2009-01-11T20:49:10.160
> 
> 标签：c#, generics, syntax

如何在 C# 中执行以下操作？编写此代码片段第一行的正确方法是什么？

```
using KVP<K, V> = System.Collections.Generic.KeyValuePair<K, V>;

class C { KVP<int, string> x; } 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-01-11T20:53:22.757

你不能，基本上。您只能使用固定别名，例如：

```
using Foo = System.Collections.Generic.KeyValuePair<int, string>;

class C { Foo x; } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-31T10:22:13.433

在某些情况下，您可以使用继承：

```
public class MyList<T1, T2> : List<Tuple<IEnumerable<HashSet<T1>>, IComparable<T2>>> { }

public void Meth()
{
    var x = new MyList<int, bool>();
} 
```

虽然不是在您的特定情况下，因为 KeyValuePair 是密封的:-(

# python - 使用算法分析python列表以计算日期范围内的出现次数

> ID：433669
> 
> 赞同：2
> 
> 时间：2009-01-11T20:49:16.680
> 
> 标签：python, algorithm

以下显示了我拥有的一些数据的结构（格式：列表列表）

```
data = 
[ 
  [1,2008-12-01],
  [1,2008-12-01],
  [2,2008-12-01]
  ... (the lists continue)
] 
```

日期范围从 2008 年 12 月 1 日到 2008 年 12 月 25 日。

第一个字段通过 id 标识用户，第二个字段（日期字段）显示此用户何时访问我网站上的页面。

我需要分析这些数据，以便得到以下结果

1 天访问了 25 个用户
2 天访问了 100 个用户
4 天访问了 300 个用户
... 最多 25 天

我正在使用python，不知道从哪里开始！

**编辑**

很抱歉，我似乎对我需要什么不够清楚，因为有些人给出的答案不是我想要的。

我需要找出每天有多少用户访问过，例如
25 天（或每天）访问了 10 个用户

然后我想为从 1 到 25 天的每个频率列出相同的内容。因此，根据我上面的原始示例，
25 个用户仅访问了一天（25 个）
100 个用户在 2 天访问了（在25)
等等

我不需要知道每天访问了多少人
谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-11T20:56:29.847

你的结果是一本字典，对吧？

```
{ userNumber: setOfDays } 
```

如何开始。

```
from collections import defaultdict
visits = defaultdict(set)
for user, date in someList:
    visits[user].add(date) 
```

这为您提供了一本字典，其中包含他们访问的一组日期。

```
counts = defaultdict(int)
for user in visits:
    v= len(visits[user])
    count[v] += 1 
```

这为您提供了 # 个访问次数的字典，有 # 个访问次数这么多的用户。

这就是你要找的东西吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T03:18:18.393

用 SQL 重写 S.Lott 的答案作为练习，只是为了检查我的要求是否正确......

```
SELECT * FROM someList;

 userid |    date    
--------+------------
      1 | 2008-12-01
      1 | 2008-12-02
      1 | 2008-12-03
      1 | 2008-12-04
      1 | 2008-12-05
      2 | 2008-12-03
      2 | 2008-12-04
      2 | 2008-12-05
      3 | 2008-12-04
      4 | 2008-12-04
      5 | 2008-12-05
      5 | 2008-12-05

SELECT countdates, COUNT(userid) AS nusers
FROM ( SELECT userid, COUNT (DISTINCT date) AS countdates
             FROM someList
             GROUP BY userid ) AS visits
GROUP BY countdates
HAVING countdates <= 25
ORDER BY countdates;

 countdates | nusers 
------------+--------
          1 |      3
          3 |      1
          5 |      1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T10:59:06.667

这可能不是最pythonic、最有效或最聪明的或任何这样做的方式。但也许您可以确认我是否正确理解了要求：

```
>>> log=[[1, '2008-12-01'], [1, '2008-12-01'],[2, '2008-12-01'],[2, '2008-12-03'], [1, '2008-12-04'], [3, '2008-12-04'], [4, '2008-12-04']]
>>> all_dates = sorted(set([d for d in [x[1] for x in log]]))
>>> for i in range(0, len(all_dates)):
...     log_slice = [d for d in log if d[1] <= all_dates[i]]
...     num_users = len(set([u for u in [x[0] for x in log_slice]]))
...     print "%d users visited in %d days" % (num_users, i + 1)
... 
2 users visited in 1 days
2 users visited in 2 days
4 users visited in 3 days
>>> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-11T21:11:42.157

首先，我应该提到您需要将日期存储为字符串。目前，它将对您当前的条目进行算术运算。所以，如果你`data`像这样格式化，它会更好地工作：

```
data = 
[ 
  [1,"2008-12-01"],
  [1,"2008-12-01"],
  [2,"2008-12-01"]
] 
```

接下来，我们可以这样做来获取每天的数字：

```
result = {}
for (id, date) in data:
    if date not in result:
        result[date] = 1
    else:
        result[date] += 1 
```

现在，您可以通过执行以下操作来获取特定日期的用户数：

```
print result[some_date] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-11T23:39:10.720

目前尚不清楚您的具体要求是什么。这是我的看法：

```
#!/usr/bin/env python
from collections import defaultdict

data = [ 
  [1,'2008-12-01'],
  [3,'2008-12-25'],
  [1,'2008-12-01'],
  [2,'2008-12-01'],
]

d = defaultdict(set)
for id, day in data:
    d[day].add(id)

for day in sorted(d):
    print('%d user(s) visited on %s' % (len(d[day]), day)) 
```

它打印：

```
2 user(s) visited on 2008-12-01
1 user(s) visited on 2008-12-25 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T03:13:49.460

这个怎么样：这给了你一组天数和计数：

```
In [39]: from itertools import groupby ##itertools is a part of the standard library.

In [40]: l=[[1, '2008-12-01'],
   ....:  [1, '2008-12-01'],
   ....:  [2, '2008-12-01'],
   ....:  [1, '2008-12-01'],
   ....:  [3, '3008-12-04']]

In [41]: l.sort()

In [42]: l
Out[42]: 
[[1, '2008-12-01'],
 [1, '2008-12-01'],
 [1, '2008-12-01'],
 [2, '2008-12-01'],
 [3, '3008-12-04']]

In [43]: for key, group in groupby(l, lambda x: x[0]):
   ....:     group=list(group)
   ....:     print key,' :: ', len(group), ' :: ', group
   ....:     
   ....:     
1  ::  3  ::  [[1, '2008-12-01'], [1, '2008-12-01'], [1, '2008-12-01']]
2  ::  1  ::  [[2, '2008-12-01']]
3  ::  1  ::  [[3, '3008-12-04']] 
```

用户::访问次数 :: 访问日期

在这里，用户 -1 在 2008-12-01 访问了 3 次，如果您只想计算不同的日期，那么

```
for key, group in groupby(l, lambda x: x[0]):
    group=list(group)
    print key,' :: ', len(set([(lambda y: y[1])(each) for each  in group])), ' :: ', group
   ....:     
   ....:     
1  ::  1  ::  [[1, '2008-12-01'], [1, '2008-12-01'], [1, '2008-12-01']]
2  ::  1  ::  [[2, '2008-12-01']]
3  ::  1  ::  [[3, '3008-12-04']] 
```

# linux - 你在哪里下载 Linux 源代码？

> ID：433670
> 
> 赞同：6
> 
> 时间：2009-01-11T20:49:46.537
> 
> 标签：linux

假设我对某个特定 Linux 实用程序的源代码感兴趣，例如`factor`. 我在哪里可以找到该实用程序的源代码？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-11T21:07:43.663

您还可以从打包源代码的下载中找出二进制文件来自哪个包。

在 Debian（以及 Ubuntu 和任何其他基于 Debian 的）上，您可以这样做：

```
$ dpkg -S /usr/bin/因子
coreutils：/usr/bin/factor
$ apt-get source coreutils

```

第一个命令将检查哪个包包含您正在搜索的文件（使用“ `which factor`”来找出当您只需键入“ `factor`”时执行的二进制文件）。

第二个命令将下载并解压源代码（包括用于构建包的补丁）到当前目录，因此它应该在专用或临时目录中执行。

我很确定`rpm`基于分布的发行版具有类似的机制，但我不知道它们的命令。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-11T21:01:04.613

我所做的是打字

```
man factor 
```

并走到底部并找到'GNU coreutils 6.10'。所以我用谷歌搜索了“coreutils”，然后......找到了刚刚链接到的网站 joschi。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-11T21:20:53.823

To find the package a binary comes from, in rpm based system, you might type:

```
$ rpm -qf /usr/bin/factor

```

which will print the package name. Instead, with:

```
$ rpm -qif /usr/bin/factor

```

you will get also information on a package, including it's home page in many cases.

Source rpms also exist, but how to get them depends on the high-level package manager used on top of RPM (yum, urpmi, apt-get4 for rpm, ...).

On most systems, also, /usr/share/doc/ contains some documentation on the program, and the website link is pretty often found somewhere there, maybe in the README.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-11T20:55:00.833

如果程序是开源的，通常你会在程序的网站上找到源代码。在这种情况下[，](http://www.gnu.org/software/coreutils/)因为*factor*是 coreutils 的一部分。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-11T21:20:42.967

在 Gentoo 上，只需查看您使用 :D 编译软件包的 ebuild。

如果你不确定？

```
    # 哪个因素
    /usr/bin/因子
    # grep '/usr/bin/factor' /var/db/pkg/*/*/CONTENTS
    /var/db/pkg/sys-apps/coreutils-6.12-r2/CONTENTS:obj /usr/bin/factor 5aaf903daa4345efb11618b3cb47e9a5 1224224574
    /var/db/pkg/sys-apps/coreutils-6.12-r2/CONTENTS:obj /usr/lib64/debug/usr/bin/factor.debug 517d965636850633e9b15926dde8c222 1224224575
    # cat /var/db/pkg/sys-apps/coreutils-6.12-r2/SRC_URI
    ftp://alpha.gnu.org/gnu/coreutils/coreutils-6.12.tar.lzma mirror://gnu/coreutils/coreutils-6.12.tar.lzma mirror://gentoo/coreutils-6.12.tar.lzma mirror://gentoo/coreutils-6.12-patches-1.0.tar.lzma http://dev.gentoo.org/~vapier/dist/coreutils-6.12-patches-1.0.tar.lzma
    # cat /var/db/pkg/sys-apps/coreutils-6.12-r2/HOMEPAGE
    http://www.gnu.org/software/coreutils/

```

But of course, the source code is probably still available in `/usr/portage/distfiles` .

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-14T09:11:43.950

Another, very good approach is to use [Google Code Search](http://www.google.com/codesearch). For example, a search for [factor coreutils](http://www.google.com/codesearch?hl=en&lr=&q=factor+coreutils&sbtn=Search) (see the man page or `factor --help` to see that it's from coreutils) came up with the package as the second result. Two clicks away I was browsing [factor.c](http://www.google.com/codesearch/p?hl=en#94zv5plnxyQ/coreutils-5.1.3/src/factor.c&q=factor%20coreutils%20package:%22ftp://alpha.gnu.org/gnu/coreutils/coreutils-5.1.3.tar.bz2%22) online.

Google Code Search searches most public source code. You can use regexps and many advanced search options, including restricting by language and license.

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-11T21:51:49.003

I usually find a link to the source, homepage, and other useful information by doing a search on [freshmeat](http://freshmeat.net/).

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-01-14T02:28:56.027

You may want to check out [SourceForge.net](http://sourceforge.net/).

# properties - 修改 setter 参数 - 是否破解？

> ID：433678
> 
> 赞同：4
> 
> 时间：2009-01-11T20:55:24.547
> 
> 标签：properties, setter

修改 setter 参数是否正常？假设我们有 setString 方法。我们真的想保留字符串的修剪形式。所以带有尾随空格的字符串是无效的，但我们不想抛出异常。

最好的解决方案是什么？修剪设置器中的值，例如

```
public void setString(String string) {
    this.string = string.trim();
} 
```

或者在调用者中修剪它（不止一次），例如

```
object.setString(string.trim()); 
```

或者也许是别的什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-11T20:57:11.983

是的。毕竟，setter 是为这类事情而设计的！控制和清理写入字段的值；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-11T21:23:09.467

完全。这是一个示例：假设您有一个具有不同类型测量单位的工程程序。您将内部值保留在一个测量系统中，但您从 setter 中的所有其他值转换，然后在 getter 中转换回来，例如：

```
public double UserTemperature
{
  get
  {
    return Units.Instance.ConvertFromSystem(UnitType.Temperature, temperature);
  }
  set  
  {
    double v = Units.Instance.ConvertToSystem(UnitType.Temperature, value);
    if (temperature != v)
    {
      temperature = v;
      Changed("SystemTemperature");
      Changed("UserTemperature");
    }
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-11T21:03:24.593

是的，当然。在应用任何方法（例如 trim()）之前，请小心检查 NULL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-11T21:16:27.950

有两所学校：一个说可以在 setter 中检查参数（学校风格），第二个说 bean 不应该包含任何逻辑，只包含数据（企业风格）。

我更相信第二个。您多久查看一次 bean 的实现？getUser 应该抛出任何异常还是只返回null？

当您将逻辑放入您的 setter 和 getter 中时，您会更难理解发生了什么，因为许多人永远不会查看它的实现。如果您不同意，我敦促您在使用它之前查看每个 setter 和 getter 实现，以检查它是否不仅仅是一个 bean。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-11T21:25:12.397

乍一看，它似乎违反了[最小惊讶原则](http://en.wikipedia.org/wiki/Principle_of_least_astonishment)。如果我是您班级的用户，我希望二传手能完全按照我的吩咐去做。我会在设置器中抛出异常以强制用户修剪输入。

另一种（更好的？）替代方法是将方法的名称更改为 trimAndSetString。这样，修剪输入的行为就不足为奇了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-11T21:33:32.143

如果我错了，请纠正我，但在我看来，setter 应该持有这种逻辑是合乎逻辑的。如果 setter 只是为内部 var 分配了一些值而不检查它，那么为什么不公开 var 本身呢？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-11T22:50:12.893

这正是您使用 setter 而不是将对象字段公开给整个世界的原因。

考虑一个持有整数角度的类，该角度预计在 0 到 359 之间（包括 0 到 359）。

如果您公开该字段，调用函数可以将其设置为他们想要的任何内容，这将破坏您的 API 指定的合同。它也可能会在某个地方破坏您的功能，因为您的代码被编写为假定该变量的某个范围。

使用二传手，您可以做很多事情。一种是引发异常以指示传递了无效值，但在我看来这是不正确的（对于这种情况）。如果将输入值修改为 0 到 359 之间的值，例如：

```
actualVal = passedValue % 360; 
```

只要在您的界面 (API) 中指定了这一点，它就完全有效。事实上，即使你没有指定它，你仍然可以自由地做任何你想做的事情，因为调用者违反了合同（通过传递一个超出范围的值）。我倾向于遵循“尽快清理您的输入”的规则。

在您的特定情况下，只要您指定字符串以修剪格式存储，调用者就没有理由抱怨（您已经声明这样的字符串无效）。就代码大小（而不是速度）而言，最好在 setter 中而不是在每段调用 setter 的代码中执行。它还保证字符串按您期望的方式存储 - 不能保证调用者不会意外（或故意）存储未修剪的字符串。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-11T22:57:30.960

是的。面向对象设计的一个特点是调用者可以把你的类当作一个黑盒子。你在里面做的事是你自己的事，只要接口的行为有文档且合乎逻辑。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-05T18:21:24.273

虽然不同的人有不同的理念，但我建议属性设置器仅适用于他们将设置对象状态的一个方面以匹配指示值并可能通知任何关心更改但不会影响对象的状态（如果该属性是根据与属性设置器关联的状态定义的，则属性设置器更改*只读*属性的值是完全正确的；例如，控件的只读`Right`属性可以在其条款`Bounds`）。如果属性设置器无法执行指定的操作，则应抛出异常。

如果希望允许客户端以某种不符合上述描述的方式修改对象的状态，则应该使用方法而不是属性。如果有人调用`Foo.SetAngle(500)`，则可以合理地预期该方法将使用指定的参数来设置角度，但该`Angle`属性可能不会以与设置相同的形式返回角度（例如，它可能返回 140）。另一方面，如果`Angle`是一个读写属性，人们会期望写入 500 的值将被禁止，否则会导致该值读回 500。如果想要让对象存储范围内的角度从 0 到 359，该对象还可以有一个称为只读属性的属性`BaseAngle`，该属性将始终以该形式返回一个角度。

# c - 如何在C中将struct转换为char数组

> ID：433682
> 
> 赞同：9
> 
> 时间：2009-01-11T20:58:57.143
> 
> 标签：c, pointers, struct, char

我正在尝试将结构转换为 char 数组以通过网络发送。但是，当我这样做时，我会从 char 数组中得到一些奇怪的输出。

```
#include <stdio.h>

struct x
{
   int x;
} __attribute__((packed));

int main()
{
   struct x a;
   a.x=127;
   char *b = (char *)&a;
   int i;
   for (i=0; i<4; i++)
      printf("%02x ", b[i]);
   printf("\n");
   for (i=0; i<4; i++)
      printf("%d ", b[i]);
   printf("\n");
   return 0;
} 
```

这是各种 ax 值的输出（在使用 gcc 的 X86 上）：
127:
7f 00 00 00
127 0 0 0

128：
ffffff80 00 00 00
-128 0 0 0

255：
ffffffff 00 00 00
-1 0 0 0

256：
00 01 00 00
0 1 0 0

我了解 127 和 256 的值，但是为什么数字在转到 128 时会发生变化？为什么不只是：80 00 00 00 128 0 0 0

我是在转换过程中忘记做某事，还是忘记了有关整数表示的事情？

*注意：这只是一个小测试程序。在一个真正的程序中，我有更多的结构，更好的变量名，并且我转换为小端。
*编辑：格式化

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-11T21:17:41.473

您看到的是从 char 到 int 的符号保留转换。该行为是由于在您的系统上 char 已签名（*注意：* char 并非在所有系统上都已签名）。如果位模式对 char 产生负值，这将导致负值。将这样的 char 提升为 int 将保留符号，并且 int 也将是负数。请注意，即使您没有`(int)`显式放置 a，编译器也会在传递给 printf 时自动将字符提升为 int。解决方案是将您的价值转换为`unsigned char`第一：

```
for (i=0; i<4; i++)
   printf("%02x ", (unsigned char)b[i]); 
```

或者，您可以`unsigned char*`从一开始就使用：

```
unsigned char *b = (unsigned char *)&a; 
```

然后在使用 printf 打印时不需要任何演员表。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-11T21:02:43.313

char 是有符号类型；所以对于二进制补码，0x80 对于 8 位整数（即一个字节）是 -128

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-11T21:12:47.910

格式说明`x`符本身表示参数是 a `int`，并且由于数字为负数，因此需要八个字符来显示-sized 值`printf`的所有四个非零字节。修饰符告诉用零填充输出，并且`int`修饰符说*最小*输出应该是两个字符长。据我所知，不提供指定*最大*宽度的方法，字符串除外。`0``2`*`printf`*

 **现在，您只传递了 a `char`，因此 bare`x`告诉函数使用`int`传递的完整值来代替 - 由于 " `...`" 参数的默认参数提升。尝试使用`hh`修饰符告诉函数将参数视为只是 a `char`：

```
printf("%02hhx", b[i]); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-11T21:07:25.223

将您的结构视为 char 数组是未定义的行为。要通过网络发送它，请改用正确的序列化。这在 C++ 中很痛苦，在 C 中更是如此，但这是您的应用程序独立于机器读写的唯一方式。

[http://en.wikipedia.org/wiki/Serialization#C](http://en.wikipedia.org/wiki/Serialization#C)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-11T21:41:02.037

以您的方式将您的结构转换为字符或字节，当您尝试使其网络中立时会导致问题。为什么不现在解决这个问题？您可以使用多种不同的技术，所有这些技术都可能比您尝试做的更“便携”。例如：

*   长期以来，在 POSIX/Unix 世界中，通过函数`htonl`、`htons`和. 例如，参见 FreeBSD 或 Linux 系统上的[byteorder(3)](http://www.freebsd.org/cgi/man.cgi?query=htonl&apropos=0&sektion=0&manpath=FreeBSD+7.1-RELEASE&format=html)手册页。`ntohl``ntohs`
*   将数据与[JSON](http://json.org/)等完全中立的表示形式相互转换也是完全可以接受的。与网络传输延迟相比，您的程序在 JSON 和原生形式之间转换数据所花费的时间可能相形见绌。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-11T21:04:11.500

char 是有符号类型，所以你看到的是两个恭维表示，转换为 (unsigned char*) 将解决这个问题（罗兰打败了我）。

在旁注中，您可能想要更改

```
for (i=0; i<4; i++) {
//...
} 
```

到

```
for (i=0; i<sizeof(x); i++) {
//...
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-02-26T05:24:35.933

char 数组的符号不是问题的根源！（这是一个问题，但不是唯一的问题。）

结盟！这是这里的关键词。这就是为什么您永远不应该尝试将结构视为原始内存。编译器（和各种优化标志）、操作系统和月相都对结构中“相邻”字段的内存中的实际位置做了奇怪而令人兴奋的事情。例如，如果你有一个 char 后跟一个 int 的结构，则整个结构将是内存中的 8 个字节——char、3 个空白、无用字节，然后是 int 的 4 个字节。机器喜欢做这样的事情，所以结构可以干净地放在内存页面上，等等。

在当地大学参加机器架构入门课程。同时，正确序列化。切勿将结构视为 char 数组。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-04-11T10:04:01.603

当您发送它时，只需使用：

(char*)&CustomPacket

转换。为我工作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-11T21:04:32.017

您可能希望转换为无符号字符数组。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-01-13T02:06:17.443

除非您有*非常*令人信服的测量结果表明每个八位字节都是宝贵的，**否则不要这样做**。使用可读的 ASCII 协议，如[SMTP](http://www.ietf.org/rfc/rfc0821.txt)、[NNTP](http://www.ietf.org/rfc/rfc977.txt)或由 IETF 编码的许多其他精细 Internet 协议之一。

如果您确实必须具有二进制格式，那么仅将 struct 中的字节挤出来仍然不安全，因为字节顺序、基本大小或对齐约束可能因主机而异。您必须设计您的有线协议以使用明确定义的大小并使用明确定义的字节顺序。对于您的实现，请使用类似宏`ntohl(3)`或使用移位和掩码将字节放入流中。无论您做什么，请确保您的代码在大端和小端主机上产生相同的结果。

# java - 将 Oracle Forms 10 转换为 Java

> ID：433689
> 
> 赞同：0
> 
> 时间：2009-01-11T21:01:53.207
> 
> 标签：java, oracle, oracleforms

有许多可用的商业产品：

*   [出埃及记](http://www.ciphersoftinc.com/products/migration-products-overview.html)
*   [埃沃](http://www.vgosoftware.com/products/evo/index.php)

Oracle Application Express (APEX)还在 Oracle Application Express 3.2（现在处于测试阶段）中发布了[表单转换器。](http://dpeake.blogspot.com/2008/08/new-statement-of-direction.html)

*   有人用过这些工具吗？
*   他们自动化了多少流程？
*   转换后的代码质量如何？
*   他们值得付出代价吗？
*   还有其他指导方针或想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T06:09:12.997

除了完全重写之外，我从未参与过转换项目，但是：

最大的决定因素将是您的表单中有多少自定义代码/设计。例如，如果您的所有表单都是从 Oracle Designer 生成的，那么它们很可能使用 Apex 表单转换器等自动化工具转换得相当好。

但是，如果您的大多数表单都是手工制作的，并且有许多自定义触发器来实现特定的界面行为，那么您会发现转换过程只是一个非常大的重写项目的开始。

Apex 表单转换器的好处是它为您提供了一个良好的开端，然后它可以帮助您管理手动转换自定义代码的过程。

# c - 添加变量的段错误

> ID：433700
> 
> 赞同：2
> 
> 时间：2009-01-11T21:05:35.540
> 
> 标签：c, segmentation-fault

诚然，我是一个纯 C 的新手，但这让我很难过。我正在研究一个链表实现以供练习，我通过简单地向 split_node 函数添加一个变量来得到一个段错误：

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

struct Node {
    struct Node *child;
    char *content;
};

void print_list(struct Node node);
void split_node(struct Node *node, int position);

int main() {

    struct Node head, second, third;

    head.content = "first";
    second.content = "second";
    third.content = "i'm third";

    head.child = &second;
    second.child = &third;

    print_list(head);
    split_node(&head, 3);
    print_list(head);

    return 0;
}

void print_list(struct Node node) {
    printf("%s\n", node.content);
    if(node.child) print_list(*node.child);
}

    /*
    Split node into two nodes, with the first position characters of the node's content remaining with node, and the remainder being copied to the new node. (It doesn't yet truncate the first node's string, but does do the copy.)
    */
void split_node(struct Node *node, int position) {
    if(position >= strlen((*node).content)) return;
    struct Node newNode;
    newNode.child = (*node).child;
    (*node).child = &newNode;

    int length = (strlen((*node).content) - position);
    newNode.content = malloc(sizeof(char) * (length + 1));
    strncpy(newNode.content, (*node).content + sizeof(char) * position, length);
    newNode.content[length] = '\0';

    //int foo;
} 
```

此代码编译（gcc -Wall -o list list.c）并运行良好：

```
$ ./list
first
second
i'm third
first
st
second
i'm third 
```

但是如果我`int foo`在结尾取消注释`split_node`，编译并运行，我会得到：

```
$ ./list
first
second
i'm third
first
st
Segmentation fault 
```

gdb 给了我这个回溯：

```
#0  0x91d6ae70 in strlen ()
#1  0x91dd3126 in puts ()
#2  0x00001f21 in print_list (node={child = 0xbcec815b, content = 0x8b000000 <Address 0x8b000000 out of bounds>}) at list.c:41
#3  0x00001f3c in print_list (node={child = 0x8fe0154b, content = 0x1ff6 "i'm third"}) at list.c:42
#4  0x00001f3c in print_list (node={child = 0xbffff568, content = 0x1fef "second"}) at list.c:42
#5  0x00001f3c in print_list (node={child = 0xbffff570, content = 0x1fe9 "first"}) at list.c:42
#6  0x00001ee0 in main () at list.c:33 
```

为什么添加变量定义会导致段错误？它似乎正在破坏新创建节点的内容指针。我很困惑; 有什么帮助吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-11T21:08:07.280

您需要动态分配节点（使用 malloc）。

正如你所拥有的，你的新节点被声明在堆栈上。当 split 函数返回时，该新节点不再是有效内存。

添加变量会导致段错误，因为该变量会更改堆栈的布局，从而导致函数返回时的行为略有不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-11T21:11:38.210

尝试将 Nodes 子属性设置为 NULL，C 不会自动将内存归零，因此看起来您的子项中可能有垃圾（或者您可以使用 calloc 而不是 malloc）。SoapBox 的回答也是正确的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-11T22:15:11.967

[Valgrind](http://valgrind.org/)是一个很好的工具来帮助发现这些类型的问题。您可以从命令行执行“valgrind myappname”，它将为您提供有关这些类型错误的详细信息。

# database - 如何根据应用程序用户属性限制或过滤数据库访问

> ID：433707
> 
> 赞同：5
> 
> 时间：2009-01-11T21:08:48.870
> 
> 标签：database, security, filter, partitioning, filtered-lookup

我现在考虑太多了，没有明显正确的解决方案。这可能是一个真正的木头换树的情况，所以我需要 stackoverflow 的帮助。

我正在尝试在区域基础上强制执行数据库过滤。我的系统有不同的用户，每个用户都分配到一个区域办事处。我只希望用户能够看到与其区域办事处相关的数据。

简单来说我的应用是：Java App -> JPA (hibernate) -> MySQL

数据库包含来自所有地区的对象，但我只希望用户能够操作来自他们自己地区的对象。我考虑过以下方法：

1) 修改所有数据库查询，以便它们读取类似 select * from tablex where region="myregion" 的内容。这很讨厌。它不适用于 JPA，例如 entitymanager.find() 方法只接受主键。当然我可以原生，但我只需要错过一个选择语句，我的安全性就会被击中

2）使用mysql代理过滤结果。有点时髦，但是 mysql 代理只看到原始调用并且并不真正知道它应该如何过滤它们（即发出此请求的用户属于哪个区域）。好的，我可以为每个区域启动一个代理，但它开始变得有点混乱..

3) 为每个区域使用单独的模式。是的，很简单，我使用的是 spring，所以我可以使用 RoutingDataSource 通过正确的数据源（每个模式 1 个数据源）路由请求。当然，现在的问题出在我想要按地区和其他类别进行过滤的某个地方。哦哦。

4) ACL - 对此不太确定。如果 a 做了一个 select * from tablex; 它会悄悄地过滤掉我无权访问的对象还是会抛出大量访问异常？

但是我是不是想太多了？这似乎是一个非常普遍的问题。必须有一些简单的解决方案，我太笨了，看不到。我敢肯定它会接近/或在数据库中，因为您希望过滤尽可能接近源，但是什么？

不希望被灌输 - 任何链接、关键字、想法、商业/开源产品建议将不胜感激！谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T03:34:58.997

好问题。

似乎 #1 是最好的，因为它是最灵活的。

地区恰好是您今天要过滤的内容，但明天可能是地区+部门+头发颜色。

如果您开始过多地分割数据，那么您似乎将不得不更加努力地将它们重新粘合在一起以进行报告。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T08:49:51.467

在过去的几周里，我刚刚为会计包的分层多公司扩展实现了类似的东西（REALbasic 与 MySQL 对话）。

有大量现有代码组成 SQL 语句，因此我们不得不忍受这些代码，并且只需进行大量审计以确保每个表中都包含适当的限制。一个问题是*相关查找*，其中查找表通常仅与主表结合使用，但对于某些维护 GUI 会直接加载查找表本身。

存在泄露隐含信息的危险，例如透露 Acme Pornstars 是该公司某些部门的客户 ;-)

该部分的唯一解决方案是非常仔细地构建 DB 图表以显示所有隐含的关系以及大量的审计和 grepping 源代码，并仔细注释以指示已经确定为不需要额外限制的区域。

我想出的一种模式是使用由全局 CurrentEntityForRole("blah") 函数提供的任意 entityID，而不是显式的 region=currentRegionVar 类型搜索，而不是显式地进行搜索。

这种抽象允许共享一些数据以及实现代表其他限制边界的伪实体。

我对 Java 和 Spring 知之甚少，无法分辨，但有没有一种方法可以使用视图来提供单键查找，其中视图受区域过滤器限制？

提供聚合和可能的数据共享的愿望是我们没有采用单独的数据库路线的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T13:03:14.927

我有同样的问题。很难相信这样一项常见的任务（根据用户配置文件过滤模型实体列表）没有“标准”方式、模式或最佳实践。

我找到了[pgacl](http://code.google.com/p/pgacl/)，一个 PostgreSQL 模块。基本上，您像往常一样进行查询，然后添加 acl_access() 谓词作为过滤器。

也许 MySQL 也有类似的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T12:54:54.567

我建议你使用 ACL。它比其他选择更灵活。使用弹簧安全。您可以在不使用 Spring Framework 的情况下使用它。[从链接文本](http://grzegorzborkowski.blogspot.com/2008/10/spring-security-acl-very-basic-tutorial.html)中阅读教程

# c# - C#中读取文件，方法不同

> ID：433711
> 
> 赞同：3
> 
> 时间：2009-01-11T21:10:45.403
> 
> 标签：c#, .net, file

学习 C#，我的书向我展示了 readin 文件的类。我发现 2 个非常相似，并且 Visual Studio 调试器没有显示两者之间的明显区别。

代码：

```
FileStream fs = new FileStream(path, FileMode.Open, FileAccess.Read);

FileStream fs = File.Open(path, FileMode.Open, FileAccess.Read); 
```

现在我想知道，这两种读取文件的方式有什么区别。你知道有什么内部差异吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-11T21:12:23.327

后者只是一个工厂，它返回一个`FileStream`. 即他们做同样的事情。

以下是 的实现`Open()`：

```
public static FileStream Open(string path, FileMode mode, FileAccess access, FileShare share) {

   return new FileStream(path, mode, access, share);

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-11T21:13:01.343

如果您阅读[文档](http://msdn.microsoft.com/en-us/library/s67691sb.aspx)，您会发现它们是相同的。

# bash - FTP 未上传最后 4 个字节

> ID：433718
> 
> 赞同：1
> 
> 时间：2009-01-11T21:14:47.987
> 
> 标签：bash, ftp

我有一个 bash 脚本可以将一些文件上传到我的网络服务器。问题是它似乎假设当他们到达网络服务器时，他们丢失了文件的最后 4kb。

在我的计算机上，该文件被列为 8kb（四舍五入，因为块为 4kb），但仅上传了 4kb。

这是有趣/令人困惑的部分，这只影响上传的最后一个文件，就好像它提前关闭了会话一样。

这是一个已知的问题？手册页没有我能看到的东西。

以下是脚本的副本（当然减去登录详细信息）：

```
ftp -in <ftp.host> <<EOF
quote USER <username>
quote PASS <password>

binary

put file1.xml
put file2.xml
put file3.xml
put file4.xml
put file5.xml
put file6.xml
put file7.xml
put file8.xml
put file9.xml
put file0.xml
quit
EOF 
```

示例文件之一的链接是[http://woarl.com/xml/f8d9b3b981a356efc1ecbb705b369c9e.xml](http://woarl.com/xml/f8d9b3b981a356efc1ecbb705b369c9e.xml)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-11T21:29:23.213

当客户端退出时，最后一个 put 命令可能仍在传输数据（通过被动连接）。BYE 只是 quit 的别名，所以它没有帮助，但也许你可以尝试在 put 和 quit 之间添加一些其他命令，例如 ls。

或者，如果没有防火墙禁止，将会话设置为活动模式很可能会强制客户端在发出退出之前等待最后一次放置完成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-11T21:29:28.237

当然，这不是您要的，但是对于这些类型的事情，我喜欢安装 ncftp 实用程序。这包括 ncftpput 和 ncftpbatch 用于批处理一堆 ftp 命令并执行它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-11T21:20:34.293

听起来您的 FTP 程序在开始“放置”之后但在让它完成之前立即读取“退出”。

可能您想找到一个不同的命令，而不是等待上传完成的退出。也许是“再见”之类的。

# sql - 如何在没有 DB2 服务器的情况下导出 DB2 数据库

> ID：433722
> 
> 赞同：2
> 
> 时间：2009-01-11T21:16:15.753
> 
> 标签：sql, database, db2, export

我有一个 db2 数据库文件，但没有 db2 服务器。我想将这些数据导出到其他东西（例如 SQL，但这并不重要），而不必设置完整的 db2 服务器（我开始研究这个，但它似乎非常复杂）。

理想情况下，该工具将在 (Debian) Linux 上运行，但如有必要，Windows/OS X 也可以。尽管 db 为 400MB，但可以接受在线服务。一个免费的工具显然更可取，但我会考虑一些不是免费的，只要它不太贵（这是一次性任务）。

（针对评论：我下载了 Express-C，并运行了 dp2prereqcheck、db2setup（似乎没有做任何事情）和 db2_install。目前尚不清楚如何实际运行服务器（谷歌搜索引用“db2start”，但我不能找到这样一个文件。谷歌搜索没有找到我任何其他设置说明）。这样的说明就可以了。在/opt/ibm/db2/V9.5/bin/中有近200个文件，没有一个是明显的开始点，当似乎没有人提供任何 --help 时，我不喜欢尝试所有这些）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-11T21:23:51.337

也许您可以找到可以为您导出数据库实例的人。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-11T22:23:02.950

我不知道答案，但是[可以在此处](http://mysite.verizon.net/Graeme_Birchall/id1.html)获得 DB2 SQL Cookbook 。

如果答案在某个地方，我想它可能就在那里。

# ruby-on-rails - 如何在不删除数据库内容的情况下运行 Rails 集成测试？

> ID：433724
> 
> 赞同：11
> 
> 时间：2009-01-11T21:17:16.607
> 
> 标签：ruby-on-rails, unit-testing, integration-testing

我已经编写了一些集成测试，我想在推送到生产环境之前针对我的 prod 数据库的副本运行这些测试。这让我可以测试我的所有路线是否仍然正确，所有页面都没有错误地呈现，并且一些多页面工作流程按预期工作。

当我运行集成测试时，它会删除我已加载的数据库并加载测试装置（如预期的那样）。如何更改此行为并保留已加载的生产数据库的副本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-11T21:48:11.757

集成测试调用 db:test:prepare 调用 db:test:clone_structure 调用 db:structure:dump 和 db:test:purge

您可以编写自己的任务

```
namespace :your_namespace do
  Rake::TestTask.new(:integration => "db:migrate(if you want") do |t|
    t.libs << "test"
    t.pattern = 'test/integration/**/*_test.rb'
    t.verbose = true
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-28T14:23:47.220

为了让它工作，我必须在调用 rake 任务时指定环境，否则它将在开发数据库上运行迁移，然后在测试数据库上运行测试；给出上面的例子

```
namespace :dbtest do
  Rake::TestTask.new(:integration => "db:migrate") do |t|
    ... 
```

我不得不像这样执行测试

```
rake environment RAILS_ENV=test dbtest:integration 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-11T21:53:19.217

`self.use_transactional_fixtures = true`如果您不想在每次执行测试之间重新加载生产副本，那么在集成测试中设置也会很有用。

否则，集成测试运行将使用它所做的任何更改来破坏数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-13T03:37:54.170

我需要添加 aivarsak 的 Rake 任务

```
namespace :dbtest do  
  Rake::TestTask.new(:integration) do |t|
    t.libs << "test"
    t.pattern = 'test/integration/**/*_test.rb'
    t.verbose = true  
  end
end 
```

并删除

```
fixtures :all 
```

test/test_helper.rb 文件中的行（或创建一个您在集成测试文件中引用的新文件）

# c# - 免费的 C# 表格/图表组件

> ID：433729
> 
> 赞同：12
> 
> 时间：2009-01-11T21:20:30.407
> 
> 标签：c#, .net, graphing

任何人都可以为 C#/.NET 推荐一个免费的网格/图形组件吗？我现在正在看 NPlot，但到目前为止我发现它很麻烦。

编辑：我特别需要一些可以插入 Windows 窗体的东西——我不是在做 ASP.NET，而且每次我得到一个新的数据点（每秒几次）时，我并不喜欢使用谷歌的 API 来复制我的图表。

谢谢 ：-）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-11T21:23:11.807

如果您使用的是 3.5，MS 刚刚[发布了一个，或者您可以使用](http://weblogs.asp.net/scottgu/archive/2008/11/24/new-asp-net-charting-control-lt-asp-chart-runat-quot-server-quot-gt.aspx)[ZedGraph](http://sourceforge.net/projects/zedgraph/)

编辑：链接只是一个 ASP.NET 演示，他们有一个[Windows 窗体版本](http://www.microsoft.com/downloads/details.aspx?FamilyID=130f7986-bf49-4fe5-9ca8-910ae6ea442c&displaylang=en)以及[DEMOS](http://code.msdn.microsoft.com/mschart)

**微软的图表控件**

[微软图表控件 http://code.msdn.microsoft.com/Project/Download/FileDownload.aspx?ProjectName=mschart&DownloadId=3633](http://code.msdn.microsoft.com/Project/Download/FileDownload.aspx?ProjectName=mschart&DownloadId=3633)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-11T21:35:58.520

[MS Chart Controls](http://www.microsoft.com/downloads/details.aspx?familyId=130f7986-bf49-4fe5-9ca8-910ae6ea442c&displayLang=en) ( [VS tools](http://www.microsoft.com/downloads/details.aspx?familyid=1d69ce13-e1e5-4315-825c-f14d33a303e9&displaylang=en) ) 也适用于 winforms：

> Microsoft .NET Framework 3.5 的 Microsoft 图表控件将安装包含 ASP.NET 和 Windows 窗体图表控件的新程序集。

我还没有时间使用它，所以我不知道它是否支持图表/绘图（而不是数据绘图）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-11T21:58:44.153

我强烈推荐 ZedGraph ( [http://zedgraph.org/wiki/index.php?title=Main_Page](http://zedgraph.org/wiki/index.php?title=Main_Page) )。根据我的经验，它很容易配置（并且有据可查），更不用说它看起来非常通用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-03-17T16:11:42.963

Zedgraph 似乎是绘制二维线和直方图的好工具。是否有允许将 2D 数据 (f[x,y]) 可视化为 matlab 函数 pcolor 或 imagesc 的 ac# 库？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-17T16:14:35.923

看看CodePlex 上的[动态数据显示](http://www.codeplex.com/dynamicdatadisplay)。这是一个非常丰富的 WPF 库，具有良好的文档和良好的示例代码。

# vbscript - 使用 VBScript 在第二台显示器上非顺序显示 Powerpoint 幻灯片

> ID：433735
> 
> 赞同：1
> 
> 时间：2009-01-11T21:21:34.260
> 
> 标签：vbscript, powerpoint, nonsequential

如果当前未显示 Powerpoint 演示文稿 - 我如何使用 vbscript 在辅助监视器上显示（例如）第 7 张幻灯片（共 10 张）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-12T04:49:17.037

有趣的。

有一些关于[嘿，脚本专家](http://www.microsoft.com/technet/scriptcenter/resources/qanda/sept06/hey0905.mspx)的线索。使用[TLViewer](http://www.tlviewer.org/tlviewer/)，您可以在 中查看脚本字典的其余部分`C:\Program Files\Microsoft Office\Office10\MSPPT.OLB`，并且快速浏览表明那里有很多功能。

希望能有所帮助。

# postgresql - PostgreSQL 长真空

> ID：433737
> 
> 赞同：4
> 
> 时间：2009-01-11T21:22:17.860
> 
> 标签：postgresql, rdbms, vacuum

我目前正在清理一个具有 2 个索引和 2.5 亿个活动行以及大约相同数量（或更多）的死行的表。我从我的客户端计算机（笔记本电脑）向我的服务器发出了命令 VACCUM FULL ANALYZE。它在过去 3-4 天左右一直在开展业务；我想知道它是否会很快结束，因为我还有很多工作要做！

该服务器有一个四码 Xeon 2.66 GHz 处理器、12 GB 或 RAM 和一个 RAID 控制器，该控制器连接到 RAID 1 配置中的 2 个 10K rpm 146 GB SAS HD；它正在运行 Suse Linux。我想知道...

现在，首先 VACUUM postmaster 进程似乎只使用一个核心。其次，我没有看到非常高的 I/O 写入与 I/O 空闲时间的比率。第三，通过调用`procinfo`，我可以推断 VACUUM 进程大部分时间（88%）都在等待 I/0。

那么为什么不通过线程利用更多内核来使 RAID 控制器过载（获得高 I/O 写入空闲比）？如果 I/O 负载不高，为什么还要等待 I/O？为什么所有这些权力/资源都在它的手指上，但速度却没有更快？在我看来，VACUUM 可以而且应该是多线程的，特别是如果它在一张巨大的桌子上工作并且它是唯一一个工作的！

此外，他们是否可以配置 postgresql.conf 以使其多线程这样的 VACUUM？我可以杀死它并仍然从它的部分清理中受益吗？我需要在那张桌子上工作。

[我使用的是 PostgreSQL 8.1]

再次感谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-11T23:39:54.870

你没有说你使用的是什么版本的 PostgreSQL。有可能是8.0之前的吗？

我遇到了完全相同的情况。你最好的：

*   杀死真空
*   使用 pg_dump -t 选项备份表
*   放下桌子
*   恢复表

如果您使用的是 8.x，请查看 autovacuum 选项。Vacuum 是单线程的，你无法让它使用多线程。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-12T01:15:35.037

一些快速提示：

*   运行 VACUUM FULL VERBOSE 以便您了解正在发生的事情。
*   删除 VACUUM 之前的所有索引。重建它们比吸尘它们更快。您还需要不时重建它们，因为 VACUUM FULL 还不够好（尤其是在像 8.1 这样的旧 PosgreSQL 上）。
*   将maintenance_work_mem 设置得非常高。
*   使用较新的 PostgreSQL。顺便说一句，8.4 将在吸尘方面有很大的改进。

VACUUM 的替代方法是转储和恢复。

编辑：由于 9.0 VACUUM FULL 重写了整个表。这与执行转储 + 恢复基本相同，因此无需运行 REINDEX。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T00:49:47.473

您确定没有任何正在进行的事情可以锁定表并防止真空运行吗？

（无论如何，最好使用[vacuum_cost_delay](http://www.postgresql.org/docs/8.1/interactive/runtime-config-resource.html#RUNTIME-CONFIG-RESOURCE-VACUUM-COST)，这样vacuum 不会对生产造成干扰。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-04T16:05:29.067

Old VACUUM FULL 是化石。它也很慢，之后您必须使用 REINDEX。不要使用它。如果您真的想对表进行碎片整理，请使用 CLUSTER，或者这样：

Lettssay 你还有一些磁盘空间，这比 dump&reload 快得多：

```
CREATE TABLE newtable AS SELECT * FROM oldtable;
CREATE INDEX bla ON newtable( ... );
ALTER TABLE oldtable RENAME TO archive;
ALTER TABLE newtable RENAME TO oldtable; 
```

请注意，这不会复制您的约束。您可以使用 CREATE TABLE LIKE ... 来复制它们。

> 那么为什么不通过线程利用更多内核

pg 不支持这个。

# sql-server - SQL Server Management Studio 作为应用程序平台

> ID：433738
> 
> 赞同：2
> 
> 时间：2009-01-11T21:23:00.293
> 
> 标签：sql-server

SQL Server IDE 能否成为企业应用程序的应用程序开发平台？以类似于旧的 xBase 应用程序的方式，但是，你知道，更好吗？

主要原因是 Management Studio 是我用过的最好的“以数据为中心”的应用程序之一。它具有建议的解决方案的大部分主要成分：

*   强大的数据操作语言（SQL :o））
*   良好的安全性
*   分布式架构

它缺乏的主要特点：

*   GUI 工具包：简单而标准的东西，企业应用程序通常不需要花哨的 UI
*   某种形式的自动化（.Net，COM，只要它有效，我真的不在乎）
*   MS Office 集成（尤其是 Excel）

所以…？

更新：

**上面的问题是关于一个想法**的反馈请求。我不打算在不久的将来使用 SSMS 来构建交互式应用程序。我真的很想听听您对此有何看法以及您可能有什么其他建议（也许已经有一种产品可以做到这一点）。

该问题的简短文本是“如果 SSMS 和 MS Access 可以结婚，他们的孩子会是什么样子？”

第二次更新：

“微软宣布其新产品代号‘弗兰肯斯坦’。新产品试图将旧 Fox Pro 和 Access 时代的数据库应用程序开发的简易性与全新的 SQL Server 2012 套件结合起来。作为‘弗兰肯斯坦’的产品经理，Jim Bob ，声明“[弗兰肯斯坦] 将使开发人员能够关闭 f*#k，并且已经构建了那个东西。不要花他们（高薪）时间争论什么是最好的 ORM 或 AJAX 工具包，或者他们是否应该使用 SOA 等……（顺便说一句，自 2009 年以来，SOA 已经死了）”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-11T21:32:54.393

好吧，这取决于您如何看待它。

您可以为管理工作室[扩展和构建插件](http://jcooney.net/archive/2007/11/26/55358.aspx)，但您也可以使用[Visual Studio shell](http://msdn.microsoft.com/en-us/vsx2008/products/bb933751.aspx)作为新应用程序的基础（尽管我认为这不是您想要的？）

但是，重新阅读您的问题，您似乎确实想要为 SQL Server 构建应用程序。在这种情况下，您可能需要查看 Visual Studio Team Systems [Database Edition](http://msdn.microsoft.com/en-us/vsts2008/products/bb933747.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T13:16:44.517

在 SQL Server Management Studio 之上构建应用程序涉及两个风险。

首先，SQL Server Management Studio 从 2005 年到 2008 年一直相当稳定，但这只是发布时间的三年。SQL Server 2000 的工具有很大的不同，没有理由期望 SQL Server 管理工具总是保持不变。

例如，在 2008 年西雅图的 SQL Server 专业协会 (PASS) 峰会上，微软展示了一个新的 SQL Server 管理框架。数据库将以与我们在 SSMS 中习惯的方式完全不同的方式进行打包和管理。乞力马扎罗项目（将其视为 SQL 2008 R2）将是该管理的“首付”，其余工具将在以后的版本中出现。SSMS 的外观、感觉和工作方式都将有所不同，以适应这种构建数据库驱动应用程序的新方式。

其次，微软的 SSMS 架构是不可插拔的，据我所知，他们不鼓励任何第三方在 SSMS 中进行开发。您可以使用 RDLC 报告（在 SSMS 中运行的独立 SQL Server Reporting Services 应用程序）构建一定程度的交互性，但在大多数情况下，不鼓励您在 SSMS 之上构建，因为他们确实希望有权在需要时更改它改进它。

不过，我有好消息 - 你提到你想要某种 Office 搭配。请留意 Project Gemini 的公告。Donald Farmer 在 PASS 上做了演示，可能有一些视频在流传。它使用 Excel 作为 BI 分析的前端，他们使用数百万行的电子表格将数据存储回 SQL 中。目前还没有太多公开的内容，但请注意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T23:30:14.873

回答一个简短的问题——你看过各种科学怪人电影吗？

更长的问题 - 你为什么想要它，你已经有了 Visual Studio？SSMS 是开发存储过程、查询、视图等的绝佳环境，让我们这样吧。无论如何，唯一好的 XBase 环境是 FoxPro，看看结果如何。

# c# - 动态创建文本输入 (ASP.net/C#)

> ID：433743
> 
> 赞同：1
> 
> 时间：2009-01-11T21:23:38.577
> 
> 标签：c#, asp.net

我的页面上有一个输入字段，用户将在其中输入他们想要创建的文本输入的数量。按钮的动作是：

```
int num_flds = int.Parse(a_fld.Text);
for (int i = 0; i < num_flds; i++)
{
    TextBox tmp = new TextBox();
    tmp.ID = "answer_box" + i;
    tmp.Width = Unit.Pixel(300);
    answer_inputs.Controls.Add(tmp);
} 
```

现在，我有另一个按钮，用户在填写完所有动态创建的文本框后会单击该按钮。问题，首先，我是否在正确的位置动态创建文本框？如何从动态创建的文本框中获取值？（动态创建的文本框被添加到面板“answer_inputs”中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-11T21:28:17.647

我建议阅读[这篇](http://weblogs.asp.net/infinitiesloop/archive/2006/08/25/TRULY-Understanding-Dynamic-Controls-_2800_Part-1_2900_.aspx)文章和其他一些关于动态创建控件主题的文章。它并不像你想象的那么简单。有一些重要的页面生命周期问题需要考虑。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-11T21:39:29.980

在动态创建 Web 控件时，我发现最好让控件本身在答案中报告。你可以像这样实现它：

在您的 Page 类中创建一些东西来存储值：

```
private readonly Dictionary<TextBox, string> values=new Dictionary<TextBox, string>(); 
```

当文本框的值发生变化时，创建一个方法作为文本框的回调：

```
void tmp_TextChanged(object sender, EventArgs e)
    {
        TextBox txt = sender as TextBox;
        if(txt!=null)
        {
            values.Add(txt,txt.Text);
        }
    } 
```

然后在添加时将此方法添加到每个文本框：

```
int num_flds;
    if(!int.TryParse(a_fld.Text,out num_flds))
    {
        num_flds = 0;
    }
    for (int i = 0; i < num_flds; i++)
    {
            TextBox tmp = new TextBox();
            tmp.ID = "answer_box" + i;
            tmp.Width = Unit.Pixel(300);
            answer_inputs.Controls.Add(tmp);
            tmp.TextChanged += tmp_TextChanged;
    } 
```

最后，您在回调中遍历字典以查看它是否包含任何值。例如，在 OnPreRender 方法中执行此操作。

编辑：如果回发时文本字段的数量减少，则存在问题。应该采用一些安全的方法在回发时重新创建以前的文本字段。

# perl - 如何确定运行时是否存在 Perl 函数？

> ID：433752
> 
> 赞同：25
> 
> 时间：2009-01-11T21:28:42.997
> 
> 标签：perl, introspection

我正在使用 Perl 开发一个测试框架。作为测试的一部分，我可能需要为任何给定的测试添加前置条件或后置条件检查，但不一定适用于所有测试。到目前为止，我所拥有的是：

```
eval "&verify_precondition_TEST$n";
print $@ if $@; 
```

不幸的是，如果该函数不存在，则会输出“未定义的子例程 &verify_precondition_TEST1 调用于 ...”。

在尝试调用它之前，如何提前确定该函数是否存在？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-01-11T21:43:14.263

```
Package::Name->can('function') 
```

或者

```
*Package::Name::function{CODE}

# or no strict; *{ "Package::Name::$function" }{CODE} 
```

或者只是接受例外。如果您在 eval 中调用该函数并且设置了 $@，那么您将无法调用该函数。

最后，听起来您可能想要 Test::Class 而不是自己编写。

编辑：（ `defined &function_name`或`no strict; defined &{ $function_name }`变体），如其他答案中所述，看起来是最好的方法。UNIVERSAL::can 最适合作为方法调用的东西（风格上），当 Perl 为您提供语法来做您想做的事情时，为什么还要麻烦弄乱符号表。

学习++ :)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-01-12T01:21:48.610

```
sub function_exists {    
    no strict 'refs';
    my $funcname = shift;
    return \&{$funcname} if defined &{$funcname};
    return;
}

if (my $subref = function_exists("verify_precondition_TEST$n") {
    ...
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-11T21:49:09.787

定义：

```
if (eval "defined(&verify_precondition_TEST$n)") {
    eval "&verify_precondition_TEST$n";
    print $@ if $@;
}
else {
    print "verify_precondition_TEST$n does not exist\n";
} 
```

**编辑：**嗯，我只想到了问题中的 eval，但是用 Leon Timmermans 提出的符号引用，你不能这样做

```
if (defined(&{"verify_precondition_TEST$n"}) {
    &{"verify_precondition_TEST$n"};
    print $@ if $@;
}
else {
    print "verify_precondition_TEST$n does not exist\n";
} 
```

即使严格？

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-08-04T17:58:40.810

我曾经使用过 Leon 的方法，但是当我有多个包时，它失败了。我不确定确切的原因；我认为这与名称空间之间的范围传播有关。这是我想出的解决方案。

```
my %symbols = ();
my $package =__PACKAGE__; #bring it in at run-time
{
    no strict;
    %symbols = %{$package . "::"}; #See Symbol Tables on perlmod
}
print "$funcname not defined\n" if (! defined($symbols{$funcname}); 
```

参考：
[perlmod](http://perldoc.perl.org/perlmod.html)页面上的 __PACKAGE__ 参考。

[澳大利亚 Perl 培训上的Packages/__PACKAGE__](http://perltraining.com.au/tips/2005-06-14.html)参考。

# android - 如何在 Android 的 ListActivity 中实现上下文菜单？

> ID：433761
> 
> 赞同：39
> 
> 时间：2009-01-11T21:32:39.573
> 
> 标签：android, user-interface, long-click

您如何实现由长按或点击使用内置布局和 ListAdapter 的 ListActivity 触发的上下文菜单？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-01-12T20:09:37.320

在 onCreate 方法调用[registerForContextMenu](http://developer.android.com/reference/android/app/Activity.html#registerForContextMenu(android.view.View))像这样：

```
registerForContextMenu(getListView()); 
```

然后在[onCreateContextMenu(ContextMenu menu, View view, ContextMenuInfo menuInfo)](http://developer.android.com/reference/android/app/Activity.html#onCreateContextMenu(android.view.ContextMenu,%20android.view.View,%20android.view.ContextMenu.ContextMenuInfo))上填充菜单。menuInfo 参数可以通过这种方式提供有关哪个项目被长按的信息：

```
AdapterView.AdapterContextMenuInfo info;
try {
    info = (AdapterView.AdapterContextMenuInfo) menuInfo;
} catch (ClassCastException e) {
    Log.e(TAG, "bad menuInfo", e);
    return;
}
long id = getListAdapter().getItemId(info.position); 
```

[并且您以通常调用menu.add](http://developer.android.com/reference/android/view/Menu.html#add(int,%20int,%20int,%20java.lang.CharSequence))的方式添加菜单项：

```
menu.add(0, MENU_ITEM_ID, 0, R.string.menu_string); 
```

当用户选择一个选项时，会调用[onContextItemSelected](http://developer.android.com/reference/android/app/Activity.html#onContextItemSelected(android.view.MenuItem))。还有 [onMenuItemSelected](http://developer.android.com/reference/android/app/Activity.html#onMenuItemSelected(int,%20android.view.MenuItem))，文档中没有明确解释这一事实，只是说您使用其他方法从上下文菜单接收调用；请注意，不要共享ID。

[在 onContextItemSelected 上，您可以通过调用getMenuInfo()](http://developer.android.com/reference/android/view/MenuItem.html#getMenuInfo())获得 MenuInfo 以及所选项目的 id ：

```
try {
    info = (AdapterView.AdapterContextMenuInfo) item.getMenuInfo();
} catch (ClassCastException e) {
    Log.e(TAG, "bad menuInfo", e);
    return false;
}
long id = getListAdapter().getItemId(info.position); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-13T07:15:55.650

您还应该查看[Activity.registerForContextMenu(View)](http://code.google.com/android/reference/android/app/Activity.html#registerForContextMenu(android.view.View))。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-12-30T21:20:51.267

```
listView = (ListView) findViewById(R.id.listpockets);
registerForContextMenu(listView);

public void onCreateContextMenu(android.view.ContextMenu menu, View v, android.view.ContextMenu.ContextMenuInfo menuInfo) {
    //AdapterContextMenuInfo info = (AdapterContextMenuInfo)menuInfo;
    menu.setHeaderTitle(getString(R.string.titleDelete));   
    menu.add(0, CommonUtil.CONTEXT_MENU__DELETE_ID, 0, getString(R.string.menuDelete));
};
@Override
public boolean onContextItemSelected(MenuItem item) {

    if(item.getItemId() == CommonUtil.CONTEXT_MENU__DELETE_ID)
    {
       AdapterContextMenuInfo info = (AdapterContextMenuInfo) item.getMenuInfo();
       long id = this.listView.getItemIdAtPosition(info.position);
       Log.d(TAG, "Item ID at POSITION:"+id);
    }
    else
    {
        return false;
    }
    return true;
} 
```

# dotnetnuke - 如何将 4.x 中创建的 DotnetNuke 模块转换为 5.x 版本

> ID：433764
> 
> 赞同：3
> 
> 时间：2009-01-11T21:34:22.393
> 
> 标签：dotnetnuke

我在自己创建的 DotNetNuke 网站上有大约 40 个自定义模块和一个自定义皮肤。我尝试将其更新到 5.0 并得到一些例外。

我想看看将一堆模块和皮肤转换为在 DotNetNuke 5.0 中工作需要付出什么努力。我无法使用谷歌找到任何具体的东西。您拥有的任何经验或资源都会很棒。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T17:03:48.503

[这](http://weblogs.asp.net/briandukes/archive/2009/02/17/packaging-modules-for-dotnetnuke-5.aspx)是一篇关于 DotNetNuke 5 打包模块的博客文章。

还将DotNetNnuke [4.x 的皮肤包转换为 DotNetNuke 5.x](http://lakhlaniprashant.blogspot.com/2009/07/converting-skin-package-of-dotnetnnuke.html)似乎是您正在寻找的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-11T22:09:13.180

关于自定义皮肤，Nina Meiers 有一篇博客文章详细介绍了如何让[旧皮肤在 DNN 5 中工作](http://blogs.ninameiers.com/2008/06/29/DNN+5+Beta+Part+3.aspx)。最后，我认为她没有让它发挥作用，而且看起来这不是一项微不足道的任务，所以我准备花几个小时来了解它是如何在幕后工作的。

然而，我对这些模块一无所知。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T20:05:01.010

当我测试我的站点以升级到 DNN5 时，除了一个自定义模块之外，所有模块都可以正常工作，而无需更改任何内容。我们的皮肤也很好用。所以一个皮肤和 8 或 9 个模块效果很好。损坏的模块依赖于我正在等待更新的第三方模块。

# clojure - webjure vs compojure？

> ID：433767
> 
> 赞同：12
> 
> 时间：2009-01-11T21:36:24.197
> 
> 标签：clojure, compojure

我听说过两个基于 Clojure 的 Web 应用程序框架：Webjure 和 Compojure。有人可以告诉我哪个更好吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-05-12T01:04:35.943

到目前为止，Compojure 对我来说效果很好。我喜欢设计的简单性、灵活性以及它鼓励良好的惯用功能风格的事实。

示例服务器：

```
(use 'compojure)

(defroutes my-app
  (GET "/index.html"
    (html 
      [:h1 "Hello World!!"]
      [:body "This is some text"]))
  (ANY "*"
    [404 "Page not found"]))

(run-server {:port 80}
  "/*" (servlet my-app)) 
```

请注意，Compojure 在内部使用 Ring。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-14T06:37:47.443

现在您可以将[Ring](http://groups.google.com/group/clojure/browse_thread/thread/bbc9fd453667d953#)添加到列表中。所有这些框架都是非常新的，并且可能会迅速发展（或消亡），但 Compojure 似乎确实是过去 6 个月左右开发得最活跃的。

“更好”是一个过于主观的问题，无法得到明确的答案。尝试所有这些，看看什么有效。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-09-13T21:05:18.497

I second Rayne's recommendation on Moustache.

Right now, we are using Ring (base layer, middleware), Moustache (routing), Hiccup (html generation). We just began using Compass for CSS ([http://compass-style.org/](http://compass-style.org/)). So far, I'm happy with this collection of small libraries rather than a big "complete stack" framework (Django, Rails, ect...).

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-08-02T08:19:40.537

现在，在 compojure 之上还有一个名为[Noir的新版本。](http://www.webnoir.org/)真的很推荐，尤其是[Heroku](http://thecomputersarewinning.com/post/clojure-heroku-noir-mongo)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-13T00:12:53.883

Compojure 似乎现在最受关注。不一定代表质量，但眼睛最多的可能会发展最快。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-05-12T23:49:43.487

还有我在[TryClojure中使用的](http://tryclj.licenser.net)[Mustache](http://github.com/cgrand/moustache)和 Ring。这真是太棒了。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-09-13T20:42:15.160

Compojure 基于 Ring，这是一个低级框架，不会尝试隐藏 HTTP 的大部分内容。它类似于 WSGI (Python) 或 Rack (Ruby)。Ring 有一个中间件的概念，即可以对 HTTP 请求和/或响应做一些有意义的事情的小段代码，例如转储头信息、管理 cookie 等。Compojure 是一个更高级别的框架，有点类似于 Ruby 的 Sinatra。它的目的是为 Web 应用程序开发人员面临的大多数任务提供方便的 API（或 DSL，如果您愿意的话）。它通常与诸如 Hiccup 之类的 HTML 生成库一起使用。

在过去的几个月里，我没有听到太多关于 Webjure 的消息，我不确定它是否正在积极开发中（但我有兴趣了解更多信息）。它先于 Ring，AFAICT，它似乎已成为 Clojure Web 框架的某种标准。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-01-25T17:59:27.880

我一直在使用 Compojure 构建一个供我自己使用的项目，并且效果很好。它并没有真正妨碍您，让您专注于重要的事情，即您的问题领域。该项目大约有 1100 行 clojure，只是为了让您了解大小。

# matlab - 如何在 Matlab 上的（半）对数 3d 图上获得漂亮的色标？

> ID：433769
> 
> 赞同：3
> 
> 时间：2009-01-11T21:37:20.403
> 
> 标签：matlab, mesh, surf

在通过[外部站点](http://www.mathworks.com/matlabcentral/newsreader/view_thread/239232)的链接回答了[这个问题](https://stackoverflow.com/questions/433364/how-to-draw-semi-logarithmic-3d-plots-matlab)后，我意识到我解决了一个问题，只是为了得到另一个问题：在对数刻度上，MESH 和 SURF 函数的 C=Z 参数不能很好地工作。你得到的只是一个蓝色图表，没有通常的颜色渐变，你通过传递 3 个参数得到。

如何恢复？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-11T21:53:48.797

你看过[*caxis*](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/caxis.html)命令吗？我还可以建议您查看表面句柄对象的[*CData*](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/surface_props.html#CData)和[*CDataMapping*](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/surface_props.html#CDataMapping)属性。我希望这些链接指向正确的方向。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-11T23:05:59.463

我将搭载@ [Azim 的](https://stackoverflow.com/questions/433769/how-to-get-a-beautiful-color-scale-on-semi-logarithmic-3d-plots-on-matlab#433801)回答。使用 caxis，您应该能够为您的配色方案定义对数断点，这将防止您的整个图形变为蓝色。我不记得这是否可以使用图形属性自动完成。

# .net - Remoting 中当前调用的端口

> ID：433771
> 
> 赞同：0
> 
> 时间：2009-01-11T21:38:19.060
> 
> 标签：.net, remoting, port

在同一台计算机上可以有多个我的服务实例，每个实例都在不同的端口上。

如何检索当前请求通过的端口号以区分它们？

为了澄清，如果客户正在调用以下方法：

```
class OrdersService : MarshalByRefObject
{
    public void EnqueueOrder(Order order)
    {
        //int port = ??
    }
} 
```

我需要发出请求的端口号。

PS：我尝试实现 IServerChannelSink 接口，但它只能访问客户端的 URI（如 /foo/bar）和 IP 地址。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-11T21:53:25.897

如果您需要回电给客户，那么这应该是您合同的一部分：

```
public void EnqueueOrder(Order order, IClient client)
{
  // Work with the order.

  // Call back to the client.
} 
```

在客户端，您将使用派生自 MarshalByRefObject 的类实现 IClient 接口，并将其传递给 EnqueueOrder 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-11T22:43:42.987

这是令人发指的，而且不是很笼统，但应该对您有用：

```
TcpChannel       channel = (TcpChannel)ChannelServices.RegisteredChannels[0];
ChannelDataStore data    = (ChannelDataStore)channel.ChannelData;
string           uri     = data.ChannelUris[0];
int              port    = int.Parse(uri.Substring(uri.LastIndexOf(':'))); 
```

请注意，您需要对 System.Runtime.Remoting.dll 的引用，并且需要`using`s`System.Runtime.Remoting.Channels`和`System.Runtime.Remoting.Channels.Tcp`。

当然，如果您注册了多个通道，和/或它不是 TCP，和/或您有多个用于通道的 URI，那么您必须编写比我上面所做的 hack-job 更好的代码，但无论如何，它应该给你这个想法。

* * *

无论如何，这些单独的服务器实例是如何启动的？首先如何选择端口？客户端如何发现端口？这些问题的答案可能会揭示一种更理想的方法来区分服务器代码中的实例，例如在命令行上传递的实例标识符。

# php - PHP 是否具有 Java 的 RequestDispatcher.forward 等价物？

> ID：433774
> 
> 赞同：9
> 
> 时间：2009-01-11T21:39:44.690
> 
> 标签：php, jsp, http, forwarding

在 Java 中，我可以编写一个非常基本的 JSP `index.jsp`，如下所示：

`<% request.getRequestDispatcher("/home.action").forward(request, response); %>`

这样做的效果是用户请求`index.jsp`（或者只是包含目录，假设`index.jsp`是目录的默认文档）将在`home.action`没有浏览器重定向的情况下看到，即 [forward]( [http://java.sun.com/javaee/5 /docs/api/javax/servlet/RequestDispatcher.html#forward(javax.servlet.ServletRequest,%20javax.servlet.ServletResponse))](http://java.sun.com/javaee/5/docs/api/javax/servlet/RequestDispatcher.html#forward(javax.servlet.ServletRequest,%20javax.servlet.ServletResponse)))发生在服务器端。

我可以用 PHP 做类似的事情吗？我怀疑可以配置 Apache 来处理这种情况，但由于我可能无法访问相关的 Apache 配置，我会对仅依赖 PHP 的解决方案感兴趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-11T22:39:05.523

Request.Forward 的诀窍在于它为您提供了一个干净的、新的请求来执行您想要的操作。因此，您没有来自当前请求的残留物，例如，依赖 $_SERVER['REQUEST_URI'] 的 java eq 的脚本没有问题。

您可以直接放入一个 CURL 类并编写一个简单的函数来执行此操作：

```
<?php 
/**
 * CURLHandler handles simple HTTP GETs and POSTs via Curl 
 * 
 * @author SchizoDuckie
 * @version 1.0
 * @access public
 */
class CURLHandler
{

    /**
     * CURLHandler::Get()
     * 
     * Executes a standard GET request via Curl.
     * Static function, so that you can use: CurlHandler::Get('http://www.google.com');
     * 
     * @param string $url url to get
     * @return string HTML output
     */
    public static function Get($url)
    {
       return self::doRequest('GET', $url);
    }

    /**
     * CURLHandler::Post()
     * 
     * Executes a standard POST request via Curl.
     * Static function, so you can use CurlHandler::Post('http://www.google.com', array('q'=>'belfabriek'));
     * If you want to send a File via post (to e.g. PHP's $_FILES), prefix the value of an item with an @ ! 
     * @param string $url url to post data to
     * @param Array $vars Array with key=>value pairs to post.
     * @return string HTML output
     */
    public static function Post($url, $vars, $auth = false) 
    {
       return self::doRequest('POST', $url, $vars, $auth);
    }

    /**
     * CURLHandler::doRequest()
     * This is what actually does the request
     * <pre>
     * - Create Curl handle with curl_init
     * - Set options like CURLOPT_URL, CURLOPT_RETURNTRANSFER and CURLOPT_HEADER
     * - Set eventual optional options (like CURLOPT_POST and CURLOPT_POSTFIELDS)
     * - Call curl_exec on the interface
     * - Close the connection
     * - Return the result or throw an exception.
     * </pre>
     * @param mixed $method Request Method (Get/ Post)
     * @param mixed $url URI to get or post to
     * @param mixed $vars Array of variables (only mandatory in POST requests)
     * @return string HTML output
     */
    public static function doRequest($method, $url, $vars=array(), $auth = false)
    {
        $curlInterface = curl_init();

        curl_setopt_array ($curlInterface, array( 
            CURLOPT_URL => $url,
            CURLOPT_CONNECTTIMEOUT => 2,
            CURLOPT_RETURNTRANSFER => 1,
            CURLOPT_FOLLOWLOCATION =>1,
            CURLOPT_HEADER => 0));

        if (strtoupper($method) == 'POST')
        {
            curl_setopt_array($curlInterface, array(
                CURLOPT_POST => 1,
                CURLOPT_POSTFIELDS => http_build_query($vars))
            );  
        }
        if($auth !== false)
        {
              curl_setopt($curlInterface, CURLOPT_USERPWD, $auth['username'] . ":" . $auth['password']);
        }
        $result = curl_exec ($curlInterface);
        curl_close ($curlInterface);

        if($result === NULL)
        {
            throw new Exception('Curl Request Error: '.curl_errno($curlInterface) . " - " . curl_error($curlInterface));
        }
        else
        {
            return($result);
        }
    }

} 
```

只需将其转储到 class.CURLHandler.php 中，您就可以这样做：

当然，使用 $_REQUEST 并不是很安全（你应该检查 $_SERVER['REQUEST_METHOD']），但你明白了。

```
<?php
include('class.CURLHandler.php');
die CURLHandler::doRequest($_SERVER['REQUEST_METHOD'], 'http://server/myaction', $_REQUEST);
?> 
```

当然，CURL 并没有安装*在任何地方*，但是我们有[本地的 PHP curl 模拟器。](http://code.blitzaffe.com/pages/phpclasses/category/52/fileid/7)

此外，这为您提供了比 Request.Forward 更大的灵活性，因为您还可以捕获和后处理输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-11T23:26:48.687

我相信最接近的类似方法之一是在将php 作为 apache 模块运行时使用[virtual()函数。](http://us2.php.net/manual/en/function.virtual.php)

> **virtual()**是一个特定于 Apache 的函数，类似于 mod_include 中的函数。它执行 Apache 子请​​求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T00:45:58.217

如果您使用 Zend Framework 提供的 MVC，您可以更改控制器操作，甚至在控制器操作之间跳转。该方法是 _forward ，如此处[所述](http://framework.zend.com/manual/en/zend.controller.action.html#zend.controller.action.utilmethods)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-03-09T04:11:14.497

试试这个。

```
function forward($page, $vars = null){
    ob_clean();
    include($page);
    exit;
} 
```

在包含的页面上，该`$vars`变量将用作 java 请求属性

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T08:13:26.987

如果您担心 CURL 的可用性，那么您可以使用`file_get_contents()`和流式传输。设置如下功能：

```
function forward($location, $vars = array()) 
{
    $file ='http://'.$_SERVER['HTTP_HOST']
    .substr($_SERVER['REQUEST_URI'],0,strrpos($_SERVER['REQUEST_URI'], '/')+1)
    .$location;

    if(!empty($vars))
    {
         $file .="?".http_build_query($vars);
    }

    $response = file_get_contents($file);

    echo $response;
} 
```

这只是设置了一个 GET，但您也可以使用它来发帖`file_get_contents()`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-11-03T22:36:30.773

类似 Java 中的概念重定向和转发，也可以在 PHP 中实现。

重定向 :: `header("Location: redirect.php");`-- （地址栏中的 URL 更改）

转发 :: `include forward.php ;`-- （地址栏上的 URL 不变）

它可以通过这个和其他编程逻辑进行管理

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-01-11T21:51:55.290

你可以像这样使用：

```
header ("Location: /path/");
exit; 
```

退出是需要的，以防之前发送了一些 HTML 输出，header() 将不起作用，因此您必须在**任何**输出到浏览器之前发送新的 header。

# xslt - 合并 MbUnit 和 NUnit 测试并在 CruiseControl 中显示

> ID：433788
> 
> 赞同：2
> 
> 时间：2009-01-11T21:49:54.343
> 
> 标签：xslt, ant, continuous-integration, cruisecontrol, mbunit

我们有一个 CruiseControl 服务器，通过 Ant 运行各种 AntUnit、MbUnit 和 NUnit 测试。

为了合并它们的输出，我们在 CruiseControl 配置中有以下内容：

```
<log dir="logs/${project.name}/">
  <merge dir="${q7.build.tests.dir}/reports" pattern="*.xml" />
  <merge dir="${q7.build.tests.dir}/reports" pattern="**/*.html" />
</log> 
```

这可行，但是 MbUnit 以不同于 NUnit 和 AntUnit 的 XML 格式输出测试。例如，NUnit 似乎使用 <testcase> 来表示测试结果，而 MbUnit 使用 <run> 等等。

有谁知道如何将 MbUnit 输出转换为 NUnit 兼容格式 XML，然后我们可以通过应用 NUnit unittests.xsl 将其合并在一起以生成全套测试报告？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T00:50:09.470

如果您使用 Gallio 运行 MbUnit 和 NUnit 测试，那么输出将采用相同的格式，您可以使用 Gallio 报告。

或者，只需修改 Dashboard.config 文件以在 NUnit 报告之外包含 MbUnit 报告。

# python - Python中的速记添加/追加

> ID：433795
> 
> 赞同：12
> 
> 时间：2009-01-11T21:52:29.297
> 
> 标签：python

我喜欢在 PHP 中我可以执行以下操作

```
$myInteger++;
$myString += 'more text'; 
```

使用 Python 我必须执行以下操作

```
myInteger = myInteger + 1
myString = myString + "more text" 
```

有没有更好的方法在 Python 中添加或附加到变量？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-01-11T21:54:52.973

Python 没有递增 (++) 和递减 (--) 运算符，但它确实有 += 运算符（和 -= 等），因此您可以这样做：

```
myInteger += 1
myString += "more text" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-11T21:55:35.580

你可以像在 PHP 中那样做：

```
var += 1 
```

但我的建议是清楚地写下来：

```
var = var + 1 
```

# .net - 有没有获取开放泛型方法的 MethodInfo 的好方法？

> ID：433798
> 
> 赞同：3
> 
> 时间：2009-01-11T21:53:21.683
> 
> 标签：.net, reflection, metaprogramming

考虑这样的类型

```
public interface IHaveGenericMethod
{
   T1 Method<T1>(T1 parm);
   T2 Method<T1,T2>(T1 parm);
   int Method2(int parm);
} 
```

如何获取其方法的 methodInfo？对于常规的非泛型方法，例如 method2，我可以使用

```
typeof(IHaveGenericMethod).GetMethod("methodName",new Type[]{typeof(itsParameters)}); 
```

但是对于通用方法，我不能，因为它的参数本身不是类型。那么，我该怎么做呢？我知道我可以打电话

```
typeof(IHaveGenericMethod).GetMethods() 
```

获取该类型的所有方法，然后遍历该集合并进行一些匹配，但这很丑陋。有没有更好的办法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-13T04:10:46.413

请务必查看 MSDN 页面“ [Reflection and Generic Types](http://msdn.microsoft.com/en-us/library/609yztkt.aspx) ”。

> 因为它的参数本身不是类型

实际上，我认为这是因为您要查询*类型*参数，但是您可以提供的类型列表`GetMethod()`不是用于类型参数的。

另外，请记住，选择泛型方法的“方法组”所需的只是知道泛型类型参数的数量。所以你可以数一数。

> 然后迭代

不要迭代，查询：

```
 var mi = from mi in typeof(IHaveGenericMethod).GetMethods()
                where mi.Name == "Method"
                where mi.IsGenericMethodDefinition
                where mi.GetGenericArguments().Length == 2
                select mi; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-11T22:06:29.940

好吧，它们*是*类型 - 各种各样的：

```
 foreach (var method in typeof(IHaveGenericMethod).GetMethods())
    {
        Console.WriteLine(method.Name);
        if (method.IsGenericMethodDefinition)
        {
            foreach (Type type in method.GetGenericArguments())
            {
                Console.WriteLine("> " + type.Name);
            }
        }
    } 
```

所以你可以检查参数的数量，并检查签名。但没有什么更清洁的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-20T13:10:08.943

我个人执行以下操作：

```
public static MethodInfo ExtractMethodInfo<TDeclaringType, TMethod>(Expression<Func<TDeclaringType, TMethod>> methodAccessExpression) {
    return (MethodInfo)((ConstantExpression)((MethodCallExpression)((UnaryExpression)methodAccessExpression.Body).Operand).Object).Value;
} 
```

* * *

```
var genericQueryMethodInfo = ExpressionHelper.ExtractMethodInfo<DbContext, Func<IQueryable<object>>>(context => context.Query<object>).GetGenericMethodDefinition(); 
```

这样，你一定能找到正确的，而且我认为这比遍历所有方法信息要好。

# javascript - 让我了解 jQuery

> ID：433802
> 
> 赞同：3
> 
> 时间：2009-01-11T21:53:51.807
> 
> 标签：javascript, jquery

好的，我正在设计一个网站，并认为我会加入一些 jQuery，因为我真的需要这样的 js 经验。

我的问题页面在这里： http: [//new.focalpix.co.uk/moreinfo.php](http://new.focalpix.co.uk/moreinfo.php)

有问题的JS是：

```
$(document).ready(function(){

    $(".answer").css("display","none");

    $("#maincontent a.animate").click(function() {
        $("#maincontent .answer").slideUp('slow');
        var id = $(this).attr('href');
        $(id).slideDown('slow');
        return false;
    });

}); 
```

这很好用，但是如果您单击答案已经向下滑动的链接，则它会向上滑动，然后再次向下滑动。

我不确定阻止这种情况发生的最干净的方法 - 有什么想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-11T21:59:10.627

您应该使用[.slideToggle()](http://docs.jquery.com/Effects/slideToggle)效果。

```
$(document).ready(function() {
    $(".answer").css("display","none");
    $("#maincontent a.animate").click(function() {
        $("#maincontent .answer").slideToggle('slow');
    });
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-12T02:43:10.927

首先，我建议您的常见问题解答采用以下结构：

```
<div id="faq">
  <div class="qa" id="faq_greenandflies">
    <span class="q">What is <a href="#faq_greenandflies">green and flies</a></span>
    <div class="a">
      Super Pickle!
    </div>
  </div>
  <div class="qa" id="faq_redandbadforteeth">
    <span class="q">What is <a href="#faq_redandbadforteeth">Red and bad for your teeth</a></span>
    <div class="a">
      a Brick
    </div>
  </div>
  <!--
  More FAQ's here

  -->
</div> 
```

然后定义你的jQuery如下：

```
 <script type="text/javascript">
    $(function(){
  // hide all answers
  $('div#faq .qa .a').hide();

      // bind a click event to all questions
  $('div#faq .qa .q a').bind(
        'click',
        function(e){
          // roll up all of the other answers (See Ex.1)
          $(this).parents('.qa').siblings().children('.a').slideUp();
          // reveal this answer (See Ex.2)
          $(this).parents('.qa').children('.a').slideDown();
          // return true to keep any other click events       
          return true;
        });

      // check location.hash to see if we need to expand one (direct link)
      $(location.hash).find('.q a').click();
    });
</script> 
```

解释：

（例 1）

*   *这*是被点击的链接
*   获取包含*此*元素并具有“qa”类的元素（包含问题和答案的框）
*   选择它的所有兄弟姐妹。（我们现在将所有 qa 作为 jQ 对象）
*   隐藏答案

（例 2）

*   *这*是被点击的行或链接
*   获取包含*此*元素并具有“qa”类的元素（包含问题和答案的框）
*   揭晓答案

一个**工作演示**在[这里](http://yaauie.com/stackoverflow/433802/)。

这为您做了几件事：

*   如果用户[深层链接到答案](http://yaauie.com/stackoverflow/433802/#whiteandrocky)，答案会自动显示
*   如果用户点击一个答案，所有其他答案都将被隐藏
*   您可以为您的 div 提供正确的 id，这有助于搜索引擎优化指向各个答案的链接

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T03:15:08.040

像 Soviut 所说的那样使用 slideToggle() ，但只是作为一个提示——您可以在实际的 CSS 文件中声明 display 属性，而不是在 javascript 中声明它。jQuery 将了解它隐藏在样式表中的事实，并且仍然执行适当的滑动功能。

你也可以使用`$(".answer").hide();`

而不是设置显示 CSS 属性。只是想我会让你知道。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-01-11T21:59:38.770

尝试使用一种方法，例如：

```
 $(selector).one('effect', 'data for effect', callback function); 
```

它确保每个元素只发生一次效果。

# .net - .NET 框架是否提供任何用于执行几何计算的内置类？

> ID：433806
> 
> 赞同：1
> 
> 时间：2009-01-11T21:56:32.363
> 
> 标签：.net, math, geometry

.NET 框架以执行几何计算的类的方式提供什么（如果有的话）？例如，计算两点之间的距离（表示为 (x,y)）或求解直角三角形的未知边或内角？（我知道这两个都很容易解决；我只是以这些为例）。

如果没有内置任何内容，是否有人知道任何可能有用的开源或第三方库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-11T23:06:09.367

我知道将名为[WW.Math](http://www.woutware.com/WW.Math3.5.html)的数学库放在一起的程序员。它完全用 C# 编写。我强烈推荐它，因为它有据可查且使用直观。它广泛用于我们自己的 2d/3d 工程软件中。

编辑：我应该提到图书馆不是免费的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-11T21:58:54.463

那么，SQL Server 库中的空间类型可能有助于满足您的某些需求吗？（当然是诸如 2D/3D 表面上的距离/面积之类的东西）。这些旨在从 TSQL 中使用，但据我了解，您也应该能够在 .NET 中使用它们（因为它们只是程序集）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-11T22:29:20.690

[OpenTK.Math](http://www.opentk.com/)还不错。虽然缺少任何文档。

# database - 表模块与域模型

> ID：433819
> 
> 赞同：28
> 
> 时间：2009-01-11T22:03:37.560
> 
> 标签：database, design-patterns, database-design, entity-attribute-value

前几天我问了关于[选择一种方法来存储用户配置文件](https://stackoverflow.com/questions/429878/choosing-a-method-to-store-user-profiles)的问题，并收到了[来自 David Thomas Garcia 的有趣回复，](https://stackoverflow.com/questions/429878/choosing-a-method-to-store-user-profiles#430044)建议我使用表模块设计模式。看起来这可能是我想要采取的方向。我在谷歌上出现的所有内容似乎都是相当高水平的讨论，所以如果有人能指出一些例子的方向或让我更好地了解所涉及的具体细节，那就太棒了。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-01-11T23:25:01.250

最好的参考是 Martin Fowler 的“企业应用程序架构模式”：

这是表模块部分的摘录：

> *表模块*用数据库中的每个表一个类来组织域逻辑，并且一个类的单个实例包含将作用于数据的各种过程。*与领域模型*的主要区别在于，如果您有很多订单，*领域模型*每个订单将有一个订单对象，而*表格模块*将有一个对象来处理所有订单。

表模块在您为用户配置文件数据描述的灵活数据库架构中特别有用，基本上是[实体-属性-值](http://en.wikipedia.org/wiki/Entity-attribute-value_model)设计。

通常，如果您使用域模型，则基础表中的每一行都将成为一个对象实例。由于您将用户配置文件信息存储在多行中，因此您最终不得不创建许多域模型对象，而您真正想要的是一个封装所有用户属性的对象。

相反，表模块使您更容易编写适用于基础数据库表中多行的逻辑。如果您为给定用户创建配置文件，您将指定所有这些属性，并且 Table Module 类将具有将其转换为一系列`INSERT`语句的代码，每个属性一行。

```
$table->setUserProfile( $userid, array('firstname'=>'Kevin', 'lastname'=>'Loney') ); 
```

同样，查询给定用户的个人资料将使用表格模块将查询结果集的多行映射到对象成员。

```
$hashArray = $table->getUserProfile( $userid ); 
```

# matlab - 帮我理解FFT函数（Matlab）

> ID：433831
> 
> 赞同：7
> 
> 时间：2009-01-11T22:09:57.517
> 
> 标签：matlab, fft

1) 除了负频率，FFT 函数提供的最小频率是多少？是零吗？
2）如果为零，我们如何在对数刻度上绘制零？
3）结果总是对称的？或者它只是看起来是对称的？
4）如果我使用 abs(fft(y)) 比较 2 个信号，我会失去一些准确性吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-12T01:42:50.363

> 1) 除了负频率，FFT 函数提供的最小频率是多少？是零吗？

`fft(y)`返回一个向量，其中包含 的 DFT 的第 0 到 (N-1) 个样本`y`，其中 y(t) 应该被认为是在 0 ... N-1 上定义的（因此， y(t) 可以被认为是在 Z) 上定义的周期信号。

的第一个样本`fft(y)`对应于频率 0。真实、离散时间、周期性信号的傅里叶变换也具有离散域，它是周期性的和厄米特的（见下文）。因此，*负频率*的变换是正频率的相应样本的共轭。

例如，如果您将（的周期性重复）解释`y`为在 Z（采样周期 == 1）上定义的周期性实信号，那么 的域`fft(y)`应解释为 N 个等距点 0, 2π/N ... 2π(N -1)/N。负频率 -π ... -π/N 的变换样本是频率 π ... π/N 的样本的共轭，并且等于频率 π ... 2π(N- 1)/N。

> 2）如果为零，我们如何在对数刻度上绘制零？

如果您想绘制某种[波特图](http://en.wikipedia.org/wiki/Bode_plot)，您可以仅绘制正频率的变换，忽略与最低频率（特别是 0）相对应的样本。

> 3）结果总是对称的？或者它只是看起来是对称的？

如果是实数，它具有[厄米对称性](http://en.wikipedia.org/wiki/Hermitian_symmetry)`y`：它的实部是对称的，它的虚部是反对称的。换句话说，它的幅度是对称的，而它的相位是反对称的。

> 4）如果我使用 abs(fft(y)) 比较 2 个信号，我会失去一些准确性吗？

如果您的意思是`abs(fft(x - y))`，这没关系，您可以使用它来了解差异的频率分布（或误差，如果 x 是 y 的估计值）。如果您的意思是`abs(fft(x)) - abs(fft(y))`（???），您至少会丢失相位信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-11T22:20:29.710

好吧，如果你想了解快速傅里叶变换，你想回到基础并了解 DFT 本身。但是，这不是你问的，所以我只是建议你在自己的时间这样做:)

但是，在回答您的问题时：

1.  是的，（除了否定，正如你所说）它是零。N 点输入的范围是 0 到 (N-1)。
2.  在 MATLAB 中？我不确定我是否理解您的问题 - 像绘制任何其他值一样绘制零值......尽管正如 duffymo 正确指出的那样，没有自然对数为零。
3.  它本质上类似于 sinc（正弦基数）函数。不过，它不一定是对称的。
4.  你不会失去任何准确性，你只会得到幅度响应（但我想你已经知道了）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-11T22:45:14.497

咨询“C 中的数值配方”，第 12 章“快速傅立叶变换”说：

1.  频率范围从负 fc 到正 fc，其中 fc 是奈奎斯特临界频率，等于 1/(2*delta)，其中 delta 是采样间隔。所以频率当然可以是负的。

2.  你不能绘制不存在的东西。没有自然对数为零。您可以将频率绘制为 x 轴，也可以为半对数轴选择一个不包括零的范围。

3.  频率范围内是否存在对称性取决于时域中函数的性质。您可以在频域中绘制关于 y 轴不对称的图。

4.  我不认为采用这样的绝对值是一个好主意。您需要阅读更多关于卷积、校正和信号处理的信息，以比较两个信号。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-12T02:28:46.213

1.  fft 的结果可以是 0。其他人已经回答了。
2.  要绘制 0 频率，诀窍是将其设置为一个非常小的正数（为此我使用 exp(-15)）。
3.  已经被其他人回答了。
4.  如果您只对幅度感兴趣，是的，您可以这样做。例如，这适用于许多图像处理问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-11T23:00:27.477

你的问题的一半：

3) FFT运算的结果取决于信号的性质；因此没有什么要求它是对称的，尽管如果是对称的，您可能会获得有关信号属性的更多信息

4）这将比较一对信号的幅度，但那些相等并不能保证 FFT 是相同的（不要忘记相位）。但是，它可能足以满足您的目的，但您应该确信这一点。

# apache-flex - 没有 Flex 框架/组件的 MXML

> ID：433832
> 
> 赞同：3
> 
> 时间：2009-01-11T22:10:31.103
> 
> 标签：apache-flex, flash, mxml, mxmlc

Flex 编译器可以编译不包含任何 Flex 组件字节码的“纯 AS3”SWF 文件。所以，

是否有可能创建一个自定义组件框架（用于代替 Flex 框架），仍然可以使用 MXML（阅读：标记）进行可视化布局，并编译为 SWF，而不依赖于 Flex 框架本身？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-12T04:48:17.400

是的，这是可能的。您的 MXML 文件本质上只是指定类的一种不同方式。您可以通过编译您的项目并提供`-compiler.keep-generated-actionscript=true`给`mxmlc`.

bar.mxml：

```
<?xml version="1.0" encoding="utf-8"?>
<flash:Sprite xmlns:flash="flash.display.*">
</flash:Sprite> 
```

用 编译后`mxmlc -compiler.keep-generated-actionscript=true bar.mxml`变成下面这样。

生成/栏生成.as：

```
package {
    import flash.display.Sprite;
    // bunch of imports
    public class bar extends Sprite {
        public function bar() { super(); }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-12T04:44:25.643

有两种不同的编译器：一种用于将 ActionScript 代码编译为 AVM 字节码，另一种 (mxmlc) 将 MXML 文件编译为 ActionScript 代码，然后由第一个编译器编译。如果您想查看生成了什么 AS3 代码，请将“-keep”参数传递给 MXML 编译器。

从理论上讲，可以按照您的建议进行操作。我的猜测是，mxmlc 对 UIComponent 类的功能进行了很大的调整，因此您可能不得不对 mxmlc 进行一些修改，以免它对非 UIComponent 类产生影响。即便如此，由于诸如 [Bindable] / 数据绑定之类的东西利用了 Flex 框架功能（不是普通的 Flash Player / AVM 功能），您将重写大量代码。

# c# - 动态创建控件

> ID：433833
> 
> 赞同：0
> 
> 时间：2009-01-11T22:10:42.507
> 
> 标签：c#

```
 for (int i = 0; i < 200; i++)
        {

            Control control = new Control();

            control = new CheckBox();
            Size size = control.Size;
            Point point = new Point(20, 22);
            control.Location = point; 
            int width = size.Width + 5;
            i += width;
            list.Add(control);
        }

foreach(Control c in list)
{

} 
```

如何创建复选框的新实例？因为这样我每次只得到一个复选框。我想在每行中获得三个复选框。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-11T22:15:01.313

这是winform吗？第一点：你不需要`new Control()`每次（你只是在你的时候丢弃它`new CheckBox()`。你究竟希望布局如何出现？你能再描述一下吗？

我想`TableLayoutPanel`这可能是一个合理的开始......

```
[STAThread]
static void Main() {
    Application.EnableVisualStyles();
    Form form = new Form();
    TableLayoutPanel layout = new TableLayoutPanel();
    layout.Dock = DockStyle.Fill;
    form.Controls.Add(layout);
    layout.AutoScroll = true;
    layout.ColumnCount = 3;
    // size the columns (choice just to show options, not to be pretty)
    layout.ColumnStyles.Add(new ColumnStyle(SizeType.Absolute, 200));
    layout.ColumnStyles.Add(new ColumnStyle(SizeType.Percent, 50));
    layout.ColumnStyles.Add(new ColumnStyle(SizeType.AutoSize));    
    layout.GrowStyle = TableLayoutPanelGrowStyle.AddRows;
    for (int i = 0; i < 200; i++)
    {
        CheckBox chk = new CheckBox();
        chk.Text = "item " + i;
        layout.Controls.Add(chk);
    }

    Application.Run(form);
} 
```

否则，您需要手动设置每个的`Location`（或`Top`和`Left`）；不简单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-11T23:03:45.940

你的代码有问题。让我们从示例代码而不是课程开始。我将首先创建一个面板，如果您想删除您创建的复选框，那就太好了。您可能会对用户单击复选框感兴趣，因此让我们为此添加一个事件。启动一个新的 WF 项目并在表单上放置一个按钮。双击它，然后粘贴以下代码：

```
private void button1_Click(object sender, EventArgs e) {
  // Give the 3 checkboxes a decent spacing
  int height = this.Font.Height * 3 / 2;
  // Create the panel first, add it to the form
  Panel pnl = new Panel();
  pnl.Size = new Size(100, 3 * height);
  pnl.Location = new Point(10, 5);
  this.Controls.Add(pnl);
  // Make three checkboxes now
  for (int ix = 0; ix < 3; ++ix) {
    CheckBox box = new CheckBox();
    box.Size = new Size(100, height);
    // As pointed out, avoid overlapping them
    box.Location = new Point(0, ix * height);
    box.Text = "Option #" + (ix + 1).ToString();
    box.Tag = ix;
    // We want to know when the user checked it
    box.CheckedChanged += new EventHandler(box_CheckedChanged);
    // The panel is the container
    pnl.Controls.Add(box);
  }
}

void box_CheckedChanged(object sender, EventArgs e) {
  // "sender" tells you which checkbox was checked
  CheckBox box = sender as CheckBox;
  // I used the Tag property to store contextual info, just the index here
  int index = (int)box.Tag;
  // Do something more interesting here...
  if (box.Checked) {
    MessageBox.Show(string.Format("You checked option #{0}", index + 1));
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-11T22:17:40.433

看起来您获得了 200 个实例，所有实例都放置在同一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-11T22:16:16.427

在循环体内实例化 3 个新复选框，相应地设置它们的属性并将它们中的每一个添加到列表中。上述代码完成后，您将拥有 600 个复选框。

list.Add(Control1);

list.Add(Control2);

list.Add(Control3);

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-11T22:21:59.440

我不确定您要做什么，但是我稍微清理了您的代码：

```
for (int i = 0; i < 200; i++)
{

    Control control = new CheckBox();

    control.Location = new Point(20, 22); 
    i += control.Size.Width + 5;

    list.Add(control);
} 
```

如果要添加刚刚创建的控件，则不应将新实例添加到列表中。

还：

```
Control control = new Control();
control = new CheckBox(); 
```

有点多余。另外，为了在同一个地方多次没有得到一个控制，你应该改变这一点。希望这可以帮助

# design-patterns - 是否应该严格执行设计模式？

> ID：433837
> 
> 赞同：4
> 
> 时间：2009-01-11T22:15:27.880
> 
> 标签：design-patterns

我目前正在阅读Erich Gamma 和其他人[的“设计模式：可重用的面向对象软件的元素” 。](https://rads.stackoverflow.com/amzn/click/com/0582844428)我决定做一些小项目，看看将设计模式应用于我编写的软件的实际结果。

我应该对实施它们有多严格？我在互联网上看到了一些实现[解释器模式](http://en.wikipedia.org/wiki/Interpreter_pattern)的示例，这些示例在实现中跳过了整个类/接口/方法。是否应该允许这样做，或者最好严格执行以避免将来出现问题，即预先支持功能？还是设计模式不应该被视为解决所有问题的答案，是否应该以适用于当前情况的方式应用它们，即特定于代码？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-11T22:21:27.897

没有银弹。设计模式是一种指导方针，一种可重用设计的公式，这些设计在过去曾为其他人工作，以实现常见问题的解决方案。但是，如果该模式的某些部分会使您的软件不必要地*复杂化*，那么您并不完全需要使用它。

设计模式的目标是简化和简化您的设计。如果它不这样做，它就不值得使用。

其他人可能有不同的意见。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-11T22:19:20.290

这就是为什么它们被称为模式而不是算法或接口的原因。

它们是对不断出现在应用程序中的设计的通用描述。每个实现都将针对它所使用的情况进行专门化，尽管它如何做事的整体模式是相同的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-11T22:19:38.667

对于您对设计模式所做的任何事情，您应该能够问自己一个简单的问题：**这如何使我的软件变得更好**？请具体说明。如果您无法列出在您的特定情况下实现设计模式的具体优势，请不要打扰；同样，如果您掌握了该模式的“要点”，您可能能够实现其中对您的情况有用的部分。

《设计模式》一书在这里特别好——它们列出了使用每种模式的具体优势，以及它们适用的详细案例以及原因。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-11T22:24:58.047

除了 Ian Varley 的“这如何让我的软件变得更好”的观点之外。您可以从该声明中提取以下内容：“这会降低我的软件的复杂性吗？” 在设计软件时，管理复杂性是关键，设计模式应该对此做出贡献。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-11T22:32:04.117

几乎所有读过这本书的人都会患上“有图案的小男孩”综合症。您开始寻找将模式注入代码的方法，无论它们是否合适。最终你冷静下来，意识到这本书既是关于交流的常用词汇，也是关于代码行的。

这是一本很棒的书，很经典。如果您查看 Java 或 C# SDK，您会发现两者都充满了示例（例如，Java RMI 中的代理、java.io 包中的装饰器、java.sql 和 JDBC 中的工厂等）

但我发现它们在开发过程中被发现而不是强行输入代码库时效果最好。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-11T22:25:55.783

> 是否应该...预先支持功能？

这取决于您需要多长时间才能需要该功能，以及您是否**完全确定**您将需要它，但通常答案是“不”：谷歌为[YAGNI一词](http://www.google.com/search?&q=yagni)

> 好吧，我的真正意思是设计模式的目的之一是可重用性，我可以在其他项目中重用代码。

我的政策和/或 YAGNI 政策往往是：

1.  编写我现在需要的代码
2.  如果我以后需要别的东西，然后重用和/或更改我之前写的东西，也许通过[重构](http://www.google.com/search?&q=refactoring)

如果我一开始就没有实现这两个步骤，那么这两个步骤会更快、更容易，以后也不需要更改，我什至还不需要的功能。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-11T22:19:57.167

正如 SO 曾经指出的那样，[使用你的大脑](https://stackoverflow.com/questions/406760/whats-your-most-controversial-programming-opinion#406775)是编写好软件的最佳方式。一切都取决于具体情况。

# c# - 访问 ListView 的 LayoutTemplate 中的控件

> ID：433846
> 
> 赞同：23
> 
> 时间：2009-01-11T22:20:01.770
> 
> 标签：c#, asp.net, listview, asp.net-3.5

如何访问控件中的`LayoutTemplate`控件`ListView`？

我需要访问`litControlTitle`并设置它的`Text`属性。

```
<asp:ListView ID="lv" runat="server">
  <LayoutTemplate>
    <asp:Literal ID="litControlTitle" runat="server" />
    <asp:PlaceHolder ID="itemPlaceHolder" runat="server" />
  </LayoutTemplate>
  <ItemTemplate>
  </ItemTemplate>
</asp:ListView> 
```

有什么想法吗？也许通过`OnLayoutCreated`事件？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-01-11T22:37:27.820

试试这个：

```
((Literal)lv.FindControl("litControlTitle")).Text = "Your text"; 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2010-05-20T10:02:57.260

完整的解决方案：

```
<asp:ListView ID="lv" OnLayoutCreated="OnLayoutCreated" runat="server">
  <LayoutTemplate>
    <asp:Literal ID="lt_Title" runat="server" />
    <asp:PlaceHolder ID="itemPlaceHolder" runat="server" />
  </LayoutTemplate>
  <ItemTemplate>
  </ItemTemplate>
</asp:ListView> 
```

在代码隐藏中：

```
protected void OnLayoutCreated(object sender, EventArgs e)
{
    (lv.FindControl("lt_Title") as Literal).Text = "Your text";
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-02-20T22:53:34.303

这种技术适用于模板布局；使用控件的init事件：

```
<asp:ListView ID="lv" runat="server" OnDataBound="lv_DataBound">
  <LayoutTemplate>
    <asp:Literal ID="litControlTitle" runat="server" OnInit="litControlTitle_Init" />
    <asp:PlaceHolder ID="itemPlaceHolder" runat="server" />
  </LayoutTemplate>
  <ItemTemplate>
  </ItemTemplate>
</asp:ListView> 
```

并捕获对控件的引用，以便在 ListView 的 DataBound 事件中的代码隐藏（例如）中使用：

```
private Literal litControlTitle;

protected void litControlTitle_Init(object sender, EventArgs e)
{
    litControlTitle = (Literal) sender;
}

protected void lv_DataBound(object sender, EventArgs e)
{
    litControlTitle.Text = "Title...";
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-04T13:32:25.537

对于嵌套 LV 回路：

```
void lvSecondLevel_LayoutCreated(object sender, EventArgs e)
{
    Literal litText = lvFirstLevel.FindControl("lvSecondLevel").FindControl("litText") as Literal;
    litMainMenuText.Text = "This is test";
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-10-20T05:10:13.190

如果你需要 VB 版本，这里是

```
Dim litControl = CType(lv.FindControl("litControlTitle"), Literal)
litControl.Text = "your text" 
```

# .htaccess - "RewriteRule ^([^/]+) index.php?id=$1" 帖子 "index" 改为输入文本

> ID：433848
> 
> 赞同：2
> 
> 时间：2009-01-11T22:20:57.540
> 
> 标签：.htaccess, mod-rewrite

如果我通过输入`/?id=some_text`url 来执行此操作，那么 index.php 脚本将按原样工作，但如果我这样做，`/some_text`则 index.php 总是接收到具有值“index”的 id。

起初我有`RewriteRule ^([^/]+) ?id=$1`但返回“内部服务器错误”而不是网页，然后我将其更改为 RewriteRule ^([az]+) index.php?id=$1 并且我停止接收错误页面但脚本开始接收“索引”无论我输入什么，作为价值

此规则在使用 MAMP 的本地计算机上有效，但是当我将其上传到服务器时它停止工作。

此文件夹的 .htaccess 文件仅包含此规则

```
RewriteEngine on
RewriteRule ^([^/]+) ?id=$1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T01:27:22.063

我相信它可能试图通过 index.php 进行递归，因为它似乎符合规则。

尝试：

```
RewriteEngine On
RewriteCond  %{REQUEST_URI}  !index
RewriteRule ^([^/]+) index.php?id=$1 [L] 
```

RewriteCond 是为了确保它不会将规则应用于自身的结果。[L] 是为了确保它不会尝试应用任何其他规则。

# c++ - 关于字符串文字和动态分配的两个基本 C++ 问题

> ID：433850
> 
> 赞同：3
> 
> 时间：2009-01-11T22:21:49.863
> 
> 标签：c++

这两个是等价的吗？

char * aString = "这是一个字符串。";

char aString[] = "这是一个字符串。";

据我了解，C++ 按地址存储字符串，因此指针获得了有效地址。我假设字符串也存储为 char 类型？但是它怎么知道要为字符串分配多少内存呢？通常，char 数组需要预设其数组大小。我相信 [] 类型数组在编译之前由编译器计算。字符串文字指针也会发生这种情况吗？

关于我的第二个问题，这两者有什么区别：

int someNumber;

int * someNumber = new int;

第二个应该是动态分配。如果我理解正确的概念，它会在读取声明后立即分配内存。但是标准声明中会发生什么？基本上，我需要了解动态分配如何优于标准声明。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-11T22:32:16.300

```
char * aString = "This is a string."; 
```

它使指针`aString`指向一个静态分配的 char 数组，其中包含`"This is a string."`. 该字符串是*不可*写的，即使指针的类型可能表明您可以写入它。请参阅下面链接中的答案，了解避免它的原因以及如何做得更好。

```
char aString[] = "This is a string."; 
```

它正在创建一个具有 type 的数组`char[18]`。即使你用`aString`具有 type的声明符来告诉它`char[]`，它实际上是在定义一个具有完整类型的数组——也就是说，为该数组定义了一个长度。那是因为它是直接初始化的，编译器可以推导出数组的大小。数组*是*可写的。您可以自由更改其中的字符。我试图在这个答案中明确区别：[C++ 字符串：[] vs. *](https://stackoverflow.com/questions/308279/c-vs#308724)

```
int someNumber; 
```

它是在堆栈上创建的整数变量。它*没有*初始化。它具有自动存储持续时间：超出范围（从函数返回，跳出循环......）将释放它的内存。你当然可以写多少就写多少。

```
int * someNumber = new int; 
```

它是一个指向动态分配的整数的指针。int*未*初始化。当指针超出范围时，内存*不会被释放。*也就是说，当你的函数返回时，内存仍然存在。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-11T22:38:59.080

```
char *aString = "This is a string."; 
```

声明一个指向字符串的指针。即，指向定义此字符串的数据段内存区域的指针。

```
char aString[] = "This is a string."; 
```

在堆栈上声明一个字符数组并将字符串的内容复制到其中。与所有堆栈分配一样，您不能从函数中返回变量。

```
int someNumber; 
```

是在堆栈上声明的整数。

```
int *someNumber = new int; 
```

“new int”在堆上创建一个动态分配。并且“int *someNumber =”将地址分配给指向整数的指针。

对于动态分配，您需要记住在完成时调用 delete 以允许堆恢复内存或使用智能指针或类似方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T03:25:39.330

正确答案中有一些不清楚的地方。而 char foo[] = "literal"; 确实创建了一个可写的文本数组，每次函数启动时，它都会重置文本：

```
void func() {
    char foo[] = "hello";

    cout << foo << endl;

    foo[2] = 'w';
    foo[3] = 'w';

    cout << foo << endl;
}

func();
func(); 
```

如果你运行它，你会得到：

```
hello
hewwo
hello
hewwo 
```

字符串文字“hello”存储在应用程序的数据段中，当 func 到达声明 foo 的语句时，它将字符串从数据段复制到堆栈中。

另一方面 char* foo = "hello"; 是非法的，因为 "hello" 是一个 const 左值。您需要将其声明为 const char* foo = "hello";。这将创建一个直接指向存储在程序数据段中的数据的指针，并且写入该数据是未定义的。

如果你抛弃 constness，你可以写信给它。

```
void func() {
    const char* c_foo = "hello";
    char* foo = const_cast<char*>(c_foo);

    cout << foo << endl;

    foo[2] = 'w';
    foo[3] = 'w';

    cout << foo << endl;
}

hello
hewwo
hewwo
hewwo 
```

最有可能的是，您会在所有后续调用 func() 时看到 hewwo，如上所示。然而，在现代多处理操作系统中，如果程序运行时间足够长，它可能会被换出内存，当它被换回时，包含“hello”字符串的数据段将从磁盘上的程序可执行文件中读取，并且非常对 func 的下一次调用可能会打印 hello hewwo 或什至 hello hello 或 hello hewlo 或 hewwo hello 或您能想到的任何其他组合，因为时间片可能发生在执行期间的任何时间点。

希望这不会太令人困惑。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-01-11T22:28:15.777

对于您的第一个问题，编译器会计算字符串中的字符数并创建该大小的数组。字符 *theString="你好"; 在堆上创建一个 char 数组。字符 []theString="你好"; 在堆栈上创建该数组。对于你的第二个问题 int *thenum=new in; 是动态的。标准声明将数据存储在堆栈上，这意味着不必分配内存。内存分配可能是一个缓慢的过程，尤其是当堆碎片时。虽然堆栈空间是有限的，所以一般规则是当您需要大量内存或具有需要指针的数据结构时使用动态分配，当您只需要变量或小对象时使用标准分配。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-01-11T22:25:06.330

是的，在 C 语言中，类型 *foo 等价于类型 foo[]。

静态变量在加载时分配在数据段上，而动态变量在运行时分配在堆栈上。

# java - C++ 程序员有哪些常见的 Java 陷阱/陷阱？

> ID：433853
> 
> 赞同：7
> 
> 时间：2009-01-11T22:22:35.760
> 
> 标签：java, c++, language-switching

正如问题所说，C++ 程序员在切换到 Java 时面临哪些常见/主要问题？我正在寻找工程师必须进行的一些广泛的主题名称或示例以及日常调整。然后我可以去深入阅读这个。

我对那些在 C++ 中工作多年并且不得不使用 Java 的工程师的意见特别感兴趣，但是任何来自其他人的指针甚至是书籍推荐都非常受欢迎。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-11T22:36:42.047

*   在 C++ 中，您将使用析构函数来清理文件描述符、数据库连接等。天真的等价物是使用终结器。不。曾经。

而是使用这种模式：

```
OutputStream os;
try {
  os = ... 
  // do stuff
} finally {
  try { os.close(); } catch (Exception e) { }
} 
```

你最终会做很多这样的事情。

*   如果您不指定访问修饰符，**则在 Java 中，成员默认为包私有**，不像 C++ 中它们是私有的。Package-private 是一个烦人的访问级别，这意味着它是私有的，但同一个包中的任何内容也可以访问它（恕我直言，这是一个愚蠢的默认访问级别）；
*   没有堆栈/堆分离。一切都是在堆上创建的（好吧，这并不完全正确，但我们会假装它是）；
*   没有传递引用；
*   函数指针的等价物是匿名接口。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-11T22:45:03.590

我从 C++ 到 Java 的最大障碍是放弃程序代码。我非常习惯在程序中将我的所有对象捆绑在一起。没有 java 中的程序代码，我到处都做了循环引用。我必须学习如何从对象中调用对象，而不会使它们相互依赖。这是最大的障碍，但最容易克服。

第二个个人问题是文档。JavaDoc 很有用，但是对于许多 Java 项目来说，他们误以为所需要的只是 JavaDoc。我在 C++ 项目中看到了更好的文档。这可能只是个人对代码之外文档的偏好。

数字 3\. 实际上在 java 中有**指针，只是没有****指针算术**。在 java 中它们被称为**引用**。不要以为你可以忽略事物所指向的地方，它会大咬一口回来。

*   **== 和 .equals 不相等。**

*   == 将查看指针（引用），而 .equals 将查看引用指向的值。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-11T22:39:48.843

[泛型](http://java.sun.com/docs/books/tutorial/java/generics/index.html)（而不是模板），特别是使用[类型擦除](http://java.sun.com/docs/books/tutorial/java/generics/erasure.html)实现它们的方式。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-11T23:22:45.137

既然您提到书籍推荐，请务必阅读[Effective Java，第 2 版。](https://rads.stackoverflow.com/amzn/click/com/0321356683)——它解决了我在答案中看到的大多数陷阱。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-02-24T23:53:53.953

在考虑复制构造函数时意外创建引用：

```
myClass me = new myClass();
myClass somebodyElse = me; /* A reference, not a value copied into an independent instance! */
somebodyElse.setPhoneNumber(5551234);
/* Hey... how come my phone doesn't work anymore?!?!?  */ 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-12T01:18:59.617

*   没有多重继承，每个类都隐含地派生自 java.lang.Object（它有许多你必须知道和理解的重要方法）
*   您可以通过实现接口来获得一种多重继承
*   除了 '+' （用于字符串）之外，没有运算符重载，而且绝对没有你可以自己做
*   没有无符号数字类型，除了 char，它不应该真正用作数字类型。如果必须处理无符号类型，则必须进行大量转换和屏蔽。
*   字符串不是以 null 结尾的，而是基于 char 数组，因此是不可变的。因此，通过在循环中附加 += 来构建一个长字符串是 O(n^2)，所以不要这样做；改用 StringBuilder 。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-11T22:27:05.187

习惯了垃圾收集器。无法依赖析构函数来清理 GC 无法处理的资源。

一切都是按值传递的，因为传递的是引用而不是对象。

没有复制构造函数，除非您需要克隆。没有赋值运算符。

默认情况下所有方法都是虚拟的，这与 C++ 正好相反。

对接口的显式语言支持 - C++ 中的纯虚拟类。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-11T23:00:58.863

正是这些细微的语法差异吸引了我。缺乏析构函数。

另一方面，能够为每个类编写一个 main（非常方便或测试）是非常好的；习惯之后，jar 文件的结构和技巧真的很不错；语义是完全定义的（例如，int 在任何地方都是相同的）这一事实非常好。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-12T17:45:22.620

我最糟糕的问题是始终牢记内存的所有权。在 C++ 中，这是必须要做的事情，它在开发人员的脑海中创造了一些难以克服的模式。在 Java 中，我可以忘记它（在很大程度上，无论如何），这使得一些在 C++ 中非常尴尬的算法和方法成为可能。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-02-25T00:09:09.603

Java 中没有对象，只有对对象的引用。例如：

```
MyClass myClass;   // no object is created unlike C++. 
```

但 ：

```
MyClass myClass = new MyClass();   // Now it is a valid java object reference. 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-11T23:32:48.143

我读过的关于 Java“陷阱”的最好的书是[Java Puzzlers: Traps, Pitfalls, and Corner Cases](https://rads.stackoverflow.com/amzn/click/com/032133678X)。它**不是**专门针对 C++ 开发人员的，但它充满了你想要注意的事情的例子。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-12T01:07:07.673

所有方法都是虚拟的。

参数化类型（泛型）实际上并不创建代码参数特定的代码（即，`List<String>`使用与编译器相同的字节码`List<Object>;`是唯一会抱怨的东西，如果您尝试将 an`Integer`放入前者）。

可变参数很容易。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-02-25T00:41:40.470

将方法参数指定为 final 并不意味着您最初认为的含义

```
private void doSomething(final MyObject myObj){
   ...
   myObj.setSomething("this will change the obj in the calling method too");
   ...
} 
```

因为 java 是按值传递的，所以它正在做你所要求的事情，除非你了解 java 如何传​​递引用的值而不是对象的值，否则不会立即显而易见。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-10-25T18:58:24.080

另一个值得注意的是关键字`final`and `const`。Java 将 const 定义为保留关键字，但没有详细说明它的用法。还

```
object1=object2 
```

不复制对象它更改引用

# ruby-on-rails - Rails：如何访问 RESTful 助手？

> ID：433860
> 
> 赞同：37
> 
> 时间：2009-01-11T22:25:11.667
> 
> 标签：ruby-on-rails, ruby, rest, routing

我正在尝试阅读[Rails 路由指南](http://guides.rubyonrails.org/routing_outside_in.html)，但我陷入了第[3.3](http://guides.rubyonrails.org/routing_outside_in.html#_urls_and_paths)节：

> 创建 RESTful 路由还会在您的应用程序中提供一堆帮助程序

然后他们列出了一些助手，如`photos_url`,`photos_path`等。

我的问题：

我在哪里可以找到“可用”助手的完整列表？

有没有办法在控制台中调用助手？我创建了一个应用程序，然后使用`script/console`. 我试图像这样在控制台上调用其中一个助手：

```
>> entries_url 
```

但得到：

```
NameError: undefined local variable or method `entries_url' for #<Object:0x349a4>
    from (irb):8 
```

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-01-11T23:47:57.723

你有几个问题，其中大部分已经被下面的人回答了。

然而，一个没有完全解决的问题的答案是：是的，您可以使用脚本/控制台来查看您的路线去向。只需输入`app.[route_helper]`，它就会响应路径。例如`app.users_path`将返回`/users/`

`app.entries_url`因此，对于完整 URL的示例类型- 或其`app.entries_path`在控制台中的相对路径。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-01-11T23:33:02.170

`rake routes`在命令行应该会为您提供该列表。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-11T22:48:04.473

我认为这可能是您正在寻找的... [http://topfunky.com/clients/peepcode/REST-cheatsheet.pdf](http://topfunky.com/clients/peepcode/REST-cheatsheet.pdf)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-12T00:59:16.830

您可以通过添加“helper.”来访问控制台中的其他助手。IE。helper.progress_box（当然假设存在#progress_box）

* * *

## 回答 #5

> 赞同：-6
> 
> 时间：2009-01-11T23:52:18.650

从记忆中，由于某种原因，您不能从控制台调用 url/path 助手。

# javascript - 在 IE 上调试 Javascript 的最佳方法是什么？

> ID：433869
> 
> 赞同：10
> 
> 时间：2009-01-11T22:30:01.873
> 
> 标签：javascript, internet-explorer, debugging

在 Internet Explorer 上调试 Javascript 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-11T22:34:42.270

取决于您可以使用哪些工具。

如果您有 Visual Studio 的副本，我会使用[Visual Studio 调试器](http://www.berniecode.com/blog/2007/03/08/how-to-debug-javascript-with-visual-web-developer-express/)。它工作得很好。如果您没有 Visual Studio 的完整副本，则需要尝试按照该链接中的说明进行操作，否则它内置在 IDE 中并且使用起来非常简单。

另一种选择是[Firebug Lite](http://getfirebug.com/lite.html)，它在大多数情况下都非常好，但是您需要为要调试的每个页面添加脚本引用才能使其正常工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-11T23:17:23.713

使用 Microsoft 脚本编辑器也是一种选择：在此处查看我的答案[。](https://stackoverflow.com/questions/8398/how-do-i-debug-javascript-in-visual-studio-2005#16855)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-11T22:41:23.863

我尝试在 Firefox 中运行相同的代码，看看 Firebug 是否有帮助。但是，对于 IE 特定的错误，这显然是行不通的。

你总是可以依靠遍布在你的可疑代码中的警报语句。不过，这并不漂亮或容易。

VS 调试器通常很不错，但像 Firebug Lite 这样的东西对我来说从来都不是很好用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-11T23:34:55.380

谷歌 说：

*   [http://blogs.msdn.com/ie/archive/2004/10/26/247912.aspx](http://blogs.msdn.com/ie/archive/2004/10/26/247912.aspx)
*   [http://www.jonathanboutelle.com/mt/archives/2006/01/howto_debug_jav.html](http://www.jonathanboutelle.com/mt/archives/2006/01/howto_debug_jav.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-11T23:58:31.477

使用 MS Visual Studio（免费）调试 JS，此处解释：[http ://www.berniecode.com/blog/2007/03/08/how-to-debug-javascript-with-visual-web-developer-express/](http://www.berniecode.com/blog/2007/03/08/how-to-debug-javascript-with-visual-web-developer-express/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T00:15:08.917

我倾向于混合使用[blackbird](http://www.gscottolson.com/blackbirdjs/)、[Companion.JS](http://www.my-debugbar.com/wiki/CompanionJS/HomePage)和 Microsoft Script Editor。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-12T00:59:28.250

我不得不说，Firebug 对于我当前的项目来说是不稳定的，可能是因为我使用了 jQuery。但它是最好的，因为他的界面和功能列表。至于稳定性，我对 Microsoft Script Editor 没有任何要求。但是对于脚本有语法错误的情况是没有用的

至于Visual Studio的调试器，我没试过

顺便说一句，Firebug lite 可以通过书签 ( [http://remysharp.com/2007/03/13/firebug-in-ie-for-any-web-site/](http://remysharp.com/2007/03/13/firebug-in-ie-for-any-web-site/) ) 使用。因此，无需“为要调试的每个页面添加脚本引用以使其正常工作”

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-12T14:32:53.147

几个月来，我一直在使用带有内置调试器的 IE8 beta。它非常强大并且运行良好。它有一些小故障，但它是迄今为止我用于客户端调试的最佳工具。

[http://www.microsoft.com/windows/Internet-explorer/beta/default.aspx](http://www.microsoft.com/windows/Internet-explorer/beta/default.aspx)

不过，安装 IE8 测试版是一项重大承诺。

# sql - 标签表的优化表结构

> ID：433881
> 
> 赞同：4
> 
> 时间：2009-01-11T22:38:13.403
> 
> 标签：sql

考虑这 3 个表结构。哪个将最好地执行这些查询。

## 结构 1 - TagID 为带有连接表的 int

```
Article
-------
ArticleID int

Article_Tag
------------
ArticleTagID int
ArticleID int
TagID int

Tag
---
TagID int
TagText varchar(50) 
```

## 结构 2 - 仅在连接表中作为字符串标记

```
Article
-------
articleID int

Article_Tag
-----------
articleTagID int
articleID int
tag varchar(50) 
```

## 结构 3 - 将文本标记为 PK

```
Article
-------
ArticleID int

Article_Tag
------------
ArticleTagID int
ArticleID int
Tag varchar(50)

Tag
---
Tag varchar(50) 
```

示例查询：

```
Select articleID from Article a inner join Article_tag at on a.articleID = at.articleID and tag = 'apple'
Select tag from Tags -- or, for structure 2
Select distinct tag from article_tag 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-11T22:46:22.527

这取决于您是否希望能够全局更改标记文本。当然，您可以发出 wide `UPDATE`on `Article_Tag`，但如果您需要能够做到这一点，那么仅更新 in 的值`Tag`会更简单。一些服务器提供自动更新（例如`ON UPDATE CASCADE`在 SQL Server 中），但这些并不一定便宜（它仍然需要`UPDATE`定义很多行和任何索引）。

但是，如果您**不需要**这个，那么使用 in 文字应该会更快一些`Article_Tag`，因为它可以删除连接 - 很多次。显然，索引它等等。

重复文字所需的额外空间是一个因素，但磁盘空间通常比更快的服务器便宜。

至于是主键；除非您有其他数据要存储，否则您为什么还需要该表？你可以很容易地使用`DISTINCT`on `Article_Tag`，尤其是`Tag`应该被索引的（所以这应该很便宜）。（**编辑**Bill Karwin 正确地指出了能够保留*合格*标签的优点，而不仅仅是*当前*标签）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-11T22:45:48.863

使用`TagText`作为主键的好处是您可以获得更少连接的文章标签：

```
SELECT * FROM Article_Tag WHERE Article_ID = ? 
```

缺点是标签字符串比整数占用更多空间，因此存储空间`Article_Tag`及其索引会更大。这会占用更多磁盘空间，并且还需要更多内存来缓存索引。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-28T04:37:40.903

我每次都会选择1。它已完全标准化，并且由于您使用的是合成 PK，因此您可以通过单行更新来更改标签的名称。

否则唯一的好处是减少连接的数量。这是一个优化，我们都知道你应该只在测量后进行。如果您确定结构 1 不够快，您就不会问了，对吧？

现在 2 和 3 之间并没有太大的区别，但正如 Bill Karwin 所指出的，3 在级联更新方面具有优势。更重要的是，额外的桌子不会让你失去任何东西。

所以我会说选择 1。如果有一个可测量的（即可证明的）性能问题，那么 3 将是完全可以接受的。无论如何，以后迁移不会很难。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T23:05:03.240

欢迎回来，谦虚。或者Localghost，或者Shawn，或者你现在怎么称呼自己。请记住，不再有黑客徽章，所以这里没有什么可赢的 :)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T04:53:35.473

您应该将其映射`TagText`到`TagId`代码中（并且无论如何都映射到内存中的缓存）并将预映射的内容传递`TagId`到您的查询中。

此外，您没有理由需要`Article_Tag`表的合成键。您应该使用复合主键 ( `ArticleId`, `TagId`)。

所以，我说#1，上面提到的小调整。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-29T15:41:00.840

我会选择结构 2，也许只是简单地调用 Article_Tag 表 - **Tags**。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-03T05:51:35.860

具有 AUTO_INCREMENT PK 的表将无法扩展。忘记 TagID 为 INTEGER，将其类型替换为 BINARY(16)，刚好够 TagText 的 MD5 校验和。

使用适当的缓存层，您的 SQL 查询将不再需要 TagText 列。

# c++ - 为什么 C 字符文字是整数而不是字符？

> ID：433895
> 
> 赞同：109
> 
> 时间：2009-01-11T22:43:59.723
> 
> 标签：c++, c, char, sizeof

在 C++ 中，`sizeof('a') == sizeof(char) == 1`. 这具有直观意义，因为`'a'`它是字符文字，并且`sizeof(char) == 1`由标准定义。

然而，在 C 中，`sizeof('a') == sizeof(int)`. 也就是说，看起来 C 字符文字实际上是整数。有谁知道为什么？我可以找到很多关于这个 C 怪癖的提及，但没有解释它为什么存在。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-01-11T23:21:04.487

[同一主题](http://bytes.com/groups/c/222894-sizeof-x-c-c)的讨论

> “更具体地说，积分提升。在 K&R C 中，几乎（？）不可能使用字符值而不首先将其提升为 int，因此首先使字符常量 int 消除了该步骤。过去存在并且仍然存在多字符诸如 'abcd' 之类的常量，或者很多都适合 int。”

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2014-04-23T16:04:22.050

最初的问题是“为什么？”

原因是文字字符的定义已经演变和改变，同时试图保持与现有代码的向后兼容。

在早期 C 的黑暗日子里，根本没有类型。当我第一次学习用 C 编程时，已经引入了类型，但是函数没有原型来告诉调用者参数类型是什么。相反，作为参数传递的所有内容都是标准化的，要么是 int 的大小（包括所有指针），要么是 double。

这意味着当您编写函数时，所有不是双精度的参数都以整数形式存储在堆栈中，无论您如何声明它们，编译器都会将代码放入函数中为您处理。

这使得事情有些不一致，所以当 K&R 写他们著名的书时，他们制定了这样的规则：在任何表达式中，字符文字总是会被提升为 int，而不仅仅是函数参数。

当 ANSI 委员会首次对 C 进行标准化时，他们更改了此规则，以便字符文字只是一个 int，因为这似乎是实现相同目标的更简单方法。

在设计 C++ 时，要求所有函数都有完整的原型（这在 C 中仍然不需要，尽管它被普遍接受为良好实践）。因此，决定字符文字可以存储在 char 中。在 C++ 中这样做的好处是带有 char 参数的函数和带有 int 参数的函数具有不同的签名。这个优势在 C 中是没有的。

这就是它们不同的原因。进化...

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-01-11T23:26:28.110

我不知道 C 中的字符文字是 int 类型的具体原因。但在 C++ 中，有充分的理由不这样做。考虑一下：

```
void print(int);
void print(char);

print('a'); 
```

您会期望 print 调用选择采用 char 的第二个版本。将字符文字作为 int 会使这成为不可能。请注意，在 C++ 中，具有多个字符的文字仍然具有 int 类型，尽管它们的值是实现定义的。所以，`'ab'`有类型`int`，而`'a'`有类型`char`。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-01-11T23:08:41.360

在我的 MacBook 上使用 gcc，我尝试：

```
#include <stdio.h>
#define test(A) do{printf(#A":\t%i\n",sizeof(A));}while(0)
int main(void){
  test('a');
  test("a");
  test("");
  test(char);
  test(short);
  test(int);
  test(long);
  test((char)0x0);
  test((short)0x0);
  test((int)0x0);
  test((long)0x0);
  return 0;
}; 
```

运行时给出：

```
'a':    4
"a":    2
"":     1
char:   1
short:  2
int:    4
long:   4
(char)0x0:      1
(short)0x0:     2
(int)0x0:       4
(long)0x0:      4 
```

这表明一个字符是 8 位，就像你怀疑的那样，但字符文字是一个 int。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2011-03-29T06:26:51.917

早在编写 C 时，PDP-11 的 MACRO-11 汇编语言有：

```
MOV #'A, R0      // 8-bit character encoding for 'A' into 16 bit register 
```

这种事情在汇编语言中很常见 - 低 8 位将保存字符代码，其他位清除为 0。PDP-11 甚至有：

```
MOV #"AB, R0     // 16-bit character encoding for 'A' (low byte) and 'B' 
```

这提供了一种将两个字符加载到 16 位寄存器的低字节和高字节中的便捷方法。然后你可能会在别处写这些，更新一些文本数据或屏幕记忆。

因此，将字符提升为寄存器大小的想法是非常正常和可取的。但是，假设您需要将“A”放入寄存器，而不是作为硬编码操作码的一部分，而是从主内存中的某个位置包含：

```
address: value
20: 'X'
21: 'A'
22: 'A'
23: 'X'
24: 0
25: 'A'
26: 'A'
27: 0
28: 'A' 
```

如果您只想从该主存储器中将“A”读入寄存器，您会读哪个？

*   一些 CPU 可能只支持直接将 16 位值读取到 16 位寄存器中，这意味着读取 20 或 22 将需要清除“X”中的位，具体取决于 CPU 的字节序或其他字节序需要转移到低位字节。

*   某些 CPU 可能需要内存对齐读取，这意味着所涉及的最低地址必须是数据大小的倍数：您可能能够从地址 24 和 25 读取，但不能从 27 和 28 读取。

因此，生成代码以将“A”放入寄存器的编译器可能更愿意浪费一点额外的内存并将值编码为 0 'A' 或 'A' 0 - 取决于字节顺序，并确保它正确对齐（即不在奇数内存地址）。

我的猜测是，C 只是继承了这种以 CPU 为中心的行为，考虑到字符常量占用了内存的寄存器大小，从而证明了 C 作为“高级汇编程序”的普遍评价。

[（参见http://www.dmv.net/dec/pdf/macro.pdf](http://www.dmv.net/dec/pdf/macro.pdf)第 6-25 页的 6.3.3 ）

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-11T22:51:05.763

我记得阅读 K&R 并看到一个代码片段，它一次读取一个字符，直到它到达 EOF。由于所有字符都是文件/输入流中的有效字符，这意味着 EOF 不能是任何 char 值。代码所做的是将读取的字符放入 int，然后测试 EOF，如果不是，则转换为 char。

我意识到这并不能完全回答您的问题，但是如果 EOF 文字是，则其余字符文字为 sizeof(int) 是有意义的。

```
int r;
char buffer[1024], *p; // don't use in production - buffer overflow likely
p = buffer;

while ((r = getc(file)) != EOF)
{
  *(p++) = (char) r;
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-01-11T23:53:57.650

我还没有看到它的基本原理（C char 文字是 int 类型），但这是 Stroustrup 不得不说的（来自 Design and Evolution 11.2.1 - Fine-Grain Resolution）：

> 在 C 中，字符文字的类型，例如`'a'`is `int`。令人惊讶的是，在 C++ 中给出`'a'`类型`char`不会导致任何兼容性问题。除了病态的例子`sizeof('a')`，可以用 C 和 C++ 表达的每个构造都给出相同的结果。

所以在大多数情况下，它应该不会引起任何问题。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-07-10T05:14:55.427

其历史原因在于，C 及其前身 B 最初是在各种型号的 DEC PDP 小型机上开发的，具有各种字长，支持 8 位 ASCII 但只能对寄存器进行算术运算。（但不是 PDP-11；那是后来出现的。）C 的早期版本被定义`int`为机器的本机字长，任何小于 an 的值`int`都需要扩大到`int`才能传递给函数或从函数传递，或用于按位、逻辑或算术表达式，因为这就是底层硬件的工作方式。

这也是为什么整数提升规则仍然说任何小于 an 的数据类型`int`都被提升为`int`. 出于类似的历史原因，C 实现也允许使用补码数学而不是二进制补码。与十六进制相比，八进制字符转义和八进制常量是一等公民的原因同样是那些早期的 DEC 小型计算机的字长可分为三字节块，但不能分为四字节半字节。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-11T23:45:54.997

这是正确的行为，称为“整体提升”。它也可能发生在其他情况下（如果我没记错的话，主要是二元运算符）。

编辑：可以肯定的是，我检查了我的*Expert C Programming: Deep Secrets*副本，并确认 char 文字不以**int**类型*开头*。它最初是**char**类型，但在*表达式*中使用时，它*被提升为***int**。以下内容摘自书中：

 ********> 字符文字具有 int 类型，它们通过遵循从 char 类型提升的规则到达那里。这在 K&R 1 的第 39 页上被简单地介绍过，它说：
> 
> 表达式中的每个 char 都转换为 int....请注意，表达式中的所有 float 都转换为 double....由于函数参数是表达式，因此在将参数传递给函数时也会发生类型转换：特别是 char 和 short 变成 int，float 变成 double。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-11T22:59:24.640

我不知道，但我猜想以这种方式实现它更容易，这并不重要。直到 C++ 类型可以确定哪个函数将被调用时，它才需要修复。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-11T23:07:13.140

我确实不知道这一点。在原型存在之前，任何比 int 更窄的东西在用作函数参数时都会被转换为 int。这可能是解释的一部分。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-11T23:54:30.283

这仅与语言规范相切，但在硬件中，CPU 通常只有一个寄存器大小——比方说 32 位——因此，只要它实际上在一个 char 上工作（通过加、减或比较它），就会有将 int 加载到寄存器中时隐式转换为 int。编译器会在每次操作后正确屏蔽和移动数字，这样如果您将 2 添加到 (unsigned char) 254，它将环绕到 0 而不是 256，但在硅内部它实际上是一个 int直到您将其保存回内存。

这是一种学术观点，因为该语言无论如何都可以指定一个 8 位文字类型，但在这种情况下，语言规范恰好更准确地反映了 CPU 实际在做什么。

（x86 专家可能会注意到，*例如*，有一个本地 addh 操作可以一步添加短宽寄存器，但在 RISC 内核内部，这转换为两个步骤：添加数字，然后扩展符号，就像一个 add/extsh 对电源PC）

# mysql - MySQL数据库表中有多少行？

> ID：433903
> 
> 赞同：11
> 
> 时间：2009-01-11T22:47:21.590
> 
> 标签：mysql

是否有一个 MySQL 命令来计算表中的行数，如果有，它是什么？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-01-11T22:48:35.613

MySQL [COUNT()](http://dev.mysql.com/doc/refman/5.1/en/counting-rows.html)函数

```
SELECT COUNT(*) FROM table 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-09T18:20:37.500

获得行数估计值的一个好方法是通过 information_schema 表中的元数据信息。

请注意，这只是用于查询优化的 ESTIMATE。

可能有一种方法可以从 information_schema 中获取确切的行数，但我不能 100% 确定这是否可行。

```
选择 table_schema、table_name、table_rows
FROM information_schema.tables
ORDER BY table_rows DESC

```

# ios - 如何链接到应用商店中的应用

> ID：433907
> 
> 赞同：748
> 
> 时间：2009-01-11T22:48:36.487
> 
> 标签：ios, objective-c, app-store

我正在创建我的 iPhone 游戏的免费版本。我想在免费版本中有一个按钮，可以将人们带到应用商店中的付费版本。如果我使用标准链接

[http://itunes.apple.com/WebObjects/MZStore.woa/wa/viewSoftware?id=300136119&mt=8](http://itunes.apple.com/WebObjects/MZStore.woa/wa/viewSoftware?id=300136119&mt=8)

iPhone首先打开Safari，然后是应用商店。我用过其他直接打开应用商店的应用，所以我知道这是可能的。

有任何想法吗？应用商店的 URL Scheme 是什么？

* * *

## 回答 #1

> 赞同：808
> 
> 时间：2010-02-25T21:03:08.150

**编辑于 2016-02-02**

从 iOS 6 开始，引入了[SKStoreProductViewController](https://developer.apple.com/library/prerelease/ios/documentation/StoreKit/Reference/SKITunesProductViewController_Ref/index.html)类。您可以在不离开应用的情况下链接应用。**Swift 3.x/2.x**和**Objective-C**中的代码片段在[这里](https://stackoverflow.com/a/32008404/1151916)。

> SKStoreProductViewController对象[表示](https://developer.apple.com/library/prerelease/ios/documentation/StoreKit/Reference/SKITunesProductViewController_Ref/index.html)允许用户从 App Store 购买其他媒体的商店。例如，您的应用可能会显示商店以允许用户购买另一个应用。

* * *

来自[Apple 开发者的新闻和公告](https://developer.apple.com/news/?id=01062010a)。

> 使用 iTunes 链接将客户直接带到 App Store 上的应用程序 通过 iTunes 链接，您可以为客户提供一种直接从您的网站或营销活动访问 App Store 上的应用程序的简单方法。创建 iTunes 链接很简单，可以将客户引导至单个应用程序、您的所有应用程序或指定您公司名称的特定应用程序。
> 
> 将客户发送到特定应用程序：http: [//itunes.com/apps/appname](http://itunes.com/apps/appname)
> 
> 要将客户发送到您在 App Store 上的应用列表：http: [//itunes.com/apps/developername](http://itunes.com/apps/developername)
> 
> 要将客户发送到 URL 中包含您的公司名称的特定应用程序：http: [//itunes.com/apps/developername/appname](http://itunes.com/apps/developername/appname)

* * *

**补充笔记：**

您可以替换`http://`为`itms://`或`itms-apps://`避免重定向。

**请注意**，这`itms://`会将用户发送到**iTunes 商店**，然后`itms-apps://`将他们发送到**App Store！**

有关命名的信息，请参阅 Apple QA1633：

[https://developer.apple.com/library/content/qa/qa1633/_index.html](https://developer.apple.com/library/content/qa/qa1633/_index.html)。

**编辑（截至 2015 年 1 月）：**

itunes.com/apps 链接应更新至 appstore.com/apps。请参阅上面的 QA1633，它已被更新。新的[QA1629](https://developer.apple.com/library/content/qa/qa1629/_index.html)建议使用以下步骤和代码从应用程序启动商店：

1.  在您的计算机上启动 iTunes。
2.  搜索您要链接到的项目。
3.  右键单击或按住 Control 单击 iTunes 中的项目名称，然后从弹出菜单中选择“复制 iTunes Store URL”。
4.  在您的应用程序中，使用复制的 iTunes URL 创建一个`NSURL`对象，然后将此对象传递给`UIApplication`'s `openURL`: 方法以在 App Store 中打开您的项目。

示例代码：

```
NSString *iTunesLink = @"itms://itunes.apple.com/app/apple-store/id375380948?mt=8";
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:iTunesLink]]; 
```

iOS10+：

```
 [[UIApplication sharedApplication] openURL:[NSURL URLWithString:iTunesLink] options:@{} completionHandler:nil]; 
```

**斯威夫特 4.2**

```
 let urlStr = "itms-apps://itunes.apple.com/app/apple-store/id375380948?mt=8"
    if #available(iOS 10.0, *) {
        UIApplication.shared.open(URL(string: urlStr)!, options: [:], completionHandler: nil)

    } else {
        UIApplication.shared.openURL(URL(string: urlStr)!)
    } 
```

* * *

## 回答 #2

> 赞同：368
> 
> 时间：2010-12-30T07:53:24.950

如果你想直接在 App Store 打开一个应用，你应该使用：

它的应用程序：//...

这样它将直接在设备中打开 App Store 应用程序，而不是先去 iTunes，然后只打开 App Store（仅使用 itms:// 时）

希望有帮助。

* * *

编辑：2017 年 4 月。 itms-apps:// 实际上在 iOS10 中再次起作用。我测试了它。

编辑：2013 年 4 月。这不再适用于 iOS5 及更高版本。只需使用

```
https://itunes.apple.com/app/id378458261 
```

并且没有更多的重定向。

* * *

## 回答 #3

> 赞同：60
> 
> 时间：2015-08-14T10:56:32.933

从 iOS 6 开始，使用**SKStoreProductViewController**类的正确方法。

**斯威夫特 5.x**：

```
func openStoreProductWithiTunesItemIdentifier(_ identifier: String) {
    let storeViewController = SKStoreProductViewController()
    storeViewController.delegate = self

    let parameters = [ SKStoreProductParameterITunesItemIdentifier : identifier]
    storeViewController.loadProduct(withParameters: parameters) { [weak self] (loaded, error) -> Void in
        if loaded {
            // Parent class of self is UIViewContorller
            self?.present(storeViewController, animated: true, completion: nil)
        }
    }
}
private func productViewControllerDidFinish(viewController: SKStoreProductViewController) {
    viewController.dismiss(animated: true, completion: nil)
}
// Usage:
openStoreProductWithiTunesItemIdentifier("1234567") 
```

**斯威夫特 3.x**：

```
func openStoreProductWithiTunesItemIdentifier(identifier: String) {
    let storeViewController = SKStoreProductViewController()
    storeViewController.delegate = self

    let parameters = [ SKStoreProductParameterITunesItemIdentifier : identifier]
    storeViewController.loadProduct(withParameters: parameters) { [weak self] (loaded, error) -> Void in
        if loaded {
            // Parent class of self is UIViewContorller
            self?.present(storeViewController, animated: true, completion: nil)
        }
    }
}

func productViewControllerDidFinish(_ viewController: SKStoreProductViewController) {
    viewController.dismiss(animated: true, completion: nil)
}
// Usage:
openStoreProductWithiTunesItemIdentifier(identifier: "13432") 
```

> 您可以像这样获取应用程序的 iTunes 项目标识符：（而不是静态的）

**斯威夫特 3.2**

```
var appID: String = infoDictionary["CFBundleIdentifier"]
var url = URL(string: "http://itunes.apple.com/lookup?bundleId=\(appID)")
var data = Data(contentsOf: url!)
var lookup = try? JSONSerialization.jsonObject(with: data!, options: []) as? [AnyHashable: Any]
var appITunesItemIdentifier = lookup["results"][0]["trackId"] as? String
openStoreProductViewController(withITunesItemIdentifier: Int(appITunesItemIdentifier!) ?? 0) 
```

**斯威夫特 2.x**：

```
func openStoreProductWithiTunesItemIdentifier(identifier: String) {
    let storeViewController = SKStoreProductViewController()
    storeViewController.delegate = self

    let parameters = [ SKStoreProductParameterITunesItemIdentifier : identifier]
    storeViewController.loadProductWithParameters(parameters) { [weak self] (loaded, error) -> Void in
        if loaded {
            // Parent class of self is UIViewContorller
            self?.presentViewController(storeViewController, animated: true, completion: nil)
        }
    }
}

func productViewControllerDidFinish(viewController: SKStoreProductViewController) {
    viewController.dismissViewControllerAnimated(true, completion: nil)
}
// Usage
openStoreProductWithiTunesItemIdentifier("2321354") 
```

* * *

**目标-C**：

```
static NSInteger const kAppITunesItemIdentifier = 324684580;
[self openStoreProductViewControllerWithITunesItemIdentifier:kAppITunesItemIdentifier];

- (void)openStoreProductViewControllerWithITunesItemIdentifier:(NSInteger)iTunesItemIdentifier {
    SKStoreProductViewController *storeViewController = [[SKStoreProductViewController alloc] init];

    storeViewController.delegate = self;

    NSNumber *identifier = [NSNumber numberWithInteger:iTunesItemIdentifier];

    NSDictionary *parameters = @{ SKStoreProductParameterITunesItemIdentifier:identifier };
    UIViewController *viewController = self.window.rootViewController;
    [storeViewController loadProductWithParameters:parameters
                                   completionBlock:^(BOOL result, NSError *error) {
                                       if (result)
                                           [viewController presentViewController:storeViewController
                                                              animated:YES
                                                            completion:nil];
                                       else NSLog(@"SKStoreProductViewController: %@", error);
                                   }];

    [storeViewController release];
}

#pragma mark - SKStoreProductViewControllerDelegate

- (void)productViewControllerDidFinish:(SKStoreProductViewController *)viewController {
    [viewController dismissViewControllerAnimated:YES completion:nil];
} 
```

> 您可以`kAppITunesItemIdentifier`像这样获得（应用程序的 iTunes 项目标识符）：（而不是静态的）

```
NSDictionary* infoDictionary = [[NSBundle mainBundle] infoDictionary];
    NSString* appID = infoDictionary[@"CFBundleIdentifier"];
    NSURL* url = [NSURL URLWithString:[NSString stringWithFormat:@"http://itunes.apple.com/lookup?bundleId=%@", appID]];
    NSData* data = [NSData dataWithContentsOfURL:url];
    NSDictionary* lookup = [NSJSONSerialization JSONObjectWithData:data options:0 error:nil];
    NSString * appITunesItemIdentifier =  lookup[@"results"][0][@"trackId"]; 
    [self openStoreProductViewControllerWithITunesItemIdentifier:[appITunesItemIdentifier intValue]]; 
```

* * *

## 回答 #4

> 赞同：41
> 
> 时间：2013-10-14T17:50:18.650

Apple 刚刚公布了 appstore.com 网址。

[https://developer.apple.com/library/ios/qa/qa1633/_index.html](https://developer.apple.com/library/ios/qa/qa1633/_index.html)

> App Store Short Links 共有三种类型，有两种形式，一种用于 iOS 应用程序，另一种用于 Mac 应用程序：
> 
> ## 公司名
> 
> iOS：[http](http://appstore.com/) ://appstore.com/例如[http://appstore.com/apple](http://appstore.com/apple)
> 
> Mac：[http](http://appstore.com/mac/) ://appstore.com/mac/例如[http://appstore.com/mac/apple](http://appstore.com/mac/apple)
> 
> ## 应用名称
> 
> iOS：[http](http://appstore.com/) ://appstore.com/例如[http://appstore.com/keynote](http://appstore.com/keynote)
> 
> Mac：[http](http://appstore.com/mac/) ://appstore.com/mac/例如[http://appstore.com/mac/keynote](http://appstore.com/mac/keynote)
> 
> ## 公司应用
> 
> iOS：[http](http://appstore.com/) ://appstore.com//例如[http://appstore.com/apple/keynote](http://appstore.com/apple/keynote)
> 
> Mac：[http](http://appstore.com/mac/) ://appstore.com/mac/ / 例如[http://appstore.com/mac/apple/keynote](http://appstore.com/mac/apple/keynote)
> 
> 大多数公司和应用程序都有规范的 App Store 短链接。此规范 URL 是通过更改或删除某些字符（其中许多是非法字符或在 URL 中具有特殊含义（例如，“&”））而创建的。
> 
> ## 要创建 App Store 短链接，请将以下规则应用于您的公司或应用名称：
> 
> 删除所有空格
> 
> 将所有字符转换为小写
> 
> 删除所有版权 (©)、商标 (™) 和注册商标 (®) 符号
> 
> 用“and”替换和号（“&”）
> 
> 删除大部分标点符号（参见清单 2 的集合）
> 
> 用它们的基本字符（u、a 等）替换重音字符和其他“装饰”字符（ü、å 等）
> 
> 保持所有其他字符不变。
> 
> 清单 2 必须删除的标点符号。
> 
> !¡"#$%'()*+,-./:;<=>¿?@[]^_`{|}~
> 
> 下面是一些示例来演示发生的转换。
> 
> ## 应用商店
> 
> ## 公司名称示例
> 
> Gameloft => [http://appstore.com/gameloft](http://appstore.com/gameloft)
> 
> Activision Publishing, Inc. => [http://appstore.com/activisionpublishinginc](http://appstore.com/activisionpublishinginc)
> 
> 陈氏摄影软件 => [http://appstore.com/chensphotographyandsoftware](http://appstore.com/chensphotographyandsoftware)
> 
> ## 应用名称示例
> 
> 陶笛 => [http://appstore.com/ocarina](http://appstore.com/ocarina)
> 
> 我的佩里呢？=> [http://appstore.com/wheresmyperry](http://appstore.com/wheresmyperry)
> 
> 大脑挑战™ => [http://appstore.com/brainchallenge](http://appstore.com/brainchallenge)

* * *

## 回答 #5

> 赞同：41
> 
> 时间：2015-08-14T15:55:58.037

# 从 2015 年夏季开始...

```
-(IBAction)clickedUpdate
{
    NSString *simple = @"itms-apps://itunes.apple.com/app/id1234567890";
    [[UIApplication sharedApplication] openURL:[NSURL URLWithString:simple]];
} 
```

用“id”和“你的十位数字”替换“id1234567890”

1.  这适用于**所有设备**。

2.  它确实**直接进入**应用商店，没有重定向。

3.  适用于所有**全国性商店**。

4.  确实，您应该**改用 using** `loadProductWithParameters`，**但**如果链接的目的是更新您实际在其中的应用程序：使用这种“老式”方法可能会更好。

* * *

## 回答 #6

> 赞同：33
> 
> 时间：2012-05-29T07:01:53.020

有一个没有重定向的直接链接：

1.  使用 iTunes 链接制作器[http://itunes.apple.com/linkmaker/](http://itunes.apple.com/linkmaker/)获取真正的直接链接
2.  替换`http://`为`itms-apps://`
3.  打开链接`[[UIApplication sharedApplication] openURL:url];`

请注意，这些链接仅适用于实际设备，不适用于模拟器。

来源：[https ://developer.apple.com/library/ios/#qa/qa2008/qa1629.html](https://developer.apple.com/library/ios/#qa/qa2008/qa1629.html)

* * *

## 回答 #7

> 赞同：31
> 
> 时间：2012-03-01T03:14:49.903

此代码在 iOS 上生成 App Store 链接

```
NSString *appName = [NSString stringWithString:[[[NSBundle mainBundle] infoDictionary]   objectForKey:@"CFBundleName"]];
NSURL *appStoreURL = [NSURL URLWithString:[NSString stringWithFormat:@"itms-apps://itunes.com/app/%@",[appName stringByReplacingOccurrencesOfString:@" " withString:@""]]]; 
```

在 Mac 上用 http 替换 itms-apps：

```
NSURL *appStoreURL = [NSURL URLWithString:[NSString stringWithFormat:@"http:/itunes.com/app/%@",[appName stringByReplacingOccurrencesOfString:@" " withString:@""]]]; 
```

在 iOS 上打开 URL：

```
[[UIApplication sharedApplication] openURL:appStoreURL]; 
```

苹果电脑：

```
[[NSWorkspace sharedWorkspace] openURL:appStoreURL]; 
```

* * *

## 回答 #8

> 赞同：28
> 
> 时间：2009-01-11T23:41:54.240

只需在应用程序链接中将“itunes”更改为“phobos”。

[http://phobos.apple.com/WebObjects/MZStore.woa/wa/viewSoftware?id=300136119&mt=8](http://phobos.apple.com/WebObjects/MZStore.woa/wa/viewSoftware?id=300136119&mt=8)

现在它将直接打开App Store

* * *

## 回答 #9

> 赞同：18
> 
> 时间：2012-07-17T04:24:46.590

仅使用 APP ID，这对我来说非常有效：

```
 NSString *urlString = [NSString stringWithFormat:@"http://itunes.apple.com/app/id%@",YOUR_APP_ID];
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:urlString]]; 
```

**重定向次数为零。**

* * *

## 回答 #10

> 赞同：13
> 
> 时间：2014-06-17T21:29:28.107

许多答案建议使用“itms”或“itms-apps”，但 Apple 并未特别推荐这种做法。他们只提供以下打开 App Store 的方式：

**清单 1** *从 iOS 应用程序启动 App Store*

```
NSString *iTunesLink = @"https://itunes.apple.com/us/app/apple-store/id375380948?mt=8";
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:iTunesLink]]; 
```

请参阅[https://developer.apple.com/library/ios/qa/qa1629/_index.html](https://developer.apple.com/library/ios/qa/qa1629/_index.html)上次更新时间为 2014 年 3 月，截至本答案。

对于支持 iOS 6 及更高版本的应用，Apple 提供了一种应用内机制来展示 App Store：`SKStoreProductViewController`

```
- (void)loadProductWithParameters:(NSDictionary *)parameters completionBlock:(void (^)(BOOL result, NSError *error))block;

// Example:
SKStoreProductViewController* spvc = [[SKStoreProductViewController alloc] init];
spvc.delegate = self;
[spvc loadProductWithParameters:@{ SKStoreProductParameterITunesItemIdentifier : @(364709193) } completionBlock:^(BOOL result, NSError *error){ 
    if (error)
        // Show sorry
    else
        // Present spvc
}]; 
```

请注意，在 iOS6 上，如果出现错误，可能不会调用完成块。这似乎是在 iOS 7 中解决的错误。

* * *

## 回答 #11

> 赞同：12
> 
> 时间：2011-07-09T00:10:43.023

如果您想链接到开发人员的应用程序并且开发人员的名称包含标点符号或空格（例如 Development Company，LLC），请形成您的 URL，如下所示：

```
itms-apps://itunes.com/apps/DevelopmentCompanyLLC 
```

否则，它会在 iOS 4.3.3 上返回“无法处理此请求”

* * *

## 回答 #12

> 赞同：11
> 
> 时间：2013-03-24T23:07:10.563

您可以通过以下链接生成器获取指向应用商店或 iTunes 中特定项目的链接：http: [//itunes.apple.com/linkmaker/](http://itunes.apple.com/linkmaker/)

* * *

## 回答 #13

> 赞同：9
> 
> 时间：2012-01-07T08:07:03.773

这是在 ios5 中工作并直接链接

```
NSString *iTunesLink = @"http://itunes.apple.com/app/baseball-stats-tracker-touch/id490256272?mt=8";  
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:iTunesLink]]; 
```

* * *

## 回答 #14

> 赞同：9
> 
> 时间：2020-01-16T19:29:47.497

所有答案都已过时且不起作用；使用下面的方法。

开发者的所有应用：
`itms-apps://apps.apple.com/developer/developer-name/developerId`

单个应用程序：
`itms-apps://itunes.apple.com/app/appId`

* * *

## 回答 #15

> 赞同：8
> 
> 时间：2015-01-09T06:09:54.997

这是重定向/链接应用商店中其他现有应用程序的简单而简短的方法。

```
 NSString *customURL = @"http://itunes.apple.com/app/id951386316";

 if ([[UIApplication sharedApplication] canOpenURL:[NSURL URLWithString:customURL]])
 {
       [[UIApplication sharedApplication] openURL:[NSURL URLWithString:customURL]];
 } 
```

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2017-11-21T14:10:06.103

对于 Xcode 9.1 和 Swift 4：

1.  导入 StoreKit：

> ```
> import StoreKit 
> ```

2.符合协议

```
SKStoreProductViewControllerDelegate 
```

3.实施协议

```
func openStoreProductWithiTunesItemIdentifier(identifier: String) {
    let storeViewController = SKStoreProductViewController()
    storeViewController.delegate = self

    let parameters = [ SKStoreProductParameterITunesItemIdentifier : identifier]
    storeViewController.loadProduct(withParameters: parameters) { [weak self] (loaded, error) -> Void in

        if loaded {
            // Parent class of self is UIViewContorller
            self?.present(storeViewController, animated: true, completion: nil)
        }
    }   
} 
```

3.1

```
func productViewControllerDidFinish(_ viewController: SKStoreProductViewController) {
    viewController.dismiss(animated: true, completion: nil)
} 
```

4.  如何使用：

> ```
> openStoreProductWithiTunesItemIdentifier(identifier: "here_put_your_App_id") 
> ```

笔记：

> **输入您的APP的确切ID非常重要。因为这会导致错误（不显示错误日志，但没有任何工作正常）**

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2014-03-17T23:32:21.733

我可以确认，如果您在 iTunes 连接中创建应用程序，您会在提交之前获取您的应用程序 ID。

所以..

```
itms-apps://itunes.apple.com/app/id123456789

NSURL *appStoreURL = [NSURL URLWithString:@"itms-apps://itunes.apple.com/app/id123456789"];
    if ([[UIApplication sharedApplication]canOpenURL:appStoreURL])
        [[UIApplication sharedApplication]openURL:appStoreURL]; 
```

工作一种享受

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2020-07-16T04:54:45.637

我认为 Apple 为应用程序链接提供了一个新链接： [https](https://apps.apple.com/app/id1445530088) ://apps.apple.com/app/id1445530088或[https://apps.apple.com/app/](https://apps.apple.com/app/) {your_app_id}

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2014-08-10T09:27:11.307

当支持多个操作系统和多个平台时，创建链接可能会成为一个复杂的问题。例如，iOS 7（其中一些）不支持 WebObjects，您创建的某些链接会打开另一个国家/地区商店，然后是用户的商店等。

[有一个名为iLink](https://github.com/sidan5/iLink)的开源库可以帮助您。

该库的优点是**可以在运行时找到并创建链接**（该库将检查应用程序 ID 和它正在运行的操作系统，并确定应该创建哪个链接）。最好的一点是，在使用它之前您几乎不需要配置任何东西，这样就不会出错并且可以一直工作。如果您在同一个项目上的目标很少，那也很好，这样您就不必记住要使用哪个应用 ID 或链接。如果商店中有新版本（这是内置的，您可以通过一个简单的标志将其关闭）直接指向应用程序的升级页面，如果用户同意，此库还会提示用户升级应用程序。

将 2 个库文件复制到您的项目（iLink.h 和 iLink.m）。

在您的 appDelegate.m 上：

```
#import "iLink.h"

+ (void)initialize
{
    //configure iLink
    [iLink sharedInstance].globalPromptForUpdate = YES; // If you want iLink to prompt user to update when the app is old.
} 
```

例如，在您要打开评级页面的地方，只需使用：

```
[[iLink sharedInstance] iLinkOpenAppPageInAppStoreWithAppleID: YOUR_PAID_APP_APPLE_ID]; // You should find YOUR_PAID_APP_APPLE_ID from iTunes Connect 
```

不要忘记在同一个文件中导入 iLink.h。

那里有一个非常好的整个库的文档，还有一个适用于 iPhone 和 Mac 的示例项目。

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2017-03-08T17:18:32.477

# 至少 iOS 9 及更高版本

*   直接在 App Store 中打开

### 一个应用程序

```
itms-apps://itunes.apple.com/app/[appName]/[appID] 
```

### 开发者应用列表

```
itms-apps://itunes.apple.com/developer/[developerName]/[developerID] 
```

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2017-12-19T11:10:50.870

根据[苹果最新的文档](https://developer.apple.com/library/content/qa/qa1629/_index.html) 你需要使用

```
appStoreLink = "https://itunes.apple.com/us/app/apple-store/id375380948?mt=8" 
```

或者

```
SKStoreProductViewController 
```

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2018-11-30T12:24:02.587

尽管这里有很多答案，但链接到开发人员应用程序的建议似乎都不再有效。

当我上次访问时，我能够使用以下格式使其工作：

```
itms-apps://itunes.apple.com/developer/developer-name/id123456789 
```

这不再有效，但删除开发人员名称会：

```
itms-apps://itunes.apple.com/developer/id123456789 
```

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2014-03-20T11:09:44.697

如果您有应用商店 ID，则最好使用它。特别是如果您将来可能会更改应用程序的名称。

```
http://itunes.apple.com/app/id378458261 
```

如果您没有应用商店 ID，您可以根据此文档创建一个 url [https://developer.apple.com/library/ios/qa/qa1633/_index.html](https://developer.apple.com/library/ios/qa/qa1633/_index.html)

```
+ (NSURL *)appStoreURL
{
    static NSURL *appStoreURL;
    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{
        appStoreURL = [self appStoreURLFromBundleName:[[NSBundle mainBundle] objectForInfoDictionaryKey:@"CFBundleName"]];
    });
    return appStoreURL;
}

+ (NSURL *)appStoreURLFromBundleName:(NSString *)bundleName
{
    NSURL *appStoreURL = [NSURL URLWithString:[NSString stringWithFormat:@"itms-apps://itunes.com/app/%@", [self sanitizeAppStoreResourceSpecifier:bundleName]]];
    return appStoreURL;
}

+ (NSString *)sanitizeAppStoreResourceSpecifier:(NSString *)resourceSpecifier
{
    /*
     https://developer.apple.com/library/ios/qa/qa1633/_index.html
     To create an App Store Short Link, apply the following rules to your company or app name:

     Remove all whitespace
     Convert all characters to lower-case
     Remove all copyright (©), trademark (™) and registered mark (®) symbols
     Replace ampersands ("&") with "and"
     Remove most punctuation (See Listing 2 for the set)
     Replace accented and other "decorated" characters (ü, å, etc.) with their elemental character (u, a, etc.)
     Leave all other characters as-is.
     */
    resourceSpecifier = [resourceSpecifier stringByReplacingOccurrencesOfString:@"&" withString:@"and"];
    resourceSpecifier = [[NSString alloc] initWithData:[resourceSpecifier dataUsingEncoding:NSASCIIStringEncoding allowLossyConversion:YES] encoding:NSASCIIStringEncoding];
    resourceSpecifier = [resourceSpecifier stringByReplacingOccurrencesOfString:@"[!¡\"#$%'()*+,-./:;<=>¿?@\\[\\]\\^_`{|}~\\s\\t\\n]" withString:@"" options:NSRegularExpressionSearch range:NSMakeRange(0, resourceSpecifier.length)];
    resourceSpecifier = [resourceSpecifier lowercaseString];
    return resourceSpecifier;
} 
```

通过这个测试

```
- (void)testAppStoreURLFromBundleName
{
    STAssertEqualObjects([AGApplicationHelper appStoreURLFromBundleName:@"Nuclear™"].absoluteString, @"itms-apps://itunes.com/app/nuclear", nil);
    STAssertEqualObjects([AGApplicationHelper appStoreURLFromBundleName:@"Magazine+"].absoluteString, @"itms-apps://itunes.com/app/magazine", nil);
    STAssertEqualObjects([AGApplicationHelper appStoreURLFromBundleName:@"Karl & CO"].absoluteString, @"itms-apps://itunes.com/app/karlandco", nil);
    STAssertEqualObjects([AGApplicationHelper appStoreURLFromBundleName:@"[Fluppy fuck]"].absoluteString, @"itms-apps://itunes.com/app/fluppyfuck", nil);
    STAssertEqualObjects([AGApplicationHelper appStoreURLFromBundleName:@"Pollos Hérmanos"].absoluteString, @"itms-apps://itunes.com/app/polloshermanos", nil);
    STAssertEqualObjects([AGApplicationHelper appStoreURLFromBundleName:@"Niños and niñas"].absoluteString, @"itms-apps://itunes.com/app/ninosandninas", nil);
    STAssertEqualObjects([AGApplicationHelper appStoreURLFromBundleName:@"Trond, MobizMag"].absoluteString, @"itms-apps://itunes.com/app/trondmobizmag", nil);
    STAssertEqualObjects([AGApplicationHelper appStoreURLFromBundleName:@"!__SPECIAL-PLIZES__!"].absoluteString, @"itms-apps://itunes.com/app/specialplizes", nil);
} 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2019-07-30T07:42:34.430

它将直接打开App Store

```
NSString *iTunesLink = @"itms-apps://itunes.apple.com/app/ebl- 
skybanking/id1171655193?mt=8";

[[UIApplication sharedApplication] openURL:[NSURL URLWithString:iTunesLink]]; 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2013-12-26T07:32:19.680

试试这个方法

[http://itunes.apple.com/lookup?id="your](http://itunes.apple.com/lookup?id=) app ID here" return json.From this, find key " **trackViewUrl** " and value 是所需的 url。使用此网址（只需替换`https://`为`itms-apps://`）。这很好用。

例如，如果您的应用 ID 是 xyz，则转到此链接 [http://itunes.apple.com/lookup?id=xyz](http://itunes.apple.com/lookup?id=xyz)

然后找到键“ **trackViewUrl** ”的 url。这是您的应用在应用商店中的 url 并在 xcode 中使用这个 url 试试这个

```
NSString *iTunesLink = @"itms-apps://itunes.apple.com/us/app/Your app name/id Your app ID?mt=8&uo=4";
        [[UIApplication sharedApplication] openURL:[NSURL URLWithString:iTunesLink]]; 
```

谢谢

# sql - 在 SQL 中 count(*) 和 count( )

> ID：433913
> 
> 赞同：13
> 
> 时间：2009-01-11T22:50:55.077
> 
> 标签：sql

非常不言自明的问题。有任何理由使用其中一个吗？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-01-11T22:53:55.663

Count(*) 计算所有记录，包括空值，而 Count(fieldname) 不包括空值。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-11T22:55:42.837

select count(*) 选择任意行，select count(field) 选择该字段不为空的行。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-07-31T04:49:55.703

如果你想提高性能（即成为一个完整的性能纳粹），你可能不想这样做。

例子：

```
SELECT COUNT(1) FROM MyTable WHERE ... 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-11T22:56:46.377

这也让我困惑了一段时间。

在 MySQL 中，至少`COUNT(*)`计算行中每个 (*) 值不为空的行数。仅`COUNT`ing 一列将计算该列不为空的行数。

就性能而言，使用单列会稍微快一些，

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-11T22:56:13.147

如果表类型是没有 WHERE 语句的 MyISAM，count(*) 会更快。使用 WHERE，MyISAM 和 InnoDB 的速度将相同。

# c# - 扩展方法不更新传入的对象

> ID：433918
> 
> 赞同：1
> 
> 时间：2009-01-11T22:53:16.273
> 
> 标签：c#, .net, linq

我最近开始学习 LINQ 并遇到了`OrderBy`扩展方法。`Sort`这最初让我很兴奋，因为它的语法似乎比我们在通用列表中到处使用的方法要好得多。

例如，在对语言列表进行排序时，我们通常会执行以下操作：

```
neutralCultures.Sort((x, y) => x.EnglishName.CompareTo(y.EnglishName)); 
```

这很好用，但我更喜欢 的语法`OrderBy`，它只要求您传入您希望排序的属性，如下所示：

```
neutralCultures.OrderBy(ci => ci.EnglishName); 
```

问题是`OrderBy`返回`IOrderedEnumerable`，但我需要`List<T>`。因此，我着手扩展`Sort`使用`List<T>`与`OrderBy`.

```
public static void Sort<TSource, TKey>(this List<TSource list, Func<TSource, TKey> keySelector)
{
    list = list.OrderBy(keySelector).ToList<TSource>();
} 
```

这将被称为：

```
neutralCultures.Sort(ci => ci.EnglishName); 
```

也许我忽略了一个简单的实现细节，但是这段代码不起作用。它编译，但不返回有序列表。我确信我可以重构它以使其工作，但我只是想知道为什么`list`扩展方法中的设置不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-11T23:03:37.517

我之前使用选择器编写了排序变体 - 这并不难......就像：

```
using System;
using System.Collections.Generic;
class Foo
{
    public string Bar { get; set; }
}

static class Program
{
    static void Main()
    {
        var data = new List<Foo> {
            new Foo {Bar = "def"},
            new Foo {Bar = "ghi"},
            new Foo {Bar = "abc"},
            new Foo {Bar = "jkl"}
        };
        data.Sort(x => x.Bar);
        foreach (var item in data)
        {
            Console.WriteLine(item.Bar);
        }
    }

    static void Sort<TSource, TValue>(
        this List<TSource> source,
        Func<TSource, TValue> selector)
    {
        var comparer = Comparer<TValue>.Default;
        source.Sort((x,y) => comparer.Compare(selector(x), selector(y)));
    }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-11T22:58:00.943

我认为这是因为`list`没有通过 ref。因此，将`list`变量设置为另一个对象不会改变原始变量指向的位置。

您也许可以这样做（尚未正确测试）：

```
public static void Sort<TSource, TKey>(this List<TSource> list, Func<TSource, TKey> keySelector)
    {
        var tempList = list.OrderBy(keySelector).ToList<TSource>();
        list.Clear();
        list.AddRange(tempList);
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-11T23:04:28.293

这就是我所期望的行为。想象一下，如果这样的事情是可能的：

```
var c = myCustomer;
myCustomer.DoStuff();
if (c == myCustomer) // returns false!!! 
```

简单地调用对象上的方法（这是扩展方法对框架用户的外观）不应更改引用指向的实例。

对于您的示例，我会坚持使用排序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-11T23:35:17.890

您正在替换调用的局部参数变量`list`的值，而不是更改调用者变量的值（这是您正在尝试做的事情。）

# javascript - JavaScript 通过代码模拟右键单击

> ID：433919
> 
> 赞同：29
> 
> 时间：2009-01-11T22:53:28.520
> 
> 标签：javascript, selenium, dojo, mouseevent

我正在使用 Selenium 编写一些 UI 测试，并且我有一个 JavaScript Tree 控件，使用 Dojo 工具包。

我已经使用 Dojo 提供的示例为树的每个节点实现了一个上下文菜单，但是我需要 Selenium 测试来“调用”树节点上的右键单击，但我无法让它工作。测试根本不通过 JavaScript 模拟右键单击事件，并且上下文菜单不显示。

有没有人有过使用 Dojo 和 Selenium 调用右键单击上下文菜单的经验？或者对如何做有任何想法？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-01-12T00:54:22.830

试试这个，因为事情不太正常的原因是上下文菜单实际上绑定到 oncontextmenu 事件。

```
function contextMenuClick(element){
    var evt = element.ownerDocument.createEvent('MouseEvents');

    var RIGHT_CLICK_BUTTON_CODE = 2; // the same for FF and IE

    evt.initMouseEvent('contextmenu', true, true,
         element.ownerDocument.defaultView, 1, 0, 0, 0, 0, false,
         false, false, false, RIGHT_CLICK_BUTTON_CODE, null);

    if (document.createEventObject){
        // dispatch for IE
       return element.fireEvent('onclick', evt)
     }
    else{
       // dispatch for firefox + others
      return !element.dispatchEvent(evt);
    }
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-12T01:26:09.087

为了更好地衡量，这里有一些关于参数的文档：

```
var myEvt = document.createEvent('MouseEvents');
myEvt.initMouseEvent(
   'click'          // event type
   ,true           // can bubble?
   ,true           // cancelable?
   ,window      // the event's abstract view (should always be window)
   ,1              // mouse click count (or event "detail")
   ,100           // event's screen x coordinate
   ,200           // event's screen y coordinate
   ,100           // event's client x coordinate
   ,200           // event's client y coordinate
   ,false         // whether or not CTRL was pressed during event
   ,false         // whether or not ALT was pressed during event
   ,false         // whether or not SHIFT was pressed during event
   ,false         // whether or not the meta key was pressed during event
   ,1             // indicates which button (if any) caused the mouse event (1 = primary button)
   ,null          // relatedTarget (only applicable for mouseover/mouseout events)
); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-11T23:24:36.490

好问题！

我做了一些研究，似乎你可以触发一个鼠标事件，就像[这里显示](http://lifescaler.com/2008/04/simulating-mouse-clicks-in-javascript/)`button`的那样，并通过将or`which`属性设置为 2 （[在此处记录](http://www.quirksmode.org/js/events_properties.html#button)）来使其成为右键单击。

也许这段代码会起作用：

```
function rightClick(element){
  var evt = element.ownerDocument.createEvent('MouseEvents');

  var RIGHT_CLICK_BUTTON_CODE = 2; // the same for FF and IE

  evt.initMouseEvent('click', true, true,
      element.ownerDocument.defaultView, 1, 0, 0, 0, 0, false,
      false, false, false, RIGHT_CLICK_BUTTON_CODE, null);

  if (document.createEventObject){
    // dispatch for IE
    return element.fireEvent('onclick', evt)
  }
  else{
    // dispatch for firefox + others
    return !element.dispatchEvent(evt);
  }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-12T01:16:27.903

如果您不关心上下文菜单的启动位置，这是一个更正确的版本

```
function fireContextMenu(el) {
  var evt = el.ownerDocument.createEvent("HTMLEvents")
  evt.initEvent('contextmenu', true, true) // bubbles = true, cancelable = true

  if (document.createEventObject) {
    return el.fireEvent('oncontextmenu', evt)
  }
  else {
    return !el.dispatchEvent(evt)
  }
} 
```

如果你这样做了，我们可能不得不使用前一个，修复它在 IE 中的行为，并适当地填充 screenX、screenY、clientX、clientY 等

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-07-19T19:07:04.397

我在 firefox 和 chrome 中尝试这样做，但调度 contextmenu 事件不会使浏览器打开上下文菜单。触发事件是因为我的 oncontextmenu 回调被触发，但上下文菜单仍然丢失。任何人都有一个想法，因为我使用了上面的所有代码示例？

# c# - 通用 C# 复制构造函数

> ID：433926
> 
> 赞同：19
> 
> 时间：2009-01-11T22:56:21.230
> 
> 标签：c#, constructor, copy

为我的 c# 类编写通用复制构造函数的最佳方法是什么？它们都继承自抽象基类，因此我可以使用反射来映射属性，但我想知道是否有更好的方法？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-11T23:09:58.503

复制构造函数基本上意味着您有一个参数，即您要复制的对象。

另外，做一个深拷贝，而不是浅拷贝。

如果你不知道什么是深拷贝和浅拷贝，那么这里是交易：

假设您正在复制一个具有单行整数作为字段的类。

浅拷贝将是：

```
public class Myclass()
{
    private int[] row;
    public MyClass(MyClass class)
    {
        this.row = class.row
    }
} 
```

深拷贝是：

```
public class Myclass()
{
    private int[] row;
    public MyClass(MyClass class)
    {
        for(int i = 0; i<class.row.Length;i++)
        {
            this.row[i] = class.row[i];
        }
    }
} 
```

深拷贝真正获取实际值并将它们放入新对象的新字段中，而浅拷贝只复制指针。

使用浅拷贝，如果您设置：

```
row[3] = 5; 
```

然后打印两行，两次打印都将 5 作为第 4 个数字的值。然而，对于深拷贝，只有第一个打印会有这个，因为行没有相同的指针。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-01-11T23:00:38.460

如果可以，请避免反思。每个类都应该负责复制自己的属性，并将其进一步发送到基方法。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-01-11T23:13:38.540

您可以通过预编译通过反射**有效地**创建浅拷贝，例如使用`Expression`. 例如，[像这样](http://groups.google.com/group/microsoft.public.dotnet.languages.csharp/browse_thread/thread/d9722a51b04300a/0edae91abc1c0f1a#0edae91abc1c0f1a)。

对于深拷贝，序列化是最可靠的方法。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-05-01T21:10:10.830

这是我正在使用的构造函数。请注意，由于我的基类的性质，这是一个浅层构造函数，而且相当简单。应该足以让你开始。

```
public partial class LocationView : Location
{
    public LocationView() {}

    // base class copy constructor
    public LocationView(Location value) {
        Type t = typeof(Location);
        PropertyInfo[] properties = t.GetProperties();
        foreach (PropertyInfo pi in properties)
        {
            pi.SetValue(this, pi.GetValue(value, null), null);
        }
    }
    public Quote Quote { get; set; }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-30T12:50:46.140

您可以参考 valueinjecter 和 fastflect nuget 包并使用：

```
public class Myclass()
{
    private string _property;
    public MyClass(MyClass obj)
    {
         this.InjectFrom(obj.DeepClone());
    }
} 
```

# sql - SQL JOIN：如果我想从表“users”中获取 user2 的信息，JOIN 会是什么样子？

> ID：433933
> 
> 赞同：0
> 
> 时间：2009-01-11T22:58:30.070
> 
> 标签：sql, join

```
SELECT * FROM friends
WHERE (user1 = $userid OR user2 = $userid) AND accepted = 1 
```

如果我想从表“users”中获取 user2 的信息，JOIN 会是什么样子？

```
table friends:
  `id` int(11) NOT NULL auto_increment,
  `user1` int(11) NOT NULL,
  `user2` int(11) NOT NULL,
  `date` datetime NOT NULL,
  `accept` tinyint(1) NOT NULL,
  `type` varchar(32) NOT NULL

users:
  `id` mediumint(8) NOT NULL auto_increment,
  `username` varchar(32) NOT NULL,
  `password` varchar(40) NOT NULL 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-11T23:02:25.257

```
SELECT u.*, f.* FROM friends f 
JOIN users u ON u.id=f.user2 
WHERE (f.user1= $userid OR f.user2=$userid) 
AND f.accepted = 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-11T23:03:43.600

类似于以下内容。

```
SELECT f.*, u1.*, u2.* FROM friends f
INNER JOIN users u1 ON f.user1 = u1.id
INNER JOIN users u2 ON f.user2 = u2.id
WHERE (f.user1 = $userid OR f.user2 = $userid) AND f.accepted = 1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-11T23:29:04.640

你说你没有成功尝试（基于马克泰勒的回答？）

```
$sql = mysql_query(" SELECT u., f. FROM relations f JOIN users u ON u.id=f.user2 WHERE (f.user1=$row[id] OR f.user2=$userid) AND f.accepted = '1' "); 
```

但不应该

```
'select u., f. from ...' 
```

是

```
'select u.*, f.* from ...' 
```

?

# ruby-on-rails - 杂种挂起

> ID：433940
> 
> 赞同：0
> 
> 时间：2009-01-11T23:00:50.017
> 
> 标签：ruby-on-rails, ruby, mongrel

我在 Rails 应用程序中遇到问题。几个小时后，应用程序似乎开始挂起，我无法找到问题所在。日志文件中没有任何相关内容，但是当我尝试从浏览器获取 url 时，什么也没发生（比如 mongrel 接受请求但无法响应）。

你认为我可以测试什么来了解问题出在哪里？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T00:50:38.563

我可能会因为回避这个问题而被否决，但我最近从 nginx + mongrel 转到了 mod_rails 并且印象非常深刻。转向更简单的设置无疑会在未来让我头疼。

这是一个非常简单的过渡，我强烈推荐它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T18:55:20.280

我有同样的问题。我缩小范围的几个选项与 MySQL 适配器相关。我在 Red Hat Enterprise Linux 4（或 5）上运行，应用程序会在给定的空闲时间后挂起。

一种建议的解决方案是编译原生 MySQL 绑定，我一直在使用纯 Ruby 绑定。

另一个是将 MySQL 适配器上的超时设置为高于连接空闲的时间。（我没有记录具体的配置，但我记得它在 environment.rb 中，它是 mysql 适配器中的一些类变量。）

我不记得这些解决方案中的任何一个是否解决了它，在那之后不久我们就搬到了 Ubuntu 并且从那以后没有遇到任何问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T09:10:07.527

Check the Mongrel FAQ: [http://mongrel.rubyforge.org/wiki/FAQ](http://mongrel.rubyforge.org/wiki/FAQ)

From my experience, mongrel hangs when:

*   the log file got too big (hundreds of megabytes in size). you have to setup log rotation.
*   the MySQL driver times out you have to change the timeout settings of your MySQL driver by adding this to your environment.rb: `ActiveRecord::Base.verification_timeout = 14400` (this is further explained in the deployment section of the FAQ)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-31T08:14:39.973

我们也遇到过同样的问题。首先，安装 mongrel_proctitle gem

[http://github.com/rtomayko/mongrel_proctitle/tree/master](http://github.com/rtomayko/mongrel_proctitle/tree/master)

这个 gem/plugin 将允许您通过“ps”查看 mongrel 进程，您可以查看 Mongrel 是否挂起。我们在 Mongrel 中看到的一个问题是它会很高兴地接受连接并将它们排入队列，然后将自身楔入。此插件将帮助您查看 Mongrel 何时被楔入，但您必须使用另一个监控应用程序来实际重新启动楔入的 Mongrel，例如[Monit](http://mmonit.com/monit/)或[God](http://god.rubyforge.org/)

您可能还想考虑在您的 Mongrel 前面放置一个更平衡的反向代理，即 HAproxy，而不是 nginx、Apache 或 Lighttpd。通过在 HAproxy 中设置“maxconn 1”，您可以确保队列由 HAproxy 与 Mongrel 维护。其他反向代理（nginx、Apache、Lighttpd）只做循环，这意味着它们可以在不经意间加载你的 Mongrel 队列。

我个人的选择是上帝，因为它更灵活。

tl;dr 安装这个 gem 插件并留意你的 Mongrels。试试 Apache+Phusion 乘客。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-31T08:20:54.983

不幸的是，Rails（以及 Mongrel）随着时间的推移消耗过多内存并崩溃是一个已知问题（50K+ 谷歌条目“Ruby, rails, crashing, memory”）。当前的 ruby​​ 解释器具有这样的特性，它[有时完全无法将内存还给系统](http://www.ruby-forum.com/topic/121254)——它可能会重用它拥有的内存，但不会放弃它。

在生产环境中有许多监控、杀死和重启 Mongrel 实例的方案——例如：（随机选择）[rails monitor](http://kontsevoy.com/rails-monitor/)。在更果断地解决问题之前，其中之一可能是您最好的选择。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T00:39:18.430

您确定问题是由 Mongrel 引起的吗？您是否尝试过在 WEBrick 下运行您的应用程序？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-12T01:58:47.787

您[可以检查几件事](http://mongrel.rubyforge.org/wiki/FAQ#Q:WhatcancauseMongreltolockuponaregularbasis)，但是由于您说日志中没有任何内容指示错误，听起来您在使用`Logger`该类的日志轮换功能时可能会遇到错误。它会导致杂种被锁定。与其依赖`Logger`轮换日志，不如考虑使用`logrotate`或其他一些外部日志轮换服务。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-12T12:29:42.647

这是否每次都在固定的小时数/天数内发生？你有多少内存？

# java - 用于 Python 的 JFileChooser？

> ID：433945
> 
> 赞同：4
> 
> 时间：2009-01-11T23:03:34.600
> 
> 标签：java, python, jfilechooser

我想知道是否有类似于 Java 的`JFileChooser`Python 的东西？

`JFileChooser`是一个选择文件的图形前端。

最好是已经使用 Python 的东西。也许与 Tkinter。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-11T23:12:59.027

wxPython (www.wxpython.org) 提供 wx.FileDialog 类，它将在任何受支持的平台（Mac、Linux 或 Windows）上为您提供本机文件选择对话框。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-11T23:29:26.483

我发现的最简单的方法（使用 PyGTK 和[Kiwi](http://async.com.br/projects/kiwi)）：

```
from kiwi.ui.dialogs import open as open_dialog

chosen_path = open_dialog('Select a file', folder='/start/folder')

if chosen_path is not None:
    # do something ... 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-12T06:29:00.143

对于不需要 wxPython 并坚持使用标准 Python 库的东西，您可以使用 tkFileDialog.askopenfilename() 方法：

```
#!/usr/bin/python

from Tkinter import *
from tkFileDialog import askopenfilename

root = Tk()
root.withdraw()
print askopenfilename() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-11T23:11:53.303

这将取决于您的窗口工具包。wxWidgets 提供[wxFileDialog](http://docs.wxwidgets.org/stable/wx_wxfiledialog.html)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-09-28T18:55:55.257

对于 python 3，您正在寻找的是 tkinter.filedialog，以及它附带的所有内容。这是一个简短的程序，它打开并打印用户通过 askopenfilename 选择的 TXT 文件：

```
from tkinter import *
from tkinter.filedialog import askopenfilename

root = Tk()
root.withdraw()
root.update()
pathString = askopenfilename(filetypes=[("Text files","*.txt")])
if pathString:
    openFile = open(pathString, 'r')
    fileString = openFile.read()
    print(fileString)
root.destroy() 
```

输出是所选文件中的任何内容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-11T23:16:43.153

也许您想看看 Jython。

# java - 使用 String.format 的 Java 十进制格式？

> ID：433958
> 
> 赞同：84
> 
> 时间：2009-01-11T23:08:55.370
> 
> 标签：java, formatting, decimal

我需要将一个十进制值格式化为一个字符串，我总是显示至少 2 个小数，最多 4 个。

所以例如

```
"34.49596" would be "34.4959" 
"49.3" would be "49.30" 
```

这可以使用 String.format 命令完成吗？
或者在 Java 中是否有更简单/更好的方法来做到这一点。

* * *

## 回答 #1

> 赞同：186
> 
> 时间：2012-10-04T22:29:47.583

是的，你可以这样做`String.format`：

```
String result = String.format("%.2f", 10.0 / 3.0);
// result:  "3.33"

result = String.format("%.3f", 2.5);
// result:  "2.500" 
```

* * *

## 回答 #2

> 赞同：96
> 
> 时间：2009-01-11T23:13:33.673

你想要 java.text.DecimalFormat。

```
DecimalFormat df = new DecimalFormat("0.00##");
String result = df.format(34.4959); 
```

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2009-01-11T23:16:05.433

这是一个完成这项工作的小代码片段：

```
double a = 34.51234;

NumberFormat df = DecimalFormat.getInstance();
df.setMinimumFractionDigits(2);
df.setMaximumFractionDigits(4);
df.setRoundingMode(RoundingMode.DOWN);

System.out.println(df.format(a)); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-11T23:11:50.730

java.text.NumberFormat 可能是您想要的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-12T00:49:53.073

NumberFormat 和 DecimalFormat 绝对是您想要的。另外，注意`NumberFormat.setRoundingMode()`方法。您可以使用它来控制在格式化期间如何应用舍入或截断。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-11T23:11:39.950

你想要 java.text.DecimalFormat

# c++ - 受保护的派生类

> ID：433965
> 
> 赞同：5
> 
> 时间：2009-01-11T23:12:38.513
> 
> 标签：c++, inheritance

```
 #include <iostream>
using namespace std;

class Base
{
    public:
        Base(){cout <<"Base"<<endl;}
        virtual ~Base(){cout<<"~Base"<<endl;}
        virtual void foo(){ cout<<"foo base"<<endl;}
};

class Derived: private Base
{
    public:
        Derived(){cout<<"Derived"<<endl;}
        virtual ~Derived(){cout<<"~Derived"<<endl;}
        virtual void  foo(){ cout<<"foo dervied"<<endl;}
};

int main(int argc, char *argv[])
{
    Base *pb = new Derived;
    Derived d;
    d.foo();
    return 0;
} 
```

当我执行上述示例程序时，出现以下错误：protected.cpp: In function 'int main(int, char**)': protected.cpp:26: error: 'Base' is an inaccessible base of 'Derived'< /p>

为什么不能用基指针创建派生对象？？？？

* * *

所以我可以创建一个派生类的实例，比如

```
Derived d
Derived d1= new Derived; 
```

但是从基类指针创建实例，如

```
Base * b = new derived 
```

将失败。

这是因为 Derived 实际上不是从 Base 派生的派生类，当派生 procted 和 private 时？

它是否正确？？？？？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-11T23:17:24.587

> 为什么不能用基指针创建派生对象？？？？

因为基地是`private`。这明确禁止将您的类视为`Base`外部的实例。从外面看，你的类`Derived`不是的子类，只能从类本身内部*看。*`Base`

继承同样重要`protected`，唯一的区别是基类现在不再是自己的类私有的，而是任何派生类的私有类。但在外部看来，它的行为就像私有继承。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-11T23:18:52.417

您可能想看看[这个](http://www.parashift.com/c++-faq-lite/private-inheritance.html)关于 c++ 和继承的常见问题解答。特别是第[24.5](http://www.parashift.com/c++-faq-lite/private-inheritance.html#faq-24.5)和[24.6](http://www.parashift.com/c++-faq-lite/private-inheritance.html#faq-24.6)节。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-11T23:39:33.730

> 所以我可以创建一个派生类的实例，比如
> 
> 派生 d 派生 d1= 新派生；但是从基类指针创建实例，如
> 
> Base * b = new 派生将失败。
> 
> 这是因为 Derived 实际上不是从 Base 派生的派生类，当派生 procted 和 private 时？
> 
> 它是否正确？？？？？

就像康拉德解释的那样。

它实际上仍然来自Base。为了验证这一点，如果您不覆盖 Derived 中的虚拟方法，则将调用 Base 版本。

但是，由于您将 Base 声明为受保护，编译器不会让您自动将 Derived* 强制转换为 Base*，因为 Base 超类在外部不可见。

# mysql - mysql select - 如何检索线程/嵌套消息的结果？

> ID：433970
> 
> 赞同：3
> 
> 时间：2009-01-11T23:14:10.193
> 
> 标签：mysql, multithreading, select, nested, hierarchical-data

我正在创建一个线程留言板，并试图使其保持简单。有一个消息表，然后是一个回复表，其中包含一个“reply_id”字段，该字段可以为 null 以指示顶级响应，或者一个值指示线程响应。

我对如何在这种类型的表上进行 SELECT 调用有点困惑？

```
Reply
-id (every reply gets a unique id)
-message_id (the message it is replying to)
-reply_id (the id of the reply it may be replying to - for threading)
-reply 
```

我知道这可能是一个复杂的问题，尤其是在性能方面，但我真的只是在寻找最基本的解决方案。

谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-11T23:37:55.560

您正在使用存储树的天真“教科书”方式，即存储对直接父级的引用。这种设计称为**邻接表**。还有其他解决方案：

*   **路径枚举**，您在树的每个节点中存储一个编码其所有直接祖先的字符串。
*   **Nested Sets**，Joe Celko 的一种巧妙方法，您可以使用每个节点的两个数值来绑定其所有后代。
*   **闭包表**（或邻接关系），您使用单独的表列出每个祖先-后代对。

有关Closure Table 设计的参考和示例，请参阅我对“[将平面表解析为树的最有效/优雅的方法是什么？ ”的回复。](https://stackoverflow.com/questions/192220/what-is-the-most-efficient-elegant-way-to-parse-a-flat-table-into-a-tree#192462)

# sql - SQL 视图是否在性能方面保留关系信息？

> ID：433972
> 
> 赞同：0
> 
> 时间：2009-01-11T23:14:55.200
> 
> 标签：sql, performance

考虑这些表：（`->`表示 SQL 定义的关系）

```
USER (userid, username, imageid->IMAGE.imageid)
EVENT (eventid, userid->USER.userid, description)
IMAGE (imageid, location) 
```

`vw_UserInfo`假设我有一个定义为以下查询的视图（我们称之为）。

```
SELECT u.*, i.* FROM users u
INNER JOIN images i ON i.imageid = u.imageid 
```

**`EVENT.userid`**SQL 知道和之间的关系`vw_UserInfo.userid`吗？我的意思是，`JOIN`在相关领域进行操作的性能优势是否仍然适用？我想这可能会因您使用的 SQL DB 而异。

* * *

编辑：为了更清楚一点。我问会

```
SELECT ui.*, e.* FROM vw_UserInfo ui 
INNER JOIN events e ON ui.userid = e.userid 
```

受益于定义的外键

```
SELECT u.*, i.*, e.* FROM users u
INNER JOIN images i ON i.imageid = u.imageid
INNER JOIN events e ON e.userid = u.userid 
```

将？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T00:16:28.570

不，因为视图（至少在 SQL Server 中）实际上并不是约束系统的一部分（视图的存在或不存在不应影响任何不引用视图的查询的性能）。然而，索引视图（物化视图）可能有助于提高性能。不过，如果没有明确引用，我不确定哪些优化器会在执行计划中使用它们。

如果您阅读[Celko 的这篇文章](http://www.simple-talk.com/sql/t-sql-programming/constraint-yourself!/)，您会发现您为数据库提供的有关表之间的约束和外键关系的元数据越多，这可以提高查询的性能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T00:04:17.020

关系强制数据完整性，它们与快速选择数据无关。那是索引的领域。一般来说，关系（尤其是在具有许多关系的表上）*会减慢*数据访问（尤其是写入）的速度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T01:59:29.143

是的，有点。

优化器可以使用基础表索引进行优化，因为视图在编译步骤中被扩展。

但是......就像 Rovert 所说，关系不会加速查询，索引会。

# java - Java 中的 CPU 使用率太低

> ID：433973
> 
> 赞同：6
> 
> 时间：2009-01-11T23:14:58.587
> 
> 标签：java, cpu, utilization

嘿stackoverflow社区！

我遇到了一个问题，一个高度参与的算法程序使用的 CPU 利用率太低：在 3% 到 4% 之间。返回结果需要很长时间，而且我相信它还不够努力。

你们中的任何一个天才都知道为什么会发生这种情况 - 如果有的话，我希望 100% 的利用率。一个额外的细节是程序插入到 sqlite3 数据库中，因此是的，我相信有很多通过 sqlite3jdbc 库的 JNI 调用。（请注意，我想早先使用 PreparedQuery 批处理推迟这些插入，但这会导致严重的内存问题 - 有很多数据）。

提前致谢

更新：已修复。是的，我只是个傻瓜，但我没想到 sqlite 会启动一个新事务并做这么多开销。

我现在使用 PreparedStatement 并在插入之前对 32768 个条目进行排队 - 对我来说似乎是一个足够好的数字。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-11T23:19:58.683

如果 IV 型、100% Java 版本可用，我绝不会建议有人使用带有 JNI 的 JDBC 驱动程序。谷歌找到[了这个](http://zentus.com/sqlitejdbc/)。

除此之外，如果没有更多信息，我什么也说不出来。应用程序和数据库是否在同一硬件上运行？

INSERT 有什么“密集”的地方？

我建议分析并获取一些真实数据，而不是猜测。基于信仰的计算对我来说永远不起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-11T23:17:49.920

显然，数据库调用导致延迟。创建较小的批次并测试是否有帮助不是一种选择吗？也许你也可以并行化算法，让一个队列在某处获取结果，另一个线程清理该队列？

编辑：

还有一些其他问题领域：

*   数据库优化（模型）
*   数据库服务器配置
*   磁盘速度

所有这些因素都应考虑在内

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-11T23:18:11.340

如果您正在写入大量数据，那么听起来您可能会受到磁盘限制。查看机器上的磁盘 io 统计信息，如果这实际上是瓶颈，请找到具有更好 io 的硬件，或者找出如何减少写入。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-11T23:38:46.447

磁盘正在减慢您的应用程序。INSERTS 使用磁盘，磁盘很慢，操作系统需要等待写操作完成。

您不能使用 2 个线程，一个用于算法，另一个用于插入吗？如果您只进行插入，您也可以将 then 写入文本文件，并在以后执行它们

# sql-server - 记录数据库的首选文档格式是什么

> ID：433984
> 
> 赞同：8
> 
> 时间：2009-01-11T23:19:16.113
> 
> 标签：sql-server, database, documentation, documentation-generation

我正在编写一个[应用程序](http://www.devio.at/index.php/dbscript)，除其他功能外，它还生成 MSSQL 数据库（对象、表、表数据）的 MediaWiki 文档。

我的问题是您喜欢或需要制作哪种文档格式。我有太多想法要遵循，所以你的回答应该确定我的优先级；）

（我知道在 SO 上还有其他与文档相关的问题，但它们主要涉及如何生成文档（我知道如何），并且不要求特定的文档类型或平台）

编辑：感谢您的评论。实际上我已经有了表关系，因为我解析了外键。但是完整的交叉引用可能有点棘手；）

但是，该问题旨在询问文档类型，例如 Word、PDF、ODF 等。您的专业要求或偏好是什么？

更新： [生成的文档概述](http://devio.wordpress.com/2010/02/16/integrated-database-versioning-and-documentation-with-dbscript-1-01/)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-12T00:05:36.953

听起来您已经决定了一种文档格式，即基于 MediaWiki 标记的 HTML。

此外，您应该生成[实体关系图](http://en.wikipedia.org/wiki/Entity-relationship_model)，这是对数据库文档的有用补充（尽管 ERD 也不能说明全部故事）。

您是指文档组织，即每页应包含哪些标题和内容？

以下是一些建议：

1.  表结构

    *   列名、数据类型、约束
    *   每列的含义和用法
    *   触发器和应用程序代码中的额外逻辑约束
    *   定义的索引
2.  与其他表的关系

    *   依赖于此的表
    *   这个依赖的表
    *   关于特殊或隐式关系的注释，不通过数据库约束强制执行
3.  表的使用

    *   在存储过程中的使用
    *   应用程序代码中的用法
    *   视图中的用法
    *   谁拥有读取和/或写入权限；每个用户或角色的 SQL 权限

StackOverflow 上还有其他与这个问题非常接近的问题。

*   “[如何记录数据库](https://stackoverflow.com/questions/369266/how-to-document-a-database)”与您的问题非常相似，因为它专门针对 wiki 文档解决方案。
*   “[了解不熟悉的数据库的最佳方法是什么](https://stackoverflow.com/questions/278430/what-are-the-best-ways-to-understand-an-unfamiliar-database)”可能会给您一些很好的提示，因为您正在创建可以帮助遇到这种情况的人的文档。
*   “[你如何记录你的数据库结构？](https://stackoverflow.com/questions/186392/how-do-you-document-your-database-structure) ”相关但不那么密切，因为它是关于将文档放入元数据本身。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T13:19:49.440

您可能想看看商业供应商对此做了什么。正如比尔所说，你当然需要一个 ER 图。要查看的商业产品可能包括[Embarcadero ER/Studio](http://www.embarcadero.com/products/erstudio/)、[Red-Gate SQL Doc](http://www.red-gate.com/products/SQL_Doc/index.htm)、[Power Designer](http://www.sybase.com/products/modelingdevelopment/powerdesigner)等。

# multithreading - POSIX 取消点是什么？

> ID：433989
> 
> 赞同：19
> 
> 时间：2009-01-11T23:21:41.927
> 
> 标签：multithreading, sockets, network-programming, posix, pthreads

POSIX 取消点是什么？我正在寻找一份明确的 POSIX 取消点列表。

我之所以问，是因为我有一本书说`accept()`是`select()`取消点，但我看到互联网上的网站声称它们不是。

此外，如果 Linux 取消点与 POSIX 取消点不同，我也想要一份它们的列表。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-12T00:52:21.090

[POSIX 1003.1-2003](http://www.opengroup.org/onlinepubs/009695399/toc.htm)标准在系统接口部分给出了一个列表，然后是一般信息，然后是线程（[直接链接](http://www.opengroup.org/onlinepubs/000095399/functions/xsh_chap02_09.html#tag_02_09_05_02)由 A. Rex 提供）。（*补充*：[POSIX 1003.1-2008](http://www.opengroup.org/onlinepubs/9699919799/toc.htm)现已在网络上提供（它的所有 3872 页，PDF 和 HTML 格式）。您必须注册（免费）。我从[Open Group 书店](http://www.opengroup.org/bookstore/catalog/c082.htm)得到它。）

## 取消积分

> 当线程正在执行以下函数时，将出现取消点：
> 
> *   接受（）
> *   aio_suspend()
> *   时钟纳米睡眠（）
> *   关闭（）
> *   连接（）
> *   创建（）
> *   fcntl()（当 cmd 参数为 F_SETLKW 时）
> *   数据同步（）
> *   同步（）
> *   获取消息（）
> *   获取pmsg()
> *   锁定函数（）
> *   mq_receive()
> *   mq_send()
> *   mq_timedreceive()
> *   mq_timedsend()
> *   msgrcv()
> *   msgsnd()
> *   同步（）
> *   纳米睡眠（）
> *   打开（）
> *   暂停（）
> *   轮询（）
> *   预读（）
> *   选择（）
> *   pthread_cond_timedwait()
> *   pthread_cond_wait()
> *   pthread_join()
> *   pthread_testcancel()
> *   putmsg()
> *   putpmsg()
> *   pwrite()
> *   read()
> *   readv()
> *   recv()
> *   recvfrom()
> *   recvmsg()
> *   select()
> *   sem_timedwait()
> *   sem_wait()
> *   send()
> *   sendmsg()
> *   sendto()
> *   sigpause()
> *   sigsuspend()
> *   sigtimedwait()
> *   sigwait()
> *   sigwaitinfo()
> *   sleep()
> *   system()
> *   tcdrain()
> *   usleep()
> *   wait()
> *   waidid()
> *   waitpid()
> *   write()
> *   writev()

> A cancellation point may also occur when a thread is executing the following functions:

> *   access()
> *   asctime()
> *   asctime_r()
> *   catclose()
> *   catgets()
> *   catopen()
> *   closedir()
> *   closelog()
> *   ctermid()
> *   ctime()
> *   ctime_r()
> *   dbm_close()
> *   dbm_delete()
> *   dbm_fetch()
> *   dbm_nextkey()
> *   dbm_open()
> *   dbm_store()
> *   dlclose()
> *   dlopen()
> *   endgrent()
> *   endhostent()
> *   endnetent()
> *   endprotoent()
> *   endpwent()
> *   endservent()
> *   endutxent()
> *   fclose()
> *   fcntl() (For any value of the cmd argument. [Presumably except F_SETLKW which is listed.]
> *   fflush()
> *   fgetc()
> *   fgetpos()
> *   fgets()
> *   fgetwc()
> *   fgetws()
> *   fmtmsg()
> *   fopen()
> *   fpathconf()
> *   fprintf()
> *   fputc()
> *   fputs()
> *   fputwc()
> *   fputws()
> *   fread()
> *   freopen()
> *   fscanf()
> *   fseek()
> *   fseeko()
> *   fsetpos()
> *   fstat()
> *   ftell()
> *   ftello()
> *   ftw()
> *   fwprintf()
> *   fwrite()
> *   fwscanf()
> *   getaddrinfo()
> *   getc()
> *   getc_unlocked()
> *   getchar()
> *   getchar_unlocked()
> *   getcwd()
> *   getdate()
> *   getgrent()
> *   getgrgid()
> *   getgrgid_r()
> *   getgrnam()
> *   getgrnam_r()
> *   gethostbyaddr()
> *   gethostbyname()
> *   gethostent()
> *   gethostid()
> *   gethostname()
> *   getlogin()
> *   getlogin_r()
> *   getnameinfo()
> *   getnetbyaddr()
> *   getnetbyname()
> *   getnetent()
> *   getopt() (if *opterr* is non-zero.)
> *   getprotobyname()
> *   getprotobynumber()
> *   getprotoent()
> *   getpwent()
> *   getpwnam()
> *   getpwnam_r()
> *   getpwuid()
> *   getpwuid_r()
> *   gets()
> *   getservbyname()
> *   getservbyport()
> *   getservent()
> *   getutxent()
> *   getutxid()
> *   getutxline()
> *   getwc()
> *   getwchar()
> *   getwd()
> *   glob()
> *   iconv_close()
> *   iconv_open()
> *   ioctl()
> *   link()
> *   localtime()
> *   localtime_r()
> *   lseek()
> *   lstat()
> *   mkstemp()
> *   mktime()
> *   nftw()
> *   opendir()
> *   openlog()
> *   pathconf()
> *   pclose()
> *   perror()
> *   popen()
> *   posix_fadvise()
> *   posix_fallocate()
> *   posix_madvise()
> *   posix_openpt()
> *   posix_spawn()
> *   posix_spawnp()
> *   posix_trace_clear()
> *   posix_trace_close()
> *   posix_trace_create()
> *   posix_trace_create_withlog()
> *   posix_trace_eventtypelist_getne
> *   posix_trace_eventtypelist_rewin
> *   posix_trace_flush()
> *   posix_trace_get_attr()
> *   posix_trace_get_filter()
> *   posix_trace_get_status()
> *   posix_trace_getnext_event()
> *   posix_trace_open()
> *   posix_trace_rewind()
> *   posix_trace_set_filter()
> *   posix_trace_shutdown()
> *   posix_trace_timedgetnext_event(
> *   posix_typed_mem_open()
> *   printf()
> *   pthread_rwlock_rdlock()
> *   pthread_rwlock_timedrdlock()
> *   pthread_rwlock_timedwrlock()
> *   pthread_rwlock_wrlock()
> *   putc()
> *   putc_unlocked()
> *   putchar()
> *   putchar_unlocked()
> *   puts()
> *   pututxline()
> *   putwc()
> *   putwchar()
> *   readdir()
> *   readdir_r()
> *   remove()
> *   rename()
> *   rewind()
> *   rewinddir()
> *   scanf()
> *   seekdir()
> *   semop()
> *   setgrent()
> *   sethostent()
> *   setnetent()
> *   setprotoent()
> *   setpwent()
> *   setservent()
> *   setutxent()
> *   stat()
> *   strerror()
> *   strerror_r()
> *   strftime()
> *   symlink()
> *   sync()
> *   syslog()
> *   tmpfile()
> *   tmpnam()
> *   ttyname()
> *   ttyname_r()
> *   tzset()
> *   ungetc()
> *   ungetwc()
> *   unlink()
> *   vfprintf()
> *   vfwprintf()
> *   vprintf()
> *   vwprintf()
> *   wcsftime()
> *   wordexp()
> *   wprintf()
> *   wscanf()

> An implementation shall not introduce cancellation points into any other functions specified in this volume of IEEE Std 1003.1-2001.
> 
> The side effects of acting upon a cancellation request while suspended during a call of a function are the same as the side effects that may be seen in a single-threaded program when a call to a function is interrupted by a signal and the given function returns [EINTR]. Any such side effects occur before any cancellation cleanup handlers are called.
> 
> Whenever a thread has cancelability enabled and a cancellation request has been made with that thread as the target, and the thread then calls any function that is a cancellation point (such as pthread_testcancel() or read()), the cancellation request shall be acted upon before the function returns. If a thread has cancelability enabled and a cancellation request is made with the thread as a target while the thread is suspended at a cancellation point, the thread shall be awakened and the cancellation request shall be acted upon. However, if the thread is suspended at a cancellation point and the event for which it is waiting occurs before the cancellation request is acted upon, it is unspecified whether the cancellation request is acted upon or whether the cancellation request remains pending and the thread resumes normal execution.

Ugh! Can't get the table to work very well it looked OK in preview and nothing like a table afterwards. Look at the URL for the information! There are a lot of possible cancellation points.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-10-08T10:29:58.357

See the [pthread_cancel man page](http://www.mkssoftware.com/docs/man3/pthread_cancel.3.asp) for further and fast info.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-12T09:23:52.240

Additional Info: since kernel 2.6, Linux has used the NPTL thread library which is POSIX compliant, so cancellation points should be as above for recent Linux implmentations.

[http://www.ddj.com/linux-open-source/184406204](http://www.ddj.com/linux-open-source/184406204)******************