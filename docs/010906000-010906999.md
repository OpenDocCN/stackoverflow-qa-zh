# StackOverflow 问答 10906000-10906999

# c# - 使用 Moq 测试特定实施

> ID：10906000
> 
> 赞同：1
> 
> 时间：2012-06-05T22:39:24.287
> 
> 标签：c#, unit-testing, moq

更新 1，更多细节

我的问题很难解释，对不起......

简单的问题...您如何使用 Moq 测试特定的实现？

```
interface IShipping
{
    int CalculateCost();
}

class TruckShipping: IShipping
{
    int CalculateCost()
    {
        return 9;
    }
}

class Shipping: IShipping
{
    int CalculateCost()
    {
        return 5;
    }
}

class CalculateSomethingMore
{
    IShipping _shipping;
    CalculateSomethingMore(IShipping shipping)
    {
        // Here I want the TruckShipping implementation!
        _shipping = shipping;
    }
    DoCalc()
    {
        return _shipping.CalculateCost * 2;
    }
 } 
```

如果没有模拟，它可能看起来像（如果你不使用 DI）测试：

```
var truckShipping = new TruckShipping();
var advancedCalculation = CalculateSomethingMore(truckShipping);
var result = DoCalc();

var expected = 18;
Assert.IsTrue(result == expected); 
```

NUnit、FluentAssertions、MbUnit、xUnit 等。没关系 :)

测试： var truckShipping = Mock.Of<IShipping> .... ? 我想测试 TruckShipping 的实现。

并将其注入CalculateSomethingMore。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:48:10.710

您使用模拟来用**伪造**的轻量级对象**替换**真正的依赖项（通常太复杂而无法实例化） 。测试模拟对象根本没有意义，因为本质上，您将测试来自某个 3rd 方库的自动生成的代码。

 ****编辑**：

目前还不清楚你为什么要依赖**具体的实现**，特别是考虑到你正在使用 IoC 和 inject `IShipping`。无论如何，我认为你想要*一些可以模拟`TruckShipping`*的东西，但不是`TruckShipping`它本身。如果是这样，这很简单：

```
var shippingMock = new Mock<IShipping>();
// setting up mock to return 9 makes it behave as if it was TruckShipping
shippingMock.Stub(s => s.CalculateCost()).Returns(9);
var advancedCalculation = CalculateSomethingMore(shippingMock.Object);

var result = DoCalc();

var expected = 18;
Assert.IsTrue(result == expected); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T22:58:02.413

Moq 不是一个测试框架，它是一个 mockinq 框架，所以它不提供测试功能。

对于测试，您可以使用[SharpTestEx](http://sharptestex.codeplex.com)，例如您可以编写：

```
[TestMethod]
public void VerifyCostIsCorrect()
{
    new TruckShipping()
        .CalculateCost()
        .Should("The TruckShipping implementation returns a wrong cost.").Be.EqualTo(9);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-06T11:42:40.010

如果你想*测试 TruckShipping 的实现*，那么你需要单独的测试来`TruckShipping`实现。

目前您正在测试 的行为`CalculateSomethingMore`，它应该返回两倍的成本值，按运费计算。你不在乎哪个运输。的责任`CalculateSomethingMore`是询问运输的成本，并将成本加倍：

```
Mock<IShipping> shipping = new Mock<IShipping>();
shipping.Setup(s => s.CalculateCost()).Returns(10);
CalculateSomethingMore sut = new CalculateSomethingMore(shipping.Object);
Assert.That(20, Is.EqualTo(sut.DoCalc()));
shipping.VerifyAll(); 
```

您可以看到，该测试既不使用`9`也不`5`作为运费。为什么？因为你实际上并不关心它会有什么价值。计算运费不是被测班级的责任。

此外，您还需要对您的`TruckShipping`实施进行另一项测试，该测试将验证`TruckShipping`正确计算运输成本（这是您的运输对象的责任）：

```
TruckShipping sut = new TruckShipping();
Assert.That(9, Is.EqualTo(sut.DoCalc()); 
```**

# c# - 如何查看 Process.Start() 参数，因为它们被传递给可执行文件

> ID：10906001
> 
> 赞同：1
> 
> 时间：2012-06-05T22:39:26.997
> 
> 标签：c#, process.start

我正在尝试使用 Process.Start 运行 fortran 可执行文件，但它不工作。

```
Process proc = new Process();
string args = "<C:\\file.in> C:\\file.out";
proc.StartInfo = new ProcessStartInfo(AppName, args);
proc.Start(); 
```

如果我将这些参数粘贴到命令窗口中，应用程序将按预期运行。proc.Start() 未按预期运行。

有什么想法可以查看 Start 实际上作为参数传递的内容吗？我的直觉是，这是一个报价问题。

可执行文件启动并挂起，因此我确信 AppName 已正确传递，这看起来像是一个参数问题。

我尝试按照以下问题中的建议将 WorkingDirectory 设置为输入和输出文件：[process.start() 参数](https://stackoverflow.com/questions/3268022/process-start-arguments)，但这不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T00:12:55.497

`<`使用和命令行运算符进行重定向`>`是由命令行处理器实现的功能。哪个是 cmd.exe。使用它的 /c 参数只执行一个命令：

```
string args = "/c " + AppName + " < C:\\file.in > C:\\file.out";
proc.StartInfo = new ProcessStartInfo("cmd.exe", args);
proc.Start(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T01:37:15.210

您的**args**字符串正是作为参数传递给可执行文件的内容。您可以阅读您的 Process [ProcessStartInfo.Arguments Property](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.arguments)仔细检查它。

类似的事情曾经发生在我身上，即从命令行调用可执行文件有效而从代码没有，结果证明当从命令行调用可执行文件时，可执行文件正在我的 PC 的**[C:]**驱动器上运行，而当从它在我的 PC 的**[E:]**驱动器上运行的代码调用，该驱动器已满！

要检查您的应用程序使用哪个目录来运行可执行文件，请使用[Directory.GetCurrentDirectory 方法](http://msdn.microsoft.com/en-us/library/system.io.directory.getcurrentdirectory.aspx)。

# php - 如何检索和插入 ImageId？

> ID：10906003
> 
> 赞同：0
> 
> 时间：2012-06-05T22:39:40.423
> 
> 标签：php, mysql

我有一个 INSERT 函数，它在“Image”表的“ImageFile”字段中插入图像文件名，由于自动编号，每一行都有自己的 ImageId。下面是一个例子：

```
ImageId    ImageFile

23         orange.jpg
24         flowers.png
25         castle.png
26         orange.jpg 
```

我想要做的也是将 ImageId 插入到另一个带有 QuestionId 和 SessionId 的表中，以便该表（Image_Question）可以使用 ImageId 将 Image 表与 Image Question 表链接起来。但是我该如何编码，以便当我在上表中插入图像详细信息时，它将检索它的 ImageId 并将其存储在 Image_Question 表中的 ImageId 中。下面的例子：

```
ImageId   SessionId  QuestionId

23        AAA        1
24        AAA        2
25        AAA        3
26        AAA        4 
```

我已经对 SessionId 和 QuestionId 的 INSERT 值进行了编码，但只需要帮助来检索和插入 ImageId。以下是当前代码：

```
<?php

session_start();

//connect to db

$i = 0;

$insertimage = array();

for($i = 0;  $i < $c; $i++ ){

    $insertimage[] = "'". mysql_real_escape_string($_SESSION['id'] ) . 
                    ($_SESSION['initial_count'] > 1 ? $_SESSION['sessionCount'] : '') ."' ,'". 
                    mysql_real_escape_string( $_POST['numQuestion'][$i] ) ."'";

}

 $imagesql = "INSERT INTO Question (ImageId, SessionId, QuestionId) 
    VALUES (" . implode('), (', $insertimage) . ")";

echo($imagesql);

mysql_close();

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T04:47:44.607

查询执行后的 mysqli_insert_id() 可以解决问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T22:41:45.133

`auto_increment`您可以使用 MySQL 的[`last_insert_id()`](http://dev.mysql.com/doc/refman/5.6/en/information-functions.html#function_last-insert-id)函数获取最近生成的 id。PHP 通过[`mysql_insert_id()`](http://php.net/manual/en/function.mysql-insert-id.php). `last_insert_id`在每个连接的基础上工作，因此无需担心并发插入跨越 id。

# redis - ServiceStack Redis 客户端的非泛型 Store 方法或非泛型 GetTypedClient

> ID：10906005
> 
> 赞同：1
> 
> 时间：2012-06-05T22:39:45.847
> 
> 标签：redis, servicestack

我有一个对象，我不知道它是 DesignTime 的类型。我必须将它坚持到 Redis Db。

我需要非泛型 Store 方法或非泛型 GetTypedClient(Type t) 方法。

有内部 _StoreAll 方法，所以我不能使用。

使用 As不可能，因为我在设计时不知道对象的类型

任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T23:01:08.517

我[刚刚将 StoreObject 添加](https://github.com/ServiceStack/ServiceStack.Redis/commit/e0f01bb303f73e4811a4971c2988f1ed1b50435d)到[ServiceStack.Redis](https://github.com/ServiceStack/ServiceStack.Redis/)，它可以让您执行此操作。这在 v3.83 上可用，它也[发布到 NuGet](https://nuget.org/packages/ServiceStack.Redis/)。

您可以手动执行此操作，只需将对象序列化为 JSON 并使用 RedisClient 的[SetEntry](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack.Interfaces/Redis/IRedisClient.cs#L50)方法将其存储为您选择的键 - 当您使用通用 API 时，这也是幕后发生的事情。

# php - PDF 和 PHP。如何读取现场数据？

> ID：10906007
> 
> 赞同：-1
> 
> 时间：2012-06-05T22:40:02.443
> 
> 标签：php, database, pdf

我正在寻找一些帮助..

我需要创建一个网页（PHP）来读取上传的 PDF，并将所有 pdf 的 textarea/checkbox 等保存在数据库中。

有人可以推荐一个好的 PHP 类吗？我尝试了 FDF 库.. 但不适用于 PHP 5.3

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:50:04.557

如果您习惯使用框架，那么[Zend PDF](http://framework.zend.com/manual/en/zend.pdf.html)库可能正好适合您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T22:46:21.140

你试过[PDF阅读器](http://heartofthefyre.us/PDFreader/)吗？它适用于 PHP 5

# jquery - 使用 Jquery 和 Safari 显示/隐藏 div 时屏幕移动。我该如何防止这种情况？

> ID：10906008
> 
> 赞同：0
> 
> 时间：2012-06-05T22:40:07.587
> 
> 标签：jquery, html, css

问题仅限于 Safari：我有三个选项卡，每个选项卡显示一个 div id，同时隐藏另外两个。如果我单击 tab2 然后 tab3 然后 tab1 它会显示/隐藏正确的 div 而不会向上滚动屏幕，但是当我从标签 1 中单击 tab2 或 tab3 时，它会将屏幕向上移动到引用 div 的顶部。谁能想到为什么会出现这种情况以及如何解决？我希望在单击选项卡后不向上滚动屏幕的情况下显示/隐藏 div。谢谢！

这是 HTML 代码：

`

```
<a onClick="remove_visibility('tabs2'), remove_visibility('tabs3'), toggle_visibility('tabs1')">Tab 1</a> 

<a onClick="remove_visibility('tabs1'), remove_visibility('tabs3'), toggle_visibility('tabs2')" class="selected">Tab 2</a> 

<a onClick="remove_visibility('tabs1'), remove_visibility('tabs2'), toggle_visibility('tabs3')">Tab 3</a> 
```

`

这是相关的jQuery代码：

```
 <script type="text/javascript">
toggle_visibility = function (id) {
    var e = $("#"+id);
    e.show();
}
remove_visibility = function (id) {
    var e = $("#"+id);
    e.hide();
}

</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:48:13.383

我不会将 onclick 与 JQuery 调用一起使用，我会通过它们的锚 id、类或按类型或其他方式附加它们。也可以尝试在显示和隐藏后返回 false 的那些函数中，这可能会起到作用，因为我认为它试图导航到某个地方，因为你点击了一个空的锚点。

更新：

我有一些代码可以做到这一点，html位于页面底部，浏览器的滚动位置位于底部并且不会向上导航：

**JQuery**（这是一个基于我的 HTML 的快速模型，作为演示提供，根据您的需要定制它以及您将如何获取项目以及如何获取项目）：

```
<script type="text/javascript">
    $(document).ready(function() {
        $(".divClass a").each(function(i) {
            if ($(this).text() != 'Tab 2') {
                $(this).next().hide();
            }
            $(this).click(function() {
                $(".divClass a").each(function(i) {
                    $(this).next().hide();
                });
                $(this).next().show();
                return false;
            });
        });
    });
</script> 
```

**HTML**（再次快速将一些东西放在一起进行演示）：

```
<div class="divClass">
    <a href="JavaScript:void();">Tab 1</a>
        <div id="Tab1">
            I am Tab 1 
        </div>
    <a href="JavaScript:void();">Tab 2</a>
        <div id="Tab2">
            I am Tab 2 
        </div>
    <a href="JavaScript:void();">Tab 3</a>
    <div id="Tab3">
            I am Tab 3 
        </div>
</div> 
```

# jquery - 如果结果为空或未定义，则 jquery 停止

> ID：10906012
> 
> 赞同：0
> 
> 时间：2012-06-05T22:40:33.443
> 
> 标签：jquery, null, undefined

我有一个看起来像这样的脚本：

```
function bakVormShipping(targetClass) {
    $.getJSON('http://shop.com/cart/?format=json', function (data) {
        $.each(data.cart.shipping.methods, function (index, methods) {
            if (index == "core|2419|36557" || index == "core|2419|36558" || index == "core|2959|31490" || index == "core|2959|31491" || index == "core|2419|36556") {
                $('<strong/>').html('€' + (+methods.price.price_incl).toFixed(2)).appendTo(targetClass);
            }
        });
    });
} 
```

当“索引”不等于索引之一时，我在萤火虫中收到未定义或空错误。我怎样才能防止这种情况？显然与`if (index == null)`等有关，但我不知道如何以正确的方式做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:45:08.510

在 if 语句上方添加对 undefined 的检查

```
function bakVormShipping(targetClass) {
$.getJSON('http://shop.com/cart/?format=json', function (data) {

    $.each(data.cart.shipping.methods, function (index, methods) {
        if(typeof(index) == "undefined"){
            return;
        }

        if (index == "core|2419|36557" || index == "core|2419|36558" || index == "core|2959|31490" || index == "core|2959|31491" || index == "core|2419|36556") {
            $('<strong/>').html('€' + (+methods.price.price_incl).toFixed(2)).appendTo(targetClass);
        }

    });
}); 
```

您可能还想检查`data`您收到的对象是否具有您正在引用的属性`data.cart`，`data.cart.shipping`以及`data.cart.shipping.methods`

# joomla - Joomla 2.5 - 禁用 www.[websitename].com/?format=feed&type=rss

> ID：10906017
> 
> 赞同：0
> 
> 时间：2012-06-05T22:41:03.350
> 
> 标签：joomla

我一直在寻找一种方法来禁用提要链接（即：www.[websitename].com/?format=feed&type=rss）。

有没有办法禁用这个链接？我有一些糟糕的谷歌索引，当谷歌试图再次索引它们时，我想返回 404 not found 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-07T18:41:50.170

万一有人在那里寻找这个，对我有用的是在 JDocumentFeed 构造函数中设置 404 Not Found 标头：

```
function __construct($options = array()) {
    if (!headers_sent()) {
        header('HTTP/1.0 404 Not Found');
        //I guess you could include here a file to show the 404 page
    }
    exit();
} 
```

调用`JError::raiseError(404, JText::_('Resource Not Found'));`给了我错误的回溯。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T23:29:57.280

尝试编辑`libraries/joomla/document/feed/feed.php`文件。

在文件中找到类的`__construct` 方法`JFeedDocument`并将其更改为如下所示：

```
function __construct($options = array()) {
  JError::raiseError(404, JText::_('Resource Not Found'));
} 
```

但是，在这种情况下，您将根本没有“饲料”支持。

# android - Eclipse 从 /src 导入自定义类

> ID：10906033
> 
> 赞同：0
> 
> 时间：2012-06-05T22:42:57.177
> 
> 标签：android, eclipse

嘿，我在将类导入基于 Eclipse 的 Android 应用程序时遇到了一个非常基本的问题。我已将类目录包含在 /src 目录中，我认为这些类将很容易包含在内，但 Eclipse 说它“无法解析类”。

我注意到的一件事是我包含的项目文件夹和子文件夹只是常规文件夹，而不是包文件夹图标。那是问题吗？如果是这样，我如何将它们更改为包？这是一个外部 git repo，所以除了将它们包含在我的项目中之外，我宁愿不做任何事情。

以下是我如何设置项目以提供帮助的一些图片：

错误所在的活动：

![在此处输入图像描述](../Images/6df4eb0472531885110ff87caae242ea.png)

这是项目中的包结构，以及名为“android-utils”的包，其中我要导入的文件是：

![在此处输入图像描述](../Images/40623fab771c617f16634bb2fc227611.png)

这是我导入文件的方式：

![在此处输入图像描述](../Images/995873586bf508d2cba932cf46a4bbe6.png)

顺便说一句，这些类只是一些实用程序，我将在开发过程中对其进行改进和添加。

如果您需要更多信息来帮助我以正确的方式导入这些文件，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T23:07:00.183

由于您的文件夹仅包含 java 文件，因此将它们作为 Jar 文件添加到您的 Buildpath 项目中，您的问题将得到解决。

另外，您的 jar 文件可以放在 /libs 文件夹下，请参阅此[链接](http://viralpatel.net/blogs/2008/12/create-jar-file-in-java-eclipse.html)以了解如何创建 jar 文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T00:27:13.567

您是否尝试将 .java 文件从 Windows 资源管理器直接拖到 Eclipse 中您想要将新类放入的包中？然后它应该要求复制或链接到文件。

# java - 查找包又名 java 类的默认范围成员

> ID：10906039
> 
> 赞同：1
> 
> 时间：2012-06-05T22:43:18.850
> 
> 标签：java, eclipse

我想在我的项目中找到所有默认范围的，也就是包范围的类成员。（其他范围没问题，因为我可以搜索关键字public/protected/private，但是在这种情况下没有关键字可以搜索。）

是否有 eclipse 插件或任何可以进行这种搜索的东西？

```
public class Foo {
    private int a;   // these are easy
    protected int b; // to find,
    public int c;    // thanks to keywords

    int d; // but ones like this?
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:47:31.273

你可能想看看 javap：

[http://docs.oracle.com/javase/1.5.0/docs/tooldocs/windows/javap.html](http://docs.oracle.com/javase/1.5.0/docs/tooldocs/windows/javap.html)

它主要用于反汇编类，但它还允许您包含/排除不同范围的类成员（例如，私有与公共）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T02:28:07.657

由于 javap 似乎不是一个合适的解决方案，而且我不知道任何合适的插件，您可能必须自己编写。

```
Feed it a list of classes.
for each class
    Use Class.forName(className) to get the class object
    use getDeclared{Classes,Fields,Methods,Constructors} to get the members.
    for each member
        Use java.lang.reflect.Modifiers.is{Public,Private,Protected}(member.getModifiers())
        It is default if all three are false
        If default report that member
        You decide whether and how to recurse into inner classes. 
```

我猜该解决方案不适用于嵌套在方法中的类。（javap、javadoc 也不会解决嵌套在方法中的类。）如果您可以断言您的代码没有嵌套在方法中的类，这将使事情变得更加简单。

# jsf-2 - 如何让 EL 2.2 在 WAS 7（使用 Myfaces 和 Primefaces）上运行？

> ID：10906040
> 
> 赞同：4
> 
> 时间：2012-06-05T22:43:21.063
> 
> 标签：jsf-2, primefaces, el, myfaces

我正在将一个在 WAS7 中运行的 JSF 1.2 项目迁移到带有 Myfaces 2.1.7 和 Primefaces 的 JSF2。

到目前为止，一切都或多或少正常工作，将 myfaces-bundle-2.1.7.jar 和 primefaces 3.3.RC1.jar 放入 WEB-INF/lib 并更改为类加载顺序。

现在，我正在尝试让 EL2.2 工作：相应的类是 Myfaces Impl 类的一部分（在 myfaces-bundle-2.1.7.jar 中，但使用了哪个特定配置？），还是我错过了一些特定的库添加到 /WEB-INF/lib ？

谢谢你读我；）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T23:42:20.317

EL 2.2 不是 JSF 2.0 的一部分。它是 Servlet 3.0 的一部分，而后者又是 Java EE 6 的一部分。但 WebSphere 7 是 Java EE 5 容器，而不是 Java EE 6 容器。JSF 2.0 是 Java EE 6 的一部分，但向后兼容 Servlet 2.5 / Java EE 5，这可能就是您的困惑所在。

如前所述，WebSphere 7 是一个 Servlet 2.5 容器，因此不随 EL 2.2 提供，而是随 EL 2.1 提供。最好的办法是安装一个 EL 2.1 实现，它支持与 EL 2.2 中相同的增强功能（使用参数调用方法）。只有一个：[JBoss EL](http://docs.jboss.org/seam/latest-2.2/reference/en-US/html/elenhancements.html)。要安装它，只需将[jboss-el.jar](https://maven.atlassian.com/content/repositories/jboss-releases/org/jboss/seam/jboss-el/2.0.0.GA/jboss-el-2.0.0.GA.jar)放到 webapp 中`/WEB-INF/lib`，然后将以下上下文参数添加到您的`web.xml`，以告诉 MyFaces 使用它。

```
<context-param>     
    <param-name>org.apache.myfaces.EXPRESSION_FACTORY</param-name>
    <param-value>org.jboss.el.ExpressionFactoryImpl</param-value>   
</context-param> 
```

# datetime - EF 迁移：无法添加 DateTime 列

> ID：10906042
> 
> 赞同：4
> 
> 时间：2012-06-05T22:43:37.420
> 
> 标签：datetime, entity-framework-migrations

我正在使用 ASP.Net 4 EF 4.3.1 代码优先迁移。

我有一个现有的模型类。我已经向它添加了一个属性：

```
public DateTime LastUpdated { get; set; } 
```

当我运行 update-database -force -verbose 我得到：

> ALTER TABLE [MyTable] ADD [LastUpdated] [datetime] NOT NULL DEFAULT '0001-01-01T00:00:00.000'
> System.Data.SqlClient.SqlException (0x80131904)：导致将 varchar 数据类型转换为 datetime 数据类型在一个超出范围的值。
> 该语句已终止。

我猜这与生成的 SQL 中使用的隐含默认值有关——它似乎在抱怨它用来初始化事物的 varchar 是数据丢失。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-05T22:43:37.950

无法添加非空 DateTime 列的问题的答案与获取为 DateTime 列指定的 2 个默认值的问题相同： [EF 4.3.1 迁移异常 - AlterColumn defaultValueSql 为不同的创建相同的默认约束名称表](https://stackoverflow.com/questions/9830216/ef-4-3-1-migration-exception-altercolumn-defaultvaluesql-creates-same-default/)

也就是说，它已经被破坏了很长时间，您可以通过迁移它来解决它：

```
public DateTime? LastUpdated { get; set; }

PM> update-database 
```

然后再次迁移它而不是 null 以到达您想要的位置：

```
public DateTime LastUpdated { get; set; }

PM> update-database 
```

# php - 验证并可能更正我拥有的 XML 文件

> ID：10906049
> 
> 赞同：0
> 
> 时间：2012-06-05T22:44:09.787
> 
> 标签：php, xml, domdocument, xml-validation

我有一个需要使用的 XML 文件（随机资源）。我正在使用 PHP DOM Document 来处理这个文档和 DOMXPath 来查询对象。但是，XPath 查询不返回任何类型的数据（resultset->length = 0）。查询是正确的，我不担心它的语法。我还尝试了 DOMDOcument->getElementsByTagName("tag") ，这也返回了一个空结果。

在上面的上下文中，我如何检查我的 DOMDocument 是否能够在我调用

```
DOMDocument->Load('file.xml')

[also tried 

$xmlFile = file_get_contents('file.xml')
DOMDocument->loadXML($xmlFile)] 
```

我假设如果 XML 文件有问题，那么我很可能根本无法查询 DOMDocument 吗？无论如何，我是否可以检查 a) 当我调用 DOMDocument->Load/loadXML 方法时是否完全加载了文档 b) 使用外部资源验证 XML 文件（w3 学校验证器是我知道的唯一一个）c) 如果XML文件不正确，无论如何我可以纠正它吗？

感谢所有抽出时间阅读本文的人。

最佳，Parijat Kalia

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T13:41:41.770

在做任何事情之前尝试打开它：

`libxml_use_internal_errors(true);`

然后在加载您的 XML 后，使用以下命令查找错误：

`$errors = libxml_get_errors();`

您可以迭代`$errors`（它是一个[libXMLError](http://www.php.net/manual/en/class.libxmlerror.php)对象数组）。

例如：

```
libxml_use_internal_errors(true);

try
{
    $doc = new DOMDocument();
    $doc->load("somebadxmlfile.xml");
}
catch (Exception $e)
{
    $errors = libxml_get_errors();

    foreach ($errors as $error)
    {
        echo $error->message . " [ Line: " . $error->line . " | Column: " . $error->column . " | Level: " . $error->level . " | File: " . $error->file . " ]";
    }
} 
```

# php - 为什么 PHP 只适用于 Ajax 而 Python 不适用？

> ID：10906051
> 
> 赞同：4
> 
> 时间：2012-06-05T22:44:31.827
> 
> 标签：php, python, ajax

构建响应 Ajax 请求的 PHP 脚本非常简单：

```
<?php
  $command = $_POST["command"];
  if ($command == "say_hello") {
    $name = $_POST["name"];
    echo json_encode(array("message" => "Hello, " . $name));
  }
?> 
```

并且，至少如果您在客户端使用 jQuery，并且如果您在原始请求上指定了回调函数，则包含消息的数组将被传递到该回调函数中。

但是使用 Python 就没有那么简单了。或者至少我还没有想出如何让它变得那么简单。如果我只是尝试“打印”一个响应（与上面的 PHP 的“echo”语句平行），客户端不会得到任何回报。

每当我在 Internet 上查看如何使用 Python 响应 Ajax 请求时，答案总是涉及使用 Django 或其他一些 Web 框架。

而且我知道这些东西很棒，但是 PHP 做了什么使得不需要使用类似的包？我想用 Python 而不是 PHP 编写我的服务器端脚本，但我更喜欢 DIY 方法来使用第三方框架来完成应该（对吗？）一项非常简单的任务。

有什么帮助吗？如何做到这一点的一个例子将不胜感激。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-05T23:16:43.403

> 但是使用 Python 就没有那么简单了。或者至少我还没有想出如何让它变得那么简单。如果我只是尝试“打印”一个响应（与上面的 PHP 的“echo”语句平行），客户端不会得到任何回报。

我可能有一些细节错误，但我会尝试解释为什么会这样。首先，您所说的 PHP 是直接烘焙到 apache 网络服务器中的。当您执行 时`echo`，它会将结果输出到响应流（服务器和客户端之间的 TCP 连接）。当您`print`在 python 中执行操作时，您所做的是将结果输出到标准输出（命令行）。

大多数语言如何与网络一起工作，请求进入某种网络服务器，然后该网络服务器执行程序。该程序负责返回一个流，Web 服务器接收该流，并通过 TCP 连接流到客户端。

我假设网络服务器将 PHP 标准重定向到网络服务器流，这就是 PHP 能够用来`echo`返回其结果的方式。这是例外，而不是规则。

因此，要使用 python 来处理请求，您需要有一个可以以某种方式执行 python 的网络服务器。这通常是使用 CGI 完成的。最近，类似的东西`mod_python`被用来在 apache 中托管 python。如今，`wsgi`or`mod_wsgi`被使用，这是为与 python 对话的网络服务器定义的标准。

你可能想看看[web.py 之](http://webpy.org/docs/0.3/tutorial)类的东西，它是一个极简的 Python Web 框架。这将使您非常接近您正在尝试做的事情。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-05T23:34:13.567

PHP 从一开始就考虑到了 Web。相比之下，Python 被设计为一种通用语言。

当您从 PHP 回显时，您实际上是在写入作为 HTTP 响应的一部分发送给用户的流。当您在 python 中进行打印时，默认情况下，输出将写入标准输出流，这意味着输出不会通过 http 发送给用户，而是写入控制台（或目前正在捕获标准输出的任何内容）。

所以对于 PHP，HTTP 是一等公民。对于更通用的语言，如 Python、Ruby、Erlang、C、C++ 和许多其他语言。您必须以不同的方式与 HTTP 通信。PHP 已经通过 apache 的 mod_php 或 PHP-FPM 之类的东西来处理这种通信。

苏……

至于创建自己的服务器端脚本，我强烈建议不要这样做，因为 Python 的框架取代了构建 PHP 的层。因此，使用 Python 自己创建一个符合标准的 http 服务器不会很简单。之所以如此困难，是因为您要么必须与 CGI 或 WSGI（一种用于处理 Web 的 Python 标准）交互，要么创建自己的 HTTP 服务器。如果您认为自己能够胜任这项任务，那么我强烈建议您这样做！通过这样做，您可能会学到很多东西，但这不会是最简单的事情。很棒的是，很多图书馆已经为您处理了这种交流。例如，如果您正在寻找轻量级的东西，我强烈建议您使用像[烧瓶这样的微框架](http://flask.pocoo.org)如果我需要一些非常简单的东西，这是我个人使用的。它比 django 更容易上手，但它包含的电池也更少。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-05T22:52:28.250

有一个名为[json](http://www.doughellmann.com/PyMOTW/json/)的 python 模块。也许很多答案都涉及框架（如 Django），因为 json 是以 web 为中心的，而 Django、tornado、twisted、cherrypy 等都是 python 与 web 交互的方式。

有许多不同的方法可以做到这一点，这些方法在其他问题中得到解决。但是，为了回答您的问题，python[在其标准库中有一个 json 库](http://docs.python.org/library/json.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T22:59:30.967

大多数 PHP 安装程序默认配置为通过运行脚本在 web 目录中提供 php 文件。大多数 Python 安装程序没有。使用 apache 服务 Python 的最快方法：

*   在您的 apache 配置文件中，添加`AddHandler cgi-script .py`到已经可以提供 PHP 文件的任何块
*   通过添加 #!/usr/local/bin/python 或系统中 python 所在的任何路径来编译你的 python 脚本
*   请记住先打印标题，然后是换行符，然后是正文。
*   `import cgi`如果您想做比发回响应正文更复杂的事情，请使用。

请注意，这不是运行 python 网站的*推荐*方式，只是*快速的 php-ish 方式*。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-05T23:00:42.753

Richardhsu 的要点是正确的。

本质上，python 是一种通用脚本语言。因此，它需要一种连接到 Web 的方法，例如通过打开端口和进行网络编程等。您还可以使用 CGI 连接到 apache 或其他 Web 服务器。

这与 Java、Ruby、Perl 或 C/C++ 进入网络的方式并没有什么不同。事实上，PHP 做了很多相同的事情。它与 Web 服务器的接口比 CGI 更紧密。

如果您要从命令行解释或编译 PHP，那么您将遇到与现在使用 Python 所做的完全相同的问题。问题不在于 PHP 与 Python，而在于您如何使用 HTTP 协议将您选择的脚本语言附加到 Internet。

# performance - 如何在 Haskell 中编写高效的动态规划算法？

> ID：10906053
> 
> 赞同：23
> 
> 时间：2012-06-05T22:44:35.750
> 
> 标签：performance, algorithm, haskell, functional-programming

我一直在玩 Haskell 中的动态编程。实际上，我在该主题上看到的每个教程都提供了相同的、非常优雅的算法，该算法基于记忆化和 Array 类型的惰性。受这些示例的启发，我编写了以下算法作为测试：

```
-- pascal n returns the nth entry on the main diagonal of pascal's triangle
-- (mod a million for efficiency)
pascal :: Int -> Int
pascal n  = p ! (n,n) where
           p = listArray ((0,0),(n,n)) [f (i,j) | i <- [0 .. n], j <- [0 .. n]]

           f :: (Int,Int) -> Int
           f (_,0) = 1
           f (0,_) = 1
           f (i,j) = (p ! (i, j-1) + p ! (i-1, j)) `mod` 1000000 
```

我唯一的问题是效率。即使使用 GHC 的 -O2，这个程序也需要 1.6 秒来计算`pascal 1000`，这比同等的未优化 C++ 程序慢了大约 160 倍。并且差距只会随着更大的投入而扩大。

似乎我已经尝试了上述代码的所有可能排列，以及建议的替代方案，如 data-memocombinators 库，它们都有相同或更差的性能。我没有尝试过的一件事是 ST Monad，我确信它可以让程序运行的速度只比 C 版本慢一点。但我真的很想用惯用的 Haskell 来写它，我不明白为什么惯用的版本效率如此之低。我有两个问题：

1.  为什么上面的代码效率这么低？这似乎是对矩阵的简单迭代，每个条目都有一个算术运算。显然，Haskell 在幕后做了一些我不明白的事情。

2.  有没有办法在不牺牲其无状态、递归公式（相对于在 ST Monad 中使用可变数组的实现）的情况下使其更高效（最多是 C 程序运行时间的 10-15 倍）？

非常感谢。

编辑：使用的数组模块是标准的 Data.Array

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-06T00:06:36.570

好吧，算法可以设计得更好一点。使用该`vector`包并巧妙地一次只在内存中保留一行，我们可以以不同的方式获得一些惯用的东西：

```
{-# LANGUAGE BangPatterns #-}
import Data.Vector.Unboxed
import Prelude hiding (replicate, tail, scanl)

pascal :: Int -> Int
pascal !n = go 1 ((replicate (n+1) 1) :: Vector Int) where
  go !i !prevRow
    | i <= n    = go (i+1) (scanl f 1 (tail prevRow))
    | otherwise = prevRow ! n
  f x y = (x + y) `rem` 1000000 
```

这可以*非常*紧密地优化，特别是因为该`vector`包包含一些相当巧妙的技巧来透明地优化以惯用风格​​编写的数组操作。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-05T23:42:42.810

> 1 为什么上面的代码效率这么低？这似乎是对矩阵的简单迭代，每个条目都有一个算术运算。显然，Haskell 在幕后做了一些我不明白的事情。

问题是代码将 thunk 写入数组。然后，当读取条目时`(n,n)`，对 thunk 的评估再次在整个数组中跳跃，循环直到最终找到不需要进一步递归的值。这会导致大量不必要的分配和低效率。

C++ 代码没有这个问题，值被写入并直接读取，无需进一步评估。就像`STUArray`. 做

```
p = runSTUArray $ do
    arr <- newArray ((0,0),(n,n)) 1
    forM_ [1 .. n] $ \i ->
        forM_ [1 .. n] $ \j -> do
            a <- readArray arr (i,j-1)
            b <- readArray arr (i-1,j)
            writeArray arr (i,j) $! (a+b) `rem` 1000000
    return arr 
```

真的长得这么差吗？

> 2 有没有办法在不牺牲其无状态的递归公式（相对于在 ST Monad 中使用可变数组的实现）的情况下使其更高效（最多是 C 程序运行时间的 10-15 倍）？

我不知道一个。但可能有。

附录：

一旦使用`STUArray`s 或 unboxed `Vector`s，与等效的 C 实现仍然存在显着差异。原因是 gcc 用`%`乘法、移位和减法的组合替换 （即使没有优化），因为模数是已知的。在 Haskell 中手动做同样的事情（因为 GHC 还没有这样做），

```
-- fast modulo 1000000
-- for nonnegative Ints < 2^31
-- requires 64-bit Ints
fastMod :: Int -> Int
fastMod n = n - 1000000*((n*1125899907) `shiftR` 50) 
```

获得与 C 相当的 Haskell 版本。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-06-06T01:01:18.287

诀窍是考虑如何一次编写整个该死的算法，然后使用未装箱的向量作为支持数据类型。例如，以下代码在我的机器上的运行速度比您的代码快 20 倍：

```
import qualified Data.Vector.Unboxed as V

combine :: Int -> Int -> Int
combine x y = (x+y) `mod` 1000000

pascal n = V.last $ go n where
    go 0 = V.replicate (n+1) 1
    go m = V.scanl1 combine (go (m-1)) 
```

然后我写了两个`main`函数调用你的和我的，参数为 4000；`10.42s`这些分别跑进来`0.54s`。当然，我相信你知道，它们都被`0.00s`使用更好算法的版本从水中吹走了（ ）：

```
pascal' :: Integer -> Integer
pascal :: Int -> Int
pascal' n = product [n+1..n*2] `div` product [2..n]
pascal = fromIntegral . (`mod` 1000000) . pascal' . fromIntegral 
```

# c# - 让 WSHttpBinding 通过 http 代理工作

> ID：10906054
> 
> 赞同：2
> 
> 时间：2012-06-05T22:44:49.973
> 
> 标签：c#, wcf, proxy, wshttpbinding

我有一个 WCF 服务和一个使用该服务的客户端。他们使用 WSHttpBinding 和 MTOM 消息编码。客户端不使用 app.config 文件，而是在代码中完成所有端点配置。这一切在正常环境中运行得相当好，但是我现在有一些用户试图从 http 代理后面连接到服务。每当他们尝试连接时，都会收到 407（需要代理身份验证）警告。

我已经设法使用具有连接到代理的专用网络的虚拟机设置了自己的测试环境，因此我可以模拟他们所看到的。我尝试在 app.config 中设置 system.net useDefaultCredentials 属性，但这似乎没有任何效果。我检查了正在发送的数据包，它们不包含任何 Proxy-Authentication 标头。通过代理查看网络流量，他们确实使用了该标头。

我也尝试将代理服务器硬编码到客户端中，但这给出了“无法连接到服务器”异常。检查数据包，客户端向代理发送了 3 个小数据包，其中没有一个是 http 请求，仅此而已。我不确定它在那里做什么。

我什至向客户端添加了一个消息检查器，并手动将所需的标头注入到请求中，但这并没有显示在标头中。

我已经走到尽头了，我真的需要一个解决方案。关于我在这里缺少什么或解决方案的任何想法？

这（[带有 wsHttpBinding 的 WCF 服务 - 操作 HTTP 请求标头](https://stackoverflow.com/questions/9111361/wcf-service-with-wshttpbinding-manipulating-http-request-headers)）似乎很有希望，但我仍然卡住了。

编辑：这是代码的一部分。

```
 var binding = new WSHttpBinding();
            binding.MaxReceivedMessageSize = 100000000;
            binding.MessageEncoding = WSMessageEncoding.Mtom;
            binding.ReaderQuotas.MaxArrayLength = 100000000;
            binding.OpenTimeout = new TimeSpan(0, 2, 0);
            binding.ReceiveTimeout = new TimeSpan(0, 2, 0);
            binding.SendTimeout = new TimeSpan(0, 2, 0);
            binding.Security.Message.ClientCredentialType = MessageCredentialType.UserName;

            binding.UseDefaultWebProxy = true;
            // I've also tried setting this to false, and manually specifying the binding.ProxyAddress

            binding.Security.Transport.ProxyCredentialType = HttpProxyCredentialType.Basic;
            var endpointAddress = new EndpointAddress(new Uri(hostUrl));
            clientProxy_ = new UpdaterServiceProxy(binding, endpointAddress);

            // this behavior was the attempt to manually add the Proxy-Authentication header
            //clientProxy_.Endpoint.Behaviors.Add(new MyEndpointBehavior());

            clientProxy_.ClientCredentials.UserName.UserName = userName;
            clientProxy_.ClientCredentials.UserName.Password = password;
            clientProxy_.ClientCredentials.ServiceCertificate.Authentication.CertificateValidationMode =
                    System.ServiceModel.Security.X509CertificateValidationMode.ChainTrust;
            // do stuff... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T17:16:27.823

经过大量的实验，我取得了一些进展。事实证明，我可以手动指定代理，它会起作用。

```
WebProxy proxy = new WebProxy("http://x.x.x.x:3128", false);
proxy.Credentials = new NetworkCredential("user", "pass");
WebRequest.DefaultWebProxy = proxy; 
```

该代码出现在我实例化我的 clientProxy_ 之​​前。我之前尝试过这个，但是因为我没有指定端口，所以它默默地失败了。我仍然无法获取 Windows Internet 设置中指定的代理设置。我尝试了设置`proxy.Credentials = CredentialCache.DefaultNetworkCredentials;`，但这似乎也没有效果。

我现在也遇到了一个问题，客户端尝试使用 ChainTrust 验证服务的证书，但是对链式证书的请求没有使用代理设置。由于这是一个更具体的问题，我在这里单独写了：[证书验证不使用代理设置进行链信任](https://stackoverflow.com/questions/10953247/certificate-validation-doesnt-use-proxy-settings-for-chaintrust)

所以我仍然希望得到更多帮助。

**更新**：我最终只是在我的应用程序中添加了一个网络配置对话框，以便用户可以指定他们的代理设置。我一直无法让自动代理设置正常工作。

# facebook - facebook批量请求获取所有照片

> ID：10906062
> 
> 赞同：0
> 
> 时间：2012-06-05T22:45:58.393
> 
> 标签：facebook, facebook-graph-api, facebook-php-sdk, facebook-batch-request

我想获取授予应用程序权限的用户的所有照片。目前，我尝试了 Graph API 的单个和批处理请求，但它总是对结果进行分页。有没有一种无缝的方式来获取所有对象而无需跟随页面？

ps：我使用的是PHP-SDK，所以用php回答就是钱:)

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-06T23:39:49.437

I found out that giving limit=0 is solving the problem. It still generates paging object but they return empty data set. So, limit=0 returns the whole dataset in one shot.

# visual-c++ - 仅在需要时才在 MFC 应用程序中请求管理员权限

> ID：10906072
> 
> 赞同：3
> 
> 时间：2012-06-05T22:46:37.550
> 
> 标签：visual-c++, mfc, uac

我正在使用 Visual C++ 2010 开发一个应用程序，该应用程序针对 Windows 7。有一项任务是将一些值写入注册表，这只会在某些特殊情况下发生。并且由于在 Windows 7 中，需要具有管理员权限才能执行此操作。我如何以某种方式对我的应用程序进行编程，当需要执行此类操作时，它会要求管理员权限，并且在启动时不会要求管理员权限。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T00:00:39.520

就像马克说的那样，你不能按需提升你的特权。一个快速的解决方案是编写一个单独的可执行文件来完成编写部分，并在需要时使用特定的命令行参数启动它。当然，这个可执行文件必须在其清单中具有“requireAdministrator”权限。

您还可以将此程序设计为服务并设置 IPC 机制，例如使用命名管道。可以使用安全描述符创建管道本身，该安全描述符允许普通用户访问它，确保以较低权限运行的程序能够写入它。

第二种方法的目的是消除第一种解决方案中出现的讨厌的 UAC 提示。

# ruby-on-rails - 测试 - rspec Hartl 教程，第 5.33 章

> ID：10906074
> 
> 赞同：0
> 
> 时间：2012-06-05T22:46:48.237
> 
> 标签：ruby-on-rails, rspec, railstutorial.org

在尝试创建登录页面的测试中，我不断遇到同样的两次失败。

**这是错误消息：** $ bundle exec rspec spec/requests/user_pages_spec.rb FF

失败：

1) 用户页面注册页面Failure/Error: before { visit signup_path } ActionView::Template::Error: undefined method `|' for "Ruby on Rails Tutorial Sample App":String # ./app/helpers/application_helper.rb:9:in`full_title' # ./app/views/layouts/application.html.erb:4:in `_app_views_layouts_application_html_erb__2148911516627374684_2168968760' # ./spec/requests/user_pages_spec.rb:8:in`block (3 levels)在 '

2) 用户页面注册页面Failure/Error: before { visit signup_path } ActionView::Template::Error: undefined method `|' for "Ruby on Rails Tutorial Sample App":String # ./app/helpers/application_helper.rb:9:in`full_title' # ./app/views/layouts/application.html.erb:4:in `_app_views_layouts_application_html_erb__2148911516627374684_2168968760' # ./spec/requests/user_pages_spec.rb:8:in`block (3 levels)在 '

在 0.17668 秒内完成 2 个示例，2 个失败

失败的例子：

rspec ./spec/requests/user_pages_spec.rb:10 # 用户页面注册页面 rspec ./spec/requests/user_pages_spec.rb:11 # 用户页面注册页面

**这是文件 user_pages_spec.rb**

需要'spec_helper'

描述“用户页面”做

主题{页面}

在 { 访问 signup_path } 之前描述“注册页面”

```
it { should have_selector('h1', text: 'Sign up') }
it { should have_selector('title', text: full_title('Sign up')) } 
```

结束结束

**这是文件 application_helper.rb：**

模块 ApplicationHelper

```
 # Returns the full title on a per-page basis.
  def full_title(page_title)
    base_title = "Ruby on Rails Tutorial Sample App"
    if page_title.empty?
      base_title
    else
      "#{base_title}" | "#{page_title}"
    end
  end
end 
```

**这是文件 routes.rb** SampleApp::Application.routes.draw do get "users/new"

```
 root to: 'static_pages#home'

  match '/signup',  to: 'users#new'

  match '/help',    to: 'static_pages#help'
  match '/about',   to: 'static_pages#about'
  match '/contact', to: 'static_pages#contact' 
```

我一直坚持这一点，所以任何帮助将不胜感激！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T22:49:08.853

它在此处为您提供的 rails 错误消息非常具有描述性。

如果我们看这条线

```
undefined method `|' for "Ruby on Rails Tutorial Sample App":String # ./app/helpers/application_helper.rb:9:in full_title 
```

它告诉我们它在方法定义中的 application_helper.rb 的第 9 行找不到`|`为字符串调用的方法。如果我们到达那条线，我们可以看到`"Ruby on Rails Tutorial Sample App"``full_title`

```
 "#{base_title}" | "#{page_title}" 
```

哪个 ruby​​ 解释为“运行方法 | 在“#{base_title}”的结果上（在这种情况下计算为字符串“Ruby on Rails 教程示例应用程序”），参数为“#{page_title}”。因为字符串不'没有'|' 方法，它返回一个“未定义的方法”错误。

要修复，只需将行更改为

```
 "#{base_title} | #{page_title}" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T22:53:11.020

这一行：

```
 "#{base_title}" | "#{page_title}" 
```

是罪魁祸首。

我将为您分解错误消息（您会想要擅长阅读这些内容）：

```
 ActionView::Template::Error: undefined method |' for "Ruby on Rails Tutorial Sample App":String # 
```

这说明 ActionView 模板系统在运行您的帮助程序时遇到了问题。具体来说，它说你试图调用一个名为“|”的未定义方法 （方法的名称是管道字符）在 String 类的对象上。

如果您查看 String 类的文档，[在这里](http://www.ruby-doc.org/core-1.9.3/String.html)，您会看到方法 '|' 不在可用方法列表中。

我的*猜测*是您正试图将它们连接在一起并包含管道字符，例如面包屑。在这种情况下，您只需将整行括在引号中，如下所示：

```
 "#{base_title} | #{page_title}" 
```

祝你好运！

# javascript - 在javascript中维护变量外部函数的值？

> ID：10906085
> 
> 赞同：0
> 
> 时间：2012-06-05T22:47:56.000
> 
> 标签：javascript

我尝试在函数内操作变量。但是一旦我退出函数，它似乎忘记了这些值，即使变量是在函数之外声明的。

基本代码：

```
var posts = {};                

            // Perform a data request
            // skjutsgruppens-page
            $.oajax({
                url: "https://graph.facebook.com/197214710347172/feed?limit=500",
                    *SNIP*
                    success: function(data) {
                    $.extend(posts, data);
                }
            });

            // Gruppen
            $.oajax({
                url: "https://graph.facebook.com/2388163605/feed?limit=500",
                *snip*
                success: function(data) {
                    $.extend(posts, data);
                }
            }); 
```

oajax 从 facebook 检索数据。我想创建一个包含两种 oajax 方法的数据的变量。

实际代码：[http ://eco.nolgren.se/demo/resihop/#](http://eco.nolgren.se/demo/resihop/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T22:51:32.820

问题很可能是该`success`函数在未来的任意时间执行——除非您在*知道*该函数已执行`posts`后专门访问，否则您将收到未定义的结果，完全取决于函数和访问时间。*`success`*

 *最好的方法是通过在success函数内部做必要的工作来正确处理这个问题，或者使用像jQuery的[`.when`function](http://api.jquery.com/jQuery.when/)这样的东西。*

# asp.net - Sitecore 多站点设置..主机名

> ID：10906092
> 
> 赞同：1
> 
> 时间：2012-06-05T22:48:23.523
> 
> 标签：asp.net, content-management-system, sitecore

因此，我尝试在 sitecore 中进行设置，以处理使用两个不同主机头设置的多站点。但无论我做什么，它总是会恢复为带有任一主机标头的默认站点。

所以目前我的默认设置在我的网络配置中，如下所示：

```
<site name="website" virtualFolder="/" physicalFolder="/" rootPath="/sitecore/content" startItem="/Home Page" database="web" domain="extranet" allowDebug="true" cacheHtml="true" htmlCacheSize="10MB" registryCacheSize="0" viewStateCacheSize="0" xslCacheSize="5MB" filteredItemsCacheSize="2MB" enablePreview="true" enableWebEdit="true" enableDebugger="true" disableClientData="false" hostname="localhost" loginPage="/Account/SourceLoginRouter" /> 
```

然后我要添加的新

```
<site name="SmartEmea" hostName="secondSite" virtualFolder="/" physicalFolder="/" rootPath="/sitecore/content/SmartEmea" startItem="/Home" database="master" domain="extranet" allowDebug="true" cacheHtml="true" htmlCacheSize="10MB" enablePreview="true" enableWebEdit="true" enableDebugger="true" disableClientData="false" language="nl-NL" customLinkManager="ValtechLinkManager"/> 
```

我的主机文件如下

```
127.0.0.1       localhost
127.0.0.1       secondSite 
```

但无论如何它总是恢复到网站`rootpath`及其`/sitecore/content`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T01:10:34.560

您必须确保“网站”`<site ... />`节点是所有已配置站点的最后一个。这个“网站”节点充当了一个包罗万象的角色。当请求进入时，它会沿着`<site ... />`节点向下并与每个节点匹配，`hostName`直到找到要运行的站点。如果您首先拥有“网站”，它就会运行，因为它可以捕获任何主机。

例如

```
<site name="SmartEmea" hostName="secondSite" virtualFolder="/" physicalFolder="/" rootPath="/sitecore/content/SmartEmea" startItem="/Home" database="master" domain="extranet" allowDebug="true" cacheHtml="true" htmlCacheSize="10MB" enablePreview="true" enableWebEdit="true" enableDebugger="true" disableClientData="false" language="nl-NL" customLinkManager="ValtechLinkManager"/>
<site name="website" virtualFolder="/" physicalFolder="/" rootPath="/sitecore/content" startItem="/Home Page" database="web" domain="extranet" allowDebug="true" cacheHtml="true" htmlCacheSize="10MB" registryCacheSize="0" viewStateCacheSize="0" xslCacheSize="5MB" filteredItemsCacheSize="2MB" enablePreview="true" enableWebEdit="true" enableDebugger="true" disableClientData="false" hostname="localhost" loginPage="/Account/SourceLoginRouter" /> 
```

# android - 无法检测设备兼容性。请选择目标设备

> ID：10906097
> 
> 赞同：4
> 
> 时间：2012-06-05T22:48:40.040
> 
> 标签：android, sdk, emulation

我正在尝试运行 Google Calendar API 的示例 Android 应用程序。Eclipse 告诉我 SDK 模拟器与我的代码不兼容，但它对我运行相同版本 Android 的真实设备感到满意。我可能在这里遗漏了一些明显的东西，但无法弄清楚是什么。

提前感谢您的帮助

![在此处输入图像描述](../Images/258e35e66c20a6013dee88a4ca227365.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-05T22:50:17.673

您缺少的显而易见的事情是您需要`Google APIs 2.3.3`版本，而不是`Android 2.3.3`版本，因为后者不包含*Google*组件，例如*Google Calendar API*。

# jquery - 高级 Jquery 动画

> ID：10906106
> 
> 赞同：-1
> 
> 时间：2012-06-05T22:49:57.940
> 
> 标签：jquery, css

只是想知道是否可以在 jquery 中创建类似这个动画的东西？

[http://www.a-cero.com/](http://www.a-cero.com/)

到目前为止，这是我想出的：http: [//jsfiddle.net/FvBqA/326/](http://jsfiddle.net/FvBqA/326/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T22:53:52.117

从您对自己问题的评论来看，我最初的答案似乎不是您想要的。您也许可以尝试将 jQuery 的众多反射插件之一与`.slideDown()`? 这里有一些东西可以帮助你开始：

**HTML：**

```
<div id="slidebottom" class="slide">
  <button>slide it</button>
  <div class="inner">Slide from bottom</div>
</div> 
```

**CSS：**

```
.slide {
  position: relative;
}
.slide .inner {
  position: absolute;
  left: 0;
  bottom: 0;
} 
```

**JavaScript：**

```
$(document).ready(function() {
  $('#slidebottom button').click(function() {
    $(this).next().slideToggle();
  });
}); 
```

*来源： http: [//www.learningjquery.com/2009/02/slide-elements-in-different-directions](http://www.learningjquery.com/2009/02/slide-elements-in-different-directions)*

**许多反射插件（来自谷歌）：**

*   [http://www.jwf.us/projects/jQReflect/](http://www.jwf.us/projects/jQReflect/)
*   [http://www.digitalia.be/software/reflectionjs-for-jquery](http://www.digitalia.be/software/reflectionjs-for-jquery)
*   [http://docs.jquery.com/Plugins:reflect](http://docs.jquery.com/Plugins:reflect)
*   [http://cow.neondragon.net/stuff/reflection/](http://cow.neondragon.net/stuff/reflection/)

**指引！**

*   [http://davidwalsh.name/javascrip-reflection](http://davidwalsh.name/javascrip-reflection)

# jquery - jQuery Accordian 完全忽略了我在 javascript 调用中所做的任何设置

> ID：10906111
> 
> 赞同：0
> 
> 时间：2012-06-05T22:51:06.970
> 
> 标签：jquery, accordion, jquery-ui-accordion

我最近在我的网站上添加了一个 Accordian 以便于查看和管理内容，但是它没有运行，您最初会怀疑，首先它完全忽略了我在 javascript 调用中所做的任何设置，例如，如果我将**autoheight**更改为**true或 false**，绝对没有明显的变化。

```
<div id="accordion">
<h3><a href="#">Accordion Header #1</a></h3>
<div>
Lots of content here which would belong to the accordion menu selected, this would be much larger than the other two contents.
</div>

<h3><a href="#">Accordion Header #2</a></h3>
<div>
Not as much as #1, therefore the height is reduced to support that without leaving a huge gap
</div>

<h3><a href="#">Accordion Header #3</a></h3>
<div>
Only about a line of writing, don;t want the huge gap
</div>

</div> 
```

可悲的是，无论我做什么手风琴都绝对没有响应，我不希望较小的内容有巨大的差距，我知道可以删除这些，因为它们看起来非常非常难看。但是，如前所述，我的脚本只是没有响应。

我在文档的标题中有这个：

```
<script>
  $(document).ready(function() {
    $( "#accordian" ).accordion({ clearStyle: true, autoHeight: false });
  });
  </script> 
```

非常感谢您花时间尝试解决此问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T22:54:27.057

你有`<div id="accordion">`，但你打电话`$( "#accordian" )`。

# javascript - 阻止使用 JavaScript / 其他方法访问页面？

> ID：10906112
> 
> 赞同：4
> 
> 时间：2012-06-05T22:51:09.093
> 
> 标签：javascript, jquery, ip-address, tumblr, privacy

## 一些背景

我有一个tumblog。

我还有一个*疯狂*的前女友。

该人一直在痴迷地访问我的帖子，考虑到我们关系的性质（或缺乏关系），我发现这相当令人不安。我的目标是阻止访问她或任何可能成为她/她的朋友/家人的人，而无需更改我已建立的 URL。

## 进攻计划

由于我不在第三方主机上托管我的博客，因此我几乎无法使用有助于阻止她访问的工具。但是，如果有需要的解决方案，我会自己托管。我不是专家，据我所知，JavaScript 是唯一可以让她相信她无法访问我的页面的方法，至少可以欺骗她。

我已经编写了一个脚本，***非常***感谢一些指导。使用 jQuery 和 jQuery Cookie 插件，我想出了一些代码来展示我的目标。***让我们开始吧。***

```
var ips = "{text:Ips}"; // String generated by tumblr: IP addresses separated by a space
var towns = "{text:Towns}"; // Same but with towns

var iparray = ips.split(" ");
var townarray = towns.split(" ");

$.getJSON("http://www.geoplugin.net/json.gp?jsoncallback=?",
    function(data){ // JSON request that returns geolocation data
        for(i = 0; i < townarray.length; i++){
            if (data['geoplugin_city'] == townarray[i]) // Test to see if user is accessing from a blacklisted town
            {
                if ($.cookie('banned_ip_tumblr')) // Looks for evidence of tracking cookie, if found: we stop loading, hide any content that was rendered, and send the user back up to 3 pages. 
                {
                    window.stop();
                    $('#all').hide(); // Div that wraps all content in body
                    history.go(-3);
                    history.go(-2);
                    history.go(-1);
                }
                else // Sets a cookie destined to be stale. Really stale. Then proceed with hiding posts
                {
                    $.cookie('banned_ip_tumblr', 'true', { expires: 365, path: '/' });
                    $('#all').hide();
                    history.go(-3);
                    history.go(-2);
                    history.go(-1);
                    window.stop();
                }        
            }
        }
        for(i = 0; i < iparray.length; i++){
            if (data['geoplugin_request'] == iparray[i]) // Same as above, IP style.
            {
                if ($.cookie('banned_ip_tumblr'))
                {
                    window.stop();
                    $('#all').hide();
                    history.go(-3);
                    history.go(-2);
                    history.go(-1);
                }
                else
                {
                    $.cookie('banned_ip_tumblr', 'true', { expires: 365, path: '/' });
                    window.stop();
                    $('#all').hide();
                    history.go(-3);
                    history.go(-2);
                    history.go(-1);
                }
            }
        }
    }
);

if ($.cookie('banned_ip_tumblr')) // If the user has been caught but is now connecting from a new host, there is a chance this will catch them
{
    window.stop();
    $('#all').hide();
    history.go(-3);
    history.go(-2);
    history.go(-1);
} 
```

## 已知的故障点

*   如果用户禁用了 JS，或者正在使用插件过滤 JS，这将失败。
*   如果用户在移动设备上（使用 iPod touch 测试），这将失败。
*   如果用户使用 Internet Explorer，这将失败。
*   如果用户使用网络代理，这将失败。

## 结束的想法

这不是我基于 IP / 地理位置阻止访问的理想方法，但是，这是我目前所知的最好的方法。我所处的情况让我感到不安，但我也认为这是一个机会，可以探索一些不太常见的方法来阻止用户访问。我很高兴听到没有 JS 的任何可能的解决方案，以及那些没有 JS 的解决方案。

***请指出我的错误***（因为我确信有很多），因为它们体现在我的代码和/或概念中。我想养成写代码的习惯。

这是我在 Stack 的第一篇文章，尽管我在整理项目时多次使用这个社区。感谢您花一些时间阅读并考虑我的问题，我期待得到一些意见。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T23:16:55.103

自己托管不会有什么不同。事实上，我很确定你不能，你需要将域指向他们的服务器。

我会说你所拥有的就是最好的。就像您提到的那样，有一些方法可以解决它，但这是客户端脚本的典型特征。

除非 tumblr 有一个变量用于查看您网站的人的登录，否则没有什么可做的。即使这样，他们也可以退出。

我建议在您的 tumblr 设置中阻止它们，考虑使用密码保护您的博客，或更改您的网址（您仍将保留您的关注者）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T05:46:24.360

你没有列出的三个重要的失败点：

*   [/档案](http://staff.tumblr.com/archive)
*   [/移动的](http://staff.tumblr.com/mobile)
*   [/api/read](http://staff.tumblr.com/api/read)
    （认为他们无法转到第 2 页？[/api/read?start=50](http://staff.tumblr.com/api/read?start=0)怎么样？）

您列出的无效故障点：

*   移动设备。（除非您在谈论 /mobile，在这种情况下，我的错。）您可以通过将移动主题粘贴到 /iphone-theme 的自定义布局页面来自定义移动设备的主题，或者您可以通过取消选中它来完全禁用它盒子：
    ![](../Images/d59c52b90709eac4adcb078bd1183142.png)

# c# - Expression Blend 未在样式设计器中显示附加属性

> ID：10906113
> 
> 赞同：1
> 
> 时间：2012-06-05T22:51:13.150
> 
> 标签：c#, wpf, expression-blend, blend, expression-blend-4

我在 clr 类型上声明了一个附加的依赖属性`Framework`：

```
public static readonly DependencyProperty ShowTypeProperty =
    DependencyProperty.RegisterAttached("ShowType", typeof(ShowType), typeof(Framework),
        new PropertyMetadata(ShowType.Normal));

/// <summary>
/// Gets the ShowType property. 
/// </summary>
[AttachedPropertyBrowsableForType(typeof(Window))]
public static ShowType GetShowType(Window w)
{
    return (ShowType)w.GetValue(ShowTypeProperty);
}

/// <summary>
/// Sets the ShowType property. 
/// </summary>
public static void SetShowType(Window w, ShowType value)
{
    w.SetValue(ShowTypeProperty, value);
} 
```

该属性在编辑 a 时显示在设计器属性列表中，但在编辑设置为`Window`的 Syle 时不显示。有谁知道，这是 Blend 中附加属性和样式设置器的“预期”行为吗？该属性可以在 xaml 中的 Setter 中手动设置，所以这只是一种方便，但我仍然想知道是否有人有解决方案，或者只是澄清这种行为。`TargetType``Window`

# css - 媒体查询中的 LESS CSS 设置变量？

> ID：10906114
> 
> 赞同：46
> 
> 时间：2012-06-05T22:51:17.517
> 
> 标签：css, less, media-queries, retina-display

我正在开发一个特定于 iPad 的网站。为了使我的网站同时在视网膜显示屏 iPad 和旧版本的 iPad 上运行，我想在媒体查询中的 LESS CSS 中设置一个变量，例如：

```
@media all and (max-width: 768px) {
    @ratio: 1;
}

@media all and (min-width: 769px) {
    @ratio: 2;  
} 
```

因此，当您以像素为单位设置任何内容时，您可以这样做

```
width: 100px * @ratio; 
```

但是我得到一个编译错误，说@ratio 没有定义。是否有可能有一种解决方法使其工作？谢谢。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-06-05T23:00:14.637

这会很好，但这样做是不可能的。

LESS 将您的媒体查询编译为实际的媒体查询，因此在编译时没有指示哪个媒体查询与浏览器相关。

在编译时间之后，你只有 CSS 不少，所以你不能再有变量了。

你可以这样做，但它不是那么优雅：

```
@base_width: 100px;

@media all and (max-width: 768px) {
    .something {
        width: @base_width;
    }
}

@media all and (min-width: 769px) {
    .something {
        width: @base_width * 2;
    }
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2017-01-11T07:37:48.213

我知道我的答案迟到了，但有人可能会觉得这很有用。

您可以将样式移动到单独的文件中

```
// styles.less
.foo {
  width: 100px * @ratio;
} 
```

然后在更改变量值后多次导入文件

```
// main.less
@ratio: 1; // initial value

@media all and (max-width: 768px) {
  @ratio: 1;
  @import (multiple) "styles";
}

@media all and (min-width: 769px) {
  @ratio: 2;
  @import (multiple) "styles";
} 
```

**请注意，（多个）在这里很重要**

编译后的代码将如下所示

```
// main.css
@media all and (max-width: 768px) {
  .foo {
    width: 100px;
  }
}
@media all and (min-width: 769px) {
  .foo {
    width: 200px;
  }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-11-15T10:21:33.110

对于那些可能只允许支持相对现代的浏览器（Chrome 49+、FF 31+、无 IE）的人，您可以使用[css 变量](https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_variables)来代替。

[这是](https://caniuse.com/#feat=css-variables)“我可以使用”中的浏览器支持表。

```
html {
    --width-var: 300px;

    @media only screen and (max-width: 750px) {
        --width-var: 200px;
   }
}

.your-class {
    max-width: calc( var(--width-var) * 2 );
    .... // tons of other props
} 
```

使用上面的代码，每当屏幕小于 750 像素时，都会重新计算`max-width`属性 from `.your-class`（因为`--width-var`已更改），当然当屏幕大小调整为更大时 - css 变量会恢复到其原始值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-15T21:49:39.093

这有点骇人听闻，但一个可能的解决方案是设置包装元素的字体大小并将所有单位设置为`em`：

**HTML：**

```
<div id="wrap">
    <div class="child1"></div>
    <div class="child2"></div>
</div> 
```

**较少的：**

```
#wrap 
    {
    font-size: 100px;
    width: 10em; // = 1000px;
    @media all and (max-width: 768px)
        {
        font-size: 60px;
        }
    .child1
        {
        width: 5em; // 500px normally, 300px on small screens
        }
    .child1
        {
        width: 2.5em; // 250px normally, 150px on small screens
        }
    } 
```

如果您有包含文本和子项的元素，那当然不起作用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-07-02T09:58:34.227

LESS 目前无法做到这一点，尽管它在技术上是可行的。此功能已在题为“[媒体查询中的较少变量](https://github.com/less/less.js/issues/2205)”的 GitHub 问题中提出请求。

另请参阅此问题：[CSS pre-processor with a possible to define variables in a @media query](https://stackoverflow.com/q/14139067/247696)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-07-15T16:47:26.343

我有一个 LESS 变量，我在任何地方都在使用，包括在计算中。对我来说，该变量必须灵活并根据屏幕宽度进行更改，否则所有计算都必须重复，要么使用不同的变量，要么进行不同的计算。

这就是我所做的，现在同一个变量在任何地方都可以正常工作。

它在 CSS 中设置变量，并在 javascript 添加条件类时更改它。LESS 变量调用 CSS 变量。

IE 11 不支持，所以要小心。

```
/* CSS var sets the width for normal screen size */
:root {
  --side-nav-width: 252px;
}

/* change the CSS var under conditions
   I think it would work in a media query but didn't test */
.side-nav-closed {
  --side-nav-width: 72px;
}

/* The LESS var correctly invokes whichever width applies */
@side-nav-width: var(--side-nav-width); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-09-30T17:00:01.917

我发现接受的解决方案不起作用，因为编译器会抱怨没有定义 mixin。另一种解决方案：

```
@base_width: 100px;

.mixin {
    width: @base_width;

    @media all and (min-width: 769px) {
        width: @base_width * 2;
    }
} 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2014-12-03T18:09:09.567

我们可以用更少的变量来定义媒体查询的变量。
首先检测 iPad 分辨率：

```
@iPad: ~"only screen and (min-width: 40.063em) and (max-width: 64em); 
```

这些 em 相当于 641px 和 1024px。

现在检测高分辨率：

```
@highResolution: ~"only screen and (-webkit-min-device-pixel-ratio: 1.5)",
          ~"only screen and (min--moz-device-pixel-ratio: 1.5)",
          ~"only screen and (-o-min-device-pixel-ratio: 3/2)",
          ~"only screen and (min-device-pixel-ratio: 1.5)"; 
```

现在我们可以在媒体查询中组合这两个变量，如下所示：

```
@media @iPad, @highResolution{ .yourCssClass{} } 
```

这仅在具有视网膜显示（或类似像素密度）的 iPad（或类似分辨率）上有效。

# javascript - Javascript鼠标悬停按钮 - 链接不起作用 , 图像在

> ID：10906128
> 
> 赞同：0
> 
> 时间：2012-06-05T22:52:32.697
> 
> 标签：javascript, html, css, image, button

我是一名初学者，试图通过编写自己的商业网站来糊弄自己。我有一个页面，其中包含许多使用 javascript 翻转效果编码的按钮。我已将[页面临时上传](http://redravenwoodwork.com.au/temp/table_test_gazillion.html)到我的域，以便您可以看到我在说什么。

以下是我获得翻转脚本的一些链接的地址以及有关将它们合并到网页中的一些信息：[http](http://www.javascript-fx.com/fade_rollovers/) ://www.javascript-fx.com/fade_rollovers/ & [http://www.javascript-fx.com /fade_rollovers/general_help/help.html](http://www.javascript-fx.com/fade_rollovers/general_help/help.html)

按钮工作得很好，但是当我把它们放在桌子上时，我一辈子都无法正确地调整表格单元格的高度。背景图像将平铺，并且在单元格底部可以看到重复的 4px 背景图像。

然后我尝试了 div，它们在图像/外观方面工作得很好，但现在链接不再起作用了：

```
 <div style="border: none; background-image: url('spiceracks_off.jpg'); width: 155px; height: 155px;>
            <a href="http://www.redravenwoodwork.com.au"
             onmouseover="JSFX.fadeIn('spiceracks')"
             onmouseout="JSFX.fadeOut('spiceracks')" border="0"><img
             style="border: 0px solid; width: 155px; height: 155px;"
             name="spiceracks" class="imgFader" src="spiceracks_off.jpg"></a></div> 
```

在此之前，它们或多或少都是一样的，只是在`td`标签中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T22:56:37.920

在 div 标签样式属性的末尾缺少关闭 "。我认为这将解决您的问题。

# objective-c - 无法将此代码段转换为 Objective C - ARC

> ID：10906138
> 
> 赞同：0
> 
> 时间：2012-06-05T22:53:55.923
> 
> 标签：objective-c, ios, automatic-ref-counting

当我想在这样的按钮中调用警报时，我有一个方便的类：

```
- (IBAction)test:(id)sender {
    [MyAlertView showWithTitle:@"test" withCallBackBlock:^(int value){
        NSLog(@"Button Pressed %i", value); 
    }];
} 
```

课程非常简单：

```
 @implementation MyAlertView
@synthesize callBackBlock = _callBackBlock, internalCallBackBlock = _internalCallBackBlock;

-(void)showWithTitle:(NSString *)title withCallBackBlock:(CallBackBlock )callBackBlock internalCallBackBlock:(CallBackBlock )internalCallBackBlock{
    self.callBackBlock = callBackBlock;
    self.internalCallBackBlock = internalCallBackBlock;

    dispatch_async(dispatch_get_main_queue(), ^{
        UIAlertView *alertView = [[UIAlertView alloc] initWithTitle:title message:title delegate:self cancelButtonTitle:@"Cancel" otherButtonTitles:@"OK" , nil];
        [alertView show];
        [alertView autorelease];
    });

}

- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex{
    if (_callBackBlock) {
        _callBackBlock(buttonIndex);
    }

    if (_internalCallBackBlock) {
        _internalCallBackBlock(buttonIndex);
    }
}

-(void)dealloc{
    Block_release(_callBackBlock);
    Block_release(_internalCallBackBlock);
    [super dealloc];
}

+(void)showWithTitle:(NSString *)title withCallBackBlock:(CallBackBlock )callBackBlock{
    __block MyAlertView *alert = [[MyAlertView alloc]init];
    [alert showWithTitle:title withCallBackBlock:callBackBlock internalCallBackBlock:^(int value){
        [alert autorelease];
    }];

}
@end 
```

我已经在模拟器上对其进行了分析，它显示没有泄漏，没有僵尸。现在，当我更改为 ARC 时，每次单击测试按钮时程序都会崩溃，即使我将所有内容都视为强大。我猜那是因为我没有持有 alertView 变量。

怎么能用 ARC 做这样的便利课？

附加 .h 文件：

```
#import <Foundation/Foundation.h>

typedef void(^CallBackBlock)(int value);

@interface MyAlertView : NSObject<UIAlertViewDelegate>

@property (copy) CallBackBlock callBackBlock, internalCallBackBlock;

+(void)showWithTitle:(NSString *)title withCallBackBlock:(CallBackBlock )callBackBlock;
@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T23:11:46.647

你是对的：问题是`UIAlertView`创建的 in `showWithTitle:withCallBackBlock:internalCallBackBlock:internalCallBackBlock`没有被保留。

诀窍是将 is 存储在`MyAlertView`. 因此，在`MyAlertView.m`中添加以下内容：

```
@interface MyAlertView()
    @property(strong) UIAlertView *alertView;
@end

@implementation MyAlertView

@synthesize alertView;

... 
```

并使用它来存储`UIAlertView`您创建的内容`showWithTitle:withCallBackBlock:internalCallBackBlock:internalCallBackBlock`：

```
dispatch_async(dispatch_get_main_queue(), ^{
    self.alertView = [[UIAlertView alloc] initWithTitle:title message:title delegate:self cancelButtonTitle:@"Cancel" otherButtonTitles:@"OK" , nil];
    [self.alertView show];
}); 
```

PS 这真的很迂腐，但`MyAlertView`实际上并不是一个视图，所以你可能想要重命名它。

# iphone - 关闭 iPhone/iPod 音乐后玩家返回游戏时游戏音乐不继续播放

> ID：10906141
> 
> 赞同：1
> 
> 时间：2012-06-05T22:54:17.470
> 
> 标签：iphone, cocos2d-iphone, background-music

我希望能够让玩家在玩游戏的同时聆听他们的 iPod/iPhone 音乐。

我使用以下内容来启用它：

```
-(void)applicationWillResignActive:(UIApplication *)application 
{
    [[CCDirector sharedDirector] pause];
    [[CDAudioManager sharedManager] setResignBehavior:kAMRBStopPlay autoHandle:YES];
} 
```

这会暂停背景音乐并允许播放音效。到目前为止工作完美。

但问题是，当用户退出游戏，停止播放 iPod/iPhone 音乐并返回游戏时，背景音乐不会恢复。谁能帮我这个。我希望音乐能够在 iPod/iPhone 音乐关闭时恢复。

我使用 SimpleAudioEngine 播放背景音乐。我使用 CDAudioManager 播放音效。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T05:45:29.793

您很可能需要实施

```
- (void)applicationDidBecomeActive:(UIApplication *)application 
```

与

```
[[CDAudioManager sharedManager] resumeBackgroundMusic]; 
```

或者

```
playBackgroundMusic 
```

原因是当你确实设置了音乐在后台播放时，它是一个共享管理器，用户直接进入 iPod 界面并按下停止。

# c# - DateTimeOffset 到 DateTime 的转换 - 数据丢失

> ID：10906142
> 
> 赞同：6
> 
> 时间：2012-06-05T22:54:22.133
> 
> 标签：c#, .net

当我将 datetimeoffset 值转换为 datetime 值时，是否有可能丢失数据。从 MSDN 文档中，提到了从 datetimeoffset 到 datetime 的转换，如下所示：

> DateTime 属性最常用于执行 DateTimeOffset 到 DateTime 的转换。但是，它返回一个 DateTime 值，其 Kind 属性是未指定的。这意味着在使用 DateTime 属性时，任何有关 DateTimeOffset 值与 UTC 关系的信息都会因转换而丢失。

要指示转换后的 DateTime 值是 UTC 时间，您可以检索 DateTimeOffset.UtcDateTime 属性的值。它在两个方面与 DateTime 属性不同：

它返回一个 DateTime 值，其 Kind 属性为 Utc。如果 Offset 属性值不等于 TimeSpan.Zero，它会将时间转换为 UTC。

我看到以下将日期时间偏移量转换为日期时间的方法：

```
static DateTime ConvertFromDateTimeOffset(DateTimeOffset dateTime)
{
   if (dateTime.Offset.Equals(TimeSpan.Zero))
      return dateTime.UtcDateTime;
   else if (dateTime.Offset.Equals(TimeZoneInfo.Local.GetUtcOffset(dateTime.DateTime)))
      return DateTime.SpecifyKind(dateTime.DateTime, DateTimeKind.Local);
   else
      return dateTime.DateTime;   
} 
```

现在在我们的系统中，我们以上述方式将 datetimeoffset 转换为 datetime。稍后我们要将日期时间转换回日期时间偏移量。

举个例子：

```
DateTime dt = ConvertFromDateTimeOffset(datetimeOffset);
DateTimeOffset dofsetnew = new DateTimeOffset(dt); 
```

我的问题是在任何情况下 datetimeOffset 和 dofsetnew 是否不同？如果是这样，那么转换将是丢失数据。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T05:18:34.027

它的编写方式 - 是的，只要输入 DateTimeOffset 处于 UTC 偏移量，该偏移量是 0 和您的本地时区（最后一个“其他”条件）以外的任何值。恕我直言，您最好始终使用 UtcDateTime，假设其中涉及的潜在时区转换是可以接受的。

此外，如果您当地的时区遵守 DST，那么在每年模棱两可的时间里都会有损失，因为您不知道它代表哪一个。

如果您需要确保没有丢失，请不要转换为 DateTime 并保留 DateTimeOffset （sql server type 'datetimeoffset'），或者如果必须，请将 UTC 偏移量保留为一个单独的值，并与它一起传递，这样您然后可以使用 2 个值（日期时间和偏移量）重建 DateTimeOffset。

# database-design - 如何在 SQL 中设计模式关系到 mongoDB？

> ID：10906147
> 
> 赞同：0
> 
> 时间：2012-06-05T22:55:06.910
> 
> 标签：database-design, mongodb, schema

阅读 mongoDB The Definitive Guide 和这个链接[http://www.mongodb.org/display/DOCS/Schema+Design](http://www.mongodb.org/display/DOCS/Schema+Design)后我仍然感到困惑，这 是 mongodb 设计模式数据库的标准。我在 MySQL 数据库中有如下架构 ![SQL 数据库设计](../Images/46ae7a1311270e2d9f359359429f7458.png)

我上面的数据库是固定的，仅适用于 DDL。请帮助我展示将上述模式关系设计到 mongoDB 的步骤。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:59:14.930

更容易想到 Mongo 是一个文档存储系统。从快速查看您的架构......所有这些都应该进入主表中每个命名事物的文档中。

但是，这在很大程度上取决于您如何使用它。

但是，为了清楚起见，关系模型和文档模型之间没有直接的转换。

# java - 在 JSF 中，被调用的 EJB 抛出的自定义异常被视为 EJBTransactionRolledBackException 或 NullPointerException 或 ServletException

> ID：10906155
> 
> 赞同：2
> 
> 时间：2012-06-05T22:55:53.863
> 
> 标签：java, jsf-2, exception-handling, ejb, custom-exceptions

这就是问题所在：EJB 抛出了这个异常（来自 glassfish 日志）：

```
SEVERE: Attempting to confirm previously confirmed login using confirmation UUID: b90b33ca-dc69-41c1-9c60-99152810c89b
com.extremelatitudesoftware.els_commons.exceptions.LoginPreviouslyConfirmedException: Attempting to confirm previously confirmed login using confirmation UUID: b90b33ca-dc69-41c1-9c60-99152810c89b
    at com.extremelatitudesoftware.security.auth.CredentialsController.checkForPreviousConfirmation(CredentialsController.java:244) 
```

在异常堆栈的客户端（在底部）我看到了这个：

```
WARNING: StandardWrapperValve[Faces Servlet]: PWC1406: Servlet.service() for servlet Faces Servlet threw exception
java.lang.NullPointerException
    at com.extremelatitudesoftware.accesscontrol.registration.RegistrationConfirmationBean.setChallengeQuestion(RegistrationConfirmationBean.java:61)
    at com.extremelatitudesoftware.accesscontrol.registration.RegistrationConfirmationBean.fetchChallengeResponse(RegistrationConfirmationBean.java:51) 
```

当然，在浏览器中，我得到一个通用的 500 异常错误，表示存在空指针异常。

我想要一个自定义错误页面来检测“com.extremelatitudesoftware.els_commons.exceptions.LoginPreviousConfirmedException”并说“哎呀，你已经确认了！”

有人可以为我指出正确的方向，让客户端/JSF 层正确地“看到”异常，以便可以做到这一点。

*这是问题的用例：*
我在 EJB 层中有一个方法，用于检查用户之前是否确认了他们的登录帐户。如果他们没有，它会处理他们确认新帐户的请求。如果他们说回到旧电子邮件并说，嗯，让我们再次单击它，后端将检测到，抛出异常以使其被 JSF/客户端层拾取并通知用户该帐户已被确认。

* * *

添加示例代码：

方法检查条件并在必要时抛出异常。请注意，大多数情况下这不会发生，所以我想使用这种机制，而不是在*每次*有人确认他们的帐户时都拨打不必要的电话。

```
...
private void checkForPreviousConfirmation(Credentials cr) 
                                    throws LoginPreviouslyConfirmedException {

    if (!(CredentialsStatusType.PENDING.equals(cr.getStatus()))
         || !(CredentialsDispositionType.WAITING.equals(cr.getDisposition()))) {
      String msg = "Attempting to confirm previously confirmed login using "
              + "confirmation UUID: " + cr.getConfirmationUuid();
      Logger.getLogger(CredentialsController.class.getName()).log(Level.INFO,
              msg);
      throw new LoginPreviouslyConfirmedException(msg);
    }
  } 
```

自定义异常：

```
public class LoginPreviouslyConfirmedException extends RuntimeException {

    public LoginPreviouslyConfirmedException(String msg, Throwable cause) {
        super(msg, cause);
    }

    public LoginPreviouslyConfirmedException(String msg) {
        super(msg);
    }
} 
```

这是在 JSF 层的 ManagedBean 中。它通过以下方式调用：preRenderView

```
 ...
public void fetchChallengeResponse() {
    try {
         crespList = regFacade.fetchChallengeResponse(confirmUuid);
    } catch (LoginPreviouslyConfirmedException ex) {
         String msg = "Attempting to confirm previously confirmed login using " + "confirmation UUID: " + getConfirmUuid();
         Logger.getLogger(RegistrationConfirmationBean.class.getName()).log(Level.SEVERE, msg, ex);
          FacesContext facesContext = FacesContext.getCurrentInstance();
          Application application = facesContext.getApplication();
          NavigationHandler navigationHandler = application.getNavigationHandler();
          navigationHandler.handleNavigation(facesContext, null, "faces/errorpages/already_confirmed.xhtml");
          facesContext.renderResponse();
        }catch (Exception ex){
          String msg = "Including this to see if the previously confirmed exception was skipped over";
              Logger.getLogger(RegistrationConfirmationBean.class.getName()).log(Level.SEVERE, msg, ex);
        }

        this.setChallengeQuestion();
      } 
```

这是日志显示的内容：

```
INFO: Attempting to confirm previously confirmed login using confirmation UUID: b90b33ca-dc69-41c1-9c60-99152810c89b
WARNING: EJB5184:A system exception occurred during an invocation on EJB CredentialsController, method: public java.util.ArrayList com.extremelatitudesoftware.security.auth.CredentialsController.fetchChallengeResponseByCredentialUuid(java.lang.String) throws com.extremelatitudesoftware.els_commons.exceptions.LoginPreviouslyConfirmedException
WARNING: javax.ejb.TransactionRolledbackLocalException: Exception thrown from bean 
```

然后有几个追踪：

```
SEVERE: Including this to see if the previously confirmed exception was skipped over
javax.ejb.EJBTransactionRolledbackException 
```

* * *

根据 BalusC 的建议，我将 ManagedBean 中的代码更改为：

```
public void fetchChallengeResponse() throws LoginPreviouslyConfirmedException{
     crespList = regFacade.fetchChallengeResponse(confirmUuid);
     this.setChallengeQuestion();
  } 
```

这是在 web.xml

```
<error-page>
    <exception-type>com.extremelatitudesoftware.els_commons.exceptions.LoginPreviouslyConfirmedException</exception-type>
    <location>/errorpages/already_confirmed.xhtml</location>
</error-page> 
```

![但我仍然得到这个（这是显示的错误页面的图像）。](../Images/9aa5f948e2c6baf57969b55e52d940da.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T03:09:48.073

这是我今天通过研究找到的最简单最好的答案：使用 @ApplicationException(rollback=true) 注释装饰自定义异常。

例如

```
@ApplicationException(rollback=true)
public class LoginPreviouslyConfirmedException extends Exception {... 
```

根本问题是，在将异常传递给客户端之前，EJB 容器至少将一些异常包装在“EJBTransactionRolledBackException”包装器中。我不确定，但它似乎类似于 JSF 想要将异常包装在“ServletException”中的方式，以处理那里引发的任何事情。在我看来，隐藏真正的应用程序错误是非常有缺陷的。在任何情况下，它都会阻止客户端“看到”您可能抛出的任何类型的特殊情况异常，原因是您或您的用户可以在不中止整个操作的情况下进行更正。也就是说，它将看到的只是用于包装大量异常的 EJBTransactionRolledBackException。这样做会导致无法轻松调试或处理异常。幸运的是，在最新一期的 JEE 中，它们包含了 @ApplicationException 注释来抵消这种行为。虽然我不明白为什么他们不完全停止包装异常。

在任何情况下，@ApplicationException(rollback=true) 告诉服务器不要将异常包装在 EJBTransactionRolledBackException 中并将其按原样传递回客户端。这允许客户端查看真正的异常是什么，以便它有机会优雅地处理它。指定“rollback=true”告诉服务器回滚当前事务。如果你不这样做，它默认为 false 并且只会将所有内容放在那里。以任何状态结束这一切。

如果自定义异常继承自 Exception，并且 EJB 会话 bean 中的方法抛出它，那么在 JSF ManagedBean 中进行调用的方法也必须抛出它。如果它继承自 RuntimeException，则不会。

在任何情况下，异常都不会被 EJBTransactionRolledBackException 包装，因此当它返回到 JSF 层时，将调用 web.xml 中为自定义异常定义的异常页面。无需在托管 bean 中捕获异常。无需过滤。不需要特殊的导航规则。但是，如果您确实想抓住它，它可以被抓住。没有@ApplicationException，它就不会（因为它被包装了）。

在这里找到的信息（在其他地方）：
[http ://docs.oracle.com/javaee/5/api/javax/ejb/ApplicationException.html](http://docs.oracle.com/javaee/5/api/javax/ejb/ApplicationException.html)
[http://openejb.apache.org/examples-trunk/applicationexception/](http://openejb.apache.org/examples-trunk/applicationexception/)
[如何在会话 Bean 中使用自定义异常？](https://stackoverflow.com/questions/5217831/how-to-use-custom-exception-in-session-beans)

无论如何，这行得通。只是希望我能早点在 Google 上找到正确的搜索词。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T12:00:14.290

在引发异常的 EJB 方法中，声明`throws LoginPreviouslyConfirmedException`. 然后，在托管 bean 中，使用针对该异常的 try-catch 包围 EJB 调用。在 catch 块中；您可以将用户重定向到错误页面；或者只是向视图发送消息（在 h:messages、p:growl 等中呈现）。

# character-encoding - 当我使用 UTF-8 而不是 ISO-8859-1 时，jquery 的对话框停止工作

> ID：10906157
> 
> 赞同：0
> 
> 时间：2012-06-05T22:55:59.520
> 
> 标签：character-encoding, jquery-dialog

我一直在自己的网站上工作 - [http://rapcities.com](http://rapcities.com)（警告 - 歌曲自动播放）

我刚刚添加了网站所需的所有法律文本，发现出现了许多随机不需要的字符（例如 Â、â 和 ¨）。一些搜索使我将站点的字符编码更改为 UTF-8 - 即使我站点中的文本都没有使用非西方字符。

更改编码可以解决问题，但会带来更大的问题。每当我的网站以 UTF-8 字符编码显示时，Jquery 对话框就不再在我的网站上工作。

该对话框应在网站首次打开时自动出现（带有艺术家传记）。单击 DMCA/服务条款/隐私政策链接时应出现另一个对话框，单击站点右上角带有心形的篮子时应出现第三个对话框。

我对正在发生的事情感到非常困惑 - 无论是关于我原来的问题和新问题。有人有什么想法吗？

最好的，
萨米

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T23:05:24.073

`unterminated string literal`当我转到您的页面时，我在控制台中收到一条错误消息。它指向`showLegal(number)`函数中的 switch 语句。

我没有将一大堆 HTML 放在 JavaScript 字符串中，而是将它放在一个隐藏的`<div>`. 然后，您的 jQuery 对话框脚本可以引用 DOM 元素，而不是强迫您调试一个巨大的、讨厌的 HTML 字符串。

# eclipse - 部署基于 IMP 的 eclipse 插件

> ID：10906158
> 
> 赞同：1
> 
> 时间：2012-06-05T22:56:17.920
> 
> 标签：eclipse, plugins, eclipse-plugin, imp

我有一个用于我自己的 Eclipse 编程语言的插件。
该插件基于 IMP。通过“作为 Eclipse 应用程序运行”运行项目时，一切都按预期工作：我有该语言的 Eclipse 透视图，我可以编译/运行与我的语言相关的文件。我尝试将插件安装到干净的 Eclipse 安装中：
- 我为我的插件创建了一个功能项目
- 我已经创建了一个更新站点项目
- 我已经将我的功能、IMP 运行时和 LPG 运行时添加到我的更新站点
- 我已确保在更新站点中同步和构建所有内容。
- 我已经尝试在干净的 Eclipse 中“安装新软件” - 没有错误。

当我运行我的新 Eclipse 时，我看不到我的语言的视角。Eclipse 不会将我的文件与任何语言/透视图相关联。
请指教！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T03:42:12.530

我猜有某种错误导致您的插件无法运行。以下是您可以查看的一些内容：

1.  错误日志。窗口 -> 显示视图 -> 错误日志
2.  插件注册表视图。寻找你的插件并确保它可以被`start`编辑
3.  在启用 OSGi 控制台的情况下启动 Eclipse。您可以运行一些诊断命令来查看捆绑包启动时会发生什么（运行`eclipse -console`以在命令行上获取 OSGi 控制台）

# java - 如何使用 Hibernate 处理 Postgresql UUID

> ID：10906159
> 
> 赞同：1
> 
> 时间：2012-06-05T22:56:27.827
> 
> 标签：java, hibernate, jpa, uuid

我正在将 JPA (Hibernate) 添加到在 Postgresql 中使用 uuids 的项目中。uuid 是 Postgresql uuid 类型。

我已经按照[这些说明](https://stackoverflow.com/questions/4495233/postgresql-uuid-supported-by-hibernate/7479035#7479035)添加了 Hibernate 注释，如下所示：

```
@Column(name = "uid")
@Type(type="pg-uuid")
private UUID uid; 
```

Hibernate 据说在 Hibernate 3.6 中增加了对 Postgres UUID 的支持。我已经尝试过 Hibernate 3.6 和 4.0，但都抛出了下面的异常。

异常表明 Postgresql 驱动程序正在尝试将 uuid 转换为 long。我已经尝试过 9.0-801.jdbc4 和 9.1-901.jdbc4 Postgres 驱动程序。我需要获得不同的数据库驱动程序吗？

```
Caused by: org.postgresql.util.PSQLException: Bad value for type long : dbada1e4-a165-4601-b34e-d08428cd81df
    at org.postgresql.jdbc2.AbstractJdbc2ResultSet.toLong(AbstractJdbc2ResultSet.java:2796)
    at org.postgresql.jdbc2.AbstractJdbc2ResultSet.getLong(AbstractJdbc2ResultSet.java:2019)
    at org.postgresql.jdbc4.Jdbc4ResultSet.getBlob(Jdbc4ResultSet.java:52)
    at org.postgresql.jdbc2.AbstractJdbc2ResultSet.getBlob(AbstractJdbc2ResultSet.java:335)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.hibernate.engine.jdbc.internal.proxy.AbstractResultSetProxyHandler.continueInvocation(AbstractResultSetProxyHandler.java:104)
    ... 32 more 
```

# javascript - jQuery 更简单的方法来实现真正的上滑/下滑

> ID：10906163
> 
> 赞同：1
> 
> 时间：2012-06-05T22:56:55.590
> 
> 标签：javascript, jquery, animation

我正在尝试使用 jQuery 进行**真正的**滑动（因此元素实际上向上滑动），我想出了以下内容，我不确定它是否非常优化，你能找到改进它的方法吗？

小提琴：http: [//jsfiddle.net/gpuHG/1/](http://jsfiddle.net/gpuHG/1/)

这个想法是 .content 元素默认按它们的高度向上，因此它们离开页面或在标题后面，并且当单击菜单上的项目时，如果任何窗口打开，它们就会关闭，然后请求的项目向下滑动。对于如此简单的事情，我的解决方案似乎相当臃肿！

jQuery：

```
$.fn.exists = function() {
    return this.length !== 0;
}

$(".content").each(function() {
    $(this).hide().css({
        "margin-top": "-=" + $(this).outerHeight() + "px"
    });
});

$("#navigation ul li").each(function() {
    var relatedContent = $("#" + $(this).attr("title") + "-content");
    $(this).click(function() {
        if (!$(":animated").exists()) {
            if ($(".open").exists()) {
                $(".current").first().removeClass("current");
                $(this).addClass("current");
                var element = $(".open").first();
                element.removeClass("open").animate({
                    "margin-top": "-" + element.outerHeight() + "px"
                }, 500, function() {
                    $(this).hide();
                    relatedContent.show().addClass("open").animate({
                        "margin-top": "0px"
                    }, 500);
                });
            } else {
                $(this).addClass("current");
                relatedContent.show().addClass("open").animate({
                    "margin-top": "0px"
                }, 500);
            }
        }
    });
});​ 
```

谢谢你的时间，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T23:09:16.720

总的来说，你的代码很好，所以我没有改变太多。记得尽量缓存变量；DOM 访问是昂贵的。此外，为您的选择器提供上下文将提高​​性能。您可以对此进行更多调整，但这里有一些：

```
var $nav = $('#navigation');
$nav.find("ul li").click(function(){
    if($(':animated').length) { return; }
    var $this = $(this),
        relatedContent = $("#"+$this.attr("title")+"-content", $nav);
    if(!relatedContent.length) { return; }
    if($(".open", $nav).length) {
        $(".current", $nav).removeClass("current");
        $this.addClass("current");
        var element = $(".open", $nav).first();
        element.removeClass("open").animate({"margin-top": "-"+element.outerHeight()+"px"},
            500,
            function() {
                $(this).hide();
                relatedContent.show().addClass("open").animate({"margin-top": "0px"},500);
            });
    } else {
        $this.addClass("current");
        relatedContent.show().addClass("open").animate({"margin-top": "0px"},500); 
    }
});​ 
```

**编辑：** 我同意上面的评论：您的`$.fn.exists`功能非常方便，但使用`.length`比点击附加功能更短更快。如果你愿意，可以保留它，但我在我的代码中放弃了它。

# makefile - Makefile 目标永远不会满足

> ID：10906170
> 
> 赞同：0
> 
> 时间：2012-06-05T22:58:02.647
> 
> 标签：makefile, dependencies, target

我觉得这是一个相当普遍的问题，但在我的具体情况下我无法在任何地方找到答案。我有一个像这样的目标：

```
initfs.tar: $(INITFS_FILES)
    rm -f ./initfs.tar
    cd initfs_root
    tar --format ustar --exclude-vcs -cf ../initfs.tar ./ 
```

INITFS_FILES 定义：

```
INITFS_FILES:=$(shell find ./initfs_root/ -not -path '*/.*/*' -not -name '.*' -type f) 
```

每次我打电话时`make initfs.tar`，都会运行这个目标。initfs_root 目录中没有文件被触及（并且所有文件都使用该 find 命令找到）。initfs.tar 确实是创建的。

有谁知道为什么会这样？对我来说，这没有任何意义，根据我在互联网上遇到的所有其他帖子和我目前的专业知识，我的一切都是正确的（尽管很明显，我在 Makefile 领域缺乏专业知识；）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T23:40:39.523

make 中的每个命令都在每个命令行的新子 shell 中执行。这意味着命令

```
cd initfs_root
tar --format ustar --exclude-vcs -cf ../initfs.tar ./ 
```

在两个不同的子shell中执行。因此，该`tar`命令不会将该`initfs_root`目录作为其工作目录来执行。

您可以通过将两者组合成一个命令行来避免这种情况：

```
cd initfs_root; tar --format ustar --exclude-vcs -cf ../initfs.tar ./ 
```

顺便说一句，如果您尝试`tar`在其路径或名称中包含空格的任何文件，请小心。这些将在变量中拆分为多个名称，`$INITFS_FILES`您的机制将中断。

# ios - 当我重新安装应用程序时，对 xib 文件的新更改不会覆盖旧的，旧的仍然出现

> ID：10906172
> 
> 赞同：0
> 
> 时间：2012-06-05T22:58:21.647
> 
> 标签：ios

当我尝试更新现有应用程序的 xib 时，我遇到了这个问题。

我的应用程序是多语言的，并且使用`en_US`,`es_ES`和`pt_BR`. 当我从 xbi 更改标签、按钮、视图……，然后尝试重新安装（覆盖旧应用程序）该应用程序时，不会出现 xib 的新更改，旧数据视图仍然出现。

问题是，我能做些什么来解决这个问题，我是否必须指定一个标志`InfoPlist`或类似的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:00:05.400

回答我自己的问题并等待对某人有所帮助。

仅当我在 xib 文件中进行更改然后在模拟器上运行应用程序时才会出现问题，显然没有替换新的 xib 文件并且模拟器使用旧的 xib 文件。(xcode 4.3, iPad/iPhone 模拟器 4.3/5.0)

为了解决这个问题，每次我对 xib 文件进行更改时，删除应用程序并再次运行模拟器。当我分发应用程序时，我只需要重新安装，因为它会覆盖旧的 xib 文件，并且在我的情况下，文档目录中的数据库是安全的。我注意到这一点是因为当我分发应用程序时，一切正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T23:04:44.937

最简单的方法是从模拟器中删除应用程序（与手机相同）。这将删除所有旧文件并复制新文件。

您还可以从应用程序文件夹中删除文件目录`~/Library/Application Support/iPhone Simulator/[OS version]/Applications/[appGUID]/`，其中将包含一个文件夹，每个应用程序都有一个 UUID 名称（打开文件夹以查看哪个属于您的应用程序）。

# .net - 优化 Linq 查询

> ID：10906175
> 
> 赞同：0
> 
> 时间：2012-06-05T22:58:48.073
> 
> 标签：.net, linq, linq-to-sql

我附上了一个简单的 LINQ 查询。我想弄清楚是否有任何更好更有效的方法来提取这三个字段（Field1、Field2、Field3），如下面的 LINQ 查询中所述。

```
from currentCons in ActiveConnections
join accounts in Accounts on currentCons.New_AccountId equals accounts.AccountId                                     
let Field1 =(from holder in MapHolders
        join entity in Entities on stringmap.ObjectTypeCode equals   entity.ObjectTypeCode
        where entity.Name == "New_Connection"
        where holder.AttributeName == "New_Data"
        where holder.AttributeValue ==  currentCons.New_DATA_Val
        select holder.Value)
 let Field2=(from holder in MapHolders
        join entity in Entities on stringmap.ObjectTypeCode equals entity.ObjectTypeCode
        where entity.Name == "New_Connection"
        where holder.AttributeName == "New_Type"
        where holder.AttributeValue == currentCons.New_Type
        select holder.Value)
let Field3=(from holder in MapHolders
        join entity in Entities on stringmap.ObjectTypeCode equals entity.ObjectTypeCode
        where entity.Name == "New_Connection"
        where holder.AttributeName == "New_EntryPoint"
        where holder.AttributeValue == currentCons.New_EntryPoint
        select holder.Value)
   where currentCons.ModifiedOn >= Convert.ToDateTime("1/1/2011")
   where currentCons.ModifiedOn <= Convert.ToDateTime("5/5/2012")
   select new 
   {
      conId = currentCons.ConnectionId,
      ConName = currentCons.name,
      TypeId = currentCons.Type,
      AccountId = currentCons.AccountId,
      OId = currentCons.OwnerId,
      BandwidthId = currentCons.Bandwidth,
      EntryPointId = currentCons.EntryPoint,
      Cap = Field1 ,
      Dir=Field2,
      EP=Field3,
      ModifiedOn = currentCons.ModifiedOn
    } 
```

我知道另一种方法是直接放入 Select Block 中。这样做的有效方法是什么？

任何指针表示赞赏。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T05:30:06.493

```
var fromDate =  new DateTime(2011,1,1);
var toDatePlusOneDay = new DateTime(2012,5,5).AddDays(1); // add one day to ensure 

var result = from currentCons in ActiveConnections
            join accounts in Accounts on currentCons.New_AccountId equals accounts.AccountId                                     
            where currentCons.ModifiedOn >= fromDate
            where currentCons.ModifiedOn < toDatePlusOneDay 
            from holder in MapHolders
            where (holder.AttributeName == "New_Data" && holder.AttributeValue == currentCons.New_DATA_Val) || (holder.AttributeName == "New_Type" && holder.AttributeValue == currentCons.New_Type) || (holder.AttributeName == "New_EntryPoint" && holder.AttributeValue == currentCons.New_EntryPoint)
            select new 
            {
              conId = currentCons.ConnectionId,
              ConName = currentCons.name,
              TypeId = currentCons.Type,
              AccountId = currentCons.AccountId,
              OId = currentCons.OwnerId,
              BandwidthId = currentCons.Bandwidth,
              EntryPointId = currentCons.EntryPoint,
              ModifiedOn = currentCons.ModifiedOn,
              Cap = (holder.AttributeValue == currentCons.New_DATA_Val) ? holder.Value : null,
              Dir = (holder.AttributeValue == currentCons.New_Type) ? holder.Value : null,
              EP = (holder.AttributeValue == currentCons.New_EntryPoint) ? holder.Value : null              
            } 
```

我删除了以下内容，因为它没有用于任何结果

```
join entity in Entities on stringmap.ObjectTypeCode equals entity.ObjectTypeCode
        where entity.Name == "New_Connection" 
```

另请检查 Cap/Dir/EP 是否可以为空

# sql-server-2005 - 尝试创建 CLR 函数时，在 Visual Studio 中看不到数据库对象 -> SQL Server 项目

> ID：10906176
> 
> 赞同：0
> 
> 时间：2012-06-05T22:58:53.087
> 
> 标签：sql-server-2005, visual-studio-2005

我需要创建一个 CLR 函数（在 C# 中）来支持业务需求。我已经准备好代码了。所需要的只是在 Visual Studio 中创建一个服务器项目，添加代码并编译它。这是我遇到麻烦的地方。如标题所述，我在创建新项目时无法看到 Database Objects 选项。我所看到的只是 BI 项目和其他项目类型 -> VS 解决方案。

这是我在工作站上安装*的：*

*   SQL Server 2005 工作站组件（无法安装完整的服务器 - 许可限制）。
*   SQL Server 2012 速成版

微软真的没有让开发者的事情变得简单。有谁知道如何让 SQL Server Projects 选项显示在 Visual Studio 中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T00:10:13.763

已经想通了。我需要安装完整版的 Visual Studio 才能获得此选项。

# java - 在eclipse中放一个小程序

> ID：10906186
> 
> 赞同：1
> 
> 时间：2012-06-05T23:00:16.387
> 
> 标签：java, eclipse, xhtml, applet

我在eclipse中做了一个小程序，我可以通过右键单击java文件成功运行它并运行为-> Java Applet

但是我想将该小程序添加到 xhtml 文件中，因此在 index.xhtml 文件中添加了小程序标记，但是当我在浏览器中部署 index.xhtml 时，我只是收到一条错误消息，指出找不到 MyApplet.class

```
<applet code="com.project.helper.MyApplet.class" width="500" height="500"> 
```

我以这种方式组织文件：

[带有文件正文的图像](https://www.dropbox.com/s/2qulsa4rpe4gswf/Files.JPG)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T23:17:10.330

您必须定义applet xhtml 行的archive 属性，它是您的applet 的jar 文件的位置，应该从中加载类属性。

```
<applet code="com.project.helper.MyApplet.class" archive="MyApplet.jar" width="500" height="500"> 
```

# iphone - 处理数十万（300 000+）个 MKAnnotations，我应该如何处理存储？

> ID：10906188
> 
> 赞同：0
> 
> 时间：2012-06-05T23:00:33.857
> 
> 标签：iphone, database, mkannotation, mapkit

在应用程序中使用位置名称（标题 + 纬度和经度）保存这些位置会占用大量空间。如何减小应用程序的大小？任何建议都会让我感激不尽。

而且这可能会降低应用程序的性能，考虑到这一点有什么建议吗？

EDIT1：我突然想到，如果我将所有内容保存在在线服务器上并像谷歌地图那样查询“注释图块”，那可能是解决方案。所以我现在的问题是：有人知道查询“注释块”的好算法吗？这可能非常棘手，因为地图包含多个缩放级别等。对于初学者，我可能会创建几个四叉树（每个缩放级别一个），其中存储我已经查询过的图块。

大家觉得这种方法可能好吗？或者在3G上运行会不会太慢？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T23:51:40.477

由于您没有对解决方案设置任何限制，这就是我要做的；

首先，将注释存储在一个真实的数据库中，30 万条记录对于一个 XML 文件来说有点多，您必须在某个时候开始查询它们，而 XML 不适合那样做。

其次，我会将其存储在设备或服务器上。您的选择，我不知道 300.000 个注释有多大。我会按设定半径的每个区域查询服务器或数据库。这不应该太难做，它应该很好地限制查询量（以及服务器通信）。您可以直接将其与您从`MKMapView`或您的`CLLocationManager`实例中获得的回调结合起来。

如果您仍然担心通信过多，请构建缓存机制。将查询结果临时存储在磁盘上一段时间（或设置的空间量，或使用频率，无论您的数据的目的是什么）。构建查询机制，使其首先尝试从磁盘解析结果，然后再访问您的数据库或服务器（好吧，如果您有本地数据库，则不需要真正的缓存机制）。

如果您无法做任何这些事情（拥有服务器或数据库），至少拆分 XML 文件并让您自己轻松管理和查询数据。进行延迟加载，但确保您的数据结构设置为延迟加载（XML 肯定不是）。

PS：查询的时候不用担心缩放太多；只需查询当前位置+偏移半径。您的偏移半径将由缩放量定义，它只是发送到您的服务器/数据库的另一个参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T23:04:36.763

您可能应该从支持的服务器懒惰地加载这些位置（仅检索需要的内容），而不是将应用程序本身用作存储引擎。

# jquery - Jquery Mobile在不同页面上的相同页脚

> ID：10906189
> 
> 赞同：5
> 
> 时间：2012-06-05T23:00:41.607
> 
> 标签：jquery, mobile, dynamic, cordova, footer

我想在我的 jquery 移动应用程序的所有页面上都有相同的页眉和页脚，并使用不同的文件来控制它，例如 footer.html。使用 PHP 包含这很容易做到，但我不能，因为我打算将此应用程序与 phonegap 一起使用。

搜索我发现使用

```
 <div data-role="footer">
<div class="footerExt"></div>
  </div> 
```

和 javascript

```
$('.footerExt').load('footer.html') 
```

但是，这是行不通的。我应该提到我是 javascript 初学者，我几乎不明白发生了什么。

非常感谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-06T05:43:30.443

尝试以下事件，它适用于我的代码：

```
$('[data-role=page]').live('pageshow', function (event, ui) {
            $("#" + event.target.id).find("[data-role=footer]").load("footer.html", function(){
                $("#" + event.target.id).find("[data-role=navbar]").navbar();
            });
        }); 
```

这个[要点](https://gist.github.com/2880107)显示了整个代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-28T11:42:41.093

从 jquery 1.9 及更高版本开始，[live 现在已被弃用](http://jquery.com/upgrade-guide/1.9/#live-removed)，请使用该功能。在控制台中它会给出 TypeError: $(...).live is not a function

示例更改您的代码

```
$('[data-role=page]').live('pageshow', function (event, ui) {
            $("#" + event.target.id).find("[data-role=footer]").load("footer.html", function(){
                $("#" + event.target.id).find("[data-role=navbar]").navbar();
            });
        }); 
```

**用。。。来代替**

```
 $('[data-role=page]').on('pageshow', function (event, ui) {
                $("#" + event.target.id).find("[data-role=footer]").load("footer.html", function(){
                    $("#" + event.target.id).find("[data-role=navbar]").navbar();
                });
            }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T23:09:25.287

您需要将外部 html 代码加载到具有 data-role="footer" 的 div 中，因此您需要更改：

```
<div class="footerExt"></div> 
```

**到**

```
<div data-role="footer" class="footerExt"></div> 
```

例如，您的页脚 html 可能有一个 h3

```
 <h3>This is your footer</h3> 
```

# php - 在 Zend Framework 中为多个操作创建表单

> ID：10906193
> 
> 赞同：1
> 
> 时间：2012-06-05T23:01:01.097
> 
> 标签：php, zend-framework

我有一个上传表单，显示在叠加层/灯箱/顶层。它仅适用于多个控制器中的多个操作。

创建这个表单需要大约 6 行代码，并且需要访问 REQUEST 对象以从中获取参数。

我应该把这段代码放在哪里，这样我就可以轻松地在我需要的操作中创建我的表单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T23:16:39.970

我会将此功能放在[Action Helper](http://framework.zend.com/manual/en/zend.controller.actionhelpers.html)中。动作助手可以直接从任何控制器动作中调用（并且是延迟加载的），动作助手可以访问控制器动作所做的一切，包括请求对象和视图。

例子：

```
<?php

class My_Action_Helper_FormCreator extends Zend_Controller_Action_Helper_Abstract {
    public function direct($options = null)
    {
        $request  = $this->getRequest();
        $view     = $this->getActionController()->view;
        $form     = new Application_Form_SomeForm();

        // set form options here...

        $view->form = $form; // optional - assign form directly to the view

        return $form;
    }
} 
```

将该代码放入`library/My/Action/Helper/FormCreator.php`（或在需要的地方并更改类名）。

然后，在你的行动中，这样称呼它：

```
$form = $this->_helper->FormCreator(); 
```

最后，我们需要告诉助手代理在哪里可以找到这个动作助手。为此，请将其添加到您的引导程序中：

```
protected function _initActionHelpers() {
    Zend_Controller_Action_HelperBroker::addPrefix('My_Action_Helper');
} 
```

希望有帮助。

# javascript - Javascript/jQuery：以编程方式跟随链接

> ID：10906197
> 
> 赞同：18
> 
> 时间：2012-06-05T23:01:29.493
> 
> 标签：javascript, html, hyperlink

在 Javascript 代码中，我想以编程方式使浏览器跟随我页面上的链接。简单案例：

```
<a id="foo" href="mailto:somebody@example.com">something</a> 
```

* * *

```
function goToBar() {
   $('#foo').trigger('follow');
} 
```

这是假设的，因为它实际上不起作用。不，触发`click`不会这样做。

我知道，`window.location`但是`window.open`这些在某些对我很重要的方面与原生链接跟踪不同：a）在`<base />`元素存在的情况下，b）在`mailto`URL 的情况下。后者尤其重要。至少在 Firefox 中，调用`window.location.href = "mailto:somebody@example.com"`会导致窗口的`unload`处理程序触发，而仅单击`mailto`链接不会，据我所知。

我正在寻找一种方法来触发浏览器对链接的默认处理，从 Javascript 代码。

这样的机制存在吗？也欢迎工具包特定的答案（尤其是对于 Gecko）。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-06-05T23:18:03.910

据我所知， window.location 完全符合您的要求，触发了浏览器的默认链接点击行为。

一些浏览器会在触发任何事件或更改实际 href 之前注意到协议。

```
window.location = "mailto:somebody@example.com"; 
```

尝试下面提到的小提琴演示，我得到以下结果：

*   Chromium：`onbeforeunload`使用按钮和链接触发
*   Firefox`onbeforeunload`只为按钮触发
*   Safari：从不触发`onbeforeunload`
*   Opera：与 Safari 相同

因此，防止`unload`事件被触发的一个好方法是返回 false in `beforeunload`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-05T23:03:42.753

**方法 1**点击方法

`HTMLElement`s 有一个方法`click()` [https://developer.mozilla.org/en/DOM/element.click](https://developer.mozilla.org/en/DOM/element.click)

```
function goToBar() {
   document.getElementById('foo').click();
} 
```

* * *

**方法 2**触发合成事件

我想知道为什么 saluce 删除了他的答案。该解决方案是我过去使用过的（当点击只是 IE 时）。也就是说，触发一个合成浏览器事件（不是像 jQuery 那样的假事件`click()`）。让我使用这个想法发布一个解决方案......

**演示：http: [//jsfiddle.net/eyS6x/3/](http://jsfiddle.net/eyS6x/3/)**

```
/**
 * Fire an event handler to the specified node. Event handlers can detect that the event was fired programatically
 * by testing for a 'synthetic=true' property on the event object
 * @param {HTMLNode} node The node to fire the event handler on.
 * @param {String} eventName The name of the event without the "on" (e.g., "focus")
 */
function fireEvent(node, eventName) {
  // Make sure we use the ownerDocument from the provided node to avoid cross-window problems
  var doc;
  if (node.ownerDocument) {
    doc = node.ownerDocument;
  } else if (node.nodeType == 9 /** DOCUMENT_NODE */){
    // the node may be the document itself
    doc = node;
  } else {
    throw new Error("Invalid node passed to fireEvent: " + +node.tagName + "#" + node.id);
  }

  if (node.fireEvent) {
    // IE-style
    var event = doc.createEventObject();
    event.synthetic = true; // allow detection of synthetic events
    node.fireEvent("on" + eventName, event);
  } else if (node.dispatchEvent) {
    // Gecko-style approach is much more difficult.
    var eventClass = "";

    // Different events have different event classes.
    // If this switch statement can't map an eventName to an eventClass,
    // the event firing is going to fail.
    switch (eventName) {
      case "click":
      case "mousedown":
      case "mouseup":
        eventClass = "MouseEvents";
        break;

      case "focus":
      case "change":
      case "blur":
      case "select":
        eventClass = "HTMLEvents";
        break;

      default:
        throw "JSUtil.fireEvent: Couldn't find an event class for event '" + eventName + "'.";
        break;
    }
    var event = doc.createEvent(eventClass);
    var bubbles = eventName == "change" ? false : true;  
    event.initEvent(eventName, bubbles, true); // All events created as bubbling and cancelable.

    event.synthetic = true; // allow detection of synthetic events
    node.dispatchEvent(event);
  }
};

document.getElementById('button').onclick = function() {
   fireEvent( document.getElementById('link'), 'click');
} 
```

# python - 将代码编译和运行为 dmg 或 exe

> ID：10906198
> 
> 赞同：0
> 
> 时间：2012-06-05T23:01:32.297
> 
> 标签：python, exe, dmg

新手问题我发现很难理解。

如果我想使用 rsync lsync 或 s3cmd 之类的众多工具中的一种，您如何将它们构建到一个程序中，让不懂计算机的人使用。

即我很乐意打开终端并运行在 python 中开发的 s3cmd 我将如何将其开发为 mac 的 dmg 文件或 windows 的 exe 文件？

因此，用户可以只安装 dmg 或 exe，然后他们的计算机上有 s3cmd lsync 或 rsync。

我可以在 java 中打开一个简单的应用程序的 eclipse 代码，然后导出为 dmg 或 exe 我不知道你是如何为其他语言执行此操作的，比如写一段简单的代码，我可以将它保存为 dmg 或 exe 并在安装后将一个文件夹添加到我的桌面或类似的简单的东西让我开始？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T23:39:57.463

如果您的意思是专门针对 Python，正如我在您的问题中标记它所收集的那样，它不会像 Java 那样简单地运行，因为没有等效的虚拟机。

如果用户的系统上有 Python 解释器，他们可以简单地运行 .py 文件。如果没有，您可以使用 Py2Exe、cxFreeze 或 bbFreeze 将解释器和所需的库捆绑到可执行文件中。为了替换 dmg，App2Exe 做了类似的事情。

然而。您列出的三个命令与 python 无关，并且依赖于 Windows 或 Mac 上不一定可用的功能，因此可能不太可能。

# design-patterns - 使用函数式编程的链接对象？

> ID：10906203
> 
> 赞同：2
> 
> 时间：2012-06-05T23:02:20.843
> 
> 标签：design-patterns, scala

我是 Scala 的新手，但我是一位经验丰富的程序员，试图摆脱旧习惯并采用函数式风格。我正在设计的一个简单程序涉及问题/答案对象，并保留了一些关于成功的基本事实。仅使用不可变对象就足够简单了——但我的部分目标是链接相关的事实，因此程序可能会不时地询问它们彼此相邻。（例如：“Knight Rider Car 是什么？”、“什么电视节目以 Impala 为主角？）

在 Java 中，我可能刚刚链接了如下所示的关联对象，但是不可变的法律阻止了这种情况（我不能链接 A-> B 并实例化 B -> A，除非我一次性完成？）

而且我必须承认，这可能是一件好事——也许函数式风格就是为了防止这种循环引用而设计的。但我不知道如何纠正这个问题。一旦提出问题，我的设计就会失败 - 因为这会返回一个具有“正确，询问”新值的副本对象，因此对象链接似乎又是一个陷阱。我最好的猜测是在辅助对象中构建关系集，仅基于 Q/A 数据，但我想避免处理单独的数据模式对象。

谢谢大家-俄亥俄州哥伦布市的蒂姆

```
case class FactItem (

    q:String, a:String,
    right: Double = 0.0,
    asked: Double = 0.0,
    linked: List[FactItem] = List[FactItem]()

    ) { 

  def rP = right / asked //right per

  def subLink( l:List[FactItem] ) : FactItem =  {
    this.copy( linked = l-this)

  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T00:09:42.143

请参阅此问题以了解如何不可变地执行此操作：[scala: how to model a basic parent-child relationship](https://stackoverflow.com/questions/10262574/scala-how-to-model-a-basic-parent-child-relation/10262719#10262719)

提示：不要在案例类中执行此操作，除非您重写`toString`为不包含项目列表（如果存在循环引用，您将溢出堆栈，因为该项目的 toString 包括列表中所有其他项目的 toString ）。

`private var`一旦您引用了列表项，您可以通过创建 List a 并从创建所有项的伴随对象中的工厂方法更新所有实例来为自己省去很多麻烦。由于没有公共设置器，它仍然是有效的不可变的。

一种类似且理论上可能更合理的方法是使列表 a`Stream`从伴随对象中的映射中获取其值。在创建项目时地图必须是可变的，但至少项目现在是完全不可变的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T03:24:03.987

真正的答案是不要那样做。创建一个指向两者的“关系”对象。

现在您可能想知道如何从指向“Relation”的对象到“Relation”本身，然后是另一个对象，您可以通过使用 zippers 来做到这一点。不是直接去对象“a”，而是得到树/图，并将拉链*移动*到“a”。从那里，您可以返回“关系”并转发到“b”，或者如果拉链知道横向移动，则可以直接从“a”到“b”。

不幸的是，在有用的拉链方面，Scala 远远落后于 Haskell。但是，如果您了解这个概念（我将留给您研究），您总是可以为您的数据结构创建一个。

还有另一个可能适用的答案。您可能有一个“镜头”，它是一个知道如何将其他对象分开和组合（修改）的对象。该类的基本设计必须允许它（使用可变性或惰性技巧），但镜头隐藏了操作本身的丑陋（除了提供许多其他漂亮的功能）。

最后，我想强调 Scala*不是*纯函数式的，这是有充分理由的：Odersky 认为在纯函数式语言之外还有其他价值，并希望您拥有这种能力。

# ios - 如何使缓存的 nimbus 网络图像过期

> ID：10906205
> 
> 赞同：0
> 
> 时间：2012-06-05T23:02:43.573
> 
> 标签：ios, nimbus-ios

我在刷新 nimbus 图像时遇到问题，并且不确定我是否正确删除了缓存的图像。在我上传新图像后，它仍然会在刷新时显示旧图像几分钟或更长时间。

```
[(SDURLCache*)[NSURLCache sharedURLCache] removeCachedResponseForRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:url]]];

[[Nimbus imageMemoryCache] removeObjectWithName:url];

[profilePic setPathToNetworkImage:url]; 
```

哪种方法是删除缓存的正确方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T00:41:42.230

我在 Nimbus 的内存缓存中添加了一个新方法，称为`removeAllObjectsWithPrefix:`. 您可以通过以下方式使用此方法强制使缓存中的图像过期：

```
[imageView.imageMemoryCache removeAllObjectsWithPrefix:imageUrl]; 
```

您需要知道 url 才能使其从缓存中过期。

之所以需要这种方法，是因为NINetworkImageView为图像缓存键添加了后缀，以区分不同的大小和内容模式。

[https://github.com/jverkoey/nimbus/blob/master/src/networkimage/src/NINetworkImageView.m#L137](https://github.com/jverkoey/nimbus/blob/master/src/networkimage/src/NINetworkImageView.m#L137)

# sql - PostgreSQL：如何返回关于找到的行（相对结果）的行？

> ID：10906206
> 
> 赞同：1
> 
> 时间：2012-06-05T23:02:58.760
> 
> 标签：sql, postgresql

如果没有意义，请原谅我的例子。我将尝试一个简化的来鼓励更多的参与。

考虑如下表：

*   ```
     dt     |    mnth    |  foo
    --------------+------------+--------
      2012-12-01  |  December  |
        ...
      2012-08-01  |  August    |
      2012-07-01  |  July      |
      2012-06-01  |  June      |
      2012-05-01  |  May       |
      2012-04-01  |  April     |
      2012-03-01  |  March     |
        ...
      1997-01-01  |  January   | 
    ```

如果您查找`dt`最接近今天的记录而没有过去，那么同时返回*3 条记录*和*7 条记录*的最佳方法是什么？

我决定尝试窗口功能：

*   ```
    WITH dates AS (
       select  row_number() over (order by dt desc)
             , dt
             , dt - now()::date as dt_diff
       from    foo
    )
    , closest_date AS (
       select * from dates
       where dt_diff = ( select max(dt_diff) from dates where dt_diff <= 0 )
    )

    SELECT * 
    FROM   dates
    WHERE  row_number - (select row_number from closest_date) >= -3
       AND row_number - (select row_number from closest_date) <=  7 ; 
    ```

我觉得必须有更好的方法来使用窗口函数返回相关记录，但是我已经有一段时间没有看过它们了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T23:36:38.613

```
create table foo (dt date);
insert into foo values
('2012-12-01'),
('2012-08-01'),
('2012-07-01'),
('2012-06-01'),
('2012-05-01'),
('2012-04-01'),
('2012-03-01'),
('2012-02-01'),
('2012-01-01'),
('1997-01-01'),
('2012-09-01'),
('2012-10-01'),
('2012-11-01'),
('2013-01-01')
;

select dt
from (
(
    select dt
    from foo
    where dt <= current_date
    order by dt desc
    limit 4
)
union all
(
    select dt
    from foo
    where dt > current_date
    order by dt
    limit 7
)) s
order by dt
;
     dt     
------------
 2012-03-01
 2012-04-01
 2012-05-01
 2012-06-01
 2012-07-01
 2012-08-01
 2012-09-01
 2012-10-01
 2012-11-01
 2012-12-01
 2013-01-01
(11 rows) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T08:44:53.950

您可以使用**窗口功能`lead()`**：

```
SELECT dt_lead7 AS dt
FROM  (
    SELECT *, lead(dt, 7) OVER (ORDER BY dt) AS dt_lead7
    FROM   foo
    ) d
WHERE  dt <= now()::date
ORDER  BY dt DESC
LIMIT  11; 
```

稍微短一些，但`UNION ALL`使用合适的索引版本会更快。

这留下了一个**极端情况**，其中“最接近今天的日期”在前 7 行内。您可以用 7 行填充原始数据[`-infinity`](https://www.postgresql.org/docs/current/datatype-datetime.html#AEN5750)来处理这个问题：

```
SELECT d.dt_lead7 AS dt
FROM  (
    SELECT *, lead(dt, 7) OVER (ORDER BY dt) AS dt_lead7
    FROM  (
        SELECT '-infinity'::date AS dt FROM generate_series(1,7)
        UNION ALL
        SELECT dt FROM foo
        ) x
    ) d
WHERE  d.dt <= now()::date -- *same as: WHERE  dt <= now()::date*¹
ORDER  BY d.dt_lead7 DESC  -- *same as: ORDER BY dt DESC* ¹
LIMIT  11; 
```

我对第二个查询中的列进行了表限定，以阐明发生了什么。见下文。如果“最接近今天的日期”在基表的最后 7 行内，则
结果将包括值。`NULL`如果需要，您可以使用额外的子选择过滤那些。

* * *

^(1要解决您对注释中的)**输出名称**与**列名称**的疑问- 请考虑手册中的以下引用。

[在哪里使用输出列的名称](https://www.postgresql.org/docs/current/sql-select.html#SQL-SELECT-LIST)：

> 输出列的名称可用于在 `ORDER BY`and`GROUP BY`子句中引用列的值，**但不能在`WHERE`**or`HAVING`子句中；在那里你必须写出表达式。

大胆强调我的。`WHERE dt <= now()::date`引用该列`d.dt`，而不是同名的输出列-从而按预期工作。

[解决冲突](https://www.postgresql.org/docs/current/sql-select.html#SQL-ORDERBY)：

> 如果`ORDER BY`表达式是与输出列名和输入列名都匹配的简单名称，**`ORDER BY`则将其解释为输出列名**。`GROUP BY` 这与在相同情况下做出的选择相反。**这种不一致性是为了与 SQL 标准兼容。**

再次大胆强调我的。`ORDER BY dt DESC`在示例中引用了输出列的名称 - 正如预期的那样。无论如何，任何一列都会排序相同。唯一的区别*可能*是`NULL`极端情况的值。但这也持平，因为：

> 默认行为是`NULLS LAST`何时`ASC`指定或暗示，以及`NULLS FIRST`何时`DESC`指定

由于`NULL`值*在最大值之后*，因此无论哪种方式，顺序都是相同的。

* * *

或者，**没有`LIMIT`**（根据评论中的要求）：

```
WITH x AS (
    SELECT *
         , row_number() OVER (ORDER BY dt)  AS rn
         , first_value(dt) OVER (ORDER BY (dt > '2011-11-02')
                                         , dt DESC) AS dt_nearest
    FROM   foo
    )
, y AS (
    SELECT rn AS rn_nearest
    FROM   x
    WHERE  dt = dt_nearest
    )
SELECT dt
FROM   x, y
WHERE  rn BETWEEN rn_nearest - 3 AND rn_nearest + 7
ORDER  BY dt; 
```

如果性能很重要，我仍然会使用@Clodoaldo 的`UNION ALL`变体。这将是最快的。与数据库无关的 SQL 只能让您走这么远。其他 RDBMS 根本没有窗口函数（MySQL），或者不同的函数名称（比如`first_val`代替`first_value`）。您也可以替换`LIMIT`为`TOP n`(MS SQL) 或任何本地方言。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T23:23:05.817

你可以使用类似的东西：

```
select * from foo 
where dt between now()- interval '7 months' and now()+ interval '3 months' 
```

[这](http://www.postgresql.org/docs/9.1/static/functions-formatting.html)和[这](http://www.postgresql.org/docs/9.1/static/functions-datetime.html)可能会帮助你。

# asp.net-mvc - 如何手动填充 ViewModel（不使用 AutoMapper！）

> ID：10906208
> 
> 赞同：9
> 
> 时间：2012-06-05T23:03:00.600
> 
> 标签：asp.net-mvc

我知道有很多关于这个主题的帖子，但我找不到可以帮助我做我想做的事的帖子。我知道我最终会使用 Automapper，但在开始使用它之前，我想学习如何手动操作。我想创建一个 ViewModel，通过存储库使用我的实体中的值填充它，并将其发送到我的视图。听起来很简单，我正在努力完成它。我正在使用 MVC 3、EF 4.3、数据库优先。我已经自动生成了我的课程。我正在发布相关实体（为这篇文章缩写/重命名）和类，这是我到目前为止所拥有的：

**聚合实体：运输标题**

```
using System;
using System.Collections.Generic;

namespace My.Models
{
public partial class ShippingHdr
{
    public ShippingHdr()
    {
        this.ShippingLI = new HashSet<ShippingLI>();
    }

    public int ID { get; set; }
    public int ShipToSiteID { get; set; }
    public Nullable<System.DateTime> DateShipped { get; set; }
    public Nullable<System.DateTime> EstDeliveryDate { get; set; }
    public string FromSitePOC { get; set; }
    public Nullable<int> ShipperID { get; set; }
    public string TrackingNo { get; set; }
    public string Comments { get; set;}
    public virtual Shippers Shippers { get; set; }
    public virtual ICollection<ShippingLI> ShippingLI { get; set; }
}

} 
```

这是我的视图模型

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;

namespace My.Models.ViewModels
{

public class ShippingHeaderSummaryVM
{
    public int ID { get; set; }
    public string Site { get; set; }
    public Nullable<System.DateTime> DateShipped { get; set; }
    public Nullable<System.DateTime> EstDeliveryDate { get; set; }
    public string TrackingNo { get; set; }
    public string HeaderComments { get; set; }
    public string Shipper { get; set; }
    public int NumOrders { get; set; }
    public string Site { get; set; }

} 
```

}

这是一个查询，我必须返回我想用来填充我的 Viewmodel 的项目。我相信最好的地方是在存储库中。我验证了它使用 LinqPad 返回了我想要的数据（因此缺少对我的 dbContxt 的引用）。我只是不知道如何从查询中获取值到 ViewModel：

```
var shipments = from h in c.ShippingHdrs
                        where (h.ShippingLI.Count > 1)
                        join
                        e in c.vHr_Employees on h.CreatedBy equals e.ID
                        join
                        s in c.Shippers on h.ShipperID equals s.ShipperID
                        join
                        r in vAaiomsSites on h.ShipToSiteID equals r.SiteID

                        select new
                        {
                            h.ID,
                            r.Site,
                            h.EstDeliveryDate,
                            h.DateShipped,
                            h.TrackingNumber,
                            h.HeaderComments,
                            e.LastName,
                            h.ShippingLI.Count,
                            s.Shipper
                                                        }; 
```

所以我想要做的，同样不使用 Automapper，是用 ShippingHdr 实体中的所有行填充 ViewModel 并将其传递给我的视图。

以下是需要映射的文件：

**ShippingHeaderSummaryVM 从货件映射**

```
ID = h.ID
Site = r.Site
DateShipped = h.DateShipped
EstDeliveryDate = h.EstDeliveryDate
TrackingNo = h.TrackingNumber
FromSitePOC = e.LastName
NumOrders = h.ShippingLI.Count
Shipper = s.Shipper
HeaderComments = h.HeaderComments 
```

我被困在这里。如何从查询中填充 ViewModel？那么我如何从我的控制器调用该操作？

我希望我已经提供了足够的信息，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T23:19:11.220

为了根据您的视图模型对象填充发货列表，您需要创建一个映射方法，以从您的数据库中的发货集合映射到基于您的视图模型的发货集合：

```
var model = new List<ShippingHeaderSummaryVM>();

foreach(var h in shipments)
{

    var viewModel = new ShippingHeaderSummaryVM
    {
    ID = h.ID
    Site = r.Site
    DateShipped = h.DateShipped
    EstDeliveryDate = h.EstDeliveryDate
    TrackingNo = h.TrackingNumber
    FromSitePOC = e.LastName
    NumOrders = h.ShippingLI.Count
    Shipper = s.Shipper
    HeaderComments = h.HeaderComments
    }

    model.Add(viewModel);
}

return model; 
```

附带说明一下，在您启动并运行 AutoMapper 后，这将成为一个单行：

```
var model = Mapper.Map<IEnumerable<ShippingHdr>, IEnumerable<ShippingHeaderSummaryVM>>(shipments); 
```

同时，学习如何手动做事很棒。手动映射模型不会以任何方式或形式真正使您受益。使用 AutoMapper。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T23:54:18.797

你也可以使用 Linq 来做这样的事情......

```
shipments.Select(h => new ShippingHeaderSummaryVM(){
    ID = h.ID,
    Site = r.Site,
    DateShipped = h.DateShipped,
    EstDeliveryDate = h.EstDeliveryDate,
    TrackingNo = h.TrackingNumber,
    FromSitePOC = e.LastName,
    NumOrders = h.ShippingLI.Count,
    Shipper = s.Shipper,
    HeaderComments = h.HeaderComments
}); 
```

请注意，虽然映射视图模型非常适合传递给视图，但在从视图模型读取以更新数据库时，请始终手动执行此操作。

编辑：感谢您的错字更正:-)

# java - 删除 SWT TreeItem 图像缩进

> ID：10906210
> 
> 赞同：5
> 
> 时间：2012-06-05T23:03:24.400
> 
> 标签：java, eclipse, swt

我正在尝试构建一个 SWT 树，它在顶层有图标，但在下一层没有。

![树截图](../Images/e329ae204b71f8ab2c283167399b350a.png)

有什么办法可以避免似乎为我不使用的图像留下的空白？我尝试使用以下代码片段，但都没有达到我想要的效果。

SWT.MeasureItem：

```
tree.addListener(SWT.MeasureItem, new Listener()
{
  @Override
  public void handleEvent(Event event)
  {
    TreeItem item = (TreeItem)event.item;
    Image image = item.getImage();
    if (image == null)
    {
      event.x -= 40;
    }
  }
}); 
```

SWT.PaintItem：

```
tree.addListener(SWT.PaintItem, new Listener()
{
  @Override
  public void handleEvent(Event event) {
    TreeItem item = (TreeItem)event.item;
    Image image = item.getImage();
    if (image == null)
    {
      event.x -= 40;
    }
  }
}); 
```

在这两种情况下，我只是希望文本可以再向左一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T18:33:36.850

此行为来自本机控件并且是特定于操作系统的（AFAIR，在 Mac 上您不会看到此问题）。唉，没有简单的修复，但添加一些通用图标（或根本不添加图标）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T08:26:14.770

我自己也做了一些调查。根据尤金的回答，这似乎是原生行为。有几件事值得注意。

如果树中没有项目有图标，则没有为图标留下空间。但是，即使是带有图标的单个项目也会导致所有项目都为图标留出空间。

一个hacky解决方案可以实现如下：

*   不使用图标，以便本机控件不留图标空间
*   对于需要图标前缀的项目，在文本中添加一些空格，例如“”+文本
*   添加一个 PaintItem 侦听器，将您想要的图标绘制到文本留下的空间中

这可能不适用于跨平台和跨系统字体，所以我刚刚决定使用图标。

# c - c中的奇怪字符

> ID：10906218
> 
> 赞同：3
> 
> 时间：2012-06-05T23:04:38.377
> 
> 标签：c

这是我的源代码：

```
#include <stdio.h>
#include <string.h>

void main()
{
    int broj_znakova,i=0;
    char niz1[81],niz2[81];

    printf("Enter something, for end Ctrl/c \n\n");
    while(fgets(niz1,81,stdin)!=NULL)
    {
        continue;
    }
    printf("You just enter: %s \n",niz1);
    printf("This string is long %d\n",(strlen(niz1)-1));
    strcpy(niz1,niz2);
    printf("niz2 is %s\n",niz2);
    if(strcmp(niz1,niz2)==0)
    {
        printf("niz1 and niz2 is same\n");
    }
    else
    {
        printf("niz1 != niz2\n");
    }
    while(niz1[i]!='\n')
    {
        if(niz1[i]==' ')
        {
            broj_znakova ++;
            i=i+1;
        }
    }
    printf("Spaces in string = %d\n",broj_znakova);
} 
```

当我按 Ctrl/ci 有一堆奇怪的字符，有人可以帮忙吗？？？我在谷歌上搜索了一些关于冲洗的信息，但我是新手 :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T23:13:37.593

的内容`niz2`未初始化。这将导致未定义的行为。也许您的意思是复制`niz1`到`niz2`. 如果是这样，那么您需要反转`strcpy`调用中的参数。有了`strcpy`，第一个参数就是目标。

还要注意，该变量`broj_znakova`永远不会被初始化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T23:14:59.287

C 不会将内存中的信息“归零”（通常），因此当它分配变量时，如果您在没有系统的情况下打印某些东西，那么您会得到当时内存中的任何内容（无论它是否在逻辑上可读为单词）知道这是一个字符串，那么它将继续打印，直到遇到 NULL 终止字符，如果没有，它会尝试打印内存中的任何内容，这会产生奇怪的字符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T23:19:20.007

在这条线上

```
strcpy(niz1,niz2); 
```

我相信你的参数是相反的，它应该是 strcpy(niz2, niz1); 您看到的奇怪字符是因为 niz2[81] 分配了内存，但它没有“填充”。因此，您可以获得分配可能包含的任何“神奇”数据。也就是说，直到你把东西放进去，或者做 memset 等等。

# android - 保存 onPause 和 onResume 的状态

> ID：10906219
> 
> 赞同：0
> 
> 时间：2012-06-05T23:04:44.780
> 
> 标签：android, oncreate, onresume, instances, onpause

我什至不确定我是否正确地写了标题，因为这是我第一次觉得我必须应对这种方法。

在`onCreate()`中，我使用默认声音打印字符串发出通知。然后，我检查是否有另一个`String`. 如果不等于上一个`String`，我会发出另一个声音通知。也就是说，当我发现我改变了我的位置时，我会发出声音通知。

问题是我希望我的应用程序在后台运行，但是当我暂停应用程序时，立即发出声音通知（系统不记得我已经为该字符串发出通知，它使另一个）。再一次，当我打开应用程序时，我再次收到通知。

即使我关闭和打开应用程序 100 次，我也只想为一个位置发出 1 次通知。

我怎样才能做到这一点？

希望我能解释这个问题。

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    setContentView(R.layout.map);
    //here are being called location listeners
    somefunction();
}
public void somefunction(){
//finally, after some operation I get a string
if(newString!=oldString)
    {
        oldString=newString;
        notification(); 
    }
}

public void notification(){
// here I make notification with default audio
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T00:01:05.710

我不知道我是否完全正确地理解了您的问题，但这里的代码应该可以帮助您。此代码将使应用程序播放一次，然后将该值保存到应用程序的未来会话中，这意味着除非您保存错误值，否则它将不会再次播放。

希望能帮助到你！

```
package stackoverflow.sound;

import android.app.Activity;
import android.content.SharedPreferences;
import android.os.Bundle;

public class PlaySound extends Activity 
{
    private boolean hasSoundBeenPlayed;
    private SharedPreferences settings;

    public void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        // Gets values from last session of your application, check if sound was played!
        // If false no saved value was found (first session of your app)
        this.settings = getPreferences(MODE_PRIVATE);
        this.hasSoundBeenPlayed = settings.getBoolean("hasSoundBeenPlayed", false);

        // your logics.. //

        this.notification();
    }

    public void notification()
    {
        // If sound has been played, do nothing
        if (hasSoundBeenPlayed)
            return;

        this.hasSoundBeenPlayed = true;
        // Play your sound
    }

    // If location was changed, make notifications enabled again
    public void changedLocation()
    {
        this.hasSoundBeenPlayed = false;

        // Do whatever and play again
        this.notification();
    }

    // Called whenever application stops
    protected void onStop()
    {
        super.onStop();

        // Whenever application stops, save the sound boolean for future sessions.
        // If sound has been played (boolean = true), it wont play on any future sessions.
        SharedPreferences.Editor editor = this.settings.edit();
        editor.putBoolean("hasSoundBeenPlayed", this.hasSoundBeenPlayed);
        editor.commit();
     }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T23:18:05.040

使用标记布尔值来记录您是否已经发出声音。在发出声音之前检查此标志是否为假，如果位置再次更改，则将其设置为真。（不确定我是否正确理解了这个问题）。例如：

```
boolean alreadySounded = true;

public void onCreate(Bundle savedInstanceState) {
   super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    setContentView(R.layout.map);

    //here are being called location listeners

    checkLocation();    // call both of these in onResume() as well
    checkSounded(); 
```

}

```
private boolean checkLocation() {
    if(newString!=oldString)
    {
        oldString=newString;
        alreadySounded == false;
    }
}

private boolean checkSounded() {
    if(alreadySounded == false)
        notification();
} 
```

# java - BufferedImage 泄漏 - 有没有其他选择？

> ID：10906223
> 
> 赞同：2
> 
> 时间：2012-06-05T23:05:23.963
> 
> 标签：java, image, memory-leaks, bufferedimage

我在使用 BufferedImage 时遇到了奇怪的问题，在某些情况下它会消耗所有可用的系统内存（3GB、1.5GB 可用）。

我创建了一个简单的包装器，并像这样使用它：

```
public ImageWrapper(final byte[] bytes) throws ImageWrapperException {
    this(new ByteArrayInputStream(bytes));
}

public ImageWrapper(final ByteArrayInputStream bis) throws ImageWrapperException {
    try {
        image = ImageIO.read(bis);
        bis.close();
    } catch (IOException e) {
        throw new ImageWrapperException(e);
    }
} 
```

（我已经验证了它甚至会发生`image = ImageIO.read(file);`）

在第一个“无法分配内存”之前，我没有任何异常。

由于某种原因，在读取特定类型的图像时，图像的读取最终会消耗掉所有的系统内存。我不是在谈论堆，而是真正的系统内存。

它只发生在某些环境中——它不会发生在我的**OSX**上，但它会发生在我的**Debian**服务器上。

1.  你知道为什么会发生这种情况吗？
2.  有没有 BufferedImage 的替代品，可能效果更好？
3.  有问题的机器是虚拟服务器。会不会是它的配置造成的？

谢谢

编辑：

1.  示例图片：[http ://cl.ly/1P430l0V1g133r0C291J](http://cl.ly/1P430l0V1g133r0C291J)
2.  它只是第一个也是唯一一个会产生这个的实例。
3.  我刚刚证实它也发生在：`image = ImageIO.read(file);`- 我开始认为，它一定是 Java 之外的东西 - 一些有问题的本机库......

编辑2：

所以问题出在文件系统上——我有一个 7GB 的目录，里面有数千张图片。当我尝试读取文件时，它会消耗所有内存 - 我想这是某种文件系统问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T21:35:44.920

有一些与 ImageIO.read() 和 BufferedImage 相关的已知错误

[http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=7166379](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=7166379)

[http://bugs.sun.com/view_bug.do?bug_id=6716560](http://bugs.sun.com/view_bug.do?bug_id=6716560)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T22:46:13.223

BufferedImage 肯定有问题 - 我已经在两台服务器上测试过它，并且泄漏的结果相同 - 系统完全内存不足。

最后，我在 PHP 上编写了一个简单的包装器，现在我使用 GD 进行图像处理。现在工作正常。感谢所有的建议！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T07:54:38.807

尝试将代码移至`java.nio`并`memory mapped file`访问。这些存储在堆外。

这个[SO](https://stackoverflow.com/questions/1023200/memory-mapped-files-in-java)很有趣。

# java - Java 应用程序终止时使用的资源是否被释放？

> ID：10906226
> 
> 赞同：3
> 
> 时间：2012-06-05T23:05:59.503
> 
> 标签：java, memory-management, connection

Java 应用程序可能使用在不再需要时应关闭的 IO 流、套接字或数据库连接。

然而，应用程序可能会被终止（例如通过终止进程）。在这种情况下是否会释放所有使用的资源？谁将释放它们：OS 还是 JRE？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T23:13:11.873

JVM 将在终止时释放所有活动资源；但是，这并不能确保另一端也会释放资源，因此明确关闭资源符合每个程序员的最大利益。

Java 7 中存在一种显式关闭流的替代方法，称为 try-resource “语句”，相当于在`finally`try 块之后关闭块中的资源。更多信息可以在[这里](http://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html)找到。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-06T00:47:05.470

如果您的软件没有正确处理资源管理，则会发生以下情况：

*   **在运行时：** JVM 将在您的程序运行期间尝试关闭打开的流，如果它们看似未使用（在垃圾收集周期期间），
*   **在您的程序的终止点：** JVM 应该关闭您的程序打开的所有类型的打开流，
*   **在 JVM 的进程终止点：**操作系统将负责释放 JVM 未正确释放的任何内容（希望如此，或者这个操作系统有一些严重的问题......）。

正如 Vulcan 所提到的，显然，这些都不能确保它们在另一端得到妥善处理。

请注意，第 3 个要点是相当通用的事情：大多数操作系统都会处理这个问题，它与 Java 平台的内部结构无关。它是关于操作系统自己管理其进程和资源的。

# 更多信息

也可以看看：

*   [在异常 Exit 上清理资源](https://stackoverflow.com/questions/3809808/jvm-abnormal-exit-cleanup-of-system-resources)，也在 StackOverflow 上
*   [如何在 Java 中实现优雅终止](https://stackoverflow.com/questions/6029564/how-do-i-implement-graceful-termination-in-java)
*   [Java 理论与实践：良好的内务管理实践](http://www.ibm.com/developerworks/java/library/j-jtp03216/index.html)，IBM 开发人员系列

# javascript - Emacs 有问题的 JavaScript 缩进

> ID：10906228
> 
> 赞同：11
> 
> 时间：2012-06-05T23:06:10.413
> 
> 标签：javascript, emacs

我遵循[Douglas Crockford 的代码约定](http://javascript.crockford.com/code.html)，但我无法在 Emacs 的 JS 模式下获得正确的标识。我尝试自定义模式的缩进选项，尝试了其他模式，如 js3，但似乎没有任何效果。

当我有括号时，我必须打破表达式，Emacs 像这样缩进：

```
this.offices.each(this.addOfficesToMap,
                  this); 
```

虽然我遵循的约定说，当表达式被分解时，我应该只留下 4 个空格。所以缩进应该是这样的：

```
this.offices.each(this.addOfficesToMap,
    this); 
```

知道如何更改拆分表达式的缩进吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T14:41:59.243

您要更改的行为被硬编码到一个名为`js--proper-indentation`. 对您的问题的一个不优雅的解决方法是替换 .emacs 中的函数：

```
(require 'cl)

(eval-after-load "js" '(defun js--proper-indentation (parse-status)
 "Return the proper indentation for the current line."
 (save-excursion
   (back-to-indentation)
   (cond ((nth 4 parse-status)
          (js--get-c-offset 'c (nth 8 parse-status)))
         ((nth 8 parse-status) 0) ; inside string
         ((js--ctrl-statement-indentation))
         ((eq (char-after) ?#) 0)
         ((save-excursion (js--beginning-of-macro)) 4)
         ((nth 1 parse-status)
       ;; A single closing paren/bracket should be indented at the
       ;; same level as the opening statement. Same goes for
       ;; "case" and "default".
          (let ((same-indent-p (looking-at
                                "[]})]\\|\\_<case\\_>\\|\\_<default\\_>"))
                (continued-expr-p (js--continued-expression-p)))
            (goto-char (nth 1 parse-status)) ; go to the opening char
            (if (looking-at "[({[]\\s-*\\(/[/*]\\|$\\)")
                (progn ; nothing following the opening paren/bracket
                  (skip-syntax-backward " ")
                  (when (eq (char-before) ?\)) (backward-list))
                  (back-to-indentation)
                  (cond (same-indent-p
                         (current-column))
                        (continued-expr-p
                         (+ (current-column) (* 2 js-indent-level)
                            js-expr-indent-offset))
                        (t
                         (+ (current-column) js-indent-level
                            (case (char-after (nth 1 parse-status))
                              (?\( js-paren-indent-offset)
                              (?\[ js-square-indent-offset)
                              (?\{ js-curly-indent-offset))))))
              ;; If there is something following the opening
              ;; paren/bracket, everything else should be indented at
              ;; the same level.

      ;; Modified code here:
              (unless same-indent-p
                (move-beginning-of-line 1)
                (forward-char 4))
      ;; End modified code
              (current-column))))

         ((js--continued-expression-p)
          (+ js-indent-level js-expr-indent-offset))
         (t 0))))  ) 
```

我已经修改了函数底部的三行代码。如果您希望缩进为 8 个字符而不是 4 个，请`(forward-char 4)`相应地更改该行。

请注意，`js--proper-indentation`（和 js 库）需要 cl.el 库，但使用会搞砸`eval-after-load`。所以你需要`cl`在你的 .emacs 中明确地要求它才能工作。

请注意，此“解决方案”仅针对您指出的情况硬编码 4 个空格缩进，并且根本不处理嵌套代码。但是了解代码中处理您的情况的要点至少应该将您指向需要为更复杂的解决方案工作的位。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T02:18:47.773

你可以试试[https://github.com/mooz/js2-mode](https://github.com/mooz/js2-mode) ...它是一个 fork js2-mode，但有一些改进，比如良好的缩进......其他方式是阅读这篇文章：[http://mihai.bazon。 net/projects/editing-javascript-with-emacs-js2-mode](http://mihai.bazon.net/projects/editing-javascript-with-emacs-js2-mode) .. 但真诚地，最好替换旧的 js2-mode .. 它有几个改进[https://github.com/mooz/js2-mode/wiki/从原始模式更改](https://github.com/mooz/js2-mode/wiki/Changes-from-the-original-mode) ...希望这可以帮助您...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-25T14:17:16.373

[您可以在https://github.com/thomblake/js3-mode/issues](https://github.com/thomblake/js3-mode/issues)上提交关于 js3-mode 的功能请求

你有风格指南的链接吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T13:46:10.193

顺便说一句，虽然缩进约定因语言而异，而且用户之间的偏好甚至可能有所不同（例如在上述情况下），但存在相当多的重叠，并且通常有一些方法可以编写代码，使得几乎没有分歧。例如你上面的代码可以写成：

```
this.offices.each(
    this.addOfficesToMap,
    this
); 
```

或者

```
this.offices.each
    (this.addOfficesToMap,
     this); 
```

并且大多数缩进样式在如何缩进上基本一致。

# powershell - 从文件夹中选择最新文件并使用 powershell 脚本将其复制到另一个文件

> ID：10906231
> 
> 赞同：2
> 
> 时间：2012-06-05T23:06:47.073
> 
> 标签：powershell

我是 powershell 脚本的新手，需要一些帮助。

我们有一个文件夹`\Output`。它将具有以下格式的文件：

```
abc_1.dat
abc_2.dat
xyz_1.dat
abc_3.dat
pqr_2.dat
...... 
```

现在我想找到以“abc”开头的最新文件（例如，abc_3.dat）并将数据复制到abc.dat。xyz 和 pqr 也是如此。这些文件将继续添加。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T23:49:43.897

首先，您需要找到您的唯一前缀列表：

```
$prefixes = Get-ChildItem \Output | 
    Where-Object { -not $_.PsIsContainer } |
    Foreach-Object { $_.Name.Substring(0, 3) } |
    Select-Object -Unique 
```

然后，对于每个前缀，找到最新/最高的数字并将其复制到首选文件中：

```
$latest = $prefixes | 
    Foreach-Object { 
        Join-Path \Output "$_*" |
        Get-ChildItem |
        Add-Member NoteProperty -Name ID -Value { [int] ($_.BaseName -split '_')[1] } -PassThru |
        Sort-Object ID -Descending |
        Select-Object -First |
        Copy-Item -Destination \Output\$_.dat
    } 
```

# c - 将位域与 unsigned char 一起使用时发出警告

> ID：10906238
> 
> 赞同：7
> 
> 时间：2012-06-05T23:08:20.067
> 
> 标签：c

这是我的位域

```
struct {
    unsigned char v64 : 1;
    unsigned char leg : 7;
} valid; 
```

然后我收到警告：

```
main.c:17:3: warning: type of bit-field ‘v64’ is a GCC extension [-pedantic]
main.c:18:3: warning: type of bit-field ‘leg’ is a GCC extension [-pedantic] 
```

如果我更改`int`为没有警告。但我想要一个字节的位域（无符号字符）。

如何？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-05T23:16:31.593

`gcc` `-pedantic`如果您不想收到警告，请删除该选项。

在 C99 中，`gcc`发出警告，`-pedantic`但允许为位域（如`unsigned char`）具有实现定义的类型。

> （C99，6.7.2.1p4）“位域的类型应为 _Bool、signed int、unsigned int 或其他一些实现定义的类型的合格或非合格版本。”

在 C90 中，只允许`int`,`unsigned int`和`signed int`。

> （C90，6.5.2.1）“位域的类型应为 int、unsigned int 或 signed int 之一的合格或非合格版本”

实际上，在 C90 和 C99 中，C 都不需要警告（它只是 C90 中的未定义行为，但 C 不需要未定义行为的警告）。警告由`gcc`with添加，`-pedantic`仅供参考。

# java - 使用 Slick2D，如何在游戏过程中更改分辨率？

> ID：10906240
> 
> 赞同：2
> 
> 时间：2012-06-05T23:08:41.703
> 
> 标签：java, window, resolution, slick2d

我正在使用 Java 和 Slick2D API 开发基于图块的策略游戏。

到目前为止一切顺利，但我的选项菜单陷入了停顿。我计划让用户能够在游戏过程中更改分辨率（毕竟这很常见）。

我已经可以切换到全屏并回到窗口，这很简单......

```
//"fullScreenOption" is a checkbox-like button.
if (fullScreenOption.isMouseOver(mouseX, mouseY)) {
   if (input.isMouseButtonDown(Input.MOUSE_LEFT_BUTTON)) {
      fullScreenOption.state = !fullScreenOption.state;
      container.setFullscreen(fullScreenOption.state);
   }
} 
```

但是容器类（由 Slick 实现，不是我），与我之前的想法相反，似乎没有任何显示模式/分辨率更改功能！而且情况差不多……

我知道这是可能的，但我不知道负责的类是什么（如果存在的话）！

AppGameContainer 类，在游戏初始化开始时使用，是迄今为止我发现的唯一具有更改显示模式的函数的地方，但它仅在开始时使用，并且在 Slick 的教程中，被实现为本地。

```
//This is my implementation of it...
  public static void main(String[] args) throws SlickException {
    AppGameContainer app = new AppGameContainer(new Main());
//    app.setTargetFrameRate(60);
    app.setVSync(true);
    app.setDisplayMode(800, 600, false);
    app.start();
  } 
```

我可以将它定义为 Main 类上的静态全局，以便`update()`在选项屏幕的方法中使用它，但这可能是一种（非常）糟糕的方法......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-08-31T23:29:54.750

有一个简单的方法可以做到这一点。我在另一个网站上找到了这个。您可以将 GameContainer 对象（您从更新方法获得的对象）转换为 AppGameContainer 方法。然后您可以访问 setDisplayMode：

```
AppGameContainer gc = (AppGameContainer) container;
gc.setDisplayMode(800, 600, false); 
```

[原帖在这里。](https://gamedev.stackexchange.com/a/37243)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-31T15:43:13.470

在咨询了 gamedev.stackexchange 和 Slick2D 的论坛之后，我解决问题的措施是混合使用 @normalocity 的解决方案、ScalableGame 接口的使用，以及最重要的是，**编译我自己的 API 版本**（因为它是开源的）。

对 API 的更改包括但不限于更直接地访问 Container 的`setDisplayMode()`，解决了与此问题相关的问题。

对于任何有相同或相似问题的人，这是我建议的解决方案。

编辑注意：虽然我的回答仍然有效，而且我没有使用 Slick2D 进行开发，但从正面投票和缺乏指出任何问题的评论来看，@Requios 的回答是没有任何问题的更好方法。这就是我推荐的方法，因此我将“选择的答案”切换为他的，并投了我自己的赞成票。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-06T13:16:14.690

从理论上讲，您所要做的就是创建一个新`AppGameContainer`对象，然后重新运行所有初始化代码，除了重置游戏状态的代码（毕竟，您不希望游戏重置为其初始状态） ）。

你是对的，教程没有涵盖这一点，所以我认为你没有遗漏任何东西。以下是更改分辨率时必须处理的问题列表。只要您将它们分解为单独的方法，以便您可以`init`在游戏中的任何时间重新运行，那么您应该没问题。

*   您的`render`方法在确定要绘制的内容时，需要在每次执行时检查当前分辨率。换句话说，该`render`方法不应该关心当前的分辨率是什么 - 它应该每次都查找它，并做适当的事情。
*   如果您正在使用 Slick 按钮和其他 UI 事件，包括事件侦听器，那么在重新初始化所有内容之前，您需要获取所有订阅侦听器的列表，在 new 中重新初始化您的 UI 元素`AppGameContainer`，并拥有所有侦听器重新订阅新元素。
*   `init`分析您的代码并查找依赖于特定状态的 UI 的任何其他位置，并在分辨率更改时从该方法重新初始化它。

所以，这个的伪代码版本是：

**当您的游戏首次启动时**：

```
main(args)
  - initi()
    if (gameStartingForTheFirstTime())
      - initUI()
      - initGameState()
      - initWhateverElseYouNeedToForYourGame()
    if (resolutionChanging())
      - initUI() 
```

# replace - 只使用 Redis 而不是 RDBMS 有什么缺点？

> ID：10906246
> 
> 赞同：17
> 
> 时间：2012-06-05T23:10:14.873
> 
> 标签：replace, redis, scalability, rdbms

因此，例如，如果我正在尝试实现类似于 Facebook 的 Graph API 的东西，需要非常快速并支持数百万用户，那么仅使用 Redis 而不是 RDBMS 有什么缺点？

谢谢！乔纳森

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-06-06T11:35:17.797

使用 Redis 而不是经典的 RDBMS 有很多潜在的好处和潜在的缺点。他们确实是非常不同的野兽。

只关注潜在的缺点：

*   Redis 是一种内存存储：所有数据都必须适合内存。RDBMS 通常将数据存储在磁盘上，并将部分数据缓存在内存中。使用 RDBMS，您可以管理比内存更多的数据。使用 Redis，你不能。

*   Redis 是一个数据结构服务器。没有查询语言（只有命令），也不支持关系代数。您不能提交即席查询（就像您可以在 RDBMS 上使用 SQL 一样）。开发人员应该预见到所有的数据访问，并且必须设计适当的数据访问路径。失去了很多灵活性。

*   Redis 提供了 2 个持久性选项：常规快照和仅附加文件。它们都不像真正的事务服务器那样安全，提供重做/撤消日志记录、块校验和、时间点恢复、闪回功能等......

*   Redis 仅在实例级别提供基本安全性（在访问权限方面）。RDBMS 都提供细粒度的每个对象访问控制列表（或角色管理）。

*   唯一的 Redis 实例是不可扩展的。它仅以单线程模式在一个 CPU 内核上运行。要获得可扩展性，必须部署并启动多个 Redis 实例。分发和分片在客户端完成（即开发人员必须照顾它们）。如果将它们与唯一的 Redis 实例进行比较，大多数 RDBMS 提供了更高的可扩展性（通常在连接级别提供并行性）。它们是多处理的（Oracle、PostgreSQL、...）或多线程的（MySQL、Microsoft SQL Server、...），利用了多核机器。

在这里，我只描述了主要的缺点，但请记住，使用 Redis 也有很多好处（非常快、良好的并发支持、低延迟、协议流水线、易于实现乐观并发模式、良好的可用性/复杂性比, Salvatore 和 Pieter 的大力支持, 务实的严肃方法, ...)

对于您的特定问题（图表），我建议您查看专为存储面向图表的数据而设计的 neo4J 或 OrientDB。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-05-19T02:33:43.943

我有一些补充：redis 中存在值长度限制。使用redis的时候，总是想着自己的redis K,V大小，尤其是在redis集群中

# html - HTML5 多层，看不到低层

> ID：10906247
> 
> 赞同：0
> 
> 时间：2012-06-05T23:10:30.887
> 
> 标签：html, html5-canvas, layer

我试图实现一个具有多个画布层的简单游戏。问题是我只能看到“顶层”层。

[http://carmenbranje.com/games/untangle%20game%203/](http://carmenbranje.com/games/untangle%20game%203/)

为什么是这样？

非常感谢

卡门

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T00:07:40.787

最快的方式。（有一种更整洁的 CSS 方式）。在您的外部 CSS 文档中尝试以下操作。

```
#layers canvas{
left: 50%;
margin-left: -384px;
position: absolute;
}

#bg{ z-index:1; }
#guide{ z-index:2; }
#game{ z-index:3; }
#ui{ z-index:4; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T23:23:42.463

也许我错过了！但是您的画布上似乎没有 z 索引。这将解决您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T00:12:51.527

这个答案讨论了画布的背景不透明度：[jQuery 背景画布透明度](https://stackoverflow.com/questions/2389217/jquery-background-canvas-transparency) 这可能是缺少的吗？

# ruby-on-rails - 在 Windows 上安装 json gem 时出错

> ID：10906248
> 
> 赞同：1
> 
> 时间：2012-06-05T23:10:36.800
> 
> 标签：ruby-on-rails, ruby

我是 ruby​​ on rails 的新手，我正在尝试让我的第一个项目使用 git 和 heroku。我正在关注 Michael Hartl 的教程。我最初试图

```
git push heroku master 
```

但我没有 GemFile.lock，所以我一直在尝试捆绑安装和捆绑更新，但没有任何效果，因为我没有 json 本机 gem。

```
bundle update 
```

这是返回此错误的命令，它不是我遗漏了我已经拥有的所有宝石的整个错误

```
Installing json (1.7.3) with native extensions
Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.

        "C:/Program Files/ruby-1.9.3/bin/ruby.exe" extconf.rb
creating Makefile

make
Makefile:160: warning: overriding commands for target `C:/Program'
Makefile:153: warning: ignoring old commands for target `C:/Program'
C:/Program Files/ruby-1.9.3/bin/ruby -e "puts 'EXPORTS', 'Init_parser'"  > parser-i386
mingw32.def
/bin/sh: C:/Program: No such file or directory
make: *** [parser-i386-mingw32.def] Error 127

Gem files will remain installed in C:/Program Files/ruby-1.9.3/lib/ruby/gems/1.9.1/gems/json-1.7.3 f
or inspection.
Results logged to C:/Program Files/ruby-1.9.3/lib/ruby/gems/1.9.1/gems/json-1.7.3/ext/json/ext/parser/gem_make.out
An error occured while installing json (1.7.3), and Bundler cannot continue.
Make sure that `gem install json -v '1.7.3'` succeeds before bundling. 
```

如果有人知道如何修复我的错误以便我可以进入下一个错误，或者我如何获得一个有效的 GemFile.lock，我将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T23:23:10.310

`json_pure`而是安装在您的开发机器上。这是一个`json`不需要 C 扩展的 gem 版本（但速度有点慢）。

在 Heroku 上，您应该能够`json`直接使用更快的速度。

如果你想在 Windows 上构建 C 扩展，那么你可能想看这里：
['json' native gem requires installed build tools](https://stackoverflow.com/questions/8100891/the-json-native-gem-requires-installed-build-tools)

您可以像这样创建一个特定于 Windows 的部分`Gemfile`：

```
# Common gems
gem 'xyz'
...

# Platform specific gems
platforms :ruby do
  gem 'json'
end

platforms :mswin, :mingw do
  gem 'json_pure'
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T23:31:04.667

Windows 没有正确转义“C:\Program Files”中的空间。我有一段时间没有使用 Windows，但快速搜索会发现[一些](https://stackoverflow.com/a/10575692/913027) [修复](https://stackoverflow.com/a/8888645/913027)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T18:57:48.613

我遇到了同样的问题，发现在我的 config.yaml 文件中，安装了 Ruby 1.9.2，其中有一个空格。我必须完全卸载该版本的 Ruby，并将其从环境变量中的 PATH 中删除。然后，我重新安装了 DevKit，它运行良好。

# 8051 - 在 Intel 8031 上访问 dptr 的低字节

> ID：10906250
> 
> 赞同：0
> 
> 时间：2012-06-05T23:11:05.043
> 
> 标签：8051

`dptr`在为 Intel 8031/8051 微处理器编程时，有没有办法单独访问低/高字节？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T23:15:43.340

没关系，我想通了。寄存器名称是`dpl`和`dph`。

# knockout.js - 具有计算字段的淘汰赛映射

> ID：10906252
> 
> 赞同：5
> 
> 时间：2012-06-05T23:11:33.230
> 
> 标签：knockout.js, knockout-mapping-plugin

我正在从 WCF 服务获取数据，然后映射并将数据与我的 DOM 对象绑定：

```
var PayinyVM = {};

    $.getJSON('/service/PaidService.svc/PaidList', function (data) {
        var tmp = JSON.stringify(data.d);

        PayinyVM.model = ko.mapping.fromJSON(tmp);
        ko.applyBindings(PayinyVM);
    }); 
```

结果在我的 DOM 上显示为例外，将其绑定到模型。我找不到的是如何添加一些计算的 observable 假设我的数据返回的是 FirstName 和 LastName 的人，我怎样才能使用 FN + ' ' + LN 创建一个计算的 observable FullName。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-06T01:15:56.003

这是你的小提琴的工作副本，我不得不做出很多假设，因为你的小提琴甚至不是正确的 javascript，看起来很困惑，甚至没有提到淘汰赛

```
var PaidPeople = function(data) {
    var self = this;
    ko.mapping.fromJS(data, {}, this);
    this.fullName = ko.computed(function () {
                    return self.Name() + " : just ";
                });
}

var PayinyVM = function (data) {
                var self = this;

                ko.mapping.fromJS(data, {
                    'model' : {
                        create: function(options) {
                            return new PaidPeople(options.data);
                    }                        
                  }
                }, self);                
            };

var data = {model:[{__type: "PaidPeople:#model", Amount:110, Attendee:1, Name:'John'}]};

ko.applyBindings(new PayinyVM(data)); ​ 
```

和一个有效的小提琴：http: [//jsfiddle.net/qeUHd/](http://jsfiddle.net/qeUHd/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-05T23:20:34.077

您可以通过创建内部映射的模型对象来反转映射。

```
var PayinyVM = function (data) {
    var self = this;
    ko.mapping.fromJS(data, {}, self);
    this.fullName = ko.computed(function () {
        return self.Name() + " : just ";
    });
};

$.getJSON('/service/PaidService.svc/PaidList', function (data) {    
    ko.applyBindings(new PayinyVM(data.d));
}); 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-20T04:33:46.253

原来我必须在 javascript 中定义所有视图模型属性，以便敲除可以使用属性初始化视图模型，然后再用服务器数据更新它

参考：[http ://www.underwatergorilladome.com/how-to-use-knockouts-computed-observables-with-the-mapping-plugin/](http://www.underwatergorilladome.com/how-to-use-knockouts-computed-observables-with-the-mapping-plugin/)

[http://jsfiddle.net/GLDxx/2/](http://jsfiddle.net/GLDxx/2/)

```
var model = {
    username : ko.observable(),
    get_student_info : ko.mapping.fromJS(
        {
            usr_lname : null,
            usr_fname : null,
            gender : null,
            dob : null
        },
        {
            create: function(options) {
                return (new (function () {
                    this.name = ko.computed(function () {
                        if (this.usr_lname == undefined || this.usr_fname == undefined)
                            return null;
                        else
                            return this.usr_lname() + ' ' + this.usr_fname(); 
                    }, this);

                    // let the ko mapping plugin continue to map out this object, so the rest of it will be observable
                    ko.mapping.fromJS(options.data, {}, this);
                }));
            }
        }
    )
}; 
```

# facebook - 解释 FB.login 中的许多最内层循环以获取访问令牌？

> ID：10906260
> 
> 赞同：0
> 
> 时间：2012-06-05T23:12:51.260
> 
> 标签：facebook, facebook-authentication, facebook-authorization

我的朋友把它称为 lambda-calculus，尽管我知道一些 lambas——我仍然对授权如何真正地获取访问令牌感到困惑。

因此，请逐行解释这段代码。示例的来源在[这里](https://developers.facebook.com/docs/reference/javascript/FB.login/)。

```
 FB.login(function(response) {
   if (response.authResponse) {
     console.log('Welcome!  Fetching your information.... ');
     FB.api('/me', function(response) {
       console.log('Good to see you, ' + response.name + '.');
     });
   } else {
     console.log('User cancelled login or did not fully authorize.');
   }
 }); 
```

*[Ps在这里](https://stackoverflow.com/questions/10905476/fb-object-javascript-sdk-oaauth-2-0-and-graph-api-with-console-logs)尝试对事物进行分类，q 是一个子问题。*

> **也许相关**
> 
> 1.  [解释 Facebook access_token](https://stackoverflow.com/questions/9970381/explain-the-facebook-access-token)
>     
>     
> 2.  [Facebook 获取访问令牌](https://stackoverflow.com/questions/5088676/facebook-get-access-token)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T23:21:06.760

```
FB.login(function(response) { 
```

FB 是所有 Facebook 功能所在的地方。所有方法都在这里定义：[https](https://developers.facebook.com/docs/reference/javascript/) ://developers.facebook.com/docs/reference/javascript/ 。特别是登录将弹出一个对话框，要求用户登录或批准您的应用程序。

```
 if (response.authResponse) { 
```

如果他们批准了您的应用程序或已经添加了它，则 response.authResponse 将被填充。authResponse 还具有 accessToken、expiry 和 UserID。在此处查看更多详细信息：[https ://developers.facebook.com/docs/reference/javascript/FB.getLoginStatus/](https://developers.facebook.com/docs/reference/javascript/FB.getLoginStatus/)

```
 console.log('Welcome!  Fetching your information.... ');
     FB.api('/me', function(response) { 
```

这将转到 Facebook 以询问刚刚批准/登录您的应用的用户。现在您可以获取有关用户的基本信息。您需要获取权限的所有可用字段都可以在此处找到：[https ://developers.facebook.com/docs/reference/api/user/](https://developers.facebook.com/docs/reference/api/user/)

```
 console.log('Good to see you, ' + response.name + '.'); 
```

`/me`这只是从您从端点收到的用户对象中获取名称。

```
 });
   } else {
     console.log('User cancelled login or did not fully authorize.'); 
```

这意味着用户取消或未批准您的应用程序，因此您无法从 Facebook 获取他们的任何信息。

```
 }
 }); 
```

# ruby-on-rails-3 - Backbone.js Collection.models 不工作

> ID：10906264
> 
> 赞同：2
> 
> 时间：2012-06-05T23:13:38.287
> 
> 标签：ruby-on-rails-3, backbone.js, backbone.js-collections, hamlc

我有一个使用 Backbone.js 和 HAML 作为客户端模板语言的 Rails 项目。

在文件 app/assets/views/meeting.coffee 中：

```
class window.MeetingIndex extends Backbone.View

  template: JST['meeting/index']

  render: ->
    @collection.fetch()
    @$el.html(@template(collection: @collection))
    this 
```

在文件 app/assets/javascripts/templates/meeting/index.hamlc

```
- console.log(@collection.length) # prints 0 in console
- console.log(@collection.models) # prints [] in console
- console.log(@collection.at(0))  # prints undefined in console
- window.x =  @collection 
```

如果我转到浏览器控制台，我会得到：

```
x.length # returns 2
x.models # returns [Meeting, Meeting]
x.at(0)  # returns Meeting object 
```

如果我可以访问.hamlc 文件中的@collection 变量，因为我将它分配给window.x。为什么我无法从 .hamlc 文件访问 @collection 项目？

我需要类似的东西

```
- for model in @collection.models
  %p= model.get('landlord_id')
  %p= model.get('tenant_id')
  %p= model.get('at') 
```

去工作

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T23:56:27.713

该[`Collection#fetch`](http://backbonejs.org/#Collection-fetch)方法是异步的（即它是幕后的 AJAX 调用），因此`@collection.fetch()`当您尝试在视图中使用它时，还没有从服务器获得任何返回。然而：

> **选项**散列`success`和`error`回调将作为`(collection, response)`参数传递。当模型数据从服务器返回时，集合将重置。

所以你可以使用回调：

```
render: ->
  @collection.fetch(
    success: (collection, response) =>
      @$el.html(@template(collection: @collection))
  @ 
```

或者您可以将视图绑定`render`到集合的`reset`事件：

```
class window.MeetingIndex extends Backbone.View
  template: JST['meeting/index']
  initialize: ->
    @collection.on('reset', @render)
    @collection.fetch()
  render: =>
    @$el.html(@template(collection: @collection))
    @ 
```

然后，`fetch`视图中的调用将在从服务器返回某些内容时间接触`initialize`发正确的调用。`render`如果您的模板知道如何处理空集合，则此方法最有效，也许它可以检测到空集合并显示“正在加载”消息或只是说“这里还没有”。

# asp.net-mvc - orderBy() 的动态模型查询

> ID：10906267
> 
> 赞同：0
> 
> 时间：2012-06-05T23:13:52.263
> 
> 标签：asp.net-mvc, asp.net-mvc-3, c#-4.0, lambda

以下是否有等价物？

```
 // convert model to dynamic (this is how the model is coming in)
  IEnumerable<dynamic> dynmodel = (IEnumerable < dynamic >)Model;

  // dynamic lambda ???
  string col = "x.Name";
  var grid = new WebGrid(source: dynmodel.OrderBy(x => @col)); // Doesn't resolve but need an equivalent here!!! 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T23:17:15.843

有一个名为 Dynamic LINQ 的项目。

[http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)

# c# - Linq group by 创建嵌套列表视图

> ID：10906268
> 
> 赞同：3
> 
> 时间：2012-06-05T23:13:52.640
> 
> 标签：c#, linq, listview

我需要创建一个嵌套列表视图，并找到[了一篇](http://mattberseth.com/blog/2008/01/building_a_grouping_grid_with.html)关于如何做的好文章，但我的情况有点不同。我是 linq 新手，需要一点帮助：)

我需要将我的数据转换为与该文章类似的格式才能工作（在上面的链接上，搜索“配置 ListView”并查看其正上方的表格）。

这是我的数据：

```
Format    Movie Name    Price
DVD       Star Wars     12.99
DVD       Star Wars II  13.99
Blue-Ray  Star Wars     15.99
Blue-Ray  Star Wars II  17.99 
```

这是我所拥有的，并不是那么接近，但它是我所能得到的：

```
var MoviesToBuy = from Movie in dtMovieListDetails.AsEnumerable()
                    //join MovieDetails in dtMovieListDetails.AsEnumerable() on (string)Movie["ID"] equals (string)MovieDetails["ID"]
                    group Movie by new
                    {
                        Format = Movie["Format"],
                        Movies = Movie
                    } into grp

                    select new
                    {
                        Format = (string)grp.Key.Format,
                        Movies = grp.Key.Movies
                    };

        MoviesToBuy = MoviesToBuy.OrderBy(p => p.Format);

        lvwAmazonMovieGroup.DataSource = MoviesToBuy.ToList();
        lvwAmazonMovieGroup.DataBind(); 
```

我有 3 个具体问题/问题：

1.）我所拥有的不起作用。由于我在组中的第二列等于所有行，因此没有创建实际组。

2.) 尽管之前的问题，我也收到“数据源是无效类型。它必须是 IListSource、IEnumerable 或 IDataSource”错误。在这种情况下，Movies 列被创建为 DataRow 数据类型。不确定这是否是造成问题的原因。我能以某种方式在那个领域施法吗？

3.）我如何对电影中的字段进行排序。即最后我希望数据按格式排序，然后按电影名称排序，因此嵌套列表视图如下所示：

```
Blue-Ray
   Star Wars    12.99
   Star Wars II 13.99

DVD
   Star Wars    15.99
   Star Wars II 17.99 
```

任何点都非常感谢！

在此先感谢，乍得

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T23:53:06.677

我在想你可以从以下开始，调整正确的变量名和 AsEnumerable() 等。

它可以根据需要对您的电影进行排序，并根据您的要求将它们放入嵌套结构中：

```
var moviesToBuy = from movie in dtMovieListDetails
    orderby movie.Format, movie.Price
    group movie by movie.Format into grp
    select new
    {
        Format = grp.Key,
        Movies = grp.Select (g => new { MovieName = g.MovieName, Price = g.Price })
    }; 
```

[这是一个实现上述查询的示例程序。](http://ideone.com/iUj4F)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T23:33:18.910

尝试这样的事情：

```
var res = from m in movies
          group m by m.Format into grouped
          orderby grouped.Key
          select new
          {
              Format = grouped.Key, 
              Movies = grouped.AsEnumerable().OrderBy(x => x.MovieName) 
          }; 
```

或者

```
var res = from m in movies
          orderby m.MovieName
          group m by m.Format into grouped
          orderby grouped.Key
          select new
          {
              Format = grouped.Key, 
              Movies = grouped.AsEnumerable()
          }; 
```

使用这个种子数据：

```
var movies = new[] { 
    new Movie { Format = "DVD", MovieName = "SW1"},
    new Movie { Format = "Blue-ray", MovieName = "SW1"},
    new Movie { Format = "DVD", MovieName = "SW2"},

    new Movie { Format = "Blue-ray", MovieName = "SW2"},

    new Movie { Format = "DVD", MovieName = "RF"}
}; 
```

出品：

```
Format: Blue-ray
    Movie: SW1
    Movie: SW2
Format: DVD
    Movie: RF
    Movie: SW1
    Movie: SW2 
```

为了完整起见，我使用此代码生成上一个列表

```
foreach (var item in res)
{
    Console.WriteLine("Format: " + item.Format);

    foreach (var item2 in item.Movies)
    {
        Console.WriteLine("\tMovie: " + item2.MovieName);
    }
} 
```

# xcode - 编辑单元格后如何在表格视图中获取文本字段单元格的字符串值？

> ID：10906269
> 
> 赞同：0
> 
> 时间：2012-06-05T23:14:03.590
> 
> 标签：xcode, macos, cocoa

我有一个标准的表格视图，在我的主笔尖内具有默认设置。我使用数组控制器和绑定来处理表格视图应该向用户显示的数据。我已经实现了“添加”按钮插入新行并将第一列设置为编辑模式，以便用户可以立即键入他们的文本。我的问题是我无法检测到编辑何时结束，我应该保存新值。为此，我找不到任何委托方法和/或任何通知。我搜索了互联网，我找不到任何有用的东西。我什至不确定我做得对，我没有添加任何具体的东西，我只是使用表格视图为每个单元格提供的标准双击编辑。

任何帮助深表感谢。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T04:03:39.973

如果您将所有内容都与绑定挂钩，则在退出程序之前不需要保存数据。当数组控制器的 add: 方法被调用时，新记录被添加到控制器的排列对象中，保存数据的数组也被更新。因此，您只需要在应用关闭时保存数组。

但是，如果您希望在每次编辑后保存数据，您可以使用委托方法 controlTextDidEndEditing: 检测编辑的结束。在每列完成编辑后，您将收到通知（确保将实现此方法的类设为表视图的委托）。

# python - 使用 Python 一对一组合两个 PDF 列表

> ID：10906273
> 
> 赞同：0
> 
> 时间：2012-06-05T23:15:02.567
> 
> 标签：python, pdf, append, pypdf

我在 ESRI ArcMap 10 中使用数据驱动页面创建了一系列 PDF 文档（地图）。从单独的 *.mxd 生成的每个地图都有一个页面 1 和页面 2。因此，我有一份包含每张地图第 1 页的 PDF 文档列表和一份包含每张地图第 2 页的 PDF 文档列表。例如：Map1_001.pdf、map1_002.pdf、map1_003.pdf...map2_001.pdf、map2_002.pdf、map2_003.pdf...等等。

我想将这些地图（第 1 页和第 2 页）附加在一起，以便将第 1 页和第 2 页放在每个地图的一个 PDF 中。例如：mapboth_001.pdf、mapboth_002.pdf、mapboth_003.pdf...（它们不必进入新的 pdf 文件（mapboth），可以将它们附加到 map1）

对于每个 map1_ *.pdf 遍历目录并在文件名中的数字（* 所在的位置）匹配的地方附加 map2_ *.pdf

必须有一种方法可以使用 python 来做到这一点。也许结合了 arcpy、os.walk 或 os.listdir，以及 pyPdf 和 for 循环？

对于 os.walk(datadirectory) 中的 pdf：

```
 ?? 
```

有任何想法吗？感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T23:42:23.070

PDF 文件的结构与纯文本文件不同。简单地将两个 PDF 文件放在一起是行不通的，因为文件的结构和内容可能会被覆盖或损坏。您当然可以自己创作，但这需要相当多的时间，并且需要深入了解 PDF 的内部结构。

也就是说，我建议您查看[pyPDF](http://pybrary.net/pyPdf/)。它支持您正在寻找的合并功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T23:57:38.563

这应该正确地找到并整理所有要合并的文件；它仍然需要实际的 .pdf 合并代码。

**编辑：**我添加了基于[pyPdf 示例代码的 pdf 编写代码](http://pybrary.net/pyPdf/)。它没有经过测试，但应该（据我所知）可以正常工作。

**Edit2：**意识到我有地图编号十字路口；重新调整它以合并正确的地图集。

```
import collections
import glob
import re

# probably need to install this module -
#   pip install pyPdf
from pyPdf import PdfFileWriter, PdfFileReader

def group_matched_files(filespec, reg, keyFn, dataFn):
    res = collections.defaultdict(list)
    reg = re.compile(reg)
    for fname in glob.glob(filespec):
        data = reg.match(fname)
        if data is not None:
            res[keyFn(data)].append(dataFn(data))
    return res

def merge_pdfs(fnames, newname):
    print("Merging {} to {}".format(",".join(fnames), newname))

    # create new output pdf
    newpdf = PdfFileWriter()

    # for each file to merge
    for fname in fnames:
        with open(fname, "rb") as inf:
            oldpdf = PdfFileReader(inf)
            # for each page in the file
            for pg in range(oldpdf.getNumPages()):
                # copy it to the output file
                newpdf.addPage(oldpdf.getPage(pg))

    # write finished output
    with open(newname, "wb") as outf:
        newpdf.write(outf)

def main():
    matches = group_matched_files(
        "map*.pdf",
        "map(\d+)_(\d+).pdf$",
        lambda d: "{}".format(d.group(2)),
        lambda d: "map{}_".format(d.group(1))
    )
    for map,pages in matches.iteritems():
        merge_pdfs((page+map+'.pdf' for page in sorted(pages)), "merged{}.pdf".format(map))

if __name__=="__main__":
    main() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T19:52:00.687

在 googlecode 的 pdfrw 项目页面上有如何执行此操作的示例：

[http://code.google.com/p/pdfrw/wiki/ExampleTools](http://code.google.com/p/pdfrw/wiki/ExampleTools)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T23:37:32.240

我没有任何测试 pdf 可以尝试和组合，但我使用 cat 命令对文本文件进行了测试。你可以试试这个（我假设基于 unix 的系统）：merge.py

```
import os, re
files = os.listdir("/home/user/directory_with_maps/")
files = [x for x in files if re.search("map1_", x)]
while len(files) > 0:
    current = files[0]
    search = re.search("_(\d+).pdf", current)
    if search:
        name = search.group(1)
        cmd = "gs -q -dNOPAUSE -dBATCH -sDEVICE=pdfwrite -sOutputFile=FULLMAP_%s.pdf %s map2_%s.pdf" % (name, current, name)
        os.system(cmd)
    files.remove(current) 
```

基本上它会通过并获取 maps1 列表，然后通过并假设正确的文件并通过数字。（我可以看到使用计数器来执行此操作并用 0 填充以获得类似的效果）。

首先测试 gs 命令，我只是从[http://hints.macworld.com/article.php?story=2003083122212228](http://hints.macworld.com/article.php?story=2003083122212228)中获取的。

# delphi - 绝对数据库批量移动

> ID：10906274
> 
> 赞同：3
> 
> 时间：2012-06-05T23:15:06.017
> 
> 标签：delphi

我想使用批处理组件来归档表中的一些旧记录。我查看了 Ace components 网站上的示例，但不确定如何使用它。命令是：

```
DestinationTable.BatchMove(SourceTable,TABSBatchMoveType(bmtAppend)); 
```

对于我打算使用两个日期时间选择器的任务。所以查询会像参数一样：

```
SELECT * from MYTABLE where DATE BETWEEN :a1 and :a2
ABSTQuery1.Parameters.ParamByName ('a1').AsDate := DateTimePicker1.Date;
ABSTQuery1.Parameters.ParamByName ('a2').AsDate := DateTimePicker2.Date;
ABSQuery.ExecSql; 
```

如何将查询与 batchmove 命令合并？我希望所有检索到的记录都从我的源表移动到目标表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T02:35:56.630

Absolute Database`BatchMove`似乎是仿照旧的 BDE 建模的`TBatchMove`，它需要两个`TTable`组件；IIRC，它不适用于`TQuery`，但我可能记错了。（BDE 已经被弃用了十多年，从 Delphi 1 开始我就没有使用过它。）

不过，你不需要`BatchMove`。您可以使用单个查询完成所有操作（为简洁起见，省略了异常处理）：

```
// Copy rows into destination
ABSTQuery1.SQL.Text := 'INSERT INTO DestTable'#32 +
  '(SELECT * from MYTABLE where DATE BETWEEN :a1 and :a2)';
ABSTQuery1.Parameters.ParamByName ('a1').AsDate := DateTimePicker1.Date;
ABSTQuery1.Parameters.ParamByName ('a2').AsDate := DateTimePicker2.Date;
ABSTQuery1.ExecSql; 
ABSTQuery1.Close;

// Remove them from source (you said "move", after all)
ABSTQuery1.SQL.Text := 'DELETE FROM MyTable'#32 +
  `WHERE Date BETWEEN :a1 and :a2';
ABSTQuery1.Parameters.ParamByName ('a1').AsDate := DateTimePicker1.Date;
ABSTQuery1.Parameters.ParamByName ('a2').AsDate := DateTimePicker2.Date;
ABSTQuery1.ExecSql; 
ABSTQuery1.Close; 
```

替换`DestTable`为第一个 SQL 语句中的目标表的名称。

Absolute Database[在线手册中的更多信息](http://www.componentace.com/help/absdb_manual/insertstatement.htm)

我没有使用过绝对数据库，但如果他们的 SQL 支持包括脚本（我将把研究留给你 - 上面的文档链接）和多个语句，你可以一次性完成：

```
// Note addition of `;` at end of each SQL statement
// and change in param names for second statement.
// Some DBs will allow you to just use one pair, and
// set the value for each once. Some require setting
// each twice, and some require unique param names.
// Check the documentation for Absolute DB.
//
ABSTQuery1.SQL.Text := 'INSERT INTO DestTable'#32 +
  '(SELECT * from MYTABLE where DATE BETWEEN :a1 and :a2);'
  'DELETE FROM MyTable WHERE Date BETWEEN :d1 and :d2;';
ABSTQuery1.Parameters.ParamByName ('a1').AsDate := DateTimePicker1.Date;
ABSTQuery1.Parameters.ParamByName ('a2').AsDate := DateTimePicker2.Date;

// New param names for second pass
ABSTQuery1.Parameters.ParamByName ('d1').AsDate := DateTimePicker1.Date;
ABSTQuery1.Parameters.ParamByName ('d2').AsDate := DateTimePicker2.Date;
ABSTQuery1.ExecSQL;
ABSTQuery1.Close; 
```

# c - 未定义对 `std::ios_base::Init::Init()' 的引用

> ID：10906275
> 
> 赞同：84
> 
> 时间：2012-06-05T23:15:12.297
> 
> 标签：c, matrix, coredump

我写这段代码来读取 3 个文件，TM 是方阵的大小，LER 是数组的行数，从最后一个值定义一个非方阵 (ler/2)*2

然后...代码读取具有某些关系的文件，都是数字并分配给 C[ler]。

然后... C[ler] 被分配给 B[ler/2][2]。

B[ler/2][2] 中的每行坐标分配给 a 和 b。

a 和 b 是矩阵 A[tm][tm] 中要加 1 的行和列。

我的代码崩溃了，我看不到错误是什么。

当我尝试编译它时，编译器**gcc -g -o MatSim MatSim.cpp**提示：

```
/usr/include/c++/4.6/iostream:75: undefined reference to `std::ios_base::Init::Init()'
/usr/include/c++/4.6/iostream:75: undefined reference to `std::ios_base::Init::~Init()'
collect2: ld returned 1 exit status 
```

另外，当我尝试编译它时，编译器**f77 -o MatSim MatSim.cpp**提示：

```
/tmp/cc6ewlkf.o: In function `__static_initialization_and_destruction_0(int, int)':
MatSim.cpp:(.text+0x17ad4a): undefined reference to `std::ios_base::Init::Init()'
MatSim.cpp:(.text+0x17ad4f): undefined reference to `std::ios_base::Init::~Init()'
collect2: ld returned 1 exit status 
```

**解决方案**

主要问题是库问题，使用以下方法编译代码：

```
 g++ -g -o MatSim MatSim.cpp -lstdc 
```

还是行不通？安装库：

```
sudo apt-get install g++-multilib 
```

* * *

## 回答 #1

> 赞同：169
> 
> 时间：2012-06-06T01:46:42.050

您可以通过多种方式解决此问题：

*   使用`g++`代替`gcc`：`g++ -g -o MatSim MatSim.cpp`
*   添加`-lstdc++`：`gcc -g -o MatSim MatSim.cpp -lstdc++`
*   替换`<string.h>`为`<string>`

这是链接器问题，而不是编译器问题。问题[iostream linker error](https://stackoverflow.com/q/264057/1380680)涵盖了同样的问题——它解释了发生了什么。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-06-30T14:57:09.707

大多数这些链接器错误是由于缺少库而发生的。

我在我的 Project->Targets->Build Phases-> Link Binary With Libraries 中添加了**libstdc++.6.dylib 。**

这在 Xcode 6.3.2 for iOS 8.3 上为我解决了这个问题

干杯!

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-05-14T12:07:01.707

g++ 等价于 gcc -xc++ -lstdc++ -shared-libgcc

我在使用 sizeof() 方法时遇到了类似的错误。通过在 gcc 中使用 g++ 或更高版本的标签，可以编译代码。

# gradle - 如何在主项目之外的 gradle 中编译单个类依赖项

> ID：10906278
> 
> 赞同：2
> 
> 时间：2012-06-05T23:16:25.367
> 
> 标签：gradle

我有一个只包含 Selenium/TestNG 测试类的 gradle 项目。它们针对已部署的战争应用程序执行。一切正常，现在我添加了一个 java 实用程序，它将查询测试库并打印属于给定 TestNG 组的测试列表。该实用程序应与主项目分开编译和执行，因为用户可能希望在测试执行之前查询测试库。

我在 build.gradle 中添加了以下内容：

```
task listgroups(dependsOn:'buildUtil' ) <<{
    ant.java(classname: 'util.TestGroupScanner', fork: true,
            classpath: "src/test/java")
}

task buildUtil {
    compile {
        source = "src/test/java/util"
    }
} 
```

但是，当调用 listgroups 任务时，我收到以下错误：

```
C:\console-bg1>g listgroups

FAILURE: Build failed with an exception.
(...)

* What went wrong:
A problem occurred evaluating root project 'console-bg1'.
> Could not find method compile() for arguments [build_4emu7duna2isgubc1k8uts8k9
8$_run_closure6_closure11@d210ab] on root project 'console-bg1'. 
```

我不确定如何解决这个问题，不用说，到目前为止还没有在网上找到答案。任何指针表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T12:44:05.540

`buildUtil`正如错误所暗示的那样，问题出在任务中。`buildUtil`声明了一个`compile`闭包，但默认任务不存在这样的闭包。

让我试着澄清你的设置是什么。`util.TestGroupScanner`源代码位于`src/test/java/util`您希望与其他源代码分开编译的目录中（大概是and `src/main/java`）`src/test/java`。该`buildUtil`任务应该在 中编译源`src/test/java/util`，并且该任务在源文件夹`listgroups`上执行扫描器实用程序。`src/test/java`

在这种情况下，我建议您为实用程序源声明一个新的[源集](http://gradle.org/docs/current/userguide/java_plugin.html#N11AE8)，如下所示：

```
sourceSets {
  util {
    java {
       srcDir 'src/test/java/util'
    }
  }
} 
```

这将自动创建一个`compileUtilJava`为您调用的编译任务，该任务将编译这些源代码。我还认为您在执行工具时需要在类路径中包含实用程序类，可以通过`sourceSets.util.output.classesDir`. 所以现在你的`listgroups`任务看起来像：

```
task listgroups(dependsOn: 'compileUtilJava' ) <<{
  ant.java(classname: 'util.TestGroupScanner', fork: true,
           classpath: "src/test/java:" + sourceSets.util.output.classesDir)
} 
```

关于您的设置，我注意到的一件事是`src/test/java/util`源文件夹嵌套在`src/test/java`. Gradle 将假定`src/test/java`为您的项目测试的默认文件夹，因此会在运行测试时自动包含它及其所有子项。由于您希望将实用程序文件夹与默认设置分开，因此我建议您将其放入 中`src/testutil/java`，以避免任何冲突。如果这样做，请不要忘记`sourceSets`使用正确的源路径更新上面的设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T19:51:41.977

为了用 gradle 解决这个问题，我建议为你的 util 类创建一个特定的源集，并添加一个 JavaExec 类型的任务来执行这个类来打印你的 testng 组。看看下面的代码片段：

```
apply plugin:'java'
...
...
configurations{
    testUtilCompile.extendsFrom testCompile 
}

...
...
sourceSets{
    testUtil{
        java {
            srcDir "src/test/java"
            include "util/**"
        }
    }
}

task printGroups(type:JavaExec){
    main = "util.TestGroupScanner"
    classpath = sourceSets.testUtil.runtimeClasspath
} 
```

问候，勒内

# html - 如何使用 Ant 从 HTML 元素中提取属性？

> ID：10906279
> 
> 赞同：0
> 
> 时间：2012-06-05T23:16:30.773
> 
> 标签：html, ant

我有一个越来越复杂的 ANT 配置文件，现在我遇到了一个问题。其中一项任务从网站检索页面并将其保存到文件中。我需要加载这样的文件并从中提取特定元素的*href属性。*HTML 格式合理，但我不能保证。

我在想一个正则表达式，但不能保证元素的属性总是以相同的顺序出现（例如它的类名或 id）。此外，我还没有找到如何只返回*href属性的***值**，而没有属性本身。

 *我正在尝试限制要添加到 ANT 的插件数量，因此欢迎使用“自包含”解决方案。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T22:17:29.260

我不确定您将如何找到具有您要查找的 href 的特定 HTML 元素（我假设通过检查 id 属性，但您没有这么说）。我将这条正则表达式链放在一起，将 HTML 过滤为候选锚标记，然后最终只去除 href。我使用这个页面的源作为我的示例输入，因为我找不到任何与锚相关联的 id 属性（也有 href），我过滤到带有 class="question-hyperlink" 的锚——我是希望这对您来说是一个很好的起点（请注意：正如您所规定的，它不包含对其他模块等的任何依赖项，无论它们安装起来多么容易）：

```
<?xml version="1.0" encoding="UTF-8"?>
<project name="Test Html attribute" default="test" basedir=".">
   <target name="test">

      <loadfile srcFile="ant.htm" property="html">
         <filterchain>
            <linecontainsregexp>
              <regexp pattern="&lt;a.*href[^&gt;]*&gt;"/>
              <regexp pattern="&lt;a.*class=[&quot;']question-hyperlink[&quot;'][^&gt;]*&gt;"/>
            </linecontainsregexp>
            <tokenfilter>
               <replaceregex pattern=".*&lt;a.*href=[&quot;']?([^&gt;&quot;']*).*&gt;[^&lt;]*" replace="\1" flags="gi"/>
            </tokenfilter>
         </filterchain>
      </loadfile>

      <echo>${html}</echo>
   </target>
</project> 
```*

# c++ - 如何从屏幕上实际删除 QGraphicsItem？

> ID：10906284
> 
> 赞同：0
> 
> 时间：2012-06-05T23:17:01.863
> 
> 标签：c++, qt, qgraphicsitem, qt4.8

我有一个 QGraphicsItem （地图），其中有一些孩子（该地图上的图标）。到目前为止没有任何问题。

但是，我希望能够从屏幕上删除图标。为了做到这一点，我试图打破父子关系：

```
foreach(QGraphicsItem* item, displayedIcons) {
    item->setParentItem(NULL);
} 
```

在某种程度上，地图和图标彼此分离，即当我平移地图时，图标保持在屏幕上的绝对位置。但问题是，图标仍然显示。

为了从屏幕上实际删除图标，我有什么遗漏吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T23:32:26.570

使用[QGraphicsScene::removeItem()](http://qt-project.org/doc/qt-4.8/qgraphicsscene.html#removeItem)。

# windows - windows server 2008，如何使我的 asp.net mvc3 应用程序的文件夹可写？

> ID：10906287
> 
> 赞同：0
> 
> 时间：2012-06-05T23:17:29.223
> 
> 标签：windows, asp.net-mvc-3, windows-server-2008, folder-permissions

我有一个 asp.net mvc3 应用程序。它上传图像并调整其大小。我的上传文件夹，我需要使其可写。我尝试从 filezilla 执行此操作，将它们设置为 777，它不会工作。

我对我的 Windows 服务器具有 root 访问权限。我右键单击文件夹，选择属性，然后单击安全选项卡。我在那里看到4组。

创建者所有者，系统，管理员，用户。我应该从那里做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T00:00:02.727

我必须做类似的事情，但我使用文件夹作为临时位置，而不是图像的永久存放位置。为此，我在 app_data 文件夹中创建了一个新文件夹，并在其中进行了文件系统操作。

# node.js - 来自节点的出站 SSL 连接

> ID：10906288
> 
> 赞同：0
> 
> 时间：2012-06-05T23:17:35.607
> 
> 标签：node.js, ssl, https

我正在尝试从 Node 连接到使用 SSL 的服务器。当我连接到测试服务器时，连接有效，但不是我需要连接的实时服务器。

有谁知道 Node 是否需要某种配置来支持出站连接？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T10:02:46.880

我将节点升级到 0.8，这开始工作了。

# objective-c - 对于 iOS 纸牌游戏，这种洗牌算法是否足够随机？

> ID：10906289
> 
> 赞同：1
> 
> 时间：2012-06-05T23:17:39.943
> 
> 标签：objective-c, cocoa-touch, categories

不想只是发布，“嘿，伙计们，你能为我想出一个很棒的随机化方法吗？” 所以我整天都在研究洗牌、创建真正随机排列等的算法，这真的令人生畏。最后选择了一种更简单的方法，如下所示。虽然我确实想创建一个高质量的游戏，但当然，我不会在在线赌场或其他任何地方使用这个算法。这只是一个iOS游戏。那么，这种随机/内存效率是否足够？还是我应该为此付出更多的时间和精力？TIA

旁白：每当我写“TIA”时，我都会想，“这是非洲”，而不是“提前致谢”。

```
@implementation NSMutableArray (Shuffle)

-(void)shuffle
    {
        for (int i = [self count] - 1; i > 0; i--) {
            [self exchangeObjectAtIndex:(arc4random() % ([self count] - 1))
                      withObjectAtIndex:i];
        }
    }

    @end 
```

编辑：

好的。想要运行一些测试代码，所以我不会发布一些愚蠢的东西。:) 作为对 Adam 和 Nielsbot 的回应，您推荐的是更像这样的东西？

```
-(void)shuffle
{
    for (int i = [self count] - 1; i > 0; i--) {
        [self exchangeObjectAtIndex:(arc4random_uniform([self count] - 1))
                  withObjectAtIndex:i];
    }
} 
```

那正确吗？

像这样重复它会有什么好处吗？

```
-(void)shuffle
{
for (int i = [self count] - 1; i > 0; i--) {
    [self exchangeObjectAtIndex:(arc4random_uniform([self count] - 1))
              withObjectAtIndex:i];
}

for (int i = [self count] - 1; i > 0; i--) {
        [self exchangeObjectAtIndex:(arc4random_uniform([self count] - 1))
                  withObjectAtIndex:i];
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T23:22:37.713

这几乎就是所谓的[Fisher-Yates 算法](http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle)，它是 O(n)，因为时间复杂度和内存效率并不可观，因为您不分配任何东西。

我唯一要更改的是随机选择的索引，该索引将在`[0, i]`第 i 次迭代的范围内，而不是整个范围（以避免仅交换两个元素两次），然后它将成为我链接的算法。

# c# - 为什么visual studio代码分析警告我这个对象可以在这段代码中被处理两次（当它不能时）

> ID：10906292
> 
> 赞同：3
> 
> 时间：2012-06-05T23:18:18.550
> 
> 标签：c#, visual-studio-2010

代码是：

```
using (MemoryStream memorystream = new MemoryStream(bytes))
{
    using (BinaryWriter writer = new BinaryWriter(memorystream))
    {
        writer.Write((double)100.0);
    }
    return memorystream.ToArray();
} 
```

上面的代码不适合正确处理这两个对象吗？

代码分析有用吗？除了关于变量名称和命名空间的垃圾信息之外，它似乎抱怨了很多不现实的事情。我真的在想也许它很有用，我只是错过了重点。

可以解决 MemoryStream 是否被处理（不是）的问题，这是一个示例，其中 VS 代码分析给了我完全相同的警告。显然这里什么都没有处理

```
public class MyClass : IDisposable
{
   public void DoSomethingElse()
    {

    }

   #region IDisposable Members
   public void Dispose()
   {
       throw new NotImplementedException();
   }
   #endregion
}

public class MyOtherClass : IDisposable
{
    public MyOtherClass(MyClass mc)
    {

    }
    public void DoSomething() { }
}

public void Foo()
{
    using (MyClass mc = new MyClass())
    {
        using (MyOtherClass otherclass = new MyOtherClass(mc))
        {
            otherclass.DoSomething();
        }
        mc.DoSomethingElse();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T23:50:18.707

如果我猜的话，我会说分析规则的逻辑是确定一种可能性，如下所示：

*“您将一次性对象传递给另一个一次性对象的构造函数（因此在语义上暗示所有权的转移）。如果所有权确实被转移给第二个对象，它很可能会将传递给其构造函数的对象在其自己的 Dispose 方法，但你也在处理它。”*

你的第二个例子证明它实际上并没有分析第二个对象是否拥有并处置第一个对象，而是这个规则说这种模式有一些语义歧义，因为负责处置第一个对象的代码不再是清除。

dispose 模式具有 alloc/free 和 new/delete 的所有固有缺陷，因为只有一个类应该拥有并因此控制一次性实例的生命周期。

当然，所有纯粹的猜想，但这就是我的阅读方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T00:09:52.453

MemoryStream 包装了一个托管缓冲区，该缓冲区将在将来的某个时间被垃圾收集，无论它是否被处理掉。

IDisposable 实现是 Stream 合同的一部分。它会关闭流，阻止您使用 Read 和 Write 方法，但您仍然可以访问底层字节。（阻止对 ToArray 的调用可能会使其难以与 StreamWriters 一起使用。）使用像 FileStream 这样的非托管资源的 Stream 实现将在文件句柄被处理时释放文件句柄。

代码分析指出，您和 StreamWriter 都在同一个对象上调用 Dispose 并发出警告。这对于 MemoryStream 来说毫无意义，但对于其他一些 IDisposable 实现可能很危险。

您似乎将 IDisposable 接口与垃圾收集混淆了。调用 Dispose 不会释放托管对象，它只是让您的类有机会以确定的方式释放非托管资源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T23:40:18.337

关于“如果流已被处理，那么我该如何调用 memorystream.ToArray()”问题的一部分：

MemeoryStream.Dispose 不释放内部缓冲区。它所做的唯一一件事就是通过抛出“Object Disposed”异常来阻止所有 Stream 方法（如 Read）。即以下代码是完全有效的（通常可以为其他管理某种存储的其他 Stream 对象编写访问较低级别存储的类似代码）：

```
MemoryStream memoryStream = new MemoryStream();
using (memoryStream)
{
 // write something to the stream
}
// Note memoryStream.Write will fail here with an exception,
// only calls to get storage (ToArray and GetBuffer) make sense at this point.
var data = memoryStream.ToArray(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T00:23:58.760

BinaryWriter 不释放 MemoryStream。您需要处理它。在变量中获取 .ToArray 的结果，然后处理 MemoryStream，然后返回结果。或者使用 try/finally 来处理 MemoryStream。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-06-05T23:22:13.453

我想`BinaryWriter.Dispose()`会调用它的底层`MemoryStream`'s `.Dispose()`，然后你`using`会重新处理它。

至少我认为这会发生。我还没有打开源代码进行`BinaryWriter`验证，但我一直认为它关闭并处理了它的底层流。

* * *

*编辑：*

这是课程的来源。你可以看到你的内存流被处理在哪里：

*二进制流*：

```
 public BinaryWriter(Stream output) : this(output, new UTF8Encoding(false, true)) 
    {
    } 

    public BinaryWriter(Stream output, Encoding encoding)
    { 
        if (output==null)
            throw new ArgumentNullException("output");
        if (encoding==null)
            throw new ArgumentNullException("encoding"); 
        if (!output.CanWrite)
            throw new ArgumentException(Environment.GetResourceString("Argument_StreamNotWritable")); 
        Contract.EndContractBlock(); 

        OutStream = output; 
        _buffer = new byte[16];
        _encoding = encoding;
        _encoder = _encoding.GetEncoder();
    } 

    protected virtual void Dispose(bool disposing)
    { 
        if (disposing) 
            OutStream.Close();
    } 
```

*记忆流*：

```
 public class MemoryStream : Stream
    {
        ....
    } 
```

*溪流*

```
 public virtual void Close()
    {
        Dispose(true);
        GC.SuppressFinalize(this);
    } 
```

* * *

要回答您的另一个问题，“如果 MemoryStream 已被处理，为什么您仍然可以调用 .ToArray()”，那么，这个测试通过就好了：

```
 [TestMethod]
    public void TestDispose()
    {
        var m = new MemoryStream();
        m.WriteByte(120);
        m.Dispose();
        var a = m.ToArray();

        Assert.AreEqual(1, a.Length);
    } 
```

因此，该`.ToArray()`方法在 dispose 后仍然可以访问。

字节仍然可用。`MemoryStream`dispose 只是在内部设置了一些标志，以防止您进一步修改流：

```
 protected override void Dispose(bool disposing)
    { 
        try {
            if (disposing) {
                _isOpen = false;
                _writable = false; 
                _expandable = false;
                // Don't set buffer to null - allow GetBuffer & ToArray to work. 
            } 
        }
        finally { 
            // Call base.Close() to cleanup async IO resources
            base.Dispose(disposing);
        }
    } 
```

事实上，请注意来源中有评论：

```
// Don't set buffer to null - allow GetBuffer & ToArray to work. 
```

所以这真的回答了这个问题:)

# html - 如何在不使用图像的情况下显示正确和错误的标志

> ID：10906293
> 
> 赞同：0
> 
> 时间：2012-06-05T23:18:19.493
> 
> 标签：html, css

我正在开发 asp.net mvc 3 Web 应用程序，我需要在我的应用程序中查看绿色的正确标志和红色的错误标志，而不使用图像，所以这可能吗？，因为我在某些网站上注意到他们使用不同类型的标志但是你不能作为图像下载，这意味着它们被显示为文本或使用 Java 脚本......？BR

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T23:22:55.123

如果你想避免图像，你可以看看 Unicode Dingbats

[http://en.wikipedia.org/wiki/Dingbat](http://en.wikipedia.org/wiki/Dingbat)

例如：

✔ ✖</p>

然后，您可以只使用 CSS 来应用适当的颜色。

在您的用户群可能使用的浏览器上测试它们以确保它们正确呈现（并非所有浏览器都支持所有 Unicode 字符）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-05T23:33:28.387

请注意，并非所有浏览器都[支持这样的特殊字符](http://www.justwondering.co.nz/special-html-characters/)，但您可以轻松输出以下内容并使其在大多数情况下工作：

```
<p class='right'>&#10004;</p>
<p class='wrong'>&#10006;</p> 
```

相关CSS：

```
.right { 
 color: green;   
}
.wrong {
 color: red;   
}
​​ 
```

[http://jsfiddle.net/PaUaf/](http://jsfiddle.net/PaUaf/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T03:23:17.340

你也可以试试这个。 [http://nicolasgallagher.com/pure-css-gui-icons/](http://nicolasgallagher.com/pure-css-gui-icons/)如果你想避免使用图片。

# javascript - 如果标签已关闭，Javascript 正则表达式将匹配并替换标签括号

> ID：10906294
> 
> 赞同：0
> 
> 时间：2012-06-05T23:18:31.390
> 
> 标签：javascript, regex, replace

我正在将 html 复制到可在 keyup 上编辑的内容中，并且我希望将 html 转换为 html 标签。

contenteditable 创建实体。

我想我会使用 Javascript 替换 fn 并且它一直工作到现在。

这就是我所拥有的：

```
 replace(/&lt;(\w+)&gt;(.*)&lt;\/\1&gt;/gi,'<$1>$2</$1>') 
```

如果您将例如 a`<b></b>`放入 a中，就会出现问题`<p></p>`。当然由于内容一直在复制，所以只会替换p标签，而将b标签的括号留在实体中。知道如何解决这个问题吗？

# voip - GSM6.10 音频格式是基于块还是基于流？

> ID：10906305
> 
> 赞同：1
> 
> 时间：2012-06-05T23:20:29.360
> 
> 标签：voip, gsm, microsoft-acm

我可能问错了问题，但我在这方面的知识非常有限。

我正在使用`acmStreamConvert`将 PCM 转换为 GSM (6.10)。

音频格式：8khz，16 位，单声道

对于 PCM 缓冲区大小，我使用 640 字节（320 个样本）。对于 GSM 缓冲区，我使用 65 个字节。我的理解是 GSM“总是”将 320 个样本转换为 65 个字节。

我问“块或流”的原因是我想知道是否可以使用相同的 acmStreamConvert 句柄安全地转换多个音频流（实时）？`ACM_STREAMCONVERTF_START`我看到该函数有一些用于and`ACM_STREAMCONVERTF_END`和的标志`ACM_STREAMCONVERTF_BLOCKALIGN`，但是我是否需要将此开始/结束序列用于 GSM？我知道某些使用头/尾的格式可能需要这样做，但我希望 GSM 格式不需要这样做？

我正在开发一个组VOIP客户端，每个客户端发送GSM格式，然后需要转换为PCM才能播放。我希望每个客户不需要一个 ACM 句柄。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T15:41:05.780

基于流，或者至少是它的 ACM API 用法。尝试对多个流使用相同的 ACM 对象/句柄会产生不希望的结果。我怀疑这也意味着它不能像其他编解码器那样处理丢失的数据包（尚未确认该部分）。

# ruby-on-rails - rails link_to 自行打印

> ID：10906307
> 
> 赞同：1
> 
> 时间：2012-06-05T23:20:39.647
> 
> 标签：ruby-on-rails, link-to

我的 html 页面中有这个

```
<%= link_to "bla", "www.google.com" %> 
```

当我点击 localhost:3000 我得到这个

```
<%= link_to "bla", "www.google.com" %> 
```

PS：我是rails新手。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T23:37:04.297

确保您的视图文件名具有 html.erb 扩展名。

例如，对于 User 模型，模型位于 中`app/models/user.rb`，控制器位于 中`app/controllers/users_controller.rb`，显示视图位于 中`app/views/users/show.html.erb`。

我希望这有帮助。

# php - 如何将查询字符串传递给控制器

> ID：10906313
> 
> 赞同：0
> 
> 时间：2012-06-05T23:21:28.080
> 
> 标签：php, codeigniter

我有一个页面，其中包含来自数据库表的数据。在每一行的末尾，都有一个更新按钮，允许用户更新该特定行。我试图将 Id 作为只读输入，但是每当我在任何行上单击提交时，$this->input->post() 返回的值始终是最后一行 Id。我希望它返回我单击提交的 ID。

标识名称操作

```
echo form_open('control/edit');

foreach($rs as $db)
{
  $row = array(form_input('id', $db['id']), $db['name'], form_submit('update', 'Update'));
  $this->table->add_row($row);
}

echo $this->table->generate(); 
```

在控制/编辑控制器中，

```
$this->input->post('id') // always returns the id of the last row. 
```

有人知道我该怎么做吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T02:15:58.247

听起来它是作为引用调用传递的，而不是实际设置值，或者更简单地说，最后一行的输入名称“id”是 html 表单中的最后一次出现，这意味着它将是唯一一个得到post'd。

前任：

```
<input name="id" value="a" />
<input name="id" value="b" />
<input name="id" value="c" />
<input name="id" value="d" /> 
```

如果你点击提交，$this->input->post('id') = 'd';

尝试将您的 foreach 更改为：

```
... form_input("id[{$db['id']}]", $db['id'] ... 
```

然后，您的 $this->input->post('id') 将是一个数组，您可以通过单击的 id 获取键/值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T16:23:01.720

我建议将点击侦听器附加到您的更新按钮并添加一个字段。

场地：

并且 tablerows 的 javascript onclick 将是

```
onclick="document.getElementsByName('selectedRowId')[0].value = this.getElementsByTagName('input')[0].value" 
```

# jquery - 试图找到一个值不适用于变量

> ID：10906315
> 
> 赞同：1
> 
> 时间：2012-06-05T23:21:47.510
> 
> 标签：jquery, input

IDK，如果我只是忽略了某些东西，但我可以让它工作：

```
var scu = 0291285;
$('input[value=scu]').val('changed'); 
```

什么都没有发生，但是当我尝试时：

```
$('input[value=0291285]').val('changed'); 
```

值为 0291285 的输入发生变化。这种方法不会采用 var，如果是这样，是否有解决方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T23:24:26.053

jQuery 不知道`scu`您声明的局部变量。它认为您要查找`<input>`其值为字符串字面量的值`'scu'`。你要这个：

`$('input[value=' + scu.toString() + ']').val('changed');`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T23:26:03.500

你需要`stu`成为一个字符串来保持领先`0`：

```
var scu = '0291285'; 
```

然后，您需要在选择器中使用[连接运算符 (+)](https://developer.mozilla.org/en/JavaScript/Reference/Operators/String_Operators)，以使用变量中的值：

```
$('input[value=' + scu + ']').val('changed'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T23:24:56.850

```
$('input[value=' + scu + ']').val('changed'); 
```

# java - 基于 http 协议的 Chord p2p 分布式哈希表 (dht) 实现

> ID：10906321
> 
> 赞同：0
> 
> 时间：2012-06-05T23:22:32.237
> 
> 标签：java, protocols, p2p, dht, chord

我必须通过 http 实现 chord 协议作为我的项目，直到现在我已经考虑了三种方法：

1.  在java中使用jxta

2.  尝试编辑 open-chord [使用 tcp/ip]

3.  在 Java 中使用套接字从头开始编码

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T15:08:08.690

JXTA 是一个 DHT 加上很多很多其他的东西。JXTA 不会帮助您。它是一个“完成”的 P2P 库。

去吧，自己实现它。困难在于正确的和弦算法，而不是使用http的通信。破解（在正确的意义上）开放和弦或[无和弦](http://sourceforge.net/projects/chordless/)当然可以帮助你。

# python - Python：将主类传递给其他类是个坏主意吗？

> ID：10906327
> 
> 赞同：4
> 
> 时间：2012-06-05T23:23:20.210
> 
> 标签：python, class

我有一个主类，它包含程序的主循环和其他变量等。

```
class main:
    def __init__(self):
       blah = 'blah'
       blah2 = 'blah'
       blahhandler = BlahHandler.BlahHandler(self)
       blahhandler2 = BlahHandler.BlahHandler2(self)

    def mainloop(self):
       < IRRELEVANT JUNK > 
```

但是将“自我”传递给 blahhandlers 是一个坏主意，所以处理程序可以做一些事情，例如..

```
#In class 'BlahHandler'
self.main.blahhandler2.doBlah()
print(self.main.blah) 
```

还是我应该直接将 blahhandler2 传递给 blahhandler 而不是传递整个主类？抱歉，如果这只是因为听起来像“废话”而无法理解。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T23:34:03.487

`main`将您的对象传递给`BlahHandler`您当前正在做的事情并没有错。

哪个更好完全取决于您的对象实际代表什么。这里有几个问题可以帮助您入门：

*   `BlahHandler`a拥有自己对 a 的引用是否有意义`BlahHandler2`，或者当 a引用`BlahHandler`a时，`BlahHandler2`它是否总是引用`BlahHandler2`它`main`拥有的 a？
*   a`BlahHandler`真的应该引用 a `main`，还是`main`应该隐藏a 的属性`BlahHandler`？

在开发的早期就提出这样的关于结构的问题，仅仅因为你目前拥有的东西是有效的并且不是坏的做法，并不意味着它最有意义（但它可能！）。

不要担心从速度或内存的角度传递“整个主类”，你传递的只是一个参考。

# ruby - redis batsd (statsd) 计数器

> ID：10906332
> 
> 赞同：3
> 
> 时间：2012-06-05T23:24:34.890
> 
> 标签：ruby, nosql, redis, statsd

我将[batsd](https://github.com/noahhl/batsd)（其中使用`statsd`）库与[jeremy/statsd-ruby](https://github.com/jeremy/statsd-ruby)客户端一起用于我的 ruby​​ Web 应用程序（rails）。我必须保持简单的访问统计。伟大的！我使用`statsd.increment('users.visits')`上述 gem 中的方法。

然后我注意到，这个操作每次都创建新的`sorted set`（`zset`）并添加一个元素（看起来像`"1338932870<X>1`）。为什么`statsd`使用这种方法？[将HINCRBY](http://redis.io/commands/hincrby)方法与 simlpe 哈希（不是）一起使用会不会更容易和**更快**？`zadd``zset`

我知道，`statsd`是好的和知名的仪器，但我想知道，它是 redis 中的 counters 标准模式吗？我是redis和nosql的新手，谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T15:00:54.623

我不熟悉这个包，但是如果你只是使用 HINCRBY，你只会计算度量的最后一个值并将其保存在 Redis 中。我猜一个统计包可能需要存储指标的演变（以便随着时间的推移绘制图表或类似的东西）。

使用 zset 是一种存储按时间戳（即时间序列）排序的事件的方法，因此可以保留此度量标准的演变历史。它比仅仅保留最后一个值更慢并且消耗更多的内存，但是你有历史。有关完整故事，请参阅下面的诺亚评论。

使用 HINCRBY 或 INCRBY 实时聚合计数器，使用 zset 存储时间序列是两种常见的 Redis 模式。

# javascript - 如何按自定义顺序对 JavaScript 中的数组进行排序？

> ID：10906337
> 
> 赞同：1
> 
> 时间：2012-06-05T23:25:01.277
> 
> 标签：javascript, sorting

> **可能重复：**
> [如何对 javascript 对象数组进行排序？](https://stackoverflow.com/questions/979256/how-to-sort-an-array-of-javascript-objects)

好吧，更准确地说，我有以下课程：

```
function Location(name, latitude, longitude){
this.latitude = latitude;
this.longitude = longitude;
this.name = name;
} 
```

而且我想按与给定位置（像这样的类的对象）的接近顺序对这些对象的数组进行排序。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-05T23:29:29.463

您需要一个比较器功能：

```
function sortLocations(locations, lat, lng) {
  function dist(l) {
    return (l.latitude - lat) * (l.latitude - lat) +
      (l.longitude - lng) * (l.longitude - lng);
  }

  locations.sort(function(l1, l2) {
    return dist(l1) - dist(l2);
  });
} 
```

我不关心那里的平方根，因为我认为没有必要。此外，我没有考虑球面几何的任何奇怪之处，因为我再次认为这不值得复杂。但是，如果您有自己的现有方法来计算距离，则可以插入它而不是我上面键入的内容。

您只需将数组以及参考点坐标传递给该函数即可调用它。如果您想传递“位置”实例，则应该清楚要更改的内容。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-05T23:29:53.753

请参阅：[对 JavaScript 对象数组进行排序](https://stackoverflow.com/questions/979256/how-to-sort-an-array-of-javascript-objects)

另一个答案的简单 lat1-lat2 + lon1-lon2 公式即使对于数学二维平面也不正确，对于椭球地球更是如此。除非距离真的不需要准确，否则您应该使用半**正弦公式**作为排序函数。

来自：[http ://www.movable-type.co.uk/scripts/latlong.html](http://www.movable-type.co.uk/scripts/latlong.html)

```
var R = 6371; // km
var dLat = (lat2-lat1).toRad();
var dLon = (lon2-lon1).toRad();
var lat1 = lat1.toRad();
var lat2 = lat2.toRad();

var a = Math.sin(dLat/2) * Math.sin(dLat/2) +
        Math.sin(dLon/2) * Math.sin(dLon/2) * Math.cos(lat1) * Math.cos(lat2); 
var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
var d = R * c; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T23:28:09.113

您想将函数传递给`Array.prototype.sort`. [这个链接](http://www.javascriptkit.com/javatutors/arraysort.shtml)有一个很好的解释。我知道这不适用于球面几何，但你会想要这样的东西：

```
var home = new Location("Home", 40, -50);
arr.sort(function(a, b){
    var dist1 = Math.sqrt(Math.pow(home.latitude-a.latitude, 2) + Math.pow(home.longitude-a.longitude, 2)),
        dist2 = Math.sqrt(Math.pow(home.latitude-b.latitude, 2) + Math.pow(home.longitude-b.longitude, 2));
    if (dist1 < dist2) { 
        return -1;
    }
    else {
        return 1;
    }
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-05T23:31:12.180

```
function Location(name, latitude, longitude){
this.latitude = latitude;
this.longitude = longitude;
this.name = name;
};

this.locations.push(new Location());

 this.locations.sort(function (a, b) { return a.latitude - b.latitude ; }); 
```

您需要将您的位置存储在一个数组中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-05T23:40:01.660

```
Location.distance = function ( loc1, loc2 ) {
    return Math.sqrt(
        Math.pow( loc2.longitude - loc1.longitude, 2 ) +
        Math.pow( loc2.latitude - loc1.latitude, 2 )
    );
};

Location.prototype.sortByProximity = function ( arr ) {
    var that = this;
    arr.sort(function ( a, b ) {
        return Location.distance( that, a ) - Location.distance( that, b );
    });
}; 
```

首先，您有一个静态函数`Location.distance`，它接受两个`Location`实例并返回一个表示它们相对距离的值。

其次，您有一个`sortByProximity`方法，该方法作为`Location`实例上的方法调用，并且需要一个`Location`实例数组作为其第一个参数。

用法：

```
baseLocation.sortByProximity( locArr );
// locArr is now sorted in regard to baseLocation 
```

**现场演示：http:** [//jsfiddle.net/hGp66/](http://jsfiddle.net/hGp66/)

# vb.net - .net 使控制台 exe 隐藏？

> ID：10906339
> 
> 赞同：0
> 
> 时间：2012-06-05T23:25:47.080
> 
> 标签：vb.net

我正在使用 Windows Task Scheduler Wrapper 在 .net 桌面应用程序中安排任务（基本上每两分钟左右启动一个 exe 控制台）。

但是，我不希望它每 5 分钟甚至一次弹出控制台。

我该如何隐藏它？

我知道如果我使用 vb.net 来启动 exe，我可以做几件事。但是，我正在使用 Windows 任务调度程序来启动它。在这种情况下你有什么建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T23:37:20.437

控制台应用程序仅在计划在您的帐户下运行时才会显示。只需创建一个新帐户，并安排它在该帐户下运行。

# twitter-bootstrap - 如何使用 Twitter 的 Bootstrap 显示内联列表

> ID：10906341
> 
> 赞同：246
> 
> 时间：2012-06-05T23:26:31.103
> 
> 标签：twitter-bootstrap

我想使用 Bootstrap 显示内联列表。我可以从 Bootstrap 添加一个类来实现这一点吗？

* * *

## 回答 #1

> 赞同：589
> 
> 时间：2013-09-01T22:30:15.417

**引导程序 2.3.2**

```
<ul class="inline">
  <li>...</li>
</ul> 
```

**引导程序 3**

```
<ul class="list-inline">
  <li>...</li>
</ul> 
```

**引导程序 4**

```
<ul class="list-inline">
  <li class="list-inline-item">Lorem ipsum</li>
  <li class="list-inline-item">Phasellus iaculis</li>
  <li class="list-inline-item">Nulla volutpat</li>
</ul> 
```

来源：http: [//v4-alpha.getbootstrap.com/content/typography/#inline](http://v4-alpha.getbootstrap.com/content/typography/#inline)

更新链接[https://getbootstrap.com/docs/4.4/content/typography/#inline](https://getbootstrap.com/docs/4.4/content/typography/#inline)

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2013-10-28T03:51:41.047

根据 2.3.2 和 3 的 Bootstrap 文档，该类应该这样定义：

**引导程序 2.3.2**

```
<ul class="inline">
  <li>...</li>
</ul> 
```

**引导程序 3**

```
<ul class="list-inline">
  <li>...</li>
</ul> 
```

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2012-12-23T00:48:24.780

虽然 TheBrent 的回答总体上是正确的，但它并没有回答如何以官方引导方式进行操作的问题。bootstrap 的标记很简单：

```
<ul class="inline">
  <li>1</li>
  <li>2</li>
  <li>3</li>
</ul> 
```

[来源](http://twitter.github.com/bootstrap/base-css.html)

[http://jsfiddle.net/MgcDU/4602/](http://jsfiddle.net/MgcDU/4602/)

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2016-07-29T13:59:33.730

完成雷蒙德的回答

**引导程序 2.3.2**

```
<ul class="inline">
  <li>...</li>
</ul> 
```

**引导程序 3**

```
<ul class="list-inline">
  <li>...</li>
</ul> 
```

**引导程序 4**

```
<ul class="list-inline">
  <li class="list-inline-item">Lorem ipsum</li>
  <li class="list-inline-item">Phasellus iaculis</li>
  <li class="list-inline-item">Nulla volutpat</li>
</ul> 
```

来源：http: [//v4-alpha.getbootstrap.com/content/typography/#inline](http://v4-alpha.getbootstrap.com/content/typography/#inline)

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2012-06-05T23:40:40.893

我在 bootstrap.css 文件中找不到任何具体内容。因此，我将 css 添加到自定义 css 文件中。

```
.inline li {
    display: inline;
} 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2016-10-12T10:03:19.437

我很惊讶，list-inline 在 bootstrap 4 中不起作用，最后我在 bootstrap 4 文档中得到了它。

**引导程序 3 和 4**

```
<ul class="list-inline">
  <li class="list-inline-item">Lorem ipsum</li>
  <li class="list-inline-item">Phasellus iaculis</li>
  <li class="list-inline-item">Nulla volutpat</li>
</ul> 
```

**来源：http:** [//v4-alpha.getbootstrap.com/content/typography/#inline](http://v4-alpha.getbootstrap.com/content/typography/#inline)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-08-28T06:58:52.710

该解决方案使用 Bootstrap v2 工作，但在 TBS3 中使用 INLINE 类。我还没有弄清楚 TBS3 中的等效类（如果有的话）是什么。

这位先生有一篇很好的文章，介绍了 v2 和 v3 之间的区别。

[http://mattduchek.com/differences-between-bootstrap-v2-3-and-v3-0/](http://mattduchek.com/differences-between-bootstrap-v2-3-and-v3-0/)

编辑 - 使用 CSS 来定位`li`元素以解决您的问题，如下所示

```
 { display: inline-block; } 
```

在我的情况下，我的目标是 UL，而不是 LI

```
 nav ul li { display: inline-block; } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-10-08T08:03:34.533

[引导程序 5](https://getbootstrap.com/docs/5.1/components/list-group/#horizontal)：

```
<ul class="list-group list-group-horizontal">
  <li class="list-group-item">An item</li>
  <li class="list-group-item">A second item</li>
  <li class="list-group-item">A third item</li>
</ul> 
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2013-02-16T14:31:40.057

内联实际上不是我们可能需要的内联 - 即 display:inline

就我观察者而言，Bootstrap inline 更像是水平方向

要显示与其他元素内联的列表，我们确实需要

```
display: inline; added to the UL

<ul class="unstyled inline" style="display:inline"> 
```

注意 // 添加到样式表

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2013-04-16T13:38:50.020

根据 Bootstrap 文档，您需要将“内联”类添加到您的列表中；像这样：

```
<ul class="inline">
    <li>Item one</li>
    <li>Item two</li>
    <li>Item three</li>
</ul> 
```

但是，这不起作用，因为 Bootstrap CSS 文件中似乎缺少一些引用类“内联”的 CSS。因此，另外，将以下行添加到您的 CSS 文件中以使其工作：

```
ul.inline > li, ol.inline > li {
    display: inline-block;
    padding-right: 5px;
    padding-left: 5px;
} 
```

# google-app-engine - Appengine 查询返回没有匹配的索引 - 对象化

> ID：10906349
> 
> 赞同：1
> 
> 时间：2012-06-05T23:28:08.517
> 
> 标签：google-app-engine, gql, objectify

我有一些实体，我希望对其进行祖先查询并通过“>”运算符过滤参数。有问题的实体继承了另一个对象（我认为这不重要）。以下是我的实体类：

```
@Indexed
public class ValidatedObject {

public Long timeCreated=System.currentTimeMillis();
public Long timeUpdated=System.currentTimeMillis();

public Long getTimeUpdated() {
    return timeUpdated;
}
public void setTimeUpdated(Long timeUpdated) {
    this.timeUpdated = timeUpdated;
}
public Boolean validated=false;
@Unindexed
public String validatedID;
@Unindexed
private Long validatedTime;
@Unindexed
private String creatorID;

public Long getTimeCreated() {
    return timeCreated;
}
public void setTimeCreated(Long timeCreated) {
    this.timeCreated = timeCreated;
}
public boolean isValidated() {
    return validated;
}
public void setValidated(boolean validated) {
    this.validated = validated;
}
public String getValidatedID() {
    return validatedID;
}
public void setValidatedID(String validatedID) {
    this.validatedID = validatedID;
}
public Long getValidatedTime() {
    return validatedTime;
}
public void setValidatedTime(Long validatedTime) {
    this.validatedTime = validatedTime;
}
public String getCreatorID() {
    return creatorID;
}
public void setCreatorID(String creatorID) {
    this.creatorID = creatorID;
}

}

@Cached
@Entity
public class PersonnelInfo extends ValidatedObject{

  @Id
  public String keyName; 

@Parent Key<Department> department;
private Long fdID;

@Unindexed
private String userKeyName;

private String firstName;
private String lastName;
@Unindexed
private String address,city,county,state;
@Unindexed
private String cellPhone,homePhone,otherPhone;

public PersonnelInfo(){

}
public PersonnelInfo(String email){
    keyName=email;
}

@Override
public Long getTimeUpdated() {
    return timeUpdated;
}
@Override
public void setTimeUpdated(Long time) {
    timeUpdated=time;
}

} 
```

我的查询代码如下：

```
Query<PersonnelInfo> q = ofy.query(PersonnelInfo.class).ancestor(tmp).filter("timeUpdated >",     lastSync); 
```

我每次都收到“找不到匹配的索引”错误。没有过滤器，查询工作正常。一些实体缺少“timeUpdated”字段，因为我更改了架构。有些实体是在架构更改后使用 timeUpdated 值创建的，并且它们不会被返回。我也可以像这样在数据存储查看器上执行 GQL 查询：

选择 * where FROM PersonnelInfo timeUpdated > 0

并且我返回了实体，这让我相信索引已创建。我在这里做错了什么？任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T17:55:25.790

您需要在 datastore-indexes.xml 中定义一个多属性索引。当您在开发模式下运行查询时，它应该被添加到 datastore-indexes-auto.xml，但结果应该如下所示：

```
<datastore-index kind="PersonnelInfo" ancestor="true">
    <property name="timeUpdated" direction="asc"/>
</datastore-index> 
```

# c# - 无法从 Collection 获取更改通知到绑定到 LINQ 查询的 UI 控件

> ID：10906351
> 
> 赞同：0
> 
> 时间：2012-06-05T23:28:14.053
> 
> 标签：c#, linq, binding, inotifypropertychanged, inotifycollectionchanged

我正在尝试使用刚刚学习的 LINQ 解决一个简单的问题。

我有一个字符串集合，在这种情况下代表串行端口，它们将显示在控件中，但必须排序。原始集合是未排序的，我不一定要修改它，或者复制它。因此，我创建了一个 IEnumerable 类型的属性并将其绑定到一个 ComboBox。

这很好用，ComboBox 具有正确顺序的正确内容。但是，如果原始集合发生更改，则 a) 当原始集合更改时，ComboBox 没有得到正确通知，或者 b) LINQ 查询没有被刷新。

在尝试了一些不同的事情之后，我看不出下面的代码是如何工作的。我肯定错过了什么。

这里可能有多余的额外代码......无论如何，源代码后面是控件的 XAML：

```
public partial class MainWindow : Window
{
    ObservableCollection<string> original = new ObservableCollection<string>();
    public ObservableCollection<string> OriginalList {
        get { return (original); }
    }

    private IEnumerable<string> _portList;
    public IEnumerable<string> PortList {
        get { return (_portList); }
    }

    public MainWindow() {
        InitializeComponent();

        original.Add("COM5");
        original.Add("COM1");
        original.Add("COM3");
        original.Add("COM4");
        original.Add("COM2");

        original.CollectionChanged += new NotifyCollectionChangedEventHandler(OriginalChanged);

        _portList = (
            from port in original
            orderby port ascending
            select port
        );

        DataContext = this;
    }

    private void AddPortButton_Click(object sender, RoutedEventArgs e) {
        original.Add("COM2.5");
    }

    void OriginalChanged(Object sender, NotifyCollectionChangedEventArgs args) {
        NotifyPropertyChanged("PortList");
    }

    public event PropertyChangedEventHandler PropertyChanged;
    private void NotifyPropertyChanged(String info) {
        if (PropertyChanged != null) {
            PropertyChanged(this, new PropertyChangedEventArgs(info));
        }
    }
} 
```

XAML：

```
 <ComboBox Name="SerialPortListBox" ItemsSource="{Binding PortList}" Width="100" />
    <ComboBox Grid.Row="1" Name="OriginalListBox" ItemsSource="{Binding OriginalList}" Width="100" Margin="0,5,0,0"/>
    <Button Grid.Column="1" Name="AddPortButton" Content="Add Port 2.5" Width="100" Margin="10,0,0,0" Click="AddPortButton_Click" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T23:40:36.033

我认为您只能通过将 ComboBox 绑定到**ObservableCollection**来获得所需的更改通知。此类实现接口**INotifyCollectionChanged**，这是 WPF 内部依赖于通知 UI 需要更新的接口。

我看到您正试图通过为 PortList 实施*INotifyPropertyChanged*来解决此问题，但这不会按您想要的方式工作。该界面不会触发适当的事件来触发组合框刷新。INotifyCollectionChanged 告诉侦听器*集合*发生了变化（即“添加”、“删除”、“移动”、“替换”、“重置”），而 INotifyPropertyChanged 仅指示绑定对象中的某些值已更改。ComboBox 不会响应 INotifyPropertyChanged 事件，实际上它可能甚至没有订阅该类型的事件。

因此，要么直接绑定到底层数据源，要么在此之上实现第二个 ObservableCollection，而不仅仅是一个不通知更改的 IEnumerable。

# python - django模板过滤器更改评估顺序

> ID：10906353
> 
> 赞同：0
> 
> 时间：2012-06-05T23:28:42.547
> 
> 标签：python, django, django-templates, django-template-filters

有没有办法改变 django 评估模板过滤器的顺序？

说我有

```
{{ 3|add:5|multiply:"10" }} 
```

现在他加了 3+5 并将结果乘以 10。

我正在寻找的是一种执行以下操作的方法：

```
{{ 3|add:(5|multiply:"10") }} 
```

如您所见，我将`5|multiply:"10"`括号括在括号中以强调它应该在`|add`. 这可能吗 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T01:42:03.423

你有两种可能：

您可以更改过滤器/值的顺序：

```
{{ 5|multiply:10|add:3 }} 
```

或者您可以使用`{% with %}`：

```
{% with temp=5|multiply:10 %}
    {{ 3|add:temp }}
{% endwith %} 
```

# c# - 从动态文本框获取价值

> ID：10906356
> 
> 赞同：0
> 
> 时间：2012-06-05T23:29:02.227
> 
> 标签：c#, asp.net, textbox

我有一些数组来保存我的控件。当调用函数初始化数组并将我的控件保存在数组中时。

代码：

```
private Label[] lblName;
    private TextBox[] txtName;
    private Label[] lblSurname;
    private TextBox[] txtSurname;
    private Label[] lblInstitution;
    private TextBox[] txtInstitution;
    private Label[] lblCountry;
    private TextBox[] txtCountry;
    private Label[] lblEmail;
    private TextBox[] txtEmail;
    private PlaceHolder PlaceHolder1;

    public int NumberOfOtherAuthors()
    {
        Int32 index = Convert.ToInt32(NumberList.SelectedValue);
        return index;
    }

    public void GUIofOtherAuthor()
    {
        int authors;
        int i = 0;
        int j = 1;

        authors = NumberOfOtherAuthors();
        lblName = new Label[authors];
        txtName = new TextBox[authors];
        lblSurname = new Label[authors];
        txtSurname = new TextBox[authors];
        lblInstitution = new Label[authors];
        txtInstitution = new TextBox[authors];
        lblCountry = new Label[authors];
        txtCountry = new TextBox[authors];
        lblEmail = new Label[authors];
        txtEmail = new TextBox[authors];
        PlaceHolder1 = new PlaceHolder();

        for (i = 0; i < authors; i++)
        {
            Label authorInformation = new Label();
            authorInformation.Text = "Information for Author " + j.ToString() + " :";

            lblName[i] = new Label();
            lblName[i].Text = "Name:";
            txtName[i] = new TextBox();
            lblSurname[i] = new Label();
            lblSurname[i].Text = "Surname:";
            txtSurname[i] = new TextBox();
            lblInstitution[i] = new Label();
            lblInstitution[i].Text = "Institution:";
            txtInstitution[i] = new TextBox();
            lblCountry[i] = new Label();
            lblCountry[i].Text = "Country:";
            txtCountry[i] = new TextBox();
            lblEmail[i] = new Label();
            lblEmail[i].Text = "Email:";
            txtEmail[i] = new TextBox();

            PlaceHolder1.Controls.Add(new LiteralControl("<table>"));
            PlaceHolder1.Controls.Add(new LiteralControl("<span style=\"font-weight:bold;\" "));
            PlaceHolder1.Controls.Add(authorInformation);
            PlaceHolder1.Controls.Add(new LiteralControl("</span>"));
            PlaceHolder1.Controls.Add(new LiteralControl("<tr><td>"));
            PlaceHolder1.Controls.Add(lblName[i]);
            PlaceHolder1.Controls.Add(new LiteralControl("</td><td>"));
            PlaceHolder1.Controls.Add(txtName[i]);
            PlaceHolder1.Controls.Add(new LiteralControl("</td></tr>"));
            PlaceHolder1.Controls.Add(new LiteralControl("<tr><td>"));
            PlaceHolder1.Controls.Add(lblSurname[i]);
            PlaceHolder1.Controls.Add(new LiteralControl("</td><td>"));
            PlaceHolder1.Controls.Add(txtSurname[i]);
            PlaceHolder1.Controls.Add(new LiteralControl("</td></tr>"));
            PlaceHolder1.Controls.Add(new LiteralControl("<tr><td>"));
            PlaceHolder1.Controls.Add(lblInstitution[i]);
            PlaceHolder1.Controls.Add(new LiteralControl("</td><td>"));
            PlaceHolder1.Controls.Add(txtInstitution[i]);
            PlaceHolder1.Controls.Add(new LiteralControl("</td></tr>"));
            PlaceHolder1.Controls.Add(new LiteralControl("<tr><td>"));
            PlaceHolder1.Controls.Add(lblCountry[i]);
            PlaceHolder1.Controls.Add(new LiteralControl("</td><td>"));
            PlaceHolder1.Controls.Add(txtCountry[i]);
            PlaceHolder1.Controls.Add(new LiteralControl("</td></tr>"));
            PlaceHolder1.Controls.Add(new LiteralControl("<tr><td>"));
            PlaceHolder1.Controls.Add(lblEmail[i]);
            PlaceHolder1.Controls.Add(new LiteralControl("</td><td>"));
            PlaceHolder1.Controls.Add(txtEmail[i]);
            PlaceHolder1.Controls.Add(new LiteralControl("</td></tr>"));
            PlaceHolder1.Controls.Add(new LiteralControl("</table><br /> "));
            Panel1.Controls.Add(PlaceHolder1);

            j++;
        }
    } 
```

现在我想在另一个函数中获取文本框的值`public void UploadForm(){...}`。我试试

```
int i;
int numberOfOtherAuthors = NumberOfOtherAuthors();

for(i=0; i<numberOfOtherAuthors; i++)
{
   String a = txtname[i].text
} 
```

我想上传到数据库的文本框值，但假设我们将它们保存到一个字符串中。当我这样做时，我有 NullReferenceException。那么如何获取这个文本框的值？？？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T02:14:48.147

我注意到您的`UploadForm()`函数正在引用`txtname`，而您的实际 TextBox 被声明为`txtName`. 由于字段名称区分大小写，因此实际上并未定义字段“txtname”（小写“n”），因此它可能是动态页面中出现 NullReferenceException 的原因。

# mysql - 是否可以获得围绕特别匹配的结果的一系列结果？

> ID：10906357
> 
> 赞同：1
> 
> 时间：2012-06-05T23:29:04.987
> 
> 标签：mysql

我意识到我可以在代码中做到这一点，但我很好奇除了您的查询匹配的结果之外，是否还有一种直接的 SQL 方法来选择（例如）10 个结果......

所以，假设我有一个所有球员都有分数的数据库，我想向用户展示分数落后于他们的 5 名球员和领先的 5 名球员......所以，我选择了他们的行，但现在我应该只使用或在 where 子句中并说类似...

```
select score as selectedScore from player_scores where playerId = xxxx
or (score > selectedScore - 5 and score < selectedScore + 5) 
```

我意识到这意味着所有分数都是按确切顺序排列的，我会修改查询以从这些分数中提取 userId，所以这只是一个伪示例。

我怀疑这会起作用，但这是处理这个问题的正确方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T23:32:24.230

您可以使用[`UNION`](http://dev.mysql.com/doc/en/union.html)组合两个查询，分别使用`ORDER BY`和`LIMIT`选择下一个 5 和前 5 个；通过在每个查询中使用自连接，可以找到与所需玩家分数相邻的所有其他玩家（但这假设它`playerId`是唯一的`player_scores`）：

```
(
  SELECT   p1.playerId, p1.score
  FROM     player_scores AS p1 JOIN player_scores AS p2 ON p1.score >= p2.score
  WHERE    p2.playerId = ?
  ORDER BY p1.score ASC
  LIMIT    6
) UNION ALL (
  SELECT   p1.playerId, p1.score
  FROM     player_scores AS p1 JOIN player_scores AS p2 ON p1.score <  p2.score
  WHERE    p2.playerId = ?
  ORDER BY p1.score ASC
  LIMIT    5
) 
```

# c++ - 在 C++ 中解析行命令时，是否需要单独的 `int name()` 函数进行解析？

> ID：10906358
> 
> 赞同：1
> 
> 时间：2012-06-05T23:29:06.003
> 
> 标签：c++, parsing

我正在使用 UCI 协议设计一个国际象棋游戏。该程序需要行命令作为输入。

我的问题是我是否需要一个与解析这些命令的函数分开的`main()`函数，以及如何获取解析的输入？我意识到这`char* argv`是在函数参数中命名的，但我发现 using`argv = cin.get()`不起作用。

我看过很多教程，但没有一个回答任何一个问题。

如果措辞不好，我也很抱歉。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T23:31:43.373

我可以建议非神话编程：

```
#include <string>
#include <vector>

int main(int argc, char**argv)
{
    const std::vector<std::string> args(argv, argv+argc);

    // be merry and use `args`

} 
```

**更新**嗯。我猜你的意思是控制台/标准输入。在这种情况下，读取循环可能就是您想要的：

```
std::string line;
while (std::getline(std::cin, line))
{
     // process command in line
} 
```

# windows - 通过 ssh 从 cygwin 托管的存储库克隆到 Mac 和 FreeBSD 客户端时出现“(.hg not found)”

> ID：10906360
> 
> 赞同：4
> 
> 时间：2012-06-05T23:29:12.587
> 
> 标签：windows, macos, mercurial, clone, freebsd

我在一台 Windows 服务器上运行一个归档文件系统，该服务器执行自动异地复制，这使它成为托管 Mercurial 存储库并确保其安全性的理想场所。该文件系统仅适用于 Windows，因此我别无选择，只能使用 Windows 作为主机操作系统。

**设置：**

服务器（'ungoliant'，在我的网络内部）：

*   Windows 7 主存储库主机。
*   Cygwin ssh 守护进程。
*   汞 1.9.3
*   使用“hg init”在 Windows 上创建了新的存储库“/cygdrive/j/mercurial/rcstudio”。

客户：

*   Mac OSX 10.7.4 运行 hg 2.1.2
*   FreeBSD 8.3 运行 hg 2.1.2

客户端问题（在 Mac 和 FreeBSD 上相同）：

```
$ hg clone ssh://cjp@ungoliant//cygdrive/j/mercurial/rcstudio
running ssh cjp@ungoliant 'hg -R /cygdrive/j/mercurial/rcstudio serve --stdio'
remote: abort: There is no Mercurial repository here (.hg not found)!
abort: no suitable response from remote hg! 
```

我已经确认路径和 URI 是正确的。那里**绝对有**一个“.hg”目录：

```
$ ls -la
total 0
drwxr-xr-x   3 cjp  staff   102 Jun  5 17:41 .
drwxr-xr-x  41 cjp  staff  1394 Jun  5 16:30 ..
$ scp -r cjp@ungoliant:/cygdrive/j/mercurial/rcstudio/.hg .
$ ls -la
total 0
drwxr-xr-x   3 cjp  staff   102 Jun  5 17:41 .
drwxr-xr-x  41 cjp  staff  1394 Jun  5 16:30 ..
drwxr-xr-x   5 cjp  staff   170 Jun  5 17:41 .hg
$ ls -la .hg
total 16
drwxr-xr-x  5 cjp  staff  170 Jun  5 17:41 .
drwxr-xr-x  3 cjp  staff  102 Jun  5 17:41 ..
-rw-r--r--  1 cjp  staff   57 Jun  5 17:41 00changelog.i
-rw-r--r--  1 cjp  staff   33 Jun  5 17:41 requires
drwxr-xr-x  2 cjp  staff   68 Jun  5 17:41 store 
```

我发现了很多stackoverflow问题，其中问题是格式不正确的ssh URI ...我的格式正确并描述了绝对路径。

我已确认以下所有内容：

*   hg 命令在服务器上和通过 ssh 都可以正常运行。
*   如果我粘贴绝对路径，我可以通过 ssh 确认 .hg 目录的存在。
*   其他通过 ssh 手动发出的 hg 命令成功（例如：ssh cjp@ungoliant 'cd /cygdrive/j/mercurial/rcstudio; hg diff;'）。
*   在主机上，我可以从相同的绝对路径本地克隆。

我被难住了。Mercurial 文档听起来像是 2.1.2 应该能够从 1.9.3 父级克隆，所以它似乎不是版本冲突。

非常感谢您的帮助！谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-10T19:04:02.330

我最终得到的是一种解决方法，而不是答案。

我自己对远程 ssh 命令处理的无知导致了误解。如果我要 ssh 到机器，“which hg”会导致 cygwin 感知二进制文件“/usr/bin/hg”，但是如果我执行远程命令“ssh cjp@ungoliant 'which hg'”，它会返回路径到我也在该机器上安装的 Windows 二进制文件。

我使用了我的 .bashrc 文件，但无法执行远程命令来确定 cygwin 二进制文件的优先级。PATH 甚至不包括 Windows PATH 条目，所以我开始解决这个问题并最终决定停止与之抗争。

从那以后，我放弃了整个想法，因为我相信即使我让它发挥作用，它也将是一个微妙的组合，根本不值得我花时间在它上面。我现在将我的存储库托管在一个 BSD 机器上，并且我在 Windows 机器上有一个 cron，它每 24 小时从该存储库拉到归档文件系统一次。它很简单，就像一个零问题的魅力。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-25T09:02:23.897

我有同样的问题，通过添加选项--remotecmd 解决了这个问题

`hg clone --remotecmd /usr/bin/hg ssh://me@mywindowspc//cygdrive/m/hgrepo`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-21T10:06:03.350

当您尝试 scp 时，您将执行以下操作：

```
scp username@ipaddr:/cygdrive/d/test/foo.txt ./myDestFolder 
```

不幸的是，这对 hg 不起作用。而是尝试：

```
hg clone ssh://username@ipaddr/D:/testRepo 
```

# java - 是否可以让 SWT 使用 OS X 本机选项卡？

> ID：10906361
> 
> 赞同：2
> 
> 时间：2012-06-05T23:29:15.517
> 
> 标签：java, macos, swt

我正在开发一个 SWT 应用程序，虽然我非常欣赏 SWT 与其他 Java 工具包相比的外观，但我对“选项卡”的实现方式感到失望。我正在寻找的是 OS X 显示这些选项卡的本机方式，我希望在 SWT 中有一种方法可以做到这一点。这是我的应用程序标签现在的样子：

![在此处输入图像描述](../Images/f164d6c97005d58c7a7c9f41521d3cdb.png)

这是我想要完成的一个例子：

![在此处输入图像描述](../Images/b1582eb7cd3518ec5f61168b9da034a0.png)

我也更喜欢一种在其他平台上看起来也很原生的方式（这正是我使用 SWT 的原因）。但是，如果有特定于 OS X 的方法，那可能会起作用，因为我已经为每个平台分别提供了代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T14:04:16.400

上面的截图是 SWT 的图片`CTabFolder`，它避开了原生的小部件并绘制了自己的选项卡。由于 SWT 倾向于提供一种最小公分母方法来包装本机小部件，`CTabFolder`因此可以提供本机选项卡不一定提供的功能。

如果您更喜欢本机选项卡，就像您在第二个屏幕截图中看到的那样，您可以使用 a[`TabFolder`](http://help.eclipse.org/indigo/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/api/org/eclipse/swt/widgets/TabFolder.html)来实现。

# ruby - 在 Ruby 中指定哈希值的默认值

> ID：10906362
> 
> 赞同：4
> 
> 时间：2012-06-05T23:29:17.733
> 
> 标签：ruby

假设我有一个名为 person 的哈希，其键是名称，值是具有键“年龄”和“爱好”的哈希。哈希人中的条目看起来像

```
=> person["some_guy"] = {:hobby => "biking", :age => 30} 
```

我将如何为哈希“人”指定默认值？我尝试了以下

```
=> person.default = {:hobby => "none", :age => 20} 
```

但它不起作用。

编辑：

我正在设置一个属性并期望其他属性被自动填充。例如。

```
=> person["dude"][:age] += 5 
```

这就是我所看到的

```
=> person["dude"]
=> {:hobby => "none", :age => 25} 
```

这很好。但是，`person`在提示符下输入，我得到一个空哈希。

```
=> person
=> {} 
```

然而，我所期待的是

```
=> person
=> {"dude" => {:hobby => "none", :age => 25}} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-06T00:15:39.913

### 为什么它可能不适合你

如果对象没有该方法，则不能调用 Hash#default。您需要确保`person.is_a? Hash`在它起作用之前。你确定你没有数组吗？

还值得注意的是，哈希默认值不会填充任何内容。它只是缺少键时返回的值。如果您创建一个键，那么您仍然需要填充该值。

### 为什么它对我有用

```
# Pass a default to the constructor method.
person = Hash.new({hobby: "", age: 0})
person[:foo]
=> {:hobby=>"", :age=>0}

# Assign a hash literal, and then call the #default method on it.
person = {}
person.default = {hobby: "", age: 0}
person[:foo]
=> {:hobby=>"", :age=>0} 
```

### 你可能想要什么

由于散列默认值仅适用于缺失的键，而不是缺失的值，因此如果要填充散列的散列，则需要采用不同的方法。一种方法是将块传递给哈希构造函数。例如：

```
person = Hash.new {|hash,key| hash[key]={hobby: nil, age:0}}
=> {}

person[:foo]
=> {:hobby=>nil, :age=>0}

person[:bar]
=> {:hobby=>nil, :age=>0}

person
=> {:foo=>{:hobby=>nil, :age=>0}, :bar=>{:hobby=>nil, :age=>0}} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T23:38:07.970

*您可以通过将默认值传递给.new*方法，在实例化时指定哈希的默认值：

```
person = Hash.new({ :hobby => '', :age => 0 }) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-19T11:34:20.460

您可以使用`Hash#default_proc`动态初始化具有默认值的哈希。

```
h = Hash.new
h.default_proc = proc 做 |散列，键|
  hash[key] = Hash.new(0) 除非 hash.include? 钥匙
结尾
h[0][0] # => 0
h[1][0] # => 0
h[0][0] = 1
h[0][0] # => 1
h[1][0] # => 0

```

# performance - Nginx 性能问题

> ID：10906363
> 
> 赞同：2
> 
> 时间：2012-06-05T23:29:29.180
> 
> 标签：performance, wordpress, nginx

我的网站存在性能问题。我的配置是 ubuntu 11.04 上带有 wordpress/nginx/php-fpm 的 1G VPS。瓶颈是浏览器等待来自服务器的第一个字节。启动连接后等待服务器的第一个响应需要 4-6 秒（该网站是新网站，它接收的流量非常低，大约 50-150 访问/天）。以下是我的 nginx conf，我希望它可以帮助理解问题出在哪里。我想知道这个配置是否有问题可以优化。另外，如果有人可以推荐我使用适合我的配置的分析/分析工具。

注意：我将我的用户名替换为`myusername`，我的域替换为`mydomain.com`

`nginx.conf`

```
user myusername;
worker_processes 4;
pid /var/run/nginx.pid;

events {
    worker_connections 768;
    # multi_accept on;
}

http {

        index index.php index.html index.htm;

    sendfile on;
    # tcp_nopush on;
    tcp_nodelay on;
    keepalive_timeout 5;
    types_hash_max_size 2048;
    # server_tokens off;

    # server_names_hash_bucket_size 64;
    # server_name_in_redirect off;

    include /etc/nginx/mime.types;
    default_type application/octet-stream;

    client_max_body_size 50m;

    access_log /var/log/nginx/access.log;
    error_log /var/log/nginx/error.log;

    gzip on;
    gzip_disable "msie6";

    # gzip_vary on;
    # gzip_proxied any;
    # gzip_comp_level 6;
    # gzip_buffers 16 8k;
    # gzip_http_version 1.1;
    # gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript;

    ##
    # Virtual Host Configs
    ##

    include /etc/nginx/conf.d/*.conf;
    include /etc/nginx/sites-enabled/*;
} 
```

`sites-enabled/default`

```
server {

    listen   80; ## listen for ipv4; this line is default and implied
    listen   [::]:80 default ipv6only=on; ## listen for ipv6
root /home/myusername/www;

# Make site accessible from http://localhost/
server_name mydomain.com;

location / {
    # First attempt to serve request as file, then
    # as directory, then fall back to index.html
    try_files $uri $uri/ /index.php;
}

location /doc {
    # root /usr/share;
    autoindex on;
    allow 127.0.0.1;
    deny all;
}

location /images {
    # root /usr/share;
    autoindex off;
}

error_page 404 = @wordpress;
log_not_found off;

location @wordpress {
        fastcgi_pass 127.0.0.1:9000;
        fastcgi_param SCRIPT_FILENAME $document_root/index.php;
        include /etc/nginx/fastcgi_params;
        fastcgi_param SCRIPT_NAME /index.php;
}

location ^~ /files/ {
        rewrite /files/(.+) /wp-includes/ms-files.php?file=$1 last;
    }

# redirect server error pages to the static page /50x.html
#
#error_page 500 502 503 504 /50x.html;
#location = /50x.html {
#   root /usr/share/nginx/www;
#}

# proxy the PHP scripts to Apache listening on 127.0.0.1:80
#
#location ~ \.php$ {
#   proxy_pass http://127.0.0.1;
#}

# pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000
#
location ~ \.php$ {
        try_files $uri @wordpress;
        fastcgi_index index.php;
        fastcgi_pass 127.0.0.1:9000;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        include /etc/nginx/fastcgi_params;
}

# deny access to .htaccess files, if Apache's document root
# concurs with nginx's one
#
location ~ /\.ht {
    deny all;
}
location ^~ /blogs.dir/ {
        internal;
        root /home/myusername/www/wp-content;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T20:31:42.653

看起来像一个 Wordpress 网站，我更倾向于它是那里的性能问题，而不是 nginx 配置本身。

一些建议：

1 - 确保您已安装并启用 APC

2 - 安装服务器端缓存插件（W3 Total Cache 或 Supercache）并将其配置为使用 APC 作为后备存储（并打开所有缓存层）

[就分析器而言，我是NewRelic](http://newrelic.com/)的忠实粉丝，他们的 Pro 级别在前 2 周是免费的（通常足够长以找到热点），基本性能信息永远免费。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-25T04:00:30.853

看来您的 nginx 配置确实有很大的改进空间。Nginx 在利用 CPU 和内存方面已经非常高效。但是，我们可以根据计划服务的工作负载类型调整几个参数。如果我们主要服务于静态文件，我们希望我们的工作负载配置文件对 CPU 的密集程度更低，并且更面向磁盘进程。实际上，只要 nginx 的本质是面向最高性能的，你的 nginx.conf 应该不是问题，但正如你所说，你根本没有得到 nginx 良好的性能。

我还运行一个 1GB - 1 个核心 VPS，运行全新的 LEMP 安装（Ubuntu 14.04、nginx、MySQL、php5-fpm，没有其他人会考虑消耗内存，例如 cPanel、Zpanel 等，没有 phpMyAdmin 以及（我使用 MySQL Workbench 应用程序）。因此，我已经启动并运行了一个没有任何缓存插件甚至 APC/memcached 方案的 WordPress 站点（仍在研究适合我需要的最佳方法），而且我总是有出色的性能。

无论如何，下面设置的 nginx.conf 仍然是一个非常基本的调整，以提高 nginx 性能。这是我用来服务我的网站的当前 nginx.conf 文件的副本。我在这里分享给大家，仅供参考。您可以根据自己的研究进一步对其进行调整，但我相信您在尝试后肯定会注意到整体增强。

那么让我们来看看吧……

**调整 nginx**

**确定 Nginx worker_processes 和 worker_connections**

我们可以将单线程 Worker 进程的数量配置为 CPU 内核数量的 1.5 到 2 倍，以利用磁盘带宽 (IOP)。

确保在 /etc/nginx/nginx.conf 中使用正确数量的 worker_processes。这应该等于下面命令输出中的 CPU 内核数量（在您的终端应用程序上执行）：

`cat /proc/cpuinfo | grep processor`

在我的例子中，下面的结果只显示了一个处理器

```
root@server1:~# cat /proc/cpuinfo | grep processor
processor : 0
root@server1:~# 
```

所以我的机器只有1个处理器可用，然后我设置

```
[...]
worker_processes 1;
[...] 
```

我已经评论了应该调整的大部分重要部分，再次，您应该研究并开始构建适合您的工作/生产环境的自己的配置。我们不涉及任何缓存技术或通过 ssl (https) 安全连接为站点提供服务，只是简单的基本 nginx 配置。

```
user nginx;

# Set the number of worker processes
# You can also set it to "auto" to let Nginx decide the right number
worker_processes 1;
pid /var/run/nginx.pid;

events {
 # Increase worker connections
 worker_connections 1024;
 # Accept() as many connections as possible
 # More information http://wiki.nginx.org/EventsModule
 multi_accept on;

 # Serve many clients with each thread (Linux)
 use epoll;
}

http {

     include /etc/nginx/mime.types;
     default_type application/octet-stream;
     log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
          '$status $body_bytes_sent "$http_referer" '
          '"$http_user_agent" "$http_x_forwarded_for"';

     # Let NGINX get the real client IP for its access logs
     set_real_ip_from 127.0.0.1;
     real_ip_header X-Forwarded-For;

##
# Basic Settings
##

    # Tweak TCP connections handling
sendfile on;
tcp_nopush on;
tcp_nodelay on;

    # Increase keepalive timeout
keepalive_timeout 65;

    # Reset timedout connections and free up some memory
    reset_timedout_connection on;

    # Other buffers/timeouts optimizations
    #if you want to allow users to upload files with a bigger size, consider increasing client_max_body_size to whatever fits your needs
    client_max_body_size 20m; 
    client_body_timeout 60;
    client_header_timeout 60;
    client_body_buffer_size  8K;
    client_header_buffer_size 1k;
    large_client_header_buffers 4 8k;
    send_timeout 60;
    reset_timedout_connection on;
types_hash_max_size 2048;
    # Hide Nginx version
server_tokens off;

 server_names_hash_bucket_size 128;
#server_name_in_redirect off;

include /etc/nginx/mime.types;
default_type application/octet-stream;

##
# Logging Settings
##
    # Disable access log to boost I/O on HDD
    # Enabling access_log off; on the web server can save a lot of I/O as well as CPU power.

access_log off;
access_log /var/log/nginx/access.log;
error_log /var/log/nginx/error.log;

    # Log Format

    log_format main '$remote_addr - $remote_user [$time_local] ' '"$request" $status $body_bytes_sent "$http_referer" ' '"$http_user_agent" "$http_x_forwarded_for"';

##
# Gzip Settings
##
    # Enable GZIP compression to save bandwidth
gzip on;
gzip_disable "msie6";
gzip_vary on;
gzip_proxied any;
    gzip_comp_level 6;
gzip_buffers 16 8k;
gzip_http_version 1.1;
    gzip_types text/css text/javascript text/xml text/plain text/x-component application/javascript application/x-javascript application/json application/xml application/rss+xml font/truetype application/x-font-ttf font/opentype application/vnd.ms-fontobject image/svg+xml;

include /etc/nginx/conf.d/*.conf;
include /etc/nginx/sites-enabled/*;
} 
```

我希望它可以帮助您入门。祝你好运。

# ruby - 如何在光标上指定无超时选项？

> ID：10906365
> 
> 赞同：10
> 
> 时间：2012-06-05T23:29:44.157
> 
> 标签：ruby, mongodb

如何在光标上指定无超时选项？

我可以从我的笔记本电脑手动运行该作业，但是服务器上发生了一些事情，并且我一直收到此错误：

MONGODB cursor.refresh() for cursor xxx 查询响应返回 CURSOR_NOT_FOUND。指定的游标无效，或者游标在服务器上可能已超时。MONGODB cursor.refresh() 用于游标 yyy

该作业是从一个 ruby​​ 调度程序文件运行的，该文件被指定为 rake 中的命名空间 rake 正在中间调用另一个 ruby​​ 模块，并且该作业在该模块的执行期间终止

[我早些时候](https://stackoverflow.com/questions/10887797/cursor-not-found-my-cron-jobs-started-dying-in-the-middle)问过这个问题，但它被否决了。请不要投反对票，而是解释它的愚蠢之处，因为我真的需要解决这个问题并且无法弄清楚发生了什么。

该服务器是一种实验性的，没有任何监控工具。但这似乎是可靠的。并且没有其他作业正在运行。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-06T01:02:18.833

有关如何关闭游标超时的详细信息，请参阅 Ruby MongoDB 驱动程序的[常见问题解答。](http://api.mongodb.org/ruby/1.1.5/file.FAQ.html#I_keep_getting_CURSORNOTFOUND_exceptions__What_s_happening_)

那里的例子：

```
@collection.find({}, :timeout => false) do |cursor|
   cursor.each do |document
     # Process documents here
   end
end 
```

# php - mysql_query 从多个列中选择 OR

> ID：10906366
> 
> 赞同：0
> 
> 时间：2012-06-05T23:29:48.950
> 
> 标签：php, mysql

我有：

`$sql = mysql_query("select * from articles where articletitle OR articledescription OR articletags like '%$term%'");`

它不返回任何结果。

我在这里使用 OR 不正确吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T23:33:07.757

您需要将 LIKE 添加到所有三个子句：

```
SELECT * FROM articles WHERE (articletitle LIKE '%$term%') OR (articledescription LIKE '%$term%') OR (articletags LIKE '%$term%'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T23:33:17.637

不..您每次都需要使用类似'...'

```
$sql = mysql_query("select * from articles where articletitle like '%$term%' OR 
articledescription like '%$term%' OR articletags like '%$term%'"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T23:33:31.303

是的。:-) 你使用不正确。

```
select * from articles where (articletitle like '%$term%') 
OR (articledescription like '%$term%') OR (articletags like '%$term%') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T01:25:18.303

顺便说一句，如果 $term 恰好是（减去双引号）“';DELETE FROMarticles;--”，会发生什么？（如果您的原始查询有这样的单引号，请在单引号后添加一个结束括号。）我建议您依赖一些类似 sprintf 的工具（在 PHP 中，这通常意味着您需要准备好的语句），而不是被称为魔术引号的已弃用错误功能。

# jquery - 使用 Jquery 将 XML 解析为多个表单字段

> ID：10906371
> 
> 赞同：0
> 
> 时间：2012-06-05T23:30:05.047
> 
> 标签：jquery, xml, forms, parsing

我想要做什么：i）将 XML 数据解析为选择选项字段 ii）当用户使用选项框进行选择时，更多的表单字段会根据用户选择填充相关的 XML 数据。

我已经与Adobe Spry一起工作（我听到您哭泣的是什么！！！） - 当前，用户选择一个包含XML数据的选项框，例如“ American Wigeon”其余的 XML，如“Turdus migratorius”等。如果用户改变主意并选择另一个，例如“美国罗宾”，则该鸟的相关 XML 将填充表单字段。

我在这里找到了将解析数据放入选择选项的答案，但无法解决下一个使用多个字段的问题。

我的 XML 文件看起来像这样（编辑为两个条目，但通常大约 300 个）：

```
<?xml version="1.0" encoding="utf-8" ?>
<BIRD>

<Result>
<name>American Wigeon</name>
<latin>Anas americana</latin>
<rare>1</rare>
<id>68</id>
<breed>0</breed>
<winter>0</winter>
</Result>

<Result>
<name>American Robin</name>
<latin>Turdus migratorius</latin>
<rare>1</rare>
<id>255</id>
<breed>0</breed>
<winter>0</winter>

</BIRD> 
```

我想让它在 jQuery 中工作，这样我就可以开始向脚本添加更多功能。

任何帮助将不胜感激。

非常感谢

标记

**编辑更新日期：**

我喜欢 Charlietfi 编写的脚本，并在 jsFiddle 上对此进行了测试（非常感谢）——我现在在将额外的 XML 数据附加到表单字段时遇到问题。例如，如果我选择 American Wigeon，然后我想将额外的 XML 数据放入 FORM 字段中，然后可以提交（因此“Rare”的值将进入文本字段”）

我可以将示例文本放入表单字段但无法在以下代码示例中获取选定的附加 XML 数据：

```
var xml = '<?xml version="1.0" encoding="utf-8" ?><BIRD><Result><name>American 
Wigeon</name><latin>Anas americana</latin><rare>1</rare><id>68</id><breed>0</breed>
<winter>0</winter></Result><Result><name>American Robin</name><latin>Turdus 
migratorius</latin><rare>1</rare><id>255</id><breed>0</breed><winter>0</winter>
</Result></BIRD>';

var $xml = $($.parseXML(xml));

$xml.find('Result').each(function() {
var data={}
$(this).children().each(function() {
    data[this.tagName]=$(this).text();
})
                                                                                              $('#test').data( data.id,  data).append('<option                                                                           value="'+data.id+'">'+data.name+'</option>');
  });

 $('#test').change(function(){
var data=$(this).data( $(this).val());   

var input = $( "#test2" ); // **this being the name of my text field**
 input.val( input.val() + "more text" );

    alert('ID:'+data.id +', Name:'+ data.name);    
  }) 
```

当脚本运行时，我从选项中选择一只鸟，然后按预期弹出一个警告框，插入文本字段的加号是“更多文本”（使用它来确保添加某些内容）。

我被困在如何使用“ **+data.id +** ”并将其放入#test2 非常感谢每个人的帮助和道歉，如果这是一件我错过的简单事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T03:31:35.193

以下将动态解析 XML，创建一个选项和一个数据对象，这些对象将使用 jQuery data() 存储在选择元素上

```
var $xml = $($.parseXML(xml));

$xml.find('Result').each(function() {
    var data={};
    /* loop over children of each "Result to create data object*/
    $(this).children().each(function() {
        data[this.tagName]=$(this).text();
    });
    /* add data to select and create option*/
    $('#test').data( data.id , data).append('<option value="'+data.id+'">'+data.name+'</option>');
});

/* change handler for select*/
$('#test').change(function(){
    var data=$(this).data( $(this).val()); 
    /* here you would make updates to other fields */   
     alert('ID:'+data.id +', Name:'+ data.name);    
}) 
```

演示：http: [//jsfiddle.net/dpK7x/1/](http://jsfiddle.net/dpK7x/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T02:26:56.877

我假设您正在使用[`jQuery.parseXML()`](http://api.jquery.com/jQuery.parseXML/)进行实际解析。然后您可以执行以下操作（当然将其包装在 DOMReady 函数中）：

```
var xmlDoc = $.parseXML(yourXML),
$xml = $( xmlDoc );

$xml.find('Result').each(function () {
    $this = $(this); // $this is now the <Result> node
    // Assuming you populating a <select> list
    var newOption = $('<option/>').text($this.find('name').text()).val($this.find('name').text());
    // Populate the additional data that we'll be able to use elsewhere
    newOption.data('latin', $this.find('latin').text());
    newOption.data('rare', $this.find('rare').text());
    // etc...

    // Add the newOption to your existing <select> element
    $('#mySelectList').append(newOption);
});

// Then later on we can deal with the <option> being selected
$('#mySelectList').on('change', function() {
    $selected = $(this).find('option:selected');
    // Do whatever you need to do with the data... Update HTML, populate form fields etc.
    console.log('name', $selected.text());
    console.log('latin', $selected.data('latin');
    console.log('rare', $selected.data('rare');
    // etc...
}); 
```

# ios - Int没有做数学？

> ID：10906374
> 
> 赞同：1
> 
> 时间：2012-06-05T23:30:28.587
> 
> 标签：ios, math, int

我将 in 值设置为 10。然后使用以下代码运行 NSTimer： `[NSTimer scheduledTimerWithTimeInterval:0.01 target:self selector:@selector(updateTimer) userInfo:nil repeats:YES];` 我的 void 看起来像这样

```
 -(void)updateTimer {
         timeLeft = timeLeft -0.01;
         NSString *string = [NSString stringWithFormat:@"%i",timeLeft];
         [timer setString:string];
         NSLog(string);

     } 
```

**我正在使用 Coco2D，这不是问题** 在我的日志中它是这样的

```
2012-06-05 17:28:56.030 NumberPop[31291:10a03] 9
2012-06-05 17:28:57.030 NumberPop[31291:10a03] 8
2012-06-05 17:28:58.030 NumberPop[31291:10a03] 7
2012-06-05 17:28:59.030 NumberPop[31291:10a03] 6
2012-06-05 17:29:00.030 NumberPop[31291:10a03] 5
2012-06-05 17:29:01.030 NumberPop[31291:10a03] 4
2012-06-05 17:29:02.030 NumberPop[31291:10a03] 3
2012-06-05 17:29:03.030 NumberPop[31291:10a03] 2
2012-06-05 17:29:04.029 NumberPop[31291:10a03] 1
2012-06-05 17:29:05.029 NumberPop[31291:10a03] 0
2012-06-05 17:29:06.029 NumberPop[31291:10a03] 0
2012-06-05 17:29:07.029 NumberPop[31291:10a03] 0
2012-06-05 17:29:08.030 NumberPop[31291:10a03] 0
2012-06-05 17:29:09.029 NumberPop[31291:10a03] 0
2012-06-05 17:29:10.030 NumberPop[31291:10a03] 0
2012-06-05 17:29:11.029 NumberPop[31291:10a03] 0
2012-06-05 17:29:12.029 NumberPop[31291:10a03] 0 
```

0 永远持续*下去*。我很迷茫，有什么帮助吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-05T23:39:05.317

所以很好奇你为什么要从 int 中减去 .01。但是当你这样做时，结果会被截断为一个 int。因此，如果你从 9 中减去 0.01，你会得到 8.99，但 int 不能存储 8.99，所以它会简单地存储为 8。一旦你降到 0，它就会做同样的事情。0 - .01 = -0.01，被截断为 0。所以你总是会从那个作业中得到零。

相反，尝试这样的事情：

`timeLeft = timeLeft - 1;`

甚至更好

`timeLeft --;`

上述任何一项都将继续减少低于零的整数，例如：-1、-2、-3....当然，假设它是一个无符号整数（即`int`）。

此外，如果您希望将计时器停止为零，则需要在剩余时间达到零时使其无效。在这里查看更多信息：[https ://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/nstimer_Class/Reference/NSTimer.html#//apple_ref/occ/instm/NSTimer/invalidate](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/nstimer_Class/Reference/NSTimer.html#//apple_ref/occ/instm/NSTimer/invalidate)

基本上，做这样的事情：

```
timeLeft --;
if (timeLeft <= 0) [timer invalidate]; 
```

不过，有一些重要的事情需要理解。NSTimer 不保证它会在您指定的时间间隔准确地被调用。基本上，它会检查每个运行循环是否应该触发，然后在适当的时候触发。但是你永远不能比运行循环更频繁地触发 NSTimer。这意味着如果运行循环花费的时间比正常时间长或您的时间间隔太短，它可能会在触发之前跳过几个间隔。因此，通过减少一个数字（就像你似乎正在做的那样）来计算“时间”是行不通的。相反，您需要找到另一种方法，例如在启动计时器时设置一个起始 NSDate 变量，然后检查每个计时器触发的当前时间与开始时间。

NSDate 在其计算中返回相当精细的粒度。因此，如果您选择开始日期，则可以通过执行以下操作获取自该日期以来的时间间隔：

`NSTimeInterval interval = [[NSDate date] timeIntervalSinceDate:startDate];`

NSTimeInterval 是一个`double`. 所以你可以把它转换成这样的字符串：

`NSString *string = [NSString stringWithFormat:@"%f", interval];`

或限制小数位：

`NSString *string = [NSString stringWithFormat:@"%.2f", interval];`

这应该给你你正在寻找的东西。

# firefox - Firefox、SVG、文本装饰

> ID：10906380
> 
> 赞同：2
> 
> 时间：2012-06-05T23:31:07.997
> 
> 标签：firefox, svg

## 考虑以下代码片段：

```
<text style="text-decoration:underline;"> Underline </text> 
```

它在最新版本的 Chrome 和 Safari 中都能为我正确呈现；但是，它在最新版本的 Firefox 中失败。

## 问题：

*   如果文本装饰不是 SVG 标准的一部分？

或者

*   Firefox 不支持整个 SVG 吗？

最后：

*   鉴于上述情况，如何在 Firefox SVG 文本中获得下划线/删除线/划线？

谢谢！

## 编辑

嗯，[https:](https://bugzilla.mozilla.org/show_bug.cgi?id=317196) //bugzilla.mozilla.org/show_bug.cgi?id=317196 是否确认 Firefox 在 2012 年不支持 SVG 下划线？:-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T02:51:59.603

您链接到的错误就是它。

并且没有人支持“整个 SVG”（至少 SVG 1.1）。机会是，没有人会。

# algorithm - 如何判断光线是否与矩形相交？

> ID：10906381
> 
> 赞同：1
> 
> 时间：2012-06-05T23:31:08.933
> 
> 标签：algorithm, math, geometry, 2d

我们有一条从 point 开始`A(X, Y)`并一直持续到给定 point的射线`B(X, Y) != A`。我们有一个由点定义的矩形，`K,L,M,N`每个点都有它的`(X, Y)`.

我想知道如何检测我们的光线是否与矩形的任何点相交（获得 a `bool`，而不是精确坐标）？计算这种值的算法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T23:41:17.333

让我说清楚。你有一个向量`v`指向方向`(b_x - a_x, b_y - a_y)`并从 开始`(a_x, a_y)`。

考虑向量`w = (b_y - a_y, a_x - b_x)`。它与第一个成直角。（用点积验证。）因此，对于任何点，您都可以通过取with的点积并查看符号`(p_x, p_y)`来轻松判断它在向量的哪一侧。`(p_x - a_x, p_y - a_y)``w`

因此，使用矩形的所有 4 个角来取那个点积。如果任何一个给出 0 点积，它们就在向量上，如果符号发生变化，则存在交集，如果符号始终相同，则没有交集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T19:20:04.710

一种不太聪明但概念上更简单的方法：当且仅当它与至少一个边相交时，光线才会与矩形相交。所以对于矩形的每一边，找到通过端点的线与射线 AB 的交点（如果有的话）；那么它只是一个范围检查，以确定该交点是否位于矩形边界上的线段的一部分，或者它是否在外部。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T19:11:04.397

您可能想要计算与`AB`矩形相交的射线段（如果有）。如果你的矩形是轴对齐的，这将更容易在数字意义上计算，但逻辑应该是相似的。

* * *

如果点是，`L`您可以表示一条有向线：`[a, b, c]``P``(X, Y)`

```
let L(P) =  a*X + b*Y + c

then, if L(P) == 0, point P is on L
      if L(P) > 0, point P is to the left of L
      if L(P) < 0, point P is to the right of L 
```

请注意，这是多余的，因为给定 any `k > 0`， [k*a, k*b, k*c] 表示*同一条线*（此属性使其成为[齐次坐标系](http://en.wikipedia.org/wiki/Homogeneous_coordinates)）。我们还可以通过用第三个坐标增加它们来表示具有齐次坐标的点：

```
2D point P = (X, Y)
-> homogeneous coordinates [x, y, w] for P are [X, Y, 1]
   L(P)  =  L.a*P.x + L.b*P.y + L.c*P.w  ==  a*X + b*Y + c*1 
```

在任何情况下，给定矩形的两个角（例如`P`和`Q`），您可以通过`P`并`Q`使用它们的齐次坐标的 3-D 叉积来计算线的齐次坐标：

```
homogeneous coordinates for line PQ are:  [P.X, P.Y, 1] cross [Q.X, Q.Y, 1]
  -> PQ.a = P.Y - Q.Y
     PQ.b = Q.X - P.X
     PQ.c = P.X*Q.Y - Q.X*P.Y 
```

您可以从数学上验证点 P 和 Q 都在上述线 PQ 上。

* * *

`AB`为了表示与矩形相交的线段，首先计算 vector `V = B - A`，如@btilly 的答案。对于齐次坐标，其工作原理如下：

```
A  =  [A.X, A.Y, 1]
B  =  [B.X, B.Y, 1]
-> V  =  B - A  =  [B.X-A.X, B.Y-A.Y, 0]

for any point C on AB: homogeneous coordinates for C = u*A + v*V
  (where u and v are not both zero) 
```

只有当和都是非负时，点`C`才会位于线的射线部分。（与 的通常表述相比，这种表示可能看起来晦涩难懂，但这样做可以避免不必要的被零除的情况......）`u``v``C = A + lambda * V`

* * *

现在，我们可以计算射线交点：我们用每个端点`AB`的参数坐标来表示一条线段： 。`[u,v]``{ start = [start.u, start.v]; end = [end.u, end.v] }`

我们以逆时针方向计算矩形的边缘，因此矩形内的点位于`L(P)>0`每个边缘的左侧/正侧 ( )。

```
Starting segment is entire ray:
  start.u = 1;  start.v = 0
  end.u = 0;  end.v = 1

for each counterclockwise-directed edge L of the rectangle:
  compute:
    L(A) = L.a*A.X + L.b*A.Y + L.c
    L(V) = L.a*V.X + L.b*V.Y
    L(start) = start.u * L(A) + start.v * L(V)
    L(end) = end.u * L(A) + end.v * L(V)
  if L(start) and L(end) are both less than zero:
    exit early: return "no intersection found"
  if L(start) and L(end) are both greater or equal to zero:
    do not update the segment; continue with the next line
  else, if L(start) < 0:
    update start coordinates:
      start.u :=  L(V)
      start.v := -L(A)
  else, if L(end) < 0:
    update end coordinates:
      end.u := -L(V)
      end.v :=  L(A)

on normal loop exit, the ray does intersect the rectangle;
the part of the ray inside the rectangle is the segment between points:
  homog_start = start.u * A + start.v * V
  homog_end = end.u * A + end.v * V
return "intersection found":
  intersection_start.X = homog_start.x/homog_start.w
  intersection_start.Y = homog_start.y/homog_start.w
  intersection_end.X = homog_end.x/homog_end.w
  intersection_end.Y = homog_end.y/homog_end.w 
```

请注意，这适用于任意凸多边形，而不仅仅是矩形；上面其实是一个通用的射线/凸多边形相交算法。对于矩形，您可以展开 for 循环；而且，如果矩形是轴对齐的，则可以大大简化算术。但是，内部循环中的 4 种情况决策对于每条边都应该保持不变。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T08:02:15.783

您可以使用扫描线算法来执行此操作。

[http://en.wikipedia.org/wiki/Sweep_line_algorithm](http://en.wikipedia.org/wiki/Sweep_line_algorithm)

# iphone - 使用 [UIImage imageNamed] 时未释放内存警告的图像

> ID：10906386
> 
> 赞同：2
> 
> 时间：2012-06-05T23:32:04.720
> 
> 标签：iphone, objective-c, ios, ipad, memory-management

在我的应用程序中，我使用了这条线

```
[UIImage imageNamed:imageName] 
```

每当加载图像。据我了解，此功能会缓存图像以供以后使用 - 这很棒，因为大多数图像都被多次使用。

但是 - 当我模拟内存警告时，这些图像使用的内存似乎没有被释放 - 因为大部分内存实际上是由缓存的图像使用的，所以释放任何当前不需要的图像非常重要从记忆里！

-

这是预期的行为，还是图像是否保留在内存中，因为它只是一个模拟的内存警告？或者，如果我想发布这些图像，我是否必须为 UIImage 编写自己的类别来缓存图像但在内存短缺时释放不需要的图像（或者更好的是，有人已经这样做了/共享了它的代码） ??

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T00:40:39.743

我所做的是创建自己的缓存机制，利用`-initWithConentsOfFile`不缓存和`NSMutableDictionary`存储，分配的每个图像都存储在字典中，图像名称作为键。如果达到内存警告，您可以释放字典并将其归零，从而释放从图像分配的所有内存。

这使您可以完全控制图像缓存。`-imageNamed:`使用它自己的缓存机制，您无法控制何时何地释放分配的内存。

你也应该试试这个方法。

**编辑：**继承我的 UIImage 类扩展（[https://gist.github.com/2880240](https://gist.github.com/2880240)），用自定义缓存覆盖`-imageNamed:`，收到内存警告后，您可以简单地使用`[UIImage freeCache]`. 还包括在将所有图像存储在缓存中时设置自动释放的能力，即：`[UIImage setShouldAutorelease:TRUE]`. 默认为假。

试试看，希望对你有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T23:43:22.417

如果没有更多对应该清理的图像的引用，请不要担心内部缓存机制（因为它的行为无论如何都没有记录）。您是否有任何代码可以删除对图像的任何引用（nil 或 release）？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T23:43:38.273

你在 UIImageView 中使用它吗？

随着应用程序进入后台，自动管理大量框架数据。使用 imageNamed: 加载的图像的数据会自动丢弃，但 UIImageView 不会丢弃其数据，因此可能与内存不足警告相同。

PS 如果您的应用程序被暂停，它将不会收到内存警告。如果它使用大量内存，那么它可能会被终止。为了减少这种情况的可能性（如果它很重要），那么您可以使用存储在 NSCache 中的 NSPurgeableData 以在内存不足的情况下将内容标记为可清除，然后操作系统将为您清除它。

# c++ - C++ 方法和类的正则表达式

> ID：10906387
> 
> 赞同：2
> 
> 时间：2012-06-05T23:32:13.083
> 
> 标签：c++, regex

可靠地查找 C++ 方法和类的正则表达式是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-05T23:36:47.047

没有正则表达式可以可靠地找到 C++ 方法和类。你需要一个真正的解析器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T23:50:46.013

正则表达式确实不适合解析 C++ 等语言。像模板这样的语言特性需要额外的知识才能正确解析。

考虑以下

```
template<class T> T SomeTemplate();
typedef int SomeType;

if(SomeTemplate<SomeType>())
{
} 
```

你如何区分比较和调用模板函数？

# mercurial - 如何使用不同的评论重新提交最后一个变更集？

> ID：10906391
> 
> 赞同：3
> 
> 时间：2012-06-05T23:32:32.130
> 
> 标签：mercurial

[据我了解](https://stackoverflow.com/questions/2624083/how-to-fix-an-error-in-a-mercurial-changeset-comment)，您无法真正修复 Hg 中的评论。所以我想做的是重新推送完全相同的更改（或者至少“触摸”相同的文件并再次提交和推送）。

这是必要的原因是因为我们有一个依赖于特定评论模式的错误跟踪和构建系统，我们需要确保正确的文件包含在构建中，但是如果我忘记更新我的评论中的错误#我的最后一次提交，我不小心提交并把它推到了错误的 # 因为我过于热心，我怎样才能再次重新推送这些相同的文件而不手动进入每个文件并添加空格或换行符来创建差异？

澄清一下，我不能“回滚”什么的；它已经被*推送*了错误的消息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T06:32:22.577

据我所知，当前的 Mercurial 功能对此不提供支持。推送变更集后，除了从服务器存储库和任何其他开发人员的存储库中剥离它之外，您几乎无法取消推送它。

我想你应该问问那些在你的商店里设置这个工作流程的人；他们应该为此想出一些异常处理程序。

我们通常只是忽略这样的问题，并手动关闭错误，确保错误链接到正确的变更集。如果变更集真的搞砸了（通常这意味着错误的更改，而不是格式错误的提交消息），我们会求助于剥离。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T18:24:09.337

由于您的更改已被推送，您不能使用简单的修复，例如“hg commit --amend”，但您可以执行类似的操作。基本上，以下命令在 Mercurial 的帮助下重新执行提交：

```
CSET=...the changeset to re-do...
hg up -r "p1($CSET)"    # Update the working directory to the parent revision
hg log -r "$CSET" -p > changes.patch
hg import --no-commit changes.patch
hg commit     # And use the appropriate commit message. 
```

然后，合并并推送。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-06T08:33:28.567

我能想到的唯一方法是再提交两个更改，一个是`hg backout`不正确的修订版，另一个是`hg backout`带有更正注释的修订版。

不过我不喜欢这个想法，如果有任何方法可以解决你的错误跟踪系统中的问题，我不会推荐它。

# r - 渲染 3D 表面

> ID：10906392
> 
> 赞同：3
> 
> 时间：2012-06-05T23:32:38.573
> 
> 标签：r, 3d, geometry, geometry-surface

我有以 xyz 点格式表示 3D 表面（即地震断层平面）的数据。我想创建这些表面的 3D 表示。我在使用 rgl 和 akima 方面取得了一些成功，但是它无法真正处理可能会自行折叠或在同一 x,y 点具有多个 z 值的几何图形。或者，使用几何（来自 qhull 的 convhulln 函数）我可以创建在 rgl 中很好地显示的凸包，但这些是封闭的表面，实际上，对象是开放的（不完全包围点集）。有没有办法创建这些表面并渲染它们，最好是在 rgl 中？

**编辑**

为了澄清，这些点位于定义表面的点云中。它们在整个表面具有不同的覆盖密度。但是，主要问题是表面是单面的，不是封闭的，而且我不知道如何为更复杂的几何图形生成不封闭的网格/表面。

举个例子...

```
require(rgl)
require(akima)
faultdata<-cbind(c(1,1,1,2,2,2),c(1,1,1,2,2,2),c(10,20,-10,10,20,-10))
x <- faultdata[,1]
y <- faultdata[,2]
z <- faultdata[,3]
s <- interp(x,z,y,duplicate="strip")
surface3d(s$x,s$y,s$z,col=a,add=T) 
```

这通常会产生我想要的东西。但是，对于更复杂的飞机，这不一定有效。例如，数据在哪里：

```
faultdata<-cbind(c(2,2,2,2,2,2),c(1,1,1,2,2,2),c(10,20,-10,10,20,-10)) 
```

我不能使用这种方法，因为这些点都是垂直共面的。由于同样的问题，我也不能使用 convhulln，一般来说我不想要一个封闭的船体，我想要一个表面。我查看了 alphashape3d，它看起来很有希望，但我不确定如何使用它来解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T01:29:08.950

你如何确定这些点如何连接在一起作为一个表面？按距离？这可能是一种方式，并且该`alphashape3d`软件包可能有用。否则，如果您确切知道它们是如何连接的，那么您可以直接用`rgl`结构将其可视化。

# android - Android 清单：configChanges:screenSize 不可用

> ID：10906395
> 
> 赞同：2
> 
> 时间：2012-06-05T23:32:54.540
> 
> 标签：android, android-manifest

我有奇怪的问题。通常在奇怪的问题上我做了一些非常愚蠢的事情。但这我完全不知道可能出了什么问题。我添加了

```
android:configChanges="orientation" 
```

到我的应用程序的活动部分，以防止在屏幕旋转时刷新列表视图。这工作得很好，但是在针对 sdK-Version 15 之后，ListView 再次刷新。我阅读了更多内容并注意到，我还必须为 sdK 目标 13 及更高版本添加 screenSize 属性。但是我的 Eclipse 中没有可用的属性“screenSize”（也缺少 smallestScreenSize）。自第 7 版以来，我已经安装了所有可用的 sdK，包括 Google api。

请有一个想法，如何解决这个问题？

非常感谢你提前！最好的问候托比

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-05T23:54:02.537

右键单击您的 Android 项目，单击**Properties**，导航到**Android**，然后选择**Android 4.0.3**。如果你还没有。

如果仍然没有出现，那么做一个`screenSize`项目**--> 清理**并重新启动 eclipse。不知道会是什么问题，否则......`smallestScreenSize`

# php - 在自定义内容类型上显示原始数据 URL

> ID：10906397
> 
> 赞同：1
> 
> 时间：2012-06-05T23:33:16.267
> 
> 标签：php, html, drupal

我在 Drupal 7 中通过名为“test”的自己的“内容类型”创建了“主页”[field_homepage] 字段。我还创建并正在使用我自己的主题。在这个主题中，我为这个名为 node--test.tpl.php 的“测试”内容类型创建了一个模板

```
<a href="<?php print render($content['field_homepage']); ?>" target="_blank">Homepage</a> 
```

唯一的问题是，当它被打印出来时，drupal 会添加额外的跨度样式，如下所示。

```
<div class="field field-name-field-homepage field-type-text field-label-hidden"><div class="field-items"><div class="field-item even">my homepage</div></div></div> 
```

现在这被证明是有问题的，因为我的链接将无法正确显示。

解决方案是什么？我听说也许我可以覆盖 field.tpl.php 但是存在性能问题。我认为这将是一项常见且简单的任务。

谢谢。

# php - 将数组作为数组而不是来自 PHP 的 JSON 传递给 javascript

> ID：10906401
> 
> 赞同：2
> 
> 时间：2012-06-05T23:33:26.290
> 
> 标签：php, javascript, arrays, json

首先这不是重复的问题。我已经查看了一些类似的问题，大部分答案都是我现在正在使用的。

这是在PHP方面设置的问题

```
$array = array('name' => 'a', 'data' => array('0'=>15,'0.25'=>'18','0.35'=>19,'1' =>20));
echo json_encode($array); 
```

在 JS 方面

> 数据 = $.parseJSON(数据); // 数据是上面 php 脚本的返回值

如您所见， $array['data'] 是一个关联数组，以数字为键并按顺序排序。在解析为 JSON 时，javascript 更改了该数组的顺序并将 0 和 1 排序为数字键并将它们放在对象的头部。

我知道这是某些浏览器（例如 chrome 和 IE9）的标准行为。如果我想保持数组的顺序，我已经读过人们建议严格坚持使用数组的地方。但我的问题是你如何将一个数组从 PHP 反馈到 javascript 作为一个数组而不是使用 json 对象？或者是否有其他解决此类问题的方法。感谢您提前输入。

感谢您提前输入

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T23:39:09.423

使用数组来维护顺序，然后使用对象来创建地图。有两种方法。我会建议：

```
$array = array('name' => 'a', 'data' => 
  array(
    array('key' => 0, 'value' => 15),
    array('key' => 0.25, 'value' => 18),
    array('key' => 0.35, 'value' => 19),
    array('key' => 1, 'value' => 20),
  )
);
echo json_encode($array); 
```

这将为您提供 JSON：

```
{
    "name": "a",
    "data": [
       {"key": 0, "value": 15},
       {"key": 0.25, "value": 18},
       {"key": 0.35, "value": 19},
       {"key": 1, "value": 20}
    ]
} 
```

然后您将有顺序，但查找某个键将更加困难。如果你想让它变得简单，你可以像这样返回一个映射对象：

```
$array = array('name' => 'a', 'data' => 
  array(
    "0" => 15,
    "0.25" => 18,
    "0.35" => 19,
    "1" => 20,
  ),
  'order' => array("0", "0.25", "0.35", "1")
);
echo json_encode($array); 
```

这会给你：

```
{
    "name": "a",
    "data": {
       "0": 15,
       "0.25": 18,
       "0.35": 19,
       "1": 20
    },
    "order": ["0", "0.25", "0.35", "1"]
} 
```

这两种返回数据的方法之一应该被证明对您的特定用例最有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T23:39:34.733

实际上，是 PHP 采用`"0"`and`"1"`键并将它们变成数字键。这与您的 JavaScript 无关。

没有任何真正的方法可以解决这个问题，但理想情况下，您的代码不应依赖于诸如“对象的键的顺序”之类的东西。就我在这里看到的情况而言，将数据分成一个键数组和一个值数组，然后在 JS 端将它们重新压缩在一起，这可能是一个更好的主意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T23:40:10.730

我建议使用另一个字段来存储订单。

```
$array = array('name' => 'a',
               'data' => array('0'=>15,'0.25'=>'18','0.35'=>19,'1' =>20),
               'order'=> '0,0.25,0.35,1'
          );
echo json_encode($array); 
```

# c# - DataAnnotation for Password 的正则表达式

> ID：10906408
> 
> 赞同：3
> 
> 时间：2012-06-05T23:34:02.263
> 
> 标签：c#, .net, regex, asp.net-mvc, data-annotations

我们需要确保密码符合特定的强度格式（这是在 web.config 中配置的）。要求是密码必须包含一定数量的大写字符和一定数量的非字母数字字符。我想用验证密码的正则表达式注释我的密码属性，以确保密码包含 x 个大写字母和 y 个非字母字符。请帮助正则表达式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T23:44:50.423

在单个正则表达式中检查这样的多个条件最好使用前瞻来完成，例如，假设您想要 3 个大写字符和 4 个非字母字符，您可以使用以下正则表达式：

```
^(?=(?:.*[A-Z]){3})(?=(?:.*[^a-zA-Z]){4}) 
```

说明：首先，让我们考虑一下只检查第一个条件的正则表达式是什么样的。要匹配 3 个大写字符，我们可以使用以下命令：

```
(?:.*[A-Z]){3} 
```

我们仍然可以通过将它放入前瞻中来检查这个条件，这就是它`(?=...)`所做的，所以现在在`(?=(?:.*[A-Z]){3})`不消耗任何字符的情况下检查这个条件。此时我们可以使用 来检查第二个条件`(?:.*[^a-zA-Z]){4}`。我也将第二个条件放在了前瞻中，这样添加更多检查就很简单了。

请注意，当前的正则表达式实际上不会匹配任何字符，如果所有条件都匹配，它将匹配字符串的开头（零个字符），否则匹配将失败。如果您希望它也实际使用字符，只需添加`.*`到末尾即可。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T23:45:06.377

我找到了一篇可以为我解决问题的好文章 [http://www.zorched.net/2009/05/08/password-strength-validation-with-regular-expressions/](http://www.zorched.net/2009/05/08/password-strength-validation-with-regular-expressions/)

# c# - Stream Writer 在程序退出前为空

> ID：10906410
> 
> 赞同：1
> 
> 时间：2012-06-05T23:34:08.067
> 
> 标签：c#, .net-4.0

我正在尝试将日志文件添加到我正在制作的程序中，但是当我告诉主线程退出（使用`Application.ExitThread()`）时，`logstrmWriter`它在到达那里之前突然为空。这是一个非常简单的脚本。

```
private static FileStream appLogStream;
internal static string logFile;
internal static StreamWriter logstrmWriter;
public static void Main()
{    
    logFile = Application.StartupPath + @"\Archiver.log";
    appLogStream = new FileStream(logFile, FileMode.Append, FileAccess.Write, FileShare.Read);
    TextWriter logtxtWriter = Console.Out;
    StreamWriter logstrmWriter = new StreamWriter(appLogStream);
    if(!console) Console.SetOut(logstrmWriter);

    Application.ApplicationExit += new EventHandler(OnApplicationExit);
    Application.Run();
}
internal static void OnApplicationExit(object sender, EventArgs e)
{
    active = false; Console.WriteLine("Main thread is shutting down. Sending Interrupt...");
    Archiver.Stop(); Console.WriteLine("Shutdown. Log and Exit");
    Console.WriteLine();
    logstrmWriter.Flush();
    logstrmWriter.Close();
    logstrmWriter.Dispose();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T23:42:25.387

您正在创建一个隐藏相关静态变量的局部变量。因此，您根本不会初始化`logstrmWriter`。

```
TextWriter logtxtWriter = Console.Out;
/* StreamWriter */ logstrmWriter = new StreamWriter(appLogStream);  // Remove the redeclaration here!
if(!console) Console.SetOut(logstrmWriter); 
```

# asp.net - ASP.NET Web API - 不允许 PUT 和 DELETE 动词 - IIS 8

> ID：10906411
> 
> 赞同：159
> 
> 时间：2012-06-05T23:34:09.167
> 
> 标签：asp.net, iis, asp.net-web-api, iis-8

我最近从 Visual Studio 2010 升级到了 Visual Studio 2012 RC。安装程序还会安装 IIS 8 Express，Visual Studio 现在将其用作默认 Web 服务器。

IIS 8 阻止了我使用 PUT AND DELETE 动词的 WEB API 请求。IIS 返回 405 错误，`The requested resource does not support http method 'PUT'`.

我知道人们过去对此有过疑问，并且在 Stack Overflow 上有几条关于它的消息。使用 IIS 7 Express 的解决方案是卸载 WebDav。不幸的是，我没有看到任何使用 IIS 8 的方法。

我尝试从 applicationhost.config 中编辑 WebDav 部分，但这没有帮助。例如，我`<add name="WebDAVModule" image="%IIS_BIN%\webdav.dll" />`从配置文件中删除。

我在这上面花了太长时间。必须有一种简单的方法来启用 PUT 和 DELETE？

* * *

## 回答 #1

> 赞同：169
> 
> 时间：2012-06-06T02:07:20.840

Okay. I finally got to the bottom of this. You need to jump through some hoops to get the PUT and DELETE verbs working correctly with IIS8\. In fact if you install the release candidate of VS 2012 and create a new WEB API project you'll find that the sample PUT and DELETE methods return 404 errors out of the box.

To use the PUT and DELETE verbs with the Web API you need to edit %userprofile%\documents\iisexpress\config\applicationhost.config and add the verbs to the ExtensionlessUrl handler as follows:

Change this line:

```
<add name="ExtensionlessUrl-Integrated-4.0" path="*." verb="GET,HEAD,POST,DEBUG" type="System.Web.Handlers.TransferRequestHandler" preCondition="integratedMode,runtimeVersionv4.0" /> 
```

to:

```
<add name="ExtensionlessUrl-Integrated-4.0" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE" type="System.Web.Handlers.TransferRequestHandler" preCondition="integratedMode,runtimeVersionv4.0" /> 
```

In addition to the above you should ensure WebDAV is not interfering with your requests. This can be done by commenting out the following lines from applicationhost.config.

```
<add name="WebDAVModule" image="%IIS_BIN%\webdav.dll" />
<add name="WebDAVModule" /> 
<add name="WebDAV" path="*" verb="PROPFIND,PROPPATCH,MKCOL,PUT,COPY,DELETE,MOVE,LOCK,UNLOCK" modules="WebDAVModule" resourceType="Unspecified" requireAccess="None" /> 
```

Also be aware that the default Web API convention is that your method name should be the same as the invoked HTTP verb. For example if you're sending an HTTP delete request your method, by default, should be named Delete.

* * *

## 回答 #2

> 赞同：131
> 
> 时间：2013-11-01T08:04:53.993

如下更改您的 Web.Config 文件。它会像魅力一样。

在节点`<system.webServer>`中添加以下代码部分

```
<modules runAllManagedModulesForAllRequests="true">
  <remove name="WebDAVModule"/>
</modules> 
```

添加后，您的 Web.Config 将如下所示

```
<system.webServer>
    <validation validateIntegratedModeConfiguration="false" />
    <modules runAllManagedModulesForAllRequests="true">
        <remove name="WebDAVModule"/>
    </modules>
    <httpProtocol>
    <customHeaders>
        <add name="Access-Control-Allow-Origin" value="*" />
        <add name="Access-Control-Allow-Headers" value="Content-Type" />
        <add name="Access-Control-Allow-Methods" value="GET, POST, PUT, DELETE, OPTIONS" />
    </customHeaders>
    </httpProtocol>
    <handlers>
      <remove name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" />
      <remove name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" />
      <remove name="ExtensionlessUrlHandler-Integrated-4.0" />
      <add name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness32" responseBufferLimit="0" />
      <add name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework64\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness64" responseBufferLimit="0" />
      <add name="ExtensionlessUrlHandler-Integrated-4.0" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" type="System.Web.Handlers.TransferRequestHandler" preCondition="integratedMode,runtimeVersionv4.0" />
    </handlers>
</system.webServer> 
```

* * *

## 回答 #3

> 赞同：64
> 
> 时间：2015-04-27T01:36:14.977

删除**WebDAV**非常适合我的情况：

```
<modules>
  <remove name="WebDAVModule"/>
</modules>
<handlers>
  <remove name="WebDAV" />
  <remove name="ExtensionlessUrlHandler-Integrated-4.0" />
  <add name="ExtensionlessUrlHandler-Integrated-4.0" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" 
       type="System.Web.Handlers.TransferRequestHandler" preCondition="integratedMode,runtimeVersionv4.0" />
</handlers> 
```

最好通过 web.config 解决问题，而不是通过 iis 或 machine.config 来解决问题，如果应用程序托管在另一台机器上，则不会发生

* * *

## 回答 #4

> 赞同：48
> 
> 时间：2014-09-23T19:43:08.737

更新您的 web.config

```
 <system.webServer>
    <modules>
      <remove name="WebDAVModule"/>
    </modules>
    <handlers>
      <remove name="WebDAV" />
      <remove name="ExtensionlessUrl-Integrated-4.0" />
      <add name="ExtensionlessUrl-Integrated-4.0"
           path="*."
           verb="GET,HEAD,POST,DEBUG,DELETE,PUT"
           type="System.Web.Handlers.TransferRequestHandler"
           preCondition="integratedMode,runtimeVersionv4.0" />
    </handlers>
  </system.webServer> 
```

[http://odetocode.com/blogs/scott/archive/2012/08/07/configuration-tips-for-asp-net-mvc-4-on-a-windows.aspx](http://odetocode.com/blogs/scott/archive/2012/08/07/configuration-tips-for-asp-net-mvc-4-on-a-windows.aspx)

无需修改主机配置。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2013-08-27T06:06:31.213

在 Asp.Net Web API - webconfig 中。这适用于所有浏览器。

在 System.web 标签内添加以下代码

```
<webServices>
  <protocols>
    <add name="HttpGet"/>
    <add name="HttpPost"/>
  </protocols>
</webServices> 
```

用以下代码替换您的 system.webserver 标记

```
<httpProtocol>
  <customHeaders>
    <add name="Access-Control-Allow-Origin" value="*" />
    <add name="Access-Control-Allow-Methods" value="GET,PUT,POST,DELETE" />
    <add name="Access-Control-Allow-Headers" value="Content-Type" />
  </customHeaders>
</httpProtocol>
<modules runAllManagedModulesForAllRequests="false">
  <remove name="WebDAVModule" />
</modules>

<validation validateIntegratedModeConfiguration="false" />
<handlers>
  <remove name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" />
  <remove name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" />
  <remove name="ExtensionlessUrlHandler-Integrated-4.0" />
  <add name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness32" responseBufferLimit="0" />
  <add name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework64\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness64" responseBufferLimit="0" />

  <add name="ExtensionlessUrlHandler-Integrated-4.0" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE" type="System.Web.Handlers.TransferRequestHandler" preCondition="integratedMode,runtimeVersionv4.0" />

</handlers> 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-01-25T01:43:13.113

这与其他一些答案一起在 iis8 上对我有用。我的错误是 404.6

```
<system.webServer>
  <security>
  <requestFiltering>
    <verbs applyToWebDAV="false">
       <add verb="DELETE" allowed="true" />
    </verbs>
  </requestFiltering>
  </security>
</system.webServer> 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2016-01-05T23:06:32.983

对于可能遇到此问题的其他任何人来说，只是一个快速更新。到今天为止，更改 %userprofile%\documents\iisexpress\config\applicationhost.config 不再起作用（直到现在都可以正常工作，不确定这是否是由于 Windows 更新所致）。经过数小时的挫折后，我更改了 web.config 以将这些处理程序添加到 system.webserver 以使其工作：

```
<handlers>
        <remove name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" />
        <remove name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" />
        <remove name="ExtensionlessUrlHandler-Integrated-4.0" />

        <add name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness32" responseBufferLimit="0" />
        <add name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework64\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness64" responseBufferLimit="0" />
        <add name="ExtensionlessUrlHandler-Integrated-4.0" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" type="System.Web.Handlers.TransferRequestHandler" preCondition="integratedMode,runtimeVersionv4.0" />
    </handlers> 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2016-01-31T18:14:16.067

启用 CORS（漂亮而整洁）

1.添加CORS nuget包

```
Install-Package microsoft.aspnet.webapi.cors 
```

2.在 WebApiConfig.cs 文件中注册方法添加如下代码：

```
config.EnableCors(); 
```

例如：
使用 System.Web.Http；

```
namespace test
{
public static class WebApiConfig
{
    public static void Register(HttpConfiguration config)
    {
        // Web API configuration and services

        config.EnableCors(); //add this**************************

        // Web API routes
        config.MapHttpAttributeRoutes();

        config.Routes.MapHttpRoute(
            name: "DefaultApi",
            routeTemplate: "api/{controller}/{id}",
            defaults: new { id = RouteParameter.Optional }
        );           
    }
}
} 
```

3.将波纹管代码添加到控制器的名称空间中，包括get，post，delete，put或任何http方法

```
[EnableCors(origins: "The address from which the request comes", headers: "*", methods: "*")] 
```

前任：

```
using System.Web.Http.Cors;//add this******************************
namespace Test.Controllers
{
[EnableCors(origins: "http://localhost:53681/HTML/Restaurant.html", headers: "*", methods: "*")]
public class RestaurantController : ApiController
{
    protected TestBusinessLayer DevTestBLL = new TestBusinessLayer();

    public List<Restaurant> GET()
    {
        return DevTestBLL.GetRestaurant();
    }

    public List<Restaurant> DELETE(int id)
    {
        return DevTestBLL.DeleteRestaurant(id);
    }       
}
} 
```

参考：[http ://www.asp.net/web-api/overview/security/enabling-cross-origin-requests-in-web-api](http://www.asp.net/web-api/overview/security/enabling-cross-origin-requests-in-web-api)

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2016-05-23T06:36:50.320

对于 PHP，它很简单：

1.  打开 IIS
2.  转到处理程序映射
3.  单击 php5.6.x 或 php7.0.x 上的编辑
4.  点击“请求限制”
5.  在动词选项卡下，选择“以下动词之一”并添加“GET、HEAD、POST、PUT、PATCH、DELETE、OPTIONS”

我想这也适用于其他处理程序。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2016-06-15T08:44:22.710

在没有任何工作之后，我能够通过以下步骤解决这个问题：

• 安装IIS 时未选择“WEB DAV PUBLISHING”IIS 设置。• INETMGR - 默认网站 - 请求过滤 - HTTP 动词 - PUT 为 True

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2015-04-30T22:06:44.073

在无休止的搜索和尝试已经提供的答案（添加 PUT、DELETE 动词并删除 WEBdav）之后，它只是没有用。

我去了 IIS 日志记录设置：> 查看日志文件。在我的情况下，W3SVC4 是最新日期的文件夹，打开文件夹，查找最新的日志文件并看到以下条目：GET /Rejected-By-UrlScan ~/MYDOMAIN/API/ApiName/UpdateMETHOD

Update 方法用动词 GET 列出，很奇怪吧？所以我搜索了 Rejected-By-UrlScan 并找到了这个链接：[UrlScan Broke My Blog](http://haacked.com/archive/2010/09/26/url-scan-broke-my-blog.aspx/)。

我去了这里：%windir%\system32\inetsrv\urlscan\UrlScan.ini

基本上，UrlScan 阻止了 PUT 和 DELETE 动词。我打开了这个 INI 文件，将 PUT 和 DELETE 添加到 AllowVerbs 并将它们从 DenyVerbs 列表中删除。我保存了 INI 文件，它工作了！所以对我来说，这些步骤在 ExtensionlessUrlHandler 提示旁边是必要的。

Windows 网络服务器 2008 R2（64 位），IIS 7.5。我将它与 DotNetNuke (DNN) WebAPI 结合使用。ASP.Net 4.0 我的更新方法：

```
[HttpPut]
[DnnAuthorize(StaticRoles = "MyRoleNames")]
public HttpResponseMessage UpdateMETHOD(DTO.MyObject myData) 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2018-07-03T10:48:18.873

我和你遇到了同样的问题，然后解决了，这里有解决方案，我希望它可能对你有帮助
首先

在 IIS`modules`配置中，循环**WebDAVModule**，如果您的 Web 服务器有，则将其删除

第二

在IIS`handler mappings`配置中，可以看到启用handler的列表，选择`the PHP item`，编辑，在编辑页面，点击请求限制按钮，然后`the verbs tab`在modal中选择，在指定要处理的动词标签，勾选`all verbs radio`，然后点击确定，你可能还会看到一个警告，它告诉我们使用双引号来执行 PHP-CGI，然后执行

如果完成了，然后重新启动IIS服务器，就可以了

[![在此处输入图像描述](../Images/65f965ab29c47ae8e687d535c3b337fa.png)](https://i.stack.imgur.com/MIjNn.png)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2015-11-16T12:25:35.623

除了上述所有解决方案之外，请检查您是否有“ **id** ”或 DELETE 方法中的任何自定义参数与路由配置匹配。

```
public void Delete(int id)
{
 //some code here
} 
```

如果您遇到重复的 405 错误，最好将方法签名重置为默认值，然后尝试。

默认情况下，路由配置将在 URL 中查找**id 。**所以参数名称**id**在这里很重要，除非您更改**App_Start**文件夹下的路由配置。

不过，您可以更改**id**的数据类型。

例如下面的方法应该可以正常工作：

```
public void Delete(string id)
{
 //some code here
} 
```

注意：还要确保通过 url 传递数据，而不是通过将负载作为正文内容携带的数据方法。

```
DELETE http://{url}/{action}/{id} 
```

例子：

```
DELETE http://localhost/item/1 
```

希望能帮助到你。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2017-01-30T18:44:31.227

以下是使用 IIS 管理器 GUI 允许额外 HTTP 动词的方法。

1.  在 IIS 管理器中，选择您希望允许 PUT 或 DELETE 的站点。

2.  单击“请求过滤”选项。单击“HTTP 动词”选项卡。

3.  单击边栏中的“允许动词...”链接。

4.  在出现的框中键入“DELETE”，单击“确定”。

5.  再次单击边栏中的“允许动词...”链接。

6.  在出现的框中键入“PUT”，单击“确定”。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2019-01-10T15:12:57.703

我在 MVC 应用程序中使用 ashx 文件，但上述答案均不适合我。IIS 10。

这是有效的。我没有在 IIS 或 web.config中更改“ **ExtensionlessUrl-Integrated-4.0** ”，而是为“ ***.ashx ”文件更改了“** **SimpleHandlerFactory-Integrated-4.0** ” ：

 **```
<add name="SimpleHandlerFactory-Integrated-4.0" path="*.ashx" 
verb="GET,HEAD,POST,DEBUG,PUT,DELETE" 
type="System.Web.UI.SimpleHandlerFactory" 
resourceType="Unspecified" requireAccess="Script" 
preCondition="integratedMode,runtimeVersionv4.0" /> 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-04-25T09:03:01.493

另一个原因可能如下：
我根据[这个答案](https://stackoverflow.com/a/17861208/1869773)更改了我的 Url for Web Api 方法：

```
Url.Action("MyAction", "MyApiCtrl", new { httproute = "" }) 
```

但是这种方法会创建如下链接：

```
/api/MyApiCtrl?action=MyAction 
```

这适用于 GET 和 POST 请求，但不适用于 PUT 或 DELETE。
所以我只是将其替换为：

```
/api/MyApiCtrl 
```

它解决了这个问题。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2012-06-06T01:54:40.353

我不确定您是否编辑了正确的配置文件。尝试以下步骤

1.  打开 %userprofile%\ducuments\iisexpress\config\applicationhost.config

2.  默认情况下，给定条目在 applicationhost.config 文件中进行注释。取消注释这些条目。

> ```
> <add name="WebDAVModule" image="%IIS_BIN%\webdav.dll" />
> 
> <add name="WebDAVModule" /> 
> ```

```
<add name="WebDAV" path="*"
 verb="PROPFIND,PROPPATCH,MKCOL,PUT,COPY,DELETE,MOVE,LOCK,UNLOCK"
 modules="WebDAVModule" resourceType="Unspecified" requireAccess="None"
 /> 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-08-28T08:59:39.307

我加`requireAccess="None"`了`web.config`喜欢这个

```
 <configuration>
  <location path="." inheritInChildApplications="false">
    <system.webServer>
      <handlers>
                <remove name="ExtensionlessUrlHandler-Integrated-4.0" />
                <remove name="WebDAV" />
        <add name="aspNetCore" path="*" verb="*" modules="AspNetCoreModuleV2" resourceType="Unspecified" requireAccess="None"/>
                <add name="WebDAV" path="*" verb="PROPFIND,PROPPATCH,MKCOL,PUT,DELETE,COPY,MOVE,LOCK,UNLOCK" modules="WebDAVModule" resourceType="Unspecified" requireAccess="None" />
                <add name="ExtensionlessUrlHandler-Integrated-4.0" path="*." verb="GET,HEAD,POST,DEBUG,DELTE" type="System.Web.Handlers.TransferRequestHandler" resourceType="Unspecified" requireAccess="Script" preCondition="integratedMode,runtimeVersionv4.0" responseBufferLimit="0" />
      </handlers>
      <aspNetCore processPath=".\Informing.Gateway.Api.exe" stdoutLogEnabled="false" stdoutLogFile=".\logs\stdout" hostingModel="InProcess" />
    </system.webServer>
  </location>
</configuration> 
```

它奏效了。而已

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-12-30T10:28:09.737

试错不是解决此问题的正确方法。需要做的是：

*   识别阻止您的 PUT/DELETE 请求的来源
*   然后你可以删除它，禁用它甚至更好地配置它：

1-为了知道来源，您必须在 IIS 中配置失败的请求跟踪。 [![在此处输入图像描述](../Images/0de9a94d748a455ff8b9ab331e27549e.png)](https://i.stack.imgur.com/bwecP.png) 2-您有“添加”要记录的错误 确保您为此跟踪条目使用较短的生命周期，以避免日志文件使您的系统不堪重负。IIS 将为每个调用生成一个单独的 xml 文件。3- 使用 Postman 或 Swagger 发出错误请求以生成跟踪错误条目。4- 在上一个屏幕中，您可以选择“查看跟踪日志”以将您带到生成的日志文件。5- 使用 Internet Explorer 打开错误的日志文件。并接受任何消息。 6-注意阻止您的请求的来源。 7-从 IIS 界面或 web.config 在模块或映射处理程序中禁用它，如其他海报所示。[![在此处输入图像描述](../Images/a0751ed78f6a96a55d227c6a99ff026c.png)](https://i.stack.imgur.com/MjoxV.png) [![在此处输入图像描述](../Images/ce9886ebbd7822b0767272686d058026.png)](https://i.stack.imgur.com/rUHoy.png)[![在此处输入图像描述](../Images/6db95e4c46d19457127d762bd2414932.png)](https://i.stack.imgur.com/zwsLr.png)[![在此处输入图像描述](../Images/cc04680709381336503f521b91b2e0a2.png)](https://i.stack.imgur.com/PfQKA.png)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2017-06-08T06:07:59.307

在 IIS 8.5/Windows 2012R2 中，这里没有提到对我有用。我不知道删除 WebDAV 是什么意思，但这并没有为我解决问题。

对我有帮助的是以下步骤；

1.  我去了IIS管理器。
2.  在左侧面板中选择了站点。
3.  在左侧工作区，选择 WebDAV，双击打开。
4.  在最右边的面板中，禁用它。

现在一切正常。

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2015-09-16T18:42:27.613

您可以将您的 Delete 方法转换为 POST 为；

```
 [HttpPost]
 public void Delete(YourDomainModel itemToDelete)
 {
 } 
```**

# javascript - 在 Javascript 的 if 语句中声明变量是错误的吗？

> ID：10906414
> 
> 赞同：3
> 
> 时间：2012-06-05T23:34:38.487
> 
> 标签：javascript

我在 Sublime Text 2 中安装了一个 Sublimelinter，它很棒。但是它不喜欢以下代码：

```
if(condition){
    var result = 1;
}else{
    var result = 2;
}
process(result); 
```

它说`var result = 2;`该结果已定义并且已`process(result);`超出范围使用。是否只是`{}`将 if 语句误认为是更封闭的范围，还是我真的应该这样做：

```
var result;
if(condition){
    result = 1;
}else{
    result = 2;
}
process(result); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T23:35:59.360

不，这不是“错误”；根据 ECMAScript 规范，它将被提升到最近的函数定义的顶部。

是的，您的程序“Sublimelinter”声称变量超出范围是不正确的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T23:37:56.760

这没有错。如果您收到该错误，则说明您`result`之前在代码中定义过。

您还可以将您的条件简化为此，因此您不必使用结果：

```
process( condition ? 1 : 2 ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T23:44:19.410

Javascript 不像许多其他语言那样具有“块范围”。如果是这样，`result`当您尝试调用时，该变量将不存在，`process(result)`因为无法在`{}`定义它的块之外引用它。

但是，javascript 只有函数作用域，其中一个函数中的变量不能被另一个函数访问。在函数中声明变量的位置没有任何意义，因为它仍然可以从该函数内的任何地方访问（没有块范围）。因此，您发布的两个代码片段都等同于运行代码的任何解释器。

第二个更可取，因为它更清楚地显示了将在何处使用变量（在整个函数中）。它还可以防止变量在函数范围内被声明两次，这不一定会导致任何不好的事情发生，但绝对不会导致任何有益的事情发生。您几乎应该总是在较高级别声明一个变量，而不是在不同的较低级别声明两次，尽管这并不重要，因为无论在何处声明变量的范围都是整个函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T23:38:01.520

JavaScript 没有块作用域。变量的范围仅限于定义它们的函数，这意味着当您在`if`块内声明变量时，它被“提升”到函数的顶部。

由于变量在技术上无论如何都是在函数的顶部定义的，因此将变量声明移动到函数的顶部被认为是一种最佳实践，这样代码的意图就很清楚了。

我会说你的代码不是“错误的”，但它会误导那些阅读代码的人，他们不熟悉 JavaScript 中作用域的工作原理。我肯定会选择第二个版本，因为它实际上反映了代码的执行方式。

这是一篇解释变量提升[的好文章。](http://www.adequatelygood.com/2010/2/JavaScript-Scoping-and-Hoisting)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-07T00:31:56.787

事实证明，SublimeLinter 正在使用 JSHint，它可以选择隐藏此警告并解释其存在的原因。

* * *

> **funcscope**此选项在稍后从外部访问它们时抑制有关在控制结构内部声明变量的警告。尽管 JavaScript 只有两个真正的作用域——全局和函数——但这种做法会导致语言新手的困惑和难以调试的错误。这是默认情况下，JSHint 警告在其预期范围之外使用的变量的方式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-05T23:38:26.310

在你有 if 语句的函数中声明你的 var 指针一次。就像 ninjagecko 提到的那样，所有的 vars 都会被发送到它们包含的函数的顶部。

然而; 请务必小心，因为如果您两次声明相同的 var，它将重置 var。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-05T23:39:02.917

我建议这样做：

```
var result = MORE_LIKELY_OUTCOME;

if (LESS_LIKELY_CONDITION) {
    result = LESS_LIKELY_OUTCOME;
}

process(result); 
```

通过这种方式，您最初将结果设置为您在大多数情况下所期望的结果。然后，`if`如果条件发生，该语句将更改结果。

# iphone - 带有动作的UITabBarButton

> ID：10906417
> 
> 赞同：1
> 
> 时间：2012-06-05T23:35:01.023
> 
> 标签：iphone, ios, uitabbarcontroller, uitabbar, uitabbaritem

如何添加带有触发模式视图的按钮的 UITabBarButton，而不仅仅是显示选项卡栏视图控制器的视图之一？RedLaser 做到了这一点。注意下面的红色“扫描”按钮。此外，我怎样才能用我自己的图像替换其中一个选项卡栏项目，而不仅仅是在它上面拍一个图像视图？图像需要跨越栏项的整个区域。

![红激光：](../Images/f25d80952e46e71a0a6d656708af1029.png)

Instagram 也使用“分享”按钮来做到这一点： ![在此处输入图像描述](../Images/8a99a47795f4293bf438de5ec967543f.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T23:40:39.537

刚刚意识到我的疏忽——只需为标签栏创建一个新的背景图像并将其加载。在该图像上，包含需要遍历整个标签栏项目的任何其他图像。

# c - 何时/如何释放从函数返回的指针

> ID：10906419
> 
> 赞同：0
> 
> 时间：2012-06-05T23:35:39.043
> 
> 标签：c, debugging, pointers, free

我有这个功能：

```
char * folderFromPath(char *path)
{
  printf("\nentered folderFromPath\n");

  char *token[80];
  int i = 0;  
  const int STR_LEN = 128;
  char str[STR_LEN];
  char *folder;
  folder = malloc(sizeof(path));
  strcpy(folder,"/");

  if (strlen(path) > STR_LEN)
  {
    printf("Warning: strlen(path) > STR_LEN, (%d > %d) in function folderFromPath\n", strlen(path), STR_LEN);
  }
  else
  {
      printf("path: %s\n", path);

    strcpy(str,path);

    token[0] = strtok(str, "/");

    while (token[i]!= NULL)
    {
      i++;
      token[i] = strtok (NULL, "/");
      printf("token[i]: %s, i: %d\n", token[i], i);
    }

    if (folder != NULL)
    {
        int j = 0;
        while (j < (i-1))
        {
              strcat(folder,token[j]);
              strcat(folder,"/");
            j++;
        }

        printf("folder: %s\n", folder);

    }

  } /* else if (strlen(path) < STR_LEN) */

  return folder;

} 
```

在其中你可以看到我已经动态分配了指向的内存`folder`。您还可以看到该文件夹​​返回给调用函数。[我在这篇文章](http://www.daniweb.com/software-development/c/threads/129372/how-to-free-pointers-which-are-to-be-returned)中看到建议在调用函数中使用指针后释放指针。这就是我所做的。这是调用函数：

```
void open_activated(GtkWidget *widget, GtkWindow *parent)
{
  GtkSourceLanguage *lang;
  GtkSourceLanguageManager *lm;
  GtkWidget *dialog;
  GtkWidget *tablabel;
  GtkTextBuffer *tbuffer;
  int openTabs = 0;
  char *folder1;
  const gchar *folder2;
  int page = 0;
  char *path;

  page = gtk_notebook_get_current_page(GTK_NOTEBOOK(notebook));
  path  = paths[notebookPages[page]];
  folder1 = folderFromPath(path);
  folder2 = folder1;

  dialog = gtk_file_chooser_dialog_new("Open File", parent, GTK_FILE_CHOOSER_ACTION_OPEN,GTK_STOCK_CANCEL,GTK_RESPONSE_CANCEL,GTK_STOCK_OPEN,GTK_RESPONSE_ACCEPT,NULL);
  gtk_file_chooser_set_current_folder (GTK_FILE_CHOOSER(dialog), folder2);
  free(folder1); 

  tbuffer = gtk_text_view_get_buffer(GTK_TEXT_VIEW(txtinput[openedPages]));

  gtk_source_buffer_begin_not_undoable_action(GTK_SOURCE_BUFFER(tbuffer));

  if(gtk_dialog_run(GTK_DIALOG(dialog))== GTK_RESPONSE_ACCEPT)
  {

    ...

  } /* if(gtk_dialog_run(GTK_DIALOG(dialog))== GTK_RESPONSE_ACCEPT) */

  gtk_widget_destroy(dialog);
  changeLabelColor("black");
  gtk_text_buffer_set_modified (gtk_text_view_get_buffer((GTK_TEXT_VIEW(txtinput[openedPages]))), FALSE);

  gtk_source_buffer_end_not_undoable_action(GTK_SOURCE_BUFFER(tbuffer));
  write_config_files();

  verifyPaths();  

} 
```

当我尝试打开文件时，应用程序中止并生成以下语句：

```
*** glibc detected *** ./ledit: free(): invalid next size (fast): 0x082a80c8 *** 
```

所以我的问题是这个错误是什么意思，我应该做些什么来正确释放指针？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T23:38:46.613

主要问题大概就是这个。

```
char * folderFromPath(char *path)
...
folder = malloc(sizeof(path)); 
```

您正在分配`sizeof(path)`，这与 相同`sizeof(char*)`，因为`path`是 a `char*`。您只分配了足够的字节来保存一个指针，而不是整个路径，这可能是您想要的。

请尝试：

```
folder = malloc(strlen(path)+1); 
```

很可能还有其他问题；我没有仔细看。它看起来好像你`folder`在将它传递给之后正确地释放了它`gtk_file_chooser_set_current_folder()`，虽然我不知道你为什么也将它分配给它`folder2`。如果您期望该分配复制字符串（GTK 函数是否期望获得路径的所有权？）那么您将感到失望；您将不得不使用`strncpy()`或类似的方式获取字符串的单独副本。

# c# - 如何以编程方式打开受密码保护的 PDF 文件？

> ID：10906422
> 
> 赞同：3
> 
> 时间：2012-06-05T23:36:06.420
> 
> 标签：c#, .net, pdf, password-protection

Adobe IFilter 不提供提供密码以打开受密码保护的 PDF 文件的机制，因此它不能用于打开受密码保护的文件。

我想知道，是否有一种相对简单的方法可以以编程方式检索 PDF 文件中的实际加密数据，使用标准加密 API 对其进行解密，然后使用解密的数据构建一个新的 PDF 文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T23:48:57.423

如果您使用 SpirePDF，那么您可以从加密的 PDF 中获取页面的图像，如下所示：

```
using System;
using System.Drawing;
using Spire.Pdf;
namespace PDFDecrypt
{
    class Decrypt
    {
        static void Main(string[] args)
        {
            //Create Document
            String encryptedPdf = @"D:\work\My Documents\Encryption.pdf";
            PdfDocument doc = new PdfDocument(encryptedPdf, "123456");

            //Extract Image
            Image image = doc.Pages[0].ImagesInfo[0].Image;

            doc.Close();

            //Save
            image.Save("EmployeeInfo.png", System.Drawing.Imaging.ImageFormat.Png);

            //Launch
            System.Diagnostics.Process.Start("EmployeeInfo.png");
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T06:10:08.840

要打开受密码保护的 PDF，您至少需要开发一个 PDF 解析器、解密器和生成器。不过，我不建议这样做。这远非一项容易完成的任务。

在 PDF 库的帮助下，一切都变得简单多了。您可能想为该任务尝试[Docotic.Pdf 库](https://bitmiracle.com/pdf-library/)（免责声明：我为该库的供应商工作）。

这是您的任务示例：

```
public static void unprotectPdf(string input, string output)
{
    bool passwordProtected = PdfDocument.IsPasswordProtected(input);
    if (passwordProtected)
    {
        string password = null; // retrieve the password somehow

        using (PdfDocument doc = new PdfDocument(input, password))
        {
            // clear both passwords in order
            // to produce unprotected document
            doc.OwnerPassword = "";
            doc.UserPassword = "";

            doc.Save(output);
        }
    }
    else
    {
        // no decryption is required
        File.Copy(input, output, true);
    }
} 
```

Docotic.Pdf 还可以[从 PDF 中提取文本（格式化或非格式化）](https://bitmiracle.com/blog/extract-text-from-pdf-in-net)。它可能对索引很有用（我想这就是你要做的，因为你提到了 Adob​​e IFilter）

# c - 向数组添加多个值

> ID：10906425
> 
> 赞同：0
> 
> 时间：2012-06-05T23:36:22.893
> 
> 标签：c, arrays

我需要一个数组来保存在函数中定义的 4 个值`fn1`，所以我创建了一个数组`int somearray[4]`：在 main() 中。虽然我知道值可以通过 number: 单独输入到数组`somearray[1]=3;`中，但我的数字在 variables 中`n1, n2, n3, n4`。

有没有办法做到这一点？

我已经考虑过在函数中创建一个数组，然后将单个值传输到`somearray[]`.

我显然对 C 很陌生，并且还想到了返回数组的想法。我很确定这是不对的，但无论如何进行确认会有所帮助。

提前致谢。

致诚：

```
main(){
int sumarray[4];
int n1,n2,n3,n4;

int fn1(){
n1=1;
n2=23;
n3=29;
n4=14;

sumarray[]={n1,n2,n3,n4}

return 0;
}

return 0;
} 
```

好吧..至少那是我试图做的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T01:35:08.483

好的，错误是尝试在函数内定义数组，而我可以在运行 fn1 后定义数组。多谢你们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T23:40:27.097

您可以执行以下操作：

```
char somearray[] = {n1, n2, n3, n4}; 
```

如果你写了一个辅助函数，把数组分配到栈上（即把数组放在一个局部变量中），那么就不能返回了。这是因为它在堆栈上，并且将来基本上会被覆盖。例如，你*不会*说：

```
int *f() { 
    unsigned a[] = {n1, n2, n3, n4};
} 
```

相反，您使用，它在*堆上*`malloc`分配内存。所以，相比之下，你*可以*说，

 **```
int *f() {
    unsigned *a = malloc(sizeof(int)*4);
    ...
    return a;
} 
```**

# google-closure-library - Why can't I call goog.require() in the same code block in which I call a function from the loaded library?

> ID：10906436
> 
> 赞同：1
> 
> 时间：2012-06-05T23:38:22.977
> 
> 标签：google-closure-library

Here is my html.

```
<html>
  <head>
    <script src="closure-library/closure/goog/base.js"></script>
    <script src="hello.js"></script>
  </head>
  <body onload="sayHi()">
  </body>
</html> 
```

And here is my hello.js file.

```
var options = {
    "style" : "background:#EEE;"
}

function sayHi() {
  goog.require("goog.dom");
  var header = goog.dom.createDom("h1", options, "hello world");
  goog.dom.appendChild(document.body, header);
} 
```

Why does Chrome Console issue this error?

```
Uncaught TypeError: Cannot call method 'createDom' of undefined 
```

In general, I don't think I can require a library in the same code block in which I call a function from the library. I just saw this in the documentation, but I was wondering why.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T02:23:14.770

In uncompiled Closure code, each `goog.require(NAMESPACE)` results in a call to:

```
document.write('<script src="SCRIPT_PROVIDING_NAMESPACE"></script>'); 
```

The dependencies are defined with calls to `goog.addDependency(relativePath, provides, requires)` in deps files generated with [depswriter.py](https://developers.google.com/closure/library/docs/depswriter). Using the Chrome Developer Tools, the Elements tab shows all of the `<script>` elements dynamically inserted based on the Closure Library dependencies defined in [deps.js](http://code.google.com/p/closure-library/source/browse/trunk/closure/goog/deps.js).

In your example, when `sayHi()` is triggered by the body `onload` event, a new `<script>` element is inserted in the header. However, this new `<script>` element has not yet loaded `goog.dom`. Therefore, `goog.dom` is undefined.

If you change **hello.js** as follows:

```
goog.require("goog.dom");

var options = {
    "style" : "background:#EEE;"
}

function sayHi() {
  var header = goog.dom.createDom("h1", options, "hello world");
  goog.dom.appendChild(document.body, header);
} 
```

Then `goog.require("goog.dom")` gets executed prior to the `onload` event and the inserted `<script>` element has a chance to load `dom.js` prior to the call to `sayHi()`.

# mod-rewrite - url 重写不适用于子域中的页面

> ID：10906447
> 
> 赞同：0
> 
> 时间：2012-06-05T23:39:18.933
> 
> 标签：mod-rewrite

我需要更改`abc.mydomain.com/xyz.php?id3=se` 为`abc.mydomain.com/xyz/se/`url 重写。这是我在 .htaccess 中的代码（放在 abc 文件夹中）

```
 Options +FollowSymLinks
 RewriteEngine on
 RewriteRule /xyz/([0-9a-zA-Z]+) /xyz.php?id3=$1 
```

我正在使用托管服务器。

也尝试过，`Options +FollowSymLinks`但仍然无法正常工作。感谢某人的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T15:58:14.897

我猜你必须从“/xyz.php?id3=$1”中删除“/”。您在 abc 文件夹 '/www/abc' 中，并且您的 .htaccess 在同一个文件夹中，因此“/”使服务器认为页面 xyz.php 位于 /www 而不是 / 的根文件夹中万维网/美国广播公司！我有同样的问题，我用这种方法解决了！所以试试这个代码：

```
 Options +FollowSymLinks
 RewriteEngine on
 RewriteRule /xyz/([0-9a-zA-Z]+) xyz.php?id3=$1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T17:32:01.750

在规则中添加域名：

```
RewriteRule http://example.com/xyz/([0-9a-zA-Z]+) http://example.com/xyz.php?id3=$1 
```

# php - MySQL 按天分组，然后显示分组结果中的日期

> ID：10906448
> 
> 赞同：-1
> 
> 时间：2012-06-05T23:39:25.527
> 
> 标签：php, mysql

所以我有一大堆选票进入投票系统。我想显示我在任何一天有多少票。但我也想然后，显示每天的票数并吐出他们在哪一天投票，即 24k 票在 05/06/12，27k 票在 06/06/12

```
SELECT count(*) AS count
FROM results 
GROUP BY DAY(datesubmitted), YEAR(datesubmitted), MONTH(datesubmitted) 
ORDER  BY DAY(datesubmitted) DESC, YEAR(datesubmitted) DESC, MONTH(datesubmitted) DESC 
```

是我的查询，我尝试添加类似

> DAY(FROM_UNIXTIME(datesubmitted)) 作为 order_day

但这只是抛出一个我觉得有趣的空值，因为我希望查询失败，因为没有任何外部。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T01:15:46.717

你为什么不干脆`GROUP BY datesubmitted DESC`？此外，如果它遵循与 GROUP BY 相同的标准，则无需 ORDER BY。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T23:53:05.957

特定日期的投票数：

```
SELECT COUNT(*) AS total
FROM results 
WHERE datesubmitted BETWEEN @dateMin AND @dateMax 
```

每一天的票数：

```
SELECT COUNT(*) AS total, DATE(datesubmitted) AS day
FROM results 
GROUP BY DATE(datesubmitted)
ORDER BY DATE(datesubmitted) DESC 
```

**再次更新**

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-05T23:56:14.997

所以刚刚看到一个新的答案，但对我来说，我是如何让它工作的：

```
SELECT count(*) AS count, DAY(datesubmitted) AS newday, 
YEAR(datesubmitted) as newyear ,MONTH(datesubmitted) as newmonth
FROM results 
GROUP BY DAY(datesubmitted), YEAR(datesubmitted), MONTH(datesubmitted) 
ORDER  BY  YEAR(datesubmitted) DESC, MONTH(datesubmitted) DESC, DAY(datesubmitted) DESC 
```

这样我就可以正确地获得年、月和日的正确排序，并且它还显示日期。我可以连接它们，但那是另一天。

# c# - 如何仅在用户提交表单后才显示 EmptyDataText？

> ID：10906450
> 
> 赞同：0
> 
> 时间：2012-06-05T23:39:43.327
> 
> 标签：c#, asp.net, gridview, asp.net-4.0

[我刚刚使用Microsoft 在此处的演练](http://msdn.microsoft.com/en-us/library/tw738475.aspx)创建了一个基本的 ASP.NET 网站。它有一个带有表单的页面，该表单接受一些文本输入，基于该表单运行数据库查询，并将结果生成为`GridView`. 我将[`EmptyDataText`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.emptydatatext%28v=vs.100%29.aspx)属性添加到 my`GridView`以在用户的​​搜索未返回任何结果时显式显示用户。

这一切都按预期工作，但有一个例外：

IIS 显示`EmptyDataText`“未找到结果”。甚至*在*提交搜索表单之前。

这违背了我使用 的目的`EmptyDataText`，即向用户表明网页成功提交了他们的搜索但没有找到结果，而不是把他们的搜索扔到以太中。

例如，搜索无法找到的内容的用户将看到“未找到结果”。在搜索之前和之后，而不是之前没有任何结果和“未找到结果”。后。前一种行为给人的印象是搜索不起作用。

如何将我的配置`GridView`为`EmptyDataText`仅*在*提交搜索表单后显示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T05:09:26.010

您正在使用将在加载页面时自动绑定的**sqldatasource 。**单击搜索按钮时以编程方式绑定gridview

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T23:52:53.570

在用户启动搜索之前不要绑定您的 GridView。当您将 GridView 与具有 0 条记录的数据源绑定时，`EmptyDataText`将显示 。

您可能会将其绑定在 Page_Load 上。

**编辑**

无论在代码中执行 DataBind() 的任何位置（动作处理程序除外），都将其删除。您的 DataBind() 应该只发生在接收用户操作的处理程序中。

如果 Visual Studio 正在使用自动绑定在幕后做一些巫术，您始终可以将网格默认为不可见。在用户启动搜索时使其可见。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T23:59:46.227

只是不要在搜索**之前**对其进行数据绑定，直到那时它实际上是完全不可见的。

**更新：**也许您正在使用 DataSourceID （自动绑定数据）？

**更新 2：**首先，出于什么原因投反对票（至少有礼貌地发表评论）？如果不是我，OP 仍然不知道问题出在哪里 - 其次，只需`DataSourceID`从声明中删除该属性，并在用户进行搜索时将其从代码隐藏中设置回来（您可能想要调用该`GridView DataBind()`方法之后手动，但前提是它自己不这样做 - 不先尝试）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T17:46:41.493

正如其他答案所建议的那样，`GridView`由于它具有`DataSourceID`属性，因此在用户进行搜索之前被绑定。正如[MSDN 上](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.aspx)所解释的，此属性会导致`GridView`自动绑定到指定的源：

> 若要绑定到数据源控件，请将 GridView 控件的 DataSourceID 属性设置为数据源控件的 ID 值。GridView 控件自动绑定到指定的数据源控件，并且可以利用数据源控件的功能来执行排序、更新、删除和分页。这是绑定数据的首选方法。

为了获得我正在寻找的行为，我从 中删除了该属性`GridView`，而是`OnClick`在我的搜索表单的提交按钮中添加了一个属性。该`OnClick`属性是指`BindGridView`仅在用户提交表单时才调用的方法。

这个方法所做的就是`DataSourceID`用它之前作为属性的相同值填充 ：

```
public void BindGridView(object sender, EventArgs e)
{
    GridView1.DataSourceID = "DataSourceID1";
} 
```

# php - 使用 PHP 脚本中的变量执行 .sql 文件

> ID：10906452
> 
> 赞同：0
> 
> 时间：2012-06-05T23:39:57.437
> 
> 标签：php, mysql

我有很长的 SQL 文件，其中包括以下`$variable`格式：

```
DELIMITER $$
DROP TRIGGER IF EXISTS `$variable` $$
    CREATE TRIGGER `TEMP` BEFORE INSERT ON `5_2012`
    FOR EACH ROW BEGIN
      set NEW.chour = timediff(NEW.exit, NEW.enter);
      set NEW.total = timediff(NEW.exit, NEW.enter);
... 
```

我需要一种方法来每次使用不同的表名（`$variable`）执行此脚本。

我正在使用 MySQL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T23:51:45.197

将 .sql 文件更改为 .php 脚本 在顶部添加标题，并添加 mime 类型。如果我没记错的话，它是application/x-sql。回显每个变量。

```
<?php
header("Content-type: application/x-sql");
?>

DELIMITER $$ 
DROP TRIGGER IF EXISTS `<?= $variable; ?>` $$
CREATE TRIGGER `TEMP` BEFORE INSERT ON `5_2012` 
FOR EACH ROW BEGIN   
    set NEW.chour = timediff(NEW.exit, NEW.enter);
    set NEW.total = timediff(NEW.exit, NEW.enter); 
```

# compiler-construction - JavaCompiler 在“ToolProvider.getSystemJavaCompiler()”上给出 NullPointerException。我很确定我已经设置了 JDK 对吗？

> ID：10906456
> 
> 赞同：0
> 
> 时间：2012-06-05T23:40:11.413
> 
> 标签：compiler-construction, nullpointerexception, java

有问题的代码部分是：

```
String fileToCompile = "C:/Users/Jeff/Documents/Test/Compiler 6/examplejavafile.java";//Absolute path
JavaCompiler compiler = ToolProvider.getSystemJavaCompiler();
FileOutputStream errorStream = new FileOutputStream("Errors.txt");
int compilationResult = compiler.run(null, null, errorStream, "-verbose", fileToCompile);
if(compilationResult == 0){
    System.out.println("Compilation is successful");
}else{
    System.out.println("Compilation Failed");
} 
```

当我运行这部分代码时，它给了我 NPE：

```
JavaCompiler compiler = ToolProvider.getSystemJavaCompiler(); 
```

现在我被告知这是环境中的错误，但我安装了 JDK，并且我的 CLASSPATH 变量设置为“C:\Program Files\Java\jdk1.7.0_04\bin”。我可能是个菜鸟，不明白如何通过 JDK 而不是 JRE 运行程序，但不管我需要帮助。（另外，我正在使用 Eclipse，如果它有任何不同的话。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T23:58:23.297

查找项目的运行配置（在运行菜单下）。在 JRE 下应该指定项目执行环境是使用 'JavaSE-1.6' (jsk1.6.20_32) 等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-07T20:20:48.287

ToolProvider.getSystemJavaCompiler() 不可用。

类路径中是否缺少 tools.jar？

`Set class path to the tools.jar`可以在 jdk\jre 目录中找到的文件。

`System.setProperty("java.home", "C:\\Program Files\\Java\\jdk1.7.0_02");`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-05T23:42:12.570

您需要导入 ToolProvider，因为它没有定义，除非您只是没有包含该信息。

```
import javax.tools.ToolProvider; 
```

# .net - Windows 服务和获取当前操作

> ID：10906457
> 
> 赞同：0
> 
> 时间：2012-06-05T23:40:13.843
> 
> 标签：.net, wcf

我需要创建一个 Windows 服务来监视文件夹并处理它找到的任何新文件，所以基本上它会做一些后台处理。我还想创建一个客户端（winform/website/etc...），它可以“向”windows 服务“询问”它当前正在运行的文件列表。

我正在考虑创建一个 WCF 服务，然后让我的客户端调用“GetFiles()”操作或类似的操作。我计划在服务启动时创建一个新线程，该线程将专用于处理文件或一些后台处理。

有更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T01:33:37.157

> 我打算在服务启动时创建一个新线程

你的意思是 Windows 或 WCF 服务从这里开始？如果是 WCF - 不需要单独的线程。如果您使用默认绑定在 Windows 服务中托管服务，WCF 会为您创建它。

其他一切看起来都很好。

# silverlight - 如何从 Windows Phone 7 数据模板中的许多元素中获取特定元素

> ID：10906461
> 
> 赞同：0
> 
> 时间：2012-06-05T23:40:19.403
> 
> 标签：silverlight, windows-phone-7, datatemplate

我的列表框：

```
 <ListBox x:Name="listBox" Grid.Row="2" FontSize="26" SelectionChanged="listBox_SelectionChanged" ItemsSource="{Binding SelectedSubGenre.PhotoCollection}">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <Border BorderBrush="BurlyWood" BorderThickness="1,1,1,1" Margin="0,0,12,24">
                                <StackPanel Orientation="Vertical" HorizontalAlignment="Left">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                        <Image Source="{Binding Path}" Height="200" HorizontalAlignment="Left" Width="200" Margin="12,12,12,12"/>
                                        <Button Foreground="yellow" Click="Button_Click" Height="150" Width="150" Content="add"/>
                                    </StackPanel>
                                    <TextBlock Text="{Binding Name}" Margin="12,0,0,0"/>    
                         </StackPanel>
                            </Border>

                        </DataTemplate>
                    </ListBox.ItemTemplate>    
        </ListBox> 
```

单击按钮时，我想对按钮的相邻图像执行某些操作，如何在代码中指定此特定图像？如何根据不同的按钮点击获取相邻图像

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T23:52:24.103

在按钮单击回调中，执行以下操作：

```
var btn = sender as Button;
var dc = btn.DataContext as YourDataObject;
dc.Path = "/path/to/new/image.jpg"; 
```

您可能必须使用值转换器将路径从字符串更改为`BitmapImage`.

# c# - 我们如何在 C# 整数数组中找到项目数？

> ID：10906471
> 
> 赞同：7
> 
> 时间：2012-06-05T23:40:50.037
> 
> 标签：c#, arrays, count, integer

我需要在 C# 数组中找到整数类型的项目计数。

我的意思是;

```
int[] intArray=new int[10]
int[0]=34
int[1]=65
int[2]=98 
```

intArray 的项目数为 3。

我在下面找到了 strArray 的代码，但它不适用于 int 数组。

```
string[] strArray = new string[50];
...
int result = strArray.Count(s => s != null); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-05T23:44:12.663

好吧，首先你必须决定什么是无效值。是0吗？如果是这样，你可以这样做：

```
int result = intArray.Count(i => i != 0); 
```

请注意，这仅有效，因为默认情况下，int 数组的元素被初始化为零。如果 0 在您的情况下最终有效，您必须事先用不同的无效值填充数组。

另一种方法是使用可为空的类型：

```
int?[] intArray = new int?[10];
intArray[0] = 34;
intArray[1] = 65;
intArray[2] = 98;

int result = intArray.Count(i => i.HasValue); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T23:58:44.053

虽然 itsme86 为您的[实际问题提供了一个很好的答案](https://stackoverflow.com/a/10906496/65358)，但我怀疑您最好重新考虑如何完全编写它。

如果这是您的目标，我建议您以不同的方式考虑这一点。而不是分配一个固定大小的数组，并且只为其分配特定的值，您可能需要考虑使用`List<int>`：

```
List<int> intList = new List<int>();

intList.Add(34);
intList.Add(65);
intList.Add(98); 
```

项目的数量将始终为`intList.Count`，您可以通过这种方式添加任意数量的项目，而不必担心“分配的大小”，因为列表会根据需要自动增长。*如果您将其作为实际值*`0`添加到列表中，它也不会给您带来不好的结果，如果它是一个有效值，计算非零元素将不计为零。

 *请注意，您也可以按索引访问项目，就像使用数组一样：

```
int secondValue = intList[1]; // Access like you do with arrays 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T23:45:02.433

```
int[] intArray=new int[3]  // Edit: Changed this to 3 to make my answer work. :)
int[0]=34
int[1]=65
int[2]=98

int count = intArray.Length; // <-- Is this what you're after? 
```

## 编辑：

咳咳。正如我谦虚地指出的那样，`Length`将返回数组中的元素总数，在您的示例中为 10。如果您正在寻找数组中*非零*元素的数量，您应该按照建议进行操作在其他一些答案中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T23:52:20.467

当您在不指定任何值的情况下初始化整数数组时，[C# 将零值分配给每个元素](http://msdn.microsoft.com/en-us/library/0a7fscd0.aspx)。因此，如果零不是您的数组的有效值，您可以随时进行测试。

或者，您可以将数组的元素初始化为在您的上下文中无效的某个值（即，如果负数无效，则初始化为-1），然后循环遍历数组，计算有效元素。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-06T02:05:18.320

如果保证数组只能按顺序访问，您可以通过一点分而治之来击败完整的迭代 IEnumerable Count（对于更大的数组），例如

```
static int DivideCount(int[] arr, int idx, int bottom, int top)
{
    if (idx <= 0)
        return 0;
    else if (idx >= arr.Length - 1)
        return arr.Length;
    else if (arr[idx] == 0 && arr[idx - 1] != 0)
        return idx;
    else if (arr[idx] == 0 && arr[idx - 1] == 0)
        return DivideCount(arr, bottom + ((idx - bottom) / 2), bottom, idx);
    else if (arr[idx] != 0 && arr[idx - 1] != 0)
        return DivideCount(arr, top - ((top - idx) / 2), idx, top);
    else
        return -1;  // hello compiler
}

int[] intArray = new int[10];
intArray[0] = 35;
intArray[1] = 65;
intArray[2] = 98;

var count = DivideCount(intArray, intArray.Length / 2, 0, intArray.Length); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-08-08T16:35:52.723

如果除您之外的其他人初始化了数组（即，您没有将数组值初始化为无效值的选项——null、-1 等），则之前的解决方案都不是最佳的。

假设你有一个数组：

```
var arr = new[] {0, 10, 18, 0, 20, 0, 0, 0, 0, 0, 0, 0}; 
```

如果您只是计算零条目的数量：

```
int result = arr.Count(i => i != 0); 
```

`Count()`返回 3，实际上已经初始化了 5 个条目。一个例子是从音频文件中读取到缓冲区的原始字节数组，您想知道最后读取的元素的索引。

An alternative that isn't perfect but could do what you're looking for is to look for the last non-zero entry, as described here: [Linq - Get the Index of the Last Non-Zero Number of Array](https://stackoverflow.com/questions/14049077/linq-get-the-index-of-the-last-non-zero-number-of-array)*

# ruby-on-rails-3.1 - 为什么我在迁移中收到错误“未定义的方法 `write_inheritable_attribute'”？

> ID：10906472
> 
> 赞同：0
> 
> 时间：2012-06-05T23:41:05.420
> 
> 标签：ruby-on-rails-3.1

我试图生成如下迁移：

```
rails generate migration RemovefromGenotypes box:integer well:string 
```

但后来我得到这个错误：

```
/usr/share/rails-ruby1.8/railties/lib/rails_generator/options.rb:32:in `default_options': undefined method `write_inheritable_attribute' for Rails::Generator::Base:Class (NoMethodError)
    from /usr/share/rails-ruby1.8/railties/lib/rails_generator/base.rb:90:in `<class:Base>'
    from /usr/share/rails-ruby1.8/railties/lib/rails_generator/base.rb:85:in `<module:Generator>'
    from /usr/share/rails-ruby1.8/railties/lib/rails_generator/base.rb:48:in `<module:Rails>'
    from /usr/share/rails-ruby1.8/railties/lib/rails_generator/base.rb:6:in `<top (required)>'
    from /home/caseyr/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    from /home/caseyr/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    from /usr/share/rails-ruby1.8/railties/lib/rails_generator.rb:34:in `<top (required)>'
    from /home/caseyr/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    from /home/caseyr/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    from /usr/share/rails-ruby1.8/railties/bin/rails:14:in `<main>' 
```

我不知道从哪里开始调试这个，但如果有人能指出我正确的方向，我会很感激......

谢谢！--瑞克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T09:54:06.300

在rails 3.2.6之后安装rails 2.3.14时发生在我身上

似乎 rails 2.3 覆盖了一些 rails 3 文件。通过删除 2.3 并重新安装 3.2 修复

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-18T08:03:52.720

我有同样的问题。使用以下命令，问题就消失了

```
 gem install rails 
```

这将安装更新的导轨并再次找到所有工作。

# c++ - 使用 std 指令在文本文件中搜索单词

> ID：10906475
> 
> 赞同：0
> 
> 时间：2012-06-05T23:41:10.950
> 
> 标签：c++, search, text-files, sequence

我认为这不是一个困难的问题，但我想知道如何以 C++ 的方式做到这一点。我想搜索定义的单词或序列的位置。

我读了这篇文章[堆栈类似的问题](https://stackoverflow.com/questions/4722933/using-stl-to-search-for-raw-bytes-and-replace-it-in-a-file-what-is-the-best-c)，答案看起来很棒。但我不知道如何将此解决方案应用于文件。这个 std 指令很容易应用于 a 或 a 但我不知道如何应用于文件和序列。

*操作说明：*

```
std::ifstream file;
std::search(std::istreambuf_iterator<char>(file.rdbuf()) // search from here
          , std::istreambuf_iterator<char>()             // ... to here
          , pSignature                                   // looking for a sequence starting with this
          , pSignature+sigSize);                         // and ending with this 
```

我可以使用字符串存储要在文件中搜索的序列吗？？？

有人可以发布一个如何应用搜索指令的简单示例，我在编译它时总是会遇到很大的错误。

我不使用 Windows，也不想使用 Boost 库。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T00:40:24.137

将文件读入字符串（假设它不是很大）。然后您可以使用 string::find 或 std::algorithm。

```
using namespace std;

// read entire file into a string
ifstream file(".bashrc");
string contents((istreambuf_iterator<char>(file)), istreambuf_iterator<char>());

string needle = "export";

// search using string::find
size_t pos = contents.find(needle);
cout << "location using find: " << contents.find(needle) << endl;

// search using <algoritm>'s search
string::const_iterator it = search(contents.begin(), contents.end(), needle.begin(), needle.end());
cout << "location found using search: " << string(it, it + 10) << endl;
cout << "    at position: " << it - contents.begin() << endl; 
```

[编辑] 您也可以直接使用 istreambug_iterators 进行搜索，但这会给您留下相同类型的迭代器。

```
istreambuf_iterator<char> it2 = search(
        istreambuf_iterator<char>(file), istreambuf_iterator<char>(),
        needle.begin(), needle.end()); 
```

# python - 在 Pyramid 中，拥有一个存储 db 连接的 python 全局变量是否安全？

> ID：10906477
> 
> 赞同：2
> 
> 时间：2012-06-05T23:41:32.243
> 
> 标签：python, pyramid

看起来这就是例如 MongoEngine 所做的。目标是让模型文件能够访问数据库，而无需显式传递上下文。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T01:32:47.043

金字塔与它无关。全局需要处理 WSGI 服务器用于为您的应用程序提供服务的任何机制。

例如，大多数服务器每个请求使用一个单独的线程，因此您的全局变量需要是线程安全的。gunicorn 和 gevent 使用 greenlets 提供服务，这是一种不同的机制。

许多引擎/orms 支持线程本地连接。这将允许您访问您的连接，就好像它是一个全局变量一样，但它是每个线程中的不同变量。您只需确保在请求完成时关闭连接，以避免该连接溢出到同一线程中的下一个请求。这可以使用 Pyramid 补间或食谱中说明的其他几种模式轻松完成。

# eclipse - Eclipse 格式化程序换行分配和方法调用

> ID：10906486
> 
> 赞同：3
> 
> 时间：2012-06-05T23:42:46.050
> 
> 标签：eclipse

有没有一种方法可以配置 eclipse 以通过将 '=' 放在新行上来更喜欢打破长赋值，并避免在 '.' 上中断。方法调用的字符。我注意到一堆设置，例如：

```
<setting id="org.eclipse.jdt.core.formatter.alignment_for_arguments_in_allocation_expression" value="16"/> 
```

可以将其添加到可用于指定格式的 xml 文件中，但我不确定应该更改哪些设置才能达到预期的效果。这些配置是否记录在某处（我尝试谷歌搜索一些相关术语无济于事）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-06T00:13:03.803

您正在寻找的有关分配换行符的设置位于：

```
Window (menu) > Preferences > Java > Code Style > Formatter
> Edit... (on active profile) > Line Wrapping (tab) > Expressions
> Assignments 
```

您可以在其中选择首选的换行策略和缩进策略。

至于避免换行，仍然在选项卡上，将>`Line Wrapping`上的换行策略更改为“不换行”。`Function Calls``Qualified invocations`

在这两种情况下，您都可以使用预览宽度来查看各种策略对代码格式的影响。

# hadoop - 我可以在独立模式下使用 Hadoop 的分布式缓存吗？

> ID：10906490
> 
> 赞同：0
> 
> 时间：2012-06-05T23:43:15.230
> 
> 标签：hadoop, mapreduce

我正在 Hadoop 中编写一个 Java MapReduce 程序，每个 reducer 都需要访问一个静态 XML 文件（其中包含一些关于将规则应用于值列表的业务逻辑）。我决定将此文件存储在分布式缓存中，然后利用分布式缓存 API 在每个减速器中访问它（序列化它）。我还没有实现这个，但是在 HDFS/分布式模式下使用这个功能时，API 看起来很简单。但是，是否可以在伪分布式独立模式下使用它来进行测试？它将如何运作？

另外，在每个 reducer 中序列化文件是不是一个坏主意？我愿意就将“全局静态数据”分发给减速器的其他方式提出建议。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T09:48:20.180

是的，您可以 - 它的工作方式与在真实集群中的工作方式相同。

如果分布式缓存不固定，这是一个好主意。另一种选择是将数据打包到包含作业代码的 jar 中，在这种情况下，当您必须更改 XML 时它不会那么灵活（您仍然可以更改 jar，但这不是一种干净的方法） )

# php - 如何编码、发送查询和检索 url

> ID：10906494
> 
> 赞同：0
> 
> 时间：2012-06-05T23:43:43.537
> 
> 标签：php, get, urlencode

我正在尝试传递一个用于创建 iframe 的 url 作为查询字符串的参数。因为我传递的 url 包含一个 & 符号，所以我使用 'urlencode' 对 url 进行编码，然后将其附加到查询字符串中。

```
<?php
$url = "http://www.somesite.com/index.php?option=content&view=article&id=1234:some+article";
$url_encoded = urlencode($url);
?>

<a href="http://www.mysite.com/external_article_iframe/?url=<?php echo $url_encoded ?>" target="_blank"></a> 
```

在我要创建 iframe 的页面上，我使用 $_GET 变量检索 url 参数。

```
<?php
$iframe_source = $_GET[$url];
?>

<iframe id="external-link-frame" src="<?php echo $iframe_source ?>"></iframe> 
```

但是 $_GET 只检索参数值的一部分，直到编码的 & 符号。

```
<?php echo $_GET[$url]; //outputs http://www.somesite.com/index.php?option=content ?> 
```

我必须做什么才能发送整个 url，包括作为其自身查询字符串一部分的参数。

更新：我可以通过对 url 进行两次编码来做到这一点

```
urlencode(urlencode($url)); 
```

看看：[https ://stackoverflow.com/a/2433211/1359529](https://stackoverflow.com/a/2433211/1359529)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T23:50:40.430

我认为 rawurlencode() 也会对＆符号进行编码。

[http://us3.php.net/manual/en/function.rawurlencode.php](http://us3.php.net/manual/en/function.rawurlencode.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T23:52:30.497

我相信，您如何附加它， $_GET 函数认为与符号表示要获取的新值。我敢打赌，如果你在那之后做了 $iframe_view = $_GET[$view] 它会输出文章。

如果您希望它获得完整的 URL，我认为最好通过将 & 符号替换为其他内容来进行编码，然后在获得 url 后将它们替换回 & 符号。

# c++ - bsearch 包装器

> ID：10906497
> 
> 赞同：1
> 
> 时间：2012-06-05T23:44:15.137
> 
> 标签：c++, templates, lambda, c++11

不久前我只是在玩搜索算法，经过几次基准测试后，我对旧的 bsearch() 与 std::binary_search() 相比要快得多感到印象深刻。我认为任何体面的编译器都可以在可能的情况下用 bsearch() 替换 std::binary_search()，但即使我使用的是 GCC 4.7，bsearch 的执行速度似乎比 std::binary_search 快 5 倍。

所以我认为尝试为 bsearch 创建某种包装器与 std::binary_search 相同的接口将是一个很好的练习。但不知什么原因，我没能做到。这是我的代码：

```
template<typename InputIterator, class T>
bool binary_search(InputIterator first, InputIterator last, const T& value)
{
    auto cmp = [](const void* a, const void* b)
    {
        return (int) ((*(T*)a) == (*(T*)b));
    };

    std::cout << value << std::endl;
    T* res = (T*) bsearch(&value, first, last-first, sizeof(*first), cmp);
    return res != nullptr;
} 
```

代码编译良好，执行时不会崩溃。但是，似乎 bsearch 在一次内部迭代后立即停止（*res 始终等于作为参数传递的选项卡中间的值）。我无法找到它为什么不起作用。所以，如果可能的话，一点帮助就可以了。

谢谢。

* * *

对于那些要求用于检查速度的代码的人：

```
const std::string keyword_str[] = {
    // Some strings
};

int cmp(const void* s1, const void* s2)
{
    return (int) ((*(std::string*)s1) == (*(std::string*)s2));
}

int main()
{
    time_t start, end;
    double dif;
    time (&start);

    // Code
    for (const string& str: keyword_str)
    {
        for (size_t i = 0 ; i < 1000000 ; ++i)
        {
            // std::binary_search (uncomment to check)
            //bool a = std::binary_search(keyword_str, keyword_str+28, str);

            // bsearch
            char** st = (char**) bsearch(&str, keyword_str, 28, sizeof(keyword_str[0]), cmp);
        }
    }

    time (&end);
    dif = difftime (end, start);
    printf("Time spent: %fs.\n", dif);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T23:59:51.700

`bsearch`接受函数指针，而`cmp`不是函数指针。（**编辑：**我错了。因为`cmp`没有捕获任何变量——它的括号是空的——它可以作为函数指针传递。这种行为在 C++11 的§5.1.2/6 中指定标准。）

`bsearch`也不会返回比较函数预期返回的正确值。如果键小于数组元素，它应该返回 -1，如果它们相等，则返回 0，如果键大于数组元素，则返回 1。如果它们不相等，则您的`cmp`函数返回 0，如果它们相等，则返回 1。结果，如果您要比较的第一个元素与键不相等，那么您的`cmp`制造商会`bsearch`认为它们相等并`bsearch`停止，因为它认为它立即找到了正确的元素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T03:53:19.340

一般来说，它不可能用于`bsearch`实现`std::binary_search`，因为`bsearch`它只能搜索一个连续的元素数组，而`std::binary_search`适用于一系列迭代器，适用于任何迭代器类型。它可以是一个链表迭代器、一个双端队列迭代器，或者用户创建的一些自定义的、奇异的迭代器。显然没有办法搜索这些迭代器`bsearch`

# database - 如何保存脸书数据

> ID：10906500
> 
> 赞同：1
> 
> 时间：2012-06-05T23:44:50.237
> 
> 标签：database, facebook, facebook-javascript-sdk

我对 Facebook 应用程序非常陌生，并且有非常基本的问题。我为我的应用程序使用了 javascript SDK，它加载了朋友的名字和他们的个人资料图片。如何将这些数据存储到 MySQL 数据库中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T23:53:39.323

由于您想将数据存储在数据库中，您需要让服务器处理信息并将其放在那里，因此需要一个服务器脚本。

大多数人使用php，所以你需要看看如何从facebook获取数据： [https ://developers.facebook.com/docs/reference/php/](https://developers.facebook.com/docs/reference/php/)

然后如何存储您从 facebook 获得的日期：http: [//www.w3schools.com/php/php_mysql_intro.asp](http://www.w3schools.com/php/php_mysql_intro.asp) （您可以在 google 搜索有大量资源）

牢记关于存储数据的 facebook 指南（不太确定它们的外观）

快乐编码！

# iphone - 使用 UIStoryboard 在哪里注册 applicationWillResignActive

> ID：10906506
> 
> 赞同：0
> 
> 时间：2012-06-05T23:45:41.887
> 
> 标签：iphone

查看开始 iOS 5 中用于持久化应用程序状态的示例，在为应用程序显示的第一个 viewController 中，它们`applicationWillResignActive`在`viewDidLoad:`. 所以这对我来说很有意义，因为您在显示第一个视图时注册该通知。

我对您是否总是这样做，或者您通常在哪里注册此通知感到困惑。Q1) 他们是否在这个 viewController 中注册了这个通知，以便他们可以重新创建这个视图？Q2）如果是这样，我是否为每个 viewController 都这样做？

Q3) 我正在使用 UIStoryboard，我的第一个 viewController 是 UITabBarController。那么我要在第一个选项卡的 viewController 中注册通知吗？

我还有一个单独的 DataManager 对象，它保存应用程序的数据，如果这可以帮助任何人指导我正确的方向，我应该保存我的数据。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T00:12:39.410

这些方法在 AppDelegate.m

```
- (void)applicationWillResignActive:(UIApplication *)application
{
    /*
     Sent when the application is about to move from active to inactive state. This can occur for certain types of temporary interruptions (such as an incoming phone call or SMS message) or when the user quits the application and it begins the transition to the background state.
     Use this method to pause ongoing tasks, disable timers, and throttle down OpenGL ES frame rates. Games should use this method to pause the game.
     */
} 
```

您可以在此处执行您的操作。但是，您可以在另一个视图控制器（如您的示例）中注册以“监听”该事件，但这只是为了更容易将该事件通知发送到该视图控制器。

1) 不，只是为了确保无论何时加载此 VC，它都能够侦听此事件。

2）不，仅适用于您想像这样轻松通过的人。然而，使用 appdelegate.m 并且每个的 vc 视图确实出现了更好。

3) depends on the kind of data you want to save, but typically you create your own file and just save it to disk like in any other OS. ios gives you access to the "documents" folder of your app and each folder is used for something specific, read the documentation.

# iis - 在 Websphere 8 上安装证书以进行身份 验证

> ID：10906507
> 
> 赞同：0
> 
> 时间：2012-06-05T23:45:48.023
> 
> 标签：iis, websphere, certificate, client-certificates

我正在尝试将 .pfx 证书添加到 Websphere8 服务器以建立与 IIS 服务器的连接。我尝试将证书作为个人证书添加到 deaultkeystore，并将与签名证书相同的证书添加到 defaulttrustkeystore。每当我通过我的应用程序发送请求时，我都会收到 401 未经授权的错误。我使用 Wireshark 检查了通信 b/w 服务器，但没有来自客户端或服务器的 FINISHED 消息。

因此，我不知道在 websphere 服务器上安装证书以进行身份​​验证并因此将 XML 作为 HTTPS Post 请求的一部分发送的确切过程。

我联系了网络服务提供商，他说其他用户或已经为此服务实现客户端的人将 pfx 转换为 .cer 并将其与请求一起发送。我也想知道这怎么可能。我正在使用 Java 6 进行编码。

谢谢您的帮助。

# perl - Perl：匹配四个不同的文件并在输出文件中获取特定信息

> ID：10906508
> 
> 赞同：4
> 
> 时间：2012-06-05T23:45:49.213
> 
> 标签：perl

我有四个文件。文件 1（命名为 inupt_22.txt）是一个包含两列（空格分隔）的输入文件。第一列是按字母顺序排列的配体代码列表（特定配体的三个字母/数字代码）。第二列是每个配体代码各自的 PDB 代码（蛋白质数据库代码）列表（尽管是未排序的列表）。![在此处输入图像描述](../Images/caf2cae37a69f5974c82e5aa30e46469.png)

文件 1 (input_22.txt)：

```
 803      1cqp    
    AMH      1b2i    
    ASC      1f9g    
    ETS      1cil    
    MIT      1dwc    
    TFP      1ctr     
    VDX      1db1     
    ZMR      1a4g 
```

文件 2（命名为 SD_2.txt）是每个配体片段的 SDF（结构数据文件）。配体可以包含一个或多个片段。例如，这里的 803 是配体代码，它有两个片段。所以文件看起来像：四个美元符号`$$$$`（每个片段都遵循相同的内容。接下来，在每个片段的第 5 行（从 开始的第三行`$$$$.\n803`），有一个数字表示下一行中的行数，例如第一个片段中的 7 和 803 配体的下一个片段中的 10。现在，下一个行块包含一列 (61-62)，其中包含引用片段中原子的特定数字。例如在 803 的第一个片段中，这些数字是 15、16、17、19、20、21、22。这些数字需要在文件 3 中匹配。![在此处输入图像描述](../Images/78d27518eea8d3d488f9b01de6ecd18f.png)

文件 2 (SD_2.txt) 看起来像：

```
$$$$    
803    
  SciTegic05101215222D    

  7  7  0  0  0  0            999 V2000    
    3.0215   -0.5775    0.0000 C   0  0  0  0  0  0  0  0  0 15  0  0     
    2.3070   -0.9900    0.0000 C   0  0  0  0  0  0  0  0  0 16  0  0     
    1.5926   -0.5775    0.0000 C   0  0  0  0  0  0  0  0  0 17  0  0      
    1.5926    0.2475    0.0000 C   0  0  0  0  0  0  0  0  0 19  0  0      
    2.3070    0.6600    0.0000 C   0  0  0  0  0  0  0  0  0 20  0  0      
    2.3070    1.4850    0.0000 O   0  0  0  0  0  0  0  0  0 21  0  0      
    3.0215    0.2475    0.0000 O   0  0  0  0  0  0  0  0  0 22  0  0      
  1  2  1  0      
  1  7  1  0       
  2  3  1  0     
  3  4  1  0      
  4  5  1  0      
  5  6  2  0     
  5  7  1  0      
M  END      
> <Name>      
803      

> <Num_Rings>      
1      

> <Num_CSP3>       
4     

> <Fsp3>       
0.8         

> <Fstereo>       
0      

$$$$      
803       
  SciTegic05101215222D       

 10 11  0  0  0  0            999 V2000       
   -1.7992    -1.7457    0.0000 C   0  0  0  0  0  0  0  0  0  1  0  0        
   -2.5137    -1.3332    0.0000 C   0  0  0  0  0  0  0  0  0  2  0  0        
   -2.5137    -0.5082    0.0000 C   0  0  0  0  0  0  0  0  0  3  0  0        
   -1.7992    -0.0957    0.0000 C   0  0  0  0  0  0  0  0  0  5  0  0        
   -1.0847   -0.5082    0.0000 C   0  0  0  0  0  0  0  0  0  6  0  0       
   -0.3702    -0.0957    0.0000 C   0  0  0  0  0  0  0  0  0  7  0  0        
    0.3442     -0.5082    0.0000 C   0  0  0  0  0  0  0  0  0  8  0  0       
    0.3442     -1.3332    0.0000 C   0  0  0  0  0  0  0  0  0  9  0  0        
   -0.3702     -1.7457    0.0000 C   0  0  0  0  0  0  0  0  0 11  0  0      
   -1.0847    -1.3332    0.0000 C   0  0  0  0  0  0  0  0  0 12  0  0       
  1  2  1  0        
  1 10  1  0      
  2  3  1  0      
  3  4  1  0      
  4  5  2  0      
  5  6  1  0      
  5 10  1  0     
  6  7  2  0      
  7  8  1  0      
  8  9  1  0     
 10  9  1  0      
M  END        
> <Name>       
803       

> <Num_Rings>     
2     

> <Num_CSP3>     
6     

> <Fsp3>     
0.6      

> <Fstereo>      
0.1 
```

文件 3 是 CIF（晶体信息文件）。该文件可从以下链接获得：[File_3](ftp://ftp.wwpdb.org/pub/pdb/data/monomers/components.cif) 该文件是多个配体分子的单个 cif 文件的集合。文件中的每个部分都以`data_ligandcode`. 对于我们的示例，它将是`data_803`. 在集合中每个小文件开始的 46 行之后，有一个块提供有关分子的结构信息。此块中的行数不固定。但是，此块以哈希符号 ( `#`) 结束。在此块中，有两列很重要，它们是 53-56 和 62-63。62-63 列包含可以从文件 2 获得的数字匹配的数字。并且，53-56 包含原子名称等`C1 (Carbon 1)`。此列可用于与文件 4 匹配。

文件 4 是一个 Grow.out 文件，其中包含有关每个配体与其靶蛋白相互作用的信息。文件名是文件 1 中针对每个配体给出的 PDBcode。例如，对于配体 803，PDBcode 是 1cqp。因此，grow.out 文件的名称为 1cqp。[1cqp](http://www.ebi.ac.uk/thornton-srv/databases/pdbsum/1cqp/grow.out) 在这个文件中，那些行很重要，那些包含配体代码（例如 803）和从文件 3 的 53-56 列获得的原子名称。

任务：我需要一个从文件 1 中读取配体代码的脚本，然后转到文件 2 搜索`$$$$ . \nLigandcode`然后从第 61-62 列中获取每个片段的编号。然后在下一步中，我的脚本应该将这些数字传递给文件 3，并匹配文件 3 的第 62-63 列中包含这些数字的行，然后提取第 53-56 列（原子名称）中的信息。最后一步是打开名为 PDBcode 的文件 4，然后打印包含配体代码和从文件 3 获得的原子名称的行。打印应在输出文件中完成。

我是一名生物医学研究的学生。我没有计算机科学背景。但是，我必须使用 Perl 编程来完成某些任务。对于上面提到的任务，我写了一个脚本，但它不能正常工作，我找不到它背后的原因。我写的脚本是：

```
#!/usr/bin/perl
use strict;
use warnings;
use Text::Table;
use Carp qw(croak);

{

    my $a;
    my $b;
    my $input_file = "input_22.txt";
    my @lines = slurp($input_file);
    for my $line (@lines){
        my ($ligandcode, $pdbcode) = split(/\t/, $line);
        my $i=0;
        my $k=0;

        my @array;
        my @array1;

        open (FILE, '<', "SD_2.txt");

        while (<FILE>) {
            my $i=0;
            my $k=0;

            my @array;
            my @array1;

            if ( $_=~/\x24\x24\x24\x24/ . /\n$ligandcode/) {

                my $nextline1 = <FILE>;
                my $nextline2 = <FILE>;
                my $nextline3 = <FILE>;
                my $nextline4= <FILE>;

                my $totalatoms= substr( $nextline4, 1,2);
                print $totalatoms,"\n";
                while ($i<$totalatoms)
                  {

                      my $nextlines= <FILE>;

                      my $sub= substr($nextlines, 61, 2);
                      print $sub;
                      $array[$i] = $sub;
                      open (FH, '<', "components.txt");

                      while (my $ship=<FH>) {
                          my $var="data_$ligandcode";
                          if ($ship=~/$var/)

                            {

                                while ($k<=44)
                                  {
                                      $k++;
                                      my $nextline = <FH>;

                                  }

                                my $j=0;
                                my $nextline3;
                                do
                                  {

                                      $nextline3=<FH>;
                                      print $nextline3;

                                      my $part= substr($nextline3, 62, 2);
                                      my $part2= substr($nextline3, 53, 4);
                                      $array1[$j] = $part;
                                      if ($array1[$j] eq $array[$i])
                                        {
                                            print $part2, "\n";
                                            open (GH, '<', "$pdbcode"); 
                                            open (OH, ">>out_grow.txt");
                                            while (my $grow = <GH>)
                                              {
                                                  if ( $grow=~/$ligandcode/){
                                                      print OH $grow if $grow=~/$part2/; 
                                                  }}
                                            close (GH);
                                            close (OH);
                                        }

                                      $j++;
                                  } while $nextline3 !~/\x23/;
                            }
                      }
                      $i++;
                      close (FH);
                  }

            }}

        close (FILE);

    }
}

##Slurps a file into a list
sub slurp {
    my ($file) = @_;
    my (@data, @data_chomped);
    open IN, "<", $file or croak "can't open $file\n";
    @data = <IN>;
    for my $line (@data){
        chomp($line);
        push (@data_chomped, $line);
    }
    close IN;
    return (@data_chomped);
} 
```

如果我在文件 1 中列出 400 个分子的列表，我想让它成为一个运行速度快且总共适用于 1000 个片段的脚本。请帮助我使这个脚本工作。我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T22:07:59.717

您需要将代码分解为可管理的步骤。

1.  从文件创建数据结构

    ```
    use Slurp;

    my @input = map{
      [ split /\s+/, $_, 2 ]
    } slurp $input_filename;

    # etc 
    ```

2.  `input_22.txt`使用这些数据结构处理 的每个元素。

我真的认为你应该研究[PerlMol](http://www.perlmol.org)。毕竟，使用 Perl 的一半原因是[CPAN](http://cpan.org)。

* * *

你做得好的事情

*   使用 3-arg[`open`](http://perldoc.perl.org/functions/open.html)
*   `use strict;`
*   `use warnings;`

你不应该做的事情

*   （重新）定义`$a`并且`$b`
    它们已经为您定义了。
*   重新实现[`slurp`](http://p3rl.org/Slurp)（差）
*   多次读取同一个文件。您为每行
    打开一次.`SD_2.txt``input_22.txt`
*   在您使用它们的范围之外定义的符号。
    `$j`, `$k`,`@array`和`@array1`定义了两次，但只使用了其中一个定义。
*   使用[`open`](http://perldoc.perl.org/functions/open.html)并且[`close`](http://perldoc.perl.org/functions/close.html)没有某种错误检查。
    要么`open ... or die;`或`use autodie;`
*   您使用了裸字文件句柄。`IN`, `FILE`etc
    而是使用`open my $FH, ...`

不过，对于一次性计划而言，其中大多数都不是什么大不了的事。

# c++ - 如何使用仿函数创建 boost::packaged_task？

> ID：10906510
> 
> 赞同：2
> 
> 时间：2012-06-05T23:45:55.667
> 
> 标签：c++, boost, functor

我正在尝试使用这样的仿函数创建打包任务：

```
Worker w(someString, anotherString, i*length,length);
boost::packaged_task<Match> task(&w); 
```

Worker 类中的运算符如下所示：

```
Class Worker {
   Match operator()()
   {
      return matchText(..., ..., ..., ...);
   }
} 
```

编译器给我错误（从德语翻译错误消息）

> C2064：语句导致没有传递 0 个参数的函数

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T02:10:13.163

boost::packaged_task 的构造函数[需要一个仿函数对象](http://www.boost.org/doc/libs/release/doc/html/thread/synchronization.html#thread.synchronization.futures.reference.packaged_task)（左值或右值），而不是指向它的指针。

```
boost::packaged_task<Match> task(w); 
```

或者

```
boost::packaged_task<Match> task(std::move(w)); 
```

# php - 如何在没有数据库的情况下显示当前在线用户？或者至少非常有效。最好在 PHP 中

> ID：10906511
> 
> 赞同：2
> 
> 时间：2012-06-05T23:46:05.537
> 
> 标签：php, jquery, performance

一段时间以来，这个问题一直是我的脑筋急转弯。抱歉，如果我写了很多，我只是想清楚我已经尝试过的内容等。

我将尽可能简单地解释我的问题的想法，因为复杂性是无关紧要的。我们在任何时候都可能在网站上拥有多达 80-90 个用户。他们很可能都在访问同一个页面，我将其称为 result.php。然而，他们将通过 ID 的 get 变量（result.php?ID=456）访问不同的结果。在任何时候，单个记录上的用户可能少于 3 或 4 个，并且记录超过 10000 条。

我需要知道，在小于 20-25 秒的误差范围内（这非常重要），谁在该页面上的特定 ID 上，并相应地更新页面。一旦他们不再出现在页面上，就尽快删除他们的名字。

目前，我正在使用一个调用 php 文件的 jQuery 脚本，从正在访问此特定 ID 的“当前访问”用户名的数据库中读取，并且仅当他们访问该 ID 的日期在最后 25 秒内。该文件还将删除所有超过 5 分钟的条目，以保持表格整洁。

这对 20 或 30 个用户来说没问题，但现在负载增加了一倍多，我注意到这是一种特别慢的方法。

我还可以使用哪些其他方法？有没有人有过类似情况的经验？

我们目前使用的所有东西都是用 PHP 和一点 jQuery 编码的。如果这很重要，我们正在由托管公司异地管理的服务器上运行。

我遇到了一个叫做 Comet 或 Comet Server 的东西，听起来它可能会有所帮助，但对于我的目的来说，这听起来也非常复杂，而且远远超出了我目前的理解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T23:59:01.993

Look into [websockets](http://en.wikipedia.org/wiki/WebSocket) for a realtime socket connection. You could use websockets to push out updates in real time (instead of polling) to ensure changes in the 'currently online users' is sent within milliseconds.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T23:53:02.347

你想要的是一个内存缓存，它有一个服务层来维护站点上的活动状态。使用[memcached](http://memcached.org/)可能是一个很好的起点。您的伪代码将类似于：

*   在页面访问时，调用 CurrentUserService
*   CurrentUserService 将您正在访问的页面和您的身份作为参数。
*   每次调用它时，它都会从缓存中删除您之前访问的任何内容。
*   Then it adds what you're currently accessing.
*   Then it compiles a list of who else is accessing the same thing based on the current state in the cache.
*   It returns this list, which your page processes and displays.

If you record when someone accesses a page, you can set a timeout for when the service stops 'counting' them as accessing the page.

# xml - 如何使用 Perl 和 XML::Simple 输出属性

> ID：10906521
> 
> 赞同：1
> 
> 时间：2012-06-05T23:47:55.960
> 
> 标签：xml, perl, hash

```
sub parse_xml{
    my $xml_link = $_[0];
    my $xml_content = get($xml_link) or warn "Cant get XML page of " . $xml_link . "\n";
    if(!$xml_content){
        return;
    }
    my $xml =  XML::Simple->new(KeepRoot => 1);
    my $xml_data = $xml->XMLin($xml_content);
    my @items = $xml_data->{rss}{channel}->{item};
   # print Dumper($xml_data);
    foreach my $item (@items) {
        if($item){
             print Dumper($item);             //This is the dump output
             print $item->{author};
             #print $item . "\n";
        }
    }
} 
```

当我尝试输出项目的作者时，我只会得到`HASH(Memory Address)`或`not a hash reference at ... line ...`

我做错了吗？为什么会产生这个错误？

这是转储程序的输出。

```
$VAR1 = [
          {
            'link' => 'http://***.com/article/news/betty-white-credits-snickers-golden-opportunities/144290/#comments-67229',
            'author' => {},
            'title' => 'By: ',
            'pubDate' => 'Tue, 08 Jun 2010 12:47 EDT',
            'description' => 'Interesting. At least SHE remembered the product that propelled her to recent recognition. When many people I know have commented on how they loved that Betty White Super Bowl spot, they can&#039;t recall the product. Ah, advertising.'
          },
          {
            'link' => 'http://***.com/article/news/betty-white-credits-snickers-golden-opportunities/144290/#comments-67167',
            'author' => {},
            'title' => 'By: ',
            'pubDate' => 'Mon, 07 Jun 2010 13:26 EDT',
            'description' => 'Fun, fun, fun. A great attitude for all of us to take into our careers.'
          },
          {
            'link' => 'http://****.com/article/news/betty-white-credits-snickers-golden-opportunities/144290/#comments-67164',
            'author' => 'username',
            'title' => 'By: username',
            'pubDate' => 'Mon, 07 Jun 2010 12:23 EDT',
            'description' => 'Her appearance of the Comedy Central roast of William Shattner a couple of years ago was great... it seems like her willingness to be irreverent makes her more appealing to us all!  

www.adverspew.com'
          },
          {
            'link' => 'http://****.com/article/news/betty-white-credits-snickers-golden-opportunities/144290/#comments-67142',
            'author' => {},
            'title' => 'By: ',
            'pubDate' => 'Mon, 07 Jun 2010 09:50 EDT',
            'description' => 'Solid interview. I will definitely be tuning into &quot;Hot in Cleveland&quot; next week. We ought to enjoy Ms. White&#039;s talents for as long as we have her. She&#039;s great!'
          }
        ]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T00:18:34.193

你在正确的轨道上。我已经在此 StackOverflow 页面链接的新闻源上使用了您的代码，并对其进行了微调。

```
use LWP::Simple;
use XML::Simple;
use Data::Dumper;
sub parse_xml{
    my $xml_link = $_[0];
    my $xml_content = get($xml_link) or warn "Cant get XML page of " . $xml_link . "\n";
    if(!$xml_content){
        return;
    }
    my $xml =  XML::Simple->new(KeepRoot => 1);
    my $xml_data = $xml->XMLin($xml_content,ForceArray =>'entry');
    foreach my $item ($xml_data->{'feed'}[0]->{'entry'}) {
        foreach my $entry (@{$item}){
            if($entry){
                print $entry->{'author'}[0]->{'name'}[0]."\n";
                print $entry->{'author'}[0]->{'uri'}[0]."\n";
            }
        }

    }

}
parse_xml('http://stackoverflow.com/feeds/question/10906521'); 
```

在那个例子上工作正常。我怀疑您可能试图打印出不是普通值的东西——在 stackoverflow 页面的示例中，您可以看到“作者”实际上包含一些子节点，因此如果您尝试打印 $item ->{'author'} 在 foreach 循环中，您将获得您描述的 'HASH' 结果。

看看你的转储和鲍罗丁的明智评论，这应该对你有用：

```
 my $xml_data = $xml->XMLin($xml_content,ForceArray =>'entry');
    my $item = $xml_data->{'rss'}[0]->{'channel'}[0]->{'item'};
    foreach my $entry (@{$item}){
        if($entry){
            if(!ref $entry->{'author'}[0]){
                    print $entry->{'author'}[0]."\n";
            }
            if(!ref $entry->{'description'}[0]){
                    print $entry->{'description'}[0]."\n";
            }
            if(!ref $entry->{'pubDate'}[0]){
                    print $entry->{'pubDate'}[0]."\n";
            } # etc.
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T02:01:27.417

此 RSS 提要可能有也可能没有`<author>`每个项目的信息。

如果没有作者，则该元素仍会出现在 XML 中，但它没有内容。它显示为`<author></author>`。

`XML::Simple`将其表示为一个空的匿名哈希。

因此，如果有项目的作者信息，`$item->{author}`将是一个简单的文本字符串。否则它将是一个哈希引用。

您可以为此编写代码

```
foreach my $item (@items) {
  my $author = $item->{author};
  $author = '' if ref $author;
  print "$item\n";
} 
```

# java - 如何将格式化字符串转换为浮点数？

> ID：10906522
> 
> 赞同：0
> 
> 时间：2012-06-05T23:48:01.323
> 
> 标签：java, number-formatting, string-conversion

我有一个字符串列表，如果模式匹配，我想将它们转换为浮点数。

以下是一些值和预期结果：

```
1000         -> 1000.0
1.000        -> 1000.0
1.000,000    -> 1000.0
-1.000,000   -> -1000.0
9,132        -> 9.132
1,000.00     -> invalid
30.10.2010   -> invalid
1,000.000,00 -> invalid 
```

我尝试使用此代码检查数字是否有效，但模式从未匹配：

```
Pattern pattern = Pattern.compile("#.###,###");
for(String s : list){
    Matcher m = pattern.matcher(s); 
    if(m.matches()){
         //convert
    }
} 
```

除此之外，我还尝试使用此代码：

```
 DecimalFormat df = (DecimalFormat) NumberFormat.getCurrencyInstance();
 for(String s : list){
        try {
            Number num = df.parse(s);
            //..
        } catch (ParseException e) {

        } 
    } 
```

这段代码的问题是，没有执行基于模式的验证。例如，日期 like`2012/05/30`被转换为`2012`.

那么如何定义一个有效的模式或`DecimalFormat`根据我的需要进行配置呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T23:53:36.420

该类`Pattern`使用正则表达式。你可能想要这个：

```
Pattern pattern = Pattern.compile("-?\d\.\d{1,3}(,\d{1,3})?"); 
```

您可能希望根据您想要或不想匹配的格式来调整此正则表达式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T01:30:28.010

我想这就是你想要的。评论应该解释它。

```
@Test
public void testAllValues() {
    testValue("1000", "1000");
    testValue("1.000,000", "1000");
    testValue("-1.000,000", "-1000");
    testValue("9,132", "9.132");
    testValue("1,000.00", null);
    testValue("30.10.2010", null);
    testValue("1,000.000,00", null);
}

private void testValue(String germanString, String usString) {
    BigDecimal germanDecimal = (BigDecimal) parse(germanString);
    if (usString != null) {
        BigDecimal usDecimal = new BigDecimal(usString);
        assertEquals("German " + germanString + " did not equal US " + usString, 0, germanDecimal.compareTo(usDecimal));
    } else {
        assertEquals("German " + germanString + " should not have been pareseable", null, germanDecimal);
    }
}

public BigDecimal parse(String s) {
    // Patch because parse doesn't enforce the number of digits between the
    // grouping character (dot).
    if (!Pattern.matches("[^.]*(\\.\\d{3})*[^.]*", s)) {
        return null;
    }

    DecimalFormat df = (DecimalFormat) DecimalFormat.getInstance(Locale.GERMANY);
    df.setParseBigDecimal(true);

    // Have to use the ParsePosition API or else it will silently stop
    // parsing even though some of the characters weren't part of the parsed
    // number.
    ParsePosition position = new ParsePosition(0);
    BigDecimal parsed = (BigDecimal) df.parse(s, position);

    // getErrorIndex() doesn't seem to accurately reflect errors, but
    // getIndex() does reflect how far we successfully parsed.
    if (position.getIndex() == s.length()) {
        return parsed;
    } else {
        return null;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-06T00:04:41.480

尝试

```
System.out.println("1,000.000,00".matches("^[+-]?\\d+(\\.\\d{3})*(,\\d+)?")); 
```

我不确定您的号码是否可以以 + 开头，所以添加它以防万一。也不知道 0100000.000.000,1234 是否应该有效。如果不告诉原因和正则表达式将被纠正。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T00:49:48.803

如果模式是逗号，请尝试：

```
String[] splitted = string.split(",") 
```

如果`size of splitted > 2`--> 无效。

如果`splitted.size == 2 && splitted[1].split(".") > 0`--> 也无效。

如果格式很好 --> 删除所有点，用点替换逗号，将逗号后的字符串解析为 int 并连接各个部分。

一个非常简单的方法，但它的工作...

# mfc - MFC 子对话框意外更改大小

> ID：10906523
> 
> 赞同：2
> 
> 时间：2012-06-05T23:48:06.207
> 
> 标签：mfc, internationalization, dialog, resize

我的应用程序使用堆叠对话框在多个位置的选项之间进行选择。例如，下面的对话框使用了两个堆叠的对话框：

1.  要在“拍摄方法”之间进行选择，用户从右下角的下拉列表中进行选择。这将更改其上方的子对话框。
2.  “高级选项”框（位于子对话框中）在简化界面和更完整界面之间进行选择。

![正确的对话](../Images/9e03282f3f1c94c0bb6d771605c3258e.png)

在每种情况下，堆叠对话框都是使用图片对象作为父对话框中的占位符来实现的。选择页面时，调用 SetWindowPos 来移动/调整子对话框 (pNewPage) 的大小以适合占位符。

```
// Show the newly selected page
pNewPage->ShowWindow (SW_SHOW) ;
pNewPage->SetFocus () ;

// Position the newly selected page
CRect rcDlgArea ;
GetDlgItem (IDC_DLG_AREA)->GetWindowRect (&rcDlgArea) ;
ScreenToClient (&rcDlgArea) ;

pNewPage->SetWindowPos (this, 
    rcDlgArea.left, rcDlgArea.top, rcDlgArea.Width (), rcDlgArea.Height (), 
    SWP_NOACTIVATE) ; 
```

到目前为止，这一直运作良好，但我在德国的一位用户遇到了我无法解释的问题。当他打开工具时，堆叠的页面看起来像这样：

![不正确的对话](../Images/3bc939bebde8a0cd8089d9a4796d4fb7.png)

请注意，子对话框被拉伸，因此子对话框中的文本看起来比父对话框中的文本大。

除了视觉布局问题外，子对话框似乎还“覆盖”了右下角的选择下拉菜单（位于父对话框中）。尽管下拉列表仍然可见，但单击下拉列表时不会收到 CBN_SELCHANGE 消息。

我不知道为什么要重新调整子对话框。正如您在上面看到的，我试图非常明确地调整对话框的大小，但这似乎不起作用。

谁能想到为什么子对话框可能在某些系统上重新缩放但在其他系统上没有的原因？任何帮助将不胜感激。

谢谢，

迈克尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T12:25:08.987

似乎该用户选择的字体比第一个屏幕截图中使用的字体大。请注意，对话框大小是在 DLU 中指定的，它随用户为字体选择的大小而缩放。您可以以像素为单位显式缩放对话框（不好的解决方案，这会使您的应用在某些配置上看起来更糟），或者在 DLU 的任何地方进行计算。您的第二个屏幕截图似乎也显示子对话框使用的字体与向导的字体不同。我不确定为什么会这样，我想这是您在创建它时传递给向导的窗口样式中的某些东西。

# c - OpenSSL i2o_ECPublicKey 不工作

> ID：10906524
> 
> 赞同：8
> 
> 时间：2012-06-05T23:48:09.893
> 
> 标签：c, openssl, segmentation-fault, heap-memory, bitcoin

我有这个代码：

```
#include <stdio.h>
#include <openssl/sha.h>
#include <openssl/ssl.h>

int main(){
    printf("OpenSSL version: %s\n",OPENSSL_VERSION_TEXT);
    EC_KEY * key = EC_KEY_new_by_curve_name(NID_secp256k1);
    if(!EC_KEY_generate_key(key)){
        printf("GENERATE KEY FAIL\n"); 
        return 1;
    }
    u_int8_t pubSize = i2o_ECPublicKey(key, NULL);
    if(!pubSize){
        printf("PUB KEY TO DATA ZERO\n"); 
        return 1;
    }
    u_int8_t * pubKey = malloc(pubSize);
    if(i2o_ECPublicKey(key, &pubKey) != pubSize){
        printf("PUB KEY TO DATA FAIL\n"); 
        return 1;
    }
    u_int8_t * hash = malloc(SHA256_DIGEST_LENGTH);
    SHA256(pubKey, pubSize, hash);
    for (int x = 0; x < 32; x++) {
        printf("%.2x",hash[x]);
    }
    EC_KEY_free(key);
    free(pubKey);
    free(hash);
    return 0;
} 
```

如您所见，我正在尝试散列公钥并打印它。SHA 哈希失败 sha256_block_data_order。这里有更多信息...

版本为：OpenSSL 1.0.1c 2012 年 5 月 10 日 pubSize 设置为 65

在第二个 i2o_ECPublicKey 之后，pubKey 数据以某种方式失效：

```
(gdb) p/x *pubKey @ 65
Cannot access memory at address 0x4d0ff1 
```

然而，在第二个 i2o_ECPublicKey 之前，分配的 pubKey 数据给出：

```
(gdb) p/x *pubKey @ 65
$1 = {0x0 <repeats 65 times>} 
```

所以 malloc 分配很好。第二个 i2o_ECPublicKey 调用没有按预期工作。如何将 EC 公钥读入字节？

谢谢你。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-16T18:06:05.527

i2o_ECPublicKey 将指针移动写入缓冲区的字节数，使其位于写入内容的末尾。您将需要传入指针的副本。

以下更改为我修复了它：

```
 u_int8_t * pubKey = malloc(pubSize);
    +       u_int8_t * pubKey2 = pubKey;
    -       if(i2o_ECPublicKey(key, &pubKey) != pubSize){
    +       if(i2o_ECPublicKey(key, &pubKey2) != pubSize){
                printf("PUB KEY TO DATA FAIL\n"); 
```

# c# - “加载系统 Windows PowerShell 管理单元时出错”

> ID：10906529
> 
> 赞同：6
> 
> 时间：2012-06-05T23:49:12.093
> 
> 标签：c#, powershell, windows-7

试图在我的 C# 代码中执行 powershell 脚本。在 Windows 7 上的 VS 2010 中使用 .NET Framework v. 4.0.30319 SP1Rel。

我有以下 dll 文件作为参考：

C:\Program Files (x86)\Reference Assemblies\Microsoft\WindowsPowerShell\v1.0\system.management.automation.dll

我包括：

```
using System.Collections.ObjectModel;
using System.Management.Automation;
using System.Management.Automation.Runspaces; 
```

然后当我运行以下命令时：

```
RunspaceConfiguration runspaceConfiguration = RunspaceConfiguration.Create(); // here
Runspace runspace = RunspaceFactory.CreateRunspace(runspaceConfiguration); 
```

它在第一行崩溃，但有以下异常：

```
{"An error occurred when loading the system Windows PowerShell snap-ins. Please contact Microsoft Support Services."} 
```

内部异常：

```
{"Unable to access Windows PowerShell PowerShellEngine registry information."} 
```

我可以在 cmd 中运行“Powershell.exe”（版本 2 或 1），它工作正常，我的项目可以正常编译。我读了这个问题（http://social.msdn.microsoft.com/Forums/eu/biztalkesb/thread/a807bee7-531a-4990-b8da-47a7e6e3e099），他们谈到了一些注册。钥匙，但他忘了具体说明他做了什么来修复它。非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T01:31:50.833

我打开一个终端并运行 powershell v2，然后运行以下命令：

```
"echo ([PSObject].Assembly.Location)" 
```

这将为您提供正在使用的 dll 的正确路径。

# jquery-ui - 使用 JQuery UI 使 Facebook Like 框可拖动

> ID：10906530
> 
> 赞同：0
> 
> 时间：2012-06-05T23:49:14.387
> 
> 标签：jquery-ui

嗨，我正在尝试通过将 Facebook Like Box 放置在 div 中来使其可拖动。Like Box 显示良好，但不拖动。我在它之前有一个 twitter 小部件，它工作得很好。

```
<div class="twitter"><script>new TWTR.Widget({version: 2, type: 'profile', rpp: 10, interval: 30000, width: 300, height: 300, theme: {shell: {background: '#7a7a7a', color: '#000000'}, tweets: {background: '#ffffff', color: '#000000', links: '#3586b8'}},features: {scrollbar: true, loop: false, live: true, behavior: 'all'}}).render().setUser('twitter').start();</script></div>

<div class="fb"><div class="fb-like-box" data-href="http://www.facebook.com/platform" data-width="292" data-show-faces="true" data-stream="true" data-header="false"></div></div>

$(function(){ $('.twitter').draggable({grid: [ 80, 80 ]}); $('.fb').draggable(); }); 
```

谢谢参观。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T02:27:10.200

这里的问题是，`iframe`由 Facebook 喜欢的框创建的正在拦截`mousedown`使可拖动插件工作所需的事件。

您在类似框周围创建的 div 仍然是可拖动的，只是不能在其`iframe`自身上方拖动。你可以在这里看到 - [http://jsfiddle.net/3K9uX/1/](http://jsfiddle.net/3K9uX/1/)。

我不相信有可能让这个工作如你所愿。[这个问题](https://stackoverflow.com/questions/3420327/jquery-draggable-handler-inside-iframe)中讨论了一个潜在的解决方案。

我要做的是在类似框上方创建一个标题，允许用户拖动整个框。

**现场示例**- [http://jsfiddle.net/3K9uX/2/](http://jsfiddle.net/3K9uX/2/)

# c# - 如何以编程方式将 Run 分配给文本属性？

> ID：10906539
> 
> 赞同：13
> 
> 时间：2012-06-05T23:50:50.593
> 
> 标签：c#, wpf, xaml

我知道在 XAML 中我们可以做...

```
<TextBlock FontSize="18">
   This is my text <LineBreak/>
   <Run FontSize="24" FontWeight="Bold">My big bold text</Run>
</TextBlock> 
```

问题是，如何以编程方式将 Run 分配给文本（字符串）属性？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-06T00:35:57.820

如果您看一下，`TextBlock`您会看到 ContentProperty 设置为`Inlines`

```
[Localizability(LocalizationCategory.Text), ContentProperty("Inlines")]
public class TextBlock : FrameworkElement, ... 
```

这意味着您将为在 的开始和结束标记之间添加的每个元素添加`Inline`元素到属性中。`Inlines``TextBlock`

所以相当于你的 Xaml 的 c# 是

```
TextBlock textBlock = new TextBlock();
textBlock.FontSize = 18;
textBlock.Inlines.Add("This is my text");
textBlock.Inlines.Add(new LineBreak());
Run run = new Run("My big bold text");
run.FontSize = 24;
run.FontWeight = FontWeights.Bold;
textBlock.Inlines.Add(run); 
```

# node.js - 使用 Node.js 作为移动应用 API 的访问点

> ID：10906543
> 
> 赞同：0
> 
> 时间：2012-06-05T23:51:44.463
> 
> 标签：node.js, mobile

我不确定我是否已经非常了解 node.js，但我真的很想实现它，因为我所理解的非常有趣。

我有一个使用第三方 API 的移动应用程序。用户通常会打开它以查看是否有任何新内容。我突然想到，只要我尊重第三方 API 的轮询限制（和其他限制），我就可以模拟一个基于推送的系统，并允许在有新内容时通知用户。

基本上以某种时间间隔从 Node.js 服务器实现所有 API 轮询，并使移动应用程序指向我的 Node.js 服务器而不是端点 API。

### 我认为这会很好，原因有很多：

*   减轻手机的数据使用负担（因为我可以在手机和服务器上缓存内容）。对于拥有按字节付费数据计划的用户来说，这是一个巨大的胜利
*   允许存储/访问所有数据的中心位置
*   让我在服务器端做一些优化（如果两个用户碰巧订阅了同一个提要，我可以在一个请求中得到它。

### 我认为这可能很糟糕，原因有很多：

*   如果*我的*服务器出现故障，那么我所有的应用程序都会死掉。通过充当我的 Node.js 实现之间的中间人，很可能会引入更多的故障点。
*   当第三方发布对 API 的添加时，它需要我在两个地方实现更改，而不是一个。

我的问题是：总的来说，这是一种好的做法吗？如果不是，为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T00:20:51.610

您的代理想法很好，因为它：

1.  将投票转换为推送
2.  将客户端与 API 更改隔离开来
3.  允许一些优化

我觉得只有#1真的很重要。

# ruby-on-rails - 使用 Rails 执行系统命令

> ID：10906547
> 
> 赞同：1
> 
> 时间：2012-06-05T23:52:12.370
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在执行一些基于用户操作的系统命令，例如`mkdir`、`cd`、`cp -r skel/ dest/`和创建 apache vhost 等。

这段代码最好的地方在哪里？我的直觉是将它们作为私有方法放入模型中，这是正确的吗？

谢谢

杰夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T00:09:57.533

Rails 建议使用*瘦控制器和胖模型*，但我认为执行系统命令与模型无关。

由于它们取决于*用户的操作*，我建议将它们放入库（*/lib*）并从控制器调用该库。

另外，请记住[FileUtil](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/fileutils/rdoc/FileUtils.html)可能已经完成了您正在寻找的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T00:09:05.077

我建议不要直接使用 Ruby 自带的 FileUtils 模块。

[http://www.ruby-doc.org/stdlib-1.9.3/libdoc/fileutils/rdoc/FileUtils.html](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/fileutils/rdoc/FileUtils.html)

```
require 'fileutils'
FileUtils.mkdir 'test'
FileUtils.cd 'test'
FileUtils.cp_r 'skel', 'dest' 
```

我还将它们作为私有方法放入模型中。

# django - 带有后退按钮的 Django 重定向行为

> ID：10906548
> 
> 赞同：1
> 
> 时间：2012-06-05T23:52:18.753
> 
> 标签：django, redirect, back-button

我现在遇到了一个问题，我的网站上有一个“随机”链接来查看随机用户。我设置它的方式是获取 user_id，然后使用重定向来提供正确的页面。我遇到的问题是，如果我多次单击随机按钮，单击返回将使我回到“随机”单击之前的页面。

更具体地说，这就是正在发生的事情：主页，单击随机（转到 /user1/），单击随机（转到 /user4/），回击（最终在主页上）。在这种情况下，我想结束 /user1/

这是随机视图方法：

```
def Random(request):
    user = helpers.GetRandomUser()
    return redirect('user_display', user_slug=user.username) 
```

该模板只有一个指向 /random/ 的链接，该链接被路由到上述视图。

编辑：显然它在 Firefox 中按预期工作，但在 Chrome 中。我希望它到处都有类似 Firefox 的行为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T03:01:56.900

使用以下代码强制浏览器不缓存页面。因此，单击后退按钮向服务器发送请求，现在您可以捕获它并将他重定向到所需的页面。

```
from django.views.decorators.cache import cache_control

@cache_control(no_cache=True, must_revalidate=True)
def func()
  #some code
  return 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T02:01:34.827

因此，如果我对您的理解正确，您可以在指向同一网址的链接上单击两次（如`/random_user/`），然后您会以随机重定向进行响应。这似乎很不合常规，而且 Chrome 可能会将其视为单个历史条目，这听起来并没有那么错误。

要跨浏览器归档您想要的行为，只需在呈现随机用户链接之前生成随机 url。

当您想在多个视图中使用它时，请[编写一个自定义模板标签](https://docs.djangoproject.com/en/1.4/howto/custom-template-tags/#simple-tags)：

```
@register.simple_tag
def random_user_url():
    user_url = # generate your random user url
    return user_url 
```

在您的模板中：

```
{% load your_tag_lib %}
<a href="{% random_user_url %}">Random user</a> 
```

这样，每次点击都会将浏览器引导至不同的 url，并将被存储为单独的历史条目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T23:59:18.733

需要明确的是，当您说“后退按钮”时，您的意思是：

1.  浏览器返回按钮
2.  您自己创建的后退按钮

如果 2，您是通过客户端执行此操作吗？比如通过javascript？

# git - 如何恢复对 git 子模块的更改？

> ID：10906554
> 
> 赞同：348
> 
> 时间：2012-06-05T23:52:44.003
> 
> 标签：git, git-submodules

我有一个 git 子模块（RestKit），已添加到我的仓库中。

我不小心更改了其中的一些文件，我想回到源版本。为了做到这一点，我试图跑

```
Mac:app-ios user$ git submodule update RestKit 
```

但正如您在此处看到的，这不起作用，因为它仍然是“修改后的内容”：

```
Mac:app-ios user$ git status
...
#   modified:   RestKit (modified content) 
```

甚至

```
Mac:app-ios user$ git submodule update -f RestKit 
```

不会还原本地修改的文件。
如何重置该子模块的内容？

* * *

## 回答 #1

> 赞同：334
> 
> 时间：2013-07-26T01:58:28.977

如果要对所有子模块执行此操作，而无需更改目录，则可以执行

```
git submodule foreach git reset --hard 
```

您还可以使用递归标志应用于所有子模块：

```
git submodule foreach --recursive git reset --hard 
```

* * *

## 回答 #2

> 赞同：298
> 
> 时间：2014-12-11T05:11:06.690

比所有以前的答案更安全的方法：

```
git submodule deinit -f .
git submodule update --init 
```

第一个命令完全“取消绑定”所有子模块，第二个命令重新检查它们。
它比其他方法花费更长的时间，但无论您的子模块的状态如何，它都可以工作。

* * *

## 回答 #3

> 赞同：256
> 
> 时间：2012-06-05T23:57:20.520

移动到子模块的目录，然后执行 a`git reset --hard`将所有修改的文件重置为上次提交的状态。请注意，这将丢弃所有未提交的更改。

* * *

## 回答 #4

> 赞同：75
> 
> 时间：2013-12-27T02:19:58.717

对我来说，拥有

```
git reset --hard 
```

只需将子模块重置为它签出的状态，而不需要主的 repo 引用的提交/状态。我仍然会像 OP 所说的那样拥有“修改过的内容”。所以，为了让子模块回到正确的提交，我运行：

```
git submodule update --init 
```

然后当我这样做时`git status`，它在子模块上是干净的。

* * *

## 回答 #5

> 赞同：54
> 
> 时间：2014-05-15T01:56:34.807

依次执行 4 个步骤：

```
git submodule foreach git reset --hard HEAD
git submodule update
git submodule foreach "git checkout master; git pull"
git submodule foreach git clean -f 
```

* * *

## 回答 #6

> 赞同：35
> 
> 时间：2017-07-23T12:06:08.943

这对我有用，包括递归进入子模块（也许这就是你的 -f 不起作用的原因，因为你在子模块中更改了一个子模块）：

```
git submodule update -f --recursive 
```

* * *

## 回答 #7

> 赞同：19
> 
> 时间：2019-12-09T19:44:15.953

首先尝试一下，正如其他人所说：

```
git submodule update --init 
```

如果这不起作用，请切换到子模块目录并使用以下命令查看子模块是否有任何更改：

```
git status 
```

如果您的子模块有更改，请删除它们。确认运行“git status”时看不到任何更改。

接下来，返回主存储库并再次运行“git submodule update --init”。

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2020-05-12T12:08:41.687

如果要丢弃整个存储库中的所有更改以及子模块，可以使用：

```
git restore . --recurse-submodules 
```

这将撤消在存储库和子模块中所做的所有更改。

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2017-05-29T19:23:52.677

自 Git 2.14（2017 年第三季度）以来，您不必进入每个子模块来执行`git reset`（如`git submodule foreach git reset --hard`）

那是因为 git reset 本身现在知道如何递归地进入子模块。

请参阅[Stefan Beller (](https://github.com/stefanbeller) [)的提交](https://github.com/stefanbeller)[35b96d1](https://github.com/git/git/commit/35b96d1de8e795aeac8ec281e88e59f2778335e7) （ 2017 年 4 月 21 日）和[提交 f2d4899](https://github.com/git/git/commit/f2d48994dc11ba367e92c38c8025c3354418145a)、[提交 823bab0](https://github.com/git/git/commit/823bab09c68b4048e433ab48b9185302c2f4b63a)、[提交 cd279e2](https://github.com/git/git/commit/cd279e2e1b4f41f0272d90abb2ba5a06c544b3da)（2017 年 4 月 18 日） 。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 5f074ca](https://github.com/git/git/commit/5f074ca7e8ddccb6471e457d7a3f85c1fe00e21a))^(中，2017 年 5 月 29 日）)[`stefanbeller`](https://github.com/stefanbeller)
^([`gitster`](https://github.com/gitster))

> ## 内置/重置：添加 --recurse-submodules 开关

`git-reset`是另一个工作树操纵器，应该教它有关子模块的知识。

> 当用户使用 git-reset 并请求递归到子模块时，这会将子模块重置为超级项目中记录的对象名称，从而分离 HEAD。

**警告**：两者之间的区别：

*   `git reset --hard --recurse-submodule`和
*   `git submodule foreach git reset --hard`

是前者还将重置您的主要父回购工作树，因为后者只会重置子模块工作树。
所以谨慎使用。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2017-06-21T07:28:24.903

对于 git <= 2.13，这两个命令结合起来应该使用递归子模块重置您的 repos：

```
git submodule foreach --recursive git reset --hard
git submodule update --recursive --init 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2021-04-13T03:57:16.470

很简单：

```
cd /path/to/submodule/root
git submodule update -f --init  . 
```

大多数答案都建议重置所有子模块，我认为这不是最好的方法，因为它们可能会有合法的变化。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2015-08-23T17:48:41.223

这适用于我们运行 GIT v1.7.1 的库，其中我们有一个 DEV 包 repo 和 LIVE 包 repo。存储库本身只不过是为项目打包资产的外壳。所有子模块。

LIVE 永远不会有意更新，但是可能会发生缓存文件或事故，从而使存储库变脏。添加到 DEV 的新子模块也必须在 LIVE 中初始化。

**DEV 中的包存储库**

在这里，我们想要提取我们尚未意识到的所有上游更改，然后我们将更新我们的包存储库。

```
# Recursively reset to the last HEAD
git submodule foreach --recursive git reset --hard

# Recursively cleanup all files and directories
git submodule foreach --recursive git clean -fd

# Recursively pull the upstream master
git submodule foreach --recursive git pull origin master

# Add / Commit / Push all updates to the package repo
git add .
git commit -m "Updates submodules"
git push 
```

**LIVE 中的包存储库**

在这里，我们想要提取提交到 DEV 存储库的更改，而不是未知的上游更改。

```
# Pull changes
git pull

# Pull status (this is required for the submodule update to work)
git status

# Initialize / Update 
git submodule update --init --recursive 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2020-07-08T10:34:55.360

如果您的子模块发生变化，请使用

```
git submodule foreach --recursive git reset --hard 
```

如果您的更改是远程子模块更改，则使用

```
git submodule update --init 
```

如果这些更改已提交，则使用

```
git reset --hard
git submodule update --init 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2017-08-25T20:57:49.587

我重置所有子模块的方法（*不*分离并保留它们的`master`分支）：

```
git submodule foreach 'git checkout master && git reset --hard $sha1' 
```

# javascript - 用于介绍的 jQuery 加载器

> ID：10906555
> 
> 赞同：0
> 
> 时间：2012-06-05T23:52:51.800
> 
> 标签：javascript, jquery

我的网站有一个带有大量图片的小介绍，这是上面的小动画：

jQuery

```
$(function(){
    $('#intro-left').stop().delay(5000).animate({'width':'0'},4000, 'easeOutQuint');
    $('#intro-right').stop().delay(5000).animate({'width':'0','left':'100%'},4000, 'easeOutQuint');
    $('#intro-rights').stop().delay(5000).animate({'width':'0','left':'100%'},4000, 'easeOutQuint');
    $('#intro-logo').stop().delay(10000).fadeOut(1500);
}); 
```

HTML

```
<div id="intro-left"></div>
<div id="intro-right"></div>
<div id="intro-rights"></div>
<div id="intro-logo"><img class="top" src="images/intro_top.jpg"><img class="logo" src="images/intro-logo.jpg"><img class="bot" src="images/intro-bot.jpg"></div>
<div id="header">
    Rest of the Site... 
```

CSS

```
#intro-left {
    position: absolute;
    z-index: 10000;
    top: 0;
    left: 0;
    background: url(images/intro-left.png) right no-repeat;
    width: 58%;
    height: 100%;
}  

#intro-right {
    position: absolute;
    z-index: 9000;
    top: 0;
    left: 32%;
    background: url(images/intro-right.png) left no-repeat;
    width: 68%;
    height: 100%;
} 
```

正如你所看到的，它只是全屏图像和颜色，问题是网络冲浪者可能会错过那个介绍，或者，它以一种糟糕的方式引入，图像加载......它使介绍变得丑陋，然后，我想知道是否有一种方法可以在页面加载时使页面中的所有内容不可见，然后在加载该页面的所有内容时使其可见。可能是 display: none 在加载过程中，然后页面正在加载使其阻塞，类似这样的东西会起作用，

那可能吗？还是类似的？

提前非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T00:03:22.903

以下链接将带您到一个 jquery 加载插件，它允许您向您的网站添加一个预加载器，这应该是解决您问题的好方法。

[http://www.gayadesign.com/diy/queryloader2-preload-your-images-with-ease/](http://www.gayadesign.com/diy/queryloader2-preload-your-images-with-ease/)

您将使用该`onComplete()`功能让您的介绍在页面/预加载器完成后开始。

可能看起来像这样：

```
 $("body").queryLoader2({
    barColor: "#6e6d73",
    backgroundColor: "#fff1b0",
    percentage: true,
    barHeight: 30,
    completeAnimation: "grow",
    onComplete: function(){
        $('#intro-left').stop().delay(5000).animate({'width':'0'},4000, 'easeOutQuint');
        $('#intro-right').stop().delay(5000).animate({'width':'0','left':'100%'},4000, 'easeOutQuint');
        $('#intro-rights').stop().delay(5000).animate({'width':'0','left':'100%'},4000, 'easeOutQuint');
        $('#intro-logo').stop().delay(10000).fadeOut(1500);
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T23:56:29.903

尝试将整个页面内容包含在`<div id='loadHide' style='display:none'>...</div>`

然后您可以添加

```
$('#loadHide').show(); 
```

到代码块的开头，在文档完成加载后显示内容。

完成的 javascript 将是：

```
$(function(){
    $('#loadHide').show();
    $('#intro-left').stop().delay(5000).animate({'width':'0'},4000, 'easeOutQuint');
    $('#intro-right').stop().delay(5000).animate({'width':'0','left':'100%'},4000, 'easeOutQuint');
    $('#intro-rights').stop().delay(5000).animate({'width':'0','left':'100%'},4000, 'easeOutQuint');
    $('#intro-logo').stop().delay(10000).fadeOut(1500);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T00:06:37.220

display:none/display:block 可能会起作用，并且 jQuery 有一种方法，只有在页面完全加载后才运行代码。

```
$(document).ready(function() {
    $('#content').show();
    // I would also recommend that you start your animation here, too
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T00:10:16.500

解决方案很好，`$(document).ready`但文档可以在所有图像完成加载之前准备就绪。如果您主要关心的是等到所有图像都加载完毕，我会查看[这个问题](https://stackoverflow.com/questions/2034810/jquery-document-ready-fires-too-early-for-my-requirements)，它建议您使用`$(window).load`回调。此外，您可以`onload`向图像添加事件处理程序，以确保在加载图像之前不会开始动画。

```
var image = new Image();
image.onload = function() {
  //Animation code here
};
image.src = "http://i2.ytimg.com/vi/yW5Vv23HQWM/hqdefault.jpg"; 
```

这仅在您加载单个图像时才有效。如果您需要等待多个图像，您可以将动画代码放在其他位置，并且每次`onload`触发事件时，您会检查是否所有需要的图像都已加载。一旦它们全部加载完毕，调用你的动画代码。

# javascript - 在客户端编程 Web 套接字？

> ID：10906562
> 
> 赞同：0
> 
> 时间：2012-06-05T23:53:04.850
> 
> 标签：javascript, html, websocket

抱歉，这里是网络菜鸟，我有几个问题：

1.  “网络套接字”到底是做什么的？他们是将客户端连接到套接字还是使服务器连接到某个套接字？
2.  假设允许客户端连接到任何其他套接字是一种安全风险。存在什么样的风险？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T23:55:54.297

Web 套接字允许在客户端和服务器之间建立持久的双向连接。服务器可以将数据“推送”到客户端，反之亦然。这与单个 AJAX 请求相反，单个 AJAX 请求只能将数据从客户端推送到服务器一次并接收一个响应。这些连接可能不安全，具体取决于服务器上数据的使用方式。从客户端发送的数据通过您的脚本运行，因此您可以控制发生的情况。不用说，执行或写入从客户端收到的*任何内容都是愚蠢的。*只要您检查它是否符合您的预期，就应该没问题。

# ruby - 在 Jekyll 中过滤 site.related_posts

> ID：10906574
> 
> 赞同：6
> 
> 时间：2012-06-05T23:55:07.300
> 
> 标签：ruby, jekyll

我对 Jekyll 和 Ruby 非常陌生（但*非常*兴奋）。

在不使用插件的情况下，我试图找到一种方法来过滤`site.related_posts`.

例如，我正在阅读带有 title`Foo`和 categories的帖子`A, B`。

该网站共包含 3 个帖子：

1.  `Foo`（类别：A、B）
2.  `Bar`（类别：A、C、D）
3.  `Zoo`（类别：B、F）

默认情况下，在 Jekyll 中我们这样做：

> {% for post in site.related_posts limit:5 %}
> {% endfor %}

但是，上面的代码返回所有 (3) 个帖子。

一篇文章包含许多类别，因此类别应该是一个数组。

如何修改代码并仅返回类别与当前帖子类别相交的那些？

（在这个例子中，我希望代码只返回`Foo`和`Zoo`。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-06T03:29:20.000

我现在没有能力对此进行测试，但是鉴于[Liquid 的](https://github.com/shopify/liquid/wiki/liquid-for-designers)语法有限，这样的事情会起作用：

```
{% for post in site.related_posts limit:5 %}
  {% assign match = false %}
  {% for category in post.categories %}
    {% if page.categories contains category %}
      {% assign match = true %}
    {% endif %}
  {% endfor %}
  {% if match %}
    <li><a href="{{ post.url }}">{{ post.title }}</a></li>
  {% endif %}                       
{% endfor %} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-07T20:13:24.903

确保每个帖子在 YAML 前文中都有一个类别，然后将其添加到您要显示与 CATEGORY_NAME 相关的帖子的位置：

```
{% for post in site.categories.CATEGORY_NAME %}
    <li>
        <a href="{{ post.url }}">
            <img src="{{ post.thumbnail }}">
            <p>{{ post.excerpt }}</p>
        </a>
    </li>
{% endfor %} 
```

# javascript - 我将如何创建一个将三个数字作为参数并返回其中最大值的函数？

> ID：10906575
> 
> 赞同：-3
> 
> 时间：2012-06-05T23:55:07.450
> 
> 标签：javascript

我一直在看简单的 JS 练习，如果您向我展示如何解决这个问题，或者更好地提供一个我可以查看的解决方案，我将不胜感激。非常感谢帮助。

编辑：我也很欣赏正在使用的功能的任何简单的工作示例。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T23:56:58.517

```
function whatDidYouTry() {
    return Math.max.apply(null, arguments);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T00:03:20.743

```
function get_max(num1, num2, num3)
{
    var max = Math.max(num1, num2, num3);
    return max;
}

alert(get_max(20,3,5)); // 20 
```

[**演示。**](http://jsfiddle.net/NmxQW/) ​</p>

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-06T00:11:37.893

没有必要创建一个新函数，因为它已经存在：

```
Math.max(num1, num2, num3); 
```

创建一个新函数只是额外的开销，没有任何附加值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-06T00:17:06.183

试一试。

```
function threeNumberSort(a,b,c) {
    if (a<b) {
        if (a<c) {
            if (b<c) {
                console.log(a + ", then " + b + ", then " + c);
            } else {
                console.log (a + ", then " + c + ", then " + b);
            }
        } else {
            console.log (c + ", then " + a + ", then " + b);
        }
    } else {
        if (b<c) {
            if (a<c) {
               console.log (b + ", then " + a + ", then " + c); 
            } else {
                console.log (b + ", then " + c + ", then " + a);
            }
        } else {
            console.log (c + ", then " + b + ", then " + a);
        }
    }
}

threeNumberSort(1456,215,12488855); 
```

这将在您的控制台上打印：

```
215, then 1456, then 12488855 
```

我已经使用了[我在这个页面上找到](http://www.cs.mtu.edu/~shene/COURSES/cs201/NOTES/chap03/sort.html)的算法。那里可能存在更有效的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-12-11T03:08:16.563

这是我使用函数和 else if 语句提出的手动代码：

```
function maxOfThree(a, b, c) {
    if ((a >= b) && (a >= c)) { 
        return a;
    } else if ((b >= a) && (b >= c)) {
        return b;
    } else {
        return c;
    }
}

console.log(maxOfThree(343,35124,42)); 
```

# css - 带有 Alpha 通道的图像的“直线”版本

> ID：10906582
> 
> 赞同：2
> 
> 时间：2012-06-05T23:56:01.153
> 
> 标签：css, opengl-es, shader

所以我正在为即将到来的 CSS 着色器规范开发一个着色器。我正在构建一些专门针对专业视频产品的东西，我需要分离出 alpha 通道（作为亮度，我已经成功完成）和没有 alpha 通道的图像的“直接”版本。

示例：[https](https://dl.dropbox.com/u/4031469/shadertest.html) ://dl.dropbox.com/u/4031469/shadertest.html （仅适用于[精美的 adobe webkit 浏览器](https://github.com/adobe/webkit)）

我很接近，只是想弄清楚最后一个着色器。

这是我希望看到的一个例子。（这是来自 Targa 文件）

[https://dl.dropbox.com/u/4031469/Randalls%20Mess.png](https://dl.dropbox.com/u/4031469/Randalls%20Mess.png) - 填充物（我还没弄清楚）

[https://dl.dropbox.com/u/4031469/Randalls%20Mess%20Alpha.png](https://dl.dropbox.com/u/4031469/Randalls%20Mess%20Alpha.png) – 关键（也就是我想出的 alpha）

（决赛，如果你好奇的话：[https](https://dl.dropbox.com/u/4031469/final.png) ://dl.dropbox.com/u/4031469/final.png ）

我认为这将是一个矩阵变换，但我现在在想，我已经尝试了越来越多，它会比矩阵变换更复杂。我可悲地正确吗？如果是这样，我什至如何开始解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T01:04:45.947

在您的着色器中，我假设您有一些代码可以对类似于以下的纹理进行采样，是吗？

```
vec4 textureColor = texture2D(texture1, texCoord); 
```

`textureColor`此时包含 4 个值：红色、绿色、蓝色和 Alpha 通道，每个通道的范围从 0 到 1。您可以分别访问这些颜色中的每一个：

```
float red = textureColor.r;
float alpha = textureColor.a; 
```

或者通过使用称为“swizzling”的技术，您可以成组访问它们：

```
vec3 colorChannels = textureColor.rgb;
vec2 alphaAndBlue = textureColor.ab; 
```

您从中获得的颜色值不应被预乘，因此除非您想要，否则 Alpha 不会产生任何影响。

实际上，使用它来执行诸如将纹理的镜面反射级别打包到漫反射纹理的 alpha 通道中是很常见的：

```
float specularLevel = textureColor.a;
float lightValue = lightFactor + (specularFactor * specularLevel); // Lighting factors calculated from normals
gl_FragColor = vec4(textureColor.rgb * lightValue, 1.0); // 1.0 gives us a constant alpha 
```

鉴于着色器的灵活性，任何数量的效果都可能使用和滥用颜色通道的各种组合，因此很难说出您需要的确切算法。不过，希望这能让您了解如何分别使用颜色通道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T17:07:20.637

显然，根据其中一位[adobe 家伙](http://blattchat.com/2012/05/30/webkit-filter-shaders-oh-my/)的说法，这在 CSS 着色器语言中是不可能的，因为矩阵变换只能变换现有值，而不能添加“偏差”向量。

我现在正在探索的替代方法是使用 SVG 过滤器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T17:07:23.397

SVG 过滤器现在是在 Chrome 中实现这一目标的方法。

[https://dl.dropbox.com/u/4031469/alphaCanvases.html](https://dl.dropbox.com/u/4031469/alphaCanvases.html)

不过现在还为时尚早，目前只有 Canary 版本支持 CSS 动画。

# c++ - 在 g++ linux 上链接静态 libSOIL.a 的未定义参考

> ID：10906584
> 
> 赞同：2
> 
> 时间：2012-06-05T23:56:14.843
> 
> 标签：c++, linux, g++, static-libraries, soil

我正在尝试构建我的 openGL 项目，在我尝试使用 SOIL 库 (http://www.lonesock.net/soil.html) 从图像加载纹理之前，一切都运行良好。这个库带有一个 SOIL.h 和一个 libSOIL.a 文件。

这就是我做make时得到的：

```
g++ -I./src -Wl,-rpath,./lib -O3 -g   -c -o src/main.o src/main.cpp
g++ -I./src -Wl,-rpath,./lib -O3 -g   -c -o src/file_ply_stl.o src/file_ply_stl.cpp
g++ -I./src -Wl,-rpath,./lib -O3 -g   -c -o src/Proyecto.o src/Proyecto.cpp
g++ -I./src -Wl,-rpath,./lib -O3 -g   -c -o src/Clock.o src/Clock.cpp
g++ -I./src -Wl,-rpath,./lib -O3 -g   -c -o src/utils.o src/utils.cpp

...

g++ -I./src -Wl,-rpath,./lib -O3 -g   -c -o src/primitives/cilindro.o src/primitives/cilindro.cpp
g++ -I./src -Wl,-rpath,./lib -O3 -g   -c -o src/primitives/cono.o src/primitives/cono.cpp
g++ -I./src -Wl,-rpath,./lib -O3 -g -o app -L./lib src/main.o src/file_ply_stl.o src/Proyecto.o src/Clock.o src/utils.o src/Window.o src/Light.o src/Material.o src/PlyModel.o src/Placeable.o src/Moveable.o src/Model.o src/Texture.o src/Geometry.o src/TriGeometry.o src/TriIndGeometry.o src/Entity.o src/Camera.o src/Bounded.o src/Animatable.o src/Scene.o src/Graphics.o src/Vert.o src/Path.o src/Ant.o src/Tank.o src/Chess.o src/primitives/tetra.o src/primitives/cubo.o src/primitives/cilindro.o src/primitives/cono.o -lsfml-window -lsfml-system -lX11 -lXext -lXmu -lXi -lXt -lSM -lICE -lGLU -lGL -lglut -lSOIL
src/Texture.o: In function `Texture::ini(char const*)':
/home/roger/t/ig/prac/proyecto/src/Texture.cpp:9: undefined reference to `SOIL_load_OGL_texture'
collect2: ld devolvió el estado de salida 1
make: *** [app] Error 1 
```

这就是我的 Makefile：

```
TARGET = app

MODULES = src/main.o src/file_ply_stl.o src/Proyecto.o src/Clock.o src/utils.o
ENGINE = src/Window.o src/Light.o src/Material.o src/PlyModel.o src/Placeable.o src/Moveable.o src/Model.o src/Texture.o src/Geometry.o src/TriGeometry.o src/TriIndGeometry.o src/Entity.o src/Camera.o src/Bounded.o src/Animatable.o src/Scene.o src/Graphics.o src/Vert.o
GAME = src/Path.o src/Ant.o src/Tank.o
PRIMITIVES = src/Chess.o src/primitives/tetra.o src/primitives/cubo.o src/primitives/cilindro.o src/primitives/cono.o

CXX = g++
LIBDIR = ./lib
INCDIR = ./src

LIBS = -lsfml-window -lsfml-system -lX11 -lXext -lXmu -lXi -lXt -lSM -lICE -lGLU -lGL -lglut -lSOIL

LDFLAGS = -L$(LIBDIR)
CXXFLAGS = -I$(INCDIR) -Wl,-rpath,$(LIBDIR) -O3 -g

$(TARGET): $(MODULES) $(ENGINE) $(GAME) $(PRIMITIVES)
    $(CXX) $(CXXFLAGS) -o $(TARGET) $(LDFLAGS) $(MODULES) $(ENGINE) $(GAME) $(PRIMITIVES) $(LIBS)

clean:
    rm -f $(MODULES) $(ENGINE) $(GAME) $(PRIMITIVES) $(TARGET) 
```

这就是我的文件层次结构：

```
.:
lib Makefile src

./lib:
libsfml-audio.so       libsfml-graphics.so.2.0  libsfml-system.so.2    libSOIL.a
libsfml-audio.so.2     libsfml-network.so       libsfml-system.so.2.0  libSOIL.a.1
libsfml-audio.so.2.0   libsfml-network.so.2     libsfml-window.so      libSOIL.a.1.0
libsfml-graphics.so    libsfml-network.so.2.0   libsfml-window.so.2
libsfml-graphics.so.2  libsfml-system.so        libsfml-window.so.2.0

./src:
Animatable.cpp  Clock.cpp         Light.cpp     Moveable.h     random.h         TriGeometry.h
Animatable.h    Clock.h           Light.h       Path.cpp       Scene.cpp        TriIndGeometry.cpp
Ant.cpp         Entity.cpp        main.cpp      Path.h         Scene.h          TriIndGeometry.h
Ant.h           Entity.h          main.h        Placeable.cpp  SFML             utils.cpp
Bounded.cpp     file_ply_stl.cpp  Material.cpp  Placeable.h    SOIL             utils.h
Bounded.h       file_ply_stl.h    Material.h    PlyModel.cpp   Tank.cpp         Vert.cpp
Camera.cpp      Geometry.cpp      matrix.h      PlyModel.h     Tank.h           vertex.h
Camera.h        Geometry.h        Model.cpp     primitives     Texture.cpp      Vert.h
Chess.cpp       Graphics.cpp      Model.h       Proyecto.cpp   Texture.h        Window.cpp
Chess.h         Graphics.h        Moveable.cpp  Proyecto.h     TriGeometry.cpp  Window.h

./src/primitives:
...

./src/SFML:
...

./src/SFML/Audio:
...

./src/SFML/Graphics:
...

./src/SFML/Network:
...

./src/SFML/System:
...

./src/SFML/Window:
...

./src/SOIL:
SOIL.h 
```

我不知道发生了什么，以及为什么编译器找不到库文件。我在 Texture.h 中有 #include "SOIL/SOIL.h"，在 Texture.cpp:9 中有对 SOIL_load_OGL_texture 的调用，这是 SOIL.h 中定义的函数名称。¿ 我做错了什么？

**编辑**

我正在使用提供的库，我自己编译它并且它有效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-11-05T13:01:26.557

我必须在编译 SOIL 库时写下这个答案，即使这个问题是 4 年前提出的，因为在我找到 CMakeLists.txt 之前自己编写 CMakeLists.txt 非常困难。

CMakeLists.txt

```
cmake_minimum_required (VERSION 2.6)
project (SOIL)

set (SOIL_BUILD_TESTS false CACHE BOOL "Build tests")

if(ANDROID)
   # Android requires GL ES 2.0 package automatically
  set(LIBRARIES GLESv2)
else()
  find_package (OpenGL REQUIRED)
  include_directories (${OPENGL_INCLUDE_DIR})
  set(LIBRARIES ${OPENGL_LIBRARIES})
endif()

file (GLOB SOIL_SOURCES src/*.c)
file (GLOB SOIL_HEADERS src/*.h)

add_library (SOIL ${SOIL_SOURCES} ${SOIL_HEADERS})
target_link_libraries (SOIL ${LIBRARIES})

install (TARGETS SOIL
LIBRARY DESTINATION lib
ARCHIVE DESTINATION lib)
install (FILES ${SOIL_HEADERS} DESTINATION include/SOIL)

if (SOIL_BUILD_TESTS)
    add_executable (test_SOIL src/test_SOIL.cpp)
    target_link_libraries (test_SOIL SOIL)
    install (TARGETS SOIL test_SOIL RUNTIME DESTINATION bin)
endif () 
```

# python - 如何在不干预写入的情况下对 csv 文件执行多项更改

> ID：10906586
> 
> 赞同：1
> 
> 时间：2012-06-05T23:56:15.473
> 
> 标签：python, csv

我想对 csv 文件中的大多数行执行多次编辑，而不对输出 csv 文件进行多次写入。

我有一个 csv，我需要将其转换并清理为特定格式以供另一个程序使用。例如，我想：

1.  删除所有空白行
2.  删除列“B”的值不是数字的所有行
3.  使用这些新数据，创建一个新列并将 B 列中值的第一部分分解到新列中

以下是数据示例：

```
"A","B","C","D","E"
"apple","blah","1","","0.00"
"ape","12_fun","53","25","1.00"

"aloe","15_001","51","28",2.00" 
```

我可以弄清楚每个进程背后的逻辑，但我想不通的是如何执行每个进程而无需每次都读取和写入文件。我正在使用 CSV 模块。在编写最终的 CSV 之前，有没有更好的方法来一次执行这些步骤？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T01:02:43.850

我会定义一组测试和一组流程。

如果所有测试都通过，则应用所有进程，并将最终结果写入输出：

```
import csv

#
# Row tests
#

def test_notblank(row):
    return any(len(i) for i in row)

def test_bnumeric(row):
    return row[1].isdigit()

def do_tests(row, tests=[test_notblank, test_bnumeric]):
    return all(t(row) for t in tests)

#
# Row processing
#

def process_splitb(row):
    b = row[1].split('.')
    row[1] = b[0]
    row.append(b[1])
    return row

def do_processes(row, processes=[process_splitb]):
    for p in processes:
        row = p(row)
    return row

def main():
    with open("in.csv","rb") as inf, open("out.csv","wb") as outf:
        incsv = csv.reader(inf)
        outcsv = csv.writer(outf)

        outcsv.writerow(incsv.next())    # pass header row
        outcsv.writerows(do_processes(row) for row in incsv if do_tests(row))

if __name__=="__main__":
    main() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T01:48:00.303

简单的 for 循环。

```
import csv

csv_file = open('in.csv', 'rb')
csv_reader = csv.reader(csv_file)

header = csv_reader.next()
header.append('F') #add new column

records = [header]

#process records
for record in csv_reader:
    #skip blank records
    if record == []:
        continue
    #make sure column "B" has 2 parts
    try:
        part1, part2 = record[1].split('_')
    except:
        continue
    #make sure part1 is a digit
    if not part1.isdigit():
        continue
    record[1] = part1 #make column B equal part1
    record.append(part2) #add data for the new column F to record
    records.append(record)

new_csv_file = open('out.csv', 'wb')
csv_writer = csv.writer(new_csv_file, quoting=csv.QUOTE_ALL)

for r in records:
    csv_writer.writerow(r) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-06T00:24:53.400

为什么使用 CSV 模块。CSV 由文本行（字符串）组成，您可以使用 Python 字符串功能（split、join、replace、len）来创建结果。

line_cols = line.split(',') 并返回：line = ','.join(line_cols)

# sql - 外键：与外键约束冲突

> ID：10906590
> 
> 赞同：0
> 
> 时间：2012-06-05T23:56:40.247
> 
> 标签：sql, sql-server, foreign-keys

所以我有 2 个用 fk 相互关联的表

```
appointment
  {id, dept.id, datetime, sometable.id, sometableagain.id}
task
  {id, appointment.id, deptlead.id, taskname}
deptlead
  {id, name} 
```

所以我不得不将约会表更改为另一个表中的另一个外键。所以我删除了键（task_appointment_fk、appointment_sometable_fk、appendation_sometableagain_fk）更改表以添加新字段并再次添加所有内容。最后两个添加没有问题。而另一个（task_appointment_fk）一直给我一条消息：

```
"ALTER TABLE statement conflicted with the Forien Key Constraint "dept_appointment". The Cconflict occurred in the database "MyDb" , table "appointment", column "id" 
```

所以我找到了一些解决方案，指出任务上可能有一些行具有约会表中不存在的约会ID 值。所以我尝试插入具有相同值的行。仍然给我同样的东西。问题是，我想从任务中删除行以使其更容易，但这样做我必须再次删除所有 fks 并在其他表上做同样的事情，而且我还有很多其他表..

需要一些建议。

谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T01:23:46.860

您可以编写查询以查看外键表中的哪些值在主键表中没有匹配的键记录。如果存在值，则尝试删除它们。

```
select   * from     [task] a
left join [appointment] b
 on       a.appointment_id = b.id 
```

# javascript - 将文本文件从手机存储加载到 HTML textarea

> ID：10906594
> 
> 赞同：0
> 
> 时间：2012-06-05T23:57:03.790
> 
> 标签：javascript, html, text, io

我正在使用 HTML5、Javascript 和 CSS 为手机编写应用程序。应用程序的一部分应该允许用户将一个文本文件加载到该页面上提供的文本区域中，该文本文件显示手机的本地存储。我的问题是：

1.  如何创建文件对话框以要求用户选择 txt 文件。（可能吗？）
2.  我读了一些关于 PHP 等的东西来加载文件，但我没有这方面的经验。有没有像我可以用来加载文本文件的代码片段？Javascript、jquery mobile 能做到这一点吗？
3.  将其加载到文本区域后，我想对其进行编辑并再次保存。

如果有人可以对此有所了解或将我引导到一些我可以了解它的资源，那将会很有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T00:05:20.377

出于相当明显的安全原因，从不直接允许本地 I/O。您需要设置一个`<input type="file">`表单来执行此操作，但我不确定它们在移动平台上的行为方式。我相信这在平台之间会非常重要。假设文件成功上传并传输到您的编辑区域，保存回存储将需要您必须启动文件下载，并且用户可以选择接受或忽略。

您使用“本地存储”一词，并且您的标签包含 HTML 5，因此还有其他选项。您可以查看[LocalStorage](http://www.w3.org/TR/webstorage/) API，它允许您存储大量数据，然后您可以检索、允许编​​辑和保存。这是由浏览器控制以消除安全问题。还有[File API](http://dev.w3.org/2006/webapi/FileAPI/)，它允许读取文件。但是，我相信这是只读的（再次出于安全考虑），可能不是您要找的。

# c++ - const 是谎言吗？（因为 const 可以被抛弃）

> ID：10906595
> 
> 赞同：26
> 
> 时间：2012-06-05T23:57:05.153
> 
> 标签：c++, c, constants

> **可能重复：**
> [向我推销 const 正确性](https://stackoverflow.com/questions/136880/sell-me-on-const-correctness)

`const`关键字在`C`或`C++`既然允许这样的事情有什么用处？

```
void const_is_a_lie(const int* n)
{ 
    *((int*) n) = 0;
}

int main()
{
    int n = 1;
    const_is_a_lie(&n);
    printf("%d", n);
    return 0;
} 
```

> 输出：0

很明显，`const`不能保证论点的不可修改性。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-06-05T23:59:40.760

`const`是你对编译器的承诺，而不是它向你保证的东西。

例如，

```
void const_is_a_lie(const int* n)
{ 
    *((int*) n) = 0;
}

#include <stdio.h>
int main()
{
    const int n = 1;
    const_is_a_lie(&n);
    printf("%d", n);
    return 0;
} 
```

[http://ideone.com/Ejogb](http://ideone.com/Ejogb)上显示的输出是

> 1

由于 ，`const`允许编译器假设该值不会改变，因此它可以跳过重新读取它，如果这会使程序更快的话。

在这种情况下，由于`const_is_a_lie()`违反了其合同，因此发生了奇怪的事情。不要违反合同。并且很高兴编译器可以帮助您遵守合同。演员是邪恶的。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-06T00:02:31.947

在这种情况下，`n`是一个指向常量的指针`int`。当您将其转换为`int*`您删除`const`限定符时，因此允许该操作。

如果您告诉编译器删除`const`限定符，它会很乐意这样做。如果你让它完成它的工作，编译器将帮助确保你的代码是正确的。通过抛弃 const-ness，您是在告诉编译器您知道 的目标`n`是非常量的，并且您确实想更改它。

如果您的指针指向的东西实际上`const`是首先声明的，那么您通过尝试更改它来调用*未定义的行为，并且**任何事情都可能发生*。它可能会起作用。写入操作可能不可见。该程序可能会崩溃。你的显示器可以打你。（好吧，可能不是最后一个。）

```
void const_is_a_lie(const char * c) {
    *((char *)c) = '5';
}

int main() {
    const char * text = "12345";
    const_is_a_lie(text);
    printf("%s\n", text);

    return 0;
} 
```

根据您的特定环境，可能存在段错误（也称为访问冲突），`const_is_a_lie`因为编译器/运行时可能会将字符串文字值存储在不可写的内存页面中。

标准对修改 const 对象有这样的说法。

> 7.1.6.1/4 cv 限定符 [dcl.type.cv]
> 
> 除了可以修改任何声明为 mutable (7.1.1) 的类成员外，任何在其生命周期 (3.8) 期间修改 const 对象的尝试都会导致未定义的行为

“医生，我这样做的时候很痛！” “所以不要那样做。”

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-06T01:42:27.497

您的...

```
int n = 1; 
```

...确保`n`存在于读/写内存中；它是一个非`const`变量，因此稍后修改它的尝试将具有定义的行为。给定这样一个变量，您可以混合使用`const`和/或非`const`指针以及对它的引用——每个变量的常量性只是程序员防止代码“分支”发生意外更改的一种方式。我说“分支”是因为您可以将给予的访问可视`n`化为一棵树，其中 - 一旦标记了分支`const`，所有子分支（进一步的指针/引用`n`是否从那里初始化额外的局部变量、函数参数等）将需要保持`const`，当然除非你明确地抛弃这种 constness 的概念。抛弃`const`对于像 your 这样的可变变量是安全的（如果可能令人困惑）`n`，因为它们最终仍会写回可修改/可变/非的内存地址`const`。由于标准要求并保证我刚才描述的情况下的正常行为，因此不允许您在这些场景中想象的所有奇怪的优化和缓存导致麻烦。

可悲的是，也可以抛弃真正固有`const`变量的常量性，例如 say `const int o = 1;`，并且任何修改它们的尝试都*将*具有未定义的行为。这有很多实际原因，包括编译器有权将它们放在内存中，然后将其标记为只读（例如，参见 UNIX`mprotect(2)`) 以便尝试写入将导致 CPU 陷阱/中断，或在需要原始设置值时从变量中读取（即使在使用该值的代码中从未提及变量的标识符），或使用内联- 原始值的编译时副本 - 忽略对变量本身的任何运行时更改。因此，标准未定义行为。即使它们碰巧按照您的预期进行了修改，此后程序的其余部分也将具有未定义的行为。

但是，这应该不足为奇。类型的情况相同-如果您有...

```
double d = 1;
*(int*)&d = my_int;
d += 1; 
```

...您是否对编译器的类型撒谎`d`？最终`d`占用的内存可能在硬件级别上可能是无类型的，因此编译器所拥有的只是对它的看法，将位模式进出混洗。但是，根据硬件上的值`my_int`和双精度表示，您可能创建了`d`不代表任何有效双精度值的无效位组合，以便后续尝试将内存读回 CPU 寄存器和/或者做一些事情，`d`比如`+= 1`有未定义的行为，例如，可能会产生 CPU 陷阱/中断。

这不是 C 或 C++ 中的错误……它们旨在让您对硬件提出可疑请求，这样如果您知道自己在做什么，就可以做一些奇怪但有用的事情，并且很少需要依靠汇编语言来编写低级代码，甚至用于设备驱动程序和操作系统。

尽管如此，正是因为强制转换可能是不安全的，所以在 C++ 中引入了更明确和更有针对性的强制转换表示法。不可否认的风险 - 你只需要了解你所要求的，为什么有时可以而不是其他人，并忍受它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-06T03:20:18.193

类型系统可以帮助您，而不是照看您。您可以通过多种方式规避类型系统，不仅涉及 const，而且每次您这样做时，您所做的就是从程序中获取一个安全性。`void*`您可以根据需要通过传递和强制转换来忽略 const 正确性甚至基本类型系统。这并不意味着*const*或*types*是谎言，只是你可以强行超越编译器。

`const`有没有一种方法可以让编译器知道你的函数的契约，并让它帮助你不违反它。与输入变量的方式相同，因此您无需*猜测*如何解释数据，因为编译器会帮助您。但它不会坐以待毙，如果你强行告诉它删除 const-ness，或者如何检索数据，编译器只会让你，毕竟你设计了应用程序，它是谁第二个猜你的判断...

此外，在某些情况下，您实际上可能会导致未定义的行为，您的应用程序甚至可能崩溃（例如，如果您从一个真正为 const 的对象中丢弃 const 并修改该对象，您可能会发现在某些地方（编译器假定该值不会更改，因此执行了常量折叠），或者如果将常量加载到只读内存页面中，您的应用程序可能会崩溃。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-06T00:03:13.337

从未`const`保证不变性：标准定义了`const_cast`允许修改 const 数据的 a。

`const`对您声明更多意图并避免更改*您*打算只读的数据很有用。如果您不这样做，您将收到一个编译错误，要求您三思而后行。您可以改变主意，但不建议这样做。

正如其他答案所提到的，如果您使用 const-ness，编译器**可能会**优化更多，但好处并不总是很重要。

# javascript - 为什么在使用 struts2 和 dojo 的 ajax 请求后 javascript 代码不起作用？

> ID：10906600
> 
> 赞同：0
> 
> 时间：2012-06-05T23:57:55.677
> 
> 标签：javascript, jquery, ajax, struts2, dojo

我在 Struts2 中使用 DOJO 来支持 Ajax。发出请求后，用户列表会通过 Ajax 显示在对话框内的表格中。

此列表中的每个用户都必须包含指向用户详细信息的链接，该链接将通过 Ajax 显示在另一个对话框中。

这是包含链接的列的 html：

```
<td>
    <s:url id="mostrar_usuario_url" action="mostrar_usuario.action">
        <s:param name="id_usuario" value="%{id_usuario}"/>
    </s:url>
    <sx:a cssClass="mostrar_usuario_link" id="mostrar_usuario_link_%{id_usuario}" targets="mostrar_usuario_dialog" href="%{mostrar_usuario_url}">
        <s:property value="id_usuario"/>
    </sx:a>
</td> 
```

它成功地获取了用户信息和 html，但是没有启动应该显示信息的对话框。

这是对话框的脚本：

```
$(document).ready(function() {
    $("#buscar_usuarios_dialog").on("click", ".mostrar_usuario_link", function() {
            $("#mostrar_usuario_dialog").dialog({
            modal:true
        }) 
    })
}) 
```

“buscar_usuarios_dialog”是包含表的 div 的 id。

问题是 ajax 可以完美运行，但 javascript 不能。可能是什么问题呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T00:01:19.957

正如我在你之前的问题中所说的那样。也许您需要使用 preventDefault 因为元素是锚标记？

```
$("document").on("click", ".mostrar_usuario_link", function(e) {
    //Prevent Default action from link
    e.preventDefault();
    ...
}); 
```

没有在小提琴中看到它，而是以您生成的 HTML 的示例 - 这是我想象您的结构类似于的示例，并且它工作正常。[http://jsfiddle.net/6tqvj/](http://jsfiddle.net/6tqvj/)

# javascript - Ajax 请求在 Safari、Chrome 中不起作用

> ID：10906604
> 
> 赞同：1
> 
> 时间：2012-06-05T23:58:24.397
> 
> 标签：javascript, jquery, ajax, asp-classic

我有一个 ajax 请求，当单击链接下载文件时会触发该请求。调用服务器端页面，使用访问者下载的客户 ID 和文件名更新数据库。使用 Jquery 1.5.1。这是链接html：

```
<a href="/downloads/whatever.zip" class="software">click here to download</a> 
```

ajax 请求编写如下，并包含一个函数，用于通知 ajax 请求中是否有错误：

```
$(document).ready(function() {
  //function to alert an error message if request is unsuccessful
  function ajaxError(request, type, errorThrown)
  {
  var message = "There was an error with the AJAX request.\n";
  switch (type) {
      case 'timeout':
          message += "The request timed out.";
          break;
      case 'notmodified':
          message += "The request was not modified but was not retrieved from the cache.";
          break;
      case 'parseerror':
          message += "XML/Json format is bad.";
          break;
      default:
          message += "HTTP Error (" + request.status + " " + request.statusText + ").";
  }
  message += "\n";  
  alert(message);
  }

$('a.software').click(function() {  
//get the path of the link, and just the file name to be stored in the database
var filePath = $(this).attr("href");
var partsArray = filePath.split('/');
var theFileName = partsArray[partsArray.length-1];

  $.ajax({
     type: "POST",
     url: "/validate/softwareDownloadedCustomer.asp?custID=<%=custID%>&fileName=" + theFileName,
     success: function(msg) {
      alert("Success");
     },
     error: ajaxError
    });
  }); 
}); 
```

服务器端代码不是问题，当仅由另一个页面而不是 ajax 请求调用时，它可以按预期工作。奇怪的是，ajax 请求在 Firefox 和 IE 中有效，但在 Chrome 和 Safari 中无效。在 IE 中，会提示“成功”消息并更新数据库。在 Firefox、Chrome 和 Safari 中，我收到的错误消息如下所示：

```
There was an error with the AJAX request.
HTTP Error (0 error) 
```

即使在 Firefox 中收到错误消息，它也会更新数据库。在 chrome 和 safari 中，收到错误消息并且没有任何更新。

我已经尝试在我的 ajax 调用中使用以下设置，但它似乎在任何浏览器中都没有什么不同：

```
contentType: "application/json; charset=utf-8",
dataType: "json", 'data' 
```

为了让它在 Safari 和 Chrome 中工作，我缺少什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T21:31:04.060

我实际上找到了导致问题的原因 - 这是由于 ajax 请求被激活下载文件的链接中断。通过单击链接触发 ajax 请求。错误消息的请求状态为 0，这意味着链接操作显然中断了 ajax 请求。由于某种原因，显然在 IE 中请求没有被中断，但它在 firefox、safari 和 chrome 中，因此出现错误消息。我在这里找到了相关信息：[链接](http://bartwullems.blogspot.com/2012/02/ajax-request-returns-status-0.html)。

在测试了通过简单的按钮单击而不是链接触发的 ajax 请求之后，我知道情况就是这样。当通过简单的按钮单击触发时，它在所有浏览器中都能成功运行，没有错误消息。

解决方法是不使用 AJAX，而是将用户发送到记录点击的服务器端页面，然后重定向到相应的下载链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T12:32:37.963

您的 Ajax 请求使用 POST 但不发布任何数据。您传递的数据是通过您的 URL 请求参数。

尝试将您的 ajax 类型更改为 GET

```
type: "GET",      
url: "/validate/softwareDownloadedCustomer.asp?custID=<%=custID%>&fileName=" + theFileName, 
```

或通过发布数据传递您的参数

```
var dataToPost = 'custID=<%=custID%>&fileName=' + theFileName;

type: "POST",      
url: "/validate/softwareDownloadedCustomer.asp", 
data : dataToPost, 
```

# python - JQuery getJSON 函数从 Python 页面调用的输出

> ID：10906605
> 
> 赞同：0
> 
> 时间：2012-06-05T23:58:27.353
> 
> 标签：python, web.py, python-2.5

我正在开发一个使用 Python web.py 的网站。有一个表单，用户输入输入，当点击提交按钮时，使用下面显示的 .getJSON JQuery 函数调用（匹配）python 页面。

```
function buildMatches(input){
    $.getJSON("/matches", {e:input}, function(json){
      //Returned JSON object is worked on
   }
} 
```

“匹配”python 页面从数据库中获取一个值，运行一些字符串 reg ex 并返回一个 JSON 对象。一切正常，我的问题是我如何能够从 python 页面“匹配”输出一些东西，以查看在 reg ex 操作期间到底发生了什么？我试过 print "" (python 2.5)，但我知道这会打印到控制台。我做了一些研究，但找不到适合我的情况的任何东西。我不一定需要将它打印到 HTML 页面，只要我能看到正在发生的事情的任何地方。提前感谢您的帮助。

我可以访问网络服务器（SSH、SFTP 等），我尝试通过导入日志记录模块来记录，下面是我使用的代码。如果我从命令行运行页面，我可以让它记录下来，但当它被 JS 页面调用时就不行。

```
import logging
logging.basicConfig(filename='./SomeClass.log', filemode='w', level=logging.DEBUG)

class SomeClass:
    logging.info('Started')
    logging.info('Another log')

    def __init__(self, obj):
        logging.info('In the init')

    def another_functio(self):
                logging.info('Logging inside the function') 
```

我已经尝试设置日志的完整路径，但我仍然遇到同样的问题，即只有当我从控制台运行此类时才会写入或更新日志文件。当网络服务器调用该类时，这不起作用。

```
logging.basicConfig(filename='/home/.../.../.../example.log', filemode='w', level=logging.DEBUG) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T01:34:35.690

根据您对 Web 服务器的访问权限，您可以手动运行代码，以便 web.py 使用其内置的 Web 服务器。然后打印语句将在控制台上结束。

否则，您是否考虑过简单地将自己的日志文件写入浏览器可访问的某个地方？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T16:58:18.103

再次感谢所有帮助。在深入研究了 Apache 服务器的设置和 Python 实现之后，我找到了一个解决方案来帮助我了解正在发生的事情并调试我的 Web 应用程序。我看到 Apache 配置设置为记录错误，并且 WSGI 也阻止（呕吐）std.out。我能够做的是将打印命令重定向到 Apache 错误日志文件。

```
print >> sys.stderr, "Debugging print with variable" + variable 
```

然后我检查 Apache 错误日志以开始调试 Web 应用程序。我想我会分享这个，以防其他人遇到这个问题，因为这对我来说很痛苦。

再次感谢。

# javascript - 如何定位所有大写单词的字符串？

> ID：10906606
> 
> 赞同：-1
> 
> 时间：2012-06-05T23:58:29.907
> 
> 标签：javascript, jquery, string

我正在尝试更改包含某些文本样式的字符串的背景颜色（使用 javascript）。例如，我想让所有不包含任何大写字母的文本都具有绿色背景，并且任何包含所有大写字母的单词的字符串都具有红色背景。

我知道我需要使用条件 if 语句，但我不确定如何实现所需的。

下面是我的 js fiddle 的链接。任何想法将不胜感激。谢谢！

[http://jsfiddle.net/gnXCr/](http://jsfiddle.net/gnXCr/)

-D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T00:13:35.723

基本上，您按单词拆分字符串，遍历这些单词，然后在每个单词中遍历每个字母并通过检查字母和 letter.toLowerCase() 是否不同来检查它是否为大写。像这样的东西：

```
function hasAllCapsWord(string) {
    var words=string.split(" ");

    for (var i=0;i<words.length;i++) {
        var letters=words[i].split("");
        var wordIsAllCaps=false;

        for (var j=0;j<words.length;j++) {
            if (letters[j] && letters[j]!=letters[j].toLowerCase()) {
                wordIsAllCaps=true;
            }
        }

        if (wordIsAllCaps) return true;
    }

    return false;
} 
```

# phpexcel - 为什么连续两次调用 createSheet 会损坏 PHPExcel 中的文档？

> ID：10906608
> 
> 赞同：0
> 
> 时间：2012-06-05T23:58:49.267
> 
> 标签：phpexcel

```
$workbook = new PHPExcel();
$workbook->createSheet()->setTitle('whatt')->setCellValue( 'A1', 'Another sheet' );
$workbook->createSheet()->setTitle('whatt')->setCellValue( 'A1', 'Another sheet' );
$objWriter = new PHPExcel_Writer_Excel2007($workbook);
$objWriter->setOffice2003Compatibility(true);

ob_start();
$objWriter->save( "php://output" );
$contents = ob_get_contents();
ob_end_clean();

// required for IE, otherwise Content-disposition is ignored
if(ini_get('zlib.output_compression'))
  ini_set('zlib.output_compression', 'Off');

$size = count($contents);

header("Pragma: public");
header("Expires: 0");
header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
header("Cache-Control: private",false);
header('Content-Type: application/vnd.msexcel; charset=utf-8');
header("Content-Disposition: attachment; filename=\"test.xlsx\"");
header("Content-Transfer-Encoding: binary");
header("Content-Length: {$size}");
echo $contents;
exit; 
```

当我下载工作表时，它下降为 1 个字节，其中第一个单元格是“P”的`createSheet`工作表（因为文件只包含那个字母）如果我注释掉第二行，它就完美了。任何想法？

**编辑**

我接受了下面的答案，它告诉我这不是 PHPExcel 的错，也不是。如果我删除标题并保持输出缓冲，作为测试，它仍然有效。

```
ob_start();
$objWriter->save( "php://output" );
$contents = ob_get_contents();
ob_end_clean();

file_put_contents( "/mypath/uploads/test.xlsx", $contents ); 
```

我可以下载文件没有问题。这让我相信标题以某种方式搞砸了，考虑到如果我只使用一次 createSheet 就没有问题，这是非常奇怪的。我想当我弄清楚时我会在这里发布。

……

我弄清楚了为什么标题搞砸了。显然使用`count($contents)`添加一张纸很好，但添加两张纸它只会返回`1`。我将其更改为`strlen($contents)`并且有效。如果有人能告诉我为什么会这样，加分:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T06:40:29.747

没有大量调试，不知道。摆脱多余的输出缓冲，它就可以工作了。这是您的问题的原因，在 PHPExcel 中没有任何内容。那么你接下来用 $contents 做什么呢？

连续两次调用 createSheet() 不会破坏任何东西：尽管您为什么要创建一个包含两个具有相同标题的工作表的工作簿呢？PHPExcel 实际上会将第二个添加的工作表重命名为 whatt2 以避免出现问题。

# c# - 简洁的 ORM 嵌套对象

> ID：10906611
> 
> 赞同：11
> 
> 时间：2012-06-05T23:59:08.780
> 
> 标签：c#, orm, dapper

我有一个客户要求我使用我以前从未使用过的 Dapper ORM。我有嵌套对象的问题。我有一个主类（位置），它有一个嵌入的值对象类（地址）。这两个类如下所示：

```
class Location {
    int Id;
    string LocationName;
    Address LocationAddress;
}

Class Address {
    string Street;
    string City;
    string State;
    string ZipCode;
} 
```

SQL：

```
SELECT Id, LocationName, Street, City, State, ZipCode FROM Locations 
```

我查看了许多示例，但无法正确设置查询。我只是不太了解 Dapper，无法正确构建结构。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-08T05:48:06.780

您可以在 dapper 查询中使用“splitOn”参数。

```
var sql = "SELECT Id, LocationName, Street, City, State, ZipCode FROM Locations";
var conn = // your get connection logic here. 

using(conn)
{
 conn.Open();
 var locations = conn.Query<Location,Address,Location>(sql, (location, address) => 
                 {
                   location.LocationAddress = address;
                   return location;
                 }, splitOn: "Street");
} 
```

如果记录集中的对象没有被名为“Id”的列“拆分”，则需要 SplitOn。

# django - Django - 在特定属性的模板中加入对象列表

> ID：10906614
> 
> 赞同：2
> 
> 时间：2012-06-05T23:59:32.690
> 
> 标签：django

是否可以加入模型对象列表（使用加入模板标签），除了不加入对象的 unicode 值，而是加入每个对象的特定字段？

例如 {{ objects.field|join", " }} 应该返回 "object1.field, object2.field, ..." 其中 objects 是模型实例的列表。

我知道迭代是一种选择，但我想知道是否有更优雅的解决方案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-06T00:02:56.510

创建自定义模板标签。

```
@register.filter
def join_by_attr(the_list, attr_name, separator=', '):
    return separator.join(unicode(getattr(i, attr_name)) for i in the_list) 
```

# css - 行内块垂直对齐

> ID：10906619
> 
> 赞同：2
> 
> 时间：2012-06-05T23:59:59.717
> 
> 标签：css

我知道有很多方法可以做到这一点，但真的想很好地解释为什么垂直对齐在这种情况下不起作用：

[http://jsfiddle.net/jasonsnyc/zAg8g/1/](http://jsfiddle.net/jasonsnyc/zAg8g/1/)

我所追求的是将图像垂直居中而不使用浮动、表格或显示：表格单元格。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T00:05:08.277

`line-height: 135px;`在容器和`vertical-align: middle`图像本身上使用。

# emacs - Emacs：在 OSX 中显示 unicode 字符的字体设置

> ID：10906621
> 
> 赞同：7
> 
> 时间：2012-06-06T00:00:03.607
> 
> 标签：emacs, fonts, osx-lion

我正在尝试显示特殊的 unicode 字符，尤其是 emacs 中的数学运算符。具体来说：

```
 position: 283 of 317 (89%), column: 0
            character:  (displayed as ) (codepoint 120046, #o352356, #x1d4ee)
    preferred charset: unicode (Unicode (ISO10646))
code point in charset: 0x1D4EE
               syntax: w    which means: word
             category: .:Base, L:Left-to-right (strong)
          buffer code: #xF0 #x9D #x93 #xAE
            file code: #xF0 #x9D #x93 #xAE
               (encoded by coding system utf-8-unix)
              display: no font available
         Unicode data:
                 Name: MATHEMATICAL BOLD SCRIPT SMALL E
             Category: Letter, Lowercase
      Combining class: Ll
        Bidi category: Ll
        Decomposition: font e

Character code properties: customize what to show
  name: MATHEMATICAL BOLD SCRIPT SMALL E
  general-category: Ll (Letter, Lowercase)
  decomposition: (font 101) (font 'e')

There are text properties here:
  fontified            t 
```

我正在使用最近的夜间二进制文件 GNU Emacs 24。上面的文本在我的浏览器和 TextEdit 中显示正常，但是在 emacs 中查看时特殊字符显示为空。

我从旧的 Emacs 22[手册](http://sunsite.univie.ac.at/textbooks/emacs/emacs_22.html)中读到：*“字体集不一定为所有字符代码指定字体。如果字体集没有为某个字符指定字体，或者它指定了系统上不存在的字体，那么它无法显示该字符。它将显示一个空框。”* - 这是我观察到的确切行为

看来我可能需要构建一个字体集才能显示这样的任意字符（从 Xdefaults 或 Xresources 文件开始）。

如何确定需要在字体集中包含哪些字体系列以显示数学运算符（大多数在线示例是指拉丁语、中文等语言）？我什至找不到 .Xdefault 或 .Xresource 文件的任何示例。

我在正确的轨道上吗？有没有更简单/更明显的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T09:35:31.080

该函数`set-fontset-font`可用于指定任何字符范围使用哪种字体；例如，

```
(set-fontset-font t '(#x1d4ee . #x1d4ee) (font-spec :family "FreeSerif")) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-21T14:11:03.853

我有同样的问题，我也没有通用的解决方案。这是我修复单个字符（或可能是一个范围）的方法，假设您在缓冲区中有字符并且它没有显示。

一些实验表明，Menlo 是一个有用的字符来源，例如 FreeSerif。

1.  将光标放在未显示的字符之前。

2.  mx 描述字符。这为您提供了有关该字符的大量信息，包括“字符集中的代码点：0x2055”形式的一行。

    1.  在您的 .emacs 或相关文件的某处，使用此功能。它可以通过从 FreeSerif 家族或其他东西中获取它们来修复整个范围的字符，但除了几个字符之外，我没有其他好的选择。

```
    (defun bbextra-fix-fontset-font (从 &optional 到 family)
      “让字符 FROM 到 TO 来自 FAMILY。  
    TO 的默认值为 FROM，FAMILY 的默认值为 FreeSerif（其中
    似乎有一些字符）”
     (set-fontset-font t (cons from (or to from))
                       （字体规范：family（或family“FreeSerif”））））

    ;; 这是我固定的字符。  
    (bbextra-fix-fontset-font #x2042)
    (bbextra-fix-fontset-font #x2023)
    (bbextra-fix-fontset-font #x203D)
    (bbextra-fix-fontset-font #x2055)

     ;这些来自门洛
     (bbextra-fix-fontset-font #x2620 #x2620 "Menlo") ; 骷髅和交叉骨
     (bbextra-fix-fontset-font #x266C #x266C "Menlo") ; 十六分音符
     (bbextra-fix-fontset-font #x2695 #x2695 "Menlo") ; 天秤座
     (bbextra-fix-fontset-font #x2624 #x2624 "Menlo") ; 手杖

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-15T02:38:11.467

MacOS emacs 存在一个已知错误，并且显示 BMP 之外的字符。例如，请参阅我在[Emacs bugs](http://debbugs.gnu.org/cgi/bugreport.cgi?bug=13423)上的错误报告。

报告此错误后，我收到一封电子邮件，建议使用[“Mac 端口”版本的 emacs](http://lists.gnu.org/archive/html/emacs-devel/2012-10/msg00733.html)。这显然显示了非 BMP 字符。

该错误随后在 24.4 及更高版本中*得到修复。*

# javascript - (Javascript) 如何提取当前 URL 的最后一部分 - 没有文件扩展名？

> ID：10906622
> 
> 赞同：2
> 
> 时间：2012-06-06T00:00:13.873
> 
> 标签：javascript, url, location, extract

我目前有以下 javascript 代码工作：

```
<script type="text/javascript"> 
    urlPath=window.location.pathname; 
    urlPathArray = urlPath.split('/'); 
    urlPath1=urlPathArray[2]; 
    document.write('<a href="http://www.example.com/contact.php?id='+urlPath1+'">test</a>'); 
    </script> 
```

假设当前 URL 是`http://www.example.com/products/0033.htm`

javascript产生一个超链接到`http://www.example.com/contact.php?id=0033.htm`

如何修改此脚本以使*urlPath1*和最终的超链接没有“.htm”部分？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T00:02:08.933

完全按照您为获取文件名所做的操作，但拆分`.`而不是`/`获取第一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T00:09:28.633

```
var urlPath = window.location.pathname,
    urlPathArray = urlPath.split('.'),
    urlPath1 = urlPathArray[0].split('/').pop(); 

document.write('<a href="http://www.example.com/contact.php?id='+urlPath1+'">test</a>'); 
```

# jquery - PayPal 自适应付款 - returnUrl 显示在 Lightbox IFrame 中

> ID：10906629
> 
> 赞同：0
> 
> 时间：2012-06-06T00:01:04.417
> 
> 标签：jquery, asp.net-mvc, paypal-sandbox, paypal-adaptive-payments

我正在使用 PayPal 的自适应支付“支付”方法。随着灯箱的出现和付款流程的完成，一切似乎都运行良好。完成后我还会收到我的 IPN。但是，当用户在付款后按下关闭时，我的 returnURL 将显示在 IFrame 中，而不是其后面的主窗口中。

我一直在解决这个问题。PayPal 为交易后提供的脚本正确关闭了灯箱 iframe，但这是完成页面所在的位置，因此用户只需返回到我的结帐页面。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T00:16:29.467

此页面提供了所需的信息：

[http://www.digitalgoodsexpresscheckout.com/PayPal/Articles/DigitalGoodsExpressCheckout/DigiGoodsEC.html](http://www.digitalgoodsexpresscheckout.com/PayPal/Articles/DigitalGoodsExpressCheckout/DigiGoodsEC.html)

# gitolite - 用户在使用 gitolite 时被要求输入密码

> ID：10906633
> 
> 赞同：8
> 
> 时间：2012-06-06T00:01:39.163
> 
> 标签：gitolite

我已经`gitolite-admin.git`在服务器（比如说）上成功创建了 repo `10.107.105.13`。我可以`10.14.42.7`通过发出`git clone gitolite@10.107.105.13:gitolite-admin`. 我必须在文件中添加一些行`.ssh/config`以确保使用正确的私钥。

然后我添加了一个用户`dilawar`到`conf/gitolite.conf`文件和一个适当`dilawar.pub`的`keys`文件夹键。我已经添加并提交了这个提交到`gitolite-admin`repo。我还在`.ssh/conf`文件中添加了一个条目，以便使用正确的私钥。但是当我尝试这样做时`git clone dilawar@10.107.105.13:testing`，gitolite 要求输入密码。我的印象是我不必在 10.107.105.13 上创建用户 dilawar。我通过登录服务器检查了存储库 testing.git 是否存在以及公钥`dilawar.pub`已添加到`.ssh/authorized_keys`.

我还尝试`ssh -vvvv dilawar@10.107.105.13`检查是否提供了正确的文件。这是我的`.ssh/conf`文件。

```
HostName 10.107.105.13 
    User gitolite
    IdentityFile ~/.ssh/gitolite

Host 10.107.105.13
    HostName 10.107.105.13 
    User dilawar 
    IdentityFile ~/.ssh/id_rsa 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-06T07:19:29.667

在您的配置文件中，我看到：

```
User dilawar 
```

那是错的。与 gitolite 服务器的 ssh 通信始终使用**相同的帐户**（此处`gitolite`）完成。
使用的私钥会发生什么变化，这将有助于 gitolite 确定您的身份。

你`~/.ssh/config`的文件应该是这样的：

```
Host admin
    HostName 10.107.105.13 
    User gitolite
    IdentityFile ~/.ssh/gitolite

Host dilawar
    HostName 10.107.105.13 
    User gitolite
    IdentityFile ~/.ssh/id_rsa 
```

对于克隆`gitolite-admin`，您将使用：

```
git clone admin:gitolite-admin 
```

对于克隆 repo`dilawar`可以访问：

```
git clone dilawar:aRepo 
```

请参阅“ [Gitolite：添加用户不起作用，并在克隆为 root 时被 fallthru 拒绝？](https://stackoverflow.com/questions/10843781/gitolite-adding-user-not-working-and-denied-by-fallthru-when-cloning-as-root/10844231#10844231) ”。
另请参阅“ [gitolite 如何使用 ssh](http://sitaramc.github.com/gitolite/glssh.html) ”

> 将您的公钥添加到服务器的`~git/.ssh/authorized_keys`文件是 ssh 使用 pubkeys 对用户进行身份验证的方式。
> 假设`sita@work.station`正在尝试以`git@server`.
> 您需要做的是为工作站上`~sita/.ssh/id_rsa.pub`的用户获取文件`sita`并将其内容（记住它只有一行）附加到服务器上`~git/.ssh/authorized_keys` **的用户`git`**。
> 
> authorized_keys 文件可以添加多个公钥（来自许多不同的人），因此他们中的任何一个都可以登录到`git@server`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-08T11:36:18.363

我通过使用 gitolite 用户名克隆存储库来使其工作。

```
git clone gitolite@server:repo 
```

如果键添加成功，则进一步的拉和推将顺利进行。

我接受 VomC 答案作为更好的答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-05-21T11:01:48.877

[VonC 的答案](https://stackoverflow.com/a/10909791/26702)是关键，但我遇到了一个对未来的搜索者来说值得一提的极端案例。

即使您在其他所有方面都做对了，就像 VonC 的回答一样，有些标准的设置`ControlPath`也会把事情搞砸。

我有两个用户`~/.ssh/config`，如下：

```
Host gitolite
    HostName <whatever> 
    User git
    IdentityFile ~/.ssh/gitolite

Host username
    HostName <whatever> 
    User git
    IdentityFile ~/.ssh/username 
```

从理论上讲，这应该允许我运行`git clone git@username:reponame`，但是服务器一直认为我试图以 gitolite 管理员（没有克隆该 repo 的权限）的身份克隆 repo，而不是作为 gitolite 用户（确实有克隆 repo 的权限）。

问题是在我的所有主机部分中，我有以下内容：

```
Hosts *
    # other stuff that doesn't matter
    ControlPath ~/.ssh/ssh-%r@%h:%p 
```

如果您没有立即看到它（我没有看到！），问题在于`%r@%h%p`(= `username@hostname:port`)的扩展对于gitolite 和 username 条目是*相同的。*他们都是`git@hostname:port`！一旦我意识到这一点，这很容易解决。`ControlPath`只需将区别元素添加到这两个用户的更具体的条目中。例如，

```
Host gitolite
    HostName <whatever> 
    User git
    IdentityFile ~/.ssh/gitolite
    ControlPath ~/.ssh/gitolite-admin-%r@%h:%p

Host username
    HostName <whatever> 
    User git
    IdentityFile ~/.ssh/username
    ControlPath ~/.ssh/gitolite-username-%r@%h:%p 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-14T12:20:36.697

我必须编辑`/etc/ssh/sshd_config`并将`git`（用户）添加到以 . 开头的行中`AllowUsers`。然后我必须将 git 添加到一个 sysadmin 组，该组也允许在 sshd_config 的以`AllowGroups`.

不要忘记使用 重新启动 ssh 守护程序`sudo service ssh restart`。

注意：我不必像之前建议的那样`ssh-copy-id`添加或添加公钥`/home/git/.ssh/authorized_keys`（gitolite 的开发人员建议不要这样做。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-02-18T23:01:14.430

由于我的配置，我遇到了同样的问题，但使用了不同的解决方案。我将我的 gitolite 用户设置为“git”，所以我需要这样做`git clone git@server:repo.git`

# bash - 是否有 Bash one-liner 来检查三个命令的输出是否匹配？

> ID：10906634
> 
> 赞同：3
> 
> 时间：2012-06-06T00:02:00.237
> 
> 标签：bash

我试图找出一些 Bash-foo 来检查三个不同命令的输出是否相同。我可以用几行 Bash 脚本来做到这一点，我只是想知道我想做的事情是否可以在一行中通过一些花哨的 shell I/O 重定向来实现。

我想要做的是检查 SSL 证书是否与特定的密钥和证书签名请求匹配。

命令如下所示：

```
openssl x509 -noout -modulus -in certificate.crt | openssl md5
openssl rsa -noout -modulus -in privateKey.key | openssl md5
openssl req -noout -modulus -in CSR.csr | openssl md5 
```

如果密钥、证书和 csr 匹配，所有这三个命令都应该输出相同的输出，例如：“(stdin)= 95ce143e8418cf8a4f7dd718983ed4eb”。

这是一个原型：

```
[[ $(echo -e "blah\nblah\nblah" | uniq | wc -l) -eq 1 ]] 
```

但我无法从那里得到最终产品。这不起作用：

```
[[ $(openssl x509 -noout -modulus -in certificate.crt | openssl md5 && openssl rsa -noout -modulus -in privateKey.key | openssl md5 && openssl req -noout -modulus -in CSR.csr | openssl md5 | uniq | wc -l) -eq 1 ]] 
```

一个问题可能是我的原型从一个命令生成了所有三行输出，但实际使用`&&`了几次。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T00:10:41.053

`cmp -s <( cmd1) <(cmd2) && cmp -s <( cmd1) <(cmd3)`

请注意，此构造执行 cmd1 两次。

如果您需要每个 cmd 的单个 exec，更复杂的行将如下所示：

`cmd1|tee >( cmp -s <(cmd2) )|cmp -s <(cmd3)`

同样对于第二个，检查结果很复杂（你必须检查`PIPESTATUS`数组）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T00:18:57.007

你可能的意思是

```
((1 == $( ( echo 1 && sleep 1; echo 1 && sleep 1) | sort -u | wc -l ) )) 
```

但这可能更容易做到

```
x1=$( command1 )
x2=$( command2 )
x3=$( command3 )

if [[ $x1 == $x2 && $x2 == $x3 ]] ; then
    echo The same.
fi 
```

编辑：这种形式也应该可以工作，但会减少存储变量的数量。

```
x1=$(command1)
[[ $x1 == $(command2) && $x1 == $(command3) ]] && echo match 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-06T00:36:07.083

问题是您仅将最后一个命令“子管道”传送到`uniq`. 尝试这个：

```
[[ $( { openssl x509 -noout -modulus -in certificate.crt | openssl md5 && openssl rsa -noout -modulus -in privateKey.key | openssl md5 && openssl req -noout -modulus -in CSR.csr | openssl md5; } | uniq | wc -l) -eq 1 ]] 
```

花括号使三个“子管道”的行为就好像它们一起是一个命令`uniq`，类似于您的`echo`原型。

# c# - 确定对不正确的 .NET Framework 版本的间接依赖的来源

> ID：10906637
> 
> 赞同：19
> 
> 时间：2012-06-06T00:02:11.420
> 
> 标签：c#, visual-studio-2010, projects-and-solutions, postsharp

我想知道如何确定此构建错误的来源；

```
Warning 4   The primary reference "MyNamespace.MyProject" could not be resolved because 
   it has an indirect dependency on the .NET Framework assembly "System.Xml, Version=4.0.0.0,
   Culture=neutral, PublicKeyToken=b77a5c561934e089" which has a higher version "4.0.0.0" than
   the version "2.0.0.0" in the current target framework.   MyNamespace.MyOtherProject 
```

我理解这个错误的含义（以及同一个项目中其他 5 个喜欢它的错误），但我无法解决在我的情况下如何解决它。在这种情况下，“主要参考”（MyNamespace.MyProject）对 .NET 4.0.x 没有直接依赖关系。

主要参考仅依赖于我的另一个项目 (MyNamespace.MyCoreProject)，构建的源项目 (MyNamespace.MyOtherProject) 也直接依赖于该项目。并且构建并没有抱怨*该*项目间接引用了 .NET 4.0.x，所以我认为我可以排除这种情况。

主要参考直接依赖于三 (3) 个第 3 方 DLL，所有这些 DLL 也都以 .NET 2.0 为目标。

我使用 dotPeek 来检查构建的库，并且看不到对使用 .NET 4.0 的任何内容的任何引用。

作品中唯一的其他潜在扳手是 PostSharp 的使用，它由“MyNamespace.MyCoreProject”直接引用（由主要参考项目引用），这可能会导致问题，因为我相信有一个相关的 VS2010 错误时引用 PostSharp.dll (http://www.sharpcrafters.com/forum/Topic4444-4-1.aspx#bm4462)，但是我也从构建链中删除了它，仍然看到这个错误，所以我假设我也可以统治*那*出来。

如果有人能告诉我为什么会这样，太棒了！如果没有，关于如何找出未命名的“间接引用”的一些指导将同样有帮助！

顺便说一句，我已经尝试了以下所有工具来获取一些信息，但它们并没有告诉我很多我不知道的东西（这是有问题的 DLL 的直接依赖项）；- .NET 反射器 - dotPeek - IldAsm - Depends (Dependency Walker)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-07T00:26:03.293

虽然我实际上还没有找到一个好方法来实际解决确定 MsBuild 如何确定它使用的引用的问题（为什么它不只是告诉我它是如何产生这些间接引用的，而不是让我猜我没有知道...）我*已经*解决了我的问题。

最后，我基本上删除了“主要引用”项目中的所有引用（这需要逐段排除所有代码 - 一个有点痛苦的过程）以确定假定的对 .NET 4.0 库的间接引用的来源是由引用的第 3 方 DLL。

但是，我确实相信这个问题背后的 MsBuild 中有一个错误，因为；

1.  第 3 方 DLL 被“浏览”引用到我机器上的特定 DLL 文件 - 一个非常明确地仅依赖于 .NET 2.0
2.  在构建中将“特定版本”设置为 true 并没有解决此问题
3.  MsBuild 似乎要向 GAC 寻求此 DLL 的*不同版本*，并导致不正确的引用错误。

现在，另一个好奇心是我已经有一段时间没有接触或更改相关的库了，所以这只是由于其他一些不相关的原因才开始发生 - 这可能是什么，我不知道。

最后，我发现解决此问题的唯一方法是为每个相关库运行**gacutil /u**以删除以前安装/使用的 4.0 库版本。（包中大约有 40 个，所以这也很痛苦！因为包的卸载程序没有删除 GAC 中的库）

这似乎让 msbuild 开始使用我告诉它的引用，而不是想出自己的想法“使用这个文件”和“使用这个*特定版本*的含义”。

解决了，但我会喜欢一种更清洁的方法来做到这一点！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T03:55:40.227

尝试对所有可疑程序集使用[MSIL Disassembler](http://msdn.microsoft.com/en-us/library/f7dy01k1%28v=vs.100%29.aspx)工具。

1.  打开 Dll，单击 Ctr + M 并转到屏幕末尾。您可能会看到对某些 .NET 4 程序集的引用，如下所示：

## AssemblyRef #1 (23000001)

```
Token: 0x23000001
Public Key or Token: b7 7a 5c 56 19 34 e0 89 
Name: mscorlib
Version: 4.0.0.0
Major Version: 0x00000004
Minor Version: 0x00000000
Build Number: 0x00000000
Revision Number: 0x00000000
Locale: <null>
HashValue Blob:
Flags: [none] (00000000) 
```

1.  使用inf ref # 查找从该.NET 程序集加载的类型作为搜索条件。这是您可以在屏幕中找到的类型示例

    ## TypeRef #18 (01000012)

    令牌：
    0x01000012 ResolutionScope：0x23000001
    TypeRefName：System.Runtime.CompilerServices.CompilationRelaxationsAttribute

2.  调查为什么使用该类型。

**更新：** 您是否尝试在 Tools\Options\Projects and Solutions\Build And Run 页面上将 MSBuild Project Build Output Verbosity 设置为“Detailed”，然后重新构建解决方案？你可能会在 ResolveAssemblyReference 目标中看到一些东西

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-12-06T01:17:39.093

我遇到了这个问题，并使用 CheckAsm 确定我自己的一个程序集出于某种奇怪的原因引用了 3rd 方库的 .NET 4.0 版本，而应用程序本身是 .NET 2.0。我从我的硬盘驱动器中删除了该程序集的所有实例（周围有很多副本），重建了解决方案，一切都很好。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-12-20T05:48:25.890

就我而言，程序集已卸载，并且所有引用（据我所知）都已删除。

在 app.config 中找到它：

```
<runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
        <dependentAssembly>
            ...
        </dependentAssembly>
    </assemblyBinding>
</runtime> 
```

删除了dependentAssembly 并让我的应用程序再次运行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-02-08T09:04:20.733

我也遇到了这个问题，event.er 引导我找到解决方案。我的 app.config 中有以下内容：

```
 <dependentAssembly>
    <assemblyIdentity name="System.Net.Http" publicKeyToken="b03f5f7f11d50a3a" culture="neutral" />
    <bindingRedirect oldVersion="0.0.0.0-2.0.0.0" newVersion="4.0.0.0" />
  </dependentAssembly> 
```

我将 newVersion 更改为“2.0.0.0”并构建了解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-24T01:06:07.770

我的猜测是第 3 方 DLL 是一个没有将特定版本设置为 true 的依赖项并导致您的问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-09-07T18:20:22.103

我在一个针对 .NET 4.5 的项目中遇到了*System.Data.SQLite.dll*的问题，结果是针对 4.5.1 的版本已安装到 GAC_32。

如果我用 构建解决方案`Copy Local = True`，一切都会好起来的。但是当我在最终构建中嵌入 SQLite 程序集时，这似乎是不必要的，我想对其进行整理。

我尝试运行`gacutil -u System.Data.SQLite.dll`但遇到了问题，所以最后我只是使用 Windows 的*程序和功能*来卸载它，然后一切都很好。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-09-02T00:41:56.283

如果使用 Visual Studio 2019 并尝试构建 .NET 3.5 项目，这将有所帮助。

Visual Studio 服务包和较新的 Visual Studio 2019 将一个程序（通常是 WebDeploy）放在 Program Files 中，并将此文件夹放在您机器的程序集探测路径的高位（因此 net45 JSON.NET 程序集在任何其他程序集之前被拾取）。

要弄清楚您的问题是从哪里解决的，只需使用 SysInternals Process Monitor 并过滤引用的 DLL。然后开始你的构建。Process Monitor 会告诉你它从哪里解析该程序集，它通常是 VS2019 安装的 WebDeploy 文件夹中的那个。如果您不使用 WebDeploy 工具，您可以清除该文件夹。

具体来说，就我而言，我删除`C:\Program Files\IIS\Microsoft Web Deploy V3\Newtonsoft.Json.dll`并且我的构建工作。

# android - 当我在其上放置长文本时，按钮向下移动

> ID：10906638
> 
> 赞同：5
> 
> 时间：2012-06-06T00:02:31.103
> 
> 标签：android, button

我可以解释它，但我认为一张图片比文字更能解释我的问题：

![例子](../Images/e0230c4b1fd5589c59e388f0498318fb.png)

这是我的布局。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >

<include
    android:id="@+id/include1"
    android:layout_width="fill_parent"
    android:layout_height="0dp"
    android:layout_weight="1"
    layout="@layout/action_bar" />

<ScrollView
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_gravity="top"
    android:padding="8dip" >

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" >

        <TableRow
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_gravity="center" >

            <Button
                android:id="@+id/button1"
                android:layout_width="150dip"
                android:layout_height="150dip"
                android:text="This is a short text" />

            <Button
                android:id="@+id/button2"
                android:layout_width="150dip"
                android:layout_height="150dip"
                android:text="This is a long text to show how the button is moved when it has a long text on it" />
        </TableRow>

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" >

            <Button
                android:id="@+id/button3"
                android:layout_width="150dip"
                android:layout_height="150dip"
                android:text="Button" />

            <Button
                android:id="@+id/button4"
                android:layout_width="150dip"
                android:layout_height="150dip"
                android:text="Button" />
        </LinearLayout>
    </LinearLayout>
</ScrollView> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-24T07:11:23.977

我遇到过同样的问题。原因是，默认值为[`baselineAligned`](http://developer.android.com/reference/android/widget/LinearLayout.html#attr_android:baselineAligned)，`true`因此按钮被向下移动以使文本位于同一基线上。将 LinearLayout 上的值设置为`false`解决问题。

```
android:baselineAligned="false" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T00:06:54.097

如果文本太长，您的理想情况是什么？

尝试添加：

```
android:maxLines:"1" 
```

到按钮。

**编辑：**我不知道究竟是什么导致了您看到的问题，但这里有一种更简单的方法来构建您的布局，似乎可以解决您在我的设备上运行时遇到的问题。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >

<ScrollView
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_gravity="top"
    android:padding="8dip" >

    <RelativeLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" >

            <Button
                android:id="@+id/button1"
                android:layout_width="150dip"
                android:layout_height="150dip"
                android:text="This is a short text" />

            <Button
                android:id="@+id/button2"
                android:layout_width="150dip"
                android:layout_height="150dip"
                android:text="This is a long text to show how the button is moved when it has a long text on it" 
                android:layout_toRightOf="@id/button1"/>

            <Button
                android:id="@+id/button3"
                android:layout_width="150dip"
                android:layout_height="150dip"
                android:text="Button" 
                android:layout_below="@id/button1"/>

            <Button
                android:id="@+id/button4"
                android:layout_width="150dip"
                android:layout_height="150dip"
                android:text="Button" 
                android:layout_below="@id/button1"
                android:layout_toRightOf="@id/button1"/>

    </RelativeLayout>
</ScrollView>

</LinearLayout> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T00:17:49.403

试试这个：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >

<include 
android:id="@+id/include1" 
android:layout_width="fill_parent" 
android:layout_height="0dp" 
android:layout_weight="1" 
layout="@layout/action_bar" /> 

<ScrollView
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_gravity="top"
    android:padding="8dip" >

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" >

        <TableRow
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_gravity="center" >

            <RelativeLayout >

                <Button
                    android:id="@+id/button1"
                    android:layout_width="150dip"
                    android:layout_height="150dip"
                    android:text="This is a short text" />

                <Button
                    android:id="@+id/button2"
                    android:layout_width="150dip"
                    android:layout_height="150dip"
                    android:layout_toRightOf="@id/button1"
                    android:text="This is a long text to show how the button is moved when it has a long text on it" />
            </RelativeLayout>
        </TableRow>

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" >

            <Button
                android:id="@+id/button3"
                android:layout_width="150dip"
                android:layout_height="150dip"
                android:text="Button" />

            <Button
                android:id="@+id/button4"
                android:layout_width="150dip"
                android:layout_height="150dip"
                android:text="Button" />
        </LinearLayout>
    </LinearLayout>
</ScrollView> 
```

添加`</LinearLayout>`最后一行。它没有显示在代码中。它必须工作......

# android - 我试图弄清楚为什么当我的应用程序从 onCreate 转换到 onResume 时会收到 NullPointerException

> ID：10906643
> 
> 赞同：2
> 
> 时间：2012-06-06T00:03:04.183
> 
> 标签：android, onresume

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    BluetoothManager btManager = new BluetoothManager(this);
    setContentView(R.layout.main);

    if (!btManager.isEnabled()) {
        btManager.requestBluetoothEnable();
        discoveryStarted = false;

    } else {
        if (btManager.isDeviceSetNullOrEmpty()) {
            btManager.startDiscovery();
            discoveryStarted = true;
        }

    }

}

@Override
public void onResume(){
    super.onResume();

    if( btManager.isEnabled() && discoveryStarted == false ){ 
```

即使我初始化了我的 btManager 类（几个蓝牙类的包装器），我也在这里得到一个 NullPointer 异常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T00:14:42.003

```
BluetoothManager btManager = new BluetoothManager(this); 
```

仅在 onCreate 中本地声明。

尝试将`BlueToothManager btManager;`其作为类范围的字段（就在类声明下方）。然后，在 oncreate 内部：

```
btManager = new BluetoothManager(this); 
```

然后，看看你是否可以在没有 onResume 中的空指针的情况下访问它！

# javascript - 如何设置离线环境来测试我的 Google App Engine 聊天室？

> ID：10906647
> 
> 赞同：0
> 
> 时间：2012-06-06T00:03:18.147
> 
> 标签：javascript, google-app-engine, offline

我将使用通道 API，它将消息路由到 javascript 客户端。

我如何为此设置 GAE SDK，以及如何创建一个可以与 GAE 脱机工作的 JavaScript 客户端？

旁注：我使用的是 Ubuntu。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T02:25:32.533

你知道如何使用 GAE 并使用它的 SDK 吗？
如果是，那么只需阅读[此处](https://developers.google.com/appengine/docs/python/channel/overview)的 Channel API 概述，它包含您开始所需的一切。
如果没有那么你应该阅读 GAE 入门指南
[for python 2.5](https://developers.google.com/appengine/docs/python/gettingstarted)
[for python 2.7](https://developers.google.com/appengine/docs/python/gettingstartedpython27)
其实 Channel API 不需要设置什么特别的东西，它离线工作得很好，它使用普通的轮询机制来模拟服务（真正的不使用轮询），但你当然必须知道如何使用 SDK。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T00:15:16.870

关于 Channel API 的 Google App Engine 教程，位于[http://googcloudlabs.appspot.com/codelabexercise4.html](http://googcloudlabs.appspot.com/codelabexercise4.html)。这可能会有所帮助。

# ruby-on-rails - 在没有表单助手的情况下在 Rails 中提交

> ID：10906651
> 
> 赞同：0
> 
> 时间：2012-06-06T00:03:33.570
> 
> 标签：ruby-on-rails

我是 Rails 新手，仍然通过 railstutorial 学习绳索，但本书通过表单提交 (http://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html) 对数据库进行了所有更改。但是如果没有这个，我将如何提交（更新数据库），假设我想添加一些在页面上计算的分数，（例如通过 js 计数器 - 为简单起见，我们只说它是一个常数 10）和我的数据库由一个名为 score 的列组成。然后按下提交按钮后，我将如何更新数据库？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T00:22:14.140

两种简单的方法：

*   使用表格
*   使用带有链接的 URL 参数

Rails 端的处理（GET v. POST 除外）是相同的——它只是一个参数。

但是，如果您使用 JavaScript，则不一定有理由*不*使用表单，因为您只需更新表单输入元素并正常提交即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T00:29:54.283

实际上，这很简单。

1.  常量 10 是从视图提交的。提交需要指向将处理此请求的控制器操作。所以提交按钮应该使用`:controller`, `:action`,`:id`参数构建 url。在一个表单中，这是在`form_for`声明中处理的。您将在`button_tag`声明中处理。

2.  应该配置路由，以便此消息可以到达控制器/操作。

3.  常量 10 在 params 散列中传输。如果该字段是 my_counter，则查找`params[:my_counter]`. 如果表单是针对模型的，比如推文，那么它可能是`params[:tweet][:my_counter]`.

4.  在控制器操作中，可能是更新，您将首先获取要更改的记录，例如`@score = Score.find(:params[:id])`. 这`params[:id]`也来自提交的视图。在此处更改计数器，然后保存。

    ```
    def update
      @score = Score.find(:params[:id])
      @score.counter = params[:my_counter]
      @score.save
      redirect_to :action => :index  # or wherever
    end 
    ```

祝你好运。

# mobile - 可以替换速度慢且不符合 HTML5 的 Adob e 的 Air WebKit v6531.9 (Webview)？

> ID：10906652
> 
> 赞同：2
> 
> 时间：2012-06-06T00:04:00.717
> 
> 标签：mobile, air, webkit, flash-builder, upgrade

我正在使用 Flex Builder 开发一个移动应用程序。某些部分是使用主机上可用的 webkit 版本的 webview。但是 Adob​​e AIR 版本的 webkit 很慢（真的很慢），并且不支持 window.localStorage 等所有 HTML5 功能。加载的网页在任何其他浏览器中运行良好且快速。

这不是测试应用程序的理想情况。我不想每次都在我的移动设备上调试它，因为一次又一次地将应用程序（以及其他一些问题）部署到设备上需要更长的时间。

我的问题是：我可以将 adobe 的 AIR webkit 的版本更新/更改/替换为较新的版本吗？资源 (webkit.dll) 位于：

```
C:\Program Files\Adobe\Adobe Flash Builder 4.6\sdks\4.6.0\runtimes\air\win\Adobe AIR\Versions\1.0\Resources 
```

我有最新版本的 AIR 和 Flash Builder (4.6)，所以不要告诉我升级。

是否有“技巧”来做到这一点（例如用高级/更新的替换 WebKit.dll）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T09:54:32.450

[以下](http://stlab.adobe.com:8080/@md=d&cd=//compliance/air_3_3/&c=M52@//compliance/air_3_3/WebKit/?ac=83)是 Adob​​e WebKit 的最新资源。但是有些文件不存在。我现在正在尝试构建它。您可以使用 p4web 客户端下载源代码（请发邮件给我 dima@kurilo.su 了解详细信息）。
UPD：我[在这里](http://www.kurilo.su/webkit/webkit.7z)上传了我的资源。您应将其解压到 C:\Distrib\webkit，然后在 Visual Studio 2008 中打开 C:\Distrib\webkit\adobe\compliance\air_3_3\WebKit\WebKit\WebKit.apolloproj\win\WebKit.air.vc2008.sln来自 air 3.3 的旧版 WebKit。我希望，有可能 - 升级它。我准备好帮忙了。

# ember.js - 为什么 ember-data 没有加载我的装置？

> ID：10906655
> 
> 赞同：1
> 
> 时间：2012-06-06T00:04:20.837
> 
> 标签：ember.js, ember-data

除了任意用户数据（想想书签）之外，我的 Ember 应用程序还基于大量常见数据（想想教科书）。我打算从固定装置加载公共数据，为此我创建了两个数据存储，一个使用 ember-data 的 REST 适配器（用于用户数据），另一个使用固定装置适配器（用于公共数据）。

但是，fixture 适配器没有加载fixture 数据。[这个 jsfiddle](http://jsfiddle.net/pjmorse/65eRS/)是我想要做的事情的最小化：它定义了一个应用程序、一个模型、该模型上的固定装置、使用固定装置适配器的商店，然后是一个获取（或尝试获取）其内容的控制器从商店。但它得到......什么都没有。我究竟做错了什么？

```
Sylvius = Ember.Application.create();

Sylvius.Section = DS.Model.extend({
  // e.g. Surface, Sectional, Pathways, Visual Glossary
  title: DS.attr('string')
});

Sylvius.Section.FIXTURES = [{
  "id": 1,
  "title": "Surface Anatomy"
}, {
  "id": 2,
  "title": "Sectional Anatomy"
}, {
  "id": 3,
  "title": "Pathways"
}, {
  "id": 4,
  "title": "Visual Glossary"
}];

Sylvius.fixtureStore = DS.Store.create({
  revision: 4,
  adapter: DS.fixtureAdapter
});

Sylvius.sectionController = Em.ArrayController.create({
    content: Sylvius.fixtureStore.findAll(Sylvius.Section); 
}); 
```

​</p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T05:54:52.980

似乎问题出`semicolon`在`Sylvius.sectionController`s 的`content`定义中。如果删除它，它会起作用，请参阅[http://jsfiddle.net/pangratz666/Kpdqd/](http://jsfiddle.net/pangratz666/Kpdqd/)：

```
...

Sylvius.sectionController = Em.ArrayController.create({
    content: Sylvius.fixtureStore.findAll(Sylvius.Section)
}); 
```

# numbers - Crystal 报告 2008 Mod / 十进制数的余数

> ID：10906656
> 
> 赞同：2
> 
> 时间：2012-06-06T00:04:30.610
> 
> 标签：numbers, decimal, modulo

我对此进行了很多搜索，但仍然不够幸运。

我了解默认情况下，Crystal Reports 中的 MOD / REMAINDER 函数适用于整数。

将十进制数除以整数的余数的出路是什么？

示例：2.454 mod 1，我必须得到 0.454 作为余数。

结果的舍入设置为 .00001。

谢谢大家！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-10T15:39:12.607

在 mod 运算符中。*(x mod y)*，如果 x 和/或 y 是小数，则在进行模运算之前对其进行舍入。

使用`Remainder(num, denom)`功能

请参阅有关剩余函数的帮助

# php - plupload Firefox 上传速度比其他浏览器快

> ID：10906663
> 
> 赞同：1
> 
> 时间：2012-06-06T00:05:33.573
> 
> 标签：php, html, plupload

我刚刚在我的服务器上安装了 plupload 来测试它，它很有效！喜欢它，我只是想知道为什么在 Firefox 中上传速度要快得多，但在 chrome、IE、safari 中却没有那么快？这是在 Windows 7 64Bit 我的配置是：

```
 runtimes: 'html5,silverlight,flash',
    browse_button: 'pickfiles',
    container: 'uploader',
    url: 'upload.php',
    chunk_size: '1mb',
    flash_swf_url : 'js/plupload.flash.swf',
    silverlight_xap_url : 'js/plupload.silverlight.xap', 
```

如果有人能给我一个答案，那就太好了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T04:21:58.297

显然，FF 和 Chrome 的速度是一样的，实际上，chrome 的速度要快一些。当我进行测试时，我让两个浏览器同时运行。不确定这是否正确，但是当两者同时运行时，Firefox 似乎优先考虑内存并且比 chrome 运行上传速度更快。

当我使用计时器单独运行测试时，Chrome 实际上比 Firefox 表现更好，希望这会有所帮助。

# javascript - 如何使用 Javascript 来填充来自输入文本框的输入的 div？

> ID：10906666
> 
> 赞同：1
> 
> 时间：2012-06-06T00:06:20.143
> 
> 标签：javascript, html, input

我正在尝试在填充 div 的输入文本框上运行脚本。片段是这样的：

```
<input type="text" id="control" value="" />
<div id="displaydiv"></div>
<script>
document.getElementById("control").onkeydown = function() {
document.getElementById("displaydiv").innerHTML = this.value;   
}
</script> 
```

这里的问题是有一个字符的滞后，即如果我输入'a'，什么都不会出现。当我输入“b”时，前一个“a”会出现，依此类推。我试过用onkeyup替换onkeydown，还是有点卡顿。如何让 div 实时匹配输入文本框，而不会刷新页面和/或失去对输入框的关注？

感谢您的关注。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T00:12:22.103

这是因为`onkeydown`在键将其值添加到输入之前触发。改为使用`onkeyup`。它会按照你的方式工作。

**编辑：**不确定我是否错过了速度，如果你编辑了你的问题，但你看到的滞后是不可避免的。它与您将要获得的“实时”一样接近。[真的没有那么糟糕，当我在小提琴](http://jsfiddle.net/eLjKc/)中检查时不到半秒

**Edit2**：为了满足我的好奇心，我检查了 KnockoutJS 的数据绑定的性能，一个输入通过敲除更新 div 文本，另一个 div 通过你的脚本。性能是一样的。实际上，我有点惊讶淘汰赛没有引入任何明显的开销。这是[小提琴](http://jsfiddle.net/9JN2z/)

# .net - 从 VBA 调用第三方公共 ComVisible .Net 方法

> ID：10906667
> 
> 赞同：0
> 
> 时间：2012-06-06T00:06:32.857
> 
> 标签：.net, com

我需要从第三方 .Net 程序集中调用一个方法。我想要的对象是公共的，并标有 ComVisible 属性。我想要的方法是公开的，但需要一个 IRibbonControl 。所以：

```
[ComVisible(true)]
public class CustomUI : IRibbonExtensibility 
```

......

```
public void SaveAs(IRibbonControl control); 
```

这是否可能，例如通过 VBA 中的 CreateObject？我需要在 VBA 中创建一个 IRibbonControl，对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T01:28:44.337

我知道这并不能直接回答您的问题，但是如果您使用 DispIds 设置您的界面并正确地对其重新充气，您“应该”能够在 VBA 中使用它。我通常在机器上使用 VBScript 测试来测试我的 COM 暴露对象。

[在 VB6 代码中处理 VB.NET 事件](https://stackoverflow.com/questions/851501/handling-vb-net-events-in-vb6-code/1010085#1010085)

显然这是 VB.NET 代码，但属性等只是 C# 的一种稍微不同的格式。（如果您在这方面需要更多帮助，请告诉我）

您能否在注册表中正确看到对象注册（搜索对 dll 的引用或查找它的类名）。

确保您注册 DLL`regasm "path to dll" /codebase /tlb`如果您不注册 TLB，我认为 VBA 将无法找到该对象。

从 VBScript`set myobj = CreateObject("FULLREFERENCE.CLASSNAME")`开始，您需要进行试验，直到获得确切的名称。

然后在您的 VBA 代码中，根据您的注册方式添加对 tlb/dll 的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T20:08:34.437

```
Dim var As Office.IRibbonControl
Set var = New Office.IRibbonControl 
```

将创建一个 IRibbonControl 对象

你可能想看看：[http ://www.xtremevbtalk.com/showthread.php?t=265636&highlight=iribboncontrol](http://www.xtremevbtalk.com/showthread.php?t=265636&highlight=iribboncontrol)

# css - 为什么列表在div中没有 设置为斜体

> ID：10906672
> 
> 赞同：0
> 
> 时间：2012-06-06T00:07:05.573
> 
> 标签：css

我想知道是否有人可以告诉我为什么列表没有设置为斜体作为 div 中的一个类？

```
<style type="text/css">
body{
font:62.5% Arial, Helvetica, sans-serif;
}
h1{
font:small-caps 1.6em "Times New Roman", Times, serif;
}
.recipe .intro{
font:italic 1em Arial, Helvetica, sans-serif;
}
</style>
</head>

<body>
<h1>Recipes for Cheese</h1>

<p class="intro">Cheese is a remarkably versatile food, available in literally hundreds of         varieties with different flavors and textures.</p>

<div class="recipe">

<h2>Welsh Rarebit</h2>

<p class="intro">Cheese is a remarkably versatile food, availalbe in literally hundreds of varieties with different flavors and textures.</p>

<ol>
<li>Lightly toast the bread</li>
<li>Place on a baking tray, and spread with butter.</li>
<li>Add the grated Cheddar cheese and 2 tablespoons of beer to a saucepan. Place the saucepan over a medium heat, and stir the cheese continuously until it has melted. Add a teaspoon of wholegrain mustard and grind in a little pepper. Keep stirring.</li>
<li>When thick and smooth, pour over each piece of taost spreading it to the edges to stop the toast from burning.</li>
<li>Place under the grill for a couple of minutes or until golden brown.</li>
</ol>
</div>    
</body> 
```

订单列表不应该是斜体，因为它在类食谱中。请解释为什么不是。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T01:41:52.093

`<li>`不继承 css 类的属性`.recipe`，为了应用它，您必须执行以下操作：

```
.recipe li{
    font:italic 1em Arial, Helvetica, sans-serif;
} 
```

标签也是如此`<a>`，您必须在`.css`

[您可以查看此演示](http://jsfiddle.net/dKxyZ/1/)

[如果您想获取更多信息，请查看此文档](https://developer.mozilla.org/en/CSS/font)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T00:11:08.463

只有`.recipe .intro`（您的段落标签）已`font:italic 1em Arial, Helvetica, sans-serif;`应用。要让所有人都`.recipe`拥有该字体，请删除`.intro`.

`.recipe .intro`说：“对于所有具有`intro`类的所有元素都是具有该类的所有元素的后代`recipe`，应用这些样式。”

# java - Java Graphics2D getPixelBounds 或 getStringWidth 不适用于 drawString

> ID：10906673
> 
> 赞同：0
> 
> 时间：2012-06-06T00:07:14.403
> 
> 标签：java, graphics

我试图在图像的中心放置两个单词。但是 drawString 方法似乎没有正确拾取“x”坐标。例如，我试图放置单词“setupa”和“asetup”（图像宽度 30）。我的图像宽度是 106，因此两种情况下的 x-cord 值都是 38。但实际上，setup 是 1-2 像素偏移的地方。

它产生的差异很小，但这显示在我的图像中。

示例代码如下。

```
 Graphics2D textGraphics;
    textGraphics = image.createGraphics();
    textGraphics.setColor(fontColor);

    textGraphics.setFont(font);
    FontRenderContext frc = new FontRenderContext(null, true, true);

    TextLayout layout = new TextLayout(label, font, frc);
    Rectangle r = layout.getPixelBounds(frc, 0, 0);
    textGraphics.drawString(label, ((imageWidth / 2) - (r.width/2)), (imageWidth / 2)); 
```

他们有办法解决这个问题吗？或将文本置于中心的更好方法。

谢谢

# windows - 如何告诉 Windows 更喜欢 UnxUtils 中的 find.exe 而不是 Windows 的 find？

> ID：10906675
> 
> 赞同：2
> 
> 时间：2012-06-06T00:07:35.237
> 
> 标签：windows, windows-7

我在 Windows 7 上安装了 UnxUtils。但是当我尝试`find`在 cmd.exe 中使用时，系统 32/ 中的 Windows 的 find.exe 是被调用的。如何告诉 Windows 更喜欢 UnxUtils 中的 find.exe 而不是 Windows 的 find？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T00:24:03.253

您可以通过将可执行文件的引用添加到“路径”系统变量来完成此操作。

1) 右键单击​​开始菜单中的“计算机”。

2）选择“属性”

3) 点击“高级系统设置”

4）点击“环境变量”

5）选择“路径”系统变量

6) 点击“编辑”

7) 将 UnxUtils bin 目录的路径添加到路径的开头：

即：**C:\UnxUtils\bin；**C:\Program Files\Common Files\Microsoft Shared\Windows Live;C:\Program Files (x86)\Common Files\Microsoft Shared\Windows... **（不要复制和粘贴）**

8）确定并退出提示。

现在在新的和后续的命令提示符中，应该首先选择 UnxUtils 可执行文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-14T02:24:10.650

我认为将 system32 的任何内容放入您的全局 PATH 中并不是一个好主意。在特定的 shell 环境（点文件或 powershell 配置文件）中会很好，但不是用户级或计算机级全局路径。

另一种选择是使用批处理文件或 shell 别名。将 *nx 别名`find`为`f`. 这是在DOS/CMD`sal`中的 powershell中。`doskey`无论外壳如何，别名都将在 PATH 扩展之前解析。

如果您使用的是 UnxUtils 之类的东西，我建议您查看 powershell profile.ps1。或者在你最喜欢的 shell，甚至是 CMD.exe 中创建一个等效的“启动”脚本。

C:\Users\bob\Documents\WindowsPowershell\profile.ps1

```
sal f C:\UnxUtils\bin\find.exe             # terse
Set-Alias find2 C:\UnxUtils\bin\find.exe   # verbose 
```

# python - pexpect 中的文件写入命令的行为不像我想象的那样

> ID：10906677
> 
> 赞同：3
> 
> 时间：2012-06-06T00:07:50.523
> 
> 标签：python, linux, command-line, pexpect

我可以从命令行运行一个进程，它将数据连续写入文件，直到我告诉它停止，并且可以在进程运行时访问（读取）。

但是，如果我通过 pexpect 运行相同的命令，文件将保持为空（尽管可以读取），直到我停止 pexpect 实例。只有这样，文件才会填满数据。

这只是 pexpect 的一个功能还是我在这里做错了什么？

pexpect 命令：

```
child = pexpect.spawn('airodump-ng', ['-a', '-w', '/root/Desktop/TEST', '--output-format', 'csv', INTERFACE]) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T05:21:33.370

我从未使用过`airodump-ng`；如果它是一项“一劳永逸”的练习（无交互），您应该将其`pexpect.run()`用于非交互任务，例如`ls -la`

```
results = pexpect.run('ls -la') 
```

如果您需要交互，只需将您的参数放在一个字符串中......

```
child = pexpect.spawn('airodump-ng -a -w /root/Desktop/TEST --output-format csv %s' % INTERFACE) 
```

# objective-c - 将 Xcode 项目转换为 ARC 时出现问题

> ID：10906680
> 
> 赞同：0
> 
> 时间：2012-06-06T00:08:35.603
> 
> 标签：objective-c, ios, xcode, automatic-ref-counting

对于以下代码片段，我收到以下警告：“将保留的对象分配给不安全的属性；对象将在分配后被释放”。有人可以帮我解决这个问题吗？我设置 detailViewController.restaurantsSortedByDistance 的第二行是警告突出显示的部分.....

```
**   RestaurantList.h **
    @property (nonatomic) NSMutableArray *restaurantsSortedByDistance;

**         end        **

 RestaurantList *detailViewController = [[RestaurantList alloc] initWithNibName:@"RestaurantList" bundle:nil];

        detailViewController.restaurantsSortedByDistance = [[NSMutableArray alloc] initWithArray:[self returnRestaurantsSortedByDistance:rows]]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T00:14:22.470

在您的**detailViewController** .h 中，将您的**restaurantSortedByDistance**属性设置为 strong。

# php - 如何使用 PHP 验证动态表单？

> ID：10906681
> 
> 赞同：0
> 
> 时间：2012-06-06T00:08:57.683
> 
> 标签：php, javascript, jquery, forms, validation

我已经搜索了很长一段时间，所以如果提出并回答了类似的问题，我深表歉意，但我不相信有。

我正在使用 PHP 验证脚本和 jQuery Validate 来处理我网站上的所有表单。使用已知字段，没有问题。但是，有些页面用户可以输入额外的人员信息。

要求用户在表格中输入其家庭成员的姓名。用户可以提交表单或选择向表单添加其他家庭成员。我还没有完全弄清楚如何正确地循环遍历所有字段并根据用户在 jQuery 中的输入显示独特的消息，但我知道我可以使用元数据和验证插件来做到这一点。

我的问题在于 PHP。我可以获取每个数组并通过 foreach 循环运行，但是，如果在 ANY 字段中发现错误，则会生成错误并再次显示表单，其中包含所有字段先前输入的数据。我无法确定如何将每个字段的原始数据指向它，因为这些字段是在出现错误时动态构建的。

我能想出的最简单的演示方法是：

> 用户必须输入他希望他的朋友吃的馅饼的百分比。他必须把他的馅饼 100% 拿出来。用户可以选择动态地将朋友添加到他的派吃盛宴中，但每个人必须获得至少 1% 的派，并且他们必须一起吃掉 100%。

[**示例代码**](http://jsfiddle.net/TkDtd/2/)

我在这里创建了一个示例脚本，它显示了表单设置，但显然没有要测试的 PHP 后端。您将需要发挥您的想象力后端工作（我已添加到 html 中的评论中）。同样的原则也适用于 PHP SESSION 变量，因为该数据需要从一个页面传递到另一个页面（如果用户重新访问该页面，应显示为每个饼图输入的金额）。另外，我认为这是不言而喻的，但这些数据**必须在**服务器端进行验证。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T00:14:40.573

如果发生 PHP 错误，您不会重新加载页面吗？在这种情况下，您知道 foreach 循环中错误的索引，保存到某个变量 - 很可能是一个处理多个错误的数组。当您将选项打印出来并再次遍历提交的数组时，当您达到错误数组中的计数时，您是否可以不向文本框添加额外的 css 类。

# ruby-on-rails - 部分未应用 jQuery Mobile (Rails)

> ID：10906683
> 
> 赞同：0
> 
> 时间：2012-06-06T00:09:05.907
> 
> 标签：ruby-on-rails, jquery-mobile

尝试实现一个简单的滑块菜单。jQuery Mobile 在主页上呈现良好，但在菜单 div 上，没有应用 jQuery Mobile。阅读所有相关示例，但没有一个可以解决我遇到的问题。非常感谢任何反馈。

test.html.erb

```
<head>
<title>FB Style Menu</title>
<meta id="extViewportMeta" name="viewport" content="width=device-width, initial-     scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black" />
<link rel="stylesheet" href="css/jquery.mobile-1.0rc2.min.css" />
<link rel="stylesheet" href="css/main.css?v=31" />
<script type="text/javascript" src="js/jquery-1.6.4.min.js"></script>
<script type="text/javascript" src="js/jquery.mobile-1.0rc2.min.js"></script>
<script type="text/javascript" src="test.js"></script>
</head> 

<div data-role="page" class="pages" id="home">
<div data-role="header">
    <a href="#"class="showMenu">Menu</a>
    <h1>FB Style Menu</h1>
</div><!-- /header -->

<div data-role="content">
    <p><strong>Note: You can swipe right/left to show/close menu.</strong></p>
</div>
</div>

<div id = "menu">
<h3>Menu</h3>
<ul>
    <li class="active"><a href="#home" class="contentLink">Home </a></li>
    <li><a href="#home" data-role = "button" class="contentLink">About </a></li>
    <li><a href="#home" class="contentLink">Portfolio </a></li>
    <li><a href="#home" class="contentLink">Contact </a></li>

</ul>
</div> 
```

测试.js

```
$(function(){
var menuStatus;

$("a.showMenu").click(function(){
    if(menuStatus != true){
    $(".ui-page-active").animate({
        marginLeft: "250px",
      }, 300, function(){menuStatus = true});
      return false;
      } else {
        $(".ui-page-active").animate({
        marginLeft: "0px",
      }, 300, function(){menuStatus = false});
        return false;
      }
});

$('.pages').live("swipeleft", function(){
    if (menuStatus){
    $(".ui-page-active").animate({
        marginLeft: "0px",
      }, 300, function(){menuStatus = false});
      }
});

$('.pages').live("swiperight", function(){
    if (!menuStatus){
    $(".ui-page-active").animate({
        marginLeft: "165px",
      }, 300, function(){menuStatus = true});
      }
});

$("#menu li a").click(function(){
    var p = $(this).parent();
    if($(p).hasClass('active')){
        $("#menu li").removeClass('active');
    } else {
        $("#menu li").removeClass('active');
        $(p).addClass('active');
    }
});

}); 
```

应用程序.html.erb

```
<!DOCTYPE html>
<html>
<head>
  <title>fuseGap</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
    <script type="text/javascript">if (window.location.hash == '#_=_')window.location.hash = '';</script>
    <link rel="stylesheet" href="arc2theme.css" />
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.0/jquery.mobile.structure-1.1.0.min.css" />
<script src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
<script src="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.js"></script>
    <script src="http://connect.facebook.net/en_US/all.js"></script>
  <%= stylesheet_link_tag    "application", :media => "all" %>
  <%= javascript_include_tag "application" %>
  <%= csrf_meta_tags %>

</head>
<body>
<%= yield %>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T06:59:12.663

您不需要将 var p 放在 jQuery 选择器语法中。

p.hasClass(....

应该够好了。

关于移动设备，我相信 jQuery mobile 会寻找带有 data-role = page 的 div，而您的菜单 div 不在此范围内。

尝试将 data-role = page 添加到您的菜单 div 。

# javascript - 使用 python 学习“现代”网络架构模式的资源？

> ID：10906685
> 
> 赞同：0
> 
> 时间：2012-06-06T00:09:20.053
> 
> 标签：javascript, json, web-applications

我听说一种现代方法是使用 JavaScript/JavaScript 模板前端呈现的 JSON 发射后端。我很想了解更多关于这种架构模式以及其他现代 Web 架构模式的信息。有什么好的资源呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T00:42:06.030

我记得 Google IO 的一篇：使用 Google App Engine、Google Closure Library 和 Clojure 编写 HTML5 应用程序

[http://www.slideshare.net/smartrevolution/writing-html5-apps-with-google-app-engine-google-closure-library-and-clojure](http://www.slideshare.net/smartrevolution/writing-html5-apps-with-google-app-engine-google-closure-library-and-clojure)

# css - 具有绝对定位的复杂布局

> ID：10906687
> 
> 赞同：0
> 
> 时间：2012-06-06T00:09:41.217
> 
> 标签：css, css-position

我必须制作一个具有这种布局的网站： ![在此处输入图像描述](../Images/20ce6b1c3b9e583abbaa28256b7fa6f2.png)

有 4 个块：绿色（页脚）、蓝色（侧边栏）、红色（主容器）和橙色（内容）。

我发现使元素居中存在一些困难。红色块有固定的宽度和高度 (980x680) ，侧边栏和页脚应该保留在它们的位置，如果我有更大的屏幕，它们仍然必须填充全宽和全高。

你认为有可能实现这个结果吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T01:31:11.013

像这样的东西怎么样：[http ://www.sidekick.com.au/files/stackoverflow/div-positioning/](http://www.sidekick.com.au/files/stackoverflow/div-positioning/)

蓝色边栏的高度是唯一需要工作的东西。目前它被设置为一个静态高度，或者它里面的任何东西的高度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T01:14:14.290

你可以试试这个... [http://pixelsvsbytes.com/blog/2012/02/this-css-layout-grid-is-no-holy-grail/](http://pixelsvsbytes.com/blog/2012/02/this-css-layout-grid-is-no-holy-grail/)或者这个[http://www.davidjrush.com /blog/2009/01/css-sticky-footer/](http://www.davidjrush.com/blog/2009/01/css-sticky-footer/)

# python - App Engine if elif else 致力于开发而不是生产

> ID：10906696
> 
> 赞同：0
> 
> 时间：2012-06-06T00:10:29.057
> 
> 标签：python, google-app-engine, python-2.7

当我运行以下代码时

```
user = users.get_current_user()
if users.is_current_user_admin():
    loggedin = 'Admin'
elif user:
    loggedin = 'User'
else:
    loggedin = 'Anonymous' 
```

在开发环境中，当我以管理员身份登录时获得管理员，以用户身份登录，在未登录时获得匿名。在生产环境中，我总是获得匿名。为什么这不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T18:47:45.547

该问题与 if/elif/else 或 users.create_login_url() 无关。问题是当用户使用 HTTPS 和 users.create_login_url() 登录时，App Engine 无法识别在 http 请求中登录的用户。我在[这里](https://stackoverflow.com/questions/10963629/app-engine-howto-maintain-login-on-both-http-and-https-with-users-service)创建了一个新问题。我相信这与 cookie 的设置方式有关。

代码在 Dev 而不是生产环境中工作的原因是开发环境如何处理 HTTPS url，它将其重新映射到 http 并为请求提供服务，从而避免了问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T01:25:30.770

您首先需要通过 users.create_login_url() 登录

# c# - 为什么我的 AsOrdered PLINQ 查询比我的无序查询快

> ID：10906698
> 
> 赞同：6
> 
> 时间：2012-06-06T00:10:47.383
> 
> 标签：c#, .net, plinq

我写了一些基本的示例代码来熟悉 PLINQ。

我遇到了一些奇怪的事情。我不知道这是我的代码中的错误还是我对 PLINQ 的理解中的错误。

MSDN 文档指出，添加 AsOrdered() 将保留调用顺序，但可能会降低性能。

我编写了一些单元测试，并注意到文档中所述对结果集的顺序的影响。但我已经看到了对性能的反作用。

这是我的两种方法：

```
public IEnumerable<int> ParallelCalculatePrimesUpTo(int maxValue)
{
    return from number in Enumerable.Range(1, maxValue).AsParallel()
            where IsPrime(number)
            select number;
}

public IEnumerable<int> OrderedParallelCalculatePrimesUpTo(int maxValue)
{
    return from number in Enumerable.Range(1, maxValue).AsParallel().AsOrdered()
            where IsPrime(number)
            select number;
} 
```

还有我非常简单的基准

```
 [TestMethod]
    public void SimplisticBenchmark6()
    {
        var primeNumberCalculator = new PrimeNumberCalculator();

        var startTime = DateTime.Now;

        primeNumberCalculator.ParallelCalculatePrimesUpTo(10000000).ToList();

        var totalTime = DateTime.Now - startTime;

        Console.WriteLine(totalTime);
    }

    [TestMethod]
    public void SimplisticBenchmark7()
    {
        var primeNumberCalculator = new PrimeNumberCalculator();

        var startTime = DateTime.Now;

        primeNumberCalculator.OrderedParallelCalculatePrimesUpTo(10000000).ToList();

        var totalTime = DateTime.Now - startTime;

        Console.WriteLine(totalTime);
    } 
```

无论我多久运行一次这个测试，有序版本都胜过无序版本。我在四核计算机上订购的速度快了大约 4 秒。我得到大约 18 秒的有序的和 22 秒的无序的。在两天的时间里，我已经运行了数十次测试（在这两天之间重新启动）。

如果我将数字 10 000 000 降低到 6 000 000，差异仍然存在，但不太明显，如果我将其降低到 3 000 000，则速度大致相同。

我尝试按执行顺序运行测试，结果是相同的。

这是在 PLINQ 查询中调用的 IsPrime 方法：

```
// uses inneficient trial division algorithm
private bool IsPrime(int number)
{
    if (number == 1)
        return false;

    for (int divisor = 2; divisor <= Math.Sqrt(number); divisor++)
    {
        if (number % divisor == 0)
            return false;
    }

    return true;
} 
```

这是什么解释？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T10:23:09.100

**您是否总是以相同的顺序运行测试？**

我已经在我的机器上重新创建了您的结果，我发现无论如何，“有序”结果更快。我使用稍微修改的代码进行基准测试：

```
static void Main(string[] args)
{
    const int size = 9000000;
    BenchIt("Parallel", ParallelCalculatePrimesUpTo, size);
    BenchIt("Ordered ", OrderedParallelCalculatePrimesUpTo, size);
    Console.ReadKey();
}

public static void BenchIt(string desc, Func<int, IEnumerable<int>> myFunc, int size)
{
    var sw = new Stopwatch();            
    sw.Restart();
    myFunc.Invoke(size).ToList();
    sw.Stop();
    Console.WriteLine("{0} {1}",desc, sw.Elapsed);
} 
```

我的结果表明，最初，你是对的。有序方法更快。但是，如果我交换了调用的顺序，我发现无序的方法更快。换句话说，无论哪一秒都更快。大概是因为任务并行库正在做的线程池管理。

但是 - 我的机器上两者之间的差异非常小。远不及你看到的差异量。

**你的硬件是什么样的？**

PLINQ 会猜测如何以最快的速度执行。我不知道在这种情况下这是否会直接帮助您；但是您可能想在 IsPrime 的中间设置一个断点并在几百次迭代后停止并检查线程窗口。

`ParallelCalculatedPrimesUpTo`执行verse时有多少个线程`OrderedParallelCalculatePrimesUpTo`？我到了这里；但它可能会决定您机器上的不同值，从而产生您所看到的意外时间。在我的机器上 - 我每次都有八个线程 - 但我的时间几乎相同 - 由于这些线程的创建，首先调用的线程会更慢。但是您不能保证特定数量的线程（您可以设置最大值，但不能强制使用它们）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T02:58:45.510

您能告诉我们 4 个不同内核的 CPU 利用率是多少吗？AsOrdered() 可能会迫使更多的顺序调用发生在同一个核心上。随着局部性的提高，硅级缓存和分支预测可能对您有利。

另一种可能性是 .NET 框架在使用 AsOrdered() 投影时针对单调递增整数 (int.Range) 的情况进行了一些优化。我不确定这将如何工作，但这是可能的。

一个有趣的比较测试是以随机顺序生成第三组数字（显然，您必须提前将它们随机化，然后处理三个数组）。然后看看有没有关系？

# struts2 - 将 .do URL 重定向到 .action URL？

> ID：10906701
> 
> 赞同：0
> 
> 时间：2012-06-06T00:11:59.820
> 
> 标签：struts2, struts, web.xml

我在应用程序中将 struts1 页面迁移到 struts2。但是，我仍然需要可以访问旧页面的“/login.do”URL 以实现向后兼容性。

如何将“login.do” URL 重定向/映射到“login.action”？

我相信这可以通过编写一个过滤器类来完成，但我不想这样做，因为它对于这项任务来说似乎太复杂了。必须有一种方法可以在 web.xml、struts.xml 或 struts-config.xml 中执行此操作。

我会给答案最好的人买啤酒（在凤凰城）。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T00:19:07.103

更改操作扩展。这是[默认`struts.properties`](http://struts.apache.org/2.x/docs/strutsproperties.html)的：

```
### Used by the DefaultActionMapper
### You may provide a comma separated list, e.g. struts.action.extension=action,jnlp,do
### The blank extension allows you to match directory listings as well as pure action names
### without interfering with static resources, which can be specified as an empty string
### prior to a comma e.g. struts.action.extension=, or struts.action.extension=x,y,z,,
struts.action.extension=action,, 
```

然而，常量的 XML 配置是首选，所以我将它放在你的`struts.xml`.

它还避免了实际的重定向，尽管对此的过滤器是微不足道的。

# php - 刷新时会话丢失

> ID：10906708
> 
> 赞同：1
> 
> 时间：2012-06-06T00:13:02.393
> 
> 标签：php, session

我最近将我的网站移到了我网站的主域。

我发现当我登录我的网站时，会显示帐户页面，但是当我刷新或进行 ajax 调用时会话丢失，将我注销。我的帐户页面上有一个 iframe，我最近刚刚安装了 SSL。

任何想法为什么我的会话正在丢失？或者有什么方法可以找到错误的类型？

我的 php 信息是：

```
session.auto_start  Off Off
session.bug_compat_42   On  On
session.bug_compat_warn On  On
session.cache_expire    180 180
session.cache_limiter   nocache nocache
session.cookie_domain   no value    no value
session.cookie_httponly Off Off
session.cookie_lifetime 0   0
session.cookie_path /   /
session.cookie_secure   Off Off 
```

当我进行错误报告时，我得到的错误是：

```
<b>Notice</b>:  Undefined index:  adminsess in <b>/home/onclick1/public_html/admin.php</b> on line <b>35</b><br />
<br />
<b>Notice</b>:  Undefined index:  secure in <b>/home/onclick1/public_html/admin.php</b> on line <b>36</b><br />
<br /> 
```

给出错误的代码很简单：

```
<?php 
session_start();
ini_set('error_reporting', E_ALL);
require "connectTo/db.php";

if(!isset($_SESSION['adminsess']) || !isset($_SESSION['secure']) ){
        //exit(); *comment out to give error*
    } 
```

我浏览了我的代码，发现错误似乎只发生在我在索引页面上添加 header() 重定向时（无法存储会话数据）。我在网站上用于重定向已登录用户的代码如下：

如果使用重定向标头..它只是循环并且不加载页面

```
<?php 
session_start();

error_reporting(E_ALL | E_WARNING | E_NOTICE);
ini_set('display_errors', TRUE);

//print_r($_SERVER);

//exit;
$TheIp=ip2long($_SERVER['REMOTE_ADDR']);
$ip= trim($TheIp);

include('mobile.php'); 
require "db.php";

$_SESSION['secureip'] = $ip;

if(isset($_SESSION['adminsess']))
    {
    $ipVistor = $ip;
    $ipVistorSalt= $ipVistor."28257esfgs";
    $ip=md5($ipVistorSalt);

    $userAgent=$_SERVER['HTTP_USER_AGENT'];
    $userAgentSalt=$userAgent."jk2hgkj22352523s";
    $agent=md5($userAgentSalt);

    if(isset($_SESSION['secure']) && $_SESSION['secure']==$ip)
    {

    if (isset($_SESSION['secure2']) && $_SESSION['secure2'] == $agent) 
    {    
        //header("Location: https://www.site.com/admin?Welcome");
        exit();
    } 
    }
    }

?> 
```

任何帮助/信息都会很棒。提前致谢 ！

* * *

即使我把它放在页面的最顶部，它也会尝试加载 index2.php 但只是不断循环......这是服务器问题吗？（index2 只是索引的副本）。

```
<?php 
header("Location: https://www.site.com/index2.php");
exit; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T00:20:51.110

尝试更改会话名称：

```
session_name("foo"); 
```

或者在运行时配置中：

```
session.name foo 
```

确保您正在调用`session_start()`并且 ajax 调用不在另一个域上。

# google-maps-api-3 - Google Maps JavaScript API v3 Places Library 使用限制

> ID：10906710
> 
> 赞同：0
> 
> 时间：2012-06-06T00:13:12.703
> 
> 标签：google-maps-api-3, google-places-api

我有一个将 Google Place 信息与用户相关联的网站，并在地图上显示该信息。例如，用户可以搜索一个地方（目前使用 Places Library Autocomplete API）并为这个地方添加书签以供以后检索。

根据 Google Maps TOS，我只将 Place ID 及其引用存储在我的数据库中，并且每当我需要在地图上显示它们时，都会对每个地方的坐标信息进行客户端请求。

我最近遇到了一个问题，即使用服务对象上的 getDetails 方法对坐标信息（在 javascript 循环内）发出超过 10 个连续的 API 请求会返回 OVER_QUERY_LIMIT 状态代码。

我的问题是：如果我正确假设在我的数据库中存储每个地方的纬度和经度违反了谷歌的 TOS，我如何以编程方式检索多个地方的坐标信息，以便我可以在地图上显示这些地方对于给定的用户？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T15:40:03.043

根据条款 - 10.1.3(b) -

(b) 不得预取、缓存或存储内容。您不得预取、缓存或存储任何内容，除非您可以存储：(i) 有限数量的内容，以提高 Maps API 实施的性能，前提是您临时、安全且在不允许在服务之外使用内容的方式；(ii) Maps API 文档明确允许您存储的任何内容标识符或密钥。例如，您不得使用内容创建独立的“地点”数据库或其他本地列表信息。

因此，如果有很多地方被查询，您可以临时存储该地方的信息以提高性能。

# vba - 如何根据需要将焦点放在文本框上

> ID：10906714
> 
> 赞同：2
> 
> 时间：2012-06-06T00:14:03.757
> 
> 标签：vba, excel, textbox, setfocus

我在用户窗体上有一个文本框。如果用户未能在此文本框中输入任何内容，我需要捕获它以强制输入。我可以很容易地做到这一点，但是在通知用户他们需要输入之后，我希望焦点返回到文本框。现在，它不这样做。这是我的代码：

```
Private Sub txtAnswer_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)

Select Case KeyCode
    Case 13:
        If Me.txtAnswer.Value = "" Then
            temp = MsgBox("You need to enter an answer!", vbCritical + vbOKOnly, "No Answer Found!")
            Me.txtAnswer.SetFocus
        Else
            recordAnswer
        End If
    End Select

End Sub 
```

此代码工作正常，如果文本框留空，则会弹出消息框。清除消息框后，如果我再次立即回车，消息框再次出现，提示焦点在文本框上。但是，如果我尝试输入一个字符（例如数字“1”），则文本框中不会出现任何内容。

任何人都可以建议我如何以允许用户输入数据的方式重新关注此文本框吗？谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-06T00:52:38.007

为什么不使用“确定”按钮来完成操作？

您不应该在用户输入表单时用消息打扰他们。最后做。

```
Private Sub OK_Click()

    '// Validate form
    If txtAnswer.Text = vbNullString Then
        MsgBox "You need to enter an answer!", vbExclamation, "No Answer Found!"
        txtAnswer.SetFocus
        Exit Sub
    End If

    '// You have reached here so form is correct carry on
    recordAnswer

End Sub 
```

如果您真的想使用您要求的行为，请尝试以下操作：

```
Private Sub txtAnswer_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)

    Select Case KeyCode
    Case 13:
        If Me.txtAnswer.Value = "" Then
            temp = MsgBox("You need to enter an answer!", vbCritical + vbOKOnly, "No Answer Found!")              
            KeyCode = 0
        Else
            recordAnswer
        End If
    End Select

End Sub 
```

问题是，在您的代码中，您正在设置焦点，但随后会触发回车键。你不需要设置焦点，因为文本框已经有了焦点，你只需要取消回车键。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-28T22:32:29.603

其他答案似乎真的很复杂。我有一个类似的问题，真的想要一个文本警告。如果输入不正确，我似乎更容易在表单上制作一个不可见的标签。我还将标签的背景设置为红色，以便用户注意到有问题。这样做可以使光标保持可见并且就在他们离开的地方。

```
Public Function amount(ByRef cont As MSForms.TextBox) As Integer
'makes sure that a number is used
'could change to account for decimals if necessary
Dim i As Long
On Error Resume Next
i = 0
If (cont.Value = "") Then Exit Function
    Do While i < 1000000
        If (cont.Value = i) Then
            UserForm1.Label257.Visible = False
            Exit Function
        End If
        i = i + 1
    Loop
UserForm1.Label257.Visible = True
amount = 1
End Function

Public Sub qty_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
If amount(UserForm1.qty) = 1 Then
    Cancel = True
End If
End Sub 
```

我希望这对以后遇到此问题的其他人有所帮助。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2014-07-25T12:40:48.530

看看上面的代码，我假设 i 计数器是为了让它继续运行？抱歉有点生疏，自从我完成代码以来已经有几年了。

无论如何，如果是这种情况，您总是可以在 i=0 时运行它，执行（或当为真时）。

抱歉，第一次在这里发帖，希望有意义。

# python - 在python中更改二维列表中的特定元素

> ID：10906715
> 
> 赞同：1
> 
> 时间：2012-06-06T00:14:04.670
> 
> 标签：python, list

我有以下代码：

```
a=[[0]*2]*3

print a

a[1][1]=2
print a 
```

输出是：

```
[[0,0],[0,0],[0,0]]
[[0,2],[0,2],[0,2]] 
```

为什么要更改列表的所有元素？

输出不应该是：

```
[[0,0],[0,2],[0,0]] 
```

如果我只想更改其中一个元素，需要做什么？

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T00:17:31.127

当您这样做时`[0] * 2`，这会生成列表`[0, 0]`。当您将其乘以 3 时，您将创建一个包含对该列表的三个*引用*的列表。您可能想要这样做：

```
a = [[0] * 2 for _ in range(3)] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T00:17:40.473

我已经多次看到这个问题，这令人沮丧。

当你这样做时：

```
a = [[0] * 2] * 3 
```

您创建一个列表`[0, 0]`并将其引用三次传递给 form `a`。那些克隆的列表只是对原始列表对象的引用。当你修改一个时，你修改了原来的，其余的也被修改了。

解决方案非常简单：

```
a = [[0 for j in range(2)] for i in range(3)] 
```

您每次都创建一个新列表，而不是通过引用传递列表。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-06T00:18:53.807

> 为什么要更改列表的所有元素？

因为它们都是相同的元素。

> 如果我只想更改其中一个元素，需要做什么？

您需要创建一个包含三个**不同**实例的列表`[0, 0]`。

将列表相乘会生成一个多次引用相同事物的列表。

例如，尝试`[[0] * 2 for _ in range(3)]`.

没有问题的原因是`[0] * 2`两个元素“相同`0`”这一事实并不重要。`0`是`0`，不能改变。书写`a[0][0] = 1` **替换**了 0，但**修改**了`[0, 0]`包含那个`0`（通过替换`0`）。

# php - 获取脚本以生成 300 组随机字符

> ID：10906720
> 
> 赞同：-3
> 
> 时间：2012-06-06T00:14:53.273
> 
> 标签：php, random, execute

我想知道如何让下面的脚本生成 300 组随机字符。

这将避免我不得不按下重新加载按钮 300 次。

这是我的脚本：

```
<?php

function GetID($x){     

$characters = array("A", "B", "C", "D", "E", "F", "G", "H", "J", "K", "L", "M", "N", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z", "a", "b", "c", "d", "e", "f", "g", "h", "j", "k", "l", "m", "n", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "2", "3", "4", "5", "6", "7", "8", "9");

shuffle($characters);

for (; strlen($ReqID)<$x;){
$ReqID .= $characters[mt_rand(0, count($characters))];
}

return $ReqID;

}     

$ReqID .= GetID(5);
       $ReqID .= "-";
$ReqID .= GetID(9);
       $ReqID .= "-";
$ReqID .= GetID(5);

echo $ReqID;

$fh = fopen("300_file.txt","a+");

fwrite($fh, ("$ReqID")."\n");

fclose($fh);

?> 
```

另外，如果有办法将字符简化为数组，那将是一个额外的好处，但不是必需的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T02:05:44.110

要执行 300 循环，请使用 for，范围为 0-299 [300]：

```
for($l=0;$l<=299;$l++){
    $out[$l] = array_merge(range('A','Z'),range('a','z'),range(2,9));
} 
```

生成的数组 $out 将以 0-299 作为键，随机字符作为值。

如果要将其保存到文件中，请执行以下操作：

```
$content = implode("\n", $out); 
```

并将 $content 字符串保存到文件中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T00:19:20.913

简化你的阵列

`array_merge(range('A','Z'),range('a','z'),range(2,9))`

使用循环清洗、冲洗并重复 300 次

# javascript - 在javascript中存储动态日期

> ID：10906721
> 
> 赞同：0
> 
> 时间：2012-06-06T00:14:57.610
> 
> 标签：javascript, data-storage

如果通过 Javascript 加载特定日期，我希望存储。这个布尔值的保存/访问方式没有区别，但是我不确定最好的解决方案是性能方面的。

我可以知道我可以像这样存储它并循环遍历每个对象，但是我想这不会真正有效。 `var loaded = { {d:23, m:11, y:2012}, {d:24, m:11, y:2012} };`

我的另一个想法是将其存储在一个数组中，如下所示： `loaded[2012][11][23] = true;`

但我确信有更好的方法来实现这一点，所以我很感激任何指导

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T00:24:30.547

除非您必须列出可用年份、可用月份或可用日期，否则您始终可以使用 Object 作为字典，将日期存储为 UNIX 时间戳数字（您可以与 Date 对象相互转换）或“YYYYMMDD”字符串。

# android - 安卓下载管理器

> ID：10906725
> 
> 赞同：6
> 
> 时间：2012-06-06T00:16:03.123
> 
> 标签：android, file, path, filepath, download-manager

我想我有一个相当简单的问题。

[http://www.vogella.com/blog/2011/06/14/android-downloadmanager-example/](http://www.vogella.com/blog/2011/06/14/android-downloadmanager-example/)

我一直在关注上述网址中的教程。

如何更改下载的文件路径？

提前致谢

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-06T00:19:26.777

您可以使用此类信息配置[DownloadManager.Request对象。](http://developer.android.com/reference/android/app/DownloadManager.Request.html)在本教程中，该`Request`对象是在`onClick()`.

例如：

```
DownloadManager.Request req=new DownloadManager.Request(uri);

req.setAllowedNetworkTypes(DownloadManager.Request.NETWORK_WIFI
                               | DownloadManager.Request.NETWORK_MOBILE)
   .setAllowedOverRoaming(false)
   .setTitle("Demo")
   .setDescription("Something useful. No, really.")
   .setDestinationInExternalPublicDir(Environment.DIRECTORY_DOWNLOADS,
                                      "test.mp4"); 
```

（以上代码来自[此示例项目](https://github.com/commonsguy/cw-omnibus/tree/master/Internet/Download)）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-06T01:13:03.447

CommonsWare 答案的最后一行说明了目的地。他只是使用 sdcard 上的常规下载文件夹，但你也可以这样做：

```
req.setDestinationInExternalPublicDir("/mnt/sdcard/Myfolder", "file_name.extension"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-03-04T16:10:27.307

您确保用户允许您的应用访问外部存储。包括此代码以供下载

```
DownloadManager downloadManager = (DownloadManager) getSystemService(Context.DOWNLOAD_SERVICE);
     Uri uri = Uri.parse(url_string);
     DownloadManager.Request request = new DownloadManager.Request(uri);        
     request.setVisibleInDownloadsUi(true);        request.setNotificationVisibility(DownloadManager.Request.VISIBILITY_VISIBLE_NOTIFY_COMPLETED);
    // include this line if permission has been granted by user to external directory
     request.setDestinationInExternalPublicDir(Environment.DIRECTORY_DOWNLOADS, uri.getLastPathSegment());  
// or this line if not yet granted
request.setDestinationUri(Uri.parse("file://" + uri.getLastPathSegment());      
    Long reference = downloadManager.enqueue(request); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-01-05T10:15:26.920

您可以尝试执行以下操作：

1.  访问 URL 了解下载管理器[https://github.com/quoraboy/DownloadManagerInAndroid](https://github.com/quoraboy/DownloadManagerInAndroid)
2.  据我了解，您无法手动暂停/恢复下载。
3.  如果您取消下载，则完全取决于您的服务器是否支持暂停/恢复功能。如果是，那么在取消下载后，如果您再次开始下载，它实际上可能会恢复下载并且不会从头开始下载。

# c# - 在 C# 图表中按字符串绘制 y 轴？

> ID：10906726
> 
> 赞同：0
> 
> 时间：2012-06-06T00:16:08.700
> 
> 标签：c#, .net, string, graph, charts

我想制作一个图表，其中 x 值为 DateTimes，y 值为固定数量的静态字符串，但 C# 系列似乎不允许我这样做。

另一种解决方案是按数值绘制图形并将 y 轴标签更改为字符串，但我似乎找不到这样做的方法。

谢谢，

莱尼

# javascript - 如何将图像上传到 HTML5 画布中

> ID：10906734
> 
> 赞同：76
> 
> 时间：2012-06-06T00:17:39.917
> 
> 标签：javascript, html, html5-canvas

我目前正在使用[http://paperjs.org](http://paperjs.org)创建一个 HTML5 画布绘图应用程序。我想让用户将图像上传到画布中。我知道我需要登录和注册，但有更简单的方法吗？我看过 HTML5 拖放上传。

* * *

## 回答 #1

> 赞同：155
> 
> 时间：2012-06-06T00:53:30.480

我假设您的意思是将图像加载到画布中而不是从画布上传图像。

阅读他们在这里的所有画布文章可能是个好主意 [https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Canvas_tutorial/Using_images](https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Canvas_tutorial/Using_images)

但基本上你想要做的是在 javascript 中创建一个图像，并将 image.src = 设置为文件位置。在从用户端加载图像的情况下，您将需要使用文件系统 API。

在这里拼凑一个简单的例子：http: [//jsfiddle.net/influenztial/qy7h5/](http://jsfiddle.net/influenztial/qy7h5/)

```
function handleImage(e){
    var reader = new FileReader();
    reader.onload = function(event){
        var img = new Image();
        img.onload = function(){
            canvas.width = img.width;
            canvas.height = img.height;
            ctx.drawImage(img,0,0);
        }
        img.src = event.target.result;
    }
    reader.readAsDataURL(e.target.files[0]);     
} 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2018-08-09T07:18:47.247

不需要 FileReader*，最好使用[URL.createObjectURL](https://developer.mozilla.org/en-US/docs/Web/API/URL/createObjectURL)方法，该方法将直接创建指向磁盘上文件的符号链接。这将减少内存使用量，并具有额外的好处，即只有一个异步事件要等待（其中一个`img.onload`）。

```
document.getElementById('inp').onchange = function(e) {
  var img = new Image();
  img.onload = draw;
  img.onerror = failed;
  img.src = URL.createObjectURL(this.files[0]);
};
function draw() {
  var canvas = document.getElementById('canvas');
  canvas.width = this.width;
  canvas.height = this.height;
  var ctx = canvas.getContext('2d');
  ctx.drawImage(this, 0,0);
}
function failed() {
  console.error("The provided file couldn't be loaded as an Image media");
}
```

```
<input type="file" id="inp">
<canvas id="canvas"></canvas>
```

^(*IIRC 只有少数版本的 Chrome 支持 FileReader，但还不支持 URL.createObejctURL，因此如果您针对这些版本，您可能需要 FileReader..)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-05T01:56:44.213

通过画布创建可消耗图像的最佳方法是从您从输入中获得的文件中创建一个[ImageBitmap 。](https://developer.mozilla.org/en-US/docs/Web/API/ImageBitmap)

这将使用优化的路径来生成浏览器渲染该图像所需的内容，并将位图数据存储在 GPU 中，允许在被要求时快速绘制。

鉴于这是一个*相当*新的功能（Safari 仅在去年添加了支持），您可能想要使用像[我的这个这样](https://github.com/Kaiido/createImageBitmap)的 polyfill 。

```
document.querySelector("input").oninput = async (evt) => {
  try {
    const file = evt.target.files[0];
    const bitmap = await createImageBitmap(file);
    const canvas = document.querySelector("canvas");
    canvas.width = bitmap.width;
    canvas.height = bitmap.height;
    const ctx = canvas.getContext("2d");
    ctx.drawImage(bitmap, 0, 0);
  }
  catch(err) {
    console.error(err);
  }
};
```

```
<!-- createImageBitmap polyfill for old browsers --> <script src="https://cdn.jsdelivr.net/gh/Kaiido/createImageBitmap/dist/createImageBitmap.js"></script>
<input type="file">
<canvas></canvas>
```

* * *

## 回答 #4

> 赞同：-5
> 
> 时间：2012-11-22T14:25:20.377

```
<script>
window.onload = function() {
var canvas=document.getElementById(“drawing”); // grabs the canvas element
var context=canvas.getContext(“2d”); // returns the 2d context object
var img=new Image() //creates a variable for a new image

img.src= “images/vft.jpg” // specifies the location of the image
context.drawImage(img,20,20); // draws the image at the specified x and y location
}
</script> 
```

检查[演示](http://www.pageresource.com/html5/insert-image-in-canvas/)

# android - 扩展 Android 蓝牙可发现性

> ID：10906737
> 
> 赞同：2
> 
> 时间：2012-06-06T00:17:57.430
> 
> 标签：android, bluetooth

我正在编写一个依赖于 Android 设备的应用程序（对于我目前的测试目的，一个 HTC Evo 4G 和几个原始的摩托罗拉 Droids）可以通过蓝牙发现 300 秒。

我的目标是 Android 版本 2.0.1，所以根据 API，我应该能够提示用户启用最多 300 秒的可发现性。在我的 Droids 和我的 Evo 上，提示窗口都列出了 300 秒，但它们都在 120 秒后结束。

我用来提示用户的代码在这里：

```
private void makeDiscoverable() {
    Intent discoverableIntent = new Intent(
            BluetoothAdapter.ACTION_REQUEST_DISCOVERABLE);
    discoverableIntent.putExtra(
            BluetoothAdapter.EXTRA_DISCOVERABLE_DURATION, 300);
    startActivity(discoverableIntent);
} 
```

我确信这段代码可以运行。但是，我稍后有一个处理程序，用于处理我的可发现性状态更改（我假设在这种情况下结束），如下所示：

```
if (isDiscoverableChange(action)) {
            int discoverState = intent.getIntExtra(
                    BluetoothAdapter.EXTRA_SCAN_MODE, Short.MIN_VALUE);
            if (isDiscoverableState(discoverState)) {
                setItOrder();
                setUpScanAndDisplay();
            } else {
                discoverScheduler.cancel();
                itScheduler.cancel();
            }
        }

private boolean isDiscoverableChange(String action) {
    return BluetoothAdapter.ACTION_SCAN_MODE_CHANGED.equals(action);
}

private boolean isDiscoverableState(int state) {
    return state == BluetoothAdapter.SCAN_MODE_CONNECTABLE_DISCOVERABLE;
} 
```

我尝试注释掉可发现模式结束时运行的部分，以防它过早取消所有内容，但可发现性确实在 120 秒后结束。

这是硬件问题，还是我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T13:04:29.360

`DiscoverableTimeout`除了 Android 超时，还有蓝牙值。

通常，`DiscoverableTimeout`在文件中设置`/system/etc/bluetooth/main.conf`为 120 。

你应该写

```
DiscoverableTimeout = 0 
```

在`/system/etc/bluetooth/main.conf`禁用蓝牙超时。这将允许您将 Android 超时时间延长超过 120 秒。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T16:23:12.123

这似乎是一个错误：

问题 15486：蓝牙 Adapter.EXTRA DISCOVERABLE 未遵守 [http://code.google.com/p/android/issues/detail?id=15486](http://code.google.com/p/android/issues/detail?id=15486)

问题 13361：BluetoothAdapter.EXTRA_DISCOVERABLE_DURATION 意图额外不会延长 120 秒的发现间隔 [http://code.google.com/p/android/issues/detail?id=13361](http://code.google.com/p/android/issues/detail?id=13361)

首次报告于 2010 年 12 月 22 日，仍列为“新”状态，所以我不希望这会得到修复。

# redis - ServiceStack Redis Client中之前的排队操作尚未提交错误

> ID：10906746
> 
> 赞同：0
> 
> 时间：2012-06-06T00:18:58.513
> 
> 标签：redis, servicestack

我试图在 ServiceStack Redis Client 中为我的文章实例实现“级联”存储。只有一笔交易。QueueCommand 是一个奇怪的错误吗？为什么我得到这个错误？

```
trans.QueueCommand(p => p.IncrementValue(KeyHelper.GetAutoIncrementKey(article)),
                                   id => article.Id = id); 
```

批评线索：trans.AddRangeToSet 方法不能将 trans.CurrentQueuedOperation 设置为 NULL ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T03:14:21.783

我使用 AddRangeToSet 方法作为空字符串列表作为值。我已经发送了拉取请求。

[https://github.com/ServiceStack/ServiceStack.Redis/pull/53](https://github.com/ServiceStack/ServiceStack.Redis/pull/53)

# java - Java apache Httpclient 基于表单的登录 myspace

> ID：10906747
> 
> 赞同：1
> 
> 时间：2012-06-06T00:18:59.783
> 
> 标签：java, forms, apache, login, httpclient

因此，我尝试使用 Apache 的 HttpClient v.4 登录网站（在此示例中为 myspace），但我不确定在此过程中哪里出错了，当我测试此代码时，登录后 Cookie 与初始登录 cookie，但不应该这样。

我在网上四处查看是否有其他人尝试过，但我还没有找到适合我的好资源。

我正在使用这个例子：[apa​​che HttpClient to access facebook](https://stackoverflow.com/questions/1902013/apache-httpclient-to-access-facebook) ( Facebook)

```
 try{
        DefaultHttpClient httpclient = new DefaultHttpClient();

        HttpGet httpget = new HttpGet("http://www.myspace.com/auth/form");

        HttpResponse response = httpclient.execute(httpget);
        HttpEntity entity = response.getEntity();

        System.out.println("Login form get: " + response.getStatusLine());
        if (entity != null) {
            entity.consumeContent();
        }
        System.out.println("Initial set of cookies:");
        List<Cookie> cookies = httpclient.getCookieStore().getCookies();
        if (cookies.isEmpty()) {
            System.out.println("None");
        } else {
            for (int i = 0; i < cookies.size(); i++) {
                System.out.println("- " + cookies.get(i).toString());
            }
        }

        HttpPost httpost = new HttpPost("http://www.myspace.com/auth/form");

        List <NameValuePair> nvps = new ArrayList <NameValuePair>();
        nvps.add(new BasicNameValuePair("email", "someEmail"));
        nvps.add(new BasicNameValuePair("password", "somePassword"));

        httpost.setEntity(new UrlEncodedFormEntity(nvps, HTTP.UTF_8));

        response = httpclient.execute(httpost);
        entity = response.getEntity();
        //System.out.println("Double check we've got right page " + EntityUtils.toString(entity));

        System.out.println("Login form get: " + response.getStatusLine());
        if (entity != null) {
            entity.consumeContent();
        }

        System.out.println("Post logon cookies:");
        cookies = httpclient.getCookieStore().getCookies();
        if (cookies.isEmpty()) {
            System.out.println("None");
        } else {
            for (int i = 0; i < cookies.size(); i++) {
                System.out.println("- " + cookies.get(i).toString());
            }
        }
        httpclient.getConnectionManager().shutdown();
    }
    catch(Exception e){e.printStackTrace();} 
```

示例饼干：

```
 [version: 0][name: MSCOUNTRY][value: US][domain: .myspace.com][path: /][expiry: Tue Jun 12 23:22:15 EDT 2012]
[version: 0][name: MSCulture][value: IP=XXX.XXX.XXXX&IPCulture=en-US&PreferredCulture=en-US&PreferredCulturePending=&Country=VVM=&ForcedExpiration=0&timeZone=0&myStuffDma=&myStuffMarket=&USRLOC=RandomUserLocString==&UserFirstVisit=1][domain: .myspace.com][path: /][expiry: Tue Jun 12 23:22:15 EDT 2012]
[version: 0][name: SessionDDF2][value: RandomStringHere==][domain: .myspace.com][path: /][expiry: Sat Jun 05 23:22:15 EDT 2032] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T01:25:17.187

为什么您认为初始 cookie 和后期 cookie 应该不同？应用程序服务器端分配一组 cookie 给客户端，并且通常在整个会话期间保持不变。

应用程序服务器关联一组与会话相关的属性（使用 cookie 作为查找），这就是决定会话是否“登录”的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T23:45:41.460

这里没有提到的一件事是，为了成功打开经过身份验证的`URLConnection`文件，您需要在以下位置设置身份验证后收到的 cookie `URLConnection`：

```
 URL myUrl = new URL("http://yourdomain/your/page);

    URLConnection urlConn = myUrl.openConnection();

    for (int i = 0; i < cookies.size(); i++) {
        System.out.println("- " + cookies.get(i).toString());
        urlConn.setRequestProperty("Cookie",cookies.get(i).getName() + "=" + cookies.get(i).getValue());
    }
    urlConn.connect();

    InputStream io = (InputStream) urlConn.getContent();

    // print out the response
    List<String> readLines = IOUtils.readLines(io);

    for (String line : readLines) {
        System.out.println (line);
    } 
```

# java - JTree 通过单击行上的任意位置选择节点

> ID：10906749
> 
> 赞同：1
> 
> 时间：2012-06-06T00:19:15.603
> 
> 标签：java, swing, jtree

我[从这里获取的](http://www.coderanch.com/t/461207/GUI/java/JTree-row-selection-mouseclick)代码允许通过单击行上的任意位置来选择 JTree 行。它在单行选择模式下工作正常。但是，我不确定如何修改它以处理多行选择。如何区分用户进行多项选择时的情况（例如，在鼠标左键单击一行时按住 shift 或 control 按钮）？

```
导入 java.awt.Rectangle；
导入 java.awt.event.MouseAdapter；
导入 java.awt.event.MouseEvent；
导入 java.awt.event.MouseListener；

导入 javax.swing.JFrame；
导入 javax.swing.JTree；
导入 javax.swing.SwingUtilities；
导入 javax.swing.tree.DefaultMutableTreeNode；
导入 javax.swing.tree.TreeNode；

@SuppressWarnings("串行")
公共类 NavTree 扩展 JTree {

    私有布尔 fWholeRowSelectionEnabled；
    私有 MouseListener fRowSelectionListener；
    最终的导航树 fThis；

    公共导航树（树节点根节点）{
        超级（根节点）；
        f这=这；
        在里面（）;
    }
    公共导航树（）{
        f这=这；
        在里面（）;
    }

    私人无效初始化（）{
        //setCellRenderer(new NavTreeCellRenderer());
        fRowSelectionListener = new MouseAdapter() {

            公共无效鼠标按下（鼠标事件e）{
                if (SwingUtilities.isLeftMouseButton(e)) {
                    int 最近行 = fThis.getClosestRowForLocation(
                            e.getX(), e.getY());
                    矩形最接近行边界 = fThis.getRowBounds(closestRow);
                    if(e.getY() >= mostRowBounds.getY() &&
                            e.getY() < 最近行边界.getY() +
                            最近的RowBounds.getHeight()) {
                        if(e.getX() > nearestRowBounds.getX() &&
                                最接近行 < fThis.getRowCount()){

                                                    fThis.setSelectionRow(closestRow);
                                                }

                    } 别的
                        fThis.setSelectionRow(-1);
                }
            }

        };
        setWholeRowSelectionEnabled(true);
    }

    公共无效setWholeRowSelectionEnabled（布尔wholeRowSelectionEnabled）{
        fWholeRowSelectionEnabled = WholeRowSelectionEnabled；
        如果（fWholeRowSelectionEnabled）
            addMouseListener(fRowSelectionListener);
        别的
            removeMouseListener(fRowSelectionListener);
    }

    公共布尔 isWholeRowSelectionEnabled() {
        返回 fWholeRowSelectionEnabled；
    }

    公共静态无效主要（字符串[]参数）{
        JFrame 框架 = 新的 JFrame();
        DefaultMutableTreeNode root = new DefaultMutableTreeNode("Root");
        root.add(new DefaultMutableTreeNode("孩子 1"));
        root.add(new DefaultMutableTreeNode("Child 2"));
        root.add(new DefaultMutableTreeNode("Child 3"));
        导航树树 = 新导航树（根）；
        框架。添加（树）；
        frame.setSize(200, 300);
        frame.setVisible(true);
    }
}

```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T06:00:56.090

使用 . 的修饰键信息`MouseEvent`。查看[`MouseEvent#getModifiersEx`](http://docs.oracle.com/javase/7/docs/api/java/awt/event/MouseEvent.html#getModifiersEx%28%29)更多信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-04-19T11:59:50.640

PS：监听器注册包含一个bug

```
public void setWholeRowSelectionEnabled(boolean wholeRowSelectionEnabled) {
    fWholeRowSelectionEnabled = wholeRowSelectionEnabled;
    if (fWholeRowSelectionEnabled)
        addMouseListener(fRowSelectionListener);
    else
        removeMouseListener(fRowSelectionListener);
} 
```

将该属性设置`wholeRowSelectionEnabled`为`true`应该只注册一次侦听器。`true`如果该属性设置为多次，您的代码将一次又一次地添加侦听器。我的意思是属性设置器应该是[幂等](https://stackoverflow.com/a/19320202/974186)的。

快速修复可能是先将其删除并在启用时添加它

```
public void setWholeRowSelectionEnabled(boolean wholeRowSelectionEnabled) {
    removeMouseListener(fRowSelectionListener);
    fWholeRowSelectionEnabled = wholeRowSelectionEnabled;
    if (fWholeRowSelectionEnabled)
        addMouseListener(fRowSelectionListener);
} 
```

# html - 浏览器尝试将 .xlsx 文件另存为 .zip

> ID：10906752
> 
> 赞同：0
> 
> 时间：2012-06-06T00:19:29.073
> 
> 标签：html, apache, download, file-extension

在 Apache 上运行的网站具有以下无害的行来链接 .xlsx 电子表格以供下载：`<a href='/files/files.xlsx'>Download</a>`

当我单击它时，Opera 会提供以 .zip 格式下载文件。虽然 .xlsx 文件是有效的 .zip 文件，但我更希望将它们作为电子表格下载。如何防止这种行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T00:29:27.540

`.htaccess`在站点的根目录中添加以下内容解决了该问题

```
# XLSX
AddType application/vnd.openxmlformats-officedocument.spreadsheetml.sheet .xlsx 
```

这是一个很好的[示例 .htaccess 文件](https://developer.mozilla.org/en/Sample_.htaccess_file)，配置了各种流行的扩展 MIME 类型对。

# command-line - Imagemagick 命令行，组合两个不同大小的图像

> ID：10906754
> 
> 赞同：1
> 
> 时间：2012-06-06T00:19:49.190
> 
> 标签：command-line, imagemagick

我想使用 Imagemagick 的“转换”（或其他）来组合两个不同大小的图像。我希望它们在左下角对齐。例如，我有两个图像：

trans_alpha.png （一个透明的 42x37 空白图像）和 shadow.png （一个 68x23 图像，我想覆盖在左下角对齐的 trans_alpha.png 上）

我想要的结果是 68x37 图像，*注意*这些尺寸只是示例，我不想将尺寸放入命令行，我只想使用输入图像中的尺寸。

我尝试了很多组合但没有成功：

尝试没有。776（关闭，但与左上角对齐，而不是左下角）..：

```
convert trans_alpha.png -background none shadow.png -gravity SouthWest -layers merge  +repage result.png 
```

尝试没有。841（正确对齐，但结果图像不够宽）...

```
convert trans_alpha.png shadow.png -gravity SouthWest -composite result.png 
```

希望这是有道理的。谢谢，

保罗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T09:07:49.970

回答我自己的问题（由[www.imagemagick.org](http://www.imagemagick.org/discourse-server/viewtopic.php?f=1&t=21164)上的聪明人提供）

```
convert \
  trans_alpha.png shadow.png \
 -flip \
 -background none \
 -mosaic \
 -flip \
  result.png 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T00:29:50.400

Imagemagick 包含许多有用的转换，但有时它仍然缺少您需要的转换。由于您的原始图像是 PNG 无损位图，因此您可以将两者转换为长格式 PBM 或长格式 PPM 等相关格式。这些形式的优点是它们以纯文本逐个像素地表示整个图像，人们可以编写一个程序——通常是一个相当短的程序——来处理人们喜欢的任何方式。作为存储格式，PBM 和 PPM 效率极低，但它们同样极易操作，而这正是您想要的。

pbm(5) 手册页（例如在软件包中的 Debian/Ubuntu 系统上可用`netpbm`）写得很好，并清楚地解释了该过程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T09:44:43.683

我目前无法测试，但您可以使用`-page`图层，因此类似这样的方法可能有效，但您可能需要计算 Y 偏移量：

```
convert \
   trans_alpha.png \
  -background none \
   shadow.png \
  -page +0+10 \
  -layers merge \
  +repage \
   result.png 
```

您可能不需要 -background none

# php - .load() 加载页面时发生变化

> ID：10906756
> 
> 赞同：1
> 
> 时间：2012-06-06T00:20:31.010
> 
> 标签：php, jquery, ajax

这是我的问题 - 我有包含“file.php”和数据库内容的 Div，然后我将新数据插入数据库并希望将 .load() file.php 重新加载到 div 但内容相同，直到我刷新页面。有人知道它是什么吗？文件.php

```
<?php
include "../lib/dbconnect.php";
$class = $_GET['class'];
$get_posts = mysql_query("SELECT content, date, author, author_id FROM classPosts WHERE class = '$class' ORDER BY id DESC");
while (list($content, $time, $author, $author_id) = mysql_fetch_row($get_posts)){
    $get_user_name = mysql_query("SELECT name, lastName FROM users WHERE nick = '$author'");
    while (list($name, $lastName) = mysql_fetch_row($get_user_name)){
        $time = new Cokidoo_DateTime("@" . $time);
        echo "
            <div class=\"div\">
            <div class=crop-small title=\"$author\">
                <a href=/user/user.php?user=$author_id><img src=/user/pics/$author_id.jpg class=img-small></a>
            </div>
            <span class=small-text><b style=\"color: rgb(100,100,100)\">$name $lastName</b><br>
            <span class=\"small-text\">Přezdívka <b style=\"color: rgb(100,100,100)\">$author</b></span><br>
            Přidáno $time</span><p><br></p>
            <span class=\"small-text\">$content</span>
            </div>
        ";
    }
} 
```

?>

有Javascript

```
 if(data.success)
            {
                $("#class_posts").fadeOut(function(){
                   $("#new_post").hide(0);
                 $("#class_posts").load("../trida/get_posts.php");
                   $("#class_posts").fadeIn();
                   $("#new_post_text").html("");
                });
            } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T00:26:39.900

尝试在末尾附加一个随机数作为查询字符串 - 以防止缓存。

```
var randNum = Math.floor(Math.random() * 999999);
$("#class_posts").load("../trida/get_posts.php?"+randNum); 
```

# c - 分段错误实现链表

> ID：10906757
> 
> 赞同：3
> 
> 时间：2012-06-06T00:20:46.523
> 
> 标签：c, linked-list, segmentation-fault

我有以下简单的代码，但它引发了分段错误。有人可以指出我做错了什么吗？在我输入第一个数字后出现分段错误。

```
 #include <stdio.h>
    #include <stdlib.h>

    struct linked_list {
        int val;
        struct linked_list *next;
    } *curr, *head;

    typedef struct linked_list list;

    void createLinkedList(int num);
    void main() {
        int i;

        head = NULL;
        int num = 0;
        for (i = 0; i < 10; i++) {
            printf("Enter a number:");
            scanf("%d", num);
            createLinkedList(num);
        }
        curr = head;

        while(curr) {
            printf("%d\n", curr->val);
            head = curr->next;
        }

    }

    void createLinkedList(int n) {

          curr = (list *)malloc(sizeof(list));
          curr->val = n;
          curr->next = head;
          head = curr;
    } 
```

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T00:29:34.630

你读到 num 不正确。`scanf`需要一个指向整数的指针，因此它试图分配给无效的内存位置 0。用于`&`引用 的内存位置`num`。

这是一个更正的版本：

```
scanf("%d", &num); 
```

# jndi - 如何获取 glassfish jndi 参考列表

> ID：10906758
> 
> 赞同：-3
> 
> 时间：2012-06-06T00:20:49.847
> 
> 标签：jndi, glassfish-3

无论如何要对 glassfish 3.1.2 (3.1.X) 进行远程查找并取回可能的 jndi 名称列表。（使用 weblogic 很容易，但是使用 glassfish 我似乎找不到方法，而且我对我的 ejb 的 jndi 名称的所有猜测都失败了）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T00:34:44.083

使用“asadmin list-jndi-entries”

asadmin 具有上下文帮助以及[在线](http://docs.oracle.com/cd/E18930_01/html/821-2416/gglpq.html)文档，它们可能会为您指明正确的方向。

# visual-studio-2010 - 鼠标导航按钮在 Visual Studio 2010 中的作用是什么？

> ID：10906761
> 
> 赞同：0
> 
> 时间：2012-06-06T00:21:03.627
> 
> 标签：visual-studio-2010

我知道这是一个非常蹩脚的问题，但我似乎无法在任何地方找到答案。当我单击鼠标上的导航拇指按钮时，光标会在 Visual Studio 2010 中的行和文件之间跳转。我假设这是在以某种逻辑模式导航代码。但是，它似乎没有遵循参考，我看不出这种模式可能是什么。*如果*VS2010遵循参考，那么它的工作很糟糕。

**更新：** 鼠标光标确实在 C# 文件中导航。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T00:45:40.787

这篇[文章](http://www.codeproject.com/Articles/57119/Forward-Backward-Code-Navigation-with-the-Mouse-Th)说

> Visual Studio 2010 不支持在 C++、Visual Basic 和 F# 语言中使用鼠标拇指按钮在源代码中导航。

# php - 跨服务器ajax请求

> ID：10906763
> 
> 赞同：1
> 
> 时间：2012-06-06T00:21:29.980
> 
> 标签：php, ajax, jsonp, cross-server

我遇到了这样一种情况，我公司的一个客户正在使用我们的服务构建网站，但希望在我们的网站上包含发布到在其主要业务网站页面上动态生成的表格中的播客。

我以前用过 ajax，我知道最大的障碍之一是使用 ajax 访问托管在不同服务器上的站点上的内容。根据我的研究，我认为 JSONP 在这种情况下是最好的解决方案，但为了争论，假设我不知道他们的服务器是如何配置的（并且没有实际的方法来找出）而且我知道的不多关于 JSON（这是真的）。

在这种情况下，我可能不应该指望灵丹妙药，但有人能至少指出我正确的方向吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T00:26:26.967

使用调用 AJAX 服务的 PHP 创建您自己的服务，这样您就可以调用任何您想要的远程服务，但 ajax 调用是针对您的域的。如果你愿意，我可以提供一个例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T00:24:34.087

如果您可以使用 jQuery，请查看[jQuery AJAX cross domain](https://stackoverflow.com/questions/3506208/jquery-ajax-cross-domain)，否则，将以下标头函数之一放入为请求提供服务的脚本中，看看这是否有帮助。

```
header('Access-Control-Allow-Origin: *');
header('Access-Control-Allow-Origin: http://permitted_domain.com'); 
```

这是客户端浏览器支持的东西，因此您的里程可能会有所不同

对于非 AJAX/Javascript 解决方案，可以使用诸如[file_get_conents()](http://php.net/manual/en/function.file-get-contents.php)（注意[此配置](http://www.php.net/manual/en/filesystem.configuration.php#ini.allow-url-fopen)）或使用[cURL](http://php.net/manual/en/book.curl.php)之类的 URL 获取机制来实现类似（如果不是更多内联）结果

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T02:55:38.530

您可以在这种情况下使用[curl](http://www.php.net/manual/en/function.curl-init.php)。

# c# - 在串行命令执行的约束下，我应该如何将控制台应用程序转换为服务应用程序？

> ID：10906765
> 
> 赞同：1
> 
> 时间：2012-06-06T00:21:37.490
> 
> 标签：c#, service

我的情况是我有一个“服务应用程序”，它是一个控制台应用程序，由代理任务在不同时间启动。

现在我的要求发生了一些变化，我认为只能由任务调度程序运行的内容需要由运行在 Intranet 上的客户端应用程序调用。

一个问题是该服务使用 .NET 4.0（而不是客户端配置文件），我不想将其强加到安装程序中，即使我这样做了，我也不希望执行不同版本的机会。因此，将代码推送到库中似乎是错误的。

另一个问题是，目前我控制代理任务的调度，所以我从未尝试设计这样的功能，即多个服务实例将同时执行一个命令。没有逻辑特别依赖于这种情况，但我对假设它会全部工作感觉不太好 - 它只是不是为了那样工作而设计的。

基本上，我知道这里需要做什么。我要问的是实现它的现代有效方法是什么。我应该看WCF吗？我忽略了一种非常简单的方法吗？

这是一张我在想什么的图片，希望能让它更清楚。

![在此处输入图像描述](../Images/97cc723393a959250ae954c907a97323.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T03:31:45.680

WCF 应该是一个正确的选择，它简单而强大。

客户端配置文件支持它 - [http://msdn.microsoft.com/en-us/library/cc716765.aspx](http://msdn.microsoft.com/en-us/library/cc716765.aspx)

WCF 中使用行为控制实例和服务的数量。下面的配置应该保证同时只运行一种方法。`maxConcurrentCalls="1"`如果可以同时运行多个方法但只应执行一个实例，则可以使用参数（删除）。

```
 <behaviors>
      <serviceBehaviors>
        <behavior>
          <serviceThrottling 
            maxConcurrentCalls="1" 
            maxConcurrentSessions="1" 
            maxConcurrentInstances="1"
          />
        </behavior>
      </serviceBehaviors>
</behaviors> 
```

# objective-c - Objective-C 标准文档

> ID：10906767
> 
> 赞同：25
> 
> 时间：2012-06-06T00:21:52.583
> 
> 标签：objective-c, standards, document, grammar

我是一名尝试开始使用 Objective-C 的 C 和 C++ 程序员。不过，我真的很困惑，因为显然完全没有语言和标准库的标准文档。我可以理解没有ISO标准，但是根本就没有参考文件*吗？*似乎没有人非常关心这种事态，这是怎么回事？（诚​​然，谷歌很难找到这样的东西，因为“参考”、“文档”和“标准”都是重载的术语。所以我可能错过了一些关键的东西。）

这个问题接近于问同样的问题：[我在哪里可以找到解释如何实现 Objective-C 的文档](https://stackoverflow.com/questions/1363589/where-can-i-find-a-document-explaining-how-objective-c-is-implemented)，并且提供的唯一答案是“阅读 Apple 发布的这个源代码，这与他们几年前的实现非常接近， 也许”。

此页面：[http](http://clang.llvm.org/docs/ObjectiveCLiterals.html) ://clang.llvm.org/docs/ObjectiveCLiterals.html包含 Objective-C 的正式语法片段，但具有讽刺意味的是，它是在描述 Clang 刚刚推出并自行添加的功能的上下文中并且没有其他人支持。这里还有另一种语法：[http](http://www.omnigroup.com/mailman/archive/macosx-dev/2001-March/022979.html) ://www.omnigroup.com/mailman/archive/macosx-dev/2001-March/022979.html但它已有 10 多年的历史了。

将问题缩小到最低限度：我想知道“对象”保证提供哪些方法，以及每种方法的行为是什么。对于其他语言，此类信息通常由以下内容提供： http: [//docs.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-13T03:18:17.117

不幸的是，没有像 C++ 或 C 那样的 ObjC 标准。Apple 是该语言的主要用户和驱动程序，他们的编译器实现（Clang 的 ObjC 位）是事实上的标准。他们的旧文档[（**断开的链接**）“Objective-C 编程语言”](http://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/ObjectiveC/) 与您得到的散文版本差不多，而且它远不及其他任何一种语言标准的精确度（而且它往往落后于编译器）。

它可能仍然在网络上的某个地方浮动，但它不再是最新的。[“使用 Objective-C 编程”](https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/ProgrammingWithObjectiveC/Introduction/Introduction.html)似乎是他们想要的替代品（但同样，它*不像*标准）。

关于[您在 Tim 的已删除答案下的评论](https://stackoverflow.com/questions/10906767/objective-c-standards-document/10990281#comment14248067_10906824)（仅限 10k 链接），Cocoa 根类为`NSObject`，其接口[已记录](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSObject_Class/)，但其来源不可用。请注意，该[`NSObject`协议](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Protocols/NSObject_Protocol/)也是 Cocoa 对象功能的一个极其重要的部分。Apple 的运行时是[开源的](http://opensource.apple.com/source/objc4/)，* 并且有一个名为 的根类`Object`，我假设是为了演示。它不用于 Cocoa 编程。

当然，您已经知道所有这些。您的问题的直接答案是“没有”。但是，正如 bbum 指出的那样，大多数语法与 C 相同：[ObjectiveC string literals 的权威描述？](https://stackoverflow.com/questions/10775956/authoritative-description-of-objectivec-string-literals) [（是的，我将我的评论从那里复制粘贴到这个答案的开头）]。

* * *

*请注意，与您在问题中所说的相反，这是*实际*的最新运行时。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-12T03:44:23.027

我想我理解你的问题是正确的，所以我会相应地回答......

我强烈推荐[Apple Developer Library](https://developer.apple.com/library/ios/navigation/)中的文档。以下是一些帮助您入门的基本指南：

[Objective-C 编程中的概念](https://developer.apple.com/library/ios/#documentation/General/Conceptual/CocoaEncyclopedia/Introduction/Introduction.html#//apple_ref/doc/uid/TP40010810)

[使用 Objective-C 编程](https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/ProgrammingWithObjectiveC/Introduction/Introduction.html#//apple_ref/doc/uid/TP40011210)

[可可基础指南](https://developer.apple.com/library/mac/documentation/MacOSX/Conceptual/OSX_Technology_Overview/CocoaApplicationLayer/CocoaApplicationLayer.html#//apple_ref/doc/uid/TP40001067-CH274-SW1)

[iOS 应用程序编程](https://developer.apple.com/library/ios/#documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40007072)

那里的文档是 Objective-C 和 Cocoa 最佳实践和编码标准的权威来源。还有更多关于众多主题的文档，因此请务必查看该网站。

您还询问了如何知道哪些方法可用于对象。要知道这一点，您可以查看类引用。

例如：

[NSObject 类参考](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsobject_Class/Reference/Reference.html)

指南和类引用之间的区别在于，指南更多地是关于代码背后的概念，而类引用是类可用的方法和属性的列表。

希望这有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-11T15:17:37.413

至少找到了一些 Objective-C 的语言定义，包括语法等（见链接）

我现在就在你 3 年前去过的地方（根据你问题中的日期）：我开始接触 Objective-C，我觉得很奇怪似乎没有参考手册，在哪里例如，我可以查找语法、关键字等的确切含义和定义。

我现在发现，至少其中一些可以在与可可相关的文档中找到（[可可核心能力](https://developer.apple.com/library/mac/documentation/General/Conceptual/DevPedia-CocoaCore/DeclaredProperty.html)）。例如，链接跳转到关键字“@property”的定义。

在我的 POV 中，这不仅与 Cocoa 相关，而且通常定义了 C 的 Objective-C 语言扩展。这就是为什么我不会在标有“Cocoa”的文档中搜索它的原因。

# c - 找到内核模块但未“看到”

> ID：10906769
> 
> 赞同：0
> 
> 时间：2012-06-06T00:22:02.863
> 
> 标签：c, linux, kernel

我正在 Linux 3.2.6 中编译内核模块。

我有`module.h`，`/usr/src/linux/include/linux`除非我去用我的makefile编译它，它告诉我`module.h`找不到。

在我的 makefile 中，我还`KDIR`设置了模块的位置。

我怎样才能解决这个问题？我的制作文件是：

```
MODCFLAGS       := -Wall -DMODULE -D__KERNEL__ -DLINUX

obj-m   := hello.o
KDIR    := /usr/src/linux/include/
PWD     := `pwd`

default:
        make -C $(KDIR) M=$(PWD) modules 
```

# ruby-on-rails - 数组评估为零

> ID：10906774
> 
> 赞同：2
> 
> 时间：2012-06-06T00:23:04.697
> 
> 标签：ruby-on-rails, ruby, arrays

下面我在一个名为 Movie 的模型中创建了一个类方法，它应该返回一个数组：

```
def self.all_ratings
  Array['G','PG','PG-13','R','NC-17']
end 
```

在我的电影控制器中，我使用以下实例变量访问它：

```
@all_ratings = Movie.all_ratings 
```

但是，当在我的索引视图中使用它时，我收到以下错误：

```
You have a nil object when you didn't expect it!
You might have expected an instance of Array.
The error occurred while evaluating nil.each 
```

我相信我正在正确地创建数组，但我可能是错的。有什么建议为什么会发生这些错误？

下面是使用@all_ratings 的视图：

```
%h1 All Movies

= form_tag movies_path, :method => :get do
  Include: 
  - @all_ratings.each do |rating|
    = rating
    = check_box_tag "ratings[#{rating}]"
  = submit_tag 'Refresh' 
```

这是我在控制器中实现@all_ratings 的方式

```
class MoviesController < ApplicationController

  @all_ratings = Movie.all_ratings 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T00:45:49.890

初始化实例变量的代码需要在实例方法中。

（否则范围是类，而不是实例。）

```
class MoviesController < ApplicationController
  def index # Or wherever
    @all_ratings = Movie.all_ratings
  end
end 
```

如果您在多种方法中需要该值，则可以使用 a `before_filter`。

Ruby 与 Java 等语言不同。在 Java 中，实例变量是在实例方法之外定义的，并且在每个实例方法中都可用，无论它们的初始化值是什么。

在 Ruby 中，有两种（主要）方法来处理实例变量：使用方法如`attr_accessor`创建访问器方法，或在实例方法中初始化它们，如上所示。

一旦实例变量初始化，它的值就可以从任何其他实例方法中使用。例如，在您的评论中，您提到在`ratings`方法中对其进行初始化。除非`ratings`被显式调用，`@all_ratings`否则*不会*被初始化。换句话说，如果您向 发出`GET`请求`index`，该`ratings`方法将*不会*被调用，并且`@all_ratings`仍然会是`nil`。

如果您显式*调用* `ratings`from `index`，`@all_ratings`则将被初始化（通过`ratings`方法）。一旦在*任何*实例方法中初始化，该对象的实例（在本例中为控制器）就有一个初始化的`@all_ratings`实例变量：

```
def index
  ratings
end 
```

现在 的值`@all_ratings`在索引的模板中可用。

*如果不*将实例变量初始化放在实例方法中，您实际上正在做的是在*class* `Foo`中创建实例变量，这是非常不同的：

```
[1] pry(main)> class Foo
[1] pry(main)*   @wat = self.class
[1] pry(main)* end  
=> Class
[2] pry(main)> f = Foo.new
=> #<Foo:0x007fbfba8efba8>
[5] pry(main)> f.instance_variables
=> []
[6] pry(main)> Foo.instance_variables
=> [:@wat]
[7] pry(main)> Foo.instance_eval "@wat"
=> Class 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-06T00:47:47.590

请`@all_ratings = Movie.all_ratings`在控制器的 index 动作内移动。如果它对所有动作都是通用的，则将其放入 before 过滤器中，如下所示：

```
class MoviesController < ApplicationController

before_filter :load_ratings

def index
..
end

<other public methods>

private

def load_ratings
  @all_ratings = Movie.all_ratings
end 
```

# angularjs - 样式元素中的AngularJS不起作用

> ID：10906776
> 
> 赞同：5
> 
> 时间：2012-06-06T00:23:19.560
> 
> 标签：angularjs

我正在尝试在样式元素中使用角度 js 绑定，但它似乎不起作用。这是一个错误，有没有更好的方法来做到这一点？

```
<style ng-repeat="test in styles">
.test {
    background-color: {{ test.backgroundColor }};
    display: {{ test.display }};
    width: {{ test.width }};
    height: {{ test.height }};
    }
</style> 
```

[http://jsfiddle.net/cmsanche/PpyVn/](http://jsfiddle.net/cmsanche/PpyVn/)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-06T01:06:06.150

我不认为 Angular 解析样式元素。您可能想使用 ngStyle 指令：

[http://docs.angularjs.org/api/angular.module.ng.$compileProvider.directive.ngStyle](http://docs.angularjs.org/api/angular.module.ng.$compileProvider.directive.ngStyle)

```
<!doctype html>
<html ng-app>
<head>
<script src="http://code.angularjs.org/angular-1.0.0rc10.min.js"></script>
</head>
<body>
<div ng-init="styles=[{backgroundColor: 'red', width:'100px', height: '100px', display: 'block'}]">

<div ng-repeat="test in styles" ng-style="test">
.test {
    background-color: {{ test.backgroundColor }};
    display: {{ test.display }};
    width: {{ test.width }};
    height: {{ test.height }};
    }
</div>
</html> 
```

Plunker（类似于 jsFiddle，但对 Angular 更友好）[**演示**](http://plnkr.co/edit/n70DQw?p=preview)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-29T04:16:07.027

这现在适用于较新版本的 Angular。

这里[http://jsfiddle.net/PpyVn/4/](http://jsfiddle.net/PpyVn/4/)是 OPs 将 1.0 替换为 1.3.0-rc.3。

```
<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.3.0-rc.3/angular.min.js"></script> 
```

# javascript - 如何轻松执行 JavaScript 文件？

> ID：10906782
> 
> 赞同：3
> 
> 时间：2012-06-06T00:24:19.140
> 
> 标签：javascript, development-environment

当我学习 Perl 和 Python 时，我的“开发环境”由 vim 和一个 shell 组成。我会简单地在 vim 中编写程序，然后从命令行执行它。我知道 spidermonkey 引擎可以作为独立的解释器使用，但我不确定它有多实用。

JS 的“直观”方式是将脚本合并到网页中并在不同的浏览器中查看，但这似乎很麻烦。我已经看到了一些有关 Firebug 的建议，但我无法完全掌握它。

我知道有几个面向 JS 的 vim 插件，但我也不知道它们的实用性如何。

我基本上想写一个脚本，并快速检查它的语法和输出。我也很想知道实际的 JS 开发人员是如何测试他们的代码的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T00:36:23.687

我经常使用[Node.js](http://nodejs.com)，所以我的回答会对此有偏见，但是......

1.  为了学习这门语言，Node.js 为您提供了一个易于使用（如 Python、Ruby 等）的 REPL，只需`node`在命令行中键入即可。
2.  [Zombie](http://zombie.labnotes.org)是一个用 Node.js 实现的无头浏览器，可以很好地验证您的网站。如果您的 Javascript 在语法上是错误的，那么一旦您尝试加载页面，您就会收到错误消息。如果您的 Javascript 在语义上是错误的（逻辑错误），那么您为验证代码的正确行为而编写的测试将失败。
3.  您最终将*不得不*在 Firefox、IE 等中进行测试，但不是真正在 Chrome 中进行测试，因为它们都使用相同的 V8 引擎（当然，您可能想粗略地看一眼）。您可能知道，IE 与其他浏览器的差异最大，因为它没有实现功能或给它们一个不同的名称。令人惊讶的是，Firefox 也很离经叛道，但不是缺少功能，而是在 Javascript 语言中有许多其他浏览器没有的额外功能（他们作为 ECMAScript 标准的一部分提出但被拒绝）所以实际上*最好*不要如果您希望代码在每个解释器上运行，请从那里开始。

使用 Node.js，您还可以使用速度更快的服务器端解释器之一（比 Python 和 Ruby 更快，大致等于 Lua，有时甚至达到 Java 的水平，并且不知何故 V8 拥有世界上最快的 RegEx 引擎)，然后服务器端代码匹配客户端代码，这使得像 RPC 层这样的东西更易于使用。

# c++ - 无法将“cv::VideoCapture”转换为“CvCapture*”

> ID：10906786
> 
> 赞同：2
> 
> 时间：2012-06-06T00:24:46.970
> 
> 标签：c++, c, image-processing, opencv, computer-vision

我有一个简单的程序可以拍摄视频并播放（尽管它对视频进行了一些图像处理）。可以从对话框结果中检索视频，也可以直接通过提供文件路径来检索视频。当我使用**cv::CvCapture capture1**时，我得到了像 capture1.isOpen()、**capture1.get(CV_CAP_PROP_FRAME_COUNT)**等属性，但是当我使用**CvCapture* capture2**时，我得到了奇怪的错误。

我想使用**cv::CvCapture capture1**因为我的功能符合**capture1**。或者有什么方法可以使用这两种类型并在它们之间进行某种转换，比如**类型转换**或其他东西。

实际上我有两个程序，program1 的功能是针对**cv::CvCapture**而 program2 的功能是针对**CvCapture***。我的意思是这两个程序以不同的方式读取视频文件。

然后我合并这两个程序以使用程序 1 中的一些函数和程序 2 中的一些函数。但我无法将**cv::CvCapture**转换为**CvCapture***。

我将 OpenCv 与 Qt Creator 一起使用。

我的代码在这里发布很长，但我已经简化了我的代码以使其更小且易于理解。我的代码可能无法正确编译，因为我对其进行了修改以使其更简单。

任何帮助，将不胜感激。提前致谢 ：）

```
void MainWindow::on_pushButton_clicked()
{

 std::string fileName = QFileDialog::getOpenFileName(this,tr("Open Video"), ".",tr("Video Files (*.mp4 *.avi)")).toStdString();

cv::VideoCapture  capture1(fileName);       // when I use the cv::VideoCapture capture it gives  an error

//error: cannot convert 'cv::VideoCapture' to 'CvCapture*' for argument '1' to 'IplImage* cvQueryFrame(CvCapture*)
    //CvCapture* capture2 = cvCaptureFromCAM(-1);
    // but when i use the CvCapture* capture2, it does not recognize capture2.isOpend() and capture2.get(CV_CAP_PROP_FRAME_COUNT) etc. don't work.
    // Is there any way to convert VideoCapture to CvCapture*?
    if (!capture.isOpened())
        {
            QMessageBox msgBox;
            msgBox.exec(); // some messagebox message. not important actually
        }
 cvNamedWindow( name );
 IplImage* Ximage = cvQueryFrame(capture);
 if (!Ximage)
   {
     QMessageBox msgBox;
     msgBox.exec();
    }

 double rate= capture.get(CV_CAP_PROP_FPS);
 int frames=(int)capture.get(CV_CAP_PROP_FRAME_COUNT);
int frameno=(int)capture.get(CV_CAP_PROP_POS_FRAMES);
 bool stop(false);

 capture.read(imgsize);

 cv::Mat out(imgsize.rows,imgsize.cols,CV_8SC1);
 cv::Mat out2(imgsize.rows,imgsize.cols,CV_8SC1);
        //I print the frame numbers and the total frames on  a label.
            ui->label_3->setText(QString::number(frameno/1000)+" / "+QString::number(frames/1000)); 
            ui->label->setScaledContents(true); 
            ui->label->setPixmap(QPixmap::fromImage(img1)); // here I show the frames on a label.
  } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-06T01:03:28.030

`cv::VideoCapture`来自 OpenCV 的**C++ 接口**，可用于从相机设备和磁盘上的文件中捕获

```
cv::VideoCapture  capture1(fileName); 
if (!capture.isOpened())
{
    // failed, print error message
} 
```

并且`cvCaptureFromCAM()`是来自 OpenCV 的**C 接口**的函数，仅用于从摄像头设备捕获：

```
CvCapture* capture2 = cvCaptureFromCAM(-1);
if (!capture2)
{
    // failed, print error message
} 
```

不要将这些接口混合/合并在一起，选择一个并坚持下去。

如果要使用 C 接口从视频文件中捕获，请`cvCaptureFromFile()` 改用：

```
CvCapture* capture  = cvCaptureFromFile(fileName);
if (!capture)
{
    // print error, quit application
} 
```

检查这些示例：

*   [使用 C 接口的相机捕捉](https://stackoverflow.com/a/3919216/176769)
*   [使用 C++ 接口的相机捕捉](https://stackoverflow.com/a/8408961/176769)

# erlang - 版本比较功能，关于特殊字符

> ID：10906792
> 
> 赞同：2
> 
> 时间：2012-06-06T00:25:08.440
> 
> 标签：erlang, rabbitmq

我现在正在研究rabbitmq源代码来学习erlang技术。

以下来自`rabbit_misc.erl`文件。目的是检查应用程序的最低版本。在 的第 5 和第 7 分句中`version_compare/N`，有一个特殊字符，即`$0`。但是不知道是怎么回事？我不会发生这种情况的原因是，在最后一句中，lists:splitwith/N 之后，`AT1`并且`BT1`将以`"$."`.

```
version_compare(A, B, lte) ->
    case version_compare(A, B) of
        eq -> true;
        lt -> true;
        gt -> false
    end;
version_compare(A, B, gte) ->
    case version_compare(A, B) of
        eq -> true;
        gt -> true;
        lt -> false
    end;
version_compare(A, B, Result) ->
    Result =:= version_compare(A, B).

version_compare(A, A) ->
    eq;
version_compare([], [$0 | B]) ->
    version_compare([], dropdot(B));
version_compare([], _) ->
    lt; %% 2.3 < 2.3.1
version_compare([$0 | A], []) ->
    version_compare(dropdot(A), []);
version_compare(_, []) ->
    gt; %% 2.3.1 > 2.3
version_compare(A,  B) ->
    {AStr, ATl} = lists:splitwith(fun (X) -> X =/= $. end, A),
    {BStr, BTl} = lists:splitwith(fun (X) -> X =/= $. end, B),
    ANum = list_to_integer(AStr),
    BNum = list_to_integer(BStr),
    if ANum =:= BNum -> version_compare(dropdot(ATl), dropdot(BTl));
       ANum < BNum   -> lt;
       ANum > BNum   -> gt
    end. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T00:47:06.497

$0 不是特殊字符——这是零字符串：“0”。

版本可能很复杂：0.1.22.333 和 splitwith/2 分为头部和尾部（“0”和“.1.22.333”）。

我想处理 $0 是针对“1.0.0”和“1”这样的情况

```
{"1",".0.0"} vs {"1",[]} 
```

# ruby-on-rails - 如何生成正确的 `url_for` 嵌套资源？

> ID：10906793
> 
> 赞同：4
> 
> 时间：2012-06-06T00:25:48.143
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, routing, named-routing

我正在使用 Ruby on Rails 3.2.2，我想`url_for`为嵌套资源生成正确的 URL。也就是说，我有：

```
# config/routes.rb
resources :articles do
  resources :user_associations
end

# app/models/article.rb
class Article < ActiveRecord::Base
  ...
end

# app/models/articles/user_association.rb
class Articles::UserAssociation < ActiveRecord::Base
  ...
end 
```

*注意*：生成的命名路由类似于`article_user_associations`, `article_user_association`, `edit_article_user_association`, ...

在我看来，我使用：

```
url_for([@article, @article_association]) 
```

然后我收到以下错误：

```
NoMethodError
undefined method `article_articles_user_association_path' for #<#<Class:0x000...> 
```

但是，如果我这样声明路由器

```
# config/routes.rb
resources :articles do
  resources :user_associations, :as => :articles_user_associations
end 
```

该`url_for`方法按预期工作，并生成例如 URL `/articles/1/user_associations/1`。

*注意*：在这种情况下，生成的命名路由类似于`article_articles_user_associations`, `article_articles_user_association`, `edit_article_articles_user_association`, ...

但是，我认为在后者/工作案例中构建/命名路由器的方式并不是“好”的。那么，是否有可能通过生成类似**（而不是类似）的命名路由****以某种方式使该`url_for`方法起作用？`article_user_association``article_articles_user_association`**

* * *

我阅读了与该方法相关的[官方文档](http://api.rubyonrails.org/classes/ActionDispatch/Routing/UrlFor.html)`ActionDispatch::Routing::UrlFor` （特别是“命名路由的 URL 生成”部分），但我找不到解决方案。也许有一种方法可以让 Rails 使用特定的命名路由器，就像当您想使用`self.primary_key`语句更改表的主键列时一样......

```
# app/models/articles/user_association.rb
class Articles::UserAssociation < ActiveRecord::Base
  # self.primary_key = 'a_column_name'
  self.named_router = 'user_association'

  ...
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T05:07:07.633

您的`UserAssociation`模型位于`Articles`命名空间中，该命名空间包含在命名路由中：

```
# app/models/articles/user_association.rb
class Articles::UserAssociation < ActiveRecord::Base
  ...
end

#        route =>           articles_user_association
# nested route =>   article_articles_user_association 
```

如果您删除命名空间，您将获得您正在寻找的路由助手：

```
# app/models/articles/user_association.rb
class UserAssociation < ActiveRecord::Base
  ...
end

#        route =>           user_association
# nested route =>   article_user_association 
```

除非您有充分的理由保留`UserAssociation`在名称空间中，否则不要这样做。

# c# - 调用两个方法重载方法的标准？

> ID：10906796
> 
> 赞同：0
> 
> 时间：2012-06-06T00:26:21.573
> 
> 标签：c#, overloading

我在 C# 规范规则中看到了在调用中使用重载方法的规则，但我似乎找不到任何关于需要满足哪些条件才能使方法实际上成为重载方法的任何内容。

这是我的镜头。如果您发现任何问题，请告诉我：

这没有考虑访问修饰符或泛型（我仍然是一个通过 C# 书工作的菜鸟）

考虑两种方法

*   确保两种方法都有正确的形式参数列表
*   将可选参数视为强制参数
*   将 params 视为一个强制参数，其类型是 params 数组的类型
*   我们有两个强制参数列表
*   （P1、P2、P3、P4）和（Q1、Q2、Q3、Q4）
*   P1 和 Q1、P2 和 Q2、... 是参数对
*   要被重载的方法，两者必须具有相同的名称但不同的参数列表

其中之一必须是错误的

*   相同数量的参数
*   每个参数对必须具有相同的类型
*   每个参数对必须都具有参数修饰符或都没有参数修饰符。

示例：method(ref int a) 和 method(out int a) 不是重载方法

*   两者 1 参数
*   两者都是整数
*   两者都有一个参数修饰符

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T00:58:13.323

通常，“方法重载”是指具有相同名称（包括 +/- 运算符）但具有不同参数的方法。

术语“重载”并未严格定义为 C# 语言中的任何特定内容（与“方法签名”不同）。定义的关闭位置可能是 C# 4.0 规范的“3.6 签名和重载”部分：

> 签名是类、结构和接口中成员**重载**的启用机制：
> 
> *   方法的重载允许类、结构或接口声明多个具有相同名称的方法，前提是它们的签名在该类、结构或接口中是唯一的。
>     
>     
> *   实例构造函数的重载允许类或结构声明多个实例构造函数，前提是它们的签名在该类或结构中是唯一的。
>     
>     
> *   索引器的重载允许类、结构或接口声明多个索引器，前提是它们的签名在该类、结构或接口中是唯一的。
>     
>     
> *   运算符的重载允许类或结构声明多个具有相同名称的运算符，前提是它们的签名在该类或结构中是唯一的。

# scala - Scala中的letrec？（“打结？”的不变方式）

> ID：10906797
> 
> 赞同：12
> 
> 时间：2012-06-06T00:26:26.267
> 
> 标签：scala, letrec, tying-the-knot

假设我有一个像这样的愚蠢的小案例类：

```
case class Foo(name: String, other: Foo) 
```

我怎样才能定义`a`和`b`不可变的那样`a.other`is`b`和`b.other`is `a`？scala 是否提供了一些[“打结”的](http://www.haskell.org/haskellwiki/Tying_the_Knot)方法？我想做这样的事情：

```
val (a, b): (Foo, Foo) = (Foo("a", b), Foo("b", a)) // Doesn't work. 
```

* * *

可能性

在 Haskell 中，我会这样做：

```
data Foo = Foo { name :: String, other :: Foo }

a = Foo "a" b
b = Foo "b" a 
```

`a`与和的绑定`b`包含在同一个`let`表达式中，或者在顶层。

或者，在不滥用 Haskell 的自动 letrec 功能的情况下：

```
(a, b) = fix (\ ~(a', b') -> Foo "a" b', Foo "b" a') 
```

注意惰性模式，`~(a', b')`这很重要。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-06T03:12:57.987

您希望`Foo`保持不变，但 Scala 中的懒惰在声明站点上。不改变它就不可能`Foo`是非严格的，并且 Haskell 中指示的模式仅有效`Foo`，因为那里是非严格的（即`Foo "a" b`不`b`立即评估）。

否则解决方案几乎相同，允许使所有内容变得非严格：

```
class Foo(name: String, other0: => Foo) { // Cannot be case class, because that mandates strictness
  lazy val other = other0 // otherwise Scala will always reevaluate
}
object Foo {
  def apply(name: String, other: => Foo) = new Foo(name, other)
}

val (a: Foo, b: Foo) = (Foo("a", b), Foo("b", a)) 
```

# c# - OpenGL/SharpGL - 仅在正交投影的近表面上的点？

> ID：10906799
> 
> 赞同：0
> 
> 时间：2012-06-06T00:26:37.747
> 
> 标签：c#, opengl, orthographic

当您为每个点使用三个维度创建点并使用正交投影来查看这些点时，是否会出现仅显示 -near 表面上的点的原因？例如，如果您使用 (the SharpGL method) `gl.Ortho(0, width, height, 0, -10, 10)`，则只有 z=10 处的点（因为近表面位于 -10 处）实际上会显示出来。

我目前正在使用 SharpGL - 但我希望我遇到的问题不在于那个特定的实现/库。

编辑：我在下面添加了演示问题的代码。请注意，此示例需要 SharpGL，实际上是对当前 SharpGL 源代码附带的 WPF 示例项目的修改（原始示例项目称为 TwoDSample）。

该项目需要 MainWindow.xaml 和 MainWindow.xaml.cs。这是xml：

```
<Window x:Class="TwoDSample.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525"
    xmlns:my="clr-namespace:SharpGL.WPF;assembly=SharpGL.WPF">
    <Grid>
        <my:OpenGLControl Name="openGLControl1" OpenGLDraw="openGLControl1_OpenGLDraw" OpenGLInitialized="openGLControl1_OpenGLInitialized"
                          Resized="openGLControl1_Resized"/>
    </Grid>
</Window> 
```

这是后面的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;
using SharpGL.Enumerations;

namespace TwoDSample
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
        }

        // NOTE: I use this to restrict the openGLControl1_OpenGLDraw method to 
        // drawing only once after m_drawCount is set to zero;
        int m_drawCount = 0;
        private void openGLControl1_OpenGLDraw(object sender,     SharpGL.SceneGraph.OpenGLEventArgs args)
        {
            // NOTE: Only draw once after m_drawCount is set to zero
            if (m_drawCount < 1)
            {
                //  Get the OpenGL instance.
                var gl = args.OpenGL;

                gl.Color(1f, 0f, 0f);
                gl.PointSize(2.0f);

                //  Draw 10000 random points.
                gl.Begin(BeginMode.Points);
                Random random = new Random();
                for (int i = 0; i < 10000; i++)
                {
                    double x = 10 + 400 * random.NextDouble();
                    double y = 10 + 400 * random.NextDouble();
                    double z = (double)random.Next(-10, 0);

                    // Color the point according to z value
                    gl.Color(0f, 0f, 1f);  // default to blue
                    if (z == -10)
                        gl.Color(1f, 0f, 0f);   // Red for z = -10
                    else if (z == -1)
                        gl.Color(0f, 1f, 0f);   // Green for z = -1

                    gl.Vertex(x, y, z);
                }

                    gl.End();
                    m_drawCount++;
                }
            }

            private void openGLControl1_OpenGLInitialized(object sender,     SharpGL.SceneGraph.OpenGLEventArgs args)
        {

        }

        private void openGLControl1_Resized(object sender,     SharpGL.SceneGraph.OpenGLEventArgs args)
        {
            // NOTE: force the draw routine to happen again when resize occurs
            m_drawCount = 0;
            //  Get the OpenGL instance.
            var gl = args.OpenGL;

            //  Create an orthographic projection.
            gl.MatrixMode(MatrixMode.Projection);
            gl.LoadIdentity();

            // NOTE: Basically no matter what I do, the only points I see are those at
            // the "near" surface (with z = -zNear)--in this case, I only see green points
            gl.Ortho(0, openGLControl1.ActualWidth, openGLControl1.ActualHeight, 0, 1, 10);

            //  Back to the modelview.
            gl.MatrixMode(MatrixMode.Modelview);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T04:37:57.627

感谢 MadcoreTom 关于深度缓冲区的评论和一些谷歌搜索，我想我找到了（或至少是“一个”）解决方案。如果我在绘图程序开始时清除深度缓冲区，（如果 z == -9 而不是 z == -10，则颜色点为红色，因为 random.Next(-10,0) 不会给出 -10 的值），然后事情似乎按预期工作。

要查看所有 z 值处的点（在正交范围内），我只是将 openGlControl1_OpenGLDraw 方法替换为以下内容：

```
 private void openGLControl1_OpenGLDraw(object sender,     SharpGL.SceneGraph.OpenGLEventArgs args)
    {
        // NOTE: Only draw once after m_drawCount is set to zero
        if (m_drawCount < 1)
        {
            //  Get the OpenGL instance.
            var gl = args.OpenGL;

            // ADDED THIS LINE
            gl.Clear(SharpGL.OpenGL.GL_DEPTH_BUFFER_BIT);

            gl.Color(1f, 0f, 0f);
            gl.PointSize(2.0f);

            //  Draw 10000 random points.
            gl.Begin(BeginMode.Points);
            Random random = new Random();
            for (int i = 0; i < 10000; i++)
            {
                double x = 10 + 400 * random.NextDouble();
                double y = 10 + 400 * random.NextDouble();
                double z = (double)random.Next(-10, 0);

                // Color the point according to z value
                gl.Color(0f, 0f, 1f);  // default to blue
                if (z == -9)
                    gl.Color(1f, 0f, 0f);   // Red for z = -10
                else if (z == -1)
                    gl.Color(0f, 1f, 0f);   // Green for z = -1

                gl.Vertex(x, y, z);
            }

                gl.End();
                m_drawCount++;
            }
        } 
```

# r - 加快 R 计算的措施

> ID：10906803
> 
> 赞同：3
> 
> 时间：2012-06-06T00:26:54.393
> 
> 标签：r, plyr, data.table

我问这是一个关于 的一般/初学者问题`R`，而不是特定于我使用的包。

我有`dataframe`300 万行和 15 列。我不认为这是一个巨大的数据框，但也许我错了。

我正在运行以下脚本，它已经运行了 2 个多小时 - 我想我必须采取一些措施来加快速度。

代码：

```
ddply(orders, .(ClientID), NumOrders=len(OrderID)) 
```

这不是一个过于密集的脚本，或者我不认为它是。

在数据库中，您可以向表中添加索引以提高连接速度。`R`我应该在导入时执行类似的操作以使函数/包运行得更快吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T01:14:58.813

在我看来，您可能想要：

```
orders$NumOrders <- with( orders( ave(OrderID  , ClientID) , FUN=length) ) 
```

（我不知道 len() 函数存在。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T11:39:28.210

使用建议的`data.table`包，以下操作应该在一秒钟内完成工作：

```
orders[,list(NumOrders=length(OrderID)),by=ClientID] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-06T01:08:28.507

看起来你所有的代码都是这样的：

```
orders[order(orders$ClientID), ] 
```

那会更快。

# google-maps-api-3 - 寻找街道（获取它们的坐标）并计算标记之间的距离

> ID：10906805
> 
> 赞同：1
> 
> 时间：2012-06-06T00:27:02.660
> 
> 标签：google-maps-api-3

我无法找到有关如何使用 API 来执行以下操作的任何信息：

1.  搜索街道并获得一些返回 LatLng 对象或其他东西（至少是坐标）的可点击结果。因此，如果我搜索一条街道并单击结果，我将平移到该街道（例如）。

2.  如何计算标记之间的距离？并且可能在它们之间画线。

我得到的只是 API，但没有指南，所以很难弄清楚要使用什么类型。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T00:48:14.257

这是一个小提琴，展示了如何实现这一点：

[http://jsfiddle.net/foxwisp/vQGMr/1/](http://jsfiddle.net/foxwisp/vQGMr/1/)

要将街道名称转换为 lat/lng，您需要使用地理编码器，例如 Google Maps API 提供的地理编码器。

然后，当您从地理编码中取回结果时，您可以使用 lat lng 属性来创建标记。一旦你的第一个标记被放置，你重复你的第二个街道地址的过程。我们嵌套这些调用，以便我们可以确保由于它们的异步特性而导致的执行顺序。

一旦我们有了第二个标记，我们就使用 Google 的折线函数在两个 latlng 标记点之间画一条线。

然后我们使用一个稍微复杂的数学方程来做一些距离计算，瞧。

Google Maps API 的文档非常好，希望这个小提琴能为您提供上下文，您可以通过查看文档中的函数和属性来逐步探索每个元素

# html - 在 TD 之间放置空间

> ID：10906809
> 
> 赞同：0
> 
> 时间：2012-06-06T00:27:51.323
> 
> 标签：html

我想在我的标签之间腾出空间：

```
 <td style="text-align:left;">
    <strong><font size="7" color="white">Test</font></strong>
    </td>
    <td style="text-align:right;">
    <img src="example.png" alt="Banner" style="border:0;width:560px;height:95" />
    </td> 
```

我试过这样做：

```
 <td style="text-align:left;">
    <strong><font size="7" color="white">Test</font></strong>
    </td>
    <td style="width:100;">
    </td>
    <td style="text-align:right;">
    <img src="example.png" alt="Banner" style="border:0;width:560px;height:95" />
    </td> 
```

然而它似乎是多余的，它仍然没有工作！我只想在我的第一个 td 和我的最后一个之间放置 100 个像素，我只是不知道该怎么做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T00:30:01.163

我会把它放在你的样式表中。内联 CSS 可能会变得非常多余，因此不推荐使用。

```
table.padded tr td {
   padding-left: 100px;
}

table.padded tr td:first-child {
   padding-left: 0;
} 
```

然后将课程`padded`（或其他，如果您愿意）添加到您的表格中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T00:37:49.743

添加`cellspacing`

```
 <table cellspacing='2'>
    <tr>
        <td>One</td>
        <td>Two</td>
    </tr>
</table>​​​​​​​​ 
```

[**演示。**](http://jsfiddle.net/GWtf5/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T00:36:17.170

我已经看到如果表格单元格为空，IE 不会呈现表格单元格。尝试在其中放置一个不间断的空间。话虽如此，CSS 绝对是要走的路。

# javascript - twitter-bootstrap js 切换公共类的所有元素的所有折叠

> ID：10906811
> 
> 赞同：1
> 
> 时间：2012-06-06T00:28:06.343
> 
> 标签：javascript, html, css, twitter-bootstrap

我有一堆元素（代码块）我希望能够使用 twitter-bootstrap 的 javascript 来折叠，例如

```
some text

<div class="highlight">
code code
</div>

some more text text 

<div class="highlight">
code code
</div> 
```

我可以添加以下 javascript 来使所有这些元素崩溃：

```
$('highlight').collapse({
  toggle: true
}) 
```

现在我想添加一个按钮来切换这些元素的折叠/显示。有任何想法吗？

## 解决方案要求

我正在寻找一个解决方案

1.  扩展但不必使用代码块更改原始 html。例如，我不能在代码块周围的“突出显示”div 或更多 div 中添加 id。
2.  在类似的目标中，我希望它适用于所有突出显示类 div。

请注意，使用 twitter bootstrap 中的正常折叠类，例如：

```
<a href="#block1" data-toggle="collapse">toggle</a>
<div class="collapse" id="#block1">
code code
</div> 
```

不会以这种方式概括，因为它需要 id，如果它们重复，它只会切换第一个

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T00:40:17.173

twitter bootstrap 在后台使用 jQuery，因此您应该能够添加一个按钮，然后添加一个单击事件来折叠代码块。

```
<input type="button" value="show/hide" id="toggle_code" />
$(function(){
    $('#toggle_code').click(function(){
        $('.highlight').collapse({
          toggle: true
        })
    });

}); 
```

# javascript - JavaScript 游戏和安全

> ID：10906813
> 
> 赞同：1
> 
> 时间：2012-06-06T00:28:16.997
> 
> 标签：javascript, security, logic

假设我正在使用 JavaScript 制作 HTML5 游戏，并且`<canvas>`变量存储在 DOM 中，例如`level`、`exp`、`current_map`等。

显然，它们可以在客户端使用 Firebug 进行编辑。为了最大限度地提高安全性，我必须做些什么，所以真的很难编辑（和作弊）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T00:31:33.903

如果您希望获得合理的安全级别，请不要将变量存储在 DOM 中。JavaScript，即使被混淆，也可以很容易地被逆向工程。这破坏了任何本地加密机制。

在服务器端存储关键变量并使用 https 来最大限度地提高安全性。即便如此，客户端代码 (JavaScript) 还是很容易受到黑客攻击。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T00:30:44.047

您可以使用`Object.freeze`polyfill 或框架为您进行隐藏。

查看[http://netjs.codeplex.com/](http://netjs.codeplex.com/)

您还可以选择实现某种类型的签名系统，但没有什么是真正难以理解的。例如对象被锁定`Object.freeze`或`Object.watch`仍然可以在内存中手动修改。

你到底想完成什么？

您可以做的是发送游戏矩阵或游戏本身的表示或特殊哈希或两者的组合并在服务器上计算分数......导致用户不仅必须修改分数，而且正确修改游戏状态。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-06T00:54:23.283

可以修改客户端中的任何内容。那是因为在 MMORPG 中角色的数据存在于服务器上，所以玩家不能使用任何记忆工具、十六进制编辑器等来破解他们的角色（他们实际上“可以”，但因为服务器保留了角色数据的正确版本没用）。

一个很好的例子是暗黑破坏神 2：你实际上有两个不同的角色：一个用于单人游戏（和网络与其他玩家一起玩，其中一个是服务器），一个用于战网。在第一种情况下，人们可以“破解”角色的关卡，并指出只是在运行中编辑内存或使用十六进制编辑器编辑角色文件。但这对于您在战网上使用的角色是不可能的。

另一个简单的例子可能是一个测验，你只能在有限的时间内回答。如果您在客户端处理所有事情，玩家可以破解它并修改经过的时间并始终获得最佳分数：因此您还需要将时间戳存储在服务器上，并在获得答案时使用该值作为比较。

总而言之，不管是 JavaScript、C++ 还是汇编语言：规则始终是**“不要依赖客户端”**。如果您需要游戏数据的安全性，则必须使用客户端无法访问的东西：服务器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-06T01:40:41.930

**服务器端游戏逻辑**

您需要将敏感数据保留在服务器上，并将本地副本保留在浏览器上，仅用于显示目的。然后，对于更改这些值的每个操作，服务器应该负责验证它们。例如，如果玩家需要解决一个谜题，您永远不应该验证解决方案客户端，而是将例如表示为字符串的有序棋子的哈希值发送到服务器以验证哈希值是否正确。然后增加玩家的经验/等级并将信息发送回客户端。

# ruby-on-rails - rails t 函数显示 i18n

> ID：10906814
> 
> 赞同：3
> 
> 时间：2012-06-06T00:28:33.143
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, refinerycms

我正在做我的第一个refinerycms 项目，页脚中有这一行：

```
<%= t('.copyright', :year => Time.now.year, :site_name => Refinery::Core.site_name) %> 
```

它在我的网站上显示：

```
i18n: Copyright 
```

i18n 来自哪里，需要 t 函数吗？

编辑：

我的 /config/locales/en.yml 包含以下代码。我是否需要为此添加一些东西，或者最好只是删除 t() 标签？

```
en:
  hello: "Hello world" 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T11:48:55.223

关于您的第二个问题 -`t('.copyright')`期望在您的文件夹树结构下有正确的键（因为它`.`在一开始就有）。例如，如果您的共享文件夹下有一个页脚（完整路径为`app/views/shared/_footer.erb`），那么您的 YML 应该有下一个结构：

```
en:
  shared:
    footer:
      copyright: "All rights reserved. (c) %{site_name} at %{year}" 
```

`%{site_name}`并且`%{year}`是您的值的插值占位符：

```
<%= t('.copyright', :year => Time.now.year, :site_name => Refinery::Core.site_name) %> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-06T00:44:02.997

i18n 它是 Rails 附带的国际化库，它有助于在 Rails 应用程序中的不同位置进行翻译。

t() 这只是对翻译的调用，我认为它实际上是一个别名。

您的语言环境文件夹中应该有一个 yaml 文件，其中有版权，需要一年和一个站点名称。

我猜你改变了位置，所以没有翻译，因为refineryCms 应该只有英文。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T20:24:49.623

该`t`方法是该方法的别名`translate`。它们都可以在[ActionView::Helpers::TranslationHelper](http://api.rubyonrails.org/classes/ActionView/Helpers/TranslationHelper.html)中找到。

假设`options = { :year => Time.now.year, :site_name => Refinery::Core.site_name }`。

由于传递的键以句点开头，`t('.copyright', options)`因此`refinery/_footer.html.erb`视图中的调用实际上是调用`I18n.translate('refinery.footer.copyright', options)`.

`refinery.footer.copyright`现在，可以在[此处](https://github.com/refinery/refinerycms/blob/2.0.10/core/config/locales/en.yml)找到密钥的默认英文翻译。它是`"Copyright © %{year} %{site_name}"`。如果您想覆盖该值，那么我认为最好的方法是在您的`config/locales/en.yml`文件中设置该键。

```
en:
  refinery:
    footer:
      copyright: "My custom copyright text" 
```

# asp.net-mvc - ASP.NET MVC + EF 4.3.1 + DbContext - 一些空关联

> ID：10906815
> 
> 赞同：0
> 
> 时间：2012-06-06T00:29:00.133
> 
> 标签：asp.net-mvc, entity-framework

我正在使用带有 EF 4.3.1 的 ASP.NET MVC 3 和“EF 4.x DbContext Generator for C#”扩展。我正在使用存储库模式。

我遇到的问题是，在某些情况下，我希望 EF 不会填充关联。我需要做些什么来触发所有协会的人口吗？

例如，我有一个包含属性“CompanyPartyId”和“EmployeePartyId”的分配模型。这两个属性都有针对 Party.PartyId 的 FK。这会导致存在两个关联，Party（指向 CompanyPartyId 指定的 Party）和 Party1（指向 EmployeePartyId 指定的 Party）。

出于某种原因，在保存并检索新任务后，党的关联为空。CompanyPartyId 和 EmployeePartyId 属性都设置为存在于 Party.PartyId 中的值。我对其他几个属性/关联有类似的问题；属性不为空且包含有效值，但关联为空。

如果相关，Assignment 使用复合键；CompanyPartyId、EmployeePartyId、AssignmentTypeCode 和 AssignmentStartDate。

我的控制器中的代码如下所示（省略验证和不相关的逻辑）：

```
[HttpPost]
[Authorize(Roles = "assignment_edit")]
public ActionResult Create(AssignmentViewModel assignment)
{
    var newAssignment = assignment.NewAssignment;
    partiesRepository.SaveAssignment(newAssignment);

    var savedAssignment =
        partiesRepository.Assignments.First(x => x.CompanyPartyId == newAssignment.CompanyPartyId &&
                                                 x.EmployeePartyId == newAssignment.EmployeePartyId &&
                                                 x.AssignmentTypeCode == newAssignment.AssignmentTypeCode &&
                                                 x.AssignmentStartDate == newAssignment.AssignmentStartDate);
    var companyPartyId = savedAssignment.CompanyPartyId; // 1
    var companyParty = savedAssignment.Party; // null
    var employeePartyId = savedAssignment.EmployeePartyId; // 2
    var employeeParty = savedAssignment.Party1; // not null

    return View("Index");
} 
```

存储库代码很简单：

```
public IQueryable<Assignment> Assignments
{
    get { return _context.Assignments; }
}

public void SaveAssignment(Assignment assignment)
{
    var data = (from a in _context.Assignments
                where a.CompanyPartyId == assignment.CompanyPartyId
                      && a.EmployeePartyId == assignment.EmployeePartyId
                      && a.AssignmentTypeCode == assignment.AssignmentTypeCode
                      && a.AssignmentStartDate == assignment.AssignmentStartDate
                select a);
    if (!data.Any())
    {
        _context.Assignments.Add(assignment);
    }
    _context.SaveChanges();
} 
```

# wordpress - htaccess 重写帖子子目录

> ID：10906816
> 
> 赞同：0
> 
> 时间：2012-06-06T00:29:08.997
> 
> 标签：wordpress, .htaccess, url, redirect, blogs

我正在将 Wordpress 博客从根 ...com 移动到 ...com/blog/

目前，2010 - 2012 年的所有帖子都以这种方式开始 .com/2010 - .com/2011 - .com/2012

我想只捕获 .com 之后有 2010、2011 和 2012 的网址，并在前面添加博客。

> 例子：
> 
> *www.domain.com/2012/1/post-title/*
> 
> 需要成为
> 
> *www.domain.com/**博客**/2012/1/post-title/*

我仍然在根目录中有 wordpress 页面，并希望确保它们也不会重定向。

这是默认的wordpress htaccess

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule> 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T01:17:17.877

你可以使用类似的东西

```
RewriteRule ^2012/(.*) /blog/2012/$1 [L,R=301] 
```

新的 .htaccess 文件就像

```
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]

RewriteRule ^2010/(.*) /blog/2010/$1 [L,R=301]
RewriteRule ^2011/(.*) /blog/2011/$1 [L,R=301]
RewriteRule ^2012/(.*) /blog/2012/$1 [L,R=301]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L] 
```

我希望上述规则是不言自明的。您可以在 3 行中将上述规则优化为 1 行。

# python - pytest 是否支持“默认”标记？

> ID：10906817
> 
> 赞同：11
> 
> 时间：2012-06-06T00:29:15.210
> 
> 标签：python, pytest

我正在使用 pytest 来测试嵌入式系统的 python 模型。要测试的功能因平台而异。（在这种情况下，我使用“平台”来表示嵌入式系统类型，而不是操作系统类型）。

组织我的测试最直接的方法是根据平台类型将它们分配到目录中。

```
/platform1
/platform2
/etc. 
```

pytest /平台1

这很快变得难以支持，因为许多功能跨平台重叠。从那以后，我将测试移到了一个目录中，每个功能区域的测试都分配给了一个文件名（例如 test_functionalityA.py）。然后我使用 pytest 标记来指示文件中的哪些测试适用于给定平台。

```
@pytest.mark.all_platforms
def test_some_functionalityA1():
    ...

@pytest.mark.platform1
@pytest.mark.platform2
def test_some_functionlityA2():
    ... 
```

虽然我很想*让*'conftest' 自动检测平台类型并只运行适当的测试，但我已经让自己指定在命令行上运行哪些测试。

pytest -m "(platform1 或 all_platforms)"

问题：（终于！）

有没有办法简化事情并让 pytest 默认运行所有未标记的测试，另外所有通过命令行上的“-m”通过的测试？

例如：pytest -m "platform1"

会运行标记为@pytest.mark.platform1 的测试以及标记为@pytest.mark.all_platforms 的所有测试，甚至是根本没有@pytest.mark 的所有测试？

鉴于大量共享功能，能够删除 @pytest.mark.all_platforms 行将是一个很大的帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-06T14:34:57.720

让我们解决完整的问题。我认为您可以将 conftest.py 文件与您的测试一起放置，它会小心跳过所有不匹配的测试（未标记的测试将始终匹配，因此永远不会被跳过）。这里我使用的是**sys.platform**但我相信你有不同的方法来计算你的平台价值。

```
# content of conftest.py
#
import sys
import pytest

ALL = set("osx linux2 win32".split())

def pytest_runtest_setup(item):
    if isinstance(item, item.Function):
        plat = sys.platform
        if not hasattr(item.obj, plat):
            if ALL.intersection(set(item.obj.__dict__)):
                pytest.skip("cannot run on platform %s" %(plat)) 
```

有了这个，你可以像这样标记你的测试::

```
# content of test_plat.py

import pytest

@pytest.mark.osx
def test_if_apple_is_evil():
    pass

@pytest.mark.linux2
def test_if_linux_works():
    pass

@pytest.mark.win32
def test_if_win32_crashes():
    pass

def test_runs_everywhere_yay():
    pass 
```

如果你运行::

```
$ py.test -rs 
```

然后你可以运行它，将看到至少两个测试被跳过，并且总是至少执行一个测试::

然后您将看到两个测试被跳过并按预期执行两个测试::

```
$ py.test -rs # this option reports skip reasons
=========================== test session starts ============================
platform linux2 -- Python 2.7.3 -- pytest-2.2.5.dev1
collecting ... collected 4 items

test_plat.py s.s.
========================= short test summary info ==========================
SKIP [2] /home/hpk/tmp/doc-exec-222/conftest.py:12: cannot run on platform linux2

=================== 2 passed, 2 skipped in 0.01 seconds ==================== 
```

请注意，如果您通过标记命令行选项指定平台，如下所示：

```
$ py.test -m linux2
=========================== test session starts ============================
platform linux2 -- Python 2.7.3 -- pytest-2.2.5.dev1
collecting ... collected 4 items

test_plat.py .

=================== 3 tests deselected by "-m 'linux2'" ====================
================== 1 passed, 3 deselected in 0.01 seconds ================== 
```

那么未标记的测试将不会运行。因此，这是一种将运行限制为特定测试的方法。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2019-04-30T13:16:06.740

聚会迟到了，但我刚刚通过向所有未标记的测试添加默认标记解决了类似的问题。

作为对问题的直接回答：您可以始终运行未标记的测试，并仅包含通过`-m`选项指定的标记测试，方法是将以下内容添加到 conftest.py

```
def pytest_collection_modifyitems(items, config):
    # add `always_run` marker to all unmarked items
    for item in items:
        if not any(item.iter_markers()):
            item.add_marker("always_run")
    # Ensure the `always_run` marker is always selected for
    markexpr = config.getoption("markexpr", 'False')
    config.option.markexpr = f"always_run or ({markexpr})" 
```

# objective-c - Objective-C 目录选择器（OSX 10.7）

> ID：10906822
> 
> 赞同：2
> 
> 时间：2012-06-06T00:29:55.607
> 
> 标签：objective-c, macos, file

所以我目前有这段代码来获取目录：

```
-(NSString *)get {      
  NSOpenPanel *gitDir = [NSOpenPanel openPanel];
  NSInteger *ger = [gitDir runModalForTypes:nil];
  NSString *Directory = [gitDir directory];
  return Directory;
} 
```

但它给了我错误，并说它现在已经贬值了。

OSX 10.7 有更好的方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-06T00:49:38.553

每当您看到弃用警告时，您都应该直接查看官方文档。在这种情况下，[NSOpenPanel 的文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSOpenPanel_Class/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/occ/instm/NSOpenPanel/runModalForTypes%3a)说：

> runModalForTypes：显示面板并开始一个模式事件循环，当用户单击确定或取消时终止。（在 Mac OS X v10.6 中已弃用。改用 runModal。您可以使用 setAllowedFileTypes 设置文件类型：。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-06T21:28:21.253

这是对索斯伯恩答案的补充，而不是替代品。

`runModalForTypes:`已弃用，正确的替换是`runModal`（或`setAllowedFileTypes:`后跟`runModal`，但在这种情况下，您将 nil 传递给类型）。

`directory`也已弃用，正确的替换是`directoryURL`. （如果您实际上必须返回`NSString`路径而不是`NSURL`，则只需返回`[[gitDir directoryURL] path]`。）

但是，您正在做的是要求用户选择一个文件，然后返回该文件所在的目录，而您真正想要的是要求用户选择一个目录。为此，您需要调用`setCanChooseFiles`to`NO`和`setCanChooseDirectories`to `YES`，然后调用 URL 以获取用户选择的目录。

此外，您忽略了`runModal`（或`runModalForTypes:`）的结果。我确定编译器会警告您有关未使用的变量“ger”，您不应该只是忽略警告。如果用户取消面板，您将把它视为单击确定，然后选择她取消时碰巧所在的目录。

这是一个更好的实现，它将返回所选目录的 URL，如果用户取消（或以某种方式设法不选择任何内容），则返回 nil。同样，如果您需要一个`NSString`，只需在 return 语句中添加一个“路径”调用：

```
-(NSURL *)get {      
   NSOpenPanel *panel = [NSOpenPanel openPanel];
   [panel setAllowsMultipleSelection:NO];
   [panel setCanChooseDirectories:YES];
   [panel setCanChooseFiles:NO];
   if ([panel runModal] != NSModalResponseOK) return nil;
   return [[panel URLs] lastObject];
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-01-29T19:24:59.093

我改编了 abarnert 的代码以实现 swift。tx 的代码正是我需要的。

```
func askUserForDirectory() -> NSURL? {
        let myPanel:NSOpenPanel = NSOpenPanel()
        myPanel.allowsMultipleSelection = false
        myPanel.canChooseDirectories = true
        myPanel.canChooseFiles = false
        if ( myPanel.runModal() != NSFileHandlingPanelOKButton ) {
            return nil
        }
        return myPanel.URLs[0] as? NSURL
    } 
```

# android - 程序运行缓慢，因为有很多对象。

> ID：10906827
> 
> 赞同：0
> 
> 时间：2012-06-06T00:30:40.450
> 
> 标签：android, layout, imageview

我有一个简单的游戏，这个游戏是关于保护婴儿免受苍蝇的侵害，所以我们必须点击苍蝇杀死它并拯救婴儿。苍蝇正在使用imageview。

但是我有一个问题，我有一个每秒创建一个飞行的计时器，所以如果在级别 1 中是 50seconds ，那么我的布局中有 50 个图像视图。

这使我的程序运行如此缓慢。

如何解决这个问题呢？当图像视图超出布局时，我应该删除它吗？但是代码是什么？我不能使用删除视图，因为它打开了 Windows 类文件编辑器。

任何帮助/提示表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T00:35:10.037

试试[这个](https://stackoverflow.com/questions/3805599/add-delete-view-from-layout)

我相信这是一个非常简单的解决方案

```
mViewStub.setVisibility(View.GONE); 
```

然后当它从视线中移除时释放内存。

# javascript - 使用 javascript 定位黑莓 5

> ID：10906833
> 
> 赞同：0
> 
> 时间：2012-06-06T00:32:26.180
> 
> 标签：javascript, jquery, blackberry

我想针对所有黑莓设备做一些特定于设备的更改。以下是我编写的代码，显然不起作用。谢谢。

```
<script type="text/javascript">
    var isMobile = {
    BlackBerry: function() {
        var ua = "BlackBerry9000/5.0.0.93 Profile/MIDP-2.0 Configuration/CLDC-1.1 VendorID/179";
        return navigator.ua.match(/^BlackBerry[0-9]*/) ? true : false;
    },
    iOS: function() {
        return navigator.userAgent.match(/iPhone|iPad|iPod/i) ? true : false;
    },
    Windows: function() {
        return navigator.userAgent.match(/IEMobile/i) ? true : false;
    },
    any: function() {
        return (isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Windows());
    }
};

if( isMobile.BlackBerry() ) {
    $('body').css('background','green');
    $('div.send-to-friend-form').css('display', 'block');
    $('a#add_body_hidden').hide();

} 
```

编辑：我得到了答案并且已经在工作了。当stackoverflow允许我这样做的时候，我会在几天后发布它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T00:47:35.567

我通常不赞成用户代理测试，更喜欢特定的功能或能力检测，因为它更准确、更持久。

但是，RIM 建议您检测黑莓设备的方法如下：http: [//supportforums.blackberry.com/t5/Web-and-WebWorks-Development/How-to-detect-the-BlackBerry-Browser/ta-p/559862](http://supportforums.blackberry.com/t5/Web-and-WebWorks-Development/How-to-detect-the-BlackBerry-Browser/ta-p/559862)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T23:14:14.930

我写了一个函数来回答问题并为我工作。

```
<!-- target the blackberry device --> 
```

```
var isMobile = {
    BlackBerry: function() {
        var ua = navigator.userAgent;
        return (ua.indexOf("BlackBerry") >= 0) ? true : false;
    } // you can add more tests here for other phones
};

if( isMobile.BlackBerry() ) {
    $('div.send-to-friend-form').css('display', 'block');
    $('a#add_body_hidden').remove();
} 
```

# c - 搜索给定文件的基本 URL

> ID：10906834
> 
> 赞同：0
> 
> 时间：2012-06-06T00:32:45.127
> 
> 标签：c

需要一些帮助

1.  如何使用 C 程序获取主目录（例如 /home//
2.  如何将主目录与其他目录（/Desktop/ 并打开它，因为我想合并为 /home//Desktop/ 和 fopen(/home//Desktop//text.txt,"rw")

感谢您的建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T00:42:32.167

我假设这是Linux（或类似的）。

主目录的路径可以在`HOME`环境变量中找到，您可以使用[`getenv(3)`](http://linux.die.net/man/3/getenv).

# c++ - 错误：'->' 标记之前的预期 unqualified-id

> ID：10906835
> 
> 赞同：1
> 
> 时间：2012-06-06T00:32:49.910
> 
> 标签：c++, linked-list

它给了我第 21 行和第 22 行的错误，这是我已经注意到的。从其他具有类似错误消息的案例来看，我在某处遇到了语法错误。我只是不知道是什么.. 这是我的 .cpp 文件：

```
#include <iostream>
#include <cstdlib>

#include "deque.h"

using namespace std;

struct node{
    int data;
    node *prev;
    node *next;
};

Deque::Deque(){
    count = 0;

    node->head->next = node->head;         //error on this line
    node->head->prev = node->head;         //and this one
} 
```

这是我的头文件：

```
# ifndef DEQUE_H
# define DEQUE_H

class Deque
{
private:
    int count;
    class node *head;
public:
    Deque();
    ~Deque();
    int size();
    void addFirst(int);
    void addLast(int);
    int removeFirst();
    int removeLast();
    int getFirst();
    int getLast();

};
#endif 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T00:37:54.740

这些行的正确代码：

```
head->next = head;
head->prev = head; 
```

Your variable is named `head`, and `node` is its type, but there is no member named `node` in your class `Deque`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T00:35:46.203

1.  `struct node`没有名为 的成员`head`，这是一个问题。
2.  你的`node`变量来自哪里`Dequeue()`？鉴于您发布的代码，看起来未定义。 `node`是一种类型，而不是变量。
3.  在 C++ 中，不需要在结构类型变量的每个声明前加上`struct`. 如果它需要与 C 兼容，您也可以始终`typedef`使用该结构。

# javascript - Javascript加载另一个js文件

> ID：10906836
> 
> 赞同：2
> 
> 时间：2012-06-06T00:33:15.323
> 
> 标签：javascript

我正在尝试从 JS 文件加载另一个 JS 文件。

从我的 JavaScript 文件**run.js**，我有以下内容：

```
document.write("<script type='text/javascript' src='my_script.js'></script>");
alert(nImages); 
```

在**my_script.js**中，我有以下内容：

```
<SCRIPT language="JavaScript" type="text/javascript">
<!--
nImages = 6;
//-->
</SCRIPT> 
```

但我似乎无法让它提醒`nImages`from **my_script.js**文件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T02:20:01.810

你可以这样做：

```
var script = document.createElement('script');
script.src = 'my_script.js';
script.type = 'text/javascript';

script.onload = function () {
    alert(nImages);
};

document.getElementsByTagName('head')[0].appendChild(script); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-06T00:35:49.043

您不应该在脚本文件中使用 HTML。你的脚本文件 my_script.js 应该只有这个。

```
nImages = 6; 
```

附加说明：您不需要`language="JavaScript"`or`<!--`或`//-->`。这些是现代浏览器（甚至 IE6）不需要的旧约定。我也会避免`document.write()`在你的 JS 中使用，因为它会影响性能。您可能想查看诸如[RequireJS](http://requirejs.org/)之类的库，它提供了一种在页面中加载其他 JS 文件的更好方法。

我在 Github 上也有一个受 Steve Souders 启发的[代码片段，](https://gist.github.com/817519)它通过直接 JS 加载另一个文件。

```
var theOtherScript = 'http://example.com/js/script.js';

var el = document.createElement('script');
el.async = false;
el.src = theOtherScript;
el.type = 'text/javascript';

(document.getElementsByTagName('HEAD')[0]||document.body).appendChild(el); 
```

这会将其他脚本附加到元素（如果存在）或页面的元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T00:38:17.477

Javascript 文件中不应包含 HTML。它们应完全由 Javascript 代码组成，`so my_script.js`应仅包含：

```
nImages = 6; 
```

这仍然不起作用，因为当您将新的脚本标签写入文档时，它不会立即运行。保证在开`run.js`​​始之前完成运行`my_script.js`，所以`nImages`当你警告它时是未定义的，然后变成6。你会看到这行得通：

```
document.write("<script type='text/javascript' src='my_script.js'></script>");

function call_on_load(){
    alert(nImages);
} 
```

如果内容`my_script.js`是：

```
nImages = 6;
call_on_load(); 
```

**编辑**

既然您在评论中说您不能编辑`my_script.js`，您可以这样做，尽管它不是一个很好的解决方案：

```
// Force nImages to be undefined
var undefined;
window.nImages = undefined;

document.write("<script type='text/javascript' src='my_script.js'></script>");

(function is_loaded(cb){
    if(typeof window.nImages == 'undefined')
        setTimeout(function(){ is_loaded(cb); }, 100);
    else
        cb();
})(function(){
    // This is executed after the script has loaded
    alert(nImages);
}); 
```

然而，这不是一个好的解决方案，因为如果加载脚本出错，它将无限期地继续轮询。

**编辑**

您在评论中发布了要包含的文件，该文件`<SCRIPT`位于顶部。这个文件没用，你不能在客户端做任何事情。您必须编写一个服务器端脚本来将文件作为文本加载，在这种情况下，您可以将其解析为您想要的值。

# linux - Ubuntu 12.04 中的 /usr/include/machine 目录发生了什么？

> ID：10906838
> 
> 赞同：1
> 
> 时间：2012-06-06T00:33:24.853
> 
> 标签：linux, ubuntu

我正在尝试使用原始 makefile 构建/编译一个旧项目。当我这样做时，我收到以下错误：

```
 *** No rule to make target `/usr/include/machine/param.h' 
```

我的操作系统是 Ubuntu 12.04。似乎有很多 param.h 文件，但没有 /usr/include/machine 目录。有谁知道我应该使用哪些现有的 param.h 文件（如果有的话）？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T00:45:26.520

我不记得以前的`/usr/include/machine/`目录了……但就是说，试试`/usr/include/linux/param.h`.

# r - 在 R 中绘制随机森林模型的重要性变量

> ID：10906841
> 
> 赞同：4
> 
> 时间：2012-06-06T00:33:50.667
> 
> 标签：r, subscript, random-forest

我在这里做错了什么？“下标越界”是什么意思？

我从革命 R 在线研讨会中获得了以下代码（第一个块）摘录，该研讨会有关 R 中的数据挖掘。我试图将其合并到我运行的 RF 模型中，但无法通过我认为的变量排序。我只想绘制变量的重要性。

我在下面提供了更多内容以提供上下文。但我真正错误的是第三行代码。第二个代码块是应用于我正在处理的数据时遇到的错误。谁能帮我解决这个问题？

```
 -------------------------------------------------------------------------
# List the importance of the variables.
rn <- round(importance(model.rf), 2)
rn[order(rn[,3], decreasing=TRUE),]
##@# of 
# Plot variable importance
varImpPlot(model.rf, main="",col="dark blue")
title(main="Variable Importance Random Forest weather.csv",
            sub=paste(format(Sys.time(), "%Y-%b-%d %H:%M:%S"), Sys.info()["user"])) 
#-------------------------------------------------------------------------- 
```

我的错误：

```
> rn[order(rn[,2], decreasing=TRUE),]
Error in order(rn[, 2], decreasing = TRUE) : subscript out of bounds 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-06T06:23:33.340

我想我理解这种困惑。我打赌你是一个 4 指的 Kit Kat，如果你输入，`ncol(rn)`你会看到 rn 有 2 列，而不是你想象的 3 列。您在屏幕上看到的第一个“列”并不是真正的列——它只是对象 rn 的**行名**。键入`rownames(rn)`以确认这一点。因此，您要排序的 rn 的最后一列是 rn[,2] 而不是 rn[,3]。出现“下标越界”消息是因为您已要求 R 按第 3 列排序，但 rn 没有第 3 列。

对于任何对“重要性”对象实际上是什么感兴趣的人，这是我的简短侦探线索……我安装了 library(randomForest)，然后从在线文档中运行了一个示例：

```
set.seed(4543)
data(mtcars)
mtcars.rf <- randomForest(mpg ~ ., data=mtcars, ntree=1000, 
             keep.forest=FALSE, importance=TRUE)
importance(mtcars.rf) 
```

在这种情况下，“重要性”对象看起来像这样（前几行只是为了节省空间）：

```
 %IncMSE IncNodePurity
cyl  17.058932     181.70840
disp 19.203139     242.86776
hp   17.708221     191.15919
... 
```

显然 ncol(importance(mtcars.rf)) 是 2，并且行名很可能是导致混淆的东西:)

# iphone - 简单的 Cocos2d iPhone 游戏。只是一些基本问题

> ID：10906842
> 
> 赞同：1
> 
> 时间：2012-06-06T00:33:53.810
> 
> 标签：iphone, ios, xcode, cocos2d-iphone

我正在制作一个应用程序，精灵必须在屏幕上运行，按下按钮并跳跃和闪避。有点像线跑者。无论如何，我正在使用 cocos2d。这是我应该使用的。如果是，我将如何做到。我不是要所有代码，只是基本目标和我应该做什么！非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T02:26:41.783

Cocos2d 是制作游戏的最佳平台之一，我认为你想做的事情可以由 cocos2d 完成，你需要知道如何在场景中移动对象（精灵）以及如何检测排序规则。

有很多方法可以在屏幕上移动精灵，你也可以通过 cocos2d 内置方法移动。

搜索对您有帮助的移动方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T11:01:47.553

如果你需要在游戏中进行真正的物理模拟，我肯定会建议你使用**Cocos2d**和**Box2d 。**

关于编写游戏，请看[这里](http://www.raywenderlich.com/tutorials)：它包含非常有用的 cocos2d 教程，甚至还有如何编写功能齐全的游戏的教程（寻找猴子游戏）

注意：似乎该链接现在不起作用，但我相信它会很快修复..

# android - 将空上下文传递给数据库助手

> ID：10906843
> 
> 赞同：0
> 
> 时间：2012-06-06T00:34:07.803
> 
> 标签：android, sqlite

我有一个静态函数，每当我的后台服务获得新位置时就会调用它。在这个函数中，我想获取传入的坐标并将它们保存在我的数据库中。我可以通过“null”作为上下文来创建数据库助手的实例，还是有更好的方法来做到这一点。谢谢。

```
public static void locationHasChanged() {
    final wd_DatabaseHelper helper = new wd_DatabaseHelper(null, "myDB.db", null, 1);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T01:06:05.937

可能不是。通常，您的数据库助手会扩展`SQLiteOpenHelper`并且上下文将用于调用`openOrCreateDatabase()`或`getDatabasePath()`. 如果没有看到 wd_DatabaseHelper 的代码，我不能肯定地说，但是拥有空上下文绝不是一个好主意。自己看看... [SQLiteOpenHelper 的来源](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.1_r2/android/database/sqlite/SQLiteOpenHelper.java)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T07:26:51.927

由于 android Service 是一个上下文，因此您可以将“服务的 this”传递给您的方法

```
public class MyLocationHelper {
public static void locationHasChanged(Context context) {
    final wd_DatabaseHelper helper = new wd_DatabaseHelper(context, "myDB.db", null, 1);
    ....
}
}

public class MyService extends Service {

    private void onLocationHasChanged()
    {
        MyLocationHelper.locationHasChanged(this);
    }
} 
```

# objective-c - 在循环中查找和更改字符串上的数字后缀

> ID：10906845
> 
> 赞同：1
> 
> 时间：2012-06-06T00:34:25.643
> 
> 标签：objective-c, nsstring

必须有一种比我想要的更简单的方法来进行简单的字符串操作。我有一种方法允许用户复制目录中的文件。如果他们在表格视图中选择它并按下克隆按钮，则会保存文件的副本，并且文件名将附加子字符串 Copy。如果 Copy 已经存在，那么我们需要迭代文件名并通过循环迭代附加文件名。例如;

```
<filename> Copy 1
<filename> Copy 2
until my other method return that the name is unique. 
```

我需要检查传入的文件名的三个标准；它是否已经附加了“复制”是否已经附加了一个字符串数字如果是，获取数字的值将其迭代一并放回。

过了好一阵子，我只能想出这个：

```
//Tokenize the string
NSArray *filenameArray =[copyName componentsSeparatedByString:@" "];

//Make sure the name is unique
//Update the namesArray
[self montageNameList];
int i = 1;
for(NSString * name in self.montageNames){

    if([channelSetManager_ checkNoDuplicateName:self.montageNames forThisName:copyName]== YES){
        break;
    }else{

        if([[filenameArray lastObject]isEqualToString:@"Copy"]){

            //Just add a number to the end of the string
            copyName = [copyName stringByAppendingFormat:@" %d", i];

        }else if(([[filenameArray lastObject]intValue] > -1) && ([[filenameArray lastObject]intValue] < 100)){

            i = [[filenameArray lastObject]intValue]+1;
            NSInteger len = [[filenameArray lastObject]length]+1;
            copyName = [copyName substringToIndex:[copyName length] - len ];
            copyName = [copyName stringByAppendingFormat:@" %d",i];
        }

    }

} 
```

这可行，但似乎不是正确的方法。任何意见是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T01:14:07.417

过去我使用创建了一个临时文件`mkstemp()`，然后将临时文件链接到永久文件，如果链接失败且文件存在，则尝试下一个文件名，重复直到链接成功，然后取消链接临时文件。

```
// Finds next available copy name and creates empty file as place holder
- (NSString *) createCopyFileWithBasename:(NSString *)baseName andSuffix:(NSString *)suffix
{
    char tmpFile[1024];
    char copyFile[1024];
    int  fd;
    int  count;

    // create unique temporary file
    snprintf(tmpFile, 1024, "%s.XXXXXXXX", [baseName UTF8String]);
    if ((fd = mkstemp(tmpFile)) == -1)
    {
       NSLog(@"mkstemp(): %s", strerror(errno));
       return(nil);
    };
    close(fd);

    // attempt to create empty file for file copy
    snprintf(copyFile, 1024, "%s Copy.%s", [baseName UTF8String], [suffix UTF8String]);
    switch(link(tmpFile, copyFile))
    {
       case EEXIST: // file exists, skip to next possible name
       break;

       case: 0: // excellent, we found an available file name
       unlink(tmpFile);
       return([NSString stringWithUTF8String:copyFile]);

       default:
       NSLog(@"link(): %s", strerror(errno));
       unlink(tmpFile);
       return(nil);
    };

    // loop through possible iterations of file copy's name
    for(count = 1; count < 1024; count++)
    {
       snprintf(copyFile, 1024, "%s Copy %i.s", [baseName UTF8String], count, [suffix UTF8String]);
       switch(link(tmpFile, copyFile))
       {
          case EEXIST: // file exists, skip to next possible name
          break;

          case: 0: // excellent, we found an available file name
          unlink(tmpFile);
          return([NSString stringWithUTF8String:copyFile]);

          default:
          NSLog(@"link(): %s", strerror(errno));
          unlink(tmpFile);
          return(nil);
       };
    };

   unlink(tmpFile);
   NSLog(@"link(): %s", strerror(errno));

   return(nil);
} 
```

示例用法：

```
NSString copyFileName = [self createCopyFileWithBasename:@"My Data" andSuffix:@".txt"]; 
```

# c# - 是否有类似 Intranet 范围的 GAC 的东西？

> ID：10906847
> 
> 赞同：0
> 
> 时间：2012-06-06T00:34:54.753
> 
> 标签：c#, .net-assembly

我是否可以将 .NET 程序集部署到某个位置，以便所有相关程序现在只要引用该位置就可以使用它。

如果它没有内置到框架中，是否有另一种机制或方法来实现相同的目标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T00:54:03.643

是*的（有点）* - 但你必须自己设置。

.Net 程序可以搜索AppDomain 基目录**下的指定目录。**它被称为[探测路径](http://msdn.microsoft.com/en-us/library/823z9h8w%28v=vs.80%29.aspx)。重要的是要注意它必须**在**目录下。

```
<configuration>
    <runtime>
        <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
            <probing privatePath="MySpecialPath"/>
        </assemblyBinding>
    </runtime>
</configuration> 
```

因此，我们只需在应用程序目录 (MySpecialPath) 下放置一个符号链接，它就会愉快地使用中央目录。当然，因为 .net 总是首先查看 GAC - 您不能为 GAC 程序集执行此操作。

我还用它来解决旧的[MS Test AppDomain 问题](http://preetsangha.blogspot.co.nz/2008/06/getting-round-visual-studio-2008-mstest.html)（我的博客）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T00:40:10.933

不。

将其部署在每个应用程序 bin 目录或具有特定版本号的 GAC 中。依赖的应用程序应该寻找那个特定的版本。

# android - FrameLayout 中的布局参数无效：layout_weight

> ID：10906850
> 
> 赞同：3
> 
> 时间：2012-06-06T00:35:32.820
> 
> 标签：android, android-layout

当我运行以下布局时，我在 Eclipse 中收到一个编译器警告，上面写着：

FrameLayout 中的布局参数无效：layout_weight

有任何想法吗？

```
 <?xml version="1.0" encoding="utf-8"?>
<TabHost xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@android:id/tabhost" android:layout_width="fill_parent"
    android:layout_height="fill_parent">
    <LinearLayout android:orientation="vertical"
        android:layout_width="fill_parent" android:layout_height="fill_parent">
        <TabWidget android:id="@android:id/tabs"
            android:layout_width="fill_parent" android:layout_height="wrap_content" />
        <FrameLayout android:id="@android:id/tabcontent"
            android:layout_width="fill_parent" android:layout_height="fill_parent">
            <ListView android:id="@+id/list1" android:layout_width="fill_parent"
                android:layout_height="wrap_content" android:layout_weight="1">
            </ListView>
            <ListView android:id="@+id/list2" android:layout_width="fill_parent"
                android:layout_height="wrap_content" android:layout_weight="1">
            </ListView>
        </FrameLayout>
    </LinearLayout>
</TabHost> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T00:44:46.083

从您的列表视图中删除 layout_weight 标注（或将它们包装在线性布局中）。

正如它告诉你的那样，当直接父布局是框架布局时，它是无效的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-06T00:46:10.200

这是来自 Android 文档的直接引用 - [FrameLayout](http://developer.android.com/reference/android/widget/FrameLayout.html)

> 通常，应该使用 FrameLayout 来保存单个子视图，因为很难以一种可缩放到不同屏幕尺寸的方式来组织子视图，而不会使子视图相互重叠。但是，您可以使用 android:layout_gravity 属性将多个子项添加到 FrameLayout 并通过为每个子项分配重力来控制它们在 FrameLayout 中的位置。

尝试使用`android:layout_gravity`而不是`android:layout_weight`.

# asp.net - 表单提交 MVC 3 asp.NET 后 URI 错误

> ID：10906860
> 
> 赞同：0
> 
> 时间：2012-06-06T00:36:30.877
> 
> 标签：asp.net, asp.net-mvc-3, url-routing

我对这里的一些事情有点困惑。我有一个表格，该表格的 URL 是：

```
http://domain.com/Home/requestquote 
```

当我单击表单上的提交并且位于表单控制器中处理此表单的方法发送回一个视图时，URI 如下所示：

`http://domain.com/form/requestQuoteSubmit`方法在哪里`requestQuoteSubmit`。

当验证将页面发回错误时以及表单提交成功时都会发生这种情况。

成功时发送回的视图是`Home/thanks`错误的，它应该只是发送回来`Home/requestquote`。一切似乎都工作正常，除了 URI 不是它应该是的事实。这会导致页面上的所有其他内容中断，因为我的链接如下所示：

```
@Url.RouteUrl(Model.CompanyPageDatabaseModel.companyCode, new { Controller = MVC.services.Name, Action = MVC.services.ActionNames.page }) 
```

因此， companyCode 值没有正确传递并正确形成链接。我不确定表单方法如何或为什么发送回正确的页面，但将 URI 设置为自身？

这是我的路线。

```
 public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        routes.MapRoute(
            null,
            "{action}",
            new { controller = MVC.Home.Name, action = MVC.Home.ActionNames.Index },
            new { RootAction = new RootActionConstraint() }  // Route Constraint
        );

        routes.MapRoute(
            null, // Route name
            "{controller}/{action}", // URL with parameters
            new { controller = MVC.Home.Name, action = MVC.Home.ActionNames.Index }, // Parameter defaults
            new { controller = "Home|contact|franchise|form|resources|services|technology|community|careers|carriers|about" }
        );

        routes.MapRoute(
           null,
           "{companyCode}/{action}",
           new { controller = MVC.Home.Name, action = MVC.Home.ActionNames.Index },
           new { RootAction = new RootActionConstraint() }  // Route Constraint
       );

        routes.MapRoute(
            "jax",
            "{companyCode}/{controller}/{action}",
            new { controller = MVC.Home.Name, action = MVC.Home.ActionNames.Index }
        ); 
```

最后一个路线值是特许经营路线的示例。

这里也是视图中的表单代码：

```
 @using (Html.BeginForm("requestquote", "form", FormMethod.Post))
    {   } 
```

有任何想法吗？

谢谢。

编辑：在我的路线中添加。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T07:08:31.183

有一个概念称为 PRG，它代表**Post-Redirect-Get**。

基本思想是您将表单**发布**到您的应用程序。处理完输入后，您将**重定向**到正确 URL 处的**Get**请求，而不是直接从提交中为用户提供内容响应。

这有很多原因，但根本原因是关注点分离。（如果您不区分关注点，就会发生奇怪的事情，例如您页面上的所有链接都可能中断......）

因此，您的解决方案是处理提交，如果无效，则将您的验证内容存储`TempData`并返回`RedirectToRouteResult(controller:"Home",action:"RequestQuote")`

**更新：**我找到了我阅读的原始文章来学习这个概念。就原始 ASP.NET MVC 版本而言，它应该是大致相同的。查看[http://www.eworldui.net/blog/post/2008/05/ASPNET-MVC---Using-Post2c-Redirect2c-Get-Pattern.aspx](http://www.eworldui.net/blog/post/2008/05/ASPNET-MVC---Using-Post2c-Redirect2c-Get-Pattern.aspx)

# json - 使用 Play 框架 ScalaJsonGenerics vs Jerkson 反序列化

> ID：10906861
> 
> 赞同：1
> 
> 时间：2012-06-06T00:36:31.913
> 
> 标签：json, playframework

在使用 play 框架时，我似乎对如何正确反序列化 json 感到困惑。使用 jerkson，您似乎只需要定义一个案例类，然后自动反序列化一个 json 字符串（从 jerkson 文档中窃取）。

```
case class Person(id: Long, name: String)
parse[Person]("""{"id":1,"name":"Coda"}""") //=> Person(1,"Coda") 
```

但是，使用 play 框架，您必须编写大量样板代码来做同样的事情。例如从他们的文档中。

```
case class Foo(name: String, entry: Int) 

object Foo {
  implicit object FopReads extends Format[Foo] {
    def reads(json: JsValue) = Foo(
      (json \ "name").as[String],
      (json \ "entry").as[Int])
    def writes(ts: Foo) = JsObject(Seq(
      "name" -> JsString(ts.name),
      "entry" -> JsNumber(ts.entry)))
    }
 } 
```

这似乎需要做更多的工作，所以我认为我要么没有正确使用它，要么不太了解这样做的好处。有没有捷径让我不必编写所有这些代码？如果不是，我应该在我的 Action 中使用 jerkson 来解析传入的 json 字符串吗？似乎 asText 正在返回一个空白字符串，即使 asJson 工作得很好......这让我相信我肯定做错了什么。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T18:41:06.110

我认为你的问题有两个答案。

1.  对于较少的样板，您可以使用 Play 支持来处理案例类。这是具有三个字段的案例类的示例：

    隐式 val SampleSetFormat: Format[SampleSet] = productFormat3("sensorId", "times", "values")(SampleSet)(SampleSet.unapply)

2.  我同意有更多令人讨厌的样板，这是 Play 人员似乎使用这种方法的主要原因，因此他们可以完全在编译时确定正确的序列化程序。因此，无需像 Jerkson 那样进行反思。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T00:17:43.423

我完全是 Play 和 Jerkson 的菜鸟，但全心全意地建议使用最少的样板方法（在每个动作中使用 Jerkson 库）。我发现这样做在哲学上更符合 Scala，而且效果很好。

# .htaccess - htaccess mod_rewrite 问题，我的文件有什么问题？

> ID：10906863
> 
> 赞同：0
> 
> 时间：2012-06-06T00:36:45.190
> 
> 标签：.htaccess, mod-rewrite

我的 .htaccess 文件有什么问题？

```
RewriteEngine on
RewriteRule ^/([a-zA-Z]+)/([0-9]+)$ index.php?mode=$1&id=$2 [L] 
```

基本上我希望它从 example.com/?mode=page&id=1 到 example.com/page/1

据我所知，它应该可以工作，但它没有......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T00:39:58.907

1.  `/`从规则中删除前导
2.  在行`RewriteBase /`后添加`RewriteEngine`

# actionscript-3 - as3 Scale Stage 但不是内容

> ID：10906868
> 
> 赞同：0
> 
> 时间：2012-06-06T00:38:09.730
> 
> 标签：actionscript-3, flash, scale

有没有办法让舞台适合浏览器的整个屏幕但将对象保持在中间而不缩放它们？

我下面的代码适用于舞台比例，但我的角色也在缩放。我怎样才能让他独立并且不受屏幕大小和搭配的影响？谢谢

```
import flash.display.StageAlign;
import flash.display.StageScaleMode;

import fl.transitions.Tween;
import fl.transitions.easing.*;
import fl.transitions.TweenEvent;
import flash.display.*;
import flash.media.Sound;
import flash.media.SoundChannel;
////////////////////////////////////

stage.scaleMode = StageScaleMode.EXACT_FIT;
stage.align = StageAlign.TOP_LEFT;

var ScreenY = flash.system.Capabilities.screenResolutionY;
var ScreenX = flash.system.Capabilities.screenResolutionX;

blueBG.width = ScreenX;
blueBG.addEventListener(MouseEvent.CLICK, fl_ClickToLoadUnloadSWF);

var Beau:Loader = new Loader();
Beau.load(new URLRequest("/Beau.swf"));
Beau.contentLoaderInfo.addEventListener(Event.COMPLETE, loadBG);
function loadBG(e:Event):void
{

}

//This variable keeps track of whether you want to load or unload the SWF
var fl_ToLoad:Boolean = true;

function fl_ClickToLoadUnloadSWF(event:MouseEvent):void
{
    if(fl_ToLoad)
    {
        var my_mc:MovieClip = new MovieClip(); 
         addChild(my_mc);
        my_mc.addChild(Beau);
        my_mc.scaleMode = StageScaleMode.NO_SCALE;
        var ED = ScreenY /2;
        Beau.height = ED;
        Beau.scaleX = Beau.scaleY;
        Beau.y = 0;

    }
    else
    {
        Beau.unload();
        removeChild(Beau);
        Beau = null;
        blueBG.alpha = 0;
    }
    // Toggle whether you want to load or unload the SWF
    fl_ToLoad = !fl_ToLoad;
} 
```

这是我的 HTML：

```
<div id="flashContent">
            <object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" width="100%" height="100%" id="BeauFillScreen" align="middle">
                <param name="movie" value="BeauFillScreen.swf" />
                <param name="quality" value="best" />
                <param name="bgcolor" value="#ffffff" />
                <param name="play" value="true" />
                <param name="loop" value="true" />
                <param name="wmode" value="transparent" />
                <param name="scale" value="noscale" />
                <param name="menu" value="true" />
                <param name="devicefont" value="false" />
                <param name="salign" value="" />
                <param name="allowScriptAccess" value="sameDomain" />
                <!--[if !IE]>-->
                <object type="application/x-shockwave-flash" data="BeauFillScreen.swf" width="100%" height="100%">
                    <param name="movie" value="BeauFillScreen.swf" />
                    <param name="quality" value="best" />
                    <param name="bgcolor" value="#ffffff" />
                    <param name="play" value="true" />
                    <param name="loop" value="true" />
                    <param name="wmode" value="transparent" />
                    <param name="scale" value="noscale" />
                    <param name="menu" value="true" />
                    <param name="devicefont" value="false" />
                    <param name="salign" value="" />
                    <param name="allowScriptAccess" value="sameDomain" />
                <!--<![endif]-->
                    <a href="http://www.adobe.com/go/getflash">
                        <img src="http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif" alt="Get Adobe Flash player" />
                    </a>
                <!--[if !IE]>-->
                </object>
                <!--<![endif]-->
            </object>
        </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T00:42:33.463

您需要`NO_SCALE`在`stage`. 就这些。

```
stage.scaleMode = StageScaleMode.NO_SCALE; 
```

消除：

```
my_mc.scaleMode = StageScaleMode.NO_SCALE; 
```

# java - 如何制作不同尺寸的秋千组件

> ID：10906885
> 
> 赞同：0
> 
> 时间：2012-06-06T00:41:08.717
> 
> 标签：java, swing, user-interface, layout, layout-manager

如何在 java 中为 Swing 组件制作特定尺寸？gui应该看起来像这样......

```
+++++++++++++++++
+  TextField    +
+++++++++++++++++
+               +
+  TextPane     +
+               +
+++++++++++++++++
+Button +Button +
+++++++++++++++++ 
```

我已经尝试过`BorderLayout`, `GridLayout`, nested`JPanels`等，但我无法获得一个好看的 gui，其中 gui`JButtons`不像砖块，`JTextField`也不是文本大小的三倍。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T06:14:56.740

部分取决于您希望如何分配额外的空间。此 GUI 为文本字段和文本区域提供额外的宽度，同时保持按钮居中。文本区域被赋予了额外的高度。

![基本布局](../Images/c1ae2e35a04b2ed9eadb7e75885b1d69.png)

```
import java.awt.BorderLayout;
import java.awt.FlowLayout;
import javax.swing.*;

public class BasicLayout {

    BasicLayout() {
        JPanel gui = new JPanel(new BorderLayout(2,2));

        gui.add(new JTextField(), BorderLayout.PAGE_START);
        gui.add(new JTextArea(3,15));

        JPanel controls = new JPanel(new FlowLayout(FlowLayout.CENTER,5,5));
        controls.add(new JButton("Button1"));
        controls.add(new JButton("Button2"));

        gui.add(controls, BorderLayout.PAGE_END);

        JOptionPane.showMessageDialog(null, gui);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new BasicLayout();
            }
        });
    }
} 
```

## 更新

一开始我以为你说的是`JTextArea`​​中间部分，后来我仔细看了看。A`JTextPane`的大小有点棘手，因为它不接受构造函数中的大小提示。为此，我们可以为其调整容器的首选大小（在本例中为`JScrollPane`.

```
import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.FlowLayout;
import javax.swing.*;

public class BasicLayout {

    BasicLayout() {
        JPanel gui = new JPanel(new BorderLayout(2,2));

        gui.add(new JTextField(), BorderLayout.PAGE_START);
        JTextPane text = new JTextPane();
        JScrollPane scroll = new JScrollPane(text);
        Dimension d = text.getPreferredSize();
        scroll.setPreferredSize(new Dimension(d.width, d.height*3));
        gui.add(scroll);

        JPanel controls = new JPanel(new FlowLayout(FlowLayout.CENTER,5,5));
        controls.add(new JButton("Button1"));
        controls.add(new JButton("Button2"));

        gui.add(controls, BorderLayout.PAGE_END);
        JOptionPane.showMessageDialog(null, gui);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new BasicLayout();
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T05:11:22.927

如果您正在寻找在 Netbeans 中设计 GUI，这是可能的。创建 Java 项目后，选择项目并转到：

```
File > New File 
```

然后将出现对话框（您已经知道）。

在类别中，选择`Swing GUI Forms`然后从选项中选择您想要的任何内容

这是一个截图 ![在此处输入图像描述](../Images/1d4733bd301d32609a497e21dbafee81.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T00:45:52.697

LayoutManager 用于简化特定的布局。在您的情况下，您似乎想做一些特定的事情，所以不要使用布局管理器！

在 oracle 网站上有一个很好的布局指南。本指南的一部分是如何不使用它： [http ://docs.oracle.com/javase/tutorial/uiswing/layout/none.html](http://docs.oracle.com/javase/tutorial/uiswing/layout/none.html)

祝你的项目好运！

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-06T04:53:59.980

最好的方法是使用 .setBounds(X, Y, Length, Width) 您可以设置项目的精确定位。它是从 X 和 Y 的左上角开始测量的。对于宽度，它会随着时间向左增长，并且不会移动 X。长度和 Y 值也是如此。

```
JTextField field = new JTextField(),
field.setBounds(500, 100, 100, 30);
add(field); 
```

# .htaccess - .htaccess 文件夹看起来很像查看带有和不带有正斜杠的 php 文件

> ID：10906886
> 
> 赞同：0
> 
> 时间：2012-06-06T00:41:26.940
> 
> 标签：.htaccess, forward, slash

我正在尝试使用 .htaccess 使我的 php 文件在 URL 中看起来更整洁。

* * *

*这是我所拥有的：*

`www.domain.com/file.php`

*这是我希望它被访问的方式（以及它应该如何在 URL 中显示：*

`www.domain.com/file`或者`www.domain.com/file/`

* * *

我找到了这样做的网站，所以我知道这是可能的，但是这是我在 .htaccess 文件中能想到的最好的方法：

```
Options +FollowSymlinks
RewriteEngine on
RewriteCond %{HTTP_HOST} ^titaniumwebdesigns.com$ [NC]
RewriteRule ^(.*)$ http://www.titaniumwebdesigns.com/$1 [R=301,L]
RewriteRule ^(.*)\/$ $1.php [NC] 
```

唯一的问题是，它不适用于 www.example.com/page 因为它重定向到一个文件夹，而 www.example.com/page/ 使用额外的正斜杠成功地重定向到 www.example.com/page.php .

其他部分只是添加`http://www.`看起来更整洁。它不仅仅是 .htaccess 文件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T11:38:56.170

我在这里假设您有一个名为 page.php 的文件，还有一个名为 page? 如果是这样，最简单的方法就是编写一个将重定向的路由文件，然后您可以使用以下代码：

```
RewriteRule ^router\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule . /router.php [L] 
```

然后只需在 PHP 中设置规则来测试`$_SERVER['REQUEST_URI']`返回的内容，然后包含文件。

# php - 与 PHP.js Javascript 库集成

> ID：10906887
> 
> 赞同：2
> 
> 时间：2012-06-06T00:41:39.343
> 
> 标签：php, javascript, frameworks, phpjs

我正在尝试将 PHPJS ( [http://phpjs.org/](http://phpjs.org/) ) 库与一些代码集成，并且在调用任何函数时遇到问题，并且该库的网站没有逐步入门的步骤。

我正在使用基本下载**php.default.min.js**并创建了一个简单的页面：

```
<html>
<head>
<script type="text/javascript" src="php.default.min.js"></script>
<script type="text/javascript">
alert(phpversion());
</script>
</head>
<body></body>
</html> 
```

我希望这会产生一个 JavaScript 警报，但我只得到一个 JS 错误：

```
Uncaught ReferenceError: phpversion is not defined. 
```

如何使用 PHP.js 库中的函数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T01:46:53.980

您正在使用[默认包](http://phpjs.org/packages/view/308)，它不附带*phpversion*功能。尝试使用[完整的包](http://phpjs.org/packages/view/3775)。这两个版本在我附加的链接中都有一个受支持的功能列表。

希望能帮助到你！

# java - 我们可以模仿 Java Swing 中的 GTK+ 2.0 按钮样式吗？

> ID：10906889
> 
> 赞同：2
> 
> 时间：2012-06-06T00:42:04.210
> 
> 标签：java, swing, jbutton, look-and-feel, gtk2

Java Swing 的问题在于外观和感觉（Metal、Nimbus、GTK...），与 SWT、Windows、Mac 和 Gnome Tool Kit 相比，外观和感觉最差，而且获得好看的小部件是乌托邦式的，但我问的是问题虽然。

我需要知道是否有可能将**JButton 调整为看起来像默认的 GTK 按钮。** 否则，我们可以给 JButton 文本一个样式（例如阴影）吗？

```
public class myTweakedButton extends JButton {

// Override style attributes here.

} 
```

这是 GTK 应用于按钮小部件的样式：

```
style "button" {
    xthickness = 3
    ythickness = 3

    bg[NORMAL] = shade (1.07, "#cdcdcd")
    bg[PRELIGHT] = shade (1.09, "#cdcdcd")
    bg[ACTIVE] = shade (1.0, "#cdcdcd")
    bg[INSENSITIVE] = mix (0.25, @bg_color, "#e2e1e1")
    fg[INSENSITIVE] = "#9c9c9c"

    engine "murrine" {
        #contrast = 1.0
        border_shades = {1.04, 0.82}
        reliefstyle = 5
        shadow_shades = {1.02, 1.1}
        textstyle = 1
        glowstyle = 5
        glow_shade = 1.1
        #text_shade = 1.04
    } 
```

这是使用 Java 引擎提供的默认 GTK 外观时按钮的外观：

![Java GTK LAF 按钮](../Images/91e2bdb31b8437437a36ab67dbeb1c37.png)

这里是一个按钮在 Linux (GTK 2.0) 下的样子。

![GTK 按钮 Linux](../Images/f441ce8db39504119282c9c4db7ee8a3.png)

区别实际上是 Java GTK LAF 中的不良文本提示，而 GTK 按钮文本的样式带有离散阴影。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T07:25:14.907

有两种方法

*   [编写自己的 JButton](https://stackoverflow.com/a/5755124/714968)

*   但正确的方法（不要重新发明轮子）使用正确的[外观和感觉](https://stackoverflow.com/a/3954646/714968)，

*   可能的情况

    1.  转到[非实质性](https://github.com/Insubstantial)

    2.  下载代码源，

    3.  将所有类导入 IDE（2-15 分钟取决于 PC 硬件）

    4.  搜索文件夹`test`，有`Check.java`，

    5.  运行它并尝试其中的所有内容`JMenu Look and Feel`，每个商品所需的下载 jar 文件`Custom Java Swing Look and Feels`都可以从`JMenu`

    6.  没有比这更好的了，所有标准和良好的自定义 Swing 外观和感觉合二为一`JFrame`

    7.  也许更好的方法是将 Substance 与 SwingX 一起使用，自定义 Swing 的非常好的自定义实现，再没有比这更好的了

    8.  注意：SwingX 需要的不仅仅是基本的 Swing 知识，Substance（我的观点）也需要更新和自定义原始代码中的一些方法

# css - 为什么我的内联 CSS 有效，但 head 标签中的 CSS 无效？

> ID：10906896
> 
> 赞同：1
> 
> 时间：2012-06-06T00:42:41.153
> 
> 标签：css

为什么这个内联 CSS 可以正常工作。

```
<a href="error.php" class="reportBug"
style="display:scroll ;position:fixed; bottom:210px; right:2px;"> 
    <img src="images/Report_Error.png" border="0">
</a> 
```

但是当我将 CSS 放入`<head>`.

```
<head>
  <style type="text/css">
    #reportBug {
      display:scroll;
      position:fixed;
      bottom:210px
      right:2px;
    }
  </style>
</head>

<body>
  <a href="error.php" class="reportBug"> 
    <img src="images/Report_Error.png" border="0">
  </a>
</body> 
```

两者有什么区别，为什么第二种方式不起作用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T00:43:59.390

将元素分配给类时，您使用`.`符号。ID 使用`#`.

```
<style type="text/css">
 #reportBug {
   display:scroll;
   position:fixed;
   bottom:210px
   right:2px;
 }
</style> 
```

应该

```
<style type="text/css">
 .reportBug {
   display:scroll;
   position:fixed;
   bottom:210px
   right:2px;
 }
</style> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T00:44:41.123

你需要`reportBug`像这样引用一个类：

```
.reportBug {
 display:scroll;
 position:fixed;
 bottom:210px
 right:2px;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-06T00:44:48.063

在您的样式表中，您使用了`#reportBug`. 那是为了`id="reportBug"`，不是`class="reportBug"`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-06T01:46:21.730

此外，我认为您在 class 的声明中遗漏了一些东西，`reportBug`最后`bottom`需要 the `;`，否则`right: 2px;`将被忽略。

```
 .reportBug {
   display:scroll;
   position:fixed;
   bottom:210px;
   right:2px;
 } 
```

# python - 在服务器上使用 Python SQLite3 库

> ID：10906905
> 
> 赞同：0
> 
> 时间：2012-06-06T00:44:48.170
> 
> 标签：python, database, sqlite, web

我有一个用 Python 编写的程序，它从 .db 文件中读取数据。我在使用 CGI 脚本的 Web 服务器上运行该程序时遇到问题，我最终将问题追溯到导入 Python SQLite3 库，该库甚至未被识别。我不应该程序在我的计算机上运行得很好，而不是在服务器上。

我只是想知道是否有另一种解决方案，而不是将整个 Python 内置模块库上传到我的服务器上。

# android - 快速启动命令

> ID：10906907
> 
> 赞同：3
> 
> 时间：2012-06-06T00:45:04.743
> 
> 标签：android, boot, fastboot

当手机通过按住以下方式手动启动到fastboot时，我可以通过Windows机器上的命令提示符运行fastboot命令：提高音量+降低音量+电源

**Android 中有没有办法以编程方式启动到 fastboot 并运行命令，而无需使用外部机器推送命令？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T01:21:07.280

不，没有。您可以做的最接近的方法是擦除手机并使用意图将其重置为出厂设置，但我怀疑这不是您想要的。

# ios - didReceiveMemoryWarning 和 dealloc 是什么关系？

> ID：10906909
> 
> 赞同：2
> 
> 时间：2012-06-06T00:45:25.450
> 
> 标签：ios, dealloc, didreceivememorywarning

`dealloc`在内存压力下会被调用吗？如果是真的，它是在之前`didReceiveMemoryWarning`还是之后调用？另外，当视图控制器被释放时，确定`dealloc`会被调用吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T00:53:29.223

没有关系，didReceiveMemoryWarning 让您有机会通过删除任何不需要的资源来应对内存不足的情况。

如果视图控制器或任何其他对象被释放并且其保留计数减少到 0，则它将被删除并调用其 dealloc。

如果一个对象被释放，但它的保留计数没有减少到 0，那么它不会被删除，因此它的 dealloc 不会被调用。

当一个对象被删除时调用dealloc，删除和释放不是一回事。一个对象在其保留计数达到 0 时被删除。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T02:36:16.723

# paypal - Paypal 自适应支付 IPN 费用信息

> ID：10906912
> 
> 赞同：3
> 
> 时间：2012-06-06T00:45:40.217
> 
> 标签：paypal, paypal-ipn, paypal-adaptive-payments

所以，我不知道我是疯了还是怎么了，但对于我的生活，我无法弄清楚如何获得支付 Paypal 费用金额。

对于标准付款，您可以在 IPN 中获得此信息。您将获得毛额、净额和费用金额。（连同其他买家信息）。

我查看了 PaymentDetails 服务，但也没有显示费用金额。

有人知道吗？

我需要每笔付款的净额、毛额和费用金额。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T20:17:41.193

我发现您必须在您的帐户中激活 IPN 才能在每笔交易中收到 2 条通知。在您的自适应 PAY 调用中指定`ipnNotificationUrl`参数不足以获取所有内容。您将获得总金额和一些交易 ID，但除了用于交易的 Paypal 电子邮件之外，没有关于买家的任何信息。

如果使用 PHP，请勿依赖 $_REQUEST 或 $_POST 参数从 Paypal 获取所有变量。您将需要使用`php://input`来获取 Paypal 发送的所有数据。

例如

```
$input = file_get_contents('php://input'); 
```

这将返回一个字符串，您需要解析该字符串以获取

# c# - FormCollection 没有为单选按钮获得正确的值

> ID：10906917
> 
> 赞同：1
> 
> 时间：2012-06-06T00:46:07.697
> 
> 标签：c#, asp.net-mvc-3, radio-button

当我发布 FormCollection 并尝试获取单选按钮的值时，它始终采用最后一个单选按钮的值（无论选中哪个单选按钮）。为什么要这样做？我的临时解决方法是创建一个隐藏值并添加一个 onclick JS 方法。我尝试使用具有相同结果的纯 HTML 代码。

**查看代码**

```
@Html.RadioButton("Radio", "No", true, new { id = "Radio0"}) + " No");
@Html.RadioButton("Radio", "Yes", false, new { id = "Radio1"}) + " Yes"); 
```

**生成的 HTML**

```
<input checked="checked" id="Radio0" name="Radio" type="radio" value="No"> No
<input id="Radio1" name="Radio" type="radio" value="Yes"> Yes 
```

**控制器代码**

```
[HttpPost, ValidateInput(false)]
public ActionResult MyPostBack(FormCollection form)
{
    string radio = form["Radio"]; //************** this is always "Yes"
    return View("MyView");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T02:20:38.933

实际上无法复制该问题。它正确识别控制器上 PostBack 上选定的单选按钮。

您可能想要检查您的视图的代码（使用您给定的视图语法，它不应该首先呈现页面并且应该引发编译错误）

这是我正在测试的观点

```
@{
    ViewBag.Title = "MyView";
}

<h2>MyPostBack</h2>
@using (Html.BeginForm())
{
    @Html.RadioButton("Radio", "No", true, new { id = "Radio0"}) @:No
    @Html.RadioButton("Radio", "Yes", false, new { id = "Radio1"}) @:Yes
    <input type ="submit" runat="server" id="btnSubmit" />
} 
```

**编辑**

根据您的评论，由于您正在使用`DevExpress`，请先阅读提供的文档。它应该为您指明正确的方向。做了一些谷歌搜索，发现除了`RadioButton`扩展名之外还有一个`RadioButtonList`扩展名。这里有几个链接可以帮助你。

[DevExpress 文档 (RadiButtonList)](http://documentation.devexpress.com/#AspNet/CustomDocument9026)

[使用 RadioButtonList 的工作示例](http://www.devexpress.com/Support/Center/p/E2871.aspx)

[RadioButton 上的讨论线程](http://www.devexpress.com/Support/Center/p/Q382536.aspx)（虽然我找不到有关如何使用的示例`RadioButton`；根据您可以使用的线程`RadioButton`，如果可以在两个选项之间进行选择；否则您需要选择`RadioButtonList`）

同样正如每个人都提到的那样，通过 a`Model/ViewModel`而不是发送`FormCollection`

# c# - 解析友好的路由 URL 参数

> ID：10906919
> 
> 赞同：0
> 
> 时间：2012-06-06T00:46:19.500
> 
> 标签：c#, asp.net, routing

我在 ListView 中有指向详细页面视图（不是 MVC）的链接：

```
http://localhost/mysite/events.aspx?eventID=14 
```

实现路由后，链接的形式为：

```
http://localhost/mysite/Events/14 
```

在 Events.aspx 代码隐藏中解析/获取 eventID 值的最佳方法是什么？我应该/将如何检查以确保实际传递了一个值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T01:14:43.423

我想通了，并将问题留给其他人参考：

```
if (!Page.IsPostBack)
{
    if (Page.RouteData.Values["EventID"] != null)
    {
        int eventID = Convert.ToInt32(Page.RouteData.Values["EventID"]);
    }
} 
```

# python - 不带睡眠的 Python 倒计时

> ID：10906920
> 
> 赞同：0
> 
> 时间：2012-06-06T00:46:33.400
> 
> 标签：python, time

我正在研究 Twisted 套接字，但我听说如果您在使用套接字时使用 time.sleep，系统会挂起并且套接字会停止。有没有什么方法可以在没有 time.sleep 的情况下进行倒计时？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T01:34:53.227

Twisted 有几个选择。您可以使用一个简单的函数来检查条件。

```
from twisted.internet import reactor
expire = 10
def tick():
    expire -= 1
    if expire == 0:
        reactor.stop()
        return
    reactor.callLater(1, tick)

reactor.callLater(0, tick)
reactor.run() 
```

还有twisted.internet.task.LoopingCall [http://twistedmatrix.com/documents/current/api/twisted.internet.task.LoopingCall.html](http://twistedmatrix.com/documents/current/api/twisted.internet.task.LoopingCall.html)

```
from twisted.internet.task import LoopingCall

def tick():
    if expired = 0:
        reactor.stop()
        return
    do_something()

task = LoopingCall(tick)
task.start()
reactor.run() 
```

如果您使用的是扭曲的应用程序 (twistd) 或其他一些多服务，那么还有 twisted.application.internet.TimerService [http://twistedmatrix.com/documents/current/api/twisted.application.internet.TimerService.html](http://twistedmatrix.com/documents/current/api/twisted.application.internet.TimerService.html)

# ios - 跟踪间歇性冻结 iOS UI 的提示

> ID：10906924
> 
> 赞同：6
> 
> 时间：2012-06-06T00:47:11.277
> 
> 标签：ios, ipad, core-data, deadlock

2 年前我写了一个巨大的 iPad 应用程序，现在我回到它并将它升级到 iOS5。它有点乱，因为它是我的第一个大型 iPad 应用程序。

它有一个可能持续几分钟的“同步”步骤，这些是一堆异步方法调用，它们从 url 获取 JSON 并将它们放入核心数据中。应用程序经常会冻结（UI 无响应）。

有什么好的技术可以追踪这种冻结？调试器没有那么有用，除非代码在主线程上运行，否则您没有可用的堆栈跟踪。该应用程序通常也无法恢复，这表明存在某种死锁情况。

这是一个可能有帮助的特定示例：

![在此处输入图像描述](../Images/ef86348197078280e54ccb9b53c48e39.png)

一旦我确认它被冻结，我就暂停了执行。它似乎每次都冻结在同一行 - 一个简单的任务。这里发生了什么？它太令人沮丧了。

这是导致这种情况的核心数据访问吗？任何指针将不胜感激。

**编辑 2012 年 6 月 29 日**

[单击此处](http://pastebin.com/Zq0t27kD)查看执行所有核心数据对象的创建/更新/删除的类的源代码。我只需要停止此应用程序中的冻结/崩溃。我知道它一团糟，它也让我畏缩。两年前我写了这篇文章，几乎没有任何objective-c知识。我应该重新编写它，但我必须在 2 天内完成这项工作并且从我的脑海中消失。谁能给我一些关于快速获得这个线程安全的方法的指示？我可以将每个更新 NSManagedObjectContext 的方法包装在大型中央调度块代码中吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T12:32:06.937

Core Data（结合多线程）确实有可能是您遇到麻烦的原因 - 我遇到了类似的问题。

这是一篇关于这个主题的优秀文章：[Core Data and threads, without the heading](http://www.cimgf.com/2011/05/04/core-data-and-threads-without-the-headache/)

`performSelector:`我还在您的堆栈跟踪中看到了一个调用。您可能需要考虑使用 Grand Central Dispatch，尽管在您的情况下可能需要重写很多内容。

至于您的实际问题（追踪死锁），我建议您也使用 Instruments。另外，查看其他线程的状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T00:13:58.027

你说：

> 调试器没有那么有用，除非代码在主线程上运行，否则您没有可用的堆栈跟踪。

这不是真的。您可以获得所有线程的堆栈跟踪。

它每次都冻结在同一条线上的事实表明该线有问题。这就是你正在做的事情：

```
self.friendObj.affiliations = friendObject1.affiliations; 
```

所以，我会在该行上放一个断点，当 Xcode 在断点处停止时，分析`friendObj1`. 也许有一些时髦的事情正在发生。

您的friendObj 的课程中​​是否有自定义的“setAffiliations:”方法？也许不知何故在那条线上发生了无限循环。

我将分析围绕设置您的friendObj 的“附属关系”属性的所有调用，并尝试确定您的错误在哪里。

另一个想法：friendObj 是核心数据对象吗？如果是这样，则应在 ManagedObjectContext 中对其进行初始化。

# javascript - 使用正则表达式选择括号内的内容

> ID：10906925
> 
> 赞同：2
> 
> 时间：2012-06-06T00:47:12.433
> 
> 标签：javascript, regex

我试图提醒括号内的数字：

```
var str2 = "This is a string (3444343) with numbers.";
var patt2 = \((.*?)\);
alert(str2.match(patt2)); 
```

jsfiddle： http: [//jsfiddle.net/BinaryAcid/8nx9 ​​v/1/](http://jsfiddle.net/BinaryAcid/8nx9v/1/)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-06T00:50:20.113

# 解决方案

根据您原来的问题，这样做可以：

```
var str2 = "This is a string (3444343) with numbers.";
var patt2 = /\((.*?)\)/;

alert(str2.match(patt2)[1]); 
```

更新的 jsFiddle 示例：http: [//jsfiddle.net/S99jd/](http://jsfiddle.net/S99jd/)

对于您的输入字符串，它会发出警报`3444343`（不带括号）。

# 一些解释

您需要的代码段：

*   添加正斜杠`/`以创建正则表达式，
*   通过选择正确的匹配组来发出警报（此处，在 index 处`1`， as`match()`返回一个元素数组，其中 index 处`0`的元素是完全匹配，以下索引对应于匹配组）。

有关在 JavaScript / ECMAScript 中使用正则表达式的更多信息和帮助，请访问：[http ://www.regular-expressions.info/javascript.html](http://www.regular-expressions.info/javascript.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T00:48:32.127

您需要用正斜杠将正则表达式文字括起来：

```
var patt2 = **/**\((.*?)\)**/**;
```

[这是更新的 jsFiddle。](http://jsfiddle.net/minitech/8nx9v/2/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-06T00:52:36.507

正如其他人指出的那样，最好使用斜杠创建正则表达式，但如果您想知道如何修复您的方法：

```
var patt2 = '(\\(\\d+\\))'; 
```

或者

```
var patt2 = '([(]\\d+[)])'; 
```

# html - 如何仅将水平单元格间距应用于 HTML 表格？

> ID：10906932
> 
> 赞同：29
> 
> 时间：2012-06-06T00:48:17.680
> 
> 标签：html, html-table

我最近发现我需要在我的表格中使用 cellspacing 属性，但我想知道我是否可以让它只水平工作。我不希望它垂直展开，这会弄乱我整个页面的布局。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-06-06T01:08:26.407

比设置更好的方法`cellspacing="10"`是使用 CSS。您可以使用以下 CSS 来定位表格的单元格间距。

```
table {
  border-spacing: 10px 0;
} 
```

第一个值指定水平间距，第二个值指定垂直间距。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T06:27:22.680

如果您只需要将单元格*内容*分开，请在单元格内使用间距（并`cellspacing=0`在 HTML 中设置）。支持 CSS 的浏览器普遍支持这一点。

如果您确实需要将单元格本身分开，以便它们的边框或彩色背景之间有间距，那么`border-spacing`可以解决问题，但仅限于支持的浏览器。

根据上下文，您甚至可以考虑通过将单元格内容放入 a 中来模拟单元格间距`div`，设置为覆盖除所需填充之外的单元格区域，这看起来像单元格间距。然后，您将在这些`div`元素上设置任何所需的边框或背景。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-07-16T22:57:11.507

是的，我知道内容和样式的分离是丑陋和可恶的，但添加间隔（不可见）列似乎是唯一在所有平台上始终有效的方法。

在这里，我在第一行放了一些空表数据，并给了它们一个宽度（以像素为单位）。我在连续的行中制作了相应的空表数据。感觉真的很*老派*，但它很简单而且很有效。

```
<table>
    <tr>
        <td>some content for column 1</td>
        <td width="18" />
        <td>other content for 2nd visible column (actually column 3)</td>
        <td width="18" />
        <td>content for 3rd visible column (actually column 5)</td>
    </tr>

    <tr>
        <td><img src="image_for_column 1.png" /></td>
        <td />
        <td><img src="image_for_column 2.png" /></td>
        <td />
        <td><img src="image_for_column 3.png" /></td>
    </tr>

</table> 
```

# jquery - 使用循环对数组执行操作，该数组被用作选择器

> ID：10906933
> 
> 赞同：0
> 
> 时间：2012-06-06T00:48:30.373
> 
> 标签：jquery, css

我的想法是它会是这样的：

```
var ads = newArray[];

ads[0] = "#classes";
ads[1] = "#fluke";
ads[2] = "#pelican";

for (i = 0, i <= 2, i++) {
    $(ads[i]).delay(1500).show();
} 
```

对于我正在做的事情，这是一个非常粗略的想法。最终，我希望让它滚动浏览网站的广告。不知何故，我绊倒了它的逻辑。事实上，我希望这段代码延迟 1500，然后显示所有 div。最终目标是一个接一个地展示它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T00:54:36.570

来自以下文档[`delay()`](http://api.jquery.com/delay/)：

> 只有队列中的后续事件被延迟；例如，这不会延迟不使用效果队列的 .show() 或 .hide() 的无参数形式。

下面应该解决这个问题，因为它会触发*效果队列*。`show()`根据自己的喜好调整参数。

```
$('#target1').delay(1500).show('fast'); 
```

见[小提琴](http://jsfiddle.net/2ZFjr/)。

顺便说一句，没有理由构建一个数组。您可以一次选择多个元素：

```
$('#target1, #target2').show(); 
```

再看[一个小提琴](http://jsfiddle.net/2ZFjr/1/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T17:13:31.723

```
$(document).ready(function() {
var loopStart = '0';
var loopEnd = '3';
$('#class').css({display: 'inline-block'});
function adLoop() {
        setTimeout(function() {
            if (loopStart+1 == 1 && loopStart+2 == 2) {
                $('#fluke').css({display: 'none'});
                $('#pelican').css({display: 'none'});
                $('#class').css({display: 'inline-block'});
            }
            if (loopStart+1 == 2 && loopStart+2 == 3) {
                $('#class').css({display: 'none'});
                $('#pelican').css({display: 'none'});
                $('#fluke').css({display: 'inline-block'});
            }
            if (loopStart+1 == 3 && loopStart+2 == 4) {
                $('#class').css({display: 'none'});
                $('#fluke').css({display: 'none'});
                $('#pelican').css({display: 'inline-block'});
            }
            if (loopStart+1 == 4 && loopStart+2 == 5) {
                $('#fluke').css({display: 'none'});
                $('#pelican').css({display: 'none'});
                $('#class').css({display: 'inline-block'});
                loopStart = 0;
            }
            loopStart++;
            if (loopStart <= loopEnd) {
                adLoop();
            }
        }, 5000)
}
adLoop();
}) 
```

这就是我想出的。我想对数组做同样的事情。

# javascript - 在 SSRS 报告中包含外部 JavaScript 文件

> ID：10906937
> 
> 赞同：1
> 
> 时间：2012-06-06T00:48:45.183
> 
> 标签：javascript, sql-server, reporting-services, vbscript

我有一些 SSRS 报告将受益于一些简单的 javascript。

我知道我可以在 SSRS 中编写内联 javascript，但是我怎样才能让报表引擎插入一个脚本标签，例如

```
<script type="text/javascript" src="mycode.js" /> 
```

我已经检查了[是否可以将 javascript 嵌入到 SSRS 报告中？](https://stackoverflow.com/questions/789303/is-it-possible-to-embed-javascript-into-an-ssrs-report)和一些博客，我相信这很容易做到。

我希望它需要使用 VBscript 来完成，但我不知道从哪里开始。帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T10:53:38.277

> 我敢肯定这很容易做到。

我错了。不容易。SSRS 不宜扩展；如果您需要交互式报告，则应使用不同的框架进行调查

# c# - 如何使用 C# Runspace 加载 powershell 模块

> ID：10906938
> 
> 赞同：2
> 
> 时间：2012-06-06T00:48:59.020
> 
> 标签：c#, powershell, azure

尝试在 C# 中使用 Azure cmdlet，一切正常，除了 Azure 的特定“Get-RoleInstanceCount”。Azure cmdlet promt 在启动时运行以下命令：

```
C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe -NoExit -Command "cd c:\; Import-Module 'C:\Users\me\Documents\WindowsPowerShell\Modules\WAPPSCmdlets\WAPPSCmdlets.dll'" 
```

我尝试了以下方法：

```
InitialSessionState initialSessionState = InitialSessionState.CreateDefault();
initialSessionState.ImportPSModule(new string[] {"C:\\Users\\me\\Documents\\WindowsPowerShell\\Modules\\WAPPSCmdlets\\WAPPSCmdlets.dll"});
Runspace runspace = RunspaceFactory.CreateRunspace(initialSessionState); 
```

也像他们在这里做的那样：

[http://msdn.microsoft.com/en-us/library/windows/desktop/ee706596(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ee706596(v=vs.85).aspx)

.dll 模块位于 Debug 文件夹和上述路径中。但是当我尝试“打开（）”运行空间时，我得到以下异常：

> 无法加载文件或程序集“WAPPSCmdlets”或其依赖项之一。找到的程序集的清单定义与程序集引用不匹配。（来自 HRESULT 的异常：0x80131040）

我该怎么做才能加载使我能够运行 Azure 命令的模块？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T01:46:58.883

由于无法成功加载 cmdlet，我不确定“Get-RoleInstanceCount”以外的命令如何工作。您可以再次检查以确保它们工作正常吗？如果没有，请尝试重新安装 cmdlet。

此外，您可以直接使用 RESTful Windows Azure 管理 API，而无需 PowerShell。PowerShell 可以通过将 HTTP 请求封装到 cmdlet 中来提供简化的编程模型。但如果这不起作用，您始终可以选择直接使用 REST API。

# playframework - 无法使用播放框架设置 cookie

> ID：10906939
> 
> 赞同：1
> 
> 时间：2012-06-06T00:49:01.660
> 
> 标签：playframework, setcookie

我是玩框架（1.2.4）的新手，我很难解决设置 cookie 的问题。我已经阅读了 1.2.4 api 文档，但找不到做错了什么。cookie 没有设置，而是应用程序使用 cookie 值执行 GET 请求，如下所示：`index?name=user&value=123&duration=1d`页面变为空白。`render()`没有被调用。我在 application.conf 中缺少设置吗？下面是我的代码。

```
public static void setCookie(String name, String value, String duration) {
    // Setting cookie
    System.out.println(">> Setting Cookie :" + name);
    response.setCookie(name, Crypto.sign(value), duration);
}

public static Http.Cookie getCookie(String key) {
    // retrieving cookie by key
    return Http.Response.current().cookies.get(key);
} 
```

这就是我调用 setCookie 的地方

```
public static void index() {
    // some code.
    setCookie("user", "123", "1d");
    render();
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T07:21:39.007

这是因为当您调用`setCookie`Play 时认为您正在调用不同的操作（因为您的 setCookie 方法在控制器中，并且是`public static void`.

您可以将方法设为私有，或使用`@Util`注释标记 setCookie 方法。

# python - 在列表中查找段落的第一个单词

> ID：10906940
> 
> 赞同：2
> 
> 时间：2012-06-06T00:49:13.030
> 
> 标签：python, list, paragraph

我创建了一个列表，其中每个元素内包含不同的段落。

我想找到每个段落的第一个单词。

我唯一能想到的就是将每个段落分成单独的单词并找到`element[0]`. 这似乎相当过分，因为我已经在列表中列出了每个段落

那么有什么更好的方法来做到这一点呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T00:52:44.480

像这样的东西？

```
l = ['start of paragraph 1','start of paragraph 2','para 3']
first_words = [p.split()[0] for p in l]
print first_words 
```

打印：['start', 'start', 'para']

如果您不想拆分每个段落，您可以搜索第一个空格的索引，然后抓取每个单词：

```
l = ['start of paragraph 1','start of paragraph 2','para 3']
first_words = [p[:p.find(' ')] for p in l]
print first_words 
```

打印：['start', 'start', 'para']

**按要求解释：**

*   使用 p.find(' ') 查找段落中的第一个空格 - 返回位置
*   然后通过 p[:p.find(' ')] 获取段落中的第一个字符
*   该行的其余部分称为[列表理解](http://docs.python.org/tutorial/datastructures.html#list-comprehensions)，基本上循环遍历您的列表并`p`依次获取每个段落

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T01:21:09.193

好心痛：

```
my_paras = ["It was the best of times", "Twas a dark and stormy night", "The walrus and the carpenter"]

my_first_words = [para.split(None, 1)[0] for para in my_paras] 
```

返回

```
['It', 'Twas', 'The'] 
```

`None`split的参数表示“在任何连续的空白处分割”，通常是隐含的，但是我必须在此处指定它，以便同时提供第二个位置参数`maxsplit`. 通过传递 maxsplit=1，.split() 在找到第一个空白字符（返回由第一个单词和段落的其余部分组成的两项列表）或到达字符串末尾（返回一个-项目列表，整个连续段落）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T01:03:10.323

假设每个段落都以一个单词开头（而不是说空格或数字）：

```
[par[:par.index(" ")] for par in list_of_par] 
```

这就是所谓的“列表理解”。它遍历每个项目`list_of_par`并适用`par[:par.index(" ")]`于它。这需要一段段落 ( `par`)，在这种情况下，从第 0 个字符到（但不包括）第一个空格 ( `[:par.index(" ")]`)。

列表推导返回一个字符串列表；每个字符串都是段落中的所有字符，直到第一个空格。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T01:15:16.670

你希望你的话如何布局？你不想保证它们不是空格，或者它们不包含标点符号吗？

第一剪：

```
first_words = [
        paragraph.split(None, 1)[0]
        for paragraph in paragraphs
] 
```

# jquery - 使用 cshtml 中返回的 JQuery FOREACH 行切换可见性

> ID：10906943
> 
> 赞同：3
> 
> 时间：2012-06-06T00:49:51.937
> 
> 标签：jquery, razor, foreach, webmatrix

我已经在高处和低处搜索了我的问题的答案。我有下面的代码，只是想让我的 JQuery 函数隐藏循环 返回的**特定**行。**目前它隐藏了所有返回的行**。我在 .cshtml 中使用 JQuery。请指教。`foreach`

 **```
<body>
    <script type="text/javascript">    

       $(document).ready(function(){
           $("input").click(function(){
               $("p").toggle(1000);
           });
       });

   </script>

   @foreach (var row in db.Query(selectQueryString)){    
       <p>First Name: @row.First_Name Last Name:@row.Last_Name</p> 
       <button>Toggle</button>
   }
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T00:54:58.800

这应该适合你：

```
$("button").click(function(){
    $(this).prev("p").toggle(1000);
}); 
```

[现场演示](http://jsfiddle.net/vrNqh/)

**编辑**：

当您`$("p")`在 jquery 中用作选择器时，您实际上得到了所有`<p>`标签；但是，在您的情况下，您只需要每个按钮之前的那个。因此，您应该使用[prev()](http://api.jquery.com/prev/)`<p>`来获取单击按钮之前的第一个实例。**

# java - Mockito、JUnit 和 Spring

> ID：10906945
> 
> 赞同：79
> 
> 时间：2012-06-06T00:50:24.180
> 
> 标签：java, spring, unit-testing, mockito

我今天才开始了解 Mockito。我写了一些简单的测试（使用 JUnit，见下文），但我不知道如何在 Spring 的托管 bean 中使用模拟对象。使用 Spring的*最佳实践*是什么。我应该如何向我的 bean 注入模拟依赖项？

你可以跳过这个直到**回到我的问题**。

首先，我学到了什么。这是一篇很好的文章[Mocks Aren't Stubs](http://martinfowler.com/articles/mocksArentStubs.html)解释了基础知识（Mock 的检查**行为验证**而不是*状态验证*）。然后这里有一个很好的例子[Mockito](http://en.wikipedia.org/wiki/Mockito) 和这里[Easier mocking with mockito](http://blog.trifork.com/2009/08/13/easier-mocking-with-mockito/)。我们解释说 Mockito 的模拟对象既是*mock*又是*stub*。

这里[Mockito](http://mockito.googlecode.com/svn/branches/1.8.0/javadoc/org/mockito/Mockito.html)和这里[Matchers](http://mockito.googlecode.com/svn/branches/1.8.0/javadoc/org/mockito/Matchers.html)，你可以找到更多的例子。

本次测试

```
@Test
public void testReal(){
    List<String> mockedList = mock(List.class);
     //stubbing
     //when(mockedList.get(0)).thenReturn("first");

    mockedList.get(anyInt());
    OngoingStubbing<String> stub= when(null);
    stub.thenReturn("first");

    //String res = mockedList.get(0);
                //System.out.println(res);

     //you can also verify using argument matcher
     //verify(mockedList).get(anyInt());

    verify(mockedList);
    mockedList.get(anyInt());
} 
```

工作得很好。

**回到我的问题。**在这里[Injecting Mockito mocks into a Spring bean](https://stackoverflow.com/questions/2457239/injecting-mockito-mocks-into-a-spring-bean)有人尝试使用 Springs `ReflectionTestUtils.setField()`，但是在这里[Spring Integration Tests, Creating Mock Objects](http://www.jayway.com/2011/11/30/spring-integration-tests-part-i-creating-mock-objects/)我们建议*更改*Spring 的上下文。

我真的不明白最后两个链接...有人可以向我解释 Spring 对 Mockito 有什么问题吗？这个解决方案有什么问题？

```
@InjectMocks
private MyTestObject testObject

@Mock
private MyDependentObject mockedObject

@Before
public void setup() {
        MockitoAnnotations.initMocks(this);
} 
```

[https://stackoverflow.com/a/8742745/1137529](https://stackoverflow.com/a/8742745/1137529)

**编辑**：我不是很清楚。我将提供 3 个代码示例来澄清我自己：假设，我们有带有方法的 bean HelloWorld和带有将调用转发到 HelloWorld 方法的方法的`printHello()`bean HelloFacade 。`sayHello``printHello()`

第一个例子是使用 Spring 的上下文并且没有自定义运行器，使用 ReflectionTestUtils 进行依赖注入（DI）：

```
public class Hello1Test  {
private ApplicationContext ctx;

@Before
public void setUp() {
    MockitoAnnotations.initMocks(this);
    this.ctx = new ClassPathXmlApplicationContext("META-INF/spring/ServicesImplContext.xml");
}

@Test
public void testHelloFacade() {
    HelloFacade obj = (HelloFacade) ctx.getBean(HelloFacadeImpl.class);
    HelloWorld mock = mock(HelloWorld.class);
    doNothing().when(mock).printHello();

    ReflectionTestUtils.setField(obj, "hello", mock);
    obj.sayHello();

    verify(mock, times(1)).printHello();
}

} 
```

正如@Noam 指出的那样，有一种方法可以在不显式调用`MockitoAnnotations.initMocks(this);`. 我还将在此示例中放弃使用 Spring 的上下文。

```
@RunWith(MockitoJUnitRunner.class)
public class Hello1aTest {

@InjectMocks
private HelloFacade obj =  new HelloFacadeImpl();

@Mock
private HelloWorld mock;

@Test
public void testHelloFacade() {
    doNothing().when(mock).printHello();
    obj.sayHello();
}

} 
```

另一种方法来做到这一点

```
public class Hello1aTest {

@Before
public void setUp() {
    MockitoAnnotations.initMocks(this);
}

@InjectMocks
private HelloFacadeImpl obj;

@Mock
private HelloWorld mock;

@Test
public void testHelloFacade() {
    doNothing().when(mock).printHello();
    obj.sayHello();
}

} 
```

不，在前面的示例中，我们必须手动实例化 HelloFacadeImpl 并将其分配给 HelloFacade，因为 HelloFacade 是接口。在最后一个示例中，我们可以只声明 HelloFacadeImpl，Mokito 将为我们实例化它。这种方法的缺点是，现在被测单元是 impl-class 而不是接口。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-06-07T02:22:23.670

老实说，我不确定我是否真的理解你的问题：PI 会尽量澄清，从我从你原来的问题中得到的：

首先，在大多数情况下，您不应该对 Spring 有任何顾虑。您很少需要让 spring 参与编写单元测试。一般情况下，你只需要在你的单元测试中实例化被测系统（SUT，被测目标），并在测试中也注入SUT的依赖。依赖项通常是模拟/存根。

您最初建议的方式，示例 2、3 正是我在上面描述的。

在极少数情况下（如集成测试或一些特殊的单元测试），您需要创建一个 Spring 应用程序上下文，并从应用程序上下文中获取您的 SUT。在这种情况下，我相信您可以：

1）在spring app ctx中创建你的SUT，获取它的引用，并注入模拟到它

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration("test-app-ctx.xml")
public class FooTest {

    @Autowired
    @InjectMocks
    TestTarget sut;

    @Mock
    Foo mockFoo;

    @Before
    /* Initialized mocks */
    public void setup() {
        MockitoAnnotations.initMocks(this);
    }

    @Test
    public void someTest() {
         // ....
    }
} 
```

或者

2）按照链接[Spring Integration Tests, Creating Mock Objects](http://www.jayway.com/2011/11/30/spring-integration-tests-part-i-creating-mock-objects/)中描述的方式进行操作。这种方法是在 Spring 的应用程序上下文中创建模拟，您可以从应用程序 ctx 获取模拟对象来进行存根/验证：

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration("test-app-ctx.xml")
public class FooTest {

    @Autowired
    TestTarget sut;

    @Autowired
    Foo mockFoo;

    @Test
    public void someTest() {
         // ....
    }
} 
```

两种方式都应该有效。主要区别在于前一种情况将在经过spring的生命周期等之后注入依赖项（例如bean初始化），而后一种情况是预先注入的。例如，如果您的 SUT 实现了 spring 的 InitializingBean，并且初始化例程涉及依赖项，您将看到这两种方法之间的区别。我相信这两种方法没有对错之分，只要你知道自己在做什么。

只是一个补充，@Mock、@Inject、MocktoJunitRunner 等在使用 Mockito 时都是不必要的。它们只是节省您键入 Mockito.mock(Foo.class) 和一堆 setter 调用的实用程序。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-07T00:12:34.987

您的问题似乎是在询问您给出的三个示例中的哪一个是首选方法。

**使用反射 TestUtils 的示例 1**不是*单元测试*的好方法。您真的不想为单元测试加载弹簧上下文。只需模拟并注入其他示例所示所需的内容。

如果你想做一些*集成测试*，你确实想加载 spring 上下文，但是如果你需要显式访问它的 bean ，我更喜欢使用`@RunWith(SpringJUnit4ClassRunner.class)`它来执行上下文的加载。`@Autowired`

**示例 2**是一种有效的方法，使用`@RunWith(MockitoJUnitRunner.class)`将无需指定 @Before 方法和显式调用`MockitoAnnotations.initMocks(this);`

**示例 3**是另一种有效的方法，它不使用`@RunWith(...)`. 您尚未`HelloFacadeImpl`显式实例化您的测试类，但您可以对示例 2 执行相同操作。

我的建议是使用示例 2 进行单元测试，因为它可以减少代码混乱。如果您被迫这样做，您可以回退到更详细的配置。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-05-26T15:01:22.040

在 Spring 4.2.RC1 中引入了一些新的测试工具，让我们可以编写不依赖于`SpringJUnit4ClassRunner`. 查看文档的[这一](https://docs.spring.io/spring-framework/docs/4.2.x/spring-framework-reference/htmlsingle/#_testing_improvements_3)部分。

在您的情况下，您可以编写 Spring 集成测试并仍然使用这样的模拟：

```
@RunWith(MockitoJUnitRunner.class)
@ContextConfiguration("test-app-ctx.xml")
public class FooTest {

    @ClassRule
    public static final SpringClassRule SPRING_CLASS_RULE = new SpringClassRule();

    @Rule
    public final SpringMethodRule springMethodRule = new SpringMethodRule();

    @Autowired
    @InjectMocks
    TestTarget sut;

    @Mock
    Foo mockFoo;

    @Test
    public void someTest() {
         // ....
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-01-27T09:50:59.563

这是我的简短总结。

如果您想编写单元测试，请不要使用 Spring applicationContext，因为您不希望在您正在单元测试的类中注入任何真正的依赖项。而是使用模拟`@RunWith(MockitoJUnitRunner.class)`，或者在类顶部使用注释，或者`MockitoAnnotations.initMocks(this)`在 @Before 方法中使用。

如果要编写集成测试，请使用：

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration("yourTestApplicationContext.xml") 
```

例如，使用内存数据库设置应用程序上下文。通常您不会在集成测试中使用模拟，但您可以使用上述`MockitoAnnotations.initMocks(this)`方法来做到这一点。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-06T08:07:57.817

`MockitoAnnotations.initMocks(this);`如果您使用的是 mockito 1.9（或更新版本），您并不真正需要- 您需要的只是：

```
@InjectMocks
private MyTestObject testObject;

@Mock
private MyDependentObject mockedObject; 
```

注释会将您所有的模拟`@InjectMocks`注入到`MyTestObject`对象中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-06T22:26:11.853

是否必须实例化带`@InjectMocks`注释的字段的区别在于 Mockito 的版本，而不在于使用 MockitoJunitRunner 还是`MockitoAnnotations.initMocks`. 在 1.9 中，它还将处理您的`@Mock`字段的一些构造函数注入，它将为您进行实例化。在早期版本中，您必须自己实例化它。

这就是我对 Spring bean 进行单元测试的方式。没有问题。当人们想要使用 Spring 配置文件来实际进行 mock 的注入时，人们会感到困惑，这跨越了单元测试和集成测试的点。

当然*，*被测单元是一个 Impl。你需要测试一个真正具体的东西，对吧？即使你将它声明为一个接口，你也必须实例化真实的东西来测试它。现在，您可以进入间谍，它们是围绕真实对象的存根/模拟包装器，但这应该是针对极端情况的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-09-05T13:30:07.740

如果您要将项目迁移到 Spring Boot 1.4，您可以使用新的注解[`@MockBean`](http://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-testing-spring-boot-applications-mocking-beans)来伪造`MyDependentObject`. 使用该功能，您可以从测试中删除 Mockito`@Mock`和`@InjectMocks`注释。

# c# - 访问 Roslyn REPL 中的 .config 文件

> ID：10906946
> 
> 赞同：7
> 
> 时间：2012-06-06T00:50:31.820
> 
> 标签：c#, roslyn

使用[Roslyn 2012 年 6 月 CTP](http://msdn.microsoft.com/en-US/roslyn)：

有没有办法为 Roslyn C# Interactive/REPL 提供一个 .config 文件，用于正在探索的代码？一个简单的示例场景是依赖于通常从 app.config/web.config 获得的连接字符串的代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T00:58:09.923

目前还没有办法做到这一点，尽管这是我们为未来考虑的事情。

同时，您能否考虑代码以将连接字符串作为参数，然后将其传递给交互式窗口中的方法？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-11T18:35:04.097

现在这实际上是可能的（并且可能在提出这个问题的时候已经存在）。只需使用以下内容创建一个 LoadConfig.csx 文件：

```
#r "System.Configuration"

using System;
using System.IO;
using System.Linq;

var paths = new[] { Path.Combine(Environment.CurrentDirectory, "Web.config"), Path.Combine(Environment.CurrentDirectory, "App.config") };
var configPath = paths.FirstOrDefault(p => File.Exists(p));

if (configPath != null)
{
    // Set new configuration path
    AppDomain.CurrentDomain.SetData("APP_CONFIG_FILE", configPath);  

    // Reset current configuration load state
    var t = typeof(System.Configuration.ConfigurationManager);
    var f = t.GetField("s_initState", System.Reflection.BindingFlags.Static | System.Reflection.BindingFlags.NonPublic);
    f.SetValue(null, 0);
} 
```

将文件保存在您会记住的位置，然后返回到要在 Visual Studio 中加载的项目。右键单击项目并选择“从项目中重置 C# Interactive”。一旦 C# 交互式窗口完成加载调用：

```
#load "C:\path\to\LoadConfig.csx" 
```

注意：您必须在加载项目后立即调用它。如果在加载此脚本之前发生任何配置查找，则此脚本将无法工作。

现在 C# Interactive 窗口应该可以访问您的项目设置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-10-14T05:38:50.647

已经接受的答案对我不起作用；根据对已接受答案的评论，它也不适用于其他 2 个人。以下解决方案对我有用。

1.  更新位于的 c# interactive (REPL) 的配置文件

    `AppDomain.CurrentDomain.SetupInformation.ConfigurationFile`

2.  重新初始化 REPL。

# asterisk - 如何从拨号计划中拨号发起呼叫？

> ID：10906947
> 
> 赞同：3
> 
> 时间：2012-06-06T00:50:38.443
> 
> 标签：asterisk

救命！如何拨打一个号码并让 Asterisk 发起从分机 sipX 到 sipY 的呼叫？

sipX 和 sipY 都出现在我的拨号方案的 extensions.conf 中。

诀窍是我想在我的手机上拨打337，然后我的手机出画面，然后sipX呼叫sipY。

假设我希望能够在电话上按下 337，并通过另一部电话的免提电话播放声音，例如作为警报。

* * *

另一种考虑方法是，我该怎么做：

1.  在我的手机上按 337
2.  完成我的通话，即挂断原主叫方
3.  即使队列中没有呼叫也运行宏
4.  调用 sipY
5.  在 sipY 上播放声音

当运行#2 动作（完成调用者的会话）并让其余的过程完成之后，我们可以使用类似于[Asterisk 11 中的预拨号处理程序的](https://wiki.asterisk.org/wiki/display/AST/Pre-Dial+Handlers)东西吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T01:31:19.920

您可以使用[Originate](https://wiki.asterisk.org/wiki/display/AST/Application_Originate)应用程序执行此操作。类似于以下内容：

```
[default]
exten => 337,1,NoOp()
same => n,Originate(SIP/Y,exten,default,originated,1)
same => n,Hangup()

exten => originated,1,NoOp()
same => n,Playback(tt-monkeys)
same => n,Hangup() 
```

当然，不同之处在于 Originate 会阻止 pbx_thread 执行扩展 337，直到 SIP/Y 应答或以其他方式失败。话虽如此，SIP/Y 和扩展中的应用程序之间的实际调用发生在它自己的线程上，所以一旦知道 SIP/Y 的状态，337 就会被挂断。因此它与您正在寻找的内容非常接近，并且不涉及调用文件等外部机制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T12:48:01.677

一个想法是创建一个调用文件并使用 agi 脚本将其移动到 /var/spool/asterisk/outgoing/。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-16T17:59:25.440

这是答案。您`Answer`作为第一部分放置，并以“挂断”结尾。这会处理“忙碌信号”。

没有 AGI。这行得通。

```
[from-internal]
exten => 3334,1,Goto(AngelusBell,startbell,1)

[AngelusBell]
exten => startbell,1,Answer
exten => startbell,n,System(asterisk -rx "channel originate Local/callviking@AngelusBell/n extension playbell@AngelusBell")
exten => startbell,n,Hangup

exten => callviking,1,Dial(SIP/Y,10,D(5))  ;calls my ATA to my paging box and plays 5 tone
exten => callviking,2,Hangup

exten => playbell,1,Answer
exten => playbell,2,Playback(custom/angelusbellWAV)
exten => playbell,3,Hangup 
```

# python - QT QItemSelectionModel 忽略列？

> ID：10906950
> 
> 赞同：1
> 
> 时间：2012-06-06T00:51:00.703
> 
> 标签：python, qt, selection, qtreeview, selectionmodel

我正在尝试将树的选择限制为特定列。

我大量使用委托来创建自定义的每项每列行为、编辑器等。我希望我可以通过阻止事件或类似的东西从委托中以某种方式做到这一点。问题是，我认为我必须创建一个完全自定义的解决方案来模仿扩展选择。

但是，经过大量搜索和很少的示例后，听起来我想要在我的树视图上自定义 QItemSelectionModel。这个假设正确吗？

如何创建自定义 QItemSelectionModel 将使用扩展选择模式，但如果不在特定列中，则允许我忽略或还原选择。换句话说，单击另一列不应更改选择（不应选择或取消选择）

我知道如何添加选择模型。我正在寻求帮助实现派生类（除非这可以通过连接的信号来完成）。

我正在使用 Python，但会重视任何帮助。

谢谢，

[编辑：] 我发现了这些类似的问题： http: [//lists.qt.nokia.com/pipermail/qt-interest/2010-September/027647.html](http://lists.qt.nokia.com/pipermail/qt-interest/2010-September/027647.html)

"**子类 QItemSelectionModel 并重新实现这两种选择方法以获得您想要的行为。**只需忽略列 > 0 的范围部分......或者可能只是重新实现 flags() 以使项目不可选择。我不知道是否那样会有任何副作用。”

我尝试在我的 QTreeWidgetItem 上重新实现标志，但它从未被调用：

```
def flags(self, index):
    print index.column()
    return super(DDOutlinerBaseItem, self).flags(index) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-30T15:09:40.187

理论上，以下调整应该有效。

上述解决方案可以使用两个单独的方法和 @pyqtSlot 装饰器来消除重载方法名称的歧义：

```
@pyqtSlot(QModelIndex, QItemSelectionModel.SelectionFlags)
  def select(self, index, command):
    # ...

@pyqtSlot(QItemSelection, QItemSelectionModel.SelectionFlags)
  def select(self, selection, command):
    #... 
```

这避免了在方法实现中检查某些类的实例的需要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T18:50:20.883

第一个有趣的事情是，由于 Python 不能重载方法，我的 select 方法似乎只是被调用了两次，参数 0 中的每种类型调用一次。这里有一个示例来说明这一点以及基本设置。我的 QTreeWidget 的树称为“树”（`self.tree`）

```
 # in __init__ of my QTreeWidget:
    sel_model = ColumnSelectionModel(self.tree.model())
    self.tree.setSelectionModel(sel_model)

class ColumnSelectionModel(QtGui.QItemSelectionModel):
    def select(self, selection, selectionFlags):
    """
    Runs both QItemSelectionModel.select methods::

        1\. select(QtCore.QModelIndex, QItemSelectionModel.SelectionFlags)
        2\. select(QtGui.QItemSelection, QItemSelectionModel.SelectionFlags)

    The first seems to run on mouse down and mouse up.
    The second seems to run on mouse down, up and drag
    """
    print("select(%s,  %s)" % (type(selection), type(selectionFlags)))

    if isinstance(selection, QtGui.QItemSelection):
        infos = []
        for index in selection.indexes():
            infos.append(("index=%s row=%s column=%s" 
                                    % (index, index.row(), index.column())))

        print ", ".join(infos)
    elif isinstance(selection, QtCore.QModelIndex):
        index = selection
        print("index=%s row=%s column=%s" % (index, index.row(), index.column()))
    else:
        raise Exception("Unexpected type for arg 0: '%s'" % type(selection))

    super(ColumnSelectionModel, self).select(selection, selectionFlags) 
```

这似乎解决了我的问题：

```
class ColumnSelectionModel(QtGui.QItemSelectionModel):
    def __init__(self, model):
        super(ColumnSelectionModel, self).__init__(model)

        self.selectable_columns = [0]
        """ Set the columns that are allowed to be selected """

    def select(self, selection, selectionFlags):
        """
        Ignores any selection changes if an item is not in one of the columns
        in the self.selectable_columns list.

        Is run by both QItemSelectionModel.select methods::

            1\. select(QtCore.QModelIndex, QItemSelectionModel.SelectionFlags)
            2\. select(QtGui.QItemSelection, QItemSelectionModel.SelectionFlags)

        The first seems to run on mouse down and mouse up.
        The second seems to run on mouse down, up and drag
        """
        if isinstance(selection, QtGui.QItemSelection):
            # This is the overload with the QItemSelection passed to arg 0
            # Loop over all the items and if any are not in selectable_columns
            #   ignore this event. This works because it is run for every change
            #   so the offending selection index will always be the newest
            indexes = selection.indexes()
            for i in xrange(len(indexes)):
                index = indexes[i]
                if not index.column() in self.selectable_columns:
                    return
        elif isinstance(selection, QtCore.QModelIndex):
            # This is the overload with the QModelIndex passed to arg 0
            # If this index isn't in selectable_columns, just ignore this event
            index = selection
            if not index.column() in self.selectable_columns:
                return
        else:  # Just in case
            raise Exception("Unexpected type for arg 0: '%s'" % type(selection))

        # Fall through. Select as normal
        super(ColumnSelectionModel, self).select(selection, selectionFlags) 
```

在我的最终实现中，我计划将决定委托给我的委托系统，使其具有通用性，并且理论上能够动态地忽略我想要的任何索引。

# android - Android - 如何选择按钮的可点击区域？

> ID：10906952
> 
> 赞同：0
> 
> 时间：2012-06-06T00:51:49.157
> 
> 标签：android, button, mapping, area, clickable

我有一个带有大图像背景的 ImageButton。我希望能够在该按钮中设置一个映射区域，因此我可以控制将调用该按钮的 onClick 方法的区域。

换句话说，我需要的是类似于 HTML 的“地图”标签（http://www.w3schools.com/tags/tag_map.asp）：

```
<img src="planets.gif" width="145" height="126" alt="Planets" usemap="#planetmap" />
<map name="planetmap">
 <area shape="rect" coords="0,0,82,126" href="sun.htm" alt="Sun" />
 <area shape="circle" coords="90,58,3" href="mercur.htm" alt="Mercury" />
 <area shape="circle" coords="124,58,8" href="venus.htm" alt="Venus" />
</map> 
```

有没有办法在Android上做到这一点？

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T01:12:53.593

看看[android-how-to-make-a-clickable-map-image](https://stackoverflow.com/questions/3961071/android-how-to-make-a-clickable-map-image-with-each-country-producing-a-differe)

* * *

这是一个[AndroidImageMap](https://github.com/catchthecows/AndroidImageMap)项目：Android 视图中类似 HTML 地图的元素的实现：

# session - 带有模板的 WebPy 会话

> ID：10906963
> 
> 赞同：0
> 
> 时间：2012-06-06T00:54:12.030
> 
> 标签：session, web.py

使用 Webpy。我的 app.py 中有以下代码：

```
app = web.application(urls, globals())
session = web.session.Session(app, web.session.DiskStore('sessions'), initializer={'count': 0, 'username': 'CRC'})
render = web.template.render('templates/', base="base", globals={'context': session, 'username': 'CRC'})

class Index(object):
    def GET(self):

        if not session:
                session.count = 0
        else:
                session.count = 1

        return render.hello_form()

    def POST(self):
        form = web.input(name="Nobody", greet="Hello")
        greeting = "%s, %s" % (form.greet, form.name)
        return render.index(greeting = greeting) 
```

然后在我的索引 html 文件中添加以下内容：

```
$def with (greeting)

<p>
Hi <b>$context.username</b>
</p>
$if greeting:
        I just wanted to say <em style="color: green; font-size: 2em;">$greeting</em>.
$else:
        I just wanted to say <em style="color: green; font-size: 2em;">Default</em>.

<p>
<a href="/hello">Link Back To Form</a> 
```

提交表单后，我看到了这个：在 /hello 'ThreadedDict' 对象没有属性 'username'

Python /Library/Python/2.7/site-packages/web/session.py 在**getattr**，第 64 行 Web POST /hello

关于我为什么看到这个的任何想法？它显然不喜欢我对用户名所做的事情，但我不清楚为什么。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-06T17:52:56.857

正如错误所说，`context`变量（实际上映射到`session`）没有属性`username`。相反，您已将其定义`username`为全局 var。

尝试`username`直接在模板中访问`$username`，或者`session['username'] = 'CRC'`在app.py中进行赋值，这样`$context.username`在模板文件中访问时有效。

# .net - 我应该如何设置 WinForms 桌面应用程序以在 Intranet 中远程使用？

> ID：10906964
> 
> 赞同：2
> 
> 时间：2012-06-06T00:54:22.357
> 
> 标签：.net, winforms, desktop-application, remote-access

我必须编写一个驻留在域上的服务器上的桌面应用程序。LAN 上的一些客户端是 PC，一些是 Mac。

*   有哪些方法可以设置用户使用应用程序的环境？
*   在 .NET 4.x 中单击一次部署仍然是一个可行的选项吗？
*   Mac 用户呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T05:56:53.840

这个问题太笼统了，但我会尝试提供一些提示

1.  这是服务器上的应用程序。将其用于客户端的最佳方式 - 让*客户端*应用程序可以连接到服务器并请求信息或向其发送命令。

2.  [ClickOnce 几乎和以前一样工作，文章](http://robindotnet.wordpress.com/2010/05/23/whats-new-in-clickonce-deployment-in-net-4-0/)中提到了更改

3.  如果您遵循第一个答案，那么实现mac客户端也没有问题。你可以使用[mono](http://www.mono-project.com/Main_Page)，或者使用独立于平台的网络协议（例如http），或者webservices作为起点

# javascript - 使用对象原型在 JavaScript 中设置字段的正确方法

> ID：10906969
> 
> 赞同：1
> 
> 时间：2012-06-06T00:55:11.310
> 
> 标签：javascript

我正在尝试找出使用原型设置 JavaScript 对象字段的正确方法。

我可以使用以下内容：

```
function myData() {};
myData.prototype.a = null;
myData.prototype.b = null;
myData.prototype.c = null;

var data = new myData();
data.a = 1;
data.b = 2;
data.c = 3; 
```

但是，这似乎没有遵循适当的封装协议。

或者，我可以这样做：

```
function myData() {
    this._a = null;
    this._b = null;
    this._c = null;
};

myData.prototype.__defineGetter__("a", function() {
    return this._a;
});

myData.prototype.__defineSetter__("a", function(val) {
        this._a = val;
}); 
```

当我的 getter 只是返回私有变量的值而不用它做任何事情时，这种方法似乎有点矫枉过正。

另外，如果我直到稍后才拥有这些值，那么在构造函数中将值设置为 null 是否正确？即 - 我稍后设置它们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T01:18:44.663

JavaScript 是一种动态语言，如果您严格不需要封装那些您不必封装的属性。因此，第一个例子非常好。

否则，如果您需要封装它们，并且您处于符合 ES5 的环境中，则应该使用`get`and `set`，因为`__defineGetter__`and`__defineSetter__`已被弃用且不标准（请参阅：[https ://developer.mozilla.org/en/JavaScript/Reference/ Global_Objects/Object/DefineGetter](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/DefineGetter)和[https://developer.mozilla.org/en/Core_JavaScript_1.5_Guide/Working_with_Objects#Defining_getters_and_setters](https://developer.mozilla.org/en/Core_JavaScript_1.5_Guide/Working_with_Objects#Defining_getters_and_setters)）

一个例子：

```
function MyData() {
    // set to the prototype's value
    var a = this.a;
    var b = this.b;
    var c = this.c;

    Object.defineProperties(this, { 
        "a": {
            get : function(){ return a; },
            set : function(value) { a = value }
         },
         "b": {
            get : function(){ return b; },
            set : function(value) { b = value }
         },
         "c": {
            get : function(){ return c; },
            set : function(value) { c = value }
         }
    });
};

MyData.prototype.a = null;
MyData.prototype.b = null;
MyData.prototype.c = null; 
```

请参见[Object.defineProperties](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/defineProperties)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T02:10:12.767

> am trying to figure out the proper way to set up fields of my JavaScript object

You should define what you mean by "proper".

```
>  var data = new myData();
>  data.a = 1;
>  data.b = 2;
>  data.c = 3; 
```

In the above, you are adding `a`, `b` and `c` properties to the `data` object, you aren't modifying the value of `myData.prototype.a` (i.e. `data[[Prototype]].a`), etc.

> But, this does not seem to follow proper protocol for encapsulation.

You should explain what you mean by that, i.e., what you think the above should achieve.

[ snip `__defineGetter__`, `__defineSetter__` code ]

> This method seems overkill when my getters are just returning the private variable's value

"Private" variables, in the classic sense, don't exist in ECMAScript. You can emulate them with closures though. Have a look at the [module pattern](http://www.adequatelygood.com/2010/3/JavaScript-Module-Pattern-In-Depth).

# opengl - 如何知道顶点何时逆时针

> ID：10906970
> 
> 赞同：3
> 
> 时间：2012-06-06T00:55:13.260
> 
> 标签：opengl, graphics, geometry

如何知道顶点是否逆时针？这：[所以页面](https://stackoverflow.com/questions/9473570/polygon-vertices-clockwise-or-counterclockwise/ "所以页面")

说如果交叉是负的，那么它是顺时针的。向量怎么可能是负数？这没有任何意义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T01:05:02.220

你的问题很好。答案是不平凡的。

你是对的，两个向量的叉积产生第三个向量，并且这些向量都不是*负数*。但是，叉积最常见的用法是 [a] 获取它的散度（这不适用于您的情况）或 [b] 将其与第四个向量点乘。点积是一个标量，当然，它确实可以是负数。

在您的情况下，第四个向量将是从多边形的一个或另一个顶点到观察者视点的向量。*检查生成的点积的符号，它会告诉您观察者看到*的旋转是逆时针（正）还是顺时针（负） 。

 *该技术的缺点是对于那些不精通向量代数的人来说似乎很抽象。然而，缺点远远超过了优点：十字和点技术的速度非常快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T01:03:34.590

结果向量将垂直于两个输入向量——根据输入向量的顺序，它要么指向视图，要么远离视图——或者，如果它平行于视图平面，它当你交换乘法的顺序时，'会朝相反的方向前进。

您将不得不任意选择一些平面，将宇宙的“正面”一半和“负面”一半分开。*

# python - 我在哪里可以找到关于 wxPython 的 Fancytext 的更多信息？

> ID：10906971
> 
> 赞同：2
> 
> 时间：2012-06-06T00:55:23.993
> 
> 标签：python, text, wxpython

我正在尝试为一个学校项目编写一个科学计算器应用程序，并且我想使用 Fancytext 来显示数字/结果，但我不明白 fancytext 是如何工作的。有没有我可以查看的好教程或文档的地方？或者有人可以给我一个快速的运行吗？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T14:53:03.823

您可以在以下位置找到 FancyText 的文档页面：

*   [http://wxpython.org/docs/api/wx.lib.fancytext-module.html](http://wxpython.org/docs/api/wx.lib.fancytext-module.html)
*   [http://xoomer.virgilio.it/infinity77/Phoenix/lib.fancytext.html](http://xoomer.virgilio.it/infinity77/Phoenix/lib.fancytext.html)

我还建议从他们的网站下载 wxPython 演示包。有一个很好的演示展示了如何使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T01:40:09.700

我以前不使用 wxPython。但是，通过谷歌，我得到了[这个](http://www.daniweb.com/software-development/python/threads/128350/starting-wxpython-gui-code/2#post643697)。也许对你有帮助。

# codeigniter - 在 codeigniter 中发送电子邮件

> ID：10906972
> 
> 赞同：0
> 
> 时间：2012-06-06T00:55:26.903
> 
> 标签：codeigniter

嘿任何人都可以帮助我摆脱这个问题，我收到以下错误遇到 PHP 错误

```
Severity: Warning

Message: fsockopen() [function.fsockopen]: unable to connect to ssl://smtp.googlemail.com:587 (Unable to find the socket transport "ssl" - did you forget to enable it when you configured PHP?)

Filename: libraries/Email.php

Line Number: 1689

A PHP Error was encountered

Severity: Warning

Message: fwrite() expects parameter 1 to be resource, boolean given

Filename: libraries/Email.php

Line Number: 1846 
```

我的电子邮件类中有以下代码

```
Class MailSender extends CI_Model{

    function __construct(){
        parent::__construct();
    }

    public function sendMail(){
        $config=array(
                'protocol'=>'smtp',
                'smtp_host'=> 'ssl://smtp.googlemail.com',
                'smtp_port' => 587,
                'smtp_user' => 'bhatta.bj@gmail.com',
                'smtp_pass' => 'signature08'
        );

        $this->load->library('email',$config);
        $this->email->set_newline("\r\n");

        $this->email->from("bhatta.bj@gmail.com");
        $this->email->to("curtains_v@hotmail.com");
        $this->email->subject("this is a sample mail");
        $this->email->message("this is a sample message please check this");

        if($this->email->send()){
            //$data['message']="Email sent successfully";
            return true;

        }else{
            //$data['message']="Couldnt sent the email, please provide me valid email address";
            return false;
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T01:04:02.173

代码工作正常，请确保您已加载 openssl 扩展。

[http://www.devcha.com/2010/01/php-fsockopen-unable-to-connect-ssl.html](http://www.devcha.com/2010/01/php-fsockopen-unable-to-connect-ssl.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T01:03:20.333

您是否实际加载了 openssl 扩展程序？使用 phpinfo();在 .php 文件中查看是否加载了 openssl 扩展或者您是否对导致此问题的 php.ini 进行了任何修改？

# php - 存储货币兑换是MongoDB

> ID：10906973
> 
> 赞同：0
> 
> 时间：2012-06-06T00:55:28.160
> 
> 标签：php, json, mongodb, currency

这是您为 mongoDB 存储货币汇率的方式吗？它确实对我们有用，但是有一些限制，我知道我们是否很难进行日期/时间搜索，而不是我们必须做的是拆分日期和时间，然后将其放在选择下拉列表或其他东西中.

请给我你的意见。

```
{
   "currentexchange": {
     "0": {
       "to": "NZD",
       "rate": "1.2879",
       "updated": "8: 42pm" 
    },
     "1": {
       "to": "USD",
       "rate": "0.9777",
       "updated": "8: 42pm" 
    },
     "2": {
       "to": "KWD",
       "rate": "0.2739",
       "updated": "8: 42pm" 
    },
     "3": {
       "to": "GBP",
       "rate": "0.6354",
       "updated": "8: 42pm" 
    } 
  },
   "exchangehistory": {
     "2012-06-06T09: 51: 25+10: 00": {
       "0": {
         "to": "NZD",
         "rate": "1.2875" 
      },
       "1": {
         "to": "USD",
         "rate": "0.9768" 
      },
       "2": {
         "to": "KWD",
         "rate": "0.2742" 
      },
       "3": {
         "to": "GBP",
         "rate": "0.6351" 
      } 
    },
     "2012-06-06T10: 00: 09+10: 00": {
       "0": {
         "to": "NZD",
         "rate": "1.288" 
      },
       "1": {
         "to": "USD",
         "rate": "0.9774" 
      },
       "2": {
         "to": "KWD",
         "rate": "0.2743" 
      },
       "3": {
         "to": "GBP",
         "rate": "0.6354" 
      } 
    },
     "2012-06-06T10: 15: 07+10: 00": {
       "0": {
         "to": "NZD",
         "rate": "1.2878" 
      },
       "1": {
         "to": "USD",
         "rate": "0.978" 
      },
       "2": {
         "to": "KWD",
         "rate": "0.274" 
      },
       "3": {
         "to": "GBP",
         "rate": "0.6357" 
      } 
    },
     "2012-06-06T10: 30: 10+10: 00": {
       "0": {
         "to": "NZD",
         "rate": "1.2873" 
      },
       "1": {
         "to": "USD",
         "rate": "0.977" 
      },
       "2": {
         "to": "KWD",
         "rate": "0.2737" 
      },
       "3": {
         "to": "GBP",
         "rate": "0.6352" 
      } 
    },
     "2012-06-06T10: 45: 08+10: 00": {
       "0": {
         "to": "NZD",
         "rate": "1.2879" 
      },
       "1": {
         "to": "USD",
         "rate": "0.9777" 
      },
       "2": {
         "to": "KWD",
         "rate": "0.2739" 
      },
       "3": {
         "to": "GBP",
         "rate": "0.6354" 
      } 
    } 
  },
   "from": "AUD" 
} 
```

那么我们如何使用它。

当用户想要提款时，我们需要能够获得他们要求提款的汇率。

我们还需要能够进行实时转换率更改，如果用户有两种类型的货币并且说默认是澳元并且他们以美元支付某人然后我们需要转换它，或者如果他们没有足够的美元并且他们有AUD 然后我们需要投入 AUD 并转换一些来支付剩余的费用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T20:14:50.223

这里有几个问题需要考虑：使用 ID 和多个集合

**标识的使用**

您的数据格式似乎不正确。`currentExchange`在集合中考虑以下内容：

```
"_id" : "AUD",
"NZD": { "rate": "1.2879", "updated": "8: 42pm" },
"USD": { "rate": "0.9777", "updated": "8: 42pm" },
 ... 
```

这将是最容易查询的布局。

**多个集合**

你会想要`currentExchange`分成`exchangeHistory`两个系列。您希望`currentExchange`保持较小，它将利用不同的索引。

当你设计它时，你的文档会变得非常大，然后失败。

# ios - 自定义 BackBarButtonItem

> ID：10906980
> 
> 赞同：7
> 
> 时间：2012-06-06T00:57:59.430
> 
> 标签：ios, user-interface, customization, navigationitem, backbarbuttonitem

我正在尝试使用自定义图像自定义 backBarButtonItem（该图像中包含文本“后退”），这是当前结果：

[http://i.imgur.com/rFxFt.png](http://i.imgur.com/rFxFt.png)

有谁知道为什么会发生这种情况？

这是我在 viewDidLoad 上的代码（实际上在父控制器上运行，然后在具有后退按钮的新控制器上再次运行）

```
UIImage *backButtonImage = [UIImage imageNamed:@"Graphics/Shared/navigation_back_button.png"];

UIBarButtonItem *backButton = [[UIBarButtonItem alloc] 
                               initWithImage:backButtonImage
                               style:UIBarButtonItemStylePlain 
                               target:nil 
                               action:nil];

self.navigationItem.backBarButtonItem = backButton; 
```

编辑：顺便说一句，我正在使用 iOS 5！也许外观代理是可用的，但到目前为止，当我尝试将它用于后退按钮的东西（在 appDelegate 中）时，应用程序简单崩溃。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-06T03:50:13.607

好的，我使用了一些粗略的技巧解决了这个问题，但至少它有效。如果有人确实提出了更标准的解决方案，请告诉我！

这是我的代码：

```
UIImage *backButtonImage = [[UIImage imageNamed:@"Graphics/Shared/navigation_back_button.png"] resizableImageWithCapInsets:UIEdgeInsetsMake(0, 0, 0, 0)];
[[UIBarButtonItem appearance] setBackButtonBackgroundImage:backButtonImage  forState:UIControlStateNormal barMetrics:UIBarMetricsDefault];
[[UIBarButtonItem appearance] setBackButtonTitlePositionAdjustment:UIOffsetMake(0, backButtonImage.size.height*2) forBarMetrics:UIBarMetricsDefault]; 
```

这是在我的 appdelegate 的方法中：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions 
```

为了在将其用作背景时停止拉伸，我使用了[iOS 5 中的想法：如何实现自定义（图像）后退按钮](https://stackoverflow.com/questions/10757565/ios-5-xcode-4-3-2-how-to-implement-a-custom-image-back-button)

但是随后对其进行了调整，而不必设置-

```
self.title = @" "; 
```

在每次视图加载时（这也可能与导航栏标题本身混淆）

我只是将“后退”按钮文本的偏移量设置为图像高度的两倍，所以你永远看不到它。

为什么要解决所有这些麻烦，而不是使用带有自己的方法的左按钮项来弹出视图控制器？

主要原因是您丢失了用于更改视图的标准后退按钮滑动动画。此外，这意味着我不需要使用自定义按钮或编写返回的自定义方法。它只是工作。

希望这也能解决其他人的问题，我知道我被困了 3 个小时！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T01:32:40.670

" `UIBarButtonItemStylePlain`" 名称指定按钮样式。

尝试以这种方式创建后退按钮：

```
UIImage *backButtonImage = [UIImage imageNamed:@"Graphics/Shared/navigation_back_button.png"];
CGRect frameimg = CGRectMake(0, 0, backButtonImage.size.width, backButtonImage.size.height);
UIButton *someButton = [[UIButton alloc] initWithFrame:frameimg];
[someButton setBackgroundImage:backButtonImage forState:UIControlStateNormal];
// you have to do your own backButtonAction to pop the view controller, b.t.w.
[someButton addTarget:self action:@selector(backButtonAction:)
     forControlEvents:UIControlEventTouchUpInside];
[someButton setShowsTouchWhenHighlighted:YES];

UIBarButtonItem *backButton =[[UIBarButtonItem alloc] initWithCustomView:someButton];
[someButton release];

self.navigationItem.backBarButtonItem = backButton; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-13T14:15:21.127

我今天尝试了很多并得到了这个解决方案。它将**背景图像**和**按钮图像**分开，看起来更容易而且不那么棘手。

```
UIImage *bgImage = [UIImage imageNamed:@"the-same-image-as-your-navbar-background-image"];
[[UIBarButtonItem appearance] setBackButtonBackgroundImage:bgImage forState:UIControlStateNormal barMetrics:UIBarMetricsDefault];
[[UIBarButtonItem appearance] setBackButtonBackgroundImage:bgImage forState:UIControlStateHighlighted barMetrics:UIBarMetricsDefault];

UIImage *buttonImage = [UIImage imageNamed:@"your-back-button-image"];
UIBarButtonItem *backButton = [[UIBarButtonItem alloc] initWithImage:buttonImage style:UIBarButtonItemStylePlain target:nil action:nil];
self.navigationItem.backBarButtonItem = backButton; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T01:37:59.090

在这种情况下，我发现替换 barButtonItem 更容易，只需使用自定义按钮即可。

不完全确定你是如何设计你的项目的，但它对我有用。

![自定义按钮的设置](../Images/a8b89f14ea6208c413e621e043cc1f85.png)

![后退按钮，产生的外观](../Images/0fb268b08551e84568345ec4573c5de4.png)

然后将此代码附加到它：

```
//go back to the previous screen

-(IBAction)back{

[self dismissModalViewControllerAnimated:YES];

} 
```

# javascript - 我无法从 mongoosejs findone 中删除结果的属性

> ID：10906986
> 
> 赞同：1
> 
> 时间：2012-06-06T00:59:43.017
> 
> 标签：javascript, express, mongoose

我希望在没有密码的情况下发送结果。然后我做：

```
Delete req.session.user.password
res.send(req.session.user) 
```

密码仍然存在。为什么？
如何删除不想回复的属性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T01:06:59.487

在删除密码之前，您需要将您的 mongoose 用户模型对象转换为纯 JavaScript 对象。

```
var user = req.session.user.toObject();
delete user.password;
res.send(user); 
```

# winpe - WinPE 自动脚本

> ID：10906990
> 
> 赞同：0
> 
> 时间：2012-06-06T01:00:06.023
> 
> 标签：winpe

我刚刚使用 WinPE 3.0 设置了一个可启动的 UFD，我需要它在启动时自动运行几个脚本。

我想知道是否有人对设置自动脚本以列出本地驱动器上的分区、显示系统日期、列出当前 IP 和捕获本地驱动器的图像有任何建议。

如果有人可以提供帮助，那就太好了！谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T13:31:10.087

Build your scripts independently and test their functionality prior to placing them inside of your WinPE. Then mount your winPE so you can edit it and place all of your scripts in the winPE

Mounting command:

> DISM /Mount-WIM /WimFile:C:..[dir of where your wine is located]\ISO\sources\boot.wim /index:1 /MountDir:mount

Then place your scripts inside of a folder inside your mount folder (which now should have stuff inside of it). Once that completed, you can easily call them by modifying the `..\Windows\System32\startnet.cmd` file.

NOTE: **DO NOT REMOVE** the first line `wpeinit`. Just add after it: `start <scriptname.bat or .vbs>`

Save and close.

Keep in mind: if you are doing scripts inside of winPE that handles anything with the NIC, you will need to insert the network drivers into your WinPE. Once your winpe loads, it automatically calls `startnet.cmd` first.

Some tutorials to do so can be located [here](http://www.msfn.org).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-28T19:26:35.510

我在可启动的 WinPE 映像中添加了一个批处理文件来执行其中的许多任务。它首先检查以确保您确实在运行 WinPE（而不是从另一个操作系统运行批处理文件）。

```
set pVersion=WinPE not found
for /F "usebackq tokens=3" %%A IN (`reg query "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\WinPE" /v "Version" 2^>nul ^| find "Version"`) do (
set pVersion=%%A
)
echo WinPE Version: %pVersion%
IF /I "%pVersion%"=="3.0" GOTO ContinueProc
IF /I "%pVersion%"=="4.0" GOTO ContinueProc
echo *************************************************************************
echo **  ERROR: This restore batch file can only be used in WinPE version   **
echo **  3.0 and 4.0                                                        **
echo *************************************************************************
GOTO ExitInstall 
```

然后我通过...向用户列出磁盘 0 的磁盘、卷和分区信息...

```
diskpart /s list.txt 
```

...其中 list.txt 包含...

```
list disk
list volume
select disk 0
list partition
exit 
```

然后我的批处理文件将清理磁盘 0、格式化驱动器并应用磁盘映像。我使用 imagex 来捕获和应用图像。在您的情况下，您声明您想要捕获磁盘映像，您可以对网络驱动器、另一个硬盘驱动器、USB 硬盘驱动器或 UFD 执行此操作。

例如。

```
imagex /capture c: y:\mydiskimage.wim "My system disk" 
```

要列出 IP，您只需运行 ipconfig。

如果希望您的批处理文件在启动时自动运行，您可以尝试编辑/创建一个 winpeshl.ini，如果将其添加到 Windows\System32 文件夹将启动自定义进程。

我确保我有 startnet.cmd，然后列出我想要运行的内容。我添加了 setlw.exe（在线搜索）以确保我的 UFD 始终是驱动器号 Y。然后您可以将批处理文件作为最后一项运行。在此示例中，我还添加了 cmd，以便用户在所有操作完成后收到命令提示符。

```
[LaunchApps]
%SYSTEMDRIVE%\Windows\system32\startnet.cmd
%SYSTEMDRIVE%\Windows\system32\setlw.exe
Y:\sources\mybatchfile.cmd
%SYSTEMDRIVE%\Windows\system32\cmd.exe 
```

注意：我的批处理文件启动的第一个命令之一：

```
chdir /D %~dp0 
```

...将目录更改为批处理文件的位置。

# php - 两张表合为 1 个 SQL 查询

> ID：10906992
> 
> 赞同：0
> 
> 时间：2012-06-06T01:01:10.107
> 
> 标签：php, mysql

我正在使用以下查询按位置在页面上显示一些列表：

```
SELECT *,
 ((ACOS(SIN($lat * PI() / 180) * SIN(gps_lat * PI() / 180) + COS($lat * PI() / 180) * COS(gps_lat * PI() / 180) * COS(($lon - gps_long) * PI() / 180)) * 180 / PI()) * 60 * 1.1515) AS distance 
  FROM listings 
```

我现在还想按其建筑类型过滤上述列表。一个单独的表记录了列表 id 和建筑物类型 id，如下所示：

```
SELECT * 
  FROM building_types_listings 
 WHERE listing_id = listings.id 
   AND building_type_id = '$building_type' 
```

如何将两个查询合并到一个 SQL 语句中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T01:22:03.653

尝试类似：

```
SELECT whatever fields you need,
       ((ACOS(SIN($lat * PI() / 180) * SIN(gps_lat * PI() / 180) + COS($lat * PI() / 180) * COS(gps_lat * PI() / 180) * COS(($lon - gps_long) * PI() / 180)) * 180 / PI()) * 60 * 1.1515) AS distance
FROM listings
  JOIN building_types_listings
    ON listings.id = building_types_listings.listing_id
WHERE building_type_id = '$building_type' 
```

但是，您肯定要重新考虑如何构建查询并将字符串插入其中。如果 $building_type 恰好是（减去双引号）“';DELETE FROM Listings;--” 会发生什么？我建议您依赖一些类似 sprintf 的工具（在 PHP 中，这通常意味着您需要准备好的语句）而不是已弃用的错误功能魔术引号。

# pyqt - 选择后pyqt更改项目

> ID：10906995
> 
> 赞同：0
> 
> 时间：2012-06-06T01:01:24.973
> 
> 标签：pyqt

所以我有一个 AbstractItemModel 并且在我单击加载按钮后，我希望所选项目改变颜色和粗体。我怎么做？

我尝试了类似的东西，`QtCore.QVariant(QtGui.QBrush(QtGui.QColor(QtCore.Qt.red)))`但我的物品都没有改变颜色。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T22:17:00.903

AbstractItemModel 就是这样：抽象。它应该是子类，这意味着您将拥有一些自定义类型的实现。

但是如果你使用的是 QStandardItems，你可以设置它的[前景色](http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/html/qstandarditem.html#setForeground)和[字体](http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/html/qstandarditem.html#setFont)：

```
item.setForeground(QtGui.QColor(QtCore.Qt.red))
font = item.font()
font.setBold(True)
item.setFont(font) 
```

# java - 为什么我要在响应 Servlet 中通过私有成员使用会话？

> ID：10906997
> 
> 赞同：1
> 
> 时间：2012-06-06T01:02:00.747
> 
> 标签：java, session, servlets

我正在构建一个小型扑克应用程序来提高我的 java 技能。我正在以德州扑克格式创建它。

基本上我想在处理我的 AJAX 响应的 servlet 中保持手状态。我猜 servlet 中的成员变量是不安全的，而会话应该是。你能解释一下这个解决方案的正确实现吗？

```
public class PokerClientResponse extends HttpServlet {
private static Logger LOG = Logger.getLogger(PokerClientResponse.class);

private static final long serialVersionUID = 1L;
private HandState handState = null;

public PokerClientResponse() {
    super();
}

protected void doGet(HttpServletRequest request,
        HttpServletResponse response) throws ServletException, IOException {
            //Which is the best way to maintain hand state?

    //Get the State from the session, then increment it
    HttpSession session = request.getSession();
    Object obj = session.getAttribute("handState");

            //Advance the Hand State
    getHandState().goToNextState(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T01:09:01.487

一个 servlet 实例变量（除非它`ThreadLocal`确实是不安全的，因为只有一个 servlet 实例服务于对其映射的所有请求。

您需要做的就是从会话中保存/加载手部状态，这对于每个用户会话¹都是唯一的。删除手状态实例变量。

移除手状态吸气剂。仅在请求处理调用中处理手部状态，并将该手部状态传递给需要它的其他方法（如果有）。

您的代码将更接近于此：

```
protected void doGet(etc) {
    HandState state = (HandState) request.getSession().getAttribute("handState");
    state.nextState();
} 
```

尽管我建议对会话属性键使用常量。

* * *

¹这与每个浏览器窗口或选项卡的唯一性不同；如果您打开了多个窗口或选项卡，它们可能正在共享同一个会话。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T01:10:54.793

对于初学者来说，HTTP 最初的意思是一种无状态协议。那是为了起源...

然后，如果您查看您的代码，请自问：VisitorB 可以访问 VisitorA 的会话吗？

^(*提示：*可能不会。)

所以，你猜对了。您需要为一个用户管理会话的唯一性。内置的会话管理为您提供了这一点。