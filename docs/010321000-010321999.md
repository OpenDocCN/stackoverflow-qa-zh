# StackOverflow 问答 10321000-10321999

# .net - 为什么 Uri 会部分解码查询部分？

> ID：10321003
> 
> 赞同：2
> 
> 时间：2012-04-25T17:49:05.843
> 
> 标签：.net, uri

**背景**：我正在尝试对 MVC 应用程序进行一些 URL 操作。我编写了一个 HtmlHelper 扩展方法，用另一个替换查询字符串值。该方法取当前请求字符串，手动拆分查询部分（以免 Foo=1&Foo=Hello%2c%20World!&Foo=2 被读取为 Foo=1,Hello, World,2），然后尝试使用 UriBuilder 和 Uri 获取 URL。

**问题**：由于某种原因，Uri.ToString 部分解码了查询字符串。作为一个快速测试，我启动了 LINQPad 并运行了以下命令：

```
var ub = new System.UriBuilder("http://foobar");
ub.Query = "NY%26A"; // NY&A
ub.Uri.Dump();
ub.Uri.ToString().Dump();
ub.Uri.Query.Dump();
ub.ToString().Dump(); 
```

结果是：

```
http://foobar/?NY&A
http://foobar/?NY&A
?NY%26A
http://foobar:80/?NY%26A 
```

我说部分解码，因为如果我使用大量转义字符，它会解码一些并保留其他字符：

```
var ub = new System.UriBuilder("http://foobar");
ub.Query = "!%40%23%24%25%5E%26*()"; // !@#$%^&*()
ub.Uri.Dump();
ub.Uri.ToString().Dump();
ub.Uri.Query.Dump();
ub.ToString().Dump(); 
```

结果：

```
http://foobar/?!@%23$%25^&*()
http://foobar/?!@%23$%25^&*()
?!%40%23%24%25%5E%26*()
http://foobar:80/?!%40%23%24%25%5E%26*() 
```

**问题**：有人可以解释发生了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T17:54:14.337

它似乎正在使用“安全”解码。在您的第二个示例中，它不会解码 # 或 %，因为这会改变 URI 的结构/含义。

如果您不希望发生这种解码，请停止调用`.ToString()`URI，而是直接访问您想要的组件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T17:59:01.940

因为 URI 确实使用 url 编码

您可以使用它来读取原始值或将编码值添加到 URI 对象：

```
 System.Web.HttpUtility.UrlDecode("NY%26A");
        System.Web.HttpUtility.UrlEncode("NY&A"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-26T22:24:19.297

如果 Uri 是从字符串构造的，[则 Uri.OriginalString](https://docs.microsoft.com/en-us/dotnet/api/system.uri.originalstring?view=netframework-4.7.2)是一种使用原始编码返回原始字符串的简单方法。

# spring - ApplicationListener 不能用参数参数化？

> ID：10321006
> 
> 赞同：1
> 
> 时间：2012-04-25T17:49:14.510
> 
> 标签：spring, spring-batch

所以我为我的 Spring 批处理程序设置了一个自定义的 ApplicationEvent 和 ApplicationListener。我按照第 3.13.2 节的[说明进行操作](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/htmlsingle/spring-framework-reference.html#context-functionality-events)

这是我创建的 ApplicationEvent

```
import org.springframework.context.ApplicationEvent;

public class DataReaderEvent extends ApplicationEvent {

  private final String progress;
  private final String text;

  public DataReaderEvent(Object source, String progress, String text) {
      super(source);
      this.progress = progress;
      this.text = text;
  }

  public String getProgress() {
      return progress;
  }

  public String getText() {
      return text;
  }

} 
```

还有我的 ApplicationListener

```
import org.springframework.context.ApplicationListener;

public class DataReaderNotifier implements ApplicationListener<DataReaderEvent> {

  private String progress;
  private String text;

  @Override
  public void onApplicationEvent(DataReaderEvent event) {
      this.progress = event.getProgress();
      this.text = event.getText();
  }

  public String getProgress() {
      return progress;
  }

  public String getText() {
      return text;
  }
} 
```

我遇到的问题是 ApplicationListener 抱怨我试图做 ApplicationListener < DataReaderEvent >

它说，“ApplicationListener 类型不是通用的；它不能用参数 DataEventReader 参数化”

我不明白为什么会这样，因为我认为我非常密切地遵循了这个例子。如果有人有任何想法，他们将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T19:11:25.160

您确定您的项目中包含正确的 (3.0.x+) 版本的 Spring 吗？我认为 2.5.x ApplicationListener 不是通用的，所以如果你不小心使用了那个旧版本，那会导致你遇到的问题。

[http://static.springsource.org/spring/docs/2.5.x/api/org/springframework/context/ApplicationListener.html](http://static.springsource.org/spring/docs/2.5.x/api/org/springframework/context/ApplicationListener.html)

# c# - 如何对WPF DataGrid中除第一列之外的所有列进行排序

> ID：10321008
> 
> 赞同：2
> 
> 时间：2012-04-25T17:49:19.060
> 
> 标签：c#, wpf, datagrid

我有一个 WPF DataGrid，它的第一列包含一个数字，即“排名”或“位置”。我想要的是，当我单击一列以根据该列对表格进行排序时，第一列保持原样。

例如：

```
职位名称 比赛积分 PPG
1约翰2 10 5
2 玛丽 3 12 4

```

当按游戏降序排序时，应变为

```
职位名称 比赛积分 PPG
1 玛丽 3 12 4
2约翰2 10 5

```

有没有办法做到这一点？DataColumn 似乎没有任何此类属性，并且 FreezeColumnsCount 仅始终将它们保留在视图中，但不会阻止它们与其余数据一起排序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T18:56:36.657

我会为此使用 a `ValueConverter`。我不能确切地告诉你怎么做，但是，你要查看的是[`ItemContainerGenerator`](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemcontainergenerator.aspx)DataGrid 上的属性。

向您的 ValueConverter添加一个`DataGrid`属性，以便您可以从 Convert 方法访问该属性。现在，在转换中，您需要调用`ContainerFromItem`以获取 UI 对象，然后`IndexFromContainer`获取行的索引。我相信你会遇到一些问题，但这应该让你开始。

这样做的好处是您不必自己进行排序。这将依赖于`SortDescriptions`添加到`ICollectionView`DataGrid 使用的（如果您不绑定到一个，它会自动为您创建）。

**编辑**

这是请求的代码示例。我自己不需要这样做，但这是我要开始的地方。

以下是转换后的建议值的外观

```
public ItemPositionValueConverter : IValueConverter
{
    public DataGrid DataGrid { get; set; }

    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        if (value == null)
        {
            return null;
        }

        if (DataGrid == null)
        {
            return null;
        }

        ItemContainerGenerator generator = DataGrid.ItemContainerGenerator;
        return generator.IndexFromContainer(generator.ContainerFromItem(value));
    }

    //you probably don't need ConvertBack put it is provided for completeness
    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        int? index = value as int?

        if (index == null)
        {
            return null
        }

        if (DataGrid == null)
        {
            return null;
        }

        ItemContainerGenerator generator = DataGrid.ItemContainerGenerator;
        return generator.ItemFromContainer(generator.ContainerFromIndex(index.Value));
    }
} 
```

现在使用这个做类似的事情。

```
<UserControl>
    <UserControl.Resources>
        <ItemPositionValueConverter x:Key=ItemPositionValueConverter"
                                    DataGrid="{Binding ElementName=MyDataGrid}" />
    </UserControl.Resources>

    <DataGrid x:Name="MyDataGrid" ItemsSource="{Binding ....}">
        <DataGrid.Columns> 
            <DataGridTextColumn Header="Position"
                                Binding="{Binding Converter={StaticResource ItemPositionValueConverter}}"/>
        </DataGrid.Columns>
</UserControl> 
```

请注意，使用此解决方案，无需手动将排序添加到 ICollectionView。单击列标题时，将自动应用排序。

**免责声明：此代码已经过测试，可能与描述的功能不完全相同。这里是提供者来演示所需的逻辑。因此，它可能包含拼写错误或错误。任何尝试使用此代码的人都应该执行自己的测试以验证它是否适合他们的需求。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T23:21:25.083

在[http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/ffd7037d-dd77-44ec-9011-d0d43d5706aa/](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/ffd7037d-dd77-44ec-9011-d0d43d5706aa/)我刚刚找到了我在评论中建议的示例（来自 Adbie 的回答） ：

```
<DataGrid LoadingRow="dg_LoadingRow">
    <DataGrid.RowHeaderTemplate>
        <DataTemplate>
            <TextBlock Text="{Binding Path=Header, RelativeSource={RelativeSource AncestorType={x:Type DataGridRow}}}" />
        </DataTemplate>
    </DataGrid.RowHeaderTemplate>
</DataGrid> 
```

```
private void dg_LoadingRow(object sender, DataGridRowEventArgs e)
{
    e.Row.Header = (e.Row.GetIndex() + 1).ToString();
} 
```

**由 OP 编辑​​：**
我刚刚验证它即使没有绑定也可以工作。cs 代码很好，但在 XAML 中你只需要做

```
<DataGrid LoadingRow="dg_LoadingRow" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T20:15:55.653

**新答案：**

所以我的最后一个答案显然不符合标准，我做了一些研究，看起来你可以像这样做你正在寻找的东西：

```
 Dim view As ICollectionView = CollectionViewSource.GetDefaultView(ListViewName.Items)
 view.SortDescriptions.Add(New SortDescription("Field To Sort By", 0)) 
```

**在哪里**

*   'Field to Sort By' 是列名
*   # 方向 0 为升序，1 为降序

**笔记：**

*   您必须在更改列表中同一列的排序顺序之间调用 view.SortDescriptions.Clear()

# radcombobox - 具有多列加载数据的 Telerik RadCombobox 非常慢

> ID：10321009
> 
> 赞同：0
> 
> 时间：2012-04-25T17:49:21.907
> 
> 标签：radcombobox

我正在使用具有多列控件的 Telerik RadCombobox 来加载大约 5000 条记录的数据。当我单击此控件列出数据时它非常慢，而当我过滤数据时它又太慢了。

请问有什么想法、技术或算法可以让它加载得更快吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T08:36:54.033

使用 LoadOnDemand 和虚拟滚动。为了获得最佳性能，通过 WebService 加载项目。这应该通过在小块上加载数据来提高性能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-09T04:52:10.170

我会说你看到的很正常。毕竟，3000 个项目的足迹大约如下：

25 个字节仅用于项目，5 个字节用于基本文本，1 到 4 个字节用于计数器文本。

以及一些 JSON 数据。

乘以 3000，您将关闭超过 100 kb 的回发内容。

旧浏览器，尤其是 IE6、7 和 8，因为内容太多而速度慢是出了名的。此外，该内容需要解析为 HTML 元素和所有 JS 设置。

另一方面，Chrome 速度非常快，100kb 的内容不会减慢它的速度。

为了解决这个问题，您可以使用虚拟滚动而不返回整个数据集。您可以阅读这篇关于虚拟滚动的帮助文章以了解总体思路——http: [//www.telerik.com/help/aspnet-ajax/combobox-load-on-demand-showmoreresultsbox.html](http://www.telerik.com/help/aspnet-ajax/combobox-load-on-demand-showmoreresultsbox.html)。

# spring - Spring Data MongoDB：设置存储库集合？

> ID：10321027
> 
> 赞同：7
> 
> 时间：2012-04-25T17:50:13.183
> 
> 标签：spring, mongodb, autowired

如何指定我希望我的存储库所属的集合？

我的配置：

```
<!-- Database -->
<mongo:mongo id="mongoDb" host="localhost" port="27017"/>
<mongo:db-factory id="mongoDbFactory" mongo-ref="mongoDb" dbname="test"/>

<bean id="mongoTemplate" class="org.springframework.data.mongodb.core.MongoTemplate">
    <constructor-arg name="mongoDbFactory" ref="mongoDbFactory"/>
</bean>

<mongo:repositories base-package="de.cochu.springtest.mongodb.repositories"/> 
```

我的文件：

```
@Document
public class User {

    @Id String id;
    @Indexed String email;

    ...getters and setters omitted...

} 
```

用户集合的存储库（位于 ...mongodb.repositories 包内）。我从 CrudRepository 扩展：

```
public interface UserRepository extends CrudRepository<User, String>{
    User findByEmail(String email);
} 
```

最后，我想在其中使用 UserRepository 的 spring servlet 的控制器：

```
@Controller
public class MyController {

    @Autowire UserRepository repo;

    @RequestMapping("/test.html")
    public String something(HttpServletRequest request) {
        User u = userRepository.findByEmail(request.getParameter("email"));
        ...
    }

} 
```

我通过控制台设置了一些示例用户，mongoTemplate.getCollection("users").count() 工作正常。存储库什么也没找到。

... UserRepository 如何知道我要搜索集合“用户”中的用户？/这是使用存储库的正确方法吗？

... Intellij IDEA 无法识别 UserRepository 的自动装配。尽管它显示错误，但它编译并不会引发异常。有什么我可以做的吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-25T18:14:43.783

这部分文档可能有您正在寻找的答案：

[http://static.springsource.org/spring-data/data-mongodb/docs/current/reference/html/#mongo-template.save-insert.collection](http://static.springsource.org/spring-data/data-mongodb/docs/current/reference/html/#mongo-template.save-insert.collection)

> 有两种方法可以管理用于对文档进行操作的集合名称。使用的默认集合名称是更改为以小写字母开头的类名称。因此 com.test.Person 类将存储在“person”集合中。您可以通过使用 @Document 注释提供不同的集合名称来自定义它。您还可以通过提供您自己的集合名称作为所选 MongoTemplate 方法调用的最后一个参数来覆盖集合名称。

# php - 无法使用 php 在 ajax 中访问我的域之外的 Web 服务

> ID：10321029
> 
> 赞同：0
> 
> 时间：2012-04-25T17:50:25.330
> 
> 标签：php, ajax, cross-domain

我知道我可以通过创建这样的中间文件调用来绕过相同的域策略：

```
$.getJSON('service_facade.php', function(data) {

        options.series = data;
    // Create the chart
    var chart = new Highcharts.Chart(options);
}); 
```

service_facade.php 的内容在 php 中如下所示：

```
print_r($_GET["http://myservice.com/parameters"]); 
```

问题是我正在访问的图表没有呈现。我做错了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T17:52:40.367

这是因为同源策略将 Ajax 请求限制在页面来自的同一域。这意味着您无法访问域外的 Ajax API。

有一个称为[跨域资源共享 (CORS)](http://www.nczonline.net/blog/2010/05/25/cross-domain-ajax-with-cross-origin-resource-sharing/)的规范可以解决这个问题，但我不知道这是否正在实施。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T17:50:01.740

解决同源策略的方法是创建一个 php 文件或类似的文件来为您进行服务交互。它不像 AJAX 那样受策略约束。一旦您调用了执行远程域调用并返回数据的外观 php 文件，您就可以通过 php.ini 访问该数据。

# java - Hibernate 使用复合键加载对象总是返回

> ID：10321033
> 
> 赞同：1
> 
> 时间：2012-04-25T17:50:28.827
> 
> 标签：java, hibernate

这是我的实体的片段（它还创建了哈希码和等号，它们是 java 生成的默认值

```
@Entity 
@Table(name = "media_tspec_external_registry")
public class Registry implements Serializable {

public Registry() {
    //for hibernate :D
}

public Registry(String show, String protocol, String externalEndpoint, String userURI, String version) {
    super();
    this.show = show;
    this.protocol = protocol;
    this.externalEndpoint = externalEndpoint;
    this.userURI = userURI;
    this.version = version;
}

@Id
@Column(name = "show", nullable = false)
private String show;

@Id
@Column(name = "protocol", nullable = false)
private String protocol;

@Column(name = "external_endpoint", nullable = true)
private String externalEndpoint; 
```

这是我的方法，它试图根据这些键值加载一个不存在的实体

```
Registry reg = new Registry("invalid", "idvalue", null, null, null);
    Registry reg2 = null;
    try {

        reg2 = (Registry) session.load(Registry.class, reg);
             } catch (HibernateException e) {
        throw new UserException("A registry entry does not exist for this show: " + show + " and protocol: " + protocol);
        } 
```

它永远不会抛出异常，并且 reg2 现在设置为一个注册表对象，所有字段都设置为 null。

我还注意到负载甚至不会加载现有实体。

但是，如果我改用 get ，它会按预期工作（加载有效对象，为不存在的对象返回 null ）

```
reg2 = (Registry) session.get(Registry.class, reg); 
```

任何解释将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T10:04:15.353

这是预期的行为。session.load 旨在获取可用于满足引用的对象，例如

```
User u = new User();
u.setRole((Role)session.load(Role.class, 5));
session.save(u); 
```

load 不会产生往返。如果没有对可用对象的引用，它将创建一个代理对象，或者在您的情况下将回收您的复合键对象并依赖您该实体存在，因为它无法询问数据库是否存在。

# python - python numpy recarray 加入

> ID：10321036
> 
> 赞同：0
> 
> 时间：2012-04-25T17:50:33.433
> 
> 标签：python, numpy, join, recarray

numpy recarrays中没有“加入”功能吗？我看到 matplotlib 有一些东西并且有一个连接，但这不是一个解决方案。我想快速加入 numpy/scipy 或了解它为什么不存在。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T18:22:22.470

经过一番挖掘，我发现了这个稍微掩埋的图书馆。我认为它可能正在做我需要的事情......也很想听到其他答案。如果这是最好的解决方案，它的文档记录不是很好。我不确定如何贡献文档：

```
import numpy as np
import numpy.lib.recfunctions as rfn

import numpy.random as random

a = random.randn(4,2)
b = random.randn(4,2)

a[1, 0] = 12
b[1, 0] = 12
print(a)
print(b)
a = np.rec.fromrecords(a, names='a,b')
b = np.rec.fromrecords(b, names='a,c')
print(a['a'])
print(b['a'])
c = rfn.join_by('a',a,b,jointype='outer')
print('')
print(c) 
```

# java - JTable Clickable Column Sorting：对单元格内容进行排序，但不更新单元格格式？

> ID：10321038
> 
> 赞同：20
> 
> 时间：2012-04-25T17:50:37.660
> 
> 标签：java, swing, jtable, abstracttablemodel

我有一个可排序的`JTable`设置来使用`AbstractTableModel`. 然而，这个表的某些行为是我所期望的，我希望得到一些关于如何解决这个问题的建议。

我将 JTable 设置为可使用以下命令进行排序：

```
thisJTable.setAutoCreateRowSorter(true); 
```

这使我可以按预期通过单击列标题对表格进行排序。

但是，我发现当我通过单击列标题对表格进行排序时，我的行的格式（背景和前景色）也没有排序。

我已经将这些行设置为根据它们包含的值进行颜色编码。当我按列标题排序时，给定行 NUMBER 的格式保持不变（尽管之前该行中的内容已移动）。

通过覆盖`prepareRenderer`JTable 的默认调用来设置行的颜色：

```
thisTable = new JTable(thisModel){

    //Set up custom rendering - Sets background color of row to correct value
    public Component prepareRenderer(TableCellRenderer renderer, int row, int column) {
        Component c = super.prepareRenderer(renderer, row, column);
        CustTableModel thisModel = (CustTableModel) getModel();
        c.setBackground(thisModel.getRowBackgroundColor(row));
        c.setForeground(thisModel.getRowForeColor(row));
        return c;
    }
}; 
```

有没有更好/不同的方法来解决这个问题？

我是否应该使用不同的方法来进行渲染，一种可以更新 JTable 渲染的方法？

还是我想研究编写自己的排序方法？

**解决方案（感谢 mKorbel！）**

我想我会发布我的解决方案，因为我不确定新索引是否也会传递给prepareRenderer，所以我不得不尝试一下。

```
 thisTable = new JTable(thisModel){

    //Set up custom rendering - Sets background color of row to correct value
    public Component prepareRenderer(TableCellRenderer renderer, int row, int column) {

        int viewIdx = row;
        int modelIdx = convertRowIndexToModel(viewIdx);
        Component c = super.prepareRenderer(renderer, row, column);
        CustTableModel thisModel = (CustTableModel) getModel();
        c.setBackground(thisModel.getRowBackgroundColor(modelIdx));
        c.setForeground(thisModel.getRowForeColor(modelIdx));
        return c;
    }
}; 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-25T17:53:49.300

您必须[将行索引从视图转换为模型](https://stackoverflow.com/a/10281306/714968)

```
int modelRow = convertRowIndexToModel(row); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-05-01T19:50:59.700

您可以通过单击标题来启用表格排序 `table.setAutoCreateRowSorter(true);`

欲了解更多信息，请访问此网站[http://www.codejava.net/java-se/swing/6-techniques-for-sorting-jtable-you-should-know](http://www.codejava.net/java-se/swing/6-techniques-for-sorting-jtable-you-should-know)

# android - 我应该为每个屏幕创建一个活动吗？

> ID：10321039
> 
> 赞同：4
> 
> 时间：2012-04-25T17:50:39.130
> 
> 标签：android, android-layout, android-preferences, android-2.3-gingerbread

我将从一个示例开始...如果您转到*Settings > Applications > Manage applications*，将打开一个新屏幕，其中包含已安装应用程序的列表：如果您单击列表中的任何应用程序，它将打开一个新屏幕，其中包含有关应用程序的信息。

嗯，我的应用程序的一些设置必须通过一个列表来管理，这个列表应该和上面的例子一样。我已经创建了`PreferenceActivity`一些类别，每个类别都有一些项目：当我单击其中一个项目时，我希望它打开一个新屏幕，将新数据放在列表中，就像上述例子的应用。此外，当我单击此列表的任何条目时，它将打开一个新屏幕以设置一些数据。

我应该如何进行？我应该为每个屏幕创建一个活动吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T18:03:10.707

根据文档“活动是用户可以做的一个单一的、专注的事情”，Android 就是这样创建的，所以是的，每个屏幕都应该有一个活动。随着 Fragments 的引入，Honeycomb 对此有所改变，但如果您不是为平板电脑开发，您应该在 Android 上保持一页一活的心态。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T18:03:22.203

通常，每个活动都被另一个活动调用，调用者被推入堆栈（除非调用活动要求被删除）并处于休眠状态直到它返回

基本上，您在 Activity A 中创建一个 Intent 来启动 Activity B，您可以使用 startActivityForResult 和 Intent 中的附加功能[来传递数据示例：如何在活动之间传递数据](http://mobileorchard.com/android-app-development-using-intents-to-pass-data-and-return-results-between-activities/)

当您按下后退按钮时，之前的活动再次变为活动状态，您设置的结果处理程序可以获得任何返回数据。

如果您想提供外观和行为更好的平板电脑支持，您还可以查看支持 API 中的片段。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-25T18:02:44.857

我能够在工作中实现它，我现在不记得我是如何实现它的，那是很久以前的事了。如果没有人给你一个好的答案，我明天会发布它：我记得放了一个 Preference，它将作为一个按钮，然后我添加了一个 preferenceClickListener 以便在点击时打开一个新的 PreferenceScreen。但是就像我说的，如果您没有得到满意的答案，我明天会为您发布。

祝你好运！

更新：

```
?xml version="1.0" encoding="utf-8"?>
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android">
<PreferenceCategory
    android:title="Personal"
    android:key="personal_category">
    <Preference
        android:key="birth"
        android:title="Birth"
        android:summary="Choose your birthday"/> 
    <PreferenceScreen 
        android:key="height_imp"
        android:title="Height"
        android:summary="Enter your height">
        <EditTextPreference
            android:key="foot"
            android:title="Foot" 
            android:summary="foot"
            android:numeric="integer"
            android:dialogTitle="Foot"/>
        <EditTextPreference
            android:key="inch"
            android:title="Inch" 
            android:summary="inch"
            android:numeric="integer"
            android:dialogTitle="Inch"/>
    </PreferenceScreen>
    <EditTextPreference
        android:key="weight"
        android:title="Weight" 
        android:summary="Enter your weight"
        android:numeric="integer"
        android:dialogTitle="Weight"/>    
</PreferenceCategory>
</PreferenceScreen> 
```

而已！当您单击它时，它将带您进入第二个 PreferenceScreen 等等，最后当您需要自定义布局时，您需要打开一个 Activity。然后，您可以使用 Preference 并添加 onPreferenceClick：

```
@Override
public boolean onPreferenceClick(Preference preference) {
    if(preference == birth){
        startActivity(new Intent(getBaseContext(), Birth.class));
    }
    if(preference == height_imp){
        PreferenceScreen a = (PreferenceScreen) preference;
        a.getDialog().getWindow().setBackgroundDrawable(new ColorDrawable(Color.WHITE));
        return false;
    }
    return true;
} 
```

如果您需要使用 preferenceScreen 更改背景或其他内容，请同时添加一个 preferenceClickListener：`height_imp = (PreferenceScreen)getPreferenceScreen().findPreference("height_imp"); height_imp.setOnPreferenceClickListener(this);`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-25T17:59:58.453

这可能是最好的方法，至少如果您不从事向导风格的活动。

使用[ListActivity](http://developer.android.com/reference/android/app/ListActivity.html)显示您的列表，并使用 intents 将数据传入和传出此[活动](http://developer.android.com/reference/android/content/Intent.html)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-25T17:57:48.633

看看......如果用户想要从某个点返回到之前的位置......如果你为他们每个人创建了一个单独的活动......当前的活动将从堆栈中弹出......让上一个活动要显示...如果您要更改每个新屏幕的列表内容...而不是创建新活动...那么用户将很难回来...您应该一次又一次地更改适配器的内容..所以我认为..为每个屏幕创建单独的活动更好..（并且您可以对所有活动使用相同的[任何自定义布局]布局文件..）

# perl - 是否有列出美国邮政编码和州的 CPAN 模块？

> ID：10321045
> 
> 赞同：4
> 
> 时间：2012-04-25T17:51:16.937
> 
> 标签：perl, perl-module, zipcode

基本上，我正在寻找一个可以告诉我的模块：

1.  给定州的所有邮政编码
2.  给定的邮政编码是否处于给定的状态
3.  给定邮政编码所属的州

我希望它是独立的，所以我不会拉一大堆依赖项。

我基本上是在问这个问题，因为我即将使用[在美国人口普查局网站上找到的这个文件](http://www.census.gov/tiger/tms/gazetteer/zips.txt)生成一个模块，如果已经存在合适的东西，我不想在上面浪费时间。

我不打算按邮政编码查找城市名称，所以我不在乎，例如，Tiger 文件认为`14850`仅适用于伊萨卡学院，但我也不知道该文件是否还有其他问题。

如果您不知道合适的 CPAN 模块，我也会感谢您对此类模块的命名建议以及更好的数据源。

我有一种感觉，USPS 想要对适当的清单收费，而[美国人口普查局对此不感兴趣](http://www.census.gov/geo/www/tiger/tigermap.html#ZIP)：

> 过去，人口普查局制作了 1990 Gazetteer ZIP Code 文件和 1999 ZIP Code 文件。这些文件是人口普查局内部运作的副产品。它们不是作为正式产品开发的。但是，人口普查局已“按原样”向公众提供。这些文件不会有更新版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:34:10.147

US Postal Service 确实提供了对[地址信息 API](https://www.usps.com/business/web-tools-apis/welcome.htm)的访问权限。我不知道如何回答“将托管 USPS Web 工具的网站的网站地址 (URL) 是什么？” 出于包装查找表的简单目的，但我在这里提到它以防其他人发现它有用。

根据用户的目标，[pe.usps.gov/text/LabelingLists](http://pe.usps.com/Archive/HTML/DMMArchive20070717/labeling_lists.htm) / 中的标签列表之一可能是合适的。看起来我将使用其中一个表作为减少要检查的案例数量的第一步。

最后，[亚马逊 AWS 上的 Twilio/Wigle.net 街道矢量数据集](http://aws.amazon.com/datasets/2408)可能会提供您可能需要的所有详细信息，但我没有检查您是否可以按州列出邮政编码。

# wordpress - 某个帖子 tag_ID 内的帖子

> ID：10321057
> 
> 赞同：0
> 
> 时间：2012-04-25T17:52:22.693
> 
> 标签：wordpress, custom-post-type

我希望能够使用 has_term 函数不仅可以找到类别，而且如果帖子与 has_term 匹配，还可以使用条件语句执行某些操作。这不起作用。例如：

```
if (has_term('28', 'product_cat')){
    //do something
} 
```

这仅在查看 tag_ID 28 时才起作用，而不是在 tag_ID 28 内的帖子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T04:58:39.607

函数 has_term 的用法是：

```
<?php has_term( $term, $taxonomy, $post ) ?> 
```

[查看此法典页面](http://codex.wordpress.org/Function_Reference/has_term)以获取更多详细信息。我认为您还需要在该函数中指定帖子 ID。默认将仅检查当前帖子。

# android - 在 Android 应用程序中实现 Windows Phone 7 寻呼机（选项卡切换、枢轴、全景图等）UI？

> ID：10321058
> 
> 赞同：2
> 
> 时间：2012-04-25T17:52:31.243
> 
> 标签：android, windows-phone-7, user-interface, android-viewpager

有人可以帮我弄清楚如何在 Windows Phone 7 中将 Pager UI 编码到 Android 应用程序中吗？我指的是在多个选项卡（或页面，如果你愿意的话）之间切换的行为。我知道如何使用 View Pagers，但我无法弄清楚这样做的逻辑。

例如在[https://play.google.com/store/apps/details?id=app.odesanmi.and.wpmusic中实现的艺术家、专辑等之间的切换](https://play.google.com/store/apps/details?id=app.odesanmi.and.wpmusic)

或者在 Launcher 7 [https://play.google.com/store/apps/details?id=info.tikuwarez.launcher3&feature=more_from_developer#?t=W251bGwsMSwxLDEwMiwiaW5mby50aWt1d2FyZXoubGF1bmNoZXIzIl0](https://play.google.com/store/apps/details?id=info.tikuwarez.launcher3&feature=more_from_developer#?t=W251bGwsMSwxLDEwMiwiaW5mby50aWt1d2FyZXoubGF1bmNoZXIzIl0)中实现的设置。

非常具体地说，我想知道如何将这些选项卡名称与实际页面一起切换。我想知道这是否可能使用两个 Viewpager，但我不确定如何同步它们，如果这样的事情是可能的。

# spring - 服务未注入 Grails 域类、Grails 2.0.0 和 2.0.3

> ID：10321059
> 
> 赞同：1
> 
> 时间：2012-04-25T17:52:36.133
> 
> 标签：spring, grails

我尝试了多次应用重启，并从 2.0.0 升级到 2.0.3，没有帮助。我总是收到这样的信息：

```
:   def getCustomerName(){64:       customerService.name
"Cannot get property 'name' on null object" 
```

相关领域类部分：

```
class Instance {
    def customerService
    ...

    def getCustomerName(){
        customerService.name
    } 
```

相关服务等级：

```
class CustomerService { 
```

我正在尝试从可以访问实例对象的视图中访问 getCustomerName 方法。还尝试了其他服务，结果相同。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T22:26:30.153

这里只是一个猜测 - 下面的内容就像一个 getter 方法：

```
 def getCustomerName() 
```

框架是否有可能在依赖注入发生之前检查 getter 和 setter 方法的有效性？

几年前，Burt 回答了一个关于在 onLoad() 中使用依赖注入的问题，看来这就是正在发生的事情。他建议：

添加此导入：

```
 import org.codehaus.groovy.grails.commons.ApplicationHolder as AH 
```

然后将客户服务引用为

```
 def customerService = AH.application.mainContext.customerService 
```

# html - 在 jsps 中使用 c:import 导入的 HTML 中使用 SSI

> ID：10321061
> 
> 赞同：0
> 
> 时间：2012-04-25T17:52:40.820
> 
> 标签：html, jsp, ssi

我在 htdocs 区域的网络服务器上下文（应用程序上下文之外）中有一堆 html。这些 html 使用 SSI 调用其他 html。

问题出在：当我使用 c:import 将主 html 调用到 jsp 中时，主 html 内的辅助 html 不呈现 / 不被处理。

有没有办法让主html“编译”然后返回jsp？

JSP 代码：

```
<c:import url="<%=/folder/Header.html%>" 
```

需要处理的 HTML 服务器端逻辑：

```
<!--#include virtual="/abc/xyz.html" -->
<!--#if expr='"$Category" = "someCategory"' -->
<!--#echo var="pageTitle" --> 
```

原型都是以 html 形式给出的，所以一切都在 web 上下文中，所有文件都运行良好。问题是将顶层移动到 JSP 并将其余层保持为 HTML。（这是一个要求）

欢迎任何解决方案/想法/想法！感谢您的协助！

海浪

编辑：好的，我在 iFrame 中获取 Header.html，因为这将启动一个新的 HTTP 请求（因此可以访问 SSI 逻辑）。

```
<iframe id="testSSI" src ="http://somesite.com/subfolder/testssi_1.html?pageTitle=Applications" frameborder="0" width="800px" height="300"></iframe> 
```

参数在 URL 中发送，我已经设法使用 js 提取控制参数。

我的查询已简化为：如何在 SSI 逻辑中访问此 js 值“应用程序”？是否可以将 is 设置为环境变量？这可以由 SSI 逻辑拉动。我意识到 Js 将在 SSI 完成后运行，但希望这里有人能够提供帮助。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T20:00:36.637

谢谢，搞定了

我使用 QUERY_STRING 环境变量访问了 SSI 中的参数。html调用示例：

```
http://somesite.com/subfolder/testssi_1.html?Applications 
```

我如何检索值的示例：

```
<!--#set var="pageTitle" value="$QUERY_STRING" -->
<!--#if expr=" ${pageTitle} = Program "  -->
  do something
<!--#else -->
  do something else
<!--#endif --> 
```

这里的目标：我们使用 JAVA 框架。但是营销部门希望他们可以在单独的过程中编辑内容。这样，他们可以频繁地更改内容，而无需 jsp / java 团队的干预。（例如，更改标题外观、添加新链接等）

希望这对以后的人有所帮助。:)

海浪

编辑：在上面的示例中->“应用程序”会将逻辑带到 else 部分。此外，要发送名称值对：

```
http://somesite.com/subfolder/testssi_1.html?name=Applications&app=Demo 
```

您可以将它们引用为：

```
<!--#if expr=" ${QUERY_STRING} = /name=Applications/ "  --> 
```

和

```
<!--#if expr=" ${QUERY_STRING} = /app=Demo/ "  --> 
```

# java - vaadin 表单无法隐藏空字段

> ID：10321066
> 
> 赞同：0
> 
> 时间：2012-04-25T17:53:26.040
> 
> 标签：java, forms, user-interface, field, vaadin

我有一些在事件发生后重新加载的 vaadin 表单。该事件导致某些字段变为空。这意味着表单显示字段的标签和“null”。我希望在加载事件后标签和“null”值都消失。我也想这样做而不加载不同的表单来用空值替换表单。

我有以下表单构造函数：

```
 public IInfoForm(Info info) {
    List<Object> orderedProperties =Arrays.asList(InfoContainer.DISPLAYED_FIELDS);
    setItemDataSource(new BeanItem(idInfo), orderedProperties); 
```

info 容器从 web 服务中检索数据，并且 DISPLAYED_FIELDS 列出要显示的字段。
我曾尝试寻找要在表单字段上设置的属性，但无济于事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:06:46.053

您可以为任何字段设置一个代表空值的特殊值。例子：

```
TextField textfield = new TextField();
textfield.setNullRepresentation("abc"); 
```

因此，在文本字段中表示“abc”而不是 null。

自己创建字段并添加它们或将 FieldFactory 添加到表单。

```
Form form = new Form();
form.setFormFieldFactory(new FormFieldFactory() {
    public Field createField(Item item, Object propertyId,
            Component uiContext) {
        Field field = DefaultFieldFactory.get().createField(item,
                propertyId, uiContext);
        if (field instanceof TextField) {
            ((TextField) field).setNullRepresentation("abc");
        }
        return field;
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T19:52:48.813

我会尝试这样做，以便从 orderedProperties 列表中删除具有空值的字段并调用

```
setItemDataSource(new BeanItem(idInfo), orderedProperties); 
```

与该列表。

# windows - 为 /24 网络中的每台活着的机器运行一个批处理文件

> ID：10321067
> 
> 赞同：1
> 
> 时间：2012-04-25T17:53:27.240
> 
> 标签：windows, batch-file

当前形式的脚本

```
@echo on

setlocal EnableDelayedExpansion

set /p ipAddress="enter ip address: "

rem right now the loop is set to (1,1,50) for the sake of testing

for /l %%i in (1,1,50) do (
ping -n 1 %ipAddress%.%%i | find "TTL" > nul

if !errorlevel! == 0 (
deploy_mir.bat %ipAddress%.%%i

)
)

endlocal 
```

然后在已知的在线主机（10.167.194.22）上运行它的结果是

```
C:\DOCUME~1\socuser2\MIR>test.bat

C:\DOCUME~1\socuser2\MIR>setlocal EnableDelayedExpansion

C:\DOCUME~1\socuser2\MIR>set /p ipAddress="enter ip address: "
enter ip address: 10.167.194

C:\DOCUME~1\socuser2\MIR>for /L %i in (22 1 50) do (
ping -n 1 10.167.194.%i   | find "TTL"  1>nul
if !errorlevel! == 0 (deploy_mir.bat 10.167.194.%i )
)

C:\DOCUME~1\socuser2\MIR>(
ping -n 1 10.167.194.22   | find "TTL"  1>nul
if !errorlevel! == 0 (deploy_mir.bat 10.167.194.22 )
)
"Mir Agent deployment to: 10.167.194.22" 
```

现在最后一行意味着 !errorlevel! == 0（即，确实找到了“TTL”）所以到目前为止，脚本似乎正在运行。然而，在下一个循环中， 10.167.194.23 (alive) 以及 .30 和 .46 被跳过。我决定添加

```
echo %errorlevel% 
```

在循环结束时查看这里发生了什么。显然，在每次 ping %errorlevel% 为 0 之后如此清晰

```
ping -n %ipAddress%.%%i | find "TTL" >nul 
```

是我的问题所在。根据这个说法，每次 ping 后都会发现“TTL”，这是错误的，在 10.167.194.22-.50 之间只有 3 台机器处于活动状态。

顺便说一句，当我这样做的时候

```
!errorlevel! == 0 
```

这意味着什么？

**这条线以下的所有内容截至 2012 年 4 月 26 日**

```
So my new script looks like this 

@echo on

set /p ipAddress="enter ip address: "

set i=
for /l %%i in (1,1,255) do (
ping -n 1 %ipAddress%.%%i> test.txt
find "TTL" test.txt
if %errorlevel% == 0 (
deploy_this.bat %ipaddress%.%%i
) 
```

我首先尝试了没有 if errorlevel 检查的脚本，它运行良好。它开始 ping 我提供的 IP 地址并继续到 .2 .3 .4 .5 等等。

然而，一旦我添加了这个......

```
if %errorlevel% == 0 (
deploy_this.bat %ipaddress%.%%i
) 
```

这就是发生的事情

```
C:\DOCUME~1\socuser2\MIR>test.bat
C:\DOCUME~1\socuser2\MIR>set /p ipAddress="enter ip address: "
enter ip address: 10.167.201
C:\DOCUME~1\socuser2\MIR>set i=
C:\DOCUME~1\socuser2\MIR> 
```

脚本就停止了。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T18:57:35.190

有几个问题：

*   除非您使用该`call`语句，否则批处理文件将永远不会返回
*   你少了一个括号
*   在 FOR 循环中，您必须`enabledelayedexpansion`使用`!ERRROLEVEL!`

我建议你看看这段代码，它有一些改进：

*   它使用 setlocal 将其变量保留给自己
*   它不会生成临时文件
*   可以从命令行获取 ip 地址或提示输入
*   它是缩进的
*   它的输出不那么冗长

这里是 ：

```
@echo off

setlocal EnableDelayedExpansion

set ipAddress=%1

if "%ipAddress%"=="" SET /P ipAddress="enter ip address: "

for /l %%i in (1,1,2) do (

    rem Remove the > nul at the end if you want to 
    rem see the ping results in the output
    ping -n 1 %ipAddress%.%%i | find "TTL" > nul

    if !ERRORLEVEL! == 0 (
       call deploy_this.bat %ipAddress%.%%i
    )
)

endlocal 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T14:33:13.170

也许我会像这样重写你的循环：

```
FOR /L %%i IN (1,1,50) DO (
  ping -n 1 %ipAddress%.%%i | find "TTL" >NUL && (
    CALL deploy_mir.bat %ipAddress%.%%i
  )
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T06:21:24.117

与语言无关的 ping 回复分析如下：

```
 ping -n 1 %ipAddress%.%%i
  if errorlevel 1 goto :dead 
```

# zend-framework - 在zend框架中，使用表数据网关有什么限制？

> ID：10321070
> 
> 赞同：1
> 
> 时间：2012-04-25T17:53:38.643
> 
> 标签：zend-framework

我正在阅读 Rob Allen 的 zend 框架教程。我正在开发一个开始时很小的应用程序，但我希望它具有可扩展性，因此以下语句引起了我的注意：

> “对于本教程，我们将创建一个扩展 Zend_Db_Table 并使用 Zend_Db_Table_Row 的模型。Zend 框架提供 Zend_Db_Table 实现表数据网关设计模式以允许与数据库表中的数据进行交互。请注意，表数据网关模式在更大的系统中可能会受到限制。还有一种诱惑是将数据库访问代码放入控制器操作方法中，因为这些由 Zend_Db_Table 公开。

谁能告诉我这将如何限制更大的系统？有哪些替代方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T07:03:36.463

另一种方法是 DataMapper。您在这里对这些不同的模式有一个很好的解释：[数据映射器、表数据网关（网关）、数据访问对象（DAO）和存储库模式之间有什么区别？](https://stackoverflow.com/questions/804751/what-is-the-difference-between-the-data-mapper-table-data-gateway-gateway-da)

与表数据网关相比，DataMapper 与数据库的耦合更少，表数据网关是单个表的瘦包装器。

ZF1 中的 Zend_Db 有严重的局限性。Doctrine2 是封装与持久层交互的更好选择。

# linux - 可以从 perf.data 文件生成 perf-stat 结果吗？

> ID：10321073
> 
> 赞同：8
> 
> 时间：2012-04-25T17:53:47.330
> 
> 标签：linux, performance, profiling, performancecounter, perf

当我想使用 Linux 工具套件[perf](http://code.google.com/p/kernel/wiki/PerfUserGuide)中的 perf-stat 和 perf-report 生成性能报告时，我运行：

```
$ perf record -o my.perf.data myCmd
$ perf report -i my.perf.data 
```

和：

```
$ perf stat myCmd 
```

但这意味着我第二次运行“myCmd”，这需要几分钟。相反，我希望：

```
$ perf stat -i my.perf.data 
```

但与 perf 套件中的大多数工具不同，我没有看到 perf-stat 的 -i 选项。是否有另一种工具可以做到这一点，或者有一种方法可以让 perf-report 生成与 perf-stat 类似的输出？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T23:29:30.303

我在 kernel.org 上挖掘了源代码，看起来没有办法让 perf stat 解析 perf.data

[http://git.kernel.org/?p=linux/kernel/git/stable/linux-stable.git;a=blob;f=tools/perf/builtin-stat.c;h=c70d72003557f17f29345b0f219dc5ca9f572d75;hb=refs /heads/linux-2.6.33.y](http://git.kernel.org/?p=linux/kernel/git/stable/linux-stable.git;a=blob;f=tools/perf/builtin-stat.c;h=c70d72003557f17f29345b0f219dc5ca9f572d75;hb=refs/heads/linux-2.6.33.y)

如果您查看第 245 行，您会看到函数“run_perf_stat”，而 308-320 周围的行似乎是实际进行记录和整理的内容。

我没有深入研究这一点，以确定是否可以启用您想要的那种功能。

看起来 perf 报告没有很多额外的格式化功能。如果您喜欢这里，您可以进一步检查：

[http://git.kernel.org/?p=linux/kernel/git/stable/linux-stable.git;a=blob;f=tools/perf/builtin-report.c;h=860f1eeeea7dbf8e43779308eaaffb1dbcf79d10;hb=refs /heads/linux-2.6.33.y](http://git.kernel.org/?p=linux/kernel/git/stable/linux-stable.git;a=blob;f=tools/perf/builtin-report.c;h=860f1eeeea7dbf8e43779308eaaffb1dbcf79d10;hb=refs/heads/linux-2.6.33.y)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-06-29T21:39:43.937

`perf stat`不能用于解析`perf.data`文件，但您可以要求`perf report`打印带有事件计数估计的标题`perf report --header |egrep Event\|Samples`。只有记录到`perf.data`文件中的事件才会被估计。

在计数模式下使用硬件性能监控单元，并且/`perf stat`与[perf.data](https://en.wikipedia.org/wiki/Hardware_performance_counter)`perf record`文件`perf report`使用在周期性溢出模式（[采样分析](https://en.wikipedia.org/wiki/Profiling_(computer_programming)#Statistical_profilers)）中配置的相同硬件单元。在这两种模式下，[硬件性能计数器](https://en.wikipedia.org/wiki/Hardware_performance_counter)都通过它们的控制寄存器设置到一组性能事件（例如 CPU 周期或执行的指令）中，并且计数器将在硬件的每个事件上递增。

在计数模式下`perf stat`，使用最初在程序启动时设置为零的计数器，它们由硬件递增，并且 perf 将在程序退出时读取最终计数器值（实际上计数将由 OS 分成几个段，最终结果相似 - 完整程序运行的单个值）。

在分析模式下`perf record`，会将每个硬件计数器设置为某个负值，例如`-200000`，溢出处理程序将被注册并启用（实际值将由操作系统内核自动调整为某个频率）。每计数 200000 个事件，计数器将从 -1 溢出到零并产生溢出中断。`perf_events`中断处理程序会将“样本”（当前时间、pid、指令指针、可选`-g`模式下的调用堆栈）记录到环形缓冲区（由 perf 映射），其中的数据将保存到`perf.data`. 此处理程序还将`-200000`再次重置计数器。因此，经过足够长的运行后，将存储许多样本`perf.data`. 该样本集可用于生成程序的统计配置文件（程序的哪些部分确实运行得更频繁）。但是，如果每 200000 个事件生成每个样本，我们也可以对总事件进行一些估计。由于内核的值自动调整（它试图以 4000 Hz 生成样本）估计会更加困难，使用类似`-c 1000000`禁用采样周期的自动调整的东西。

`perf stat`默认模式下显示什么？对于某些 x86_64 cpu，我有：程序的运行时间（任务时钟和经过）、3 个软件事件（上下文切换、cpu 迁移、页面错误）、4 个硬件计数器：周期、指令、分支、分支未命中：

```
$ echo '3^123456%3' | perf stat bc
0
 Performance counter stats for 'bc':
        325.604672      task-clock (msec)         #    0.998 CPUs utilized          
                 0      context-switches          #    0.000 K/sec                  
                 0      cpu-migrations            #    0.000 K/sec                  
               181      page-faults               #    0.556 K/sec                  
       828,234,675      cycles                    #    2.544 GHz                    
     1,840,146,399      instructions              #    2.22  insn per cycle         
       348,965,282      branches                  # 1071.745 M/sec                  
        15,385,371      branch-misses             #    4.41% of all branches        
       0.326152702 seconds time elapsed 
```

`perf record`默认模式下记录什么？当硬件事件可用时，它是周期事件。在单次唤醒（环形缓冲区溢出）中，perf 确实将 1246 个样本保存到 perf.data

```
$ echo '3^123456%3' | perf record bc
[ perf record: Woken up 1 times to write data ]
[ perf record: Captured and wrote 0.049 MB perf.data (1293 samples) ] 
```

使用`perf report --header|less`,您可以查看 perf.data 内容`perf script`：`perf script -D`

```
$ perf report --header |grep event
# event : name = cycles:uppp, , size = 112, { sample_period, sample_freq } = 4000, sample_type = IP|TID|TIME|PERIOD ...
# Samples: 1K of event 'cycles:uppp'
$ perf script 2>/dev/null |grep cycles|wc -l 
1293 
```

perf.data 中有一些时间戳和一些用于程序启动和退出的附加事件 ( `perf script -D |egrep exec\|EXIT`)，但默认情况下没有足够的信息`perf.data`来完全重建`perf stat`输出。运行时间仅记录为开始和退出的时间戳，并且对于每个事件样本，不记录软件事件，并且使用单个硬件事件（循环；但没有指令、分支、分支未命中）。可以使用硬件计数器的近似值，但并不精确（实际周期约为 820-8.25 亿）：

```
$ perf report --header |grep Event
# Event count (approx.): 836622729 
```

`perf.data`可以通过以下方式估计更多事件的非默认记录`perf report`：

```
$ echo '3^123456%3' | perf record -e cycles,instructions,branches,branch-misses bc
[ perf record: Captured and wrote 0.238 MB perf.data (5164 samples) ]
$ perf report --header |egrep Event\|Samples
# Samples: 1K of event 'cycles'
# Event count (approx.): 834809036
# Samples: 1K of event 'instructions'
# Event count (approx.): 1834083643
# Samples: 1K of event 'branches'
# Event count (approx.): 347750459
# Samples: 1K of event 'branch-misses'
# Event count (approx.): 15382047 
```

可以使用固定周期，但是如果`-c`选项的值太低，内核可能会限制一些事件（样本的生成频率不应超过每秒 1000-4000 次）：

```
$ echo '3^123456%3' | perf record -e cycles,instructions,branches,branch-misses -c 1000000 bc
$ perf report --header |egrep Event\|Samples
[ perf record: Captured and wrote 0.118 MB perf.data (3029 samples) ]
# Samples: 823  of event 'cycles'
# Event count (approx.): 823000000
# Samples: 1K of event 'instructions'
# Event count (approx.): 1842000000
# Samples: 349  of event 'branches'
# Event count (approx.): 349000000
# Samples: 15  of event 'branch-misses'
# Event count (approx.): 15000000 
```

# c# - 如何使用 MVP 模式在 Winforms 中构建项目？

> ID：10321074
> 
> 赞同：6
> 
> 时间：2012-04-25T17:53:47.693
> 
> 标签：c#, .net, winforms, mvp, projects-and-solutions

我打算用 Winform 构建应用程序，我想使用 MVP 模式。

由于我以前从未使用过 MVP 模式，因此我不确定如何构建新项目。

我是否应该使用与 ASP.NET MVC 相同的约定，例如在项目中为 Models、Presenters 和 Views 创建单独的文件夹，然后可能使用 Presenter 类的命名约定，以便它们的名称以单词“Presenter”结尾（与MVC 中的控制器以“Controller”结尾）

或者我应该为 Presenter 和 Model 创建单独的项目？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T21:09:33.907

老实说，这是一个非常主观的问题。我今天这样做的方式可能不是我为下一个应用程序这样做的方式。它对我来说效果很好。此外，对我有用的可能不是其他人会做的方式——不是我的错误、更好或更坏。

命名约定将有助于：

*   个人演示者
*   PersonViewModel（如果数据被读/写到数据存储）
*   人物视图
*   IPersonView

此外，我将当前的解决方案分为 3 个项目：

*   应用程序本身 - 该项目中唯一的类是 Program.cs
*   演示模型：演示者、视图界面、视图模型（如果适用）；全部在按各自视图组织的文件夹中
*   视图：仅用于视图的项目

现在，我需要为单元测试参考的唯一解决方案是 PresentationModels 项目。

# java - 与 JBOSS 进行网站开发

> ID：10321078
> 
> 赞同：3
> 
> 时间：2012-04-25T17:54:00.983
> 
> 标签：java, ant, jboss, web

在我公司，大约有 30-40 名开发人员，他们都在从事同一个网站开发项目。项目分为许多模块。我的问题是每个开发人员都运行自己的 JBOSS 来运行他的 JAVA 代码。使用 Ant，他们构建 Ear 文件并将它们部署到在本地桌面上运行的 JBOSS 上。这需要巨大的内存并减慢桌面速度。如果我们可以在不同的服务器机器上运行 JBOSS 并且所有开发人员都使用这台机器同时运行和测试他们的代码，这不是可能的吗？希望你们明白我的问题吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:03:33.117

您可以设置像[Jenkins](https://wiki.jenkins-ci.org/display/JENKINS/Meet+Jenkins)这样的持续集成服务器。使用 Jenkins，您有不同的“项目”。每个项目构建代码并运行一个 JBoss 实例。

使用 Jenkins，您可以为每个开发人员创建一个不同的项目（如果这是您想要的），并且您可以在每次开发人员签入代码时获得 Jenkins 编译和运行单元测试的额外好处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T04:49:46.910

这是可能的。您可以通过在特定 IP 上运行 JBOSS 应用程序服务器来实现这一点。要做到这一点，您必须使用 ./run.sh -b 后跟要运行应用程序服务器的机器的 IP 地址. 这样你的服务器就准备好了。现在每个客户端都必须在该 IP 地址的帮助下连接到服务器。为此，你将环回地址 (127.0.0.1) 替换为运行应用程序服务器的 IP 地址。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T17:35:25.663

你可以，但是如果有很多开发人员在一起，这可能会变得很棘手。

可以运行单个 jboss 实例，但是如果不同的开发人员在相同的代码上工作，或者没有热部署，那么你会遇到热部署、减慢工作和交叉污染的问题，在这种情况下，服务器必须每次都关闭部署/更改应用程序的时间。在测试环境中，这不能很好地工作。

另一种方法是为每个开发人员运行一个单独的实例来运行测试，但这会在金钱和服务器资源方面变得非常昂贵。当您尝试合并来自这些不同环境的更改时，您也会做噩梦。

一些好的组织可能会有所帮助。我们运行三层：开发，登台，生产。开发纯粹是为您的开发人员服务的。错误跟踪和测试在阶段处理，而生产用于用户和客户评估（假设产品尚未推出）。使用良好的存储库将更改从本地机器编码到开发，然后管理员将更改组滚动到登台。它并不能真正解决您在本地机器上的内存问题，但我想我会尝试帮助解决一些企业级的问题。

一个快速的解决方法是在每台机器上放置大量的 RAM，无论如何它都很便宜。然后将您的服务器内存设置设置得更高。这将减少您的 CPU 负载，并减少您看到因过多热部署而导致的可怕 permgen 错误的次数

# language-agnostic - Big-O 符号的替代方案？

> ID：10321079
> 
> 赞同：2
> 
> 时间：2012-04-25T17:54:07.253
> 
> 标签：language-agnostic, data-structures, big-o

大家下午好

我们说[哈希表](http://en.wikipedia.org/wiki/Hash_table)有 O(1) 查找（假设我们有键），而[链表](http://en.wikipedia.org/wiki/Linked_list)有 O(1) 查找下一个节点（假设我们有对当前节点的引用）。

但是，由于[Big-O 表示法的工作原理，它在表示（或区分）算法](http://en.wikipedia.org/wiki/Big_O_notation)*x*的成本与算法*x + m*的成本方面不是很有用。

例如，即使我们将哈希表的查找和链表的查找都标记为 O(1)，这两个 O(1) 归结为确实非常不同的步数，

链表的查找固定在*x*步。但是，哈希表的查找是**可变**的。哈希表查找的成本取决于哈希函数的成本，因此哈希表查找所需的步数为：*x + m*，

1.  其中*x*是一个固定数字

2.  *m*是一个未知的**变量**值

换句话说，即使我们将这两个操作都称为 O(1)，哈希表查找的成本也比链表查找的成本高出一个*数量级。*

Big-O 表示法专门针对输入数据集合的大小。这确实有其优点，但也有其缺点，当我们将所有非*n*变量折叠并归一化为 1 时可以看出。我们再也看不到其中的 m 变量（散列函数）。

除了 Big-O 表示法之外，我们是否可以使用*另一种*（已建立的）表示法来表示固定成本 O(1) 表示*x*操作和可变成本 O(1) 表示*x + m* ( *m*，散列功能）操作次数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T18:54:51.087

"~" 包括常数因子 - 参见[巴赫曼函数族](http://en.wikipedia.org/wiki/Big_Theta_notation#Family_of_Bachmann.E2.80.93Landau_notations)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T18:01:57.377

> 字面量 O(1)，这意味着正好 1 次操作

除非它没有。大 O-Notation 涉及与输入相关的复杂性的相对比较。如果算法确实采用恒定数量的步骤，完全独立于输入的大小，那么确切的步骤数量并不重要。

看一下 O(n) 的（非正式）定义：

![大O的非正式定义](../Images/ab02e29f510654f484efaa2e2dfda23e.png)

意思是：有一定的`k`，所以对于每个`n`函数`f`都小于函数`g`。

在上述情况下，哈希表查找和链表查找将是`f`，并且`g`将是`g(n) = 1`。对于每种情况，您都可以找到一个`k`that `f(n) <= g(n) * k`。

现在，这`k`不需要修复，它可以根据平台、实现、特定硬件而有所不同。唯一有趣的一点是它存在。这就是为什么哈希表查找和链表节点查找都是 O(1) 的原因：无论输入如何，两者都具有恒定的复杂性。在评估算法时，这很有趣，而不是物理步骤。

**特别是关于 Hashtable 查找**

是的，哈希函数确实需要可变数量的操作（取决于实现）。但是，它不会根据输入的大小进行可变数量的操作。Big O-Nation 专门针对**输入数据集合的大小**。散列函数采用**单个元素**。对于算法的评估，某个函数是否需要 10、20、50 或 100 次操作都没有关系，如果操作数不随输入大小而增加，则为 O(1)。在大 O-Notation 中无法区分这一点，因为这不是大 O-Notation 的意义所在。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T18:01:30.177

问题是“操作数量”高度依赖于上下文。事实上，这就是发明大 O 表示法的原因——它似乎在对大量计算机进行建模时效果很好。

此外，程序员的“操作”数量并不意味着它实际花费了多少时间（例如它是否已经在缓存中？）或硬件实际花费了多少步骤（你的处理器究竟做了什么？它有微操作吗？）或者甚至有多少操作被指定给处理器（你的编译器为你做了什么？）。这些都是关注点，即使你试图定义一个足够抽象有用的精确概念。

所以。现在，它是 Big-O 与“操作”——无论“操作”对您和您的同事当时意味着什么。

# c++ - 为什么函数的“地址”的值在 C++ 中是 1？

> ID：10321083
> 
> 赞同：-1
> 
> 时间：2012-04-25T17:54:24.720
> 
> 标签：c++, memory, pointers, reference

我正在学习 C++ 的参考，并尝试了 Thinking in C++ 中的以下代码：

但是，我发现如果我没有将引用转换为 'long' 类型，则**f**和**g**的引用是相同的，我认为这没有意义，并且它们的值都是**1**而不是显示的数字十六进制，谁能解释一下？

谢谢。

```
include <iostream>
using namespace std;
int dog, cat, bird, fish;

void f(int pet) {
    cout << "pet id number:" << pet << endl;
}
void g(int pet) {
    cout << "pet id number:" << pet << endl;
}
int main() {
    int i,j, k;

    cout << "f() normal: " << &f << endl;
    cout << "f() long: " << (long)&f << endl;
    cout << "g() normal: " << &g << endl;
    cout << "g() long: " << (long)&g << endl;  
    cout << "j normal: " << &j << endl;  
    cout << "j long: " << (long)&j << endl;
    cout << "k: " << (long)&k << endl;

    k=2;
    cout << "k: " << (long)&k << endl;  
} // 
```

结果

```
f() normal: 1
f() long: 4375104512
g() normal: 1
g() long: 4375104608
j normal: 0x7fff6486b9c0
j long: 140734879939008
k: 140734879939004
k: 140734879939004 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T18:05:50.827

因为`ostream`有 for 的重载，`operator<<`并且`void*`任何*数据*指针都可以转换为，所以打印s like`void*`的地址。但是，函数指针不能转换为，所以这个特殊的重载是不合适的。`int``j``void*`

那是另一个`operator<<`重载开始发挥作用的时候，在这种情况下，它将是`bool`. 函数指针可以转换为`bool`（true == 指针为非 NULL）。指向的指针`f`非 NULL，因此在此转换中它产生 true，打印为 1。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T18:03:00.917

这与引用无关。该程序不使用任何引用。您正在使用 address-of 运算符`&`。见[https://stackoverflow.com/a/9637342/365496](https://stackoverflow.com/a/9637342/365496)

```
f() normal: 1              the address of f is converted to bool 'true' and printed 
f() long: 4375104512       the address of f is converted to an integer
g() normal: 1              the address of g is converted to bool 'true' and printed
g() long: 4375104608       the address of g is converted to an integer
j normal: 0x7fff6486b9c0   the address of j is printed directly (there's an operator<< for this but not one for printing function pointers like f and g)
j long: 140734879939008    the address of j is converted to an integer
k: 140734879939004         the address of k is converted to an integer
k: 140734879939004         the address of k is converted to an integer 
```

# android - Android：ListView 无法正常工作

> ID：10321084
> 
> 赞同：0
> 
> 时间：2012-04-25T17:54:31.293
> 
> 标签：android, listview

每当单击列表中的任何项目时，我都会尝试更改列表视图中的背景颜色。

```
 listView.setOnItemClickListener(new OnItemClickListener() {

        public void onItemClick(AdapterView<?> parent, View view, int pos,
                long arg3) {

                listView.getChildAt(pos).setBackgroundResource(R.color.GREY);
        }
    }); 
```

但是，这段代码没有按预期工作。它的行为不正常。有时，它会同时更改两个项目的背景，如果我向下拖动列表，则已更改的颜色项目正在重置。

有人能帮我一下吗？

谢谢！拉胡尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T17:59:36.060

在代码中使用它，

将此 xml 文件放在可绘制文件夹中（您将根据需要更改颜色）。

**列表选择器.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android"
          android:constantSize="true">

  <item  android:state_focused="false" android:state_pressed="false">

    <shape android:shape="rectangle">   
    <solid android:color="@android:color/transparent"/>

    <stroke android:width="2dp" android:color="@android:color/transparent" />
    <padding android:left="1dp" android:top="1dp" android:right="1dp"
        android:bottom="1dp" />
    </shape>
  </item>

   <item  android:state_focused="true" android:state_pressed="false">

    <shape android:shape="rectangle">

    <solid android:color="@color/listitemfocus"/>
    <stroke android:width="4dp" android:color="@android:color/transparent" />
    <padding android:left="1dp" android:top="1dp" android:right="1dp"
        android:bottom="1dp" />
    </shape>
  </item>

    <item android:state_pressed="true">

    <shape android:shape="rectangle">

    <solid android:color="@color/listitempress"/>
    <stroke android:width="4dp" android:color="@android:color/transparent" />
    <padding android:left="1dp" android:top="1dp" android:right="1dp"
        android:bottom="1dp" />
    </shape>
  </item>

</selector> 
```

在您的主布局中使用 listview`android:listSelector:`

```
 <ListView
                android:id="@+id/listView1"
                android:layout_width="wrap_content"
                android:layout_height="fill_parent"
                android:layout_below="@+id/parent_image_view"
                android:layout_centerHorizontal="true"
                android:cacheColorHint="@android:color/transparent"
                android:listSelector="@drawable/listselector"
                android:scrollbars="none" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:03:08.787

发生这种情况是因为列表视图（行）的项目将被回收以提高性能...如果视图不在屏幕中..那么而不是为下一个元素创建新视图..以前的视图显示新内容...因此您应该跟踪要更改颜色的项目...[您可以查看此示例...我认为这会有所帮助](http://www.technotalkative.com/android-%E2%80%93-listview-%E2%80%93-5-%E2%80%93-optimized-custom-listview/)...他正在使用查看器类...来管理数据。 . 你也可以为 colcour 设置一个变量.. 并检查一个项目的背景颜色..

# testing - 从哪里获得大量可安全工作的域名？

> ID：10321085
> 
> 赞同：0
> 
> 时间：2012-04-25T17:54:34.893
> 
> 标签：testing, networking, dns

有谁知道我在哪里可以找到一份工作安全（即没有色情、盗版网站等）域名列表，我可以使用这些域名对执行异步 DNS 查找的软件进行压力测试，如果我的网络管理员碰巧是观看？

至少几千是理想的。我发现的大多数列表根本没有被过滤。到目前为止，使用“原始”列表进行 DNS 查询还没有引起任何问题，但我的下一步是创建 TCP 连接。

**编辑：** 我已经与本地网络管理员清除了所有内容，但是，对于该项目的未来开发人员来说，这仍然会很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:33:52.213

我想你可能担心太多了。话虽如此，如何在谷歌搜索“[关于蝴蝶的有趣事实](https://www.google.co.uk/search?rlz=1C1SKPM_enGB442GB442&sourceid=chrome&ie=UTF-8&q=interesting%20facts%20about%20butterflies)”，解析所有结果域并使用它们？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T20:53:19.550

您的网络管理员可能会更关心您在他的网络上对数千个域的网络服务进行压力测试这一事实。如果您有任何一种体面的公司防火墙，它会检查 DNS 查询，并且可能会因高查询率而窒息。如果您的要求是合法的业务要求，最好的选择是让您的老板与网络部门的负责人谈谈 CYA。

# c# - 带有 ASP.NET WebForms 的 Google Charts API - 编写 DataTables

> ID：10321086
> 
> 赞同：0
> 
> 时间：2012-04-25T17:54:45.193
> 
> 标签：c#, javascript, asp.net, webforms, google-visualization

我正在我的 ASP.NET WebForms 应用程序中创建一些图表，并在我的应用程序中创建图表，对于图表的数据，我必须为数据表（在 javascript 中）编写字符串，例如：

```
var data = new google.visualization.DataTable();
data.addColumn('date', 'Date');
data.addColumn('number', 'Sold Pencils');
data.addColumn('string', 'title1');
data.addColumn('string', 'text1');
data.addColumn('number', 'Sold Pens');
data.addColumn('string', 'title2');
data.addColumn('string', 'text2');
data.addRows([
  [new Date(2008, 1 ,1), 30000, null, null, 40645, null, null],
  [new Date(2008, 1 ,2), 14045, null, null, 20374, null, null],
  [new Date(2008, 1 ,3), 55022, null, null, 50766, null, null],
  [new Date(2008, 1 ,4), 75284, null, null, 14334, 'Out of Stock', 'Ran out of stock on pens at 4pm'],
  [new Date(2008, 1 ,5), 41476, 'Bought Pens', 'Bought 200k pens', 66467, null, null],
  [new Date(2008, 1 ,6), 33322, null, null, 39463, null, null]
]); 
```

我正在使用 SqlDataReaders 来执行此操作，创建此脏代码：

```
string jsGraph = "";
jsGraph += "data.addRows([";
            while (dsChartsData.Read())
            {
                var d = (DateTime)dsChartsData["dateColumn"];
                jsGraph += "[new Date(" + d.Year.ToString() + ", " + d.Month.ToString() + ", " + d.Day.ToString() + "), " + dsChartsData["value1"].ToString() + ", null, null, " + dsChartsData["value3"].ToString() + ", null, null],";
            }
jsGraph += "]);" 
```

有没有什么方法可以做到这一点更易于维护，代码简洁且易于调试？（.cs 文件中的 javascript 在我的代码中是一团糟，数以百万计的连接和东西）

*Obs：目前我正在使用 webForms，但是如果你们中的一些人在使用 MVC 时有很大的优势，请告诉我，也许我可以在 MVC 中创建页面来渲染图表（当然，在学习之后）。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:14:37.067

首先，您**缺少**`,`javascript 数组中的分隔逗号...

其次，为什么会有这么多的串联？为什么不是公共变量并从 javascript 调用它？

像：

```
public string graphData = ""; 
```

在你的方法中：

```
StringBuilder jsGraph = new StringBuilder();
jsGraph.AppendLine("[");

while (dsChartsData.Read())
{
    var d = (DateTime)dsChartsData["dateColumn"];
    jsGraph.AppendLine("[new Date(" + d.Year.ToString() + ", " + d.Month.ToString() + ", " + d.Day.ToString() + "), " + dsChartsData["value1"].ToString() + ", null, null, " + dsChartsData["value3"].ToString() + ", null, null],");
}
jsGraph.AppendLine("]");

graphData = jsGraph.ToString(); 
```

并在您的 Javascript 中：

```
var graphData = <%= graphData %>;
...    
data.addRows(graphData); 
```

顺便说一句，你的大串联应该写成：

```
jsGraph.AppendFormat(
            "[new Date({0:yyyy, M, d}), {1}, null, null, {2}, null, null],", 
              (DateTime)dsChartsData["dateColumn"], 
              dsChartsData["value1"],
              dsChartsData["value3"]); 
```

女巫可以更容易阅读。

# java - 斐波那契递归调用的堆栈溢出

> ID：10321088
> 
> 赞同：2
> 
> 时间：2012-04-25T17:54:51.510
> 
> 标签：java, stack, fibonacci

Java 堆栈究竟是如何设置的？

对于大学，我将确定通过递归方法计算并可以由堆栈处理的最大可能的[斐波那契数。](http://en.wikipedia.org/wiki/Fibonacci_number)

有趣的是：测试表明`-Xmx`，[JVM](http://en.wikipedia.org/wiki/Java_virtual_machine)拥有多少并不重要。我能够跑到 Fib(4438)。但结果并不一致。有时它会下降到 4436。`-Xms`

堆栈有公式吗？

堆栈通过的任何增加`-Xss 4096m`都不会产生影响。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T18:00:06.440

-Xmx 和 -Xms 设置 JVM **heap**可访问的内存，您需要增加**堆栈**大小，您可以在 -Xss 选项的帮助下执行此操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T06:47:33.777

你误解了任务。堆栈大小无关紧要。问题是指数级的。而且你不可能用简单的递归程序得到 Fib(4438)。使用下面的代码，如果你能达到 Fib(50)，你会很幸运：

```
public static BigInteger f(int n) {
    if (n == 0) 
        return BigInteger.ZERO; 
    if (n == 1) 
        return BigInteger.ONE; 
    return f(n-1).add(f(n-2));
} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-04-25T18:09:05.960

[*爪哇。如何编程*，第 9 版，Deitel 和 Deitel](https://rads.stackoverflow.com/amzn/click/com/B0057E40I2)，第 771 页：

```
 // Fig. 18.5: FibonacciCalculator.java
 // Recursive Fibonacci method.
 import java.math.BigInteger;
 public class FibonacciCalculator
 {
     private static BigInteger TWO = BigInteger.valueOf( 2 );

     // Recursive declaration of method fibonacci
     public static BigInteger fibonacci( BigInteger number )
     {
         if ( number.equals( BigInteger.ZERO ) ||
              number.equals( BigInteger.ONE ) ) // Base cases
             return number;
         else // Recursion step
             return fibonacci( number.subtract( BigInteger.ONE ) ).add(
         fibonacci( number.subtract( TWO ) ) );
     } // end method fibonacci

     // Displays the Fibonacci values from 0-40
     public static void main( String[] args )
     {
         for ( int counter = 0; counter <= 40; counter++ )
             System.out.printf( "Fibonacci of %d is: %d\n", counter,
         fibonacci( BigInteger.valueOf(counter)));
     } // End main()

 } // end class FibonacciCalculator 
```

我希望这有帮助。

# jquery - 如何使下拉菜单悬停不那么“抽搐”

> ID：10321089
> 
> 赞同：1
> 
> 时间：2012-04-25T17:54:55.940
> 
> 标签：jquery, menu, hover, delay

我在这里有一个相当行人的多级下拉菜单：http: [//suntowersystems.com](http://suntowersystems.com)

如果您将鼠标悬停在“产品”上，您将看到多层次。不幸的是，它太“抽搐”了。IE。如果您将鼠标悬停在第一个子菜单（安全扩展）上以扩展该级别，则几乎不可能向下滑动到下一个菜单（远程办公室）。您必须围绕它滑动才能进入其他选择。

是否有某种方法可以“减慢”或“延迟”响应，以使悬停事件不会“触发”几毫秒？

TIA,

---JC

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T17:58:50.883

是的，它调用悬停意图[http://cherne.net/brian/resources/jquery.hoverIntent.html](http://cherne.net/brian/resources/jquery.hoverIntent.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:00:20.677

是的，它叫做hoverIntent [http://cherne.net/brian/resources/jquery.hoverIntent.html](http://cherne.net/brian/resources/jquery.hoverIntent.html)

# ipad - UIToolbar 的动画调整大小导致在 iOS <5.1 上剪切背景

> ID：10321093
> 
> 赞同：2
> 
> 时间：2012-04-25T17:55:19.877
> 
> 标签：ipad, animation, uitoolbar

我已经实现了一个自定义的拆分视图控制器——原则上——它工作得很好。

然而，有一个方面不起作用**，**那就是在 5.1 版本之前的 iOS 上调整工具栏的大小动画 - 如果存在：

在继承 UIToolbar 以覆盖其`layoutSubviews`方法后，对我的主要内容区域的宽度进行动画更改会导致工具栏项按预期移动。然而，工具栏的背景并**没有**按预期设置动画。

相反，它的宽度会立即更改为新值，从而在增加宽度的同时显示背景。

以下是我认为我使用的代码的相关部分——所有非常标准的东西，尽可能少的魔法/黑客：

```
// From the implementation of my Split Layout View Class:
- (void)setAuxiliaryViewHidden:(BOOL)hide animated:(BOOL)animated completion:(void (^)(BOOL isFinished))completion
{
auxiliaryViewHidden_ = hide;
    if (!animated)
    {
        [self layoutSubviews];
        if (completion)
            completion(YES);

        return;
    }

    // I've tried it with and without UIViewAnimationOptionsLayoutSubviews -- didn't change anything...
    UIViewAnimationOptions easedRelayoutStartingFromCurrentState = UIViewAnimationOptionCurveEaseOut | UIViewAnimationOptionBeginFromCurrentState;
    [UIView animateWithDuration:M_1_PI delay:0.0 options:easedRelayoutStartingFromCurrentState animations:^{
        [self layoutSubviews];
    } completion:completion];
}

- (void)layoutSubviews
{
    [super layoutSubviews];

    // tedious layout work to calculate the frames for the main- and auxiliary-content views

    self.mainContentView.frame = mainContentFrame; // <= This currently has the toolbar, but...
    self.auxiliaryContentView.frame = auxiliaryContentFrame; // ...this one could contain one, as well.
}

// The complete implementation of my UIToolbar class:
@implementation AnimatableToolbar

static CGFloat sThresholdSelectorMargin = 30.;

- (void)layoutSubviews
{
    [super layoutSubviews];

    // walk the subviews looking for the views that represent toolbar items 
    for (UIView *subview in self.subviews)
    {
        NSString *className = NSStringFromClass([subview class]);
        if (![className hasPrefix:@"UIToolbar"]) // not a toolbar item view
            continue;

        if (![subview isKindOfClass:[UIControl class]]) // some other private class we don't want to f**k around with…
            continue;

        CGRect frame = [subview frame];
        BOOL isLeftmostItem = frame.origin.x <= sThresholdSelectorMargin;
        if (isLeftmostItem)
        {
            subview.autoresizingMask = UIViewAutoresizingFlexibleRightMargin;
            continue;
        }

        BOOL isRightmostItem = (CGRectGetMaxX(self.bounds) - CGRectGetMaxX(frame)) <= sThresholdSelectorMargin;
        if (!isRightmostItem)
        {
            subview.autoresizingMask = UIViewAutoresizingFlexibleLeftMargin | UIViewAutoresizingFlexibleRightMargin;

            continue;
        }

        subview.autoresizingMask = UIViewAutoresizingFlexibleLeftMargin;
    }
}

@end 
```

我已经在 InterfaceBuilder 中设置了工具栏的类，我知道一个事实，这个代码被调用了，就像我说的，在 iOS 5.1 上一切正常。

不过，我必须从 4.2 版开始支持 iOS……</p>

非常感谢任何关于我所缺少的帮助/提示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T08:02:00.610

据我所知，您的方法只能在 iOS SDK > 5 上工作。确实，iOS SDK 5 引入了`UIToolbar`以显式方式操作背景的可能性（参见[`setBackgroundImage:forToolbarPosition:barMetrics`](https://developer.apple.com/library/IOs/#documentation/UIKit/Reference/UIToolbar_Class/Reference/Reference.html)和相关的 getter 方法）。

在 iOS SDK 4 中，`UIToolbar`对象没有`_UIToolbarBackground`子视图，因此您无法在`layoutSubviews`实现中移动它。要验证这一点，请添加如下跟踪：

```
for (UIView *subview in self.subviews)
{
    NSLog(@"FOUND SUBVIEW: %@", [subview description]); 
```

在 iOS 4 和 5 上运行代码，你就会明白我的意思了。

总而言之，您的问题的解决方案在于在 iOS 4 和 iOS 5 下以两种不同的方式处理背景。具体来说，在 iOS 4 上，您可以尝试以下方法：

1.  向您的自定义添加一个子视图`UIToolbar`作为背景视图：

    `[toolbar insertSubview:backgroundView atIndex:0];`

2.  放：

    `toolbar.backgroundColor = [UIColor clearColor];`

    这样 UIToolbar 背景颜色就不会干扰；

3.  在您的`layoutSubviews`方法中，与其他子视图一起围绕此背景子视图制作动画，就像您正在做的那样；

当然，没有什么能阻止您在 iOS 5 中使用相同的背景子视图，唯一需要注意的是，在第 1 步中，子视图应插入到索引 1 处（即，在现有背景之上）。

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T15:38:31.083

因为我认为这对其他人有用，所以我将我的解决方案放在这里以供参考：

`UIImageView`根据 sergio 的建议，我在视图层次结构中插入了一个附加项。但由于我希望它与默认的工具栏样式一起使用，我需要跳过几个环节：

1.  `tintColor`每当更改时，都需要动态生成图像。
2.  在 iOS 5.0.x 上，工具栏背景是一个附加视图。

为了解决这个问题，我最终......</p>

1.  实施`+load`以设置我是否需要做任何事情的静态 BOOL。（解析`-[UIDevice systemVersion]`5.1 之前的版本）。
2.  为图像视图添加（延迟加载）属性`stretchableBackground`。如果`nil`我的静态标志是`NO`. 否则，视图将被创建为宽度的两倍`[UIScreen mainScreen]`，向左偏移该宽度的一半，高度和右边距可调整大小，并插入到索引 0 处的工具栏。
3.  压倒一切`setTintColor:`。每当发生这种情况时，我都会打电话给`super`and `__updateBackground`。
4.  实现了一个方法`__updateBackground`：
    *   当工具栏响应`backgroundImageForToolbarPosition:barMetrics:`获取不是我们的第一个子视图时`stretchableBackground`。使用该`contents`视图层的属性来填充`stretchableBackground`的`image`属性并返回。
    *   如果工具栏没有响应该选择器，
        1.  用于`CGBitmapContextCreate()`获得一个 32 位 RGBA `CGContextRef`，其宽度为 1 个像素，高度为工具栏乘以屏幕比例。（使用 kCGImageAlphaPremultipliedLast 来处理设备 RGB 颜色空间……）
        2.  将 CTM 平移该高度并通过 scale/-scale 对其进行缩放以从 UIKit 过渡到 CG 坐标并将视图的图层绘制到该上下文中。（如果你不这样做，你的图像将永远是透明的空白......）
        3.  从该上下文创建一个 UIImage 并将其设置为`stretchableBackground`的图像。

请注意，iOS 5.0.x 的此修复在使用不同的背景图像用于纵向和横向或不缩放的图像时 **将无法按预期工作- 尽管可以通过配置不同的图像视图来调整...</p>**

# silverlight - 在图像 wp7 上实现缩放

> ID：10321094
> 
> 赞同：2
> 
> 时间：2012-04-25T17:55:24.210
> 
> 标签：silverlight, image, windows-phone-7, zooming, deepzoom

我正在尝试使用像其他应用程序功能（即地图）一样的点击或捏合在我的 wp7 应用程序中启用图像的缩放功能。我看到的与此相关的大多数帖子都已经过时了，我想知道是否有更新的方法来实现这一目标？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T18:12:50.343

不知道是否有更好的东西，但这是我正在做的事情：

```
<Image Name="displayImage" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Source="{Binding photo_link}" RenderTransformOrigin="0.5, 0.5" CacheMode="BitmapCache">
      <Image.RenderTransform>
            <CompositeTransform x:Name="transform" />
      </Image.RenderTransform>
      <toolkit:GestureService.GestureListener>
             <toolkit:GestureListener PinchDelta="OnPinchDelta" PinchStarted="OnPinchStarted" />
      </toolkit:GestureService.GestureListener>
 </Image>

    private void OnPinchStarted(object sender, PinchStartedGestureEventArgs e)
    {
        var image = sender as System.Windows.Controls.Image;
        if (image == null) return;
        var transform = image.RenderTransform as CompositeTransform;
        if (transform == null) return;
        initialScale = transform.ScaleX;
    }

    private void OnPinchDelta(object sender, PinchGestureEventArgs e)
    {
        var image = sender as System.Windows.Controls.Image;
        if (image == null) return;
        var transform = image.RenderTransform as CompositeTransform;
        if (transform == null) return;

        transform.ScaleX = initialScale * e.DistanceRatio;
        transform.ScaleY = initialScale * e.DistanceRatio;
    } 
```

如果您想快速双击或重置大小，您还可以跟踪原始比例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T18:12:02.497

您需要使用比例变换。如果您有兴趣，我可以稍后再写一篇博文。对于捏缩放拖动轻弹等，您需要使用工具包中的手势服务

```
private void GestureListener_DragDelta(object sender, DragDeltaGestureEventArgs e)
    {
        scaleTrans.CenterX = (scaleTrans.CenterX - e.HorizontalChange);
        scaleTrans.CenterY = (scaleTrans.CenterY - e.VerticalChange);

        if (scaleTrans.CenterX < 0)
            scaleTrans.CenterX = 0;
        else if (scaleTrans.CenterX > (imgViewer.Height * scaleTrans.ScaleX))
            scaleTrans.CenterX = imgViewer.Height * scaleTrans.ScaleX;

        if(scaleTrans.CenterY < 0)
            scaleTrans.CenterY = 0;
        else if (scaleTrans.CenterY > (imgViewer.Height * scaleTrans.ScaleY))
            scaleTrans.CenterY = imgViewer.Height * scaleTrans.ScaleY;
    } 
```

# php - 主键、唯一 ID 和记录（MySQL、PHP、信息系统）

> ID：10321095
> 
> 赞同：1
> 
> 时间：2012-04-25T17:55:24.643
> 
> 标签：php, mysql, database, primary-key, unique-id

我正在创建一个向公众开放的社交网站，预计将拥有大量用户。每个用户的信息将存储在 MySQL 数据库中，页面将使用 PHP 编写。

我的问题是这样的：Facebook、Yahoo、Stack Overflow 等大型网站使用哪些主键和唯一键来跟踪大量数据？

例如，如下表：

PK、Unique_Id、User_Id、F_Name、L_Name、Date_Created、DEL 等...

我怎样才能给这个表中的每个用户他们自己的 unique_id，他们可以为自己拥有这将是合理的？唯一 ID 应该采用什么格式才能有益？我应该如何管理主键？让pk从1开始，每次递增？

# .net - LinQ ExecuteStoreQuery 调用存储过程返回空值

> ID：10321096
> 
> 赞同：0
> 
> 时间：2012-04-25T17:55:27.127
> 
> 标签：.net, linq, entity-framework, stored-procedures

我正在尝试使用 linq 调用存储过程。这是我的代码：

```
List<AllRowsMyDTO> list = Context.ExecuteStoreQuery<AllRowsMyDTO>("exec GetAllRows {0}", ClassID).AsQueryable().ToList();

public class AllRowsMyDTO
{
    public int StudentId { get; set; }
    public string StudentName { get; set; }
    public string StudentLevel { get; set; }
    public string FilePath { get; set; }
    public string StudentPreRequisites { get; set; }
    public bool IsGraded { get; set; }
} 
```

GetAllRows 存储过程接受一个整数参数并运行一个选择语句来获取与该 ClassID 匹配的所有记录。现在该列表包含的 AllRowsMyDTO 类型的对象与存储过程返回的行数一样多。但是除了布尔属性之外，所有属性都是空的。知道这里发生了什么吗？

另外，这是使用 LinQ 调用存储过程的最佳方式吗？

谢谢你的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T18:27:27.083

问题是您没有在映射中指定键，EF 无法弄清楚它应该是什么。EF 要求结果的某种形式的键（如果需要，可以是复合键）。

# c# - C#：处理返回值中的错误组合

> ID：10321097
> 
> 赞同：0
> 
> 时间：2012-04-25T17:55:28.140
> 
> 标签：c#, error-handling, return-value

我觉得这可能是个愚蠢的问题，但我无法得出我确定存在的简单解决方案。

我有一个 C# 类，可以根据其他文件验证配置文件。

可能有两种错误，它们在枚举中表示：

```
public enum ErrorType
{
    VersionsMismatch,
    UnsupportedCombination
} 
```

有一个表示错误的结构：

```
 public struct ValiditionResult
    {
        public bool Valid { get; set; }
        public string ErrorMessage { get; set; }
        public ErrorType ErrorType { get; set; }
        public List<ConfProperties> InvalidProperties {get;set;}
    } 
```

函数界面如下所示：

```
 public ValiditionResult Validate(string confFile, string progFile) 
```

该结构表示文件中所需的修复。

因此，如果有两种类型的修复，则应指定。

指示发生的所有错误的最佳方法是什么（将来可能有两个以上）？

要返回 ValidationResult 结构的列表？对枚举进行一些异或？还有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T17:58:44.000

您可以使用属性 [Flags] 标记您的枚举

有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/system.flagsattribute.aspx](http://msdn.microsoft.com/en-us/library/system.flagsattribute.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:02:17.273

我认为这对于打包的异常来说是一个不错的选择。您进行验​​证并创建要抛出的异常，然后抛出该聚合异常：

```
public IEnumerable<Exception> Validate(string configFile, string programFile)
{
    if(...)
      yield return new VersionsMismatchException(...);

    if(...)
      yield return new UnsupportedCombinationException(...);
} 
```

然后你有一个方法，它接受所有的异常，然后将它们打包以抛出：

```
public void EnsureConfigurationIsValid(string configFile, string programFile)
{
    var exceptions = Validate(configFile, programFile).ToList();

    if(exceptions.Count > 0)
       throw new ValidationFailedException(exceptions); // creates an internal list
} 
```

然后，无论您从中调用此验证方法的任何方法都只需要一个`try/catch`块来处理聚合异常并循环遍历聚合的每个异常并处理它们。

然后添加新规则就变成了 validate 方法中的另一个条件，其中包含一个新的 yield 语句。

每个单独的异常都可以具有特定于那个人的属性和数据，如果需要，它可以设置自己的消息来显示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T18:23:46.290

如果`ValidationResult`捕获有关单个验证规则结果的信息，则 return 是有意义的`List<ValidationResult>`。

然后，您可以确定验证是否整体失败，例如`results.Any(vr => !vr.Valid)`.

此外，是否在代码中做了一些事情来解决验证失败？枚举是否驱动代码打包和交付结果的方式/位置？我想知道枚举实现了什么。

# r - R 是否有计算每日股息收益率的软件包？

> ID：10321103
> 
> 赞同：1
> 
> 时间：2012-04-25T17:55:55.603
> 
> 标签：r, datetime, date

我正在尝试计算股票的每日股息收益率`(sum of all dividends in the past year / current stock price)`。我有季度股息金额：

```
Date            Dividend Amount($)
1/1/2001             .56
4/2/2001             .56
7/1/2001             .57
10/3/2001            .57
...                  .... 
```

和收盘价：

```
Date              Closing Price($)
    1/1/2001             100.54
    1/2/2001             101.01
    1/3/2001             100.44
    ...                   ... 
```

问题是股息日期是季度，股票日期是工作日。

我想结束这样的事情：

```
Date              Closing Price($)    Dividend Amount($)
    1/1/2001             100.54                2.25
    1/2/2001             101.01                2.25
    1/3/2001             100.44                2.25
    ...                   ...                  ... 
```

有没有可以处理这个问题的包，或者我最好使用 ifelse / loop 结构？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T00:23:28.227

这是@JoshuaUlrich 建议的解决方案示例。

```
require("quantmod") 
s <- "SPY"
# get Closing prices
p <- Cl(getSymbols(s, src='yahoo', auto.assign=FALSE, from='2010-01-01', 
                   to='2012-06-20'))
# get dividends
div <- getDividends(s, from=start(p), to=end(p))
ydiv <- runSum(div, n=4) # rolling sum of last 4 quarters
out <- na.locf(merge(p, ydiv, all=TRUE)) # merge and fill in NAs with previous values
out$yld <- out[, 2] / out[, 1] # "current yield"
tail(out)
#           SPY.Close  ydiv        yld
#2012-06-13    132.07 2.637 0.01996668
#2012-06-14    133.47 2.637 0.01975725
#2012-06-15    134.14 2.697 0.02010586
#2012-06-18    134.40 2.697 0.02006696
#2012-06-19    135.70 2.697 0.01987472
#2012-06-20    135.48 2.697 0.01990700 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-17T22:02:33.323

如果股息支付不是严格按季度支付，则以下脚本可以计算股息收益率的大致历史记录。该脚本假设在一个季度内，每日股息支付是恒定的。由于一个季度内的股息支付日期可能会有所不同，因此开始日期和截止日期需要是季度的开始/结束。

EGAS 过去按季度支付股息，后来改为按月分配。

```
# script calculates and plots history of the 
# dividend yield of a given stock symbol

require(zoo)
require(quantmod)

sym <- "EGAS"
from <- "1999-01-01"
to <- "2013-06-30"

# get price, dividends and splits from finance.yahoo.com
TS <- getSymbols(sym, from=from, to=to, auto.assign=FALSE)
div <- getDividends(sym, from=from, to=to)
splits <- getSplits(sym, from=from, to=to)

# adjust for splits: code copied and adapted from quantmod::adjustOHLC
if (is.xts(splits) && is.xts(div) && nrow(splits) > 0 && nrow(div) > 0) {
  div <- div * 1/adjRatios(splits = merge(splits, index(div)))[, 1]
  colnames(div) <- "Dividend"
}
ratios <- adjRatios(splits, div, Cl(TS))
Adjusted <- Cl(TS) * ratios[,1]
TS <- structure(cbind((ratios[,1] * (Op(TS) - Cl(TS)) + Adjusted), 
                      (ratios[,1] * (Hi(TS) - Cl(TS)) + Adjusted), 
                      (ratios[,1] * (Lo(TS) - Cl(TS)) + Adjusted), 
                      Adjusted, 
                      if (has.Vo(TS)) Vo(TS)
                        else NULL, 
                      if (has.Ad(TS)) Ad(TS)
                        else NULL), 
                .Dimnames = list(NULL, colnames(TS)))

# assume the daily dividend "payment" to be constant within a quarter
TSComb <- merge(Cl(TS), div, fill=0)
DailyDiv <- structure(apply.quarterly(TSComb[,2], mean), 
                      .Dimnames = list(NULL, "DailyDividend"))
TSComb <- na.locf(merge(TSComb, DailyDiv), fromLast=TRUE)
TSComb <- merge(TSComb, structure(runSum(TSComb[,"DailyDividend"], n=250), 
                      .Dimnames = list(NULL, "YearlyDividend")))
TSComb <- merge(TSComb, structure(TSComb[,"YearlyDividend"]/TSComb[,1]*100, 
                      .Dimnames = list(NULL, "Yield")))

plot(as.zoo(cbind(TSComb[,"Yield"], div)),
       main=paste(sym, "Dividend Yield"),
       heights=c(2,1),
       ylim=list(c(0,max(TSComb[,"Yield"], na.rm=TRUE)), 
                 c(0,max(div))),
       xlab=NULL, ylab=c("Yield", "Dividend"),
       col="blue",
       las=1, type=c("l", "p"), yax.flip=1)
# end of script 
```

该股票一直在分配大量股息： ![股息收益率和支付随时间变化的图](../Images/62755bbebc44745d3111bc656cd2d3b0.png)

# java - Android：如何迭代 ArrayList 在不同的线程

> ID：10321104
> 
> 赞同：0
> 
> 时间：2012-04-25T17:55:56.320
> 
> 标签：java, android

我需要在不同的线程中迭代 String 的 ArrayList，我不需要添加或删除项目，只需进行迭代。

我该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T17:59:25.990

Weill 在其最基本的形式中，你会做这样的事情。但是您的问题似乎比您问我们的要多得多？

```
final List<Item> items = new ArrayList<Item>();
items.addAll(stuff);
new Thread(new Runnable() {
  public void run() {
    for (Item item: items) {
      System.out.println(item);
    }
  }
}).start(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T18:07:15.033

您可能会遇到的唯一问题是，读取线程访问与发布线程相同的数据。为此，您需要以线程安全的方式传递对另一个线程的引用（即通过使用`volatile`修饰符声明的字段，`AtomicReference`以任何其他方式使用或传递读写器线程中的内存屏障，例如传递 a`ReentrantLock`或`synchronize`块）。注意 - 您不需要*在*同步中对其进行迭代。在阅读列表之前通过内存屏障。

例如（可重入锁）：

```
private final ReadWriteLock lock = new ReentrantReadWriteLock();

final Lock w = lock.writeLock();
w.lock();
try {
    // modifications of the list
} finally {
    w.unlock();
}

  .................................

final Lock r = lock.readLock();
r.lock();
try {
    // read-only operations on the list
    // e.g. copy it to an array
} finally {
    r.unlock();
}
// and iterate outside the lock 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T18:05:07.443

```
 Thread splashThread = new Thread() {
        @Override
        public void run() {
            List<String> mylist = new ArrayList<String>();
            mylist.add("I");
            mylist.add("Am");
            mylist.add("definitely");
            mylist.add("becoming");
            mylist.add("a");
            mylist.add("better");
            mylist.add("programmer");
            Iterator<?> i1 = mylist.iterator();
            while (i1.hasNext()) {
                System.out.println(i1.next());
            }
        }

    };
    splashThread.start();
} 
```

# c# - 如何在 WPF 中查找 UserControl 宽度？

> ID：10321112
> 
> 赞同：5
> 
> 时间：2012-04-25T17:56:24.770
> 
> 标签：c#, wpf, user-controls

```
<UserControl x:Class="JIMS.View.Settings.Settings"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"  
    Name="SettingsWindow">       
    <Border Style="{StaticResource WindowBorderStyle}" Height="100">    
    <StackPanel Orientation="Vertical">
        <my:TitleBar Title="settings"/>
        <StackPanel Orientation="Horizontal">
            <StackPanel Orientation="Horizontal">
                <StackPanel Orientation="Vertical" Margin="10,0,0,0">
                    <Label>Theme :</Label>                        
                </StackPanel>
                <StackPanel Orientation="Vertical" Width="200" Margin="0,0,10,0">                        
                    <ComboBox Name="cmbTheme" ItemsSource="{Binding Path=Themes}" ></ComboBox>                        
                </StackPanel>
            </StackPanel>
        </StackPanel>
    </StackPanel>        
</Border>
</UserControl> 
```

这是我的 UserControl，我还没有设置它的 Width 和 Height 属性。但是在某些代码隐藏中，我想获取此 UserControl 的高度和宽度，但我无法获取它们。

```
double width=uctrl.Width; 
```

它给了我`NaN`一段时间

```
double width=ctrl.ActualWidth; 
```

给我`0`

我需要宽度和高度的代码

```
private void OpenChild(UserControl ctrl)
{
    bool alreadyExist = false;
    ctrl.Uid = ctrl.Name;
    foreach (UIElement child in JIMSCanvas.Children)
    {
        if (child.Uid == ctrl.Uid)
        {
            alreadyExist = true;
            Canvas.SetZIndex(child, GetMaxZIndex);
        }
    }
    if (!alreadyExist)
    {
        JIMSCanvas.Children.Add(ctrl);
            JIMSCanvas.InvalidateMeasure();
        double top = (JIMSCanvas.ActualHeight - ctrl.Height) / 2;
        double left = (JIMSCanvas.ActualWidth - ctrl.Width) / 2;
        Canvas.SetLeft(ctrl, left);
        Canvas.SetTop(ctrl, top);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T18:17:08.007

在一个全新的项目中，我写了这个（它在更改窗口时给了我更新的宽度）：

```
<Window xmlns:my="clr-namespace:WpfApplication2"
        x:Class="WpfApplication2.Window32"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Window32"
        Height="300"
        Width="300">
  <Grid>
    <my:UserControl3 x:Name="uc3" />
    <TextBlock Height="23"
               HorizontalAlignment="Left"
               Margin="126,121,0,0"
               Name="textBlock1"
               Text="{Binding ElementName=uc3, Path=ActualWidth}"
               VerticalAlignment="Top" />
  </Grid>
</Window> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:50:55.183

我用这段代码解决了这个问题......

```
private void OpenChild(UserControl ctrl)
{
    bool alreadyExist = false;
    ctrl.Uid = ctrl.Name;
    foreach (UIElement child in JIMSCanvas.Children)
    {
        if (child.Uid == ctrl.Uid)
        {
            alreadyExist = true;
            Canvas.SetZIndex(child, GetMaxZIndex);
        }
    }
    if (!alreadyExist)
    {
        JIMSCanvas.Children.Add(ctrl);
        JIMSCanvas.UpdateLayout();
        double top = (JIMSCanvas.ActualHeight - ctrl.ActualHeight) / 2;
        double left = (JIMSCanvas.ActualWidth - ctrl.ActualWidth) / 2;
        Canvas.SetLeft(ctrl, left);
        Canvas.SetTop(ctrl, top);                               
    }
} 
```

我用过`JIMSCanvas.UpdateLayout();`

感谢大家的帮助，尤其是`@NestorArturo`

# c++ - C++：不受 Void 函数影响的变量

> ID：10321117
> 
> 赞同：2
> 
> 时间：2012-04-25T17:56:39.913
> 
> 标签：c++, performance, algorithm, sorting

我试图实现一个基本的快速排序算法，我认为我已经正确地实现了它。但是，这些函数根本不影响数组。可能是什么原因？我不知道出了什么问题，所以我决定在这里咨询我的程序员同事：

```
#include <iostream>
#include <vector>

using namespace std;

int partition(vector<int> A,int low,int high)
{
    int pivot=A[high-1];
    int boundryForLowerArray=low-1;
    for(int i=low;i<high-2;i++)
    {
        if(A[i]<=pivot)
        {
            boundryForLowerArray++;
            swap(A[i],A[boundryForLowerArray]);
        }
    }
    swap(pivot,A[boundryForLowerArray+1]);
    return boundryForLowerArray+1;
}
void quickSort(vector<int>A,int low,int high)
{
    if(low<high)
    {
        int q=partition(A,low,high);
        quickSort(A, low, q-1);
        quickSort(A, q+1, high);
    }
}

int main(int argc, const char * argv[])
{

    vector<int>A,sorted;
    A.push_back(2);
    A.push_back(8);
    A.push_back(7);
    A.push_back(1);
    A.push_back(3);
    A.push_back(5);
    A.push_back(6);
    A.push_back(4);
    quickSort(A, 0, A.size());
    for(int i=0;i<A.size();i++)
        cout<<A[i]<<" ";
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T17:58:14.083

您通过值而不是通过引用传递 A，因此`quickSort`制作 A 的副本并对其进行排序。而是尝试通过引用传递向量：

```
int partition(vector<int>& A,int low,int high) 
```

... 和

```
void quickSort(vector<int>& A,int low,int high) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:04:27.783

因为您通过值而不是通过引用传递参数。实际上，您应该有一个带有迭代器的函数，用于数组的开始和结束（vec.begin（），vec.end（））作为参数。此外，您的算法应该接受任何类型的迭代器。所以你应该使用模板！

```
template<class Iterator>
void quick_sort(Iterator begin, Iterator end) { 
   for(auto iter = begin;iter != end;iter++) 
      *iter; // access to the value of the iterator 
```

# java - 需要帮助按第二个元素然后按第一个元素（Java）对二维数组进行排序

> ID：10321123
> 
> 赞同：1
> 
> 时间：2012-04-25T17:57:20.790
> 
> 标签：java, arrays, sorting, multidimensional-array

我有一个二维数组，其中包含 5 张卡片的值。5 个数组的第一个元素代表卡片的花色，第二个元素代表卡片的价值。

我想按第二个元素对二维数组进行排序，然后按第一个元素排序，同时保持第二个元素的排序顺序（如果有意义的话）。例如，在排序列表中，所有一套花色都将低于所有两套花色。例如，{{0,1},{2,1},{0,2}} 应变为 {{0,1},{2,1},{0,2}}。

这是我所拥有的：

```
 // {{3,2}, {2,2}, {0,1}, {1,0}, {2,3}} should become 
 // {{1,0}, {0,1}, {2,2}, {3,2}, {2,3}}

 int[][] hand = {{3,2},{2,2},{0,1},{1,0},{2,3}};
 sort(hand);

 public static void sort(int[][] hand){
    Arrays.sort(hand, new Comparator<int[]>(){
        public int compare(int[] o1, int[] o2){
            return Integer.valueOf(o1[1]).compareTo(Integer.valueOf(o2[1]));
        }
    });
 } 
```

这是输出 {{1,0},{0,1},{3,2},{2,2},{2,3}}。有没有人有什么建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T17:59:41.480

解决方案1：按第二个元素对数组进行排序，然后按第一个元素对数组进行排序。由于`Arrays.sort`是稳定的，这相当于首先比较第一个元素，然后是第二个元素。

解决方案2：修改你的比较器如下：

```
Arrays.sort(hand, new Comparator<int[]>() {
  public int compare(int[] o1, int[] o2) {
    if (o1[0] == o2[0]) {
      return Integer.compare(o1[1], o2[1]);
    } else {
      return Integer.compare(o1[0], o2[0]);
    }
  }
}); 
```

或者，使用 Guava（披露：我为 Guava 做出贡献），您可以将比较器写为

```
 public int compare(int[] o1, int[] o2) {
    return ComparisonChain.start()
      .compare(o1[0], o2[0])
      .compare(o1[1], o2[1])
      .result();
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T17:59:35.287

这对你有用吗：

```
int compare1 = Integer.valueOf(o1[1]).compareTo(Integer.valueOf(o2[1]);
if(compare1 != 0)
    return compare1;
else
    return Integer.valueOf(o1[0]).compareTo(Integer.valueOf(o2[0])); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-27T01:47:24.953

我将添加一个 Java 8 解决方案，以防万一有人想知道。

```
Arrays.sort(hand, (o1, o2) -> o1[1] == o2[1] ? Integer.compare(o1[0], o2[0]) 
                                             : Integer.compare(o1[1], o2[1])); 
```

基本上，它在第二个元素相等时比较每个数组的第一个元素，否则直接比较第二个元素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-10-09T03:41:04.387

您可以像这样以更紧凑的方式使用 Java 8 Comparator

```
Arrays.sort(hand, Comparator.comparing(x -> ((int[])x)[1]).thenComparing(x -> ((int[])x)[0])); 
```

# .net - 使用索引像素格式将文本写入图像

> ID：10321128
> 
> 赞同：2
> 
> 时间：2012-04-25T17:57:40.167
> 
> 标签：.net, image-processing, system.drawing, imaging

我有想要写入文本的单色 TIFF 文件 (1 bpp)。当我将它们加载到 System.Drawing.Image 并尝试从该图像实例化图形对象时，我收到错误消息“无法从具有索引像素格式的图像创建图形对象”。

我可以将图像转换为非索引格式，例如 JPEG，但生成的图像尺寸非常大。

我想在保持图像尺寸减小的同时做到这一点。如何在不将它们转换为另一种格式的情况下将文本写入这些图像？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T12:59:44.513

使用 Hans Passant 留下的评论中的想法，我在代码项目上找到了这篇文章：http: [//www.codeproject.com/Articles/15186/Bitonal-TIFF-Image-Converter-for-NET](http://www.codeproject.com/Articles/15186/Bitonal-TIFF-Image-Converter-for-NET)

修改此代码后，我将图像转换为 32bpp，在该图像上写入文本，然后将其转换为 1bpp。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-21T17:50:43.303

您可以使用 System.Drawing.Bitmap.Clone 转换内存中的图像。这满足了小文件大小的要求。如果您需要在 winforms 上使用 TIF，请使用 TiffBitmapEncoder。

```
Bitmap bmpTif = new Bitmap(imagePath);

Bitmap bmp = bmpTif.Clone(new Rectangle(0, 0, pageWidth, pageHeight),
    PixelFormat.Format32bppRgb);

Graphics g = Graphics.FromImage(bmp);

// Do your g.DrawString's

Bitmap bmpNew = bmp.Clone(new Rectangle(0, 0, pageWidth, pageHeight),
    PixelFormat.Format1bppIndexed);
bmpNew.Save(imagePath2); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T21:45:18.283

您可以使用支持 TIFF 图像的[ImageMagick.NET 之类的图像处理 API。](http://imagemagick.codeplex.com/)我相信您可以使用 Annotate 方法将文本呈现到其中。

希望这可以帮助。

# mysql - MySQL date diff 迭代查询——精简查询或优化数据结构

> ID：10321131
> 
> 赞同：5
> 
> 时间：2012-04-25T17:57:57.517
> 
> 标签：mysql, optimization, query-optimization, iteration, datediff

作为介绍...
我遇到了这个问题：[2 个相邻字段之间的差异 - 日期 - PHP MYSQL](https://stackoverflow.com/questions/10215627/difference-between-2-adjacent-fields-date-php-mysql)并试图实现目标，即使用纯 MySQL 遍历日期并获得差异。
那里的另一个问题（[在 SQL 中从另一行中减去一行数据](https://stackoverflow.com/questions/919136/subtracting-one-row-of-data-from-another-in-sql)）帮助我了解如何使用 MySQL 制作类似的东西。它没有解决问题，因为解决方案仍然依赖于固定值或假定的数据顺序，但它确实帮助我理解了该方法。
还有另一个问题（[如何在 MySQL 中获取下一条/上一条记录？](https://stackoverflow.com/questions/1446821/how-to-get-next-previous-record-in-mysql)) 以及描述如何从下一行/上一行获取值的答案。它仍然依赖于一些固定值，但我学会了如何使用该技术。

假设我有这张桌子`foo`：

```
CREATE TABLE `foo` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `dateof` date NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8; 
```

```
 id | dateof
-----+------------
   1 | 2012-01-01
   2 | 2012-01-02
  11 | 2012-01-04
  12 | 2012-01-01
  13 | 2012-01-02
  14 | 2012-01-09
 111 | 2012-01-01
 112 | 2012-01-01
 113 | 2012-01-01 
```

有两个假设：

1.  主键 ( `id`) 按升序排列，允许“空洞”。
2.  列中的每个日期`dateof`都是有效的，意思是：没有`NULL`s 和没有默认值 ( `0000-00-00`)。我想遍历每一行并计算前一个条目经过的天数，以接收以下信息：

```
 id | date       | days_diff
-----+------------+-----------
   1 | 2012-01-01 |     0
   2 | 2012-01-02 |     1
  11 | 2012-01-04 |     2
  12 | 2012-01-01 |    -3
  13 | 2012-01-02 |     1
  14 | 2012-01-09 |     7
 111 | 2012-01-01 |    -8
 112 | 2012-01-01 |     0
 113 | 2012-01-01 |    30 
```

* * *

据我所知，我来到了这个解决方案（比如**解决方案 1**，因为还有另一个）：

```
SELECT
    f.id,
    DATE_FORMAT(f.dateof, '%b %e, %Y') AS date,
    (SELECT DATEDIFF(f.dateof, f2.dateof)
        FROM foo f2
        WHERE f2.id = (
            SELECT MAX(f3.id) FROM foo f3 WHERE f3.id < f.id
        )
    ) AS days_diff
FROM foo f; 
```

（这里的小提琴示例：[http](http://sqlfiddle.com/#!2/099fc/3) ://sqlfiddle.com/#!2/099fc/3 ）。

这就像一个魅力......直到数据库中只有几个条目。当更多时它变得更糟：

```
EXPLAIN:
id select_type        table type   possible_keys key     key_len ref    rows  Extra
1  PRIMARY            f     ALL    NULL          NULL    NULL    NULL   17221   
2  DEPENDENT SUBQUERY f2    eq_ref PRIMARY       PRIMARY 4       func   1     Using where
3  DEPENDENT SUBQUERY f3    index  PRIMARY       PRIMARY 4       NULL   17221 Using where; Using index 
```

> 18031行：持续时间：**8.672**秒。获取：**228.515**秒。

我想在`dateof`列上添加索引：

```
CREATE TABLE `foo` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `dateof` date DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `dateof` (`dateof`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8; 
```

...并获得了*微小的*改进：

```
EXPLAIN:
id select_type        table type   possible_keys key     key_len ref  rows  Extra
1  PRIMARY            f     index  NULL          dateof  4       NULL 18369 Using index
2  DEPENDENT SUBQUERY f2    eq_ref PRIMARY       PRIMARY 4       func 1     Using where
3  DEPENDENT SUBQUERY f3    index  PRIMARY       dateof  4       NULL 18369 Using where; Using index 
```

> 18031行：持续时间：**8.406**秒。获取：**219.281**秒。

我记得在某处读过有关 MyISAM 在某些情况下优于 InnoDB 的优势。所以我将其更改为 MyISAM：

```
ALTER TABLE `foo` ENGINE = MyISAM; 
```

> 18031行：持续时间：**5.671**秒。获取：**151.610**秒。

当然它更好，但仍然很慢。

我尝试了另一种算法（**解决方案 2**）：

```
SELECT
  f.id,
  DATE_FORMAT(f.dateof, '%b %e, %Y') AS date,
  (SELECT DATEDIFF(f.dateof, f2.dateof)
    FROM foo f2
    WHERE f2.id < f.id
    ORDER BY f2.id DESC
    LIMIT 1
  ) AS days_diff
FROM foo f; 
```

...但它甚至更慢：

> 18031行：持续时间：**15.609**秒。获取：**184.656**秒。

* * *

是否有任何其他方法可以优化此查询或数据结构以便更快地执行此任务？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T18:05:10.857

即使对于中等大小的桌子，您的方法也很慢也就不足为奇了。

理论上应该可以使用`LAG`分析函数在 O(n) 时间内计算结果，遗憾的是 MySQL 不支持该函数。`LAG`但是，您可以使用变量在 MySQL 中进行模拟：

```
SELECT
    id,
    DATE_FORMAT(f.dateof, '%b %e, %Y') AS date,
    DATEDIFF(dateof, @prev) AS days_diff,
    @prev := dateof
FROM FOO, (SELECT @prev := NULL) AS vars
ORDER BY id 
```

这应该比您尝试做的快几个数量级。

# php - 本地文件上的PHP？

> ID：10321132
> 
> 赞同：-3
> 
> 时间：2012-04-25T17:58:00.140
> 
> 标签：php

我的电脑上没有安装任何额外的东西。每当我尝试在另一个上包含一个本地 PHP 文件时，什么都没有发生。我的问题是它是否应该工作，或者我是否必须有某种服务器才能工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T18:00:02.993

好吧，你显然需要一个服务器**端语言的****服务器**......你不觉得吗？

查看诸如**[Apache之类的 PHP 服务器，或安装诸如](http://www.apache.org/)****[XAMPP](http://www.apachefriends.org/en/xampp.html)**或**[WAMP](http://www.wampserver.com/en/)**之类的一体机。

至少，您需要安装**[PHP](http://php.net/manual/en/install.php)**并从命令行运行它。

# ios - 创建 XML 文件以保存应用数据

> ID：10321136
> 
> 赞同：1
> 
> 时间：2012-04-25T17:58:12.020
> 
> 标签：ios, xcode

我正在创建一个应用程序，其中有一个页面使用户能够创建一个小项目，我的意思是使用画笔绘画、添加标签、文本字段以及添加 UIImageViews 并使用 iOS 库在其中放置图像。然后（暂时）截取屏幕截图并将其上传到保管箱。从表格视图中，用户将能够看到所有上传的文档。但关键是它只是一个截图。我想以可以滚动文本字段的方式上传内容，当我添加视频功能时，请查看视频。然后添加评论。我想到了单独上传所有图像，照片，TextViews，然后在XML中保存各块的所有位置，以便可以从表视图查看项目：选择一行时，应用程序将打开XML和XML它的基础就像拼图一样组成了所有的部分。我决定使用谷歌库，（数据），但我似乎无法找到在哪里下载该库的示例项目。所以我把它放在一边。然后我尝试使用 NSXML 解析器，但我只看到启用访问 xml 文件的教程，而不是根据每个项目实际创建一个！帮助！！我该如何进行？有什么建议或教程吗？可能是给我数据项目的链接，请不要到谷歌开发者页面或主干，因为它是一团糟！

我在这里先向您的帮助表示感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T18:10:51.840

Ray Wenderlich 的网站（一个很棒的 iOS 开发和教程资源）有一个非常好的教程，关于如何在这里使用 GDataXML 创建 XML：

[http://www.raywenderlich.com/725/how-to-read-and-write-xml-documents-with-gdataxml](http://www.raywenderlich.com/725/how-to-read-and-write-xml-documents-with-gdataxml)

这是 GitHub 存储库：[https ://github.com/neonichu/GDataXML](https://github.com/neonichu/GDataXML)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-04T17:31:25.773

或者，您可以使用非常简单、非常易于使用的**标准**NSPropertyListSerialization:dataWithPropertyList:format:options:error，这就是您的做法：

用 NSArray 和 NSDictionary 填充它（这是需要最多代码的部分 - 但并不难做到）。字典中的对象是孩子和子孩子（可能是 NSDictionaries 的 NSArray）。然后使用以下内容将其写出来：

```
NSData *xmlData = [NSPropertyListSerialization dataWithPropertyList: resultLists
                                                             format: NSPropertyListXMLFormat_v1_0
                                                            options: 0
                                                              error: &error];

//----- DO ERROR CHECKING (left out to simplify)

BOOL result = [xmlData writeToFile:arrayFileName atomically:YES]; 
```

繁荣。一个 XML 文件。

我正在备份一个核心数据文件，这相对来说是微不足道的。

我通常喜欢 Ray Wenderlich 的网站，但在这种情况下，他使一些很容易做的事情变得*非常复杂*。我就是这样做的，老实说，Apple 的方式要容易得多。

# python - 使用 pymongo tailable 游标在空集合上死机

> ID：10321140
> 
> 赞同：3
> 
> 时间：2012-04-25T17:58:23.210
> 
> 标签：python, mongodb, pymongo

希望有人可以帮助我了解我是否遇到问题或者我只是不了解 mongodb 可尾游标行为。我正在运行 mongodb 2.0.4 和 pymongo 2.1.1。

这是一个演示该问题的脚本。

```
#!/usr/bin/python

import sys
import time
import pymongo

MONGO_SERVER = "127.0.0.1"
MONGO_DATABASE = "mdatabase"
MONGO_COLLECTION = "mcollection"

mongodb    = pymongo.Connection(MONGO_SERVER, 27017)
database   = mongodb[MONGO_DATABASE]

if MONGO_COLLECTION in database.collection_names():
  database[MONGO_COLLECTION].drop()

print "creating capped collection"
database.create_collection(
  MONGO_COLLECTION,
  size=100000,
  max=100,
  capped=True
)
collection = database[MONGO_COLLECTION]

# Run this script with any parameter to add one record
# to the empty collection and see the code below
# loop correctly
#
if len(sys.argv[1:]):
  collection.insert(
    {
      "key" : "value",
    }
  )

# Get a tailable cursor for our looping fun
cursor = collection.find( {},
                          await_data=True,
                          tailable=True )

# This will catch ctrl-c and the error thrown if
# the collection is deleted while this script is
# running.
try:

  # The cursor should remain alive, but if there
  # is nothing in the collection, it dies after the
  # first loop. Adding a single record will
  # keep the cursor alive forever as I expected.
  while cursor.alive:
    print "Top of the loop"
    try:
      message = cursor.next()
      print message
    except StopIteration:
      print "MongoDB, why you no block on read?!"
      time.sleep(1)

except pymongo.errors.OperationFailure:
  print "Delete the collection while running to see this."

except KeyboardInterrupt:
  print "trl-C Ya!"
  sys.exit(0)

print "and we're out"

# End 
```

因此，如果您查看代码，就很容易证明我遇到的问题。当我针对一个空集合运行代码时（适当地加盖并准备好拖尾），光标消失并且我的代码在一个循环后退出。在集合中添加第一条记录使其行为方式与我期望尾随光标的行为方式相同。

另外，StopIteration 异常杀死 cursor.next() 等待数据的处理是什么？为什么后端不能阻塞直到数据可用？我假设 await_data 实际上会做一些事情，但它似乎只会让连接等待一两秒钟，而不是没有它。

网络上的大多数示例都显示在 cursor.alive 循环周围放置第二个 While True 循环，但是当脚本尾随一个空集合时，循环只是旋转并旋转浪费 CPU 时间。我真的不想为了避免在应用程序启动时出现这个问题而放入一条虚假记录。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T19:54:11.520

这是已知的行为，2 循环“解决方案”是解决这种情况的公认做法。在集合为空的情况下，与其按照您的建议立即重试并进入紧密循环，您可以短时间休眠（特别是如果您预计很快会有数据尾随）。

# php - 无法从数组中获取值

> ID：10321141
> 
> 赞同：0
> 
> 时间：2012-04-25T17:58:24.830
> 
> 标签：php, json

我正在尝试输出数组的电子邮件值的值，但这样做有问题。该数组基于 json_decode()

这是我收到的错误

```
Fatal error: Cannot use object of type stdClass as array in /home/.... line 57 
```

JSON（值：$this->bck_content）

```
{"email":"test@email.com","membership_id":"0","fname":"Kenneth","lname":"Poulsen","userlevel":"1","created":"2012-04-23 10:57:45","lastlogin":"2012-04-23 10:58:52","active":"y"} 
```

我的代码

```
 # Display requested user details
    $details_array = json_decode($this->bck_content);

    $value = $details_array['email'];
    print $value; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T18:00:26.520

您需要使用第二个参数来`json_decode`强制 JS 对象上的数组结构。

```
json_decode($this->bck_content, true); 
```

这将确保 json 中的所有 JS 对象都被解码为关联数组而不是 PHP StdObjects。

当然，这是假设您想使用数组表示法来访问它们。如果您可以使用对象表示法，那么您可以使用：

```
$value = $details_array->email; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T18:00:53.210

试试这个

```
$value = $details_array->email; 
```

或者

```
json_decode($json, true); 
```

或者

```
$details_array = (array)json_decode($json); 
```

你做错了什么写在错误描述中

# jmeter - Jmeter 服务器和 Jmeter GUI 客户端远程设置问题

> ID：10321142
> 
> 赞同：2
> 
> 时间：2012-04-25T17:58:26.643
> 
> 标签：jmeter, nat

我试图设置远程 jmeter 服务器和 jmeter 客户端。

```
Server public IP : 111.111.111.111
Client public IP : 222.222.222.222 
```

我能够启动机架空间云上的 jmeter 服务器。

我的桌面位于具有 NAT 公共 IP 地址的防火墙后面。我在防火墙上打开了 1099 端口，并为桌面添加了一个公共 IP。还在桌面上的 jmeter.properties 上添加了远程地址并启动了 jmeter GUI 客户端。

当我从客户端点击远程启动时，我可以看到此控制台日志到达 jmeter 服务器的请求

> 在主机 111.111.111.111:1099 @ Wed Apr 25 17:40:09 UTC 2012 (1335375609190) 上开始测试"

但是在客户端我得到了任何东西，当我检查 jmeter-server.log 时出现了一些错误：

```
2012/04/25 17:42:36 ERROR - jmeter.samplers.RemoteListenerWrapper: testStarted(host) java.rmi.ConnectException: Connection refused to host: 222.222.222.222; nested exception is: 
    java.net.ConnectException: Connection timed out
    at sun.rmi.transport.tcp.TCPEndpoint.newSocket(TCPEndpoint.java:601)
    at sun.rmi.transport.tcp.TCPChannel.createConnection(TCPChannel.java:198)
    at sun.rmi.transport.tcp.TCPChannel.newConnection(TCPChannel.java:184)
    at sun.rmi.server.UnicastRef.invoke(UnicastRef.java:110)
    at org.apache.jmeter.samplers.RemoteSampleListenerImpl_Stub.testStarted(Unknown Source)
    at org.apache.jmeter.samplers.RemoteListenerWrapper.testStarted(RemoteListenerWrapper.java:83)
    at org.apache.jmeter.engine.StandardJMeterEngine.notifyTestListenersOfStart(StandardJMeterEngine.java:226)
    at org.apache.jmeter.engine.StandardJMeterEngine.run(StandardJMeterEngine.java:349)
    at java.lang.Thread.run(Thread.java:662)
Caused by: java.net.ConnectException: Connection timed out
    at java.net.PlainSocketImpl.socketConnect(Native Method)
    at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:333)
    at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:195)
    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:182)
    at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:366)
    at java.net.Socket.connect(Socket.java:529)
    at java.net.Socket.connect(Socket.java:478)
    at java.net.Socket.<init>(Socket.java:375)
    at java.net.Socket.<init>(Socket.java:189)
    at sun.rmi.transport.proxy.RMIDirectSocketFactory.createSocket(RMIDirectSocketFactory.java:22)
    at sun.rmi.transport.proxy.RMIMasterSocketFactory.createSocket(RMIMasterSocketFactory.java:128)
    at sun.rmi.transport.tcp.TCPEndpoint.newSocket(TCPEndpoint.java:595)
    ... 8 more 
```

请建议我在这里做错了什么，我可以从客户端在端口 1099 上远程登录服务器，反之亦然。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T07:00:57.003

您是否也禁用了远程计算机上的任何防火墙/防病毒软件？

此外，除了打开的端口外，您的本地防病毒软件可能会拒绝连接。

我遇到了类似的问题，发现在两台机器上禁用防病毒软件都有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-29T08:41:09.477

您必须将客户端 (GUI) 的主机文件更改为：

```
xxx.xxx.xxx.xxx localhost <your computer name> 
```

其中：xxx.xxx.xxx.xxx是你的客户端的真实本地IP，比如192.168.1.5

希望这有帮助。

# windbg - 使用 Windbg 转储数组

> ID：10321144
> 
> 赞同：1
> 
> 时间：2012-04-25T17:58:34.017
> 
> 标签：windbg, crash-dumps, sos

在 C# 中，我有一个对象说它`Shape`有两个字段`area`和`length`.

我得到了一个`shapeList`形状的集合。

我的故障转储中有一个`shapeList`地址。

我需要 windbg 中的一个脚本，它遍历 shapeList 数组中的每个项目，并`area`为每个形状显示单独的值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T22:54:42.750

```
 .for ( r $t1 = 0; @$t1 < [length] * [element size]; r $t1 = @$t1 + [element size];) {!do poi(poi(@$t1+poi([address of list]+0x8)+0x18)+[offset of child object in parent object) }

    For example:

     class Foo
        {
            public Bar MyBar { get; set; }
        }

        class Bar
        {
            public String MyString { get; set; }
        }

0:000> .for ( r $t1 = 0; @$t1 < 0x5 * 0x8; r $t1 = @$t1 + 0x8;) {!do poi(poi(@$t1+poi(0000000002362e40+0x8)+0x18)+0x8) }
Name:        testdebug.Bar
MethodTable: 000007fe95eb3928
EEClass:     000007fe95fc22d8
Size:        24(0x18) bytes
File:        C:\users\testdebug.exe
Fields:
              MT    Field   Offset                 Type VT     Attr            Value Name
000007fef47b4130  4000002        8        System.String  0 instance 00000000023653b0 <MyString>k__BackingField
Name:        testdebug.Bar
MethodTable: 000007fe95eb3928
EEClass:     000007fe95fc22d8
Size:        24(0x18) bytes
File:        C:\users\testdebug.exe
Fields:
              MT    Field   Offset                 Type VT     Attr            Value Name
000007fef47b4130  4000002        8        System.String  0 instance 0000000002365468 <MyString>k__BackingField
Name:        testdebug.Bar
MethodTable: 000007fe95eb3928
EEClass:     000007fe95fc22d8
Size:        24(0x18) bytes
File:        C:\users\testdebug.exe
Fields:
              MT    Field   Offset                 Type VT     Attr            Value Name
000007fef47b4130  4000002        8        System.String  0 instance 0000000002365520 <MyString>k__BackingField
Name:        testdebug.Bar
MethodTable: 000007fe95eb3928
EEClass:     000007fe95fc22d8
Size:        24(0x18) bytes
File:        C:\users\testdebug.exe
Fields:
              MT    Field   Offset                 Type VT     Attr            Value Name
000007fef47b4130  4000002        8        System.String  0 instance 00000000023655d8 <MyString>k__BackingField
Name:        testdebug.Bar
MethodTable: 000007fe95eb3928
EEClass:     000007fe95fc22d8
Size:        24(0x18) bytes
File:        C:\users\testdebug.exe
Fields:
              MT    Field   Offset                 Type VT     Attr            Value Name
000007fef47b4130  4000002        8        System.String  0 instance 0000000002365690 <MyString>k__BackingField 
```

# php - 将 HTML 存储在完全可读的 Javascript 变量中的好方法

> ID：10321145
> 
> 赞同：1
> 
> 时间：2012-04-25T17:58:35.003
> 
> 标签：php, javascript

我正在尝试将 HTML 存储在 Javascript 变量中，以便将来易于阅读和编辑。

我已经这样做了：

```
var form = [
    "<fieldset>",
    "  <label></label>",
    "</fieldset>" ].join("\n"); 
```

唯一的事情是我希望它比将来更容易编辑，可能将它存储在 PHP 中的一个变量中（如果这更容易的话），然后对其进行编码或其他东西。

将会有更多的HTML

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:08:42.803

在 PHP 变量中：

```
$form =<<<FORM
<fieldset>
    <label></label>
</fieldset>
FORM; 
```

[http://www.php.net/manual/en/language.types.string.php#language.types.string.syntax.heredoc](http://www.php.net/manual/en/language.types.string.php#language.types.string.syntax.heredoc)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:03:21.033

如果您提到的 PHP 选项是您想要的方式，那么一个选项（非常易读且易于编辑）将类似于：

```
$out = '<div>';
    $out .= '<p>Hello, World</p>';
$out .= '</div>; 
```

最大的优势（我认为）是这使您可以自由缩进以提高可读性。显然是一个非常简单的例子，但希望这一点得到了理解。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T18:03:30.207

您可以通过在每行添加反斜杠来编写多行字符串：

[在 JavaScript 中创建多行字符串](https://stackoverflow.com/questions/805107/how-to-create-multiline-strings)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T18:18:54.480

我会使用 jQuery 模板。

[http://blog.reybango.com/2010/07/09/not-using-jquery-javascript-templates-youre-really-missing-out/](http://blog.reybango.com/2010/07/09/not-using-jquery-javascript-templates-youre-really-missing-out/)

你的例子：

```
<script id="myTemplate" type="text/html">
    <fieldset><label></label></fieldset>
</script> 
```

此外，模板允许您添加变量，例如：

```
<script id="myTemplate" type="text/html">
    <fieldset><label class="${labelclass}">${label}</label></fieldset>
</script> 
```

您将信息作为数组传递

```
var templateData = [
    { labelclass: "fruit", label: "orange" },
    { labelclass: "vegetable", label: "cucumber" },
    { labelclass: "animal", label: "dog" }
]; 
```

然后你可以附加到你想要的地方

`$("#myTemplate").tmpl(templateData ).appendTo( "form" );`

您不必使用变量，但它比尝试手动构建它要干净得多。

# ruby - 按特定顺序运行 RSpec 任务

> ID：10321166
> 
> 赞同：23
> 
> 时间：2012-04-25T17:59:38.727
> 
> 标签：ruby, rspec, rake

我定义了一堆[RSpec](http://en.wikipedia.org/wiki/RSpec) [Rake](http://en.wikipedia.org/wiki/Rake_%28software%29)任务，当我运行整个测试套件时，我想按特定顺序运行。

我试过这样的事情：

```
task :run_in_order => [:one, :two, :three] do 
  puts "Run suite of tests"
end 
```

它运行第一个测试，然后停止并且不运行其余任务。

因此，如果使用 Rake 语法它不起作用。有没有办法记录 RSpec Rake 任务的任务依赖关系？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-04-26T07:30:41.603

检查这个[http://blog.davidchelimsky.net/2012/01/04/rspec-28-is-released/](http://blog.davidchelimsky.net/2012/01/04/rspec-28-is-released/)

> --order rand 我们添加了一个带有两个支持值的 --order 选项：rand 和 default。
> 
> rspec --order random（或 rand）告诉 RSpec 以随机顺序运行组，然后以随机顺序运行每个组中的示例。我们以这种方式实现它（而不是对每个示例进行完全随机化），因为我们不想重新运行昂贵的 before(:all) 钩子。一个公平的权衡，因为由此产生的随机化在暴露顺序依赖错误方面同样有效。
> 
> 当您使用 --order random 时，RSpec 会打印出它用于为随机发生器播种的随机数。当你认为你发现了一个顺序依赖的错误时，你可以传递种子并且顺序将保持一致：
> 
> --order rand:3455 --order default 告诉 RSpec 加载组和示例，因为它们在每个文件中声明

基本上，您应该在规范文件中订购测试，然后使用`--order default`选项执行它。.

# python - Django登录/发布登录

> ID：10321168
> 
> 赞同：0
> 
> 时间：2012-04-25T17:59:41.560
> 
> 标签：python, django, login

我在使用 django 的用户帐户/登录时遇到问题。我正在尝试在登录后做一些事情，但是登录后网站显示我尚未登录。例如，在 html 标记中，如果我使用 {{ user }} 它会打印出匿名用户，即使我是未登录。我不知道我的代码有什么问题：

视图.py：

```
def index(request):
    return render_to response({'user', request.user}) 
```

网址.py：

```
(r'^$', 'tickets.views.index'),
(r'^accounts/login/$', 'django.contrib.auth.views.login' ),
(r'^accounts/logout/$','django.contrib.auth.views.logout'), 
```

login.html 是基本的 django 登录模板，在索引上我显示了 {{ user }}。

谢谢你的帮助。

编辑：

我确实有一个模板标签，我只是没有在那里输入它。我想让它说我在登录后已经登录。例如：如果我使用帐户 test 登录，我希望测试显示 {{ user }} 不是匿名用户的位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T18:28:39.437

1.  在您的设置中检查 SESSION_ENGINE。它可能是缓存后端，缓存可能设置为虚拟。
2.  检查 MIDDLEWARE_CLASSES 中的 'django.contrib.sessions.middleware.SessionMiddleware。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:31:02.363

我刚刚重读了你的问题。您*应该*在未登录时获得 AnonymousUser。

请参阅[Django 文档](https://docs.djangoproject.com/en/dev/topics/auth/#django.contrib.auth.models.AnonymousUser)。

> 匿名用户是未经身份验证的用户，即他们没有提供有效的身份验证详细信息。但是，这并不一定意味着他们无权做任何事情。在最基本的层面上，大多数网站都授权匿名用户浏览网站的大部分内容，许多网站还允许匿名发表评论等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T18:35:51.147

你很可能想在你的模板中做这样的事情：

```
{% if user.is_authenticated %}
  <p>Hi logged in user!</p>
{% else %}
  <p>Please login</p>
{% endif %} 
```

当用户尚未登录时，您将获得[AnonymousUser](https://docs.djangoproject.com/en/dev/topics/auth/#django.contrib.auth.models.AnonymousUser)的一个实例。`is_authenticated()`您可以通过调用该方法来检查它们是否经过身份验证。

# javascript - Internet Explorer 9 和 javascript 变量范围问题

> ID：10321169
> 
> 赞同：1
> 
> 时间：2012-04-25T17:59:42.707
> 
> 标签：javascript, jquery, json, internet-explorer, scoping

此代码在 Chrome 和 Firefox 中有效，但在 IE9 中无效……需要一些提示……

```
var obj = {
    data: [],

    json: function() {
        var self = this;
        $.getJSON("highscore.json", function(resp) {
            self.data = resp.splice(0);
        });
    }
}; 
```

更新：

谢谢你的帮助...

这是来自 ie9 的问题，即抛出了错误代码“c00ce56e” - 这是字符集的问题。我会在 php 脚本中尝试另一个标题...

谢谢@所有

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T18:02:55.060

您的代码对我来说看起来不错，除了在 json 请求完成之前不会填充数据，这不是即时的，因为 ajax 是异步的。

```
obj.json();
alert(obj.data); // []
setTimeout(function(){
    alert(obj.data); // ["foo","bar","foobar"]
},5000); 
```

**更新**
我建议向您的对象添加一个名为 request 的属性，并将 $.getJSON 请求存储在其中。那时将数据直接存储在对象上是没有意义的，因为您总是可以从请求中获取它。

```
var obj = {
    request: {done:$.noop,fail:$.noop,always:$.noop},

    json: function() {
        this.request = $.getJSON("highscore.json");
    }
};
obj.json();
// you can run the following as many times as you need to use the data.
obj.request.done(function(data){
    alert(data.splice(0));
}); 
```

请注意，在当前形式下，您必须先调用 .json() 才能向请求添加回调。

# c# - C++/CLI 包装器尝试使用 MFC CObject 继承

> ID：10321179
> 
> 赞同：0
> 
> 时间：2012-04-25T18:00:26.777
> 
> 标签：c#, mfc, c++-cli

使用 VS2010，我正在将大量 .h 文件和一个 .lib 从本机 C++（使用 MFC）包装到 C++/CLI，最终用作 C# 中的引用 .dll。

在创建包装器时，我收到编译器错误，指出 CObject 未定义。在项目属性中，我将使用 MFC 设置为在静态库和运行时库中使用 MFC 来进行多线程调试 DLL (/MDd)。我正在链接 .lib 并包含 .h 文件。编译器错误位于某些类从 CObject 继承的 .h 文件中。

编译器不应该知道 CObject 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T21:01:51.080

你#include 了 MFC 头文件吗？afx.h、afxwin.h 之类的？#include 可能在您的本机 C++ 项目的 stdafx.h 中，并且没有被复制到您在 C++/CLI 项目中使用的头文件中。

# html - 悬停和活动的 CSS3 通配符选择

> ID：10321182
> 
> 赞同：0
> 
> 时间：2012-04-25T18:00:30.827
> 
> 标签：html, css, css-selectors

我想使用通配符选择`:hover`和`active`

我目前的CSS是：

```
a.trigger 
```

我将其转换为：

```
a[id*='trigger-'] {

} 
```

我也需要同样的`hover`和`active`。我可以这样做吗？

```
a.trigger:hover {
}

a.active.trigger {
} 
```

如何使用通配符进行转换？

```
a.active.[id*='trigger-'] {
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T18:26:37.523

我不太清楚你在问什么，但这就是答案吗？

```
a[id*='trigger-']:hover,
a[id*='trigger-']:active {

} 
```

# php - 将现有的zend框架目录添加到eclipse

> ID：10321184
> 
> 赞同：2
> 
> 时间：2012-04-25T18:00:38.573
> 
> 标签：php, eclipse, zend-framework

我是 php 新手。我正在读一本书并使用 zend 框架创建了一个示例项目。我的应用程序位于 C:\apache\htdocs\mysite.com\

我想将此添加到 Eclipse 项目资源管理器中。我没有看到在 Eclipse 中打开现有项目的选项。我怎样才能做到这一点？

另外，在我添加了项目之后，我是否需要在我的项目引用中的某处添加来自 zend 框架的库目录，以便 eclipse 知道包含这个？

eclipse intellisense 会选择新库还是需要添加插件？

谢谢，库纳尔

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-26T04:50:50.417

## 从现有源创建新项目

** 截图如下*

1.  文件 > 新建 > 项目...`screenshot-1`

2.  选择“PHP/PHP项目”>下一步`[screenshot-2]`

3.  选择“在现有位置（从现有源）创建项目”——添加项目目录。即选择“浏览...”并浏览到您的项目所在的文件夹*（例如，在您的情况下，目录是“C:\apache\htdocs\mysite.com\”）* `[screenshot-3]`

4.  选择“完成”您的完成。

## 添加 Zend 框架以完成代码

请参阅[这些](https://stackoverflow.com/questions/903769/how-do-you-add-a-php-framework-to-code-completion-assist-in-eclipse-pdt-and-can)stackoverflow[问题](https://stackoverflow.com/questions/5039712/eclipse-pdt-how-to-enable-content-code-assist-for-personal-php-libraries)。

另请参阅有关构建路径和包含路径之间差异的这个[stackoverflow 问题。](https://stackoverflow.com/questions/981956/whats-the-difference-between-the-build-path-and-the-include-path-in-eclipse-pdt)

## 截图

`screenshot-1`

![在此处输入图像描述](../Images/9e7eb4b1aa56fda0f00be05d044236ad.png)

`screenshot-2`

![在此处输入图像描述](../Images/a44f450b8abeb9a7771e078d3bf92eab.png)

`screenshot-3`

![在此处输入图像描述](../Images/c52339b7a36e0b739de3fa1990a90e99.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T20:15:58.930

您的个人项目结构（包括您的 Web 服务器）和 Eclipse 中的项目结构是独立的结构。Eclipse 无法知道您的“个人”项目是什么。

您应该在 Eclipse 中安装 PDT，然后在 Project Explorer 中创建 New->PHP Project。在内容中，您必须选择“在现有位置（从现有源）创建项目”，您可以在其中选择项目的文件夹。

如果您必须添加库，请按照向导进行操作，如果它们在项目之外，这可能会有点棘手。

# ruby-on-rails - 自学rails将第一个应用程序部署到heroku-上传失败-sqlite3和postgre故障

> ID：10321189
> 
> 赞同：2
> 
> 时间：2012-04-25T18:00:43.507
> 
> 标签：ruby-on-rails, heroku, railstutorial.org, gemfile

我自学rails。我是程序员，但不是网络程序员。[我在这里](http://ruby.railstutorial.org/)浏览迈克尔哈特尔的书

它提到从一开始就开始部署您的应用程序是一个好主意。我同意。所以我在 Heroku 上获得了一个帐户并进行了设置等。然后创建了我的第一个应用程序 git 和作品。然后按照 Heroku 网站上的所有说明进行操作。最后，我开始使用以下命令将我的应用程序推送到 Heroku：

```
git push heroku master 
```

这本书说在这个阶段可能会出现问题，因为我机器上的应用程序使用的是 sqlite3 而 Heroku 需要 postgresql。这本书建议在我的应用程序的 gem 文件中更改一行

```
gem 'sqlite3' 
```

到

```
gem 'sqlite3-ruby', :group => :development 
```

我试过了，然后运行捆绑安装，然后尝试推送应用程序。不幸的是，我在控制台上收到了这条消息：

```
An error occured while installing sqlite3 (1.3.6), and Bundler cannot continue.
   Make sure that `gem install sqlite3 -v '1.3.6'` succeeds before bundling. 
```

！！无法通过 Bundler 安装 gem。！！Heroku 推送被拒绝，无法编译 Ruby/rails 应用程序

所以我尝试了 Heroku 网站[在这里的建议](https://devcenter.heroku.com/articles/rails3)

更改我的 gemfile

由此：

```
gem 'sqlite3' 
```

对此：

```
gem 'pg' 
```

所以我尝试了这种方法，然后运行“捆绑安装”。但这也没有用。我在控制台上收到此消息：

```
Installing pg (0.13.2) with native extensions 
Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.

        /Users/AM/.rvm/rubies/ruby-1.9.2-p290/bin/ruby extconf.rb 
checking for pg_config... no
No pg_config... trying anyway. If building fails, please try again with
 --with-pg-config=/path/to/pg_config
checking for libpq-fe.h... no
Can't find the 'libpq-fe.h header
*** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options.

Provided configuration options:
    --with-opt-dir
    --with-opt-include
    --without-opt-include=${opt-dir}/include
    --with-opt-lib
    --without-opt-lib=${opt-dir}/lib
    --with-make-prog
    --without-make-prog
    --srcdir=.
    --curdir
    --ruby=/Users/AM/.rvm/rubies/ruby-1.9.2-p290/bin/ruby
    --with-pg
    --without-pg
    --with-pg-dir
    --without-pg-dir
    --with-pg-include
    --without-pg-include=${pg-dir}/include
    --with-pg-lib
    --without-pg-lib=${pg-dir}/lib
    --with-pg-config
    --without-pg-config
    --with-pg_config
    --without-pg_config

Gem files will remain installed in /Users/AM/.rvm/gems/ruby-1.9.2-p290/gems/pg-0.13.2     for inspection.
Results logged to /Users/AM/.rvm/gems/ruby-1.9.2-p290/gems/pg-0.13.2/ext/gem_make.out
An error occured while installing pg (0.13.2), and Bundler cannot continue.
Make sure that `gem install pg -v '0.13.2'` succeeds before bundling. 
```

尝试运行此命令：

```
gem install pg 
```

失败并显示以下错误消息：

```
Building native extensions.  This could take a while...
ERROR:  Error installing pg:
    ERROR: Failed to build gem native extension.

/Users/AM/.rvm/rubies/ruby-1.9.2-p290/bin/ruby extconf.rb
checking for pg_config... no
No pg_config... trying anyway. If building fails, please try again with
--with-pg-config=/path/to/pg_config
checking for libpq-fe.h... no
Can't find the 'libpq-fe.h header
*** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options.

Provided configuration options:
--with-opt-dir
--with-opt-include
--without-opt-include=${opt-dir}/include
--with-opt-lib
--without-opt-lib=${opt-dir}/lib
--with-make-prog
--without-make-prog
--srcdir=.
--curdir
--ruby=/Users/AM/.rvm/rubies/ruby-1.9.2-p290/bin/ruby
--with-pg
--without-pg
--with-pg-dir
--without-pg-dir
--with-pg-include
--without-pg-include=${pg-dir}/include
--with-pg-lib
--without-pg-lib=${pg-dir}/lib
--with-pg-config
--without-pg-config
--with-pg_config
--without-pg_config

Gem files will remain installed in /Users/AM/.rvm/gems/ruby-1.9.2-p290/gems/pg-0.13.2     for inspection.
Results logged to /Users/AM/.rvm/gems/ruby-1.9.2-p290/gems/pg-0.13.2/ext/gem_make.out 
```

有人可以帮我解决这个问题。我遇到了障碍。不知道下一步该怎么做。谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-26T09:47:04.540

您的情况下的正确配置已在其他答案中发布，为了您的方便，我将其附在此处。

```
group :production do
  gem 'pg'
end

group :development, :test do
  gem 'sqlite3'
end 
```

但是，请记住，当您运行时`bundle install`，bundler 将尝试为所有环境安装所有 gem。稍后，它将在运行时仅加载指定环境的 gem。

这就是为什么在您的本地计算机上也尝试安装它的原因`pg`。

您有两种可能解决编译错误：

1.  install ， gem 编译`libpq`所需的库。`pg`您不需要安装完整的 PostgreSQL 客户端或堆栈，`libpq`足以通过编译。在 MacOSX 上，您可能希望使用[homebrew](https://brew.sh/)安装它。

2.  告诉 bundler 在运行安装时跳过不必要的组。

    ```
     bundle install --without production 
    ```

附带说明一下，请记住 SQLite 和 PostgreSQL 是两个不同的数据库。使用尽可能类似于生产环境的开发环境总是一个好主意。我个人的建议是在本地机器上安装 PostgreSQL，并在开发和生产中使用它。

同样，自制软件是您的朋友。

```
$ brew install postgresql 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T18:10:23.650

您需要在本地安装 Postgres。看来您使用的是 Mac，因此最简单的方法是在此处使用安装程序：

[http://www.postgresql.org/download/macosx/](http://www.postgresql.org/download/macosx/)

然后在你的 Gemfile 中坚持这个：

```
gem 'pg' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-25T19:50:27.067

所以这是有效的：1）在机器上安装postgresql

2) 对于永久修复 - 转到 .bash_rc 文件并添加以下内容： export PATH = "/Library/PostgreSQL/9.1/bin/":$PATH 或者只是安装丢失的文件并运行一次捆绑命令，键入此在应用程序的根目录中：PATH=$PATH:/Library/PostgreSQL/9.1/bin/ bundle install 或 PATH=$PATH:/Library/PostgreSQL/9.1/bin/ gem install pg

3）现在安装了pg gem

这篇文章很有帮助： [http ://excid3.com/blog/installing-postgresql-and-pg-gem-on-mac-osx/](http://excid3.com/blog/installing-postgresql-and-pg-gem-on-mac-osx/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T18:07:53.647

尝试

```
group :production do
  gem 'pg'
end

group :development do
  gem 'sqlite3'
end 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-25T18:12:53.667

我认为错误的原因是您的系统上未安装pg，因此您无法安装gem。

虽然 heroku 不建议使用不同的数据库，但我的工作是这样的：

```
group :test, :development do
  gem 'sqlite3'
end

group :production do
  gem 'pg'
end 
```

# javascript - 使用 JSON 字符串填充 Kendo UI 网格

> ID：10321190
> 
> 赞同：0
> 
> 时间：2012-04-25T18:00:49.640
> 
> 标签：javascript, jquery, telerik, kendo-ui

我正在使用 Kendo UI Grid，并且在使用 JSON 字符串时无法让它显示数据。[我在这里创建了一个小提琴。](http://jsfiddle.net/Halcyon/DnhSG/)我究竟做错了什么？

```
<script type="text/javascript">
    $(document).ready(function ()
    {
        $('#grid').kendoGrid(
        {
            scrollable: false,
            data: '{"TestHeader":"This is some test data"}',
            columns: [ { field: 'TestHeader' } ]
        });
    });
</script>
<div id="grid"></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:04:18.547

这可能更接近您想要的（注意数据定义的更改）：

```
$(document).ready(function ()
{
    $('#grid').kendoGrid(
    {
        scrollable: false,
        dataSource: { data: [ { "TestHeader": "This is some test data"} ] },
        columns: [ { field: 'TestHeader' } ]
    });
});​ 
```

# apache-flex - 在 Flex Web 应用程序中使用 Activex Dll

> ID：10321193
> 
> 赞同：0
> 
> 时间：2012-04-25T18:01:05.217
> 
> 标签：apache-flex, actionscript, flex3, externalinterface

纠正我如果我做错了：

我们在 JBoss 上运行的 Flex-BlazeDS-Spring 中有一个现有的 Web 应用程序。我们需要从客户端机器读取一个 Dll，所以我们使用了 ExternalInterface.call，如下所示：

```
ExternalInterface.call("eval", 
                         "try { "Test" + 
                         " = new ActiveXObject('DllName.FunctioninDll'); }" +
                          "catch(e) { document.getElementById('" + dis+ 
                          "').SetLastError(e.message); } "); 
```

使用上面的代码，我收到 Mozilla“ActiveXObject 未定义”的“自动化服务器无法创建对象”错误。

请建议如果有任何解决方法

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T19:19:30.733

ActiveX 仅在 Internet Explorer 中可用。您可以尝试使用[HTML object tag](http://www.w3schools.com/tags/tag_object.asp)，但我不确定它是否有效。

# android - 网站到智能手机应用程序

> ID：10321194
> 
> 赞同：0
> 
> 时间：2012-04-25T18:01:05.427
> 
> 标签：android, iphone, blackberry, mobile

携带智能手机应用程序网站的最佳方式是什么？

是构建一个完整的应用程序还是仅仅构建一个执行网站上已有的 http 查询的界面更好？

有图案吗？

Ps.：应用程序必须在交易中具有最大的安全性

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:03:00.113

我不知道“最大安全性”是什么意思，但是将 Web 应用程序转换为智能手机应用程序的主要工具是[PhoneGap](http://phonegap.com/)。

# c - 了解 main 的一个不常见的论点

> ID：10321196
> 
> 赞同：18
> 
> 时间：2012-04-25T18:01:17.667
> 
> 标签：c, argument-passing, deobfuscation

以下问题是在一次大学编程竞赛中给出的。我们被要求猜测输出和/或解释它的工作原理。不用说，我们都没有成功。

```
main(_){write(read(0,&_,1)&&main());} 
```

一些简短的谷歌搜索让我想到了这个确切的问题，在`codegolf.stackexchange.com`：

[https://codegolf.stackexchange.com/a/1336/4085](https://codegolf.stackexchange.com/a/1336/4085)

在那里，它解释*了*它的作用：`Reverse stdin and place on stdout`，但不是*如何*。

我还在这个问题中找到了一些帮助：[Main 的三个参数和其他混淆技巧](https://stackoverflow.com/q/727930/926543)， 但它仍然没有解释如何`main(_)`工作。`&_``&&main()`

我的问题是，这些语法是*如何*工作的？它们是我应该知道的，比如它们是否仍然相关？

如果不是直接的答案，我将不胜感激任何指针（指向资源链接等）。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-04-25T18:24:23.747

这个程序有什么作用？

```
main(_){write(read(0,&_,1)&&main());} 
```

在分析之前，我们先美化一下：

```
main(_) {
    write ( read(0, &_, 1) && main() );
} 
```

首先，您应该知道这`_`是一个有效的变量名，尽管它很丑陋。让我们改变它：

```
main(argc) {
    write( read(0, &argc, 1) && main() );
} 
```

接下来，意识到函数的返回类型和参数的类型在 C 中是可选的（但在 C++ 中不是）：

```
int main(int argc) {
    write( read(0, &argc, 1) && main() );
} 
```

接下来，了解返回值是如何工作的。对于某些 CPU 类型，返回值始终存储在相同的寄存器中（例如 x86 上的 EAX）。因此，如果您省略一条`return`语句，则返回值很*可能*是最近返回的函数。

```
int main(int argc) {
    int result = write( read(0, &argc, 1) && main() );
    return result;
} 
```

对的调用`read`或多或少很明显：它从标准 in（文件描述符 0）读取到位于 的内存中`&argc`，以获取`1`字节。`1`如果读取成功则返回，否则返回 0。

`&&`是逻辑“与”运算符。当且仅当它的左侧为“真”（从技术上讲，任何非零值）时，它才会评估其右侧。`&&`表达式的结果`int`是始终为 1（表示“真”）或 0（表示假）的 an。

在这种情况下，右侧调用`main`不带参数。在用 1 个参数声明它之后不带参数调用`main`是未定义的行为。尽管如此，只要您不关心`argc`参数的初始值，它通常会起作用。

然后将结果`&&`传递给`write()`. 所以，我们的代码现在看起来像：

```
int main(int argc) {
    int read_result = read(0, &argc, 1) && main();
    int result = write(read_result);
    return result;
} 
```

唔。快速浏览一下手册页会发现它`write`需要三个参数，而不是一个。未定义行为的另一种情况。就像`main`用太少的参数调用一样，我们无法预测`write`它的第二个和第三个参数会收到什么。在典型的计算机上，他们会得到*一些东西*，但我们不能确定是什么。（在非典型计算机上，可能会发生奇怪的事情。）作者依赖于`write`接收之前存储在内存堆栈中的任何内容。而且，他依靠的*是*第二和第三个论点来阅读。

```
int main(int argc) {
    int read_result = read(0, &argc, 1) && main();
    int result = write(read_result, &argc, 1);
    return result;
} 
```

修复对 的无效调用`main`，添加标题，并扩展`&&`我们拥有的：

```
#include <unistd.h>
int main(int argc, int argv) {
    int result;
    result = read(0, &argc, 1);
    if(result) result = main(argc, argv);
    result = write(result, &argc, 1);
    return result;
} 
```

* * *

**结论**

该程序在许多计算机上无法按预期工作。即使您使用与原作者相同的计算机，它也可能无法在不同的操作系统上运行。即使您使用相同的计算机和相同的操作系统，它也无法在许多编译器上运行。即使您使用相同的计算机编译器和操作系统，如果您更改编译器的命令行标志，它也可能无法正常工作。

正如我在评论中所说，这个问题没有有效的答案。如果您发现比赛组织者或比赛评委另有说法，请不要邀请他们参加您的下一场比赛。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-25T18:13:49.173

好的，`_`它只是早期 K&R C 语法中声明的变量，默认类型为 int。它起到临时存储的作用。

程序将尝试从标准输入中读取一个字节。如果有输入，它将递归调用 main 继续读取一个字节。

在输入结束时，`read(2)`将返回 0，表达式将返回 0，`write(2)`系统调用将执行，调用链可能会展开。

我在这里说“可能”，因为从这一点开始，结果高度依赖于实现。其他参数`write(2)`丢失了，但寄存器和堆栈中会有一些东西，所以*一些东西**会*被传递到内核中。相同的**未定义行为**适用于 的各种递归激活的返回值。***`main`***

 ***在我的 x86_64 Mac 上，程序读取标准输入直到 EOF 然后退出，什么也不写。***

# xcode - 如何设置可选的 xcodatamodel 属性？

> ID：10321199
> 
> 赞同：0
> 
> 时间：2012-04-25T18:01:25.037
> 
> 标签：xcode, core-data

我听说有一个复选框或其他东西，但我在 XCode 界面的任何地方都找不到它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T18:22:38.827

应该在数据模型检查器面板中。
按`command`+ `option`+`3`显示该面板。
或者在*视图*按钮组中选择右边的，然后选择右边的选项卡。

![在此处输入图像描述](../Images/2419c7930b81d63c9db0760c3b2076ef.png)

# exchangewebservices - EWS：更改现有约会的所有者

> ID：10321200
> 
> 赞同：1
> 
> 时间：2012-04-25T18:01:27.457
> 
> 标签：exchangewebservices

我正在尝试将现有约会的项目设置为所有者，并且我正在使用类似于以下 Xml 请求的内容：

```
<ns1:UpdateItem xmlns:ns1="http://schemas.microsoft.com/exchange/services/2006/messages" xmlns:ns2="http://schemas.microsoft.com/exchange/services/2006/types" ConflictResolution="AlwaysOverwrite" SendMeetingInvitationsOrCancellations="SendToNone">
    <ns1:ItemChanges>
        <ns2:ItemChange>
            <ns2:ItemId Id="AAMkADY1ZDIwNjM1LTU4MjAtNGQy...ogbn8LT58s6MSx+1IiAZWtaUhFAACF1Gogbn8LT58s6MSx+1IiAZ3GKIJbAAA=" ChangeKey="DwAAABYAAACF1Gogbn8LT58s6MSx+1IiAZ3HHOPj"/>
            <ns2:Updates>
                <ns2:SetItemField>
                    <ns2:ExtendedFieldURI DistinguishedPropertySetId="Appointment" PropertyId="33321" PropertyType="Boolean"/>
                    <ns2:CalendarItem>
                        <ns2:ExtendedProperty>
                            <ns2:ExtendedFieldURI DistinguishedPropertySetId="Appointment" PropertyId="33321" PropertyType="Boolean"/>
                            <ns2:Value>true</ns2:Value>
                        </ns2:ExtendedProperty>
                    </ns2:CalendarItem>
                </ns2:SetItemField>
                <ns2:SetItemField>
                    <ns2:ExtendedFieldURI DistinguishedPropertySetId="Appointment" PropertyId="33303" PropertyType="Integer"/>
                    <ns2:CalendarItem>
                        <ns2:ExtendedProperty>
                            <ns2:ExtendedFieldURI DistinguishedPropertySetId="Appointment" PropertyId="33303" PropertyType="Integer"/>
                            <ns2:Value>1</ns2:Value>
                        </ns2:ExtendedProperty>
                    </ns2:CalendarItem>
                </ns2:SetItemField>
            </ns2:Updates>
        </ns2:ItemChange>
    </ns1:ItemChanges>
</ns1:UpdateItem> 
```

我需要您的帮助才能使用 EWS API 来进行此调用而不是 SOAP 调用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T18:09:25.473

我想我明白了：

```
ExtendedPropertyDefinition definition;
definition = new ExtendedPropertyDefinition(DefaultExtendedPropertySet.Appointment, 33321, MapiPropertyType.Boolean);
appointment.SetExtendedProperty(definition, true);
definition = new ExtendedPropertyDefinition(DefaultExtendedPropertySet.Appointment, 33303, MapiPropertyType.Integer);
appointment.SetExtendedProperty(definition, 1);
appointment.Update(ConflictResolutionMode.AlwaysOverwrite, SendInvitationsOrCancellationsMode.SendToNone); 
```

# android - 从 sqlite 数据库中删除 - Android

> ID：10321204
> 
> 赞同：0
> 
> 时间：2012-04-25T18:01:41.050
> 
> 标签：android, sqlite

由于某种原因，我无法从我的数据库中删除。我正在尝试将数据库中的 _ID 值与用户在 EditText 框中输入的值进行比较，如果匹配，则应删除整行。

这是我到目前为止所得到的：

```
private static String[] DELETION = {_ID, TITLE, TIME, DETAILS};
private Cursor delete(){
        calendarData = new CalendarData(this);
        SQLiteDatabase db = calendarData.getWritableDatabase();

        Cursor idToDelete = db.query(true, TABLE_NAME, DELETION, _ID+" = "+deleteAnAppointment.getText(),
                null, null, null, null, null);
        startManagingCursor(idToDelete);
        return idToDelete;
    }

    private void selectToDelete(Cursor cursor){
        calendarData = new CalendarData(this);
        SQLiteDatabase db = calendarData.getWritableDatabase();
        if(cursor.moveToNext()){
            db.delete(TABLE_NAME, _ID+" = "+deleteAnAppointment.getText(), null);
        }

    } 
```

请任何帮助将不胜感激，我的 EditText 输入类型设置为数字

编辑：只是为了让它更清楚一点，我在 onClick 中调用这些方法以获得这样的按钮：

```
Cursor toDelete = delete();
            selectToDelete(toDelete); 
```

编辑（2）：表创建

```
@Override
    public void onCreate(SQLiteDatabase db){
        db.execSQL("CREATE TABLE " + TABLE_NAME + " (" + _ID + " INTEGER PRIMARY KEY AUTOINCREMENT, " + 
                    DATE + " LONG, " +
                    TITLE + " TEXT NOT NULL, " + TIME + " TEXT NOT NULL," + DETAILS + " TEXT NOT NULL);");
    } 
```

编辑（3）：我尝试了这个以及一个简单的方法，但仍然没有：

```
private void deleteAppointment(){
        calendarData = new CalendarData(this);
        SQLiteDatabase db = calendarData.getWritableDatabase();

        db.delete(TABLE_NAME, _ID+" = "+deleteAnAppointment.getText(), null);

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T18:37:54.100

我看到了你的问题。您正在调用 (edittext obj).getText() ，它实际上并没有返回它返回的文本和可编辑的实例。之后调用 .toString() ，然后您将获得实际值。

如果您添加了一个日志来打印您的选择语句，这将很容易检测到......仅供参考

# sorting - NSArray 排序

> ID：10321205
> 
> 赞同：0
> 
> 时间：2012-04-25T18:01:41.980
> 
> 标签：sorting, nsarray

我有一个`NSArray`with 值，我从一个`NSDictionary`使用选择器进行排序的值中提取，它具有以下值：

1.  约翰
2.  布赖恩
3.  亚历克斯……
4.  戴夫

当我使用下面的代码时，由于将它们作为字符串进行比较，因此列表返回：

```
NSArray *array = [[[self myDictionary] allValues] sortedArrayUsingSelector:@selector(compare:)]; 
```

1.  约翰
2.  戴夫
3.  布赖恩...

如何让这些值按 1、2、3 等顺序正确排序？我查看了几个不同的排序示例，但找不到像我这样的示例。我还必须提到，我是 Objective-c 和 iOS 的新手。任何帮助将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T17:28:45.147

我实际上能够找出解决方案。我`NSComparisonResult`使用自定义逻辑创建了一个块来读取每个字符串前面的数字部分，然后对它们进行数字比较：

```
NSComparisonResult (^sortByNumber)(id, id) = ^(id obj1, id obj2)
{
    //Convert items to strings
    NSString *s1 = (NSString *)obj1;
    NSString *s2 = (NSString *)obj2;

    //Find the period and grab the number
    NSUInteger periodLoc1 = [s1 rangeOfString:@"."].location;
    NSString *number1 = [s1 substringWithRange:NSMakeRange(0, periodLoc1)];

    NSUInteger periodLoc2 = [s2 rangeOfString:@"."].location;
    NSString *number2 = [s2 substringWithRange:NSMakeRange(0, periodLoc2)];

    //Compare the numeric values of the numbers
    return [number1 compare:number2 options:NSNumericSearch];
}; 
```

然后我通过调用对我的数组进行排序：

```
NSArray *array = [[[self myDictionary] allValues] sortedArrayUsingComparator:sortByNumber]; 
```

# windows - Windows批处理：删除文件名中的最后一个“d”

> ID：10321207
> 
> 赞同：1
> 
> 时间：2012-04-25T18:02:08.373
> 
> 标签：windows, command-line, batch-file

我想要做的是通过 Windows 批量更改从所有 exe 中删除最后一个“d”，最后一个“d”。例如：[stringofwhateverlengthd.exe] 到 [stringofwhateverlength.exe]（注意 d 缺失）

我试过 [ren *d.exe *.exe] 但这并没有真正起作用。一直在环顾四周，但没有找到像那样解析文件名的东西。这可以使用许多工具轻松完成，但我正在寻找 Windows 批处理解决方案。谢谢。

更新：效果很好！谢谢。在不更改原始文件夹和目标文件夹的原始内容的情况下，有没有办法在使用 xcopy 时做到这一点？例如 [xcopy a\*d.exe b\*.exe]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T18:13:21.413

你可以尝试这样的事情：

```
FOR %%A IN (*.exe) DO (
  SET "name=%%~nA"
  SETLOCAL EnableDelayedExpansion
  IF /I !name:~-1! == d (
    RENAME "%%A" "!name:~0,-1!.*"
  )
  ENDLOCAL
) 
```

但是在对此进行更多思考之后，例如[@Marc](https://stackoverflow.com/users/1024832/marc)所做的（谢谢！），您实际上可以想出一些更简单的东西：

```
FOR %%A IN (*d.exe) DO (
  SET "name=%%~nA"
  SETLOCAL EnableDelayedExpansion
  RENAME "%%A" "!name:~0,-1!.*"
  ENDLOCAL
) 
```

# php - 从 PHP 中的简单 XML 元素中提取属性

> ID：10321210
> 
> 赞同：0
> 
> 时间：2012-04-25T18:02:43.780
> 
> 标签：php, xml

让我发疯——我有一个简单的 XML 元素，我只想提取“_Code”属性。我该怎么做？

```
<?php

$responseCode = "<STATUS _Condition='FAILURE' _Code='0705' _Description='Search failed subject not found' />";
$xml = simplexml_load_string($responseCode);

print_r($xml);

$code = $xml=>@attributes=>_Code; // Parse error
$code = $xml['@attributes']['_Code']; // Returns blank
echo "CODE = ".(string)$code; 

?> 
```

> 代码 =

[http://php.net/manual/en/function.simplexml-load-string.php](http://php.net/manual/en/function.simplexml-load-string.php)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:04:44.850

使用[SimpleXMLElement::attributes()](http://php.net/manual/en/simplexmlelement.attributes.php)

```
$attrs = $xml->attributes();
$code = $attrs['_Code']; 
```

# java - 导入证书后 Java Keytool 错误，“keytool 错误：java.io.FileNotFoundException & Access Denied”

> ID：10321211
> 
> 赞同：165
> 
> 时间：2012-04-25T18:02:44.030
> 
> 标签：java, ssl, ssl-certificate, keytool

我正在尝试通过 HTTPS 连接 Java Web API；但是，抛出异常：

```
javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException 
```

我遵循了从在线 keytool 和 SSL 证书教程中学到的这些步骤：

1.  我将 HTTPS URL 复制到浏览器中，下载 SSL 证书并使用 Internet Explorer 在浏览器中安装它们。

2.  将证书导出到我的计算机上的路径，证书保存为`.cer`

3.  使用 keytool 的导入选项。下面的命令执行没有任何错误。

    ```
    keytool -import -alias downloadedCertAlias -keystore C:\path\to\my\keystore\cacerts.file -file C:\path\of\exportedCert.cer 
    ```

4.  在命令提示符处提示我输入密码，然后我输入了密码，然后通过了身份验证。

5.  该`cmd`窗口打印了一些证书数据和签名，并提示我以下问题：

    > 相信这个证书？

    我回答是的。

6.  显示的cmd提示符

    > 证书已添加到密钥库

    但是，在该消息之后，显示了另一个异常：

    ```
    keytool error: java.io.FileNotFoundException: C:\Program files\...\cacerts <Access Denied> 
    ```

最后，当我检查 keystore 时，没有添加 SSL 证书，我的应用程序给出了与我之前尝试连接时相同的异常：

```
(javax.net.ssl.SSLHandshakeException:sun.security.validator.ValidatorException) 
```

* * *

## 回答 #1

> 赞同：315
> 
> 时间：2012-07-05T17:58:35.963

如果您没有在管理员模式下运行命令提示符，则可能会发生这种情况。如果您使用的是 Windows 7，则可以运行，输入 cmd 并按 Ctrl+Shift+enter。这将以管理员模式打开命令提示符。如果没有，您也可以转到开始 -> 所有程序 -> 附件 -> 右键单击​​命令提示符，然后单击“以管理员身份运行”。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2017-12-06T08:07:33.950

在本地密钥库中导入证书时我遇到了同样的问题。每当我发出 keytool 命令时，都会出现以下错误。

证书已添加到密钥库 keytool 错误：java.io.FileNotFoundException: C:\Program Files\Java\jdk1.8.0_151\jre\lib\security（访问被拒绝）

以下解决方案对我有用。

1) 确保您以管理员模式在 Rus 中运行命令提示符

2) 将当前目录更改为 %JAVA_HOME%\jre\lib\security

3）然后发出以下命令

keytool -import -alias "mycertificatedemo" -file "C:\Users\name\Downloads\abc.crt" -keystore cacerts

3）给密码changeit

4) 输入 y

5) 您将在成功的“证书已添加到密钥库”中看到以下消息

确保仅在 -keystore 参数值中提供“ **cacerts** ”，因为我提供了完整路径，例如“C**:\Program Files\Java\jdk1.8.0_151\jre\lib\security**”。

希望这会奏效

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2012-05-03T09:07:06.417

我在 Windows 下遇到了同样的问题，可以通过*以管理员身份运行 cmd.exe*来解决（右键单击开始菜单，然后“以管理员身份运行”）。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-06-27T16:51:21.483

检查密钥库的写入权限。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2017-06-21T19:17:10.973

对于 Mac 用户，请确保 sudo 并在出现提示时首先提供您的管理员密码，然后是密钥库密码，除非您实际更改它，否则该密码通常应该是“changeit”。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-03-17T06:16:02.197

如果您使用的是 windows8：

1.  点击开始按钮
2.  在搜索框中，键入`command prompt`
3.  从结果中，右键单击`command prompt`并单击`Run as administrator`。然后执行keytool命令。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-05-31T22:34:37.500

您可以授予自己解决此问题的权限。

右键单击 cacerts > 选择属性 > 选择 Securit 选项卡 > 允许对所有组和用户名的所有权限。

这对我有用。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-06-16T01:01:06.790

即使我以管理员身份运行 cmd，我也遇到了这个错误。

根本原因是：该文件来自 VCS（subversion、perforce 等），当我检查该文件的属性时，它的 Attributes 是***Read-only***。

所以解决方案是：

*   (1) 禁用“只读”属性；
*   (2) 从VCS中签出，让文件处于读写状态。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-02-14T12:59:18.560

我什至以管理员身份运行命令提示符，但它对我不起作用，出现以下错误。

```
'keytool' is not recognized as an internal or external command,
 operable program or batch file. 
```

如果 keytool 的路径不在您的系统路径中，那么您将需要使用完整路径来使用 keytool，即

```
C:\Program Files\Java\jre<version>\bin 
```

所以，命令应该像

```
"C:\Program Files\Java\jre<version>\bin\keytool.exe" -importcert -alias certificateFileAlias -file CertificateFileName.cer -keystore cacerts 
```

这对我有用。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2022-02-11T13:31:18.230

确保您以管理员身份运行。在 Mac 终端中：-

1.  运行 sudo -i
2.  然后执行命令

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2016-10-13T13:48:14.357

您可以存储其他磁盘或路径（不是 C）EX：D\

```
C:\Program Files\Java\jre1.8.0_101\bin>keytool -genkey -alias server -keyalg RSA -keysize 2048 -keystore D:\myserver.jks -dname "CN=myserver,OU=IT-WebDev, O=TIACHOP, L=HCM, ST=0753, C=VN" && keytool -certreq -alias server -file D:\myserver.csr -keystore D:\myserver.jks 
```

[![在此处输入图像描述](../Images/d2d7b9df125b21780061da38b043bfd5.png)](https://i.stack.imgur.com/6Hdht.png)

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2017-09-13T07:32:24.397

**解决了**

1.  只需以管理员身份运行 CMD。
2.  确保您使用正确的信任库密码

# java - 获得正确的正则表达式——Java

> ID：10321213
> 
> 赞同：1
> 
> 时间：2012-04-25T18:02:44.903
> 
> 标签：java, regex

我正在尝试解析[cflow](http://www.gnu.org/software/cflow/)的输出，然后将其用于构建控制流的 3D 图。cflow 的输出如下所示：

```
main() <int main (int argc, char *argv[]) at sort.c:3>:
    strcmp()
    printf()
    malloc()
    getline() <char *getline (int max) at sort.c:62>:
        isspace()
        getchar()
        ungetc()
        malloc()
    qsort()
    free() 
```

我正在使用正则表达式来提取函数名和括号——我想得到`main()`,`strcmp()`等。我的代码如下：

```
String line = input.nextLine(); // input is a Scanner reading from a file
Pattern p = Pattern.compile("[a-zA-Z0-9_]+\\(\\)"); // the important part
Matcher m = p.matcher(line); 
```

现在，我使用的模式使用 Emacs 的 regexp-builder 模式。然而，当我运行这个程序时，我没有得到任何匹配。我可能只是不了解 Java 的正则表达式函数。

此外，我意识到显而易见的解决方案是不使用 Java……我更喜欢那样，但我将使用 Processing 绘制图形，所以我真的别无选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:08:08.147

如果您尝试提取部分字符串，则必须使用括号在正则表达式中形成组。如果您将正则表达式重写为类似`.*([a-zA-Z0-9_]+\\(\\)).*`，则文字括号中的组实际上存储为匹配项。然后，您将调用`m.group(1)`以检索由第一个括号组提取的字符串，即`[a-zA-Z0-9_]+\\(\\)`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:19:50.050

使用您当前的语法 and `m.matches()`，Java 假定您的意思是：

```
Pattern p = Pattern.compile("^[a-zA-Z0-9_]+\\(\\)$"); 
```

因此，您需要在表达式的开头和结尾添加通配符（我已将您希望匹配的部分括在括号中）

```
Pattern p = Pattern.compile(".*([a-zA-Z0-9_]+\\(\\)).*"); 
```

或调用`m.find()`而不是`m.matches()`.

您现在可以调用：

```
if(m.matches())
{
    myFunctionName = m.group(1);
} 
```

# java - 如何将 HTMLDocument 分配到 JEditorPane 中以修改为源代码？

> ID：10321219
> 
> 赞同：1
> 
> 时间：2012-04-25T18:03:11.710
> 
> 标签：java, swing, jeditorpane, dom

我想知道是否可以使用该方法将现有分配`javax.swing.text.HTMLDocument`给 a`JEditorPane`或 a ，但使用代码完成和所有这些来显示**源代码。**它还应该允许对其进行修改，以便同步 2 个不同的视图（我已经有一个 jEditor 要设计）。`JTextPane``setDocument()`

 **如何分配`HTMLDocument`到一个`JEditorPane`修改为源代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T19:48:30.970

你可以试试这个：它不使用`setDocument()`，但会显示源代码

```
 JTextPane jtPane = new JTextPane();
 StringBuilder st = new StringBuilder();
 String s;
 try {
 FileInputStream f = new FileInputStream("abc.html");
 BufferedReader reader = new BufferedReader(new InputStreamReader(f));
 while((s=reader.readLine())!=null){
 st.append(s);
 }
 jtPane.setText(st.toString());
 } 
  catch (Exception e) 
   {
   e.printStackTrace();
} 
```

这个使用`Document`and `setDocument()`：

```
String s;
Document doc = jp2.getDocument();
try {
FileInputStream f = new FileInputStream("abc.html");
BufferedReader reader = new BufferedReader(new InputStreamReader(f));
while((s=reader.readLine())!=null){
doc.insertString(doc.getLength(), s+"\n", null);
}   
jtPane.setDocument(doc); 
```**

# asp.net - 通过取消或更新按钮单击从弹出窗口返回父页面

> ID：10321220
> 
> 赞同：0
> 
> 时间：2012-04-25T18:03:12.970
> 
> 标签：asp.net, vb.net, gridview

我想就一个独特的处理问题获得一些帮助。考虑到这些限制，我正在寻找一个特定的解决方案。

我有一个弹出 aspx 页面，它从父页面 gridview 编辑单击接收数据。当数据在弹出窗口中翻译时，从父页面解析大量数据以弹出，然后在更新前发送回父页面以在原始文本块中重新组合。

当弹窗传回数据或被取消时，父页面gridview仍处于编辑模式。

我想将弹出窗口中的取消或更新按钮单击传递给父页面gridview，这样它就可以完成更新或取消事件，而无需要求用户从gridview编辑模式单击相应的命令按钮链接来更新或取消。

我真的在寻找教程、链接或示例代码，因为我想完全了解如何做到这一点。

更新：父页面上还有一个 jquery UIBlocker，以防止用户在弹出页面处理完成之前返回页面。以下是关键代码：

**父页面**：

```
function parentFunc(a) {
    //   Unblocks on return from popup page.
    $.unblockUI({});
    document.getElementById("<%=Textbox1.ClientID %>").value = a;

    alert("Please complete the update by entering a Brief Description then clicking the UPDATE link!!");
}

function parentCancel(s) {
    //   Unblocks because of cancel from popup page.
    // var a = 0;
    $.unblockUI({});

    alert("Please click the Cancel link to complete the Cancel process!!");
} 
```

**PARENT PAGE Code Behind** , Row Updatinfg 事件在构建字符串数组后传递到 POPUP 页面。

```
' Sets up popup to open when row selected for edit is cycled.
If IsPostBack Then
    If (e.Row.RowState And DataControlRowState.Edit) > 0 Then
        If Session("updateComplete") <> "Y" And Session("CancelUpdate") <> "Y" Then

            Dim BrowserSettings As String = "status=no,toolbar=no, scrollbars =yes,menubar=no,location=no,resizable=no," & "titlebar=no, addressbar=no, width=850, height=800"
            Dim URL As String = "NewpttStringPopUp.aspx"
            Dim dialog As String = URL
            Dim scriptText1 As String = ("<script>javascript: var w = window.open('" & URL & "','_blank','" & BrowserSettings & "'); $.blockUI({ message: '<h1>Please translate text and click Submit...</h1>' });  </script>")

            ScriptManager.RegisterStartupScript(Me, GetType(Page), "ClientScript1", scriptText1, False)
            Session("updateComplete") = "N"
        End If
    End If
End If 
```

**弹出页面**：

```
function closeform() {
     alert("Please click the Cancel Button at the buttom of the page to Cancel the process!!");

    return "Please click the Cancel Button at the buttom of the page to Cancel the process!!";
   }

function handleWindowClose() {
    if ((window.event.clientX < 0) || (window.event.clientY < 0)) {
        event.returnValue = "If you have made any changes to the fields without clicking the Save button, your changes will be lost.";
    }
}

function callParentFunc() 
{
    var w = window.opener;
    var a;
    if (!w.closed) {
        var val = w.parentFunc(a);
        self.close();
    }
    this.window.focus()
}

function callParentCancel() {
    var w = window.opener;
    var s;
    if (!w.closed) {
    var val = w.parentCancel(s);
    self.close();
    }
} 
```

**CANCEL BUTTON 后面的 POPUP.ASPX.VB 代码**

```
Protected Sub Button1_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Button1.Click
    ' Cancel Button so that no update is processed.
    ' Sets flag to prevent java popup from reopening after RowUpdating event. Occurs in RowDataBound event.
    'Dim s As String = "c"
    Dim strScript2 As String = "callParentCancel();"
    ClientScript.RegisterStartupScript(GetType(Page), "callParentCancel", strScript2.ToString, True)

    Session("UpdateEnd") = "Y"
    Session("CancelUpdate") = "Y"
    'Response.Write("<script>window.close();</script>")
End Sub 
```

**SUBMIT BUTTON 后面的 POPUP.ASPX.VB 代码**

为简洁起见，不显示构建阵列的过程。

```
Session("returnTranslation") = arReturn

    '   Page.PreviousPage.Focus()

    Dim strScript As String = "callParentFunc();"
    ClientScript.RegisterStartupScript(GetType(Page), "callParentFunc", strScript.ToString, True)

    ' Sets flag to prevent java popup from reopening after RowUpdating event. Occurs in RowDataBound event.
    Session("updateComplete") = "Y" 
```

阻止弹出窗口重新加载时出现问题。所以在加载事件中有一个 if 条件。动态数量的控件作为文字构建在弹出窗口上。因此，Page Init 事件和 Page Load 事件在非 Postback 上触发以重建控件。

谢谢，所有的建议都会被审核。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T18:50:30.800

最好的办法是在父级上创建一个 JavaScript 函数，并使用`window.opener`它从弹出窗口中访问它：

**在父母身上**

```
processGridCommand = function(command){
    __doPostBack("<%= GridView1.ClientID %>", command);
    return false; 
} 
```

**从孩子**

```
<script type="text/javascript">
    updateParentGrid = function(command){
        if (window.opener){
            window.opener.processGridCommand(command);
        }
        return false;
    }
</script>
<asp:Button ID="Button1" runat="server" Text="Click" OnClientClick="return updateParentGrid('Update');" /> 
```

**处理父级的回发**

这将触发父级的回发，并覆盖`RaisePostBackEvent`代码隐藏中的方法，您可以根据需要进行处理：

```
protected override void RaisePostBackEvent(IPostBackEventHandler source, string eventArgument)
{
    base.RaisePostBackEvent(source, eventArgument);
    if (source == GridView1)
    {
        switch (eventArgument)
        {
            "Update":
                //perform update logic
                break;
            "Cancel":
                //cancel edit mode
                break;
        }
    }   
} 
```

# wpf - Interactivity.EventTrigger 未订阅自定义路由事件

> ID：10321221
> 
> 赞同：4
> 
> 时间：2012-04-25T18:03:14.560
> 
> 标签：wpf, behavior, eventtrigger

我在 DataTemplate 中有一个自定义行为，它引发了一个自定义路由事件。我想用 TriggerAction 处理该事件（发送消息、调用命令等）。

```
<Border Background="#01FFFFFF" VerticalAlignment="Center">
             <i:Interaction.Behaviors>
                   <Behaviors:MyBehavior>
                        <i:Interaction.Triggers>
                             <i:EventTrigger EventName="MyEvent">
                                    <triggers:SendMessageAction Parameter="ActionTaskAssign" MessageToken="ActionTask" />
                             </i:CustomEventTrigger>
                        </i:Interaction.Triggers>
                    </Behaviors:DropBehavior>
              </i:Interaction.Behaviors>
<!-- .... --> 
```

但我可以清楚地看出，EventTrigger 没有订阅行为的 MyEvent。

*   我尝试通过绑定设置 SourceObject（参见[此处](http://social.expression.microsoft.com/Forums/en/blend/thread/ed1ca13a-2146-443b-b5bf-ee1a22db2ca2)），但 ElementName 绑定似乎不起作用，FindAncestor 也不起作用
*   我尝试从 EventTrigger 继承并在代码中设置 SourceObject，我得到的只是一个 StackOverflowException
*   我试过写一个自定义的EventTrigger，但是我要么为每个自定义事件写一个（如果一切都崩溃了，我会的），或者我必须找出一种通用的方法来处理非泛型`RoutedEventHandler`的事件......

**我该怎么办？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T05:14:13.677

问题是 EventTrigger 没有连接到 Behavior 的事件。相反，它连接到 Behavior 的 AssociatedObject 事件。以下是相关的源代码：

```
protected override void OnAttached()
{
    base.OnAttached();
    DependencyObject associatedObject = base.AssociatedObject;
    Behavior behavior = associatedObject as Behavior;
    FrameworkElement element = associatedObject as FrameworkElement;
    this.RegisterSourceChanged();
    if (behavior != null)
    {
        associatedObject = ((IAttachedObject) behavior).AssociatedObject;
        behavior.AssociatedObjectChanged += new EventHandler(this.OnBehaviorHostChanged);
    }
    .... 
```

}

这里提出了一个相关问题： [Handle MouseDragElementBehavior.Dragging event with void Foo() in VM](https://stackoverflow.com/questions/7461930/sl4-mvvm-handle-mousedragelementbehavior-dragging-event-with-void-foo-in-vm?rq=1)

我自己解决了这个问题，编写了自己的自定义行为来触发命令（我需要它而不是你的消息。

您可以在此处的答案中看到我的方法：

[使用命令的自定义行为](https://stackoverflow.com/questions/9968489/mvvm-handling-the-drag-events-of-mousedragelementbehavior/12793109#12793109)

# vb.net - VB.NET/Visual Studio 2010，在运行时递增控件名称

> ID：10321225
> 
> 赞同：0
> 
> 时间：2012-04-25T18:03:21.263
> 
> 标签：vb.net, controls

我正在编写一个发票应用程序。用户应该能够通过从 ComboBox 中选择产品来向发票的计费部分添加新行，然后根据所选产品填写各种其他字段（价格、描述等）。

我的问题是：当用户添加一个产品时，我希望程序自动为下一个产品生成一个新行。似乎实现这一点的唯一方法是创建一组具有递增名称的新控件，即第一个产品的 Product1、Price1、Desc1，第二个产品的 Product2、Price2、Desc2 等。这可能吗？还是我做错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:25:41.533

我不得不在某一时刻做这样的事情，我所做的是创建一个客户用户控件，在你的情况下，它将由一个组合框组成，其中填充了加载的产品，以及所有相关的控件，这些控件将被填充组合框的`selectedindexchanged`事件。在您要显示此信息的主窗体上放置一个面板并将您的自定义用户控件添加到`panels.controls`集合中。

由于所有功能基本上都包含在用户控件本身中，因此您不应该遇到命名问题。

至于在用户进行选择时添加用户控件，您可以使控件变暗`withevents`并将自定义事件附加到用户控件并在主窗体中进行处理。由于将在运行时添加控件，因此您需要使用`AddHandler`调用附加事件处理程序。

所以要分解它，你需要：

1.  一个自定义用户控件，其中包含您想要的每个产品的所有控件以及后面代码中的 ID
2.  自定义用户控件上的一个事件，用于告诉主窗体组合框具有选定值
3.  主窗体上用于保存自定义用户控件的面板
4.  当在组合框中进行选择时，将新的客户用户控件添加到面板的事件处理程序。

如果您想使用相同的按钮与某个产品进行交互，您可以在用户控件后面的代码中附加一个 ID，并在每次添加新用户控件时进行设置。这并不难，我认为我说得好听，您实际上可以在面板控件集合上运行 linq 并获取满足您指定的任何条件的所有面板，然后从那里做您想做的事情。

至于你的第二个问题，我假设你的用户控件正在从某个地方拉一个虚假的连接字符串。我会尝试追踪发生这种情况的地方并从那里开始。除此之外的任何东西都只是 WAG，并不能真正帮助你。

# bash - 在bash中删除回声线

> ID：10321230
> 
> 赞同：0
> 
> 时间：2012-04-25T18:03:35.193
> 
> 标签：bash, replace, echo

```
var=ab
echo -n "$var" 
```

输出：`ab`

```
var=abc
echo "$var" 
```

输出：`ababc`

我想删除第一个`ab`并将其替换为`abc`

我该怎么做？

问候， intelinside

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-25T18:13:43.497

也许您正在寻找类似的东西：

```
var=ab
echo -n "$var"
var=abc
echo -e "\r$var" 
```

这实际上并没有删除任何内容，而只是将光标移动到行首并覆盖。如果正在写入的文本太短，之前写入的内容仍然可见。您可以在旧文本上写空格（非常简单且可移植）：

```
printf "\r%-${COLUMNS}s" "$var" 
```

或使用一些终端转义序列来删除旧文本（不可移植）：

```
echo -e "\r$var\033[K" 
```

移动到行首，写入新文本，然后从光标处删除到行尾。（这可能不起作用，具体取决于终端。）

# php - 接收和发送 XML PHP

> ID：10321238
> 
> 赞同：0
> 
> 时间：2012-04-25T18:04:00.667
> 
> 标签：php, xml

我通过 CURL 接收 XML：`$retValue = curl_exec($ch);` 我想用 XML 发送到 JavaScript

我尝试`echo $retValue`但它不是 XML

如何从 PHP 将 XML 发送到 JavaScript？

# c# - 将一列从一个数据集中添加到另一个

> ID：10321239
> 
> 赞同：0
> 
> 时间：2012-04-25T18:04:04.757
> 
> 标签：c#, asp.net, linq, ado.net, datatable

有一个数据集 Ds1 和数据集 Ds2 ，DS1 有 Product_ID，产品信息，ds2 有 Product_ID，product_type。

对于匹配的 product_id，我想将 Product_tye 列从 ds2 添加到 ds1 。

注意：product_id不是ds 1中的主键，结果集中有很多product_id相同的产品。在 ds 2 中，product_id 是唯一的。此外，这些数据表来自不同服务器上的两个不同数据库并且具有不同的凭据，因此不能使用 sql 连接。

我尝试使用 linq 来实现这一点，但没有得到所需的输出，如果我遗漏了什么，请纠正我。

```
DataTable dt1 = new DataTable();
DataTable dt2 = new DataTable();
//After both the datatble has values, using linq to add datatble columsn, 

DataTable result = (from t1 in dt1.AsEnumerable()
                            join t2 in dt2.AsEnumerable() on t1.Field<string>("productID") equals t2.Field<string>("productID")
                            select t1).CopyToDataTable(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T18:35:26.043

我刚刚为您创建了一个简单的示例，您需要做的是使用您自己的代码从我的代码中更改列名：

```
 DataTable table1 = new DataTable();
        DataTable table2 = new DataTable();
        table1.Columns.Add("id", typeof(int));
        table1.Columns.Add("name", typeof(string));
        table2.Columns.Add("id", typeof(int));
        table2.Columns.Add("age", typeof(int));

        table1.Rows.Add(1, "mitja");
        table1.Rows.Add(2, "sandra");
        table1.Rows.Add(3, "nataška");

        table2.Rows.Add(1, 31);
        table2.Rows.Add(3, 24);
        table2.Rows.Add(4, 46);

        DataTable targetTable = table1.Clone();
        //create new column
        targetTable.Columns.Add("age");

        var results = from t1 in table1.AsEnumerable()
                      join t2 in table2.AsEnumerable() on t1.Field<int>("id") equals t2.Field<int>("id")
                      select new
                      {
                          ID = (int)t1["id"],
                          NAME = (string)t1["name"],
                          AGE = (int)t2["age"]
                      };

        foreach (var item in results)
            targetTable.Rows.Add(item.ID, item.NAME, item.AGE); 
```

无论如何都要小心定义变量的类型（int，string，...）！！！希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:35:29.677

选择两个表

```
DataTable result = (from t1 in dt1.AsEnumerable()
                        join t2 in dt2.AsEnumerable() on t1.Field<string>("productID")  
                                     equals t2.Field<string>("productID")
                        select new {t1,t2}
                    ).CopyToDataTable(); 
```

或选择选定的列

```
DataTable result = (from t1 in dt1.AsEnumerable()
                        join t2 in dt2.AsEnumerable() on t1.Field<string>("productID") 
                                      equals t2.Field<string>("productID")
                        select new {
                         productId = t1.productID, 
                         col2 = t1.col2,...,
                         productType = t2.pruductType
                    ).CopyToDataTable(); 
```

注意：我认为 productID 类型应该是`int`type 所以`string`在这种情况下用 int替换

# python - 无法使用 NDB get_by_id 获取命名空间中的实体

> ID：10321244
> 
> 赞同：2
> 
> 时间：2012-04-25T18:04:29.630
> 
> 标签：python, google-app-engine, app-engine-ndb

我想在当前命名空间之外阅读如下内容：

```
some_entity = MyModel.get_by_id(some_id_name, namespace='somenamespace') 
```

但 get_by_id 不将命名空间作为参数。我得到：

```
TypeError: Unknown configuration option ('namespace') 
```

我有一些事情要做：

```
some_entity = ndb.Key(MyModel, some_id_name, namespace='somenamespace').get() 
```

所以现在我只是在抱怨，但我认为其他人可以从中受益。:) 此外，由于 Guido 监控这一点，是否有理由不允许 get_by_id 中的命名空间选项？

**编辑：** [这现在可以在 App Engine 1.7.0 中实现。](http://hilinkit.appspot.com/ye4cmq)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T16:32:10.580

请在 NDB 问题跟踪器中提交功能请求：[http ://code.google.com/p/appengine-ndb-experiment/issues/list](http://code.google.com/p/appengine-ndb-experiment/issues/list)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:26:00.393

你可以先改变命名空间，然后你得到实体 by_id

```
from google.appengine.api import namespace_manager

namespace_manager.set_namespace('thenamespace')
MyModel.get_by_id(some_id_name) 
```

# matlab - 读取包含数字数据和单词 Matlab 的 .txt 文件

> ID：10321245
> 
> 赞同：0
> 
> 时间：2012-04-25T18:04:33.897
> 
> 标签：matlab, file-io

我想用数据和单词在matlab中读取.txt文件，.txt文件的内容是

```
(title "Particle Tracks")
(labels "Time" "Particle Velocity Magnitude")

((xy/key/label "particle-1")
1e-06   45.4551
2e-06   40.3895
2e-06   44.0437
3e-06   34.9606
4e-06   33.1695
4e-06   35.3499
5e-06   29.9504
6e-06   28.0226
6e-06   35.1794
7e-06   41.2255
....

((xy/key/label "particle-2")
1e-06   43.7789
1e-06   45.0513
2e-06   44.1221
3e-06   37.8328
3e-06   43.6451
4e-06   29.1166
5e-06   41.3342
6e-06   28.7241
6e-06   36.3779
7e-06   31.9631
8e-06   29.2826
9e-06   24.7755
9e-06   24.9516
1e-05   22.7528
1e-05   26.6802
1.1e-05 34.4668 
```

该文件扩展为 100 个粒子，第一列是时间，第二列是速度我打算在第 1 列的不同时间找到所有粒子的平均速度，所以基本上我想添加相应的第 2 列值并将它们除以百和显示对所有一百个粒子都相同的第 1 列值！[在此处输入图像描述][2]

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T19:37:53.930

读取具有此类复杂结构的文本数据的最佳方法是使用`fscanf`MATLAB 中的函数。按照文档，您应该能够将数据读入一个数组，您可以使用该数组来计算您希望查找的统计信息。

另一种选择可能是逐行读取数据并使用正则表达式和`regexpi`函数来提取您需要的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T22:56:00.210

假设你的输入文件是`input.txt`，那么使用[`textscan`](http://www.mathworks.com/help/techdoc/ref/textscan.html)如下：

```
fid = fopen('input.txt');
C = textscan(fid, '%n %n', 'commentStyle', '(');
a = C{1};
b = C{2};,

%# do your computations on vectors a and b

%# for example: 
ma = mean(a)
mb = mean(b) 
```

您可以根据需要使用向量，例如，您可以处理 100 x 100 个元素。这取决于你。

# c# - 编译程序时出现此错误。运算符“+”不能应用于“System.Random”和“System.Random”的操作数

> ID：10321246
> 
> 赞同：1
> 
> 时间：2012-04-25T18:04:36.240
> 
> 标签：c#, mono, operators, monodevelop, xamarin.android

我正在尝试为数学问题生成随机数。编译程序时，错误运算符“+”不能应用于“System.Random”和“System.Random”类型的操作数。我真的不知道如何解决这个错误。

```
 Random num1 = new Random(0);                
            Random num2 =new Random(0); 
            int rand; 

            Console.Write("What is");
            Console.Write(num1);
            Console.Write( " - ");
            Console.Write( num2);
            Console.Write( "?");
            int answer = Console.Read();

                    if (num1 + num2 == answer) ERROR {
                    Console.Write(" Your are Correct!\n");
                    correctCount++;

                }
                    else
                    Console.Write( "Your answer is wrong" );
                    Console.Write(num1);
                    Console.Write(" + ");
                    Console.Write(num2);
                    Console.Write("should be ");
                    Console.Write(num1 + num2); ERROR
                    count++;
                }
            }

            }
        } 
```

现在我能够编译程序而没有任何错误，但它没有生成任何数字。有谁看到我可能错了。

```
 using System;
               using System.Collections.Generic;
               using System.Linq;
               using System.Text;

               using Android.App;
               using Android.Content;
               using Android.OS;
               using Android.Runtime;
               using Android.Views;
               using Android.Widget;
             namespace Jagtutor
             {

[Activity(Label = "Addition")]
public class AdditionsActivity : Activity
{
    protected override void OnCreate(Bundle bundle)
    {
        base.OnCreate(bundle);
        // Create your application here
        SetContentView(Resource.Layout.Second);

        var label = FindViewById<TextView>(Resource.Id.screen3Label);
        label.Text = Intent.GetStringExtra("ModuleData") ?? "Data not available";

        {
        int correctCount = 0;
        int count = 0;

             while (count < 10);
            {
                Random gen = new Random();
                int num1 = gen.Next();
                int num2 = gen.Next(); 

            Console.Write("What is");
            Console.Write(num1);
            Console.Write( " - ");
            Console.Write( num2);
            Console.Write( "?");
            int answer = Int32.Parse(Console.ReadLine());

                    if (num1 + num2 == answer) {
                    Console.Write(" Your are Correct!\n");
                    correctCount++;

                }
                    else
                    Console.Write( "Your answer is wrong" );
                    Console.Write(num1);
                    Console.Write(" + ");
                    Console.Write(num2);
                    Console.Write("should be ");
                    Console.Write(num1 + num2);
                    count++;
                }
            }

            }
        } 
```

}

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-25T18:07:58.100

你误解了使用的方式`Random`：它不是一个*数字*，它是一个可以用来*生成随机数*的类。

尝试这个：

```
// Make a generator
Random gen = new Random();
// Now we can use our generator to make new random numbers like this:
int num1 = gen.Next();       
int num2 = gen.Next(); 
```

每次打电话`gen.Next()`都会得到一个新的随机数。如果您希望随机数序列是可重复的，请将一个数字（任何数字）传递给`Random`. 请注意，每次运行程序时，结果都将保持不变。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-25T18:41:58.467

您粘贴的代码段存在很多问题。我建议（如果您还没有的话）投资一本不错的入门 C# 书籍。事实上，生成随机数是这类书籍中最受欢迎的“示例程序”之一。但是，为了让您开始，这里有一些关键点：

1.  当您将示例代码粘贴到这样的站点时，请确保它是一个[简短、独立、***正确***的示例](http://sscce.org/)。即使我们修复了您代码中的编译器错误，它也存在其他几个问题，包括不平衡和/或缺少大括号。从简单开始并构建您的示例，直到出现错误，然后粘贴该代码。请注意，在 75% 的情况下，这将帮助您自己修复错误。例如，如果您删除了未编译的代码行，并且只运行了第一部分，它将打印出`"What is System.Random - System.Random?"`，这应该让您非常清楚地知道您的`num1`和`num2`不是您认为的那样。

2.  正如此处的其他答案所指出的那样，您对 C#[`Random`](http://msdn.microsoft.com/en-us/library/system.random.aspx)类的工作方式有一个基本的误解。（不要感觉不好，计算机生成的“随机数”对任何人都没有意义，直到有人向您解释它们。）这些答案中提供的解决方案是正确的：`Random`是一个随机数*生成器*，您需要调用其中一个`Next`实例上的函数以从中获取整数。此外，您通常不需要多个实例，`Random`除非您实际上想要多次生成相同的随机序列。MSDN 文章有一个非常详尽的示例。

3.  虽然本身没有“错误”，但您的控制台输出效率并不高。Console 的读写功能完全对`string`对象进行操作，并且它们具有内置的[复合格式化](http://msdn.microsoft.com/en-us/library/txafckwd.aspx)功能。例如，您的前几行代码可以重写为：

    ```
    var random = new Random();
    var x = random.Next();
    var y = random.Next();

    Console.Write("What is {0} + {1}? ", x, y); 
    ```

4.  正如我在评论中提到的，`Console.Read()`阅读完整的用户输入不是正确的功能；它一次返回一个 UTF-16 字符的数据。例如，如果用户输入`150`您将按顺序得到 49、53 和 48。由于您可能希望允许用户一次输入多个数字，因此您应该调用`Console.ReadLine()`，它返回整个字符串，然后使用`Int32.Parse()`或一些类似的函数将其转换为整数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-25T18:08:06.753

您正在尝试添加两个随机生成器而不是随机数，请使用以下命令：

```
Random randomGenerator = new Random(0);

var num1 = randomGenerator.Next();
var num2 = randomGenerator.Next(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-25T18:08:55.603

您需要调用 Random.Next() [http://msdn.microsoft.com/en-us/library/9b3ta19y.aspx](http://msdn.microsoft.com/en-us/library/9b3ta19y.aspx)的重载之一来获取实际的随机数。

# algorithm - scala中的合并排序

> ID：10321252
> 
> 赞同：1
> 
> 时间：2012-04-25T18:05:02.027
> 
> 标签：algorithm, scala, sorting, recursion, mergesort

我遇到了另一个我试图在 Scala 中解决的[codechef 问题。](http://www.codechef.com/problems/INSOMA3)问题陈述如下：

> Stepford Street是一条死胡同。Stepford Street 上的房子被富有的百万富翁买下。他们对它们进行了广泛的改造，以便随着沿街的推进，建筑物的高度迅速增加。然而，并非所有的百万富翁都是生来平等的。一些人拒绝跟随这一趋势，并将他们的房屋保持在原来的高度。因此，由此产生的高度进展受到干扰。比佛利山庄市政公司宣布了一场寻找最有序街道的竞赛。最有序街道的标准设置如下：如果街道中存在比所考虑的房子高度低的房子，那么这对（当前房子，后来的房子）计入 1 分的无序度指数街道。后面的房子不必与现在的房子相邻。注意：一条街道上没有两栋房子的高度相同 例如，对于输入：1 2 4 5 3 6 对 (4,3), (5,3) 形成无序对。因此该数组的无序度指数为 2。由于确定无序度的标准很复杂，BHMC 已请求您帮助自动化该过程。你需要编写一个高效的程序来计算街道的无序度指数。

提供的示例输入输出如下：

> 输入：1 2 4 5 3 6
> 
> 输出：2

输出为 2 因为有两对 (4,3) 和 (5,3)

为了解决这个问题，我认为我应该使用 MergeSort 的变体，当左元素大于右元素时递增 1。

我的scala代码如下：

```
 def dysfunctionCalc(input:List[Int]):Int = {
        val leftHalf = input.size/2
        println("HalfSize:"+leftHalf)

        val isOdd = input.size%2
        println("Is odd:"+isOdd)

        val leftList = input.take(leftHalf+isOdd)
        println("LeftList:"+leftList)

        val rightList = input.drop(leftHalf+isOdd)
        println("RightList:"+rightList)

        if ((leftList.size <= 1) && (rightList.size <= 1)){
                println("Entering input where both lists are <= 1")
                             if(leftList.size == 0 || rightList.size == 0){
                                      println("One of the lists is less than 0")
                                        0
                                }
                             else if(leftList.head > rightList.head)1 else 0
     }       
     else{
             println("Both lists are greater than 1")
             dysfunctionCalc(leftList) + dysfunctionCalc(rightList)
     }
   } 
```

首先，我的逻辑是错误的，它没有合并阶段，我不确定将基本情况的结果渗透到堆栈中并将其与其他值进行比较的最佳方法是什么。此外，使用递归来解决这个问题可能不是最好的方法，因为对于大型列表，我可能会炸毁堆栈。此外，我的代码也可能存在风格问题。

如果有人能指出其他缺陷和解决这个问题的正确方法，我会很棒。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T19:13:53.247

这是我的尝试，我不使用 MergeSort 但它似乎解决了问题：

```
def calcDisorderness(myList:List[Int]):Int = myList match{
  case Nil => 0
  case t::q => q.count(_<t) + calcDisorderness(q)
} 
```

> scala> val 输入 = List(1,2,4,5,3,6)
> 
> 输入：List[Int] = List(1, 2, 4, 5, 3, 6)
> 
> scala> calcDisorderness（输入）
> 
> res1: 整数 = 2

问题是，有没有办法降低复杂性？

**编辑：**相同函数的尾递归版本和函数参数中默认值的酷用法。

```
def calcDisorderness(myList:List[Int], disorder:Int=0):Int = myList match{
  case Nil => disorder
  case t::q => calcDisorderness(q, disorder + q.count(_<t))
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T00:51:23.773

假设您将列表分成三部分：您正在考虑的项目、左侧的项目和右侧的项目。进一步假设左边的那些在一个排序集中。现在你只需要遍历列表，将项目从“右”移动到“考虑”，从“考虑”到“左”；在每一点上，您都会查看大于您的项目的排序集子集的大小。一般来说，大小查找可以`O(log(N))`在 add-element 中完成（例如，使用 Red-Black 或 AVL 树）。所以你有`O(N log N)`表现。

现在的问题是如何在 Scala 中有效地实现这一点。事实证明，Scala 有一个用于其排序集的红黑树`TreeSet`，并且实现实际上非常简单（这里是尾递归形式）：

```
import collection.immutable.TreeSet
final def calcDisorder(xs: List[Int], left: TreeSet[Int] = TreeSet.empty, n: Int = 0): Int = xs match {
  case Nil => n
  case x :: rest => calcDisorder(rest, left + x, n + left.from(x).size)
} 
```

不幸的是，这`left.from(x).size`需要`O(N)`时间（我相信），这会产生二次执行时间。那不好-您需要的是`IndexedTreeSet`可以在其中执行`indexOf(x)`的操作`O(log(n))`（然后使用 迭代`n + left.size - left.indexOf(x) - 1`）。您可以构建自己的实现或在网络上找到一个。例如，我在[此处](http://people.csail.mit.edu/milch/blog/software.html)（[此处为 API](http://people.csail.mit.edu/milch/blog/apidocs/common/IndexedTreeSet.html)）找到了一个完全正确的 Java。

顺便说一句，进行归并排序的问题在于您不能轻松地累积工作。通过合并一对，您可以跟踪它的无序程度。但是，当您合并第三个列表时，您必须看到它*相对于其他两个列表*的乱序程度，这会破坏您的分而治之的策略。（我不确定是否可以找到一些不变量，如果您跟踪它，可以让您直接计算。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-22T19:29:51.667

基于合并排序的解决方案。不是超级快，潜在的减速可能在“xs.length”中。

```
def countSwaps(a: Array[Int]): Long = {
    var disorder: Long = 0

    def msort(xs: List[Int]): List[Int] = { 
        import Stream._
        def merge(left: List[Int], right: List[Int], inc: Int): Stream[Int] = {
            (left, right) match {
                case (x :: xs, y :: ys) if x > y =>
                    cons(y, merge(left, ys, inc + 1))
                case (x :: xs, _) => {
                    disorder += inc
                    cons(x, merge(xs, right, inc))
                }
                case _ => right.toStream
            }
        }

        val n = xs.length / 2 
        if (n == 0)
            xs 
        else { 
            val (ys, zs) = xs splitAt n 
            merge(msort(ys), msort(zs), 0).toList
        } 
    }

    msort(a.toList)
    disorder
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-24T22:48:41.090

另一种基于合并排序的解决方案。非常快：没有 FP 或 for 循环。

```
def countSwaps(a: Array[Int]): Count = {
    var swaps: Count = 0

    def mergeRun(begin: Int, run_len: Int, src: Array[Int], dst: Array[Int]) = {
        var li = begin
        val lend = math.min(begin + run_len, src.length)
        var ri = begin + run_len
        val rend = math.min(begin + run_len * 2, src.length)

        var ti = begin
        while (ti < rend) {
            if (ri >= rend) {
                dst(ti) = src(li); li += 1
                swaps += ri - begin - run_len
            } else if (li >= lend) {
                dst(ti) = src(ri); ri += 1
            } else if (a(li) <= a(ri)) {
                dst(ti) = src(li); li += 1
                swaps += ri - begin - run_len
            } else {
                dst(ti) = src(ri); ri += 1
            }
            ti += 1
        }
    }

    val b = new Array[Int](a.length)
    var run = 0
    var run_len = 1
    while (run_len < a.length) {
        var begin = 0
        while (begin < a.length) {
            val (src, dst) = if (run % 2 == 0) (a, b) else (b, a)
            mergeRun(begin, run_len, src, dst)
            begin += run_len * 2
        }
        run += 1
        run_len *= 2
    }

    swaps
} 
```

将上面的代码转换为函数式：没有可变变量，没有循环。所有递归都是尾调用，因此性能良好。

```
def countSwaps(a: Array[Int]): Count = {
    def mergeRun(li: Int, lend: Int, rb: Int, ri: Int, rend: Int, di: Int, src: Array[Int], dst: Array[Int], swaps: Count): Count = {
        if (ri >= rend && li >= lend) {
            swaps
        } else if (ri >= rend) {
            dst(di) = src(li)
            mergeRun(li + 1, lend, rb, ri, rend, di + 1, src, dst, ri - rb + swaps)
        } else if (li >= lend) {
            dst(di) = src(ri)
            mergeRun(li, lend, rb, ri + 1, rend, di + 1, src, dst, swaps)
        } else if (src(li) <= src(ri)) {
            dst(di) = src(li)
            mergeRun(li + 1, lend, rb, ri, rend, di + 1, src, dst, ri - rb + swaps)
        } else {
            dst(di) = src(ri)
            mergeRun(li, lend, rb, ri + 1, rend, di + 1, src, dst, swaps)
        }
    }

    val b = new Array[Int](a.length)

    def merge(run: Int, run_len: Int, lb: Int, swaps: Count): Count = {
        if (run_len >= a.length) {
            swaps
        } else if (lb >= a.length) {
            merge(run + 1, run_len * 2, 0, swaps)
        } else {
            val lend = math.min(lb + run_len, a.length)
            val rb = lb + run_len
            val rend = math.min(rb + run_len, a.length)
            val (src, dst) = if (run % 2 == 0) (a, b) else (b, a)
            val inc_swaps = mergeRun(lb, lend, rb, rb, rend, lb, src, dst, 0)
            merge(run, run_len, lb + run_len * 2, inc_swaps + swaps)
        }
    }

    merge(0, 1, 0, 0)
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-25T18:23:27.827

在我看来，关键是将列表分解为一系列升序。例如，您的示例将分解为 (1 2 4 5)(3 6)。第一个列表中的任何项目都不能结束一对。现在你对这两个列表进行一种合并，向后工作：

*   6 > 5，所以 6 不能成对
*   3 < 5，所以它是一对
*   3 < 4，所以它是一对
*   3 > 2，所以我们完成了

从定义中我不清楚如何处理超过 2 个这样的序列。

# ios - videoMaximumDuration 不限制持续时间

> ID：10321254
> 
> 赞同：4
> 
> 时间：2012-04-25T18:05:06.650
> 
> 标签：ios, objective-c, video, uiimagepickercontroller

我希望用户从他的库中选择一个视频并将其限制为 45 秒（如 WhatsApp - 您可以编辑视频，并且将发送的视频不超过 45 秒。

但是如果我使用下面的代码，它会选择一个视频而不考虑持续时间，我不能修剪它（用视频测试，长度为 1 分钟）

```
UIImagePickerController *imagePickerController = [[UIImagePickerController alloc] init];
        imagePickerController.delegate = self; 
        imagePickerController.sourceType = UIImagePickerControllerSourceTypePhotoLibrary;
        imagePickerController.videoQuality = UIImagePickerControllerQualityTypeLow;
        imagePickerController.videoMaximumDuration = 45.0f; //?
        imagePickerController.mediaTypes = [UIImagePickerController availableMediaTypesForSourceType:UIImagePickerControllerSourceTypePhotoLibrary];

        [[self parentViewController] presentModalViewController:imagePickerController animated:YES];
        [imagePickerController release]; 
```

在 WhatsApp 中，我得到以下屏幕，我想重现该屏幕： ![在此处输入图像描述](../Images/2b23ed591996af5afcc143f22f061795.png)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-09T16:54:46.563

确保在呈现控制器之前将allowEditing 设置为YES。

imagePickerController.allowsEditing = YES;

# c# - 盲目调用公共方法（C#）

> ID：10321258
> 
> 赞同：0
> 
> 时间：2012-04-25T18:05:18.863
> 
> 标签：c#, asp.net, public-method

好吧，奇怪的一个。我有许多带有转发器的用户控件，所有控件中转发器的布局都是相同的，并且它们都有一个`bindData()`公开可用的方法。

我想知道，我可以为分页设置另一个用户控件而不必指定父控件吗？

我能够做到以下几点：

```
((controls.specificuserControlClass)Parent).bindData(); 
```

这一切都很好 - 但是`specificuserControlClass`如果你明白我的意思，我需要在寻呼机中指定它，然后“每个中继器”都需要它？

`Parent.bindData()`那么我可以从子控件中盲目调用吗？我“知道”该方法存在（或会构建检查以确保），但是 Visual Studio 并不高兴，因为它不知道该方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-25T18:06:53.310

为什么不让你的控件都实现一个特定的接口呢？

```
 public interface IBindData
 {
      void bindData();
 } 
```

然后，您只需执行以下操作：

```
((IBindData)Parent).bindData() 
```

它应该适当地调用每个控件的方法。

# mediawiki - 如何在 MediaWiki 中创建一个模板来自动填充其自身的一部分？

> ID：10321260
> 
> 赞同：1
> 
> 时间：2012-04-25T18:05:27.913
> 
> 标签：mediawiki

基本上我想做的是创建一个模板，当嵌入到维基页面时，它会自动填写您当前正在阅读的页面标题的一部分。

例如，如果您正在阅读标题为 ExchangeServer 的页面。该页面中将包含一个模板，该模板将包含一个链接到服务的 URL。

该 URL 的一部分包括该 wiki 页面的名称。所以我希望它是这样的：

https://*自动填充名称*：1311

有没有办法做到这一点？如果是这样，有人可以解释一下吗？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T18:29:55.983

你在寻找[神奇](http://www.mediawiki.org/wiki/Help%3aMagic_words#Page_names)[的`{{PAGENAME}}`](http://www.mediawiki.org/wiki/Help%3aMagic_words#Page_names)词吗？

# php - PHP警告getimagesize

> ID：10321263
> 
> 赞同：1
> 
> 时间：2012-04-25T18:05:52.380
> 
> 标签：php, warnings

尝试将图像上传到服务器时出现这些错误

> 警告：getimagesize（../images/image-1Product 320120312100APPLE_IMG_0072.jpg）[function.getimagesize]：无法打开流：/home/content/44/8713044/html/admin/Home.php 中没有这样的文件或目录第 107 行
> 
> 警告：imagecreatefromjpeg（../images/image-1Product 320120312100APPLE_IMG_0072.jpg）[function.imagecreatefromjpeg]：无法打开流：/home/content/44/8713044/html/admin/Home.php 中没有这样的文件或目录第 122 行
> 
> 警告：imagecopyresampled()：提供的参数不是第 128 行 /home/content/44/8713044/html/admin/Home.php 中的有效图像资源

我知道为什么我会因为第一个和第二个错误而收到第三个错误，我不知道为什么我会收到 1 和 2 的警告，该文件夹确实存在。

> 107 号线 -`$size = getimagesize($source);`
> 
> 第 122 行 -`$image = imagecreatefromjpeg($source);`
> 
> 128号线——`imagecopyresampled($new_image,$image,0,0,$x,$y,$thumb_width,$thumb_width,$width,$height);`

如果有人有任何提示，将不胜感激。

我将其更改为完整路径，但出现此错误`URL file-access is disabled in the server configuration`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-10-29T23:33:27.007

这个问题通常通过重新配置 php.ini 来解决

```
allow_url_fopen = On 
```

为此，您可能需要联系您的托管服务提供商。

如果您使用的是 Wordpress 或任何其他 CMS，它可能会由于安装了安全插件而准确。大多数安全插件会更改 .htaccess 以防止未经授权访问 url、目录和文件。

检查您的 .htaccess 并搜索

```
RewriteRule ^.* - [F,L] 
```

如果找到它，请将其删除 (#RewriteRule ^.* - [F,L]) 并检查它是否解决了您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:11:05.883

尝试从文件名中删除空格。我曾经遇到过这样的问题，我相信删除空间可以解决它。

改变：

```
image-1Product 320120312100APPLE_IMG_0072.jpg) 
```

到：

```
image-1Product320120312100APPLE_IMG_0072.jpg) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T18:16:07.813

您的 $source 变量指向错误的路径..
如果您在包含此代码的其他文件夹中包含一个 php 文件，请尝试使用这样的本地路径：

```
$source='images/image-1Product 320120312100APPLE_IMG_0072.jpg';
$size = getimagesize($source); 
```

如果您的图像文件夹位于根目录中，则不要使用“../”，即第一个文件在那里。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-25T18:08:42.443

1.  尝试输入完整的 url 以路由到图像含义包括 http://
2.  检查您对文件夹的权利含义：权利 777

# facebook-social-plugins - “Facebook Public Profile”而不是 LikeBox 中的 app-Name

> ID：10321265
> 
> 赞同：1
> 
> 时间：2012-04-25T18:06:20.830
> 
> 标签：facebook-social-plugins, facebook-likebox

几天后，我的应用程序的“喜欢”框的顶部出现了文本字符串“Facebook Public Profile”，而不是我的应用程序的名称——该框本身是空的，只是说我喜欢这个网站。

这是like框的iframe代码：

```
<iframe src="http://www.facebook.com/plugins/likebox.php?id=144416678913418&amp;width=292&amp;colorscheme=light&amp;show_faces=true&amp;stream=false&amp;header=true&amp;height=327" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:292px; height:427px;" allowTransparency="true"></iframe> 
```

当我在[http://developers.facebook.com/docs/reference/plugins/like-box/](http://developers.facebook.com/docs/reference/plugins/like-box/)上创建一个新框时，会创建正确的框，但我没有任何喜欢。旧盒子上有1000多个赞，如果都丢失了，那将是令人沮丧的。那我能做什么？

点赞框适用的应用：[politicaltest](http://apps.facebook.com/politicaltest)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T15:21:01.017

正如 Fideri 所提到的 - 使用 HTTPS 协议而不是 HTTP 解决了这个问题。另一件需要注意的事情 - 区分大小写。[https://www.facebook.com/heiaheiaheia](https://www.facebook.com/heiaheiaheia) - 有效，[https://www.facebook.com/HeiaHeiaHeia](https://www.facebook.com/HeiaHeiaHeia) - 无效。

Facebook 上有一个关于此的错误：[https ://developers.facebook.com/bugs/294214537324996?browse=search_4fa3f2c98bbef5d13178743](https://developers.facebook.com/bugs/294214537324996?browse=search_4fa3f2c98bbef5d13178743)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T23:38:04.200

I had the same problem. Using a secure URL (https//www.facebook.com/mypage) solved the problem.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T16:30:59.990

我找到了另一个解决方案。事实证明，我们已经将我们的 fb 页面的年龄限制设置为 18 岁或以上。当我们取消年龄限制时，like box 开始工作了。

# php - jquery post on document ready

> ID：10321270
> 
> 赞同：0
> 
> 时间：2012-04-25T18:06:54.587
> 
> 标签：php, javascript, jquery

我想要的是，数据将传递到这个 php 文件：check.php，当页面准备好时，这个 php 文件将数据传递到该函数。这只是一个过期。

好的，我有这个代码：

```
$(document).ready(function() {
    $.post("check.php", {
        name: "log"
    }, function(data) {
        if (data === "yes") {
            alert('has been login');
        } else {
            alert('has not login');
        }
    });
});​ 
```

我有这个 php 代码（“check.php”），jquery 帖子会将数据传递到其中。​</p>

```
<? //check
$chk = $_POST['name'];

if (isset($chk === "log")) {
    if (isset($_COOKIE['admin'])) {
        if ($_COOKIE['admin'] === "login") {
            echo "yes";
        }
    } else {
        echo "no";
    }
} else {
    echo "no";
}
?> 
```

但什么也没发生，即使我将 check.php 中的整个代码更改为：“echo “yes”；” 我猜没有任何反应，要么没有数据接收，要么没有数据通过。希望有人可以帮助我解决这个我坚持的简单而可爱的问题。先感谢您

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T18:17:24.293

我想你错过了一个右括号。这只是按预期工作：

```
 $.post('check.php', { name: 'log' }, function(data) { 
     if (data === "yes") 
      { 
         alert ('has been login'); 
       } 
       else 
     { 
     alert ('has not login'); 
     } 
  }); 
```

运行这个 JSFiddle [http://jsfiddle.net/S53k5/](http://jsfiddle.net/S53k5/) ，你会在 Fiddler 中看到调用经过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-08T16:11:01.723

我猜这是因为您使用的是标题“名称”，这是一个保留关键字。

# sql - 数据库占用的空间比表的总和还要多

> ID：10321271
> 
> 赞同：3
> 
> 时间：2012-04-25T18:07:04.947
> 
> 标签：sql, sql-server

我有一个占用近 7 个演出的数据库。如果我查看表的使用情况，它应该比这要少得多，比如 40 兆。我昨天删除了一个很大的日志表，但是我的数据库仍然说它很大。

以下是统计数据：

```
database_name   database_size   unallocated space
Umbraco_Indoorpower 6911.56 MB  859.59 MB

reserved    data    index_size  unused
31144 KB    26272 KB    3240 KB 1632 KB 
```

我跑了这个：

```
DBCC SHRINKDATABASE (umbraco_indoorpower, 99); 
```

这让我的数据库降到了 2.3 个演出。不过，还是太大了。

```
database_name   database_size   unallocated space
Umbraco_Indoorpower 2302.44 MB  1.63 MB

reserved    data    index_size  unused
30016 KB    26200 KB    3240 KB 576 KB 
```

我猜我并没有从我昨天删除的那个日志表中释放所有空间。我实际跑了`delete from tblLog`。也许这是错误的做法。

有谁知道我怎样才能腾出更多空间？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-25T18:38:59.060

日志文件有多大？你的恢复模式是什么？上面的数字很可能`database_size`是将近 7 GB 的日志和非常少的数据。查找硬盘驱动器上的文件 - 您可以使用以下命令查找路径：

```
EXEC umbraco_indoorpower..sp_helpfile; 
```

我敢打赌 LDF***很大***，而 MDF 实际上很小。在这种情况下，您可能处于完全恢复模式并且从未进行过日志备份。如果这是真的，那么你可以这样做：

```
USE umbraco_indoorpower;
GO
BACKUP LOG umbraco_indoorpower TO DISK = 'C:\some_path\umbraco.trn';
GO
DBCC SHRINKFILE(umbraco_indoorpower_log, 20); -- guessing on target MB size here 
```

（如果您处于简单恢复模式，上述操作将失败，但会有一些其他解释为什么日志文件很大 - 例如长时间运行或未提交的事务，您的删除提交了吗？）

然后您将需要 (a) 设置适当的维护，包括完整/差异/日志备份，这将有助于优化日志文件的重用，或者 (b) 切换到简单恢复，在这种情况下，日志将自行管理.

在大多数情况下，简单的恢复并不能在发生灾难时提供足够的保护，但这由您决定。

同时，您可以随心所欲地收缩文件，但如果您保持恢复模型和事务处理方式不变，您只会看到文件再次增长，并且明天您将返回运行收缩命令。这对您的文件来说绝对是可怕的。这就是为什么我反对“运行收缩操作”之类的答案。我在这里谈谈为什么：

*   [哦，恐怖！请停止告诉人们他们应该缩小他们的日志文件！](https://sqlblog.org/2009/07/27/oh-the-horror-please-stop-telling-people-they-should-shrink-their-log-files)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T18:39:23.420

[http://www.brentozar.com/archive/2009/08/stop-shrinking-your-database-files-seriously-now/](http://www.brentozar.com/archive/2009/08/stop-shrinking-your-database-files-seriously-now/)

在任何情况下，您都有数据和日志，并且要缩小日志，您必须进行备份。

**编辑：**亚伦[所说的一切](https://stackoverflow.com/a/10321781/18255)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T19:39:42.557

现有的答案已经很不错了。我还有一个额外的解决方案：编写包含数据的数据库脚本（SSMS UI 允许您轻松执行此操作）并在新数据库中执行脚本。

您可能也想切换到简单的日志模型（如果您没有特殊需要使用完整的日志模型）。有一件事是肯定的：您不能在完整模式下运行，也不能进行适当的事务日志管理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-19T04:43:10.693

在 SQL Server 中占用更多空间的另一件事是 Service Broker 队列。就我而言，我有 600 万行队列占用 17GB ......

# coldfusion - 缺少条目时 CFLoop 出错

> ID：10321272
> 
> 赞同：1
> 
> 时间：2012-04-25T18:07:14.610
> 
> 标签：coldfusion, cfloop

我有以下代码。

```
<cfoutput>
<cfxml variable="eating">
<catalog>
<results>10</results>
<food id="bk101">
<initials>BK</initials>
<keywords>Burger King, pie, hamburgers, fries, milkshakes</keywords>
</food>
<food id="bk102">
<initials>TB</initials>
<keywords>Taco Bell, tacos, churros, burrito, gorditas</keywords>
</food>
<food id="bk103">
<keywords>Pizza Hut, pizza, cheese, garlic bread</keywords>
</food>
<food id="bk104">
<initials>CFA</initials>
<keywords>Chick-Fil-A, chicken, chicken wrap, sauce, Bananas Pudding Milkshake</keywords>
</food>
<food id="bk105">
<initials>PE</initials>
<keywords>Panda Express, rice, egg rolls, general tso</keywords>
</food>
<food id="bk106">
<initials>SJ</initials>
<keywords>Sakura Japan, rice, spring rolls, bento</keywords>
</food>
<food id="bk107">
<keywords>Five Guys, fries, burgers, hot dogs</keywords>
</food>
<food id="bk108">
<initials>TN</initials>
<keywords>Tandoori Nights, biryani, chicken, egg rolls</keywords>
</food>
<food id="bk109">
<initials>HoK</initials>
<keywords>House of Kabob, rice, bread, beef kabaob, chicken kabob</keywords>
</food>
<food id="bk110">
<initials>BF</initials>
<keywords>Baja Fresh, quesadilla, soft taco, chili con queso</keywords>
</food>
</catalog>
</cfxml>

<cfset data = queryNew("id,initials,keywords","integer,varchar,varchar")>
<cfloop index="x" from="1" to="#eating.catalog.results.xmlText#">
<cfset queryAddRow(data)>
<cfset querySetCell(data,"id",x)>
<cfset querySetCell(data,"initials","#eating.catalog.food[x].initials#")>
<cfset querySetCell(data,"keywords","#eating.catalog.food[x].keywords#")>
</cfloop>
</cfoutput>

<cfoutput query="data">
#id# - <b>#initials#</b> #keywords#<br />
</cfoutput> 
```

您会注意到 XML 提要中缺少元素 3 和 7 的初始标记。如果将首字母标记添加到元素 3 和 7 的 XML 中，则代码运行良好。然而，由于它们丢失了，这会导致 CFLoop 抛出一个错误。

我想做的是从我的结果中省略元素 3（以及所有其他导致错误的条目）并防止显示任何错误，因此应用程序结果显示如下

1 - BK 汉堡王、馅饼、汉堡包、薯条、奶昔

2 - TB Taco Bell、炸玉米饼、油条、墨西哥卷饼、gorditas

4 - CFA Chick-Fil-A、鸡肉、鸡肉卷、酱汁、香蕉布丁奶昔

5-PE熊猫快递，米饭，蛋卷，左宗棠

6 - SJ Sakura Japan、米饭、春卷、便当

8 - TN Tandoori Nights、biryani、鸡肉、蛋卷

9 - HoK House of Kabob、米饭、面包、牛肉烤肉、鸡肉烤肉

10 - BF Baja Fresh、油炸玉米饼、软炸玉米饼、辣椒酱

上面的提要是一个简化的例子，我的实际提要有数百个元素。考虑到这一点，我怎样才能省略任何给我错误的元素，同时仍然包括那些给我错误的元素？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T19:01:02.623

Mike，我将您的所有代码复制到本地脚本中以运行快速测试。我对您的 CFLOOP 代码进行了一次小的编辑，并且即将获得没有错误的输出（添加了一个条件评估结构以确保密钥与 structKeyExists 一起存在）：

```
<cfloop index="x" from="1" to="#eating.catalog.results.xmlText#">
    <cfif structKeyExists(eating.catalog.food[x],"initials")>
        <cfset queryAddRow(data)>
        <cfset querySetCell(data,"id",x)>
        <cfset querySetCell(data,"initials", eating.catalog.food[x].initials )>
        <cfset querySetCell(data,"keywords", eating.catalog.food[x].keywords )>
    </cfif>
</cfloop> 
```

这是我在浏览器中收到的输出：

1 - BK 汉堡王、馅饼、汉堡包、薯条、奶昔

2 - TB Taco Bell、炸玉米饼、油条、墨西哥卷饼、gorditas

4 - CFA Chick-Fil-A、鸡肉、鸡肉卷、酱汁、香蕉布丁奶昔

5-PE熊猫快递，米饭，蛋卷，左宗棠

6 - SJ Sakura Japan、米饭、春卷、便当

8 - TN Tandoori Nights、biryani、鸡肉、蛋卷

9 - HoK House of Kabob、米饭、面包、牛肉烤肉、鸡肉烤肉

10 - BF Baja Fresh、油炸玉米饼、软炸玉米饼、辣椒酱

# c - libxml2 所有 xml 到 char

> ID：10321274
> 
> 赞同：2
> 
> 时间：2012-04-25T18:07:15.800
> 
> 标签：c, xml, string, libxml2

有没有一种简单的方法可以让我从 libxml2 中的 xmlNode 获取 C char *？我想得到这样的东西：`"<root id="01"><head>some</head><data>information</data></root>"`应该是什么`char *getStringFromXmlNode(xmlNode *node)`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T18:20:52.123

像这样的东西。

```
#include <libxml/parser.h>
#include <libxml/xpath.h>
#include <libxml/tree.h>
#include <string.h>
#include <stdio.h>
#include <stdlib.h>

void* getValueFromXML(xmlDocPtr doc, xmlChar *xpath )
{
    xmlXPathObjectPtr result;
    xmlNodeSetPtr nodeset;
    xmlChar *keyword;
    char *copiedStringPtr;

    // Nodes are
    // parse the xml document and find those nodes that meet the criteria of the xpath.
    result = getnodeset(doc, xpath);

    // if it parsed and found anything
    if (result)
    {
        // get the nodes that matched.
        nodeset = result->nodesetval;
        // go through each Node. There are nodeNr number of nodes.
        // nodeset is the seta of all nodes that met the xpath criteria
        // For the API look here http://xmlsoft.org/html/libxml-xpath.html
        if (nodeset->nodeNr>1)
        {
            printf("Returned more than one value. Fix the xpath\n");
            return NULL;
        }

        keyword = xmlNodeListGetString(doc, nodeset->nodeTab[0]->xmlChildrenNode, 1);
        //printf("keyword: %s\n", keyword);

        copiedStringPtr = strdup((const char *)keyword);

        xmlFree(keyword);
        xmlXPathFreeObject (result);
    }

    return copiedStringPtr;
}

xmlXPathObjectPtr getnodeset (xmlDocPtr doc, xmlChar *xpath)
{

    xmlXPathContextPtr context; //http://xmlsoft.org/html/libxml-xpath.html#xmlXPathContext
    xmlXPathObjectPtr result; // http://xmlsoft.org/html/libxml-xpath.html#xmlXPathObject

    // http://xmlsoft.org/html/libxml-xpath.html#xmlXPathNewContext
    context = xmlXPathNewContext(doc);
    if (context == NULL)
    {
        printf("Error in xmlXPathNewContext\n");
        return NULL;
    }

    //http://xmlsoft.org/html/libxml-xpath.html#xmlXPathEvalExpression
    result = xmlXPathEvalExpression(xpath, context);
    xmlXPathFreeContext(context);
    if (result == NULL)
    {
        printf("Error in xmlXPathEvalExpression\n");
        return NULL;
    }
    if (xmlXPathNodeSetIsEmpty(result->nodesetval))
    {
        xmlXPathFreeObject(result);
        printf("No result\n");
        return NULL;
    }
    return result;
} 
```

至少我认为这就是你要问的。希望能帮助到你。

# jquery - 元素从鼠标下方移出后，悬停状态为粘性（在所有浏览器中）

> ID：10321275
> 
> 赞同：7
> 
> 时间：2012-04-25T18:07:15.850
> 
> 标签：jquery, css, hover

我有一个 div 显示一系列幻灯片，一次一张。它在框的底部包含一个链接，可触发切换到下一张幻灯片。单击链接时，框会显示下一张幻灯片，并且框的高度大部分时间都会发生变化。

我`:hover`对链接应用了一种样式，但是一旦框的高度发生变化并且链接从鼠标下方移出，它就会保持其`:hover`状态，直到它再次悬停。

我试过打电话`.mouseleave()`，`.mouseenter().mouseleave()`在更改完成后，但它没有任何效果。我还为链接创建了一个不同的`:active`&`:focus`状态，当链接被点击时我可以看到一个闪烁的状态，但随后它返回到`:hover`. `:visited`样式也没有效果。

我知道在旧版本的 IE 中存在与此类似的常见错误，但我在 Chrome 和 Firefox 中也看到了这种情况。

这是一个[jsfiddle](http://jsfiddle.net/farneman/j4yA7/18/)。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T15:15:15.227

### *[jsFiddle 演示](http://jsfiddle.net/roXon/j4yA7/20/)*

答案很简单。当我们松开鼠标点击页面跳转显示内容，所以浏览器默认行为。注册 mouseleave 并错过了切换类。

以下是修复：

CSS：

```
a:active, a:selected, a:visited { /*  add his to remove stupid dotted outline */
    border: none;
    outline: none;
} 
```

jQ1：

```
 $('#prev-page').on('mousedown', function (e) { // use mousedown (some issues with chrome)
        e.preventDefault();
        showPage(pages.index($($(this).attr('href')), 600));
    });
    $('#next-page').on('mousedown', function (e) { // here too!
        e.preventDefault();
        showPage(pages.index($($(this).attr('href'))), 600);
    }); 
```

jQ2：

```
pages.hide().eq(active).fadeIn(fadeTime, function () {
    // $('#next-page').trigger('mouseleave'); // remove to fix in FF
}); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-08-06T08:00:00.003

使用 CSS 类切换框高度，并确保您的悬停状态仅存在于该类。

```
.box {
 height: 0;
}

.box span {
 display: none;
}

.box.open {
 height: 400px;
}

.box.open:hover span {
 display: block;
} 
```

# android - Eclipse 中的 Android 4 SDK text.getText() 错误

> ID：10321276
> 
> 赞同：1
> 
> 时间：2012-04-25T18:07:16.607
> 
> 标签：android, eclipse

我一直在考虑为 Android 开发一段时间，我终于冒险了。Eclipse 设置好了，Android SDK 和 ADT Plugin for eclipse 也设置好了。我在网上找到了一个教程，并按照它的说明进行操作。我无法弄清楚的问题是 Eclipse 使用以下代码生成并出错，主要是 text.setText() 和 text.getText() 调用，它强调了它的文本部分：

我错过了进口吗？

```
import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.widget.EditText;
import android.widget.RadioButton;
import android.widget.Toast;

public class testActivity extends Activity {
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
}

// This method is called at button click because we assigned the name to the
// "On Click property" of the button
public void myClickHandler(View view) {
    switch (view.getId()) {
    case R.id.button1:
        RadioButton celsiusButton = (RadioButton) findViewById(R.id.radioButton1);
        RadioButton fahrenheitButton = (RadioButton) findViewById(R.id.radioButton2);
        if (text.getText().length() == 0) {
            Toast.makeText(this, "Please enter a valid number",
                    Toast.LENGTH_LONG).show();
            return;
        }

        float inputValue = Float.parseFloat(text.getText().toString());
        if (celsiusButton.isChecked()) {
            text.setText(String
                    .valueOf(convertFahrenheitToCelsius(inputValue)));
            celsiusButton.setChecked(false);
            fahrenheitButton.setChecked(true);
        } else {
            text.setText(String
                    .valueOf(convertCelsiusToFahrenheit(inputValue)));
            fahrenheitButton.setChecked(false);
            celsiusButton.setChecked(true);
        }
        break;
    }
}

// Converts to celsius
private float convertFahrenheitToCelsius(float fahrenheit) {
    return ((fahrenheit - 32) * 5 / 9);
}

// Converts to fahrenheit
private float convertCelsiusToFahrenheit(float celsius) {
    return ((celsius * 9) / 5) + 32;
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T18:14:47.223

您没有声明 textedit 对象。在您的 onCreate 方法中添加：

```
text = (EditText) findViewById(R.id.editText1); 
```

editText1 可能不同，具体取决于您的 main.xml 布局文件

还要在 onCreate 方法之前添加：

```
private EditText text; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:16:17.393

而不是你的代码使用这个，

```
import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.widget.EditText;
import android.widget.RadioButton;
import android.widget.Toast;

public class ConvertActivity extends Activity {
    private EditText text;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        text = (EditText) findViewById(R.id.editText1);

    }

    // This method is called at button click because we assigned the name to the
    // "On Click property" of the button
    public void myClickHandler(View view) {
        switch (view.getId()) {
        case R.id.button1:
            RadioButton celsiusButton = (RadioButton) findViewById(R.id.radio0);
            RadioButton fahrenheitButton = (RadioButton) findViewById(R.id.radio1);
            if (text.getText().length() == 0) {
                Toast.makeText(this, "Please enter a valid number",
                        Toast.LENGTH_LONG).show();
                return;
            }

            float inputValue = Float.parseFloat(text.getText().toString());
            if (celsiusButton.isChecked()) {
                text.setText(String
                        .valueOf(convertFahrenheitToCelsius(inputValue)));
                celsiusButton.setChecked(false);
                fahrenheitButton.setChecked(true);
            } else {
                text.setText(String
                        .valueOf(convertCelsiusToFahrenheit(inputValue)));
                fahrenheitButton.setChecked(false);
                celsiusButton.setChecked(true);
            }
            break;
        }
    }

    // Converts to celsius
    private float convertFahrenheitToCelsius(float fahrenheit) {
        return ((fahrenheit - 32) * 5 / 9);
    }

    // Converts to fahrenheit
    private float convertCelsiusToFahrenheit(float celsius) {
        return ((celsius * 9) / 5) + 32;
    }
} 
```

**主要的.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@color/myColor"
    android:orientation="vertical" >

    <EditText
        android:id="@+id/editText1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:inputType="numberDecimal|numberSigned" >
    </EditText>

    <RadioGroup
        android:id="@+id/radioGroup1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >

        <RadioButton
            android:id="@+id/radio0"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:checked="true"
            android:text="@string/celsius" >
        </RadioButton>

        <RadioButton
            android:id="@+id/radio1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="@string/fahrenheit" >
        </RadioButton>
    </RadioGroup>

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:onClick="myClickHandler"
        android:text="@string/calc" >
    </Button>

</LinearLayout> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T18:16:21.553

好像您还没有声明文本，它是 TextView 还是 EditText？

像这样定义它

```
public class testActivity extends Activity {
/** Called when the activity is first created. */
TextView text;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    text = (TextView)findViewById(R.id.yourTextViewId);
} 
```

以这种方式声明后，您将看不到错误。

# google-drive-api - 是否有 google drive SDK 邮件列表或 RSS 提要？

> ID：10321277
> 
> 赞同：3
> 
> 时间：2012-04-25T18:07:21.403
> 
> 标签：google-drive-api

鉴于谷歌驱动器是全新的。我预计会有很多变化，更多的文档，新的代码示例，API 的变化。是否有某种邮件列表或??? 我可以使用这些更新吗？

谢谢

安迪

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T05:02:16.207

Google Drive SDK 没有邮寄名单。所有问题都在 Stack Overflow 上的[google-drive-sdk 标签](https://stackoverflow.com/questions/tagged/google-drive-sdk)下处理。

有关 SDK 更改的更新，请订阅[Google Apps 开发者博客](http://googleappsdeveloper.blogspot.com/)。我们的标准做法是在那里发布所有更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T20:07:04.673

据我所知，没有真正的邮件列表。但是，Google 确实提供了许多与 Google Drive 相关的内容来源。这是一个列表：

[**Google 博客**- 介绍 Google 云端硬盘...是的，真的](http://googleblog.blogspot.com/2012/04/introducing-google-drive-yes-really.html)

[**推特**-@google](http://twitter.com/google)

[**Google Drive 产品论坛**- 提问、报告、分享](https://groups.google.com/a/googleproductforums.com/forum/#!forum/drive)

[**Google Drive SDK** - 为 Google Drive 开发应用程序支持](https://developers.google.com/drive/)

[**Google 云端硬盘帮助**- 客户和开发者](https://support.google.com/drive/?hl=en&p=web_home)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T20:01:16.627

你可以做我做的。

只需将鼠标悬停在 google-drive-sdk 标签上。您将看到两个选项。在电子邮件/RSS 之间进行选择。

附上图片。 [http://goo.gl/bGV8h](http://goo.gl/bGV8h)

编辑：更正了链接

# java - 使用 Java StarTeam API，我如何找到 StarTeam 项的哪些修订版具有特定标签？

> ID：10321278
> 
> 赞同：2
> 
> 时间：2012-04-25T18:07:21.967
> 
> 标签：java, api, label, starteam

我正在使用 StarTeam java API (v10.4)。

我花了很长时间试图找到标签适用于哪些*特定修订。*让这件事变得棘手的是，在 Label 对象上似乎没有方法可以提供该标签所应用的列表。

因此，您（似乎）需要倒退并找到要检查特定标签的项目列表，例如

```
int[] check_these_items = new int[]{ item_to_check.getID() };
int[] labelledItems = myLabel.getLabeledItemIDs(check_these_items) 
```

首先，这有点令人费解，因为您首先需要有一个标签，而我真正想要的是获得一个附加到单个修订版的标签列表。但是，好吧，让我们现在就开始吧。所以现在我需要从历史中找到一个单一的修订。让我们简单地说，我想获得第三（或第四）次修订：

```
Item specific_child = item_to_check.getHistory()[3]; 
```

现在的问题是，历史中的这个新子`getID()`节点与父节点具有相同的 ID（通过），因此 using`getLabeledItemIds(check_these_items)`将返回相同的标签，基本上，我们没有得到任何结果。

我确实找到了一个与查找过去修订相关的[问题](https://stackoverflow.com/questions/4812359/finding-past-revisions-of-files-in-starteam-w-net-sdk-c-sharp)，但它与查找过去修订的标签*无关*。

当然，我查看了[Borland](http://techpubs.borland.com/starteam/2009/en/sdk_documentation/api/com/starbase/starteam/Item.html)的 API 文档，但没有提出解决方案。

我知道 UI 可以做到这一点，所以肯定有办法，我只是有时间找到它。

任何高水平的建议都将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T12:36:12.030

获得**[项目](http://techpubs.borland.com/starteam/2008/en/SDK_Documentation/api/com/starbase/starteam/Item.html)**和**[标签](http://techpubs.borland.com/starteam/2008/en/SDK_Documentation/api/com/starbase/starteam/Label.html)**后，使用**[getFromHistoryByLabelID(int)](http://techpubs.borland.com/starteam/2008/en/SDK_Documentation/api/com/starbase/starteam/Item.html#getFromHistoryByLabelID%28int%29)**
来“根据给定的标签 ID 返回此项目的指定版本”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T20:52:30.877

这似乎仍然不是正确的答案，但最终我不得不继续前进并最终使用一种解决方法来找到我想要的标签的修订日期/时间，然后将项目修订与之进行比较。因此，通过这种类型的反向逻辑，我能够检查附加到元素的每个标签，并找出哪些修订版具有该标签。

# ruby-on-rails - 在 Rails 3.0 中使用 Sencha Touch 2.0 构建命令的最佳实践？

> ID：10321281
> 
> 赞同：1
> 
> 时间：2012-04-25T18:07:31.563
> 
> 标签：ruby-on-rails, ruby-on-rails-3, sencha-touch, sencha-touch-2

我是 Sencha Touch 2.0 的新手，我正在尝试将其集成到现有的 Rails 3.0 项目中。我有：

1.  安装了最新的sdk (http://www.sencha.com/products/touch/download/)
2.  完成了 Sencha Touch 2 入门教程 (http://docs.sencha.com/touch/2-0/#!/guide/getting_started)
3.  通读本[教程](http://mikehoitomt.wordpress.com/2011/03/10/sencha-touch-application-with-ruby-on-rails-part-1/)和关于将 Sencha Touch 1 与 Rails 集成的[pt2 。](http://mikehoitomt.wordpress.com/2011/04/21/sencha-touch-application-with-ruby-on-rails-%E2%80%93-part-2/)

.. 但是上面的材料（我发现的最好的）从未提及 Sencha Touch 2:`sencha build`命令以及如何与 Rails 3.0 集成。

`sencha build`例如创建一个 /diff 目录，这很酷，但会破坏我的应用程序，作为一个小例子。

有谁知道一些关于如何将 Sencha Touch 2 与 rails 3.0（不是 rails 3.1）集成的最佳实践/指南，尤其是使用`sencha build`命令？

谢谢！

# cxf - 将 Web 服务响应路由到 POJO，而不实现任何特定于骆驼的接口

> ID：10321284
> 
> 赞同：0
> 
> 时间：2012-04-25T18:07:42.803
> 
> 标签：cxf, apache-camel

我正在将我的 web 服务请求路由到一个 bean，该 bean 将响应发送回服务。

```
<camel:from uri="cxf:bean:authTest" />
<camel:to uri="bean:routeExitResponseProcessor"/> 
```

现在在 bean 类中，我必须实现**Processor**接口，访问**Exchange**对象，调用实现方法，然后通过将响应对象设置为 exchange 的主体，将响应发送回客户端。

我可以摆脱所有特定于 Camel 的 java 代码并在我的 applicationContext.xml 中配置所有内容吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T06:21:55.110

如果使用 bean 组件，则不必实现处理器接口。如果您的类只有一个公共方法，那么它将被调用，camel 将尝试将传入的主体转换为您的参数并将返回作为新主体处理。

尝试使用如下方法：

WebServiceResult myMethod(WebServiceInput 输入) {...}

其中参数是从 wsdl 生成的参数。

基督教

# selenium-ide - Selenium IDE Fancy Select 不工作

> ID：10321285
> 
> 赞同：0
> 
> 时间：2012-04-25T18:07:53.057
> 
> 标签：selenium-ide

我正在尝试从精美的选择下拉菜单中进行选择，但由于某种原因，我无法更改值。我已经尝试使用带有 click 命令的 xpath 来记录点击，现在我正在尝试使用 select 命令。似乎没有一个工作。有没有其他人遇到过这个/对如何更改花哨选择的值有任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T20:39:09.330

如果您定义了选择步骤，则 select（或 selectAndWait）将是命令，xpath=（您的 xpath）将是目标，您希望从选项列表中选择的项目将是值。Value 也可以是列表中项目的索引，其中最顶部的条目可以通过将 index=0 作为 Value 来引用：

```
select | xpath=[YourSelectElementXPATH] | ValueFromTheList 
```

或者

```
select | xpath=[YourSelectElementXPATH] | index=1 
```

如果您能够包含您的步骤或相关页面的 URL，则可以提供更具体的帮助。

# mysql - 来自复合键的mysql外键引用

> ID：10321295
> 
> 赞同：1
> 
> 时间：2012-04-25T18:08:11.093
> 
> 标签：mysql, database, foreign-keys, composite-key, referential-integrity

我正在创建一个应用程序，该应用程序将处理和记录学生何时得到大学教员的建议，并且我需要一种有效的方法来构建表格。我的问题来自缺乏参照完整性，这是由于无法创建一个外键，该外键将仅在 ADVISE_HIST 中的复合键的一部分上引用 STUDENT，即 (STUDENT_ID,DATE_ADVISED)

这是一些表格

```
create table STUDENT(
  LNAME varchar(50),
  FNAME varchar(50),
  ID char(9) primary key,
  ASSIGNED_ADVISOR_EMAIL varchar(70),
  foreign key (ASSIGNED_ADVISOR_EMAIL) references DEP_FACULTY(EMAIL) ON DELETE SET NULL,
  IS_ADVISED tinyint(1),
);

create table DEP_FACULTY(
  LNAME varchar(50),
  FNAME varchar(50),
  EMAIL varchar(70) primary key
);

create table ADVISE_HIST(
  STUDENT_ID char(9),
  /*foreign key (STUDENT_ID) references STUDENT(ID),*/
  ACTUAL_ADVISOR_EMAIL char(70) NOT NULL,
  foreign key (ACTUAL_ADVISOR_EMAIL) references DEP_FACULTY(EMAIL),
  DATE_ADVISED date,
  primary key REF_ADVISE_HIST (STUDENT_ID, DATE_ADVISED),
); 
```

我的问题是，是否有办法解决无法创建此密钥的问题，或者是否有我没有想到的更好的结构？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T19:16:38.823

MySQL 对外键有很多[限制](http://dev.mysql.com/doc/refman/5.6/en/innodb-foreign-key-constraints.html)。其中可能会妨碍您。. .

*   两个表都必须使用 INNODB 引擎。
*   “在引用表中，必须有一个索引，其中外键列按相同顺序列为第一列。”

* * *

此代码适用于我的版本（5.1.62）。

```
create table DEP_FACULTY(
  LNAME varchar(50),
  FNAME varchar(50),
  EMAIL varchar(70) primary key
) ENGINE = INNODB;

insert into DEP_FACULTY values ('Gregor', 'Brandich', 'gbrandich@thisdomain.com');

create table STUDENT(
  LNAME varchar(50),
  FNAME varchar(50),
  ID char(9) primary key,
  ASSIGNED_ADVISOR_EMAIL varchar(70),
  foreign key (ASSIGNED_ADVISOR_EMAIL) references DEP_FACULTY(EMAIL) ON DELETE SET NULL,
  IS_ADVISED tinyint(1)
) ENGINE = INNODB;

insert into STUDENT values ('Charmaine', 'DePeletier', 'cmd', 'gbrandich@thisdomain.com', 1);

create table ADVISE_HIST(
  STUDENT_ID char(9),
  foreign key (STUDENT_ID) references STUDENT(ID),
  ACTUAL_ADVISOR_EMAIL char(70) NOT NULL,
  foreign key (ACTUAL_ADVISOR_EMAIL) references DEP_FACULTY(EMAIL),
  DATE_ADVISED date,
  primary key REF_ADVISE_HIST (STUDENT_ID, DATE_ADVISED)
) ENGINE = INNODB;

insert into ADVISE_HIST values ('cmd', 'gbrandich@thisdomain.com', CURRENT_DATE);
insert into ADVISE_HIST values ('ctd', 'gbrandich@thisdomain.com', CURRENT_DATE); 
```

在最后两个插入中，第一个有效。第二个应该抛出外键约束错误。

# c++ - 静态二维数组

> ID：10321311
> 
> 赞同：4
> 
> 时间：2012-04-25T18:09:33.527
> 
> 标签：c++, arrays, static

我正在尝试在 C++ 中定义和使用二维数组

```
const float twitterCounts[][5] = {
        {1,0,0,0,0},
        {0,2,0,0,0},
        {0,0,3,0,0}
}; 
```

像这样返回它：

```
const float ??? TwitterLiveData::data() {
    return twitterCounts;
} 
```

并像这样使用它

```
float x = TwitterLiveData::data()[1][1]; 
```

静态访问器的正确签名是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T18:15:39.300

您不能返回数组，但可以返回指向其第一个元素的指针或对数组的引用。您只需在签名中输入正确的类型：

```
const float (*TwitterLiveData::data())[5] { 
```

或许

```
const float (&TwitterLiveData::data())[3][5] { 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T18:17:49.007

请参阅：[https ://stackoverflow.com/a/10264383/365496](https://stackoverflow.com/a/10264383/365496)

概括：

```
#include <array>

const std::array<std::array<float,5>,3>
twitterCounts = {
        {1,0,0,0,0},
        {0,2,0,0,0},
        {0,0,3,0,0}
};

const std::array<std::array<float,5>,3>
TwitterLiveData::data() {
    return twitterCounts;
} 
```

您可能不想按值返回数组，因为这可能太昂贵了。您可以改为返回对数组的引用：

```
const std::array<std::array<float,5>,3> &TwitterLiveData::data(); 
```

在任何一种情况下，您想要的语法都`float x = TwitterLiveData::data()[1][1];`有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T18:13:20.040

这取决于您的编译器，但大多数时候双数组的名称算作双指针。所以在你的情况下 twitterCounts 是一个浮点数**。

# c++ - C：每x毫秒显示一次（OpenGL）

> ID：10321315
> 
> 赞同：1
> 
> 时间：2012-04-25T18:10:03.863
> 
> 标签：c++, opengl, glut

我有一个 C/C++（只有主文件是 .cpp，所以我可以使用 OpenGL）程序，我在其中使用 OpenGL（GLUT，GLUI）。它已经显示了一些东西，但我希望它每 x 毫秒移动一次。我渲染了一些圆圈（已知的速度和坐标），并且我已经制作了计算它的下一个位置的函数，知道刷新率。

我试图将我的显示回调放在计时器回调中，但程序刚刚冻结。

为了每 x ms 运行一次显示回调，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T19:47:39.203

> 我试图将我的显示回调放在计时器回调中，但程序刚刚冻结。

确保在计时器回调中[重新武装计时器](http://www.opengl.org/archives/resources/faq/technical/glut.htm#glot0027)，否则它只会触发一次：

```
#include <GL/glut.h>

void display()
{
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    glOrtho(-10, 10, -10, 10, -1, 1);

    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();

    static float angle = 0;
    angle += 1.0f;
    glRotatef(angle, 0, 0, 1);

    glColor3ub(255,0,0);
    glBegin(GL_TRIANGLES);
    glVertex2f(0,0);
    glVertex2f(10,0);
    glVertex2f(10,10);
    glEnd();

    glutSwapBuffers();
}

void reshape(int w, int h)
{
    glViewport(0, 0, w, h);
}

void timer(int extra)
{
    glutPostRedisplay();
    glutTimerFunc(30, timer, 0);
}

int main(int argc, char **argv)
{
    glutInit(&argc, argv);
    glutInitWindowSize(640,480);
    glutInitDisplayMode(GLUT_RGBA | GLUT_DEPTH | GLUT_DOUBLE);
    glutCreateWindow("Timer");

    glutDisplayFunc(display);
    glutReshapeFunc(reshape);
    glutTimerFunc(0, timer, 0);
    glutMainLoop();
    return 0;
} 
```

# c++ - 将浮点数附加到 cpp 中的字符串流

> ID：10321317
> 
> 赞同：-1
> 
> 时间：2012-04-25T18:10:08.033
> 
> 标签：c++, floating-point, stringstream

我正在尝试在字符串流中写一个句子。这是我的草图：

```
stringstream is;
float position_angle0;

position_angle0=12.5;

is << "setpos1 0 %d ", int(position_angle0); 
```

我想有什么问题，因为它似乎不起作用。你能告诉我正确的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:12:07.940

标准流不采用类型格式说明符——没有必要，因为它们已经是隐式类型安全的。

```
is << "setpos1 0 " << static_cast<int>(position_angle0) << ' '; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T18:12:08.783

它应该如下所示：

```
is << "setpos1 0 " << static_cast<int>(position_angle0); 
```

# php - PHP多文件上传

> ID：10321318
> 
> 赞同：0
> 
> 时间：2012-04-25T18:10:13.457
> 
> 标签：php, upload

我有一次上传和多次上传。当我在大小为 6MB 的文件上尝试时，单次上传有效。

如果我尝试在 6MB 文件上进行多文件上传，多个或仅 1 个，它不起作用。

有任何想法吗？我尝试设置超时时间：

```
$messages = array();
$errors = array();

$upload_dir = '.';
if(isset($_FILES['file']['tmp_name'])){
    //Number of uploaded files.
    $num_files = count($_FILES['file']['tmp_name']);

    //loop over array of files
    for($i=0; $i<$num_files; $i++){

        //check if there is a file in the array.
        if(!is_uploaded_file($_FILES['file']['tmp_name'][$i])){
            //echo $_FILES['file']['tmp_name'][$i].': Upload Failed!';

        }else{
            //echo $_FILES['file']['tmp_name'][$i].': Upload good!';
            //lets insert the data into the DB.
            $filename = stripslashes($_FILES['file']['name'][$i]);
            $extension = getExtension($filename);
            $description = $_POST['description'][$i];

            if (($extension != "jpg") && ($extension != "jpeg") && ($extension != "png") && ($extension != "gif"))
            {
                //print error message
                $error[$i] = $filename.': '.'Unknown file extension! ';

            }
            else
            {
                //get the size of the image in bytes
                //$_FILES['image']['tmp_name'] is the temporary filename of the file
                //in which the uploaded file was stored on the server
                $size=filesize($_FILES['file']['tmp_name'][$i]);

                //compare the size with the maxim size we defined and print error if bigger
                if ($size > MAX_SIZE*1024)
                {
                    //echo '<h1>You have exceeded the size limit of 100MB!</h1>';
                    $errors[$i]=$filename.': You have exceeded the size limit of 100MB';
                }

                //we will give an unique name, for example the time in unix time format
                $time = time()+$i;
                $image_name=$time.'.'.$extension;

                //the new name will be containing the full path where will be stored (images folder)
                $newname='D:\\uploads\\'.$image_name;
                //$newname=$image_name;
                //we verify if the image has been uploaded, and print error instead
                $copied = copy($_FILES['file']['tmp_name'][$i], $newname);
                if (!$copied)
                {
                    $messages[$i]= $filename.': '.'Copy unsuccessful!';
                    //echo 'Copy unsuccessful!';

                }else{
                    $messages[$i]= $filename.': '.'Copy successful!';
                    //get image information here.
                    $fileInfo = getimagesize($newname);
                    $mySize = $fileInfo[0];
                    $mimetype = image_type_to_mime_type($fileInfo[2]);
                    $dimensions = $fileInfo[3];
                    savePhotoInfo($image_name,$dimensions, $description,$mySize);
                    createThumb('D:\\uploads\\', 'D:\\uploads\\thumbnails\\', '180',$image_name);
                    //echo 'Copy successful!';
                }
            }
        }
    }

    echo 'Upload results:';
    echo '<br />';

    for($x=0;$x<count($messages);$x++){
        echo $messages[$x];
        echo '<br />';
    }

    echo 'Upload errors:';
    echo '<br />';
    for($x=0;$x<count($errors);$x++){
        echo $errors[$x];
        echo '<br />';
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T18:16:35.953

你看php.ini，上传大小的配置？

# c++ - 在运行时加载语法

> ID：10321319
> 
> 赞同：2
> 
> 时间：2012-04-25T18:10:14.970
> 
> 标签：c++, parsing, dynamic, runtime, grammar

我正在用 C++ 编写一个项目，我正在寻找一种方法以人类可读/可写的形式放入一个文本文件 ( usergrammar.txt )，这是一种定义对象的用户定义语法。

完成此操作后，我希望能够在代码中实例化其中一些对象，并将创建的实例保存在另一个文件 (instances.txt) 中，始终以人类可访问的格式。这第二个文件显然依赖于第一个被正确读取。

我遇到的问题是如何定义语法并解析它们。我一直在研究 Boost::Spirit，但是虽然它在读取第一个文件时会做得很好（因为它的规则是预定义的），但我认为它不适用于第二个文件，因为 Spirit 语法只是定义的一个编译时间，不能在运行时加载（至少我是这么理解的）。

现在我正在阅读 ENBF 表单，但我也有一个问题，即我不仅有语言规则，而且每个对象每次包含在另一个对象中时都有一个特定且不同的名称/描述/选项（例如，如果我有对象颜色，则其中的整数将称为红色、蓝色、黄色，而如果对象是标尺，则其整数将称为 length ），所以我也有办法将这些信息包含到文件中，并让它们与相应的值正确关联。

对于这样的项目，你有什么建议吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T21:43:01.663

请参阅使用从运行时提供的语法中提取的事实来解析上下文无关语言的[Earley 解析器。](http://en.wikipedia.org/wiki/Earley_parser)

另一种方法是利用几乎所有 C++ 编译器系统都提供可以分叉进程的库这一事实。您可以使用它来创建一个 shell 脚本，以根据任何相应的语法形式运行您喜欢的任何解析器生成器方案（包括 Boost:Spirit，要求您从脚本中调用 C++ 编译器，但这并不难），然后拥有该脚本调用生成的解析器。如果您要处理大型文档，这可能比 Earley 解析器更有效。实施起来肯定会容易得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:21:59.123

如果您愿意对文件格式有一些限制，您可以考虑使用 XML 或 JSON 来描述您的语法。

你可以有一个看起来像的语法文件

```
{
    "ObjectTypes" : {
        "ruler" : { "properties" : [ "length" ] },
        "color" : { "properties" : [ "red", "green", "blue" ] }
    }
} 
```

读入此文件后（很可能使用一些预先存在的库），然后您可以读入另一个包含实际对象的文件。它可能看起来像这样：

```
{
    "Objects" : [
        { name : "object1", "type" : "ruler", "length" : 5 },
        { name : "object2", "type" : "color", "red" : 5, "blue" : 127, "green" : 150, }
    ]
} 
```

等等。[此处](http://json.org)给出了 JSON 的更具描述性的概述，其中包括几个处理 JSON 的 C++ 库的链接（我个人最喜欢的是[JsonCpp](http://jsoncpp.sourceforge.net/)）。

# php - PHP/Apache 调用“标题：位置”覆盖方案？

> ID：10321321
> 
> 赞同：2
> 
> 时间：2012-04-25T18:10:31.240
> 
> 标签：php, apache, http-headers, haproxy

在过去的几个小时里，这一直让我发疯。似乎 PHP/Apache/Pound/Haproxy（无法真正分辨）坚持将页面重定向到我之前使用的相同方案/域，即使我明确声明它应该是不同的。

背景：我们通常有一个 http:\\www.example.com 域耦合到一个 https:\\secure.example.com 安全域（注意不同的子域）。这使我们的开发变得容易，因为我们没有为所有开发人员/项目提供 SSL 证书，我们只需检查 URL 是否以“安全”开头。对于这个项目，客户希望 https:\\www.example.com 作为安全域，所以我想：没问题，我只需更改逻辑以检测到生产。那部分工作正常。

然而，在某些情况下，用户需要从安全重定向到非安全，例如在登录并被重定向到主页时。我已将其缩小到这个简单的测试用例（注意：安全和非安全公共目录只是彼此之间的符号链接）：

```
<?php

// this is our server-specific way of detecting secure/non-secure in production
if (isset($_SERVER['HTTP_X_SSL_CIPHER'])) {
        header("HTTP/1.1 Moved permanently", true, 301);
        header("Location: http://www.example.com/test.php");
}
echo 'bubbles!'; 
```

您希望它在调用 https:\\www.example.com/test.php 后重定向一次，然后回显“bubbles！”。但是，我的浏览器坚持要重定向回httpS:\\www.example.com/test.php，从而导致死循环。

如果我用 HTTP 元刷新和/或 javascript 重定向替换标头调用一切正常，但我真的希望它与位置标头一起使用。Apache/PHP/Pound/Haproxy 似乎自己决定我应该坚持使用安全域，即使我明确告诉他们不要这样做。

需要注意的另一件有趣的事情是反向（从非安全重定向到安全）似乎工作正常。此外，在使用 https:\\secure.example.com 方案的其他站点（在同一服务器上）上，一切正常，大概是因为子域不同。

有谁知道为什么会发生这种情况，以及是什么原因造成的？我们的服务器设置是：Pound 将 https 请求分发到端口 8080 上的隐藏网络服务器，然后 haproxy 对端口 80（以及 IMAP 等其他一些东西）上的非安全网络服务器执行相同的操作，然后是一些普通的 Apache 网络服务器。

我唯一能想到的是负载均衡器以某种方式搞砸了，但这没有意义，因为来自网络服务器的回复直接发送回客户端 AFAICT ......任何想法，任何人？

NB 用反斜杠替换了示例中的斜杠，否则我认为我会发布“太多链接”。它们不是链接，它们是示例域。如果我想发布链接，我会添加一个锚点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T08:09:09.447

找到了; 如果域名匹配（在本例中是这样做的），Pound 默认将任何位置标头重写为“最初请求的内容”。请参阅 ListenHTTPS 部分中的“RewriteLocation 0|1|2”；在我的情况下应该设置为 0（“不要这样做”）。

# c# - 将值从表单传递到文本框

> ID：10321322
> 
> 赞同：2
> 
> 时间：2012-04-25T18:10:36.957
> 
> 标签：c#, winforms, visual-studio-2010

标题有点模糊。我有一个带有几个需要用户输入的文本框的表单。输入全是数字。这是一个触摸屏应用程序，因此当文本框获得焦点时，会显示一个“数字键盘”表单供用户输入数字。用户的输入显示在“数字键盘”表单上。

问题：如何将该输入设置为调用文本框的文本属性？

我知道我可以传递一些 int 值，然后在传递值时使用一个大的 switch 语句，但是大约有 30 个文本框。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T18:17:53.257

在您的 NumberPad 表单中，有一个属性是您的结果：

```
public int Result { get; private set; } 
```

当用户点击按钮保存数据时，分配值并为表单设置 DialogResult：

```
private void btnSave_Click(object sender, EventArgs e)
{
    Result = // whatever
    DialogResult = DialogResult.OK;
} 
```

在调用表单中，检查结果并仅在 OK 时处理（换句话说，NumberPad 已保存且未取消）：

```
NumberPad pad = new NumberPad();
if (pad.ShowDialog() == DialogResult.OK)
{
    txtBox.Text = pad.Result.ToString();
} 
```

# javascript - 在 keyup 上使用 submit() 提交了两次表单

> ID：10321323
> 
> 赞同：3
> 
> 时间：2012-04-25T18:10:45.780
> 
> 标签：javascript, jquery, forms, jquery-events, double-submit-problem

我有一个与此类似的 jQuery / HTML 代码：

```
<form action="/SomeAction" method="post">
  <input id="my-textbox" type="text" placeholder="Write something and press enter to continue..." />
</form>

<script type="text/javascript">
 $(function() {
     $('#my-textbox').keyup(function(e) {
        var $textbox = $(this);
        if ($textbox.val().length > 0 && e.keyCode == 13) {
           $textbox.parent('form').submit();
        }
     });
 });
</script> 
```

目的是在用户按下`Enter`键时自动提交表单。我经常使用 Firefox，所以在我使用 Google Chrome 和 Internet Explorer 进行测试之前，一切都很好。

当我`Enter`在后来的浏览器中按下键时，有时我会提交两次表单。这很容易注意到，因为我会在我的数据库中获得重复的条目，并且我会看到两个`POST`使用 Fiddler 的 s。

经过一些测试，我发现我的问题是 jQuery 代码，因为没有它，文本框会在输入时自动提交，并且`POST`在某些浏览器中使用此代码会产生一秒钟。

**我的问题是：**

为什么浏览器不能巧妙地阻止第二个表单的发布（就像 Firefox 在我的测试中所做的那样）？

我应该在所有平台的所有主要浏览器中都期待这种行为吗？

有没有办法改进这段代码，所以我使用 JavaScript 执行提交，但没有提交两次表单？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T18:16:49.673

> 为什么浏览器不能巧妙地阻止第二个表单的发布（就像 Firefox 在我的测试中所做的那样）？

这是默认行为。如果您没有脚本并且默认行为是表单不会在`enter`.

> 我应该在所有平台的所有主要浏览器中都期待这种行为吗？

是的

> 有没有办法改进这段代码，所以我使用 JavaScript 执行提交，但没有提交两次表单？

使用全局`mutex`变量并在表单 POST 时设置它 - 在后续 POST 上检查它以进行验证。或者，从`keyup`处理程序返回 false 并停止事件传播。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-25T18:17:01.363

如果表单中只有一个按钮，某些浏览器会将输入按钮解释为提交。只是`return false`在你的函数中防止默认行为提交表单。

```
if ($textbox.val().length > 0 && e.keyCode == 13) {
    $textbox.parent('form').submit();
    return false;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-25T18:26:03.280

在按下输入后（在 keydown 和 keyup 触发之前）立即提交您的表单，因此您可以这样做

```
$(function() {
    $('#my-textbox').keydown(function(e){
        if(e.keyCode==13) e.preventDefault();
    }); 

    $('#my-textbox').keyup(function(e) {
        e.preventDefault();
        var $textbox = $(this);
        if($textbox.val().length > 0 && e.keyCode == 13) {
           $textbox.parent('form').submit();
        }
     });
 });​ 
```

[**一个简单的测试。**](http://jsfiddle.net/u7KVj/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-25T18:14:42.263

添加在首次提交后设置为 true 的布尔变量，并在 if 条件中使用该变量。这将防止意外双击。

您还应该在应用程序后端防止重复提交（许多 Web 框架都有这样做的内置机制，也很容易提出自定义解决方案）。

# html - 如何制作具有重复左右图像边框的背景？

> ID：10321325
> 
> 赞同：0
> 
> 时间：2012-04-25T18:10:53.870
> 
> 标签：html, css

这可能是一个非常普遍的问题。但是，我尝试使用网络上的每个答案，但由于某种奇怪的原因，我的样式表中似乎存在冲突。我有一个带有在全部内容上重复的图像（布）图案的背景。现在我正在尝试向#container2 添加一个左右边框图像（带有线程，使其看起来像一块逼真的布料），该图像垂直向下重复。但是每次我这样做时，整个容器都会向下移动，当我调整位置时，它就会消失。

我的代码如下：

```
<div id="container">
<div id="container2">
<div id="header">

....................content...............

</div>
</div>
</div> 
```

CSS：

```
#container { background: #323232 url(images/container-bg.png) repeat; position: relative; }
#container2 { background:  url(images/container-bg-right.png) repeat; min-height: 300px; padding: 0px 0 0px 3%; max-width: 1000px; margin: 0 5% 0 5%; }
#header { margin-bottom:50px; } 
```

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T05:54:57.470

您可以为背景设置多个图像，*警告这不是所有浏览器都支持的*

所以你的html可能是：

```
<div id="container">
  <div id="inset-borders">
    -- Content --
  </div>
</div> 
```

CSS：

```
#inset-borders {
  background-image:url('left-border.png') left repeat-y, url('right-border.png') right repeat-y;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:36:28.287

你不想：

```
<div id="container"> </div>
<div id="container2"> </div>
<divid="header"> </div> 
```

或者你想要“container2”里面的“container”

# spring-mvc - RequestParam 从选择选项 html 表单中获取数组

> ID：10321328
> 
> 赞同：3
> 
> 时间：2012-04-25T18:11:13.340
> 
> 标签：spring-mvc

我正在尝试从 html 中的多选选项框中获取多个值。

我进入我的控制器：

```
/test?t=1&t=2&t=3 
```

在控制器中，我尝试获取 int 数组：

```
@RequestParam(value = "t", required = true) int[] t 
```

但是当我使用以下方法检查它时：

```
t.length 
```

我只看到 1，这意味着 Spring 只得到 1 个参数，但我期望 3。有人知道吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T21:29:56.073

我认为spring不会将参数数组转换为String以外的特定类型，因此您应该尝试以下操作：

```
@RequestParam(value = "t", required = true) String[] t 
```

然后用于`Integer.parseInt()`将 String 转换为 int。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-25T21:12:19.657

这在 Spring 3.2 版本中按预期工作。我有一个方法：

```
@RequestMapping(value = "/blueprint", method = RequestMethod.GET)
public ModelAndView blueprint(@RequestParam(value = "blueprints", required = false) int[] blueprints) 
```

以及使用时

```
http://localhost:9000/blueprint?blueprints=2&blueprints=1 
```

或者

```
http://localhost:9000/nbu-portal-webapp/blueprint?blueprints=1,2 
```

这些值正在转换为正确的 int 数组。

# c# - 英语国家/地区的 windows phone 本地化

> ID：10321329
> 
> 赞同：2
> 
> 时间：2012-04-25T18:11:15.223
> 
> 标签：c#, silverlight, windows-phone-7

我有一个关于 Windows Phone 本地化的问题。我检查了 windows phone 的文化和语言支持，对于英语，只有英语（美国）和英语（英国）。我也想为加拿大和澳大利亚的英语支持做广告，那我该怎么做呢？另外模拟器中的显示语言设置只有English (United States) 和English (United Kingdom) 的英文，那么如何测试加拿大和澳大利亚等其他英语国家呢？谢谢！

飞

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T18:36:34.860

Windows Phone 7 目前对文化/语言组合的支持矩阵有限。您可以[在 MSDN 上查看此语言支持列表](http://msdn.microsoft.com/en-us/library/hh202918%28v=vs.92%29.aspx)。如果您愿意，我建议您为加拿大的 en-CA 编码。

[如果您查看“如何本地化不受支持的语言？”](http://windowsteamblog.com/windows_phone/b/wpdev/archive/2012/04/02/globalizing-and-localizing-a-windows-phone-app.aspx)，Microsoft 会提供一些关于如何支持 WP7 中不受支持的语言的指导。[节](http://windowsteamblog.com/windows_phone/b/wpdev/archive/2012/04/02/globalizing-and-localizing-a-windows-phone-app.aspx)。你不会喜欢它。这是步骤的片段。

> 1.  如果您不打算在未来支持更多语言，则硬编码您的应用程序以使用不受支持的语言编写。或者，如果您计划在未来支持更多语言或将在您的提交中支持其他语言，请创建您的默认 AppResources.resx 文件并将您不支持的语言字符串放入其中。
>     
>     
> 2.  将您的中性语言设置为支持的显示语言之一。例如，“英语（美国）”。
>     
>     
> 3.  在 App Hub 上，系统将提示您输入您选择的中性语言的元数据和描述（对于上面的示例，系统会提示您输入英语）。您必须在“详细说明”字段中包含以下三项才能通过认证：
>     
>     
> 
> 注释，例如“此应用程序的语言是 [不支持的语言名称]”。此注释必须使用与中性语言相同的语言编写。例如，如果您选择“英语（美国）”作为您的中性语言，则注释必须用英语（美国）书写。此注释必须是“详细说明”字段中的第一项。您的应用描述，使用与中性语言相同的语言。您的应用描述，使用不受支持的语言。

我还建议将其粘贴在 en-CA 文件中，以便在支持出现时轻松切换到它。

# c# - DataRow.AcceptChanges 不会保留新的 RowState

> ID：10321331
> 
> 赞同：0
> 
> 时间：2012-04-25T18:11:30.313
> 
> 标签：c#, datatable

这个测试代码真的很简单

```
var addedRows1 = (securityDataTable.GetChanges(DataRowState.Added));
MessageBox.Show(addedRows1.Rows[1].RowState.ToString());
MessageBox.Show(addedRows1.Rows.Count.ToString());

addedRows1.Rows[1].AcceptChanges();

var addedRows2 = (securityDataTable.GetChanges(DataRowState.Added));
MessageBox.Show(addedRows2.Rows[1].RowState.ToString());
MessageBox.Show(addedRows2.Rows.Count.ToString()); 
```

4`MessageBox`按顺序显示以下消息：

```
Added
3
Added
3 
```

我希望计数在最后一条消息上返回 2。为什么不是这种情况，可以通过任何方式解决吗？注意：DataTable 未链接到表或特定数据源。

**编辑：**请注意，如果我第二次不重新查询 GetChanges()，则 RowState 可以（设置为未更改）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T18:15:08.137

GetChanges 返回行的**副本**。您是否使用数据适配器来填充数据表？MSDN 建议在 DataAdapter 上调用 AcceptChanges'

```
private void UpdateDataTable(DataTable table, 
    OleDbDataAdapter myDataAdapter)
{
    DataTable xDataTable = table.GetChanges();

    // Check the DataTable for errors.
    if (xDataTable.HasErrors)
    {
        // Insert code to resolve errors.
    }

    // After fixing errors, update the database with the DataAdapter 
    myDataAdapter.Update(xDataTable);
} 
```

**编辑** 由于您只是使用数据表，您可以为添加的行创建查询并在该行上调用 AcceptChanges：

```
DataRow[] addedRows = datatable.Select(null, null, DataViewRowState.Added);
 foreach (DataRow _ddr in addedRows)
 {
 _ddr.AcceptChanges();
 } 
```

# python - Python 要列出的列表列表

> ID：10321333
> 
> 赞同：0
> 
> 时间：2012-04-25T18:11:31.817
> 
> 标签：python, string, list, floating-point

我有一个相当简单的问题（我认为）。

我在python中有一个列表，元素是字符串。我希望有一个列表，其中包含浮动元素。

例如：

```
lst= [['0.0375'], ['-0.1652'], ['0.1841'], ['-0.0304'], ['0.0211'], ['0.1580'], ['-0.0252'], ['-0.0080'], ['-0.0915'], ['0.1208']] 
```

我需要有类似的东西：

```
lst= [0.0375, -0.1652, 0.1841, -0.0304, 0.0211, 0.1580, -0.0252, -0.0080, -0.0915, 0.1208] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T18:22:47.420

```
[float(x) for (x,) in your_list] 
```

# python - 在 python 中处理大量输入

> ID：10321334
> 
> 赞同：3
> 
> 时间：2012-04-25T18:11:37.440
> 
> 标签：python, io

几个月前我开始学习编程，最近才发现[codechef](http://codechef.com)。
问题是在使用大量输入的问题上，我的代码总是超过时间限制。我什至无法使[输入测试](http://www.codechef.com/problems/INTEST)工作。

来自codechef的描述：

> 输入
> 
> 输入以两个正整数 nk (n, k<=10^7) 开头。接下来的 n 行输入包含一个正整数 ti，每行不大于 10^9。

输出

> 写一个整数输出，表示有多少整数 ti 可以被 k 整除。

这是代码：

```
n, t = [int(x) for x in input().split()]
c = 0
for i in range(n):
    if not int(input()) % t:
        c += 1
print(c) 
```

我不确定我错过了什么。我怎样才能更快地处理这个？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T18:44:09.777

这真的应该是一个评论，但无论如何。

请注意，这里有一个公认的 Python 2 解决方案[，](http://www.codechef.com/viewsolution/989892)运行时间为 45.77 秒，所以这显然是可能的。我认为您是 Python 3 缓慢 I/O 的受害者（看起来他们使用的是 3.1.2）。在两百万行输入文件（恰好没有任何可整除的数字）上：当有很多时没有太大区别），在修改为与 2 和 3 兼容的代码版本上，我得到：

```
~/coding$ time python2.6 enormread.py < sample.txt 
0

real    0m3.971s
user    0m3.712s
sys 0m0.256s
~/coding$ time python2.7 enormread.py < sample.txt 
0

real    0m2.637s
user    0m2.428s
sys 0m0.204s
~/coding$ time python3.2 enormread.py < sample.txt 
0

real    0m10.412s
user    0m10.065s
sys 0m0.344s
~/coding$ time ~/sys/Python-3.3.0a2/python enormread.py < sample.txt 
0

real    0m6.776s
user    0m6.336s
sys 0m0.436s
~/coding$ time pypy enormread.py < sample.txt 
0

real    0m2.211s
user    0m1.948s
sys 0m0.028s 
```

将@agf`(sum(not int(line) % t for line in sys.stdin[.buffer]))`加入其中：

```
~/coding$ time python2.7 enormfast.py < sample.txt 
0

real    0m1.454s
user    0m1.436s
sys 0m0.016s
~/coding$ time python3.2 enormfast.py < sample.txt 
0

real    0m2.243s
user    0m2.228s
sys 0m0.012s 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T17:33:37.490

似乎无法使用 python3 运行测试，因为它的 IO 性能较慢。下面是我能写的最快的代码。回顾几个月的结果，这似乎是最快的 python 解决方案。使用 len() 的速度大约是 @agf 推荐的 sum() 的 3 倍。

* * *

```
python2.5:  8.28s

import sys
import psyco
psyco.full()

def main():
    n, k = map(int,sys.stdin.readline().split())
    print len([x for x in sys.stdin if not int(x) % k])

main() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T18:22:16.783

> 在 Python 中，您可以尝试通过在文件开头添加以下两行来加快解决方案：
> 
> ```
> import psyco
> psyco.full() 
> ```

[http://www.codechef.com/wiki/faq#Why_do_I_get_a_Time_Limit_Exceeded](http://www.codechef.com/wiki/faq#Why_do_I_get_a_Time_Limit_Exceeded)

# facebook - 从 Facebook Graph 获取投票结果

> ID：10321336
> 
> 赞同：2
> 
> 时间：2012-04-25T18:11:53.347
> 
> 标签：facebook, facebook-graph-api

我如何（如果可以）从 Facebook 图表中获取投票/问题的结果？目前我得到类似于以下内容的内容：

```
"data": [
      {
         "id": "12345_12345",
         "from": {
            "name": "My Company Name",
            "category": "Category",
            "id": "12345"
         },
         "story": "This is my question",
         "icon": "https://s-static.ak.facebook.com/rsrc.php/v1/yy/r/pz5wRf7MB0H.png",
         "privacy": {
            "description": "Public",
            "value": "EVERYONE"
         },
         "type": "question",
         "object_id": "12345",
         "application": {
            "name": "Questions",
            "id": "12345"
         },
         "created_time": "2012-04-25T12:23:03+0000",
         "updated_time": "2012-04-25T12:23:03+0000",
         "comments": {
            "count": 0
         }
      } 
```

我可以获得有关此问题的更多信息吗？我目前正在使用 PHP + CURL 来获取提要。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:42:18.600

从它的外观来看，您已经查询了特定的帖子 (post-id:12345_12345) : `https://graph.facebook.com/12345_12345`。

要获取[问题的数据](https://developers.facebook.com/docs/reference/api/question/ "https://developers.facebook.com/docs/reference/api/question/")，我们必须查询这篇文章数据本身中给出的问题 ID：

```
"type": "question",
"object_id": "12345", 
```

从这里我们有问题的ID，即`object_id:12345`。使用这个 id 我们可以得到问题的信息，所以查询 url 是 : `https://graph.facebook.com/12345`。

在问题返回的信息中，我们还会有[poll 的选项](https://developers.facebook.com/docs/reference/api/question_option/ "https://developers.facebook.com/docs/reference/api/question_option/")，它将是一个名为 的字段`options`。每个选项的信息将在此字段中给出，每个选项都有一个`votes`字段，它将告诉您该选项获得的票数。因此，您将获得投票结果。

在编写代码之前，使用[图形资源管理器来测试这些东西。](https://developers.facebook.com/tools/explorer "https://developers.facebook.com/tools/explorer")并阅读文档链接以了解有关问题的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:16:59.057

一般来说，**metadata=1** GET 参数会告诉您是否有更多相关数据可用。

# php - 呼应后值

> ID：10321349
> 
> 赞同：0
> 
> 时间：2012-04-25T18:12:38.533
> 
> 标签：php, codeigniter

我试图弄清楚为什么它与 $bookingDate 相呼应。我的代码中没有任何回显或打印语句，因此很难理解为什么它会在响应控制台中回显。我希望有人来看看是什么导致了这个问题。

```
 function submitBooking()
    {
        $outputArray = array('error' => 'yes', 'message' => 'unproccessed');
        $outputMsg = '';
        // Sets validation rules for the login form
        $this->form_validation->set_rules('eventName', 'Event Name',
            'is_natural_no_zero');
        $this->form_validation->set_rules('label', 'Label',
            'is_natural_no_zero');
        $this->form_validation->set_rules('bookingDate', 'Booking Date',
            'required');
        $this->form_validation->set_rules('location', 'Location',
            'required');
        $this->form_validation->set_rules('arena', 'Arena',
            'is_natural_no_zero');  
        $this->form_validation->set_rules('introduction', 'Introduction',
            'required');

        // Checks to see if login form was submitted properly
        if (!$this->form_validation->run())
        {
            $outputArray['message'] =
                'There was a problem submitting the form! Please refresh the window and try again!';
        }
        else
        {
            $bookingDate = $this->input->post('bookingDate');
            $bookingDate = date("d-m-Y h:i:s", strtotime($bookingDate));

            if ($this->eventsmodel->bookEvent($this->input->post('eventName'), $this->input->post('label'), $bookingDate, $this->input->post('location'), $this->input->post('arena'), $this->input->post('introduction')))
            {
                $outputArray = array('success' => 'Yes', 'message' =>
                                            'The event was booked successfully!');
            }
            else
            {
                $outputArray['message'] =
                'The event was not booked! Please try again later!';
            }
        }
        echo json_encode($outputArray);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:23:23.420

在中查找**echo 语句**。`eventsmodel->bookEvent`你可能会在`$bookingDate`那儿呼应。这里一切都很好。

希望这可以帮助。

# php - PHP应用程序不工作无法写入PDF文件

> ID：10321354
> 
> 赞同：0
> 
> 时间：2012-04-25T18:12:59.850
> 
> 标签：php, javascript, html, css

我正在[http://usborrow.com](http://usborrow.com)上工作。该站点曾经能够将数据输出到 PDF，但是我现在收到以下错误：

```
 Error: [2] /home/usborrow/public_html/gfe.php on line 218
fopen(docs/30b583784503f7dc61999d234c67e204.pdf) [function.fopen]: failed to open stream: 
No such file or directory 
```

第 218 行的脚本如下：

```
 // Create the pdf
 $pdfmaker = new pdftk_php();
 $pdfmaker->make_pdf($fdf_data_strings, $fdf_data_names, $fields_hidden, $fields_readonly,      $pdf_original, $pdf_filename);

    // Create the attachment and params
    $fileatt = '/'.$pdf_filename;
    $fileatttype = "application/pdf";
    $fileattname = $offer->hashval.'.pdf';
    $file = fopen($fileatt, 'rb');
    $data = fread($file, filesize($fileatt));
    $data = chunk_split(base64_encode($data));
    fclose($file);
    $random_hash = md5(date('r', time())); 
```

我已尝试更改 Docs 文件夹的权限，但它仍然无法正常工作。任何支持将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:23:39.943

不确定文件模式`rb`是什么......但我认为你想要的是`r+`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T20:50:01.297

也许它不是为了那种阅读..它是为了路径

在 fopen 之前试试这个：

```
if (!is_dir("docs") {
  mkdir("docs");
} 
```

# asp.net-mvc - 为什么asp.net mvc中的部分视图需要下划线

> ID：10321357
> 
> 赞同：22
> 
> 时间：2012-04-25T18:13:10.467
> 
> 标签：asp.net-mvc, partial-views

只是为了区分在对话框中使用的视图或在 foreach 循环中使用的视图（客户详细信息）？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-04-25T18:15:42.677

您不需要下划线。这只是一个约定，MVC 非常热衷于使用约定。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2012-04-25T18:19:24.147

Mike Brind 很好地提出了这个问题[为什么 Razor _layout.cshtml 在文件名中有一个前导下划线？](https://stackoverflow.com/questions/4576548/why-does-razor-layout-cshtml-have-a-leading-underscore-in-file-name)：

> 由于网页中的布局页面不打算直接提供服务，因此它们带有下划线前缀。并且网页框架已配置为不允许直接请求名称中带有前导下划线的文件。

除此之外，我发现使用这个约定来**区分***完整*视图和*部分*视图非常有帮助。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-04-25T18:49:14.647

@Marius Schulz 提供了一个很好的参考，但没有抓住重点。是的，下划线有助于区分完整视图和部分视图，但更重要的是，它*可以防止*部分视图直接通过其 URL 加载，这可能会提供一些潜在的丑陋结果！（对于初学者来说，就像没有 CSS 一样。）

编辑：神秘人是对的……我在想什么？MVC 中的 URL 指向控制器/动作，而不是查看。

此外，可能会搞砸并在单独的窗口中显示部分内容，因此命名约定不会阻止这种情况。@Marius Schulz 和我对他的引用有同样的误解。

前导下划线是区分完整视图和部分视图的有用约定，我将继续使用它，但这只是约定，而不是功能差异。

# javascript - 使用 jQuery 让函数等到 AJAX 调用完成

> ID：10321360
> 
> 赞同：1
> 
> 时间：2012-04-25T18:13:34.050
> 
> 标签：javascript, jquery, ajax, oop

我正在尝试在 JavaScript 中开发一个类，我可以使用它来轻松访问由 AJAX 请求收集的大量数据。唯一的问题是我需要让类的成员只有在 AJAX 调用完成后才能访问。理想情况下，我想结束的是我可以在脚本中调用它的东西：

```
courses.getCourse('xyz').complete = function () {
    // do something with the code
} 
```

这只会在 AJAX 调用完成并且“类”中的数据结构可以使用之后触发。理想情况下，我不想为类中的每个函数创建一个 .complete 成员

到目前为止，这是我试图做的“类”：

```
var model_courses = (function() {

    var cls = function () {

        var _storage = {}; // Used for storing course related info
        _storage.courses = {}; // Used for accessing courses directly
        _storage.references = new Array(); // Stores all available course IDs

        var _ready = 0;
        $.ajax({
            type: "GET",
            url: "data/courses.xml",
            dataType: "xml",
            success: function(xml) {
                $(xml).find("course").each(function() {

                    _storage.courses[$(this).attr('id')] = {
                        title       : $(this).find('title').text(),
                        description : $(this).find('description').text(),
                        points      : $(this).find('points').text()
                    }
                    _storage.references.push($(this).attr('id'))

                })

            }
        })

        console.log(_storage.courses)

    }
    cls.prototype = {
            getCourse: function (courseID) {
                console.log(cls._storage)
            },
            getCourses: function () {
                return _storage.courses
            },
            getReferences: function (),
                return _storage.references
            }

    }
    return cls
})() 
```

目前 getCourse 将在 AJAX 请求完成之前被触发，显然它没有数据可以访问。

任何想法将不胜感激，我坚持这个！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T18:17:31.787

jQuery 已经使用延迟对象为您处理了这个问题，除非我误解了您要查找的内容。

```
var courses = {
    getCourse: function (id) {
        return $.ajax({url:"getCourse.php",data:{id:id});
    }
};

courses.getCourse("history").done(function(data){
    console.log(data);
}); 
```

我知道这不是您正在寻找的，我希望它足以将您推向正确的方向。延迟对象很棒。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T19:16:16.147

以下更改允许您只发出一次 AJAX 请求，您可以调用您的函数，如

```
courses.getCourse('xyz', function(course){
    // Use course here
}); 
```

以下是变化

```
var model_courses = (function() {

    // This is what gets returned by the $.ajax call
    var xhr;
    var _storage = {}; // Used for storing course related info
    _storage.courses = {}; // Used for accessing courses directly
    _storage.references = []; // Stores all available course IDs

    var cls = function () {
        xhr = $.ajax({
            type: "GET",
            url: "data/courses.xml",
            dataType: "xml",
            success: function(xml) {
                $(xml).find("course").each(function() {

                    _storage.courses[$(this).attr('id')] = {
                        title       : $(this).find('title').text(),
                        description : $(this).find('description').text(),
                        points      : $(this).find('points').text()
                    }
                    _storage.references.push($(this).attr('id'))

                });
            }
        });
    }
    cls.prototype = {
            // Made changes here, you'd have to make the same 
            // changes to getCourses and getReferences
            getCourse: function (courseID, callback) {
                if (xhr.readyState == 4) {
                     callback(_storage.courses[courseID]);
                }
                else {
                   xhr.done(function(){
                      callback(_storage.courses[courseID]);
                   })
                }

            },
            getCourses: function () {
                return _storage.courses
            },
            getReferences: function (),
                return _storage.references
            }

    }
    return cls
})() 
```

附带说明一下，如果您需要实例化其中两个对象，您的模块模式将无法很好地工作`model_courses`，因为存储对象都在您的自调用函数的闭包中共享。您通常不会将模块模式与原型混合（从模块返回构造函数），除非您真的知道自己在做什么，也就是说，共享闭包变量作为*类*的静态属性工作。

如果我是你，这就是我会做的事情（因为你真的想要私有变量）

```
function ModelCourses() {
    var storage = {
      courses: {},
      references: []
    };

    var xhr = $.ajax({
        type: "GET",
        url: "data/courses.xml",
        dataType: "xml",
        success: function(xml) {
            $(xml).find("course").each(function() {   
                storage.courses[$(this).attr('id')] = {
                    title       : $(this).find('title').text(),
                    description : $(this).find('description').text(),
                    points      : $(this).find('points').text()
                }
                storage.references.push($(this).attr('id'))
            })    
        }
    });

    this.getCourse = function(courseId, callback) {
        function getCourse() {
            callback(storage.courses[courseID])
        }
        if (xhr.readyState == 4) {
            getCourse();
        }
        else {
            xhr.done(getCourse);
        }
    };   
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T18:17:34.577

要么添加检查以`getStorage`查看是否有任何数据要窃取（首选），要么将“实际”方法设为私有，而不是在它有可以访问的项目时公开它。（我会推荐第一个，否则你会在调用对象上不存在的方法时遇到异常）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T18:41:55.663

您可以定义一个函数`getData`来执行 ajax 请求并将其`getCourse`作为回调。`getData`可以在本地存储 Ajax 调用的结果，并在执行 ajax 调用之前测试本地存储。

您还可以指定一个私有成员以允许仅运行一次 ajax 调用。您可能需要检查[underscore.js](http://documentcloud.github.com/underscore/ "下划线.js")以获得一些方便的工具

这是一个简短的示例代码：

```
cls.prototype.getData = function(callback) {
    /*perform ajax call or retrieve data from cache*/
    callback()
}
cls.prototype.getCourse = function(id) {
    this.getData(function() {
        /*do something with the data and the id you passed*/
    }
} 
```

# c++ - 为模板模板函数解包可变参数？

> ID：10321370
> 
> 赞同：2
> 
> 时间：2012-04-25T18:14:07.130
> 
> 标签：c++, c++11

```
// some arbitrary function 
template<typename T>
void log( T&& obj )
{
    std::cout << obj << std::endl;    
}

// arbitrary transformation
template<typename T>
T convert(T&& obj) { 
     return obj; 
}

template<template <typename> typename F, typename... T>
void callOn( F<T> func,  ///  issue: what's the type of func?                 
             T&&... params)
{
    func(std::forward<T>(convert(std::forward<T>(params)))...);
}

int main()
{   
    callOn(log, -1, -2.0);      
     return 0;
} 
```

这可能吗？

编译器抱怨：调用 'callOn(, ..>) 没有匹配的函数。为什么 ？

更新：假设日志不是一元函数

```
template<typename T>
void log(T&& value) { std::cout << value << std::endl; }

template<typename First, typename... Rest>
void log(First&& f, Rest&&... rest)
{
    std::cout << f << ",";
    log(std::forward<Rest>(rest)...);
} 
```

callOn 采用与日志类型不匹配的“模板”类型？如何指定func的类型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T22:02:57.840

使用函数对象。这是一个可编译的示例：

```
#include <utility>
#include <iostream>

struct Log
{
    template<typename T> void operator()(T&& t) { 
        std::cout << t << std::endl; 
    }

    template<typename T, typename... Rest> void operator()(T&& t, Rest&&... rest)
    {
        std::cout << t << ", ";
        (*this)(std::forward<Rest>(rest)...);
    }
};

template<typename T>
T convert(T&& obj) {
     return obj;
}

template<typename F, typename... T>
void callOn(F funcobj, T&&... params)
{
    funcobj(std::forward<T>(convert(std::forward<T>(params)))...);
}

int main()
{
    callOn(Log(), -1, -2.17, "abc");
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T05:55:53.267

我认为 的语法不`template <typename> typename F`正确，标准在 14.3.3/1 中指定“模板模板参数的模板参数应是类模板或别名模板的名称”，而不是函数模板. 如果要传递函数模板，可以将参数声明为函数指针：

```
template<typename... T>
void callOn( void (*func)(T&&...params),
             T&&... params)
{
    //same as before
} 
```

而当`callOn(log, -1, -2.0);`被调用时， 的类型`T`不是`log`从 {-1, -2.0} 推导出为 {int, double} ，然后`func`从指向的指针初始化`log<int, double>(int&&, double&&)`。

# vbscript - 用于下载 CSV 文件的 Visual Basic 脚本（CSV 为空 - 0 字节）

> ID：10321373
> 
> 赞同：0
> 
> 时间：2012-04-25T18:14:32.870
> 
> 标签：vbscript, ftp

我有一个从 URL 下载文件的 vb 脚本 - 该 url 是一个 ftp 站点：ftp: [//ftp.zois.co.uk/pub/jcp/](ftp://ftp.zois.co.uk/pub/jcp/)

我需要下载下面指定的文件。脚本获取文件，但内容为空 - 尝试使用 ftp 站点上的其他 CSV 文件和同样的问题。

有人可以帮忙吗？

```
HTTPDownload "ftp://ftp.zois.co.uk/pub/jcp/JCP-scrape-2012-04-24.csv", "C:\"

Sub HTTPDownload( myURL, myPath )
' This Sub downloads the FILE specified in myURL to the path specified in myPath.
'
' myURL must always end with a file name
' myPath may be a directory or a file name; in either case the directory must exist
'
 ' Written by Rob van der Woude
' http://www.robvanderwoude.com
'
    ' Based on a script found on the Thai Visa forum
' http://www.thaivisa.com/forum/index.php?showtopic=21832

' Standard housekeeping
Dim i, objFile, objFSO, objHTTP, strFile, strMsg
Const ForReading = 1, ForWriting = 2, ForAppending = 8

' Create a File System Object
Set objFSO = CreateObject( "Scripting.FileSystemObject" )

' Check if the specified target file or folder exists,
' and build the fully qualified path of the target file
If objFSO.FolderExists( myPath ) Then
    strFile = objFSO.BuildPath( myPath, Mid( myURL, InStrRev( myURL, "/" ) + 1 ) )
ElseIf objFSO.FolderExists( Left( myPath, InStrRev( myPath, "\" ) - 1 ) ) Then
    strFile = myPath
Else
    WScript.Echo "ERROR: Target folder not found."
    Exit Sub
End If

' Create or open the target file
Set objFile = objFSO.OpenTextFile( strFile, ForWriting, True )

' Create an HTTP object
Set objHTTP = CreateObject( "WinHttp.WinHttpRequest.5.1" )

' Download the specified URL
objHTTP.Open "GET", myURL, False
objHTTP.Send

' Write the downloaded byte stream to the target file
For i = 1 To LenB( objHTTP.ResponseBody )
    objFile.Write Chr( AscB( MidB( objHTTP.ResponseBody, i, 1 ) ) )
Next

' Close the target file
objFile.Close( )
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T18:28:59.267

该代码用于从 HTTP 下载。FTP 不是 HTTP。FTP 确实有一个 get 命令，但如果没有别的，端口几乎肯定是不同的，并且由于没有指定端口，它几乎肯定使用 80 用于 HTTP，而 FTP 使用 21 作为其默认值。[这](http://www.robvanderwoude.com/vbstech_internet_ftp.php)是一个使用 ftp 的类似示例。可能有比它使用的其他/更好的 FTP 组件，但这是您问题的根源。另请注意，它并没有真正获取您的文件，它只是创建一个永远不会被写入的文件。

# python - 从 GUI 静默运行命令行应用程序

> ID：10321374
> 
> 赞同：1
> 
> 时间：2012-04-25T18:14:35.283
> 
> 标签：python, subprocess, py2exe

我想运行特定的命令行应用程序：

```
ffmpeg -i video.mp4 audio.mp3 
```

我正在通过 GUI 运行命令，当控制台窗口不存在时，该`ffmpeg`进程正在新的 cmd 窗口中运行。

测试人员发现“出现的黑色窗口”很吓人，而且对用户不友好。

如何在不出现任何可见窗口的情况下运行应用程序？`os.system()`，`subprocess.Popen()`并且`subprocess.call()` 都启动了 cmd 窗口。

如果重要的话，我正在使用 pyqt4 和 py2exe。我的目标是 Windows 操作系统用户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T19:53:42.947

ActiveState 的这个配方可以解决你的问题：

[http://code.activestate.com/recipes/409002/](http://code.activestate.com/recipes/409002/)

Python 2.7 需要稍作更改。请参阅[如何从 Python (2.7) 中生成的进程中消除 Windows 控制台？](https://stackoverflow.com/questions/3390762/how-do-i-eliminate-windows-consoles-from-spawned-processes-in-python-2-7)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:18:09.333

`ffmpeg`从`START`命令启动。如果您使用该`/B`开关，则不会显示任何命令窗口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T18:21:39.653

使用`subprocess.Popen`（或`call`）并在某处重定向标准输出/标准错误。他们目前与您自己的进程的标准输出和标准错误挂钩，这就是他们通过的原因。

如果您需要可以与您的 GUI 事件循环很好地集成的东西，请使用 Twisted 的进程启动工具。

# flash - Actionscript 2 图像滑块计时

> ID：10321379
> 
> 赞同：1
> 
> 时间：2012-04-25T18:14:39.407
> 
> 标签：flash, actionscript-2

我使用 Actionscript 2 在 Flash 中创建了一个图像滑块。基本上我有五个 600 像素的图像并排堆叠在一个名为 ContentMC 的剪辑中。目前，当按下相应的按钮时，滑块可以很好地在图像之间滚动，但我想弄清楚的是如何让图像每隔几秒就自动滚动一次，而不需要用户交互。我在主时间轴上的操作层上有以下代码：

```
import mx.transitions.Tween;
import mx.transitions.easing.*;

btn1.endX = 64;
btn1.onPress = doPress;
btn2.endX = -536;
btn2.onPress = doPress;
btn3.endX = -1136;
btn3.onPress = doPress;
btn4.endX = -1736;
btn4.onPress = doPress;
btn5.endX = -2336;
btn5.onPress = doPress;

function doPress() {
    var twX = new Tween(contentMC, "_x", Strong.easeInOut, contentMC._x, this.endX, 1.5, true);
} 
```

我有一个名为 contentMC 的实例，其中包含所有图像。我有 5 个名为 btn1 到 btn5 的实例，每个实例都包含按钮影片剪辑。

同样，我正在寻求帮助的特定功能是让图像每隔几秒钟自动滑动一次（以及通过点击相应的按钮保留滑动到特定图像的能力）。对于我的任何无知，我深表歉意，但我对 Actionscript 不太精通。

谢谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T20:32:34.717

好的，我的动作脚本有点生疏，但我想你会想尝试这样的事情。

```
import mx.transitions.Tween;
import mx.transitions.easing.*;

// Initialize Pixel Offsets in an array
// This is the equivalent of what you were doing before but more accessible 
// to code. It has to start at 0 though, so btn1.endX is offsetArray[0] and 
// btn2.endX is offsetArray[1] and so on and so on.
var offsetArray = new Array();
offsetArray[0] = 64;
offsetArray[1] = -536;
offsetArray[2] = -1136;
offsetArray[3] = -1736;
offsetArray[4] = -2336;

// Setup button callbacks
btn1.onPress = function() { changeImage(1); }
btn2.onPress = function() { changeImage(2); }
btn3.onPress = function() { changeImage(3); }
btn4.onPress = function() { changeImage(4); }
btn5.onPress = function() { changeImage(5); }

// Array of buttons, used to dynamically set buttons to down state
var btnArray = new Array();
btnArray[0] = btn1;
btnArray[1] = btn2;
btnArray[2] = btn3;
btnArray[3] = btn4;
btnArray[4] = btn5;

// Button one down by default
btnArray[0].gotoAndStop(3);

// Setup the Timer
// Change this value to alter the delay in image changes
secondDelay = 4;
totalDelay = 30;
// Number of images in the slider (Don't change this unless you add more onPress and endX variables above)
totalImages = 5;

// Don't change these
secondCounter = 0;
totalCounter = 0;
var imageCounter = 1;
// Fires the delay function every 1000 milliseconds
var imageTimer = setInterval(delay, 1000);

// General Function for changing an image in the slider
function changeImage(offset) {
    imageCounter = offset;
    clearInterval(imageTimer);

    if (totalCounter < totalDelay) {
        secondCounter=0;
        imageTimer = setInterval(delay, 1000);
        // Make sure we don't try to move to an image that doesn't exist
        if (imageCounter > totalImages) {
             imageCounter = 1;
        }
    }

    var twX = new Tween(contentMC, "_x", Strong.easeInOut, contentMC._x, offsetArray[imageCounter - 1], 1.5, true);

    // Reset buttons
    for (var i=0;i<totalImages;i++) {
        btnArray[i].gotoAndStop(1);
    }
    // Set button to downstate
    btnArray[imageCounter - 1].gotoAndStop(3);
}

// Timer function for dealing with the passing of time
function delay() {
    secondCounter++;
    totalCounter++;

    if (totalCounter > totalDelay) {
        clearInterval(imageTimer);
    }

    // If it is time to do something, we can do it!
    if (secondCounter >= secondDelay) {
        secondCounter = 0;
        imageCounter++;
        // Now call our changeImage function with the correct offset value
        changeImage(imageCounter);
    }
}

// Script for button animations
btn1.onRollOver = function() {
btn1.gotoAndPlay(2);
}
btn1.onRollOut = function() {
    if (imageCounter == 1) {
        btn1.gotoAndStop(3);
    } else {
        btn1.gotoAndStop(1);
    }
}

btn2.onRollOver = function() {
btn2.gotoAndPlay(2);
}
btn2.onRollOut = function() {
    if (imageCounter == 2) {
        btn2.gotoAndStop(3);
    } else {
        btn2.gotoAndStop(1);
    }
}

btn3.onRollOver = function() {
btn3.gotoAndPlay(2);
}
btn3.onRollOut = function() {
    if (imageCounter == 3) {
        btn3.gotoAndStop(3);
    } else {
        btn3.gotoAndStop(1);
    }
}

btn4.onRollOver = function() {
btn4.gotoAndPlay(2);
}
btn4.onRollOut = function() {
    if (imageCounter == 4) {
        btn4.gotoAndStop(3);
    } else {
        btn4.gotoAndStop(1);
    }
}

btn5.onRollOver = function() {
btn5.gotoAndPlay(2);
}
btn5.onRollOut = function() {
    if (imageCounter == 5) {
        btn5.gotoAndStop(3);
    } else {
        btn5.gotoAndStop(1);
    }
} 
```

这绝对可以重构，因为它完成得有点快，但它应该让任何人开始。

不幸的是，我没有可用的 flash studio 来测试它，但这应该是一个好的开始。如果您有任何问题或疑问，请向我发表评论。

# c# - C# 三个布尔值，一次为真

> ID：10321384
> 
> 赞同：-9
> 
> 时间：2012-04-25T18:14:44.320
> 
> 标签：c#, boolean

我在 c# 中有三个布尔值。每个都允许打开不同的菜单。但是，在任何给定时间，只有一个可能是真的。因此，如果我按下一个按钮并且该按钮将相应的布尔值设置为相应的菜单，但我想要一个巧妙的检查，如果它们为真，则在将该布尔值设置为真之前将其变为假。不确定这是否有意义。感谢您提前提供任何帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-25T18:19:29.583

听起来你想要*一个*变量，可能使用枚举：

```
public enum ActiveMenu
{
    None,
    Settings,
    MainMenu,
    OtherMenu
} 
```

然后有一个 type 的变量，`ActiveMenu`显然它一次只能保存一个值。这感觉比拥有三个独立的（但密不可分的）布尔变量更明智。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-25T18:17:08.797

将所有三个布尔值设为假，然后将所需的一个设为真。

# cocoa - 限制 Cocoa 中的滚动弹性（NSScrollView）

> ID：10321388
> 
> 赞同：1
> 
> 时间：2012-04-25T18:15:06.543
> 
> 标签：cocoa, mouseevent, mousewheel, appkit, nsscrollview

我有一个有十几个滚动视图的可可应用程序。我喜欢这种弹性，尤其是在某些情况下，我实际上会放某种“复活节彩蛋”（有点像图书应用程序中的苹果标志。向下滚动，你会看到一个苹果标志。）

我的问题是，我需要限制超出实际内容区域的公开内容数量。特别是当我用魔术鼠标滚动时，弹性导致整个滚动内容消失！直到您释放卷轴，它才会移回。

现在，我想将弹性限制在特定的边际。如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T18:27:03.183

NSScrollView 管理一个视图，它的“画布”比任何时候都/可以显示的更大。因此，如果您想要不同的行为：

*   检查[`(void)setHorizontalScrollElasticity:`](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/nsscrollview_Class/Reference/Reference.html)，但这并不完全符合您的要求。（你想允许*固定*量的弹性）
*   子类 NSScrollView 来实现你想要的行为。
*   从头开始创建你自己的类（嗯......从 NSResponder 继承的任何东西，因为你想处理事件）。

例如，我曾经写过一个世界地图程序，但需要地图在水平轴上永远循环。我只是使用子类 NSView 手动管理滚动。（目前无权访问代码）

**需要思考的事情：** 我理解你的原因，但只是想提一下。该行为应该是用户所期望的。如果它看起来像一个按钮，它应该像 out 一样。目前，滚动视图具有弹性，因此当它们通过动量滚动时（用户不再触摸），一旦到达终点，它就不会突然停止……这对用户来说是不和谐的。

* * *

**示例**
如果继承 NSScrollview，我会尝试覆盖`- (void)scrollWheel:(NSEvent *)`并检测 contentView 的边界并将其限制在某个值。围绕以下几行：

```
- (void)scrollWheel:(NSEvent *)event
{
    [super scrollWheel:event];
    if (self.contentView.bounds.origin.y > SomeConstant)
         /* cap the value */
} 
```

# android - ResourceType 跳过条目

> ID：10321389
> 
> 赞同：3
> 
> 时间：2012-04-25T18:15:07.957
> 
> 标签：android

我总是收到这个奇怪的警告。我想解决这种行为，而不是忽略它。

日志猫：

```
04-25 18:12:32.145: W/ResourceType(459): Skipping entry 0x7f020001 in package table 0 because it is not complex! 
```

我查看了我的 R.java 类：

```
public static final int custom_button=0x7f020001; 
```

然后我查看了styles.xml：

```
<item name="android:buttonStyle">@drawable/custom_button</item> 
```

Custon_Button：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_pressed="true" >
        <shape>
            <solid
                android:color="#a276eb" />
            <stroke
                android:width="1dp"
                android:color="#6a3ab2" />
            <corners
                android:radius="3dp" />
            <padding
                android:left="10dp"
                android:top="10dp"
                android:right="10dp"
                android:bottom="10dp" />
        </shape>

    </item>
    <item>
        <shape>
            <gradient
                android:startColor="#bf27c3"
                android:endColor="#6a3ab2"
                android:angle="270" />
            <stroke
                android:width="1dp"
                android:color="#6a3ab2" />
            <corners
                android:radius="4dp" />
            <padding
                android:left="10dp"
                android:top="10dp"
                android:right="10dp"
                android:bottom="10dp" />
        </shape>
    </item>
 </selector> 
```

我还在我的 Applikation 中使用了 Greendroid。

请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-25T07:44:55.277

设置按钮属性时出现同样的错误`style="@drawable\my_button"`。我删除了属性样式并添加了`android:background="@drawable\my_button"`警告消失了。

# jquery - toggleClass上的jquery函数完成了吗？

> ID：10321393
> 
> 赞同：32
> 
> 时间：2012-04-25T18:15:24.780
> 
> 标签：jquery

切换类完成后如何执行功能？我尝试了以下但没有运气：

```
$("#loader").toggleClass('fadeOut', function () {
    alert('a');
}); 
```

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-04-25T18:48:13.787

jQuery 有一个 Promise 方法，它返回一个 Promise，该 Promise 在选定元素上的所有运行动画完成后解析。此时，您可以绑定到它的 done 方法。

```
$("#loader").toggleClass('fadeOut',600).promise().done(function(){
    console.log('a');
}); 
```

[http://jsfiddle.net/skram/4x76J/](http://jsfiddle.net/skram/4x76J/)

*注意：*使用的动画`toggleClass`需要 jQuery UI。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T18:17:54.157

`toggleClass`立即执行，因此您不需要回调`toggleClass`，只需将`alert('a')`放在下一行，它会在`toggleClass`执行后发出警报。

**编辑：**看起来你想要 jQuery UI 效果 -`toggleClass`不幸的是它没有回调函数。

可能您应该编写自己的切换功能。请参阅下面的淡入/淡出切换，

```
var $loader = $("#loader");
if ($loader.is(':visible')) {
  $loader.fadeOut(100, function () {
      alert('fade out complete');
  });
} else {
  $loader.fadeIn(100, function () {
      alert('fadeIn complete');
  });
} 
```

# excel - Excel VBA或不为VBA，如果两个单元格之间的文本不同，则替换文本

> ID：10321402
> 
> 赞同：0
> 
> 时间：2012-04-25T18:16:02.900
> 
> 标签：excel, vba

我有一个困惑，我不知道使用 excel VBA 是否会更好。考虑一下，我相信 VBA 会工作得最好，但我不知道如何让它工作。

我在工作簿中有两个页面，一个是表单，另一个是数据库，我希望表单中的下拉菜单填充表单的其余部分。它确实......我想要的是能够更改表单按提交的值，并且新数据将覆盖旧数据。

这可能吗？

这是我正在谈论的工作表的链接。

[http://dl.dropbox.com/u/3327208/Excel/Change.xlsx](http://dl.dropbox.com/u/3327208/Excel/Change.xlsx)

这是我现在正在使用的脚本...它获取工作表，将所有内容复制到一行获取该行，将其移动到 NCMR 数据选项卡，然后从原始工作表中清除新行上的数据。

这段代码在技术上可以工作，但我需要做的是让它使用相同的概念，但不是在工作表末尾创建一个新行，而是找到原始行并将数据从 B 替换到 U 中的任何行原本在。

我知道这是可能的，我只是不知道如何。

```
 'Copy Ranges Variable
    Dim c As Variant

    'Paste Ranges Variable
    Dim p As Range

    'Setting Sheet
    Set wsInt = Sheets("Form")
    Set wsNDA = Sheets("Data")
    Set p = wsInt.Range("A14")

    With wsInt
        c = Array(.Range("B11"))
    End With

    For i = LBound(c) To UBound(c)
        p(i + 1).Value = c(i).Value
    Next

    With wsNDA
        Dim Lastrow As Long

        Lastrow = .Range("B" & Rows.Count).End(xlUp).Row + 1

        wsInt.Rows("14").Copy

        With .Rows(Lastrow)
            .PasteSpecial Paste:=xlPasteFormats
            .PasteSpecial Paste:=xlPasteValues
            .Interior.Pattern = xlNone
        End With

        With .Range("A" & Lastrow)
            If Lastrow = 3 Then
                .Value = 1
            Else
                .Value = Val(wsNDA.Range("A" & Lastrow - 1).Value) + 1
            End If

            .NumberFormat = "0#######"
        End With
    End With
End Sub 
```

我找到了这段代码：

```
Sub CopyTest()
Dim selrow As Range, rngToCopy As Range

With Worksheets("PD DB")
    Set selrow = .Range("B:B").Find(.Range("BA1").Value)
    'find the cell containing the value
    Set rngToCopy = Union(selrow.Offset(0, 9), selrow.Offset(0, 12))
    'use offset to define the ranges to be copied
    rngToCopy.Copy Destination:=Worksheets("Edit Sheet").Range("B50")
    'copy and paste (without Select)
End With

End Sub 
```

据我所知，这将做我最想做的事，但我似乎无法弄清楚在哪里分解它以将它添加到我需要让它按我想要的方式工作的地方。

我能说的是，它会复制和粘贴，但我想确保它将数据粘贴到它找到的行中，而不是覆盖所述行的数量。

有人可以通过我这里的两个脚本帮助实现这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T18:19:21.253

马特，我会采取两种方法。第一个是使用 find()，它返回一个范围对象，然后附加“.row”，这样您就可以修改 Sheet2 上的行（我认为是 wsNDA）。您可能想要测试 find() 不会返回 Nothing。

```
Dim foundRow as Long
Dim foundRng as Range

set foundRng = wsNDA.find(wsInt.Range("B11").Value, ...)
If Not foundRng is Nothing Then
  foundRow = foundRng.row
End If

'method without check: foundRow = wsNDA.find(wsInt.Range("B11").Value, ...).Row 
```

另一种是使用 Dictionary 对象。我不确定您想要什么密钥，但该项目可能是数据表上的行。当您对表单上的内容进行更改时，请检查键并获取其项目（相应的行）以确定您需要替换值的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T19:00:44.923

未经测试，但应该让你开始。我添加了第三张表（shtMap）来保存表单上的单元格地址和“数据”表上的列号之间的映射。直接在 VB 编辑器中命名工作表很有用：选择工作表并在属性网格中设置名称。

**编辑：* *如果您想在从 Range AG3 的列表中选择记录 ID 时触发传输，则将此代码放在该工作表的代码模块中：

```
Private Sub Worksheet_Change(ByVal Target As Range)

Static bProcessing As Boolean
Dim rng As Range

    If bProcessing Then Exit Sub
    Set rng = Target.Cells(1)
    If Not Application.Intersect(rng, Me.Range("AG3")) Is Nothing Then
        bProcessing = True
        'this is where you call your macro to transfer the record
        bProcessing = False
    End If

End Sub 
```

您可以使用类似这样的方式进行传输：

```
Public Enum XferDirection
    ToForm = 1
    ToDataSheet = 2
End Enum

Sub FetchRecord()
    TransferData XferDirection.ToForm
End Sub

Sub SaveRecord()
    TransferData XferDirection.ToDataSheet
End Sub

Sub TransferData(Direction As XferDirection)

    Dim rngMap As Range, rw As Range, f As Range, dataCell As Range
    Dim formCell As Range, dataCol As Long, dataRow As Long
    Dim sId As String

    sId = shtForm.Range("AG3").Value
    Set f = shtData.Columns(1).Find(sId, LookIn:=xlValues, lookat:=xlWhole)
    If Not f Is Nothing Then
        dataRow = f.Row
    Else
        'what do you want to do here?
        '  record doesn't exist on data sheet
        MsgBox "Record '" & sId & "' not found on '" & shtForm.Name & "' !"
        Exit Sub
    End If

    Set rngMap = shtMap.Range("A2:B10")

    For Each rw In rngMap.Rows
        'the cell on the edit form
        Set formCell = shtForm.Range(rw.Cells(1).Value)
        'column # on datasheet
        Set dataCell = shtData.Cells(dataRow, rw.Cells(2).Value)

        If Direction = XferDirection.ToDataSheet Then
            dataCell.Value = formCell.Value
        Else
            formCell.Value = dataCell.Value
        End If
    Next rw

End Sub 
```

# sql-server - 将垂直布局转换为水平布局sql

> ID：10321404
> 
> 赞同：2
> 
> 时间：2012-04-25T18:16:06.210
> 
> 标签：sql-server, matrix

我在 SQL 中有一个这样的表（它不是按顺序排列的）

```
A B         VAL                  VAL2
---------------------------------------------   
1 1 -2.1846000000000e+02  0.0000000000000e+00
2 2 -2.1846000000000e+02  0.0000000000000e+00
3 2  6.4000000000000e+01  0.0000000000000e+00
1 2  6.4000000000000e+01  0.0000000000000e+00
2 3  6.4000000000000e+01  0.0000000000000e+00
3 3 -2.1846000000000e+02  0.0000000000000e+00
3 1  6.4000000000000e+01  0.0000000000000e+00
2 1  6.4000000000000e+01  0.0000000000000e+00
1 3  6.4000000000000e+01  0.0000000000000e+00 
```

所以每个元组 A,B 代表矩阵的一个点我怎样才能将它转换成一个实际的矩阵，比如

```
A1                      A2                      A3
--------------------------------------------------------------------
-2.1846000000000e+02    6.4000000000000e+01     6.4000000000000e+01
6.4000000000000e+01     -2.1846000000000e+02    6.4000000000000e+01
6.4000000000000e+01     6.4000000000000e+01    -2.1846000000000e+02 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T18:27:09.047

这可以使用如下查询来完成：

```
select
  max(case when B = 1 then VAL end) as A1,
  max(case when B = 2 then VAL end) as A2,
  max(case when B = 3 then VAL end) as A3
from
  MatrixData D
group by
  A; 
```

要生成任意大小的矩阵，您需要动态生成的 SQL 代码，如下所示：

```
declare @sql varchar(5000)

select @sql = coalesce(@sql + ',' + char(13) + char(10), '') +
  'max(case when B = ' + cast(B as varchar(10))
    + ' then VAL end) as A' + cast(B as varchar(10))
from
  MatrixData D
group by
  B

set @sql =
  'select
    ' + @sql + '
  from
    MatrixData D
  group by
    A;'
exec(@sql) 
```

演示：[http ://www.sqlfiddle.com/#!3/7ee1e/13](http://www.sqlfiddle.com/#!3/7ee1e/13)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T18:28:16.947

给定表 M (x, y, v)

```
SELECT x, [1], [2], [3], [4], ...
FROM
(SELECT x, y, v FROM M) AS s
PIVOT
(
min(v)
FOR y IN ([1], [2], [3], [4], ...)
) AS pvt
order by x 
```

`, ...`表示根据需要继续该系列，但不要将其留在脚本中

演示：[http](http://www.sqlfiddle.com/#!3/7ee1e/17) ://www.sqlfiddle.com/#!3/7ee1e/ 17（感谢 mellamokb 的设置脚本）

# java - 如何使用 JPedal 从 pdf 文件中提取数据？

> ID：10321411
> 
> 赞同：0
> 
> 时间：2012-04-25T18:16:33.183
> 
> 标签：java, jpedal

实际上，我正在尝试从 PDF 文件中提取数据，但我在互联网上没有找到任何示例，我想问是否有可能使用 JPedal 库打开以读取 PDF 文件中的数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T19:01:04.050

您可以使用Apache 的[PDFBox](http://pdfbox.apache.org/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T23:42:14.413

我不熟悉 JPedal，但我编写了很多生成和处理 pdf 文件的代码。我使用[IText](http://itextpdf.com/)并强烈推荐它。如果您对如何处理 pdf 文件有具体问题，请告诉我。

# c++ - 朋友功能是否可以创建新对象？C++

> ID：10321413
> 
> 赞同：0
> 
> 时间：2012-04-25T18:16:38.213
> 
> 标签：c++, class, function, friend

您好，我正在尝试对学校系统进行一些模拟。

我想知道我是否有 2 个类： 1：校长 2：教师 那么校长类的方法是否可以创建教师类的新对象？

这是我想做的（方法 AddTeacher）：

```
class PRINCIPAL
{
    char* name;
    int wage;
    unsigned long long id;
public:
    void showinfo() const;
    PRINCIPAL();//constructor, but there will be overloaded constructors in this class;
    ~PRINCIPAL();
        void addTeacher(char* nameofobject,char* name,char* position,int wage, unsigned long long id);
    void removeTeacher(TEACHER& teacher); //method which will remove object of class TEACHER;
    void changeTEACHERSsalary(TEACHER& teacher);
    void changeTEACHERSposition(TEACHER& teacher);
}

class TEACHER
{
    char* name;
    char* position;
    int wage;
    unsigned long long id;
    friend class PRINCIPAL;
public:
    TEACHER(char* name,char* position,int wage, unsigned long long id);
    ~TEACHER();
    void gradeStudent(STUDENT& s,int grade,char* subject);
    void changestudentsgrade(STUDENT& s,char* subjectname,int oldgrade,int newgrade);
    void ViewStudentsAverageFromSubject(STUDENT& s, char* subjectname) const;
    void ViewStudentsAverage(STUDENT& s) const; // average from all subjects;
    void ViewClassAverage(KLASA& k) const; // average from all subjects of whole object KLASA(class);
    void ViewClassAverageSubject(KLASA& k,char* subjectname) const; // average from selected subject of whole object KLASA(class);
} 
```

另外我想问一下是否可以做以下事情：我想做一个约束，它只允许 Principal 类的一个对象存在。如果可能的话，你能解释一下怎么做吗？

先感谢您。

PS addTeacher 看起来像这样：

```
void addTeacher(char* nameofobject,char* name,char* position,int wage, unsigned long long id){
TEACHER nameofobject(char* name,char* position,int wage, unsigned long long id);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:41:56.873

校长要添加老师，删除老师是什么？你在某个地方需要一群老师。您缺少一个关键概念，即`SCHOOL`. 一所学校有一个校长，大概只有一个，所以校长成员可以很简单`PRINCIPAL principal;`

一所学校也有一群教师。这是 C++ 模板库容器类模板之一的尖叫。这为您提供了主体对象可以轻松地将教师添加到/从中删除教师的东西。

# c# - 将输入数据从一个表单传递到另一个表单的标签

> ID：10321414
> 
> 赞同：0
> 
> 时间：2012-04-25T18:16:40.330
> 
> 标签：c#, winforms, label

我在表单上有一些标签，其目的是保存来自另一个表单的用户输入的值，因此，我需要以编程方式设置标签文本，而不是使用属性窗口。我已经这样做了，但问题是数据似乎没有传递给其他形式。我尝试运行调试，但解决方案锁定了我，我必须从任务管理器中将其关闭。我在打开第二个表单的方法上设置了一个断点。我的想法是，当程序逐步执行该方法时，我可以查看属性是否填充了正确的信息。不幸的是，它没有逐步执行该方法，而是打开了表单并锁定了

我希望也许有人可以看看我的代码并告诉我哪里出错了。

用户输入所有数据后，他/她单击一个按钮，将其保存到数据库并显示一条消息，要求用户单击另一个按钮以转到另一个表单。这部分工作正常。这是该操作的事件处理程序代码：

```
private void btnEnterNutritionInfo_Click(object sender, EventArgs e)
{
    //call methods from NutritionBOL class to input calculated 
    //data into textboxes
    this.txtRMR.Text = Convert.ToString(busObject.GetRMRdata(
        busObject.BodyWeight));
    this.txtDailyActivityBurn.Text = Convert.ToString(
        busObject.GetDailyActivityBurnData(
        busObject.RestingMetabolicRate));
    this.txtEnergyAmount.Text = Convert.ToString(
        busObject.GetEnergyAmount(
        busObject.RestingMetabolicRate, busObject.DailyActivityBurn));
    this.txtYourNutritionLevel.Text = busObject.GetNutritionLevel(
        busObject.DailyEnergyAmount);

    //convert text box data and assign to variables
    busObject.BodyFatStart = double.Parse(this.txtBodyFatStart.Text);
    busObject.BodyFatEndOfPhase1 = double.Parse(this.txtBodyFatEndOfPhase1.Text);
    busObject.BodyFatEndOfPhase2 = double.Parse(this.txtbodyFatEndOfPhase2.Text);
    busObject.BodyFatEndOfPhase3 =  double.Parse(this.txtbodyFatEndOfPhase3.Text);             
    busObject.BodyWeight = double.Parse(this.txtBodyWeight.Text);
    busObject.RestingMetabolicRate = double.Parse(this.txtRMR.Text);
    busObject.DailyActivityBurn = double.Parse(this.txtDailyActivityBurn.Text);
    busObject.DailyEnergyAmount = double.Parse(this.txtEnergyAmount.Text);
    busObject.BodyFatStartNotes = this.txtStartNotes.Text;
    busObject.BodyFatEndOfPhase1Notes = this.txtBodyFatEndOfPhase1Notes.Text;
    busObject.BodyFatEndOfPhase2Notes = this.txtBodyFatEndOfPhase2Notes.Text;
    busObject.BodyFatEndOfPhase3Notes = this.txtBodyFatEndOfPhase3Notes.Text;
    busObject.NutritionLevel = this.txtYourNutritionLevel.Text;  

    //call method to save input data
    busObject.SaveData();

    //set visibility to true
    txtRMR.Visible = true;
    txtDailyActivityBurn.Visible = true;
    txtEnergyAmount.Visible = true;
    txtYourNutritionLevel.Visible = true;
    lblYourNutritionLevel.Visible = true;
} 
```

完成后，用户单击按钮转到另一个表单。此时，标签数据应该被传递给另一个表单。另一个表单打开，但标签数据未​​填写：这是该按钮单击的事件处理程序：

```
private void btnMeasurementData_Click(object sender, EventArgs e)
{
    //assign text boxes to properties 
    this.BodyFatB4 = this.txtBodyFatStart.Text;
    this.BodyWeightB4 = this.txtBodyWeight.Text;
    this.BodyFatAfter = this.txtBodyFatEndOfPhase1.Text;
    this.BodyWeightAfter = this.txtBodyWeight.Text;

    //instantiate an object from the MeasurementsBOL to pass data
    MeasurementsForm measurementsForm = new MeasurementsForm();
    measurementsForm.BodyFatB4 = this.BodyFatB4;
    measurementsForm.BodyWeightB4 = this.BodyWeightB4;
    measurementsForm.BodyFatAfter = this.BodyFatAfter;
    measurementsForm.BodyWeightAfter = this.BodyWeightAfter;

    //StartDate data is just being passed through to the 
    //MeasurementsForm from the FitnessTest form
    measurementsForm.StartDate = this.StartDate;            

    this.Hide();

    //method call to open MeasurementsForm
    busObject.GoToMeasurementsForm(this.StartDate, this.BodyFatB4,
        this.BodyWeightB4, this.BodyFatAfter, this.BodyWeightAfter);
} 
```

以下是打开 MeasurementsForm 的方法调用代码：

```
public void GoToMeasurementsForm(string startDate, string bodyFatB4,
    string bodyWeightB4, string bodyFatAfter, string bodyWeightAfter)
{
    MeasurementsForm f2;
    //logic to decide what to do if an instance is not already instanitated
    if (Application.OpenForms["MeasurementsForm"] == null)
    {
        f2 = new MeasurementsForm();
        f2.StartDate = startDate;
        f2.BodyFatB4 = bodyFatB4;
        f2.BodyWeightB4 = bodyWeightB4;
        f2.BodyFatAfter = bodyFatAfter;
        f2.BodyWeightAfter = bodyWeightAfter;
        f2.Name = "MeasurementsForm";
    }
    //logic to decide what to do if an instance is not already instantiated
    else
    {
        f2 = Application.OpenForms["MeasurementsForm"] as MeasurementsForm;
        f2.StartDate = startDate;
        f2.BodyFatB4 = bodyFatB4;
        f2.BodyWeightB4 = bodyWeightB4;
        f2.BodyFatAfter = bodyFatAfter;
        f2.BodyWeightAfter = bodyWeightAfter;
    }
        f2.Show();
} 
```

这是单击按钮时打开的表单的代码：

```
public partial class MeasurementsForm : Form
{
    //declare variables
    string bodyFatB4 = "",
           bodyWeightB4 = "",
           bodyFatAfter = "",
           bodyWeightAfter = "",
           startDate = "";

    //instantiate object from MeasurementsBOL class
    MeasurementsBOL busObject = new MeasurementsBOL();        

    //default constructor
    public MeasurementsForm()
    {
        InitializeComponent();
        busObject.InitializeConnection();
    }

    //properties for variables
    public string BodyFatB4
    {
        get { return bodyFatB4; }
        set { bodyFatB4 = value; }
    }

    public string BodyWeightB4
    {
        get { return bodyWeightB4; }
        set { bodyWeightB4 = value; }
    }

    public string BodyFatAfter
    {
        get { return bodyFatAfter; }
        set { bodyFatAfter = value; }
    }

    public string BodyWeightAfter
    {
        get { return bodyWeightAfter; }
        set { bodyWeightAfter = value; }
    }

    public string StartDate
    {
        get { return startDate; }
        set { startDate = value; }
    }

    private void Form1_Load(object sender, System.EventArgs e)
    {
        //pass text data from nutrition form to labels
        this.lblBodyFatB4FromNutrition.Text = this.BodyFatB4;
        this.lblWeightB4FromNutrition.Text = this.BodyWeightB4;
        this.lblBodyFatAfterFromNutrition.Text = this.BodyFatAfter;
        this.lblWeightAfterFromNutrition.Text = this.BodyWeightAfter;
    }

    //event handler for B4 input data
    private void btnEnterMeasurementsB4_Click(object sender, EventArgs e)
    {
        //convert input data and assign to variables
        busObject.BodyFatB4 = double.Parse(lblBodyFatB4FromNutrition.Text);
        busObject.BodyWeightB4 = double.Parse(lblWeightB4FromNutrition.Text);
        busObject.ChestMeasurementB4 = double.Parse(txtChestB4.Text);
        busObject.WaistMeasurementB4 = double.Parse(txtWaistB4.Text);
        busObject.HipsMeasurementB4 = double.Parse(txtHipsB4.Text);
        busObject.RightThighB4 = double.Parse(txtRightThighB4.Text);
        busObject.LeftThighB4 = double.Parse(txtLeftThighB4.Text);
        busObject.RightArmB4 = double.Parse(txtRightArmB4.Text);
        busObject.LeftArmB4 = double.Parse(txtLeftArmB4.Text);

        //call method to save input data
        busObject.SaveB4Data();

        //clear text boxes of data
        this.txtChestB4.Clear();
        this.txtWaistB4.Clear();
        this.txtHipsB4.Clear();
        this.txtRightThighB4.Clear();
        this.txtLeftThighB4.Clear();
        this.txtRightArmB4.Clear();
        this.txtLeftArmB4.Clear();

        //close form
        this.Close();            
    }

    //event handler for after input data 
    private void btnEnterMeasurementsAfter_Click(object sender, EventArgs e)
    {
        //convert input data and assign to variables      
        busObject.BodyFatAfter = double.Parse(lblBodyFatAfterFromNutrition.Text);
        busObject.BodyWeightAfter = double.Parse(lblWeightAfterFromNutrition.Text);
        busObject.ChestMeasurementAfter = double.Parse(txtChestAfter.Text);
        busObject.WaistMeasurementAfter = double.Parse(txtWaistAfter.Text);
        busObject.HipMeasurementAfter = double.Parse(txtHipsAfter.Text);
        busObject.RightThighAfter = double.Parse(txtRightThighAfter.Text);
        busObject.LeftThighAfter = double.Parse(txtLeftThighAfter.Text);
        busObject.RightArmAfter = double.Parse(txtRightArmAfter.Text);
        busObject.LeftArmAfter = double.Parse(txtLeftArmAfter.Text);

        //call method to save input data
        busObject.SaveAfterData();

        //clear text boxes of data
        this.txtChestAfter.Clear();
        this.txtWaistAfter.Clear();
        this.txtHipsAfter.Clear();
        this.txtRightThighAfter.Clear();
        this.txtLeftThighAfter.Clear();
        this.txtRightArmAfter.Clear();
        this.txtLeftArmAfter.Clear();

        //close form
        this.Close();
    }

    //event handler to open schedule form and hide this form
    private void btnClickForSchedule_Click(object sender, EventArgs e)
    {
        this.Hide();
        busObject.BackToMainSchedule(this.StartDate);
    }
} 
```

# android - 屏幕方向更改时未调用加载程序

> ID：10321417
> 
> 赞同：8
> 
> 时间：2012-04-25T18:16:49.927
> 
> 标签：android, android-asynctask

我在使用时遇到了一些麻烦`AsyncTaskLoader`，屏幕方向发生了变化。让我给你一些关于我的应用程序结构的背景信息：我有一个非常简单的应用程序，它从 url 获取结果并显示它。该应用程序由一个`FragmentActivity`和三个组成`Fragments`。我的三个片段如下：

*   第一个片段是一个编辑文本和一个提交输入的按钮。
*   第二个片段显示了一个加载微调器
*   当获取数据以显示结果时，第三个片段替换加载片段。

用于从`AsyncTaskLoader`内容提供者（如果已缓存）或网络加载数据。

一切都很好，直到屏幕改变！我查看了的输出，`LoaderManager.enableDebugLogging(true)` 似乎问题的根源是`LoaderCallbacks.onLoadFinished`在我的活动中没有被调用。

这是启动加载程序的一段代码：

```
/* This function is defined in the "first" fragment in an interface and
 * implemented in the activity */ 
@Override
public void onFormSubmission(String word) {                     

    showLoadingFragment();

    if ( mWord == null || mWord.equals(word) ) {
        getSupportLoaderManager().initLoader(0, word, this);
    } else {
        getSupportLoaderManager().restartLoader(0, word, this);
    }

    // Store the word
    mWord = word;
} 
```

显示结果的代码：

```
@Override
public void onLoadFinished(Loader<Bundle> loader, Bundle data) {
    // Validation and other stuff

      ResultFragment fragment = new ResultFragment();

      // Add the fragment to the 'result_fragment_container' FrameLayout
      getSupportFragmentManager()
            .beginTransaction()
            .setTransition(FragmentTransaction.TRANSIT_FRAGMENT_OPEN)
            .setCustomAnimations(android.R.anim.fade_in, android.R.anim.fade_out)
            // Replace loading fragment with the result
            .replace(R.id.result_fragment_container, fragment)
            .commitAllowingStateLoss(); 
} 
```

我尝试但失败的方法：

*   设置`setRetaininstance(true)`在片段中。
*   `android:configChanges="orientation|keyboardHidden|keyboard"`在清单中设置。

我没有想法，所以任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T02:21:32.647

嗨，我可以建议 2 种可能的解决方案：

**1）**从您的问题来看，我不完全确定您执行的进程从不在 AsyncTask 中调用 OnLoadFinished()。我假设是`Async`数据库调用或 Web 服务器调用等？

不管 onLoadFinished() 可能不会被调用，因为您的 Activity 在旋转时被销毁。您需要保存您在轮换之前更新的状态并`onDestroy()`调用

您可以尝试保留类变量状态标志。这是在您的“更新”`Async`任务中设置的，它标记您的`Async`任务是否仍在运行，即“更新”与否。

所以：

*   `bUpdating = true`当您的更新`async`任务开始时。即内 `onPreExecute()`
*   `bUpdating = false`当它完成时。即内 `onPostExecute()`

然后什么时候 `onDestroy()`被调用（总是在屏幕旋转之前调用）你可以检查`bUpdating`. `IF` `TRUE`然后您可以将所有已保存在`Async`任务中的详细信息保存在屏幕上，以`SharePreferences`

检查`onResume()`您的特定`SharePreferences`变量，如果它们存在，则`Async`再次启动更新。

所以简而言之，这将：

*   将详细信息保存到屏幕旋转`SharedPreferences` **之前**`onDestroy()`- - 如果布尔值表示异步任务正在运行。
*   `onResume()` **屏幕旋转**后**`SharedPreferences`检查并通过保存详细信息`Async`。**
***   在此之后，您应该保证您的`onLoadFinished()`方法被调用。**

 **可能还有一种更可靠的方法来检查屏幕旋转，我没有做太多。

**2）**当然，另一种选择是在您的特定活动上完全阻止屏幕旋转（因为真的，您需要在该屏幕上旋转吗？）。

我有一个在后台录制视频并上传 10 秒片段的应用程序。它给屏幕旋转和我的异步任务带来了很大的麻烦，所以我完全阻止了旋转，因为它完全没有必要。这是 AndroidManifest.xml 文件将屏幕方向锁定为纵向的代码：

```
 <activity 
        android:name="com.blah.YourActivity"
        android:label="Register"
        android:screenOrientation="portrait">
    </activity> 
```

我希望这可以帮助你

**编辑：**另外，知道屏幕正在旋转可能是更好的更明确的方法：

即这种代码：

```
public void onConfigurationChanged(Configuration newConfig) {
    super.onConfigurationChanged(newConfig);

    if (newConfig.orientation == Configuration.ORIENTATION_LANDSCAPE) {
        Log.e(TAG, "ORIENTATION_LANDSCAPE");
    } else if (newConfig.orientation == Configuration.ORIENTATION_PORTRAIT) {
        Log.e(TAG, "ORIENTATION_PORTRAIT");
    }
} 
```

取自这篇[文章的示例](https://stackoverflow.com/questions/9186767/android-screen-rotation-on-destroy-and-services-connundrum)

你可以把你的`SharePreferences`存档放在那里。但 onResume() 仍将用于从中获取您的详细信息。

还有一个[链接，`SharePreferences`](http://developer.android.com/reference/android/content/SharedPreferences.html)以防您以前没有使用过它

**Edit2!：**另一件事。我刚刚重新阅读了您的问题，您出于某种原因提到了“加载器”，我想到了这是在保存数据，而不是加载。`AsyncTaskLoader()`您是否尝试过在调用onResume() 时简单地重新调用？如果您不保存，那么您可以忽略我所说的关于保留数据的所有内容，`SharePreferences`因为您可以在 onResume() （在 Rotation 之后运行）再次启动加载异步任务

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T23:55:42.400

你应该`getSupportLoaderManager().initLoader(0, null, this);`输入`onActivityCreated` 方法。如果加载器已经存在，initLoader 将创建或重新连接加载器**

# asp.net - http和https技术的区别

> ID：10321419
> 
> 赞同：0
> 
> 时间：2012-04-25T18:16:55.243
> 
> 标签：asp.net

`Certificate/License/Registration`在启动网站之前是否需要使用`https`？

我想在`Global.asax`文件中使用提到的代码。

```
protected void Application_BeginRequest(Object sender, EventArgs e)
{
    Response.Redirect("https://" + Request.ServerVariables["HTTP_HOST"] 
+   HttpContext.Current.Request.RawUrl);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:27:01.693

首先，我认为你永远不会到达它，因为它会在`Application_BeginRequest`你重定向所有请求时一遍又一遍地循环......

如果请求来自非安全连接（http），那么您所追求的可能是重定向，不是吗？

为此，请查看请求是否来自以下连接：

```
 protected void Application_BeginRequest(object sender, EventArgs e)
  {
     if (!HttpContext.Current.Request.IsSecureConnection)
        Response.Redirect(HttpContext.Current.Request.Url.AbsoluteUri.Replace("http://", "https://"));
  } 
```

其次，HTTPS 协议需要启动并运行，否则会`ERR_SSL_PROTOCOL_ERROR`抛出错误。

在 Visual Studio 中，您可以轻松地在项目属性中**启用 https**

![在此处输入图像描述](../Images/9c5d254acc2dff55c9582a4a853b0735.png)

你会得到最不真实的警告

![在此处输入图像描述](../Images/632814f101fb3249719bc07da4dfbdc0.png)

由于 Visual Studio 生成（在安装时）一个默认的自签名证书。

在生产环境中，您将需要：

*   如果是内网应用，使用自签名证书即可
*   在互联网应用程序上，您确实需要购买 SSL 证书，现在它们越来越便宜......

* * *

*从你的评论*中，我自己现在有一些问题......

*   您了解 HTTPS 对客户端计算机和服务器之间的连接有什么作用吗？
*   您真的需要两者之间的安全连接吗？
*   您要保护什么样的数据？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:21:52.803

当您想使用[安全 HTTP](http://en.wikipedia.org/wiki/HTTP_Secure)（使用 HTTPS 协议）时，您说浏览器和服务器之间的流量是加密的。

这意味着您需要服务器上的证书，以便浏览器和服务器可以决定如何加密流量。

这与重定向无关，与您的服务器设置有关。

# php - 出现 PHP 致命错误

> ID：10321421
> 
> 赞同：-1
> 
> 时间：2012-04-25T18:17:01.120
> 
> 标签：php, fatal-error

我收到以下错误：PHP 致命错误：调用未定义函数 updateRecord()

我知道这意味着 PHP 无法找到我正在调用的函数。

我仔细检查了函数名的拼写和页面顶部的包含文件，两者都是正确的。我不确定为什么 PHP 不能识别包含文件中的函数。

这是代码：

```
include_once('../lib/updatesEngine_lib.php');//include the file with the function 
```

函数调用：

```
updateRecord($jobid); 
```

在updatesEngine_lib.php 中：

```
function updateRecord($jobid){//Code//} 
```

我不知道为什么这不起作用。特别是因为 updateEngine_lib.php 文件中还有其他结构相似的函数正在工作。

帮助！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-25T18:19:47.617

检查你的拼写第三次或直到你得到它的工作。
没有魔法。
如果它说“调用未定义的函数” - 就是这样。

顺便说一句，如果你从 updatesEngine_lib.php 调用这个函数会怎样——它有效吗？

# java - 无法从 JAR 文件中读取 TLD“META-INF/c.tld”

> ID：10321430
> 
> 赞同：5
> 
> 时间：2012-04-25T18:17:27.190
> 
> 标签：java, spring, jsp, tomcat, spring-mvc

我使用 STS 插件从 Spring 模板创建了一个 Spring MVC 项目。但是，当我运行应用程序时出现错误：

```
org.apache.jasper.JasperException: /WEB-INF/views/home.jsp(1,63) Unable to read TLD "META-INF/c.tld" from JAR file "file:/H:/workspace/.metadata/.plugins/org.eclipse.wst.server.core/tmp1/wtpwebapps/imgateway/WEB-INF/lib/jstl-1.2.jar": org.apache.jasper.JasperException: Failed to load or instantiate TagLibraryValidator class: org.apache.taglibs.standard.tlv.JstlCoreTLV 
```

有人遇到过这种问题吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-25T19:10:19.473

之前在 StackOverflow 上问过几次： [无法读取 TLD “META-INF/c.tld”](https://stackoverflow.com/questions/3452403/unable-to-read-tld-meta-inf-c-tld)

我曾经写过一个可能的答案：http: [//blog.flurdy.com/2010/07/jetty-tomcat-jsp.html](http://blog.flurdy.com/2010/07/jetty-tomcat-jsp.html)

根据您的项目是否使用 maven，您需要确保 jsp-api 不包括在内，而是由 Tomcat 提供，而不是由例如：

```
<dependency>
   <groupId>javax.servlet</groupId>
   <artifactId>servlet-api</artifactId>
   <version>2.5</version>
   <scope>provided</scope>
</dependency>
<dependency>
   <groupId>javax.servlet.jsp</groupId>
   <artifactId>jsp-api</artifactId>
   <version>2.1</version>
   <scope>provided</scope>
</dependency>
<dependency>
   <groupId>javax.servlet</groupId>
   <artifactId>jstl</artifactId>
   <version>1.2</version>
</dependency>
<dependency>
   <groupId>org.apache.tomcat</groupId>
   <artifactId>jasper-el</artifactId>
   <version>6.0.26</version>
</dependency> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-12T08:42:08.810

不要将 javax.servlet.jsp.jar 与你的 webapp 打包，它会混淆 tomcat :P

我们得到了完全相同的错误，从 WEB-INF/lib 中删除 javax.servlet.jsp.jar 对其进行了排序

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-24T17:24:17.883

我面临同样的情况，我意识到错误被抛出，*显然*，因为 JSTL 出了问题。由于 STS 模板依赖于 Maven2，因此您应该需要**从本地 Maven2 存储库中手动删除 JSTL 工件**。

**在 Windows 7** 中：删除文件夹`c:\Users\<Username>\.m2\repository\javax\servlet\jstl\`。

**在 Linux**中：删除文件夹`/home/<Username>/.m2/repository/javax/servlet/jstl/`

**注意：**这不是 STS 的错，它只是在从 Internet 下载工件时损坏。删除工件将*强制*Maven2 重新下载它。最后，从网络下载的任何工件/文件都可能发生这种情况。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-31T13:31:56.410

使用 Eclipse，请确保您安装了 'Maven Integration for Eclipse **WTP** ' 使用没有 WTP 的其他插件，eclipse 更改您的类路径并在您的 webapps 中包含 servlet-api.jar。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-07T00:35:02.380

今天我也有同样的默认设置。这是由*`servlet-api.jar`*and 引起的错误*`jsp-api.jar`*，您可能在开发代码中需要这两个，因此请确保它们出现在您的 pom.xml 中并提供。它看起来对我很好

```
<dependency>
    <groupId>javax.servlet</groupId>
    <artifactId>servlet-api</artifactId>
    <version>2.5</version>
    <scope>provided</scope>
</dependency>
<dependency>
    <groupId>javax.servlet.jsp</groupId>
    <artifactId>jsp-api</artifactId>
    <version>2.1</version>
    <scope>provided</scope>
</dependency> 
```

# javascript - 使自动帖子正常工作的困难

> ID：10321431
> 
> 赞同：0
> 
> 时间：2012-04-25T18:17:29.403
> 
> 标签：javascript, facebook, facebook-graph-api

在我的网络应用程序中，当用户在我的应用程序中提交页面时，我会执行以下与 facebook 相关的代码：

```
<SCRIPT>
function SCRIPTRUN3() {
 FB.login(function(response){
   if (response.authResponse) {
     console.log('Welcome!  Fetching your information.... ');
     FB.api('/me', function(response) {
       console.log('Good to see you, ' + response.name + '.');
    var workedOK = 'YES';
     });
    if (workedOK != 'YES') {
        SCRIPTRUN4();
        var workedOK = 'NO';
    };
    SCRIPTRUN5();
   } else {
     console.log('User cancelled login or did not fully authorize.');
};
   }, {scope: 'publish_stream'});
</SCRIPT> 
```

调用：

```
<SCRIPT language="JavaScript">
function SCRIPTRUN5() {
   var body = "<Computed Value>";
   FB.api('/me/feed', 'post', { message: body }, function(response) {
   if (!response || response.error) {
            alert('Error occured: ' + response.error.message);
   } else {
     alert('An announcement was successfully posted to your Facebook wall.');
   }
 });
}
</SCRIPT> 
```

当代码执行时，我收到以下错误消息：

“发生错误：必须使用活动访问令牌来查询有关当前用户的信息。”

随后是：“一条公告已成功发布到您的 Facebook 墙上。”

我是否执行了错误的代码？代码太多？代码不够？当他们在我的网站上发布文档时，我试图在用户的 Facebook 墙上发布公告。

任何帮助将非常感激。我真的对这个 facebook 编码一无所知。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T11:56:22.520

调用 FB.api 时需要传递 access_token 参数，可以在 authResponse 对象中找到。

# c - char *envp[] 作为 main() 的第三个参数是否可移植

> ID：10321435
> 
> 赞同：75
> 
> 时间：2012-04-25T18:17:36.930
> 
> 标签：c, environment-variables, main, portability, function-signature

为了在`C`程序中获取环境变量，可以使用以下内容：

*   `getenv()`
*   `extern char **environ;`

但除了上面提到的之外，是否使用`char *envp[]`作为第三个参数来`main()`获取被视为标准一部分的环境变量？

```
#include <stdio.h>

int main(int argc, char *argv[], char *envp[])
{
    while(*envp)
        printf("%s\n",*envp++);
} 
```

`char *envp[]`便携吗？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-04-25T18:20:19.537

该函数`getenv`是 C 标准中唯一指定的函数。function[`putenv`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/putenv.html)和 extern[`environ`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/environ.html)是 POSIX 特定的。

### 编辑

该`main`参数`envp`未由 POSIX 指定，但得到广泛支持。

> 访问环境列表的另一种方法是向 main() 函数声明第三个参数：
> 
> ```
> int main(int argc, char *argv[], char *envp[]) 
> ```
> 
> 然后可以以与 environ 相同的方式处理此参数，不同之处在于它的范围是 main() 的本地。尽管此功能在 UNIX 系统上广泛实现，但应避免使用它，因为除了范围限制外，**SUSv3 中没有指定它**。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-04-25T18:22:23.507

它不是便携式的。`*envp[]`是传统的 UNIX 事物，并非所有现代 UNIX 系统都实现它。

另外作为旁注，您可以通过指针遍历来访问 envp `*argv[]`，使其溢出......但我认为这不能被视为*安全*编程。如果您查看进程内存映射，您会看到`envp[]`上面的内容`argv[]`。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-04-25T18:20:45.073

该标准描述了两种格式`main`（参见[C99 标准 (pdf)](http://www.open-std.org/JTC1/sc22/wg14/www/docs/n1256.pdf)中的 5.1.2.2.1 ）

一种）`int main(void)`

和

b)`int main(int argc, char **argv)`或同等学历

它允许实现定义其他格式（可以允许第三个参数）

c) 或以其他一些实现定义的方式。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-07-30T11:35:07.607

第三个参数在 Microsoft C 和 GNU GCC 中有效：

[Visual Studio 2015：主要参数](https://msdn.microsoft.com/en-us//library/k104fy6h.aspx)

[GNU C 编程教程：环境变量](http://crasseux.com/books/ctutorial/Environment-variables.html)

# php - jquery验证远程功能

> ID：10321444
> 
> 赞同：0
> 
> 时间：2012-04-25T18:18:10.660
> 
> 标签：php, jquery, validation

我在表单中使用了验证插件，但我在使用远程功能时遇到了一些困难。

我正在使用它来将 ajax 发布到一个文件，该文件又返回 true 或 false。当我输入使用或使用用户名的电子邮件时，它会警告正确的错误消息。

但是当 ajax 返回 true 时，它​​不会做任何事情。也就是说，直到我单击电子邮件输入框，然后单击退出以重新触发它。然后它将验证它。我尝试了很多不同的解决方案，比如 onblur 触发器等。事情是，所有其他输入字段都可以开箱即用，没问题。检查邮件文件非常直接，呼应真假，没有真正的问题..

这是一个电子邮件检查和一个用户名检查，两者的规则是相同的，除了它调用的文件：

```
$("#registerHere").validate({
onkeyup: false,  
onblur: true,
rules:{
                    usr_name: {
                    required: true,
                     minlength: 5,
                    remote: {
                    url: "inc/checkuser2.php",
                    type: "post",
                    async: false
                                    }
                    },
                    full_name:"required",
                    blog_name:"required",

user_email: {
    required: true,
    email: true,
    remote: {
        url: "inc/checkmail.php",
        type: "post",
        async: false,
        data: {
            user_email: function() {
                return $("#user_email").val()
            }
        }
    }
},
                    pwd:{
                        required:true,
                        minlength: 6
                    },
                    cpwd:{
                        required:true,
                        equalTo: "#pwd"
                    },
                    gender:"required"
                },

                messages:{
                    usr_name:{
                    required: "Velg et brukernavn",
                    minlength: "Minimum 5 bokstaver",
                    remote: "Dette brukernavnet er opptatt"
                    },

                    full_name:"Skriv inn navnet ditt",
                    blog_name:"Velg en tittel til bloggen din",

                    user_email:{
                        required: "Fyll inn e-post adressen din",
                        email:"Dette er ikke en gyldig e-post adresse",
                        remote:"Denne e-posten finnes allerede"
                    },
                    pwd:{
                        required:"Velg passord",
                        minlength:"Passordet må ha 6 tall og bokstaver"
                    },
                    cpwd:{
                        required:"Gjenta passordet",
                        equalTo:"Passordene er ikke like"
                    },
                    gender:"Velg kjønn"
                },

                errorClass: "help-inline",
                errorElement: "span",
                highlight:function(element, errorClass, validClass) {
                    $(element).parents('.control-group').addClass('error');
                },
                unhighlight: function(element, errorClass, validClass) {
                    $(element).parents('.control-group').removeClass('error');
                    $(element).parents('.control-group').addClass('success');
                }

            }); 
```

这是我的 checkmail.php （一旦工作就会清理）：

```
$duplicate = mysql_query("select count(*) as total from users where user_email='$user' ") or die(mysql_error());
    list($total) = mysql_fetch_row($duplicate);
        if ($total > 0)
        {
    $valid = 'false';
        } else {
    $valid = 'true';
        }
    echo $valid;
    exit; 
```

这并不重要，因为表单似乎已提交，但当我离我想要的如此接近时，我会讨厌这样离开它！

希望这是可以理解的，当我阅读并尝试了谷歌给我的一切时，我真的很感激任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T21:21:37.000

我相信当涉及到表单验证插件中的 AJAX 时，您需要使用回调并返回元素。

```
onkeyup: function(element) {
    this.element(element);
} 
```

这样做的缺点是它会在每次按键时执行你的 AJAX，所以你需要在你的回调中执行某种检查。例如：

```
onkeyup: function(element) {
    if ( element.type == 'password' )
        this.element(element);
    else
        return true;
} 
```

# asp.net - 网站中图像的文件（文件夹）结构应该是什么？

> ID：10321448
> 
> 赞同：-1
> 
> 时间：2012-04-25T18:18:23.773
> 
> 标签：asp.net

我正在 ASP.Net 中开发一个项目，用户可以分享他们旅行的照片。用户将有不同的旅行，例如东京 - 11-01-2011，悉尼 - 19-02-2012。那么存储这些图像的最佳结构是什么？

1.  将所有图像存储在一个名为“用户旅行照片”的文件夹中。
2.  为每个用户的照片创建特定文件夹。
3.  为每次旅行创建特定文件夹。

我的问题不仅仅是关于这个项目。我想知道网站中的图像结构应该是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:50:02.150

如果您计划最终保存大量图像，您可能需要考虑重组文件夹结构以加快图像检索速度。当系统必须查看文件系统上超过 2K 的文件列表时，将所有图像存储在一个文件夹中最终会减慢速度。

我看到它分解的一种方法是：假设您的每个站点用户都有一个唯一的 id，您可以使用它来构建您的文件夹。例如，用户的照片（id 12345）将位于 UploadedImages/1/2/3/4/5/12345 中。如果您以这种方式分解文件夹结构，系统将只需要遍历每个文件夹中最多大约 10 个子文件夹即可找到它正在寻找的那个。

这对您的项目可行吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:29:26.380

在一个类似的项目中，我将我的 ASP.NET 网站图像，即徽标、页眉徽标、与未上传的内容或在我的情况下自动生成的图像（在我的情况下为图表）有关的任何内容保存在 root/images 中。我在项目的根目录中为那些添加到站点的图像创建了一个名为 GlucoseProfiles 的单独目录，它对我来说非常有用。在您的情况下，也取决于图像加载（即您的网站上是否有 < 100k .jpgs/etc），我只需创建一个新的图像目录，该目录特定于将添加到您网站的单独图像文件夹。

# yum - YUM 包依赖于 uname -m 或 uname -i

> ID：10321449
> 
> 赞同：0
> 
> 时间：2012-04-25T18:18:27.477
> 
> 标签：yum

我一直在尝试在客户的机器上使用 yum thru shell 脚本安装 libstdc++ 软件包。我需要确认 yum 是否会在用户机器中列出 i686 或 i386 包，我的意思是 yum 会检查 'uname -p' - 处理器信息或 'uname -i' - 硬件平台 ..？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T12:22:23.170

据我检查，yum 似乎依赖于处理器架构，uname -p。

# php - 无法让 php mail() 工作

> ID：10321450
> 
> 赞同：0
> 
> 时间：2012-04-25T18:18:28.287
> 
> 标签：php, apache, email, mamp

我在我的 Mac 上运行了 Mamp 并试图让 mail() 工作。

这就是我必须解决的问题。

```
$to = 'mymail@gmail.com';
$subject = 'The subject!';
$message = 'Hi there!';

$headers  = 'MIME-Version: 1.0' . "\r\n";
$headers .= "X-Mailer: PHP/".phpversion();
$headers .= 'From: Test <test@test.com>' . "\r\n";
$headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";

// Mail it
if(mail($to, $subject, $message, $headers))
{ print 'success!'; }
else
{ print 'fail!'; }

?> 
```

它只是不断返回错误。知道我做错了什么吗？我需要检查一些 php/apache 的设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T20:39:08.077

如果您在本地主机上使用您的代码段，请放在服务器上然后尝试。php mail() 函数需要在服务器上才能工作。在本地主机上，您总是失败！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:22:49.060

试试这个：

```
<?php
$Name = "Da Duder"; //senders name
$email = "email@adress.com"; //senders e-mail adress
$recipient = "PersonWhoGetsIt@emailadress.com"; //recipient
$mail_body = "The text for the mail..."; //mail body
$subject = "Subject for reviever"; //subject
$header = "From: ". $Name . " <" . $email . ">\r\n"; //optional headerfields

ini_set('sendmail_from', 'me@domain.com');

mail($recipient, $subject, $mail_body, $header);
?> 
```

[http://be.php.net/manual/en/function.mail.php](http://be.php.net/manual/en/function.mail.php)

每行文本不得超过 70 个字符，需要用 LF (\n) 截断

编辑：正如@brad 建议的那样：SwiftMailer 真的很棒！

# c# - 如何避免或检测 C# 中的隐式委托推断？

> ID：10321451
> 
> 赞同：6
> 
> 时间：2012-04-25T18:18:41.253
> 
> 标签：c#, delegates, implicit, garbage

我正在使用 C# 编写游戏，并且发现了许多情况，其中一个函数接受一个委托，而我无意中传递了一个函数名称，而不是创建和缓存一个委托以用作参数。这会导致为每次调用这些函数创建一个委托对象，然后在函数返回时立即成为垃圾。

我想找到我犯了这个错误的所有地方，并且我宁愿避免阅读每个文件的每一行来寻找它们（有很多年的代码）。我看到 VB 有一个“选项严格”，它将禁用对象的隐式构造，如果 C# 具有该功能，我认为这对我有用，但我不认为它有。我还查看了编译器警告选项，但它们似乎也无济于事。

是否有任何相当方便的方法来识别隐式委托推断创建的这些对象，以便我可以找出我需要在哪里创建/缓存回调以避免垃圾？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-25T18:27:23.160

简而言之，您的问题是“我怎样才能找到所有方法组转换？”

我们目前正在开发一个代号为*Roslyn*的项目，它允许您使用与 C# 编译器和 IDE 相同的语义分析引擎。它将暴露语言的*句法*模型，然后提供*语义分析 API*，您可以通过该 API 向语义分析器提问。

使用 Roslyn，您可以将所有代码编译成语法树，然后在这些语法树中搜索每个表达式。将有一个 API 允许您确定表达式是否被转换为任何内容，如果是，转换分析器如何对转换进行分类。

我们目前处于“社区技术预览”阶段；我们有一个初步的实现，但它还远未完全发挥作用。我不记得方法组转换分析器是否在 CTP 版本中实现。

试一试，如果您对此有任何反馈，我们很乐意在 Roslyn 论坛上听到您的想法。

详情在这里：

[http://msdn.microsoft.com/en-us/roslyn](http://msdn.microsoft.com/en-us/roslyn)

# php - xPath、DOM 和节点列表

> ID：10321454
> 
> 赞同：0
> 
> 时间：2012-04-25T18:18:55.973
> 
> 标签：php, dom, xpath, domdocument

当我在 PHP 代码中使用 xPath 查询 HTML 文档时，我尝试从 DOMNodeList 中读取以下 HTML。这是我的查询`$description = $xpath->query("//div[@class='qsc-html-content']");` ，我希望我能够获取第二个 div 中的所有内容。我是 PHP 中 xPath 的新手。问题是当我尝试以下任何事情时：

```
 if(isset($description) && is_object($description)){
        echo "DESCIPTION SET";
        echo $description->tagName;

        //echo $description->getElementsByTagName("p");
        $productInfo['description'] = trim($description->nodeValue);            
    } 
```

我没有得到任何结果。

```
<div class="product-description ">
<div class="qsc-html-content">
    <p><span class="Apple-style-span" style="background-color: #ffffff; font-family: Verdana, sans-serif;">Farida is a new and upcoming brand in the hookah market which specializes in solid brass hookahs. The designs are very unique and have not been seen in the hookah industry before. </span>This hookah stand about&nbsp;36".</p>
    <ul>
    <li>Farida&nbsp;hose</li>
    <li>Tongs, Grommets, Bowl, &amp; Farida Gold Tray</li>
    </ul>
    <p><span style="color: #ff0000;"><strong><span style="font-size: x-small;">Please Not: </span></strong></span></p>
    <p>&nbsp;Glass bases are mouth blown and sometimes have air bubbles as evidence of this fact. <span style="font-size: xx-small;">Artisans hand paint each glass base, making every one as unique as the artist. This results in a 100% unique finished product that may not look identical to the photo. It also means that sometimes the paint may have a slight smudge, a line may not be perfectly straight, or you may see the artist's brush strokes.</span></p>
    <p>Egyptian products are handmade in a traditional manner. Because these hookahs are handmade, there are usually slight variations from hookah to hookah. Most hookahs contain visible weld lines or unpolished metal at the welds.</p>
    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #ff0000;">FREE STARTER KIT INCLUDES:</span> 1 Holland Charcoal, 10 Mouth Tips, and 2 AL Fakher 50g Tobbacos Select Flavors</p>
    <p><img alt="" height="55" src="media/round tablets.jpg" width="103" />&nbsp;&nbsp;&nbsp;<img alt="" height="81" src="media/male_mouth_tips.jpg" width="109" /> <img alt="" height="86" src="media/d_al_fakher_50g.jpg" width="126" />&nbsp;&nbsp;&nbsp;&nbsp;</p>
</div> 
```

有人可以请指导我哪里错了。还有另一个问题，我试图通过 xPath 查询获取锚标记列表，结果只返回单个锚。

在过去的两个小时里，我一直在努力解决这个问题。我现在筋疲力尽。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T18:37:19.263

结果`$xpath->query(...)`是一个 DOMNodeList 对象。它不是单个元素，因此使用：

```
echo $description->tagName; 
```

是错的。相反，您应该迭代结果，如下所示：

```
$description = $xpath->query("//div[@class='qsc-html-content']");
foreach ($description as $item) {
    echo $item->tagName . "\n";
} 
```

# c# - Web服务序列化复杂对象

> ID：10321456
> 
> 赞同：1
> 
> 时间：2012-04-25T18:19:12.187
> 
> 标签：c#, web-services, serialization, web, known-types

我有一个带有`Class1`. `Class1`有一个属性的图像列表

```
[Serializable]
[SoapInclude(typeof(Bitmap))]

public class Class1
{
    private static List<Image> _myList = new List<Image>();

    public List<Image> MyList
    {
        get { return _myList; }

        set
        {
            _myList = value;
        }
    }
} 
```

进行 get on 时`MyList`，会发生以下错误。有任何想法吗？

> System.Web.Services.Protocols.SoapException：服务器无法处理请求。---> System.InvalidOperationException：生成 XML 文档时出错。---> System.InvalidOperationException：类型 System.Drawing.Bitmap 不是预期的。使用 XmlInclude 或 SoapInclude 属性指定静态未知的类型。在 Microsoft.Xml.Serialization.GeneratedAssembly.XmlSerializationWriter1.Write5_Class1（字符串 n、字符串 ns、Class1 o、 Microsoft.Xml.Serialization.GeneratedAssembly.XmlSerializationWriter1.Write6_HelloWorldResponse(Object[] p) 中 Microsoft.Xml.Serialization 中的 Boolean isNullable, Boolean needType)。
> 在 System.Web.Services.Protocols.SoapServerProtocol.WriteReturns(Object[] returnValues, Stream outputStream) 在 System.Web.Services.Protocols.WebServiceHandler.WriteReturns(Object[] returnValues) 在 System.Web.Services.Protocols.WebServiceHandler。 Invoke() --- 内部异常堆栈跟踪结束 ---

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T18:37:17.420

我在以下网址找到了答案。我需要 [XmlInclude] 标签而不是 [SoapInclude] 标签

[对 XmlSerializer 的常见问题进行故障排除](http://msdn.microsoft.com/en-us/library/aa302290.aspx)

```
 [Serializable]
    [XmlInclude(typeof(Bitmap))]
    public class Class1
    {

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:31:19.187

根据[**文档**](http://msdn.microsoft.com/en-us/library/system.xml.serialization.soapincludeattribute.aspx)中的示例，我相信您必须`[SoapInclude]`在实际的 SOAP WebService 方法上应用该属性：

```
public class MyService : WebService {

    [SoapInclude(typeof(Bitmap))]
    public List<Image> GetImageList() {
        // code here
    }

} 
```

# yii - 使用 CGridView 在 X 记录后强制打印分页符

> ID：10321463
> 
> 赞同：0
> 
> 时间：2012-04-25T18:19:39.177
> 
> 标签：yii

我使用 CGridView 从数据库查询中呈现结果（发票行）。这是在 html 页面内完成的，该页面稍后会使用和打印`<div>`转换为 PDF 。`wkhtmltopdf`问题是今天我不支持分页符，因此如果发票行数大于 10，则其余行不可见。我不能让 div 流动，因为我有一个绝对位置不能移动的发票页脚。

有没有办法强制分页并继续在单独的页面上呈现行？

下面是使用的 CGridView 代码的一部分。

```
<...plenty of html---->
<div class="invoiceRow">
<?php

$this->widget('zii.widgets.grid.CGridView', array(
    'dataProvider' => $dpRows,
    'cssFile' => Yii::app()->request->baseUrl . '/css/invoice.css',
    'summaryText' => '',
    'enablePagination' => false,
    'columns' => array(
        'number',
        'name',
        'description',
        'amount',
        array (
            'name'=>'value',
            'header' => 'netprice',
            'value' => 'number_format($data->value,2,","," ")'
        ),
    ));
?>
</div>
<---more html -----> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T23:28:05.597

如果 wkhtml 能够解析 css（看起来如此），您可以尝试：

```
<div style="page-break-after:always">
    //X invoices here
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-08T08:46:13.693

```
if(!empty($model))
{
if($model->content_type==1)
{
    $sentences = explode ('<div style="page-break-after: always;"><span style="display:none">&nbsp;</span></div>',$model->content);
    ?>
    <div id="datashow">
        <?php
        echo $sentences[0];
        ?>
    </div>
    <?php
    $dummy=array();
    $kcnt=preg_match_all('/page-break-after: always/', $model->content,$dummy);
    // echo $model->content;
}

<script>
    $("#pagebreakdiv").find(":button").click(function () {
        var datashow=$('#datashow');
        var a=this.value;
        var bid='<?php echo $bid; ?>';
        var id='<?php echo $id; ?>';
        var pdata = {};
        pdata["bitt"] = a;
        pdata["bid"] = bid;
        pdata["id"] = id;
        $.ajax(
            {
                url : "<?php echo Yii::app()->request->baseUrl; ?>/UserSimple/Contentpagebreak",
                type: "POST",
                data : pdata,
                success:function(data, textStatus, jqXHR)
                {
                    datashow.html(data);
                },
                error: function(jqXHR, textStatus, errorThrown)
                {

                }
            });
    });
</script> 
```

# php - 无法加载 mbstring 模块

> ID：10321467
> 
> 赞同：2
> 
> 时间：2012-04-25T18:19:47.100
> 
> 标签：php, windows, mbstring

在 CLI 中运行脚本我收到此错误：

```
PHP Fatal error:  Call to undefined function mb_detect_encoding() <script path/name here> 
```

一些背景。

```
PHP 5.3.10 (cli) (built: Feb  2 2012 20:27:51) 
```

使用 MySQL 和 Apache2.2（目前都可以使用）运行 Windows 7（称之为工作约束）

我知道这个函数是模块 php_mbstring.dll 的一部分

我将尝试一个详尽的清单来加载它：

*   已验证的 php.ini 位置；phpinfo 表示加载的文件在c:\php；配置文件位于 c:\windows 中（两个位置 - 都具有相同的 .ini 文件）
*   php.ini 文件有未注释的 extension=php_mbstring.dll
*   扩展目录在两个 php.ini 文件中都指定为 extension_dir = "c:\php\ext"
*   指定的文件 (php_mbstring.dll) 实际上存在于指定的目录 c:\php\ext\php_mbstring.dll
*   虽然我不明白为什么这会有效，但我已将 dll 移至 php 根目录以及 windows32 目录，如在其他论坛上看到的那样
*   我确实以相同的方式加载了其他功能性非核心模块（例如mysqli）而没有问题

可能值得注意的是，在加载的配置文件 (c:\php\php.ini) 中取消注释扩展行后，会出现一个附加的系统错误“无法启动，因为您的计算机中缺少 php5.dll”对话框。我尝试在两者中都取消注释并得到相同的错误。

我怀疑有一种方法可以在不重新编译或重新安装 PHP 的情况下加载此模块。

# sql - 如何在 AVG 函数中使用别名

> ID：10321472
> 
> 赞同：2
> 
> 时间：2012-04-25T18:20:12.797
> 
> 标签：sql, database, select, average

我在下面有以下代码，我正在尝试获取 3 列的 AVG。

```
 SELECT 
    (SUM(score) * .3) As score_a,
    (SUM(score) * .6) As score_b,
    (SUM(score) * .8) As score_c

     --now I want to get the AVG of the above scores
    AVG(score_a + score_b + score_c) As avg_score
 FROM score_table 
```

但这不起作用。我得到的错误是“无效的列名 score_a”。我正在使用 SQL Server 2008

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T18:29:41.323

`AVG()`是一个聚合函数，它从多***行***中获取值并给出它们的平均值。

您正在尝试平均 3 ***columns***。

在您的具体情况下，可以使用代数来完成。

```
SELECT 
  (SUM(score) * .3)                       As score_a,
  (SUM(score) * .6)                       As score_b,
  (SUM(score) * .8)                       As score_c,
  (SUM(score) * ((0.3 + 0.6 + .8) / 3.0)) As score_avg
FROM
  score_table 
```

在更一般的情况下，您会受到以下事实的限制：您无法引用刚刚在另一列中定义的列......

```
SELECT
  a + 1      AS inc_a,
  inc_a * 2  AS this_is_invalid
FROM
  your_table 
```

您要么需要重复自己，要么使用子查询...

***重复***

```
SELECT 
  (SUM(score) * .3)                                                 As score_a,
  (SUM(score) * .6)                                                 As score_b,
  (SUM(score) * .8)                                                 As score_c,
  ((SUM(score) * .3) + (SUM(score) * .3) + (SUM(score) * .3)) / 3.0 As score_avg
FROM
  score_table 
```

***子查询***

```
SELECT
  score_a,
  score_b,
  score_c,
  (score_a + score_b + score_c) / 3.0 AS score_avg
FROM
(
  SELECT 
    (SUM(score) * .3)                                               As score_a,
    (SUM(score) * .6)                                               As score_b,
    (SUM(score) * .8)                                               As score_c
  FROM
    score_table
)
  AS data 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:23:54.043

你能试试：

```
 SELECT 
    (SUM(score) * .3) As score_a,
    (SUM(score) * .6) As score_b,
    (SUM(score) * .8) As score_c,
    AVG(score_a + score_b + score_c) As avg_score
 FROM score_table 
```

看看这对你有用吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T18:24:20.347

有手动进行平均的蛮力方法，但它不会像您添加列一样缩放。:)

```
SELECT CAST((score_a + score_b + score_c) / 3 AS DECIMAL(20,2)) As avg_score,
       score_a,
       score_b,
       score_c
FROM (
    SELECT (SUM(score) * .3) As score_a,
           (SUM(score) * .6) As score_b,
           (SUM(score) * .8) As score_c
    FROM score_table
    GROUP BY userid, gameid --Whatever you're grouping by here!
) 
```

# jquery - Jquery - 从#hash标签检测div并显示选定的菜单li

> ID：10321473
> 
> 赞同：1
> 
> 时间：2012-04-25T18:20:15.270
> 
> 标签：jquery, list, menuitem, selected

首先，我的英语不是那么好——但我会尽量让自己易于理解。

我正在制作一个带有 jQ​​uery 视差滚动效果的网站（类似于 nikebetterworld.com 网站）——而且它越来越好。但现在在这个过程中，我发现了一些可以为导航增加一些价值的东西。

导航放置在屏幕的左侧 - 我的问题是：我如何制作一个菜单（ul li a），单击时将显示选定的菜单列表项，如果您向下滚动网站，我该如何制作它通过#hash 标记显示与其相关的网站部分。

我希望我的问题是可以理解的？

现在它看起来像这样：

```
<ul id="nav">
    <li><a href="#intro" title="Next Section"><img src="images/dot.png" alt="Link" /></a></li>
    <li><a href="#second" title="Next Section"><img src="images/dot.png" alt="Link" /></a></li>
    <li><a href="#third" title="Next Section"><img src="images/dot.png" alt="Link" /></a></li>
    <li><a href="#fifth" title="Next Section"><img src="images/dot.png" alt="Link" /></a></li>
</ul> 
```

所以我想要的是让 jQuery 通过突出显示列表项之一来显示用户“打开”的页面的哪一部分。

你们能帮我:)吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:53:27.680

[有一个名为ScrollSpy](https://github.com/sxalexander/jquery-scrollspy)的 jQuery 模块可以执行此操作 - 您可以在[Twitter Bootstrap](http://twitter.github.com/bootstrap/javascript.html#scrollspy)中看到它的运行情况。

# symfony - Symfony2：将表单实体字段类型显示为单选按钮

> ID：10321475
> 
> 赞同：3
> 
> 时间：2012-04-25T18:20:19.997
> 
> 标签：symfony, symfony-forms

我正在尝试使用单选按钮显示所有类别（来自我的表类别）。有 3 个类别，但在 Doctrine 查询 OK 时只显示一个单选按钮。

我的表单类型代码：

```
public function buildForm(FormBuilder $builder, array $options)
{
    $builder->add('categories', 'entity', array(
        'class' => 'MyBundle:Category',
        'expanded' => true,
        'property' => 'title',
        'property_path' => false,
    ));
} 
```

我的树枝代码：

```
{{ form_widget(form) }} 
```

结果应该返回 3 个单选按钮，但我只看到一个单选按钮（表中的第一个）。

Symfony 分析器（调试栏）中显示的 Doctrine 查询完美执行并返回 3 行。

也许问题来自我必须添加的“property_path”，否则我有一个异常：

```
Neither property "categories" nor method "getCategories()" nor method "isCategories()" exists in class ... 
```

请问有什么帮助吗？

非常感谢 ：-）

奥雷尔

编辑 ：

这是删除“property_path”时与此请求对应的我的dev.log：

```
[2012-04-26 07:27:01] doctrine.DEBUG: SELECT t0.id AS id1, t0.last_update AS last_update2, t0.title AS title4 FROM category t0 ([]) [] []
[2012-04-26 07:27:01] event.DEBUG: Notified event "kernel.exception" to listener "Symfony\Component\Security\Http\Firewall\ExceptionListener::onKernelException". [] []
[2012-04-26 07:27:01] event.DEBUG: Notified event "kernel.exception" to listener "Symfony\Component\HttpKernel\EventListener\ProfilerListener::onKernelException". [] []
[2012-04-26 07:27:01] event.DEBUG: Notified event "kernel.exception" to listener "Symfony\Component\HttpKernel\EventListener\ExceptionListener::onKernelException". [] []
[2012-04-26 07:27:01] request.CRITICAL: Symfony\Component\Form\Exception\InvalidPropertyException: Neither property "categories" nor method "getCategories()" nor method "isCategories()" exists in class "Acme\MyBundle\Entity\Category" (uncaught exception) at /www/vendor/symfony/src/Symfony/Component/Form/Util/PropertyPath.php line 316 [] [] 
```

我真的不明白为什么它拒绝显示我的类别表的每一行......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T12:44:16.323

问题是我的实体设置不正确。该`$id`字段是布尔值而不是整数。

# ios - iOS开发——无限关卡的uitableview

> ID：10321478
> 
> 赞同：2
> 
> 时间：2012-04-25T18:20:29.053
> 
> 标签：ios, uitableview

我在具有可变深度的树结构中有 XML 数据。有时数据馈送的深度可能为 50 级，而其他时候则为 5 级。

我应该为视图使用哪个 iOS UI 组件？我看到了 uitableview，但在打印叶节点之前它似乎只支持树的 1 级。我应该考虑另一个 UI 组件吗？如果没有，我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:42:56.390

如果这是针对 iPhone 的，我肯定会建议标准的 UINavigationViewController 在每个级别都带有 UITableView。这是处理层次结构的标准 iPhone 方式。

在 iPad 上，弹出窗口（或侧导航）有一个等效项。这没关系——你可以使用它。

如果这是您的应用程序的主要关注点，您可能想要做一些自定义以利用更大的屏幕。

# java - 使用 android 和外部证书进行 SSL 身份验证

> ID：10321481
> 
> 赞同：0
> 
> 时间：2012-04-25T18:20:40.833
> 
> 标签：java, android, ssl

我需要做这件事：

1.  使用 ssl 从 android 终端到服务器进行通信；
2.  每个安卓客户端都有自己的证书（可以说是相互认证）；
3.  ssl 证书不得在应用程序中（每个人都将证书安装在手机上）。

我该怎么做？显然第 1 点）很容易（我构建了一个密钥库/信任库，如 stackoverflow 中所述）。问题在第 3 点）。

谢谢，马里奥

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T01:51:11.237

如果您的目标是 Android 4.0 (ICS)，您可以通过`KeyChain`API 使用系统密钥库。对于其他版本，用户需要将他们的密钥库保存在某个地方（在 SD 卡/外部存储等上），并让您的应用知道在哪里可以找到它。

# svn - SVN - 提交然后将新文件上传到测试服务器 - NETBEANS

> ID：10321483
> 
> 赞同：0
> 
> 时间：2012-04-25T18:20:46.173
> 
> 标签：svn, netbeans, upload

我在这里处于未知领域，可以使用一些帮助。

我正在使用 Netbeans v7.0.1

我在一个客户使用 svn 的项目中

我能够修改和提交罚款。

为了查看修订，我需要将文件上传到测试服务器。

问题：

我是否在设置 svn 的同一个项目中设置 netbeans 内的 ftp？

还是我使用单独的 ftp 客户端上传（目前正在这样做）？

谢谢

# javascript - underscore.js - 组合模板

> ID：10321486
> 
> 赞同：2
> 
> 时间：2012-04-25T18:21:02.610
> 
> 标签：javascript, jquery, underscore.js

我正在使用 underscore.js 和主干为应用程序创建一些视图。这些视图都有相同的前几行，但是根据它们是什么类型的子类而有所不同。有没有一种有效的方法来组合模板，以便我可以将一个单一的“主”模板插入到所有其他模板中？

代码示例：

```
<script type="text/template" id="template-1">
  {{ name }}
  <span>{{ type }}</span>
  <div>
    <some view specific html>
  </div>
</script>

<script type="text/template" id="template-2">
  {{ name }}
  <span>{{ type }}</span>
  <div>
    <some view specific html>
  </div>
</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T19:02:27.660

我认为您可以采取两种方法：

1.  您可以将您的“主”表示为不同的模板，并在渲染视图时将其与子模板（例如，使用 jQuery.append）组合起来。

2.  或者，下划线模板可以呈现任意 javascript，因此我认为没有什么可以阻止您在模板中呈现模板，例如：

    ```
    <%= data.name %>
    <span><%= data.type %></span>
    <div>
        <%= _.template(data.child, data, { variable: 'data' }) %>
    </div> 
    ```

    或者反过来：

    ```
    <%= _.template(data.common, data) %>
    <div>
        Template 1!
    </div> 
    ```

    我添加了一个 jsFiddle 来[演示第一个模板示例](http://jsfiddle.net/morganjbruce/A5bwj/1/)。

# java - Spring Security 3.1：如何在另一个入口点获得安全性

> ID：10321488
> 
> 赞同：0
> 
> 时间：2012-04-25T18:21:14.590
> 
> 标签：java, authentication, spring-security

我是春天的新手。我最近学会了使用 Spring 3.1 来实现 LDAP 身份验证。我被告知要自定义身份验证，以便如果来自数据库中 IP 地址的用户访问该站点，他/她将自动登录（不是我的想法，我被命令这样做）。如果没有，该人将被发送到登录屏幕以进行 LDAP 身份验证

我制作了一个自定义 PreAuthenticationFilter 的骨架来检查这些用户，确定他们是否来自指定的 IP 地址之一，然后将它们发送到身份验证过程的其余部分。

我是 Spring 的新手。所以我从例子中拼凑起来，并多次阅读参考资料。

当我尝试运行它时，我收到一条错误消息，在我看来我没有正确设置我的标签或者我留下了一大块（我需要第二个自定义的 AuthenticationEntry 点吗？）

任何克服此错误的提示将不胜感激：

**我的日志摘录**

```
org.springframework.beans.factory.BeanCreationException: 
 Error creating bean with name 'org.springframework.security.filterChains': 
 Cannot resolve reference to bean 'org.springframework.security.web.DefaultSecurityFilterChain#0' 
 while setting bean property 'sourceList' with key [0]; 
 nested exception is org.springframework.beans.factory.BeanCreationException: 
 Error creating bean with name 'org.springframework.security.web.DefaultSecurityFilterChain#0': 
 Cannot resolve reference to bean 'customFilter' 
 while setting constructor argument with key [2]; 
 nested exception is org.springframework.beans.factory.BeanCreationException: 
 Error creating bean with name 'customFilter' 
 defined in ServletContext resource [/WEB-INF/acme-security.xml]: 
 Invocation of init method failed; nested exception is java.lang.IllegalArgumentException: 
 An AuthenticationManager must be set 
```

**我自定义的用于通过 IP 地址登录的 PreAuthenticatedFilter 类：**

```
package com.acme.controller.security;

import java.io.*;

import javax.servlet.*;
import javax.servlet.http.*;

import org.springframework.security.authentication.AuthenticationDetailsSource;
import org.springframework.security.authentication.AuthenticationManager;
import org.springframework.security.authentication.AuthenticationProvider;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.AuthenticationException;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.security.web.authentication.AuthenticationFailureHandler; 
import org.springframework.security.web.authentication.preauth.AbstractPreAuthenticatedProcessingFilter;
import org.springframework.security.web.authentication.preauth.PreAuthenticatedAuthenticationToken;
import org.springframework.security.web.authentication.SimpleUrlAuthenticationFailureHandler;
import org.springframework.security.web.authentication.WebAuthenticationDetails;
import org.springframework.security.web.authentication.WebAuthenticationDetailsSource;

import org.apache.log4j.Logger;

public class CustomIPAddressAuthenticationFilter extends AbstractPreAuthenticatedProcessingFilter {

  private static final Logger logger = Logger.getLogger(CustomIPAddressAuthenticationFilter.class);

  private AuthenticationDetailsSource ads             = new WebAuthenticationDetailsSource();
  private AuthenticationManager authenticationManager;
  private AuthenticationFailureHandler failureHandler = new SimpleUrlAuthenticationFailureHandler();

  public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
    Authentication authentication = SecurityContextHolder.getContext().getAuthentication();

    if (authentication == null) {       

        boolean isAuthenticatedByIP  = false;

        // Get the IP address of the user tyring to use the site
        String userIPAddress = request.getRemoteAddr();
        logger.debug("userIPAddress == " + userIPAddress);

        // Compare the user's IP Address with the IP address in the database
        // stored in the USERS_AUTHENTICATED_BY_IP table & joined to the
        // USERS tabe to make sure the IP Address has a current user
        //isAuthenticatedByIP =  someDataObject.hasIPAddress(userIPAddress);
        isAuthenticatedByIP = true;

        if(isAuthenticatedByIP){
            PreAuthenticatedAuthenticationToken token = new PreAuthenticatedAuthenticationToken("John.Principal","Password");
            token.setDetails(ads.buildDetails(request));

            try{
                logger.debug("Going to set Authentication");
                authentication = authenticationManager.authenticate(token);
                // Setup the security context, aka authenticate
                SecurityContextHolder.getContext().setAuthentication(authentication);
                logger.debug("Authenticated");
            }
            catch(AuthenticationException e){
                logger.debug("Authentication information was rejected by the authentication manager \n",e);
                failureHandler.onAuthenticationFailure((HttpServletRequest)request, (HttpServletResponse)response, e);
            }

        }// end if(isAuthenticatedByIP)     

    }// end if(authenication == null)

    chain.doFilter(request, response);
  }// end function doFilter();

  public void setAuthenticationManager(AuthenticationManager authenticationManager) {
    this.authenticationManager = authenticationManager;
  }

  public void setFailureHandler(AuthenticationFailureHandler failureHandler) {
    this.failureHandler = failureHandler;
  }

  protected String getPreAuthenticatedPrincipal(javax.servlet.http.HttpServletRequest request){

      return "Joe.IP.User";
  }

  protected String getPreAuthenticatedCredentials(javax.servlet.http.HttpServletRequest request){
      return "Password2";
  }

} 
```

**我的 *-security.xml：**

```
<beans xmlns="http://www.springframework.org/schema/beans"
  xmlns:s="http://www.springframework.org/schema/security"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
    http://www.springframework.org/schema/security
    http://www.springframework.org/schema/security/spring-security-3.1.xsd">

    <s:http auto-config="true" use-expressions="true">

        <s:intercept-url pattern="/login*"    access="hasRole('ROLE_ANONYMOUS')"/>
        <s:intercept-url pattern="/search*"   access="hasRole('ROLE_ANONYMOUS')"/>
        <s:intercept-url pattern="/css/**"    access="hasRole('ROLE_ANONYMOUS')"/>
        <s:intercept-url pattern="/js/**"     access="hasRole('ROLE_ANONYMOUS')"/>
        <s:intercept-url pattern="/images/**" access="hasRole('ROLE_ANONYMOUS')"/>
        <s:intercept-url pattern="/jsp/test*" access="hasRole('ROLE_ANONYMOUS')"/>
        <s:intercept-url pattern="/**" access="isAuthenticated()" />

        <s:custom-filter position="PRE_AUTH_FILTER" ref="customFilter" />

        <s:form-login login-page="/login"
          authentication-failure-url="/loginfailed" />
        <s:logout logout-success-url="/logout" />
    </s:http>

    <bean id="customFilter" class="com.acme.controller.security.CustomIPAddressAuthenticationFilter">
        <property name="authenticationManager" ref="authenticationManager"/>
    </bean>

    <s:ldap-server url = "ldap://ldap-itc.smen.acme.com:636/o=acme.com"/>

    <s:authentication-manager alias="authenticationManager">
        <s:ldap-authentication-provider user-dn-pattern="uid={0},ou=People"/>
    </s:authentication-manager>

</beans> 
```

**我的 web.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app  id="WebApp_ID" version="3.0"
   xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd">

  <display-name>Acme</display-name>

  <!--welcome-file-list>
    <welcome-file>/login</welcome-file>
  </welcome-file-list-->

  <servlet>
    <servlet-name>acme</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
  </servlet>

  <servlet-mapping>
    <servlet-name>acme</servlet-name>
    <url-pattern>/</url-pattern>
  </servlet-mapping>

  <!-- Help Find The Spring Config Files -->
  <listener>
    <listener-class>
                  org.springframework.web.context.ContextLoaderListener
    </listener-class>
  </listener>
  <context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>
            /WEB-INF/nsd-servlet.xml,
            /WEB-INF/nsd-security.xml
    </param-value>
  </context-param>

  <!-- Spring Security -->
  <filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
  </filter>
  <filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name>
    <url-pattern>/*</url-pattern>
  </filter-mapping>

  <!-- Integrate A Legacy Screen Done With A Servlet -->
  <servlet>
    <servlet-name>HelloWorldServlet</servlet-name>
    <servlet-class>
            com.legacy.HelloWorldServlet
    </servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>HelloWorldServlet</servlet-name>
    <url-pattern>/helloworldservlet</url-pattern>
  </servlet-mapping>

</web-app> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:45:37.683

我相信您的安全配置的某些部分与您在`s:http`配置中多个地方的使用方式不一致。我建议尝试以下配置：

```
<s:http auto-config="true" use-expressions="true">

    <s:intercept-url pattern="/login*" access="isAnonymous()" />
    <s:intercept-url pattern="/search*" access="isAnonymous()" />
    <s:intercept-url pattern="/css/**" access="isAnonymous()" />
    <s:intercept-url pattern="/js/**" access="isAnonymous()" />
    <s:intercept-url pattern="/images/**" access="isAnonymous()" />
    <s:intercept-url pattern="/**" access="isAuthenticated()" />

    <s:form-login login-page="/login"
      authentication-failure-url="/loginfailed" />
    <s:logout logout-success-url="/logout" />

</s:http> 
```

无论是否点击，您都需要激活身份验证过程`/login`；所以我建议使用预认证*过滤器* [`AbstractPreAuthenticatedProcessingFilter`](http://static.springsource.org/spring-security/site/docs/3.0.x/reference/preauth.html)的实现。您的过滤器将使用 IP 地址进行身份验证并填充`Authentication`对象，因此不再重定向到登录页面。过滤器应配置在 位置`PRE_AUTH_FILTER`。[您可以在Spring Source blog](http://blog.springsource.com/2010/08/02/spring-security-in-google-app-engine/)找到类似的 GAE 用例实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T18:50:50.857

在您的实现中，您需要消除属性`authenticationManager`，它由父类管理。

# asp.net - 如何在我的 ASP.NET MVC 应用程序中使用 jQuery 选项卡进行导航？

> ID：10321489
> 
> 赞同：2
> 
> 时间：2012-04-25T18:21:16.447
> 
> 标签：asp.net, asp.net-mvc, jquery-ui

我正在使用 ASP.NET MVC 创建一个新应用程序。

我想在我的窗口顶部使用一系列 jQuery 选项卡，以允许用户访问应用程序的各个模块。

我想将选项卡放在我的共享布局视图中，这样我就不会在整个应用程序中复制它们。

我遇到了两个相互矛盾的问题，我似乎无法找到一致的解决方案：

1.  当我单击一个选项卡时，我希望整个窗口导航到该页面，而不是仅仅将内容加载到一个 div 中。我这样做是为了允许为特定模块添加书签。（我希望地址栏包含当前内容的 URL，而不仅仅是“主页”URL。）

2.  目前，当我调用 $("#tabs").tabs(); jQuery 为我的每个选项卡创建一个 div，并尝试将我的 href 内容加载到 div 中。这最终会创建我所在页面的副本，并将其嵌套在其中。

这是我的选项卡定义（来自默认布局页面）：

```
 <section class="tabs">
        <div id="tabs">
            <ul>
                <li><a href="Home" rel="Home">Instructions</a></li>
                <li><a href="Questions" rel="Questionnaire">Questions</a></li>
                <li><a href="Submit" rel="SubmitAndConfirm">Finish</a></li>
                <li><a href="FAQ">FAQ</a></li>
            </ul>
        </div>
    </section> 
```

这是我用来设置它们的脚本：

```
function SetupTabs(sel) {

    $("#tabs").tabs();

    $("#tabs").tabs("select", sel); // Selects the tab
    $('#tabs').tabs({
        select: function (event, ui) {
            location.href = ui.tab.rel;
        }
    });
} 
```

这实际上使我的页面可以正确导航，但是将页面嵌套在它们自身中（上面的问题 #2）。如果我重新安排它以便我有一个主页，并使用部分视图从选项卡加载内容，那么我在地址栏中没有可用的 URL（上面的问题 #1）。

任何想法将不胜感激。我知道这不是 jQuery 选项卡的设计范例，但我们在应用程序的其他地方使用它们，并且我们使用了很多 jQuery UI 主题元素，所以我也想在这个元素上坚持使用它们，如果我能让它工作。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T18:42:18.270

由于您希望每个选项卡单击都充当导航，因此您可能需要考虑不使用 JQueryUI 选项卡，而是使用`<ul>`样式看起来像带有单击事件设置的选项卡来导航到您想要的页面。

# jquery - 如何向 jQuery .load -> .complete 添加全局函数？

> ID：10321497
> 
> 赞同：0
> 
> 时间：2012-04-25T18:21:38.803
> 
> 标签：jquery, jquery-load

为 [top-secret] 编写一个插件（不是真的：P），我决定最好的做法是“如果”有一种明确的方法可以将功能添加到......也许 $.ajax 的完整功能，这样进行更改后，对 .load 的每次新调用都会在完成后自动调用此实现的函数。

简而言之就是这个想法，把它分解得更多（并且没有真正的代码，因为我编写的所有代码都工作正常，这部分我不确定从哪里开始，duh1）如果用户点击链接和视图部分加载到元素中，我记录它并对数据字段进行更改。我想做的是在 .load 的每个实例上都发生这种情况，而不必让编码人员将其添加到 .load 完整函数中的他/她的代码中。

不知道我是如何让这个变得更多的，虽然我不“认为”我做得太糟糕了。谁知道我现在正在浏览 jQuery 库时可能会自己找到答案。如果我这样做了，我会发布它，如果没有，希望有人以前用“jQuery”做过这样的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T20:06:08.377

如果我正确理解了您的问题，您可以使用[`ajaxComplete()`](http://api.jquery.com/ajaxComplete/), 每当 AJAX 请求完成时都会调用它。

> 编辑以显示使用和工作能力

```
 $(document).ajaxComplete(function(){ alert('complete'); }); 
```

演示：http: [//jsfiddle.net/4CK7q/](http://jsfiddle.net/4CK7q/)

# html - h1 和 h3 标签上的文本缩进，我无法删除它

> ID：10321503
> 
> 赞同：0
> 
> 时间：2012-04-25T18:21:50.790
> 
> 标签：html, css, text, format, dreamweaver

我不记得更改任何会影响 h1 和 h3 标签的 CSS 样式或代码，但是它现在缩进，而段落标签没有。我已经尝试查看我的所有代码，但我无法修复它！我希望所有文本都像我的段落文本一样左对齐。这是一个指向您可以看到问题的页面的链接：http: [//ukneurology.com/html/clinicInfo/stroke.html](http://ukneurology.com/html/clinicInfo/stroke.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T18:24:47.113

您在所有标题标签上都设置了 padding-left

```
.container .bgdImage #right-sidebar p, h1, h2, h3, h3, h5, h6 {
    padding-left: 40px;
    padding-right: 15px;
    text-align:left;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T18:25:58.023

在您的源代码中`stroke.html`有以下 CSS：

```
.container .bgdImage #right-sidebar p, h1, h2, h3, h3, h5, h6 {
    padding-left: 40px;
    padding-right: 15px;
    text-align:left;
} 
```

你在`padding-left`这里设置`40px`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T18:31:25.363

```
.container .bgdImage #right-sidebar p, h1, h2, h3, h3, h5, h6 {
    padding-right: 15px;
    text-align: left;
} 
```

用这个代替你以前的课程。

# c# - COM 互操作挂起冻结整个 COM 系统。如何取消 COM 通话

> ID：10321504
> 
> 赞同：1
> 
> 时间：2012-04-25T18:21:52.443
> 
> 标签：c#, .net, com, interop

我正在使用通过 COM 互操作包装器公开的第三方 dll。但是，其中一个 COM 调用经常冻结（至少从不返回）。为了至少让我的代码更健壮一点，我异步包装了调用（`_getDeviceInfoWaiter`is a `ManualResetEvent`）

```
var backgroundWorker = new BackgroundWorker();
      backgroundWorker.DoWork += 
        (sender, eventArgs) =>
          {
            var deviceInfo = _myCom.get_DeviceInfo(0);
            _serialNumber = deviceInfo.SerialNumber;
            _getDeviceInfoWaiter.Set();
          };
      backgroundWorker.RunWorkerAsync();
      var waitFifteenSecondsForGetInfo = new TimeSpan(0, 0, 0, 15);
      _getDeviceInfoWaiter.WaitOne(waitFifteenSecondsForGetInfo, true);
      if(String.IsNullOrEmpty(_serialNumber))
        throw new ArgumentNullException("Null or empty serial number. " +
            "This is most likely due to the get_DeviceInfo(0) COM call freezing."); 
```

但是，下一次调用任何 COM 组件都会冻结代码。有什么我没有想到的，或者有什么方法可以让我的主线程不死？

**更新**

基本上，这是一个 COM 调用，每当将新设备插入 PC 时都会调用它，以便我们可以适当地记录信息。但是，正如我所说，如果这个组件正在等待，**任何**COM 组件都会冻结（如果第三方锁定，我们自己的自定义 COM 会锁定）

**更新 2**

上面的代码确实有效，并将 UI 线程的挂起延迟到下一次 COM 调用。这种尝试变通办法的原因是因为`var deviceInfo = _myCom.get_DeviceInfo(0);`已经锁定了 UI 线程。但是，此信息并不重要，仅用于记录，因此这种方法是允许“放弃并在 15 秒后继续”的情况

**这里的另一个解决方法是找到一种方法在 x 秒后取消 COM 调用？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T18:30:14.577

*更新 - 来自 OP 的第二次更新之后*

如果您有一些有问题的组件，您始终可以使用以下方法使您的使用更加健壮：

创建一个进程 (EXE)，它包装该组件的使用并公开一个 API（例如通过任何 IPC 机制）。然后，您可以将该 EXE 作为一个单独的进程（从您的主 EXE）启动并使用它...如果您需要在一段时间后终止该组件和/或满足某些条件时，您可以随时终止该“包装器 EXE”从你的主EXE ...根据特定的组件，在那个“包装EXE”中实现一些特殊的“清理代码”（可能在一个单独的线程中）甚至可能是有用的，当你需要杀死那个“包装EXE”时它会被执行”。

由于您在 .NET 中实现此功能，因此您甚至可以在主可执行文件中将该“包装 EXE”作为“嵌入式资源”，甚至可以从 RAM 启动它，而无需将其写入文件系统......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T18:30:31.300

第三方 DLL 内部有某种无限期的等待、循环或死锁。尝试像这样解决它是行不通的。您可能已经将挂起的调用外包给工作线程，但该线程并没有消失；它一直挂在那个电话里。

对 COM 组件的下一次调用很可能会冻结，因为前一个调用冻结了。也许它正试图获得前一个在挂起之前获得的锁。或者它可能出于完全相同的原因而挂起，而不是依赖原因。

最好联系这个第三方的开发者/供应商，询问他们是否以某种方式滥用它。是否缺少一些先决条件。一些未执行的初始化。一些必要的配置等。

# xcode4 - 在 xcode 4 中编辑构建设置

> ID：10321507
> 
> 赞同：2
> 
> 时间：2012-04-25T18:22:03.537
> 
> 标签：xcode4

我一直无法弄清楚如何使用下面显示的弹出窗口来编辑构建设置。

![在此处输入图像描述](../Images/4de610dad931a44305df87ccc426ae85.png)

我可以通过单击“+”在弹出窗口中输入多行。我的问题是：-

1.  设置旁边的复选框用于什么？
2.  在弹出窗口中输入一个或多个设置后，如何将它们转移到我正在编辑的设置。没有“保存”按钮，单击弹出窗口会关闭它，但似乎没有保存输入的数据。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T18:45:11.647

要删除，请选中复选框并单击“-”。要创建一个新的，请单击“+”。要保存，请单击“完成”。

欢迎来到 Apple UX 的精彩世界。

# json - 使用 JSON 而不是 JSONP 和 YUI3 数据源

> ID：10321513
> 
> 赞同：3
> 
> 时间：2012-04-25T18:22:20.307
> 
> 标签：json, jsonp, datasource, yui3

我正在通过 JSON 填充 YUI DataTable，从示例代码[DataTable + DataSource.Get + JSON Data](http://yuilibrary.com/yui/docs/datatable/datatable-dsget.html)开始。尽管标题很有希望，但此示例使用 JSONP，而不是直接的 JSON。就我而言，我使用相对 URL 进行查询，所以我不需要（或想要）JSONP。

我的代码定义了一个数据源和架构，如下所示：

```
var dataSource = new Y.DataSource.Get({ source: "myLocalUrl.json" });
dataSource.plug(Y.Plugin.DataSourceJSONSchema, {
    schema: { resultListLocator: "result.path.to.array", resultFields: ["key1", "key2"]}
}); 
```

此处没有指定 JSONP，但显然这是默认行为——尽管 JSONP 文档中有安全警告。也许我遗漏了一些明显的东西，但我已经检查了 Y.DataSource 和 Y.DataSource.Get 的 API 文档，但都不是特别有启发性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T19:58:11.463

我对[DataSource.IO的运气更好](http://yuilibrary.com/yui/docs/datasource/datasource-io.html)

```
var dataSource = new Y.DataSource.IO({ source: "myLocalUrl.json" });
dataSource.plug(Y.Plugin.DataSourceJSONSchema, {
    schema: { resultListLocator: "result.path.to.array", resultFields: ["key1", "key2"]}
}); 
```

# php - PHP 如何访问 div 的“样式”属性？

> ID：10321524
> 
> 赞同：0
> 
> 时间：2012-04-25T18:22:57.210
> 
> 标签：php, javascript, dom, dynamic, dhtml

所以我的 PHP 网站生成了如下所示的 DHTML 输出：

```
<div class="toggle-ctrl" onclick="toggleMenu();">
    click me to toggle menu
</div>
<div id="site-menu">
    <ul>
        <li>opt 1</li>
        <li>opt 2</li>
    </ul>
</div>
<p><a href="#">Link to Myself</a></p> 
```

当然，当点击时，第一个 div 会调用一些 JavaScript 来切换`site-menu`

```
function toggleMenu() {
    var navigation_pane  = document.getElementById('site-menu').style;
    if ( navigation_pane.display == 'none' )
        navigation_pane.display = 'block';
    else
        navigation_pane.display = 'none';
} 
```

这一切都很好。它正在点击现在困扰我的链接。单击它（当然）会创建一个新的 http 请求，并且我的 PHP 引擎会再次重新生成该页面。

当 的可见性为 时，就会出现`site-menu`问题`'none'`。PHP 引擎不知道菜单被隐藏，所以它再次生成相同的 html，并且浏览器将菜单放回看起来很惊讶的用户面前。

`site-menu`因此，问题是，在重新生成页面之前，我如何通知 PHP（或 PHP 如何检查） 的可见性状态是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T18:43:41.320

> 因此，问题是，在重新生成页面之前，我如何通知 PHP（或 PHP 如何检查）站点菜单的可见性状态是什么？

它不能。当 HTML 被传送到浏览器时，PHP 已经不在图片中了。让 PHP 意识到这一点的唯一方法是在 URL 中发送一个参数来指示菜单已隐藏，或者设置一个 cookie 并让 cookie 指示对象的可见性。然后 PHP 可以检查该值是否存在，并在呈现 div 时设置它的可见性。

您可以通过多种方式完成此操作，例如：

*   使用[document.cookie](http://www.quirksmode.org/js/cookies.html#doccookie)在您的 toggleMenu 函数中设置 cookie。
*   在 toggleMenu 函数中使用 ajax 通知 PHP 并让 PHP 设置 cookie 或会话值
*   将标志附加到链接，指示来自 toggleMenu 函数的菜单的可见性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T19:18:37.223

除了将菜单状态发送到 PHP 脚本之外，至少还有两个选项。

1.  使用 AJAX 仅加载页面的一部分。如果不重新加载菜单，则不需要重新初始化其样式。在走这条路之前，先检查一下[AJAX 是否合适](https://stackoverflow.com/q/163610/90527)。如果您实施此解决方案，请不要[破坏浏览器功能](http://www.devx.com/webdev/Article/35549/1954)。
2.  现代浏览器支持[存储机制](http://www.w3.org/TR/webstorage/)。在菜单状态改变时存储菜单状态`localStorage`，并在页面加载时设置菜单状态。要支持旧版浏览器，您可以创建一个 API，该 API 在可用时使用 Web 存储，而在不可用时使用 cookie（[jQuery.Storage 会这样做](http://archive.plugins.jquery.com/project/html5Storage)）。

    菜单.js：

    ```
    /* implementation of Storage, Class and addEventListenerTo left as 
       an exercise for the reader.
    */
    var Menu = {
        init: function(id, toggleId) {
            if (! toggleId) {
                toggleId = id + '-toggle';
            }
            var toggler = document.getElementById(toggleId),
                menu = document.getElementById(id);
            menu.toggler = toggler;
            /* addEventListenerTo should call the browser-supplied event subscriber 
               method (e.g. addEventListener or attachEvent)
            */
            addEventListenerTo(toggler, 'click', 
                function(evt) {
                    Menu.toggle(id);
                });

            if (! Storage.exists(id+'-open')) {
                Storage.set(id+'-open', true);
            }

            if (Storage.get(id+'-open')) {
                Menu.open(id);
            } else {
                Menu.close(id);
            }
        },
        toggle: function(id) {
            var menu = document.getElementById(id);
            Class.toggle(menu, 'open closed');
            if (Class.has(menu, 'open')) {
                menu.toggler.firstChild.nodeValue = 'close menu';
                Storage.set(id + '-open', true);
            } else {
                menu.toggler.firstChild.nodeValue = 'open menu';
                Storage.set(id + '-open', false);
            }
        },
        setState: function (id, toAdd, toRemove) {
            var menu = document.getElementById(id);
            Class.remove(menu, toRemove);
            Class.add(menu, toAdd);
        },
        open: function(id) {
            this.setState(id, 'open', 'closed');
        },
        close: function(id) {
            this.setState(id, 'closed', 'open');
        }
    }; 
    ```

    一些CSS文件：

    ```
    .closed { display: none; } 
    ```

    页：

    ```
    <div id="site-menu-toggle" class="toggle-ctrl">close menu</div>
    <div id="site-menu" class="open">
        <ul>
            <li>opt 1</li>
            <li>opt 2</li>
        </ul>
    </div>
    <p><a href="#">Link to Myself</a></p>

    <script type="text/javascript">
    Menu.init('site-menu');
    </script> 
    ```

    您可以在jsFiddle 上使用[Menu.js](http://jsfiddle.net/outis/J8per/2/)方法的实时版本。使用 jQuery，您可以取消 Menu.js，从而实现更简洁的实现：

    ```
    <script type="text/javascript">
    $('#site-menu-toggle').click(function (evt) {
            var $menu = $('#site-menu');
            $menu.toggleClass('open close');
            $.Storage.set('site-menu-state', $menu.attr('class'));
            if ($menu.hasClass('open')) {
                $('#site-menu-toggle').text('close menu');
            } else {
                $('#site-menu-toggle').text('open menu');
            }
        });
    $(function() {
        var state = $.Storage.get('site-menu-state');
        if (! state) {
            $.Storage.set('site-menu-state', $('#site-menu').attr('class'));
        } else {
            $('#site-menu').attr('class', state);
        }
    });
    </script> 
    ```

    有一个 jFiddle 用于 jQuery[菜单状态](http://jsfiddle.net/outis/usvmn/)实现，您可以使用它。

由于菜单状态的差异在概念上不会导致不同的资源，因此打开或关闭菜单是否可收藏或受历史影响并不重要。

注意。不要使用文本“ [click me](http://www.w3.org/QA/Tips/noClickHere) ”，它太冗长和多余（还有什么其他操作？[应有](http://en.wikipedia.org/wiki/Affordance)的功能应该是隐含的。）。相反，您可以使用图形来指示打开/关闭，或者简单地说“打开菜单”/“关闭菜单”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T18:49:16.580

除了draw010 的建议：您还可以创建一个带有隐藏输入元素的表单，例如，'menu_status'，其值由toggleMenu() 设置。然后，当您单击链接时，使用 javascript 发布或获取表单。然后，根据表单方法，使用`$_POST["menu_status"]`或使用 php 在服务器端读取值。`$_GET["menu_status"]`

更新：像这样的东西：

```
<form name="session_form" action="" method="POST">
    <input type="hidden" name="menu_state" value="block">
</form>

<?php $menu_state = isset($_POST["menu_state"]) ? $_POST["menu_state"] : "block"; ?>

<div id="site-menu" style="display:<?php echo $menu_state; ?>">
<ul>
    <li>opt 1</li>
    <li>opt 2</li>
</ul>
</div>

<p><a href="#" onClick="document.forms.session_form.submit();return false;">Link to Myself</a></p>

function toggleMenu() {
    var navigation_pane  = document.getElementById('site-menu').style;
    if ( navigation_pane.display == 'none' )
        navigation_pane.display = 'block';
    else
        navigation_pane.display = 'none';
    document.forms.session_form.menu_state.value = navigation_pane.display;
} 
```

编辑：使用 jQuery ajax 可能涉及到这样的事情：

```
<div class="toggle-ctrl">click me to toggle menu</div>

<?php $menu_state = isset($_POST["menu_state"]) ? $_POST["menu_state"] : "block"; ?>

<div id="site-menu" style="display:<?php echo $menu_state; ?>">
<ul>
    <li>opt 1</li>
    <li>opt 2</li>
</ul>
</div>

<p><a href="#" id="go">Link to Myself</a></p>

$("div.toggle-ctrl").click(function(){
    $("#site-menu").toggle();
});

$("#go").click(function(e) {
    e.preventDefault();
    var menu_state = $("#site-menu").css("display");
    $.post("", {menu_state:menu_state}, function (response) {
        $("html").html(response);
    });
}); 
```

或者不使用 ajax 或表单，只需将参数附加到链接并在您的 php 中使用 $_GET 而不是 $_POST：

```
$("#go").click(function(e) {
    e.preventDefault();
    var menu_state = $("#site-menu").css("display");
    document.location.href = "index.php?menu_state=" + menu_state;
}); 
```

在我看来，这似乎是最简单的解决方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-25T19:19:18.953

实际上，您的问题有几种类型的答案。

虽然听起来没有办法做你想做的事，但实际上有很多方法。

**饼干**

显而易见的。cookie 可以通过 javascript 和 PHP 访问。只要通过 javascript 显示/隐藏菜单时修改 cookie（有出色的 jQuery cookie 插件）。

**表单输入**

如果您正在提交表单，只需隐藏输入即可保持菜单可见性的值：

```
<input type="hidden" name="menu-visibility" value="0"/> 
```

同样，您需要 javascript 来更新此输入。

**更新页面的相关部分**

这是 hip & leet 的新趋势。嗯，实际上，它已经存在了大约 6 年左右。基本上，不要提交任何东西，也不要重新加载页面。通过 AJAX 更新页面中实际需要更新的部分。

**本地存储**

正如@outis 所提到的，今天的浏览器有一些类似于 cookie 的东西，除了它们自己保存（因此是本地的）。这是一个相当新的功能，老实说，考虑到有更好的方法来完成你需要的东西，我不会相信它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-26T09:21:04.537

I know it's not cool to answer your own question, but another possible solution occurred to me last night, and it only requires 1 new line of code to be written (sort of).

The first part of the solution has already been implicitly suggested by many of you. Modify the JavaScript to write to a cookie:

```
function toggleMenu() {
    var navigation_pane  = document.getElementById('site-menu').style;
    if ( navigation_pane.display == 'none' )
        navigation_pane.display = 'block';
    else
        navigation_pane.display = 'none';
    document.cookie = "menu_vis=" + navigation_pane.display; // +1 line of code
} 
```

Now, what are the possibilities if your CSS file just so happens to be a PHP file in disguise? `my_css.php` would look something like this:

```
<?php
header("Content-type: text/css");
?>
#site-menu {
    display: <?php echo isset($_COOKIE['menu_vis']) ? $_COOKIE['menu_vis'] : 'block'; ?>;  /* line of code modified, but not added! */
} 
```

Tested this morning, and it works.

I find it a neat solution, because it means that I don't have to bend my PHP or HTML design around any presentational concerns.

-- I appreciate that there are more "encompassing" solutions out there. If I was a better JavaScript developer, (or made use of jQuery or the like), I could build more complicated classes which could then be applied more generally to other HTML elements. I may come back to investigate such solutions later, but that's just not where my project is at the moment.

Thank you everyone for all your replies. I wouldn't have found this solution without bouncing these ideas off you guys.

# c# - 为什么要通过继承的抽象类而不是自己的类来声明一个对象

> ID：10321526
> 
> 赞同：3
> 
> 时间：2012-04-25T18:23:03.280
> 
> 标签：c#, inheritance, object, polymorphism, abstract-class

```
public abstract class Character
{
    protected Weapon weapon;

    public string Name;
    public int Health = 10;
    public int Strength;

    public Character()
    {
    }

    public void Attack()
    {
        weapon.useweapon();
    }
}

public class Warrior : Character
{
    public Warrior()
    {
        weapon = new Sword();
        Health = 10;
        Strength = 25;
    }

    public void SetWeapon(Weapon newweapon)
    {
        weapon = newweapon;
    }

}

public class Wizard : Character
{
    public Wizard()
    {
        weapon = new Spell();
        Health = 15;
        Strength = 10;
    }
} 
```

如您所见，有一个抽象 Character 类和两个 Character 子类。在这个程序中，只有战士可以更换武器。现在，我不想讨论代码本身，我想知道的是，在我的实现代码中为什么要使用它：

```
Character Zizo = new Warrior();
Character Hang = new Wizard(); 
```

代替 -

```
Warrior Zizo = new Warrior();
Wizard Hang = new Wizard();
Zizo.SetWeapon(new Axe()); //I can only use this method in this implementation 
```

两者有什么区别，通过抽象类声明对象有什么好处？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T18:28:32.920

客户端代码应使用最低要求的接口或抽象类定义。您这样做主要是为了保持代码更松散耦合。在您的示例中，如果调用代码只需要`Attack()`但不关心它是如何执行、实现的，或者是什么特定类型（例如`Warrior`，`Wizard`等）在进行攻击，那么它应该使用`abstract Character`该类。

当它**必须**具有特定实现或具体类的知识时，显式使用一个是合适的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T18:28:25.433

你得到的是编写代码的能力，该代码可以与`Character`任何字符类型上的任何公开暴露的类型成员进行交互，无论它是什么。

前任：

```
public void AttackAndHeal(Character character)
{
    character.Attack();
    character.Health++;
} 
```

* * *

```
Warrior zizo = new Warrior();
Wizard hang = new Wizard();

AttackAndHeal(zizo);
AttackAndHeal(hang); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T18:28:43.463

如果你总是知道你会那样使用它们，那就没有必要了。但通常你想抽象出角色的类型，只执行所有角色都执行的动作。

假设有人在屏幕中间投下了一颗 H 炸弹。你不会关心你的角色是 Wizards 还是 Warriors() 他们都会死，所以你只需要调用 Kill 或任何你有的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-25T18:28:59.493

您可以拥有一个通用集合`Warrior`并重用该类`Wizard`的任何成员`Character`

```
var characters = new List<Character>();
characters.Add(new Warrior());
characters.Add(new Wizard());
foreach (var c in characters)
{
    //use members exposed by c
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-23T00:42:36.660

If you have a regular method (i.e. not overidden) of the same name on the base class and the child class then typing the variable of the object as the base class will cause the method on the base class to be chosen if the method is called. That might be a reason to type it as a character if your looking for that behavior. If you add the warrior to a List or pass it in to a method requiring a Character as a parameter then it's automatically casted to Character (i think), so typing a warrior as Character might make the code less error prone if you are just going to be adding it to list or doing anything else requiring a Character type.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-25T18:29:31.683

通过声明`Zizo`为`Character`，您现在可以将任何类型的`Character`对象分配给`Zizo`。不幸的是，这也将限制您仅调用显式声明的属性和函数`Character`。为了调用`Zizo`特定于的任何内容`Warrior`，您需要先将其转换。

# mercurial - Jenkins Slave 的 Mercurial / TortoiseHg 问题 - 指定的登录会话不存在

> ID：10321528
> 
> 赞同：0
> 
> 时间：2012-04-25T18:23:08.380
> 
> 标签：mercurial, jenkins, tortoisehg, self-signed, tortoisehg-2.0

我有一个以前在 Jenkins 主节点上运行良好的构建，我现在正试图在 Jenkins 从属节点上执行。

我正在使用 Jenkins Mercurial 插件并指向从机上的 TortoiseHg 安装目录。

我正在使用的 Mercurial 存储库由自签名证书（托管在 IIS 中）保护。

在本地机器上工作，我可以毫无问题地克隆存储库（这是让 TortoiseHg 保留用户密码所必需的）。

但是，当詹金斯执行构建时，我似乎遇到了问题。

下面列出了我得到的具体错误：

```
Building remotely on <slave> in workspace <workspace>
$ S:\Software\TortoiseHg/hg clone --rev default --noupdate https://<repository> <workspace_on_slave>
warning: <MercurialServerIP> certificate with fingerprint e3:5f:5e:ea:4f:da:ef:a4:0b:4a:bb:00:e8:31:59:de:ce:d0:28:94 not verified (check hostfingerprints or web.cacerts config setting)
** unknown exception encountered, please report by visiting
**  http://mercurial.selenic.com/wiki/BugTracker
** Python 2.6.6 (r266:84297, Aug 24 2010, 18:13:38) [MSC v.1500 64 bit (AMD64)]
** Mercurial Distributed SCM (version 2.1.2)
** Extensions loaded: mercurial_keyring
Traceback (most recent call last):
  File "hg", line 42, in <module>
  File "mercurial\dispatch.pyo", line 27, in run
  File "mercurial\dispatch.pyo", line 64, in dispatch
  File "mercurial\dispatch.pyo", line 87, in _runcatch
  File "mercurial\dispatch.pyo", line 685, in _dispatch
  File "mercurial\dispatch.pyo", line 467, in runcommand
  File "mercurial\dispatch.pyo", line 739, in _runcommand
  File "mercurial\dispatch.pyo", line 693, in checkargs
  File "mercurial\dispatch.pyo", line 682, in <lambda>
  File "mercurial\util.pyo", line 456, in check
  File "mercurial\commands.pyo", line 1157, in clone
  File "mercurial\hg.pyo", line 250, in clone
  File "mercurial\hg.pyo", line 93, in repository
  File "mercurial\httprepo.pyo", line 236, in instance
  File "mercurial\httprepo.pyo", line 57, in _fetchcaps
  File "mercurial\httprepo.pyo", line 169, in _call
  File "mercurial\httprepo.pyo", line 117, in _callstream
  File "urllib2.pyo", line 397, in open
  File "urllib2.pyo", line 510, in http_response
  File "urllib2.pyo", line 429, in error
  File "urllib2.pyo", line 369, in _call_chain
  File "urllib2.pyo", line 864, in http_error_401
  File "mercurial\url.pyo", line 429, in http_error_auth_reqed
  File "hgext\mercurial_keyring.pyo", line 332, in basic_http_error_auth_reqed
  File "urllib2.pyo", line 842, in http_error_auth_reqed
  File "urllib2.pyo", line 845, in retry_http_basic_auth
  File "hgext\mercurial_keyring.pyo", line 326, in find_user_password
  File "hgext\mercurial_keyring.pyo", line 177, in find_auth
  File "hgext\mercurial_keyring.pyo", line 60, in get_http_password
  File "keyring\core.pyo", line 37, in get_password
  File "keyring\backend.pyo", line 560, in get_password
  File "keyring\backend.pyo", line 573, in _get_password
pywintypes.error: (1312, 'CredRead', 'A specified logon session does not exist. It may     already have been terminated.')
ERROR: Failed to clone https://<repository> 
```

任何人都可以就我可以做些什么来克服这个问题提供建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T18:25:11.407

**非轮询解决方案：（**如果您没有对存储库进行轮询以触发构建，则很有用）

解决这个问题的方法是在工作区位置（通常会结束）**手动克隆从站上的存储库。**

似乎一旦存储库在从站上可用，它就能够通过“指定的登录会话不存在”。它可能已经被终止了。错误。

**轮询解决方案：（**上面的解决方案似乎不适用于 Jenkins 轮询功能，所以我们只剩下下面的解决方案）。

请参阅[如何将 Mercurial 的身份验证信息指定为 Jenkins 的一部分？(mercurial_keyring)](https://stackoverflow.com/questions/10354894/how-do-you-specify-authentication-information-for-mercurial-as-part-of-jenkins/10354981#10354981)

**我能够弄清楚如何让服务器在我的设置中记住密码（并使用轮询）的唯一方法是在 \mercurial.ini 中手动指定它。**

注意：您可能还需要从 mercurial.ini 中删除 mercurial_keyring 行。（这会禁用 Jenkins 服务器/从属服务器上的密钥环扩展，因为我们手动指定所有内容。）

# javascript - jQuery .attr("title") 未定义

> ID：10321529
> 
> 赞同：-1
> 
> 时间：2012-04-25T18:23:20.410
> 
> 标签：javascript, jquery

**已解决**，但包含关键调试建议的答案已被作者删除。考虑结案。

这应该很简单，但由于某种原因，我无法弄清楚。我需要获取 div 的 title 属性的值，我拥有的 jQuery 代码是：

```
var name = $('#stg'+this.id).attr('title'); 
```

相关HTML源代码中的div是：

```
<div class="stage" id="stg32432432" title="Name - desc">...</div> 
```

出于某种奇怪的原因， request for`attr("title")`不断返回，`undefined`即使所有返回的预期值都没有问题。我错过了什么？`attr("id")``attr("class")`

**编辑**：我尝试使用（现已删除）回复中建议的技巧对其进行调试：

```
var name = $('#stg'+this.id)[0].outerHTML; 
```

你瞧，它显示：

```
<div class="stage" id="stg32432432">...</div> 
```

有东西吃了我的头衔！其他一切都与我预期的完全一样，但标题不见了。太糟糕了，我无法将该回复标记为正确，因为我认为从这里开始我可以追踪属性消失的位置。

**更新**：事实证明，用于将标题显示为精美工具提示的第三方库在处理标题时正在剥离标题。谜团解开了。

谢谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T07:44:02.383

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <script src="Scripts/jquery-1.7.1.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $('[class=stage][id^=stg]').live('mouseover', function () {
                var name = $(this).attr('title');
                $('#result').html('<h1>This ddiv title is: ' + name + '</h1>');
            });
        });
    </script>
</head>
<body>
    <span id="result"></span>
    <div class="stage" id="stg32432432" title="Name - desc1">
        1...
    </div>
    <br />
    <div class="stage" id="stg32432433" title="Name - desc2">
        2...
    </div>
    <br />
    <div class="stage" id="stg32432434" title="Name - desc3">
        3...
    </div>
    <br />
    <div class="stage" id="stg32432435" title="Name - desc4">
        4...
    </div>
</body>
</html> 
```

# php - 在 SQL 查询中使用数组

> ID：10321532
> 
> 赞同：-1
> 
> 时间：2012-04-25T18:23:33.467
> 
> 标签：php, mysql

好的，所以我想在我的网站上有一个新闻提要。我有 3 个名为 Users、Follow 和 Posts 的表。基本用户数据进入 Users 表，谁在关注谁存储在 Follow 表中，用户发布的任何内容进入 Posts。现在，我知道如何从数据库表中选择每个帖子并使用 WHERE 子句对其进行限制。但是我将如何编写查询以从他们关注的唯一用户中选择所有帖子，并按 DESC 日期显示它们？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:41:42.847

这是给您的总体布局，像您提到的那样制作三个表格，我在下面概述了一个示例

[表格]

*   用户
*   追随者
*   帖子

在 users 表中，您至少应该有诸如 userid （自动递增值/主键）之类的列。

追随者表应该有类似 userid 的东西，它将与用户表 userid 匹配，followid 列也将具有来自用户表的追随者的 id #。

然后对于您的帖子表，您也希望拥有用户 ID，因此当每个帖子发布时，它都会具有来自用户表的 ID。

然后，您需要执行以下操作：

```
SELECT p.*
FROM posts AS p
WHERE p.userid IN (SELECT followid FROM followers WHERE userid = ###)
ORDER BY p.date DESC 
```

现在这真的取决于你如何让用户 id 来解决这个问题。如果您在用户登录类似于 Facebook 后使用会话传递用户 ID，那么您可以将 userid = ### 更改为 userid = ".$_SESSION['userid']." 但同样，这实际上取决于您如何传递用户 ID，但上述内容至少应该让您有所开始。

确保在 userid、followid 列上放置索引，这样当表变大时，它会快速进行连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T19:06:43.557

@Shane 答案的替代方法是使用 JOIN 运算符：

```
'SELECT p.* // I prefer to name all the fields, but for brevity's sake I'll use the shorthand  
FROM Posts AS p
INNER JOIN Follow AS f ON p.userid = f.followid  
WHERE f.userid = '.$selectedUserID.'  
ORDER BY p.date DESC;' 
```

对于输入的用户 ID ($selectedUserID)，它将查找他们关注的人的所有用户 ID（将关注 ID 与 Follow x-ref 表上的用户 ID 匹配），然后从 Post 表中按降序查找他们各自的帖子日期。如果他们不关注任何人或他们关注的人没有帖子，它将返回空。

我也希望我不需要提醒您清理您对数据库的输入并将您的输出转义到网络。

这是你要找的吗？

# cakephp - 如何在cakephp中设置文本字段的宽度和高度？

> ID：10321538
> 
> 赞同：3
> 
> 时间：2012-04-25T18:23:51.160
> 
> 标签：cakephp, styles

在我的应用程序中，我需要从用户那里获取数据库表中名为“body”的列的输入。

我在 .ctp 文件中的代码是：

```
echo $form->input('body',array('style'=>'width: 900px')); 
```

通过这种方式，我可以指定正常工作的正文字段的宽度。但是，我也想指定高度。

我试过`echo $form->input('body',array('style'=>'width: 900px height: 500px')); echo $form->input('body',array('style'=>'width: 900px','style'=>'height: 500px'));`

第一个不适用于宽度或高度，第二个仅修改高度但不修改宽度。有人可以告诉我如何克服这个问题。

非常感谢您提前。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-25T19:11:24.267

```
// in a css file.
.txtArea { width:900px; height:500px; }

// in your view
echo $form->input('body', array('class'=>'txtArea')); 
```

将是推荐和首选的方式。

或者，确保您的内联 CSS 是正确的：

```
echo $form->input('body', array('style'=>'width:900px; height:500px;')); 
```

您的代码似乎缺少 a `;`，当然，通过指定`style`两次，您将覆盖以前的值。

# javascript - 为什么使用 javascript 动态分配名称会失败？

> ID：10321543
> 
> 赞同：0
> 
> 时间：2012-04-25T18:23:59.527
> 
> 标签：javascript, jquery

我正在尝试使用 jQuery 将名称属性动态分配给 2 级标头。 [http://jsfiddle.net/8ZTEb/](http://jsfiddle.net/8ZTEb/)

这是我的javascript：

```
$(function() {
    $("h2").each(function() {
        $(this).attr("name", $(this).html().toLowerCase()); 
    });
});​ 
```

这是我的长而简单的 HTML。

```
<a href="#bar">Bar</a>
<h2>Foo</h2>
<p>
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam eu sollicitudin urna. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. In tincidunt magna vel quam auctor sit amet tincidunt lacus euismod. Praesent bibendum odio nec nisl tempus dictum. Cras aliquet condimentum est luctus accumsan. Aenean lectus lacus, malesuada eu dictum eu, euismod ac purus. Aliquam ultrices egestas elit, nec scelerisque lorem suscipit in. In auctor bibendum ullamcorper. Aenean lectus arcu, fermentum sed aliquet quis, tristique vestibulum est. In nisi ligula, consequat non semper vitae, pharetra vel risus. Nulla odio augue, tincidunt quis bibendum id, ullamcorper vel eros. Proin feugiat imperdiet tellus, ut porttitor massa eleifend in. Praesent sed nisl sed dui vestibulum auctor. Maecenas viverra feugiat erat adipiscing porttitor. Aenean mattis tincidunt placerat.
</p>
<p>
Fusce aliquam, dui a facilisis porttitor, nisi dolor semper dolor, ac vestibulum elit lorem id lorem. Nam ut odio eros. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse consequat tempor volutpat. Vestibulum cursus purus et nulla dignissim suscipit. Cras convallis dolor nec dolor volutpat vel rutrum magna eleifend. Nullam eget lorem orci. Vestibulum vel aliquam ligula.
</p>
<p>
Aliquam in tellus odio, ut gravida ante. Vestibulum vitae diam elementum dui ultricies hendrerit quis vitae ante. Vestibulum vel metus metus. Nulla in nulla et risus dictum lobortis at ac ligula. Nunc in dolor id sapien facilisis porttitor id vitae magna. Integer pretium faucibus felis, vitae tristique est condimentum egestas. Suspendisse potenti. Duis auctor molestie sapien, sed vestibulum dolor ornare in. Praesent lacus purus, luctus non suscipit eget, aliquet in nunc. Etiam bibendum, erat ut blandit vehicula, augue diam vestibulum ipsum, ut imperdiet libero est sit amet tortor. Quisque gravida porttitor augue, eu hendrerit libero ullamcorper eget. Sed at tortor nisi, a luctus nunc. Curabitur in fringilla velit. Nulla elementum hendrerit ante ac faucibus. Mauris ultrices pretium erat sit amet scelerisque.
</p>
<p>
Integer dictum diam vel orci laoreet vehicula. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Donec eu commodo dui. Quisque a diam mauris. Curabitur ornare sollicitudin ligula, in fringilla ligula porttitor et. Proin bibendum tincidunt orci, eget iaculis sem venenatis et. Integer eu eros magna, sed placerat augue. Cras eget est purus. Duis convallis gravida tempus. Curabitur a dolor ut nisl sodales rutrum. Maecenas eget diam quis turpis scelerisque mattis eget ac sapien. Sed commodo mattis tellus, sit amet tempor ligula placerat at.
</p>
<p>
Sed ornare faucibus tincidunt. Sed suscipit metus a massa feugiat dignissim. Maecenas auctor vulputate placerat. Vivamus pulvinar pharetra tincidunt. Nunc tempus ornare interdum. Vestibulum vitae magna lorem, quis luctus augue. Phasellus quam leo, dignissim vitae semper a, iaculis et lacus. Sed elit nunc, interdum sit amet dictum vitae, fermentum eget lorem. Phasellus nisi dui, varius ut lacinia et, condimentum sed tortor. Fusce eu orci et justo rutrum varius sit amet quis enim. Suspendisse id urna eget odio pellentesque lacinia in ut neque. Vestibulum ante lectus, placerat ac mattis vitae, tincidunt quis tortor. Morbi vel sem ut quam dignissim faucibus ut eu lorem. Aliquam laoreet arcu nec urna eleifend consectetur. Suspendisse potenti.
</p>
<h2>Bar</h2>
<p>
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam eu sollicitudin urna. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. In tincidunt magna vel quam auctor sit amet tincidunt lacus euismod. Praesent bibendum odio nec nisl tempus dictum. Cras aliquet condimentum est luctus accumsan. Aenean lectus lacus, malesuada eu dictum eu, euismod ac purus. Aliquam ultrices egestas elit, nec scelerisque lorem suscipit in. In auctor bibendum ullamcorper. Aenean lectus arcu, fermentum sed aliquet quis, tristique vestibulum est. In nisi ligula, consequat non semper vitae, pharetra vel risus. Nulla odio augue, tincidunt quis bibendum id, ullamcorper vel eros. Proin feugiat imperdiet tellus, ut porttitor massa eleifend in. Praesent sed nisl sed dui vestibulum auctor. Maecenas viverra feugiat erat adipiscing porttitor. Aenean mattis tincidunt placerat.
</p>
<p>
Fusce aliquam, dui a facilisis porttitor, nisi dolor semper dolor, ac vestibulum elit lorem id lorem. Nam ut odio eros. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse consequat tempor volutpat. Vestibulum cursus purus et nulla dignissim suscipit. Cras convallis dolor nec dolor volutpat vel rutrum magna eleifend. Nullam eget lorem orci. Vestibulum vel aliquam ligula.
</p>
<p>
Aliquam in tellus odio, ut gravida ante. Vestibulum vitae diam elementum dui ultricies hendrerit quis vitae ante. Vestibulum vel metus metus. Nulla in nulla et risus dictum lobortis at ac ligula. Nunc in dolor id sapien facilisis porttitor id vitae magna. Integer pretium faucibus felis, vitae tristique est condimentum egestas. Suspendisse potenti. Duis auctor molestie sapien, sed vestibulum dolor ornare in. Praesent lacus purus, luctus non suscipit eget, aliquet in nunc. Etiam bibendum, erat ut blandit vehicula, augue diam vestibulum ipsum, ut imperdiet libero est sit amet tortor. Quisque gravida porttitor augue, eu hendrerit libero ullamcorper eget. Sed at tortor nisi, a luctus nunc. Curabitur in fringilla velit. Nulla elementum hendrerit ante ac faucibus. Mauris ultrices pretium erat sit amet scelerisque.
</p>
<p>
Integer dictum diam vel orci laoreet vehicula. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Donec eu commodo dui. Quisque a diam mauris. Curabitur ornare sollicitudin ligula, in fringilla ligula porttitor et. Proin bibendum tincidunt orci, eget iaculis sem venenatis et. Integer eu eros magna, sed placerat augue. Cras eget est purus. Duis convallis gravida tempus. Curabitur a dolor ut nisl sodales rutrum. Maecenas eget diam quis turpis scelerisque mattis eget ac sapien. Sed commodo mattis tellus, sit amet tempor ligula placerat at.
</p>
<p>
Sed ornare faucibus tincidunt. Sed suscipit metus a massa feugiat dignissim. Maecenas auctor vulputate placerat. Vivamus pulvinar pharetra tincidunt. Nunc tempus ornare interdum. Vestibulum vitae magna lorem, quis luctus augue. Phasellus quam leo, dignissim vitae semper a, iaculis et lacus. Sed elit nunc, interdum sit amet dictum vitae, fermentum eget lorem. Phasellus nisi dui, varius ut lacinia et, condimentum sed tortor. Fusce eu orci et justo rutrum varius sit amet quis enim. Suspendisse id urna eget odio pellentesque lacinia in ut neque. Vestibulum ante lectus, placerat ac mattis vitae, tincidunt quis tortor. Morbi vel sem ut quam dignissim faucibus ut eu lorem. Aliquam laoreet arcu nec urna eleifend consectetur. Suspendisse potenti.
</p>​ 
```

为什么单击标有“栏”的内联锚点不会转到页面上的任何位置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T18:26:19.673

~~您的链接正在寻找名称为“bar”而不是“foo”的元素。~~

`<a href="#bar">Bar</a>`如果 H2是现在`<h2 name="bar">Foo</h2>`而不是`<h2 name="foo">Foo</h2>`现在，会找到你的 H2。当您希望 H2 元素 (foo) 的 html 为“bar”时，您将其分配为 H2 的名称属性，这是锚点的 html。

~~您可以更改链接`<a href="#foo">Bar</a>`或更改 jQuery。~~

更新：您的代码应该适用于大多数元素，但是为了获得最大的兼容性，您可能还需要确保元素具有相同的 ID 和名称值。

HTML5 标准建议使用 ID 属性而不是 name 属性来指定锚点的名称。使用 ID 属性应该适用于所有现代浏览器中的 HTML4。

另见：[http](http://www.w3.org/TR/html401/struct/links.html#h-12.2.3) ://www.w3.org/TR/html401/struct/links.html#h-12.2.3和[http://www.w3.org/TR/html5/links.html#hyperlink](http://www.w3.org/TR/html5/links.html#hyperlink)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:27:22.317

听起来您想根据页面上元素的位置滚动。相反，您应该找到特定元素的偏移量（可以通过 jQuery 完成），然后`window.scrollTo(offset)`像这样调用：

```
<a href="#" class="scrollableLink">Bar</a>

$('.scrollableLink').click(function()
{
    // Some syntax might not be correct on the selector, but you get the general idea
    var offset = $('[name=' + $(this).text() + '").prop('offsetTop');

    window.scrollTo(offset);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T18:34:55.747

这`<a name=''><h2>Lorem Ipsum</h2></a>`是您正在寻找的语法。我使用 jQuery 的[wrap](http://api.jquery.com/wrap/)函数来添加正确的锚引用。 [摆弄你的想法](http://jsfiddle.net/8ZTEb/4/)

# javascript

```
$(function() {
        $("h2").each(function(index,elem) {
            $(this).wrap("<a name='"+$(this).text().toLowerCase()+"'></a>"); 
        });
    });​ 
```

# c - strcpy 会影响 c 语言中的 strcmp 结果吗？

> ID：10321544
> 
> 赞同：2
> 
> 时间：2012-04-25T18:24:02.373
> 
> 标签：c

编辑：更改标题以反映帖子中的两种方法。

我正在尝试比较c语言中的两个字符串，如下所示，但由于某种原因，它总是打印两个字符串不相等

```
#include <stdio.h>
#include <string.h>

int main()
{
    /* A nice long string */

    char test[30]="hellow world";

    char test2[30];

    // to copy string from first array to second array

    strcpy(test2, test);

    /* now comparing two stering*/

    if(strcmp(test2, test))
       printf("strigs are equal  ");
    else

    printf("not equal  \n");

    printf("value of first string  is %s and second string is %s",test,test2);
    printf("length of string1 is %zu and other string is %zu ",strlen(test2),strlen(test2));

} 
```

我总是得到输出

```
not equal  
value of first string  is hellow world and second string is hellow worldlength of string1 is 12 and other string is 12 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-25T18:25:42.100

您的问题在于您如何使用`strcmp`. `strcmp`当字符串相等时返回 0（计算结果为 false）（当字符串“有序”时返回正数，当字符串“无序”时返回负数）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-25T18:26:00.040

[当两个字符串相同时， strcmp](http://www.cplusplus.com/reference/clibrary/cstring/strcmp/)返回 0，并且在 C 中 0 的计算结果为 false。尝试：

```
if(strcmp(test2, test)==0) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-25T18:27:07.217

根据 C++ 参考 `Return value of strcmp -A zero value indicates that both strings are equal. -A value greater than zero indicates that the first character that does not match has a greater value in str1 than in str2; And a value less than zero indicates the opposite.`

改变你的条件`if(!strcmp(test2, test))`，它应该工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-25T18:26:15.877

如果字符串相等，strcmp() 返回 0。例如，参见[http://www.cplusplus.com/reference/clibrary/cstring/strcmp/](http://www.cplusplus.com/reference/clibrary/cstring/strcmp/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-25T18:27:08.647

`strcmp()`相等时返回 0

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-25T18:29:53.330

`strcmp`如果给定的两个字符串相等，则返回 0。

我还修正了一些拼写错误，最后`printf()`你打`strlen(test2)`了两次电话！- 也更正

```
#include <stdio.h>
#include <string.h>

int main()
{
    /* A nice long string */

    char test[30]="hello world";

    char test2[30];

    // to copy string from first array to second array

    strcpy(test2, test);

    /* now comparing two stering*/

    if(!strcmp(test2, test))
        printf("strigs are equal \n");
    else
        printf("not equal  \n");

    printf("value of first string is %s \nsecond string is %s \n", test, test2);
    printf("length of string1 is %zu \nsecond string is %zu \n",strlen(test), strlen(test2));

    return 0;
} 
```

输出：

```
$ ./a.out 
strigs are equal 
value of first string is hello world 
second string is hello world 
length of string1 is 11 
second string is 11 
$ 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-25T18:34:19.193

man strcmp: "strcmp() 函数比较两个字符串 s1 和 s2。如果发现 s1 分别小于、匹配或大于，它将返回一个小于、等于或大于零的整数s2。”

# jquery - 在我的 Rails 3 应用程序中实现 jQuery Masonry 时遇到问题

> ID：10321545
> 
> 赞同：1
> 
> 时间：2012-04-25T18:24:08.123
> 
> 标签：jquery, ruby-on-rails, ruby-on-rails-3, jquery-masonry

我正在尝试在我的应用程序中实现 jQuery 砌体，但没有让它工作。

我认为问题在于我试图将其应用于表格，而不是 div。有人可以看看并确认吗？我如何解决它？

我想应用 jquery masonry 的页面只是一个简单的 index.html.erb 页面，它显示了所有用户的帖子。我想让这些出现在 3 列中，在不同高度的框中。

谢谢，

费萨尔

**帖子>索引.HTML.ERB**

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
<script src="/app/assets/javascripts/jquery.masonry.min.js"></script>

<table class="table table-striped">
<script type="text/javascript"> 
$('#container').masonry({
    itemSelector: '.box',
    columnWidth : 100 
});
</script>
<tbody>
<% @posts.each do |post| %>
<tr>
<td>I am a <%= post.title %> getting married in <%= post.job %> in <%= post.location %>, and looking for a <%= post.salary %>. My budget is <%= post.salary %>.</td>
<td><%= time_ago_in_words(post.created_at) %> ago.</td>
</tr>
<% end %>
</tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T18:37:04.037

确保使用脚本的实际路径更新“/path/to/jquery.masonry.min.js”

这是我即时执行的一个工作示例[http://jsfiddle.net/D7QQU/1/](http://jsfiddle.net/D7QQU/1/)：

```
 <script src="//ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
  <script src="/path/to/jquery.masonry.min.js"></script>
  <style>
    .item {
      width: 220px;
      margin: 10px;
      float: left;
    }
  </style>
  <script> 
    $('#container').masonry({
       itemSelector: '.box',
        columnWidth : 100 
    });
  </script>

  <div id="container">
    <% @posts.each do |post| %>
      <div class="item"> I am a <%= post.title %> getting married in <%= post.job %> in    <%= post.location %>, and looking for a <%= post.salary %>. My budget is <%= post.salary %>.
      <%= time_ago_in_words(post.created_at) %> ago.</div>
    <% end %>
  </div> 
```

​据我所见，它使用 div 而不是表格单元格。

如果您还需要帮助，请告诉我。

**编辑：**

根据您在下面的评论：

您需要将其添加到使用它的页面顶部。它将在资产中找到 js。

如果使用 3.2，则 jquery 默认在其中，只需使用 rails jquery:install 命令

```
<%= javascript_include_tag('jquery.masonry.min') %> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T06:28:49.623

如果您的资产文件夹中有 Masonry 文件，它将被编译，因此无需为其添加 javascript_include_tag。同样正如 D3mon-1stVFW 提到的，如果您使用的是 Rails 3.2，则默认包含 jQuery，因此也不需要该脚本标记。

此外，在您的脚本中，您应该将 itemSelector 的类名与 div 元素的名称相匹配。在您的情况下，您的 div 元素属于 class="item"，因此：

```
<script> 
    $('#container').masonry({
       itemSelector: '.item',
       columnWidth : 100 
    });
</script> 
```

这应该会让你在你的项目中走得更远。

# jquery - jquery 选项卡中的复选框与 Chrome 和 Firefox 中的点击行为不同

> ID：10321551
> 
> 赞同：0
> 
> 时间：2012-04-25T18:24:33.590
> 
> 标签：jquery, firefox, checkbox, jquery-ui-tabs

我有一个 jquery UI 选项卡，选项卡标题上有复选框，例如[http://jsfiddle.net/bSdbG/494/](http://jsfiddle.net/bSdbG/494/)

它在 Chrome 中运行良好，但在 Firefox 中，如果您单击当前打开的选项卡的复选框，页面将滚动到选项卡内容。我怎样才能防止这种情况发生？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:44:57.503

您可以将输入放在 a 之外，然后使用 css 重新设置样式。

[http://jsfiddle.net/bSdbG/497/](http://jsfiddle.net/bSdbG/497/)

问题是 jquery 的 a 元素的单击处理程序正在运行。

# objective-c - NSFetchedResultsController，分组 UITableView、HeaderInSection 和 NSSortDescriptor

> ID：10321553
> 
> 赞同：1
> 
> 时间：2012-04-25T18:24:48.053
> 
> 标签：objective-c, core-data, ios5

我有一个带有 NSSortDesctriptors 的 NSFetchRequest 附加到 NSFetchedResultController 为处于分组模式并显示部分标题的 UITableView 提供数据（参见表示例）。

我在正确排序以显示部分时遇到了一些问题。

**数据：**

```
+---+----------+------------+----------+
|id | subTitle | groupTitle | distance |
+---+----------+------------+----------+
|1  | A        | T1         | 1.1      |
+---+----------+------------+----------+
|2  | B        | T1         | 1.2      |
+---+----------+------------+----------+
|3  | C        | T1         | 3.0      |
+---+----------+------------+----------+
|4  | D        | T2         | 1.3      |
+---+----------+------------+----------+
|5  | E        | T2         | 1.4      |
+---+----------+------------+----------+
|6  | F        | T3         | 1.5      |
+---+----------+------------+----------+ 
```

**我有的：**

`NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"groupTitle" ascending:YES];`

```
--T1
------A
------B
------C
--T2
------D
------E
--T3
------F 
```

**我想要什么：（按距离排序，但对同一组中的以下每个项目按 groupTitle 分组）**

`NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"distance" ascending:YES];`

```
--T1
------A
------B
--T2
------D
------E
--T3
------F
--T1
------C 
```

**我怎样才能实现这种行为？**可能使用 viewForHeaderInSection 方法？如果要分组的部分不在第一个层次结构中`[self.fetchedResultsController sections]`怎么办？

```
//custom header
- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section
{
    id<NSFetchedResultsSectionInfo> sectionInfo = [[self.fetchedResultsController sections] objectAtIndex:section];
    SomeObject *cellEntity = (SomeObject *)[[sectionInfo objects] objectAtIndex:0];
    //cellEntity.groupTitle is the title 
    return aView;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T14:00:08.357

您是否尝试过以这种方式设置您的 NSFetchedResultsController？这应该首先按组标题排序，然后按距离排序。然后它应该由小组打破它。

```
NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:@"MyEntity"];
NSSortDescriptor *groupTitleSort = [NSSortDescriptor sortDescriptorWithKey:@"groupTitle" ascending:YES];
NSSortDescriptor *distanceSort = [NSSortDescriptor sortDescriptorWithKey:distance ascending:YES];
NSArray *sortArray = [NSArray arrayWithObjects:groupTitleSort, distanceSort, nil];
request.sortDescriptor = sortArray;
NSFetchedResultController *fetchedResults = [[NSFetchedResultsController alloc] initWithFetchRequest:request managedObjectContext:myManagedObjectContext sectionNameKeyPath:@"groupTitle" cacheName:@"MyCache"];

...Finish performing fetch... 
```

# java - 任何支付网关的购物车 API？（至少需要支付宝）

> ID：10321554
> 
> 赞同：17
> 
> 时间：2012-04-25T18:24:49.277
> 
> 标签：java, api, paypal, e-commerce, gateway

我正在尝试找到一个基于 java 的 API，它至少包含处理信用卡交易或通过 PayPal 购买的详细信息，以及其他网关作为 IPN 方式的加分项（即不需要产品，只需发票金额）

作为一种简化，我认为我应该能够执行以下伪代码之类的操作：

```
shoppingApi.postTransaction("paypal", amount, currency, invoiceId, purchaseDescription) 
```

稍后在计划任务期间或来自 IPN url 的通知中：

```
completedPayments = shoppingApi.getUnprocessedCompletedPayments();
for (Payment payment: completedPayments)
{
  // my code to process a successful payment.
} 
```

然后我会处理购买。

我知道有很多购物车可以做到这一点，但据我所见，他们都希望您将产品放入他们的系统中，这对我不起作用。我的产品在第 3 方系统中，我只想处理付款。就这样。

而且我所知道的购物车都没有像我上面建议的那样公开一个简单的 API。我不在乎我的用户使用什么付款方式，我只想知道他们是否完成了付款。我知道 Shopify.com 有一个 REST api 可以做这样的事情，但它不像 IPN（它希望你的产品在它的系统中）。

在此先感谢您的任何建议！

**编辑：**我当然知道我需要查看其他状态，例如“待处理”等，但这只是另一个简单的 API 调用，例如 shoppingApi.getPendingPayments()。如果 API 进行了上述 2 次调用，我会很高兴 ;-)

**编辑 2：**我更喜欢开源，但如果是固定费用，我完全可以商业化，可以在一定程度上试用，并且相当成熟/受人尊敬

**编辑 3 - 主要注意事项：**我相信应该存在这样的图书馆。会不会是另外一个问题。所以要明确一点，我真的很想看到“是的，使用这个库”的答案，而不是“不”，这是无法完成的，因为我 %99.999 确定它可以完成 ;-) 提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T16:48:02.880

我会说最好编写自己的*api*，因为与付款和购买流程相关的任何事情都需要花钱才能获得。您的应用需要以下内容才能完成：

1.  您需要一个与*PayPal*（或 *DataTrans*或任何其他支付系统）通信的服务器
2.  您需要一个数据库来捕获所有转移的付款：

    *   已经解决的
    *   已付款但尚未收到结算
    *   那还是要还的
    *   分期付款已完成、已完成或尚未完成
3.  服务器需要是具有一定安全性（*acegi*，*spring*）的任何网络应用程序（ *spring* with *hibernate等）*

***   每次用户登录并开始在线购买时，您都需要调用*PayPal*并在用户浏览器的回调中获得响应*   每次达成和解时，您都会将所需的数据保存在数据库中，例如`user-id` `purchase-method` `owner` `card-number` `invoice-id` `PayPal -token`**

 **我希望这有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T07:21:06.707

您无法获得用于支付网关集成的 API。您必须编写自己的开发来处理各种支付网关。为此，您必须了解哪个支付网关获取哪些参数及其请求支付网关的请求 URL。您可以通过各种支付网关网站获取此信息。

这个网址可能对你有帮助

对于 HDFC：[http ://www.hdfcbank.com/sme/sme-details?id=guzh6m0i](http://www.hdfcbank.com/sme/sme-details?id=guzh6m0i)

对于贝宝：[https ://merchant.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=merchant/payment_gateway](https://merchant.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=merchant/payment_gateway)

安全支付：[http ://www.securepay.com.au/](http://www.securepay.com.au/)

techpro [ICICI]：[http ://forums.devarticles.com/asp-development-3/how-to-integrate-payseal-icici-payment-gateway-95329.html](http://forums.devarticles.com/asp-development-3/how-to-integrate-payseal-icici-payment-gateway-95329.html)

在这里，您还可以找到开发 API 或开发指南，了解它们处理请求所需的参数。

希望这可以帮助你。

享受 ！！！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T07:23:39.877

我只知道这个产品（商业）：[IBM WebSphere Commerce Payment](http://www-01.ibm.com/software/genservers/commerce/payments/) 还有一个与 PayPal 集成的教程：[与 PayPal 集成](http://www.ibm.com/developerworks/websphere/tutorials/1101_song/index.html?ca=drs-)

我不知道许可证费用，您必须为此联系 IBM。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-15T21:38:11.387

有[这个网站](https://github.com/Shopify/active_merchant)可以通过`jruby`.
这可能会或可能不会满足您的要求。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-16T23:51:36.557

此处提供 Java SDK - [https://www.x.com/developers/paypal/documentation-tools/paypal-sdk-index](https://www.x.com/developers/paypal/documentation-tools/paypal-sdk-index)

它们都带有一个很好的方便示例（检查 README.md 文件），它将帮助您入门。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-22T07:29:02.107

虽然线程很老，但我只是想添加我最近遇到的 API 的详细信息，这可能符合问题的要求。我希望这会帮助其他正在寻找类似答案的人。

尝试[购物者](http://www.shopizer.com/#!/)。这个 API 建立在 Java、Spring、Hibernate、jQuery 和 elasticsearch 之上。**

# c++ - 标记字符串以存储值的好方法？或替代用户输入

> ID：10321563
> 
> 赞同：0
> 
> 时间：2012-04-25T18:25:27.607
> 
> 标签：c++

你好 Stackoverflow，我又来这里为我的 C++ 编程课提问了。我面临的问题主要是由于用户从键盘输入。我需要能够接受用户输入来决定调用什么函数以及给函数提供什么参数。例如，`add 5`会使用参数 5 调用 add 函数。起初我尝试重载 >> 运算符以同时获取字符串和 int 但我遇到的问题是程序无法在没有 int 的情况下获取输入，例如`deletemax`所以我不得不放弃这个想法。所以现在我回到对输入进行标记，但我们不允许在这个程序中使用 Boost，所以我想出了这样的东西使用 sstream

```
 bool out = false;
string token;
string In;
int num;

do
{
    cout << "heap> ";
    cin >> In;
    istringstream iss(In);
    while(getline(iss, token, ' '))
    {
      cout << token << endl; //I know this is incorrect but just not what to replace it with
    }
    out = ProcessCommand (token, num); //Takes string and int to call correct functions
} while (out != true); 
```

问题在于我不太确定如何正确标记字符串，因此我可以获得 2 个字符串并将第二个字符串转换为 int。谁能给我一些帮助？我将不胜感激。另外，如果有比我尝试的更好的方法来解决这个问题，我也想听听。

感谢你给与我的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:42:51.133

谷歌搜索“C++ string tokenize”会给你带来很多点击，第一个点击是在 Stackoverflow 上。但你应该试一试。我猜这是练习的重点。

您说“argumentS”，这表明您支持的命令采用不同数量的参数。我会这样分解：

1.  从用户那里读取一行
2.  在空间边界上将行拆分为“令牌”，将令牌存储在列表中
3.  根据列表中的第一个标记，选择要执行的命令
4.  将令牌列表传递给命令，因此它可以验证/解释它们作为参数

棘手的部分是#2。你知道容器类吗？您可以使用`vector<string>`来存储您解析的块。要进行实际解析，您需要遍历字符串的字符。跳过空白，直到找到非空白字符（或用完字符）。保存这个位置：`start`。然后跳过非空格，直到找到空格（或用完字符）。保存这个位置：`end`。复制 from `start`to之间表示的子字符串`end`并将其复制到您的令牌列表中。

如果您以前从未这样做过，那么确定这方面的实际细节，确保您没有错误等将是具有挑战性的，我猜这就是重点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:33:56.183

您不需要一次阅读整个用户输入。

例如，您可以读取用户输入的第一位（操作`add`或`deletemax`等）。从那里根据操作，您可以继续从输入中读取参数（在 的情况下`add`）或立即开始执行操作（在 的情况下`deletemax`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T18:46:34.460

一种方法是将一个`std::map`函数名作为键，并将所需数量的参数作为值。您将读取一行输入，获取函数名称，然后决定是否需要其他参数。如果输入无效，我会编写一个函数，该函数会返回`vector`从字符串流或空向量中提取的参数。

# python - 带有 psycopg2 插件的 Django

> ID：10321568
> 
> 赞同：6
> 
> 时间：2012-04-25T18:25:41.283
> 
> 标签：python, django

到目前为止，我一直在阅读 Django Book 和它的精彩内容，除非某些东西不能正常工作。我已经尝试了两天来安装 psycogp2 插件，但没有成功。

我导航到解压缩的目录并运行 setup.py install 并返回“您必须具有用于构建服务器端扩展的 postgresql dev 或用于客户端的 libpq-dev。”

我不知道这意味着什么，谷歌返回的结果抛出了很多我不太了解的术语。

我已经尝试学习 django 一周了，再加上 linux，所以任何帮助都会很棒。谢谢

顺便说一句，我已经从安装包中安装了 postgresql 和 pgadminIII。

我也尝试了 sudo apt-get post.... 并且发生了一些事情...但我迷路了。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-07-10T17:26:10.900

我在部署过程中使用 pip，所以使用 apt-get 对我来说不是一个可行的选择。

我能够跑

```
sudo apt-get install libpq-dev 
```

并从 apt-get 中删除 python-psycopg2。

然后

```
pip install psycopg2 
```

对我来说很好。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-25T18:33:56.567

尝试使用 apt-get 安装：

```
sudo apt-get install python-psycopg2 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-03-20T09:33:53.863

我正在使用 Xubuntu (12.04)，当我想安装`django-toolbelt`. 我通过以下操作解决了这个错误：

*   sudo apt-get install python-dev
*   sudo apt-get install libpq-dev
*   sudo apt-get install python-psycopg2

我希望这些信息对其他人有帮助。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-11-21T14:55:46.863

sudo apt-get install python-psycopg2 should work fine since it worked solution for me as well.

# oracle - Oracle - 从引用游标中选择特定列

> ID：10321571
> 
> 赞同：11
> 
> 时间：2012-04-25T18:25:55.780
> 
> 标签：oracle, stored-procedures, database-cursor

我的情况：

*   我有一个名为 Table1 的表。它有很多列，其中之一是 Column1。我不知道其他列，它们有时甚至可能会改变。
*   有一个强类型的 ref 游标类型，它返回 Table1%rowtype，名为 cur_Table1。
*   我有一个名为 SP1 的存储过程，它有一个 cur_Table1 类型的 out 参数。我从另一个数据库调用这个 SP1 存储过程，该数据库只看到这个存储过程，而不是表或类型本身。

如何从返回的游标中仅选择 Column1？

我知道我可以提取一条记录或与游标有列一样多的变量，但我只知道一列的存在，所以我不能声明完整的记录或正确数量的变量。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-26T06:03:06.863

你可以用 来做到这一点`DBMS_SQL`，但它并不漂亮。

**表和示例数据（COLUMN1 的编号为 1 - 10）：**

```
create table table1(column1 number, column2 date, column3 varchar2(1000), column4 clob);

insert into table1
select level, sysdate, level, level from dual connect by level <= 10;
commit; 
```

**带有打开引用游标并选择所有内容的过程的程序包：**

```
create or replace package test_pkg is
    type cur_Table1 is ref cursor return table1%rowtype;
    procedure sp1(p_cursor in out cur_table1);
end;
/

create or replace package body test_pkg is
    procedure sp1(p_cursor in out cur_table1) is
    begin
        open p_cursor for select column1, column2, column3, column4 from table1;
    end;
end;
/ 
```

**从引用游标读取 COLUMN1 数据的 PL/SQL 块：**

```
--Basic steps are: call procedure, convert cursor, describe and find columns,
--then fetch rows and retrieve column values.
--
--Each possible data type for COLUMN1 needs to be added here.
--Currently only NUMBER is supported.
declare
    v_cursor sys_refcursor;
    v_cursor_number number;

    v_columns number;
    v_desc_tab dbms_sql.desc_tab;
    v_position number;
    v_typecode number;
    v_number_value number;
begin
    --Call procedure to open cursor
    test_pkg.sp1(v_cursor);
    --Convert cursor to DBMS_SQL cursor
    v_cursor_number := dbms_sql.to_cursor_number(rc => v_cursor);
    --Get information on the columns
    dbms_sql.describe_columns(v_cursor_number, v_columns, v_desc_tab);

    --Loop through all the columns, find COLUMN1 position and type
    for i in 1 .. v_desc_tab.count loop
        if v_desc_tab(i).col_name = 'COLUMN1' then
            v_position := i;
            v_typecode := v_desc_tab(i).col_type;

            --Pick COLUMN1 to be selected.
            if v_typecode = dbms_types.typecode_number then
                dbms_sql.define_column(v_cursor_number, i, v_number_value);
            --...repeat for every possible type.
            end if;
        end if;
    end loop;

    --Fetch all the rows, then get the relevant column value and print it
    while dbms_sql.fetch_rows(v_cursor_number) > 0 loop
        if v_typecode = dbms_types.typecode_number then
            dbms_sql.column_value(v_cursor_number, v_position, v_number_value);
            dbms_output.put_line('Value: '||v_number_value);
        --...repeat for every possible type
        end if;
    end loop;   
end;
/ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-27T06:38:44.193

鉴于最初的问题，jonearles 的答案仍然是正确的，所以我将它标记为这样，但我最终做了一些完全不同的事情并且更好。

问题是/是我无法控制 SP1 的数据库，我只需要作为第 3 方客户端从其他地方调用它。现在我设法获得了不仅可以查看 SP 的权限，还可以查看光标的类型。我仍然看不到表格，但现在有一个更清洁的解决方案：

在另一个数据库中，我现在被授予查看此类型的权限：

```
type cur_Table1 is ref cursor return Table1%rowtype; 
```

所以在我的数据库中我现在可以这样做：

```
mycursor OtherDB.cur_Table1;
myrecord mycursor%rowtype;
...
OtherDB.SP1(mycursor);
fetch mycursor into myrecord;
dbms_output.put_line(myrecord.Column1); 
```

看，我仍然不需要对表格的任何访问，我只看到光标。关键是神奇的 %rowtype 也适用于游标，而不仅仅是表。它不适用于 sys_refcursor，但它适用于强类型。鉴于此代码，我不必关心另一侧是否有任何更改，我根本不必定义所有列或记录，我只需指定我感兴趣的一个列。

我真的很喜欢这种关于 Oracle 的 OOP 态度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T19:33:56.583

不知道它是否是一个选项，但不是更好的解决方案是创建一个返回您正在寻找的特定值的函数吗？这避免了发送额外数据的开销。或者，您可以定义一个游标，其中包含双方都知道的一组已知字段。

# c# - 实体框架、存储库模式、工作单元和测试

> ID：10321582
> 
> 赞同：3
> 
> 时间：2012-04-25T18:26:28.013
> 
> 标签：c#, .net, entity-framework, repository-pattern, unit-of-work

因此，我一直在尝试重新设计我最近投入生产的项目中的数据访问。

我开始阅读有关存储库和工作单元模式的内容，这让我很感兴趣。我以前从未使用过 TDD，但我想我可能会试一试。

我正在做的事情并不重要，所以对我来说，更好地理解更多的是一种爱好。

我有一些工作，但想看看我是否完全错过了标记。这就是我所拥有的......（为简单起见，我将使用 Sln 而不是解决方案的名称）

```
Sln.DataAccess
+ Entities
  + Person.cs (contains the model definition of a Person)
  + IIdentifiedObject.cs (just an interface demanding a (Guid)Id property)
+ Repositories
  + IRepository.cs[1]
+ IUnitOfWork.cs[2]

Sln.DataAccess.Memory
+ PersonRepository.cs[3]
+ Context.cs[4]
+ GenericRepository.cs[5]
+ UnitOfWork.cs[6]

Sln.DataAccess.Sql (I suppose this could be Sln.DataAccess.EF but anyway...)
+ PersonRepository.cs
+ Context.cs
+ GenericRepository.cs
+ UnitOfWork.cs

Sln.Test
+ Various unit tests. 
```

SQL Context/Repository/etc...*本质上*是相同的，只是它通过实体框架而不是内存列表访问数据库。

我要问的真正问题是我是否错过了整个 Repository/UnitOfWork 模式的标记，或者是否有任何建议任何人都可以提供我可以改进的地方。

这里是源文件。

*   [1] [https://gist.github.com/fddf625b1ee10bc0420a](https://gist.github.com/fddf625b1ee10bc0420a)
*   [2] [https://gist.github.com/a020a016dd695309cb5c](https://gist.github.com/a020a016dd695309cb5c)
*   [3] [https://gist.github.com/5f774e5f8dbcd41b1119](https://gist.github.com/5f774e5f8dbcd41b1119)
*   [4] [https://gist.github.com/9ab621962a5ea04403da](https://gist.github.com/9ab621962a5ea04403da)
*   [5] [https://gist.github.com/a6d8f5f1b5fdcbbfaaf6](https://gist.github.com/a6d8f5f1b5fdcbbfaaf6)
*   [6] [https://gist.github.com/7df0dca18489dd5555f8](https://gist.github.com/7df0dca18489dd5555f8)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:46:31.683

没有标准的方法来做一个存储库。它旨在抽象*某些东西*，但对于不同的人来说，某些东西可能是不同的东西。有些人有通用的查询方法，有些人只在 repo 本身有专门的查询。

我会首先考虑用例并设计存储库以适用于这些用例。设计一个地址簿应用程序并考虑您的存储库是否可以方便地提供必要的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T18:43:13.503

好的，所以我实现了我想要的。

在 Git 上查看我创建的这个项目（它应该是打开的），它准确地展示了我想要的。

Sln.DataAccess 程序集对数据实际存储方式的引用绝对为零，其中没有类，只有定义访问对象的方式和这些对象的结构的接口。

持久化的实际方式（内存或数据库）完全隐藏在它们各自的程序集之外。

[https://github.com/bmckenzie/projects](https://github.com/bmckenzie/projects)

我想修复的一件事是`Set<>()`我的内存上下文类中的方法，请看这里：[https ://github.com/bmckenzie/projects/blob/development/Projects.DataAccess.Memory/Context.cs](https://github.com/bmckenzie/projects/blob/development/Projects.DataAccess.Memory/Context.cs)

如果有人有任何建议，我宁愿避免这种情况`if() {}`并使用某种字典？

# c# - c#如何从多个文本文件中提取信息

> ID：10321583
> 
> 赞同：-1
> 
> 时间：2012-04-25T18:26:29.387
> 
> 标签：c#

我有一个处理条形码的项目。它基本上是一个库存跟踪程序，可以告诉我们在任何给定时间我们有什么库存。每个条形码都有一个包含相关信息的文本文件。每个文件包含以下信息行：

1.  “办公室打印机” <- 这是项目描述
2.  "1" <- 0 表示缺货，1 表示有货
3.  “无关信息” <- 排序中未使用的任何附加信息

大约有 200 多个不同的文本文件，我需要先搜索项目描述，然后再次搜索这些文件以查看它们是否有库存。理想情况下，它会显示一个整数，列出库存数量，但如果最简单的话，它也可以只显示文本文件的名称。到目前为止，这是我的代码。comboBox1 有一个可供搜索的可能项目的下拉列表。richTextbox1 是我用来显示搜索结果的设置。现在它只显示一个“1”。

**编辑**
感谢 VBRonPaulFan 的突破。这会根据组合框的选择显示有多少商品有库存。我要研究的唯一另一件事是让它显示库存商品的数量，而不是全部列出。谢谢！

```
 private void searchButton_Click(object sender, EventArgs e)
    {
        richTextBox1.Text = "";

        foreach (string fileName in Directory.GetFiles("C:\\ITRS_equipment_log\\", "*.txt"))
        {

            using (StreamReader sw = new StreamReader(fileName))
            {
                string Description = sw.ReadLine();
                bool InStock = sw.ReadLine().Trim() == "1";

                if (Description.Contains(comboBox1.Text) && InStock == true)
                {
                    richTextBox1.AppendText("Item '" + Description + "' is " + (InStock ? "in" : "not in") + " stock.\r\n");
                }
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:46:37.137

每次找到“匹配”时，都会用更新后的值覆盖richTextBox1 中的值。它不只是在第一个文件之后“停止”，它只是显示它在完成所有文件运行时设置的最后一个值......

目前尚不清楚您希望如何向用户显示它......但富文本框可能不是最好的方式。组合框可能会更好。这看起来基本上是你想要做的？

```
private void searchButton_Click(object sender, EventArgs e)
{
    foreach (string fileName in Directory.GetFiles("C:\\ITRS_equipment_log\\", "*.txt"))
    {
        using (StreamReader sw = new StreamReader(fileName))
        {
            string Description = sw.ReadLine();
            bool InStock = sw.ReadLine().Trim() == "1";

            if (Description.Contains(comboBox1.SelectedText))
            {
                richTextBox1.AppendText("Item '" + Description + "' is " + (InStock ? "in" : "not in") + " stock.\r\n");
            }
        }
    }
} 
```

# asp.net-mvc-3 - 为什么 EntLib 在我的源代码 App_Data 目录中查找我的数据库，而不是在 SQL Server 的正常位置？

> ID：10321589
> 
> 赞同：0
> 
> 时间：2012-04-25T18:27:01.920
> 
> 标签：asp.net-mvc-3, sql-server-2008, enterprise-library

我正在尝试使用 EntLib 5.0 从我的 MVC 应用程序调用存储过程。这是我的连接字符串（用于 SQL Server 2008）：

服务器=本地；数据库=测试；Trusted_Connection=True

我收到此错误：

```
An attempt to attach an auto-named database for file 
C:\dev\pestsApp_Data\aspnetdb.mdf failed. A database with 
the same name exists, or specified file cannot be opened, 
or it is located on UNC share. 
```

为什么 EntLib 在我的源代码目录中而不是在我的数据库所在的目录（默认位置）中查找？这是我的数据库的实际位置：

```
C:\Program Files\Microsoft SQL Server\MSSQL10_50.MSSQLSERVER\MSSQL\DATA 
```

如何使 EntLib 连接到该数据库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:28:32.247

在您的 web.config 中，您必须在 Connectionstrings 部分的开头放置一个。如果不这样做，您的应用程序将默认继承在根 web.config 中定义的连接字符串。

所以：

```
 <connectionStrings>
     <clear/>
     <add name="DefaultConnection" connectionString="Server=local;Database=Test;Trusted_Connection=True" />
  </connectionStrings> 
```

此问题与 EntLib 5.0 无关。

也许是错字？

C:\dev\pestsApp_Data\aspnetdb.mdf => C:\dev\pests\App_Data\aspnetdb.mdf

您的应用程序可以访问 C:\Program Files\Microsoft SQL Server\MSSQL10_50.MSSQLSERVER\MSSQL\DATA？默认情况下它不能。

# python - 如何为工作线程创建管理器？

> ID：10321590
> 
> 赞同：0
> 
> 时间：2012-04-25T18:27:02.707
> 
> 标签：python, multithreading, threadpool, pool

该代码适用于单个“管理器”，它基本上将一些 HTTP GET 发送到服务器。但我碰上了一堵砖墙。

我现在如何创建 2 个管理器，每个管理器都有自己的 Download_Dashlet_Job 对象和 tcp_pool_object？从本质上讲，经理们将指挥他们自己的工人从事两个不同的工作。这似乎是学习 Python 类的一个非常好的难题。

```
import workerpool
from urllib3 import HTTPConnectionPool

class Download_Dashlet_Job(workerpool.Job):
  def __init__(self, url):
    self.url = url
  def run(self):
    request = tcp_pool_object.request('GET', self.url, headers=headers)

tcp_pool_object = HTTPConnectionPool('M_Server', port=8080, timeout=None, maxsize=3, block=True)
dashlet_thread_worker_pool_object = workerpool.WorkerPool(size=100)

#this section emulates a single manager calling 6 threads from the pool but limited to 3 TCP sockets by tcp_pool_object
for url in open("overview_urls.txt"):
  job_object = Download_Dashlet_Job(url.strip())
  dashlet_thread_worker_pool_object.put(job_object)

dashlet_thread_worker_pool_object.shutdown()
dashlet_thread_worker_pool_object.wait() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T15:42:04.113

首先，`workerpool.WorkerPool(size=100)`创建 100 个工作线程。在下面的评论中，你是说你想要 6 个线程？您需要将其更改为 6。

为了创建第二个池，您需要创建另一个池。如果您愿意，您还可以创建另一个作业类，并将这种不同类型的作业添加到同一个池中。

# java - 启动画面后的活动

> ID：10321593
> 
> 赞同：1
> 
> 时间：2012-04-25T18:27:06.997
> 
> 标签：java, android, android-activity, splash-screen

一旦我的初始屏幕显示 1000 毫秒，我就会收到一条错误消息，指出“应用程序已意外停止。请重试。” 似乎应该在启动画面不工作后开始的活动。在启动画面之前，一切正常。Logcat 显示以下错误“ E/AndroidRuntime(5480): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.xxxxx.home/com.xxxxx.home.xxxxx}: java.lang.NullPointerException。我相信这个问题与我的 Splash Class 一起，但无法确定在哪里。任何见解将不胜感激。

公共类 Splash 扩展 Activity{

```
private final int SPLASH_DISPLAY_LENGTH = 1000;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.splash);

    new Handler().postDelayed(new Runnable(){
        @Override
        public void run() {

            Intent openxxxxx = new Intent("com.xxxxx.home.XXXXX");
            startActivity(openxxxxx);

        }
    }, SPLASH_DISPLAY_LENGTH);
} 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T18:30:44.093

这是您可以使用的完整代码，

```
package com.fsp.slideview;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.MotionEvent;
import android.view.Window;

public class ImageSplashActivity extends Activity {
    /**
     * The thread to process splash screen events
     */
    private Thread mSplashThread;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        setContentView(R.layout.splash);

        final ImageSplashActivity sPlashScreen = this;

        mSplashThread = new Thread() {
            @Override
            public void run() {
                try {
                    synchronized (this) {
                        wait(2000);
                    }
                } catch (InterruptedException ex) {
                }

                finish();
                Intent intent = new Intent();
                intent.setClass(sPlashScreen, SlideMainActivity.class);
                startActivity(intent);
            }
        };

        mSplashThread.start();
    }

    @Override
    public boolean onTouchEvent(MotionEvent evt) {
        if (evt.getAction() == MotionEvent.ACTION_DOWN) {
            synchronized (mSplashThread) {
                mSplashThread.notifyAll();
            }
        }
        return true;
    }
} 
```

# java - EditText 到 String 名称到不同的类

> ID：10321605
> 
> 赞同：0
> 
> 时间：2012-04-25T18:27:36.807
> 
> 标签：java, android

有一点问题，因为我想在我的应用程序上让用户输入 IP 地址，并让该 IP 条目用于连接到其他设备。在这两个类中，IPEntry 类被设置为通过 EditText 读取 IP 并将其转换为字符串。然后我希望它在我的 ClientUpload 类中传递和使用。显然，我曾试图解决这个问题，但无济于事。当我以以下方式使用它时，它说它找不到 IP，所以它没有传输。我也试图进入一个方法并调用它，但这也不起作用。有没有办法做到这一点？

谢谢

IPEntry 类

```
public class IPEntry extends Activity {

Button Submit;
EditText IP;
TextView Thistext;
public String ipadd;
public Intent intent;

@Override
protected void onCreate(Bundle savedInstanceState) {
  // TODO Auto-generated method stub
  super.onCreate(savedInstanceState);
  setContentView(R.layout.ipentry);
  Submit = (Button) findViewById(R.id.bIPSubmit);
  Thistext = (TextView) findViewById(R.id.tvTextIP);
  IP = (EditText) findViewById(R.id.edIPBar);   

  Submit.setOnClickListener(new View.OnClickListener() {

     @Override
     public void onClick(View v) {
           // TODO Auto-generated method stub

                     ipadd = IP.getText().toString();

           Intent Trans = new Intent("wishift.mat.ANDROIDEXPLORER");
           startActivity(Trans);
                     }              
                     }
  );
}} 
```

客户端上传类的相关部分

```
public class ClientUpload extends Thread{

IPEntry ipentry = new IPEntry();

public int UploadFile(File file) throws UnknownHostException, IOException
{

  //loop 
  int serverPort = 6880;                  
 //   String ip = "192.168.1.73";
  String ip = ipentry.ipadd;
  Socket socket = new Socket(ip, serverPort); 
```

如您所见，我注释掉了确实有效的部分，但我非常不想在代码中手动添加 IP。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T23:42:31.580

这里的问题是这里`IPEntry`创建的对象：`IPEntry ipentry = new IPEntry();`在 ClientUpload 中是一个***新*** `IPEntry`对象；它不共享相同的值`ipadd`。默认构造函数会将其设置为`null`.

有很多方法可以解决这个问题；您可以使用`String`IP 地址的参数向 ClientUpload 添加构造函数并将其保存在实例变量中，或者向 uploadFile() 方法添加另一个参数以接受 IP 地址。

您还可以设置varible ，允许在所有`ipadd`IPEntry`static`实例中访问它，尽管我不建议这样做，因为它完全没有必要，并且多个`IPEntry`对象将需要更多（不必要的）内存和开销。

# css - 如何让我的 Google Map V3 保留圆角？

> ID：10321606
> 
> 赞同：0
> 
> 时间：2012-04-25T18:27:45.273
> 
> 标签：css, google-maps-api-3

方形外观的方法非常不吸引人。

```
<div id ="container">
    <div id="map_canvas" style="width: 840px; height: 600px"></div>
</div> 
```

#container 上没有样式。我尝试了一种基于图像的方法，但它没有用，它引用的线程也死了。有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T18:29:02.097

CSS 圆角将不起作用。使用图像或 CSS 掩码。

[这是一个关于如何做 CSS 掩码的线程。](https://stackoverflow.com/questions/6894439/transparent-rounded-corners-on-google-map)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-04-25T18:59:02.943

假设您尝试过 CSS 圆角？

```
#container {
    border-radius: 20px;
    -webkit-border-radius: 20px;
    -moz-border-radius: 20px;
} 
```

# symfony-sonata - 如何将奏鸣曲媒体包与我的实体一起使用

> ID：10321609
> 
> 赞同：7
> 
> 时间：2012-04-25T18:28:13.503
> 
> 标签：symfony-sonata

我想将奏鸣曲媒体包用于我的包中的媒体。

我有一个实体应该有一个画廊。安装奏鸣曲媒体包并生成 easy:extends 后，有 3 个不同的实体：

*   媒体.php
*   图库.php
*   GalleryHasMedia.php。

如何将这些实体链接到我自己的实体以进行画廊实施？？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-09-05T07:10:15.873

您可以一对一链接。例如，我的实现：

配置.yml：

```
contexts:
        product:
            providers:
                - sonata.media.provider.image

            formats:
                big:   { width: 1680 , quality: 100} 
```

图库.php：

```
private $product; 
```

图库.orm.xml：

```
<one-to-one field="product" target-entity="Alteza\ProductBundle\Entity\Product" inversed-by="gallery">
        <join-column name="product_id" referenced-column-name="id" />
    </one-to-one> 
```

产品.php：

```
/**
 * @ORM\OneToOne(targetEntity="\Application\Sonata\MediaBundle\Entity\Gallery", mappedBy="product", cascade={"all"})
 */
private $gallery; 
```

产品管理员.php：

```
->add('gallery', 'sonata_type_model_list', array('required' => false), array('link_parameters'   => array('context' => 'product'))) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-05-06T12:29:05.490

以下是有关实现的文档：

[http://sonata-project.org/blog/2013/10/11/mediabundle-mediatype-improved](http://sonata-project.org/blog/2013/10/11/mediabundle-mediatype-improved)

# python - Python：向 Windows 控制台发送一些 Utf-8 字符串

> ID：10321611
> 
> 赞同：6
> 
> 时间：2012-04-25T18:28:19.237
> 
> 标签：python, encoding, windows-console

> **可能重复：**
> [Python、Unicode 和 Windows 控制台](https://stackoverflow.com/questions/5419/python-unicode-and-the-windows-console)

我从文件中读取了一些字符串，当我尝试在 Windows 控制台中打印这些 utf-8 字符串时，出现错误

```
UnicodeDecodeError: 'ascii' codec can't decode byte 0xc4 in position 0: ordinal not in range(128) 
```

我尝试使用**“chcp 65001”**将控制台编码设置为 utf-8 但我收到此错误消息

```
LookupError: unknown encoding: cp65001 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T13:57:40.593

我建议你在 stackoverflow 上查看类似的问题，其中有很多。

无论如何，你可以这样做：

1.  以任何编码（例如 utf8）从文件中读取，但将字符串**解码为 un​​icode**
2.  对于 Windows 控制台，输出**unicode**字符串。在这种特殊情况下，您不需要编码。您无需设置控制台编码，输出文本将自动正确编码。

对于文件，您需要使用编解码器模块或以适当的编码进行编码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T14:28:40.310

print 命令尝试将 Unicode 字符串转换为控制台支持的编码。尝试：

```
>>> import sys
>>> sys.stdout.encoding
'cp852' 
```

它向您展示了控制台支持的编码（告诉 Python 支持什么）。如果字符无法转换为该编码，则无法正确显示。

# c++ - 具有非专业模板类的 std::array

> ID：10321612
> 
> 赞同：1
> 
> 时间：2012-04-25T18:28:20.693
> 
> 标签：c++, templates, c++11

是否可以将某种非专业化的模板类作为模板参数传递给 std::array？类似的东西：

```
template <class T>
class Field{
};

std::array<Field> a; 
```

或者我必须定义一些 BaseField，并将其子类化为 IntField、StringField、FloatField....？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T18:31:56.857

您可以编写一个将模板作为参数的模板（也称为模板模板参数）。必须专门编写模板以将模板作为参数来允许它，并且`std::array`没有指定这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T18:39:19.587

使用别名模板，您可以非常接近 C++11：

```
template <typename T>
struct Field {}; 

template <typename T>
using FieldArray5 = std::array<Field<T>,5>;

int main() {

  FieldArray5<int> a0;

} 
```

但请记住，`std::array`大小也需要一个模板参数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T18:31:56.730

如果你想让 an`std::array`持有不同的类型，它只能通过多态来完成。你也可以使用`boost::any`它来隐藏你的多态性，但仍然实现它。

# c# - 正则表达式特殊字符

> ID：10321614
> 
> 赞同：0
> 
> 时间：2012-04-25T18:28:27.590
> 
> 标签：c#, regex

我有这个正则表达式的代码：

```
string lPattern = "\\S*[a-zA-Z]+\\S*";

System.Text.RegularExpressions.Regex lRegex =
    new System.Text.RegularExpressions.Regex(lPattern);

if (!lRegex.IsMatch(phone))
{
    return true;
} 
```

我想这样做，所以如果字符串中的空格 x 空格“ x ”也将返回 true。我将如何更改此正则表达式以包含此内容？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T18:32:19.493

```
" x |\\S*[a-zA-Z]+\\S*" 
```

还是我错过了什么？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T19:02:41.123

显然，此代码试图通过匹配电话号码中的任何字母字符来验证电话号码 - 如果匹配，则电话号码无效。

所以你想要任何字母字符（可选地嵌入在非空白字符中，尽管这些被列为可选，所以它们实际上是不相关的）除了序列`x`（空格 x 空格）来匹配和触发失败。

这听起来像您想接受人们将分机嵌入电话号码的情况，如： `123-123-1234 x 789`

```
.*([a-zA-Z])+(?<! x).* 
```

非常接近。

编辑：这使用负面的后视结构。 `(?<!`仅当从当前匹配位置开始，前面的字符与括号其余部分内的内容不匹配时，才允许正则表达式继续运行。因此，如果有领先优势`x`，它将导致比赛失败。

--

使用此正则表达式，以下内容不匹配：

*   123-123-1234
*   123-123-1234 x789
*   123-123-1234 x 789

但它确实匹配：

*   123-123a-1234
*   123-123 asdfasdf 12312
*   123-123x-123123
*   123-123 xfasdf

由于if 语句中的 ，匹配的那些是**无效的。**`!`

但是话虽如此，如果您将电话号码验证编写为积极验证（即您允许什么），而不是消极无效（您具体避免什么），您的代码会容易得多。通过编写您允许的内容，您将能够更轻松地防止边缘情况。

例如，两个正则表达式都不匹配以下内容：

*   123-###-1234
*   123-!$#&^(##^#*@#(!@&#(#-1234

这将从您的函数返回 true。那是你真正想要的吗？

我强烈建议积极验证，而不是消极无效。

* * *

编辑：@Aprillion 建议之前的链接问题： [电话号码验证的综合正则表达式](https://stackoverflow.com/q/123559/341547)

这显示了电话号码验证的复杂程度（特别是如果您要验证的国家/地区超过 1 个）。那里有很多很好的建议，尽管它不是万能的总结。我倾向于在前端只允许数字（带有可选的免费评论字段）用于电话号码输入。

我还必须承认，这确实让我对积极验证的信心降低了一点——**尤其是**如果你必须与一个任意的国际 # 打交道。

很多将取决于OP的实际要求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T18:39:33.467

```
string lPattern = @"^\s*[a-zA-Z]+\s*$";

// Start of string
// Zero or more white space
// Letters any case 1 or more
// Zero or more white space
// End of string

\S means anything other than whitespace
\s is to match for whitespace 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T19:25:38.653

如果您想验证电话号码，我还建议您改变逻辑 - 即尝试找到有效的电话号码而不是无效的电话号码。限制你想要匹配的东西比考虑你想要拒绝的所有可能性更容易。

我会使用这个正则表达式：

```
(\d+(?:-|\s)?)+(?:\s*x\s*\d+)? 
```

代码将变为：

```
string lPattern = @"(\d+(?:-|\s)?)+(?:\s*x\s*\d+)?";

        System.Text.RegularExpressions.Regex lRegex = new System.Text.RegularExpressions.Regex(lPattern);

        if (lRegex.IsMatch(phone)) return true; 
```

如果那不是您所追求的，那么您将不得不提供一些上下文。

# php - 从 post 数组中排除输入

> ID：10321622
> 
> 赞同：1
> 
> 时间：2012-04-25T18:28:48.333
> 
> 标签：php, drupal, post

在一个表单中（在 Drupal 中）我想要一个临时字段，不需要将它的值保存在数据库中。所以我需要一种方法来防止表单将字段的值发送到 $_POST 数组。是否可以？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T18:33:28.907

*   如果它在提交的表单之外，它不会被浏览器发送。
*   如果它没有`name`，则不会由浏览器发送。
*   如果它被禁用，它将不会由浏览器发送。

有关完整规则，请参阅[表单提交：成功控制](http://www.w3.org/TR/html401/interact/forms.html#h-17.13.2)。

也就是说，您的方法非常非常错误。您不应该根据来自客户端的内容来决定将哪些内容放入数据库。客户可以给你发送任何东西！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T18:31:09.070

只是不要给它`name=""`属性。

您也可以`$_POST`在将其放入数据库时​​将其从数组中排除

# java - 如何让 Jasper Reports 忽略文本字段中的换行符？

> ID：10321628
> 
> 赞同：1
> 
> 时间：2012-04-25T18:29:15.750
> 
> 标签：java, csv, jasper-reports, newline

每当我将 jasper 报告导出到 CSV 文件时，如果文本字段包含换行符，则 CSV 中的记录将显示为两行而不是一行。我们可以在 jasper 报告中进行任何设置，这会忽略文本字段中出现的换行符吗？我们使用 iReport 来设计 jasper 报表。任何形式的帮助表示赞赏。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T23:35:36.320

对我来说，这听起来不像是一个分隔符问题。您的源数据在某处有一个新行。JasperReports 导出报表中的数据，所以它有这个换行符。

这类似于具有读取“abcdefg”的源数据，并且您说您真的讨厌字母“d”，因此您不希望它出现在生成的 CSV 中。当然...新行在某些方面很特别...但它仍然只是一个字符。

您可以修改 CSV 导出器以去除回车符（或去除 'd's）。或者您可以修改您的查询以去除它们。如果您的源是 SQL，这将很简单。或者您可以修改您的文本字段表达式以将它们删除。例如，使用[Apache Commons Lang StingUtils](http://commons.apache.org/lang/api-3.0/org/apache/commons/lang3/StringUtils.html)删除或替换换行符。

# javascript - 在 muc room 中使用 Strophe 发送 XHTML 消息

> ID：10321629
> 
> 赞同：0
> 
> 时间：2012-04-25T18:29:18.267
> 
> 标签：javascript, xml, xmpp, strophe

我正在尝试使用 Strophe 将 html 消息发送到 muc 房间。我还尝试通过 Psi 中的 XML 控制台发送以下 xml，但它不起作用，只显示 Hello World。消息节有什么问题吗？

```
<message to="room@conference.server" type="groupchat"><body>Hello World </body><html xmlns="http://jabber.org/protocols/xhtml-im"><body xmlns="http://www.w3.org/1999/xhtml"><p style="color : red">Hello HTML World</p></body></html></message> 
```

谢谢！

Edit1：disco#info 房间查询。我现在使用的是 Vacuum-IM 和 Psi 客户端，但 Psi 应该支持 xhtml-im ( [http://psi-im.org/wiki/Supported_Protocols](http://psi-im.org/wiki/Supported_Protocols) )

```
<iq xmlns="jabber:client" from="room@conference.server" type="result" id="foo" to="admin@server/Vacuum-IM">
<query xmlns="http://jabber.org/protocol/disco#info">
  <identity xmlns="http://jabber.org/protocol/disco#info" category="conference" type="text" name="room"/>
  <feature xmlns="http://jabber.org/protocol/disco#info" var="http://jabber.org/protocol/muc"/>
  <feature xmlns="http://jabber.org/protocol/disco#info" var="muc_public"/>
  <feature xmlns="http://jabber.org/protocol/disco#info" var="muc_open"/>
  <feature xmlns="http://jabber.org/protocol/disco#info" var="muc_moderated"/>
  <feature xmlns="http://jabber.org/protocol/disco#info" var="muc_semianonymous"/>
  <feature xmlns="http://jabber.org/protocol/disco#info" var="muc_unsecured"/>
  <feature xmlns="http://jabber.org/protocol/disco#info" var="muc_persistent"/>
  <feature xmlns="http://jabber.org/protocol/disco#info" var="http://jabber.org/protocol/disco#info"/>
  <x xmlns="jabber:x:data" type="result">
    <field xmlns="jabber:x:data" type="hidden" var="FORM_TYPE">
      <value xmlns="jabber:x:data">http://jabber.org/protocol/muc#roominfo</value>
    </field>
    <field xmlns="jabber:x:data" label="Description" var="muc#roominfo_description">
      <value xmlns="jabber:x:data">asdf</value>
    </field>
    <field xmlns="jabber:x:data" label="Subject" var="muc#roominfo_subject">
      <value xmlns="jabber:x:data"/>
    </field>
    <field xmlns="jabber:x:data" label="Number of occupants" var="muc#roominfo_occupants">
      <value xmlns="jabber:x:data">1</value>
    </field>
    <field xmlns="jabber:x:data" label="Creation date" var="x-muc#roominfo_creationdate">
      <value xmlns="jabber:x:data">20120423T17:31:49</value>
    </field>
  </x>
</query> 
```

Edit2：对消息节的响应

```
 <message xmlns="jabber:client" from="room@conference.server/ad" type="groupchat" to="admin@server/Vacuum-IM">
<body xmlns="jabber:client">Hello World </body>
<html xmlns="http://jabber.org/protocols/xhtml-im">
  <body xmlns="http://www.w3.org/1999/xhtml">
    <p xmlns="http://www.w3.org/1999/xhtml" style="color : red">Hello HTML World</p>
  </body>
</html> 
```

Edit3：对 muc#traffic 查询的响应

```
<iq xmlns="jabber:client" from="room@conference.server" type="error" id="foo" to="admin@server/Vacuum-IM">
<query xmlns="http://jabber.org/protocol/disco#info" node="http://jabber.org/protocol/muc#traffic"/>
<error xmlns="jabber:client" type="cancel" code="404">
  <item-not-found xmlns="urn:ietf:params:xml:ns:xmpp-stanzas"/>
</error> 
```

Edit4：Psi 对客户端的响应（功能）disco#info（xhtml-im 是最后一个）

```
 <iq xmlns="jabber:client" from="admin@kossy.local/Kostyas-MacBook-Pro" type="result" to="admin@kossy.local/Vacuum-IM" id="foo">
<query xmlns="http://jabber.org/protocol/disco#info">
  <identity xmlns="http://jabber.org/protocol/disco#info" category="client" type="pc" name="Psi"/>
  <feature xmlns="http://jabber.org/protocol/disco#info" var="http://jabber.org/protocol/bytestreams"/>
  <feature xmlns="http://jabber.org/protocol/disco#info" var="http://jabber.org/protocol/si"/>
  <feature xmlns="http://jabber.org/protocol/disco#info" var="http://jabber.org/protocol/si/profile/file-transfer"/>
  <feature xmlns="http://jabber.org/protocol/disco#info" var="http://jabber.org/protocol/disco#info"/>
  <feature xmlns="http://jabber.org/protocol/disco#info" var="http://jabber.org/protocol/commands"/>
  <feature xmlns="http://jabber.org/protocol/disco#info" var="http://jabber.org/protocol/rosterx"/>
  <feature xmlns="http://jabber.org/protocol/disco#info" var="http://jabber.org/protocol/muc"/>
  <feature xmlns="http://jabber.org/protocol/disco#info" var="jabber:x:data"/>
  <feature xmlns="http://jabber.org/protocol/disco#info" var="urn:xmpp:jingle:1"/>
  <feature xmlns="http://jabber.org/protocol/disco#info" var="urn:xmpp:jingle:transports:ice-udp:1"/>
  <feature xmlns="http://jabber.org/protocol/disco#info" var="urn:xmpp:jingle:apps:rtp:1"/>
  <feature xmlns="http://jabber.org/protocol/disco#info" var="urn:xmpp:jingle:apps:rtp:audio"/>
  <feature xmlns="http://jabber.org/protocol/disco#info" var="http://jabber.org/protocol/chatstates"/>
  <feature xmlns="http://jabber.org/protocol/disco#info" var="http://jabber.org/protocol/mood+notify"/>
  <feature xmlns="http://jabber.org/protocol/disco#info" var="http://jabber.org/protocol/tune+notify"/>
  <feature xmlns="http://jabber.org/protocol/disco#info" var="http://jabber.org/protocol/physloc+notify"/>
  <feature xmlns="http://jabber.org/protocol/disco#info" var="http://jabber.org/protocol/geoloc+notify"/>
  <feature xmlns="http://jabber.org/protocol/disco#info" var="http://www.xmpp.org/extensions/xep-0084.html#ns-metadata+notify"/>
  <feature xmlns="http://jabber.org/protocol/disco#info" var="http://jabber.org/protocol/xhtml-im"/>
</query> 
```

Edit5：解决方案：获取 iChat 和 Adium :-) Adium 以不同的颜色和字体发送 xhtml 消息，但它不显示它自己做了什么。只有 iChat 才能正确呈现 xhtml。所以组合有效。也不要使用 p 标签，颜色应该是十六进制形式。例子：

```
<message xmlns="jabber:client" type="groupchat" to="room@conference.server">
<body xmlns="jabber:client">Hello World</body>
<html xmlns="http://jabber.org/protocol/xhtml-im">
  <body xmlns="http://www.w3.org/1999/xhtml">
    <span xmlns="http://www.w3.org/1999/xhtml" style="font-family: Times New Roman; font-size: large; color: #FF0000;">Red text</span>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T18:58:29.817

有可能房间不允许`xhtml-im`。您可以通过查询房间找到：

```
<iq to='room@conference.server'
    id='foo'
    type='get'>
  <query xmlns='http://jabber.org/protocol/disco#info'
         node='http://jabber.org/protocol/muc#traffic'/>
</iq> 
```

并检查是否`http://jabber.org/protocol/xhtml-im`在受支持的功能中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T21:47:29.067

据我所知，Psi 不支持 XHTML-IM。此类客户端将仅显示正常`<body>`内容。

不过，您的示例节是正确的，因此它要么正如 ggozad 建议的那样，服务器将其删除（某些服务器可以配置为执行此操作），要么只是客户端不呈现它。

尝试检查接收客户端的 XML 控制台，以查看`<html>`MUC 广播消息后子元素是否仍然存在。

# android - Android - 遍历 Zipentry

> ID：10321630
> 
> 赞同：1
> 
> 时间：2012-04-25T18:29:26.113
> 
> 标签：android, zip, zipfile

我在 ZIP 文件中有大量文件（比如说 1000 个图像、一些 db 文件、二进制文件……）。在其中，我有一些需要查找和解析的 xml 文件。来自它的信息显示在屏幕上。问题是，当我使用以下方法遍历 zip 条目时：

```
 InputStream inputStream = new FileInputStream(zipPath);
   in = new ZipInputStream(inputStream);

   for (ZipEntry entry = in.getNextEntry(); entry != null; entry = in.getNextEntry()) {
     ...some code here...
   } 
```

因此，当我使用 Log.d 时，我看到它正在逐个文件迭代，如果文件量很大，可能需要几分钟。有没有更好的方法，如何在 ZIP 文件中找到一个特定文件？我现在使用的“蛮力”方法非常耗时。

感谢您的任何想法

航点

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-05T06:53:04.890

提取特定文件时，您应该使用`ZipFile`. 特别是[ZipFile.getEntry()](https://developer.android.com/reference/java/util/zip/ZipFile.html#getEntry%28java.lang.String%29)。

这应该没问题，因为您使用的是文件。但是，如果您只有一个 InputStream（或者出于某种原因您更喜欢使用 ZipInputStream），那么如果您控制 zip 文件的构建方式，则应该将 XML 文件作为第一个条目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T20:24:28.243

您可能可以这样做：

```
BufferedReader in = new BufferedReader(new InputStreamReader(zipfile.getInputStream(entry))); 
```

# haml - HAML - 我如何创建这行 HTML

> ID：10321632
> 
> 赞同：5
> 
> 时间：2012-04-25T18:29:30.007
> 
> 标签：haml

这是在 HAML 中创建的复杂的 HTML 行：

```
<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse"> 
```

我不知道该怎么做。任何想法？我只能这样做：

```
%a.btn
  %span.icon-bar Hello 
```

但不确定如何做复杂的事情。

谢谢！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-30T18:56:17.460

```
%a.btn.btn-navbar{"data-target" => ".nav-collapse", "data-toggle" => "collapse"} 
```

**要不然**

```
%a.btn.btn-navbar{:data => {:toggle => 'collapse', :target => '.nav-collapse'}} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-25T19:08:23.903

多个类可以[链接在一起](http://haml.info/docs/yardoc/file.REFERENCE.html#class_and_id__and_)：

```
%a.btn.btn-navbar 
```

给出：

```
<a class='btn btn-navbar'></a> 
```

可以使用单个`:data`哈希指定[自定义数据属性：](http://haml.info/docs/yardoc/file.REFERENCE.html#html5_custom_data_attributes)

```
%a.btn.btn-navbar{:data => {:toggle => 'collapse', :target => '.nav-collapse'}} 
```

给出：

```
<a class='btn btn-navbar' data-target='.nav-collapse' data-toggle='collapse'></a> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-31T05:56:54.827

```
/ 80 characters (Chandrakant's anser):  
%a.btn.btn-navbar{"data-target" => ".nav-collapse", "data-toggle" => "collapse"}

/ 79 characters (Matt's answer):
%a.btn.btn-navbar{:data => {:toggle => 'collapse', :target => '.nav-collapse'}}

/ 69 characters (My fave method):
%a.btn.btn-navbar(data-toggle="collapse" data-target=".nav-collapse")

/ 68 characters (Ruby >= 1.9):
%a.btn.btn-navbar{data: {toggle:"collapse", target:".nav-collapse"}} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-25T18:33:05.670

```
%a{:class => "btn btn-navbar", :data-toggle => "collapge", :data-target => ".nav-collapse"} Hello 
```

仅从阅读 HAML 网站...

[http://haml-lang.com/tutorial.html](http://haml-lang.com/tutorial.html)

**我没有测试这个，我只是在网站上看到的

# perl - 关键字 `no` 在 Perl 中实际上做了什么？

> ID：10321636
> 
> 赞同：12
> 
> 时间：2012-04-25T18:29:40.957
> 
> 标签：perl, module

我[之前的问题](https://stackoverflow.com/q/10306916/206466)已经解决了我的问题，但让我缺乏理解。

```
use 5.014;
use warnings;
use Test::More;

# still has carp after no Carp
package Test0 {
    use Carp qw( carp );
    sub new {
        my $class = shift;
        my $self  = {};

        carp 'good';

        bless $self, $class;
        return $self;
    }
    no Carp;
}

my $t0 = Test0->new;

ok( ! $t0->can('carp'), 'cannot carp'); 
```

这个测试没有通过，这意味着`no ...`没有做我认为它做的事情，包括取消导入符号。我读过[`perldoc no`](http://perldoc.perl.org/functions/no.html)，但它确实似乎相当无启发性。鉴于这段代码的结果，我想说它并没有完全按照它的广告做。

做什么`no`？我什么时候以及为什么要使用它？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-25T18:39:12.520

`no`调用一个包的`unimport()`，而`use`调用`import()`，两者都默默地跳过没有找到所需子的情况。

然而，很少有软件包——实际上，大部分只有编译指示模块——支持`unimport()`.

# javascript - 从原型访问对象属性

> ID：10321641
> 
> 赞同：2
> 
> 时间：2012-04-25T18:29:59.757
> 
> 标签：javascript, object, prototype

我有一个为 node.js 包装 mongodb 客户端的类。`findUsers`当我打电话时，下面的类`this.collection`是未定义的。

如何`this.collection`从原型访问？

谢谢！

班级：

```
var Users;

Users = (function () {

    function Users(db) {

        db.collection('users', function (err, collection) {
           this.collection = collection;
        });
    }

    Users.prototype.findUsers = function (callback) {

        this.collection.find({}, function (err, results) {

        });
    }

    return Users;

})(); 
```

用法：

```
//db holds the db object already created
var user = new Users(db);
user.findUsers(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T18:43:11.663

你在原型方法中做对了，你的错误在`db.collection()`.

```
var Users = (function () {
    function Users(db) {
        var that = this; // create a reference to "this" object
        db.collection('users', function (err, collection) {
            that.collection = collection; // and use that
        });
    }
    Users.prototype.findUsers = function (callback) {
        this.collection.find({}, function (err, results) {

        });
    }
    return Users;
})(); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-25T18:31:41.583

使用另一个参考：

```
Users = (function(){
    var that = this;

    function users(db)
    {
         db.collection('users', function(err, collection)
         {
              that.collection = collection;
         }
    }
})(); 
```

# wso2 - 将 XML 节点添加到 WSO2 DSS 和 ESB 响应

> ID：10321644
> 
> 赞同：0
> 
> 时间：2012-04-25T18:30:05.290
> 
> 标签：wso2, wso2esb, wso2dss

我将 WSO2 DSS 设置为返回如下数据：

```
<Products>
   <Product>
      <SKU>12345678910123</SKU>
      <Item>123456</Item>
      <ItemName>My Product Name</ItemName>
   </Product>
</Products> 
```

如果没有要返回的数据，我只会得到以下信息：

```
<Products xmlns="http://data.mydomain.com/wso2/Products/getSKUinfo"/> 
```

我设置了 WSO2 ESB 直通代理以连接到上述服务。当我在像 esbhost.domain.com/services/Products/SKU/12345678910123 这样的 URL 中点击服务时，我得到了上述信息。我想要做的是添加一个“状态”节点（或任何它被称为）基本上返回这个：

```
<Products>
   <Status>1</Status>
   <Product>
       <SKU>12345678910123</SKU>
       <Item>123456</Item>
       <ItemName>My Product Name</ItemName>
   </Product>
</Products> 
```

如果没有匹配/无数据返回，我希望响应为：

```
<Products>
   <Status>0</Status>
</Products> 
```

这可以在 WSO2 ESB 中做到吗？还是我需要在 WSO2 DSS 服务中添加一些东西？

如果我没有使用正确的术语，请原谅我。

谢谢，贾里德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:52:21.487

是的，它可以在 ESB 中完成。基本上在该代理服务的“outSequence”中，您可以简单地使用[过滤器](http://docs.wso2.org/display/ESB403/Filter+Mediator)中介，使用 XPath 检查有效负载，以检查是否存在匹配项或没有数据。[因此，从过滤中介，在它们各自的路径中，您可以使用丰富](http://docs.wso2.org/display/ESB403/Enrich+Mediator)中介构建消息并添加您需要的必要元素，例如 0 等。所以基本上在过滤器中介“true”路径中，您可以将“Product”元素保存在一个属性中，稍后使用enrich将其添加到消息正文中最后创建的元素中。您可能想查看[ESB 示例](http://docs.wso2.org/display/ESB403/Running+ESB+Samples)以了解这些中介器的工作原理。

干杯，安佳娜。

# android - 使用来自另一个活动的 ContextMenu 的意图启动一个活动

> ID：10321649
> 
> 赞同：0
> 
> 时间：2012-04-25T18:30:30.850
> 
> 标签：android, android-activity, android-intent, contextmenu

我不知道如何开始`Intent`从我的`ContextMenu`. 我有以下代码：

```
 public void onCreate(Bundle savedInstanceState){
            super.onCreate(savedInstanceState);
            setContentView(R.layout.profile);
    Button button5 = (Button) findViewById(R.id.button5);
        registerForContextMenu(button5);
    //...code...//

    @Override
    public void onCreateContextMenu(ContextMenu menu, View v, ContextMenuInfo menuInfo){
        super.onCreateContextMenu(menu, v, menuInfo);
        menu.setHeaderTitle("Profile Options");
        menu.add(0,v.getId(),0, "Header");
        menu.add(0,v.getId(),0, "Header");

**This is where my Intent is ** Intent intent = new Intent (CustomizeActivity2.this, CustomizeActivity.class);
    startActivity(intent);

    public boolean OnContextItemSelected(MenuItem item) {
        if(item.getTitle()=="Edite Profile"){

            function1(item.getItemId());
            }

        else {return false;}
        return true;
    }

    public void function1(int id){
        Toast.makeText(this,"Edit Profile Called", Toast.LENGTH_SHORT).show();  
    } 
```

当我单击我的项目时，我想开始另一个活动`ContextMenu`，我有一些设置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T18:03:19.047

您的代码中有一些错误。`onCreateContextMenu`您的`ContextMenu`构建方法：

```
@Override
public void onCreateContextMenu(ContextMenu menu, View v, ContextMenuInfo menuInfo){
        super.onCreateContextMenu(menu, v, menuInfo);
        menu.setHeaderTitle("Profile Options");
        menu.add(0, 1000, 0, "Header1"); // give your menus distinct ids!!!
        menu.add(0, 1001, 0, "Header2");
} 
```

`ContextMenu`当用户从 中选择一个选项并开始一个新活动时调用的回调：

```
//the correct callback name starts with o and not O
@Override
public boolean onContextItemSelected(MenuItem item) {
   switch (item.getItemId()) {
   case 1000:
       //first ContextMenu option I picked this to start the  new activity
       Intent i = new Intent(CurrentActivityName.this, OtherActivityName.class);
       startActivity(i);
   break; 
   case 1001:
      //stuff for option 2 of the ContextMenu
   break;
   }
   return super.onContextItemSelected(item);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:36:58.833

要在代码中的任何位置启动活动，您需要创建一个新意图，将目标组件设置为目标活动类，然后使用此意图参数调用 startActivity 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T18:40:49.793

```
// in my Util.java:
static void switchActivity(Activity from, Class<?> to) {
    Intent intent = new Intent(from, to);
    from.startActivity(intent);
    from.finish(); // only do this if you want to close the current activity
}

// in your context menu:
Util.switchActivity(this, AnotherActivity.class); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T19:48:35.397

确保您已在 Manifest 中声明了第二个活动（您正在调用的活动）。您不会收到编译错误，但 Android 无法启动清单中未定义的活动，即使它在您当前的包/apk 中也是如此。

如果您愿意，请向我们展示您的 manifest.xml 文件包含的内容，如果需要更改任何内容，我们会更好地了解。

编辑：确保您在清单中看到类似的内容

```
<activity android:name=".CustomizeActivity" /> 
```

# vb.net - 升级到 .Net 后如何设置 ScriptingContext 响应 cookie

> ID：10321652
> 
> 赞同：1
> 
> 时间：2012-04-25T18:30:37.667
> 
> 标签：vb.net, com, asp-classic, vbscript

我们有许多经典的 ASP 网站，它们以标准方式使用 VB6 DLL (COM) 对象来实现其功能。DLL 是 regsvr32 的，页面使用 Server.CreateObject 在 DLL 中创建必要对象的实例，这反过来触发正在创建的对象的 OnStartPage 函数，传入 ScriptingContext，然后我们使用它来获取 Request (查询字符串、表单）信息、读取/更新会话信息和读取/写入 cookie 信息（等）。为澄清起见，您使用 ScriptingContext 更新/存储 cookie 值的方式是

```
objSC.Response.Cookies(Key) = Value 
```

在准备对代码库进行完整的 .Net 大修时（作为第一步），我们通过 .Net 2008 VB 升级工具运行代码，该工具进行了一些小的代码更改，设置了对互操作库的引用（对于ADODB、ASPTypeLibrary、CDO 等）并添加必要的属性以允许 .Net 对象向 COM 公开，并且在升级工具留下的注释 (todos) 的指导下到处进行一些调整后，代码是可编译的，除了对于任何尝试使用上述代码更新/存储 cookie 的东西，现在通过 ASPTypeLibrary（互操作），Response.Cookies 集合是只读的（现在没有明显的方法来编写 cookie）。

如果我注释掉有问题的代码行，代码编译，我需要做的就是在 GAC 中注册这个新的 .Net DLL（它是互操作 DLL），使用 regasm 通过 COM 注册它，经典的 ASP 站点继续就像什么都没发生一样工作（除了写 cookie），使用 Server.CreateObject 创建它认为是 COM 对象，触发对 OnStartPage 的调用，传入 ScriptingContext。

因此，尽管代码库已“升级”到 .Net，但它使用了许多互操作库来继续像以前一样工作，包括使用 ASPTypeLibrary.ScriptingContext 对象，因为这是经典的 ASP 管道所公开的内容。

有谁知道如何在这种情况下编写/存储 cookie？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T13:26:05.007

需要将 cookie 项转换为`IWriteCookie`界面。然后它将是可写的。

```
Imports ASPTypeLibrary
Public Class Test
    Private oContext As ASPTypeLibrary.ScriptingContext
    Private oResponse As ASPTypeLibrary.Response
    Public Sub OnStartPage(e As ScriptingContext)
        oContext = e
        oResponse = oContext.Response
        With CType(oResponse.Cookies("fromdotnet"), IWriteCookie)
            .Item = String.Format("hello from .Net : {0}", Date.UtcNow())
            '.Domain = ""
            '.Path = "/"
            '.Secure = False
        End With
    End Sub
End Class 
```

您可能想查看其他接口，例如`IReadCookie`,`IStringList`等`IRequestDictionary`。

请注意：

> 完全信任直接调用方。该成员不能由部分信任的代码使用。

还有另一种选择：[ContextUtil.GetNamedProperty 方法](http://msdn.microsoft.com/en-us/library/system.enterpriseservices.contextutil.getnamedproperty.aspx)

```
System.EnterpriseServices.ContextUtil.GetNamedProperty("Response").Cookies("fromdotnet") = "hello" 
```

# javascript - 样式化 iframe 内容

> ID：10321653
> 
> 赞同：4
> 
> 时间：2012-04-25T18:30:42.793
> 
> 标签：javascript, jquery, html, css

是否有可能设置 iframe 内容的样式？

我正在研究 Google 集成并将 iframe 与文档包括在内。

```
<iframe src="https://docs.google.com/document/d/1FXbO5XkM5jIcvkqNTEu2EoxmU9UmlyLaa8NPmlcQW1M"></iframe> 
```

这个谷歌文档有我不想显示的菜单（文件，编辑...）。是否有可能针对此元素并为其赋予属性，例如 . 显示：无？或者只是以某种方式隐藏这些元素？

谢谢 ！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T18:37:18.967

好吧，正如你所说**的**，

你可以试试：

```
<div id="trick">
   <iframe/>
</div>

#trick{
   overflow:hidden; /* you will have to play a bit with heights and widths*/
}
#trick iframe{
   position:absolute; /*or relative. depending on your markup*/
   top:-90px /* Asuming the menu you want to hide is that height */
} 
```

“似乎”完成了这项工作：http: [//jsfiddle.net/Tey5f/3/](http://jsfiddle.net/Tey5f/3/)

或者你可以：

```
$('iframe').contents().find('head').append('rel="stylesheet" type="text/css" href="myChanges.css" />'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T18:35:08.563

无法将样式应用于 Google Docs 等外部网站，防止跨域。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T18:54:10.230

这是不可能的。但是，您可以使用代理来加载 google 的内容 :) 一旦您将服务器端配置为代理此类请求，只需将 google 的 url 替换为以下内容：

```
http://yoursite.com/googleproxy/document/d/1FXbO5XkM5jIcvkqNTEu2EoxmU9UmlyLaa8NPmlcQW1M 
```

但是该谷歌页面链接的内容可能存在问题，因为现在请求`docs.google.com`是跨域的。

# c# - 将 MVC2 转换为 MVC3 并将页面转换为 Razor

> ID：10321654
> 
> 赞同：1
> 
> 时间：2012-04-25T18:30:43.870
> 
> 标签：c#, asp.net-mvc-3

为我更新大型旧 MVC2 项目的首要原因是 Razor 引擎。现在按照[这个说明](http://www.asp.net/whitepapers/mvc3-release-notes#upgrading) ，我成功地转换了项目，而没有触及 .aspx 和 .ascx 文件。

1) 你们现在能告诉我，我怎样才能将母版页转换为布局，并开始转换页面和用户控件而不破坏任何现有的 MVC2 页面？（这是一个大项目，不能一次全部完成）。我可以以某种方式使用旧的母版页作为剃须刀页面中的布局吗？

我转换了几个不使用母版页的部分 aspx 页面。我使用了 Telerik 的 aspx2razor 转换器——尽管您仍然需要进行大量手动修改，但它会有所帮助。

2）还有其他更好的工具吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:35:14.637

您可以并排使用 Razor 和普通视图。默认情况下，MVC3 首先查找 razor，然后将回退到 WebFormsViewEngine。

所以你应该没有问题，你可以在你认为合适的时候及时处理每一页。

# spring - Maven 在运行 Spring JUnit 测试后挂起

> ID：10321661
> 
> 赞同：1
> 
> 时间：2012-04-25T18:31:11.043
> 
> 标签：spring, maven, junit

在使用 Maven 对 Spring 应用程序进行单元测试后完成构建时出现问题。我注意到 mvn install 没有完成，并且在运行所有单元测试后它似乎挂起。如果我运行，则从 cmd 行`mvn install`完成测试，但构建挂起

```
Results :

Tests run: 34, Failures: 0, Errors: 0, Skipped: 0

14:20:15,588 [Thread-3] INFO  GenericApplicationContext  - Closing org.springframework.context.support.GenericApplicationContext@10a3b24: startup date [Wed Apr 25 14:20:08 EDT 2012]; root of context hierarchy
14:20:15,589 [Thread-3] INFO  DefaultListableBeanFactory  - Destroying singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@16c163f: defining beans [org.springframework.context.annotation.internalConfigurationAnnotationProcessor,org.springframework.context.annotation.internalAutowiredAnnotationProcessor,org.springframework.context.annotation.internalRequiredAnnotationProcessor,org.springframework.context.annotation.internalCommonAnnotationProcessor,sysModel,alarmList,resourcePool,sysParams,stationHelper,commandTracker,org.springframework.context.annotation.ConfigurationClassPostProcessor$ImportAwareBeanPostProcessor#0]; root of factory hierarchy
14:20:15,595 [Thread-7] INFO  GenericApplicationContext  - Closing org.springframework.context.support.GenericApplicationContext@c5577c: startup date [Wed Apr 25 14:20:10 EDT 2012]; root of context hierarchy
14:20:15,596 [Thread-7] INFO  DefaultListableBeanFactory  - Destroying singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@10952e8: defining beans [alarmDao,purgeDao,xactionDao,dataSource,sysModel,org.springframework.context.annotation.internalConfigurationAnnotationProcessor,org.springframework.context.annotation.internalAutowiredAnnotationProcessor,org.springframework.context.annotation.internalRequiredAnnotationProcessor,org.springframework.context.annotation.internalCommonAnnotationProcessor,org.springframework.context.annotation.ConfigurationClassPostProcessor$ImportAwareBeanPostProcessor#0]; root of factory hierarchy 
```

这就是它的结束。两个线程正在运行，不确定我在那里做了什么。无论如何，为了排除故障，我删除了所有测试并让程序完全构建。如果我运行`mvn install -DskipTests`，我会完成它。最后，我添加了一个本质上是 system.out.println("hello world"); 的 JUnit 测试。我可以通过注释掉 JUnit 注释“@RunWith(SpringJUnit4ClassRunner.class)”来运行测试并完成安装。我正在使用 Spring 3.1.0.RELEASE。

构建的这个问题来自我在 Windows7 上的开发机器，但我们基于 Linux（Ubuntu 11.10）。Hudson CI 服务器使用相同的 SVN 存储库成功地在同一项目上运行 Maven 安装以进行每小时构建。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:42:10.797

可能您的一个 Spring bean 正在生成一个线程。使用 jconsole 连接到卡住的进程并查看挂起的内容。您可以通过在有问题的 bean 上使用 @PreDestroy 以在关闭时取消线程来修复它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T19:25:13.727

在 Spring 应用程序上下文关闭期间，线程之间似乎存在一些争用。您可以尝试将 Spring 框架的日志记录设置为调试级别，以查看争用的位置，并尽可能消除它。

如果在应用程序上下文中似乎没有问题，另一种选择是调整插件配置。该`surefire`插件用于执行测试，它具有在多个线程中运行测试的选项。首先运行 mvn with`-X`查看线程选项（parallel、threadCount、perCoreThreadCount 等）使用了哪些值。调整 surefire 插件配置（执行 ID 为`default-test`）以确保只有一个线程正在执行，并查看您是否可以`install`在 Windows 7 机器上运行。

一旦你让它在 Windows 中运行：你当前的 surefire 配置（可能是超级 POM 提供的默认配置）在你的 CI 环境中运行良好。因此，我将创建一个[配置文件，如果在 Windows 7 环境中运行则激活](http://maven.apache.org/guides/introduction/introduction-to-profiles.html)，并将确定的 Surefire 插件配置移动到配置文件中。

# jms - 如何判断哪个 MDB 正在侦听哪个端口

> ID：10321665
> 
> 赞同：0
> 
> 时间：2012-04-25T18:31:35.503
> 
> 标签：jms, message-driven-bean, websphere-6.1

从 WAS 管理控制台，是否有一种简单的方法可以检查哪个 MDB 正在侦听哪个侦听器端口？我无法打开耳朵并检查 ibm-ejb-jar-bnd.xml 文件，因为我无法访问机器本身，只能访问 WAS 控制台。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T08:30:38.907

在 WAS 控制台中选择具有 MDB 的企业应用程序，然后单击那里的“消息驱动 Bean 侦听器绑定”链接（“企业 Java Bean 属性”部分）。部署应用程序后，您可以在那里查看和更改侦听器绑定。

# c# - 当查询由内部联接组成时更新 DataGrid 上的数据库

> ID：10321668
> 
> 赞同：1
> 
> 时间：2012-04-25T18:31:49.110
> 
> 标签：c#, mysql, datagrid, inner-join

我正在用 C# 进行编码

我的 MySQL 数据库由 5 个表组成，即

*   学生
*   个人信息
*   学者表
*   工程
*   总计的

每个表都有一个公共列 branch_code

通过 DataTable 绑定到 DataGrid 的查询是：

```
SELECT * FROM student INNER JOIN personal_information USING ( branch_code ) INNER JOIN academics_table USING ( branch_code ) INNER JOIN engineering USING ( branch_code ) INNER JOIN AGGREGATE USING ( branch_code ); 
```

我需要将 DataGrid 中所做的更改更新到数据库。请告诉我如何做到这一点。

# python - 停止函数写入标准输出

> ID：10321671
> 
> 赞同：1
> 
> 时间：2012-04-25T18:31:57.073
> 
> 标签：python, opencv, stdout

我的代码中有这一行：

```
writer = cv.CreateVideoWriter('video.avi', cv.CV_FOURCC('X','V','I','D'), 30 ,(480,800), 1) 
```

哪个输出来控制这个：

```
Output #0, avi, to 'video.avi':
Stream #0:0: Video: mpeg4, yuv420p, 480x800, q=2-31, 24576 kb/s, 90k tbn, 30 tbc 
```

我想阻止它打印任何东西到标准输出，但保持我自己在代码中进一步输出的可能性。我怎样才能做到这一点？

我试过这个，但没有奏效。

```
class NullStream:
    def write(self, text):
        pass

sys.stdout = NullStream()
sys.stderr = NullStream()

print "hello" #This doesn't outputs

#This function still outputs to console:
writer = cv.CreateVideoWriter('video.avi', cv.CV_FOURCC('X','V','I','D'), 30 ,(480,800), 1)

sys.stdout = sys.__stdout__
sys.stderr = sys.__stderr__ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T18:52:25.077

输出此信息的不是 OpenCV。它是 FFMPEG（由 OpenCV 调用）。

您可以重新编译 FFMPEG 以禁用这些调试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T18:36:48.370

```
import os
import sys
saved_stdout, saved_stderr = sys.stdout, sys.stderr
sys.stdout = sys.stderr = open(os.devnull, "w")
writer = cv.CreateVideoWriter('video.avi', cv.CV_FOURCC('X','V','I','D'), 30 ,(480,800), 1)
sys.stdout, sys.stderr = saved_stdout, saved_stderr
print 'Now this will print to stdout' 
```

演示：

```
>>> import os
>>> import sys
>>> saved_stdout, saved_stderr = sys.stdout, sys.stderr
>>> sys.stdout = sys.stderr = open(os.devnull, "w")
>>> print 'hello world'                     # no output
>>> sys.stderr.write('Invisible Error!\n')  # no ouput
>>> sys.stdout, sys.stderr = saved_stdout, saved_stderr
>>> print 'goodbye world'                   
goodbye world
>>> sys.stderr.write('Error!\n')
Error! 
```

# cakephp - CakePHP：可重用的内容块和 MVC

> ID：10321673
> 
> 赞同：2
> 
> 时间：2012-04-25T18:32:04.763
> 
> 标签：cakephp, cakephp-2.0

我正在尝试通过构建一个简单的 CMS 应用程序来学习 CakePHP，它进展顺利，但是随着我添加更多内容，我对 MVC 结构感到有些困惑。

除了我的帖子之外，我还为“内容块”（基本上是一个管理员可编辑的标题和内容字段）创建了一个简单的模型，我想将其显示为我网站其他页面中的元素。

帮助解释：

我的帖子控制器有一个列出所有博客帖子的索引操作。在该操作的视图中，我还想从数据库中提取特定的“内容块”并将其显示在页面顶部。

另一个示例是出现在每个页面的页脚中的管理员可编辑的“关于”简介。

最后，以与 Wordpress 文本小部件或 Magento 静态块类似的方式，我想防止直接访问“内容块”（即 domain.com/content_blocks/view/id）

在忠实于 CakePHP 和 MVC 约定的同时实现这一目标的理想方法是什么？我已经尝试过几次（例如在元素中使用 requestAction），但只是成功地变得更加困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T19:16:04.670

我会按照您建议的方式在元素内使用请求操作，因为这将无法通过 URL 直接访问。因此，您将在 elements 文件夹中创建一个视图：

应用程序/视图/元素/block.ctp：

```
<?php $sidebar = $this->requestAction(array(
    'controller' => 'ContentBlocks', 
    'action'=> 'viewBlock', 
    'yourtitle'
)); 
// layout your block here
?> 
```

应用程序/控制器/ContentBlocksController.php

```
public function viewBlock($title) {
    return $this->ContentBlock->findByTitle($title);
} 
```

然后你可以看到这篇文章，了解如何使用元素和 requestAction 进行缓存：http: [//mark-story.com/posts/view/how-using-requestaction-increased-performance-on-my-site](http://mark-story.com/posts/view/how-using-requestaction-increased-performance-on-my-site)

此外，您可能想查看 Croogo，它具有您正在寻找的许多功能，并且已经内置了更多功能：http: [//croogo.org/](http://croogo.org/)

# c++ - 提升错误锁定问题

> ID：10321674
> 
> 赞同：-2
> 
> 时间：2012-04-25T18:32:18.483
> 
> 标签：c++, boost, boost-thread

我无法弄清楚这个简单代码的问题出在哪里，我认为这是输出到控制台的问题，可能是死锁或其他什么，有人可以帮忙。

```
#include <iostream>
#include <string>
#include <sstream>
#include <boost/thread.hpp>

using namespace std;
struct IntegrateTask
{
   int id;
   double from, to, step, result;

   IntegrateTask(int id, double from, double to, double step)
   {
       this -> id;
       this -> from = from;
       this -> to = to;
       this -> step = step;
   }

   ~IntegrateTask()
   {}
};

vector<IntegrateTask> * tasks = new vector<IntegrateTask>();
boost::mutex mutlist;
boost::mutex iomutex;
boost::condition_variable condtask;

bool isInterrupted = false;

double foo(double x)
{
    return x * x;
}

void integrate(IntegrateTask * task)
{
   double result = 0;
   double step = task -> step;
   for(double i = task -> from ; i != task -> to; i =+ step)
   {
       result += foo(i) * step;
   }
   task -> result = result;
}

void integrateThread()
{

   boost::thread::id id = boost::this_thread::get_id();

   try
   {
       {
           boost::mutex::scoped_lock iolock(iomutex);
           cout << "Thread #" << id << " is working!" << endl;
       }
       while(!isInterrupted)
       {
           IntegrateTask * currtask = NULL;

           {
               boost::mutex::scoped_lock lock(mutlist);                  
               while(!isInterrupted && tasks -> empty())
               {
                   condtask.wait(lock);
               }
               if (!tasks -> empty())
               {
                   currtask = &tasks->back();
                   tasks->pop_back();
               }    
           }
           if (currtask != NULL)
           {
               integrate(currtask);
               boost::mutex::scoped_lock iolock(iomutex);    
               cout << "Task #" << (currtask->id) << "; result = " << (currtask->result) << endl;     
           }
       }
       boost::mutex::scoped_lock iolock(iomutex);
       cout << "Thread # " << id << " stoped working normal!" << endl;    
   }
   catch(boost::thread_interrupted)
   {
       boost::mutex::scoped_lock ioLock(iomutex);
       cout << "Thread # " << id << " stoped working by interruption!" << endl;
   }
   catch(exception & e)
   {
       boost::mutex::scoped_lock iolock(iomutex);
       cout << "Error: " << e.what() << endl;        
   }
}

int main()
{

   cout << "Function for integration: f(x)=x*x" << endl;
   cout << "For stopping program press EXIT" << endl;

   int thcount = 6;// or boost::thread::hardware_concurrency()
   boost::thread_group thgroup;
   for (int i = 1; i <= thcount; i++){
       thgroup.create_thread(&integrateThread);
   }

   int id = 0;

   while (true)
   {
       string line;
       {
           boost::mutex::scoped_lock iolock(iomutex);
           cout << "Task #" << ++id << "; left bound, right bound and step: ";
           getline(cin, line);
       }

       if (line.find("e") != string::npos)
       {
           isInterrupted = true;
           condtask.notify_all();
           thgroup.interrupt_all();
           thgroup.join_all();    
           return 0;
       }

       double from, to, step;
       istringstream input(line);
       input >> from >> to >> step;    

       IntegrateTask * task = new IntegrateTask(id, from, to, step);        
       {
           boost::mutex::scoped_lock lock(mutlist);
           tasks->push_back(*task);            
       }    
       condtask.notify_one();    
   }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T19:40:13.087

我没有尝试遵循您在这里要实现的目标的逻辑，但是（至少）有两个问题：

1.  您没有使用`id`in`IntegrateTask`的构造函数。您通常应该更喜欢初始化列表而不是构造函数主体中的赋值，并且在函数签名中使用类成员变量名称也是灾难的根源，所以我会将您的构造函数更改为：

    ```
    IntegrateTask(int id_init, double from_init, double to_init, double step_init)
        : from(from_init), to(to_init), step(step_init), id(id_init) {} 
    ```

2.  挂起的可能原因是您`!=`在. 如果您将其更改为您的程序不应该挂起，但我不确定这是否会破坏您的程序逻辑。`for``integrate``<`

# c# - MVC3 扩展方法

> ID：10321677
> 
> 赞同：2
> 
> 时间：2012-04-25T18:32:22.330
> 
> 标签：c#, asp.net-mvc-3

编辑：感谢 David Ruttka，在查看了 Mvc3 的 RTM 版本中的 LabelExtensions.cs 后，我能够弄清楚。

对于字段名称：string field = ExpressionHelper.GetExpressionText(expression);

对于模型，我需要为 Helper 指定我想要转换的模型 - 其中 TModel:Foo 然后我可以得到模型： BarTypeEnum barType = ((Foo)html.ViewData.Model).BarType;

我已将以下来源更新为对我有用的内容。

/编辑

我正在尝试创建一个类似于 Mvc3 中的 LabelFor 的 html 帮助函数，以根据 Foo.BarType 和从 html 传入的 Foo 字段的名称返回一个字符串值。

在下面的函数 FooLabelFor 中，如何将模型和字段名称传递给函数？

我去寻找 System.Web.Mvc.HtmlLabelFor 的源代码，但在 Mvc3 源代码中找不到它。

```
//model class
public class Foo
{
    public string Bar { get; set; }
    public BarTypeEnum BarType { get; set; }
}

//html helper class
public static class HtmlHelpers {
    public static string FooLabelFor<TModel, TValue>(this HtmlHelper<TModel> html, Expression<Func<TModel, TValue>> expression) where TModel:Foo
    {
        BarTypeEnum barType = ExpressionHelper.GetExpressionText(expression);
        string field = ((Foo)html.ViewData.Model).BarType;
        return GlobalizeText(enumHelper.stringvalue(barType), field);
    }  
}

//html
@model Foo
<div>@Html.FooLabelFor(m => m.Bar)</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T19:35:49.243

您希望作为附加参数传递给助手的栏类型和字段名称，如下所示：

```
public static string FooLabelFor<TModel, TValue>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TValue>> expression, BarTypeEnum barType, string fieldName)
 {
  //...
 } 
```

然后，您需要在帮助程序的主体中添加一些代码来确定标签的适当文本，假设您将把该文本放入一个名为`theText`. 现在你需要的是：

```
var theLabel = htmlHelper.Label(id, HttpUtility.HtmlEncode(theText));

return MvcHtmlString.Create(theLabel); 
```

我希望这会有所帮助。

# ruby-on-rails - Rails Contacts App 联系人删除

> ID：10321680
> 
> 赞同：0
> 
> 时间：2012-04-25T18:32:37.503
> 
> 标签：ruby-on-rails, ruby-on-rails-3, contacts

我试图简单地创建一个按钮，该按钮将从联系人列表中删除联系人。

目前我有以下设置：

联系人控制器

```
def destroy
 @user.contacts.delete(params[:contact])
 @contact.delete
end 
```

看法

```
<tbody>
<% @contacts.each do |contact| %>
    <tr>    
        <td><%= contact.name %></td>
        <td><%= contact.company %></td>
        <td><%= contact.email %></td>
        <td><%= contact.phone %></td>
        <td><%= contact.mobile %></td>
        <td><%= button_to 'Delete', contact, :method => :delete %></td>
    </tr>
<% end %> 
```

路线

```
controller :contact do
 get "newcontact" => "contact#new"
 get "index" => "contact#index"
 delete "delete" => "contact#destroy"
end 
```

我在网上读到使用 button_to 是首选方法，但目前我收到以下错误：

```
undefined method `contacts' for nil:NilClass 
```

很高兴获得任何可能帮助我解决此问题的反馈。

提前谢谢汤姆

**对于任何寻求最终答案的人来说**

```
 def destroy
     contact = current_user.contacts.find(params[:id])
     contact.destroy
     redirect_to index_path
   end 
```

在我的控制器中，在我看来以下

```
<%= button_to 'Delete', contact, :method => :delete %> 
```

谢谢汤姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:37:22.833

尝试这样的事情：

`button_to "Delete", { :action => "delete", :id => contact.id}, :method => :delete`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T22:51:04.217

If`@user`只定义在`create`它只存在于调用的请求中`create`——我猜你`create`之前没有调用`destroy`。每个浏览器请求都会创建一个新的控制器实例；像这样的实例变量`@user`不会在请求之间停留。

为了使它工作，你可能只需要这个：

```
def destroy
  Contact.delete params[:contact]
end 
```

（当您删除联系人时，它将自动从其中删除，例如`current_user.contacts`假设您的关系是以通常的方式设置的。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T19:07:57.817

如果您打算使用@user，您需要`@user`在您的删除方法中设置，否则它将为零 - 因此错误消息

另一个问题是联系人的 id 是`params[:id]`而不是`params[:contact]`

我只想做

```
contact = current_user.contacts.find(params[:id])
contact.destroy 
```

您肯定希望通过用户删除联系人，否则人们可以删除其他用户的联系人。这会删除联系人并将其从关联中删除 - 您无需执行任何其他操作

# glassfish - 如何从 Glassfish (v3) JMS 队列接收消息

> ID：10321681
> 
> 赞同：1
> 
> 时间：2012-04-25T18:32:41.893
> 
> 标签：glassfish, jms

我已经尽可能多地寻找我的问题的解决方案。我的应用程序在 Glassfish v3 上运行。此应用程序向 Glassfish JMS 队列发送一条消息，并且该消息应该由同一主机上但在 Glassfish JVM 之外的独立客户端读取。

我已经编写了独立的客户端 java 代码 - 包括来自 Glassfish 安装目录的 appserv-rt.jar 和 gf-client.jar。

此客户端代码无法接收消息。系统输出语句打印直到“得到消费者”。之后没有任何反应。

如果我更改队列的名称 - 我收到一条错误消息，提示找不到队列。所以客户端代码似乎能够找到队列，但它没有收到任何消息。我需要在客户端代码中包含什么？

这是我的Java类：-

```
import java.util.Enumeration;
import java.util.Hashtable;
import java.util.Properties;

import javax.annotation.Resource;
import javax.jms.Connection;
import javax.jms.ConnectionFactory;
import javax.jms.JMSException;
import javax.jms.MapMessage;
import javax.jms.Message;
import javax.jms.MessageConsumer;
import javax.jms.MessageListener;
import javax.jms.MessageProducer;
import javax.jms.ObjectMessage;
import javax.jms.Session;
import javax.jms.Queue;
import javax.naming.Context;
import javax.naming.InitialContext;
import javax.naming.NamingException;

import org.apache.log4j.Category;

import domain.RedirectFile;

 public class ZblBulkUploadThread implements Runnable,MessageListener{

 private static final Category log = Category.getInstance(ZblBulkUploadThread.class) ;

    private Queue queue;

public void run()
{
    try
    {

        System.out.println(" inside try") ;
        InitialContext jndiContext = null;

        MessageConsumer messageConsumer=null;

        jndiContext = new InitialContext();

        System.out.println(" got context ") ;

        ConnectionFactory connectionFactory = (ConnectionFactory)jndiContext.
                lookup("jms/SimpleConnectionFactory");

        System.out.println("got connectionfactory") ;

    Connection connection = connectionFactory.createConnection();

    System.out.println("got connection") ;
    Session session = connection.createSession(false,
            Session.AUTO_ACKNOWLEDGE);

    queue = (Queue)jndiContext.lookup("jms/SimpleQueue") ;

    System.out.println("got queue"+queue.getQueueName()) ;

    messageConsumer = session.createConsumer(queue);

    System.out.println(" selector "+messageConsumer.getMessageSelector()) ;

    System.out.println("got consumer") ;

    Message message = messageConsumer.receive() ;

    System.out.println("Message is "+message) ;

    System.out.println("destination is "+message.getJMSDestination()) ;

    ObjectMessage om = ((ObjectMessage)message) ;
    try
    {

    RedirectFile file = (RedirectFile)om.getObject() ;

    log.debug("filePath "+file.getFilePath()) ;
    log.debug(" userName "+file.getUserName()) ;
    log.debug(" mode is "+file.getMode()) ;

    System.out.println("filePath "+file.getFilePath()) ;
    System.out.println(" userName "+file.getUserName()) ;
    System.out.println(" mode is "+file.getMode()) ;
    }
    catch(Exception ex)
    {
        log.error("ERROR "+ex.getMessage()) ;
        ex.printStackTrace() ;
    }

    log.debug("session created") ;

    }
    catch(Exception ex)
    {

        ex.printStackTrace() ;
        log.error("Error "+ex.getMessage()) ;
    }
}

public void onMessage(Message message)
{
    System.out.println("Message received "+message) ;
}

public static void main(String[] args)
{
    ZblBulkUploadThread zbut = new ZblBulkUploadThread() ;
    new Thread(zbut).start() ;
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T05:34:15.737

尝试：`connection.start();`在接听电话之前的某个地方。

# jquery - 使用jquery删除单击该按钮的行

> ID：10321683
> 
> 赞同：0
> 
> 时间：2012-04-25T18:32:50.023
> 
> 标签：jquery

我有一张桌子，里面有行。当我单击一个按钮时，它会删除它之前的行。我正在使用最接近（）函数来确定行。我想删除按钮所在的同一行。

```
function DeletClick(id, date) {
    var e = window.event; \
    if (confirm('Are you sure you want to delete the record from ' + date + '?')) {
        DisplayInformation.Delete(id,
           function (result) {
               if (result) {
                   jQuery('#' + e.srcElement.id).closest('tr').remove(); //Delete Row here!
               } else {
                   alert('You Do not have permssion to delete record.');
               }
           });
    }
   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:35:07.550

如果按钮在特定行的 td 内，则可以使用相同的逻辑来确定当前行，

```
$(this).closest('tr').remove(); 
```

假设`DeletClick`函数是删除按钮的单击处理程序。

如果您已经绑定了按钮 HTML 的内联事件处理程序，那么您需要将`this`arg 作为 arg 传递给函数，并`this`使用该参数更新上述代码中的 。

```
<input type="button" value="Delete" onclick="DeletClick('someid', 'somedata', this)" /> 
```

然后在函数内部，

```
function DeletClick(id, date, thisObj) {
    var e = window.event; \
    if (confirm('Are you sure you want to delete the record from ' + date + '?')) {
        DisplayInformation.Delete(id,
           function (result) {
               if (result) {
                   jQuery(thisObj).closest('tr').remove(); //Delete Row here!
               } else {
                   alert('You Do not have permssion to delete record.');
               }
           });
    }
} 
```

# c# - Molling 具有通用返回类型的静态方法

> ID：10321684
> 
> 赞同：1
> 
> 时间：2012-04-25T18:32:53.417
> 
> 标签：c#, mocking, moles

我正在尝试在一个非常庞大且臃肿的系统上实现一个使用单元测试的框架，主要问题是 70% 的系统是用静态方法实现的。这就是我达到 Moles 的方式，我非常有信心达到我的目标（我已经很接近了）。

我现在遇到的问题是我正在尝试使用通用参数来使用静态方法：

```
public static T ExecScalar<T>(IDbConnection cx, string commandText, IDbTransaction tx, IEnumerable<IDbDataParameter> parameters) 
```

在网上搜索我发现了这个论坛消息：

[http://social.msdn.microsoft.com/Forums/uk/pex/thread/3faadca2-a26f-449c-942e-d800a6079e02](http://social.msdn.microsoft.com/Forums/uk/pex/thread/3faadca2-a26f-449c-942e-d800a6079e02)

这正是我的问题，建议阅读第 10 页的手册。

我已经阅读了第 10 页的手册，但它谈论的是存根而不是磨合。我试图应用所描述的解决方案，但如果我输入：

```
Ktcar.Cs.Dal.DB.Moles.MDALDB.ExecScalarIDbConnectionStringIDbTransactionIEnumerableOfIDbDataParameter<int> = delegate(IDbConnection conn, String command, IDbTransaction trx, IEnumerable<IDbDataParameter> parameters) 
```

我得到：

“只有赋值、调用、递增、递减和新建对象表达式可以作为语句使用”</p>

我也试过：

```
Ktcar.Cs.Dal.DB.Moles.MDALDB.ExecScalarIDbConnectionStringIDbTransactionIEnumerableOfIDbDataParameter<T> = delegate(IDbConnection conn, String command, IDbTransaction trx, IEnumerable<IDbDataParameter> parameters) 
```

我得到同样的错误

或者：

```
Ktcar.Cs.Dal.DB.Moles.MDALDB.ExecScalarIDbConnectionStringIDbTransactionIEnumerableOfIDbDataParameter = null; 
```

然后我得到：

“不能分配给‘ExecScalarIDbConnectionStringIDbTransactionIEnumerableOfIDbDataParameter’，因为它是‘方法组’”</p>

请问，任何人都可以帮助我如何使用通用类型输出模拟静态方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T12:30:54.593

试试这个：

```
Ktcar.Cs.Dal.DB.Moles.MDALDB.ExecScalarIDbConnectionStringIDbTransactionIEnumera‌​bleOfIDbDataParameter<int>((IDbConnection conn, String command, IDbTransaction trx, IEnumerable<IDbDataParameter> parameters) => { return 5; }); 
```

# html - CSS 没有正确格式化我的消息

> ID：10321686
> 
> 赞同：0
> 
> 时间：2012-04-25T18:32:56.527
> 
> 标签：html, internet-explorer, css, hta

```
<body>

 <p class="tagged">****   Tutorials & Help Videos ****</p> 
 <p class="itmeggage">I have installed an icon on your desktop.
    <br><br> The icon is called 
    <span class="folders">eCats & HELP Videos</span>
    <br><br>
 </p>
 <p class="itmessage">There are two folders.
    <ol>
        <li>CheatSheet</li>
        <li>Help Videos</li>
    </ol>
 </p>
    <br><br> 
 <p class="note">NOTE: Help Desk is expected to go live Thursday evening or Friday morning.</p>
</body>

<style type="text/css">
  body {
    color: purple;
    background-color: lightblue; }

  p.tagged {    
    font-family: sans-serif;
    font-weight: bold;
    font-size: xx-large;
    color: red;
    text-align:center;
  }
  p.itmeggage {    
    font-family: sans-serif;
    font-weight: bold;
    font-size: x-large;        
    text-overflow: ellipsis; /* will make [...] at the end */ 
    width: 500px; /* change to your preferences */ 
    white-space: wrap; /* paragraph to one line */ 
    overflow:hidden; /* older browsers */ 
    text-align:left;
    color: green;
  }
  span.folders {
    font-family: sans-serif;
    font-weight: bold;
    font-size: x-large;
    color: purple;    
    text-overflow: ellipsis; /* will make [...] at the end */ 
    width: 500px; /* change to your preferences */ 
    white-space: wrap; /* paragraph to one line */ 
    overflow:hidden; /* older browsers */ 
    text-align:left;  
  }
  p.note {    
    font-family: sans-serif;
    font-weight: bold;
    font-size: large;
    color: black;    
    text-overflow: ellipsis; /* will make [...] at the end */ 
    width: 500px; /* change to your preferences */ 
    white-space: wrap; /* paragraph to one line */ 
    overflow:hidden; /* older browsers */ 
    text-align:center;
    text-decoration:underline;
  }
  li {
    font-family: sans-serif;
    font-weight: bold;
    font-size: x-large;
    color: green;    
    white-space: wrap; /* paragraph to one line */ 
    overflow:hidden; /* older browsers */ 
    text-align:left;
    }

  </style> 
```

根据我创建的 CSS，“有两个文件夹”这句话不是样式。我不知道该怎么办。

请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:35:17.573

你拼错`itmessage`了`itmeggage`：

```
p.itmeggage {    
    font-family: sans-serif;
    font-weight: bold;
    ...
} 
```

此外，您的第`<p>`一个拼写相同，这就是为什么一个有效，另一个没有：

```
<p class="itmeggage"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:38:03.423

看起来你拼错了 CSS 选择器。它发生在我们所有人身上:-)

应该是“p.itmessage”而不是“p.itmeggage”

```
 p.itmessage{    
font-family: sans-serif;
font-weight: bold;
font-size: x-large;        
text-overflow: ellipsis; /* will make [...] at the end */ 
width: 500px; /* change to your preferences */ 
white-space: wrap; /* paragraph to one line */ 
overflow:hidden; /* older browsers */ 
text-align:left;
color: green;
} 
```

# solr - Solr Shared 的性能比 Solr Unsharded 差

> ID：10321687
> 
> 赞同：1
> 
> 时间：2012-04-25T18:32:57.970
> 
> 标签：solr, full-text-search, tomcat7, cluster-computing, sharding

我的任务是使用 Solr 构建一个包含大约 1 亿条小记录的测试索引。从昨天的某个时候开始，我一直在我的笔记本电脑上运行它，一次将它增加 1000 万条记录，并在主要的“里程碑”（10m、20m ......等）上运行查询。我已经达到了大约 7000 万条记录，一切顺利……笔记本电脑规格如下：

*   四核 i7
*   8Gb 内存
*   Windows 7的
*   Tomcat 7 + 最新版本的 Solr。

作为测试，我决定看看当我在我的家庭工作站上运行一个类似的工作负载时会发生什么（双 Proc、四核 Xeon、12Gb RAM、RAID 0 中用于索引的 2x10K RPM 磁盘、Windows 2008 R2、相同的软件）。唯一的区别是现在我使用的是多核...使用笔记本电脑中相同的架构和 conf 目录，修改了 solr.xml...

无论如何，在笔记本电脑上，大约 7000 万条记录，我得到的结果不到 500 毫秒。那是 150 个查询，其中 100 个是一个词，50 个是 2 个词查询。只查询一个字段（名称字段）。一切都好...在我的工作站上，使用多核和以下查询字符串，我的时间超过了 4-5 秒！

```
http://localhost:8080/solr/core0/select?shards=localhost:8080/solr/core0,localhost:8080/solr/core1,localhost:8080/solr/core2,localhost:8080/solr/core3&q=Name:Test Name 
```

这是我生成的一个新索引：我正在执行一个循环，从 0 到 100,000,000 并且每次我点击 i % 10000 == 0 时，我都会将文档添加到 solr 核心。每次我点击那个循环，我都会增加一个commitID，当commitID %4 == 0时，去core0，当1去core1时，等等......

我很确定这是某个地方的配置问题...但我只是想确保...我是否应该期望这会更快？两个处理器（笔记本电脑和工作站）都在 2.2Gz 范围内。两者都是足够新的架构（工作站上的 Nehalem，笔记本电脑上 2010 年的 i7）。那么，有什么想法我应该看的吗？

# uitableview - UITableView 单元格中的 imageView 在 touchdown 事件中违反 setClipsToBounds

> ID：10321696
> 
> 赞同：0
> 
> 时间：2012-04-25T18:33:28.907
> 
> 标签：uitableview, imageview, contentmode

我有一个`UITableView`其单元格的图像来自放置在其`imageView`.

图像不是正方形（是横向），但它最初以`contentMode`is`scaleAspectFill`和`setClipsToBounds`is的方式加载为正方形`YES`。到目前为止，一切都很好。

但是，当我触碰单元格时，图像“变宽”了，也就是说，它保留了该`scaleAspect`部分，但现在`setClipsToBounds`像`NO`.

如果行/单元格不在视野范围内并以回收方式返回，则会发生相同的行为，在这种情况下，我的图像是从内存中的缓存而不是从 URL 中获取的。

我已经尝试显式设置`contentMode`和`setClipsToBounds`，`cell.imageView`但似乎没有效果。有什么建议吗？谢谢。

达阵前：

![达阵前](../Images/1472b0bb08fe87d8f9b0e443be30a5ab.png)

着陆后（或从缓存中回收）：

![达阵后](../Images/b6dfff717687e02455da4b91968de4f3.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T21:58:16.470

`imageView`cell 属性（与 other`textLabel`和相同）根据图像大小`detailTextLabel`更改其框架。`layoutSubviews`所以你可以重新实现`layoutSubviews`固定框架矩形。顺便说一句，试试[TableKit](https://github.com/onegray/UITableKit)库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-18T13:20:59.843

如果有人仍在寻找解决方案，这里是正确答案的链接：[UITableViewCell 中的 UIImageView 在 touchDown 上更改大小](https://stackoverflow.com/a/17123367/3543861)

因为你把它命名为imageView，把它命名为image_View，问题就解决了！

# asp.net - CSV 通过 ASP.NET 到 MySQL

> ID：10321698
> 
> 赞同：0
> 
> 时间：2012-04-25T18:33:35.583
> 
> 标签：asp.net, mysql, csv, import, sql-injection

我正在开发一个 ASP.Net 站点，我希望允许用户导入一个 CSV 文件，其中每行中的数据可以插入或更新到 MySQL 数据库中的 1 或 2 个表。CSV 文件的范围可能从 1 到几千行，大约 6 或 7 列宽。

我想知道是否可以在不循环每一行并调用存储过程的情况下做到这一点，同时仍然防止 SQL 注入，因为这种方法看起来可能很慢？我还想知道，当这种情况发生时，这是否会使我的网站对所有当前用户都没有响应？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T18:37:43.403

是的，最好的方法是使用 ASP.NET SqlBulkCopy 导入临时表。

然后使用 TSQL 复制到目标表。

将 csv 加载到 DataTable 中。

这是您需要的代码

使用连接作为 SqlConnection = New SqlConnection(conn)

```
 connection.Open()

        Using bulkCopy As SqlBulkCopy = New SqlBulkCopy(connection, SqlBulkCopyOptions.TableLock, Nothing)

                bulkCopy.DestinationTableName = "TempTable"

            bulkCopy.BulkCopyTimeout = 60000

            bulkCopy.BatchSize = 0

            bulkCopy.WriteToServer(MyDataTable)

            bulkCopy.Close()

        End Using

        connection.Close()

        End Using 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-11-24T14:41:18.380

```
MySqlBulkLoader loader = new MySqlBulkLoader(connection);
loader.TableName = "table name";
loader.FieldTerminator = "\t";
loader.LineTerminator = "\n";
loader.FileName = "path file";
loader.Load(); 
```

# java - Android - 多个活动重启的并发问题

> ID：10321700
> 
> 赞同：1
> 
> 时间：2012-04-25T18:33:53.880
> 
> 标签：java, android, concurrency, activity-lifecycle

在模拟器（ADT v17.0.0）或设备（原始 Droid）上进行方向更改时，我注意到活动有时会经历多个创建-销毁周期。我发现这篇[博客文章](http://vikaskanani.wordpress.com/2011/01/06/android-emulator-bug-while-changing-orientation/)提到了这个问题，但没有提供解决方案。

我的应用程序（API 8）当前在 onPause 中“最后一次”保存用户数据，并在 onCreate/onStart 中检索该数据，这对于单次重启工作正常，但如果周期恢复，则会出现并发问题-背部。特别是如果在保存完成之前开始加载，“最后机会”数据就会丢失。

我确实阅读了更快的屏幕方向更改 Android 开发者文章，其中提到通过 onRetainNonConfigurationInstance/getLastNonConfigurationInstance 传输对象。我尝试使用 onRetain/getLast... 像一个标志来判断活动是否正在“重新启动”，这很有效，但我仍然有一个主要问题是不知道任何现有的保存/加载操作是否/何时完成。

并发和线程管理不是我最擅长的，所以我正在寻找一种解决方案，它可以在任意数量的背靠背重启*中至少进行一次保存和加载，而不会出现内存泄漏。*由于非方向原因可能会发生快速创建-销毁周期，因此仅涉及破坏/处理方向更改的想法并不是我真正想要的。

[这是一个带有一些周期的日志文件](http://studiodisa.com/private/SO-log-multiple-activity-restarts.txt)摘录，您可以看到从横向到纵向时活动在哪里被创建-销毁两次。这是我现在得到的摘录：

```
onPause() {
    file_manager.saveTemporaryPattern(); // writes to OutputStream on UI thread
}

onStart() {
    findViewById (R.id.main_screen).post (new Runnable() {
        file_manager.loadTemporaryPattern(); // reads from InputStream on UI thread
    });

    if (getLastNonConfigurationInstance() != null) {
        // DO SOMETHING HERE?
    }
}

onRetainNonConfigurationInstance() {
    return dummy_object;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T13:12:52.233

通过将加载/保存调用发送到链接到应用程序上下文而不是活动上下文的处理程序线程来管理解决并发问题。必须在调用中设置加载与保存标记以检查保存->加载->保存模式，避免在横向->纵向方向更改时获得不完整活动生命周期的奇怪行为。

它在开发和测试设备上工作，并且不会泄露活动上下文，所以我们将看看它在野外是如何工作的。

**在 YourApp 扩展应用程序：**

```
private Handler fileAccessThread = null;

public void onCreate() {
    super.onCreate();

    if (fileAccessThread == null) {
        fileAccessThread = new Handler();
        token = 0;
    }
}

public void postCallbackFileAccess (int _token, Runnable _callback) {
    switch (_token) {
    case TOKEN_SAVE:
        // Save must follow load, not another save
        if (token == TOKEN_SAVE) { return; }
        token = _token;
        break;

    case TOKEN_LOAD:
//      Have to allow load->load, otherwise data gets lost/deleted
//      if (token == TOKEN_LOAD) { return; }
        token = _token;
        break;
    }

    fileAccessThread.post (_callback);
} 
```

**在你的活动中：**

```
protected void onStart() {
    super.onStart();

    ((YourApp) getApplication()).postCallbackFileAccess (
        YourApp.TOKEN_LOAD, new Runnable() {
            @Override
            public void run() {
                file_manager.load();
            }
    });
}

protected void onPause() {
    super.onPause();

    ((YourApp) getApplication()).postCallbackFileAccess (
        YourApp.TOKEN_SAVE, new Runnable() {
            @Override
            public void run() {
                file_manager.save();
            }
    });
} 
```

# java - 主线程一直在等待新线程

> ID：10321704
> 
> 赞同：0
> 
> 时间：2012-04-25T18:34:07.290
> 
> 标签：java, multithreading

我正在尝试为我的项目编写一些“游戏引擎”，但我遇到了线程问题。当我在主流中创建一个线程（LoadThread）时，它一直等到 Run(); 在 LoadThread 结束。

```
//loading thread
public class LoadThread implements Runnable{
    private boolean running = false;
    private Thread loader = null;

    public LoadThread(/*init data structures*/){
        loader = new Thread(this);
    }

    public void start(){
        running = true;
        run();
    }

    synchronized public void run() {
        System.out.println(" loading started ");
        while(running){            
            //do some loading, when done, running = false
        }
        System.out.println(" loading done ");
    }
}

//holds data, starts loading
public class SourceGod {
    private LoadThread img_loader;
    public void startLoading(){
        img_loader = new LoadThread(/* some data structures */);
        img_loader.start();
    }
}

//runs the game
public class Game extends GameThread implements ActionListener{
    private SourceGod sources;
    public Game(Window full_screen){
        sources = new SourceGod(/* some data structures */);
        System.out.println("before");
        sources.startLoading();
        System.out.println("after");
    }
}

//own thread to refresh
abstract public class GameThread extends JPanel implements Runnable{
    //anything from there is not called before "after"
} 
```

输出

```
before
loading started
//some loaded data report, takes about 2-3s
loading done
after 
```

任何帮助将不胜感激。（更多代码[http://paste.pocoo.org/show/orCfn9a8yOeEQHiUrgjG/](http://paste.pocoo.org/show/orCfn9a8yOeEQHiUrgjG/)）谢谢，Vojtěch

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T18:36:41.907

您的问题是您正在`Thread`构造函数中创建一个对象，但是当您调用时，`start()`您并没有启动线程，而是`run()`在同一个线程中运行该方法。这看起来混淆了*扩展* `Thread`与*实施* `Runnable`。

我认为你应该做的是：

```
// this should be of type Thread not LoadThread
private Thread img_loader;
...
// don't create the loader thread inside of LoadThread
img_loader = new Thread(new LoadThread(/* some data structures */));
img_loader.start(); 
```

`LoadThread``Runnable`是线程将要执行的类型的类。使用您当前的代码，当它调用时：

```
img_loader.start(); 
```

它实际上并没有启动一个新线程，它只是调用在同一个线程中调用的`LoadThread.start()`方法：`run()`

```
public void start(){
    running = true;
    run();
} 
```

**编辑：**

在您提供的链接中更仔细地查看您发布的代码时，您正在构造函数中创建`Thread`对象`LoadThread`。这不是一个好的模式：

```
public LoadThread(/*init data structures*/) {
    // not recommended IMO
    loader = new Thread(this);
} 
```

同样，当您调用时，`LoadThread.start()`您并没有启动线程，而是`run()`在同一个线程中调用。我会改用这种`new Thread(new LoadThread())`模式。如果您坚持包裹`Thread` *内部*，`LoadThread`那么您应该更改`LoadThread.start()`为：

```
// this should be removed, you want to call Thread.start() instead
public void start(){
    running = true;
    // this will start the internal thread which will call run()
    loader.start();
} 
```

顺便说一句，如果您想`running`在另一个线程中设置为 false，则应将其标记为`volatile`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:46:43.437

使用 Runnable 接口的方式有几个问题：

*   runnable 是一种包装代码的方式，以便它可以在不同的线程中启动。您应该覆盖 run 方法。并且不要直接调用它，永远不会。
*   要使用可运行对象，请包装到线程中并运行线程启动方法。因此，您不应覆盖线程的启动方法，或始终调用 super.start()。
*   为可运行对象提供启动方法很麻烦。包装线程的 start 方法将在新线程（包装器）中调用 runnable 的 run 方法。就是这样。因此，如果您的可运行文件中有一个 start 方法，则包装线程将永远不会调用它。
*   永远不要调用线程或可运行对象的运行方法。您会错过这一点，因为该方法将在当前线程中执行，而不是在新线程中执行。
*   不要同步运行方法，它只打算由一个线程使用。

以下是您应该在您的情况下执行的操作：

```
//loading thread
public class LoadThread implements Runnable{
    /** Wether or not the thread is running. */
    private boolean running = false;
    /** Wrapper thread. */
    private Thread loader = null;

    public LoadThread(/*init data structures*/){
        loader = new Thread(this);
    }

    public void start(){
        running = true;
        loader.start();
    }

    @Override
    public void run() {
        System.out.println(" loading started ");
        while(running){            
            //do some loading, when done, running = false
        }
        System.out.println(" loading done ");
        running = false;
    }
} 
```

如您所见，如果您想要一个启动方法，只需调用包装线程启动方法即可。

另外，如果您确实需要调用 start，请考虑不使用可运行对象，而是直接使用线程：

```
 //loading thread2
 public class LoadThread extends Thread{
    /** Wether or not the thread is running. */
    private boolean running = false;

    @Override
    public void run() {
        running = true;
        System.out.println(" loading started ");
        while(running){            
            //do some loading, when done, running = false
        }
        System.out.println(" loading done ");
        running = false;
    }
} 
```

那要简单得多。

# css - 将 html 表单输入悬停在图像上

> ID：10321706
> 
> 赞同：0
> 
> 时间：2012-04-25T18:34:12.880
> 
> 标签：css, image, forms, input, hover

我目前有一个简单的表单，其文本输入具有由 css 设置的蓝色背景。这一切都完美无缺，在 Firefox 和 IE 中看起来不错，但在 iPhone 或 safari 上却不行？如何安排它，以便在输入后面有图像而不是背景？请注意，输入端还有其他图像，请参阅 - [http://stack.uk.to](http://stack.uk.to)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T18:47:44.833

我看到的唯一问题是您输入的 CSS 说它`height`应该是`48px`. 您旁边的图像`50px`位于`height`. 如果您将`input`' 高度更改为`50px`它似乎匹配。

样式.css：

```
.loginInput {
    margin-right: -11px;
    background: #0099FF;
    padding: 0;
    color: #000066;
    font-size: 36px;
    font-family: 'Cubano', Arial, sans-serif;
    vertical-align: bottom;
    height: 50px; 
    border: none;
} 
```

# c++ - Double 自动转换函数定义，gcc 错误：错误：预期的类型说明符

> ID：10321707
> 
> 赞同：0
> 
> 时间：2012-04-25T18:34:18.127
> 
> 标签：c++, gcc, casting

我有一个带有转换功能的类。

```
class A {
  public:
    operator double() const;
}; 
```

现在我在类定义之外定义它：

```
operator A::double() const { return 32.5; } 
```

我正在使用带有 GCC4.7 的 MinGW，但出现错误：

```
error: expected type-specifier 
```

有人知道我在做什么错吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T18:35:13.023

你需要一个不同的顺序：

```
A::operator double() const {return 32.5;}
    ^The function name is "operator double" 
```

# php - 包含语句中带有用户输入的硬编码文本 - 容易受到 LFI 攻击？

> ID：10321709
> 
> 赞同：0
> 
> 时间：2012-04-25T18:34:20.880
> 
> 标签：php, security, code-injection

我正在考虑将文件包含到脚本中，其名称基于 cookie

像这样的东西：

```
include("sometext".$mycoockie_here."some_text.php"); 
```

上面的代码是否容易受到此类攻击？- 即使使用`"sometext"`和`"sometex.php"`硬编码？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T18:37:35.173

当然是的。每个人都可以调整发送到您的 Web 应用程序的 cookie 的值。想象一下有人给你发送了一个包含内容的 cookie

```
/../../../../etc/passwd[null-byte] 
```

所以你最终会得到路径

```
sometext/../../../../etc/passwd[null-byte]some_test.php 
```

PHP 文件处理函数将路径传递给操作系统，操作系统使用以空字符结尾的字符串，因此您最终将包含

```
sometext/../../../../etc/passwd 
```

你可能不想要。

# jquery - 通过单击另一个 div 中的按钮隐藏一个 div 中的文本框

> ID：10321710
> 
> 赞同：1
> 
> 时间：2012-04-25T18:34:27.400
> 
> 标签：jquery, asp.net-mvc

```
<%foreach (var commentitem in item.commentsModelList)
   {
        var containerId = "comment-" + commentitem.CommentId;%>
       <div id="commentContainer1">
       <div id="<%:containerId %>">
       <table border="0"  class="commentbox">

        <%var rid = "btnReply-" + commentitem.CommentId;
          var replyContainer = "container-" + commentitem.CommentId;%>
       <tr>

        <td> 
         <div id="<%:replyContainer %>">
          <input id="<%:rid %>" type="button" value="Reply" class="btnReply"/>
          </td>
       </tr>
    </table>
 </div>
</div>
  <%} %> 
```

查询

```
 $(".commentbox .btnReply").live("click", function () {
            $(this).hide();
        var id = $(this).attr("id").split("-");
            alert(id);
            id.shift();
            alert(id);
            var newString = id.join('-');
            alert(newString);

            var $table = $('<table/>').addClass('tablecontent');
            $table.append(
                        $('<tr>').append($('<td>').append($input))
                             ); 
```

**已编辑**

```
 $($table).insertAfter("#container-" + newString).show();
        //     $("#container-" + newString).append($table);
        }); 
```

当单击一个 div 中的回复按钮时，会出现文本框，但是当单击另一个 div 中的回复按钮时，我希望前一个 div 中的文本框消失。我正在尝试复制[此页面上的功能](http://androidos.in/2012/03/htc-outs-list-of-16-devices-planned-for-ice-cream-sandwich-updates/comment-page-1/#comment-130055)。

我创建了小提琴[http://jsfiddle.net/rgmtF/16/](http://jsfiddle.net/rgmtF/16/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-29T06:35:25.273

为什么不在commentContainer级别引入一个新的css类来表示“selected”状态，即addClass（“selected”）。

当你点击回复

```
$(".commentbox .btnReply").live("click", function(){
  $('.commentContainer.selected').hide();  //hide previously selected comment divs if any
  $(this).parents('.commentContainer').addClass('selected');  //mark current as selected

  ...
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T13:57:09.127

更容易的是先创建回复区域，然后将这些节点移动到相应的区域。这将大大简化您的代码，并在您进行更改时更好地扩展。

上面的代码中提到了许多预先填充的 id，它们表示哪个注释是哪个。我认为使用这些 id 没有任何意义，因为这不是用于回复多条评论的东西。我的建议是让评论区字段保持静态，并使用隐藏字段来表示您要回复的评论。

您可以将其包装在一个不错的函数中，但原理仍然相同。

我创建了一个使用不同 HTML 的示例，但我认为以最简单的方式说明了这个想法。

[http://jsfiddle.net/ubTDD/1/](http://jsfiddle.net/ubTDD/1/) （这个小提琴有大量文档）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T18:56:10.930

如果您想在单击回复按钮时隐藏所有以前可见的文本框，只需在单击事件中添加一行代码即可。例如主容器 div id 是“master”

```
$("#master input[type=text]")​.hide();​ 
```

更好的是通过类名隐藏一个完整的元素块，包括文本框。

```
$(".tablecontent").hide(); 
```

示例代码看起来像

```
$(".commentbox .btnReply").live("click", function () {
      $(".tablecontent").hide();
      $(this).hide();
      ....
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T23:00:12.653

也许你可以通过以下方式解决这个问题：
1.给回复按钮的划分，一个名字。例如`<input id="<%:rid %>" type="button" value="Reply" class="btnReply"/>`
- 2.给你想要隐藏的文本区域的划分，一个类名。对于前 - “textarea”。

现在我将采用以下方式：

```
$(".commentbox .btnReply").live("click", function () {
      if ($('.textarea').is(':hidden')) {
         alert("Textarea is already hidden"); //check if already hidden
      } else {
         $('.textarea').hide();   //if not, then hide the textarea
      }
      ....
      ....
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-30T11:37:49.053

只需向所有文本框添加一个通用类名，或者使用一些 jquery 选择器来定位与页面上存在的回复按钮相关的所有文本框，然后使用通用类名或选择器首先隐藏所有文本框，然后再显示特定文本框与单击的回复按钮有关。

希望它能解决你的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-05T11:13:11.273

```
$('your-button-selector').click(function(){
  $('your-textbox-selector').slideUp();
  //$('your-textbox-selector').slideToggle();//use this to toggle show and hide
}); 
```

或使用：

```
<input type="button" name="sample-button" onclick="hideTextbox('textbox-selector')"/>
function hideTextbox(selector){
  $(selector).hide();
  //$(selector).slideToggle();
} 
```

# java - 调用 initLoader() 后 Loader 不启动？

> ID：10321712
> 
> 赞同：16
> 
> 时间：2012-04-25T18:34:31.730
> 
> 标签：java, android, android-activity, android-fragments, android-loadermanager

我有一个片段，并希望在单击按钮时启动一个加载器：

```
public class MyFragment extends Fragment {

    public void onActivityCreated() {
        super.onActivityCreated();

        Button btn = ...;
        btn.setOnClickListener(new OnClickListener() {
            public void onClick(View view) {
                getLoaderManager().initLoader(500, null, mMyCallback);
            }
        });
    }  

    private LoaderManager.LoaderCallbacks<String> mMyCallback = new  LoaderManager.LoaderCallbacks<String>() {

        @Override
        public Loader<String> onCreateLoader(int arg0, Bundle arg1) {
            Log.e(TAG, "LoaderCallback.onCreateLoader().");
            return new MyLoader(getActivity());
        }
    }
}

public class MyLoader extends AsyncTaskLoader<String> {
    public MyLoader(Context context) {
        super(context);
    }

    @Override
    public String loadInBackground() {
        Log.e(TAG, "Hi, running.");
        return "terrific.";
    }
} 
```

单击按钮后，我可以看到调用了回调的 onCreateLoader 方法，但创建的加载程序从未真正启动。我们是否需要在加载器本身上调用 forceLoad() 才能让它真正启动？没有一个示例帖子这样做，

谢谢

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-08-23T16:29:04.093

您需要在方法中的某处实现`onStartLoading()`和调用。`forceLoad()`

有关更多信息，请参阅这篇文章：[**实现加载器（第 3 部分）**](http://www.androiddesignpatterns.com/2012/08/implementing-loaders.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-25T19:15:46.603

根据我的经验，除非我使用`forceLoad()`.

您可能会发现上一个问题的答案很有帮助： [Android Honeycomb 中的加载器](https://stackoverflow.com/questions/4920930/loaders-in-android-honeycomb)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-03-07T09:54:18.700

关于 Loaders 的三个要点是：

1.  `forceLoad()`初始化加载器时始终使用方法。例如：

    ```
    getLoaderManager().initLoader(500, null, mMyCallback).forceLoad(); 
    ```

2.  始终执行`onStartLoading()`. `LoaderManager`当相关的片段/活动启动时，将自动调用此函数。

3.  确保加载器的 ID 是唯一的，否则将不会调用新的加载器。

如果仍然有问题，您可以通过调用该`isStarted()`方法检查 loader 的状态。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-01T21:08:34.360

您需要保留对您在方法中创建的加载程序实例的引用`onCreateLoader`。然后，要刷新它，请调用`yourLoader.onContentChanged();`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-10-17T15:23:36.733

If you have more than 1 loader in the same activity, make sure their id differs. I lost few hours to figure it out :)

# android - 如何为加载到 OpenGL 纹理中的 Android 资源位图使用高质量渲染？

> ID：10321719
> 
> 赞同：1
> 
> 时间：2012-04-25T18:35:00.540
> 
> 标签：android, opengl-es

我对OpenGL知之甚少，所以请温柔一点。

应用程序需要加载位图（从资源中），调整它的大小，并在 OpenGL 纹理中使用它。我有一个可行的实现，但是 Wildfire S 上存在一个糟糕的条带问题。所以我更改了实现并修复了条带问题（通过切换到 ARGB_8888），但这破坏了 Galaxy Nexus 和 Nexus One 上的功能。

我看到三个视觉演示：

1.  位图（平滑的 24 位渐变）显示正确，没有条纹。

2.  渐变显示，但有明显的条带

3.  纹理显示为纯白色，没有位图（或 logcat 中的问题）

以下是加载位图的方法的两个版本，并说明了每个版本的结果：

```
 // White on Galaxy Nexus. White on Nexus One. Renders correct image (no banding) on Wildfire S
    private Bitmap getBitmap1() {
        BitmapFactory.Options options = new BitmapFactory.Options();
        options.inPreferredConfig = Bitmap.Config.ARGB_8888;
        options.outWidth = getTextureSize();
        options.outHeight = getTextureSize();
        final Bitmap bmp;
        bmp = BitmapFactory.decodeResource(getResources(), bitmapResourceId, options);
        return bmp;
    }

    // Renders correctly (no banding) on Galaxy Nexus. Renders on Nexus One and Wildfire S but with obvious banding.
    private Bitmap getBitmap2() {
        int textureSize = getTextureSize();
        BitmapFactory.Options options = new BitmapFactory.Options();
        options.inPreferredConfig = Bitmap.Config.ARGB_8888;
        options.outWidth = getTextureSize();
        options.outHeight = getTextureSize();
        final Bitmap bmp;
        bmp = Bitmap.createScaledBitmap(BitmapFactory.decodeResource(getResources(), bitmapResourceId, options), textureSize, textureSize, true);
        return bmp;
    } 
```

getTextureSize() 返回 1024。

如何构建一种方法来显示位图而不在所有设备上进行条带化，并且没有任何设备显示大白框？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T20:03:41.257

[OpenGL.org](http://www.opengl.org/wiki/GL_Error_Codes)对这个错误有这样的说法：

> `GL_INVALID_VALUE`​, 0x0501：当值参数不是该函数的 leval 值时给出。这仅针对局部问题；如果规范在某些情况下允许该值，并且其他参数或状态规定了这些情况，则 GL_INVALID_OPERATION 是结果。

第一步是找到导致问题的确切 opengl 调用。您必须反复试验才能查看哪条线路引发了该错误。如果您像这样设置程序流程：

```
glSomeCallA()
glGetError() //returns 0
glSomeCallB()
glGetError() //returns 0
glSomeCallC()  
glGetError() //returns 0x501 
```

然后你就会知道这`glSomeCallC`是导致错误的操作。如果您查看该特定调用的手册页，它将枚举可能导致发生特定错误的所有内容。

在您的情况下，我猜该错误将在 glTexImage 调用之后为您节省一些时间，尽管我并不肯定。

如果您查看[glTexImage 手册页](http://www.opengl.org/sdk/docs/man/xhtml/glTexImage2D.xml)，它会在底部列出所有可能导致无效值错误的内容。我的猜测是您的纹理大于 GL_MAX_TEXTURE_SIZE。您可以通过检查来确认这一点`glGetIntegerv(GL_MAX_TEXTURE_SIZE);`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T20:05:21.547

**获取位图1**

outHeight 和 outWidth 与 inJustDecodeBounds 结合使用。您不能使用它们来加载缩放的位图。因此，您看到白色纹理的原因是位图不是 2 的幂。

**获取位图2**

您应该保留对 decodeResource 返回的位图的引用，以便以后可以回收它。也用于 `options.inScaled = false;`加载位图的未缩放版本。[另请注意，如果原始位图不包含 alpha 通道（ Source](https://stackoverflow.com/questions/6278992/does-bitmap-createscaledbitmap-convert-an-32-bit-image-into-24-bit) ） ，createScaledBitmap 可能会将位图的深度更改为 RGB_565 ；

问题：原始的Bitmap Resource是正方形的吗？如果不是，您的缩放代码将更改可能导致伪影的纵横比。

编辑：那么如何缩放位图并保留位深度？最简单的解决方案是将带有 alpha 通道的位图传递给 createScaledBitmap。你也可以像这样扩展自己：

```
 Bitmap newBitmap = Bitmap.createBitmap(1024, 1024, Bitmap.Config.ARGB_8888);
                    Canvas canvas = new Canvas(newBitmap);
                    final int width = src.getWidth();
                    final int height = src.getHeight();
                    final float sx = 1024  / (float)width;
                    final float sy = 1024 / (float)height;
                    Matrix m = new Matrix();
                    m.setScale(sx, sy);
                    canvas.drawBitmap(src,m,null );
                    src.recycle(); 
```

另一个编辑：看看这个[问题](https://stackoverflow.com/questions/8669765/opengl-gradient-banding-on-android)，了解如何处理这个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T18:03:00.217

色带解决了ooooooooooyyyyyyyeaaaaaaaaaa

我分两个阶段解决了色带问题

1) * 当我们使用 BitmapFactory 解码资源时，它会解码显示色带的 RGB565 资源，而不是使用 ARGB_8888，所以我使用 BitmapFactory.Options 将解码选项设置为 ARGB_8888

第二个问题是，每当我缩放位图时，它再次被带状

2）这是最困难的部分，经过大量搜索终于奏效*用于缩放位图的方法 Bitmap.createScaledBitmap 在缩放后也将图像缩小为 RGB565 格式，我得到了带状图像（解决这个问题的旧方法是使用至少一个png 中的透明像素，但没有像 jpg 或 bmp 这样的其他格式起作用）所以在这里我创建了一个方法 CreateScaledBitmap 来使用生成的缩放位图中的原始位图配置来缩放位图（实际上我从 logicnet.dk 的帖子中复制了该方法和翻译成java)

```
 BitmapFactory.Options myOptions = new BitmapFactory.Options();
    myOptions.inDither = true;
    myOptions.inScaled = false;
    myOptions.inPreferredConfig = Bitmap.Config.ARGB_8888;//important
    //myOptions.inDither = false;
    myOptions.inPurgeable = true;
    Bitmap tempImage =  
    BitmapFactory.decodeResource(getResources(),R.drawable.defaultart, myOptions);//important

    //this is important part new scale method created by someone else
    tempImage = CreateScaledBitmap(tempImage,300,300,false);

    ImageView v = (ImageView)findViewById(R.id.imageView1);
    v.setImageBitmap(tempImage); 
```

// 功能

```
public static Bitmap CreateScaledBitmap(Bitmap src, int dstWidth, int dstHeight, boolean filter)
{
    Matrix m = new Matrix();
    m.setScale(dstWidth  / (float)src.getWidth(), dstHeight / (float)src.getHeight());
    Bitmap result = Bitmap.createBitmap(dstWidth, dstHeight, src.getConfig());
    Canvas canvas = new Canvas(result);
    //using (var canvas = new Canvas(result))
    {
        Paint paint = new Paint();
        paint.setFilterBitmap(filter);
        canvas.drawBitmap(src, m, paint);
    }
    return result;

} 
```

如果我错了，请纠正我。如果它对你有用，也可以评论。

我很高兴我解决了它，希望它对你有用。

# sockets - recvfrom() 将发送方端口返回为 0（零）

> ID：10321720
> 
> 赞同：0
> 
> 时间：2012-04-25T18:35:00.527
> 
> 标签：sockets, udp, sendto

我有一个简单的 UDP 服务器和客户端。

客户端创建一个 DGRAM 套接字，绑定它（显式）（即使它不是必需的），使用 getsockname()（非零）打印出它绑定到的端口，然后发送一条消息（通过 sendto()），它是成功交付。

服务器使用 recvfrom() 接收消息。消息已正确接收，但发送者中的端口号为零接收到的第一条消息（我正在使用 ntohs()）。从第二条消息中，端口号正确显示（即客户端显示它的套接字绑定到的端口号相同）。

任何的想法？

更新：问题由我解决。请参阅下面的答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T03:49:59.307

我解决了这个问题。假设 recvfrom() 的最后一个参数是

```
socklen_t from_len;
```

那么你必须设置

```
from_len = sizeof(struct sockaddr_in);
```

（对于 IPv4）在 recvfrom() 调用之前。微不足道，我知道，但有时它会跳过你的想法:-)

# php - 带条件的 SQL 语句

> ID：10321721
> 
> 赞同：1
> 
> 时间：2012-04-25T18:35:03.783
> 
> 标签：php, mysql, sql

我有以下查询：

`SELECT a.name_f, a.uid, a.name_l, a.profile_pic, b.position FROM users a groups_members b, WHERE a.uid = b.userid AND b.group_id=$group_var`

这很有效，可以为我要呼叫的任何特定组带回所有用户的信息以及他们在组中的位置。当一个小组参加一个活动时，在那个活动页面上，我想调用上面的函数，但还要一个额外的语句来确定该用户是否被确认。所以我运行以下查询：

`SELECT a.name_f, a.uid, a.name_l, a.profile_pic, b.position, c.confirmed FROM users a groups_members b, event_users c WHERE a.uid = b.userid AND b.group_id='$group_var' and c.event_id ='$event_var' and a.uid = c.userid`

这也很好用，但这是我的问题出现的地方。假设某个组创建了一个事件，随后所有用户都被转储到 event_users 表中。我的第二个查询仍然有效，并显示该组中的每个用户以及他或她和确认的设置，但是当一个新用户加入该组并选择他或她的位置时，该新用户不会在我的第二个查询中返回，因此，显示所有用户及其位置的事件不考虑在事件创建后添加的任何新用户。

我希望这听起来不会太混乱。这是我的表：

```
event_users || id, event_id, userid, confirmed    

groups_members || id, userid, group_id, position

users || uid, name_f, name_l, profile 
```

我的问题是我怎样才能基本上收集所有当前的组成员，然后如果他们已经进入 event_users 表，他们的确认状态是什么。我不想在我的群组页面上运行查询新用户并将他们放入群组拥有的任何事件中

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T18:41:49.707

使用左连接：

```
 SELECT 
      a.name_f, a.uid, a.name_l, a.profile_pic, b.position, c.confirmed 
    FROM users a 
    JOIN groups_members b on a.uid = b.userid
    LEFT JOIN event_users c on a.uid = c.userid
    WHERE b.group_id='$group_var' and c.event_id ='$event_var' 
```

如果 event_users 表中没有对应记录，您将获得 NULL 作为 c.confirmed 的值。您可以使用 coalesce() 函数来放置默认值：

```
 coalesce(c.confirmed, 0) 
```

或者

```
 coalesce(c.confirmed, 'not subscribed yet') 
```

# ollydbg - 反汇编自修改代码

> ID：10321726
> 
> 赞同：9
> 
> 时间：2012-04-25T18:35:14.657
> 
> 标签：ollydbg, ida, self-modifying, disassembly

我一直在想——如何反汇编自修改二进制文件？我猜您不能使用 olly 或 IDA，因为它们是静态反汇编程序，对吗？如果你跳到指令的中间，反汇编程序会发生什么？以及如何分析变质引擎？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-25T18:52:38.710

OllyDbg 和 IDA 不仅是静态分析器，它们都可以运行代码。IDA 还可以远程运行您的代码，据我所知，它甚至可以进行嵌入式调试。当然，如果您在某个时候“中断”程序执行，并查看反汇编，它将（在两个程序中）反映程序的当前状态，包括它对自身所做的任何修改。

> 如果你跳到指令的中间，反汇编程序会发生什么？

根据我的经验，上述两种反汇编程序都可以处理这种情况。比如看这里，OllyDbg是怎么管理的，这里是EIP为00892C0E时的截图：

![之前的 OllyDbg](../Images/ae755abbff0944bce2d0b2a2fa4710b9.png)

当我使 EIP = 00892C0F 时，它位于指令的中间：

![OllyDbg 之后](../Images/5d272dca98e02ef8ab96ac235f38a9ff.png)

如您所见，它只是重新反汇编指令，使其成为不同（但仍然有效）的操作码。

> 以及如何分析变质引擎？

就像任何其他代码一样。您提到的技巧（跳转到指令的中间，修改自身）在不久前主要流行，当时反汇编器和调试器不像现在那么聪明。

当然静态分析可能非常困难，但您当然仍然可以完全离线分析二进制文件并破译“变形”（在您的脑海中）以了解代码将做什么。但是，当您可以实时使用调试器时，您就可以简单地看到代码在做什么。

当然，所有这一切都是编写代码的人和分析代码的人之间的无休止的竞赛。谁赢取决于谁更早放弃。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T21:05:02.943

Ollydbg 将处理这种情况。

您正在寻找的功能是“分析”。它将重新反汇编该位置的新指令，并使用更新的代码刷新 CPU 窗口。

假设地址 X 处的指令将进行一些自修改更改。执行该指令后，您可以运行“分析”命令。这是围绕该基本块重新反汇编代码并使用更新的指令刷新 CPU。

要进行分析，请右键单击 CPU 窗口中的所需位置，然后单击 **Analysis> Analyze Code**。快捷方式是**Ctrl-A**。

# ruby-on-rails - group_by 显示 belongs_to 'name' 后跟 has_many 'items'

> ID：10321734
> 
> 赞同：0
> 
> 时间：2012-04-25T18:35:31.563
> 
> 标签：ruby-on-rails

我正在尝试显示组名称（product_group），然后是每个组中的项目（产品）。

```
<% @products.group_by(&:product_group_id).each do |s|%> 
    <!--need to get group name here ->                                              
    <% s[1].each do |d|%>
    <%= d.product_name%>
    <br>
    <%end%>
<%end%> 
```

导轨 2.3.8

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T18:55:19.537

首先，我强烈建议您在块中使用两个变量。当您使用一个变量时， group_by 将变量设置为应设置为两个变量的一对值的数组。这将比使用 [1] 为组索引对更清晰的代码。

一种方法是该对的第一部分将是 id，因此您可以进行查找。

```
<% @products.group_by(&:product_group_id).each do |product_group_id, products|%> 
  <!--need to get group name here -->
  <%= ProductGroup.find(product_group_id).name %>

  <% products.each do |product|%>
    <%= product.product_name%>
    <br>
  <% end %>
<% end %> 
```

另一种方法是，由于您在组中至少有一个产品的数组，您可以在数组的第一个元素上调用 product_group 关联。

```
<% @products.group_by(&:product_group_id).each do |product_group_id, products|%> 
  <!--need to get group name here -->
  <%= products[0].product_group.name %>

  <% products.each do |product|%>
    <%= product.product_name%>
    <br>
  <% end %>
<% end %> 
```

您还可以将名称委派给产品组。

```
class Product
  belongs_to :product_group
  delegate :name, :to => :product_group, :prefix => true, :allow_nil => true
end

<%= products[0].product_group_name %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:42:36.163

Group by 在块声明中需要两个变量。第一个用于您分组的事物，第二个用于保存每个组中的事物。

```
<% @products.group_by(&:product_group_id).each do |group_id, group_products| %>
  Group ID: <%= group_id %>
  <br>
  Products:
  <% group_products.each do |product| %>
    <%= product.product_name %>
  <% end %>
<% end %> 
```

# maven - 如何从 Maven POM 文件中删除注释

> ID：10321735
> 
> 赞同：1
> 
> 时间：2012-04-25T18:35:45.107
> 
> 标签：maven, pom.xml

我有带有评论的 POM 文件。我想在 Netbeans 的编译期间删除它们。我发现有一个maven插件——maven-config-processor-plugin。但是没有信息如何从 POM 文件中删除评论？有什么解决办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T23:44:04.240

Codehaus 有一个[xml maven 插件](http://mojo.codehaus.org/xml-maven-plugin/)，它说它可以使用 XSLT 样式表转换 XML 文件。@Mark O'Connor 提到的[答案](https://stackoverflow.com/questions/1464697/stripout-comments-from-xml)给出了一个示例样式表。将两者放在一起可能会满足您的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T23:37:27.233

如果您将 pom 翻译为“生产”，那么您可能希望生成[**有效的 pom**](http://maven.apache.org/plugins/maven-help-plugin/effective-pom-mojo.html)：

```
mvn help:effective-pom 
```

或者

```
mvn help:effective-pom -Doutput=production-pom.xml 
```

这不仅会删除注释，还会插入（=解析）任何属性引用，`dependencyManagement`并`pluginManagement`从父 pom 应用和应用，这使得 pom 非常“独立”。

# c - 如何在limits.conf 中为CAP_IPC_OWNER 添加Linux 功能？

> ID：10321737
> 
> 赞同：1
> 
> 时间：2012-04-25T18:35:50.050
> 
> 标签：c, linux, linux-kernel, linux-capabilities

我有一个`/etc/security/limits.conf`文件如下

```
manu             -       memlock         unlimited
manu             -       rtprio          100
manu             -       nice            40
manu             -       stack           unlimited 
```

现在我希望用户“manu”能够使用`shmctl`需要的功能`CAP_IPC_OWNER`，我应该如何修改这个文件才能拥有这个功能？可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T07:52:43.870

那不是设置功能的地方。使用系统调用`capset()`来执行此操作，例如，您以 root 身份启动您的进程，使用 设置此功能`capset()`，然后您可以更改您的 UID；或者您可以从另一个进程执行此操作，但您需要 pid。

另一种方法是使用`setcap()`将其设置为可执行文件的属性，请参阅`setcap(8)`.

# objective-c - 一个大类与 Cocoa Mac 应用程序的几个小类的比较

> ID：10321739
> 
> 赞同：1
> 
> 时间：2012-04-25T18:35:54.060
> 
> 标签：objective-c, macos, cocoa, class, automatic-ref-counting

我创建了一个使用 ARC 的应用程序，它解析来自在线 XML 文件的数据。我能够使用一个类和一个 API 调用来获得我需要的一切。API 提供 XML 数据。由于 xml 文件很大，我有很多与这个类相关的变量、IBOutlets 和 IBActions。

但是有两种方法：

1) 创建一个解析 XML 数据并为您的应用程序实现该数据的类，即创建一个可以完成所有操作的类（正如我已经完成的那样）

或者

2) 创建一个解析 XML 数据的类并创建其他类来处理从 XML 解析器类获得的数据，即一个类进行解析，另一个类实现该数据

请注意，某些提供 XML 数据的 API 会跟踪其服务的呼叫/分钟或呼叫/天数。因此，您不希望多个类调用 API，最好向接收您需要的所有数据的 API 发出一个请求。

那么是使用几个较小的类来处理 xml 数据更好，还是只使用一个大类来处理所有事情呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T01:06:51.573

如有疑问，小班会更好。

> 2) 创建一个解析 XML 数据的类并创建其他类来处理从 XML 解析器类获得的数据，即一个类进行解析，另一个类实现该数据

这样做的一个关键优势是后一类模型与前一类所做的解析工作是分开的。这变得很重要：

*   正如 Peter Willsey 所说，当您的 XML 解析器发生变化时。例如，如果您从基于流的解析切换到基于文档的解析，反之亦然，或者如果您从一个解析库切换到另一个解析库。
*   当您的 XML 输入发生更改时。如果您想添加对新格式或格式的新版本的支持，或者取消对过时格式的支持，您可以简单地添加/删除解析类；模型类可以保持不变（或者只接受小的和明显的改进以支持新/改进格式的新功能）。
*   当您添加对非 XML 输入的支持时。例如，JSON、plist、键控存档或自定义专有格式。同样，您可以简单地添加/删除解析类；模型类不需要改变太多，如果有的话。

即使这些事情都没有发生，它们仍然比混合在一起更好。解析输入和建模用户数据是两个不同的工作；将它们混在一起会使它们难以或不可能单独推理。将它们分开，您可以更改其中一个而无需绕过另一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T21:42:15.827

我想这取决于您的应用程序。需要考虑的是，如果您必须更改正在使用的 XML 解析器怎么办？你将不得不重写你的单体类，你可能会破坏很多不相关的功能。如果您抽象了 XML 解析器，那么只需重写该特定类的实现即可。或者，如果您的应用程序范围发生变化，突然您有多个视图怎么办？您能否在不违反 DRY（不要重复自己）原则的情况下在其他地方重用代码？

您要争取的是低耦合和高内聚，这意味着类不应相互依赖，类应具有明确的职责和高度相关的方法。

# python - 使用 zip 的字典列表，将增量列表名称传递给函数

> ID：10321740
> 
> 赞同：2
> 
> 时间：2012-04-25T18:35:55.233
> 
> 标签：python, list, dictionary, zip

按照建议，我正在编写一个文本冒险游戏作为我的第一个 python 程序。我想要一张狗可能吃的东西的清单，它们有什么不好的，它们有多坏。所以，我想我会这样做：

```
badfoods = []
keys = ['Food','Problem','Imminent death']

food1 = ['alcohol', 'alcohol poisoning', 0]
food2 = ['anti-freeze', 'ethylene glycol', 1]
food3 = ['apple seeds', 'cyanogenic glycosides', 0] 

badfoods.append(dict(zip(keys,food1)))
badfoods.append(dict(zip(keys,food2))) 
badfoods.append(dict(zip(keys,food3))) 
```

实际上，我想包括大约 40 种食物。我知道我也可以这样做：

```
[{'Food':'alcohol', 'Problem':'alcohol poisoning', 'Imminent death':0},
 {'Food':'anti-freeze', 'Problem':'ethylene glycol', 'Imminent death':1}
 {'Food':'apple seeds, 'Problem':'cyanogenic glycosides', 'Imminent death':0}] ] 
```

我还在这里阅读了这篇关于使用 YAML 的文章，这很有吸引力： [实现嵌套字典的最佳方法是什么？](https://stackoverflow.com/questions/635483/what-is-the-best-way-to-implement-nested-dictionaries-in-python/636138#636138) 但我仍然不知道如何避免大量写键。

另外，我很生气，因为我无法弄清楚避免编写附加 40 次的原始方法，即：

```
def poplist(listname, keynames, name):
    listname.append(dict(zip(keynames,name)))

def main():
    badfoods = []
    keys = ['Food','Chemical','Imminent death']

    food1 = ['alcohol', 'alcohol poisoning', 0]  
    food2 = ['anti-freeze', 'ethylene glycol', 1]
    food3 = ['apple seeds', 'cyanogenic glycosides', 0]
    food4 = ['apricot seeds', 'cyanogenic glycosides', 0]
    food5 = ['avocado', 'persin', 0]
    food6 = ['baby food', 'onion powder', 0]

    for i in range(5):
        name = 'food' + str(i+1)
        poplist(badfoods, keys, name)

    print badfoods
main() 
```

我认为它不起作用，因为我的 for 循环正在创建一个字符串，然后将其提供给函数，而函数 poplist 不将其识别为变量名。但是，我不知道是否有办法解决这个问题，或者我是否必须每次都使用 YAML 或写出密钥。任何帮助表示赞赏，因为我很难过！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T18:43:50.617

如果你一开始就把它做成一个单一的结构，那就更容易了。

```
foods = [
  ['alcohol', 'alcohol poisoning', 0],
  ['anti-freeze', 'ethylene glycol', 1],
  ['apple seeds', 'cyanogenic glycosides', 0],
  ['apricot seeds', 'cyanogenic glycosides', 0],
  ['avocado', 'persin', 0],
  ['baby food', 'onion powder', 0]
]
badfoods = [dict(zip(keys, food)) for food in foods] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-25T18:43:46.630

你在附近：

```
>>> keys = ['Food','Chemical','Imminent death']
>>> foods = [['alcohol', 'alcohol poisoning', 0],
             ['anti-freeze', 'ethylene glycol', 1],
             ['apple seeds', 'cyanogenic glycosides', 0]]
>>> [dict(zip(keys, food)) for food in foods]
[{'Food': 'alcohol', 'Chemical': 'alcohol poisoning', 'Imminent death': 0}, {'Food': 'anti-freeze', 'Chemical': 'ethylene glycol', 'Imminent death': 1}, {'Food': 'apple seeds', 'Chemical': 'cyanogenic glycosides', 'Imminent death': 0}] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T19:15:56.210

我建议遵循最佳实践并将数据与代码分开。只需使用最适合您需要的格式将您的数据存储在另一个文件中。从您到目前为止发布的内容来看，CSV 似乎是一个自然的选择。

```
# file 'badfoods.csv': 

Food,Problem,Imminent death
alcohol,alcohol poisoning,0
anti-freeze,ethylene glycol,1
apple seeds,cyanogenic glycosides,0 
```

在您的主程序中，只需两行即可加载它：

```
from csv import DictReader

with open('badfoods.csv', 'r') as f:
    badfoods = list(DictReader(f)) 
```

# mysql - 运行时出现 Grails SQL 错误

> ID：10321741
> 
> 赞同：1
> 
> 时间：2012-04-25T18:36:01.237
> 
> 标签：mysql, grails, dynamic-finders

我正在尝试为 Grails 中的学校项目制作一个简单的 Web 应用程序。我可以访问服务器、保存、删除和其他所有操作，但每当我第一次运行该应用程序时，我都会收到大量 SQL 错误。我正在使用 Grails 2.0.3 和 mysql-connector-java-5.1.19。

我收到以下错误，许多其他人喜欢它：

错误 2012-04-25 14:28:54,009 [pool-5-thread-1] 错误 hbm2ddl.SchemaUpdate - 不成功：更改表 character_trait 添加索引 FK93D74D785F2F8048 (character_traits_id)，添加约束 FK93D74D785F2F8048 外键 (character_traits_id) 引用字符 (id)

错误 2012-04-25 14:28:54,009 [pool-5-thread-1] 错误 hbm2ddl.SchemaUpdate - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的“字符（id）”附近使用正确的语法

并且在使用 findby 动态查找器进行查询时：

com.mysql.jdbc.exceptions.MySQLSyntaxErrorException 类

消息您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的“character this_ where this_.player_id=1 limit 1”附近使用正确的语法

关于为什么会发生这种情况的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T20:33:54.893

`CHARACTER`是 MySQL 中的[保留字](https://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)。它需要被引用以用作表或列名。您可以像这样在表映射中引用它：

```
class Character {
    static mapping = {
        table name: '`character`'
    }
} 
```

# cobol - 如何限制运行我的 cics 程序的访问权限

> ID：10321743
> 
> 赞同：1
> 
> 时间：2012-04-25T18:36:16.713
> 
> 标签：cobol, cics

我有一个 cics 应用程序，我不想开发登录屏幕，而是想通过获取用户 ID 来限制访问，然后验证是否允许他们运行我的应用程序。这可能吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T19:56:55.600

在 CICS 环境中限制对某些事务的访问可能比通过获取 USER ID 并与列表进行比较更好的方法。大多数商店已经开发出标准技术来限制对 CICS 内交易的访问。但是，如果您必须找到用户 ID，请尝试以下操作：

```
 EXEC CICS ASSIGN                                              
            USERID(WS-USERID)                                        
       END-EXEC. 
```

哪里`WS-USERID`是工作存储 PIC X(8) 字段。

这是[CICS ASSIGN](http://publib.boulder.ibm.com/infocenter/txformp/v6r0m0/index.jsp?topic=%2Fcom.ibm.cics.te.doc%2Ferziai0025.htm)文档的链接。

**编辑**

如何检查多个用户ID？您需要一个授权用户列表来比较当前用户 ID。如果用户 id 在列表中，则该用户被授权使用该事务。通常，您有几个选项来管理此类列表：

*   SELECT 针对包含授权用户 ID 的数据库表。使用当前用户 ID 作为谓词（例如 WHERE USER_ID = :WS-USERID）。如果您返回一行，则该用户已获得授权。
*   [SEARCH/SEARCH ALL](http://publibfp.boulder.ibm.com/cgi-bin/bookmgr/BOOKS/IGY3LR31/6.2.32?DT=20060329140556)一个 WORKING-STORAGE 表，其中填充了匹配的授权用户 ID。如果你得到一个匹配，用户被授权。

WORKING-STORAGE 表解决方案最不灵活，因为每次添加或删除新用户时可能需要更新和重新编译程序。

[但是，正如我和cschneid](https://stackoverflow.com/a/10324676/192510)所指出的，访问安全最好在应用程序之外使用 RACF 或 ACF2 之类的东西来处理。您的本地系统管理员应该能够帮助您进行此设置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T22:23:02.063

CICS 可以与外部安全管理器对话，例如 RACF、CA-ACF2 或 CA-Top Secret。通过在外部安全管理器中设置正确的规则或配置文件，应用程序通常在事务级别得到保护。

这样，安全操作在应用程序逻辑之外执行。访问权限由安全人员而非应用程序开发人员授予。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-26T22:27:21.397

继续您对[NealB](https://stackoverflow.com/users/192510/nealb)关于多个用户的回答的评论：您的安全管理员可以将所有有问题的用户 ID 添加到一个组中，然后为您的事务定义对该组的访问权限。

你真的应该让你的安全管理处理事务访问。良好的系统设计将安全管理置于应用程序之外。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-09-08T15:13:25.047

使用带有安全扩展功能包（集成在 V5.2 中）的 CICS TS V4.2 及更高版本，您可以使用来自分布式应用程序的 SAML 断言来提供更精细的访问控制。

# php - 有没有特定的方法来 PING 带有 url 的搜索引擎（如 pingler.com）？

> ID：10321755
> 
> 赞同：0
> 
> 时间：2012-04-25T18:37:10.597
> 
> 标签：php

是否有应该传递给 ping 代理的标准变量？

我正在尝试创建自己的，但我不确定它是如何工作的。

是否像将 REST 调用附加到每个 url 一样简单，还是需要采用某种格式？

谢谢

**编辑**

抱歉问题描述不好。

基本上我不想弄清楚 pingler.com 如何将 url ping 到搜索引擎，以便它们蜘蛛更新引擎结果。

谢谢

**编辑**

谢谢大家的好答案

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T18:54:48.240

不，没有。据推测，pingler 对其处理的每个搜索引擎都有自定义代码。

# python - Python链接下载器慢

> ID：10321756
> 
> 赞同：0
> 
> 时间：2012-04-25T18:37:11.050
> 
> 标签：python, beautifulsoup, lxml

有没有办法通过使用 lxml 或 mechanizer 并一起切出漂亮的汤来提高这个脚本的速度？

Python：

```
import lxml.html as html
import urllib
import urlparse
from BeautifulSoup import BeautifulSoup
import re
import os, sys
print ("downloading and parsing bibles...")
root = html.parse(open('all.html'))
for link in root.findall('//a'):
  url = link.get('href')
  name = urlparse.urlparse(url).path.split('/')[-1]
  dirname = urlparse.urlparse(url).path.split('.')[-1]
  f = urllib.urlopen(url)
  s = f.read()
  if (os.path.isdir(dirname) == 0): 
    os.mkdir(dirname)
  soup = BeautifulSoup(s)
  articleTag = soup.html.body.article
  converted = str(articleTag)
  full_path = os.path.join(dirname, name)
  open(full_path, 'w').write(converted)
  print(name)
print("downloads complete!") 
```

all.html

```
<a href="http://www.youversion.com/bible/gen.1.nmv-fas">http://www.youversion.com/bible/gen.1.nmv-fas</a>

<a href="http://www.youversion.com/bible/gen.2.nmv-fas">http://www.youversion.com/bible/gen.2.nmv-fas</a>

<a href="http://www.youversion.com/bible/gen.3.nmv-fas">http://www.youversion.com/bible/gen.3.nmv-fas</a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T19:00:09.837

您应该从衡量脚本中真正需要时间的内容开始。优化不慢的东西是浪费你的时间。

它可能是下载，而不是解析。在这种情况下，切换解析器将无济于事。为了加快使用线程（每个下载一个）下载许多文件的速度**可能会**有所帮助，因为另一个下载可以在第一个完成之前开始。

# sql - 连接数据库时用户控制访问错误目录

> ID：10321763
> 
> 赞同：0
> 
> 时间：2012-04-25T18:37:28.823
> 
> 标签：sql, database, vb.net, visual-studio, user-controls

我创建了一个用户控件作为容器来充当发票程序的计费行，但是当我尝试将其添加到表单时，它会尝试连接到位于 C:\Program Files (x86)\Microsoft Visual Studio 的数据库10.0\Common7\IDE\DatabaseName.mdf 而不是我的项目目录。有谁知道如何解决这一问题？

完全错误：

“无法创建组件“InvoiceEntry”。错误消息如下：'System.Data.SqlClient.SqlException (0x80131904)：尝试为文件 C:\Program Files (x86)\Microsoft Visual Studio 10.0 附加自动命名数据库\Common7\IDE\DatabaseName.mdf 失败。存在同名数据库，或无法打开指定文件，或位于 UNC 共享上。

编辑：连接字符串如下所示：

```
<connectionStrings>
    <add name="AdvVB_Final.My.MySettings.Bauer_BusinessConnectionStringMDF"
        connectionString="Data Source=.\SQLEXPRESS;AttachDbFilename=|DataDirectory|\Bauer_Business.mdf;Integrated Security=True;Connect Timeout=30;User Instance=True"
        providerName="System.Data.SqlClient" />
</connectionStrings> 
```

第二次编辑：可能还值得知道的是，即使我将其添加为设计器窗口中的数据绑定项，组合框也不会使用数据库数据进行更新。如果我单击预览数据，则会显示正确的数据。只有在运行时才会正确填充。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T22:23:11.950

我有这个完全相同的问题。发生的事情是我在构造函数中连接到数据库，导致在设计时调用数据库连接，这不起作用......为了解决这个问题，我将数据库交互移动到控件加载事件。

# python - 我想从python中的字符串中删除'\'

> ID：10321767
> 
> 赞同：-7
> 
> 时间：2012-04-25T18:37:36.027
> 
> 标签：python, controls, character

> **可能重复：**
> [如何在python字符串中引用“\”符号](https://stackoverflow.com/questions/3531430/how-to-refer-to-sign-in-python-string)

我有相当大的字符串数据，其中我必须删除除 AZ、az 和 0-9 以外的所有字符。我几乎可以删除每个字符，但 '\' 是个问题。

其他所有字符都被删除，但 '\' 出现问题

```
def replace_all(text, dic):
    for i, j in dic.iteritems():
        text = text.replace(i, j)
    return text

reps = {' ':'-','.':'-','"':'-',',':'-','/':'-',
        '<':'-',';':'-',':':'-','*':'-','+':'-',
        '=':'-','_':'-','?':'-','%':'-','!':'-',
        '$':'-','(':'-',')':'-','\#':'-','[':'-',
        ']':'-','\&':'-','@':'-','\W':'-','\t':'-'}

x.name = x.name.lower()

x1 = replace_all(x.name,reps) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T18:42:32.403

> 我有相当大的字符串数据，我必须删除除 AZ、az 和 0-9 以外的所有字符

换句话说，您只想保留这些字符。

字符串类已经提供了一个测试“每个字符都是字母还是数字？”，称为`.isalnum()`. 所以，我们可以`filter`这样：

```
>>> filter(str.isalnum, 'foo-bar\\baz42')
'foobarbaz42' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T18:42:23.253

如果你有一个字符串：

```
a = 'hi how \\are you' 
```

您可以通过执行以下操作将其删除：

```
a.replace('\\','')

>'hi how are you' 
```

如果您有遇到问题的特定上下文，我建议您发布更多详细信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T18:41:27.060

birryee 是正确的，您需要用第二个反斜杠转义反斜杠。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-25T18:41:33.410

> 删除除 AZ、az 和 0-9 以外的所有字符

与其尝试列出您要删除的所有字符（这将花费*很长时间*），不如使用正则表达式来指定您希望保留的那些字符：

```
import re
text = re.sub('[^0-9A-Za-z]', '-', text) 
```

# linq - 使用 IEqualityComparer 检查特定值

> ID：10321771
> 
> 赞同：0
> 
> 时间：2012-04-25T18:37:50.833
> 
> 标签：linq, list, c#-4.0, distinct, iequalitycomparer

所以这是我第一次尝试使用 IEqualityComparer 并且遇到了问题。

很可能我只是不明白代码在幕后做什么。

我提供的列表如下所示：

```
Test Run | SN    | Retest
1          185     0
2          185     1
3          185     1
4          185     1 
```

我正在尝试使用 Distinct() 来查找具有唯一 SN 和 'retest==1' 的项目数。

```
var result = testRunList.Distinct(new UniqueRetests()); 
```

派生的 IEqualityCompare 类如下所示：

```
public class UniqueRetests : IEqualityComparer<TestRunRecord>
{
    // Records are equal if their SNs and retest are equal.
    public bool Equals(TestRunRecord x, TestRunRecord y)
    {
        //Check whether any of the compared objects is null.
        if (Object.ReferenceEquals(x, null) || Object.ReferenceEquals(y, null))
            return false;

        //Check whether it's a retest AND if the specified records' properties are equal.
        return x.retest == 1 && y.retest == 1 && x.boardSN == y.boardSN;
    }

    // If Equals() returns true for a pair of objects 
    // then GetHashCode() must return the same value for these objects.

    public int GetHashCode(TestRunRecord record)
    {
        //Check whether the object is null
        if (Object.ReferenceEquals(record, null)) return 0;

        //Get hash code for the board SN field.
        int hashRecordSN = record.boardSN.GetHashCode();

        //Get hash code for the retest field.
        int hashRecordRetest = record.retest.GetHashCode();

        //Calculate the hash code for the product.
        return hashRecordSN ^ hashRecordRetest;
    }
} 
```

问题是这似乎产生了一个包含前两个项目的列表，而我正在寻找的是一个列表，其中只包含一个“retest == 1”的项目。

知道我在这里做错了什么吗？'retest == 0' 的记录是如何返回的？

**回答**

> 如果条件为假，则将对象视为不相等。Distinct 返回不相等的行。顺便说一句，您使用这种类型的代码违反了 IEqualityComparer 的合同。结果实际上是不确定的。- 用户
> 
> 对于“违反合同”，我的意思是（例如）具有 retest==0 的对象将与自身比较不相等。- 用户

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:41:01.173

您需要过滤掉 retest = 0 的项目。将 .Where(x => x.retest != 0) 放在 Distinct 前面。

# oracle - 在 Oracle 中更改列的数据类型

> ID：10321775
> 
> 赞同：22
> 
> 时间：2012-04-25T18:38:11.573
> 
> 标签：oracle, oracle10g, oracle11g

我创建了下表

```
CREATE TABLE PLACE(
  POSTCODE VARCHAR(10) PRIMARY KEY,
  STREET_NAME VARCHAR(10),
  COUNTY VARCHAR(10),
  CITY VARCHAR(10)); 
```

我想将`name`,`county`和`city`从更改`varchar(10)`为`varchar(20)`。我怎么做？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-04-25T18:42:37.910

```
ALTER TABLE place
  MODIFY( street_name VARCHAR2(20),
          county      VARCHAR2(20),
          city        VARCHAR2(20) ) 
```

请注意，我还将数据类型从`VARCHAR`更改`VARCHAR2`为更传统。目前两者之间没有功能差异，尽管`VARCHAR`未来可能会改变行为以匹配 SQL 标准。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-07-07T07:44:37.547

**如果您只想更改列的类型，请使用以下内容：**

```
ALTER TABLE <table_name> MODIFY (<column_name> <new_Type>)
in your case:    
ALTER TABLE place MODIFY (street_name VARCHAR2(20),
                          county      VARCHAR2(20),
                          city        VARCHAR2(20)) 
```

如果您的表格有数据，您可以采取以下行动：

1.  将具有新类型的列添加到表中。
2.  将数据从旧列复制到新列。
3.  删除旧列。
4.  将新列重命名为旧列。

要重命名列，请使用以下命令：

```
ALTER TABLE <table_name> rename column <column_name> to <new_column_name> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-23T17:56:05.280

# Oracle 10G 及更高版本

```
ALTER TABLE table_name
MODIFY column_name datatype; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-01T12:25:01.807

一个非常普遍的例子是在这里做同样的 -

**桌子：**

```
CREATE TABLE TABLE_NAME(
  ID NUMBER PRIMARY KEY,
  COLUMN_NAME NUMBER NOT NULL,   -- Modify with varchar2(20) NOT NULL
  .
  .
  .  
); 
```

**将COLUMN_NAME**的数据类型从**NUMBER**修改为**VARCHAR2的步骤**

**脚步：**

```
--Step 1: Add a temp column COLUMN_NAME_TEMP in table TABLE_NAME to hold data temporary
ALTER TABLE TABLE_NAME
ADD( COLUMN_NAME_TEMP           varchar2(20) );

--Step 2: Update temp column COLUMN_NAME_TEMP with Old columns COLUMN_NAME data
UPDATE TABLE_NAME
SET COLUMN_NAME_TEMP   = COLUMN_NAME;

--Step 3: Remove NOT NULL constrain from old columns COLUMN_NAME
ALTER TABLE TABLE_NAME MODIFY (COLUMN_NAME NULL);

--Step 4: Update old columns COLUMN_NAME data with NULL
UPDATE TABLE_NAME SET COLUMN_NAME  = NULL;

--Step 5: Alter table old columns COLUMN_NAME to new data type varchar2(20)
ALTER TABLE TABLE_NAME MODIFY COLUMN_NAME varchar2(20);

--Step 6: Update old columns COLUMN_NAME with data from temp columns COLUMN_NAME_TEMP
UPDATE TABLE_NAME
SET COLUMN_NAME  = COLUMN_NAME_TEMP;

--Step 7: Add NOT NULL constrain from old columns [COLUMN_NAME]
ALTER TABLE TABLE_NAME MODIFY (COLUMN_NAME NOT NULL);

--Step 8: Drop the temp column [COLUMN_NAME_TEMP]
alter table TABLE_NAME drop column COLUMN_NAME_TEMP; 
```

**如果*NOT NULL*约束不存在，则省略第 3 步和第 7 步**

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-10-15T20:02:45.317

```
Alter table placemodify(street name varchar2(20),city varchar2(20) 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2015-06-12T07:00:04.643

如果表中已经存在一定数量的记录，则无法修改表的数据类型。

您必须先清空该列的表记录（您要修改数据类型），然后使用以下命令：

```
alter table place
modify ( street_name varchar2(20), country varchar2(20), city varchar2(20) ); 
```

肯定会奏效的！

# php - PHP svn 更新

> ID：10321778
> 
> 赞同：0
> 
> 时间：2012-04-25T18:38:21.427
> 
> 标签：php, svn

我正在尝试通过网络浏览器使 svn 目录可读，所以我要做的是使用 svn php 扩展来检查它。我已经设法使用命令行 php thingy 通过 ssh 签出和更新目录。它可以正常工作。但是，如果我尝试使用网页上的 .php 文件更新目录，它会给我错误代码 500。错误日志这样说

```
PHP Fatal error:  Call to
           undefined function svn_update() in /home/derp/public_html/svn/php/update_svn.php 
```

我没有做太多的php，我不知道如何使这项工作。这里有人知道吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T18:41:00.907

您需要安装[PECL 扩展`svn`](http://pecl.php.net/package/svn)才能使此功能存在于您的 PHP 安装中。

# c++ - openCV 存储文件错误：

> ID：10321780
> 
> 赞同：3
> 
> 时间：2012-04-25T18:38:52.763
> 
> 标签：c++, file, opencv, matrix

我正在尝试从 .yaml 文件加载矩阵，但 opencv 给了我以下错误：

> OpenCV 错误：解析错误（myFile.yaml(1)：有效的 xml 应以 ' 开头） OpenCV 错误：解析错误（myFile.yaml(1)：标记应以未知函数中的 '<'> 开头）

这是我的写入存储文件，工作正常：

```
cv::FileStorage fs("myFile.yaml", cv::FileStorage::APPEND);   
while(counter<_imgPtrVector.size()){    
    unsigned char* _pointer=(unsigned char*)_imgPtrVector.at(counter);
    cv::Mat _matrixImage(cv::Size( width,height), CV_8UC1,_pointer , cv::Mat::AUTO_STEP);       
    fs <<"Matrix"<<_matrixImage;
    counter++;
} 
```

但是当我想从同一个文件中加载数据时，我得到了这些错误；这是从存储文件中读取的代码：

```
cv::FileStorage f("myFile.yaml", cv::FileStorage::READ );
cv::Mat mat(cv::Size( width,height), CV_8UC1);  
if(f.isOpened()){
    cv::FileNode n = f["Matrix"];
    if (n.type() != cv::FileNode::SEQ){
     std::cout << "error!";
    }
    f["Matrix"] >>  mat; 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T18:45:37.497

问题可能是您总是附加到现有文件。因此，您可能必须将代码更改为：

```
FileStorage fs("test.yml", FileStorage::WRITE); 
```

这将在您的程序每次运行时重新创建文件。

OpenCV 文档有一个关于[如何使用 XML/YAML Persistence**编写**](http://opencv.itseez.com/modules/core/doc/xml_yaml_persistence.html#xml-yaml-file-storages-writing-to-a-file-storage)的示例，非常清楚：

```
#include "opencv2/opencv.hpp"
#include <time.h>

using namespace cv;

int main(int, char** argv)
{
    FileStorage fs("test.yml", FileStorage::WRITE);

    fs << "frameCount" << 5;
    time_t rawtime; time(&rawtime);
    fs << "calibrationDate" << asctime(localtime(&rawtime));
    Mat cameraMatrix = (Mat_<double>(3,3) << 1000, 0, 320, 0, 1000, 240, 0, 0, 1);
    Mat distCoeffs = (Mat_<double>(5,1) << 0.1, 0.01, -0.001, 0, 0);
    fs << "cameraMatrix" << cameraMatrix << "distCoeffs" << distCoeffs;
    fs << "features" << "[";
    for( int i = 0; i < 3; i++ )
    {
        int x = rand() % 640;
        int y = rand() % 480;
        uchar lbp = rand() % 256;

        fs << "{:" << "x" << x << "y" << y << "lbp" << "[:";
        for( int j = 0; j < 8; j++ )
            fs << ((lbp >> j) & 1);
        fs << "]" << "}";
    }
    fs << "]";
    fs.release();
    return 0;
} 
```

还有另一个例子说明了[如何**阅读**](http://opencv.itseez.com/modules/core/doc/xml_yaml_persistence.html#reading-data-from-a-file-storage)。

# ruby-on-rails - 使用 rspec 集成测试新记录

> ID：10321782
> 
> 赞同：0
> 
> 时间：2012-04-25T18:39:04.143
> 
> 标签：ruby-on-rails, testing, rspec

我正在测试项目的创建（使用 rspec 集成测试），我想知道为什么测试找不到我刚刚告诉它创建的项目......这是我的代码

```
 1 require 'spec_helper'
  2 
  3 describe "Projects" do
  4   describe "create project" do
  5 
  6     before :each do
  8       @valid_project = { :name => 'Myproject', :description => 'project description' }
  9     end
 10 
 11     it "should create and redirect to a new project" do
 12       lambda do
 13         visit root_path
 14         click_link 'new project'        
 15         fill_in :name, :with => @valid_project[:name]
 16         fill_in :description, :with => @valid_project[:description] 
 17         click_button 'Create'
 18         current_path.should == project_path(Project.find_by_name!(@valid_project[:name]))
 19         page.should have_content 'Project has been created'
 20 
 21         #in adition, all these don't work and I don't know why...
 22 
 23         #response.should render_template :new
 24         #page.should have_content 'Myproject'
 25         #response.should have_selector('h1', :content => 'Myproject')
 26 
 27       end.should change(Project, :count).by(1)
 28     end
 29   end
 30 end 
```

第 18 行返回此错误：

> ActiveRecord::RecordNotFound: 找不到名称 = Myproject 的项目

我不明白为什么......在上面代码的评论中还有一些不起作用的测试，我也不知道为什么......谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:40:26.180

这可能意味着“创建”按钮操作以某种方式失败，因此没有创建记录。

尝试插入

```
save_and_open_page 
```

后

```
click_button 'Create' 
```

这将在您的浏览器中打开页面并向您显示页面的当前状态。

# javascript - HTML5 Canvas drawImage 仅在第二次刷新后绘制

> ID：10321788
> 
> 赞同：2
> 
> 时间：2012-04-25T18:39:29.863
> 
> 标签：javascript, html

好的，我有一个 HTML5 画布......它从`.png`图块 (32x32) 中绘制图像。有用。有点。它仅在第二次刷新后在画布上绘制。例如，如果你要加载它......你会看到一个红色的画布（背景`#canvas`是红色）然后如果你要刷新它......它将成功绘制图像......为什么那？

这是代码。（您只需要两张图片。在文件夹`t0.png`中）但我相信您可以立即发现我无法发现的错误：P`t1.png``line_tiles`

`game.js`

```
// HTML5 JS Tile Example
var canvas, context, board, imageObj, tiles;
var currentMap = 1;
var upMap = 0;
var rightMap = 0;
var leftMap = 0;
var downMap = 3;
var NUM_OF_TILES = 1; // starting from ZERO

// Set return 2D array of map
function loadMap(map) {
    if (map == 1) {
        return [
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]];
    }
}

// On load...
window.onload = function () {
    canvas = document.getElementById("canvas");
    context = canvas.getContext("2d");
    imageObj = new Image();
    tiles = [];
    board = loadMap(1);

    canvas.width = 512;
    canvas.height = 352;

    // 2\. SET UP THE MAP TILES
    for (x = 0; x <= NUM_OF_TILES; x++) {
        imageObj = new Image(); // new instance for each image
        imageObj.src = "line_tile/t" + x + ".png";
        tiles.push(imageObj);
    }
    var theX;
    var theY;
    // 3\. DRAW MAP BY ROWS AND COLS
    for (x = 0; x <= 10; x++) {
        for (y = 0; y <= 15; y++) {

            theX = x * 32;
            theY = y * 32;
            context.drawImage(tiles[board[x][y]], theY, theX, 32, 32);
        }
    }
}; 
```

`index.html`

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
    <title>HTML5</title>

    <script type="text/javascript" src="game.js"></script>
    <style type="text/css">
<!--
 #canvas {
       background:red;
       z-index:0;
       position:relative;       
    }

.container {
    width: 512px;
    position: relative;   
}
-->
</style>
</head>
<body>
<div class="container">
<canvas id="canvas"></canvas>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T18:59:34.433

您需要在图像（图块）上添加 onload 钩子，并且仅在加载所有图像时才绘制。

这是一个建议：

```
// HTML5 JS Tile Example
var canvas, context, board, imageObj, tiles;
var currentMap = 1;
var upMap = 0;
var rightMap = 0;
var leftMap = 0;
var downMap = 3;
var NUM_OF_TILES = 1; // starting from ZERO

// Set return 2D array of map
function loadMap(map) {
    if (map == 1) {
        return [
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]];
    }
}

// On load...
window.onload = function () {
    canvas = document.getElementById("canvas");
    context = canvas.getContext("2d");
    imageObj = new Image();
    tiles = [];
    board = loadMap(1);

    canvas.width = 512;
    canvas.height = 352;

    var draw = function() {
        var theX;
        var theY;
        // 3\. DRAW MAP BY ROWS AND COLS
        for (x = 0; x <= 10; x++) {
            for (y = 0; y <= 15; y++) {

                theX = x * 32;
                theY = y * 32;
                context.drawImage(tiles[board[x][y]], theY, theX, 32, 32);
            }
        }
    } 

    var loadedImagesCount = 0;

    // 2\. SET UP THE MAP TILES
    for (x = 0; x <= NUM_OF_TILES; x++) {
        var imageObj = new Image(); // new instance for each image
        imageObj.src = "line_tile/t" + x + ".png";
        imageObj.onload = function() {
            loadedImagesCount++;
            if (loadedImagesCount==NUM_OF_TILES) draw();
        };
        tiles.push(imageObj);
    }

}; 
```

并注意不要忘记 var 关键字（查看循环）。

# ruby - 动态文档，在另一个 YARD 的描述中使用返回方法？

> ID：10321789
> 
> 赞同：1
> 
> 时间：2012-04-25T18:39:31.673
> 
> 标签：ruby, documentation, yard

我正在记录一个项目，基本上我有类似以下内容：

```
def foo
  return bar(__method__)
end

def bar (method)
 return method.to_s + 'somestring'
end 
```

我正在设置多种方法，类似于我在哪里实现 foo 他们正在返回 bar 的返回。一个例子如下：

```
# The descriptions for foo0...
# @return [String] the method name concatenated with somestring
def foo0
  return bar(__method__)
end
# The descriptions for foo1...
# @return [String] the method name concatenated with somestring
def foo1
  return bar(__method__)
end

# The descriptions for bar...
# @return [String] the method name concatenated with somestring
def bar (method)
 return method.to_s + 'somestring'
end 
```

但是假设我将`bar`返回的内容更改为整数，那么我的文档不正确。我熟悉在 YARD 中记录 DSL，但是在描述另一种方法时，您如何指定`#bar@return.type`方法的返回类型。`bar`我所指的一个例子如下：

```
# The descriptions for foo0...
# @return [#bar@return.type] the method name concatenated with somestring
def foo0
  return bar(__method__)
end
# The descriptions for foo1...
# @return [#bar@return.type] the method name concatenated with somestring
def foo1
  return bar(__method__)
end

# The descriptions for bar...
# @return [String] the method name concatenated with somestring
def bar (method)
 return method.to_s + 'somestring'
end 
```

最终，我想要完成的是记录我的代码，而不必定义像返回类型这样的绝对值，这取决于另一种方法的定义。

更新：我发现您可以调用`# @return (see #bar)`并让它列出返回或与`foo`方法相同的`bar`方法，但我无法确定如何简单地获取正在返回的类型和/或重载返回的描述`bar`带有自定义描述`foo`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T04:48:43.770

正如您所发现的，您应该使用`@return (see #bar)`将`@return`标签从#bar 逐字复制到其他文档字符串。注意：它也会复制描述文本。没有办法只插入方法的类型。不过，在您的具体示例中，您似乎不需要它。

# ruby-on-rails - 打包程序 1.0.13 gem 文件

> ID：10321794
> 
> 赞同：0
> 
> 时间：2012-04-25T18:39:56.253
> 
> 标签：ruby-on-rails, bundler

我有一个生产环境，既不能访问 Web 服务器，也不能使用编译器，这两种情况都是按策略进行的。

我通过访问具有 Web 访问权限的开发服务器安装了 bundler 0.9.26，将 bundler 版本放在我的 Gemfile 中，执行捆绑包，将 bundler-0.9.26.gem 复制到生产服务器，然后运行 ​​gem install bundler-0.9 .26.宝石。

但是，现在我需要安装 bundler 1.0.13，当我执行这些步骤时，bundle package 不会创建 bundler gem 文件。

那么，如何在我的生产服务器上安装 bundler 1.0.13？

顺便说一句，我试图克服未初始化的常量 Gem::SilentUI (NameError) 错误。因此，这样做的建议也会有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T17:22:16.723

有人给了我答案。Gem 获取捆绑器 .gem 文件。

# .htaccess - 如何将子域的所有页面重定向到附加页面？

> ID：10321795
> 
> 赞同：0
> 
> 时间：2012-04-25T18:40:02.343
> 
> 标签：.htaccess, redirect, dns, rewrite, add-on

基本上，谷歌列出了我的附加域的所有子域页面。

谷歌列出了 http://www。mymainwebsite.com（这很好）

但是也

http:// 万维网。子域。mymainwebsite.com（不好）

所以............在htaccess中我添加了这个：

RewriteCond %{HTTP_HOST} ^subdomain.mymainwebsite.com$ [OR]

RewriteCond %{HTTP_HOST} ^www.subdomain.mymainwebsite.com$

RewriteRule ^/?$ "http\://www.mymainwebsite.com/" [R=301,L]

这适用于主子域，但我可以“仍然访问”所有子域页面，例如我仍然可以访问：http://www。subdomain.mymainwebsite.com/about

谷歌已经列出了“数百个”上述子域“页面”

所以我的问题是......我可以在我的 htaccess 中添加任何“代码”，它会重定向“所有”不幸在谷歌中列出的子域“页面”吗？

我想要[http://www.subdomain.mymainwebsite.com/about（faq/history/contact/links](http://www.subdomain.mymainwebsite.com/about)，还有数百页）

要去

[http://www.mymainwebsite.com/about（faq/history/contact/links](http://www.mymainwebsite.com/about)，还有数百页）

多谢你们！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T18:47:58.040

您需要告诉重写引擎将 URL 的其余部分添加到重写中。

它应该看起来像这样：

RewriteRule ^/(.*)$ "http\://www.mymainwebsite.com/$1" [R=301,L]

这会将您子域上的所有路径重定向到您的主域。

$1 是对 (.*) 的反向引用，它匹配斜杠后的所有字符。使用 $1 在重定向中包含这些字符。

# javascript - 从 JSON 数据创建 HTML 项目符号列表时出现问题

> ID：10321797
> 
> 赞同：0
> 
> 时间：2012-04-25T18:40:12.390
> 
> 标签：javascript, html, json, recursion

我有一些 JSON 想要转入项目符号列表。在每个级别都有一个名称字段和一个子字段（除了最低级别）。我曾尝试使用递归来做到这一点，但我遇到了问题。除了最后一个级别，只显示第一个孩子。我有一种感觉，我的一些递归调用可能无法正确返回。这是我到目前为止的代码：

```
function load_menu(){
    json_text=ajax_get("example.json");
    json_tree=JSON.parse(json_text);
    write_menu(json_tree.children,document.getElementById("level1"));
}
function write_menu(json,element){
    for(i=0;i<json.length;i++){
        var listitem=document.createElement("li");
        element.appendChild(listitem);
        var listitemtext=document.createElement("span");
        listitem.appendChild(listitemtext);
        listitemtext.innerText=json[i].name;
        if(json[i].children){
            listitemtext.setAttribute("onclick","toggle(this);");
            var sublist=document.createElement("ul");
            listitem.appendChild(sublist);
            write_menu(json[i].children,sublist);
        };
    };
} 
```

我最终得到一棵看起来像这样的树：

```
Level 1,1
    Level 2,1
        Level 3,1
        Level 3,2 
```

它应该如下所示：

```
Level 1,1
    Level 2,1
        Level 3,1
        Level 3,2
    Level 2,2
Level 1,2
    Level 2,3 
```

我已经检查了我的 JSON，它似乎没问题，所以我想某处的递归一定有问题。有谁可以帮我离开这里吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T19:48:09.080

如果您编写`for (i...`JS 解释器，如果一个变量不存在，它将创建一个新变量`i`，或者如果它确实存在，则重用一个现有变量。这就是这里的问题，因为在每个递归级别都需要新的循环变量。

所以解决方案是通过编写来强制在每个级别上创建一个变量`for (var i...`。

# ios - iOS 钥匙串——如何确保设备/模拟器上的持久性？

> ID：10321798
> 
> 赞同：3
> 
> 时间：2012-04-25T18:40:33.700
> 
> 标签：ios, persistence, keychain

环境：iOS 4.0+

**场景**：使用 Apple 的 GenericKeychain 示例中的 KeychainItemWrapper；iOS 模拟器。

**问题**：我可以在调试器中存储/检索钥匙串数据。但是一旦我退出调试器，一旦我返回，我就会丢失钥匙串数据。也就是说，我在应用程序重新启动时无法访问我的钥匙串数据。

Apple 的 GenericKeychain 示例不会发生这种情况。我通过 SQLiteManager 查看了钥匙串的数据库，并注意到 GenericKeychain 示例有一个证书。

**问题：**是否需要证书***才能***使钥匙串数据多会话*持久化*？

# java - 活动结束前调用的指令

> ID：10321799
> 
> 赞同：0
> 
> 时间：2012-04-25T18:40:35.343
> 
> 标签：java, android, device-admin

我试图了解用户是否启用了管理员并稍后更新复选框（在 onResume 中）。

问题是启动了允许用户启用管理员的活动，并且它在不等待用户决定的情况下启动了以下代码。怎么可能绕过呢？

```
private void doAttivaRimuoviAdmin() {
    if (isAdminAttivo()) {
        mDPM.removeActiveAdmin(mDeviceAdminSample);
    } else {
        Intent localIntent = new Intent("android.app.action.ADD_DEVICE_ADMIN");
        localIntent.putExtra("android.app.extra.DEVICE_ADMIN", mDeviceAdminSample);
        localIntent.putExtra("android.app.extra.ADD_EXPLANATION",
                getString(R.string.spiegazione_amministratore));
        startActivityForResult(localIntent, 1);

        // se non è stato dato il permesso, non attiva la checkbox
        Editor e = mPrefs.edit();

        if (isAdminAttivo()) {
            e.putBoolean("spegnischermoabilitato", true);
        } else {
            e.putBoolean("spegnischermoabilitato", false);
        }
        e.commit();
        Log.i(getString(R.string.app_name), ""+ mPrefs.getBoolean("spegnischermoabilitato", false));

    }

} 
```

简而言之，共享偏好“spegnischermoabilitato”始终包含 FALSE。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T19:32:08.933

从[startActivityForResult()](http://developer.android.com/reference/android/app/Activity.html#startActivityForResult%28android.content.Intent,%20int%29)的文档中：

> 启动一项您希望在完成后获得结果的活动。当此活动退出时，您的 onActivityResult() 方法将使用给定的 requestCode 调用。使用否定的 requestCode 与调用 startActivity(Intent) 相同（该活动不作为子活动启动）。

换句话说，您将需要覆盖[onActivityResult()](http://developer.android.com/reference/android/app/Activity.html#onActivityResult%28int,%20int,%20android.content.Intent%29)。在此方法中，您必须检查该方法是否使用您在 startActivityForResult() 中设置的 requestCode 调用，并且它是否包含预期的 resultCode。如果它确实写下您的偏好。

# mysql - mysql：未知变量，不能运行任何mysql应用，好像和my.cnf没有关系

> ID：10321800
> 
> 赞同：8
> 
> 时间：2012-04-25T18:40:37.380
> 
> 标签：mysql, linux, fedora

我的问题是，当尝试在 Fedora 上运行 MYSQL 时，我遇到了以下错误：

mysql：未知变量'max_connections = 40'

它对任何其他命令执行完全相同的操作，例如 mysqldump、mysqlcheck 等

my.cnf 文件读取以下内容，尽管我已将其重命名并且错误仍然存​​在。几乎看起来它是一个系统变量，如果不运行 mysql，我就无法编辑，因此捕获 22！

```
[mysqld]
datadir=/var/lib/mysql
socket=/var/lib/mysql/mysql.sock
user=mysql
# Disabling symbolic-links is recommended to prevent assorted security risks
symbolic-links=0

[mysqld_safe]
log-error=/var/log/mysqld.log
pid-file=/var/run/mysqld/mysqld.pid 
```

我当然还检查了系统是否有任何其他 my.cnf 文件。

我真的迷路了，开始扯头发。任何帮助将不胜感激！:)

谢谢

马特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T18:58:35.620

假设您的良好配置文件是 /etc/my.cnf（可能不是），编辑您的 mysql 初始化文件并将 --init-file /etc/my.cnf 添加到 mysqld 命令以确保它确实正在读取从您认为它正在读取的 init 文件中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-22T11:01:21.767

错误：mysql：未知变量'max_connections = **'

发生这种情况的原因之一是 max_connections 参数在 [mysql] 部分下更新，我们在 [mysqld] 部分下添加该参数后能够登录。

# python - 使用结构来操作数据库连接

> ID：10321811
> 
> 赞同：1
> 
> 时间：2012-04-25T18:41:12.413
> 
> 标签：python, deployment, fabric

我刚刚开始使用 Fabric 来更好地控制测试和部署环境的特定设置，并且我正在尝试了解交换配置的最佳方法。

假设我的应用程序中有一个模块，它默认定义了一个简单的数据库连接和一些用于身份验证的常量：

```
host = 'db.host.com'
user = 'someuser'
passw = 'somepass'
db = 'somedb'

class DB():
  def __init__(self,host=host,user=user,passw=passw,db=db,cursor='DictCursor'):
    #make a database connection here and all that jazz 
```

在我找到fabric之前，我会使用库中的`getfqdn()`函数`socket`来检查系统被推送到的主机的域名，然后对身份验证凭据进行条件化。

```
if getfqdn() == 'test.somedomain.com':
  host = 'db.host.com'
  user = 'someuser'
  passw = 'somepass'
  db = 'somedb'
elif getfqdn() == 'test.someotherdomain.com':
  host = 'db.other.com'
  user = 'otherguy'
  passw = 'otherpass'
  db = 'somedb' 
```

出于显而易见的原因，这真的不是那么好。我想知道的是在 Fabric 中调整此类内容的最聪明的方法是什么，以便当项目被推送到某个测试/部署服务器时，这些值会在推送后更改。

仅通过查看文档，我就可以想到一些方法。我是否应该有一个文件只定义 Fabric 可以根据部署使用 shell 命令输出的常量，然后定义数据库处理程序的文件可以导入它们？像这样在 fabfile中运行`open`和运行是否有意义？`write`我假设我还必须处理`.gitignore`这些类型的文件，这样它们就不会被提交到 repo 中，而只是依靠 Fabric 来部署它们。

`getfqdn`我计划采用最适合我当前使用或手动调整的所有配置设置的方法。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T00:33:21.300

您可以在 env.host 中完成所有这些操作，然后使用[contrib 模板函数之类的](http://docs.fabfile.org/en/1.4.1/api/contrib/files.html#fabric.contrib.files.upload_template)东西来呈现 conf 文件并将其推送。但是模板在这些情况下是最好的（参见：puppet 和其他配置管理器）

# c++ - 在 SFML 和碰撞检测中使用切片

> ID：10321812
> 
> 赞同：1
> 
> 时间：2012-04-25T18:41:17.240
> 
> 标签：c++, collision-detection, sfml, tile

我决定寻找一个很好的tileset来使用并找到一些，但问题是我如何从图像文件中实际加载tile，因为一个文件中似乎有多个tile？

另外，如何实现非方形瓷砖的碰撞检测？

示例：[图块集](http://fc09.deviantart.net/fs44/f/2009/159/1/6/Pokemon_Platinum_Tiles_WIP_by_klnothincomin.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T01:58:17.547

图像（sfml1.6）或纹理（sfml2.0）通常使用`sf::Sprite`. 通常的做法是让所有精灵共享相同的tileset纹理/图像，然后使用它`sf::Sprite::SetSubRect(const IntRect &SubRect)`来设置应该绘制的纹理区域。

sfml API 中的 Sprite 类可能是一个不错的起点

*   [http://www.sfml-dev.org/documentation/2.0/classsf_1_1Sprite.php](http://www.sfml-dev.org/documentation/2.0/classsf_1_1Sprite.php)
*   [http://www.sfml-dev.org/documentation/1.6/classsf_1_1Sprite.php](http://www.sfml-dev.org/documentation/1.6/classsf_1_1Sprite.php)

# java - Java Runtime.exec() 与 Linux 上的 ssh 问题

> ID：10321813
> 
> 赞同：0
> 
> 时间：2012-04-25T18:41:17.340
> 
> 标签：java, linux, ssh, runtime.exec

我正在尝试使用 Runtime.exec() 启动一个新进程，但我的问题在于使用 ssh 远程进入，然后在那里运行一个 java 程序。代码：

```
test = "ssh -t username@host java packageName.ClassName portNumber (Other command line args for this class)"
Process proc = Runtime.getRuntime().exec(new String[] {"/bin/bash", "-c", test}); 
```

这不会失败或捕获，但我需要能够看到新运行进程的标准输出，但我没有。

注意：如果我从命令行运行`ssh -t username@host java packageName.ClassName portNumber (Other command line args for this class)`它工作正常。我通过使用 ssh 密钥将主机设置为不需要密码。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T18:51:31.277

您需要使用[Process.getInputStream](http://docs.oracle.com/javase/7/docs/api/java/lang/Process.html#getInputStream%28%29)从正在创建的子流程中获取输出。

有关. [_](http://www.javaworld.com/javaworld/jw-12-2000/jw-1229-traps.html) _`Runtime.exec`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T18:47:35.833

我认为您可以要求输入与流程的标准输出相对应的输入流，然后将其打印在标准输出上。如果您需要在执行后查看它，只需`waitFor()`在进程上调用方法，以便在您开始打印之前完成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T18:48:19.217

用于[`getInputStream()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Process.html#getInputStream%28%29)访问返回进程的标准输出。您还可以使用 . 提供的设施[`ProcessBuilder.Redirect`](http://docs.oracle.com/javase/7/docs/api/java/lang/ProcessBuilder.Redirect.html)。

# iphone - XCode 将图像发送到服务器

> ID：10321819
> 
> 赞同：0
> 
> 时间：2012-04-25T18:41:33.900
> 
> 标签：iphone, objective-c, ios, image

我目前正在开发一个 iOS 应用程序，您可以在其中拍摄图像并将其上传到服务器。

我在模拟器中可以正常工作，但是在设备上进行测试时，我收到了内存警告，然后它崩溃了。

我的代码中还有很多内容，我将尝试显示与我的问题相关的位：

我正在尝试发送使用设备上的照片选择器拍摄的两张图像，这些图像被保存到手机并传递到支付屏幕：

```
 - (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info 
    {
        UIImage *image=[info objectForKey:@"UIImagePickerControllerOriginalImage"];
        NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
        NSString *documentsDirectory = [paths objectAtIndex:0];
        NSString* path = [documentsDirectory stringByAppendingPathComponent:[NSString stringWithString: "name.jpg"] ];
        NSData* data = UIImageJPEGRepresentation(image,1.0);
        [data writeToFile:path atomically:YES];
    } 
```

在付款屏幕上，我有此代码将其发送到服务器，并且 php 脚本发回 paypal 服务：

```
 NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    NSString* path = [documentsDirectory stringByAppendingPathComponent: [NSString stringWithString: @"name.jpg"] ];

    NSData *imageData = UIImageJPEGRepresentation([UIImage imageWithContentsOfFile:path]);

    NSString *urlString = @"http://server.com/payment.php?";
    NSMutableURLRequest *request = [[[NSMutableURLRequest alloc] init] autorelease];
    [request setURL:[NSURL URLWithString:urlString]];
    [request setHTTPMethod:@"POST"];

    NSString *boundary = [NSString stringWithString:@"---------------------------14737809831466499882746641449"];
    NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; boundary=%@", boundary];
    [request addValue:contentType forHTTPHeaderField:@"Content-Type"];

    NSMutableData *body = [NSMutableData data];

    [body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[[NSString stringWithString:@"Content-Disposition: form-data; name=\"backfile\"; filename=\"back.jpg\"\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[[NSString stringWithString:@"Content-Type: image/jpeg\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[NSData dataWithData:imageData]];
    [body appendData:[[NSString stringWithFormat:@"\r\n--%@--\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];

    [webView loadRequest:request];

    [self.view addSubview:webView];
    [request setHTTPBody:body]; 
```

对不起，如果这不是太清楚，请告诉我。它将图像发送到服务器，但应用程序将在此过程中崩溃。我已经尝试调整图像的大小，但是我需要它们以尽可能最好的质量。如果我使用以下方式发送缩小的图像：

```
 UIGraphicsBeginImageContext( frontSize );
    [frontimg drawInRect:CGRectMake(0,0,242,444)];
    UIImage* realfrontImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    NSData *frontImageData = UIImageJPEGRepresentation(image, 1.0); 
```

它可以工作，但是当我需要大约 300 时，图像质量为 72PPI。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T18:55:09.803

使用 webview 来发帖是一种不寻常的用法。webview（或其他必要的东西）可能会因内存警告而被释放。你可以用这个替换它，看看它是否有帮助？

```
NSOperationQueue *queue = [[NSOperationQueue alloc] init];

[NSURLConnection request queue:queue completionHandler:^(NSURLResponse *response, NSData *data, NSError *error)
{
    NSHTTPURLResponse* httpResponse = (NSHTTPURLResponse*)response;
    NSLog(@"got response %d, data = %@, error = %@", [httpResponse statusCode], data, error);
}]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T19:13:49.893

将 NSLog 调试消息添加到您的所有 UIViewControllers didReceiveMemoryWarning 方法和 viewWillUnload 方法，以查看您的 UIViewControllers 是否正在释放您所依赖的对象。

# xml - 如何将远程 jms 客户端连接到 tomcat 中的嵌入式 activemq 代理？

> ID：10321832
> 
> 赞同：3
> 
> 时间：2012-04-25T18:42:13.753
> 
> 标签：xml, activemq

我在 tomcat 中有一个嵌入式代理，我的 webapp 客户端使用 vm://localhost 可以正常连接。我希望另一个 jvm 中的一些远程客户端能够连接到嵌入式代理。如何设置嵌入式代理以侦听端口#？这适用于嵌入式客户端：

server.xml 片段：

```
<Resource auth="Container" 
name="jms/ConnectionFactory" 
type="org.apache.activemq.ActiveMQConnectionFactory" 
description="JMS Connection Factory" 
factory="org.apache.activemq.jndi.JNDIReferenceFactory" 
brokerURL="vm://localhost" 
brokerName="MyActiveMQBroker" 
useEmbeddedBroker="true"/> 
```

这不适用于远程客户端，但我的嵌入式客户端仍然使用 vm://localhost 进行连接：

```
<Resource auth="Container" 
name="jms/ConnectionFactory" 
type="org.apache.activemq.ActiveMQConnectionFactory" 
description="JMS Connection Factory" 
factory="org.apache.activemq.jndi.JNDIReferenceFactory" 
brokerURL="vm:(broker:(tcp://localhost:61616))" 
brokerName="MyActiveMQBroker" 
useEmbeddedBroker="true"/> 
```

我的远程客户端给出了这个错误：

无法连接到代理 URL：tcp://localhost:61616。原因：java.net.ConnectException：连接被拒绝

我也一直在尝试这个：

```
brokerURL="vm://localbroker?brokerConfig=xbean:file:C:/temp/activemq.xml" 
```

并在 activemq.xml 中设置：

```
<transportConnectors>
<transportConnector name="openwire" uri="tcp://0.0.0.0:61616"/>
</transportConnectors>

<networkConnectors>
<networkConnector uri="static:(tcp://0.0.0.0:61616)"/>
</networkConnectors> 
```

我不相信 xml 文件被读取，因为我的症状在编辑它时永远不会改变。在 tomcat 启动时，当第一个客户端 webapp 部署时，代理启动并报告：

连接器 vm://localhost 已启动

我从来没有看到另一个连接器启动，比如 tcp://0.0.0.0:61616。这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T09:01:39.530

`vm://localhost`不会为远程代理打开 tcp 端口进行连接。vm 协议可以在 JVM 中使用。

在您的本地 tomcat 上进行配置（例如，考虑主机名为“tomcathostone”的本地服务器）

```
<Resource auth="Container" 
name="jms/ConnectionFactory" 
type="org.apache.activemq.ActiveMQConnectionFactory" 
description="JMS Connection Factory" 
factory="org.apache.activemq.jndi.JNDIReferenceFactory" 
brokerURL="broker:(tcp://0.0.0.0:61616)" 
brokerName="MyActiveMQBroker" 
useEmbeddedBroker="true"/> 
```

远程 tomcat 上的配置（例如，考虑主机名为“tomcathosttwo”的远程服务器）

```
<Resource auth="Container" 
name="jms/ConnectionFactory" 
type="org.apache.activemq.ActiveMQConnectionFactory" 
description="JMS Connection Factory" 
factory="org.apache.activemq.jndi.JNDIReferenceFactory" 
brokerURL="broker:(tcp://tomcathosttwo:61616,network:static:tcp://tomcathostone:61616)" 
brokerName="MyActiveMQBroker" 
useEmbeddedBroker="true"/> 
```

# wcf - WCF：从客户端回调处理程序调用自托管服务

> ID：10321834
> 
> 赞同：0
> 
> 时间：2012-04-25T18:42:21.773
> 
> 标签：wcf, concurrency

问题：在 WCF 客户端中收到死锁异常消息。

设想：

1.  服务调用客户端回调（此调用完全独立，由服务器上的某些条件发起）。

2.  在客户端回调函数内部，客户端调用服务中的一个函数，此时会引发死锁异常：

*此操作会死锁，因为在当前消息完成处理之前无法接收到回复。如果要允许无序消息处理，请在 CallbackBehaviorAttribute 上指定 Reentrant 或 Multiple 的 ConcurrencyMode。*

我试图尽可能地简化代码。我确实读过这篇文章，但我仍然找不到问题所在：http: [//msdn.microsoft.com/en-us/library/cc294424.aspx](http://msdn.microsoft.com/en-us/library/cc294424.aspx) 我很感激任何建议......

## 服务：

```
 [ServiceContract(Namespace = "http://abc.com/Core", SessionMode = SessionMode.Required, CallbackContract = typeof(ISvcCallback))] 
public interface ISvc
{
    // One way only - does not wait until operation completes and returns
    // Can initiate session
    [OperationContract(IsOneWay = true)]
    void Initialize(string appId);

    [OperationContract(IsInitiating = false)]
    Account GetCurrentAccount(); 
```

}

```
public interface ISvcCallback
{
    /// <summary>
    /// Report status of the account
    /// </summary>
    /// <param name="acct"></param>
    [OperationContract(IsOneWay=true)]
    void AccountStatus(Account acct); 
```

}

```
Service Implementation
[ServiceBehavior(InstanceContextMode = InstanceContextMode.Single, ConcurrencyMode = ConcurrencyMode.Reentrant, UseSynchronizationContext = false)]
public class Svc : ISvc
{
    public Account GetCurrentAccount()
    {
            SipAccount sipAcct = null;
            try
            {
                Account acct = m_MyBusinessObject.GetCurrentAccount();
            }
            catch (Exception ex)
            {

            }

            return Acct;
        }
    } 
```

}

## 客户：

```
public class CallbackHandler : WcfSipItfService.IWinSipItfCallback
{
    public void AccountStatus(Account Acct)
    {          
            try
            {
                // display accout status in UI by delegate-wrapped event
                // delegate and event declarations are somewhere else
                // and work fine...
                if (DisplayAccountStatusEvent != null)
                    DisplayAccountStatusEvent(Acct);

            }
            catch (Exception ex)
            {
                ....
            }

    }

    private void OnDisplayAccountStatusEvent(Account acct)
    {
                // call service function results in deadlock
                Account acct = GetCurrentAccount();

    } 
```

}

该服务是双工的 - 使用 WSDualHttpBinding。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T19:09:36.390

死锁似乎是由于您在处理上一个调用的回调时进行了新的出站调用。

错误消息指出，您可以通过“在 CallbackBehaviorAttribute 上指定 Reentrant 或 Multiple 的 ConcurrencyMode”来解决它。

**编辑**

我错过了屏幕外的代码。几件事要检查：

*   为什么需要单实例模式？
*   更改并发模式后是否更新了服务引用？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T08:08:38.070

你的客户是什么？它是一个 UI 客户端吗？如果是这样，您需要将 callbackBehavior UseSynchronizationContext=false 添加到实现回调合约的客户端。

# ruby-on-rails - Rails ActiveRecord 中的反向关联

> ID：10321838
> 
> 赞同：1
> 
> 时间：2012-04-25T18:42:36.617
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, activerecord

我有两个 ActiveRecord 模型。`Idea`和`User`。两者之间存在一种关联，其工作方式类似于`User.idea`.

User 模型当前保存`lat`并`lng`来自用户的坐标。

从想法控制器，我想查询与某个位置匹配的所有想法。我不是如何在 Rails 中执行此反向连接查询。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:52:18.483

我猜你想要这个：

```
Idea.joins(:user).where(user: {lat: some_lat, lng: some_lng}).all 
```

`some_lat`/`some_lng`可以是一个范围。Rails 将处理魔法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T18:52:43.247

第一：你如何找到想要的位置？可能你可以使用 Geocoder 之类的东西（有一个[RailsCast 关于它](http://railscasts.com/episodes/273-geocoder)）。

现在我在不久的将来会遇到类似的问题，但目前我认为我可能会分两步完成（双重查询）：

```
@users = User.near(params[:location]).pluck(:id)
@ideas = Ideas.where(:user_id => @users) 
```

通过这种方式，您可以在想要的位置附近获得想法（我在这里使用了 Geocoder 方法，但您可以以不同的方式获得用户）。

注意：我假设一个用户有很多想法并且一个想法属于一个用户

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T18:49:22.803

我想您必须搜索与您的位置匹配的所有用户，并在加载时包含这些想法。

```
# first about the near by:
def close_to( position )
  (position-0.2)..(position+0.2)
end

@users = User.where( :lat => close_to(some_lat), :lng => close_to(some_lng) ).includes( :ideas )

# if you need all the ideas:
@ideas = []
@users.each do |user|
  @ideas += user.ideas
end 
```

否则，您在 users 数组中拥有用户排序的所有想法。还是我错过了你的问题？

# .net - 有没有一种简单的方法可以使用 sos 来查看字典中的键值对？

> ID：10321840
> 
> 赞同：4
> 
> 时间：2012-04-25T18:42:42.607
> 
> 标签：.net, dictionary, windbg, sos

我通过 WinDBG 使用 SOS.dll 查看故障转储。给定 Dictionary 对象的地址，是否有一种简单的方法可以转储其内容，例如..

```
Key1 -> Value1
Key2 -> Value2
...
KeyN -> ValueN 
```

我看到没有 !DumpDictionary 命令:(

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T20:46:32.343

不，但 PSSCOR2/4 提供了一些收集支持。尤其是 !dc。SOSEX 支持：!mdt -e:2。此命令表示转储指定的对象并将其扩展 2 级。

# entity-framework-4 - 实体在两个数据库中拆分

> ID：10321841
> 
> 赞同：0
> 
> 时间：2012-04-25T18:42:45.360
> 
> 标签：entity-framework-4

我正在研究一个已经由我之前的几个开发人员启动的项目。特别困扰我的一件事是他们在两个数据库中拆分了单个实体。

实体称为跟踪器。

第一个数据库称为 ConfigBase，它有一个名为 Trackers 的表，该表具有 TrackerId 及其属性。

第二个数据库称为 StoreBase，它还有一个名为 Trackers 的表，其元素与第一个数据库中的 TrackerId 匹配。

此外，更复杂的是，当您访问 ConfigBase 中的特定跟踪器时，您将获得 SQL 服务器名称和凭据，以便您在 StoreBase 中访问它。

现在，如果您使用普通的旧 ADO.NET，这一切都不会太复杂。但由于我的任务是将整个解决方案升级到最新的 EF 4.3.1，我在保持实体的一致性方面遇到了麻烦。与 Tracker 实体相关的一半在 ConfigBase 中，另一半在 StoreBase 中，通常我必须同时获得两者才能获得一些结果。

是否有任何不涉及数据库级别虚拟合并的解决方案。我正在寻找可以通过 Code First 建模完成的解决方案。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T20:30:05.407

不，没有提供开箱即用的解决方案，因为 EF 本身甚至无法在每个上下文中使用多个数据库。因此，您将合并您的数据库，或者您将分别访问每个数据库（每个数据库具有单独的 Tracker 实体）并以某种方式在您的应用程序中合并数据。

# xcode - Xcode 在 DVTNSArrayAdditions 中因断言错误而崩溃

> ID：10321843
> 
> 赞同：2
> 
> 时间：2012-04-25T18:42:48.893
> 
> 标签：xcode

无论我打开什么项目，无论是 iOS 还是 Mac，都会发生这种情况。我已经查看了 SO 和其他地方列出的其他原因，并消除了与存储库、错误证书`project.xcworkspace`和`com.apple.dt.Xcode.*`. 这仅在我打开项目时发生。我可以毫无问题地查看组织者。

任何帮助，将不胜感激。

这是错误：

```
Process:         Xcode [3904]
Path:            /Applications/Xcode.app/Contents/MacOS/Xcode
Identifier:      com.apple.dt.Xcode
Version:         4.3.2 (1177)
Build Info:      IDEApplication-1177000000000000~6
App Item ID:     497799835
App External ID: 7171108
Code Type:       X86-64 (Native)
Parent Process:  launchd [124]

Date/Time:       2012-04-25 14:25:53.522 -0400
OS Version:      Mac OS X 10.7.3 (11D50b)
Report Version:  9
Sleep/Wake UUID: 918AC06B-8025-41D9-A37F-809262E52D1C

Interval Since Last Report:          135670 sec
Crashes Since Last Report:           10
Per-App Interval Since Last Report:  33821 sec
Per-App Crashes Since Last Report:   10
Anonymous UUID:                      78350ED9-1E4E-47B3-BFA2-60CDC279B7DB

Crashed Thread:  24

Exception Type:  EXC_CRASH (SIGABRT)
Exception Codes: 0x0000000000000000, 0x0000000000000000

Application Specific Information:
ProductBuildVersion: 4E2002
UNCAUGHT EXCEPTION (NSInternalInconsistencyException): ASSERTION FAILURE in /SourceCache/DVTFoundation/DVTFoundation-1193/Framework/Classes/FoundationClassCategories/DVTNSArrayAdditions.m:207
Details:  Assertion failed: object != ((void*)0)
Object:   <__NSArrayM: 0x4028cd680>
Method:   -dvt_addObjectIfAbsent:
Thread:   <NSThread: 0x4023dfe00>{name = (null), num = 16}
Backtrace:
  0  0x0000000107f5cc8f -[PBXTargetBuildContext(DependencyGraphEvents) handleFailureInMethod:object:fileName:lineNumber:messageFormat:arguments:] (in DevToolsCore)
  1  0x0000000104f9b635 _DVTAssertionFailureHandler (in DVTFoundation)
  2  0x0000000104f30e78 -[NSMutableArray(DVTFoundationClassAdditions) dvt_addObjectIfAbsent:] (in DVTFoundation)
  3  0x0000000104f7136f -[DVTSDK commandLineToolSearchPath] (in DVTFoundation)
  4  0x0000000107f9e9e4 -[XCCommandLineToolSpecification findExecutable:inTargetBuildContext:] (in DevToolsCore)
  5  0x0000000107f6e876 -[PBXCompilerSpecificationGcc executablePathInTargetBuildContext:forLanguageDialect:] (in DevToolsCore)
  6  0x0000000107f6e92e -[PBXCompilerSpecificationGcc discoveredCompilerDriverInfoInBuildContext:forLanguageDialect:] (in DevToolsCore)
  7  0x0000000107f732ab -[PBXCompilerSpecificationGcc2_95_2 compileSourceCodeFileAtPath:ofType:toOutputDirectory:inTargetBuildContext:] (in DevToolsCore)
  8  0x0000000108049a27 -[XCCompilerSpecificationClang compileSourceCodeFileAtPath:ofType:toOutputDirectory:inTargetBuildContext:] (in DevToolsCore)
  9  0x0000000107f71a33 -[PBXCompilerSpecificationGcc computeDependenciesForInputNodes:ofType:variant:architecture:outputDirectory:inTargetBuildContext:] (in DevToolsCore)
 10  0x0000000107fa525b -[XCCompilerSpecification computeDependenciesForFilePath:ofType:outputDirectory:inTargetBuildContext:] (in DevToolsCore)
 11  0x000000010803f84e -[XCBuildRuleDGSnapshot(DependencyGraphCreation) computeDependenciesForFilePath:ofType:forBuildFileReference:withOutputDirectory:additionalProperties:inTargetBuildContext:] (in DevToolsCore)
 12  0x0000000108038647 -[XCSourcesBuildPhaseDGSnapshot(DependencyGraphCreation) _computeDependenciesForFilePath:ofType:forBuildFileReference:usingBuildRule:inTargetBuildContext:processedPaths:] (in DevToolsCore)
 13  0x0000000108038d25 -[XCSourcesBuildPhaseDGSnapshot(DependencyGraphCreation) computeDependenciesForFilePath:ofType:forBuildFileReference:usingBuildRule:inTargetBuildContext:] (in DevToolsCore)
 14  0x00000001080392c3 -[XCSourcesBuildPhaseDGSnapshot(DependencyGraphCreation) computeDependenciesForBuildFileReference:inTargetBuildContext:] (in DevToolsCore)
 15  0x000000010802dc0c -[XCBuildPhaseDGSnapshot(DependencyGraphCreation) computeDependenciesForAllBuildFileReferencesInTargetBuildContext:] (in DevToolsCore)
 16  0x000000010803aab0 -[XCSourcesBuildPhaseDGSnapshot(DependencyGraphCreation) computeDependenciesForAllBuildFileReferencesInTargetBuildContext:] (in DevToolsCore)
 17  0x000000010803b450 -[XCSourcesBuildPhaseDGSnapshot(DependencyGraphCreation) computeDependenciesInTargetBuildContext:] (in DevToolsCore)
 18  0x0000000107fa811e -[XCProductTypeSpecification computeDependenciesInTargetBuildContext:] (in DevToolsCore)
 19  0x00000001080294d3 -[XCNativeTargetDGSnapshot(DependencyGraphCreation) computeDependenciesInTargetBuildContext:] (in DevToolsCore)
 20  0x0000000107f4bf81 -[PBXTargetBuildContext createDependencyGraphWithTargetDGSnapshot:] (in DevToolsCore)
 21  0x0000000107f5dc15 -[PBXTargetBuildContext(DependencyGraphEvents) dg_setTargetSnapshot:] (in DevToolsCore)
 22  0x00007fff899daf4c __invoking___ (in CoreFoundation)
 23  0x00007fff899dade4 -[NSInvocation invoke] (in CoreFoundation)
 24  0x0000000107f5d010 -[PBXTargetBuildContext(DependencyGraphEvents) processDependencyGraphEvents] (in DevToolsCore)
 25  0x00007fff899daf4c __invoking___ (in CoreFoundation)
 26  0x00007fff899dade4 -[NSInvocation invoke] (in CoreFoundation)
 27  0x0000000107fa07e1 -[XCInvocationQueue _processNextInvocationInThreadSlotNumber:] (in DevToolsCore)
 28  0x0000000107fa0c48 -[XCInvocationQueue _processInvocationsInThreadSlotNumber:] (in DevToolsCore)
 29  0x00007fff88db774e -[NSThread main] (in Foundation)
 30  0x00007fff88db76c6 __NSThread__main__ (in Foundation)
 31  0x00007fff8edc08bf _pthread_start (in libsystem_c.dylib)
 32  0x00007fff8edc3b75 thread_start (in libsystem_c.dylib)

UserInfo: (null)
Hints: None
Backtrace:
  0  0x00007fff899e8faa __exceptionPreprocess (in CoreFoundation)
  1  0x00007fff8f537d5e objc_exception_throw (in libobjc.A.dylib)
  2  0x00007fff89a732a9 -[NSException raise] (in CoreFoundation)
  3  0x0000000104f9b635 _DVTAssertionFailureHandler (in DVTFoundation)
  4  0x0000000104f30e78 -[NSMutableArray(DVTFoundationClassAdditions) dvt_addObjectIfAbsent:] (in DVTFoundation)
  5  0x0000000104f7136f -[DVTSDK commandLineToolSearchPath] (in DVTFoundation)
  6  0x0000000107f9e9e4 -[XCCommandLineToolSpecification findExecutable:inTargetBuildContext:] (in DevToolsCore)
  7  0x0000000107f6e876 -[PBXCompilerSpecificationGcc executablePathInTargetBuildContext:forLanguageDialect:] (in DevToolsCore)
  8  0x0000000107f6e92e -[PBXCompilerSpecificationGcc discoveredCompilerDriverInfoInBuildContext:forLanguageDialect:] (in DevToolsCore)
  9  0x0000000107f732ab -[PBXCompilerSpecificationGcc2_95_2 compileSourceCodeFileAtPath:ofType:toOutputDirectory:inTargetBuildContext:] (in DevToolsCore)
 10  0x0000000108049a27 -[XCCompilerSpecificationClang compileSourceCodeFileAtPath:ofType:toOutputDirectory:inTargetBuildContext:] (in DevToolsCore)
 11  0x0000000107f71a33 -[PBXCompilerSpecificationGcc computeDependenciesForInputNodes:ofType:variant:architecture:outputDirectory:inTargetBuildContext:] (in DevToolsCore)
 12  0x0000000107fa525b -[XCCompilerSpecification computeDependenciesForFilePath:ofType:outputDirectory:inTargetBuildContext:] (in DevToolsCore)
 13  0x000000010803f84e -[XCBuildRuleDGSnapshot(DependencyGraphCreation) computeDependenciesForFilePath:ofType:forBuildFileReference:withOutputDirectory:additionalProperties:inTargetBuildContext:] (in DevToolsCore)
 14  0x0000000108038647 -[XCSourcesBuildPhaseDGSnapshot(DependencyGraphCreation) _computeDependenciesForFilePath:ofType:forBuildFileReference:usingBuildRule:inTargetBuildContext:processedPaths:] (in DevToolsCore)
 15  0x0000000108038d25 -[XCSourcesBuildPhaseDGSnapshot(DependencyGraphCreation) computeDependenciesForFilePath:ofType:forBuildFileReference:usingBuildRule:inTargetBuildContext:] (in DevToolsCore)
 16  0x00000001080392c3 -[XCSourcesBuildPhaseDGSnapshot(DependencyGraphCreation) computeDependenciesForBuildFileReference:inTargetBuildContext:] (in DevToolsCore)
 17  0x000000010802dc0c -[XCBuildPhaseDGSnapshot(DependencyGraphCreation) computeDependenciesForAllBuildFileReferencesInTargetBuildContext:] (in DevToolsCore)
 18  0x000000010803aab0 -[XCSourcesBuildPhaseDGSnapshot(DependencyGraphCreation) computeDependenciesForAllBuildFileReferencesInTargetBuildContext:] (in DevToolsCore)
 19  0x000000010803b450 -[XCSourcesBuildPhaseDGSnapshot(DependencyGraphCreation) computeDependenciesInTargetBuildContext:] (in DevToolsCore)
 20  0x0000000107fa811e -[XCProductTypeSpecification computeDependenciesInTargetBuildContext:] (in DevToolsCore)
 21  0x00000001080294d3 -[XCNativeTargetDGSnapshot(DependencyGraphCreation) computeDependenciesInTargetBuildContext:] (in DevToolsCore)
 22  0x0000000107f4bf81 -[PBXTargetBuildContext createDependencyGraphWithTargetDGSnapshot:] (in DevToolsCore)
 23  0x0000000107f5dc15 -[PBXTargetBuildContext(DependencyGraphEvents) dg_setTargetSnapshot:] (in DevToolsCore)
 24  0x00007fff899daf4c __invoking___ (in CoreFoundation)
 25  0x00007fff899dade4 -[NSInvocation invoke] (in CoreFoundation)
 26  0x0000000107f5d010 -[PBXTargetBuildContext(DependencyGraphEvents) processDependencyGraphEvents] (in DevToolsCore)
 27  0x00007fff899daf4c __invoking___ (in CoreFoundation)
 28  0x00007fff899dade4 -[NSInvocation invoke] (in CoreFoundation)
 29  0x0000000107fa07e1 -[XCInvocationQueue _processNextInvocationInThreadSlotNumber:] (in DevToolsCore)
 30  0x0000000107fa0c48 -[XCInvocationQueue _processInvocationsInThreadSlotNumber:] (in DevToolsCore)
 31  0x00007fff88db774e -[NSThread main] (in Foundation)
 32  0x00007fff88db76c6 __NSThread__main__ (in Foundation)
 33  0x00007fff8edc08bf _pthread_start (in libsystem_c.dylib)
 34  0x00007fff8edc3b75 thread_start (in libsystem_c.dylib)

objc[3904]: garbage collection is ON
abort() called 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T18:57:04.523

通过将图标拖到垃圾桶并从 Mac App Store 重新安装来卸载 Xcode 4.3 解决了该问题。

诡异的。

编辑补充说：在整个事情发生后不久，我的硬盘就坏了。因此，看起来这可能与 Xcodey 无关，而是与我自己的硬盘驱动器故障有关。教训：备份如果你得到这个错误，它可能是一个非常糟糕的指标。

# javascript - Eclipse、JavaScript、UTF-8 和选项卡（在 Mac 上）

> ID：10321853
> 
> 赞同：1
> 
> 时间：2012-04-25T18:43:22.310
> 
> 标签：javascript, eclipse, utf-8

我通过我的spaces2tabs转换器运行了一些javascript文件（ps我正在移植到coffeescript，这就是我需要标签的原因——后来放弃了coffeescript）

```
 public static String convertSpacesToTabs(String str, int spacesPerTab) {
        assert (spacesPerTab >= 1);
        StringBuilder builder = new StringBuilder();
        for (int i = 0; i = 0) {
            //System.out.println("old: " + oldIdx + " new: " + newIdx);
            sb.append(str.substring(oldIdx, newIdx));
            sb.append('\t');
            oldIdx = newIdx + toFind.length();
            newIdx = str.indexOf(toFind, oldIdx);
        }
        sb.append(str.substring(oldIdx, str.length()));
        return sb.toString();
    } 
```

像魅力一样工作：用制表符替换空格。在 TextMate 中看起来很完美，运行良好等。完全有效的 UTF-8

唯一的问题出现在日食中，那里一团糟。

似乎eclipse无法处理我插入的\t。最初打开文件时，eclipse 显示一个奇怪的字符，并用消息“无效字符”标记这些选项卡删除此标记。当我转到资源下的项目属性时，我将文本版本更改为 utf-8，奇怪的字符消失了，但错误消息没有！

有没有一种简单的方法可以让 eclipse 开心？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T20:32:14.650

似乎是日食中的一个错误......据我所知，没有修复......

# android - Android Twitter Intent to my company 时间线

> ID：10321854
> 
> 赞同：2
> 
> 时间：2012-04-25T18:43:22.497
> 
> 标签：android

我正在尝试打开一个 Android 意图，以便为我的公司时间线访问移动 Twitter 网站，或者打开actaul twitter 应用程序（如果已安装）。我让它部分工作，我的手机询问我想如何打开操作（浏览器、Twitter 等）。如果我选​​择浏览器，它会很好地转到移动网站。如果我选择 Twitter，我会收到“无法完成操作”的 toast 消息。

`String url = "https://mobile.twitter.com/myCompanyTag"; Intent browserIntent = new Intent(Intent.ACTION_VIEW, Uri.parse(url)); startActivity(browserIntent);`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T09:48:45.540

您可以使用 twitter 网络意图：[https](https://dev.twitter.com/docs/intents#follow-intent) ://dev.twitter.com/docs/intents#follow-intent 。它们由 twitter 官方应用程序正确处理。

网址将类似于： [https ://twitter.com/intent/user?screen_name=luten87](https://twitter.com/intent/user?screen_name=luten87)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T19:04:44.467

您是否尝试过使用非移动网址？twitter 应用程序可能不希望解析移动 url。

可能对您有所帮助的其他资源..

[http://omgwtfgames.com/2012/01/android-intents-captured-by-various-twitter-clients/](http://omgwtfgames.com/2012/01/android-intents-captured-by-various-twitter-clients/)

# amazon-web-services - aws cloudfront流分发502s

> ID：10321855
> 
> 赞同：2
> 
> 时间：2012-04-25T18:43:27.543
> 
> 标签：amazon-web-services, video-streaming, amazon-cloudfront

我在设置流式云端分发时遇到 502 错误，并且在网上找不到任何有关设置问题的信息，想知道是否有人有这方面的经验？

我的分发和 s3 存储桶都设置了大约一个小时，并且我的分发在 AWS 控制台中标记为已部署。我可以直接从 S3 存储桶中读取文件，但是当我尝试通过分发访问任何内容时会得到 502。我通过浏览器执行此操作只是为了在继续我的项目之前测试一切是否正常。我现在还在同一个存储桶上设置了一个非流式分发，并且可以正常工作，但我真的希望流式传输能够正常工作。

我在这里缺少什么吗？任何帮助/指导表示赞赏。谢谢！

# c++ - C++11 是否支持模板中的类型递归？

> ID：10321856
> 
> 赞同：6
> 
> 时间：2012-04-25T18:43:32.140
> 
> 标签：c++, types, c++11, type-theory

我想详细解释这个问题。在许多具有强类型系统的语言（如 Felix、Ocaml、Haskell）中，您可以通过组合类型构造函数来定义多态列表。这是 Felix 的定义：

```
typedef list[T] = 1 + T * list[T];
typedef list[T] = (1 + T * self) as self; 
```

在 Ocaml 中：

```
type 'a list = Empty | Cons ('a, 'a list) 
```

在 C 中，这是递归的，但既不是多态的也不是组合的：

```
struct int_list { int elt; struct int_list *next; }; 
```

在 C++ 中，如果 C++ 支持类型递归，它会这样做：

```
struct unit {};
template<typename T>
    using list<T> = variant< unit, tuple<T, list<T>> >; 
```

给出了元组（又名对）和变体（但不是 Boost 中使用的损坏的）的合适定义。或者：

```
 using list<T> = variant< unit, tuple<T, &list<T>> >; 
```

考虑到变体的定义略有不同，可能是可以接受的。甚至不可能在 C++ < C++11 中编写它，因为没有模板类型定义，就无法获得多态性，并且没有类型定义的合理语法，就无法获得范围内的目标类型。上面的 using 语法解决了这两个问题，但这并不意味着允许递归。

特别是请注意，允许递归对 ABI 有重大影响，即名称修改（除非名称修改方案允许表示固定点，否则无法完成）。

我的问题：需要在 C++11 中工作吗？[假设扩展不会导致无限大的结构]

* * *

编辑：为了清楚起见，要求是一般结构类型。模板正好提供，例如

```
pair<int, double>
pair<int, pair <long, double> > 
```

是匿名（结构上）类型的，并且 pair 显然是多态的。然而，不能说明 C++ < C++11 中的递归，甚至不能用指针说明。在 C++11 中，您可以声明递归，尽管使用模板 typedef（使用新的 using 语法，= 符号的 LHS 上的表达式在 RHS 的范围内）。

具有多态性和递归的结构（匿名）类型是类型系统的最低要求。

任何现代类型系统都必须支持多项式类型函子，否则类型系统太笨拙而无法进行任何高级编程。为此所需的组合子通常由类型理论家陈述，例如：

```
1 | * | + | fix 
```

其中 1 是单元类型，* 是元组形式，+ 是变体形式，fix 是递归。这个想法很简单：

如果 t 是一个类型并且 u 是一个类型，那么 t + u 和 t * u 也是类型

在 C++ 中，struct unit{} 是 1，tuple 是 *，variant 是 +，并且可以使用 using = 语法获得固定点。这不是完全匿名的输入，因为固定点需要模板 typedef。

* * *

编辑：只是C中多态类型构造函数的一个例子：

```
T*          // pointer formation
T (*)(U)    // one argument function type
T[2]        // array 
```

不幸的是，在 C 中，函数值不是组合的，指针的形成受左值约束，类型组合的语法规则本身也不是组合的，但在这里我们可以说：

```
if T is a type T* is a type
if T and U are types, T (*)(U) is a type
if T is a type T[2] is a type 
```

所以这些类型构造器（组合器）可以递归地应用来获得新类型，而不必创建新的中间类型。在 C++ 中，我们可以轻松解决语法问题：

```
template<typename T> using ptr<T> = T*;
template<typename T, typename U> using fun<T,U> = T (*)(U);
template<typename T> using arr2<T> = T[2]; 
```

所以现在你可以写：

```
arr2<fun<double, ptr<int>>> 
```

语法是组合的，打字也是。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-25T18:57:27.800

不，那是不可能的。甚至禁止通过别名模板进行间接递归。

C++11、4.5.7/3：

> 别名模板声明中的 type-id 不应引用正在声明的别名模板。由别名模板特化生成的类型不应直接或间接使用该特化。[ 例子：
> 
> ```
> template <class T> struct A;
> template <class T> using B = typename A<T>::U;
> template <class T> struct A {
> typedef B<T> U;
> };
> B<short> b; // error: instantiation of B<short> uses own type via A<short>::U 
> ```
> 
> —结束示例]

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-25T20:47:03.040

如果你想要这个，坚持你的 Felix、Ocaml 或 Haskell。你会很容易意识到很少（没有？）成功的语言拥有像这三种语言一样丰富的类型系统。在我看来，如果所有语言都一样，那么学习新语言就不值得了。

```
template<typename T>
using list<T> = variant< unit, tuple<T, list<T>> >; 
```

在 C++ 中不起作用，因为别名模板没有定义新类型。它纯粹是一个别名，一个同义词，它*相当于它的替换*。[这是一个*功能*，顺便说一句](https://stackoverflow.com/a/6623089/46642)。

该别名模板等价于 Haskell 的以下部分：

```
type List a = Either () (a, List a) 
```

GHCi 拒绝这一点，因为“类型同义词声明中的[循环]”是不允许的。我不确定这是否在 C++ 中被彻底禁止，或者是否允许但在替换时会导致无限递归。无论哪种方式，它都行不通。

在 C++ 中定义新类型的方法是使用`struct`、`class`、`union`和`enum`关键字。如果您想要类似以下 Haskell 的内容（我坚持使用 Haskell 示例，因为我不了解其他两种语言），那么您需要使用这些关键字。

```
newtype List a = List (Either () (a, List a)) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-26T00:41:00.843

我认为您可能需要查看您的类型理论，因为您的一些断言是不正确的。

让我们解决您的主要问题（和反手点） - 正如其他人指出的那样*，您请求的类型的*类型递归是不允许的。这并不**意味着**c++ 不支持类型递归。它很好地支持它。您请求的类型递归是类型*名称*递归，这是一种语法风格，实际上对实际类型系统没有影响。

C++ 允许通过代理进行元组成员递归。例如，c++ 允许

```
class A
{
    A * oneOfMe_;
}; 
```

那是具有实际后果的类型递归。（显然，没有内部代理表示，任何语言都无法做到这一点，因为否则大小是无限递归的）。

C++ 还允许翻译时多态性，它允许创建与您可以使用名称递归创建的任何类型一样的对象。名称递归仅用于向成员卸载类型或在类型系统中提供翻译时行为分配。类型标签、类型特征等是众所周知的 C++ 习惯用法。

为了证明类型名称递归不会向类型系统添加功能，只需要指出 c++ 的类型系统允许完全图灵完备的类型计算，使用编译时常量（及其类型列表）的元编程，通过简单的映射命名为常量。这意味着有一个函数 MakeItC++:YourIdeaOfPrettyName->TypeParametrisedByTypelistOfInts 可以生成您想要的任何图灵可计算类型系统。

如您所知，作为类型论的学生，变体是元组产品的对偶。在类型类别中，变体的任何属性都具有元组产品的双重属性，箭头反转。如果您始终使用对偶性工作，则不会获得具有“新功能”的属性（就类型计算而言）。所以在类型计算的层面上，你显然*不需要*变体。（这也应该从图灵完备性中显而易见。）

但是，就命令式语言的运行时行为而言，您确实会得到不同的行为。这是不好的行为。产品限制语义，变体放松语义。你永远不应该想要这个，因为它*可以证明*会破坏代码的正确性。静态类型编程语言的历史一直朝着在类型系统中越来越多地表达语义的方向发展，目标是编译器应该能够理解程序何时不是你想要的。目标是将编译器变成程序验证系统。

例如，使用类型单位，您可以表示特定值不仅仅是一个，`int`而是实际上是以米每平方秒为单位测量的加速度。分配一个以英尺/小时表示的速度除以分钟的时间跨度的值不应该只是将这两个值相除 - 它应该注意转换是必要的（并且要么执行它，要么编译失败，或者......做正确的事事物）。分配一个力应该编译失败。例如，对程序意义进行这些检查可能会给我们带来更多的火星探索。

变体是相反的方向。当然，“如果你编码正确，它们就可以正常工作”，但这不是代码验证的重点。他们可证明添加代码位点，其中不熟悉当前类型用法的不同工程师可以引入不正确的语义假设而不会翻译失败。而且，总是存在一种代码转换，它将命令式代码部分从不安全地使用变体的部分更改为使用经过语义验证的非变体类型的部分，因此它们的使用也“总是次优的”。

变体的大多数运行时使用通常是更好地封装在运行时多态中的那些。运行时多态性具有静态验证的语义，可能具有相关的运行时不变检查，并且与变体不同（总和类型在一个代码轨迹中普遍声明）实际上支持开闭原则。由于需要在一个位置声明变体，因此每次向总和添加新的函数类型时都必须更改该位置。这意味着代码永远不会更改，因此可能会引入错误。但是，运行时多态性允许将新行为添加到与其他行为不同的代码位置中。

（此外，大多数真正的语言类型系统无论如何都不是分布式的。(a, b | c) =/= (a, b) | (a, c) 那么这里有什么意义呢？）

在没有获得该领域经验的情况下，我会谨慎地就什么使类型系统变得更好做出笼统的陈述，特别是如果你的观点是具有挑衅性和政治性并实施变革。我在您的帖子中没有看到任何实际上指向任何计算机语言的健康变化的内容。我没有看到功能、安全性或任何其他实际的现实问题得到解决。我完全喜欢类型理论。我认为每个计算机科学家都应该了解类别理论和编程语言的指称语义（领域理论、笛卡尔类别，所有好东西）。我认为，如果更多的人将 Curry-Howard 同构理解为本体论宣言，那么建构主义逻辑会得到更多尊重。

但这些都没有提供攻击 c++ 类型系统的理由。几乎每种语言都有合法的攻击——类型名称递归和变体可用性不是它们。

* * *

编辑：由于我关于图灵完整性的观点似乎没有被理解，也没有我对使用类型标签和特征来卸载类型计算的 c++ 方式的评论，也许一个例子是有序的。

现在，OP 声称希望在列表的用例中使用它，我之前在布局上的观点很容易处理。更好的是，只需使用 std::list。但从其他评论和其他地方来看，我认为他们真的希望这适用于 Felix->C++ 翻译。

所以，我认为 OP 认为他们想要的是

```
template <typename Type>
class SomeClass
{
    // ...
}; 
```

然后能够构建一个类型

```
SomeClass< /*insert the SomeClass<...> type created here*/ > 
```

我已经提到这只是一个想要的命名约定。没有人想要类型名——它们是翻译过程的瞬态。真正想要的是您稍后在类型的结构组合中将使用 Type 做什么。它将用于类型名计算以生成成员数据和方法签名。

所以，在 C++ 中可以做的是

```
struct SelfTag {}; 
```

然后，当你想引用 self 时，只需将这个类型标签放在那里。

当进行类型计算有意义时，您有一个模板专业化`SelfTag`，它将替换`SomeClass<SelfTag>`而不是替换`SelfTag`类型计算的适当位置。

我的观点是，c++ 类型系统是图灵完备的——这比我认为每次我写的时候 OP 正在阅读的内容要多得多。 **可以进行任何类型计算**（给定编译器递归的约束）**，这确实意味着如果您在使用完全不同的语言的一个类型系统中遇到问题，您可以在此处找到翻译**。我希望这能让事情更清楚地说明我的观点。回来说“好吧，你仍然不能在类型系统中做 XYZ”显然没有抓住重点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T19:22:19.287

C++ 确实有“奇怪地重复出现的模板模式”或 CRTP。但是，它并不特定于 C++11。这意味着您可以执行以下操作（从[Wikipedia](http://en.wikipedia.org/wiki/Curiously_recurring_template_pattern)无耻地复制）：

```
template <typename T>
struct base
{
    // ...
};
struct derived : base<derived>
{
    // ...
}; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-28T03:36:35.680

@jpalcek 回答了我的问题。但是，我的实际问题（如示例中所暗示的）可以在没有这样的递归别名的情况下解决：

```
// core combinators
struct unit;
struct point;
template<class T,class U> struct fix;
template<class T, class U> struct tup2;
template<class T, class U> struct var2;

template <> struct   
  fix<
    point,
    var2<unit, tup2<int,point> > 
  > 
{ 
  // definition goes here
}; 
```

使用 fix 和 point 类型来表示递归。我碰巧不需要定义任何模板，我只需要定义专业。我需要的是一个在两个不同的翻译单元中相同的*名称*，用于外部链接：名称必须是类型结构的函数。

@Ex0du5 提示考虑这一点。实际的解决方案也与多年前 Gabriel des Rois 的来信有关。我要感谢所有做出贡献的人。

# jquery - 居中 div 覆盖

> ID：10321863
> 
> 赞同：0
> 
> 时间：2012-04-25T18:43:51.197
> 
> 标签：jquery, html

我正在尝试将覆盖整个图像的 div 居中。我有一个 jQuery 脚本，它假设检查文档的大小（宽度和高度），划分它，并设置 div 的宽度。我认为应该将内容放在页面中间。

```
<head>  
    <style type="text/css">
        .boxWrapper{
            min-width:640px;
            min-height:480px;
            margin-left:auto;
            margin-right:auto;
            vertical-align:center;
            padding: 15px 10px 10px 30px;
            z-index:8;
        }
        .box {
            margin-left:auto;
            margin-right:auto;
            vertical-align:center;
            z-index:8;
        }
        .blackOut {
            position: absolute;
            top:0px;
            left:0px;
            z-index: 5;
            width:100%;
            height:100%; 
            background-color: rgba(0,0,0,.8);
        }
    </style>
</head>
<body bgcolor="#DCDCDC">
    <div class="pageWrapper">   
    <div class="binShadow">
        <div class="bin">       
            <table id="tableBin" border="0">
                <tr>
                    <th>name</th>
                    <th>description</th>
                    <th>location</th>
                    <th>duration</th>
                </tr>
                <tbody>
                    <tr>
                        <td><a href='A001C010_111129_R1VL.mov'>A001C010_111129_R1VL.mov</a></td>
                        <td>dolor sit amet, consectetur adipiscing elit. Fusce bibendum, leo non.</td>
                        <td>dr101</td>
                        <td>:60</td>
                    </tr>
                    <tr>
                        <td><a href="A001C011_111129_R1VL.mov">A001C011_111129_R1VL.mov</a></td>
                        <td>Lorem ipsum dolor sit amet, consectetur adipiscing elit</td>
                        <td>dr101</td>
                        <td>:60</td>
                    </tr>
                </tbody>
                </div>
            </table>
        </div>
    </div>  
</div>
<script>
    $("#tableBin a").on("click", function(e) {
     e.preventDefault();
     var url = $(this).attr("href");
     var overlay = jQuery('<div class="blackOut"><div class="boxWrapper"><div class="box"><video src="'+url+'" /></video></div></div></div>');
     var left = "width:"+width($document)/2+"px";
     var top = "hieght:"+hieght($document)/2+"px";
     ​
     $('</span>').text(data).css('width', left).appendTo('#boxWrapper');
     $('</span>').text(data).css('height', top).appendTo('#boxWrapper');
     overlay.appendTo(document.body);

    });
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:49:15.107

不需要 jQuery。纯 CSS。

[http://jsbin.com/ebuyet/edit#javascript,html,live](http://jsbin.com/ebuyet/edit#javascript,html,live)

jQuery：

```
$("#tableBin a").on("click", function(e){
     e.preventDefault();

     var url = $(this).attr("href");
     var overlay = '<div class="blackOut"> <span class="boxWrapper"> <div class="box">  <video src='+url+'></video>  </div></span></div>';

     $('body').append(overlay);
     $('.blackOut').stop().fadeTo(1000,1); // fadeIn after is appended
}); 
```

CSS：

```
 .blackOut {
        position: absolute;

        top:0px;
        left:0px;
        z-index: 5;
        width:100%;
        height:100%; 
        background-color: rgba(0,0,0,.8);
        text-align:center;
    }
     span.boxWrapper{
display:block;
        width:640px;
        height:480px;
margin:0 auto;
        padding: 15px 10px 10px 30px;
        z-index:8;
        background:#eee;
    }
    .box {
        margin-left:auto;
        margin-right:auto;
        vertical-align:center;
        z-index:8;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:46:26.037

[http://jsfiddle.net/spw6K/53/](http://jsfiddle.net/spw6K/53/)

```
<head>  
    <style type="text/css">
        .boxWrapper{
            min-width:640px;
            min-height:480px;
            text-align:center;
            z-index:8;
            height:100%;
        }
        .box {
            z-index:8;
            height:100%;
        }
        .blackOut {
            position: absolute;
            top:0px;
            left:0px;
            z-index: 5;
            width:100%;
            height:100%; 
            background-color: rgba(0,0,0,.8);
        }
    </style>
</head>

<body bgcolor="#DCDCDC">
    <div class="pageWrapper">

    <div class="binShadow">
        <div class="bin">       
            <table id="tableBin" border="0">
                <tr>
                    <th>name</th>
                    <th>description</th>
                    <th>location</th>
                    <th>duration</th>
                </tr>
                <tbody>
                    <tr>
                        <td><a href='A001C010_111129_R1VL.mov'>A001C010_111129_R1VL.mov</a></td>
                        <td>dolor sit amet, consectetur adipiscing elit. Fusce bibendum, leo non.</td>
                        <td>dr101</td>
                        <td>:60</td>
                    </tr>
                    <tr>
                        <td><a href="A001C011_111129_R1VL.mov">A001C011_111129_R1VL.mov</a></td>
                        <td>Lorem ipsum dolor sit amet, consectetur adipiscing elit</td>
                        <td>dr101</td>
                        <td>:60</td>
                    </tr>
                    <tr>
                        <td><a href="A001C012_111129_R1VL.mov">A001C012_111129_R1VL.mov</a></td>
                        <td>dolor sit amet, consectetur adipiscing elit. Fusce bibendum, leo non.</td>
                        <td>dr101</td>
                        <td>:60</td>
                    </tr>
                </tbody>
                </div>
            </table>
        </div>
    </div>  
</div>
<script>
    $("#tableBin a").on("click", function(e)
    {
        e.preventDefault();

        var url = $(this).attr("href");
        var top = "padding-top:" + $(window).height() / 2 + "px";

        var overlay = jQuery('<div class="blackOut"><div class="boxWrapper"><div class="box" style="' + top + '"><video class="videoBox" src="'+url+'"/></div></div></div>');

        $("body").append( overlay );
    });
</script>​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T19:15:11.360

如果您只是想要一些文本在视频下方居中，则不需要使用 jQuery 进行定位。另外，您的代码存在许多问题：

1）您需要使用`$(document).width()`or `$(window).width()`，而不是`width($(document))`

2）您似乎添加了两次相同的数据：

```
$('</span>').text(data).css('width', left).appendTo('#boxWrapper');
$('</span>').text(data).css('height', top).appendTo('#boxWrapper'); 
```

这增加了两个跨度。我认为您想要一个具有两个 css 属性的跨度（如果您正在定位，您应该使用`top`，而不是/ ：`left``height``width`

```
$('</span>').text(data).css({'left': left, 'top': top}).appendTo('#boxWrapper'); 
```

3）你试图追加到`boxWrapper`一个ID，但你正在使用`boxWrapper`作为一个类：`.appendTo('#boxWrapper');`=>`.appendTo('.boxWrapper');`

4）您试图在将`boxWrapper`其添加到页面之前附加到。要使用选择器，它必须存在于 DOM 中。您需要添加第`boxWrapper`一个，或者在 .html 的 HTML 中添加数据`boxWrapper`。

话虽如此，如果您的数据确实是隐含的文本，请使用 CSS 文本居中。我会将您的数据添加到 a`div`中，然后将其设置为 100% 宽度`text-align: center`。

```
$("#tableBin a").on("click", function(e) {
    e.preventDefault();

    var url = $(this).attr("href");
    var overlay = $('<div class="blackOut"><div class="boxWrapper"><div class="box video">Video Here: '+url+'</div></div></div>');

    // You need to add the overlay to your DOM before you can append your data to it
    overlay.appendTo('body'); 

    // Now you can append your data to the boxWrapper
    $('<div class="data">').text("This is where your data would go").appendTo('.boxWrapper');
}); 
```

CSS：

```
.data {
   width: 100%;
   text-align: center;   
} 
```

演示：http: [//jsfiddle.net/jtbowden/Ead7r/2/](http://jsfiddle.net/jtbowden/Ead7r/2/)

# tsql - 在 SQL SERVER 2005 中以树状结构插入多行

> ID：10321864
> 
> 赞同：1
> 
> 时间：2012-04-25T18:43:57.177
> 
> 标签：tsql, sql-server-2005

我在 SQL 中有几个表非常像这样

```
A            B           C
ID_A         ID_B        ID_C
Name         Name        Name
             ID_A        ID_B 
```

如您所见，A 链接到 B，B 链接到 C。这些基本上是包含数据模型的表。现在，我需要能够根据这些表创建日期。例如，如果我有以下数据

```
A                    B                        C
1    Name1           1  SubName1   1          1  SubSubName1  1
2    Name2           2  SubName2   1          2  SubSubName2  1
                     3  SubName3   2          3  SubSubName3  2
                                              4  SubSubName4  3
                                              5  SubSubName5  3 
```

我想将这些表的“内容”复制到其他表中。当然，插入新表时生成的自动数字键与那些我希望能够跟踪以便我可以复制整个事情的人不同。收件人表的结构包含更多信息，但主要是日期和其他对我来说很容易获得的东西。

我需要完全在 TRANSACT-SQL 中执行此操作（如果需要，使用内置函数）。这可能吗，谁能给我一个简短的例子。我设法做到了一个级别，但我对其余的感到困惑。

谢谢

编辑：上面的信息只是一个例子，因为我的实际图表看起来更像这样

型号表：

```
Processes -- (1-N) Steps -- (1-N) Task             -- (0-N) TaskCheckList
                         -- (0-N) StepsCheckLists 
```

我需要填写的表格看起来像这样

```
Client -- (0-N) Sequence -- (1-N) ClientProcesses -- (1-N) ClientSteps -- (1-N)ClientTasks -- (0-N) ClientTaskCheckList
                                                                       -- (0-N)ClientStepCheckLists 
```

客户端已经存在，当我需要运行脚本时，我创建了一个序列，其中将包含所有进程，其中将包含其步骤、任务等......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T20:37:00.610

行，

所以我做了很多试验和错误，这就是我得到的。它似乎工作得很好，虽然对于一开始看起来很容易的事情来说听起来相当大。

整个这在某种程度上是法语和英语的，因为我们的客户是法国人，无论如何我们也是。它确实在我需要的所有表中插入了每个日期。唯一剩下的就是第一行，我需要根据一些参数选择要插入的日期，但这是简单的部分。

```
DECLARE @IdProcessusRenouvellement bigint
DECLARE @NomProcessus nvarchar(255)

SELECT @IdProcessusRenouvellement = ID FROM T_Ref_Processus WHERE Nom LIKE 'EXP%'
SELECT @NomProcessus = Nom FROM T_Ref_Processus WHERE Nom LIKE 'EXP%'

DECLARE @InsertedSequence table(ID bigint)

DECLARE @Contrats table(ID bigint,IdClient bigint,NumeroContrat nvarchar(255))

INSERT INTO @Contrats SELECT ID,IdClient,NumeroContrat FROM T_ClientContrat

DECLARE @InsertedIdsSeq as Table(ID bigint)

-- Séquences de travail
INSERT INTO T_ClientContratSequenceTravail(IdClientContrat,Nom,DateDebut)
    OUTPUT Inserted.ID INTO @InsertedIdsSeq
    SELECT ID, @NomProcessus + ' - ' + CONVERT(VARCHAR(10), GETDATE(), 120) + ' : ' +     NumeroContrat ,GETDATE() 
    FROM @Contrats

-- Processus
DECLARE @InsertedIdsPro as Table(ID bigint,IdProcessus bigint)
INSERT INTO T_ClientContratProcessus
        (IdClientContratSequenceTravail,IdProcessus,Nom,DateDebut,DelaiRappel,DateRappel,LienAvecPro    cessusRenouvellement,IdStatutProcessus,IdResponsable,Sequence)
    OUTPUT Inserted.ID,Inserted.IdProcessus INTO @InsertedIdsPro
    SELECT     I.ID,P.ID,P.Nom,GETDATE(),P.DelaiRappel,GETDATE(),P.LienAvecProcessusRenouvellement,0,0,0
        FROM @InsertedIdsSeq I, T_Ref_Processus P 
        WHERE P.ID = @IdProcessusRenouvellement

-- Étapes
DECLARE @InsertedIdsEt as table(ID bigint,IdProcessusEtape bigint)
INSERT INTO T_ClientContratProcessusEtape 
        (IdClientContratProcessus,IdProcessusEtape,Nom,DateDebut,DelaiRappel,DateRappel,NomListeVeri    fication,Sequence,IdStatutEtape,IdResponsable,IdTypeResponsable,ListeVerificationTermine)
    OUTPUT Inserted.ID,Inserted.IdProcessusEtape INTO @InsertedIdsEt
SELECT I.ID,E.ID,
            E.Nom,GETDATE(),E.DelaiRappel,GETDATE(),COALESCE(L.Nom,''),E.Sequence,0,0,E.IdTypeResponsabl    e,0
FROM @InsertedIdsPro I INNER JOIN  T_Ref_ProcessusEtape E ON I.IdProcessus =     E.IdProcessus
LEFT JOIN T_Ref_ListeVerification L ON E.IdListeVerification = L.ID

-- Étapes : Items de la liste de vérification   
INSERT INTO T_ClientContratProcessusEtapeListeVerificationItem
    (IdClientContratProcessusEtape,Nom,Requis,Verifie)  
    SELECT I.ID,IT.Nom,IT.Requis,0
    FROM @InsertedIdsEt I 
    INNER JOIN T_Ref_ProcessusEtape E ON I.IdProcessusEtape = E.ID
    INNER JOIN T_Ref_ListeVerificationItem IT ON E.IdListeVerification =     IT.IdListeVerification

-- Tâches
DECLARE @InsertedIdsTa as table(ID bigint, IdProcessusEtapeTache bigint)
INSERT INTO T_ClientContratProcessusEtapeTache
        (IdClientContratProcessusEtape,IdProcessusEtapeTache,Nom,DateDebut,DelaiRappel,DateRappel,No    mListeVerification,Sequence,IdStatutTache,IdResponsable,IdTypeResponsable,ListeVerificationT    ermine)
    OUTPUT Inserted.ID,Inserted.IdProcessusEtapeTache INTO @InsertedIdsTa
    SELECT I.ID,T.ID,
               T.Nom,GETDATE(),T.DelaiRappel,GETDATE(),COALESCE(L.Nom,''),T.Sequence,0,0,T.IdTypeResponsabl    e,0
    FROM @InsertedIdsEt I 
    INNER JOIN T_Ref_ProcessusEtapeTache T ON I.IdProcessusEtape = T.IdProcessusEtape
    LEFT JOIN T_Ref_ListeVerification L ON T.IdListeVerification = L.ID

-- Tâches : Items de la liste de vérification
INSERT INTO T_ClientContratProcessusEtapeTacheListeVerificationItem
    (IdClientContratProcessusEtapeTache,Nom,Requis,Verifie) 
    SELECT I.ID,IT.Nom,IT.Requis,0
    FROM @InsertedIdsTa I 
    INNER JOIN T_Ref_ProcessusEtapeTache T ON I.IdProcessusEtapeTache = T.ID
    INNER JOIN T_Ref_ListeVerificationItem IT ON T.IdListeVerification =     IT.IdListeVerification 
```

# php - 致命错误：未捕获的异常 'Exception' 带有消息 'DateTimeZone

> ID：10321868
> 
> 赞同：1
> 
> 时间：2012-04-25T18:44:20.383
> 
> 标签：php, date, timezone

我正在使用这段代码：

```
$dtzone = @new DateTimeZone($this->session->userdata('timezone'));
$time =  date('r',$this->session->userdata('old_last_login'));
$dtime = new DateTime($time);
@$dtime->setTimeZone($dtzone); 
```

它在所有浏览器中都可以正常工作，除了在我收到消息的 Firefox 中：

```
Fatal error: Uncaught exception 'Exception' with message 'DateTimeZone::__construct() 
[<a href='datetimezone.--construct'>datetimezone.--construct</a>]: Unknown or bad timezone ()' 
in /home/example.loc/public_html/application/views/_partials/top.php:7 Stack trace: #0
/home/example.loc/public_html/application/views/_partials/top.php(7): DateTimeZone->__construct('') ... 
```

似乎这是错误消息中最重要的部分：**Unknown or bad timezone ()**

我不明白为什么它在所有浏览器中都可以，为什么它在 Firefox 中不起作用。

时区已设置。例如：**美国/蒙得维的亚**

在我看来，firefox 以某种无效格式存储 cookie，因为当我将代码更改为此时：

```
$dtzone = @new DateTimeZone('America/Montevideo'); 
```

有用。

# eclipse - CVS 分支 + 二进制文件

> ID：10321875
> 
> 赞同：0
> 
> 时间：2012-04-25T18:45:07.250
> 
> 标签：eclipse, cvs, binaryfiles, branching-and-merging

我通过 eclipse 插件使用 CVS。我在 CVS 中提交了一个 .fla 和一个 .swf 文件。我创建了一个新分支并在 .fla 和 swf 文件中进行了更改，并将它们提交到新分支上。我想将新分支与其根分支合并并切换回根分支，但 CVS 抱怨并不允许这样做。我可以在开发分支上提交文件，但是如何合并然后切换到根分支？

这是因为 .fla 和 .swf 都是二进制文件。我知道二进制文件不能合并。但我确实想用新分支中的新 fla 和 swf**覆盖根分支上的 fla 和 swf。**我该怎么做呢？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T19:27:40.900

如果这是您第一次也是最后一次这样做，那么最简单的方法就是复制您的文件并将它们再次提交到根目录。

或者使用这个命令让 CVS 为你做这件事。（在您的根工作目录中执行此操作）

```
cvs update -j <my_branch> <my_files> 
```

此命令仅适用于分支中的第一次更改。如果以后需要多次合并，可以使用这组命令来避免冲突：

```
cvs update -j <my_branch_last_join_tag_name> -j <my_branch> <my_files>
cvs tag -r <my_branch> -F <my_branch_last_join_tag_name> <my_files> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T07:18:34.577

这就是我所做的，它奏效了。

开发分支是我编码的地方。Head 是我提交稳定版本的地方。

1.  切换到`HEAD`
2.  右键单击>团队>合并
3.  在打开的弹出窗口中，选择`development`（您编码的分支）作为结束标记。
4.  选择`Root_development`（这是开发分支的父级，对我来说是`HEAD`）作为开始标签。
5.  预览合并（已预先选择）
6.  在打开的同步视图中，**右键单击二进制文件 > 覆盖**。
7.  完毕！
8.  提交到`HEAD`或父分支

# android - onSensorChanged(...) 中是否需要同步？

> ID：10321879
> 
> 赞同：2
> 
> 时间：2012-04-25T18:45:19.267
> 
> 标签：android, thread-safety, android-sensors

我得到了一个 SensorEventListener，它在 onSensorChanged() 方法中执行如下操作：

```
public void onSensorChanged(SensorEvent e){
   values = e.values.clone();
   handleEvent(); //do some computations
} 
```

其中 values 是一个类变量，将在 handleEvent() 方法中访问它以进行一些计算。我现在的问题是我是否必须锁定变量值，即当其他线程在handleEvent() 中时，值是否可以被另一个调用onSensorChanged() 的线程覆盖？

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T20:15:26.620

OnSensorChanged 在 UI-Thread 内部被调用，因此如果您`values`在 ui-thread 之外的另一个线程中访问，您需要同步或使用其他技术，例如队列。

# java - 如何在特定时间取消 PendingIntent？

> ID：10321880
> 
> 赞同：0
> 
> 时间：2012-04-25T18:45:23.807
> 
> 标签：java, android, service, alarmmanager, android-pendingintent

当我没有声明时，AlarmManager 可以完美运行，`cancel`但在声明 .. 时不会触发`cancel`。这是代码：

```
Calendar c= Calendar.getInstance();
                c.set(Calendar.HOUR_OF_DAY, 0); 
                c.set(Calendar.MINUTE, 37);
                c.set(Calendar.SECOND, 0);

            Toast.makeText(this, c.getTime().toString(), Toast.LENGTH_LONG).show();
        intent = new Intent(TestAlarm.this, TestAlarmService.class);
        pi = PendingIntent.getService(TestAlarm.this, 1, intent, 0);
        AlarmManager am = (AlarmManager) getSystemService(ALARM_SERVICE);
        am.set(AlarmManager.RTC_WAKEUP, c.getTimeInMillis(), pi); 
```

和`cancel`代码：

```
 c.add(Calendar.HOUR_OF_DAY, 0);
        c.add(Calendar.MINUTE, 38);
        c.add(Calendar.SECOND, 0);
        PendingIntent pi1=PendingIntent.getService(TestAlarm.this, 1, intent, 0);
        AlarmManager am1 = (AlarmManager) getSystemService(ALARM_SERVICE);
        //stopService(intent);
        am1.cancel(pi); 
```

现在，我想`AlarmManager`在 12:37 开始我的出发，`cancel`一两分钟后……但每当我使用`cancel`代码时，都`AlarmManager`不会触发……提前致谢！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T02:58:10.627

将行更改`am1.cancel(pi);`为`am1.cancel(pi1);`- 您正在取消原来的`PendingIntent`

此外，在您的取消代码中，您正在调用`c.add()`（添加到当前日期/时间）而不是`c.set()`（明确设置下一个日期/时间）。通过调用`c.add(Calendar.MINUTE, 38)`，您实际上是在当前日历中增加了 38 分钟，而不是将时间设置为 12:38；

# objective-c - 子类化 Objective C 类方法

> ID：10321887
> 
> 赞同：5
> 
> 时间：2012-04-25T18:45:45.920
> 
> 标签：objective-c, ios, oop, inheritance

我有一个关于子类化和类方法的问题。

我有一个`MyBaseClass`具有便利类方法的基类

`+ (id)giveMeAClassUsing:(NSString *)someParameter;`

`MyBaseClass`不是单例。

现在，我想创建一个 的子类`MyBaseClass`，我们称之为`MyChildClass`。我也希望有相同的类方法`MyChildClass`。此外，我还希望`MyChildClass`在我这样做时初始化一个实例变量。

会做这样的事情：

```
+ (id)giveMeAClassUsing:(NSString *)someParameter {

      MyChildClass *anInstance = [super giveMeAClassUsing:someParameter];
      anInstance.instanceVariable = [[UIImageView alloc] initWithFrame:someFrame];

      return anInstance;
} 
```

有效吗？

感谢您的所有帮助（提前）并解决我的困惑并澄清一些概念！

干杯!

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-25T18:51:10.607

那会很好用。

*可能更好的是以不需要*覆盖它的方式定义您的便利构造函数：

```
 + (id)myClassWithString: (NSString *)string {
     return [[[self alloc] initWithString:string] autorelease];
 } 
```

无论调用哪个超类或其任何子类，这都会做正确的事情。

然后只更改*子类*`initWithString:`中的方法来处理初始化：

 *```
- (id)initWithString: (NSString *)string {
    return [self initWithString:string andImageView:[[[UIImageView alloc] initWithFrame:someFrame] autorelease]] ;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-25T18:50:46.520

绝对是有效的。

一个注意事项是在超类中，用 引用类本身`self`，而不是按名称引用超类。

这是不好的：

```
// MySuperClass // BAD :(
+ (id)giveMeAClassUsing:(NSString *)someParameter {
  return [[[MySuperClass alloc] initWithParam:someParameter] autorelease];
} 
```

但这很好！

```
// MySuperClass // GOOD! :D
+ (id)giveMeAClassUsing:(NSString *)someParameter {
  return [[[self alloc] initWithParam:someParameter] autorelease];
} 
```

否则，当您子类化然后调用 super 时，您实际上并没有初始化正确的类。的使用`self`允许被实例化的类在不覆盖类方法的情况下发生变化。*

# python - pyGTK 子类化问题。双重自我传递给方法

> ID：10321889
> 
> 赞同：2
> 
> 时间：2012-04-25T18:46:08.543
> 
> 标签：python, pygtk, subclassing

我正在尝试继承 gtk.DrawingArea。这是代码的问题部分。

```
class ClusterGraph(gtk.DrawingArea):
    def __init__(self):
        super(ClusterGraph, self).__init__()
        self.add_events(gtk.gdk.BUTTON_PRESS_MASK)
        self.connect('button-press-event', self.on_mouse_dn)

    def on_mouse_dn(*args):
        print args

window = gtk.Window()
window.connect("destroy", gtk.main_quit)
window.set_default_size(300, 600)
cg = ClusterGraph()
window.add(cg)
window.show_all()
gtk.main() 
```

问题是实例被传递给该方法两次。

点击它打印：

```
(<ClusterGraph object at 0x30167d8 (GtkDrawingArea at 0x2531610)>, <ClusterGraph object at 0x30167d8 (GtkDrawingArea at 0x2531610)>, <gtk.gdk.Event at 02F75F08: GDK_BUTTON_PRESS x=164,00, y=354,00, button=1>) 
```

我的回调实际上相当于

```
def on_mouse_dn(self, self, event) 
```

如何解决这个问题呢？还是正常的！？

顺便说一句，为什么打印

```
<ClusterGraph object at 0x30167d8 (GtkDrawingArea at 0x2531610)> 
```

而不是像

```
<ClusterGraph object at 0x30167d8 (ClusterGraph at 0x2531610)> 
```

**编辑：**问题是如何删除额外的参数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T19:14:00.333

定义方法时，不包含 self，因此在调用时，args 将包含 self 和其他参数。

由于它是一个 pygtk 事件处理程序，它的定义应该如下所示：

```
 57   def button_press_event(widget, event):
   58       if event.button == 1 and pixmap != None:
   59           draw_brush(widget, event.x, event.y)
   60       return True 
```

（来自[pygtk 教程](http://www.pygtk.org/pygtk2tutorial/sec-EventHandling.html)）

因此，传递的参数将是小部件和事件。总的来说，因为你在上课，所以你会有这些论点`(self, widget, event)`

既然你在做`self.connect`，这意味着`widget`将评估为`self`。因此，您会产生论点是 的错觉`(self, self, event)`。

使用`def on_mouse_dn(self, widget, event):`或`def on_mouse_dn(self, *args):`。第一个似乎最有意义...

**更新**：要不`widget`作为参数传递，您必须使用像`self.connect('button-press-event', lambda w, e: self.on_mouse_dn(e))`. 只需使用`def on_mouse_dn(self, event):`. 不过，这可能不是一个好主意（不确定），以防您的代码发生变化......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T05:20:57.627

这个问题就这样解决了。。

GTK 以这种方式调用回调：`cb(widget,event)`其中小部件是某个小部件类的实例。所以我需要明确的实例参考。这可以通过从类 obj 执行方法来实现。

```
self.connect('button-press-event', self.on_mouse_dn) 
```

应替换为

```
self.connect('button-press-event', self.__class__.on_mouse_dn) 
```

或者

```
self.connect('button-press-event', ClusterGraph.on_mouse_dn) 
```

第一种形式更灵活。

# html - SVG 与 HTML5 Canvas 中的图表

> ID：10321897
> 
> 赞同：7
> 
> 时间：2012-04-25T18:46:28.120
> 
> 标签：html, canvas, svg

我想开始一个项目，我需要在单击某些元素时绘制由与线条连接的圆角矩形和 JavaScript 动作组成的图表。这需要在所有现代浏览器中工作。

SVG 和 HTML5 Canvas 似乎都能够做到这一点，所以我想知道什么是最好的。

我也不想重新发明轮子，所以如果有图书馆可以做这些事情，我想知道；我查看了 Raphaël 和其他一些 JavaScript 绘图库，但它们并没有提供我需要的所有功能。在 Google 的 API 中有这样的工具，但是非常有限。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-25T18:50:09.357

使用 SVG 是因为 — 作为*保留模式*绘图 API — 您可以将事件侦听器直接附加到特定元素，并更改特定元素的属性并神奇地更新页面。此外，作为基于矢量的格式，它与分辨率无关。

相比之下，HTML5 Canvas 是一个`non-retained-mode`（又名*即时模式*）绘图 API；您绘制的每个像素都与画布上的所有其他像素混合，没有原始形状的概念。此外，作为基于光栅的格式，您需要做一些额外的工作才能让绘图命令针对不同的显示尺寸进行调整。

**一般来说，当且仅当您需要时，您应该使用 Canvas：**

1.  直接设置像素（例如模糊、闪光效果），或
2.  直接获取像素（例如读取用户的绘图以保存为 PNG，[对图像的部分进行采样以检测视觉重叠](http://phrogz.net/tmp/canvas_shape_edge_arrows.html)），或
3.  **大量**不会移动或跟踪单个事件的“对象”（SVG 重绘数千个对象可能会很慢）。

另请注意，您不必只选择其中一个。您可以在画布上绘制 SVG。您可以在 SVG 中包含位图（图像）。您甚至可以通过`<foreignElement>`. 您可以拥有一个带有多个分层画布和具有透明背景的 SVG 元素的 HTML 页面，将每个页面的输出混合在一起。

# c# - 了解用户是否更改了 DataGrid 中的数据的最佳方法是什么？

> ID：10321899
> 
> 赞同：2
> 
> 时间：2012-04-25T18:46:32.510
> 
> 标签：c#, wpf, datagrid

我想知道每次用户修改 WPF DataGrid 中的数据时。

我可以使用一个事件来做到这一点吗？或者我可以用来覆盖全部数据更改（添加行、删除行、修改行等）的最小事件集是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T00:12:07.240

我知道这可能超出了您的要求，但是一旦您做到了，就很难再回头了。无论您要绑定到...某个列表，都让该项目实现 IEditableObject。这样你就不必担心任何控制/视图实现，事件等。当项目更改时，数据网格以及大量 .NET 控件会将 IsDirty 对象设置为 true。

这些不是超级好的链接，但它们会让你开始考虑维护 isDirty 标志。

[https://msdn.microsoft.com/en-us/library/system.componentmodel.ieditableobject(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/system.componentmodel.ieditableobject(v=vs.110).aspx)

[对象编辑和 isDirty() 标志](https://stackoverflow.com/questions/200887/object-editing-and-isdirty-flag)

[http://bltoolkit.net/doc/EditableObjects/EditableObject.htm](http://bltoolkit.net/doc/EditableObjects/EditableObject.htm)

这更像是我习惯的：

[https://stackoverflow.com/a/805695/452941](https://stackoverflow.com/a/805695/452941)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T18:54:16.373

通常，当您使用 MVVM 时，您会将主列表绑定到 ObservableCollection，然后将所选项目绑定到特定实例。在你的 setter 中，你可以引发事件。这将是捕获数据列表的更新/添加/删除的最合乎逻辑的（阅读：我见过的最常见的方法）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T05:37:57.173

如果你使用 mvvm 你不需要知道什么时候“用户修改数据网格中的数据”你必须知道**底层集合什么时候改变**。

因此，如果您使用数据表（HasChanges/RejectChanges...），那么您将拥有所有内置功能。如果您使用 poco 集合，那么您的项目至少必须实现 INotifyPropertyChanged - 如果它引发了用户修改数据。也许 IEditable 对于拒绝更改等也是一个很好的选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T23:10:29.230

**主窗口.xaml**

```
<Window x:Class="WpfApplication.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:WpfApplication"
        Title="MainWindow" Height="350" Width="525">
    <DataGrid x:Name="dataGrid" AutoGeneratingColumn="OnAutoGeneratingColumn">
        <DataGrid.Resources>
            <Style TargetType="DataGridCell">
                <EventSetter Event="Binding.SourceUpdated" Handler="OnDataGridCellSourceUpdated"/>
                <EventSetter Event="Binding.TargetUpdated" Handler="OnDataGridCellTargetUpdated"/>
            </Style>
        </DataGrid.Resources>
    </DataGrid>
</Window> 
```

**主窗口.xaml.cs**

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();

        this.dataGrid.ItemsSource = new ObservableCollection<Person>()
        {
            new Person() { Name = "John", Surname = "Doe" },
            new Person() { Name = "Jane", Surname = "Doe" }
        };
    }

    private void OnAutoGeneratingColumn(object sender, DataGridAutoGeneratingColumnEventArgs e)
    {
        var dataGridBoundColumn = e.Column as DataGridBoundColumn;
        if (dataGridBoundColumn != null)
        {
            var binding = dataGridBoundColumn.Binding as Binding;
            if (binding != null)
            {
                binding.NotifyOnSourceUpdated = true;
                binding.NotifyOnTargetUpdated = true;
            }
        }
    }

    private void OnDataGridCellSourceUpdated(object sender, DataTransferEventArgs e)
    {
        this.OnDataGridCellChanged((DataGridCell)sender);
    }

    private void OnDataGridCellTargetUpdated(object sender, DataTransferEventArgs e)
    {
        this.OnDataGridCellChanged((DataGridCell)sender);
    }

    private void OnDataGridCellChanged(DataGridCell dataGridCell)
    {
        // DataContext is MS.Internal.NamedObject for NewItemPlaceholder row.
        var person = dataGridCell.DataContext as Person;
        if (person != null)
        {
            var propertyName = ((Binding)((DataGridBoundColumn)dataGridCell.Column).Binding).Path.Path;
            var propertyValue = TypeDescriptor.GetProperties(person)[propertyName].GetValue(person);
            // TODO: do some logic here.
        }
    }
} 
```

这是我用于基于 Person（只是一些 POCO）实例、属性名称和属性值的一些复杂 DataGridCell 格式的内容。

但是，如果您想知道何时保存数据并使用 MVVM，那么最好的方法是为您的视图模型/模型中的每个可编辑属性设置原始值和当前值。加载数据时，原始值和当前值相等，如果通过 DataGrid 或任何其他方式更改属性，则仅更新当前值。当需要保存数据时，只需检查任何项目是否具有任何具有不同原始值和当前值的属性。如果答案是肯定的，则应保存数据，因为自上次加载/保存以来已更改，否则数据与加载时相同，因此不需要重新保存。此外，保存时，必须将当前值复制到原始值，因为数据再次等于保存的数据，就像上次加载时一样。

# .net - ASP.NET MVC：在 C# 代码块中使用 @

> ID：10321902
> 
> 赞同：1
> 
> 时间：2012-04-25T18:46:40.403
> 
> 标签：.net, asp.net-mvc, razor, html-helper

我对@的使用有点困惑。在下面的代码中，我首先编写`Html.ActionLink(...)`而不是`@Html.ActionLink(...)`因为我在一个`if`块中（C# 代码）。因此，我想确切地了解何时必须使用 @ 以及何时不必使用它。

```
<td width="32%" align="center">
     @if (Model.SeccionImpresos != null)
     {
           @Html.ActionLink("IMPRESOS", "Index", "Trabajo", null, null, "#impresos", new { id = Model.Id }, null);
     }
</td> 
```

我对此有任何帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-25T18:49:30.357

`@`有两个用途：

*   它用于从标记上下文（而不是从另一个代码块）开始一个代码*块*（`@if`, `@foreach`, @{ ... } 等）

*   它用于代码*块*——写入输出流 ( `@expression`) 的表达式。

`Html.ActionLink`在代码块中不写入`@`会创建一个丢弃其结果的普通方法调用。

# android - Android onResume 空白屏幕

> ID：10321905
> 
> 赞同：0
> 
> 时间：2012-04-25T18:47:04.750
> 
> 标签：android, onresume, forceclose

在我的 Android 应用程序中，一切正常，除了当我点击主页按钮并等待 10-15 分钟并返回应用程序时，屏幕是空白的。我仍然可以访问菜单项，但屏幕只是黑屏。

如果我正常进行活动，请选择主页按钮，然后返回应用程序就可以了……只有在它坐了一会儿之后……

有任何想法吗？

当应用程序恢复时，我会一直发送 Toast 消息，它会一直到最后一次执行代码。所以我不知道发生了什么。

此外，当屏幕为空白时，按返回或主页会导致强制关闭

编辑：单击主页按钮时添加异常：

```
04-25 15:12:09.625: E/AndroidRuntime(6351): java.lang.RuntimeException: Unable to pause activity {com.MyApp/com.MyAppMain.MainScreen}: java.lang.NullPointerException
04-25 15:12:09.625: E/AndroidRuntime(6351):     at android.app.ActivityThread.performPauseActivity(ActivityThread.java:2731)
04-25 15:12:09.625: E/AndroidRuntime(6351):     at android.app.ActivityThread.performPauseActivity(ActivityThread.java:2678)
04-25 15:12:09.625: E/AndroidRuntime(6351):     at android.app.ActivityThread.handlePauseActivity(ActivityThread.java:2651)
04-25 15:12:09.625: E/AndroidRuntime(6351):     at android.app.ActivityThread.access$1700(ActivityThread.java:132)
04-25 15:12:09.625: E/AndroidRuntime(6351):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1045)
04-25 15:12:09.625: E/AndroidRuntime(6351):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-25 15:12:09.625: E/AndroidRuntime(6351):     at android.os.Looper.loop(Looper.java:150)
04-25 15:12:09.625: E/AndroidRuntime(6351):     at android.app.ActivityThread.main(ActivityThread.java:4263)
04-25 15:12:09.625: E/AndroidRuntime(6351):     at java.lang.reflect.Method.invokeNative(Native Method)
04-25 15:12:09.625: E/AndroidRuntime(6351):     at java.lang.reflect.Method.invoke(Method.java:507)
04-25 15:12:09.625: E/AndroidRuntime(6351):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
04-25 15:12:09.625: E/AndroidRuntime(6351):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
04-25 15:12:09.625: E/AndroidRuntime(6351):     at dalvik.system.NativeStart.main(Native Method)
04-25 15:12:09.625: E/AndroidRuntime(6351): Caused by: java.lang.NullPointerException
04-25 15:12:09.625: E/AndroidRuntime(6351):     at com.MyAppMain.MainScreen.onPause(MainScreen.java:110)
04-25 15:12:09.625: E/AndroidRuntime(6351):     at android.app.Activity.performPause(Activity.java:3935)
04-25 15:12:09.625: E/AndroidRuntime(6351):     at android.app.Instrumentation.callActivityOnPause(Instrumentation.java:1313)
04-25 15:12:09.625: E/AndroidRuntime(6351):     at android.app.ActivityThread.performPauseActivity(ActivityThread.java:2708)
04-25 15:12:09.625: E/AndroidRuntime(6351):     ... 12 more

import localytics.localytics.android.LocalyticsSession; 
```

导入android.app.Activity；导入android.content.Intent；导入android.location.Location；导入android.os.Bundle；导入 android.view.Menu；导入 android.view.MenuInflater；导入android.view.MenuItem；导入android.view.View；导入android.widget.ImageButton；导入 android.widget.Toast；导入 com.myapp.R；进口 com.WhiteLabel.tools.Globals；导入 com.WhiteLabel.tools.LocationService.LocationResult；导入 com.WhiteLabel.tools.PreferenceHelper；

公共类 LoadingScreen 扩展 Activity { 保护位置 currentLocation; 私有 ApplicationClass 应用程序；私人 ImageButton btnLocal; 私人 ImageButton btnNational；私人图像按钮 btnDOD；私人 ImageButton btnDestinations; 私人 LocalyticsSession localyticsSession；

```
@Override
public void onCreate(Bundle savedInstanceState) 
{
    try
    {           
        //final Activity activity = this;
        application = ApplicationClass.getInstance();       
        setTheme(application.appTheme);
        super.onCreate(savedInstanceState);
        setContentView(R.layout.loading_screen);

        application.addressSaved = false;

        InitializeControls();

      //  String notifytime = PreferenceHelper.GetNotificationTime(this);

        InitializeLocalytics(true);

        Toast.makeText(this, "Use the menu button to access your account.", Toast.LENGTH_LONG).show();
    }
    catch(Exception ex)
    {           
        String s = ex.toString(); 
    }
}

@Override 
protected void onResume() 
{     
    try
    {       
        super.onResume(); 

        //if(!Globals.isRelease)
            //Toast.makeText(this, "Hit onresume on loading screen.", Toast.LENGTH_LONG).show();

        if(this.localyticsSession!=null)
            this.localyticsSession.open();

        Intent extrasIntent = getIntent();

        if(extrasIntent!=null)
        {           
            Bundle extras = extrasIntent.getExtras();

            if(extras!=null)
            {                               
                String message = extras.getString("load_directive");

                if(message.equalsIgnoreCase("notification"))
                {
                    getIntent().putExtra("load_directive", "");

                    String s = message; 
                    GetDDClick();
                }
            }
        }

        if(!Globals.isRelease)
            Toast.makeText(this, "Hit after extras intent.", Toast.LENGTH_LONG).show();

        //TODO - check for null application obj
        if(application.loadFailed)
        {
            application.loadFailed = false;
            Toast.makeText(getBaseContext(), "Connection issue.  Please verify you are connected to the internet!", Toast.LENGTH_LONG).show();              
        }

        if(!Globals.isRelease)
            Toast.makeText(this, "Hit end of onresume.", Toast.LENGTH_LONG).show();

    }
    catch(Exception ex)
    {
        if(!Globals.isRelease)
            Toast.makeText(this, "onResume error: "+ex.toString(), Toast.LENGTH_LONG).show();
    }
}

public void onPause() 
{  
    try
    {       
        this.localyticsSession.close();     
        this.localyticsSession.upload();     
    }
    catch(Exception ex)
    {
        if(!Globals.isRelease)
            Toast.makeText(this, "onPause error:"+ex.toString(), Toast.LENGTH_LONG).show();
    }       

    super.onPause(); 
} 

@Override 
public void onSaveInstanceState(Bundle savedInstanceState) 
{ 
    super.onSaveInstanceState(savedInstanceState); 
    // your stuff or nothing 
} 

@Override 
public void onRestoreInstanceState(Bundle savedInstanceState) 
{ 
    super.onRestoreInstanceState(savedInstanceState); 
    // your stuff or nothing 
} 

private void InitializeControls()
{
    btnLocal = (ImageButton)findViewById(R.id.btnLocal);
    btnNational = (ImageButton)findViewById(R.id.btnNational);
    btnDOD = (ImageButton)findViewById(R.id.btnDOD);
    btnDestinations = (ImageButton)findViewById(R.id.btnDestinations);

    btnLocal.setOnClickListener(new View.OnClickListener() {  public void onClick(View v) { GetLocalClick();    }});
    btnNational.setOnClickListener(new View.OnClickListener() {  public void onClick(View v) {  GetNationalClick();   }});
    btnDOD.setOnClickListener(new View.OnClickListener() {  public void onClick(View v) {  GetDDClick();   }});
    btnDestinations.setOnClickListener(new View.OnClickListener() {  public void onClick(View v) {  GetDestinationsClick();   }});
}

private void InitializeLocalytics(Boolean instantiate)
{
    if(instantiate)
        this.localyticsSession = new LocalyticsSession(this.getApplicationContext(),Globals.LocalyticsAppKey);         

    this.localyticsSession.open();        // open the session  
    this.localyticsSession.tagScreen("Main Menu");
    this.localyticsSession.upload();      // upload any data 
}

private void GetLocalClick()
{
    application.loadingButtonPressed = "local";
    // set application var to local
    GoToDDView();
}

private void GetNationalClick()
{
    application.loadingButtonPressed = "national";
    application.currentDivision = "national";
    // set application var to national
    GoToDDView();
}

private void GetDDClick()
{
    application.loadingButtonPressed = "daily";
    GoToSelectedView();
}

private void GetDestinationsClick()
{
    application.loadingButtonPressed = "travel";
    GoToDDView();
}

private void GoToDDView()
{
    Intent getResultsWindow = new Intent(LoadingScreen.this, Daily.class);
    startActivity(getResultsWindow);  
}

private void GoToSelectedView()
{
    Intent getResultsWindow = new Intent(LoadingScreen.this, DailySelected.class);
    startActivity(getResultsWindow);  
}

private void GoToHomeServices()
{
    Intent getResultsWindow = new Intent(LoadingScreen.this, MainMenu.class);
    startActivity(getResultsWindow); 
}

private void GoToMyAccount()
{
    Intent configIntent = new Intent(this,MyAccount.class);
    startActivity(configIntent);
}

public boolean onCreateOptionsMenu(Menu menu)
{
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.loadingscreenmenu, menu);
    return true; 
}

public boolean onOptionsItemSelected (MenuItem item)
{
    switch (item.getItemId()) 
    {                   
        case R.id.PROFILE:
            GoToMyAccount();
            return true;
        case R.id.MYVOUCHERS:
            Intent loadVouchersIntent = new Intent(this, Vouchers.class);
            startActivity(loadVouchersIntent);
            return true;
    }

    return false;
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:51:49.357

当您的应用程序进入后台时，它可能会在设备内存不足时被终止。也许这是你问题的一部分。

您可以使用 savedInstanceState 来保存应用程序状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-03-14T10:42:22.353

根据我的经验，当我尝试在 on resume 方法中添加一些耗时的同步任务（即在活动主线程上而不是在后台线程中运行的任务）时，屏幕会变黑。如果您的代码或流程在 onResume 中相对较长，则应将其包装在异步类中，例如 AysncTask 或 AsyncTask 加载器。例如，在 onResume 中将简单的 AsyncTask 定义为匿名内部类。

```
@Override
protected void onResume() {

  new AysncTask<Void,Void,Void>() {

     @Override
     protected String doInBackground(Void... voids) {
         yourTask();
         return;        
     }

  }.execute();

} 
```

# c++ - 我应该如何在项目中分离函数、类定义和主要代码？

> ID：10321908
> 
> 赞同：0
> 
> 时间：2012-04-25T18:47:24.727
> 
> 标签：c++

我目前有一个包含 3 个文件的项目。

一个`DBheader.h`头文件，包括：

*   类声明（及其较小的成员函数定义）

一个`DBdefinitions.cpp`文件：

*   中类的更大成员函数定义`DBheader.h`

最后是一个`DBmain.cpp`文件，其中包含：

*   主要代码
*   一些使用定义的类的大型（非成员）函数`DBheader.h`

我最好将这些函数移到某个地方，以使我的`DBmain.cpp`文件不那么混乱。我应该/可以将它们移动到`DBdefinition.cpp`文件中还是需要`.cpp`为非成员函数创建一个新的单独文件？

如果上述内容不清楚，这是我的代码的大致内容。

```
//DBheader.h

//libraries..

class course{
//member data..

void printinfo();

} 
```

-

```
//DBdefinitions.cpp

#include "DBheader.h"
void course::printinfo(){/*do stuff*/} 
```

-

```
//DBmain.cpp

#include "DBheader.h"
typedef map<int,course> record;
void fileinput(record &map);
int main(){
//stuff
}
void fileinput(record &map){
//lots of code
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:49:59.077

您应该以与`class`定义类似的方式组织作为公共接口一部分的自由函数：带有声明的标头和带有实现的实现文件。

如果它们特定于特定的翻译单元，请将它们保存在该实现文件中。

所有自由函数都应该在 a 中声明`namespace`（以公共函数命名，匿名用于“私有”自由函数）。

# java - Java中动态类和包加载的最佳方法

> ID：10321909
> 
> 赞同：0
> 
> 时间：2012-04-25T18:47:26.213
> 
> 标签：java, reflection, dynamic, loading

我有一个工厂类，它创建某种类型的对象（比如，`MyClass`）。

工厂类属于特定包，我想在该包中的实现和更新版本之间动态切换，以进行测试。

例如，原始包是`pack1`，新版本是`pack2`，类名`pack1.Factory`和`pack2.Factory`. 或将通过属性文件中的简单参数指定`pack1`。`pack2`此外，该`MyClass`类型对于两个包都是通用的，并且只应使用普通的 vanilla Java（即，没有第三方库）。

我正在考虑使用`Class.forName()`加载`pack1.Factory`或 `pack2.Factory`（取决于指定的属性），然后通过反射调用所有工厂方法。

这是最好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T18:58:51.033

这几乎是注入控制的经典用例。[Guice](http://code.google.com/p/google-guice/)应该让您立即开始。

需要有一个接口，例如`IFactory`，带有一些工厂方法`create`。创建两个 Guice 模块——一个绑定`IFactory`到`pack1.Factory`，另一个绑定到`pack2.Factory`. 当然，这两个工厂都应该实现`IFactory`.

然后在 main 方法中处理您的参数，该参数确定应该使用哪个工厂，并分别基于其中一个模块创建一个注入器。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-25T18:55:49.823

您应该尽可能避免反思。它使您的代码更难理解、更难重构和更难维护。

相反，您可以让您的工厂类实现一个接口，创建您要测试的工厂的实例并使用此实例调用您的测试。

# php - 你将如何从 PHP 向 MySQL 输入特殊字符？

> ID：10321913
> 
> 赞同：0
> 
> 时间：2012-04-25T18:47:40.247
> 
> 标签：php, mysql

实际上，我正在尝试做的是在[MySQL](http://en.wikipedia.org/wiki/MySQL)中输入一个类似于这个字符串的字符串（它是一行，为了便于阅读，分成两行）

```
fill:#0000ff;fill-rule:evenodd;stroke:#000000;stroke-width:1px;
stroke-linecap:butt;stroke-  linejoin:miter;stroke-opacity:1 
```

[MySQL 允许我使用phpMyAdmin](http://en.wikipedia.org/wiki/PhpMyAdmin)将字符串插入到字段中，并且 phpMyAdmin 将字段添加为（再次一行，为了便于阅读，分为两行）：

```
('fill:#0000ff;fill-rule:evenodd;stroke:#000000;stroke-width:1px;stroke-
linecap:butt;stroke-linejoin:miter;stroke-opacity:1'' in ''field list') 
```

使用我的 PHP 代码，我尝试将字段列表部分添加到我的代码中，如下所示

```
$rectangle_array[$rstyle] = $rectangle_array[$rstyle] . "' in ''field list'";
$mysql_rectangle_table_entry = "INSERT INTO $mysql_table VALUES
                               ($rectangle_array[$rstyle], 'rect',
                               $rectangle_array[$rid], $rectangle_array[$rwidth],
                               $rectangle_array[$rheight], $rectangle_array[$rx],
                               $rectangle_array[$ry])";
$run = mysql_query($mysql_rectangle_table_entry) or die(mysql_error()); 
```

在运行代码时，我收到以下错误。

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 ':#0000ff;fill-rule:evenodd;stroke:#000000;stroke-width:1px;stroke-linecap:butt;s' 附近使用正确的语法

我能做些什么来完成这项工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T18:54:17.040

如评论中所述……</p>

您可以[`mysql_real_escape_string()`](http://php.net/mysql_real_escape_string)在插入之前使用转义任何 MySQL 特殊字符。

例如：

```
$sql = "INSERT INTO my_table (string_column) VALUES ('" . mysql_real_escape_string($string) .  "')"; 
```

另一种选择是在PHP 的[MySQLi](http://www.php.net/manual/en/book.mysqli.php)或[PDO中使用](http://www.php.net/manual/en/book.pdo.php)[Prepared Statements](http://php.net/manual/en/mysqli.prepare.php)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T18:53:36.673

您可能想查看[准备好的语句](http://php.net/manual/en/mysqli.quickstart.prepared-statements.php "MySQLiprepared statement相关函数")或[mysql_real_escape_string](http://php.net/manual/en/function.mysql-real-escape-string.php "mysql真正的转义字符串")以转义可能会破坏您的 INSERT 的特殊字符。

# java - JMdns ServiceListner 没有找到所有服务，

> ID：10321916
> 
> 赞同：1
> 
> 时间：2012-04-25T18:47:47.463
> 
> 标签：java, jmdns

嗨，我创建了示例 jmdns serviceListner，当我运行它时，它应该继续列出它找到的服务，但是有了这个我的程序，它在运行时列出了​​一些服务，之后它没有列出任何服务。而且我的 google chrome 浏览器中有 dns-sd，所以当我在 chrome 中浏览服务时，当时我的程序会列出其他服务，否则我的程序不会列出服务。我不明白为什么 ServiceListner 本身没有检测到任何后续事件。

```
public static void main(String[] args) throws Exception {
    String type = "_my-app._tcp.local.";
    Enumeration<NetworkInterface> ifc = NetworkInterface.getNetworkInterfaces();
    while (ifc.hasMoreElements()) {
        NetworkInterface anInterface = ifc.nextElement();
        if (anInterface.isUp()) {
            Enumeration<InetAddress> addr = anInterface.getInetAddresses();
            while (addr.hasMoreElements()) {
                InetAddress address = addr.nextElement();
                final JmDNS jmdns = JmDNS.create(address, type);
                ServiceListenerClass aClass = new ServiceListenerClass();
                jmdns.addServiceListener(type, aClass);              

            }
        }
    }

}

public static class ServiceListenerClass implements ServiceListener {
    public void serviceAdded(ServiceEvent event) {
        event.getDNS().requestServiceInfo(event.getType(), event.getName(), true);
    }

    public void serviceRemoved(ServiceEvent event) {
        System.out.println((count--) + " " + event.getInfo().getName());
    }

    public void serviceResolved(ServiceEvent event) {
            System.out.println((count++) + " :Res: " + event.getInfo().getName() + " " + event.getInfo().getPort() + " " + event.getInfo().getApplication()
                    + " " + event.getInfo().getDomain() + " " + event.getInfo().getKey());
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T11:39:31.717

我有一个类似的问题二。问题可能来自您的防火墙设置。

在我的情况下，javaw.exe 可以访问所有来电，但由于防火墙阻止了它，因此无法向任何人发送任何内容。

尝试打开防火墙以测试您的程序，并确保这不是导致问题的防火墙。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-27T14:06:10.727

这里同样的问题。使用以下参数启动 java 为我解决了这个问题：

```
-Djava.net.preferIPv4Stack=true 
```

# android - .gitignore 对 Android 项目的建议

> ID：10321921
> 
> 赞同：3
> 
> 时间：2012-04-25T18:48:07.970
> 
> 标签：android, git, github

将在 git（和 github）中对我的 Android 项目进行版本控制，并好奇是否有人对我应该将哪些文件/文件夹添加到 .gitignore 等有任何建议。我应该注意什么问题？

我讨厌当我对整个项目进行版本化时，随后的一些提交最终会导致一堆文件/文件夹发生冲突，我一开始就不应该对其进行版本化。

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-25T18:52:55.457

Android 项目的标准 .gitignore

[https://github.com/github/gitignore/blob/master/Android.gitignore](https://github.com/github/gitignore/blob/master/Android.gitignore)

# jenkins - Jenkins 和 ClearCase 插件没有将文件复制到工作区

> ID：10321922
> 
> 赞同：1
> 
> 时间：2012-04-25T18:48:12.020
> 
> 标签：jenkins, clearcase

我们正在为 Jenkins 使用 ClearCase 插件（https://wiki.jenkins-ci.org/display/JENKINS/ClearCase+Plugin），我们遇到了一个问题，我们使用动态视图并且插件检测到源中的更改视图中的文件并启动构建，但不会将文件从视图复制到 Jenkins 工作区。

没有错误信息。没有失败的构建消息。根本不值一提。

这是否按设计工作？其他人如何从视图中获取已更改的文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T19:12:09.503

上次我看到一个类似的案例，它是一个动态视图：

*   加载规则不正确
*   或者根本没有加载规则（因为动态视图根本没有“加载规则”），这不符合[插件的文档](https://wiki.jenkins-ci.org/display/JENKINS/ClearCase+Plugin)：

> 指定一个或多个加载规则 - 这是必需的，即使使用动态视图也是如此。
> 加载规则既用于确定快照视图的内容，也用于构造`cleartool lshistory`用于轮询和生成更改日志的“”命令。

请注意，关于该插件有[很多待处理的错误](https://issues.jenkins-ci.org/browse/JENKINS/component/15503#atl_token=B5BF-G2S8-8N2K-SZ3R%7Cc3e8d9e32834afbd480520d09ee8c6aedd2f47c5%7Clout&selectedTab=com.atlassian.jira.plugin.system.project%3acomponent-popularissues-panel)，因此您可能会看到其中一个。
我会确保 Jenkins 使用的进程可以通过将副本作为构建脚本的一部分从动态视图访问和复制文件，以便该脚本（在 CC 插件的任何轮询机制之外）是否成功执行.

# r - ggplot2图表每天中午轴断裂

> ID：10321926
> 
> 赞同：1
> 
> 时间：2012-04-25T18:48:19.483
> 
> 标签：r, ggplot2

我想在中午为我的图表的每一天添加日轴标签。目前，它在午夜添加标签，但如果这些标签在每天的中间间隔，我更喜欢它，同时保留表示午夜的网格线。我尝试使用`hjust`，但结果看起来不太好。有没有办法做到这一点？

```
library(ggplot2)
library(scales)

dat <- data.frame(time_value=seq(as.POSIXct("2011-07-01"), length.out=24*30, by = "hours"),
                  usage_value=sample(1:10, 24*30, replace=TRUE),
                  group=1)
dat$week <- format(dat$time_value, '%W')
dat <- subset(dat, week == 27)

ggplot(dat, aes(x=time_value, y=usage_value, group=1)) + 
  scale_x_datetime(breaks='day', labels=date_format('%A')) +
  geom_line() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T18:55:16.413

这是一种方法。

首先，创建中午数据。这很容易使用`seq.Date`：

然后添加一个`geom_vline`到你的情节：

```
noon <- data.frame(
  x=with(dat, seq(from=min(time_value), to=max(time_value), by="1 day"))+12*60*60
)

ggplot(dat, aes(x=time_value, y=usage_value, group=1)) + 
  geom_line() +
  geom_vline(data=noon, aes(xintercept=x), col="blue") 
```

![在此处输入图像描述](../Images/d8a9467285e027ac2db66a000f7a2d51.png)

# c - 使用按位和位移位转换为二进制

> ID：10321928
> 
> 赞同：1
> 
> 时间：2012-04-25T18:48:30.933
> 
> 标签：c, bit-manipulation, bit-shift

我正在尝试创建一个函数来使用按位和位移打印二进制数字，但我无法正确打印它。以下是我的代码。

```
void PrintInBinary( unsigned int decNum )
{
    int i = 0;
    unsigned int highestOne = 1 << (sizeof(unsigned int)*8 - 1);

    for( i = 0; i < sizeof(int)*8; i++ ) {
         printf( "%u", decNum & (highestOne >> i) );
    }
    printf("\n");
}

int main()
{
    unsigned int a = 128;
    PrintInBinary( a );
    system("PAUSE");
    return 0;
} 
```

以下是输出：

```
0000000000000000000000001280000000 
```

基本上，它在每个位位置打印 2^bit 而不仅仅是 1（例如，如果我想将 7 转换为二进制，它将是 0000000...00421 而不是 0000000...00111）。这可能是我想念的微不足道的东西，但是有帮助吗？在过去的 20 分钟里，我一直在做这件事，无法弄清楚这么简单的事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T18:49:23.427

更改`decNum & (highestOne >> i)`为`(decNum & (highestOne >> i)) != 0`。

很多人也喜欢写作`!!(decNum & (highestOne >> i))`。我承认它很可爱，但它的可读性较差，我建议你不要使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T19:04:19.133

```
void PrintInBinary( unsigned int decNum )
{

    unsigned int bit;

    for( bit = 1u << (CHAR_BIT*sizeof bit -1); bit; bit >>= 1 ) {
         printf( "%c", decNum & bit ? '1' : '0' );
    }
    printf("\n");
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T18:52:02.763

采用

```
printf( "%u", decNum & (highestOne >> i) > 0 ? 1 : 0 ); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-25T18:58:07.197

这当然是马克建议的改变的一种方式，但我认为这种方式更具可读性：

```
unsigned int decNum = 7;

for(i = 0; i < sizeof(int)*8; i++ ) 
{
  printf("%u", ((decNum >> i) & 1));
}
printf("\n"); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-18T11:35:02.353

如果您希望保存 arr，我会推荐下一个功能：

让我们看看下一个获取 unsigned int decNum 并将其转换为二进制的函数：

```
/*#define BITS 8*/
int size = sizeof(unsigned int)*BITS;

char arr[size] ;

int i;
/* 
    now lets thinkk...

    shift by i=0 to the right:
    4 = 00...00 0100 &
    1 = 00...00 0001
    -----------------
        00...00 0000
    now we know that we need to enter 0 in the 1-rd place in the arr

    shift by i=1 to the right:
    4 = 00...00 0010 &
    1 = 00...00 0001
    -----------------
        00...00 0000
    now we know that we need to enter 0 in the 2-rd place in the arr

    shift by i=2 to the right:
    4 = 00...00 0001 &
    1 = 00...00 0001
    -----------------
        00...00 0001
    now we know that we need to enter 1 in the 3-rd place in the arr

    and so on...

 */
    for(i=0; i<size; ++i) {
         int shifted = (decNum >> i);
         arr[(size-1)-i] = (shifted&1)?'1':'0';
    }

printf("The binary of %d in %d bits:\n",decNum, size);

/*now lets print the array*/
for (i=0; i < size ; i++){
         printf("%c",arr[i]);
}
printf("\n"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-25T18:54:59.310

`decNum & (highestOne >> i)`只是进行评估。如果评估是`true`那么你应该打印`1`else 如果是`false`那么 print `0`。

```
decNum & (highestOne >> i) ? 1 : 0 
```

注意：OTOH，请避免使用像 8 这样的幻数

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-09-23T11:14:18.917

```
#include"stdio.h"
#include"conio.h"//this coding f

void main()
{
    int rm,vivek;
    clrscr();
    printf("enter the values");
    scanf("%d",&rm);
    printf("enter the no.of times moves");
    scanf("%d",&vivek);
    printf("the value rm=%d>>vivek=%doutput=%u",rm,vivek,rm>>vivek);//5>>1
    getch();
} 
```

# c++ - 具有标准偏差函数的链接器错误

> ID：10321929
> 
> 赞同：2
> 
> 时间：2012-04-25T18:48:34.653
> 
> 标签：c++, gcc, linker

我有以下功能（在 dm.cpp 中）

```
#include <iostream>
#include <iterator>
#include <vector>
#include <cmath>
#include <Eigen/Dense>
#include "dm.hpp";//calculateStdDev() is declared in the header

double calculateStdDev(const Eigen::VectorXf& input, unsigned int count, double& mean, double& variance, double& stddev) {
    double M = input(0);
    double Q = 0.0;
    for (unsigned int k = 1 ; k < count ; k++) {
        double del = input(k) - M;
        unsigned int j = k + 1;
        Q += k * (del * del) / j;
        M += del / j;
    }
    variance = Q / (count - 1);
    stddev = std::sqrt(variance);
    mean = M;
    return stddev;
} 
```

它在我的程序 test.cpp 中被调用，如下所示：

```
#include <iostream>
#include <iterator>

#include <Eigen/Dense>
#include "dm.hpp"
void regressor::operator()(void) {

    unsigned int rows;
    double meanR, varR, stddevR;
    Eigen::MatrixXf A(rows, cols);
    Eigen::VectorXf b(rows),res(rows);

    for (unsigned int k = 0 ; k < rows; k++) {
        for (unsigned int j = 0 ; j < cols ; j++) {
            A(k,j) = Xb[k][j];
        }
    }
    beta = A.jacobiSvd(Eigen::ComputeThinU | Eigen::ComputeThinV).solve(b);
    res = A * beta - b;

    calculateStdDev(res,rows,meanR,varR,stddevR);
} 
```

我收到以下错误：

```
In function `regressor::operator()()':
../../src/algo/test.cpp:55: undefined reference to `calculateStdDev(Eigen::Matrix<float, -1, 1, 0, -1, 1> const&, unsigned int, double&, double&, double&)'
collect2: ld returned 1 exit status 
```

我的操作系统是 ubuntu (v.10)，当在 cygwin 上运行完全相同的程序时，它可以工作。这是否意味着这是一个 GCC 问题。如果是这样，任何人都可以建议如何解决它。

编辑：我正在运行以下内容：

```
g++ test.cpp dm.cpp main.cpp -o et -lboost_date_time -lgsl -lgslcblas 
```

# android - TinyXML2 解析非常糟糕

> ID：10321930
> 
> 赞同：0
> 
> 时间：2012-04-25T18:48:35.487
> 
> 标签：android, iphone, xml, parsing, tinyxml

***编辑：我想通了，看看这个的下半部分***

在我提出问题之前，我将声明我已经成功使用了 TBXML 和 RapidXML。具体来说，Rapid 已经成功地解析了这个相同的文档。我熟悉 XML 读取和赋值。

也就是说，TinyXML 和 Cocos 似乎是一个很好的组合，因为它可以编译为 android。我可以去节点一次，打印出值，看看我在哪里......问题是这样的：

节点 = 节点->nextSibling();

总是返回假。我了解到我可以这样做：

节点->父（）->下一个兄弟（）；这将给我下一个兄弟姐妹。但这里有一个问题：

ParentNode->FirstChild() 将返回该树的第一个元素。但是如果我调用 ParentNode->NextSibling()，由于某种原因，它会返回一个指向兄弟节点的指针，除了它现在在树上更高一层。

这将使循环成为一场噩梦。

我正在搜索[http://grinninglizard.com/tinyxml2docs/classtinyxml2_1_1_x_m_l_node.html](http://grinninglizard.com/tinyxml2docs/classtinyxml2_1_1_x_m_l_node.html)以查找使用节点或元素样式（例如： NextSiblingElement() ）之间的差异，但充其量，我会遇到一个失败的循环，或者只是一个碰撞。

这个解析器不像其他解析器那样工作，或者我的约定错误。我到处都放置了 cout 以查看我在哪里，并且最初的运行似乎很好。具体来说 NextSibling 正在引起问题，我想我只是不知道他们“打算”使用的树结构。

这是我现在的嵌套循环：

```
 for( node = node->FirstChild(); node; node = node->NextSibling() )  {
            cout << endl << node->Parent()->Value();

            for( tempElement = node->FirstChildElement(); tempNode; tempElement = tempElement->NextSibling() ) {
                //assign inner values 
                }
           //take the inner values and assign them to an object
            } 
```

因此，虽然我的代码与遍历兄弟元素的所有建议相匹配，但它失败了。我可以从使用过它的人那里获得一些帮助，因为我在 30 分钟内使用其他系统所做的事情需要花费数小时。

另外，我相信一旦理解了“他们的方式”，它会更有意义，但我在互联网上找不到一个可行的例子。很多人建议我有示例代码（不工作）。

在大多数情况下，TinyXML 确实会找到节点和值，如果您记得要获取类型，则必须使用 node->Parent()->Value()，然后似乎不知道您在树中的位置太难。

只是为了踢，这是负载，它正在工作：

```
 if (doc.LoadFile(xmlFilePath.c_str()) == XML_SUCCESS)
{
    XMLNode *node = doc.RootElement();
    node = node->FirstChild(); //root 
 //.... 
```

感谢您的帮助！将不胜感激，也许是唯一一个 TinyXML2 问题，对未来的提问者有一个有效的答案，至少目前是这样。

* * *

编辑：我还不能回答，但我想通了：

为了爱......我希望我做错了什么，如果你这样做，请注意这种模式，它可以工作（TinyXML2 可能相同，我猜，只需用 XMLNode 替换 TiXmlNode）：

注意：节点是指根。

本质上，将 NextSibling 视为父级上的一个函数，它在其中布置“谁是下一个”。

感谢您迄今为止的访问。这至少遍历 6 个项目（外部项目，耶！），然后我确定我现在遇到的错误是我自己的。

如果其他人需要动态遍历树，这应该对某人有所帮助。

```
 TiXmlNode * subNode = node->FirstChild();

    for(subNode = node ; subNode; subNode = subNode->Parent()->NextSibling()) 
    {
        subNode = subNode->FirstChild();
    cout << endl << "Parent " << subNode->Parent()->Value() << endl;

        for( tempNode = subNode; tempNode; tempNode = tempNode->Parent()->NextSibling() )
        {
            tempNode = tempNode->FirstChild(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T17:09:41.883

The key is this line: Essentially, think of the NextSibling as a function on the parent, where it's laying out "who's next".

While every single XML Parser I've used before hand means "Sibling of current node", TinyXML says "Sibling of the child".

It seems completely natural once I get used to it, but it still throws me for a crashing loop.

Example code is in the bottom half of the post. This answer's existence is explained in the comments of such.

See you

# asp.net - 子目录 URL 自动重写规则？

> ID：10321945
> 
> 赞同：1
> 
> 时间：2012-04-25T18:50:02.383
> 
> 标签：asp.net, vb.net, iis-7, url-rewriting

我正在使用 ASP.NET 4 / VB.NET / IIS 来构建 Web 应用程序。人们将通过如下 URL 访问 Web 应用程序：

> [http://url.com/personname](http://url.com/personname)

例如，这里分别是 Jane Doe、John Doe 和 James Doe 的 url：

> [http://url.com/janedoe](http://url.com/janedoe)
> 
> [http://url.com/johndoe](http://url.com/johndoe)
> 
> [http://url.com/jamesdoe](http://url.com/jamesdoe)

我需要以某种方式将它们传递（无论输入什么名称）到 default.aspx 页面，然后该页面拉入 url 的名称部分并使用它对包含信息的数据库执行查找。关于这个特定的人，并显示基于该信息的个性化页面。

例如，Jane Doe 访问：

> [http://url.com/janedoe](http://url.com/janedoe)

她被透明地重定向到 default.aspx，它会提取她的名字（来自上面的 url）并对照数据库进行检查。看到她以前从未访问过该网站，她被透明地重定向到welcome.aspx，该网站要求她注册一个帐户，说：“你好，简！” 等等...

下次简访问时，她会去：

> [http://url.com/janedoe](http://url.com/janedoe)

她被透明地重定向到 default.aspx，它会提取她的名字（来自上面的 url）并对照数据库进行检查。看到她之前访问过并创建了一个帐户，她被透明地重定向到 login.aspx，要求她输入她上次创建的身份验证凭据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T07:11:15.527

首先，您需要将请求*重写*为 Default.aspx。根据您的 IIS 版本（以下适用于 IIS 7.5），这很简单。在 web.config 中，规则（在 system.webServer 部分中）类似于

```
<rewrite>
    <rules>
        <rule name="test" enabled="true" stopProcessing="false">
            <match url="^([a-zA-Z]*)$" />
            <action type="Rewrite" url="Default.aspx?u={R:1}" />
        </rule>
    </rules>
</rewrite> 
```

（或者您可以使用 IIS 管理器）。当然，正则表达式 [a-zA-Z] 应该适应您的业务规则 - 您可能希望允许数字。

这会重写 IIS 内的请求 - 在浏览器中看不到任何内容。现在你想“透明地重定向”它，这意味着浏览器中的 URL 应该根据用户是否已经存在而改变。

为此，在处理 Request.QueryString["u"] 后面的 Default.aspx 代码中，遵循

```
Response.Redirect("Welcome.aspx") or
Response.Redirect("Login.aspx") 
```

取决于数据库查询结果。如果您不想更改浏览器 URL，请使用 Server.Transfer 而不是 Response.Redirect。

# jquery - 配置 RoyalSlider JQuery 脚本以在 Shopify 上工作

> ID：10321947
> 
> 赞同：0
> 
> 时间：2012-04-25T18:50:12.633
> 
> 标签：jquery, image, gallery, shopify

我已经坚持了 2 天了，所以感谢您的帮助。我对此也很陌生。

我正在尝试在 Shopify 上安装 RoyalSlider JQuery 代码，但它似乎不起作用。我已将一些示例代码转换为 Shopify 脚本，但根本没有让滑块显示出来。

这就是我放在标题中的内容：

```
{{ 'stylesheet.css' | asset_url | stylesheet_tag }}
{{ 'SliderPreview.css.css' | asset_url | stylesheet_tag }}
{{ 'royal-slider-1.0.min.css' | asset_url | stylesheet_tag }}
{{ 'http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js' | script_tag }}
{{ 'jquery-1.5.1.min.js' | asset_url | script_tag }}
{{ 'jquery.easing.1.3.min.js' | asset_url | script_tag }}
{{ 'royal-slider-1.0.min.js' | asset_url | script_tag }} 
```

这就是我身体里的东西：

```
<script>    
        $(function() {  
            var defaultSlider = new RoyalSlider("#banner-rotator", {
                captionShowEffects:["moveleft", "fade"]             
            });
        });           
    </script>

    {{ page.content }}
    <script>       
    royalSlider.loadTheme('{{ 'royal-slider-1.0.min.js' | asset_url}}');        
        $('#banner-rotator').royalSlider({          
            imageAlignCenter:true,
            hideArrowOnLastSlide:true,
            slideshowEnabled: true,
            slideshowDelay:3000,
            slideshowPauseOnHover: true,
            slideshowAutoStart:true,
            slideTransitionSpeed:800,
            slideSpacing:0
        });     
    });
    </script> 
```

然后我把这个标签放在我希望滑块显示的任何页面上：

```
<div id="banner-rotator">
<a href="/"><img src="{{ 'banner.jpg' | asset_url | img_tag }}" alt="{{ bridal `}}"`/></a>`
</div> 
```

请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T15:19:01.793

RiyalSlider 现在升级到版本 8。它可能对您更有效： http: [//codecanyon.net/item/royalslider-touchenabled-jquery-image-gallery/461126](http://codecanyon.net/item/royalslider-touchenabled-jquery-image-gallery/461126)

# asp.net - ASP.NET 可互换函数

> ID：10321949
> 
> 赞同：0
> 
> 时间：2012-04-25T18:50:15.520
> 
> 标签：asp.net, function, modularity

想象一下，我有两个共享基本代码的站点。他们的大部分代码完全匹配，但有几个函数不匹配。例如，如果这两个站点在确定当前用户是否使用可接受的新 Web 浏览器时使用的方法不同会怎样。所以 isGoodBrowser() 返回 true 或 false，但站点有不同版本的这个函数。如何在保持其余代码相同的同时使这一功能可互换？我想在自己的文件中包含这样的功能。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T19:02:30.537

制作三个组件：

1.  包含所有共享代码的**程序集。**
2.  包含特定于第一个网站的功能的**程序**集。
3.  包含特定于**第二个**网站的功能的程序集。

从两个网站项目中引用通用程序集。

您甚至可以`isGoodBrowser()`在共享程序集中指定一个接口，并在特定于站点的程序集中以不同的方式实现它。然后手动或通过 IoC 容器（例如 Unity）注入适当的实现。

# javascript - 当用户完成输入时验证用户输入

> ID：10321950
> 
> 赞同：1
> 
> 时间：2012-04-25T18:50:19.133
> 
> 标签：javascript, jquery, forms

当用户完成输入时，验证用户输入文本字段的最佳方法是什么？我正在使用 javascript/jquery。有没有一种方法可以知道用户何时点击了文本字段？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T18:51:03.580

在文本字段上实现`onblur`事件处理程序，当用户切换到下一个字段时将触发该事件处理程序。

使用 jQuery，

```
$('.input_selector').on ('blur', function() {
    var inpValue = $(this).val();
    //validate Code
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-10T09:21:53.740

对于所有来这里寻找解决方案的人，请查看[此答案](https://stackoverflow.com/questions/4220126/run-javascript-function-when-user-finishes-typing-instead-of-on-key-up#5926782)。

基本上：

> 下面的解决方案解决了这个问题，并在完成后按照 OP 的要求调用 X 秒。它也不再需要多余的 keydown 功能。我还添加了一个检查，以便在您的输入为空时不会发生您的函数调用。

```
//setup before functions
var typingTimer;                //timer identifier
var doneTypingInterval = 5000;  //time in ms, 5 seconds for example

//on keyup, start the countdown
$('#myInput').keyup(function(){
    clearTimeout(typingTimer);
    if ($('#myInput').val()) {
        typingTimer = setTimeout(doneTyping, doneTypingInterval);
    }
});

//user is "finished typing", do something
function doneTyping() {
    //do something 
} 
```

最初发布此答案的人的所有功劳，只是复制以防有人到达这里（就像我一样）寻找解决方案。

# python - Pythonic，自定义警告

> ID：10321965
> 
> 赞同：19
> 
> 时间：2012-04-25T18:51:13.017
> 
> 标签：python, python-3.x, warnings

**基本问题：**制作我自己的自定义警告类最符合 Pythonic/逻辑的方式是什么？我应该继承哪些正确的警告和异常类？

**动机**：我正在编写的库的要求指定，如果一个`MyContainer`对象`c`包含一个项目`x`，并且库的调用者试图将一个“重复” `x`——调用它`y`——放入`c`，则会向调用者发出警告，并且的返回值`c.my_transformation_method(x, y)`被放入`c`替换`x`。换句话说，`MyContainer`s 将用它们的重复元素替换元素，但这样做时必须警告用户。

根据我的阅读，警告库调用者有关非致命操作的最灵活方法是使用[警告标准模块](http://docs.python.org/py3k/library/warnings.html)。它允许调用者在它认为合适的时候处理警告，做任何事情，从忽略警告到将它们视为错误。（请注意，我使用的是 Python 3，但我不认为这对这里的问题至关重要。）

**示例：**我所做的是定义了以下警告子类：

```
class DuplicateItemWarning(UserWarning, ValueError):
    pass 
```

然后在检测到尝试插入重复项时调用该`add()`方法。`MyContainer``warnings.warn('detected duplicate', DuplicateItemWarning)`

**具体问题：**

1.  我应该`UserWarning`像上面那样子类化，还是只是子类化`Warning`？

2.  如果调用者想要将警告视为错误，则子类`ValueError`（在上面的示例中，它仅插入`ValueError`到 MRO 之间`Warning`）在语义上似乎是明智的。`Exception`我没有看到这个有缺点吗？

3.  我在 StackOverflow 上找不到任何关于自定义警告类的问题。这是因为 Python 程序员甚至不喜欢使用该`warnings`模块吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-25T20:16:48.377

在阅读了关于警告框架和警告文档的[PEP 230](http://www.python.org/dev/peps/pep-0230/)之后，我想我已经回答了你的问题：

1.  `UserWarning`而所有其他都是警告类别，它们似乎除了分类之外没有其他作用。例如，通过这种方式，您可以在生产环境中将它们过滤掉。因此，基本上，`Warning`如果警告不属于任何其他类别，您可以从子类化。如果**在上下文中**，`UserWarning`或者`RuntimeWarning`看起来足够，就使用它们。

2.  `Warning`s已经`Exception`是s了。因此，从技术上讲，要将它们“捕获”为错误，您只需要更改过滤器，无需从任何`XXXError`. 现在，这一切都是为了有意义。如果警告与传递的值有关，您可以从子类`ValueError`化，特别是如果有许多不同的自定义警告，您会希望调用者一次“捕获”所有关于值的警告。

    ```
    try:
         # do something
    except MyCustomWarningOne:
        # do something else
    except MyCustomWarningTwo:
        # do something else also
    except ValueError: # or RuntimeWarning if you subclass from it
        # catch some other warning (both of these subclass from ValueError for example) 
    ```

3.  该`warnings`模块是 Guido van Rossum 的想法。（见 PEP 230）。如果这还不够 Pythonic ... :D

# objective-c - 滚动后的值在 UITableView 中显示

> ID：10321969
> 
> 赞同：0
> 
> 时间：2012-04-25T18:51:32.157
> 
> 标签：objective-c, ipad, uitableview, uilabel

在我的 iPad 应用程序中，我在标签上插入了一些值。该值也应该出现在另一个类的 UITableView 上。当我在标签中插入值并导航到另一个视图时，表格视图上没有出现任何值，但是当我向上滚动表格视图并到达其原始位置时，会出现该值。我该如何解决？

谢谢并恭祝安康

个人电脑

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:59:34.510

查看文档中的 reloadData 方法。您需要在更改值后调用此方法，以便表格知道重新加载当前正在显示的单元格。当您向上滚动时，单元格将被重绘，这就是您在滚动后看到新值的原因。

澄清一下，需要在 UITableView 对象上调用 reloadData 方法。

`[myTableView reloadData];`

从文档中：

重新加载接收器的行和部分。

`- (void)reloadData`

讨论

调用此方法可重新加载用于构建表格的所有数据，包括单元格、节页眉和页脚、索引数组等。为了提高效率，表格视图只重新显示那些可见的行。如果表因重新加载而缩小，它会调整偏移量。表视图的委托或数据源在它希望表视图完全重新加载其数据时调用此方法。不应在插入或删除行的方法中调用它，尤其是在通过调用 beginUpdates 和 endUpdates 实现的动画块中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T18:59:38.563

当您滚动表格时，您最终会重新加载数据，因为事情变得可见。如果您调用`[tableView reloadData]`viewillAppear 这应该会刷新标签并为您正确显示。

祝你好运！

# python - 从 PowerShell 运行 python 源文件

> ID：10321970
> 
> 赞同：4
> 
> 时间：2012-04-25T18:51:39.163
> 
> 标签：python, powershell

我正在尝试学习 python，但在从 power shell 运行源文件时遇到了一些问题。当我输入“python”时，它会打开，我可以直接在 shell 中输入 python 命令。我认为这称为交互模式。但是当我尝试运行/执行源文件时，我收到一条错误消息：它sayys：语法错误：无效语法。

当我尝试执行脚本时，我使用“python myfile.py”。

如果我从 IDLE 运行相同的文件，它就可以正常工作。安娜知道我做错了什么？

这是 myfile.py。我正在运行 python 2.7

```
 # filename: myfile.py

while True:
      s = raw_input('Enter something: ')
      if s == 'Quit':
          break
      print 'Lenght of the string is', len(s)
print 'Done' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T19:07:55.317

您可能安装了多个版本的 Python，并且 IDLE 使用的版本更新。要查看您拥有的 python 版本，您可以`>python -V`在命令行中键入。如果该版本看起来合适，那么您可能需要文件的完整路径作为第二个参数。例如`>python C:\myfile.py`。

如果你正确安装了 Python，那么只要输入脚本的名称，就有可能使用 python 运行它。例如`>myfile.py`

我总是发现添加`C:\Python27`到`%PATH%`变量和变量中可以更轻松`.PY`地`%PATHEXT%`运行脚本。在这种情况下`>myfile`应该可以工作。

**更新后编辑**：

仅在不带参数的情况下键入`>python`会以“交互模式”打开 python，这与脚本所针对的批处理或脚本模式不同。如果使用参数执行，则第一个参数将作为文件路径，而其他参数将传递给`sys.argv`列表中的脚本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T19:55:49.020

您需要将 Python 可执行文件的完整路径放在命令行中才能使其工作。您可以检查并确保您的 python exe 包含在您的路径中的系统变量中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T19:02:58.733

免责声明：我不知道 PowerShell，但我知道 cmd.exe。

我不知道为什么`python myfile.py`不工作，但假设 PowerShell 至少与 cmd.exe 有一些相似之处，以下应该可能工作：`myfile.py`. 没错，只需输入 Python 脚本的名称并回车即可。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-06T06:27:49.900

如果您从输入“ `python`”开始，`powershell`您将需要退出该脚本。

如果你是 python 类型：

`quit()` 然后输入 `python myfile.py`

如果您的 python 安装正确，这应该可以工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-23T17:36:35.737

尝试在 Powershell 中输入：

```
$env:path="$env:Path;C:\Python33 
```

在此之后，命令

```
python yourfile.py 
```

应该管用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-04-02T01:21:13.537

这听起来很傻，尤其是来自初学者。

只需将文件保存在桌面上即可。打开powershell并将文件直接拖到powershell中即可打开。有点乏味，但它有效

# jquery - 使代码更健壮（jquery）

> ID：10321973
> 
> 赞同：1
> 
> 时间：2012-04-25T18:51:48.560
> 
> 标签：jquery

请查看整个代码，如果您将其复制并粘贴到您的 html 中，那么应该可以正常工作。

正如您在下面的代码中看到的那样，我必须为每个操作（jquery，css）创建两组代码，而我想要实现的是，我只需要为下面的所有操作创建一组代码.. .

我不太担心点击事件，实际上我希望有两个单独的点击事件。`$("#button").click(function(){...}`,`$("#button1").click(function(){...}`

**更新：**

html:

```
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>yensdesign.com - How to create a stuning and smooth popup in jQuery</title>
    <link rel="stylesheet" href="general.css" type="text/css" media="screen" />
    <script src="http://jqueryjs.googlecode.com/files/jquery-1.2.6.min.js" type="text/javascript"></script>
    <script src="popup.js" type="text/javascript"></script>
</head>
<body>
    <center>
        <div id="button">
            <input type="submit" value="button" /></div>
        <div id="button1">
            <input type="submit" value="button1" /></div>
    </center>
    <div id="popupContact">
        <a id="popupContactClose">x</a>
        <h1>
            Title of our cool popup, yay!</h1>
        <p id="contactArea">
            Here we have a simple but interesting sample of our new stuning and smooth popup. 
        </p>
    </div>
    <div id="popupContact1">
        <a id="popupContactClose1">x</a>
        <h1>
            one more, yay!</h1>
        <p id="contactArea1">
            Here we have a simple but interesting sample of our new stuning and smooth popup. 
        </p>
    </div>
    <div id="backgroundPopup">
    </div>
    <div id="backgroundPopup1">
    </div>
</body>
</html> 
```

**jQuery：**

```
var popupStatus = 0;
var popupStatus1 = 0;

//loading popup with jQuery magic!
function loadPopup(){
    //loads popup only if it is disabled
    if(popupStatus==0){
        $("#backgroundPopup").css({"opacity": "0.7" });
        $("#backgroundPopup").fadeIn("slow");
        $("#popupContact").fadeIn("slow");
        popupStatus = 1;
    }
}

//loading popup with jQuery magic!
function loadPopup1() {
    //loads popup only if it is disabled
    if (popupStatus == 0) {
        $("#backgroundPopup1").css({ "opacity": "0.7" });
        $("#backgroundPopup1").fadeIn("slow");
        $("#popupContact1").fadeIn("slow");
        popupStatus1 = 1;
    }
} 

//disabling popup with jQuery magic!
function disablePopup(){
    //disables popup only if it is enabled
    if(popupStatus==1){
        $("#backgroundPopup").fadeOut("slow");
        $("#popupContact").fadeOut("slow");
        popupStatus = 0;
    }
}

//disabling popup with jQuery magic!
function disablePopup1(){
    //disables popup only if it is enabled
    if(popupStatus1==1){
        $("#backgroundPopup1").fadeOut("slow");
        $("#popupContact1").fadeOut("slow");
        popupStatus1 = 0;
    }
} 

//centering popup
function centerPopup(){
    //request data for centering
    var windowWidth = document.documentElement.clientWidth;
    var windowHeight = document.documentElement.clientHeight;
    var popupHeight = $("#popupContact").height();
    var popupWidth = $("#popupContact").width();
    //centering
    $("#popupContact").css({
        "position": "absolute",
        "top": windowHeight/2-popupHeight/2,
        "left": windowWidth/2-popupWidth/2
    });
    //only need force for IE6

    $("#backgroundPopup").css({
        "height": windowHeight
    });
}

//centering popup
function centerPopup1() {
    //request data for centering
    var windowWidth = document.documentElement.clientWidth;
    var windowHeight = document.documentElement.clientHeight;
    var popupHeight = $("#popupContact1").height();
    var popupWidth = $("#popupContact1").width();
    //centering
    $("#popupContact1").css({
        "position": "absolute",
        "top": windowHeight / 2 - popupHeight / 2,
        "left": windowWidth / 2 - popupWidth / 2
    });
    //only need force for IE6

    $("#backgroundPopup1").css({
        "height": windowHeight
    });

}

//CONTROLLING EVENTS IN jQuery
$(document).ready(function()
{
    //LOADING POPUP
    //Click the button event!
    $("#button").click(function(){
        //centering with css
        centerPopup();
        //load popup
        loadPopup();
    });

    $("#button1").click(function () {
        //centering with css
        centerPopup1();
        //load popup
        loadPopup1();
    });

    //CLOSING POPUP
    //Click the x event!
    $("#popupContactClose").click(function(){
        disablePopup();
});
//Click the x event!
$("#popupContactClose1").click(function () {
    disablePopup1();
});

//Click out event!
    $("#backgroundPopup").click(function(){
        disablePopup();
});

$("#backgroundPopup1").click(function () {
    disablePopup1();
});

    //Press Escape event!
    $(document).keypress(function(e){
        if(e.keyCode==27 && popupStatus==1){
            disablePopup();
        }
        if(e.keyCode==27 && popupStatus1==1){
            disablePopup1();
        }
    });

}); 
```

**css**

```
#backgroundPopup{
display:none;
position:fixed;
_position:absolute; /* hack for internet explorer 6*/
height:100%;
width:100%;
top:0;
left:0;
background:#000000;
border:1px solid #cecece;
z-index:1;
}
#backgroundPopup1{
display:none;
position:fixed;
_position:absolute; /* hack for internet explorer 6*/
height:100%;
width:100%;
top:0;
left:0;
background:#000000;
border:1px solid #cecece;
z-index:1;
}
#popupContact{
display:none;
position:fixed;
_position:absolute; /* hack for internet explorer 6*/
height:384px;
width:408px;
background:#FFFFFF;
border:2px solid #cecece;
z-index:2;
padding:12px;
font-size:13px;
}
#popupContact1{
display:none;
position:fixed;
_position:absolute; /* hack for internet explorer 6*/
height:384px;
width:408px;
background:#FFFFFF;
border:2px solid #cecece;
z-index:2;
padding:12px;
font-size:13px;
}
#popupContact h1{
text-align:left;
color:#6FA5FD;
font-size:22px;
font-weight:700;
border-bottom:1px dotted #D3D3D3;
padding-bottom:2px;
margin-bottom:20px;
}
#popupContact1 h1{
text-align:left;
color:#6FA5FD;
font-size:22px;
font-weight:700;
border-bottom:1px dotted #D3D3D3;
padding-bottom:2px;
margin-bottom:20px;
}
#popupContactClose{
font-size:14px;
line-height:14px;
right:6px;
top:4px;
position:absolute;
color:#6fa5fd;
font-weight:700;
display:block;
}
#popupContactClose1{
font-size:14px;
line-height:14px;
right:6px;
top:4px;
position:absolute;
color:#6fa5fd;
font-weight:700;
display:block;
}
#button{
text-align:center;
margin:100px;
}
#button1{
text-align:center;
margin:100px;
} 
```

结束更新

我正在关注这个[博客](http://yensdesign.com/2008/09/how-to-create-a-stunning-and-smooth-popup-using-jquery/)，但有一件事让我感到困惑，我创建了两个链接以使这两个单独的链接正常工作，我必须在 jquery 和 css 中添加两次相同的代码......但我在想那里应该是这样做的更好方法......重复的代码只是名称差异。

我已经添加了代码的核心，所以为了让我的 button1 工作，我必须添加两次相同的代码，如下所示，只是名称 diff

```
 <div id="button"><input type="submit" value="Press me please!" /></div>
    <div id="button1"><input type="submit" value="Press one more time!" /></div>

   <div id="popupContact">
        <a id="popupContactClose">x</a>
        <h1>Title of our cool popup, yay!</h1>
        <p id="contactArea">
            Here we have a simple but interesting sample 
        </p>
    </div> 
```

jquery的源代码是：

```
$("#backgroundPopup1").css({
        "opacity": "0.7"
    });
    $("#backgroundPopup1").fadeIn("slow");
    $("#popupContact1").fadeIn("slow"); 
```

.css

```
#popupContact  {
display:none;
position:fixed;
_position:absolute; /* hack for internet explorer 6*/
height:384px;
width:408px;
background:#FFFFFF;
border:2px solid #cecece;
z-index:2;
padding:12px;
font-size:13px;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T18:57:10.457

如果需要从不同元素的点击事件中执行类似的函数，可以定义一个函数，然后复用：

```
var myPopupFn = function($this){
  //do something to the element that is passed in
  $this.css({/* etc */});
}

$("#button1").click(function(){
   myPopupFn($(this));
});

$("#button2").click(function(){
   myPopupFn($(this));
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T18:54:41.370

从您提供的 jQuery 代码中，我建议的唯一改进是使用链接

```
$("#backgroundPopup1").css({ "opacity": "0.7"}).fadeIn("slow");
$("#popupContact1").fadeIn("slow"); 
```

为了避免重复代码为许多元素绑定相同的功能，您可以像这样只绑定一次

```
$(function(){

  $("#btnSave,#btnSaveMore").click(function(e){
    //do your stuff here
  });

}); 
```

这将应用于 2 个具有 id`btnSve`和`btnSaveMore`

**编辑：根据更新的问题。**

所以你有 2 个按钮的重复代码。让我们像这样重写它。

让我们对您的 HTML 标记进行一些更改。我们将为按钮提供 ID 以识别正在单击的按钮。

```
<input id="btn-1" type="submit" value="button" /></div>
<input id="btn-2" type="submit" value="button1" /></div>

<div id="popupContact1"></div>
<div id="popupContact2"></div>
<div id="backgroundPopup1"></div>
<div id="backgroundPopup2"></div> 
```

现在让我们转到javascript，

```
$(document).ready(function(){

   $("input[type='submit']").click(function(){
       var id=$(this).attr("id").split("-")[1]; //this will give us either 1 or 2 
       CenterPopup(id);
       LoadPopup(id)
   });    
});
var popupStatus = 0;
function CenterPopup(itemId)
{
  var item=$("#popupContact"+itemId);
  var windowWidth = document.documentElement.clientWidth;
  var windowHeight = document.documentElement.clientHeight;
  var popupHeight = item.height();
  var popupWidth = item.width();

  item.css({"position": "absolute",
      "top": windowHeight/2-popupHeight/2,
      "left": windowWidth/2-popupWidth/2
   });   
  $("#backgroundPopup"+itemId).css({
     "height": windowHeight
  });

}

function LoadPopup(itemId)
{     
 if(popupStatus==0){
    var item=$("#backgroundPopup"+itemId)
    item.css({"opacity": "0.7" });
    item.fadeIn("slow");
    $("#popupContact"+itemId).fadeIn("slow");
    popupStatus = 1;
  }
} 
```

工作演示 [http://jsfiddle.net/3FbbC/7/](http://jsfiddle.net/3FbbC/7/)

这应该适用于您提到的布局和 javascript 代码。但我真的不明白为什么你需要 2 个 div 用于相同的目的（popContact1 和 poupContact2）。由于我不确定您的整个页面目标，因此我无法告诉您更好的模式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T19:04:17.753

如果除了名称不同之外，其他所有内容都相同，请使用类选择器而不是 ID 选择器。

```
<a class="myLink" id="Link1" >Link1</a>
<a class="myLink" id="Link2" >Link1</a> 
```

**JS：**

```
$(function () {
   $('.myLink').click (function (e) {            
       $(this).css(/*{...}*/);
       //... Your code
       return false;
   });
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T18:58:53.580

在这种情况下，我会做的是创建一个只接受两个参数（您的 ID）的函数。

```
function whatever(id1, id2) {
    $("#"+id1).css({ "opacity": "0.7"}).fadeIn("slow");
    $("#"+id2).fadeIn("slow");
} 
```

然后使用：

```
whatever("backgroundPopup1", "popupContact1");
whatever("backgroundPopup2", "popupContact2"); 
```

这使其更具可重用性并提高了鲁棒性。

# css - 为什么我的 CSS3 盒子阴影不能正常工作？

> ID：10321975
> 
> 赞同：1
> 
> 时间：2012-04-25T18:51:50.060
> 
> 标签：css

我正在使用最新版本的 Chrome，当我使用圆角时，我根本无法在我的 div 上正确显示框阴影。它看起来像被切断或其他东西，请看下面的截图：

![在此处输入图像描述](../Images/c266209589e4bd2e73f9808d75cee23a.png)

[您可以在http://chronologic.ath.cx/Gardner/](http://chronologic.ath.cx/Gardner/)上查看测试站点

谢谢，

斜线

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-25T18:54:47.040

您的 CSS 重置包含`overflow: hidden`导致您`div.container`剪辑阴影的样式。您应该删除它，因为我在选择器中看不到任何值得将这样的溢出应用于：

```
html,
div,
span,
head,
h1,
h2,
h3,
h4,
h5,
h6,
p,
blockquote,
a,
font,
img,
small,
strong,
ol,
ul,
li {
    margin: 0;
    padding: 0;
    border: 0;
    outline: 0;
    font-size: 100%;
    background: transparent;
    overflow: hidden;
} 
```

# python - 整数到位域作为列表

> ID：10321978
> 
> 赞同：17
> 
> 时间：2012-04-25T18:52:15.440
> 
> 标签：python, list, bit-fields

我创建了一种将 an 转换`int`为位域（在列表中）的方法并且它可以工作，但我确信有更优雅的解决方案 - 我已经盯着它很久了。

我很好奇，您如何将 a 转换`int`为 a 中表示的位域`list`？

```
def get(self):
    results = []

    results.append(1 if (self.bits &   1) else 0)
    results.append(1 if (self.bits &   2) else 0)
    results.append(1 if (self.bits &   4) else 0)
    results.append(1 if (self.bits &   8) else 0)
    results.append(1 if (self.bits &  16) else 0)
    results.append(1 if (self.bits &  32) else 0)
    results.append(1 if (self.bits &  64) else 0)
    results.append(1 if (self.bits & 128) else 0)

    return results

def set(self, pin, direction):
    pin -= 1
    if pin not in range(0, 8): raise ValueError

    if direction: self.bits |= (2 ** pin)
    else: self.bits &=~(2 ** pin) 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-04-25T18:54:57.060

这个怎么样：

```
def bitfield(n):
    return [int(digit) for digit in bin(n)[2:]] # [2:] to chop off the "0b" part 
```

这给你

```
>>> bitfield(123)
[1, 1, 1, 1, 0, 1, 1]
>>> bitfield(255)
[1, 1, 1, 1, 1, 1, 1, 1]
>>> bitfield(1234567)
[1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1] 
```

不过，这只适用于正整数。

**编辑：**

转换为`int`使用`int()`在这里有点矫枉过正。这要快得多：

```
def bitfield(n):
    return [1 if digit=='1' else 0 for digit in bin(n)[2:]] 
```

看时间：

```
>>> import timeit
>>> timeit.timeit("[int(digit) for digit in bin(123)[2:]]")
7.895014818543946
>>> timeit.timeit("[123 >> i & 1 for i in range(7,-1,-1)]")
2.966295244250407
>>> timeit.timeit("[1 if digit=='1' else 0 for digit in bin(123)[2:]]")
1.7918431924733795 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-04-25T19:02:52.113

这不使用`bin`：

```
 b = [n >> i & 1 for i in range(7,-1,-1)] 
```

这就是如何以这种方式处理任何整数：

```
 b = [n >> i & 1 for i in range(n.bit_length() - 1,-1,-1)] 
```

见[`bit_length`](https://docs.python.org/3/library/stdtypes.html#int.bit_length)。

如果您希望列表的索引0对应于int的lsb，请更改范围顺序，即

```
b = [n >> i & 1 for i in range(0, n.bit_length()-1)] 
```

另请注意，如果您尝试表示固定长度的二进制值，则使用 n.bit_length() 可能会导致失败。它返回表示 n 的最小位数。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-25T19:01:13.947

尝试

```
>>>n=1794
>>>bitfield=list(bin(n))[2:]
>>>bitfield
['1', '1', '1', '0', '0', '0', '0', '0', '0', '1', '0'] 
```

这对负 n 不起作用，如您所见，为您提供了一个字符串列表

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-11-29T17:03:54.770

不适用于负值

```
>>> import numpy as np
>>> [int(x) for x in np.binary_repr(123)]
[1, 1, 1, 1, 0, 1, 1] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-11-25T06:54:20.187

## 固定长度的数组

固定长度的数组：

```
>>> '{0:07b}'.format(12)
'0001100' 
```

你相信字符串也是一个数组吗？不？看：

```
>>> [int(x) for x in '{0:07b}'.format(12)]
[0, 0, 0, 1, 1, 0, 0] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-05-26T04:40:19.797

我正在为我的程序执行此操作，您可以在其中指定模板以从 int 获取值：

```
def field(template, value):
    sums = [int(v) if v.__class__==str else len(bin(v))-2 for v in template]
    return [(value>> (sum(sums[:i]) if i else 0) )&(~(~0<<int(t)) if t.__class__==str else t) for i,t in enumerate(template)] 
```

**如何**
在模板中使用，指定与您的位大小相关的整数：

```
field([0b1,0b111,0b1111], 204) #>>> [0, 6, 12] 
```

或者您可以使用字符串指定所需的每个值的位大小：（noob 友好）

```
field(['1','3','4'], 204) #>>> [0, 6, 12] 
```

编辑：反之亦然：（单独的代码）

```
field(['1','3','4'], [0, 6, 12]) #>>> 204
field([0b1,0b111,0b1111], [0,3,9]) #>>> 150 
```

编码：

```
def field(template, value):
    res = 0
    for t, v in zip(template, value)[::-1]: res = (res << (t.bit_length() if t.__class__ is int else int(t)) )|v
    return res 
```

EDIT2：更快的代码^

# iframe - MVC 4 - Razor - “从客户端检测到潜在危险的 request.form 值”

> ID：10321983
> 
> 赞同：5
> 
> 时间：2012-04-25T18:52:35.103
> 
> 标签：iframe, razor, asp.net-mvc-4, form-post

我的视图上有一个链接到外部站点的 i-Frame。该站点接受一些值和一些配置设置。作为这些配置设置的一部分是“CallBackURL”。此外部网站发布到此 CallBackUrl。

我将 CallBackURL 指定为对我的控件执行的操作。

查看代码

```
<form id="testForm" method="post" target="testFrame">
  <input type="hidden" name="RequestXML" ID="RequestXML" value="<Request><RedirectURL>Account/TokenRequest</RedirectURL></Request>"
</form>

<iframe id="testFrame" name="testFrame" frameborder="0" style="width:1000px;height:500px"></iframe> 
```

控制器代码

```
 [HttpPost]
  [ValidateInput(false)]
  public ActionResult TokenRequest()
  {
    if (Request.Form["ResponseXML"] != null)
      ViewBag.ResponseXML = Request.Form["ResponseXML"];

    return PartialView();
  } 
```

在我的控制器操作中，我收到以下错误：“从客户端检测到潜在危险的 request.form 值”

我也在 webconfig 中设置了这个

```
<httpRuntime requestValidationMode="2.0" />
<pages validateRequest="false"... 
```

我究竟做错了什么？

**编辑** 我正在编辑错误的 web.config 文件。我将它添加到视图文件夹内的 web.config 中。一旦我将其更改为正确的位置，它就开始工作了。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-03T09:04:23.757

上述解决方案在 MVC4 中对我不起作用。对我有用的只是在动作上方放置一个属性。无需更改您的 web.config 或添加 AllowHtml 属性。

```
[HttpPost]
[ValidateInput(false)]
public ActionResult TokenRequest(TokenRequestModel model)
{
  if (!string.IsNullOrEmpty(model.ResponseXML))
  ViewBag.ResponseXML = model.ResponseXML;
  // ... 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-09T10:15:32.537

尝试使用模型而不是直接使用 html 控件。并且还使用 AllowHtml 属性。

模型：

```
public TokenRequestModel
{
   [AllowHtml]
   public string ResponseXML {get;set;}
} 
```

行动：

```
[HttpPost]
public ActionResult TokenRequest(TokenRequestModel model)
{
  if (!string.IsNullOrEmpty(model.ResponseXML))
      ViewBag.ResponseXML = model.ResponseXML;

  return PartialView();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-06-12T09:20:03.197

你可以试试

```
 [HttpPost]
  public ActionResult TokenRequest()
  {
    if (Request.Unvalidated().Form["ResponseXML"] != null)
      ViewBag.ResponseXML = Request.Unvalidated().Form["ResponseXML"];

    return PartialView();
  } 
```

我认为 Unvalidated() 将使错误消失而无需编辑 webconfig

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-10-04T08:04:33.850

我试过这个并为我工作：

在表单提交上调用一个 javascript 函数，该函数将使用“encodeURIComponent”编码的值保存在隐藏字段中。

然后在同一个函数中清除具有危险值的文本框的值。这样，表单将只提交编码值。

```
<input type="submit" value="Save" class="btn btn-danger" onclick="encodeLabel1()" />

<script>
function encodeLabel1() {
            var label = $('#txt').val();
            $('#hfLabel1Encoded').val(encodeURIComponent(label));
            $('#txt').val('');
        }
 </script> 
```

这是一种解决方法，但它有效并且验证仍然有效。

# javascript - 使用 ajax 更新元素时 JavaScript 页面跳转

> ID：10321988
> 
> 赞同：0
> 
> 时间：2012-04-25T18:52:53.037
> 
> 标签：javascript, ajax

我有一个垂直适合窗口的页面。当用户单击链接时，我通过 ajax 获得另一个页面并将其插入所需的元素。一切正常，但是当用户点击另一个链接时，页面会跳起来，这让我很烦。我试过使用

```
<a href="#" onClick="showRoom('five');return false;" class="highlight">
//and
<a href="javascript:void(0);" onClick="showRoom('five');return false;" class="highlight"> 
```

它在 IE 和 Firefox 中都不起作用 - 它继续跳跃。

有什么好的工作技巧可以提供帮助吗？

我认为它必须与更新有关。当我单击链接时 - 首先，显示加载图标。只有这样，当报告表可用时，它才会加载到而不是图标中。因此，浏览器在显示信息时添加了滚动条，但在报告切换之间消失并被小 LOADING 图标取代。

我认为我需要在单击更新链接时捕获滚动条位置，然后，在 ajax 更新页面后，我需要调用另一个函数来滚动回以前的滚动条位置

这就是我“解决”问题的方式，直到找到真正的解决方案：

```
document.getElementById(showCoursesArea).innerHTML= '<center><img src=\"images/working.gif\"><h1><br><h1><br><h1><br><h1><br><h1><br><h1><br></center>'; 
```

几乎它让我的页面很长；因此 ajax 更新非常适合。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T18:56:17.040

当您单击一个链接时，`href="#"`它实际上是链接到文档的顶部。您实际上可以完全删除该`href`属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T18:56:59.203

'#' 会将用户带回页面顶部，所以我通常使用 void(0)。或者，如果您说第二个选项也不起作用，则删除 href 并尝试

或者只是尝试

```
<a href="javascript:myJsFunc()">Link Text</a> 
```

或者

```
<a onclick="javascript:myJsFunc()">Link Text</a> 
```

或者

```
<a href="#0" onclick="myJsFunc()">Link Text</a> 
```

因为 id "0" 永远不会出现在页面上，所以什么也不会发生。

# vim - Vim 跳过花括号内的空格

> ID：10321990
> 
> 赞同：1
> 
> 时间：2012-04-25T18:53:20.707
> 
> 标签：vim, vi

可以说，我在 vim 中写了这段 LaTeX：

```
A_{\vec B}_
          ^
         Cursor 
```

光标在标记的位置。现在我想`\vec`在 A 前面添加一个。

我试过了，`<Esc>Bi\vec <Esc>WW`但我想跳过花括号内的空格。`B``W`

任何想法如何做到这一点？

编辑：也许我应该写，我想把它映射到一个快捷方式。`A`并且`B`只是不包含空格的字符串的示例。

解决方案：我想我已经找到了，我正在寻找的东西。您可以使用`?`正则表达式进行向后搜索。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T19:11:54.643

您不能将大括号字符串创建`B`或`W`视为 Word，但您可以使用`%`它从大括号字符串的一端跳转到另一端。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T19:01:50.437

`FAi\vec``ESC``$`

它是否假设 B 真的在行尾

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T19:07:05.643

有几种方法可以完成类似的工作。`W`并且`B`只停在空格处，据我所知，所以你可以在单词之间跳转两次`2B`，或者在开头设置插入模式`I`，或者搜索一个字母，使用`f`，或。也可以直接到开头或结尾。有很多可能性。我希望其中一个可以有用。`F``t``T``0``$`

# ios - Xcode 中的警告不会消失！（文件保护的权利）

> ID：10321995
> 
> 赞同：1
> 
> 时间：2012-04-25T18:53:36.963
> 
> 标签：ios, xcode, code-signing, code-signing-entitlements

嘿，刚成为一名新的 iOS 开发人员，到目前为止一切都很好，但我的 .xcodeproj 文件在 Xcode 中有一个警告，上面写着“验证项目设置 - 更新到推荐的设置”。当我点击它时，我会看到一个窗口，上面写着“目标'（我的应用程序名称）' - 升级 DataProtectionClass 权利。将您的应用程序的默认文件保护级别升级到推荐值：NSFileProtectionComplete。” 所以我继续并单击执行更改以便它可以执行此操作并且警告消失但是当我尝试在设备上调试时我收到错误“您的应用程序的代码签名权利文件中指定的权利与您的供应中指定的权利不匹配配置文件。（0xE8008016）。

如果我删除了将默认文件保护升级到 NSFileProtectionComplete 的 entitlemnets 文件，那么 Xcode 中的警告消失了，它能够在设备上编译和运行，但是我遇到了 xcode 中出现警告的问题不想让步。

这也发生在一个全新的项目中。我在 OS X 10.8 Mountain Lion DP3 (12A178q) 上运行 Xcode 版本 4.4 (4F134)。

在终端中，我继续查看我的 .mobileprovision 文件的权利。（不是通配符，而是具有特定应用程序ID的那个）

```
security cms -D -i /pathto.mobileprovision 
```

我得到了 Entitlements 键的这个值。

```
 <key>Entitlements</key>
 <dict>
      <key>application-identifier</key>
      <string>GLAMURY37G.com.ionescuac.GPS-Status-</string>
      <key>get-task-allow</key>
      <true/>
      <key>keychain-access-groups</key>
      <array>
           <string>GLAMURY37G.*</string>
      </array>
 </dict> 
```

当我在 xcode 中构建应用程序以进行调试配置时，我继续查看它的权利

```
codesign -d --entitlements - /pathtoapplication.app 
```

并得到了这个

```
<dict>
     <key>application-identifier</key>
     <string>GLAMURY37G.com.ionescuac.GPS-Status-</string>
     <key>get-task-allow</key>
     <true/>
     <key>keychain-access-groups</key>
     <array>
          <string>GLAMURY37G.com.ionescuac.GPS-Status-</string>
     </array>
</dict> 
```

并且它匹配，因此 xcode 可以在设备上运行应用程序。但是，xcode 告诉我升级到 FileProtectionComplete，所以我这样做了，然后在构建我的应用程序并再次检查应用程序的权利之后，这就是我得到的。

```
<dict>
     <key>DataProtectionClass</key>
     <string>NSFileProtectionComplete</string>
     <key>application-identifier</key>
     <string>GLAMURY37G.com.ionescuac.GPS-Status-</string>
     <key>get-task-allow</key>
     <true/>
</dict> 
```

这使它不再匹配，所以我在第一篇文章中得到了错误。如果我使用 FileProtectionComplete 权利对其进行签名，则 xcode 不会发出警告，但它不能再运行了。如果我在没有权利的情况下构建它，那么它会运行，但 xcode 会一直用这个警告来唠叨我，说 FileProtection 权利应该升级到它们的“推荐设置”。

有点陷入了第22条的情况。在我加入开发者计划之前，我在模拟器上搞砸了很多东西，并且从来没有遇到过任何关于 xcode 的权利问题，说需要将它们添加到构建中。

# php - Mysql 查询 - 尝试创建带有评论的 twitter 类型时间线

> ID：10321998
> 
> 赞同：2
> 
> 时间：2012-04-25T18:53:54.380
> 
> 标签：php, mysql

我正在尝试使用 PHP 和 MYSQL 实现带有评论的 twitter 类型提要，即

```
Tweet1
  - Comment1 about Tweet1
  - Comment2 about Tweet1
Tweet2
  - Comment1 about Tweet2
  - Comment2 about Tweet2
  - Comment3 about Tweet2
Tweet3
  - Comment1 about Tweet3 
```

我成功地通过每条推文下方的相关评论循环出“推文”。但是我的问题是，它会循环播放我对该特定推文的每条评论的“推文”，即

```
tweet 1
  -comment 1 about tweet1
tweet 1
  -comment 1 about tweet 1
  -comment 2 about tweet 1 (Tweet 1 has 2 comments so loops out tweet 1 two times)
tweet 2
  -comment 1 about tweet 2
tweet 2
  -comment 1 about tweet 2
  -comment 2 about tweet 2
tweet 2
  -comment 1 about tweet 2
  -comment 2 about tweet 2
  -comment 3 about tweet 2 (Tweet 2 has 3 comments so loops out tweet 2 three times) 
```

我认为问题出在我的 join mysql 查询上，因为我刚开始使用连接

```
"SELECT tweets.accountno, tweets.id,tweets.tweet,tweets.createdat,tweets.userid,users.name,users.avatar,users.biog,comments.comment FROM tweets INNER JOIN users ON tweets.userid = users.id JOIN comments ON tweets.id = comments.tweetid WHERE tweets.accountno ='123456' ORDER by tweets.ID DESC LIMIT 20" 
```

有什么想法吗？非常感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T19:04:31.690

添加一个`GROUP BY tweets.id`，你应该没问题。

这是我编写 SQL 语句的方式，为简单起见，我删除了显式 JOIN 语句，我使用的是隐式语句

```
SELECT 
    tweets.accountno, 
    tweets.id,
    tweets.tweet,
    tweets.createdat,
    tweets.userid,
    users.name,
    users.avatar,
    users.biog,
    comments.comment 
FROM 
    tweets, users, comments
WHERE
    tweets.userid = users.id
AND
    tweets.id = comments.tweetid 
AND
    tweets.accountno ='123456' 
GROUP BY
    tweets.id
ORDER BY
    tweets.id
DESC 
LIMIT
    20 
```

# jquery - 使用 jQuery 从 Web 应用程序中的 Web 站点访问 asp.net 网页

> ID：10321999
> 
> 赞同：0
> 
> 时间：2012-04-25T18:54:00.947
> 
> 标签：jquery, asp.net, asp.net-ajax

我创建了新的 Web 应用程序，它包含 index.aspx。另一个网站可用。我已将 Web 应用程序引用添加到网站中。现在我想使用 jquery ajax 调用访问网站中的 index.aspx。是否可以访问相同的。在此先感谢所有帮助。

谢谢

木头

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:59:33.387

我不确定这正是您要问的，但如果您只想使用 jQuery 从另一个网站的页面调用 index.aspx 页面，您只需执行以下操作：

```
$.get("http://www.mydomain.com/index.aspx", function(data){
  alert("Data Loaded: " + data);
  // do something with markup returned from your index.aspx
}); 
```

希望这可以帮助。如果这不能回答您的问题，您可以尝试澄清您的问题。