# StackOverflow 问答 000370000-000370999

# c# - c#中泛型类型的默认值

> ID：370001
> 
> 赞同：61
> 
> 时间：2008-12-15T22:59:14.537
> 
> 标签：c#, generics, default-value

[Dictionary.TryGetValue](http://msdn.microsoft.com/en-us/library/bb347013.aspx)的文档说：

> 当此方法返回时，[value 参数] 包含与指定键关联的值，如果找到该键；否则**为 value 参数类型的默认值**。此参数未初始化传递。

我需要在课堂上模仿这一点。*如何找到类型 T 的默认值？*

* * *

如何修改此问题以使其显示在搜索中？

[返回默认值](https://stackoverflow.com/questions/367378/returning-a-default-value-c)的完全重复。[（C＃）](https://stackoverflow.com/questions/367378/returning-a-default-value-c)

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2008-12-15T23:01:56.513

你正在寻找这个：

```
default(T); 
```

所以：

```
public T Foo<T>(T Bar)
{
   return default(T);
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-15T23:01:10.837

```
default(T); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-15T23:02:25.607

使用[默认](http://msdn.microsoft.com/en-us/library/xwth0h0d(VS.80).aspx)关键字：

```
T t = default(T) 
```

# java - Java中字符串转换的简单属性

> ID：370004
> 
> 赞同：3
> 
> 时间：2008-12-15T23:00:57.577
> 
> 标签：java, string, encoding

使用 Java，我需要对名称值对的 Map<String, String> 进行编码以存储到字符串中，并能够再次对其进行解码。这些将存储在数据库列中，并且可能通常很简短，因此常见的情况应该产生一个简单漂亮的行，但不应该破坏数据，即使它包含意外字符等。

您将如何选择这样做：

*   编码形式是单个人类可读的行
*   它不需要大型库或大量上下文来编码/解码
*   任何分隔符都已正确转义

网址编码？JSON？自己做？请指定您将使用的任何帮助程序库或方法。

（编辑以根据要求指定更多上下文和要求。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-15T23:14:02.933

正如@Uri 所说，额外的上下文会很好。我认为你主要关心的不是特定的编码方案，因为对于大多数编码来说，你自己滚动对于一个简单的`Map<String, String>`.

一个有趣的问题是：这个中间字符串编码将用于什么？

*   如果它纯粹是内部的，则可以使用 ad-hoc 格式，例如简单的连接：

    ```
    key1|value1|key2|value2 
    ```

*   如果人类晚上阅读它，像 Ruby 的地图声明这样的格式很好：

    ```
    { first_key  => first_value, 
      second_key => second_value } 
    ```

*   如果编码是通过线路将序列化的映射发送到另一个应用程序，那么 XML 建议很有意义，因为它是标准的并且可以合理地自我记录，但以 XML 的冗长为代价。

    ```
    <map>
        <entry key='foo' value='bar'/>
        <entry key='this' value='that'/>
    </map> 
    ```

*   如果地图将被刷新到文件并稍后由另一个 Java 应用程序读回，@Cletus 对[Properties 类](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Properties.html)的建议是一个很好的建议，并且具有易于人类打开和检查的额外好处。

* * *

**编辑：**您已经添加了要存储在数据库列中的信息 - 是否有理由使用单列，而不是像这样的三列：

```
CREATE TABLE StringMaps 
(
    map_id NUMBER   NOT NULL,  -- ditch this if you only store one map...
    key    VARCHAR2 NOT NULL,
    value  VARCHAR2
); 
```

除了让您存储更多语义上有意义的数据外，这更正式地将编码/解码移动到您的数据访问层，并允许其他数据库读取器轻松查看数据，而无需了解您可能使用的任何自定义编码方案。如果需要，您还可以轻松地通过键或值进行查询。

* * *

**再次编辑：**您已经说过它确实需要放入单个列中，在这种情况下，我会：

*   使用第一个管道分隔的编码（或任何你喜欢的奇异字符，也许是一些不可打印的英文 unicode 字符）。最简单的事情。或者...

*   如果您使用像 Oracle 这样的数据库，它将 XML 识别为真实类型（因此可以为您提供针对它的 XPath 评估等等）并且需要能够很好地从数据库层读取数据，请使用 XML。编写用于解码的 XML 解析器从来都不是一件有趣的事，但对于这样一个简单的模式应该不会太痛苦。

即使您的数据库本身不支持 XML，您也可以将其放入任何旧的类似字符的列类型中......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-15T23:11:18.193

为什么不只使用[Properties 类](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Properties.html)？这正是你想要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-15T23:58:56.413

我一直在考虑类似的需求，即通过外观模式为我的客户端和服务器之间的对话（传输内容）选择通用表示。我想要一个标准化的、人类可读的（简短的）、健壮的、快速的表示。我希望它是轻量级的实现和运行，易于测试，易于“包装”。请注意，我已经根据我的定义和明确的意图消除了 XML。

通过“包装”，我的意思是我希望支持其他传输内容表示，例如 XML、SOAP、可能的 Java 属性或 Windows INI 格式、逗号分隔值 (CSV) 等、Google 协议缓冲区、自定义二进制格式、专有Microsoft Excel 工作簿等二进制格式，以及可能出现的任何其他格式。我将在主要外观周围使用包装器/装饰器来实现这些辅助表示。这些次要表示中的每一个都是可取的，尤其是在某些情况下与其他系统集成时，但由于各种缺点（未能满足我上面列出的一个或多个标准），它们都不适合作为主要表示。

因此，到目前为止，我选择 JSON 格式作为我的主要传输内容表示。我打算在不久的将来详细探讨该选项。

只有在极端性能考虑的情况下，我才会跳过翻译底层的传统格式。简洁设计的优点包括良好的性能（不浪费精力，易于维护），为此选择合适的硬件应该是唯一必要的补充。当性能需求变得极端时（例如，每天处理 4 万个传入数据文件，总计 4000 万个事务），那么无论如何都必须重新审视一切。

作为一名开发人员、DBA、架构师等，我构建了几乎各种规模和描述的系统。我对我选择的标准充满信心，并急切地等待确认其适用性。事实上，我希望以开源的形式发布一个实现（但不要屏住呼吸）。

请注意，此设计讨论忽略了有意的传输介质（HTTP、SMTP、RMI、.Net Remoting 等）。我发现将传输介质和传输内容视为完全独立的设计考虑因素会更有效，无论是彼此还是与所讨论的系统。事实上，我的意图是让这些实际上“可插拔”。

因此，我鼓励您强烈考虑 JSON。最好的祝愿。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-23T14:25:58.370

查看 apache commons 配置包。这将允许您以 XML 或属性格式读取/保存文件。它还为您提供了自动将属性更改保存到文件的选项。

[阿帕奇配置](http://commons.apache.org/configuration/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-16T17:43:07.747

正如@DanVinton 所说，如果您在内部使用中需要这个（我的意思是“

> 内部使用

作为

> 它仅由我的组件使用，而不是由其他人编写的组件

您可以连接键和值。我更喜欢在键和键以及键和值之间使用不同的分隔符：
而不是
`key1+SEPARATOR+value1+SEPARATOR+key2 etc`
我编码
`key1+SEPARATOR_KEY_AND_VALUE+value1+SEPARATOR_KEY(n)_AND_KEY(N+1)+key2 etc`

如果必须调试，这种方式更清晰（也是设计使然）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-15T23:06:55.660

这个问题的一些额外背景会有所帮助。

如果您要在整个地图粒度上进行编码和解码，为什么不直接使用 XML？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-10-02T23:45:10.083

意识到这是一个旧的“死”线程，但我有一个以前没有提出的解决方案，我认为值得投入使用。

[我们将地理特征](http://www.opengeospatial.org/standards/sfa)的“任意”属性（即由用户在运行时创建）以标准 XML 属性格式存储在数据库中的单个[CLOB](http://en.wikipedia.org/wiki/Character_large_object)列中。那是：

```
name="value" name="value" name="value" 
```

要创建 XML 元素，您只需将属性“包装”在 xml 元素中。那是：

```
String xmlString += "<arbitraryAttributes" + arbitraryAttributesString + " />" 
```

将 Properties 实例“序列化”为 xml-attributes-string 是不费吹灰之力的……这就像十行代码。我们很幸运，我们可以将所有属性名称都必须是有效的 xml-element-names 的规则强加给用户；我们对每个“值”进行 xml 转义（即“e; 等”）以避免双引号和值字符串中的任何问题。

它有效、灵活、快速（足够）和**简单**。

现在，说了这么多......如果我们有时间，我们将完全脱离整个“元数据问题”，将*完整*的未掺杂的未解释的元数据 xml 文档存储在 CLOB 中，并使用其中一个 open-源元数据编辑器来处理整个混乱。

干杯。基思。

# watin - 结合 WatiN 测量响应时间

> ID：370010
> 
> 赞同：0
> 
> 时间：2008-12-15T23:02:03.923
> 
> 标签：watin

我正在寻找一种可以与[WatiN](http://watin.sourceforge.net/)结合使用的工具，它可以让我或多或少地测量交互的响应时间以及与 WatiN 结合使用的相同交互的文件大小。比方说，我提出了一个谷歌请求。太好了，我们都看过那个例子，但是如果我想看看这个请求花了多长时间，下载了什么，花了多长时间。有谁知道任何可以以编程方式使用的工具？当然，有许多工具，例如[Charles](http://www.charlesproxy.com/)、[Fiddler 2](http://www.fiddlertool.com/fiddler/)和[Firebug](https://addons.mozilla.org/en-US/firefox/addon/1843)，可以让您通过界面来执行此操作，但我希望能够基于此工具自动生成报告等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T03:56:15.157

查看[HttpWatch](http://www.httpwatch.com/)：
“HttpWatch 是一个与 IE 和 Firefox 集成的 HTTP 查看器和调试器，可在不离开浏览器窗口的情况下提供无缝的 HTTP 和 HTTPS 监控。”
网站上有一篇名为[Using HttpWatch with WatiN](http://blog.httpwatch.com/2008/10/30/using-httpwatch-with-watin/)的文章，其中包含将其与 WatiN 一起使用的示例代码。

# jquery - jQuery删除除第一行之外的所有表行

> ID：370013
> 
> 赞同：293
> 
> 时间：2008-12-15T23:03:44.590
> 
> 标签：jquery, jquery-selectors

使用 jQuery，如何删除表中除第一行之外的所有行？这是我第一次尝试使用索引选择器。如果我正确理解了这些示例，则以下内容应该有效：

```
$(some table selector).remove("tr:gt(0)"); 
```

我将其读作“在 jQuery 对象中包装一些表，然后删除这些行的元素索引大于零的所有 'tr' 元素（行）”。实际上，它执行时不会产生错误，但不会从表中删除任何行。

我错过了什么，我该如何解决？当然，我可以直接使用 javascript，但是我对 jQuery 非常感兴趣，所以我想使用 jQuery 来解决这个问题。

* * *

## 回答 #1

> 赞同：541
> 
> 时间：2008-12-15T23:12:38.847

这应该有效：

```
$(document).ready(function() {
   $("someTableSelector").find("tr:gt(0)").remove();
}); 
```

* * *

## 回答 #2

> 赞同：116
> 
> 时间：2008-12-15T23:35:20.423

考虑到意图，我认为这更具可读性：

```
$('someTableSelector').children( 'tr:not(:first)' ).remove(); 
```

使用 children 还可以通过限制搜索的深度来处理第一行包含表的情况。

如果你有一个 TBODY 元素，你可以这样做：

```
$("someTableSelector > tbody:last").children().remove(); 
```

如果你有 THEAD 或 TFOOT 元素，你需要做一些不同的事情。

* * *

## 回答 #3

> 赞同：49
> 
> 时间：2011-11-08T16:39:19.267

另一种方法是使用 jQuery 的 empty() 函数和表中的 thead 和 tbody 元素。

表格示例：

```
<table id="tableId">
<thead>
    <tr><th>Col1</th><th>Col2</th></tr>
</thead>
<tbody>
    <tr><td>some</td><td>content</td></tr>
    <tr><td>to be</td><td>removed</td></tr>
</tbody>
</table> 
```

和 jQuery 命令：

```
$("#tableId > tbody").empty(); 
```

这将删除表格的 tbody 元素中包含的每一行，并将 thead 元素保留在标题应位于的位置。当您只想刷新表格的内容时，它会很有用。

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2008-12-16T14:30:55.017

如果是我，我可能会把它归结为一个选择器：

```
$('someTableSelector tr:not(:first)').remove(); 
```

* * *

## 回答 #5

> 赞同：30
> 
> 时间：2008-12-15T23:14:19.607

您的选择器不需要在您的移除中。

它应该看起来像：

```
$("#tableID tr:gt(0)").remove(); 
```

这意味着选择表中 ID 为 tableID 的除第一行之外的每一行，并将它们从 DOM 中删除。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2013-06-25T08:46:08.107

```
$('#table tr').slice(1).remove(); 
```

我记得遇到“切片”比所有其他方法都快，所以把它放在这里。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2012-03-10T08:46:14.727

考虑一个带有 id 的表`tbl`：jQuery 代码将是：

```
$('#tbl tr:not(:first)').remove(); 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-12-03T11:27:40.837

要删除除第一行（标题除外）之外的所有行，请使用以下代码：

`$("#dataTable tr:gt(1)").remove();`

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-05-24T09:56:13.010

最简单的方法：

```
$("#mytable").find($("tr")).slice(1).remove() 
```

-首先引用表格
-获取元素列表并将其切片并删除列表中的选定元素

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-09-21T18:41:19.990

-对不起，这是很晚的回复。

我发现删除任何行（以及通过迭代的所有其他行）的最简单方法是这样

$('#rowid','#tableid').remove();

其余的很容易。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-03-08T09:00:43.667

```
$("#p-items").find('tr.row-items').remove();

```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-11-18T19:48:55.170

包装在一个函数中：

```
function remove_rows(tablename) { 
    $(tablename).find("tr:gt(0)").remove();        
} 
```

然后调用它：

```
remove_rows('#table1');
remove_rows('#table2'); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-02-07T08:58:38.697

这完美地工作

```
$("#myTable tbody").children( 'tr:not(:first)' ).html(""); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-05-16T12:39:15.137

在我的情况下，这以以下方式工作并且工作正常

```
$("#compositeTable").find("tr:gt(1)").remove(); 
```

# rhino-mocks - Rhino Mocks：如何在方法调用中模拟方法调用？

> ID：370016
> 
> 赞同：4
> 
> 时间：2008-12-15T23:04:07.820
> 
> 标签：rhino-mocks

我有一个非常简单的类，有两种方法；一个将被调用，另一个将被调用。这个想法是调用 OuterMockMethod 方法但模拟 InnerMockMethod。现在我似乎只能模拟 OuterMockMethod 方法。

```
public class MockClass : IMockInterface
{         
    public virtual MockClass InnerMockMethod()
    {
      MockClass returnValue;

      returnValue = new MockClass();
      returnValue.SomeMessage = "Not mocked";

      return returnValue;
    }

    public virtual MockClass OuterMockMethod()
    {
      MockClass mock;

      mock = new MockClass();

      return mock.MockedMethod();
    }
} 
```

现在这可行，但这不是我想模拟的方法：

```
 public void MockTest_Internal()
 {
     MockClass returnedClass;
     MockClass mockProvider;

     mockProvider = repository.StrictMock<MockClass>();
     mockProvider.Expect(item => item.OuterMockMethod())
       .Return(new MockClass { SomeMessage = "Mocked" });
     repository.Replay(mockProvider);

     returnedClass = mockProvider.OuterMockMethod();

     Assert.IsTrue(returnedClass.SomeMessage == "Mocked");
 } 
```

如您所见，它调用了它喜欢的 OuterMockMethod，但我不希望这样。我想模拟 InnerMockMethod，这样当 OuterMockMethod 调用它时，它会返回我想要的。

```
 public void MockTest_Internal()
 {
     MockClass returnedClass;
     MockClass mockProvider;

     mockProvider = repository.StrictMock<MockClass>();
     mockProvider.Expect(item => item.InnerMockMethod())
       .Return(new MockClass { SomeMessage = "Mocked" });
     repository.Replay(mockProvider);

     returnedClass = mockProvider.OuterMockMethod();  //Boom angry Rhino

     Assert.IsTrue(returnedClass.SomeMessage == "Mocked");
 } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-15T23:12:45.227

在这种情况下，您需要将模拟放在返回的对象上：

```
MockClass returnedMock = MockRepository.GenerateMock<MockClass>();
returnedMock.Expect( rm => rm.InnerMockMethod() )
            .Return( new MockClass { SomeMessage = "Mocked" } );
mockProvider.Expect( mp => mp.OuterMockMethod() ).Return (returnedMock );

returnedClass = mockProvider.OuterMockMethod();

... 
```

请注意，StrictMock 已被弃用。现在首选的模式是 AAA（Arrange、Act、Assert）。[你可以在这里](http://ayende.com/Blog/archive/2008/05/16/Rhino-Mocks--Arrange-Act-Assert-Syntax.aspx)找到更多信息。

# sql-server - SQL Server 2005“公共”数据库角色似乎不适用？

> ID：370024
> 
> 赞同：0
> 
> 时间：2008-12-15T23:07:41.230
> 
> 标签：sql-server, permissions, controls, account

我有一个 SQL Server 2005 数据库，我正尝试使用 Windows 身份验证作为受限用户帐户访问该数据库。我已将 BUILTIN\Users 添加为数据库用户（在此之前，我什至无法打开数据库）。我的工作假设每个人都应该对应用于他们的“公共”角色具有权限，所以我没有对角色分配做任何事情。在 tblFoo 下，我可以使用 SSMS 属性对话框（权限页面）添加“公共”，然后设置显式权限。其中包括 SELECT 的“Grant”。但是跑步

```
SELECT * from tblFoo; 
```

作为受限（BUILTIN\Users）帐户给我一个错误“选择对象'tblFoo'，数据库'bar'，模式'dbo'的权限被拒绝”。在属性对话框中，有一个“有效权限”按钮，但它是灰色的。

此外，我尝试创建一个名为“UserTest”的非私有帐户，在服务器级别添加该帐户，然后将其映射到“bar”数据库。这让我可以将 UserTest 添加到“用户或角色”列表中，这让我可以为该帐户运行“有效权限”。根本没有列出任何权限——这似乎不对。该帐户必须是公共的，并且公共授予（除其他外）在 tblFoo 上选择，那么为什么 UserTest 帐户不显示有效权限？我觉得我在这里有点疯了。

旁白：我知道很多人不喜欢使用“公共”角色来设置权限。这只是我的修补时间；在最终设计中，我确信我们将拥有几个灵活的（自定义）数据库角色。我只是想弄清楚我看到的行为，所以请不要“不要那样做！” 答案。

更新：显然我知道的 SQL Server 足以对自己和他人构成危险。在设置权限时（正如我所说，“除其他外”），我有拒绝控制。当我设置这个权限时，我想我试图查看它做了什么，有一个模糊的想法，并决定拒绝。我目前不记得为什么这似乎是要做的事情，但似乎这就是我获得许可失败的原因。所以我正在更新我的问题：任何人都可以解释与表有关的“控制”权限吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-16T05:02:16.333

您只需要拥有 SELECT 权限。在原始 SQL 中（请参阅对话框中的“脚本”图标/按钮），它是`GRANT SELECT ON dbo.tblFoo to public`. 这是查看数据所需的唯一权限，

在这种情况下，错误消息明确提到“拒绝”。“拒绝”本身就是一项权利，所以它提到了它，

如果您没有权利，您将收到消息（非常近似）“tblFoo 不存在或您没有权利”

[这里](http://msdn.microsoft.com/en-us/library/ms191291(SQL.90).aspx)提到了“拒绝控制” 。在这种情况下，您拒绝了公共角色的*所有*权利。

> 被授权者实际上拥有对安全对象的所有已定义权限

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T00:00:29.623

假设“UserTest”是域用户帐户，以 sysadmin 角色的成员身份连接并运行

```
EXEC MASTER.dbo.xp_logininfo 'Domain\UserTest', 'all' 
```

（将您的域名替换为“域”）

这将显示该帐户从其继承安全权限的 Windows 组等以及访问级别，例如，您可能会看到如下内容：

```
account name     type    privilege  mapped  login name       permission path
domain\usertest  user   user               domain\usertest  BUILTIN\Users 
```

这将有助于解决帐户从何处继承权限的问题，例如，它所属的哪些 Windows 组对数据库具有权限。如果这一切看起来都不错，那么我会听从你自己的建议，而不是搞乱公共角色。

*   在您的数据库中创建数据库角色
*   为该角色分配显式权限
*   为您的用户帐户创建服务器登录
*   打开服务器登录，进入用户映射部分，点击数据库并选择你创建的数据库角色

# windows - 为什么 git 在 Windows 下记不住我的密码

> ID：370030
> 
> 赞同：189
> 
> 时间：2008-12-15T23:12:26.647
> 
> 标签：windows, git, ssh, cmd

我刚刚开始使用 git，但我无法记住我的密码短语

但我仍然得到

```
*\subnus.mvc>git push origin master
Enter passphrase for key '/c/Users/Subnus/.ssh/id_rsa': 
```

* * *

## 回答 #1

> 赞同：220
> 
> 时间：2010-12-05T01:24:03.597

我意识到这个问题是在两年前提出的，但我遇到了同样的问题，这里的几个答案并没有完全回答我的问题。以下是三个分步解决方案，具体取决于您是否使用 TortoiseGit 和 msysgit。

**第一个解决方案**假设 Windows、msysgit 和 PuTTY。

1.  按照说明安装 msysgit 和 PuTTY。

2.  （可选）将 PuTTY 添加到您的路径。*（如果您不这样做，那么下面对 PuTTY 命令的任何引用都必须以相应可执行文件的完整路径为前缀。）*

3.  如果您还没有这样做，请按照 GitHub 或您的 Git 主机的说明生成密钥哈希。

4.  同样，如果您还没有这样做，请使用**puttygen.exe**转换您的密钥以与 PuTTY 的 pageant.exe 一起使用。说明在 PuTTY 的文档、[这个有用的指南](http://www.electrictoolbox.com/putty-rsa-dsa-keys/)以及网络空间的其他几个地方。

5.  运行 PuTTY 的**pageant.exe**，打开您的 .ppk 文件（“添加密钥”），并为您的密钥提供密码。

6.  访问 Windows 的环境变量对话框（右键单击“计算机”，单击“属性”，单击“高级系统设置”或“高级”选项卡，单击“环境变量”）。添加以下环境变量：

    GIT_SSH=C:\full\path\to\plink.exe

    将 "C:\full\path\to" 替换为 PuTTY 的完整安装路径，其中找到 plink.exe。最好将其添加到“用户变量”部分。此外，请确保您用于 plink.exe 的路径与您用于 Pageant (pageant.exe) 的路径相匹配。在某些情况下，您可能安装了多个 PuTTY，因为它可能与其他应用程序一起安装。使用一个安装中的 plink.exe 和另一个安装中的 pageant.exe 可能会给您带来麻烦。

7.  打开命令提示符。

8.  如果您尝试连接到托管在 Github.com 的 git 存储库，请运行以下命令：

    plink.exe git@github.com

    如果您尝试连接的 git 存储库托管在其他地方，则将*git@github.com*替换为适当的用户名和 URL。（假设 Github）你应该被告知服务器的主机密钥没有被缓存，并询问你是否信任它。回答**y**。这会将服务器的主机密钥添加到 PuTTY 的已知主机列表中。如果没有这一步，git 命令将无法正常工作。按回车后，Github 会通知您 Github 不提供 shell 访问。没关系……我们不需要它。（如果您正在连接到其他主机，并且它为您提供了 shell 访问权限，那么最好终止链接而不做任何其他事情。）

9.  全部做完！Git 命令现在应该可以从命令行运行。您可能希望 pageant.exe[在启动时自动加载您的 .ppk 文件](http://blog.shvetsov.com/2010/03/making-pageant-automatically-load-keys.html)，具体取决于您需要它的频率。

**第二种解决方案**假设 Windows、msysgit 和 TortoiseGit。

TortoiseGit 带有 PuTTY 可执行文件和经过特殊修改的 plink 版本（称为 TortoisePlink.exe），这将使事情变得更容易。

1.  按照说明安装 msysgit 和 TortoiseGit。

2.  如果您还没有这样做，请按照 GitHub 或您的 Git 主机的说明生成密钥哈希。

3.  同样，如果您还没有这样做，请使用 TortoiseGit 的**puttygen.exe**转换您的密钥以与 TortoiseGit 的 pageant.exe 一起使用。说明在 PuTTY 的文档、第一个解决方案中链接的有用指南以及网络空间的其他几个地方。

4.  运行 TortoiseGit 的**pageant.exe**，打开您的 .ppk 文件（“添加密钥”）并为您的密钥提供密码。

5.  访问 Windows 的环境变量对话框（右键单击“计算机”，单击“属性”，单击“高级系统设置”或“高级”选项卡，单击“环境变量”）。添加以下环境变量：

    GIT_SSH=C:\full\path\to\TortoisePlink.exe

    将 "C:\full\path\to" 替换为 TortoiseGit 的完整安装路径，在该路径中找到 TortoisePlink.exe。最好将其添加到“用户变量”部分。此外，请确保您用于 TortoisePlink.exe 的路径与您用于 Pageant (pageant.exe) 的路径相匹配。在某些情况下，您可能安装了多个 PuTTY，因为它可能与其他应用程序一起安装。使用 TortoiseGit 安装中的 TortoisePlink.exe 和不同应用程序的另一个安装（或独立 PuTTY 安装）中的 pageant.exe 可能会给您带来麻烦。

6.  全部做完！Git 命令现在应该可以从命令行运行。当您第一次尝试连接到您的 git 存储库时，您可能会被告知服务器的主机密钥未缓存，并询问您是否信任该服务器。点击“是”。（这是运行中的 TortoisePlink.exe。）

    您可能希望 pageant.exe[在启动时自动加载您的 .ppk 文件](http://blog.shvetsov.com/2010/03/making-pageant-automatically-load-keys.html)，具体取决于您需要它的频率。

**第三种解决方案**假定 Windows、msysgit 和本机命令提示符。

1.  安装 msysgit
2.  确保允许在 MS-DOS 命令提示符下使用 git
3.  跑`start-ssh-agent`
4.  输入 SSH 密码
5.  全部做完！Git 命令现在应该可以在本机命令提示符下工作。

* * *

## 回答 #2

> 赞同：124
> 
> 时间：2019-11-09T23:21:58.167

*每次设置新桌面时，我都会忘记这些说明，所以我在这里添加另一个答案，因为我同样经常偶然发现它！*

* * *

## 像我这样不耐烦的用户的快速步骤

1.  启用该`OpenSSH Authentication Agent`服务并使其自动启动。
    *   **更新**
    *   使用最新的 Windows 更新`Version 10.0.19042.867`，我不得不重新执行此步骤！
2.  `ssh-add`在命令行上将您的 SSH 密钥添加到代理。
3.  测试 git 集成，如果它仍然要求您输入密码，请继续。
4.  将环境变量添加`$ENV:GIT_SSH=C:\Windows\System32\OpenSSH\ssh.exe`到您的会话中，或永久添加到您的用户环境中。

* * *

## 详细步骤：概述

[Windows与 OpenSSH 一起](https://devblogs.microsoft.com/commandline/openssh-in-windows-10/)发布已经有一段时间了。它包括 ssh 与 Git 一起工作的所有必要位，但它似乎仍然需要一些 TLC 才能 100% 无缝工作。这是我从 Windows 版本 10.0.18362.449 开始成功执行的步骤（您可以通过打开 cmd.exe shell 并键入来查看您的 Windows 10 版本`ver`）。

*我在这里假设您已经设置了 SSH 密钥，并且位于`~/.ssh/id_rsa`*

### 在您的 Windows 10 机器上启用 ssh-agent 服务。

1.  开始-> 输入“服务”并单击出现的服务应用程序。
2.  在列表中找到`OpenSSH Authentication Agent`服务。
3.  右键单击该`OpenSSH Authentication Agent`服务，然后选择“属性”。
4.  将 更改`Startup type:`为`Automatic`。
5.  单击`Start`按钮将服务状态更改为`Running`。
6.  单击 关闭对话框`OK`，然后关闭服务应用程序。

### 将您的密钥添加到`ssh-agent`

1.  打开您偏好的 shell *（我将在本例中使用 Windows Powershell，也适用于 Powershell Core）*。
2.  将您的 SSH 密钥添加到`ssh-agent`: `ssh-add` *（如果与默认值不同，您可以将密钥的路径添加为第一个参数）*。
3.  如果/在提示时输入您的密码。

### 试试 Git + SSH

1.  打开你的 shell *（同样，我使用的是 Powershell）*并克隆一个 repo。`git clone git@github.com:octocat/Spoon-Knife`
2.  **如果您看到此提示，请继续下一部分：**

```
Enter passphrase for key '/c/Users/your_user_name/.ssh/id_rsa': 
```

### 设置`GIT_SSH`环境变量

在任何会话中，您都可以简单地设置此环境变量，并且您的密码提示将停止出现，ssh 将`ssh-agent`代表您使用。或者，您可以将密码永久设置到用户的环境中。

**`GIT_SSH`仅在当前 shell 中设置：**

1.  打开您喜欢的外壳。*（对我来说是Powershell）*
2.  将环境变量 GIT_SSH 设置为适当的`ssh.exe`：`$Env:GIT_SSH=$((Get-Command -Name ssh).Source)`
3.  **重试上面尝试 Git + SSH**中的步骤。

**`GIT_SSH`永久设置**

1.  打开文件资源管理器。开始-> 键入“文件资源管理器”并在列表中单击它。
2.  右键单击“这台电脑”，然后单击“属性”。
3.  点击“高级系统设置”。
4.  单击“环境变量...”按钮。
5.  在“您的用户名的用户变量”下单击新建...
6.  将`Variable name:`字段设置为 GIT_SSH
7.  将该`Variable value:`字段设置为 path-to-ssh.exe（通常为`C:\Windows\System32\OpenSSH\ssh.exe`）。
8.  单击确定关闭新用户变量对话框。
9.  单击“确定”关闭“环境变量”对话框。
10.  **重试上面尝试 Git + SSH**中的步骤。

* * *

*请注意，随着 Windows 10 的进展以及我了解更多，这可能会随着新的步骤/程序而改变。我会尽量保持更新，期待评论中的反馈。*

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2018-04-02T19:06:51.347

如果您在***Windows***下使用***Git bash*** ，您可以执行以下操作：

 *```
eval `ssh-agent -s`
ssh-add ~/.ssh/*_rsa 
```

它会在第二个命令中询问密码，就是这样。您需要执行的每个附加操作（曾经需要密码短语）都不会要求您输入密码短语（请参见下面屏幕截图中的示例）：

[![在 Windows 上的 Git bash 中添加密码短语](https://i.stack.imgur.com/sbpl9.png)](https://i.stack.imgur.com/sbpl9.png)

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2010-03-14T17:13:28.117

对于需要更详细说明的任何人，请参阅此页面： [http ://help.github.com/working-with-key-passphrases/](http://help.github.com/working-with-key-passphrases/)

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2014-08-21T17:24:12.947

问题发布后 5 年、8 个月和 6 天后的一个额外解决方案并不是一个坏主意，所以就这样吧。

**注意：**假设您使用的是 Windows 计算机。

1.  下载[git-credential-winstore](https://github.com/Microsoft/Git-Credential-Manager-for-Windows)。
2.  运行！如果您的`PATH`环境变量中有 GIT，它应该可以正常工作。如果没有，请运行`git-credential-winstore -i C:\Path\To\Git.exe`.

下次您尝试提交到存储库时，系统会提示您输入您的凭据。应该是这样的。在您更改密码之前，不会再要求您提供凭据。

* * *

仅供您参考...您的凭据存储在 Windows 凭据存储中

> **你在哪里存储我的凭据？**
> 
> 此应用程序仅使用现有的 Windows 凭据存储来保存您的凭据。您可以通过转到控制面板 > 用户帐户 > 凭据管理器并选择“Windows 凭据”来查看存储的凭据。以“git:”开头的条目来自 git-credential-winstore。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2019-12-22T04:06:50.257

假设您想使用纯**Git Bash**解决方案而不使用 TortoiseGit 或 PuTTY。此外，您不希望永久存储您的密码，因为这几乎与您在没有密码的情况下生成 SSH 密钥一样。但是您仍然想使用一些缓存。

出于缓存目的`ssh-agent`，使用了包含在 Git Bash 发行版中的进程。此过程默认不启动，因此需要先启动。对于要缓存的任何 SSH 密钥，应使用命令将它们添加到此进程中，该`ssh-add`命令将提示您输入密钥的密码并将其存储在内存中。

其他解决方案的缺点：

*   [GitHub 文章中的](https://help.github.com/en/github/authenticating-to-github/working-with-ssh-key-passphrases#auto-launching-ssh-agent-on-git-for-windows)自动启动`ssh-agent`在启动 Git Bash 时从一开始就要求输入密码，无论您是否需要在此会话中使用 SSH 密钥。如果您今天使用本地存储库，您可能只想在真正需要时提供密码（例如，在与远程存储库交互时）。
*   如果你`ssh-agent`在[GitLab 的](https://docs.gitlab.com/ee/ssh/#working-with-non-default-ssh-key-pair-paths)文章中点赞，`eval $(ssh-agent -s)`你可能已经厌倦了每次都输入它。最终，您可能已将这两行添加到`.bashrc`配置中以自动启动。缺点与上面相同，还有一个额外的：每次启动新的 Git Bash 终端时，您都会获得一个额外的 ssh-agent 进程（GitHub 的 bash 脚本检查该进程是否已经启动）。
*   就像上面两个一样，但尤其是当您为不同的主机拥有单独的 SSH 密钥时，例如一个用于 GitHub，另一个用于 GitLab，因此一次性提供它们既烦人又不方便。

因此，此解决方案适用于那些想知道如何让 Git Bash 在每个 Windows 会话中仅在真正需要时才要求输入密码的人。[它类似于GnuPG](https://help.github.com/en/github/authenticating-to-github/signing-commits)的密码短语管理行为，使用[`default-cache-ttl`](https://stackoverflow.com/a/37369506/3210423).

### 配置 SSH 以在需要时仅使用 Git Bash 请求密码短语

1.  首先，我们要`ssh-agent`在启动 Git Bash shell 时自动启动。我们将为此使用修改后的 GitHub[脚本](https://help.github.com/en/github/authenticating-to-github/working-with-ssh-key-passphrases#auto-launching-ssh-agent-on-git-for-windows)，因为它会检查进程是否已经开始，但我们不希望它立即成为`ssh-add`密钥。此脚本转到您的`~/.bashrc`or`~/.profile`或`~/.bash_profile`（`~`是您用户的主目录，例如`C:\Users\Username`- 运行`cd ~`，然后`pwd`让 Git Bash 将其打印出来）：

    ```
    ### Start ssh-agent

    env=~/.ssh/agent.env

    agent_load_env () { test -f "$env" && . "$env" >| /dev/null ; }

    agent_start () {
        (umask 077; ssh-agent >| "$env")  # use -t here for timeout
        . "$env" >| /dev/null ; }

    agent_load_env

    # agent_run_state: 0=agent running w/ key; 1=agent w/o key; 2= agent not running
    agent_run_state=$(ssh-add -l >| /dev/null 2>&1; echo $?)

    if [ ! "$SSH_AUTH_SOCK" ] || [ $agent_run_state = 2 ]; then
        agent_start
    fi

    unset env 
    ```

2.  现在编辑或创建一个`~/.ssh/config`文件，并**`AddKeysToAgent`**为您希望打开缓存的每个主机节添加一个选项（您也可以通过将指令放在所有主机声明之前的文件开头来全局打开它）：

    ```
    # GitHub.com
    Host github.com
      Preferredauthentications publickey
      IdentityFile ~/.ssh/id_ed25519_github
      AddKeysToAgent yes

    # GitLab.com
    Host gitlab.com
      Preferredauthentications publickey
      IdentityFile ~/.ssh/id_ed25519_gitlab
      AddKeysToAgent yes 
    ```

    > *从 ssh config 手册[页](https://man.openbsd.org/ssh_config.5#AddKeysToAgent)：*如果此选项设置为 yes 并且从文件加载密钥，则密钥及其密码将添加到具有默认生命周期的代理，就像通过 ssh-add(1) 一样。

默认的最大生命周期是永远或直到`ssh-agent`进程被终止（从任务管理器手动或当您的 PC 关闭时）。如果您希望使用有限超时，您可以使用 ssh-agent 的[`-t`](https://man.openbsd.org/ssh-agent.1#t)参数进行设置。从上面的第一步更改 bash 脚本中的行，例如 30 分钟的密钥缓存生命周期：

```
(umask 077; ssh-agent -t 30m >| "$env") 
```

有关其他时间格式限定符，请参见[此处](https://man.openbsd.org/sshd_config.5#TIME_FORMATS)。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2008-12-15T23:19:46.960

如果您为密钥文件设置了密码，则在连接时始终需要输入该密码。如果您创建一个无密码密钥，那么您不必每次都输入它，但是，任何有权访问您的密钥文件的人现在都可以连接到您的 github 帐户。

ssh-agent 也可以工作。尝试运行它，看看它是否会记住您的密码。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2010-10-14T10:54:35.140

[编辑-误读了问题，这是对相关问题的回答。为后代留下改写版本]

我的情况是，我试图推送到托管在我们其中一台服务器上的存储库。每当我尝试推送时，git 都会询问我的密码（nb - 密码，而不是我私钥的密码）。

通过将我的公钥添加到服务器上的授权密钥中，我能够获得对该服务器的无密码推送。而且，因为我的私钥上没有*密码*（顺便说一句，这是不好的做法！）我根本不需要输入任何内容。

这是将您的公钥添加到服务器的命令。它假定用户`git`是服务器上的用户。

```
cat .ssh/id_rsa.pub | ssh git@GIT_MASTER_IP 'cat >> .ssh/authorized_keys' 
```

您可以通过登录服务器并手动将您的公钥附加到文件中来实现相同的目的`~/.ssh/authorized_keys`

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2012-10-22T16:50:15.033

我意识到这已经过了好几年了，但是我偶然发现了这个问题，试图找到一个解决方案，我找到了适合所有专业水平的东西，所以我想我会分享。

GitHub 提供了一个非常有用的安装程序，让一切变得简单易用：[https ://help.github.com/articles/caching-your-github-password-in-git/](https://help.github.com/articles/caching-your-github-password-in-git/)

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2018-04-03T20:37:20.660

`.bashrc`您可以在用户的​​主目录中创建一个文件，例如`C:/Users/youruser`，然后放在那里：

```
env=~/.ssh/agent.env

agent_load_env () { test -f "$env" && . "$env" >| /dev/null ; }

agent_start () {
    (umask 077; ssh-agent >| "$env")
    . "$env" >| /dev/null ; }

agent_load_env

# agent_run_state: 0=agent running w/ key; 1=agent w/o key; 2= agent not running
agent_run_state=$(ssh-add -l >| /dev/null 2>&1; echo $?)

if [ ! "$SSH_AUTH_SOCK" ] || [ $agent_run_state = 2 ]; then
    agent_start
    ssh-add
elif [ "$SSH_AUTH_SOCK" ] && [ $agent_run_state = 1 ]; then
    ssh-add
fi

unset env 
```

每次 bash 运行后都会执行此脚本。所以你只需要输入一次密码，什么时候`git-bash`开始！

某些版本的 bash 需要`.bash_profile`文件`.bashrc`，所以以防万一克隆`.bashrc`：

```
copy .bashrc .bash_profile 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-07-26T13:39:02.473

可以尝试添加 -k arg ；

```
ssh-add -k ~/.ssh/id_rsa 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-08-03T14:52:43.380

确保您**的**`~/.ssh/config`不包含

 **`UseKeychain yes`

这可以防止`ssh-add`坚持到`ssh-agent`.

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2022-01-12T16:54:52.720

Windows：如果您执行了**@d3r3kk 中**的步骤 ，但仍然遇到问题，请尝试以下操作：

视窗：

*   删除 .bashrc 文件
*   此文件通常位于 C:\Users\myusername

# bash - 从 Bash 中的 $PATH 变量中删除路径的最优雅的方法是什么？

> ID：370047
> 
> 赞同：124
> 
> 时间：2008-12-15T23:19:14.950
> 
> 标签：bash, shell, path, variable-expansion, list-processing

或者更一般地说，如何从 Bash 环境变量中以冒号分隔的列表中删除项目？

我以为我在几年前看到了一种简单的方法，使用更高级的 Bash 变量扩展形式，但如果是这样，我已经忘记了它。对 Google 的快速搜索结果出乎意料地少，而且没有一个我称之为“简单”或“优雅”的结果。例如，分别使用 sed 和 awk 的两种方法：

```
PATH=$(echo $PATH | sed -e 's;:\?/home/user/bin;;' -e 's;/home/user/bin:\?;;')
PATH=!(awk -F: '{for(i=1;i<=NF;i++){if(!($i in a)){a[$i];printf s$i;s=":"}}}'<<<$PATH) 
```

没有直接的东西存在吗？有什么类似于 Bash 中的 split() 函数的吗？

**更新：**
看来我需要为我故意含糊的问题道歉；我对解决特定用例的兴趣不如对引发良好讨论的兴趣。幸运的是，我明白了！

这里有一些非常聪明的技巧。最后，我在我的工具箱中添加了以下三个功能。魔术发生在 path_remove 中，它主要基于 Martin York 巧妙地使用`awk`'s RS 变量。

```
path_append ()  { path_remove $1; export PATH="$PATH:$1"; }
path_prepend () { path_remove $1; export PATH="$1:$PATH"; }
path_remove ()  { export PATH=`echo -n $PATH | awk -v RS=: -v ORS=: '$0 != "'$1'"' | sed 's/:$//'`; } 
```

那里唯一真正的麻烦是使用`sed`删除尾随冒号。不过，考虑到 Martin 的解决方案的其余部分是多么简单，我非常愿意接受它！

* * *

相关问题：[如何在 shell 脚本中操作 $PATH 元素？](https://stackoverflow.com/questions/273909/how-do-i-manipulate-path-elements-in-shell-scripts)

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2008-12-16T00:05:01.580

我的肮脏黑客：

```
echo ${PATH} > t1
vi t1
export PATH=$(cat t1) 
```

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2008-12-16T00:40:34.223

awk 一分钟：

```
# Strip all paths with SDE in them.
#
export PATH=`echo ${PATH} | awk -v RS=: -v ORS=: '/SDE/ {next} {print}'` 
```

### 编辑：它回应以下评论：

```
$ export a="/a/b/c/d/e:/a/b/c/d/g/k/i:/a/b/c/d/f:/a/b/c/g:/a/b/c/d/g/i"
$ echo ${a}
/a/b/c/d/e:/a/b/c/d/f:/a/b/c/g:/a/b/c/d/g/i

## Remove multiple (any directory with a: all of them)
$ echo ${a} | awk -v RS=: -v ORS=: '/a/ {next} {print}'
## Works fine all removed

## Remove multiple including last two: (any directory with g)
$ echo ${a} | awk -v RS=: -v ORS=: '/g/ {next} {print}'
/a/b/c/d/e:/a/b/c/d/f:
## Works fine: Again! 
```

### 针对安全问题进行编辑：（与问题无关）

```
export PATH=$(echo ${PATH} | awk -v RS=: -v ORS=: '/SDE/ {next} {print}' | sed 's/:*$//') 
```

这会删除通过删除最后一个条目留下的任何尾随冒号，这将有效地添加`.`到您的路径中。

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2010-01-21T10:48:53.013

既然替换的最大问题是结束情况，那么如何使结束情况与其他情况没有什么不同呢？如果路径的开头和结尾已经有冒号，我们可以简单地搜索用冒号包裹的所需字符串。事实上，我们可以轻松地添加这些冒号并在之后删除它们。

```
# PATH => /bin:/opt/a dir/bin:/sbin
WORK=:$PATH:
# WORK => :/bin:/opt/a dir/bin:/sbin:
REMOVE='/opt/a dir/bin'
WORK=${WORK/:$REMOVE:/:}
# WORK => :/bin:/sbin:
WORK=${WORK%:}
WORK=${WORK#:}
PATH=$WORK
# PATH => /bin:/sbin 
```

纯 bash :)。

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2008-12-16T01:27:12.710

这是我可以设计的最简单的解决方案：

```
#!/bin/bash
IFS=:
# convert it to an array
t=($PATH)
unset IFS
# perform any array operations to remove elements from the array
t=(${t[@]%%*usr*})
IFS=:
# output the new array
echo "${t[*]}" 
```

上面的示例将删除 $PATH 中包含“usr”的任何元素。您可以将“*usr*”替换为“/home/user/bin”以仅删除该元素。

**按[sschuberth](https://stackoverflow.com/users/1127485/sschuberth)**更新****

 **尽管我认为 a 中的空格`$PATH`是一个**可怕**的想法，但这里有一个处理它的解决方案：

```
PATH=$(IFS=':';t=($PATH);n=${#t[*]};a=();for ((i=0;i<n;i++)); do p="${t[i]%%*usr*}"; [ "${p}" ] && a[i]="${p}"; done;echo "${a[*]}"); 
```

或者

```
IFS=':'
t=($PATH)
n=${#t[*]}
a=()
for ((i=0;i<n;i++)); do
  p="${t[i]%%*usr*}"
  [ "${p}" ] && a[i]="${p}"
done
echo "${a[*]}" 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2012-10-30T08:39:27.573

这是一个单行代码，尽管当前[已接受](https://stackoverflow.com/a/370192/1127485)且[评价最高的](https://stackoverflow.com/a/370255/1127485)答案，但不会将不可见字符添加到 PATH 并且可以处理包含空格的路径：

```
export PATH=$(p=$(echo $PATH | tr ":" "\n" | grep -v "/cygwin/" | tr "\n" ":"); echo ${p%:}) 
```

就个人而言，我也觉得这很容易阅读/理解，而且它只涉及常用命令而不是使用 awk。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2015-03-20T04:22:43.913

这是一个解决方案：

*   是纯 Bash，
*   不调用其他进程（如“sed”或“awk”），
*   不变`IFS`，
*   不分叉子外壳，
*   处理带空格的路径，以及
*   删除 中所有出现的参数`PATH`。

    ```
    removeFromPath() {
       本地 pd
       p=":$1:"
       d=":$PATH:"
       d=${d//$p/:}
       d=${d/#:/}
       路径=${d/%:/}
    }
    ```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2013-10-25T10:59:30.090

到目前为止，我发现的最好的纯 bash 选项如下：

```
function path_remove {
  PATH=${PATH/":$1"/} # delete any instances in the middle or at the end
  PATH=${PATH/"$1:"/} # delete any instances at the beginning
} 
```

这是基于对将目录添加到 $PATH 的[不完全正确的答案](https://superuser.com/a/462852/16858)，[如果它](https://superuser.com/q/39751/16858)在超级用户上还没有。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2012-08-13T00:28:39.617

```
function __path_remove(){  
    local D=":${PATH}:";  
    [ "${D/:$1:/:}" != "$D" ] && PATH="${D/:$1:/:}";  
    PATH="${PATH/#:/}";  
    export PATH="${PATH/%:/}";  
} 
```

从我的 .bashrc 文件中挖出来。当您使用 PATH 时，它会丢失，awk/sed/grep 变得不可用:-)

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2012-03-08T23:09:11.980

我一直在使用 bash 发行版中的函数，这些函数显然自 1991 年以来就已经存在。这些仍然在 Fedora 上的 bash-docs 包中，并且曾经在`/etc/profile`.

```
$ rpm -ql bash-doc |grep pathfunc
/usr/share/doc/bash-4.2.20/examples/functions/pathfuncs
$ cat $(!!)
cat $(rpm -ql bash-doc |grep pathfunc)
#From: "Simon J. Gerraty" <sjg@zen.void.oz.au>
#Message-Id: <199510091130.VAA01188@zen.void.oz.au>
#Subject: Re: a shell idea?
#Date: Mon, 09 Oct 1995 21:30:20 +1000

# NAME:
#       add_path.sh - add dir to path
#
# DESCRIPTION:
#       These functions originated in /etc/profile and ksh.kshrc, but
#       are more useful in a separate file.
#
# SEE ALSO:
#       /etc/profile
#
# AUTHOR:
#       Simon J. Gerraty <sjg@zen.void.oz.au>

#       @(#)Copyright (c) 1991 Simon J. Gerraty
#
#       This file is provided in the hope that it will
#       be of use.  There is absolutely NO WARRANTY.
#       Permission to copy, redistribute or otherwise
#       use this file is hereby granted provided that
#       the above copyright notice and this notice are
#       left intact.

# is $1 missing from $2 (or PATH) ?
no_path() {
        eval "case :\$${2-PATH}: in *:$1:*) return 1;; *) return 0;; esac"
}
# if $1 exists and is not in path, append it
add_path () {
  [ -d ${1:-.} ] && no_path $* && eval ${2:-PATH}="\$${2:-PATH}:$1"
}
# if $1 exists and is not in path, prepend it
pre_path () {
  [ -d ${1:-.} ] && no_path $* && eval ${2:-PATH}="$1:\$${2:-PATH}"
}
# if $1 is in path, remove it
del_path () {
  no_path $* || eval ${2:-PATH}=`eval echo :'$'${2:-PATH}: |
    sed -e "s;:$1:;:;g" -e "s;^:;;" -e "s;:\$;;"`
} 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-12-16T00:13:48.723

[我确实在这里](https://stackoverflow.com/questions/273909/how-do-i-manipulate-path-elements-in-shell-scripts#346860)写了一个答案（也使用 awk）。但我不确定这就是你要找的东西？它至少在我看来很清楚它的作用，而不是试图融入一行。不过，对于一个只去除东西的简单衬里，我建议

```
echo $PATH | tr ':' '\n' | awk '$0 != "/bin"' | paste -sd: 
```

更换是

```
echo $PATH | tr ':' '\n' | 
    awk '$0 != "/bin"; $0 == "/bin" { print "/bar" }' | paste -sd: 
```

或（较短但可读性较差）

```
echo $PATH | tr ':' '\n' | awk '$0 == "/bin" { print "/bar"; next } 1' | paste -sd: 
```

无论如何，对于同一个问题，以及很多有用的答案，请参见[此处](https://stackoverflow.com/questions/273909/how-do-i-manipulate-path-elements-in-shell-scripts)。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-12-15T23:23:54.487

好吧，在 bash 中，因为它支持正则表达式，所以我会这样做：

```
PATH=${PATH/:\/home\/user\/bin/} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-01-05T20:54:22.047

我喜欢@BenBlank 对他原始问题的更新中显示的三个函数。为了概括它们，我使用 2 参数形式，它允许我设置 PATH 或我想要的任何其他环境变量：

```
path_append ()  { path_remove $1 $2; export $1="${!1}:$2"; }
path_prepend () { path_remove $1 $2; export $1="$2:${!1}"; }
path_remove ()  { export $1="`echo -n ${!1} | awk -v RS=: -v ORS=: '$1 != "'$2'"' | sed 's/:$//'`"; } 
```

使用示例：

```
path_prepend PATH /usr/local/bin
path_append PERL5LIB "$DEVELOPMENT_HOME/p5/src/perlmods" 
```

请注意，我还添加了一些引号以允许正确处理包含空格的路径名。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2016-07-10T13:08:56.507

> # 从 Bash 中的 $PATH 变量中删除路径的最优雅的方法是什么？

还有什么比 awk 更优雅的呢？

> ```
> path_remove ()  { export PATH=`echo -n $PATH | awk -v RS=: -v ORS=: '$0 != "'$1'"' | sed 's/:$//'`; 
> ```

Python！这是一个更具可读性和可维护性的解决方案，并且很容易检查它是否真的在做你想要的。

假设您要删除第一个路径元素？

```
PATH="$(echo "$PATH" | python -c "import sys; path = sys.stdin.read().split(':'); del path[0]; print(':'.join(path))")" 
```

`echo`（而不是来自,的管道`os.getenv['PATH']`会更短一些，并提供与上述相同的结果，但我担心 Python 可能会对那个环境变量做一些事情，所以最好直接从你关心的环境中管道它.)

类似地从最后删除：

```
PATH="$(echo "$PATH" | python -c "import sys; path = sys.stdin.read().split(':'); del path[-1]; print(':'.join(path))")" 
```

例如，要使这些可重用的 shell 函数可以粘贴在 .bashrc 文件中：

```
strip_path_first () {
    PATH="$(echo "$PATH" | 
    python -c "import sys; path = sys.stdin.read().split(':'); del path[0]; print(':'.join(path))")"
}

strip_path_last () {
    PATH="$(echo "$PATH" | 
    python -c "import sys; path = sys.stdin.read().split(':'); del path[-1]; print(':'.join(path))")"
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-01-21T19:58:30.380

是的，例如，在 PATH 的末尾放置一个冒号可以使删除路径变得不那么笨拙和容易出错。

```
path_remove ()  { 
   declare i newPATH
   newPATH="${PATH}:"
   for ((i=1; i<=${#@}; i++ )); do
      #echo ${@:${i}:1}
      newPATH="${newPATH//${@:${i}:1}:/}" 
   done
   export PATH="${newPATH%:}" 
   return 0; 
} 

path_remove_all ()  {
   declare i newPATH
   shopt -s extglob
   newPATH="${PATH}:"
   for ((i=1; i<=${#@}; i++ )); do
      newPATH="${newPATH//+(${@:${i}:1})*([^:]):/}" 
      #newPATH="${newPATH//+(${@:${i}:1})*([^:])+(:)/}" 
   done
   shopt -u extglob 
   export PATH="${newPATH%:}" 
   return 0 
} 

path_remove /opt/local/bin /usr/local/bin

path_remove_all /opt/local /usr/local 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2011-02-19T05:11:25.150

如果您担心删除$PATH 中的**重复项**，最优雅的方式，恕我直言，首先不要添加它们。在 1 行中：

```
if ! $( echo "$PATH" | tr ":" "\n" | grep -qx "$folder" ) ; then PATH=$PATH:$folder ; fi 
```

$folder 可以替换为任何内容，并且可以包含空格（“/home/user/my documents”）

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2012-04-07T05:29:34.720

迄今为止我发现的最优雅的纯 bash 解决方案：

```
pathrm () {                                                                      
  local IFS=':'                                                                  
  local newpath                                                                  
  local dir                                                                      
  local pathvar=${2:-PATH}                                                       
  for dir in ${!pathvar} ; do                                                    
    if [ "$dir" != "$1" ] ; then                                                 
      newpath=${newpath:+$newpath:}$dir                                          
    fi                                                                           
  done                                                                           
  export $pathvar="$newpath"                                                        
}

pathprepend () {                                                                 
  pathrm $1 $2                                                                   
  local pathvar=${2:-PATH}                                                       
  export $pathvar="$1${!pathvar:+:${!pathvar}}"                                  
}

pathappend () {                                                                    
  pathrm $1 $2                                                                   
  local pathvar=${2:-PATH}                                                       
  export $pathvar="${!pathvar:+${!pathvar}:}$1"                                  
} 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2014-09-22T23:16:25.293

大多数其他建议的解决方案仅依赖于字符串匹配，不考虑包含特殊名称的路径段，如`.`,`..`或`~`. 下面的 bash 函数解析其参数和路径段中的目录字符串，以查找逻辑目录匹配以及字符串匹配。

```
rm_from_path() {
  pattern="${1}"
  dir=''
  [ -d "${pattern}" ] && dir="$(cd ${pattern} && pwd)"  # resolve to absolute path

  new_path=''
  IFS0=${IFS}
  IFS=':'
  for segment in ${PATH}; do
    if [[ ${segment} == ${pattern} ]]; then             # string match
      continue
    elif [[ -n ${dir} && -d ${segment} ]]; then
      segment="$(cd ${segment} && pwd)"                 # resolve to absolute path
      if [[ ${segment} == ${dir} ]]; then               # logical directory match
        continue
      fi
    fi
    new_path="${new_path}${IFS}${segment}"
  done
  new_path="${new_path/#${IFS}/}"                       # remove leading colon, if any
  IFS=${IFS0}

  export PATH=${new_path}
} 
```

测试：

```
$ mkdir -p ~/foo/bar/baz ~/foo/bar/bif ~/foo/boo/bang
$ PATH0=${PATH}
$ PATH=~/foo/bar/baz/.././../boo/././../bar:${PATH}  # add dir with special names
$ rm_from_path ~/foo/boo/../bar/.  # remove same dir with different special names
$ [ ${PATH} == ${PATH0} ] && echo 'PASS' || echo 'FAIL' 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2015-11-22T10:00:54.283

来自 Scratch 的 Linux 定义了三个 Bash 函数`/etc/profile`：

```
# Functions to help us manage paths.  Second argument is the name of the
# path variable to be modified (default: PATH)
pathremove () {
        local IFS=':'
        local NEWPATH
        local DIR
        local PATHVARIABLE=${2:-PATH}
        for DIR in ${!PATHVARIABLE} ; do
                if [ "$DIR" != "$1" ] ; then
                  NEWPATH=${NEWPATH:+$NEWPATH:}$DIR
                fi
        done
        export $PATHVARIABLE="$NEWPATH"
}

pathprepend () {
        pathremove $1 $2
        local PATHVARIABLE=${2:-PATH}
        export $PATHVARIABLE="$1${!PATHVARIABLE:+:${!PATHVARIABLE}}"
}

pathappend () {
        pathremove $1 $2
        local PATHVARIABLE=${2:-PATH}
        export $PATHVARIABLE="${!PATHVARIABLE:+${!PATHVARIABLE}:}$1"
}

export -f pathremove pathprepend pathappend 
```

参考：[http ://www.linuxfromscratch.org/blfs/view/svn/postlfs/profile.html](http://www.linuxfromscratch.org/blfs/view/svn/postlfs/profile.html)

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2018-06-08T01:05:05.543

我知道这个问题是关于 BASH 的，每个人都应该喜欢它，但是因为我喜欢对称，有时我需要使用“csh”，所以我构建了与“path_prepend()”、“path_append()”和“path_remove”等价的()" 优雅的解决方案。

要点是“csh”没有函数，所以我在我的个人 bin 目录中放置了一些类似于函数的 shell 脚本。我为 SOURCE 这些脚本创建别名以更改指定的环境变量。

~/bin/_path_remove.csh：

```
set _resolve = `eval echo $2`
setenv $1 `eval echo -n \$$1 | awk -v RS=: -v ORS=: '$1 != "'${_resolve}'"' | sed 's/:$//'`;
unset _resolve 
```

~/bin/_path_append.csh：

```
source ~/bin/_path_remove.csh $1 $2
set _base = `eval echo \$$1`
set _resolve = `eval echo $2`
setenv $1 ${_base}:${_resolve}
unset _base _resolve 
```

~/bin/_path_prepend.csh：

```
source ~/bin/_path_remove.csh $1 $2
set _base = `eval echo \$$1`
set _resolve = `eval echo $2`
setenv $1 ${_resolve}:${_base}
unset _base _resolve 
```

~/bin/.cshrc：

```
…
alias path_remove  "source ~/bin/_path_remove.csh  '\!:1' '\!:2'"
alias path_append  "source ~/bin/_path_append.csh  '\!:1' '\!:2'"
alias path_prepend "source ~/bin/_path_prepend.csh '\!:1' '\!:2'"
… 
```

你可以像这样使用它们...

```
%(csh)> path_append MODULEPATH ${HOME}/modulefiles 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-12-16T00:21:26.290

由于这往往是相当有问题的，因为没有优雅的方式，我建议通过重新安排解决方案来避免这个问题：建立你的 PATH 而不是试图拆除它。

如果我知道你真正的问题背景，我可以更具体。在此期间，我将使用软件构建作为上下文。

软件构建的一个常见问题是它在某些机器上中断，最终是由于某人如何配置他们的默认 shell（PATH 和其他环境变量）。优雅的解决方案是通过完全指定 shell 环境来使您的构建脚本免疫。对构建脚本进行编码以根据您控制的组装件设置 PATH 和其他环境变量，例如编译器、库、工具、组件等的位置。使每个可配置项成为您可以单独设置、验证和然后在您的脚本中适当使用。

例如，我有一个基于 Maven 的、面向 WebLogic 的 Java 构建，它是我从新雇主那里继承的。构建脚本因脆弱而臭名昭著，我和另一位新员工花了三周时间（不是全职，只是到处，但仍然很多小时）让它在我们的机器上工作。一个重要的步骤是我控制了 PATH，以便我确切地知道正在调用哪个 Java、哪个 Maven 以及哪个 WebLogic。我创建了环境变量来指向这些工具中的每一个，然后我根据这些以及其他一些工具计算了 PATH。类似的技术驯服了其他可配置的设置，直到我们最终创建了一个可重现的构建。

顺便说一句，不要使用 Maven，Java 是可以的，只有在绝对需要它的集群时才购买 WebLogic（否则不需要，尤其是不需要它的专有特性）。

最良好的祝愿。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-12-16T00:43:55.123

与@litb 一样，我为“[如何在shell 脚本中操作$PATH 元素](https://stackoverflow.com/questions/273909/how-do-i-manipulate-path-elements-in-shell-scripts)”这个问题提供了答案，所以我的主要答案就在那里。

和其他 Bourne shell 派生类中的“拆分”功能`bash`最巧妙地使用`$IFS`字段间分隔符来实现。例如，要将位置参数 ( `$1`, `$2`, ...) 设置为 PATH 的元素，请使用：

```
set -- $(IFS=":"; echo "$PATH") 
```

只要 $PATH 中没有空格，它就可以正常工作。让它适用于包含空格的路径元素是一项不平凡的练习 - 留给感兴趣的读者。使用 Perl 等脚本语言处理它可能更简单。

我还有一个脚本，`clnpath`我广泛使用它来设置我的 PATH。[我在“如何避免在 csh 中复制 PATH 变量](https://stackoverflow.com/questions/135754/how-to-keep-from-duplicating-path-variable-in-csh#137981)”的答案中记录了它。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-12-16T02:53:52.037

使这个问题烦人的是第一个和最后一个元素之间的栅栏案例。通过更改 IFS 和使用数组可以优雅地解决该问题，但是我不知道一旦将路径转换为数组形式后如何重新引入冒号。

这是一个稍微不那么优雅的版本，它删除了一个`$PATH`仅使用字符串操作的目录。我已经测试过了。

```
#!/bin/bash
#
#   remove_from_path dirname
#
#   removes $1 from user's $PATH

if [ $# -ne 1 ]; then
  echo "Usage: $0 pathname" 1>&2; exit 1;
fi

delendum="$1"
NEWPATH=
xxx="$IFS"
IFS=":"
for i in $PATH ; do
  IFS="$xxx"
  case "$i" in
    "$delendum") ;; # do nothing
    *) [ -z "$NEWPATH" ] && NEWPATH="$i" || NEWPATH="$NEWPATH:$i" ;;
  esac
done

PATH="$NEWPATH"
echo "$PATH" 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2008-12-16T19:54:14.270

这是一个 Perl 单行代码：

```
PATH=`perl -e '$a=shift;$_=$ENV{PATH};s#:$a(:)|^$a:|:$a$#$1#;print' /home/usr/bin` 
```

该`$a`变量获取要删除的路径。( `s`substitute) 和`print`命令隐式地对`$_`变量进行操作。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2010-01-13T01:35:03.457

好东西在这里。我首先使用这个来避免添加欺骗。

```
#!/bin/bash
#
######################################################################################
#
# Allows a list of additions to PATH with no dupes
# 
# Patch code below into your $HOME/.bashrc file or where it
# will be seen at login.
#
# Can also be made executable and run as-is.
#
######################################################################################

# add2path=($HOME/bin .)                  ## uncomment space separated list 
if [ $add2path ]; then                    ## skip if list empty or commented out
for nodup in ${add2path[*]}
do
    case $PATH in                 ## case block thanks to MIKE511
    $nodup:* | *:$nodup:* | *:$nodup ) ;;    ## if found, do nothing
    *) PATH=$PATH:$nodup          ## else, add it to end of PATH or
    esac                          ## *) PATH=$nodup:$PATH   prepend to front
done
export PATH
fi
## debug add2path
echo
echo " PATH == $PATH"
echo 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2010-01-20T18:28:13.357

启用扩展 globbing 后，可以执行以下操作：

```
# delete all /opt/local paths in PATH
shopt -s extglob 
printf "%s\n" "${PATH}" | tr ':' '\n' | nl
printf "%s\n" "${PATH//+(\/opt\/local\/)+([^:])?(:)/}" | tr ':' '\n' | nl 

man bash | less -p extglob 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2010-01-21T10:14:13.013

扩展的 globbing 单线（嗯，有点）：

```
path_remove ()  { shopt -s extglob; PATH="${PATH//+(${1})+([^:])?(:)/}"; export PATH="${PATH%:}"; shopt -u extglob; return 0; } 
```

似乎没有必要在 1 美元中转义斜线。

```
path_remove ()  { shopt -s extglob; declare escArg="${1//\//\\/}"; PATH="${PATH//+(${escArg})+([^:])?(:)/}"; export PATH="${PATH%:}"; shopt -u extglob; return 0; } 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2010-01-22T17:45:00.210

将冒号添加到 PATH 我们还可以执行以下操作：

```
path_remove ()  { 
   declare i newPATH
   # put a colon at the beginning & end AND double each colon in-between
   newPATH=":${PATH//:/::}:"   
   for ((i=1; i<=${#@}; i++)); do
       #echo ${@:${i}:1}
       newPATH="${newPATH//:${@:${i}:1}:/}"   # s/:\/fullpath://g
   done
   newPATH="${newPATH//::/:}"
   newPATH="${newPATH#:}"      # remove leading colon
   newPATH="${newPATH%:}"      # remove trailing colon
   unset PATH 
   PATH="${newPATH}" 
   export PATH
   return 0 
} 

path_remove_all ()  {
   declare i newPATH extglobVar
   extglobVar=0
   # enable extended globbing if necessary
   [[ ! $(shopt -q extglob) ]]  && { shopt -s extglob; extglobVar=1; }
   newPATH=":${PATH}:"
   for ((i=1; i<=${#@}; i++ )); do
      newPATH="${newPATH//:+(${@:${i}:1})*([^:])/}"     # s/:\/path[^:]*//g
   done
   newPATH="${newPATH#:}"      # remove leading colon
   newPATH="${newPATH%:}"      # remove trailing colon
   # disable extended globbing if it was enabled in this function
   [[ $extglobVar -eq 1 ]] && shopt -u extglob
   unset PATH 
   PATH="${newPATH}" 
   export PATH
   return 0 
} 

path_remove /opt/local/bin /usr/local/bin

path_remove_all /opt/local /usr/local 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2010-01-22T18:34:52.513

在 path_remove_all 中（通过代理）：

```
-newPATH="${newPATH//:+(${@:${i}:1})*([^:])/}" 
+newPATH="${newPATH//:${@:${i}:1}*([^:])/}"        # s/:\/path[^:]*//g 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2011-06-22T21:18:07.367

虽然这是一个非常古老的线程，但我认为这个解决方案可能很有趣：

```
PATH="/usr/lib/ccache:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games"
REMOVE="ccache" # whole or part of a path :)
export PATH=$(IFS=':';p=($PATH);unset IFS;p=(${p[@]%%$REMOVE});IFS=':';echo "${p[*]}";unset IFS)
echo $PATH # outputs /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games 
```

在这篇[博文](http://unstableme.blogspot.com/2009/05/remove-path-from-path-variable-in-bash.html)中找到它。我想我最喜欢这个了:)

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2012-02-06T01:16:56.410

我采取了与这里的大多数人略有不同的方法，并专门关注字符串操作，如下所示：

```
path_remove () {
    if [[ ":$PATH:" == *":$1:"* ]]; then
        local dirs=":$PATH:"
        dirs=${dirs/:$1:/:}
        export PATH="$(__path_clean $dirs)"
    fi
}
__path_clean () {
    local dirs=${1%?}
    echo ${dirs#?}
} 
```

以上是我使用的最终函数的简化示例。我还创建`path_add_before`并`path_add_after`允许您在 PATH 中已有的指定路径之前/之后插入路径。

在我的[dotfiles中的](https://github.com/jimeh/dotfiles)[path_helpers.sh](https://github.com/jimeh/dotfiles/blob/master/shell/helpers/path_helpers.sh)中提供了全套功能。它们完全支持在 PATH 字符串的开头/中间/结尾删除/附加/前置/插入。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2014-05-16T19:36:52.920

尾随 ':' 是由于您设置的是行尾，而不是分隔符。我使用资源有限的单元，喜欢将所有内容打包到一个脚本中，没有这些奇怪的东西：

```
path_remove () {
    PATH="$(echo -n $PATH | awk -v RS=: -v ORS= '$0 != "'$1'"{print s _ $0;s=":"}')"
} 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2014-10-22T19:06:38.563

这当然很优雅，但它确实使用了外部 sed。此外，它会删除所有包含搜索字符串 $1 的路径。如果删除的路径是 PATH 上的最后一个，它也不会在最后留下悬空的 :。

```
PATH=`echo $PATH | sed 's/:[^:]*$1[^:]*//g'` 
```

这个替代方案确实留下了一个悬空的 final : 然而。

```
PATH=`echo $PATH | tr ":" "\n" | grep -v $1 | tr "\n" ":"` 
```

没有反引号的替代方案是：

```
PATH=$(echo $PATH | sed 's/:[^:]*$1[^:]*//g')

PATH=$(echo $PATH | tr ":" "\n" | grep -v $1 | tr "\n" ":") 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2021-11-23T19:50:26.017

Bash 内置 oneliner（不删除重复）： `PATH=${PATH/${PATH/#$DIR:*/$DIR:}/}${PATH/${PATH/*:$DIR*/:$DIR}/}`

* * *

## 回答 #34

> 赞同：-1
> 
> 时间：2019-04-28T10:51:59.863

让我们从 PATH 中“删除”对 /path/to/something 的引用：

重击：

```
PATH=${PATH/something/nope/} 
```

Windows Batch 的奖励答案：

```
set PATH=%PATH:something=nope% 
```

有人有更简单的解决方案吗？:)

# ios - 在 Cocoa Touch 中以编程方式切换视图

> ID：370055
> 
> 赞同：7
> 
> 时间：2008-12-15T23:23:43.177
> 
> 标签：ios, objective-c, iphone, cocoa-touch

如何在 iPhone 应用程序中以编程方式更改屏幕上的视图？

我已经能够创建导航视图并以编程方式推送/弹出它们以产生这种行为，但是如果我想简单地更改当前视图（不使用 UINavigation 控制器对象），实现这一目标的最巧妙方法是什么？

一个简单的例子，想象一个有一个按钮的应用程序，当按下时会显示一个新的视图，或者可能是多个视图之一，这取决于一些内部状态变量。

我还没有看到任何尝试这样做的示例，而且我似乎对 UIViewController/UIView 对象之间的关系和初始化过程了解不够，无法以编程方式实现这一点。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-16T03:29:18.923

我用来`presentModalViewController:animated:`从我的主窗口调出一个设置视图`UIViewController`，然后当用户在设置视图中按下“完成”时，我`dismissModalViewControllerAnimated:`从设置视图调用（返回到父视图），如下所示：

```
[[self parentViewController] dismissModalViewControllerAnimated:YES]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-16T00:10:33.503

你会想要探索`-[UIView addSubview:]`和`-[UIView removeFromSuperview]`。您的基本窗口是一个`UIView`（后代），因此您可以向其添加和删除视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T00:08:04.680

将通用 UIView 推入 UINavigationController 怎么样？

当您想要显示一个特定视图时，只需将其作为子视图添加到先前推送的 UIView。当您想更改视图时，请删除以前的子视图并添加新的子视图。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-17T00:30:36.490

我找到了一个示例程序，它使用 ModalView 来显示视图而不将它们嵌套为 NavigatorControlView。

[iPhone 导航栏演示](http://developer.apple.com/iphone/library/samplecode/NavBar/index.html)

上面的示例链接使用 modalView 作为信息链接。并且还使用导航链接作为表格视图链接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T14:37:29.337

NavBarDemo 很有趣，但最后，据我所知，modalView 只是另一个视图被推送和弹出堆栈。

像地图应用程序这样的情况，当用户开始输入地址时，地图视图会切换到列出搜索选项的表格视图？这两个视图是否已经在启动时初始化，并且搜索结果表视图刚刚设置为可见性 0，当您键入时，它切换到 1，或者它实际上是在文本字段的 touchUpInside 事件上加载的？

我会尝试弄乱 UIView addSubview 以重新创建此操作并发布我的结果

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-10-12T08:02:44.313

您可以使用以下方法：

BaseView.h - 所有其他视图都继承自该视图：

```
@interface BaseView : UIView {}
@property (nonatomic, assign) UIViewController *parentViewController;
@end 
```

BaseView.m

```
@implementation BaseView
@synthesize parentViewController;

- (id)initWithFrame:(CGRect)frame {
    if ((self = [super initWithFrame:frame])) {
        // Initialization code
    }
    return self;
}

- (void)dealloc {
    [self setParentViewController:nil];
    [super dealloc];
}

@end 
```

其他视图可以从 BaseView 继承。他们的代码应该有点像下面：

```
@implementation FirstView

- (id)initWithFrame:(CGRect)frame {
    if ((self = [super initWithFrame:frame])) {
        [self setBackgroundColor:[UIColor yellowColor]];

        UIButton *button1 = [[UIButton alloc] initWithFrame:CGRectMake(0.0f, 0.0f, 200.0f, 30.0f)];
        [button1 setTitleColor:[UIColor blackColor] forState:UIControlStateNormal];
        [button1 setBackgroundColor:[UIColor whiteColor]];
        [button1 setCenter:CGPointMake(160.0f, 360.0f)];
        [button1 setTitle:@"Show Second View" forState:UIControlStateNormal];
        [button1 addTarget:self action:@selector(switchView:) forControlEvents:UIControlEventTouchUpInside];
        [self addSubview:button1];
        [button1 release];      

        UIButton *button2 = [[UIButton alloc] initWithFrame:CGRectMake(0.0f, 0.0f, 200.0f, 30.0f)];
        [button2 setTitleColor:[UIColor blackColor] forState:UIControlStateNormal];
        [button2 setBackgroundColor:[UIColor whiteColor]];
        [button2 setCenter:CGPointMake(160.0f, 120.0f)];
        [button2 setTitle:@"Show Sub View" forState:UIControlStateNormal];
        [button2 addTarget:self action:@selector(showView:) forControlEvents:UIControlEventTouchUpInside];
        [self addSubview:button2];
        [button2 release];              
    }

    return self;
}

- (void)showView:(id)sender {
    if (viewController == nil) {
        viewController = [[SubViewController alloc] initWithNibName:nil bundle:nil];        
    }

    [self addSubview:viewController.view];
}

- (void)switchView:(id)sender {
    SecondView *secondView = [[SecondView alloc] initWithFrame:self.frame];
    [self.parentViewController performSelector:@selector(switchView:) withObject:secondView];
    [secondView release];
}

- (void)dealloc {
    [viewController release];
    [super dealloc];
}

@end 
```

最后，所有视图都需要 1 个 UIViewController。switchView: 方法将被调用来改变当前视图。UIViewController 的代码可能是这样的：

```
@implementation ViewController

- (void)loadView {
    FirstView *firstView = [[FirstView alloc] initWithFrame:CGRectMake(0.0f, 0.0f, 320.0f, 480.0f)];    
    [firstView setParentViewController:self];
    [self setView:firstView];
    [firstView release];
}

- (void)switchView:(BaseView *)newView {
    [newView setParentViewController:self];
    [self retain];
    [self setView:newView];
    [self release];
}

- (void)didReceiveMemoryWarning {
    [super didReceiveMemoryWarning];
}

- (void)viewDidUnload {
    [super viewDidUnload];
}  

- (void)dealloc {
    [super dealloc];
}

@end 
```

您可以在此处下载示例应用程序（在一小时内）：[http ://dl.dropbox.com/u/6487838/ViewSwitch.zip](http://dl.dropbox.com/u/6487838/ViewSwitch.zip)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-10-28T19:13:20.257

这个提示在[Apple 的文档](http://developer.apple.com/library/ios/#documentation/WindowsViews/Conceptual/ViewPG_iPhoneOS/CreatingWindows/CreatingWindows.html#//apple_ref/doc/uid/TP40009503-CH4-SW1)中有所提及，但并不重要。我发现自己很难理解它，而且它非常简单。

只需将主窗口的 rootViewController 属性更改为拥有您要显示的视图层次结构的任何视图控制器。就这么简单。一旦更新了属性，整个窗口内容就会更改为新视图的内容。

# javascript - 如何包含来自 MVC 部分控件的 css 文件？

> ID：370060
> 
> 赞同：13
> 
> 时间：2008-12-15T23:28:20.470
> 
> 标签：javascript, asp.net-mvc, css

我正在使用 ASP.NET MVC，并且我有一个需要包含特定 CSS 和 JS 文件的部分控件。有没有办法让父页面在页面的“head”部分呈现`script`和`link`标签，而不仅仅是在部分控件中内联呈现它们？

为了澄清我想要包含文件的控件是从视图呈现的`Html.RenderPartial`，因此不能在其上具有服务器端内容控件。我希望能够将文件包含在 html`head`部分中，以避免验证问题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-10T02:49:15.090

如果我对局部视图中的 CSS/Javascript 有要求，我只需确保任何可能包含局部视图的页面（直接或作为从 AJAX 检索的内容）的标题中都包含 CSS/Javascript。如果页面有母版页，我会在母版页标题中添加内容占位符并将其填充到子页面中。为了在局部视图中获得智能感知，我在局部视图中添加了 CSS/Javascript 包含但用`if (false)`代码块包装，因此它们在运行时不包含在内。

```
<% if (false) { %>
   <link href=...
   <script type=...
<% } %> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-01-19T19:34:26.167

[http://www.codeproject.com/Articles/38542/Include-Stylesheets-and-Scripts-From-A-WebControl-.aspx](http://www.codeproject.com/Articles/38542/Include-Stylesheets-and-Scripts-From-A-WebControl-.aspx)

本文包含有关覆盖 HttpContext.Response.Filter 的信息，这对我很有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T17:07:42.473

在渲染部分行之前，调用`@import`如下：

```
<style type="text/css>
    @import url(cssPath.css);
</style> 
```

希望这可以帮助。

* * *

[刚刚在 Haacked 上遇到了这个选项](http://haacked.com/archive/2009/01/27/controls-collection-cannot-be-modified-issue-with-asp.net-mvc-rc1.aspx)并记住了你的问题。在局部视图上使用标题的`Content`占位符，然后正常地将 CSS 添加到该表单中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-16T21:45:00.583

如果您愿意打破一致性，您可以只发出带有部分内容的样式定义。这往往适用于最新的浏览器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T03:57:55.997

根据您的控件需要多少 CSS / JS，最安全的方法可能是在您的主 CSS 文件中包含额外的样式。节省了到服务器的额外行程，并且应该全部由客户端缓存。我知道这会扼杀控制的独立性（创造一个短语），但这可能是你最好的选择。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-09T21:39:09.297

抱歉，您不能从部分控件中“向上”引用父页面中的某些内容（或添加任何内容）。唯一的通信是通过传递 ViewData / Model 从父级“向下”到部分。

您正在使用内容占位符描述母版页和普通页的功能，但部分控件的功能并非如此。

但是，如果我没记错的话，您可以将脚本或链接标签物理添加到您呈现部分页面的实际父页面 - 部分页面也应该使用 CSS。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-10T04:33:31.967

托德的回答很好，前提是您只有一个控件实例，并且没有其他代码想要在母版页的标记中“注入”任何内容。不幸的是，你很少能依赖它。

我建议您在母版页中包含您需要的所有 css 文件。第一次访问时会有一个小的性能命中，但之后浏览器缓存将启动。您可以（并且应该）将您的样式拆分为多个 .css 文件，以从可以同时下载它们的 HTTP 代理中受益。至于 .js 文件，我建议实现一些接近`google.load()`机制的东西，这将允许您按需加载脚本。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-01-27T14:19:37.060

我是 MVC 的新手……我最近遇到了挑战。我使用 MVC 视图页面而不是局部视图，添加了自己的母版页（因为我有一个跨多个视图共享的 css）并将 css 添加到 master。希望这些信息有所帮助。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2008-12-15T23:44:22.170

在您的主模板中包含一个占位符：

```
<head runat="server>
    <asp:ContentPlaceHolder ID="head" runat="server" />
</head> 
```

在你的控制之下

```
<asp:Content ID="head" runat="server">
    <script src="something.js"></script>
</asp:Content> 
```

# python - 命令行世界时钟？

> ID：370075
> 
> 赞同：15
> 
> 时间：2008-12-15T23:39:23.597
> 
> 标签：python, timezone, command-line-interface

是否有脚本可以在 *nix 终端上显示简单的世界时钟（世界各地的时间）？

我正在考虑编写一个快速的 Python 脚本，但我感觉工作量会比我想象的要多（例如，由于配置和输出格式）——更不用说重新发明轮子了……

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-12-15T23:50:55.650

我有这个 bourne shell 脚本：

```
#!/bin/sh

PT=`env TZ=US/Pacific date`
CT=`env TZ=US/Central date`
AT=`env TZ=Australia/Melbourne date`

echo "Santa Clara    $PT"
echo "Central        $CT"
echo "Melbourne      $AT" 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-15T23:59:24.603

### 简单的系统

从来没想过，但做起来并不难。

```
#!/bin/sh
# Command-line world clock

: ${WORLDCLOCK_ZONES:=$HOME/etc/worldclock.zones}
: ${WORLDCLOCK_FORMAT:='+%Y-%m-%d %H:%M:%S %Z'}

while read zone
do echo $zone '!' $(TZ=$zone date "$WORLDCLOCK_FORMAT")
done < $WORLDCLOCK_ZONES |
awk -F '!' '{ printf "%-20s  %s\n", $1, $2;}' 
```

给定输入文件：

```
US/Pacific
Europe/London
Europe/Paris
Asia/Kolkatta
Africa/Johannesburg
Asia/Tokyo
Asia/Shanghai 
```

我得到了输出：

```
US/Pacific             2008-12-15 15:58:57 PST
Europe/London          2008-12-15 23:58:57 GMT
Europe/Paris           2008-12-16 00:58:57 CET
Asia/Kolkatta          2008-12-15 23:58:57 GMT
Africa/Johannesburg    2008-12-16 01:58:57 SAST
Asia/Tokyo             2008-12-16 08:58:57 JST
Asia/Shanghai          2008-12-16 07:58:57 CST 
```

我很幸运，这用了不到一秒的时间运行并且没有跨越 1 秒的边界。

（*我没有注意到加尔各答失败并默认为格林威治标准时间。也许我的系统仍然有亚洲/加尔各答作为印度的条目。*）

* * *

### 修正错别字

十一年后，[有人告诉](https://stackoverflow.com/questions/370075/command-line-world-clock/370121?noredirect=1#comment105486264_370121)我，我把Kolkata 拼错了两个 t，而应该只有一个。谢谢你，@ [jbg](https://stackoverflow.com/users/1174521/jbg)。我还在数据文件中添加了两个额外的条目—— `America/St_Johns`（纽芬兰），`Asia/Katmandu`它们分别与 UTC 有半小时和四分之三小时的偏移（加尔各答也有半小时的偏移）。这会产生，例如：

```
US/Pacific             2020-01-09 06:17:40 PST
Europe/London          2020-01-09 14:17:40 GMT
Europe/Paris           2020-01-09 15:17:40 CET
Asia/Kolkata           2020-01-09 19:47:40 IST
Africa/Johannesburg    2020-01-09 16:17:40 SAST
Asia/Tokyo             2020-01-09 23:17:40 JST
Asia/Shanghai          2020-01-09 22:17:40 CST
America/St_Johns       2020-01-09 10:47:40 NST
Asia/Katmandu          2020-01-09 20:02:40 +0545 
```

请注意，这`US/Pacific`是一个不受欢迎的古老时区名称；它应该是`America/Los_Angeles`。

将区域按顺序排序可能是明智的。添加`sort -b -r -k2,2 -k3,3`以按顺序列出区域，其中最早于 UTC 的时区首先列出，最晚的时区最后列出。`-b`选项（忽略字段上的前导空格）很重要。添加另外三个区域 ( `Pacific/Honolulu`, `Pacific/Kwajalein`, `Pacific/Kiritimati`) 并给出：

```
Pacific/Kiritimati     2020-01-10 04:33:25 +14
Pacific/Kwajalein      2020-01-10 02:33:25 +12
Asia/Tokyo             2020-01-09 23:33:25 JST
Asia/Shanghai          2020-01-09 22:33:25 CST
Asia/Katmandu          2020-01-09 20:18:25 +0545
Asia/Kolkata           2020-01-09 20:03:25 IST
Africa/Johannesburg    2020-01-09 16:33:25 SAST
Europe/Paris           2020-01-09 15:33:25 CET
Europe/London          2020-01-09 14:33:25 GMT
America/St_Johns       2020-01-09 11:03:25 NST
US/Pacific             2020-01-09 06:33:25 PST
Pacific/Honolulu       2020-01-09 04:33:25 HST 
```

请注意，基里蒂马蒂和火奴鲁鲁的时间相同，但日期相差一天。排序应该在脚本中，当然：

```
#!/bin/sh
# Command-line world clock

: ${WORLDCLOCK_ZONES:=$HOME/etc/worldclock.zones}
: ${WORLDCLOCK_FORMAT:='+%Y-%m-%d %H:%M:%S %Z'}

while read zone
do echo $zone '!' $(TZ=$zone date "$WORLDCLOCK_FORMAT")
done < $WORLDCLOCK_ZONES |
awk -F '!' '{ printf "%-20s  %s\n", $1, $2;}' |
sort -b -r -k2,2 -k3,3 
```

该`worldclock.zones`文件包含：

```
US/Pacific
Europe/London
Europe/Paris
Asia/Kolkata
Africa/Johannesburg
Asia/Tokyo
Asia/Shanghai
America/St_Johns
Asia/Katmandu
Pacific/Honolulu
Pacific/Kwajalein
Pacific/Kiritimati
Pacific/Pago_Pago
UTC-12 
```

在 UTC+14，Kiritimati 与 UTC 的正偏移量最大。 `Pacific/Pago_Pago`是在 UTC-11 与 UTC 的负偏移量最大的地方之一。如果你去[World Time Zone](https://www.worldtimezone.com/utc/utc-1200.html)，他们列出了两个无人居住的岛屿，如果有人居住，它们可能位于 UTC-12。但是，Olson 数据库没有记录自 1970 年 1 月 1 日截止日期以来无人居住的地方的时区信息，因此它们没有被列出。

### 环游世界 26 个时区

为了娱乐（简单的头脑很容易偏离轨道），这里有一个时区名称列表，其中一个名称来自世界上大多数时区偏移量。如果有任何其他小数小时偏移量正在使用（澳大利亚？），请告诉我。请注意标准时间与夏令时 - 南半球的某些条目可能处于夏令时。在 2020 年 1 月，该列表会生成所有积分小时偏移量，但在 2020 年 6 月可能不会这样做。

该列表包括两个组成的区域名称：`FarEast-12`和`FarWest+12`，分别为 UTC+12 和 UTC-12。正面和负面之间的冲突是因为存在相互冲突的标准。ISO 8601 规定 UTC 以东（格林威治子午线，或多或少）的地方使用与 UTC 的正偏移，而 UTC 以西的地方使用负偏移。同时，POSIX（又名 ISO 9045）指定了相反的约定——UTC 以西的地方使用正偏移量，而东部的地方使用负偏移量。这两个名称是用于 TZ 环境变量的 POSIX 时区名称，并指定了偏移量且没有夏令时规则。它们受 POSIX 偏移规则的约束。为什么会出现差异？从根本上说，POSIX 遵循 Unix 的约定——它不能在不破坏大量代码的情况下改变它们。

区域名称列表：

```
US/Pacific
Europe/London
Europe/Paris
Asia/Kolkata
Africa/Johannesburg
Asia/Tokyo
Asia/Shanghai
America/St_Johns
Asia/Katmandu
Pacific/Honolulu
Pacific/Kwajalein
Pacific/Kiritimati
Pacific/Pago_Pago
FarEast-12
FarWest+12
US/Eastern
US/Central
US/Mountain
US/Alaska
Asia/Vladivostok
Pacific/Noumea
Pacific/Enderbury
Asia/Bangkok
Asia/Thimphu
Asia/Aqtau
Asia/Dubai
Africa/Addis_Ababa
Atlantic/Cape_Verde
Atlantic/South_Georgia
America/Santiago
America/Halifax 
```

修改后的脚本的示例输出（排序到位）：

```
Pacific/Kiritimati        2020-01-10 05:24:10 +14
Pacific/Enderbury         2020-01-10 04:24:10 +13
Pacific/Kwajalein         2020-01-10 03:24:10 +12
FarEast-12                2020-01-10 03:24:10 FarEast
Pacific/Noumea            2020-01-10 02:24:10 +11
Asia/Vladivostok          2020-01-10 01:24:10 +10
Asia/Tokyo                2020-01-10 00:24:10 JST
Asia/Shanghai             2020-01-09 23:24:10 CST
Asia/Bangkok              2020-01-09 22:24:10 +07
Asia/Thimphu              2020-01-09 21:24:10 +06
Asia/Katmandu             2020-01-09 21:09:10 +0545
Asia/Kolkata              2020-01-09 20:54:10 IST
Asia/Aqtau                2020-01-09 20:24:10 +05
Asia/Dubai                2020-01-09 19:24:10 +04
Africa/Addis_Ababa        2020-01-09 18:24:10 EAT
Africa/Johannesburg       2020-01-09 17:24:10 SAST
Europe/Paris              2020-01-09 16:24:10 CET
Europe/London             2020-01-09 15:24:10 GMT
Atlantic/Cape_Verde       2020-01-09 14:24:10 -01
Atlantic/South_Georgia    2020-01-09 13:24:10 -02
America/Santiago          2020-01-09 12:24:10 -03
America/St_Johns          2020-01-09 11:54:10 NST
America/Halifax           2020-01-09 11:24:10 AST
US/Eastern                2020-01-09 10:24:10 EST
US/Central                2020-01-09 09:24:10 CST
US/Mountain               2020-01-09 08:24:10 MST
US/Pacific                2020-01-09 07:24:10 PST
US/Alaska                 2020-01-09 06:24:10 AKST
Pacific/Honolulu          2020-01-09 05:24:10 HST
Pacific/Pago_Pago         2020-01-09 04:24:10 SST
FarWest+12                2020-01-09 03:24:10 FarWest 
```

时间流逝; 现在是东京的午夜过后。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-06T10:10:01.877

我使用它，这与其他建议基本相同，除了它过滤您想要查看的特定区域：

```
#!/bin/sh

# Show date and time in other time zones

search=$1

zoneinfo=/usr/share/zoneinfo/posix/
format='%a %F %T'

find -L $zoneinfo -type f \
    | grep -i "$search" \
    | while read z
      do
          d=$(TZ=$z date +"$format")
          printf "%-34s %23s\n" ${z#$zoneinfo} "$d"
      done 
```

样本输出：

```
$ /usr/local/bin/wdate bang
Africa/Bangui                      Fri 2009-03-06 11:04:24
Asia/Bangkok                       Fri 2009-03-06 17:04:24 
```

**更新：**

在带有 的当前系统上`systemd`，`timedatectl list-timezones`可以替换通过文件系统搜索来获取时区名称。

因此，该脚本的更简单版本现在可以是：

```
#!/bin/sh

# Show date and time in other time zones

search=$1
format='%a %F %T'

timedatectl list-timezones \
| grep -i "$search"        \
| while read z
  do
      d=$(TZ=$z date +"$format")
      printf "%-34s %23s\n" "$z" "$d"
  done 
```

`find`或者如果`timedatectl`命令不可用，则回退到完整版本：

```
#!/bin/sh

# Show date and time in other time zones

search=$1

zoneinfo=/usr/share/zoneinfo/posix/
format='%a %F %T'

if command -v timedatectl >/dev/null; then
    tzlist=$(timedatectl list-timezones)
else
    tzlist=$(find -L $zoneinfo -type f)
fi

grep -i "$search" <<< "$tzlist" \
| while read z
  do
      d=$(TZ=$z date +"$format")
      printf "%-34s %23s\n" ${z#$zoneinfo} "$d"
  done 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-15T23:48:56.857

如果您仍然想用 Python 编写它，请考虑 Pytz：

[http://pytz.sourceforge.net/](http://pytz.sourceforge.net/)

他们的首页向您展示了许多简单的方法来完成您正在寻找的东西。

也就是说，我敢肯定，如果您在 Google 上花费几分钟，您会发现大量脚本，其中一些甚至可以为 *nix 启动图形程序。“python 世界时钟”的第一个结果列表似乎单独表明了这一点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-11-01T00:09:25.733

我创建了一个[简单的 shell 脚本](https://gist.github.com/tjirab/a3a72112055d4a894eb16f1616ff947b)，您可以调用它来打印该给定位置的位置和日期/时间。它此时此刻的逻辑：

```
TIME_ZONES="Europe/Amsterdam America/Los_Angeles Europe/Dublin"
OUTPUT=""

for loc in $TIME_ZONES; do
    CITY=`echo $loc | sed 's/\// /g' | awk '{ print $2 }'`
    CUR_TIME=`TZ=${loc} date | awk '{ print $2 " " $3 " " $5 }'`
    TEMP=`awk -v l="$CITY" -v t="$CUR_TIME" 'BEGIN { print l "\t" t }'`
    OUTPUT="${OUTPUT}\n${TEMP}"
done

echo $OUTPUT | column -t 
```

回报：

```
Amsterdam    1   Nov  01:03:30
Los_Angeles  31  Oct  17:03:30
Dublin       1   Nov  00:03:30 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-08-13T23:52:02.723

[./cpython-2.7/Demo/curses/tclock.py](https://hg.python.org/cpython/file/2.7/Demo/curses/tclock.py)是`tclock.c`1994 ASCII 模拟/数字时钟的端口`curses`，来自 ncurses-examples。用法：

```
$ TZ=Europe/Paris python tclock.py 
```

这是[视频](https://youtu.be/AnEETGuJ-4Q?t=35s)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-08-13T20:02:00.070

我喜欢提供的脚本[mivk](https://stackoverflow.com/users/111036/mivk)。因为我希望能够在没有正则表达式的情况下指定多个区域，所以当我无法让 bourne shell 处理数组时，我调整了脚本以使用 bash。无论如何，享受并感谢一个很棒的论坛：

```
#!/usr/bin/env bash                                                             

# Show date and time in other time zones, with multiple args                                        

elements=$@

zoneinfo=/usr/share/zoneinfo
format='%a %F %T'

for search in ${elements[@]}; do

  find $zoneinfo -type f \
      | grep -i "$search" \
      | while read z
        do
            d=$(TZ=$z date +"$format")
            printf "%-34s %23s\n" ${z#$zoneinfo} "$d"
        done
done 
```

样本输出：

`/usr/local/bin/wdate Sydney Stockholm /Australia/Sydney Fri 2015-08-14 05:54:26 /Europe/Stockholm Thu 2015-08-13 21:54:26`

# python - 如何在算术表达式的结果上放置 SQLAlchemy 标签？

> ID：370077
> 
> 赞同：4
> 
> 时间：2008-12-15T23:39:59.760
> 
> 标签：python, sqlalchemy

我如何将这样的东西翻译成 SQLAlchemy？

```
select x - y as difference... 
```

我知道该怎么做：

```
x.label('foo') 
```

...但我不确定将“.label()”方法调用放在下面的位置：

```
select ([table.c.x - table.c.y], ... 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-16T06:52:24.643

该`ColumnElement`方法只是一个帮手；[label()](http://docs.sqlalchemy.org/en/latest/core/expression_api.html#sqlalchemy.sql.expression.label)可以通过以下方式使用：

```
select([sql.expression.label('foo', table.c.x - table.c.y), ...]) 
```

# c# - PInvoke 用于返回 char * 的 C 函数

> ID：370079
> 
> 赞同：54
> 
> 时间：2008-12-15T23:42:07.400
> 
> 标签：c#, pinvoke

我正在尝试编写一些从非托管 DLL 调用方法的 C# 代码。dll中函数的原型是：

```
extern "C" __declspec(dllexport) char *foo(void); 
```

在 C# 中，我首先使用：

```
[DllImport(_dllLocation)]
public static extern string foo(); 
```

它似乎在表面上工作，但我在运行时遇到内存损坏错误。我想我指的是恰好是正确的但已经被释放的内存。

我尝试使用名为“P/Invoke Interop Assistant”的 PInvoke 代码生成实用程序。它给了我输出：

```
[System.Runtime.InteropServices.DLLImportAttribute(_dllLocation, EntryPoint = "foo")]
public static extern System.IntPtr foo(); 
```

它是否正确？如果是这样，如何将此 IntPtr 转换为 C# 中的字符串？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2008-12-16T05:18:26.393

您必须将此作为 IntPtr 返回。从 PInvoke 函数返回 System.String 类型需要非常小心。CLR 必须将内存从本机表示转移到托管表示。这是一个简单且可预测的操作。

但问题在于如何处理从`foo()`. CLR 假设以下两项关于直接返回字符串类型的 PInvoke 函数

1.  需要释放本机内存
2.  本机内存是使用 CoTaskMemAlloc 分配的

因此，它将编组字符串，然后调用`CoTaskMemFree(...)`本机内存 blob。除非您实际上使用 CoTaskMemAlloc 分配了此内存，否则这充其量只会导致您的应用程序崩溃。

为了在此处获得正确的语义，您必须直接返回 IntPtr。然后使用 Marshal.PtrToString* 以获取托管字符串值。您可能仍然需要释放本机内存，但这将取决于 foo 的实现。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-12-15T23:46:22.353

您可以使用 Marshal.PtrToStringAuto 方法。

```
IntPtr ptr = foo();
string str = Marshal.PtrToStringAuto(ptr); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-04-09T11:27:57.120

目前的答案并不完整，所以我只想在一个地方发布完整的解决方案。返回 IntPtr 而不是 string 根本不能解决任何问题，因为您仍然必须释放 C 脚本中分配的本机内存。最好的解决方案是在托管端分配字节缓冲区并将内存传递给 C 脚本，该脚本将字符串写入该缓冲区而不分配内存。

从 C 中返回一个字符串就像这样：

```
//extern "C" __declspec(dllexport) uint32_t foo(/*[out]*/ char* lpBuffer, /*[in]*/ uint32_t uSize)
uint32_t __stdcall foo(/*[out]*/ char* lpBuffer, /*[in]*/ uint32_t uSize)
{
  const char szReturnString[] = "Hello World";
  const uint32_t uiStringLength = strlen(szReturnString);

  if (uSize >= (uiStringLength + 1))
  {
    strcpy(lpBuffer, szReturnString);
    // Return the number of characters copied.
    return uiStringLength;
  }
  else
  {
    // Return the required size
    // (including the terminating NULL character).
    return uiStringLength + 1;
  }
} 
```

C#代码：

```
[DllImport(_dllLocation, CallingConvention=CallingConvention.StdCall, CharSet=CharSet.Ansi)]
private static extern uint foo(IntPtr lpBuffer, uint uiSize);

private static string foo()
{
    // First allocate a buffer of 1 byte.
    IntPtr lpBuffer = Marshal.AllocHGlobal(1);
    // Call the API. If the size of the buffer
    // is insufficient, the return value in
    // uiRequiredSize will indicate the required
    // size.
    uint uiRequiredSize = foo(lpBuffer, 1);

    if (uiRequiredSize > 1)
    {
        // The buffer pointed to by lpBuffer needs to be of a
        // greater size than the current capacity.
        // This required size is the returned value in "uiRequiredSize"
        // (including the terminating NULL character).
        lpBuffer = Marshal.ReAllocHGlobal(lpBuffer, (IntPtr)uiRequiredSize);
        // Call the API again.
        foo(lpBuffer, uiRequiredSize);
    }

    // Convert the characters inside the buffer
    // into a managed string.
    string str = Marshal.PtrToStringAnsi(lpBuffer);

    // Free the buffer.
    Marshal.FreeHGlobal(lpBuffer);
    lpBuffer = IntPtr.Zero;

    // Display the string.
    Console.WriteLine("GetString return string : [" + str + "]");

    return str;
} 
```

使用 StringBuilder 在 C# 端管理内存分配/释放有更简单的方法：

```
[DllImport("TestDLL.dll", CallingConvention = CallingConvention.StdCall, CharSet = CharSet.Ansi)]
private static extern uint foo(StringBuilder lpBuffer, UInt32 uiSize);

private static string foo()
{
    StringBuilder sbBuffer = new StringBuilder(1);
    uint uiRequiredSize = foo(sbBuffer, (uint)sbBuffer.Capacity);

    if (uiRequiredSize > sbBuffer.Capacity)
    {
        // sbBuffer needs to be of a greater size than current capacity.
        // This required size is the returned value in "uiRequiredSize"
        // (including the terminating NULL character).
        sbBuffer.Capacity = (int)uiRequiredSize;
        // Call the API again.
        foo(sbBuffer, (uint)sbBuffer.Capacity);
    }

    return sbBuffer.ToString();
} 
```

有一个[很好的主题](https://limbioliong.wordpress.com/2011/11/01/using-the-stringbuilder-in-unmanaged-api-calls/)解释了从 C/C++ 代码返回字符串的不同方式。

# xml - 如何将动态 URL 从 XML 传递到 ActionScript 3 中的 onClick 鼠标事件？

> ID：370086
> 
> 赞同：1
> 
> 时间：2008-12-15T23:44:43.773
> 
> 标签：xml, flash, actionscript-3, actionscript

我正在加载 XML，并且能够将 XML 节点读入我闪存中的文本字段中。它也在加载 URL，但是是循环中的最后一个。它没有加载我单击的那个。我尝试使用`event.target`，但这不起作用。我很接近弄清楚它，我只是不知道在哪里看。

```
// loads xml 
var xml:XML = new XML();
var loader:URLLoader = new URLLoader();
loader.load(new URLRequest(audioPlaylist));
loader.addEventListener(Event.COMPLETE, onComplete);

function onComplete(evt:Event):void {
        xml = XML(evt.target.data);
        xmlList = xml.children();
        trace(xmlList);
        trackLength = xmlList.children().children().length();
        trace(trackLength);

        for(var i:int = 0; i < trackLength; i++) {
            trace(i);
            var track:Playlist_item = new Playlist_item();
            track.y = i * 28;

            track.playlist_text.text = xmlList.children().track[i].toString();
            trackURL = xmlList.children().track[i].@rel.toString();

            trace(trackURL);

            playlist_container.addChild(track);
            track.buttonMode = true;
            track.mouseChildren=false;

            track.addEventListener(MouseEvent.MOUSE_OVER, onCarHover);
            track.addEventListener(MouseEvent.MOUSE_OUT, onCarOut);
            track.addEventListener(MouseEvent.CLICK, onClickLoadData);

        }

}

function onCarHover(event:MouseEvent):void {
    event.target.gotoAndStop(6);
}

function onCarOut(event:MouseEvent):void {
    event.target.gotoAndStop(10);
}

function onClickLoadData(event:MouseEvent):void {
    ns.play(trackURL);
} 
```

* * *

我越来越近了，我设法创建了一个带有索引值的数组 - 所以现在我可以从数组中选择不同的 URL 来播放，但我仍然不确定如何定位我直接点击的那个和有那个戏。

这是我更新的代码：

```
// xml variables
var xmlList:XMLList;
var trackLength:Number;
var trackURL;
var trackNum:Number = -1;
var tracksArray:Array = new Array();

// loads xml 
var xml:XML = new XML();
var loader:URLLoader = new URLLoader();
loader.load(new URLRequest(audioPlaylist));
loader.addEventListener(Event.COMPLETE, onComplete);

function onComplete(evt:Event):void {
        xml = XML(evt.target.data);
        xmlList = xml.children();
        trace(xmlList);
        trackLength = xmlList.children().children().length();

        while (trackNum < trackLength) {
            trackNum = trackNum + 1;
            trace(trackNum);

            var track:Playlist_item = new Playlist_item();
            track.y = trackNum * 28;
            playlist_container.addChild(track);

            track.buttonMode = true;
            track.mouseChildren=false;

            track.playlist_text.text = xmlList.children().track[trackNum].toString();
            //trackURL = xmlList.children().track[trackNum].@rel.toString();

            tracksArray[trackNum] = xmlList.children().track[trackNum].@rel.toString();

            track.addEventListener(MouseEvent.MOUSE_OVER, onCarHover);
            track.addEventListener(MouseEvent.MOUSE_OUT, onCarOut);
            track.addEventListener(MouseEvent.CLICK, onClickLoadData);

        }   

}

function onCarHover(event:MouseEvent):void {
    event.target.gotoAndStop(6);
}

function onCarOut(event:MouseEvent):void {
    event.target.gotoAndStop(10);
}

function onClickLoadData(event:MouseEvent):void {

    trace(tracksArray[5]);

    trace(event.target.trackNum);
    ns.play(tracksArray[5]);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-18T20:50:51.533

在我看来，你让自己很难受。我可能不正确，因为很难遍历您提供的代码。XML 播放列表和单击显示对象播放声音的概念非常简单，我将进行演示。

XML

```
<?xml version="1.0" encoding="utf-8"?>
<xml>
    <item title="Song 1" path="audio/song1.mp3" />
    <item title="Song 2" path="audio/song2.mp3" />
    <item title="Song 3" path="audio/song3.mp3" />
    <item title="Song 4" path="audio/song4.mp3" />
    <item title="Song 5" path="audio/song5.mp3" />
    <item title="Song 6" path="audio/song6.mp3" />
</xml> 
```

ActionScript 3 代码

```
package
{
    import flash.display.Sprite;
    import flash.events.Event;
    import flash.events.MouseEvent;
    import flash.net.URLLoader;
    import flash.net.URLRequest;

    public class DocumentClass extends Sprite
    {
        private var _urlLoader:URLLoader;
        private var _urlRequest:URLRequest;
        private var _xml:XML;
        private var _xmlList:XMLList;

        public function DocumentClass():void
        {
            _urlLoader = new URLLoader();
            _urlRequest = new URLRequest();
            _urlRequest.url = 'path/to/playlist.xml';

            _urlLoader.addEventListener(Event.COMPLETE, onXMLLoaded);
            _urlLoader.load(_urlRequest);
        }
        private function onXMLLoaded(e:Event):void
        {
            _xml = new XML(e.target.data);
            _xmlList = new XMLList(_xml.item);

            //We use the index in the XML object as its ID. (The XML object/List is an array);
            for(var i:int = 0; i < _xmlList.length(); i++)
            {
                var s:MovieClip = new MovieClip();
                addChild(s);
                s.mouseChildren = false;

                var tf:TextField = new TextField();
                tf.text = _xmlList[i].@title;
                tf.y = i * 12 + 20; //Seperates the textfields by 12 px starting at y:20;
                s.path = _xmlList[i].@path;
                s.addChild(tf);
                s.addEventListener(MouseEvent.MOUSE_DOWN, onSDown);
            }
        }
        private var onSDown(e:MouseEvent):void
        {
            var s:Sound = new Sound(new URLRequest(e.target.path));
            s.play();
        }
    }
} 
```

所以我们将 XML 加载到我们的文档类中。我们循环遍历 xml length(); 很多次，即 XML 对象中有多少个子项。对于每个循环或子循环，我们创建一个 MovieClip，向其中添加一个文本字段，标记该文本字段，然后将“路径”属性 (xmlList[int].@path) 添加到包含该动画剪辑的属性，其值为当前来自 xml 的子路径属性。MouseEvent 被视为 MovieClip，我们告诉里面的文本字段不要接收鼠标输入。

我希望这会有所帮助，将文本包装在 MovieClip 中，我们可以为其添加属性，事件方法可以通过目标 s 访问这些属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T17:45:08.850

我找到了解决问题的方法！

我的解决方案是创建一个存储所有 URL 的数组`trackNum`，然后在我的 while 循环中创建实例名称。然后，我用`event.target.name`substring 来修剪文本，只留下数字。效果很棒！

```
// xml variables
var xmlList:XMLList;
var trackLength:Number;
var trackURL;
var trackNum:Number = -1;
var tracksArray:Array = new Array();

// loads xml 
var xml:XML = new XML();
var loader:URLLoader = new URLLoader();
loader.load(new URLRequest(audioPlaylist));
loader.addEventListener(Event.COMPLETE, onComplete);

function onComplete(evt:Event):void {
        xml = XML(evt.target.data);
        xmlList = xml.children();
        trace(xmlList);
        trackLength = xmlList.children().children().length();

        while (trackNum < trackLength) {
            trackNum = trackNum + 1;

            var track:Playlist_item = new Playlist_item();
            track.y = trackNum * 28;
            playlist_container.addChild(track);
            track.name = "track" + [trackNum];

            trace(track);

            track.buttonMode = true;
            track.mouseChildren=false;

            track.playlist_text.text = xmlList.children().track[trackNum].toString();
            //trackURL = xmlList.children().track[trackNum].@rel.toString();

            tracksArray[trackNum] = xmlList.children().track[trackNum].@rel.toString();

            track.addEventListener(MouseEvent.MOUSE_OVER, onCarHover);
            track.addEventListener(MouseEvent.MOUSE_OUT, onCarOut);
            track.addEventListener(MouseEvent.CLICK, onClickLoadData);

        }   

}

function onCarHover(event:MouseEvent):void {
    event.target.gotoAndStop(6);
}

function onCarOut(event:MouseEvent):void {
    event.target.gotoAndStop(10);
}

function onClickLoadData(event:MouseEvent):void {

    //trace(tracksArray[5]);

    trace(event.target.name.substr(5));

    ns.play(tracksArray[event.target.name.substr(5)]);
} 
```

# oracle - Oracle 函数并发

> ID：370087
> 
> 赞同：3
> 
> 时间：2008-12-15T23:44:45.803
> 
> 标签：oracle, concurrency, plsql, function, triggers

我目前有一个 INSERT TRIGGER，它在 Oracle 10g 中运行一个自定义函数，该函数生成一个时髦的字母数字代码，用作插入的一部分。

我真的需要确保函数（甚至触发器）是线程安全的，这样如果两个用户同时激活触发器，触发器中使用的函数不会为两个用户返回相同的代码。

触发器中的流程如下：

开始

1.  根据业务逻辑判断是否需要继续
2.  运行自定义函数以获取新代码
3.  使用返回的代码作为插入到不同的表中

结尾

主要问题是，如果在第 2 步运行时，一个单独的线程触发触发器，该触发器也进入第 2 步，并返回与第一个线程相同的代码。（我知道这是一个非常紧张的情况，但我们需要处理它）。

我想到了两种主要的方法：

目前我想到的目前最好的方法是在触发器一开始就以“独占模式”锁定触发器中使用的表，并且**不**指定锁的NOWAIT属性。这样，触发器的每个后续激活都会“停止并等待”锁可用，因此等待其他线程完成触发器。

我很想锁定表任何拒绝读取表，但我似乎可以找到如何在 Oracle 中执行此操作。

我的想法并不理想，但应该可行，但是我很想听听任何可能对此有更好想法的人！

非常感谢您提供的任何帮助。

干杯，马克

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-15T23:51:46.740

无需在这里计算排他性。Oracle 通过管理您的事务来做到这一点。

关键是您的“自定义函数”的每次调用都需要返回一个唯一的代码。

这意味着不使用系统日期/时间，而是使用其他东西来确保唯一性。

我推荐这个：

```
select sys_guid() from dual; 
```

用来加盐`sys_guid()`你的功能，一切都应该在触发地里。

只是请不要尝试使用此值更新不同的表，否则您将需要处理变异表等。

编辑：显然，正如其他几个人提到的那样，在触发器中使用序列来播种您的函数是另一个很好的建议，因为 Oracle 强制执行唯一性。使用它作为种子虽然可能会产生可预测的结果，所以如果“自定义功能”是密码重置或类似的东西，请小心。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T04:15:54.693

一种解决方案是使用 Oracle 序列提供给生成唯一字符串的自定义代码。Oracle 正是出于这个原因提供了序列——因此生成唯一 ID 的方法是线程安全的。[在此处](http://download.oracle.com/docs/cd/B10501_01/server.920/a96540/sql_elements6a.htm)查找Oracle 9i（我使用的版本）的文档。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-16T02:07:51.863

“你根本不需要知道它是什么，它只是函数生成的代码”它必须是基于时间的，因为我们需要知道其他任何东西才能给出适当的答案。不确定是否影响您的吞吐量。您可以将 DBMS_LOCK.REQUEST 视为 1a，将 DBMS_LOCK.SLEEP 视为 2a，将 DBMS_LOCK.RELEASE 视为 2b。这可以确保每个锁都保持一秒钟，以便在任何一秒钟内只能发生一次插入。

如果它是基于序列的 Oracle 确保您不会两次获得相同的序列

如果它取决于会话/包状态（例如，在会话中递增），则会话一次只能发生一个插入（尽管它可能是多行插入...选择甚至是多表插入） .

如果它依赖于数据库状态（即函数执行查询），您需要考虑事务，而不是语句。您仍然可以使用 DBMS_LOCK，但您需要在提交后手动释放锁，以确保等待会话确实等到新数据提交并可见。

# git - 如何让网络视图在 GitHub 中工作？

> ID：370094
> 
> 赞同：-1
> 
> 时间：2008-12-15T23:47:06.377
> 
> 标签：git, github

我已经运行了[此处找到](https://github.com/account)的建议命令，但我似乎仍然无法让网络视图正常工作。这是页面/视图的内容：

> 如果这是一个 Github 存储库，您可以设置您的凭据以查看您的网络
> git config github.user REPO_USER
> git config github.repo REPO_NAME

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-20T16:40:31.160

```
git config github.user thrashr888@example.com  
git config github.repo the_actual_repo_name_at_github 
```

这次似乎对我有用。

此外，编辑`.git/config`文件可以更深入地了解设置的内容。当设置不正确时很容易看出。

# php - 在 Symfony 的 CSS 文件中使用 PHP 变量

> ID：370108
> 
> 赞同：3
> 
> 时间：2008-12-15T23:52:02.560
> 
> 标签：php, css, symfony1, dynamic-css

我很想在我的 CSS 文件中使用 PHP 变量，但我不想为每个文件加载加载整个 Symfony 堆栈。有人有任何最佳实践和/或插件来管理他们在 Symfony 中的 CSS 文件吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-27T13:01:30.183

但是你不需要完整的 symfony 堆栈（除非你需要一些内部 symfony 状态/变量）。

你只需使用

```
<link rel="stylesheet" type="text/css" media="screen" href="/css/mycss.php" /> 
```

然后你可以在你的css中使用php。您可以在 php.ini 中添加适当的标题（文本/css）和标题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-16T01:56:59.077

这是一个尝试管理和/或组合您的资产的好插件：

[http://www.symfony-project.org/plugins/sfCombinePlugin](http://www.symfony-project.org/plugins/sfCombinePlugin)

这是他们的描述：

> 在运行时将多个 JavaScript 和 CSS 文件合并为一个 JavaScript 和一个 CSS 文件，以最大限度地减少呈现给定页面所需的 HTTP 请求数量。这个插件在分布式环境中工作，支持资产版本密钥，并且是高度可定制的。

此外，由于它是编译的，只要变量保存在同一个文件中，您*就可以使用简单的 PHP。*

# ajax - 负载平衡、AJAX 和您

> ID：370109
> 
> 赞同：2
> 
> 时间：2008-12-15T23:52:54.820
> 
> 标签：ajax, asp.net-mvc, load-balancing

如果您是 Asp.Net MVC 环境中的异步 javascript 调用，并且您必须使用循环式负载平衡器，您能找到回家的路吗？

编辑：添加说明..使用内存会话状态。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-15T23:55:58.230

我会用粘性会话配置我的负载均衡器以避免这个问题。

使用粘性会话，您将在会话期间一遍又一遍地被引导到同一台服务器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-16T00:10:48.667

如果您的应用程序是无状态的，则无关紧要。无论是对您的服务器的标准 HTTP 请求还是基于 Ajax 的请求，如果您的应用程序不依赖于服务器端状态（例如会话），那么在后续请求中访问不同的服务器应该没有关系。

*编辑*- 考虑到您在内存会话状态中使用的问题更新，那么您解决标准页面请求问题的方法将隐含地解决 Ajax。您基本上有两种方法 - 通过负载平衡器的粘性会话，以便同一个用户获得相同的服务器，或者通过缓存/存储机制在服务器之间共享会话状态。

# c# - 在 C# 中的“保存”对话框上显示消息框

> ID：370113
> 
> 赞同：0
> 
> 时间：2008-12-15T23:54:48.623
> 
> 标签：c#, winforms

```
SaveFileDialog savefileDialog1 = new SaveFileDialog();
DialogResult result  = savefileDialog1.ShowDialog();
switch(result == DialogResult.OK)
    case true:
        //do something
    case false:
        MessageBox.Show("are you sure?","",MessageBoxButtons.YesNo,MessageBoxIcon.Question); 
```

在保存对话框上单击“取消”后如何在保存对话框上显示消息框，即保存对话框应该出现在背景上。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-16T01:20:44.610

如果在“文件保存”对话框的“取消”上需要消息框的原因是因为您正在关闭未保存的更改，那么我建议将对“文件保存”对话框的调用置于循环中，直到标志设置为如果结果不正确，请停止循环并调用消息框。例如：

```
// lead-up code

SaveFileDialog sft = new SaveFileDialog();
BOOL bDone;
do
{
  if (DialogResult.OK == sft.ShowDialog())
    bDone = true;
  else
  {
    DialogResult result = MessageBox.Show("Are you sure you don't want to save the changed file?", "", MessageBoxButtons.YesNo, MessageBoxIcon.Question);
    bDone = (result == Yes) ? true : false;
  }
} while (!bDone);

// carry on 
```

这样，文件保存对话框的行为与它在其他 Windows 应用程序中的行为方式一致，如果用户在文件保存对话框中不小心点击了取消，*您*可以让用户再次保存文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T00:03:59.367

你不能在`SaveFileDialog`课堂上做到这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-16T00:15:13.993

我将不得不第二个lubos。无法使用 SaveFileDialog 类完成。

您基本上想要做的是捕获 SaveFileDialog 上的特定按钮单击事件，这是该类不提供给您的事件。如果您真的想要这种功能，一个解决方案是滚动您自己的保存对话框，以便您可以按照自己的方式处理每个按钮单击。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-16T00:16:16.987

据我所知，您无法使用 SaveFileDialog 在纯 .Net 中完成您想要的。如果您去 Windows 并侦听实际的 Windows 消息并响应单击事件消息等，您可能可以完成它。我宁愿避免这样做。

您可能会寻找第 3 方对话类，或编写自己的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-16T00:19:28.633

制作一个与文件系统互操作的用户界面与大多数其他 Windows 程序的工作方式不同的程序通常不是一个好主意。这就是为什么没有简单的方法来做到这一点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-16T01:11:37.423

您可以通过一些修改来做到这一点：

```
 private void Form1_Load(object sender, EventArgs e)
    {
        DialogResult result = showDialog();
        if (result == DialogResult.OK)
        {
            //Ok
        }
        else
        {
            DialogResult r = MessageBox.Show("Are you sure?", "Sure?", MessageBoxButtons.YesNo);
            if(r.ToString()=="No")
            {
                showDialog();
            }
        }
    }

    public DialogResult showDialog()
    {
        SaveFileDialog savefileDialog1 = new SaveFileDialog();
        DialogResult result = savefileDialog1.ShowDialog();
        return result;
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-07T17:51:24.790

顺便说一句，有一种更有效的方式来显示和检查 Dialog。像这样：

```
SaveFileDialog saveFileDialog1 = new SaveFileDialog();

if( saveFileDialog1.ShowDialog() == DialogResult.OK )
{
   // Code here...
} else Application.DoEvents(); 
```

# java - 如何将上下文菜单添加到 Java 应用程序的 Windows 资源管理器？

> ID：370114
> 
> 赞同：21
> 
> 时间：2008-12-15T23:55:35.610
> 
> 标签：java, windows, contextmenu, windows-explorer

对于 Java 应用程序，如何将子菜单项添加到 Windows 资源管理器上下文菜单（例如 7-Zip）？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-16T00:02:12.227

我知道有两种方法可以做到这一点。奇特的方法是编写一个 Windows shell 扩展，我相信 powerarchiver、winzip 等就是这样做的（这涉及运行代码来确定上下文菜单项将取决于所选择的文件）。

对于简单的功能，简单的方法是您可以在注册表中添加一个条目：

```
HKEY_CLASSES_ROOT\<file type>\shell\<display text>\command 
```

此上下文菜单应应用于的文件在哪里`<file type>`，即 *、.mdb、.doc

和

`<display text>`您想在上下文菜单中显示的内容。

然后将默认字符串添加为要从上下文菜单启动的应用程序的路径，您可以使用 %1 来引用当前选定的文件，即我使用的 MS Access：

```
HKEY_CLASSES_ROOT\*\shell\MS Access 2000\command
"C:\Program Files\Microsoft Office\Office\MSACCESS.EXE" "%1" 
```

然后为我选择的任何文件添加一个上下文菜单项（因此是 *），这允许我在 MS Access 2000 中启动它。

当然，在破解它之前总是备份你的注册表。

您的程序可以在安装期间或首次运行时执行此操作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-07-10T03:25:40.750

您还可以将 java 程序打包在 NSIS 等安装程序中，您可以使用 NSIS 脚本生成资源管理器上下文菜单

# sql-server-2005 - 为什么 SQL Server 没有将我的索引加载到内存中？

> ID：370119
> 
> 赞同：1
> 
> 时间：2008-12-15T23:58:55.790
> 
> 标签：sql-server-2005, memory, indexing

我有一个包含 800 万条记录的表，其中包含许多字段，包括 lat/long 值，并且它在 Lat/Long 字段上有一个索引。

我正在查询以查找落在一个点周围的正方形内的记录（稍后细化为一个圆圈），这是一种：

选择 Lat,Long 从数据 WHERE (Lat BETWEEN 1 和 2) AND (Long BETWEEN 1 和 2)。

在我的开发机器中，它使用索引，并在大约 50 毫秒内返回（我第一次对特定点进行查询）。
在我的生产服务器中，它也使用了索引，但是第一次查询大约需要 2-4 秒才能返回，接下来的查询需要 10 毫秒。

在我的开发机器中，SQL Server 占用了 500Mb 的内存，在我的服务器中，大约是 130Mb。

对我来说，显而易见的结论是，在我的机器中，索引被加载到内存中，而在生产服务器中它不是......

我的假设正确吗？我能做些什么来修复它？

这是两台机器上 W2k3 上的 SQL Express 2005（免费版）。我能想到的一个区别是我的机器是 32 位的，而服务器是 64 位的，但我认为这不会影响内存中索引的加载。

此外，服务器内存不足。它有 2Gb 的物理内存和大约 500Mb 的提交费用，所以有足够的余地。

任何想法将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-16T00:10:14.237

当我遇到这种情况时，我通常会尝试两件事，按以下顺序：

1 - 更新该表的统计信息：

更新统计数据

2 - 重建索引：（在 SQL Server Management Studio 中右键单击索引并选择重建）

# flash - 是否有任何像 Flash 一样的预写组件，如 Silverlight Web 小部件？

> ID：370124
> 
> 赞同：2
> 
> 时间：2008-12-15T23:59:39.627
> 
> 标签：flash, silverlight, components

是否有任何像 Flash 一样的预写组件，如 Silverlight Web 小部件？

Flash 示例：
[XSPF 网络音乐播放器](http://musicplayer.sourceforge.net/)
[WordPress 音频播放器](http://wpaudioplayer.com/)
[FLAMPlayer](http://www.flamplayer.com/flamplayer_demo/pages/demo.html)
[Aflax](http://www.aflax.org/demos.htm)

澄清：我的意思不是在你的 IDE 中使用控件来编写自定义的东西。
请参阅[ALTNET Podcast](http://altnetpodcast.com/)
我认为他们使用 WordPress 音频播放器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-16T08:46:21.107

您还可以查看项目黑光

开源

[http://mightyeaty.members.winisp.net/blacklight.silverlight/](http://mightymeaty.members.winisp.net/blacklight.silverlight/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T00:07:26.193

有很多控件，[silverlight.net](http://silverlight.net)是一个很好的起点。Infragistics 和 Telerik 正在为 Silverlight 制作预建控件，其他第三方也加入进来。我注意到您的大多数示例都是音频和视频播放器 - 我认为没有任何单独的控件，音频和视频播放是直接烘焙的。谷歌“silverlight controls”，你应该有很多尝试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-16T00:09:50.323

肯定有。

我使用了组件一中的一些 [http://www.componentone.com/SuperProducts/StudioSilverlight/](http://www.componentone.com/SuperProducts/StudioSilverlight/)

Telerik 等其他公司也有一些不错的公司： [http ://www.telerik.com/products/silverlight.aspx](http://www.telerik.com/products/silverlight.aspx)

# php - 使用 Propel 1.2 进行外连接？

> ID：370152
> 
> 赞同：0
> 
> 时间：2008-12-16T00:11:49.650
> 
> 标签：php, symfony1, propel, outer-join

我正在尝试在 Symfony 中进行外部连接。如果 Criteria 支持 OUTER_JOIN，以下代码似乎可以工作：

```
$user = sfContext::getInstance()->getUser();
$petCriteria = new Criteria();
$petCriteria->add(PetInfoPeer::ACCOUNT_ID, $user->getProfile()->getAccountId());
$petCriteria->add(LostPetPeer::PET_INFO_ID, Criteria::ISNULL);
$petCriteria->addJoin(LostPetPeer::PET_INFO_ID, PetInfoPeer::PET_INFO_ID, Criteria::OUTER_JOIN); 
```

我错过了什么吗？Propel 1.3 支持吗？我到处搜索，只找到伪代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-16T18:18:06.383

我认为使用标准是不可能的。您必须自己编写和运行 SQL，然后构建模型。

[这是一个很好的例子](https://stackoverflow.com/questions/246400/symfony-app-how-to-add-calculated-fields-to-propel-objects#247259)，可以在这个网站上找到。

# c# - 压缩 Web 服务请求

> ID：370156
> 
> 赞同：3
> 
> 时间：2008-12-16T00:15:00.220
> 
> 标签：c#, web-services, gzip

我在 c#/dotnet 中有一个 Web 服务和客户端，我正在使用 EnableDecompression 来 gzip 压缩我从 Web 服务器获得的响应。是否也可以压缩请求？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-16T06:12:09.873

SOAP 扩展允许您在客户端和服务器上同时使用 SOAP 流。它们很好，因为您可以不理会您的服务代码 - 操作发生在 web 方法开始之前和结束之后。它们的工作方式很像 HttpModule，但也可以包含在客户端/请求端。

*   [http://msdn.microsoft.com/en-us/library/system.web.services.protocols.soapextension.aspx](http://msdn.microsoft.com/en-us/library/system.web.services.protocols.soapextension.aspx)
*   [http://msdn.microsoft.com/en-us/magazine/cc164007.aspx](http://msdn.microsoft.com/en-us/magazine/cc164007.aspx)
*   [使用 SOAP 扩展修改 SOAP 消息](http://msdn.microsoft.com/en-us/library/vstudio/esw638yk(v=vs.100).aspx)

除此之外，想到的唯一选择是将大型 SOAP 元素手动序列化和压缩为 byte[]，然后在服务器上手动解压缩和反序列化（颤抖......）。这种方法的维护问题可能令人望而却步。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-02T09:28:53.357

我发现[本教程](http://www.infosrama.com/soapcompression.htm)使用 SharpZipLib 库和 SOAP 扩展在 C# 中压缩 SOAP 消息：

似乎装饰了大约 30% 的压缩率，今天将尝试一下。

# python - 如何在 SQLAlchemy 中按算术表达式排序？

> ID：370160
> 
> 赞同：3
> 
> 时间：2008-12-16T00:16:41.213
> 
> 标签：python, sqlalchemy

我如何将这样的东西翻译成 SQLAlchemy？

```
SELECT (a * b) - (x + y) / z AS result
FROM table
ORDER BY result 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-16T07:17:42.440

只需将标签作为字符串参数传递给`order_by`：

```
result_exp = sqlalchemy.sql.expression.label('result',
   ((test2_table.c.a * test2_table.c.b)
    - (test2_table.c.x + test2_table.c.y)
    / test2_table.c.z))
select([result_exp], from_obj=[test2_table], order_by="result") 
```

# c# - Datareader 在 VS 中未返回任何结果存储过程在 Sql Server 中返回多个结果集

> ID：370165
> 
> 赞同：5
> 
> 时间：2008-12-16T00:19:42.177
> 
> 标签：c#, ado.net, datareader

我在从 Visual Studio 2008 中的数据读取器中检索结果时遇到问题。我在同一个数据库中存储了多个 Procs。我能够从那些不接收输入参数的值中检索值。但是，当我在带有输入参数的存储过程上使用 executreReader() 方法时，我得到一个空的数据读取器。在检查结果集合时，会出现消息“IEnumerable returned no results”。我很困惑，因为我可以在 sql server 中执行存储的过程并返回结果集。我以前能够从 Visual Studio 中的这些存储过程中检索行，但显然它只是有一天停止工作。

我尝试使用 dataadapter 用我的结果填充数据集，并使用 executereader() 方法获取 sqldatareader，但我仍然没有得到任何结果。也不会抛出异常。我的参数都已正确命名，但我应该能够在没有参数的情况下调用这些存储的过程，并让它返回一个未过滤的结果集。我当前使用的代码如下：

```
string connStr = ConfigurationManager.ConnectionStrings["MyConnectionString"]
                                     .ConnectionString;

SqlConnection connCactus = new SqlConnection(connStr);
SqlCommand cmdPopulateFilterDropDowns = new SqlCommand( "dbo.MyStoredProc",
                                                        connCactus);
SqlDataReader rdrFilterSearch = null;
cmdPopulateFilterDropDowns.CommandType = CommandType.StoredProcedure;

connCactus.Open();
rdrFilterSearch = cmdPopulateFilterDropDowns
                      .ExecuteReader(CommandBehavior.CloseConnection);

return (rdrFilterSearch); 
```

请帮忙！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-23T20:44:55.517

我犯了愚蠢的错误。经过几个小时的努力，我意识到我正在使用的存储过程返回多个结果集，其中第一个结果集总是空的。因此缺乏结果。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-16T01:27:17.313

您是否曾经将参数添加到 SqlCommand 的 Parameter 集合中？你提到那些不工作的是那些接受输入参数的，但在你的代码中你没有这样的东西：

```
cmdPopulateFilterDropDowns.Parameters.AddWithValue(...); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-04-28T15:36:31.397

我有一个类似但不完全相同的问题让我发疯，所以我会把它扔进去，以防它帮助别人。

我可以使用 Management Studio 在 SQL Server 上运行 SQL，或使用相同的 SQL 调用存储过程，然后返回填充的结果集。但是，当我从我的 ASP.Net Web 应用程序项目的 Visual Studio 代码中使用相同的 SQL 内联或调用包含它的存储过程时，我得到了一个空的 DataReader。

**相同的 SQL 如何在 Management Studio 中返回结果集，但在 Visual Studio 中返回一个空的 DataReader？答案是我在这两个工具中以具有不同权限的不同用户身份运行。**在 Management Studio 中，我作为具有大量权限的特定 SQL 角色的开发人员运行。但是在 Visual Studio 中，我作为一个服务帐户运行，该帐户没有被授予对我正在查询的表的权限。

实际上，我的问题要复杂得多。一切都很好，直到我更改了 SQL/sproc 并将表 JOIN 添加到另一个表中，并且该表缺少必要的服务帐户权限。但原理是一样的：检查进行数据库调用的用户的所有权限。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-16T01:32:31.450

针对您认为正在执行命令的服务器运行 SQL 服务器跟踪。实际发送到服务器的是什么？我想你会在那里找到确凿的线索。

BFree 有一个好点，检查 AddWtihValue() 与 Add()。还要确保如果您显式实例化 SqlParameter 对象，可能会出现与 .Add() 相同的问题。请注意，当您将 (int)0 的值传递给它时，Parameters.Add() 存在设计缺陷——它们被视为枚举而不是值......

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-16T01:34:54.317

这似乎很明显，但请告诉我您正在调用 .Read() 方法？我讨厌提出这样的问题，但有时当我们为某个问题发疯时，我们会忘记最明显的事情。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-12-07T12:11:38.733

在 sqlParam 上设置参数方向应该可以解决问题。

```
mySqlParam.Direction = ParameterDirection.ReturnValue; 
```

如果您希望返回多个值，只需添加参数并设置它的方向：

```
 SqlParameter mySqlParam = new SqlParameter();
    mySqlParam.ParameterName = "@ID";
    mySqlParam.SqlDbType = SqlDbType.int;
    mySqlParam.Direction = ParameterDirection.ReturnValue;

    SqlParameter mySqlParam = new SqlParameter();
    mySqlParam.ParameterName = "@Name";
    mySqlParam.SqlDbType = SqlDbType.NVarChar;
    mySqlParam.Direction = ParameterDirection.ReturnValue;

    SqlParameter mySqlParam = new SqlParameter();
    mySqlParam.ParameterName = "@Address";
    mySqlParam.SqlDbType = SqlDbType.NVarChar;
    mySqlParam.Direction = ParameterDirection.ReturnValue; 
```

`mySqlParam.ParameterName`不必与存储过程中的名称完全相同。

然后您可以读取这样的值（不完整的示例）：

```
int.Parse(dataReader["ID"]);
dataReader["name"].ToString();
dataReader["address"].ToString(); 
```

in 的值`dataReader[""].ToString();`必须与存储过程中的列名匹配。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-11-03T13:05:44.617

利用

```
reader.ExecuteNonQuery() 
```

快乐编码

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-16T00:29:27.990

什么时候出现“IEnumerable 没有返回结果”错误？您能否举例说明您如何访问 DataReader？

如果在返回之前设置断点并运行会发生什么

```
rdrFilterSearch.GetString(0); 
```

在即时窗口中？

# winapi - 是否有“此应用程序需要注意”的 Windows API 挂钩？

> ID：370166
> 
> 赞同：3
> 
> 时间：2008-12-16T00:19:48.290
> 
> 标签：winapi, windows-xp, notifications

在 Windows XP 中，当程序需要用户注意时，它的任务栏按钮会闪烁橙色。任何拥有 IM 程序的人都可能熟悉这种行为。但是当我玩全屏模式游戏时，我看不到这一点，并且消息没有得到回复。

现在我正在编写自己的游戏引擎，我想善待我的用户。是否有任何 Windows API 调用我可以编写一个挂钩，只要任何其他程序将其任务栏按钮设置为“橙色闪烁模式”，它就会通知我的程序？这样，我可以在它发生时通知用户。

如果这不可用，我会感到惊讶。早在 90 年代中期，我就看到了一个 Mac OS Classic 屏幕保护程序，它能够做到这一点。我就是从那里得到这个想法的。

编辑：这被标记为[how-can-i-programmatically-determine-if-an-application-is-flash-in-the-taskb 的副本](https://stackoverflow.com/questions/309189/how-can-i-programmatically-determine-if-an-application-is-flashing-in-the-taskb)，但我重新打开它是因为这个答案更好，并鼓励更多人讨论可能的解决方案，如果有的话。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-16T00:34:39.883

我不认为有这样的事情。您也许可以通过[API hooking](http://www.google.com/search?q=API+hooking)来实现它，尽管我不确定 Vista 是否允许您这样做。虽然适用于 XP。

然而，在这个方向上还有一些其他想法可能是“下一个最好的事情”：

*   不要独占声音设备，以免听到其他程序的声音。我不确定这是怎么做到的，但有些游戏会阻止其他声音，有些则不会；
*   允许用户使用 ALT-TAB 和其他组合键离开您的游戏；
*   如果另一个窗口试图激活，允许它并优雅地最小化；

其他一般提示包括：

*   尽量减少最小化/恢复时间。我对游戏编程一无所知，但对于某些游戏来说，这需要很长时间。
*   最小化/恢复时正确恢复图片。有些游戏有这个问题。
*   最小化时自动暂停。如果这是一个网络游戏并且无法暂停，也许可以向其他玩家发送消息，让他们知道。
*   有点不相关，但我喜欢游戏在某处显示时钟（真正的时钟，而不是一些游戏时间）。通过这种方式，我可以很容易地判断我是否应该在不最小化程序的情况下已经上床睡觉。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T00:30:04.510

看起来这个问题之前已经在 SO 上问过：[如何以编程方式确定应用程序是否在任务栏中闪烁](https://stackoverflow.com/questions/309189/how-can-i-programmatically-determine-if-an-application-is-flashing-in-the-taskb "如何以编程方式确定应用程序是否在任务栏中闪烁")

简短的回答：似乎不可能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T17:24:07.083

当然有可能。它甚至是 Win32 常见问题解答（多年来......）请参阅 Adv。api ng新闻：//comp.os.ms-windows.programmer.win32

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T23:18:44.553

这里有几个链接可以帮助您开始使用 Api hooking

www.internals.com/articles/apispy/apispy.htm www.wheaty.net/

Vista 通常对 API 挂钩没有任何问题，只是它不允许您挂钩受保护的进程。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-10-01T05:47:34.150

完全可以做到。我在 Windows 7 上做，所以我很确定在 Vista 上也可以做。

# python - 使用 ORM 的带有 count、group_by 和 order_by 的 SQLAlchemy

> ID：370174
> 
> 赞同：4
> 
> 时间：2008-12-16T00:27:41.677
> 
> 标签：python, sqlalchemy

我有几个函数需要使用 count()、group_by 和 order_by 进行一对多连接。我正在使用 sqlalchemy.select 函数来生成一个查询，该查询将返回一组 id，然后我对其进行迭代以对各个记录进行 ORM 选择。我想知道是否有一种方法可以在单个查询中使用 ORM 来做我需要的事情，这样我就可以避免进行迭代。

这是我现在正在做的一个例子。在这种情况下，实体是位置和指南，一对多映射。我正在尝试获取按与其相关的指南数量排序的顶级位置列表。

```
def popular_world_cities(self):
    query = select([locations.c.id, func.count(Guide.location_id).label('count')],
                   from_obj=[locations, guides],
                   whereclause="guides.location_id = locations.id AND (locations.type = 'city' OR locations.type = 'custom')",
                   group_by=[Location.id],
                   order_by='count desc',
                   limit=10)
    return map(lambda x: meta.Session.query(Location).filter_by(id=x[0]).first(), meta.engine.execute(query).fetchall()) 
```

**解决方案**

我找到了最好的方法来做到这一点。只需提供 a`from_statement`而不是 a`filter_by`或一些这样的。像这样：

```
meta.Session.query(Location).from_statement(query).all() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T22:17:06.157

我发现这很难，但 SQLAlchemy 确实支持`group_by`. Query 下的文档没有这么说，但它确实支持它 - 我已经使用它了！

而且，您还可以使用`order_by`. 我打算像你一样创建一个特殊的类/查询，但后来我发现有一个`group_by()`函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T07:30:29.483

您正在尝试做的事情直接映射到子查询[由您当前的选择调用]和表之间的 SQLAlchemy 连接。您需要将排序移出子选择并使用 count(desc); 创建一个单独的标记列。按该列排序外部选择。

除此之外，我没有看到太多不明显的地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T12:03:15.540

我找到了最好的方法来做到这一点。只需提供 a`from_statement`而不是 a`filter_by`或一些这样的。像这样：

```
meta.Session.query(Location).from_statement(query).all() 
```

# c# - 远程调试 - 远程调试器不支持此版本的 Windows 错误

> ID：370176
> 
> 赞同：3
> 
> 时间：2008-12-16T00:28:20.443
> 
> 标签：c#, .net, debugging, remote-debugging

我有一个遇到问题的 XP 客户端。我的开发盒是 Vista Home 64。我在客户端机器上启动调试器，当我尝试在开发盒上运行时，它显示“无法调试。远程调试器不支持此版本的 windows'。

看来我是索尔。还有另一种方法可以找出如何调试它吗？应用程序抛出一个带有 system.security 错误的 .net 运行时错误 eventid 5000。不知道为什么 try catch 没有得到它。有什么方法可以找出发生了什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-16T00:37:38.300

您可能会遇到 64 位调试器无法处理 32 位调试器客户端的问题。

前段时间有一个问题是关于将 32 位调试器连接到 64 位目标的问题（我认为这与您的情况相反）：

*   [x64 上的 x86 远程调试器服务](https://stackoverflow.com/questions/76939/x86-remote-debugger-service-on-x64)

尽管那里没有解决方案，但它可能会给您一些想法 - 也许就像确保您在 x64 机器上运行 32 位版本的调试器一样简单（如果可以简单地完成）..

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-23T14:18:20.727

事实证明.net 框架在客户端上被冲洗掉了。我无法获得堆栈跟踪或什么也没有。删除并重新安装了 .net 框架，一切正常！

感谢所有的帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T00:47:33.180

您是否在远程计算机上运行远程调试监视器 (msvcmon.exe)？

监视器的版本是否与您在本地计算机上使用的 Visual Studio 版本匹配？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-16T01:24:06.617

是的，msvcmon 来自同一个磁盘并且它正在运行。我正在运行 32 位版本的 vs2k8（有 64 位版本吗？）

我必须运行调试器吗？我认为 vs2k8 是调试器，运行应用程序的客户端会发回它的状态？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-16T14:53:12.023

如果您打算以 32 位 XP 为目标，那么我建议您至少构建一个 XP 虚拟机，以便您可以在操作系统上测试您的应用程序。

您应该能够从 XP 中打开解决方案并在那里逐步完成。

您是否有任何有关您的 system.security 错误的 stace-trace 或更多信息？也许通过编译调试版本而不是发布版本，您会更了解导致它的原因。（对不起，如果那是在教你如何吸鸡蛋。）

# .net - 多个客户端使用 Logging Application Block 写入单个文件

> ID：370182
> 
> 赞同：2
> 
> 时间：2008-12-16T00:33:26.657
> 
> 标签：.net, logging, codeblocks

我有以下场景： 1\. .NET UI 端使用 Logging App Block 写入平面文件 2\. 非托管 Windows 服务使用专有记录器写入与 1 相同的文件。

问题：有没有办法让 FlatFile TraceListener 在记录条目后关闭它的文件句柄，以便 Windows 服务也可以写入文件？

谢谢！

更新：我包括 Microsoft.Practices.EnterpriseLibrary.Logging.Logger.Writer.Dispose(); 这会关闭流，所以这可以解决问题——只是好奇是否有另一种方法可以做到这一点。

**更新 2：最后的笔记**

P&P 建议从多个应用程序写入单个 MSMQ。这样您就不需要调用 Dispose() 等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-21T23:02:34.163

I've had to deal with this using log4net. I wasn't able to make use of the logging framework's file logging support at all, and had to roll my own log appender that catches sharing violations. At that point, your choices are either to buffer events in memory and write them out later or to block until you can get access to the file.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T22:49:16.063

我认为您的选择是处理它的最佳方式 - 只需在完成后处置作者，这应该最终确定并释放作者仍然拥有的所有资源。

另外，我担心两个处理都试图同时写入并导致异常，但也许 App Block 有一些内置的解决方法代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-10T14:34:03.190

你从哪里得到 .Dispose ？我输入 EnterpriseLibrary.Logging.Logger.Writer 但 .Writer 没有方法或属性，没有 .Dispose。

谢谢，

TCW

找到了 ：

> > 导入 Microsoft.Practices.EntLib.Common 可以解决问题。

# html - CSS静态边距 - 内容下方？

> ID：370183
> 
> 赞同：0
> 
> 时间：2008-12-16T00:33:42.413
> 
> 标签：html, css

我试图在我的页面底部，主要内容区域下方实现 50px 空间，这样无论用户的文本大小是什么，或者页面内碰巧有多少内容 - 总是有一个 50px内容区域之后的空间，这将使容器 div（透明）或 body 显示。

这听起来很简单，我一直在为我的容器 div 和 body 标签等设置边距和填充，但我从来没有运气。尺寸或内容的增加超越了我设法创造的任何空间。

是否有产生这种效果的通用、干净的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-16T01:01:54.850

如果没有看到标记很难判断，但可能是您的容器 div 没有清除其子元素，这可能解释了为什么底部的边距或填充不起作用......

如果您在容器内浮动了 div，那么这可能是问题所在。

有许多清除浮动的技术 - 搜索所有的 css 浮动清除 - 快速测试是使用 float:none;clear:both; 放入一个 div。低于其他孩子，看看是否有区别。
我经常发现在处理这些东西时在容器上设置背景颜色很有用，然后在正确时将其删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T00:42:35.733

您可以像这样创建一个 div：

```
height: 50px;
width: 100%;
position: fixed;
bottom: 0; 
```

这只会创建一个高度为 50px 的白框，它永远不会移动，并且卡在浏览器的底部。这是你想要达到的目标吗？

如果内容仍在此 div 中运行，请尝试更改它的 z-index 以使其位于其他元素之上。

# objective-c - 如何找到文件名的正确大小写？

> ID：370186
> 
> 赞同：7
> 
> 时间：2008-12-16T00:35:28.447
> 
> 标签：objective-c, cocoa, macos

这是在 Mac 上：

如果我有两个文件名 /foo/foo 和 /foo/FOO 它们可能指的是同一个文件，或者可能是不同的文件，具体取决于文件系统。我如何确定它们是否都指向同一个文件？如果是，我如何获得文件名的正确表示？

我的问题是由链接引起的。链接可能指向 /foo/FOO，但实际目录名为 /foo/foo。

是否有任何函数可以跟随链接并给我链接文件的完整路径？[NSFileManager pathContentOfSymbolicLinkAtPath] 给出了可能不正确的相对路径。

最终我要做的是缓存文件的信息。但是如果我对同一个文件有两个不同的路径，我的缓存可能会不同步。

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-16T08:02:56.220

您的问题确实有几个不同的部分。通过我的阅读，你想要：

> **1**一种判断两个不同路径是否是同一个磁盘文件的方法
> 
> **2**磁盘上文件的规范名称，带有正确的大小写

There's a third issue that gets mixed in, as well, having to do with [Display Names](http://developer.apple.com/documentation/MacOSX/Conceptual/BPFileSystem/Articles/DisplayNames.html#//apple_ref/doc/uid/20002298), because in OS X a file can localize its name and appear differently for different locales. So let's add

> **3** a way to get the display name, because we might want to cache things depending on how the user sees the file system, not how the file system appears in the terminal.

We can solve **1** with the FSRef trick pointed out by @boaz-stuller. Or here's some code that does it using higher-level Cocoa calls, which saves us a little bit of memory juggling (since we can let the `NSAutoreleasePool` do it for us):

```
long getInode(NSString* path) {
    NSFileManager* fm = [NSFileManager defaultManager];
    NSError* error;
    NSDictionary* info = [fm attributesOfItemAtPath:path error:&error];
    NSNumber* inode = [info objectForKey:NSFileSystemFileNumber];
    return [inode longValue];
} 
```

But to solve **2**, we've got to use FSRefs to find out the canonical casing of the file:

```
NSString* getActualPath(NSString* path) {
    FSRef ref;
    OSStatus sts;
    UInt8* actualPath;

    //first get an FSRef for the path
    sts = FSPathMakeRef((const UInt8 *)[path UTF8String], &ref, NULL);
    if (sts) return [NSString stringWithFormat:@"Error #%d making ref.", sts];

    //then get a path from the FSRef
    actualPath = malloc(sizeof(UInt8)*MAX_PATH_LENGTH);
    sts = FSRefMakePath(&ref, actualPath, MAX_PATH_LENGTH);
    if (sts) return [NSString stringWithFormat:@"Error #%d making path.", sts];

    return [NSString stringWithUTF8String:(const char*)actualPath];
} 
```

That's not bad at all, but we're still happy when we can solve **3** with Cocoa methods:

```
NSString* getDisplayPath(NSString* path) {
    NSFileManager* fm = [NSFileManager defaultManager];
    NSString* mine = [fm displayNameAtPath:path];
    NSString* parentPath = [path stringByDeletingLastPathComponent];
    NSString* parents = [@"/" isEqualToString:parentPath]
        ? @""
        : getDisplayPath(parentPath);
    return [NSString stringWithFormat:@"%@/%@", parents, mine];
} 
```

Finally, we can add a bit of driver code and tie this all together into a CoreFoundation command line tool (I had to add the AppKit framework to get this to compile).

```
NSString* fileInfoString(NSString* path) {
    long inode = getInode(path);
    return [NSString stringWithFormat:
        @"\t%@  [inode #%d]\n\t\tis actually %@\n\t\tand displays as %@",
        path,
        inode,
        getActualPath(path),
        getDisplayPath(path)];
}

int main (int argc, const char * argv[]) {
    NSAutoreleasePool * pool = [[NSAutoreleasePool alloc] init];

    if (argc < 2) {
        NSLog(@"Usage: %s <path1> [<path2>]", argv[0]);
        return -1;
    }

    NSString* path1 = [NSString stringWithCString:argv[1]];
    NSString* path2 = argc > 2
        ? [NSString stringWithCString:argv[1]]
        : [path1 uppercaseString];

    long inode1 = getInode(path1);
    long inode2 = getInode(path2);

    NSString* prefix = [NSString stringWithFormat:
        @"Comparing Files:\n%@\n%@", 
        fileInfoString(path1), 
        fileInfoString(path2)];

    int retval = 0;
    if (inode1 == inode2) {
        NSLog(@"%@\nSame file.", prefix);
    } else {
        NSLog(@"%@\nDifferent files.", prefix);
        retval = 1;
    }

    [pool drain];
    return retval;
} 
```

Now, we can put it all together and run it:

```
 $ checkpath /users/tal
 2008-12-15 23:59:10.605 checkpath[22375:10b] Comparing Files:
    /users/tal  [inode #1061692]
        is actually /Users/tal
        and displays as /Users/tal
    /USERS/TAL  [inode #1061692]
        is actually /Users/tal
        and displays as /Users/tal
 Same file.

```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-16T02:02:30.300

在两个路径上使用`FSPathMakeRef()`，然后使用`FSCompareFSRefs()`来查看它们是否是同一个文件/文件夹。然后，您可以使用`FSRefMakePath()`来获取规范表示，但如果您向用户显示文件名，则应该使用`NSFileManager's`-`displayNameAtPath:`方法，因为它可以正确处理本地化和显示/隐藏扩展名。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-16T00:41:55.580

如果 os x 是 unix 衍生产品，您是否可以访问 inode #？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-09-01T21:32:53.250

If anyone is trying to do this on iOS, FSRef isn't available. The only way I could figure out how to get the "actual" filename with correct case was to list the contents of the parent directory, then match.

iOS is a case-sensitive filesystem, whereas OS X (and the simulator) is not. I wrote this code to detect when a given path existed but had the wrong case in the sim.

If anyone has any better ways to do this (aside from this ugly loop) I'm all ears.

```
void checkForCapsIssues(NSString* compiledPath)
{

NSArray* validFilePaths = [[NSFileManager defaultManager] contentsOfDirectoryAtPath:[[compiledPath stringByDeletingLastPathComponent] stringByResolvingSymlinksInPath] error:nil];
NSString* lastPathComponent = [compiledPath lastPathComponent];
for (NSString* fileName in validFilePaths) {
    if([fileName isEqualToString:lastPathComponent])
    {
        return;
    }
    if([[fileName lowercaseString] isEqualToString:[lastPathComponent lowercaseString]])
    {
        NSLog(@"Warning! Caps Problem Found! %@", compiledPath);
        return;
    }
}

} 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-12-16T00:40:20.590

AFAIK，默认情况下，Mac OS X 中的文件系统不区分大小写，因此链接或文件名的大小写无关紧要。

# eclipse - Eclipse 键盘快捷键在 OSX 10.5.6 中损坏

> ID：370189
> 
> 赞同：12
> 
> 时间：2008-12-16T00:39:08.830
> 
> 标签：eclipse, macos, osx-leopard, dvorak

所以我已经使用 Leopard 一年了，最新的更新打破了 Eclipse 的键盘映射。我使用 dvorak 布局，现在在 eclipse 中，如果我按 ⌘ 和 b 键，它会构建，而不是 cut(b = x)。

有没有其他人有这个问题，有没有解决方法？

**编辑：**当前最好的解决方法是升级到 10.5.7。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T22:23:41.973

呜呼！它从 10.5.7 开始修复！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T17:45:21.590

我正在经历同样的事情，使用 Eclipse 3.3.2。我的解决方法是进入 Eclipse->Preferences->General->Keys 并手动重新映射我最常用的键盘命令的分配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T01:40:17.770

Eclipse 3.4.1，标准（美国）qwerty 布局。我没有发现任何快捷方式问题，我暂时将 B 设置为 cut （通过摆弄 eclipse 首选项中的键分配），并且效果很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-23T01:48:43.453

我遇到了同样的问题，除了不是所有的键绑定都被破坏了。例如，Command + S 仍然可以保存。但是大多数命令的评估就像我使用的是 QWERTY 一样。到目前为止，我还没有找到任何解决方案，除了手动重新映射我没有做过的键，因为它是一个巨大的痛苦。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-29T11:14:14.277

我有同样的问题。一个支持症状：当我尝试通过使用 Preferences->General->Keys 将“Undo”从 F9 重新映射到 Command-Z 来“修复”它时，当我键入 Command-Z 时，它回显为 Command-/。/ 是与 Dvorak Z 位于相同键盘位置的非 Dvorak 键。因此 Eclipse 在操作系统应用 Dvorak 映射“之前”以某种方式获取键。

我同意它使 Eclipse 无法使用。帮助！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-16T04:31:53.057

我相信这是一个 Eclipse 唯一的问题，因为当我使用我的 Dvorak 布局和其他 Java 工具（如 JDeveloper 或 SQLDeveloper）时，同样的问题不会影响我。

它让我发疯，我发现自己实际上是在虚拟机中启动 windows 或 linux，这样我就可以使用带有半连贯键映射的 Eclipse。

不过，奇怪的是，这个问题对我来说一开始并不存在。以前在 Dvorak 中可以正常工作的键映射。然后有一天，噗。

我想知道这是否与我机器上的非 Dvorak 用户将键映射更改回 qwerty 的事实有关。

我应该提一下，虽然我不知道它是否相关，但我使用的是 CFEclipse 插件。我还没有尝试用其他视角来调用这种行为。

也许为了好玩，我会尝试创建另一个本地帐户，看看是否可以使用 eclipse 开始。

另一种可能性可能是虚拟机本身，以及它处理底层键盘拦截的方式。

还有其他想法吗？

艾伦

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-29T15:48:02.560

在 10.5.7 更新中修复。

# c++ - 编译器何时以及为什么会在 malloc/free/new/delete 上将内存初始化为 0xCD、0xDD 等？

> ID：370195
> 
> 赞同：144
> 
> 时间：2008-12-16T00:41:59.277
> 
> 标签：c++, c, memory, memory-management

我知道编译器有时会使用某些模式初始化内存，例如`0xCD`和`0xDD`。我想知道的是**何时**以及**为什么**会发生这种情况。

## 什么时候

这是特定于使用的编译器吗？

在这方面做`malloc/new`和`free/delete`工作的方式相同吗？

它是特定于平台的吗？

它会发生在其他操作系统上，例如`Linux`或`VxWorks`吗？

## 为什么

我的理解是这只发生在`Win32`调试配置中，它用于检测内存溢出并帮助编译器捕获异常。

你能给出任何实际例子来说明这个初始化是如何有用的吗？

我记得读过一些东西（可能在 Code Complete 2 中）说在分配内存时最好将内存初始化为已知模式，并且某些模式会触发中断，`Win32`从而导致调试器中显示异常。

这有多便携？

* * *

## 回答 #1

> 赞同：211
> 
> 时间：2008-12-16T03:12:40.907

微软编译器在为调试模式编译时用于各种无主/未初始化内存的快速总结（支持可能因编译器版本而异）：

```
Value     Name           Description 
------   --------        -------------------------
0xCD     Clean Memory    Allocated memory via malloc or new but never 
                         written by the application. 

0xDD     Dead Memory     Memory that has been released with delete or free. 
                         It is used to detect writing through dangling pointers. 

0xED or  Aligned Fence   'No man's land' for aligned allocations. Using a 
0xBD                     different value here than 0xFD allows the runtime
                         to detect not only writing outside the allocation,
                         but to also identify mixing alignment-specific
                         allocation/deallocation routines with the regular
                         ones.

0xFD     Fence Memory    Also known as "no mans land." This is used to wrap 
                         the allocated memory (surrounding it with a fence) 
                         and is used to detect indexing arrays out of 
                         bounds or other accesses (especially writes) past
                         the end (or start) of an allocated block.

0xFD or  Buffer slack    Used to fill slack space in some memory buffers 
0xFE                     (unused parts of `std::string` or the user buffer 
                         passed to `fread()`). 0xFD is used in VS 2005 (maybe 
                         some prior versions, too), 0xFE is used in VS 2008 
                         and later.

0xCC                     When the code is compiled with the /GZ option,
                         uninitialized variables are automatically assigned 
                         to this value (at byte level). 

// the following magic values are done by the OS, not the C runtime:

0xAB  (Allocated Block?) Memory allocated by LocalAlloc(). 

0xBAADF00D Bad Food      Memory allocated by LocalAlloc() with LMEM_FIXED,but 
                         not yet written to. 

0xFEEEFEEE               OS fill heap memory, which was marked for usage, 
                         but wasn't allocated by HeapAlloc() or LocalAlloc(). 
                         Or that memory just has been freed by HeapFree(). 
```

免责声明：表格来自我周围的一些笔记——它们可能不是 100% 正确（或连贯）。

其中许多值在 vc/crt/src/dbgheap.c 中定义：

```
/*
 * The following values are non-zero, constant, odd, large, and atypical
 *      Non-zero values help find bugs assuming zero filled data.
 *      Constant values are good, so that memory filling is deterministic
 *          (to help make bugs reproducible).  Of course, it is bad if
 *          the constant filling of weird values masks a bug.
 *      Mathematically odd numbers are good for finding bugs assuming a cleared
 *          lower bit.
 *      Large numbers (byte values at least) are less typical and are good
 *          at finding bad addresses.
 *      Atypical values (i.e. not too often) are good since they typically
 *          cause early detection in code.
 *      For the case of no man's land and free blocks, if you store to any
 *          of these locations, the memory integrity checker will detect it.
 *
 *      _bAlignLandFill has been changed from 0xBD to 0xED, to ensure that
 *      4 bytes of that (0xEDEDEDED) would give an inaccessible address under 3gb.
 */

static unsigned char _bNoMansLandFill = 0xFD;   /* fill no-man's land with this */
static unsigned char _bAlignLandFill  = 0xED;   /* fill no-man's land for aligned routines */
static unsigned char _bDeadLandFill   = 0xDD;   /* fill free objects with this */
static unsigned char _bCleanLandFill  = 0xCD;   /* fill new objects with this */ 
```

还有几次调试运行时会用已知值填充缓冲区（或缓冲区的一部分），例如，`std::string`分配中的“松弛”空间或传递给的缓冲区`fread()`。这些情况使用给定名称的值`_SECURECRT_FILL_BUFFER_PATTERN`（在 中定义`crtdefs.h`）。我不确定它是何时引入的，但它至少在 VS 2005 (VC++8) 的调试运行时中。

最初，用于填充这些缓冲区`0xFD`的值与用于无人区的值相同。但是，在 VS 2008 (VC++9) 中，该值更改为`0xFE`. 我认为这是因为在某些情况下，填充操作会超出缓冲区的末尾，例如，如果调用者传入的缓冲区大小太大而无法`fread()`. 在这种情况下，该值`0xFD`可能不会触发检测此溢出，因为如果缓冲区大小仅大 1，则填充值将与用于初始化该金丝雀的无人土地值相同。无人区没有变化意味着超支不会被注意到。

所以在 VS 2008 中更改了填充值，这样这种情况就会改变无人区金丝雀，导致运行时检测到问题。

正如其他人所指出的，这些值的关键属性之一是，如果取消引用具有这些值之一的指针变量，则会导致访问冲突，因为在标准 32 位 Windows 配置中，用户模式地址不会高于 0x7fffffff。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2008-12-16T01:45:59.740

关于填充值 0xCCCCCCCC 的一个很好的属性是，在 x86 汇编中，操作码 0xCC 是[int3](http://pdos.csail.mit.edu/6.828/2008/readings/i386/INT.htm)操作码，即软件断点中断。因此，如果您尝试在已填充该填充值的未初始​​化内存中执行代码，您将立即遇到断点，操作系统将允许您附加调试器（或终止进程）。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-12-16T00:56:27.467

它是特定于编译器和操作系统的，Visual Studio 将不同类型的内存设置为不同的值，以便在调试器中您可以轻松查看是否已进入`malloc`内存、固定数组或未初始化的对象。

[https://docs.microsoft.com/en-gb/visualstudio/debugger/crt-debug-heap-details?view=vs-2022](https://docs.microsoft.com/en-gb/visualstudio/debugger/crt-debug-heap-details?view=vs-2022)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-16T01:06:34.873

这不是操作系统 - 它是编译器。您也可以修改行为 - 请参阅本文底部。

Microsoft Visual Studio 生成（在调试模式下）一个用 0xCC 预填充堆栈内存的二进制文件。它还在每个堆栈帧之间插入一个空格，以检测缓冲区溢出。这里有一个非常简单的例子，说明这很有用（实际上 Visual Studio 会发现这个问题并发出警告）：

```
...
   bool error; // uninitialised value
   if(something)
   {
      error = true;
   }
   return error; 
```

如果 Visual Studio 未将变量预初始化为已知值，则可能很难找到此错误。使用预初始化变量（或者更确切地说，预初始化堆栈内存），每次运行都可以重现问题。

但是，有一个小问题。Visual Studio 使用的值是 TRUE - 除了 0 之外的任何值都是。实际上，当您在发布模式下运行代码时，很可能会将未初始化的变量分配给恰好包含 0 的堆栈内存，这意味着您可能会遇到仅在发布模式下才会出现的未初始化变量错误。

这让我很恼火，所以我[编写了一个脚本](https://airsource.co.uk/blog/2007/07/02/configuring-the-visual-c-60-stack-fill/)，通过直接编辑二进制文件来修改预填充值，这样我就可以找到只有在堆栈包含零时才会出现的未初始化变量问题。此脚本仅修改堆栈预填充；我从未尝试过堆预填充，尽管它应该是可能的。可能涉及编辑运行时 DLL，也可能不涉及。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-11-19T16:25:11.377

> 这是特定于使用的编译器吗？

实际上，它几乎总是运行时库（如 C 运行时库）的一个特性。运行时通常与编译器密切相关，但您可以交换一些组合。

我相信在 Windows 上，调试堆（HeapAlloc 等）也使用特殊的填充模式，这些模式不同于来自调试 C 运行时库中的 malloc 和 free 实现的填充模式。所以它也可能是一个操作系统特性，但大多数时候，它只是语言运行时库。

> malloc/new 和 free/delete 在这方面的工作方式是否相同？

new 和 delete 的内存管理部分通常使用 malloc 和 free 实现，因此 new 和 delete 分配的内存*通常*具有相同的功能。

> 它是特定于平台的吗？

详细信息是特定于运行时的。使用的实际值通常被选择为不仅在查看十六进制转储时看起来不寻常且明显，而且设计为具有可能利用处理器功能的某些属性。例如，经常使用奇数值，因为它们可能导致对齐错误。使用较大的值（而不是 0），因为如果您循环到未初始化的计数器，它们会导致令人惊讶的延迟。在 x86 上，0xCC 是一条`int 3`指令，因此如果您执行未初始化的内存，它会陷入陷阱。

> 会不会出现在其他操作系统上，例如 Linux 或 VxWorks？

它主要取决于您使用的运行时库。

> 你能给出任何实际例子来说明这个初始化是如何有用的吗？

我在上面列出了一些。通常选择这些值是为了增加在使用无效内存部分执行某些操作时发生异常情况的可能性：长时间延迟、陷阱、对齐错误等。堆管理器有时还使用特殊填充值来处理分配之间的间隙。如果这些模式发生变化，它就会知道某处存在错误写入（如缓冲区溢出）。

> 我记得读过一些东西（可能在 Code Complete 2 中），在分配内存时最好将内存初始化为已知模式，并且某些模式将触发 Win32 中的中断，这将导致调试器中显示异常。
> 
> 这有多便携？

*编写 Solid Code*（可能还有*Code Complete*）讨论了在选择填充模式时要考虑的事项。我在这里提到了其中的一些，维基百科上关于[Magic Number (programming)](https://en.wikipedia.org/wiki/Magic_number_(programming))的文章也对它们进行了总结。一些技巧取决于您正在使用的处理器的具体情况（例如它是否需要对齐的读取和写入以及哪些值映射到将捕获的指令）。其他技巧，例如使用在内存转储中突出的大值和不寻常的值，更便于移植。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-16T01:05:58.230

“为什么”的明显原因是假设您有这样的课程：

```
class Foo
{
public:
    void SomeFunction()
    {
        cout << _obj->value << endl;
    }

private:
    SomeObject *_obj;
} 
```

然后你实例化一个 a`Foo`并调用`SomeFunction`，它会给出一个试图读取的访问冲突`0xCDCDCDCD`。这意味着您忘记初始化某些内容。这就是“为什么”。如果不是，那么指针可能与其他一些内存对齐，并且调试起来会更加困难。它只是让您知道您遇到访问冲突的原因。请注意，这种情况非常简单，但是在更大的类中很容易犯这个错误。

AFAIK，这仅适用于调试模式下的 Visual Studio 编译器（而不是发布）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-16T01:38:54.370

很容易看到内存已经从它的初始起始值改变，通常在调试期间，但有时也用于发布代码，因为您可以在进程运行时将调试器附加到进程。

这也不仅仅是内存，许多调试器会在进程启动时将寄存器内容设置为一个标记值（某些 AIX 版本会设置一些寄存器，`0xdeadbeef`这有点幽默）。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-05-13T09:20:13.127

本文介绍了[不寻常的内存位模式](http://www.softwareverify.com/development-tips/memory-bit-patterns.html)以及遇到这些值时可以使用的各种技术。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-19T19:52:49.273

IBM XLC 编译器有一个“initauto”选项，它将为自动变量分配一个您指定的值。我在调试版本中使用了以下内容：

`-Wc,'initauto(deadbeef,word)'`

如果我查看未初始化变量的存储，它将被设置为 0xdeadbeef

# asp.net - 为什么将 <%= %> 表达式作为服务器控件上的属性值会导致编译错误？

> ID：370201
> 
> 赞同：54
> 
> 时间：2008-12-16T00:46:42.060
> 
> 标签：asp.net, controls

这个问题是我在尝试回答[另一个问题](https://stackoverflow.com/questions/369736/assigning-visible-property-of-the-button-to-a-static-method-result)时注意到的结果。现在我很想知道为什么`<asp:TextBox runat="server" Visible="<%= true %>" />`会导致编译错误，而不是像我预期的那样导致可见的 TextBox。

从我目前的发现来看，`<%= %>`表达式并没有像我一直想的那样被翻译成文字控制。但相反，它在呈现页面时被评估并直接写入 HtmlTextWriter。`<%= %>`但显然，当将表达式用作服务器控件的属性值时，解析器（我不确定这是将 ASP.NET 标记转换为 .NET 代码的部分的正确术语）甚至不会尝试评估表达式。它只是将其用作字符串。我猜这就是为什么我收到错误消息：*Cannot create an object of type of 'System.Boolean' from its string representation '<%= true %>' for the 'Visible' property*。

如果我改为放弃 runat="server" 并将其`<%= %>`与常规 html 标记相结合，如下所示：

```
<input type="button" id="Button1" visible='<%= true %>' /> 
```

然后解析器只是将块在表达式之前和之后分成几部分，然后在渲染方法中将其写入 HtmlTextWriter。像这样的东西：

```
 __w.Write("<input type=\"button\" id=\"Button1\" visible='");
    __w.Write(true);
    __w.Write("' />"); 
```

作为我注意到的最后一件事......当我尝试使用`<%# %>`+ Control.DataBind() 时，我得到了我所期望的。当控件是数据绑定时，它连接要使用的表达式，但与 <%= %> 表达式不同，生成的代码实际上计算`<%# %>`表达式的内容。解析器最终生成以下内容：

```
[DebuggerNonUserCode]
private Button __BuildControldataboundButton()
{
    Button button = new Button();
    base.databoundButton = button;
    button.ApplyStyleSheetSkin(this);
    button.ID = "databoundButton";
    button.DataBinding += new EventHandler(this.__DataBindingdataboundButton);
    return button;
}

public void __DataBindingdataboundButton(object sender, EventArgs e)
{
    Button button = (Button) sender;
    Page bindingContainer = (Page) button.BindingContainer;
    button.Visible = true;
} 
```

从：

```
<asp:Button ID="databoundButton" Visible='<%# true %>' runat="server" /> 
```

注意`button.Visible = true;`那是`<%# %>`表达式的结果。

所以我的问题是.. 为什么第一个示例中的表达式只是被视为一个字符串，而不是被评估为“真”。其他两个示例的表达式有些相似，它们产生了我所期望的代码。

这只是一个错误（我怀疑这不是当前版本的 ASP.NET 的新问题），还是有充分的理由不允许我们这样使用`<%= %>`？

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2008-12-16T01:33:16.147

这：

```
<asp:Button runat="server" id="Button1" visible='<%= true %>' /> 
```

不评估这个：

```
<asp:Button runat="server" id="Button1" visible='true' /> 
```

<%= %> 直接输出到响应流，asp 标记不是响应流的一部分。假设 <%= %> 运算符对 asp 标记执行任何类型的预处理是错误的。

* * *

顺便说一句，考虑 <%# %> 和 <%= %> 运算符的 ASP.NET 生命周期是有帮助的。

*   <%# %> 的语义与为对象赋值更相似。在 ASP.NET 生命周期中，在页面将第一个字节写入响应缓冲区之前评估 <%# %> 运算符。

*   <%= %> 与 Response.Write 的含义相同。我们需要首先执行所有数据绑定和表单处理，并在 ASP.NET 生命周期的最后将 HTML 输出到响应缓冲区。

# templates - Groovy/Grails SimpleTemplateEngine 冻结

> ID：370202
> 
> 赞同：1
> 
> 时间：2008-12-16T00:47:05.240
> 
> 标签：templates, grails, groovy

我正在使用 Grails 发送大量 HTML 电子邮件。我使用 SimpleTemplateEngine 以这种方式创建我的电子邮件正文：

```
def ccIdToEmailMap = [:]
def emailTemplateFile = Utilities.retrieveFile("email${File.separator}emailTemplate.gtpl")
def engine = new SimpleTemplateEngine()
def clientContacts = ClientContact.list()
for(ClientContact cc in clientContactList) {
   def binding = [clientContact : cc]

   //STOPS (FREEZES) EITHER HERE OR....
   def template = template = engine.createTemplate(emailTemplateFile).make(binding)

   //OR STOPS (FREEZES) HERE
   def body = template.toString()

   def email = [text: body, to: cc.emailAddress]
   ccIdToEmailMap.put(cc.id, email)
   println "added to map"
}
return ccIdToEmailMap 
```

这是我尝试为每个电子邮件正文呈现的模板：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<title>Happy Holidays from google Partners</title>
</head>

<body>
    <table width="492" cellpadding="0" cellspacing="0" style="border:2px solid #acacac;margin:8px auto;" align="center">
        <tr>
            <td colspan="5" bgcolor="#c1e0f3"><img src="http://www.google.com/holiday2008/cardbg.gif" width="492" height="10" border="0"></td>
        </tr>

        <tr>
            <td width="6" bgcolor="#c1e0f3"><img src="http://www.google.com/holiday2008/sidebgl.gif" width="6" height="453" border="0"></td>
            <td style="background:#fff;border:1px solid #acacac;padding:2px;" width="228">
                <div style="width:208px;margin:4px 8px 0px 8px; color:#515151;">
                <font face="Times New Roman" size="2">
                <span style="font:14px 'Times New Roman',times,serif;">Static text that is the same for each email
                <br>&nbsp;<br>
                More text
                <br>&nbsp;<br>
                We wish you health and happiness during the holidays and a year of growth in 2009.
                </span>
                </font>
                </div>
            </td>
            <td style="background:#c9f4fe;border-top:1px solid #acacac;border-bottom:1px solid #acacac;" width="5"><img src="http://www.google.com/holiday2008/vertbg.gif" border="0" height="453" width="5"></td>
            <td width="247" style="background:#fff;border:1px solid #acacac;"><img src="http://www.google.com/holiday2008/snowing.gif" width="247" height="453" border="0"></td>
            <td width="6" bgcolor="#c1e0f3"><img src="http://www.google.com/holiday2008/sidebgr.gif" width="6" height="453" border="0"></td>
        </tr>
        <tr>
            <td width="6" bgcolor="#c1e0f3"><img src="http://www.google.com/holiday2008/sidebgr.gif" width="6" height="38" border="0"></td>
            <td colspan="3" style="border:1px solid #acacac;" align="center"><img src="http://www.google.com/holiday2008/happyholidays.gif" width="480" height="38" alt="Happy Holidays" border="0"></td>
            <td width="6" bgcolor="#c1e0f3"><img src="http://www.google.com/holiday2008/sidebgr.gif" width="6" height="38" border="0"></td>
        </tr>
        <tr>
            <td width="6" bgcolor="#c1e0f3"><img src="http://www.google.com/holiday2008/sidebgr.gif" width="6" height="120" border="0"></td>
            <td colspan="3" style="background-color#fff;border:1px solid #acacac;padding:2px;" valign="top">
                <img src="http://www.google.com/holiday2008/gogl_logo_card.gif" width="140" height="40" alt="google partners" border="0" align="right" hspace="4" vspace="4" />
                <font face="Times New Roman" size="2">
                <div style="padding:4px;font:12pt 'Times New Roman',serif;color:#515151;">
                <span style="font-size:10pt"><i>from:</i></span>

                    <div style="padding:2px 4px;">
                        <% clientContact.owners.eachWithIndex { it, i -> %>
                            <% if(i < (clientContact.owners.size() - 1)) { %>
                                ${it.toString()},
                            <% }else { %>
                                ${it.toString()}
                            <% } %>
                        <% } %>
                    </div>
                </div>
                </font>
            </td>
            <td width="6" bgcolor="#c1e0f3"><img src="http://www.google.com/holiday2008/sidebgr.gif" width="6" height="120" border="0"></td>
        </tr>
        <tr>
            <td colspan="5" bgcolor="#c1e0f3"><img src="http://www.google.com/holiday2008/cardbg.gif" width="492" height="10" border="0"></td>

        </tr>
    </table>
</body>
</html> 
```

一旦此方法返回 ccIdToEmail 映射，我就会发送所有电子邮件。出于某种原因，准备这张 clientContactIds 和电子邮件正文的映射会导致我的应用程序在上面列出的两行中的任何一行冻结。我可以在冻结之前成功准备/发送约 140 封电子邮件。这种情况非常一致地发生。

有谁知道为什么这会起作用，但在从模板创建约 140 个电子邮件正文后停止工作？我无法在网上找到任何关于其他人遇到此问题的信息。

安德鲁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-16T08:47:33.740

听起来像一个同步问题。作为第一步，您应该在循环之外创建模板。因为不需要每次都重新创建模板。

```
 def ccIdToEmailMap = [:]
    def emailTemplateFile = Utilities.retrieveFile("email${File.separator}emailTemplate.gtpl")
    def engine = new SimpleTemplateEngine()
    def template = engine.createTemplate(emailTemplateFile)
    def clientContacts = ClientContact.list()
    for(ClientContact cc in clientContactList)
    {
            def binding = [clientContact : cc]
            def body = template.make(binding).toString()
            def email = [text: body, to: cc.emailAddress]
            ccIdToEmailMap.put(cc.id, email)
            println "added to map"
    }
    return ccIdToEmailMap 
```

如果它没有帮助，如果您发布模板内容和/或 ClientContact 的来源可能会有所帮助。

hth，西吉

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T23:09:02.520

在模板中延迟加载我的客户联系人所有者似乎存在问题。在 SimpleTemplateEngine 制作电子邮件正文时，我没有期望所有者被加载（效率低下），而是在绑定/制作正文之前急切地获取所有者。

我上面的代码现在看起来像这样：

```
 def emailTemplateFile = null
    def ccIdToEmailMap = [:]

    emailTemplateFile = Utilities.retrieveFile("email${File.separator}emailTemplate.gtpl")
    def engine = new SimpleTemplateEngine()
    def template = engine.createTemplate(emailTemplateFile)
    for(ClientContact cc in clientContactList)
    {
        //there was a locking problem when we tried to create the template for too many client contacts
        //i believe it was caused by lazy-fetching of the person/owners.  So, I fetch them before we bind
        //and make the email body.
        def criteria = ClientContact.createCriteria()
        cc = criteria.get {
            eq("id", cc.id)
            fetchMode('relationship', FM.EAGER)
            fetchMode('relationship.person', FM.EAGER)
        }
        def binding = [clientContact : cc]
        def body = template.make(binding).toString()
        def email = [text: body, to: cc.emailAddress]
        ccIdToEmailMap.put(cc.id, email)
    }

    return ccIdToEmailMap 
```

为每个客户联系人进行如此多的查询仍然有点低效，但它可以工作。我无法解释为什么在模板制作期间延迟加载它们会导致 grails/groovy 冻结，但确实如此。如果有人能解释一下，我将不胜感激。

谢谢您的回答。齐格弗里德……你让我朝着正确的方向开始。

安德鲁

# eclipse - Ant任务的Eclipse键盘快捷键？

> ID：370204
> 
> 赞同：11
> 
> 时间：2008-12-16T00:47:30.887
> 
> 标签：eclipse, ant, keyboard-shortcuts

有没有办法通过键盘运行特定的 Ant 任务？我有一个 rsync to dev 任务，我运行了很多并且运行到鼠标双击是一种痛苦。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-16T07:00:47.250

如果您定期启动相同的外部启动，您可以为命令分配一个快捷方式：
`"Run Last Launched External Tool"`

（Windows/Preferences：键入 Keys，然后启动，用 Eclipse Ganymede 3.4.1 测试）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-16T08:28:37.493

Eclipse Ganymede 帮助中列出了以下键盘快捷键：

运行 Ant 构建：Alt+Shift+X、Q

# perl - 如何使用 Class::DBI 将二进制数据插入 BLOB 列？

> ID：370208
> 
> 赞同：2
> 
> 时间：2008-12-16T00:50:54.937
> 
> 标签：perl, blob, class-dbi

我想使用 Class::DBI 创建一个新对象。此对象的字段之一是 BLOB 类型。我有一个要用于此数据的文件句柄，但显然，这样做是行不通的：

```
my $item = My::Class::DBI::Class->insert({
        foo       => $bar,
        biz       => $baz,
        blob         => $my_filehandle
        }); 
```

我缺少什么技巧吗？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-16T00:56:26.407

您必须读出文件句柄，然后将其插入。

```
my $blob = do {local $/; <$my_filehandle>};
my $item = My::Class::DBI::Class->insert({
        foo       => $bar,
        biz       => $baz,
        blob         => $blob,
        }); 
```

# c++ - 我怎样才能打破阅读这个文本文件（使用ifstream）？C++

> ID：370211
> 
> 赞同：1
> 
> 时间：2008-12-16T00:52:34.060
> 
> 标签：c++, ifstream

当出现“同义词”一词时，我想停止阅读我的文本输入文件。我正在使用 ifstream，但我不知道如何打破循环。我尝试使用字符串流“同义词”，但它最终使我的 bst 垃圾。我在下面包含了完整的项目文件，以防你想避免打字。

重要部分：

```
 for(;;)  /*here, I wanna break the cycle when it reads "synonyms"*/
               {

               inStream >> word;
               if (inStream.eof()) break;

               wordTree.insert(word);
               }

               wordTree.graph(cout); 
```

字典.txt

```
 1 cute
    2 hello
    3 ugly
    4 easy
    5 difficult
    6 tired
    7 beautiful
    synonyms
    1 7
    7 1
    antonyms
    1 3
    3 1 7
    4 5
    5 4
    7 3 
```

项目.cpp

```
#include <iostream>
#include <fstream>
#include <string>
#include <sstream>

#include "MiBST.h"

using namespace std;

class WordInfo{

      public:
      //--id accesor
      int id ()const {return myId; } 

      /* myId is the number that identifies each word*/

      //--input function
      void read (istream &in)
      {
        in>>myId>>word;     
      }

      //--output function
      void print(ostream &out)
      {
          out<<myId<<" "<<word;     
      }

      //--- equals operator
     bool operator==(const WordInfo & otherword) const
     { return myId == otherword.myId; }

     //--- less-than operator
      bool operator<(const WordInfo & otherword) const
      { return myId < otherword.myId; }

      private:
              int myId;
              string word;

      };

      //--- Definition of input operator
      istream & operator>>(istream & in, WordInfo & word)
      {
           word.read(in);
      }

      //---Definition of output operator

      ostream & operator <<(ostream &out, WordInfo &word)
      {
            word.print(out);       
      }

      int main(){

          // Open stream to file of ids and words
          string wordFile;

          cout << "Enter name of dictionary file: ";
          getline(cin, wordFile);

          ifstream inStream(wordFile.data());

          if (!inStream.is_open())
          {
           cerr << "Cannot open " << wordFile << "\n";
           exit(1);
          }

          // Build the BST of word records
          BST<WordInfo> wordTree;   // BST of word records

          WordInfo word;            // a word record

          for(;;)  /*here, I wanna break the cycle when it reads "synonyms"*/
           {

           inStream >> word;
           if (inStream.eof()) break;

           wordTree.insert(word);
           }

           wordTree.graph(cout);

           //wordTree.inorder(cout);

          system ("PAUSE");
          return 0;

      } 
```

MiBST.h（如果你想运行它）

```
#include <iostream>
#include <iomanip>

#ifndef BINARY_SEARCH_TREE
#define BINARY_SEARCH_TREE

template <typename DataType>
class BST
{
 public:
  /***** Function Members *****/
  BST();

  bool empty() const;

  bool search(const DataType & item) const;

  void insert(const DataType & item);

  void remove(const DataType & item);

  void inorder(std::ostream & out) const;

  void graph(std::ostream & out) const;

  private:
  /***** Node class *****/
  class BinNode 
  {
   public:
    DataType data;
    BinNode * left;
    BinNode * right;

    // BinNode constructors
    // Default -- data part is default DataType value; both links are null.
    BinNode()
    : left(0), right(0)
    {}

    // Explicit Value -- data part contains item; both links are null.
    BinNode(DataType item)
    : data(item), left(0), right(0)
    {}

}; //end inner class

typedef BinNode * BinNodePointer; 

  /***** Private Function Members *****/
  void search2(const DataType & item, bool & found,
               BinNodePointer & locptr, BinNodePointer & parent) const;
 /*------------------------------------------------------------------------
   Locate a node containing item and its parent.

   Precondition:  None.
   Postcondition: locptr points to node containing item or is null if 
       not found, and parent points to its parent.#include <iostream>
 ------------------------------------------------------------------------*/

  void inorderAux(std::ostream & out, 
                  BST<DataType>::BinNodePointer subtreePtr) const;
  /*------------------------------------------------------------------------
    Inorder traversal auxiliary function.

    Precondition:  ostream out is open; subtreePtr points to a subtree 
        of this BST.
    Postcondition: Subtree with root pointed to by subtreePtr has been
        output to out.
 ------------------------------------------------------------------------*/

  void graphAux(std::ostream & out, int indent,
                      BST<DataType>::BinNodePointer subtreeRoot) const;
  /*------------------------------------------------------------------------
    Graph auxiliary function.

    Precondition:  ostream out is open; subtreePtr points to a subtree 
        of this BST.
    Postcondition: Graphical representation of subtree with root pointed 
        to by subtreePtr has been output to out, indented indent spaces.
 ------------------------------------------------------------------------*/

 /***** Data Members *****/
  BinNodePointer myRoot; 

}; // end of class template declaration

//--- Definition of constructor
template <typename DataType>
inline BST<DataType>::BST()
: myRoot(0)
{}

//--- Definition of empty()
template <typename DataType>
inline bool BST<DataType>::empty() const
{ return myRoot == 0; }

//--- Definition of search()
template <typename DataType>
bool BST<DataType>::search(const DataType & item) const
{
   typename BST<DataType>::BinNodePointer locptr = myRoot;

   typename BST<DataType>::BinNodePointer parent =0;

/*   BST<DataType>::BinNodePointer locptr = myRoot;
   parent = 0; */ //falta el typename en la declaracion original

   bool found = false;
   while (!found && locptr != 0)
   {
      if (item < locptr->data)       // descend left
        locptr = locptr->left;
      else if (locptr->data < item)  // descend right
        locptr = locptr->right;
      else                           // item found
        found = true;
   }
   return found;
}

//--- Definition of insert()
template <typename DataType>
inline void BST<DataType>::insert(const DataType & item)
{
   typename BST<DataType>::BinNodePointer 
        locptr = myRoot,   // search pointer
        parent = 0;        // pointer to parent of current node
   bool found = false;     // indicates if item already in BST
   while (!found && locptr != 0)
   {
      parent = locptr;
      if (item < locptr->data)       // descend left
         locptr = locptr->left;
      else if (locptr->data < item)  // descend right
         locptr = locptr->right;
      else                           // item found
         found = true;
   }
   if (!found)
   {                                 // construct node containing item

      locptr = new typename BST<DataType>::BinNode(item);  
      if (parent == 0)               // empty tree
         myRoot = locptr;
      else if (item < parent->data )  // insert to left of parent
         parent->left = locptr;
      else                           // insert to right of parent
         parent->right = locptr;
   }
   else
      std::cout << "Item already in the tree\n";
}

//--- Definition of remove()
template <typename DataType>
void BST<DataType>::remove(const DataType & item)
{
   bool found;                      // signals if item is found
   typename BST<DataType>::BinNodePointer 
      x,                            // points to node to be deleted
      parent;                       //    "    " parent of x and xSucc
   search2(item, found, x, parent);

   if (!found)
   {
      std::cout << "Item not in the BST\n";
      return;
   }
   //else
   if (x->left != 0 && x->right != 0)
   {                                // node has 2 children
      // Find x's inorder successor and its parent
      typename BST<DataType>::BinNodePointer xSucc = x->right;
      parent = x;
      while (xSucc->left != 0)       // descend left
      {
         parent = xSucc;
         xSucc = xSucc->left;
      }

     // Move contents of xSucc to x and change x 
     // to point to successor, which will be removed.
     x->data = xSucc->data;
     x = xSucc;
   } // end if node has 2 children

   // Now proceed with case where node has 0 or 2 child
   typename BST<DataType>::BinNodePointer 
      subtree = x->left;             // pointer to a subtree of x
   if (subtree == 0)
      subtree = x->right;
   if (parent == 0)                  // root being removed
      myRoot = subtree;
   else if (parent->left == x)       // left child of parent
      parent->left = subtree; 
   else                              // right child of parent
      parent->right = subtree;
   delete x;
}

//--- Definition of inorder()
template <typename DataType>
inline void BST<DataType>::inorder(std::ostream & out) const
{ 
   inorderAux(out, myRoot); 
}

//--- Definition of graph()
template <typename DataType>
inline void BST<DataType>::graph(std::ostream & out) const
{ graphAux(out, 0, myRoot); }

//--- Definition of search2()
template <typename DataType>
void BST<DataType>::search2(const DataType & item, bool & found,
                            BST<DataType>::BinNodePointer & locptr, 
                            BST<DataType>::BinNodePointer & parent) const
{
   locptr = myRoot;
   parent = 0;
   found = false;
   while (!found && locptr != 0)
   {
      if (item < locptr->data)       // descend left
      {
         parent = locptr;
         locptr = locptr->left;
      }
      else if (locptr->data < item)  // descend right
      {
         parent = locptr;
         locptr = locptr->right;
      }
      else                           // item found
         found = true;
   }
}
//--- Definition of inorderAux()
template <typename DataType>
void BST<DataType>::inorderAux(std::ostream & out, 
                               BST<DataType>::BinNodePointer subtreeRoot) const
{
   if (subtreeRoot != 0)
   {
      inorderAux(out, subtreeRoot->left);    // L operation
      out << subtreeRoot->data << "  ";      // V operation
      inorderAux(out, subtreeRoot->right);   // R operation
   }
}

//--- Definition of graphAux()

template <typename DataType>
void BST<DataType>::graphAux(std::ostream & out, int indent, 
                             BST<DataType>::BinNodePointer subtreeRoot) const
{
  if (subtreeRoot != 0)
    {
      graphAux(out, indent + 8, subtreeRoot->right);
      out << std::setw(indent) << " " << subtreeRoot->data << std::endl;
      graphAux(out, indent + 8, subtreeRoot->left);
    }
}

#endif 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-16T01:02:27.097

您应该在 WordInfo 上创建一个运算符 == 以将其与字符串进行比较，然后您可以在阅读循环中这样做：

```
if ( word == "synonyms" ) break; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-16T01:12:17.343

你可以这样做

```
/* here, it stops when reading "synonyms" or when failing to extract a word. */
while(inStream >> word && word != "synonym") {
    wordTree.insert(word);
}
wordTree.graph(cout); 
```

请注意，当它无法读取非空白字符序列时，它会设置流的失败位。然后 inStream 评估为 false 。这就是使循环起作用的原因。使用时要小心，`.eof();`它仅在您尝试读取文件末尾之后才返回 true。因此，例如，您将退出循环，并在此处错过单词*3 树*：

```
1 house 2 garden 3 tree 
```

*假设tree*之后没有空格。如果您在单词信息之间有换行符并且在最后一个单词之后没有尾随换行符，当然也会发生同样的情况。使用`if(inStream)`（while 循环隐式执行）是安全的。在这种情况下，它仍然会评估为 true，并且只有在除了空白之外什么都不读取时才会评估为 false。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T01:21:12.737

@肥皂盒：

我创建了这个 == 运算符：

```
 //--- equals operator for String
     bool operator==(const string & aString) const
     { return word == aString; } // word is the WordInfo string field for 'real' word 
```

并将 for(;;) 更改为：

```
for(;;)
           {

           inStream >> word;
           if (word=="synonyms") break;

           wordTree.insert(word);
           } 
```

并以无限循环打印结束：

```
"Item already in the tree" 
```

顺便说一句，我以前用这样的示例字典测试了这棵树，它确实有效。

```
dict2.txt 
```

1 可爱 2 你好 3 丑 4 容易 5 困难 6 累 7 漂亮

# perl - 如何使用 CGI::Application 获取上传文件的内容类型？

> ID：370215
> 
> 赞同：2
> 
> 时间：2008-12-16T00:55:46.220
> 
> 标签：perl, cgi-application

我正在尝试使用 CGI::Application 在 Perl 程序中处理上传的文件。我需要获取上传文件的内容类型。根据我的阅读，以下内容应该有效，但不适用于我：

```
my $filename = $q->param("file");
my $contenttype = $q->uploadInfo($filename)->{'Content-Type'}; 
```

事实证明，`$q->uploadInfo($filename)`返回`undef`. 也是如此`$q->uploadInfo("file")`。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-16T02:51:50.853

您相信上传的任何内容都能为您提供良好的内容类型吗？我只是将上传的文件保存到磁盘并执行以下操作：

```
chomp(my $mime_type = qx!file -i $uploaded!);
$mime_type =~ s/^.*?: //;
$mime_type =~ s/;.*//; 
```

尽管您可以改用 File::Type、File::MMagic 或 File::MimeInfo。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T07:01:16.467

您是否正在检查任何可能出错的地方？

我得到了可以正常工作的确切代码，但是看着它，它被包含在一个测试中，用于测试`$filename`undef 以及`$cgi->cgi_error()`. 我的记忆有些模糊，但一定是有原因的……

# ruby - 安装rubygems的麻烦

> ID：370218
> 
> 赞同：2
> 
> 时间：2008-12-16T00:56:41.633
> 
> 标签：ruby, rubygems

我正在尝试在我的主目录中设置第二个 ruby​​ 安装（用于测试的不同版本的 ruby​​）。我已经将 ruby​​ 编译成`~/bin/`并且一切正常，直到我尝试安装 ruby​​gems。

我已`GEM_HOME`设置为`~/gems`目录并`GEM_PATH`设置为相同。然后我尝试安装 ruby​​gems

```
~/bin/ruby setup.rb 
```

安装似乎成功，但安装后 ruby​​ 找不到 ruby​​gems。

```
$~/bin/irb
irb(main):001:0> require 'rubygems'
LoadError: no such file to load -- rubygems
    from (irb):1:in `require'
    from (irb):1 
```

有人知道为什么 ruby​​ 找不到 ruby​​gems 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-16T03:05:04.777

除了设置之外，`GEM_HOME`您还需要`config`使用您的路径运行。以下是来自[ruby​​gems.org](http://www.rubygems.org/read/chapter/3#page83)的步骤。

```
$ export GEM_HOME=/home/mygemrepository
$ ruby setup.rb config --prefix=/home/mystuff
$ ruby setup.rb setup
$ ruby setup.rb install 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T16:38:37.287

以完全相同的方式失败。我相信前缀告诉 setup.rb 将 ruby​​gems 放在哪里，但没有告诉 ruby​​ 在哪里找到它。此外，来自 ruby​​gems.org 的步骤是不同的情况。他们正在他们的主文件夹中安装 ruby​​gems，但使用系统 ruby​​ 二进制文件。我正在尝试使用我的主文件夹中的 ruby​​ 二进制文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T17:14:16.370

好的，我让它工作了。有时，新的一天就足够了。

解决方案 1\. 我使用了旧版本的 gems（准确地说是 1.1.1） 2\. 我没有使用前缀，但我确实设置了 GEM_HOME 和 GEM_PATH

# flash - 在 AS3 中访问 Document 类

> ID：370222
> 
> 赞同：15
> 
> 时间：2008-12-16T00:59:15.433
> 
> 标签：flash, actionscript-3, oop, class, document-class

实例化的类如何**访问 Document 类？**

即使在我使用 Flash 中的属性栏**命名 Document 类**之后，尝试从其他类访问它通常也会失败，说*“正在尝试访问未定义的属性......*

一种解决方案是始终**将 Document 类转换为自身！**例如。

```
Main(Main).globalMethod(); 
```

但有时即使是这个恒星陷阱也会失败，然后通常没有出路，除了**显而易见的！**

```
class Other{

   var parentClass:Main;
   public function Other(parent:Main){
       parentClass = parent;            // pointer to the Main class in a local var!

       Main(parentClass).globalMethod();
   }
} 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-12-17T03:39:34.953

您可以为您的文档类（在您的示例中为 ）使用单`Main`例，它允许您从任何地方访问该实例。

```
public class Main extends Sprite {
    private static var _instance:Main;
    public static function get instance():Main { return _instance; }

    public function Main() {
        _instance = this;
       // etc...
    }

    // etc...
} 
```

然后你`Main`像这样访问实例：

```
public class Other {
    public function Other() {
        Main.instance.usefulInstanceMethod();
    }
} 
```

文档类非常适合单例模式，因为通常应该只有实例可用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-16T15:22:37.283

文档类本质上不是全局可访问的对象。如果要调用文档类中的方法，则始终必须将 Main 中的引用传递给要调用其方法的任何其他类/对象。一种更面向对象的方法是从您的其他类（Other）分派事件，以便 Main 类监听并调用其自身的适当方法。

如果您不关心保持良好的 OOP 结构并希望从已添加到显示列表的显示对象访问文档类，您可以尝试以下操作：`stage.getChildAt( 0 );`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-18T02:38:24.873

只是一个旁注，但这个问题的最短答案是：任何类访问任何其他类的方式相同。也就是说，使用直接参考或静态曝光。在这方面，文档类与任何其他类没有什么不同。

# c# - 从一个项目定位 Windows Mobile 6 Professional 和 Standard

> ID：370223
> 
> 赞同：0
> 
> 时间：2008-12-16T01:00:58.817
> 
> 标签：c#, windows-mobile

是否可以从一个项目中针对 Windows Mobile 6 Professional 和 Standard？

也许是一个类库，带有程序逻辑，以及两个用于与逻辑交互的 GUI 应用程序（一个用于专业，一个用于标准）。

这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-16T01:20:32.333

我一直在使用链接文件。

您在一个项目中创建源文件，然后将它们添加到另一个项目。诀窍是您必须使用“添加现有项目”对话框中的“添加为链接”选项。

# php - ExpressionEngine 多站点管理器和成员组

> ID：370243
> 
> 赞同：2
> 
> 时间：2008-12-16T01:17:05.447
> 
> 标签：php, membership, expressionengine

我正在寻找一些链接，以获取有关 EE 如何处理与 MSM 相关的成员组的更多信息。

就我而言，我有两个会员网站。一般来说，这两个站点服务于同一群人，因此 MSM 共享成员数据库这一事实对我有利。我不清楚的是如何管理不同的访问级别组合，即：

1.  站点 A 成员但不是站点 B
2.  站点 B 的成员，但不是站点 A
3.  站点 A 和站点 B 的成员

因为，正如我在其他论坛帖子中所读到的，您不能将一个成员分配给多个组，我显然必须在上述配置中创建 3 个成员组并相应地分配用户。至少在模板中我可以检查组 1|3 的成员资格……对吗？

我们计划进一步将我们的会员资格划分为单个站点内的不同访问级别。

例如，

1.  完全访问站点 A
2.  访问站点 A 的单月内容
3.  访问一个月的内容 + 网络工具

如果我必须创建管理上述每种组合的组，除了访问站点 B 的访问级别之外，这将很快变得无法使用。

听起来我必须直接在模板中使用自定义 PHP 代码来管理我在 EE 之外的访问级别。

有没有人有这种事情的经验？

最好根本不使用 MSM，而是将每个站点作为单独的安装进行管理，并具有单独的成员组？（这会挫败我首先使用 EE 的一些原因，即在站点之间共享博客内容）

指向外部资源或文档的链接会有所帮助。（是的，我确实先检查了文档，但可能遗漏了一些东西……眨眼）

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T15:04:55.990

* * *

## 我知道这已经很久了，但从未给出/接受答案。也许这会帮助其他偶然发现使用直接EE的人。

* * *

伊恩，

我现在正在对 6 个站点和这些站点的多个市场做类似的事情。

这就是我正在做的事情。我希望它有所帮助。

就像迈克尔说的那样，这些账户是系统范围的。因此，每个帐户都可以访问 MSM 下的所有站点。我为每个要登录的“市场”设置了多个域（不是必需的）。然后在那个实际上是市场的“站点”下，我限制了其他站点的控制面板访问以及未跨站点使用的内容。这使它们看起来是特定于站点的，并且仍然允许超级管理员或我在它们之上构建的任何帐户跨多个站点进行管理。

示例：（让我们使用您的布局）

1.  站点 A 成员但不是站点 B
2.  站点 B 的成员，但不是站点 A
3.  站点 A 和站点 B 的成员

我将有三个成员组。

1.  A组
2.  B组
3.  AB组

对于 A 组，我会执行以下操作：（以超级管理员身份执行此操作）

*   从 MSM 下拉列表中选择站点 B。
*   从 CP 中选择成员 => 成员组
*   对于 A 组，单击“编辑组”
*   删除此站点的所有访问权限和 CP 访问权限，然后保存

对于 B 组，我会执行以下操作：（以超级管理员身份执行此操作）

*   从 MSM 下拉列表中选择站点 A。
*   从 CP 中选择成员 => 成员组
*   对于 B 组，单击“编辑组”
*   删除此站点的所有访问权限和 CP 访问权限，然后保存

对于 AB 组，我会执行以下操作：（以超级管理员身份执行此操作）

*   从 MSM 下拉列表中选择站点 A。
*   从 CP 中选择成员 => 成员组
*   对于 AB 组，单击“编辑组”
*   授予此站点的所有访问权限和 CP 访问权限，然后保存
*   从 MSM 下拉列表中选择站点 B。
*   从 CP 中选择成员 => 成员组
*   对于 AB 组，单击“编辑组”
*   授予此站点的所有访问权限和 CP 访问权限，然后保存

然后，当来自各个组的成员登录执行功能时，他们将只能看到他们被授予的访问权限，从而将站点视为单独的。

这对我有用。希望它可以帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T02:20:30.807

您的会员数据库将跨越两个站点，因此不会出现用户是站点 A 而不是站点 B 的成员的实例 - 通过在任一站点上注册，他们的帐户会为所有其他合作伙伴站点创建。

会员组可以具有每个站点的首选项 - 因此组在站点 A 上的权限可能比在站点 B 上的权限更高。这还允许您为新注册的用户设置不同的默认组，具体取决于他们在哪个站点上注册。

您对 EE 的每个成员一个组是正确的 - 因此您将建立各种组。EE 2.0 即将推出，遗憾的是我还没有审查它的所有功能，但您可能想看看它是否支持每个成员多个组。

# c++ - 如何调试在 ASP 页中创建的 Visual Studio 6.0 中的 COM 对象？

> ID：370250
> 
> 赞同：1
> 
> 时间：2008-12-16T01:23:10.377
> 
> 标签：c++, com, asp-classic, visual-c++-6

我有一个旧的 C++ COM 组件，它必须保持 Visual Studio 6.0 格式。我一生都无法弄清楚如何在实际的 COM 组件中调试代码。

我能够在调试模式下构建它，添加断点并将其附加到 dllhost.exe 进程，但 Visual Studio 环境只会显示来自 dllhost.exe 而不是我的源代码的反汇编（它也不会停止在断点上）。

我记得不久前有一种方法可以使 IIS（或 inetinfo.exe）成为您的调试操作的*目标*（即当 Visual Studio 6.0 要求您提供可执行文件以启动您的 dll 时），并且 IIS 将以单进程模式运行。您需要更改一个注册表项，但谷歌搜索没有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-16T02:25:55.743

如果是基于 VB6 的 COM 组件，可以在 VB6 中打开项目并运行（不能运行 DLL 项目）。项目属性有一些选项，可以要求它运行，以便它运行并自行注册。

现在，尝试点击调用 COM 组件的 ASP 页面。类文件中设置的断点将被命中，因为调用是从 ASP 页面进行的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T06:17:44.370

首先，PDB文件（编译时产生的）应该和DLL在同一目录下（可以在项目属性中设置）。

如果您的对象不使用某些特定于 ASP 的功能（请求、响应、会话对象），您可以将其调用代码复制到 .vbs 文件并通过将*cscript.exe your.vbs*设置为调试目标程序进行调试。

有解释（[例如](http://support.microsoft.com/default.aspx/kb/183480)）如何调试 ISAPI DLL - 它们也适用于您的 COM 对象（从操作系统/调试器的角度来看，它们都是加载到 IIS 进程中的 DLL）。注意你的 IIS 版本和进程内/进程外的东西。

最后，如果没有其他帮助，您可以通过[OutputDebugString](http://msdn.microsoft.com/en-us/library/aa363362%28VS.85%29.aspx)函数添加一些日志记录，并在免费的[DebugView](http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx)程序中查看它。

# java - 策略模式的真实示例

> ID：370258
> 
> 赞同：105
> 
> 时间：2008-12-16T01:29:29.930
> 
> 标签：java, c#, design-patterns, strategy-pattern

我一直在阅读有关[OCP 原则](http://en.wikipedia.org/wiki/Open/closed_principle)以及如何使用策略模式来实现这一点的内容。

我打算尝试向几个人解释这一点，但我能想到的唯一示例是根据“订单”的状态使用不同的验证类。

我在网上阅读了几篇文章，但这些文章通常不会描述使用该策略的真正相似原因，例如生成报告/账单/验证等...

有没有你认为策略模式很常见的真实例子？

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2008-12-16T01:40:38.113

那这个呢：

您必须加密文件。

对于小文件，您可以使用“内存中”策略，将完整文件读取并保存在内存中（假设文件 < 1 gb ）

对于大文件，您可以使用另一种策略，其中部分文件在内存中读取，部分加密结果存储在 tmp 文件中。

对于同一任务，这可能是两种不同的策略。

客户端代码看起来相同：

```
 File file = getFile();
 Cipher c = CipherFactory.getCipher( file.size() );
 c.performAction();

// implementations:
interface  Cipher  {
     public void performAction();
}

class InMemoryCipherStrategy implements Cipher { 
         public void performAction() {
             // load in byte[] ....
         }
}

class SwaptToDiskCipher implements Cipher { 
         public void performAction() {
             // swapt partial results to file.
         }

} 
```

这

```
 Cipher c = CipherFactory.getCipher( file.size() ); 
```

将为密码返回正确的策略实例。

我希望这有帮助。

*（我什至不知道 Cipher 是否是正确的词：P）*

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2014-01-16T14:57:09.307

同样，一个旧帖子，但仍然出现在搜索中，所以我将添加另外两个示例（代码在 C# 中）。我非常喜欢策略模式，因为当项目经理说：“我们希望应用程序做‘X’，但‘X’还不清楚，它可能在不久的将来发生变化时，它救了我很多次。 " 该[视频解释了策略模式](http://www.youtube.com/watch?v=MOEsKHqLiBM)，以星际争霸为例。

属于这一类的东西：

*   排序：我们想对这些数字进行排序，但我们不知道是否要使用 BrickSort、BubbleSort 或其他排序

*   验证：我们需要根据“一些规则”检查项目，但目前尚不清楚该规则将是什么，我们可能会想到新的规则。

*   游戏：我们希望玩家在移动时要么走路要么奔跑，但也许在未来，他也应该能够游泳、飞行、传送、在地下挖洞等。

*   存储信息：我们希望应用程序将信息存储到数据库中，但稍后它可能需要能够保存文件或进行网络通话

*   输出：我们需要将 X 输出为纯字符串，但稍后可能是 CSV、XML、JSON 等。

* * *

**例子**

我有一个项目，用户可以将产品分配给数据库中的人。将产品分配给某人的状态为“已批准”或“已拒绝”，这取决于某些业务规则。例如：如果用户将产品分配给某个年龄的人，它的状态应该被拒绝；如果项目中两个字段之间的差异大于 50，则其状态为拒绝等。

现在，在开发的那一刻，这些业务规则还没有完全清楚，新的规则随时可能出现。策略模式的强大之处在于我制作了一个 RuleAgent，它给出了一个 IRules 列表。

```
public interface IRule {
    bool IsApproved(Assignment assignment); 
 } 
```

在将产品分配给某人的那一刻，我创建了一个 RuleAgent，给它一个规则列表（它们都实现了 IRule），并要求它验证分配。它将贯穿它的所有规则。其中，因为它们都实现了相同的接口，所以都有`IsApproved`方法并且如果它们中的任何一个返回 false，则返回 false。

现在，例如经理突然出现说，我们还需要拒绝所有给实习生的任务，或者所有给加班的人的任务......你创建这样的新课程：

```
public OvertimeRule : IRule
{
    public bool IsApproved(Assignment assignment) //Interface method
    {
        if (assignment.Person.Timesheet >= 40)
        {
            return false;
        }
        return true;
    }
}

public InternRule : IRule
{
    public bool IsApproved(Assignment assignment) //Interface method
    {
        if (assignment.Person.Title == "Intern")
        {
            return false;
        }
        return true;
    }
} 
```

您会看到您不必不断添加或删除 if 语句或代码，只需创建一个实现 IRUle 接口的新规则类并在需要时将其切换出来。

* * *

另一个很好的例子：Scott Allen 在[http://www.asp.net/mvc/pluralsight](http://www.asp.net/mvc/pluralsight)的视频系列，他在应用程序的单元测试部分使用了策略模式

他建立了一个网站，该网站的页面根据受欢迎程度显示项目。然而，“流行”可以是很多东西（最多的浏览量、最多的订阅者、创建日期、最多的活动、最少的评论等），如果管理层还不知道如何订购，可能想尝试不同的日后订购。您使用 order 方法创建一个接口（IOrderAlgorithm 或其他东西），并让 Orderer 对象将排序委托给 IOrderAlgorithm 接口的具体实现。您可以创建一个“CommentOrderer”、“ActivityOrderer”等......当新的需求出现时，只需将它们切换出来。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2016-02-03T14:52:30.843

**关键说明：**

1.  ***策略***是行为设计​​模式。它用于在算法族之间切换。

2.  该模式包含一个抽象策略*接口*和该接口的许多*具体*策略实现（*算法*）。

3.  该应用程序仅使用策略*接口*。根据一些配置参数，*具体的策略*将被标记为*interface*。

[来自维基百科](https://en.wikipedia.org/wiki/Strategy_pattern)的 UML 图

[![在此处输入图像描述](https://i.stack.imgur.com/M6f7O.png)](https://i.stack.imgur.com/M6f7O.png)

一个真实的例子：*航空公司在某些月份（7 月至 12 月）提供折扣*。您可以拥有一个*票价*模块，该模块根据月份数决定定价选项。

看一个简单的例子。该示例可以扩展到在线零售应用程序，它可以轻松地在特殊日子/欢乐时光为购物车商品提供折扣。

```
import java.util.*;

/* Interface for Strategy */
interface OfferStrategy {
    public String getName();
    public double getDiscountPercentage();
}
/* Concrete implementation of base Strategy */
class NoDiscountStrategy implements OfferStrategy{
    public String getName(){
        return this.getClass().getName();
    }
    public double getDiscountPercentage(){
        return 0;
    }
}
/* Concrete implementation of base Strategy */
class QuarterDiscountStrategy implements OfferStrategy{
    public String getName(){
        return this.getClass().getName();
    }
    public double getDiscountPercentage(){
        return 0.25;
    }
}
/* Context is optional. But if it is present, it acts as single point of contact
   for client. 

   Multiple uses of Context
   1\. It can populate data to execute an operation of strategy
   2\. It can take independent decision on Strategy creation. 
   3\. In absence of Context, client should be aware of concrete strategies. Context acts a wrapper and hides internals
   4\. Code re-factoring will become easy
*/
class StrategyContext {
    double price; // price for some item or air ticket etc.
    Map<String,OfferStrategy> strategyContext = new HashMap<String,OfferStrategy>();
    StrategyContext(double price){
        this.price= price;
        strategyContext.put(NoDiscountStrategy.class.getName(),new NoDiscountStrategy());
        strategyContext.put(QuarterDiscountStrategy.class.getName(),new QuarterDiscountStrategy());        
    }
    public void applyStrategy(OfferStrategy strategy){
        /* 
        Currently applyStrategy has simple implementation. You can use Context for populating some more information,
        which is required to call a particular operation            
        */
        System.out.println("Price before offer :"+price);
        double finalPrice = price - (price*strategy.getDiscountPercentage());
        System.out.println("Price after offer:"+finalPrice);
    }
    public OfferStrategy getStrategy(int monthNo){
        /*
            In absence of this Context method, client has to import relevant concrete Strategies everywhere.
            Context acts as single point of contact for the Client to get relevant Strategy
        */
        if ( monthNo < 6 )  {
            return strategyContext.get(NoDiscountStrategy.class.getName());
        }else{
            return strategyContext.get(QuarterDiscountStrategy.class.getName());
        }

    }
}
public class StrategyDemo{    
    public static void main(String args[]){
        StrategyContext context = new StrategyContext(100);
        System.out.println("Enter month number between 1 and 12");
        int month = Integer.parseInt(args[0]);
        System.out.println("Month ="+month);
        OfferStrategy strategy = context.getStrategy(month);
        context.applyStrategy(strategy);
    }

} 
```

输出：

```
Enter month number between 1 and 12
Month =1
Price before offer :100.0
Price after offer:100.0

Enter month number between 1 and 12
Month =7
Price before offer :100.0
Price after offer:75.0 
```

有用的文章：

dzone的[策略模式](https://dzone.com/articles/design-patterns-strategy)

[采购策略](https://sourcemaking.com/design_patterns/strategy)模式

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2010-01-08T21:07:26.467

我能想到几个相当简单的例子：

*   对列表进行排序。该策略是用于确定列表中两项中的哪一项是“第一”的比较
*   您可能有一个应用程序，其中可以在运行时选择排序算法本身（QuickSort、HeapSort 等）
*   [Log4Net](http://logging.apache.org/log4net/release/manual/introduction.html)和[Log4j](http://logging.apache.org/log4j/1.2/manual.html)中的附加器、布局和过滤器
*   UI 工具包中的[布局管理器](http://en.wikipedia.org/wiki/Layout_manager)
*   数据压缩。您可能有一个 ICompressor 接口，其唯一方法如下所示：

    字节[] 压缩（字节[] 输入）；

    您的具体压缩类可能是 RunLengthCompression、DeflateCompression 等。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2010-01-11T16:12:32.850

策略模式的一个常见用法是定义自定义排序策略（在没有高阶函数的语言中），例如在 Java 中按长度对字符串列表进行排序，传递匿名内部类（策略接口的实现）：

```
List<String> names = Arrays.asList("Anne", "Joe", "Harry");
Collections.sort(names, new Comparator<String>() {
  public int compare(String o1, String o2) {
    return o1.length() - o2.length();
  }
});
Assert.assertEquals(Arrays.asList("Joe", "Anne", "Harry"), names); 
```

以类似的方式，策略可以用于对象数据库的本地查询，例如在 db4o 中：

```
List<Document> set = db.query(new Predicate<Document>() {
  public boolean match(Document candidate) {
    return candidate.getSource().contains(source);
  }
}); 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2008-12-16T02:36:25.630

我有一个应用程序每天将其用户群与我们的企业目录同步。用户是否符合条件取决于他们在大学中的状态。供应程序每天都会通过并确保在应用程序中供应那些应该符合条件的人，而取消供应那些不符合条件的人（实际上是根据优雅降级算法，但这不是重点）。在星期六，我会进行更彻底的更新，同步每个用户的一些属性，并确保他们具有适当的资格。在月底，我会根据当月的使用情况进行一些退单处理。

我使用可组合的策略模式来执行此同步。主程序基本上根据星期几（仅同步更改/全部同步）和学期相对于学术日历的时间来选择主策略。如果计费周期即将结束，那么它还包含计费策略。然后它通过标准接口运行所选策略。

我不知道这有多普遍，但我觉得它非常适合策略模式。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2015-01-15T16:08:20.790

策略模式的一个很好的例子是在一个游戏中，我们可以有不同的角色，每个角色可以有多种武器进行攻击，但一次只能使用一种武器。所以我们将角色作为上下文，例如国王、指挥官、骑士、士兵和武器作为策略，其中攻击（）可以是取决于所使用武器的方法/算法。因此，如果具体的武器类是 Sword、Axe、Crossbow、BowAndArrow 等......它们都将实现 attack() 方法。我确信不需要进一步的解释。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2012-10-05T05:57:20.640

我知道这是一个老问题，但我想我最近实现了另一个有趣的例子。

这是文档传递系统中使用的策略模式的一个非常实际的示例。

我有一个 PDF 交付系统，它接收包含大量文档和一些元数据的存档。根据元数据，它决定将文档放在哪里；比如说，根据数据，我可以将文档存储在`A`、`B`或`C`存储系统中，或者三者的混合。

不同的客户使用这个系统，他们有不同的回滚/错误处理要求，以防出现错误：一个希望交付系统在第一个错误时停止，将所有已交付的文档保留在他们的存储中，但停止该过程并且不交付任何其他东西; 另一个人希望它`B`在存储时回滚，以防出现错误`C`，但保留已经交付的任何内容`A`。很容易想象第三个或第四个也会有不同的需求。

为了解决这个问题，我创建了一个包含交付逻辑的基本交付类，以及从所有存储中回滚内容的方法。在发生错误时，交付系统实际上不会直接调用这些方法。相反，该类使用依赖注入来接收“回滚/错误处理策略”类（基于使用系统的客户），如果发生错误，则会调用该类，如果适合该策略，则会调用回滚方法。

交付类本身向策略类报告正在发生的事情（哪些文件被交付到了哪些存储，以及发生了哪些故障），并且每当发生错误时，它会询问策略是否继续。如果策略说“停止”，则该类调用该策略的“cleanUp”方法，该方法使用先前报告的信息来决定从交付类调用哪些回滚方法，或者干脆什么都不做。

```
rollbackStrategy.reportSuccessA(...);
rollbackStrategy.reportFailureB(...);

if (rollbackStrategy.mustAbort()) {
    rollbackStrategy.rollback(); // rollback whatever is needed based on reports
    return false;
} 
```

所以我现在有两种不同的策略：一种是`QuitterStrategy`（在第一个错误时退出并且什么都不清理），另一种是`MaximizeDeliveryToAStrategy`（尽可能不中止进程并且从不回滚传递到存储的东西`A`，但是`B`如果交付`C`失败，则回滚内容）。

据我了解，这是策略模式的一个例子。如果您（是的，您正在阅读）认为我错了，请在下面发表评论并告诉我。我很好奇什么会构成策略模式的“纯”使用，以及我的实现的哪些方面违反了定义。我觉得它看起来有点搞笑，因为策略界面有点胖。到目前为止我看到的所有例子都只使用了一种方法，但我仍然认为这封装了一个算法（如果一个业务逻辑可以被认为是一个算法，我认为它确实如此）。

由于该策略还会在交付执行期间收到有关事件的通知，因此也可以将其视为[Observer](http://en.wikipedia.org/wiki/Observer_pattern)，但这是另一回事。

通过做一些研究，这似乎是一种称为[Advisor](http://onjava.com/pub/a/onjava/2003/09/17/patterns.html)的“复合模式”（如 MVC，一种以特定方式在下面使用多种设计模式的模式） 。它是关于是否应该继续交付的顾问，但它也是一个活动的错误处理程序，因为它可以在被要求时回滚内容。

无论如何，这是一个非常复杂的示例，可能会让您觉得策略模式的使用都太简单/愚蠢。当与其他模式一起使用时，它可能非常复杂，甚至更适用。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2015-07-08T11:38:23.497

策略模式是最常用的模式，专门用于验证和排序算法。

让我用一个简单的实际例子来解释

```
enum Speed {
  SLOW, MEDIUM, FAST;
}

class Sorter {
 public void sort(int[] input, Speed speed) {
    SortStrategy strategy = null;
    switch (speed) {
    case SLOW:
        strategy = new SlowBubbleSortStrategy();
        break;
    case MEDIUM:
        strategy = new MediumInsertationSortStrategy();
        break;

    case FAST:
        strategy = new FastQuickSortStrategy();
        break;
    default:
        strategy = new MediumInsertationSortStrategy();
    }
    strategy.sort(input);
 }

}

interface SortStrategy {

    public void sort(int[] input);
}

class SlowBubbleSortStrategy implements SortStrategy {

   public void sort(int[] input) {
    for (int i = 0; i < input.length; i++) {
        for (int j = i + 1; j < input.length; j++) {
            if (input[i] > input[j]) {
                int tmp = input[i];
                input[i] = input[j];
                input[j] = tmp;
            }
        }
    }
    System.out.println("Slow sorting is done and the result is :");
    for (int i : input) {
        System.out.print(i + ",");
    }
  }

 }

class MediumInsertationSortStrategy implements SortStrategy {

public void sort(int[] input) {
    for (int i = 0; i < input.length - 1; i++) {
        int k = i + 1;
        int nxtVal = input[k];
        while (input[k - 1] > nxtVal) {
            input[k] = input[k - 1];
            k--;
            if (k == 0)
                break;
        }
        input[k] = nxtVal;
    }
    System.out.println("Medium sorting is done and the result is :");
    for (int i : input) {
        System.out.print(i + ",");
    }

 }

}

class FastQuickSortStrategy implements SortStrategy {

public void sort(int[] input) {
    sort(input, 0, input.length-1);
    System.out.println("Fast sorting is done and the result is :");
    for (int i : input) {
        System.out.print(i + ",");
    }
}

private void sort(int[] input, int startIndx, int endIndx) {
    int endIndexOrig = endIndx;
    int startIndexOrig = startIndx;
    if( startIndx >= endIndx)
        return;
    int pavitVal = input[endIndx];
    while (startIndx <= endIndx) {
        while (input[startIndx] < pavitVal)
            startIndx++;
        while (input[endIndx] > pavitVal)
            endIndx--;
        if( startIndx <= endIndx){
            int tmp = input[startIndx];
            input[startIndx] = input[endIndx];
            input[endIndx] = tmp;
            startIndx++;
            endIndx--;
        }
    }
    sort(input, startIndexOrig, endIndx);
    sort(input, startIndx, endIndexOrig);
 }

} 
```

对此的测试代码是

```
public class StrategyPattern {
  public static void main(String[] args) {
    Sorter sorter = new Sorter();
    int[] input = new int[] {7,1,23,22,22,11,0,21,1,2,334,45,6,11,2};
    System.out.print("Input is : ");
    for (int i : input) {
        System.out.print(i + ",");
    }
    System.out.println();
    sorter.sort(input, Speed.SLOW);
 }

} 
```

同样的例子取自[http://coder2design.com/strategy-pattern/](http://coder2design.com/strategy-pattern/)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-01-22T23:07:35.900

您确定“订单”的状态不是状态模式吗？我有一种预感，订单的处理方式不会根据其状态而有所不同。

以按订单*发货*的方法为例：

```
order.Ship(); 
```

*   如果运输方式的功能因状态而异，那么您就有了策略模式。
*   但是，如果*Ship()*方法仅在订单已付款且订单尚未发货时才成功，那么您就有了一个状态模式。

我发现的状态模式（和其他模式）的最佳示例是在“ [Head First Design Patterns](https://rads.stackoverflow.com/amzn/click/com/0596007124) ”一书中，这太棒了。紧随其后的是[David Cumps 的博客系列模式](http://blog.cumps.be/design-patterns-strategy-pattern/)。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2017-05-23T04:38:06.273

```
public class StrategyDemo {
    public static void main(String[] args) {
        ShoppingCart cart = new ShoppingCart();

        Item item1 = new Item("1234", 10);
        Item item2 = new Item("5678", 40);

        cart.addItem(item1);
        cart.addItem(item2);

        // pay by paypal
        cart.pay(new PaypalStrategy("myemail@example.com", "mypwd"));

        // pay by credit card
        cart.pay(new CreditCardStrategy("Pankaj Kumar", "1234567890123456", "786", "12/15"));
    }
}

interface PaymentStrategy {
    public void pay(int amount);
}

class CreditCardStrategy implements PaymentStrategy {

    private String name;
    private String cardNumber;
    private String cvv;
    private String dateOfExpiry;

    public CreditCardStrategy(String nm, String ccNum, String cvv, String expiryDate) {
        this.name = nm;
        this.cardNumber = ccNum;
        this.cvv = cvv;
        this.dateOfExpiry = expiryDate;
    }

    @Override
    public void pay(int amount) {
        System.out.println(amount + " paid with credit/debit card");
    }

}

class PaypalStrategy implements PaymentStrategy {

    private String emailId;
    private String password;

    public PaypalStrategy(String email, String pwd) {
        this.emailId = email;
        this.password = pwd;
    }

    @Override
    public void pay(int amount) {
        System.out.println(amount + " paid using Paypal.");
    }

}

class Item {

    private String upcCode;
    private int price;

    public Item(String upc, int cost) {
        this.upcCode = upc;
        this.price = cost;
    }

    public String getUpcCode() {
        return upcCode;
    }

    public int getPrice() {
        return price;
    }

}

class ShoppingCart {

    // List of items
    List<Item> items;

    public ShoppingCart() {
        this.items = new ArrayList<Item>();
    }

    public void addItem(Item item) {
        this.items.add(item);
    }

    public void removeItem(Item item) {
        this.items.remove(item);
    }

    public int calculateTotal() {
        int sum = 0;
        for (Item item : items) {
            sum += item.getPrice();
        }
        return sum;
    }

    public void pay(PaymentStrategy paymentMethod) {
        int amount = calculateTotal();
        paymentMethod.pay(amount);
    }
} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-12-16T03:57:39.380

我在一个应用程序中的一个相当复杂的引擎中使用了策略方法，这是一个很好的例子。本质上，引擎的作用是首先找到一个拥有小部件的人的列表，它的第二个作用是根据未知数量的参数（比如价格距离以前的业务在一起）找出哪些是拥有小部件的 10 个最佳人, 库存量, 运输选项等等等...)

基本上我们所做的是将问题分解为两种策略，第一种是数据检索，因为我们知道我们有多个小部件来源，我们需要能够获取数据并将其转换为通用结构。

然后我们还意识到我们有多种算法，有些是基于参数加权的，有些是非常奇怪和固有的，如果不拉出 visios 和图表，我就无法做到公正，你明白了，我们有很多算法选择最优秀的人。

我们的服务本身就是它本质上定义输入、输出并对数据进行一些规范化的东西，它还使用提供者模式来插入使用该策略的特定于应用程序的数据提供者和算法提供者。这是一个相当有效的系统。

如果我们使用从未解决的策略或模板模式，我们会进行一些辩论。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2014-01-18T19:27:08.403

假设您想编写一个算法来计算给定月份和年份的*第 n 个 Xday*，例如 2014 年 10 月的第二个星期一。您想使用 Android 的 Time 类`android.text.format.Time`来表示日期，但您还想编写一个通用算法这也适用于`java.util.Calendar`.

这就是我所做的。

在 DatetimeMath.java 中：

```
public interface DatetimeMath { 
    public Object createDatetime(int year, int month, int day);

    public int getDayOfWeek(Object datetime);

    public void increment(Object datetime);
} 
```

在 TimeMath.java 中：

```
public class TimeMath implements DatetimeMath {
    @Override
    public Object createDatetime(int year, int month, int day) {
        Time t = new Time();
        t.set(day, month, year);
        t.normalize(false);
        return t;
    }

    @Override
    public int getDayOfWeek(Object o) {
        Time t = (Time)o;
        return t.weekDay;
    }   

    @Override
    public void increment(Object o) {
        Time t = (Time)o;
        t.set(t.monthDay + 1, t.month, t.year);
        t.normalize(false);
    }
} 
```

在 OrdinalDayOfWeekCalculator.java 中，具有通用算法的类：

```
public class OrdinalDayOfWeekCalculator {   
    private DatetimeMath datetimeMath;

    public OrdinalDayOfWeekCalculator(DatetimeMath m) {
        datetimeMath = m;
    }

    public Object getDate(int year, int month, int dayOfWeek, int ordinal) {
        Object datetime = datetimeMath.createDatetime(year, month, 1);
        if (datetimeMath.getDayOfWeek(datetime) == dayOfWeek) {
            return datetime;
        } 
        int xDayCount = 0;
        while (xDayCount != ordinal) {
            datetimeMath.increment(datetime);
            if (datetimeMath.getDayOfWeek(datetime) == dayOfWeek) {
                xDayCount++;
            }
        }
        return datetime;
    }
} 
```

在我的 Android 应用程序中，我会调用类似

```
OrdinalDayOfWeekCalculator odowc = 
        new OrdinalDayOfWeekCalculator(new TimeMath());
Time canadianThanksgiving = (Time)odowc.getDate(
        year, Calendar.OCTOBER, Time.MONDAY, 2); 
```

如果我想重用相同的算法`java.util.Calendar`，我只需编写一个类 CalendarMath 实现 DatetimeMath 中的三个方法，然后使用

```
OrdinalDayOfWeekCalculator odowc2 = 
        new OrdinalDayOfWeekCalculator(new CalendarMath());
Calendar canadianThanksgivingCal = (Calendar)odowc2.getDate(
        year, Calendar.OCTOBER, Calendar.MONDAY, 2); 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-12-16T05:06:26.607

几周前，我添加了一个由我们的一个域对象实现的通用 Java 接口。这个域对象是从数据库中加载的，数据库表示是一个带有大约 10 多个分支的星型模式。拥有如此重量级的域对象的后果之一是，我们不得不制作代表相同模式的其他域对象，尽管重量级较轻。所以我让其他轻量级对象实现了相同的接口。否则我们有：

```
public interface CollectibleElephant { 
    long getId();
    String getName();
    long getTagId();
}

public class Elephant implements CollectibleElephant { ... }
public class BabyElephant implements CollectibleElephant { ... } 
```

最初，我想使用`CollectibleElephant`to sort `Elephant`s。很快，我的队友就`CollectibleElephant`开始运行安全检查，在它们被发送到 GUI 时对其进行过滤，等等。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-01-29T02:06:50.783

我们必须为具有非常复杂的数据库的企业平台创建第三方供应接口。要提供的数据的提交是作为我们的数据类型列表的，这些数据类型被放入我们应用程序的优先级队列中，因此它们可以由于依赖关系而以正确的顺序写入数据库。

写入该数据的过程非常简单，不断弹出优先级队列的顶部，然后根据您提取的对象的类型选择策略。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2021-06-14T10:28:21.190

计算项目 GST 税收总额的示例

```
public interface TaxCalculation {

    public Double calculateTax(Double price);  
} 
```

```
public class FivePercentage implements TaxCalculation {

    @Override
    public Double calculateTax(Double price) {

        Double dbl = (price*5)/100;
        return dbl;
    }

} 
```

```
public class EighteenPercentage implements TaxCalculation {

    @Override
    public Double calculateTax(Double price) {
        Double dbl = (price*18)/100;
        return dbl;
    }

} 
```

```
public class Item {

    public String name;
    public Double price;
    public int taxRate;
    public Double totalTax;

    public Item(String name, Double price, int taxRate) {
        super();
        this.name = name;
        this.price = price;
        this.taxRate = taxRate;
    }
    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }
    public Double getPrice() {
        return price;
    }
    public void setPrice(Double price) {
        this.price = price;
    }
    public int getTaxRate() {
        return taxRate;
    }

    public void setTaxRate(int taxRate) {
        this.taxRate = taxRate;
    }

    public Double getTotalTax() {
        return totalTax;
    }

    public void setTotalTax(Double totalTax) {
        this.totalTax = totalTax;
    }

    public void calculateTax(TaxCalculation taxcalulation, Double price) {
        this.totalTax = taxcalulation.calculateTax(price);
    }

    @Override
    public String toString() {
        return "Items [name=" + name + ", price=" + price + ", taxRate=" + taxRate + ", totalTax=" + totalTax + "]";
    }

} 
```

```
public class CalculateTax {

    public static void main(String[] args) {

        List<Item> itemList = new ArrayList<>();

        Item item1 = new Item("Engine Oil", 320.0, 5);
        Item item2 = new Item("Painting", 3500.00, 18);

        itemList.add(item1);
        itemList.add(item2);

        itemList.stream().forEach(x-> {
            if(x.getTaxRate() == 5) {
                x.calculateTax(new FivePercentage(), x.getPrice());
            } else if(x.getTaxRate() == 18) {
                x.calculateTax(new EighteenPercentage(), x.getPrice());
            }
        });

        itemList.stream().forEach(x-> {
            System.out.println(x.toString());
        });
    }
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-06-16T07:11:22.820

此答案适用于初学者并希望通过最简单的示例来理解这一点 - （参考：Headfirst Design Patterns）

```
#include<iostream>
using namespace std;

/*
    Where it is applicable?
    The selection of an algorithm is required from a family of algorithms.
    To avoid multiple conditional statements for selection of algorithms
    and to hide its algorithm data structures and complexity from client.
*/

class Fly {
public:
    virtual void fly() = 0;
};

//concrete Fly : rocketFly
class rocketFly : public Fly {
public:
    void fly() {
        cout <<"rocketFly::fly()" << endl;
    }
};

//concrete Fly : normalFly
class normalFly : public Fly {
public:
    void fly() {
        cout <<"normalFly::fly()" << endl;
    }
};

//Duck "HAS A" relationship with Fly
class Duck {
private:
    //Duck has a Fly behavour
    Fly* flyObj;
public:
    Duck(Fly* obj) : flyObj(obj) {

    }

    void DuckFly() {
        flyObj->fly();
    }
};

int main() {
    rocketFly* rObj = new rocketFly;
    Duck wildDuck(rObj);
    wildDuck.DuckFly();

    normalFly* nObj = new normalFly;
    Duck cityDuck(nObj);
    cityDuck.DuckFly();

    /*
        I didn't have to create classes like wildDuck which inherits from Duck and they implement their own
        fly, quack etc behaviour. There will be code duplication.
        So, instead of that, create an interface of fly, make concrete fly classes with different
        fly behaviour. Use objects to any of these concrete classes to inject to one generic duck
        class which will automatically call correct fly behaviour.
    */

return 0;
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-07-31T02:37:34.257

例如，想象一个带有 AI 敌人的射击游戏。您希望他们根据发生的情况以不同的方式持续战斗。使用策略模式，您可以不断循环并动态更改特定或动作的执行方式。

```
interface FightingStategy{
    public void fight();
}
public Defense implements FightingStrategy{
    public void figth(){
        ... hide behind wall to shoot
    }
}
public Berserker implements FightingStrategy{
    public void fight(){
        ... run towards you, headrolls and shoots
    }
}
public Dead implements FightingStrategy{
    public void fight(){
        ... is dead, doesn't move
    }
}

public AiShooter{

    FightingStrategy fightingStrategy;

    public AiShooter(){
        fightStrategy = new Berserker();
    }

    public void fight(){
        this.fightingStrategy.fight();
    }

    public void changeStrategy(FightingStrategy f){
        this.fightingStrategy = f;
    }
}

public static void main(){

    ... create list of AiShooters...
    while (condition){
        list.forEach(shooter -> shooter.fight());
    }
    ... you shoot back
    list.ForEach(shooter -> shooter.changeStrategy(new 
Defense()));

    ... you kill one
    list.get(n).changeStrategy(new Dead());
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2018-06-08T05:30:36.727

来自维基百科

> 在计算机编程中，策略模式（也称为策略模式）是一种行为软件设计模式，可以在运行时选择算法。代码不是直接实现单个算法，而是接收运行时指令，以确定使用一系列算法中的哪一个

在 Windows Paint 应用程序中，您可以看到一个策略模式，您可以在其中独立选择不同部分的形状和颜色。这里的形状和颜色是可以在运行时改变的算法。

如果您想用红色绘制一个圆圈，而不是提供“RedCircle”选项，他们让您选择圆圈和您选择的颜色。

```
Shape redCircle = new RedCircle(); // Without stretegy Pattern
Shaped redCircle = new Shape("red","circle"); // With Strategy pattern 
```

没有策略模式将增加具有笛卡尔积的形状和颜色的类的数量。每个实现的接口也会发生变化。

# java - Java GUI Swing 模型说明

> ID：370259
> 
> 赞同：14
> 
> 时间：2008-12-16T01:31:58.537
> 
> 标签：java, swing, user-interface, jframe

我已经使用 Swing 有一段时间了，但是`JFrame`s、`paint()`、`super`等的整个模型/结构在我的脑海中都是模糊的。我需要一个清晰的解释或链接来解释整个 GUI 系统是如何组织的。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-16T01:53:27.167

同样的事情发生在我身上。实际上，直到今天我还没有完全了解它是如何工作的 100%。

Swing 是一个非常灵活的框架——也许太灵活了。灵活性带来了很多抽象，而抽象带来了混乱。:)

我发现以下文章值得一读。他们帮助我更好地理解了 Swing 的大局。

*   [Swing 架构概述](http://www.oracle.com/technetwork/java/architecture-142923.html)
*   [安装 UI 委托的过程](https://web.archive.org/web/20110815102419/http://java.sun.com/products/jfc/tsc/articles/architecture/ui_install/index.html)，也就是这张图：

    [![安装 UI 委托的过程](https://i.stack.imgur.com/mvJiZ.png)](https://web.archive.org/web/20110815102419/http://java.sun.com/products/jfc/tsc/articles/architecture/ui_install/index.html)

他们很好地解释了模型和委托是如何工作的。`JLabel`当我看到那些，，，等时`LabelUI`，它总是让我发疯`ui.update`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-16T01:49:45.583

您看过 Java Swing 教程（单击[此处](http://java.sun.com/docs/books/tutorial/uiswing/)）吗？它很好地涵盖了开发 Swing 应用程序的基础知识。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-16T16:22:20.767

由于这个问题被标记为`JFrame`，我将建议一些链接来了解`JFrame`s 和其他顶级 Swing 容器是如何工作的。

我还发现 Swing 曾经（现在仍然）非常投入，并且每隔一段时间就需要查看 Sun 提供的文档——每次我检查时，我似乎都学到了一些新东西。

首先，基础知识：[`JFrame`](http://java.sun.com/javase/6/docs/api/javax/swing/JFrame.html)来自 Java API 规范的类。Java API 规范通常提供有关类的详细信息。在本例中，您会注意到有几个链接，例如The Java Tutorials 中的[How to Make Frames](http://java.sun.com/docs/books/tutorial/uiswing/components/frame.html)部分。

除此之外，我还建议您查看[课程：使用 Java 教程中的 Swing 组件](http://java.sun.com/docs/books/tutorial/uiswing/components/index.html)。本课程提供了有关如何使用 Swing 中提供的组件的说明以及一些有用的示例。

对于更多细节，当我开始使用 Swing 时，我发现令人困惑的部分是所有不同类型的窗格，例如`ContentPane`、`RootPane`、`GlassPane`。使用[顶级容器](http://java.sun.com/docs/books/tutorial/uiswing/components/toplevel.html)部分提供有关顶级容器的容器层次结构的信息和有用的图表。[如何使用根窗格](http://java.sun.com/docs/books/tutorial/uiswing/components/rootpane.html)部分通过大量示例详细介绍了玻璃、分层和内容窗格。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-21T08:25:27.693

我发现[Swing Explorer](https://swingexplorer.dev.java.net/ "swingexplorer：摇摆资源管理器")是理解组件层次结构（尤其是在复杂的 GUI 中）和查看属性（唉，只读：我们习惯了 Firebug 的便利！）的宝贵工具。它有一个 Eclipse 插件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-16T12:45:21.110

[Chet Haase 和 Romain Guy 的Filthy Rich Clients](http://filthyrichclients.org/)是一本关于 Java UI 的好书。它还涵盖了一些更高级的内容，但介绍和很少的第一章很好地解释了基本的东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-16T15:59:16.897

如果在阅读 Swing 教程后，您发现自己的兴趣在于更高级的主题，您可能还希望查看 Robinson 和 Vorobiev 的[Swing 第二版](http://manning.com/robinson2/)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-16T16:29:07.663

我发现简单地浏览源代码（如果您使用的是 NetBeans，请按住 ctrl 单击名称）非常有帮助。如果我看到一个我不熟悉的方法出现在完成对话框中，我只需单击“转到源代码”并环顾四周，直到我感到满意为止。

# objective-c - 撤消和对象释放

> ID：370265
> 
> 赞同：1
> 
> 时间：2008-12-16T01:35:39.200
> 
> 标签：objective-c, cocoa

新手问题。

我有一个 NSMutableArray ，它包含多个对象（存储贝塞尔路径和相关变量的对象，例如路径颜色等）。只要`-dealloc`调用相关方法，这些对象就会正确释放。每个对象都被实例化`+alloc/-init`并添加到数组中。将它们添加到数组后，我`release`是对象，因此它们的 retainCount=1（由于数组）。因此，当数组被释放时，对象也被正确地处理了`dealloc`。

但是，我还实现了一种撤消/重做机制，可以从 NSMutable 数组中删除/添加这些对象。

我的问题是，当撤消从数组中删除对象时，它们不会被释放（否则重做将不起作用）所以如果从不调用重做，你如何正确释放这些对象？

希望这是有道理的！谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-16T04:11:33.643

您不需要保留对您正在使用的对象的引用。当您将操作添加到撤消堆栈（请参阅 NSUndoManager `registerUndoWithTarget:`）时，它将为您保留参数。例如，如果您在代码中使用 addObject:(id)obj 添加一个对象，您将使用您的 removeObject: 操作和 obj 作为参数向 NSUndoManager 注册它。撤消管理器将保留该对象，直到该操作从撤消堆栈中清除。如果你`dealloc`在你的对象中重写并放入一个 NSLog() 消息，你将确切地看到它是如何工作的。

如果你没有使用 NSUndoManager，开始吧！它使在 OS X 中获得适当的撤消管理变得非常容易，而且非常灵活。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T01:54:18.210

维护一个单独的潜在重做操作列表；将一个项目从活动列表移动到这个。只有在它们“无法访问”时才释放它们（用户执行一些其他使重做列表无效的操作）。然后，您仍然可以引用这些项目，如果它们从未放回“活动”堆栈中，则可以清理它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T06:58:45.490

如果您使用的是 NSUndoManager，那么当您在堆栈上放置新的撤消操作时，重做堆栈将被清除，此时重做堆栈上的任何项目都将被释放。

如果您想更早地清除堆栈，您可以调用`-removeAllActions`，或者`-removeAllActionsWithTarget:`两者都将清除撤消和重做堆栈。

# c# - 从路径字符串或 FileInfo 中获取驱动器号

> ID：370267
> 
> 赞同：38
> 
> 时间：2008-12-16T01:39:14.543
> 
> 标签：c#, file-io

这似乎是一个愚蠢的问题，所以这里是：

除了解析驱动器号的 FileInfo.FullPath 字符串，然后使用 DriveInfo("c") 等查看是否有足够的空间来写入此文件。有没有办法从 FileInfo 获取驱动器号？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2008-12-16T01:54:51.890

```
FileInfo f = new FileInfo(path);    
string drive = Path.GetPathRoot(f.FullName); 
```

这将返回“C:\”。这真的是唯一的另一种方式。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2010-06-18T02:17:04.427

嗯，还有这个：

```
FileInfo file = new FileInfo(path);
DriveInfo drive = new DriveInfo(file.Directory.Root.FullName); 
```

嘿，为什么不是扩展方法呢？

```
public static DriveInfo GetDriveInfo(this FileInfo file)
{
    return new DriveInfo(file.Directory.Root.FullName);
} 
```

然后你可以这样做：

```
DriveInfo drive = new FileInfo(path).GetDriveInfo(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T01:48:16.333

一点字符串解析没有错:-)

```
FullPath.Substring(0,1); 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-04-04T12:01:45.403

您可以使用以下代码获取系统中的所有驱动器：

```
foreach (DriveInfo objDrive in DriveInfo.GetDrives())
    {
        Response.Write("</br>Drive Type : " + objDrive.Name);
        Response.Write("</br>Drive Type : " + objDrive.DriveType.ToString());
        Response.Write("</br>Available Free Space : " + objDrive.AvailableFreeSpace.ToString() + "(bytes)");
        Response.Write("</br>Drive Format : " + objDrive.DriveFormat);
        Response.Write("</br>Total Free Space : " + objDrive.TotalFreeSpace.ToString() + "(bytes)");
        Response.Write("</br>Total Size : " + objDrive.TotalSize.ToString() + "(bytes)");
        Response.Write("</br>Volume Label : " + objDrive.VolumeLabel);
        Response.Write("</br></br>");

    } 
```

# mysql - MySQL中表连接中的“使用”和“打开”有什么区别？

> ID：370268
> 
> 赞同：16
> 
> 时间：2008-12-16T01:39:33.637
> 
> 标签：mysql, sql, join

这是

```
... T1 join T2 using(ID) where T2.VALUE=42 ... 
```

一样

```
... T1 join T2 on(T1.ID=T2.ID) where T2.VALUE=42 ... 
```

适用于所有类型的连接？

我的理解`using(ID)`是它只是`on(T1.ID=T2.ID)`. 这是真的？

现在问另一个问题：

以上是不是和上面一样

```
... T1 join T2 on(T1.ID=T2.ID and T2.VALUE=42) ... 
```

我认为这不是真的，但为什么呢？on 子句中的条件如何与 join 交互，如果它在 where 子句中？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-16T02:29:42.193

我不使用 USING 语法，因为

1.  我的大多数连接都不适合它（不是正在匹配的相同字段名，和/或连接中的多个匹配项）和
2.  在有两个以上表的情况下，它的含义并不是很明显

即假设 3 个具有 'id' 和 'id_2' 列的表，确实

```
T1 JOIN T2 USING(id) JOIN T3 USING(id_2) 
```

变得

```
T1 JOIN T2 ON(T1.id=T2.id) JOIN T3 ON(T1.id_2=T3.id_2 AND T2.id_2=T3.id_2) 
```

或者

```
T1 JOIN T2 ON(T1.id=T2.id) JOIN T3 ON(T2.id_2=T3.id_2) 
```

还是别的什么？

为特定的数据库版本找出这个是一个相当简单的练习，但我没有很大的信心相信它在所有数据库中都是一致的，而且我不是唯一一个必须维护我的代码的人（所以其他人也必须知道它相当于什么）。

WHERE 与 ON 的一个明显区别是连接是否在外部：

假设 T1 有一个 ID 字段，一行包含值 1，而 T2 有一个 ID 和 VALUE 字段（一行，ID=1，VALUE=6），那么我们得到：

```
SELECT T1.ID, T2.ID, T2.VALUE FROM T1 LEFT OUTER JOIN T2 ON(T1.ID=T2.ID) WHERE T2.VALUE=42 
```

不给出任何行，因为 WHERE 需要匹配，而

```
SELECT T1.ID, T2.ID, T2.VALUE FROM T1 LEFT OUTER JOIN T2 ON(T1.ID=T2.ID AND T2.VALUE=42) 
```

将给出一行的值

```
1, NULL, NULL 
```

因为只有在匹配连接时才需要 ON，因为它是外部的，所以它是可选的。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-12-16T02:41:17.287

该`USING`子句是列的等连接的简写，假设列以相同的名称存在于两个表中：

```
A JOIN B USING (column1)

A JOIN B ON A.column1=B.column1 
```

您还可以命名多个列，这使得复合键上的连接非常简单。以下联接应该是等效的：

```
A JOIN B USING (column1, column2)

A JOIN B ON A.column1=B.column1 AND A.column2=B.column2 
```

请注意，`USING (<columnlist>)`必须有括号，`ON <expr>`而不需要有括号（尽管可以在周围使用括号，`<expr>`只是它们可以包含在任何其他上下文中的表达式周围）。

此外，查询中连接的其他表可能没有该名称的列，否则查询不明确，您应该得到错误。

关于您关于附加条件的问题，假设您使用`INNER JOIN`它应该在逻辑上从查询中给出相同的结果，但优化计划可能会受到影响，具体取决于 RDBMS 实现。如果您在联接与子句`OUTER JOIN`中包含条件，也会给出不同的结果。`WHERE`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-02-02T06:39:34.990

结果存在差异，我在其他答案中没有提到。如果你这样做：

```
 JOIN ... ON t1.common = t2.common 
```

那么结果集将有两列名为`common`，特别是`t1.common`和`t2.common`，并且尝试引用不合格的名称`common`将导致查询被拒绝为不明确（即使两列必须包含相同的值）。

另一方面，如果您这样做：

```
 JOIN ... USING (common) 
```

那么结果集将只有一个名为 的列`common`，并且它将是一个非限定名称 - 既不存在`t1.common`也不`t2.common`存在。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-16T01:46:52.420

你的解释似乎是正确的。[这篇文章](http://www.xaprb.com/blog/2006/11/28/how-to-write-sql-join-clauses-more-compactly/)可能会有所帮助。

至于第二个问题，我不明白为什么你的第三个例子的结果应该与前两个不同。“ON”子句中的任何条件与“WHERE”子句中的条件具有相同的含义。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-16T01:47:10.300

我相信您是正确的 - USING(xx) 是连接具有相同名称的两列的简写。

至于第二个问题，这两个查询*可能*相同或可能不同，具体取决于特定于数据库的查询计划器实现。要自己找出答案（至少在 postgres 中），请执行 EXPLAIN SELECT ... 以查看查询计划将如何执行。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-16T01:48:37.143

如果只有一个连接，则没有区别。

using 子句的缺点是两个表必须具有相同的列名。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-20T17:44:29.257

你在这里得到了答案，我不需要添加它。一旦我对此进行了性能测试，并且始终使用并且始终比 ON 运行得更快。是的，我说的是 10 到 20 毫秒 :) 我说的是 MySQL

# batch-file - 在 Windows 上渲染多个 POV-Ray 场景

> ID：370273
> 
> 赞同：1
> 
> 时间：2008-12-16T01:45:51.737
> 
> 标签：batch-file, povray

我有一大堆来自分子动力学模拟的 POV-RAY 文件，通用名称为“frameXX.pov”，其中“XX”是帧数。我想渲染它们，但我有 500 个，所以我真的不想手工完成。我确定有一种方法可以从命令行或批处理文件中执行此操作……最好的方法是什么？谢谢您的帮助 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T19:01:43.190

由于您的问题已经 2 个月大，我想您的问题现在将得到解决。但我想为其他对此事感兴趣的 SOers 解释一下。

您可以在参数化循环中多次运行 POV-Ray 脚本。描述循环参数的典型方法是编写 .ini 文件。

```
Input_File_Name=somegreatscene.pov

; these are the default values
Initial_Clock=0.000
Final_CLock=1.000

; usually you'll start with Frame 0...
Initial_Frame=50
Final_Frame=100

Height=640
Width=480 
```

您可以在脚本中使用的两个参数是**clock_**和**frame_number**。默认情况下，clock_ 是一个浮点值，从第一帧的 0 到最后一帧的 1 变化。clock_ 步长由要渲染的帧数决定，在上面的例子中，第一帧将使用 0 的时钟值进行渲染，下一帧使用 0.02，然后是 0.04，依此类推。或者，您可以使用 frame_number，它是一个整数计数器，在这种情况下，第一帧为 50，最后一帧为 100。

默认情况下，POV-Ray 3.7 将使用所有可用的 CPU 内核进行渲染，但 3.6 版仅在单个内核上运行。但是，您可以同时运行多个 POV-Ray 实例，并通过将以下行添加到 .ini 文件让每个实例渲染所有帧的一部分：

```
; render the first half of frames 50 to 100
Subset_Start_Frame=50
Subset_End_Frame=75 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-16T01:47:45.057

它显然直接支持：

[http://news.povray.org/povray.animations/message/%3C47324428%40news.povray.org%3E/#%3C47324428%40news.povray.org%3E](http://news.povray.org/povray.animations/message/%3C47324428%40news.povray.org%3E/#%3C47324428%40news.povray.org%3E)

# c++ - 为什么我不能在一个类中有一个非整数静态 const 成员？

> ID：370283
> 
> 赞同：74
> 
> 时间：2008-12-16T01:53:06.153
> 
> 标签：c++

我注意到 C++ 不会编译以下内容：

```
class No_Good {
  static double const d = 1.0;
}; 
```

然而，它会很高兴地允许将双精度更改为 int、unsigned 或任何整数类型的变体：

```
class Happy_Times {
  static unsigned const u = 1;
}; 
```

我的解决方案是将其更改为：

```
class Now_Good {
  static double d() { return 1.0; }
}; 
```

并认为编译器将足够聪明，可以在必要时内联……但这让我很好奇。

为什么 C++ 设计者允许我静态 const 一个 int 或 unsigned，而不是一个 double？

编辑：我在 Windows XP 上使用 Visual Studio 7.1 (.net 2003)。

编辑2：

问题已得到解答，但为了完成，我看到的错误是：

```
error C2864: 'd' : only const static integral data members can be initialized inside a class or struct 
```

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-12-16T02:22:01.850

问题是对于整数，编译器*通常*不必为常量创建内存地址。它在运行时不存在，每次使用它都会内联到周围的代码中。它仍然可以决定给它一个内存位置 - 如果它的地址曾经被占用（或者如果它通过 const 引用传递给一个函数），它必须这样做。为了给它一个地址，它需要在一些翻译单元中定义。在这种情况下，您需要将声明与定义分开，否则它将在多个翻译单元中定义。

使用没有优化 ( `-O0`) 的 g++，它会自动内联常量整数变量，但不是常量双精度值。在更高的优化级别（例如`-O1`），它内联常量双精度数。因此，以下代码编译在`-O1`但不是在`-O0`：

```
// File a.h
class X
{
 public:
  static const double d = 1.0;
};

void foo(void);

// File a.cc
#include <stdio.h>

#include "a.h"

int main(void)
{
  foo();
  printf("%g\n", X::d);

  return 0;
}

// File b.cc
#include <stdio.h>

#include "a.h"

void foo(void)
{
  printf("foo: %g\n", X::d);
} 
```

命令行：

```
g++ a.cc b.cc -O0 -o a   # Linker error: ld: undefined symbols: X::d
g++ a.cc b.cc -O1 -o a   # Succeeds 
```

为了获得最大的可移植性，您应该在头文件中声明常量并在某个源文件中定义一次。没有优化，这不会影响性能，因为你没有优化，但是启用优化，这可能会影响性能，因为编译器不能再将这些常量内联到其他源文件中，除非你启用“整个程序优化” .

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-12-16T02:45:33.240

我认为没有技术原因

```
struct type {
    static const double value = 3.14;
}; 
```

禁止。您发现它工作的任何场合都是由于不可移植的实现定义的功能。它们似乎也只有有限的用途。对于在类定义中初始化的整型常量，您可以使用它们并将它们作为非类型参数传递给模板，并将它们用作数组维度的大小。但是你不能对浮点常量这样做。允许浮点模板参数会带来自己的一套规则，并不值得麻烦。

尽管如此，下一个 C++ 版本将允许使用`constexpr`：

```
struct type {
    static constexpr double value = 3.14;
    static constexpr double value_as_function() { return 3.14; }
}; 
```

并且会做`type::value`一个常量表达式。同时，您最好的选择是遵循也使用的模式`std::numeric_limits`：

```
struct type {
    static double value() { return 3.14; }
}; 
```

它不会返回一个常量表达式（值在编译时未知），但这只是理论上的问题，因为实际值无论如何都会被内联。请参阅[constexpr](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2235.pdf)提案。它包含

> 4.4
> 
> `Floating-point constant expressions`
> 
> 传统上，在编译时对浮点常量表达式求值是一个棘手的问题。为了统一性和通用性，我们建议允许浮点类型的常量表达式数据，用任何浮点常量表达式初始化。这也将增加与 C99 [ISO99, §6.6] 的兼容性，它允许
> 
> [#5] 在多个上下文中都需要计算结果为常量的表达式。如果在翻译环境中计算一个浮动表达式，则算术精度和范围应至少与在执行环境中计算该表达式一样大。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-16T04:07:37.333

它并没有真正给出理由，但这是 Stroustrup 在“C++ 编程语言第三版”中对此的看法：

> 10.4.6.2 成员常量
> 
> 也可以通过将*常量表达式* 初始化器添加到其成员声明来初始化静态整型常量成员。例如：
> 
> ```
> class Curious {
>     static const int c1 = 7;        // ok, but remember definition
>     static int c2 = 11;             // error: not const
>     const int c3 = 13;              // error: not static
>     static const int c4 = f(17);    // error: in-class initializer not constant
>     static const float c5 = 7.0;    // error: in-class not integral
>     // ...
> }; 
> ```
> 
> 但是，一个已初始化的成员仍然必须（唯一地）在某处定义，并且不能重复初始化器：
> 
> ```
> const int Curious::c1;  // necessary, but don't repeat initializer here 
> ```
> 
> 我认为这是一个错误。当您需要在类声明中使用符号常量时，请使用枚举器（4.8、14.4.6、15.3）。例如：
> 
> ```
> class X {
>     enum { c1 = 7, c2 = 11, c3 = 13, c4 = 17 };
>     // ...
> }; 
> ```
> 
> 这样一来，其他地方就不需要成员定义了，而且你也不想声明变量、浮点数等。

在第 C.5 节（常量表达式）的附录 C（技术）中，Stroustrup 对“常量表达式”有这样的说法：

> 在诸如数组边界 (5.2)、案例标签 (6.3.2) 和枚举数初始化器 (4.8) 等地方，C++ 需要一个 *常量表达式*。常量表达式的计算结果为整数或枚举常量。这样的表达式由文字（4.3.1、4.4.1、4.5.1）、枚举数（4.8）和由常量表达式初始化的*const组成。*在模板中，也可以使用整数模板参数（C.13.3）。浮动文字 (4.5.1) 只有在显式转换为整数类型时才能使用。函数、类对象、指针和引用只能用作*sizeof* 运算符 (6.2) 的操作数。
> 
> 直观地说，常量表达式是可以在程序链接（9.1）并开始运行之前由编译器评估的简单表达式。

请注意，他几乎没有考虑浮点，因为它能够在“常量表达式”中播放。我怀疑浮点被排除在这些类型的常量表达式之外仅仅是因为它们不够“简单”。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-16T01:59:21.600

我不知道为什么它会处理与 int 不同的 double。我以为我以前用过那个表格。这是另一种解决方法：

```
class Now_Better
{
    static double const d;
}; 
```

在您的 .cpp 文件中：

```
double const Now_Better::d = 1.0; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-10T02:10:11.373

这是我基于 Stroustrup 关于课堂定义的陈述的理解

> 一个类通常在头文件中声明，并且头文件通常包含在许多翻译单元中。但是，为了避免复杂的链接器规则，C++ 要求每个对象都有唯一的定义。如果 C++ 允许对需要作为对象存储在内存中的实体进行类内定义，则该规则将被打破。

[http://www.stroustrup.com/bs_faq2.html#in-class](http://www.stroustrup.com/bs_faq2.html#in-class)

所以基本上，这是不允许的，因为 C++ 不允许这样做。为了使链接器规则更简单，C++ 要求每个对象都有一个唯一的定义。

静态成员在类范围内只有一个实例，不像在 C 中大量使用的常规静态变量，在一个翻译单元内只有一个实例。

如果类中定义了静态成员，并且类定义将包含在许多翻译单元中，那么链接器必须做更多的工作来通过所有相关的翻译单元来决定应该使用哪个静态成员作为唯一的一个。

但是对于常规的静态变量，它们只能在一个翻译单元内部使用，即使不同的静态变量在不同的翻译单元同名，也不会相互影响。链接器可以做简单的工作来链接一个翻译单元内的常规静态变量。

为了减少复杂性并提供基本功能，C++ 为整数或枚举类型的静态 const 提供了唯一的类内定义。

# c# - C# 接口（不同项目/程序集中的调用方法）

> ID：370286
> 
> 赞同：1
> 
> 时间：2008-12-16T01:54:29.240
> 
> 标签：c#, interface, polymorphism

下面的代码几乎总结了我想要实现的目标。

我们有一个包含许多不同项目的解决方案，但是我们需要能够从未引用的项目中调用项目中的方法（会导致循环引用）。

我已经发布了以前的问题，下面的代码几乎就是我使用接口提出的。我仍然不知道如何调用驻留在未引用的不同项目中的方法。

我无法创建接口的实例，它必须是一个类。但是如何创建未引用的类的实例。我不想为此使用反射。

代码是 C# 2.0

任何帮助表示赞赏。

我需要在“GeneralMethod”（Class Raise）中放置什么代码才能在“Listen”类中执行“Update”方法？

```
// Link Project
namespace Stack.Link
{
    public class Interface
    {
        public interface Update
        {
            void Update();
        }
    }
}

// Project A
// References Link only
namespace Stack.ProjA
{
    public class Raise
    {
        public void GeneralMethod()
        {
            // I want to place code in here to be able to execute 
            // "Update" method in ProjB.
            // Keep in mind that ProjA and ProjB only reference
            // Link Project            
        }
    }
}

// Project B
// References Link only
namespace Stack.ProjB
{
    public class Listen : Stack.Link.Interface.Update
    {
        public void Update()
        {
            // Do something here that is executed from ProjA
            Console.Write("Executed Method in ProjB");
        }
    }
} 
```

我可能应该澄清需要这样做的动机。也许有更好的方法......

我们有一个baseform，所有其他项目都可以从中引用。作为示例，我们在加载项目时（从基础表单）将包含各种设置的对象传递给项目。

例如，如果设置对象有一些变量更改（设置对象填充在 baseform 中），我们希望加载的项目侦听此更改并获取新的设置对象。

因为 baseform 引用了所有其他项目，我们需要让项目“监听”baseform 中的事件。

清如泥:-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-16T18:33:54.387

我曾经`Activator.CreateInstance`这样做过。您从路径加载程序集，然后创建该类的实例。例如，您可以使用它在主机应用程序中加载小工具程序集，其中主机在编译时不知道小工具。

示例伪代码（无错误处理）

为要加载的类创建一个接口：

```
public interface IRemote
{
     void Update();
} 
```

然后你需要一个方法来加载程序集并调用函数

现在这是一种使用所有这些的方法：

```
private void
   DoRemoteUpdate( string assemblyPath, string className )
{ 
   Assembly assembly   = Assembly.Load(assemblyPath); 
   Type     objectType = assembly.GetType(className); 

   remoteAssembly = (IRemote)Activator.CreateInstance(objectType); 
   remoteAssembly.Update(); 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T02:07:07.607

您需要 Link 项目来提供一种注册和构建接口具体实现的方法。然后 ProjA 将注册一个实现，ProjB 可以请求它。

在汇编链接中：

```
public interface IThing { void Update(); }

public static class ThingRegistry {
  public static void RegisterThing<T>() where T : IThing { ... }

  public static T CreateThing<T>() where T : IThing { ... }
} 
```

在装配 ProjA 中：

```
internal class Thing : IThing { public void Update() { ... } } 
```

在组装 ProjB 中：

```
public class Listen { 
  public void UpdateThing() {
    ThingRegistry.CreateThing<IThing>().Update();
  }
} 
```

然后你提供某种配置，确保 ProjA 在 ProjB 请求它之前注册它的实现。

一种更简单的方法是使用依赖注入框架来为你管理这些东西，或者将你的项目重新排列成没有循环依赖的层。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T03:29:17.130

我可能应该澄清需要这样做的动机。也许有更好的方法......

我们有一个baseform，所有其他项目都可以从中引用。作为示例，我们在加载项目时（从基础表单）将包含各种设置的对象传递给项目。

例如，如果设置对象有一些变量更改（设置对象填充在 baseform 中），我们希望加载的项目侦听此更改并获取新的设置对象。

因为 baseform 引用了所有其他项目，我们需要让项目“监听”baseform 中的事件。

清如泥。:-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-16T03:49:05.373

另一种选择是定义一个发布者订阅者模型。所以在你的链接项目（所有项目引用的项目）中，你可以有类似的东西（这是伪代码，所以不会自行编译，但会让你接近：

```
public class EventBroadcaster {
   //use your singleton pattern of choice. This is not what I would reocmmend but its short
   private static EventBroadcaster Instance=new EventBroadcaster;

   public void RegisterForEvent(string key,Delegate del)
   {
    //Store the delegate in a dictionary<string,del>
   //You can also use multicast delegates so if your settings object changes notify all people who need it
    }

   public void FireEvent(string key,EventArgs e)
   {
   //Get the item and execute it. 
   }
} 
```

现在你可以为你的委托定义你自己的签名，这样你就可以在你自己的自定义事件参数类中传递你想要的任何状态。当每个听众醒来时，让他们注册他们的事件......您还应该实施取消注册。

好消息是您可以让应用程序的任何部分与任何其他部分进行通信，而无需它们完全耦合。

# 已编辑

这是一篇与我们使用的类似的文章他之前有一篇更好的文章，但我找不到它：http: [//www.codeproject.com/KB/cs/eventpool.aspx](http://www.codeproject.com/KB/cs/eventpool.aspx)

这是将泛型纳入账户的后续行动：http: [//www.codeproject.com/KB/cs/EventPool_Revisited.aspx](http://www.codeproject.com/KB/cs/EventPool_Revisited.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-16T16:54:34.383

**简单的解决方案：**

项目 A 中的“Raise”类引用项目链接。所以它可以直接在定义的对象上调用方法。

项目链接中的某些内容将被 Raise 类调用。然后它需要引发一个事件。

“Listen”类可以监听该事件并做出反应。

# c# - LINQ GroupJoin innerKeySelector/outerKeySelector 问题与两个数据表

> ID：370288
> 
> 赞同：2
> 
> 时间：2008-12-16T01:56:09.580
> 
> 标签：c#, linq, linq-to-objects

给定一个 DataSet，我将把 DataTables[1-n] 加入 DataTable[0]。我创建了一个带有签名的方法，如下所示：

```
public DataTable LeftJoin(DataSet ds, params JoinKey[] JoinKey) 
```

笔记：

*   返回类型是 DataTable，它是生成的左连接。
*   DataSet ds 是用于连接的 DataTables 的集合。
*   JoinKey 是一个具有两个公共属性的对象：Type DataType 和 string Name。此集合包含要在联接中使用的每个字段的类型/名称。

以下是两个片段（**片段 1**和**片段 2**）片段 1 正常工作。唯一的问题是 GroupJoin 的第二个和第三个参数是硬编码的：

```
// hard-coded:
br => new                                  
{                                   
  zip = br.Field<string>("ZipCode"),                                   
  store =br.Field<double>"StoreID")
},                                 
jr => new                                 
{                                   
  zip = jr.Field<string>("ZipCode"),                                   
  store = jr.Field<double>("StoreID")                                 
} 
```

以上是不可取的。相反，我想使用我的“JoinKey”对象来动态设置我想要加入的字段（即 ZipCode 和 StoreID）。我在**Snippet 2中***尝试*过这个。但是，首先，请参阅片段 1。

 ****片段 1（工作，硬编码）**：

```
var dtBase = ds.Tables[0].AsEnumerable();  
for (int i = 1; i < ds.Tables.Count; i++)
{  
    var query = dtBase.GroupJoin(ds.Tables[i].AsEnumerable(),
                                 br => new 
                                 {
                                   zip = br.Field<string>("ZipCode"),
                                   store = br.Field<double>("StoreID")
                                 },
                                 jr => new
                                 {
                                   zip = jr.Field<string>("ZipCode"),
                                   store = jr.Field<double>("StoreID")
                                 },
                                 (baseRow, joinRow) => joinRow.DefaultIfEmpty()
                                     .Select(row => new
                                     {
                                         flatRow = baseRow.ItemArray.Concat((row == null) ? new object[ds.Tables[i].Columns.Count] : row.ItemArray).ToArray()
                                     })
                       ).SelectMany(s => s);  

   [... create a DataTable with the resulting left join, etc. ...]  
} 
```

注意：变量“flatRow”存储左连接数据的对象数组；稍后在方法中将其添加到 DataRowCollection（未显示）。

**片段 2（不工作；但是没有抛出错误）**：

```
var dtBase = ds.Tables[0].AsEnumerable();  
for (int i = 1; i < ds.Tables.Count; i++)
{  
    var query = dtBase.GroupJoin(ds.Tables[i].AsEnumerable(),
                                 or => KeySelector(or, JoinKey),  
                                 ir => KeySelector(ir, JoinKey),
                                 (baseRow, joinRows) => joinRows.DefaultIfEmpty()
                                     .Select(joinRow => new
                                     {
                                         flatRow = baseRow.ItemArray.Concat((joinRow == null) ? new object[ds.Tables[i].Columns.Count] : joinRow.ItemArray).ToArray()
                                     })
                                 )
                       .SelectMany(s => s);

    [... create a DataTable with the resulting left join, etc. ...]  
} 
```

这是上面使用的**KeySelector**函数（请参阅内联注释）：

```
private IEnumerable KeySelector(DataRow dr, params JoinKey[] JoinKey)
{
  List<object> gl = new List<object>();
  foreach (JoinKey jk in JoinKey)
  {
    // note that I did try to mimic the 'hard-coded' approach from Snippet 1:
    // this does not work:
    // gl.Add(dr.Field<jk.DataType>(jk.Name)); --> it does not like <jk.DataType>

    // I 'hacked' around it by using the following:

    gl.Add(dr[dr.Table.Columns.IndexOf(jk.Name)]);
  }
  return gl;
} 
```

**片段 2**仅返回来自 DataTable[0] 的数据。DataTable[1-n] 中的所有数据（如果存在）都没有连接到变量“flatRow”中。不过，有趣的是，我确实得到了数组中正确数量的元素。我知道这与 KeySelector 方法有关，但是（显然）我不知道问题是什么。

如果有人需要更多信息，请告诉我。非常感谢您的帮助...

谢谢，
泰勒

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-16T05:08:14.667

立即发生的一件事是`double`在键中使用 a 是自找麻烦。浮点数的相等比较是出了名的不稳定。不过，我还在寻找。

我认为这里的主要问题是基于内容的列表根本没有自动相等；您正在返回不同的列表（来自`KeySelector`），因此它们永远不会彼此相等。您也许可以提供自定义比较器...

这很混乱，但得到*了一些*回报：

```
 class SetComparer : IEqualityComparer<IEnumerable>
    {

        public readonly static SetComparer Default = new SetComparer();

        public bool Equals(IEnumerable x, IEnumerable y)
        {
            return Enumerable.SequenceEqual(x.Cast<object>(), y.Cast<object>());
        }

        public int GetHashCode(IEnumerable data)
        {
            int hash = 0;
            foreach (object obj in data)
            {
                if (obj != null)
                {
                    hash = hash * 7 + 13 * obj.GetHashCode();
                }
            }
            return hash;
        }
    } 
```

`SetComparer.Default`并作为最终（可选）参数传入`GroupJoin`.

**更新**：发现了我的错误——我很烦`GetHashCode()`；固定的。

您也可以通过在运行时构建一个表达式用作比较器（并且只返回行本身作为键）来做类似的事情，但这更复杂。

# c# - 没有 XmlInclude 的序列化

> ID：370291
> 
> 赞同：12
> 
> 时间：2008-12-16T01:57:16.410
> 
> 标签：c#, xml, reflection, serialization

我正在反序列化一个名为`Method`using .NET Serialization 的类。`Method`包含实现的对象列表`IAction`。我最初使用该[`[XmlInclude]`](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlincludeattribute.aspx)属性来指定所有实现`IAction`.

但是现在，我想更改我的程序以将所有 dll 加载到一个目录中，并去掉实现`IAction`. 然后用户可以反序列化包含他们实现的动作的文件`IAction`。

我不再控制实现的类`IAction`，因此我不能使用[`[XmlInclude]`](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlincludeattribute.aspx).

有没有办法在运行时设置这个属性？或者为实现类设置了类似的属性？

```
public class Method
{
    public List<Actions.IAction> Actions = new List<Actions.IAction>();
}

public interface IAction
{
    void DoExecute();
}

public static Type[] LoadActionPlugins(string pluginDirectoryPath)
{
    List<Type> pluginTypes = new List<Type>();

    string[] filesInDirectory = Directory.GetFiles(pluginDirectoryPath, "*.dll", SearchOption.TopDirectoryOnly);
    foreach (string pluginPath in filesInDirectory)
    {
        System.Reflection.Assembly actionPlugin = System.Reflection.Assembly.LoadFrom(pluginPath);
        Type[] assemblyTypes = actionPlugin.GetTypes();
        foreach (Type type in assemblyTypes)
        {
            Type foundInterface = type.GetInterface("IAction");
            if (foundInterface != null)
            {
                pluginTypes.Add(type);
            }
        }
    }

    return pluginTypes.Count == 0 ? null : pluginTypes.ToArray();
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-16T03:32:45.920

XmlSerializer 有一个构造函数，它接受反序列化时将接受的类型数组：

```
public XmlSerializer(
   Type type,
   Type[] extraTypes
); 
```

您应该能够将您的 assemblyTypes 数组作为第二个参数传递。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-16T04:21:32.780

正如 David Norman 所展示的，您可以将类型数组放入 Xml 序列化器中。一个巨大的警告。每次执行此操作时，都会构建和编译一个新的 xml 序列化程序。如果您经常这样做，您将面临巨大的内存泄漏和性能问题。

这是一个巨大的内存和性能消耗，请确保您只执行一次。您可以通过缓存您的 xml 序列化程序来解决此问题：http: [//msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx)

来自 MSDN 的片段：

> 动态生成的程序集 为了提高性能，XML 序列化基础结构动态生成程序集以对指定类型进行序列化和反序列化。基础结构查找并重用这些程序集。此行为仅在使用以下构造函数时发生：
> 
> XmlSerializer..::.XmlSerializer(类型)
> 
> XmlSerializer..::.XmlSerializer（类型，字符串）
> 
> 如果您使用任何其他构造函数，则会生成同一程序集的多个版本并且永远不会卸载，这会导致内存泄漏和性能下降。最简单的解决方案是使用前面提到的两个构造函数之一。否则，您必须将程序集缓存在 Hashtable 中，如下例所示。

# php - 解决魔术引号，还是只是确保它们已关闭？

> ID：370292
> 
> 赞同：7
> 
> 时间：2008-12-16T01:57:32.617
> 
> 标签：php, magic-quotes-gpc

是否值得将我的代码更改为“更便携”并能够处理魔术引号的恐怖，或者我应该确保它始终通过 .htaccess 文件关闭？

```
if (get_magic_quotes_gpc()) {
    $var = stripslashes($_POST['var']);
} else {
    $var = $_POST['var'];
} 
```

相对

```
php_flag magic_quotes_gpc off 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-16T02:53:12.303

不要同时适应这两种情况。两个代码路径 = 两倍的麻烦，而且你很有可能会滑倒并忘记在某个地方处理这两种情况。

我曾经检查魔术引号是打开还是关闭，如果它们打开，请撤消它们的魔法（正如线程中的其他人所建议的那样）。这样做的问题是，您正在更改另一个程序员可能期望的配置环境（无论多么愚蠢）。

这些天来，我编写代码时好像关闭了魔术引号，并且在我的主 include/bootstrap/always-runs 文件中检查魔术引号是打开还是关闭。如果它们打开，我会抛出一个异常，解释为什么这是一件*坏事*，并提供有关如何关闭它们的说明。

这种方法允许您编写单一行为，鼓励其他人使用您的代码正确配置他们的服务器（魔术引号在 PHP 6 中将消失），如果有人**真的**需要魔术引号，他们可以处理您的异常并夺走他们的生命掌握在自己手中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-16T02:48:44.293

我会检查设置使用`get_magic_quotes_gpc()`并做一个很大的嘈杂退出错误。在错误中通知管理员正确的设置。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-16T02:03:05.633

如果可能的话，我会确保它关闭（需要访问 .htaccess 或 apache 配置）。最好完全避免它，而不是剥离它需要更多资源且容易出现错误的行为。

如果禁用它不是一个选项，您的示例代码可能对输入超全局变量（$_GET，$_POST，...）有用，但请确保不要将其应用于来自这些超全局变量以外的源的数据。这种误用[很常见](http://www.logris.org/security/the-curse-of-magic-quotes)。

只需确保在关闭 magic_quotes_gpc() 时有适当的转义机制来保护您免受 SQL 输入（例如 mysql_real_escape_string() 或 PDO 准备语句）。[您可以在此处](http://www.webappsec.org/projects/articles/091007.shtml)阅读有关 SQL 注入预防的更多信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-16T02:56:37.257

更重要的是，php 6 将不再支持它们。因此，为它们编写代码在未来可能会有所帮助。

# open-source - D中是否有任何开源项目？

> ID：370303
> 
> 赞同：4
> 
> 时间：2008-12-16T02:07:47.527
> 
> 标签：open-source, d

我记得大约 2 年前看过 D，它看起来不错，在一些典型的语言基准测试中实际上比 C 更快，而且总体上看起来还不错，但当时我没有找到任何用 D 编写的真正项目，所以我刚来就走了。

现在几年过去了，我想知道是否有任何项目在 D 中完成，希望开源以查看代码并了解其进展情况，还是 D 死了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-16T02:12:29.950

检查[DSource](http://www.dsource.org/projects/)中的项目。

还可以查看[DLinks](http://www.digitalmars.com/d/dlinks.html)页面。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-16T02:15:50.193

在 SourceForge 上，如果您应用过滤器“Require”、“Programming language”、“D”，您将获得 113 次点击，看起来确实如此。

由于我对这个数字火星暴徒知之甚少，所以我一直有点担心在 D 中发展。除了激起一些书呆子的兴趣（以非贬低的方式使用该术语）之外，D 是否还有未来？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-16T04:19:30.380

如果您喜欢游戏，请查看[ABA Games 的 Kento Cho](http://www.asahi-net.or.jp/~cs8k-cyu/index_e.html)（Windows 下的任何东西）。他的 Windows 游戏是用 D 编写的，并用[SDL](http://www.libsdl.org/)演示了D。

他的代码非常非常好读。强烈推荐。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-16T16:48:55.907

另请查看[code.google.com](http://code.google.com/hosting/search?q=label:d&btn=Search+Projects)以了解更多 D 项目。

# java - Java 获取 JPanel 组件

> ID：370310
> 
> 赞同：18
> 
> 时间：2008-12-16T02:21:39.137
> 
> 标签：java, swing, jframe, jpanel, jcomponent

我有一个充满 JTextFields 的 JPanel ......

```
for (int i=0; i<maxPoints; i++) {
    JTextField textField = new JTextField();
    points.add(textField);
} 
```

我以后如何在该 JPanel 中获取 JTextFields？就像我想要他们的价值观一样

```
TextField.getText(); 
```

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-16T02:30:56.747

Java 中的每个 JPanel 也是一个 AWT 容器。因此，您应该能够使用 getComponents 来获取面板中包含的组件数组，对其进行迭代，检查它们的类型（以确保您没有获得其他控件），并对它们进行任何您需要的操作。

然而，这通常是糟糕的设计。如果您知道您将需要访问特定组件，最好维护这些文本字段的数组并将其传递，即使它们在视觉上包含在容器中。

如果这是一个经常性的任务或者可以从多个点完成，甚至可以有一个特殊的类来表示一个带有文本字段的面板，然后通过它的接口提供访问这些字段的方法。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-16T02:50:50.280

请记住，他们自己并没有到达那里（我想阅读一些关于在运行时动态创建这些面板的问题）

在那张贴的答案中，有人说您应该在数组中保留对这些文本字段的引用。这正是您在这里需要的：

```
List<JTextField> list = new ArrayLists<JTextField>();

// your code...
for (int i=0; i<maxPoints; i++) { 
    JTextField textField = new JTextField();
    points.add(textField);
    list.add( textField ); // keep a reference to those fields.
} 
```

// 之后

```
for( JTextField f : list ) { 
   System.out.println( f.getText() ) ;
} 
```

那不是很容易吗？

请记住将这些类型的工件（列表）尽可能保密。它们仅供您控制，我认为它们不属于界面。

假设您想要获取文本数组，而不是

```
 public List<JTextField> getFields(); 
```

你应该考虑：

```
 public List<String> getTexts(); // get them from the textfields ... 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-10-11T17:32:26.043

这就是我递归遍历容器并获取 JPanel 上的文本字段的方法。

```
private void ClearAllFields(Container myContainer) {

    Component myComps[] = myContainer.getComponents();

    for (int i=0; i<myComps.length; i++) {
      if(myComps[i] instanceof JPanel) {
          JPanel myPanel = (JPanel) myComps[i];
          ClearAllFields(myPanel);
      }
      if(myComps[i] instanceof JTextField) {
        JTextField myTextField = (JTextField) myComps[i];
        myTextField.setText("");
      }
    }        
} 
```

然后使用它，你这样称呼它

```
ClearAllFields([jdialog or jframe etc].getContentPane()); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-11-20T12:12:02.130

您应该调用 getComponents 方法，该方法返回 JPanel 上所有元素的数组。在您可以迭代数组并检查它是否与寻求的组件相等之后。

```
List<JTextField> list = new ArrayLists<JTextField>();
Component[] components = panel.getComponents();

for (Component component : components) {
    if (component.getClass().equals(JTextField.class)) {
        list.add((JTextField)component);
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-13T16:53:44.170

```
 //una forma de recorer todos los elementos dentro de un jpanel
    Component[] components = jPanelX.getComponents();

    for (int i = 0; i < components.length; i++) {

        if(components[i].getClass().getName().toString().equals("javax.swing.JTextField")){
            components[i].setEnabled(false);
        }
    } 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-01-05T11:32:43.190

在创建过程中动态地为其命名，然后执行此操作。

```
 Component[] components = panel.getComponents();
    for (Component component: components) {
        var name = component.getName();  
        if(name != null){    
            if(name.equals("textfield 1")){
                var field = (JTextField)component;
                field.setText("whatever you want / same for options and other components")
            }
        }

    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-06-25T14:08:47.420

您的问题是编写繁琐的代码文本。为什么不直接生成并粘贴到程序中！！...

```
for(int i=1 ; i<=maxpoints ;i++){
   System.out.println("JTextField tf"+i+" = new JTextField()"+";");
   System.out.println("points.add(tf"+i+")"+";");
} 
```

将上述代码的输出粘贴到您的程序中，您就完成了。现在，要访问文本字段的内容，您可以以类似的方式生成繁琐的代码文本......

```
for(int i=1 ; i<=maxpoints ;i++){
   System.out.println("String s"+i+" = JTextField tf"+i+".getText()"+";");
} 
```

# ruby - 如果字符串以该字符开头，则从字符串中删除字符？

> ID：370322
> 
> 赞同：31
> 
> 时间：2008-12-16T02:32:17.820
> 
> 标签：ruby, string

如果该字符串以“1”开头，如何从任何字符串中删除第一个“1”？

```
"1hello world" => "hello world"
"112345" => "12345" 
```

我正在考虑做

```
string.sub!('1', '') if string =~ /^1/ 
```

但我想知道有更好的方法。谢谢！

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-12-16T02:41:01.017

为什么不在`sub!`方法中包含正则表达式？

```
string.sub!(/^1/, '') 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2017-10-27T13:36:41.730

从 Ruby 2.5 开始，您可以使用[delete_prefix](https://ruby-doc.org/core-2.5.1/String.html#method-i-delete_prefix)或 delete_prefix！以可读的方式实现这一点。

在这种情况下`"1hello world".delete_prefix("1")`。

更多信息在这里：

[https://blog.jetbrains.com/ruby/2017/10/10-new-features-in-ruby-2-5/](https://blog.jetbrains.com/ruby/2017/10/10-new-features-in-ruby-2-5/)

[https://bugs.ruby-lang.org/issues/12694](https://bugs.ruby-lang.org/issues/12694)

```
'invisible'.delete_prefix('in') #=> "visible"
'pink'.delete_prefix('in') #=> "pink" 
```

注意，您还可以使用它从带有 delete_suffix 和 delete_suffix 的字符串末尾删除项目！

```
'worked'.delete_suffix('ed') #=> "work"
'medical'.delete_suffix('ed') #=> "medical" 
```

[https://bugs.ruby-lang.org/issues/13665](https://bugs.ruby-lang.org/issues/13665)

我在这里更详细地回答了（带有基准）：[从字符串中删除第一个字符的最简单方法是什么？](https://stackoverflow.com/questions/3614389/what-is-the-easiest-way-to-remove-the-first-character-from-a-string#answer-46958806)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-16T02:42:07.630

如果您要使用正则表达式进行匹配，则不妨将其用于替换

```
string.sub!(%r{^1},"") 
```

顺便说一句，这`%r{}`只是正则表达式的另一种语法。您可以使用 %r 后跟任何字符，例如`%r!^1!`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-16T09:16:07.427

小心使用`sub!(/^1/,'')`！如果字符串不匹配`/^1/`，它将返回`nil`. 您可能应该使用`sub`（没有爆炸声）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-01-21T16:00:39.527

这个答案可能更优化：[从字符串中删除第一个字符的最简单方法是什么？](https://stackoverflow.com/questions/3614389/what-is-the-easiest-way-to-remove-the-first-character-from-a-string)

`string[0] = '' if string[0] == '1'`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-08-28T20:50:43.387

我想对 Zach 的其他出色答案进行微小的改进。`^`匹配Ruby 正则表达式中每一*行*的开头。这意味着每个字符串可以有多个匹配项。Kenji 询问了字符串的开头，这意味着他们必须改用这个正则表达式：

```
string.sub!(/\A1/, '') 
```

比较[this-multiple](http://rubular.com/r/FIaX2yDBA1)与[this-one match](http://rubular.com/r/8Fnzm57AtD)。

# .net - 混淆混合 .NET DLL 的最佳产品

> ID：370325
> 
> 赞同：8
> 
> 时间：2008-12-16T02:33:32.607
> 
> 标签：.net, obfuscation, mixed

我有一个 .NET DLL 和应用程序。DLL 是用 C++/CLI 编写的，它是“混合的”，即部分托管代码和部分本地代码。

我有两个目标：
1\. 混淆所有托管代码，使其无法被反汇编
2\. 混淆混合 DLL 的公共方法/类，以便没有人可以在自己的应用程序中使用 DLL，即打乱公共名称。

是的，我知道混淆并不完美，人们仍然可以弄清楚并等等。这两个目标是管理要求。我发现的唯一可以处理这个问题的应用似乎是 Dotfuscator Professional Edition。不幸的是，它是那些非常烦人的应用程序之一，您必须乞求推销员告诉您价格。有谁知道另一种解决方案，或者知道购买便宜的合法副本的好地方吗？

不要告诉我用托管代码重写 DLL，这需要一个月的工作，而且我永远不会得到批准。:-)

请注意，我对混淆的*效果并不特别偏执。*任何打乱应用程序中所有方法和类的名称的东西都可能足够好。

以下是我尝试过的其他混淆器：

*   Dotfuscator 社区版随 Visual Studio 2008 提供，但不支持混合程序集。

*   Eazfuscator .NET 简单且免费，但不支持混合程序集。

*   {smartassembly} 的单个许可证为 500 美元。它有一些有趣的特性，但不支持混合程序集。

*   蝾螈是800美元。声称完全支持混合程序集，但每当我尝试使用混淆的 dll 时，应用程序就会崩溃

*   .NET Reactor 的单个开发人员许可证价格为 180 美元。它支持混合 DLL 的“部分”混淆。不幸的是，如果你混淆了DLL 上的*公共*类型，它就不起作用，.exe 找不到类。它具有将 DLL 合并/打包到 .exe 中的能力，但是当您使用混合 DLL 执行此操作时，它不起作用（exe 找不到 DLL 的程序集，即使它是 .exe 的一部分）

*   Skater 是 300 美元的单张执照。我在他们的网站上没有看到任何声称它支持混合程序集的东西，而且我厌倦了尝试应用程序却只是感到失望，所以我假设它不支持。

我还尝试过 Microsoft 的 ILMerge，看看我是否可以将 DLL 与 .exe 合并，然后进行混淆，但似乎混合 DLL 也会窒息。

对于 Dotfuscator 的替代品或购买合法副本的好地方有什么建议吗？我发现几个无名网站声称卖得便宜，但我认为那些是俄罗斯盗版版本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-05T01:47:39.497

对于同一个问题，我尝试了几种解决方案。对于这个问题，没有一个很好的解决方案。 [LibZ](https://github.com/MiloszKrajewski/LibZ)是 ILMerge 的不错替代品。只需将程序集打包到程序的资源中，然后从内存中加载所使用的程序集，您可能会变得很可爱。如果您混淆可执行文件，至少这会增加另一个级别的间接性。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-12-16T04:03:04.550

我使用 {smartassembly} 将 SlimDX 和 DirectShow.Net 与我的 .net 程序合并在一起。这两者都是使用 C++/CLI 编写的。他们在我这边融合得很好。您从哪里得知它不支持混合程序集？

编辑：我不是 100% 确定，因为我自己以前从未使用过 C++\CLI，但我以前写过纯 C++ 应用程序。这是我收集的，在 SlimDX 的 AssemblyInfo.cpp 文件中，有一行配置程序集，如：

```
[assembly:SecurityPermission(SecurityAction::RequestMinimum, UnmanagedCode = true)]; 
```

所以，我假设它包含非托管代码。或者，也许您可​​以告诉我应该寻找什么指示来表明它包含非托管代码。

顺便说一句，我正在使用 {smartassembly} 的 3.0.3063 版

# lucene - Lucene 中的多字段搜索

> ID：370328
> 
> 赞同：5
> 
> 时间：2008-12-16T02:37:04.770
> 
> 标签：lucene

我需要使用 Lucene 对 Books 数据库进行多字段级别的搜索。

例如：我的搜索条件类似于：

```
(Author:a1 and title:t1)  OR (Author:a2 and title:t2) OR (Author:a3 and title:t3) 
```

其中`a1`，`t1`等分别是作者姓名和书名。如何获得为这种标准构建的 Lucene Query 对象？

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-18T21:26:28.327

以下代码假定 a1、a2、a3、t1、t2、t3 是术语。如果它们是短语，则需要使用 PhraseQuery 而不是 TermQuery。

```
 // Create a BooleanQuery for (Author:a1 and title:t1)

BooleanQuery a1AndT1 = new BooleanQuery();
a1AndT1.add(new TermQuery(new Term("Author", "a1")), BooleanClause.Occur.MUST);
a1AndT1.add(new TermQuery(new Term("title", "t1")), BooleanClause.Occur.MUST);

// Create a BooleanQuery for (Author:a2 and title:t2)

BooleanQuery a2AndT2 = new BooleanQuery();
a2AndT2.add(new TermQuery(new Term("Author", "a2")), BooleanClause.Occur.MUST);
a2AndT2.add(new TermQuery(new Term("title", "t2")), BooleanClause.Occur.MUST);

// Create a BooleanQuery for (Author:a3 and title:t3)

BooleanQuery a3AndT3 = new BooleanQuery();
a3AndT3.add(new TermQuery(new Term("Author", "a3")), BooleanClause.Occur.MUST);
a3AndT3.add(new TermQuery(new Term("title", "t3")), BooleanClause.Occur.MUST);

// Create a BooleanQuery that combines the OR-clauses

BooleanQuery query = new BooleanQuery();
query.add(a1AndT1, BooleanClause.Occur.SHOULD);
query.add(a2AndT2, BooleanClause.Occur.SHOULD);
query.add(a3AndT3, BooleanClause.Occur.SHOULD);

// As you can see, the resulting Lucene query is 
// (+Author:a1 +title:t1) (+Author:a2 +title:t2) (+Author:a3 +title:t3)
// which behaves the same as something like
// (Author:a1 and title:t1) OR (Author:a2 and title:t2) OR (Author:a3 and title:t3)

System.out.println(query); 
```

# javascript - 覆盖内置 JavaScript 对象的成员

> ID：370333
> 
> 赞同：0
> 
> 时间：2008-12-16T02:41:39.317
> 
> 标签：javascript, client-side

我想覆盖所有 html 元素的 offsetParent 成员的默认行为。如果可能的话，我想做这样的事情：

```
// For <div id="foo"></div>
var oFooElem = document.getElementById("foo");
oFooElem._offsetParent = oFooElem.offsetParent;
oFooElem.prototype.offsetParent = function() {
    window.status = 'offsetParent called.';
    return this._offsetParent;
}; 
```

这甚至可能吗？如果是这样，请发布更正后的代码示例。谢谢！

**更新：**

@some 谢谢你的帮助。听起来这是不可能的。如果您有兴趣，我已经在一个新[问题](https://stackoverflow.com/questions/371468/looking-for-an-elegant-workaround-for-ie-67-unspecified-error-bug-when-accessin)中扩展了引发这个问题的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-16T03:24:14.253

据我所知，这是不可能的。在Firefox中我得到异常“设置只有一个getter的属性”，IE给出错误，Chrome给出错误，但在Opera中它可以工作（如果我将它分配给元素，而不是原型）！

但是你还有另一个问题。offsetParent 不是一个函数，因此它永远不会像函数一样被调用，并且您的警报将永远不会发生。在 Opera（我找到的唯一可以替换它的浏览器）中，您只能恢复该功能。

但是，您可以添加一个新函数（在 Firefox、Chrome 和 Opera 中有效，但在 IE 中无效，因为 IE 没有构造函数属性）：

```
var e = document.getElementById("mydiv"); //Get a div element
//Adds a _offsetParent function to all DIV elements.
e.constructor.prototype._offsetParent=function(){
  alert("offset parent called"); return this.offsetParent;
};
e._offsetParent(); 
```

**更新通过**[在这里](http://weblogs.asp.net/rajbk/archive/2006/11/29/ie-6-7-unspecified-error-when-accessing-offsetparent-javascript.aspx) 阅读您的描述，我看到了您的错误：

1.  你得到一个名为 myInnerContent 的对象的引用
2.  当您替换外部标记的内容时，您从 DOM 中删除该对象。
3.  您尝试从旧对象中获取父对象，该对象是孤儿并且不再位于 DOM 中。IE 给你一个错误，而 Firefox 给你一个空值。

您的页面上已经有了解决方案：保存对象的名称。可选地，您可以选择在更新内容时更新全局变量，或者只更新内部 div 的 innerHTML。

# sql - 在 SQL 或 Django ORM 中，有一个有序的一对多的常规方法是什么？

> ID：370340
> 
> 赞同：7
> 
> 时间：2008-12-16T02:50:06.537
> 
> 标签：sql, django

假设我想要一个项目，并且与待办事项一对多，并且想任意重新排序待办事项？

过去，我添加了一个编号的订单字段，当有人想要更改订单时，必须用他们的新订单号更新所有项目。这可能是最糟糕的方法，因为它不是原子的并且需要多次更新。

我注意到 Django 有一个多值 CommaSeparatedIntegerField，它可以通过将排序键存储到项目表的一个字段中的待办事项表中的项目来包含订单。

我考虑过一个杜威十进制系统，如果我想将第 3 项放在 1 和 2 之间，我会将其订单号更改为 1.5。

有些东西告诉我有一个更简单的选择，但我错过了......

您将如何对一对多关系进行排序？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-17T17:39:41.623

我讨厌这个问题......而且我一直遇到它。

对于我最近的 Django 站点，我们有一个包含 N 篇文章的时事通讯，当然，顺序很重要。我将默认顺序指定为 Article.id 升序，但如果以“正确”顺序以外的顺序输入文章，则会失败。

[在 Newsletter change_form.html 页面上，我使用 Interface 插件 ( http://interface.eyecon.ro/](http://interface.eyecon.ro/) )添加了一点 jQuery 魔法。我显示相关文章的标题，用户可以随意拖动它们。有一个 onChange 处理程序可以重新计算 article_order 字段中的 Article.id。

享受吧，
彼得

对于app=content，model=Newsletter，下面是templates/admin/content/newslettter/change_form.html

```
{% extends 'admin/change_form.html' %}

{% block form_top %}{% endblock %}
{% block extrahead %}{{ block.super }}
<script type="text/javascript" src="/media/js/jquery.js"></script>
<script type="text/javascript" src="/media/js/interface.js"></script>
<script>
$(document).ready(
    function () {
        $('ol.articles').Sortable(
            {
                accept :        'sortableitem',
                helperclass :   'sorthelper',
                activeclass :   'sortableactive',
                hoverclass :    'sortablehover',
                opacity:        0.8,
                fx:             200,
                axis:           'vertically',
                opacity:        0.4,
                revert:         true,
                trim:           'art_',
                onchange:
                    function(list){
                        var arts = list[0].o[list[0].id];
                        var vals = new Array();
                        var a;
                        for (a in arts) {
                            vals[a] = arts[a].replace(/article./, '');
                        }
                        $('#id_article_order').attr('value', vals.join(','));
                    }
            });
    }
);
</script>
{% endblock %}

{% block after_related_objects %}
{% if original.articles %}
<style>
.sortableitem {
    cursor:move;
    width: 300px;
    list-style-type: none;
    }
</style>

<h4>Associated Articles</h4>
<ol class="articles" id="article_list">
{% for art in original.articles %}
    <li id="article.{{art.id}}" class="sortableitem">{{art.title}}</li>

{% endfor %}
</ol>
{% endif %}
{% endblock %} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-18T14:07:35.687

“添加了编号的订单字段” - 好。

“用他们的新订单号更新所有项目” - 可以避免的。

使用有空格的数字。

*   浮点。这样，有人可以在 1 和 2 之间插入“1.1”。我发现这很好用，因为大多数人都可以理解排序的工作原理。而且你不必太担心要留下多少空间——每个数字之间有很多很多的空间。

*   在初始加载时，将文章编号为 100 或 1000 或每篇之间有空格的东西。在这种情况下，您必须猜测要重新排序还有多少位数。

*   逗号分隔的位置。最初都是（1,0）、（2,0）、（3,0）等。但是当你想重新排列东西时，你可能不得不引入（2,1）和（2,2）在 (2,0) 之后但在 (3.0) 之前。

    这看起来有点复杂，但有些人喜欢这种复杂性。它本质上与浮点数相同，除了单个数字被（整数，隐式分数）元组替换。这扩展到处理层次结构。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-17T03:45:42.973

我在最近一段时间从事的两个项目中遇到了这个问题。对于我的示例解决方案，我有一个“表单”，其中分配了许多“变量”，并且表单上变量的顺序需要是可排序的。所以我实现了以下内容：

模型.py

```
class Form(models.Model):
    FormName = models.CharField(verbose_name="Form Name:", max_length=40)
    VariableOrder = models.CommaSeparatedIntegerField(default="[]", editable=False)

    def __unicode__(self):
        return "%s" % (self.FormName)

class Variable(models.Model):
    FormID = models.ForeignKey(Form, default=0, editable=False, related_name="Variable")
    VarName = models.CharField(max_length=32, verbose_name="Name of variable in the database:") 

    def __unicode__(self):
        return "%s" % self.VarName 
```

上面的关键是 VariableOrder CommaSeparatedIntegerField 是我们将在表单上存储变量顺序的地方，我们将把它用作 python 列表，这就是为什么默认为 [] 的原因。

对于模板，我将我的变量呈现在一个我们将使拖放可排序的内容中（我实际使用的列表元素具有更多与 CSS 相关的样式和有关变量的信息）。

```
<ul id="sortable">

{% for Variable in VarList %}
    <li id="{{ Variable.id }}">{{ Variable }}</li>
{% endfor %}

</ul> 
```

现在我们要让列表拖放来改变顺序。**为此，您需要在头部有来自 Django 站点的 AJAX CSRF 片段**

```
 $(function() {
    $("#sortable" ).sortable({
        placeholder: "ui-state-highlight",
        update: function(event, ui){
            $.ajax({
            type:"POST",
            url:"{% url builder.views.variableorder %}",
            data: {Order: JSON.stringify($('#sortable').sortable('toArray')) },
            success: function(data){
            // Do stuff here - I don't do anything.
            }
          });
        }
    });
    $( "#sortable" ).disableSelection();
}); 
```

上面的重要部分是，每当任何变量的位置发生变化时，“update”都会调用该函数，这会发送 AJAX。toArray on sortable 与 JSON stringify 一起让我们发送每个变量的从上到下的 id，视图使用如下。**注意：我将活动的 Form 对象保留为会话变量，但在另一种情况下，您只需要调用您想要更改顺序的 Form 对象。**

```
def variableorder(request):
    if request.is_ajax():
        Order = request.POST['Order']
        updateOrder = request.session['FormID']
        updateOrder.VariableOrder = newOrder
        updateOrder.save()
        request.session['FormID'] = Form.objects.get(id=updateOrder.id)
        return HttpResponse("Order changed.")
    else:
        pass 
```

所有这一切的关键是您可以通过评估字符串来将此 CommaSeparatedIntegerField 用作列表。例如：

**添加变量**：

```
aForm = Form.objects.get(id=1)
currentOrder = aForm.VariableOrder
currentOrder = eval(currentOrder)
newVar = Variable(stuff in here)
newVar.save()
currentOrder.append(newVar.id)
aForm.VariableOrder = currentOrder
aForm.save() 
```

**删除变量**：

```
aForm = Form.objects.get(id=1)
currentOrder = aForm.VariableOrder
currentOrder = eval(currentOrder)
# Variable ID that we want to delete = 3
currentOrder.remove(3)
aForm.VariableOrder = currentOrder
aForm.save() 
```

**按顺序渲染变量**：

```
aForm = Form.objects.get(id=1)
currentOrder = aForm.VariableOrder
currentOrder = eval(currentOrder)
VarList = []
for i in currentOrder:
    VarList.append(Variable.objects.get(id=i)) 
```

这是我将要使用的粗略初稿，但它对我来说效果很好。明显的第一个改进是对 python 列表的评估是类中的一个方法。例如。

```
def getVarOrder(self):
    return eval(self.VariableOrder) 
```

然后在想要操作列表时调用 Form.getVarOrder() 。无论如何，希望这会有所帮助。

京东

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-16T02:58:25.350

我已经多次遇到这种情况，所以我决定在 BL 或 UI 中动态管理这些，然后只要用户满意，就将排序持久化到一个专门构建的列中。SQL 只是故意设计为不处理排序，它总是反击。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-28T21:57:10.793

这是对该问题的较晚答案，但我只是想插话并指出 B-Trees 是这类事情的一个很好的数据结构，特别是如果您的访问模式不需要您检索整个列表一次。

[http://en.wikipedia.org/wiki/B-tree](http://en.wikipedia.org/wiki/B-tree)

# silverlight - 您可以在 Silverlight 中构建整个应用程序吗？

> ID：370346
> 
> 赞同：5
> 
> 时间：2008-12-16T02:55:31.080
> 
> 标签：silverlight, silverlight-2.0

是否可以仅使用 silverlight 作为主机来构建一个良好的中型到全尺寸应用程序？

一些需要的东西： - 动态页面（一个silverlight“屏幕”可以在屏幕之间切换，就像一个普通的应用程序一样。 - 类似于从浏览器启动的java小程序

我看到 Telerik 为 WPF 销售 RadControls ......但这只有在 Silverlight 可以通过 Web 成为富客户端平台时才有用（对我来说）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-16T03:25:53.220

尽管仍然是一个不成熟的平台，Silverlight 2.0 支持许多我期望从创建全尺寸应用程序所需的平台中获得的功能。

*   通过 Web 服务和使用 Linq 的本地数据/对象查询支持进行数据访问
*   许多功能丰富的控件，例如 datagrid、treeview 等
*   CLR（公共语言运行时）的一个非常有用的子集
*   访问客户端计算机上的受限本地存储
*   它是跨平台的
*   已经有一些很棒的附加组件，例如 Telerik 和[Silverlight Control Toolkit](http://www.codeplex.com/Silverlight)

对于您的特定场景，Microsoft 发布了有关[多页应用程序的教程](http://silverlight.net/learn/tutorials/multipageapps_vb.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T21:25:25.240

绝对地。我一直在研究这一点，并相信它在 Silverlight 中与在任何其他语言中一样容易。请记住，Silverlight 2 使用 C# 3.0，因此您可以构建任何未包含在 Silverlight 版本的 CLR 中的内容。此外，Microsoft 允许您访问 .NET 源代码这一事实意味着您可以使用您的应用程序编译 .NET 库的缺失部分。（虽然不知道许可问题。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-18T06:42:00.967

两天前，我看到了一个功能齐全的 CRM 应用程序的演示文稿。虽然它仍然是 alpha：它的外观和感觉就像任何办公应用程序。我不知道细节，但对我来说这是一个概念证明。

# refactoring - 响应、结果、回复，哪个最好？

> ID：370353
> 
> 赞同：2
> 
> 时间：2008-12-16T03:02:30.613
> 
> 标签：refactoring, client-server, terminology

我正在重构一些客户端-服务器代码，它使用术语响应、结果和回复来表示同一件事（来自服务器的答案）。虽然它并不那么重要，但在编写新代码时很难猜测使用哪个词，所以我想将这三个术语统一为一个并进行适当的重构，但我不确定哪个词是“最好”，如果有这样的事情。

有什么基于优先级和标准来命名这个案例的建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-16T03:04:05.620

回复！

服务器响应...
一个人响应...
您得到结果...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-16T03:05:30.110

响应和结果都应该没问题，因为它们可以缩写为“res”。

而回复将是“rep”，这与重复是模棱两可的。

也许只是遵循 HTTP，称它们为请求和响应。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-04-08T19:01:25.560

`Response`. `Result`缺乏作为答案的内涵（例如，我们说的是简单的“函数结果”）。 `Reply`问题是它既是名词又是动词。所以`Response`最清楚。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-17T19:18:40.503

如果您想坚持使用标准 ISO/OSI 术语，则可以是“指示”或“确认”。对于未确认的服务，通信的发起者发出“请求”（请求将数据发送到另一端），该“请求”作为“指示”传递给另一端。对于确认的服务，指示的接收者将回复“响应”，其中将包括要返回到发起方的数据。该数据将作为“确认”提供给另一方。

Confirmation 中包含的数据表明了通信是如何进行的（即，我们发送了一个查询并得到了答案）。这可以称为结果。

# python - 首次使用后重新分配时局部变量上的 UnboundLocalError

> ID：370357
> 
> 赞同：253
> 
> 时间：2008-12-16T03:06:52.557
> 
> 标签：python, variables, scope

以下代码在 Python 2.5 和 3.0 中都按预期工作：

```
a, b, c = (1, 2, 3)

print(a, b, c)

def test():
    print(a)
    print(b)
    print(c)    # (A)
    #c+=1       # (B)
test() 
```

但是，当我取消注释 line **(B)**时，我得到一个`UnboundLocalError: 'c' not assigned`at line **(A)**。`a`和的值`b`打印正确。这让我完全困惑有两个原因：

1.  为什么在**(A)行出现运行时错误，因为****(B)**行后面有一个语句？

2.  为什么变量`a`并按`b`预期打印，而`c`引发错误？

我能想到的唯一解释是**局部**变量`c`是由 assignment 创建的`c+=1`，它甚至在创建局部变量之前就优先于“全局”变量`c`。当然，在变量存在之前“窃取”范围是没有意义的。

有人可以解释这种行为吗？

* * *

## 回答 #1

> 赞同：263
> 
> 时间：2008-12-16T03:12:56.833

Python 以不同的方式处理函数中的变量，具体取决于您是从函数内部还是外部为其赋值。如果在函数中分配了变量，则默认将其视为局部变量。因此，当您取消注释该行时，您试图`c`在分配任何值之前引用局部变量。

如果您希望变量`c`引用`c = 3`函数之前分配的全局，请将

```
global c 
```

作为函数的第一行。

至于python 3，现在有

```
nonlocal c 
```

您可以使用它来引用最近的具有`c`变量的封闭函数范围。

* * *

## 回答 #2

> 赞同：86
> 
> 时间：2008-12-16T03:25:29.883

Python 有点奇怪，因为它将所有内容都保存在字典中，用于各种范围。原始的 a,b,c 在最上面的范围内，因此在最上面的字典中。该函数有自己的字典。当您到达`print(a)`and`print(b)`语句时，字典中没有该名称的任何内容，因此 Python 查找列表并在全局字典中找到它们。

现在我们得到`c+=1`，当然，它等价于`c=c+1`。当 Python 扫描该行时，它会说“啊哈，有一个名为 c 的变量，我会将它放入我的本地范围字典中。” 然后，当它为赋值右侧的 c 寻找 c 的值时，它找到*名为 c 的局部变量*，该变量还没有值，因此抛出错误。

上面提到的语句`global c`只是告诉解析器它使用`c`来自全局范围的 ，因此不需要新的。

它说它确实存在问题的原因是因为它在尝试生成代码之前有效地寻找名称，因此从某种意义上说，它认为它还没有真正做到这一点。我认为这是一个可用性错误，但学习不要*太*认真地对待编译器的消息通常是一个好习惯。

如果有什么安慰的话，在我发现 Guido 写的关于解释一切的字典之前，我可能花了一天时间挖掘和试验同样的问题。

### 更新，见评论：

它不会两次扫描代码，但会分两个阶段扫描代码，词法分析和解析。

考虑一下这行代码的解析是如何工作的。词法分析器读取源文本并将其分解为词位，即语法的“最小组件”。所以当它击中线时

```
c+=1 
```

它把它分解成类似的东西

```
SYMBOL(c) OPERATOR(+=) DIGIT(1) 
```

解析器最终想把它做成解析树并执行它，但由于它是一个赋值，在它执行之前，它会在本地字典中查找名称 c，没有看到它，并将其插入到字典中，标记它未初始化。在完全编译的语言中，它只会进入符号表并等待解析，但由于它没有第二遍的奢侈，词法分析器会做一些额外的工作来让以后的生活更轻松。只有，然后它会看到 OPERATOR，看到规则说“如果你有一个 operator += 左侧必须已经初始化”并说“哎呀！”

这里的重点是它还*没有真正开始解析该行*。这一切都在为实际解析做准备，所以行计数器还没有前进到下一行。因此，当它发出错误信号时，它仍然认为它在前一行。

正如我所说，你可以说这是一个可用性错误，但它实际上是一个相当普遍的事情。一些编译器对此更诚实，并说“在第 XXX 行或附近出现错误”，但这个没有。

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2008-12-16T09:49:28.640

看一下反汇编可能会澄清正在发生的事情：

```
>>> def f():
...    print a
...    print b
...    a = 1

>>> import dis
>>> dis.dis(f)

  2           0 LOAD_FAST                0 (a)
              3 PRINT_ITEM
              4 PRINT_NEWLINE

  3           5 LOAD_GLOBAL              0 (b)
              8 PRINT_ITEM
              9 PRINT_NEWLINE

  4          10 LOAD_CONST               1 (1)
             13 STORE_FAST               0 (a)
             16 LOAD_CONST               0 (None)
             19 RETURN_VALUE 
```

如您所见，访问 a 的字节码是`LOAD_FAST`，而访问 b的字节码是`LOAD_GLOBAL`。这是因为编译器已经识别出在函数内分配了 a，并将其归类为局部变量。局部变量的访问机制与全局变量根本不同——它们在帧的变量表中静态分配了一个偏移量，这意味着查找是一个快速索引，而不是像全局变量那样更昂贵的字典查找。因此，Python 将这`print a`一行读取为“获取插槽 0 中保存的局部变量 'a' 的值并打印它”，当它检测到该变量仍未初始化时，会引发异常。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-12-16T03:12:59.690

当您尝试传统的全局变量语义时，Python 有相当有趣的行为。我不记得细节了，但是您可以读取在“全局”范围内声明的变量的值就好了，但是如果要修改它，则必须使用`global`关键字。尝试更改`test()`为：

```
def test():
    global c
    print(a)
    print(b)
    print(c)    # (A)
    c+=1        # (B) 
```

此外，您收到此错误的原因是您还可以在该函数内声明一个与“全局”同名的新变量，并且它将完全分开。解释器认为你试图在这个范围内创建一个新变量，`c`并在一个操作中修改它，这在 Python 中是不允许的，因为这个新变量没有`c`被初始化。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2014-06-04T10:39:21.343

最清楚的例子是：

```
bar = 42
def foo():
    print bar
    if False:
        bar = 0 
```

调用时，虽然我们永远不会到达 line `foo()`，但这也会**引发** ，因此从逻辑上讲，永远不应该创建局部变量。`UnboundLocalError``bar=0`

奥秘在于“ **Python 是一种解释性语言**”，函数的声明`foo`被解释为单个语句（即复合语句），它只是对其进行愚蠢的解释并创建局部和全局范围。所以`bar`在执行之前在本地范围内被识别。

**更多这样的例子**阅读这篇文章：[http ://blog.amir.rachum.com/blog/2013/07/09/python-common-newbie-mistakes-part-2/](http://blog.amir.rachum.com/blog/2013/07/09/python-common-newbie-mistakes-part-2/)

这篇文章提供了 Python 变量范围的完整描述和分析：

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-11-16T22:12:19.977

这里有两个链接可能会有所帮助

1：[docs.python.org/3.1/faq/programming.html?highlight=nonlocal#why-am-i-getting-an-unboundlocalerror-when-the-variable-has-a-value](http://docs.python.org/3.1/faq/programming.html?highlight=nonlocal#why-am-i-getting-an-unboundlocalerror-when-the-variable-has-a-value)

2：[docs.python.org/3.1/faq/programming.html?highlight=nonlocal#how-do-i-write-a-function-with-output-parameters-call-by-reference](http://docs.python.org/3.1/faq/programming.html?highlight=nonlocal#how-do-i-write-a-function-with-output-parameters-call-by-reference)

链接一描述了错误 UnboundLocalError。链接二可以帮助重写你的测试函数。基于链接二，原来的问题可以改写为：

```
>>> a, b, c = (1, 2, 3)
>>> print (a, b, c)
(1, 2, 3)
>>> def test (a, b, c):
...     print (a)
...     print (b)
...     print (c)
...     c += 1
...     return a, b, c
...
>>> a, b, c = test (a, b, c)
1
2
3
>>> print (a, b ,c)
(1, 2, 4) 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-24T15:13:11.677

这不是您问题的直接答案，但它密切相关，因为它是由增强赋值和函数范围之间的关系引起的另一个问题。

在大多数情况下，您倾向于认为扩充赋值 ( `a += b`) 与简单赋值 ( ) 完全相同`a = a + b`。但是，在一个极端情况下，可能会遇到一些麻烦。让我解释：

Python 的简单赋值的工作方式意味着 if`a`被传递给一个函数（如`func(a)`; 注意 Python 总是通过引用传递），然后`a = a + b`不会修改`a`传入的那个。相反，它只会修改本地指针到`a`.

但是如果你使用`a += b`，那么它有时会被实现为：

```
a = a + b 
```

或者有时（如果该方法存在）为：

```
a.__iadd__(b) 
```

在第一种情况下（只要`a`未声明为全局），在本地范围之外没有副作用，因为分配到`a`只是一个指针更新。

在第二种情况下，`a`将实际修改自身，因此所有对的引用都`a`将指向修改后的版本。下面的代码证明了这一点：

```
def copy_on_write(a):
      a = a + a
def inplace_add(a):
      a += a
a = [1]
copy_on_write(a)
print a # [1]
inplace_add(a)
print a # [1, 1]
b = 1
copy_on_write(b)
print b # [1]
inplace_add(b)
print b # 1 
```

所以诀窍是避免对函数参数进行增强赋值（我尝试只将它用于局部/循环变量）。使用简单的赋值，你就可以避免模棱两可的行为。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-16T08:58:10.193

Python 解释器会将函数作为一个完整单元读取。我认为它分两次读取它，一次是收集它的闭包（局部变量），然后再次将它转换为字节码。

我相信您已经知道，在“=”左侧使用的任何名称都隐含地是一个局部变量。不止一次我被改变了对一个 += 的访问，它突然变成了一个不同的变量。

我还想指出这与全局范围没有任何关系。使用嵌套函数可以获得相同的行为。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-11-03T18:52:39.750

`c+=1`assigns `c`，python 假设分配的变量是本地的，但在这种情况下，它没有在本地声明。

使用`global`or`nonlocal`关键字。

`nonlocal`仅在 python 3 中有效，因此如果您使用的是 python 2 并且不想将变量设为全局变量，则可以使用可变对象：

```
my_variables = { # a mutable object
    'c': 3
}

def test():
    my_variables['c'] +=1

test() 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-12-08T10:09:47.367

访问类变量的最佳方法是直接按类名访问

```
class Employee:
    counter=0

    def __init__(self):
        Employee.counter+=1 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2019-09-19T02:26:31.957

同样的问题困扰着我。使用`nonlocal`和`global`可以解决问题。
但是，需要注意使用`nonlocal`，它适用于嵌套函数。但是，在模块级别，它不起作用。请参阅此处的[示例](https://www.programiz.com/python-programming/global-local-nonlocal-variables#Nonlocal%20Variables)。

# javascript - 将参数传递给 JQuery 函数

> ID：370359
> 
> 赞同：53
> 
> 时间：2008-12-16T03:10:11.067
> 
> 标签：javascript, jquery, html, function, parameters

我正在使用一个包含 Action 列的循环创建 HTML。该列是一个超链接，当用户单击它会调用 JavaScript 函数并传递参数...

例子：

```
<a href="#" OnClick="DoAction(1,'Jose');" > Click </a>
<a href="#" OnClick="DoAction(2,'Juan');" > Click </a>
<a href="#" OnClick="DoAction(3,'Pedro');" > Click </a>
...
<a href="#" OnClick="DoAction(n,'xxx');" > Click </a> 
```

我希望该函数使用正确的参数调用 Ajax jQuery 函数。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2008-12-16T03:31:09.933

使用 POST

```
function DoAction( id, name )
{
    $.ajax({
         type: "POST",
         url: "someurl.php",
         data: "id=" + id + "&name=" + name,
         success: function(msg){
                     alert( "Data Saved: " + msg );
                  }
    });
} 
```

使用 GET

```
function DoAction( id, name )
{
     $.ajax({
          type: "GET",
          url: "someurl.php",
          data: "id=" + id + "&name=" + name,
          success: function(msg){
                     alert( "Data Saved: " + msg );
                   }
     });
} 
```

编辑：

如果未启用 javascript，可能会更好的方法（使用 GET）是为 href 生成 URL，然后使用单击处理程序通过 ajax 调用该 URL。

```
<a href="/someurl.php?id=1&name=Jose" class="ajax-link"> Click </a>
<a href="/someurl.php?id=2&name=Juan" class="ajax-link"> Click </a>
<a href="/someurl.php?id=3&name=Pedro" class="ajax-link"> Click </a>
...
<a href="/someurl.php?id=n&name=xxx" class="ajax-link"> Click </a>

<script type="text/javascript">
$(function() {
   $('.ajax-link').click( function() {
         $.get( $(this).attr('href'), function(msg) {
              alert( "Data Saved: " + msg );
         });
         return false; // don't follow the link!
   });
});
</script> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-05T16:57:42.743

如果你想做一个 ajax 调用或一个简单的 javascript 函数，不要忘记用 return false 关闭你的函数

像这样：

```
function DoAction(id, name) 
{ 
    // your code
    return false;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T23:19:27.617

你想将参数传递给另一个页面还是只传递给函数？

如果只是函数，则不需要添加 $.ajax() tvanfosson 添加。只需添加您的功能内容。像：

```
function DoAction (id, name ) {
    // ...
    // do anything you want here
    alert ("id: "+id+" - name: "+name);
    //...
} 
```

这将返回一个带有 id 和 name 值的警报框。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-17T22:37:11.980

尝试这样的事情

`#vote_links a`将捕获投票链接 div id 中的所有 id ...

```
<script type="text/javascript">

  jQuery(document).ready(function() {
  jQuery(\'#vote_links a\').click(function() {// alert(\'vote clicked\');
    var det = jQuery(this).get(0).id.split("-");// alert(jQuery(this).get(0).id);
    var votes_id = det[0];

   $("#about-button").css({
    opacity: 0.3
   });
   $("#contact-button").css({
    opacity: 0.3
   });

   $("#page-wrap div.button").click(function(){ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-12-18T10:41:27.010

```
<script type="text/javascript" src="jquery.js">
</script>

 <script type="text/javascript">

  function omtCallFromAjax(urlVariable)
{ 
    alert("omt:"+urlVariable);
     $("#omtDiv").load("omtt.php?"+urlVariable);
}

 </script> 
```

试试这个它对我有用

# c++ - 为什么在比较中将常量放在变量之前？

> ID：370366
> 
> 赞同：28
> 
> 时间：2008-12-16T03:14:22.510
> 
> 标签：c++, c, syntax, comparison

一段时间以来，我注意到我们的一些代码中有以下语法：

```
if( NULL == var){
   //...
} 
```

或者

```
if( 0 == var){
  //...
} 
```

和类似的事情。

有人可以解释一下为什么写这篇文章的人选择这种表示法而不是常用的`var == 0`方式）？

是风格问题，还是以某种方式影响性能？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-12-16T03:20:31.983

这是一种避免此类错误的机制：

```
if ( var = NULL ) {
  // ...
} 
```

如果你用右侧的变量名编写它，编译器将能够捕捉到某些错误：

```
if ( NULL = var ) {  // not legal, won't compile
  // ...
} 
```

当然，如果变量名出现在等号的两边并且有些人觉得这种风格没有吸引力，这将不起作用。

**编辑：**

正如 Evan 在评论中提到的那样，如果您启用警告，任何体面的编译器都会警告您，例如，`gcc -Wall`会给您以下信息：

```
warning: suggest parentheses around assignment used as truth value 
```

您应该始终在编译器上启用警告，这是查找错误的最便宜的方法。

最后，正如 Mike B 所指出的，这是风格问题，不会影响程序的性能。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-16T03:26:23.220

如果你错误地放

```
if ( var = NULL ) 
```

代替

```
if ( var == NULL ) 
```

那么只会有一个编译器警告。如果您颠倒顺序：

```
if ( NULL == var ) 
```

那么如果你放，就会出现编译器错误

```
if ( NULL = var ) 
```

就个人而言，我讨厌阅读以这种方式编写的代码，而且我在编码的第一年只犯过一次这个错误。=)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-16T03:17:57.200

为了避免

```
if (var = NULL) 
```

漏洞

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-16T05:20:00.243

**推论：**尽可能多地使用`const`。

```
const int val = 42;

if (val = 43) {
    ...
} 
```

不会编译。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-16T03:25:30.427

引用 Joel On Software，[游击队面试指南](http://www.joelonsoftware.com/articles/fog0000000073.html)：

> 偶尔，您会看到 C 程序员编写类似 if (0==strlen(x)) 的内容，将常量放在 == 的左侧。这真是一个好兆头。这意味着他们因混淆 = 和 == 而被刺痛了太多次，并强迫自己学习一个新习惯以避免那个陷阱。

（我不太喜欢这种“最佳实践”。）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-16T03:29:05.973

顺便说一句，多年来我观察到向新程序员教授 C 语言，如果你训练自己将“=”读为“gets”，将“==”读为等于，这本身就可以让你免于许多这样的问题错误。然后你读

```
if( x = 0){ 
```

就像“如果 x 得到 0 那么”，这听起来很奇怪。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-16T05:11:23.677

就个人而言，我更喜欢

`if (!x) {`

# c# - 如何仅将签名程序集加载到新的 AppDomain？

> ID：370367
> 
> 赞同：0
> 
> 时间：2008-12-16T03:14:52.133
> 
> 标签：c#, assemblies, appdomain, strongname, signed

我正在做一个插件系统，其中主应用程序在新 AppDomain 的运行时加载程序集 Addin1.dll 和 Addin2.dll。

但是，如果 Addin1.dll 使用我的密钥签名（强名称）而 Addin2.dll 没有，我希望能够只加载 Addin1.dll 并拒绝 Addin2.dll。

我怀疑需要通过在 AppDomainSetup 中设置一些参数来完成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-16T03:41:59.210

查看采用 Evidence 参数的[Assembly.Load方法。](http://msdn.microsoft.com/en-us/library/ms145229.aspx "Assembly.Load 方法（AssemblyName、Evidence）")[您可以在此处](http://msdn.microsoft.com/en-us/library/system.security.policy.evidence.aspx "证据等级")找到如何从您的公钥创建证据的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T06:34:31.583

您可以实现一个 DomainManager 并根据您喜欢的任何内容来决定您的加载/阻止决策。我在这里回答了一个有点相关的问题[。](https://stackoverflow.com/questions/439173/message-pumps-and-appdomains/924653#924653)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-12-26T17:49:39.930

您可以使用[AppDomain 类](http://msdn.microsoft.com/en-us/library/36az8x58.aspx)的 Load 方法将新程序集加载到 Appdomain 中，前提是客户端或最终用户环境满足程序集的发布者策略。

此外，强命名程序集遵循程序集发布者和 CLR 制定的所有规则。所以程序集的用户需要满足被加载到应用程序域的程序集的安全性。

CLR 使用强名称属性从 GAC 加载引用的全局程序集。如果引用的程序集在 GAC 中可用，CLR 将返回其包含的子目录并加载包含清单的文件。以这种方式查找程序集可确保调用者在运行时加载的程序集来自构建代码编译所针对的程序集的同一发布者。现在比较引用程序集的 assemblyRef 表中的公钥标记和被引用程序集的 AssemblyDef 表中的公钥标记。如果引用的程序集不在 GAC 中，CLR 会查找应用程序的基目录，然后查找应用程序配置文件中标识的私有路径；如果使用 MSI 安装包含程序集的应用程序，则 CLR 调用 MSI 以加载所需的程序集。

# java - JTable 更新未出现

> ID：370369
> 
> 赞同：1
> 
> 时间：2008-12-16T03:17:40.770
> 
> 标签：java, user-interface, swing, jtable

我有`JTable`一个`TableModel`名为`DataTableModel`. 我用一组列名和无数据初始化表，如下所示：

```
books = new JTable(new DataTableModel(new Vector<Vector<String>>(), title2));
JScrollPane scroll1 = new JScrollPane(books);
scroll1.setEnabled(true);
scroll1.setVisible(true);
JSplitPane jsp1 = new JSplitPane(JSplitPane.VERTICAL_SPLIT, scroll1, scroll2);
JSplitPane jsp2 = new JSplitPane(JSplitPane.HORIZONTAL_SPLIT, inventory, jsp1);
myPanel.add(jsp2, BorderLayout.CENTER); 
```

我稍后想用一组数据更新书籍，并使用以下内容：

```
DataTableModel d = (DataTableModel)books.getModel();
d.setValues(bookList);
books.setModel(d); 
```

bookList 是一个`Vector<Vector<String>>`肯定有数据的地方。但是，尽管所有这些代码都在执行，但它并没有显示在屏幕上。该`setValues()`方法的代码是：

```
public void setValues(Vector<Vector<String>> v) {
    values = v;
    fireTableDataChanged();
} 
```

我在这里错过了什么吗？

我的 DataTableModel 的类和方法是（这些方法都是为了返回正确的结果而实现的）：

```
public class DataTableModel extends AbstractTableModel {
    public DataTableModel(Vector<Vector<String>> v, Vector<String> c) {}

    public int getColumnCount() {
        if (values != null && values.size() > 0)
            return values.elementAt(0).size();
        else
            return 0;
    }

    public int getRowCount() {
        if (values != null && values.size() > 0)
            return values.size();
        else
            return 0;
    }

    public Object getValueAt(int arg0, int arg1) {}
    public void setValues(Vector<Vector<String>> v) {}
    public Vector<Vector<String>> getValues() {}
    public void setColumnNames(Vector<String> columns) {}
    public String getColumnName(int col) {}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-16T06:09:54.217

您是否实施了其他方法`TableModel`？如果是这样，您的实现看起来如何？也许您应该发布您的表格模型代码让我们检查它？

顺便说一句：我在实施时的主要错误是`TableModel`覆盖`getRowCount()`和. 这将告诉表格没有要显示的数据...`getColumnCount()``return 0`

编辑：所以你似乎在使用类似 an`AbstractTableModel`或 a 的东西`DefaultTableModel`，对吧？您是否覆盖了某些方法？

编辑 2：您应该调用`fireTableStructureChanged`而不是`fireTabeDataChanged()`，因为最初您的表模型正在返回`0`for `getColumnCount()`。

`getColumnCount()`编辑 3：为了进一步优化您的模型，如果您的数据每次都具有相同的列数，您应该考虑返回一个固定值。然后你可以调用which 只是加载新数据，而不是每次都`fireTabeDataChanged()`完全建立表和数据（ ）。`fireTableStructureChanged()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T08:28:04.483

这是个奇怪的问题。你说的`DataTableModel`实现`TableModel`。所以。如果您不使用抽象类，问题应该出在您处理事件的方式上。听众真的注册然后通知了吗？如果可以的话，请发链接到源代码`DataTableModel`。但在此之前，请验证您是否正确处理注册到此模型中的侦听器。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-04-08T00:16:13.837

这解决了问题；您不允许取消绑定主 bindingGroup，但您指定 jtablebinding 像这样更新它

```
Binding b = bindingGroup.getBindings().get(0);
b.unbind();
b.bind(); 
```

# php - PHP 和 mysql 过程

> ID：370379
> 
> 赞同：2
> 
> 时间：2008-12-16T03:24:19.120
> 
> 标签：php

如果 php 代码如下所示，它与 mysql 存储过程等效。如果有任何关于高级存储过程mysql的链接教程，请放。

```
$sql = " SELECT  a,b FROM  j ";
$result = mysql_query($sql);
if(mysql_num_rows($result) > 0) {
    while($row = mysql_fetch_array($result)) {
        $sql_update = "UPDATE b set a=" . $row['a'] . "'";
        mysql_query($sql_update);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-16T04:01:07.907

这里有一个非常完整的例子。`mysqli`这篇文章是关于 Qcodo 的，但是有一个使用API的好例子。

[http://amountaintop.com/php-5-and-mysql-5-stored-procedures-error-and-solution-qcodo](http://amountaintop.com/php-5-and-mysql-5-stored-procedures-error-and-solution-qcodo)

你不能用`mysql`扩展来做到这一点。存储过程可以返回多个结果集，因此您必须使用`mysqli`扩展。您需要调用`mysqli_multi_query()`并继续循环遍历结果集，直到您全部阅读完毕。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T21:24:47.783

您可以查看 mysqli 并使用准备好的语句？

# .net - 除了 .NET 之外，编写 Windows 客户端应用程序的最佳方法是什么？

> ID：370399
> 
> 赞同：6
> 
> 时间：2008-12-16T03:35:48.147
> 
> 标签：.net, c++, windows, client

我正在尝试评估是否应该使 .NET Framework 成为我的新 Windows 应用程序的要求。我相信 .NET 是编写 Windows 客户端应用程序的最佳和最有效的方式，所以它归结为下一个最佳替代方案的痛苦程度。具体来说，我试图避免安装 .NET 客户端配置文件，该配置文件下载 28MB，如果它像常规的 .NET Framework 安装程序一样，则需要很长时间。

我以前使用过 wxWidgets 和 WTL，认为两者都是不错的选择。静态链接的 wxWidgets 可执行文件是 30MB，但它会被打包。WTL 占用空间小，但使用丑陋的代码创建。我使用了一些 MSI 创建者，但不是 WiX 或 NSIS，它们似乎是最好的免费选择。

我正在寻找任何建议、使用客户端配置文件安装程序的经验、使用小型自定义业务应用程序的经验或任何相关建议。

编辑：我在这里只赚几千美元，所以我正在寻找免费或便宜的东西（在我已经拥有的 Visual Studio 之后）。我不介意学习一门新语言，但我更喜欢使用越来越多的语言。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-16T03:47:47.013

实际上，您可以使用大量使用大型库（例如：boost）来制作 MFC 应用程序，这些库将编译为静态链接的 10MB 以下，具体取决于您包含的代码量和使用的功能。如果不包含大量二进制资源，即使是大型 32 位应用程序也不太可能超过 28MB。该路径的好处可能在很大程度上取决于您使用 C++ 和 MFC 的经验，但它肯定是一种选择（而且，作为奖励，您不依赖于预安装的任何框架的特定版本，或强制任何系统发生变化）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-16T12:02:13.163

您应该**强烈考虑**[Codegear](http://www.codegear.com)中的 Delphi 或 C++Builder 。

两者都生成紧凑的本机 Win32 应用程序，使用出色的双向 RAD 系统和 VCL 框架构建。有大量的免费和商业第三方组件，一个活跃的用户社区，并且 Codegear 现在似乎完全致力于本地开发，同时通过[RemObjects](http://www.remobjects.com)的新 Delphi Prism 系统在 .NET 领域保持活跃。

编辑：Gortok 询问“以 Delphi IDE 的成本，你怎么能推荐 Delphi？”

简单的。我认为这是值得的。我不知道你的时间值多少钱/收费，但你可以算一下。Delphi 2009 售价 874 美元。我认为 Visual Studio 2008 Pro 的价格也差不多。

如果你真的没有钱，那么你可以免费获得[Turbo Delphi](http://turboexplorer.com)，就像啤酒一样。它基本上是 Delphi 2006 的精简版，因此在功能方面有点错误和落后 - 但仍然绝对可用。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-16T03:41:10.007

这取决于您如何分发应用程序。如果您有 cd 或其他物理媒体的选项，您可以通过该媒体分发运行时，而 28Mb 不算什么。

否则，您确实需要处理 28Mb 的下载。您的另一个选择是放弃 .Net 并选择另一个工具包。C++ Builder/Delphi 选项曾经很有吸引力，但我不知道他们的平台现在是什么样子的。

[更新]
我最近听到传言说单声道已经足够好，您可以使用它来编译和静态链接 .Net 应用程序作为本机 *.exe 文件。我们将不得不看看这是否是一个不错的选择。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-16T10:10:54.400

[Qt](http://qt.digia.com/)呢？它生成的应用程序占用空间小，非常容易学习，它支持与 VS200x 的完全集成，并且（您可能不需要）它独立于平台 - 甚至可以在 WinCE 上运行而无需（大）更改。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-12-16T12:09:48.047

你试过德尔福吗？

Delphi 非常适合快速应用程序开发 (RAD)。您可以构建表单，例如 dotNet，拖放组件。在我看来，它非常适合商业应用程序。

唯一的问题是你必须学习 Pascal，但这应该不是问题。Delphi 被编译并且非常快（类似于 c++）。

为什么不下载 Delphi 的试用版并尝试一下呢？

我能想到的一个优点是您不需要安装任何额外的包来运行您的应用程序（不是 dotNet 运行时或 c++ 可再发行组件）。

另一个要记住的好点是，它有 dotNet 支持并且有 Prism。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-16T03:48:54.280

在相关建议类别下：

构建 .NET 平台是有原因的，并不是因为 Win32 易于编程。有[Delphi](http://www.codegear.com/products/delphi)，有[Tcl/TK](http://www.tcl.tk/software/tcltk/8.0.html)，还有[MFC](http://en.wikipedia.org/wiki/Microsoft_Foundation_Class_Library)，但除非这些选项中的任何一个都比 .NET 更容易设计和部署，否则最好在 .NET 中吞下 28Mb 的下载和设计。

使用 .NET（冒着听起来像啦啦队长的风险），你会得到

*   拖放式 UI 设计，
*   .NET 框架的强大功能（让我们面对现实吧，您正在为 Windows 构建——让他们完成繁重的工作是一个*主要*的好处）
*   接近平台独立性（取决于[Mono](http://www.mono-project.com/Main_Page)有多好）
*   低成本

因此，如果时间是一个考虑因素，那么在 .NET 中进行开发。如果不考虑时间，那么您需要原始功能，并且您对 C++ 和 MFC 非常熟悉，然后使用它。Delphi 也是一种可能，但他们的开发平台的成本对我来说有点高。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-16T16:00:20.123

[RealBasic](http://www.realbasic.com)怎么样。

它有一个托管运行时（类似于 .NET，但没有那么强大）并在 windows/linux/mac 上运行，运行时大小约为 3MB

使用的语言是 BASIC 的方言，并且有一个很好的 WYSIWYG 设计器，支持拖放。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-16T11:16:06.767

使用 Visual Basic 6 编写应用程序比编写 .NET 更容易，而且占用空间比 .NET 运行时小得多。

当然，没有人提到它的原因是它现在是一种垂死的语言。但只是想我会像其他人一样提到它。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-07T20:16:00.767

我同意，您应该使用 wtlbuilder.com 在 C++ 中使用 WTL 进行编码

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-16T03:51:06.057

最终答案在小部件框架中，最简单的框架为您包装了 windows 窗口 api。以我的经验，最简单的框架是......

1./ 带有 c# 或 VB.NET (.NET) 的 Windows 窗体

2./ 带有 Delphi 或 C++ Builder 的 Visual Component Library (VCL)（作为本机应用程序的附加优势，并且没有额外的库要求）

3./ 使用 C# 或 VB.NET 的 Windows Presentation Framework（或基础）

4./ MFC - （颤抖）与 Visual C++

然后还有许多其他较少使用的框架，如 PowerBuilder 等。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-16T13:05:05.750

如果您担心运行时下载，只需使用 .NET 1.1 而不是最新最好的 .NET Framework。我认为 XP（或至少其中一个服务包）预装了它。在某些时候，您不得不说，如果有人使用的是 Windows 2000 或更早版本，那么您就无能为力了。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-07T20:28:21.863

我建议[U++](http://www.ultimatepp.org/)解决另一个问题：

[今天有哪些“最好的”跨平台 C++ UI 工具包？](https://stackoverflow.com/questions/366043/what-are-some-of-the-best-cross-platform-c-ui-toolkits-today#366191)

如果您喜欢 C++，一旦您尝试使用 U++，您会惊叹于它的美丽、优雅、轻量级、无 .NET，因为您的需求要求并积极使用 C++。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-01-11T22:35:01.973

我也推荐 REALbasic。我用它来创建很多 Windows 客户端应用程序，而且它在大多数情况下都运行良好。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-03-26T21:49:48.190

带有 Lazarus IDE 的开源 Free Pascal 编译器可能是一种选择。我也用 Free Pascal 编译和测试了我的大部分 Delphi 组件和库。对于用户界面，Lazarus 提供了自己的可视化组件库 FCL。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2011-05-17T20:03:32.333

使用 Realbasic。它是最简单、最快的，并且不需要依赖项。（因为它的小运行时包含在您的 exe 中）

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-12-16T12:47:10.873

另一种选择是将 Mono 与 mkbundle 一起使用。Mkbundle 将您的应用程序及其引用的所有程序集打包到一个二进制包中。

[这是一个关于它的 Mono 页面的链接。](http://www.mono-project.com/Guide:Running_Mono_Applications#Bundles)

# linq - 在 VB.net 中按聚合对 IQueryable 进行排序

> ID：370401
> 
> 赞同：2
> 
> 时间：2008-12-16T03:37:58.343
> 
> 标签：linq, sorting, iqueryable

一直在寻找使用聚合值对 IQueryable（使用 Linq To SQL）进行排序的快速示例。

我基本上需要计算一些派生值（两个值之间的百分比差异等）并以此对结果进行排序。

IE

return rows.OrderBy(Function(s) CalcValue(s.Visitors, s.Clicks))

我想调用一个外部函数来计算聚合。这应该实现 IComparer 吗？还是 IComparable？

谢谢

[编辑] 尝试使用：

```
Public Class SortByCPC : Implements IComparer(Of Statistic)

Public Function Compare(ByVal x As Statistic, ByVal y As Statistic) As Integer Implements System.Collections.Generic.IComparer(Of Statistic).Compare
    Dim xCPC = x.Earnings / x.Clicks
    Dim yCPC = y.Earnings / y.Clicks
    Return yCPC - xCPC
End Function

End Class 
```

LINQ to SQL 不喜欢我使用 IComparer

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-16T06:30:47.073

LINQ to SQL 永远不会喜欢您在查询中使用自己的方法 - 它无法看到它们的内部并计算出您希望 SQL 看起来像什么。它只能看到由查询中的 lambda 表达式构建的表达式树内部。

你想要的是这样的：

```
Dim stats = From x in db.Statistics
            Where (something, if you want filtering)
            Order By x.Earnings / x.Clicks; 
```

如果你真的想获取所有结果然后对它们进行排序，你需要向 LINQ 表明你已经“完成”了 IQueryable 方面的事情 - 调用[AsEnumerable()](http://msdn.microsoft.com/en-us/library/bb335435.aspx)然后你可以在客户端上进行任何剩余的处理. 最好让服务器尽可能多地做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T03:45:20.887

我的VB很糟糕，但我认为这应该是它的样子。这假定 CalcValues 返回一个双精度值并且类型`rows`是 RowClass。此示例不使用 OrderBy 扩展的 IComparer 版本，但依赖于双精度已经可比较的事实，并返回 CalcValue（假定为双精度）作为键。

```
Dim keySelector As Func(Of Double, RowClass) = _
     Func( s As RowClass) CalcValue( s.Visitors, s.Clicks )

return rows.OrderBy( keySelector ) 
```

以下是一些您可能会觉得有用的链接。

[IQueryable.OrderBy](http://msdn.microsoft.com/en-us/library/system.linq.queryable.orderby.aspx)扩展方法

Visual Basic 的[Lambda 表达式](http://msdn.microsoft.com/en-us/magazine/cc163362.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-17T06:36:19.980

我的解决方案：

```
Dim stats = rows.OrderBy(Function(s) If(s.Visitors > 0, s.Clicks / s.Visitors, 0)) 
```

这也捕获任何除以零异常

# deployment - 是否可以在没有 Office 2007 的情况下部署 Office 2007 PIA？

> ID：370407
> 
> 赞同：5
> 
> 时间：2008-12-16T03:42:41.347
> 
> 标签：deployment, vsto, office-2007, pia

Office 2007 PIA 是否也需要安装 Office 2007？我可以使用 VSTO 3.0 部署 Office 2007 PIA（不安装 Office 2007）吗？

编辑：我有一个生成 MS Word 文件的 Windows 应用程序。我在设置中添加了 Office 2007 PIA 作为自定义先决条件，但 Office 2007 PIA 需要安装 MS Office 2007。

我只是想知道如果 VSTO 不需要 Office 安装，那么也许我可以将我的应用程序转换为 VSTO。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-19T05:10:04.443

要使用 VSTO，您必须安装 Office。VSTO PIA 仅在 .NET 和 Office 公开的 COM 接口之间提供一个 shim。因此，PIA 不能在没有 Office 的情况下做任何事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-19T05:31:37.240

注意：您可以在没有 office 的情况下生成 docx (word 2007) 文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-18T20:23:51.807

您到底想对主互操作程序集做什么？我认为您需要稍微澄清一下您的问题。

如果您计划在没有安装 Office 的情况下对 Microsoft Office PIA DLL 进行任何方法调用，您可以预期您的代码在运行它时会因 COMException 而爆炸，因为 Office 无法与之交互操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-13T07:52:05.060

如果您想要在没有安装 MS Word 的情况下创建 Word 文档，那么您最好的选择是使用可用的程序之一来执行此操作。例如，这通常是在 Web 服务器上创建 Word/Excel 文档的方式。

为了生成 MS Word 文档，我们同时使用了[Syncfusion DocIO（以及用于 Excel 的 XlsIO）](http://www.syncfusion.com/products/docio/backoffice/default.aspx)和[OfficeWriter](http://officewriter.softartisans.com/)，它们在文档生成方面比 MS Word 更容易并且速度快 5 到 30 倍（取决于文档的复杂性）。但是，这些工具不是免费的。我想理论上可以手动生成 docx 文件（正如 Tracker1 所暗示的那样），但除非有免费的库来帮助这样做，否则这将是很多工作。

# c# - ObjectDataSource Gridview 插入失败 W/空值字典

> ID：370416
> 
> 赞同：4
> 
> 时间：2008-12-16T03:56:28.370
> 
> 标签：c#, asp.net, gridview, objectdatasource

我有一个gridview，我在页脚行中创建了一个插入模板。

我有一个绑定到业务对象的 ObjectDataSource。

我有一个永远不会被解雇的 OnInserting 事件处理程序。

一旦我在 ObjectDataSource 上调用 .Insert，程序就会遇到错误。我收到的错误是没有值，我应该检查以确保值字典不为空。

我没有看到将字典作为参数插入的方法。我已经看到提到抓取 ObjectDataSourceView 并使用它的 Insert 方法，但我没有看到任何关于如何做到这一点的提及，而且 MSDN 声称您无权访问。

反思是要走的路吗？有没有更好的方法在 gridview 上插入行？我在这里的步骤中是否遗漏了一些明显的东西？

下面是代码：
ObjectDataSource：

```
 <asp:ObjectDataSource ID="LeasesDS" runat="server" OnInserting="LeasesDS_Inserting" 
    DataObjectTypeName="CLS.BusObjects.LeaseObj" DeleteMethod="Delete" 
    InsertMethod="Insert" OldValuesParameterFormatString="original_{0}" 
    SelectMethod="GetLeasesByCustomerID" TypeName="CLS.BusObjects.LeaseObj" 
    UpdateMethod="Update">
    <SelectParameters>
        <asp:Parameter Name="customerID" Type="Int32" />
    </SelectParameters>
    <InsertParameters>
        <asp:Parameter Name="CustomerID" Type="Int32" />
        <asp:Parameter Name="PurchaseDate" Type="DateTime" />
        <asp:Parameter Name="AutoYear" Type="Int32" />
        <asp:Parameter Name="Make" Type="String" />
        <asp:Parameter Name="Model" Type="String" />
        <asp:Parameter Name="LeaseEndDate" Type="DateTime" />
    </InsertParameters>
</asp:ObjectDataSource> 
```

代码隐藏方法：

```
protected void LeasesGrid_RowCommand(object sender, GridViewCommandEventArgs e)
    {
        if (e.CommandName == "Insert" && Page.IsValid)
        {
            LeasesDS.Insert();
        }
    }
    protected void LeasesDS_Inserting(object sender, ObjectDataSourceMethodEventArgs e)
    {
        DropDownList GridCustomersList = (DropDownList)LeasesGrid.FooterRow.FindControl("GridCustomersList");
        TextBox PurchaseDate = (TextBox)LeasesGrid.FooterRow.FindControl("PurchaseDate");
        TextBox AutoYear = (TextBox)LeasesGrid.FooterRow.FindControl("AutoYear");
        TextBox Make = (TextBox)LeasesGrid.FooterRow.FindControl("Make");
        TextBox Model = (TextBox)LeasesGrid.FooterRow.FindControl("Model");
        TextBox LeaseEndDate = (TextBox)LeasesGrid.FooterRow.FindControl("LeaseEndDate");
        e.InputParameters["CustomerID"] = Convert.ToInt32(GridCustomersList.SelectedValue);
        DateTime? purchaseDate = null;
        if (!string.IsNullOrEmpty(PurchaseDate.Text)) purchaseDate = Convert.ToDateTime(PurchaseDate.Text);
        e.InputParameters["PurchaseDate"] = purchaseDate;
        int? autoYear = null;
        if (!string.IsNullOrEmpty(AutoYear.Text)) autoYear = Convert.ToInt32(AutoYear.Text);
        e.InputParameters["AutoYear"] = autoYear;
        string make = null;
        if (!string.IsNullOrEmpty(Make.Text)) make = Make.Text;
        e.InputParameters["Make"] = make;
        string model = null;
        if (!string.IsNullOrEmpty(Model.Text)) model = Model.Text;
        e.InputParameters["Model"] = model;
        DateTime? leaseEndDate = null;
        if (!string.IsNullOrEmpty(LeaseEndDate.Text)) leaseEndDate = Convert.ToDateTime(LeaseEndDate.Text);
        e.InputParameters["LeaseEndDate"] = leaseEndDate;
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-31T07:38:27.173

您的示例不一致，因为您设置了 DataObjectTypeName，但您的 LeasesDS_Inserting 方法正在添加参数，就好像它不是一样。

如果您不需要 DataObjectTypeName，您可以删除它，然后您应该有更好的机会让它工作。

如果您需要 DataObjectTypeName 或者只是喜欢它（就像我一样），有一种方法可以让它工作，但它并不漂亮。

在您的 LeasesGrid_RowCommand 方法中，您可以使用如下代码来获取视图：

```
IDataSource ds = (IDataSource)LeasesDS;
DataSourceView view = ds.GetView(LeasesGrid.DataMember); 
```

获取视图后，您可以构建一个字典，其中包含需要写入数据对象的值，该数据对象最终将传递给您的 Insert 方法。该代码看起来与您在 LeasesDS_Inserting 中的代码非常相似，但您将插入到您自己的字典而不是 e.InputParameters 中。

准备好字典后，您可以在视图上调用 Insert ，如下所示：

```
view.Insert(dict, delegate { return false; }); 
```

那应该这样做。

您将不再需要 LeasesDS_Inserting 方法，因为视图的 Insert 方法将完成将您提供给它的字典转换为数据对象的工作，该数据对象将传递给您的 Insert 方法。

如果您需要对该数据对象的属性进行更多处理，您将在传递给 LeasesDS_Inserting 的 InputParameters 字典中看到它。

# .net - 访问 Web 服务时出现 HTTP 403 错误

> ID：370420
> 
> 赞同：1
> 
> 时间：2008-12-16T03:57:59.910
> 
> 标签：.net, vb.net, web-services

我试图从远程计算机访问 Web 服务。我设法从浏览器访问网络服务。但是当我尝试从应用程序调用 Web 服务时，我得到了 HTTP 403。

知道为什么吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-16T04:14:06.260

[403](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.4)响应表示您正在连接的主机或软件不允许访问 Web 服务。造成这种情况的原因可能是：

*   您所在的远程主机被防火墙阻止
*   您已达到对 Web 服务的调用限制，它们正在阻止任何进一步的连接
*   您正在发送身份验证凭据，但该帐户被禁止/禁用
*   请求中的用户代理或其他标头导致服务拒绝连接。也许缺少标题？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T04:12:09.210

Web服务器认为客户端发送的HTTP数据流是正确的，但是由于某种原因禁止访问由URL标识的资源。检查防火墙设置。这应该对你有帮助:-)

# database - 我可以在 Perl 的 DBI 和 Oracle 中使用多线程吗？

> ID：370425
> 
> 赞同：6
> 
> 时间：2008-12-16T04:01:44.363
> 
> 标签：database, multithreading, perl, oracle

在使用 Oracle DBI 编写多线程 Perl 应用程序时，有谁知道任何问题或问题？每个线程都有自己与 Oracle 的连接。

很长一段时间以来，我都被告知 Perl 和 Oracle 不支持多线程。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-16T07:29:59.390

Perl DBI 通过其内部强制执行单线程，因此驱动程序一次只能在一个会话 ( `$dbh`) 上处于活动状态。不管你有多少个 CPU。因此，不支持多线程（因为 DBI 中的所有内容都是单线程的），但在多线程应用程序中使用 DBI（以及 DBD::Oracle）是安全的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-16T22:19:18.237

好吧，DBI 文档说不要使用线程化 Perl，并指出[Perlmonks 的一篇文章解释了](http://www.perlmonks.org/index.pl?node_id=288022). 告诉您不要这样做的文档是一个很好的理由。

但是，我已经看到它在某些平台上运行良好，但在其他平台上却惨遭失败。即使您确实让它工作，它也肯定不是便携式的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-11T08:06:01.720

我在 Perl 中使用多线程来对 Oracle 数据库进行基准测试，并且我必须为每个线程创建一个数据库处理程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-01T00:11:17.283

**不久前，**我设法让一个 ad-hock 实现工作......我将带有 dbi 的连接视为有限资源，并使用文件锁定机制在 Perl 中的各个线程之间共享它。我的多线程应用程序仅通过作为守护进程运行的单独 perl 脚本连接到 dbi。

在 Linux 上，多线程端是通过 fork 完成的，在 Windows 上，我使用了默认的 activeperl 实现（我忘记了）

我尝试让它们通过共享内存进行通信，但最终只使用了共享文件。Linux 有可靠的附加模式，所以它是小菜一碟。在 Windows 上，使它们同步要困难得多。

**最近**我研究了数据库事务，每个线程实例都有自己的数据库连接，并让数据库处理连接细节。

这是 mysql，但我确信 oracle 支持事务。

apache::dbi 与 mod_perl 配合得很好，可以在脚本的每次运行之间保持这些连接处于活动状态（在我使用它之前，建立的每个连接都非常耗时）。

你的结果会有所不同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-16T07:41:44.607

是的，在 Perl 中使用线程是一个非常糟糕的主意，无论您是否使用 Oracle。

虽然理论上，只要每个使用自己的连接，它应该可以工作，[perl 5.8 线程存在根本缺陷](http://www.perlmonks.org/index.pl?node_id=288022)。

如果您理解了那篇文章并且仍然想使用 Perl 线程，那么祝您好运。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-08-06T13:33:54.107

您可以尝试改用 shell“多线程”。在[http://alexhanin.blogspot.com/2010/07/multithreading-with-nothing-but-korn.html](http://alexhanin.blogspot.com/2010/07/multithreading-with-nothing-but-korn.html)中进行了描述 您可以将 perl 放入 shell 包装器中，然后将每个 shell“线程”用作程序的单独实例.

# iphone - 学习 Obj-C 内存管理

> ID：370427
> 
> 赞同：4
> 
> 时间：2008-12-16T04:02:09.667
> 
> 标签：iphone, objective-c, cocoa, macos, memory-management

> **可能重复：**
> [关于 iPhone 内存管理的最佳解释在哪里？](https://stackoverflow.com/questions/710288/where-are-the-best-explanations-of-memory-management-for-iphone)

我来自网络开发背景。我擅长 XHTML、CSS、JavaScript、PHP 和 MySQL，因为我在日常工作中使用了所有这些技术。

最近我一直在晚上和周末在 Xcode 中修改 Obj-C。我已经为 iPhone 和 Mac OS X 编写了代码，但我无法完全理解内存管理的实用性。我了解高级概念，但不清楚在实施中如何发挥作用。Web 开发人员通常不必担心这些事情，所以这对我来说很新鲜。

我已经尝试在我的项目中添加内存管理，但事情通常最终会崩溃。有什么学习方法的建议吗？任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-17T16:27:23.313

除了 arul 链接到的帖子中列出的官方 Apple 资源之外，还有一些关于该主题的其他好读物：

[Hold me, use me, free me](http://web.archive.org/web/20060418151507/http://www.stepwise.com/Articles/Technical/HoldMe.html)
[CocoaDev.com 的内存管理部分](http://www.cocoadev.com/index.pl?MemoryManagement)

以及调试内存管理问题的帮助：
[NSZombieEnabled](http://www.cocoadev.com/index.pl?NSZombieEnabled)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-19T13:43:36.183

# 经验法则

## 自动释放

每次`[[NSObject alloc] init]`你把它包装成一个`autorelease`：

```
// make sure it gets properly released
// autorelease releases the object at a later time.
NSObject *instance = [[[NSObject alloc] init] autorelease]; 
```

像这样的东西（不记得这个词）总是自动发布的，你也应该创建你的类来对应这个规则：

```
NSString *test = [NSString stringWithFormat:@"%i", 4]; 
```

## 保留/释放

如果您需要将对象存储的时间超过当前方法，请保留它：

```
[instance retain]; 
```

如果您不再需要它或将其与另一个对象交换：

```
[instance release]; 
```

您应该始终与代码中的数量`retains`相同`releases`。

## 访问器

Objective-C 2.0 让您声明属性并为您编写访问器。例如`@property(retain, readwrite) NSString *text;`看起来像这样：

```
- (NSString *)text {
    return text; // I don't like calling variables _test
}

- (void)setText:(NSString *)newText {
    [newText retain];
    [text release];
    text = newText;
} 
```

## 初始化/释放

在这些方法中，您应该始终`[self setVariable:…]`像这样使用：

```
- (id)init {
    if (self = [super init]) {
        [self setText:@"Lorem ipsum dolor sit amet."];
        // …
    }
    return self;
}

- (void)dealloc {
    // make sure text is set to nil and the old value gets released.
    [self setText:nil];
} 
```

# 垃圾收集器

使用[Objective-C 2.0 中内置的垃圾收集器](http://developer.apple.com/documentation/Cocoa/Conceptual/GarbageCollection/Introduction.html)，如果可以的话，不使用它几乎没有什么好处。

# 无论如何，这个保留/释放是如何工作的？

每次分配对象[1]时`[NSObject alloc]`，保留计数都会设置为 1。如果此计数达到 0，则删除对象。`[instance retain]`将计数增加 1 并将`[instance release]`计数减少 1。

¹ `[instance copy]`也确实分配了一个新实例，因此保留计数也为 1。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-16T17:31:31.220

Read the link that arul provided. Now that you're using a language that has no garbage collection (if you're developing for the iPhone) it's time to start thinking about object life times. Every object you instantiate will now have to be deallocated by someone, probably (possibly) you. Memory management is not an easy subject and the only way to get a handle on this is to practice. Play around with allocating an object and deallocating it. Watch the retain counts grow as you add an object to a collection. Look into Autorelease pools. Essentially, you should know where and when an object gets allocated AND deallocated. On systems with limited memory (such as iphone) you'd want an object to disappear as soon as possible.

My suggestion would be to spend a few days playing around with memory management before you start working on the bulk of your application. Debugging memory issues and struggling with application logic is a bit of a hassle.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-16T04:16:03.290

由于保留/释放范式，Cocoa 中的内存管理实际上非常简单。从学习指针的概念开始——虽然你不需要成为 C 专家来学习 Objective-c，但理解指针是必不可少的。然后阅读[本](http://www.cocoadev.com/index.pl?MemoryManagement)（或其他）指南。如果您需要何时应该和不应该保留对象，请写下规则，并且通过一些练习，您应该立即“得到它”。

请记住，您可以打开垃圾收集而不必太担心内存管理，但我不建议这样做；即使启用了 GC，仍然有时您必须了解幕后发生的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-30T10:51:43.850

One mistake I see often is the use of the autorelease convenience calls when a regular release will do. This only makes life difficult for you because this removes the problem from the call site, while making it very difficult to isolate problems in large codebases.

This also forces you to learn memory management from the outset, which is not fun, but worthwhile because you can generally salvage more of the code you've written.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-19T13:21:33.037

[我使用了来自Mac Developer Network](http://www.macdevnet.com)的内存管理视频培训课程。在我刚开始的时候给了我我需要的东西。当我开始遇到自己的内存管理问题时，它立即带来了好处。

# sharepoint - SharePoint 中的 RSS 查看器很奇怪

> ID：370428
> 
> 赞同：2
> 
> 时间：2008-12-16T04:02:23.193
> 
> 标签：sharepoint, rss

关于 SharePoint 上的 RSS 查看器，我遇到了奇怪的情况

我有两个 SharePoint 环境（生产和测试）

我在他们两个上都显示了一个特定的 RSS 新闻 (ABC)，并且在设置代理和其他内容后它正在工作。

突然（可能是由于在没有测试的情况下对生产进行了一些更改），生产上的 RSS 查看器没有显示 RSS 新闻它显示协议错误，而它在测试环境中仍然可以正常工作。

现在奇怪的部分是，如果我更改我们管理层想要的 RSS 并将 BBC 或 CNN 新闻放在生产和测试环境中都运行良好。

但是我们希望它工作的那个（在两者上都工作得很好）不能在生产中工作并且在测试中工作得很好。

关于如何解决的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-05T22:00:53.327

你能告诉我们你得到的错误吗？而且，你的防火墙配置不好，abc新闻会被拒绝吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T14:47:00.787

听起来像网络问题。如果日志没有显示对协议错误更有帮助的信息，我会尝试使用wireshark，看看你是否能看到测试和生产之间有什么不同。

# html - 浮动css后div崩溃

> ID：370432
> 
> 赞同：19
> 
> 时间：2008-12-16T04:06:10.830
> 
> 标签：html, css, xhtml, css-float

我有一个名为 NAV 的 div，在 NAV 内部我有一个 5 li 的 UL，我向左浮动，即 li 是，但当我这样做时，NAV 会崩溃。我知道这一点，因为我在 NAV 周围设置了一个边界，以查看它是否崩溃并且确实如此。这是示例。

[折叠 http://img401.imageshack.us/img401/8867/collapsedze4.png](http://img401.imageshack.us/img401/8867/collapsedze4.png)

[没有折叠 http://img71.imageshack.us/img71/879/nocollapsedkx7.png](http://img71.imageshack.us/img71/879/nocollapsedkx7.png)

正如您在第一张图片中看到的那样，NAV div 中的链接向左浮动，顶部的黑色边框是称为 NAV 的实际 div。

在这张图片中，您可以看到它如何具有顶部和底部边框并且它没有折叠。

这是我使用的一些html和css。

[替代文字 http://img301.imageshack.us/img301/5514/codejc8.png](http://img301.imageshack.us/img301/5514/codejc8.png)

```
#nav #ulListNavi  a  {
    float: left;
} 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-11-20T14:42:30.240

添加容器`overflow`以外的任何值：`visible`

```
div#nav { overflow:auto; } 
```

然后添加`width`恢复宽度

```
div#nav { width: 100%; overflow:auto; } 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-12-16T04:13:58.927

一种解决方案是在最后一个浮动锚之后向元素添加“clear:both”样式，例如：

```
<div id="nav">
  <ul id="ulListNavi">
    <li><a href="#">Home</a></li>
    <li><a href="#">Search</a></li>
    <li><a href="#">Flowers</a></li>
    <li><a href="#">My Account</a></li>
    <li><a href="#">Contact Us</a></li>
  </ul>
  <div style="clear:both;"></div>
</div> 
```

这会导致包含元素在关闭包含框之前清除所有浮动元素。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-16T04:29:17.273

在这里清除浮动的其他一些选项：

[http://www.quirksmode.org/css/clearing.html](http://www.quirksmode.org/css/clearing.html)

[http://www.sitepoint.com/blogs/2005/02/26/simple-clearing-of-floats/](http://www.sitepoint.com/blogs/2005/02/26/simple-clearing-of-floats/)

至于最好的方法，这几乎是一场圣战，纯粹主义者会对额外的 div 感到害怕，如果你不被一点额外的标记所困扰，那么按照 Joshua 和 AJ 的建议添加已清除的 div 就可以了，并且是一种可靠的技术，但至少还有 17 种其他方法可以做到这一点......

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-16T04:12:01.020

在您的 ul 之后添加此代码：

```
<div style="clear: both"></div> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-16T04:08:40.887

尝试将包含元素也浮动到左侧。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-12-14T11:40:00.607

您的问题是因为您正在浮动`<A>`元素，但它们中的每一个都在一个`<LI>`元素内。`LI`s 默认显示为块，因此每个`<LI>`都强制它的孩子`<A>`从新行开始。

如果你浮动`<LI>`s，我想你会解决你的问题。

```
#nav #ulListNavi  li  {
    float: left;
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-11-20T15:01:53.130

不要为清除元素或溢出而烦恼。添加这个：

```
#nav {
    float: left;
} 
```

当您浮动 LI 时，#nav 不再“包含”任何内容，因此它会崩溃。但如果 #nav 也是浮动的，则它包含浮动在其中的任何内容，因此它会再次展开。

（还可以考虑删除#nav div 并将相同的样式应用于 UL。）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-02-20T19:20:07.953

最快的解决方案是添加溢出：隐藏以清除父元素上的浮动：

```
#nav{overflow:hidden;} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-11-20T14:50:04.047

在不更改 HTML 的情况下：

```
#nav
{
    width: 100%;
    overflow: auto;
    border: solid 1px red;
}
#ulListNavi
{
    margin: 0;
    padding: 0;
    list-style: none;
}
#nav #ulListNavi li
{
    float: left;
}
#nav #ulListNavi li a
{
    margin-left: 5px;
} 
```

适用于 IE8 和 FF 3.5

# keyboard-shortcuts - Adobe AIR 键盘挂钩

> ID：370449
> 
> 赞同：2
> 
> 时间：2008-12-16T04:17:14.160
> 
> 标签：keyboard-shortcuts, air, flex3, keyboard-hook

我正在尝试向我的 AIR 应用程序添加一项功能，即使应用程序已最小化，它也可以侦听（可配置的）全局键盘事件。例如：CTRL-ALT-SHIFT-F12 截取屏幕截图。

我找不到任何注册键盘钩子的方法，并且监听键盘事件仅在应用程序具有焦点时捕获它们。建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T21:21:36.960

我不认为 Adob​​e Air 程序可以处理按键事件，除非应用程序是焦点。

[http://forums.adobe.com/thread/420446](http://forums.adobe.com/thread/420446)

即使[这个](http://www.adobe.com/cfusion/communityengine/index.cfm?event=showdetails&productId=2&postId=304)关于按键的全局处理程序的问题也表明应用程序必须处于焦点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T16:12:29.220

尝试连接到舞台的 KeyboardEvent：

```
stage.addEventListener(KeyboardEvent.KEY_DOWN,KeyHandler);  

function KeyHandler(e:KeyboardEvent){
    trace ("Key Code: " + e.keyCode);  
    trace ("Control? " + e.ctrlKey);  
    trace ("Shift? " + e.shiftKey);  
    trace ("Alt? " + e.altKey);  
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-06T17:01:16.133

使用 NativeProcess，您可以非常轻松地编写一个外部应用程序来监听全局键盘事件并将它们发送回您的 AIR 应用程序。我现在可能正在走这条路……

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-12T03:22:50.860

我正在 Flash CS5 中测试我的 Air 应用程序，我需要禁用键盘快捷键，以便我可以测试我自己的快捷键。我可以让 ctrl-F 工作，但 ctrl-C 不会。

我注意到，如果我正在测试的是标准 AS3 文件，我的键盘快捷键将起作用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-08-04T04:50:32.807

我使用的一种方法是监视 AIR 应用程序中的剪贴板，它只允许您根据复制的数据做出反应，但它至少是一种在应用程序没有焦点时侦听输入的方法。

# javascript - 没有溢出的可滚动div：自动？

> ID：370451
> 
> 赞同：1
> 
> 时间：2008-12-16T04:19:17.153
> 
> 标签：javascript, prototypejs, scriptaculous

在我的应用程序中，我有 2 个 div，其中一个有很长的产品列表，可以拖到另一个 div（购物车）中。产品 div 有溢出，但它破坏了原型可拖动元素。原型黑客非常突兀，并不与所有浏览器兼容。

所以我采取了不同的方法，是否可以在不使用 CSS 的情况下拥有一个可滚动的 div `overflow:auto`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-16T04:39:37.360

有一个 CSS 属性来控制它。

```
<div style="width:100px;height:100px;overflow:scroll">
</div> 
```

[http://www.w3schools.com/Css/pr_pos_overflow.asp](http://www.w3schools.com/Css/pr_pos_overflow.asp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T04:31:24.540

您可以使用内容大于其窗口的框架。可能会使传递 JS 事件变得困难。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-18T07:14:13.850

这是我写的让它在 IE 8.0.6 和 Firefox 3.6.3 下运行的内容：

使`"width:100px;scrollable:auto"`容器中的元素（带边框）可拖动：

```
function makeDraggable(container,tag) {

    if(!container || !tag) { return false; }
    $(container).select(tag).each( function(o) {
      new Draggable(o,{
        starteffect: function(e){makeDragVisible(container,e);},
        endeffect: function(e){e.setStyle({'position':'','width':'','cursor':''});},
        zindex: 1000
        // , revert: ... // the other options
      });
    });

}

function makeDragVisible(container,element) {

    if(!container || !element) { return false; }
    var i=$(container).getStyle('width');
    i=i.replace('px','');
    i=Math.round(i-20)+'px';
    element.setStyle({'width':i,'z-index':1000,'position':'absolute','cursor':'move'});
    // 
    $(container).setStyle({});

} 
```

重要笔记：

1.  z-index 重复
2.  注意容器末尾的样式丢失`'starteffect'`。光标和宽度只是为了保持拖动用户友好。

我希望它有所帮助。

# jasper-reports - 子报表的包含和排除 (iReport-JasperReports)

> ID：370454
> 
> 赞同：3
> 
> 时间：2008-12-16T04:25:40.963
> 
> 标签：jasper-reports, ireport

我需要根据条件包含或排除子报表。我正在使用 iReport 创建 JasperReports。即，如果子报表有值，我需要包含该子报表，否则不需要。任何人都可以发送样品或告诉我如何解决这个问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-23T03:32:55.273

您可以在主报表中从您的数据源中获取数据，从而确定是否应包含子报表，然后使用子报表元素上的“printWhenExpression”字段来检查该数据。

我经常使用它——例如 printWhenExpression 字段可能包含：

```
new Boolean($F{TOTAL_STATS}.intValue() != 0) 
```

其中 TOTAL_STATS 来自主报告的数据库查询。如果非零，我们会显示一个详细说明一些数据的子报告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-17T14:01:31.070

据我所知，如果子报表中没有打印任何数据，Jasper 会消除空格。换句话说，如果您的子报表通常会占用半页，但没有数据，那么空白空间将被消除。我不确定这就是您所说的包含或排除报告的意思。

另一种解决方案是将子报表放在主报表中，然后从右键单击 -> 属性 -> 子报表选项卡，选择“子报表条件”选项卡并在那里写下你的条件。如果条件为真，则打印子报表的内容，否则不打印。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-11T01:55:05.190

Jamie Love 对“printWhenExpression”的回答恰到好处。

> 如果子报表中没有打印任何数据，Jasper 会消除空格

实际上，至少在 JasperReports 3.7.0 中有一个子报表属性“Remove Line When Blank”来控制该行为。默认情况下——至少在我使用 iReport 时——该参数是关闭的。

威格

# network-programming - 控制客户端与服务器的连接的最佳算法/技术是什么？

> ID：370458
> 
> 赞同：-1
> 
> 时间：2008-12-16T04:34:30.930
> 
> 标签：network-programming

我有超过 50 个客户端连接到一台服务器（低端服务器，运行 windows 2003 服务器），每次出现电源故障或开关故障时，客户端都会断开与服务器的连接，在此事件期间服务器可能会保持打开状态（如果电源备份已安装），当客户端返回时，它们会自动检测服务器并启动连接过程，此时服务器将开始向客户端发送相关数据。在这一点上，您意识到一些客户端将开始冻结，因为服务器速度不够快，无法发送数据，因此它会阻止其余客户端。

我已经实现了一种粗略的方法来控制这个客户风暴，但我在问那里的人是否有更好的算法来执行这种任务。

注意：我在 delphi 应用程序上使用 Asta 套接字组件，但我不介意来自不同领域的示例，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-16T04:41:12.210

与网络冲突检测协议类似，也许客户端在启动时启动连接之前可以等待一段随机时间？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T04:45:42.933

除了不来梅建议的随机启动延迟之外，在您的协议中实现某种“太忙；稍后再试”消息。对于 50、100 甚至 1000 个客户来说，用短消息拒绝客户应该不是问题。让客户端通过随机延迟和重试+指数退避来响应。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-03-03T10:19:16.883

解决方案也取决于您的偏好。您可以下拉连接请求或发送忙碌消息吗？另一种选择是您开始以循环方式向客户端发送数据。为此，您可以让不同的线程负责将数据发送到不同的客户端。这种情况的优点是没有一个客户会挨饿。

# asp.net - 如何使用 Vista 和 IIS7 使用 ASP.Net 复制文件？

> ID：370459
> 
> 赞同：0
> 
> 时间：2008-12-16T04:36:31.503
> 
> 标签：asp.net, iis-7, windows-vista

我在网站上有一个按钮，可以创建目录并复制文件。我使用 Visual Studio 2008、ASP.Net 3.5 开发它。我正在运行 Vista 作为我的操作系统。该网站使用身份假冒。

该功能在以下情况下不起作用（“拒绝访问路径 XYZ”）：

*   我通过 IE 访问本地网络服务器运行网站

当 [注意 Visual Studio 以管理员权限运行] 时，该功能可以正常工作：

*   我在 Visual Studio 中播放
*   我说在 Visual Studio 的浏览器中查看
*   我通过 IE 访问本地网络服务器运行网站，但以管理员权限启动 IE
*   我将网站部署到另一个网络服务器（也是 vista/IIS7）
*   我修改 FireFox 以接受集成身份验证，然后通过 FireFox 和 localhost 访问

我以前从未见过这种行为，以前 File.Copy 类型的命令只关心被复制到的文件夹的权限是否有效等......（在尝试调试这种情况时，我让每个人都拥有完全控制权）。问题似乎可能在于是否具有管理员权限？或者正在登录到它正在运行的机器？

这里发生了什么？为什么在开发环境下能用，部署到别的机器上，部署在自己的机器上不行？似乎很奇怪，任何帮助将不胜感激。

**编辑**：我已将“所有人”添加到所有相关目录并赋予该用户完全控制权，所以不应该有任何权限问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-16T04:54:44.633

IIS 在其下运行模拟线程的用户更有可能无权访问原始文件或目标。您是否尝试过直接以该用户身份进行复制？当您以管理员身份运行 IE 或以管理员身份运行 VS 时，模拟用户拥有管理员的完全权限。

[编辑 - 添加链接]

在类似的线程上有一些信息，使用 SysInternals 的想法很好：

[IIS7 的 UnauthorizedAccessException](https://stackoverflow.com/questions/188114/unauthorizedaccessexception-with-iis7)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-16T04:59:42.547

您应该尝试通过 asp.net 授予修改权限

你可以通过 google(ing) 找到几篇关于它的文章。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-16T07:10:22.627

好的，鉴于这些症状，我已经找到了解决此问题的方法。我不是 100% 确定为什么会这样（特别是因为它在 FireFox 中运行良好，并且如果您不在本地连接，则在 IE 中运行良好），但以下似乎是一种解决方法。

在 IE 中选择工具 -> Internet 选项 -> 安全 -> 受信任的站点 -> 站点，然后将[http://localhost](http://localhost)添加为受信任的站点。这使您可以在本地使用该网站。为什么在本地连接时需要在 IE 中执行此操作，而不是在连接到另一台计算机时在 FireFox 或 IE 中执行此操作，我不知道。但这似乎是一个可行的解决方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-16T04:48:02.040

我的猜测是 ASP.Net 运行的身份没有权限（NetworkService）或用于匿名身份验证的用户确实有权限（IUSR）

# mysql - MySQL 为什么要在 InnoDB 表中添加注释？

> ID：370473
> 
> 赞同：5
> 
> 时间：2008-12-16T04:48:48.483
> 
> 标签：mysql, innodb

使用 phpMyAdmin 或 MySQL GUI 工具时，每当我创建 InnoDB 表时，它都会向表中添加如下注释：

> 免费 InnoDB：9216 kB

这是什么意思？它是干什么用的？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-16T04:56:04.613

InnoDB 每个文件存储许多表。在该 InnoDB 数据文件中，可以有可用空间：

*   当您删除表或索引、删除行或用较小的行替换行时（例如，较短的 TEXT）
*   该文件一次增长*n* MB（在 my.cnf 中配置）

该评论只是告诉您 InnoDB 数据文件中有多少可用空间。当接近 0 时，InnoDB 将展开数据文件。

我相信默认的分配块是 10MB，所以这可能就是为什么你有将近 10MB 的空闲空间。

# c# - .NET - 尝试编译自动属性时出错

> ID：370476
> 
> 赞同：4
> 
> 时间：2008-12-16T04:50:49.867
> 
> 标签：c#, .net, asp.net, automatic-properties

我正在尝试使用此代码编译 POCO

```
public class MenuItem
{
    public string Name 
    { get; set; }
    public string Url
    { get; set; }
} 
```

我不断在获取和设置上收到编译错误，其中包含以下消息：“MenuItem.Name.get”必须声明一个主体，因为它没有标记为抽象或外部。我错过了什么？我正在本地文件系统网站的 App_Code 文件夹中编译此类，该网站设置为编译为 .NET 3.5。我知道我以前做过，但不知道我在做什么不同。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-16T04:57:41.583

确保您的`Web.config`文件包含这样的`<system.codedom>`元素下的子`<configuration>`元素：

```
<system.codedom>
  <compilers>
    <compiler language="c#;cs;csharp" extension=".cs" warningLevel="4"
              type="Microsoft.CSharp.CSharpCodeProvider, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
      <providerOption name="CompilerVersion" value="v3.5"/>
      <providerOption name="WarnAsError" value="false"/>
    </compiler>
  </compilers>
</system.codedom> 
```

问题源于 ASP.NET 正在运行旧版本的 C# 编译器来编译不支持自动属性的应用程序 (v2.0)。为了使用 .NET 3.5 功能，您必须在您的`Web.config`明确指定编译器版本。

# algorithm - 英特尔十六进制文件中任意大小的填充图案

> ID：370499
> 
> 赞同：4
> 
> 时间：2008-12-16T05:03:14.850
> 
> 标签：algorithm, file, embedded, hex

我一直在尝试使用开源[Srecord](http://srecord.sourceforge.net/)程序进行填充。我需要做一个填充 `0xC2AF00`。看来该程序只能执行一个字节长的填充（例如：）`0xff`。[如果Srecord](http://srecord.sourceforge.net/)程序无法做到这 一点，那么我将如何编写自己的算法来做我想做的事情？

我不太确定如何确定需要填充的内容，然后我将如何继续进行所需的填充。如果有人可以为泰克文件回答相同的问题，那将与如何在英特尔十六进制文件上执行我所要求的一样好或更好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-16T09:12:19.993

-repeat-data 生成器可以将多个字节作为参数。下面将用 C2AF00C2AF00 填充字节 16 到 31...

```
srec_cat -Output -Intel -generate 0x10 0x20 -repeat-data 0xC2 0xAF 0x00 
```

结合您的实际输入或其他生成器，以填充适当的范围。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-14T05:48:59.043

您可以完全控制使用一些特殊库生成 Intel Hex 文件，例如[使用这个 IntelHex Python 库](http://www.bialix.com/intelhex/)

# asp.net-mvc - 从 ViewPage 继承

> ID：370500
> 
> 赞同：4
> 
> 时间：2008-12-16T05:03:40.013
> 
> 标签：asp.net-mvc, class, inheritance

是否可以同时继承 ViewPage 和 ViewPage<T>？？还是我必须同时实施。目前这就是我为 ViewPage 所拥有的。我需要重复自己并为 ViewPage<T> 做同样的事情吗？

```
 public class BaseViewPage : ViewPage
    {
        public bool LoggedIn
        {
            get
            {
                if (ViewContext.Controller is BaseController)
                    return ((BaseController)ViewContext.Controller).LoggedOn;
                else
                    return false;
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-16T06:21:48.637

创建两个版本：

```
public class BaseViewPage : ViewPage
{
     // put your custom code here
}

public class BaseViewPage<TModel> : BaseViewPage where TModel : class
{
    // code borrowed from MVC source

    private ViewDataDictionary<TModel> _viewData;

    [System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2227:CollectionPropertiesShouldBeReadOnly")]
    public new ViewDataDictionary<TModel> ViewData {
        get {
            if (_viewData == null) {
                SetViewData(new ViewDataDictionary<TModel>());
            }
            return _viewData;
        }
        set {
            SetViewData(value);
        }
    }

    protected override void SetViewData(ViewDataDictionary viewData) {
        _viewData = new ViewDataDictionary<TModel>(viewData);

        base.SetViewData(_viewData);
    }
} 
```

然后

```
public class MyCustomView : BaseViewPage
{
}

or

public class MyCustomView : BaseViewPage<MyCustomViewData>
{
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T09:25:58.000

取决于你如何做你可能想看的事情

```
ViewContext.HttpContext.Request.IsAuthenticated 
```

它可能会为您节省一些时间，而不是扩展 ViewPage 类。

如果您需要其他一些数据，您可以为提供数据的类之一编写扩展方法。例如，如果 LoggedIn 存储在会话中，您可以扩展上下文以给您一个 IsLoggedIn() in 方法。

编辑：

由于您扩展了一个已经在基础视图和强类型视图中可用的类，它将在两者中都可用。唯一的另一种方法是重新实现上面的强类型版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-22T23:41:55.097

我不会把它放在视图中，而是将它作为 ViewModel 上的属性（有一个 BaseViewModel）。这将更容易测试并确保您不会将业务逻辑放入视图中。

# multithreading - 多用户和多处理器环境对线程有用吗？

> ID：370501
> 
> 赞同：0
> 
> 时间：2008-12-16T05:05:53.767
> 
> 标签：multithreading, multicore, cpu-usage

考虑到 CPU 亲和性，这样的环境对线程有用吗？或者，如果多个用户登录并产生多个内核和用户线程，这样的系统是否会出现性能下降？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-16T06:22:34.737

当您说“考虑 CPU 亲和性”时，您是说在这个假设的系统中所有进程都具有 CPU 亲和性吗？或者这只是一个额外的信息？

如果系统已经加载（因此可运行线程比内核多），使用多个线程会减慢速度，但如果经常只有（比如说）2 个用户和 4 个内核可用，线程可能会有所帮助。

线程的另一个典型用途是“在后台”做一些事情，无论是显式使用线程还是使用异步调用。在这一点上，多线程绝对可以带来好处（例如，非挂起的 UI），而无需在大部分时间实际同时使用多个内核。

# c++ - C++ 中的引用计数

> ID：370504
> 
> 赞同：5
> 
> 时间：2008-12-16T05:07:07.383
> 
> 标签：c++, reference, counting

我正在用 C++ 实现一个数学库。该库将被编译为 DLL，因此使用它的人只需要类定义的头文件。

我的课程的用户将是刚接触这门语言的人。但是，有些对象可能会在其程序的几个部分中被引用。因为我不希望他们做内存管理，所以我想自己做。因此，我必须实现引用计数（垃圾收集是不可能的）。

我想让引用计数尽可能透明，例如......

```
// Define a Bézier curve
CVecList pts;
pts.Add(Vector(0,0,0));
pts.Add(Vector(0,0,100));
pts.Add(Vector(0,100,0));
pts.Add(Vector(0,100,100));
CCurve* c1 = new CBezier(pts);

// Define a 3rd order B-Spline curve
pts.Clear();
pts.Add(Vector(0,0,0));
pts.Add(Vector(0,200,100));
pts.Add(Vector(0,200,200));
pts.Add(Vector(0,-200,100));
pts.Add(Vector(0,-200,200));
pts.Add(Vector(0,0,0));
CCurve* c2 = new CBSpline(pts,3);

// The Bézier curve object must be deleted automatically
// because the only reference to it has been released
// Similar to IUnknown::Release() in COM
c1 = c2; 
```

当我定义曲面对象时，事情变得有点棘手，因为有些曲面是根据两条曲线定义的：

```
CVecList pts;
// ...
CCurve* f = new CBezier(pts);

pts.Clear();
// ...
CCurve* g = new CBezier(pts);

// Mixed surface: S(u,v) = (1-v)*f(u) + v*g(u)
CSurface* s = new CMixed(f,g);

// There are two references to the first Bézier curve,
// the first one is f
// the second one is hidden in a member of CMixed

// Something similar applies to the second Bézier curve 
```

我认为覆盖`operator =`指针可能会有所帮助：

```
// This is what I tried, but it's illegal:
typedef CReferenceCounted* PRC;
PRC& operator =(PRC& dest, PRC& source)
{
    if (source)
        source->AddRef();
    if (dest)
        dest->Release();
    memcpy(&dest,&source,sizeof(PRC));
    return dest;
} 
```

...但后来我发现这`operator =`是无效的，除非它是类的非静态成员。

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-16T05:18:45.410

您尝试的是为标量类型重载运算符。除了枚举（除了 operator= 必须是成员之外），C++ 不允许您这样做。至少其中一种类型必须是用户定义的类型。因此，您要做的是将原始指针包装到用户定义的类中，该类重载构造函数、复制构造函数、复制赋值运算符和析构函数，并进行正确的引用计数。这是 的理想情况[`boost::shared_ptr`](http://www.boost.org/doc/libs/1_37_0/libs/smart_ptr/shared_ptr.htm)，它正是这样做的：

```
boost::shared_ptr<CCurve> c1(new CBezier(pts)); 
```

同样处理表面：

```
CVecList pts;
// ...
boost::shared_ptr<CCurve> f(new CBezier(pts));

pts.Clear();
// ...
boost::shared_ptr<CCurve> g(new CBezier(pts));

// Mixed surface: S(u,v) = (1-v)f(u) + vg(u)
boost::shared_ptr<CSurface> s(new CMixed(f,g)); 
```

携带该智能指针，它将自动管理指向对象的生命周期：如果指针的最后一个副本超出范围，则指向的对象将被释放。`shared_ptr`旨在易于使用。尽量避免使用原始指针。看看那些智能指针，它们会让你的程序员更容易使用 C++ :)

*编辑*：如果你要包装一个 shared_ptr，你可以使用 pimpl (handle/body) 习惯用法：

```
/* ---- wrapper in header file bezier.hpp */

struct CBezier {
    CBezier(CVecList const& list);
    void do_calc();
    // ...

private:
    struct CBezierImpl;
    boost::shared_ptr<CBezierImpl> p;
};

/* ---- implementation file bezier.cpp */

// private implementation
struct CBezier::CBezierImpl {
    CBezierImpl(CVecList const& list);
    void do_calc();
    // ...
};

CBezier::CBezier(CVecList const& list)
:p(new CBezierImpl(list)) {

}

void CBezier::do_calc() {
    // delegate to pimpl
    p->do_calc();
}

// ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T08:38:20.063

如果您正在设计一个数学库，请花大量时间考虑您的类是否可以看起来像 int 或 std::complex。也就是说，值的行为类似于值。例如

```
std::vector<math::point3d> pts;
pts.push_back(math::point3d(0,0,0));
pts.push_back(math::point3d(110,0,0));
pts.push_back(math::point3d(0,100,0));
pts.push_back(math::point3d(0,0,100));
CCurve c1 = make_bezier(pts); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T07:27:12.623

对于您可以控制的对象，我建议使用 intrusive_ptr 而不是 shared_ptr 以获得更好的性能和可用性，因为您可以稍后将原始指针分配给 intrusive_ptr，因为引用计数嵌入在对象中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-16T13:49:19.653

> 我的课程的用户将是刚接触这门语言的人。

您的课程是为编程课程设计的吗？

如果是这种情况，我会避免使用指针，而只使用复制构造函数/赋值：

*   性能/内存不是优先事项
*   自己进行内存管理将展示一个关于如何使用 new/delete 的非常糟糕的示例
*   在不了解内存管理的情况下使用任何类型的智能指针可能会在以后引起很多混乱。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-16T14:09:25.387

我同意 Guishu 和 MSalters。即使它不是用于编程课程，也可以更好地模仿数学外观（例如 vector3 = vector1+vector2 等）。

您还可以做的是使用写时复制（重新编写是一个合乎逻辑的结果），但仅限于内部。这可能会为您提供足够快的分配，消除客户端的堆管理以及与数学符号的相似性。

但是请注意，有可用于 C++ 的数学库（TNT，我想不到）。您是否考虑过以此为基础开展工作？

# parallel-processing - 如何通过 tcp 电缆连接两台或多台机器以形成网络网格？

> ID：370507
> 
> 赞同：-2
> 
> 时间：2008-12-16T05:08:26.197
> 
> 标签：parallel-processing, load-balancing, cluster-computing

如何连接两台或多台机器以形成网络网格，以及如何将工作负载分配给两台机器？

我需要在机器上运行什么操作系统，我应该使用什么应用程序来管理负载平衡？

注意：我在某处读到谷歌使用廉价机器来执行这个盛宴，他们如何连接两个网卡（'Teaming'）并在机器之间分配负载？

好的实际示例对我很有帮助，带有实际的代码示例。

指向一些我可能会阅读这些内容的好网站的指针将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-16T06:58:07.520

[Beowulf 项目](http://www.beowulf.org/)是一个很好的起点。基本上是一个建立在 Linux 操作系统上的开源集群。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T15:01:07.787

在这个不断扩大的市场中有几种软件解决方案。“云计算”这个词肯定会越来越受欢迎来描述你想做的事情。您想要一项服务，还是想在内部运行它？

我最熟悉[Appistry EAF](http://www.appistry.com) - 在基于商品的硬件上运行。它可以免费[下载](http://www.appistry.com/developers/)。在 windows 或 linux 上运行。

另一个是[GoGrid](http://www.gogrid.com) - 我相信这只能作为服务提供，但我对它并不熟悉。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T05:29:21.740

并行处理有许多不同的方法，您可以使用许多类型的系统架构。

对于商品系统，有集群和网格，甚至可以由几块商品硬件组成一个系统映像。当然还有负载均衡、高可用性、故障转移等。

如果没有更多细节，几乎不可能回答这个问题。你到底想用这些系统做什么？答案在很大程度上取决于应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-16T06:17:45.947

你可能想看看一些与*折叠在家*和 SETI 项目有关的东西，以及他们的一些参与者博客，这里有一个非常棒的集群，一个人在宜家橱柜中建造：

[http://helmer.sfe.se/](http://helmer.sfe.se/)

可能会给你一些想法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-16T07:06:41.807

这个问题太抽象了。

一种（可以想象的）方法是使用[MPI](http://en.wikipedia.org/wiki/Message_Passing_Interface) - 一个并行编程框架，维基百科页面包含 C++ 示例，并且有其他语言的绑定。

# asp.net-mvc - 您将如何在 ASP.NET MVC 中实现 StackOverflow 的配置文件页面？

> ID：370512
> 
> 赞同：0
> 
> 时间：2008-12-16T05:12:40.290
> 
> 标签：asp.net-mvc

我猜 StackOverflow 代码有一些类似于 UsersController 的东西，它定义了这样的函数：

```
public ActionResult Profile(string id, string username, string sort)
{   

} 
```

据我所知，有两种方法可以实现 Profile 功能。一种是在 sort 参数上使用 switch 语句，并根据显示的内容（例如统计、最近、响应）呈现不同的视图。然后，这些视图将呈现部分用户控件来处理个人资料页面上半部分的显示（头像、用户名、最后一次看到等）。

我可以看到实现这一点的另一种方式是始终呈现一个视图并具有根据排序显示/隐藏其不同部分的逻辑。这将导致一个非常可怕的视图页面，但它应该也可以工作。

还有其他方法可以实现我缺少的 StackOverflow 个人资料页面吗？我问的原因是因为我当前的 ASP.NET MVC 页面有一个类似的配置文件页面，我想确保我不会以错误的方式处理这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-16T06:03:09.813

就个人而言，我会为每个选项卡部分创建一个操作和视图，并为顶部部分使用部分视图，以便在其他部分中共享。不过，我刚刚开始使用 MVC，所以我没有很多经验来支持这个建议。

我将使用的 URL 路由方案是 /{controller}/{id}/{section} 例如 /users/123/recent /users/123/responses 等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T06:07:52.410

您可以从排序值构建视图名称

```
<% RenderPartial(sort + "View") %> 
```

但是，如果参数不存在，它会默认返回统计视图，所以我认为他们不会这样做。

使用默认的开关返回统计视图时，排序开关可能会正常工作。

# svn - 如何开始使用 Sub-Version + Delphi？

> ID：370518
> 
> 赞同：16
> 
> 时间：2008-12-16T05:18:06.287
> 
> 标签：svn, delphi

我是这个 SCM 的新手，但由于 SVN 越来越受欢迎，我打算试一试。

我注意到的事情：

1.  SVN只是单片机的骨干，没有前端？
2.  为什么有多个版本的 Windows 二进制文件？底格里斯？斯利克SVN？视觉SVN？
3.  我是否需要像 Apache 这样的 Web 服务器才能使用 SVN？
4.  前端有几十个，Tortoise、WinSVN等……推荐哪一个？

整个事情相当混乱，我不知道从哪里开始。我正在使用 Delphi，并想用它来存储我的源文件。

更新 1：似乎我使用“file:///”协议让它工作了，谢谢。现在，如何将其配置为带有客户端 PC 的服务器。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-16T05:25:09.283

[这是将 TortoiseSVN 与 Delphi 的“工具”菜单集成的一个很好的指南](http://blog.excastle.com/2007/04/09/subversion-in-delphis-tools-menu/)。

该站点显示了如何将以下内容添加到 IDE 中：

1.  `svn Commit`: 打开 TortoiseSVN 提交窗口。

2.  `svn Diff`：显示当前正在编辑的文件的差异。（如果您配置了像 Beyond Compare 这样的外部差异查看器，这将使用它。）

3.  `svn Modifications`：打开 TortoiseSVN 修改窗口，显示所有修改文件的列表。

4.  `svn Update`：使用存储库中的最新更改更新您的工作副本。

[如果您没有安装 Ruby（如指南建议使用的那样），只需将其替换为简单的在线批处理文件即可](http://hallvards.blogspot.com/2007/04/subversion-in-delphis-tools-menu.html)：

```
"c:/program files/tortoisesvn/bin/tortoiseproc.exe" /command:%1 /path:%2 /notempfile 
```

然后使用以下命令创建工具项：

程序：`c:\windows\system32\cmd.exe`

参数：`/C C:\SvnPas\Utils\Batch\SvnCmd.Bat diff $EDNAME $SAVEALL`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-16T09:38:51.877

这是开始的最快方式

下载、安装和设置[VisualSVN 服务器](http://www.visualsvn.com/server/)。它是免费的，并且很好地集成到了 Windows 中。添加用户和组→创建您的存储库。

下载并安装[TortoiseSVN 客户端](http://tortoisesvn.net/downloads)。它是免费的，并且很好地集成到了 Windows 中。

创建一个目录，右键单击→“SVN Checkout”→在您的 SVN 服务器上输入您的代表。复制该目录中的文件→右键单击→“SVN提交”。

右击 DCU 文件 → 右击 → “添加到忽略列表” → “*.dcu”；

您可以忽略 DSK、DOF、CFG、LOCAL 扩展。

处理你的项目 → 不时做 SVN Commit；阅读更多关于 SVN 的内容。

如果您想获取其他人更改的内容：右键单击 → “SVN Updte”。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-24T00:00:01.583

> SVN只是单片机的骨干，没有前端？

基本上，SVN 是一个控制台应用程序。如果您不喜欢在控制台中键入所有命令，请使用 SVN 前端。

为什么有多个版本的 Windows 二进制文件？底格里斯？斯利克SVN？视觉SVN？

他们每个人都自定义 SVN 安装。例如，VisualSVN Server 在 Windows 上安装 SVN + Apache，通过在向导中询问您几个问题，并根据您的回答自动配置 SVN 和 Apache。

> 我是否需要像 Apache 这样的 Web 服务器才能使用 SVN？

不，没有必要。

> 前端有几十个，Tortoise、WinSVN等……推荐哪一个？

在我看来，对于 Windows，TortoiseSVN 是最好的。

> 整个事情相当混乱，我不知道从哪里开始。我正在使用 Delphi，并想用它来存储我的源文件。首先看一下电子书出版的SVN Help，讲解的非常好。如果您使用的是 TortoiseSVN，我建议您阅读它的帮助文件，因为它将 SVN 帮助集成到它的帮助文件中。

对于 Delphi 集成，您可以使用 TSVNWizard，它是一个将 TortoiseSVN 接口引入 Delphi IDE 的开源 Delphi 专家：http: [//delphiaddinfortortoisesvn.tigris.org/tsvnWizard.pas](http://delphiaddinfortortoisesvn.tigris.org/tsvnWizard.pas)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-16T07:11:38.053

1.  SVN 带有一个命令行 UI。有几个 GUI。[http://tortoisesvn.tigris.org/](http://tortoisesvn.tigris.org/)是最流行的并与 Windows 资源管理器集成。

2.  它是开源的。任何人都可以修改或捆绑它。

3.  不，您可以通过不同的方式连接到 SVN。其中之一是通过需要 Apache 的 HTTP。

4.  [http://tortoisesvn.tigris.org/](http://tortoisesvn.tigris.org/)如果你想要一个 Delphi 之外的。[http://delphiaddinfortortoisesvn.tigris.org/](http://delphiaddinfortortoisesvn.tigris.org/)是一个用于 SVN 的简单 Delphi IDE 插件。更高级的是[https://sourceforge.net/projects/delphisvn/](https://sourceforge.net/projects/delphisvn/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-16T08:50:28.103

基本上：使用 svnserve 在不安装 apache 的情况下为其他 PC 提供服务。

更详细地说：

我一直在考虑自己使用一种 SCM 和 Delphi。我决定使用[Subversion](http://subversion.tigris.org/)和[TortoiseSVN](http://tortoisesvn.tigris.org/)（SVN 的客户端）。这是我如何使它工作的。

像我这样的新手首先应该掌握一些关于颠覆的基本概念。阅读[颠覆书籍](http://svnbook.red-bean.com/)的*第 1 章*（在线免费提供）。接下来，您可以阅读同一本书的*附录 A* ，即快速入门指南。

 *在我们的 Linux 服务器上安装服务器之前，我想玩一下 subversion，所以我首先在我自己的 PC 上安装了一个服务器。安装过程非常简单。在[subversion 书的](http://svnbook.red-bean.com/)*第 6 章*中，我读到：“本书的作者为刚开始使用 Subversion 服务器的小型团队推荐了一个 vanilla svnserve 安装；它设置最简单，维护问题最少。你总是可以随着需求的变化，切换到更复杂的服务器部署。” 所以我只安装了svnserve。

我只是确保该文件`svnserve.conf`（它位于`conf`您在安装时选择的“存储库路径”中的文件夹中）包含以下未注释的行（并且只有那些）：

```
[general]
anon-access = none
auth-access = write
password-db = passwd
realm = My Projects
[sasl] 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-16T12:43:27.417

```
2\. Why is there several versions of Windows Binaries? Tigris? SlikSVN? VisualSVN? 
```

原因是 Subversion 项目只提供源代码，没有二进制文件。

*   tigris 版本是从 zip 文件中的构建脚本进行的简单构建。（不多也不少）。
*   Collabnet 分发由 Collabnet 提供商业支持。（您可以向他们支付支持合同的费用，或者在您自己支持他们时使用相同的二进制文件）。
*   SlikSVN 二进制文件类似于普通版本，但打包为 MSI，以便在客户端上轻松安装。（此包不包含服务器组件；但重命名了一些常见的 dll 以减少 dll 地狱）
*   VisualSVN Server 是一个很好的免费（如啤酒）包装器，围绕 subversion 和 apache 二进制文件，使维护 Windows 服务器变得容易。它通过添加一个封闭的源代码管理 GUI（和一个额外的 apache 模块）来做到这一点

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-16T05:24:06.493

在某处的 windows 或 linux 机器上设置 svn 并启用 SVN: 协议。这很容易安装和配置。文档很清楚。

然后使用 TortoiseSVN 签入/更新您的代码。它真的很容易使用。

1）SVN只是单片机的骨干，没有前端？是命令行。您可以将其用作命令行工具，但如果您使用 windows，则 Tortoise 是前进的方向。

2) 为什么有多个版本的 Windows 二进制文件？底格里斯？斯利克SVN？视觉SVN？

不同操作系统的不同二进制文件。

3) 我是否需要像 Apache 这样的 Web 服务器才能使用 SVN？

不。

4）前端有几十个，Tortoise、WinSVN等……推荐哪一个？

TortoiseSVN 如果你使用 Windows。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-16T08:59:21.690

除了要使用哪个前端之外，您还应该考虑如何组织您的源代码以及哪些文件可以签入 SVN，哪些不可以签入。（*.RES 文件成为 a** 的主要难题，因为它们是二进制文件但每次构建都会改变。）如何处理库？

我就是[这样做](http://www.dummzeuch.de/delphi/subversion/english.html)的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-16T20:21:53.480

我在这里有一些博客文章：http: [//sourceitsoftware.blogspot.com/2008/07/starting-out-with-delphi-and-subversion.html](http://sourceitsoftware.blogspot.com/2008/07/starting-out-with-delphi-and-subversion.html) [http://sourceitsoftware.blogspot.com/2008/07/ subversion-server-options.html](http://sourceitsoftware.blogspot.com/2008/07/subversion-server-options.html) [http://sourceitsoftware.blogspot.com/2008/07/common-tasks-with-subversion.html](http://sourceitsoftware.blogspot.com/2008/07/common-tasks-with-subversion.html)

我使用 tortoise svn 和 jedi jcl 库。大多数时候，我只使用乌龟。

最初（除非您有多个用户），您不需要服务器，只需在本地或网络驱动器上设置存储库即可。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-18T16:10:32.630

我在我的 Linux 虚拟主机上使用 svn，在我的机器上使用 TortoiseSVN。

我将它用于所有内容，甚至是 Microsoft Office 文件，Tortoise 使用 Office 来显示非常好的差异。

# smarty - 在 smarty div 位置固定不工作

> ID：370522
> 
> 赞同：0
> 
> 时间：2008-12-16T05:19:20.293
> 
> 标签：smarty

在 smarty div 位置固定不工作。虽然这个在简单的 php 中工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-16T09:07:44.090

这几乎不会是 Smarty 的问题。只需将 HTML 页面和本地保存并进行比较。有什么不同？也许您甚至可以为此使用差异工具。您是否尝试过验证[HTML](http://validator.w3.org/)和[CSS](http://jigsaw.w3.org/css-validator/)？它也可能会给你一些提示。

这是一个 CSS 问题——不是 Smarty 问题。您应该考虑向问题添加更多信息并使用 HTML/CSS 对其进行标记。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T05:24:41.920

你可以看到在 Firefox 中使用 FireBug 出了什么问题。

# .net - StructureMap 和我需要设置的公共属性的问题

> ID：370524
> 
> 赞同：1
> 
> 时间：2008-12-16T05:20:51.193
> 
> 标签：.net, structuremap

我有一个用于`StructureMap`Dependency *Inject*的接口。

```
public interface IFileStorageService
{
    void SaveFile(string fileName, byte[] data);
} 
```

界面不关心数据保存在哪里。无论是内存、文件、网络资源、太空卫星……

所以，我有两个实现这个接口的类；一个`test class`和一个`network file storage class`：-

```
public class TestFileStorageService : IFileStorageService
{ ... etc ...}

public class NetworkFileStorageService : IFileStorageService
{
    public string NetworkUnc { get; set; }
    public void SaveFile(...);
} 
```

请注意我`NetworkFileStorageService`的财产？该类在其 SaveFile 方法的实现中需要该值。

好吧，我不确定如何定义该属性。

我想我可以在定义我的依赖项的地方硬编码它（例如在我的引导程序方法中 - > `ForRequestedType<IFileStorageService>`...等），但最重要的是......业务逻辑*定义*了位置。它不是静态的。

最后，因为我在逻辑中使用接口，所以这个属性不可用。

任何人都可以帮忙吗？

如果可以，图像要保存两个文件

*   名称：Test1.bin；位置：\server1\folder1
*   名称：Test2.bin；位置：\server1\folder2

干杯！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-16T05:29:41.927

如果只有这个实现需要这个，那么把它放在你的构造函数中呢？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-09T10:19:29.287

结构映射假定所有构造函数参数都是必需的，属性是可选的。

有几种方法可以用结构图解决这个问题。您可以像这样创建工厂方法

```
x.ForRequestedType<Func<string, IFileStorageService>>()
  .TheDefault.Is.ConstructedBy(
    () =>
    NetworkUnc  =>
    {
      var args = new StructureMap.Pipeline.ExplicitArguments();
      args.SetArg("NetworkUnc", NetworkUnc );
      return StructureMap.ObjectFactory.GetInstance<IFileStorageService>(args);
    }); 
```

现在你可以创建你的对象

```
StructureMap.ObjectFactory
  .GetInstance<Func<string, IFileStorageService>>()("something"); 
```

但那不是那么漂亮。或者为这个类创建一个配置类。

```
public class NetworkFileStorageServiceConfig
{
    public string NetworkUnc { get; set; }
} 
```

并配置它

```
x.ForRequestedType<NetworkFileStorageServiceConfig>().TheDefault.Is.IsThis(
  new NetworkFileStorageServiceConfig { NetworkUnc  = "something" }); 
```

我敢肯定还有很多其他方法可以做到这一点。

# c++ - 在 C++ 中合并两个 PDF 文件

> ID：370543
> 
> 赞同：2
> 
> 时间：2008-12-16T05:47:05.213
> 
> 标签：c++, pdf, libharu

在 C++ 中，我使用[libHaru](http://libharu.org)生成 PDF 报告。我正在寻找某种方式将现有 PDF 文件中的两页附加到我的报告末尾。有没有免费的方法可以做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-16T05:49:32.477

您可以使用[Ghostscript](http://www.ghostscript.com/)实用程序`pdf2ps`将 PDF 文件转换为 PostScript，附加 PostScript 文件，然后使用`ps2pdf`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-16T20:19:23.440

试试 PoDoFo

[http://podofo.sourceforge.net/](http://podofo.sourceforge.net/)

您应该能够`PDFs`使用`PDFMemDocuments`.`PDFMemDocument.Load( filename )`

然后，使用 获取对要复制并添加到文档末尾的两页的引用`InsertPages`，或者选择删除源文档的最后两页以外的所有页面，然后调用`PDFDocument`。

附加并传递被调用的文档。很难说哪个会更快或更稳定。

希望有帮助，特洛伊

# c# - 使用 LINQ to SQL 获取 ID

> ID：370547
> 
> 赞同：8
> 
> 时间：2008-12-16T05:50:12.477
> 
> 标签：c#, asp.net, linq-to-sql, .net-3.5

将记录保存到数据库后如何获取记录ID。我的意思是实际上是这样的。

我有 Document 类（它是来自 DataBase 的实体），我创建了一个类似的实例

```
Document doc = new Document() {title="Math",name="Important"};
dataContext.Documents.InsertOnSubmit(doc);
dataContext.SubmitChanges(); 
```

我想要的是检索它位于数据库中的 id 值（docId），它的主键也是自动编号。一件事，系统上会有很多用户并提交大量这样的记录。

提前谢谢大家:)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-16T06:08:05.933

运行 .SubmitChanges 后，应该使用在数据库上创建的 Id 填充 doc.docId。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-16T06:19:29.500

就像每个人都说你应该能够做这样的事情：

```
Document doc = new Document() {title="Math",name="Important"};
dataContext.Documents.InsertOnSubmit(doc);
dataContext.SubmitChanges(); 
```

然后通过以下方式获取 ID：

```
int ID = doc.docId; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-16T06:13:47.717

默认情况下，Linq to SQL 确实更改跟踪。因此，一旦插入行，您的对象就会更新并添加到数据上下文中。您的文档集合中将有一个新的有效行。

[Charlie Calvert 的这篇](http://blogs.msdn.com/charlie/archive/2007/03/04/samples-update.aspx)博客文章有一些很好的 Linq 示例可供下载。我保留它仅供参考。

# css - 使用 CSS 使一行 div 的高度都相同

> ID：370548
> 
> 赞同：5
> 
> 时间：2008-12-16T05:51:35.517
> 
> 标签：css

我有一排 div 必须都具有相同的高度，但我无法提前知道该高度可能是多少（内容来自外部来源）。我最初尝试将 div 放在一个封闭的 div 中并将它们向左浮动。然后我将它们的高度设置为“100%”，但这没有明显的效果。通过将封闭 div 的高度设置为固定高度，我可以让浮动 div 展开，但只能达到容器的固定高度。当其中一个div中的内容超过固定高度时，溢出；浮动的 div 拒绝扩展。

我用谷歌搜索了这个浮动 divs-of-the-same-height 问题，显然没有办法使用 CSS 来解决。所以现在我尝试使用相对定位和绝对定位的组合而不是浮动。这是CSS：

```
<style type="text/css">
div.container {
  background: #ccc;
  position: relative;
  min-height: 10em;
}
div.a {
  background-color: #aaa;
  position: absolute;
  top: 0px;
  left: 0px;
  bottom: 0px;
  width: 40%;
}
div.b {
  background-color: #bbb;
  position: absolute;
  top: 0px;
  left: 41%;
  bottom: 0px;
  width: 40%;
}
</style> 
```

这是 HTML 的简化版本：

```
 <div class="container">
    <div class="a">Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Integer pretium dui sit amet felis. Integer sit amet diam. Phasellus ultrices viverra velit.</div>
    <div class="b">Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Integer pretium dui sit amet felis. Integer sit amet diam. Phasellus ultrices viverra velit. Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Integer pretium dui sit amet felis. Integer sit amet diam. Phasellus ultrices viverra velit.</div>
   </div> 
```

这是可行的，除非您将最小高度更改为 5em（演示当内容超过最小高度时会发生什么），并且您可以看到虽然文本没有被截断，但 div 仍然拒绝扩展。现在我输了。有没有办法使用 CSS 来做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-16T06:29:30.243

这是您可能陷入理想主义或现实主义之间的时刻之一。我知道，出于格式化原因，将非表格数据严格放在表格中没有语义价值，但我不希望看到您仅仅为了自己的缘故而向后弯腰为这个问题创建一个非表格解决方案。

我是第一个拒绝非语义设计的人，相信我，但有时你需要面对这样一个事实，即 CSS + 语义标记并不适用于所有设计场景。我不知道该站点的可访问性需求，但我建议您寻找更实用的解决方案来解决此问题。

为您以正确的方式解决此问题并寻找解决问题的正确方法干杯！不幸的是，这是 CSS 的黑暗角落之一（以及块内的垂直定位）​​，如果没有人造列、javascript 或表格单元格，这显然是不可能的。

无论您选择哪种，请不要为了标准而坚持。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-16T06:05:30.027

使它们完全相同的高度可能是一件棘手的事情，但如果它们必须看起来是相同的高度，您可能需要查看[仿柱](http://www.alistapart.com/articles/fauxcolumns/)技术。

我尝试了其他一些方法，但这是我发现的最可靠的获得效果的方法，当然除了使用表格。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-16T06:18:18.520

您可以使用 JavaScript，但如果不启用 JavaScript，它当然会中断。然后是表格，但这破坏了 CSS 的意义。也许[seanb 的答案](https://stackoverflow.com/questions/370548/making-a-row-of-divs-all-be-the-same-height-using-css/370559#370559)可以工作，放置一个背景图像，创建所有列都到底部的错觉。这被称为*人造背景技术*。

或者坐等`display: table-cell`所有/大多数浏览器都支持它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-17T11:03:59.533

好吧，桌子的事情比我想象的要复杂一些。事实证明，Javascript 解决方案实际上是最简单的（对于我的情况），因为我的应用程序是 AJAX 应用程序并且框架使用 Prototype.js。只需要几行 JS：

```
$$('div.container').each(function (element) {
 var longest = 0;

 element.descendants().each(function (child) {
  if (child.getHeight() > longest)
   longest = child.getHeight();
 });

 element.descendants().each(function (child) {
  child.style.height = longest + 'px';
 });
}); 
```

再次感谢您的帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-16T07:20:32.530

谢谢你们的回答，伙计们。我不认为背景图像会起作用，因为列的宽度也会根据列的数量而变化（用户可以更改它）。我想我会使用表格:(

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-17T11:12:09.173

如果您正在寻找一个纯 css 选项，并且您可以将块的背景与内容分开，那么答案是每个块有两个代码，一个用于内容，一个用于背景。这就是它的完成方式：

```
<div id="wrapper">
  <div class="content" id='one>
  <div class="content" id="two>
  <div class="content" id="three>
  <div class="background" id="back-one">
  <div class="background" id="back-two">
  <div class="background" id="back-three">
</div> 
```

使用浮动定位内容 div。然后使用绝对定位（和一个 z-index 将它们放在后面）定位背景

这是因为浮动可以设置高度，而绝对定位的元素可以有 100% 的高度。这有点混乱，但可以完成工作。

# static-libraries - 库的大小和可执行文件

> ID：370549
> 
> 赞同：11
> 
> 时间：2008-12-16T05:51:45.983
> 
> 标签：static-libraries, static-linking

我有一个在 Windows 上使用 MSVC 创建的静态库 *.lib。库的大小是 70KB。然后我有一个链接这个库的应用程序。但现在最终可执行文件 (*.exe) 的大小为 29KB，小于库。我想知道的是：

1.  由于库是静态链接的，我在想它应该直接添加到可执行文件大小，最终的 exe 大小应该比这更多吗？windows exe格式是否也会对二进制数据进行一些压缩？

2.  linux 系统的情况如何，即 linux 上的库大小（*.a/*.la 文件）与 linux 可执行文件（*.out）的大小有什么关系？

-广告

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-16T05:58:03.180

Windows 和 Unix 上的静态库都是 .obj/.o 文件的集合。链接器查看这些目标文件中的每一个并确定程序是否需要链接。如果不需要，那么目标文件将不会包含在最终的可执行文件中。这可能导致可执行文件比库小。

编辑：正如 MSalters 指出的，在 Windows 上，VC++ 编译器现在支持生成启用函数级链接的目标文件，例如，请参见[此处](http://msdn.microsoft.com/en-us/library/xsa71f43.aspx)。事实上，edit-and-continue 需要这样做，因为edit-and-continue 需要能够替换可执行文件的最小可能部分。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-16T07:00:14.003

`.lib`最终可执行文件不需要的文件中有额外的簿记信息。此信息有助于链接器找到实际链接的代码。此外，调试信息可能存储在`.lib`文件中，但不存储在`.exe`文件中（我不记得在 lib 文件中为 objs 存储调试信息的位置，它可能在其他地方）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-16T05:56:15.647

静态库可能包含几个从未使用过的函数。当链接器将库与主可执行文件链接时，它发现某些函数从未使用过（并且它们的地址从未被获取并存储在函数指针中），它只是丢弃了代码。它也可以递归地执行此操作：如果从未调用函数 A()，并且 A() 调用 B()，但从未调用 B()，则它可以删除 A() 和 B() 的代码。在 Linux 上，同样的事情也会发生。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-16T10:16:26.353

静态库必须包含在其源代码中定义的*每个*符号，因为它*可能*会链接到只需要该特定符号的可执行文件中。但是一旦它被链接到一个可执行文件中，我们就确切地知道哪些符号最终被使用，哪些没有。因此，链接器可以轻松删除未使用的代码，从而大大减少文件大小。同样，任何重复的符号（在静态库和它链接到的可执行文件中定义的任何东西都会合并到一个实例中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-16T06:10:20.360

**免责声明**：自从我处理静态链接以来已经有很长时间了，所以对我的回答持保留态度。

你写道：*我在想它应该直接添加到可执行文件大小，最终的 exe 大小应该不止这些？*

朴素的链接器正是以这种方式工作的——当我为 CP/M 系统进行业余开发时（很久以前），这是一个真正的问题。

然而，现代链接器更智能——它们只链接原始代码引用的函数，或者根据需要链接。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-16T06:56:57.990

除了当前的答案之外，如果函数定义具有相同的目标代码，则允许链接器删除它们 - 这旨在帮助减少模板化代码的膨胀效应。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-17T12:18:20.163

@All：感谢您的指点。@Greg Hewgill - 你的回答是一个很好的指针。谢谢。

我发现的答案如下：

1.）在库构建过程中，如果 MSVC（或类似的东西）中的“保持程序调试数据库”选项为 ON，则库将具有此调试信息，使其大小膨胀。但是当我静态包含该库并创建可执行文件时，链接器会在生成 exe 之前从库中删除所有调试信息，因此 exe 的大小小于库的大小。

2.) 当我禁用“保留程序调试数据库”选项时，我得到了一个大小小于最终可执行文件的库，这在大多数情况下我认为是正常的。

-广告

# serialization - 将我的 POJO 保存到 Jackrabbit JCR 的最佳方法是什么？

> ID：370557
> 
> 赞同：10
> 
> 时间：2008-12-16T06:00:09.087
> 
> 标签：serialization, jackrabbit, jcr

在 Jackrabbit 中，我体验了两种将 POJO 保存到存储库节点以存储在 Jackrabbit JCR 中的方法：

1.  写我自己的层和
2.  使用 Apache Graffito

事实证明，编写我自己的代码既费时又费力（不得不编写和运行许多丑陋的自动化测试），但非常灵活。

使用 Graffito 令人失望，因为它似乎是一个[停留在 2006 年的“死”项目](http://incubator.apache.org/graffito/news.html)

有哪些更好的选择？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-16T12:26:48.917

另一种选择是完全跳过 OCM 框架并简单地将`javax.jcr.Node`其用作非常灵活的 DAO 本身。OCM 框架存在的根本原因是，使用 RDBMS，您需要从对象到关系模型的映射。使用 JCR，它已经非常面向对象（节点 ~= 对象），这个根本原因就没有了。剩下的就是使用 DAO，您可以限制程序员可以在其代码中访问的内容（包括自动完成的帮助）。但是这种方法并没有真正利用 JCR 概念，这意味着*无模式和灵活的编程*。直接在您的代码中使用 JCR API 是遵循该概念的最佳方式。

想象一下，您想在应用程序生命周期的后期向现有节点/对象添加新属性——使用 OCM 框架，您还必须对其进行修改并确保它仍然正常工作。通过直接访问节点，它只是一个单点更改。我知道，这是解决例如拼写错误问题的好方法。属性名称；但是这种恐惧并没有真正得到现实的支持，因为在大多数情况下，当您测试您的应用程序时，您会很快注意到拼写错误或不匹配的名称。一个好的解决方案是为公共节点或属性名称使用字符串常量，即使您在它们之间公开 JCR API，也可以将其作为 API 的一部分。这仍然使您可以灵活地快速添加新属性，而无需采用 OCM 层。

为了对允许或强制（即“半模式”）有一些限制，您可以使用节点类型和混合（从 JCR 2.0 开始，您还可以更改现有内容的节点类型）：因此您可以完全处理这个在存储库级别，不必关心应用程序代码中的类型和约束——除了捕获异常;-)

但是，当然，这种选择取决于您的要求和个人喜好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-16T08:57:36.170

您可能想看看活生生的[Jackrabbit OCM](http://jackrabbit.apache.org/5-with-jackrabbit-ocm.html)。当然另一种方法是手动序列化/反序列化 POJO。为此，有许多不同的选择。问题是您是否需要修复模式来查询 JCR 中的对象。如果您只想序列化为 XML，那么[XStream](http://xstream.codehaus.org/)是一种非常轻松的方式。如果您需要更多修复模式，还有来自 Apache Commons的[Betwixt 。](http://commons.apache.org/betwixt/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-17T18:30:02.303

[在http://code.google.com/p/jcrom/](http://code.google.com/p/jcrom/)也有 JCROM 项目。该项目休眠了几年，但截至 2013 年夏天已经发布了一些新版本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-02T11:07:14.323

这取决于您的需求。当您直接使用 javax.jcr.node 时，这意味着您的代码与底层机制高度耦合。在中型甚至一些小型项目中，这不是一个好主意。显然，问题将是如何从 Node 转到您自己的域模型。这个问题与从 Jdbc ResultSet 到您自己的域模型非常相似。请注意，我的意思是从技术角度来看，问题是相似的。从功能的角度来看，使用 JDBC 和 JCR 之间存在巨大差异。

另一个决定因素是您是否可以在 JCR 内容中强加结构。一些应用程序域可以（但仍然比 JDBC 与 JCR 匹配得更好），在其他域中，内容本质上可能是高度非结构化的。在这种情况下，强迫症显然是矫枉过正的。我仍然建议围绕 javax.jcr.* 类编写自己的包装层。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-03T17:25:13.700

还有[https://github.com/ilikeorangutans/omf](https://github.com/ilikeorangutans/omf)，一个非常灵活的 JCR 映射器对象。不幸的是，它还没有写支持。然而，我们在大型 CMS 安装中成功地使用了这个框架。

# .net - .net 绘图：缩放笔的问题

> ID：370564
> 
> 赞同：4
> 
> 时间：2008-12-16T06:08:31.333
> 
> 标签：.net, system.drawing

系统绘图：

我找到了一个[帖子](http://groups.google.com/group/microsoft.public.test.here/browse_thread/thread/21b768eb66270b9d?hl=en&ie=UTF-8&q=Pen%20width%20scaletransform%20group:microsoft*#47964cfcad0d0bc8)（没有答案）很好地解释了我的问题。

我无法控制转换图形的笔宽度。它要么是 1 个像素，要么是 50 个左右。我不能在两者之间设置任何东西。一切看起来都不错，除了我想将笔宽设置为 1 到 6 像素。

```
// ScaleTransform pen to the reverse of the graphics transform. This works.
float scaleX = gridRectangle_logical.Width / gridRectangle_device.Width;
float scaleY = gridRectangle_logical.Height / gridRectangle_device.Height;

Pen pen = new Pen(Color.Black, 4); // problem here.
pen.ScaleTransform(scaleX, scaleY); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-03-13T06:09:32.983

我相信笔缩放有内部溢出。这是奇特的。尝试更改笔宽而不是 x 和 y；我认为你不能单独调整 x 和 y 没有任何问题。

另一种选择是转换坐标，然后在图形上不进行任何转换进行绘制。您无需使用钢笔缩放进行补偿。

# c# - 使用 C# 受密码保护的 PDF

> ID：370571
> 
> 赞同：17
> 
> 时间：2008-12-16T06:13:50.713
> 
> 标签：c#, pdf-generation

我在我的过程中使用 C# 代码创建一个 pdf 文档。我需要使用一些标准密码（如“123456”或某个帐号）来保护文档。我需要在没有任何参考 dll（如 pdf writer）的情况下执行此操作。

我正在使用 SQL Reporting Services 报告生成 PDF 文件。

有没有最简单的方法。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-12-16T10:14:52.647

> 我在我的过程中使用 C# 代码创建一个 pdf 文档

您是否使用某个库来创建此文档？[pdf 规范](http://www.adobe.com/devnet/acrobat/pdfs/PDF32000_2008.pdf)(8.6MB) 相当大，如果不使用第三方库，所有涉及 pdf 操作的任务都可能很困难。使用免费和开源的[itextsharp](http://itextsharp.sourceforge.net/)库对您的 pdf 文件进行密码保护和加密非常简单：

```
using (Stream input = new FileStream("test.pdf", FileMode.Open, FileAccess.Read, FileShare.Read))
using (Stream output = new FileStream("test_encrypted.pdf", FileMode.Create, FileAccess.Write, FileShare.None))
{
    PdfReader reader = new PdfReader(input);
    PdfEncryptor.Encrypt(reader, output, true, "secret", "secret", PdfWriter.ALLOW_PRINTING);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T18:52:36.113

如果不使用 PDF 库，将很难做到这一点。基本上，您需要自己开发这样的库。

在 PDF 库的帮助下，一切都变得简单多了。以下示例展示了如何使用[Docotic.Pdf 库](https://bitmiracle.com/pdf-library/)轻松保护文档：

```
public static void protectWithPassword(string input, string output)
{
    using (PdfDocument doc = new PdfDocument(input))
    {
        // set owner password (a password required to change permissions)
        doc.OwnerPassword = "pass";

        // set empty user password (this will allow anyone to
        // view document without need to enter password)
        doc.UserPassword = "";

        // setup encryption algorithm
        doc.Encryption = PdfEncryptionAlgorithm.Aes128Bit;

        // [optionally] setup permissions
        doc.Permissions.CopyContents = false;
        doc.Permissions.ExtractContents = false;

        doc.Save(output);
    }
} 
```

免责声明：我为图书馆的供应商工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-10T21:26:51.733

如果有人正在寻找 IText7 参考。

```
 private string password = "@d45235fewf";
    private const string pdfFile = @"C:\Temp\Old.pdf";
    private const string pdfFileOut = @"C:\Temp\New.pdf";

public void DecryptPdf()
{
        //Set reader properties and password
        ReaderProperties rp = new ReaderProperties();
        rp.SetPassword(new System.Text.UTF8Encoding().GetBytes(password));

        //Read the PDF and write to new pdf
        using (PdfReader reader = new PdfReader(pdfFile, rp))
        {
            reader.SetUnethicalReading(true);
            PdfDocument pdf = new PdfDocument(reader, new PdfWriter(pdfFileOut));
            pdf.GetFirstPage(); // Get at the very least the first page
        }               
} 
```

# sql - Sql 查询链接两个表

> ID：370578
> 
> 赞同：0
> 
> 时间：2008-12-16T06:20:30.683
> 
> 标签：sql, sql-server, sql-server-2005

MSSQL 中的一个疑问。一个数据库中有两个表。

表 1 命名属性包含字段 PRPT_Id(int)、PRPT_Name(varchar)、PRPT_Status(bit)

表 2 命名的 PropertyImages 包含字段 PIMG_Id(int)、PIMG_ImageName(varchar)、PRPT_Id(int)、PIMG_Status(bit)

这两个表遵循一对多的关系。这意味着每个属性可以有零个、一个或多个与之对应的 PropertyImage。

需要的是要显示的查询

PRPT_Id, PRPT_Name, ImageCount(一个PRPT_Id对应的所有图像的计数，其中PIMG_Status为真。o如果没有图像)，FirstImageName(如果有n张图像，则PRPT_Id对应的图像表中的第一张图像的名称与PIMG_Status true。如果没有任何图像，我们用空白/空白填充它）。另一个条件是 PRPT_Status 应该为真。

编辑说明 - 这两个表都具有自动递增的整数作为主键。所以第一个图像名称将是带有 MIN(PIMG_Id) 的名称，不是吗？

我想要结果集中与 MIN(PIMG_ID) 对应的 PIMG_ImageName

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-16T06:35:05.037

似乎您必须编写嵌套查询来显示您想要的内容。

如果是这种情况（我不是 SQL 专家），我建议您从最里面的查询开始，然后您一直走到最外面的（也是最终的）查询。

首先，您必须检索 PIMG 并按 PRPT 对它们进行分组。

```
SELECT PRPT_Id, COUNT(PIMG_Id) AS PRPT_ImageCount, MIN(PIMG_Id) AS PRPT_MinImage
FROM PropertyImages
GROUP BY PRPT_Id 
```

这将检索具有关联图像的属性的 PRPT_Id。但是，对于没有任何关联图像的属性，您不会得到任何结果。

之后，我们将左连接属性表与上一个查询。左连接确保将检索所有属性，即使它们没有出现在正确查询的结果中（也就是说，即使它们没有任何关联的图像）。

```
SELECT Properties.*, PRPT_ImageCount, PRPT_MinImage
FROM Properties LEFT JOIN (
SELECT PRPT_Id, COUNT(PIMG_Id) AS PRPT_ImageCount, MIN(PIMG_Id) AS PRPT_MinImage
FROM PropertyImages
GROUP BY PRPT_Id ) Temp ON ( Properties.PRPT_Id = Temp.PRPT_Id ) 
```

我希望我的 SQL 没有错，并且这篇文章对您有所帮助。

问候，

* * *

编辑：

```
SELECT Properties.*,
       PRPT_ImageCount,
       PRPT_MinImage,
       PIMG_ImageName
FROM ( Properties LEFT JOIN
       ( SELECT PRPT_Id,
                COUNT(PIMG_Id) AS PRPT_ImageCount,
                MIN(PIMG_Id) AS PRPT_MinImage
         FROM PropertyImages
         GROUP BY PRPT_Id ) Temp1
       ON ( Properties.PRPT_Id = Temp1.PRPT_Id ) ) Temp2 LEFT JOIN
     PropertyImages ON ( PropertyImages.PIMG_Id = Temp2.PRPT_MinImage ) 
```

现在，我真的不确定我的 SQL。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-16T06:55:09.070

假设 FirstImage 表示具有最低 Id 的那个，那么这应该至少足够接近以测试完成：

> SELECT
> PRPT_Id,
> PRPT_Name,
> ISNULL(pi1.ImageName, '') AS FirstImageName,
> COUNT(1) AS ImageCount
> 
> FROM 属性 AS p
> 
> 左连接 PropertyImages AS pi
> ON p.PRPT_Id = pi.PRPT_Id
> 
> 左连接 PropertyImage AS pi1
> ON p.PRPT_Id = pi1.PRPT_Id
> 
> 左连接 PropertyImgage AS pi2
> ON p.PRPT_Id = pi2.PRPT_Id
> AND pi1.PIMG_Id > pi2.PIMG_Id
> 
> 其中 PRPT_Status = TRUE
> 且 pi1.PIMG_Status = TRUE
> 且 pi2.PIMG_ImageName 为 NULL

双 LEFT JOIN 确保您获得 pi1 中的第一个图像记录。如果“第一”规则不同，则相应地调整此连接。

这应该尽可能高效。它没有子查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T06:42:39.127

> 与 PIMG_Status 为 true 的 PRPT_Id 对应的图像表中第一张图像的名称

您可能希望在此上下文中定义“第一”。表格并没有真正排序，除非您保持自己的顺序，否则“首先”一词需要表示“找到的第一个”。

假设以上是真的（你想要第一个找到的图像），那么这是查询中唯一真正困难的部分（以及之前让我绊倒的事情的类型）。其余的似乎相当直截了当。如果我明天能找到时间，我会尝试为您整理一些东西......但似乎其他人能够在此之前提供答案。

# c# - 如果 cookie 被禁用，那么如何在 C# .net 中保留数据

> ID：370581
> 
> 赞同：0
> 
> 时间：2008-12-16T06:23:07.370
> 
> 标签：c#, asp.net-3.5

如果在浏览器中禁用了cookies，那么我们如何在用户下次登录时保留数据。例如对于登录页面如何保留用户名是cookies被禁用了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-16T07:16:07.593

您可以使用无 cookie 会话来存储会话数据。此函数将会话 ID 嵌入 url 而不是 cookie 中。

此外，您可以使用 Asp.net Profile 属性来存储用户的配置文件数据。配置文件与用户一起存储，并且可以在用户登录时检索。

它很容易使用：

*   首先，您在 web.config 文件中配置您的配置文件属性
*   然后在适当的地方设置配置文件属性，例如当用户更改其设置时。这是使用静态 Profile 类完成的。它具有您添加的所有配置文件属性的成员属性。
*   最后，您可以在需要时通过读取属性来读取配置文件属性。
*   不需要保存或加载 - 这是由 asp.net 在用户登录和注销时自动完成的。

检查 MSDN 库并搜索 Profile Properties 或[查看此处](http://msdn.microsoft.com/en-us/library/2y3fs9xs.aspx)。

你应该注意的一件事。默认配置文件属性提供程序会将所有配置文件值存储在表的一列中。此列包含堆叠在一起形成字符串的所有值。在某些情况下，这是可以的，因为这是一种简单有效的数据存储方式，但您可能希望编写自己的配置文件提供程序，以更合适的方式存储数据。

# c++ - C++ const_cast 使用而不是 C 风格的强制转换

> ID：370586
> 
> 赞同：9
> 
> 时间：2008-12-16T06:30:14.783
> 
> 标签：c++, const-cast

为什么会出现以下情况？：

```
 const int i0 = 5;
//int       i1 = const_cast<int>(i0);       // compilation error
  int       i2 = (int)i0;                   // okay

  int       i3 = 5;
//const int i4 = const_cast<const int>(i3); // compilation error
  const int i5 = (const int)i3;             // okay 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-16T06:36:12.103

```
 const int i0 = 5;
//int       i1 = const_cast<int>(i0);       // compilation error
  int       i2 = (int)i0;                   // okay

  int       i3 = 5;
//const int i4 = const_cast<const int>(i3); // compilation error
  const int i5 = (const int)i3;             // okay 
```

编译错误是因为您没有将 const 丢弃/添加 const。相反，您复制 i0。对于该操作，根本不需要强制转换：

```
int i1 = i0;
const int i4 = i3; 
```

您转换为的类型实际上应该是指针或引用。否则，使用 const_cast 没有意义，因为您可以直接复制它。例如，对于指针，您可以抛弃 const，因为取消引用指针会为 a `const T*`(yields `const T`) 产生另一种类型，而不是 a `T*`(yields `T`)。对于引用，同样如此：`T&`将使用另一种*this*指针类型而不是使用`const T&`. 现在您真正想要归档的内容：

```
 const int i0 = 5;
//int &     i1 = const_cast<int&>(i0);      // okay (but dangerous)
  int &     i2 = (int&)i0;                  // okay (but dangerous)

  int       i3 = 5;
//const int&i4 = const_cast<const int&>(i3); // ok now and valid!
  const int&i5 = (const int&)i3;             // okay too! 
```

以上可能导致未定义的行为，当您通过对非 const 的引用写入原始 const 对象时（实际上，仅转换和读取它本身并不是未定义的行为。但是如果您要丢弃 const，您可能也写入它，然后产生未定义的行为）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-16T07:01:08.887

这是一个错误，因为标准说这是不允许的。该标准列举了`const_cast`允许进行的转换类型，并且不允许任何不在列表中的转换。它允许以下操作：

*   指针
*   参考
*   成员指针

由于您的类型不是其中任何一种，因此它们是不允许的。

从好的方面来说，您提供的示例也不*需要* `const_cast`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T06:35:43.680

对于第一个错误。const_cast 只能用于指针或引用类型。“int”两者都不是。这可能是也可能不是 C++ 标准（找不到好的参考）。但是对于某些实现，例如 MS 的 C++ 编译器，情况就是如此。

对于第二个错误。const_cast 只能用于删除 const 或 volatile 限定符，不能添加它。

参考： http: [//msdn.microsoft.com/en-us/library/bz6at95h (VS.80).aspx](http://msdn.microsoft.com/en-us/library/bz6at95h(VS.80).aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-07-19T19:48:31.050

根据[CPP Reference](https://en.cppreference.com/w/cpp/language/const_cast)，结果必须是指针或引用。使用指针时，输入也需要是指针。对于引用，您可以将变量作为输入，并将引用作为输出。该页面说：

> 任何类型 T 的左值都可以转换为对相同类型 T 的左值或右值引用，或多或少是 cv 限定的。同样，类类型的纯右值或任何类型的 xvalue 都可以转换为或多或少有 cv 限定的右值引用。

意义

```
/* lvalue can be converted to lvalue or rvalue references  */
int& test1 = const_cast<int&>(var);   // lvalue to l-ref; same works for class type
int&& test2 = const_cast<int&&>(var); // lvalue to r-ref; same works for class type
/* prvalues: restriction on built-in types to allow some compiler optimization */
//int&& test5 = const_cast<int&&>(1);            // prvalue of built-in not allowed
A&& test6 = const_cast<A&&>(A());                // prvalue of class type allowed
/* xvalue can be converted to rvalue references */
int&& test8 = const_cast<int&&>(std::move(var)); //xvalue of built-in
A&& test8 = const_cast<A&&>(std::move(A()));     // xvalue of class 
```

# asp.net-mvc - 在 ASP.NET MVC 中管理 ADO.NET 实体框架 ObjectContext

> ID：370595
> 
> 赞同：9
> 
> 时间：2008-12-16T06:43:08.110
> 
> 标签：asp.net-mvc, multithreading, entity-framework

我在 MVC 应用程序中使用 ADO.NET EF。我正在考虑将 ObjectContext 放在 HttpContext.Current 中，以便同一请求中的所有逻辑都可以访问它，而不必每次都打开/销毁。但是，我很确定这是否是管理 ObjectContext 实例的好方法。关于这个需求，我有两个问题：

1.  由于 HttpContext.Current 属性由线程本地字段支持并且 ASP.NET 使用池中的线程来处理请求，因此请求放入 HttpContext.Current 的 ObjectContext 实例是否可能对在池中的同一个线程？

2.  您认为应该如何在 ASP.NET MVC 中管理 ObjectContext 以避免大量打开/处理并防止竞争条件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-16T20:33:18.623

使用[存储库模式](http://www.asp.net/learn/mvc/tutorial-10-cs.aspx)。重写 Controller.Dispose 以处置 Repository，而后者又处置 DataContext。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-16T07:37:46.020

我会使用一个 IoC 容器，比如 StructureMap、Autofac、Windosor 等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T18:08:39.270

每个请求使用一个 ObjectContext 是个好主意。

如果您自己处理它，则需要将上下文放在 HttpContext.Items 集合中。在 EndRequest 上，您需要确保释放上下文。

如前所述，一些 IoC 框架支持此 OTB - 通常称为 PerRequest 范围/生命周期。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-16T08:19:57.900

我同意 Todd - 使用具有每个线程（或自定义每个请求）生命周期的 DI/IoC 组合（Unity，Windsor）。

广告 2，我记得在 Linq to SQL 中，DataContext 对象被认为是轻量级对象，因此经常创建它应该不是问题。希望它与 EF 类似。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-17T06:31:53.017

感谢国际奥委会的建议。我使用 Unity 并实现了一个按请求生命周期管理器来通过 HttpContext.Current 存储/检索对象。似乎工作正常。

# javascript - SproutCore 和卡布奇诺

> ID：370598
> 
> 赞同：24
> 
> 时间：2008-12-16T06:48:48.177
> 
> 标签：javascript, model-view-controller, frameworks, cappuccino, sproutcore

我即将构建一个网络应用程序，我想使用 SproutCore 或 Cappuccino。唯一的问题是，我无法弄清楚该使用哪个...

我一直在阅读它们，它们似乎具有相同的目标（客户端上的 MVC，带有瘦 REST 服务器）。我知道它们的实现方式不同（Obj-C 与 JS），但我在量化差异和权衡它们时遇到了很多麻烦。

我可以得到一些帮助来解决这个困境吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-17T10:23:43.610

Dilemma indeed it is.

I personally took a chance on Cappuccino, but that is because I'm currently involved in objective-c and having the theoretical possibility to plug my code (with some adjustments) into a javascript/web environment - is tempting.

Anyway, if are you doing cocoa development, you will be up and running in a matter of hours, but I'm sure you've already figured that out by yourself.

You will (in Cappuccino) have a very nice abstraction to work with. I think that matters.

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-18T16:18:50.757

这实际上并没有那么大的两难境地。它归结为一个简单的问题：

你有使用 Cocoa (Objective-C) 的经验吗？（或者，您是否计划通过为 OS X 或 iPhone 开发来大量使用 Objective-C？）

如果是这样，请选择卡布奇诺。如果没有，请选择 SproutCore。

没有理由从一开始就尝试学习 Objective-C，同时学习 Web 应用程序和新框架的所有怪癖和新颖性，从而使您的项目落后。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-18T16:03:02.910

这两个项目的级别文档令人震惊。

但是，由于 Apple 现在支持 SproutCore，而且 Apple 非常擅长提供良好的文档，我希望这种情况会有所改变。

但是，Cap 有一个已发布的真实世界应用程序 (280Slides)，您可以通过它来了解*应该*如何构建应用程序。因此，此时可能更容易开始使用 Cap，尤其是因为您知道 Objective-c。

请注意，对于这两个项目，现成控件的数量非常有限，因此您会发现自己实现了自己的控件。此外，默认情况下，SproutCore 很丑！

就个人而言，我认为 Cap 方法非常出色。

您不需要编写任何 HTML 或 CSS。感觉就像您正在编写一个桌面应用程序，并且通过在 Objective-js 中进行编码，您本质上是从浏览器中抽象出来的。

但是，我不喜欢这种语言本身。如果他们坚持使用 pov JavaScript，我会更喜欢它。

我知道 Mac 开发人员会喜欢您使用 Cap 创建的代码的潜在可移植性，但是自从 Apple 在 2012 年破产以来，我真的不明白这一点:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-17T23:11:00.753

是的...我觉得如果我使用 SproutCore，我将不得不花更多时间学习 Javascript 的怪癖，而不是 Objective-J。

既然您已经在 Obj-J 中度过了一段时间……它与 Obj-C 有多接近，与 Javascript 有何不同？（我问你是因为我想要某人的真实经历......不是维基所说的:)）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-28T21:34:57.557

我都试过了，我必须承认两者都需要更多改进。只是为了补充我的观点：

芽核

*   优点：
    *   标准 JS/CSS/HTML 网页开发
    *   由苹果赞助，未来可能会更好
*   缺点：
    *   糟糕的文档
    *   与卡布奇诺相比没有那么多抽象

卡布奇诺

*   优点：
    *   Objective-J（不涉及网络技术，没有 CSS ......）
    *   完全抽象
*   缺点：
    *   糟糕的文档
    *   需要学习Objective-J（没那么难）
    *   Objective-J 的布局很糟糕！

# java - 用 Class 替换 Class以避免警告是一种好习惯吗？

> ID：370601
> 
> 赞同：9
> 
> 时间：2008-12-16T06:52:35.860
> 
> 标签：java, generics, warnings, raw-types

在我的代码中的很多地方，我有这样的东西：

```
public Class mySpecialMethod() {
  return MySpecialClass.class;
} 
```

导致警告

> 类是原始类型。对泛型 Class 的引用应该被参数化。

但是，如果我更换

`Class`

和

`Class<? extends Object>`

警告消失。

这种简单的做法可以吗，还是以后会造成麻烦？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-16T08:08:56.580

It's the correct thing to do only if there really is no common base class or interface that the Class object needs to represent.

Also `Class<?>` is effectively the same as `Class<? extends Object>`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-16T07:05:19.657

是的，完全正确。

您需要指定类型。如果不能，则必须指定通配符。

进一步阅读：[Java 语言规范：参数化类型](http://java.sun.com/docs/books/jls/third_edition/html/typesValues.html#4.5.1)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-16T07:47:26.670

根据您想要实现的目标，您可以更加精确：

```
public Class<MySpecialClass> mySpecialMethod() {
  return MySpecialClass.class;
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-16T08:05:53.903

这里不是真正的 Java 程序员，但阅读了一些关于泛型的好论文。

是的，您应该添加一些通配符或确切的类型 ( `Class<MySpecialClass>`) 以增加安全性。原因是 Class 是泛型的。因此，在擦除它们的泛型类型参数之后是相同的`Class<Bar>`。`Class<Foo>`它们都变成`Class`了，所谓的原始类型。编译时会发生这种擦除。一些示例来说明这一点，其中编译器可以帮助您进行自动转换（为简洁起见，省略了异常处理）：

```
class Mine { }

class Vara {
    public static void main(String... args) {
        { // works. translated to Mine m = (Mine) c.newInstance();
            Class<Mine> c = Mine.class;
            Mine m = c.newInstance();
        }
        { // doesn't work. need a cast: Mine m = (Mine) c.newInstance();
            Class c = Mine.class; // also Class<?> or Class<? extends Object>
            Object o = c.newInstance(); // but this works. pointing to a Mine
            Mine m = (Mine) c.newInstance(); // needs a manual cast
        }
    }
} 
```

Saying `Class<?>` (and the equivalent `Class<? extends Object>`), you tell the compiler you really wanted a Class whose `T` is Object, and didn't accidentally used the raw type. But it won't add any convenience casts. All that generics do is to insert automatic casts for you, to cast from `Object` to the destination type. Generics are the same whether used with type U or with type T at runtime for compatibility reasons with older java versions.

# c# - DatagridView + 自定义对象绑定

> ID：370602
> 
> 赞同：1
> 
> 时间：2008-12-16T06:53:32.067
> 
> 标签：c#, bindinglist

我在 .NET 3.5 中有一个 datagridview 需要显示以下列：

ID，姓名，ID2，姓名2

此 datagridview 绑定如下：

```
BindingList<Class1> source = new BindingList<Class1>();
source.Add(new Class1 { ID = "1", Name = "Test", Class2Ref = new Class2 { ID2 = "Class2 ID" , Name2 = "Class2 Name"} });
dataGridView1.DataSource = source;

public class Class1
{
    public string ID
    {
        get;
        set;
    }

    public string Name
    {
        get;
        set;
    }

    public Class2 Class2Ref
    {
        get;
        set;
    }
}

public class Class2
{
    public string ID2
    {
        get;
        set;
    }

    public string Name2 
    { 
        get; 
        set; 
    }
} 
```

问题是 ID2 和 Name2 在 datagridview 中没有显示任何值。我在设计时在 Datagridview 中创建了列，对应于 ID2 和 Name2 的列已被分配数据属性为：Class2Ref.ID2 和 Class2Ref.Name2

看，在 UI 端，ID2 和 Name2 是 Class1 还是 Class2 的属性对用户来说并不重要，但在实体设计级别，它确实有所作为。请告诉我如何在 Datagrid 中显示 2 个属性，这些属性不能直接在类中使用，而是通过参考。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-16T19:50:11.517

您可能会看到这是否对您有用（对我有用）：

```
<%@ Page Language="C#" AutoEventWireup="true"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<script runat="server">
    public class Class1
    {
        public string ID { get; set; }
        public string Name { get; set; }
        public Class2 Class2Ref { get; set; }
    }

    public class Class2
    {
        public string ID2 { get; set; }
        public string Name2 { get; set; }
    }

    void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
            myGrid.DataSource = new[] 
            { 
                new Class1() 
                {
                    ID = "1",
                    Name = "Name1",
                    Class2Ref = new Class2() 
                    {
                        ID2 = "IDRef1",
                        Name2 = "NameRef1"
                    }
                },
                new Class1() 
                {
                    ID = "2",
                    Name = "Name2",
                    Class2Ref = new Class2() 
                    {
                        ID2 = "IDRef2",
                        Name2 = "NameRef2"
                    }
                }
            };
            myGrid.DataBind();
        }
    }
</script>
<html xmlns="http://www.w3.org/1999/xhtml" >
<head id="Head1" runat="server">
    <title>Untitled Page</title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:DataGrid runat="server" ID="myGrid" AutoGenerateColumns="false">
            <Columns>
                <asp:TemplateColumn>
                    <HeaderTemplate>
                        ID
                    </HeaderTemplate>
                    <ItemTemplate>
                        <%# Eval("ID") %>
                    </ItemTemplate>
                </asp:TemplateColumn>
                <asp:TemplateColumn>
                    <HeaderTemplate>
                        Name
                    </HeaderTemplate>
                    <ItemTemplate>
                        <%# Eval("Name") %>
                    </ItemTemplate>
                </asp:TemplateColumn>
                <asp:TemplateColumn>
                    <HeaderTemplate>
                        ID2
                    </HeaderTemplate>
                    <ItemTemplate>
                        <%# Eval("Class2Ref.ID2") %>
                    </ItemTemplate>
                </asp:TemplateColumn>
                <asp:TemplateColumn>
                    <HeaderTemplate>
                        Name2
                    </HeaderTemplate>
                    <ItemTemplate>
                        <%# Eval("Class2Ref.Name2") %>
                    </ItemTemplate>
                </asp:TemplateColumn>
            </Columns>
        </asp:DataGrid>
    </div>
    </form>
</body>
</html> 
```

# asp.net - 如何将mdb导入sql server

> ID：370619
> 
> 赞同：15
> 
> 时间：2008-12-16T07:07:05.770
> 
> 标签：asp.net, sql-server, vb.net, ms-access

我有一个VB应用程序。现在我在 Asp.net 中开发了相同的 vb 应用程序。在 vb 中，我使用了 MSAccess 数据库。在 asp.net 中，我使用的是 Sql 服务器。现在我想将 MSaccess 数据库数据移动或复制到 Sql 服务器中。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-16T15:35:52.530

打开您的 MS Access 数据库，转到工具/数据库实用程序/升迁向导。你完成了。

只需按照向导的步骤操作，确保您拥有 SQL 服务器的管理权限，使用集成帮助检查您的所有步骤，以了解详细的表/索引/规则升迁。

由于无法导入 SQL 的特定 Access/Jet 配置，某些数据库不会轻易升迁。[该公司](http://www.ssw.com.au)有一个小模块来检查此类问题，并且可能还会[在这里](http://www.ssw.com.au/ssw/UpsizingPRO)提出自己的升迁向导。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-16T07:15:55.940

Microsoft Access，如果我记得有一个 Sql 升迁向导，至少 2k7 有，以前的版本可能也有。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-16T07:25:52.080

您还可以直接使用 SQL Server 将 Access MDB 文件导入 SQL Server 数据库。在 SQL Server 2000 中，这是使用 DTS 完成的。在 SQL Server 2005/2008 中，这是通过 SSIS 完成的。

看看这里的教程：

[http://www.accelebrate.com/sql_training/ssis_tutorial.htm](http://www.accelebrate.com/sql_training/ssis_tutorial.htm)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-16T15:39:32.193

如果您有一个与 MS Access DB 的现有 ODBC 连接，那么您可以创建一个 sql 2005 数据库，右键单击并选择 Import（在 Management Studio 中）并运行导入向导，将数据源指向 MS Access 数据连接。

希望这可以帮助。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-06-19T08:55:53.950

您可以使用 SQL 服务器中的导入向导。选择源作为 MDB，选择目标作为 SQL 服务器。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-09-11T01:35:31.380

Access 2007 中的升迁向导不适用于我使用 SQL Server 2008 Express SP1，但这个工具（经过一个非常烦人的安装过程）运行良好：

[http://www.microsoft.com/downloads/details.aspx?FamilyID=133b59c2-c89c-4641-bebb-6d04476ec1ba&DisplayLang=en](http://www.microsoft.com/downloads/details.aspx?FamilyID=133b59c2-c89c-4641-bebb-6d04476ec1ba&DisplayLang=en)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-02-05T08:31:41.467

我认为问题在于表格中的数据，而不是表格中的数据。所有表可能都有主键。所以下一次运行，由于主键违规，包失败了。在每次转储之前，使用ctrl流程中的“执行sql任务”删除现有sql server中的条目。

if (table exits) then delete * from table

# gmail - 如何阻止 Gmail 将我的网络应用程序发送的邮件标记为垃圾邮件？

> ID：370620
> 
> 赞同：24
> 
> 时间：2008-12-16T07:07:07.687
> 
> 标签：gmail, spam

我有一个提供日常财务数据的简单 Web 应用程序。用户订阅，我们每天向他们发送一封电子邮件。但是，Gmail 将我们所有的电子邮件标记为垃圾邮件。我们应该注意什么？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-12-16T07:15:01.730

首先，为了避免垃圾邮件引擎将您的邮件分类为垃圾邮件，您应该：

*   确保它们不是垃圾邮件（即确保只有真正选择加入的用户才能收到邮件 - 确保保留选择加入的审核日志）
*   确保它们看起来不太像垃圾邮件 - $$$ MAKE MONEY FAST 不是一个好的主题行
*   确保发件人地址没有被欺骗并且看起来没有被欺骗。使用您有权发送的域（如果您愿意，请添加有效的 SPF 记录）
*   不要做任何看起来像恶意软件的事情（例如，包含脚本、表单、flash 等的 HTML 电子邮件）

但总的来说，主要的是：

*   不要从以发送垃圾邮件而闻名的 IP 地址发送它们。

最后一点意味着您不能使用共享主机。几乎所有共享主机提供商都允许发送不符合上述任何一项的邮件。共享主机提供商的中继几乎总是在许多黑名单上。

只需在您的共享主机上安装一个易受攻击的 Web 应用程序，它就会变成垃圾邮件网关——这是您无法承受的。

编辑：哦，是的 - 如果您没有设置信封发件人，您的托管服务提供商可能会将其设置为愚蠢的 - 确保您将其设置为与 From 相同： - 这可以确保您的邮件不被看到被欺骗

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-12-16T12:15:00.187

*   阅读[Google 的批量发送指南](https://support.google.com/mail/answer/81126?hl=en)。
*   尝试使用[Domain Keys Identified Mail](http://en.wikipedia.org/wiki/DomainKeys_Identified_Mail)或[Domain Keys](http://en.wikipedia.org/wiki/DomainKeys)，其密钥至少为 1024 位。
*   确保您的邮件主机是有效的 A 记录，而不是 CNAME。
*   确保您的 MX 记录设置为邮件主机的完整主机名（设置为 A 记录）。
*   为您的邮件主机使用一致的 IP 地址。
*   确保您可以反向查找邮件主机的 IP 地址。这对于设置 SPF/发件人 ID 记录非常重要。
*   将[SPF/SenderID 信息设置为 TXT 记录](http://www.zytrax.com/books/dns/ch9/spf.html)。
*   配置完所有内容后，您应该[对其进行验证](http://www.dnsstuff.com/)。在联系 Gmail 支持之前，请确保没有警告或错误。
*   正如 Tiberu 所说，使用 Spam Assassin 测试您的电子邮件。从您的应用程序向自己发送一封电子邮件，并将原始消息（包括标题）复制到文本文件并针对 Spam Assassin 的命令行测试运行它。
*   如果您发送纯文本电子邮件，请确保将 Content-Type 标头中的字符集设置为 ISO-8859-1。Gmail 似乎对此非常讲究。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-16T07:12:02.437

这是当今许多发送自动电子邮件的公司面临的一个常见问题，即过分热心的垃圾邮件过滤器。我看到我的经纪公司和银行只是在每封电子邮件的开头都写着“请将'yourstatement@bank.com'添加到您的安全发件人列表中。” 请记住，这家经纪公司和银行可能拥有大量的开发人员，但仍然会提醒人类收件人：) 大多数垃圾邮件过滤器都是基于贝叶斯算法的，他们永远不会 100% 正确。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-16T07:35:39.550

您还可以查看[SpamAssassin 执行的测试](http://spamassassin.apache.org/tests_3_2_x.html)。当然，这不是 Gmail 使用的（或者谁知道？），但您会感觉到可能使您成为垃圾邮件的那种东西。

归根结底，你仍在打一场失败的战斗——没有确定的方法可以摆脱垃圾邮件箱（垃圾邮件发送者会喜欢的，呵呵），因为一个人的财务数据可能是另一个人的垃圾邮件。请务必向您的用户发出警告，并让**他们**担心他们的电子邮件解决方案会将其标记为垃圾邮件，因为他们是唯一真正可以对此做些什么的人。

编辑：好吧，我的印象是 SPF 在这种情况下实际上会有所帮助，但似乎并非如此。一定要使用 SPF，但它不会帮助您通过垃圾邮件过滤器。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-04T17:34:47.207

我建议阅读 Google 的[批量发件人指南](https://support.google.com/mail/bin/answer.py?hl=en&answer=81126)，它提供了许多避免邮件被标记为垃圾邮件的建议。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-27T07:46:06.213

为什么不在注册表单上写一些类似的东西。

> 一些电子邮件提供商可能会自动将电子邮件标记为垃圾邮件。所有自动电子邮件都将从 dailyupdate@mysite.com 发送，请将其添加到您的安全列表中

无论您做什么，您的电子邮件都可能会被标记为垃圾邮件，因为我有来自大型公司的电子邮件在响应 ID 提出的支持请求时直接进入垃圾邮件箱。因此，最好确保您的用户为这种可能性做好准备。

# c++ - 在 Linux 中调试 C++ 程序

> ID：370622
> 
> 赞同：23
> 
> 时间：2008-12-16T07:08:22.070
> 
> 标签：c++, linux, debugging

我编写了一个简单的 C++ 程序，如下所示：

```
#include <iostream>
using namespace std;
int main()
{
    cout << "Hello.";
    return 0;
} 
```

现在我想调试它。那么它的命令是什么，所以我的控制权转到每一行？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-12-16T07:10:34.513

您可以[`gdb`](http://www.gnu.org/software/gdb/)为此使用：

```
$ gdb hello 
```

这将开始`gdb`并提示您下一步该做什么。该`next`命令执行一行源代码并在下一行停止。

我找到了一个可能有用的基本[GDB 教程。](http://www.cs.cmu.edu/~gilpin/tutorial/)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-12-16T07:20:15.523

不要忘记使用 -g 选项编译源代码。像这样：`g++ -g helloWorld.cc` 这将创建一个 a.out 可执行文件。您将能够使用`gdb ./a.out`命令调试您的 a.out exe。您可能会使用的另一个工具是[ddd](http://www.gnu.org/software/ddd/) ，它基本上是 gdb 的 GUI。

祝你好运

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-16T10:42:15.773

我一直认为***emacs***为gdb提供了一个非常用户友好的前端......

例如

*   % g++ 你好.cc -g -o 你好
*   emacs 你好.cc
*   [*在 Emacs*中] Escape-x gdb
*   Emacs 会说“运行 gdb（像这样）：gdb”。
*   添加您的二进制名称（“hello”）。（例如“运行 gdb（像这样）：gdb hello”。）
*   转到您的 hello.cc 缓冲区。
*   使用 emacs 命令 'gud-break' 从 hello.cc 缓冲区在 gdb 中设置断点。（通常绑定到“Cx 空间”。）
*   转到您的 *gud-hello* 缓冲区。
*   在 (gdb) 提示符下键入“运行”。
*   使用 [ **N** ] 下一步或 [ **S** ] 步骤。或 [ **C** ] 继续。[ **BT** ] 回溯也很有用。
*   请注意 hello.cc 缓冲区最左侧列中的小三角形发生了什么。

（这应该足以让你开始。Emacs 是 Emacs，总是有更多的功能......）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-16T17:46:01.487

在我在瑞典完成的 C++ 编程课程中，有一部分是关于 GNU 调试器的实验室。之后我再也没有使用过它，但是[这里](http://www.cs.lth.se/EDA031/laborationer/laboratoryexercises.pdf)有一篇解释基本用法的论文，据我所知，在第 2 章。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-16T08:07:45.927

如果你想要一些用户友好的调试器，你可以使用 Kdbg，它基本上是 KDE 的 gdb 前端。也许没有 ddd 强大，但更容易上手。

# c# - 在 C# 中保存数据结构

> ID：370624
> 
> 赞同：12
> 
> 时间：2008-12-16T07:08:47.873
> 
> 标签：c#, serialization

我正在通过编写一个家庭图书馆管理器来学习 C#。

我有一个 BookController，它将书籍存储在数据结构中并对它们执行操作。

C# 是否有办法将字典中的数据保存到本地文件，可能以 XML 方式稍后加载，还是我必须自己编写？

保存和加载 C# 可用的这些数据的最佳方法是什么？只需要指出一个好的方向。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-12-16T07:49:42.453

实际上，C#（语言）对序列化**一无所知**，但 .NET（框架）提供了很多方法…… `XmlSerializer`、、`BinaryFormatter`（ . `DataContractSerializer`NET 3.0）——或者也有一些定制的序列化框架。

使用哪个取决于您的要求；`BinaryFormatter`使用简单，但会将程序集元数据信息刻录到文件中 - 使其不可移植（例如，您无法在 Java 中打开它）。`XmlSerializer`并且`DataContractSerializer`主要是基于 xml 的，使其非常便携，但除非你压缩它，否则它相当大。

一些专有的序列化器介于两者之间。[protobuf-net](http://code.google.com/p/protobuf-net/)是一种二进制格式化程序（数据非常密集），但它遵循数据格式的可移植标准（Google 的协议缓冲区规范）。这是否有用取决于您的方案。

典型代码（这里使用`XmlSerializer`）：

```
 XmlSerializer ser = new XmlSerializer(typeof(Foo));
        // write
        using (var stream = File.Create("foo.xml"))
        {
            ser.Serialize(stream, foo); // your instance
        }
        // read
        using (var stream = File.OpenRead("foo.xml"))
        {
            Foo newFoo = (Foo)ser.Deserialize(stream);
        } 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-16T07:12:19.910

查看[序列化](http://www.codeproject.com/KB/cs/objserial.aspx)和[ISerializable 接口](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.iserializable.aspx)

它允许您以可移植的形式保存对象的状态。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-16T07:41:29.693

如果您希望数据采用 XML 格式，则可以使用[XmlSerializer](http://msdn.microsoft.com/en-us/library/ms950721.aspx)。

编辑：出于某种原因，我因为 XmlSerializer 无法序列化字典而被否决。

要解决此问题，您始终可以像[这样自定义序列化过程](http://www.sitepoint.com/blogs/2006/07/09/generic-dictionaries-vs-the-xmlserializer/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-16T08:28:40.113

您还应该考虑使用 Linq to SQL（或实体框架）进行 O/R 映射并将数据存储到数据库（SQL CE、SQL Express）中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-16T08:35:16.433

我创建了一个扩展方法，它接受一个对象并为你创建一个 xml 字符串，你需要做的就是从文件中保存/加载。 [Xml序列化](https://stackoverflow.com/questions/271398/post-your-extension-goodies-for-c-net-codeplexcomextensionoverflow#271423)

# xml - 网络标记和 XML+XSL

> ID：370632
> 
> 赞同：2
> 
> 时间：2008-12-16T07:13:16.613
> 
> 标签：xml, internet-explorer, mark-of-the-web

是否可以在由本地 XSL 文件解析的 XML 文件中使用 Web 标记？

当我插入 MOTW 标记时：

```
<!-- saved from url=(0014)about:internet --> 
```

我收到以下消息：
访问被拒绝。错误处理资源。

* * *

好的，我看到我试图做错了 - 我想将此注释插入 XML。

我有三个文件：带有数据的 XML，将数据转换为 html 的 XSL，以及带有 JavaScript 函数的 JS 文件。正如你所说，我想摆脱 Internet Explorer 橙色条。

将所有内容放在 IIS 或 Apache 上是个好方法，但我想在本地打开这些文件。

我试图插入 xml:comment 标记，但什么也没发生（该栏仍在显示）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-16T07:32:20.680

从它的外观 - 不。MOTW 在这里强制“Internet”区域在整个过程中，因此访问本地资源是不受限制的。您收到的错误消息表达了这一事实。

如果*测试*您的页面是您尝试做的事情，那么您将不得不从 Web 服务器获取它以及 XSL。您机器上的 IIS，通过“http:/localhost/...”访问就足够了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T07:27:20.043

我尝试了从 url=(0014)about:internet </xsl:comment> 保存的 <xsl:comment> 的几种变体。MOTW 只是不适用于通过 XSLT 生成的页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T20:16:00.950

添加 MOTW（网络标记）只会在使用 JavaScript 加载本地页面时帮助您看不到愚蠢的黄色警告栏。（AFAIK）

如果这是你的意图，你能不能只使用：

```
<xsl:comment> saved from url=(0014)about:internet </xsl:comment> 
```

作为 DOCTYPE / html 标记之前的输出。

# objective-c - 计算连接/下载速度

> ID：370641
> 
> 赞同：11
> 
> 时间：2008-12-16T07:20:14.043
> 
> 标签：objective-c, cocoa

我有一个客户端和服务器程序（都在 Obj-C 中），我正在使用这些程序在两个设备之间传输文件。

传输工作正常，但我想向用户显示他们获得的传输速率。

所以我知道文件的总大小，以及已经传输了多少文件，有没有办法从这些信息中计算出传输率，如果没有，我需要什么信息来计算传输率？

谢谢

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-12-16T21:12:10.727

天真的方法是`bytes_downloaded / (now - start_time)`，但是如果连接速度波动很大，或者如果用户在下载过程中开始另一个下载（可能在另一个应用程序中），这将变得不准确。如果用户在后台运行 torrent，这两种情况都可能发生。

一种更好的方法（尽管更难实现）是保留一组周期性样本并呈现平均值。

从一个包含 0 的数组开始。该数组包含样本，每个样本是自上一个样本以来下载的字节数。然后开始下载。

每半秒（你可以尝试不同的时间间隔），测量你下载了多少字节，然后从这个新的总数中减去以前的总数。将差异添加为数组中的新最后一个元素。如果这使数组超过一定大小，则删除第一个元素（最旧的样本）。然后，呈现所有样本的平均值。

您应该保留 2 到 5 秒的样本，间隔应该在 0.5 到 1 秒之间（这是货币和性能之间的权衡）。

如果它为零，您可能还希望在检索数组后从数组中删除第一个元素。这使您的开始报道更准确，并帮助您更快地从失速中恢复过来，因为您平均不包括旧零。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-12-16T07:27:22.593

开始下载后，立即捕获当前系统时间并将其存储为“开始时间”。然后，在传输过程中计算传输速度所需要做的就是再次查看系统时间并将其用作“当前时间”来计算到目前为止所花费的总时间：

```
transfer_speed = bytes_transferred / ( current_time - start_time) 
```

您可能希望在时间上使用秒或毫秒精度，如果您想要位/秒，当然可以将结果乘以 8。

由于您使用的是 Cocoa，因此您可以使用 NSDate 类来获取时间戳。例如，在开始传输时使用以下内容：

```
NSTimeInterval start = [NSDate timeIntervalSinceReferenceDate]; 
```

然后使用以下方法定期检查传输速率：

```
double speed = bytesTransferred / ([NSDate timeIntervalSinceReferenceDate] - start); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-16T07:34:52.343

你需要知道

1.  从头开始发送的字节数（计算平均传输率）

2.  自上一秒以来发送的字节数（用于计算当前传输速度。）

    > 如果您知道从一开始发送的字节，这可以很容易地完成。（从头发送的新字节 - 1 秒前从头发送的字节）

3.  总文件大小（计算进度百分比。）

    > （传输的字节数/总字节数）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-16T07:30:29.967

跟踪传输所用的时间。传输速率只是传输的字节数/经过的秒数，即每秒字节数。您不需要总大小。（也可以显示完成百分比，即传输的字节数/总字节数*100）

# asp.net - 修复缓慢的 GridView

> ID：370661
> 
> 赞同：2
> 
> 时间：2008-12-16T07:34:52.983
> 
> 标签：asp.net, gridview

我试图确定为什么 asp.net 网格视图如此缓慢。网格视图包含在一个自定义子类中，该子类添加了一个自定义寻呼机并进行了一些特殊的格式化。此外，自定义网格视图包含在用户控件中，该控件将网格视图放在更新面板中，并将其与对象数据源相结合，使控件易于使用。

我将减速追踪到两个问题领域：

*   第一个是渲染的 html 和 viewstate 的大小。我设法通过将视图状态呈现给会话变量而不是隐藏字段来改进这一点，但我可能会重写控件以根本不使用视图状态。
*   但是，我的主要问题是控件的渲染。在一个简单的页面上，唯一的控件是我的用户控件，即使禁用了视图状态，渲染一个 40 列 x 20 行的网格也需要几秒钟！查看跟踪我发现 PreRender 阶段需要 95% 的时间，所以我认为问题就在那里。

所以，我的问题是我应该如何解决这个问题？我在跟踪 asp.net 在 PreRender 阶段中所做的事情时遇到问题。我在用户控件中有一些被调用的代码，但大部分时间都花在了我的代码之外。
我尝试下载 asp.net 的调试符号，但 Visual Studio 仍然不允许我进入代码，并且跟踪在这里没有提供太多信息。

有没有其他人遇到过这种情况？我首先怀疑我的数据源，但是数据库调用很快，所以问题不存在。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-16T09:03:50.713

尝试使用 ANTS 或 dotTrace 之类的分析器 - 两者都有免费评估，或者如果您获得许可，Team System 也有（合作伙伴？）。他们会告诉你时间在哪里消耗，或者至少帮助你弄清楚在哪里看。

并在最近的 Deep Fried Bytes 播客中收听 Rico Mariani - 您将度过的最好的 40 分钟。

# .net - 如何从 Linq2Sql 查询中填充 POCO（子）IList 属性？

> ID：370664
> 
> 赞同：4
> 
> 时间：2008-12-16T07:37:17.753
> 
> 标签：.net, linq-to-sql, poco

我有两个课程：

```
public class Question
{
    public IList<Answer> Answers { get; set; }
}

public class Answer
{ .. } 
```

在我的 Linq2Sql 设计器中，设计器上有两个 L2S 对象，它们之间有正确的 0<->many 箭头。科尔。

我不确定如何在一次调用中检索这些问题/答案并填充我的 POCO 对象..

这就是我所拥有的......有人可以填补空白吗？

```
public IQueryable<Question> GetQuestions()
{
    return from q in _db.Questions
        select new Question
            {
                Title = q.Title,
                Answers = ????????   // <-- HALP! :)
            };
} 
```

想法？

## 更新：POCO之战

感谢您的回复，但它还不是 100%。

首先，我返回的是 POCO 类，而不是 Linq2Sql 上下文类。这就是为什么我正在做...

```
select new Question { .. }; 
```

该类是 POCO，而不是 linq2sql。

其次，我喜欢指向做 Answers = q.Answers.ToList() 的答案，但这也不起作用，因为它试图将 Linq2Sql 类设置为 POCO 类。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-16T07:41:44.840

如果您的 LINQ to SQL 类之间存在关系，则应该在“问题”LINQ to SQL 类上生成“答案”属性。所以你应该能够简单地做到这一点：

```
return from q in _db.Questions
       select new Question
       {
           Title = q.Title,
           Answers = q.Answers.ToList(),
       } 
```

您也许可以省略对 ToList() 的调用 - 我不确定 LINQ to SQL 用于生成的相关行的类型（我相信它是`IQueryable<T>`）。

要强制预先填充 Answers 属性，而不是为每个问题触发另一个查询，您可以使用[DataLoadOptions](http://msdn.microsoft.com/en-us/library/system.data.linq.dataloadoptions.aspx)类。本质上，您告诉 LINQ to SQL 在您查询问题时加载答案（使用 LoadWith 方法 - 请参阅 MSDN 文档）。

*编辑*

你是对的 - 因为你的 Question.Answers 属性是你自己的 POCO 的列表，所以用 q.Answers 分配它不是要走的路。这可能会更好：

```
return from q in _db.Questions
       select new Question
       {
           Title = q.Title,
           Answers = (from a in q.Answers
                     select new Answer { ... }).ToList(),
       } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-16T07:56:21.410

关联数据通常通过`EntitySet<T>`类处理（如果您使用 dbml 生成的代码，则会为您创建该属性）。

关联可以是惰性的或提前加载的；`DataLoadOptions`默认情况下，惰性（即在第一次需要时加载）-但是要使用/强制它提前加载`LoadWith()`-请参见[此处](http://msdn.microsoft.com/en-us/library/system.data.linq.dataloadoptions.loadwith.aspx)。要从 MSDN 页面复制示例：

```
Northwnd db = new Northwnd(@"c:\northwnd.mdf");
DataLoadOptions dlo = new DataLoadOptions();
dlo.LoadWith<Customer>(c => c.Orders);
db.LoadOptions = dlo;

var londonCustomers =
    from cust in db.Customers
    where cust.City == "London"
    select cust;

foreach (var custObj in londonCustomers)
{
    Console.WriteLine(custObj.CustomerID);
} 
```

在这里，`LoadWith`意味着当 a`Customer`被加载时，它们`Orders`会同时被获取。如果您知道需要哪些相关数据，这将很有用。如果没有这个，它将执行另一个 TSQL 查询 *per `Customer`** 以获取此数据（但仅当/当您要求时）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T08:08:34.710

如果您返回的 Question 类型与 _db.Questions 中的类型相同，您可以编写

```
return (from q in _db.Questions
        select q).ToList(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-27T18:18:20.800

它更容易。假设您的数据库模式已规范化并包含正确的关系，只需将延迟加载切换为 false：

私有 DBDataContext mDB = new DBDataContext(ConfigurationManager.ConnectionStrings["KeyFromWebConfig"].ConnectionString);

mDB.DeferredLoadingEnabled = false

现在任何使用 mDB 的 linq 查询也将获取子对象。当然，您可能希望根据需要打开和关闭此功能，以尽量减少对性能的影响。

# forms - 自定义 Google 自定义搜索

> ID：370667
> 
> 赞同：3
> 
> 时间：2008-12-16T07:40:56.683
> 
> 标签：forms, search, google-custom-search

有谁知道如何删除谷歌自定义搜索上的额外品牌？

他们添加了一个按钮和其他内容，例如“由谷歌提供支持的小工具”的文字。

必须有一种方法将 CSE 数据通过管道传输到正常形式，对吗？

[http://www.google.com/coop/cse/](http://www.google.com/coop/cse/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-16T08:00:36.363

我想正常的方法是购买他们的[商业版](http://groups.google.com/group/google-custom-search-creating-and-editing/browse_thread/thread/b0551aded8c00c15/1e26df13af8a9d95)；）

似乎仍然可以进行一些[调整](http://markmail.org/message/fts56cobltlha5x4#query:%22google%20custom%20search%22%20remove%20text+page:1+mid:3htxsx5mx2kwovn4+state:results)：这个[自定义搜索表单](http://www.oakham.rutland.sch.uk/search/search.asp)看起来不错。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-10-23T20:28:35.023

您可以通过简单地添加到您自己的 CSS 来进行一些调整。这些调整最好的部分是您不需要成为付费客户！

更改字体大小并删除 Google 品牌：

```
input.gsc-input {
   font-size: 11px; 
   height: 16px !important;
   background: none !important;
} 
```

更改自动完成字体大小：

```
.gsc-completion-container table {
    font-size: 11px;
} 
```

更改搜索框的边框半径：

```
.gsc-input-box {
    border-radius: 3px !important;
} 
```

*** 隐藏广告（我个人最喜欢的）

```
.gsc-adBlockVertical, .gsc-adBlock { /* this hides both the top and right ad blocks*/
    display:none;
}
.gsc-thinWrapper { /* this gives you use of the whole block, as opposed to 69% google gives*/
    width: 100%;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T08:10:32.677

商业版的主要好处是搜索结果中没有广告。所以谷歌真的不应该关心人们是否在免费服务上修改搜索表单，因为它仍然会给他们带来广告收入。

我查看了您链接到的页面，它可能已过时导致他们最新的代码吐出 javascript，所以没有什么很清楚。

我认为有一种方法可以获取我的 api 代码并将其弹出到普通表单脚本中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-03-13T23:44:53.720

在 2020 年，您可以通过以下方式执行此操作（至少在您的独立结果页面上）：

```
<head>
  <style>
    .gcsc-find-more-on-google-branding {
      display: none!important;
    }
    .gsc-adBlock {
      display: none!important;
    }
  </style>
</head> 
```

# haskell - Project Euler 27 上的 C 堆栈溢出

> ID：370678
> 
> 赞同：4
> 
> 时间：2008-12-16T07:51:46.273
> 
> 标签：haskell, recursion, fold

我刚刚开始学习 Haskell，并将阅读书籍和教程与解决 Project Euler 的问题结合起来。我一直坚持[问题 27](http://projecteuler.net/index.php?section=problems&id=27)，因为使用以下代码出现“C 堆栈溢出”错误：

**欧拉文件**

```
divisors n = [x | x <- [1..n `div` 2], n `mod` x == 0] ++ [n]
is_prime n = divisors n == [1, n]
f a b = [n^2 + a * n + b | n <- [0..]]
primes_from_zero a b = length(takeWhile is_prime (f a b)) 
```

**命令窗口**

此命令给出欧拉系数 1 和 41（一行 40 个素数）

```
foldr (max) (0, 0, 0) [(primes_from_zero a b, a, b) | a <- [0..10], b <- [0..50]] 
```

这个因“C 堆栈溢出”而失败（我想获得问题定义中也提到的系数 -79 和 1601）：

```
foldr (max) (0, 0, 0) [(primes_from_zero a b, a, b) | a <- [-100..0], b <- [1500..1700]] 
```

请您告诉我，为什么会出现错误以及如何解决？谢谢！

我使用 WinHugs。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-16T14:57:03.247

“堆栈溢出”错误意味着程序中的函数调用链（从入口函数到当前执行的函数）变得太大。大多数编译器和运行时都将调用链实现为堆栈数据结构——每个元素都是一个“堆栈框架”，包含单个函数调用的局部变量和上下文——大小有限。

通常，堆栈溢出意味着递归函数有问题。例如，如果递归永远不会终止，它最终会达到堆栈限制并“溢出”。即使递归终止，如果调用太多，它也可能溢出。非常大的列表通常是这种情况，您的示例似乎就是这种情况。

在 Haskell（和许多其他语言）中避免堆栈溢出的一种方法是编写[尾递归函数](http://en.wikipedia.org/wiki/Tail_recursion)。尾递归函数是唯一递归调用是函数结果的函数。例如，

```
foldl f x (y:ys) = foldl f (f x y) ys 
```

相反，`foldr`不是尾递归的

```
foldr f x (y:ys) = f y (foldr f x ys) 
```

由于技术原因，尾递归调用可以重用其调用者的堆栈帧，因此不会导致调用堆栈增长。

（附注：`foldr`不是尾递归，但比 '懒惰' `foldl`，因为它可能不需要评估整个列表。这可能会指导您决定使用哪个。）

[即使使用尾递归函数，您也可能由于“空间泄漏”](http://www.haskell.org/haskellwiki/Performance/Space)而耗尽内存。例如，在`foldl`每个递归调用中都会为`(f x y)`. `foldl`使用常量堆栈空间，但 O(n) 空间用于未评估的调用`f`. 为了在需要严格性的情况下避免这种情况，您可以使用`foldl'`

```
foldl' f x (y:ys) = (foldl' f $! f x y) ys 
```

中缀运算符`$!`强制进行严格评估的地方。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-16T14:08:31.723

我不知道为什么[litb](https://stackoverflow.com/users/34509/litb)将他的答案放在评论而不是答案中，所以我在这里复制它，以便人们看到它：

[http://www.haskell.org/haskellwiki/Stack_overflow](http://www.haskell.org/haskellwiki/Stack_overflow)

我认为这是正确的答案。但简短的版本是 foldr 不是尾递归的。

我已将此帖子标记为社区 Wiki，因此我不会从中获得任何声誉。

# python - Python游戏库Pygame和Pyglet的区别？

> ID：370680
> 
> 赞同：46
> 
> 时间：2008-12-16T07:55:22.707
> 
> 标签：python, pygame, pyglet

我有一些使用 Pygame 的经验，但这些天似乎有很多关于 Pyglet 的嗡嗡声。

这两个库如何比较？在功能和易用性方面，使用其中一个有什么优势？

最后，你会说一个比另一个更Pythonic吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-12-16T13:08:52.373

### 执照：

*   Pygame：LGPL 许可证
*   Pyglet：BSD 许可证

### 库依赖：

*   Pygame 严重依赖 SDL 库
*   Pyglet是一个依赖较少的纯python库，我认为它需要更好地理解OpenGL

### 社区：

*   Pygame 已经存在很久了，很多人都用过
*   Pyglet 是一个新的库

### 观众：

*   Pygame 面向游戏开发（光标、精灵、操纵杆/游戏手柄支持）
*   Pyglet 更通用（尽管它有一个 Sprite 类）

我还在 pyglet-users 邮件列表上找到了这个讨论：[从 pygame+pyopengl 到 pyglet](http://www.mail-archive.com/pyglet-users@googlegroups.com/msg00482.html)

免责声明：我还没有使用任何一个，只尝试了一些教程；-)

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-12-29T02:40:06.980

我正在考虑将 Pygame 和 Pyglet 用于小型 2D 射击游戏，在查看了源代码和一些教程之后，我使用了 Pyglet。我对结果非常满意。

Pyglet 立即工作，使用起来很愉快，并且在概念上非常干净。它确实给我一种 Pythonic 的感觉：你可以很快地得到一个简单易读的示例，并且它使用装饰器来很好地处理事件。它也没有强制使用特定的程序结构，这让我很容易融入 Pymunk 的物理建模 ( [http://code.google.com/p/pymunk/](http://code.google.com/p/pymunk/) )。

虽然它基于 OpenGL，并且您可以将这些功能用于特殊效果，但我能够在不了解它们的情况下做得很好。

它也适用于 py2exe 和 py2app，这很重要，因为很多人没有安装 Python 解释器。

不利的一面是，由于它较新，因此网络上有关它的信息较少，而且可供查看的示例游戏也较少。

此外，它与以前的版本相比发生了很大变化，因此其中的一些教程现在已经过时（有“新样式事件循环”和 Sprite 类作为主要添加内容。）

我建议下载示例（包括一个不错的 Asteroids 克隆，名为 Astraea），看看你是否喜欢这种风格。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2010-12-23T16:08:56.957

如果您从不打算在游戏本身中绘制任何矢量图形或图元，并且只坚持从磁盘加载图像，那么 Pyglet 是很好的（对于 2D 游戏）。它也更干净，因为无需编写自己的游戏循环，也无需担心速度、时间和响应能力。

但是，如果您必须即时生成图形，然后将它们保存为变量或文件，那么 pyglet 会变得相当复杂，因为您开始不得不处理低级 OpenGL 函数。在这些场景中，pygame 的软件渲染和 Surface 类更加用户友好。或者您可以使用 Python Imaging Library 并将其与 pyglet 接口。

显然，对于 3D 游戏，无论如何您都将不得不使用 OpenGL 函数，在这种情况下，我建议使用 pyglet 而不是 pygame + PyOpenGL。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-05T18:59:37.660

我想补充一点，有一个快速精灵库[Rabbyt](http://arcticpaint.com/projects/rabbyt/)，它可能是 Pyglet 的一个很好的补充。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-03-19T14:00:39.233

在查看了 pygame 和 pyglet 之后，我发现 pyglet 更容易上手，并且能够在几天内编写一个简单的突围风格游戏。

# windows - 如何读取存储在文件中的 = 符号后的任何文本

> ID：370694
> 
> 赞同：4
> 
> 时间：2008-12-16T08:17:06.487
> 
> 标签：windows, batch-file, cmd

我正在处理一些批处理文件。我需要从一些文本文件中读取名称。让我解释一下

我有一个文件`File.txt`，其中有类似的条目`FirstName=John`。现在我的批处理文件应该`John`从文件中读取文本，我也应该能够存储`John`在一些变量中。

但是使用以下代码，如果我使用`delims==`，我可以将`FirstName`文本存储在某个变量中，但不能`John`。

```
for /F "delims==" %%I in (File.txt) do set Title=%%I
echo %Title% 
```

有什么方法可以让`John`我从我的循环中获取`File.txt`并将其存储在我的`for`循环中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-16T08:38:36.647

```
@echo off
setlocal
for /F "tokens=1,2 delims==" %%a in (File.txt) do set Title=%%b
echo %Title% 
```

是否将名字值提取到`Title`... 但仅用于包含`Firstname`!的最后一行

```
@echo off
setlocal
for /F "tokens=1,2 delims==" %%a in (File.txt) do (
    set t=%t% %%b
)
echo %t:Firstname=% 
```

是否连接所有找到的名字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T19:13:16.753

你的问题是`John`找到的第二个令牌，`Firstname`是找到的第一个令牌。你有很多选择。

*   您可以使用`tokens=2`跳过第一个令牌并仅将第二个令牌放入 variable `%%I`。不生成其他变量。
*   您可以使用`%%J`包含第二个令牌的变量（自动生成）。`%%K`将包含第三个令牌等等。
*   您可以使用`tokens=2*`跳过第一个标记并将所有后续标记放入变量`I`, `J`,`K`等。

# java - Java 监听器继承

> ID：370695
> 
> 赞同：7
> 
> 时间：2008-12-16T08:17:25.097
> 
> 标签：java, inheritance, events, listener

我有一个触发自定义 java 事件的 java 类。代码结构如下：

```
public class AEvent extends EventObject {
...
}

public interface AListener extends EventListener {

  public void event1(AEvent event);

}

public class A {

  public synchronized void addAListener(AListener l) {
  ..
  }

  public synchronized void removeAListener(AListener l) {
  ..
  }

  protected void fireAListenerEvent1(AEvent event) {
  ..
  }
} 
```

一切正常，但我想创建一个新的 A 子类（称为 B），它可能会触发一个新事件。我正在考虑以下修改：

```
public class BEvent extends AEvent {
...
}

public interface BListener extends AListener {

  public void event2(BEvent event);
}

public class B extends A {

  public synchronized void addBListener(BListener l) {
  ..
  }

  public synchronized void removeBListener(BListener l) {
  ..
  }

  protected void fireBListenerEvent2(AEvent event) {
  ..
  }

} 
```

这是正确的方法吗？我在网上搜索示例，但找不到任何示例。

在这个解决方案中有一些我不喜欢的东西：

1.  `BListener`有两种方法，一种使用`AEvent`另`BEvent`一种作为参数。
2.  `B`类都有`addAListener`和`addBListener`方法。我应该用 private 关键字隐藏 addAListener 吗？**[更新：无法使用 private 关键字隐藏]**
3.  `fireAListenerEvent1`和`fireBListenerEvent1`方法类似的问题。

我正在使用 Java 1.5 版。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-16T08:30:24.820

我看不出`BListener`应该延长的理由`AListener`。

你真的想强迫对`B`事件感兴趣的每个人也实施`event1()`吗？

您也不能添加`addAListener()`，因为派生类不能降低父类中存在的方法的可见性。此外，您不应该这样做，否则您将违反[Liskov 替换原则](http://en.wikipedia.org/wiki/Liskov_substitution_principle)（每个 B 都必须能够做 A 可以做的所有事情）。

最后一点，我会`fire*()`保护这些方法。通常根本没有理由让它们公开，减少公共成员的数量可以保持你的公共界面干净。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-29T15:54:48.220

不要使用继承，这不是你想要的，并且会导致设计脆弱且难以更改。组合是一种更灵活、更好的设计方法。始终尝试尽可能精细地设计界面，因为它们不应该被更改事件。它们是您与系统其余部分的合同。如果需要添加新功能，第一个选项是向事件添加更多信息。如果这不合适，那么您应该设计一个新界面来传递该事件。这可以防止必须更改任何不受影响的现有代码。

这是我最喜欢的模式，我相信它通常被称为观察者。

创建一个新接口，为该事件类型定义一个方法 (fooEvent() addFooEventListener() removeFooEventListener())。在生成这些事件的具体类中实现此接口。（我通常称之为 SourcesFooEvent、FiresFooEvent、FooEventSource 等）

如果你想减少代码重复，你可以构建一个帮助类来处理监听器的注册，将它们存储在一个集合中，并提供一个用于发布事件的触发方法。

泛型可以在这里提供帮助。首先，一个通用的监听器接口：

```
public interface Listener<T> {
  void event(T event);
} 
```

接下来是一个匹配的 EventSource 接口：

```
public interface EventSource<T> {
    void addListener(Listener<T> listener);
} 
```

最后是一个抽象基类来快速构造一个帮助类来处理监听器的注册和事件派发：

```
public abstract class EventDispatcher<T> {
    private List<Listener<T>> listeners = new CopyOnWriteArrayList<T>();

    void addListener(Listener<T> listener) {
      listeners.add(listener);
    }    

    void removeListener(Listener<T> listener) {
      listeners.remove(listener);
    }

    void fireEvent(T event) {
      for (Listener<T> listener : listeners) {
        listener.event(event);
      } 
    }
} 
```

您将通过封装使用抽象 EventDispatcher，允许任何其他类轻松实现 EventSource，而无需它扩展任何特定类。

```
public class Message {
}

public class InBox implements EventSource<Message> {

  private final EventDispatcher<Message> dispatcher = new EventDispatcher<Message>();

  public void addListener(Listener<Message> listener) {
    dispatcher.addListener(listener);
  }

  public void removeListener(Listener<Message> listener) {
    dispatcher.removeListener(listener);
  }

  public pollForMail() {
    // check for new messages here...
    // pretend we get a new message...

    dispatcher.fireEvent(newMessage);
  }
} 
```

希望这能说明类型安全（重要）、灵活性和代码重用之间的良好平衡。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-16T13:42:47.593

我从您对 sua 的评论中了解到，解雇 B 会自动解雇 A。

为什么不使用单一类型的侦听器，然后混合一些继承、委托和泛型？

```
class AEvent {}
class BEvent extends Event{}

interface EventListner<E extends AEvent>
{
   onEvent(E e);
}

class ListenerManager<E extends AEvent>{
    addListner(EventListener<? extends E>){}
    removeListner(EventListener<? extends E>){}
    fire(E e);
}

class A extends ListenerManager<AEvent>
{
}

class B extends ListenerManager<BEvent>
{
   A delegatorA;

  @Override addListener(EventListener<? extends BEvent> l)
  {
    super.addListner(l);
    delegatorA.addListener(l);
  }       

  @Override removeListener(EventListener<? extends BEvent> l)
  {
    super.removeListner(l);
    delegatorA.removeListener(l);
  }       

  @Override fire(BEvent b)
  {
    super.fire(b);
    a.fire(b)
  }

} 
```

说明：管理监听器的代码是共享的，在基类监听器管理器中。由于泛型编译时检查，B 只能接收 BListener。触发 B 会自动触发 A。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-29T03:50:19.110

在我看来，你可以让事情变得非常简单。

**我的理解**

*   您有一个执行一些*基本操作的基本类**A*

**   您可能有一个更具体的子类*B*，它还可以执行一些更*具体的操作** 

 *如果是这种情况，您需要处理这两个事件（*basic*用于 A 和*basic* + *specific*用于 B ）

好吧，您不需要重载方法来执行此操作，您唯一需要做的就是为特定事件添加特定的处理程序（或侦听器）。

事件可能是“基本的”，这很好。

但是当事件是特定的时，您需要做出相应的反应。所以，我要做的是**在**特定的侦听器中添加一个检查来区分*特定*的事件，如下所示：

```
 if( whichEvent instanceof SpecificEvent ) { 
            SpecificEvent s = ( SpecificEvent ) whichEvent;
            // Do something specific here...
        } 
```

就是这样。

您对问题的描述过于抽象，因此可能无法提出具体的解决方案。但是，如果很难解释您想要实现的目标，那么您可能首先需要重新分析问题所在。

如果我上面的理解是正确的（你需要处理*基本*+*特定*的时间）下面的冗长代码可能会有所帮助。

最好的祝福

* * *

```
import java.util.*;
class A { 

    // All the listener will be kept here. No matter if basic or specific.
    private List<Listener> listeners = new ArrayList<Listener>();

    public void add( Listener listener ) { 
        listeners.add( listener );
    }
    public void remove( Listener listener ) { 
        listeners.remove( listener );
    }

    // In normal work, this class just perform a basic operation.
    public  void normalWork(){
        performBasicOperation();
    }

    // Firing is just firing. The creation work and the 
    // operation should go elsewhere.
    public void fireEvent( Event e ) { 
        for( Listener l : listeners ) { 
            l.eventHappened( e );
        }
    }

    // A basic operation creates a basic event
    public void performBasicOperation() { 
        Event e = new BasicEvent();
        fireEvent( e );
    }
}

// Specialized version of A.
// It may perform some basic operation, but also under some special circumstances
// it may  perform an specific operation too
class B extends A { 

    // This is a new functionality added by this class.
    // Hence an specifi event is fired.
    public  void performSpecificOperation() {
        Event e = new SpecificEvent();
        // No need to fire in different way
        // an event is an event and that's it.
        fireEvent( e );
    }

    // If planets are aligned, I will perform 
    // an specific operation.
    public  void normalWork(){
        if( planetsAreAligned() ) { 
            performSpecificOperation();
        } else { 
            performBasicOperation();
        }
    }
    private boolean planetsAreAligned() { 
        //return new Random().nextInt() % 3 == 0;
        return true;
    }
}

// What's an event? Something from where you can get event info?
interface Event{
    public Object getEventInfo();
}

// This is the basic event.
class BasicEvent implements Event{
    public Object getEventInfo() {
        // Too basic I guess.
        return "\"Doh\"";
    }
}
// This is an specific event. In this case, an SpecificEvent IS-A BasicEvent.
// So , the event info is the same as its parent. "Doh".
// But, since this is an SpecificEvent, it also has some "Specific" features.
class SpecificEvent extends  BasicEvent {

    // This method is something more specific.
    // There is no need to overload or create 
    // different interfaces. Just add the new  specific stuff
    public Object otherMethod() {
        return "\"All I can say is , this was an specific event\"";
    }
}

// Hey something just happened.
interface Listener { 
    public void eventHappened( Event whichEvent );
}

// The basic listner gets information 
// from the basic event. 
class BasicEventListener implements Listener { 
    public void eventHappened( Event e ) {
            System.out.println(this.getClass().getSimpleName() + ": getting basic functionality: " + e.getEventInfo());
        }
}

// But the specific listner may handle both.
// basic and specific events.
class SpecificListener extends BasicEventListener { 
    public void eventHappened( Event whichEvent ) {
        // Let the base to his work
        super.eventHappened( whichEvent );

        //  ONLY if the event if of interest to THIS object
        // it will perform something extra ( that's why it is specific )
        if( whichEvent instanceof SpecificEvent ) { 
            SpecificEvent s = ( SpecificEvent ) whichEvent;
            System.out.println(this.getClass().getSimpleName() + ": aaand  getting specific functionality too: " + s.otherMethod() );
            // do something specific with s 
        }
    }
}

// See it run. 
// Swap from new A() to new B() and see what happens.
class Client { 
    public static void main( String [] args ) { 
        A a = new B();
        //A a = new A();

        a.add( new BasicEventListener() );
        a.add( new SpecificListener() );

        a.normalWork();
    }
} 
```

样本输出：

```
BasicEventListener: getting basic functionality: "Doh"
SpecificListener: getting basic functionality: "Doh"
SpecificListener: aaand  getting specific functionality too: "All I can say is , this was an specific event" 
```

更进一步，您甚至可以摆脱接口以使其更简单

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-27T14:43:17.763

如果

```
public class BEvent extends AEvent {
...
}

public interface BListener extends AListener {

  public void event2(BEvent event);
} 
```

你不能做类似的事情：

```
public class B extends A {

  @Override
  public synchronized void addAListener(AListener l) {
    if (l instanceof BListener) {
       ...
    } else {
       super.addAListener(l);
    }
  }
  ...
} 
```

正如我在评论中所说，我不确定你真正想要实现什么？从哪里调用谁，当它被调用时需要做什么？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-29T15:19:11.023

`A`基于我们对&之间关系的了解很少`B`，我认为`BListener`制作`AListener`. 顾名思义，a`BListener`假设监听`BEvent`s，它们*已经*是 s的子类`AEvent`。为清楚起见，听众应该有明确的目的；它们不应该不必要地重叠。此外，不需要这种重叠的侦听器，因为您已经在类中定义了单独的方法`B`来处理不同类型的侦听器。

为了说明我的观点，请考虑以下示例，该示例以您的代码为样式：

```
public class MovableMouseEvent extends EventObject

public class ClickableMouseEvent extends MovableMouseEvent

public interface MovableMouseListener extends EventListener
  // mouseMoved(MovableMouseEvent)

public interface ClickableMouseListener extends MovableMouseListener 
  // mouseClicked(ClickableMouseEvent) 

public class MovableMouseWidget
  // {addMovableMouseListener,removeMovableMouseListener}(MovableMouseListener)
  // fireMovableMouseEvent(MovableMouseEvent)                           

public class ClickableMouseWidget extends MovableMouseWidget
  // {addClickableMouseListener,removeClickableMouseListener}(ClickableMouseListener)
  // fireClickableMouseEvent(ClickableMouseEvent) 
```

正如您正确指出的那样，这种设计有效，但令人困惑，因为`ClickableMouseListener`处理两种事件并处理两种侦听器。`ClickableMouseWidget`现在，考虑以下使用组合而不是继承的替代方案：

```
public class MouseMoveEvent extends EventObject // note the name change

public class MouseClickEvent extends EventObject // don't extend MouseMoveEvent 

public interface MouseMoveListener extends EventListener
  // mouseMoved(MouseMoveEvent)

public interface MouseClickListener extends EventListener // don't extend MouseMoveListener 
  // mouseClicked(MouseClickEvent) 

public interface MouseMoveObserver
  // {addMouseMoveListener,removeMouseMoveListener}(MouseMoveListener)
  // fireMouseMoveEvent(MouseMoveEvent)

public interface MouseClickObserver
  // {addMouseClickListener,removeMouseClickListener}(MouseClickListener)
  // fireMouseClickEvent(MouseClickEvent)

public class MovableMouseWidget implements MouseMoveObserver

public class ClickableMouseWidget implements MouseMoveObserver, MouseClickObserver 
```

# delphi - Delphi 7 和事件

> ID：370698
> 
> 赞同：1
> 
> 时间：2008-12-16T08:22:40.873
> 
> 标签：delphi, events, delphi-7

我正在研究一个看起来像某种时间问题的错误，所以我有点好奇事件在 Delphi 7 中是如何工作的。发生的情况是我们通过 COM 接口将一些数据发送到我们的应用程序并在从 COM 线程引发的事件。似乎事件中包含相当多的代码，执行时间越来越长，一段时间后整个应用程序崩溃。在事件中调用图形并填充到可能会影响时间的大型数组中。我无法发现内存使用量有任何显着增加，也没有机会运行任何分析器来检查泄漏。此外，要测试的显而易见的事情是剥离其中所有代码的事件，看看我们是否可以运行更长的时间。

Delphi中的事件是串行的还是并行的，也就是说，如果我在一个正在执行的时候得到一个新的事件——会发生什么？它是在某种自动线程上并行运行，是被忽略还是排队？

如果它被排队，在应用程序崩溃之前我可以在队列中有多少？

索引到一个大数组需要更长的时间吗？即使它是固定大小的？我认为不应该，所以我正在寻找需要时间的泄漏和分配。如果我通过事件收到一个对象，我应该在事件中还是在“调用”代码中处理它？

在 Delphi 中，哪些东西通常不能很好地扩展？我可以寻找什么会增加执行时间？

最后，由于这是与 COM 相关的，因此任何指向 COM 中常见陷阱的指针都值得赞赏，尽管我意识到这很棘手。不过，我确实掌握了共同初始化。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-08T15:18:48.817

Delphi 主要是串行处理事件。不幸的是，当您已经在某个事件中运行时，可以告诉 Delphi 处理其他事件。因此，当您的当前事件正在等待新事件完成时，新事件将运行。在最坏的情况下，您的应用程序可能看起来表现正常，而它实际上是在事件中的事件中堆叠事件。规则一：除非你真的需要，否则避免使用 Application.ProcessMessages。

使用 COM 对象时，事情会变得有点复杂，因为 COM 对象可能有它自己的事件、启动它自己的线程并执行所有其他类型的事情，而这些事情你没有任何控制权。COM 在 Delphi 中似乎很容易使用，但对于没有经验的开发人员来说，它确实有许多隐藏的陷阱。（在其中几个幸存后，我仍然有伤痕！）

一般来说，在处理 COM 对象时，我会尝试将 COM 调用分离到它们自己的线程中，创建特殊组件以将 COM 对象保持在它自己的线程中，并添加大量同步代码，这样我就可以保持 GUI 响应而一些长 COM 任务正在做一些处理。但是这样做需要大量的 COM 和多线程经验。但基本上，围绕任何 COM 组件设计自定义包装器组件是一种很好的做法，只是为了保护您的 COM 类所需的资源。

Delphi 最大的弱点往往是字符串处理和大数组的处理。（尤其是包含对象的数组；使用记录代替。）字符串本身在 Delphi 中很快，但在 Delphi 中的字符串函数不是很优化。例如，我曾经有一个包含一些 XML 数据的字符串。它有很多布尔字段，拼写为“True”和“False”，需要将它们转换为“true”和“false”。一个简单的字符串替换大约需要 15 秒来替换所有这些值。我重写了它，使用 MSXML 将 XML 加载到 DOM 文档中，使用 XPath 选择所有布尔节点，遍历这些节点以用正确的文本替换所有值，然后将 XML 放回单个字符串中。突然间，它能够在两秒钟内做到同样的事情！对于看起来更慢的东西来说，这是一个巨大的性能增益。原因？Delphi 在处理字符串时，往往会在处理过程中多次复制字符串。或者它需要为字符串分配越来越多的内存以增加大小。这需要时间，在 C++ 等其他语言中不会浪费时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-09T22:13:41.067

COM 重要的是您的应用程序支持什么“公寓模型”。Delphi 中最常用的是[单线程单元模型](http://msdn.microsoft.com/en-us/library/ms680112.aspx)，也称为“单元线程”，其中 COM 调用与您的应用程序主消息队列同步。使用此模型，您一次只能处理一个 COM 调用，并且 COM 对象不支持来自其他线程的调用。

但是，您可以将您的 COM 单元模型初始化为[多线程](http://msdn.microsoft.com/en-us/library/ms693421(VS.85).aspx)，这样做您必须确保对共享资源的访问正确同步 - 您启动的每个线程都必须通过调用加入多线程单元`CoInitializeEx(nil, COINIT_MULTITHREADED);`

当您公开 DCOM 接口时，事情变得非常有趣，因为 RPC 子系统有一个线程池用于服务请求，它可以直接访问多线程单元中的所有 COM 对象，从而实现高性能服务器。如果您使用的是单元线程，您将不得不经历消息队列的瓶颈，并且单个线程一次只能调度一个 COM 调用。

Chris Bensen 也写了一篇[很好的博客](http://chrisbensen.blogspot.com/2007/06/delphi-tips-and-tricks_26.html)文章，其中包含一些代码示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-18T07:39:44.923

做了一些研究并得到了一些指示，特别是我的第一个问题：

*Delphi中的事件是串行的还是并行的，也就是说，如果我在一个正在执行的时候得到一个新的事件——会发生什么？它是在某种自动线程上并行运行，是被忽略还是排队？如果它被排队，在应用程序崩溃之前我可以在队列中有多少？*

好吧，显然事件与其他所有事件一样是同步的，或者我应该说是串行的。在处理一个事件时，您无法获得更多事件，因为该事件本质上是一个函数调用。

在事件处理程序中，处理了一些图形组件。由于该事件是在另一个线程上引发的，这很糟糕。我要么需要对位于创建图形的线程上的图形进行一些更新机制，要么在事件中进行线程切换。

此外，测试表明，实际上是图形更新所花费的时间越来越长，因此重构图形处理听起来是一个不错的尝试途径。

# java - invokeAll() 不愿意接受一个 Collection >

> ID：370707
> 
> 赞同：7
> 
> 时间：2008-12-16T08:33:17.250
> 
> 标签：java, executorservice, callable

我不明白为什么这段代码无法编译

```
ExecutorService executor = new ScheduledThreadPoolExecutor(threads);

class DocFeeder implements Callable<Boolean> {....} 
... 
List<DocFeeder> list = new LinkedList<DocFeeder>();
list.add(new DocFeeder(1));
...
executor.invokeAll(list); 
```

错误消息是：

```
The method invokeAll(Collection<Callable<T>>) in the type ExecutorService is 
not applicable for the arguments (List<DocFeeder>) 
```

`list`是一个`Collection`of `DocFeeder`，它实现了`Callable<Boolean>`- 这是怎么回事？！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-16T08:55:35.287

只是为了稍微扩展一下saua的答案......

在 Java 5 中，该方法被声明为：

```
invokeAll(Collection<Callable<T>> tasks) 
```

在 Java 6 中，该方法被声明为：

```
invokeAll(Collection<? extends Callable<T>> tasks) 
```

通配符的区别非常重要 - 因为`List<DocFeeder>` *是*a`Collection<? extends Callable<T>>`但它*不是*a `Collection<Callable<T>>`。考虑使用这种方法会发生什么：

```
public void addSomething(Collection<Callable<Boolean>> collection)
{
    collection.add(new SomeCallable<Boolean>());
} 
```

这是合法的 - 但如果你可以`addSomething`用 a调用它显然很糟糕，`List<DocFeeder>`因为它会尝试将非 DocFeeder 添加到列表中。

因此，如果您坚持使用 Java 5，则需要`List<Callable<Boolean>>`从您的`List<DocFeeder>`.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-16T08:42:58.807

该代码使用 Java 6 编译得非常好，但无法使用 Java 5 编译

```
Foo.java:9：找不到符号
符号：方法 invokeAll(java.util.List)
位置：接口 java.util.concurrent.ExecutorService
executor.invokeAll(list);
        ^
1 个错误
```

然而改变`list`这样的：

```
Collection<Callable<Boolean>> list = new LinkedList<Callable<Boolean>>(); 
```

使其适用于 Java 5 和 Java 6。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T09:03:47.517

感谢您提供详细的答案，但它仍然困扰着我-Callable 是一个接口，所以实际上，Jon 的答案中的“addSomething”函数应该没问题（不仅合法，而且合理）-因为，嗯，这就是接口的全部意义- 只要您遵守一些初步协议，我不在乎您将哪个对象添加到列表中。imo，您提出的问题应该在不同的范围内解决。

除此之外，事实仍然是代码没有编译 - 它应该......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-16T03:56:14.210

```
Collection<Callable<Boolean>> list = new LinkedList<Callable<Boolean>>(); 
```

# java - Java 6 JVM 挂起

> ID：370710
> 
> 赞同：4
> 
> 时间：2008-12-16T08:34:38.713
> 
> 标签：java, jvm, locking

很抱歉这篇长篇文章，但我想知道在我向 Sun 提交错误报告之前是否可以得到更多的关注。

JVM：6u11
操作系统：Windows XP SP3
硬件：AMD Athlon 64 X2 4600+ @ 2.41GHz，3.25 GB RAM。

我相信我在 JVM 中遇到了一个错误，没有为线程提供监视器。在以下线程跟踪中，监视器`<0x12a8f9f8>`被 获取`RelayedMessages-0000000001`，最终等待它；随后通知了该线程。然而，即使列出的所有线程都在争夺监视器，但没有一个线程得到它。

我保证线程转储对于每个引用 monitor 的线程都是完整的`<0x12a8f9f8>`。转储是使用 Java VisualVM 获得的，在 16 小时内 3 次，并且每次都显示是一致的（这些线程没有变化）。

有没有人不同意我的评估，即 JVM 未能将监视器交付给任何符合条件的线程，什么时候应该将它交付给其中一个？

```
"RelayedMessages-0000000001" daemon prio=6 tid=0x03694400 nid=0x1750 waiting for monitor entry [0x05e1f000..0x05e1fc94]
   java.lang.Thread.State: BLOCKED (on object monitor)
    at java.lang.Object.wait(Native Method)
    at com.companyremoved.thd.EzWaiter.ezWait(EzWaiter.java:249)
    - locked <0x12a8f9f8> (a com.companyremoved.system.coms.ComsSender)
    at com.companyremoved.ioc.IsolatedObject.waitWithinMessage(IsolatedObject.java:352)
    - locked <0x12a8f9f8> (a com.companyremoved.system.coms.ComsSender)
    at com.companyremoved.system.coms.ComsSender.waitForAvailablePipe(ComsSender.java:219)
    at com.companyremoved.system.coms.ComsSender.sendObject(ComsSender.java:185)
    at com.companyremoved.system.coms.ComsSender.processIocMessage(ComsSender.java:98)
    at com.companyremoved.ioc.IsolatedObject.deliver(IsolatedObject.java:311)
    - locked <0x12a8f9f8> (a com.companyremoved.system.coms.ComsSender)
    at com.companyremoved.ioc.IsolatedObject.iocMessage(IsolatedObject.java:265)
    at com.companyremoved.ioc.IocTarget.iocMessage(IocTarget.java:138)
    at com.companyremoved.ioc.IocBinding.iocMessage(IocBinding.java:105)
    at com.companyremoved.system.coms.ComsSender$Messages.sendObject(ComsSender.java:333)
    at com.companyremoved.system.coms.ComsSender$Messages.sendObject(ComsSender.java:316)
    at com.companyremoved.system.coms.RelayedMessage.run(RelayedMessage.java:104)
    - locked <0x130fe8e0> (a com.companyremoved.system.coms.RelayedMessage)
    at com.companyremoved.thd.RunQueue.runEntry(RunQueue.java:293)
    at com.companyremoved.thd.RunQueue.run(RunQueue.java:273)
    at java.lang.Thread.run(Unknown Source)

   Locked ownable synchronizers:
    - None

"ScbPipe Writer" daemon prio=6 tid=0x4fff0c00 nid=0xf14 waiting for monitor entry [0x0594f000..0x0594fc14]
   java.lang.Thread.State: BLOCKED (on object monitor)
    at com.companyremoved.ioc.IsolatedObject.deliver(IsolatedObject.java:293)
    - waiting to lock <0x12a8f9f8> (a com.companyremoved.system.coms.ComsSender)
    at com.companyremoved.ioc.IsolatedObject.iocMessage(IsolatedObject.java:265)
    at com.companyremoved.ioc.IocTarget.iocMessage(IocTarget.java:138)
    at com.companyremoved.coms.stm.ioc.ComsPipe$Receiver.scbPipeDefaultProcessor(ComsPipe.java:403)
    at com.companyremoved.scb.ScbPipe.processObject(ScbPipe.java:915)
    - locked <0x131a4ea0> (a java.lang.Object)
    at com.companyremoved.scb.ScbPipe.writerRun(ScbPipe.java:817)
    at com.companyremoved.scb.ScbPipe.run(ScbPipe.java:728)
    at java.lang.Thread.run(Unknown Source)

   Locked ownable synchronizers:
    - None

"ScbPipe Writer" daemon prio=6 tid=0x4c647400 nid=0xe00 waiting for monitor entry [0x059ef000..0x059efb94]
   java.lang.Thread.State: BLOCKED (on object monitor)
    at com.companyremoved.ioc.IsolatedObject.deliver(IsolatedObject.java:293)
    - waiting to lock <0x12a8f9f8> (a com.companyremoved.system.coms.ComsSender)
    at com.companyremoved.ioc.IsolatedObject.iocMessage(IsolatedObject.java:265)
    at com.companyremoved.ioc.IocTarget.iocMessage(IocTarget.java:138)
    at com.companyremoved.coms.stm.ioc.ComsPipe$Receiver.scbPipeDefaultProcessor(ComsPipe.java:403)
    at com.companyremoved.scb.ScbPipe.processObject(ScbPipe.java:915)
    - locked <0x13188bb8> (a java.lang.Object)
    at com.companyremoved.scb.ScbPipe.writerRun(ScbPipe.java:817)
    at com.companyremoved.scb.ScbPipe.run(ScbPipe.java:728)
    at java.lang.Thread.run(Unknown Source)

   Locked ownable synchronizers:
    - None

"ScbPipe Writer" daemon prio=6 tid=0x035f7800 nid=0x1130 waiting for monitor entry [0x0726f000..0x0726fc94]
   java.lang.Thread.State: BLOCKED (on object monitor)
    at com.companyremoved.ioc.IsolatedObject.deliver(IsolatedObject.java:293)
    - waiting to lock <0x12a8f9f8> (a com.companyremoved.system.coms.ComsSender)
    at com.companyremoved.ioc.IsolatedObject.iocMessage(IsolatedObject.java:265)
    at com.companyremoved.ioc.IocTarget.iocMessage(IocTarget.java:138)
    at com.companyremoved.coms.stm.ioc.ComsPipe$Receiver.scbPipeDefaultProcessor(ComsPipe.java:403)
    at com.companyremoved.scb.ScbPipe.processObject(ScbPipe.java:915)
    - locked <0x12a8a478> (a java.lang.Object)
    at com.companyremoved.scb.ScbPipe.writerRun(ScbPipe.java:817)
    at com.companyremoved.scb.ScbPipe.run(ScbPipe.java:728)
    at java.lang.Thread.run(Unknown Source)

   Locked ownable synchronizers:
    - None

"IOC Signals-0000000001" daemon prio=6 tid=0x03673000 nid=0x1434 waiting for monitor entry [0x0415f000..0x0415fd94]
   java.lang.Thread.State: BLOCKED (on object monitor)
    at com.companyremoved.ioc.IsolatedObject.deliver(IsolatedObject.java:293)
    - waiting to lock <0x12a8f9f8> (a com.companyremoved.system.coms.ComsSender)
    at com.companyremoved.ioc.IsolatedObject.iocMessage(IsolatedObject.java:265)
    at com.companyremoved.ioc.IocTarget.iocMessage(IocTarget.java:138)
    at com.companyremoved.ioc.IocBinding.iocMessage(IocBinding.java:105)
    at com.companyremoved.system.coms.ComsSender$Messages.removePipe(ComsSender.java:302)
    at com.companyremoved.system.coms.ConnectionController.disconnect(ConnectionController.java:712)
    at com.companyremoved.system.coms.ConnectionController.shutdown(ConnectionController.java:224)
    at com.companyremoved.system.coms.ConnectionController.processIocMessage(ConnectionController.java:168)
    at com.companyremoved.ioc.IsolatedObject.deliver(IsolatedObject.java:311)
    - locked <0x12a8b798> (a com.companyremoved.system.coms.ConnectionController)
    at com.companyremoved.ioc.IsolatedObject.access$100(IsolatedObject.java:36)
    at com.companyremoved.ioc.IsolatedObject$SignalProxy.run(IsolatedObject.java:526)
    at com.companyremoved.thd.RunQueue.runEntry(RunQueue.java:293)
    at com.companyremoved.thd.RunQueue.run(RunQueue.java:273)
    at java.lang.Thread.run(Unknown Source)

   Locked ownable synchronizers:
    - None 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-04T08:57:11.387

提供的线程跟踪对于所讨论的锁是完整的。与我共事的另外两个人同意明确指出了 JVM 故障，jProfiler (ej-technologies) 的程序员也是如此。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T09:33:34.273

你确定线程 RelayedMessages-0000000001 得到通知吗？其他线程被阻塞是正常的，因为第一个线程仍然获得 <0x12a8f9f8> 的锁。为了让其他线程能够获得锁，第一个线程应该从等待列表中移除并安排再次运行，然后释放它获得的锁。

可能有其他线程在等待第一个线程等待的同一对象，并且当您说通知时，这些线程被选择唤醒。如果可能，请确保使用 notifyAll()。

也可能您可以在将线程放入等待列表之前释放锁，或者通过提供超时值来调用等待。线程在等待列表中等待 16 小时是没有意义的。如果您还可以发布其他也会有帮助的主题。

**更新：**

你说得对，我应该考虑到 Thread.State。正如您评论的那样，它没有处于等待状态，因为它已收到通知。那么，在等待列表中并不是不释放锁 <0x12a8f9f8> 的原因。但是，它处于阻塞状态。这意味着，它试图获得它在 object.wait 之前获得的锁，但它不能。因此，似乎有另一个线程（不在您提供的列表中）阻止它。

我想，你在想 object.wait 应该已经释放了锁 <0x12a8f9f8>。但是 object.wait 仅释放该对象监视器上的锁并保留其他锁。而且我认为， lock <0x12a8f9f8> 不是对象监视器的锁（调用等待）

当然，情况可能并非如此，并且可能存在真正的错误。我只是想提出可能的原因。

# jquery - 如何使用 jQuery

> ID：370716
> 
> 赞同：0
> 
> 时间：2008-12-16T08:40:10.667
> 
> 标签：jquery, ajax, image

我已经在文件`Main.html`和`ajax.php`. 该`ajax.php`文件将图像的链接返回到`Main.html`.

现在`Main.html`，我有 Image1、Image2、Image3 等。

我的`Main.html`文件：

```
<html>
    ...
    # ajax.php Call
    ...
    # Return fields from Ajax.php
</html> 
```

我的 ajax.php 文件

```
echo "<a href='src1'><img src='src_path1' id='fid1' alt='Name1' /></a>Click To View image1\n";
echo "<a href='src2'><img src='src_path2' id='fid2' alt='Name2' /></a>Click To View image2\n";
// etc. 
```

因此，在执行 ajax.php 之后，我在 Main.html 中获得了图像位置。

现在，当我单击 Main.html 中的 Image1 链接时，相应的图像应显示在同一窗口中。

所以我考虑是否再次使用jQuery在同一页面上查看图像。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-16T09:03:40.323

听起来您可能想看看[jQuery 灯箱插件](http://leandrovieira.com/projects/jquery/lightbox/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T09:03:58.577

你可以这样做：

在你的 html 中定义这个 div：

```
<div id="pictureframe"></div> 
```

现在在图像链接上添加一个 onclick 处理程序来执行以下操作：

```
$("#pictureframe").load(image_url); 
```

您需要构建代码以轻松检索 image_url。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T09:04:23.397

试试这个：

在您的页面中放置一个隐藏的 div，其中包含图像（标签`img`）：

```
<div id="imageDivisionHolder" style="disply:none;">
    <img id="imageItemHolder" src="" alt="" />
</div> 
```

为来自文件的所有图像设置类，`ajax.php`并将大图像源放在它的属性中。我把它放在`Title`属性中。

```
<img src='src_path1' id='fid1' alt='Name1' class='item' Title='src_path1_bigimage' /> 
```

jQuery代码是：

```
$(document).ready(function(){
    $("img.item").click(function(){
        $("#imageItemHolder").attr("src",$(this).attr("title"));
        $("#imageDivisionHolder").show();
    });
}); 
```

或者您可以编写一个函数来执行此操作并设置图像的 onclick 以运行它。不推荐这种方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-17T14:12:57.610

文件`ajax.php`输出必须返回以下[HTML](http://en.wikipedia.org/wiki/HTML)：

```
<a href="#" class="imageLink" title="fid1"><img src="src1" id="fid1" alt="Name1" style="display:none;" /><span>Click To View image1</span></a> 
<a href="#" class="imageLink" title="fid2"><img src="src2" id="fid2" alt="Name2" style="display:none;" /><span>Click To View image2</span></a> 
<a href="#" class="imageLink" title="fid3"><img src="src3" id="fid3" alt="Name3" style="display:none;" /><span>Click To View image3</span></a> 
```

和[jQuery](http://en.wikipedia.org/wiki/JQuery)代码：

```
$(document).ready(function(){
    $("a.imageLink").click(function(){
            $("#"+$(this).attr("title")).show();
        $(this).find("span").hide();
    });
}); 
```

# vba - 制作 Excel 宏以快速输入数据 ::: VBA ::: Excel :::

> ID：370717
> 
> 赞同：1
> 
> 时间：2008-12-16T08:40:42.977
> 
> 标签：vba, excel, ms-office

我的工作是输入调查结果（以纸质形式）以取得优异成绩。我从未在 Office 中编写过任何宏 :(

这是我基本上需要的：

1.  我有预定义的列 (|A|B|...|AG|AH|)
2.  所有调查都分组。来自同一组的所有调查都有很少（如预定义）相同的列。“定义”组总是相同的列
3.  所有其他调查答案均为数字类型 [1..10]。
4.  列与servey中的答案顺序不同
5.  我想要宏来接受我的输入（例如“1575”），并将该“组”的预定义值放在|A| |B| |C|，然后是 |E| = 1, |D| = 5, |F| = 7, |G| = 5，并自动开始进入下一行。

任何能让我知道如何编写这个宏的东西都非常受欢迎

非常感谢您阅读本文...

EDIT1：我想问题不够清楚......我需要宏来读取我的键盘输入（'1575'）并将整数'1''5''7'和'5'写入预定义的行。现在，我有一个制作表单的想法，但是我需要在我按下一个键时将焦点更改为下一个输入的事件处理程序，因为我想避免一直按 TAB ......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-16T12:23:39.703

在我看来，您需要一个只有一个文本框的小型用户表单，一个显示数据输入顺序的范围，例如：

A组 | E | D | F | G

还有一些与表格一起使用的代码，例如：

```
Dim LastCol As Integer
Dim CurRow As Integer

Private Sub UpdateCells()
Dim Col As Variant
Dim ColumnOrder As Range

'Range that specifies data entry order'
Set ColumnOrder = Range("A3:A15")

LastCol = LastCol + 1

If LastCol > WorksheetFunction.CountA(ColumnOrder) Then
    LastCol = 1
    CurRow = CurRow + 1
End If

Col = Range("A3").Offset(0, LastCol)
Range(Col & CurRow) = TextBox1.Value
TextBox1 = ""

End Sub

Private Sub TextBox1_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
If KeyCode = 13 Then
    UpdateCells
End If
End Sub

Private Sub UserForm_Initialize()
CurRow = ActiveCell.Row
End Sub 
```

编辑重新评论

在 Excel 中，最后一行可能有点棘手，因为在保存工作簿之前，Excel 不会在删除后更新范围。其中一个可能适合：

```
Function FindLastRow()
'Assuming that data starts in A1'
r = ActiveSheet.UsedRange.Rows.Count
c = ActiveSheet.UsedRange.Columns.Count
FindLastRow = r
End Function 
```

.

```
Sub LastRow()
LastRowA = ExecuteExcel4Macro("GET.DOCUMENT(10)")
LastRowB = ActiveSheet.Cells.SpecialCells(xlCellTypeLastCell).Row
End Sub 
```

更多信息：[http ://www.tek-tips.com/faqs.cfm?fid=2115](http://www.tek-tips.com/faqs.cfm?fid=2115)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-18T22:49:58.157

```
Private Sub Worksheet_Change(ByVal Target As Range)

    Dim sText As String

    Application.EnableEvents = True

    If Target.Column = 1 Then  'Four digits entered in col A
        sText = CStr(Target.Value) 'convert to string
        If Len(sText) = 4 Then
            Target.Offset(0, 4).Value = Left$(sText, 1) 'write to E
            Target.Offset(0, 3).Value = Mid$(sText, 2, 1) 'D
            Target.Offset(0, 5).Value = Mid$(sText, 3, 1) 'F
            Target.Offset(0, 6).Value = Mid$(sText, 4, 1) 'G
        End If
    End If

    Application.EnableEvents = True

End Sub
```

如果您在 A 列中输入四位数字，这会将它们分散到正确的列中。它进入工作表的模块，而不是标准模块。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-16T21:35:58.527

如果我正确理解了这个问题，您希望用户只能输入数字，而无需使用回车或箭头来完成输入。

例如，输入“1253216...”而不是“1 2 5 ...”

如果是这样，不幸的是，没有与进入公式栏中的单个字符相对应的事件。唯一远程相关的事件是选择更改和更改。但是，我认为没有任何方法可以将它们用于此目的（它们不会在公式栏输入期间触发）。

一个想法：使用文本格式制作和输入列，并指示用户在一个大字符串中输入答案（如“1253216”等），然后将公式放入每个其他单元格中，从输入列中解析出第 n 个字符并将其更改为一个值。例如：

将范围名称“输入”应用于 A 列，将范围名称“N”应用于第 1 行，然后在任何其他单元格中，输入以下公式：

```
=VALUE(MID(Inputs,N,1)) 
```

缺点是，用户在完成输入整个数字字符串并按下回车键或箭头之前，不会知道他们是否犯了一些错误。

# windows - 在 Windows 中不使用驱动器号访问 USB 设备

> ID：370718
> 
> 赞同：3
> 
> 时间：2008-12-16T08:41:43.097
> 
> 标签：windows, usb

是否可以在不使用 Windows 分配的驱动器号的情况下访问 USB 驱动器或闪存卡？我以为我在某处读到了可以使用卷 GUID 或其他内容的内容，但是一旦我识别它，我就可以在资源管理器中打开它吗？这对我很重要的原因是因为可能没有足够的驱动器号来处理驱动器的数量，所以我希望仍然能够访问它们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-16T08:49:33.380

如果您使用的是 NTFS，您可以在 Windows 中创建“卷安装点”。（类似于 *NIX，如果您使用过它）。

挂载点使您的文件系统上的一个文件夹（例如您的 C 驱动器）指向另一个卷，因此“C:\usb1”实际上可以包含 USB 驱动器的内容。

Microsoft 网站上有几篇文章应该会为您指明方向： [如何创建和使用已安装的驱动器](http://support.microsoft.com/kb/307889) [关于卷安装点](http://www.microsoft.com/technet/prodtechnol/windows2000serv/reskit/prork/prdf_fls_ogex.mspx?mfr=true)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T08:50:04.050

单独使用 MOUNTVOL 来获取驱动器 ID。 ![在此处输入图像描述](https://i.stack.imgur.com/9LPby.png)

干得好：

```
MOUNTVOL C:\USB: \\?\Volume{ebc79032-5270-11d8-a724-806d6172696f}\ 

OR Winkey+R (Start-Run)  \\?\Volume{ebc79032-5270-11d8-a724-806d6172696f}\ 
```

# continuous-integration - MsTest 运行文件夹中的所有测试

> ID：370719
> 
> 赞同：2
> 
> 时间：2008-12-16T08:42:40.850
> 
> 标签：continuous-integration, mstest, testing

我正在尝试设置 TeamCity 4.0 构建服务器来运行 VS2008（非 TFS）单元测试。

如果我手动创建一个测试列表并维护该列表，以便创建的所有单元测试都包含在列表中，我可以使用“/testlist:mylist”选项在构建服务器上自动运行所有测试。

但是一旦项目开发开始，维护列表本身将是一个问题。所以我正在寻找一种方法来告诉 MSTEST 只是“加载你可以在这个文件夹中找到的所有测试”，这可能吗？

一种解决方法是指定要运行的测试程序集。但这与维护“全部”测试列表并没有太大区别。

是否可以告诉 MSTEST.exe 只加载它可以找到的所有测试？有经验的人吗？我对此有点陌生，但我需要它是自动化的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-16T08:58:21.940

我使用 TC4 + NUnit 使用 MSBUILD 脚本（您使用的是哪个运行器？），并执行如下显式运行：

```
<NUnit Assemblies="Test/bin/$(Platform)/$(Configuration)/Product.Test.dll" Platform="x86" /> 
```

但是没有理由你不能做一个`ItemGroup`或使用`CreateItem`来创建一个与模式匹配的所有DLL的列表并以这种方式运行它。

一般来说，您正确地假设 [TeamCity] 跑步者（通常有很好的文档记录）绝对不需要明确的测试列表，无论您如何轻松地生成它们。

# c - 正确的内存分配

> ID：370720
> 
> 赞同：1
> 
> 时间：2008-12-16T08:42:50.943
> 
> 标签：c, memory, struct, hashtable, allocation

我有以下结构：

```
typedef struct bucket {
    char *key;
    ENTRY *data;
    struct bucket *next;
} bucket;

typedef struct {
    size_t size;
    bucket **table;
} hash_table; 
```

但我不知道如何为此分配内存。我试过：

```
hash_table* ht = malloc(sizeof(hash_table)*101); 
```

为了为 101 个条目创建一个哈希表，但它不起作用！谁能帮我？我真的很感激！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-16T08:57:39.807

预先分配所有 101 个（或许多）存储桶是没有意义的，在向表中插入新数据时，您通常一次分配一个。

*预先分配具有固定大小的哈希数组确实*有意义，但这是一个桶*指针数组*，而不是桶数组，所以有些答案是错误的。

你会有这样的东西，创建一个空的哈希表，有一个固定大小的桶数组：

```
hash_table * hash_table_new(size_t capacity)
{
  size_t i;

  hash_table *t = malloc(sizeof *t);
  t->size = capacity;
  t->bucket = malloc(t->size * sizeof *t->bucket);
  for(i = 0; i < t->size; i++)
    t->bucket[i] = NULL;
  return t;
} 
```

这段代码：

*   分配一个 hash_table 结构来保存表
*   用指定的容量初始化它的大小
*   分配适当长度的存储桶指针数组
*   确保每个存储桶指针为 NULL（不能使用 memset() 正确完成，因为假设“所有位为零”是 NULL 在内存中的样子是不安全的）
*   `sizeof`尽可能使用，但不在类型上，所以没有括号
*   不强制转换 的返回值`malloc()`，因为这在 C 中从来都不是一个好主意
*   不检查 malloc() 的返回值，当然你应该在实际代码中这样做

需要第二个函数来执行实际的哈希插入，然后需要分配一个新的存储桶，根据键计算哈希值，在哈希表的数组中选择正确的位置，然后在其中插入新条目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T08:47:28.377

`hash_table`总是只有`sizeof(hash_table)`字节大。`table`元素是指向元素指针数组的指针`bucket`。所以你需要这样的东西：

```
hash_table* ht = malloc(sizeof(hash_table));
ht->size = 101;
ht->table = malloc(sizeof(bucket*)*ht->size); 
```

但我怀疑可能有一些初始化方法，然后你可以做这样的事情：

```
hash_table* ht = alloc_hash_table(101); 
```

无论如何，我对 C 语言有点生疏，所以对此持保留态度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T08:48:56.890

不完全的。假设这是 C，您可能想要创建一个函数：

```
 hash_table* init_table(size_t size) {
     size_t i;
     hash_table* ht = (hash_table*)malloc(sizeof(hash_table));
     if (ht == NULL) return NULL;
     ht->size = size;
     ht->table = (bucket**)malloc(sizeof(bucket*)*size);
     if (ht->table == NULL) {
         free(ht);
         return NULL;
     }
     for (i = 0; i < size; ++i) {
         ht->table[i] = NULL;
     }
     return ht;
 } 
```

您可能需要该结构中的其他一些字段。

如果您想变得棘手，并且从不重新分配存储桶，您可以这样做：

```
 hash_table* init_table(size_t size) {
     hash_table* ht = (hash_table*)malloc(sizeof(hash_table)+sizeof(bucket)*size);
     if (ht == NULL) return NULL;
     ht->size = size;
     ht->table = (bucket**)(ht+1);
     for (i = 0; i < size; ++i) {
         ht->table[i] = NULL;
     }
     return ht;
 } 
```

编辑：我将我的 bucket* 表固定到 bucket**

EDIT2：我已经摆脱了 memset 并为 malloc 添加了错误检查。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-21T03:30:32.180

您的 typedef 有一些问题。假设您使用 MSVC。

声明您在此处拥有的类型的一种简单方法是：

此 typedef 包括 _type {} 类型，*ptype；同时声明类型和指向自定义类型的指针的格式。如果您在 hash_table 中看到向下，则可以使用 pbucket *table，它消除了代码中额外的 ***，并且可以在进行动态分配时提供帮助（帮助您保持头脑清醒，了解分配的内容等。 ）。您的原始 typedef，如果您看起来有 typedef struct bucket {} bucket;，您至少需要修改您在指定 typedef 时拥有的两个“桶”名称之一。

如果您使用 C++ 构建设置，您还需要进行转换，如果使用普通 C，您可能不需要转换，所以您的 malloc 行将是（我做了以下 typedef 更改）；

```
hash_table* ht = (phash_table) malloc(sizeof(hash_table)*101); 
```

无论哪种方式，这个片段都应该适合你；

```
typedef struct _bucket {    
    char *key;    
    void *data;    
    _bucket *next;
} bucket, *pbucket;

typedef struct _hash_table {    
    size_t size;    
    pbucket *table;
}hash_table, *phash_table; 
```

# java - java中的滚动条动作

> ID：370722
> 
> 赞同：0
> 
> 时间：2008-12-16T08:44:52.077
> 
> 标签：java, core

我是java的初学者，我有textarea，我只为那个textarea设置了垂直滚动条。我每1分钟将数据附加到textarea，问题是当新数据附加到textarea滚动条时会向上移动。要查看新数据，每次我必须拖动滚动条时，这不是必需的。我希望滚动条不应该向上移动它应该向下移动我该怎么做？请帮助我。

谢谢您的回复

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-16T08:52:55.337

每次追加时尝试将插入符号位置设置为最后一个位置：

```
textArea.setCaretLocation(textArea.getText().length()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T08:56:06.377

像这样的东西应该工作：

```
JTextArea display= new JTextArea();
JScrollPane scroll =new JScrollPane(display);

scroll.getVerticalScrollBar().addAdjustmentListener(new AdjustmentListener(){
    public void adjustmentValueChanged(AdjustmentEvent e){
        JTextArea textArea = (JTextArea)e.getSource();
        textArea.setCaretPosition(textArea.getDocument().getLength()); 
    }
}); 
```

这样，它将完全自动化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-16T08:58:03.377

你可以做

```
JTextArea textArea = new JTextArea();
DefaultCaret caret = (DefaultCaret)textArea.getCaret();
caret.setUpdatePolicy(DefaultCaret.ALWAYS_UPDATE); 
```

然后像现在一样使用*append 。*

# c# - 向 IIS 添加扩展映射

> ID：370723
> 
> 赞同：0
> 
> 时间：2008-12-16T08:45:14.447
> 
> 标签：c#, iis, wmi

如果您浏览互联网，则相对容易找到修改现有脚本映射的代码（例如，在 .NET 版本之间切换）。但是，实际添加或删除脚本映射的相对明显的代码似乎不起作用。有没有人成功地编写了可以在 IIS 6 中添加或删除脚本映射的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-16T08:53:26.663

看这里：[如何在 iis 中添加新的应用程序映射](https://stackoverflow.com/questions/265613/how-to-add-new-application-mapping-in-iis)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T07:00:03.880

给你：http: [//blogs.msdn.com/david.wang/archive/2004/12/02/273681.aspx](http://blogs.msdn.com/david.wang/archive/2004/12/02/273681.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T08:38:17.593

可以在随后的[Stack Overflow 问题](https://stackoverflow.com/questions/465548/adding-a-scriptmap-object-using-managementclasses)中找到更好的答案（即更适合我的要求，即管理远程机器和使用 .NET 的能力） 。

# excel - 运行时错误 1004：应用程序定义或对象定义错误

> ID：370730
> 
> 赞同：1
> 
> 时间：2008-12-16T08:49:32.787
> 
> 标签：excel, runtime-error, pivot-table

我一直有一个大问题……也许不是大问题，但我从昨天午餐时间开始就一直在努力解决这个问题。
我有以下代码：

```
Application.CutCopyMode = False
ActiveWorkbook.PivotCaches.Add(SourceType:=xlDatabase, SourceData:= _
    "Data!R7C1:R5000C40").CreatePivotTable TableDestination:= _
    "'[Master-File.xls]Analyse'!R20C14", TableName:="certain_view", DefaultVersion _
->   :=xlPivotTableVersion10 
```

运行时错误与箭头一致，但上面引用的整个位突出显示黄色。

> 应用程序定义或对象定义的错误

我正在使用 Excel 2003，VBA。我的代码中有这几行脚本五次，每次都只有这一行失败。我正在尝试使用这些行创建第五个数据透视表。

我认为这可能与内存中的数据量有关......但 Application.Cutopymode = False 并不能解决任何问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-19T08:20:32.610

修复了它（早些时候，Remou 指出发布答案是一件好事）。
我有点搞砸了。

我的数据是动态的，每次重新加载另一组。在我的测试集中，一切都非常好。然后，当我加载一个新集合时，值发生了变化，添加了标签，其他的被排除在外……我的一个数据透视表变得更大了。第二个被编程为在某个单元格中创建，但该单元格现在是那个更大的桌子的一部分。

不是一个非常明确的错误消息，但是'aight，它已修复。

道德：在将表格分配给工作表时，尽量考虑所有可能性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T12:38:53.853

只是猜测...... ActiveWorkbook 还可以吗？您是否尝试过使用命名工作簿？

# software-design - 您在序列图中寻找什么来表明系统架构良好？

> ID：370741
> 
> 赞同：1
> 
> 时间：2008-12-16T08:53:58.643
> 
> 标签：software-design, sequence-diagram

如序列图所示，您在方法调用序列中寻找哪些指示良好实践的习语？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-16T10:32:06.993

寻找告密的中央控制器。一个结构良好的系统将倾向于在类之间平均分配责任。相反，一个分解不良的系统往往有一个序列图，其中有许多消息进出中间的一个类，它疯狂地获取消息、做出决定、调用下属，并且通常运行一切。

并非巧合的是，该控制器类也往往很大，有很多程序代码，并且通常看起来像戴着滑稽帽子的 FORTRAN。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T10:30:40.150

对于优秀的软件工程，我会说同样的话：

*   命名（类和方法不是实例名称）
*   这些方法有多少参数（如果显示）？
*   调用链对于细节级别是否有意义（例如，纹理是精细还是粗糙？）

# .net - 将键码转换为相关的显示字符

> ID：370754
> 
> 赞同：5
> 
> 时间：2008-12-16T08:58:26.183
> 
> 标签：.net, windows, winforms, input, keyboard

在 C# Windows.Forms 项目中，我有一个不提供 KeyPressed 事件的控件（它是一个 COM 控件 - ESRI 映射）。

它仅提供包含[KeyEventArgs](http://msdn.microsoft.com/en-us/library/system.windows.forms.keyeventargs.aspx)结构的 KeyUp 和 KeyDown 事件。

如何将 KeyEventArgs 中的信息转换为可显示的 Unicode 字符，同时考虑当前活动的键盘布局等？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-17T16:04:36.590

诀窍是使用一组 user32.dll 函数：[GetWindowThreadProcessId](http://msdn.microsoft.com/en-us/library/ms633522(VS.85).aspx)、[GetKeyboardLayout](http://msdn.microsoft.com/en-us/library/ms646296.aspx)、[GetKeyboardState](http://msdn.microsoft.com/en-us/library/ms646299(VS.85).aspx)和[ToUnicodeEx](http://msdn.microsoft.com/en-us/library/ms646322(VS.85).aspx)。

1.  使用[GetWindowThreadProcessId](http://msdn.microsoft.com/en-us/library/ms633522(VS.85).aspx)函数和您的控制句柄来获得相关的本机线程 ID。
2.  将该线程 id 传递给[GetKeyboardLayout](http://msdn.microsoft.com/en-us/library/ms646296.aspx)以获取当前的键盘布局。
3.  调用[GetKeyboardState](http://msdn.microsoft.com/en-us/library/ms646299(VS.85).aspx)获取当前键盘状态。这有助于下一个方法根据修饰符状态决定生成哪个字符。
4.  最后，使用所需的[虚拟](http://msdn.microsoft.com/en-us/library/ms646322(VS.85).aspx)键码和扫描码（这两个可以相同）、当前键盘状态、作为字符串持有者（保存结果）的字符串构建器、无标志 (0) 和当前的键盘布局指针。

如果结果不为零，则只返回第一个返回的字符。

```
 public class KeyboardHelper
    {
        [DllImport("user32.dll", CharSet = CharSet.Unicode, ExactSpelling = true)]
        private static extern int ToUnicodeEx(
            uint wVirtKey,
            uint wScanCode,
            Keys[] lpKeyState,
            StringBuilder pwszBuff,
            int cchBuff,
            uint wFlags,
            IntPtr dwhkl);

        [DllImport("user32.dll", ExactSpelling = true)]
        internal static extern IntPtr GetKeyboardLayout(uint threadId);

        [DllImport("user32.dll", ExactSpelling = true)]
        internal static extern bool GetKeyboardState(Keys[] keyStates);

        [DllImport("user32.dll", ExactSpelling = true)]
        internal static extern uint GetWindowThreadProcessId(IntPtr hwindow, out uint processId);

        public static string CodeToString(int scanCode)
        {
            uint procId;
            uint thread = GetWindowThreadProcessId(Process.GetCurrentProcess().MainWindowHandle, out procId);
            IntPtr hkl = GetKeyboardLayout(thread);

            if (hkl == IntPtr.Zero)
            {
                Console.WriteLine("Sorry, that keyboard does not seem to be valid.");
                return string.Empty;
            }

            Keys[] keyStates = new Keys[256];
            if (!GetKeyboardState(keyStates))
                return string.Empty;

            StringBuilder sb = new StringBuilder(10);
            int rc = ToUnicodeEx((uint)scanCode, (uint)scanCode, keyStates, sb, sb.Capacity, 0, hkl);
            return sb.ToString();
        }
    } 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-06T14:20:14.137

Itai Bar-Haim 的解决方案很好，但有死键的问题。

第一次使用死键的扫描码调用 CodeToString(int scanCode) 时，ToUnicodeEx() 的返回码为 -1，并且您的方法返回正确的值。

但是在下一次调用时，ToUnicodeEx() 将返回 2。结果字符串将包含预期结果之前的死键，然后是内存垃圾数据。

例如，我用 ^（死键）然后用 $ 调用你的方法。第一次调用返回 ^（不错），但第二次调用返回 ^$azertyui。

你必须做两件事来解决这个问题：

1) 您必须使用 ToUnicodeEx() 返回码绝对值来设置 StringBuilder 的长度。因此，您可以避免在字符之后获取垃圾数据。

2) 当 ToUnicodeEx() 返回码为 -1 时，您必须将 StringBuilder 的第一个字符作为方法的结果。然后您必须从键盘状态中删除死键：使用空格键的扫描码调用 ToUnicodeEx()。

您可能遇到的另一个问题：如果在调用 ToUnicodeEx() 之前按下死键的用户修改了键盘状态，则返回的字符串将包含预期值之前的死键字符。我发现的一种解决方法是在实际调用之前使用空格键的扫描码调用 ToUnicodeEx()。

希望这有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T19:28:48.300

查看[KeysConverter](http://msdn.microsoft.com/en-us/library/system.windows.forms.keysconverter.aspx)及其 ConvertToString 方法。请记住，并非所有 KeyDown 都映射到 KeyPress。

# architecture - 有时离线应用架构问题

> ID：370765
> 
> 赞同：2
> 
> 时间：2008-12-16T09:04:38.810
> 
> 标签：architecture, replication, n-tier-architecture, offline

我有一个针对 sqlserver DB 运行的 n 层 winform 客户端服务器应用程序。我希望它有时能够“离线”运行（未连接到数据库）并在重新连接时重新调整对主数据库的更改。现在，我要做出艰难的架构决定：我应该使用数据库复制还是使用队列/脚本等自己管理它。我的应用程序很复杂 - 我使用包含自动增量键和表之间的外键约束的表的数据库。我的部分数据没有像图片和文档那样嵌入到数据库中。非常想听听您的意见和过去的经验！谢谢，阿迪

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-16T11:10:19.570

*（**免责声明**：我假设您已经考虑过使用 .NET 数据集并打折它们，因为它们旨在帮助解决您所描述的问题域。）*

我曾经在一家为其全国连锁店开发销售点系统的公司工作。主数据库存储在总部，而每个商店都有自己的数据库缩减版本存储在该站点的本地。实际上，每个商店都一直处于离线状态，因此与您描述的情况不太一样，但是我们必须处理一些我认为您需要处理的同步/复制问题。

我们每天晚上都进行数据通信：商店将在预定时间连接到总部，上传数据更改包，然后下载要应用于该商店本地数据库的类似数据更改包。然后，我们在两个站点（总部和商店）都有您可能称之为“数据同步引擎”的东西，它将处理这些数据包，将更改（插入/更新/删除）折叠回相关数据库。

当您像这样执行基本数据复制时，正如 Sergio 所提到的，存在许多潜在的陷阱。一个是身份，即如何派生唯一标识表行的主键。另一个是版本控制，以及如何处理同一行的不同版本之间的冲突。

在我们的例子中，我们通过使用 GUID 作为主键而不是使用自动递增列来让事情变得简单（-ier！）。使用 GUID 并非没有问题，但在我们的案例中，这意味着我们可以将主键分配给新的数据行，而不必担心其他人使用它。

我对我们如何处理版本控制问题有点模糊（已经有几年了！），但从记忆中我认为我们在每个表行上有两个时间戳：其中一个记录了行更新时的日期/时间总公司; 另一个，当它在商店更新时。每行还有两个“版本号”，表示总部和商店的行版本。数据协调涉及将这些时间戳和版本号相互比较，最近的更改“获胜”（当然假设对方没有更改行）。

正如 Sergio 所指出的，您最大的问题将是处理数据协调冲突。在我们的案例中，这发生在商店和总部在同一天更改相同的数据项时。我们通过始终在商店结束更改失败并在总部编写自定义数据协调应用程序来解决此问题，这涉及到用户直观地比较和合并数据项的两个冲突版本。从理论上讲，我认为您可以使用一些自定义处理规则自动合并不同版本，但是您需要权衡开发类似内容的成本与发生冲突的可能性。从记忆来看，这对我们的系统来说从来没有成为一个大问题，尽管有大量商店（几百家）对同一组数据进行了更改。当然是 YMMV。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T00:43:56.630

您应该查看[Microsoft Sync Framework](http://msdn.microsoft.com/en-us/sync/default.aspx)。

从头开始自己构建偶尔离线的解决方案是一项复杂的工作。在我的职业生涯中，我见过很多优秀的开发团队把它搞砸了。我并不是说你自己构建它会有问题，但为什么不使用已经存在的东西呢？如果您发现它不能满足您的需求，您可能会对如何编写自己的解决方案有更好的理解。

权衡是您必须学习同步框架，但有些示例您可能可以立即利用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T10:06:22.427

我以前从来没有做过这样的事情，但在我看来，如果你这样做，你可能会遇到严重的问题......

从技术上讲，我认为实施起来并不难。基本上，每次客户端连接到服务器时，您都必须在每个客户端上设置数据库副本并与服务器同步，但我想您已经做到了。

我会在客户端的每个表上都有一个位列和一个日期戳，这样我就可以检查哪些记录已离线更改。在服务器端，记录对对象的最后更新的日期戳列将起到作用。

至于具有自动增量的主键，我会松开它们，因为您需要自己设置它们以防止创建具有相同键的两条记录（您可能需要在同步时更改它们）。

这是简单的部分...现在事情会变得一团糟...您需要考虑到这会给您带来很多麻烦...会发生各种或不希望发生的事件，例如：-两个用户离线更改同一记录。- 一位用户在线更改记录，另一位离线更改 - 一位用户在线删除记录，而另一位用户离线处理记录

潜在问题的清单一直在继续，在您开始解决它们之前，您必须列举每一个问题并与您的客户一起记录他们希望系统如何处理每个案例，否则当他们丢失数据时（无论您如何处理，都会发生这种情况）做）这将是你的错，而不是他们的错。

我建议您为数据库中可以离线更改的每个表构建一个版本控制系统。用户会弄乱他们的数据，执行回滚对他们来说会很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-16T11:45:09.420

我现在已经在不同的地方做过几次了（参见下面史蒂夫·兰德斯的回答），我强烈建议你不要使用正常的复制——尤其是在涉及多个数据库的情况下。

我这么说的原因是，根据我的经验，复制不够聪明，无法处理当您使远程站点重新联机时（或当您决定将新站点添加到整个网络时）可能出现的问题。

如果您只有 2 或 3 个不同的数据库，但如果您谈论的是可以随时在线/离线的许多不同位置，并且可以随时添加（或删除或修改）信息，则复制对于这种事情来说很好在这些位置中，您很快就会使某些东西陷入混乱状态。从技术上讲，这不是一件很令人满意的事情，但是您总是能够想到特殊情况，您不希望复制按照设计去做它想做的事情。

如果您只处理 2 个数据库，那么显然复制问题会变得更加简单，您可能会发现可以使用合并复制来完成这项工作（尽管您必须注意数据库设计）。

我刚买了一本 Apress SQL Server 2005 复制圣经的二手​​副本（不在办公室，所以没有作者在手，但这是一本值得推荐的怪物大部头）——在前几章中，我开始意识到，如果您真的要在两个（或更多）端更改数据，复制并不是一个灵丹妙药的解决方案。:-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-24T12:41:42.480

这通常称为公文包模型，您可以使用 [Microsoft Synchronization Services for ADO.NET](http://www.google.com/search?q=+Microsoft+Synchronization+Services+for+ADO.NET)

# javascript - 如何有效地管理 Perl 模块以实现代码重用？

> ID：370766
> 
> 赞同：2
> 
> 时间：2008-12-16T09:07:00.397
> 
> 标签：javascript, perl, code-reuse, module-management

我的公司结合使用 mod_perl、axkit 和 apache 开发 Web 应用程序。我们有大量的 Perl 模块、javascript 等，都在 unix 操作系统中。

每当我需要编写一个新函数时，我都会尝试做一些代码重用，但问题是所有 Perl 模块和 javascript 都分散在文件夹中。

我讨厌写一些代码，只是后来发现已经有一个函数做了同样的事情，我目前的方法涉及尝试 grep 表名以查看是否有冗余函数，但除此之外，我几乎会放弃并编写一个新函数，因为我不想花太多时间搜索并一无所获。

有一个更好的方法吗？或者更好的是，有没有我可以安装的免费软件工具来帮助我正确管理所有功能和模块，甚至允许开发人员记录评论等。

## 编辑

有关于使用工具检测 c++ 上的代码重复的[讨论](https://stackoverflow.com/questions/191614/how-to-detect-code-duplication-during-development)，对于 unix 平台中的 perl 代码，我们有类似的东西吗？

谢谢~史蒂夫

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-16T10:25:50.407

**组织**您的源目录，使每个功能只有一个位置，并且很容易找到。

确保共享**命名约定**以防止重复。

**设计**你的模块，让他们只做一件事——并且把它做好。

**检查**代码以确保名称和位置正确。

提供基于代码索引器的高效**搜索引擎**，以便轻松查看是否已经有函数在执行特殊任务。

不要低估**泛化**现有组件以便有效重用它的时间。

**使用 API文档**和/或单元测试记录模块。

**在团队内部进行沟通**，以便每个人都能很好地掌握可能已经编写的内容，谁拥有或知道谁可能正在处理/使用一个模块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T10:19:27.737

我相信您有某种形式的版本控制软件（[svn](http://subversion.tigris.org/)、[Mercurial](http://selenic.com/wiki/Mercurial)、 git 等等，但不是 VSS）？如果你不这样做，现在是时候买一个并开始使用它了。这样，您至少知道您正在使用哪些模块以及代码在哪里。您还可以使用类似[ctags 的](http://en.wikipedia.org/wiki/Ctags)方法来索引您已编写（或正在使用）的所有模块。

IDE（尽管我不喜欢这些）也可以帮助查找代码和重构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T10:28:53.100

我曾经在一家使用 Perl 的公司工作过，也遇到过类似的问题。我们提出的解决方案是重新组织文件中的功能，考虑到 3 层架构（表示、业务和持久性）以及被操作的元素。

因此，我们对数据库中的每个主表都有一个 perl 文件，每个实体都有一个 perl 文件来操作它们的业务操作，等等......这样，很容易避免代码重复，因为您确切地知道在哪里寻找给定的功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-16T10:37:32.023

这是我非常感兴趣的事情。

使用像 svn、git 或 bazaar 这样的简单版本控制软件并不是我想要的。除了这样的系统之外，VCS 是强制性的，但它不是这个系统。经过一些研究，我被告知要研究包装以实现这一目标，我认为某种包装系统是可行的方法。

如果您想要一个打包系统的示例，请查看 debians APT。每个包都有版本描述和源代码的依赖关系，并且给定一个好的打包系统，您可以像“魔术搜索集方程固定点”一样，魔术打包系统将找到一个解决问题的模块。如果您在源代码中包含该包，它还会添加所有缺少的依赖项，例如可能是图形等。

然而，对此的研究是在我笔记本电脑的硬盘驱动器死机前不久开始的，这将进一步的研究和实际结果推迟到这个方向，但也许你能找到一些有趣的东西（告诉我*轻推，轻推*）

HTH，特萨

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-16T14:47:43.797

如果您的模块包含[POD 文档并且安装在一个公共目录或一组目录下，那么使用](http://search.cpan.org/perldoc?perlpod)[pod2html](http://search.cpan.org/perldoc?pod2html)生成 HTML 文档应该相对容易。获得 HTML 文档后，输入全文搜索索引（带有 fts3、MySQL、Lucene、KinoSearch 等的 SQLite）和一个简单的搜索表单应用程序（CGI 或 mod_perl），您就可以开始了。

如果您使用 trac，则有一个[插件](http://trac.eprints.org/projects/iar/wiki/PerlDocPlugin)可以从您的 .pod 和 .pm 文件创建 trac wiki 页面，同样，使您的文档易于搜索。

# string - 在 C++ 中将索引映射到字符串的最简单方法

> ID：370768
> 
> 赞同：0
> 
> 时间：2008-12-16T09:07:10.440
> 
> 标签：string, indexing, map

要求：

*   必须能够使用 C 字符串以及 C++ 字符串
*   快速地
*   没有地图
*   没有模板
*   没有直接查找，即索引可能超出范围。
*   索引不连续
*   一个头文件中包含的枚举和字符串
*   仅实例化您使用的内容。

到目前为止，这是我想出的：

```
- test.hh -

// Generic mapper
// 
// The idea here is to create a map between an integer and a string.
// By including it inside a class we prevent every module which
// includes this include file from creating their own instance.
//
struct Mapper_s
{
   int Idx;
   const char *pStr;
};

// Status
enum State_t
{
   Running = 1,
   Jumping = 6, 
   Singing = 12
};

struct State_s
{
   static const Mapper_s *GetpMap(void)
   {
       static Mapper_s Map[] = 
       {
            { Running,   "Running" },
            { Jumping,   "Jumping" },
            { Singing,   "Singing" },
            { 0,   0}
        };
        return Map;
    };
};

- test.cc -
// This is a generic function 
const char *MapEnum2Str(int Idx, const Mapper_s *pMap)
{
    int i;
    static const char UnknownStr[] = "Unknown";

    for (i = 0; pMap[i].pStr != 0; i++)
    {
        if (Idx == pMap[i].Idx)
        {
            return pMap[i].pStr;
        }
    }

    return UnknownStr;
}

int main()
{
   cout << "State: " << MapEnum2Str(State, State_s::GetpMap()) << endl;
   return 0;
} 
```

关于如何改进这一点的任何建议？

感觉头文件看起来有点杂乱...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T10:25:15.300

最快的执行：建立一个哈希表。由于您提前知道索引，您甚至可以构建一个[完美的哈希表。](http://burtleburtle.net/bob/hash/perfect.html)

最容易编程：使用大量 switch 语句，并希望编译器知道如何针对不连续的案例整数进行优化。至少字符串将存在于可执行文件本身的 .text 段中，因此您不需要实例化任何内容：

```
// Status
enum State_t
{
   Running = 1,
   Jumping = 6, 
   Singing = 12
};

const char *StateToString(State_t state)
{
  switch(state)
  {
    case Running: return "Running";
    case Jumping: return "Jumping";
    case Singing: return "Singing";
    default: return "ERROR"; 
  }
} 
```

您可以将所有内容隐藏在宏中（如 Suma 的链接所建议的那样），因此它不是 WTF。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T11:51:53.750

这是我决定的。使用这种技术，您需要做的就是包含一个头文件。您只会实例化您使用的内容。您还可以存储一个完美的哈希表，而不仅仅是 Idx 和 pStr。这种方法在 C 中不起作用。

文件：e2str.hh

```
struct Mapper_s
{
    int Idx;
    const char *pStr;
};

#define ENUM2STR_BEGIN(x) struct x { static const Mapper_s *GetpMap(void) {  static const Enum2StrMap_s Map[] = 
#define ENUM2STR_END      return Map; }; }

const char *MapEnum2Str(int Idx, const Mapper_s *pMap); 
```

文件：mapper.hh

```
#include "e2str.hh"

ENUM2STR_BEGIN(State_s) 
{
        { Running,   "Running" },
        { Singing,   "Singing" },
        { Jumping,   "Jumping" },
        { 0, 0}
};
ENUM2STR_END; 
```

文件：test.cc

```
#include "mapper.hh"
int main()
{
   cout << "State: " << MapEnum2Str(State, State_s::GetpMap()) << endl;
   return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T09:32:23.760

> 我无法进行直接映射，因为一个应用程序可能会向我提供超出我的字符串列表范围的值。直接查找虚无将是至关重要的。

因此，在返回值之前将对象计数添加到访问器检查的数组中：

```
struct map {
const char *mapping[] = { "Running", "Jumping", "Singing" };
const int count = 3;
} 
```

或者如果你想让它自动化

```
struct map {
map() { 
  for( count = 0; strlen( mapping[count] ); ++i )
}

const char *mapping[] = { "Running", "Jumping", "Singing", "" };
int count;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-16T10:24:35.170

[在 C 中使用枚举类型的变量作为字符串的简单方法](https://stackoverflow.com/questions/147267/easy-way-to-use-variables-of-enum-types-as-string-in-c#202511)怎么样？

在这种风格中，枚举和字符串不仅包含在一个文件中，还包含在一个位置。您可以轻松扩展工厂以在 SOME_ENUM 中接受更多“列”，在您的情况下，您可能希望字符串不是从名称生成，而是明确提供。

# sql-server-2008 - 如何打开Sql2008表

> ID：370769
> 
> 赞同：0
> 
> 时间：2008-12-16T09:07:36.027
> 
> 标签：sql-server-2008

我想通过 Sql 2008 企业管理器界面打开表

与 Sql2005 企业管理器界面一样，通过右键单击然后单击打开表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-16T09:15:57.303

右键单击有问题的表并选择“编辑前 200 行”。

“200”可从“ *SQL Server 对象资源管理器*”下的**工具\选项**对话框中配置

 **将“编辑前行命令*的值”的值更改为**0**将返回所有行进行编辑，其方式与SSMS 2005 中的“*打开表”类似。*

您还可以在选择“*编辑前 200 行”后使用***Ctrl+3**显示底层 SQL，并手动更改查询以自定义显示哪些行进行编辑。

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T09:11:18.997

我认为此功能已被删除。尝试“编辑前 200 行”命令。它会做同样的事情，但不会获取（可能）巨大表的每一行。

# asp.net-mvc - 在 contentplaceholder 中添加标题会添加第二个空标题标签

> ID：370783
> 
> 赞同：5
> 
> 时间：2008-12-16T09:16:54.523
> 
> 标签：asp.net-mvc, title

我的母版页在 head 标记中有一个 contentplaceholder。

因为我希望我的页面标题代表当前页面的功能，并且因为我希望将标题翻译成用户的语言，所以我在页面头部的 contentplaceholder 中添加了一个标题标签。除了现在出现了第二个空的标题标签之外，所有的一切都很好。

任何想法如何解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-16T09:48:22.853

根据[W3C 规范](http://www.w3.org/TR/REC-html40/struct/global.html#h-7.4.2)：

> 每个 HTML 文档的 HEAD 部分都必须有一个 TITLE 元素。

因此，ASP.Net 平台符合标准并为您的页面添加一个空的标题标签以帮助您实现有效的标记 - 它不知道您将通过内容占位符添加一个。

在经典的 ASP.Net 下，您的选择是：

1.  使用@page 指令Title 来设置这个标签的内容
2.  使用后面代码中的 Page.Title 属性以编程方式设置值。

如果您使用的是 ASP.Net MVC，则默认 Site.Master 文件具有以下默认文本：

```
<title><%= Html.Encode(ViewData["Title"]) %></title> 
```

默认控制器具有：

```
ViewData["Title"] = "Home"; 
```

在操作结果中，再次允许以编程方式访问页面标题。

通常我使用 HeadContent 内容占位符来添加特定于页面的静态脚本和 css 链接。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-04T17:10:03.367

我遇到了同样的问题，并[找到了一个](http://blogs.lotterypost.com/speednet/2007/07/aspnet-tip-how-to-prevent-the-title-tag-fro.htm)似乎可行的解决方案。这很hacky，但同时也很简单。只需在头部添加另一个标题标签，在其中放置一个 runat="server" 属性，然后将其可见性设置为 false：

```
<title visible="false" runat="server"><%-- hack to turn the auto title off --%></title> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-04T17:45:15.513

您可以[尝试我发布到这个问题的解决方案](https://stackoverflow.com/questions/595692/element-title-occurs-too-few-times-xhtml-validation-warning-in-asp-net-mvc-mas/595700#595700)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-16T09:24:32.280

@Page 指令中有一个名为 Title 的属性，用于设置页面的标题。它也可以作为 Page 控件上的属性访问。

您不需要通过内容占位符在标签内显式声明 a。

至少它适用于使用 MasterPages 的基本 ASP.NET 页面。对于 ASP.NET MVC 不太确定。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-19T14:52:22.793

清除 masterpages 标签上的 runat="server" 属性

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-31T10:30:37.113

设置标题的最佳方法似乎是在此处的标记声明中使用标题属性：

```
<%@ Page Title="PAGE NAME HERE" Language="C#" MasterPageFile="~/Controls/MasterPage/MasterPage.master"
AutoEventWireup="true" CodeFile="Default.aspx.cs" Inherits="Default" %> 
```

或者只需在 page_load 中设置它

```
Page.Title = "Your page title" 
```

希望这有点。

# visual-studio - Windows 中的 SSL 套接字。图书馆？同步/异步？线程？

> ID：370784
> 
> 赞同：3
> 
> 时间：2008-12-16T09:20:15.360
> 
> 标签：visual-studio, multithreading, sockets, mfc, ssl

我有一个 2 线程应用程序。一个 GUI 线程和一个工作线程 (CWinThread)，我在其中进行耗时的操作 - 计算和 HTTP 通信。

我必须从 HTTP 切换到 SSL 套接字连接。我还需要验证服务器证书（它是否受信任、是否过期、**是否已撤销**）

1.  哪个库用于 SSL 套接字（MFC、Boost 或其他）？

2.  我必须使用同步还是异步操作？我认为如果我使用异步操作，我可以实现可以从 GUI 线程调用的取消功能。

3.  如果我使用异步操作，在第一个线程中移动套接字操作会更好吗？

4.  SSL 协议是否支持流数据压缩？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-16T12:00:52.680

对于 SSL 支持 - 看看 openssl.org

取消支持很好；要做到这一点，如果请求取消，您必须定期从工作线程检查。注意使用 volatile 变量或使用关键部分保护对它的访问。不要从 GUI 线程执行网络操作，即使它是异步的。最好不要从 GUI 线程执行任何类型的 IO，以确保它具有响应性，更重要的是，它不会挂起。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T12:24:09.623

+1 为 OpenSSL.org

早在 2002 年，我就在“Windows Developer Magazine”中写过关于将 OpenSSL 与异步 Windows 套接字集成的文章，可以在此处找到该文章：[http ://www.serverframework.com/asynchronousevents/2010/10/using-openssl-with-asynchronous- sockets.html](http://www.serverframework.com/asynchronousevents/2010/10/using-openssl-with-asynchronous-sockets.html)包含一个使用 OpenSSL 的简单 MFC 客户端的源代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T12:42:38.697

还有另一个免费库 SOcketPro，可在此处获得：

[http://www.udaparts.com/document/articles/demome.htm](http://www.udaparts.com/document/articles/demome.htm)

Rgds, moster67

# asp.net - 如何在 ASP.NET 中使用 Crystal Reports？

> ID：370796
> 
> 赞同：6
> 
> 时间：2008-12-16T09:26:51.103
> 
> 标签：asp.net, crystal-reports

如何在 ASP.Net 2.0 中使用水晶报表。任何展示如何在生产服务器上部署 Crystal Reports 的示例/教程/示例。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-16T09:49:55.520

我自己刚刚经历过这种痛苦，这里有一些建议，希望能节省你的时间......

[MSDN 上的 Crystal Reports](http://msdn.microsoft.com/en-us/library/bb126227.aspx) - 这里有很多好东西

[我应该对 Crystal Reports 使用哪种持久性方法](http://msdn.microsoft.com/en-us/library/ms225433.aspx)- 提供有关如何最好地控制报表对象的生命周期的详细信息和代码示例

[这篇文章](http://www.crystalreportsbook.com/forum/forum_posts.asp?TID=2709&PN=1)还提供了一些关于报表对象生命周期的好建议

部署... 最新的 Crystal Reports 运行时不在 64 位环境中运行，因此如果部署到 64 位服务器，您要么必须将 IIS 配置为运行 32 位模式，要么使用以前版本的运行时。我最幸运的是与 VS2008 一起分发的运行时，这可以在

> C:\Program Files\Microsoft SDKs\Windows\v6.0A\Bootstrapper\Packages\CrystalReports10_5

我注意到您使用的是 ASP.NET 2.0 - 我确信有一个 VS2005 等效运行时。尝试让部署环境在项目的早期工作，因为它无疑会比你预期的更令人头疼。

最后，值得一提的是，Crystal Reports 中的标准参数屏幕仅能带您到此为止。如果您想对如何向用户呈现参数变得复杂（例如，通过使参数依赖于另一个参数的选择），您将需要滚动您自己的参数屏幕。这相当容易，因为对象模型使您可以访问您需要的有关参数的所有信息。我们已经创建了一个通用参数屏幕，该屏幕根据它所指向的报告中的参数构建自身。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T16:28:59.400

这是我通常使用的代码：

```
'Generate the Report
Dim oRpt As New ReportDocument
Dim reportPath As String = Server.MapPath("crtTAL.rpt")
oRpt.Load(reportPath)

oRpt.SetDataSource(dsTAL)

If Not IO.Directory.Exists(tempLocation) Then
    IO.Directory.CreateDirectory(tempLocation)
End If

If IO.File.Exists(tempLocation & filename) Then
    IO.File.Delete(tempLocation & filename)
End If

' ********************************

' First we must create a new instance of the diskfiledestinationoptions class and
' set variable called crExportOptions to the exportoptions class of the reportdocument.
Dim crDiskFileDestinationOptions As New DiskFileDestinationOptions
Dim crExportOptions As ExportOptions = oRpt.ExportOptions

'Export to Word

'append a filename to the export path and set this file as the filename property for
'the DestinationOptions class
crDiskFileDestinationOptions.DiskFileName = tempLocation + filename

'set the required report ExportOptions properties
With crExportOptions
    .DestinationOptions = crDiskFileDestinationOptions
    .ExportDestinationType = ExportDestinationType.DiskFile
    .ExportFormatType = ExportFormatType.WordForWindows
End With

'Once the export options have been set for the report, the report can be exported. The Export command
'does not take any arguments
Try
    ' Export the report
    oRpt.Export()
    oRpt.Close()
    oRpt.Dispose()
    projectCount = projectCount + 1
Catch err As Exception
    Response.Write("<BR>")
    Response.Write(err.Message.ToString)
    errorList = errorList & dtrProjects.Item("Title") & "; "
End Try 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-05T17:13:58.900

这就是我通常使用的，Asp.net/C#

```
public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {

        ///create instance of class first
        ReportDocument rpDoc = new ReportDocument();
        ///load the report
        rpDoc.Load(@"TicketingBasic.rpt");

        ///pass the report to method for dataInfo
        getDBInfo(rpDoc);
        /// et the source for report to be displayed
        CrystalReportViewer1.ReportSource = rpDoc;
    }

    protected static void getDBInfo(ReportDocument rpDoc)
    {
        ///Connection Onject
        ConnectionInfo cn = new ConnectionInfo();
        ///DataBase,Table, and Table Logon Info
        Database db;
        Tables tbl;
        TableLogOnInfo tblLOI;

        ///Connection Declaration
        cn.ServerName = "??????";
        cn.DatabaseName = "???????";
        cn.UserID = "???????";
        cn.Password = "????????";

        //table info getting from report
        db = rpDoc.Database;
        tbl = db.Tables;

        ///for each loop for all tables to be applied the connection info to
        foreach (Table table in tbl)
        {
            tblLOI = table.LogOnInfo;
            tblLOI.ConnectionInfo = cn;
            table.ApplyLogOnInfo(tblLOI);
            table.Location = "DBO." + table.Location.Substring(table.Location.LastIndexOf(".") + 1);

        }

        db.Dispose();
        tbl.Dispose();
    } 
```

在 Aspx 方面：

```
<CR:CrystalReportViewer 
    ID="CrystalReportViewer1" 
    runat="server" 
    AutoDataBind="true" 
    EnableDatabaseLogonPrompt="false"
     /> 
```

# c# - StreamReader 问题 - 未知文件编码 (western iso 88591)

> ID：370801
> 
> 赞同：2
> 
> 时间：2008-12-16T09:29:15.547
> 
> 标签：c#, encoding, character-encoding, inputstream, streamreader

从输入文件中读取数据时，我注意到 ¥ 符号没有被 StreamReader 读取。Mozilla Firefox 将输入文件类型显示为 Western (ISO-8859-1)。

在玩弄了编码参数后，我发现它成功地适用于以下值：

```
System.Text.Encoding.GetEncoding(1252) // (western iso 88591)

System.Text.Encoding.Default 

System.Text.Encoding.UTF7 
```

现在我计划使用“默认”设置，但是我不太确定这是否是正确的决定。现有代码没有使用任何编码，我担心我可能会破坏某些东西。

我对编码知之甚少（或者几乎一无所知）。我该怎么做？我决定使用 System.Text.Encoding.Default 安全吗？我应该要求用户以特定格式保存文件吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-16T09:39:24.107

代码页 1252 与 ISO-Latin-1 不太一样。如果您想要 ISO-Latin-1，请使用`Encoding.GetEncoding(28591)`. 但是，我希望它们对于这个代码点 (U+00A5) 是相同的。UTF-7 是完全不同的（几乎从来没有你想使用的）。

`Encoding.Default`*不安全*- 在大多数情况下，这是一个非常糟糕的主意。它特定于您正在运行的特定计算机。如果您将文件从一台计算机传输到另一台计算机，谁知道原始计算机使用的是什么编码？

如果您知道您的文件在 ISO-8859-1 中，请明确使用它。是什么产生了这些文件？如果他们只是被用户保存，他们被保存在什么程序中？如果 UTF-8 是一个选项，那是一个很好的选项 - 部分原因是它可以处理整个 Unicode。

我有[一篇关于 Unicode](http://pobox.com/~skeet/csharp/unicode.html)的文章和另一篇关于[调试 Unicode 问题](http://pobox.com/~skeet/csharp/debuggingunicode.html)的文章，您可能会发现它们很有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-16T10:04:34.867

> 现有代码未使用任何编码

它可能没有明确指定编码，在这种情况下，编码可能默认为 Encoding.UTF8。

名称 Encoding.Default 可能给人的印象是这是 StreamReader 等类使用的默认编码，但事实并非如此：正如 Jon Skeet 指出的那样，Encoding.Default 是操作系统当前 ANSI 代码页的编码。

我个人认为这使得属性名称 Encoding.Default 有点误导。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-16T10:21:30.090

您是软件开发人员吗？不要忘记阅读 Joel Spolsky 的 [**The Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses!)**](http://www.joelonsoftware.com/articles/Unicode.html)

# c# - 容器接口-详解

> ID：370809
> 
> 赞同：0
> 
> 时间：2008-12-16T09:38:04.450
> 
> 标签：c#, oop

我只是在阅读一个简短地介绍了容器接口的讲座。我没有完全理解这些材料，也无法通过谷歌找到太多内容。我想知道的是，你们中的任何人都可以用现实世界的术语来解释它吗？还解释替代方案以及何时更好地使用哪个？如果是这样的话。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-16T09:46:15.650

我假设您在 System.ComponentModel 中谈论 IContainer。基本上，这是一个定义组件容器的预期行为的接口。这允许您创建 ComponentCollection 可以使用的不同容器。

请注意，IContainer 不一定必须包含可视组件 - 组件仅是数据是完全有效的。

# java - 在没有双重调度/访问者模式的情况下解决 Java 的静态方法调度

> ID：370812
> 
> 赞同：3
> 
> 时间：2008-12-16T09:41:25.363
> 
> 标签：java, overloading, multiple-dispatch, method-dispatch, dynamic-dispatch

我正在使用一个`Foo`提供这些方法的类：

```
String overloadedMethod(Object)
String overloadedMethod(Goo) 
```

由于 Java 在 non-receiver 参数上静态分派，我不能只传递 my `value`（这是一个`Object`，但可能具有动态类型`Goo`）并依赖 JVM 动态选择“正确”方法。

这是我目前（丑陋）的解决方法：

```
Object value = ...;
Foo foo = new Foo();
if (value instanceof Goo) {
    Goo gooValue = (Goo) value;
    return foo.overloadedMethod(gooValue); // -> overloadedMethod(Goo)
} else {
    return foo.overloadedMethod(value);    // -> overloadedMethod(Object)
} 
```

有没有更好的方法可以在*不修改`Foo`*（包含重载方法的类）中的代码的情况下做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-16T09:43:26.280

当然，您总是可以使用反射来找到适用的方法的最具体版本，但这可能会很快变得棘手。

但是如果这两个调用导致完全不同的行为，那么 Foo 要么被设计用于访问者模式（即双重调度），要么被破坏。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-16T10:21:17.500

您可以查看[Java MultiMethod Framework](http://www-igm.univ-mlv.fr/~forax/works/jmmf/index.html)。它几乎是您提议的一个层，但至少它被抽象为一个逻辑模块，这不是您的责任？

（据我所知，如果不求助于反射/黑客实例，就没有干净的方法来做到这一点）

# sql-server - SQL Server 到 Oracle10g 的转换

> ID：370813
> 
> 赞同：2
> 
> 时间：2008-12-16T09:42:15.347
> 
> 标签：sql-server, database, oracle

我目前有一个 SQL Server (Express 2005) 数据库来保存一些我现在想要迁移到 Oracle 10g express 实例的事务/元数据。

您可以以编程方式执行此操作，还是有任何人都可以推荐的不错的软件工具？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-16T10:04:52.307

Oracle Migration Workbench[包含在 SQL Developer](http://www.oracle.com/technology/tech/migration//workbench/index_sqldev_omwb.html)中。看看它是否满足您的需求。

# java - 如何在第三方库的 Eclipse 中设置断点？

> ID：370814
> 
> 赞同：60
> 
> 时间：2008-12-16T09:42:20.403
> 
> 标签：java, eclipse, debugging, breakpoints

我从第 3 方库的类中获得 NullPointerException。现在我想调试整个事情，我需要知道该类是从哪个对象中保存的。但在我看来，我无法在第 3 方的类中设置断点。

有谁知道摆脱我的麻烦的方法？当然，我使用 Eclipse 作为我的 IDE。

更新：该库是开源的。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2008-12-16T09:45:05.857

您可以轻松地在 3rd 方库中设置方法断点，而无需源代码。只需打开课程（您将获得“我没有来源”视图）。打开大纲，右键单击您想要的方法并单击`Toggle Method Breakpoint`以创建方法断点。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2008-12-16T20:39:51.323

最可靠的方法（最终得到一些真正有用的东西）是下载源代码（你说它是开源的），然后设置另一个指向该源的“Java 项目”。

为此，请在系统的某个位置下载并解压缩源代码。单击“文件”->“新建”->“Java 项目”。在下一个对话框中，给它一个项目名称并选择“从现有源创建项目”。浏览到开源库的根位置。

假设项目所需的所有其他库等都包含在您下载的项目中，Eclipse 将解决所有问题并为您设置构建路径。

您需要从项目的构建路径中删除开源 jar，并将这个新项目添加到项目的构建路径中。

现在，您可以将其视为您的代码，并随意调试。

这至少解决了其他方法的几个问题：

1.  您可以将源“附加”到 jar 文件，但如果 jar 文件是在没有调试信息的情况下编译的，这仍然不起作用。如果 jar 文件是使用调试信息编译的（`lines,source,vars`...请参阅[http://java.sun.com/j2se/1.3/docs/tooldocs/win32/javac.html](http://java.sun.com/j2se/1.3/docs/tooldocs/win32/javac.html)和`-g`选项）。

2.  您可以添加一个“异常断点”来查看何时引发 NullPointerException，但这是一个常见的异常，并且很可能在您正在寻找的那个之前被引发和处理很多次（数百次？）。另外，如果没有原始源代码，您将无法真正看到有关引发 NullPointerException 的代码的任何内容 - 您能够找出问题所在的可能性非常低。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-16T10:29:51.773

您还可以在特定异常上设置断点。从调试的角度来看，有一个“添加 Java 异常断点”按钮，您可以在其中添加“NullPointerException”。一旦引发此类异常，您的调试器就会暂停执行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-16T10:25:20.907

通常，您应该能够设置断点。特别是如果 3rd 方库是开源的。但是，如果您的第 3 方库来自商业供应商，他们可能已经在关闭调试标志的情况下编译了源代码。这将使您无法对其进行调试。您的供应商可能已将其作为混淆过程的一部分，以使其无法对库进行逆向工程，或者仅仅是因为最终编译的类会更小。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-10-12T19:43:48.267

为了使用 maven 物化 Web 应用程序来完成这项工作，我必须做三件事。

1) 使用第 3 方 jar 的源代码创建一个新的 eclipse 项目。

2) 从 pom.xml 依赖项中删除对 j​​ar 的引用。

3）在项目属性中将新的eclipse项目添加到Deployment Assembly。

4) 将新的 eclipse 项目添加到项目 Properties -> Java Build Path -> Projects 中引用 3rd 方项目的现有项目。

如果第三个项目已正确添加到您的 maven 存储库中，并且带有源代码，maven 将自动下载适当的源代码并让您添加断点，而无需执行上述任何步骤；但是，我了解到您不能总是指望这一点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-28T12:26:07.127

只需附加源（或使用自动附加源 jar 的东西），然后通过双击感兴趣行的左侧以正常方式设置断点。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-12-11T20:32:48.727

在 maven 项目中，您可以轻松地在项目浏览器视图中打开 maven 依赖项树视图，并查看项目所依赖的 jar 文件列表。打开项目资源管理器，然后展开您的项目。然后，查找 maven 依赖项并展开此树视图。现在，您可以展开任何 jar 文件并查看可用类的列表，然后在其中任何一个上按 Enter，Eclipse 将为您反编译源代码，您可以设置断点。如果您的项目有子 maven 模块项目，您应该在模块中查找依赖项。我推荐安装[Enhance 类反编译器插件](https://marketplace.eclipse.org/content/enhanced-class-decompiler)，这样你就可以在没有源代码的情况下轻松调试你的项目，或者你可以为 eclipse 指定源以避免[找不到源](https://stackoverflow.com/questions/6174550/eclipse-java-debugging-source-not-found)调试时。如果第三方jar文件的源已经在eclipse中作为项目打开，则不能在Maven依赖项中展开它。

# linq - 包含空值的 DataSource 使 ComboBox 失败

> ID：370817
> 
> 赞同：0
> 
> 时间：2008-12-16T09:44:22.160
> 
> 标签：linq, data-binding, combobox, c#-2.0, datasource

我已经使用 Linq 将自己一头扎进了 C# 和 .Net 2.0 中，并且在调试一些问题时遇到了一些问题，即以下问题：

我有一个 ComboBox 控件 ( `cmbObjects`) 我想用一组使用 Linq 检索的对象进行填充。我编写了一个辅助方法来填充`List<T>`泛型：

```
class ObjectProvider
{

    public static List<T> Get<T>(bool includeNull) where T : class, new()
    {
        List<T> list = new List<T>();
        LutkeDataClassesDataContext db = ConnectionManager.GetConnection();
        IQueryable<T> objects = db.GetTable<T>().AsQueryable();

        if (includeNull) list.Add(null);

        foreach (T o in objects) list.Add(o);

        return list;
    }

    public static List<T> Get<T>() where T : class, new()
    {
        return Get<T>(false);
    }
} 
```

我在使用 true 或 false 调用函数时验证了结果 -`List`确实包含正确的值，当传递 时`true`，它包含`null`作为第一个值，然后是其他对象。

但是，当我将 分配`DataSource`给`ComboBox`时，控件只是拒绝显示任何项目，包括`null`值（不可选择）：

```
cmbObjects.DataSource = ObjectProvider.Get<Car>(true); 
```

传入`false`（或无参数）确实有效 - 它显示所有对象。

有没有办法让我为第一个对象指定一个“空”值而不使用幻数对象（比如在数据库中有一个虚假条目只是为了指定一个 N/A 值）？类似于可为空的东西是理想的，但我有点迷路了。

另外，我尝试添加`new T()`而不是添加`null`到列表中，但这只会导致`OutOfMemoryException`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T10:07:19.930

组合框控件具有将数据绑定项附加到列表中硬编码项的选项。所以你硬编码你的 n/a 值，数据绑定真实值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T10:04:05.880

`DataSource`好的，如果您尝试添加一个`null`值，它似乎变得无效。解决方案是通过一个简单的`foreach`循环添加项目，在开始时使用一个空字符串，而不是分配`List<>`.

# java - 在 Java 中构建 SQL 字符串的最简洁方法

> ID：370818
> 
> 赞同：117
> 
> 时间：2008-12-16T09:44:37.747
> 
> 标签：java, sql, oracle, string

我想构建一个 SQL 字符串来进行数据库操作（更新、删除、插入、选择等）——而不是使用数百万个“+”和引号的糟糕的字符串 concat 方法，这充其量是不可读的——那里必须是更好的方法。

我确实考虑过使用 MessageFormat - 但它应该用于用户消息，虽然我认为它会做一个合理的工作 - 但我想应该有一些更符合 java sql 库中的 SQL 类型操作的东西。

Groovy 会有用吗？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2008-12-16T10:15:44.453

首先考虑在准备好的语句中使用查询参数：

```
PreparedStatement stm = c.prepareStatement("UPDATE user_table SET name=? WHERE id=?");
stm.setString(1, "the name");
stm.setInt(2, 345);
stm.executeUpdate(); 
```

可以做的另一件事是将所有查询保存在属性文件中。例如在 queries.properties 文件中可以放置上述查询：

```
update_query=UPDATE user_table SET name=? WHERE id=? 
```

然后借助一个简单的实用程序类：

```
public class Queries {

    private static final String propFileName = "queries.properties";
    private static Properties props;

    public static Properties getQueries() throws SQLException {
        InputStream is = 
            Queries.class.getResourceAsStream("/" + propFileName);
        if (is == null){
            throw new SQLException("Unable to load property file: " + propFileName);
        }
        //singleton
        if(props == null){
            props = new Properties();
            try {
                props.load(is);
            } catch (IOException e) {
                throw new SQLException("Unable to load property file: " + propFileName + "\n" + e.getMessage());
            }           
        }
        return props;
    }

    public static String getQuery(String query) throws SQLException{
        return getQueries().getProperty(query);
    }

} 
```

您可以按如下方式使用您的查询：

```
PreparedStatement stm = c.prepareStatement(Queries.getQuery("update_query")); 
```

这是一个相当简单的解决方案，但效果很好。

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2011-08-09T06:33:54.473

对于任意 SQL，请使用[jOOQ](http://www.jooq.org)。jOOQ 目前支持`SELECT`, `INSERT`, `UPDATE`, `DELETE`, `TRUNCATE`, 和`MERGE`. 您可以像这样创建 SQL：

```
String sql1 = DSL.using(SQLDialect.MYSQL)  
                 .select(A, B, C)
                 .from(MY_TABLE)
                 .where(A.equal(5))
                 .and(B.greaterThan(8))
                 .getSQL();

String sql2 = DSL.using(SQLDialect.MYSQL)  
                 .insertInto(MY_TABLE)
                 .values(A, 1)
                 .values(B, 2)
                 .getSQL();

String sql3 = DSL.using(SQLDialect.MYSQL)  
                 .update(MY_TABLE)
                 .set(A, 1)
                 .set(B, 2)
                 .where(C.greaterThan(5))
                 .getSQL(); 
```

除了获取 SQL 字符串，您还可以使用 jOOQ 执行它。看

[http://www.jooq.org](http://www.jooq.org)

（免责声明：我为 jOOQ 背后的公司工作）

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-12-16T10:37:18.060

您应该考虑的一项技术是[SQLJ——](http://en.wikipedia.org/wiki/SQLJ)一种将 SQL 语句直接嵌入 Java 的方法。作为一个简单的示例，您可能在名为 TestQueries.sqlj 的文件中包含以下内容：

```
public class TestQueries
{
    public String getUsername(int id)
    {
        String username;
        #sql
        {
            select username into :username
            from users
            where pkey = :id
        };
        return username;
    }
} 
```

还有一个额外的预编译步骤，它将您的 .sqlj 文件转换为纯 Java - 简而言之，它会查找以

```
#sql
{
    ...
} 
```

并将它们转换为 JDBC 调用。使用 SQLJ 有几个主要好处：

*   完全抽象出 JDBC 层——程序员只需要考虑 Java 和 SQL
*   可以让翻译器在编译时检查您对数据库的语法等查询
*   能够使用“：”前缀在查询中直接绑定 Java 变量

大多数主要数据库供应商都有翻译器的实现，因此您应该能够轻松找到所需的一切。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-12-16T10:21:47.310

我想知道你是否追求类似[Squiggle](http://code.google.com/p/squiggle-sql/)的东西。[jDBI](http://jdbi.codehaus.org/)也非常有用。但是，它不会帮助您进行查询。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-12-16T10:33:40.970

我会看看[Spring JDBC](http://static.springframework.org/spring/docs/2.0.x/reference/jdbc.html)。每当我需要以编程方式执行 SQL 时，我都会使用它。例子：

```
int countOfActorsNamedJoe
    = jdbcTemplate.queryForInt("select count(0) from t_actors where first_name = ?", new Object[]{"Joe"}); 
```

它对于任何类型的 sql 执行都非常有用，尤其是查询；它将帮助您将结果集映射到对象，而不会增加完整 ORM 的复杂性。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-12-16T09:47:26.570

我倾向于使用 Spring 的命名 JDBC 参数，因此我可以编写一个标准字符串，例如 "select * from blah where colX=':someValue'"; 我认为这很可读。

另一种方法是在单独的 .sql 文件中提供字符串，并使用实用程序方法读取内容。

哦，还值得一看 Squill：[https ://squill.dev.java.net/docs/tutorial.html](https://squill.dev.java.net/docs/tutorial.html)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-02-02T05:30:25.653

我一直在开发一个 Java servlet 应用程序，该应用程序需要构建非常动态的 SQL 语句以用于临时报告目的。该应用程序的基本功能是将一堆命名的 HTTP 请求参数提供给预编码的查询，并生成格式良好的输出表。我使用 Spring MVC 和依赖注入框架将我的所有 SQL 查询存储在 XML 文件中，并将它们与表格格式信息一起加载到报告应用程序中。最终，报告需求变得比现有参数映射框架的功能更复杂，我不得不自己编写。这是一个有趣的开发练习，并产生了一个参数映射框架，比我能找到的任何其他东西都要强大得多。

新的参数映射如下所示：

```
select app.name as "App", 
       ${optional(" app.owner as "Owner", "):showOwner}
       sv.name as "Server", sum(act.trans_ct) as "Trans"
  from activity_records act, servers sv, applications app
 where act.server_id = sv.id
   and act.app_id = app.id
   and sv.id = ${integer(0,50):serverId}
   and app.id in ${integerList(50):appId}
 group by app.name, ${optional(" app.owner, "):showOwner} sv.name
 order by app.name, sv.name 
```

由此产生的框架的美妙之处在于它可以通过适当的类型检查和限制检查将 HTTP 请求参数直接处理到查询中。输入验证不需要额外的映射。在上面的示例查询中，将检查名为*serverId*的参数 ，以确保它可以转换为整数并且在 0-50 的范围内。参数*appId*将被处理为整数数组，长度限制为 50。如果字段*showOwner*如果存在并设置为“true”，则引号中的 SQL 位将添加到生成的查询中，用于可选字段映射。字段 还有几个参数类型映射可用，包括带有更多参数映射的可选 SQL 段。它允许开发人员想出的尽可能复杂的查询映射。它甚至在报告配置中具有控件，以确定给定查询是否将通过 PreparedStatement 进行最终映射，或者只是作为预构建查询运行。

对于示例 Http 请求值：

```
showOwner: true
serverId: 20
appId: 1,2,3,5,7,11,13 
```

它将产生以下 SQL：

```
select app.name as "App", 
       app.owner as "Owner", 
       sv.name as "Server", sum(act.trans_ct) as "Trans"
  from activity_records act, servers sv, applications app
 where act.server_id = sv.id
   and act.app_id = app.id
   and sv.id = 20
   and app.id in (1,2,3,5,7,11,13)
 group by app.name,  app.owner,  sv.name
 order by app.name, sv.name 
```

我真的认为 Spring 或 Hibernate 或其中一个框架应该提供更强大的映射机制来验证类型，允许复杂的数据类型，如数组和其他此类功能。我写我的引擎只是为了我的目的，它不是很适合一般发布。它目前仅适用于 Oracle 查询，并且所有代码都属于一家大公司。有一天我可能会接受我的想法并构建一个新的开源框架，但我希望现有的大玩家之一能够接受挑战。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-12-16T14:42:18.113

我支持使用像 Hibernate 这样的 ORM 的建议。但是，在某些情况下这肯定不起作用，所以我将借此机会宣传一些我帮助编写的东西：[SqlBuilder](http://openhms.sourceforge.net/sqlbuilder/)是一个 Java 库，用于使用“builder”样式动态构建 sql 语句。它相当强大且相当灵活。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-12-16T10:12:32.337

为什么要手动生成所有的sql？你有没有看过像 Hibernate 这样的 ORM 根据你的项目，它可能会完成你需要的至少 95% 的工作，以比原始 SQL 更简洁的方式完成，如果你需要获得最后一点性能，你可以创建需要手动调整的 SQL 查询。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2012-03-27T08:25:31.877

你也可以看看 MyBatis ( [www.mybatis.org](http://www.mybatis.org) )。它可以帮助您在 java 代码之外编写 SQL 语句，并将 sql 结果映射到您的 java 对象等。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2017-10-08T05:06:32.823

Google 提供了一个名为[Room Persitence Library的库，它](https://developer.android.com/training/data-storage/room/index.html)**为 Android 应用程序**提供了一种非常简洁的 SQL 编写方式，基本上是底层**SQLite 数据库**的抽象层。Bellow是来自官方网站的简短代码片段：

```
@Dao
public interface UserDao {
    @Query("SELECT * FROM user")
    List<User> getAll();

    @Query("SELECT * FROM user WHERE uid IN (:userIds)")
    List<User> loadAllByIds(int[] userIds);

    @Query("SELECT * FROM user WHERE first_name LIKE :first AND "
           + "last_name LIKE :last LIMIT 1")
    User findByName(String first, String last);

    @Insert
    void insertAll(User... users);

    @Delete
    void delete(User user);
} 
```

该库的官方文档中有更多示例和更好的文档。

还有一个叫做 MentaBean 的[Java ORM](http://mentabean.soliveirajr.com/mtw/Page/Intro/en/mentabean-simple-orm-and-query-builder)。它具有很好的功能，并且似乎是一种非常简单的 SQL 编写方式。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2017-04-27T06:09:26.920

### 读取 XML 文件。

您可以从 XML 文件中读取它。它易于维护和使用。有标准的 STaX、DOM、SAX 解析器可用，使其在 java 中只需几行代码。

### 使用属性做更多事情

您可以在标记上包含一些带有属性的语义信息，以帮助使用 SQL 做更多事情。这可以是方法名称或查询类型或任何可以帮助您减少代码的内容。

### 维护

您可以将 xml 放在 jar 之外并轻松维护它。与属性文件相同的好处。

### 转换

XML 是可扩展的并且很容易转换为其他格式。

### 用例

[Metamug 使用 xml 用 sql 配置 REST 资源文件。](https://metamug.com/docs/resource-file.php)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-12-16T10:08:53.390

如果将 SQL 字符串放在属性文件中，然后将其读入，则可以将 SQL 字符串保存在纯文本文件中。

这并不能解决 SQL 类型问题，但至少它使从 TOAD 或 sqlplus 复制和粘贴变得更加容易。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-16T12:12:55.027

您如何获得字符串连接，除了 PreparedStatements 中的长 SQL 字符串（您可以轻松地在文本文件中提供并作为资源加载）之外，您会中断多行？

您不是直接创建 SQL 字符串吗？这是编程中最大的禁忌。请使用 PreparedStatements，并将数据作为参数提供。它大大减少了 SQL 注入的机会。

# c# - 如何以编程方式检查 C# 中 CheckedListBox 中的项目？

> ID：370820
> 
> 赞同：54
> 
> 时间：2008-12-16T09:45:06.730
> 
> 标签：c#, winforms, checkedlistbox

我有一个 CheckedListBox，我想自动勾选其中的一项。

该`CheckedItems`集合不允许您向其中添加内容。

有什么建议么？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2008-12-16T09:48:31.513

您需要**[`SetItemChecked`](http://msdn.microsoft.com/en-us/library/system.windows.forms.checkedlistbox.setitemchecked.aspx)**使用相关物品致电。

的[文档`CheckedListBox.ObjectCollection`](http://msdn.microsoft.com/en-us/library/system.windows.forms.checkedlistbox.objectcollection.aspx)有一个示例，该示例检查集合中的所有其他项目。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-07-19T18:27:39.820

这是您可以一次选择/勾选或取消选择/取消勾选所有项目的方式：

```
private void SelectAllCheckBoxes(bool CheckThem) {
    for (int i = 0; i <= (checkedListBox1.Items.Count - 1); i++) {
        if (CheckThem)
        {
            checkedListBox1.SetItemCheckState(i, CheckState.Checked);
        }
        else
        {
            checkedListBox1.SetItemCheckState(i, CheckState.Unchecked);
        }
    }  
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-11-24T20:30:11.430

在我的程序中，我使用了以下技巧：

```
CheckedListBox.SetItemChecked(CheckedListBox.Items.IndexOf(Item),true); 
```

**事情是如何工作的：**
SetItemChecked(int index, bool value) 是设置特定项目的确切检查状态的方法。您必须指定要检查的项目索引（*使用 IndexOf 方法，作为参数指定项目的文本*）和检查状态（*true 表示项目已检查，false 未检查*）。
此方法遍历 CheckedListBox 中的所有项目并检查（*或取消选中*）具有指定索引的项目。
例如，我的一小段代码 - FOREACH 循环通过指定的程序名称运行，如果该程序包含在 CheckedLitBox ( *CLB...* ) 中，请检查它：

```
string[] ProgramNames = sel_item.SubItems[2].Text.Split(';');
foreach (string Program in ProgramNames)
{
    if (edit_mux.CLB_ContainedPrograms.Items.Contains(Program))
        edit_mux.CLB_ContainedPrograms.SetItemChecked(edit_mux.CLB_ContainedPrograms.Items.IndexOf(Program), true);
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-01-25T01:30:49.463

假设您想在单击按钮时检查项目。

```
private void button1_Click(object sender, EventArgs e)
{
    checkedListBox1.SetItemChecked(itemIndex, true);
} 
```

其中 itemIndex 是要检查的项目的索引，它从 0 开始。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-02-13T03:50:30.173

采用：

```
string[] aa = new string[] {"adiii", "yaseen", "salman"};
foreach (string a in aa)
{
    checkedListBox1.Items.Add(a);
} 
```

现在在您要检查所有内容的地方编写代码：

```
private void button5_Click(object sender, EventArgs e)
{
    for(int a=0; a<checkedListBox1.Items.Count; a++)
        checkedListBox1.SetItemChecked(a, true);
} 
```

取消选中所有：

```
private void button_Click(object sender, EventArgs e)
{
    for(int a=0; a<checkedListBox1.Items.Count; a++)
        checkedListBox1.SetItemChecked(a, false);
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-08-17T06:22:17.320

我使用扩展名：

```
public static class CheckedListBoxExtension
{
    public static void CheckAll(this CheckedListBox listbox)
    {
        Check(listbox, true);
    }

    public static void UncheckAll(this CheckedListBox listbox)
    {
        Check(listbox, false);
    }

    private static void Check(this CheckedListBox listbox, bool check)
    {
        Enumerable.Range(0, listbox.Items.Count).ToList().ForEach(x => listbox.SetItemChecked(x, check));
    }
} 
```

# asp.net - 服务器错误 ASP.NET 2.0

> ID：370822
> 
> 赞同：0
> 
> 时间：2008-12-16T09:46:41.097
> 
> 标签：asp.net, iis-6, webrequest

嗨，伙计们，你能帮我解决这个错误吗？它是什么？

> “/”应用程序中的服务器错误。
> 
> * * *
> 
> 请求失败，HTTP 状态为 400：错误请求。说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 
> 异常详细信息：System.Net.WebException：请求失败，HTTP 状态 400：错误请求。
> 
> 源错误：
> 
> 在执行当前 Web 请求期间生成了未处理的异常。可以使用下面的异常堆栈跟踪来识别有关异常起源和位置的信息。

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-16T10:20:57.733

我想当我尝试运行一个 .NET 2.0 Web 应用程序并将 IIS 设置为该虚拟目录的 .NET 1.1 时，我遇到了这个错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T10:41:52.373

我敢打赌，要么为特定站点分配了不正确的 .NET 框架版本，要么您没有为您的网站创建虚拟目录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T10:03:11.373

只是猜测：这可能是 IIS 或 ASP.NET 安装的问题。尝试重新启动/重新安装 IIS。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-16T10:06:09.510

[http://www.checkupdown.com/status/E400.html](http://www.checkupdown.com/status/E400.html)

[http://support.microsoft.com/kb/247249](http://support.microsoft.com/kb/247249)

希望有帮助。

# asp.net-mvc - 如何在 Winforms 中使用数据注释验证器？

> ID：370826
> 
> 赞同：5
> 
> 时间：2008-12-16T09:47:44.383
> 
> 标签：asp.net-mvc, winforms, data-annotations

我喜欢企业库中的验证应用程序块 :-)
现在我想在 Winforms 中使用 DataAnnotations，因为我们也使用 asp.net 动态数据。这样我们就有了全公司通用的技术。
而且数据注释应该更容易使用。

我怎样才能在 Winforms 中做类似于[Stephen Walter 在 asp.net MVC](http://weblogs.asp.net/stephenwalther/archive/2008/09/10/asp-net-mvc-tip-43-use-data-annotation-validators.aspx)中所做的事情？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-04T17:17:30.057

我改编了在[http://blog.codeville.net/category/validation/page/2/找到的解决方案](http://blog.codeville.net/category/validation/page/2/)

```
public class DataValidator
    {
    public class ErrorInfo
    {
        public ErrorInfo(string property, string message)
        {
            this.Property = property;
            this.Message = message;
        }

        public string Message;
        public string Property;
    }

    public static IEnumerable<ErrorInfo> Validate(object instance)
    {
        return from prop in instance.GetType().GetProperties()
               from attribute in prop.GetCustomAttributes(typeof(ValidationAttribute), true).OfType<ValidationAttribute>()
               where !attribute.IsValid(prop.GetValue(instance, null))
               select new ErrorInfo(prop.Name, attribute.FormatErrorMessage(string.Empty));
    }
} 
```

这将允许您使用以下代码使用以下语法验证任何对象：

```
var errors = DataValidator.Validate(obj);

if (errors.Any()) throw new ValidationException(); 
```

# svn - 禁止 SVN 提交缺少描述

> ID：370831
> 
> 赞同：1
> 
> 时间：2008-12-16T09:49:51.400
> 
> 标签：svn, version-control, input-filtering

我有一个 SVN 存储库，如果没有输入描述，我需要提交失败。这可能吗，最好是服务器端？（用户使用几种不同的工具与存储库进行交互；尽管如果这在 TortoiseSVN 中是可能的客户端，那将缓解问题）

谷歌不是很有帮助，你能给我一些指点吗？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-16T09:56:07.317

是的，您需要在存储库中编写一个预提交挂钩，该挂钩失败并显示适当的错误消息以发送回客户端。

如果您查看新创建的存储库的“钩子”目录，您会找到一个`pre-commit.tmpl`文件。其中包含说明，示例甚至检查日志消息是否包含文本 - 正是您想要的。

因此，您应该能够重命名并`pre-commit.tmpl`使其`pre-commit`可执行，然后试一试。我建议你在生产之前在沙盒存储库上尝试它，以避免愤怒的用户在你做对的时候无法提交:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T09:57:28.327

您可以使用[存储库挂钩](http://svnbook.red-bean.com/en/1.5/svn.reposadmin.create.html#svn.reposadmin.create.hooks)来做到这一点。在您的情况下，您需要一个预提交挂钩来检查消息并在它为空时拒绝提交。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T09:58:02.633

[FreeBSD](http://www.freebsd.org/)项目有一些您可能想要使用的示例。请参阅带有钩子的公共[svn 存储库。](http://svn.freebsd.org/viewvc/base/svnadmin/hooks/)

# file - 为什么我的应用程序允许我将文件保存到 Vista 中的 Windows 和 System32 文件夹？

> ID：370837
> 
> 赞同：6
> 
> 时间：2008-12-16T09:51:52.737
> 
> 标签：file, windows-vista, uac, compatibility

我有一个用 Delphi 7 编写的应用程序，它不需要管理员权限即可运行。

出于某种原因，即使应用程序**没有请求 UAC 提升**，我也能够从应用程序中将文件保存到 c:\windows 和 c:\windows\system32 。我以管理员身份登录并**打开了 UAC，**并且我没有更改任何默认 UAC 设置。这些文件实际上也显示在 Windows 资源管理器下。我没有使用“以管理员身份运行”选项。

如果我尝试在同一配置文件下使用写字板做同样的事情，我会收到预期的错误。

有什么想法吗？

如果有帮助，应用程序正在使用 Ole 结构化存储来保存并包含以下清单。

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
    <assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">
    <assemblyIdentity type="win32" name="DelphiApplication" version="1.0.0.0" processorArchitecture="*"/>
<dependency>
<dependentAssembly>
  <assemblyIdentity
    type="win32"
    name="Microsoft.Windows.Common-Controls"
    version="6.0.0.0"
    publicKeyToken="6595b64144ccf1df"
    language="*"
    processorArchitecture="*"/>
</dependentAssembly>
</dependency>
<trustInfo xmlns="urn:schemas-microsoft-com:asm.v2">
            <security>
                    <requestedPrivileges>
                            <requestedExecutionLevel
                                   level="asInvoker"
                                   uiAccess="false"/>
                    </requestedPrivileges>
            </security>
    </trustInfo>
</assembly> 
```

编辑：要清楚我的应用程序默认情况下不会将任何内容保存到这些位置。我通过标准文件保存对话框选择这些位置。

**更新**

尽管包含上述清单，但我发现了为什么我的应用程序被视为遗留应用程序。事实证明，还包括了第二个清单，它没有“trustInfo”部分。我已经删除了第二个清单，现在一切都很好。

感谢所有的帮助

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-16T10:05:10.090

这是 UAC 的一项功能，可以使旧应用程序与 Vista 兼容。它将任何写入请求重定向到用户没有本地文件夹权限的系统文件夹。

它们存储在当前用户配置文件下的“AppData\Local\VirtualStore”文件夹下。有一个组策略设置可以禁用此功能：“将文件和注册表写入失败虚拟化到每个用户的位置”

此文件和注册表虚拟化功能旨在允许旧应用程序在 Windows Vista 标准用户帐户下运行。旧版应用程序被定义为没有特定 Vista 清单的 32 位可执行文件。如果您提供 Vista 清单以将您的应用程序装饰为与 Vista 兼容，则此虚拟化设置不会影响您的应用程序（如在您的写字板示例中）

Mark Russinovich 有一篇很棒的文章：[Inside Windows Vista User Account Control](http://technet.microsoft.com/en-us/magazine/cc138019.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T10:04:02.730

> 我在打开 UAC 的情况下以管理员身份运行。

您的意思是您以管理员身份登录还是您的意思是您使用“以管理员身份运行”选项（即使用提升的令牌）运行您的 Delphi 应用程序？

如果是后者，那么您的应用程序将有权写入 C:\Windows。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T10:05:16.253

除非您禁用了 UAC，否则这些文件最终将位于您的用户目录下的虚拟位置。

# wpf - 为什么我的类型化数据模板没有被应用？

> ID：370839
> 
> 赞同：13
> 
> 时间：2008-12-16T09:52:09.867
> 
> 标签：wpf, datatemplate

我正在使用 Linq To Sql 用 Segment 对象填充列表框，其中 Segment 是设计器创建/ORM 生成的类。

```
<Window x:Class="ICTemplates.Window1"
    ...
    xmlns:local="clr-namespace:ICTemplates"
    Title="Window1" Height="300" Width="300">
    <Window.Resources>
      <DataTemplate x:Key="MyTemplate"> 
      <!--  <DataTemplate DataType="x:Type local:Segment"> -->
        // some stuff in here
      </DataTemplate>
    </Window.Resources>
    <ListView x:Name="tvwSegments" ItemsSource="{Binding}" ItemTemplate="{StaticResource MyTemplate}" MaxHeight="200"/>

// code-behind
var queryResults = from segment in tblSegments
                               where segment.id <= iTemplateSid
                               select segment;
tvwSegments.DataContext = queryResults; 
```

这行得通。

但是，如果我使用类型化数据模板（通过将 x:Key 替换为模板上的 DataType 属性，所有项目都显示为`ICTemplates.Segment`（ToString() 返回值）
，其概念是它应该自动拾取数据模板，如果类型匹配。有人可以在这里发现错误吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-12-16T17:21:53.640

泽错在这里

```
<DataTemplate DataType="x:Type local:Segment">  <!-- doesn't work --> 
```

应该

```
<DataTemplate DataType="{x:Type local:Segment}"> 
```

Came home... made a toy-sample and it worked with this change. Gotta try that @ work tomorrow. Sheesh.. for want of 2 curlies..

**Update**: Found out another gotcha

```
<DataTemplate x:Key="SegTemplate" DataType="{x:Type local:Segment}">  <!-- doesn't work --> 
```

won't work. Seems like you can have it either with a Key **OR** DataType attribute. To make this typed data template work.. had to remove the Key attribute and now it works as expected. Behavior is consistent for a HierarchicalDataTemplate too.

```
<DataTemplate DataType="{x:Type local:Segment}"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T16:43:05.217

这只是一个猜测，但可能是因为上下文设置为 IQueryable 吗？如果将 DataContext 设置为 Segment 的单个实例，是否会得到相同的结果？

# ruby - 仅用于整数的 JSON 对象

> ID：370840
> 
> 赞同：4
> 
> 时间：2008-12-16T09:53:28.507
> 
> 标签：ruby, json

愚蠢的问题，但我无法弄清楚..

我在Ruby中尝试了以下内容：

```
irb(main):020:0> JSON.load('[1,2,3]').class
=> Array 
```

这似乎有效。虽然两者都没有

```
JSON.load('1').class 
```

也不是这个

```
JSON.load('{1}').class 
```

作品。有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-16T10:16:34.483

我会问那些为图书馆编程的人。AFAIK，`1`不是有效的 JSON 对象，也不是`{1}`库`1`本身为 fixnum 1 生成的对象。

你需要做：`{"number" : 1}`成为有效的json。错误是

```
a != JSON.parse(JSON.generate(a)) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-16T10:02:56.820

我会说这是一个错误：

```
>> JSON.parse(1.to_json)
JSON::ParserError: A JSON text must at least contain two octets!
     from /opt/local/lib/ruby/gems/1.8/gems/json-1.1.3/lib/json/common.rb:122:in `initialize'
     from /opt/local/lib/ruby/gems/1.8/gems/json-1.1.3/lib/json/common.rb:122:in `new'
     from /opt/local/lib/ruby/gems/1.8/gems/json-1.1.3/lib/json/common.rb:122:in `parse'
     from (irb):7 
```

我假设你正在使用这个：（[http://json.rubyforge.org/](http://json.rubyforge.org/)）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-05-13T13:20:55.417

**JSON 仅支持对象是不正确的**—— json.org 也不建议这个 imo。它是从 javascript 派生的，因此尤其是字符串和数字也是有效的 JSON：

```
var json_string = "1";
var p = eval('(' + json_string + ')');
console.log(p);
// => 1
typeof p
// => "number" 
```

[`ActiveSupport::JSON`](http://api.rubyonrails.org/classes/ActiveSupport/)正确理解原始值 JSON：

```
require 'active_support/json'
p = ActiveSupport::JSON.decode '1'
# => 1
p.class
# => Fixnum 
```

[MultiJson](https://github.com/intridea/multi_json)也是如此：

```
require 'multi_json'
p = MultiJson.load '1'
# => 1
p.class
# => Fixnum 
```

所以，正如 a2800276 提到的，这一定是一个错误。

* * *

但在撰写本文时，使用该方法时，ruby 2 的 JSON`quirks_mode` [默认已启用。](http://ruby-doc.org/stdlib-2.0.0/libdoc/json/rdoc/JSON.html#load_default_options)`load`

```
require 'json'
p = JSON.load '1'
# => 1
p.class
# => Fixnum 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-18T13:24:54.767

第一个例子是有效的。后两个不是有效的 JSON 数据。详情请访问[json.org](http://json.org)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-06-21T08:49:00.473

如前所述，在 JSON 的顶层只允许使用数组和对象。

也许将您的值包装在一个数组中会解决您的问题。

```
def set( value ); @data = [value].to_json; end
def get; JSON.parse( @data )[0]; end 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-07-24T17:24:10.257

**从 JSON 是什么的基础知识来看：**

*   JSON 中的数据类型可以是：
    1.  数字
    2.  细绳
    3.  Json Object ...（以及更多）

[参考查看完整的 Json 数据类型列表](http://www.tutorialspoint.com/json/json_data_types.htm)

*   现在任何 Json 数据都必须封装在顶层的“Json Object”中。
*   要理解为什么会这样，您可以看到，如果顶层没有 Json 对象，一切都会变得松散，您只能拥有整个 Json 中的一种数据类型。即数字、字符串、数组、空值等……但只有一个。
*   'Json Object' 类型具有固定格式的 'key' : 'value' 对。
*   您不能只存储值。因此，您不能拥有像 {1} 这样的东西。您需要输入正确的格式，即 'key' : 'value' 对。

# internet-explorer - 将文件从桌面拖到IE并上传

> ID：370845
> 
> 赞同：4
> 
> 时间：2008-12-16T09:57:03.400
> 
> 标签：internet-explorer, drag-and-drop

对于我正在处理的项目，我希望用户能够从桌面或 Windows 资源管理器中拖动文件并将其拖放到 IE 中的网页上并将其上传到 Web 服务器。我已经读到它可能与 ActiveX 一起使用，但没有发现任何关于它的信息。

任何人都知道如何做到这一点以及我在哪里可以得到我需要的东西？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-16T20:12:30.630

[雅虎的Browser Plus](http://browserplus.yahoo.com/)。

跨浏览器支持，但需要安装。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T19:56:10.880

如果您希望它跨浏览器工作，您应该考虑使用 Java 小程序。

否则，我相信自定义 ActiveX 组件应该解决它是对的:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T10:20:05.740

我认为要使拖放工作，用户必须安装一个插件。至少在像[Projectplace这样的服务中就是这样做的。](http://www.projectplace.com)

# delphi - 有没有关于德尔福的播客？

> ID：370849
> 
> 赞同：9
> 
> 时间：2008-12-16T10:00:33.970
> 
> 标签：delphi

我能找到一些关于 Delphi 程序和整个软件生命周期的好播客吗

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-16T10:02:22.983

德尔福的播客

[http://www.delphi.org/](http://www.delphi.org/)

此外，您指定了“软件生命周期”，所以我喜欢另一个很棒的播客，它与语言无关，那就是软件工程广播：

[http://www.se-radio.net/](http://www.se-radio.net/)

# php - 如何在 jQuery 的同一窗口中加载 PHP 页面

> ID：370850
> 
> 赞同：2
> 
> 时间：2008-12-16T10:01:34.513
> 
> 标签：php, jquery, ajax

我有一个 PHP 文件 Test.php，它有两个功能：

```
<?php
    echo displayInfo();
    echo displayDetails();
?> 
```

JavaScript：

```
<html>
     ...
    <script type="text/javascript">
        $.ajax({
            type:'POST',
            url: 'display.php',
            data:'id='+id  ,
            success: function(data){
                $("#response").html(data);
            }
        });
    </script>
    ...

    <div id="response">
    </div>
</html> 
```

它返回来自 jQuery 的响应。响应显示为`<a href=Another.php?>Link</a>`。当我单击 中的 Another.php 链接时`test.php`，它会在另一个窗口中加载。但我需要它在`<div> </div>`不改变内容的情况下加载相同的区域`test.php`，因为它有`displayInfo(), displayDetails()`。或者是否可以在`<div> </div>`元素内加载 PHP 页面？

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-16T10:10:44.697

如果我理解正确，您希望`a`链接取消导航，但触发 AJAX 功能？

在这种情况下：

```
$("#mylink").click(function() {
    $.ajax({ type: "POST", url: "another.php", data: {id: "somedata"}, function(data) {
        $("#response").html(data);
    });
    return false;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T21:27:53.987

您可以只使用[MooTools](http://en.wikipedia.org/wiki/MooTools)和类[Request.HTML](http://mootools.net/docs/Request/Request.HTML)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T21:47:18.817

克罗夫是正确的，

然而，一种可能的不良行为是每次单击链接时都会查询数据。您可以将事件设置为仅使用一次调用 ajax 查询。

```
$("#mylink").one('click', function() {
  // ajax call
  return false;
}); 
```

不要忘记在您的链接中设置 href="javascript:{}" 以便在事件触发后一旦链接不会做任何事情；

# java - Java：从字符串创建日期对象并插入 MySQL

> ID：370852
> 
> 赞同：0
> 
> 时间：2008-12-16T10:02:54.557
> 
> 标签：java, sql, date, prepared-statement

任何时候我必须在 java 中处理日期/时间，这让我很难过

我正在尝试解析字符串并将其转换为日期对象以插入到preparepared 语句中。我一直试图让这个工作，但没有运气。当我去编译类时，我也会收到有用的错误消息。

“线程“主”java.lang.Error 中的异常：未解决的编译问题：PreparedStatement 类型中的方法 setDate(int, Date) 不适用于参数 (int, Date)”

嗯，WTF？

这是有问题的代码。

```
for(int i = 0; i < flights.size(); i++){

    String[] details = flight[i].toString().split(":"); 
    DateFormat formatter ; 
    formatter = new SimpleDateFormat("ddMMyyyy");
    Date date = formatter.parse(details[1]); 

    PreparedStatement pstmt = conn.prepareStatement(insertsql);
    pstmt.setString(1, details[0]);
    pstmt.setDate(2, date);
    pstmt.setString(3, details[2] + "00");
    pstmt.setString(4, details[3]);
    pstmt.setString(5, details[4]);
    pstmt.setString(6, details[5]);
    pstmt.setString(7, details[6]);
    pstmt.setString(8, details[7]);
    pstmt.setString(9, details[8]);
    pstmt.executeUpdate();

} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-16T10:10:28.427

[PreparedStatement.setDate](http://java.sun.com/javase/6/docs/api/java/sql/PreparedStatement.html#setDate(int,%20java.sql.Date))采用[java.sql.Date](http://java.sun.com/javase/6/docs/api/java/sql/Date.html)，而不是[java.util.Date](http://java.sun.com/javase/6/docs/api/java/util/Date.html)。

（出于兴趣，您为什么实际上没有将其视为编译时错误？如果您可以解决编译失败而无需在测试运行中到达该点，您的生活将变得更加轻松......）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-16T10:09:42.733

我的猜测是你混合了 java.util.Date 和 java.sql.Date ...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-26T17:06:15.260

字符串到 MySQL 日期/时间

```
import java.sql.Date;
import java.sql.Time;

 statement.setDate(4, Date.valueOf("2009-08-26"));
 statement.setTime(5, Time.valueOf("12:04:08")); 
```

# c# - 为什么 IsNan 是 Double 类的静态方法而不是实例属性？

> ID：370859
> 
> 赞同：12
> 
> 时间：2008-12-16T10:04:44.723
> 
> 标签：c#, oop

问题在标题中，为什么：

```
return double.IsNaN(0.6d) && double.IsNaN(x); 
```

代替

```
return (0.6d).IsNaN && x.IsNaN; 
```

我问是因为在实现具有与 NaN 相同含义的特殊值的自定义结构时，我倾向于选择第二个。

此外，该属性的性能通常更好，因为它避免复制堆栈上的结构来调用 IsNaN 静态方法（并且由于我的属性不是虚拟的，因此没有自动装箱的风险）。当然，对于内置类型而言，这并不是真正的问题，因为 JIT 可以轻松优化这一点。

我现在最好的猜测是，由于你不能在 double 类中同时拥有同名的属性和静态方法，因此他们倾向于使用受 java 启发的语法。（实际上，您可以同时定义一个 get_IsNaN 属性 getter 和另一个定义 IsNaN 静态方法，但在任何支持属性语法的 .Net 语言中都会造成混淆）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-16T11:02:12.317

静态方法是线程安全的，基元上的方法通常需要是线程安全的以支持平台中的线程（意味着至少不受内部竞争条件的影响），实例方法采用指向结构的托管指针，这意味着结构/基元可能是在方法执行时同时修改，另一方面，静态方法获取结构/原语的副本，因此不受线程竞争条件的影响。

如果结构是线程安全的，那么只有当它们执行原子操作时，方法才应该成为实例方法，否则应该选择静态方法。

（作为另一种选择，可以使用使用锁定的实例方法，但它们比复制更昂贵）

编辑：@VirtualBlackFox 我已经准备好和示例来说明结构上的实例方法即使在不可变结构上也不是线程安全的：

```
using System;
using System.Threading;

namespace CA64213434234
{
    class Program 
    {
        static void Main(string[] args)
        {
            ManualResetEvent ev = new ManualResetEvent(false);
            Foo bar = new Foo(0);
            Action a =  () => bar.Display(ev);
            IAsyncResult ar = a.BeginInvoke(null, null);
            ev.WaitOne();
            bar = new Foo(5);
            ar.AsyncWaitHandle.WaitOne();
        }
    }

    public struct Foo
    {
        private readonly int val;
        public Foo(int value)
        {
            val = value;
        }
        public void Display(ManualResetEvent ev)
        {
            Console.WriteLine(val);
            ev.Set();
            Thread.Sleep(2000);
            Console.WriteLine(val);
        }
    }
} 
```

显示实例方法打印：0 5

即使结构是不可变的。对于线程安全方法，请使用静态方法。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-16T10:08:49.053

有趣的问题；不知道答案 - 但如果它真的让你烦恼，你可以声明一个扩展方法，但它仍然会使用堆栈等。

```
static bool IsNaN(this double value)
{
    return double.IsNaN(value);
}

static void Main()
{
    double x = 123.4;
    bool isNan = x.IsNaN();
} 
```

如果 C# 有扩展属性会更好（对于语法），但上面是你目前可以获得的最接近的，但无论如何它应该“内联”得很好。

* * *

~~更新; 想一想，静态和实例之间还有一个区别；C#*总是*`callvirt`用“ ”而不是“ ”调用实例方法`call`，即使类型是密封的不可为空。那么，静态化可能会带来性能优势吗？幸运的是，扩展方法仍然算作静态的，所以你可以保留这种行为。~~

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-16T21:32:25.930

@Pop Catalin：我不同意你所说的：

> 如果结构是线程安全的，那么只有当它们执行原子操作时，方法才应该成为实例方法，否则应该选择静态方法。

这是一个小程序，它证明静态方法不能解决 structs 的这个问题：

```
using System;
using System.Threading;
using System.Diagnostics;

namespace ThreadTest
{
    class Program
    {
        struct SmallMatrix
        {
            double m_a, m_b, m_c, m_d;

            public SmallMatrix(double x)
            {
                m_a = x;
                m_b = x;
                m_c = x;
                m_d = x;
            }

            public static bool SameValueEverywhere(SmallMatrix m)
            {
                return (m.m_a == m.m_b)
                    && (m.m_a == m.m_c)
                    && (m.m_a == m.m_d);
            }
        }

        static SmallMatrix s_smallMatrix;

        static void Watcher()
        {
            while (true)
                Debug.Assert(SmallMatrix.SameValueEverywhere(s_smallMatrix));
        }

        static void Main(string[] args)
        {
            (new Thread(Watcher)).Start();
            while (true)
            {
                s_smallMatrix = new SmallMatrix(0);
                s_smallMatrix = new SmallMatrix(1);
            }
        }
    }
} 
```

请注意，在普通处理器上使用双精度值时无法观察到这种行为，因为大多数 x86 指令都有一个可用于 64 位块的版本，例如`movl`.

所以线程安全似乎不是 IsNaN 成为 static 的好理由：

1.  该框架应该与平台无关，因此它不应该以处理器架构之类的东西为前提。IsNaN 线程安全取决于这样一个事实：64 位值总是在目标架构上被原子地访问和修改（并且紧凑框架目标不是 x86 ......）。
2.  IsNaN 本身是无用的，并且在多个线程可以访问`someVar`此代码的上下文中无论如何都是不安全的（不管 IsNaN 的线程安全性如何）：

```
print("code sample");
if (!double.IsNaN(someVar))
    Console.WriteLine(someVar); 
```

我的意思是，即使 IsNaN 是通过`==`与所有可能的 NaN 值进行比较来实现的......（实际上不可能）......谁关心值在方法的执行过程中会发生变化，如果无论如何它可能已经改变了方法终止...或者它甚至可能是一个中间值，如果目标架构不是 x86 则不应该出现在这里...

在两个不同的线程中访问内部值通常是不安全的，所以我认为在处理结构或任何其他类型时通过将任何方法置于静态来提供某种安全错觉没有兴趣**，**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-16T10:38:56.903

实例和 a 之间的区别`static`是 C# 语言（以及您所说的 Java）选择明确的一个基本点（在 C++ 中，您可以`static`通过实例调用方法，但这只是语法 - 在后台 instance.StaticX是同一个说法实例Class.StaticX。

不过，向流畅界面的转变已经开始解决很多问题……

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-16T11:07:03.587

我记得一位导师的话，祈祷任何方法，除了参数之外不使用任何其他变量是静态方法。

我真的不知道为什么，也没有想过背后，但从逻辑上讲，它似乎很好。无论如何对答案感兴趣;-)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-16T21:39:38.177

我认为马克已经找到了答案。

问题是当您需要在值类型上调用实例方法时，该值被装箱。这将导致严重的性能损失。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-11-19T19:23:12.300

Double.IsNan 遵循与 String.IsNullorEmpty 相同的模式。后者的行为与它一样，因为遗憾的是，没有办法声明非虚拟实例方法应该可以与 null “this”一起使用。虽然这种行为对于可变引用类型可能很奇怪，但对于必须是引用类型但在语义上应该像不可变值一样表现的事物来说，它会非常有用。例如，如果在空对象上调用其属性的行为与在空字符串上调用它们的行为相同，则“String”类型会更方便。事实上，有一个奇怪的上下文混杂，其中一个空字符串对象将被视为一个空字符串，而那些试图使用一个将产生错误的上下文。

# java - 如何通过 GSS-API 获取 kerberos 服务票据？

> ID：370878
> 
> 赞同：14
> 
> 时间：2008-12-16T10:09:57.897
> 
> 标签：java, single-sign-on, kerberos

有谁知道如何使用 Java GSS-API 从密钥分发中心 (KDC) 获取服务票证？

我有一个胖客户端应用程序，它首先使用 Krb5LoginModule 通过 JAAS 进行身份验证，以从票证缓存中获取 TGT（背景：Windows 例如使用 kerberos 实现并将票证授予票证存储在安全内存区域中）。从 LoginManager 我得到包含 TGT 的 Subject 对象。现在我希望当我为我的服务创建一个特定的 GSSCredential 对象时，服务票证也将被放入主题的私有凭据中（我已经在网络的某个地方读过）。所以我尝试了以下方法：

```
// Exception handling ommitted
LoginContext lc = new LoginContext("HelloEjbClient", new DialogCallbackHandler());
lc.login()
Subject.doAs(lc.getSubject(), new PrivilegedAction() {

    public Object run() {
        GSSManager manager = GSSManager.getInstance();
        GSSName clientName = manager.createName("clientUser", GSSName.NT_USER_NAME);
        GSSCredential clientCreds = manager.createCredential(clientName, 8 * 3600, createKerberosOid(), GSSCredential.INITIATE_ONLY);

        GSSName serverName = manager.createName("myService@localhost", GSSName.NT_HOSTBASED_SERVICE);
        manager.createCredential(serverName, GSSCredential.INDEFINITE_LIFETIME, createKerberosOid(), GSSCredential.INITIATE_ONLY);
        return null;
    }

    private Oid createKerberosOid() {
        return new Oid("1.2.840.113554.1.2.2");
    }

}); 
```

不幸的是，我收到 GSSException：未提供有效凭据（机制级别：找不到任何 Kerberos tgt）。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-18T07:24:08.730

我对获取服务票的理解是错误的。我不需要从服务中获取凭据 - 这在客户端上是不可能的，因为客户端确实没有服务器的 TGT，因此无权获取服务凭据。这里缺少的是创建一个新的 GSSContext 并对其进行初始化。如果我理解正确的话，此方法的返回值包含服务票证。这是一个工作代码示例。它必须代表已登录的主题在 PrivilegedAction 中运行：

```
 GSSManager manager = GSSManager.getInstance();
    GSSName clientName = manager.createName("clientUser", GSSName.NT_USER_NAME);
    GSSCredential clientCred = manager.createCredential(clientName,
                                                        8 * 3600,
                                                        createKerberosOid(),
                                                        GSSCredential.INITIATE_ONLY);

    GSSName serverName = manager.createName("http@server", GSSName.NT_HOSTBASED_SERVICE);

    GSSContext context = manager.createContext(serverName,
                                               createKerberosOid(),
                                               clientCred,
                                               GSSContext.DEFAULT_LIFETIME);
    context.requestMutualAuth(true);
    context.requestConf(false);
    context.requestInteg(true);

    byte[] outToken = context.initSecContext(new byte[0], 0, 0);
    System.out.println(new BASE64Encoder().encode(outToken));
    context.dispose(); 
```

outToken 包含然后包含服务票证。然而，这不是 GSS-API 的使用方式。它的目标是将这些细节隐藏到代码中，因此最好在双方都使用 GSS-API 建立 GSSContext。否则，由于潜在的安全漏洞，您真的应该知道自己在做什么。有关更多信息，请比我更仔细地[阅读使用 kerberos 的 Sun SSO 教程。](http://docs.oracle.com/javase/6/docs/technotes/guides/security/jgss/single-signon.html)

编辑：只是忘了我正在使用带有 SP2 的 Windows XP。此版本的 Windows 中有一个新“功能”，它不允许在 Windows RAM 中使用 TGT。您必须编辑注册表以允许这样做。有关更多信息，请查看[JGSS 故障排除页面](http://docs.oracle.com/javase/6/docs/technotes/guides/security/jgss/tutorials/Troubleshooting.html)主题，以防您像我一样遇到“KrbException：KDC 不支持加密类型 (14)”。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-18T06:26:31.453

我在使用这段代码时遇到了很多问题，但我至少有一个解决方案。我把它贴在这里，也许它会帮助你们中的一些人......

```
/**
 * Tool to retrieve a kerberos ticket. This one will not be stored in the windows ticket cache.
 */
public final class KerberosTicketRetriever
{
    private final static Oid KERB_V5_OID;
    private final static Oid KRB5_PRINCIPAL_NAME_OID;

    static {
        try
        {
            KERB_V5_OID = new Oid("1.2.840.113554.1.2.2");
            KRB5_PRINCIPAL_NAME_OID = new Oid("1.2.840.113554.1.2.2.1");

        } catch (final GSSException ex)
        {
            throw new Error(ex);
        }
    }

    /**
     * Not to be instanciated
     */
    private KerberosTicketRetriever() {};

    /**
     *
     */
    private static class TicketCreatorAction implements PrivilegedAction
    {
        final String userPrincipal;
        final String applicationPrincipal;

        private StringBuffer outputBuffer;

        /**
         *
         * @param userPrincipal  p.ex. <tt>MuelleHA@MYFIRM.COM</tt>
         * @param applicationPrincipal  p.ex. <tt>HTTP/webserver.myfirm.com</tt>
         */
        private TicketCreatorAction(final String userPrincipal, final String applicationPrincipal)
        {
            this.userPrincipal = userPrincipal;
            this.applicationPrincipal = applicationPrincipal;
        }

        private void setOutputBuffer(final StringBuffer newOutputBuffer)
        {
            outputBuffer = newOutputBuffer;
        }

        /**
         * Only calls {@link #createTicket()}
         * @return <tt>null</tt>
         */
        public Object run()
        {
            try
            {
                createTicket();
            }
            catch (final GSSException  ex)
            {
                throw new Error(ex);
            }

            return null;
        }

        /**
         *
         * @throws GSSException
         */
        private void createTicket () throws GSSException
        {
            final GSSManager manager = GSSManager.getInstance();
            final GSSName clientName = manager.createName(userPrincipal, KRB5_PRINCIPAL_NAME_OID);
            final GSSCredential clientCred = manager.createCredential(clientName,
                    8 * 3600,
                    KERB_V5_OID,
                    GSSCredential.INITIATE_ONLY);

            final GSSName serverName = manager.createName(applicationPrincipal, KRB5_PRINCIPAL_NAME_OID);

            final GSSContext context = manager.createContext(serverName,
                    KERB_V5_OID,
                    clientCred,
                    GSSContext.DEFAULT_LIFETIME);
            context.requestMutualAuth(true);
            context.requestConf(false);
            context.requestInteg(true);

            final byte[] outToken = context.initSecContext(new byte[0], 0, 0);

            if (outputBuffer !=null)
            {
                outputBuffer.append(String.format("Src Name: %s\n", context.getSrcName()));
                outputBuffer.append(String.format("Target  : %s\n", context.getTargName()));
                outputBuffer.append(new BASE64Encoder().encode(outToken));
                outputBuffer.append("\n");
            }

            context.dispose();
        }
    }

    /**
     *
     * @param realm p.ex. <tt>MYFIRM.COM</tt>
     * @param kdc p.ex. <tt>kerbserver.myfirm.com</tt>
     * @param applicationPrincipal   cf. {@link #TicketCreatorAction(String, String)}
     * @throws GSSException
     * @throws LoginException
     */
    static public String retrieveTicket(
            final String realm,
            final String kdc,
            final String applicationPrincipal)
    throws GSSException, LoginException
    {

        // create the jass-config-file
        final File jaasConfFile;
        try
        {
            jaasConfFile = File.createTempFile("jaas.conf", null);
            final PrintStream bos = new PrintStream(new FileOutputStream(jaasConfFile));
            bos.print(String.format(
                    "Krb5LoginContext { com.sun.security.auth.module.Krb5LoginModule required refreshKrb5Config=true useTicketCache=true debug=true ; };"
            ));
            bos.close();
            jaasConfFile.deleteOnExit();
        }
        catch (final IOException ex)
        {
            throw new IOError(ex);
        }

        // set the properties
        System.setProperty("java.security.krb5.realm", realm);
        System.setProperty("java.security.krb5.kdc", kdc);
        System.setProperty("java.security.auth.login.config",jaasConfFile.getAbsolutePath());

        // get the Subject(), i.e. the current user under Windows
        final Subject subject = new Subject();
        final LoginContext lc = new LoginContext("Krb5LoginContext", subject, new DialogCallbackHandler());
        lc.login();

        // extract our principal
        final Set<Principal> principalSet = subject.getPrincipals();
        if (principalSet.size() != 1)
            throw new AssertionError("No or several principals: " + principalSet);
        final Principal userPrincipal = principalSet.iterator().next();

        // now try to execute the SampleAction as the authenticated Subject
        // action.run() without doAsPrivileged leads to
        //   No valid credentials provided (Mechanism level: Failed to find any Kerberos tgt)
        final TicketCreatorAction action = new TicketCreatorAction(userPrincipal.getName(), applicationPrincipal);
        final StringBuffer outputBuffer = new StringBuffer();
        action.setOutputBuffer(outputBuffer);
        Subject.doAsPrivileged(lc.getSubject(), action, null);

        return outputBuffer.toString();
    }

    public static void main (final String args[]) throws Throwable
    {
        final String ticket = retrieveTicket("MYFIRM.COM", "kerbserver", "HTTP/webserver.myfirm.com");
        System.out.println(ticket);
    }
} 
```

# asp.net-mvc - ASP MVC 中视图内的权限

> ID：370884
> 
> 赞同：4
> 
> 时间：2008-12-16T10:11:30.500
> 
> 标签：asp.net-mvc, user-interface, permissions

我了解您可以使用表单身份验证来根据您选择的标准授予/拒绝对某些页面的访问权限。

但是，我希望比这更具体一点，并说，根据用户的权限为用户显示不同的按钮。

我知道我可以做类似的事情

```
if(((User)ViewData["CurrentUser"]).IsEmployee)..... 
```

但这似乎不是很优雅，并且很快就会变得混乱。

是否有任何指南/工具/框架功能可以帮助我？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-16T14:03:11.560

使用基于角色的身份验证，然后适当地设置角色。然后您可以执行以下操作：

```
if (ViewContext.HttpContext.User.IsInRole("vEmployee") { 
```

这样做的好处是它是 ASP.NET 的核心功能——甚至不是特定于 MVC 的——所以它可以与每个可能的成员资格提供程序一起工作。

然后，您可以为要有条件地显示的任何控件添加视图助手重载：

```
public static string TextBox(this HtmlHelper helper, 
    string name, string value, string role, object htmlAttributes)
{
   if helper.ViewContext.HttpContext.User.IsInRole(role) {
       return helper.TextBox(name, value, htmlAttributes);
   } 
   else
   {
       return null;
   }
} 
```

...并称之为：

```
<%= Html.TextBox("name", "value", "vEmployee", null) %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T10:31:04.517

不久前，我在 WPF 应用程序中遇到了同样的问题。它也适用于 ASP.NET。

对于每个“按钮”（WPF 中的 UserControl），您通过属性设置执行其功能所需的角色。

在您的操作开始时，您创建一个需要特殊授权的所有“按钮”的列表。

在调用“return View()”之前，您调用一个函数来迭代所有您的特殊“按钮”并设置基于用户角色的可见性。

对于工作的 WPF，因为您不能通过 get/post 请求调用该方法...对于网络，您应该制作更复杂的东西，而不仅仅是隐藏/显示按钮...

我希望这至少能给你一个线索......它在我的实现中工作得很好，但它只是一个原型......但我想我将来会使用它。

PS：示例代码可以在[这里找到](http://vosti.ch/code/Authorization.zip)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-16T14:09:11.470

不要这样做。将控制器用于这种逻辑

# javascript - 如何使用 JavaScript 访问 Access 数据库？

> ID：370890
> 
> 赞同：5
> 
> 时间：2008-12-16T10:15:20.243
> 
> 标签：javascript, database

我必须通过我的网站显示我的学生的分数。该数据库是使用[Microsoft Access](http://en.wikipedia.org/wiki/Microsoft_Access)创建的。当他们输入注册号时，如何在表格中显示每个学生的分数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-07T14:26:20.507

我知道这是一个老问题，但我碰巧在这个问题的同时遇到了这个项目，AccessDB，所以我想我会发布它。请注意，它表示它适用于 Internet Explorer。我猜他们正在使用微软独有的功能来访问该文件，但我真的没有调查过。

从他们的网站：

> ACCESSdb 是一个 JavaScript 库，用于在 Internet Explorer 中动态连接和查询本地可用的 Microsoft Access 数据库文件。您只需要一个 .mdb 文件；访问甚至不需要安装！

[http://accessdb.sourceforge.net/](http://accessdb.sourceforge.net/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-16T10:18:57.957

JavaScript 不能直接访问数据库。您需要有一些服务器端组件来接收请求（可能通过 HTTP），解析它们并返回请求的数据。

然后 JavaScript 可以访问该组件以获取数据（嗯...闻起来像 AJAX）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-16T10:24:56.587

为什么要使用 Javascript？它在站点访问者的浏览器中运行，即使有办法让它直接访问数据库（没有），这将是一个可怕的安全风险，因为它必须包含数据库密码，这样网站的每个访问者都可以完全访问数据库。

您需要的是在服务器上运行并访问数据库以根据在 HTML 表单中输入的数据向访问者提供不同页面的东西。用于此的典型语言是 PHP、Perl、Ruby 或 ASP。

另请注意，MS Access 作为 Web 应用程序的数据库后端是一个非常糟糕的选择，因为它不支持来自不同用户的并发访问。

总而言之，您似乎需要比本网站提供的更直接的帮助；尝试寻找您所在地区的网络应用专家。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-16T14:33:33.107

如果您正在寻找客户端数据库访问，那么其他人所说的。

如果您只是在寻找一种访问数据库的方法（不在浏览器中），并且 Javascript 是您最熟悉的语言，请尝试[JSDB](http://www.jsdb.org)。（它是一个通过 ODBC、SQLite 和平面文件绑定数据库的 Javascript shell）我用过很多次，它是我首选的脚本 shell。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-04-13T08:34:11.323

这个问题很久以前就被问过了，最近我发现了一些对未来访问者有帮助的东西。您实际上可以通过这个名为 mysqljs 的 javaScript 库访问您的数据库，该库可以从[http://www.mysqljs.com下载](http://www.mysqljs.com)

代码语法：

```
 MySql.Execute(
    "mysql.yourhost.com", 
    "username", 
    "password", 
    "database", 
    "select * from Users", 
    function (data) {
        console.log(data)
}); 
```

注意：默认情况下没有安全性，您要编写自己的安全性

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-16T10:37:53.160

我很久没有使用 M$ Access，但我认为他们有一些非常好的方法可以将数据导出为 HTML 格式。那将是静态 HTML 代码，但这对于您想要做的事情来说已经足够了。绝对比编写数据库后端更容易......

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-16T12:07:17.457

您是从客户端思考的，而您应该从服务器端思考。

您需要在服务器端有一个脚本来查询 Access，并根据表单中提供的注册号的值为其创建 HTML。

脚本语言由您决定。鉴于您使用的是 Access，我想 Microsoft 系列语言中的一种会是最好的，并且您的机构已经有一个 Web 服务器（可能是 IIS）来托管您的网站。

第一件事：

*   您的机构正在运行什么服务器软件？这决定了要使用的最佳编程语言。
*   你有什么预算。如果它接近于零，那么您正在寻找免费的 IDE。无论服务器操作系统如何，在 Eclipse 中开发并在 Tomcat 上部署可能会更好。
*   你懂什么语言？
*   使用您选择的技术获取有关编程网站的书籍。例如对于 Java，我建议将 Struts 和 Tiles 用于这样的简单网站。
*   您可能希望将数据从 Access 迁移到数据库后端 - 如果您的机构已经拥有许可证，则为 MSSQL，如果您的预算为零，则为 MySQL 或 PostgreSQL。

从您的问题来看，这听起来对您来说是全新的。然而，这是一个小项目，因此是学习如何编写交互式网站的理想起点。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-16T11:02:38.290

JavaScript（或任何客户端语言）无法访问仍位于服务器上的内容。您最好的选择是使用 AJAX 实现并拥有一系列 Web 服务，您可以从 JavaScript 中查询这些服务并以可用格式（很可能是 JSON）返回结果。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-16T15:01:40.320

这是一个简单的 ASP (vbscript) 脚本，它将您的数据转储到一个表中。您可以编辑路径和查询以适应您的情况。正如其他人所提到的，它没有提供体面的安全性。

用 FILENAME.asp?regno=xxxxx 调用它

```
<%
Set Conn = Server.CreateObject("ADODB.Connection")
Conn.Open "Provider=Microsoft.Jet.OLEDB.4.0; Data Source=c:/YourDatabase.mdb"
SQL = "Select * from TABLENAME where regno=" & request("regno")
set RS= Conn.execute(SQL)
%>
<table>
    <tr>
    <% for x=0 to rs.fields.count-1 %>
        <th><%=RS.fields(x).value%></th>
    <% next %>
    </tr>
    <% do until RS.eof %>
        <tr>
            <% for x=0 to rs.fields.count-1 %>
                <td><%=RS.fields(x).value%></td>
            <% next %>
    </tr>
    <% rs.movenext %>
    <% loop %>
</table>
<%
RS.close()
set Conn=nothing
%> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-07-19T13:24:54.863

您可以使用 PHP 将登录详细信息传递到访问数据库，以便提供更安全的登录。最好还是将 mySql 与 PHP 一起使用。

# c# - 如何模仿 WPF 应用程序中扩展和缩小弹出窗口的网站效果？

> ID：370892
> 
> 赞同：1
> 
> 时间：2008-12-16T10:15:56.107
> 
> 标签：c#, wpf

请点击链接[http://msdn.microsoft.com/hi-in/default.aspx](http://msdn.microsoft.com/hi-in/default.aspx)并查看页面右上角。

在那里您会找到一个“Microsoft.com”扩展器。当您将鼠标移到它上面时，它会显示为一个弹出窗口并增长。当您将鼠标移开时，窗口会缩小。我想在我的 WPF 应用程序中使用 C# 模拟这种效果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-16T10:47:11.893

不知道你为什么被改装。您可以使用`Popup`控件并为其大小设置动画。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T10:56:35.040

在msdn论坛上[查看](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/41742469-ba87-454d-9a02-630f42299811/)此帖子。它稍微解释了弹出控件的使用。[这](http://blogs.msdn.com/wpfsdk/archive/2007/04/27/popup-your-control.aspx)是另一个很好的例子。

# linux - 如何进入主栈

> ID：370910
> 
> 赞同：0
> 
> 时间：2008-12-16T10:22:59.853
> 
> 标签：linux, stack, overflow, stack-dump

我正在使用备用堆栈来处理 C over linux 中程序的信号。当堆栈溢出发生时，我的信号被传递到我的备用信号堆栈而不是主堆栈上。

所以在这种情况下我想转储**主**堆栈....我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-22T21:42:44.793

记住 main 中的顶部堆栈地址（以及该堆栈帧中的某些局部变量），然后从异常地址转储到该地址。请注意，存在一些可移植性问题（例如，堆栈在 hp-pa-risc 上向上增长）。如果失败不是由于访问溢出堆栈下方的受保护区域，您必须查看在信号之前有效的 sp 的异常信息。异常信息作为参数传递给信号处理程序。同样，这可能是非常特定于 cpu 和 os 的（在所有 unice 之间有所不同）。

问候

# linq-to-sql - Linq 到 SQL

> ID：370913
> 
> 赞同：0
> 
> 时间：2008-12-16T10:24:30.583
> 
> 标签：linq-to-sql

我一直在玩 Linq to Sql，我想知道是否有可能得到一个结果？例如，我有以下内容：

using(DataClassContext context = new DataClassContext())
{
var customer = from c in context.table
where c.ID = textboxvalue
select c;
}

有了这个，我需要围绕 var 客户做一个 foreach，但我知道这将是一个单一的值！任何人都知道我怎么能做一个“textbox.text = c.name;” 或者沿着这条线的东西......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-16T10:29:58.247

是的，这是可能的。

```
using(DataClassContext context = new DataClassContext())
{
var customer = (from c in context.table
where c.ID = textboxvalue
select c).SingleOrDefault();
} 
```

这样，如果没有任何结果，您将获得 1 个结果或 null。

您还可以使用 Single()，它在没有结果时抛出异常。First() 只会给你找到的第一个结果，而 Last() 只会给你最后一个结果，如果有的话。

这是所有 Enumerable 方法的[概述](http://msdn.microsoft.com/en-us/library/system.linq.enumerable_methods.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-16T10:28:16.300

```
var customer = context.table.SingleOrDefault(c => c.ID == textboxvalue); 
```

# c# - 内部构造函数

> ID：370920
> 
> 赞同：6
> 
> 时间：2008-12-16T10:26:27.613
> 
> 标签：c#, .net

昨天我认为在 WPF 应用程序中实现我自己的触发器会很好。我创建了一个继承 TriggerBase 的类 MyTrigger。TriggerBase 是一个公共抽象类。所以继承不是问题。但是这个类中的构造函数被标记为内部的。编译器会抛出一个错误，因为它不是有效的构造函数。为什么有人创建公共类但将构造函数标记为内部？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-16T10:32:48.647

如果您希望该类可见，但只允许在您自己的程序集中对其进行子类化。子类本身可能具有公共构造函数 - 或者它们可以通过工厂访问。

我无法评论这对于 WPF 中的 TriggerBase 是否是一个好的设计决策，但至少在某些情况下是合理的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-16T10:32:25.120

我能想到的一个原因是，新实例的实际创建将由同一程序集中的另一个公共类处理。这将迫使您通过这个其他类创建实例 - 可能是某种工厂模式实现。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-16T10:32:55.247

它是公开的，因为它用作 WPF 附带的触发器（Trigger、MultiTrigger、EventTrigger、DataTrigger 等）的基类。如果它不是公开的，那么您将无法将这些类标记为公开。

构造函数是内部的，因为它们不打算让您自己使用它。我猜你应该是从上面提到的类之一派生的。

# wspbuilder - 在哪里可以找到 WSPBuilder 1.03 的文档？

> ID：370922
> 
> 赞同：0
> 
> 时间：2008-12-16T10:27:24.163
> 
> 标签：wspbuilder

我似乎找不到任何关于如何让 WSPBuilder 工作的文档。codeplex 项目位于：http: [//www.codeplex.com/wspbuilder/Release/ProjectReleases.aspx? ReleaseId=16820](http://www.codeplex.com/wspbuilder/Release/ProjectReleases.aspx?ReleaseId=16820)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T09:57:33.853

我一直在这里使用这个运行

[http://www.zimmergren.net/archive/2009/04/08/wspbuilder-walkthrough-of-the-visual-studio-add-in.aspx](http://www.zimmergren.net/archive/2009/04/08/wspbuilder-walkthrough-of-the-visual-studio-add-in.aspx)

# unit-testing - 包含文件系统调用的单元测试方法

> ID：370925
> 
> 赞同：4
> 
> 时间：2008-12-16T10:28:41.743
> 
> 标签：unit-testing, file-io

我有一个我想对其中包含文件系统调用的方法进行单元测试，并且想知道如何去做。我查看[了具有文件系统依赖性的单元测试代码，](https://stackoverflow.com/questions/129036/unit-testing-code-with-a-file-system-dependency)但它没有回答我的问题。

我正在测试的方法看起来像这样（c#）

```
public void Process(string input)
{
    string outputFile = "output.txt";
    this.Transform(input, Resources.XsltFile, outputFile);
    if ((new FileInfo(outputFile)).Length == 0)
    {
        File.Delete(outputFile);
    }
} 
```

我正在模拟 Transform(..) 方法以不向文件输出任何内容，因为我正在对 Process 方法而不是 Transform(..) 方法进行单元测试，因此不存在 output.txt 文件。因此 if 检查失败。

我应该如何正确地做到这一点？我是否应该围绕我要模拟的文件 io 方法创建某种包装器？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-16T10:40:17.213

**编辑**我在您将 C# 添加到问题之前回答了（或者我错过了它......）所以我的回答有点 java-esque，但原理是一样的......

* * *

您对文件 IO 的包装器的想法很好。这是一个这样的例子，但任何类似的事情都可以做：

```
interface FileProvider {
    public Reader getContentReader(String file);
        // notice use of the Reader interface
        //   - real-life returns a FileReader;
        //   - testing mock returns a StringReader;

    public FileInfo getFileInfo(String path);
        // easy to mock out...
}

class Processor {

    private FileProvider fileProvider;

    public void setFileProvider(FileProvider provider) { 
        this.provider = provider; 
    }

    public void process(String input) {
        // use this.fileProvider for all filesystem operations...
    }
} 
```

这是一个[依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)的例子——一种使事物易于测试的常见模式：

*   在测试时，您可以使用像[NMock](http://www.nmock.org/)这样的模拟框架来模拟测试`FileProvider`实现；

*   在运行时，您只需插入真正的实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T10:38:43.033

我认为您应该创建两个文件：一个长度为零，另一个包含一些数据。然后，您应该对每个文件进行测试。在准备阶段，您应该将给定文件复制到测试目录，运行测试，然后断言文件是否存在。

# .net - .NET 2.0 中的最佳数据访问方法

> ID：370938
> 
> 赞同：3
> 
> 时间：2008-12-16T10:33:23.450
> 
> 标签：.net, sql, dao

在使用 .NET 3.5 进行开发时，我自然会使用 LINQ 进行数据访问。

但是对于 .NET 2.0 项目，最好使用哪种数据访问模型？我倾向于主要使用TableAdapters，但有时也会根据情况编写自己的SQL。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-16T10:35:28.627

你试过[NHibernate](http://nhibernate.org)吗？我自己并没有太多使用它，但是我对它的 Java 表亲的体验是非常积极的。

还有其他替代方案，例如[LLBLGen](http://www.llblgen.com/defaultgeneric.aspx)。

在不了解更多问题的情况下，很难推荐一个整体的“最佳”解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-16T11:00:31.697

[CodeSmith](http://www.codesmithtools.com/)是我听说的另一个好工具。

没有*最好*的DAL，只有当前解决方案的*最佳*。

我们多年来一直使用内部产品，这并不算太糟糕，但与商业产品相比，最终无法维护。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-16T11:11:28.537

对于 MVC 风格的 ASP .Net 2.0 应用程序，您可以使用 Castle 项目和 ActiveRecord 进行数据访问。ActiveRecord 可以单独使用。

**Active Record**
“使用 NHibernate 实现的企业数据映射模式”
[http://www.castleproject.org/](http://www.castleproject.org/)

# visual-studio-2008 - Visual Studio 2005 -> 2008/10 服务安装程序项目升级问题

> ID：370940
> 
> 赞同：13
> 
> 时间：2008-12-16T10:34:00.593
> 
> 标签：visual-studio-2008, windows-services, installation, windows-installer, uninstallation

我已经升级了一个 [.vdproj MSI generator project built into VS2008] System.Configuration.Install.Installer with a `ServiceProcessInstaller`and a `ServiceInstaller`from Visual Studio 2005 to 2008\. 安装程序类没有后果的自定义（即，不尝试启动或停止服务或注册儿童）

`RemovePreviousVersions`设置为`true`，我正在更改`Version`and `ProductCode`。这会在安装过程中触发错误：

“错误 1001：指定的服务已存在”

谷歌搜索产生的东西（但直到现在还没有）：-[谷歌“指定的服务已经存在”](http://www.google.ie/search?hl=en&q=%22error+1001%3A+the+specified+service+already+exists%22&meta=)
我迄今为止看到的最有用的一个是[http://forums.msdn.microsoft.com/en-US/winformssetup /thread/b2d1bd22-8499-454e-9cec-1e42c03e2557/](http://forums.msdn.microsoft.com/en-US/winformssetup/thread/b2d1bd22-8499-454e-9cec-1e42c03e2557/) 但这并不能回答基本问题：-

鉴于用户可以选择：
a) 相同的安装位置
或 b) 不同的安装位置，
为了确保卸载旧服务并安装新服务，明智地做出的最小代码更改是什么？或者，对于将具有相同名称（即签名）的相同服务的 v1.0.1 升级到 v1.0.2 的基本场景，是否需要更改代码来解决此问题

（AIUI 强命名只有在旧安装程序中有重要的卸载步骤而新安装程序中没有时才会发挥作用。）

我在 VS 2008 中生成了一个新的安装程序，但效果并不好。

目前，我的解决方法是停止更新`Version`and `ProductCode`，当用户被告知他们已经安装了一个版本时，强制用户手动卸载。

附录感谢[divo 的](https://stackoverflow.com/users/40347/divo)探测：虽然可能可行的最简单的黑客攻击是说“如果调用安装步骤并且它是升级，请先调用服务的卸载步骤”，但我想要一个正式的官方祝福答案！（例如，在升级期间重命名服务时，简单的 hack 如何应对？）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-06T01:07:27.657

这应该回答你的问题

[安装新版本软件时如何消除“指定的服务已存在”？](https://stackoverflow.com/questions/451573/how-do-i-eliminate-the-specified-service-already-exists-when-i-install-new-versio/617385)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T11:13:40.467

您的服务（设置）是否提供用于卸载服务的自定义操作？

升级意味着在安装新产品之前卸载以前安装的产品。我认为错误的原因是无法删除旧服务。

如果您的服务是用 .NET 编写的，您可能会发现这篇文章很有用：http: [//www.codeproject.com/KB/install/InstallService.aspx](http://www.codeproject.com/KB/install/InstallService.aspx)

# vbscript - 在 WSH 中，如何解析像 ALT-CTRL-DEL 这样 的多键按下？

> ID：370943
> 
> 赞同：-2
> 
> 时间：2008-12-16T10:36:52.397
> 
> 标签：vbscript

如何在 WSH 脚本中使用多个键，例如（ALT、CTRL、DELETE）？如何使用 WSH SCript 截取应用程序的屏幕截图并将其粘贴到 MSWord 中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-16T10:46:02.690

使用 SendKeys，你不能。[我告诉过你](https://stackoverflow.com/questions/370673/taking-screenshots-of-an-application-using-wsh-script#370685)。

关于发送多个密钥 - 请阅读[MSDN](http://msdn.microsoft.com/en-us/library/8c6yea83(VS.85).aspx)[上的文档`SendKeys()`](http://msdn.microsoft.com/en-us/library/8c6yea83(VS.85).aspx)。不难发现。

也许某处有一个 ActiveX 组件可以为您截取屏幕截图，但是使用 vanilla Windows 脚本，这是无法做到的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T20:22:37.943

是的，我认为就像 Tomalak 所说，您尝试做的很可能涉及使用 CreateObject 命令调用 ActiveX 组件。

不过，我建议不要这样做，通常当您的脚本尝试调用应用程序（Word）并截取屏幕截图时......是时候投资一些开发软件（Visual Studio 或其他东西）并编写一个实际的应用程序.

但是，如果您完全了解它，[DevGuru 有一个不错](http://www.devguru.com/technologies/wsh/17377.asp)的 CreateObject 命令参考页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-12T16:11:36.653

[https://social.technet.microsoft.com/wiki/contents/articles/5169.vbscript-sendkeys-method.aspx](https://social.technet.microsoft.com/wiki/contents/articles/5169.vbscript-sendkeys-method.aspx)

它说要执行“Alt F5”之类的操作，执行“% {F5}”

要执行Ctrl Alt Delete，您必须执行“^ % {DEL}”

# c# - 如何在 javascript 中获取 DropDownList 的 DataTextField？

> ID：370944
> 
> 赞同：0
> 
> 时间：2008-12-16T10:36:57.967
> 
> 标签：c#, asp.net, javascript

我正在使用 DropDownList 作为

```
<asp:DropDownList 
  ID="ddlLocationName" 
  runat="server" 
  DataValueField="Guid" 
  DataTextField="LocationName" 
  AppendDataBoundItems="false" 
  AutoPostBack="false" 
  onchange="LocationChange()"
></asp:DropDownList> 
```

当我从下拉列表中选择项目时，DataTextField 应该显示在文本字段中。为此，我使用以下 javascript：

```
function LocationChange()
{  
  document.getElementById ("ctl00_mainContent_ctl02_txtEventLocation").value = document.getElementById ('ctl00_mainContent_ctl02_ddlLocationName')[document.getElementById ('ctl00_mainContent_ctl02_ddlLocationName').selectedIndex].value     
} 
```

不使用下拉列表的 DataValueField 时它工作正常。但是，当也使用下拉的 DataValueField 属性时，如何执行所需的任务？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-16T10:55:11.130

DataValueField 将填充 html `<option />`tags value 属性，而 DataTextField 将填充 text 属性。

当您*不*指定 DataValueField 时，DataTextField 用于两者（反之亦然 IIRC）。

因此，在 JavaScript 中，您将需要以下内容（**注意 - 我使用的是 MS AJAX 简写，其中 $get === document.getElementById**）：

```
function LocationChange(){
  var ddl = $get('dropDownListId');
  var selectedOption = ddl.options[ddl.selectedIndex];
  var selectedText = selectedOption.text;
  var selectedValue = selectedOption.value;

  alert('Your option has a text property of ' + selectedText + ' and a value property of ' + selectedValue');
} 
```

然后，您可以对结果做任何您想做的事情，例如将它们放入文本框中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T11:26:29.740

感谢您的回复。我找到了答案。

```
function LocationChange()
{  
    document.getElementById ("ctl00_mainContent_ctl02_txtEventLocation").value = document.getElementById ('ctl00_mainContent_ctl02_ddlLocationName')[document.getElementById ('ctl00_mainContent_ctl02_ddlLocationName').selectedIndex].innerText
} 
```

# jsp - html表单字段作为struts表单中的数组元素

> ID：370946
> 
> 赞同：4
> 
> 时间：2008-12-16T10:37:06.110
> 
> 标签：jsp, struts

我想做的是在一个页面中动态添加 HTML 输入字段，每个字段对应一个 struts 数组属性的元素。假设我在 HTML 页面中有许多相同的字段：

> < 输入类型="文件" 名称="我的文件" />

并且当提交表单时，我希望每个字段对应于 struts 表单 bean 中的 FormFile 数组中的一个元素：

> FormFile [] 我的文件；

显然上述方法不起作用，但我正在寻找如何做一些等效的事情。

编辑：**以上不适用于上传文件和仅 FormFile 类型。**

否则，数组元素会直观地映射到输入元素或 html:text 元素实例。所以，为了让我的问题更具体，为什么我不能用 struts 上传一组文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T16:05:37.503

好的，这是一个“对我有用”的解决方案：

首先，在您的 html/jsp 文件中， name 属性应该被索引：

> 文件 1：< input type="file" name="myfile[0]" />
> 
> 文件 2：< input type="file" name="myfile[1]"/>
> 
> 文件 3：< input type="file" name="myfile[2]" />

struts 表单中的“捕获”是初始化 FormFile 数组。做这两件事就可以了。请注意对照实际提交的元素数量检查数组的长度，即检查空数组元素。我认为这为根据您的需求调整它提供了一个很好的基准。正如我在问题的最终编辑中所说，对于 < html:text > 或 < input type="text" > 元素，您在表单 bean 中既不需要索引属性也不需要数组初始化。我真的不知道为什么会这样，我在 apache commons 项目的 org.apache.commons.beanutils.PropertyUtilsBean 类中查了一下：有兴趣的人可以看看该类的 set*Property 方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-03T21:54:12.753

您要查找的内容称为“索引属性”。由于有比我能描述的更好的“方法”，请看[这里](http://struts.apache.org/1.x/struts-taglib/indexedprops.html)。

# linux - 滚动 KTextEdit 开始

> ID：370954
> 
> 赞同：0
> 
> 时间：2008-12-16T10:39:58.553
> 
> 标签：linux, qt, kdelibs

我有一个 KTextEdit，里面有一些文字。

当我放置大量文本时，KTextEdit 将自动滚动到末尾（显然）。

我的问题是：如何滚动到开头（即 KTextEdit 的第一行）？！？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-16T10:59:33.273

看起来你用

```
QTextCursor cursor = edit->textCursor();
cursor.setPosition(0);
edit->setTextCursor(cursor); 
```

未经测试，但看起来不错。找到了另一种更短的方法：

```
edit->moveCursor(QTextCursor::Start); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-16T10:58:07.520

我能想到的最简单的方法是：

```
KTextEdit *kte;
...
kte->append("some huge text");
kte->verticalScrollBar()->setValue(0); 
```

# activex - 自动安装activeX

> ID：370960
> 
> 赞同：0
> 
> 时间：2008-12-16T10:43:43.787
> 
> 标签：activex

我是一名网络开发人员，我目前的任务是构建一个 ActiveX 组件。

这是我第一次必须使用 ActiveX，并且我设法制作了一个工作示例。

但是我无法从浏览器安装 ActiveX。使用 Visual Studio 2008 安装它并运行网页时，一切都按预期工作，当我没有安装它时，我会期待类似于 Windows 更新的东西，询问我是否允许安装，但这不会发生......

这是我将其放置在网页中的方式：

```
<object id="myActiveX" name="myActiveX" classid="clsid:A68B19C8-9DB4-49e4-912F-37FB44968528"
                 codebase="http://localhost/myWebSite/install.cab#version=1,0,0,0"></object> 
```

classId 中的 guid 与我为班级创建的 guid 匹配。

谁能指出我错过了什么？

编辑：

忘了提到这一点，我的 ActiveX 有一个安装项目，它生成一个 .msi 和一个 Setup.exe

我已经与那些使用 .inf 文件的人制作了一个 cab 文件，如下所示：

```
[version]
signature="$CHICAGO$"
AdvancedINF=2.0
[Setup Hooks]
hook1=hook1

[hook1]
run=msiexec.exe /i %EXTRACT_DIR%\Install.msi /qf 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-16T12:41:52.053

您可能需要检查您的 IE 安全设​​置：默认情况下，未签名的 ActiveX 控件将被忽略。

这是另一种可能性：

您是否将控件标记为“脚本安全”和“初始化安全”？

我不确定这是您遇到的问题，因为 1）您的示例 HTML 代码没有显示您在脚本中使用该控件，并且 2）说 HTML 片段没有显示您设置了控件属性. 然而，这是一个常见的陷阱，所以如果我是你，我会看看。

IIRC 这可以通过实现[IObjectSafety](http://msdn.microsoft.com/en-us/library/aa768224.aspx)接口或使用注册表设置来实现。

[这](http://msdn.microsoft.com/en-us/library/aa751977(VS.85).aspx)和这两个指针可以帮助您入门。

# java - 为什么Java中的静态方法不能是抽象的？

> ID：370962
> 
> 赞同：640
> 
> 时间：2008-12-16T10:45:27.717
> 
> 标签：java, abstract-class, static-methods

问题是在 Java 中为什么我不能定义一个抽象的静态方法？例如

```
abstract class foo {
    abstract void bar( ); // <-- this is ok
    abstract static void bar2(); //<-- this isn't why?
} 
```

* * *

## 回答 #1

> 赞同：590
> 
> 时间：2008-12-16T10:50:02.230

因为“抽象”的意思是：“不实现任何功能”，而“静态”的意思是：“即使没有对象实例也有功能”。这是一个逻辑矛盾。

* * *

## 回答 #2

> 赞同：350
> 
> 时间：2009-10-20T14:27:45.400

语言设计不佳。直接调用静态抽象方法比仅仅为使用该抽象方法而创建实例要有效得多。当使用抽象类作为枚举无法扩展的解决方法时尤其如此，这是另一个糟糕的设计示例。希望他们在下一个版本中解决这些限制。

* * *

## 回答 #3

> 赞同：150
> 
> 时间：2008-12-16T10:48:57.897

您不能覆盖静态方法，因此使其抽象化将毫无意义。此外，抽象类中的静态方法属于该类，而不是覆盖类，因此无论如何都不能使用。

* * *

## 回答 #4

> 赞同：94
> 
> 时间：2008-12-16T20:17:18.140

方法的`abstract`注释表明该方法必须在子类中被覆盖。

在 Java 中，`static`成员（方法或字段）不能被子类覆盖（这在其他面向对象的语言中不一定如此，请参阅 SmallTalk。）`static`成员可能是**hidden ，但这与****overridden**根本不同。

由于不能在子类中覆盖静态成员，因此无法将`abstract`注释应用于它们。

顺便说一句 - 其他语言确实支持静态继承，就像实例继承一样。从语法的角度来看，这些语言通常要求在语句中包含类名。例如，在 Java 中，假设您在 ClassA 中编写代码，这些是等价的语句（如果 methodA() 是静态方法，并且没有具有相同签名的实例方法）：

```
ClassA.methodA(); 
```

和

```
methodA(); 
```

在 SmallTalk 中，类名不是可选的，所以语法是（注意 SmallTalk 不使用 . 来分隔“主语”和“动词”，而是使用它作为语句终止符）：

```
ClassA methodA. 
```

因为总是需要类名，所以总是可以通过遍历类层次结构来确定方法的正确“版本”。对于它的价值，我偶尔会错过`static`继承，当我第一次开始使用它时，我被 Java 中缺乏静态继承所困扰。此外，SmallTalk 是鸭子类型的（因此不支持按合同编程。）因此，它没有`abstract`类成员的修饰符。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2013-05-15T07:13:40.203

我也问了同样的问题，这是为什么

由于抽象类说，它不会给出实现并允许子类给出它

所以 Subclass 必须覆盖 Superclass 的方法，

**规则 1** -**不能覆盖静态方法**

因为静态成员和方法是编译时元素，这就是为什么允许静态方法的重载（编译时多态性）而不是覆盖（运行时多态性）

所以，它们不能是抽象的。

**没有*抽象静态*之类的东西 <--- Java Universe 中不允许**

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2012-03-19T16:54:06.637

这是一种糟糕的语言设计，实际上没有理由说明为什么它不可能。

事实上，这里有一种模式或方式，说明如何在 **Java ** 中模仿它，让您至少能够修改自己的实现**：**

```
public static abstract class Request {                 

        // Static method
        public static void doSomething() {
                get().doSomethingImpl();
        }

        // Abstract method
        abstract void doSomethingImpl();

        /////////////////////////////////////////////
        private static Request SINGLETON;
        private static Request get() {
            if ( SINGLETON == null ) {
                // If set(request) is never called prior,
                // it will use a default implementation. 
                return SINGLETON = new RequestImplementationDefault();
            }
            return SINGLETON;
        }
        public static Request set(Request instance){
            return SINGLETON = instance;
        }
        /////////////////////////////////////////////
} 
```

两种实现：

```
/////////////////////////////////////////////////////

public static final class RequestImplementationDefault extends Request {
        @Override void doSomethingImpl() {
                System.out.println("I am doing something AAA");
        }
}

/////////////////////////////////////////////////////

public static final class RequestImplementaionTest extends Request {
        @Override void doSomethingImpl() {
                System.out.println("I am doing something BBB");
        }
}

///////////////////////////////////////////////////// 
```

可以如下使用：

```
Request.set(new RequestImplementationDefault());

// Or

Request.set(new RequestImplementationTest());

// Later in the application you might use

Request.doSomething(); 
```

**这将允许您静态**调用您的方法，但能够更改**测试环境**的实现。

从理论上讲，您也可以在 a 上执行此操作`ThreadLocal`，并且能够为每个 Thread 上下文设置实例，而不是像这里看到的那样完全全局，然后可以执行`Request.withRequest(anotherRequestImpl, () -> { ... })`或类似操作。

现实世界通常不需要这种`ThreadLocal`方法，通常能够在全球范围内改变**测试环境的实现就足够了。**

请注意，这样做的唯一目的是使一种**方法**能够**保留**调用静态方法提供的**直接**、**简单**和**干净**的方法的能力，同时能够在以稍微更复杂为代价的**情况****下****切换** **实现** 执行。

 ****这只是一种解决通常不可修改的静态代码的模式。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2012-09-22T15:55:54.620

*   定义抽象方法只是为了在子类中重写它。但是，静态方法不能被覆盖。因此，具有抽象的静态方法是编译时错误。

    现在下一个问题是为什么不能覆盖静态方法？

*   这是因为静态方法属于一个特定的类而不是它的实例。如果您尝试覆盖静态方法，您将不会收到任何编译或运行时错误，但编译器只会隐藏超类的静态方法。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2015-12-05T13:16:14.860

根据定义，静态方法不需要知道`this`. 因此，它不能是虚拟方法（根据通过 获得的动态子类信息重载`this`）；相反，静态方法重载仅基于编译时可用的信息（这意味着：一旦您引用超类的静态方法，您即调用超类方法，但绝不会调用子类方法）。

据此，抽象静态方法将毫无用处，因为您永远不会将其引用替换为某个已定义的主体。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-01-20T13:02:27.453

我看到已经有无数的答案，但我没有看到任何实际的解决方案。当然，这是一个真正的问题，没有充分的理由在 Java 中排除这种语法。由于原始问题缺少可能需要的上下文，因此我提供了上下文和解决方案：

假设您在一堆相同的类中有一个静态方法。这些方法调用特定于类的静态方法：

```
class C1 {
    static void doWork() {
        ...
        for (int k: list)
            doMoreWork(k);
        ...
    }
    private static void doMoreWork(int k) {
        // code specific to class C1
    }
}
class C2 {
    static void doWork() {
        ...
        for (int k: list)
            doMoreWork(k);
        ...
    }
    private static void doMoreWork(int k) {
        // code specific to class C2
    }
} 
```

`doWork()``C1`和中的方法`C2`是相同的。可能有很多这样的类：`C3` `C4`等等。如果`static abstract`允许，您可以通过执行以下操作来消除重复的代码：

```
abstract class C {
    static void doWork() {
        ...
        for (int k: list)
            doMoreWork(k);
        ...
    }

    static abstract void doMoreWork(int k);
}

class C1 extends C {
    private static void doMoreWork(int k) {
        // code for class C1
    }
}

class C2 extends C {
    private static void doMoreWork(int k) {
        // code for class C2
    }
} 
```

但这不会编译，因为`static abstract`不允许组合。但是，这可以通过`static class`构造来规避，这是允许的：

```
abstract class C {
    void doWork() {
        ...
        for (int k: list)
            doMoreWork(k);
        ...
    }
    abstract void doMoreWork(int k);
}
class C1 {
    private static final C c = new  C(){  
        @Override void doMoreWork(int k) {
            System.out.println("code for C1");
        }
    };
    public static void doWork() {
        c.doWork();
    }
}
class C2 {
    private static final C c = new C() {
        @Override void doMoreWork(int k) {
            System.out.println("code for C2");
        }
    };
    public static void doWork() {
        c.doWork();
    }
} 
```

使用此解决方案，唯一重复的代码是

```
 public static void doWork() {
        c.doWork();
    } 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2015-06-14T21:11:09.323

假设有两个类，`Parent`和`Child`。`Parent`是`abstract`。声明如下：

```
abstract class Parent {
    abstract void run();
}

class Child extends Parent {
    void run() {}
} 
```

这意味着任何实例`Parent`必须指定如何`run()`执行。

但是，现在假设`Parent`不是`abstract`。

```
class Parent {
    static void run() {}
} 
```

这意味着`Parent.run()`将执行静态方法。

方法的定义`abstract`是“已声明但未实现的方法”，这意味着它本身不返回任何内容。

方法的定义`static`是“无论在哪个实例上调用它，都为相同参数返回相同值的方法”。

方法的`abstract`返回值会随着实例的变化而变化。一个`static`方法不会。`static abstract`方法几乎是一种返回值是常量但不返回任何内容的方法。这是一个逻辑矛盾。

此外，方法确实没有太多理由`static abstract`。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-07-17T16:12:03.120

抽象类不能有静态方法，因为抽象是为了实现动态绑定而静态方法静态绑定到它们的功能。静态方法意味着行为不依赖于实例变量，因此不需要实例/对象。只需要类。静态方法属于类而不是对象。它们存储在称为PERMGEN 的内存区域中，从该区域与每个对象共享。抽象类中的方法动态绑定到它们的功能。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2018-06-13T14:54:09.190

将方法声明为`static`意味着我们可以通过其类名来调用该方法，如果该类也是`abstract`如此，那么调用它是没有意义的，因为它不包含任何主体，因此我们不能将方法声明为`static`和`abstract`。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2019-12-31T08:06:26.433

由于抽象方法属于该类，不能被实现类覆盖。即使存在具有相同签名的静态方法，它也会隐藏该方法，不会覆盖它。因此，将抽象方法声明为静态是无关紧要的，因为它永远不会获得主体。因此，编译时错误。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-12-16T11:11:52.343

可以在没有类实例的情况下调用静态方法。在您的示例中，您可以调用 foo.bar2()，但不能调用 foo.bar()，因为对于 bar，您需要一个实例。以下代码将起作用：

```
foo var = new ImplementsFoo();
var.bar(); 
```

如果您调用静态方法，它将始终执行相同的代码。在上面的例子中，即使你在 ImplementsFoo 中重新定义了 bar2，对 var.bar2() 的调用也会执行 foo.bar2()。

如果 bar2 现在没有实现（这就是抽象的意思），您可以调用没有实现的方法。这是非常有害的。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2015-08-29T01:25:27.047

我相信我已经找到了这个问题的答案，即为什么接口的方法（像父类中的抽象方法一样工作）不能是静态的。[这是完整的答案（不是我的）](https://stackoverflow.com/a/513001/3482428)

基本上静态方法可以在编译时绑定，因为要调用它们，您需要指定一个类。这与实例方法不同，您从中调用方法的引用的类在编译时可能是未知的（因此只能在运行时确定调用哪个代码块）。

如果您正在调用静态方法，则您已经知道实现它的类或它的任何直接子类。如果你定义

```
abstract class Foo {
    abstract static void bar();
}

class Foo2 {
    @Override
    static void bar() {}
} 
```

那么任何`Foo.bar();`调用显然都是非法的，你会一直使用`Foo2.bar();`.

考虑到这一点，静态抽象方法的唯一目的是强制子类实现这样的方法。您可能最初认为这是非常错误的，但如果您有一个泛型类型参数`<E extends MySuperClass>`，最好通过接口来保证`E`can `.doSomething()`。请记住，由于类型擦除，泛型仅在编译时存在。

那么，有用吗？是的，也许这就是 Java 8 允许在接口中使用静态方法的原因（尽管只有默认实现）。为什么不在类中使用默认实现抽象静态方法？仅仅因为具有默认实现的抽象方法实际上是一个具体方法。

为什么不抽象/接口静态方法没有默认实现？显然，仅仅是因为 Java 识别它必须执行哪个代码块的方式（我的答案的第一部分）。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2018-11-29T07:12:40.710

因为抽象类是一个面向对象的概念，而静态成员不是面向对象的一部分......
现在我们可以在接口中声明静态完整方法，我们可以通过在接口中声明主方法来执行接口

```
interface Demo 
{
  public static void main(String [] args) {
     System.out.println("I am from interface");
  }
} 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2020-12-28T09:00:07.007

因为抽象方法总是需要通过子类实现。但是如果你将任何方法设为静态，那么这个方法就不可能覆盖

例子

```
abstract class foo {
    abstract static void bar2(); 
}

class Bar extends foo {
    //in this if you override foo class static method then it will give error
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2013-11-30T21:10:42.320

拥有一个抽象静态方法的想法是你不能直接为那个方法使用那个特定的抽象类，但是只有一阶导数才能实现那个静态方法（或者对于泛型：你的泛型的实际类采用）。

这样，您可以创建一个 sortableObject 抽象类，甚至可以创建与（自动）抽象静态方法的接口，这些方法定义了排序选项的参数：

```
public interface SortableObject {
    public [abstract] static String [] getSortableTypes();
    public String getSortableValueByType(String type);
} 
```

现在您可以定义一个可排序对象，该对象可以按所有这些对象相同的主要类型进行排序：

```
public class MyDataObject implements SortableObject {
    final static String [] SORT_TYPES = {
        "Name","Date of Birth"
    }
    static long newDataIndex = 0L ;

    String fullName ;
    String sortableDate ;
    long dataIndex = -1L ;
    public MyDataObject(String name, int year, int month, int day) {
        if(name == null || name.length() == 0) throw new IllegalArgumentException("Null/empty name not allowed.");
        if(!validateDate(year,month,day)) throw new IllegalArgumentException("Date parameters do not compose a legal date.");
        this.fullName = name ;
        this.sortableDate = MyUtils.createSortableDate(year,month,day);
        this.dataIndex = MyDataObject.newDataIndex++ ;
    }
    public String toString() {
        return ""+this.dataIndex+". "this.fullName+" ("+this.sortableDate+")";
    }

    // override SortableObject 
    public static String [] getSortableTypes() { return SORT_TYPES ; }
    public String getSortableValueByType(String type) {
        int index = MyUtils.getStringArrayIndex(SORT_TYPES, type);
        switch(index) {
             case 0: return this.name ;
             case 1: return this.sortableDate ;
        }
        return toString(); // in the order they were created when compared
    }
} 
```

现在您可以创建一个

```
public class SortableList<T extends SortableObject> 
```

that can retrieve the types, build a pop-up menu to select a type to sort on and resort the list by getting the data from that type, as well as hainv an add function that, when a sort type has been selected, can auto -sort new items in。注意SortableList的实例可以直接访问“T”的静态方法：

```
String [] MenuItems = T.getSortableTypes(); 
```

必须使用实例的问题是 SortableList 可能还没有项目，但已经需要提供首选排序。

切里奥，奥拉夫。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2014-07-24T15:00:49.963

首先，关于抽象类的一个关键点——抽象类不能被实例化（参见[wiki](http://en.wikipedia.org/wiki/Abstract_type "链接到维基百科文章")）。因此，您不能创建抽象类的**任何**实例。

现在，java 处理静态方法的方式是与该类的所有**实例共享该方法。**

所以，如果你不能实例化一个类，那么这个类就不能有抽象的静态方法，因为抽象方法需要被扩展。

繁荣。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2015-06-22T04:56:43.667

根据 Java[文档](https://docs.oracle.com/javase/tutorial/java/IandI/defaultmethods.html)：

> 静态方法是与定义它的类相关联的方法，而不是与任何对象相关联的方法。类的每个实例共享其静态方法

在 Java 8 中，除了默认方法之外，接口中还允许使用静态方法。这使我们更容易在我们的库中组织辅助方法。我们可以将特定于接口的静态方法保留在同一个接口中，而不是在单独的类中。

一个很好的例子是：

```
list.sort(ordering); 
```

代替

```
Collections.sort(list, ordering); 
```

[doc](https://docs.oracle.com/javase/tutorial/java/IandI/defaultmethods.html)本身也给出了另一个使用静态方法的例子：

```
public interface TimeClient {
    // ...
    static public ZoneId getZoneId (String zoneString) {
        try {
            return ZoneId.of(zoneString);
        } catch (DateTimeException e) {
            System.err.println("Invalid time zone: " + zoneString +
                "; using default time zone instead.");
            return ZoneId.systemDefault();
        }
    }

    default public ZonedDateTime getZonedDateTime(String zoneString) {
        return ZonedDateTime.of(getLocalDateTime(), getZoneId(zoneString));
    }    
} 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2015-09-28T04:37:23.577

因为“抽象”意味着该方法将被覆盖，并且不能覆盖“静态”方法。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2015-12-05T11:46:12.243

当常规方法打算被子类覆盖并提供功能时，它们可以是抽象的。想象一下这个类`Foo`是由 etc 扩展的`Bar1, Bar2, Bar3`。所以，每个人都会根据自己的需要拥有自己的抽象类版本。

现在，根据定义，静态方法属于类，它们与类的对象或其子类的对象无关。它们甚至不需要它们存在，它们可以在不实例化类的情况下使用。因此，它们需要随时可用，并且不能依赖子类向它们添加功能。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2017-05-13T12:11:44.647

因为 abstract 是应用于抽象方法的关键字，所以不指定主体。如果我们谈论静态关键字，它属于类区域。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2018-03-09T06:49:07.917

因为如果您在类中使用任何静态成员或静态变量，它将在类加载时加载。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2021-08-18T04:35:34.813

有一种情况是 static 和 abstract 可以一起使用，即这两个修饰符都放在嵌套类的前面。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2021-10-24T15:50:48.637

***静态方法*** 无需创建类的实例即可调用静态方法。静态方法属于类而不属于类的对象。静态方法可以访问静态数据成员，也可以更改它的值。 **Abstract** Keyword 用于实现抽象。不能在子类中覆盖或实现静态方法。因此，将静态方法设为抽象是没有用的。

* * *

## 回答 #27

> 赞同：-1
> 
> 时间：2013-02-16T14:19:09.583

因为如果一个类扩展了一个抽象类，那么它必须重写抽象方法，这是强制性的。并且由于静态方法是在编译时解析的类方法，而重写方法是在运行时解析并遵循动态多态性的实例方法。

* * *

## 回答 #28

> 赞同：-1
> 
> 时间：2014-03-22T19:53:41.713

您可以使用 Java 8 中的接口来执行此操作。

这是关于它的官方文档：

[https://docs.oracle.com/javase/tutorial/java/IandI/defaultmethods.html](https://docs.oracle.com/javase/tutorial/java/IandI/defaultmethods.html)

# .net - 使用没有 XPO 的 DevExpress 进行服务器端分页

> ID：370968
> 
> 赞同：3
> 
> 时间：2008-12-16T10:50:03.433
> 
> 标签：.net, asp.net, winforms, paging, devexpress

是否有任何（相对）简单的方法可以在不使用 XPO 数据源的情况下使用 DevExpress 控件（Win 或 Web 控件）实现服务器端分页？通过服务器端分页，我的意思是控制只检索它需要从数据库中显示的记录，而不是整个表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-01-18T10:51:02.957

您必须创建自定义分页控件（不要使用 DevEx 的分页）。将当前页面和页面大小作为参数发送到过程或直接在查询中使用。

如何在 MS SQL 中使用此值示例是此链接：http: [//msdn.microsoft.com/en-us/library/ms186734.aspx](http://msdn.microsoft.com/en-us/library/ms186734.aspx)

在 Oracle 和其他数据库中，您也可以使用不同的技术来做到这一点。此致。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-29T23:32:16.097

如果您的数据源支持 LINQ，那么最新的 DevExpress 版本应该能够做正确的事情。

否则，您需要实现 IListServer。我现在正在为同样的事情苦苦挣扎，所以这不完全是一个“答案”。我还没有找到一个可行的例子，但他们的知识库中有一些有用的信息：http: [//www.devexpress.com/Support/Center/KB/p/A1022.aspx](http://www.devexpress.com/Support/Center/KB/p/A1022.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-10T00:51:18.037

如果你不想使用 LINQ，你可以试试这个 ObjectDataSource 的例子：http: [//www.devexpress.com/Support/Center/e/E166.aspx](http://www.devexpress.com/Support/Center/e/E166.aspx)

# vim - 是否可以像为 emacs/vim 一样为 Nedit 设置每个文件的选项

> ID：370970
> 
> 赞同：-1
> 
> 时间：2008-12-16T10:50:29.577
> 
> 标签：vim, emacs

使用 VIM 或 Emacs，我可以在文件中添加注释，这些注释将成为该文件的 VIM 设置：

 ````
/*
 * Local Variables:     
 * mode: C
 * c-basic-offset: 4
 * c-indentation-style: linux
 * indent-tabs-mode: nil
 * default-tab-width: 8
 * fill-column: 125
 * End:
 *
 * vim: et:sw=4:ts=8:si:cindent:cino=\:0,g0,(0:
 */ 

```

Nedit可以做同样的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-16T11:36:03.137

遗憾的是，简短的回答是，不。

如果您将对 nedit 的调用包装在 shell 脚本中，则更长的答案是（我相信您知道）是的。该脚本需要查看您尝试打开的文件的头部以获取有关设置的信息。然后，您可以将此信息吐出到一个文件中，并使用“--import”选项将这些设置加载到 nedit 中。

希望这有所帮助。

抢

# comparison - 大多数 Web 应用程序遗漏了桌面应用程序的哪些常见功能？

> ID：370972
> 
> 赞同：11
> 
> 时间：2008-12-16T10:51:11.247
> 
> 标签：comparison, desktop-application

Stackoverflow 用户[Luke在](https://stackoverflow.com/users/17602/luke)[这个答案](https://stackoverflow.com/questions/138761/web-applications-desktop-applications#171113)中写道：

> 桌面应用程序和 Web 应用程序之间的界限已经非常模糊。虽然曾几何时，为 Web 开发的性质与为桌面开发完全不同，但现在您会发现两者都出现了相同的概念 [...]。

由于我一直在寻求改进现有的 Web 应用程序，我想知道**大多数 Web 应用程序遗漏了“经典”桌面应用程序的哪些常见功能？**

例如，大多数桌面应用程序都会[提示用户保存未保存的数据，离开页面或关闭窗口](https://stackoverflow.com/questions/250055/aspnet-warning-on-changed-data-closing-windows)——这是许多 Web 应用程序错过的功能。可能某些功能甚至不是必需的，或者以其他方式得到补偿。也许有些功能无法在（经典）Web 应用程序中实现？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-16T10:56:19.770

您永远无法在 Web 应用程序中模仿的是编写良好的桌面应用程序的低延迟和即时反馈。

即使使用 ajax 技术仅加载部分页面，响应通常也会有明显的延迟（或者可能只是我和我的窄带）。您（至少再过几年）只是受限于网络访问和无网络访问之间的速度差异数量级。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-16T10:57:02.810

撤消按钮。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-12-16T11:49:40.677

右键单击特定于应用程序的弹出菜单是我注意到最多的东西。

通常右键单击浏览器应用程序会弹出浏览器弹出菜单，而不是应用程序特定的菜单。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-12-16T13:29:20.240

大多数 Web 应用程序上的键盘支持很弱，甚至不存在。这比以前更好了，但您仍然会发现许多主流网站甚至无法让标签顺序正常工作。大多数网站都没有正确处理焦点，甚至迫使用户使用鼠标来激活最简单的数据输入表单。您通常可以忘记加速键支持。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-12-16T11:13:37.317

公平地说，桌面应用程序缺少 webapps 的一个共同特征：XSS（[跨站点脚本](http://en.wikipedia.org/wiki/Cross-site_scripting)）。;-)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-12-16T11:16:06.390

当应用程序挂起时，您无法拔掉插头。（是的，我是认真的）

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-12-16T11:11:32.080

高级图形：我编写了一个 C 程序，它在一个简单的窗口中绘制一个连接贝塞尔补丁的曲面，我不得不以难以想象的方式对其进行调整，以使其在适当的时间内绘制出来。我无法想象被移植到网络上。

我的意思是，做高级图形并不是每个应用程序都需要的，但是如果显示非平凡的图片很慢，那么我们甚至不应该谈论动画。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-12-16T14:43:47.983

*   支持大文件。
*   与客户端操作系统集成。
*   支持特殊的输入/输出设备。
*   3D 或任何其他计算密集型（特定于每个用户）。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-02-23T08:33:26.460

**一个**正确的 Macintosh 菜单栏支持。

如果您是 Mac 的长期用户，即使有两台大显示器，您的肌肉也会猛扑到屏幕顶部以进行操作，并且知道*无限深度效果*会发挥作用并且您可以沿着该边缘滑动，从菜单中挑选。

没有浏览器内的应用程序可以提供这种体验。

**两个**命令键，这是菜单栏的副作用，不属于应用程序，但超出了一些范围 - 好的桌面应用程序具有命令键快捷方式（Windows 伙计的加速器，我不只是在谈论助记符与alt键支持一起使用）。当您按住相应的修饰键并等待几分之一秒时，出色的桌面应用程序会在带有加速键的按钮旁边显示很少的提醒。

**三张**更智能的桌子。有很多应用程序都将某种电子表格视图用作范例，包括编辑、排序、调整列大小。我想我已经看到了一些奇怪的部分支持的例子，但是 web 应用程序中的一张好桌子仍然有点像一只*跳舞的熊*。

**四**曾经是右键单击，但我发现越来越多的应用程序可以正确执行此操作，例如 Kerio[出色的网络邮件引擎](http://www.kerio.com/kms_webmail.html)。在足够多的网络应用程序中仍然缺少值得强调的内容。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-12-16T11:07:36.890

在任务栏或状态栏上显示应用程序请求/处理状态或消息。

对于 web，Javascript 可用于更新状态栏上的文本，但它不常用。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-12-16T11:59:26.273

在应用程序中外观和行为一致的标准 GUI 元素的可用性优势。

（尽管这肯定会随着 Web 应用程序开发人员采用某些被认为是最佳实践的 GUI 元素和模式而改变，特别是最终使用相同的库，例如拖放。）

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-12-16T13:04:29.777

“经典”桌面应用程序的一个共同特点是能够在没有互联网连接的情况下工作。我想念 Web 应用程序中的这一点。

例如，MS word 在没有互联网连接的情况下工作，但如果您想使用 Google 文档，则需要连接。

当然，应用程序是否需要互联网连接并不重要。例如，如果它是提要阅读器，我必须连接到互联网，无论我使用桌面阅读器还是在线阅读器。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-02-23T08:11:24.390

从 Finder/Explorer 拖放到 Web 应用程序中。反之亦然。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-12-16T13:19:09.433

*   桌面集成（如果我们获得在线桌面可能会改变）
*   离线使用（确实存在，但还处于早期阶段）
*   （可靠）响应性

可靠性一般（有点值得商榷，因为有利也有弊 - 例如，您的数据可能会更好地在线备份，但安全性通常不太受在线应用程序的控制，如果网络连接失败，在线应用程序往往会冻结或严重失败.)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-12-16T13:32:43.760

ComboBox 是最显着的小部件遗漏。

在网络上，缺少弹出对话框等桌面功能实际上是一个福音，可以提供更简单的交互体验。还要考虑一下 Gmail 的自动保存草稿功能与提示用户保存的桌面惯例。

因此，在尝试在您的 Web 应用程序中重建该桌面功能之前，请仔细考虑。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-02-23T08:04:46.060

体面的帮助。似乎总是事后才想到，如果它甚至被实施......

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-02-23T08:34:53.227

蓝屏死机

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-02-25T12:17:14.470

没有额外控件的特定于任务的 UI。一个网络应用程序，除了网络应用程序的所有控件外，还具有返回、下一步、书签等按钮。您最终会得到一组额外英寸高的按钮，这些按钮不能直接支持手头的任务。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-07-09T12:33:55.803

这不一定是编程功能，但应用程序的受众会有所不同。对于 Web 应用程序，您正在削减一部分受众（那些访问速度较慢或没有互联网访问的人）。虽然这是一个相对较低的数字，但它是桌面应用程序和 Web 应用程序之间的区别。

# accessibility - 对于盲人程序员来说，有哪些好的计算机科学资源？

> ID：370976
> 
> 赞同：36
> 
> 时间：2008-12-16T10:52:59.823
> 
> 标签：accessibility, computer-science, theory

我是一个完全失明的人，想了解更多计算机科学的理论方面。我有一个介绍数据结构类和一般介绍编程，但想了解更多关于软件设计、高级数据结构和编译器设计等内容。我想把它作为一门自学课程来做，而不是作为大学课程的一部分。

不幸的是，我通常从那里得到我的教科书的盲人和阅读障碍者录音中的计算机科学教科书并不多。我会很感激任何最好是免费的电子资源，它可以帮助我获得更多的计算机科学教育，而不是许多编程网站似乎关注的最新语言或平台。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-16T11:19:14.590

您可能会发现《[盲人计算机科学家的经历》是](http://www.cs.washington.edu/homes/ladner/hahnexperiences.html)一本不错的读物。

麻省理工学院的[开放课件](http://ocw.mit.edu/OcwWeb/web/home/home/index.htm)对您来说是一个很好的资源，因为他们拥有大量的视频/音频。

但实际上，对于核心计算机科学主题，我发现很难击败一些更好的教科书。有些购买时会提供他们书籍的数字版本，有些则不提供。对于那些不这样做的人，我只会购买这本书，然后通过种子网站下载一个数字电子书等价物。既然你已经拥有这本书，我认为这不是一个大问题。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-16T12:45:59.393

[加州大学伯克利分校](http://webcast.berkeley.edu/courses.php)有几门免费的计算机科学在线课程，格式为 mp3 和视频文件（包括每门课程的 RSS 提要）。如果阅读 PDF 文件不是问题，您可以查看 O'Reilly 的[Safari](http://safaribooksonline.com)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-20T18:36:40.503

[计算机程序的结构和解释的](http://groups.csail.mit.edu/mac/classes/6.001/abelson-sussman-lectures/)教科书似乎是可以访问的。软件工程广播是我收听的一个很好的播客，但最近主要关注模型驱动开发和我不感兴趣的 UML。加州[大学伯克利分校](http://webcast.berkeley.edu/courses.php) 的讲座质量参差不齐，就像所有其他大学课程一样，它取决于教授。我发现我可以很好地跟上 cs162 的课程，但跟 cs61b 的课程不太一样。部分原因是因为教授，部分原因可能是因为 61b 是一个数据结构类，因此数学更重。不幸的是，RSS 提要是无用的，因为文件名没有意义。我用我的 podcatcher 下载了整个系列讲座，然后使用了[foobar 2000的转换功能](http://www.foobar2000.org/)用那里的曲目号重命名文件，以便我可以按顺序收听它们。我以前在工作中使用过[Safari](http://safaribooksonline.com/)，尽管每年订阅它对我来说很昂贵。[开放课件](http://ocw.mit.edu/OcwWeb/web/home/home/index.htm)似乎有很多好东西。不幸的是，我不使用 iTunes，所以我没有单独下载每个 mp3 文件，而是使用了 firefox 扩展[DownThemAll！](https://addons.mozilla.org/en-US/firefox/addon/201)使用自定义过滤器从我想要的特定课程中一次获取所有 mp3 文件。另一个看起来很有用的系列书籍是 Bruno R. Preiss 的数据结构书籍，其中一些可以在 [http://www.brpreiss.com/books/opus5/](http://www.brpreiss.com/books/opus5/)上在线获得， 其中一些方程表示为图形，但我经常可以通过上下文说出总体思路是什么。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-16T11:12:57.113

我想知道Hal Abelson 和 Gerald Jay Sussman[的计算机程序视频讲座的结构和解释有什么用吗？](http://groups.csail.mit.edu/mac/classes/6.001/abelson-sussman-lectures/)

如果音频内容在没有视频的情况下就足够了，那么它们就是极好的数字资源。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-16T14:53:33.363

播客“软件工程广播”非常棒。虽然不是 CS 课件，但它是我发现的关于软件开发和计算机科学的最具学术性和智力刺激的播客。

[http://www.se-radio.net/](http://www.se-radio.net/)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-20T18:55:15.210

就我个人而言，我只是被提问者震惊了。我的意思是，对于大多数人来说，仅编程的挑战就太大了，但是没有在任务中使用的主要意义对我来说是惊人的。但具有讽刺意味的是，我敢打赌，面对这个挑战，提问者在大多数 CS 任务上仍然比我日常工作的人更擅长。只是说。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-17T18:22:40.790

我也是一个完全盲的程序员，目前在微软工作。最有价值的技术书籍资源是 Safari (safari.oreilly.com)。你可以在那里阅读成千上万的计算机科学文本。如果您在美国，您还可以从 BookShare (www.bookshare.org) 免费获得其中的许多图书。在这两种情况下，图形图像都是一个问题，但没有简单的解决方案。大多数好书都有足够的描述性文本，即使没有图表也能应付。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-11-28T01:07:05.877

我要成为一个新的盲人程序员！五年前我才失去视力。无论如何，在过去的一年中，我一直在使用 Visual Basic 2008 进行编程。事实证明，它比我最初怀疑的更容易获得。我下学期开始上 Java 课，要求的文本是免费的在线文本！它张贴在下面。Java 编程简介，第五版 [http://math.hws.edu/javanotes/](http://math.hws.edu/javanotes/)

你们中的一些经验丰富的盲人程序员可以与我们分享任何可以找到其他盲人程序员的博客或网站吗？

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-16T23:16:46.077

查看有关[播客](https://stackoverflow.com/questions/1644/what-good-technology-podcasts-are-out-there)的 Stack Overflow 问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-06-28T18:56:41.390

一种称为 Quorum 的语言很像 Python，但在语法细节上进行了优化，并且相应的开发环境是为盲人设计的。[https://quorumlanguage.com/](https://quorumlanguage.com/)这可能特别适合大多数学生使用 Python 的用例。

一篇关于 CSed 的[2016 年博客](https://computinged.wordpress.com/2016/08/15/supports-for-blind-cs-students-guest-blog-post-from-andreas-stefik/)（实际上是对博客文章的回应）指向

*   [在https://www.freelists.org/list/program-l](https://www.freelists.org/list/program-l)上面向盲人程序员的 program-l 讨论区
*   为盲人和其他对 Quorum 感兴趣的程序员举办的 EPIQ 会议 [https://quorumlanguage.com/epiq.html](https://quorumlanguage.com/epiq.html)

另外，在另一个 SO 网站上的类似问题中查看其他想法：[https ://cseductors.stackexchange.com/questions/3441/teaching-a-blind-high-school-student](https://cseducators.stackexchange.com/questions/3441/teaching-a-blind-high-school-student)

# java - 如何将数据请求与数据更新过程同步？

> ID：370978
> 
> 赞同：0
> 
> 时间：2008-12-16T10:54:03.953
> 
> 标签：java, synchronization

我有一个应用程序，它使用类似 cron 的作业来更新一组数据。更新过程每分钟发生一次，不会持续很长时间。servlet 将这个数据集公开给用户。我的问题是在更新过程中，servlet 请求应该阻塞并等待该过程完成。

归根结底，我有这两个功能：

```
private void updateData() {    
}

public List getData() {
} 
```

第一个函数每分钟运行一次。第二个可以同时调用任意多次。当 updateData 运行时，所有对 getData 的调用都必须等待它完成。一次 getData 调用不应阻止对同一函数的后续调用。updateData 函数的优先级高于getData，即updateData 运行时，必须等待所有getData 调用完成，但不允许开始新的调用。

对于这种情况，我应该使用什么同步机制？我正在使用 Java 服务器，但我很想知道其他平台也存在哪些解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-16T11:32:01.193

您可以使用[ReadWriteLock](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/locks/ReadWriteLock.html)而不是同步。

> ReadWriteLock 维护一对关联的锁，一个用于只读操作，一个用于写入。只要没有写者，读锁可能被多个读线程同时持有。写锁是独占的。

```
public void updateData() {
    lock.writeLock().lock();
    try {
        /* do stuff. */
    } finally {
       lock.writeLock().unlock();
    }
}

public List getData() {
    lock.readLock().lock();
    try {
       /* process/return data. */
    } finally {
       lock.readLock().unlock();
    } 
```

}

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-16T11:56:18.010

看看这篇文章：[Java 中的读/写锁](http://tutorials.jenkov.com/java-concurrency/read-write-locks.html)

我在这个例子中看到的唯一缺点是 notifyAll() 唤醒了所有等待的线程。但是，它确实优先写入锁定请求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T11:01:28.323

您需要同步对数据的访问。

```
public void updateData() {
    synchronized (updateLock) {
        /* do stuff. */
    }
}

public List getData() {
    List data;
    synchronized (updateLock) {
        data = getRealData();
    }
    /* process/return data. */
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-16T16:07:17.520

CopyOnWriteArrayList 或 CopyOnWriteArraySet 值得一看。在更新不频繁的情况下，我一直在大量使用它们。`***************