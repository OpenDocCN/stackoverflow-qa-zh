# StackOverflow 问答 11440000-11440999

# grails - Grails 找到域然后保存

> ID：11440011
> 
> 赞同：1
> 
> 时间：2012-07-11T19:29:25.983
> 
> 标签：grails, grails-domain-class

我想做的是找到一个域，然后创建一个新域或保存已有的域。这是我目前正在使用的代码（在这个项目中，skeleton 是包名）：

```
 def save() {
        Class lob = grailsApplication.getDomainClass('skeleton.'+params.lob.name)
        def instance = lob.get(params.lob.id)
        if (instance){
            params.data.each { name, value ->
                if (instance.metaClass.hasProperty(name)){
                    instance[name] = value
                }
            }
        }else{
            instance = new lob()
            params.data.each { name, value ->
                if (instance.metaClass.hasProperty(name)){
                    instance[name] = value
                }
            }
        }
    } 
```

这似乎不起作用。谁能帮我解决问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-11T19:36:06.087

返回的对象`getDomainClass`是 的一个实例[`GrailsDomainClass`](http://grails.org/doc/latest/api/org/codehaus/groovy/grails/commons/GrailsDomainClass.html)。要获取您可以调用的实际域类`get`，请先调用`getClazz`它。例如：

```
Class lob = grailsApplication.getDomainClass('skeleton.'+params.lob.name).clazz 
```

此外，您必须调用`newInstance`类对象而不是使用`new`关键字来创建新实例。

# ios - UISearchDisplayController 活动指示器

> ID：11440014
> 
> 赞同：0
> 
> 时间：2012-07-11T19:29:55.003
> 
> 标签：ios, uiactivityindicatorview, uisearchdisplaycontroller, uianimation

我正在使用 UISearchDisplayController 在表格视图中显示一些搜索结果。每次搜索栏的文本字段更改时，“正在加载...”旁边的活动指示器微调器都会重置其动画。也就是说，如果我在搜索栏中查询“a”，活动指示器就会开始旋转动画。然后，当我查询“aa”时，活动将其动画重置为开始旋转。当您快速输入长字符串时，这看起来有点刺耳，因为微调器旋转不顺畅；相反，它会一直重置到开头。有谁知道如何让微调器在表格视图从数据源加载结果时不断旋转？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T19:48:18.500

您是否在每次搜索字段更新时手动调用 [myActivityView startAnimating] ？如果是这样，您可以先检查 isAnimating ，这样您就不会（重新）启动动画：

```
if ( ! [myActivityView isAnimating]) {
    [myActivityView startAnimating];
} 
```

# java - 重构庞大的类时如何使用spring

> ID：11440017
> 
> 赞同：3
> 
> 时间：2012-07-11T19:30:02.917
> 
> 标签：java, spring, class-design

这是一个关于 java 类设计以及它如何与 spring 交互的一般性问题，但我将尝试使用一个示例使其更容易讨论。（请注意，此代码主要是伪代码，已排除大量绒毛）。

想象一下，我们遇到了一个很大且分解很差的类。它正在做很多事情，这使得重用、测试或理解变得更加困难。在我的示例中，我们有一个“BulkyThingDoer”类，它既可以做一件事，也可以跟踪关于它完成某件事的次数和花费的时间（发布到 JMX）的统计信息。并不可怕，但随着统计数据的增加，班级变得以簿记为主，而它所做的真正重要的事情却在噪音中消失了。如果我们有一个竞争的 DoerInterface 实现，我们将需要重现相同的统计工具等。

```
@Component
@ManagedResource
public class BulkyThingDoer implements DoerInterface, DoerStatistics{
  private int thingsDone = 0;
  private long timeSpentDoingThings = 0;

  public void doThing(){
    long start = System.currentTimeMillis();
    // do the important thing
    thingsDone ++;
    timeSpentDoingThings += System.currentTimeMillis() - start;
  }
  public int getThingsDone(){ return thingsDone;}
  public long getTimeSpentDoingThings (){ return timeSpentDoingThings;}
} 
```

现在让我们假设我们重构了这个类，将所有的统计簿记拆分为一个辅助对象，然后让实际的执行者（在可能的最高级别）报告发生了什么。现在 ThingDoer 和 DoerStatistics 对象都是简单的、可测试的、单一职责的对象。

```
@Component
public class ThingDoer implements DoerInterface {
  private final DoerStatistics stats;

  public ThingDoer(DoerStatistics stats){
    this.stats = stats;
  }

  public void doThing(){
    long start = System.currentTimeMillis() - start;
    // do the important thing
    stats.recordThatWeDidThing(System.currentTimeMillis() - start);
  }
}

@ManagedResource
public class DoerStatisticHolder implements DoerStatistics{
  private int thingsDone = 0;
  private long timeSpentDoingThings = 0;

  public void recordThatWeDidThing(long duration){
    thingsDone ++;
    timeSpentDoingThings += duration;
  }
  public int getThingsDone(){ return thingsDone;}
  public long getTimeSpentDoingThings (){ return timeSpentDoingThings;}
} 
```

对我来说，很明显这将是一个很好的重构，我认为这是将 DI 原则一直延伸到实现细节。

这都是这个问题的导火索：一旦我完成了这个重构，我的类就变得更难在 spring 上下文文件中使用了。以前我可以只使用一个定义并将同一个对象创建为一个我可以提供（或自动装配）给其他对象的 bean，我现在必须在我的上下文中定义多个部分并手动将它们全部连接在一起。这向用户展示了比必要的更多的实现细节。

一种替代方法是有效地重建“BulkyThingDoer”帮助器类，以用正确的部分构造我的对象：

```
public class DelegatedBulkyThingDoer extends DoerInterface{
  ThingDoer doer;

  public DelegatedBulkyThingDoer(){
    DoerStatistics stats = new DoerStatisticHolder();
    doer= new ThingDoer(stats );
  }

  public void doThing(){
    doer.doThing();
  }
} 
```

这解决了一些可用性问题，但现在我没有在 DoerStatisticHolder 或 ThingDoer 上获得任何弹簧魔法。在此示例中，这意味着 JMX 从未注册。如果有一种简单的方法可以通知 spring 这些子对象正在创建，这可能会解决我的问题。

我当然可以委托我们在原始 Bulky 实现中的所有调用，并删除两个实现类中的所有注释，但这对我来说听起来非常不雅。我会有效地再次重建 BulyClass，这特别烦人，因为它只对 JMX 或日志记录等横切关注点才有必要。

我会争辩说，导致最初的实现如此庞大和复杂的痛苦。由于这样的困难，Spring 似乎诱使开发人员停止在实现级别应用严格的 OOP 原则。在我深入研究过的弹性代码库中，这种模式一遍又一遍地出现，这些类最终在单个类中实现以支持“高级”spring-context 使用（单个 bean def），而不是进一步分解，因为我们发生这种情况时会失去春天的魔力。

我是 spring 和 java 的相对新手（过去几年一直在 c++、scala 和 ruby​​ 中）所以我可能缺少一些东西。java/spring 开发人员如何处理 spring 可用性和充分考虑的实现之间的这种“阻抗不匹配”？他们是硬着头皮创建 DelegatingBulkyClass，强迫用户构建我重构的 impl 类，还是仅仅坚持使用 BulkyClass 模式，因为它最简单？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T20:34:45.083

像 BulkyThingDoer 一样，您可以使用 DoerStatisticHolder 进行注释，`@Component`这样它将由 spring 管理，然后您可以将其自动连接`@Autowire`到 ThingDoer。一个缺点是您还需要一个非参数构造函数。

如果你总是需要一个对象的新实例，你可以用`@Scope("prototype")`.

使用基于注释的配置方法来自动装配只有一个实际实现的类可以节省很多 xml 配置开销。

# javascript - 从 JavaScript 构建 HTML 的最快方法是什么？

> ID：11440020
> 
> 赞同：2
> 
> 时间：2012-07-11T19:30:09.633
> 
> 标签：javascript, jquery

我正在一个使用无限滚动的网站上工作。有一个被调用的函数`is_element_in_view()`会在这 3 个事件上执行：

```
scroll
load
resize 
```

该函数完全按照它的名称执行，它检查具有加载 gif 图像的元素是否在视图中，如果是，它会触发 ajax 请求以从服务器获取内容。

服务器发回一个 json 对象，如下所示：

```
 [{
        "url": "\/embed\/182926\/some-slug",
        "thumb": "http:\/\/cdn.site.com\/91\/26\/a62c1ad74327321dab78bb194c130da5.jpg",
        "type": "video",
        "is_original": false,
        "is_prank_news": false,
        "title": "Hello World",
        "description": "\t<p>Enjoy this video!<\/p>",
        "teaser": "Click Me!",
        "finder": "Found by <strong>Jim<\/strong> yesterday",
        "likes": "2 likes",
        "ad_img": null,
        "media_stats": "<div class=\"media-status\">2000 views<\/div>"
    },
    more objects...] 
```

为清楚起见，此响应中只有一个对象，但实际上我回到了 20。这就是我从 json 数据构建 html 的方式：

```
$.ajax({
    url: '/some/ajax/url',
    type: 'get',
    data: 'somedata',
    dataType: 'json',
    success: function(response) {

        if(!$.isEmptyObject(response)) {

            for(var i = 0; i < response.length; i++) {

                if(response[i]) {
                    var item = response[i];
                    var title = item.title.replace(/\\"/g, '"');

                    var media_label = '';                   
                    var item_description_teaser = '';
                    var likes = '';
                    var ad_image = '';
                    var media_stats = '';

                    if(item.description) {

                        // description
                        item_description_teaser = '<div class="description">' + item.description.replace(/\\"/g, '"');

                        // teaser
                        item_description_teaser += (item.teaser) ? '<a href="'+ item.url +'" class="teaser">'+ item.teaser.replace(/\\"/g, '"') +'<img src="images/teaser-arrow.png" alt="" /></a></div>' : '</div>';
                    }

                    // media label
                    if(item.type == 'article' && item.is_prank_news || item.is_original && item.is_prank_news) {
                        media_label = '<span class="media-label prank-news-network">Prank</span>';
                    }
                    else {
                        if(item.type == 'article') {
                            media_label = '<span class="media-label article">Article</span>';
                        }
                        else if(item.is_original) {
                            media_label = '<span class="media-label original">Original</span>';
                        }
                    }

                    // likes
                    if(!settings.hide_likes) {
                        likes = '<span class="likes">' + item.likes + '</span> | ';
                    }

                    // ad image
                    if(item.ad_img) {
                        ad_image = '<img src="'+ item.ad_img +'" alt="" class="ad-img" />';
                    }

                    block += '<article class="block">' +
                                '<div class="inner-left">' +
                                    media_label +
                                    '<a href="'+ item.url +'" title="" class="thumb">' +
                                        '<img src="'+ item.thumb +'" alt="" width="198" height="111" />' +
                                    '</a>' +
                                '</div>' +
                                '<div class="inner-right">' +
                                    '<a href="'+ item.url +'" title="" class="title">' +
                                        title +
                                    '</a>' +
                                    item_description_teaser.replace(/\\"/g, '"') +
                                    '<div class="media-stats">' +
                                        likes +
                                        '<span class="finder">'+ item.finder.replace(/\\"/g, '"') +'</span>' +
                                    '</div>' +
                                    ad_image +
                                '</div>' +
                                item.media_stats +
                            '</article>';

                }
            }

            $('#content').append('<div class="page page-'+ page_num +'">' + block + '</div>');

            // update page count
            page_num++;

            // clear previous listings
            block = '';
        }
        else {
            $('#content').append('<div class="page page-1"><p class="nothing-to-show">Nothing found...</p></div>');
        }
    },
    error: function() {
        alert('error');
    }
}); 
```

如您所见，我将所有内容都放在一个存储在变量中的巨大字符串中`block`。我在每个循环中都将数据附加到该字符串，并在最后将其附加到循环外的页面。

我觉得有一种更快的方法可以从 js 构建 html。不久前，我在某处读到，像我正在做的那样构建巨型字符串并不像我忘记的文章描述的其他方法那样有效。那么更快的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T19:33:55.213

将块存储在一个数组中`blocks`，然后

```
$('#content').append(blocks.join("")); 
```

**编辑**：那不是 OP 想要的。我想问题是每次触发事件时都附加这些东西。

我会说创建一个`DocumentFragment`，将新内容放入其中，然后附加到`$("#content")`. 不幸的是，`DocumentFragment`s 不支持`innerHTML`.

因此，创建一个虚拟元素，填充它，然后将其子节点放入容器中：

```
var dummy = $("<div>").html(block), content = $("#content");
$.each(dummy.children(), function(i, c) {content.append(c);}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T19:46:11.117

您可以让您的服务器返回已经在 HTML 中标记的值，然后：

```
$('#content').append( response ); 
```

然后，您可以处理所有循环和过滤服务器端，减少文档中的 JS 数量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T19:51:51.940

将 html 元素添加到 DOM 会带来很大的性能损失，因此最好创建一个大字符串并将其附加到最后，这篇[文章](http://www.learningjquery.com/2009/03/43439-reasons-to-use-append-correctly)很好地解释了它

> 对于您的大多数用途，创建一个非常长的字符串并将其附加到末尾的方法将是最佳选择，因为它充分利用了代码易读性、易于编程和速度的权衡。

# php - PHP 终端和浏览器的区别

> ID：11440027
> 
> 赞同：0
> 
> 时间：2012-07-11T19:30:30.500
> 
> 标签：php, pear, neo4j, phar

我的 Ubuntu 上安装了 Neo4J，我正在运行测试代码。当代码在终端上运行时，它可以完美运行，例如：

```
root@ekin-Inspiron-1090:/var/www# php neo.php
home: demolished
name: Arthur Dent 
```

但是当它在像 localhost/neo.php 这样的浏览器上运行时，它会给出致命错误并停止工作。

```
Warning: require(phar://neo4jphp.phar): failed to open stream: operation failed in /var/www/neo.php on line 4 Fatal error: require(): Failed opening required 'phar://neo4jphp.phar' (include_path='.:/usr/share/php:/usr/share/pear') in /var/www/neo.php on line 4 
```

我不认为这与 Neo4J 或其 PHP 驱动程序有关。应该是什么原因？

编辑：顺便说一下，有两个 php.ini 文件；我认为一个用于 apache，一个用于命令行。我检查了它们，并且 phar 扩展路径是相同的。它们也没有 include_path 设置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-03T14:24:55.010

这是一个授权错误。Apache 在它自己的用户下运行，所以你需要让 apache 用户访问`www`文件夹。

# javascript - 如何返回不在 Javascript 地图中的元素数组？

> ID：11440028
> 
> 赞同：0
> 
> 时间：2012-07-11T19:30:31.223
> 
> 标签：javascript, jquery

我有一个 Javascript 对象：

```
var errorMap = {
    100: 'You must enter a name.',
    200: 'You must enter an address.',
    300: 'You must enter a DOB.'
} 
```

在我的代码的另一部分，我收到了一组错误代码：

```
var errorCodes = [100, 200, 500, 600]; 
```

我想做的是将**数组**`errorCodes`与`errorMap`对象的键进行比较，并返回所有在. 在这种情况下，我想取回这个：**`errorMap`**

 **```
[500, 600] 
```

我该怎么做呢？我可以访问 jQuery。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-11T19:33:41.417

现代浏览器的 Javascript（在带有[shim](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/filter#Compatibility)的旧浏览器中工作）

```
var missing = [100, 200, 500, 600].filter(function(v){
    return !errorMap.hasOwnProperty(v)
});

//missing = [500, 600] 
```

如果需要旧版浏览器支持并且不接受 shim，则使用 jQuery：

```
var missing = $.grep( [100, 200, 500, 600], function(v){
    return !errorMap.hasOwnProperty(v)
});

//missing = [500, 600] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T19:32:26.957

jQuery 并不是必需的，一个简单的`for`循环也可以完成这项工作：

```
var missing = [];
for(var i = 0; i < errorCodes.length; i++) {
    var code = errorCodes[i];
    if(errorMap[code] === undefined) {
        missing.push(code)
    }
}); 
```

使用 jQuery：

```
var missing = [];
$.each(errorCodes, function(i, code) {
    if(errorMap[code] === undefined) {
        missing.push(code)
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T19:32:40.130

```
var notRealError = [];
for(var i = 0; i < errorCodes.length; ++i){
    if(!errorMap[errorCodes[i]])  notRealError.push(errorCodes[i]);
} 
```

`notRealError`是一个数组，其中包含地图中没有的错误代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T19:33:19.023

这个不需要jQuery。尝试这个：

```
var result = [];
var l = errorCodes.length;
for (var i = 0; i < l; i++)
    if (!errorMap.hasOwnProperty(errorCode[i]))
        result.push(errorCode[i]); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-11T19:34:16.687

```
var returnCodes = [];

for (c in errorCodes) {
    if (errorMap[errorCodes[c]] == undefined) {
        returnCodes.push(errorCodes[c]);
    }
}

return returnCodes; 
```**

# php - CakePHP 并将变量从控制器发送到视图

> ID：11440029
> 
> 赞同：2
> 
> 时间：2012-07-11T19:30:58.760
> 
> 标签：php, sql, forms, cakephp

我的视图控制器关系有这个问题。这是控制器：

```
<?php
class AnswersController extends AppController {
    public $helpers = array('Html', 'Form', 'Session');
    public $components = array('Session');

    public function add() {

        $customer_id = $this->params['url']['customer_id'];
        $question_set_id = $this->params['url']['question_set_id'];
        $order_value = $this->params['url']['order_value'];

        $possible_answer_model = ClassRegistry::init('PossibleAnswer');
        $question_model = ClassRegistry::init('Question');
        $order_model = ClassRegistry::init('Order');

        $order = $order_model -> find('first', array(
        'Order.question_set_id' => $question_set_id,
        'Order.value' => $order_value));

        $question = $question_model -> find('first', array(
        'Question.id' => $order['Order']['question_id']));

        $this -> set('question', $question);

        if ($question['Question']['kind'] != "o") {
            $this -> set('possible_answers', $possible_answer_model -> find('all', array(
            'PossibleAnswer.question_id' => $question['Question']['id'])));
        }

        $this->Session->setFlash($question['Question']['content']);
    }
} 
```

它得到了正确的问题和可能的答案（我可以看到查询输出），但视图总是显示相同的问题（无论我将传递给操作的 question_set_id 和 order_value 是什么）和所有可能的答案（不仅仅是这些实际上是与问题相关，即使这个问题总是会出现）。由于查询输出是正确的，我猜在将数据传递给视图时需要有一些问题。无论如何，视图如下所示：

```
<!-- File: /app/View/Answers/add.ctp -->

<?php
if ($question['Question']['kind'] == 'o') {
    echo $this->Form->create('PossibleAnswer');
    echo $this->Form->input('content', array(
    'rows' => '3', 'label' => 'Miejsce na twoją odpowiedź:'));
    echo $this->Form->input('PossibleAnswer', array(
    'question_id' => $question['Question']['id']));
    echo $this->Form->end('Dalej');
}
else {
    echo $this->Form->create('Answer');
    foreach ($possible_answers as $possible_answer) {
        echo '<input name="'
        .'possible_answers'
        .'" id="'
        .$possible_answer['PossibleAnswer']['id']
        .'" value="'
        .$possible_answer['PossibleAnswer']['id']
        .'" type="radio">';
        echo '<label for="'
        .$possible_answer['PossibleAnswer']['id']
        .'">'
        .$possible_answer['PossibleAnswer']['content']
        .'</label><br />';
    }
    echo $this->Form->end('Dalej');
}
?> 
```

查询输出是这样的：

> 1 选择`Order`。`id`, `Order`. `question_id`, `Order`. `question_set_id`, `Order`. `value`, `Question`. `id`, `Question`. `content`, `Question`. `company_id`, `Question`. `kind`, `QuestionSet`. `id`, `QuestionSet`. `name`, `QuestionSet`. `company_id`从`mentor11`。`orders`如左`Order`加入`mentor11`。`questions`AS `Question`ON ( `Order`. `question_id`= `Question`. `id`) 左连接`mentor11`。`question_sets`AS `QuestionSet`ON ( `Order`. `question_set_id`= `QuestionSet`. `id`) WHERE 1 = 1 LIMIT 1
> 
> （受影响 1，第 1 行，占用 25）
> 
> 2 选择`Question`。`id`, `Question`. `content`, `Question`. `company_id`, `Question`. `kind`, `Company`. `id`, `Company`. `trader_id`, `Company`. `name`从`mentor11`。`questions`如左`Question`加入`mentor11`。`companies`AS `Company`ON ( `Question`. `company_id`= `Company`. `id`) WHERE 1 = 1 LIMIT 1
> 
> （受影响 1，第 1 行，占用 49）
> 
> 3 选择`Order`。`id`, `Order`. `question_id`, `Order`. `question_set_id`, `Order`. `value`从`mentor11`。在`orders`哪里。= (1)`Order``Order``question_id`
> 
> （受影响 1，第 1 行，占用 28 行）
> 
> 4 选择`PossibleAnswer`。`id`, `PossibleAnswer`. `content`, `PossibleAnswer`. `question_id`从`mentor11`。在`possible_answers`哪里。= (1)`PossibleAnswer``PossibleAnswer``question_id`
> 
> （受影响 2，第 2 行，占用 35）
> 
> 5 选择`PossibleAnswer`。`id`, `PossibleAnswer`. `content`, `PossibleAnswer`. `question_id`从`mentor11`。`possible_answers`1 `PossibleAnswer`= 1
> 
> （影响 5 行，第 5 行，占用 23 行）

如您所见，第 4 个查询返回两个可能的答案，但视图包含其中五个（现在是全部）： ![看法](../Images/cc22680366bc3ade7597044b3171bd42.png)

起初我怀疑第 5 个查询（返回所有可能的答案）以某种方式“删除”了第 4 个查询；我仍然不知道第 5 个查询是如何被调用的（我不需要它，而且我看不到任何需要这样查询的代码）但我将“我的”$possible_answers 更改为 $possible_answerz 只是为了使它不同 - 它没有工作，但即使它做了：它不会解释为什么 $question 总是相同的......

有小费吗？

编辑：当我闪烁这些值时 - 它们是正确的......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:01:23.060

尝试这个：

```
$order = $order_model -> find('first', array(
    'conditions' => array(
        'Order.question_set_id' => $question_set_id,
        'Order.value' => $order_value)
    )
); 
```

然后将“条件”键添加到其他数组

# css - 如何在 CSS 精灵和元素的背景中指定位置

> ID：11440041
> 
> 赞同：0
> 
> 时间：2012-07-11T19:31:54.627
> 
> 标签：css, css-sprites

我想在 div 元素的右上角显示位于 X 和 Y 的精灵图像的一部分。我应该怎么做？例如，如果我使用`background: url("the path") no-repeat 0 0`它将在 div 元素的右上角显示整个精灵图像。所以实际上我需要指定两个坐标，一个在精灵图像中，另一个在 div 元素中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T19:35:30.657

您必须将精灵包装在另一个容器中，并为其指定高度和宽度，该宽度是您想要查看的精灵部分的宽度，然后将精灵放置在其中。

像这样：http: [//jsfiddle.net/Qa8Tp/](http://jsfiddle.net/Qa8Tp/)

# xpages - 如何为显示字母而不是数字的视图创建寻呼机？

> ID：11440042
> 
> 赞同：1
> 
> 时间：2012-07-11T19:31:55.980
> 
> 标签：xpages

我需要一个按字母顺序排列的寻呼机来查看。我没有看到任何解决此问题的示例或自定义寻呼机。我认为这将是一件很常见的事情。

乔丹

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-11T23:16:18.637

我不太确定“字母寻呼机”的真正含义，但我认为您可能正在寻找某种字母导航器，就像我们在 Notes 客户端内的个人 NAB 中所拥有的那样，对吧？

如果是这样，您并不是真的在寻找寻呼机，而是在寻找按字母顺序排列的视图过滤器。这是到达那里的一种方法：

*   创建一个面板，给它一个独特的 ID，比如“viewContainer”之类的。将您的视图面板放入面板中；当然视图的主要排序顺序必须是字母顺序
*   在“viewContainer”上方创建第二个面板，此处不需要 ID
*   在这个新面板中添加一个重复并将其绑定到一个新的 JavaScript 数组，如下所示：

    新数组（“a”，“b”，“c”，...，“x”，“y”，“z”）；

*   输入重复的集合名称，例如“字母”

*   在重复中放置一个链接控件。链接的标签将被计算为重复的集合名称，即“字母”。
*   将 onclick 事件分配给将 sessionScope 变量设置为当前集合名称值的链接，如下所示：

    sessionScope.filter = 字母；

*   将事件的刷新模式设置为部分，以便刷新您的 viewContainer 面板

*   在 viewContainer 中突出显示您的视图控件。在其数据属性中查找标记为“按列值过滤”的属性字段并进行计算。输入此代码：

    sessionScope.filter;

就是这样。

**编辑：** 当然，您可以从视图本身动态构建重复的数据源数组。因此，除了构建静态 a-to-z 数组之外，您还可以使用以下内容：

```
@Unique(@Left(@DbColumn(@DbName(), "yourLookupView", viewColNumber), 1)); 
```

那应该返回一个数组，只包含那些真正在你视图中的字母。

您也可以在重复重置过滤器之外使用另一个静态链接控件以显示所有条目。它将像调用此代码的 onclick 事件的重复链接一样构建：

```
sessionScope.filter=null; 
```

享受！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T22:47:34.077

我会这样做：制作一个按公式分类的视图`@Left( value; 1)`。然后通过重复或某些 ExtLib 组件（链接列表、导航器、菜单）将 @DbColumn 的结果呈现为寻呼机。每个链接要么将显示的视图限制为“单个类别”，要么跳转到“开始于”字符。

# ruby-on-rails - ActiveAdmin 中的多租户、多管理员用户

> ID：11440048
> 
> 赞同：7
> 
> 时间：2012-07-11T19:32:20.957
> 
> 标签：ruby-on-rails, devise, activeadmin, multi-tenant

我正在构建一个以 ActiveAdmin 作为主管理界面的多租户应用程序。我已经使用acts_as_tenant gem 很好地完成了数据分离。

我使用 AdminUser 模型作为所有用户的用户模型对象。

为了添加其他用户，AdminUser 也被限定为租户。

这是放弃登录，因为当 ActiveAdmin/Devise 尝试进行身份验证时，我假设它首先点击 find_tenant 过滤器，如下所示：

```
class ApplicationController
  set_current_tenant_through_filter

  before_filter :find_tenant

  def find_tenant
     if admin_user_signed_in?
      set_current_tenant(Company.find(current_admin_user.company_id))
     end
  end 
```

不知道如何解决这个问题......我希望用户登录，然后应用程序从登录用户那里获取 company_id 并设置租户，ActiveAdmin 上显示的所有数据都通过该租户进行范围（这部分通过如果我可以通过登录，acts_as_tenant gem）。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T05:14:03.747

我认为您的怀疑是正确的，并且在身份验证之前调用了 find_tenant 方法，导致 admin_user_signed_in？是假的。如果确实如此（来自[http://guides.rubyonrails.org/action_controller_overview.html#after-filters-and-around-filters](http://guides.rubyonrails.org/action_controller_overview.html#after-filters-and-around-filters)），则将其调整为使用后过滤器应该可以解决问题。

```
class ApplicationController
  set_current_tenant_through_filter

  after_filter :find_tenant

  def find_tenant
    if admin_user_signed_in?
      set_current_tenant(Company.find(current_admin_user.company_id))
    end
  end 
```

不确定 set_current_tenant_through_filter 如何在所有这些中起作用，您是否尝试以两种不同的方式做同样的事情？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-10-07T19:27:37.873

8 岁的帖子，但很远……我的设置`routes.rb`是这样的：

```
 devise_for :admin_users, ActiveAdmin::Devise.config
  require 'sidekiq/web'
  Sidekiq::Web.set :sessions, false
  authenticate :admin_user do
    mount Sidekiq::Web => '/admin/sidekiq'
  end 
```

在我的情况下，我的非管理员用户有`company_id`，我认为你想要这个：

```
 def find_tenant
    if user_signed_in?
      set_current_tenant(Company.find(current_admin_user.company_id))
    end
  end 
```

在 AA 空间中，我这样做了：

[在活动管理控制器中设置多租户（Searchkick 索引需要）](https://stackoverflow.com/questions/63697727/set-multi-tenant-in-active-admin-controllers-required-for-searchkick-index/64250871#64250871)

我只在更新 AA 中的记录时设置租户。我这样做只是因为 Searchkick 索引要求。在您的情况下，您可能只需要允许 company_id 参数。

# javascript - 更改鼠标键码 - jquery

> ID：11440052
> 
> 赞同：2
> 
> 时间：2012-07-11T19:32:32.157
> 
> 标签：javascript, jquery, events, keycode, mousedown

正如我所听说的，不同的浏览器会在`mousedown`事件发生时为鼠标按钮分配不同的键码值。我已经在 Chrome中尝试过[这个并且它有效：](http://jsfiddle.net/menislici/5vsLR/2/)

```
$('a').mousedown(function(f) {
    if (f.which == 2) {
        alert("You clicked the wheel")
    }
})​ 
```

但是，我担心某些浏览器将无法识别鼠标滚轮的键码为 2，并将其与其他鼠标按钮混淆，从而导致代码崩溃。我的问题是是否有任何方法可以重置这些值，以便我可以使用我提供的新值，以便所有浏览器都知道这些数字究竟代表什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T19:59:41.200

根据 W3C，它的值应该是：

*   左键 - 0
*   中间按钮 - 1
*   右键 – 2

根据微软的说法，它的价值观应该是：

*   左键 – 1
*   中间按钮 - 4
*   右键 – 2

但是你不必考虑它（跨浏览器问题），让它打开`jQuery`，在每个浏览器中`which`都会返回相同的结果

```
$('a').mousedown(function(e) {
    if( (e.which == 1) ) {
        alert("left button");
    }if( (e.which == 3) ) {
        alert("right button");
    }else if( (e.which == 2) ) {
        alert("middle button"); 
    }
})​; 
```

[**演示。**](http://jsfiddle.net/5vsLR/3/)（在 IE、Chrome 和 FF 中测试）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T19:44:34.627

使用 jQuery，`2`将代表鼠标滚轮或«中键单击按钮»。您不能更改这些值，但也不必更改，因为如果您得到的不是`2`on `f.which`，则很可能不是鼠标滚轮被击落。

有[两种鼠标事件模型，一种来自 W3C，一种来自 Microsoft](http://www.quirksmode.org/js/events_properties.html#button)。~~浏览器（也包括 IE7 和 IE8）实现[W3C 标准](http://www.w3.org/TR/2000/REC-DOM-Level-2-Events-20001113/events.html#Events-eventgroupings-mouseevents)。~~

**更新**

在 Javascript 中，由于两种不同的标准，鼠标事件按钮没有被规范化。实际上，jQuery 规范了鼠标事件上的 which：

```
// Add which for click: 1 === left; 2 === middle; 3 === right
// Note: button is not normalized, so don't use it
if ( !event.which && button !== undefined ) {
  event.which = ( button & 1 ? 1 : ( button & 2 ? 3 : ( button & 4 ? 2 : 0 ) ) );
} 
```

# css - 基于像素的响应式网页设计

> ID：11440054
> 
> 赞同：1
> 
> 时间：2012-07-11T19:32:36.450
> 
> 标签：css, responsive-design

大多数响应式设计使用流畅的布局，但是：

1.  是否可以将基于像素/固定的布局用于响应式设计（显然断点会更加明显）

2.  有没有基于像素的响应式设计的例子？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T19:36:54.303

通过使用`CSS Media Queries`.

来源：[http ://css-tricks.com/css-media-queries/](http://css-tricks.com/css-media-queries/)

演示：[http ://css-tricks.com/examples/MediaQueriesSidebar/](http://css-tricks.com/examples/MediaQueriesSidebar/)

调整浏览器大小并查看页面如何适应不同的窗口大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T20:54:58.437

我认为这将非常困难，并且会根据不同的视口大小使用 px 编写很多代码。我认为如果您没有很多视口需要支持，例如只有移动尺寸和 1024 像素桌面尺寸需要支持，这是可以实现的。

但是，如果您的设计布局可以通过“网格”完成，您可以使用[Heroku Fluid Layouts](http://grids.heroku.com/)

对桌面视图使用普通 px 之一，然后使用媒体查询以 % 网格中的流体覆盖。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-05T01:51:36.437

To answer your first question, the typical take is that responsive design without fluid grids is actually adaptive design, as adaptive design is a super set of responsive design. Can you have responsive design without fluid grids? Strictly speaking, probably not. [More explanation](http://viljamis.com/blog/2012/adaptive-vs-responsive-whats-the-difference.php).

But if you want your website to look good on multiple screen sizes using pixel values, you certainly can use adaptive design. It isn't as robust and won't work on as many devices, but depending on the project that isn't always necessary. If you are looking for a framework to get you started, you might want to check out [Skeleton.js](http://www.getskeleton.com/). I've used it before at work when we want to get something quick and simple up like this [iOS app promo page](http://www.npr.org/services/mobile/pm/index.html).

Hope that helps.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T15:00:21.953

没有什么可添加的，因为其他答案涵盖了您的问题，但是，如果您选择使用像素进行媒体查询，断点将很明显，但您始终可以为它们设置动画以对调整大小产生很好的效果，例如

```
.container {
    -webkit-transition: all 0.5s ease-in-out;
    -moz-transition: all 0.5s ease-in-out;
    -o-transition: all 0.5s ease-in-out;
    -ms-transition: all 0.5s ease-out;
    transition: all 0.5s ease-in-out;

}

@media screen and (min-width: 320px) {
    .container {width:320px; background:red;}
}

@media screen and (min-width: 480px) {
    .container {width:480px; background:green;}
} 
```

# jakarta-ee - UserTransaction.getStatus() always returns '6'

> ID：11440060
> 
> 赞同：3
> 
> 时间：2012-07-11T19:32:50.147
> 
> 标签：jakarta-ee, transactions, websphere

UserTransaction.getStatus() method is always returning the value '6', even immediately after performing rollback or commit. Cannot understand why the status is not changing. Can someone point out whats wrong here? I am using WAS 6.1.

```
InitialContext context = new InitialContext();
UserTransaction utx = (UserTransaction)context.lookup("java:comp/UserTransaction");
System.out.println("Transaction status = "+utx.getStatus());  //value is 6

utx.begin()
//all work done here

if(all good) {utx.commit()}
else {
utx.rollback();
System.out.println("Transaction status = "+utx.getStatus());  //value is 6
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-12T19:45:06.787

Andreas already has the answer. I'd just like to add some detail for people like me, who may think STATUS_NO_TRANSACTION is not an intuitive state for a completed transaction, since we also have a STATUS_COMMITTED in the list.

Here are all the states that a transaction can possess [as listed in EE6 javadoc](http://docs.oracle.com/javaee/6/api/index.html?javax/transaction/UserTransaction.html);

```
STATUS_ACTIVE               0
STATUS_COMMITTED            3
STATUS_COMMITTING           8
STATUS_MARKED_ROLLBACK      1
STATUS_NO_TRANSACTION       6
STATUS_PREPARED             2
STATUS_PREPARING            7
STATUS_ROLLEDBACK           4
STATUS_ROLLING_BACK         9
STATUS_UNKNOWN              5 
```

On the javadocs, it clearly states that we'll get an STATUS_NO_TRANSACTION after the transaction completes (commit or rollback)

```
static final int STATUS_NO_TRANSACTION
    No transaction is currently associated with the target object. 
    This will occur after a transaction has completed. 
```

So when do we have STATUS_ROLLEDBACK and STATUS_COMMITTED? Javadocs, similar for these two states, reveal that these corresponds to somehow problematic states, if there were no problems you'd get a STATUS_NO_TRANSACTION instead;

```
static final int STATUS_COMMITTED
    A transaction is associated with the target object and it has been committed. 
    It is likely that heuristics exist; otherwise, the transaction 
    would have been destroyed and NoTransaction returned. 
```

Heuristics?

Here is the definition;

> A heuristic completion (or heuristic decision) occurs when a resource makes a unilateral decision during the completion stage of a distributed transaction to commit or rollback updates. This can leave distributed data in an indeterminate state. Network failures or resource timeouts are possible causes for heuristic completion.

That means, simply stated, something went wrong with your XA transaction, possibly due to a transient condition like network, timeouts etc.

Fair enough.

Also, it may worth noting that, how WebSphere deals with these heuristic completions can be configured via heuristic-related properties outlined at [Configuring transaction properties for an application server](http://pic.dhe.ibm.com/infocenter/wasinfo/v7r0/index.jsp?topic=/com.ibm.websphere.express.doc/info/exp/ae/tjta_settlog.html)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-12T15:18:52.780

The value 6 means `STATUS_NO_TRANSACTION`. It is normal that you get this result before the start of the transaction and after the commit or rollback.

# wcf - 从 VB6 脚本使用 WCF 服务时出错

> ID：11440061
> 
> 赞同：1
> 
> 时间：2012-07-11T19:32:51.273
> 
> 标签：wcf, iis, vb6

我得到了一个用 C# 编写的简单 WCF 服务。我需要使用 MS SOAP Toolkit 3.0 从 VB 脚本中使用该服务。我写了一个这样的简单客户端代码：

```
 Dim client
   Set client = CreateObject("MSSOAP.SoapClient30")
   client.MSSoapInit "http://localhost:8888/MyService.svc?wsdl" 
```

我在 IIS 7.5 (Windows 7) 上托管我的服务。.MSSoapInit 调用期间出现错误：

> HRESULT=0x1：结果 0x1 功能不正确。- WSDLReader：在 wsdl 文件的“默认”命名空间中找不到“/definitions/service” HRESULT=0x80070057：参数不正确。WSDLReader：分析WSDL文件失败HRESULT=0x80070057：参数不正确。客户：提供的参数之一无效。HRESULT=0x80070057：参数不正确。

如果我从 Visual Studio（ASP.NET 开发服务器）运行项目，我没有任何问题，我可以从我的客户端代码中使用服务。两种情况下生成的 wsdl-schemas 相同（端口号除外）

这种行为的原因可能是什么？

# macos - Automator：如何使用从列表中选择操作？

> ID：11440062
> 
> 赞同：10
> 
> 时间：2012-07-11T19:32:53.190
> 
> 标签：macos, automator

我正在尝试使用仅调用 textutil convert 的 Automator 创建一个服务。最终，我希望能够右键单击 docx 文件并转换为文本、rtf、html 等。右键单击后，我想要一个非常简单的弹出窗口，询问所需的格式。

我看到从列表中选择操作。它没有选项。在某个地方，我想到了将“从列表中选择”的输入设为“获取指定文本”。然后我尝试将我的值列表放入获取指定文本中。但是，当我运行它时，我只得到一条线。我试过每行一个项目，逗号分隔，空格分隔，甚至用花括号括起来，用逗号分隔。没有任何效果。

如何让选择器对话框显示我的所有选项？另外，有没有办法将选择限制为一个项目？

谢谢！

![自动机截图](../Images/6e75f9ff143a14cbc1edfd2e4d24ce67.png) ![结果](../Images/cb5b42288a95b8373df753cbdc529299.png)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-12T00:37:25.040

这是在列表中仅选择**一行**的解决方案。

删除（“**获取指定文本**”和“**从列表中选择**”）操作。

添加“**运行 AppleScript 脚本**”操作。1-剪切动作中的文本。2- 在操作中复制/粘贴此文本。

```
on run
    choose from list {"TXT", "RTF", "RTFD", "HTML"} with prompt "Please make your selection" without multiple selections allowed and empty selection allowed
    return the result as string
end run 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-12-23T22:26:48.243

## 诀窍是使用 AppleScript 变量！

其他建议的答案有效，但最简单和最直接的方法是使用 AppleScript 变量来定义列表选项。

text 变量只能存储一项纯文本，但 AppleScript 变量可以构造为数组，这正是定义列表所需的。

[![在此处输入图像描述](../Images/1d984764fd2c0c2af6025ae29cc5f57d.png)](https://i.stack.imgur.com/4ZjyN.png)

1.  在**变量**库中的**Utilities**下，将 **AppleScript**变量拖到工作流程中的从列表中选择操作上方。

2.  编辑变量选项并将其脚本定义为文本字符串数组，其中包含所需的选项列表。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-11-30T12:39:28.913

1.  删除“**获取指定文本**”操作。

2.  **在“从列表中选择**”操作上方添加“**运行 AppleScript** ”操作。

***   在“**运行 AppleScript** ”操作中，剪切文本并复制/粘贴该文本。

    ```
    on run {}   
       set theList to {"TXT", "RTF", "RTFD", "HTML"}
       return theList 
    end 
    ```** 

 *** * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T21:06:33.593

您需要将文本分解为项目列表，这是**从列表中选择**期望作为输入的内容。您可以使用**Filter Paragraphs**操作来分解文本，例如*返回非空的段落*。

您没有提及您正在运行的操作系统，但 Lion 在文本操作中添加了使用富文本的能力 - 不幸的是，如果大多数操作实际上获得富文本，则它们不会按预期工作。**在 Lion 中，您可以通过使用诸如Run Shell Script**操作之类的东西来利用一些（隐藏的）输入项强制（您不需要在其中放置任何额外的东西，只需使用默认值，它会传递项目）到从**获取指定文本**操作转换富文本。

“**从列表中选择”**操作具有“*全部”*或“*无*”按钮，但无法选择指定的项目集。编写 Automator 操作相当容易，因此滚动您自己的 textutil 包装器将是另一种选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-07T00:40:36.547

还有两个 Automator Actions 也可以解决这个问题。

一种是***拆分文本***，它允许您选择特定的分隔符来拆分文本。

另一个是***Get Words of Text***，它允许您只获取作为输入传递的文本的单个单词。

如果您没有这些操作，您可以从这里获取它们：

[https://itunes.apple.com/us/app/text-automator-actions-pack/id448838274?mt=12](https://itunes.apple.com/us/app/text-automator-actions-pack/id448838274?mt=12)**

# android - Android MultiAutoCompleteTextView 的下拉列表不滚动到底部

> ID：11440063
> 
> 赞同：0
> 
> 时间：2012-07-11T19:32:57.003
> 
> 标签：android, drop-down-menu, autocompletetextview

我无法让 MultiAutoCompleteTextView 的下拉列表滚动到底部。内容多于显示的内容，但列表不会低于某个点。我可以说我还没有到达列表的底部，因为底部看起来在两个条目之间。显示下拉菜单的代码在这里：

```
 public void onClick(View v) {
                adapter.getFilter().filter("");                 
                v.showDropDown();
            }
        }); 
```

在 main.xml 中，元素是：

```
<MultiAutoCompleteTextView
    android:id="@+id/myTextView"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_weight="3.0"
    android:ems="10"
    android:hint="@string/myViewPrompt" /> 
```

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:56:05.277

将 android:layout_height 设置为硬编码值似乎可行。这可以正确调整下拉列表的高度以适合所有值，具体取决于您输入的内容。

# php - 如何使用 codeigniter 从数据库中检索 INT 形式的数据？

> ID：11440070
> 
> 赞同：0
> 
> 时间：2012-07-11T19:33:38.870
> 
> 标签：php, mysql, database, codeigniter

我正在尝试创建一个更新函数，将输入的值添加到数据库中用户的值中。（它将可用于课堂的帐户添加到教师） 到目前为止，我有一个测试按钮，当单击它时应该添加一个帐户，然后刷新页面。

到目前为止，这是我的功能：

```
public function add_account()
{
    $this->load->model("teacher_data_model");
    $user = $this->ion_auth->user()->row();
    $user_id = $user->id;
    $data = array(
        'user_id' => $user_id,
        'unused_accounts' => [what do I insert here?]
    );

    $this->teacher_data_model->add_accounts($data, $user_id);
    redirect('teacher', 'refresh'); 
} 
```

诚然，这个功能很草率，我对此还是很陌生。此函数获取用户 ID 并将其传递给模型，该模型使用它来查找我们的老师并更新他们拥有的学生帐户数量。到目前为止，只要我对“未使用帐户”有一个固定值，这个方法就可以工作，问题是当我这样做时：

```
public function add_account()
{
    //  Getter of the user data
    $user = $this->ion_auth->user()->row();
    $user_id = $user->id;
    $this->load->model("teacher_data_model");

            //This gets the existing accounts
    $num_accounts["record"] =    $this->teacher_data_model->get_unused_accounts($user_id);
    $this->load->view("teacher/teacher_data_viewer", $num_accounts);

    $data = array(
        'user_id' => $user_id,
        'unused_accounts' => [what do I insert here?]
    );

            // data insertion
    $this->teacher_data_model->add_accounts($data, $user_id);
    redirect('teacher', 'refresh'); 
} 
```

我不确定是控制器还是模型中的 +1 增量，但此时我什至无法将搜索到的数据识别为 int。

对于 [我在此处插入什么？] 如果我使用 $num_accounts 我收到此数据库错误：错误编号：1054

“字段列表”中的未知列“数组”

更新`teachers`集`user_id`= '1'，`unused_accounts`= 数组 WHERE `user_id`= '1'

如果需要，这是我的模型：

```
function add_accounts($data, $uid)
{
    $this->db->where('user_id', $uid);  
    $this->db->update('teachers',$data);
} 
```

编辑：这是我从数据库中获取数据的函数

```
function get_unused_accounts($usersid)
{
    $this->db->select('unused_accounts');
    $this->db->from('teachers');
    $this->db->where('user_id', $usersid);
    $query = $this->db->get();
    return $query->result();
} 
```

我不确定这是否会以 INT 形式输出数据。当我使用它来检查用户是否至少有一个帐户时，即使用户有零个帐户，它也总是接受为真。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T06:11:43.643

还不能回答评论，但是

```
if($remaining_accounts = 1) 
```

永远都是真的，试试：

```
if($remaining_accounts == 1) 
```

[有关比较运算符，](http://www.php.net/manual/en/language.operators.comparison.php)请参见PHP 手册

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T19:46:19.703

为此，我建议在您的模型中使用原始 SQL：

```
function add_accounts($uid, $quantity = 1)
{
    $this->db->query('
        UPDATE teachers 
        SET unused_accounts=unused_accounts+'.$quantity.'
        WHERE user_id='.$uid
    ); 
} 
```

现在您可以`unused_accounts`为使用的用户将值加一

```
$this->teacher_data_model->add_accounts($user_id); 
```

或您想使用的任何数量

```
$this->teacher_data_model->add_accounts($user_id, $amount); 
```

不确定 CodeIgniter 的 ActiveRecord 是否会接受语句`unused_accounts=unused_accounts+'.$quantity.'`，但如果可以，您可以尝试在控制器中使用**它，它不会起作用，请参阅下面的编辑部分**：

```
 $data = array(
    'user_id' => $user_id,
    'unused_accounts' => 'unused_accounts + '.$amount
); 
```

**编辑：**看起来如果你想使用 ActiveRecord，你必须使用`$this->db->set()`第三个参数设置为 FALSE，所以在你的模型中是这样的：

```
function add_accounts($unused_accounts, $uid, $amount = 1)
{
    $this->db->where('user_id', $uid);
    $this->db->set('unused_accounts', 'unused_accounts+'.$amount, FALSE);
    $this->db->update('teachers');
} 
```

# php - php中的多种形式

> ID：11440074
> 
> 赞同：1
> 
> 时间：2012-07-11T19:33:54.857
> 
> 标签：php, html

我正在尝试创建三种形式。它应该工作的方式是应该出现一个表单并且用户能够输入他们的信息。按下提交按钮后，应向主管发送一封电子邮件，主管应单击链接，然后会出现另一个表单。当主管填写表格然后点击提交时，应向客户提交一封电子邮件。客户将点击链接并填写表格。然后，客户应该能够向员工发送电子邮件，主管和原始用户都应该能够得到回复。但是，当我继续创建表单时，php 在第二个表单之后不断中断。我似乎无法弄清楚为什么它一直以第三种形式出现。

这是第二种形式的 php 代码片段：

```
 if ($_POST['token'] == "2") {
     $m = new mysql($connection_information);
     $m->update('hello',array('approval'=>$_POST['approval'], 
'comment'=>$_POST['comment'], 
'approved_by'=>$_POST['approval_by'],
'approved_date'=>time()),'uid=\''.$_POST['uid'].'\'');
$records = $m->row(array('table' => 'hello','condition' => 'uid=\''.$_POST['uid'].'\''));

$eemail = records['email'];
$supemail = $records['supervemail'];
$clemail = $records['cemail'];
$approvaltime = date("m/d/y g:i a",$records['approved_date']);

$subject = " " . $clemail;
$headers = 'From: ' . $supemail . "\r\n" .
    'Reply-To: ' . $supemail . "\r\n" .
    'MIME-Version: 1.0' . "\r\n";

if($records['approval'] == 1){
    $travel_action = 'approved';
}else{
    $travel_action = 'rejected';
}

$message = " Travel Estimation  ".$travel_action." on ".$approvaltime." by ".$records['approved_by']. "\r\n" . "Comment: " .$records['comment']. "\r\n";
mail($eemail, $subject, $message, $headers); 
```

这是我的html部分：

```
 <?php if ($_POST['token'] == "2") { ?>
      <h1>Approval Decision Submited.</h1>
      <?php } else if ($_POST['token'] == "1") {
       echo "<h1>Form has been submitted</h1>";
     } else {

 if (isset($_GET['uid']) && isset($records)){

       ?>
    <form id="approvalForm" name="form2" action="hello.php" method="POST">
    <input type="hidden" name="token" value="2">
    <input type="hidden" name="uid" value="<?php echo $_GET['uid'] ?>">
    <fieldset>
        <legend>Manager Approval Required</legend>
        Submitted on: <?php echo date("m/d/y g:i a",$records['submitted'])                         ?><br/>
        By: <?php echo $records['email'] ?><br/>
        <label for="email">Supervisor's Email: </label>
        <input type="text" name="email" title="Email" value="<?php echo $records['supervemail'] ?>"><br>
         <label for="email">Client's Email: </label>
        <input type="text" name="email" title="Email" value="<?php echo $records['supervemail'] ?>"><br>
        <label for="email">Employee's Email: </label>
        <input type="text" name="email" title="Email" value="<?php echo $records['supervemail'] ?>"><br>
        <label for="approval_by">Please Enter your name for approval: </label>
        <input type="text" name="approval_by" id="approval_by" title="Approved By" ><br>
        <label for="approval">Please select appropriate action: </label>
        <select name="approval" id="approval">
          <option value="">Please Select Action</option>
          <option value="1">Approval</option>
          <option value="0">Rejection</option>
        </select>
        <label for="comment" >Comment: </label>
        <input type="text" name="comment" id="comment" title="comment"><br>

        <input class="submit" type="submit" value="Submit"/>
    </fieldset>
</form> 
```

在我的第三种表格中，我希望主管向客户发送一封电子邮件，以便客户收到链接并在第三种表格中批准或不批准。如果他们同意或不同意，他们可以从那里向用户提交电子邮件。我做到了，所以第三种形式看起来与第二种形式几乎相同。这就是我的错吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T19:40:53.227

我注意到 eemail 变量的记录数组没有美元符号。

```
$eemail = records['email']; 
```

应该

```
$eemail = $records['email']; 
```

# java - 在 Java/GWT 中使用 JSLint

> ID：11440076
> 
> 赞同：0
> 
> 时间：2012-07-11T19:33:55.233
> 
> 标签：java, javascript, gwt, error-handling, jslint

我目前正在开发一个 Java 项目，该项目将允许用户将 Javascript 代码键入 GWT 小部件。我将如何导入/使用 JSLint 来检查错误？我环顾四周，找到了LSLint4Java，但找不到将它导入eclipse的方法。我只需要一个简单的 JS 错误检查器来检查字符串是否有错误。

如果有人对错误检查有任何其他建议，请分享！谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T19:42:43.037

可以在[此处](https://github.com/douglascrockford/JSLint/)找到 JSlint javascript 源代码。您可以在您的 WAR 中包含 javascript，在您的页面中使用脚本链接引用它，并从/向您的 GWT 代码进行 JSNI 调用。

请注意，JSLint 在其许可证中有一个*No Evil*条款：

> // 该软件应用于善而不是恶。

[这是](https://developers.google.com/web-toolkit/doc/latest/DevGuideCodingBasicsJSNI)JSNI 的一个良好开端。

# java - 需要跟踪一个 API 的方法

> ID：11440082
> 
> 赞同：0
> 
> 时间：2012-07-11T19:34:17.777
> 
> 标签：java, api, netbeans

在我的项目中，我向我的项目添加了一个 API。

出于某种原因，我必须更改该 API 的一个类的方法。

现在我想知道这种变化对我的项目有何影响。

所以我用F7来过方法。

但它不起作用，F7 在这里表现得像 F8 ！

调试类的方法应该怎么做？在这里使用 Junit Test 有帮助吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T19:40:21.853

如果您使用的是 maven，则可以指定在收集项目依赖项时应下载库源。然后，当您通过代码进行调试时，您可以“向下”进入您的 API 类，因为该项目具有可用作参考的源代码。虽然我从来没有使用过netbeans，所以不知道它在多大程度上与maven一起工作。

见，例如

[获取附加到 Eclipse 的源 jar 文件以获取 Maven 管理的依赖项](https://stackoverflow.com/questions/310720/get-source-jar-files-attached-to-eclipse-for-maven-managed-dependencies)

和

[从 Maven 存储库获取源 JAR](https://stackoverflow.com/questions/2059431/get-source-jars-from-maven-repository)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T04:45:58.753

问题已解决。正如 davek 所说，如果我们有该包的源代码并将其添加到 NeatBeans 中，我们只能在 NetBeans 中对库（包）进行逐行调试：

1.  右键单击项目并转到“属性”

2.  在出现的窗口中选择左侧的“来源”

3.  在窗口右侧，在“源包文件夹”下单击“添加文件夹”，然后添加源代码的根目录。

# python - 浏览单词列表并计算按字母顺序排列的单词

> ID：11440084
> 
> 赞同：0
> 
> 时间：2012-07-11T19:34:22.563
> 
> 标签：python, python-2.7

我有一个包含数千个单词的文本文件。我必须计算按字母顺序排列的单词数。以下是从我拥有的一堆其他代码中截取的：

```
Counter = 0
    for word in wordStr:
    word = word.strip()
    if len(word) > 4:
    a = 0
    b = 1
    while word[a] < word[b]:
        a += 1
        b += 1
        Counter += 1
return Counter 
```

这里有一些明显的问题，我知道，但不知道如何解决。我的推理是这样的：如果一个单词的第一个字母 < 该单词的第二个字母，则该单词的那部分是按字母顺序排列的。所以我需要对一个单词进行这种操作，直到我发现整个单词都是按字母顺序排列或遇到字母a>字母b的情况。

目前，当 word[a] < word[b] 时，我的代码会增加计数器。但是，我需要更改它，使其仅在整个单词按字母顺序排列时才会增加，而不仅仅是前两个字母。我的另一个问题是我得到了错误，因为最终 while 循环尝试比较由于我递增 a 和 b 的方式而不存在的字符串索引。我知道需要重写很多东西，而且我已经把逻辑搞定了……只是在努力实现它。

编辑：我忘记了我以前遇到过这个问题，有人在我的另一个问题上帮助我解决了这个问题。对困惑感到抱歉。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T19:41:31.297

查看单词是否按字母顺序排列的一种简单方法是对其进行排序，然后查看排序后的版本是否与原始版本相同。Python 有一个函数`sorted()`可以用来对字符串进行排序；但是，结果会以列表的形式出现。因此，在比较它们之前，您需要将排序后的版本转换回字符串，或者将原始字符串转换为列表（第二个更容易，只需将字符串传递给`list()`）。

您可能还希望首先将字符串转换为小写（或大写 - 只要它一致就无关紧要），因为这会影响排序顺序：所有大写字母都在小写字母之前，因此`Cat`已经测试即使不是按字母顺序排列。您可以使用`.lower()`字符串对象上的方法来执行此操作。

Since this looks like homework I won't post working code but it should be very simple to put together from what I've given you.

# graph-theory - 如何在 .dot 文件中设置节点的大小？

> ID：11440085
> 
> 赞同：0
> 
> 时间：2012-07-11T19:34:26.417
> 
> 标签：graph-theory, dot, gephi

我想设置我的节点相对于它们在图中的影响的大小，我需要找到一些方法让它们的大小出现在 Gephi 中。目前，我正在使用以下代码：

```
def write_graph_dot(graph, filename, label=None):
    g = AGraph(directed=True)
    nodes = set()
    for key in graph:
        if key not in nodes:
            nodes.add(key)
            g.add_node(key, color='red')
            node = g.get_node(key)
            node.attr['fixedsize'] = True
            node.attr['height'] = 1.0
            node.attr['width'] = 1.0
        for value in graph[key]:
            if value not in nodes:
                nodes.add(value)
                g.add_node(key, color='black')
            g.add_edge(key, value, color='black')
    g.write(filename) 
```

但是，当我将其加载到 Gephi 中时，节点的大小都相同。我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T07:02:05.970

这是不可能的。

```
Subgraphs are not supported, nor custom attributes or size. Only labels and colors are imported if present. Directed and undirected graphs are supported. 
```

[https://gephi.org/users/supported-graph-formats/graphviz-dot-format/](https://gephi.org/users/supported-graph-formats/graphviz-dot-format/)

但是您可以将“size”作为变量导入，然后在gephi中使用它来设置大小：

```
 a [label="Foo"];
 a [mysize = 100]; 
```

（您必须先将导入的变量从字符串转换为整数。）

# iphone - UITableView 推送到具有不同 URL 数据的多个视图

> ID：11440088
> 
> 赞同：0
> 
> 时间：2012-07-11T19:34:35.560
> 
> 标签：iphone

我对 iPhone 开发比较陌生，我正在尝试创建一个使用需要推送到不同视图的 UITableView 的应用程序。现在我正在设计它以在每次单击单元格时推送到不同的页面。从我读过的其他帖子看来，这不是一个好主意，因为会有很多单独的视图页面。我不知道如何实现这一点，因为我正在设计每个视图，使其具有一个电话号码、电子邮件、网站和短信，这些电话号码可以发送到不同的来源/目的地。到目前为止，我已经设计了所有东西并且它可以工作，但需要最后一步才能完成应用程序。有人可以指出我的任何帮助或教程将不胜感激。

我会尝试更具体。我有一个导航到其他类别子菜单的类别主菜单。子菜单导航到的每个类别都有一个电话链接、电子邮件链接、SMS 链接和 Web 链接。我是否必须为每个类别制作单独的页面/视图，或者有没有办法制作一个 NSDictionary 来容纳具有 URL 链接的每个类别的所有数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T00:26:48.603

你需要在你的问题更具体。听起来好像您希望使用“push”segue 将后续 UITableViewController 推送到 UINavigationController 堆栈，并使用“didSelectRowAtIndexPath:”方法的组合将数据传递给子类别以确定单击的行，以及“prepareForSegue” :' 将行数据传递给新的 UITableViewController。

查看 Apple 教程 - [https://developer.apple.com/library/ios/documentation/iPhone/Conceptual/SecondiOSAppTutorial/](https://developer.apple.com/library/ios/documentation/iPhone/Conceptual/SecondiOSAppTutorial/)以非常简单的术语涵盖了所有这些概念。

# javascript - div 在浏览器的检查元素中变暗，无法检索内容？

> ID：11440091
> 
> 赞同：0
> 
> 时间：2012-07-11T19:34:46.860
> 
> 标签：javascript, html, emacs

我正在尝试从此编辑器中检索数据[尝试](http://www.ymacs.org/demo/)检查该页面的内容，您会看到内容被插入到暗淡的 div 和元素中。

我怎样才能检索这些数据。我知道这是一个有点混乱的问题，但请问我，我会尝试解释无法理解的点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T19:41:57.107

```
function myFunc(){
     var a = document.getElementsByTagName("div");
     for (i = 0; i < a.length; i++) {
         if(a[i].className == 'Ymacs-frame-content'){
              var b = a[i].getElementsByTagName("div");
              for (h = 0; h < b.length; h++) {
                  alert(b[h].innerHTML);
              }
         break;
         }             
     }
} 
```

那应该可以解决问题（或类似的东西）

# javascript - 谷歌在 json 创建的标记上映射 v3 事件触发器

> ID：11440094
> 
> 赞同：0
> 
> 时间：2012-07-11T19:35:00.477
> 
> 标签：javascript, jquery, json, google-maps-api-3

我们有一个动态的 json 提要，它被解析为我们谷歌地图上的标记。

解析函数看起来像这样：

```
function parse_json(json) {

      // alert('start parse: '+json.length);
      if (json.length > 0) { 
        var markers = [];
        for (i=0; i<json.length; i++) {
          var report = json[i];
          //alert(report.longitude +','+report.latitude);
          // addLocation(report); 
          markers[i] = new google.maps.Marker({
            map: map,
            position: new google.maps.LatLng(report.latitude, report.longitude),
            pop_title: report.area1.name,
            pop_body: '<b><a href="/spot/'+ report.spot.slug +'">'+ report.spot.name +'</a></b>'+
                      '<br>'+ report.report_description,
            draggable: false,
            title: 'title',
            zIndex: i,
            icon: '/images/map_icon.png'
          });
          markers[i].metadata = {type: "point", id: report.id};

          google.maps.event.addListener(markers[i], 'click', onMarkerClick);

      }
    }; 
```

我已将元数据信息添加到创建的标记中，因此它们的 id 是 report.id - 但我想使用该`google.maps.event.trigger(SOMETHING_HERE, 'click');`构造在按下地图外的按钮时触发给定标记上的单击事件。我如何获取对象名称，或者有没有办法使用对象的 id 来做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T19:52:54.320

如果您`markers`在比`parse_json`函数更高的范围内声明您的数组，那么您稍后将能够引用它，如下所示：

```
var markers = new Array();
function parse_json(json) {
    //code removed for brevity
} 
```

稍后，当您需要找到要触发点击事件的标记时，您可以使用`id`以下代码：

```
for ( var i = 0; i < markers.length; i++ ) {
    var mkr = markers[i];
    if ( mkr.metadata.id === idYouAreSearchingFor ) {
        //do whatever is needed here and fire your event
    }
} 
```

# sharepoint-2010 - Sharepoint 2010 中匿名用户的 Reporting Services 报告

> ID：11440098
> 
> 赞同：2
> 
> 时间：2012-07-11T19:35:17.933
> 
> 标签：sharepoint-2010, ssrs-2008, reporting-services, ssrs-2012

我有一个 SharePoint 网站，它有两种公开和私有的 SSRS 报告。公共报告不需要任何类型的身份验证，任何访问该站点的人都应该可以看到它们。基本上匿名访问公共报告和安全访问私人报告。

我在 SharePoint 中搜索了很多关于匿名访问 SSRS 报表的信息，发现这是 Reporting Services 与 SharePoint 集成的要求之一。是否有任何解决方法，以便我可以在我的 SharePoint 网站中显示公共报告？非常感谢您对此的任何帮助！

我正在使用 SharePoint Server 2010、SQL Reporting Services 2008 和 SQL Server 2008。如果需要，我可以使用 SQL Reporting Services 2012。

谢谢阿杰

# xpath - 如何制定这个 xpath 表达式？

> ID：11440100
> 
> 赞同：3
> 
> 时间：2012-07-11T19:35:20.590
> 
> 标签：xpath

给定以下 div 元素

```
<div class="info">
    <a href="/s/xyz.html" class="title">title</a>
    <span class="a">123</span>
    <span class="b">456</span>
    <span class="c">789</span>
</div> 
```

我想用“b”类检索跨度的内容。但是，我要解析的一些 div 缺少后两个跨度（“b”类和“c”类）。对于这些 div，我想要“a”类的 span 的内容。是否可以创建一个选择它的 XPath 表达式？

如果不可能，是否可以创建一个检索 div 全部内容的选择器？即检索

```
<a href="/s/xyz.html" class="title">title</a>
<span class="a">123</span>
<span class="b">456</span>
<span class="c">789</span> 
```

如果我能做到这一点，我可以使用正则表达式来查找我想要的数据。（我可以选择 div 中的文本，但我也不确定如何选择标签。只有文本会产生 123456789。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T15:42:33.820

**更高效——不需要联合**：

```
 //div/span
          [@class='b'
           or
             @class='a'
            and
             not(parent::*[span[@class='b']])
           ] 
```

作为两个绝对“`//`表达式”的并集的表达式（如下所示），通常执行两个完整的文档树遍历，然后联合操作按文档顺序执行重复数据删除和排序——所有这些都可能比单个操作效率低得多树遍历，除非 XPath 处理器具有智能优化器。

**这种低效表达的一个例子**：

```
//div/span[@class='b'] | //div[not(./span[@class='b'])]/span[@class='a'] 
```

**基于 XSLT 的验证**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="/">
  <xsl:copy-of select=
  "//div/span
          [@class='b'
           or
             @class='a'
            and
             not(parent::*[span[@class='b']])
           ]"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时**：

```
<div class="info">
    <a href="/s/xyz.html" class="title">title</a>
    <span class="a">123</span>
    <span class="b">456</span>
    <span class="c">789</span>
</div> 
```

**计算 Xpath 表达式，并将选定的元素（在本例中只有一个）复制到输出**：

```
<span class="b">456</span> 
```

**当相同的转换应用于不同的 XML 文档时，其中没有`class='b'`：**

```
<div class="info">
    <a href="/s/xyz.html" class="title">title</a>
    <span class="a">123</span>
    <span class="x">456</span>
    <span class="c">789</span>
</div> 
```

**评估相同的 XPath 表达式并将正确选择的元素复制到输出**：

```
<span class="a">123</span> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T19:47:44.000

xpath 表达式应该类似于：

```
//div/span[@class='b'] | //div[not(./span[@class='b'])]/span[@class='a'] 
```

union 运算符左侧的表达式`|`将选择所有 div 中的所有 b-class span，右侧的表达式将首先查询没有 b-class span 的所有 div，然后选择它们的 a-class span。该| 运算符将两个集合的结果结合起来。

请参阅[此处](https://stackoverflow.com/questions/5464272/xpath-find-node-that-does-not-contain-child)以使用 not() 选择节点，并[查看此处](http://www.w3schools.com/xpath/xpath_operators.asp)以将结果与 | 操作员。

另外，要参考您问题的第二部分，请查看[此处](https://stackoverflow.com/questions/10898035/how-to-get-node-value-innerhtml-with-xpath?rq=1)。在 xpath 中使用 node() 您可以选择所选节点下方的所有内容（节点 + 文本）。所以你可以得到 div 返回的所有内容

```
//div/node() 
```

以供将来通过其他方式处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T21:15:17.540

在没有联合运算符的情况下对您的输入起作用的表达式：

```
//div/span[@class='a' or @class='b'][count(../span[@class='b']) + 1] 
```

这只是为了好玩。我可能会在生产代码中使用更像@inVader 的答案。

# javascript - Backbone：GAE 中的 RESTful 后端

> ID：11440104
> 
> 赞同：0
> 
> 时间：2012-07-11T19:35:32.180
> 
> 标签：javascript, google-app-engine, rest, backbone.js

我正在尝试使用 Google App Engine 的 Java 后端为 Backbone 编写后端，但我似乎无法弄清楚如何处理 GET、POST、PUT 和 DELETE。我一直在为 App Engine 使用 doGet() 和 doPost()，但是你如何处理其他两个呢？

您将哪些参数传递给 servlet，servlet 在函数和映射方面是什么样的，它们返回什么？Backbone 似乎使 GAE 复杂化，我找不到更多关于如何执行此操作的其他内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:10:19.573

只要您扩展 HttpServlet，您就可以像 goGet 和 doPost 一样覆盖 goPut 和 doDelete。

[http://docs.oracle.com/javaee/1.3/api/javax/servlet/http/HttpServlet.html](http://docs.oracle.com/javaee/1.3/api/javax/servlet/http/HttpServlet.html)

# php - PHP 表单的打印

> ID：11440107
> 
> 赞同：1
> 
> 时间：2012-07-11T19:35:40.987
> 
> 标签：php

总而言之，我有一些表单，我的用户填写了一些带有文本框的表单，可以在上面选择等。我希望能够打印这些表单，但显然不想要表单元素等。我会喜欢只打印每个表单对象的文本。

我是否必须创建一个全新的 PHP 文件来处理表单的打印，或者我可以使用 PHP/CSS 等做一些事情吗？

请让我知道我必须这样做的选项。理想情况下，我不想编写一个全新的页面来模仿表单来打印它。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T19:39:29.067

通过使用 CSS 的`@media`声明，您可以指定特定于打印的样式：

```
@media print {
  input, select {
      border: none;
  }
} 
```

显然，你想要更深入一点，但它应该让你开始

**文档**

MDN 上的 CSS @media - [https://developer.mozilla.org/en/CSS/@media](https://developer.mozilla.org/en/CSS/@media)

# windows - PowerShell 文件夹权限错误 - 部分或全部身份引用无法翻译

> ID：11440115
> 
> 赞同：17
> 
> 时间：2012-07-11T19:36:28.753
> 
> 标签：windows, powershell, file-permissions

我以管理员身份运行此脚本，它确实创建了所需的文件夹，只是没有设置适当的权限。

```
$Users = Get-Content "D:\New_Users.txt"
ForEach ($user in $users)
{
    $newPath = Join-Path "F:\Users" -childpath $user
    New-Item $newPath -type directory

    $UserObj = New-Object System.Security.Principal.NTAccount("DOMAIN",$user)

    $acl = Get-Acl $newpath
    $acl.SetAccessRuleProtection($True, $False)
    $accessRule = New-Object System.Security.AccessControl.FileSystemAccessRule("O1OAK\$user","AppendData,CreateDirectories,CreateFiles,DeleteSubdirectoriesAndFiles,ExecuteFile,ListDirectory,Modify,Read,ReadAndExecute,ReadAttributes,ReadData,ReadExtendedAttributes,ReadPermissions,Synchronize,Traverse,Write,WriteAttributes,WriteData,WriteExtendedAttributes","ContainerInherit, ObjectInherit","None","Allow")
    $acl.SetAccessRule($accessRule)
    $accessRule = New-Object System.Security.AccessControl.FileSystemAccessRule("NT AUTHORITY\SYSTEM","FullControl","ContainerInherit, ObjectInherit","None","Allow")
    $acl.SetAccessRule($accessRule)
    $accessRule = New-Object System.Security.AccessControl.FileSystemAccessRule("BUILTIN\Administrators","FullControl","ContainerInherit, ObjectInherit","None","Allow")
    $acl.SetAccessRule($accessRule)
    $accessRule = New-Object System.Security.AccessControl.FileSystemAccessRule("1OAK\$user","Delete","ContainerInherit, ObjectInherit","None","Allow")
    $acl.removeAccessRule($accessRule)
    $acl.SetOwner($UserObj)
    $acl | Set-Acl $newpath
} 
```

我得到的字符串 3 中的第一个错误如下。我认为这是最重要的，并将修复其他 2 个。

```
Exception calling "SetAccessRule" with "1" argument(s): "Some or all identity references could not be translated."
At D:\DOMAIN\IT\IT Private\User Drives\user_folders.ps1:12 char:20
+     $acl.SetAccessRule <<<< ($accessRule)
    + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException
    + FullyQualifiedErrorId : DotNetMethodException 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-07-12T08:35:16.507

该错误非常不言自明：`Some or all identity references could not be translated.`

这意味着找不到该帐户。因此，您要做的就是验证您的帐户。由于您要添加 4 个 ACE，因此您需要确定哪些是无效的。

最简单的方法是使用 ISE 或 PowerGUI 逐行调试。

我用“NT AUTHORITY\SYSTEM”和“BUILTIN\Administrators”尝试了你的代码，它可以工作，所以问题出在`"O1OAK\$user"`or`"1OAK\$user"`上。您的文本文件中可能有一个无效帐户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-18T03:12:09.887

用户 ID 的一个问题是 AD 会截断用户名，因此具有长名称“j_reallylongname”的用户将有一个被截断的 samid（安全帐户管理器 (SAM) 帐户名）。(j_reallylong)

因此，在获取用户名时，请确保在使用 AD 之前对其进行验证。

当我得到 upns 后，我运行 dsget 查询来获取 samid，然后使用它来构建身份参考。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-03-05T15:50:48.723

添加这个以防任何 C#/ASP.NET 开发人员得到这个（这是我的场景，我找到了这篇文章）。

我在公司环境中使用 .NET Core，我需要检查 UserGroups 作为安全性的一部分。代码就像（其中“用户”是 a `ClaimsPrincipal`）：

```
var windowsIdentity = user.Identity as WindowsIdentity;
if( windowsIdentity is null )
    throw new Exception( $"Invalid Windows Identity {user.Identity.Name}" );
return windowsIdentity.Groups
    .Select( g => g.Translate( typeof( NTAccount ) ).Value ); 
```

不管怎样，群负责人删除了我所在的一个群，AD复制滞后导致我得到标题中的错误。注销和/或重新启动工作得很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-06T09:43:09.403

对我来说，这是我验证脚本执行是否知道密码的情况`$user = Get-Credential "username"`。我不得不把我的`$user`变成`$user.UserName`给脚本参数他们期望的值

# python - 有没有像样的 PyBrain 教程？

> ID：11440117
> 
> 赞同：16
> 
> 时间：2012-07-11T19:36:30.317
> 
> 标签：python, pybrain

所以，PyBrain 看起来肯定有很多很棒的工具和功能可供使用。可悲的是，它的文档/“教程”是……非常…………弱？并且很难确定如何做一个人想做的事。

有没有更好地学习 PyBrain 的 API 的资源？还是这一切都只是试错学习？

先感谢您....

# javascript - 为什么 .Play() 不能在 .mov？

> ID：11440118
> 
> 赞同：0
> 
> 时间：2012-07-11T19:36:32.920
> 
> 标签：javascript, embed, .mov

在 html 中：

```
<EMBED SRC="movies/test.mov" WIDTH="100%" HEIGHT="100%" AUTOPLAY="false" CONTROLLER="false" LOOP="false"PLUGINSPAGE="http://www.apple.com/quicktime/" id="movie1" /> 
```

在 JavaScript 中：

```
document.getElementById('movie1').Play(); 
```

错误：

```
Uncaught TypeError: Object #<HTMLEmbedElement> has no method 'Play' 
```

然而，它可以在 JS 控制台中使用相同的 javascript，这是怎么回事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T13:05:57.613

您需要在`LOOP`和之间留一个空格`PLUGINSPACE`。除此之外，我找不到任何问题。这可能是您调用 JavaScript 的方式，也可能是 URL 错误。它在这里工作：http: [//jsfiddle.net/8GYLZ/](http://jsfiddle.net/8GYLZ/)。我使用了`.mov`来自 Apple 网站的示例文件，并使用按钮调用它。

# java - Java - 在断言中调用函数时无法进入函数

> ID：11440127
> 
> 赞同：1
> 
> 时间：2012-07-11T19:37:03.550
> 
> 标签：java, assert, skip, breakpoints, step-into

因此，我在调试 Netbeans Java 应用程序时注意到，当在断言函数中使用函数调用时，您无法在该函数中命中断点或单步执行该函数。

起初我认为它必须与使用覆盖函数和我的覆盖函数没有被调用有关，但我确认这不是正在发生的事情。它仍然会被调用，但无法进入。

这是我尝试过的片段：

```
public class Example
{
    public static boolean blah()
    {
        System.out.println("Executing");    //**Breakpoint here
        return true;
    }

    public static void main(String[] args)
    {
        assert(blah());    //Cannot step into or hit breakpoint on this line.
        blah();            //Can here.
    }
} 
```

有人知道为什么这不起作用吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-11T19:43:37.603

默认情况下，断言在运行时被禁用。

也许您的调试 JVM 没有启用断言。

要启用断言，请为您的 NetBeans 调试 JVM 参数指定`-enableassertions`（或 - `ea`）开关。即使断言被编译到字节码中，如果没有这个开关，它们也不会执行。

有关更多信息，请参阅[此链接](http://docs.oracle.com/javase/1.4.2/docs/guide/lang/assert.html#enable-disable)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T19:39:08.727

也许，只是也许，每个`assert`语句在这个构建中都被优化了？你确定你的打印语句被执行了两次吗？

的全部意义`assert`在于，当您想要优化代码时，您可以告诉编译器忽略内部的内容。

# jquery - jQuery：测试是否未选中复选框

> ID：11440128
> 
> 赞同：130
> 
> 时间：2012-07-11T19:37:05.570
> 
> 标签：jquery, if-statement

我很难弄清楚这一点。我有两个复选框（将来会有更多）：

*   `checkSurfaceEnvironment-1`
*   `checkSurfaceEnvironment-2`

基本上，我想编写一个 if 语句并测试其中一个是否被检查而另一个未被检查。完成以下任务的最简单方法是什么：

```
if ( $("#checkSurfaceEnvironment-1").attr('checked', true) &&
     $("#checkSurfaceEnvironment-2").is('**(NOT??)** :checked') ) {
        // do something
} 
```

* * *

## 回答 #1

> 赞同：240
> 
> 时间：2012-07-11T19:39:47.160

我使用的一种可靠方法是：

```
if($("#checkSurfaceEnvironment-1").prop('checked') == true){
    //do something
} 
```

如果要迭代检查的元素，请使用父元素

```
$("#parentId").find("checkbox").each(function(){
    if ($(this).prop('checked')==true){ 
        //do something
    }
}); 
```

更多信息：

这很有效，因为所有复选框都有一个已选中的属性，该属性存储了复选框的实际状态。如果您希望可以检查页面并尝试选中和取消选中复选框，您会注意到属性“已选中”（如果存在）将保持不变。该属性仅代表复选框的*初始状态*，而不是*当前*状态。当前状态存储在该复选框的 dom 元素的属性中。

请参阅[HTML 中的属性和属性](https://stackoverflow.com/questions/6003819/properties-and-attributes-in-html)

* * *

## 回答 #2

> 赞同：86
> 
> 时间：2012-11-08T07:11:16.777

```
if (!$("#checkSurfaceEnvironment-1").is(":checked")) {
    // do something if the checkbox is NOT checked
} 
```

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2013-09-26T16:18:49.987

您还可以使用 jQuery[**`.not()`**](http://api.jquery.com/not/)方法或[**`:not()`**](http://api.jquery.com/not-selector/)选择器：

```
if ($('#checkSurfaceEnvironment').not(':checked').length) {
    // do stuff for not selected
} 
```

[JSFiddle 示例](https://jsfiddle.net/1b07bqsu/16/)

* * *

### 补充说明

`:not()` *来自选择器*的 jQuery API 文档：

> .not **()** *方法*最终将为您提供比将复杂的选择器或变量推入**:not()** *选择器*过滤器更易读的选择。在大多数情况下，这是一个更好的选择。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2012-07-11T19:43:43.420

另一种方法：

这是一个[工作示例](http://jsfiddle.net/aayb9/)，这是代码，您还应该使用 prop.

```
$('input[type="checkbox"]').mouseenter(function() { 
    if ($(this).is(':checked')) {
        //$(this).prop('checked',false);
        alert("is checked");
    } else {
         //$(this).prop('checked',true);
        alert("not checked");
    }
});​ 
```

我注释掉了切换选中属性的方法。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2019-01-11T13:24:25.447

我认为检查复选框是否选中的最简单方法（使用 jQuery）是：

**如果“检查”：**

```
if ($(this).is(':checked')) {
// I'm checked let's do something
} 
```

**如果没有“检查”：**

```
if (!$(this).is(':checked')) {
// I'm NOT checked let's do something
} 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2012-07-11T19:42:15.300

```
if ( $("#checkSurfaceEnvironment-1").is(":checked") && $("#checkSurfaceEnvironment-2").not(":checked") ) 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2014-03-12T14:13:11.430

我正在寻找像avijendr建议的更直接的实现。

我对他/她的语法有点麻烦，但我得到了这个工作：

```
if ($('.user-forms input[id*="chkPrint"]:not(:checked)').length > 0) 
```

就我而言，我有一个带有 class 的表`user-forms`，我正在检查是否有任何包含字符串的复选框`checkPrint`未被`id`选中。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-08-17T10:43:18.113

在这里，我有一个关于这个问题的片段。

```
$(function(){
   $("#buttoncheck").click(function(){
        if($('[type="checkbox"]').is(":checked")){
            $('.checkboxStatus').html("Congratulations! "+$('[type="checkbox"]:checked').length+" checkbox checked");
        }else{
            $('.checkboxStatus').html("Sorry! Checkbox is not checked");
         }
         return false;
   })

});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<form>
  <p>
    <label>
      <input type="checkbox" name="CheckboxGroup1" value="checkbox" id="CheckboxGroup1_0">
      Checkbox</label>
    <br>
    <label>
      <input type="checkbox" name="CheckboxGroup1_" value="checkbox" id="CheckboxGroup1_1">
      Checkbox</label>
    <br>
  </p>
  <p>
    <input type="reset" value="Reset">
    <input type="submit" id="buttoncheck" value="Check">
  </p>
  <p class="checkboxStatus"></p>
</form>
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-07-11T19:40:23.927

像你一样做`.attr()`，看看它是否被检查过`.attr("checked", "checked")`，如果不是，它会是`.attr("checked") == undefined`

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-03-12T14:26:25.927

如果在 div 中选中所有复选框，则返回 true

```
function all_checked (id_div){
 all_checked = true;

 $(id_div+' input[type="checkbox"]').each(function() { 
    all_checked = all_checked && $('this').prop('checked');
 }

 return all_checked;
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-01-02T07:18:39.663

简单且易于检查或未检查的条件

```
<input type="checkbox" id="ev-click" name="" value="" >

<script>
    $( "#ev-click" ).click(function() {
        if(this.checked){
            alert('checked');
        }
        if(!this.checked){
            alert('Unchecked');
        }
    });
</script> 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-02-25T07:16:05.693

试试这个

```
if ($("#checkSurfaceEnvironment-1:checked").length>0) {
    //your code in case of NOT checked
} 
```

在上面的代码中，通过 Id 选择元素，`(#checkSurfaceEnvironment-1)`然后通过过滤器过滤掉它的检查状态`(:checked)`。

它将返回已检查元素对象的数组。如果数组中存在任何对象，则满足条件。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-11-30T04:35:13.270

有两种方法可以检查条件。

```
if ($("#checkSurfaceEnvironment-1").is(":checked")) {
    // Put your code here if checkbox is checked
} 
```

或者你也可以使用这个

```
if($("#checkSurfaceEnvironment-1").prop('checked') == true){
    // Put your code here if checkbox is checked
} 
```

我希望这对你有用。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-01-04T04:45:01.210

**这是给出的最简单的方法**

```
 <script type="text/javascript">

        $(document).ready(function () {
            $("#chk_selall").change("click", function () {

                if (this.checked)
                {
                    //do something
                }
                if (!this.checked)
                {
                    //do something

                }

            });

        });

    </script> 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-07-25T05:01:59.547

我用过这个并为我工作！

```
$("checkbox selector").click(function() {
    if($(this).prop('checked')==true){
       do what you need!
    }
}); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-04-03T21:39:54.477

我知道这已经得到了回答，但是，这是一个很好的方法：

```
if ($("#checkbox").is(":checked")==false) {
    //Do stuff here like: $(".span").html("<span>Lorem</span>");
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2018-11-12T07:42:17.850

```
if($("#checkbox1").prop('checked') == false){
    alert('checkbox is not checked');
    //do something
}
else
{ 
    alert('checkbox is checked');
} 
```

* * *

## 回答 #18

> 赞同：-4
> 
> 时间：2018-06-05T13:16:24.840

```
$("#chkFruits_0,#chkFruits_1,#chkFruits_2,#chkFruits_3,#chkFruits_4").change(function () {
        var item = $("#chkFruits_0,#chkFruits_1,#chkFruits_2,#chkFruits_3,#chkFruits_4");
    if (item.is(":checked")==true) {
        //execute your code here
    }

    else if (item.is(":not(:checked)"))
    {
        //execute your code here
    }

}); 
```

# bash - 如何取消终端中的长输出？

> ID：11440130
> 
> 赞同：4
> 
> 时间：2012-07-11T19:37:05.950
> 
> 标签：bash, git, terminal, output, git-log

`git log`如何从终端命令或 git 命令（如or ）的长输出中退出`git branch -a`？

如何避免我必须按 enter 直到命令的输出完成？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-11T19:41:28.553

`git log`用于`more`分页`less`输出。

您可以按`q`停止更多/更少并删除剩余的输出。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-07-11T19:41:33.817

Ctrl-C 是完整的答案，尽管在这个领域太短了。

# javascript - 将字符串数组的子字符串复制到Javascript中的新数组中

> ID：11440131
> 
> 赞同：0
> 
> 时间：2012-07-11T19:37:09.683
> 
> 标签：javascript, arrays, string, sorting

我正在寻找将字符串数组的子字符串复制到新数组中而不创建引用。这让我很头疼，但这应该很简单。

我在一个循环中尝试过`NewArray[n] = OldArray[n].substr(x,y).slice(0)`，但不起作用。（我需要做一个`NewArray.sort()`之后）。

举例来说，假设我得到了一个`OldArray`包含 2 个元素的元素：

```
['River', 'Lake'] 
```

我希望新数组由旧数组的前 2 个字符（子字符串）组成，这样：

```
['Ri', 'La'] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T19:47:28.197

> 将字符串数组的子字符串复制到新数组中而不创建引用

字符串是 JavaScript 中的原始值，而不是对象。将旧的值分配给新数组时将没有引用，尤其是在使用`substr`. 与字符串一起使用时，`slice(0)`您使用的 是多余的，在您的情况下也不需要在数组上。

您的代码应该可以工作：

```
var oldArray = ["River", "Lake"];

var newArray = [];
for (var i=0; i<oldArray.length; i++)
   newArray[i] = oldArray[i].substr(0,2);

// newArray: ["Ri", "La"] 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2020-10-29T08:26:04.300

这对我有用。谢谢@Bergi

```
const newArray = oldArray.map( str => str.substr(0,2) ); 
```

# node.js - 在 Socket.IO 中，'heartbeat' 是一个可用于触发其他操作的事件吗？

> ID：11440132
> 
> 赞同：9
> 
> 时间：2012-07-11T19:37:10.973
> 
> 标签：node.js, websocket, socket.io, heartbeat

这个确切的代码不起作用，但是，我希望它是这样的：

```
io.sockets.on('connection', function(socket) {
    socket.on('heartbeat', function() {
        // Do something here...
    });
}); 
```

这样的事情可能吗？我的意思是，我知道我可以使用 setInterval 创建一个不同的函数，例如每 15 秒触发一次：

```
io.sockets.on('connection', function(socket) {
    setInterval(function() {
        // Do something
    },15000);
}); 
```

但是既然心跳已经在这个间隔运行，为什么不利用它呢？

无论如何，任何见解都将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-12T01:11:28.900

我想我明白你在做什么。您可以在此处查看一些公开[的事件 - Socket.io 事件列表](https://github.com/LearnBoost/socket.io/wiki/Exposed-events)- 但没有“心跳”事件可供您按设定的时间间隔触发。

您使用第二段代码走在正确的轨道上-

```
setInterval(function() {
    socket.emit('heartbeat', someData);
}, 5000); 
```

在客户端 -

```
socket.on('heartbeat', function(data) {
    console.log(data);
}) 
```

# php - 如何检查一个元素在 php 中是否可见？

> ID：11440135
> 
> 赞同：4
> 
> 时间：2012-07-11T19:37:15.597
> 
> 标签：php, html

我有几个变量要保存或不保存到数据库，这取决于我是否在 javascript 函数中将它们设置为隐藏/可见，我已经搜索了一段时间但找不到任何东西。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-11T19:38:58.373

这是绝对不可能的，因为 PHP 在服务器上运行，而 JavaScript 和 CSS 在客户端。

您唯一能做的就是使用 JavaScript 检查元素是否可见并将该数据发送到您的 PHP 脚本，例如通过隐藏`<input>`字段。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-11T19:58:35.370

你也可以有这个选择。注意页面必须在此生效之前刷新（即在 PHP 知道发生了什么之前）

```
//Your JavaScript
function setHidden()
{

   document.getElementById('elementForVar1').visibility = 'hidden';

   //use this to indicate field/variable is hidden. PHP will use this later
   document.getElementById('elementForVar1HiddenField').value = 1;
} 
```

在表单中声明隐藏字段以存储变量的状态

```
<form name="xxx">
    <input type="hidden" id="elementForVar1HiddenField" name="elementForVar1HiddenField" value="0" />
</form> 
```

您的 javascript 只需将隐藏字段的值设置为 1，表示 var1 已隐藏

```
<?php
  if($_POST['elementForVar1HiddenField'] == 1)
     //variable was hidden

?> 
```

# javascript - 使用 Jquery .load() 函数获取变量和页面片段

> ID：11440137
> 
> 赞同：0
> 
> 时间：2012-07-11T19:37:25.203
> 
> 标签：javascript, jquery, python, ajax, web2py

我目前正在使用 Jquery 的 .load() 函数异步插入页面片段。在我从中加载页面片段的 URL 中，我还设置了一个 Javascript 全局变量值（在脚本标记中）。

```
var loaded_variable = 'value1' 
```

有没有办法可以使用 .load() 函数插入页面片段并检索 的值`loaded_variable`，类似于以下代码：

```
 function loadProducts(url) {
                 $('#mainplace').load(url + ' #submain', function() { 
                       current_variable = loaded_variable;
                 });
    } 
```

I am aware that script blocks are used when a selector expression is appended to the URL, so if the .load() function won't work, I'm open to other Jquery functions that can accomplish this.

额外信息：我从中加载的 URL 是用 HTML 和 Python (Web2py) 编写的；相同的 Python 变量用于呈现页面片段并设置`loaded_variable`值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:25:16.810

如果您想从页面中获取片段并在其上执行脚本，则需要一种不同的方法。这有点hacky，但有效。

```
$.ajax({url: 'fetch_page.html', dataType: 'text'}).done(function(html) {
    var dom = $('<html />').prop('innerHTML', html);
    $('body').append(dom.find('body p'));
    $('head').append(dom.find('script'));
}); 
```

它从我们获取的页面中获取一个`p`标签并将其插入到`body`父页面中。它还执行获取页面中的任何脚本。

如果您对此感到疑惑`prop('innerHTML...`，那是因为如果我使用了 jQuery 的`.html()`方法，它会清理输入字符串，因此我们不会得到我们想要的结果。

我的第一个想法是文档片段，但是您不能将 HTML 字符串插入到文档片段中 - 您必须通过 DOM 方法附加。即使在这种情况下，它也不会`dom`像我一样简单地使用一个元素来解析 dom ()。

正如我所说，有点hacky，但有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-02-26T17:57:16.260

我想我有一个类似的问题。我已经创建了一个页面来注册时事通讯。我想在我网站上每篇博文的底部加载这个页面。我不希望它出现在页脚中，因为它特定于我的博客页面，我希望能够编辑它而无需编辑每篇博客文章。

我使用 url /blog-newsletter-form 创建了这个页面，其中包含来自电子邮件 CRM 的一些代码。

然后，我在我的博客文章末尾添加了一个带有“blog-newsletter-form”类的 div，并将以下内容放在页面标题中以从我的博客文章的第一页部分加载内容。

```
$( document ).ready(function() {
    $('.blog-newsletter-form').load("/blog-newsletter-signup #page .page-section:nth-of-type(1) .content");
}); 
```

这很好用，除了.. 加载功能正在从我的时事通讯表单工作所需的时事通讯页面中剥离脚本。

如何加载页面片段，同时保留新闻通讯的脚本。我尝试使用您上面的示例代码，但无法正常工作。

# ruby-on-rails - Rails 3 插件 - 如何在 require 语句中访问应用程序的模型文件？

> ID：11440138
> 
> 赞同：0
> 
> 时间：2012-07-11T19:37:28.837
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-plugins

我正在 Rails 3.2.6 中编写一个插件 - 我的插件应该修改我的用户模型（位于 app/models/user.rb 中） - 但是，我找不到从插件中引用该文件的正确方法陈述。

我尝试了`require 'user'`,`require 'app/models/user'`和一堆试图使用 Rails.root 和其他变量的东西 - 没有任何效果，并且在尝试运行应用程序时出现错误“未初始化的常量用户”。

有人可以指出我正确的方向吗？顺便说一句，这个插件是作为一个 gem 构建的，并且包含在我的 Gemfile 中（它从 github 中提取它）。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T20:12:02.217

如果你使用的是 ruby​​ 1.9，你应该可以使用 require_relative

```
#assuming /lib/yourfile.rb
require_relative '../app/models/user.rb' 
```

如果您使用的是较旧的红宝石，则可以尝试

```
require File.dirname(__FILE__) + '../app/models/user.rb' 
```

# java - EditText 无故调整大小

> ID：11440140
> 
> 赞同：4
> 
> 时间：2012-07-11T19:37:41.237
> 
> 标签：java, android

在相对布局中观察到相当奇怪的行为。

这是初始状态： ![在此处输入图像描述](../Images/73b44cbdbd325fff074d34cfdc9b8398.png)

定义为：

```
<EditText
    android:id="@+id/bleedCount"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_toLeftOf="@+id/abrMult"
    android:layout_below="@+id/textView4"
    android:layout_marginRight="10dp"
    android:ems="10"
    android:inputType="number"
    >
    <requestFocus />
</EditText>

<TextView
    android:id="@+id/abrMult"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_toLeftOf="@+id/abrSubmit"
    android:layout_alignBaseline="@+id/abrSubmit"
    android:layout_marginRight="10dp"
    android:text="x12" />

<Button
    android:id="@+id/abrSubmit"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/textView4"
    android:layout_alignParentRight="true"
    android:text="Calculate" /> 
```

从`onItemSelected`下拉列表中，它正在像这样更改：

```
abrSubmit.setText(pos == 1 ? "Calculate" : "Submit");
abrMult.setVisibility(pos == 1 ? View.VISIBLE : View.GONE);
bleedCount.setHint(pos == 1 ? "# of Meow/month" : "# of Meow/year"); 
```

变成了这样：
![在此处输入图像描述](../Images/3817adfa8c6385a2f0a39851f8c85b93.png)

请注意 EditText`bleedCount`在第二张图片上的高度。的值`bleedCount.getHeight()`从 72 变为 95，我不明白是什么原因造成的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T19:50:35.450

它与 当 EditText 改变它的宽度时，用 显示视图后，它必须被分成两行。[`android:ems="10"`](http://developer.android.com/reference/android/widget/TextView.html#attr_android%3aems)
`x12`

[`ems`](http://en.wikipedia.org/wiki/Em_%28typography%29)给定字体的大小为一个字母。

我觉得你不需要`ems`。
将 EditText 设置为单行：`android:singleLine="true"`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-15T01:14:55.657

The `bleedCount` EditText resizing is due to your hint text becoming longer than a single line when `(pos == 1)`.

If you comment out the following line in your code, the resizing will stop happening:

```
// bleedCount.setHint(pos == 1 ? "# of Meow/month" : "# of Meow/year"); 
```

Maybe you can [make it shorter/smaller](https://stackoverflow.com/a/5215872/1023092) to prevent the resizing?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T23:41:53.303

好的，因为我没有你的整个代码库，所以我把一些简单的东西放在一起来复制你正在做的事情。仅供参考，我使用的是 ICS 4.1。我没有遇到您遇到的任何问题，所以这可能是 API 问题。也许你可以看看我的代码库，看看它和你自己的代码库有什么不同。其中可能存在解决方案。

XML:

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:id="@+id/main_rl"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<TextView
    android:id="@+id/textView4"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Top TextView" />

<Spinner
    android:layout_below="@+id/textView4"
    android:id="@+id/spinner1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" />

<TextView
    android:layout_below="@+id/spinner1"
    android:id="@+id/textView5"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Above EditText" />

<EditText
    android:id="@+id/bleedCount"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_below="@+id/textView5"
    android:layout_marginRight="10dp"
    android:layout_toLeftOf="@+id/abrMult"
    android:ems="10"
    android:inputType="number" >
</EditText>

<TextView
    android:id="@+id/abrMult"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/textView5"
    android:layout_alignBaseline="@+id/abrSubmit"
    android:layout_marginRight="10dp"
    android:layout_toLeftOf="@+id/abrSubmit"
    android:text="x12"
    android:visibility="gone" />

<Button
    android:id="@+id/abrSubmit"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:layout_below="@+id/textView5"
    android:text="Submit" />

</RelativeLayout> 
```

代码：

```
public class ExampleActivity extends Activity implements OnItemSelectedListener {

private Button submitButton;
private TextView tv;
private Spinner spinner;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_example);

    submitButton = (Button) findViewById(R.id.abrSubmit);
    tv = (TextView) findViewById(R.id.abrMult);
    spinner = (Spinner) findViewById(R.id.spinner1);

    // create the data array for the spinner
    String[] strings = { "This", "That", "The Other" };

    // create the spinner adapter
    ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
            android.R.layout.simple_spinner_item, strings);
    adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);

    // set the adapter on the spinner
    spinner.setAdapter(adapter);

    // set the event listener for the spinner
    spinner.setOnItemSelectedListener(this);
}

public void onItemSelected(AdapterView<?> arg0, View arg1, int arg2,
        long arg3) {
    if (submitButton.getText().equals("Calculate")) {
        submitButton.setText("Submit");
        tv.setVisibility(View.GONE);
    } else {
        submitButton.setText("Calculate");
        tv.setVisibility(View.VISIBLE);
    }

}

public void onNothingSelected(AdapterView<?> arg0) {
    // TODO Auto-generated method stub
}
} 
```

希望能帮助到你...

# javascript - 为什么 .attr('title') 抓取前一个元素的标题

> ID：11440142
> 
> 赞同：0
> 
> 时间：2012-07-11T19:37:44.530
> 
> 标签：javascript, jquery, html, flexslider

**更新** Flexslider 有一堆回调空间可供使用，这使得这成为可能。

```
after: function(){},            //Callback: function(slider) - Fires after each slider animation completes 
```

感谢大家

**[LIVE CODE](http://designobvio.us/Titles/)**：
我上传了用于调试的实时代码；制作一个jsfiddles会相当困难。

**问题：** 函数 fetchTitle() 获取上一个图像标题而不是最新的？

**说明：**我有一个函数falled，它`fetchTitles()`从[flexslider](http://www.woothemes.com/flexslider/)的活动幻灯片中获取一个标题标签并将其放入一个varible`targetTitle`中。然后替换`h1.head_line`为`targetTitle`

**脚本：（**从完整脚本配对下来，请查看完整的实时代码）

```
 function fetchTitles() {
       var targetTitle = $('.flex-active-slide').find('img').attr('title');

        $('.head_line').text(targetTitle);

    } 
```

**HTML**

```
 <li class="flex-active-slide">
    <article class="active_work" title="Facebook + Like Pillow">
      <figure> <img title="Facebook + Like Pillow" src="asset/img/1600/slide1_1600.jpg" />
        <figcaption class="sliderCaptions">
          <h1>
            <div class="animate_text"></div>
            <a href="https://plus.google.com/104865624796200130935/" ><span>Author:</span> Matthew Harwood</a></h1>
        </figcaption>
      </figure>
      <section class="article_post"></section>
    </article>
  </li> 
```

**补充资料：**

*   如果您单击链接两次，您会看到标题会自行更新。
*   即使有准备就绪，文档准备就绪上的提取标题也会出现无法识别`.flex-active-slide`。
*   脚本位于源代码的底部`script2.js`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T19:43:16.967

改用[`$.prop`](http://api.jquery.com/prop/)：

```
var targetTitle = $('.flex-active-slide').find('img').prop('title'); 
```

> 属性和属性之间的区别在特定情况下可能很重要。**在 jQuery 1.6 之前**，该[`.attr()`](http://api.jquery.com/attr/)方法有时会在检索某些属性时考虑属性值，这可能会导致行为不一致。**从 jQuery 1.6 开始**，该`.prop()`方法提供了一种在检索属性的同时显式检索属性值的方法`.attr()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T19:55:01.313

确实是时间问题。如果我引入 setTimeout，问题就消失了

```
function fetchTitles() {
       setTimeout(function()
       {
            var targetTitle = $('.flex-active-slide').find('img').attr('title');

            $('.head_line').text(targetTitle);

       },200);
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T19:57:42.873

看起来该类直到幻灯片动画完成后才更新，但 fetchTitles 在您单击时立即运行，因此具有“flex-active-slide”类的图像仍然是前一个图像。

您可能希望查看在回调函数中运行 fetchTitles，以便它在幻灯片完成后运行。

# visual-studio-2010 - 降低 Visual C++ 2010 框架目标

> ID：11440144
> 
> 赞同：0
> 
> 时间：2012-07-11T19:37:51.357
> 
> 标签：visual-studio-2010, visual-c++

我浏览了 StackOverflow，但找不到任何实用的解决方案来解决看似简单的解决方案：我有一堆 .Net 项目，这些项目是在 VS2005 或 VS2008 中开发的，我将它们导入到 VS2010 中。其中之一是一个 C++ 项目，它目前针对框架 4.0（不是我选择的）。我们的一位客户在运行此应用程序时遇到问题，缺少 MSVCP100D.dll。我检查了这个线程[什么是 MSVCP100D.dll？](https://stackoverflow.com/questions/6580685/what-is-msvcp100d-dll)最被接受的答案很简单：让客户端安装 Microsoft Visual C++ 2010 Redistributable Package。但是，客户端固执地不安装它，我知道他们安装了 Microsoft Visual C++ 2008 Redistributable。所以，如果我的结论是正确的，并且 MSVCP100D.dll 是 VS2010 的新手，我可以只针对以前的框架版本，在 VS2010 中重建项目，我会很高兴。问题是：我如何获得 VC++ 目标框架？我可以找到一些更改 C# 和 VB 项目的指南，但没有关于 VC++ 的。任何指针？

编辑：对于那些建议我在发布模式下编译它的人：我是！有人指出，“D”代表调试，这很奇怪。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T19:42:58.093

进入项目的属性。

在左侧，进入**Configuration Properties** > **General**。

查看**平台工具集**值。从下拉列表中选择*v90以定位 2008。*

有关详细信息，请参见此处： [Visual C++ 2010 与 VC 2008 的兼容性](https://stackoverflow.com/questions/3435213/visual-c-2010-compatibility-with-vc-2008)

有关更多详细信息，请参见此处：http: [//blogs.msdn.com/b/vcblog/archive/2009/12/08/c-native-multi-targeting.aspx](http://blogs.msdn.com/b/vcblog/archive/2009/12/08/c-native-multi-targeting.aspx)

![在此处输入图像描述](../Images/da8afef84ff551e1e3d27441fe2dcbfc.png)

正如 Dark Falcon 所提到的，这是运行时的调试版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T19:40:59.630

实际上，您使用的是运行时的调试版本（即“D”）。您是否尝试使用非调试版本进行编译？

另一种需要考虑的可能性是与运行时库进行静态链接。您的程序会更大，但不会有 DLL 依赖项。

# ios - CoCos2d Box2d 中的缩小屏幕

> ID：11440147
> 
> 赞同：0
> 
> 时间：2012-07-11T19:38:07.860
> 
> 标签：ios, cocos2d-iphone, box2d

从 cocos2d 2.0 创建一个简单的 HelloWorld Box2d 模板时，启动屏幕缩小到正常大小的一半（在 flash 之后）。然后就好像每个精灵都更小了。这是正常的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T20:01:53.263

您是否启用了 Retina 显示模式？（默认开启）

您是否在项目中添加了高分辨率图像（带有 -hd 后缀）？

如果没有，您会注意到所有精灵在 Retina 显示设备上都缩小了 50%，因为 cocos2d 在 Retina 分辨率表面上显示 SD 图像。添加两倍高和两倍宽的 -hd 图像，或者禁用 Retina 显示模式（查看 AppDelegate.m）。

# javascript - 更新窗口哈希（在 url）

> ID：11440148
> 
> 赞同：0
> 
> 时间：2012-07-11T19:38:30.477
> 
> 标签：javascript, hash, window, photo-gallery

所以我有一个图片库的这个 js 代码：

```
(this.settings.update_window_hash) {
        var thumb_link = this.images[this.current_index].thumb_link;
        if (thumb_link.attr("id")) {
          window.location.hash = "#image-"+ thumb_link.attr("id"); //#url
        } else {
          window.location.hash = "#image-"+ this.current_index;
        };
}; 
```

因此，您可能已经假设这会将 $image-(int) 附加到 url。因此，如果我有一个包含多张图片的画廊，并且选择了第三张图片，则 url 将如下所示：mysite.com/gallery.html#image-3

都好。但我真的不喜欢将它附加到 url 的末尾。那么如果我完全删除这部分脚本有什么问题吗？因此，无论当前选择多少图片，网址都将如下所示：mysite.com/gallery.html

我已经测试过了，它工作正常。但我对 javascript 不是很有经验，我想确保我没有犯错。如果我 **完全删除这个脚本可以吗？它会引起任何问题吗？**

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T19:51:41.407

URL 末尾的哈希是可选的，不是必需的，所以是的，您可以根据需要删除该脚本（我不确定您通过删除它试图解决什么问题）。一般来说，如果您告诉我们您要解决的问题而不是您尝试使用的解决方案，您会得到更有用的答案。

当您希望页面的 URL 将查看者定向到该页面上的某些子内容时，使用哈希。如果您删除它们，您的页面仍然可以正常工作，但页面的 URL 不会反映正在显示的图像。因此，如果查看者保存该 URL 并返回它或链接到它或任何保留对 URL 的引用的东西，它将转到页面的通用版本，而不是显示特定图像的页面。这是否可以完全取决于您以及您的页面如何工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T19:41:30.847

只需使用：

```
location.replace(location.href + "#myhash"); 
```

location.replace 方法覆盖浏览器历史记录中的当前步骤。有关此操作的示例，请参见[http://prettydiff.com/slideshow/](http://prettydiff.com/slideshow/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T20:06:35.987

octothorpe 后面的内容通常代表网页中的“名称”或“ID”。您可以有一个锚标记 ( )，浏览器将通过滚动到页面上的相关部分来 `<a name='thevalue'>`解释 octothorpe ( ) 之后的文本。`http://example.com#thevalue`

除非页面有特殊的 JavaScript 来表现不同。在您的情况下，这取决于您正在编写的网页的全部功能。如果您有冒烟测试/单元测试/用例测试/其他 QE 测试，您应该执行这些测试以确保您的更改不会破坏任何东西。

有关标准用法的更多说明，请参见[http://www.w3schools.com/html/html_links.asp](http://www.w3schools.com/html/html_links.asp)。

# php - 使用 PHP 即时生成页面

> ID：11440150
> 
> 赞同：1
> 
> 时间：2012-07-11T19:38:41.143
> 
> 标签：php, mysql, .htaccess

我是 PHP 新手，我很好奇您如何动态生成页面？

我有一个用户表，我从我的数据库中提取并显示在我的主页上，并且我知道我可以将他们的用户 ID 作为 POST 变量传递给“mysite.com/profilepage.php”，然后对此进行查询将提取该 ID 的所有相关信息的页面，但说我希望该页面为“mysite.com/user-profiles/john-doe.php”？

这会用`.htaccess`文件完成吗？任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T19:44:14.987

如果您必须调用该页面`mysite.com/user-profiles/john-doe.php`，您可以使用评论中提到的 mellamokb 的 URL 重写将 URL 更改为该 URL。

但就 PHP 而言，这样做的方法是创建一个 PHP 页面（我将建议`user-profiles.php`），然后使用`GET`或将用户名传递给它`POST`。假设您只是在阅读并且相关信息是公开的，`GET`这似乎很好，并且在这里更容易解释。

`user-profiles.php?username=John-Doe`您可以通过将浏览器指向以下代码并将其包含在以下代码中来访问相关页面（由 PHP“动态”生成）`user-profiles.php`：

```
if ( isset($_GET['username']) )
{
    $username = $_GET['username'];
    // you now know the passed username
}
else
{
    // some kind of error handling for when there is no username
} 
```

您现在知道您的 PHP 文件中有相关的用户名，并且可以根据需要使用它来创建页面。如果您愿意，还可以使用 URL 重写来更改`user-profile.php?username=John-Doe`。`user-profiles/John-Doe`

**警告：**`$_GET`如果有问题的页面要以*任何*方式修改数据库，或者要从数据库中获取私人信息，请不要使用。它在任何方面都不安全。在创建执行上述任何一项操作的页面之前，请阅读 PHP 安全性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T19:57:11.017

如果您是 PHP 新手并且没有看过任何框架，请看一下[敏捷工具包](http://agiletoolkit.org)。它在 jquery 和 php 之间进行了一些巧妙的集成，这将为您的页面提供漂亮的外观和感觉。它还鼓励您使用 ModelViewController (MVC) 将用于数据库访问和功能的代码部分与纯粹用于网页布局的代码部分分开。

上面提到的 URL 重写选项是相同的，但是当用户登录时，您可以从 $this->api->auth('xxx') 访问用户信息，其中 xxx 是用户表中的列。

该框架需要一些学习，但 PHP 也是如此，并且很容易养成编写 PHP 代码的坏习惯，这意味着随着网站变得越来越大，您会发现维护代码变得更加困难。

# sql-server - 用户 Jboss AS7 的 SQL Server 登录失败

> ID：11440152
> 
> 赞同：0
> 
> 时间：2012-07-11T19:38:52.903
> 
> 标签：sql-server, jdbc, jboss7.x

我正在尝试在我的standalone.xml 文件中设置多个数据源。我与 DB2 建立了连接并且工作正常。我无法让 SQL Server 连接正常工作。

从standalone.xml：

```
 <datasource jndi-name="java:/jdbc/syteline" pool-name="SYTELINEMSSDS" enabled="true" use-java-context="true" spy="true">
            <connection-url>jdbc:sqlserver://SLSQL:1433;databaseName=npsl_pilot_app;</connection-url>
            <driver-class>com.microsoft.sqlserver.jdbc.SQLServerDriver</driver-class>
            <driver>sqljdbc4.jar</driver>
            <pool>
                <min-pool-size>5</min-pool-size>
                <max-pool-size>10</max-pool-size>
                <prefill>true</prefill>
                <use-strict-min>false</use-strict-min>
            </pool>
            <security>
                <user-name>myUser</user-name>
                <password>myPass</password>
            </security>
            <timeout>
                <idle-timeout-minutes>15</idle-timeout-minutes>
            </timeout>
        </datasource> 
```

我在我的standalone\deployments 目录中部署了 sqljdbc4.jar，它正在部署。我通过将连接 URL 和凭据复制/粘贴到我的应用程序并在我的代码中创建 JDBC 连接来测试连接 URL 和凭据。该连接正常工作。在standalone.xml 中将连接设置为数据源给了我以下信息：

```
15:20:00,326 INFO  [org.jboss.as.connector.subsystems.datasources] (MSC service thread 1-15) JBAS010400: Bound data source [java:/jdbc/syteline]
15:20:00,684 WARN  [org.jboss.jca.core.connectionmanager.pool.strategy.OnePool] (JCA PoolFiller) IJ000610: Unable to fill pool: javax.resource.ResourceException: Could not create connection
    at org.jboss.jca.adapters.jdbc.local.LocalManagedConnectionFactory.getLocalManagedConnection(LocalManagedConnectionFactory.java:277)
    at org.jboss.jca.adapters.jdbc.local.LocalManagedConnectionFactory.createManagedConnection(LocalManagedConnectionFactory.java:235)
    at org.jboss.jca.core.connectionmanager.pool.mcp.SemaphoreArrayListManagedConnectionPool.createConnectionEventListener(SemaphoreArrayListManagedConnectionPool.java:758) [ironjacamar-core-impl-1.0.7.Final.jar:1.0.7.Final]
    at org.jboss.jca.core.connectionmanager.pool.mcp.SemaphoreArrayListManagedConnectionPool.fillToMin(SemaphoreArrayListManagedConnectionPool.java:703) [ironjacamar-core-impl-1.0.7.Final.jar:1.0.7.Final]
    at org.jboss.jca.core.connectionmanager.pool.mcp.PoolFiller.run(PoolFiller.java:97) [ironjacamar-core-impl-1.0.7.Final.jar:1.0.7.Final]
    at java.lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_23]
Caused by: com.microsoft.sqlserver.jdbc.SQLServerException: Login failed for user 'dna'. ClientConnectionId:4e4e0e7f-3e23-4a13-9c49-37e33aeb4613
    at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:216)
    at com.microsoft.sqlserver.jdbc.TDSTokenHandler.onEOF(tdsparser.java:254)
    at com.microsoft.sqlserver.jdbc.TDSParser.parse(tdsparser.java:84)
    at com.microsoft.sqlserver.jdbc.SQLServerConnection.sendLogon(SQLServerConnection.java:2908)
    at com.microsoft.sqlserver.jdbc.SQLServerConnection.logon(SQLServerConnection.java:2234)
    at com.microsoft.sqlserver.jdbc.SQLServerConnection.access$000(SQLServerConnection.java:41)
    at com.microsoft.sqlserver.jdbc.SQLServerConnection$LogonCommand.doExecute(SQLServerConnection.java:2220)
    at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:5696)
    at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:1715)
    at com.microsoft.sqlserver.jdbc.SQLServerConnection.connectHelper(SQLServerConnection.java:1326)
    at com.microsoft.sqlserver.jdbc.SQLServerConnection.login(SQLServerConnection.java:991)
    at com.microsoft.sqlserver.jdbc.SQLServerConnection.connect(SQLServerConnection.java:827)
    at com.microsoft.sqlserver.jdbc.SQLServerDriver.connect(SQLServerDriver.java:1012)
    at org.jboss.jca.adapters.jdbc.local.LocalManagedConnectionFactory.getLocalManagedConnection(LocalManagedConnectionFactory.java:249)
    ... 5 more

15:20:01,385 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-14) Class Path entry jcifs.jar in "/C:/jbossdir/jboss7/standalone/deployments/speed2.war/WEB-INF/lib/jtds-1.2.5.jar"  does not point to a valid jar for a Class-Path reference. 
```

我无法弄清楚登录失败消息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T21:43:14.090

Is the JBoss server on the same computer as the test application that can connect properly?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T15:13:15.097

作为后续，我放弃了 Microsoft 驱动程序并改用 JTDS。工作正常。

# maven - 如何使用 maven 和 fatjar 插件将单个依赖项包含到 jar 中

> ID：11440157
> 
> 赞同：9
> 
> 时间：2012-07-11T19:39:13.210
> 
> 标签：maven, uberjar

我对这个问题感到有点愚蠢，但我不知道如何将 SINGLE 依赖项（jdom.jar）添加到另一个 jar 中。

上下文：我们为我们的应用程序开发了一个简单的插件，这个插件有很多依赖。我们使用 fatjar 将 jdom.jar 包含在其中。我正在尝试修复这个插件中的一个错误，所以我决定同时“maven-ize”它。（我们刚刚切换到 maven）这个插件是在运行时加载的，所以我们想要与它打包的唯一依赖项是 jdom.jar。

问题：发现有maven fatjar插件！不幸的是，我找不到任何文档，并且这个 maven 插件将每个依赖项添加到输出 jar 中。经过多次尝试，我决定放弃这个 fatjar 插件并寻找另一个。我找到了 one-jar ， shade 但在**快速**阅读它们之后，它们看起来像是添加了每个依赖项。

问题：像这样只将 jdom.jar 添加到我的插件 jar 中的简单方法是什么：

```
-MyPlug-in.jar
|
|-src
 |-主要
  |-java
   |-*.java
|-jdom.jar

```

另外我不想更改清单或输出 jar 文件名

非常感谢您的时间。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2015-12-05T17:52:50.720

这里没有关于如何使用 maven 将单个 jar 文件包含在`maven-shader-plugin`. 我花了一些时间才弄清楚如何真正做到这一点。这是一个仅包含依赖项中的类的片段`com.googlecode.json-simple:json-simple`。

```
<project>
    ...
    <build>
        <plugins>
            ...
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-shade-plugin</artifactId>
                <version>1.6</version>
                <executions>
                    <execution>
                        <phase>package</phase>
                        <goals>
                            <goal>shade</goal>
                        </goals>
                        <configuration>
                            <artifactSet>
                                <includes>
                                   <include>com.googlecode.json-simple:json-simple</include>
                                </includes>
                            </artifactSet>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
            ...
        </plugins>
    </build>
    ...
</project> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T13:50:22.183

使用 maven Shade 可以正常工作，一个罐子也可以完成这项工作。但是我们最终决定在我们的扩展中打包 jdom 是一个不好的做法。

所以我们要这样做：

```
|-根应用文件夹
 |-扩展文件夹
  |-MyExtension.jar
  |-libs 文件夹
   |-jdom.jar

```

lib 文件夹中的 jar 将被动态加载，如果扩展无法在 libs 文件夹中找到适当的库，则不会加载。

对于希望解决我的主要问题的人，请查看@khmarbaise Answer。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T07:09:30.153

出于这种目的，我建议使用[maven-shade-plugin](http://maven.apache.org/plugins/maven-shade-plugin/)它将创建一个可以通过多种方式控制的 ueber-jar。使用[阴影插件，您可以排除](http://maven.apache.org/plugins/maven-shade-plugin/examples/includes-excludes.html)您不喜欢的东西。但这可能是由于没有使用可以控制依赖关系的单独 maven 模块造成的。

# linq - .NET 标准查询运算符 - emptyOrder

> ID：11440166
> 
> 赞同：2
> 
> 时间：2012-07-11T19:39:37.640
> 
> 标签：linq, linq-to-entities

在这个 msdn 示例中：

[.NET 标准查询运算符](http://msdn.microsoft.com/en-us/library/bb394939.aspx#standardqueryops_topic6)

我们看到这个 LEFT JOIN 的例子：

```
var custTotalOrders =
 from c in customers
 join o in orders on c.CustomerID equals o.CustomerID into co
 from o in co.DefaultIfEmpty(emptyOrder)
 select new { c.Name, o.OrderDate, o.Total }; 
```

它说：

其中**emptyOrder**是一个**Order**实例，用于表示缺失的订单。

那么，**emptyOrder**是从哪里来的呢？如何在我的代码中使用它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T19:58:07.373

DefaultIfEmpty 有两个重载

[默认如果空](http://msdn.microsoft.com/en-us/library/bb360179.aspx)（）

[DefaultIfEmpty(defaultValue)](http://msdn.microsoft.com/en-us/library/bb355419.aspx)

第一个将返回 default(T) ，其中 T 是当可枚举为空时包含在可枚举中的类型。

当可枚举为空时，第二个将返回 defaultValue 参数中给出的值。

假设您像这样声明 emptyOrder：

```
Order emtpyOrder = new Order() { Total=100 }; 
```

然后在查询中：

```
var custTotalOrders =
from c in customers
join o in orders on c.CustomerID equals o.CustomerID into co
from o in co.DefaultIfEmpty(emptyOrder)
select new { c.Name, o.OrderDate, o.Total }; 
```

当客户没有匹配的订单时，投影匿名对象中的 Total 属性的值为 100。

# windows - 如何在 linux 的共享 windows 文件夹上写入或创建目录？

> ID：11440176
> 
> 赞同：1
> 
> 时间：2012-07-11T19:39:58.160
> 
> 标签：windows, linux, share, mount, cifs

经过一段时间的搜索，我找到了使用[此处](http://industriousone.com/blog/mounting-windows-shares-linux)找到的步骤在我的远程 linux 服务器上安装 Windows 共享文件夹的方法。我实现了安装文件，但是当我想写入或创建一个文件夹时，它要么需要我 sudo 才能写入或创建一个目录。

这是一个问题，因为我正在尝试运行一个从 Internet 下载文件并根据需要自动创建其文件的脚本。我尝试使用类似`sudo chmod`or的命令更改共享文件夹的所有权或权限，`sudo chown`但它告诉我权限被拒绝并且它不能这样做。

我怎样才能使我安装在我的 linux 机器上的共享文件接受写入或文件创建？

# html - 链接到其他页面上的特定标题

> ID：11440181
> 
> 赞同：0
> 
> 时间：2012-07-11T19:40:28.207
> 
> 标签：html

这是我设置网站的方式。我有一个名为“news.html”的页面。这个页面的内容只是一个固定大小的 iframe。iframe 链接到“innernews.html”，这是我要显示的实际内容。我以这种方式设置它以保持每个页面的大小一致。iframe 防止页面高度因额外内容而扩大，并且是可滚动的。

如何在“innernews.html”页面中创建针对特定元素/标题的链接？如果没有办法实现这一点，我将删除 iframe 并将内容直接插入“news.html”。但我仍然不知道如何创建一个针对特定元素/标题的链接......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T19:46:37.503

基本上，您可以简单地创建指向页面特定标题的链接：

```
<a name="your_header_name"></a>
<h1>Header Text</h1>

...

<a href="#your_header_name">Link to the header</a> 
```

如果没有理由保留 iframe，我强烈建议您从页面中删除它们。当您尝试做一些不平凡的事情时，iframe 会使您的生活复杂化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T19:51:48.193

`id`仅当元素具有该属性或者它是具有该属性的`a`元素时，您才能链接到该元素（在另一个页面上或在同一页面上）`name`。在这两种情况下，将片段标识符`#foo`放在链接中 URL 的末尾，其中`foo`是属性的值。

如果被链接的页面不包含这样的属性，并且如果它不在您的控制范围内，那么您就不走运了

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T19:43:30.597

您是否考虑过使用容器，例如：

```
#newsContainer {
    overflow: scroll;
    height: /*whatever*/
} 
```

# linux-kernel - 使用 perf 用户空间工具和 PEBS 进行基于事件的采样

> ID：11440182
> 
> 赞同：4
> 
> 时间：2012-07-11T19:40:29.287
> 
> 标签：linux-kernel, profiling, kernel-module, perf

我正在使用 perf 用户空间工具进行基于事件的采样：目标是试图找出某些影响性能的事件（如分支未命中和缓存未命中）在我正在处理的更大系统上发生的位置。

现在，像

```
perf record -a -e branch-misses:pp -- sleep 5 
```

完美运行：由 'pp' 修饰符触发的 PEBS 计数模式在收集样本中的 IP 时非常准确。

不幸的是，当我尝试对缓存未命中做同样的事情时，即

```
perf record -a -e cache-misses:pp -- sleep 5 # [1] 
```

我明白了

> 错误：sys_perf_event_open() 系统调用返回 22（无效参数）。/bin/dmesg 可能会提供其他信息。
> 
> 致命：没有配置 CONFIG_PERF_EVENTS=y 内核支持？

`dmesg | grep "perf\|pmu"`没有显示任何有用的 AFAICT。我也很确定内核是用 CONFIG_PERF_EVENTS=y 编译的，因为 [1] 和

```
perf record -a -e cache-misses -- sleep 5 # [2] 
```

工作：[2] 的问题是收集的样本不是很准确，这伤害了我的个人资料。

关于这里可能发生什么的任何提示？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T21:13:29.377

事实证明，通用`cache-misses`映射到的特定事件不支持 PEBS。另一种方法是使用 PEBS 支持的事件之一**（**请参阅[此处](http://software.intel.com/sites/products/documentation/hpc/amplifierxe/en-us/2011Update/lin/ug_docs/reference/index.htm#pmn/events/about_precise_event_based_sampling_performance_tuning_events.html)的 Nehalem 架构列表）和适当的掩码来缩小范围。具体来说，可以使用 MEM_LOAD_RETIRED:LLC_MISS，即使事件似乎并非在所有情况下都是准确的。

# r - 如何告诉 R 的 ggplot2 为 x 轴的某些值添加刻度线，并为其他值保留垂直线

> ID：11440187
> 
> 赞同：7
> 
> 时间：2012-07-11T19:40:54.600
> 
> 标签：r, ggplot2

我正在使用 R 中的 ggplot2 创建一个时间序列。我想知道如何在 x 轴上仅显示标记月份（例如 3 月 7 日、3 月 8 日等）的刻度线，同时保持垂直灰线每个月。

主要原因是因为每个月都有一个刻度线，所以很难知道哪个对应于标签。

这是一个情节的例子：

![看看 x 轴上的刻度如何让人很难知道每个月在哪里](../Images/0f1a127ffc5cd74ec43feeb1e3333688.png)

这是R后面的行：

```
ggplot(timeseries_plot_data_mean,aes(as.numeric(project_date)))+
   geom_line(aes(y=num_views))+geom_point(aes(y=num_views))+
   stat_smooth(aes(y=num_views),method="lm")+
   scale_x_continuous(breaks = xscale$breaks, labels = xscale$labels)+
   opts(title="Monthly average num views")+xlab("months")+ylab("num views") 
```

这就是想要生成的。看看刻度是如何定位在月份标签的正上方的，垂直线仍然在那里显示每个月。

![这就是想要生成的（Inkscape，图像编辑器，奇怪地将点替换为 q's](../Images/58c61151fa9d252b7180e798aef66d20.png)

我使用 Inkscape 手动编辑了上面的图，（忽略 q，Inkscape 奇怪地将点替换为 q）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-11T22:42:52.527

这是使用`minor_breaks`参数的解决方案`scale_x_date()`。要使用它，您的 x 值必须是 class`Date`而不是`numeric`.

```
library(ggplot2)
set.seed(123)

x <- seq(as.Date("2007/3/1"), as.Date("2012/4/1"), by = "1 month")
y <- ((exp(-10 * seq(from=0, to=1, length.out=length(x))) * 120) +
      runif(length(x), min=-10, max=10))

dat <- data.frame(Months=x, Views=y)

x_breaks <- seq(as.Date("2007/3/1"), as.Date("2012/4/1"), by="1 year")
x_labels <- as.character(x_breaks, format="%h-%y")

plot_1 <- ggplot(dat, aes(x=Months, y=Views)) +
          theme_bw() +
          geom_line() +
          geom_point() +
          scale_x_date(breaks=x_breaks, labels=x_labels, minor_breaks=dat$Months)

png("plot_1.png", width=600, height=240)
print(plot_1)
dev.off() 
```

![plot_1.png](../Images/c517c9bbf7232c14fe8e554a634af7b3.png)

# opengl - 显示列表中的 glPushMatrix 重复模型

> ID：11440191
> 
> 赞同：1
> 
> 时间：2012-07-11T19:41:02.780
> 
> 标签：opengl, displaylist

我有一些立方体的显示列表......非常简单的东西。这是一个片段：

```
GL11.glPushMatrix
GL11.glRotatef(90,0,0,1)
cuboid(1,0.5,20) //just glVertex calls
GL11.glPopMatrix 
```

如果我使用它以立即模式绘制，则不会发生任何奇怪的事情。但是，如果我将它放在显示列表中，它将首先绘制未旋转的长方体，然后旋转（或我在 glPushMatrix 和 glPopMatrix 之间进行的任何转换）。此外，如果我不使用 glPush 和 glPop 它的行为符合预期。

在显示列表中使用 glPush/PopMatrix 时有什么我需要知道的吗？

编辑：添加更多源代码：

```
handle = GL11.glGenLists(1);
GL11.glNewList(handle,GL11.GL_COMPILE)
GL11.glBegin(GL11.GL_LINES);

GL11.glPushMatrix //if I don't use these it behaves as expected
GL11.glRotatef(90,0,0,1)
cuboid(1,0.5,20) //just glVertex calls
GL11.glPopMatrix

GL11.glEnd();
GL11.glEndList(); 
```

EDIT2：我通过将 glBegin 与 glPushMatrix 和 glEnd 与 glPopMatrix 交换来使其工作 - 我不喜欢它现在的样子，但至少它可以工作。据我所知，这是不正常的，我所做的只是一个把戏，所以我把这个问题留了下来。

```
GL11.glPushMatrix //everytime I want to push/pop I have to call glBegin and glEnd
GL11.glBegin(GL11.GL_LINES);
GL11.glRotatef(90,0,0,1)
cuboid(1,0.5,20) //just glVertex calls
GL11.glEnd();
GL11.glPopMatrix 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-12T06:09:58.717

在 glBegin/glEnd 中调用 glPushMatrix 是错误的。只有严格的命令子集可以在 glBegin/glEnd 对中使用。

从 glBegin 手册页：

> 在 glBegin 和 glEnd 之间只能使用 GL 命令的子集。这些命令是 glVertex、glColor、glSecondaryColor、glIndex、glNormal、glFogCoord、glTexCoord、glMultiTexCoord、glVertexAttrib、glEvalCoord、glEvalPoint、glArrayElement、glMaterial 和 glEdgeFlag。此外，可以使用 glCallList 或 glCallLists 来执行仅包含上述命令的显示列表。如果在 glBegin 和 glEnd 之间执行了任何其他 GL 命令，则设置错误标志并忽略该命令。

在 glPushMatrix 的手册页上：

> 如果在 glBegin 的执行和 glEnd 的相应执行之间执行了 glPushMatrix 或 glPopMatrix，则生成 GL_INVALID_OPERATION。

开始在你的开发代码中加入glGetError，它会向你指出这些问题。

glRotatef 在那里也不合法：

> 如果在 glBegin 的执行和 glEnd 的相应执行之间执行了 glRotate，则生成 GL_INVALID_OPERATION。

# sql-update - 如何使用按钮运行更新查询？

> ID：11440192
> 
> 赞同：0
> 
> 时间：2012-07-11T19:41:08.967
> 
> 标签：sql-update

我们有一个大型数据库，其中有多个存储数据的表。我们将客户登录率输入到表格中，并希望将信息更新到我们的 loadliptbl 以及我们的 infoconverionratestbl 中，而无需进入单独的更新查询并再次输入该信息（已经输入到表格中）。

更新查询如下：

更新 Loggingtbl INNER JOIN Loadsliptbl ON Loggingtbl.LoggingId = Loadsliptbl.LoggingId SET Loadsliptbl.EstConvRate = 1.4289, Loadsliptbl.[LogRate-T] = 24.22 WHERE (((Loadsliptbl.Date) 在 #5/19/2012# 和 #6/1 之间/2012#) AND ((Loggingtbl.TM)="FJ3W66 312") AND ((Loadsliptbl.Stratum)="20-415P"));

我们必须在表单和更新查询中输入 EstConvRate、LogRate-T、日期参数、TM 和 Stratum。

我该如何自动化呢？

雪莉

# jquery - 无法获取文本区域的值

> ID：11440198
> 
> 赞同：0
> 
> 时间：2012-07-11T19:41:31.043
> 
> 标签：jquery, knockout.js

我使用了淘汰赛并从我的 ModelView 模板中取回了这些...

```
<div class="both">
    <td>
    <h3 data-bind="text: MyText"> What type of fruit is healthy ?</h3>
    <textarea data-bind="attr:{id: Question}" class="my-response" id="1"> this is my text area value </textarea>
    </td>   
</div>

<div class="both">
    <td>
        <h3 data-bind="text: MyText"> What type of Veg is healthy ?</h3>
        <textarea data-bind="attr:{id: Question}" class="my-response" id="2"> this is my text area value</textarea>
    </td>
</div> 
```

我想获取文本区域的值，但这不起作用..

```
$('.both').each(function() {
 alert($('.my-response').val());
}); 
```

我怎样才能做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T19:43:51.497

试试这个

```
$(function(){

   $('.both').each(function(index,item) {
       var v= $(item).find('.my-response').val();
       alert(v);
   });        

}); 
```

工作样本：http: [//jsfiddle.net/2CGWG/3/](http://jsfiddle.net/2CGWG/3/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T19:47:22.043

你也可以试试这个

```
$(document).ready(function(){
    $('.my-response','.both').each(function(){alert($(this).val())});
});​ 
```

这是[演示](http://jsfiddle.net/ZmPNQ/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T19:33:06.943

这效果最好！

```
$(function(){

$('.my-response').each(function () {alert($(this).val());});

}); 
```

[演示](http://jsfiddle.net/ameerkabeer/Y3UNg/)

# algorithmic-trading - 如何量化 MQL4 中的指标？

> ID：11440200
> 
> 赞同：1
> 
> 时间：2012-07-11T19:41:32.070
> 
> 标签：mql4, algorithmic-trading, mql4, metatrader4

我一遍又一遍地试图让这个指标在[mql4](/questions/tagged/mql4 "显示标记为“mql4”的问题")中使用 2 个缓冲区量化运行。经过长时间的阅读，我已经放了 2 个额外的缓冲区来压扁它：/ 因为：

> 该指标目前位于**0.1430-0.1427**之间，但**没有固定的顶部和底部**。

我似乎无法怀疑。很酷的指标，但不会公平竞争！

```
#property indicator_separate_window
#property indicator_buffers   4
#property indicator_color1    Lime
#property indicator_color2    Red
#property indicator_color3    CLR_NONE
#property indicator_color4    CLR_NONE
//#property indicator_minimum 0
//#property indicator_maximum 100
extern int    P   =   13;
extern int    T   = 3000;
extern double P2  =    0.001;
//int         MIN =    0;
//int         MAX =  100;
double G[];
double R[];
double B3[];
double B4[];

int init(){
   IndicatorBuffers(4);
   SetIndexBuffer( 0, G  );SetIndexStyle( 0, DRAW_LINE, STYLE_SOLID, 1, Lime );
   SetIndexBuffer( 1, R  );SetIndexStyle( 1, DRAW_LINE, STYLE_SOLID, 1, Red  );
   SetIndexBuffer( 2, B3 );SetIndexStyle( 2, DRAW_NONE );
   SetIndexBuffer( 3, B4 );SetIndexStyle( 3, DRAW_NONE );
   return(0);
}
int start(){
      if (  T >= Bars ) T = Bars;

      SetIndexDrawBegin( 0, Bars - T + P + 1 );
      SetIndexDrawBegin( 1, Bars - T + P + 1 );
      SetIndexDrawBegin( 2, Bars - T + P + 1 );
      SetIndexDrawBegin( 3, Bars - T + P + 1 );

      int Z, C, Opt = IndicatorCounted();

      if (  Bars <= 38 ) return(0);

      if (  Opt  <  P ){
         for ( Z = 1; Z <= 0; Z++ ) G[T-Z] = 0.0;
         for ( Z = 1; Z <= 0; Z++ ) R[T-Z] = 0.0;
      }

      Z = T - P - 1;

      while( Z >= 0 ){
         double A, S1, S2;
         S1 = 0.0; for ( C = 0; C <= P - 1; C++ ){ S1 = S1 + (   High[Z+C] + Low[Z+C] ) / 2;}
         S2 = 0.0; for ( C = 0; C <= P - 1; C++ ){ S2 = S2 + ( ( High[Z+C] + Low[Z+C] ) * ( C+1 ) / 2 );}
         A  = S1 / S2;
         // if (  A < MIN ){ MIN = A;}
         // if (  A > MAX ){ MAX = A;}
         // A = ( MIN / MAX ) * 100;
         G[Z] = A;
         if (  Z > 0 ){ R[Z-1] = A;}
         Z--;
      }
      for ( int N = T-P-2; N >= 0; N-- ){
         if (  N > 0 ){
               if ( G[N-1] > G[N] ){ R[N] = EMPTY_VALUE; continue;}
               if ( G[N-1] < G[N] ){ G[N] = R[N];        continue;}
         }
         B3[0] = G[0] + P2;
         B4[0] = G[0] - P2; //forced quantise using 2 extra buffers
      }
      return(0);
   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-07-18T11:17:59.503

## 让我们先拆分任务

**0** ) 指标**逻辑**
**1** ) 指标**量化**步骤
**2** ) 指标**性能**

**`MQL4`**自定义指标编程依赖于对底层`MetaTrader4 Terminal`平台的更深入理解。每个改变交易工具价格的外部市场事件都通过**`QUOTE ...`**来自`MetaTrader4 Server`. 这又称为 Tick，它触发了对最初调用的函数的调用**`start()`**，在较新的*New*中-`MQL4.56789`重命名为**`OnTick()`**.

下面的修改`MQL4`清单包含核心逻辑消歧的注释，它必须在下面列出的所有步骤之前。

* * *

## **1**）指标**量化**步骤

虽然代码仍然非常低效（根据下面的 [2]），但逻辑不包括任何将输出量化为任何形式的直接障碍形式 { 二进制 | 三元 | 任意状态数}-量化系统。当指标核心逻辑被清除后，量化步骤只是从**R(1)**到**I(1)**的简单转换。

* * *

## **2**）指标**性能**

任何 Tick 到达**可以但不需要**修改`High[0]`或`Low[0]`，这是建议的自定义指标演算的唯一可变部分。

这是关于如何减少重新计算范围的核心思想，`MQL4`代码必须在每个刻度上实现。在最新版本的 MT4 中，**所有自定义指标共享一个线程**，对自定义指标的有效算法化施加的压力更大，在这些情况下，可能会阻止平台对糟糕、低效的代码循环和卷积/递归重新执行的交易决策。

```
#property indicator_separate_window
#property indicator_buffers   4
#property indicator_color1    Lime
#property indicator_color2    Red
#property indicator_color3    CLR_NONE
#property indicator_color4    CLR_NONE

extern int    P   =   13;
extern int    T   = 3000;
extern double P2  =    0.001;

double G[];                                                         // 0: LINE
double R[];                                                         // 1: LINE
double B3[];                                                        // 2: BUT NEVER PAINTED, NEVER CONSUMED _?_
double B4[];                                                        // 3: BUT NEVER PAINTED, NEVER CONSUMED _?_

int init(){
   IndicatorBuffers(4);
   SetIndexBuffer( 0, G  );SetIndexStyle( 0, DRAW_LINE, STYLE_SOLID, 1, Lime );
   SetIndexBuffer( 1, R  );SetIndexStyle( 1, DRAW_LINE, STYLE_SOLID, 1, Red  );
   SetIndexBuffer( 2, B3 );SetIndexStyle( 2, DRAW_NONE );
   SetIndexBuffer( 3, B4 );SetIndexStyle( 3, DRAW_NONE );
   return(0);
}
int start(){

    if (  Bars <= 38 ) return(0);                                   // JIT/RET in case Bars < 39 --^ --^ --^ --^

    if (  T >= Bars ) T = Bars;                                     // (TRIM´d) T < Bars .OR. = Bars

    int aDrawBegins     = Bars - T + P + 1;                         // ( extern P = 13 ) + 1 + ( Bars - ( extern T = 3000 if T < Bars else Bars ) )
    //tIndexDrawBegin( 0, Bars - T + P + 1 );                       // PREF: ( reused 4x )
    SetIndexDrawBegin( 0, aDrawBegins );                            // Draw  14+ last candles -- PREF: why a per tick hard-coded SHIFTING / enforced re-draw?
    SetIndexDrawBegin( 1, aDrawBegins );                            // Draw  14+ last candles -- PREF: why a per tick hard-coded SHIFTING / enforced re-draw?
    SetIndexDrawBegin( 2, aDrawBegins );                            // Draw  14+ last candles -- PREF: why a per tick hard-coded SHIFTING / enforced re-draw?
    SetIndexDrawBegin( 3, aDrawBegins );                            // Draw  14+ last candles -- PREF: why a per tick hard-coded SHIFTING / enforced re-draw?

    double A, S1, S2;                                               // auxiliary var for bar-mid-price calculi
    int    Z;                                                       // auxiliary stepper
    int    Opt = IndicatorCounted();                                // Opt ( NEVER RE-USED )

    if (  Opt  <  P ){                                              // if ( ( extern P = 13 ) > IndicatorCounted() )
       // ----------------------- ??? ----------------------------------------------------- NEVER EXEC´d: for( Z = 1++ v/s Z <= 0 )
       for ( Z = 1; Z <= 0; Z++ ) G[T-Z] = 0.0;                     // .STO G[T-Z], 0., BUT NEVER EXEC´d: for( Z = 1++ v/s Z <= 0 )
       for ( Z = 1; Z <= 0; Z++ ) R[T-Z] = 0.0;                     // .STO R[T-Z], 0., BUT NEVER EXEC´d: for( Z = 1++ v/s Z <= 0 )
       // ----------------------- ??? ----------------------------------------------------- NEVER EXEC´d: for( Z = 1++ v/s Z <= 0 )
    }

    Z = T - P - 1;                                                  // .STO Z, ( T = Bars (TRIM´d) ) - ( extern P = 13 ) - 1

    while( Z >= 0 ){                                                // .DEC Z
       //        !!! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ // PERF: very inefficient to RE-calc STATIC ( ( extern P = 13 ) - 1 )-DEEP CONVOLUTIONS per tick !!
       S1 = 0.0; for ( int C = 0; C <= P - 1; C++ ){ S1 = S1 + (   High[Z+C] + Low[Z+C] )           / 2;  }
       S2 = 0.0; for ( int C = 0; C <= P - 1; C++ ){ S2 = S2 + ( ( High[Z+C] + Low[Z+C] ) * ( C+1 ) / 2 );}
       //        !!! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ // PERF: very inefficient to RE-calc STATIC ( ( extern P = 13 ) - 1 )-DEEP CONVOLUTIONS per tick !!
       A  = S1 / S2;
       G[Z] = A;                                                    // .STO G[Z],   A if Z >= 0
       if (  Z > 0 ){ R[Z-1] = A;}                                  // .STO R[Z-1], A if Z >  0
       Z--;
    }

    for ( int N = T - P - 2; N >= 0; N-- ){                         // .STO N, ( T = Bars (TRIM´d) ) - ( extern P = 13 ) - 2
       if (   N > 0 ){                                              // N > 0:
              if ( G[N-1] > G[N] ){ R[N] = EMPTY_VALUE; continue;}  // .BLNK R[N], EMPTY if G[N-1] > G[N]
              if ( G[N-1] < G[N] ){ G[N] = R[N];        continue;}  // .SET  G[N], R[N]  if G[N-1] < G[N]
       }
    // ?? ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ // WHY MANY-TIMES RE-ASSIGNED A CONST. VALUE HERE, INSIDE A FOR(){...}-loop body? -------------- ??
       B3[0] = G[0] + P2;                                           // .STO B3[0], G[0] + ( extern P2 = 0.001 )
       B4[0] = G[0] - P2;                                           // .STO B4[0], G[0] - ( extern P2 = 0.001 )
                                                                    // forced quantise using 2 extra buffers
    // ?? ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ // WHY MANY-TIMES RE-ASSIGNED A CONST. VALUE HERE, INSIDE A FOR(){...}-loop body? -------------- ??
    }
    return(0);
} 
```

* * *

## *新*-`MQL4.56789`语法

**`OnCalculate()`**仅当需要通过`Calculate event`. 这通常发生在收到交易品种的新报价时，指标为其计算。该指标不需要附加到该代码的任何价格图表上。

第一个**`rates_total`**参数包含**`bars`**可用于计算的指标的数量，并且对应于图表中可用的柱数。

我们应该注意返回值**`OnCalculate()`**和第二个输入参数之间的联系**`prev_calculated`**。在`OnCalculate()`函数调用期间，`prev_calculated`参数包含**上一次**`OnCalculate()`调用期间返回的值。这允许计算自定义指标的经济算法，以避免重复计算自上次运行此函数以来未更改的那些柱。

 **为此，通常返回`rates_total`参数的值就足够了，其中包含当前函数调用中的柱数。如果自上次调用`OnCalculate()`价格数据以来发生了变化（下载了更深的历史记录或填充了历史空白），输入参数的值`prev_calculated` **将被终端设置为零。**

```
//+------------------------------------------------------------------+ 
//| Custom indicator iteration function                              | 
//+------------------------------------------------------------------+ 
int  OnCalculate( const      int  rates_total,
                  const      int  prev_calculated,
                  const datetime &time[],
                  const   double &open[],
                  const   double &high[],
                  const   double &low[],
                  const   double &close[],
                  const     long &tick_volume[],
                  const     long &volume[],
                  const      int &spread[]
                  )
  {
  // Get the number of bars available now for the current Symbol and chart period 
     int barsNow = Bars( _Symbol, PERIOD_CURRENT );

  // .RET value of prev_calculated for a next call
     return( rates_total );
  } 
```**

# javascript - 使用 Javascript 更改 CSS 属性

> ID：11440202
> 
> 赞同：0
> 
> 时间：2012-07-11T19:41:38.473
> 
> 标签：javascript

由于某种原因，这不会使“errorJS” div 可见。有人可以帮帮我吗？

```
function checkLogin()
    {
        document.getElementById("errors").style.display = "none";
        var form = document.getElementById("form1");
        var problems = false;
        document.getElementById("errorJS").innerHTML = "";
        if(form.email.value.length < 1)
        {
            document.getElementById("errorJS").innerHTML += "Please enter your email address. <br />";
            problems = true;
            document.getElementById("errorJS").style.display = "box";
        }
        if(form.pword.value.length < 1)
        {
            document.getElementById("errorJS").innerHTML += "Please enter your password.";
            problems = true;
            alert(document.getElementById("errorJS").style.display);
            document.getElementById("errorJS").style.display = "box";
        }
        return !(problems);
    } 
```

愚蠢的我，我不敢相信我犯了这个错误。我一直在编码太多的连续时间。感谢大家的回答。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T19:43:27.117

尝试改变：

```
document.getElementById("errorJS").style.display = "box"; 
```

至

```
document.getElementById("errorJS").style.display = "block"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T19:43:47.460

不接受值“box”。它应该是“块”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T19:44:49.627

您可以尝试将这两个实例的 style.display = "box" 更改为 "block" 吗？

[http://www.w3schools.com/cssref/pr_class_display.asp](http://www.w3schools.com/cssref/pr_class_display.asp)

# android - 布局边距中的负像素

> ID：11440207
> 
> 赞同：4
> 
> 时间：2012-07-11T19:41:59.283
> 
> 标签：android

我正在编辑一个开源项目，发现 layout_marginTop 的 -1dp 值导致 Eclipse 中的图形预览因错误而失败。完整的错误消息，可能包括一个额外的错误，是：

```
java.lang.NullPointerException
"-1dp" in attribute "layout_marginTop" is not a valid format.
Exception details are logged in Window > Show View > Error LogThe graphics preview in the layout editor may not be accurate:
Paint.setShadowLayer is not supported. (Ignore for this session) 
```

你知道问题是什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T19:46:10.130

很简单的说：

在给定的情况下，您不能有负边距

因此，您的图形预览不知道如何渲染它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T19:55:39.203

原因是在以前版本的 Android SDK 中允许负边距（最高 2.2？）。负边距以前会引发“未指定的行为”，即它们实际上将布局向负方向移动。我以前使用过该功能，有时它实际上非常有用。

我的猜测是（1）布局靠在屏幕边缘，这就是导致错误的原因，或者（2）现在不再允许负边距并且它们抛出错误。不过我无法确认。

我只是将其更改为零。

# php - PHP没有错误显示但没有获取数据库字段

> ID：11440211
> 
> 赞同：1
> 
> 时间：2012-07-11T19:42:24.060
> 
> 标签：php, mysql

我的数据库字段未填充，但页面正在确认它存在。所以第一个 SQL 正在工作，但第二个没有提取信息。如果我把页面检查出来。它没有找到该页面并重定向到 page_not_found。我这样做对吗？我在这里做错了什么？

```
//get page url and query db
$this_page = $_GET['page'];
$this_page = escape_data($_GET['page']);

//Make sure page exist
$SQL_page_exist = "SELECT page_title FROM learn_more WHERE page_title = '$this_page'";
$SPE_result = mysql_query($SQL_page_exist);
if(mysql_num_rows($SPE_result) == 0) 
{
    echo '<META HTTP-EQUIV="Refresh" Content="0; URL=page_not_found.php">';
}
else {

$SQL = 
   "SELECT  * FROM learn_more AS lm 

INNER JOIN  learn_more_to_reference_key AS lmtrk 
        ON  lm.id = lmtrk.learn_more_id 

INNER JOIN  reference_keys AS rk 
        ON  rk.keys_id = lmtrk.reference_key_id

     WHERE  page_title = '$this_page'";

$result = mysql_query($SQL);

while ($db_field = mysql_fetch_assoc($result));
{   
        $id               =     $db_field['ID'];
        $main_title       =     $db_field['main_title'];
        $main_content     =     $db_field['main_content'];
        $reference_keys   =     $db_field['keys_href']; 
        $sub_title        =     $db_field['sub_title'];
        $sub_content      =     $db_field['sub_content'];
}
}
mysql_close($dbc); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T19:50:52.867

您应该删除 while 语句后的分号，因为它不会执行以下附件（这意味着您的查询很好，但 while 语句无效）。

另外，我不确定，但声明：

```
$id     =     $db_field['ID']; 
```

如果 mysql 字段为“id”（小写），可能会产生错误。虽然 MySQL（通常）不区分大小写，但 php 数组键是，所以可能键只能作为“id”而不是“ID”......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T20:29:32.043

事实证明，设置为非空的关系数据库表（只有 1 个黑色字段）中的空字段导致了这个未定义的中断错误。在除主页之外的所有页面上。

感谢所有试图帮助我的人。

# jquery - jQuery 插件和动态生成的表单

> ID：11440212
> 
> 赞同：0
> 
> 时间：2012-07-11T19:42:33.583
> 
> 标签：jquery, jquery-plugins

我在我的新项目中使用了两个 jQuery 插件：

```
$("input[type=text].color").miniColors();
$("input[type=file], input[type=radio], input[type=checkbox], select").uniform(); 
```

在这个项目中，我有多个使用 jQuery 动态构建的上传表单——我有一个隐藏的容器，里面`<div>`有多个表单元素。根据用户的选择，需要的元素被添加到具有`html()`功能的表单中。

用户可以使用选项卡（Twitter Bootstrap）在多种类型的表单之间切换。

我注意到插件在这些表单元素上无法正常工作。

是否有可能将函数绑定到具有`live()`函数的表单，或者有其他方法吗？

** 编辑 ** 正在使用以下功能构建表单：

```
function buildForm(target)
{
    var form = $("#" + target);

    switch(target){
        case 'image':
            form.html($("#wrapper-title").html() + $("#wrapper-src").html());
            break;
        case 'generate':
            form.html($("#wrapper-title").html() + $("#wrapper-src").html() + $("#wrapper-generate").html());
            break;
        case 'video':
            form.html($("#wrapper-title").html() + $("#wrapper-url").html());
            break;
        case 'text':
            form.html($("#wrapper-title").html() + $("#wrapper-body").html());
            break;
    }
} 
```

所有元素都放置在表单之外，并`<form>`在用户更改表单类型时在标签之间移动。

什么不起作用？例如，在 Uniform 插件中，单选/选择按钮的状态没有改变（图形没有改变）。

干杯!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:17:05.570

`buildForm`在仅针对新添加的表单的 switch/case 语句之后初始化方法内部的插件。

```
function buildForm(target)
{
    var form = $("#" + target);

    switch(target){
        case 'image':
            form.html($("#wrapper-title").html() + $("#wrapper-src").html());
            break;
        case 'generate':
            form.html($("#wrapper-title").html() + $("#wrapper-src").html() + $("#wrapper-generate").html());
            break;
        case 'video':
            form.html($("#wrapper-title").html() + $("#wrapper-url").html());
            break;
        case 'text':
            form.html($("#wrapper-title").html() + $("#wrapper-body").html());
            break;
    }
    $("input[type=text].color", form).miniColors();
    $("input[type=file], input[type=radio], input[type=checkbox], select", form).uniform();
} 
```

# extjs - 如何禁用 ExtJS 网格中的控件？

> ID：11440216
> 
> 赞同：2
> 
> 时间：2012-07-11T19:42:54.830
> 
> 标签：extjs, extjs3

我正在使用 ExtJs 3.4。我在 ExtJs 网格中有一个复选框控件。我想根据商店中的值何时等于零来禁用复选框控件。

我已经尝试过了，它并没有禁用它：

```
var colModel = new Ext.grid.ColumnModel(
    {
        columns: [
            { id: 'AircraftOid', header: "AircraftOid", width: 100, sortable: true, locked: true, dataIndex: 'AircraftOid', hidden: true },
            { id: 'nNumber', header: "N-#", width: 100, sortable: true, locked: true, dataIndex: 'NNumber' },
            { header: "Make", width: 150, sortable: true, dataIndex: 'Make' },
            { header: "Model", width: 150, sortable: true, dataIndex: 'Model' },
            { header: "Register",
                width: 55,
                sortable: true,
                dataIndex: 'Register',
                xtype: 'checkcolumn'
            }
        ],
        isCellEditable: function (col, row) {
            return false;
        }
    });

var grid = new Ext.grid.GridPanel({
        store: aircraftStore,
        cm: colModel,
        sm: new Ext.grid.RowSelectionModel({ singleSelect: true }),
        viewConfig: {
            forceFit: true
        },
        height: 100,
        split: true,
        region: 'north'
    }); 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T22:22:55.050

你的想法是对的。但...

首先，您要覆盖列模型的**isCellEditable**方法以防止编辑。但 Grid 不调用该方法。它**仅适用于 EditorGrid**。

其次，**Ext.ux.grid.CheckColumn**不处理任何可编辑的功能，因为它**不是一个编辑器**，它**只是一个列**。

因此，对于我的项目，我对其进行了修改以充当编辑器，并添加了 readOnly 属性以防止在普通网格上进行编辑。如果将 readOnly 设置为 true，它将不再可点击。

```
Ext.ux.grid.CheckColumn = Ext.extend(Ext.grid.Column, {
    processEvent : function(name, e, grid, rowIndex, colIndex) {
        if ( !this.readOnly && name == 'mousedown' ) {
            grid.stopEditing();
            var record = grid.store.getAt(rowIndex);
            var cm = grid.getColumnModel();
            var edit_e = {
                grid: grid,
                record: record,
                field: this.dataIndex,
                value: record.data[this.dataIndex],
                row: rowIndex,
                column: colIndex,
                cancel: false
            };
            if ( grid.fireEvent( 'beforeedit', edit_e ) !== false && !edit_e.cancel ) {
                record.set( this.dataIndex, !record.data[this.dataIndex] );
                edit_e.cancel = null;
                grid.fireEvent( 'afteredit', edit_e );
            }
            return false;
        } else {
            return Ext.grid.ActionColumn.superclass.processEvent.apply(this, arguments);
        }
    },

    editable : false,

    readOnly : false,

    renderer : function(v, p, record){
        p.css += ' x-grid3-check-col-td'; 
        return String.format('<div class="x-grid3-check-col{0}">&#160;</div>', v ? '-on' : '');
    },

    init: Ext.emptyFn
});

Ext.preg('checkcolumn', Ext.ux.grid.CheckColumn);

Ext.grid.CheckColumn = Ext.ux.grid.CheckColumn;

Ext.grid.Column.types.checkcolumn = Ext.ux.grid.CheckColumn; 
```

# apache - cx_Oracle 在 mod_wsgi 环境下运行

> ID：11440219
> 
> 赞同：1
> 
> 时间：2012-07-11T19:43:00.987
> 
> 标签：apache, centos, mod-wsgi, redhat, cx-oracle

我在 CentOS 6.2 上安装了 cx_Oracle。当我从 shell 导入库时，它工作正常，但是当我通过 wsgi 启动它时，我收到错误：

```
ImportError: libclntsh.so.10.1: cannot open shared object file: No such file or directory 
```

这是一个环境变量问题：cx_Oracle 没有找到 lib 的路径。

我已经尝试过[这里提供的解决方案](http://code.google.com/p/modwsgi/wiki/InstallationIssues#Unable_To_Find_Python_Shared_Library)

我在 /usr/lib 目录中添加了指向 libclntsh.so.10.1（带有 ln）的链接

我已经编辑了 apache 配置并添加了：

```
ORACLE_HOME=/usr/lib/oracle/11.2/client64/lib
LD_LIBRARY_PATH=$ORACLE_HOME/
PATH=$ORACLE_HOME/bin:$PATH 
```

我编辑了 /etc/ld.so.conf 并添加了：

```
/usr/lib/oracle/11.2/client64/lib 
```

在 ldconfig 之后完成

我尝试将python与：

```
os.env['ORACLE_HOME']='/usr/lib/oracle/11.2/client64/lib' 
```

我编辑了 bashrc：

```
export ORACLE_HOME=/usr/lib/oracle/11.2/client64/lib
export LD_LIBRARY_PATH=$ORACLE_HOME/
export PATH=$ORACLE_HOME/bin:$PATH 
```

我还编辑了 apachectl

```
ORACLE_HOME=/usr/lib/oracle/11.2/client64/lib
export ORACLE_HOME
LD_LIBRARY_PATH=$ORACLE_HOME/
export LD_LIBRARY_PATH
PATH=$ORACLE_HOME/bin:$PATH
export PATH 
```

我的想法不多了。有什么建议么 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T22:53:31.097

为 Oracle 编译 Python 模块时，设置：

```
LD_RUN_PATH=/usr/lib/oracle/11.2/client64/lib 
```

用户环境变量并导出。这将导致该目录嵌入到 Python 扩展模块 .so 文件中，并且无需设置 LD_LIBRARY_PATH 环境变量即可在运行时知道在哪里找到它。

对于标准的 Apache 发行版（Linux 发行版通常有点不同），用于设置额外环境变量的文件称为“envvars”，并且与“httpd”位于同一目录中。对于 Linux 发行版，通常需要在一个特殊的 init.d 启动脚本中。

因此，查找 LD_RUN_PATH 的全部内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T12:31:18.877

我没有在 cx_Oracle rpm 上使用*yum install*，而是下载了库的源代码并运行 setup.py 构建。

我遇到了一个错误，它将指向试图在以下位置找到即时客户端 sdk 库的函数：

```
possibleIncludeDirs = ["rdbms/demo", "rdbms/public", "network/public","sdk/include"] 
```

浏览 Oracle_home 文件夹，我发现安装在 lib 文件夹中的 sdk 文件（我在 oracle 的 rpm 上使用 yum install 安装了 skd），而不是在 setup.py 中建议的*possibleIncludeDirs*或包含文件夹中：

```
if not includeDirs:
        path = os.path.join(oracleLibDir, "include")
        if os.path.isdir(path):
            includeDirs.append(path)
    if not includeDirs:
        path = re.sub("lib(64)?", "include", oracleHome)
        if os.path.isdir(path):
            includeDirs.append(path) 
```

我下载了即时客户端 sdk（这次是**zip**文件）并将其解压缩到 lib 文件夹。

然后lib文件夹中有一个sdk文件夹（/usr/lib/oracle/11.2/client64/lib）

然后我启动了 setup.py build 和 setup.py install 并且它起作用了。

# python - 如何在Django中更新/修改表后自动调用views.py中的方法？

> ID：11440229
> 
> 赞同：0
> 
> 时间：2012-07-11T19:43:25.297
> 
> 标签：python, email, django-models, django-views

我正在构建一个基于 Web 的应用程序，在其中我需要`E-mail`在更新或修改表中的某些值之后将通知发送给注册用户。

我有一个`model.py`：

```
class ProileComment(models.Model):
    comment = models.TextField()
    user = models.CharField(max_length=30, null=False, blank=True)
    timestamp = models.DateTimeField(null=False, blank=True) 
```

方法在`views.py`

```
def send_email(request):
   ## 
```

根据我的问题，如果`ProfileComment`模型会更新，那么它应该自动调用该`send_email`方法。这样该用户将收到有关数据库更改的通知。我应该如何进行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T19:49:34.037

您可以使用 django[信号](https://docs.djangoproject.com/en/dev/topics/signals/)！

[https://docs.djangoproject.com/en/dev/ref/signals/](https://docs.djangoproject.com/en/dev/ref/signals/)

它们允许您注册一个信号监听器。也许 pre_save 信号最适合您的需求？每当您的应用程序中的任何位置保存某些内容时，都会调用您的信号，您可以根据模型或您需要的任何其他条件做出决定。

或者，如果您只想为那个模型发送电子邮件，您可以覆盖该`save`方法！

```
class ProfileComment(models.Model):

    def save(self, *args, **kwargs):
      # send email?
      super(ProfileComent, self, *args, **kwargs) # make sure to call parent! 
```

# c# - “调用线程必须是 STA，因为很多 UI 组件都需要这个。” WPF

> ID：11440237
> 
> 赞同：1
> 
> 时间：2012-07-11T19:43:52.537
> 
> 标签：c#, .net, wpf

我遇到了 InvalidOperationException 消息“调用线程必须是 STA，因为许多 UI 组件都需要这个。” 在严重依赖引用库的 WPF 应用程序中。

我试图确定错误的来源，使用各种线程和对象的调度程序，确保 main() 具有 STAthread 属性，尝试在看似相关的方法上设置“[STAThread]”。

在 MyParticipant 构造函数内部，由于正在构造继承 VideoRenderer 的 MyVideoRenderer pic，因此 VideoRenderer 构造函数本身正在抛出此异常，而不是进入构造函数。

代码：

```
public class MyParticipant : Participant           //inside MainWindow.xaml.cs
    {
        public enum PictureMode
        {
            Avatar,
            Video
        }

        public PictureMode pictureMode = PictureMode.Avatar;

        public ProgressBar voiceVolume;
        public Label nameLabel;
        public MyVideoRenderer pic;
        public MyVideo video;

        public bool isCachedInClient = false;   
        public string displayName = null;
        public Image avatarImage = null;

        public static int picHeight = 480;
        public static int piclWidth = 640;
        public static int panelHeight = 155;
        public static int panelWidth = 174;

        public static Color liveColor = SystemColors.GradientActiveCaptionColor;
        public static Color nonLiveColor = SystemColors.GradientInactiveCaptionColor;

        public MyParticipant(uint objectId, VideoManager videoManager)
            : base(objectId, videoManager)
        {
            pic = new MyVideoRenderer(videoManagerRef)   
            {
                //Top = 5,
                //Left = 5,
                Height = picHeight,
                Width = piclWidth,
                //SizeMode = PictureBoxSizeMode.StretchImage
            };
...

public class VideoRenderer : System.Windows.Controls.Image         //referenced external class
{
    public VideoRenderer(VideoManagerRoot videoManager)        ///Exception here
    {
        this.videoManagerRef = videoManager;
    }
... 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-11T19:57:04.363

我的猜测是您正在从后台线程创建 UI 元素，这是导致异常的原因。

读：

*   [the-calling-thread-must-be-sta-because-many-ui-components-require-this-error](https://stackoverflow.com/questions/1699181/the-calling-thread-must-be-sta-because-many-ui-components-require-this-error), or
*   [the-calling-thread-must-be-sta-because-many-ui-components-require-this](https://stackoverflow.com/questions/2329978/the-calling-thread-must-be-sta-because-many-ui-components-require-this)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T14:35:49.977

Solved, thanks to Rafal's post:

The problem is that the thread that was creating a new MyParticipant was being default set to MTA, and so inside MyParticipant, that MTA thread was calling new VideoRenderer, which inherits an Image. An MTA thread constructing a UI control results in this exception.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-01-23T11:06:37.893

In (WPF Application) Project Properties make sure that Startup object is set to (Not Set). That solved problem in my case.

# winforms - 需要有关使用 TPL 的 COM 行为的帮助

> ID：11440239
> 
> 赞同：1
> 
> 时间：2012-07-11T19:43:54.723
> 
> 标签：winforms, com, console, task-parallel-library

我需要一些帮助来了解 STA 和 MTA 在 winform 和控制台应用程序方面的区别。我正在使用第三方 COM 接口来并行执行函数，使用 parallel.invoke。当我在控制台应用程序中执行此操作时，一切正常，代码实际上是并行运行的。但是当我在 Winform 中做同样的事情时，它是顺序的，如果我删除 winform 入口点上方的 STAtrhread 标签，它开始并行工作。任何人都可以解释这种行为吗？，任何建议都会很好！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:16:31.917

COM 有一个在.NET 中完全没有的特性。COM 类可以指定它是否是线程安全的。它使用注册表中名为 ThreadingModel 的键来执行此操作。就像大多数 .NET 类一样，绝大多数 COM 类都不是线程安全的，因此它们指定“Apartment”。这是一个有点晦涩的术语，意味着“只从创建我的线程中调用我”。它自动提供线程安全。

为使其工作，创建 COM 对象的线程必须表明它愿意为非线程安全的 COM 类提供何种支持。STA 线程是安全的家。要求是线程泵送消息循环，就像任何 UI 线程一样。消息循环是 COM 编组从工作线程到创建对象的线程的调用的机制。加入 MTA 的线程明确表示它不*提供*支持。

COM 必须对 MTA 线程做一些事情，它们不适用于非线程安全的 COM 对象。它创建一个*新*线程，一个 STA 线程，为 COM 对象提供一个安全的家。这非常低效，每个方法调用都必须编组。并且有风险的是，如果 COM 类的对象在内部共享状态，它可能仍然是线程不安全的。

因此，在您的 Winforms 案例中发生的是您在主线程上创建了所有对象，这是一个 STA。并从并行工作线程进行调用，这些调用都被编组并序列化回 STA 线程。不可避免地，它们一个接一个地执行，而您没有并发。

In your Console case, you created them on an MTA thread. So COM is forced to create threads for each object. The method calls on your worker threads are still marshaled, but now to multiple threads. So now you *do* get concurrency, at the cost of significant overhead, a bunch of extra threads. And the risk of failure when the server shares state internally.

Make the Winforms case the same as the Console case by creating the COM objects on a worker thread. Do test it very thoroughly.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T19:48:51.510

STA 和 MTA 都是 COM/ActiveX 的“线程模型”，可以追溯到 1990 年代中期。

这是一个很好的链接：

*   [http://msdn.microsoft.com/en-us/library/ms809971.aspx](http://msdn.microsoft.com/en-us/library/ms809971.aspx)

> *   STA：
> 
> 一个进程对于每个调用 CoInitialize 的线程都有一个单线程单元 (STA)。反过来，这些公寓中的每一个都可能有零个或多个与之关联的 COM 对象。然而，顾名思义，只有一个特定线程（通过调用 CoInitialize 创建单元的线程）可以直接访问单元内的对象
> 
> *   MTA：
> 
> 尽管多线程单元（有时称为自由线程单元）是一个更简单的模型，但它们更难开发，因为开发人员必须为对象实现线程同步，这是一项非常重要的任务。从积极的方面来说，删除 STA 的同步机制可以让开发人员更好地控制线程同步的使用。他们可以将其应用到实际需要的地方，而不是采用非常保守的 STA 方法，即同步访问整个公寓。

一个问题是为您的组件选择最佳线程模型（默认为 STA、IIRC）。另一个问题是，如果您需要在组件和使用不同线程模型的组件之间编组数据，运行时会做什么。上面的链接讨论了两者。

# regex - mod_rewrite 条件 - 匹配“someword/”但不匹配“someword/anotherword/”

> ID：11440245
> 
> 赞同：0
> 
> 时间：2012-07-11T19:44:19.973
> 
> 标签：regex, .htaccess, mod-rewrite

我正在尝试重写一个 URL，例如

> [http://www.example.com/someword/](http://www.example.com/someword/)

至

> [http://www.example.com/someword/index/](http://www.example.com/someword/index/)

但离开

> [http://www.example.com/someword/anotherword/](http://www.example.com/someword/anotherword/)

原封不动。

我相当肯定这应该很容易完成，但我对正则表达式并不那么精通，过去几个小时我一直在通过谷歌搜索的正则表达式指南进行挖掘，到目前为止我还没有解决方案。

> [-a-zA-Z0-9_]*/.+

足以给我想要的相反的东西（匹配“someword/anotherword/”，而不仅仅是“someword/”）。我需要相反，只匹配“someword/”而不是“someword/anotherword/”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:05:29.263

尝试这个：

```
[-a-zA-Z0-9_]*/$ 
```

简单快速的教程：

```
.+ means any chracter one or more times
.* any character 0 or more times
$ is end of line 
```

# facebook-opengraph - 上传相册而不发布到用户的动态消息

> ID：11440246
> 
> 赞同：0
> 
> 时间：2012-07-11T19:44:20.133
> 
> 标签：facebook-opengraph, photos, feed

有没有办法创建相册而不在用户的新闻提要上传播它们？[询问，因为我们的全球客户中有 +3 有兴趣简单地将旧的活动资产存储在记录之外]

* Facebook 团队的 Hugh Durkin 告诉我在 PMD 社区小组提问时将这个问题发布在这里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T20:18:02.773

根据您上传的内容和位置（您没有在问题中指定）添加`no_feed_story`or`no_story`参数应该抑制上传中的新闻提要故事 - （设置为“1”或“真”）

我认为前者用于 OG 操作和页面里程碑，后者用于上传到相册，但我不能 100% 确定它们是否也可以互换

# c# - 可跨平台播放avi和asf的嵌入式流媒体视频播放器

> ID：11440251
> 
> 赞同：0
> 
> 时间：2012-07-11T19:44:41.360
> 
> 标签：c#, asp.net, html, video-streaming

是否有可以执行以下操作的嵌入式视频播放器：

1.  从服务器流式传输视频（保存到磁盘）
2.  跨浏览器运行（或至少提供后备选项）
3.  跨移动设备（Android 和 iOS）运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T19:50:42.437

你研究过 HTML5 吗？视频嵌入，您应该能够从中流式传输。在视频协议方面，您可能需要制作转换器，但 AVI 可能会工作。试一试，我很想知道你发现了什么。

编辑：

链接：

[在 HTML5 中通过 RTSP 或 RTP 流式传输](https://stackoverflow.com/questions/1735933/streaming-via-rtsp-or-rtp-in-html5)

[http://www.pcworld.com/article/191030/how_to_ditch_flash_and_stream_video_with_html5.html](http://www.pcworld.com/article/191030/how_to_ditch_flash_and_stream_video_with_html5.html)

# c# - 多个同时 SQL 连接超时（线程）

> ID：11440253
> 
> 赞同：3
> 
> 时间：2012-07-11T19:44:49.183
> 
> 标签：c#, .net, sql-server-2008, visual-studio-2012

我正在使用一个使用 Parallel.foreach 进行线程处理的控制台应用程序。它是使用 .net 4.5 vs 2012 开发的，用于检索数据并将数据插入到现场的 sql server (2008 r2) 中。所以应该没有网络问题，因为 sql server 是本地的。我的应用程序目前是唯一使用数据库的应用程序，我同时从多个线程获得大量超时。让这更令人困惑的是我可以一遍又一遍地调用这个应用程序，但是有一次我得到了超时。也许这就像增加超时一样简单，但我想知道是否还有其他事情发生

这是我正在调用的存储过程

```
Select table.Id from Table WITH (NOLOCK)
        inner join table2 c WITH (NOLOCK) on c.Id = table.TableId 
        inner join Table3_xref  x WITH (NOLOCK) on x.TableID = c.id 
        inner join Table4 p WITH (NOLOCK)  on p.id = x.id 
        where 
         value = @Parm1
         and p.Value1 = @Parm2
         and c.Value2 = @Parm3
         and Table.Void = 0 
```

这是例外

System.Data.SqlClient.SqlException (0x80131904)：超时已过期。在操作完成之前超时时间已过或服务器没有响应。---> System.ComponentModel.Win32Exception (0x80004005)：等待操作在 System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action 处超时`1 wrapCloseInAction) at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction) 在 System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose) 在 System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject state&Obj, Boolean dataReady) 在 System.Data.SqlClient.SqlDataReader.TryConsumeMetaData() 在 System.Data.SqlClient.SqlDataReader.get_MetaData() 在 System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString) 在 System.Data System.Data 中的 .SqlClient.SqlCommand.RunExecuteReaderTds（CommandBehavior cmdBehavior，RunBehavior runBehavior，布尔 returnStream，布尔异步，Int32 超时，任务和任务，布尔异步写入）。System.Data.SqlClient.SqlCommand.RunExecuteReader（CommandBehavior cmdBehavior，RunBehavior runBehavior，Boolean returnStream，String 方法）在 System.Data.SqlClient.SqlCommand.ExecuteReader（CommandBehavior 行为，String 方法）在 System.Data.SqlClient.SqlCommand.ExecuteDbDataReader（CommandBehavior 行为）在 System.Data.Common.DbCommand.System.Data.IDbCommand .ExecuteReader()System.Data.SqlClient.SqlCommand.ExecuteReader（CommandBehavior 行为，String 方法）处 System.Data.SqlClient.SqlCommand.ExecuteDbDataReader（CommandBehavior 行为）处的 RunExecuteReader（CommandBehavior cmdBehavior，RunBehavior runBehavior，布尔 returnStream，String 方法）。 Common.DbCommand.System.Data.IDbCommand.ExecuteReader()System.Data.SqlClient.SqlCommand.ExecuteReader（CommandBehavior 行为，String 方法）处 System.Data.SqlClient.SqlCommand.ExecuteDbDataReader（CommandBehavior 行为）处的 RunExecuteReader（CommandBehavior cmdBehavior，RunBehavior runBehavior，布尔 returnStream，String 方法）。 Common.DbCommand.System.Data.IDbCommand.ExecuteReader()

这就是我的代码的样子

```
 try
            {
                using (DbConnection con = Database.CreateConnection())
                {
                    IDbCommand cmd = new SqlCommand(sSQL, (SqlConnection)con);
                    cmd.CommandType = CommandType.StoredProcedure;
                    con.Open();
                    IDataReader reader = cmd.ExecuteReader();
                    if (reader.Read())
                    {
                        result = true;
                    }
                }
             } 
```

一段时间后，程序能够恢复并继续其任务。我会认为这与[此](https://stackoverflow.com/questions/5884876/multiple-simultaneous-sql-connection-timeouts-in-multithreaded-windows-service)重复，但我没有使用数据库镜像，并且在 connection.open 上没有发生这种情况

我可以增加默认的超时时间，但我不确定这应该是一个问题。

# ajax - 天气频道脚本嵌入

> ID：11440258
> 
> 赞同：0
> 
> 时间：2012-07-11T19:45:00.320
> 
> 标签：ajax, embed, weather

我似乎无法让这个天气频道脚本在我的主页上运行。我最初从 TWC 收到了这个脚本：

```
document.write('<scr'+'ipt src="'+document.location.protocol+'//wow.weather.com/weather/wow/module/'+wx_locID+'?config='+wx_config+'&proto='+document.location.protocol+'&target='+wx_targetDiv+'"></scr'+'ipt>'); 
```

我收到了对使用 jQuery 的 AJAX getScript 方法的 Google 论坛帖子的回复，该方法似乎可以在在线编辑器 JSFiddle 中使用。

```
$(function () {
    $.getScript(document.location.protocol + '//wow.weather.com/weather/wow/module/' + wx_locID + '?config=' + wx_config + '&proto=' + document.location.protocol + '&target=' + wx_targetDiv);
}); 
```

它仍然无法在页面上运行，并导致脚本的其余部分也不显示。

```
 <body>
    <div id="chart_div" style="width: 900px; height: 500px;"></div>
<div id="wx_module_1232">
   <a href="http://www.weather.com/weather/local/98501">Olympia Weather Forecast, WA (98501)</a>
</div>
  </body> 
```

它可能只是我缺少的 AJAX 导入，因为我是网站建设的新手。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T19:52:29.473

您似乎缺少变量的值`wx_locID`：`wx_config`和`wx_targetDiv`。您是否忘记复制这些必需的变量？

# javascript - 具有相同类的多个锚标记。找到被点击的锚标签？

> ID：11440260
> 
> 赞同：0
> 
> 时间：2012-07-11T19:45:06.577
> 
> 标签：javascript, jquery

我有 html，其中有多个具有相同类的锚标记。Juqey 只选择第一个锚标签。即使我单击其他锚标记，它也会返回第一个锚标记 href 值。我想要 jquery 应该找到在 DOM 中单击的锚标记并获取该锚标记 href 值。

我想将此 href 值设置为 var 并将该 var 用于其他 fn。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T19:56:25.710

很简单：

```
 $(document).ready(function () {
  jQuery('.className').click(function (event) {

    var hr = $(this).attr("href");
    alert(hr);
  });
 }); 
```

# android - 使用 Android 从 web 服务解析 JSON 文件

> ID：11440261
> 
> 赞同：0
> 
> 时间：2012-07-11T19:45:08.143
> 
> 标签：android, json, web-services

我在这里发帖是为了解决我自己的项目问题。

我想从我的 Android 应用程序连接到我的网络服务，并将这些信息获取到好的来源。我正在使用 JSON 文件（非常好），但只包含 JSON 对象。

我使用了这个非常好的来源（在他的例子中工作得很好）：[http ://www.androidhive.info/2012/01/android-json-parsing-tutorial/](http://www.androidhive.info/2012/01/android-json-parsing-tutorial/)

您可以查看我的 JSON 文件：

```
[
    {
        "id": "2",
        "title": "Printemps du cinema",
        "content": "Decouvrez plein de nouveaux films durant la semaine du printemps du cinema.",
        "date": "2012-07-04",
        "author": "Nicolas  Jeannin",
        "zone": "Mandelieu",
        "area": "Cannes"
    },
    {
        "id": "4",
        "title": "Festival de Cannes",
        "content": "Venez assister a la montee des marches du prestigieux festival !",
        "date": "2012-05-26",
        "author": "Nicolas Teboul",
        "zone": "Cannes",
        "area": "Cannes"
    }
] 
```

我尝试使用他的方法使其运行，但使用由 1 个元素组成的 JSON 数组。我总是有类似的错误：

“解析数据时出错 org.json.Excption:Value[{"content":".........}] ..无法转换为 JSONObject。”

您可以在下面查看我的活动：

```
public class AndroidJSONParsingActivity extends ListActivity 
{

    // url to make request
    private static String url = "http://developer.prixo.fr/API/GetEvents?zone=8";
    //private static String url = "http://twitter.com/statuses/public_timeline.json";
    //private static String url = "http://api.androidhive.info/contacts/";

    //JSON names
    private static final String TAG_content = "content";
    private static final String TAG_zone = "zone";
    private static final String TAG_id = "id";
    private static final String TAG_area = "area";
    private static final String TAG_title = "title";
    private static final String TAG_date = "date";
    private static final String TAG_author = "author";

    @Override
    public void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        // Hashmap for ListView
        ArrayList<HashMap<String, String>> newsList = new ArrayList<HashMap<String, String>>();

        JSONArray event = null; 

        // Creating JSON Parser instance
        JSONParser jParser = new JSONParser();

        // getting JSON string from URL
        JSONObject json = jParser.getJSONFromUrl(url);

        try {
                // Getting Array of Contacts
                event = json.getJSONArray("");

                JSONObject c = event.getJSONObject(0);

                // Storing each json item in variable

                String id = c.getString(TAG_id);
                String title = c.getString(TAG_title);
                String content = c.getString(TAG_content);
                String date = c.getString(TAG_date);
                String author = c.getString(TAG_author);
                String zone = c.getString(TAG_zone);
                String area = c.getString(TAG_area);

                // creating new HashMap
                HashMap<String, String> map = new HashMap<String, String>();

                // adding each child node to HashMap key => value
                map.put(TAG_content, content);
                map.put(TAG_title, title);
                map.put(TAG_author, author);

                // adding HashList to ArrayList
                newsList.add(map);
            }
        catch (JSONException e) {
            e.printStackTrace();
        }
        /**
         * Updating parsed JSON data into ListView
         * */
        ListAdapter adapter = new SimpleAdapter(this, newsList,R.layout.list_item,new String[] { TAG_content, TAG_title, TAG_author }, new int[] {R.id.name, R.id.email, R.id.mobile });
        setListAdapter(adapter);

        // selecting single ListView item
        ListView lv = getListView();

        // Launching new screen on Selecting Single ListItem
        lv.setOnItemClickListener(new OnItemClickListener() 
        {
            public void onItemClick(AdapterView<?> parent, View view,
                    int position, long id) {
                // getting values from selected ListItem
                String name = ((TextView) view.findViewById(R.id.name)).getText().toString();
                String cost = ((TextView) view.findViewById(R.id.email)).getText().toString();
                String description = ((TextView) view.findViewById(R.id.mobile)).getText().toString();

                // Starting new intent
                Intent in = new Intent(getApplicationContext(), SingleMenuItemActivity.class);
                in.putExtra(TAG_content, name);
                in.putExtra(TAG_title, cost);
                in.putExtra(TAG_author, description);
                startActivity(in);

            }
        });
    }

} 
```

这是 JSONParser ：

```
package com.androidhive.jsonparsing;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.UnsupportedEncodingException;

import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.json.JSONException;
import org.json.JSONObject;

import android.util.Log;

public class JSONParser {

    static InputStream is = null;
    static JSONObject jObj = null;
    static String jsonstr = "";

    // constructor
    public JSONParser() {
    }

    public JSONObject getJSONFromUrl(String url) {

        // Making HTTP request
        try {
            // defaultHttpClient
            DefaultHttpClient httpClient = new DefaultHttpClient();
            HttpPost httpPost = new HttpPost(url);
            //HttpGet httpGet = new HttpGet(url);

            //HttpResponse httpResponse = httpClient.execute(httpGet);
            HttpResponse httpResponse = httpClient.execute(httpPost);
            HttpEntity httpEntity = httpResponse.getEntity();
            is = httpEntity.getContent();           

        } catch (UnsupportedEncodingException e) {
            e.printStackTrace();
        } catch (ClientProtocolException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }

        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(is, "iso-8859-1"), 8);
            StringBuilder sb = new StringBuilder();
            String line = null;
            while ((line = reader.readLine()) != null) {
                sb.append(line + "n");
            }
            is.close();
            jsonstr = sb.toString();
        } catch (Exception e) {
            Log.e("Buffer Error", "Error converting result " + e.toString());
        }

        // try parse the string to a JSON object
        try {
            jObj = new JSONObject(jsonstr);
        } catch (JSONException e) {
            Log.e("JSON Parser", "Error parsing de Mon fichier: " + e.toString());
        }

        // return JSON String
        return jObj;
     }
} 
```

感谢帮助我的人。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T19:58:56.650

这是因为您的 JSON 定义了一个 JSON 数组，并且您尝试将其解析为 JSON 对象 - 在您的解析器类中将其更改为 JSONArray，您会没事的。

另一个问题是 memorz 管理 - 您正在重新分配字符串并使用 android.json 提供的 vanilla JSON 解析器进行解析。这可行，但内存消耗严重且分配量很大——对于更大的数据来说相当慢。改用拉解析器（如 GSON，缩小版只有 16K）

您还可以考虑使用某种数据绑定从 JSON 中创建 java 对象 - 您可以获取我的库（也可以在 maven Central 上找到）：

[https://github.com/ko5tik/jsonserializer](https://github.com/ko5tik/jsonserializer)

然后它会很简单：

```
 InputStream inputStream = getResources().openRawResource(preferences.getRecognitionConfig());
        InputStreamReader reader = new InputStreamReader(inputStream);

        JsonReader jreader = new JsonReader(reader);          
        jreader.setLenient(true);
        final RecognitionDataContainer recognitionContainer = JSONUnmarshaller.unmarshall(jreader, RecognitionDataContainer.class);

        reader.close(); 
```

（RecognitionDataContainer 是类似于 JSON 结构的顶级对象）

# python - 在 Python 中使用 FRED API 时遇到问题 - 无法加载模块

> ID：11440263
> 
> 赞同：1
> 
> 时间：2012-07-11T19:45:26.263
> 
> 标签：python, import, module, installation, economics

我正在尝试将此 API 用于美联储经济数据 (FRED)： [https ://github.com/zachwill/fred](https://github.com/zachwill/fred)

我安装了文档说需要的三个模块。我收到此错误：

```
import fred

Traceback (most recent call last):
  File "<pyshell#0>", line 1, in <module>
    import fred
  File "build\bdist.win32\egg\fred\__init__.py", line 1, in <module>
    # Dummy file to make this a package.
  File "build\bdist.win32\egg\fred\fred.py", line 21, in <module>
ImportError: cannot import name xml2dict 
```

然后我安装了 xml2dict 并再次安装了 fred。当我现在先导入 xml2dict 然后导入 fred 时，我得到了完全相同的错误。

我很难学会在 Python 中安装模块，但我想我终于弄明白了。我似乎无法在这里找到我做错了什么，并且可以使用一些帮助。谢谢！

对于 Zach：这是我目前遇到的问题：

```
Traceback (most recent call last):
  File "<pyshell#3>", line 1, in <module>
    fred.series('GNPCA')
  File "build\bdist.win32\egg\fred\api.py", line 90, in series
    return Fred().series(path, **kwargs)
  File "build\bdist.win32\egg\fred\core.py", line 100, in series
    return self.get('series', path, **kwargs)
  File "build\bdist.win32\egg\fred\core.py", line 36, in get
    request = requests.get(url, params=params)
  File "C:\Python26\lib\site-packages\requests-0.13.2-py2.6.egg\requests\api.py", line 54, in get
    return request('get', url, **kwargs)
  File "C:\Python26\lib\site-packages\requests-0.13.2-py2.6.egg\requests\safe_mode.py", line 37,     in wrapped
    return function(method, url, **kwargs)
  File "C:\Python26\lib\site-packages\requests-0.13.2-py2.6.egg\requests\api.py", line 42, in     request
return s.request(method=method, url=url, **kwargs)
  File "C:\Python26\lib\site-packages\requests-0.13.2-py2.6.egg\requests\sessions.py", line 230, in request
    r.send(prefetch=prefetch)
  File "C:\Python26\lib\site-packages\requests-0.13.2-py2.6.egg\requests\models.py", line 601, in send
    raise ConnectionError(e)
ConnectionError: HTTPConnectionPool(host='api.stlouisfed.org', port=80): Max retries exceeded with     url: /fred/series?series_id=GNPCA&api_key= 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T22:45:16.287

I'm the developer of the `fred` package. This is completely my fault — I had the `setup.py` file incorrectly configured, and I just pushed an update that should take care of this issue. Sorry for the confusion!

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-11T20:23:13.953

**一般安装模块的提示：**

通常最简单的方法是使用`pip`or `easy_install`（或二进制安装程序，如果有的话） - 这样您所需要做的就是`easy_install fred`自动下载所需的所有内容（只要配置正确）。

查看[http://pypi.python.org/pypi/setuptools](http://pypi.python.org/pypi/setuptools)上的 setuptools并为您的适当操作系统版本安装它。然后，您将获得一个名为的命令，该命令`easy_install`将根据您的操作系统/设置安装在某个位置（尽管文档确实提到了位置）。[你也可以`easy_install pip`作为`pip`有效`easy_install`的继任者]

Then hopefully, all you need to do is `easy_install fred` (which will automatically find at [http://pypi.python.org/pypi/fred](http://pypi.python.org/pypi/fred)), and it will download the latest version and all dependencies for you. Fire up your interpreter and `import fred` should "just work".

# c# - 在这种情况下，我应该期待什么持久性行为

> ID：11440264
> 
> 赞同：0
> 
> 时间：2012-07-11T19:45:26.917
> 
> 标签：c#, entity-framework, repository-pattern

我有一大块代码，其中包含几个嵌套循环，最终需要更新数据库中的许多记录。我正在尝试尽量减少对实体框架的 SaveChanges() 调用次数。另请注意，我们正在使用存储库模式。

本质上，我正在迭代一个集合，需要更新集合中的项目，并且在每次迭代时，从数据库中检索另一个对象并由集合中的项目进行上下文化。

示例代码：

```
foreach (var outer in outerList)
            {
                obj = unit.GetRepository<MyObj>().Get(s =>
                    s.id = myId
                    ).SingleOrDefault();

                obj.value += outer.value;                    
                outer.objId = obj.objId;

                unit.GetRepository<MyOuterObj>().Update(outerObj);
                unit.GetRepository<MyObj>().Update(obj);                    
            }
            unit.Save(); 
```

对 Update() 的调用执行以下操作：

```
public virtual void Update(T entityToUpdate)
    {
        if(entityToUpdate is AuditModelBase)
        {
            var model = entityToUpdate as AuditModelBase;
            model.UpdatedAt = DateTime.UtcNow;
        }

        DbSet.Attach(entityToUpdate);
        Context.Entry(entityToUpdate).State = EntityState.Modified;
    } 
```

对 Save() 的调用当然会执行以下操作：

```
_context.SaveChanges(); 
```

所以我的问题是，当我每次通过循环将 obj 重新分配给不同的值时，我是否需要在 foreach 循环中保存（）才能使“obj”的所有实例持续存在。或者 DbSet.Attach(obj) 是否确保更新每个单独的实例，无论我对循环中的对象做什么。

或者也许更好的方法是：

*鉴于 Attach() 看起来是通过引用传递的，因此只有我的最后一个 obj 将被更新，EF 完成此类事情的最佳实践是什么（不包括直接调用 SQL 的选项）？*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T19:56:04.310

我认为你不必担心。一旦你调用`Attach`了你的对象，你自己是否保留对它的引用都没有关系。应该没问题。

The thing to keep in mind is that your object lives as long that it's referenced by *someone*. So, it stands to reason that calling `Attach` would cause your `DbSet` to reference your object, thus keeping it alive even after you don't reference it anymore yourself.

However, the best thing to do, in my opinion, is to just give it a try and see what happens!

# php - CakePHP 调试错误找不到 Webroot

> ID：11440267
> 
> 赞同：0
> 
> 时间：2012-07-11T19:45:37.933
> 
> 标签：php, cakephp

我正在使用 Zend Studio 在 Windows 2008 R2 VM 上本地调试 CakePHP 应用程序。当我告诉 Zend 调试 index.php 时，我收到以下错误：

```
Warning: require(webroot\index.php): failed to open stream: No such file or directory in **my directory name**

Fatal error: require(): Failed opening required 'webroot\index.php' 
```

为简洁起见，我的目录名称被省略。

index.php 包含

```
require 'webroot' . DIRECTORY_SEPARATOR . 'index.php'; 
```

本地调试需要哪些更改？

# php - ajax 表单重定向到服务器页面？

> ID：11440272
> 
> 赞同：0
> 
> 时间：2012-07-11T19:46:02.000
> 
> 标签：php, ajax, json, jquery, redirect

我得到了这个 ajax 表单，提交时应该将信息发送到服务器，服务器根据发送的信息决定发送回的表单，然后 ajax 函数应该将该表单加载到页面中，用户应该对背景中的凉爽更明智。表单提交，php 和其他东西处理得很好，发回这个很酷的对象，但是它似乎卡在正在处理它的服务器上的页面上，然后链接到一个只显示返回信息的页面。不酷。这是代码：

```
 $(document).ready(function() { 

        $("#game").ajaxForm(function(json) {
            if(json.status == 'OK') {
                $("#game").html(json.form);
            }else {
                $(".error_msg").html(json.msg);
            };
        });

    }); 
```

应该发生的是，该函数将 json.form 重写为正确的 div 标记，但它直接转到仅输出 json 对象本身的页面。任何帮助将不胜感激，如果你们需要更多信息，请问！非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T19:49:48.107

JSON 本身将作为对象返回，您必须对其进行解码/解析才能正确显示。

# php - 从文本中提取图像 src？

> ID：11440277
> 
> 赞同：2
> 
> 时间：2012-07-11T19:46:16.033
> 
> 标签：php

我有一个变量 $content ，其中包含这种形式的一些文本和图像（图像数量未知）：

```
 text text text text <img src="path/to/image/1">text text text text
    <img src="path/to/image/2">
text text text text text text text text text text text text text text text text <img src="path/to/image/3"><img src="path/to/image/4">text text text text 
<img src="path/to/image/5"> 
```

我想提取所有图像 src 并使用 php 将它们存储在数组中，如下所示：

```
array(
[1]="path/to/image/1"
[2]="path/to/image/2"
[3]="path/to/image/3"
[4]="path/to/image/4"
[5]="path/to/image/5"
.
.
.
) 
```

做这样的事情的最好方法是什么。我已经尝试过函数 explode 但这种方式似乎效率低下。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-11T19:55:11.963

```
 $dom = new domDocument;
    $dom->loadHTML($html);
    $dom->preserveWhiteSpace = false;
    $imgs  = $dom->getElementsByTagName("img");
    $links = array();
    for($i = 0; $i < $imgs->length; $i++) {
       $links[] = $imgs->item($i)->getAttribute("src");
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-11T19:53:10.323

这是一个使用[simplehtmldom](http://simplehtmldom.sourceforge.net/)的示例：

```
include("simple_html_dom.php");
$content = '
text text text text <img src="path/to/image/1">text text text text
    <img src="path/to/image/2">
text text text text text text text text text text text text text text text text <img src="path/to/image/3"><img src="path/to/image/4">text text text text 
<img src="path/to/image/5"> ';

$html = str_get_html($content);
$images = $html->find("img");
$links = array();
foreach($images as $image) {
  $links[] = $image->src;
}

print_r($links); 
```

输出：

```
Array
(
    [0] => path/to/image/1
    [1] => path/to/image/2
    [2] => path/to/image/3
    [3] => path/to/image/4
    [4] => path/to/image/5
) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-11T20:06:16.237

使用正则表达式：

```
<?php

$str = '    text text text text <img src="path/to/image/1">text text text text
    <img src="path/to/image/2">
text text text text text text text text text text text text text text text text <img src="path/to/image/3"><img src="path/to/image/4">text text text text
<img src="path/to/image/5">';

preg_match_all('@<img.*src="([^"]*)"[^>/]*/?>@Ui', $str, $out);

print_r($out[1]);

?> 
```

输出：

```
Array
(
    [0] => path/to/image/1
    [1] => path/to/image/2
    [2] => path/to/image/3
    [3] => path/to/image/4
    [4] => path/to/image/5
) 
```

# android - ActionbarSherlock menuitem setActionView(null) 不停止旋转

> ID：11440278
> 
> 赞同：0
> 
> 时间：2012-07-11T19:46:17.807
> 
> 标签：android, android-actionbar, actionbarsherlock

让我给你一个简短的场景。

我想在我的操作栏上有一个刷新按钮，它在加载某些东西时切换到 indeterminateProgressStyle （一个旋转的圆圈）。

在我的项目中，我有以下布局。（例如 res/layout/actionbar_indeterminate_progress.xml）

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:gravity="center">
    <ProgressBar android:layout_width="32dp"
        android:layout_height="32dp"
        android:layout_marginLeft="12dp"
        android:layout_marginRight="12dp"
        android:layout_gravity="center"
        style="?android:attr/indeterminateProgressStyle" />
</FrameLayout> 
```

当用户单击刷新按钮时，我执行以下操作。

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    com.actionbarsherlock.view.MenuInflater inflater = getSupportMenuInflater();
    inflater.inflate(R.menu.main, menu);

    refreshMenuItem = menu.findItem(R.id.menu_refresh);

    if (refreshMenuItem != null) {
        // Show refresh button if we are in action bar mode, but only if
        // there's something to be refreshed
        boolean selectedItemExists = (getCurrentBrowsingContainer() != null);
        refreshMenuItem.setVisible(selectedItemExists);
        if (is_spinner_running) {
            refreshMenuItem.setActionView(R.layout.actionbar_indeterminate_progress);
        } else {
            refreshMenuItem.setActionView(null);
        }
    }

    return super.onCreateOptionsMenu(menu);
} 
```

我的 res/menu/main.xml 也如下所示。

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android">
    ...
        <item android:id="@+id/menu_refresh" android:icon="@drawable/ic_menu_refresh" android:showAsAction="always" android:title="@string/refresh" />
    <item android:id="@+id/menu_search" android:title="@string/menu_search" android:icon="@android:drawable/ic_menu_search" android:showAsAction="never" />
    <item android:id="@+id/settings" android:title="@string/settings" android:icon="@android:drawable/ic_menu_preferences"></item>
    <item android:id="@+id/exit" android:title="@string/exit" android:icon="@android:drawable/ic_menu_close_clear_cancel"></item>   
        ...
</menu> 
```

问题是，例如，我以纵向开始我的活动并点击刷新按钮，它很好地停止了。现在我旋转它并再次点击刷新按钮，但现在它出于某种原因继续显示不确定的进度。我检查了， refreshMenuItem.setActionView(null) 被调用，但它仍然继续显示不确定的东西。现在，由于某种原因，refreshMenuItem 似乎不可见，因为当我单击不确定的进度时，没有调用 onOptionsItemSelected。

所以我尝试了一个不同的示例[应用程序](https://stackoverflow.com/questions/11440278/actionbarsherlock-menuitem-setactionviewnull-does-not-stop-rotating)，它可以完美运行，没有任何问题。所以我想知道我哪里出错了。任何指针都会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T12:37:53.033

其实我发现了问题。我的项目之前应该处理配置更改（所以我们在清单中有 configchanges）。使用 actionbarsherlock，它对 configchanges 变得无响应。

现在，由于我们之前没有在配置更改时重新创建活动，因此我们在一些代码中传递了活动，这很好，因为它从未重新创建并且我们负责清理它。但是现在要让 actionbarsherlock 工作，我们必须在 configchanges 上重新创建活动。活动的早期实例仍然存在于代码的某些部分，并且没有被活动的新实例覆盖。所以我试图停止旋转的菜单项实际上属于旧实例，而不是新实例。

所以重构了代码以使用活动的当前实例，一切都很好！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T09:21:56.087

关于单击中间进度时未调用 onOptionsItemSelected：设置操作视图时，它会禁用操作项的默认行为。它还覆盖[先前设置的操作提供者](http://developer.android.com/reference/android/view/MenuItem.html#setActionView%28int%29)。处理动作视图点击的唯一方法是设置 OnClickListener。

关于轮换后不停止的中间进度：我没有确切的这个问题。在我的情况下，当我单击刷新操作项时，中间进度根本不会显示，但如果它是从代码触发的，它会很好地显示出来。我使它工作的方法是将调用 setActionView(...) 的代码移动到[Handler.post(Runnable)](http://developer.android.com/reference/android/os/Handler.html#post%28java.lang.Runnable%29)。

# java - 复制后列表<>对象更改

> ID：11440279
> 
> 赞同：2
> 
> 时间：2012-07-11T19:46:18.167
> 
> 标签：java, android, list

我有以下代码，我在其中创建了一个名为 users 的 List<> 对象。我将用户对象设置为不同的 List<>。然而，一旦我向用户对象添加了一些东西，另一个 List<> 对象的大小也会发生变化？这是什么法术？这应该是这样吗，我以为我只是在复制另一个 List<> 对象。

当我运行此代码时，此日志显示：朋友数量：0 朋友数量：1 朋友数量：1

```
users = new ArrayList<Profile>(); // Friends of this player
        users = game.getUserProfile().getProfileFriends();
        game.getGameLog().d(classTAG, "Amount of Friends: " + game.getUserProfile().getProfileFriends().size());
        users.add(game.getUserProfile());
        game.getGameLog().d(classTAG, "Amount of Friends: " + game.getUserProfile().getProfileFriends().size());
        this.sortUsersAccordingToXP();
        game.getGameLog().d(classTAG, "Amount of Friends: " + game.getUserProfile().getProfileFriends().size()); 
```

注意：这不是所有代码，但代码会影响我的问题，一旦我删除 add 方法，另一个 List<> 的大小就不会增长（当然还有 users 对象）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-11T19:49:20.333

`users = game.getUserProfile().getProfileFriends();`
复制对列表的引用 - 而不是列表！
使用构造函数`ArrayList`来创建一个浅拷贝。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T19:50:27.557

在 Java 中，您处理的是对对象的引用，而不是实际的对象本身。

```
users = game.getUserProfile().getProfileFriends(); 
```

该行不是将原始列表中的内容复制到用户中，而是使用户变量指向与 game.getUserProfile().getProfileFriends() 相同的列表。所以现在 users 和 game.getUserProfile().getProfileFriends() 都引用内存中的同一个列表，所以你没有你想的两个单独的列表。

想想如果 Java 一直在分配和传递整个对象，事情会变得多么低效和昂贵。

要将当前列表的内容复制到新列表中，您只需使用构造函数，该构造函数接受一个 Collection 并将其项目复制到新列表中：

```
users = new ArrayList<Profile>(game.getUserProfile().getProfileFriends()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T19:49:00.333

在你的

```
`users = game.getUserProfile().getProfileFriends();` 
```

通过简单的复制，用户和游戏领域具有相同的参考意义。因此，变化是相互反映的。

# python - GAE 在入站电子邮件中获取信息（标题）

> ID：11440281
> 
> 赞同：1
> 
> 时间：2012-07-11T19:46:36.333
> 
> 标签：python, google-app-engine, email

我在 GAE 上使用 python 2.7。当用户通过浏览器发出请求时，如果他们已登录，我可以获得“元详细信息”，例如 IP、浏览器类型、请求时间和用户对象。

我已设置 GAE 以接收电子邮件。我可以从入站电子邮件中检索到哪些等效的“元详细信息”以及如何获取该信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T20:01:22.233

InboundEmailMessage类具有[可](https://developers.google.com/appengine/docs/python/mail/receivingmail)直接访问的最常用字段。这些都是：

*   学科
*   发件人
*   到
*   抄送
*   日期
*   附件
*   原来的

它还包括`original`将完整消息公开为 Python [email.message.Message](http://docs.python.org/library/email.message.html)的字段- 这允许您访问所有电子邮件标头以及可能更多。

# asp.net - EF 连接错误基础提供程序在打开时失败

> ID：11440284
> 
> 赞同：0
> 
> 时间：2012-07-11T19:46:38.023
> 
> 标签：asp.net, entity-framework, connection-string

```
<add name="EXAMEntities2" connectionString="metadata=res://*/LiveModel.csdl|res://*/LiveModel.ssdl|res://*/LiveModel.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=xx.xx.xxx.xx;initial catalog=EXAM;user id=admin;multipleactiveresultsets=True&quot;" providerName="System.Data.EntityClient" /> 
```

这是我的连接字符串不是有效的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:01:22.487

您正在指定用户 ID，但没有指定密码。

```
<add name="EXAMEntities2" connectionString="metadata=res://*/LiveModel.csdl|res://*/LiveModel.ssdl|res://*/LiveModel.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=xx.xx.xxx.xx;initial catalog=EXAM;user id=admin;password=*****;multipleactiveresultsets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T20:06:44.810

我不喜欢将整个实体框架连接字符串存储在任何`.config`文件中，它太不可读了。因此，我编写了一个方法，将标准字符串转换为有效的实体框架连接字符串：

```
private static string GetEntityConnectionString(string connectionString, 
                                                Type contextType)
{
    string result = string.Empty;

    string prefix = contextType.Namespace
                               .Replace(contextType.Assembly
                                                   .GetName()
                                                   .Name, 
                                        string.Empty);

    if (prefix.Length > 0
        && prefix.StartsWith("."))
    {
        prefix = prefix.Substring(1, prefix.Length - 1);
    }

    if (prefix.Length > 1
        && !prefix.EndsWith("."))
    {
        prefix += ".";
    }

    EntityConnectionStringBuilder csBuilder 
      = new EntityConnectionStringBuilder();

    csBuilder.Provider = "System.Data.SqlClient";
    csBuilder.ProviderConnectionString = connectionString.ToString();
    csBuilder.Metadata = string.Format("res://{0}/{1}.csdl|"
                                       + "res://{0}/{1}.ssdl|"
                                       + "res://{0}/{1}.msl",
                                       contextType.Assembly.FullName,
                                       prefix + contextType.Name);
    result = csBuilder.ToString();
    return result;
} 
```

现在你在配置文件中得到了一个很好的连接字符串：

```
<add name="MyDbConnectionname" 
     connectionString="Data Source=localhost\sqlexpress;Integrated Security=SSPI;MultipleActiveResultSets=true" 
     providerName="System.Data.SqlClient" /> 
```

你这样称呼它：

```
var db = new DbContext(
               DbContext.GetEntityConnectionString(connectionString,
                                                   typeof(DbContext)) 
```

# ios - 连续水平滚动 MKMapView

> ID：11440285
> 
> 赞同：2
> 
> 时间：2012-07-11T19:46:39.243
> 
> 标签：ios, scroll, mkmapview, pan

有没有办法让 iOS 上的 Google MKMapView 能够“持续”水平滚动？Android 允许您不断地向左或向右平移。它使放大太平洋国家变得容易。我 iPhone 上的地图应用程序似乎没有这种行为，但我希望 API 允许我以某种方式对其进行配置。

# php - 显示另一个启用身份验证的页面内容？

> ID：11440292
> 
> 赞同：0
> 
> 时间：2012-07-11T19:47:28.587
> 
> 标签：php, http

如何显示启用了身份验证的其他页面的内容？

警告：file_get_contents(http://abc/report.cmd?report=123)：打开流失败：HTTP 请求失败！HTTP/1.1 401 Authorization Required in //html/tracker/index2.php on line 13

```
 $file_path = 'http://abc/report.cmd?report=123';
    $content=file_get_contents($file_path);
    echo $content; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T19:56:47.990

使用 curl 库进行身份验证

```
<?php
// create a new cURL resource
$curl = curl_init();

// set URL and other appropriate options
curl_setopt($curl, CURLOPT_URL, "http://www.example.com/");
curl_setopt($curl, CURLOPT_HTTPAUTH, CURLAUTH_BASIC ) ; 
curl_setopt($curl, CURLOPT_USERPWD, "username:password"); 

// grab URL and pass it to the browser
curl_exec($curl);

// close cURL resource, and free up system resources
curl_close($curl);
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T19:50:30.963

首先进行身份验证..，然后请求请求内容。

下面是一个使用 PHP 对 HTTP Basic auth 进行身份验证的示例：

[http://php.net/manual/en/features.http-auth.php](http://php.net/manual/en/features.http-auth.php)

# xslt - 从 n 到 m 的映射

> ID：11440296
> 
> 赞同：0
> 
> 时间：2012-07-11T19:47:45.013
> 
> 标签：xslt, nodes

我的问题是我想将 XML 中的节点移动到它们之后出现的节点 f.eks：我有一个看起来像这样的 xml：

```
<root>
   <node>a</node>
   <node>b</node>
   <node>c</node>
   <top1>
   <node>d</node>
   <node>e</node>
   <top2>
</root> 
```

它最终将成为

```
<root>
   <top1>
     <node>a</node>
     <node>b</node>
     <node>c</node>
   </top1>
   <top2>
     <node>d</node>
     <node>e</node>
   </top2>
</root> 
```

但我没有任何 xsl 可以做到这一点。我已经尝试过使用 position() ，但没有一个能让我更接近。谁能告诉我正确的方法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T02:35:48.840

这是一个选项：

**XML 输入**（更正为格式正确）

```
<root>
    <node>a</node>
    <node>b</node>
    <node>c</node>
    <top1/>
    <node>d</node>
    <node>e</node>
    <top2/>
</root> 
```

**XSLT 1.0**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output indent="yes"/>
    <xsl:strip-space elements="*"/>

    <xsl:template match="node()|@*">
        <xsl:copy>
            <xsl:apply-templates select="node()|@*"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="root">
        <xsl:copy>
            <xsl:apply-templates select="@*|*[starts-with(name(),'top')]"/>
        </xsl:copy>     
    </xsl:template>

    <xsl:template match="*[starts-with(name(),'top')]">
        <xsl:copy>
            <xsl:apply-templates select="@*|preceding-sibling::node[(following-sibling::*[starts-with(name(),'top')])[1][generate-id() = generate-id(current())]]"/>
        </xsl:copy>     
    </xsl:template>

</xsl:stylesheet> 
```

**输出**

```
<root>
   <top1>
      <node>a</node>
      <node>b</node>
      <node>c</node>
   </top1>
   <top2>
      <node>d</node>
      <node>e</node>
   </top2>
</root> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T07:11:20.553

我的输入是这样的：这不适用于上面的 xsl - 它会删除顶部元素中的孩子。

```
<root>
    <node>a</node>
    <node>b</node>
    <node>c</node>
    <top1>
       <node>1</node>
       <node>2</node>
    </top1>
    <node>d</node>
    <node>e</node>
    <top2>
       <node>3</node>
       <node>4</node>
    </top2>
</root> 
```

# gcc - XMM寄存器存储

> ID：11440301
> 
> 赞同：-1
> 
> 时间：2012-07-11T19:48:11.900
> 
> 标签：gcc, assembly, x86, inline-assembly

我正在尝试将 XMM 寄存器存储到某个位置，例如地址行 4534342。

例子：

**我做了什么？**

我知道 xmm 寄存器包含 128 位值。所以，我的程序已经分配了 16 字节的内存。此外，由于寄存器是对齐的数据，我分配了 31 个字节，然后在其中找到了对齐的地址。这应该可以防止抛出任何异常。

**我想在视觉上做什么？**

```
Mem Adr | Contents (binary)
4534342 | 0000 0000 0000 0000  ; I want to pass in address 4534342 and the
4534346 | 0000 0000 0000 0000  ; the program inline-assembly will store it 
4534348 | 0000 0000 0000 0000  ; its contents straight down to address 45-
4534350 | 0000 0000 0000 0000  ; 34350
4534352 | 0000 0000 0000 0000
4534354 | 0000 0000 0000 0000
4534356 | 0000 0000 0000 0000
4534358 | 0000 0000 0000 0000 
```

**设置**

```
cyg_uint8 *start_value;      //pointer to the first value of the allocated block                    
cyg_uint32 end_address;      //aligned address location value
cyg_uint32 *aligned_value;   //pointer to the value at the end_address
start_value = xmm_container; //get the pointer to the allocated block
end_address = (((unsigned int) start_value) + 0x0000001f) & 0xFFFFFFF8; //find aligned memory
aligned_value =  ((cyg_uint32*)end_address);  //create a pointer to get the first value of the block 
```

**在程序集调用之前调试语句以确保功能**

`printf("aligned_value: %d\n", (cyg_uint32) aligned_value); printf("*aligned_value: %d\n", *aligned_value);`

**大会召集**

`__asm__("movdqa %%xmm0, %0\n" : "=m"(*aligned_value)); //assembly call`

**在程序集调用之后调试语句以确保功能**

`printf("aligned_value: %d\n", (cyg_uint32) aligned_value);
printf("*aligned_value: %d\n", *aligned_value);`

**printf [FAILURE] 的输出**

> 对齐值：1661836 //看起来不错！
> 
> *aligned_value: 0 //看起来不错！
> 
> aligned_value: -1 //看起来不对 :(
> 
> //然后程序卡住了

基本上，我是否正确地执行了这个过程？为什么你认为它会卡住？

感谢您的时间和精力。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T20:59:44.463

如果您想要一个 16 字节对齐的地址，我认为您的对齐逻辑不正确。

只需做数学，这很容易！：

(0 + 0x1f) & 0xFFFFFFF8 = 0x18 ; 0x18-0=0x18 未使用字节，0x1F-0x18=7 字节剩余
(1 + 0x1f) & 0xFFFFFFF8 = 0x20 ; 0x20-1=0x1F 未使用字节，0x1F-0x1F=0 字节剩余
...
(8 + 0x1f) & 0xFFFFFFF8 = 0x20 ; 0x20-8=0x18 未使用字节，0x1F-0x18=剩余 7 字节
(9 + 0x1f) & 0xFFFFFFF8 = 0x28 ；0x28-9=0x1F 未使用字节，0x1F-0x1F=0 字节剩余
...
(0xF + 0x1f) & 0xFFFFFFF8 = 0x28 ; 0x28-0xF=0x19 未使用字节，0x1F-0x19=6 字节剩余
(0x10 + 0x1f) & 0xFFFFFFF8 = 0x28 ; 0x28-0x10=0x18 未使用的字节，0x1F-0x18=剩下 7 个字节
(0x11 + 0x1f) & 0xFFFFFFF8 = 0x30 ；0x30-0x11=0x1F 未使用字节，0x1F-0x1F=0 字节剩余
...
(0x18 + 0x1f) & 0xFFFFFFF8 = 0x30 ; 0x30-0x18=0x18 未使用字节，0x1F-0x18=7 字节
(0x19 + 0x1f) & 0xFFFFFFF8 = 0x38 ; 0x38-0x19=0x1F 未使用字节，0x1F-0x1F=0 字节剩余
...
(0x1F + 0x1f) & 0xFFFFFFF8 = 0x38 ; 0x38-0x1F=0x19 未使用字节，0x1F-0x19=6 字节

首先，要使 4 个最低有效位全为零，掩码应为 0xFFFFFFF0。

接下来，如果以这种方式计算对齐地址，则会溢出 31 字节缓冲区。您的数学计算为您留下 0 到 7 个字节的空间，这不足以存储 16 个字节。

为了正确的 16 字节对齐，您应该这样写：

`end_address = (((unsigned int)start_value) + 0xF) & 0xFFFFFFF0;`

# android - GCM 生产准备好了吗？我们现在应该开始使用它吗？

> ID：11440302
> 
> 赞同：4
> 
> 时间：2012-07-11T19:48:12.033
> 
> 标签：android, push-notification, google-cloud-messaging

`GCM`准备好生产了吗？

我只是想知道是否有人已经切换到它并且可以报告它的行为与宣传的一样。我从几天前在开发版本中转换，但我的`C2DM`仪表板仍然报告零数据使用情况，这让我感觉不太好。（这是在 Google API 控制台下，标题为 的图表）。我已经成功地使用.`GCM``GCM``Traffic Reports for [your app name]``GCM`

*看起来*不错，但我很犹豫是否要向数十万用户释放这个。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-11T20:28:13.543

C2DM[文档](https://developers.google.com/android/c2dm/)中的官方消息称，该服务*已于 2012 年 6 月 26 日正式弃用。这意味着 C2DM 已停止接受新用户和配额请求。*.

据此，我假设 GCM 现在正在运行，并且真正鼓励开发人员从 C2DM 迁移到 GCM。

> “开发人员必须使用 GCM 进行新的开发。”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T18:13:20.423

根据[谷歌的文档](http://developer.android.com/google/gcm/gcm.html#stats)，它不应该在 API 控制台上工作：

查看统计信息

要查看 GCM 应用程序的统计信息和任何错误消息：

1.  转到 Android 开发者控制台。

2.  使用您的开发者帐户登录。您将看到一个包含所有应用程序列表的页面。

3.  单击要查看其 GCM 统计信息的应用旁边的“统计信息”链接。现在您在统计页面上。

4.  转到下拉菜单并选择您要查看的 GCM 指标。

**注意：Google API 控制台上的统计信息未针对 GCM 启用。您必须使用 Android 开发者控制台。**

# objective-c - 如何在 Monotouch 中包装实现两个协议的 Objective-C 接口

> ID：11440316
> 
> 赞同：1
> 
> 时间：2012-07-11T19:49:13.973
> 
> 标签：objective-c, xamarin.ios

我有一个在 Objective-C 中实现两个协议的接口，我想将它包装在 Monotouch 中。

```
@interface GDExtended : NSObject <UIApplicationDelegate,GDiOSDelegate>
- (void) handleEvent:(GDAppEvent *)anEvent; 
@end 
```

所需的方法`HandleEvent`属于 GDiOS 协议，但它需要`UIApplicationDelegate`与视图通信。

问题是，当我在 Monotouch 的示例应用程序中扩展此类时，我得到一个`NSInternalInconsistencyException`

*原因：（* `AppDelegate`类注册的名称）没有实现`UIApplicationDelegate`.

任何帮助将不胜感激。

谢谢 ！！

# sql - 如何从 SQL Server 中包含多行数据的 2 个表中选择 4 个不同的值？

> ID：11440317
> 
> 赞同：-2
> 
> 时间：2012-07-11T19:49:14.893
> 
> 标签：sql, sql-server, tsql

我有 2 个表，我试图从按 GalleryID DESC 排序的 4 个结果中选择。我希望返回的字段是画廊表中的 GalleryID、GalleryTitle、GalleryDate 和媒体表中的 MediaThumb。

现在要注意的是 Media 表有 GalleryID 的 10 的倍数。因此，Media 表中可能有 10 行具有相同的 GalleryID。我所需要的只是一个 MediaThumb 与 galleryid 一起使用。

我不确定如何制定查询以从画廊表中返回 4 个不同的画廊 ID，并从媒体表中返回 MediaThumb。

本质上，我试图做的是返回 4 个独特的照片画廊，其中包含来自媒体表的封面照片。

任何帮助，将不胜感激。我通过我的 2 个表的 sqlserver 中的查询设计器提供了一个快照。

![在此处输入图像描述](../Images/d93b76209a17d1520ea615adeb378414.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T19:52:26.643

像这样的东西？

```
SELECT TOP 4 
    g.GalleryID
    ,g.GalleryTitle
    ,g.GalleryDate
    ,MAX(m.MediaThumb) AS MaxMediaThumb
FROM Galleries g
    INNER JOIN Media m
        ON g.GalleryID = m.GalleryID
GROUP BY g.GalleryID, g.GalleryTitle, g.GalleryDate 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T19:59:47.393

我的理解

```
SELECT DISTINCT(g.GalleryID), g.GalleryTitle, g.GalleryDate, MAX(m.MediaThumb)
FROM Galleries g
    INNER JOIN Media m
        ON g.GalleryID = m.GalleryID
GROUP BY g.GalleryID, g.GalleryTitle, g.GalleryDate 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T20:00:10.020

如果我理解正确，对于每个 GalleryID，您都需要任何一个 MediaThumb，而您不在乎哪个。如果这是正确的，那么我建议您选择 max(MediaThumb) 和 GROUP BY GalleryID。

# android-layout - 当我尝试 findViewById 时，我的按钮没有出现

> ID：11440320
> 
> 赞同：0
> 
> 时间：2012-07-11T19:49:21.867
> 
> 标签：android-layout

我知道有很多类似的问题，因为我已经阅读了所有这些问题，但我无法解决我的问题。我有最简单的设置...

XML

```
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true"
    android:padding="@dimen/padding_medium"
    android:text="@string/hello_world"
    tools:context=".MainActivity" />

<Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_above="@+id/textView1"
    android:layout_alignRight="@+id/textView1"
    android:layout_marginBottom="60dp"
    android:layout_marginRight="46dp"
    android:text="Button" /> 
```

爪哇

```
import android.widget.Button;
import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import android.view.MenuItem;
import android.widget.TextView;
import android.support.v4.app.NavUtils;

public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        Button my_btn = (Button) findViewById(R.layout.button1);

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.main, menu);
        return true;
    }

} 
```

错误

```
button1 cannot be resolved or is not a field    MainActivity.java 
```

我不知道这是否有什么不同，但我使用的是最新的 API，Eclipse 版本是 Juno 非常感谢任何形式的帮助！！！！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:01:39.330

白痴警报....

```
Button my_btn = (Button) findViewById(R.layout.button1); 
```

这应该是

```
Button my_btn = (Button) findViewById(R.id.button1); 
```

很抱歉浪费您的时间！

# database - 如果我使用 sql server 2008 r2 管理工作室创建我的数据库

> ID：11440328
> 
> 赞同：0
> 
> 时间：2012-07-11T19:49:47.550
> 
> 标签：database

我使用 sql server 2008 R2 创建我的数据库。现在在其他电脑上安装这个软件时必须安装sql server 2008 R2 management studio？不存在其他方式？

以及我如何设置在其他系统上运行的 SqlConnection。（我在 Visual Studio 中通过数据连接连接到数据库）

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T20:15:26.447

以其他方式存在。我的意思是，还有其他方法。几乎任何可以连接到在 SQL Server 7、2000、2005 或 2008 中创建的数据库的软件都能够连接到在 SQL Server 2008 R2 中创建的数据库。

SQL Server Management Studio 在人类用户想要连接到数据库时使用，而不是在软件连接到数据库时使用。

# java - 在非集合中使用泛型

> ID：11440331
> 
> 赞同：3
> 
> 时间：2012-07-11T19:49:54.363
> 
> 标签：java, oop, generics

今天看到几个类似的问题 - 让我思考：

什么时候使用泛型的规则是什么？

*   何时涉及收藏？
*   什么时候有返回集合元素的 getter 方法？
*   对象在其生命周期内是否改变类型？
*   关系是否是类的组合/聚合？

关于您应该问自己以确定是否应该使用泛型的问题似乎没有达成共识。这纯粹是一个自以为是的决定吗？

问什么时候不应该使用泛型更容易吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T20:07:40.147

在回到项目符号列表的第一点之前，让我先从一些关于泛型和类型信息的一般要点开始。

* * *

## **泛型可以防止不必要的类型转换。**

你还记得在泛型出现之前的 Java 吗？类型转换无处不在。

这就是类型转换的本质：您正在告诉编译器对象的类型，因为编译器不知道或无法推断它。

类型转换的问题是你有时会犯错误。您可以向编译器建议类的实例`Fiddle`是`Frobble`( `(Frobble)fiddle`)，编译器会很高兴地相信您并编译您的源代码。但如果事实证明你错了，你会在很久以后得到一个很好的*运行时*错误。

泛型是让编译器保留类型信息的一种不同且通常更安全的方法。基本上，编译器比人类程序员犯打字错误的可能性更小……**所需的类型转换越少，潜在的错误源就越少**！一旦您确定列表只能包含`Fiddle`对象 ( `List<Fiddle>`)，编译器将保留此信息并防止您必须将该列表中的每个项目类型转换为某种类型。（您仍然*可以*将列表项转换为`Frobble`，但是既然编译器让您知道该项目是一个`Fiddle`！，为什么要这样做？）

我发现**泛型极大地减少了类型转换的需求**，所以大量类型转换的存在——尤其是当你总是转换为相同的类型时——可能表明应该使用泛型。

让编译器保留尽可能多的类型信息是一件好事，因为**可以更早地发现类型错误**（在编译时而不是在运行时）。

## **泛型作为“泛型”`java.lang.Object`类型的替代品：**

在泛型之前，如果你想编写一个适用于*任何*类型的方法，你可以使用`java.lang.Object`超类型，因为每个类都派生自它。

泛型还允许您编写适用于*任何*类型的方法，但不会强迫您或编译器丢弃已知的类型信息——这正是您将对象转换为`Object`类型时发生的情况。因此，频繁使用该`Object`类型可能是泛型*可能*适用的另一个指标。

* * *

> *何时涉及收藏？*

为什么泛型似乎特别适合集合？因为，根据上述推理，集合很少允许包含*任何*类型的对象。如果是这样，那么该`Object`类型将是合适的，因为它不会对集合施加任何限制。但是，通常，您希望集合中的所有项目（至少）是一个`Frobble`（或某种其他类型），如果您让编译器知道它会有所帮助。泛型是如何做到这一点的方式。

* * *

> *关系是否是类的组合/聚合？*

您已链接到[另一个问题](https://stackoverflow.com/questions/11436792/when-to-use-generics)，该问题询问是否应将属性设为通用`class Person`的.`car``class Person<T extends ICar>`

在这种情况下，这取决于您的程序是否需要区分本田人和欧宝人。通过使这样的`Person`类通用，您基本上介绍了不同类型的人的可能性。如果这实际上解决了您的代码中的问题，那么就去做吧。但是，如果它只是引入了障碍和困难，那么请抵制这种冲动并留在您的非泛型`Person`类中。

侧节点：请记住，您不必使整个类通用；您只能使一些特定的方法通用。至少在 .NET 生态系统中，建议尽可能将泛型保持为“本地”，即当仅使方法泛型就足够时，不要将类变成泛型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T20:00:20.803

当满足以下三个条件时，我发现自己使用泛型：

1.  我注意到我正在重复代码，并开始考虑如何将其重构为新的方法/类。
2.  我正在重写的类/方法并不真正关心其中一个参数的*具体*类型是什么，只关心它遵循一定的契约（例如`<T extends Bar>`）。
3.  方法/方法之一的返回类型与所述参数相关，*或者*
    两个或多个参数相关并且需要具有相同的类型，尽管我并不关心该类型是什么。

通常，当满足这些标准时，会`Collection`涉及某种类型，但不一定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T20:04:59.003

在我看来，第二个陈述（什么时候不使用它们）是正确的。

何时不使用泛型：当强类型过于严格时（通常是泛型中的泛型）。在某些情况下，您希望**确保组件之间的松散耦合**，重点是“将您想要的发送给我，API 会以某种方式处理它”，而不是使用某种访问者，而不是使用某种通用类型指定完整的具体 API .

何时应该：如果没有，则必须将变量强制转换为某种类型（甚至您可能不得不猜测或使用 instanceof）...

* * *

只是一个旁注：每个结构化类型都是某种集合......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T20:50:41.933

> 问什么时候不应该使用泛型更容易吗？

为了回答这个问题，泛型的主要问题之一是它对检查异常的处理。这是[Geotz](https://blogs.oracle.com/briangoetz/entry/exception_transparency_in_java)的一篇关于此的文章。

您应该考虑泛型的原因，再次是[共享信息](https://www.ibm.com/developerworks/java/tutorials/j-generics/section5.html)的缓存。

# file - 在 bash 中查找平面目录中不存在于另一个目录树中的所有文件

> ID：11440332
> 
> 赞同：3
> 
> 时间：2012-07-11T19:49:54.483
> 
> 标签：file, bash, find, not-exists, directory-tree

我在一个目录中有很多文件`A`。

其中一些文件存在于带有子目录的目录树中`B/B1`, `B/B2`, `B/B3`, `B/B4`, ... 请注意，有些文件的名称中有空格。

例如：

在目录中`A`：

*   有一个文件名为`A/red file.png`

*   还有一个名字`A/blue file.png`

    并且，在目录树中`B`：

*   有一个文件名为`B/small/red file.png`

    在这个例子中，我想要一个脚本告诉我目录`blue file.png`中不存在该文件`B`。

如何编写一个脚本来列出`A`目录树下找不到的所有文件`B`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-11T20:08:26.307

```
# A
# ├── blue file.png
# └── red file.png
# B
# └── small
#     └── red file.png

$ comm -23 <( find A -type f -printf '%f\n' | sort | uniq ) <( find B -type f -printf '%f\n' | sort | uniq )
blue file.png 
```

如果你`find`缺乏`-printf`，你可以尝试：

```
comm -23 <( find A -type f -exec basename {} \; | sort | uniq ) <( find B -type f -exec basename {} \; | sort | uniq ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-08-09T12:59:10.157

这是可以处理所有文件名的版本，包括包含换行符的文件名：

```
comm -z23 <(find dir1 -type f -printf '%f\0' | sort -uz) <(find dir2 -type f -printf '%f\0' | sort -uz) | xargs -0 printf '%s\n' 
```

# visual-studio - Mercurial 和缺少的 Visual Studio 参考资料

> ID：11440335
> 
> 赞同：-1
> 
> 时间：2012-07-11T19:50:05.333
> 
> 标签：visual-studio, mercurial

我对 Mercurial 还很陌生，我刚刚用 TortoiseHg 开始了一个关于 bitbucket 的项目。我的项目在 Visual Studio 2010 中。我可以毫无问题地提交对 mercurial 的更改，但是当我的队友从 mercurial 中拉出项目来处理它时，他得到的引用丢失错误。我想知道这是我项目中的错误配置还是他身边缺少参考？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:10:03.543

项目中引用的文件不会包含在 Mercurial 中，除非这些文件包含在存储库中。

`References`您的同事可以通过在解决方案资源管理器中展开文件夹并查看哪些参考上带有黄色警告三角形来查找缺少哪些参考。您可能需要将那些丢失的文件复制到他们的机器上。

另一种选择是将这些引用的文件（如果合适）放入存储库中的目录中，然后从项目中删除引用并从新位置重新引用。然后将文件添加到存储库中，尽管它可能会使存储库膨胀，因此如果使用远程中央存储库则不理想。

如果你还不知道的话，我也会推荐[VisualHG for Visual Studio 到 TortoiseHG 的集成。](http://visualhg.codeplex.com/)

# three.js - 将一个物体指向远处的物体

> ID：11440337
> 
> 赞同：1
> 
> 时间：2012-07-11T19:50:14.273
> 
> 标签：three.js

我有两个对象，我们称它们为nearObject 和farObject。一旦nearObject 与farObject 保持一定距离，我希望farObject 旋转以面对nearObject。这应该立即发生，它不需要随着时间的推移慢慢旋转。

1）距离是任意的，所以我使用以下来获取距离信息。nearObject.position.distanceToSquared(farObject.position);

2）现在我想让 farObject 垂直于两个对象之间的向量旋转。最简单的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T22:16:12.860

```
farObject.lookAt( nearObject.position ); 
```

# ios - 无法同时录制/播放 AudioQueue 和动画

> ID：11440338
> 
> 赞同：0
> 
> 时间：2012-07-11T19:50:14.550
> 
> 标签：ios, core-graphics, core-audio, audio-streaming, grand-central-dispatch

在我的应用程序中，我试图在一台设备上录制、传输并在另一台设备上播放。我想为录音设备和播放设备上的声级设置动画。

我用于录制、播放和动画的大部分代码都来自[SpeakHere](http://developer.apple.com/library/ios/#samplecode/SpeakHere/Introduction/Intro.html)示例应用程序。

我有两个不同之处：

*   我有通过网络传输的额外开销。
*   我试图用和图像（如下所示）而不是像 SpeakHere 中的彩色带来做水平动画

![动画片](../Images/8327b9a5805137949a7178efb2cdbd5f.png)

我在一个单独的调度队列（GCD）上录制和传输，接收和回放也是如此。

*   我的第一个问题是：当我引入动画时，接收和播放变得很慢，AudioQueue 变得无声。
*   我的下一个问题是为 LevelMeter 视图设置清晰的背景。如果我这样做，那么动画就会出现乱码。不确定动画是如何连接到背景颜色的。

下面是我的 SpeakHere 示例中的 drawRect 版本（没有那么优雅的修改）。请就我可能犯的任何错误提出建议。

我的理解是，由于 UIKit，我不能在这里使用另一个线程来制作动画。如果没有，请纠正我。

```
- (void)drawRect:(CGRect)rect
{
        //();
    CGContextRef cxt = NULL;
    cxt = UIGraphicsGetCurrentContext();

    CGColorSpaceRef cs = NULL;
    cs = CGColorSpaceCreateDeviceRGB();

    CGRect bds;

    if (_vertical)
    {
        CGContextTranslateCTM(cxt, 0., [self bounds].size.height);
        CGContextScaleCTM(cxt, 1., -1.);
        bds = [self bounds];
    } else {
        CGContextTranslateCTM(cxt, 0., [self bounds].size.height);
        CGContextRotateCTM(cxt, -M_PI_2);
        bds = CGRectMake(0., 0., [self bounds].size.height, [self bounds].size.width);
    }

    CGContextSetFillColorSpace(cxt, cs);
    CGContextSetStrokeColorSpace(cxt, cs);

    if (_numLights == 0)
    {
        int i;
        CGFloat currentTop = 0.;

        if (_bgColor)
        {
            [_bgColor set];
            CGContextFillRect(cxt, bds);
        }

        for (i=0; i<_numColorThresholds; i++)
        {
            LevelMeterColorThreshold thisThresh = _colorThresholds[i];
            CGFloat val = MIN(thisThresh.maxValue, _level);

            CGRect rect = CGRectMake(
                                     0, 
                                     (bds.size.height) * currentTop, 
                                     bds.size.width, 
                                     (bds.size.height) * (val - currentTop)
                                     );

            [thisThresh.color set];
            CGContextFillRect(cxt, rect);

            if (_level < thisThresh.maxValue) break;

            currentTop = val;
        }

        if (_borderColor)
        {
            [_borderColor set];
            CGContextStrokeRect(cxt, CGRectInset(bds, .5, .5));
        }

    } 
    else 
    {
        int light_i;
        CGFloat lightMinVal = 0.;
        CGFloat insetAmount, lightVSpace;
        lightVSpace = bds.size.height / (CGFloat)_numLights;
        if (lightVSpace < 4.) insetAmount = 0.;
        else if (lightVSpace < 8.) insetAmount = 0.5;
        else insetAmount = 1.;

        int peakLight = -1;
        if (_peakLevel > 0.)
        {
            peakLight = _peakLevel * _numLights;
            if (peakLight >= _numLights) peakLight = _numLights - 1;
        }

        for (light_i=0; light_i<_numLights; light_i++)
            {
                CGFloat lightMaxVal = (CGFloat)(light_i + 1) / (CGFloat)_numLights;
                CGFloat lightIntensity;
                CGRect lightRect;
                UIColor *lightColor;

                if (light_i == peakLight)
                {
                    lightIntensity = 1.;
                } 
                else 
                {
                    lightIntensity = (_level - lightMinVal) / (lightMaxVal - lightMinVal);
                    lightIntensity = LEVELMETER_CLAMP(0., lightIntensity, 1.);
                    if ((!_variableLightIntensity) && (lightIntensity > 0.)) lightIntensity = 1.;
                }

                lightColor = _colorThresholds[0].color;
                int color_i;
                for (color_i=0; color_i<(_numColorThresholds-1); color_i++)
                {
                    LevelMeterColorThreshold thisThresh = _colorThresholds[color_i];
                    LevelMeterColorThreshold nextThresh = _colorThresholds[color_i + 1];
                    if (thisThresh.maxValue <= lightMaxVal) lightColor = nextThresh.color;
                }

                lightRect = CGRectMake(
                                       0., 
                                       bds.size.height * ((CGFloat)(light_i) / (CGFloat)_numLights), 
                                       bds.size.width,
                                       bds.size.height * (1\. / (CGFloat)_numLights)
                                       );
                lightRect = CGRectInset(lightRect, insetAmount, insetAmount);

                if (_bgColor)
                {
                    [_bgColor set];
                    CGContextFillRect(cxt, lightRect);
                }

                UIImage* image = [UIImage imageNamed:@"Pearl.png"];
                CGImageRef imageRef = image.CGImage;

                if (lightIntensity == 1.)
                {
                    CGContextDrawImage(cxt, lightRect, imageRef);

                    [lightColor set];
                    //CGContextFillRect(cxt, lightRect);
                } else if (lightIntensity > 0.) {
                    CGColorRef clr = CGColorCreateCopyWithAlpha([lightColor CGColor], lightIntensity);
                    CGContextSetFillColorWithColor(cxt, clr);
                    //CGContextFillRect(cxt, lightRect);
                    CGContextDrawImage(cxt, lightRect, imageRef);

                    CGColorRelease(clr);
                }

                if (_borderColor)
                {
                    [_borderColor set];
                    CGContextStrokeRect(cxt, CGRectInset(lightRect, 0.5, 0.5));
                }

                lightMinVal = lightMaxVal;
            }       
    }

    CGColorSpaceRelease(cs);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:06:38.733

您的绘图可能太慢，这可能会干扰对音频队列回调的实时响应要求。

但由于您主要绘制一堆静态图像，您可能需要考虑将每个点放在各自单独的图像视图中。您可以通过隐藏和取消隐藏子视图来控制显示的点数，根本不需要任何 drawRect 代码。

# python - Linux 服务器上的 Python 日志记录非常慢……但在 Linux 开发 VM 上却很快？

> ID：11440339
> 
> 赞同：6
> 
> 时间：2012-07-11T19:50:14.757
> 
> 标签：python, performance, logging, ubuntu, console

使用完全相同的代码，每次调用服务器上的记录器方法（例如 logger.debug）大约需要 50 毫秒，而在开发机器上则不到 1 毫秒。记录器正在输出到文件，并带有一些格式。

除了日志记录速度变慢之外，服务器的速度是原来的两倍。

我正在 Windows 7 上的 VMWare 内运行的 Ubuntu 11.04 (Gnome) 上进行开发。服务器正在运行 Ubuntu Server 11.04（无 GUI，纯控制台）。日志模块是官方的“日志”模块（“import logging ... logger = logging.getLogger('mylogger')”）。

知道是什么原因造成的吗？这是非常令人沮丧的！

谢谢你的帮助！

编辑：两台机器都为其版本返回“Python 2.7.1+”。两台机器都运行 64 位 Ubuntu。

服务器的硬盘配置是软件 RAID-1，而在开发计算机中只有一个驱动器。

EDIT2：接受了Fabian的回答，因为它很彻底，尽管它并没有完全解决问题。

解决方案：写入控制台，句号，非常慢。我测试了将 X 写入文件，并将 X 写入控制台，控制台的速度大约慢了 100 倍。我不知道为什么会这样，但我只是从另一台计算机上运行了我用 ssh 运行的东西，一切都解决了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-18T06:12:37.163

如评论中所述，一个可能的原因是开发 VM 和生产机器之间的磁盘速度差异。您在两个系统中是否有相同类型的驱动器，例如。SSD、SATA 与 SCSI、主轴速度和缓存，等等？您的环境在 IO 方面完全不同。桌面 Windows 和 VMWare 将使用积极的磁盘缓存，而您的生产 Linux 机器可能会在安全方面出错并更频繁地等待数据提交到磁盘。也许 Windows 机器的驱动程序更适合它所拥有的磁盘类型，而服务器在没有优化的情况下运行？文件系统的差异也很大，硬件的差异可能足以导致 IO 速度的显着差异。CPU 和 RAM 速度也可能存在很大差异。如今的台式机通常更注重原始速度，而服务器硬件则更注重可靠性。您最了解自己的设置，因此您可以比较这两个系统的硬件性能。

除此之外，您还可以通过以下方式了解实际情况：

首先，编写一个 MWE 来测试日志记录。您应该基于您的真实代码，并以类似的方式使用日志记录，但这里有一个小例子：

```
import logging

logging.basicConfig(filename="test.log", level=logging.DEBUG)
logger = logging.getLogger("testlogger")

for i in range(0, 1000000):
    logger.info("iteration: %d", i) 
```

然后在您的开发和生产机器上运行 cProfile 下的脚本。请务必登录到与您的问题案例相同的文件系统，否则结果将不适用。

```
python -m cProfile testlogging.py 
```

您将获得如下所示的输出：

```
57000501 function calls in 137.072 seconds

Ordered by: standard name

ncalls  tottime  percall  cumtime  percall filename:lineno(function)
    1    0.000    0.000    0.000    0.000 UserDict.py:4(__init__)
    1    0.000    0.000    0.000    0.000 __init__.py:1044(_fixupParents)
    1    0.000    0.000    0.000    0.000 __init__.py:1085(Logger)
    2    0.000    0.000    0.000    0.000 __init__.py:1100(__init__)
    1    0.000    0.000    0.000    0.000 __init__.py:1112(setLevel)
.....    .....    .....    .....    ..... ............................... 
```

这应该让您了解导致生产机器运行缓慢的原因。需要特别注意的事项：

*   寻找线阅读`{method 'write' of 'file' objects}`和`{method 'flush' of 'file' objects}`。这将告诉您 Python 花了多少时间写入文件并将数据刷新到磁盘——在本例中为日志文件。两台机器之间有显着差异吗？如果是这样，那肯定是 IO（磁盘）速度的差异。然后，您应该查看服务器的磁盘设置，看看是否可以采取任何措施来获得更好的磁盘性能。
*   寻找第一`percall`列特别大的行。此列是在函数中花费的总时间除以对该函数的调用次数。比较两台机器，您可能会发现导致差异的原因。
*   寻找`tottime`列特别大的行。此列是函数花费的总时间。再次，比较两台机器，你可能会发现速度差异的一些原因。

如果您发现磁盘 IO 似乎是问题所在，您可以只对文件进行原始写入进行额外测试。您可能会找到一个可以测试磁盘吞吐量的基准测试程序，但您也可以只编写一个简单的 C（或 Python）程序，将未格式化的数据写入文件，以确保它确实是纯磁盘性能，这就是区别。

最后一点：性能测试就像编程一样，是艺术、科学和工程的混合体，虽然你可以遵循一些模式和建议，但每个案例都需要一点创造性来破解。所以尝试一些事情，确保你不会欺骗自己，并且玩得开心！祝你好运！

# html - 直接 POST 到 URL 不起作用？

> ID：11440341
> 
> 赞同：0
> 
> 时间：2012-07-11T19:50:17.900
> 
> 标签：html, api, url, post, error-handling

我正在尝试通过在 URL 中发布参数来联系 API。我不确定它是否会以 XML 或 JSON 响应，但它是两者之一，但是，它说有错误。

这是我提交的一个例子。我收到以下回复：

```
This page contains the following errors:

error on line 1 at column 1: Document is empty
Below is a rendering of the page up to the first error. 
```

我不知道发生了什么...我相信我遵循 POST 的语法，关于语法的唯一剩下的问题是 ? 是在正确的位置。当我使用 PHP POST 时，页面 API 确实有效...

或者它正在工作，浏览器只是无法理解 XML 或 JSON 响应？（我使用的是 chrome，所以我认为这不是问题）

否则，如果有人对此有任何见解，我将不胜感激

不同的浏览器会产生此错误：

```
 XML Parsing Error: syntax error
Location: 
Line Number 1, Column 1:Array
 ^ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T20:10:43.077

虽然 URL 的语法看起来不错，但您暗示 API 需要 POST 中的参数。将它们添加到实际 URL 意味着参数在 GET 中传递，而不是 POST。

您可以尝试通过制作一个包含所有相关参数的小 HTML 表单并通过 POST 将它们传递给此 API 来测试这一点，看看这是否会给您预期的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T20:20:14.900

您的问题是如何将它们发送到 api 它应该是 url 编码 [http://api.example.com/api/?apikey=asdfa23462=example&ip=208.74.76.5](http://api.example.com/api/?apikey=asdfa23462=example&ip=208.74.76.5)

应该

[http://api.example.com/api/?apikey=asdfa23462&=example&ip=208.74.76.5](http://api.example.com/api/?apikey=asdfa23462&=example&ip=208.74.76.5)

我看到的另一个问题是你有 ?apikey=asdfasfsdafsd&=example

=example 很可能是所有问题。

只是我所看到的一些想法。

# spring-mvc - 带有 WebLogic 10.3.4 的 Spring MVC - 在带有 @ResponseBody 的 GET 请求上获取 HTTP 406

> ID：11440347
> 
> 赞同：1
> 
> 时间：2012-07-11T19:50:35.807
> 
> 标签：spring-mvc, weblogic, jackson, weblogic-10.x

我正在使用 Spring 3.1.1 构建 Spring-MVC 应用程序，并且正在使用 Jackson 2.0.1，并且我有一个使用 @ResponseBody 注释返回 JSON 的控制器。

```
@RequestMapping(value="/roleMaint/role/roleTypes", method = RequestMethod.GET)
public @ResponseBody List<Model> getRoleTypes() {

    List<Model> roleModels = new ArrayList<Model>();

    List<RoleType> roleTypes = Arrays.asList(RoleType.values());
    for (RoleType roleType : roleTypes) {
        ExtendedModelMap model  = new ExtendedModelMap();
        model.addAttribute("name", roleType.name());
        roleModels.add(model);
    }
    return roleModels;
} 
```

我的 servlet 配置中有以下项目

```
<mvc:annotation-driven/>
<mvc:default-servlet-handler/> 
```

当我执行 GET 请求时，我从 WebLogic 10.3.4 获得 HTTP 406，这也是我正在部署的 Java 容器 - 如果我将相同的应用程序部署到 WebLogic 12.0.0.1，该应用程序可以工作，所以我确信这是与 WebLogic 10.3.4 和一些捆绑在 WebLogic 中的 Jars 版本有关。

关于我可以在这里尝试的任何想法？提前致谢。

——文尼

# kentico - 如何在转换中制作可下载的文件类型字段-Kentico

> ID：11440350
> 
> 赞同：0
> 
> 时间：2012-07-11T19:50:47.737
> 
> 标签：kentico, custom-type

Recently 开始使用 kentico 6.0 。我已经构建了带有“文件”类型字段的自定义文档类型，管理员可以在其中上传文件。现在我正在尝试构建一个转换，从站点用户将能够下载此文件：（如 codeproject 中项目的压缩源代码）在 kentico 中哪里有一种简单的方法来做到这一点？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T20:13:00.783

您可能需要查看可用的内置转换方法（在您的 Kentico 实例的 /CMSHelp/index.html?newedit_transformation_methods.htm 中找到）。

在这种情况下，我认为你想要的是`GetFileUrl(object attachmentGuidColumn)`

你会做类似的事情`<a href='<%#GetFileUrl("NameOfTheDataField")#>'>File</a>`

# algorithm - 在具有约束的图中找到顶点不相交路径的最大数量

> ID：11440353
> 
> 赞同：7
> 
> 时间：2012-07-11T19:50:55.543
> 
> 标签：algorithm, graph, theory, np-complete

给定一个无向图 G=(V,E)，每条边都与一个非负值相关联。

如何在图 G 上找到从 s 到 t 的顶点不相交路径的最大数量，约束条件是路径长度之和不大于预定义值 T。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-12T09:59:59.013

您可以从将顶点不相交路径问题转换为边不相交路径问题开始。有关详细信息，请参阅[其他问题](https://stackoverflow.com/a/11916273/1009831)的答案。

现在，您可以解决此图上[的最小成本流问题](http://en.wikipedia.org/wiki/Minimum-cost_flow_problem)，以找到任意数量的具有最小路径长度总和的不相交路径。这样做，为每条边分配等于 1 的流量，然后在 s 和 t 之间搜索一个最小成本流量，流量等于所需的路径数。

为了找到最大路径数，在二分搜索的每个步骤上应用最小成本流过程，从一些初始路径数开始，可以通过以下过程之一确定：

1.  如果您期望最大路径数很大，请解决此图的[最大流量问题](http://en.wikipedia.org/wiki/Maximum_flow_problem)。
2.  如果您期望路径的最大数量很小，请使用单边二分搜索（每一步也使用最小成本流程）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T09:52:32.607

由于您只对顶点不相交路径的**数量感兴趣，因此您可以使用**[门格尔定理](http://en.wikipedia.org/wiki/Menger%27s_theorem)（为了证明请看[这里](http://homepages.cwi.nl/~lex/files/agt3.pdf)），如下所示：

设 G 是一个有限无向图，x 和 y 是两个不相邻的顶点。然后定理指出，x 和 y 的最小顶点切割的大小（移除断开 x 和 y 的顶点的最小数量）等于从 x 到 y 的成对顶点独立路径的最大数量。

但这不满足路径长度之和不大于预定义值 T 的约束。

为此，您必须使用门格尔定理的一个版本来获取此处介绍的有界长度路径[：](http://www.math.elte.hu/~lovasz/scans/mengerian.pdf) http : [//www.math.elte.hu/~lovasz/scans/mengerian.pdf](http://www.math.elte.hu/~lovasz/scans/mengerian.pdf)

# android - startActivityForResult 立即返回而没有正确的结果

> ID：11440354
> 
> 赞同：2
> 
> 时间：2012-07-11T19:51:00.090
> 
> 标签：android, android-intent, facebook-android-sdk

我正在使用[facebook sdk](https://github.com/facebook/facebook-android-sdk)登录用户。

我调用了我创建的一个活动，它只进行 facebook 登录，并且应该将结果返回到原始活动。

这是我如何调用它（它来自自定义组件的内部，这`getContext()`就是使用的原因）：

```
Intent intent = new Intent(getContext(), FacebookAuthenticationActivity.class);
Log.d(TAG, "Starting facebook authentication for result");
((Activity)getContext()).startActivityForResult(intent, REQUEST_FACEBOOK); 
```

在这里我想要回应：

```
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent intent) {
    Log.d(TAG, "Result from something!");
    if(requestCode == LoginWidget.REQUEST_FACEBOOK) {
        if(resultCode == RESULT_OK && intent != null) {
            Log.d(TAG, "Result from facebook received!");
            mLoginWidget.onFacebookLoginSucceeded(intent);
        }
    }
    super.onActivityResult(requestCode, resultCode, intent);
} 
```

在 facebook 活动中，它是来自[facebook 开发者页面](https://developers.facebook.com/docs/mobile/android/build/#sso)的代码。该代码没有错误...由于某种奇怪的原因，活动在`onActivityResult`调用.`onCreate``FacebookAuthActivity`

我写的代码是让用户登录，获取一些信息，最后调用：

```
Intent intent = new Intent();
intent.putExtra("user_json", response);

Log.d(TAG, "Setting result to: " + intent);
setResult(RESULT_OK, intent);
finish(); 
```

在查看日志后，我得到的是：

```
07-11 16:34:27.992: D/LoginWidget(6863): Starting facebook authentication for result
07-11 16:34:27.992: D/ProgramActivity(6863): I am starting an activity to get a result!
07-11 16:34:28.101: D/ProgramActivity(6863): Result from something!
07-11 16:34:40.875: D/Facebook-authorize(6863): Login Success! access_token=xxx expires=1347195352881
07-11 16:34:40.875: D/FacebookAuthentication(6863): User accepted our app in facebook!
07-11 16:34:42.351: D/FacebookAuthentication(6863): Setting result to: Intent { (has extras) } 
```

所以我没有想法......由于某种原因，当我调用此活动时，它会立即调用`onActivityResult`父级而没有结果，然后，它会登录，设置实际结果，调用完成，并且永远不会调用`onActivityResult`真正的响应.

我在这里错过了什么吗？我是否必须为此活动设置特定标志才能正确返回结果？

这只是一个简单的活动，有一堆异步 facebook 调用，然后用结果回调......

**更新**

为了更清楚，我没有从这段代码中得到任何错误。问题是当我设置结果时，登录后，原始活动没有收到结果。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-12T12:02:51.647

答案就[在这里](https://stackoverflow.com/questions/3366992/startactivityforresult-not-working-properly-with-launchmode-singleinstance)。此“功能”不允许活动开始使用`singleInstace`来调用活动以获得结果。

我将我的活动更改为`singleTop`，它现在可以正常工作了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T20:05:38.447

从您的示例来看，既没有为此目的设置 Action/Uri 也没有设置包上下文/类。

[http://developer.android.com/reference/android/content/Intent.html#Intent](http://developer.android.com/reference/android/content/Intent.html#Intent) ()

您必须设置这两者之一，即

```
Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse("xxx://someUri"); 
```

或者

```
Intent intent = new Intent(this, MyActivity.class); 
```

`MyActivity.class`应该处理某些内容并返回结果的 Activity 的名称/类型在哪里。

# ruby-on-rails-3 - 资产：预编译堆栈级别太深

> ID：11440356
> 
> 赞同：3
> 
> 时间：2012-07-11T19:51:06.050
> 
> 标签：ruby-on-rails-3

我正在尝试成功运行任务 rake assets:precompile 但出现以下错误

```
** Invoke assets:precompile (first_time)
** Execute assets:precompile
rake assets:precompile:all RAILS_ENV=production RAILS_GROUPS=assets --trace

** Invoke assets:precompile:all (first_time)
** Execute assets:precompile:all 
** Invoke assets:precompile:primary (first_time)
** Invoke assets:environment (first_time)
** Execute assets:environment
** Invoke tmp:cache:clear (first_time)
** Execute tmp:cache:clear
** Execute assets:precompile:primary
rake aborted!
stack level too deep
  (in .../app/assets/stylesheets/admin/scaffolds.css.scss)
.....rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/task.rb:162
Tasks: TOP => assets:precompile:primary
rake aborted!
Command failed with status (1): [/Users/diogui/.rvm/rubies/ruby-1.9.2-p320/...]
.....rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/file_utils.rb:53:in `block in create_shell_runner'
....rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/file_utils.rb:45:in `call'
....rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/file_utils.rb:45:in `sh'
....rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/file_utils_ext.rb:39:in `sh'
....rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/file_utils.rb:80:in `ruby'
.....rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/file_utils_ext.rb:39:in `ruby'
.....rvm/gems/ruby-1.9.2-p320/gems/actionpack-3.1.1/lib/sprockets/assets.rake:9:in `ruby_rake_task'
....rvm/gems/ruby-1.9.2-p320/gems/actionpack-3.1.1/lib/sprockets/assets.rake:17:in    `    invoke_or_reboot_rake_task' 
```

在我的 production.rb 我有

```
config.serve_static_assets = false
config.assets.enabled = true
config.assets.compress = true
config.assets.compile = true
config.assets.digest = true 
```

是的，我有 Sass 3.1.4

```
group :assets do
  gem 'sass-rails',   '~> 3.1.4'
  gem 'coffee-rails', '~> 3.1.1'
  gem 'uglifier', '>= 1.0.3'
end 
```

有人知道问题出在哪里吗？或者我错过了什么？谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:34:19.653

事实证明，这是 sass-rails gem 的一个记录问题：[https ://github.com/rails/sass-rails/issues/78](https://github.com/rails/sass-rails/issues/78)

显然可以通过将 sass-rails gem 降级到 3.1.4（如果您使用 Rails 3.1）或升级到 3.2.5（如果您使用 Rails 3.2）来解决：[“rake aborted！stack level too deep”在部署到 Heroku 时](https://stackoverflow.com/questions/9779456/rake-aborted-stack-level-too-deep-while-deploying-to-heroku)

这对我有用:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-06T12:04:26.920

将 ruby​​ 版本更改为 2.3.0 就可以了。这个拯救了我的一天。

# iphone - 调用 tableview reloadData 时，一个一个翻转 UitableviewCell

> ID：11440360
> 
> 赞同：0
> 
> 时间：2012-07-11T19:51:23.047
> 
> 标签：iphone, uitableview, uianimation

我想在调用 [tableView reloadData] 时为 UITableViewCell 提供翻转动画，以便它在我的应用程序中提供很酷的动画效果。在翻转这些单元格之间，我将更新标签文本。

UITableViewCell 是否可以一一翻转。请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T05:32:38.167

尝试编写代码以`cell.contentView`在`cellForRowAtIndexPath:`.

```
 [UIView beginAnimations:@"flip Animation" context:nil];
  [UIView setAnimationDuration:0.5];
  [UIView setAnimationTransition:UIViewAnimationTransitionFlipFromLeft
                       forView: cell.contentView
                         cache:YES];
  [UIView commitAnimations]; 
```

请在返回单元格之前添加此内容。

试试这个方法。希望这对您有所帮助。

# wicket - 无法使用 Session.getSizeInBytes() 确定会话大小

> ID：11440362
> 
> 赞同：0
> 
> 时间：2012-07-11T19:51:30.940
> 
> 标签：wicket

我正在尝试确定会话的大小，我想在开始进行开发更改时对其进行跟踪。我的应用程序运行正常，没有序列化错误——除非我尝试获取会话大小。

在 Wicket 1.4 中，我记得我没有问题，但现在我做不到。如果我在`PageBase`构造函数中获得会话大小，我会得到同样的错误。

谁能看到我做错了什么？

## Java 代码

```
public class PageBase extends WebPage
{
  private static final long serialVersionUID = 1L;
  ...
  @Override
  protected void onAfterRender()
  {
    super.onAfterRender();

    Session ssnSession = Session.get();
    long loSize = ssnSession.getSizeInBytes();    <-- Exception is raised here
    ...
  }
  ...
} 
```

## 堆栈跟踪

```
11-Jul-2012 19:30:11 org.apache.wicket.util.lang.WicketObjects$SerializingObjectSizeOfStrategy sizeOf
WARNING: Unable to determine object size: [...].MySession@d2f5f1
java.io.NotSerializableException: java.lang.Object
  at java.io.ObjectOutputStream.writeObject0(Unknown Source)
  at java.io.ObjectOutputStream.defaultWriteFields(Unknown Source)
  at java.io.ObjectOutputStream.writeSerialData(Unknown Source)
  at java.io.ObjectOutputStream.writeOrdinaryObject(Unknown Source)
  at java.io.ObjectOutputStream.writeObject0(Unknown Source)
  at java.io.ObjectOutputStream.writeObject(Unknown Source)
  at org.apache.wicket.util.lang.WicketObjects$SerializingObjectSizeOfStrategy.sizeOf(WicketObjects.java:124)
  at org.apache.wicket.util.lang.WicketObjects.sizeof(WicketObjects.java:416)
  at org.apache.wicket.Session.getSizeInBytes(Session.java:439)
  at [...].PageBase.onAfterRender(PageBase.java:212)
  at org.apache.wicket.Component.afterRender(Component.java:962)
  at org.apache.wicket.Component.render(Component.java:2326)
  at org.apache.wicket.Page.renderPage(Page.java:1035)
  at org.apache.wicket.request.handler.render.WebPageRenderer.renderPage(WebPageRenderer.java:105)
... 
```

## 我的软件环境

*   网络框架：Wicket 1.5.7
*   爪哇：1.6.0_33；Java HotSpot(TM) 客户端虚拟机 20.8-b03
*   网络服务器系统：Google App Engine for Java 1.7.0 版
*   操作系统：Microsoft Windows XP Home Edition 2002 SP3（在 x86 上运行的 5.1 版；Cp1252；en_GB）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T10:51:25.380

我已经设法解决了我的问题

```
dev_appserver.cmd --jvm_flag=-Dsun.io.serialization.extendedDebugInfo=true 
```

突出显示有问题的数据成员。在我的`WebSession`情况下，我使用

```
private final Object m_objLockItemPaidStatus = new Object(); 
```

将处理锁定在一个`synchronized`块中。我已将其更改为使用

```
/**
 * This class is the simplest possible class which can be used as an object
 * to lock processing in a <code>synchronized</code> block
 * and which can also be serialised.
 * (This class extends <code>java.lang.Object</code> solely to implement the
 * <code>java.io.Serializable</code> interface.)
 */
public static class LockObject extends Object implements Serializable
{
  private static final long serialVersionUID = 1L;

  public LockObject()
  {
    super();
  }
} 
```

相反，为了确保我的`WebSession`实例可以被序列化（所以我也可以使用 找到它们的近似大小`WebSession#getSizeInBytes()`）。

对我来说奇怪的一件事是，既然我希望 Wicket 能够`WebSession`在我的 Google App Engine for Java (GAE/J) 环境中序列化我的实例，为什么还没有使用 GAE/J 开发 Web 服务器来获取呢？

# ios - 如何在 iOS 中的程序退出时关闭 UIManagedDocument

> ID：11440363
> 
> 赞同：2
> 
> 时间：2012-07-11T19:51:32.910
> 
> 标签：ios, core-data

我有一个围绕全局 UIManagedDocument（核心数据）的 iOS 程序，我想知道如何确保在程序退出之前正确保存和关闭它。

首先，如果我想确保在退出之前保存此文档，我应该/我可以调用 `- (void)closeWithCompletionHandler:(void (^)(BOOL success))completionHandler`AppDelegate 方法吗`- (void)applicationWillTerminate:(UIApplication *)application`？我担心这样做的唯一原因是 closeWithCompletitionHandler 是异步的，因此程序是否有可能在文档完全关闭之前退出？

其次，我是否还必须在退出之前明确保存文档，或者关闭它也会保存它？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T20:02:12.013

UIManagedDocument 将确保文档在退出时保存，而您根本不需要做任何事情。它处理导致应用程序进入后台或退出的所有事件（当然，崩溃除外），因此您不必担心那部分。

# excel - 使用 ADO VBA 将 Excel 字段插入 Access 表

> ID：11440372
> 
> 赞同：2
> 
> 时间：2012-07-11T19:51:58.587
> 
> 标签：excel, ms-access, vba, ado, ms-access-2010

我正在尝试使用 ADO 从 Excel 文件中访问和读取一些内容。我了解如何打开它并执行 SELECT * 并将其放入 Recordset 对象中。我不明白的是，如果我选择一组信息，如何访问该记录集中的特定字段。

代码：

```
Private Sub SaveReq_Click()
' 
' Saves the current entry to the database
' Into the TABLE 'pr_req_table'
' 

' Open a connection to the database
dim data_base as Database
set data_base = OpenDatabase(CurrentProject.Path & "\test_database.accdb")

Sub InsertRecord()
Dim data_base As Database
Set data_base = OpenDatabase(CurrentProject.Path & "\test_database.accdb")

' Grab all information from form
' Add information to pr_req_table
Dim qd As QueryDef
Set qd = data_base.CreateQueryDef("")
qd.sql = "INSERT INTO pr_req_table(pr_no, pr_date, pr_owner, pr_link, pr_signed) " & _
    "values([p1],[p2],[p3],[p4],[p5])"
qd.Parameters("p1").Value = pr_num.Value
qd.Parameters("p2").Value = Format(pr_date.Value, "mm/dd/yyyy")
qd.Parameters("p3").Value = List22.Value
qd.Parameters("p4").Value = "Excel Copy #" & elec_copy.Value
qd.Parameters("p5").Value =  "Signed Copy #" & sign_copy.Value 
qd.Execute

' The following section reads from the elec_copy field's hyperlink
' It scans the Excel file for items it needs to include into the table
' It enters those cells into the TABLE 'items_needed_table'
'
' Slects row by row, and if the item has been marked TRUE, inserts
' That row into the TABLE 'items_needed_table'

' Open a connection to Excel
On Error Resume Next

Const adOpenStatic = 3
Const adLockOptimistic = 3
Const adCmdText = &H0001

Set objConnection = CreateObject("ADODB.Connection")

objConnection.Open "Provider=Microsoft.Jet.OLEDB.4.0;" & _
    "Data Source=" & elec_copy.Value & ";" & _
    "Extended Properties=""Excel 8.0;HDR=Yes;"";"

' Decalre a RecordSet Object
Set objRecordSet = CreateObject("ADODB.Recordset")

' Grab all Rows in the Plain_VDR Sheet where 'needed' column == TRUE
objRecordset.Open "Select line_no, desc, weeks FROM [Plain_VDR$] Where needed = TRUE", _
    objConnection, adOpenStatic, adLockOptimistic, adCmdText

' Declare a loop counter for row?
Dim x as Integer
x = 0

' Write the information pulled, into the TABLE 'items_needed_table' in Access Database
Do Until objRecordset.EOF
        qd.sql = "INSERT INTO items_needed_table(pr_no, line_no, desc, weeks) " & _
        "Values([p1],[p2],[p3])"
        ' p1 was declared earlier in code, same value as before
        qd.Parameters("p2").Value = objRecorset.(ROW_X, "line_no")
        qd.Parameters("p3").Value = objRecordset.(ROW_X, "desc")
        qd.Parameters("p4").Value = objRecordset.(ROW_X, "weeks")
        qd.Execute
        x = x + 1
Loop

' Close Database connection
data_base.Close

End Sub 
```

我主要关心的是“直到”循环部分。怀疑我可以插入整个选择，因为“pr_no”没有在 Excel 文件中定义，而是在 Access 数据库中定义，所以我想我需要为 Excel 文件中的每一行循环该命令。我需要使用什么来为 Recordset 对象中的每行和字段的参数分配值？

提前感谢您的帮助！

弥敦道

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T20:27:01.073

在您的连接字符串中，您说 HDR=Yes，这意味着您的范围的第一行包含您的字段名称，因此，非常粗略：

```
Do Until objRecordset.EOF
    qd.Sql = "INSERT INTO items_needed_table(pr_no, line_no, desc, weeks) " & _
    "Values([p1],[p2],[p3])"
    ' p1 was declared earlier in code, same value as before
    '**No it was not, the earlier stuff is mostly irrelevant

    qd.Parameters("p2").Value = objRecorset.Fields("line_no")
    qd.Parameters("p3").Value = objRecordset.Fields("desc")
    qd.Parameters("p4").Value = objRecordset.Fields("weeks")
    qd.Execute
    ''You are moving through a recordset, not a worksheet
    objRecordset.MoveNext
Loop 
```

如果这就是您从 Excel 中选择的所有内容，则可以通过一个查询插入它，因为您没有更改 pr_num。

# python - 将动态数据库函数传递给 psycopg2 cursor.execute(statement, params)

> ID：11440373
> 
> 赞同：0
> 
> 时间：2012-07-11T19:52:01.203
> 
> 标签：python, postgis, psycopg2

我通过 psycopg2 运行以下语句（有效）：

```
self.cursor.execute( """INSERT INTO """ + self.config.schema + """.parcel (
    id,geometry) VALUES (%s, ST_GeomFromGML(%s))""", (self.id, self.geometry) 
```

但现在我需要介绍一些动态，并想尝试这样的事情：

```
if multi:
    mygeom = "ST_Multi(ST_GeomFromGml(" + self.geometry + "))"
else 
    mygeom = "ST_GeomFromGml(" + self.geometry + ")"

self.cursor.execute( """INSERT INTO """ + self.config.schema + """.parcel (
    id,geometry) VALUES (%s, %s)""", (self.id, mygeom) 
```

当然，这会失败很长时间，因为它将整个函数解析为转义字符串。有没有人对如何解析数据库函数以在执行语句中动态解析它们有任何经验，或者这是不可能的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T21:09:37.567

self.cursor.execute("INSERT INTO {}.parcel (id,geometry) VALUES (%s, %s)".format(self.config.schema), (self.id, mygeom))

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T19:56:10.903

```
if multi:
    mygeom = "ST_Multi(ST_GeomFromGml(%s))"
else:
    mygeom = "ST_GeomFromGml(%s)"

self.cursor.execute( """INSERT INTO {}.parcel (
    id,geometry) VALUES (%s, {})""" .format(self.config.schema, mygeom) , (self.id, self.geometry) ) 
```

我用字符串`format`方法插入了模式和函数。我也`self.geometry`以安全的方式插入。

# ruby-on-rails - 在heroku上运行rails应用程序，在/public文件夹中看不到静态页面

> ID：11440377
> 
> 赞同：13
> 
> 时间：2012-07-11T19:52:17.643
> 
> 标签：ruby-on-rails, heroku

我有几个静态页面，在本地运行时作为 localhost:3000/foo.html 工作，但是一旦上传到 heroku，这将不起作用。

我尝试将以下内容添加到 routes.rb 文件中：

```
match '/foo', :to => redirect('/public/foo.html') 
```

但这似乎不起作用，它将我重定向到 foobar.com/public/foo.html，但在那里仍然找不到任何东西。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-07-11T19:56:13.683

根据[本文](https://devcenter.heroku.com/articles/rack-cache-memcached-static-assets-rails31#serve_static_assets)，您需要告诉 Rails 自己提供静态资产：

```
config.serve_static_assets = true 
```

在你的`config/environments/production.rb`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-21T06:44:53.827

或者，您可以将`rails_12factor`gem 添加到生产组：

```
gem 'rails_12factor', group: :production 
```

根据[Heroku](https://devcenter.heroku.com/articles/rails-4-asset-pipeline#serve-assets)的说法。这也将`stdout`按照 Heroku 的要求将日志重定向到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-30T17:19:04.477

这让我困惑了几个小时，但这是另一个潜在的解决方案。出于某种原因，我可以将文档生成到`/public/docs`中，但是即使在我生成文档之后，文档也不会加载。我会运行 Heroku bash 控制台，生成文档，退出，然后重新运行 Heroku bash，结果发现它`/public`不再包含我的`docs`文件夹。

因此，我找到的唯一解决方案是将文档包含在 Git 存储库中。这是 Heroku`/public/docs`在部署和 bash 实例中持续存在的唯一方式。

我不知道这是为什么...我向 Heroku 开了一张支持票，正在等待回复。

# jquery - HTTP POST 正文的 MIME 与 JSON

> ID：11440378
> 
> 赞同：1
> 
> 时间：2012-07-11T19:52:19.643
> 
> 标签：jquery, ajax, json, http, rest

我们有一个 HTTP RPC api，它的所有参数都将使用 JSON 进行编码。这行得通，但在 http 帖子的正文中混合 MIME x-www-form-urlencoding 和 JSON 实际上感觉不是很优雅。即身体可能看起来像这样：

```
POST /my/rpc/api/endpoint

foo={"x":123,"y":true}&bar=[1,2,3,4,5,6,7] 
```

我见过根本不使用 MIME 并进行完整 json 编码的服务。例如：

```
POST /my/rpc/api/endpoint

{"foo":{"x":123,"y":true},"bar":[1,2,3,4,5,6,7]} 
```

我认为后一种解决方案看起来更干净，但是我不太确定这是否违反了 HTTP 约定以及这会产生什么影响。这是要避免的吗？例如，这是否会使实施客户端变得更加困难？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:37:12.190

在 POST 有效负载中使用 JSON 没有任何问题。重要的是使用正确的互联网媒体类型，即“application/json”，而不是“application/x-www-form-urlencoded”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T19:57:41.377

使用 x-www-form-urlencoded 传递的数据被视为字符串。话虽如此，您可以将字符串视为您想要的任何内容。如果您有一个格式正确的字符串，可以编码和解码为 JSON，那将非常有效。如果您有一种查看帖子正文的简单方法，则可以提取 JSON 字符串。

使用 PHP，我实际上不确定如何查看正文，所以我必须做这样的事情：

```
json='{"foo":{"x":123,"y":true},"bar":[1,2,3,4,5,6,7]}'
//php
$json = json_decode($_POST['json']); 
```

# java - getListCellRendererComponent 调用了多少次？

> ID：11440383
> 
> 赞同：2
> 
> 时间：2012-07-11T19:52:39.410
> 
> 标签：java, swing, jcombobox, listcellrenderer

我试图了解 getListCellRendererComponent 方法的工作原理，但我不明白。我创建了一个扩展 BasicComboBoxRenderer 的单独类，并添加了一个计数器，每次调用 getListCellRendererComponent 时都会打印该计数器。然后，我使用 main 方法运行一个测试类，该方法显示一个只有一个 JComboBox 的框架，该 JComboBox 使用我的自定义渲染器类。这个组合框总共有 3 个项目，我设置了 setMaximumRowCount(2) 所以它只显示其中 2 个。

*   当我第一次运行程序并出现带有组合框的框架时，计数器通知 getListCellRendererComponent 被调用了 6 次。
*   当框架失去焦点时（例如，当我单击桌面时）该方法执行 1 次。
*   当框架重新获得焦点（单击我的框架）时，该方法执行 1 次。
*   当我单击箭头按钮并第一次出现下拉列表时，计数器说该方法执行了 8 次。
*   当我再次单击箭头按钮并且列表消失时，该方法被调用 1 次（这种情况总是发生）。
*   当我在第一次之后单击箭头按钮时，该方法被调用了 5 次。
*   当我单击滚动条按钮向上或向下时，该方法执行 1 次。
*   当我将光标移动到列表中未选中的项目上时，该方法执行 2 次，然后再执行 1 次（这是最荒谬的）
*   当我单击列表中的一个项目时，该方法执行 4 次。

一开始我以为这个方法的执行次数与列表中项目的数量一样多（再加上出现在组合框显示区域上的次数）。

但是从上面我只能理解一两种情况，比如当我点击滚动条按钮，方法执行1次时，可能是因为渲染了一个新项目。其他人看起来都疯了……

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T20:36:43.510

我希望在任何时候都会调用渲染器的不少于 n + 1 次迭代。

该组件需要

1.  找出内容的最佳尺寸。这可以通过使用原型值来实现，或者，如果未指定，则遍历所有项目以找到最大边界（即 3 次）
2.  如果存在+1次，则渲染所选项目
3.  如果弹出窗口可见 +3 次，则渲染列表
4.  可能寻找工具提示

= 可能的 7 次迭代

失去焦点时，组件需要渲染选中项+1

重新获得焦点时，组件将再次尝试渲染所选项目+1

显示弹出窗口时，请参阅第一部分

第二次可能表明组件已经缓存了第一个弹出操作的结果（可能是组件在焦点事件之间使其内部缓存失效）

每次更改滚动窗格的视图时，它都需要渲染以前未在屏幕上显示的任何项目，这是出于优化的原因（想象一个有 100 个项目的 lst，渲染所有项目是浪费时间，因此包含原型值）

鼠标动作可以触发一系列不同的动作，鼠标移入、鼠标移出、鼠标移动。最有可能这些与工具提示管理器和组件有关，试图确定工具提示是否可用

尝试设置原型值并查看组件显示其弹出窗口时是否会更改迭代次数

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T21:10:40.747

1.  我认为您忘记描述在,`Object(s)`中创建或重新创建的方式和方式`Renderer`

2.  您忘记将您`Renderer`在[SSCCE](http://sscce.org/)表格中的看法发送到这里

3.  那么一切都在学术水平上，很难写一些关于你的`Renderer`...

4.  `Renderer`对每一个事件`Mouse`做出反应`Key`

5.  `Renderer`从所有重要方法的输出到`System.out.println("yyyy")`

.

```
import java.awt.Component;
import java.awt.event.*;
import javax.swing.*;
import javax.swing.event.ListSelectionEvent;
import javax.swing.event.ListSelectionListener;
import javax.swing.plaf.basic.BasicComboBoxRenderer;

public class ComboBoxHoverOver {

    private JComboBox combo = new JComboBox();

    public ComboBoxHoverOver() {
        combo.setPrototypeDisplayValue("XXXXXXXXXXXXXXXXXXXXXX");
        combo.setRenderer(new ComboToolTipRenderer(combo));
        combo.addItemListener(new ItemListener() {

            @Override
            public void itemStateChanged(ItemEvent e) {
                System.out.println("itemStateChanged");
            }
        });
        combo.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                System.out.println("actionPerformed");
            }
        });
        combo.addItem("");
        combo.addItem("Long text 4");
        combo.addItem("Long text 3");
        combo.addItem("Long text 2");
        combo.addItem("Long text 1");
        JFrame f = new JFrame();
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        f.add(combo);
        f.pack();
        f.setVisible(true);
    }

    private class ComboToolTipRenderer extends BasicComboBoxRenderer {

        private static final long serialVersionUID = 1L;
        private JComboBox combo;
        private JList comboList;

        ComboToolTipRenderer(JComboBox combo) {
            this.combo = combo;
        }

        @Override
        public Component getListCellRendererComponent(JList list, Object value, int index, boolean isSelected, boolean cellHasFocus) {
            super.getListCellRendererComponent(list, value, index, isSelected, cellHasFocus);
            System.out.println(value + ", " + index + ", " + isSelected + ", " + cellHasFocus);
            if (comboList == null) {
                comboList = list;
                KeyAdapter listener = new KeyAdapter() {

                    @Override
                    public void keyReleased(KeyEvent e) {
                        if (e.getKeyCode() == KeyEvent.VK_DOWN || e.getKeyCode() == KeyEvent.VK_UP) {
                            int x = 5;
                            int y = comboList.indexToLocation(comboList.getSelectedIndex()).y;
                            System.out.println("keyReleased " + comboList.getSelectedIndex());
                        }
                    }
                };
                combo.addKeyListener(listener);
                combo.getEditor().getEditorComponent().addKeyListener(listener);
                comboList.addListSelectionListener(new ListSelectionListener() {

                    public void valueChanged(ListSelectionEvent e) {
                        if (e.getValueIsAdjusting()) {
                            JList list = (JList) e.getSource();
                            int item = list.getSelectedIndex();
                            if (item > -1) {
                                String string = list.getSelectedValue().toString();
                                System.out.println("valueChanged " + list.getSelectedValue().toString());
                            }
                        }
                    }
                });
            }
            if (isSelected) {
                System.out.println("isSelected " + value.toString());
            }
            return this;
        }
    }

    public static void main(String[] args) {

        java.awt.EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                ComboBoxHoverOver comboBoxHoverOver = new ComboBoxHoverOver();
            }
        });
    }
} 
```

# sql-server - SQL SERVER 2008 中的 PIVOT 结果集

> ID：11440387
> 
> 赞同：0
> 
> 时间：2012-07-11T19:52:56.760
> 
> 标签：sql-server

我有一个这样的结果集：

```
SELECT PropertyId, Owner from Table A

PropertyId    Owner

  1          Company A
  1          Company B

I want to Pivot the result set like this:

PropertyId  Owner 1 Owner 2

 1           CompanyA Company B 
```

换句话说，我希望每处房产都有 2 个所有者。假设每个属性最多有 2 个所有者。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T20:55:18.877

我创建的查询的唯一问题是，如果只有 1 个所有者，它将不会显示 propertyid，但它会使用空值。

```
;With [CTE] as (
  Select
    [PropertyId]
    ,[Owner]
    ,Row_Number()
      Over(Partition by [PropertyId] Order by [Owner]) as [RN]
  From [TableA]
)
Select
  a.[PropertyId]
  ,a.[Owner] as [Owner1]
  ,b.[Owner] as [Owner2]
From [CTE] as a
    Left Join [CTE] as b on a.[PropertyId] = b.[PropertyId]
        And b.[RN] = 2
Where a.[RN] = 1
    --And b.[RN] = 2 
```

**编辑：** 更新为`b.[RN] = 2`按照建议显示在 join 语句中。更新的 SQL Fiddle

SQL 小提琴：[http ://sqlfiddle.com/#!3/5af8c/7](http://sqlfiddle.com/#!3/5af8c/7)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T20:06:32.533

```
SELECT <non-pivoted column>,

[first pivoted column] AS <column name>,

[second pivoted column] AS <column name>,

...

[last pivoted column] AS <column name>

FROM

(<SELECT query that produces the data>)

AS <alias for the source query>

PIVOT

(

**<aggregation function>(<column being aggregated>)**

FOR

[<column that contains the values that will become column headers>]

IN ( [first pivoted column], [second pivoted column],

... [last pivoted column])

) AS <alias for the pivot table>

<optional ORDER BY clause>; 
```

我不认为你可以旋转，因为你没有做任何聚合

# objective-c - 使用 NSSet 阻塞

> ID：11440390
> 
> 赞同：-1
> 
> 时间：2012-07-11T19:53:06.377
> 
> 标签：objective-c, ios, objective-c-blocks

谁能告诉我为什么当“程序”中有小写字符时returnSet返回为零

我已经完成了，NSLog 肯定会挑选出变量，但是当它 addObject: 它只是没有？

```
+ (NSSet *)variablesUsedInProgram:(id)program
{
    NSMutableSet *returnSet = [[NSMutableSet alloc]init];

    if ([program isKindOfClass:[NSArray class]]) {
        [program enumerateObjectsUsingBlock: ^(id obj, NSUInteger idx, BOOL *stop)
        {
            if ([obj isKindOfClass:[NSString class]]) {
                if ([obj rangeOfCharacterFromSet:[NSCharacterSet lowercaseLetterCharacterSet]].location != NSNotFound) {
                    NSLog(@"Variable: %@", obj);
                    [returnSet addObject:obj]; 
                }
            }
        }];
    }

    return returnSet;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T20:13:41.470

发布的代码没有错误。它不能返回 的值`nil`。

你的错误在别处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-15T14:29:42.077

我猜你的问题是ARC内存管理问题。您发布的代码返回对其创建的集合的非拥有引用。除非您将其保存到强实例变量中，否则它将被释放。

# mysql - MySQL 替换查询

> ID：11440392
> 
> 赞同：0
> 
> 时间：2012-07-11T19:53:10.800
> 
> 标签：mysql

我有一个表，我需要从特定字段中删除特定文本。此字段包含图像的完整 URL，我需要删除 URL 并仅保留图像文件名。

所以：当前日期：字段名：www.example.com/photo.jpg 我想要做的是从该字段的所有条目中删除 www.example.com/。

我知道如何使用搜索和替换功能，但我不知道如何保持部分数据完好无损。

这是我使用过的，但无法修改它以使其按我想要的方式工作：

```
UPDATE table SET oc_upload1 = REPLACE(oc_upload1,'newtext') WHERE oc_upload1 LIKE "oldtext" 
```

这可能吗？如果是这样，怎么做？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T20:12:40.673

这应该这样做：

```
UPDATE table
SET image = REPLACE(image, 'www.example.com/','') 
```

但是，图像可能包含“www.example.com/”作为图像文件名的一部分，以便更加安全并仅替换第一次出现的 www.example.com

```
UPDATE table
SET image = SUBSTRING(image, LENGTH('www.example.com/') + 1)
WHERE image LIKE 'www.example.com/%' 
```

但是如果你真的，真的只是想要文件名而不是文件路径你也可以使用：

```
UPDATE table
SET image = SUBSTRING_INDEX(image,'/',-1) 
```

请注意，上述语句会将“www.example.com/images/01/02/daisy.jpg”更改为“daisy.jpg”，而不是“images/01/02/daisy.jpg”。它也不会更改图像中不包含“/”的行。

# javascript - 在 ajax 发布期间显示加载 div

> ID：11440393
> 
> 赞同：0
> 
> 时间：2012-07-11T19:53:13.123
> 
> 标签：javascript, jquery, jquery-mobile

我有一个主要使用 JQuery Mobile 的移动应用程序。我有一个使用 POST 的 ajax 函数，当我触发点击事件时，我似乎无法获得任何影响 UI 的东西。我试过设置

```
$('#cover').show(); 
```

作为函数中的第一件事，我会做一些基本的事情，比如 document.getElementById('user') 等来设置一些变量并检查输入，但只要有 ajax 函数，它就不会显示 div 甚至JQ Mobile 的微调器。除非我调试并单步执行代码，否则微调器和 div 显示得很好。我尝试了 setTimeout 并将其放在 ajax 调用的 beforeSend 区域中。否则一切正常。它似乎与 GET 一起工作得更好我不确定这是否与它有关。

```
$.ajax({                
    cache: false,
    type: "POST",
    async: false,
    url: urlString,
    data: jsonstring,
    contentType: "application/json",
    dataType: "json",
    success: function (data) {
        JSONobj = JSON.parse(data);         
    },
    beforeSend: function(xhr){
          //console.log('BeforeSend');
    },
    complete: function (xhr) {
        //console.log('Complete');
    },
    error: function (xhr, status, error) {
      console.log(error);
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T09:32:47.473

您可以使用 Ajax Global 处理程序来处理此问题：

```
$(document). 
    .ajaxStart(function(){
        $('#cover').show();
    })
    .ajaxStop(function(){
        $('#cover').hide();
    }); 
```

这样您就不必担心在单个 Ajax 调用上显示/隐藏覆盖。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T19:59:36.983

尝试这个

```
$("#someButton").click(function(e){

   e.preventDefault() //if you want to prevent default action

    $('#cover').fadeIn(100,function(){

       $.ajax({     
              url: "someurl",
              data: "Somedata",
              contentType: "application/json",
              dataType: "json",        
              },
              success: function (data) {
                   JSONobj = JSON.parse(data);
                   $('#cover').fadeOut(100);        
              },
               complete: function (xhr) {
                   $('#cover').fadeOut(100);
              }
       });  

    }); 

}); 
```

# r - 使用 LAPACK svd 的负奇异值

> ID：11440394
> 
> 赞同：3
> 
> 时间：2012-07-11T19:53:13.937
> 
> 标签：r

我有一个 399 x 399 矩阵，其中 R svd() 函数（使用 LAPACK）给了我一个负奇异值！这不应该发生——以前有人见过吗？如果我使用 LINPACK 选项就不会发生这种情况，所以我猜这是 LAPACK svd 中的一个错误。

```
ganymede: R --vanilla

R version 2.15.1 (2012-06-22) -- "Roasted Marshmallows"
Copyright (C) 2012 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)

R is free software, etc ...

> load('A.dat')
> ls()
[1] "A"
> dim(A)
[1] 399 399
> 
> L1 <- svd(A)
> any( L1$d < 0 )
[1] TRUE
> L1$d[1:4]
[1] 80.18833 68.93905 61.62659 57.62883
> L1$d[396:399]
[1]  3.777844e-15  3.582460e-15  3.175665e-15 -6.512578e+00
> 
> L2 <- svd(A,LINPACK=TRUE)
> any( L2$d < 0 )
[1] FALSE
> L2$d[1:4]
[1] 80.18833 68.93905 61.62659 57.62883
> L2$d[396:399]
[1] 8.565532e-32 3.254162e-32 3.484425e-47 5.411232e-48
> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T18:26:44.193

根据[此错误报告](https://bugs.r-project.org/bugzilla3/show_bug.cgi?id=14962)，该问题很可能通过重新链接到 LAPACK 3.4.1 来解决。升级通用版本 3.1.1 似乎并非易事，并且该过程取决于操作系统。

# javascript - 如何在 Javascript 中实现安全的 OAuth2 消费？

> ID：11440398
> 
> 赞同：47
> 
> 时间：2012-07-11T19:53:33.473
> 
> 标签：javascript, api, oauth-2.0, angularjs, consumer

我正在用 PHP 设计一个将使用 OAuth2.0 的 API。我的最终目标是用 javascript（使用 AngularJS）构建一个直接访问这个 API 的前端应用程序。我知道传统上没有办法保护 javascript 中的事务，因此直接访问 API 是不可行的。前端需要与服务器代码通信，而服务器代码又直接与 API 通信。但是，在研究 OAuth2 时，似乎用户代理流程旨在帮助解决这种情况。

我需要帮助的是在 javascript 中实现 OAuth2 用户代理流程（特别是 AngularJS，如果可能的话，因为这是我在前端使用的）。我还没有找到任何可以做到这一点的示例或教程。我真的不知道从哪里开始，也不想通读整个 OAuth2 规范，至少没有看到我将要做什么的例子。因此，任何示例、教程、链接等都将不胜感激。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-07-17T08:55:36.770

[隐式授予流程](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-30#section-1.3.2)（您称为*User-Agent Flow 的流程*）正是要走的路：

> 隐式授权是一种简化的授权代码流，针对使用 JavaScript 等脚本语言在浏览器中实现的客户端进行了优化。

要了解流程，Google 的[客户端应用程序](https://developers.google.com/accounts/docs/OAuth2#clientside)文档是一个非常好的起点。请注意，他们建议您采取额外的*令牌验证*步骤以避免[混淆代理问题](https://en.wikipedia.org/wiki/Confused_deputy_problem)。

以下是使用 Soundcloud API 和 jQuery 的流程的简短示例实现，取自[此答案](https://stackoverflow.com/a/4287248/1467115)：

```
<script type="text/javascript" charset="utf-8">
  $(function () {
    var extractToken = function(hash) {
      var match = hash.match(/access_token=([\w-]+)/);
      return !!match && match[1];
    };

    var CLIENT_ID = YOUR_CLIENT_ID;
    var AUTHORIZATION_ENDPOINT = "https://soundcloud.com/connect";
    var RESOURCE_ENDPOINT = "https://api.soundcloud.com/me";

    var token = extractToken(document.location.hash);
    if (token) {
      $('div.authenticated').show();

      $('span.token').text(token);

      $.ajax({
          url: RESOURCE_ENDPOINT
        , beforeSend: function (xhr) {
            xhr.setRequestHeader('Authorization', "OAuth " + token);
            xhr.setRequestHeader('Accept',        "application/json");
          }
        , success: function (response) {
            var container = $('span.user');
            if (response) {
              container.text(response.username);
            } else {
              container.text("An error occurred.");
            }
          }
      });
    } else {
      $('div.authenticate').show();

      var authUrl = AUTHORIZATION_ENDPOINT + 
        "?response_type=token" +
        "&client_id="    + clientId +
        "&redirect_uri=" + window.location;

      $("a.connect").attr("href", authUrl);
    }
  });
</script>
<style>
  .hidden {
    display: none;
  }
</style>

<div class="authenticate hidden">
  <a class="connect" href="">Connect</a>
</div>

<div class="authenticated hidden">
  <p>
    You are using token
    <span class="token">[no token]</span>.
  </p>

  <p>
    Your SoundCloud username is
    <span class="user">[no username]</span>.
  </p>
</div> 
```

要使用 AngularJS 发送[XMLHttpRequests](https://en.wikipedia.org/wiki/XMLHttpRequest)（该`ajax()`函数在 jQuery 中的作用），请参阅他们的[`$http`服务](http://docs.angularjs.org/api/ng.$http)文档。

如果要保留状态，在将用户发送到授权端点时，请检查[`state`](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-30#section-4.2.1)参数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-15T09:59:29.580

`Authorization Code Grant`有一个从 OAuth 服务器获取令牌的方法示例。我使用 jQuery( `$`) 进行了一些操作。

首先，将用户重定向到授权页面。

```
var authServerUri = "http://your-aouth2-server.com/authorize",
authParams = {
  response_type: "code",
  client_id: this.model.get("clientId"),
  redirect_uri: this.model.get("redirectUri"),
  scope: this.model.get("scope"),
  state: this.model.get("state")
};

// Redirect to Authorization page.
var replacementUri = authServerUri + "?" + $.param(authParams);
window.location.replace(replacementUri); 
```

当一个人通过授权获得令牌时：

```
var searchQueryString = window.location.search;
if ( searchQueryString.charAt(0) === "?") {
  searchQueryString = searchQueryString.substring(1);
}
var searchParameters = $.deparam.fragment(searchQueryString);

if ( "code" in searchParameters) {
  // TODO: construct a call like in previous step using $.ajax() to get token.
} 
```

您可以`Resource Owner Password Credentials Grant`使用 jQuery 或纯 XMLHttpRequest 以相同的方式实现，并且不进行任何重定向 - 因为在每次重定向时，您都会失去应用程序的状态。

对我来说，我使用 HTML5 本地存储来保存不太可能构成安全威胁的数据的应用程序状态。

# spring-mvc - 如何存储“全局”变量而不必将其保留在 Spring MVC 中？

> ID：11440399
> 
> 赞同：1
> 
> 时间：2012-07-11T19:53:36.850
> 
> 标签：spring-mvc

我希望能够访问和更改服务器上代表设置的变量。我真的不明白创建一个类并将其存储在数据库中的原因。这个变量只有一个实例。是否有可能拥有可以读取和更改文本文件的 SettingsDAO 或者有更好的做事方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:30:23.950

您可以只使用 Spring 单例 bean 并将其从上下文中删除。它将有效地充当“常数”。

# msbuild - 在 Windows Server 2012 RC 上使用 MSBuild 打包 Web 应用

> ID：11440400
> 
> 赞同：1
> 
> 时间：2012-07-11T19:53:45.363
> 
> 标签：msbuild, webdeploy, iis-8

我正在使用带有 IIS 8 的 Windows Server 2012 RC（在 Windows Azure 上，新的 VM）。

我已经安装了 TeamCity 作为我的构建服务器。我从一切正常的当前安装迁移。

唯一不起作用的是针对 ASP.NET MVC 3 应用程序运行带有 Package 目标的 MSBuild。

MSBuild 日志的最后一部分，就在它必须实际创建包之前，如下所示：

```
[MyProject\MyProject.MvcClient\MyProject.MvcClient\MyProject.MvcClient.csproj] PipelinePreDeployCopyAllFilesToOneFolder
[21:46:16][PipelinePreDeployCopyAllFilesToOneFolder] GetPublishingLocalizedString
[21:46:16][GetPublishingLocalizedString] Publish Pipeline Deploy phase Pre-Deploy CopyAllFilesToOneFolder Stage
[21:46:16][MyProject\MyProject.MvcClient\MyProject.MvcClient\MyProject.MvcClient.csproj] Package
[21:46:16][Package] GetPublishingLocalizedString
[21:46:16][GetPublishingLocalizedString] Invoking Web Deploy to generate the package with the following settings:
[21:46:16][Package] GetPublishingLocalizedString
[21:46:16][GetPublishingLocalizedString] $(LocalIisVersion) is 7
[21:46:16][Package] GetPublishingLocalizedString
[21:46:16][GetPublishingLocalizedString] $(DestinationIisVersion) is 7
[21:46:16][Package] GetPublishingLocalizedString
[21:46:16][GetPublishingLocalizedString] $(UseIis) is True
[21:46:16][Package] GetPublishingLocalizedString
[21:46:16][GetPublishingLocalizedString] $(IisUrl) is http://myproject.web
[21:46:16][Package] GetPublishingLocalizedString
[21:46:16][GetPublishingLocalizedString] $(IncludeIisSettings) is true
[21:46:16][Package] GetPublishingLocalizedString
[21:46:16][GetPublishingLocalizedString] $(_DeploymentUseIis) is True
[21:46:16][Package] GetPublishingLocalizedString
[21:46:16][GetPublishingLocalizedString] $(DestinationUseIis) is True
[21:46:16][Package] GetPublishingLocalizedString
[21:46:16][GetPublishingLocalizedString] $(IisUrl_SiteID) is 2
[21:46:16][Package] GetPublishingLocalizedString
[21:46:16][GetPublishingLocalizedString] $(IisUrl_SiteFriendlyName) is myproject.web
[21:46:16][Package] GetPublishingLocalizedString
[21:46:16][GetPublishingLocalizedString] $(IisUrl_SiteRelativePath) is /
[21:46:16][Package] GetPublishingLocalizedString
[21:46:16][GetPublishingLocalizedString] $(IisServer_IisAppPoolName) is myproject.web
[21:46:16][Package] GetPublishingLocalizedString
[21:46:16][GetPublishingLocalizedString] $(_Destination_IisServer_IisAppPoolName) is myproject.web
[21:46:16][Package] MakeDir
[21:46:16][MakeDir] Creating directory "F:\Workspace\DeployPackages\2012-07-11_09-45-53\".
[21:46:16][Package] CallTarget
[21:46:16][CallTarget] GenerateMsdeployManifestFiles
[21:46:16][GenerateMsdeployManifestFiles] GetPublishingLocalizedString
[21:46:16][GetPublishingLocalizedString] Generate source manifest file for Web Deploy package/publish ...
[21:46:16][GenerateMsdeployManifestFiles] CallTarget
[21:46:16][CallTarget] CollectDatabasesToPublish
[21:46:16][CollectDatabasesToPublish] MakeDir
[21:46:16][MakeDir] Creating directory "obj\Release\Database".
[21:46:16][CallTarget] PackageUsingManifest
[21:46:16][PackageUsingManifest] GetPublishingLocalizedString
[21:46:16][GetPublishingLocalizedString] Packaging into F:\Workspace\DeployPackages\2012-07-11_09-45-53\MyProject.msbuild.zip.
[21:46:16][PackageUsingManifest] VSMSDeploy
[21:46:16][VSMSDeploy] Starting Web deployment task from source:manifest(F:\Workspace\DeployPackages\2012-07-11_09-45-53\MyProject.msbuild.SourceManifest.xml) to Destination:package(F:\Workspace\DeployPackages\2012-07-11_09-45-53\MyProject.msbuild.zip).
[21:46:16][VSMSDeploy] C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\v10.0\Web\Microsoft.Web.Publishing.targets(3009, 5): Web deployment task failed. (There was an error reading IIS configuration schema from 'C:\Windows\system32\inetsrv\config\schema\'.)
[21:46:16][VSMSDeploy] Package failed.
[21:46:16][MyProject\MyProject.MvcClient\MyProject.MvcClient\MyProject.MvcClient.csproj] Project MyProject\MyProject.MvcClient\MyProject.MvcClient\MyProject.MvcClient.csproj failed.
[21:46:16][MyProject\MyProject.msbuild.teamcity] Project MyProject\MyProject.msbuild.teamcity failed.
[21:46:16]Process exited with code 1 
```

实际的错误信息是这样的：

```
C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\v10.0\Web\Microsoft.Web.Publishing.targets(3009, 5): Web deployment task failed. (There was an error reading IIS configuration schema from 'C:\Windows\system32\inetsrv\config\schema\'.) 
```

首先，我尝试以管理员身份运行构建代理，因为我认为这可能与安全相关。那没有帮助。

然后我尝试在服务器上安装 Web Deploy 3.0。也没有运气。

我能做但真的不想做的最后一件事是从项目文件中删除 IIS 设置。

有任何想法吗？

# groovy - 动态添加的 groovy 属性不是每个实例唯一的

> ID：11440401
> 
> 赞同：0
> 
> 时间：2012-07-11T19:53:46.533
> 
> 标签：groovy, metaprogramming

如果我动态地将一个属性添加到一个类中，则该类的每个实例都会使用对相同值的引用进行初始化（即使属性正确位于不同的地址，我也不希望它们共享相同的引用值）：

这是一个例子：

```
class SolarSystem {

    Planets planets = new Planets()

    static main(args) {
        SolarSystem.metaClass.dynamicPlanets = new Planets()

        // Infinite loop
//        SolarSystem.metaClass.getDynamicPlanets = {
//            if (!delegate.dynamicPlanets.initialized) {
//                delegate.dynamicPlanets = new Planets(initialized: true)
//            }
//
//            delegate.dynamicPlanets
//        }

        // No such field: dynamicPlanets for class: my.SolarSystem
//        SolarSystem.metaClass.getDynamicPlanets = {
//            if (!delegate.@dynamicPlanets.initialized) {
//                delegate.@dynamicPlanets = new Planets(initialized: true)
//            }
//
//            delegate.@dynamicPlanets
//        }

        SolarSystem.metaClass.getUniqueDynamicPlanets = {
            if (!delegate.dynamicPlanets.initialized) {
                delegate.dynamicPlanets = new Planets(initialized: true)
            }

            delegate.dynamicPlanets
        }

//        SolarSystem.metaClass.getDynamicPlanets = {
//            throw new RuntimeException("direct access not allowed")
//        }

        def solarSystem1 = new SolarSystem()
        println "a ${solarSystem1.planets}"
        println "b ${solarSystem1.dynamicPlanets}"
        println "c ${solarSystem1.uniqueDynamicPlanets}"
        println "d ${solarSystem1.dynamicPlanets}"

        println ''

        def solarSystem2= new SolarSystem()
        println "a ${solarSystem2.planets}"
        println "b ${solarSystem2.dynamicPlanets}"
        println "c ${solarSystem2.uniqueDynamicPlanets}"
        println "d ${solarSystem2.dynamicPlanets}"
    }
} 
```

在一个单独的文件中：

```
class Planets {
    boolean initialized = false
} 
```

运行时，您会看到如下内容：

```
a my.Planets@4979935d
b my.Planets@66100363
c my.Planets@5e0feb48
d my.Planets@5e0feb48

a my.Planets@671ff436
b my.Planets@66100363
c my.Planets@651dba45
d my.Planets@651dba45 
```

请注意，对于 solarSystem2，“普通”成员变量**planets**在创建两个对象时具有不同的地址。但是，动态添加的**dynamicPlanets**指向 solarSystem1 指向的同一对象（在本例中，地址为 66100363）。

我可以在我的动态 getter ( **getUniqueDynamicPlanets** ) 中重新分配它们，这样就解决了问题。

但是，我无法覆盖**getDynamicPlanets** getter，因为我要么获得无限循环，要么无法直接访问动态添加的属性。

有没有办法直接访问动态添加的属性，以便我可以在**getDynamicPlanets** getter 中处理这个？有没有更好的策略呢？抱歉，如果我错过了，我已经看了一堆...

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T00:02:05.083

I'm not 100% sure I understand your question, but if I do, did you try setting the `getDynamicPlanets` closure to have explicitly 0 parameters, so:

```
SolarSystem.metaClass.getDynamicPlanets = {->  ... } 
```

If you don't have the `->` with no args before it, there is an implicit `it` parameter that's assigned and it's not a zero arg method, so doesn't adhere to the javabean getter/setter pattern.

# vb.net - vb.net 在大型 .log 文件中搜索特定行

> ID：11440403
> 
> 赞同：0
> 
> 时间：2012-07-11T19:54:03.747
> 
> 标签：vb.net, file, logging, stream

我正在读取输出到 textview 的 1-5mb 日志文件，并搜索输出到另一个 textview 的特定行。目前，一个 1mb 的文件大约需要一分钟。除了我正在使用的方法之外，有没有人知道任何更快的搜索行或字符串的方法？

```
Imports EnterpriseDT.Net.Ftp

Public Class Form1

Private Sub SettingsToolStripMenuItem_Click(sender As System.Object, e As System.EventArgs) Handles SettingsToolStripMenuItem.Click

End Sub

Private Sub Button2_Click(sender As System.Object, e As System.EventArgs) Handles Button2.Click
    Dim sw As New Stopwatch
    Dim FullLine As String = ""
    Dim ScriptLine As String = ""
    sw.Start()

    Dim ll As New Queue(Of String)

    Dim i As String = ""

    Using TestFile As New IO.StreamReader("c:\test.txt", System.Text.Encoding.Default, False, 4096)

        Using OutFile As New IO.StreamWriter("c:\SBOutFile.txt", False, System.Text.Encoding.Default, 4096)

            While TestFile.EndOfStream = False

                i = TestFile.ReadLine

                If i.Contains(".sqf") And i.Contains("handleGear.sqf") = False Then
                    ScriptLine = ScriptLine & i & vbNewLine & vbNewLine
                    FullLine = FullLine & i & vbNewLine & vbNewLine
                Else
                    FullLine = FullLine & i & vbNewLine & vbNewLine
                End If

            End While

        End Using

    End Using

    sw.Stop()
    TextBox1.Text = FullLine
    TextBox2.Text = ScriptLine
    RichTextBox1.AppendText(String.Format("Run_Queue took {0} Milliseconds." & Environment.NewLine, sw.ElapsedMilliseconds))
End Sub

Private Sub Button1_Click_1(sender As System.Object, e As System.EventArgs) Handles Button1.Click
    Try
        'connect to ftp server
        Dim ftp As New FTPConnection
        ftp.ServerAddress = "-"
        ftp.ServerPort = "-"
        ftp.UserName = "-"
        ftp.Password = "-"
        ftp.Connect()
        ftp.ChangeWorkingDirectory("-")
        ftp.TransferType = FTPTransferType.BINARY

        'download a file
        ftp.DownloadFile("c:\test.txt", "scripts.log")

        'ftp.RenameFile("scripts.log", "scripts_test.log")

        'close the connection
        ftp.Close()

    Catch ex As Exception
        MessageBox.Show(ex.Message.ToString())
    End Try
End Sub

Private Sub Button3_Click(sender As System.Object, e As System.EventArgs) Handles Button3.Click

End Sub 
```

结束类

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:17:40.643

鉴于您在阅读时所做的大量阅读和连接，我怀疑这是您的时间/性能问题的一部分。我可能会考虑将 ScriptLine 和 FullLine 的声明从 String 类型更改为 StringBuilder，因为字符串在技术上是不可变的。这意味着每个连接实际上都是对前一个对象的拆解，并在其位置创建一个新对象。StringBuilders 专为重串联场景而设计。循环完成后，您可以将其转换回字符串。

此外，编译的正则表达式可能比 String.Contains 搜索得更快。您的正则表达式字符串类似于“(?!handleGear).sqf”，意思是“在字符串“.sqf”之前“查找除“handleGear”之外的任何零个或多个字符序列。

我还没有机会测试该表达式，因此提供了该警告。如果我有机会进行测试，我会很高兴修改并让您知道。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T15:54:08.557

我只是想发布我最后想出的东西。这是对我所拥有的非常大的改进。

```
'Read file
    Dim sw As New Stopwatch
    Dim FullLine As String = ""
    Dim ScriptLine As String = ""
    sw.Start()

    Dim ll As New Queue(Of String)

    Dim i As String = ""
    Dim builder As New StringBuilder
    Using TestFile As New IO.StreamReader("c:\test.txt", System.Text.Encoding.Default, False, 4096)

        builder.AppendLine("Started at: " & DateTime.Now.ToLongTimeString().ToString)
        RichTextBox1.AppendText(Now.ToShortTimeString & " Reading Log File Started" & vbNewLine)
        RichTextBox1.SelectionStart = RichTextBox1.TextLength

        Dim rowCount As Integer = 0

        Do Until TestFile.EndOfStream
            ScriptLine = TestFile.ReadLine
            ScriptLine = LCase(ScriptLine)
            If InStr(ScriptLine, ".sqf") > 0 And InStr(ScriptLine, "handlegear.sqf") < 1 Then 'And InStr(ScriptLine, "createmarkerlocal.sqf") < 1 And InStr(ScriptLine, "setmarkerposlocal.sqf") < 1 
                builder.AppendLine(ScriptLine)
                builder.AppendLine()
            End If
            rowCount = rowCount + 1
        Loop
        builder.AppendLine(Now.ToShortTimeString & "==== Searched " & rowCount & " rows" & vbNewLine)
        builder.AppendLine(Now.ToShortTimeString & " Finished" & vbNewLine)
    End Using

    sw.Stop()

    RichTextBox2.AppendText(builder.ToString & vbNewLine)

    RichTextBox1.AppendText(Now.ToShortTimeString & String.Format(" Run_Queue took {0} Milliseconds." & Environment.NewLine, sw.ElapsedMilliseconds)) 
```

# mysql - 在 where-in 子句中带有用户变量的 MySQL DELETE 语句？

> ID：11440406
> 
> 赞同：0
> 
> 时间：2012-07-11T19:54:16.647
> 
> 标签：mysql, where-clause, sql-drop, user-variables

假设我有这张桌子：

```
drop table if exists t_user;
CREATE TABLE t_user (usr int, grp int);
INSERT INTO t_user VALUES (123456, 5);
INSERT INTO t_user VALUES (111111, 5);
INSERT INTO t_user VALUES (111311, 5);
INSERT INTO t_user VALUES (122111, 5);
INSERT INTO t_user VALUES (111111, 5);
INSERT INTO t_user VALUES (111211, 5);
INSERT INTO t_user VALUES (113211, 5);
INSERT INTO t_user VALUES (115311, 5);
INSERT INTO t_user VALUES (122253, 3);
INSERT INTO t_user VALUES (222331, 6);
INSERT INTO t_user VALUES (118811, 3);
INSERT INTO t_user VALUES (112111, 6);
INSERT INTO t_user VALUES (213111, 6);
INSERT INTO t_user VALUES (343321, 7);
INSERT INTO t_user VALUES (114431, 2);
INSERT INTO t_user VALUES (115111, 8);
INSERT INTO t_user VALUES (324353, 3); 
```

我想运行这样的查询：

```
SELECT distinct @u := usr FROM t_user WHERE grp < 6; 
```

要保存一组用户的 ID，并在`delete`将删除所有这些用户的语句中使用结果：

```
delete from t_user where usr in ( @u ); 
```

问题是每次我运行这两个语句时，第一个列出的用户都会被删除，而不是我想要的所有用户。

**编辑**

我不能简单地在单个查询上运行所有内容。我真的很想知道如何分开做。

**编辑²**

我按照@juergen 说明并尝试使用临时表：

```
CREATE TEMPORARY TABLE t_temp (id int);

INSERT INTO t_temp SELECT DISTINCT usr FROM t_user WHERE grp < 6;

DELETE FROM t_user WHERE usr IN ( SELECT * FROM t_temp );

DROP TABLE t_temp; 
```

* * *

我搜索并找到了一些类似的答案，但我不想构建一个字符串并在我的删除语句中使用它。我想要更简单的东西。

*   [mysql在where子句中使用用户定义的变量](https://stackoverflow.com/questions/10934939/mysql-using-user-defined-variable-in-where-clause)
*   [MySQL：在 WHERE IN 子句上使用变量](https://stackoverflow.com/questions/4439218/mysql-using-variable-on-a-where-in-clause)
*   [在 MySQL 中，如何在 WHERE IN 子句中使用用户定义的变量？](https://stackoverflow.com/questions/7815031/in-mysql-how-do-i-use-a-user-defined-variable-in-a-where-in-clause)

如何将查询结果存储到临时表中： -[在 MySQL 中创建表变量](https://stackoverflow.com/questions/1524858/create-table-variable-in-mysql)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T19:56:59.887

只需在一个查询中完成

```
delete from t_user 
where usr in (SELECT distinct usr FROM t_user WHERE grp < 6) 
```

甚至更短

```
delete from t_user WHERE grp < 6 
```

## 编辑

一个变量只能保存一个条目。您可以使用临时表来存储您想要的数据。

## 编辑 2

您可以尝试加入而不是子查询。虽然没试过：

```
delete from t_user u1
inner join t_user u2 on u1.usr = u2.usr 
WHERE u2.grp < 6 
```

# objective-c - 库和项目中类的重复符号

> ID：11440407
> 
> 赞同：3
> 
> 时间：2012-07-11T19:54:19.737
> 
> 标签：objective-c, xcode, symbols

我在我的库中使用 SBJson 类并尝试在我的项目中使用该库我遇到重复符号错误，因为我也在主项目中使用这些文件。

我无法为这些文件添加前缀，那么通常如何解决这个问题？

我看到了其他建议用前缀重命名类的答案，但这并不是真正的解决方案，因为这些文件有重复是正确的——它是一个开源代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T20:05:07.240

*您可以从库项目**目标***中删除 SBJSON (.m) 文件（使用 Xcode 中的*“构建阶段”*屏幕），然后项目应该能够使用作为*主项目*一部分的 SBJSON 文件进行编译。但是，如果两个项目使用不同版本的 SBJSON 库，则可能会出现问题。

就我个人而言，我希望所有库项目不包含其他库，但请注意（在*“自述”*文件或其他文件中）它是一个依赖项，由开发人员决定是否将依赖项包含在主项目中。由于这些东西，我过去遇到过很多重复符号的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-05-22T13:03:40.580

只需转到**构建设置**和

搜索**No Common Blocks**和

将其设置为**NO**。

并再次构建，您将不会再次收到此错误。

干杯KP

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T19:57:01.683

您可以只在项目中包含 .h 文件，然后为 SBJson 删除 .m。这样你就可以在你的代码中导入 .h 并且它会编译。

# c# - 枚举作为类属性

> ID：11440410
> 
> 赞同：2
> 
> 时间：2012-07-11T19:54:28.140
> 
> 标签：c#, .net, linq-to-sql, .net-4.0, enums

我有一个简单的类，Status，它包含两个属性。我想为其中一个属性（状态ID）使用枚举，这样我就可以消除一堆魔术字符串。

我的问题是我如何使用它，例如：我有一个方法，它返回一个列表以在一个下拉框中进行绑定，如下所示-->

```
public static IList<Status> GetAdminStatuses()
{
  IQueryable<Status> stat=context.tblAdminStatus
       .Where(s => s.InactiveDate > DateTime.Now || s.InactiveDate == null)
       .Select(s => new Status()
       {
         StatusID=s.StatusID,
         StatusDescription=s.StatusDesc
       });
   return stat.ToList();
} 
```

它显然不喜欢我的`StatusID=s.StatusID`部分，因为数据库将它存储为 varchar。我是否在这里遗漏了一些简单的东西，或者我偶然发现了菜鸟领域并且不应该这样做？

这里的参考是类和枚举：

```
public class Status
{
  public string StatusID {get; set;}
  public string StatusDescription {get; set;}
}

public enum MyStatusID
{
  draft, pending, declined, accepted, close 
} 
```

* * *

编辑

因此，在这里接受建议，我能够编译我的方法，但是在运行时我得到以下内容-->`Method 'System.Object Parse(System.Type, System.String)' has no supported translation to SQL.`

想法？

* * *

编辑 - 根据请求提供完整的方法，谢谢（注意 NoaStatusID == MyStatusID）

```
 public static IList<Status> GetAdminStatuses(NoaStatusID currentStatus = NoaStatusID.draft)
    {
        using (var context = MemberDataContext.Create())
        {
            IQueryable<Status> stat=context.tblAdminStatus
                   .Where(s => s.InactiveDate > DateTime.Now || s.InactiveDate == null)
                   .Select(s => new Status()
                     {
                       StatusID=NoaStatusID)Enum.Parse(typeof(NoaStatusID),s.StatusID),
                       StatusDescription=s.StatusDesc
                     });

            switch (currentStatus)
            {
                case NoaStatusID.draft:
                    stat=stat.Where(s => (s.StatusID == NoaStatusID.draft || s.StatusID == NoaStatusID.pending));                                                     
                    break;
                case NoaStatusID.pending:
                    stat = stat.Where(s => (s.StatusID == NoaStatusID.accepted || s.StatusID ==NoaStatusID.declined || s.StatusID ==NoaStatusID.pending));
                    break;                        
                case NoaStatusID.declined:
                    stat = stat.Where(s => (s.StatusID == NoaStatusID.draft || s.StatusID == NoaStatusID.pending || s.StatusID == NoaStatusID.declined));
                    break;
                case NoaStatusID.accepted:
                    stat = stat.Where(s => (s.StatusID == NoaStatusID.mailed || s.StatusID == NoaStatusID.monitor || s.StatusID == NoaStatusID.close || s.StatusID == NoaStatusID.accepted));
                    break;
                case NoaStatusID.mailed:
                    stat = stat.Where(s => (s.StatusID == NoaStatusID.mailed || s.StatusID == NoaStatusID.monitor || s.StatusID == NoaStatusID.close || s.StatusID == NoaStatusID.appeal));
                    break;
                case NoaStatusID.monitor:
                case NoaStatusID.appeal:
                case NoaStatusID.close:
                    stat = stat.Where(s => (s.StatusID == NoaStatusID.close || s.StatusID == NoaStatusID.appeal));   
                    break;                    
            }

            return stat.ToList();
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:01:37.403

不是[你](http://msdn.microsoft.com/en-us/library/essfb559.aspx)要找的吗？

```
 Colors colorValue = (Colors) Enum.Parse(typeof(Colors), colorString); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T20:04:43.200

我相信您正在寻找的是：

```
StatusID = (MyStatusID)Enum.Parse(typeof(MyStatusID), s.StatusID), 
```

在 .Net 4.0 中还有一个`Enum.TryParse(string, out enum)`但在你的内部不是那么有用`.Select()`

**或者：** 尽管在大多数情况下效率较低，但您可以将 保留`Status.StatusID`为字符串并添加一个只读属性`StatusEnum`，该属性可即时输出 Enum 值：

```
public MyStatusID StatusEnum {
    get {
        return (MyStatusID)Enum.Parse(typeof(MyStatusID), StatusID)
    }

    private set;
}

in .Net 4.0:
public MyStatusID StatusEnum {
    get {
        MyStatusID value;
        if(!Enum.TryParse(StatusID, out value)
          value = MyStatusID.Default; // default value, instead of Exception throwing

        return value;
    }

    private set;
} 
```

每次读取 instance.StatusEnum 时，此替代方法都会重新解析该值，因此除非 LINQ 讨厌第一种方法，否则我不推荐它

* * *

回复您的最后一次编辑：

在您的示例中， Enum.Parse() 可以很好地转换为 SQL。问题出在 switch 语句中，您在其中添加了`.Where()`一个与`Enum`. LINQ 不知道如何将 an`Enum == Enum`转换为 SQL，但它**确实**知道使用 C# 对象来做到这一点。所以最简单的解决方案是 ToList() 它们并在本地进行比较。不幸的是，这意味着它正在从数据库中下载 -all- Status 类型的行，然后在本地过滤它们。如果您有数百万条记录，这可能不合理：

```
 public static IList<Status> GetAdminStatuses(NoaStatusID currentStatus = NoaStatusID.draft)
    {
        using (var context = MemberDataContext.Create())
        {
            List<Status> stat=context.tblAdminStatus
                   .Where(s => s.InactiveDate > DateTime.Now || s.InactiveDate == null)
                   .Select(s => new Status()
                     {
                       StatusID=NoaStatusID)Enum.Parse(typeof(NoaStatusID),s.StatusID),
                       StatusDescription=s.StatusDesc
                     })
                   .ToList();

            switch (currentStatus)
            {
                case NoaStatusID.draft:
                    stat=stat.Where(s => (s.StatusID == NoaStatusID.draft || s.StatusID == NoaStatusID.pending)).ToList();                                                     
                    break;
                case NoaStatusID.pending:
                    stat = stat.Where(s => (s.StatusID == NoaStatusID.accepted || s.StatusID ==NoaStatusID.declined || s.StatusID ==NoaStatusID.pending)).ToList();
                    break;                        
                case NoaStatusID.declined:
                    stat = stat.Where(s => (s.StatusID == NoaStatusID.draft || s.StatusID == NoaStatusID.pending || s.StatusID == NoaStatusID.declined)).ToList();
                    break;
                case NoaStatusID.accepted:
                    stat = stat.Where(s => (s.StatusID == NoaStatusID.mailed || s.StatusID == NoaStatusID.monitor || s.StatusID == NoaStatusID.close || s.StatusID == NoaStatusID.accepted)).ToList();
                    break;
                case NoaStatusID.mailed:
                    stat = stat.Where(s => (s.StatusID == NoaStatusID.mailed || s.StatusID == NoaStatusID.monitor || s.StatusID == NoaStatusID.close || s.StatusID == NoaStatusID.appeal)).ToList();
                    break;
                case NoaStatusID.monitor:
                case NoaStatusID.appeal:
                case NoaStatusID.close:
                    stat = stat.Where(s => (s.StatusID == NoaStatusID.close || s.StatusID == NoaStatusID.appeal)).ToList();   
                    break;                    
            }

            return stat;
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T19:58:10.367

如果您将支持字段* an 设置为`int`，它将正常工作。

事实上，您甚至可以使用`byte`枚举（带有`smallint`支持字段）。

然而，设计师有问题。IIRC，`enum`声明需要在同一个命名空间中。

注意：支持字段是指数据库表列类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T20:02:52.270

我的*猜测*是你想要`String`枚举值的等价物，但不是很清楚：

```
public static IList<Status> GetAdminStatuses()
{
  IQueryable<Status> stat=context.tblAdminStatus
       .Where(s => s.InactiveDate > DateTime.Now || s.InactiveDate == null)
       .Select(s => new Status()
       {
         StatusID=Enum.GetName(typeof(MyStatusID),s.StatusID),
         StatusDescription=s.StatusDesc
       });
} 
```

编辑：鉴于评论，听起来像你想要的：

```
public static IList<Status> GetAdminStatuses()
{
  IQueryable<Status> stat=context.tblAdminStatus
       .Where(s => s.InactiveDate > DateTime.Now || s.InactiveDate == null)
       .Select(s => new Status()
       {
         StatusID=(MyStatusID)s.StatusID,
         StatusDescription=s.StatusDesc
       });
} 
```

编辑：鉴于（进一步）评论，听起来像你想要的：

```
public static IList<Status> GetAdminStatuses()
{
  IQueryable<Status> stat=context.tblAdminStatus
       .Where(s => s.InactiveDate > DateTime.Now || s.InactiveDate == null)
       .Select(s => new Status()
       {
         // If database is storing 'draft' (as a varchar)
         StatusID=Enum.Parse(typeof(MyStatusID), s.StatusID),
         StatusDescription=s.StatusDesc
       });
} 
```

或者可能

```
public static IList<Status> GetAdminStatuses()
{
  IQueryable<Status> stat=context.tblAdminStatus
       .Where(s => s.InactiveDate > DateTime.Now || s.InactiveDate == null)
       .Select(s => new Status()
       {
         // If database is storing '0' (as a varchar)
         StatusID=(MyStatusID)int.Parse(s.StatusID),
         StatusDescription=s.StatusDesc
       });
} 
```

# for-loop - for循环中未设置的批处理脚本变量无效

> ID：11440413
> 
> 赞同：1
> 
> 时间：2012-07-11T19:54:59.973
> 
> 标签：for-loop, batch-file, local-variables, unset

下面是我的脚本。我正在尝试查看下一级的文件夹并仅选择那些文件夹，因此 ~-9 从路径中提取最后 9 个字符。但是 set var= 不会取消设置变量，因为输出返回时会返回相同的文件夹名称，重复 # 次。批处理也不允许我直接在 %%i 上执行此提取技巧，因此需要局部变量。

如何清除此变量以便在下一次迭代中采用新值？

```
@echo off
 for /d %%i in (%1\*) do (
  set var=%%i
  echo %var:~-9%
   set "var="
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T20:10:35.080

[http://judago.webs.com/variablecatches.htm](http://judago.webs.com/variablecatches.htm)对我的问题有解释。神奇的线条是 setlocal enabledelayedexpansion 并将 var 称为 echo !var:~-9!。！与 % ...哇！cmd 仍然让我感到惊讶。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T20:18:33.913

您找到了问题的根源，以及解决方案 - 延迟扩展。

`!`但是，如果任何文件名包含该字符，则在启用延迟扩展时使用 FOR 可能会导致问题。如果值包含并且启用了延迟扩展，则 for 变量的扩展`%%i`将被破坏。`!`这不是一个常见的问题，但它会发生。

解决方案是在循环内打开和关闭延迟扩展

```
@echo off
setlocal disableDelayedExpansion
for /d %%i in (%1\*) do (
  set var=%%i
  setlocal enableDelayedExpansion
  echo !var:~-9!
  endlocal
) 
```

我还想知道您所说的*“我正在尝试查看下一层的文件夹并仅选择那些文件夹，因此 ~-9 从路径中提取最后 9 个字符”是*什么意思。我怀疑您正在尝试获取子文件夹的名称，而没有前导路径信息。如果是这样，那么使用子字符串操作不是一个好的解决方案，因为文件夹名称的长度会有所不同。

有一个非常简单的方法可以在没有前导路径信息的情况下获取文件夹的名称：

```
for /d %%i in (%1\*) do echo %%~nxi 
```

# input - 使用参数的 VBScript 终止进程

> ID：11440419
> 
> 赞同：0
> 
> 时间：2012-07-11T19:55:34.073
> 
> 标签：input, process, parameters, vbscript, kill

我正在尝试创建一个 VBscript，它将杀死作为参数（参数）传入的 Windows 进程。我有以下代码，并认为问题出在第 8、18 或 24 行，但不确定问题出在哪里。当我用 notepad.exe 而不是变量替换该代码时，它可以工作。任何帮助都会很棒。谢谢。

```
Dim prcid
Dim check
Dim Inp
Set Inp = WScript.Arguments
check=0
Set objService = GetObject("winmgmts:")

For Each Process In objService.InstancesOf("Win32_process")
  If process.name= "Inp" Then
    prcid=process.processid
    check=1
    Exit For
  End If
Next

If check =0 Then
  WScript.Quit [ExitCode]
End if

For Each process In objService.InstancesOf("Win32_process")
  If process.name= "Inp" Then
    If process.processid=prcid Then
        strComputer = "."
        Set objWMIService = GetObject("winmgmts:" _ 
          & "{impersonationLevel=impersonate}!\\" & strComputer & "\root\cimv2")
        Set colProcessList = objWMIService.ExecQuery _
          ("SELECT * FROM Win32_Process WHERE Name = 'Inp'")
        For Each objProcess in colProcessList
            objProcess.Terminate()
        Next
    End If

    Exit For
  End If
Next 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T07:11:33.110

你确定 Inp 没有扩展，因为当我在 Windows XP 系统上运行脚本时它运行良好。同样在我的系统上，所有进程都有一个扩展名，除了系统和系统空闲进程。如果有扩展，您将需要使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T09:26:37.900

您正在使用变量作为文字：
1.`process.name= "Inp"`应该是`process.name = Inp`（两次）
2.`"SELECT * FROM Win32_Process WHERE Name = 'Inp'"`应该是`"SELECT * FROM Win32_Process WHERE Name = '" & Inp & "'"`

而且您使用的`WScript.Arguments`对象不正确：要从命令行获取第一个参数，请使用`WScript.Arguments(0)`

免责声明：我没有使用这些增强功能测试您的代码，我只是在第一眼就发现了这些错误。可能还有更多潜伏在里面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T22:39:08.947

我在互联网上发现它已经在很多系统上测试过 在
以下平台上验证
Server 8 否
Windows Server 2008 R2 是
Windows Server 2008 是
Windows Server 2003 是
Windows 8 否
Windows 7 是
Windows Vista 是
Windows XP 是
Windows 2000是的

* * *

脚本名称：WMI_KillProcess.vbs 创建于：10/05/2010 作者：Dennis Hemken 目的：此函数按名称杀死一个进程，该进程在网络中的一台特殊 pc 上运行。

* * *

```
Dim strComputer 

strComputer = "." 

fct_KillProcess "acrord32", strComputer 
' or 
' strComputer = "192.168.2.13" 
' fct_KillProcess "outlook", strComputer 

Public Function fct_KillProcess(strProcessName, strComputer) 

Dim objWMI 
Dim colServices 
Dim objService 
Dim strServicename 
Dim ret 

Set objWMI = GetObject("winmgmts:\\" & strComputer & "\root\cimv2") 
Set colServices = objWMI.InstancesOf("win32_process") 

For Each objService In colServices 
    strServicename = LCase(Trim(CStr(objService.Name) & "")) 
    If InStr(1, strServicename, LCase(strProcessName), vbTextCompare) > 0 Then 
        ret = objService.Terminate 
    End If 
Next 
Set colServices = Nothing 
Set objWMI = Nothing 
End Function 
```

# jquery - 使用 jQuery 提交两次

> ID：11440421
> 
> 赞同：1
> 
> 时间：2012-07-11T19:55:49.913
> 
> 标签：jquery, submit, double-submit-problem

为了防止意外提交并确保用户仔细检查他输入的所有信息，我通过弹出另一个按钮来延迟提交表单，询问他是否真的要提交......

不幸的是，当用户单击“否”并稍后使用“是”按钮提交表单时，它将提交两次。当用户之前没有点击“否”时，它第一次工作......

我在这里准备了一个小[jsfiddle](http://jsfiddle.net/xATyW/)，这就是我的代码：

```
$('#form').on('click','#submitbutton',function(e){
        e.preventDefault()
        $('#formchecker').show()
        $('#doit').click(function(e2){
            e2.preventDefault()
            alert('I will submit as you say')                
        })
        $('#dont').click(function(e2){
            e2.preventDefault()
            $('#formchecker').hide()
        })
}) 
```

您可以看到，在提交之前单击“nah”时选择“是”，会有多个警报框。有人暗示为什么它会这样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T20:02:55.427

每次单击提交按钮时，您都会将单击事件添加到是和否按钮，但您永远不会清除它们，因此如果您要单击提交，然后单击 5 次，最后单击“是”将触发 5 次。

您应该`unbind`在绑定新的点击事件之前绑定点击事件，或者不要在提交按钮的点击事件中绑定点击事件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-11T20:01:40.027

您应该监听 onSubmit 事件而不是 onClick 事件。

# java - 多线程在Java中播放背景音乐的唯一方法？

> ID：11440424
> 
> 赞同：1
> 
> 时间：2012-07-11T19:56:00.923
> 
> 标签：java, playback

我有一个主要发生游戏逻辑的游戏。我刚刚根据我发现的文档添加了声音播放：

```
//////////////////////SOUND/////////////////////////
     SourceDataLine soundLine = null;
     int BUFFER_SIZE = 64*1024;  // 64 KB

      // Set up an audio input stream piped from the sound file.
      try {
         File soundFile = new File("tim ph3 samplepart1.wav");
         AudioInputStream audioInputStream = AudioSystem.getAudioInputStream(soundFile);
         AudioFormat audioFormat = audioInputStream.getFormat();
         DataLine.Info info = new DataLine.Info(SourceDataLine.class, audioFormat);
         soundLine = (SourceDataLine) AudioSystem.getLine(info);
         soundLine.open(audioFormat);
         soundLine.start();
         int nBytesRead = 0;
         byte[] sampledData = new byte[BUFFER_SIZE];
         while (nBytesRead != -1) {
            nBytesRead = audioInputStream.read(sampledData, 0, sampledData.length);
            if (nBytesRead >= 0) {
               // Writes audio data to the mixer via this source data line.
               soundLine.write(sampledData, 0, nBytesRead);
            }
         }
      } catch (UnsupportedAudioFileException ex) {
         ex.printStackTrace();
      } catch (IOException ex) {
         ex.printStackTrace();
      } catch (LineUnavailableException ex) {
         ex.printStackTrace();
      } finally {
         soundLine.drain();
         soundLine.close();
      }
     ///////////////////////////////////////////////////// 
```

它播放我在 Eclipse 项目文件夹中的文件中指定的文件。

问题？它会阻止所有出现在主体中的游戏逻辑。

这是有道理的——程序是连续的，直到整首歌曲完成……我认为游戏无法继续。

这显然是行不通的，看来我将不得不去可怕的多线程......但在我这样做之前......我想知道......是否有Java库或其他一些聪明的解决方案可以避免在这种情况下多线程？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T19:59:47.693

是的，您需要使用单独的线程。没有什么好害怕的。Java中的多线程是小菜一碟。查看并发包。

[http://docs.oracle.com/javase/tutorial/essential/concurrency/](http://docs.oracle.com/javase/tutorial/essential/concurrency/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T20:10:05.960

当心：知道如何启动一个线程和知道如何安全地多线程你的程序是两件不同的事情。现在，请确保避免从多个线程中触摸相同的音乐。

# jquery - 最后创建的 div 元素的 jQuery 选择器

> ID：11440425
> 
> 赞同：0
> 
> 时间：2012-07-11T19:56:02.967
> 
> 标签：jquery

我有几个在文件上传后动态生成的 div。每个文件上传都会以这种格式创建一个 div：

```
<div id="uploadifive-fileupload-queue" class="uploadifive-queue">
    <div class="uploadifive-queue-item complete" id="uploadifive-fileupload-file-0">

        <div id="inputs">

            some text

        </div>
    </div>
</div> 
```

每个上传的项目都会将 uploadifive-queue-item 类的 id 递增到 uploadifive-fileupload-file-0、uploadifive-fileupload-file-1、uploadifive-fileupload-file-2 等。

我要做的是向 中添加一个类`#inputs`，但只添加一个刚刚创建的类。

我尝试了以下方法，但它将类应用于错误的 div（通常是第一个 div）

```
 $('#fileupload').uploadifive({
                'buttonClass'  : 'btn btn-primary',
                'buttonText'   : 'Select Thumbnail',
                'dnd' : false,
                'fileSizeLimit' : 1000,
                'method' : 'post',
                'simUploadLimit' : 1,
                'uploadScript' : './upload/',
                'onUploadComplete'  : function(file, data) {
                    $('#inputs:last').addClass('alert-error');
                }

            }); 
```

`#fileupload`只是表单的名称，这是 HTML：

```
<form id="fileupload">
    <input type="file" name="userfile" size="20" />
</form> 
```

div 直接添加到下方并位于同一容器内。

如何选择正确的 div？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T19:57:50.410

试试这个：

`$("#uploadifive-fileupload-queue .uploadifive-queue-item:last")`应该给你最后添加的 div

所以你的 onLoadComplete 处理程序将是：

```
'onUploadComplete'  : function(file, data) {
                    $("#uploadifive-fileupload-queue .uploadifive-queue-item:last").find('.inputs').addClass('alert-error');
                } 
```

# php - 为什么要将 sql 查询转换为 Zend_Db 样式？

> ID：11440429
> 
> 赞同：1
> 
> 时间：2012-07-11T19:56:24.773
> 
> 标签：php, zend-framework, zend-db

我想问为什么人们使用zend_db风格？

例如

```
 $select = $d2b->select()
             ->from('users', array('userid','username'))
             ->where('userid=?', 2);

 $result = $d2b->fetchRow($select);
 echo $result->username; 
```

代替

```
$result = $d2b->fetchAll('SELECT * FROM users WHERE userid = ?', 2);
echo $result[0]->username; 
```

哪一个更好？还是一样，只是为了可维护性。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-11T20:06:12.327

一个原因是使用 Zend_db 风格抽象出了 SQL 的生成；这意味着我们在数据库引擎之间切换可以像换出一个类一样简单，而不必重新编写不兼容的查询。

此外，Zend_db 抽象出了 SQL 查询转义，大大降低了 SQL 注入攻击的风险。它还为不懂 SQL 的人提供数据库查询功能。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-11T20:04:50.007

最终结果是相同的，因此这取决于您对可读性和可维护性的个人偏好。

流畅界面样式的一个优点是它可以更轻松地以编程方式构建查询，例如：

```
$select = $d2b->select()
         ->from('users', array('userid','username'));

if ([some condition]) {
    $select->where('userid = ?', 2);
} else {
    $select->where('userid = ?', 62);
} 
```

# excel - 从一系列单元格中删除尾随的“US”和“CAN”字符串

> ID：11440431
> 
> 赞同：3
> 
> 时间：2012-07-11T19:56:36.613
> 
> 标签：excel, substring, excel-formula

这是我拥有的工作表列中的数据示例：

```
Mining US
Soybean Farming CAN
Soybean Farming
Oil Extraction US
Fishing 
```

有数千个带有以“US”或“CAN”结尾的字符串的单元格，我需要做的是从包含它的每个单元格中取出“US”和“CAN”。

子字符串“US”和“CAN”仅存在于单元格中字符串的末尾，如果它们存在的话。有些单元格不包含“US”或“CAN”，但可能以字母“us”或“can”结尾。

我只想删除这些结束子字符串，以便我的表看起来像：

```
Mining
Soybean Farming
Soybean Farming
Oil Extraction
Fishing 
```

我对公式不是很缺乏经验，想知道是否有人可以提出一种方法来做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-11T20:15:11.187

就像我在评论中提到的那样，您可以使用 Excel 的内置 FIND`" US"`并`" CAN"`用空白替换它们。请记住选中“匹配大小写”复选框。可以使用快捷键`CTRL`+调用查找和替换，`F`这是实现您想要的最快的方法。

**关于如何使用 FIND AND REPLACE FOR 的**快照**`" CAN"`。**重复`" US"`****

 **![在此处输入图像描述](../Images/4dc16007691550070bfe2a76095a26ee.png)

但如果你仍然想要一个公式，那么把它放进去`B1`

`=IF(ISERROR(FIND(" US",A1,1)),IF(ISERROR(FIND(" CAN",A1,1)),A1,LEFT(A1, FIND(" CAN",A1,1))),LEFT(A1, FIND(" US",A1,1)))`

我假设数据在 Col A

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T20:19:17.267

这是一个庞大的单行工作表公式，您可以一直向下拖动。

```
=IF(RIGHT(A1,LEN(" CAN"))=" CAN",TRIM(LEFT(A1,LEN(A1)-LEN(" CAN"))),IF(RIGHT(A1,LEN(" US"))=" US",TRIM(LEFT(A1,LEN(A1)-LEN(" US"))),A1)) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-11T21:41:09.317

这只会从末尾删除“US”或“CAN”

`=LEFT(A1,LEN(A1)-4)&SUBSTITUTE(SUBSTITUTE(RIGHT(A1,4)," US","")," CAN","")`

注意：SUBSTITUTE 区分大小写**

# c++ - 使用 gettimeofday 钳制 FPS

> ID：11440434
> 
> 赞同：0
> 
> 时间：2012-07-11T19:56:51.673
> 
> 标签：c++, macos, opengl

我试图通过使用 gettimeofday 将我的游戏循环限制在特定的 FPS 上。这是一个非常初级的游戏，所以它一直在消耗我所有的处理能力。

无论我将 FRAMES_PER_SECOND 设置得有多低，它都会继续尝试以尽可能快的速度运行。

我很好地理解了 deWiTTERS 对游戏循环的看法，但我使用的是 gettimeofday 而不是 GetTickCount b/c 我在 Mac 上。

另外，我正在运行 OSX 并使用 C++、GLUT。

这是我的主要外观：

```
int main (int argc, char **argv)
{
    while (true)
    {
    timeval t1, t2;
    double elapsedTime;
    gettimeofday(&t1, NULL); // start timer

    const int FRAMES_PER_SECOND = 30;
    const int SKIP_TICKS = 1000 / FRAMES_PER_SECOND;
    double next_game_tick = elapsedTime;
    int sleep_time = 0;

    glutInit (&argc, argv);
    glutInitDisplayMode (GLUT_DOUBLE | GLUT_DEPTH); 
    glutInitWindowSize (windowWidth, windowHeight); 
    glutInitWindowPosition (100, 100);
    glutCreateWindow ("A basic OpenGL Window"); 
    glutDisplayFunc (display); 
    glutIdleFunc (idle); 
    glutReshapeFunc (reshape);
    glutPassiveMotionFunc(mouseMovement); //check for mouse movement
    glutMouseFunc(buttonPress); //check for button press

    gettimeofday(&t2, NULL); // stop timer after one full loop
    elapsedTime = (t2.tv_sec - t1.tv_sec) * 1000.0;      // compute sec to ms
    elapsedTime += (t2.tv_usec - t1.tv_usec) / 1000.0;   // compute us to ms

    next_game_tick += SKIP_TICKS;
    sleep_time = next_game_tick - elapsedTime;
    if( sleep_time >= 0 )
        {
        sleep( sleep_time );
        }

    glutMainLoop (); 
    }
} 
```

我已经尝试将我的 gettimeofday 和 sleep 函数放在多个位置，但我似乎找不到它们的最佳位置（鉴于我的代码甚至是正确的）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T19:59:49.067

那只会被调用一次。我相信您需要将 FPS 逻辑放在显示函数中，因为 glutMainLoop 永远不会返回。（这也意味着不需要你的 while 循环。）

编辑：或更可能它应该进入您的空闲功能。自从我使用 glut 已经有一段时间了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T20:04:18.533

[`glutMainLoop()`](http://www.opengl.org/resources/libraries/glut/spec3/node14.html)：

> `glutMainLoop`进入 GLUT 事件处理循环。**该例程在 GLUT 程序中最多应调用一次。**一旦被调用，**这个例程将永远不会返回**。它将根据需要调用已注册的任何回调。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T20:04:33.000

在您初始化的那一刻，您`next_game_tick`还`elapsed_time`没有初始化`elapsed_time`。

# sublimetext2 - 是否有 Sublime Text 2 的包在根文件夹名称后的侧栏中显示 git 分支？

> ID：11440435
> 
> 赞同：16
> 
> 时间：2012-07-11T19:56:52.833
> 
> 标签：sublimetext2, sublimetext3

谷歌搜索此主题未成功。也许你们可以帮助我。

**标题是问题：** ?? 是否有 Sublime Text 2 的包在根文件夹名称后的侧栏中显示 git 分支？

就像方便而不是其他任何东西。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-21T22:19:14.687

我自己才发现这一点。如[ST 论坛](http://www.sublimetext.com/forum/viewtopic.php?f=6&t=2119#p26290)所述，[SideBarGit](https://github.com/SublimeText/SideBarGit)插件将当前分支放在状态栏中：

![ST2 状态栏中的 Git 分支](../Images/2313aa52d1480343fb1b35a9475608c6.png)

# javascript - document.createElement("tr") 没有出现在 html 中

> ID：11440441
> 
> 赞同：0
> 
> 时间：2012-07-11T19:57:09.873
> 
> 标签：javascript, jquery, html, xml

我有一个非常烦人的问题。我得到了这堆运行的代码，应该将 XML 中的一些信息放入几个表槽中。

```
var xmlDoc;
$(document).ready(function() {
    //Load XML
    importXML();
    ///////////////////////////////////////////////////////////////////////////////////////
});

function importXML() {
    $.ajax({
        type: "GET",
        url: "adList.xml",
        dataType: "xml",
        success: assignXML
    });
}

function assignXML(myXML) {
    xmlDoc = myXML;
    pushContent();
}

function pushContent() {
    var len = xmlDoc.getElementsByTagName('advertisement').length;
    for (i = 0; i < len; i++) {
        var trElement = document.createElement('tr');
        console.log($(xmlDoc).find('advertisement').eq(i).find('image').text());
        var image = $(xmlDoc).find('advertisement').eq(i).find('image').text();
        var imageTD = document.createElement('td');
        var imageIn = document.createElement('input');
        imageIn.setAttribute('type', 'text');
        imageIn.setAttribute('name', 'imageArr[]');
        imageIn.setAttribute('size', '15');
        imageIn.setAttribute('value', image);
        imageTD.appendChild(imageIn);
        trElement.appendChild(imageTD);
        console.log(trElement);
    } 
```

所有的信息都在那里。我可以用firebug在javascript代码中查找tr，它工作正常。它没有抛出任何错误。它只是没有显示在页面或 html 中。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T20:14:27.880

改变这个...

```
var trElement = document.createElement('tr'); 
```

对这个……

```
var table = document.getElementById('my_table'),
    trElement = table.insertRow(table.rows.length); 
```

***演示：http:*** [//jsfiddle.net/7gDhq/1/](http://jsfiddle.net/7gDhq/1/)

# regex - 带有 (?: 的正则表达式

> ID：11440444
> 
> 赞同：0
> 
> 时间：2012-07-11T19:57:12.630
> 
> 标签：regex

我是正则表达式的新手，并试图找出这意味着什么。

```
(?:(?:^KC[\\x00-\\xff]{50})) 
```

上网查， ?: 表示没有回溯，不知道是什么意思？同样来自 ^ ，这是否意味着一行不包含 50 个字符的“KC ....”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T20:02:24.627

当您`()`在正则表达式中使用括号时，您可以使用引用 ( `\1`.. `\9`) 在正则表达式中进一步捕获组。示例：`(a|b)_\1`将匹配`'a_a'`和`'b_b'`。

`?:`表示被捕获的组不会有编号（实际上，最好说它不会被捕获，它只是一个组）。

`^`表示字符类中的否定（in `[]`）。在它之外`[]`意味着行的开始。

# magento - 如何通过 SetEnvIfNoCase 从 Apache mod_deflate 中排除 url

> ID：11440448
> 
> 赞同：0
> 
> 时间：2012-07-11T19:57:26.600
> 
> 标签：magento, apache2, expressionengine, mod-deflate

我正在处理具有 3rd 方 CMS 集成的 Magento 站点。当我通过 .htaccess 文件启用 Mod_deflate 时，大多数站点都运行良好。从 CMS 中提取信息的所有页面都显示“gobbledy-gook”，并且显示应该显示的内容没有被解压缩。

我试图简单地从压缩中排除使用 CMS 的网站部分（包括主页），但是，我不确定是否可以通过 SetEnvIfNoCase 从 mod_deflate 中排除 url。是的，nea 或语法帮助将不胜感激。

这是我的台词：

```
SetEnvIfNoCase Request_URI "(/site/*)" no-gzip dont-vary #exclude www.example.com/site/
SetEnvIfNoCase Request_URI "(/)" no-gzip dont-vary #only exclude homepage or index.php 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T15:00:18.100

所以这是解决方案。如果您需要对您的网站进行 gzip，但由于某些原因，您网站的某些部分对 gzip 压缩反应不佳 - 例如与 Magento 的第 3 方 CMS 集成。在您的 .htaccess 文件中启用 mod-Deflate 并包含以下行：

```
SetEnvIf Request_URI ^/yourdir(.*) no-gzip dont-vary 
```

yourdir 是安装 cms 的目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T03:28:01.113

根据我[对 Apache 文档的](http://httpd.apache.org/docs/2.2/mod/mod_setenvif.html)阅读，您会想要

```
SetEnvIf 
```

不是

```
SetEnvIfNoCase 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T19:22:02.100

AllInOne，正确的语法是？：

`SetEnvIf Request_URI "(/site/*)" no-gzip dont-vary`

`SetEnvIf Request_URI "(/)" no-gzip dont-vary`

# django - Django中的@login_required内部函数

> ID：11440450
> 
> 赞同：0
> 
> 时间：2012-07-11T19:57:36.477
> 
> 标签：django, login-required

我对 Django 很陌生。在我的网站上，我试图做这样的事情

```
#views.py
def index(request):
....
if request.user.is_authenticated:
    #do something
else
    #something else 
```

所以我的想法是从数据库中获取一些信息，如果用户登录则显示。我想知道，有没有办法做到这一点：

```
#views.py
def index(request):
....
    @login_required
    #do something
....
#do something else for everybody 
```

或者，如果您认为这样做是一种不好的做法，请给我一些想法如何以另一种方式做到这一点。可能我必须以某种方式更改 urls.py。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:02:23.673

`@login_required`应该在整个功能上使用（更具体地说，一个控制器）。你的第一个代码块是做你想做的事情的正确方法（除了错误的缩进）。

`@login_required`您可以使用装饰器创建单独的函数：

```
@login_required
def do_something(request):
  pass

def do_something_else(request):
  pass

def index(request):
  if request.user.is_authenticated:
    do_something(request)
  else
    do_something_else(request) 
```

但在这种情况下，这个装饰器是不必要的，因为`do_something`只有在用户通过身份验证时才会运行。然而，过多的安全并不是邪恶的。

# sql - SQL AND 运算符逻辑

> ID：11440453
> 
> 赞同：1
> 
> 时间：2012-07-11T19:57:48.060
> 
> 标签：sql, sql-server-2008

我的逻辑有问题。我一生的故事。无论如何，我有以下查询，我认为在一列中的多个字符串检查期间该查询失败。我希望能够使用`AND`运算符检查一列中的多个字符串。

例如，我想屏蔽此电子邮件“dick1sucker@gmail.com”，但我不想屏蔽“dickeynewman@gmail.com”。使用`AND`下面的运算符，如果发生任何一个字符串检查，就好像一条记录被抑制了，即使我已经用括号括住了语句。

```
/****** Script for CHECK DOMAIN SUFFIX AND VULGARITIES  ******/

SELECT EMAIL

INTO Matched_Table

FROM Matched_Table_TEMP

WHERE (RIGHT(RTRIM(EMAIL),4) IN ('.COM','.NET','.MIL','.GOV','.ORG','.BIZ') OR RIGHT(RTRIM(EMAIL),3) = '.US')

AND (CHARINDEX('DICK',EMAIL) = 0 and CHARINDEX('SUCKER',EMAIL) = 0)

AND (CHARINDEX('DICK',EMAIL) = 0 and CHARINDEX('HEAD',EMAIL) = 0)

AND (CHARINDEX('DICK',EMAIL) = 0 and CHARINDEX('CHOKE',EMAIL) = 0)

AND (CHARINDEX('DICK',EMAIL) = 0 and CHARINDEX('FACE',EMAIL) = 0)

AND (CHARINDEX('DICK',EMAIL) = 0 and CHARINDEX('NOSE',EMAIL) = 0)

AND (CHARINDEX('COCK',EMAIL) = 0 and CHARINDEX('SUCKER',EMAIL) = 0) 
```

我将在列表中添加更多的漏洞，但显然需要首先纠正逻辑。

另一个例子，现在上面抑制了以下电子邮件，但我不希望它们被抑制。

METALHEAD038@HOTMAIL.COM

BAND2FACEDKITTY@AOL.COM

ANGELFACE30_98@YAHOO.COM

TERESADICKSON921@HOTMAIL.COM

ROARINGARTICHOKE@TOMGREEN.COM

CERNOSEK@YAHOO.COM

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:09:04.853

将所有内部`and`'s（小写字母）更改为`or`'s。

您的查询正在选择有效地址，因此编写排除项的更自然方式如下：

```
AND NOT (A != 0 and B != 0) 
```

使用布尔逻辑，要否定，`p AND q`您需要否定这两个部分并将其更改`AND`为`OR`: `~p OR ~q`。

在你的情况下：

```
AND (A = 0 or B = 0) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T20:08:17.023

这些都是`AND`条件。`dick`无论电子邮件的其余部分是什么，您目前没有一个子句允许电子邮件地址包含所有内容。如果你想允许`dick`但不允许`dick`......`head`你需要稍微不同地考虑一下。例如

```
DECLARE @Email VARCHAR(255) = 'dickeynewman@gmail.com';

SELECT @Email
WHERE 
(
  RIGHT(RTRIM(@Email),4) IN ('.COM','.NET','.MIL','.GOV','.ORG','.BIZ') 
  OR RIGHT(RTRIM(@Email),3) = '.US'
)
AND 
(
  (@Email NOT LIKE '%DICK%') 
  OR 
  (@Email LIKE '%DICK%' 
    AND @Email NOT LIKE '%SUCKER%'
    AND @Email NOT LIKE '%HEAD%'
    -- ...
  )
) 
```

# c# - 实体框架 POCO - 更新集合

> ID：11440455
> 
> 赞同：3
> 
> 时间：2012-07-11T19:57:51.157
> 
> 标签：c#, entity-framework, c#-4.0, entity-framework-4, entity-framework-4.1

我有一个简单的模型，其中包含名为 customer 和 address 的类，如下所示：

```
public class Customer : BusinessEntity
{
    public string FirstName { get; set; }

    public string LastName { get; set; }

    public DateTime? DateOfBirth { get; set; }

    public decimal? CreditLimit { get; set; }

    public virtual List<Address> Addresses { get; set; }

    public string Email { get; set; }
}

public class Address : BusinessEntity
{
    public string Street { get; set; }

    public string Floor { get; set; }

    public Customer Customer { get; set; }
} 
```

我编写了一个单元测试，它使用现有地址加载客户，修改该地址并调用更新。这是代码：

```
 Customer newCustomer = new Customer();

        newCustomer.FirstName = "Cosme";

        newCustomer.LastName = "Fulanito";

        newCustomer.Email = "anemail@mail.com";

        customerPersistence.Save(newCustomer);

        Customer existingCustomer = customerPersistence.FindByID(newCustomer.ID.Value);

        Assert.IsNotNull(existingCustomer, "Customer not found after saving");

        existingCustomer.LastName = "Fulanito Modified";

        existingCustomer.Addresses = new List<Address>();

        existingCustomer.Addresses.Add(new Address { Customer = existingCustomer, Floor = "21", Street = "Peron" });

        customerPersistence.Update(existingCustomer);

        Customer loadedCustomer = customerPersistence.FindByID(newCustomer.ID.Value);

        Assert.IsNotNull(loadedCustomer, "Customer not found after updating");

        Assert.IsTrue(loadedCustomer.LastName == existingCustomer.LastName, "Last name not updated");

        Assert.IsNotNull(loadedCustomer.Addresses, "Addresses collection is null");

        Assert.IsTrue(loadedCustomer.Addresses.Count > 0, "Addresses collection is empty");

        existingCustomer = customerPersistence.FindByID(newCustomer.ID.Value);

        Assert.IsNotNull(existingCustomer, "Customer not found after updating");

        existingCustomer.Addresses[0].Floor = "40";

        customerPersistence.Update(existingCustomer);

        Assert.IsTrue(loadedCustomer.Addresses[0].Floor == "40", "Address data not modified"); 
```

Context 是对继承自 DBContext 的类的引用。我收到此错误：

> 来自“Address_Customer”AssociationSet 的关系处于“已删除”状态。给定多重约束，相应的“Address_Customer_Source”也必须处于“已删除”状态。

我错过了什么？我在 OnModelCreating 方法中定义客户和地址之间的关系的方式有问题吗？我正在这样做：

```
modelBuilder.Entity<Address>()
            .HasRequired(p => p.Customer)
            .WithMany(p => p.Addresses)
            .Map(x => x.MapKey("CustomerID")) 
```

谢谢，贡萨洛

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T04:50:44.967

请将地址属性更改为 ICollection。然后，当您更新详细信息时，检查 EntityState 是否已解除。如果它被分离，那么您必须将更新的对象（客户和地址）附加到上下文中，并且必须告诉 ObjectStateManager 该对象已被修改。

# actionscript-3 - 如何在for循环中创建一系列类实例，as3

> ID：11440465
> 
> 赞同：0
> 
> 时间：2012-07-11T19:58:35.757
> 
> 标签：actionscript-3, for-loop, addchild

在我的库中，我有一堆名为tip1、tip2、tip3、tip4 的类……等等。是否可以使用 for 循环在舞台上创建每个实例的一个实例？我试过这个，但它似乎没有用。

```
var tips:int = 12;
for(var i:int = 1; i<=tips; i++){
    var tipName:String = "tip"+i

    var tip:MovieClip = new tipName();
    tip.name = "tip" + i
    tip.x = stage.width;
    tip.y = 0;
    addChild(tip);
} 
```

任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T20:03:44.417

您缺少“getDefinitionByName”部分。

```
// Up top
import flash.utils.getDefinitionByName;

// Down below
var tips:int = 12;
for (var i:int = 1; i < tips; ++i ) {
  var myClass:Class = getDefinitionByName('tip' + i) as Class;
  var tip:Object = new myClass();
  tip.name = "tip" + i; 

....

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T20:02:58.443

代替

```
var tip:MovieClip = new tipName(); 
```

试试（凭记忆写的）

```
var clazz:Class = getDefinitionByName(tipName) as Class;
var tip:MovieClip = new clazz(); 
```

此外，您通常希望使用`stage.stageWidth`而不是`stage.width`，因为后者将返回舞台边界框宽度（可能与 swf 文件覆盖的区域不同）。

# c# - 过滤掉有条件的不同元素

> ID：11440467
> 
> 赞同：1
> 
> 时间：2012-07-11T19:58:38.927
> 
> 标签：c#, linq, lambda

我有一个对象列表，其中有一些属性重复。我想根据条件获取所有非重复项以及 1 个重复项。

例如。

列表：

1.  代码：1，等级：10
2.  代码：1，等级：20
3.  代码：2，等级：1

预期清单：

1.  代码：1，等级：20
2.  代码：2，等级：1

条件是重复元素的条件，抓住最高的那个`Grade`。我将如何编写 lambda 或 linq 表达式来做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-11T20:01:51.880

您可以使用它`GroupBy`来执行此操作：

```
var results = items.GroupBy(item => item.Code)
                   .Select(g => g.OrderByDescending(i => i.Grade)
                   .First()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T20:02:14.353

我建议你先`GroupBy`属性`Code`，然后选择`Max`组中每个元素的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T20:04:34.110

就像是

```
list.GroupBy(item=>item.Code).Select(item=>new {code = item.Key, grade = item.Max(i=>i.Grade)}).ToList(); 
```

# php - 如何使用 Web Sockets 和（数据库）用户系统来更改发送的数据？

> ID：11440473
> 
> 赞同：0
> 
> 时间：2012-07-11T19:59:14.697
> 
> 标签：php, sql, database, sockets, web

我对 websockets 有基本的了解，并且我已经在我的 VPS 主机上设置了一个 web socket 服务器。

我有一个带数据库的用户系统。我也计划有一个名为“chat_log”的表。

我想在不同的页面上使用我的网络套接字服务器。

例如，在每个用户的个人资料上都有一个聊天。

我会在数据库中有一个关于聊天发布到的列。然后它会运行一个查询来检查聊天被发布到哪里，如果它被发布到那里显示它。

我可以使用 Web 套接字实现相同的效果（结合 PHP 数据库技术）来创建基于数据库结果的聊天吗？

还有一件事，我怎么能把聊天发到哪里？如果没有发送？有没有办法从 javascript 中的 URL 获取 GET 变量并单独发送该数据，以便可以在 php 中处理它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T12:31:38.837

您不能将 $_GET 变量传递给 javascript，然后再将其传递给您的 websocket 服务器吗？假设您的 websocket 服务器有一个数据库连接。

# actionscript-3 - as3载入画面

> ID：11440474
> 
> 赞同：1
> 
> 时间：2012-07-11T19:59:15.650
> 
> 标签：actionscript-3, screen, loading, splash-screen

您如何为您的 swf 创建这些带有加载栏和百分比的“正在加载，请稍候”启动画面？as3 有一些内置方法还是应该从头开始设计？

我的意思是，您如何检测到您的 swf 文件正在加载到客户端的浏览器中？

哦，我所有的内容都只存储在一帧中。纯as3代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T20:26:43.753

如果你的所有代码都在时间线上，那么最简单的方法是制作第二个 swf，它只用于加载你的主 swf。如果调用了主 swf `main.swf`，则加载 swf 中的代码将如下所示：

```
//make a loader
var loader:Loader = new Loader()

//listen for loading progress
loader.contentLoaderInfo.addEventListener(ProgressEvent.PROGRESS, onProgress);

//listen for when the load is finished
loader.contentLoaderInfo.addEventListener(Event.COMPLETE, onComplete);

//load begins...
loader.load(new URLRequest("main.swf"));

function onProgress(event:ProgressEvent):void
{
    //calculate how much has been loaded
    var percentageLoader:Number = event.bytesLoaded / e.bytesTotal;

    //use your percentage number here to drive a loader bar graphic
}

function onComplete(event:Event):void
{
    //remove listeners now that loading is done
    loader.contentLoaderInfo.removeEventListener(ProgressEvent.PROGRESS, onProgress);
    loader.contentLoaderInfo.removeEventListener(Event.COMPLETE, onComplete);

    //add loaded swf to the stage
    addChild(loader.content);
} 
```

顺便说一句，将您的资产外部化开辟了新的预加载可能性。您可以让主 swf 加载外部资产并预加载这些资产，而不是将所有内容都放在主 swf 中。由于您的主 swf 会变小，因此没有必要仅使用第二个 swf 来加载您的主 swf。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T20:09:03.077

有几种不同的方法可以做到这一点。

您可以有一个两步过程 - 创建一个简单地加载到主文件中的 swf 文件，报告进度（通过侦听加载器上的进度事件），然后将加载的 swf 作为子文件添加。

或者，您可以将所有内容放在第 2 帧，并停留在第 1 帧，检查 root.loaderInfo.bytesLoaded 与 root.loaderInfo.totalBytes 值的比较，报告百分比，然后在完成后移至第 2 帧。

就个人而言，我认为方法 1 更好，因为你不需要用框架来玷污自己。

还有第三种方式，它使用一些奇怪的元数据标签来模拟第二种方式，但没有框架。这有点乱，但应该可以用谷歌搜索。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T20:28:08.713

Flash 有自己的组件，您可以使用它来完成此操作：

[http://help.adobe.com/en_US/ActionScript/3.0_UsingComponentsAS3/WS5b3ccc516d4fbf351e63e3d118a9c65b32-7fa4.html](http://help.adobe.com/en_US/ActionScript/3.0_UsingComponentsAS3/WS5b3ccc516d4fbf351e63e3d118a9c65b32-7fa4.html)

或者您可以从头开始构建自己的进度条：

[http://www.zedia.net/2008/the-right-way-to-do-a-preloader-in-as3/](http://www.zedia.net/2008/the-right-way-to-do-a-preloader-in-as3/)

网络上有很多资源可让您自定义进度条——浏览并找到适合您和您的编码风格的资源。

# perl - VERP 和 perl 后缀不起作用

> ID：11440475
> 
> 赞同：0
> 
> 时间：2012-07-11T19:59:22.700
> 
> 标签：perl, email, mime, postfix-mta, verp

所以我有一个脚本，我试图让 VERP 正确运行。它使用 MIME::Lite 和 postfix 作为邮件服务器。这是代码：

```
use strict;
use MIME::Lite;
use LWP::Simple;
use Mail::Verp;

my $email = 'someuser@somesite.com';
Mail::Verp->separator('+');
my $verp_email = Mail::Verp->encode('root@somesite.net', $email);
my $content = '<html><body>Hi!</body></html>';
my $msg = MIME::Lite->new(
    Subject => 'Hi',
    From => 'root@somesite.net',
    To => $email,
    'Return-Path' => $verp_email,
    Type => 'text/html',
    Data => $content
);
$msg->send('smtp', 'XXX.XXX.XXX.XXX'); 
```

当邮件被退回时，postfix 不会将其路由到 root@somesite.net 电子邮件收件箱。如何路由邮件以使退回邮件的发件人是 $​​verp_email 值？

我正在尝试创建包含电子邮件地址的所有退回电子邮件的日志，以便随后可以将其发送到文件或数据库。

如果有人能指出我正确的方向，我将非常感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T21:05:08.117

Return-Path 不是 VERP 地址的正确位置，将被忽略和/或覆盖。您需要将其作为实际的、诚实的`$dmr`、真实的 SMTP 信封发件人 ( `MAIL FROM:<>`) 地址。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-02T05:58:15.253

这个问题有点老了，但希望我的回答能对那些在谷歌搜索时发现这个问题的人有所帮助。我遇到了同样的问题，根本原因是在与目标服务器进行 smtp 交换期间，您必须使用“MAIL FROM：”。根据 MA​​IL FROM smtp 命令，在 MIME::Header 中设置返回路径会被 smtp 服务器本身覆盖。所以你可以有一个包含 From: root@somesite.net 的邮件信封，但要确保 smtp MAIL FROM 使用 $verp_email 例如，这就是我所做的：

```
my $msg = MIME::Entity->build(
    'Return-Path'   => 'bounce+user=user-domain.com@my-server.com',
    'From'      => 'admin@my-server.com',
    'To'        => 'user@user-domain.com',
    'Subject'   => $subject,
    'Errors-To' => 'bounce+user=user-domain.com@my-server.com'
);
## Then some more handling with MIME::Entity
## and finally send it over smtp

my @rcpt = $msg->smtpsend(
    ## Make it verbose for debugging
    'Debug'     => DEBUG,
    'Hello'     => 'mx1.my-server.com',
    'Host'      => 'mx.user-domain.com,
    'MailFrom'  => 'bounce+user=user-domain.com@my-server.com',
    'To'        => 'user@user-domain.com',
    'Port'      => 25,
); 
```

# css - 使用 CSS 将背景顶部与元素底部对齐

> ID：11440478
> 
> 赞同：1
> 
> 时间：2012-07-11T19:59:30.063
> 
> 标签：css, positioning

我想使用 CSS 将背景图像的顶部与元素的底部对齐（这样我可以`transition`在悬停或动画中将其放入，以防您想知道）。该元素没有设定高度；我不知道元素的高度是多少。有人知道怎么做这个吗？该解决方案不必与 IE 兼容；它只需要在最新版本的 Chrome 和 Firefox 中运行。

`<body>`编辑：如果在赏金结束时有这样的答案，我会将赏金奖励给一个也适用于该元素的答案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-09T02:07:22.583

抱歉给您添麻烦了。一定喜欢 CSS 对吧？无论如何，我有两个解决方案给你：一个只是停留在使用背景定位的范围内并实现它......对于大多数部分；另一个超出了直接解决方案，只增加了一点点，但坚如磐石，可以在任何高度上工作。两者都适用于任何宽度。

所以第一个：

这通过将xpos`background-position`的关键字值`center`和 ypos 的百分比值`1000%`设置为有效。当然，% 值可能会有所不同，但为了安全起见，我只是选择了 1000%。实际上，您可以将其放大到足以将其推离屏幕。但这是小提琴：

[http://jsfiddle.net/D5QME/](http://jsfiddle.net/D5QME/)

这个问题是，如果您将父元素的高度设置为背景图像的确切高度......它就会停止工作。如果父元素的高度缩小到低于图像的高度，它就会反转模式。因此，如果您确信父元素将始终高于 BG 图像，那么这是非常可靠的。

* * *

现在是第二个：

这个是直截了当的坚如磐石，但增加了一个额外的元素。这个额外的元素可以是占位符元素，如 a`div`或其他，或者只是直线`img`本身。这：

1) 在父级上使用`position: relative`and`overflow: hidden`将其变成一个容器

2) 使用`position: relative`、`margin: 0 auto`和`top: 100%`将图像定位在中心并将其推到父级下方

3) 并用于当用户越过父元素时`.parent:hover .backgroundImage`使图像过渡到。`top: 0%``hover`

这是小提琴：

[http://jsfiddle.net/Fwf6p/](http://jsfiddle.net/Fwf6p/)

尽管这增加了一个额外的元素，但它非常坚如磐石。

* * *

无论如何，希望这会有所帮助！

-J科尔莫里森

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T15:41:58.710

[J Cole 回答的](https://stackoverflow.com/a/11875803/1389880)另一个修改，但似乎适用于 body 标签。也可以与[Hephistocles 修改](https://stackoverflow.com/a/11907065/1389880)一起使用，但尚未测试。

CSS：

```
.example{
    border: 1px solid red;
/* Change the height to anything you want! */       
    height: 400px;
/* Change the width to anything you want! */
    width: 500px;
    position: relative;
}

.example:hover .backgroundImage{
    height: inherit;
    top: 0%;
}

.backgroundImage{
    background: url("http://img.gadgetian.com/Angry-Birds-Space-021-300x300.png") no-repeat top center;
    position:relative;
    margin: 0 auto;
    top: 100%;
    -webkit-transition: 1s ease all;
    -moz-transition: 1s ease all;
    transition: 1s ease all;
    height: 0px;    
} 
```

HTML：

```
<body class="example">
    <div class="backgroundImage"></div>
</body> 
```

[JSFiddle](http://jsfiddle.net/VGgmG/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T18:13:27.780

为了让 J Cole 的第二个答案更进一步——如果你想避免插入额外的元素，你总是可以使用伪元素。例如：

```
.myElm {
    position: relative;
    overflow: hidden;
}
.myElm:after{
    content:"";
    background: url("myimage.png") no-repeat top left;
    top:100%;
    position: absolute;
}
.myElm:hover:after {
    top:0;  
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T20:05:16.717

如果您知道元素的高度（以像素为单位），则可以将其背景位置设置为：`background-position:0 npx;`. 否则不确定。如果有最大高度，你总是可以使用它。或者有一个合理的估计/限制。然而，过渡可能不会非常一致地“缓和”。

* * *

刚才在另一个答案中有一个出色的[JSFiddle](http://jsfiddle.net/GSUv2/)，但它已被删除:(

# wpf - 翻转情节提要中的按钮

> ID：11440480
> 
> 赞同：1
> 
> 时间：2012-07-11T19:59:33.403
> 
> 标签：wpf, xaml, storyboard, pixelsense, scaletransform

我正在尝试使用情节提要翻转表单上的按钮。我目前拥有的是一个故事板，它使用自定义网格动画来使某些网格行增长（在[此处](http://www.codeproject.com/Articles/18379/WPF-Tutorial-Part-2-Writing-a-custom-animation-cla)找到）。我拥有的用于启动此情节提要的按钮上覆盖有一个箭头图像，需要将其翻转以纠正控件的方向，以便用户理解。我拥有的情节提要有效（因为它不会产生任何错误）但它只会使网格高度属性增长；按钮图像不会垂直翻转。

```
<!-- "Open the description box" Storyboard-->
<Storyboard x:Key="openDescription">
    <local:GridLengthAnimation
      Storyboard.TargetName="Row4"
      Storyboard.TargetProperty="Height"
      From="0*" To=".5*" Duration="0:0:1" 
      AccelerationRatio=".5"
      DecelerationRatio=".5"/>

    <!-- This is the section that needs to be tweaked -->
    <DoubleAnimation 
        Storyboard.TargetName="btnDetailsZoom"
        Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
        From="0"
        To="-1"
        Duration="00:00:01"/>
</Storyboard>

<!-- Code for the button -->
<s:SurfaceButton Grid.Row="4" Grid.Column="4" VerticalAlignment="Top" Margin="25,-50,25,-50" Name="btnDetailsZoom" PreviewTouchDown="onDetailsZoom">
    <s:SurfaceButton.Background>
        <ImageBrush ImageSource="/uiTest2;component/Resources/doubleArrowUp.png" />
    </s:SurfaceButton.Background>
</s:SurfaceButton> 
```

如果有人知道如何在情节提要中正确使用 scaletransform 属性（因为我相当确定这是部分正确的），我将非常感谢一些指导。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T11:52:02.537

看起来您忘记在 上定义 Transform 属性`Button`，如下所示：

```
<!-- Code for the button -->
<s:SurfaceButton Grid.Row="4" Grid.Column="4" VerticalAlignment="Top" Margin="25,-50,25,-50" Name="btnDetailsZoom" PreviewTouchDown="onDetailsZoom">
    <s:SurfaceButton.RenderTransform>
        <ScaleTransform />
    </s:SurfaceButton.RenderTransform>
    <s:SurfaceButton.Background>
        <ImageBrush ImageSource="/uiTest2;component/Resources/doubleArrowUp.png" />
    </s:SurfaceButton.Background>
</s:SurfaceButton> 
```

# objective-c - 循环直到在 Objective-C 中达到多个条件

> ID：11440485
> 
> 赞同：3
> 
> 时间：2012-07-11T19:59:47.800
> 
> 标签：objective-c, c, loops, conditional-statements

所以我正在尝试创建一个可以找到可以除以数字 1-20 的数字的程序。我知道我将不得不使用以下简单的代码概念：

我知道循环是如何工作的，以及如何创建一个在满足条件之前一直运行的循环。是否有一个简单的方法是运行一个循环，直到满足几个条件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-11T20:02:22.107

```
while ( condition1 && condition2 && condition3... ) {} 
```

或者

```
for ( int i = 0; i < n && condition1 && condition2... ) {} 
```

显然，这些将在条件为真时循环，直到满足条件。它在逻辑上进行了简单的更改，以获得您想要的结果

**编辑**

您正在寻找的那种循环的一个例子可能是：

```
int number = ...;//initialized somewhere, this is what we're checking
BOOL divisible = YES;
for ( int i = 1; i <= 20 && divisible; ++i )
{
    if ( (number % i) != 0 )
        divisible = NO;//not divisible by i
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T20:25:06.840

`break`很好的答案，但我认为在这个讨论中提到运营商很好。任何时候，任何循环都可以使用这个操作符终止。如果您不知道所有可能超出范围的参数，并且由于您可能没有明确预期的原因（例如，您与资源的连接可能是不再可用...）

```
NSError *error = nil;
while(true) {
  // run your app
  if(error) {
    break;
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T20:30:07.530

如果一个数字可以被 1 到 20 的所有数字整除，那么它可以被 1 到 20 的 LCM 整除，因此可除性测试是 if(!(n%232792560))。

进一步如果 m = pq | n 然后 p|n, q|n 所以要明确地测试你只需要检查素数的可分性。即如果数字不是偶数，则无需检查是否可被 4、6、8、10、12、14、16、18 或 20 整除。这将测试减少到与第 8 个原始数一致的数字 = 9699690

* * *

好的，也许在二读时不像我想的那样明确：扩展测试看起来像（由德摩根定理）

```
if(!(n%19 || n%17 || n%16 || n%13 || n%11 || n%9 || n%7 || n%5))
    // number is divisible by 1..20 
```

# iphone - 如何在我的 iPhone 应用程序上使用 Facebook 凭据登录？

> ID：11440491
> 
> 赞同：0
> 
> 时间：2012-07-11T20:00:15.267
> 
> 标签：iphone, facebook, facebook-graph-api, ios4

我有一个针对 Facebook 对用户进行身份验证的 Web 应用程序。一旦我的网站将他们重定向到使用 Facebook 登录，FB 就会使用有效的会话 cookie 将他们重定向回我的网站。我猜这是一个 PHPCOOKIE。

我想从我的 iPhone 应用程序中完成同样的事情。我看过 Facebook iPhone SDK，但这只是让 iPhone 应用程序直接调用图形 API。

我真正想做的是让我的后端服务器像浏览器一样调用图形 API。

如何让 iPhone SDK 将会话 cookie 传递给我的服务器的所有请求，就像浏览器一样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T20:21:07.037

这确实发生了——但你在 iPhone 上，并且 iPhone 缓存了带有身份验证信息的“cookie”。它在 NSDefaults 中。它也称为单点登录或 SSO。它在同一设备上的本机应用程序上检测 Facebook 登录和身份验证，并为进一步的图形请求设置本地（iPhone 应用程序默认）访问令牌。

# wcf - TransactionFlow(TransactionFlowOption.Mandatory) OperationBehavior(TransactionScopeRequired = true

> ID：11440494
> 
> 赞同：3
> 
> 时间：2012-07-11T20:00:23.107
> 
> 标签：wcf

我试图了解 WCF 事务，但在一个概念上苦苦挣扎。行为方式有什么不同

```
TransactionFlow(TransactionFlowOption.Mandatory) 
```

和

```
OperationBehavior(TransactionScopeRequired = true) 
```

据我从文档中可以看出，它们是实现同一目标的两种方式，但我无法真正弄清楚。

干杯，

斯蒂芬

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T20:19:04.803

当方法需要事务范围时，WCF 将创建一个事务来执行该方法的逻辑。事务流允许您将事务链接起来，以便需要事务的多个服务方法都可以连接到一个事务中，而不是单独的事务。

考虑以下简单设置：

```
[OperationBehavior(TransactionScopeRequired = true)]   
public void ServiceMethod1()
{
    // Executes ServiceMethod2 and ServiceMethod3
}

[OperationBehavior(TransactionScopeRequired = true)]
[TransactionFlow(TransactionFlowOption.Mandatory)]    
public void ServiceMethod2()

[OperationBehavior(TransactionScopeRequired = true)]
[TransactionFlow(TransactionFlowOption.Mandatory)]    
public void ServiceMethod3() 
```

ServiceMethod1 需要一个事务，因此 WCF 启动一个事务，然后调用 ServiceMethod2 和 ServiceMethod3。尽管这些服务也需要事务，但它们是流动的。因此，它们没有启动新事务，而是采用由 ServiceMethod1 创建的相同事务。如果在此过程中出现任何故障或事务未提交，则整个链都会回滚。如果事务没有流动，每个方法都会启动一个事务，该事务会自行执行，并且对调用的其他方法没有影响。

# sql-server - 如何通过防火墙连接到 SQL Server

> ID：11440496
> 
> 赞同：-3
> 
> 时间：2012-07-11T20:00:33.217
> 
> 标签：sql-server, port

我在我们的 Intranet 中有一个 SQL Server（集群命名实例），我们在 Intranet 之外有一个应用程序。

我们如何设置从我们的应用程序到数据库的连接（端口开放？）。

请建议

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:05:11.293

您可以打开一个端口并将端口号附加到连接字符串中使用的服务器名称或 IP 地址 - 用逗号分隔，这允许您连接到 SQL。

# scala - 在 Scala 中创建使用枚举作为键的 Map 的语法是什么？

> ID：11440497
> 
> 赞同：9
> 
> 时间：2012-07-11T20:00:42.963
> 
> 标签：scala

请看下面的代码。此行被 Eclipse 标记为不正确：

```
var map = Map[MyEnum,Point]() 
```

我正在尝试做 Java 的 scala 等价物：

```
private enum Letters{ A,B,C}
private Map<Letters,Integer> thing= new HashMap<Letters,Integer> (); 
```

这是写入它的文件/上下文。

```
class Point(var x:Int = 0, var y:Int = 0, var hasBeenSet:Boolean = false){

}

object MyEnum extends Enumeration{
    MyEnum = Value
    val UL,U,UR,L,R,DL,D,DR = Value
}

object MyEnumHolder {
  var map = Map[MyEnum,Point]()
  MyEnum.values.foreach(x => (map + (x -> new Point()) ) 
} 
```

我正在尝试初始化映射的实例，其中枚举的每个值都映射到一个空点（这就是 for each 循环中发生的事情）。

**编辑：必须编辑，因为我在编辑粘贴的代码时搞砸了一些事情，但现在应该有效**

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-11T20:17:49.067

```
var map = Map[MyEnum.Value, Point]() 
```

或者我更喜欢

```
import MyEnum._
var map = Map[MyEnum,Point]() 
```

编辑：为了稍微解释一下这意味着什么，在枚举`Value`中是类型和方法的名称。 `type MyEnum = Value`基本上只是为`Value`类型声明一个别名，下一行`val UL, U... = Value`是调用该方法来生成枚举，每个枚举都有 type `MyEnum.Value`。因此，在声明映射时，您必须引用此类型才能让键存储枚举。您也可以使用`MyEnum.MyEnum`，但首先声明类型别名的原因是您可以将其导入范围并能够像`MyEnum`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T20:20:32.067

您没有放入`MyEnums`地图，而是以下*值*：`MyEnum`

```
var map = Map[MyEnum.Value, Point]() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-11T20:24:10.217

```
object MyEnum extends Enumeration {
  type MyEnum = Value /* You were missing keyword "type" here */
  val UL,U,UR,L,R,DL,D,DR = Value
}

object MyEnumHolder {
  import MyEnum.MyEnum /* Import this, otherwise type MyEnum can't be found */

  var map = Map[MyEnum, String]()
  MyEnum.values.foreach(x => (map + (x -> x.toString)))
} 
```

您可能还想看看[Case classes vs Enumerations in Scala](https://stackoverflow.com/questions/1898932/case-classes-vs-enumerations-in-scala)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-11T20:22:46.120

我得到它与以下工作。我承认，语法有点古怪。

```
object MyEnum extends Enumeration {
    type MyEnum = Value
    val UL, U, UR, L, R, DL, D, DR = Value
}

object Main extends App {
    Map[MyEnum.MyEnum, String]()

} 
```

虽然我猜它可以帮助多元化

```
object Diaries extends Enumeration {
    type Diary = Value
    val Steven, Jessica, Bob = Value
}

import Diaries._

val currentDiary = Steven

val interestingDiaries = List[Diary](Steven, Jessica) 
```

所以这里的Diaries就是Diary的列表，Diary就是列表中的*具体*日记。

# google-plus - 如何在 Google Plus 徽章的新窗口中打开链接？

> ID：11440498
> 
> 赞同：0
> 
> 时间：2012-07-11T20:00:45.040
> 
> 标签：google-plus, google-plus-one

我的网站中有[Google Plus Badge](https://developers.google.com/+/plugins/badge/config)和[Google +1 按钮](https://developers.google.com/+/plugins/+1button/)
的代码， 我需要在新窗口中打开指向 Google+ 页面（由 Badge 生成）的链接。

如果您有其他方法，我需要：

*   链接到 Google+ 信息页。
*   添加添加到圈子的功能。
*   +1 带有计数的按钮。

都在一条线上。

我的代码如下所示：

```
<table>
<tr>
<td style="padding-top:2px; vertical-align:top;"><div style="width:180px; height:30px;     overflow:hidden;">
<div style="margin-top:-15px; margin-left:0px;" title="International Studies Google         Plus">
                <style type="text/css">
                             #___plusone_0, #___plusone_0         iframe{
                                 width:66px !important;
                             }
                            </style>
                <div class="g-plus" data-href="https://plus.google.com/118182458881247471225?rel=publisher" data-width="170" data-height="69" data-theme="light"></div>
              </div>
            </div></td>
              <td style="padding-top:6px; padding-left:5px;"><g:plusone></g:plusone>    </td>
</tr>
</table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T17:32:31.473

你不能这样做。

徽章不提供任何允许您在新窗口中打开链接的标志。它也是提供您需要的“添加到圈子”功能的唯一功能。

您可以获得的最接近的方法是使用静态徽章和 +1 按钮：

```
<div>
  <a href="https://plus.google.com/118182458881247471225?prsrc=3" rel="publisher" style="text-decoration:none;" target="_blank">
  <img src="//ssl.gstatic.com/images/icons/gplus-32.png" alt="Google+" style="border:0;width:32px;height:32px;"/></a>

  <div class="g-plusone" data-annotation="inline" data-width="300"></div>
</div> 
```

Also, it looks like there's a [feature request](http://code.google.com/p/google-plus-platform/issues/detail?id=316) for this functionality. If you star this feature request, you'll be notified about updates.

# php - 在 PHP 5.4.4 中使用 PDO DBLIB 调用 3 个存储过程失败

> ID：11440499
> 
> 赞同：1
> 
> 时间：2012-07-11T20:00:56.843
> 
> 标签：php, sql-server, pdo

我尝试在 PHP 5.4.4 (Linux) 中使用 PDO DBLIB 一个接一个地调用 3 个 SQL Server 2000 存储过程，并且在第二个查询中出现错误：**致命错误：调用非成员函数 fetchAll()目的**

第一个查询完美运行，按预期返回结果。如果我移动查询顺序，每次第一个查询成功而其他查询失败。

此外，当完全相同的代码在 PHP 5.3.14 服务器上运行时，一切正常。

示例代码：

```
$dbh = new PDO ("dblib:host=myhost;dbname=mydb","user","pass");

$query = $dbh->query("EXEC dbo.storedProc1 'param1'");
$result = $query->fetchAll();
var_dump($result);

$query = $dbh->query("EXEC dbo.storedProc2 'param1'");
$result = $query->fetchAll(); // <-- Fails here
var_dump($result);

$query = $dbh->query("EXEC dbo.storedProc3 'param1'");
$result = $query->fetchAll();
var_dump($result); 
```

有什么线索可以让这段代码在 PHP 5.4 上运行吗？

**编辑：** PDO::errorInfo 给了我这个错误：`Attempt to initiate a new Adaptive Server operation with results pending [20019] (severity 7) [EXEC dbo.storedProc2 'param1']`

此外，使用 SELECT 调用`query`（例如 SELECT 1、SELECT 3 和 SELECT 3）给出相同的结果（给出第一个结果，以下为空）

**编辑 2：**看起来它与[PHP 错误](https://bugs.php.net/bug.php?id=64522)有关，正如 Capilé 在评论中注意到的那样

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T20:41:28.217

我将竭尽全力说您的存储过程返回的结果集不止一个。要么，要么 SQL Server 2000 死心塌地地坚持在下一个查询为空时关闭游标。无论哪种方式，这应该可以解决问题：

```
$dbh = new PDO ("dblib:host=myhost;dbname=mydb","user","pass");

$results = array();
$query = $dbh->query("EXEC dbo.storedProc1 'param1'");
do {
  $results[] = $query->fetchAll();
} while ($query->nextRowset());
$query->closeCursor();
var_dump($results);

$results = array();
$query = $dbh->query("EXEC dbo.storedProc2 'param1'");
do {
  $results[] = $query->fetchAll();
} while ($query->nextRowset());
$query->closeCursor();
var_dump($results);

$results = array();
$query = $dbh->query("EXEC dbo.storedProc3 'param1'");
do {
  $results[] = $query->fetchAll();
} while ($query->nextRowset());
$query->closeCursor();
var_dump($result); 
```

请注意，实际使用时`$results`它会比您预期的更深一层，因为它可以存储多个结果集，并且这些结果集将存储在单独的键中。

# android - 平板电脑的图像按钮 Xml 和活动错误

> ID：11440501
> 
> 赞同：0
> 
> 时间：2012-07-11T20:01:10.600
> 
> 标签：android, eclipse, layout, imagebutton

对不起英语首先这是我的应用程序的主屏幕：

[![主要的](../Images/edaa38fbcfb2598eb978da7d173d7948.png)](https://i.stack.imgur.com/006CP.jpg)

好的，所以我为 android 创建了一个壁纸应用程序，当我以这种方式使用图像按钮获取我的 xml 文件时： [![无误版本](../Images/283e4458c225c5ce924bc358a205ee13.png)](https://i.stack.imgur.com/kFX1U.jpg)

它工作得很好。

但是当我有这种格式的平板电脑时： [![错误版本](../Images/4c2062badb629d1691ae418d325a88ec.png)](https://i.stack.imgur.com/ji3Cv.jpg)

这个版本当我回到主屏幕并选择一个不同的类别时，我得到强制关闭，我不知道为什么，第一个版本它不强制关闭但其他布局呢？我不明白它可以有人帮助我。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T21:59:54.273

好的，由于某种原因，我发现了错误，android 不喜欢这种布局格式，必须更改它，无论如何，谢谢大家

# python - 在 Opencv 中使用 writeFrame 的奇怪行为

> ID：11440502
> 
> 赞同：0
> 
> 时间：2012-07-11T20:01:15.873
> 
> 标签：python, video, opencv

我在使用 OpenCV 的视频创建功能时遇到了一个小问题。

对于相同的图像，我会根据我想要的输出大小得到一个奇怪的输出。

这是我可以获得的结果的示例。

[http://www.youtube.com/watch?v=1wm8VjyfdyA&feature=youtu.be](http://www.youtube.com/watch?v=1wm8VjyfdyA&feature=youtu.be)

我在不同的计算机上尝试了几组不同的图像。它似乎在 Windows 上运行良好，我对 Ubuntu 软件包（当前 2.3.1-7）中附带的 Opencv 有问题。

由于这个问题在我的 Windows 上无法重现，我猜它要么在 2.4 中修复，要么特定于 Linux。

这是突出问题的（python）测试代码：

```
import os
import cv

in_dir = "../data/inputs/sample-test"
out = "output.avi"

# loading images, create Guys and store it into guys
frameSize = (652, 498)
#frameSize = (453, 325)
fourcc = cv.CV_FOURCC('F', 'M', 'P', '4')
my_video = cv.CreateVideoWriter(out, 
                              fourcc, 
                              15, 
                              frameSize,
                              1)

for root, _, files in os.walk(in_dir):
    for a_file in files:
        guy_source = os.path.join(in_dir, a_file)
        print guy_source
        image = cv.LoadImage(guy_source)

        small_im = cv.CreateImage(frameSize, 
                                  image.depth ,
                                  image.nChannels)        
        cv.Resize(image, small_im, cv.CV_INTER_LINEAR)
        cv.WriteFrame(my_video, small_im)

print "Finished !" 
```

我担心的是，根据输出大小，视频很好（例如，652、498 可以）。无论我使用什么编解码器，行为都是一样的。

如果不是修复，我想了解更多有关此错误原因的信息。由于我想为 Ubuntu 发布，我最好使用他们的打包系统并保留 2.3 一段时间。

所以我想知道如何通过选择受过教育的尺寸来明智地解决问题。

欢迎任何信息

谢谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T20:24:42.963

这是视频编码中的常见问题。如您所见，图像每行向左移动了一小部分。

您可能知道，图像保存为一长排字符：BGRBGRBGR.... 它还由其宽度和高度以及步长定义 - 两个连续行之间的距离（以字节为单位）。一个天真的假设是步长是 3（通道）* 宽度。但此外，出于内存对齐的原因，图像行被填充了一些额外的位，以使步长值成为 4（通常）或 16 的倍数。原因是硬件编解码器加速适用于对齐的数据 - 32 位架构一次读取 32 位，对于 SIMD 处理，对齐的数据加载速度更快。

所以图像将表示为

```
BGRBGR00
BGRBGR00 
```

现在，如果编解码器不知道此填充，它将读取图像的宽度为 2，并将数据解释如下：

```
BGRBGR
00BGRB
0000BG // note the extra padding 
```

为确保您不会遇到此问题，您应该以步长值（通道*宽度）为四的倍数的方式选择图像宽度。所有标准分辨率都具有此属性，这是选择它们的原因之一：

```
640x480
1024x768
etc 
```

# jquery - jquery 从相同的表单中选择值

> ID：11440506
> 
> 赞同：0
> 
> 时间：2012-07-11T20:01:26.533
> 
> 标签：jquery, html

我正在自学 php 和 mysql。我正在创建一个小型商务网站来测试我的技能。我在这样的页面上有多个表单

```
<div class="formInfo"><form name="CartForm" method="post" action="./ajax/addCart.php" class="fixed">
<input name="prodId" type="hidden" value="10" />
  <label for="qty">Quantity:</label>

  <input name="qty" type="text" id="qty" size="4" maxlength="6" class="qtyBox">
  <br>
  <input type="submit" name="addtoCart" id="addtoCart" value="Add to Cart" class="btnAdd">
</form>

<div class="formInfo"><form name="CartForm" method="post" action="./ajax/addCart.php" class="fixed">
<input name="prodId" type="hidden" value="7" />
  <label for="qty">Quantity:</label>

  <input name="qty" type="text" id="qty" size="4" maxlength="6" class="qtyBox">
  <br>
  <input type="submit" name="addtoCart" id="addtoCart" value="Add to Cart" class="btnAdd">
</form>

<div class="formInfo"><form name="CartForm" method="post" action="./ajax/addCart.php" class="fixed">
<input name="prodId" type="hidden" value="9" />
  <label for="qty">Quantity:</label>

  <input name="qty" type="text" id="qty" size="4" maxlength="6" class="qtyBox">
  <br>
  <input type="submit" name="addtoCart" id="addtoCart" value="Add to Cart" class="btnAdd">
</form> 
```

现在，当我单击 sumbit 按钮时，我想显示隐藏字段 id 和可见字段 qta （当前单击的表单）的值，到目前为止我的代码是

```
<script type="text/javascript">
$(document).ready(function(e) {
    $('.formInfo').submit(function() {
        alert($(this).val())
    });
});
</script> 
```

我想不通。如何告诉 jquery 我想要“this”引用的“id”和“qty”值而不是引用本身的值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:04:18.093

首先，在同一个 HTML 文档中不能有多个具有相同`id`. 您必须将它们更改为类似`qty1`and `qty2`。您将事件绑定到`<div>`，而不是表单。您还需要选择输入元素。试试这个：

```
$(document).ready(function(e) {
    $('.formInfo form').submit(function() {
        $("input[type=hidden],input[name=qty]",this).each(function(){
            alert($(this).val());
        });
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T20:10:06.747

如前面的答案所述，ids 应该是唯一的，您需要将提交绑定到表单而不是 div，您可以通过表单元素的名称访问表单成员

```
$(document).ready(function(e) {
    $('.formInfo form').submit(function() {
        alert(this.prodId.value);
        alert(this.qty.value);
    });
}); 
```

[小提琴](http://jsfiddle.net/wC2YC/)

# wpf - 手动添加 DataGrid 单元格（无类）

> ID：11440512
> 
> 赞同：-1
> 
> 时间：2012-07-11T20:01:49.330
> 
> 标签：wpf, datagrid

我目前的问题是：我正在尝试为我的程序制作一个语言编辑器。为此，我想要一个多语言的编辑支持。语言文件基于“Key”和“Value”。所以如果我加载一个语言文件，它应该列出所有条目。现在如果我加载另一个文件，应该只添加一个新列。当密钥不存在时，单元格应该是空的。

我希望你明白了，对糟糕的英语感到抱歉（我真的必须改进它......）

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:32:52.543

您可以使用此签名创建对象：

```
public class Entry
{
     public string Key { get; }
     public Dictionary<string,string> Values { get; }
} 
```

您只需查看是否存在密钥，如果不创建新条目，则获取现有条目。然后将特定语言的值添加到`Values`, 键是语言。然后添加一个绑定到的列`Values[lang]`。

# resize - 彩盒函数，例如 $.colorbox.resize(); 和 $.colorbox.close(); 从外部 HTML (Ajax) 实现内部

> ID：11440513
> 
> 赞同：0
> 
> 时间：2012-07-11T20:01:51.263
> 
> 标签：resize, colorbox

在本地构建网站的大部分内容时，我的这种策略非常有效。当我将它移到服务器上以更恰当地链接时，它坏了。我检查了我的文件路径，一切看起来都很好。

我正在尝试在 HTML 之外打开（但从站点内部）。这些页面是串联的——就像您将一系列图像串联起来一样。单击下一个或上一个可以很好地加载内容，但是有机会拥有不同数量的内容，我需要调整大小。这是在本地工作，而不是在服务器上工作。同样，自定义关闭按钮也不会关闭。

```
$("a.colorbox-personnel").colorbox({
    opacity:.75,
    scrolling:false,
    onComplete:function() {
        $("ul.prev-next li a").live("click",function(event){
            event.preventDefault();
            $("#cboxLoadedContent").load($(this).attr("href"), function(){
                $.colorbox.resize();
            });
        });
        $("a.team-popup-close").live("click",function(event){
            $.colorbox.close();
        });
    }    
}); 
```

我尝试调用其他颜色框函数，例如：

```
$("ul.prev-next li a").live("click",function(event){
    event.preventDefault();
    $("#cboxLoadedContent").load($(this).attr("href"), function(){
        $.colorbox.resize();
        **$.fn.colorbox({href: $(this).attr("href")});**
    });
}); 
```

它在我的顶部加载了另一个颜色框实例。所以我觉得 Colorbox 连接正确，只是没有触发调整大小或关闭。非常感谢所有帮助。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T16:22:48.877

您是否查看过是否产生任何错误？你的 JavaScript 控制台说什么？

我的猜测是您正在加载的 HTML 片段 ($(this).attr("href")) 包含指向 jQuery 库的脚本元素。这将替换文档中原始存在的 jQuery 实例，这也会删除颜色框。这当然会导致 colorbox 的方法失败。

# python - 更改多处理队列中的变量

> ID：11440516
> 
> 赞同：1
> 
> 时间：2012-07-11T20:01:55.773
> 
> 标签：python, python-2.7

有没有办法在将值放入队列后更改它们？例如，如果我有一个队列中有几个变量，我可以将第一个变量与队列中没有的其他值相加吗？最好的方法是这样的：

```
x = queue.get()
queue.put(x+some_value) 
```

或者有没有办法在不先从队列中删除对象的情况下做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:15:49.803

您可能需要共享值，例如 multiprocessing.Value、multiprocessing.Array，而不是队列。队列不允许。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T20:30:06.950

队列不允许以这种方式访问​​；您要求直接访问仍在队列中的对象，这违背了队列的目的。

我认为您可能正在寻找的是要使用的 deque 对象而不是队列（在此处阅读：http: [//docs.python.org/library/collections.html#collections.deque](http://docs.python.org/library/collections.html#collections.deque)）

双端队列对象是线程安全的，可以像队列一样运行，同时仍允许使用索引值直接访问其成员。但是，除非您访问双端队列的左端或右端，否则随机访问速度较慢，因此，如果我正确理解了您的问题，这在您的情况下应该不是问题。

但是，如果您确实对双端队列有很多随机访问，则只需使用 multiprocessing.array 代替。

# c# - 改变输入类型

> ID：11440520
> 
> 赞同：0
> 
> 时间：2012-07-11T20:02:18.393
> 
> 标签：c#, asp.net-mvc-3, input

我目前有一个按钮类型的输入，但我想更改按钮的外观以匹配我的其他网页按钮，但我遇到了问题：

此输入按应有的方式工作，但不显示我希望它为按钮显示的图像：

```
<input type="button" src="<%:Url.Content("~/Content/images/newCancel.png")%>" onclick="goBack()"/> 
```

这显示了图像，但不能正常运行 - 它不执行 javascript：

```
<input type="image" src="<%:Url.Content("~/Content/images/newCancel.png")%>" onclick="goBack()"/> 
```

任何帮助都会很棒

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T20:04:52.267

具有图像类型的输入提交表单。放一个“return false;” 在 onclick 结束时，它应该阻止表单的提交。

```
<input type="image" src="<%:Url.Content("~/Content/images/newCancel.png")%>" onclick="goBack(); return false;"/> 
```

或者，您可以只创建图像并将事件直接添加到图像中。

```
<img src="<%:Url.Content("...")%>" onclick="goBack();" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T20:04:26.543

尝试类似：

```
<input type="button" onclick="goBack()"/> 
```

并使用 CSS：

```
input[type='button'] {
    background: url('../Content/images/newCancel.png') no-repeat;
} 
```

如果您想使用嵌入式样式或内联样式，您可以访问该`@Url.Content()`方法，但我建议您不要这样做。

# java - 鼠标绘图程序Java

> ID：11440521
> 
> 赞同：1
> 
> 时间：2012-07-11T20:02:19.937
> 
> 标签：java, graphics, drawing, jpanel

我被困在一个项目中，我必须实现一系列最终形成功能绘图程序的几个类。我的问题是运行测试程序时绘图无法正常工作。为了给你一个基本的想法，我实现了`MyLine, MyRectangle, MyOval`所有形状的子类 superclass `MyShape`。这些子类中的每一个都实现了自己的`draw`方法，该方法将 Graphics 参数作为参数。然后我实现了两个类来设计可以使用鼠标在其上绘制这些形状的界面。这两个类，`DrawPanel`和，分别`DrawFrame`扩展`JPanel`和`JFrame`。

我有一种感觉，错误出在 的重写`paintComponent`方法中`DrawPanel`，或者在`repaint()`调用方法的方式中。当我运行程序时会发生什么，整个窗口会正确显示所有菜单等，但是当我尝试绘制形状时会发生以下两种情况之一：

1.  屏幕上什么也没有发生。
2.  如果我真的快速移动鼠标，我可能会得到一些颜色和形状正确的小涂鸦。

另外，我注意到如果我添加`super.paintComponent(g2)`命令，我会得到正确的白色背景，我可以看到形状被拖出非常快，但它们实际上从未留在屏幕上。

这是我的代码`DrawPanel`，我很确定这是发生错误的地方：

```
import java.awt.Color;
import java.awt.Graphics;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.awt.event.MouseMotionListener;

import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.plaf.basic.BasicTabbedPaneUI.MouseHandler;

public class DrawPanel extends JPanel {

private MyShape[] shapes;
private int shapeCount;
private int shapeType;
private MyShape currentShape;
private Color currentColor;
private boolean filledShape;
private JLabel statusLabel; 
private Graphics gTest;

DrawPanel(JLabel P){
    shapes= new MyShape[100];
    shapeCount=0;
    statusLabel=P;
    currentColor= Color.black;
    currentShape=null;
    setBackground(Color.white);
    shapeType=1;  
    Mouse handler= new Mouse();
    addMouseListener(handler);
    addMouseMotionListener(handler);

}

@Override
protected
void paintComponent(Graphics g2){
    super.paintComponent(g2);
    while(shapeCount>1 && currentShape!=null)
    {
        currentShape.draw(g2);
        shapeCount--;
    }
}

//set methods

void setColor(Color c){
    currentColor=c;
}
void setFill(boolean f){
    filledShape= f;
}

void setShape(int s){
    shapeType=s;
}

void clearLastShape(){
    if(shapeCount==0)
        System.out.print("There are no more shapes to clear");
    else
        shapeCount--;
        repaint();
}

void clearDrawing(){
    shapeCount=0;
    repaint();
}

 class Mouse extends MouseAdapter implements MouseMotionListener{

     @Override
    public
     void mousePressed(MouseEvent e){
         if(shapeType==1)
             currentShape= new MyLine();
         else if(shapeType==2)
             currentShape= new MyRectangle();
         else
             currentShape= new MyOval();
         currentShape.setX1(e.getX());
         currentShape.setY1(e.getY());
         currentShape.setColor(currentColor);
         if(shapeType==2 || shapeType==3){
             ((MyBoundedShape) currentShape).setFill(filledShape);
         }
     }
     @Override public void mouseReleased(MouseEvent e){
         currentShape.setX2(e.getX());
         currentShape.setY2(e.getY());
         shapes[shapeCount]=currentShape;
         shapeCount++;
         currentShape=null;
         repaint();

     }
    @Override
    public void mouseMoved(MouseEvent e){
        statusLabel.setText("("+e.getX()+","+e.getY()+")");
    }
    @Override
    public void mouseDragged(MouseEvent e){
        mouseMoved(e);
        currentShape.setX2(e.getX());
        currentShape.setY2(e.getY());
        repaint();
    }
}
} 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T20:09:03.373

您永远不会遍历数组来绘制数组持有的 Shapes。您更改了 shapeCount 变量，但如果您不使用它来抓取数组中的某个 Shapes，那么它本身就没有任何作用。如果这是您的目标，我建议您尝试这样做。

事实上，您可能不应该更改 paintComponent 内部的 shapeCount 变量，因为这会清除您的绘图。

# ios - 使用 MKStoreKit 下载购买的内容

> ID：11440526
> 
> 赞同：1
> 
> 时间：2012-07-11T20:02:28.067
> 
> 标签：ios, mkstorekit

我正在考虑使用 MKStoreKit 来处理应用内购买、服务器产品模型、非消耗品，其中产品 ID 对应于一个购买的数据文件。

验证产品 ID 的默认服务器脚本 verifyProduct.php 返回 YES 或 NO 字符串，仅指示收据是否有效。不是返回 YES 值，而是修改脚本以返回给定产品 ID 的内容 URL 是否正确，以便设备可以下载购买的内容？

是否有任何从以这种方式接收的 URL 启动下载的示例？我试图了解在成功完成购买后单击产品表中的“购买”按钮如何开始下载所选行。

谢谢你的帮助

吉姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T23:53:08.453

MKStoreKit 调用服务器的 verifyProduct.php，返回值为 YES 将导致 MKSK 调用 verifyReceiptOnComplete 的 completionBlock。因此，您应该在客户端代码中实现它，而不是更改服务器 API。

# javascript - jQuery Dialog 下拉列表没有第二次出现

> ID：11440527
> 
> 赞同：0
> 
> 时间：2012-07-11T20:02:29.503
> 
> 标签：javascript, jquery, jquery-ui

我正在使用一个 jQuery 模态对话框来显示一个下拉列表供用户选择。我通过将它们附加到空的下拉列表来动态填充下拉列表。这第一次有效，然后第二次通过它只显示默认选项，而不是动态选项？

```
function showExportDialog() {
    //create html string for drop down list
    var selectString = "<div><select id=\"selectExport\" style=\"width: 100%\"><option>-- Select Export --</option></select></div>";

    //initialize the dialog - register click handler
    var $dialog = $(selectString).dialog({
        autoOpen: false,
        title: 'Export Dialog',
        modal: true,
        //dims screen to bring dialog to the front
        width: 500,
        buttons: {
            "export": function() {
                exportAs($('#selectExport').val());
                $(this).dialog('close');
            }
        }
    });

    //dynamically generate drop down list based on model type
    switch (modelType) {
    case "SPATIAL_STATISTICAL":
        $('#selectExport').html(''); //clear the drop down list
        $("<option value='csv'>CSV (comma separated value)</option>").appendTo("#selectExport");
        $("<option value='tab'>TSV (tab separated value)</option>").appendTo("#selectExport");
        $("<option value='heat'>Heatmap (google heatmap layer format)</option>").appendTo("#selectExport");
        break;
    case "STATISTICAL":
        break;
    case "GRAPH":
        break;
    case "PATTERN":
        break;
    default:
        throw "Invalid ModelType '" + modelType + "'";
    }

    //open the dialog
    $dialog.dialog('open');
} 
```

这是一个显示我的问题的小提琴：http: [//jsfiddle.net/b3v3R/21/](http://jsfiddle.net/b3v3R/21/)

要重现问题：

1.  单击“显示导出下拉菜单”
2.  从下拉列表中选择一个选项
3.  点击“导出”
4.  再次单击“显示导出下拉菜单”

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T20:13:02.233

如果您检查 firebug，则每次单击按钮时都会创建一个新对话框。因为您的选择列表有一个 ID，所以您现在使用该 ID 创建了 2。在随后的按钮单击中，将创建一个新对话框 (div)，并创建一个具有**相同 ID**的新选择列表。

因为您按 ID 向选择列表添加选项，所以它选择第一个，而不是新创建的。您应该创建一次对话框，然后动态更新一个选择列表。

试试这个小提琴：http: [//jsfiddle.net/scalvert/Hy6ex/2/](http://jsfiddle.net/scalvert/Hy6ex/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T20:24:04.100

在 showExportDialog 函数中首先添加以下行。

$("#selectExport").remove();

您每次都在创建新对话框。所以总是删除前一个。

# xcode - UITabBarController segue 转换

> ID：11440529
> 
> 赞同：0
> 
> 时间：2012-07-11T20:02:35.483
> 
> 标签：xcode, uitabbarcontroller, modal-dialog, segue

我只是有一个问题，关于我在 UITabBarController 的不同选项卡之间的转换中遇到的问题。我在每个选项卡中都放置了一个 UIGestureRecognizer，我想让每个识别器在启动时前进到相应的相邻选项卡。识别器在功能上运行，但是当 segue 发生并且下一个选项卡出现时，选项卡 BAR 消失。我查看了这个网站以及 Apple 关于如何强制显示 TabBar 的文档，但我已经尝试过诸如“hidesBottomBarWhenPushed = NO”之类的方法，但无济于事。我在情节提要中缺少什么吗？或者这个功能根本不可能？我已经为过渡尝试了“推”和“模态”，

我的 segues 流看起来像一个圆圈，在属于 TabBarController 的每个 ViewController 中有两个滑动识别器，它们指向它旁边的“左”和“右”视图控制器

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T20:38:34.337

我不认为你想要这个。当您检测到手势时，您需要做的就是将`selectedViewController`您的属性设置`UITabBarController`为正确的“邻居”控制器。

# c# - 来自列表的控制的 C# 事件

> ID：11440530
> 
> 赞同：0
> 
> 时间：2012-07-11T20:02:36.867
> 
> 标签：c#, list, events, controls

这是我的代码：

```
List<TabPage> _tpList = new List<TabPage>();
int _iTabCount = 0;

    TabPage CreateNewTab(string sTitle)
    {
        TabPage t = new TabPage();
        t.BackColor = Color.White;
        t.Text = sTitle;
        _tpList.Add(t);
        this.Tab.Controls.Add(_tpList[_iTabCount]);
        _iTabCount++;
        return _tpList[_iTabCount - 1];
    } 
```

我想处理 List 中的 Control 之一的 Click 事件`_tpList`。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:08:22.327

为什么不只使用从其父类获取的Control.MouseClick [。](http://msdn.microsoft.com/it-it/library/system.windows.forms.control.mouseclick.aspx)`TabPage`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T20:10:37.110

您可以在创建 tabPage 之后添加事件处理程序

```
TabPage t = new TabPage(); 
t.Click += new System.EventHandler(this.tabPage1_Click);
.....
this.Tab.Controls.Add(_tpList[_iTabCount]);    
..... 
```

并添加如下代码：

```
 private void tabPage1_Click(object sender, EventArgs e)
    {
        TabPage t = sender as TabPage;
        if(t.Text == "MyPage")
           ......
    } 
```

最终，您可以使用 TabPage 的 Tag 属性或 Name 属性为页面设置唯一标识符，这样您就可以更好地检查 tabPage1_Click 以发现实际点击的页面。

但是，我想指出，了解选项卡控件上哪个选项卡页处于活动状态的最佳方法是处理选项卡控件本身上的 Selected 事件。该事件有一个 TabControlEventArgs 包含当前选定的标签页。

```
 private void tabControl1_Selected(object sender, TabControlEventArgs e)
    {
        Console.WriteLine(e.TabPage.Text);
    } 
```

# snmp - 无法使用 SNMP 获取 Linux 磁盘空间

> ID：11440532
> 
> 赞同：0
> 
> 时间：2012-07-11T20:02:45.053
> 
> 标签：snmp

我使用“disk /”在 /etc/snmp/snmpd.conf 中启用了磁盘监控服务。但是当我运行 snmpwalk 时，我没有得到任何与磁盘空间相关的信息。我错过了什么吗。

任何帮助，在此先感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T22:11:06.663

我得到了答案，我还没有启用 snmpd.conf 中的所有 oid。现在我正在获取磁盘使用情况。

# php - 我如何将 preg_replace 正则表达式用于 2 个场景？

> ID：11440535
> 
> 赞同：0
> 
> 时间：2012-07-11T20:02:50.513
> 
> 标签：php, regex

我正在尝试获取某些页面上的图像来源，但两个页面的代码之间存在一些差异。

第 1 页代码：

```
<img class="thumb thumb_0" onclick="setImage(0); return false;" src="http://example.com/b1.jpg"> 
```

第 2 页代码：

```
<img style="width: 46px ! important; height: 46px ! important;" class="thumb thumb_0" onclick="setImage(0); return false;" src="http://example.com/image4.jpg"> 
```

注意 2 页之间的区别... 第 2 页在 img 标签的开头有一个愚蠢的样式。此外，“onclick”位于不同的位置。我唯一需要了解的是图像位置。

这是我到目前为止的代码......仅适用于第 1 页的场景：

```
preg_match_all("/<img\s*?class='thumb.*?'.*?src='(.*?)'.*?\/>/is", $hotelPage, $thumbs, PREG_PATTERN_ORDER); 
```

理想情况下，我希望能够将其保留在一个 php 行中。如何在 preg_replace 中执行“或”以及如何让正则表达式也适用于第 2 页？

先感谢您！

更新：这些页面有其他图像，我只是在寻找具有包含“thumb”的类的那些。我很抱歉遗漏了那个重要的细节。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T20:11:53.703

网络上有多个关于 HTML 属性的正则表达式示例。应该适用于您的两种特定情况以及几乎任何其他 image-src 的一种方法是：

```
preg_match_all("/<img[^>]+src\\s*=\\s*['\"]([^'\"]+)['\"][^>]*>/", $hotelPage, $thumbs); 
```

可以在此处找到有关此特定正则表达式的详细信息：[Regular expression to get an attribute from HTML tag](https://stackoverflow.com/questions/1079423/regular-expression-to-get-an-attribute-from-html-tag)

处理 'class="thumb*"' 规则的更多修改版本是：

```
preg_match_all("/<img[^>]+class=\"thumb[^\"]*\"[^>]+src\\s*=\\s*['\"]([^'\"]+)['\"][^>]*>/", $hotelPage, $thumbs); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T20:30:52.967

这应该可以按您的预期工作 - 如果您的 html 位于`$html`，则正则表达式应如下所示`$reg`：

```
$html='some html <img class="thumb thumb_0" onclick="setImage(0); return false;"
   src="http://example.com/b1.jpg"> xxx yyy <img class="bummer thumb_0"
   onclick="setImage(0); return false;" src="http://example.com/bummer.jpg">
   <img style="width: 46px ! important; height: 46px ! important;"
   class="thumb thumb_0" onclick="setImage(0); return false;"
   src="http://example.com/image4.jpg"> some html';

$reg = ' <img .+?                # img tag
         class="thumb .+?        # class tag
         src="([^"]+)            # capture src
       ';

preg_match_all("/$reg/xis", $html, $thumbs, PREG_SET_ORDER);

foreach($thumbs as $t) echo $t[1]."\n"; 
```

**只有**当**属性的顺序是`{class, src}`**并且找到了 img-tag 和正确的类“thumb”时，它才匹配。开始了：

```
http://example.com/b1.jpg
http://example.com/image4.jpg 
```

三个 img 条目中只有两个匹配（我在测试集中包含了第三个错误的链接）。

问候

rbo

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T20:10:15.847

如果您想要的`src`只是 ，那么您应该忽略正则表达式中的所有其他内容。

尝试：

```
/<img\s.*src='(.*)'.*>/iu 
```

作为你的正则表达式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T20:12:55.627

不建议使用正则表达式解析 xml/html。你应该看到这个问题：[RegEx match open tags except XHTML self-contained tags](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags)

您可以做的是使用 DOMDocument 之类的东西来找出网址：

```
$html = '<img class="thumb thumb_0" onclick="setImage(0); return false;" src="http://example.com/b1.jpg">
<img style="width: 46px ! important; height: 46px ! important;" class="thumb thumb_0" onclick="setImage(0); return false;" src="http://example.com/image4.jpg">';

$dom = new DOMDocument();
$dom->loadHTML($html);
$images = $dom->getElementsByTagName('img');

$image_urls = array();
foreach ($images as $image) {

    // only match images with class thumb
    if (strpos(' ' . $image->getAttribute('class') . ' ', ' thumb ') !== false) {
        $image_urls[] = $image->getAttribute('src');
    }
}

var_dump($image_urls);
```

# caching - Safari 在 Windows 7 上将其缓存存储在哪里？

> ID：11440541
> 
> 赞同：0
> 
> 时间：2012-07-11T20:03:00.780
> 
> 标签：caching, safari, webkit, tortoisehg

一个简单的路径会很好。Tortoise 刚刚删除了我整个几周的工作，我希望我能从 Safari 的缓存中恢复它。

# xcode - xcode提示文件被锁定编辑不记得选择“不再显示此消息”后解锁选择

> ID：11440544
> 
> 赞同：2
> 
> 时间：2012-07-11T20:03:03.660
> 
> 标签：xcode, perforce, xcode4.3

如果我第一次开始在 Xcode 中输入只读文件，我会收到一个对话框提示，该对话框基本上说该文件已锁定以进行编辑，并询问我是否要解锁它。

如果我选择解锁，我可以继续编辑文件。有一次，我对此感到恼火（因为我总是希望它解锁），所以我点击了“不再显示此消息”，希望它会记住我的选择。

但是，虽然我不再收到提示，但它也不再解锁文件 - 似乎没有提示的默认值始终是“不解锁”。

**有没有办法自动选择“解锁”而不是每次都提示？**

（背景知识——我正在使用 Perforce 进行源代码控制，并设置了一个 Xcode Behavior 脚本以在基于[http://kb.perforce.com/article/1735/automatically-checking- out-files-for-edit-in-xcode-43](http://kb.perforce.com/article/1735/automatically-checking-out-files-for-edit-in-xcode-43)，因为 Xcode 不再与 Perforce 很好地集成）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-21T09:37:48.660

转到 xcode-> 首选项-> 常规-> 对话框警告重置

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T20:17:21.400

看起来这个问题的答案是“不”。

行为（以及对话框中使用的措辞）不是记住您的选择，而是简单地不再提示您（并且不进行任何更改）。

# c# - asp更改密码控件自定义

> ID：11440545
> 
> 赞同：1
> 
> 时间：2012-07-11T20:03:03.807
> 
> 标签：c#, asp.net, controls

有没有办法自定义 ASP 更改密码控件中的文本框？

```
<asp:ChangePassword id="myChangePassword" newpasswordregularexpressionerrormessage="Error: Your password must be at least 5 characters long, and contain at least one number and one special character." 
runat="server"  OnChangingPassword="ChangingPassword" 
OnChangedPassword="ChangedPassword" OnCancelButtonClick="CancelClick"></asp:ChangePassword> 
```

例如，我希望顶部字段显示当前密码而不仅仅是密码，这可能吗？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-11T20:15:50.217

是的，这是可能的。与许多 asp.net 控件一样，控件内部有一个标签，可让您自定义字段。

看看这个：

```
<asp:ChangePassword ID="ChangePassword1" runat="server" 
        ContinueDestinationPageUrl="~/Users/UserProfile.aspx" style="margin-right: 2px" 
        Width="450px">
        <ChangePasswordTemplate>
            <table cellpadding="1" cellspacing="0" style="border-collapse:collapse;">
                <tr>
                    <td>
                        <table cellpadding="0">
                            <tr>
                                <td align="center" colspan="2">
                                    Change Your Password</td>
                            </tr>
                            <tr>
                                <td align="left">
                                    <asp:Label ID="CurrentPasswordLabel" runat="server" 
                                        AssociatedControlID="CurrentPassword">Password</asp:Label>
                                </td>
                                <td style="width: 166px">
                                    <asp:TextBox ID="CurrentPassword" runat="server" TextMode="Password"></asp:TextBox>
                                    <asp:RequiredFieldValidator ID="CurrentPasswordRequired" runat="server" 
                                        ControlToValidate="CurrentPassword" ErrorMessage="Password is required." 
                                        ToolTip="Password is required." ValidationGroup="ChangePassword1">*</asp:RequiredFieldValidator>
                                </td>
                            </tr>
                            <tr>
                                <td align="left">
                                    <asp:Label ID="NewPasswordLabel" runat="server" 
                                        AssociatedControlID="NewPassword">New Password</asp:Label>
                                </td>
                                <td style="width: 166px">
                                    <asp:TextBox ID="NewPassword" runat="server" TextMode="Password"></asp:TextBox>
                                    <asp:RequiredFieldValidator ID="NewPasswordRequired" runat="server" 
                                        ControlToValidate="NewPassword" ErrorMessage="New Password is required." 
                                        ToolTip="New Password is required." ValidationGroup="ChangePassword1">*</asp:RequiredFieldValidator>
                                </td>
                            </tr>
                            <tr>
                                <td align="left">
                                    <asp:Label ID="ConfirmNewPasswordLabel" runat="server" 
                                        AssociatedControlID="ConfirmNewPassword">Confirm New Password</asp:Label>
                                </td>
                                <td style="width: 166px">
                                    <asp:TextBox ID="ConfirmNewPassword" runat="server" TextMode="Password"></asp:TextBox>
                                    <asp:RequiredFieldValidator ID="ConfirmNewPasswordRequired" runat="server" 
                                        ControlToValidate="ConfirmNewPassword" 
                                        ErrorMessage="Confirm New Password is required." 
                                        ToolTip="Confirm New Password is required." ValidationGroup="ChangePassword1">*</asp:RequiredFieldValidator>
                                </td>
                            </tr>
                            <tr>
                                <td align="center" colspan="2">
                                    <asp:CompareValidator ID="NewPasswordCompare" runat="server" 
                                        ControlToCompare="NewPassword" ControlToValidate="ConfirmNewPassword" 
                                        Display="Dynamic" 
                                        ErrorMessage="The Confirm New Password must match the New Password entry." 
                                        ValidationGroup="ChangePassword1"></asp:CompareValidator>
                                </td>
                            </tr>
                            <tr>
                                <td align="center" colspan="2" style="color:Red;">
                                    <asp:Literal ID="FailureText" runat="server" EnableViewState="False"></asp:Literal>
                                </td>
                            </tr>
                            <tr>
                                <td align="right">
                                    <asp:Button ID="ChangePasswordPushButton" runat="server" 
                                        CommandName="ChangePassword" Text="Change Password" 
                                        ValidationGroup="ChangePassword1" />
                                </td>
                                <td style="width: 166px">
                                    <asp:Button ID="CancelPushButton" runat="server" CausesValidation="False" 
                                        CommandName="Cancel" Text="Cancel" />
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
        </ChangePasswordTemplate>
    </asp:ChangePassword> 
```

最终，它只是一个包含必要文本框的表格。我忘记了我在哪里找到这段代码，但它可能是另一个 StackOverflow 帖子。

此外，请阅读[http://msdn.microsoft.com/en-us/library/ms178339.aspx](http://msdn.microsoft.com/en-us/library/ms178339.aspx)。它有更多关于这些模板标签如何工作的信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-11T20:07:57.983

```
<asp:ChangePassword ID="ChangePassword1" runat="server" 
    PasswordLabelText="Current Password:">
</asp:ChangePassword> 
```

这是你想要的吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-11T20:07:45.977

[这](http://frejnorling.wordpress.com/2011/04/15/creating-a-custom-web-server-control-in-asp-net-using-visual-studio-2010/)是在 asp.net 中自定义控件的好教程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-16T08:32:51.733

**aspx 代码**

```
<div align="center">

<asp:ChangePassword ID="ChangePassword1" runat="server" BackColor="#F7F7DE" 
                BorderColor="#CCCC99" BorderStyle="Solid" BorderWidth="1px" 
                Font-Names="Verdana" Font-Size="10pt" 
                onchangedpassword="ChangePassword1_ChangedPassword">
    <TitleTextStyle BackColor="#6B696B" Font-Bold="True" ForeColor="#FFFFFF" />
</asp:ChangePassword>

        </div> 
```

**.cs 文件代码**

```
public partial class admin_Changepwd : System.Web.UI.Page
{
    SqlConnection con = new SqlConnection(ConfigurationManager.ConnectionStrings["myconnectionstring"].ConnectionString);
    SqlCommand cmd;
    SqlDataReader dr;

protected void Page_Load(object sender, EventArgs e)
{

}

protected void ChangePassword1_ChangedPassword(object sender, EventArgs e)
{
    cmd = new SqlCommand("update  Admin set Password ='" + ChangePassword1.ConfirmNewPassword + "' where userid = '" + Session["userid"] + "' and Password ='" + ChangePassword1.CurrentPassword + "'", con);
    cmd.Connection.Open();
    cmd.ExecuteNonQuery();
    con.Close();

}
} 
```

# jquery - jQuery datepicker - 无法找到 css

> ID：11440547
> 
> 赞同：0
> 
> 时间：2012-07-11T20:03:08.110
> 
> 标签：jquery, jquery-ui

我想知道为什么我的 jquery datepicker 无法找到 css 样式。它可以工作，但没有任何 CSS 样式，而且看起来很糟糕。

```
<link rel="stylesheet" href="/Styles/css/ui-lightness/jquery.ui.all.css">
<link rel="stylesheet" href="/Styles/css/ui-lightness/jquery.ui.datepicker.css">
<script src="/Scripts/jquery-1.7.2.min.js"></script>
<script src="/Scripts/jquery.ui.core.js"></script>
<script src="/Scripts/jquery.ui.datepicker.js"></script> 
```

可能我忘记了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T20:05:26.803

尝试使用 Firebug (Firefox) 或开发人员工具（IE、Chrome）查看加载文件是否有问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T20:07:26.003

您没有包含该`jquery.ui.theme.css`文件。您包含的只是基本样式。主题是增加所有绒毛的原因。

# ruby-on-rails-3 - Rails 单用户身份验证：数据库还是硬编码？

> ID：11440548
> 
> 赞同：2
> 
> 时间：2012-07-11T20:03:13.680
> 
> 标签：ruby-on-rails-3, authentication

我只需要保护几个可以编辑数据库中条目的页面。我自己只需要一个“用户帐户”。我应该经历创建用户模型和设置“正确”用户身份验证的麻烦吗？还是可以将其硬编码在需要保护的控制器功能上？

作为记录，我通常不会对站点的用户身份验证进行硬编码。我只是问硬编码是否“安全”，因为该网站甚至没有用户帐户。我只需要保护少数几个页面，并且正在寻找最简单/最快的方法来完成此操作。

感谢您的任何意见！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:10:07.257

我觉得没关系。请记住，基本访问身份验证将用户名和密码作为[明文](http://en.wikipedia.org/wiki/Basic_access_authentication#Disadvantages)传输，除非您使用的是 SSL（您可能不是）。所以基本上由你来判断风险与努力。

# json - 如何使用 GWT 处理 JSONP 回调？

> ID：11440552
> 
> 赞同：2
> 
> 时间：2012-07-11T20:03:33.133
> 
> 标签：json, gwt, jsonp

我正在使用 GWT，我想发出一个 JSONP 请求，它在返回时调用我的 GWT 方法。

但是，我无法弄清楚如何指定 GWT 方法以在回调时调用。任何人都可以帮忙吗？这是我的示例代码：

```
private native void fetchUserData(String accessToken) /*-{
    var callback = "com.company.example.FacebookApi::handleUser";
    var url = "https://graph.facebook.com/me?access_token="+accessToken+"&callback=" + callback;

   // use jsonp to call the graph
   var script = document.createElement('script');
    script.src = url;
    document.body.appendChild(script);

  }-*/;

  public void handleUser(Object o) {
    Window.alert("Received object with class: " + o.getClass().getName())
  } 
```

这段代码是从这个例子中移植过来的：[没有 SDK 的 Facebook](https://developers.facebook.com/docs/authentication/client-side/#no-jssdk)。

或者，我刚刚发现有一个[GWT JsonpRequestBuilder](http://google-web-toolkit.googlecode.com/svn/javadoc/2.0/com/google/gwt/jsonp/client/JsonpRequestBuilder.html)，我还没有机会使用它，但是如果有人可以在不使用任何本机代码的情况下给出一个例子......那就更好了。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-11T21:06:25.780

想通了，这在很大程度上要归功于这些例子：

[重量 + JSONP](http://eggsylife.co.uk/2010/04/22/gwt-2-jsonp-and-javascript-overlays-with-jsonprequestbuilder/)

[使用 Gwt、Jsonp 的跨域请求](http://sharecoding.wordpress.com/2012/02/15/cross-domain-request-on-gwt-without-rpc/)

[GWT 中的跨站点引用](http://m-hewedy.blogspot.com/2011/02/cross-site-referencing-in-gwt.html)

这是根据评论更新的代码（未指定回调，使用 Javascript 覆盖类型）

```
 private void fetchDataUsingGwt() {
    String url = "https://graph.facebook.com/me?access_token=" + accessToken;
    JsonpRequestBuilder requestBuilder = new JsonpRequestBuilder();
    requestBuilder.requestObject(url, new AsyncCallback<FbUser>() {
  @Override
  public void onFailure(Throwable caught) {
    Window.alert(caught.getMessage());
  }

  @Override
  public void onSuccess(FbUser fbUser) {
      if (fbUser.isError()) {
        StringBuilder builder = new StringBuilder();
        builder.append("Fb error: ");
        builder.append(fbUser.getError().getMessage() + ", ");
        builder.append(fbUser.getError().getCode());
        String message = builder.toString();
        Window.alert(message);
        return;
      }

      StringBuilder builder = new StringBuilder();
      builder.append("Fetched user: " + fbUser.getFirstName() + " " + fbUser.getLastName());
      builder.append(" from " + fbUser.getHometown().getName());
      builder.append(" born on " + fbUser.getBirthday());
      builder.append(" with id " + fbUser.getId() + " and email " + fbUser.getEmail());
      builder.toString();
      String details = builder.toString();
      Window.alert("Got: " + details);
  }
}); 
```

}

响应使用 JSO 自动包装，如下所示：

```
 public class FbError extends JavaScriptObject {
    protected FbError() {
    }

    public final native String getMessage() /*-{
            return this.message;
    }-*/;

    public final native String getType() /*-{
            return this.type;
    }-*/;

    public final native String getCode() /*-{
            return this.code;
    }-*/;

    public final native String getSubCode() /*-{
            return this.error_subcode;
    }-*/;

  }

  public class Hometown extends JavaScriptObject {
    protected Hometown() {
    }

    public final native String getName() /*-{
            return this.name;
    }-*/;

    public final native String getId() /*-{
            return this.id;
    }-*/;
  }

  public class ErrorableJso extends JavaScriptObject {

    public boolean isError() {
      return getError() != null;
    }

    public final native FbError getError() /*-{
            return this.error;
    }-*/;
  }

  public class FbUser extends ErrorableJso {

    // TODO: Separate call needed to retrieve profile pic

    protected FbUser() {
    }

    public final native String getFirstName() /*-{
            return this.first_name;
    }-*/;

    public final native String getLastName() /*-{
            return this.last_name;
    }-*/;

    public final native String getId() /*-{
            return this.id;
    }-*/;

    public final native String getBirthday() /*-{
            return this.birthday;
    }-*/;

    public final native String getEmail() /*-{
            return this.email;
    }-*/;

    public final native Hometown getHometown() /*-{
            return this.hometown;
    }-*/;
  } 
```

为了完整起见，这是 JSO 包装的原始 JSON 响应。由于继承，`FbUser`如果出现如下错误，则使用相同的对象：

```
{
   "error": {
      "message": "Error validating access token: Session has expired at unix time 1342044000\. The current unix time is 1342050026.",
      "type": "OAuthException",
      "code": 190,
      "error_subcode": 463
   }
} 
```

或预期的用户对象：

```
{
   "id": "23232323",
   "name": "Andrew Cuga",
   "first_name": "Andrew",
   "last_name": "Cuga",
   "link": "http://www.facebook.com/TheAndy",
   "username": "TheAndy",
   "birthday": "02/20/2011",
   "hometown": {
      "id": "108530542504412",
      "name": "Newark, Delaware"
   } // ... etc
} 
```

请注意，JSON 响应中的`error`和`hometown`字段很容易包装到 JavaScriptObjects 中。

# iphone - 从其他视图控制器访问数据 (null)

> ID：11440554
> 
> 赞同：-1
> 
> 时间：2012-07-11T20:03:39.650
> 
> 标签：iphone, objective-c, ios

**我使用的最终解决方案：**这种方法对我来说效果不佳，我只有 2 个必须传输的变量，所以我决定使用 NSNotificationCenter 来发送对象。请仅在您要传输的对象非常少的情况下使用它，否则它可能会变得非常混乱！如果你想了解更多，我建议你看看这个问题：[pass NSString variable to other class with NSNotification](https://stackoverflow.com/questions/10272068/pass-nsstring-variable-to-other-class-with-nsnotification) Good Luck！

我正在尝试从我的 App Delegate 访问数据，但我总是得到一个（null）。

**编辑：如果有人想要完整的代码，这里是： http:** [//pastebin.com/hNUPMcvB](http://pastebin.com/hNUPMcvB)

这是我的 AppDelegate 中的代码：

```
- (void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation {
    // Stop Location Services
    [locationManager stopUpdatingLocation];
    // Some Reverse Geocoding...
    CLGeocoder * geoCoder = [[CLGeocoder alloc] init];
    [geoCoder reverseGeocodeLocation:newLocation completionHandler:^(NSArray *placemarks, NSError *error) {
        for (CLPlacemark * placemark in placemarks) {
            City = [[placemark locality] stringByReplacingOccurrencesOfString:@" " withString:@"+"];
            State = [[placemark administrativeArea] stringByReplacingOccurrencesOfString:@" " withString:@"+"];
            Final = [NSString stringWithFormat:@"%@,%@", City, State];
            currentLocation = [NSString stringWithFormat:@"%@", Final];
            [self everythingelse];
            NSLog(@"AAA%@", currentLocation);
        }
    }
     ]; 
```

}

这就是我从其他视图控制器访问代码的方式：

```
 ForecasterAppDelegate *BossMan = (ForecasterAppDelegate *)[[UIApplication sharedApplication] delegate];
    CurrentLocation = BossMan.currentLocation;
    NSLog(@"CCC%@", CurrentLocation); 
```

它始终记录为 CCC(null)。在我的 AppDelegate 中，它是正确的，但在另一个视图控制器中它不是。我要么犯一个小错误，要么犯一个大错误，任何帮助都会很棒！

编辑：这是我的头文件：

我的应用程序代表 .h：

```
@interface ForecasterAppDelegate : UIResponder <UIApplicationDelegate, CLLocationManagerDelegate> {
    UIStoryboard *storyboard;
    NSString *City, *State, *Final, *currentLocation;
    NSMutableString *FinalQuery;
    CLLocationManager *locationManager;
    CLPlacemark * myPlacemark;
}

@property (strong, nonatomic) UIWindow *window;
@property (nonatomic,retain) CLLocationManager *locationManager;
@property (nonatomic, retain) NSMutableString *FinalQuery;
@property (strong, nonatomic) NSString *currentLocation;
@property (nonatomic, retain) NSString *Final; 
```

这是我的视图控制器 .h 文件：

```
@interface View1 : UIViewController <CLLocationManagerDelegate, LocationDamn> {
        CLLocationManager *locationManager;
        CLPlacemark * myPlacemark;
        NSString *launchpath;
        NSString *City, *State, *condition, *Final, *degreesign, *changeLocation, *currentLocations;
    }

    @property (nonatomic,retain) CLLocationManager *locationManager;
    @property (nonatomic,retain) IBOutlet UILabel *currentTempLabel, *highTempLabel, *lowTempLabel, *conditionsLabel, *cityLabel, *day2c, *day3c, *currentconditions;
    @property (nonatomic,retain) IBOutlet NSString *currentLocations;

    @end 
```

在我的 ViewController 的 viewdidload 中，我有这个：

```
 [self performSelector:@selector(DoSomethingCool) withObject:nil afterDelay:1.5]; 
```

以便位置管理员有时间获取位置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T23:47:52.650

您在分配值时没有使用设置器，因此它没有保留该值。尝试改变：

```
currentLocation = [NSString stringWithFormat:@"%@", Final]; 
```

至

```
self.currentLocation = [NSString stringWithFormat:@"%@", Final]; 
```

为避免混淆，您可以停止在标题中声明实例变量...试试这个：

```
@interface ForecasterAppDelegate : UIResponder <UIApplicationDelegate, CLLocationManagerDelegate> 

@property (strong, nonatomic) UIWindow *window;
@property (nonatomic,retain) CLLocationManager *locationManager;
@property (nonatomic, retain) NSMutableString *FinalQuery;
@property (strong, nonatomic) NSString *currentLocation;
@property (nonatomic, retain) NSString *Final; 
```

并将其添加到您的实现中

```
@sysnthesize window=_window, locationManager=_locationManager, FinalQuery = _FinalQuery, currentLocation=_currentLocation, Final=_final; 
```

这是标准方式，然后如果你尝试

```
 currentLocation = [NSString stringWithFormat:@"%@", Final]; 
```

编译器会抛出一个错误，这将防止您意外设置实例变量。现在，随着这些变化，您的真正问题开始变得明显。您的代码正在设置值，例如

```
_currentLocation = [NSString stringWithFormat:@"%@",Final]; 
```

这会直接设置实例变量，因此不会保留该值。该值可能会在下一个大括号中被丢弃，因为没有任何东西保留它。当您将**self**前缀为**self.currentLocation = some value**时，您会将值传递给保留的 setter。然后它应该可用于您的所有视图控制器:)

希望这会有所帮助，如果您觉得它令人困惑，请告诉我，我会尝试对其进行一些编辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T22:13:37.210

这取决于您在哪里定义`CurrentLocation`. 由于您在从其他视图控制器（我假设）访问时没有收到任何错误，因此您在文件中定义`CurrentLocation`为一个属性。`ForecasterAppDelegate.h`您可能忘记将保留属性添加到`CurrentLocation`. 或者，如果您使用的是 ARC，那么您可以`strong`如下使用。

`@property(strong) NSString *currentLocation`

# django - 自定义 django 模板标签/参数忽略条件

> ID：11440555
> 
> 赞同：0
> 
> 时间：2012-07-11T20:03:42.487
> 
> 标签：django, django-views, django-templates

我有一`Event`堂课。事件有`presenters`。这些`presenters`被放入“参加者”列表中。演示者应该有一个标志，显示他们实际上是与会者列表中的演示者。即：他们头像旁边的复选标记`{% if is_presenter %}`。截至目前，它正在为所有与会者添加一个复选标记。

我只想让旗帜`presenters`只显示。我究竟做错了什么？如何添加获取复选标记以仅显示给那些演示者？（另外，我不知道我的标题是否适合这种情况。请告诉我）。

楷模：

```
class Event(models.Model):
    title = models.CharField(max_length=200)
    presenters = models.ManyToManyField(Profile, null=True, blank=True)
    url = models.CharField(max_length=200)
    description = models.TextField()
    date = models.DateTimeField()
    created = models.DateTimeField(auto_now_add=True)
    modified = models.DateTimeField(auto_now=True)
    tags = models.ManyToManyField(Tag, null=True, blank=True)

class Attendee(models.Model):
    event = models.ForeignKey(Event)
    content_type = models.ForeignKey(ContentType)
    object_id = models.PositiveIntegerField()
    profile = generic.GenericForeignKey('content_type', 'object_id') 
```

意见：

```
def event(request, id):
    event = get_object_or_404(Event, id=id)
    is_attending = False
    is_presenter = False
    if request.user.is_authenticated():
            profile = Profile.objects.get(user=request.user)
        attendees = [a.profile for a in Attendee.objects.filter(event=event)]
        if profile in attendees:
            is_attending = True        
    for presenter in event.presenters.all():
        is_attending = True
        try:
            content_type = ContentType.objects.get(app_label='profiles', model='profile')
            Attendee.objects.get(event=event, content_type=content_type, object_id=presenter.id)
            is_presenter = True
        except Attendee.DoesNotExist:
            Attendee(event=event, profile=presenter).save() 
```

模板：

```
{% for attendee in event.attendees %}
     <div class="inline-block">   
        <a href="/profile/{{ attendee.profile.get_type|lower}}/{{ attendee.profile.user.username }}"{% if attendee.profile.is_presenter %}title="Presenter" class="tooltip-below"{% endif %}>
        <img width=30 height=30 src="{% if attendee.profile.avatar %}{% thumbnail attendee.profile.avatar 30x30 crop %}{% else %}{{ DEFAULT_AVATAR }}{% endif %}" />
        </a>
        {% if is_presenter %}
            <i class="icon-ok-sign"></i>
        {% endif %}
    </div>
{% endfor %} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T20:46:27.867

我不明白你的问题。但似乎问题在于您的`is_presenter`标志不是您的对象的属性。因为python允许动态创建属性，所以解决方案可能是以这种方式将此布尔变量设置为模型：

```
 ...
    if profile in attendees:
        profile.is_attending = True  
for presenter in event.presenters.all():
    presenter.is_attending = True 
```

在模板中：

```
 {% if profile.is_presenter %} 
```

*** 优雅的解决方案是使用方法扩展 Profile 模型`is_presenter()`。***

# asp.net-mvc-3 - 集成安全 IIS 的 mvc 3 401.2 错误（6）

> ID：11440556
> 
> 赞同：0
> 
> 时间：2012-07-11T20:03:42.783
> 
> 标签：asp.net-mvc-3, integrated-security

我们的 MVC 3 应用程序托管在 IIS (6) 上，并且禁用了匿名访问并启用了集成 Windows 身份验证，我们似乎遇到了访问问题。
当我导航到根目录 (http://devserver/) 时，应用程序运行良好。如果我尝试导航到子页面 (http://devserver/wtf) 或单击指向子页面的链接，我会收到登录提示。当我输入我的凭据 3 次然后返回 401.2 错误。应用程序设置为在用户未通过身份验证的情况下重定向到登录屏幕。此代码位于所有控制器派生自的基本控制器的 OnActionExecuting 中。导航到子页面时，此方法不会被命中。知道为什么会发生这种情况吗？

认为我尝试过：http: [//support.microsoft.com/kb/871179](http://support.microsoft.com/kb/871179) http://stackoverflow.com/questions/34194/asp-net-mvc-on-iis6

以及 IIS 中的几乎所有安全设置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T18:37:07.800

我想到了。在 View 控制器库中，我们评估了安全性，但是我们的大多数控制器都有一个 Authorization 属性，该属性在控制器的 OnActionExecuting 之前执行。用户尚未被评估，因此它通过 401.2 异常。

# c# - IIS 上的 WCF 服务。如何摆脱 URL 路径中的“Service.svc”组件？

> ID：11440562
> 
> 赞同：1
> 
> 时间：2012-07-11T20:04:14.557
> 
> 标签：c#, .net, wcf, iis, wcf-binding

**我有一个托管在 IIS 上的 WCF 服务。**出于商业原因，我无法发布此实例的公共 URL，但我相信您会明白我的意思：

问题是，为了到达我的端点**，我似乎已经`Service.svc`将路径段**包含在内，即，我必须使用这样的 URL：

`http://<domain>/<app-name>/Service.svc/<relative-path>`

**我怎样才能避免这种情况？**我的意思是，我想通过以下方式访问我的服务：

`http://<domain>/<app-name>/<relative-path>`

当我在开发过程中自托管服务时，我完全能够做到这一点。

* * *

最后，但这不是超验的，浏览到`http://<domain>/<AppName>/Service.svc`URL 会显示标准服务信息页面：

有没有办法我也可以防止它被访问？

![在此处输入图像描述](../Images/3f35b933154f1ae79310666fc595f63e.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-11T20:32:15.053

第一部分：要没有 URL 的“service.svc”部分，您可以使用 ASP.NET 路由功能和[ServiceRoute](http://msdn.microsoft.com/en-us/library/system.servicemodel.activation.serviceroute.aspx)类 - 您的路由的前缀是空字符串。[http://blogs.msdn.com/b/endpoint/archive/2010/01/25/using-routes-to-compose-wcf-webhttp-services.aspx](http://blogs.msdn.com/b/endpoint/archive/2010/01/25/using-routes-to-compose-wcf-webhttp-services.aspx)上的帖子显示了如何做到这一点。

第二部分：为了防止显示“帮助”页面，您可以通过配置（或通过使用自定义服务主机工厂的代码）禁用它。这是通过配置完成的方法：

```
<serviceBehaviors>
    <behavior>
        <serviceDebug httpHelpPageEnabled="false" httpsHelpPageEnabled="false"/>
    </behavior>
</serviceBehaviors> 
```

该行为没有“名称”属性，这意味着它将用作服务的默认行为。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-01-08T21:56:46.770

像我这样的 .net 新手的分步说明：

1.  打开您的`Web.config`文件并确保`aspNetCompatibilityEnabled`设置为 true：

    ```
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" multipleSiteBindingsEnabled="true" /> 
    ```

2.  右键单击项目，单击“添加”->“新建项目”。找到“全球应用类”。这将自动生成一个 Global.asax 文件。

3.  打开 Global.asax 文件并确保`Application_Start`方法如下所示：

    ```
    protected void Application_Start(object sender, EventArgs e)
    {
        RouteTable.Routes.Add(new ServiceRoute("", new ServiceHostFactory(), typeof(MyServiceImplementation)));
    } 
    ```

（更改`MyServiceImplementation`为 Service1.svc 中的任何类）

4.  确保您已添加以下参考：

    ```
    using System.ServiceModel.Activation;
    using System.Web.Routing; 
    ```

如果未找到这些并且您使用的是 .net 4.5 之前的版本，请确保您使用的是完整安装而不是客户端安装。还要确保您已经添加了这些包引用（右键单击项目，单击添加->引用，找到包名称并确保已选中）。

5.  重新启动 IIS。现在应该隐藏 Service1.svc（或您的任何名称）文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T20:19:10.607

您可以通过简单地不公开您的服务元数据来实现这一点 - 只需评论端点

```
 <endpoint address="mex" binding="mexHttpBinding" name="IMetadataExchange_mexHttpBinding" contract="IMetadataExchange" /> 
```

根据网址-我完全同意@Edmund Y-他提供了有用的链接 ![](../Images/61f0129cc902d913bd35ff0cb2f239c7.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T23:35:38.703

我只是想知道我为实施@carlosfigueira 的建议所做的是否是最干净的事情：

我最终使用了 Global.asax 文件并在处理程序中添加了一个空`ServiceRoute`的*routePrefix*`Application_Start`。我不太清楚为什么要使用`WebServiceHostFactory`vs `ServiceHostFactory`，正如我在 @Edmund Y 分享的文章中所读到的那样： [ServiceRoute + WebServiceHostFactory 会杀死 WSDL 生成？如何使用 ?wsdl 创建无扩展 WCF 服务](https://stackoverflow.com/questions/2921802/serviceroute-webservicehostfactory-kills-wsdl-generation-how-to-create-extens)。

无论如何，我想我设法解决了我需要的问题，感谢您的帮助。

# javascript - 将普通日期转换为 ISO-8601 格式

> ID：11440569
> 
> 赞同：11
> 
> 时间：2012-07-11T20:04:29.700
> 
> 标签：javascript, jquery

> **可能重复：**
> [如何在 Javascript 中输出 ISO-8601 格式的字符串？](https://stackoverflow.com/questions/2573521/how-do-i-output-an-iso-8601-formatted-string-in-javascript)

我有一个约会

```
Thu Jul 12 2012 01:20:46 GMT+0530 
```

我怎样才能将它转换成这样的 ISO-8601 格式

```
2012-07-12T01:20:46Z 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-07-11T20:08:36.103

在大多数较新的浏览器中，您都有`.toISOString()`方法，但在 IE8 或更早版本中，您可以使用以下方法（取自Douglas Crockford 的[json2.js](https://github.com/douglascrockford/JSON-js/blob/master/json2.js#L48)）：

```
// Override only if native toISOString is not defined
if (!Date.prototype.toISOString) {
    // Here we rely on JSON serialization for dates because it matches 
    // the ISO standard. However, we check if JSON serializer is present 
    // on a page and define our own .toJSON method only if necessary
    if (!Date.prototype.toJSON) {
        Date.prototype.toJSON = function (key) {
            function f(n) {
                // Format integers to have at least two digits.
                return n < 10 ? '0' + n : n;
            }

            return this.getUTCFullYear()   + '-' +
                f(this.getUTCMonth() + 1) + '-' +
                f(this.getUTCDate())      + 'T' +
                f(this.getUTCHours())     + ':' +
                f(this.getUTCMinutes())   + ':' +
                f(this.getUTCSeconds())   + 'Z';
        };
    }

    Date.prototype.toISOString = Date.prototype.toJSON;
} 
```

现在您可以安全地调用 `.toISOString() 方法。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-11T20:07:00.247

有`.toISOString()`日期的方法。您可以将它用于支持 ECMA-Script 5 的浏览器。对于那些不支持的浏览器，请安装如下方法：

```
if (!Date.prototype.toISOString) {
    Date.prototype.toISOString = function() {
        function pad(n) { return n < 10 ? '0' + n : n };
        return this.getUTCFullYear() + '-'
            + pad(this.getUTCMonth() + 1) + '-'
            + pad(this.getUTCDate()) + 'T'
            + pad(this.getUTCHours()) + ':'
            + pad(this.getUTCMinutes()) + ':'
            + pad(this.getUTCSeconds()) + 'Z';
    };
} 
```

# ruby-on-rails - Carrierwave PNG 到 JPG 转换器。如何避免黑色背景？

> ID：11440582
> 
> 赞同：5
> 
> 时间：2012-07-11T20:05:15.757
> 
> 标签：ruby-on-rails, imagemagick, paperclip, carrierwave, rmagick

例如，在回形针中，当 .png 转换为 .jpg 时，可以添加此设置以设置白色背景：

```
:convert_options => { :all => '-background white -flatten +matte'} 
```

一旦carrierwave也使用rmagick，该怎么做？

Obs.：我的文件存储在 S3 中。

我的代码：

```
version :square do
    process :resize_to_fill => [200, 200]
    process :convert => 'jpg'
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-02-28T06:00:04.067

这是只进行转换和背景填充的更健全的版本

```
def convert_and_fill(format, fill_color)
  manipulate!(format: format) do |img|
    new_img = ::Magick::Image.new(img.columns, img.rows)
    new_img = new_img.color_floodfill(1, 1, ::Magick::Pixel.from_color(fill_color))
    new_img.composite!(img, ::Magick::CenterGravity, ::Magick::OverCompositeOp)
    new_img = yield(new_img) if block_given?
    new_img
  end
end 
```

示例用法：

```
process convert_and_fill: [:jpg, "#FFFFFF"] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T04:20:47.360

我已经解决了这个问题，但我不确定这是否是最好的方法：

```
def resize_to_fill(width, height, gravity = 'Center', color = "white")
    manipulate! do |img|
      cols, rows = img[:dimensions]
      img.combine_options do |cmd|
        if width != cols || height != rows
          scale = [width/cols.to_f, height/rows.to_f].max
          cols = (scale * (cols + 0.5)).round
          rows = (scale * (rows + 0.5)).round
          cmd.resize "#{cols}x#{rows}"
        end
        cmd.gravity gravity
        cmd.background "rgba(255,255,255,0.0)"
        cmd.extent "#{width}x#{height}" if cols != width || rows != height
      end
      ilist = Magick::ImageList.new
      rows < cols ? dim = rows : dim = cols
      ilist.new_image(dim, dim) { self.background_color = "#{color}" }
      ilist.from_blob(img.to_blob)
      img = ilist.flatten_images
      img = yield(img) if block_given?
      img
    end
  end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-07T17:44:57.670

使用 MiniMagick，我可以这样做：

`process :resize_and_pad => [140, 80, "#FFFFFF", "Center"]`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-04-30T16:32:59.880

我使用 MiniMagick 的解决方案：首先，在您的上传器上定义一个方法，将图像转换为 jpg 格式，同时删除 alpha 通道并将背景颜色设置为白色：

```
def convert_to_jpg(bg_color = '#FFFFFF')
  manipulate! do |image|
    image.background(bg_color)
    image.alpha('remove')
    image.format('jpg')
  end
end 
```

然后添加一个将文件转换为 jpg 的新版本（也覆盖`full_filename`更改文件名扩展名的方法）：

```
version :jpg do
  process :convert_to_jpg

  def full_filename(file)
    filename = super(file)
    basename = File.basename(filename, File.extname(filename))
    return "#{basename}.jpg"
  end
end 
```

# node.js - Paypal 未按预期重定向

> ID：11440586
> 
> 赞同：0
> 
> 时间：2012-07-11T20:05:33.813
> 
> 标签：node.js, paypal

我正在尝试让贝宝为我的网站工作。我正在使用 Jade，所以下面的代码看起来与 html 不完全相同，但呈现相同。

```
form(id="SubmitForm", action="https://api-3t.sandbox.paypal.com/nvp")
  input(type="hidden", name="USER",value="USER")
  input(type="hidden", name="PWD", value="PWD")
  input(type="hidden", name="SIGNATURE", value="SIGNATURE")
  input(type="hidden", name="VERSION", value="89.0")
  input(type="hidden", name="PAYMENTREQUEST_0_PAYMENTACTION",
                    value="Sale")
  input(name="PAYMENTREQUEST_0_AMT", value="19.95")
  input(type="hidden", name="RETURNURL",
                    value="https://localhost:3001/confirm")
  input(type="hidden", name="CANCELURL",
                    value="https://localhost:3001/end")
  input(type="submit", name="METHOD", value="SetExpressCheckout") 
```

它确实适用于贝宝并返回带有令牌的文本字符串，而不是重定向回我期望的确认页面。

我看到类似的东西......

> TOKEN=EC%2d33S38595GH5727152&TIMESTAMP=2012%2d07%2d11T20%3a00%3a02Z&CORRELATIONID=687adf3870d19&ACK=成功&版本=89%2e0&BUILD=3242673

带有...的网址

> [https://api-3t.sandbox.paypal.com/nvp?USER=USER&PWD=PWD&SIGNATURE=SIG&VERSION=89.0&PAYMENTREQUEST_0_PAYMENTACTION=Sale&PAYMENTREQUEST_0_AMT=19.95&RETURNURL=https%3A%2F%2Flocalhost%3A3001%2Fconfirm&CANCELURL=https%3A%2F% 2Flocalhost%3A3001%2Fend&METHOD=SetExpressCheckout](https://api-3t.sandbox.paypal.com/nvp?USER=USER&PWD=PWD&SIGNATURE=SIG&VERSION=89.0&PAYMENTREQUEST_0_PAYMENTACTION=Sale&PAYMENTREQUEST_0_AMT=19.95&RETURNURL=https%3A%2F%2Flocalhost%3A3001%2Fconfirm&CANCELURL=https%3A%2F%2Flocalhost%3A3001%2Fend&METHOD=SetExpressCheckout)

但是，如果我剪切并粘贴令牌，它可以正常工作，我当然会尝试避免这种情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T21:02:01.813

正如前人提到的，这是因为您所拥有的是通过服务器端进程进行的 API 调用。

如果您只想重定向到 PayPal 并立即付款，只需使用以下 URL，并将其替换为您自己的值；
[https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&business=YOUR-EMAIL-HERE&amount=YOUR-AMOUNT-HERE&item_name=NAME-OF-YOUR-ITEM-HERE&return=YOUR-RETURN-URL&cancel_return=YOUR-取消网址](https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&business=YOUR-EMAIL-HERE&amount=YOUR-AMOUNT-HERE&item_name=NAME-OF-YOUR-ITEM-HERE&return=YOUR-RETURN-URL&cancel_return=YOUR-CANCEL-URL)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T20:44:04.520

您确定您使用的是正确的网址吗？它以“api”开头的事实表明它旨在通过服务器端进程或 AJAX 调用并返回数据（正如它正在做的那样）而不是发出重定向。

# c++ - 将使用 stdafx 的 MSVC 项目移植到 xcode 的简单方法？

> ID：11440588
> 
> 赞同：1
> 
> 时间：2012-07-11T20:05:38.557
> 
> 标签：c++, xcode, visual-studio-2010, visual-c++

我经常使用预编译的头文件在 MSVC 10 中启动小项目（对我来说似乎更简单）。

一旦我想让这个东西在 XCode (3) 上编译，我就搞砸了，我不知道苹果与微软相比如何预编译头文件，我在编译时有很多错误，我猜包含嵌套。

我怎样才能让事情变得简单，而不必编辑我的所有文件，或者只是添加一些不会破坏 Windows 项目的简单内容（使用相同的源文件）？

编辑：我只是在使用 SFML（现在）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T20:17:28.287

VS 预编译头文件的方式是它在源文件的开头检测预编译头文件，而不是正常处理它，而是插入其预编译版本的头文件。

任何不以相同方式执行预编译头文件的构建系统都将简单地多次处理头文件并且速度较慢，但​​不会因 stdafx.h 而出现任何额外错误。

似乎您的问题必须在其他地方。

# android - 保持Mediaplayer -android的状态

> ID：11440589
> 
> 赞同：-3
> 
> 时间：2012-07-11T20:05:40.690
> 
> 标签：android

> **可能重复：**
> [处理屏幕方向 - Android](https://stackoverflow.com/questions/11438878/handling-screen-orientation-android)

在我的应用程序中，我有一个带有歌曲列表的列表视图和一个带有播放/暂停选项的按钮。如何在播放歌曲时处理屏幕方向。帮我拿样品…………

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:16:44.403

[http://developer.android.com/training/basics/activity-lifecycle/recreating.html#SaveState](http://developer.android.com/training/basics/activity-lifecycle/recreating.html#SaveState) 只需在 onSaveInstanceState 中获取播放器的位置并保存即可。当方向改变并重新创建活动时。在 MediaPlayer 和 onRestoreInstanceState 中加载轨道 如果是，则检查位置是否以前保存过 设置 MediaPlayer 位置

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T20:16:47.087

你想让我做什么？默认情况下，当您的应用程序的屏幕旋转时，该活动将重新启动。如果您想完全避免这种情况，您可以`android:configChanges="keyboardHidden|orientation`在清单文件中添加活动。然后，您需要重写该`onConfigurationChanged`方法以实际监视配置更改并更改您需要的任何 UI 内容。

另一个选择是使用应用程序类。从[Activity restart on rotation Android 开始](https://stackoverflow.com/questions/456211/activity-restart-on-rotation-android)，根据您在初始化中所做的事情，您可以考虑创建一个扩展 Application 的新类，并将您的初始化代码移动到该类中覆盖的 onCreate 方法中。

```
public class MyApplicationClass extends Application {
  @override
  public void onCreate() {
    super.onCreate();
    // TODO Put your application initialization code here.
  }
} 
```

希望有帮助。有关更多信息，请参见该链接。

# java - Netbeans 中的“转换为 try-with-resources” - Cool Beans？

> ID：11440592
> 
> 赞同：10
> 
> 时间：2012-07-11T20:06:04.740
> 
> 标签：java, netbeans

我在 Netbeans 7.1.2 中有以下代码：

```
BufferedOutputStream bos = new BufferedOutputStream(new FileOutputStream(filename));
bos.write(newRawData);
bos.close(); 
```

一个警告表明我“转换为 try-with-resources”。当我选择这样做时，我的代码变为：

```
try (BufferedOutputStream bufferedFos = new BufferedOutputStream(new FileOutputStream(filename))) {
        bufferedFos.write(newRawData);
    } 
```

这看起来类似于 C# 中 using(...) 的语法...它们的工作方式相同吗？使用第二种格式有什么缺点吗？我担心没有`bos.close();`，但是这种格式根本没有必要吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-11T20:09:34.933

这是 Java 7 中引入的一种新语法，它负责关闭您在声明`try(...)`语句时指定的任何资源。更多信息可以在[这里](http://docs.oracle.com/javase/7/docs/technotes/guides/language/try-with-resources.html)找到。
所以不，你不必做 a `bos.close()`，它是由 Java 执行的。你可以坐下来放松一下。
唯一的缺点是您的代码仅适用于 Java 7+。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-11T20:16:08.923

## 笔记

[Java 7 中引入了](http://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html)“try with resources”语句来替代该`try...finally`语句。基本上，它所做的只是让您不必添加：

```
finally {
  if(resource != null) resource.close();
} 
```

到你的`try`陈述结束。如果您使用它，您的代码将仅适用于 Java 7 及更高版本。

# 回答

`try`是 Java 中称为`try...catch`. 您收到的警告的完整解决方案是：

```
try(BufferedOutputStream bufferedFos = new BufferedOutputStream(new FileOutputStream(filename))) {
  bufferedFos.write(newRawData);
} catch(FileNotFoundException e) {
  e.printStackTrace();
} 
```

A "try with resources" block uses the same structure as the `try...catch` block, but automatically closes any resources that are created inside the block once it has been executed. That's why you don't see a `bufferedFos.close();` statement in the code.

# asp.net-mvc - 回发后数据未出现在视图中

> ID：11440605
> 
> 赞同：0
> 
> 时间：2012-07-11T20:06:41.047
> 
> 标签：asp.net-mvc, model-view-controller

我使用 MVC 3，我有一个视图来删除我的数据库中的一个元素。在授权操作之前，服务层会检查所有逻辑是否到位。如果发生角色冲突，则会在 Html.Summary 中显示一条消息，因此删除操作将中止。

我的问题是当来自服务层的 Html.Summary 中的消息到达时，视图丢失了各个字段的数据，因此您看不到该项目的 ID、名称和描述。

你能指出我正确的方向吗？我做错了什么？谢谢

```
public ActionResult Delete(int id)
    {
        Typology typology = _typologytService.FindById(id);
        TypologyDeleteViewModel deleteViewModel = Mapper.Map<Typology, TypologyDeleteViewModel>(typology);
        return View(deleteViewModel);
    }

    //
    // POST: /ManageTypologies/Delete/5

    [HttpPost]
    public ActionResult Delete(TypologyDeleteViewModel deleteViewModel)
    {
        if (ModelState.IsValid)
        {
            Typology typology = Mapper.Map<TypologyDeleteViewModel, Typology>(deleteViewModel);
            _typologytService.Delete(typology.TypologyId);
            if (ModelState.IsValid)
                return RedirectToAction("Index");
        }
        return View();         
    } 
```

* * *

```
@model xxx.ViewModels.TypologyDeleteViewModel
@{
    ViewBag.Title = "Delete";
}
<h2>
    Delete</h2>
<h3>
    Are you sure you want to delete this?</h3>
@using (Html.BeginForm())
{
    @Html.ValidationSummary(true)
    @Html.HiddenFor(model => model.TypologyId)
    <fieldset>
        <legend>TypologyDeleteViewModel</legend>
        <div class="display-label">
            TypologyId</div>
        <div class="display-field">
            @Html.DisplayFor(model => model.TypologyId)
        </div>
        <div class="display-label">
            Name</div>
        <div class="display-field">
            @Html.DisplayFor(model => model.Name)
        </div>
        <div class="display-label">
            Description</div>
        <div class="display-field">
            @Html.DisplayFor(model => model.Description)
        </div>
        <p>
            <input type="submit" value="Delete" />
        </p>
    </fieldset>
}
<div>
    @Html.ActionLink("Back to List", "Index")
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:09:49.917

将您的发布方法更改为：

```
[HttpPost]
    public ActionResult Delete(TypologyDeleteViewModel deleteViewModel)
    {
        if (ModelState.IsValid)
        {
            Typology typology = Mapper.Map<TypologyDeleteViewModel, Typology>(deleteViewModel);
            _typologytService.Delete(typology.TypologyId);
            if (ModelState.IsValid)
                return RedirectToAction("Index");
        }
        return View(deleteViewModel);         
    } 
```

当您返回无效的模型状态时，您不会将模型传递回视图。此外，您是否有理由在上述代码中检查 ModelState.IsValid 属性两次？我没有看到您可能在哪里添加 ModelStateError 并且第二个 if 语句没有路径。

最后，如果您的 deleteViewModel 包含任何下拉列表等（在这种情况下您似乎没有）......您需要在返回视图之前重新填充它们。

**编辑**

在您的情况下，上述方法不起作用，因为您没有为其他属性使用 EditorFor HTML 帮助程序。您的视图正在吐出相当于`<span>`描述标签等的标签，这些标签不会发回服务器。唯一回来的是您的 Id 属性，因为它在一个`<input type="hidden"`字段中。

所以 - 在您的情况下，您需要将您的操作方法更新为：

```
 [HttpPost]
    public ActionResult Delete(TypologyDeleteViewModel deleteViewModel)
    {
        if (ModelState.IsValid)
        {
            Typology typology = Mapper.Map<TypologyDeleteViewModel, Typology>(deleteViewModel);
            _typologytService.Delete(typology.TypologyId);
            if (ModelState.IsValid)
                return RedirectToAction("Index");
        }
        Typology typology = _typologytService.FindById(typology.TypologyId);
        TypologyDeleteViewModel deleteViewModel = Mapper.Map<Typology, TypologyDeleteViewModel>(typology);
        return View(deleteViewModel);         
    } 
```

或者，将您的值存储在隐藏的输入字段中，就像您使用您的 ID 一样，以便所有值都回传到服务器，而您不必再次进行数据库调用。

# javascript - jQuery 的 AJAX 请求不起作用

> ID：11440608
> 
> 赞同：0
> 
> 时间：2012-07-11T20:07:01.127
> 
> 标签：javascript, jquery

```
function showDialog(link) {
    $('#dialog .newsletter-join').click(function() {
        email = $.trim($(this).parent().find('.email').val());
        if (email != "Email Address" && email.length > 5) {
            $.ajax({
                url: '/newsletter/join',
                data: {
                    'email': email,
                    'pid': $('#dialog .pid').html().trim()
                }
            });

            return true;
        }
        return false;
    });
} 
```

此代码在 FF 中正确执行，在 chrome 中它在调试模式下执行时运行完美，否则它不会返回任何内容。

执行时，它会显示警报框，其中没有任何内容。我在控制台的 XMLHttp 响应中也看不到任何内容。我尝试了其他一些更改：

```
cache:false // It just exeutes for the first time 
datatype:html 
```

你能告诉我如何跟踪这个问题吗？

更新代码：

我正在使用以下脚本调用代码

```
$(document).ready(function() {
    // $(window).load(function () {
    showDialog();
    return true;
    //});
});

function showDialog(link) {
    $('#dialog .newsletter-join').click(function() {
        email = $.trim($(this).parent().find('.email').val());
        if (email != "Email Address" && email.length > 5) {
            $.ajax({
                url: '/newsletter/join',
                data: {
                    'email': email,
                    'pid': $('#dialog .pid').html().trim()
                },
                success: function(data) {
                    alert("Suvvess" + data);
                },
                error: function(xmlHttpRequest, textStatus, errorThrown) {
                    alert("error" + errorThrown);
                }
            });

            return true;
        }
        return false;
    });
} 
```

最新代码更改：我添加了

```
 async: false 
```

ajax 调用的这种变化给出了预期的结果，但这会阻止所有脚本执行，所以仍然觉得这不是永久的解决方案

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-11T20:08:50.313

您应该在出错后关闭 ajax 函数

```
$.ajax({
                url:'/newsletter/join',
                data:{ 'email':email, 'pid':$('#dialog .pid').html().trim() }

  >>>HERE REMOVE IT        }); 
```

# google-drive-api - 可以向驱动器文件添加额外的元数据（不包括描述字段）吗？

> ID：11440612
> 
> 赞同：2
> 
> 时间：2012-07-11T20:07:29.263
> 
> 标签：google-drive-api

我相信驱动文件必须能够携带特定于应用程序的元数据（即扩展属性）。随着文件的传递，我们需要能够在驱动器之外跟踪它们。

有这样的能力吗？

如果没有，会有吗？时间线？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T22:17:29.320

目前这是不可能的，但这是我们正在考虑的一个功能。我目前没有该功能的预计到达时间。在此期间，正如您所说，您可以为此目的使用描述字段。`q`另一种方法是在文件的 indexableText 中设置属性，并使用Drive API的参数搜索这些属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-06T14:00:00.437

现在支持[自定义文件属性](https://developers.google.com/drive/properties).. eta（~2013 年 4 月 5 日）距问题大约 268 天。但是，这些属性是不可搜索的，也没有定义数据类型……时钟又开始了。

# jenkins - Jenkins xvnc，HOME 变量未设置错误

> ID：11440615
> 
> 赞同：2
> 
> 时间：2012-07-11T20:07:41.687
> 
> 标签：jenkins, vnc-server

试图获得一些需要 xvnc 的工作，但是得到这个：

```
 Starting xvnc
  [workspace] $ vncserver :14
  vncserver: The HOME environment variable is not set. 
```

我在命令行上从 jenkins 用户运行 vncserver 没有问题。（旁白：'printenv' 显示 HOME 变量在命令行上正确填充，但不是来自 jenkins 作业）。

我正在运行 Ubuntu 11.10。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T07:58:25.587

在服务器上编辑 `/etc/init.d/jenkins`以设置`HOME`环境变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T23:41:27.873

进入：/etc/init/jenkins.conf

将以下行添加到 env 列表的底部。

```
env HOME="/var/lib/jenkins" 
```

重新启动jenkins，在你的构建中启用xvnc，然后它就可以工作了。

# cakephp-2.1 - cakephp 2.1 空白屏幕

> ID：11440617
> 
> 赞同：2
> 
> 时间：2012-07-11T20:07:50.817
> 
> 标签：cakephp-2.1

我不确定这个特定页面发生了什么。当我查看调试设置为 2 的页面时，只要我在它工作的模型中有一些调试，就会显示所有调试内容以及成品。一旦我将调试更改为 0，它只会给我一个空白屏幕。查看源代码显示它有 html 标签，没有别的。

此外，如果调试设置为 2 并且我没有在我的模型中调试任何东西，它会给我一个空白屏幕。有趣的是我可以告诉我模型中的代码正在工作，因为代码创建了一个临时表，我在其中填充从新表中获取信息，然后删除表。我知道它可以工作，因为我可以注释掉删除部分，并且表格中包含我所期望的所有数据，因此正在创建表格。当我取消注释代码的删除部分时，表格不存在，所以我知道我已经到达了代码的那部分。

我的控制器中的下一件事是压缩这些数据并为视图做好准备。

任何人都知道我可以做些什么来让它工作。这让我莫名其妙，我不知道还能做什么。

谢谢你的帮助。杰米

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T11:08:40.983

CakePHP 提供了 3 个调试级别——两个用于开发，一个用于生产设置。在 debug = 0 时，应用程序处于生产模式，以下开发功能被禁用：

> 使用 pr() 和 debug() 创建的调试消息被禁用。核心 CakePHP 缓存每 99 年刷新一次（这是一个设置），而不是开发中的每 10 秒刷新一次。错误视图提供的信息较少，而是提供通用错误消息。不显示错误。异常堆栈跟踪被禁用。除了上述之外，许多插件和应用程序扩展使用调试来修改它们的行为。

在级别 1 (debug = 1) 上，所有上述功能都已启用，但机会**不会像在 debug = 2 中那样频繁地刷新**。

要么我不明白你的问题，要么你问得不对。调试级别与 pr() 和 debug() 的输出有关，但与控制器的布局和视图呈现无关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-16T10:25:52.563

在我看来这是一个错误，如果我禁用调试模式（切换到生产），所有对调试方法的调用都应该被忽略，但显然它们不是，见下文。

我有这样的电话（整个代码中的分散体）：

```
CakeLog::write('debug', Debugger::trace()); 
```

产生此错误（设置后 `error_reporting(-1)`）

```
PHP Fatal error:  Class 'CakeLog' not found in ... 
```

或者

```
PHP Fatal error:  Class 'Debugger' not found in ... 
```

删除这些后，我发现它在模型中的紧凑功能上失败了（日志中没有任何错误）。

```
$this->find('first', compact('conditions', 'fields', 'order', 'recursive')) 
```

由于这个问题很老，我认为实际上对您没有任何用处，但也许它会对其他人有所帮助。

我正在使用 CakePHP 1.3.14。

# oracle - Liquibase：为新数据库添加变更集

> ID：11440619
> 
> 赞同：0
> 
> 时间：2012-07-11T20:08:09.783
> 
> 标签：oracle, postgresql, liquibase

我有一个使用 Liquibase for PostgreSQL 定义的现有模式。我正在添加对 Oracle 的支持，这需要进行重大更改。一些创建表标签仅通过更改数据类型即可工作，有些则不会（需要更改 sql）。当前的更改日志模式文件在单个更改集下有多个创建表语句（我知道这不是一个好的设计，但这就是我现在必须处理的）并且为了重用其中一些创建表标签，我可能必须将它们从现有的更改集中删除并添加到新的更改集中。liquibase 代码是使用 Spring 注入的，因此，每当我的应用程序启动时，它都会检查数据库是否有任何更改。重构（如前所述）会影响 liquibase 在现有数据库上创建的哈希码吗？如果是这样，

我对 liquibase 比较陌生。如果我的理解有误，请纠正我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T20:46:30.993

我将尝试通过使用 Liquibase 的功能来[修改生成的 SQL](http://www.liquibase.org/manual/modify_sql)以匹配目标数据库来创建跨平台变更集。

# sql - SQL Server 加入临时表需要很长时间

> ID：11440626
> 
> 赞同：2
> 
> 时间：2012-07-11T20:08:48.053
> 
> 标签：sql, sql-server, join

我正在尝试在我的结果末尾添加一列，显示采购订单中的任何项目是否有库存（带有“是”或“否”）。opPOTRACK 是我的表，其中包含我想要显示的 PO 和其他信息，inItemLocation 是每个项目都有一行的表。在一些文本操作之后，它们是通过 opPOTRACK.cpono = inItemLocation.PONO （松散地）连接。

到目前为止，我认为最好的方法是将结果放在一个临时表中，然后将该表与我的正常查询连接起来。其中两个表连接在我必须派生 PO 编号的列上（我没有设计数据库，也无法更改架构）。进行字符串操作不会减慢我的第一次加入速度，所以我不确定它是否会影响我的第二次加入。当我添加第二个加入时，它只会持续几分钟（4 分钟后取消；不确定它真的需要多长时间）。

我确定我加入的方式有些混乱。

* * *

```
IF OBJECT_ID('tempdb..#StockedTbl') IS NOT NULL
BEGIN
    DROP TABLE #StockedTbl
END

CREATE TABLE #StockedTbl
(
    ID int IDENTITY(1,1) PRIMARY KEY,
    PONo varchar(10),
    Stocked varchar(5)
)

INSERT INTO #StockedTbl
(
    PONo,
    Stocked
)
SELECT item.PONo, "Stocked" = CASE 
                      WHEN item.Loc LIKE 'ABC%' THEN 'No'
                      ELSE 'Yes'
                      END 
                      FROM inItemLocation item 

CREATE CLUSTERED INDEX IDX_C_StockedTbl_UserID ON #StockedTbl(PONo)

SELECT  *
FROM  (SELECT  RIGHT(LEFT(item.PONo,6), 5) AS POTrunc, item.WhseLoc, po.cpono, po.Buyer, po.Vendno, po.OrderDate, po.StockDate, 
                      po.StockNote, po.Status, po.StatusChangeDate,
                      ROW_NUMBER() OVER (PARTITION BY po.cpono ORDER BY po.cpono) AS RowNumber,
                      st.Stocked
FROM          dbo.inItemLocation item
                    LEFT JOIN dbo.opPOTRACK po ON RIGHT(LEFT(item.PONo,6), 5) = po.cpono
                    LEFT JOIN #StockedTbl st ON RIGHT(LEFT(item.PONo,6), 5) = RIGHT(LEFT(st.PONo,6), 5)
) AS a
WHERE   a.RowNumber = 1 

DROP TABLE #StockedTbl 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T20:14:20.333

我会建议这样做。首先，为什么`#temp`表格需要一`IDENTITY`列，为什么它需要是`PRIMARY KEY`？其次，为什么不做一个更好地促进连接的列呢？

```
CREATE TABLE #StockedTbl
(
    PONo varchar(10),
    Stocked varchar(5),
    PONoMatch AS CONVERT(CHAR(5), RIGHT(LEFT(PONo,6),5)) PERSISTED
);
CREATE CLUSTERED INDEX x ON #StockedTbl(PONoMatch); 
```

现在至少您可以将这些计算从您的某些子句中取出，但取决于工作在哪里完成（执行计划可以告诉我们），您可能还需要考虑基表上的计算列。

# android - 使用Slide和Fade等sencha touch默认动画是否安全？

> ID：11440631
> 
> 赞同：0
> 
> 时间：2012-07-11T20:08:54.933
> 
> 标签：android, sencha-touch, sencha-touch-2

当我阅读有关动画的 sencha touch 2 文档时，我注意到了这个大警告“注意这是框架内部使用的私有实用程序类。不要依赖它的存在。”

由于我正在考虑为我的应用程序依赖这些动画，这个通知让我很担心，谁能告诉我这是否意味着我不应该依赖这些动画来开发商业应用程序？我不想发布我的应用程序并注意到它发布后的一段时间它已被破坏，因为我选择忽略此警告。

使用它们安全吗？

我如何使用它的示例：

```
viewport:{
    layout:{
        type: 'card',
        animation: {
            type: 'slide',
            duration: 1000
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:16:23.523

您可以使用这些动画。

[http://docs.sencha.com/touch/2-0/#!/api/Ext.anims](http://docs.sencha.com/touch/2-0/#!/api/Ext.anims)

它们在许多 Sencha 示例中使用，因此您不必担心。

但是如果你偶然发现了这个注释，这意味着该类是在框架内部使用的，并且很可能会更改或被删除。这就是为什么你不应该依赖它。

# ruby-on-rails - 如何更有效地表达这个 Ruby 循环？

> ID：11440635
> 
> 赞同：0
> 
> 时间：2012-07-11T20:09:18.753
> 
> 标签：ruby-on-rails, ruby, mongodb, mongoid

我来自 PHP 世界，对 Ruby 很陌生，所以可能有更好的方法来做到这一点。这个块可以用更好的代码更简洁地表达吗？

```
bands = Band.where(:type => 'Rock & Roll').only(:id)
band_ids = bands.map &:id

band_ids.each do |id|
  lead_singer = LeadSinger.find(:band_id => id)
  if lead_singer
    lead_singer.rock_and_roll = true
    lead_singer.save
  end
end 
```

这一切都感觉有点臃肿。如果没有找到结果，我添加了“if lead_singer”部分，但如果有更好的方法来解决这个问题，我很想得到启发。

**编辑** 我将 MongoDB 与 Mongoid 一起使用，因此我不会选择加入。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T20:13:01.580

ActiveRecord 的答案（在问题更新之前，我希望仍然有用）：进行关联：乐队 has_one :lead_signer, A LeadSinger belongs_to :band。现在：

```
LeadSinger.joins(:band).where(:"bands.type" => 'Rock & Roll').
  update_all(:rock_and_roll => true) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-11T20:17:55.867

使用 MongoId，您仍然应该能够使用标准进行更新：

```
LeadSigner.where(:band_id.in => band_ids).update(:rock_and_role => true) 
```

# java - 图像未在本地缓存（使用通用图像加载器） - 图像加载时间慢

> ID：11440637
> 
> 赞同：9
> 
> 时间：2012-07-11T20:09:20.377
> 
> 标签：java, android, image, listview

**问题描述：** 我正在创建一个可滚动的文章列表，其中包含由我的 SQLite 数据库填充的缩略图。一般来说，它是“工作”的，除了速度很慢：

图像加载非常缓慢......我认为使用“[通用图像加载器](https://github.com/nostra13/Android-Universal-Image-Loader)”将图像缓存在设备上，如果你已经查看过它们（或至少接近那个），这会使它们看起来只是滚动到视图中）。但是 - 当你向上/向下拖动时，没有图像存在，然后 3-5 秒后，图像开始弹出（好像它正在重新下载它们）

我正在动态更改缩略图框的可见性，但这完美无缺 - 它们似乎没有改变 - 它们只是滚动到视图中，没有闪烁或任何东西。（但随后图像不会再出现几秒钟）。

我已经通过在滚动后删除我的 php 脚本进行了测试......当我滚动回上一个位置时，图像不会显示 - 让我假设它每次都从我的 PHP 脚本加载。

**但根据[文档](https://github.com/nostra13/Android-Universal-Image-Loader)：** “UsingFreqLimitedMemoryCache（超过缓存大小限制时删除最不常用的位图）-默认使用”

**细节：**

在我的`ArticleEntryAdapter.js`我有：

```
@Override
public View getView(final int position, final View convertView, final ViewGroup parent) {

    // We need to get the best view (re-used if possible) and then
    // retrieve its corresponding ViewHolder, which optimizes lookup efficiency
    final View view = getWorkingView(convertView);
    final ViewHolder viewHolder = getViewHolder(view);
    final Article article = getItem(position);

    // Set the title
    viewHolder.titleView.setText(article.title);

    //Set the subtitle (subhead) or description
    if(article.subtitle != null)
    {
        viewHolder.subTitleView.setText(article.subtitle);
    }
    else if(article.description != null)
    {
        viewHolder.subTitleView.setText(article.description);
    }

    ImageLoader imageLoader = ImageLoader.getInstance();

    imageLoader.displayImage("", viewHolder.thumbView); //clears previous one
    if(article.filepath != null && article.filepath.length() != 0) {
        imageLoader.displayImage(
            "http://img.sltdb.com/processes/resize.php?image=" + article.filepath + "&size=100&quality=70",
            viewHolder.thumbView
            );
        viewHolder.thumbView.setVisibility(View.VISIBLE);
    } else {
        viewHolder.thumbView.setVisibility(View.GONE);
    }

    return view;
} 
```

至于图像不正确 - 这并不常见，但有时在滚动时，我会看到 2 个相同的图像，当我查看文章时，它们根本不相关（即没有机会实际拥有相同的图像）所以 - 我滚动离开它，然后返回，它不再是不正确的图像。

注意：我是 Java/Android 的新手——你可能已经注意到了。

**每个评论请求的更多代码：**

```
private View getWorkingView(final View convertView) {
    // The workingView is basically just the convertView re-used if possible
    // or inflated new if not possible
    View workingView = null;

    if(null == convertView) {
        final Context context = getContext();
        final LayoutInflater inflater = (LayoutInflater)context.getSystemService
          (Context.LAYOUT_INFLATER_SERVICE);

        workingView = inflater.inflate(articleItemLayoutResource, null);
    } else {
        workingView = convertView;
    }

    return workingView;
} 
```

**更新：** 我的清单文件有：

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/> 
```

但是我找到的缓存文件夹是完全空的：

```
mnt
  -sdcard
    -Android
      -data
        -com.mysite.news
          -cache
            -uil-images 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-16T14:04:50.487

我在列表视图中遇到了类似的图像问题。[这个答案](https://stackoverflow.com/questions/6081497/listview-shows-wrong-images)可能会纠正您错误的图像问题。

我刚刚使用 UniversalImageLoader 下载了示例项目，它表现出与您描述的相同的行为。

到目前为止查看源代码的一些注意事项。

```
public static final int DEFAULT_THREAD_POOL_SIZE = 3;
public static final int DEFAULT_THREAD_PRIORITY = Thread.NORM_PRIORITY - 1;
public static final int DEFAULT_MEMORY_CACHE_SIZE = 2 * 1024 * 1024; // bytes 
```

这表示任何时候都会有三个线程下载和最多 2MB 的图像。你下载的图片有多大？你也缓存到磁盘吗？如果是这样，那将是缓慢的。

要配置 ImageLoader 中的一些基本选项，您需要传入 displayImage：

```
 DisplayImageOptions options = new DisplayImageOptions.Builder()
     .showStubImage(R.drawable.stub_image)
     .cacheInMemory()
     .cacheOnDisc()
     .build(); 
```

我还希望您尝试以下选项：

```
ImageLoaderConfiguration imageLoaderConfiguration = new ImageLoaderConfiguration.Builder(this)
    .enableLogging()
    .memoryCacheSize(41943040)
    .discCacheSize(104857600)
    .threadPoolSize(10)
    .build();

imageLoader = ImageLoader.getInstance();
imageLoader.init(imageLoaderConfiguration); 
```

通过我的测试，图像在磁盘上，但加载仍然很慢。

经过大量测试，我确定主要问题是 UniversalImageLoader 速度很慢。具体来说，ImageLoader 和 LoadAndDisplayImageTask 正在阻止工作。我（很快）将 LoadAndDisplayImageTask 重写为 AsyncTask，它立即表现得更好。您可以在 GitHub 上下载代码的分叉版本。

[带有 AsyncTasks 的通用图像加载器](https://github.com/palmerc/Android-Universal-Image-Loader)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T20:40:16.997

另一种解决方案是来自点火开源项目的“RemoteImageView”。

[http://kaeppler.github.com/ignition-docs/ignition-core/apidocs/com/github/ignition/core/widgets/RemoteImageView.html](http://kaeppler.github.com/ignition-docs/ignition-core/apidocs/com/github/ignition/core/widgets/RemoteImageView.html)

实际上，RemoteImageView 扩展了 ImageView 并在幕后为您完成所有获取/缓存。

虽然它不一定能解决您列出的问题，但作为替代解决方案可能值得研究。

编辑：如果您仍然需要远程图像解决方案，我强烈推荐 Picasso。我已经用毕加索替换了我的应用程序中的 RemoteImageView：http: [//square.github.io/picasso/](http://square.github.io/picasso/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T14:08:23.813

我怀疑**resize.php**很慢，特别是如果它必须调整大页面的大小，并且收到了几个请求。并且以某种方式缓存在 imageLoader 中没有完成。

首先，我会在图像加载*后*完成其余的工作：字幕、描述和所有。*因为如果图像加载时间过长，如果描述和其他所有内容一起出现，则会有更即时的效果。通常你的陈述顺序是好的。*

@CameronLowellPallmer 的答案负责切换图像和缓存。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T14:44:37.843

这门课对我有用：

```
import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.lang.ref.WeakReference;
import java.util.HashMap;
import java.util.Map;

import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.HttpStatus;
import org.apache.http.HttpVersion;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.params.BasicHttpParams;
import org.apache.http.params.CoreProtocolPNames;
import org.apache.http.params.HttpParams;

import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Color;
import android.graphics.drawable.ColorDrawable;
import android.graphics.drawable.Drawable;
import android.os.AsyncTask;
import android.util.Log;
import android.widget.ImageView;

public class ImageDownloader {

    Map<String,Bitmap> imageCache;

    public ImageDownloader(){
        imageCache = new HashMap<String, Bitmap>();

    }

    //download function
    public void download(String url, ImageView imageView) {
         if (cancelPotentialDownload(url, imageView)&&url!=null) {

             //Caching code right here
             String filename = String.valueOf(url.hashCode());
             File f = new File(getCacheDirectory(imageView.getContext()), filename);

              // Is the bitmap in our memory cache?
             Bitmap bitmap = null;

              bitmap = (Bitmap)imageCache.get(f.getPath());
                BitmapFactory.Options bfOptions=new BitmapFactory.Options();
                bfOptions.inDither=false;                     //Disable Dithering mode
                bfOptions.inPurgeable=true;                   //Tell to gc that whether it needs free memory, the Bitmap can be cleared
                bfOptions.inInputShareable=true;              //Which kind of reference will be used to recover the Bitmap data after being clear, when it will be used in the future
                bfOptions.inTempStorage=new byte[32 * 1024]; 
                FileInputStream fs=null;

              if(bitmap == null){

                  //bitmap = BitmapFactory.decodeFile(f.getPath(),options);
                  try {
                      fs = new FileInputStream(f);
                        if(fs!=null) bitmap=BitmapFactory.decodeFileDescriptor(fs.getFD(), null, bfOptions);
                    } catch (IOException e) {
                        //TODO do something intelligent
                        e.printStackTrace();
                    } finally{ 
                        if(fs!=null) {
                            try {
                                fs.close();
                            } catch (IOException e) {
                                // TODO Auto-generated catch block
                                e.printStackTrace();
                            }
                        }
                    }

                  if(bitmap != null){
                      imageCache.put(f.getPath(), bitmap);
                  }

              }
              //No? download it
              if(bitmap == null){
                  BitmapDownloaderTask task = new BitmapDownloaderTask(imageView);
                  DownloadedDrawable downloadedDrawable = new DownloadedDrawable(task);
                  imageView.setImageDrawable(downloadedDrawable);
                  task.execute(url);
              }else{
                  //Yes? set the image
                  imageView.setImageBitmap(bitmap);
              }
         }
    }

    //cancel a download (internal only)
    private static boolean cancelPotentialDownload(String url, ImageView imageView) {
        BitmapDownloaderTask bitmapDownloaderTask = getBitmapDownloaderTask(imageView);

        if (bitmapDownloaderTask != null) {
            String bitmapUrl = bitmapDownloaderTask.url;
            if ((bitmapUrl == null) || (!bitmapUrl.equals(url))) {
                bitmapDownloaderTask.cancel(true);
            } else {
                // The same URL is already being downloaded.
                return false;
            }
        }
        return true;
    }

    //gets an existing download if one exists for the imageview
    private static BitmapDownloaderTask getBitmapDownloaderTask(ImageView imageView) {
        if (imageView != null) {
            Drawable drawable = imageView.getDrawable();
            if (drawable instanceof DownloadedDrawable) {
                DownloadedDrawable downloadedDrawable = (DownloadedDrawable)drawable;
                return downloadedDrawable.getBitmapDownloaderTask();
            }
        }
        return null;
    }

    //our caching functions
    // Find the dir to save cached images
    public static File getCacheDirectory(Context context){
        String sdState = android.os.Environment.getExternalStorageState();
        File cacheDir;

        if (sdState.equals(android.os.Environment.MEDIA_MOUNTED)) {
            File sdDir = android.os.Environment.getExternalStorageDirectory();  

            //TODO : Change your diretcory here
            cacheDir = new File(sdDir,"data/tac/images");
        }
        else
            cacheDir = context.getCacheDir();

        if(!cacheDir.exists())
            cacheDir.mkdirs();
            return cacheDir;
    }

    private void writeFile(Bitmap bmp, File f) {
          FileOutputStream out = null;

          try {
            out = new FileOutputStream(f);
            bmp.compress(Bitmap.CompressFormat.PNG, 80, out);
          } catch (Exception e) {
            e.printStackTrace();
          }
          finally { 
            try { if (out != null ) out.close(); }
            catch(Exception ex) {} 
          }
    }
    ///////////////////////

    //download asynctask
    public class BitmapDownloaderTask extends AsyncTask<String, Void, Bitmap> {
        private String url;
        private final WeakReference<ImageView> imageViewReference;

        public BitmapDownloaderTask(ImageView imageView) {
            imageViewReference = new WeakReference<ImageView>(imageView);
        }

        @Override
        // Actual download method, run in the task thread
        protected Bitmap doInBackground(String... params) {
             // params comes from the execute() call: params[0] is the url.
             url = (String)params[0];
             return downloadBitmap(params[0]);
        }

        @Override
        // Once the image is downloaded, associates it to the imageView
        protected void onPostExecute(Bitmap bitmap) {
            if (isCancelled()) {
                bitmap = null;
            }

            if (imageViewReference != null) {
                ImageView imageView = imageViewReference.get();
                BitmapDownloaderTask bitmapDownloaderTask = getBitmapDownloaderTask(imageView);
                // Change bitmap only if this process is still associated with it
                if (this == bitmapDownloaderTask) {
                    imageView.setImageBitmap(bitmap);

                    //cache the image

                    String filename = String.valueOf(url.hashCode());
                    File f = new File(getCacheDirectory(imageView.getContext()), filename);

                    imageCache.put(f.getPath(), bitmap);

                    writeFile(bitmap, f);
                }
            }
        }

    }

    static class DownloadedDrawable extends ColorDrawable {
        private final WeakReference<BitmapDownloaderTask> bitmapDownloaderTaskReference;

        public DownloadedDrawable(BitmapDownloaderTask bitmapDownloaderTask) {
            super(Color.BLACK);
            bitmapDownloaderTaskReference =
                new WeakReference<BitmapDownloaderTask>(bitmapDownloaderTask);
        }

        public BitmapDownloaderTask getBitmapDownloaderTask() {
            return bitmapDownloaderTaskReference.get();
        }
    }

    //the actual download code
    static Bitmap downloadBitmap(String url) {
        HttpParams params = new BasicHttpParams();
        params.setParameter(CoreProtocolPNames.PROTOCOL_VERSION, HttpVersion.HTTP_1_1);
        HttpClient client = new DefaultHttpClient(params);
        final HttpGet getRequest = new HttpGet(url);

        try {
            HttpResponse response = client.execute(getRequest);
            final int statusCode = response.getStatusLine().getStatusCode();
            if (statusCode != HttpStatus.SC_OK) { 
                Log.w("ImageDownloader", "Error " + statusCode + " while retrieving bitmap from " + url); 
                return null;
            }

            final HttpEntity entity = response.getEntity();
            if (entity != null) {
                InputStream inputStream = null;
                try {
                    inputStream = entity.getContent(); 
                    final Bitmap bitmap = BitmapFactory.decodeStream(inputStream);
                    return bitmap;
                } finally {
                    if (inputStream != null) {
                        inputStream.close();  
                    }
                    entity.consumeContent();
                }
            }
        } catch (Exception e) {
            // Could provide a more explicit error message for IOException or IllegalStateException
            getRequest.abort();
            Log.w("ImageDownloader", "Error while retrieving bitmap from " + url + e.toString());
        } finally {
            if (client != null) {
                //client.close();
            }
        }
        return null;
    }
} 
```

使用示例：

```
downloader = new ImageDownloader();
ImageView image_profile =(ImageView) row.findViewById(R.id.image_profile);
downloader.download(url, image_profile); 
```

# mysql - 插入数据时的 MySQL JOIN

> ID：11440639
> 
> 赞同：0
> 
> 时间：2012-07-11T20:09:27.040
> 
> 标签：mysql, sql, join, insert

我有两张桌子：`images`和`servers`。这是与这两个表相关的架构：

`id, name, uploaded, views, server_id`

`id, name, description, drive_space, enabled`

在`images`表上，是表中字段`server_id`的外键。很简单的东西。许多图像属于一台服务器。`id``servers`

当我插入图像时，它*必须*有一个指向图像所在服务器的键。当我插入行时，我得到了服务器的名称（不是它的 ID），所以我不能只插入它。我可以通过两个查询来实现我想要的（一个用于获取服务器 ID，另一个用于将图像插入数据库），但理想情况下，我希望它在一个带有 JOIN 的查询中完成，因为它是最佳实践。

当涉及到 SELECT 语句时，我对 JOINS 几乎一无所知，对于 INSERT 更是如此。谁能帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T20:15:14.403

无需加入。只需使用 INSERT ... SELECT ...：

```
INSERT INTO images
(name, uploaded, views, server_id)
SELECT 'imagename', CURTIME(), 0, id
FROM servers
WHERE name = 'servername' 
```

# perl - 如何为 HTTP::AppServer 添加 ipv6 支持？

> ID：11440640
> 
> 赞同：0
> 
> 时间：2012-07-11T20:09:27.283
> 
> 标签：perl, http, ipv6

我有一个使用来自 cpan的模块[HTTP::AppServer的 http 服务器。](http://search.cpan.org/~kitomer/HTTP-AppServer-0.04/lib/HTTP/AppServer.pm)

我可以使用`127.0.0.1`or连接到我的服务器`localhost`，而使用`::1`.

以下是 curl 的一些示例：

```
$ curl http://127.0.0.1:8080/index.html
This is a test.
$ curl -g http://[::1]:8080/index.html
curl: (7) couldn't connect to host 
```

这是服务器的启动方式：

```
use HTTP::AppServer;
use IO::Socket::IP -register;

  my $server = HTTP::AppServer->new( StartBackground => 0, ServerPort => 8080 );

  $server->plugin('FileRetriever', DocRoot => '/tmp');

  $server->start; 
```

实际上它要复杂得多。但我不认为脚本的所有其余部分都是必要的。我添加了模块[IO::Socket::IP](http://search.cpan.org/~pevans/IO-Socket-IP-0.16/lib/IO/Socket/IP.pm)并将模块 Socket 升级到[此处](http://search.cpan.org/~pevans/Socket-2.002/Socket.pm)找到的版本，以使 IO::Socket::IP 工作。

仍然，它不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T20:43:20.503

尝试使用比 5.14 更新的 Perl 版本。

[http://www.perl.org/about/whitepapers/perl-ipv6.html](http://www.perl.org/about/whitepapers/perl-ipv6.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T17:53:49.587

在 LeoNerd 说 IO::Socket::IP 在这种情况下无法帮助我之后，我找到了一个替代解决方案，尽管这个解决方案只适用于某些 perl 版本。

HTTP::AppServer 基于 HTTP::Server::Simple，我在 cpan 上找到了支持 ipv6 的第二个模块的更新版本。

首先，您需要在此处下载较新版本的 HTTP::Server::Simple：

[http://metacpan.org/pod/HTTP::Server::Simple](http://metacpan.org/pod/HTTP%3a%3aServer%3a%3aSimple)

如您所见，它有一个`new`接受新参数的不同方法`family`。

现在您必须获取 HTTP::AppServer.pm 并`init`从

```
sub init
{
    my ($self, %opts) = @_;

    # server options defaults
    my %defaults = (StartBackground => 0, ServerPort => 3000);

    # set options or use defaults
    map { $self->{$_} = (exists $opts{$_} ? $opts{$_} : $defaults{$_}) }
        keys %defaults;

    $self->{'server'} = HTTP::AppServer::Base->new($self->{'ServerPort'});

    return $self;
} 
```

至

```
sub init
{
    my ($self, %opts) = @_;

    # server options defaults
    my %defaults = (StartBackground => 0, ServerPort => 3000);

    # set options or use defaults
    map { $self->{$_} = (exists $opts{$_} ? $opts{$_} : $defaults{$_}) }
        keys %defaults;

    $self->{'server'} = HTTP::AppServer::Base->new($self->{'ServerPort'}, Socket::AF_INET6);

    return $self;
} 
```

不幸的是，这回答了问题，但不是我的问题，因为它不适用于 perl 5.8.8 也将 Socket.pm 升级到最新版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T12:01:45.923

如果这不起作用，则可能是`IO::Socket::IP`或中某处的错误`HTTP::AppServer`。你能把它作为 RT 上的 bug 发给我吗`IO::Socket::IP`，我会研究一下。

[https://rt.cpan.org/Dist/Display.html?Queue=IO-Socket-IP](https://rt.cpan.org/Dist/Display.html?Queue=IO-Socket-IP)

# objective-c - RestKit 使用 setObjectMapping 从核心数据中删除旧数据

> ID：11440641
> 
> 赞同：10
> 
> 时间：2012-07-11T20:09:27.227
> 
> 标签：objective-c, ios, xml, restkit

我已经查看了[RestKit Object Mapping 的答案：使用 setObjectMapping:forResourcePathPattern:withFetchRequestBlock](https://stackoverflow.com/questions/10516987)的困难，它正在工作，但仅适用于最后一个映射。例子：

```
RKManagedObjectMapping *audioSourcesMapping = [RKManagedObjectMapping mappingForEntityWithName:kEntityAudioSources inManagedObjectStore:objectStore];
[audioSourcesMapping mapKeyPath:@"icon" toAttribute:@"icon"];
[audioSourcesMapping mapKeyPath:@"name" toAttribute:@"name"];
[audioSourcesMapping mapKeyPath:@"notes" toAttribute:@"notes"];
[audioSourcesMapping mapKeyPath:@"section" toAttribute:@"section"];
[audioSourcesMapping mapKeyPath:@"url" toAttribute:@"url"];
audioSourcesMapping.primaryKeyAttribute = @"name";
[wsiObjectManager.mappingProvider registerMapping:audioSourcesMapping withRootKeyPath:@"winSystem.winSystemAudioSources.winSystemAudioSource"];

[wsiObjectManager.mappingProvider setObjectMapping:audioSourcesMapping forResourcePathPattern:kWinSystemInfoXml 
                             withFetchRequestBlock:^NSFetchRequest *(NSString *resourcePath) {
                                 return [AudioSources fetchRequest];
                             }];

RKManagedObjectMapping *eventsMapping = [RKManagedObjectMapping mappingForEntityWithName:kEntityEvents inManagedObjectStore:objectStore];
[eventsMapping mapKeyPath:@"contact" toAttribute:@"contact"];
[eventsMapping mapKeyPath:@"startDate" toAttribute:@"startDate"];
[eventsMapping mapKeyPath:@"endDate" toAttribute:@"endDate"];
[eventsMapping mapKeyPath:@"icon" toAttribute:@"icon"];
[eventsMapping mapKeyPath:@"location" toAttribute:@"location"];
[eventsMapping mapKeyPath:@"name" toAttribute:@"name"];
[eventsMapping mapKeyPath:@"notes" toAttribute:@"notes"];
[eventsMapping mapKeyPath:@"section" toAttribute:@"section"];
[eventsMapping mapKeyPath:@"url" toAttribute:@"url"];
eventsMapping.primaryKeyAttribute = @"name";
[wsiObjectManager.mappingProvider registerMapping:eventsMapping withRootKeyPath:@"winSystem.winSystemEvents.winSystemEvent"];    

[wsiObjectManager.mappingProvider setObjectMapping:eventsMapping forResourcePathPattern:kWinSystemInfoXml 
                             withFetchRequestBlock:^NSFetchRequest *(NSString *resourcePath) {
                                 return [Events fetchRequest];
                             }]; 
```

所有映射都运行良好。更新源 xml 时，会创建新记录。当我删除 a`Event`时，它会被删除。当我删除`AudioSource`它时，它不会被删除。

如果我删除第二个`setObjectMapping:forResourcePathPattern:withFetchRequestBlock`，则`AudioSource`正确删除，但删除`Event`的不是。我在这个 xml 文件中有 4 个正在使用的映射。

这就像最后一次`setObjectMapping:forResourcePathPattern:withFetchRequestBlock`胜利的召唤。

我的解决方法是在`setObjectMapping:forResourcePathPattern:withFetchRequestBlock`最常更改的映射上使用 （在本例中为`Events`），并添加一个使缓存无效、清空数据库和更新的按钮。我一定缺少一些简单的东西。

Xcode：4.3.3 RestKit：0.10.1

示例 xml 文件。这一切都很好，但只从核心数据中删除使用最后一个映射`setObjectMapping:forResourcePathPattern:withFetchRequestBlock`

```
 <?xml version="1.0" encoding="UTF-8"?>
    <winSystem>
        <winSystemAudioSources>
            <winSystemAudioSource
                icon="audio.png"
                name="Hub Audio"
                notes="Cleaner Sound. Audio is delayed by about 30 seconds. This is a great way to see if you are making into the WIN System."
                section=" WIN System"
                url="http://stream.winsystem.org:443/2560.mp3" />
        </winSystemAudioSources>
        <winSystemEvents>
            <winSystemEvent
                contact=""
                endDate=""
                icon="net.png"
                location="WIN System reflector 9100"
                name="Insomniac Trivia Net"
                notes="Every Night @ 23:00 PT - WIN System reflector 9100\. Join the Yahoo! group: http://groups.yahoo.com/group/insomniac-net/join"
                section="Ham Nets"
                startDate=""
                url="http://www.thedeanfamily.com/WinSystem/InsomniacNet.htm" />
        </winSystemEvents>
        <winSystemLinks>
            <winSystemLink
                icon="winsystem.png"
                name=" WIN System Home Page"
                notes="The WIN System Home Page"
                section=" WIN System"
                type="web"
                url="http://www.winsystem.org/" />
        </winSystemLinks>
        <winSystemRepeaters>
            <winSystemRepeater
                callSign="K6JSI"
                freqOffsetPl="448.800* (-) 100.0"
                grouping="winsystem"
                latitudeDefault=""
                locationElevation="Shorty's house, 560' + 53'"
                longitudeDefault=""
                node="A 01330"
                repeaterId="1"
                serviceArea="Vista"
                serviceState="CA" />
        </winSystemRepeaters>
    </winSystem> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T14:02:13.307

我以前没有使用过托管对象，但这里要做的第一件事是通过对象映射、网络请求和核心数据激活 restkit 日志，这样您就可以检查 restkit 从服务器获取什么、映射如何工作以及如何从 CD 中获取内容，因此请尝试以下操作：

```
//This can be added in your app delegate
RKLogConfigureByName("RestKit/Network", RKLogLevelTrace);
RKLogConfigureByName("RestKit/ObjectMapping", RKLogLevelTrace);
RKLogConfigureByName("RestKit/CoreData", RKLogLevelTrace); 
```

查看您的代码，您在此处对两个映射使用相同的路径：

```
// forResourcePathPattern:kWinSystemInfoXml
[wsiObjectManager.mappingProvider setObjectMapping:audioSourcesMapping forResourcePathPattern:kWinSystemInfoXml 
                         withFetchRequestBlock:^NSFetchRequest *(NSString *resourcePath) {
                             return [AudioSources fetchRequest];
                         }];

// forResourcePathPattern:kWinSystemInfoXml
[wsiObjectManager.mappingProvider setObjectMapping:eventsMapping forResourcePathPattern:kWinSystemInfoXml 
                         withFetchRequestBlock:^NSFetchRequest *(NSString *resourcePath) {
                             return [Events fetchRequest];
                         }]; 
```

我认为这可能会导致冲突，因为 RK 选择两种资源之一映射到该路径，所以你应该：

1.  调试 Core Data 在做什么。
2.  尝试使用映射键路径方法而不是资源路径模式，这样 RK 就不会搞砸了，你需要定义不同的方法来映射每种对象，现在我认为第一个被覆盖了。

如果这不起作用，您应该发布您如何在代码中删除内容，也许从您的视图控制器发布所有代码。可能发生的情况是调用被您的代码覆盖在某处。你在用积木吗？

希望有帮助！

# android - 在 xml 中转换/创建可读文档

> ID：11440644
> 
> 赞同：0
> 
> 时间：2012-07-11T20:09:36.463
> 
> 标签：android, xml, docx, .doc, kingsoft

我正在创建一个 Android 应用程序（在 eclipse 中），我需要创建一个文档 - 一封信。我正在用 xml 编写它，并且我已经能够生成 .xml 和 .doc，这两个 MSWord 都会很高兴地打开，这很神奇，但我真的需要能够在标准的 Android 文档阅读器中打开它，例如金山Office/QuickOffice/OfficePro等。不幸的是，这些应用程序都将其作为xml源打开，阅读和编​​辑很麻烦。基于网络的 Google 文档阅读器在我的文档中也存在问题。

我的标记中一定遗漏了一些东西，我只是想知道是否有人知道我的 Word 文档 (.doc) 所需的标记正是如此，因此文档阅读器可以解析？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T01:19:07.643

.doc 文件不是 XML，不会显示为 XML。如果您看到的是 XML，那么该文件并不是真正的 .doc 格式（即使您使用 .doc 扩展名命名它）。如果您需要生成 .doc 格式（而不仅仅是 docx），那么您将面临更艰巨的任务。对于 Android，我唯一可以建议的是调用像 Docmosis 这样的服务，它可以为你生成 PDF/DOC 等 - 但它不是免费的，你需要连接。对于在各种平台上查看文档，一种可能更好的方法是始终显示 PDF，并且只使用需要/预期进行编辑的 .doc/.docx 等格式。

# c# - WPF MVVM 和命令

> ID：11440645
> 
> 赞同：0
> 
> 时间：2012-07-11T20:09:36.467
> 
> 标签：c#, wpf, xaml, mvvm, command

我正在尝试利用命令创建一个 WPF 应用程序，但我遇到了启用菜单按钮的命令的问题。我正在做一些简单的验证，在这种情况下，“保存”按钮被禁用，直到用户创建新文档或加载现有文档。

假设我的视图模型看起来像这样，其中对象 ViewModel 继承了 INotifyPropertyChanged：

```
public ViewModel()
{
    New = new RelayCommand( OnNew, CanNew );
    Save = new RelayCommand( OnSave, CanSave );
}

ICommand m_cmdNew;

public ICommand New
{
    get { return m_cmdNew; }
    set
    {
        m_cmdNew = value;
        OnPropertyChanged( "New" );
    }
}

void OnNew( object param )
{
    bCanSave = true;
    // I read that this could resolve my problem.
    CommandManager.InvalidateRequerySuggested();
}

bool CanNew(  object param )
{
    return true;
} 
```

假设我也在为“保存”命令做同样的事情，唯一的例外是“CanSave”看起来像这样：

```
bool CanSave( object param )
{
    return bCanSave;
} 
```

我的 Xaml：

```
<Menu>
    <MenuItem Header="Text">
        <MenuItem Header="New" Command="{Binding New}"/>
        <MenuItem Header="Save" Command="{Binding Save}"/>
    </MenuItem>
</Menu> 
```

我遇到的问题是在我更改变量“bCanSave”后永远不会调用 CanSave 方法。我怎样才能做到这一点？我知道我可以简单地创建一个属性并使用 INotifyPropertyChanged 和 XAML 绑定，我可以简单地切换 IsEnabled 属性，但是从我阅读的内容来看，这似乎是很多工作，命令已经这样做了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T20:13:47.873

您需要在[`CanExecuteChanged`](http://msdn.microsoft.com/en-us/library/system.windows.input.icommand.canexecutechanged.aspx)要重新评估的命令上引发事件，在这种情况下，当那个可怕的匈牙利布尔值发生变化时应该这样做。

（我建议只制作命令字段`readonly`和属性`get`，命令通常不会更改）

# vb.net - 通过回发但特定于页面用户的变量的持久性

> ID：11440649
> 
> 赞同：1
> 
> 时间：2012-07-11T20:09:51.097
> 
> 标签：vb.net, persistence, shared, public

我正在一个网站上工作，其中包含 .aspx 页面和 VB.Net 中的代码。在一个页面上，我需要一个公共共享变量，例如

```
Public Shared comments As String() = New String(2) {"", "", ""} 
```

因为我需要通过页面的回帖来持久化“评论”的价值。至少我认为公开共享是保持持久性的唯一方法，除非你们告诉我我错了。

但另一方面，我不希望可能使用同一页面的其他用户与其他用户的“评论”数据发生冲突。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T13:54:48.980

这取决于您需要的持久性水平。

如果您只需要评论在页面上存在直到用户离开它，请使用您页面的 ViewState：

```
Public Property Comments As String()
    Get
        If Me.ViewState("Comments") Is Nothing Then
            Me.ViewState("Comments") = New String(2) {"", "", ""}
        End If
        Return Me.ViewState("Comments")
    End Get
    Set(value As String())
        Me.ViewState("Comments") = value
    End Set
End Property 
```

如果您希望页面在导航离开和重新登陆页面（即初始加载而不是回发）之间保持页面的值，请使用您的会话状态包：

```
Public Property Comments As String()
    Get
        If Me.Session("MyPage_Comments") Is Nothing Then
            Me.Session("MyPage_Comments") = New String(2) {"", "", ""}
        End If
        Return Me.Session("MyPage_Comments")
    End Get
    Set(value As String())
        Me.Session("MyPage_Comments") = value
    End Set
End Property 
```

如果您希望即使在会话过期并且用户稍后返回之后仍然保持这种状态，您需要写入一个后备存储，该存储将用户链接到他们的评论，例如数据库，或者 - 我这样说用更少的热情——写出类似 XML 文件的东西，然后在如下语句中加载初始页面加载时的值：

```
 Public Sub PageLoad(sender As Object, e As EventArgs) Handles Me.Load
     If Not Me.IsPostBack
         ' Read the value from the backing store
     End If
 End Sub 
```

但是，在使用后备存储时，我通常建议使用其中一个数据源控件以及诸如 ListView 或 GridView 之类的数据绑定控件来显示信息。

# twitter - 包含链接和主题标签的 Twitter API 帖子不会在 Twitter 上显示该主题标签

> ID：11440650
> 
> 赞同：1
> 
> 时间：2012-07-11T20:09:52.617
> 
> 标签：twitter, twitter-oauth, hashtag

我有一个博客，允许读者将他们对帖子的评论直接发布到 wordpress 中。我还包括相关帖子的主题标签作为表单字段的初始值。发布评论后，它会在带有主题标签的 Twitter 页面上正确显示。但是，当我在评论中包含一个 url 时，它在 twitter 用户的时间线上显示得非常好，但不会显示在主题标签页面上。

我认为这与 php 自动在表单输入中加入转义斜杠有关，因为包含撇号的评论也会在 Twitter 上显示转义斜杠。例如：

这是一个阳光灿烂的日子。

是什么赋予了？

# c++ - 在 Ubuntu 中编译 C++ boost dynamic_bitset 代码

> ID：11440652
> 
> 赞同：0
> 
> 时间：2012-07-11T20:09:58.427
> 
> 标签：c++, boost, compilation

我在我的代码中使用了 boost 的 dynamic_bitset。我想知道是否应该为代码包含任何 boost 库。我读到我们只需要在包含指令中包含 boost 路径，并且 boost 应该可以正常工作（[此链接](https://stackoverflow.com/questions/846566/using-boost-on-ubuntu)）。

但是当我尝试编译我的代码时，我收到以下错误。

boost/dynamic_bitset/dynamic_bitset.hpp：没有这样的文件或目录

这是一个使用 dynamic_bit 的简单 boost 代码。

```
 #include <iostream>
    #include <boost/dynamic_bitset.hpp>
//  Also tried giving the entire boost path
//  #include "/home/user_name/BOOST_CPP/boost_1_50_0/boost_1_50_0/boost/dynamic_bitset.hpp"
    using namespace std;
    int main(int argc, char* argv[])
    {
        cout<<"Welcome to Boost"<<endl;
        boost::dynamic_bitset<> x(10);
        return 0;
    } 
```

[编辑] 我使用`g++ boost_hello.cpp`我是否遗漏了什么？我在哪里可以找到我应该包含哪些库来编译 boost 代码。？

PS：我按照[Jedf 的博客](http://blog.jedf.com/2012/06/installing-boost-libraries-150-on.html)安装了 boost 库，它是成功的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:42:13.437

很可能您的包含指令不正确。您的错误似乎表明它`#include <boost/dynamic_bitset.hpp>`正在工作，但是，该标头确实有效`#include "boost/dynamic_bitset/dynamic_bitset.hpp"`，这就是您的错误所抱怨的标头。

我假设您使用的是 g++，很可能您`g++ -I /home/user_name/BOOST_CPP/boost_1_50_0/boost_1_50_0/`在编译命令行中需要类似的东西。

如果您将显示您用于编译的命令，我们可能可以确定。

# android - 如何在 Android 中使用音频 api 录制音频？

> ID：11440654
> 
> 赞同：4
> 
> 时间：2012-07-11T20:10:05.223
> 
> 标签：android, microphone

我有一部 2.3.3 版的 LG Android 手机。我需要在耳机插孔中连接一个麦克风，因为我想创建一个读取声音样本的应用程序。

如何以编程方式读取示例？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T06:54:25.440

如果您真的想阅读 AudioSamples，我建议您使用 AudioRecord 而不是 MediaRecorder，因为它可以让您对 AudioSamples 进行更多控制...为此，您可以使用以下代码，AudioCapturer 是我用于从中获取样本的包装类AudioRecord 对象..IAudioReceiver 是一个接口，它具有处理音频数据的方法。

```
public class AudioCapturer implements Runnable {

    private AudioRecord audioRecorder = null;
    private int bufferSize;
    private int samplePerSec = 16000;
    private String LOG_TAG = "AudioCapturer";
    private Thread thread = null;

    private boolean isRecording;
    private static AudioCapturer audioCapturer;

    private IAudioReceiver iAudioReceiver;

    private AudioCapturer(IAudioReceiver audioReceiver) {
        this.iAudioReceiver = audioReceiver;
    }

    public static AudioCapturer getInstance(IAudioReceiver audioReceiver) {
        if (audioCapturer == null) {
            audioCapturer = new AudioCapturer(audioReceiver);
        }
        return audioCapturer;
    }

    public void start() {

        bufferSize = AudioRecord.getMinBufferSize(samplePerSec, AudioFormat.CHANNEL_IN_MONO, AudioFormat.ENCODING_PCM_16BIT);

        if (bufferSize != AudioRecord.ERROR_BAD_VALUE && bufferSize != AudioRecord.ERROR) {

            audioRecorder = new AudioRecord(MediaRecorder.AudioSource.DEFAULT, this.samplePerSec, AudioFormat.CHANNEL_IN_MONO,
                    AudioFormat.ENCODING_PCM_16BIT, this.bufferSize * 10); // bufferSize
                                                                            // 10x

            if (audioRecorder != null && audioRecorder.getState() == AudioRecord.STATE_INITIALIZED) {
                Log.i(LOG_TAG, "Audio Recorder created");

                audioRecorder.startRecording();
                isRecording = true;
                thread = new Thread(this);
                thread.start();

            } else {
                Log.e(LOG_TAG, "Unable to create AudioRecord instance");
            }

        } else {
            Log.e(LOG_TAG, "Unable to get minimum buffer size");
        }
    }

    public void stop() {
        isRecording = false;
        if (audioRecorder != null) {
            if (audioRecorder.getRecordingState() == AudioRecord.RECORDSTATE_RECORDING) {
                // System.out
                // .println("Stopping the recorder inside AudioRecorder");
                audioRecorder.stop();
            }
            if (audioRecorder.getState() == AudioRecord.STATE_INITIALIZED) {
                audioRecorder.release();
            }
        }
    }

    public boolean isRecording() {
        return (audioRecorder != null) ? (audioRecorder.getRecordingState() == AudioRecord.RECORDSTATE_RECORDING) : false;
    }

    @Override
    public void run() {
        android.os.Process.setThreadPriority(android.os.Process.THREAD_PRIORITY_URGENT_AUDIO);  
        while (isRecording && audioRecorder.getRecordingState() == AudioRecord.RECORDSTATE_RECORDING) {
            short[] tempBuf = new short[Constants.FRAME_SIZE / 2];
            audioRecorder.read(tempBuf, 0, tempBuf.length);     
            iAudioReceiver.capturedAudioReceived(tempBuf, false);
        }
    }

    /*
     * (non-Javadoc)
     * 
     * @see java.lang.Object#finalize()
     */
    @Override
    protected void finalize() throws Throwable {
        super.finalize();
        System.out.println("AudioCapturer finalizer");
        if (audioRecorder != null && audioRecorder.getState() == AudioRecord.STATE_INITIALIZED) {
            audioRecorder.stop();
            audioRecorder.release();
        }
        audioRecorder = null;
            iAudioReceiver = null;  
        thread = null;
    }

} 
```

现在您可以从程序的 Main 类中使用此类的对象，它将开始为您提供音频样本，您可以在 IAudioReceiver（使用这些样本的类）中处理它们。

如果您仍想使用 MediaRecorder，[此链接](http://www.benmccann.com/dev-blog/android-audio-recording-tutorial/)可能对您有用，

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T21:39:36.267

> 2）我如何以编程方式读取样本？

据我所知，在 Android 中，您可以使用以下两个类之一录制音频：

*   [媒体记录器类](http://developer.android.com/reference/android/media/MediaRecorder.html)

    > 用于录制音频和视频。录音控制基于一个简单的状态机

*   [录音类](http://developer.android.com/reference/android/media/AudioRecord.html)

    > AudioRecord 类管理 Java 应用程序的音频资源，以记录来自平台音频输入硬件的音频。这是通过从 AudioRecord 对象“拉”（读取）数据来实现的。应用程序负责使用以下三种方法之一及时轮询 AudioRecord 对象：read(byte[], int, int)、read(short[], int, int) 或 read(ByteBuffer, int)。选择使用哪种方法将基于 AudioRecord 用户最方便的音频数据存储格式。

**Ps：**按照上面的链接阅读和理解最适合您需求的链接。

* * *

> 1）您推荐哪种麦克风？

正如我在对您的问题的评论中提到的那样，这在 stackoverflow 上已经[偏离主题](https://stackoverflow.com/faq#questions)，但为了完整起见：

*   [如何在 Galaxy Nexus 上使用外接麦克风？](https://android.stackexchange.com/q/19368/16265)

*   [安卓手机或平板电脑的外接麦克风有什么成功吗？](https://android.stackexchange.com/q/19339/16265)

# continuous-integration - NAnt - 访问路径被拒绝

> ID：11440661
> 
> 赞同：1
> 
> 时间：2012-07-11T20:10:25.110
> 
> 标签：continuous-integration, nant

使用 NAnt，我正在尝试使用“获取”任务将文件下载到特定目录。

我知道我可以毫无问题地将文件复制到目录中，但是当任务执行时，我收到一条消息，指出“访问路径”被拒绝。

我怎样才能克服这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T20:10:26.203

在 'get' 任务的 'dest' 属性上设置完整路径。它需要目标文件的完整路径，而不仅仅是目标目录。

[来源（作为获取搜索结果的单独问题发布，因为我不得不寻找一段时间）](https://stackoverflow.com/questions/3214364/nant-get-task-permission-denied)

# c - 宏函数指针问题

> ID：11440663
> 
> 赞同：0
> 
> 时间：2012-07-11T20:10:26.513
> 
> 标签：c, macros, c-preprocessor

我一直致力于用**C 语言**编写一些预处理器宏来帮助我完成工作。

```
 # define    printSTRING(s) printf( # s " has the value");   \
                        for( ; *s != '\0'; s++) \
                        printf(*s); \
                        getch(); 
```

我收到错误消息：`C2105: '++' needs l-value`

当我打电话时在`printSTRING(Payload);`哪里`Payload``char Payload[] = "wjdoidnjdeioejneiodejndo";`

我认为它没有`Payload`被视为 char 指针，但我不知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T20:12:39.870

这不是你会得到的唯一错误。您可能想`putchar()`改用它，它采用单个`char`参数（`printf()`采用`char *`格式字符串，您没有提供它）。或者，您可以使用`puts()`which 打印整个字符串（在这种情况下无需自己编写循环）。

您收到错误的原因是*数组*`Payload`的名称，而不是指针。您不能“增加”数组，尽管您可以使用数组的名称，就好像它是指向数组开头的指针一样。

 ** * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-11T20:14:13.853

1.  你在滥用 printf - 这就是为什么 '%s' 格式说明符在这里。
2.  'Payload' 没有声明为 char**指针**，而是声明为 char**数组**——您不能修改数组的地址。简单使用

    ```
    #define printSTRING(s) printf("%s has the value %s", #s, s) 
    ```

反而。*

# iphone - UiImagePickerController takePicture 问题

> ID：11440665
> 
> 赞同：2
> 
> 时间：2012-07-11T20:10:29.853
> 
> 标签：iphone, ios, ios5, uiimagepickercontroller

我在创建自己的自定义“拍照”按钮时遇到了一些问题。基本上，当我删除默认控件时，相机不再执行快门动画或进行编辑过程，而是直接进入委托方法。

所以，这里有一些代码。起初我使用默认布局，如下所示：

（顺便说一句，我已经删除了用于确定硬件可用性的 if 语句——它们无关紧要。）

```
UIImagePickerController *picker = [[UIImagePickerController alloc] init];

picker.delegate = self;
picker.allowsEditing = YES;

picker.sourceType = UIImagePickerControllerSourceTypeCamera;
picker.showsCameraControls = YES;
picker.cameraCaptureMode = UIImagePickerControllerCameraCaptureModePhoto;     

[self presentModalViewController:picker animated:YES]; 
```

使用此代码，当我按下默认的“拍照”按钮时，会触发快门动画，并显示“移动和缩放”视图。按“选择”后，代表被调用，我可以通过`info`.

所以这是我的新初始化代码，带有一个自定义的“拍照”按钮，没有别的；顺便说一句，我正在我的 ViewController 的 viewDidAppear 方法中初始化这个 UIImagePickerController

```
UIImagePickerController *picker = [[UIImagePickerController alloc] init];

picker.delegate = self;
picker.allowsEditing = YES;

UIButton *shoot = [[UIButton alloc] initWithFrame:CGRectMake(110, 420, 100, 40)];
[shoot setTitle:@"Shoot" forState:UIControlStateNormal];
[shoot.titleLabel setTextColor:[UIColor whiteColor]];
[shoot addTarget:picker action:@selector(takePicture) forControlEvents:UIControlEventTouchUpInside];

picker.sourceType = UIImagePickerControllerSourceTypeCamera;
[picker.cameraOverlayView addSubview:shoot];
picker.showsCameraControls = NO;

picker.cameraCaptureMode = UIImagePickerControllerCameraCaptureModePhoto;

[self presentModalViewController:picker animated:YES]; 
```

在这个例子中，当我点击我的自定义按钮时，没有动画被触发，没有编辑屏幕显示，代理被立即调用。

有趣的是，如果我只是将`showsCameraControls`属性更改`YES`为上面示例中的属性，我的自定义按钮的行为方式与我的第一个示例中默认按钮的行为方式完全相同。

对此我感到很困惑，我需要做些什么`didFinishPickingMediaWithInfo`来调用图像编辑器，还是我只是在初始化中遗漏了一些东西？

我正在使用 Xcode 4.3 和 iOS 5.1（该应用针对 5.0）

非常感谢任何帮助；干杯!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T21:24:45.230

显然，“移动和裁剪”功能是默认相机控件的一部分

当您使用照片库作为来源时，唯一的选项是默认选项，因此它始终有效。

最后，我使用一个简单的滚动视图和一些覆盖视图来表示裁剪框，编写了自己的“移动和裁剪”视图。

不太难，只需要根据 UIScrollView 的缩放因子和 contentoffset 做一些数学运算。

# asp.net-mvc - 为什么我会收到缺少类型映射配置错误？

> ID：11440670
> 
> 赞同：1
> 
> 时间：2012-07-11T20:10:43.363
> 
> 标签：asp.net-mvc, automapper

我修改了这个 ContosoUniversity 教程： [http ://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/creating-an-entity-framework-data-model-for-an- asp-net-mvc-application](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/creating-an-entity-framework-data-model-for-an-asp-net-mvc-application)现在我正在尝试使用 AutoMapper 将对象映射到对象。

这是我的模型视图：

```
public class InstructorIndexData
{
    public IEnumerable<Instructor> Instructors { get; set; }
    public IEnumerable<Course> Courses { get; set; }
    public IEnumerable<Enrollment> Enrollments { get; set; }
    public IEnumerable<Student> Students { get; set; }
    public IEnumerable<Assignment> Assignments { get; set; }
} 
```

这是视图

```
@model SchoolIn.ViewModels.InstructorIndexData

@using SchoolIn.Models
@{ViewBag.Title = "Index";}

@using (Html.BeginForm("ClassAttendance", "Attendance", 
    new { currentDate = day, id = @ViewBag.ID, 
        teacher = HttpContext.Current.Session["sTeacher"], 
        courseID = HttpContext.Current.Session["sCourseID"] }, FormMethod.Post))

{
    var wekdys = new Enrollment(); @*had too create this to have access to the dropdownList*@
    @Html.DropDownList("weekDays", wekdys.WeekDays.Select(s => 
        new SelectListItem { Text = s.ToString(), Value = s.ToString() }))

    @Html.ValidationSummary(true)
    <p></p>
    <Input Type ="submit" Value="ClassAttendance"/>
    <p>@Html.ActionLink("Create Todays Attendance", "Create")</p>
    <p>@Html.ActionLink("Create New", "Create")</p>
    <h3>Students Enrolled in @ViewBag.teacherName's @ViewBag.courseTitle Course</h3>  
    <table>  
        <tr>  
            <th>View Student Report</th> 
            <th>First Name</th>  
            <th>Last Name</th> 
            <th>Grade</th>  
            <th>Attendance Code</th>  
            <th>Class Day</th> 
        </tr>  
        @foreach (var item in Model.Enrollments)
        {  
        <tr>  
            <td>  
                @Html.ActionLink("Report", "UpdateAttendance", "Attendance", 
                    new { 
                        grade=item.Grade, 
                        studentFirstName = item.Student.FirstMidName, 
                        studentLastName = item.Student.LastName, 
                        courseTitle = item.Course.Title, 
                        teacher = @ViewBag.teacherName }, null)
            </td> 
            <td>@Html.EditorFor(modelItem=>item.Student.FirstMidName)</td>  
            <td>@Html.EditorFor(modelItem=>item.Student.LastName)</td> 
            <td>@Html.EditorFor(modelItem =>item.Grade)</td>
            <td>@Html.DropDownList("attendanceCode", item.attendanceCode.Select(s => 
                 new SelectListItem { Text = s.ToString(), Value = s.ToString() }))
                @*Html.EditorFor(modelItem =>item.attendanceCode)*/*@
            </td>  
            <td>@Html.EditorFor(modelItem=>item.classDays)</td>
        </tr>  
        }  
    </table>  
} 
```

这是我的控制器中遇到问题的方法。我正在尝试使用这个例子：[http ://chriscurrie.co.uk/blog/2011/09/coding/net/mvc/use-automapper-to-map-viewmodels-to-entities-mvc3-and-razor /](http://chriscurrie.co.uk/blog/2011/09/coding/net/mvc/use-automapper-to-map-viewmodels-to-entities-mvc3-and-razor/)

```
public class AttendanceController : Controller
{
    private SchoolInDB db = new SchoolInDB();
} 
```

代码在这里...</p>

```
[HttpPost]
public ActionResult ClassAttendance(InstructorIndexData viewModel)
{

    if (ModelState.IsValid)
    {

        AutoMapper.Mapper.CreateMap<AttendanceData, Assignment>();
        AutoMapper.Mapper.CreateMap<AttendanceData, Enrollment>();
        AutoMapper.Mapper.CreateMap<AttendanceData, Student>();
        AutoMapper.Mapper.CreateMap<AttendanceData, Instructor>();

        Instructor newInstructor = new Instructor();
        Student newStudent = new Student();
        Assignment newAssignment = new Assignment();
        Enrollment newEnrollment = new Enrollment();

        AutoMapper.Mapper.Map(viewModel, newInstructor );
        AutoMapper.Mapper.Map(viewModel, newStudent);
        AutoMapper.Mapper.Map(viewModel, newEnrollment);
        AutoMapper.Mapper.Map(viewModel, newAssignment);

        db.Assignments.AddObject(newAssignment).;

        db.SaveChanges();
        return RedirectToAction("Index");
    }

    return View();
} 
```

当我调试我的代码在这里停止'AutoMapper.Mapper.Map(viewModel, newInstructor);' 出现此错误：缺少类型映射配置或不支持的映射。

映射类型：InstructorIndexData -> Instructor SchoolIn.ViewModels.InstructorIndexData -> SchoolIn.Models.Instructor

目的地路径：导师

源值：SchoolIn.ViewModels.InstructorIndexData

我还注意到，在我的 ActionResult(InstructorIndexData viewModel) 中，viewModel 具有所有空值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T21:18:40.680

根据我的理解，viewModel 的类型是 InstructorIndexData。如果是这样，您需要添加配置：

```
 AutoMapper.Mapper.CreateMap<InstructorIndexData, Assignment>();
    AutoMapper.Mapper.CreateMap<InstructorIndexData, Enrollment>();
    AutoMapper.Mapper.CreateMap<InstructorIndexData, Student>();
    AutoMapper.Mapper.CreateMap<InstructorIndexData, Instructor>(); 
```

# c# - 我需要将此 SQL 查询转换为 LINQ，以便我可以在我的项目中使用它

> ID：11440671
> 
> 赞同：-1
> 
> 时间：2012-07-11T20:10:49.197
> 
> 标签：c#, linq, entity-framework, linq-to-entities, group-by

stackoverflow 的某个人最近帮助我形成了这个 sql 查询来返回我正在寻找的数据。

我需要将其转换为 LINQ 语句，以便可以在我的 ASP.NET MVC3 C# 项目中使用它。

谢谢！

```
SELECT TOP 4 a.GalleryID, a.GalleryTitle, a.GalleryDate, MAX(b.MediaThumb) AS MediaThumb
FROM Galleries a
INNER JOIN Media b
ON a.GalleryID = b.GalleryID
GROUP BY a.GalleryID, a.GalleryTitle, a.GalleryDate
ORDER BY a.GalleryID desc 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T20:16:36.233

编辑：这是根据给定的 T-Sql 分组的版本：

```
var Results = (from g in DB.Galleries
               join m in DB.Media
               on g.GalleryID equals m.GalleryID
               group m by new { g.GalleryID, g.GalleryTitle, g.GalleryDate } into grp
               orderby grp.Key.GalleryID descending
               select new LatestGalleries
               {
                   GalleryID = grp.Key.GalleryID,
                   GalleryTitle = grp.Key.GalleryTitle,
                   GalleryDate = grp.Key.GalleryDate,
                   MediaThumb = grp.FirstOrDefault().MediaThumb
               }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T20:17:22.637

像这样的东西应该工作：

```
(
  from a in galleries
  join b in media on b.GalleryID equals a.GalleryID
  group by new {a.GalleryID, a.GalleryTitle, a.GalleryDate} into grouping
  order by grouping.Key.GalleryID
  select new {grouping.Key.GalleryID, grouping.Key.GalleryTitle, grouping.Key.GalleryDate, grouping.Max(x=>x.MediaThumb)}
).Take(4) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T20:21:58.720

您需要先在 Media 上配置 EF[导航属性](http://msdn.microsoft.com/en-us/library/bb738520.aspx)，然后：

```
var q = (from a in db.Galleries
        group a by new { a.GalleryID, a.GalleryTitle, a.GalleryDate } into g
        orderby g.Key.GalleryID descending
        select new
        {
            GalleryID = g.Key.GalleryID,
            GalleryTitle = g.Key.GalleryTitle,
            GalleryDate = g.Key.GalleryDate,
            MediaThumb = g.Max(a => a.Media) // Gallery.Media is a navigation property
        }).Take(4); 
```

# android - CORS + Android Webview，在设备上不起作用（但在模拟器上）

> ID：11440677
> 
> 赞同：4
> 
> 时间：2012-07-11T20:11:14.620
> 
> 标签：android, jquery-mobile, cordova, android-emulator, cors

我有一个有效的 HelloWorld phonegap 程序，其中安装了 jquery mobile，如下所述：http: [//jquerymobile.com/demos/1.1.0/docs/about/getting-started.html](http://jquerymobile.com/demos/1.1.0/docs/about/getting-started.html)。我为此添加了一些 javascript 来试验跨域资源共享：

```
<script>
$(document).bind("pageinit", function() {
    $.support.cors = true;
    $.mobile.allowCrossDomainPages = true;
    $.mobile.changePage("http://jquery.com");
});
</script> 
```

这在模拟器（2.3）上效果很好，jquery.com 是通过 jquery 移动演示加载的。但是，在实际的 2.3 Android 设备（运行 Cyanogen、Galaxy SII、Galaxy Player 的 T-mobile G2）上，changePage() 调用什么也不做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T18:33:36.557

`$.mobile.changePage()`在函数内调用`pageinit`函数听起来是个坏主意，因为这会导致无限循环。该`$.mobile.changePage()`函数初始化指定为`target`参数的页面，因此每次调用`$.mobile.changePage()`时也会触发一个`pageinit`事件。

您可能希望在初始化 jQuery Mobile 之前绑定到`mobileinit`事件以覆盖`$.support.cors`变量：

```
<script src="jquery.js"></script>
<script>
$(document).bind("mobileinit", function() {
    $.support.cors = true;
    $.mobile.allowCrossDomainPages = true;
    $.mobile.changePage("http://jquery.com");
});
</script>
<script src="jquery-mobile.js"></script> 
```

相关文档：

*   [http://jquerymobile.com/demos/1.1.1/docs/api/globalconfig.html](http://jquerymobile.com/demos/1.1.1/docs/api/globalconfig.html)
*   [http://jquerymobile.com/demos/1.1.1/docs/api/events.html](http://jquerymobile.com/demos/1.1.1/docs/api/events.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T23:02:45.200

尝试`mobileinit`代替`pageinit`. 因为您绑定的事件是普通的 jQuery，而对于 jQuery mobile，初始化事件是 mobileinit。

`The $.mobile.allowCrossDomainPages option must be set before any cross-domain request is made so we recommend wrapping this in a mobileinit handler`.

# java - Java (spymemcached) 和 PHP (memcached)

> ID：11440681
> 
> 赞同：0
> 
> 时间：2012-07-11T20:11:37.397
> 
> 标签：java, php, memcached

我正在尝试构建一个 Java 应用程序，该应用程序将在 Memcached 中设置数据，并有一个 PHP 脚本来稍后在此过程中获取相同的数据。到目前为止，我还没有找到获得 100% 命中率的方法。为了确保 SET 没有任何问题，我手动确认数据已添加到 Memcached。基于[PHP 和 Java 中的 Consistent hashing](http://www.serverphorums.com/read.php?9,192006)，我尝试使用 KETAMA（见下面的代码）但没有成功。

配置：
- Spymemcached (2.8.1)
- PHP (5.3.10)
- PECL/memcached (2.0.1)
- libmemcached (1.0.4)

在 Java 和 PHP 之间共享数据的最佳策略是什么？有没有我没有正确使用的配置？我应该使用另一个库吗？

谢谢您的帮助！

* * *

```
MemcachedClient client = new MemcachedClient
(ConnectionFactory) new ConnectionFactoryBuilder ()
.setProtocol (Protocol.TEXT)
.setHashAlg (DefaultHashAlgorithm.KETAMA_HASH)
.setFailureMode (FailureMode.Redistribute)
.setLocatorType (Locator.CONSISTENT).build(),
AddrUtil.getAddresses("192.168.0.101:11211 192.168.0.102:11211")); 
```

* * *

```
$memcached = new Memcached();
$memcached->addserver('192.168.0.101', 11211);
$memcached->addserver('192.168.0.102', 11211);
$memcached->setOption(Memcached::OPT_DISTRIBUTION ,Memcached::DISTRIBUTION_CONSISTENT);
$memcached->setOption(Memcached::OPT_LIBKETAMA_COMPATIBLE, true); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T08:32:46.043

在 spymemcached 中，有一个KETAMA 散列算法的[问题。](http://code.google.com/p/spymemcached/issues/detail?id=118&can=1&colspec=stars%20id%20Milestone%20Priority%20Status%20Summary)它指的是 2.5rc1 版本，但似乎仍然会发生这种情况。

尝试另一个 java memcached 客户端：[xmemcached](https://code.google.com/p/xmemcached/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:17:46.930

对于那些正在考虑做同样事情的人来说，有一个更好的策略。Twitter 提供了[twemproxy](https://github.com/twitter/twemproxy)（胡桃夹子），这是一个快速、轻量级的 memcached 代理。使用它，我不必担心 Java 和 PHP 是否使用相同的散列算法，代理会处理这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-12T02:41:38.797

我也遇到了这个问题。经过几个小时的调查，我发现这是因为`flags`PHP 和 Java memecached 客户端中定义的不同。

我使用[xmemcached](https://code.google.com/p/xmemcached/)使其工作。

首先，创建一个新`StringTranscoder`的来解码响应，忽略标志定义并将它们全部转换为`String`

```
/**
 *
 * Php memcached extension uses flags=0 or 1 for all SET values, the default StringTranscoder in Xmemcached uses 0 for string
 *
 */
class PhpStringTranscoder extends PrimitiveTypeTranscoder<String> {

    private String charset = BaseSerializingTranscoder.DEFAULT_CHARSET;

    public PhpStringTranscoder(String charset) {
        this.charset = charset;
    }

    public PhpStringTranscoder() {
        this(BaseSerializingTranscoder.DEFAULT_CHARSET);
    }

    public String decode(CachedData d) {
            String rv = null;
            try {
                if (d.getData() != null) {
                    rv = new String(d.getData(), this.charset);
                }
            } catch (UnsupportedEncodingException e) {
                throw new RuntimeException(e);
            }
            return rv;
    }

    public static final int STRING_FLAG = 1;

    public CachedData encode(String o) {
        byte[] b;
        try {
            b = o.getBytes(this.charset);
        } catch (UnsupportedEncodingException e) {
            throw new RuntimeException(e);
        }
        return new CachedData(STRING_FLAG, b);
    }

} 
```

最后，使用这个 new`PhpStringTranscoder`创建会话：

```
 MemcachedClientBuilder builder = new XMemcachedClientBuilder(String.format("%s:%s",address,portNum));
    builder.setCommandFactory(new TextCommandFactory());
    builder.setTranscoder(new PhpStringTranscoder());
    builder.setSessionLocator(new LibmemcachedMemcachedSessionLocator(100, HashAlgorithm.ONE_AT_A_TIME));
    MemcachedClient memcachedClient = builder.build(); 
```

`memcachedClient`是您应该使用的。

# git - Heroku 密钥不被接受

> ID：11440683
> 
> 赞同：0
> 
> 时间：2012-07-11T20:11:52.513
> 
> 标签：git, heroku, ssh

我正在尝试推送到 heroku，但出现权限被拒绝错误。我已经关注了这些位置的文章：

[https://devcenter.heroku.com/articles/keys](https://devcenter.heroku.com/articles/keys)

[部署 heroku 代码时权限被拒绝（公钥）。致命：远端意外挂断](https://stackoverflow.com/questions/4269922/permission-denied-publickey-when-deploying-heroku-code-fatal-the-remote-end)

但这些都行不通。

这是 shell 的输出，显示我正在尝试做的事情：

```
[root]# heroku keys
  You have no keys.
[root]# heroku login
  Enter your Heroku credentials.
  Email: myemail@domain.com
  Password (typing will be hidden): 
  Found the following SSH public keys:
  1) github.pub
  2) heroku.pub
  Which would you like to use with your Heroku account? 2
  Uploading SSH public key /root/.ssh/heroku.pub... done
  Authentication successful.
[root]# git init
  Reinitialized existing Git repository in /.git/
[root]# git push heroku master
  Permission denied (publickey).
  fatal: The remote end hung up unexpectedly 
```

编辑：这是针对 CentOS 服务器的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:52:38.597

我想通了..我想您实际上需要使用 id_rsa 而不是自定义的..我一运行`ssh-keygen -t rsa -f id_rsa`它就起作用了。去搞清楚。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T08:54:07.790

对于未来的访问者，我添加了另一个答案（在上面的@redhotvengeance 评论之后），它不需要您使用 id_rsa 作为您的 heroku 密钥。以下一系列命令启动 ssh-agent 并添加您的 heroku 密钥，以便推送成功：

```
ssh-agent
ssh-add ~/.ssh/my_heroku_key
# now it should work
git push heroku master 
```

它运行良好。

# c# - 在流文档的新创建段落上设置插入符号位置

> ID：11440685
> 
> 赞同：3
> 
> 时间：2012-07-11T20:11:56.323
> 
> 标签：c#, wpf, richtextbox

我有一个动态流文档显示在一个`RichTextBox`代表两个人之间的对话中。

我正在尝试向我的软件添加一个功能，该功能将在插入符号当前处于活动状态的任何现有段落之后添加一个段落（通过使用 tab 键）。我能够实现插入，但仍然存在一个错误，我无法将插入符号位置设置为新创建段落的开头。我试图专注于新创建的段落，但没有运气。

这是 tab 按下事件的一些测试代码，它在正确的位置添加新段落。`ConversationXContent`是一个`FlowDocument`。

```
private void RichTextBox_KeyDown(object sender, KeyEventArgs e)
{
    if(e != null && e.Key == Key.Tab)
    {
        Paragraph p = new Paragraph();
        p.Tag = "NewParagraph";
        p.SetResourceReference(Paragraph.StyleProperty, "CharacterViewStyle");
        p.Inlines.Add("NEW PARAGRAPH");
        ConversationXContent.Blocks.InsertAfter(ConversationX.CaretPosition.Paragraph, p);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T15:32:40.617

经过调查和一些试验和错误，我能够使用以下代码解决我的最后一个错误，该代码将鼠标插入符号置于新创建段落的开头。希望这可以帮助其他人

```
TextPointer moveTo = ConversationX
                         .CaretPosition
                         .GetNextInsertionPosition(LogicalDirection.Forward);

if (moveTo != null)    
{   
    myRichTextBox.CaretPosition = moveTo;    
} 
```

# mongodb - 在 Haml 中迭代嵌入的文档

> ID：11440686
> 
> 赞同：0
> 
> 时间：2012-07-11T20:11:56.750
> 
> 标签：mongodb, sinatra, haml

我在 Mongodb 文档中有一个嵌入式文档。Mongodb 文档如下所示：

```
[_id] => home
[url] => /
[type] => homepage
[people] => Array (
    [0] => Array (
        [name] => John Smith
        [rewrite] => john-smith
    )
    [1] => Array (
        [name] => John Q. Public
        [rewrite] => john-q-public
    )
) 
```

我正在尝试遍历`people`嵌入的文档。在我的 app.rb 中，我将对象传递给 haml，如下所示：

```
DB = Mongo::Connection.new.db("website", :pool_size => 5, :timeout => 5)                                                              
pages = DB.collection('pages')                                                                                                      

get '/' do                                                                                                                          
  home = pages.find_one( :type => "homepage" )                                                                                                                                                                     
  haml :index, :attr_wrapper => '"', :locals => {:items => home}                            
end 
```

在我的 index.haml 中，我可以像这样遍历整个文档：

```
-items.each do |item|
  %h2= item 
```

但是我怎样才能迭代`people`嵌入的文档呢？我想做这样的事情：

```
-items.people.each do |person|
  %h2= person.name, person.rewrite 
```

另外，如果我使用了不正确的术语，请纠正我；我是 Mongo、Haml、Sinatra 等的新手。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T22:07:41.813

也许我应该多学习一点 Ruby 语法......这是我能够迭代到我的`people`嵌入式文档的方式：

```
-items["people"].each do |person|
  %h2= person["name"], person["rewrite"] 
```

# java - 无法为 XML 模式命名空间问题找到 Spring NamespaceHandler

> ID：11440687
> 
> 赞同：1
> 
> 时间：2012-07-11T20:11:57.630
> 
> 标签：java, spring, xsd, gate

我遇到了“无法找到 XML 模式命名空间的 Spring NamespaceHandler”这个奇怪的问题。我在我的 spring 应用程序上下文中引用 GATE 命名空间。它是一个可执行 jar，其中一个 java 类实例化了 spring 应用程序上下文。当我通过 eclipse 在我的本地机器上测试它时它工作正常。但是，当我尝试将它作为带有 java 主类的可执行 jar 运行时，就会出现问题。

这是例外。

```
 org.springframework.beans.factory.parsing.BeanDefinitionParsingException: Configuration problem: Unable to locate Spring NamespaceHandler for XML schema namespace [http://gate.ac.uk/ns/spring]
Offending resource: class path resource [applicationContext.xml] 
```

如您所见，它在抱怨门命名空间。

这是应用程序上下文条目。

```
 <?xml version="1.0" encoding="utf-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xmlns:util="http://www.springframework.org/schema/util" xmlns:tx="http://www.springframework.org/schema/tx"
    xmlns:gate="http://gate.ac.uk/ns/spring"
    xsi:schemaLocation="
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.0.xsd 
       http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.0.xsd
       http://gate.ac.uk/ns/spring http://gate.ac.uk/ns/spring.xsd"> 
```

架构是可访问的并且是有效的。

可执行 jar 包含与门相关的 jar 文件。这是门的 pom 文件条目

```
 <dependency>
            <groupId>gate</groupId>
            <artifactId>gate</artifactId>
            <version>5.1</version>
        </dependency>
        <dependency>
            <groupId>gate</groupId>
            <artifactId>gate-asm</artifactId>
            <version>1.0</version>
        </dependency>
        <dependency>
            <groupId>gate</groupId>
            <artifactId>gate-compiler-jdt</artifactId>
            <version>1.0</version>
        </dependency> 
```

这是java代码片段

```
 try{
    AbstractApplicationContext ctx = new ClassPathXmlApplicationContext("/applicationContext.xml");
        this.processor = (TestProcessor) ctx.getBean("testProcessor");
   }catch (Exception ex) {
    ex.printStackTrace();
   } 
```

这是 Gate 文档参考。

[http://gate.ac.uk/releases/gate-5.0-beta1-build3048-ALL/doc/tao/splitch3.html#x5-900003.27](http://gate.ac.uk/releases/gate-5.0-beta1-build3048-ALL/doc/tao/splitch3.html#x5-900003.27)

不知道出了什么问题，任何指针将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T02:32:34.850

门自定义命名空间的命名空间处理程序将在此应用程序提供的 jar 文件（gate.jar？）中指定，如果您查看 jar 文件，您应该看到一个 META-INF/spring.handlers 文件，其中包含以下类型：

```
http://gate.ac.uk/ns/spring=*NamespaceHandler 
```

这是您的程序在启动时无法找到的处理程序。您的类路径可能在主程序中关闭，或者如果您使用某些东西将 jar 组合成一个 jar（uber jar），那么 META-INF/spring.handlers 文件在不同 jar 文件中的合并可能会搞砸，那里但是，如果您创建了一个 uber jar，则可以使用很好的解决方法。

# java - 如何最初没有选择 actionbarsherlock 中的任何选项卡？

> ID：11440691
> 
> 赞同：0
> 
> 时间：2012-07-11T20:12:20.223
> 
> 标签：java, android, actionbarsherlock

我已经在我的项目中成功实现了actionsherlock。所以这是我的代码：

```
public class ActiontabActivity extends SherlockFragmentActivity   {

    ActionMode mMode;

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setTheme(R.style.Theme_Sherlock_Light_DarkActionBar);
        setContentView(R.layout.main);
         ActionBar bar = getSupportActionBar();
            bar.setNavigationMode(ActionBar.NAVIGATION_MODE_STANDARD);
            bar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);

            bar.setDisplayOptions(0, ActionBar.DISPLAY_SHOW_TITLE);

            bar.setDisplayShowHomeEnabled(false);

            bar.setDisplayShowTitleEnabled(false);
            bar.setTitle("Currency Exchange");
            bar.addTab(bar
                    .newTab()
                    .setText("Converter")
                    .setTabListener(
                            new TabListener<Fragment>(this, "Converter",
                                    ConverterTab.class, null)));

            bar.addTab(bar
                    .newTab()
                    .setText("Favorites")
                    .setTabListener(
                            new TabListener1<Fragment>(this, "Favorites",
                                    FavoritesTab.class, null)));
            if (savedInstanceState != null) {
                bar.setSelectedNavigationItem(savedInstanceState.getInt("tab", 0));
            }

    }

    @Override
    protected void onSaveInstanceState(Bundle outState) {
        super.onSaveInstanceState(outState);
        outState.putInt("tab", getSupportActionBar()
                .getSelectedNavigationIndex());
    }

    public class TabListener<T extends Fragment> implements ActionBar.TabListener {
        private final FragmentActivity mActivity;
        private final String mTag;
        private final Class<ConverterTab> mClass;
        private final Bundle mArgs;
        private Fragment mFragment;

        public TabListener(FragmentActivity activity, String tag, Class<ConverterTab> clz, Bundle args) {
            mActivity = activity;
            mTag = tag;
            mClass = clz;
            mArgs = args;
            FragmentTransaction ft = mActivity.getSupportFragmentManager().beginTransaction();

            // Check to see if we already have a fragment for this tab, probably
            // from a previously saved state.  If so, deactivate it, because our
            // initial state is that a tab isn't shown.
            mFragment = mActivity.getSupportFragmentManager().findFragmentByTag(mTag);
            if (mFragment != null && !mFragment.isDetached()) {
                ft.detach(mFragment);
            }
        }

        @Override
        public void onTabSelected(Tab tab, FragmentTransaction ft) {
            // TODO Auto-generated method stub
             ft = mActivity.getSupportFragmentManager()
                        .beginTransaction();

                if (mFragment == null) {
                    mFragment = Fragment.instantiate(mActivity, mClass.getName(),
                            mArgs);
                    ft.add(android.R.id.content, mFragment, mTag);
                    ft.commit();
                } else {
                    ft.attach(mFragment);
                    ft.commit();
                }

        }

        @Override
        public void onTabUnselected(Tab tab, FragmentTransaction ft) {
            // TODO Auto-generated method stub
               if (mFragment != null) {
                    //this segment removes the back history of everything in the tab you are leaving so when you click on the tab again you go back to a fresh start
                    FragmentManager man = mFragment.getFragmentManager();
                    if(man.getBackStackEntryCount()>0) //this check is required to prevent null point exceptions when clicking off of a tab with no history
                        man.popBackStack(man.getBackStackEntryAt(0).getName(), FragmentManager.POP_BACK_STACK_INCLUSIVE); //this pops the stack back to index 0 so you can then detach and then later attach your initial fragment
                    //also it should be noted that if you do popbackstackimmediate here instead of just popbackstack you will see a flash as the gui changes back to the first fragment when the code executes
                    //end
                    ft.detach(mFragment);
                }

        }

        @Override
        public void onTabReselected(Tab tab, FragmentTransaction ft) {
            // TODO Auto-generated method stub

        }

    }
    public class TabListener1<T extends Fragment> implements ActionBar.TabListener {
        private final FragmentActivity mActivity;
        private final String mTag;
        private final Class<FavoritesTab> mClass;
        private final Bundle mArgs;
        private Fragment mFragment;

        public TabListener1(FragmentActivity activity, String tag, Class<FavoritesTab> clz, Bundle args) {
            mActivity = activity;
            mTag = tag;
            mClass = clz;
            mArgs = args;
            FragmentTransaction ft = mActivity.getSupportFragmentManager().beginTransaction();

            // Check to see if we already have a fragment for this tab, probably
            // from a previously saved state.  If so, deactivate it, because our
            // initial state is that a tab isn't shown.
            mFragment = mActivity.getSupportFragmentManager().findFragmentByTag(mTag);
            if (mFragment != null && !mFragment.isDetached()) {
                ft.detach(mFragment);
            }
        }

        @Override
        public void onTabSelected(Tab tab, FragmentTransaction ft) {
            // TODO Auto-generated method stub
             ft = mActivity.getSupportFragmentManager()
                        .beginTransaction();

                if (mFragment == null) {
                    mFragment = Fragment.instantiate(mActivity, mClass.getName(),
                            mArgs);
                    ft.add(android.R.id.content, mFragment, mTag);
                    ft.commit();
                } else {
                    ft.attach(mFragment);
                    ft.commit();
                }

        }

        @Override
        public void onTabUnselected(Tab tab, FragmentTransaction ft) {
            // TODO Auto-generated method stub
             if (mFragment != null) {
                    //this segment removes the back history of everything in the tab you are leaving so when you click on the tab again you go back to a fresh start
                    FragmentManager man = mFragment.getFragmentManager();
                    if(man.getBackStackEntryCount()>0) //this check is required to prevent null point exceptions when clicking off of a tab with no history
                        man.popBackStack(man.getBackStackEntryAt(0).getName(), FragmentManager.POP_BACK_STACK_INCLUSIVE); //this pops the stack back to index 0 so you can then detach and then later attach your initial fragment
                    //also it should be noted that if you do popbackstackimmediate here instead of just popbackstack you will see a flash as the gui changes back to the first fragment when the code executes
                    //end
                    ft.detach(mFragment);
                }

        }

        @Override
        public void onTabReselected(Tab tab, FragmentTransaction ft) {
            // TODO Auto-generated method stub

        }

    }
} 
```

我在转换器选项卡中放了一个按钮，在收藏夹选项卡中放了一个复选框。但是现在我想当我运行我的应用程序时，它最初没有选择任何选项卡。只显示主屏幕，当我按下任何选项卡时，它会显示它的内容。因为最初我想在未选择选项卡时显示其他内容。请告诉我我该怎么做？请告诉我如何显示最初的主屏幕，然后当我选择任何选项卡时它会显示其内容。我附上了我的图片项目：

![在此处输入图像描述](../Images/32be77633a3a10de6f515126f0d381b2.png) ![在此处输入图像描述](../Images/64ec559e3dbda079f2b53823991afdd9.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-22T09:30:10.047

您可以通过以下方式执行此操作：

```
bar.addTab(yourTab,false); 
```

像这样，选项卡仍然是可视选择的，但侦听器中 onTabSelected 方法中的操作未执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T20:31:55.330

不幸的是，当您创建标签时，Android 应该将任何标签标记为选中。但我有几个想法。

首先。您可以替换内容。只需制作一个布尔标志并在选择选项卡时更改其值。因此，当标志为假时（例如），您可以在主屏幕上显示您的内容。

或者第二个想法。只需使用选项卡和您的主屏幕内容进行另一个主要活动。And when any tab is selected just run your activity with real tabs.

对不起我的英语。有些事情可能不清楚。所以问我，我会尝试更清楚地解释它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-10T08:34:24.523

像这样尝试...
**actionbar.addTab(converterTab,0,false);
actionbar.addTab(favouriteTab,1,false);**

# php - 如何找出与 PHP 版本兼容的 memcache 版本？

> ID：11440692
> 
> 赞同：0
> 
> 时间：2012-07-11T20:12:28.617
> 
> 标签：php, memcached

过去，不同的 memcache 版本总是要反复试验才能看到哪个有效。

是否有哪些 memcache 版本与哪些 PHP 版本兼容的列表？

目前我正在同时运行： - PHP 5.2.17 - PHP 5.3.6

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:14:57.943

有非常基本的列表，但据我所知，当我遇到与您相同的问题时，没有像您正在寻找的任何详细列表。

您将不得不继续反复试验，直到有人不幸提供更详细的列表。

# html - 使用类样式作为内联样式？

> ID：11440693
> 
> 赞同：1
> 
> 时间：2012-07-11T20:12:34.633
> 
> 标签：html, css, class, inline

所以一个非常基本的问题：使用像内联样式这样的类是否“可以”？

基本上我所做的是建立一个“引导程序”；但不是按元素这样做，而是按属性完成。所以基本上，CSS 只不过是一组预定义的样式。

例如：

```
.margin-left-1 {margin-left:1px;}
.margin-right-1 {margin-right:1px;}
.bg-blue {background-color:blue;}
.padding-5 {padding: 5px;}
.radius-10 {border-radius:10px;}
.width-10 {width:10%;}
.width-10px {width:10px;}
.font-arial {font-family: 'Arial';} 
```

等等

这使得您可以快速轻松地在 HTML 中构建网站及其样式。但是，这是一种不好的做法吗？我是否应该简单地为边框半径、颜色、按钮等设置样式，并在类/id 中定义填充、边距等（一般框布局属性）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T20:25:44.893

它与你应该做的完全相反。CSS 选择器名称不应该代表选择器内容，而是应该描述的对象的性质（样式）。换句话说，选择器名称应该尽可能抽象，因为它们在多大程度上依赖于选择器内容本身。

如果您决定使用您的系统，这是一个实际问题。如果您决定更改类的`margin-right`属性值`.margin-right-1`怎么办？按照您的逻辑，您现在必须将其名称更改为让我们说`margin-right-10`，不仅如此，您还必须更新完整的 HTML 代码以替换对`margin-right-1`with`margin-right-10`类的引用。

但是，如果您定义了一个名为的类选择器，可以说，`.wrapper`您可以稍后重新定义它的属性，但是您喜欢。

不仅如此，如果你的选择器也有一个`margin-left`属性，你会怎么做？为了给那个特定的选择器命名，哪一个会变得占主导地位？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T23:16:23.053

想象一下，您随后决定为您的移动网站使用相同的 HTML，但使用不同的样式表。假设您有一个设置为 800 像素宽的文章容器。而不是拥有`.article {width: 800px}`你将拥有`.width-800 {width: 400px}`. 在尝试编写和调试新布局时，您会有多困惑？

此外，也许您不希望所有 800 像素宽的元素现在都变为 400 像素，而只是文章。因此，使用您的方法来定位您的文章容器，您必须将它使用的所有不同类链接在一起，例如：

```
.float-left.border-solid-black.padding-10.bg-blue.font-arial.width-800 {
    width: 400px;
} 
```

这个更长的选择器意味着：

*   它在 CSS 文件中占用更多空间（文件重量），因此页面加载速度较慢
*   通过 XPath 或 JavaScript 解析节点更慢
*   更改更*脆弱*，因为您不知道是否有任何其他 div 可能会受到影响（如果它们碰巧也应用了相同的类）
*   调试和隔离错误修复要困难得多（不会错误地对页面上的其他区域产生负面影响）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T20:19:05.827

我建议你使用[LESS](http://lesscss.org/)。

然后，您可以创建所谓的“mixins”并在您的样式中使用它们。例如

```
.rounded-corners (@radius: 5px) {
  border-radius: @radius;
  -webkit-border-radius: @radius;
  -moz-border-radius: @radius;
}

#header {
  .rounded-corners;
}
#footer {
  .rounded-corners(10px);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-11T20:23:12.043

关于什么是好的类名已经有很多讨论。社区共识和[HTML 规范](http://www.w3.org/TR/2011/WD-html5-20110525/elements.html#classes)本身建议你的类名描述元素是*什么*，而不是它的外观。

> 作者可以在 class 属性中使用的标记没有其他限制，但鼓励作者使用**描述内容性质的值，而不是描述所需内容呈现的值**。

另请参阅 Wikipedia 上的[语义 HTML](https://en.wikipedia.org/wiki/Semantic_HTML)页面。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-11T20:22:46.553

通常你想用类来说明你的文本是什么，然后用 CSS 来说明这些东西应该如何显示。这样，如果您决定希望标题下方有 0.5em 的空间而不是 0.3em 的空间，这很容易（尤其是使用 FireBug 之类的工具）。

以您指示的方式使用它们并没有利用这种分离。它很脆弱，除了在各处放置内联样式外没有其他功能。

也就是说，您通常会有一些这样的实用程序类（例如`.collapsed { display: none }`）用于切换等。

# ruby-on-rails - 有没有人在不使用 gem 的情况下在 rails 资产管道中使用 twitter bootstrap 运气好？

> ID：11440697
> 
> 赞同：0
> 
> 时间：2012-07-11T20:12:49.060
> 
> 标签：ruby-on-rails, ruby, asset-pipeline, sprockets, twitter-bootstrap-rails

不得不使用 gem 来合并一些样式表对我来说似乎很荒谬。我需要更多地控制我想使用哪个 twitter 引导模块。似乎没有任何宝石允许自助式选项来导入我需要的东西。

将所有的 less 放入 stylesheets/assets 中的 twitter 文件夹的问题是 sprockets 将一直导入它们，并且在为生产预编译资产时它们会失败，因为 twitter mixin 没有导入到每个文件中。这太让人抓狂了，我尝试的每一个谷歌搜索最终都会导致一个 boostrap-rails 宝石。

我目前的方法是为大多数 twitter 引导程序编译一个更少的文件并导入它，但我仍然遇到一些错误。帮助？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T23:00:02.723

我刚刚将[bootstrap-sass gem](https://github.com/thomas-mcdonald/bootstrap-sass/tree/master/vendor/assets)的 assets 文件夹与我的 assets 文件夹合并，并根据我的需要对其进行了自定义。

我有意使用 sass 版本的 bootstrap，因为 less 往往会导致冲突，并且似乎受到 rails 的严重支持。

# c# - 获取 VirtualizingStackPanel 未实现项索引

> ID：11440700
> 
> 赞同：0
> 
> 时间：2012-07-11T20:12:57.480
> 
> 标签：c#, wpf, indexing, virtualization

如果不直接查询 ItemsControl 的数据源，是否可以在 WPF VirtualizingStackPanel 中获取尚未实现的项目的索引？我唯一能想到的是使用 ItemContainerGenerator 但我没有找到任何返回项目索引的东西。

我实际上是在尝试确定是否在水平堆栈面板的当前视口范围之前或之后列出了特定项目。

```
// ? get item index

if (itemIndex < 0) return;

var viewIndexLeft = virtualizingStackPanel.HorizontalOffset;
var viewIndexRight = viewIndexLeft + virtualizingStackPanel.ViewportWidth;

if (itemIndex < viewIndexLeft)
{
    // indicate LEFT
}
else if (itemIndex > viewIndexRight)
{
    // indicate RIGHT
} 
```

# java - 如何在jsp页面中获取eclipse项目的路径

> ID：11440705
> 
> 赞同：0
> 
> 时间：2012-07-11T20:13:03.927
> 
> 标签：java, jsp, servlets, maven, scriptlet

如何获取我当前项目的路径：它是一个使用 maven 原型创建的动态 Web 应用程序。

我想在 scriptlet 代码中检索我的 jsp 页面中的路径，我使用了不同的代码，但我总是得到 eclipse 的路径（C:\Users\Amira\Desktop\eclipse\eclipse）或 web 应用程序的路径tomcat ((C:\software\apache-tomcat-7.0.28\apache-tomcat-7.0.28\wtpwebapps\TestProjectUI)

但我想要我的工作区中的项目路径：C:\Users\Amira\junoWorkspace\TestProjectUI

任何想法将不胜感激谢谢

这是我的jsp：

```
<body>

<%
if (request.getParameter("btnSubmit") != null) //btnSubmit is the name of your button,not id of that button.
{

    String className = request.getParameter("testclass");
    System.out.println(className);
    String[] command = {"CMD", "/C", "mvn -Dtest=" + className + " test"};
    ProcessBuilder probuilder = new ProcessBuilder(command);

    //You can set up your work directory
    probuilder.directory(new File("C:\\Users\\Amira\\junoWorkspace\\TestProjectUI"));

    Process process = probuilder.start();

    //Read out dir output
    java.io.InputStream is = process.getInputStream();
    InputStreamReader isr = new InputStreamReader(is);
    BufferedReader br = new BufferedReader(isr);
    String line;
    System.out.printf("Output of running %s is:\n", Arrays.toString(command));
    while ((line = br.readLine()) != null) {
        System.out.println(line);
    }

    //Wait to get exit value
    try {
        int exitValue = process.waitFor();
        System.out.println("\n\nExit Value is " + exitValue);
    } catch (InterruptedException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
}
%>

        <html:file properties="tonFichier" name="tonForm"/>

        <p>   Please specify a Test :<br>
            <input type="file" name="testclass" size="40" >
        </p>
        <div>
            <input type="submit" id="btnSubmit" name="btnSubmit" value="Execute Test"/>

        </div>
    </form>
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T07:16:40.800

每当我遇到这样的问题时，我都会打印出所有的`System.getProperties()`，看看是否有一个包含我想要的信息。这可能是您可以在这里做的最好的事情，因为 Eclipse 提供的唯一信息将来自属性。如果您在提供的属性之一中没有信息，您可以自己提供它作为启动配置的一部分，您可以`workspace_loc`在启动配置内容中使用该变量。

# macos - 从 shell 脚本写入 Mac OS X 上的 AF_LOCAL 套接字

> ID：11440706
> 
> 赞同：1
> 
> 时间：2012-07-11T20:13:06.430
> 
> 标签：macos, sockets, shell

我有一个创建 AF_LOCAL 套接字 (/tmp/app.sock) 的 Mac OS X 应用程序。有没有办法从 shell 脚本写入这种类型的套接字？我已经尝试了明显的（“echo xxx > /tmp.app.sock”）和一些不太明显的（“exec 3 <> /tmp/app.sock”），但我似乎没有得到任何结果。这有什么诀窍吗，还是我应该硬着头皮写几行 C 或 Java 来做我需要的事情？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T00:07:23.417

[网猫](http://en.wikipedia.org/wiki/Netcat)是你的朋友。

```
echo xxx | nc -U /tmp/app.sock 
```

要测试它是否有效，首先打开另一个终端并输入：

```
nc -lU /tmp/app.sock 
```

然后回到你的第一个终端并再次运行第一个命令。

请注意，互联网上的大多数文档都是针对[原始（Hobbit）netcat](http://nc110.sourceforge.net/)或[GNU Netcat](http://netcat.sourceforge.net/)，而不是 BSD netcat。但这并没有什么不同，联机帮助页应该可以帮助您处理大部分差异。

任何你不知道如何使用 netcat 的东西，试试[socat](http://www.dest-unreach.org/socat/)（遗憾的是它没有内置在 Mac 上，但很容易通过 Homebrew 或 MacPorts 或手动安装）。

# android - 使用 getListView().getCheckedItemIds() 时的空数组

> ID：11440707
> 
> 赞同：7
> 
> 时间：2012-07-11T20:13:25.843
> 
> 标签：android

我正在开发一个示例应用程序来学习 android。它应该显示一个多选列表，当用户单击按钮时，它应该显示在顶部的 TextView 中选择的项目。似乎当我尝试从 ListView 检索所选项目时，总是返回一个空数组。谁能向我解释为什么会这样以及我缺少什么才能使其正常工作？（仅供参考，代码是格兰特艾伦从 Android 4 开始的修改程序）

这是布局xml文件：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >
    <TextView
        android:id="@+id/selection"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" />
    <Button
        android:id="@+id/getSelections"
        android:text="Show Selections"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:onClick="listSelected" />
    <ListView
        android:id="@android:id/list"
        android:layout_width="fill_parent" 
        android:layout_height="fill_parent"
        android:drawSelectorOnTop="false"
        android:choiceMode="multipleChoice" />
</LinearLayout> 
```

这是相关的Java：

```
package com.commonsware.android.checklist;

import android.os.Bundle;
import android.app.ListActivity;
import android.widget.ArrayAdapter;
import android.widget.ListView;
import android.widget.TextView;
import android.view.*;

public class ChecklistDemo extends ListActivity {
    private static final String[] items={"lorem", "ipsum", "dolor",
                    "sit", "amet",
                    "consectetuer", "adipiscing", "elit", "morbi", "vel",
                    "ligula", "vitae", "arcu", "aliquet", "mollis",
                    "etiam", "vel", "erat", "placerat", "ante",
                    "porttitor", "sodales", "pellentesque", "augue", "purus"};

    private TextView selection;

    @Override
    public void onCreate(Bundle icicle) {
        super.onCreate(icicle);
        setContentView(R.layout.main);
        setListAdapter(new ArrayAdapter<String>(this,
                                                android.R.layout.simple_list_item_multiple_choice,
                                                items));
        selection = (TextView)findViewById(R.id.selection);

    }

    public void listSelected(View view) {
        long[] chosenOnes = getListView().getCheckedItemIds();
        selection.setText("Items selected: ");
        selection.setText(Integer.toString(chosenOnes.length));
        for (long x:chosenOnes) {
            int i = Long.valueOf(x).intValue();
            selection.setText(selection.getText() + ", " + items[i]);           
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-11T20:40:32.103

请参阅[文档](http://developer.android.com/reference/android/widget/AbsListView.html#getCheckedItemIds%28%29)，仅当您的适配器具有稳定的 id 时，该方法`getCheckedItemIds()`才会返回有效结果。相反，您可以使用

`SparseBooleanArray array = this.getListView().getCheckedItemPositions();`

希望这会帮助你=）

# objective-c - UIPanGestureRecognizer 坐标限制

> ID：11440708
> 
> 赞同：6
> 
> 时间：2012-07-11T20:13:30.287
> 
> 标签：objective-c, uiview, uipangesturerecognizer

我在我的主 UIView 中添加了一个子视图（称为`panel`），并向它添加了gestureRecognizer，因为我希望它只能在 Y 轴上拖动，并且只能用于某些限制（即 160、300、超过 300 不能拖动）。

我以这种方式实现了手势处理

```
- (IBAction)handlePan:(UIPanGestureRecognizer *)recognizer {
    CGPoint translation = [recognizer translationInView:self.view]; 
    recognizer.view.center = CGPointMake(self.view.frame.size.width/2, recognizer.view.center.y + translation.y);
    [recognizer setTranslation:CGPointMake(0, 0) inView:self.view.superview];

    //now limit the drag to some coordinates
   if (y == 300 || y == 190){
       no more drag
    }
} 
```

但现在我不知道如何将阻力限制在这些坐标上。

这不是一个巨大的视图，它只是一个包含工具栏和按钮的小视图。

我怎样才能将拖动限制在一个坐标上？(x = 160(中间屏幕), y =404) <- 例子

中心应该在那里？

我google了很多，但我没有找到一个具体的答案。

提前致谢

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-07-11T20:36:39.470

首先，您需要在更改视图的中心之前强制执行限制。在检查新中心是否超出范围之前，您的代码会更改视图的中心。

其次，您需要使用正确的 C 运算符来测试 Y 坐标。`=`运算符是赋值。运算符测试是否相等，`==`但您也不想使用它。

第三，如果新中心越界，您可能不想重置识别器的翻译。当拖动超出范围时重置翻译将使用户的手指与他正在拖动的视图断开连接。

你可能想要这样的东西：

```
- (IBAction)handlePan:(UIPanGestureRecognizer *)recognizer {
    CGPoint translation = [recognizer translationInView:self.view];

    // Figure out where the user is trying to drag the view.
    CGPoint newCenter = CGPointMake(self.view.bounds.size.width / 2,
        recognizer.view.center.y + translation.y);

    // See if the new position is in bounds.
    if (newCenter.y >= 160 && newCenter.y <= 300) {
        recognizer.view.center = newCenter;
        [recognizer setTranslation:CGPointZero inView:self.view];
    }
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2015-01-08T22:32:40.963

Rob 的回答可能会产生意想不到的后果。如果拖得足够快， newCenter 将超出范围，但这可能发生在上次更新之前。这将导致视图不会一直平移到最后。如果 newCenter 超出范围而不是不更新，您应该始终更新中心但限制范围，如下所示：

```
- (IBAction)handlePan:(UIPanGestureRecognizer *)recognizer {
    CGPoint translation = [recognizer translationInView:self.view];

    // Figure out where the user is trying to drag the view.
    CGPoint newCenter = CGPointMake(self.view.bounds.size.width / 2,
    recognizer.view.center.y + translation.y);

    // limit the bounds but always update the center
    newCenter.y = MAX(160, newCenter.y);
    newCenter.y = MIN(300, newCenter.y);

    recognizer.view.center = newCenter;
    [recognizer setTranslation:CGPointZero inView:self.view];
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-07-20T08:47:10.927

以上两个答案对于 Y 坐标都是正确的。这是寻找 X 和 Y 坐标的人。只是做了一些小改动。

```
- (void)panWasRecognized:(UIPanGestureRecognizer *)panner {
    UIView *piece = [panner view];
    CGPoint translation = [panner translationInView:[piece superview]];

    CGPoint newCenter = CGPointMake(panner.view.center.x + translation.x,
                                    panner.view.center.y + translation.y);
    if (newCenter.y >= 0 && newCenter.y <= 300 && newCenter.x >= 0 && newCenter.x <=300) 
    {
        panner.view.center = newCenter;
        [panner setTranslation:CGPointZero inView:[piece superview]];
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-08-22T00:21:51.410

```
-(void)handlePan:(UIPanGestureRecognizer*)pgr;
{
    if (pgr.state == UIGestureRecognizerStateChanged) {
        CGPoint center = pgr.view.center;
        CGPoint translation = [pgr translationInView:pgr.view];
        center = CGPointMake(center.x + translation.x,
                             center.y + translation.y);

        if ([self pointInside:center withEvent:nil])
        {
            pgr.view.center = center;
            [pgr setTranslation:CGPointZero inView:pgr.view];
        }
    }
} 
```

# c++ - 如何正确 FFT 声音阵列？

> ID：11440709
> 
> 赞同：1
> 
> 时间：2012-07-11T20:13:32.077
> 
> 标签：c++, fftw, libsndfile

我正在尝试获取输入音频样本中存在的频率列表。似乎我需要做一个 FFT 才能得到这个结果，但是当我 FFT 时我得到了奇怪的答案（使用 FFTW）：我得到的数组主要包含零和一些不可能的大元素（300+ 位！） - 以及这些大数字无论我改变输入音调的频率还是改变 FFT 的样本长度，总是在同一个地方（最后 5 个位置，最后 46 个位置以及其他一些偶尔出现的位置）。我究竟做错了什么？这是我的代码：

```
#include <fftw3.h>
#include <sndfile.h>
#include <math.h>
#include <algorithm>    

int main (int argc, char * argv []) {
    char        *infilename ;
    SNDFILE     *infile = NULL ;
    FILE        *outfile = NULL ;
    SF_INFO     sfinfo ;

    infile = sf_open("test.wav", SFM_READ, &sfinfo);

    int N = pow(2, 10);
    double samples[N];

    sf_read_double(infile, samples, 1);

    fftw_complex out[N];
    fftw_plan p;
    p = fftw_plan_dft_r2c_1d(N, samples, out, FFTW_ESTIMATE);

    fftw_execute(p);
    fftw_destroy_plan(p); 

    for (int i=0; i<N; i++) {
        printf("%f %f\n", out[i][0], out[i][1]);
    }

    sf_close (infile) ;

    return 0 ;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T17:47:03.377

问题是双重的：首先，我没有加载所有的声音数据，其次，我只是获取了结果的真实部分。此外，我仍然得到 FFT 的不可用部分（高于奈奎斯特频率）。更改`sf_read_double(infile, samples, 1)`为`sf_read_double(infile, samples, N)`,更改`for (int i=0; i<N; i++) {`为`for (int i=0; i<N/2; i++) {`和更改

```
printf("%f %f\n", out[i][0], out[i][1]); 
```

至

```
printf("%i %f\n", i*21, sqrt(out[i][0]*out[i][0] + out[i][1]*out[i][1])); 
```

给了我想要的好结果。

# jakarta-ee - NoSQL & Java EE：使用 EntityManager 时如何使用 Jboss 服务器？

> ID：11440710
> 
> 赞同：0
> 
> 时间：2012-07-11T20:13:32.870
> 
> 标签：jakarta-ee, nosql, eclipselink, jboss7.x, entitymanager

我正在使用 glassfish 的 oracle[示例](https://blogs.oracle.com/arungupta/entry/java_ee_6_and_nosql)，但无法弄清楚如何使用 Jboss AS7 代替 glassfishV3。我不断遇到的错误是

```
16:08:09,597 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-12) MSC00001: Failed to start service jboss.persistenceunit."javaee-nosql.war#javaee-nosql": org.jboss.msc.service.StartException in service jboss.persistenceunit."javaee-nosql.war#javaee-nosql": Failed to start service
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1767) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) [rt.jar:1.6.0_31]
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) [rt.jar:1.6.0_31]
    at java.lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_31]
Caused by: javax.persistence.PersistenceException: [PersistenceUnit: javaee-nosql] Unable to build EntityManagerFactory
    at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:914)
    at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:889)
    at org.hibernate.ejb.HibernatePersistence.createContainerEntityManagerFactory(HibernatePersistence.java:73)
    at org.jboss.as.jpa.service.PersistenceUnitServiceImpl.createContainerEntityManagerFactory(PersistenceUnitServiceImpl.java:162)
    at org.jboss.as.jpa.service.PersistenceUnitServiceImpl.start(PersistenceUnitServiceImpl.java:85)
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]
    ... 3 more
Caused by: org.hibernate.MappingException: Repeated column in mapping for entity: model.Order column: city (should be mapped with insert="false" update="false")
    at org.hibernate.mapping.PersistentClass.checkColumnDuplication(PersistentClass.java:680)
    at org.hibernate.mapping.PersistentClass.checkPropertyColumnDuplication(PersistentClass.java:702)
    at org.hibernate.mapping.PersistentClass.checkPropertyColumnDuplication(PersistentClass.java:698)
    at org.hibernate.mapping.PersistentClass.checkColumnDuplication(PersistentClass.java:724)
    at org.hibernate.mapping.PersistentClass.validate(PersistentClass.java:477)
    at org.hibernate.mapping.RootClass.validate(RootClass.java:268)
    at org.hibernate.cfg.Configuration.validate(Configuration.java:1287)
    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1729)
    at org.hibernate.ejb.EntityManagerFactoryImpl.<init>(EntityManagerFactoryImpl.java:84)
    at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:904) 
```

我正在使用的 oracle 项目在[这里](https://blogs.oracle.com/arungupta/resource/totd175-javaee-nosql.zip)

**期望的目标/结果：**

只需从 glassfishv3 更改为 Jboss AS7

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T06:16:30.833

Arun 博客中的应用程序不仅使用 EclipseLink 作为 JPA 提供程序，而且还使用了一些 EclipseLink 专有特性（MongoDB 映射）。因此，即使您*可以*将其替换为 Hibernate，您仍然会缺少上述功能。您应该尝试使用 HibernateOGM 并用 Hibernate OGM 部件替换所需的功能......请参见此处：[http ://www.hibernate.org/subprojects/ogm.html](http://www.hibernate.org/subprojects/ogm.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T20:41:26.767

您尝试部署的应用程序是 EclipseLink 特定的，它使用在 EclipseLink 中实现但在 Hibernate 中没有实现的功能。如果您查看问题中的日志文件，您会发现此时您正在使用 Hibernate，这就是它不起作用的原因。

它在 GlasshFish 中工作的原因是默认的 JPA 提供程序是 EclipseLink。JBoss AS 7 随 Hibernate 一起提供。

从 pom.xml 文件中可以看到，EclipseLink 依赖项确实提供了作用域，但它们自然不是由 JBoss 提供的。

可以从[这里](https://community.jboss.org/wiki/HowToUseEclipseLinkWithAS7)找到用 EclipseLink 替换 Hibernate 的说明。但是很可能会出现一些[问题](https://bugs.eclipse.org/bugs/show_bug.cgi?id=383201)。

# qt - Arduino控制器和Qt应用程序之间的通信

> ID：11440714
> 
> 赞同：0
> 
> 时间：2012-07-11T20:13:51.753
> 
> 标签：qt, operating-system, serial-port, arduino

我的兄弟在他一直在从事的这个伟大的副项目上寻求帮助，但他使用的工具对我来说是新的，我不知道从哪里开始阅读。

问题是这样的：我们有一个使用 Qt 在 Linux 机器上运行的应用程序。我们通过 USB 连接了一个 Arduino 控制器（这被读取为虚拟 com 端口）。这个想法是有一个图形界面来控制他家的灯。Arduino 每五秒报告一次它所连接的灯是否打开。您可以向 Arduino 发送命令以打开/关闭灯。

我有过更高级别的软件项目的经验，但我从来没有写过任何以这种方式与外部硬件接口的东西。我对操作系统功能的了解有限。

我需要学习做到以下几点：

1.  如何从 Arduino 获取有关 Qt 应用程序开/关灯的输入信号？
2.  如何从 Qt 应用程序向 Arduino 发出信号，告诉它开/关灯？

我应该说我已经使用 minicom 成功地设置了与 Arduino 的单向通信。我可以每五秒钟看到一次指示灯状态的脉冲。我还不能向另一个方向发送“打开/关闭”信号。

我将非常感谢任何关于阅读什么以了解我需要学习的内容的建议。我已经成功阅读了通过谷歌找到的关于 Arduino 的材料（这就是我让 minicom 工作的方式），但我无法找到与 Qt 集成的正确信息。我对操作系统如何工作的细节的无知阻碍了我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T20:41:35.393

您所需要的只是某种与串行端口通信的方式，理想情况下无需处理所有依赖于操作系统的东西。如果将 Qt4 与 Python 结合使用，[pyserial](http://pyserial.sourceforge.net/)可能是要走的路。对于 Qt/C++，有一些可能很方便的扩展，例如[qextserialport](http://code.google.com/p/qextserialport/)。

# mysql - Rails 3 限制正在搞乱数据库查询中的排序

> ID：11440716
> 
> 赞同：1
> 
> 时间：2012-07-11T20:14:02.673
> 
> 标签：mysql, ruby-on-rails-3, activerecord

我正在使用 will_paginate gem 和 rails 3.2.3。我试图显示所有具有最新帖子排序的特定标签的帖子，所以我使用这个：

```
 @posts = Post.find_by_post_type_label(session[:current_post_type],@selected_labels)
             .paginate(:page => params[:page], :order => "comments.created_at DESC").all 
```

但它会乱序返回帖子。每一页都将被排序，但第二页将包含应该在第一页上的帖子。

例子：

```
Post.find_by_post_type_label(1,[]) 
```

返回帖子 [1,2,3,4,5,6,7,8,9,10]，每个帖子的最新评论都是几个月前。它生成的sql是：

```
 SELECT `posts`.* FROM `posts` WHERE `post`.`post_type_id` = 1 
```

和

```
 SELECT `comments`.* FROM `comments` WHERE `comments`.`post_id` IN ( 1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 , 10 ) ORDER BY created_at DESC 
```

如果我订购它并限制它，例如：

```
Post.find_by_post_type_label(1,[]).order(comments.created_at DESC).limit(5) 
```

will_paginate 就是这样做的，它返回帖子 2,3,4,5,7

生成后：

```
SELECT DISTINCT `post`.id FROM `posts` LEFT OUTER JOIN
`comments` ON `comments`.`post_id` = `post`.`id` WHERE 
`post`.`post_type_id` = 1 ORDER BY posts.created_at DESC LIMIT 5 
```

和

```
 SELECT `post`.`id` AS t0_r0, `post`.`user_id` AS t0_r1, `post`.`name` AS 
 t0_r2, `post`.`image_id` AS t0_r3, `post`.`post_type_id` AS t0_r4, 
`post`.`description` AS t0_r5, `post`.`featured` AS t0_r6, `post`.`approved`
AS t0_r7, `comment`.`id` AS t1_r0, `comments`.`post_id` AS t1_r1, 
`comments`.`image_id` AS t1_r2, `comments`.`edits` AS t1_r3, 
`comments`.`color` AS t1_r4, `comments`.`min_reputation` AS t1_r5, 
`comments`.`created_at` AS t1_r6, `comments`.`updated_at` AS t1_r7 FROM 
`post` LEFT OUTER JOIN `comments` ON `comments`.`post_id` = 
`post`.`id` WHERE `post`.`post_type_id` = 1 AND `post`.`id` IN (2, 3, 
4, 5, 7) ORDER BY comments.created_at DESC 
```

在订购之前它显然是有限制的，但我不知道如何改变它。任何帮助，将不胜感激

*编辑 1*

关系是这样的：

```
Class Post
  belongs_to :user
  belongs_to :post_type
  has_many :comments, dependent: :destroy, order: 'created_at DESC'
  has_and_belongs_to_many :labels

Class Comment
  belongs_to :post
  belongs_to :user 
```

注释是数据库中唯一带有时间戳的注释。第一条评论包含为帖子创建的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T20:47:27.403

在 find_by_sql 中使用此 sql 结束

```
SELECT  p1.*, iv.created_at FROM posts p1
INNER JOIN ( SELECT p2.id id, max(c.created_at) created_at FROM posts p2
            INNER JOIN comments c ON c.post_id = p2.id
            GROUP BY p2.id)
iv ON p1.id=iv.id ORDER BY iv.created_at DESC LIMIT 5 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T22:18:01.610

您应该考虑[find_by_sql方法](http://guides.rubyonrails.org/active_record_querying.html#finding-by-sql)

所以你可以像这样重写你的查询：

```
ts = Post.find_by_sql("SELECT * FROM posts WHERE post_type_id = ? and id in (?) ORDER BY created_at DESC LIMIT 5", session[:current_post_type], @selected_labels).paginate(:page => params[:page]).all 
```

我不确定@selected_labels 是什么，也是按 Post.created_at 而不是评论排序的，我不确定您为什么要按评论对帖子进行排序...您想看到最活跃的吗先发帖？

# android - Actionbarsherlock 方向更改不确定进度条停止旋转

> ID：11440717
> 
> 赞同：0
> 
> 时间：2012-07-11T20:14:09.650
> 
> 标签：android, android-actionbar, actionbarsherlock

我在操作栏中有一个刷新菜单项，我的主布局只包含一个按钮。所以点击刷新菜单项应该把它变成一个微调器，点击按钮应该停止它旋转。我的问题是，当我点击刷新按钮时，它开始旋转，这是正确的，但现在当我旋转它时，它会自动停止旋转。

这是我的活动。

```
public class MyActivity extends SherlockActivity implements OnClickListener{

View refreshView =  null;
com.actionbarsherlock.view.MenuItem refreshItem = null;
Animation rotateClockwise = null;
Button btn = null;
boolean downloadComplete = false;
boolean selected = false;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_my);
    btn = (Button)findViewById(R.id.button1);
    btn.setOnClickListener(this);
}

@Override
public boolean onCreateOptionsMenu(com.actionbarsherlock.view.Menu menu) {
    getSupportMenuInflater().inflate(R.menu.my_menu, menu);
    // Inflate our custom layout.

    LayoutInflater inflater = (LayoutInflater) getSystemService(LAYOUT_INFLATER_SERVICE);
    refreshView = (View) inflater.inflate(
            R.layout.actionbar_indeterminate_progress, null);
    refreshItem = menu.findItem(R.id.menu_refresh);
    if (selected){
        refreshItem.setActionView(refreshView);
    }
    return true;
}

@Override
public boolean onOptionsItemSelected(
        final com.actionbarsherlock.view.MenuItem item) {
    switch (item.getItemId()) {
    case R.id.menu_refresh:
        runOnUiThread(new Runnable() {

            @Override
            public void run() {
                // TODO Auto-generated method stub
                // Apply the View to our MenuItem
                item.setActionView(refreshView);
            }
        });
        // Refresh the data
        //refresh();
        selected =true;
        break;
    }
    return true;
}

@Override
public void onClick(View v) {
    // TODO Auto-generated method stub
    downloadComplete = !downloadComplete;
    selected = false;
    runOnUiThread(new Runnable() {
            @Override
        public void run() {
            // TODO Auto-generated method stub
            refreshItem.setActionView(null);
        }
    });
}
} 
```

这是我的 res/layout/actionbar_indeterminate_progress.xml

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:gravity="center">
    <ProgressBar android:layout_width="32dp"
        android:layout_height="32dp"
        android:layout_marginLeft="12dp"
        android:layout_marginRight="12dp"
        android:layout_gravity="center"
        style="?android:attr/indeterminateProgressStyle" />
</FrameLayout> 
```

我的 res/layout/activity_my.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >
    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:padding="@dimen/padding_medium"
        android:text="@string/hello_world"
        tools:context=".MyActivity" />
</RelativeLayout> 
```

和我的 res/menu/my_menu.xml

```
<menu xmlns:android="http://schemas.android.com/apk/res/android" >
    <item
        android:id="@+id/menu_refresh"
        android:icon="@drawable/ic_menu_refresh"
        android:showAsAction="always"
        android:title="Refresh"/>
    <item
        android:id="@+id/settings"
        android:icon="@drawable/ic_menu_refresh"
        android:title="Settings">
    </item>
</menu> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T07:18:38.950

问题是活动被破坏，然后在方向改变时再次创建。你需要做两件事：

1.  在方向更改之前保存*所选字段的值。*有关如何处理方向更改的详细信息，请参阅[处理配置更改](http://developer.android.com/guide/components/activities.html#ConfigurationChanges)部分以及[处理运行时更改](http://developer.android.com/guide/topics/resources/runtime-changes.html)中的更多内容。
2.  当方向改变后重新创建活动时，重新存储*选定*的字段并使用其值来启动动画，如果该值为真。

# jquery - 使用 jQuery 创建 XML 时，应该使用 $(' ') 或 $.parseXML(' '）？

> ID：11440718
> 
> 赞同：4
> 
> 时间：2012-07-11T20:14:11.220
> 
> 标签：jquery, xml, html

我发现 $('') 会导致重新组织属性并分配 xml 命名空间，但 $.parseXML() 保留了原始 xml 字符串的完整性。我不确定这是否是一件好事。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T20:19:31.587

根据文档[`parseXML`](http://api.jquery.com/jQuery.parseXML/)

> jQuery.parseXML 使用浏览器的原生解析功能来创建一个有效的 XML 文档。然后可以将此文档传递给 jQuery 以创建一个可以遍历和操作的典型 jQuery 对象。

因此，如果您试图创建一个您想要使用的 XML 文档`parseXML`。

* * *

根据 Esailija，您可以`$($.parseXML(xml))`使用 jQuery 执行和遍历 XML 文档。不要直接传递字符串，因为 xml 被解释为 html 会有不同的规则。例如，在 html 中，param 标签必须是自闭合标签。

# java - 如何在 android 的 SQLite 数据库中运行查询？

> ID：11440720
> 
> 赞同：6
> 
> 时间：2012-07-11T20:14:15.263
> 
> 标签：java, android, sqlite

在我的 SQLite 数据库管理器中，我可以查询：

```
SELECT SUM(odometer) as odometer FROM tripmileagetable where date like '2012-07%'; 
```

此查询返回我从 2012 年 7 月名为“tripmileagetable”的表中里程表列的总和，但我想在 android 查询中编写此代码。

但是我不知道如何在 database.query() 方法中建立这个查询，有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-11T20:30:57.943

```
final Cursor cursor = db.rawQuery("SELECT SUM(odometer) as odometer FROM tripmileagetable where date like '2012-07%';", null);
int sum = 0;
if (cursor != null) {
    try {
        if (cursor.moveToFirst()) {
            sum = cursor.getInt(0);
        }
    } finally {
        cursor.close();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T20:34:51.060

这取决于您计划如何访问 Android 中的数据库。您可以尝试以下方法：

```
SQLiteDatabase db = this.getWritableDatabase();
String selectQuery = "select sum(odometer) as odometer from tripmileagetable where date like '2012-07%'";
Cursor cursor = db.rawQuery(selectQuery, null); 
```

如果您使用的是 SQLiteOpenHelper 类，则将使用上述内容。

如果您自己创建了数据库文件，则可以执行以下操作：

```
SQLiteDatabase db = SQLiteDatabase.openDatabase("/data/data/com.package.name/databases/dbname.db", null, SQLiteDatabase.OPEN_READWRITE);
String selectQuery = "select sum(odometer) as odometer from tripmileagetable where date like '2012-07%'";
Cursor cursor = db.rawQuery(selectQuery, null); 
```

对 SQLiteDatase、Cursor 和 SQLiteOpenHelper 进行一些研究。

这个例子可能会帮助你：

[https://github.com/nraboy/Spyfi/blob/master/Android/src/com/nraboy/spyfi/DataSource.java](https://github.com/nraboy/Spyfi/blob/master/Android/src/com/nraboy/spyfi/DataSource.java)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T20:27:30.797

您可以使用[rawQuery](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#rawQuery%28java.lang.String,%20java.lang.String%5B%5D%29)方法：

```
Cursor c = database.rawQuery("SELECT SUM(odometer) as odometer FROM tripmileagetable where date like '2012-07%'", null); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-31T17:19:45.747

Android 完全支持[SQLite DB](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html)。您在应用程序内创建的所有数据库都可以从应用程序的所有类访问（不能在应用程序外部访问！）。

首先，您应该创建一个扩展[SQLiteOpenHelper](http://developer.android.com/reference/android/database/sqlite/SQLiteOpenHelper.html)的 Java 类。在这里，您必须重写*onCreate()*和*onUpdate()*方法。可以假设，第一个在创建 DB 时调用，而后者在修改 DB 时调用。

```
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;
import android.content.Context;
import android.database.Cursor;
import android.content.ContentValues;

/**
 * Class DatabaseHelper.
 */
public class DatabaseHelper extends SQLiteOpenHelper {
    //Database parameters:
    private static final String DATABASE_NAME = "dbname";  // the name of the DB!
    private static final int DATABASE_VERSION = 2;
    private static final String DATABASE_TABLE_NAME = "tripmileagetable";  // the name of the table!

    //Table attributes:
    private static final String DATABASE_TABLE_ATTR_ID = "id";  // attr1
    private static final String DATABASE_TABLE_ATTR_ODOMETER = "odometer";  // attr2
    private static final String DATABASE_TABLE_ATTR_DATE = "date";  // attr3

    /**
     * Class constructor.
     *
     * @param context  the context.
     */
    DatabaseHelper(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        String create = "CREATE TABLE " + DATABASE_TABLE_NAME + " (" +
                        DATABASE_TABLE_ATTR_ID + " INTEGER PRIMARY KEY AUTOINCREMENT, " +
                        DATABASE_TABLE_ATTR_ODOMETER + " INTEGER, " +
                        DATABASE_TABLE_ATTR_DATE + " TEXT);";

        db.execSQL( create );
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        db.execSQL("DROP TABLE IF EXISTS " + DATABASE_TABLE_NAME);
        onCreate(db);
    }
} 
```

现在，在新的 Java 类中，您可以创建自定义方法来查询您的数据库。

要编写数据库，您应该使用*getWritableDatabase()*，而要读取它，您应该使用*getReadableDatabase()*。它们都返回一个*SQLiteDatabase*对象，并最终抛出一个*SQLiteException*。特别是，要查询您的数据库，有两种可用的*SQLiteDatabase*方法：*rawQuery*和*query*（都返回一个*Cursor*对象）。

```
/**
 * Get the sum of the odometer of a particular month and year.
 *
 * @param year  the year.
 * @param month  the month.
 * @return the sum of the odometer of the year and the month.
 */
public int sumOdometer(Integer year, Integer month) {
    //Date composition:
    String date = year.toString() + "-" + month.toString() + "%";

    //SQL query:
    String query = "SELECT SUM(" + DATABASE_TABLE_ATTR_ODOMETER + ") AS " + DATABASE_TABLE_ATTR_ODOMETER + 
                   " FROM " + DATABASE_TABLE_NAME +
                   " WHERE " + DATABASE_TABLE_ATTR_DATE + "LIKE ?";

    //Execute the SQL query:
    SQLiteDatabase db = getReadableDatabase();
    Cursor cursor = db.rawQuery(query, new String [] {date});

    int sum = 0;
    if( cursor.moveToFirst() ) {  // moves the cursor to the first row in the result set...
        sum = cursor.getInt( cursor.getColumnIndex(DATABASE_TABLE_ATTR_ODOMETER) );
    }

    //Close the Cursor:
    cursor.close();

    return sum;
} 
```

请注意，SQLite 会自动将单引号 (') 放在参数 (?) 周围。

你可以在这里找到一个很好的教程：http: [//www.codeproject.com/Articles/119293/Using-SQLite-Database-with-Android](http://www.codeproject.com/Articles/119293/Using-SQLite-Database-with-Android)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-16T08:52:12.887

您的字段未在表数据库上创建，请查看表上的字段。因为我已经在我的身上看到了这个问题。我使用 SQLite Administrator 查看我的数据库。

或者如果您没有，请查看创建数据库的源代码。确保您的源代码是真实的，然后您可以删除文件资源管理器上的旧数据库（我的意思是使用 eclipse）。您可以使用新的数据库再次运行。

# c++ - 使用 fstream 时冒号出错

> ID：11440722
> 
> 赞同：-1
> 
> 时间：2012-07-11T20:14:21.913
> 
> 标签：c++, visual-studio-2010

我正在尝试在 C++ 中使用 fstream 和 fout 将文本导出到文件。它即将完成，但是当我尝试运行它时，它给了我错误：

```
1>c:\users\student\desktop\jackc     c++\pluginmaker\pluginmaker\pluginmaker.cpp(100): warning C4129: ':' : unrecognized character escape sequence 
```

我该如何解决？

**版主编辑添加：**

这是代码，最后一行是引发错误的代码：

```
ofstream fout; 
fout.open("plugin.txt");
fout<<"description\: " << plugindesc << "\n"; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T20:45:35.853

改变这个：

```
fout<<"description\: " << plugindesc << "\n"; 
```

对此：

```
fout<<"description: " << plugindesc << "\n"; 
```

正如@chris 试图说的：当编译器看到`\`引用字符串的内部时，它将它与下一个字符结合起来，并假设两者一起具有特殊含义。例如，`\x`表示*从此处开始的十六进制数*。

在您的情况下，`\:`没有特殊含义，*因此*编译器会说*您犯了错误*。

# javascript - 使用 querySelectorAll 时，有没有办法在不使用 ID 的情况下引用上下文节点的直接子节点？

> ID：11440725
> 
> 赞同：7
> 
> 时间：2012-07-11T20:14:29.927
> 
> 标签：javascript, css-selectors, selectors-api

假设我有一个 HTML 结构，例如

```
<div id="a">
  <div id="b">
    <div id="c"></div>
  </div>
</div> 
```

要使用 querySelectorAll 对“a”的孩子进行查询，我可以执行类似的操作

```
//Get "b", but not "c"
document.querySelectorAll('#a > div') 
```

**我的问题是**：是否可以在没有 ID 的情况下直接引用节点？我试着做

```
var a_div = document.getElementById('a')
a_div.querySelectorAll('> div') //<-- error here 
```

但我收到一个错误，告诉我我使用的选择器无效。

* * *

如果有人想知道，我的真实用例会更复杂一些，比如 '> .foo .bar .baz' 所以我宁愿避免手动 DOM 遍历。目前我正在向根 div 添加一个临时 ID，但这似乎是一个丑陋的黑客......

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-11-29T08:18:06.137

```
document.querySelector('#a').querySelectorAll(':scope > div') 
```

我不确定浏览器是否支持，但我在 chrome 和 chrome 移动打包应用程序上使用它，它工作正常。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-11T20:18:31.567

不，没有办法^(（还）)在不使用对该元素的引用的情况下引用某个元素的所有子元素。因为`>`是一个[子组合](http://www.w3.org/TR/2011/WD-selectors4-20110929/#child-combinators)器，它表示父元素和子元素之间的关系，所以需要一个[简单的选择器](http://www.w3.org/TR/2011/WD-selectors4-20110929/#simple)（父）（在您的示例中缺少）。

在评论中，[BoltClock 说](https://stackoverflow.com/questions/11440725/when-using-queryselectorall-is-there-a-way-to-reference-the-immediate-children/11440779#comment15104621_11440779)Selectors [API Level 2 规范](http://www.w3.org/TR/selectors-api2)定义了一个方法^(名称)^(*可能会*)^(改变)*“它接受可能被称为相对选择器（可以以组合器而不是复合选择器开头的选择器）作为参数”* . 实现时，可以按如下方式使用：[`findAll`](http://www.w3.org/TR/selectors-api2/#the-apis)

 **```
a_div.findAll('> div'); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-11T20:20:03.433

我想我一定是误解了你的问题，但这就是我解释它的方式。

```
var a = document.getElementById('a')
var results = a.querySelectorAll('div'); 
```

results 现在将保存您所有的子 div。**

# javascript - jQuery：单击时创建带有变量的可重用函数

> ID：11440734
> 
> 赞同：1
> 
> 时间：2012-07-11T20:15:23.417
> 
> 标签：javascript, jquery, css, jquery-selectors

使以下代码可重用的正确方法是什么（这样我每次想要隐藏/显示一组 DIV 时就不必拥有这么多相同功能的版本）：

```
// instructions
$('#hideInstructionsOverview').click(function() {
    $('#instructionsOverview').fadeOut(400, function () {
        $('#instructionsDetail').fadeIn(400);
    });
});

$('#hideInstructionsDetail').click(function() {
    $('#instructionsDetail').fadeOut(400, function () {
        $('#instructionsOverview').fadeIn(400);
    });
});

// group
$('#hideGroupOverview').click(function() {
    $('#groupOverview').fadeOut(400, function () {
        $('#groupDetail').fadeIn(400);
    });
});

$('#hideGroupDetail').click(function() {
    $('#groupDetail').fadeOut(400, function () {
        $('#groupOverview').fadeIn(400);
    });
}); 
```

上面的代码以相同的方式用于隐藏“instructions”和“group” div（以及大约 7 个其他 div 以相同的方式）。每个调用的类似方式是使用以下代码：

```
<a id="hideInstructionsOverview" href="javascript:void(0);"><img src="img/misc/plus.png" alt="" width="40" height="40" border="0"></a>
<a id="hideInstructionsDetail" href="javascript:void(0);"><img src="img/misc/minus.png" alt="" width="40" height="40" border="0"></a>

<a id="hideGroupOverview" href="javascript:void(0);"><img src="img/misc/plus.png" alt="" width="40" height="40" border="0"></a>
<a id="hideGroupDetail" href="javascript:void(0);"><img src="img/misc/minus.png" alt="" width="40" height="40" border="0"></a> 
```

我在想有一种方法可以创建一个接受变量的函数，并在点击时传递三个变量：**（1）**点击了什么图像 id（我认为这`$this`可能被使用），**（2）**什么 div`fadeOut`和**(3)**什么 div 到`fadeIn`. 我似乎无法正确创建和传递变量，但我想最终的可重用函数看起来像这样：

```
// divToggler
$('$this').click(function() {
    $('#divToFadeOut').fadeOut(400, function () {
        $('#divToFadeIn').fadeIn(400);
    });
}); 
```

提前非常感谢！

伯克利

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:34:54.627

理想情况下，您应该分层解决这个问题，而不是依赖大量 ID。这并不*总是*可能的，而且由于您没有发布您的 HTML 结构，我将只回答手头的问题。请注意，这使用了 ECMA 5 的[`Object.keys()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/keys)方法。它需要修改才能在 IE <= 8 中使用。

```
var map = {
    hideInstructionsOverview: {out: 'instructionsOverview', in: 'instructionsDetail'},
    hideInstructionsDetail: {out: 'instructionsDetail', in: 'instructionsOverview'}
    /* etc... */
}

$('#'+Object.keys(map).join(', #')).on('click', function() {
    var thisMapEntry = map[$(this).attr('id')];
    $('#'+thisMapEntry.out).fadeOut(400, function () {
        $('#'+thisMapEntry.in).fadeIn(400);
    });
}); 
```

可以通过一些关于命名约定的假设来缩短它（从你发布的内容来看，这看起来很合理），但我不会冒险这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T20:25:42.800

试试这个（[工作示例](http://jsfiddle.net/fedosov/Gh89C/4/)）：

```
function capitaliseFirstLetter(string)
{
    return string.charAt(0).toUpperCase() + string.slice(1);
}

// Implementing:
function elementsToggler(elements)
{
    for (var i = 0; i < 2; i++)
    {
        $("#hide"+capitaliseFirstLetter(elements[i])).bind("click", { i: i }, function(e)
        {
            $("#"+elements[e.data.i]).fadeOut(400, function()
            {
                $("#"+elements[e.data.i === 0 ? 1 : 0]).fadeIn(400);
            });
        });
    }
}

// Binding:
elementsToggler(["instructionsOverview", "instructionsDetail"]);
elementsToggler(["groupOverview", "groupDetail"]); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T20:38:11.183

你有：

```
function _setupClick(starterName, finalName){
    var initializer = $('#hide' + starterName.charAt(0).toUpperCase() + starterName.slice(1));
    var overview = $('#' + starterName);
    var detail = $('#' + finalName);
    initializer.click(function(){
        overview.fadeOut(400, function () {
            detail.fadeIn(400);
        });
    });
}
function setupClick(name){
    _setupClick(name + 'Overview', name.toLowerCase() + 'Detail');
    _setupClick(name + 'Detail', name.toLowerCase() + 'Overview');
}

setupClick('instructions');
setupClick('group'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T20:41:42.067

有很多方法可以做到这一点

您可以尝试将要淡入的 div id 作为您单击的元素的属性，例如使用当前设置

html

```
<a id="groupOverview" class="clickClass" rel="#groupOverview">link here</a> 
```

JS

```
$('.clickClass').click(function() {
    var showThis = $(this).attr('rel');
    $( '#' + $(this).attr('id').replace('hide', '') ).fadeOut(400, function() {
        $( showThis ).fadeIn(400);
    });
}); 
```

您也可以使用不同的命名约定轻松应用这种设置。如果您有不同的 div ID 没有很好地匹配，您总是可以定义另一个属性来获取您需要的值。为了使其更具可读性，这里我逐行定义了js，而不是一件事

```
$('.clickClass').click(function() {
    // gets the id attribute of clicked element and replaces the hide string with nothing (removes it). This works only because you have setup your html this way
    var hideThis = '#' + $(this).attr('id').replace('hide', '');

    // gets the rel which I have set to the id of the showing element
    var showThis = $(this).attr('rel');

    $( hideThis ).fadeOut(400, function() {
        $( showThis ).fadeIn(400);
    });
}); 
```

我没有时间制作样本，因为我在工作，但如果有什么不起作用，请告诉我，这应该很容易解决，但我认为这种结构是最容易理解和实施的

# javascript - JQuery选项卡没有隐藏

> ID：11440736
> 
> 赞同：0
> 
> 时间：2012-07-11T20:15:31.563
> 
> 标签：javascript, jquery, jquery-tabs

我试图让 JQuery 选项卡（不是 UI）在创建动态选项卡和从 php 文件加载动态内容时播放得很好。php 文件返回一些表格、css 和图像。一切都按预期加载。我正在尝试通过 href 链接创建其他选项卡。一切似乎都在工作，除了创建的初始默认选项卡内容容器在创建其他选项卡或单击以激活时不会隐藏。相反，附加选项卡的内容会添加到初始内容容器的底部。如果我用简单的“Hello World”替换我的 php 文件，一切正常。我已经梳理了 php 数据，并且 html 中没有冲突的元素名称。没有什么花哨的，只有 html、css 和图像。

[您可以在此处](http://coltsdigital.me/armoredkill/tabs.html)查看示例演示。

这是我的js：

```
$(function() {
    var total_tabs = 0;
    var pId = 0;
    var pName = "";

    //initialize first tab
    addtab(total_tabs,pId,"Server Details");

    $("a.tb_showTab").click(function() {
        total_tabs++;
        var vId = $(this).attr('hash').replace('#','');
        var pValues = vId.split('|');               
        $("#tabcontent p").hide();
        addtab(total_tabs,pValues[1],pValues[0]);
        return false;
    });

    function addtab(count,pId,pName) {
        var closetab = '<a href="" id="close'+count+'" class="close">&times;</a>';
        //no close button on default tabs
        if (pId==0 || pId==1){closetab = ""};

        //Create Tab
        $("#tabul").append('<li id="t'+count+'" class="ntabs">'+pName+'&nbsp;&nbsp;'+closetab+'</li>');

        //Create Tab Content
        if (pId==0){
            //load Server Details
            $.get("test5.php",
                {nbRandom: Math.random() },
                function(data){
                    $("#tabcontent").append('<p id="c'+count+'">'+data+'</p>');
                });
            }
        else if (pId==1){
            //load Groups Details
            //eventually replace this with dynamic content from php file
            $("#tabcontent").append('<p id="c'+count+'">'+pName+' content goes here!!</br>ID='+pId+'</p>');
            }
        else {
            //load Person Details
            //eventually replace this with dynamic content from php file
            $("#tabcontent").append('<p id="c'+count+'">'+pName+' content goes here!!</br>ID='+pId+'</p>');
            }
        $("#tabul li").removeClass("ctab");
        $("#t"+count).addClass("ctab");

        $("#t"+count).bind("click", function() {
            $("#tabul li").removeClass("ctab");
            $("#t"+count).addClass("ctab");
            $("#tabcontent p").hide();
            $("#c"+count).fadeIn('slow');
        });

        $("#close"+count).bind("click", function() {
            // activate the previous tab
            $("#tabul li").removeClass("ctab");
            $("#tabcontent p").hide();
            $(this).parent().prev().addClass("ctab");
            $("#c"+count).prev().fadeIn('slow');

            $(this).parent().remove();
            $("#c"+count).remove();
            return false;
        });
    }
}); 
```

这是html：

```
<a class="tb_showTab" href="#Tab_Name_1|11111" >Add Tab1</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a class="tb_showTab" href="#Tab_Name_2|22222" >Add a Tab2</a>&nbsp;&nbsp;|&nbsp;&nbsp;
<a class="tb_showTab" href="#Tab_Name_3|33333" >Add a Tab3</a>    

<div id="container">
    <ul id="tabul">
        <li id="litab" class="ntabs add"></li>
    </ul>            
<div id="tabcontent"></div>
</div> 
```

任何帮助将不胜感激！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T20:24:07.287

您`<p></p>`的 inside tabcontent 不会嵌套`<center></center>`实际内容所在的标签。尝试以下 js 代码 - 这似乎有效。

```
$(function() {
var total_tabs = 0;
var pId = 0;
var pName = "";

//initialize first tab
addtab(total_tabs,pId,"Server Details");

$("a.tb_showTab").click(function() {
    total_tabs++;
    var vId = $(this).attr('hash').replace('#','');
    var pValues = vId.split('|');               
    $("#tabcontent center").hide();
    addtab(total_tabs,pValues[1],pValues[0]);
    return false;
});

function addtab(count,pId,pName) {
    $("#tabcontent p").hide();
    var closetab = '<a href="" id="close'+count+'" class="close">&times;</a>';
    //no close button on default tabs
    if (pId==0 || pId==1){closetab = ""};

    //Create Tab
    $("#tabul").append('<li id="t'+count+'" class="ntabs">'+pName+'&nbsp;&nbsp;'+closetab+'</li>');

    //Create Tab Content
    if (pId==0){
        //load Server Details
        $.get("test5.php",
            {nbRandom: Math.random() },
            function(data){
                $("#tabcontent").append('<p id="c'+count+'">'+data+'</p>');
            });
        }
    else if (pId==1){
        //load Groups Details
        //eventually replace this with dynamic content from php file
        $("#tabcontent").append('<p id="c'+count+'">'+pName+' content goes here!!</br>ID='+pId+'</p>');
        }
    else {
        //load Person Details
        //eventually replace this with dynamic content from php file
        $("#tabcontent").append('<p id="c'+count+'">'+pName+' content goes here!!</br>ID='+pId+'</p>');
        }
    $("#tabul li").removeClass("ctab");
    $("#t"+count).addClass("ctab");

    $("#t"+count).bind("click", function() {
        $("#tabul li").removeClass("ctab");
        $("#t"+count).addClass("ctab");
        $("#tabcontent center").hide();
        $("#c"+count).fadeIn('slow');
    });

    $("#close"+count).bind("click", function() {
        // activate the previous tab
        $("#tabul li").removeClass("ctab");
        $("#tabcontent p").hide();
        $(this).parent().prev().addClass("ctab");
        $("#c"+count).prev().fadeIn('slow');

        $(this).parent().remove();
        $("#c"+count).remove();
        return false;
    });
}
}); 
```

请注意，基本上，我只是将`$("#tabcontent p")`部分更改为`$("#tabcontent center")`. 如果这不是您想要的 html 输出，您可能需要再次查看您的 html。

# c# - 在 MVC3 中重载 ActionResult

> ID：11440738
> 
> 赞同：0
> 
> 时间：2012-07-11T20:15:38.757
> 
> 标签：c#, asp.net-mvc-3

如果这是一个好主意，请提供指导......

我有一个客户希望在系统中记录非常详细的应用程序。他们想要跟踪每次点击以及被点击的页面和控件。

我在想 SQL 服务器上的一个很好的存储过程可以让我保留这些信息，但是将那个级别的信息输入数据库是个问题。

我正在考虑在 EF 中添加一个条目，以便在每个 ActionResult 代码块中将信息发布到 SQL 服务器中，但它发生在我身上，也许我可以覆盖 ActionResult 并这样做......

有人做过这样的事吗？

蒂亚

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:13:11.143

您可以使用`ActionFilters`. 这篇[文章](http://www.asp.net/mvc/tutorials/older-versions/controllers-and-routing/understanding-action-filters-cs)甚至还有一个日志示例。顺便说一句，相同的操作过滤器也可以在调试过程中为您提供帮助，因此您可以查看异常之前发生的情况。

如果您的客户想要超级疯狂的跟踪信息，您可以记录[MiniProfiler 的日志记录和跟踪信息](http://samsaffron.com/archive/2011/07/25/Automatically+instrumenting+an+MVC3+app)，其中包含各种额外信息，例如实际的数据库调用等。

但正如 Andre 已经提到的，使用不同的数据库，并异步保存结果。

### 编辑：

此方法记录应用程序中实际发生的情况、用户操作的实际结果、如果您的客户需要日志记录以进行审计或类似的事情，`ActionFilters`都适合您。

如果您的客户想要跟踪使用统计信息，例如[网页热图](https://www.google.hu/search?client=opera&rls=en&q=web%20page%20heat%20map&sourceid=opera&ie=utf-8&oe=utf-8&channel=suggest)，那么请查看搜索结果 :-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T21:01:43.220

**这不是一个回答**，但有一点你必须考虑，我想讨论一下。

如果您需要如此详细的跟踪日志（例如用户在页面上单击的位置），我强烈建议您*不要将这些日志存储在应用程序使用的同一数据库中*，因为可扩展性将是一个问题。此外，跟踪日志非常适合 NoSQL 数据库。由于这些数据库中的大多数都使用 REST API，因此这是使用 javascript 跟踪用户交互的完美解决方案。

想想看。您将拥有一个独立的 REST Web 服务来存储您的跟踪日志。它们可以从 C#（从控制器或任何地方）和视图轻松发送。

任何反馈将不胜感激。正如我所说，这不是答案，而是将其视为头脑风暴。

问候

# c# - 为 Android 项目构建 Mono 时，“aapt.exe”以代码 1 退出

> ID：11440741
> 
> 赞同：41
> 
> 时间：2012-07-11T20:15:50.273
> 
> 标签：c#, android, xamarin.android, aapt

我组装了一个相当简单的 Mono for Android 应用程序，它只不过是在后台服务中播放“AndroidResource”MP3（复制自[Greg Shackles 最新的 Visual Studio 杂志关于 MfA 后台服务的文章](http://visualstudiomagazine.com/Articles/2012/07/10/Background-Services-in-Mono-for-Android.aspx?Page=1)）。我将代码与我自己的自定义 MP3 文件放在一起，并尝试构建它，只是得到了这个可爱的错误。

```
"aapt.exe" exited with code 1 
```

这是错误列表和构建输出日志中的唯一信息。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2012-07-11T20:15:50.867

### 第 1 步：获取更多信息

如果您遇到此错误，希望您还会遇到[Jonathan Pryor](http://mono-for-android.1047100.n5.nabble.com/Drawable-Resource-aapt-exe-exited-with-code-1-td4952932.html)回复其他有相同问题的人的帖子。建议是从 MSBuild 打开更详细的日志记录，看看您是否从这些消息中获得了有用的信息。

在 Visual Studio 选项对话框中，转到“项目和解决方案”，然后转到“构建并运行”。将“MSBuild 项目构建输出详细程度”从“Minimal”切换为“Normal”，然后再次构建您的项目。这样做之后，我收到了这条消息，它更有帮助。显然，资源只能包含字母、数字、句点和下划线 ( `[a-z0-9_.]`)。

![MSBuild 正常详细日志记录](../Images/5f0a2c0b26085aa1394003687cbcfd46.png)

### 解决方案

在要求的限制范围内重命名文件并再次构建。

虽然此错误消息可能会出现比文件名限制问题更多的情况，但文件名更改完全修复了此特定问题。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2014-10-14T02:30:40.027

对我来说类似的解决方案，我需要从资源文件夹中的 PNG 文件名中删除破折号（'-'）

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2013-06-21T12:33:07.597

在 Mono.Android 项目中，当资源/布局 axml 文件的名称中有空格时，会发生此错误，例如。“xxxx.xaml 的副本”

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-06-17T17:27:30.070

在 Mono.Android 项目中，当 Resources/Drawable 文件名在名称中包含 - 时，可能会发生此错误，例如：“File-Name.png 尝试下划线：“File_Name.png”

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-07-18T07:12:53.557

是的，记住不要有：

1.  以数字开头的资源、图像、资产、布局 axml
2.  用空格检查你的文件名。（我遇到了这个问题。我的一个布局在扩展名“.axml”之前有一个结束空格）
3.  检查您的任何图像、资源、文件、布局或其他是否有连字符 (-)。他们不应该在那里。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-10-29T09:58:05.923

对我来说，这是资源名称的问题。我的一张图片来自 MonoTouch，因此它的文件名在文件名中包含一个“@2x”。删除此 aapt.exe 后不再抱怨并构建了解决方案。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-04-26T14:59:35.387

请按照以下步骤确定问题：

1 - 在 Visual Studio 中：工具> 选项> 项目和解决方案> 构建和运行。

1.1 - 在下拉列表中：MSBuild 项目构建输出详细程度：> 诊断。

1.2 - 关闭对话框。

2 - 查看>输出（Ctrl + W，O）。

3 - 运行构建或重建。

在输出中找到这一行：

> C:\Program Files (x86)\MSBuild\Xamarin\Android\Xamarin.Android.Common.targets (1665.3): error MSB6006"aapt.exe"exited with code 1

就在此错误之上的是导致该错误的原因。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-08-26T07:56:09.840

检查 Drawable 文件夹中的图像/png。一旦从项目中排除它，它就会因为 png 图像而给我一个错误。工作正常...

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-09-17T14:38:39.613

我通过从android中删除包含业务逻辑的可移植库然后单独重建它来解决它。重建后，清理您的 android 项目并再次添加对可移植类库的引用。最后构建android项目

# android - 当edittext在动态创建的tablelayout中更改时更改textview，从1到50行？

> ID：11440745
> 
> 赞同：2
> 
> 时间：2012-07-11T20:16:24.433
> 
> 标签：android, textview, android-edittext

我不是程序员，我只是喜欢制作对我的工作有帮助的应用程序，所以我对正确编程不太了解。话虽如此，这就是我所反对的。我输入一个 1 到 100 的数字，然后我的应用程序将创建一个包含那么多行的可滚动表格布局。每一行都有一个文本视图、一个编辑文本和另一个文本视图，这是我的代码：

```
TableLayout tL = (TableLayout)findViewById(R.id.tableLayout1);
    // creates all the fields
    for(int i = 1; i <= numOfInjWells; i++) {
        TableRow tR = new TableRow(this);
        // creates the textView
        TextView tV1 = new TextView(this);
        tV1.setText("      " + i + ":    ");

        // add edit text
        EditText eT = new EditText(this);
        eT.setText("Meter Reading");
        eT.setInputType(InputType.TYPE_CLASS_NUMBER);

        TextView tV2 = new TextView(this);
        tV2.setText("");

        // add the TextView and the editText to the new TableRow
        tR.addView(tV1);
        tR.addView(eT);
        tR.addView(tV2);

        // add the TableRow to the TableLayout
        tL.addView(tR,new TableLayout.LayoutParams(
                LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));    
    } // end for statement 
```

所以当我在第一行的edittext（eT）中输入一个数字时，我希望它计算它与我存储在数据库中的数字之间的差异（我已经知道如何从数据库中获取我需要的特定数字）然后更改第一行中的 textview tV2 以便在不单击按钮的情况下显示差异。我遇到的问题是如何将第一行中的edittext（eT）与textview（tV2）相关联，因为所有edittext和textviews都具有相同的名称eT或tV2

感谢您的帮助，很抱歉我对编码知之甚少。

编辑：我考虑过添加

```
eT.setId(i);
tV2.setId(i); 
```

但我不知道如何在我的计算中使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T20:47:10.187

> 我遇到的问题是如何将第一行中的edittext（eT）与textview（tV2）相关联，因为所有edittext和textviews都具有相同的名称eT或tV2

一个简单的选项是为这两个设置`Views`它们之间有关系的 id，当某个特定`EditText`被修改时，您会发现哪个`TextView`靠近`EditText`更新它。例如设置ID：

```
// add edit text
EditText eT = new EditText(this);
et.setId(1000 + i);
eT.setText("Meter Reading");
eT.setInputType(InputType.TYPE_CLASS_NUMBER);

TextView tV2 = new TextView(this);
tV2.setId(2000 + i); // as you see the difference between the this id and the EditText is 1000
tV2.setText(""); 
```

因此，如果您有一个`EditText`要计算值的引用，您可以简单地通过添加`findViewById`的 id 来执行 a 。现在，我不知道您是如何根据从那想要的。`EditText``1000``EditText``TextWatcher``TextWatcher``int``EditText``TextView`

另外，请注意，如果您创建 50 行或更多行（因为这将导致您的布局中大约有 200 行），`Views`则每行 3 行（+ 1 `TableRow`）您可能会遇到应用程序的内存问题。`Views`可能值得一看`ListView`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T20:40:49.713

在查看了 listview 之后，我无法让他们使用 edittext，所以我回到了我的 tablelayout，这是最终的工作版本。

在这里，我创建了字段并将 textwatcher 添加到 edittext 以监视更改：

```
 TableLayout tL = (TableLayout)findViewById(R.id.tableLayout1);
    // creates all the fields
    for(int i = 1; i <= numOfInjWells; i++) {
        TableRow tR = new TableRow(this);
        // creates the textView
        TextView tV1 = new TextView(this);
        tV1.setText("       " + i + ":    ");

        // add edit text
        eT = new EditText(this);
        eT.setInputType(InputType.TYPE_CLASS_NUMBER);
        eT.setWidth(100);
        eT.setId(1000 + i);
        eT.addTextChangedListener(new CustomTextWatcher(eT));

        tV2 = new TextView(this);
        tV2.setText("");
        tV2.setId(2000 + i);

        // add the TextView and the editText to the new TableRow
        tR.addView(tV1);
        tR.addView(eT);
        tR.addView(tV2);

        // add the TableRow to the TableLayout
        tL.addView(tR,new TableLayout.LayoutParams(
                LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));    
    } // end for statement 
```

接下来我为我的 customtextwachter 创建了这个类：

```
private class CustomTextWatcher implements TextWatcher {
    private EditText mEditText;

    public CustomTextWatcher(EditText eT) {
        mEditText = eT;
    }

    public void beforeTextChanged(CharSequence s, int start, int count, int after) {
    }

    public void onTextChanged(CharSequence s, int start, int before, int count) {
    }

    public void afterTextChanged(Editable s) {
        // gets the change amount for each meter reading from the previous reading
            // this method does the work
        getMeterChange();

    }
} // end class CustomTextWatcher 
```

getMeterChange() 方法完成工作：

```
public void getMeterChange() {
    int preMeterReading = 0;
    int mReading = 0;

    try {
        cRWLogData.moveToPosition(recordLookUp - 1);
        preMeterReading = cRWLogData.getInt( 14 + rowChanged);
        // finds the edittext that has focus
        View currView = tL.findFocus();
        int currentid = tL.findFocus().getId();
        // gets the string from the edittext and changes it to a int
        EditText currentComponent = (EditText) currView;
        String eTValue = currentComponent.getText().toString();
        mReading = Integer.parseInt(eTValue);
        // calculates difference for what is entered and what is in database
        mChange = mReading - preMeterReading;
        // makes the textview in the same tablerow as the edittext active
        TextView tV2 = (TextView) findViewById(currentid + 1000);
        // sets the text of the textview
        tV2.setText("     " + mChange +"");
    } // end try
    catch (Exception e) {}

} // end getMeterChange 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T12:35:41.367

我知道这是旧的，但对于那些在搜索时发现它的人，我会更新一个更好的选择......

```
TableLayout tL = (TableLayout)findViewById(R.id.tableLayout1);
// creates all the fields
for(int i = 1; i <= numOfInjWells; i++) {
    TableRow tR = new TableRow(this);
    // creates the textView
    TextView tV1 = new TextView(this);
    tV1.setText("       " + i + ":    ");

    // add edit text
    eT = new EditText(this);
    eT.setInputType(InputType.TYPE_CLASS_NUMBER);
    eT.setWidth(100);

    tV2 = new TextView(this);
    tV2.setText("");
    eT.addTextChangedListener(new CustomTextWatcher(tV2));

    // add the TextView and the editText to the new TableRow
    tR.addView(tV1);
    tR.addView(eT);
    tR.addView(tV2);

    // add the TableRow to the TableLayout
    tL.addView(tR,new TableLayout.LayoutParams(
            LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));    
} // end for statement 
```

然后观察者：

```
private class CustomTextWatcher implements TextWatcher {
    private TextView mTextView;

    public CustomTextWatcher(TextView tV2) {
        mTextView = tV2;
    }

    public void beforeTextChanged(CharSequence s, int start, int count, int after) {}

    public void onTextChanged(CharSequence s, int start, int before, int count) {}

    public void afterTextChanged(Editable s) {
        // gets the change amount for each meter reading from the previous reading
            // this method does the work

        cRWLogData.moveToPosition(recordLookUp - 1);
        preMeterReading = cRWLogData.getInt( 14 + rowChanged);
        // edit text has just passed the value in Editable s
        mReading = Integer.parseInt(s.toString());
        // calculates difference for what is entered and what is in database
        mChange = mReading - preMeterReading;
        // sets the text of the textview
        mTextView.setText("     " + mChange +"");

    }
} // end class CustomTextWatcher 
```

将值传递给观察者是有原因的。使用框架为您完成硬码。

注意：我实际上并没有编译这个，你可能需要把 try/catch 放回去，为了清楚起见，我只是把它删除了。

# php - php联系表格电子邮件信息

> ID：11440747
> 
> 赞同：0
> 
> 时间：2012-07-11T20:16:26.303
> 
> 标签：php, javascript, html, css, contact

我做了一个联系表，它几乎可以正常工作。

```
<?php
$contact_name = $_POST['contact_name'];
$contact_email = $_POST['contact_email'];
$contact_tel = $_POST['contact_tel'];
$contact_call = $_POST['contact_call'];
$contact_message = $_POST['contact_message'];
$formcontent=" Von: $contact_name \n Tel.: $contact_tel \n Rückruf: $contact_call \n Nachricht: <br> $contact_message";
$recipient = "jonathanrobrecht@googlemail.com";
$subject = "Kontaktformular";
$from = '$contact_email';
$mailheader = "Von: $contact_email \r\n";
mail($recipient, $subject, $formcontent, $mailheader) or die("Error!");
echo "Thank You!" . " -" . "<a href='form.html' style='text-decoration:none;color:#ff0099;'> Return Home</a>";
?> 
```

那是php，当我在电子邮件客户端中收到一封电子邮件时，我收到了主题的信息，但没有发送电子邮件的人（我的网络服务器的地址已显示），但我希望填写的电子邮件是电子邮件.

我试过这个：

```
$subject = "Kontaktformular";
$from = '$contact_email'; 
```

$subject 确实有效，但 from 无效，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:18:55.847

```
$from = '$contact_email'; 
```

应该

```
$from = "$contact_email"; 
```

如果你单引号，PHP 将其解释为 '$contact_email'; 如果你双引号它，它会添加变量的值。

# php - 如何使用 htaccess 创建虚拟子域？

> ID：11440749
> 
> 赞同：1
> 
> 时间：2012-07-11T20:16:33.420
> 
> 标签：php, .htaccess, virtual, cpanel, wildcard-subdomain

我想为将与我们一起拥有网站的客户创建虚拟子域，但这些网站将在现实中从单个 url 提供服务；

客户请求网站 robshop.mywebsite.com，因此我们即时创建该网站，但内容实际上是从 mywebsite.com/websites/index.php?website=robshop 提供的

我该怎么做呢？

我的设置也是使用 PHP 和 cPanel / WHM 服务器。

这是我到目前为止尝试过的htaccess代码；

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^robshop.instamob.co.uk
RewriteCond %{REQUEST_URI} !instamob.co.uk/websites/index.php?website=robshop
RewriteRule ^(.*)$ instamob.co.uk/websites/index.php?website=robshop$1 [L] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:20:05.147

将其放在您的顶级目录中的 .htaccess 文件中：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^robshop.instamob.co.uk
RewriteCond %{REQUEST_URI} !websites/
RewriteRule ^(.*)$ websites/$1 [L] 
```

如果您需要 $_GET 提交，那么您需要在网站内为每个子域创建一个目录（即 instamob.co.uk/websites/robshop/），然后为要显示的该目录创建一个 index.php

# sql - 加入查询

> ID：11440751
> 
> 赞同：0
> 
> 时间：2012-07-11T20:16:37.473
> 
> 标签：sql, entity-framework

我正在使用 C# MVC3 和实体框架。我有一个包含 2 个 FK 的表。所以，我想执行这个查询：

```
SELECT *
  FROM TABLE1 f,
       TABLE2       r,
       TABLE3       c
 WHERE f.codx = r.codx
   AND f.cody = c.cody 
```

表 1 = 包含 FK

所以，我需要在他的 DbSet 中包含对表的引用.... 但是，如何在我的 DbSet 中添加两个表？我从另一个类收到这个 DbSet 并在我的查询中添加的问题：

```
return ((from table1 in this.GetContext<Fake>().TABLE1.Include("TABLE2") //Here I need to Include another table, was working with just one
        where (
      ............. )
        select).ToList<Table1>()); 
```

我怎样才能做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:22:50.053

您可以将多个`.Include`方法链接在一起：

```
return ((from table1 in this.GetContext<Fake>().TABLE1.Include("TABLE2").Include("TABLE3")
        where (
      ............. )
        select).ToList<Table1>()); 
```

# java - 如何使用分隔符“|”分割字符串

> ID：11440752
> 
> 赞同：-1
> 
> 时间：2012-07-11T20:16:41.133
> 
> 标签：java, regex

> **可能重复：**
> [Java split() 方法在最后去除空字符串？](https://stackoverflow.com/questions/545957/java-split-method-strips-empty-strings-at-the-end)

我们有一个需求，比如读取文件内容并将数据上传到数据库。文件内容将由分隔符“|”分隔 像这样

```
4000|name|state|city|zip||country|||address|| 
```

对于“|”之间没有数据的某些列，我也可以有空值。例如'||' 邮编和国家之间。我的问题是 string.split("//",'|') 在空值和返回数组之间考虑空值作为元素。但尾随的'||' 不考虑地址后。如上面示例中所使用的，当我使用 string.split("//",'|') 时，我会得到一个数组大小为 11 的字符串数组元素，但我只得到 10。最后一个 null 没有被检索。任何人都可以帮助解决问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T20:21:18.237

只需在类中使用常规[`split(String, int)`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#split%28java.lang.String,%20int%29)方法`String`：

```
String line = "4000|name|state|city|zip||country|||address||";
String data[] = line.split("\\|", -1); // escaped, because of regular expressions 
```

减一是一种约定，表示将根据需要拆分字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T20:32:14.570

Yes to use split 是显而易见的，但你也可以考虑这个选项：

为什么不直接使用 string.indexOf("|", indexToStartFrom) ？有点麻烦，但可以肯定地工作，而不必过多考虑正则表达式。

* * *

或者有商业友好的图书馆 OpenCsv [http://opencsv.sourceforge.net/](http://opencsv.sourceforge.net/)。阿帕奇 2.0 许可证

# c# - VS 隔离外壳的自定义工具窗口

> ID：11440756
> 
> 赞同：0
> 
> 时间：2012-07-11T20:16:56.597
> 
> 标签：c#, visual-studio-2010, visual-studio, visual-studio-sdk

我正在尝试为我的隔离外壳（VS2010）创建一些自定义工具窗口。下面是工具窗口的代码。

```
[Guid("xxxx")]
public class ToolWindow1: ToolWindowPane
{
    public ToolWindow1()
        : base(null)
    {
        this.Caption = "BAM0";
    }
} 
```

我正在尝试通过打开工具窗口

```
[ProvideToolWindow(typeof(ToolWindow1))]
...
ToolWindowPane window = this.FindToolWindow(typeof(ToolWindow1), 0, true); 
```

但是，我在 FindToolWindow 调用中收到 TargetInvocationException，我不确定为什么。我在显示自定义工具窗口时是否遗漏了什么？

谢谢！

编辑：我的项目引用没有正确设置。我最终合并了两个项目，工具窗口现在正确显示。

# jquery - 全局 $.ajaxSetup() 的 jQuery 异常可能吗？

> ID：11440757
> 
> 赞同：12
> 
> 时间：2012-07-11T20:16:57.220
> 
> 标签：jquery, ajax

我使用以下内容来捕获未经授权的访问并强制登录：

```
$.ajaxSetup({
    statusCode: {
        401: function(){
            //do stuff
        }
    }
}); 
```

效果很好......当访问我的服务器（域）上的资源时，但现在我试图通过 ajax 调用使用第 3 方 API 资源，并且它们的 401 也被此捕获。那么，我怎么能：

1.  重写上面的代码以仅从我的域中捕获 401，或者
2.  对上述代码进行 $.ajax() 调用（使用不同的错误处理程序）

非常感谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-12T13:41:23.613

通过实验，我找到了答案。$.ajaxSetup() 基本上为任何 $.ajax() 请求设置默认值。但是，可以针对特定请求覆盖全局设置，如下所示：

```
$.ajaxSetup({
    statusCode: {
        401: function(){
            //this will catch any and all access denied errors
        }
    }
});

$.ajax({
    type: 'GET',
    dataType: 'json',
    url: someresouceurl,
    statusCode: {
        401: function(){
            //except this one!
        }
    },
    success: function(data) {
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T14:03:57.723

在您的 401 函数中扩展@MrOBrian 的答案，`this`设置为包含有关 AJAX 请求的信息的设置对象。属性之一是`url`。您可以阅读此内容，并检查它是否是您的 URL。

```
$.ajaxSetup({
    statusCode: {
        401: function(){
            var url = this.url;
            if(url === myurl){ // check if url is yours
            }
            else{
                // not your URL, do nothing
                return;
            }
        }
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T20:26:22.413

来自 jQuery API

`If the request is successful, the status code functions take the same parameters as the success callback; if it results in an error, they take the same parameters as the error callback.`

我建议查看您获得的 jqXHR 参数，看看您是否可以将其缩小到您的域，但我对 jQuery 的这方面了解不足，无法为您提供准确的代码。

# php - 按钮并选择在表单中重叠的选项

> ID：11440763
> 
> 赞同：1
> 
> 时间：2012-07-11T20:17:23.493
> 
> 标签：php, html, css, forms

请在按钮和选择选项与表单的一部分重叠时，我正在尝试在水平方向上制作表单，请帮忙看看

这是相关的CSS

```
 form.ilistbar label {
    font-weight:bold;
    font-size: small;

}
form.ilistbar label.fixedwidth {
    display:block;
    width: 240px;

}
.action-box .listbar {
    padding: 12px 0 12px 10px;
    margin: 0 0 0 220px;
    border-left: 1px solid black;
    min-height: 200px;
    margin: 0;
}
.action-box .titlebar {
  width: 100%;
  padding: 12px 10px;
  margin: 0;
  float: none;
}
.action-box .listbar {
padding: 12px 0 12px 10px;
margin: 0 0 0 220px;
border-left: 1px solid black;
min-height: 200px;
margin: 0;
}
.action-box .titlebar {
  width: 100%;
  padding: 12px 10px;
  margin: 0;
  float: none;
}

 form div {
  display: inline-block;
  width: 100px;
  vertical-align: top;

}

form div label {
  display: inline-block;
} 
```

这是表单的相关 html 标记

```
 <div class="primary">
<div class="action-box rounded">
<div class="titlebar">
<h2>Order Form</h2>
</div>
<div class="listbar">
<?php
if( isset($_POST['submit']) ){
$submit = $_POST['submit'];

//form data
$Sname = mysql_real_escape_string(htmlentities(strip_tags($_POST['Sname'])));
$Pname = mysql_real_escape_string(htmlentities(strip_tags($_POST['Pname'])));
$Pidno = mysql_real_escape_string(htmlentities(strip_tags($_POST['Pidno'])));
$Psize = mysql_real_escape_string(htmlentities(strip_tags($_POST['Psize'])));
$Pcolour = mysql_real_escape_string(htmlentities(strip_tags($_POST['Pcolour'])));
$Pquantity = $_POST['Pquantity'];
$Weblink = mysql_real_escape_string(htmlentities(strip_tags($_POST['Weblink'])));
$Price = mysql_real_escape_string(htmlentities(strip_tags($_POST['Price'])));
$comment = mysql_real_escape_string(htmlentities(strip_tags($_POST['comment'])));
$date = date("Y-m-d");

//echo " ('','$Sname','$Pname','$Pidno','$Psize','$Pcolour','$Pquantity','$Weblink','$Price','$Uname')";
if('POST' === $_SERVER['REQUEST_METHOD']) 

{
if ($Sname&&$Pname&&$Pidno&&$Weblink&&$Price)
{
if (is_numeric($Price))
{
    $repeatheck = mysql_query("SELECT * FROM repplac WHERE Uname = '{$_SESSION['username']}' AND Pidno ='$Pidno' AND Sname='$Sname' AND Pname='$Pname'");
    $count = mysql_num_rows($repeatheck);
if($count!=0)
{
    die ('PRODUCT ALREADY IN BASKET YOU CAN INCREASE OR DECREASE QUANTITY, <a href="youraccount.php">CLICK TO GO BACK TO YOUR LIST</a>');
}
else
//echo'$Price';
$tprice = $Price * $Pquantity;
//echo"$tprice";
$queryreg = mysql_query("
INSERT INTO repplac VALUES ('','$Sname','$Pname','$Pidno','$Psize','$Pcolour','$Pquantity','$Weblink','$Price','$comment','$tprice','$date','{$_SESSION['username']}','')
")or die(mysql_error());
}
else
echo 'price field requires numbers';
}
else
echo 'please fill in all required * fields ';
}
}
?>
<form action='youraccount.php' method='Post' class='ilistbar'>
    <!--<div>
    <label for='shoppinglist' class='fixedwidth'></label>
    <textarea type='text' name='shoppinglist' id='username' cols='100' rows='15'></textarea>
    </div> -->
    <div>
    <label for='Sname' class='fixedwidth'> * Shop name</label>
    <input type='text' name='Sname' id='Sname'/>
    </div>
    <div>
    <label for='Pname' class='fixedwidth'> * Product name</label>
    <input type='text' name='Pname' id='Pname'/>
    </div>
    <div>
    <label for='Pidno' class='fixedwidth'> * Product id no</label>
    <input type='text' name='Pidno' id='Pidno'/>
    (This should be unique for each product)
    </div>
    <div>
    <label for='Psize' class='fixedwidth'>Product size</label>
    <input type='text' name='Psize' id='Psize'/>
    </div>
    <div>
    <label for='Pcolour' class='fixedwidth'>Product colour</label>
    <input type='text' name='Pcolour' id='Pcolour'/>
    </div>
    <div>
    <label for='Pquantity' class='fixedwidth'>Product quantity</label>
    <select name="Pquantity" id="Pquantity">
      <option value="1">1</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5</option>
      <option value="6">6</option>
      <option value="7">7</option>
      <option value="8">8</option>
      <option value="9">9</option>
      <option value="10">10</option> 
</select>
    </div>
    <div>
    <label for='Weblink' class='fixedwidth'> * Web link</label>
    <input type='text' name='Weblink' id='Weblink'/>
    </div>
    <div>
    <label for='Price' class='fixedwidth'> * Price GBP</label>
    <input type='text' name='Price' id='Price'/>
    Please valid format is (.) for decimal
    </div>
    <div>
    <label for='comment' class='fixedwidth'> Extra info</label>
    <input type='text' name='comment' id='comment'/>
    Please give different colours , sizes of the same products,discount codes, and other information that you would like us to use
    </div>
    <div>

    <div class='buttonarea'>
            <p>
            <input type='submit' name='submit' value='Add'>
            </p>
            </div>
            </p>
    </form>
</div>
</div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T02:49:13.713

看看这个 => [http://jsfiddle.net/L9R3B/](http://jsfiddle.net/L9R3B/) 问题在于输入的宽度，它们导致其父 div 溢出，与标签相同。

# android - 如何更改 root android 设备上文件的组 id？

> ID：11440770
> 
> 赞同：13
> 
> 时间：2012-07-11T20:17:56.600
> 
> 标签：android, root

我正在尝试将我在一个应用程序中编写的文件的访问权限授予另一个应用程序。 `chgrp`在 adb shell() 中不可用`command 'chgrp' not found`我已经安装了 BusyBox，但为了访问`chgrp`.

例如，我使用该命令`chown app_79 file.txt`并且它有效。但是当我尝试`chgrp app_79 file.txt`它总是返回类似`chgrp: unknown group app_79`

我用谷歌搜索了一堆，发现大多数 linux 系统都有一个`/etc/group`存储该系统组信息的文件，但它在 Android 中不存在。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-07-11T21:18:21.633

使用内置工具，而不是busybox，它会是

```
chown uid.gid filename 
```

正如马特指出的那样，这些 id 可能必须是数字。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-11T21:16:24.190

使用`busybox chown uid.gid file.txt`并将 UID 和 GID 指定为数字而不是名称。`app_79`可能[对应](http://androidxref.com/2.3.6/xref/system/core/include/private/android_filesystem_config.h)于 ID 10079（以确保您可以重新检查它`busybox ls -l -n /data/data`）：

```
busybox chown 10079.10079 file.txt 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-11T21:14:27.800

[在此处](https://github.com/keesj/gomo/wiki/AndroidSecurityUserAndGroups)找到一些有关如何硬编码某些组 ID 的信息。我也有以前的知识`/data/system/packages.list`并`/data/system/packages.xml`包含应用程序的 UID，它们都类似于 10000+x。我现在知道的是，当你 ls -l 时，x 是“app_”之后的数字。

所以，奇怪的是你可以`chgrp 10079 file.txt`但你不能`chgrp app_79 file.txt`。

希望这可以帮助某人。

# c++ - Project Euler 18 - C++ 通过引用传递数组

> ID：11440771
> 
> 赞同：0
> 
> 时间：2012-07-11T20:17:57.737
> 
> 标签：c++, arrays

请参阅：[http](http://projecteuler.net/problem=18) ://projecteuler.net/problem=18 ，以获得比我在这里给出的更好的问题解释。

我喜欢我的算法；这不是蛮力。我查看金字塔底部的所有 3x3 三角形以计算最佳路线，然后将该值分配回该行。这就是为什么我的函数被称为 ConsolidateBottomThreeRows 的原因——我最终会从下往上计算最佳路径，每次都分配到底部 3 行的最顶部，创建一个越来越小的金字塔，直到我的第一行包含答案.

我的问题不是算法问题，只是语法问题。我无法弄清楚 [是的，即使使用谷歌搜索] 如何正确传递我的数组。这是我尝试编译时的输出：

```
C:\MyApps\Euler>g++ Prob_18.cpp -o Prob_18
Prob_18.cpp: In function 'void ConsolidateBottomThreeRows(int*, int*, int*)':
Prob_18.cpp:17:20: error: request for member 'size' in 'top', which is of non-class type 'int*' 
```

我的代码：

```
#include <iostream>
using namespace std;

int CrunchSmallTriangle(int top[], int middle[], int bottom[])
{
    int biggest=0;
    if(middle[0]+bottom[0] > biggest) biggest=middle[0]+bottom[0];
    if(middle[0]+bottom[1] > biggest) biggest=middle[0]+bottom[1];
    if(middle[1]+bottom[0] > biggest) biggest=middle[1]+bottom[0];
    if(middle[1]+bottom[1] > biggest) biggest=middle[1]+bottom[1];
    return biggest+top[0];
}

void ConsolidateBottomThreeRows(int top[], int middle[], int bottom[])
{
    int SmallTop[0], SmallMiddle[2], SmallBottom[3];
    for(int x=0;x<top.size();x++)
    {
        SmallTop[0]=top[x];
        SmallMiddle[0]=middle[x];
        SmallMiddle[1]=middle[x+1];
        SmallBottom[0]=bottom[x];
        SmallBottom[1]=bottom[x+1];
        SmallBottom[2]=bottom[x+2];
        top[x]=CrunchSmallTriangle(SmallTop, SmallMiddle, SmallBottom);
    }
}

int main()
{
    int row1[1]={75};
    int row2[2]={95,64};
    int row3[3]={17,47,82};
    int row4[4]={18,35,87,10};
    int row5[5]={20,4,82,47,65};
    int row6[6]={19,1,23,75,3,34};
    int row7[7]={88,2,77,73,7,63,67};
    int row8[8]={99,65,4,28,6,16,70,92};
    int row9[9]={41,41,26,56,83,40,80,70,33};
    int row10[10]={41,48,72,33,47,32,37,16,94,29};
    int row11[11]={53,71,44,65,25,43,91,52,97,51,14};
    int row12[12]={70,11,33,28,77,73,17,78,39,68,17,57};
    int row13[13]={91,71,52,38,17,14,91,43,58,50,27,29,48};
    int row14[14]={63,66,4,68,89,53,67,30,73,16,69,87,40,31};
    int row15[15]={4,62,98,27,23,9,70,98,73,93,38,53,60,4,23};

    ConsolidateBottomThreeRows(row13, row14, row15);
    ConsolidateBottomThreeRows(row11, row12, row13);
    ConsolidateBottomThreeRows(row9, row10, row11);
    ConsolidateBottomThreeRows(row7, row8, row9);
    ConsolidateBottomThreeRows(row5, row6, row7);
    ConsolidateBottomThreeRows(row3, row4, row5);
    ConsolidateBottomThreeRows(row1, row2, row3);

    cout<<row1[0];
} 
```

任何帮助是极大的赞赏。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T20:20:59.207

数组没有`size()`方法！您要么需要将大小作为单独的参数传递给函数，要么使用容器（例如`std::vector`）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-11T20:25:56.107

首先，我同意其他答案，即从原始 C 数组切换到`std::array<>`或`std::vector<>`将是最好的选择。然而，话虽如此，正如克里斯评论的那样，因为您的 C 数组是静态大小的，所以制作`ConsolidateBottomThreeRows`成函数模板也可以实现以下功能：

```
template<std::size_t TopN, std::size_t MidN, std::size_t BotN>
void ConsolidateBottomThreeRows(int (&top)[TopN],
                                int (&middle)[MidN],
                                int (&bottom)[BotN])
{
    int SmallTop[1], SmallMiddle[2], SmallBottom[3];
    for (std::size_t x = 0; x != TopN; ++x)
    {
        SmallTop[0] = top[x];
        SmallMiddle[0] = middle[x];
        SmallMiddle[1] = middle[x + 1];
        SmallBottom[0] = bottom[x];
        SmallBottom[1] = bottom[x + 1];
        SmallBottom[2] = bottom[x + 2];
        top[x] = CrunchSmallTriangle(SmallTop, SmallMiddle, SmallBottom);
    }
} 
```

请注意，您的声明`SmallTop`尺寸错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T20:20:16.933

您需要`top.size()`用传入函数的大小进行替换。更好的是，不要使用数组而是使用向量。然后你`top.size()`会工作。

# facebook - 不能跳过“publish_permission”，总是要求它

> ID：11440776
> 
> 赞同：1
> 
> 时间：2012-07-11T20:18:26.060
> 
> 标签：facebook, permissions

这是一个可选权限，但我无法在我的画布应用程序中跳过它，当我在此权限上单击“跳过”时，我的页面被重定向以一次又一次地询问此权限。任何人都知道为什么会这样？

非常感谢！:)

```
<!-- BEGINNING OF THE INDEX.PHP CODE -->
<?php

  //SOLVES INFINITE LOOP ON IE
  header('P3P: CP="IDC DSP COR ADM DEVi TAIi PSA PSD IVAi IVDi CONi HIS OUR IND CNT"');

  // Enforce https on production
  if (substr(AppInfo::getUrl(), 0, 8) != 'https://' && $_SERVER['REMOTE_ADDR'] != '127.0.0.1') {
    header('Location: https://'. $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI']);
    exit();
  }

  $facebook = new Facebook(array(  'appId'  => AppInfo::appID(),  'secret' => AppInfo::appSecret(), ));

  $user_id = $facebook->getUser();

  //Check if we have an user_id
  if ($user_id!="0") {

        try {
          // Fetch the viewer's basic information
          $basic = $facebook->api('/me');
        } catch (FacebookApiException $e) {
          // If the call fails we check if we still have a user. The user will be
          // cleared if the error is because of an invalid accesstoken
          if (!$facebook->getUser()) {
            header('Location: '. AppInfo::getUrl($_SERVER['REQUEST_URI']));
            exit();
          }
        }

  } else { 

    // If the user is not connected to the application, redirect the user to authentication page 
    $login_url = $facebook->getLoginUrl(array('redirect_uri' => "https://apps.facebook.com/APP_NAME_SPACE/",'scope' =>  'publish_stream,email','display' => 'page')); 

    ?><html xmlns="https://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
       <head>
       </head>
       <body>
       <script type="text/javascript"> top.location.href='<?php echo $login_url; ?>'</script> 
      </body>
      </html><?php   

        exit();
  }

  if(isset($basic)) {

    $locale=idx($basic, 'locale');
    $name=he(idx($basic, 'name'));
    $email=he(idx($basic, 'email'));

  } else {

    // IF the user is not loggin on facebook, redirect the user to facebook login page
    ?>
  <script type="text/javascript">
    var oauth_url = 'https://www.facebook.com/dialog/oauth/';
    oauth_url += '?client_id=APP_ID';
     oauth_url += '&redirect_uri=' + encodeURIComponent('https://apps.facebook.com/APP_NAME_SPACE/');
     oauth_url += '&scope=publish_stream,email'
     window.top.location = oauth_url;
    </script>
<?php
    exit();
    //ends execution if there's no login
  }

  ?>
<html>
 // APP HTML CODE
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T20:20:48.137

如果没有看到您的身份验证代码，很难确定，但我相信您有

*   检查授予了哪些权限，如果缺少某些权限，则重定向回对话框，或者
*   以 JS SDK 中指定的某些权限调用`FB.login()`，类似于

如果您不考虑用户跳过请求，两者都会导致循环

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-13T17:12:23.647

显然，他正在使用 facebook sdk 库。我从来没有听说过跳过权限。当需要构建用于身份验证的 URL 时，您可以将它们设置在适当的函数中。检索登录身份验证流程是值得的，但尝试`oauth_url += '&scope=email'`而不是您所拥有的？或者，您可以尝试构建没有范围的 oauth url，并查看应用程序要求的权限。如果它要求特定的权限，请检查登录功能，看看是否已经设置了一些权限。如果我没记错的话，它应该在 facebook.php 文件中。

# certificate - NAnt 获取任务 - 根据验证程序，远程证书无效

> ID：11440783
> 
> 赞同：0
> 
> 时间：2012-07-11T20:18:48.130
> 
> 标签：certificate, ssl-certificate, nant

我正在使用 NAnt 从带有自签名证书的服务器下载文件，它给我一个错误，指出“根据验证程序，远程证书无效”。

我已将证书（根据此[过程](http://technet.microsoft.com/en-us/library/cc754841.aspx#BKMK_addlocal)）导入到执行脚本的机器上，所以我知道它已加载，但我仍然收到错误消息。

任何人都可以就可能导致这种情况的原因提出建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T20:18:48.580

我的问题（可能不适用于您的环境）是我在我的 NAnt 脚本中通过其 IP 地址引用了服务器，但服务器的自签名证书引用了服务器主机名。

当我为 URL 调整我的 NAnt 属性以使用主机名而不是 IP 地址时，它能够找到适用的证书并下载文件。

# c - 对于 unistd.h，mkdtemp 需要 _DARWIN_C_SOURCE

> ID：11440787
> 
> 赞同：2
> 
> 时间：2012-07-11T20:18:58.557
> 
> 标签：c, linux, macos, posix

我有点不解。我有我编译的项目

```
CFLAGS=-g -O2 -Wall -Wextra -Isrc/main -pthread -rdynamic -DNDEBUG $(OPTFLAGS) -D_FILE_OFFSET_BITS=64 -D_XOPEN_SOURCE=700 
```

现在我想使用`mkdtemp`，因此包括`unistd.h`

```
char *path = mkdtemp(strdup("/tmp/test-XXXXXX")); 
```

在 MacOSX 上，编译给出了一些警告

```
warning: implicit declaration of function ‘mkdtemp’
warning: initialization makes pointer from integer without a cast 
```

但编译通过。虽然`mkdtemp`确实返回非 NULL 路径，但访问它会导致 EXC_BAD_ACCESS。

**问题1：模板是`strdup()`ed，结果非NULL。这到底怎么会导致 EXC_BAD_ACCESS？**

现在进一步深入兔子洞。让我们摆脱警告。检查`unistd.h`我发现预处理器隐藏的声明。

```
#if     !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
...
char    *mkdtemp(char *);
...
#endif 
```

添加`-D_DARWIN_C_SOURCE`到构建中使所有问题都消失了，但给我留下了特定于平台的构建。10.6 手册页只是说

```
 Standard C Library (libc, -lc)
 #include <unistd.h> 
```

从构建中删除`_XOPEN_SOURCE`是在 OSX 上工作的，但随后它无法在 Linux 下编译

```
warning: ‘struct FTW’ declared inside parameter list
warning: its scope is only this definition or declaration, which is probably not what you want
In function ‘tmp_remove’:
warning: implicit declaration of function ‘nftw’
error: ‘FTW_DEPTH’ undeclared (first use in this function)
error: (Each undeclared identifier is reported only once
error: for each function it appears in.)
error: ‘FTW_PHYS’ undeclared (first use in this function) 
```

**问题 2：那么您将如何解决这个问题？**

我发现的唯一解决方法是`#undef`在包含之前 _POSIX_C_SOURCE `unistd.h`...但这感觉就像一个丑陋的黑客。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T23:57:21.067

你在这里问了两个问题，我只回答第一个问题：

> 问题1：模板是strdup()ed，结果非NULL。这到底怎么会导致 EXC_BAD_ACCESS？

正如上面的警告告诉你的那样：

> 警告：函数“mkdtemp”的隐式声明</p>

这意味着它找不到`mkdtemp`. 根据 C 规则，这是允许的，但它假设函数返回一个 int。

> 警告：初始化使指针从整数而不进行强制转换

您告诉编译器“我有一个返回 int 的函数，我想将值存储在 char* 中”。它警告你这是一个坏主意。您仍然可以这样做，因此它可以编译。

但是想想运行时会发生什么。您链接到的实际代码返回 64 位 char*。然后您的代码将其视为必须转换为 64 位 char* 的 32 位 int。这有多大可能起作用？

这就是为什么您不忽略警告的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T00:02:52.247

现在是第二个问题：

> 问题 2：那么您将如何解决这个问题？

您的问题是您明确传递了 -D_XOPEN_SOURCE=700，但您使用的函数 mkdtemp 未在您要求的标准中定义。这意味着您的代码不应该工作。它在 linux 上工作的事实并不意味着你的代码是正确的或可移植的，只是你碰巧在一个平台上很幸运。

因此，有两种相当明显的方法可以解决此问题：

1.  如果要使用 _XOPEN_SOURCE=700，请重写代码以仅使用该标准中的函数。

2.  如果您只是将 _XOPEN_SOURCE=700 添加为一个您并不真正理解的 hack，因为它似乎解决了 linux 上的一些其他问题，请找到在 linux 上解决该问题的正确方法。

结果可能是在一个或另一个平台上存在错误，因此没有正确的方法来修复它。或者，更有可能的是，您正在使用可以在不同平台上压缩的非标准函数的组合，每个平台上都有一组不同的标志。在这种情况下，您的 Makefile（或任何驱动构建的文件）将必须将不同的标志传递给不同平台上的编译器。这对于跨平台项目来说是非常典型的；很高兴您只需要担心一个标志，并且没有构建价值 3000 行的 autoconf。

# hadoop - 在目录上运行字数统计或 Pig 脚本以在单独的文件中生成结果

> ID：11440790
> 
> 赞同：0
> 
> 时间：2012-07-11T20:19:06.070
> 
> 标签：hadoop, apache-pig

我是 Hadoop/Pig 的新手。

我有一个包含多个文件的目录。现在我需要对这些进行字数统计。我可以使用 Hadoop 示例示例 wordcount 并在目录上运行它以获取输出，但输出将在单个文件中。如果我希望每个文件的输出都在不同的文件中，我该怎么办？我也可以用猪。并将目录作为 pig 的输入。但是如何读取目录中的文件名，然后将其提供给 LOAD？我的意思是：
假设我有一个目录 Test ，其中有 5 个文件 test1、test2、test3、test4、test5。现在我想将每个文件的字数分别放在一个单独的文件中。我知道我可以提供个人姓名并这样做，但这需要很多时间。我是否可以从目录中读取文件名并将它们作为输入提供给猪的 LOAD？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T01:34:03.090

如果您使用的是 Pig 版本 0.10.0 或更高版本，则可以利用[源标记](http://hadoopified.wordpress.com/2012/04/22/pigstorage-options-schema-and-source-tagging/)和[MultiStorage](http://pig.apache.org/docs/r0.10.0/api/org/apache/pig/piggybank/storage/MultiStorage.html)的组合来跟踪文件。

例如，如果您有一个`pigin`包含文件和内容的输入目录，如下所示：

```
pigin
|-test1 => "hello"
|-test2 => "world"
|-test3 => "Apache"
|-test4 => "Hadoop"
|-test5 => "Pig" 
```

以下脚本将读取每个脚本并将每个文件的内容写入不同的目录。

```
%declare inputPath 'pigin'
%declare outputPath 'pigout'

-- Define MultiStorage to write output to different directories based on the
-- first element in the tuple
define MultiStorage org.apache.pig.piggybank.storage.MultiStorage('$outputPath','0');

-- Load the input files, prepending each tuple with the file name
A = load '$inputPath' using PigStorage(',', '-tagsource');

-- Write output to different directories
store A into '$outputPath' using MultiStorage(); 
```

上面的脚本将创建一个输出目录树，如下所示：

```
pigout
|-test1
| `-test1-0 => "test1   hello"
|-test2
| `-test2-0 => "test2   world"
|-test3
| `-test3-0 => "test3   Apache"
|-test4
| `-test4-0 => "test4   Hadoop"
|-test5
| `-test5-0 => "test5   Pig" 
```

`-0`文件名末尾的 对应于产生输出的化简器。如果你有多个 reducer，你可能会在每个目录中看到多个文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T10:26:42.743

您可以扩展 PigStorage 代码以将文件名添加到元组，请参阅[代码示例](https://cwiki.apache.org/PIG/faq.html)查找问题“问：我从包含不同文件的目录加载数据。如何找出数据来自哪里？”。对于输出，您可以对 PigStorage 进行类似的扩展以写入不同的输出文件。

# javascript - 一条 Javascript 行导致文件的其余部分无法运行

> ID：11440797
> 
> 赞同：0
> 
> 时间：2012-07-11T20:19:28.190
> 
> 标签：javascript

我有一个 Javascript 文件，用于检查表单的输入。但是，当我取消注释注释行时，javascript 文件无法正常运行，即使某些字段为空白，也会提交表单。事实上，Javascript 文件甚至没有进入第二个警报函数。到底是怎么回事？

```
function checkLogin()
{
    alert("HERE");
    //document.getElementById("errors").style.display = "none";
    var form = document.getElementById("form1");
    var problems = false;
    document.getElementById("errorJS").style.display = "none";
    document.getElementById("errorJS").innerHTML = "";
    alert("test");
    if(form.email.value.length < 1)
    {
        document.getElementById("errorJS").innerHTML += "Please enter your email address. <br />";
        problems = true;
        document.getElementById("errorJS").style.display = "block";
    }
    if(form.pword.value.length < 1)
    {
        document.getElementById("errorJS").innerHTML += "Please enter your password.";
        problems = true;
        document.getElementById("errorJS").style.display = "block";
    }
    alert(!(problems));
    return !(problems);
} 
```

就是这样，该行返回null。谢谢你的回答。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T20:23:51.660

简短：它在某处抛出错误（假设在注释掉的行中），这会停止脚本的执行（不警告，不停止提交）。

这个错误似乎是`document.getElementById("errors")`返回`null`，在尝试访问它的`style`属性时抛出错误。你应该抓住这种情况：

```
var errors = document.getElementById("errors");
if (errors)
    errors.style.display = "none"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T20:21:44.670

尽管您没有准确定义“无法正常运行”的含义，并且您没有提供任何错误信息（浏览器肯定会提供给*您*），但我会说这`document.getElementById("errors")`是返回 null。这意味着您的文档中不存在 ID 为 的元素`errors`。

在尝试访问其上的属性之前检查是否`document.getElementById("errors")`返回了可用的东西将是向前迈出的一大步。确保您的文档与您假设的一样。

# macos - Firefox 在地址栏中显示奇怪的字符串

> ID：11440799
> 
> 赞同：0
> 
> 时间：2012-07-11T20:19:28.830
> 
> 标签：macos, .htaccess, firefox

我最近看到过几次，但从来没有注意过。现在它引起了问题，尽管我需要弄清楚。

有时，当我在 Mac 上访问 Firefox 13 中的站点时，我会在地址栏中的 URL 末尾附加这个奇怪的字符串。

它总是以“#.T_”开头，通常类似于“#.T_3HiHDevA8”。

对于我的生活，我无法弄清楚是什么原因造成的。它仅在第一次加载时出现

我确实有一些重写正在进行，但我不明白这怎么会添加到位置栏。这是我的 .htaccess 文件。

```
RewriteCond %{REQUEST_URI} !=/
RewriteRule ^([a-zA-Z_]+)/?$ / [QSA] 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T23:14:39.640

> 'qsappend|QSA'（查询字符串追加）
> 
> 此标志强制重写引擎将替换字符串的查询字符串部分附加到现有字符串，而不是替换它。当您想通过重写规则向查询字符串添加更多数据时，请使用此选项。

[QSA 标志](http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html)指示附加替换字符串的查询字符串。

再看一眼：

```
^([a-zA-Z_]+)/?$ 
```

1.  ^ = URL 的开头
2.  ( ) = 对一系列图案元素进行分组
3.  [ ] = 表示一组可能的匹配项
4.  a-zA-Z_ = 仅字母数字字符和下划线“_”
5.  + = 表示有一个或多个前面的元素
6.  / = URL 中的正斜杠
7.  ? = 匹配前面 0 次或 1 次
8.  $ = URL 结束

将上述逻辑应用于您的规则：`RewriteRule ^([a-zA-Z_]+)/?$ / [QSA]`将根据上述细分将匹配重定向到“/”并附加查询字符串，假设 URL 不等于“/”。

# c++ - 从 Linux 移植到 Windows，tm.sys

> ID：11440801
> 
> 赞同：0
> 
> 时间：2012-07-11T20:19:32.967
> 
> 标签：c++, c, windows, linux, wdk

如果这个问题含糊不清，我深表歉意，但我真的无法更具体。我有一个相当大的项目要移植到 Windows。最后让它用 cl 编译，并用 link.exe 链接后，我运行它并得到以下“系统错误”：

> 程序无法启动，因为您的计算机缺少 C:\Windows\SYSTEM32\tm.sys。尝试重新安装程序以解决此问题。

这是一个无需安装的控制台应用程序。对您有什么意义吗`tm.sys`，也许是我错过了 Windows 在编译时允许但现在解释奇怪的 Linux 依赖项？我正在寻找提示/猜测/任何可以运行的东西，因为我完全意识到我的描述（以及缺少代码示例）并不令人满意。

它是一个 C 项目，混合了一些 C++ 代码（C++ 可能占 1%），并且是使用 WDK 构建的。编译产生 5 个静态 .lib 文件和 1 个 .exe 文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T19:08:50.407

问题存在于`ntoskrnl.lib`. 我从源文件中删除了那个不必要的库，并且可执行文件运行良好。我不确定 的重要性`tm.sys`，但吸取的教训：了解您的依赖关系！

# ruby - 获取一个字符串块并将它们存储在一个数组中

> ID：11440803
> 
> 赞同：0
> 
> 时间：2012-07-11T20:19:36.363
> 
> 标签：ruby

是否可以编写一个函数，该函数接受一个字符串块，对字符串执行某些操作，然后返回一个包含字符串的数组？

```
def collect_string(&block)
   # just toss them into an array and return it
   return ...
end

a = collect_string {
   "string 1"
   "string 2"
   "string 3"
} 
```

当我打印出是什么时`a`，我应该得到

```
["string 1", "string2", "string3"] 
```

现在假设我决定改变主意，想先用琴弦做更多的事情。也许我想先删除所有的元音，或者只抓住前 3 个字符。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T20:22:10.380

这真的**不是**积木的用途。无论如何，您都将创建一个字符串数组，那么为什么不使用数组开始呢？

```
def collect_string &block
  v = block.call
  # do something with v
end

# block returning array
a = collect_string {[
   "string 1",
   "string 2",
   "string 3"
]} 
```

如果您在示例中使用块，则它将仅返回“字符串 3”，即最后一个评估的表达式。以前的字符串丢失。

# c++ - 为什么我不能在类中定义变量？

> ID：11440804
> 
> 赞同：1
> 
> 时间：2012-07-11T20:19:54.453
> 
> 标签：c++

每当我在一个类中定义一个变量并同时给它一个值时，我都会得到一个错误。这是什么原因？

如您所见，这不起作用...

```
class myClass {
    private:
        int x = 4; // error
}; 
```

但是当我保持变量未定义时，它会：

```
class myClass {
    private:
        int x;
}; 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-11T20:31:58.863

由于没有其他人使用成员初始化，我将向您介绍：

```
class myClass {
    private:
        int x;
    public:
        myClass() : x (4){}
}; 
```

在构造函数的主体中使用 this 分配总是更好，因为在主体开始时，所有用户定义的成员都已经被初始化，无论你是否这样说。最好执行一次并实际初始化非用户定义的成员，这*是*唯一适用于非静态`const`成员和引用成员的方法。

例如，以下内容将不起作用，因为`x`没有在正文中初始化，它被分配给：

```
class myClass {
    private:
        const int x;
    public:
        myClass() {x = 4;}
}; 
```

但是，使用成员初始化程序会，因为您正在初始化它：

```
class myClass {
    private:
        const int x;
    public:
        myClass() : x (4){}
}; 
```

另请注意，您的`int x = 4;`语法[在 C++11 中完全有效](http://stroustrup.com/C++11FAQ.html#member-init)，它可以用于任何需要的初始化，因此如果您开始使用它，您将受益。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T20:22:39.937

在构造函数中初始化变量。

```
class myClass {
private:
    int x;

public:
   myClass()
   {
       x = 4; // hope that it will work
   }
}; 
```

**更新答案：** 根据[chris](https://stackoverflow.com/users/962089/chris)，最好使用成员初始化

```
class myClass {
private:
    const int x;
public:
    myClass() : x (4){}
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T20:23:11.510

实例变量应该使用 setter 方法、IE:`setX(input)`或在构造函数中定义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T20:24:37.150

你的班级就像一张蓝图。它没有任何与之关联的存储。当您实例化您的类的对象时，这类似于基于该蓝图的建筑物。您的对象具有存储空间，并且可以保存您赋予成员变量的值。

此外，正如其他人指出的那样，可以在 C++11 中做你想做的事情。查看： [http ://www.open-std.org/JTC1/SC22/WG21/docs/papers/2008/n2756.htm](http://www.open-std.org/JTC1/SC22/WG21/docs/papers/2008/n2756.htm)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-11T20:25:11.323

**在 C++03**中，

> 只能在类中初始化静态 const 整数数据成员。

在构造函数中初始化，或者使数据成员`static const`：

```
class myClass {
    private:
        int x;
    public:
      myClass() {
        x = 4;
      }
}; 
```

或者

```
class myClass {
    private:
     static const int x = 4;
}; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-11T20:28:33.433

这样做：

```
class myClass
{
private:
    static const int x = 4;
}; 
```

如果您不是`x`静态或常量，请仅使用`int x;`并在类的构造函数中初始化`x`。

# vim - Vim：移动视觉选择，而不是文本，上下线

> ID：11440807
> 
> 赞同：5
> 
> 时间：2012-07-11T20:20:06.200
> 
> 标签：vim

如果我在视觉上选择了这条线

```
Alpha <-- selected
Bravo
Charlie 
```

是否有 vim 命令可以向下移动所选区域，*而不添加到原始选择中*？

```
Alpha
Bravo
Charlie <-- selected 
```

hjkl 键只会将行添加到您的选择中。而且我在视觉的帮助文档中没有看到任何表明可以完成的内容。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-11T20:22:11.253

在选择模式下，您可以使用`o`(小写 o) 在移动顶部和底部边界之间进行交换。因此，您可以在不离开选择模式的情况下使用`j``j``o``j``j`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T20:29:32.847

这肯定会做到：

`j``j``V``V`

但这与首先取消原始选择并没有什么不同：

`esc``j``j``V`

或者：

`V``j``j``V`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T20:34:15.683

据我了解您的问题，您想选择 Alpha 并将其向下移动。让我们说将 Alpha 移动到查理之下。您需要在可视模式下选择 Alpha，然后输入 :（冒号）并输入 m 3。所以您的输入格式应该是**:m 3**。这意味着将选定的文本移动到第 3 行。我希望这将是您的问题答案。祝你有美好的一天。

# php - mysqli_* 或 mysql_* 性能？

> ID：11440808
> 
> 赞同：2
> 
> 时间：2012-07-11T20:20:07.717
> 
> 标签：php, mysql, mysqli, mysql5

在 php.net 网站上，他们说那些使用 mysql4.1 和 php5 或更高版本的用户需要使用非常“MYSQLI_”而不是“MYSQL_”。

他只想知道一件事，它会影响站点的性能，由于数据库（这在任何服务器上），站点出现了几个问题。

已经在使用各种解决方案。例如，缓存 HTML 页面。

但我的疑问真的是关于MYSQLI_ *，当我们使用它时，她连接到服务器和指定的数据库。根据php.net网站是mysql mysqli 改进和优化的mysql4.1+。

我想知道大型 MySQLi 的流量是否会给网站带来更好的性能。

PS：我知道“mysqli”和“mysql”的区别，考虑到MYSQL4.1+的PHP编程和结构（它有新的列类型）。我想知道的是多个连接。

*这个问题是关于性能的，谢谢*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T20:24:36.690

您应该阅读以下内容：

[http://blog.secaserver.com/2011/07/php-driver-mysql-mysqli-pdo-mysql/](http://blog.secaserver.com/2011/07/php-driver-mysql-mysqli-pdo-mysql/)

mysqli 提供了更好的性能和更多的功能，正如 Evert 所说，如果您使用 mysqlnd，这一点尤其明显。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T20:23:40.803

每当我们看到使用`mysql_*`函数的代码时，StackOveflow 上的一条常见评论应该可以回答您的问题：

> 请不要将 mysql_* 函数用于新代码。它们不再被维护并且社区已经开始了[弃用过程](http://goo.gl/KJveJ)。看到[红框](http://goo.gl/GPmFd)了吗？相反，您应该了解[准备好的语句](http://goo.gl/vn8zQ)并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli)。如果你不能决定，[这篇文章](http://goo.gl/3gqF9)将有助于选择。如果你想学习，这里有[很好的 PDO 教程](http://goo.gl/vFWnC)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T20:47:00.877

是的，`MySQLi could give better performance to your site`。您可以使用`persistent connections`，它基本上与众所周知的 具有相同的想法`connection pooling`，但是虽然`connection pooling`主要用于 java 开发（通常由 web 服务器直接执行，例如`Apache-Tomcat`），但持久连接由`MySQL and PHP`.

此外，MySQLi 可以通过采用[`prepared statements`](http://php.net/manual/en/mysqli.quickstart.prepared-statements.php).

`Mysqli extension`提供内置的清理处理代码，包括：

*   回滚活动事务

*   关闭准备好的语句（总是发生在 PHP 中）

*   关闭并删除临时表

*   解锁表

*   重置会话变量

*   关闭处理程序

*   释放使用 GET_LOCK() 获取的锁

所有这些功能也可以帮助您提供更好的性能和安全性。

更多信息，您可以参考：

[http://php.net/manual/en/mysqli.persistconns.php](http://php.net/manual/en/mysqli.persistconns.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T20:23:05.453

mysql_ 函数不再维护和弃用。mysqli_ 函数会执行得更好，特别是如果您使用 mysqlnd（本机驱动程序）。

停止使用已弃用的 API！

# javascript - 在 Android WebView 中显示 Javascript 小部件

> ID：11440814
> 
> 赞同：0
> 
> 时间：2012-07-11T20:20:27.043
> 
> 标签：javascript, android, webview, android-webview

嘿，Stackoverflow！

我正在尝试创建一个使用 WebView 来显示 JavaScript 小部件的应用程序，但我似乎遇到了一堵墙，我根本无法让小部件显示。我已经做了相当多的研究，我认为我正在尝试做的事情是可能的。

这是我的主要活动

```
public class WebViewAppTestActivity extends Activity {
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    //grab the webview
    WebView webview = (WebView) findViewById(R.id.webview);

  //grab the webview settings
    WebSettings websettings = webview.getSettings();

    //enable javascript
    websettings.setJavaScriptEnabled(true);

    //add a js interface to display the widgets
    webview.addJavascriptInterface(new JavaScriptInterface(this), "Android");

    //load a webpage
    webview.loadUrl("file:///android_asset/javascript/index.html");

} 
```

}

它加载看起来像这样的文件 index.html

```
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width; user-scalable=0;" />
<title>WebView test!</title>
</head>
<body>
<h1>MyHTML</h1>

<div id="panel">
<section class="episode"></section>
</div>

<script src="https://sourceurl1.js" />
<script src="https://sourceurl2.js" />
<script src="https://sourceurl3.js" />
<script src="https://sourceurl4.js" />

<script src="./widget.js" />
<script src="./top-episodes.js" />
<script>
  var TopEpisodes = new Company.TopEpisodes({
  $element: $('#panel section.episodes')
  });
  TopEpisodes.init({
         mode      : 'realtime',
         range     : { from: 1341911040, to: 1341907200 },
         path      : ["4FB159EB613033AA710006DF"],
         isEpisode : true
  });
</script>
</html>

</body>
</html> 
```

当我测试我的应用程序（Nexus S 4G ICS 4.0.4）时，唯一显示的是空白屏幕上的 MyHTML 标头。在 xml 中启用 Internet 访问。

我是否需要为 WebView 设置启用其他功能，或者我的 HTML 文件看起来真的有问题？我是否需要在 JS 接口中使用 addJavaScriptInterface 方法？

无论如何，我非常坚持并愿意接受任何建议！感谢您的时间！

**编辑**几天来没有对此问题的任何回应，让我知道是否有任何我可以做的事情来澄清这个问题或任何其他有帮助的细节！或者，如果它甚至是可能的。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T16:31:58.227

您的 HTML 错误，`<script src="<location of js>" />` 您没有正确指向位置，

```
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width; user-scalable=0;" />
<title>WebView test!</title>
</head>
<body>
<h1>MyHTML</h1>

<div id="panel">
<section class="episode"></section>
</div>
<!-- Below is the code if the js in the same location of your index.html file. -->
<script src="sourceurl1.js" />
<script src="sourceurl2.js" />
<script src="sourceurl3.js" />
<script src="sourceurl4.js" />

<!-- Below is the code if the js is outside the location of your index.html file. -->  
<script src="../widget.js" />

<!-- Below is the code if the js is outside the location of your index.html file., inside folder js-->  
<script src="../js/top-episodes.js" />
<script>
  var TopEpisodes = new Company.TopEpisodes({
  $element: $('#panel section.episodes')
  });
  TopEpisodes.init({
         mode      : 'realtime',
         range     : { from: 1341911040, to: 1341907200 },
         path      : ["4FB159EB613033AA710006DF"],
         isEpisode : true
  });
</script>
</html> 
```

为了帮助您更多，请指定文件的位置

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T22:32:35.557

因此，由于我缺乏 HTML 和 Javascript 方面的经验，我决定对我的应用程序采取不同的方向。

相反，我将使用此图表库在 Java 中本地开发小部件：http: [//achartengine.org/](http://achartengine.org/)，然后使用 HttpClient 更新数据，而不是在 Javascript 中的 WebView 中创建它，因为我认为这个解决方案将是Android 应用程序更轻松、更快捷。

谢谢大家的时间！

# java - 为什么在这个基本的 Java 程序中得到 InputMismatchException？

> ID：11440819
> 
> 赞同：3
> 
> 时间：2012-07-11T20:20:46.043
> 
> 标签：java, exception, input, type-mismatch

```
String[] names=new String[4];
int[] scores=new int[4];
Scanner keyboard = new Scanner(System.in);
System.out.println("Enter 4 strings and integers:");
for(int i=0;i<4;i++){
  names[i]=keyboard.nextLine();
  scores[i]= keyboard.nextInt();
} 
```

上面是我的简单程序，下面显示了弹出的异常。

```
Enter 4 strings and integers:
first
1
second
Exception in thread "main" java.util.InputMismatchException
    at java.util.Scanner.throwFor(Scanner.java:909)
    at java.util.Scanner.next(Scanner.java:1530)
    at java.util.Scanner.nextInt(Scanner.java:2160)
    at java.util.Scanner.nextInt(Scanner.java:2119)
    at Q2.main(Q2.java:15)
Java Result: 1 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-11T20:26:01.673

`nextInt`不会吞下行尾，而是留在缓冲区中。所以当你点击`1``enter`,`1`被读入第一个`score`，然后第二个`name`被设置为一个空字符串。

然后解析器尝试解释`second`为`int`，引发异常。

您需要在`readInt`.

# javascript - 拉斐尔和“全局”变量

> ID：11440821
> 
> 赞同：0
> 
> 时间：2012-07-11T20:20:53.147
> 
> 标签：javascript, svg, raphael

我正在尝试与 Raphael 合作一些 SVG 的东西，并尝试，好吧，以我有限的知识，构建一些漂亮的东西；）我有 3 个文件：1x html 文件和 2xjs 文件 html 文件：带有 onload 函数（+ 标头，身体和东西）

```
window.onload=function()
{
    init();
} 
```

js File1：具有init函数和加载js文件的函数（例如Raphael）以及加载文件后继续执行的回调

```
function init()
{
    getScripts(initTool)
}

function getScripts(callback)
{ 
    $.when($.getScript(scripts[raphael]).then(callback) 
} 

function initTool()
{
    $('body').append("<div id='tool'></div>");
    tool=Raphael("tool",5000,5000);
    $('body').append("<a href='javascript:void(0)' onclick='newElement'>New element</a>")
} 
```

js File2：这里我有函数 newElement 应该添加（对于这个例子）由 Rapahel 创建的 svg 元素的单个路径

```
function newElement()
{
    tool.path("M10,20L30,40");
} 
```

不幸的是，路径没有出现，我不知道为什么。我尝试在 onload 之前引用“工具”变量，以防它与全局/局部变量（疯狂猜测）相关，但这也不起作用。将 svg 元素的 id 更改为“tool”到“tool2”也不起作用。

还能是什么？我的（可能很明显）盲点在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T23:37:34.610

老实说，我已经写了很多 javascript，但我还没有完全理解变量范围。但是，在调用函数时，您应该使用括号来指示它应该被执行（有几次您在没有括号的情况下引用它们，但这超出了此答案的范围）。

所以...

```
$('body').append("<a href='javascript:void(0)' onclick='newElement()'>New element</a>") 
```

但这还不足以让它工作，你还应该像这样声明你的函数：

```
var newElement = function() {
    tool.path("M10,20L30,40");
} 
```

这是一个可行的解决方案：http: [//jsfiddle.net/vAjG2/](http://jsfiddle.net/vAjG2/)

（也许有人可以扩展为什么需要这些更改，我自己不明白）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T20:58:08.367

回调不应该在这里声明为参数吗？

```
function getScripts(callback)
{ 
    $.when($.getScript(scripts[raphael]).then(callback) 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-24T02:27:01.967

该问题与变量范围无关。您只需要在内联事件处理程序中的函数名称后面加上括号。将最后一行改写为：

```
$('body').append("<a href='javascript:void(0)' onclick="newElement()">New element</a>") 
```

你会启动并运行。

*然而*，由于各种原因，内联事件处理程序不受欢迎。正如[quirksmode](http://www.quirksmode.org/js/events_early.html)所说：“尽管内联事件注册模型是古老而可靠的，但它有一个严重的缺点。它要求您在不属于它的 XHTML 结构层中编写 JavaScript 行为代码。”

一种更简洁的方法是将标记和脚本分开，例如：

```
<div id='tool'></div>
<a id="mylink" href='#'>New element</a>

<script>
var tool = Raphael("tool",500,500);

$('#mylink').on("click", function() {
    tool.path("M10,20L30,40");
});
</script> 
```

有关此代码的实际操作，请参阅此[jsfiddle](http://jsfiddle.net/QGhU7/)。

最后，作为一个有用的提示，我建议您在准备好文档时运行您的代码，而不是加载窗口，尤其是您正在使用 jquery。文档就绪发生在第一次构建 DOM 时。窗口加载等待所有资产完全加载，这可能需要一段时间，通常没有必要。长期以来，它[一直被认为是最佳实践](http://www.learningjquery.com/2006/09/introducing-document-ready)。

# iframe - 来自跨域的 Cookie 在 iframe 中无法访问

> ID：11440827
> 
> 赞同：0
> 
> 时间：2012-07-11T20:21:15.450
> 
> 标签：iframe, cookies, cross-platform

我搜索了我的要求并找到了我的问题的答案。但我无法让它工作。因此，我想在这里发布我的要求。

我的网站由第三方供应商托管，我无法控制他们的服务器。我在他们的一个 html 页面中设置了 iframe。这个 iframe 将指向我的服务器，我应该能够访问供应商在其主页中设置的 cookie。为了尝试这个，我创建了两个 html 页面。一个命名为 SetCookie.html，另一个命名为 GetCookie.html。两者都驻留在不同的计算机中。请在下面找到源代码：

**SetCookie.html**

```
<html>
    <head>
        <title>Set Cookie</title>
    </head>
    <body>

        <script type="text/javascript">
            function setCookie() {
                var cookieValue = document.getElementById("txtCookie").value;
                var cookieName = "TestCookie";
                document.cookie = cookieName + "=" + cookieValue;
                document.getElementById("tdCookieMessage").innerHTML = cookieName + "=" + cookieValue + " is set!";
            }
        </script>

        <table>
            <tr>
                <td>
                    Cookie
                </td>
                <td>
                    <input type="text" id="txtCookie" value="" />
                </td>
                <td>
                    <input type="button" id="btnGetCookie" onclick="setCookie();" value="Set Cookie!" />
                </td>
            </tr>
            <tr>
                <td colspan="3" id="tdCookieMessage">
                </td>
            </tr>
        </table>
        <table>
            <tr>
                <td>
                    <iframe src="http://myServer/GetCookie.html"></iframe>
                </td>
            </tr>
        </table>
    </body>
</html> 
```

**获取Cookie.html**

```
<html>
<head>
    <title>Get Cookie</title>

    <script type="text/javascript">
        function getCookie(cookieName) {
            var i, x, y, ARRcookies = document.cookie.split(";");
            for (i = 0; i < ARRcookies.length; i++) {
                x = ARRcookies[i].substr(0, ARRcookies[i].indexOf("="));
                y = ARRcookies[i].substr(ARRcookies[i].indexOf("=") + 1);
                x = x.replace(/^\s+|\s+$/g, "");
                if (x == cookieName) {
                    document.getElementById("tdCookie").innerHTML = unescape(y);
                    expireCookie(cookieName);
                }
            }
        }
        function expireCookie(cookieName) {
            document.cookie = cookieName + '=; expires=Thu, 01-Jan-70 00:00:01 GMT;';
        }
    </script>

</head>
<body>
    <table>
        <tr>
            <td>
                <input type="button" id="btnGetCookie" onclick="getCookie('TestCookie');" value="Test Cookie Value is: " />
            </td>
            <td id="tdCookie">
            </td>
        </tr>
    </table>
</body>
</html> 
```

任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T20:29:37.357

只有为页面所在的域设置的 cookie 才会发送到页面。即您在 mywebsite.com 上，而他们在 theirdomain.com 上，您将不会收到他们的 cookie，他们也不会收到您的。出于安全原因，这就是 cookie 的工作方式。

如果您的站点和供应商的站点都在同一个域上，您可以解决这个问题，那么您可以在应用程序之间共享 cookie。

IE them.mywebsite.com 和 me.mywebsite.com 都会收到 *.mywebsite.com 的 cookie。

# javascript - 键盘上的 Ajax 或粘贴

> ID：11440831
> 
> 赞同：1
> 
> 时间：2012-07-11T20:21:19.150
> 
> 标签：javascript, jquery

我正在对 keyup 或 paste 执行 Ajax 请求。问题是当用户使用 Control-V 进行粘贴时，会出现两个 ajax 请求——一个用于粘贴，一个用于 keyup。

```
$("#my-form").bind('keyup paste', function(e) {...} 
```

在 keyup 或 paste 上绑定的好方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-11T20:24:40.900

您可以使用`setTimeout`/`clearTimeout`来延迟事件，因此它只会触发一次。

```
$("#my-form").bind('keyup paste', function(e) {
    clearTimeout($(this).data('timeout'));
    $(this).data('timeout', setTimeout(function(){
        // your code
    }, 200));
}); 
```

演示：http: [//jsfiddle.net/4b7y5/](http://jsfiddle.net/4b7y5/)

# asp.net - 将对象集合作为参数传递到 SQL Server 存储过程

> ID：11440832
> 
> 赞同：6
> 
> 时间：2012-07-11T20:21:26.280
> 
> 标签：asp.net, sql, sql-server, vb.net, stored-procedures

我有一个关于是否可以做某事的一般性问题 - 以及这是否是最有效的方法！

总结一下：我可以将对象集合作为参数传递给存储过程吗？

假设我有一个名为的 SQL Server 表`Users [UserID, Forename, Surname]` 和另一个名为`Hobbies [HobbyID, UserID, HobbyName, HobbyTypeID]`

这个设置是为了记录一个用户的多个爱好。

在我的应用程序中，我想更新用户记录。

通常 - 我会更新用户表，然后在代码中循环遍历每个爱好并逐条更新爱好表记录。

如果我要更新用户的名字和他们的 2 个爱好，这将需要 3 次调用数据库。

（1 次调用存储过程来更新名字/姓氏，2 次调用存储过程来更新 2 条爱好记录）

我的问题是：
我可以通过将所有参数仅传递给 1 个存储过程来对数据库进行 1 次调用吗？

例如。

```
intUserID = 1
strForename = "Edward"
strSurname = "ScissorHands"

dim objHobbyCollection as New List(Of Hobby)
'Assume that I have 2 hobby objects, each with their hobbyID, UserID, HobbyName & HobbyTypeID

Dim params As SqlParameter()
params = New SqlParameter() {
    New SqlParameter("@UserID", intUserID),
    New SqlParameter("@Forename", strForename),
    New SqlParameter("@Surname", strSurname),
    New SqlParameter("@Hobbies", objHobbyCollection) 
    } 
```

我可以这样做吗？（哪种方式更有效？）存储过程会是什么样子？

```
ALTER PROCEDURE [dbo].[User_Update]

 @UserID    INT
,@Forename      NVARCHAR(50) = NULL
,@Surname   NVARCHAR(50) = NULL
,@Hobbies   ?????????????? 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-11T20:26:38.150

假设 SQL Server 2008+，您可以使用表值参数执行此操作。首先在 SQL Server 中创建一个表类型：

```
CREATE TYPE dbo.HobbiesTVP AS TABLE
(
  HobbyID INT PRIMARY KEY,
  HobbyName NVARCHAR(50),
  HobbyTypeID INT
); 
```

然后你的存储过程会说：

```
@Hobbies dbo.HobbiesTVP READONLY 
```

在 C# 中（对不起，我不知道 vb.net 等效项）如下所示（但如果您只有一个用户 ID，则它不需要成为集合的一部分，对吗？）：

```
// as Steve pointed out, you may need to have your hobbies in a DataTable.

DataTable HobbyDataTable = new DataTable();
HobbyDataTable.Columns.Add(new DataColumn("HobbyID"));
HobbyDataTable.Columns.Add(new DataColumn("HobbyName"));
HobbyDataTable.Columns.Add(new DataColumn("HobbyTypeID"));

// loop through objHobbyCollection and add the values to the DataTable,
// or just populate this DataTable in the first place

using (connObject)
{
    SqlCommand cmd = new SqlCommand("dbo.User_Update", connObject);
    cmd.CommandType = CommandType.StoredProcedure;
    // other params, e.g. @UserID
    SqlParameter tvparam = cmd.Parameters.AddWithValue("@Hobbies", HobbyDataTable);
    tvparam.SqlDbType = SqlDbType.Structured;
    // ...presumably ExecuteNonQuery()
} 
```

# facebook - 未在频道文件上设置 document.domain

> ID：11440836
> 
> 赞同：1
> 
> 时间：2012-07-11T20:21:45.247
> 
> 标签：facebook, cross-domain, channel

在 2012 年 7 月代码清理之前，在 Facebook 应用程序中设置 document.domain 而不是在频道文件中似乎不会导致问题。但是之后，会抛出跨域安全错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:21:47.057

不是一个真正的问题，但是当我搜索这个问题时，我没有找到任何相关的东西，并认为记下它很重要，以防其他人也有这个问题。

# php - 使用 php 和 MySQL 登录网站

> ID：11440837
> 
> 赞同：-4
> 
> 时间：2012-07-11T20:21:46.027
> 
> 标签：php, user-accounts

到目前为止，在我的网站上，用户可以通过 php 将他们的用户名、密码和电子邮件添加到 MySQL 数据库。我现在想让用户在表单中输入相同的凭据（用户名和密码），然后运行 ​​php 脚本并检查用户名和密码是否在数据库中。这个脚本要怎么写？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:25:47.323

创建一个获取用户输入内容的 php 函数，然后从用户表中选择它们。如果它返回一些东西，就说它已经在数据库中。

例子：

```
SELECT uname, pw FROM users WHERE uname="userNameInput" AND pw="userPwInput"; 
```

如果这返回一行，则它已经在数据库中。

然后，您可以通过使用 ajax 调用该函数，在您选择点击按钮或每次击键时运行此函数。

# hook - 如何在 AutoIt 中挂钩和使用 WH_GETMESSAGE

> ID：11440843
> 
> 赞同：1
> 
> 时间：2012-07-11T20:22:11.390
> 
> 标签：hook, autoit, getmessage

有人可以举例说明如何将 WH_GETMESSAGE 挂接到 AutoIt 中以查找桌面上的所有系统/应用程序窗口消息，并在窗口移动时执行某些操作，以及如何从发送消息的窗口存储句柄？

# asp.net-mvc-3 - 将 Distinct LINQ 查询绑定到 Telerik 网格

> ID：11440845
> 
> 赞同：0
> 
> 时间：2012-07-11T20:22:28.190
> 
> 标签：asp.net-mvc-3, linq, telerik-grid

我正在尝试绑定其中包含 Distinct() 的 LINQ 查询并将其绑定到 Telerik 网格（这仍然是 Telerik 网格，尚未转换为 Kendo）。我也尝试将 AsQueryable() 添加到其中，但仍然出现“`Specified method is not supported`异常”。

我的查询如下所示：

```
var rewardTypes = (from type in _rewardTypeRepository.GetAll()
                           from vo in type.ValidOutlets
                           join ot in _outletRepository.GetAll()
                               on vo.Outlet.Id equals ot.Id
                           where userOutletIds.Contains(ot.Id)
                           select vo.RewardType).Distinct().AsQueryable(); 
```

对此的任何想法或指导将不胜感激。

谢谢你，马特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T20:23:23.460

使用`.Distinct()`或`IQueryable<T>`只是延迟加载数据集合，这意味着它实际上还没有被枚举。

尝试将其转换为`List<T>`.

```
var rewardTypes = (from type in _rewardTypeRepository.GetAll()
                   from vo in type.ValidOutlets
                   join ot in _outletRepository.GetAll()
                       on vo.Outlet.Id equals ot.Id
                   where userOutletIds.Contains(ot.Id)
                   select vo.RewardType).ToList(); 
```

如果您想保持“轻量级”并且不枚举潜在大型集合中的每个项目，我建议您在方便时使用`.Skip()`and`.Take()`方法对结果进行分页。这两种方法都适用于`IQueryable<T>`集合。

# c - malloc 和 malloc(3) 有什么区别？

> ID：11440846
> 
> 赞同：4
> 
> 时间：2012-07-11T20:22:32.370
> 
> 标签：c, manpage

在阅读有关 jemalloc 内存管理器的[黑客文章](http://www.phrack.org/issues.html?issue=68&id=10)时，黑客一直提到 malloc(3)，而不是 malloc。我想知道为什么。

他这样做是因为它指的是特定的 linux malloc 实现吗？或者简单地引用所有 malloc 变体，它们实现了unix/linux 手册页[第 3 节（库函数）中描述的接口？](http://linux.die.net/man/3/malloc)这个选项是我的猜测，想确定。有不同的原因吗？

那么，黑客是否过于具体了？或者 malloc 和 malloc(3) 之间有区别吗？

(3) 部分不是对黑客文章后面提到的其他文档、文章或研究的引用。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-11T20:24:22.753

`malloc(3)`只是一个提示，它`malloc`是手册页第 3 节的一部分。第 3 节是库函数的位置。这与系统调用所在的手册页的第 2 节相反。没有`malloc(2)`。

例如：

`fwrite`是一个库函数，所以有时写成`fwrite(3)`

`write`是一个系统调用，所以有时写成`write(2)`

如果你运行命令：

```
$ man man 
```

它会告诉你

```
 1   Executable programs or shell commands
   2   System calls (functions provided by the kernel)
   3   Library calls (functions within program libraries)
   4   Special files (usually found in /dev)
   5   File formats and conventions eg /etc/passwd
   6   Games
   7   Miscellaneous  (including  macro  packages and convenâ
       tions), e.g. man(7), groff(7)
   8   System administration commands (usually only for root)
   9   Kernel routines [Non standard] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-11T20:26:08.497

前言：我的unix很弱。

我相信它只是对第 3 节库的引用。

（来自行话文件）
诸如 malloc(3) 和 patch(1) 之类的引用是对 Unix 工具的引用（其中一些，例如 patch(1)，实际上是通过 Usenet 分发的开源）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T20:24:39.210

看起来作者只是非常具体。

如果可能存在相同功能的例如 shell 版本，则指定对手册页第 3 节的引用通常很有用。例如，`man 1 printf`对于 printf(1) 与 printf(3)。

但在`malloc`文档的情况下，应该只存在于第 3 节中。

# google-apps-script - 关于从元素获取数据的事件如何在 Google Script 中工作

> ID：11440847
> 
> 赞同：0
> 
> 时间：2012-07-11T20:22:37.333
> 
> 标签：google-apps-script, google-apps

问题1）当一个按钮被点击时，是否可以使用这样的东西（见下面的代码）？

```
function Submit(e) {
  var app = UiApp.getActiveApplication();
  var checked = app.getElementById("checkbox").getValue();
} 
```

问题2）点击标签时是否可以使用类似的东西（见下面的代码）？

```
function LabelClick(e) {
  var LabelText = e.parameter.getText();
} 
```

抱歉，这可能很愚蠢，但我找不到任何像样的例子，而且似乎无法从谷歌的文档中解决这个问题，我也刚刚习惯了谷歌脚本。如果您有答案，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T20:32:50.253

你不是很远......但还不够近，无法让它工作......

Ui 元素的值在添加到处理程序的所谓回调元素中发送到处理程序函数。这个回调元素可能是一个按钮、一个标签，或者更简单地说，是包含所有其他小部件的父小部件。这些“元素”位于处理函数的“e”中，并由它们的**名称**标识。
在另一个方向上，即如果您需要从另一个函数修改 Ui 元素，那么您可以通过它的 ID ( `getElementbyId()`) 获取该元素并为其分配一个值，就像您在 UI 定义函数中所做的那样。

我从另一篇文章中复制/粘贴示例代码来说明我所说的内容，您可以看到`e.parameter.chkmode`包含复选框的值，我将添加一个标签以显示相反的过程（单击按钮时文本会更改） .

希望我足够清楚，

```
var sh = SpreadsheetApp.getActiveSheet();
var ss = SpreadsheetApp.getActiveSpreadsheet();
//
function move() {
   var app = UiApp.createApplication().setTitle("move test")
       .setHeight(100).setWidth(400).setStyleAttribute("background-color","beige");
   var panel = app.createVerticalPanel();
   var next = app.createButton('next').setWidth('180');
   var chkmode = app.createCheckBox("moving mode (checked = up/dwn, unchecked=L/R)").setValue(false).setName('chkmode');
   var label = app.createLabel("test Label with text that will be modified on click").setId('label');
   panel.add(next).add(chkmode).add(label);
   var handler = app.createServerHandler('click').addCallbackElement(panel);
   next.addClickHandler(handler);
   app.add(panel);
   ss.show(app);
 }
//
function click(e) {
  var app = UiApp.getActiveApplication();
  var activeline = sh.getActiveRange().getRow();// get the row number of the selected cell/range
  var activecol = sh.getActiveRange().getColumn();// get the row number of the selected cell/range
  var label = app.getElementById('label');
  label.setText('You have clicked the button');
  var chkmode=e.parameter.chkmode;
  if(chkmode=="true"){
    activeline++
    }else{
      activecol++}
  var sel=sh.getRange(activeline,activecol);
  sh.setActiveSelection(sel);// make the next row active
  return app;
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T08:13:08.820

对于 UI 和事件教程，我建议：

[https://developers.google.com/apps-script/uiapp](https://developers.google.com/apps-script/uiapp)

# java - 如何将主体属性的值作为对象而不是字符串？

> ID：11440858
> 
> 赞同：3
> 
> 时间：2012-07-11T20:23:11.353
> 
> 标签：java, spring, jsp

**如何将主体属性的值作为对象而不是字符串？**

我有扩展 UserDetails 的自定义用户对象。

**例子：**

这将作为字符串打印属性 allTask

```
<sec:authentication property="principal.user.allTask"/> 
```

我想将主体的 value 属性作为对象，以便使用标签保存请求

```
<c:set var="task" value="${principal.user.allTask}"/> 
```

我不想根据控制器的请求推送 bean 主体。！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T12:32:27.637

我不太明白你的问题，但是，我的博客上有一篇关于这个的帖子：

[http://giannisapi.wordpress.com/2011/09/21/spring-3-spring-security-implementing-custom-userdetails-with-hibernate/](http://giannisapi.wordpress.com/2011/09/21/spring-3-spring-security-implementing-custom-userdetails-with-hibernate/) 字符串也是一个对象，所以通过获取字符串你得到一个对象. 我希望它会帮助你。阅读并让我知道您是否需要更多帮助

# android - 我在哪里可以找到 android 拨号盘图像资产来创建自定义拨号器应用程序？

> ID：11440863
> 
> 赞同：0
> 
> 时间：2012-07-11T20:23:20.030
> 
> 标签：android

我正在尝试为 Android 创建一个自定义拨号器应用程序，并且需要正常和选中的按钮/资产（按下时会显示不同的颜色）。

有人可以告诉我是否有地方可以找到此类资产。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T20:38:47.283

通常您可以在 SDK 目录中找到资产。在 mac 上它将是`YOUR_SDK_DIR/platforms/android-(VERSION)/data/res`，`VERSION`您想要可绘制对象的 SDK 版本在哪里。

# c - 如何计算多项式导数？

> ID：11440868
> 
> 赞同：-3
> 
> 时间：2012-07-11T20:23:45.317
> 
> 标签：c, function, derivative

我正在尝试编写一个函数来计算多项式函数的导数。`degr`是多项式的次数，`arr`是包含多项式系数的数组。我想计算点的导数`t`。

下面是我的尝试，但它总是返回`0`。我不明白出了什么问题。

```
float derv(int degr,int arr[],float t)
{
  int i,n;
  float sum=0;
  float arr2[degr+1];

  for (i=0;i<degr+1;i++) {
    arr[i]=(arr[i]*(i+1)); 
  } 
  degr=degr-1;
  for (i=0;i<degr+1;i++)
  {
     arr2[i] = (pow(t,degr-i)*arr[i]);
  }

  for(n=0;n<degr+1;n++)
  {
    sum = sum + arr2[n];
  } 
  return sum;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:51:05.833

让我们做一些假设。如果多项式如下所示：

```
 degr
        .---
p(x) =   >     arr[i] * pow(x, i)
        `---
         i=0 
```

然后，将通过以下方式获得导数：

```
 degr
d         .---
-- p(x) =  >    i * arr[i] * pow(x, i-1)
dx        `---
           i=1 
```

您应该能够使用类似于[Horner 的方法](http://en.wikipedia.org/wiki/Horner%27s_method)的循环来计算它。

对于您的程序，您正在几个循环中处理它，这是不必要的。但是，您的第一个循环正在尝试重新计算系数。第一个系数是一个常数，因此在应用导数时应该重新计算为零。相反，你乘以`(i+1)`。只是乘以`i`代替。

在您的第二个循环中，您知道度数已减小，但由于第一项为 0，您不必减小`degr`变量。您应该从 index 开始循环`1`。在 for 循环本身的主体内，`pow`计算应该提高到`i-1`能力。

在您的`sum`计算循环中，也从 index 开始`1`。

您应该能够看到我向您建议的更改是如何直接来自我上面提供的公式的。

请注意，由于您修改了表示多项式的数组，因此您不能再次调用该函数来计算不同值的导数。您可以通过修改第一个循环来解决此问题，以便将系数存储在其中`arr2`，然后更改第二个循环，以便您从中获取系数`arr2`。现在，您可以将输入数组声明为`derv`函数中的常量。

带有我建议更改的代码如下所示：

```
float derv(int degr,const int arr[],float t)
{
  int i,n;
  float sum=0;
  float arr2[degr+1];

  for (i=0;i<degr+1;i++) {
    arr2[i]=(arr[i]*i);
  }
  for (i=1;i<degr+1;i++)
  {
     arr2[i] = (pow(t,i-1)*arr2[i]);
  }

  for(n=1;n<degr+1;n++)
  {
    sum = sum + arr2[n];
  }
  return sum;
} 
```

# google-analytics - 谷歌分析关键字丢失？我怎样才能找到他们？

> ID：11440878
> 
> 赞同：0
> 
> 时间：2012-07-11T20:24:11.397
> 
> 标签：google-analytics

我很少登录谷歌分析，但似乎他们已经删除了按搜索词查看网站访问的功能。

还是转移到了某个奇怪的藏身处？帮助任何人...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T01:19:47.523

转到流量来源 -> 搜索 -> 概述，然后单击主要维度中的关键字。

![在此处输入图像描述](../Images/df3ec4f7d59cf53d8908203745ecd242.png)

# objective-c - 使用 UISearchBar 时使视图的其余部分变为灰色

> ID：11440882
> 
> 赞同：2
> 
> 时间：2012-07-11T20:24:34.060
> 
> 标签：objective-c, ios, xcode, uisearchbar

我想模仿似乎是使用 UISearchBar 的标准 UI，现在我尝试将视图的其余部分设置为灰色，当我开始搜索时，我尝试通过将视图的背景颜色设置为灰色，但我在 UITableView 中使用部分，它们没有变灰。有人有任何理由吗？

![使用搜索栏时的 UITableView](../Images/b3a380d575f9bc4a3d8fe2b6830a3a67.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-11T20:35:04.440

您没有看到部分标题变为灰色的原因是因为它们绘制在灰色背景之上，并且是不透明的；换句话说，它们`alpha`是 1。

如果您正在寻找获得所需效果的建议，我的第一个反应是添加一个叠加层`UIView`作为您想要“变灰”的区域的子视图，并在某些事件发生时更改其背景颜色。像这样的东西：

```
// You have to choose what view is the one that needs to be grayed out.
// I'll call the view you want to gray out "viewToBeGrayed"

UIView *grayOverlay = [[UIView alloc] initWithFrame:viewToBeGrayed.frame];

// Initially, the overlay should be clear
[grayOverlay setBackgroundColor:[UIColor clearColor]];

[viewToBeGrayed addSubview:grayOverlay]; 
```

然后，当您想“变灰”时`viewToBeGrayed`，只需将背景颜色更改`grayOverlay`为一些半透明的灰度值：

```
[grayOverlay setBackgroundColor:[UIColor colorWithWhite:0.5 alpha:0.5]]; 
```

最后，当您想摆脱“变灰”效果时，只需将视图设置回清除即可：

```
[grayOverlay setBackgroundColor:[UIColor clearColor]]; 
```

那应该是一个很好的起点。如果您需要任何其他帮助，请发表评论。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-11T20:34:34.847

使用标准`UISearchController`来满足您的 tableview 搜索需求。

# .net - 内联 CSS 性能问题

> ID：11440886
> 
> 赞同：2
> 
> 时间：2012-07-11T20:24:38.787
> 
> 标签：.net, html, css

我公司聘请了一家开发公司来制作一些复杂的软件。看来他们正在使用 .NET 框架来编写代码。我不知道这是否与 .NET 严格相关，但是在查看 HTML 的结构时，我注意到很多内联 CSS。格式中只有很多 div `<div style="position: absolute; top:177px; left:229px; width: 710px; height: 306px;" class="EventLabel Event_bg_red"></div>`

还有一些具有长 id 的元素。`id="ctl00_ctl00_ctl00_MainContent_MainContent_BodyContent_grid_DXDataRow0"`

这些长长的文本字符串和长的内联样式声明会影响网站的性能吗？（我注意到一些滞后问题，不知道是由于某些脚本还是复杂的 HTML）或者 .NET 动态编写此 HTML，因此计算所有这些`position:absolute`值需要很长时间。或者当浏览器呈现网页时，这样的文本字符串可以忽略不计？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T20:32:11.927

我怀疑这是多种因素的结合。

首先，funky-ID 是 .NET 的东西——它表示站点中元素的层次结构。它可以被优化和/或禁用，但它通常是无害的。查看页面的源代码并查找名为 VIEWSTATE 的表单变量 - 我怀疑它很大（他们使用的所有 ID 都意味着许多服务器端控件有助于 ViewState），这可能是一个问题.

长/动态生成的 ID 也会使编写与页面上的元素交互的客户端代码变得更加困难。

所有的内联样式可能来自他们用来进行布局的 WSYIWYG 编辑器。这些工具通常会生成令人讨厌的 HTML，但会“完成工作”。

您可能担心的唯一性能问题是传递给浏览器的内容的大小，如果使用长 ID 和内联样式，它会变得更大。我怀疑是否会有任何一次性的性能问题。

但是，这可能会使以后修改站点布局变得更加困难。

希望这可以帮助

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T20:50:57.817

是的，内联 CSS 比来自单独 CSS 文件的 CSS 慢。不，我怀疑长 ID 会在性能方面产生任何影响。

但是，即使这些事情是一个问题，它们也不太可能成为*问题*。修复您正在查看的点将是微优化。没有一个主要的浏览器会给你任何明显的内联 CSS 性能问题。它是网页代码的标准元素，即使通常有更好的方法。至于长字符串……好吧，浏览器的渲染引擎针对解析长字符串进行了高度优化，所以我认为几个长ID不会造成任何问题。

如果您遇到一般性能问题，我会说这听起来比这更深层次。

我建议使用像 Firebug 或 Chrome 开发者工具这样的工具在网站上运行一些分析，并更详细地找出它慢的地方。可用于这种调试的工具现在非常先进，通过一些工作，您应该能够非常准确地确定问题所在。也许是服务器端代码很慢：您会看到 HTML 和 Ajax 的页面加载时间很长。或者某些 Javascript 例程可能很慢：分析工具会准确显示哪些调用花费的时间最多。

我的直觉是，你发现的这些东西是一个更根本的潜在问题的征兆：坦率地说，在我看来，你聘请来编写代码的人听起来并不像他们真的很好在它。试着看看他们写的源代码，感受一下代码的质量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T20:32:28.563

内联 CSS 从不缓存，就像 HTML 从不缓存一样。外部 CSS 文件确实会被用户的浏览器缓存和重用——因此会影响性能。（同样适用于 Javascript 内联文件和外部文件。）

内联 CSS 也很难维护，并且会使 HTML 文件本身更大。我不认为长ID本身是一个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T20:34:53.743

这些 id 是使用 ASP.NET WebForm 框架自动生成的。要查看它们是否是性能问题，您可以使用适用于 chrome 或 firefox 的 page speed 插件。我在这一点上的猜测是它们不是，因为浏览器通常将它们存储在哈希图中，因此查找它们的速度非常快。

[https://developers.google.com/speed/pagespeed/](https://developers.google.com/speed/pagespeed/)

至于渲染时间，请使用页面检查器（内置 chrome/Safari）或 firebug（Firefox 插件）。网络窗格通常会告诉您在每个资源上花费了多少时间。

我的猜测是滞后是在任何数据发送到客户端之前。当页面上有很多控件，或者需要从数据库中获取大量数据时，WebForm 可能会占用大量资源。检查**ViewState**的使用。（如果您不知道它是什么，请在 google 上查看）如果您不小心，WebForm 可以在您的页面中推送数百千字节的数据，并且每次单击按钮时这些数据都会发送回服务器。

好狩猎！

# html - 绝对定位的 div 需要具有固定页脚的文档的底部边距

> ID：11440891
> 
> 赞同：5
> 
> 时间：2012-07-11T20:24:50.127
> 
> 标签：html, css

不知怎的，我无法弄清楚我错过了什么......

我尝试`absolute`在两个`fixed`栏（页眉和页脚）之间放置一些 div。页眉包含一些选项卡，页脚包含版权。我想使用窗口的滚动条而不是溢出的 div，我知道这应该是可能的！

每个绝对定位的 div 都应该有一个额外的边距，这样 div 的底部就不会消失在页脚后面。

![在此处输入图像描述](../Images/f70c722655a2ccef07005cd8507a9061.png)

它应该变成这样： ![在此处输入图像描述](../Images/875b1c3e6bae2eb6bb3e8b25259895f6.png)

我的问题的片段可[在](http://jsfiddle.net/LnEv2/)jsfiddle 上找到。

我的 HTML：

```
<ul class="cf tabs">
    <li>Tab 1</li>
    <li>Tab 2</li>
</ul>
<div style="margin-top: 40px; padding-bottom: 30px; position:relative">
    <div style="position:absolute;top:300px; height:100px; width: 250px; left:200px; border: 1px solid purple;">aaa</div>

    <div style="position:absolute;top:0px; height:100px; width: 100px; left:100px; border: 1px solid purple;">bbb</div>

    <div style="position:absolute;top:450px; height:100px; width: 250px; left:400px; border: 1px solid purple;">ccc</div>
</div>
<div class="cf footer">Copyright &copy;</div>​ 
```

我正在使用的样式表：

```
 ul.tabs {
        list-style-type: none;
        list-style-position: outside;
        padding:5px;
        margin: 0;
        position:fixed;
        top:0;
        z-index: 999;
        background-color: white;
        left:0;
        right:0;
        border-bottom: 1px solid green;
        opacity: 0.7;
    }
    ul.tabs li {
        float: left;
        margin:1px;
        padding: 4px 10px 2px 10px;
        border: 1px solid black;
    }

    div.footer {
        position: fixed;
        bottom: 0;
        left: 0;
        right:0;
        background-color:#DEDEE9;
        border-top: 3px outset #BBBBBB;
        padding: 5px;
        opacity: 0.6;
    }

    .cf:before,
    .cf:after {
        content: " "; 
        display: table; 
    }
    .cf:after {
        clear: both;
    }​ 
```

各位有什么提示吗？

**额外信息** 正如您在附图中看到的那样，右下方方形 div 的紫色边框与固定页脚重叠。我不想要这个。应该在某处给定一个底部边距，以便每个 div 都有一个额外的边距，因此它应该与页脚的顶部相匹配

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T21:31:12.430

这是我想出的解决方案。`div`用另一个包裹最底部绝对定位在里面`div`，在上面放置底部边距等于页脚高度和边框。我给它上课`.inner`。

看我的[**小提琴**](http://jsfiddle.net/LnEv2/24/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T21:06:34.977

`body`为文档添加与页脚高度相等的底部填充：

```
body {
     padding-bottom: 31px;
} 
```

（JSFiddle 似乎不允许你修改`body`元素的样式，所以我不能发布小提琴。不过它应该可以工作。）

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-07-11T21:45:12.953

不要使用绝对定位，而是执行以下操作：

边距 - 左：800px

边距 - 顶部：500px

# java - 读取 S3 文件时出现“java.net.SocketException：套接字已关闭”

> ID：11440892
> 
> 赞同：7
> 
> 时间：2012-07-11T20:24:53.893
> 
> 标签：java, file-io, amazon-s3

我正在尝试从 S3 读取 csv 文本文件，然后将其每一行发送到分布式队列以进行处理。

尝试读取它时，我在正在读取的文件的不同点（在不同的执行中）收到“java.net.SocketException：Socket is closed”异常。这是代码：

```
 AmazonS3 s3 = new AmazonS3Client(new PropertiesCredentials(MyClass.class.getResourceAsStream("myCredentials.properties")));

        String bucketName = "myBucket";
        String key = "myFile";  

        S3Object object = s3.getObject(new GetObjectRequest(bucketName, key));

        InputStream in = object.getObjectContent();

        BufferedReader readerS3 = new BufferedReader(new InputStreamReader(in, Charset.forName(fileInfo.getEncoding())));

        try {
            String line = null;
            while ((line = readerS3.readLine()) != null) {
                // Sending the line to a distributed queue
            }
        } catch (IOException e) {
            e.printStackTrace();
        }finally {
            try {
                in.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        } 
```

关于如何解决这个问题的任何想法？

更新：

这个异常发生在我第二次运行该方法时，如果我停止整个程序并再次运行它，那么我第一次运行该方法就可以了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T12:36:37.370

正如“jsn”在问题评论中所建议的那样，问题是您需要`AmazonS3`配置[`ClientConfiguration`](http://docs.amazonwebservices.com/AWSJavaSDK/latest/javadoc/com/amazonaws/ClientConfiguration.html)：

```
ClientConfiguration config = new ClientConfiguration();
config.setSocketTimeout(0);
AmazonS3 s3 = new AmazonS3Client(/* credentials */, config); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-22T20:14:50.667

谢谢，@jsn，你的建议是我的问题。

我有一个只返回 InputStream 的方法，因此 AmazonS3 对象被垃圾收集并导致它关闭 InputStream。

我已经让它保持对 AmazonS3 对象的引用，这解决了我的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-06T08:54:04.613

也许您应该在 finally 而不是“in”中关闭 readerS3。即关闭最外面的对象，它可以关闭它的包裹子对象。

如果您先关闭“in”，则 InputStreamReader 和 BufferedReader 仍处于打开状态，并且如果他们尝试对所包装的对象执行任何操作，则该对象将已关闭。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T22:38:21.373

关闭套接字的输入流或输出流，或围绕它们的任何流/读取器/写入器包装器，将关闭套接字（因此分别关闭输出或输入流）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-06T18:18:33.053

无需继续重新初始化 s3。

在您的 onCreate 上调用初始化 s3Object 和 s3Client。

然后在你的 asynctask 中只使用调用

通过这种方式，您的 s3Client 将保持相同的数据，并且在执行 while 读取时永远不会关闭与 s3 的套接字连接。聪明和学习。

```
S3Client s3Client;
S3Object s3Object;

onCreate() {
 s3Client = new AmazonS3Client(new BasicSessionCredentials(Constants.ACCESS_KEY_ID, Constants.SECRET_KEY, Constants.TOKEN));

 object = new S3Object();
}

doinbackground() {
      object = s3Client.getObject(new GetObjectRequest(Constants.getBucket(), id +".png"));
 } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-12-05T18:23:17.587

我遇到了同样的问题，这个主题帮助我解决了这个问题：[S3 Java 客户端因“内容长度分隔的消息体过早结束”或“java.net.SocketException 套接字已关闭”而失败了很多](https://stackoverflow.com/questions/9952815/s3-java-client-fails-a-lot-with-premature-end-of-content-length-delimited-messa)

基本上我为每个文件创建了一个新的 S3Client 对象，但有一次这个对象被垃圾收集了。因此，我没有这样做，而是将我的班级改为使用 Singleton ：

```
private static AmazonS3 s3Client;
  static {
    s3Client = new AmazonS3Client(new BasicAWSCredentials(AWSKey, AWSSecretKey));
  }

  public AmazonS3 getService() {
    return s3Client;
  } 
```

# wcf - 实体框架和 WCF。最好的方法？

> ID：11440893
> 
> 赞同：0
> 
> 时间：2012-07-11T20:24:56.587
> 
> 标签：wcf, entity-framework-4.1

我正在开发 n 层架构，而对于数据访问层，我使用的是 Entity Framework 4.1。数据库只公开存储过程。我还有一个额外的层，服务层，在 WCF 中开发。对于每个服务调用，在 using 语句中使用新的数据上下文。考虑到服务调用将达到每秒 1000 次，这种做法对吗？

最好的祝福。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T20:50:32.323

每秒 1000 - 如果您的服务真的需要做某事，您将需要非常好的服务器或负载平衡的环境。

如果您的数据库仅公开存储过程并且您无法执行直接 SQL（= 您无法使用 LINQ），则没有理由使用 EF。实际上，您不应该这样做的原因有很多，因为除了性能更差之外，它不会给您任何额外的价值。此外，如果您的存储过程使用多个结果集、表值参数和其他一些高级技术，您将根本无法从 EF 4.1 使用它们。

使用直接 ADO.NET 将允许您异步执行查询，这可能导致[异步 WCF 服务操作](http://msdn.microsoft.com/en-us/library/ms731177.aspx#Y574)= 更好地利用您的计算能力和更好的吞吐量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T21:31:38.143

您应该更多地担心服务器负载平衡、可扩展性、WCF 性能问题，包括但不限于并发、限制。您应该选择可以根据您的需要轻松扩展且未来故障时间最短的绑定。

此外，您应该确保在后端进行了良好的多线程设计，以支持 1000 次调用/秒的基准测试（我仍然想知道它是什么）并提高服务的吞吐量。

EF 在您的情况下没有任何作用。您需要这里的原始性能。不要通过添加另一层不必要的东西来杀死。

对于负载平衡，您可以从这里[开始](http://msdn.microsoft.com/en-us/library/hh273122.aspx)

# php - PHP查询失败，显示错误？

> ID：11440897
> 
> 赞同：3
> 
> 时间：2012-07-11T20:25:09.700
> 
> 标签：php, mysql

我的页面上有一个查询，它使用 GET 变量从我的表中提取数据......

如果我回显我的 GET var 数据就在那里，所以我的查询做错了，而不是或死，我可以在浏览器中显示错误吗？

```
// Get USER ID of person
$userID = $_GET['userID'];

// Get persons
$sql = 'SELECT * FROM persons WHERE id = $userID';
$q   = $conn->query($sql) or die('failed!'); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-11T20:31:45.187

```
$sql = "SELECT * FROM persons WHERE id = $userID"; 
```

您必须使用双引号在查询字符串中使用变量。

你也可以这样做：

```
$sql = "SELECT * FROM persons WHERE id = ".$userID; 
```

你应该做的是（保护自己免受[sql 注入](http://en.wikipedia.org/wiki/SQL_injection)）：

```
$safeuid = $conn->prepare($userID);
$sql = "SELECT * FROM persons WHERE id = ".$safeuid; 
```

您始终可以在 php 页面顶部使用它进行调试：

```
ini_set('display_errors',1); 
error_reporting(E_ALL); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T20:29:08.853

你试过`$q = $conn->query($sql) or die($conn->error());`吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T20:28:42.217

是的，你可以，但你应该只为调试而这样做。破解者可以通过有目的地输入错误的输入并阅读错误来获得很多洞察力。

我假设您使用的是 MySQLi；命令是`$conn->error()`。所以你的行将是：

```
$q = $conn->query($sql) or die($conn->error()); 
```

另外，你做错了什么是你使用单引号来定义`$sql`. 您需要使用双引号来写入`$userID`字符串。所以你想要的是：

```
$sql = "SELECT * FROM persons WHERE id = $userID"; 
```

或者

```
$sql = 'SELECT * FROM persons WHERE id = ' . $userID; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-11T20:31:10.517

您需要使用双引号来评估字符串中的变量。那是，

```
$sql = 'SELECT * FROM persons WHERE id = $userID'; 
```

应该

```
$sql = "SELECT * FROM persons WHERE id = $userID"; 
```

而不是删除`die`您应该确保查询始终有效。换句话说：验证**参数**`userID`。`$_GET`可以包含用户想要提供的任何东西——它可以是一个数组，它可以是一个字符串，它可以是一个带有恶意负载的字符串，它可以[删除你的表](https://xkcd.com/327/)。所以*检查*它是一个整数。如果不是，则向用户返回相关消息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-11T20:33:33.010

不是 php 专家，但您可以尝试：

```
// Get USER ID of person
$userID = $_GET['userID'];

// Get persons
$sql = 'SELECT * FROM persons WHERE id = $userID';
$q   = $conn->query($sql) or die('failed!' . mysql_error()); 
```

该错误应附加到您的 die 消息的末尾。

# perl - 如何用 Perl 计算文本中的“真实”单词？

> ID：11440902
> 
> 赞同：3
> 
> 时间：2012-07-11T20:25:35.660
> 
> 标签：perl, text, text-processing

我遇到了文本处理问题。我有一篇文章，我想知道有多少“真实”的单词。

这就是我所说的“真实”。文章通常包含各种标点符号，如破折号，逗号，点等。我想知道有多少单词，跳过“ `-`”破折号和“ `,`”逗号带空格等。

我试过这样做：

```
my @words = split ' ', $article;
print scalar @words, "\n"; 
```

但这包括各种标点符号，其中包含空格作为单词。

所以我正在考虑使用这个：

```
my @words = grep { /[a-z0-9]/i } split ' ', $article;
print scalar @words, "\n"; 
```

这将匹配所有包含字符或数字的单词。您认为，这是否足以计算文章中的字数？

有谁知道CPAN上的一个模块可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T20:48:09.203

尝试使用：`\W`- 任何非单词字符，并删除 _

**解决方案**

```
use strict;

my $article = 'abdc,  dd_ff,  11i-11,  ff44';

# case David's, but it didn't work with I'm or There's
$article         =~ s/\'//g; 
my $number_words = scalar (split /[\W_]+/, $article);

print $number_words; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T22:35:53.030

我认为您的解决方案与您将获得的一样好，而无需诉诸复杂的东西。

你也可以写成

```
my @words = $article =~ /\S*\w\S*/ 
```

或通过写来计算文件中的单词

```
my $n = 0;
while (<>) {
  my @words = /\S*\w\S*/g;
  $n += @words;
}

say "$n words found"; 
```

尝试一些示例文本块并查看它找到的“单词”列表。如果您对此感到满意，那么您的代码就可以工作。

# django - 在 django unittest 中使用 django-social-auth 登录

> ID：11440908
> 
> 赞同：0
> 
> 时间：2012-07-11T20:25:59.657
> 
> 标签：django, django-testing, django-socialauth, django-unittest

我正在为 django 项目编写一个测试套件，该项目需要通过 django-social-auth （它的 facebook 后端）登录才能访问该网站。

我现在采取的方法是：

*   对于每个测试：
    *   使用 facebook API 创建测试用户
    *   使用硒登录
    *   用户登录后与网站交互

问题是：我需要编写一些使用常规 django unittest（不是 selenium）的测试。知道如何使用常规 django unittest 登录吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T23:15:40.367

这不是一件容易的事，因为 oauth 代码在 social-auth 中非常耦合。所以你真的需要一个oauth服务来回答。

我所做的是`social_auth.utils.urlopen`用一个模拟来修补函数，该模拟返回以前记录的答案，以欺骗 django-social-auth 使其认为它正在与真正的 oauth 提供者交谈。

这是一个非常老套的解决方案，但允许我在隔离环境中测试我的自定义社交身份验证管道。

# c# - 如何调试 LINQ 结果

> ID：11440911
> 
> 赞同：3
> 
> 时间：2012-07-11T20:26:04.247
> 
> 标签：c#, linq, debugging, linq-to-objects

我是 linq 的新手。所以有时只是不明白 linq 是如何工作的。所以VS2010 IDE中有任何工具或内置机制来详细调试linq执行。假设我有这个 linq 查询

```
var to_search = new[] { "Geo", "JCB" };

var result = from sr in list
             let w = to_search.FirstOrDefault(ts => sr.Title.ToLower().Contains(ts.ToLower()))
             where w != null
             let a = new {sr=sr, word=w.ToLower()}
             group a by a.word into g
             orderby g.Count() descending
             let sorted = g.OrderByDescending(a=> a.sr.Title.Select((c, i) => a.sr.Title.Substring(i)).Count(sub => sub.ToLower().StartsWith(a.word)))
             from a in sorted 
             select a.sr;

var completeList = result.Concat(list.Except(result)); 
```

如何详细调试上面的 linq 查询。请指导我。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-12T19:19:39.120

对于这个看似简单的问题，可以写很多东西！事实上，我已经在 Simple-Talk.com 上的文章[LINQ Secrets Revealed: Chaining and Debugging中详细写过。](http://www.simple-talk.com/dotnet/.net-framework/linq-secrets-revealed-chaining-and-debugging/)以下是其关键点的摘要：

*   您可以使用调试器单步执行一些 LINQ 查询，但这取决于查询中表达式和语句的组成（因为您只能单步执行*statements*）。
*   LINQ 方法链之所以起作用，是因为有一个基本规则：每个*非终端*方法都将`IEnumerable<T>`其作为输入并`IEnumerable<T>`作为输出返回。
*   你可以注入一个“no-op”语句来给你一个“垫脚石”，如果你愿意的话，只要它符合那个基本规则。也就是说，意识到您总是可以`.Select(z => z)`毫无后果地放入方法链中，请使用它的变体，即：`z => { return z; }`。
*   您可以类似地注入诊断方法来提供输出，而不仅仅是提供潜在的断点。[LINQPad](http://www.linqpad.net/)是出色的暂存器，不仅适用于 LINQ，而且通常适用于 C#，它以其强大的`Dump()`方法提供了这一点。Dump 是一个对象可视化工具，可提供复杂数据结构的惊人可视化。
*   基于 Bart De Smet 在其内容丰富的文章[LINQ to Objects - 调试](http://community.bartdesmet.net/blogs/bart/archive/2009/04/23/linq-to-objects-debugging.aspx)您可以将简化的风格`Dump`带回 Visual Studio 中的工作 - 我提供了附加到我在顶部提到的文章的代码。
*   感谢 Robert Ivanc 在[LINQPad Visualizer](http://code.google.com/p/linqpadvisualizer/)上的工作，您甚至可以将 LINQPad 可视化器带入 Visual Studio（尽管您需要为单个表达式手动启动它；您不能将其连接到`Dump()`方法）。

作为一个简单的例子，考虑这个简单的方法链：

```
string[] Words = new string[]
{"   KOOKABURRA", "Frogmouth", "kingfisher   ", "loon", "merganser"};

Words
        .Select(word => word.Trim())
        .Select(word => word.ToLower())
        .Where(word => word.StartsWith("k"))
        .OrderBy(word => word); 
```

在 Visual Studio 项目中包含 Dump 扩展方法后，您可以像这样最低限度地检测它...

```
Words
    .Select(word => word.Trim())
    .Dump()
    .Select(word => word.ToLower())
    .Dump()
    .Where(word => word.StartsWith("k"))
    .Dump()
    .OrderBy(word => word)
    .Dump(); 
```

...或者更详细地像这样...

```
Words
    .Dump(w => "ORIGINAL: " + w, ConsoleColor.Yellow)
    .Select(word => word.Trim())
    .Dump(w => "TRIMMED: " + w, ConsoleColor.Yellow)
    .Select(word => word.ToLower())
    .Dump(w => "LOWERCASE: " + w, ConsoleColor.Green)
    .Where(word => word.StartsWith("k"))
    .Dump(w => "FILTERED to 'K': " + w, ConsoleColor.Red)
    .OrderBy(word => word)
    .Dump(w => "SORTED: " + w, ConsoleColor.Blue); 
```

... 将输出分别呈现为图形的左侧或右侧： ![Visual Studio 中 Dump 方法的诊断输出](../Images/00fc6c41de1f3b56851835eec4099417.png)

作为一个预告片，我会说虽然这确实很有用，但您确实必须看到 LINQPad 可以使用相同的输出实现的增强可视化（为了您的方便，[这里](http://www.simple-talk.com/dotnet/.net-framework/linq-secrets-revealed-chaining-and-debugging/)再次提供链接）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T21:47:27.507

我的做法是在查询中插入断点，或者使用名为 LINQPad 的工具。 [http://www.linqpad.net/](http://www.linqpad.net/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T20:29:44.910

我相信您应该能够像在任何其他代码中一样放置断点。我不是 100% 确定，因为我经常将 LINQ 语法写成匹配的扩展方法。

但是，这是另一种选择，您可以使用扩展方法重写查询并在每个方法上添加断点。

但是，如果有疑问，请使用 F11 :)

此外，LINQPad 应该能够在这里提供一些帮助。

# c# - Windows 无法启动服务

> ID：11440914
> 
> 赞同：5
> 
> 时间：2012-07-11T20:26:22.053
> 
> 标签：c#, windows-services

我正在开发一个应用程序来安装和作为 Windows 服务运行。它仍然有问题并且意外停止（在 Windows 事件日志中也没有留下任何内容），当我尝试再次启动它时，我得到了错误

> Windows 无法在本地计算机上启动 {name of service} 服务。错误 1067：进程意外终止。

我重新启动了计算机（Server 2008 R2；一个虚拟机，以防有什么不同），没有任何帮助。卸载并重新安装了我的服务，但仍然出现该错误！

*机器上的某些东西*需要清除/刷新，以便它会尝试再次启动服务。我不想重建整个虚拟机，但我没有想法。

**更新**

我忘了提到这个 Windows 服务——完全相同的代码和安装——正在其他 3 台机器上*运行**而没有*上述错误。将调试器放入 OnStart() 听起来仍然是可行的方法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-11T20:53:52.840

如果您有权访问代码，则可以在方法[`Debugger.Break`](http://msdn.microsoft.com/en-us/library/system.diagnostics.debugger.break.aspx)的第一行添加一个[`OnStart`](http://msdn.microsoft.com/en-us/library/system.serviceprocess.servicebase.onstart.aspx)方法。

一旦您“闯入”应用程序，请调查引发异常的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T22:16:50.453

您可以将调试器附加到正在运行的服务。[调试 Windows 服务应用程序](http://msdn.microsoft.com/en-us/library/7a50syb3%28v=vs.80%29.aspx?ppud=4)中的详细信息。

幸运的是，您可以轻松地复制问题。您可以使用代码安装 .NET Studio 来调试您的问题。

另一种技术是把服务变成一个普通的应用程序。您知道可疑代码在启动期间。因此，只需在 Startup 函数中使用代码创建应用程序，然后从那里开始调试。

祝你好运，

汤米奎

# git - 预提交挂钩中的 git stash 在第一次提交时失败

> ID：11440916
> 
> 赞同：2
> 
> 时间：2012-07-11T20:26:25.453
> 
> 标签：git, githooks, pre-commit-hook, git-stash

我正在研究一个使用 YUI Compressor 的预提交钩子来缩小任何已准备提交的 CSS 和 JavaScript 文件。文件缩小后，缩小的版本会自动暂存以进行提交。我读过自动将机器生成的文件添加到提交中通常不是一个好主意，但我认为在这种情况下它是可以的。这是它的样子：

输出`git status`：

```
# On branch master
# Changes to be committed:
#   (use "git reset HEAD <file>..." to unstage)
#
#   modified:   _site-wide.css
#
# Changes not staged for commit:
#   (use "git add <file>..." to update what will be committed)
#   (use "git checkout -- <file>..." to discard changes in working directory)
#
#   modified:   _subpage.css
# 
```

输出`git commit -m "Updated site-wide styling"`：

```
1 CSS file was minified and added to the Git repository
0 JavaScript files were minified and added to the Git repository
[master 41f1815] Updated site-wide styling
 2 files changed, 2 insertions(+), 2 deletions(-) 
```

这里发生的是 pre-commit hook 使用 YUI Compressor 来缩小`_site-wide.css`，将结果输出到`site-wide.css`（没有前导下划线）。然后它上演`site-wide.css`提交。预提交钩子跳过了，`_subpage.css`因为尽管它已被修改，但它并没有被提交。

由于磁盘上的 CSS 和 JavaScript 文件可能与暂存于提交的 CSS 和 JavaScript 文件不同，因此我`git stash -q --keep-index`在压缩文件之前运行，然后在`git stash pop -q`之后运行。这个预提交钩子在已经有提交的存储库上工作得很好，但是如果我在第一次提交之前将预提交钩子放在适当的位置，我会得到这个：

输出`git status`：

```
# On branch master
#
# Initial commit
#
# Changes to be committed:
#   (use "git rm --cached <file>..." to unstage)
#
#   new file:   _site-wide.css
#   new file:   _subpage.css
# 
```

输出`git commit -m "Initial commit"`：

```
fatal: bad revision 'HEAD'
fatal: bad revision 'HEAD'
fatal: Needed a single revision
You do not have the initial commit yet
2 CSS files were minified and added to the Git repository
0 JavaScript files were minified and added to the Git repository
No stash found. 
```

输出`git status`：

```
# On branch master
#
# Initial commit
#
# Changes to be committed:
#   (use "git rm --cached <file>..." to unstage)
#
#   new file:   _site-wide.css
#   new file:   _subpage.css
#   new file:   site-wide.css
#   new file:   subpage.css
# 
```

我现在将粘贴预提交挂钩的代码。请记住，为了灵活，我编写了这个脚本，以便它可以在任何 CakePHP 项目中运行，而不仅仅是具有 Git 存储库的项目。我还编写了它，以便您可以强制它缩小所有 CSS 和 JavaScript 文件，而不仅仅是暂存提交的文件。这是通过运行来完成的`.git/hooks/pre-commit force`。这是代码：

```
#!/bin/bash

css_files_to_ignore=(
    #"_do_not_minify.css"
)

js_files_to_ignore=(
    #"_do_not_minify.js"
)

if git rev-parse --git-dir > /dev/null 2>&1; then
    git_repository=true
    base_folder="$(git rev-parse --show-toplevel)/app/webroot"

    if [ "$1" == "force" ]; then
        process_unstaged_files=true
    else
        process_unstaged_files=false
    fi
else
    git_repository=false
    base_folder="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)/webroot"
fi

if [ -f /Applications/yuicompressor.jar ]; then
    # Mac

    yuicompressor_path=/Applications/yuicompressor.jar
else
    # Linux

    yuicompressor_path=$(command -v yui-compressor)
fi

function process_assets()
{
    extension=$1
    files_minified=0

    for infile in $(echo "$base_folder/$extension/*.$extension")
    do
        # Only process files.

        [[ -f $infile ]] || continue

        filename=${infile##*/}

        # If the filename starts with an underscore, that means that the file is
        # eligible for minification.

        [[ ${filename:0:1} == "_" ]] || continue

        ignore_this_file=false

        files_to_ignore=$extension"_files_to_ignore"

        for i in $(eval echo \${$files_to_ignore[@]})
        do
            if [[ $i == $filename ]]; then
                ignore_this_file=true
                break
            fi
        done

        if [ $git_repository == true ] && [ $process_unstaged_files == false ] && git diff --quiet --cached $infile; then
            # This file is NOT staged for commit.

            ignore_this_file=true
        fi

        if [ $ignore_this_file == false ]; then
            minified_file="$base_folder/$extension/${filename:1}"

            if [ ! -f "$minified_file" ] || test $infile -nt $minified_file; then
                $yuicompressor_command "$infile" -o "$minified_file"

                if [ $git_repository == true ] && [ $process_unstaged_files == false ]; then
                    git add "$minified_file"
                fi

                ((files_minified++))
            fi
        fi
    done

    # Output a summary of what was done.

    if [ $extension == "css" ]; then
        file_type="CSS"
    else
        file_type="JavaScript"
    fi

    echo -n "$files_minified $file_type file"

    if [ $files_minified -eq 1 ]; then
        echo -n " was"
    else
        echo -n "s were"
    fi

    echo -n " minified"

    if [ $git_repository == true ] && [ $process_unstaged_files == false ]; then
        echo " and added to the Git repository"
    else
        echo
    fi
}

if [ -f "$yuicompressor_path" ]; then
    if [ ${yuicompressor_path: -4} == ".jar" ]; then
        yuicompressor_command="java -jar $yuicompressor_path"
    else
        yuicompressor_command=$yuicompressor_path
    fi

    if [ $git_repository == true ] && [ $process_unstaged_files == false ] && ! git diff --quiet --cached; then
        # The staging area is what should be processed rather than what is currently
        # on disk.

        git stash -q --keep-index

        stashed=true
    else
        stashed=false
    fi

    process_assets css
    process_assets js

    if [ $stashed == true ]; then
        git stash pop -q
    fi
else
    echo "YUI Compressor was not found. Aborting."
    exit 1
fi 
```

我怎样才能使这项工作？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T16:30:33.003

我得出的结论是没有解决方案，因为当没有 HEAD 时，一些 Git 命令根本不起作用。另外，在考虑了更多之后，我决定无论如何这都是一种边缘情况，至少对我来说是这样，因为我的第一次提交通常是一些基本的东西，比如我使用的框架的文件。所以我可以在第一次提交后实现钩子。

我感谢 Hassek 的时间以及其他阅读本文的人的时间。谢谢！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-04-22T16:09:05.060

使用 Git 2.22（2019 年第二季度，7 年后），有一个，用[`git stash`C 重写](https://stackoverflow.com/a/52318372/6309)。

请参阅[Paul-Sebastian Ungureanu ( ) 的](https://github.com/weekly-digest[bot])[提交 1ac528c](https://github.com/git/git/commit/1ac528c0b0c3f3e8a5faa75ea25f422fcbc2ba39)（2019 年 2 月 25 日[）](https://github.com/weekly-digest[bot])。 [`weekly-digest[bot]`](https://github.com/weekly-digest[bot])

> ## `stash`:`push -q`安静
> 
> 此提交的行为发生了变化。
> 当没有初始提交时，stash 的 shell 版本仍会显示一条消息。如果指定或指定，
> 此提交`push`将不显示任何消息。`--quiet``-q`

因此，从Git 2.22的新 rewritten-in-C 命令开始，您不应该看到`You do not have the initial commit yet`带有 的“” 。`git stash -q <command>``stash`

# jquery - jQuery - 获取 AJAX 响应标头

> ID：11440918
> 
> 赞同：49
> 
> 时间：2012-07-11T20:26:42.880
> 
> 标签：jquery, httpresponse

当我们使用 jQuery 触发 ajax 请求时，我们如何访问响应头？根据某些站点中给出的建议，我尝试使用以下代码。但是`xhr`对象是空的。我在这种情况下看到了一个`xhr`对象。但它没有访问响应标头的方法。

```
function SampleMethod() {
  var savedThis = this;
  this.invokeProcedure = function(procedurePath) {
    $.ajax({
      type: "GET",
      url: procedurePath,
      dataType: "json",
      success: function(data,status,xhr) savedThis.resultSetHandler(data,status,xhr);}
    });
  }

  this.resultSetHandler=function(data,status,xhrObj){
    //Handle the result
  }

  this.errorHandler = function(args) {
    //Handle the result
  }

}

var sampleObj = new SampleMethod();
sampleObj.invokeProcedure('url'); 
```

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2012-07-12T20:16:47.910

> 为了与 XMLHttpRequest 向后兼容，jqXHR 对象将公开以下属性和方法：*getAllResponseHeaders()* 和 *getResponseHeader()*。来自 $.ajax() 文档：[http ://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

对于 jQuery > 1.3

```
success: function(res, status, xhr) { 
  alert(xhr.getResponseHeader("myHeader"));
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-11-20T11:22:42.273

**对于 JQUERY 3 及更高版本**

这是对我有用的解决方案：

```
//I only created this function as I am making many ajax calls with different urls and appending the result to different divs
function makeAjaxCall(requestType, urlTo, resultAreaId){
  var jqxhr = $.ajax({
    type: requestType,
    url: urlTo
  });

  //this section is executed when the server responds with no error 
  jqxhr.done(function(){
  });

  //this section is executed when the server responds with error
  jqxhr.fail(function(){
  });

  //this section is always executed
  jqxhr.always(function(){
    //here is how to access the response header
    console.log("getting header " + jqxhr.getResponseHeader('testHeader'));
  });
} 
```

# sql - 如果没有可用日期，则使用最新汇率

> ID：11440921
> 
> 赞同：0
> 
> 时间：2012-07-11T20:26:49.427
> 
> 标签：sql, oracle

将 oracle 9i 与 SQL 开发人员一起使用

如果表 2 中没有日期，有人可以告诉我如何使用最近日期的汇率值。目前我已将 6 月 4 日（星期一）硬编码为使用星期四的汇率，因为没有 6 月 4 日的汇率。周末是最容易的部分。但我想这样做，而不必手动硬编码假期日期。有人可以帮忙吗？

```
select 
m.effective_date, 
m.value*al.rate

from table1 m, table2 al
where  
M.ID = al.ID 
AND M.EFFECTIVE_DATE BETWEEN '01-jun-12' and '30-jun-12'
and AL.value_date = m.EFFECTIVE_date -     ( case     
when m.EFFECTIVE_date = '04-jun-12' then 3
when to_char(m.EFFECTIVE_date,'DY') = 'SUN' then 2  
when to_char(m.EFFECTIVE_date,'DY') = 'SAT' then 1  
ELSE 0  
end ) 

table1 

Effective_date         Value
06-01-2012            100
06-02-2012            200
06-03-2012            600
06-04-2012           600
 All the way to 06-30-2012  

Table 2 (does not have weekends and some dates depending on UK holiday)

Value_date           Rate
06-01-2012           1.2
06-05-2012            1.5
06-06-2012            5.3
06-07-2012            1.5
06-08-2012            5.6
06-11-2012            1.5
06-12-2012             1.9
06-13-2012             2.1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T20:33:04.187

尝试这个：

```
SELECT m.effective_date, 
m.value*al.rate
from table1 m, table2 al
where  
M.ID = al.ID 
AND M.EFFECTIVE_DATE BETWEEN '01-jun-12' and '30-jun-12'
WHERE m.effective_dt = (SELECT MAX(effective_dt) FROM table1 x 
WHERE x.effective_dt <= a1.value_dt) 
```

# mysql - 创建简单表时出错

> ID：11440922
> 
> 赞同：0
> 
> 时间：2012-07-11T20:26:54.333
> 
> 标签：mysql, sql

我不明白为什么会失败：o

```
CREATE TABLE "Permission" (
"id" INTEGER NOT NULL,
"name" VARCHAR(255) NOT NULL,
PRIMARY KEY ("id") 
); 
```

讯息

```
Error : You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '"Permission" (
"id" INT NOT NULL,
"name" VARCHAR(255) NOT NULL,
PRIMARY KEY ("id' at line 1 
```

感谢您的任何想法！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T20:29:00.337

您使用了错误的引用字符。您应该对表名和列使用“标记而不是”标记。

```
 CREATE TABLE `Permission` (
`id` INTEGER NOT NULL, 
`name` VARCHAR(255) NOT NULL, 
 PRIMARY KEY (`id`)  
 ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T20:32:37.793

quickshiftin 的回答很好。
你还应该改变：

```
`id` INTEGER NOT NULL, 
```

到：

```
`id` INT NOT NULL, 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T20:41:44.740

正如 quickshiftin 的回答所说，MySQL 通常使用反引号字符来包围对象引用。

但是使用双引号并不是真的“错误”，只是 MySQL 默认行为是不允许以这种方式使用双引号。

`ANSI_QUOTES`通过为会话启用 sql 模式，可以让 MySQL 允许在对象引用周围使用双引号字符。我建议您仅暂时执行此操作，只是为了定义您的表，然后将其重新设置。

```
SHOW VARIABLES LIKE 'sql_mode'

SET sql_mode = 'ANSI_QUOTES' 
```

在设置 sql_mode 变量之前，您需要记下当前设置，以便在创建表后将其重新设置。

```
SET sql_mode = '' 
```

也可以在数据库级别设置此变量，但我以前从未见过这样做过。我只（暂时）在会话级别覆盖了默认值，用于导入使用双引号的 SQL 表定义。

# java - 如何安装 Xuggler？

> ID：11440927
> 
> 赞同：5
> 
> 时间：2012-07-11T20:27:02.783
> 
> 标签：java, apache, maven, video, netbeans

我正在尝试安装 Xuggler。为了安装这些，我应该先下载它们。于是，我去了他们的下载页面。http://www.xuggle.com/downloads

没有下载 .jar 文件的下载链接。但是一些Maven的东西。这是否意味着，我必须使用 Maven 下载它？很抱歉问这个问题，但我对maven一无所知。如果答案是肯定的，请您逐步指导我，从创建 maven 项目到安装 xuggler。有关更多信息，我正在使用 netbeans，但也得到了 eclipse。

请帮忙

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T12:15:49.047

可以在这里找到下载：http: [//xuggle.googlecode.com/svn/trunk/repo/share/java/xuggle/xuggle-xuggler/](http://xuggle.googlecode.com/svn/trunk/repo/share/java/xuggle/xuggle-xuggler/)

它在他们的下载页面中有点隐藏，请查找“在没有 Apache Maven 或 Apache Ivy 的情况下使用 Xuggler”。此外，我也加入了他们的建议 - 学习 Maven，看看它可以对您的项目做些什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-10T18:30:42.590

我也很难找到安装程序，突然出现了这个链接。

似乎有人收拾残局并继续托管安装程序文件。

Xuggler 的开发被宣布在 2011 年（左右）停止——从那时起，现有的文档就走下坡路了（比如“操作方法”部分中缺少视频）。

适用于 Windows 7 64 位的工作安装程序： [https ://groups.google.com/forum/?fromgroups=#!topic/xuggler-users/_CENGtVgMwQ](https://groups.google.com/forum/?fromgroups=#!topic/xuggler-users/_CENGtVgMwQ)

# spring - 找不到元素“上下文：组件扫描”的声明

> ID：11440928
> 
> 赞同：4
> 
> 时间：2012-07-11T20:27:03.333
> 
> 标签：spring, google-app-engine

我从 Spring 3 (3.1.2) 和 Google App Engine 开始。

我已经在网上学习了一个教程，现在，我的 bean-realted xml 在启动时出现了问题。

这是代码

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:context="http://www.springframework.org/schema/context"
xsi:schemaLocation="http://www.springframework.org/schema/beans 
http://www.springframework.org/schema/beans/spring-beans.xsd
http://www.springframework.org/schema/context/
http://www.springframework.org/schema/context/spring-context.xsd">
<context:component-scan base-package="my.example"> 
```

其中所有java文件的根包是“my.example”。子包是带有子包的“模型”和“控制器”。现在。

当我启动应用程序时，我收到此错误：

```
org.springframework.beans.factory.xml.XmlBeanDefinitionStoreException: Line 10 in XML document from ServletContext resource [/WEB-INF/spring-servlet.xml] is invalid; nested exception is org.xml.sax.SAXParseException: cvc-complex-type.2.4.c: The matching wildcard is strict, but no declaration can be found for element 'context:component-scan'. 
```

有更多的堆栈跟踪。

有谁知道我该如何解决这个问题？我检查了 XSD，它们似乎是正确的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:07:12.890

问题是架构位置与您的 spring-context 依赖项不兼容。

代替

```
http://www.springframework.org/schema/context/spring-context.xsd 
```

经过

```
http://www.springframework.org/schema/context/spring-context-2.5.xsd 
```

这应该够了吧！我使用的是 spring-context 3.1.1，并且在参考[http://www.springframework.org/schema/context/spring-context-2.1.xsd时遇到了同样的错误](http://www.springframework.org/schema/context/spring-context-2.1.xsd)

但是，您还应该做一个 maven 树依赖并检查您是否有不同的 spring 版本。这个错误也可能是由于这个事实......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T21:47:08.140

您可能缺少 spring-context.jar，它包含上下文模式的定义。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T19:45:59.063

我不知道这是否有帮助，但是在使用[maven shade 插件](http://maven.apache.org/plugins/maven-shade-plugin/)制作单个 .jar 时，我遇到了一个与您非常相似的错误，并且 shade 插件清除了.jar`spring.handlers`和`spring.schemas`.`META-INF/`

这个 SO 答案为我指明了正确的方向：[https ://stackoverflow.com/a/3650844/7008](https://stackoverflow.com/a/3650844/7008)

关于使用 AppendingTransformer 将这些弹簧位添加回您的`META-INF/`文件夹的文档对我有用：[http ://maven.apache.org/plugins/maven-shade-plugin/examples/resource-transformers.html#AppendingTransformer](http://maven.apache.org/plugins/maven-shade-plugin/examples/resource-transformers.html#AppendingTransformer)

# modelica - 如何在 Dymola/Modelica 中仅模拟三个子模型之一

> ID：11440932
> 
> 赞同：2
> 
> 时间：2012-07-11T20:27:21.570
> 
> 标签：modelica, dymola

我是 Dymola 的新手，我必须在 Dymola 中实现一个化学反应器。我在 3 个不同的模型中对反应器的行为进行了建模，因为反应器的行为取决于变量 x。所以模型a对x<=0.1有效，模型2对0.75>x<0.1有效，模型3对x>0.75有效。有没有办法在每个模拟步骤中只运行三个模型中的一个？我研究了“if”语句，将所有 3 个模型方程放在一个模型中，但这没有用。有没有人可以帮助我？任何提示都会很棒！谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-14T05:49:54.233

Modelica 不处理可变结构问题。这意味着在模拟过程中变量集不能改变。

大多数试图解决此类系统的人通常会找到一种方法来保持所有变量存在，但通过切换方程以某种方式“停用”不同的集合（在某种程度上，在模拟过程中可能会发生变化）。

如果您提供有关需要在其之间切换的模型类型的更多信息，我可以尝试为您提供一些关于如何将它们从一个阶段“停用”到另一个阶段的提示。

# crystal-reports - Crystal Reports：以页码为条件抑制详细信息部分

> ID：11440938
> 
> 赞同：0
> 
> 时间：2012-07-11T20:27:47.787
> 
> 标签：crystal-reports

我有一个关于抑制不同详细信息部分的 Crystal Reports 问题，感谢您提供的任何帮助。

我有 2 个详细信息部分，A 和 B，我希望 detailsA 仅显示在第 1 页上，而 detailsB 仅显示在第 2 页上，但我无法使用条件抑制使其工作。有关详细信息，我根据以下公式进行了抑制：

如果页码 = 1 那么

公式 = 假

别的

公式 = 真

万一

同样对于细节B。但是当我然后去打印这个时，它只显示第 1 页（只有 detailsA），它不打印第 2 页。如何强制第 2 页也打印？

（顺便说一句，我正在使用 Crystal Reports 10，以防万一）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T20:48:44.390

条件抑制公式：

```
//section a
PageNumber=2

//section b
PageNumber=1 
```

** 编辑 **

我怀疑以下几点：

*   抑制公式抑制第 1 页。
*   第 2 页现在是第 1 页
*   抑制公式抑制第 1 页（nee 2）。

最简单的解决方案是在详细信息 A 上启用“强制新页面之后”。

# c# - 清除登录页面中的缓存

> ID：11440940
> 
> 赞同：0
> 
> 时间：2012-07-11T20:27:50.420
> 
> 标签：c#, asp.net, authentication, caching

我有一个 asp.net 登录页面。为了安全起见，我想清除缓存。但我不知道我应该把代码放在哪里。

感谢您提供代码片段建议。

```
 protected void Login1_Authenticate(object sender, AuthenticateEventArgs e)
    {
        bool UserAuthenticated = false;
        MembershipProvider AuthenticationProviderUsed = null;
        RoleProvider roleProvider = Roles.Providers["SqlRoleProvider"];
        // Try authenticating the user against each membership provider
        foreach (MembershipProvider membershipProvider in Membership.Providers)
        {
            try
            {
               ...
                 Page.Session.Add("workspriv", access_value);
            }
          if (UserAuthenticated)
          {
            Response.Redirect("~/Search.aspx");
          }
  }     

    protected void Page_Load(object sender, EventArgs e)
    {
        lblDisclaimerText.Text = AntiXss.HtmlEncode(ConfigurationManager.AppSettings["DisclaimerText"]);
        if (!IsPostBack)
        {
            if (Request.QueryString["Action"] != null && Request.QueryString["Action"].ToLower() == "logout")
            {
                Session.Abandon();
                FormsAuthentication.SignOut();
                FormsAuthentication.RedirectToLoginPage();

            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:32:12.263

> 我只是担心用户的登录信息存储在缓存中

它不是。如果用户在离开页面后可以重新建立会话，那是因为他们仍然拥有上次访问的会话 cookie。

话虽如此，如果您仍想清除缓存：

要清除缓存内存，您可以执行以下操作：

```
IDictionaryEnumerator enumerator = HttpContext.Current.Cache.GetEnumerator();

while (enumerator.MoveNext())

{

    HttpContext.Current.Cache.Remove(enumerator.Key);

} 
```

清除输出缓存：

```
HttpRuntime.Close(); 
```

[http://weblogs.asp.net/morteza/archive/2008/08/11/how-to-remove-all-items-from-cache-memory.aspx](http://weblogs.asp.net/morteza/archive/2008/08/11/how-to-remove-all-items-from-cache-memory.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T20:36:43.787

请在此行之前调用它 bool UserAuthenticated = false; 或页面加载

```
List<string> cacheList = (from DictionaryEntry cache in HttpRuntime.Cache select cache.Key.ToString()).ToList();
cacheList.ForEach(c => HttpRuntime.Cache.Remove(c)); 
```

# javascript - Javascript数组排序速度受字符串长度影响？

> ID：11440942
> 
> 赞同：0
> 
> 时间：2012-07-11T20:28:10.673
> 
> 标签：javascript, sorting

只是想知道，我在这个问题上看到了不同的意见。

如果你取一个字符串数组，比如 1000 个元素并使用 sort 方法。哪个会更快？一个字符串长度为 100 个字符的数组，还是一个字符串长度只有 3 个字符的数组？

我尝试测试，但目前 Firebug 有一个错误，并且 Date() 显得过于随机。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:30:38.613

这取决于字符串包含的内容，如果它们包含不同的字符，则不必检查字符串的其余部分进行比较，所以没关系。

例如，`"abc" < "bca"`这里只需要检查第一个字符。

您可以阅读此规范：[http ://ecma-international.org/ecma-262/5.1/#sec-11.8.5](http://ecma-international.org/ecma-262/5.1/#sec-11.8.5)

具体来说：

> 否则，*px*和*py*都是字符串
> 
> 1.  如果*py*是*px*的前缀，则返回**false**。（如果*q*可以是连接*p*和其他字符串*r的结果，则字符串值**p*是字符串值 *q*的前缀。请注意，任何字符串都是其自身的前缀，因为*r*可能是空字符串。）
> ****   如果*px*是*py*的前缀，则返回**true**。*   令*k*为最小的非负整数，使得*px中位置**k*处的字符与*py中位置**k*处的字符不同。（必须有这样的*k*，因为 String 都不是另一个的前缀。）****   令*m为整数，它是**px中位置**k*处 字符的代码单元值。**   令*n为整数，它是**py中位置**k*处 的字符的代码单元值。**   如果*m* < *n*，则返回**true**。否则，返回**false**。********

 *** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T20:36:28.827

这实际上取决于字符串的不同程度，但我想差异会很小，因为进行比较的方法比实际比较字符串要慢得多。

但是话又说回来，现代浏览器使用了一些特殊的优化`sort`，所以他们减少了一些比较来加快速度。这会更频繁地对一组短字符串进行排序。

仅供参考，如果您想进行一些基准测试，请使用可靠的工具，例如[jsPerf](http://jsperf.com/)。**

# android - 从 32 位机器迁移到 64 位时，我必须卸载我的应用程序

> ID：11440948
> 
> 赞同：1
> 
> 时间：2012-07-11T20:28:43.973
> 
> 标签：android, eclipse, sdk, ide

所以这听起来像是一个完整而完全的菜鸟问题，但我还是要问一下，看看我能找到什么。

我正在使用 Eclipse IDE 开发一个 Android 应用程序。我有两台我使用的开发机器（一台用于工作，一台用于家庭），一台是 64 位，另一台是 32 位。我用来测试我的应用程序的手机是 Google Nexus（Verizon 风格，最新的驱动程序）。如果我使用一台机器构建和运行应用程序，然后尝试在另一台机器上执行相同操作，我会收到一个控制台错误，告诉我运行 ADB 命令来卸载我的应用程序，因为签名已更改。

据我了解，这是因为每台机器的“debug.keystrore”（位于 %USER_HOME%/.android 中）都不同。为什么这样做？我假设应用程序签名对于应用程序而不是应用程序 + 开发机器是唯一的。这是正常行为吗？如果是这样，我能做些什么来解决它吗？我担心在机器之间复制/粘贴文件会导致问题，所以我还没有尝试过。每次切换机器时都必须移动此文件吗？另外，如果我将我的应用程序发布到野外；然后松开我的计算机并必须开始使用新计算机（因此，更改应用程序签名）安装我的应用程序的每个人都必须卸载该应用程序，因为应用程序签名不同？

奖励回合：有什么方法可以配置我的 IDE，这样我就不必在每次切换机器时更改 eclipse 查找 SDK 的位置（即让它同时在 ProgramFiles 目录和 ProgramFiles (x86) 目录中查找） .

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T20:34:24.110

为了确保应用程序是由同一开发人员构建的，Android 希望签名相同。随意在机器之间复制您的调试密钥。它与您的机器或是否为 32/64 位无关；它只能证明你是同一个开发者。

在发布您的应用程序时，您需要非常小心

1.  将您的发布密钥保密，并且
2.  在多个地方备份您的发布密钥。

如果您丢失了发布密钥，您将无法更新您的应用程序，正如您所怀疑的那样。

**更新：**为了让我的答案更完整，它看起来像是告诉 Eclipse 使用哪个键位于 Preferences -> Android -> Build 下的方式。

我使用 Linux，不使用 Eclipse；我所做的只是`~/.android/debug.keystore`从一台机器复制到另一台机器，并且 ant 构建工具会自动使用它，避免讨厌的“证书不匹配”安装错误。

对于我的发布密钥库，我在我的`ant.properties`：

```
key.store=../private/my-release-key.keystore 
```

并保存`my-release-key.keystore`在私有存储库中，效果大致相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T20:44:46.337

每个开发人员的签名都是唯一的。据我了解，如果您使用调试密钥，它会使用您的 mac 地址或其他独特特征来创建任意密钥。因此，当您在一台机器上构建应用程序并将其安装到设备上，然后再使用另一台机器时，您会遇到不同的签名，从而导致您的问题。

为了避免出现这个问题，您应该创建自己的密钥，正如其他人所提到的，然后在构建时使用它来签名。

你永远不会想用你的调试密钥发布一个应用程序，这只是为了开发，当你去发布你的应用程序时，你想使用你创建的唯一密钥。

这些密钥用于防止其他人在未经您许可的情况下更新您的应用程序，因此请创建一个您自己的开发密钥，您将不会遇到此问题。

这是一个可以帮助您入门并指向正确方向的链接：http: [//developer.android.com/tools/publishing/app-signing.html](http://developer.android.com/tools/publishing/app-signing.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T20:35:33.997

我猜谷歌团队为不同的平台创建了不同的调试密钥（我猜是为了跟踪目的）。这些调试密钥不依赖于您的应用程序。如果您想分发您的应用程序，您需要创建自己的密钥。如果您使用自己的证书签署应用程序，则不应该出现此类问题（因为在这种情况下，证书仅取决于您在创建证书时输入的属性）。在 Preferences -> Android -> Build 下，您可以选择要使用的密钥库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T21:05:44.700

我已经将“debug.keystore”从一台机器复制到另一台机器，没有不良副作用。您可以简单地用另一个覆盖一个，并且修复了卸载/重新安装问题。调试密钥仅用于保护开发人员自己的设备免受其他开发人员的二进制文件的影响。

正如其他人所提到的，您不使用调试密钥发布您的应用程序，您必须按照 developer.android.com 上的说明制作发布密钥并对其进行签名。

另外值得注意的是，“调试”密钥自创建之日起（安装 SDK 时）仅在 1 年内有效。一年后，SDK 会说它已过期，并生成一个新的调试密钥。您必须将新密钥重新复制到另一台计算机，并且必须卸载使用旧调试密钥签名的应用程序。

至于您提到的另一个问题，您应该有单独的 Eclipse 工作区，它们都引用同一个 Android 项目，使用不同的 SDK 位置。该项目不需要位于工作区的子文件夹中，因此您可以进行这种分离。

# jquery - 制作滑块，无法创建视口

> ID：11440949
> 
> 赞同：1
> 
> 时间：2012-07-11T20:28:44.120
> 
> 标签：jquery, css, slider, jquery-animate

我正在尝试制作一个简单的水平滑块。

就目前而言，我在一行中有三个相同大小的 div。我确实有 jQuery 来移动它们，但目前视口会随着它们一起移动，或者什么也没有发生。谁能指出我的方向，以便视口保持固定并且内容滑过它？这是到目前为止的代码......

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Slider (cutdown, demo)</title>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.7.2.js"></script>
<script type="text/javascript">
$(document).ready(function()
{
$('#trigger1').click(function(){
$(".box").animate({left: "0"});
});
$('#trigger2').click(function(){
$("#viewport").animate({left: "-200"});
});
$('#trigger3').click(function(){
$(".box").animate({left: "-400"});
});
});
</script>
<style>
body    {
background:#003;
color:#FFF;
font-family:"Trebuchet MS", Arial, Helvetica, sans-serif;
}
#viewport   {
width:200px;
height:200px;
overflow:hidden;
}
.box    {
background-color:#069;
border-style:solid;
border-width:2px;
width:196px;
height:196px;
float:left;
}
</style>
</head>

<body>
<div id="trigger1">
Trigger One
</div>
<div id="trigger2">
Trigger Two
</div>
<div id="trigger3">
Trigger Three
</div>
<div id="viewport">
<div id="container">
<div id="box1" class="box">
Box One
</div>
<div id="box2" class="box">
Box Two
</div>
<div id="box3" class="box">
Box Three
</div>
</div>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:39:04.320

给你的 .box 类一个位置属性。推荐亲戚。然后给你的容器一个宽度，比如 600px;。触发器 1 和 3 现在似乎工作正常。

**[jsFiddle 示例](http://jsfiddle.net/j08691/fAWpZ/2/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T21:07:07.770

我建议您重组触发菜单并像这样重写您的 JQuery 代码：

**HTML**

```
<ul id="triggerMenu">
    <li id="trigger-0">One</li>
    <li id="trigger-1">Two</li>
    <li id="trigger-2">Three</li>
</ul>

<div id="viewport">
    <div id="container">
        <div id="box1" class="box">Box One</div>
        <div id="box2" class="box">Box Two</div>
        <div id="box3" class="box">Box Three</div>
    </div>
</div>​ 
```

**jQuery**

```
$("li", "#triggerMenu").on("click", function()
{
    var triggerNumber = $(this).attr("id").replace(/(.*)-/,"");
    var newPosition = triggerNumber * 200;

    // Make sure the box slides in the right direction
    if (newPosition > 0) newPosition = "-" + newPosition;

    // Slide box
    $(".box").animate({left: newPosition});
}); 
```

这样您就不必为每个触发器/框组合添加新的 JQuery 代码。

现场演示：http: [//jsfiddle.net/fAWpZ/5/](http://jsfiddle.net/fAWpZ/5/)

# jquery - 将参数附加到 URL，避免重复

> ID：11440950
> 
> 赞同：1
> 
> 时间：2012-07-11T20:28:45.853
> 
> 标签：jquery

我有一个脚本，它通过 url 搜索并查找某个域名，然后将一些参数附加到 url 的末尾。但是，如果多次运行，它会将重复的参数添加到同一个 url。是否可以检查 url 是否已经有参数？

[JSFiddle](http://jsfiddle.net/DdFF5/11/)

[原始的stackoverflow帖子](https://stackoverflow.com/questions/11422274/jquery-to-identify-url-and-append-parameters)

正在修改的代码

```
<div id="wp-content-editor-container" class="wp-editor-container"><textarea class="wp-editor-area" rows="10" tabindex="1" cols="40" name="content" id="content">&lt;a title="Link to test domain" href="http://www.domain.com"&gt;Link to google&lt;/a&gt;
&lt;a href="http://google.com/directory/subdirectory/index.html"&gt;This is another link&lt;/a&gt;
&lt;a href="http://domain.com/directory/index.html"&gt;This is a 3rd link&lt;/a&gt;

&lt;a href="http://www.domain.com/subdir?parameter"&gt;this url already has parameters&lt;/a&gt;</textarea></div> 
```

jQuery脚本

```
var url = 'www.domain.com';
var append = '?parameter';

$(".wp-editor-area").each(function() {
    $(this).text(urlify($(this).text()));
});

function urlify(text) {
    var urlRegex = /(\b(https?|ftp|file):\/\/[www.domain.com][-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;
    return text.replace(urlRegex, function(url) {
        return url + append;
    })
} 
```

电流输出

```
<a title="Link to test domain" href="http://www.domain.com?parameter">Link to google</a>
<a href="http://google.com/directory/subdirectory/index.html">This is another link</a>
<a href="http://domain.com/directory/index.html?parameter">This is a 3rd link</a>

<a href="http://www.domain.com/subdir?parameter?parameter">this url already has parameters</a> 
```

理想的输出不会在 URL 的末尾添加第二个“？参数”^

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T20:41:39.287

我认为您可以使用 indexOf 来检查 URL 是否已经包含您要附加​​的内容。

```
 function urlify(text) {
                var urlRegex = '/(\b(https?|ftp|file):\/\/[www.domain.com][-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig';
                return text.replace(urlRegex, function (url) {
                    // if the url does not contain append, concat append to the URL
                    if (url.indexOf(append) == -1) {
                        return url + append;
                    }
                    return url;
                }); 
```

# linux - Grep 在已经启动后过滤进程的输出？

> ID：11440951
> 
> 赞同：3
> 
> 时间：2012-07-11T20:28:47.573
> 
> 标签：linux, bash, grep, pipe

通常，当一个人想要查看运行某事的特定输出行时，可以执行以下操作：

```
./a.out | grep IHaveThisString 
```

但是如果 IHaveThisString 是每次都会改变的东西，所以你需要先运行它，观察输出以捕捉特定运行中的 IHaveThisString 是什么，然后 grep 出来呢？我可以只转储到文件，然后再转储 grep，但是否有可能做一些类似背景的事情，然后把它带到前台，然后把它带回来，但现在通过管道输送到一些 grep？类似于：

```
./a.out
Ctrl-Z
fg | grep NowIKnowThisString 
```

就是想..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T21:01:18.037

不，如果您没有以其他方式保存它，它只会在您的屏幕缓冲区中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T21:12:12.060

简短形式：你可以这样做，但你需要*知道*你需要提前做；这不是事后可以交互实施的东西。

* * *

编写脚本以确定字符串是什么。我们需要一个更详细的输出格式示例来提供更好的用法示例，但这里有一个用于整个第一行是过滤器目标的简单情况：

```
run_my_command | { read string_to_filter_for; fgrep -e "$string_to_filter_for" } 
```

`read string_to_filter_for`用尽可能多的命令替换以读取足够多的输入以确定目标字符串是什么；如有必要，这可能是一个循环。

例如，假设输出包含以下内容：

```
Session id: foobar 
```

之后，您想要 grep 查找包含`foobar`.

...然后您可以通过以下脚本进行管道传输：

```
re='Session id: (.*)'
while read; do
  if [[ $REPLY =~ $re ]] ; then
    target=${BASH_REMATCH[1]}
    break
  else
    # if you want to print the preamble; leave this out otherwise
    printf '%s\n' "$REPLY" 
  fi
done
[[ $target ]] && grep -F -e "$target" 
```

如果要手动指定过滤器目标，可以通过循环检查使用过滤器内容创建的文件，然后在启动 grep 时使用*它来完成。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T21:08:45.997

你需要的有点奇怪，但你可以这样做：

*   你必须先进入`script`会话；
*   那么你通常如何使用shell；
*   然后你开始并中断你的程序；
*   然后运行`grep`文件`typescript`。

例子：

```
$ script
$ ./a.out
Ctrl-Z
$ fg 
$ grep NowIKnowThisString typescript 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-11T21:16:14.637

您可以使用流编辑器`sed`代替`grep`. 这是我的意思的一个例子：

```
$ cat list 
Name to look for: Mike

Dora 1
John 2
Mike 3
Helen 4 
```

在这里，我们在第一行中找到要查找的名称并想要`grep`查找它。现在将命令传送到`sed`：

```
$ cat list | sed -ne '1{s/Name to look for: //;h}' \
> -e ':r;n;G;/^.*\(.\+\).*\n\1$/P;s/\n.*//;br'
Mike 3 
```

注意：`sed`它本身可以将文件作为参数，但你不使用文本文件，所以这就是你使用它的方式。

当然，您需要根据您的情况修改命令。

# android - 自定义列表视图不显示

> ID：11440953
> 
> 赞同：2
> 
> 时间：2012-07-11T20:28:51.767
> 
> 标签：android, android-listview, android-adapter

**我在做什么：**

> 我正在编写一个与地图和路线等有关的 android 应用程序。在应用程序的主屏幕上，有一个按钮可以打开收藏夹页面。收藏页面由以下 xml 布局组成。

layout_favorites.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:background="@drawable/mainscreen2">
        <HorizontalScrollView
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:scrollbarSize="0dp"
        >
            <LinearLayout
            android:orientation="horizontal"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent">
                <ImageView
                android:id="@+id/imageViewfavorites"
                android:scaleType="fitEnd"
                android:layout_marginTop="10dp"
                android:layout_marginBottom="3dp"
                android:layout_marginLeft="3dp"
                android:layout_marginRight="3dp"
                android:layout_width="60px"
                android:layout_height="60px"
                android:src="@drawable/android_button_44_2"/>
                <TextView
                android:id="@+id/textview_favorites"
                android:background="@null"
                android:scaleType="fitEnd"
                android:layout_marginTop="15dp"
                android:layout_marginBottom="3dp"
                android:layout_marginLeft="3dp"
                android:layout_marginRight="3dp"
                android:layout_width="wrap_content"
                android:layout_height="60px"
                android:textSize="35sp"
                android:textColor="#000000"
                android:text="Favorites"/>
            </LinearLayout>
        </HorizontalScrollView>
        <ListView
            android:id="@+id/listview_favorites"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:layout_marginTop="45dp"
            android:cacheColorHint="#00000000"
            >
            </ListView>
</LinearLayout> 
```

这工作正常，不用担心。在顶部布局中，您会看到有一个 ListView。我想用如下所示的行填充 ListView：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal"
    android:padding="5dip" >
        <ImageView
            android:id="@+id/route_image"
            android:layout_width="50dip"
            android:layout_height="50dip"/>
    <TextView
        android:id="@+id/route_title"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignTop="@+id/route_image"
        android:layout_toRightOf="@+id/route_image"
        android:textColor="#000000"
        android:textSize="15dip"
        android:textStyle="bold"/>
    <TextView
        android:id="@+id/route_author"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_below="@id/route_title"
        android:textColor="#000000"
        android:textSize="10dip"
        android:layout_marginTop="1dip"
        android:layout_toRightOf="@+id/thumbnail"/>
    <TextView
        android:id="@+id/route_length"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignTop="@id/route_title"
        android:gravity="right"
        android:layout_marginRight="5dip"
        android:textSize="10dip"
        android:textColor="#10bcc9"
        android:textStyle="bold"/>
     <ImageView 
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_centerVertical="true"
        android:src="@drawable/arrow"/>
</RelativeLayout> 
```

所以最后，它应该看起来像这样：

（用油漆绘制的图像：p） [http://s9.postimage.org/cgcahc1i7/Untitled.png](http://s9.postimage.org/cgcahc1i7/Untitled.png)

或者

[http://imageshack.us/photo/my-images/694/67362201.png/](http://imageshack.us/photo/my-images/694/67362201.png/)

现在，问题出在此处。它不显示。我正在使用扩展 BaseAdapter 类的自定义适配器来处理 Listview 和膨胀视图等。我将发布 Adapater，然后发布收藏夹屏幕的 Activity。

适配器类：

```
import android.content.Context;
import android.graphics.drawable.Drawable;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageView;
import android.widget.TextView;

/**
 *
 * @author Gideon
 */
public class Adapter_Maplist_Page_Favorites extends BaseAdapter
{
    //----------------------------------------
    //  Variables
    //----------------------------------------
        private Context context;
        private final Drawable[] drawables;
        private final String[] titles;
        private final String[] authors;
        private final String[] durations;
    //----------------------------------------

    //----------------------------------------
    //  Methods
    //----------------------------------------

        public Adapter_Maplist_Page_Favorites(Context context ,String[] titles,String[] authors,String[] durations,Drawable[] drawables)
        {

            this.context = context;
            this.titles = titles;
            this.authors = authors;
            this.durations = durations;
            this.drawables = drawables;
        }

        public View getView(int position, View convertView, ViewGroup parent)
        {

                LayoutInflater inflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            View rowView = inflater.inflate(R.layout.layout_favorites_row, parent);

                ImageView map_image = (ImageView) rowView.findViewById(R.id.route_image);
            TextView map_title = (TextView) rowView.findViewById(R.id.route_title);
            TextView map_author = (TextView) rowView.findViewById(R.id.route_author);
                TextView map_length = (TextView) rowView.findViewById(R.id.route_length);
                ImageView map_image_arrow = (ImageView) rowView.findViewById(R.drawable.arrow);

                map_image.setBackgroundDrawable(drawables[position]);
                map_title.setText(titles[position]);
                map_author.setText(authors[position]);
                map_length.setText(durations[position]);
                map_image_arrow.setBackgroundDrawable(map_image_arrow.getBackground());

        return rowView;
    }
        //----------------------------------------

        //----------------------------------------
        // Not Implemented
        //----------------------------------------
        public Object getItem(int arg0)
        {
            return null;
        }

        public long getItemId(int position)
        {
           return 0;
        }

        public int getCount()
        {
            throw new UnsupportedOperationException("Not supported yet.");
        }
            //----------------------------------------
    //----------------------------------------
} 
```

收藏活动课：

```
import android.app.ListActivity;
import android.graphics.drawable.Drawable;
import android.os.Bundle;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.ImageView;
import android.widget.ListView;
import android.widget.Toast;

/**
 *
 * @author Gideon
 */
public class Page_Favorites extends ListActivity
{
    //---------------------------------------------------------------------------------------------------------------
    //Hierdie info sal in die toekoms vanaf die databsae moet kom of net vervang word met die database entries in for loops etc. (This info will be loaded from the database in the future)
    //---------------------------------------------------------------------------------------------------------------
    public final String[] map_titles = {"Route 1","Route 2","Route 3","Route 4","Route 5","Route 6"};
    public final String[] map_authors = {"Jannie","Sannie","Bennie","Kosie","Gideon","Alex"};
    public final String[] map_lengths = {"42km","2km","21.5km","8km","34km","23km"};
    ImageView iv = (ImageView) findViewById(R.drawable.route_image_1);
    public final Drawable[] map_images = {iv.getBackground(),iv.getBackground(),iv.getBackground(),iv.getBackground(),iv.getBackground(),iv.getBackground()};
    //---------------------------------------------------------------------------------------------------------------

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle icicle)
    {
        super.onCreate(icicle);
        overridePendingTransition(R.layout.animation_fadein, R.layout.animation_fadeout);
        setContentView(R.layout.layout_favorites);
        // ToDo add your GUI initialization code here

        ListView list = (ListView) findViewById(R.id.listview_favorites);
        list.setAdapter(new Adapter_Maplist_Page_Favorites(this, map_titles, map_authors, map_lengths, map_images));

        list.setOnItemClickListener(new OnItemClickListener()
        {
            public void onItemClick(AdapterView<?> parent, View v, int position, long id)
            {
               Toast.makeText(Page_Favorites.this, "" + position, Toast.LENGTH_SHORT).show();
            }
        });
    }
} 
```

当我单击按钮启动收藏夹屏幕/活动并创建 listview 时，应用程序退出并出现错误（被迫退出......）。任何帮助或想法将不胜感激。谢谢。

**编辑：**

亚行日志错误：

```
22:54:21.505    24082   ERROR   RedPheasant.LoggerApp   AndroidRuntime  FATAL EXCEPTION: main
22:54:21.505    24082   ERROR   RedPheasant.LoggerApp   AndroidRuntime  java.lang.RuntimeException: Unable to start activity ComponentInfo{RedPheasant.LoggerApp/RedPheasant.LoggerApp.Page_Favorites}: java.lang.NullPointerException
22:54:21.505    24082   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1651)
22:54:21.505    24082   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
22:54:21.505    24082   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at android.app.ActivityThread.access$1500(ActivityThread.java:117)
22:54:21.505    24082   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
22:54:21.505    24082   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at android.os.Handler.dispatchMessage(Handler.java:99)
22:54:21.505    24082   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at android.os.Looper.loop(Looper.java:123)
22:54:21.505    24082   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at android.app.ActivityThread.main(ActivityThread.java:3687)
22:54:21.505    24082   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at java.lang.reflect.Method.invokeNative(Native Method)
22:54:21.505    24082   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at java.lang.reflect.Method.invoke(Method.java:507)
22:54:21.505    24082   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
22:54:21.505    24082   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
22:54:21.505    24082   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at dalvik.system.NativeStart.main(Native Method)
22:54:21.505    24082   ERROR   RedPheasant.LoggerApp   AndroidRuntime  Caused by: java.lang.NullPointerException
22:54:21.505    24082   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at RedPheasant.LoggerApp.Page_Favorites.onCreate(Page_Favorites.java:48)
22:54:21.505    24082   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
22:54:21.505    24082   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1615)
22:54:21.505    24082   ERROR   RedPheasant.LoggerApp   AndroidRuntime      ... 11 more
22:54:21.515    212 ERROR   #212        Dumpstate > /data/log/dumpstate_app_error 
```

另外，修复了这部分：

```
public int getCount()
    {
       if(titles == null)
        {
            return 0;
        }
        return titles.length;
    } 
```

仍然遇到同样的问题。 **编辑2：**

好的，伙计们，谢谢到目前为止的所有帮助......

我还改变了这一点：

新的收藏页面活动（修改）：

```
public class Page_Favorites extends Activity
{

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle icicle)
    {
        super.onCreate(icicle);
        overridePendingTransition(R.layout.animation_fadein, R.layout.animation_fadeout);
        setContentView(R.layout.layout_favorites);
        // ToDo add your GUI initialization code here

        //---------------------------------------------------------------------------------------------------------------
        //Hierdie info sal in die toekoms vanaf die databsae moet kom of net vervang word met die database entries in for loops etc.
        //---------------------------------------------------------------------------------------------------------------

        String[] map_titles = {"Route 1","Route 2","Route 3","Route 4","Route 5","Route 6"};
        String[] map_authors = {"Jannie","Sannie","Bennie","Kosie","Gideon","Alex"};
        String[] map_lengths = {"42km","2km","21.5km","8km","34km","23km"};
        //ImageView iv = (ImageView) findViewById(R.drawable.route_image_1);
        Drawable d = getResources().getDrawable(R.drawable.route_image_1);
        Drawable[] map_images = {d,d,d,d,d,d};
        Drawable d2 = getResources().getDrawable(R.drawable.arrow);
       //---------------------------------------------------------------------------------------------------------------

        ListView list = (ListView) findViewById(R.id.listview_favorites);
        list.setAdapter(new Adapter_Maplist_Page_Favorites(this, map_titles, map_authors, map_lengths, map_images,d2));//lika a boss itches

        list.setOnItemClickListener(new OnItemClickListener()
        {
            public void onItemClick(AdapterView<?> parent, View v, int position, long id)
            {
               Toast.makeText(Page_Favorites.this, "" + position, Toast.LENGTH_SHORT).show();
            }
        });
    }
} 
```

新的适配器类（修改）：

```
public class Adapter_Maplist_Page_Favorites extends BaseAdapter
{
    //----------------------------------------
    //  Variables
    //----------------------------------------
        private Context context;
        private final Drawable[] drawables;
        private final String[] titles;
        private final String[] authors;
        private final String[] durations;
        private final Drawable d;
    //----------------------------------------

    //----------------------------------------
    //  Methods
    //----------------------------------------

        public Adapter_Maplist_Page_Favorites(Context context ,String[] titles,String[] authors,String[] durations,Drawable[] drawables,Drawable d)
        {

            this.context = context;
            this.titles = titles;
            this.authors = authors;
            this.durations = durations;
            this.drawables = drawables;
            this.d = d;
        }
        //----------------------------------------

        public View getView(int position, View convertView, ViewGroup parent)
        {

                LayoutInflater inflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        View rowView = inflater.inflate(R.layout.layout_favorites_row, parent);

                ImageView map_image = (ImageView) rowView.findViewById(R.id.route_image);
        TextView map_title = (TextView) rowView.findViewById(R.id.route_title);
        TextView map_author = (TextView) rowView.findViewById(R.id.route_author);
                TextView map_length = (TextView) rowView.findViewById(R.id.route_length);

                ImageView map_image_arrow = (ImageView) rowView.findViewById(R.id.route_arrow);

                map_image.setBackgroundDrawable(drawables[position]);
                map_title.setText(titles[position]);
                map_author.setText(authors[position]);
                map_length.setText(durations[position]);
                map_image_arrow.setBackgroundDrawable(d);

        return rowView;
    }
        //----------------------------------------

        //----------------------------------------
        // Not Implemented
        //----------------------------------------
        public Object getItem(int arg0)
        {
            return null;
        }

        public long getItemId(int position)
        {
           return 0;
        }

        public int getCount()
        {
           if(titles == null)
            {
                return 0;
            }
            return titles.length;
        }
            //----------------------------------------
    //----------------------------------------
} 
```

以及新的错误日志广告博客：

```
23:15:15.839    24746   ERROR   RedPheasant.LoggerApp   AndroidRuntime  FATAL EXCEPTION: main
23:15:15.839    24746   ERROR   RedPheasant.LoggerApp   AndroidRuntime  java.lang.UnsupportedOperationException: addView(View, LayoutParams) is not supported in AdapterView
23:15:15.839    24746   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at android.widget.AdapterView.addView(AdapterView.java:461)
23:15:15.839    24746   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at android.view.LayoutInflater.inflate(LayoutInflater.java:416)
23:15:15.839    24746   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at android.view.LayoutInflater.inflate(LayoutInflater.java:320)
23:15:15.839    24746   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at android.view.LayoutInflater.inflate(LayoutInflater.java:276)
23:15:15.839    24746   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at RedPheasant.LoggerApp.Adapter_Maplist_Page_Favorites.getView(Adapter_Maplist_Page_Favorites.java:73)
23:15:15.839    24746   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at android.widget.AbsListView.obtainView(AbsListView.java:1554)
23:15:15.839    24746   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at android.widget.ListView.makeAndAddView(ListView.java:1793)
23:15:15.839    24746   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at android.widget.ListView.fillDown(ListView.java:718)
23:15:15.839    24746   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at android.widget.ListView.fillFromTop(ListView.java:775)
23:15:15.839    24746   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at android.widget.ListView.layoutChildren(ListView.java:1646)
23:15:15.839    24746   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at android.widget.AbsListView.onLayout(AbsListView.java:1384)
23:15:15.839    24746   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at android.view.View.layout(View.java:7228)
23:15:15.839    24746   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1254)
23:15:15.839    24746   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1130)
23:15:15.839    24746   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at android.widget.LinearLayout.onLayout(LinearLayout.java:1047)
23:15:15.839    24746   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at android.widget.FrameLayout.onLayout(FrameLayout.java:338)
23:15:15.839    24746   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at android.view.ViewRoot.performTraversals(ViewRoot.java:1147)
23:15:15.839    24746   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at android.view.ViewRoot.handleMessage(ViewRoot.java:1867)
23:15:15.839    24746   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at android.os.Handler.dispatchMessage(Handler.java:99)
23:15:15.839    24746   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at android.os.Looper.loop(Looper.java:123)
23:15:15.839    24746   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at android.app.ActivityThread.main(ActivityThread.java:3687)
23:15:15.839    24746   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at java.lang.reflect.Method.invokeNative(Native Method)
23:15:15.839    24746   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at java.lang.reflect.Method.invoke(Method.java:507)
23:15:15.839    24746   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
23:15:15.839    24746   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
23:15:15.839    24746   ERROR   RedPheasant.LoggerApp   AndroidRuntime      at dalvik.system.NativeStart.main(Native Method)
23:15:15.849    212 ERROR   #212        Dumpstate > /data/log/dumpstate_app_error 
```

到目前为止，谢谢您的帮助...尽管仍然遇到相同的错误。

**更新：**

我猜这是我现在的主要问题：

```
java.lang.UnsupportedOperationException: addView(View, LayoutParams) is not supported in AdapterView 
```

我猜这与不支持视图的适配器有关。我有点困惑 :p 大声笑。有任何想法吗。

**最终编辑 -** 为所有帮助人员解决了谢谢。它终于工作了，看起来很棒。

主要问题是我将可绘制对象分配给 ImageViews 的方式在进行充气时导致问题。感谢 Sam 指出这一点。另一个主要问题是我必须在 inflate 方法中添加 false 参数才能不将其复制到根目录。感谢 Angelo 指出这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T20:34:46.910

如果没有 LogCat，我们只能猜测您有什么错误......

**1）**您正在扩展一个 ListActivity：

```
public class Page_Favorites extends ListActivity 
```

这**要求**您有一个 ListView，其中`android:id="@android:id/list"`包含您传递给 setContentView() 的布局中的属性。我只是建议你只扩展一个活动：

```
public class Page_Favorites extends Activity 
```

因为您当前的代码不依赖于 ListActivity。

**2)**断章取义：

```
ImageView iv = (ImageView) findViewById(R.drawable.route_image_1);
public final Drawable[] map_images = {iv.getBackground(),iv.getBackground(),iv.getBackground(),iv.getBackground(),iv.getBackground(),iv.getBackground()}; 
```

在创建 Activity 之前不能引用 findViewById()，这应该在 setContentView() 之后的 onCreate() 中完成。

**3）**你应该像这样将你的drawable加载到一个ImageView中：

```
ImageView iv = (ImageView) findViewById(R.id.imageViewfavorites);
iv.setImageResource(R.drawables.route_image_1); 
```

我猜到你想要图像的位置......这是你的意思吗？

并且已经有足够多的人对 getCount() 发表了评论，所以我不会重复它。

**4)**在适配器的 getView() 中，更改：

```
View rowView = inflater.inflate(R.layout.layout_favorites_row, parent); 
```

对此：

```
View rowView = inflater.inflate(R.layout.layout_favorites_row, parent, false); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T20:40:08.610

为什么你有*getCount()*方法，它应该返回一个抛出异常的 int 值？这似乎很尴尬。而不是你应该这样做：

```
public int getCount()
{
    return yourDataArray.size();
} 
```

该方法负责您的 ListView 将拥有的行数，即，如果*yourDataArray*的大小 = 7，这意味着您将在 ListView 中拥有 7 行。

**编辑：**

这是您的解决方案：

1.  将 getItem() 方法替换为：

    ```
     public Object getItem(int arg0)
     {
         return arg0;
     } 
    ```

2.  用下面的代码替换您的适配器 getView() 方法。

    ```
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        View v = convertView;
        ViewHolder holder;

        if (v == null) {
             LayoutInflater vi = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
             View rowView = vi.inflate(R.layout.layout_favorites_row, null);

             ImageView map_image = (ImageView) rowView.findViewById(R.id.route_image);
             TextView map_title = (TextView) rowView.findViewById(R.id.route_title);
             TextView map_author = (TextView) rowView.findViewById(R.id.route_author);
             TextView map_length = (TextView) rowView.findViewById(R.id.route_length);
             ImageView map_image_arrow = (ImageView) rowView.findViewById(R.id.route_arrow);

            v.setTag(holder);
        }
        else {
            holder=(ViewHolder)v.getTag();
        }

        /** Define here the values to all the Views of the ViewHolder. */
        holder.map_image.setBackgroundDrawable(drawables[position]);
        holder.map_title.setText(titles[position]);
        holder.map_author.setText(authors[position]);
        holder.map_length.setText(durations[position]);
        holder.map_image_arrow.setBackgroundDrawable(d);

    return v;
    } 
    ```

    使用 ViewHolder。确保您定义了一个 ViewHolder 内部类，例如：

    ```
    public static class ViewHolder {
          public TextView map_image ;
          public TextView map_title;
          public TextView map_author;
          public TextView map_length;
          public ImageView map_image_arrow;
    } 
    ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T20:42:44.147

这是你的问题：

```
public int getCount()
    {
        throw new UnsupportedOperationException("Not supported yet.");
    } 
```

您应该返回列表中的元素数。像这样的东西：

```
public int getCount()
    {
        if(title == null) {
           return 0;
        }
        return title.length;
    } 
```

此外，Sam 所说的是另一个你应该解决的问题。

**编辑**看到您的适配器代码，我注意到您没有使用`ViewHolder`. 我强烈建议您使用它，因为它可以显着利用您的 listView 的性能。[这](http://www.vogella.com/articles/AndroidListView/article.html)是一个很好的链接，它解释了有关 listView 的所有基础知识。上面的评论只是为了性能，但最好包含它。

[从这个 SO question](https://stackoverflow.com/questions/2496698/android-custom-listadapter-extending-baseadapter-crashes-on-application-launch)得分最高的答案。更改此行：

```
View rowView = inflater.inflate(R.layout.layout_favorites_row, parent); 
```

有了这个：

```
View rowView = inflater.inflate(R.layout.layout_favorites_row, parent, false); 
```

我认为你不会有任何问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T20:38:50.650

检查此方法：

```
public int getCount()
        {
            throw new UnsupportedOperationException("Not supported yet.");
        } 
```

返回值 > 0。它最近帮助了我。我不确定你的问题，但只是尝试。

# string - 在 grails 中格式化文本输出

> ID：11440956
> 
> 赞同：0
> 
> 时间：2012-07-11T20:28:57.077
> 
> 标签：string, grails, string-formatting, gsp

嗨，在我的 grails 项目中，我正在解析一个 java 属性文件，并将信息传递给一个字符串，这是我的域类的一个属性。它解析得很好，但是当我在视图中打印它以查看解析的数据时，它已经丢失了所有格式。主要是我想保留原始文件中的换行符。我尝试寻找一种格式化输出的方法，但我找不到任何东西。任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T22:01:33.210

听起来您需要保留字符串中的原始格式，而 HTML 可能会删除空格。在您的视图中尝试以下操作：

```
<pre>
${domain.attribure}
</pre> 
```

# java - 是否可以返回一个字符串然后用相同的方法清除它？

> ID：11440957
> 
> 赞同：0
> 
> 时间：2012-07-11T20:28:57.460
> 
> 标签：java, synchronized, stringbuffer

就像标题说的那样，我想知道您是否可以说制作一个 Getter 并在退出该方法之前以相同的方法清除它。

例子：

```
public StringBuffer Answer = new StringBuffer();

public synchronized String getAnswer() {
        synchronized(Answer) {
            return Answer.toString();
            // Clear Anwser here?
        }
} 
```

**编辑**

示例 2：使用 Try 和 Finaly 块：

```
public synchronized String getAnswer() {
        synchronized(Answer) {
            try{
                return Answer.toString();
            }finally{
                Answer.delete(0, Answer.length());
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T20:30:18.980

是的，当然，只需创建一个临时变量来保存您要返回的字符串。

```
public StringBuffer answer = new StringBuffer();

public synchronized String getAnswer() {
        synchronized(answer) {
            String returnValue = answer.toString();
            answer.setLength(0); // clear the buffer.
            return returnValue;
        }
} 
```

请注意，我更改`Answer`为`answer`. 在大多数编程语言中，变量以小写字符开头是一种常见约定。

还可以考虑使用 a `StringBuilder`，它不是同步的，这使得它比 StringBuffer 快一点。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-11T20:30:58.213

不，您的方法不再具有控制权，因为它在返回时退出。

# delphi - FastMM/DXE2 仅在使用调试器时报告？

> ID：11440959
> 
> 赞同：3
> 
> 时间：2012-07-11T20:29:04.667
> 
> 标签：delphi, delphi-xe2, fastmm

我正在尝试使用 FastMM 4.99 版（根据顶部的评论`FastMM4.pas`）。我已[按照](https://stackoverflow.com/questions/7955169/how-do-i-get-access-to-fastmm4s-registerexpectedmemoryleak) [说明使用带有堆栈跟踪](https://stackoverflow.com/questions/271850/how-to-track-down-tricky-memory-leak-with-fastmm)[的](http://wiert.me/2009/07/29/delphi-fastmm-using-fastmm4-for-debugging-your-memory-allocations-part-1-introduction/) 完整调试模式，并且当我在 IDE 调试器下运行我的 .exe 时发现泄漏。*例如*

 *![FastMM 泄漏报告对话框](../Images/f28fbab79fe131ab9952a07b9423cf84.png)

但是，当我尝试从命令提示符或双击 Windows 资源管理器运行可执行文件时，我没有报告任何泄漏。UnicodeString 泄漏可能是假的，但我确信 TINiFile 泄漏是真实的。不使用调试器时如何使 FastMM 报告/日志泄漏？

更新：该项目还使用 madExcept 3.0n：.dpr 文件确实将 FastMM4 作为其使用条款中的第一项。还需要什么才能使这两者共存吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-12T02:43:57.357

你没有正确配置`FastMM4Options.inc`。从随版本 4.97 分发的文件中，它在第 405 行附近：

```
{Set this option to require the presence of the Delphi IDE to report memory
 leaks. This option has no effect if the option "EnableMemoryLeakReporting"
 is not also set.}
{.$define RequireIDEPresenceForLeakReporting} 
```

确保`.`位于最后一行（在 之前`$define`）并重建您的项目。

@wades 发现还有另一个设置，就在我提到的那个下面`RequireDebuggerPresenceForLeakReporting`，默认为开启。通过在左大括号后添加一个句点来禁用它：

```
{Set this option to require the program to be run inside the IDE debugger to
 report memory leaks. This option has no effect if the option
 "EnableMemoryLeakReporting" is not also set.}
{$define RequireDebuggerPresenceForLeakReporting} 
```

（根据@wades 的要求添加到这个答案中。）*

# python - 如何保存 LibSVM python 对象实例？

> ID：11440970
> 
> 赞同：3
> 
> 时间：2012-07-11T20:29:43.513
> 
> 标签：python, svm, libsvm, pickle

我想在其他计算机上使用这个分类器，而不必再次训练它。我曾经用 cPickle 从 scikit 中保存一些分类器。对 LIBSVM 执行相同操作会给我一个“ ValueError: ctypes objects contains pointers cannot be pickle ”。

我正在使用 LibSVM 3.1 和 Python 2.7.3。

谢谢

```
from libsvm.svm import *
from libsvm.svmutil import *
import cPickle

x = [[1, 0, 1], [-1, 0, -1]]
y = [1, -1]
prob = svm_problem(y, x)
param = svm_parameter()
param.kernel_type = LINEAR
param.C = 10
m = svm_train(prob, param)
labels_pred, acc, probs = svm_predict([-1, 1], [[1, 1, 1], [0, 0, 1]], m)
print labels_pred, acc, probs

import ipdb; ipdb.set_trace()

filename='libsvm-classif.pkl'

fid = open(filename, 'wb')
cPickle.dump(m, fid)
fid.close()

fid = open(filename, 'rb')
m = cPickle.load(fid)
labels_pred, acc, probs = svm_predict([-1, 1], [[1, 1, 1], [0, 0, 1]], m)

print labels_pred, acc, probs 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-14T12:54:04.760

只需使用 libsvm 的加载和保存功能

```
svm_save_model('libsvm.model', m)
m = svm_load_model('libsvm.model') 
```

这是来自 libsvm 包的 python 目录中的 README 文件。它似乎比网站对功能的描述要好得多。

# c# - 如何在 C# 中优化合并排序数组的功能

> ID：11440973
> 
> 赞同：4
> 
> 时间：2012-07-11T20:29:49.940
> 
> 标签：c#, arrays, sorting, mergesort

我编写此函数用于合并两个数组。

```
private static int[] Merge(int[] array1, int[] array2)
{
    var mergedArray = new int[array1.Length + array2.Length];
    int i = 0, j = 0, k = 0;
    while(k < mergedArray.Length)
    {
        if(i == array1.Length || j == array2.Length)
        {
             if (i <= j)
                {
                    mergedArray[k] = array1[i];
                    i++;
                }
                else
                {
                    mergedArray[k] = array2[j];
                    j++;
                }
        }
        else
        {
            if(array1[i] < array2[j])
            {
                mergedArray[k] = array1[i];
                i++;
            }
            else
            {
                mergedArray[k] = array2[j];
                j++;
            }
        }
        k++;
    }
    return mergedArray;
} 
```

如何减少此代码中的 if 语句？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-11T21:14:15.987

你也可以制作一个对 Linq 友好的版本。这个速度很快，可以在 IEnumerable 上工作。您可以轻松地将其转换为 T 为 IComparable 的任何类型 T。

```
 private static IEnumerable<int> Merge(IEnumerable<int> enum1, IEnumerable<int> enum2)
    {
        IEnumerator<int> e1 = enum1.GetEnumerator();
        IEnumerator<int> e2 = enum2.GetEnumerator();

        bool remaining1 = e1.MoveNext();
        bool remaining2 = e2.MoveNext();

        while (remaining1 || remaining2)
        {
            if (remaining1 && remaining2)
            {
                if (e1.Current > e2.Current)
                {
                    yield return e2.Current;
                    remaining2 = e2.MoveNext();
                }
                else
                {
                    yield return e1.Current;
                    remaining1 = e1.MoveNext();
                }
            }
            else if (remaining2)
            {
                yield return e2.Current;
                remaining2 = e2.MoveNext();
            }
            else
            {
                yield return e1.Current;
                remaining1 = e1.MoveNext();
            }
        }
    } 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-11T20:50:18.447

不如 Linq 解决方案，但如果您想要传统的 if-then 样式函数，您可以编写：

```
private static int[] Merge(int[] array1, int[] array2)
{
    var mergedArray = new int[array1.Length + array2.Length];
    int i = 0, j = 0, k = 0;
    while(k < mergedArray.Length)
    {
        if (j == array2.Length || ((i < array1.Length) && (array[i] < array2[j])))
        {
            mergedArray[k] = array1[i];
            i++;
        }
        else
        {
            mergedArray[k] = array2[j];
            j++;
        }
        k++;
    }
    return mergedArray;
} 
```

（编辑：添加了缺少的大括号）

### 或者用英语：

如果array2为空或者如果array 1中还有值并且array1[i]小于array2[j]，则从array1中取值，否则从array 2中取值

### 或者非常简洁（只是为了好玩）：

```
private static int[] Merge(int[] array1, int[] array2)
{
    var mergedArray = new int[array1.Length + array2.Length];
    int i = 0, j = 0;
    while(i+j < mergedArray.Length)
        if (j == array2.Length || ((i < array1.Length) && (array1[i] < array2[j])))
            mergedArray[i+j] = array1[i++];
        else
            mergedArray[i+j] = array2[j++];
    return mergedArray;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-11T20:40:30.910

Linq 是你的朋友，这是一种方法：

```
private static int[] Merge(int[] array1, int[] array2)
{
  List<int> merged = new List<int>(array1.Length + array2.Length);
  merged.AddRange(array1);
  merged.AddRange(array2);
  return merged.GroupBy(x => x)
               .Select(x => x.Key)
               .OrderBy(x => x)
               .ToArray();
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-21T18:32:06.590

我建议不要专门针对数组，而是查看以下问题以获取`IEnumerable<T>`. [合并排序的 IEnumerable<T> 的最有效算法](https://stackoverflow.com/questions/2767007/most-efficient-algorithm-for-merging-sorted-ienumerablet/14444706#14444706)

[我在https://stackoverflow.com/a/14444706/184528](https://stackoverflow.com/a/14444706/184528)提供的答案 只有一个`if`语句并合并多个枚举。

例如使用它来合并三个不同的数组：

```
 public static void Main(string[] args)
    {
        var xs = new[] { 1, 5, 9 };
        var ys = new[] { 2, 7, 8 };
        var zs = new[] { 0, 3, 4, 6 };

        foreach (var a in new [] { xs, ys, zs }.Merge())
            Console.WriteLine(a);
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-06T03:17:23.547

在我看来，这是该功能最“精简”的版本：

```
private static int[] Merge(int[] array1, int[] array2)
{
    return array1.Concat(array2).OrderBy(x => x).ToArray();
} 
```

没有比这更简单的了。一个都不`if`剩了。

`Merge(new [] { 1, 2, 2, 3 }, new [] { 1, 1, 2, 4, })`我在原始代码和我的解决方案上都运行了这个并得到了相同的答案。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-07-11T21:05:19.650

如何使用`Queue<int>`排空阵列：

```
 private static int[] Merge(int[] array1, int[] array2)
    {
        int N=array1.Length+array2.Length;
        Queue<int> Q1=new Queue<int>(array1);
        Queue<int> Q2=new Queue<int>(array2);
        Queue<int> result=new Queue<int>(N);

        for(int k=0; k<N; k++)
        {
            if(Q1.Count==0)
            {
                result.Enqueue(Q2.Dequeue());
            }
            else if(Q2.Count==0)
            {
                result.Enqueue(Q1.Dequeue());
            }
            else
            {
                result.Enqueue(
                    Q1.Peek()<Q2.Peek()?
                    Q1.Dequeue():
                    Q2.Dequeue());
            }
        }
        return result.ToArray();
    } 
```

# c# - 如何在画布上发生 mousemove 事件时仅显示 2 行

> ID：11440979
> 
> 赞同：-2
> 
> 时间：2012-07-11T20:30:17.420
> 
> 标签：c#, wpf

每次发生 MouseMove 事件时，我都会尝试在鼠标后面制作两条线。我可以为事件创建两条线，但问题是它们将为每个 MouseMove 创建两条线。这是我的代码。我正在使用 WPF 和 C#。

```
 private void CanvasMouseMove(object sender, MouseEventArgs e)
    {
        double xPos = e.GetPosition(m_Grid).X;
        double yPos = e.GetPosition(m_Grid).Y;

        Line vertLine = new Line();
        Line horzLine = new Line();

        vertLine.X1 = xPos;
        vertLine.Y1 = 0;
        vertLine.X2 = xPos;
        vertLine.Y2 = m_Grid.Height;

        horzLine.X1 = 0;
        horzLine.Y1 = yPos;
        horzLine.X2 = m_Grid.Width;
        horzLine.Y2 = yPos;

        vertLine.StrokeThickness = 1;
        horzLine.StrokeThickness = 1;

        vertLine.Stroke = Brushes.Black;
        horzLine.Stroke = Brushes.Black;

        m_Grid.Children.Add(vertLine); //m_Grid is my Canvas
        m_Grid.Children.Add(horzLine);

        m_Grid.UpdateLayout();
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T20:35:16.753

只是每次（也不要打电话，这不`Clear`关你的事）。`Grid.Children``UpdateLayout`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T21:03:20.493

最好找到现有的线条，然后将其删除，这样如果您的画布中有任何其他内容，您将不会删除它，只有这些特定的线条。

你可以通过给他们一个名字然后用这个名字搜索他们来做到这一点。

```
private void CanvasMouseMove(object sender, MouseEventArgs e)
        {
            double xPos = e.GetPosition(m_Grid).X;
            double yPos = e.GetPosition(m_Grid).Y;

            Line vertLine = new Line
                                {
                                    Name = "vertLine",
                                    X1 = xPos,
                                    Y1 = 0,
                                    X2 = xPos,
                                    Y2 = m_Grid.Height,
                                    Stroke = Brushes.Black,
                                    StrokeThickness = 1
                                };

            Line horzLine = new Line
                                {
                                    Name = "horzLine",
                                    X1 = 0,
                                    Y1 = yPos,
                                    X2 = m_Grid.Width,
                                    Y2 = yPos,
                                    StrokeThickness = 1,
                                    Stroke = Brushes.Black
                                };

            m_Grid.Children.Remove((Line) m_Grid.Children.OfType<Line>().FirstOrDefault(x => x.Name == "vertLine"));
            m_Grid.Children.Remove((Line) m_Grid.Children.OfType<Line>().FirstOrDefault(x => x.Name == "horzLine"));

            m_Grid.Children.Add(vertLine); //m_Grid is my Canvas
            m_Grid.Children.Add(horzLine);

            m_Grid.UpdateLayout();
        } 
```

# objective-c - CAEmitterLayer 在触摸事件中随机发射不需要的粒子

> ID：11440982
> 
> 赞同：38
> 
> 时间：2012-07-11T20:30:20.010
> 
> 标签：objective-c, ios, caemitterlayer

我正在尝试设置一个`CAEmitterLayer`来制作五彩纸屑效果，我遇到了两个问题：

1.  每当我将`birthRate`单元格上的设置为非零值以启动动画时，我会在屏幕上随机放置一系列单元格，这些单元格可以正常动画，然后发射器在此之后继续正常发射。
2.  每当`emitterCells`在屏幕上绘制东西时，每当我触摸屏幕时，发射器`emitterCells`都会在（看似）随机的位置（看似）存在（看似）随机的时间量。发射器中的任何内容都与任何触摸事件无关（即我不是故意在触摸事件上绘制任何内容），但该层位于具有多个嵌入式视图的视图中。我接触的越多，出现的细胞就越多。

这是我设置发射器的代码，然后启动和停止它（一旦我调用了停止函数，然后点击屏幕停止创建新的随机元素）：

```
- (void)setupConfetti
{
    self.confettiLayer = [CAEmitterLayer layer];
    [self.view.layer addSublayer:self.confettiLayer];
    [self.view.layer setNeedsDisplay];

    self.confettiLayer.emitterPosition = CGPointMake(1024.0/2,-50.0);
    self.confettiLayer.emitterSize = CGSizeMake(1000.0, 10.0);
    self.confettiLayer.emitterShape = kCAEmitterLayerLine; 
    self.confettiLayer.renderMode =kCAEmitterLayerUnordered;

    CAEmitterCell *confetti = [CAEmitterCell emitterCell];

    confetti1.contents =  (id)[[UIImage imageNamed:@"confetti.png"] CGImage];

    confetti.emissionLongitude = M_PI;
    confetti.emissionLatitude = 0;
    confetti.lifetime = 5;
    confetti.birthRate = 0.0;
    confetti.velocity = 125;
    confetti.velocityRange = 50;
    confetti.yAcceleration = 50;
    confetti.spin = 0.0;
    confetti.spinRange = 10;
    confetti.name = @"confetti1";

    self.confettiLayer.emitterCells = [NSArray arrayWithObjects:confetti, nil];
} 
```

开始五彩纸屑：

```
- (void)startConfettiAnimation
{
    [self.confettiLayer setValue:[NSNumber numberWithInt:10.0] forKeyPath:@"emitterCells.confetti.birthRate"];
} 
```

并阻止它：

```
- (void)stopConfettiAnimation
{
    [self.confettiLayer setValue:[NSNumber numberWithInt:0.0] forKeyPath:@"emitterCells.confetti.birthRate"];
} 
```

同样，一旦它开始，在最初的随机元素之后，它工作得很好：一切正常动画，当birthRate稍后设置为零时，它优雅地结束。它似乎只是响应触摸事件，我不知道为什么。我尝试将emitterLayer 添加到不同的视图，禁用该视图上的用户交互，然后将其添加为主视图的子视图，但这似乎不起作用。

任何帮助/见解将不胜感激！

谢谢，山姆

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-02-19T21:54:26.283

我知道这是一个旧帖子，但我也遇到了这个问题。Jackslash 在这篇文章中很好地回答了这个问题： [iOS 7 CAEmitterLayer spawningparticles inappropriately](https://stackoverflow.com/questions/18913484/ios-7-caemitterlayer-spawning-particles-inappropriately?rq=1)

您需要在发射器层上设置 beginTime 以使用 CACurrentMediaTime() 从当前时间开始。似乎我们遇到的问题是因为发射器已经在过去启动了。

```
emitter.beginTime = CACurrentMediaTime(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-02T22:54:23.460

是不是您没有检查粒子是否像 Artur Ozieranski 发布的 Wenderlich 示例中那样发射？只要支票到位，我就不会看到翻倍。

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    [fireView setEmitterPositionFromTouch: [touches anyObject]];
    [fireView setIsEmitting:YES];
}

- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {
    [fireView setIsEmitting:NO];
}

- (void)touchesCancelled:(NSSet *)touches withEvent:(UIEvent *)event {
    [fireView setIsEmitting:NO];
}
-(void)setIsEmitting:(BOOL)isEmitting
{
    //turn on/off the emitting of particles
    [fireEmitter setValue:[NSNumber numberWithInt:isEmitting?200:0] forKeyPath:@"emitterCells.fire.birthRate"];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-13T12:17:26.447

> .h 文件

```
 #import <UIKit/UIKit.h>

    @interface DWFParticleView : UIView

    -(void)setEmitterPositionFromTouch: (CGPoint*)t;
    -(void)setIsEmitting:(BOOL)isEmitting;

    @end 
```

> .m 文件

```
 #import "DWFParticleView.h"
    #import <QuartzCore/QuartzCore.h>

    @implementation DWFParticleView
    {
        CAEmitterLayer* fireEmitter; //1
    }

    -(void)awakeFromNib
    {
        //set ref to the layer
        fireEmitter = (CAEmitterLayer*)self.layer; //2
        //configure the emitter layer
        fireEmitter.emitterPosition = CGPointMake(50, 50);
        fireEmitter.emitterSize = CGSizeMake(10, 10);

        CAEmitterCell* fire = [CAEmitterCell emitterCell];
        fire.birthRate = 0;
        fire.lifetime = 1.5;
        fire.lifetimeRange = 0.3;
        fire.color = [[UIColor colorWithRed:255 green:255 blue:255 alpha:0.1] CGColor];
        fire.contents = (id)[[UIImage imageNamed:@"Particles_fire.png"] CGImage];
        [fire setName:@"fire"];

        fire.velocity =5;
        fire.velocityRange = 20;
        fire.emissionRange = M_PI_2;

        fire.scaleSpeed = 0.1;
        fire.spin = 0.5;

        fireEmitter.renderMode = kCAEmitterLayerAdditive;

        //add the cell to the layer and we're done
        fireEmitter.emitterCells = [NSArray arrayWithObject:fire];

    }

    + (Class) layerClass //3
    {
        //configure the UIView to have emitter layer
        return [CAEmitterLayer class];
    }

    -(void)setEmitterPositionFromTouch: (CGPoint*)t
    {
        //change the emitter's position
        fireEmitter.emitterPosition = (*t);
    }

    -(void)setIsEmitting:(BOOL)isEmitting
    {
        //turn on/off the emitting of particles
        [fireEmitter setValue:[NSNumber numberWithInt:isEmitting?100:0] forKeyPath:@"emitterCells.fire.birthRate"];
    }

    @end 
```

> 我使用此代码创建自定义视图并在触摸时发出粒子
> 
> 这是在触摸时发射粒子的调用语句

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    CGPoint p =  [[touches anyObject] locationInView:self.view];
     [fireView setEmitterPositionFromTouch: &p];
     [fireView setIsEmitting:YES];

} 
```

> 也许它会为你工作。

# eclipse - Eclipse 4.2 Juno 看起来难以辨认 - 白色背景上的文本

> ID：11440986
> 
> 赞同：-1
> 
> 时间：2012-07-11T20:30:28.393
> 
> 标签：eclipse, themes, eclipse-juno

![Eclipse 4.2 朱诺](../Images/40d47821b417434749823439735a5d78.png)

**如何解决？**

PS。切换到另一个 Eclipse 主题只会改变 gui 的形状，但不会改变颜色。

我的机器是：

```
Archlinux + XFCE 4.10
Eclipse Version: 4.2.0, Build id: I20120608-1400
Java(TM) SE Runtime Environment (build 1.7.0_05-b05) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:36:52.543

换主题后重启了吗？只有一些更改是即时应用的。

# windows-7 - Rational Application Developer / Websphere 污染主目录

> ID：11440987
> 
> 赞同：1
> 
> 时间：2012-07-11T20:30:29.367
> 
> 标签：windows-7, filesystems, websphere, ibm-rad

当我使用 Websphere 7.0 安装 RAD 时，我在我的主目录中创建了许多文件夹：

```
%USERPROFILE%\IBM
%USERPROFILE%\Logs
%USERPROFILE%\PMT
%USERPROFILE%\updilogs
%USERPROFILE%\waslogs
%USERPROFILE%\web2feplogs 
```

我使用的是 Windows 7，所以我实际上将我的主目录用于各种事情，并且讨厌我有所有这些文件夹污染我的主目录（其中一半以上是空的）。

我可以删除其中哪些？如果 RAD/Websphere 需要这些目录，有什么方法可以配置 RAD/Websphere 以将它们放在它们*应该*在的位置（即，在 %USERPORFILE%\AppData 下）？

（而且由于工作相关的原因，我有隐藏的文件/文件夹显示，所以我不能只是隐藏它们）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T05:41:40.493

好的，所以：

1.  该`%USERPROFILE%\IBM`目录是 RAD 在其中创建新工作区的默认目录。我猜这个目录是在您第一次调用 RAD 时创建的，它询问您希望在哪里创建工作区。检查该目录的内容。如果它仅包含 RAD 工作区，您可以将其删除（或将各个工作区目录移至其他位置）。
2.  我不知道`%USERPROFILE%\Logs`由 wither RAD 或 WebSphere 创建的目录。你能列出一些目录的内容吗？
3.  `%USERPROFILE%\PMT`WebSphere 或 RAD 不会创建该目录。`PMT`代表*Profile Management Tool* - WebSphere 提供的用于管理 WebSphere 配置文件的 GUI。你能列出一些目录的内容吗？
4.  `%USERPROFILE%\updilogs`是由 WebSphere Update Installer 的安装程序创建的日志（再读一遍）。你不能覆盖它。您可以删除此目录。
5.  `%USERPROFILE%\waslogs`是由 WAS 安装程序本身创建的日志。你不能覆盖它。您可以删除此目录。
6.  `%USERPROFILE%\web2feplogs`是由 WAS Web 2.0 Feature Pack 的安装程序创建的日志。你不能覆盖它。您可以删除此目录。

**根据评论**编辑**`PMT\workspace`：该目录似乎是 Eclipse 工作区的格式。我怀疑这是您（或您运行的程序）在 GUI 模式下启动 Profile Management Tool 时创建的。据我所知，这个目录可以删除，但下次您在 GUI 模式下运行 PMT 时它会重新出现。**

# c# - FormView 在更新时未向其 SqlDataSource 提供 OldValues

> ID：11440988
> 
> 赞同：0
> 
> 时间：2012-07-11T20:30:29.417
> 
> 标签：c#, asp.net, sqldatasource, formview

我一直在寻找这个解决方案 4 天 - 帮助我 stackoverflow .. 你是我唯一的希望。

我正在使用 FormView 来启用编辑大表的行。FormView 的 DataSource 是使用 DataSourceId 属性指定的。

SqlDataSource 指定了 OldValuesParameterFormatString，并将 ConflictDetection 设置为“CompareAllValues”。

我的问题是 FormView 没有设置 OldValues，因此在 Update 命令期间不会发生 CompareAllValues。

我搜索了互联网并遇到了一些建议，但没有一个解决了这个问题。我希望有人知道为什么没有设置 OldValues。

这是（简化的）代码：

```
<asp:FormView ID="FormViewPlanAgain" runat="server" DataSourceID="SqlPlanSourceAgain"     DataKeyNames="PlansRID">
    <ItemTemplate>
        <%# Eval("PlanName") %>
    </ItemTemplate>
    <EditItemTemplate>
        <dx:ASPxTextBox id="ASPxTextBox36" runat="server" CssClass="floatLeft veryLarge" Text='<%# Bind("PlanName") %>' />
        <asp:Button ID="btnUpdate" runat="Server" CommandName="Update" Text="Update" />
        <asp:Button ID="btnCancel" runat="Server" CommandName="Cancel" Text="Cancel" />
    </EditItemTemplate>
</asp:FormView>

<asp:SqlDataSource ID="SqlPlanSourceAgain" runat="server" OldValuesParameterFormatString="original_{0}" ConflictDetection="CompareAllValues"
            ConnectionString="<%$ ConnectionStrings:cpaConnectionString %>" 
            SelectCommand="Select * FROM Plans WHERE Plans.PlansRID = @PlansRID" SelectCommandType="Text"
            UpdateCommand="Plans_Update" UpdateCommandType="StoredProcedure" OnSelecting="SqlPlanSource_Selecting">
            <SelectParameters>
                <asp:Parameter DefaultValue="0" Name="PlansRID" Type="Int32" />
            </SelectParameters>
            <UpdateParameters>
                <asp:Parameter Name="GroupsRID" Type="Int32" />
                <asp:Parameter Name="ProductCodeRID" Type="Int32" />
                <asp:Parameter Name="ProductRID" Type="Int32" />
                <asp:Parameter Name="PoolRID" Type="Int32" />
                <asp:Parameter Name="PlanName" Type="String" />
                <asp:Parameter Name="PlanID" Type="Int32" />
                <asp:Parameter Name="ProductID" Type="Int32" />
                <asp:Parameter Name="AdminPercent" Type="String" />
                <asp:Parameter Name="ArizonaEmployees" Type="String" />
                <asp:Parameter Name="BenefitChanges" Type="Int32" />
                <asp:Parameter Name="EmployeesAfterWaivers" Type="String" />
                <asp:Parameter Name="ParticipationPercent" Type="String" />
                <asp:Parameter Name="TheoreticalPremium" Type="String" />
                <asp:Parameter Name="CCBrokerOnCorrespondence" Type="String" />
                <asp:Parameter Name="ClaimSystemPlanNameRider" Type="String" />
                <asp:Parameter Name="COBRAAdminEntityRID" Type="Int32" />
                <asp:Parameter Name="Commission" Type="String" />
                <asp:Parameter Name="CoveragePastRetirement" Type="String" />
                <asp:Parameter Name="DependentAgeLimit" Type="String" />
                <asp:Parameter Name="DomesticPartnerCoverage" Type="String" />
                <asp:Parameter Name="EligibleEmployeeCount" Type="String" />
                <asp:Parameter Name="EmployerGroupContribution" Type="String" />
                <asp:Parameter Name="EnrollmentCount" Type="String" />
                <asp:Parameter Name="ERISA" Type="String" />
                <asp:Parameter Name="ExternalID" Type="Int32" />
                <asp:Parameter Name="ExternalCarrierEntityRID" Type="Int32" />
                <asp:Parameter Name="FundingTypeRID" Type="Int32" />
                <asp:Parameter Name="GenerateRenewal" Type="String" />
                <asp:Parameter Name="HandbookTypeRID" Type="Int32" />
                <asp:Parameter Name="HandbookDistributionRID" Type="Int32" />
                <asp:Parameter Name="InternalCOB" Type="String" />
                <asp:Parameter Name="LegalGuardianship" Type="String" />
                <asp:Parameter Name="NewHireWaitingPeriod" Type="String" />
                <asp:Parameter Name="OnlineEnrollment" Type="String" />
                <asp:Parameter Name="ParticipationRequirement" Type="String" />
                <asp:Parameter Name="RiskPercent" Type="String" />
                <asp:Parameter Name="RiskTier" Type="String" />
                <asp:Parameter Name="SASDivisionRID" Type="String" />
                <asp:Parameter Name="SASPlanRID" Type="String" />
                <asp:Parameter Name="ContractLengthRID" Type="String" />
                <asp:Parameter Name="StepChildrenCoverageTypeRID" Type="String" />
                <asp:Parameter Name="TargetLossRatio" Type="String" />
                <asp:Parameter Name="UnderwritingCompanyRID" Type="String" />
                <asp:Parameter Name="VoluntaryContributoryTypeRID" Type="String" />
                <asp:Parameter Name="EditorUsersRID" Type="String" />
                <asp:Parameter Name="EffectiveStartDate" Type="String" />
                <asp:Parameter Name="EffectiveEndDate" Type="String" />
                <asp:Parameter Name="Stamp" Type="String" />
                <asp:Parameter Name="SequenceNumber" Type="String" />
                <asp:Parameter Name="ActiveFlag" Type="String" />
                <asp:Parameter Name="Note" Type="String" />
                <asp:Parameter Name="HistoryNotes" Type="String" />
            </UpdateParameters>
        </asp:SqlDataSource> 
```

为了清楚起见，我将 ItemTemplate 和 EditItemTemplate 中的所有其他字段都删掉了，以免您头疼。我将它们留在了 SqlDataSource 中，因此您可以看到我正在使用的字段相当多。

据我所知，我已经正确设置了一切，甚至从头开始完全重做一切，只是为了确保。有没有人有任何提示？非常感谢您的参与。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T21:18:50.080

将原始值添加到您的参数列表中：

```
<UpdateParameters> 
            <asp:Parameter Name="GroupsRID" Type="Int32" /> 
            <asp:Parameter Name="original_GroupsRID" Type="Int32" /> 
            <asp:Parameter Name="ProductCodeRID" Type="Int32" /> 
            <asp:Parameter Name="original_ProductCodeRID" Type="Int32" /> 
            <asp:Parameter Name="ProductRID" Type="Int32" /> 
            <asp:Parameter Name="original_ProductRID" Type="Int32" /> 
```

您还需要修改存储过程 (Plans_Update) 以接受这些值。

# spss - 如何在SPSS中对数据进行winsorize？

> ID：11440989
> 
> 赞同：1
> 
> 时间：2012-07-11T20:30:30.820
> 
> 标签：spss

有谁知道如何在SPSS中对数据进行winsorize？我的一些变量有异常值，并且想对它们进行winsorize。有人教我如何使用`Transform -> compute variable`命令，但我忘记了该怎么做。我相信他们告诉我只计算我想要进行 Winsorize 的主题测量的平方根。有人可以为我解释一下这个过程吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T01:25:25.473

网上有一个[脚本可以做到，它已经出现了](http://pages.infinit.net/rlevesqu/Syntax/RankingLargestValSortingGrouping/WinsorizeMean.txt)。它可能会被简化（保存到单独的文件是完全没有必要的），但它应该可以完成这项工作。如果您不需要脚本并且您知道所需的百分位数的值，那么它会很简单：

获取变量百分位数的估计值`X`（这里我得到第 5 个和第 95 个百分位数）；

```
freq var X /format = notable /percentiles = 5 95. 
```

然后假设（仅通过查看输出）第 5 个百分位等于 100，第 95 个百分位等于 250。然后让我们创建一个新变量，命名为`winsor_X`用相关的百分位替换所有低于第 5 个和第 95 个百分位的值。

```
compute winsor_X = X.
if X <= 100 winsor_X = 100.
if X >= 250 winsor_X = 250. 
```

你可以用十几种不同的方式来完成最后一部分，但希望这足以清楚地了解当你对变量进行 Winsorize 时发生了什么。

# ms-access - 通过 VBScript 将数据从 Oracle 移动到 MS Access 的最快方法

> ID：11440996
> 
> 赞同：3
> 
> 时间：2012-07-11T20:31:05.540
> 
> 标签：ms-access, vbscript, oracle11g, vba

通常，我只会循环使用 Recordset.AddNew，但是在处理大型记录集时这会非常缓慢——有没有更好的方法来做到这一点？我希望有一种方法可以简单地编写从 Oracle 到 Access 的插入语句，可能是通过使用两个 ADO 连接，但我能找到的唯一示例是在 VB.net（使用 OleDbCommand）中，遗憾的是这不是选项。这仅仅是 VBScript 的限制吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:50:50.843

您的问题标签包括 access-vba，因此我建议使用[DoCmd.TransferDatabase Method](http://msdn.microsoft.com/en-us/library/bb214131%28office.12%29.aspx)。

此示例位于页面底部附近，用于创建指向 SQL Server 表的 ODBC 链接。它假定一个名为 的 DSN（数据源名称）`DataSource1`。Access 中的链接名称为`Authors`，服务器源表为`dboAuthors`。

```
DoCmd.TransferDatabase acLink, "ODBC Database", _
    "ODBC;DSN=DataSource1;UID=User2;PWD=www;LANGUAGE=us_english;" _
    & "DATABASE=pubs", acTable, "Authors", "dboAuthors" 
```

您可以使用适当的 DSN 为 Oracle 调整它。如果您想导入而不是链接，请替换`acImport`为`acLink`.

实际上，您甚至可能不需要为此编写代码。使用有效的 DSN，您可以通过 Access 用户界面导入（或链接）。

您的标题提到了 VBScript。告诉我们您是否真的必须使用 VBScript 而不是 VBA。

阅读您的评论后，我认为您最好采用不同的方法。

创建一个带有指向 Oracle 表的 ODBC 链接的数据库。

然后将该表数据的子集导出到您的各个数据库文件。

```
SELECT master_link.* INTO local_table IN 'c:\somefolder\db1.mdb'
FROM master_link
WHERE location = 'location1'; 
```

然后调整每个目标 db 文件的 SQL 和数据选择标准。从一个简单的 VBA 程序中驱动它应该很容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T17:01:30.683

以下是使用 SQL Server 而不是 Oracle 的 VBScript 的一些注意事项，但是，应该可以使用非常相似的东西。

```
Const CreatePath = "Z:\docs\"
Const Provider = "Microsoft.ACE.OLEDB.12.0;"
''The easiest way to get this line is from the connect property of 
''a linked table
Const ServerInLine = "[ODBC;DRIVER=SQL Server;SERVER=server;Trusted_Connection=Yes;DATABASE=db]"
''Change this to the Oracle connection
Const ServerConnect = "Provider=sqloledb;Data Source=server;Initial Catalog=db;Integrated Security=SSPI;"

Dim cnSS ''As ADODB.Connection
Dim cnMSA ''As ADODB.Connection
Dim cat ''As New ADOX.Catalog

Set cat = CreateObject("ADOX.Catalog")

Set cnSS = CreateObject("ADODB.Connection")
Set cnMSA = CreateObject("ADODB.Connection")
Set rs = CreateObject("ADODB.Recordset")

cnSS.Open ServerConnect

''Only the locations that exist. Assuming a location table
''with a description, Location
sSQL = "SELECT DISTINCT a.LocationID, b.Location FROM ATable a "
sSQL = sSQL & "INNER JOIN Location b ON a.LocationID = b.ID"

rs.Open sSQL, cnSS

Do While Not rs.EOF

    DBName = CreatePath & Trim(rs.Fields("Location")) & ".accdb"
    scn = "Provider=" & Provider & ";Data Source=" & DBName

    cat.Create scn

    cnMSA.Open scn

    sSQL = "SELECT * INTO " & Replace(Trim(rs.Fields("Location")), " ", "")
    sSQL = sSQL & " FROM " & ServerInLine & ".ATable"
    sSQL = sSQL & " WHERE LocationID=" & rs.Fields("LocationID")

    cnMSA.Execute sSQL, recs
    sMsg = sMsg & vbCrLf & DBName & " created " & recs

    rs.MoveNext
    cnMSA.Close
Loop

MsgBox sMsg 
```

# mercurial - NAnt - 根据验证程序，远程证书无效

> ID：11440997
> 
> 赞同：0
> 
> 时间：2012-07-11T20:31:08.087
> 
> 标签：mercurial, ssl-certificate, nant, self-signed

使用 NAnt，我试图通过我的构建脚本从我的 Mercurial 服务器下载一个文件。

Mercurial 服务器配置为允许使用自签名证书通过 https 进行访问。

我可以使用网络浏览器毫无问题地下载文件，因此我知道服务器上的权限设置正确。

但是，当我尝试通过 NAnt 执行此操作时，我收到一条错误消息，指出“根据验证程序，远程连接无效。”。

任何人都可以就我如何解决这个问题提供建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T20:31:08.977

服务器的证书需要安装在执行脚本的机器上才能正常工作。

有关如何执行此操作的说明，请参阅此[过程。](http://technet.microsoft.com/en-us/library/cc754841.aspx#BKMK_addlocal)在开始之前，您需要从服务器导出证书。这可以通过在浏览器中查看网站的证书详细信息并将其导出来完成。