# StackOverflow 问答 12288000-12288999

# sql - 插入和删除是否可以包含来自混合操作的数据？

> ID：12288001
> 
> 赞同：0
> 
> 时间：2012-09-05T18:58:10.763
> 
> 标签：sql, sql-server

使用插入和删除表的一个警告是它们都可以是空的。还有其他我应该注意的catchya吗？例如，插入的表是否可以包含新记录和更新记录？

我依靠这个逻辑来检测触发器中的动作：

```
IF EXISTS(SELECT * FROM inserted) AND EXISTS(SELECT * FROM deleted) SET @operation = 'U'
IF EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted) SET @operation = 'I'
IF NOT EXISTS(SELECT * FROM inserted) AND EXISTS(SELECT * FROM deleted) SET @operation = 'D'
IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted) SET @operation = 'X' 
```

编辑：

这是我对审计跟踪问题的解决方案。它已经在一个插入、虚假更新、真实更新和删除的 MERGE 语句上进行了测试。

```
ALTER TRIGGER [dbo].[LogInsertEditDelete]
ON [dbo].[<TableToAudit>]
   AFTER INSERT,DELETE,UPDATE
AS 
BEGIN
-- SET NOCOUNT ON added to prevent extra result sets from
-- interfering with SELECT statements.
SET NOCOUNT ON;

--You will need to change @table to match the table to be audited
DECLARE @table VARCHAR(50)
SELECT @table = '<TableToAudit>'

-- date and user
DECLARE @updatedBy VARCHAR(50),
        @timestamp DateTime
SELECT @updatedBy = SYSTEM_USER,
       @timestamp = GETDATE()

-- Action, U = update, I = insert, D = delete
DECLARE @insertedCount int, 
        @deletedCount int
SET @insertedCount = (SELECT COUNT(*) FROM inserted)
SET @deletedCount = (SELECT COUNT(*) FROM deleted)

-- handle no action
IF @insertedCount = 0 AND @deletedCount = 0 RETURN  

-- handle update
IF @insertedCount <> 0 AND @deletedCount <> 0
BEGIN
    INSERT Audit (Type, TableName, UpdateDate, UpdatedBy, PK1)
    SELECT
        'U', 
        @table,
        @timestamp,
        @updatedBy,
        CONVERT(VARCHAR(255), i.Id)
    FROM
        (SELECT Id, BINARY_CHECKSUM(*) Version FROM inserted) i
        INNER JOIN
        (SELECT Id, BINARY_CHECKSUM(*) Version FROM deleted) d
        ON i.Id = d.Id
    WHERE
        i.Version <> d.Version  

    RETURN      
END

-- handle deletes and inserts
INSERT Audit (Type, TableName, UpdateDate, UpdatedBy, PK1)
SELECT          
    CASE 
        WHEN i.Id IS NOT NULL AND d.Id IS NULL THEN 'I'
        WHEN i.Id IS NULL AND d.Id IS NOT NULL THEN 'D'
    END,
    @table,
    @timestamp,
    @updatedBy,
    CONVERT(VARCHAR(255), COALESCE(i.Id, d.Id))
FROM inserted i 
        FULL OUTER JOIN
     deleted d 
        ON i.Id = d.Id
WHERE i.Id IS NULL OR
      d.Id IS NULL

END 
```

此解决方案不是通用的，因为需要为每个表拼出主键。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T19:03:11.520

所有 4 种情况都是可能的。值得注意的是，在更新的情况下为“both”，在 DML 语句未修改任何行的情况下为“none”。

`EXISTS`可以比使用查询更便宜地检测到最后一个条件：

```
if @@ROWCOUNT = 0
    return 
```

您可以稍微调整一下`EXIST`-check 结构，以便每个表只查询一次以提高效率。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T19:36:54.030

发表评论后，我对 MERGE 中插入和删除的表中的内容感到好奇。这是一个例子：

```
create table #test (test1 int identity not null, test2 varchar(34) null)

Insert into #test (test2)
values('test'), ('test2')

select * from #test

declare @output table(test1I int, test1D int, test2I varchar (34), test2D varchar (34))

MERGE #test AS target
USING (SELECT test1, test2 from #test ) AS source (test1, test2)
ON (target.test1 = source.test1)
WHEN MATCHED AND target.test1 = 1
    THEN UPDATE SET target.test2 = 'test3'
WHEN  MATCHED 
    THEN DELETE

OUTPUT inserted.test1, deleted.test1,  inserted.test2, deleted.test2 into @output ;

select 'Inserted/deleted contents', * from @output
select * from #test

Drop table #test 
```

如果您正在执行插入或更新，则会发生类似的事情。

如果您需要了解每条记录，您可能希望使用连接和案例语句来确定每条记录的状态，而不是使用标量变量。请记住，触发器一次对插入/更新/删除的整个记录​​集进行操作，而不是一次记录一条记录。所以使用标量变量通常是你没有正确做事的线索。如果您给我们提供更多有关触发器将要做什么的示例，那么帮助您解决问题会更容易，因为当前的方法似乎无法涵盖所有​​记录。

根据您上面的评论，也许这会给您一些关于在触发器中尝试什么的想法：

```
Insert dbo.Audittable (Id, NewField1Value, OldField1Value, ActionTaken, ActionDate, ActionUser)
select coalesce(inserted.id, deleted.id) as Id, inserted.field1 as newField1value, deleted.field1 as oldField1value ,
case when inserted.id is not null and deleted.id is not null then 'Update'
when inserted.id is not null and deleted.id is  null then 'Insert'
when inserted.id is null and deleted.id is not null then 'Delete'
End as ActionTaken
, getdate() as ActionDate
, system_user as ActionUser
from inserted
full outer join deleted on inserted.id = deleted.id 
```

测试触发器时，您至少需要以下测试用例：

*   单条记录插入
*   单条记录删除
*   单条记录更新
*   多条记录插入
*   多条记录删除
*   多条记录更新
*   插入和删除的多条记录合并
*   进行更新和删除的多条记录合并
*   插入和更新的多条记录合并

您可能需要更多，具体取决于触发器将要执行的所有操作。

# java - ehcache + Hibernate + hibernate Restrictions.like 查询

> ID：12288002
> 
> 赞同：0
> 
> 时间：2012-09-05T18:58:13.770
> 
> 标签：java, hibernate, ehcache

我在尝试使用 ehcache 缓存的查找表中有一个数据列表。我注意到缓存正在正确填充数据，但是当我在条件查询中使用 .add( Restrictions.like("name", "Fritz%")) 时，它似乎没有命中二级缓存. 有没有办法将 ehcache 配置为使用字符串值而不是 Id 来查看缓存？

查询示例

```
List cats = sess.createCriteria(Cat.class)
    .add( Restrictions.like("name", "Fritz%") )
    .setCacheable(true)
    .list(); 
```

休眠.cfg.xml

```
 <!-- Enable Second-Level Cache and Query Cache Settings --> 
    <property name="hibernate.cache.use_second_level_cache">true</property>         
    <property name="hibernate.cache.use_query_cache">true</property>
    <property name="hibernate.cache.region.factory_class">net.sf.ehcache.hibernate.EhCacheRegionFactory</property>         
    <property name="hibernate.generate_statistics">false</property> 
```

实体

```
@Entity
@org.hibernate.annotations.Cache(usage = CacheConcurrencyStrategy.READ_WRITE)
public class Cat implements Serializable {

private String name; 
```

日志

```
stat.Statistics HQL: null, time: 1ms, rows: 0
cache.StandardQueryCache caching query results in region: org.hibernate.cache.StandardQueryCache; timestamp=5516849224093696
cache.UpdateTimestampsCache Pre-invalidating space [vehicle_trim_level]
cache.UpdateTimestampsCache Pre-invalidating space [vehicle_model]
cache.UpdateTimestampsCache Invalidating space [vehicle_model], timestamp: 5516849224110081
cache.UpdateTimestampsCache Invalidating space [vehicle_trim_level], timestamp: 5516849224110081
cache.UpdateTimestampsCache Pre-invalidating space [vehicle]
stat.ConcurrentStatisticsImpl Logging statistics....
stat.ConcurrentStatisticsImpl start time: 1346820087066
stat.ConcurrentStatisticsImpl sessions opened: 57
stat.ConcurrentStatisticsImpl sessions closed: 56
stat.ConcurrentStatisticsImpl transactions: 1211
stat.ConcurrentStatisticsImpl successful transactions: 1153
stat.ConcurrentStatisticsImpl optimistic lock failures: 0
stat.ConcurrentStatisticsImpl flushes: 1153
stat.ConcurrentStatisticsImpl connections obtained: 1212
stat.ConcurrentStatisticsImpl statements prepared: 2444
stat.ConcurrentStatisticsImpl statements closed: 2444
stat.ConcurrentStatisticsImpl second level cache puts: 540
stat.ConcurrentStatisticsImpl second level cache hits: 0
stat.ConcurrentStatisticsImpl second level cache misses: 0
stat.ConcurrentStatisticsImpl entities loaded: 125
stat.ConcurrentStatisticsImpl entities updated: 710
stat.ConcurrentStatisticsImpl entities inserted: 475
stat.ConcurrentStatisticsImpl entities deleted: 0
stat.ConcurrentStatisticsImpl entities fetched (minimize this): 0
stat.ConcurrentStatisticsImpl collections loaded: 8
stat.ConcurrentStatisticsImpl collections updated: 0
stat.ConcurrentStatisticsImpl collections removed: 0
stat.ConcurrentStatisticsImpl collections recreated: 0
stat.ConcurrentStatisticsImpl collections fetched (minimize this): 8
stat.ConcurrentStatisticsImpl queries executed to database: 719
stat.ConcurrentStatisticsImpl query cache puts: 680
stat.ConcurrentStatisticsImpl query cache hits: 494
stat.ConcurrentStatisticsImpl query cache misses: 680
stat.ConcurrentStatisticsImpl max query time: 10ms
cache.UpdateTimestampsCache Pre-invalidating space [vehicle_trim_level]
cache.UpdateTimestampsCache Invalidating space [vehicle], timestamp: 5516849228881920
cache.UpdateTimestampsCache Invalidating space [vehicle_trim_level], timestamp: 5516849228881920 
```

# mysql - Mysql 计算多列

> ID：12288004
> 
> 赞同：0
> 
> 时间：2012-09-05T18:58:30.683
> 
> 标签：mysql, sql, database

在写这个查询时，我已经把头撞在墙上几个小时了。我有两张桌子。我想选择在某个日期玩游戏的次数，但每个用户只计算一个游戏。比如 2011 年 Ping Ping 玩了 3 次，但只有 2 个用户，所以我想返回的总数是 2。

会话表

```
DATE    GAME_ID     USER_ID
2011      1           1
2011      2           1
2011      1           1
2011      1           2
2011      2           2
2012      1           1
2012      1           1 
```

游戏桌

```
ID      NAME
1       PING PONG
2       TENNIS 
```

到目前为止，我真的很挣扎。此代码段返回唯一时间，但不限于日期。

```
SELECT DISTINCT GAME_ID,USER_ID FROM SESSIONS 
```

我知道如何将查询限制为日期等，但在两列之间的计数方面遇到了困难，我是否必须将上面的查询传递给计数函数？

任何帮助将不胜感激！

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T19:14:54.687

您要做的是计算给定日期的不同用户：

```
select g.name, count(distinct s.user_id) as NumUsers
from sessions s join
     games g
     on s.game_id = g.id
where date = <whatever your date>
group by g.name 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T19:01:34.643

您将希望在 user_id 上使用 group by 子句

[http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T19:17:58.703

使用内联查询：

```
select DATE, GAME_ID, count(*) from (
SELECT distinct s.DATE, s.GAME_ID, s.USER_ID
FROM SESSIONS s
INNER JOIN GAMES g ON s.GAME_ID =g.ID ) inn
group by DATE, GAME_ID 
```

如果需要，将 DATE 上的 WHERE 添加到内联查询。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-05T19:21:28.903

此查询显示在特定日期玩特定游戏的用户数，

```
SELECT GAME_ID, USER_ID, COUNT(DISTINCT USER_ID) FROM SESSIONS 
GROUP BY DATE, GAME_ID, USER_ID; 
```

而这个查询是在这个时候显示相同的结果而不是显示`game_id`我们显示的`game_name`

```
SELECT Q2.USER_ID, Q2.nbr_user, GAMES.NAME FROM GAMES, 
         (SELECT GAME_ID, USER_ID, COUNT(DISTINCT USER_ID) as nbr_user
          FROM SESSIONS 
          GROUP BY DATE, GAME_ID, USER_ID) Q2
WHERE GAMES.ID = Q2.GAME_ID 
```

# c# - 在 C# 中，如何识别不同的对并计算它在一长串对中出现的次数？

> ID：12288013
> 
> 赞同：0
> 
> 时间：2012-09-05T18:59:09.573
> 
> 标签：c#, visual-studio-2010

我正在使用 Visual C# 2010 Express。我有一群学生告诉我过去有哪对学生一起工作过。因此，arrStudents(0,0) 可能包含 Joe，而 arrStudents(0,1) 包含 Bob，有时反之亦然。记录名字的顺序无关紧要，我关心的只是配对信息。

例子：

```
Joe - Bob
Mary - Bob
Bob - Joe
Mary - Joe
Jack - Mary
Joe - Bob 
```

我应该使用什么方法来识别所有不同的对并计算它发生了多少次？

因此，由于 (Joe - Bob) 和 (Bob - Joe) 是同一对，结果应该产生：

```
Joe - Bob, 3
Mary - Bob, 1
Mary - Joe, 1
Jack - Mary, 1 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-05T19:07:53.773

我会创建一个`Dictionary`，其中键是学生对，值是计数。然后遍历所有对并将它们添加到字典中。对于每一对，按字母顺序（或其他）对名称进行排序，以使“Joe-Bob”和“Bob-Joe”都以“Bob-Joe”结尾。如果字典中已经存在该对，则将对应的值加 1。如果不存在，则添加它并将值设置为 1。最后，只需遍历字典即可获得结果。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-05T19:10:25.403

```
List<Tuple<string, string>> list = new List<Tuple<string, string>>()
{
    //Joe - Bob Mary - Bob Bob - Joe Mary - Joe Jack - Mary Joe - Bob
    new Tuple<string,string>("Joe","Bob"),
    new Tuple<string,string>("Mary","Bob"),
    new Tuple<string,string>("Bob","Joe"),
    new Tuple<string,string>("Mary","Joe"),
    new Tuple<string,string>("Jack","Mary"),
    new Tuple<string,string>("Joe","Bob")
};

var result = list.GroupBy(x=>x, new MyComparer())
    .Select(g=>new {Count = g.Count(),Pair = g.First()})
    .ToArray(); 
```

--

```
public class MyComparer : IEqualityComparer<Tuple<string, string>>
{
    public bool Equals(Tuple<string, string> x, Tuple<string, string> y)
    {
        return (x.Item1 == y.Item1 && x.Item2 == y.Item2) ||
            (x.Item2 == y.Item1 && x.Item1 == y.Item2);
    }

    public int GetHashCode(Tuple<string, string> obj)
    {
        return obj.Item1.GetHashCode() ^ obj.Item2.GetHashCode();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T19:16:48.823

我能想到的最简单的方法是使用一点 Linq。首先，将所有学生对作为字符串对列表，类似于您显示的内容。A`List<Tuple<string, string>>`应该工作。棘手的一点是您使用的是矩形数组，如果您将其视为 IEnumerable，它会有一些奇怪的访问行为。

然后，您需要一种方法来比较两对是否相等。我有一个通用类，允许您指定用于比较的 lambda 语句，因此您不必为每个自定义比较实现单一用途的 IEqualityComparer：

```
public class GenericEqualityComparer<T> : IEqualityComparer<T>
{
    private readonly Func<T, T, bool> equalityComparer;
    private readonly Func<T, int> hashFunc;

    public GenericEqualityComparer(Func<T, T, bool> compareFunc, Func<T,int> hashFunc)
        :this(compareFunc)
    {
        this.equalityComparer = compareFunc;
        this.hashFunc = hashFunc;
    }

    public GenericEqualityComparer(Func<T, T, bool> compareFunc)
    {
        this.equalityComparer = compareFunc;
        this.hashFunc = o => o.GetHashCode();
    }

    public bool Equals(T x, T y)
    {
        return equalityComparer(x, y);
    }

    public int GetHashCode(T obj)
    {
        return hashFunc(obj);
    }
} 
```

然后，您只需通过 Linq 的 GroupBy() 方法运行值列表，指定 GenericEqualityComparer 以自定义顺序无关的方式比较值：

```
var pairCounts = pairList
                    .GroupBy(p=>p, //key selector; we want the Tuple itself
                       new GenericEqualityComparer<Tuple<string,string>>(
                          (a,b)=>(a.Item1 == b.Item1 && a.Item2 == b.Item2) 
                             || (a.Item1 == b.Item2 && a.Item2 == b.Item1))
                    .Select(g=>new Tuple<string, int>(g.Key.Item1 + " - " + g.Key.Item2,
                                                      g.Count()); 
```

最终结果将是`List<Tuple<string,int>>`包含找到的每对名称的第一个排列，以及在列表中找到该对的任意排列的数量。

# c - printf 样式格式化而不输出

> ID：12288014
> 
> 赞同：2
> 
> 时间：2012-09-05T18:59:10.870
> 
> 标签：c, string, printf

我想要做的是`char*`使用类似于以下的语法创建一个新的`printf`：

```
char* myNewString = XXXXprintf("My string says %s", myFirstString); 
```

这在不打印到输出流的情况下可行吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-05T19:02:24.877

您正在寻找`sprintf`or`snprintf`功能。

请注意，`sprintf`它不会返回指向新分配字符串的指针；您必须自己分配字符串，并确保它足够大：

```
char target[100];
sprintf(target, "My string says %s", myFirstString); 
```

除非您*可以确定*目标足够大，否则您应该使用`snprintf`，它会限制复制到目标字符串的字节数。

`snprintf`返回将写入目标字符串的字符数。您可以`snprintf`使用空目标和零大小调用以找出需要多少大缓冲区，然后分配缓冲区并再次调用它以写入目标（**注意**：我的原始代码示例有一个错误。 )

```
#include <stdio.h>
#include <stdlib.h>

int main(void) {
    const char *myFirstString = "hello, world";
    char *target;
    size_t size = snprintf(NULL, 0, "My string says %s", myFirstString);
    target = malloc(size+1); /* +1 for terminating '\0' */
    if (target == NULL) {
        fprintf(stderr, "Allocation failed\n");
        exit(EXIT_FAILURE);
    }
    size = snprintf(target, size+1, "My string says %s", myFirstString);
    printf("target = \"%s\"\n", target);
    return 0;
} 
```

请注意，它`snprintf`是由 1999 ISO 标准添加到 C 中的。微软的编译器似乎不支持它；它确实提供了一个它调用的函数，`_snprintf`它*可能*做同样的事情。

还有一个名为的 GNU 扩展`asprintf`，它会为您分配字符串：

```
char *target;
asprintf(&target, "My string says %s", myFirstString); 
```

如果你使用它，你将不得不`free()`稍后使用它来释放字符串。而且由于这是一个 GNU 扩展，它会使您的代码的可移植性降低。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-05T19:00:28.373

当然，这就是`sprintf`：将`printf`样式格式化为提供的`char*`.

[本文档](http://en.cppreference.com/w/c/io/fprintf)涵盖`sprintf`和相关`printf`的功能。请务必考虑`snprintf`改用：正确使用会比`sprintf`限制实际复制到提供的缓冲区的字节数更安全。

用法与您的示例略有不同：您提供一个由`sprintf`. 该函数*不*返回结果，与其他`printf`函数一样，返回一个`int`: 打印的字符数。

```
char myNewString[MAX_LEN];
snprintf(myNewString, MAX_LEN, "My string says %s", myFirstString); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T19:00:32.103

您正在寻找的功能是`sprintf`.

[http://www.manpages.info/linux/sprintf.3.html](http://www.manpages.info/linux/sprintf.3.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-05T19:04:34.940

如果您不介意 GNUisms，它`asprintf`可能是最接近您所追求的东西：它会自动为您分配一个缓冲区（但之后您*必须*记住`free`它）。

```
char *target;
int ret = asprintf(&target, "My string says %s", myFirstString);
// if ret < 0, the contents of target are undefined 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-05T19:01:54.410

我推荐`snprintf`，它比`sprintf`.

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-09-05T19:01:39.760

sprintf 应该为您做到这一点。

与 printf 的唯一区别是第一个参数是一个 char*，用于存储字符串，即

```
sprintf(myNewString, "My string says %s", myFirstString); 
```

# jquery - 在 CSS 中淡入另一个精灵表位置的最简单方法

> ID：12288015
> 
> 赞同：0
> 
> 时间：2012-09-05T18:59:11.683
> 
> 标签：jquery, html, css

目前，我正在开发一个网站，该网站在单独的精灵表上有多个图像（例如[此链接中的两个（imgur）](http://imgur.com/a/8IOS7#0)。我正在尝试将较暗的图像淡化为较亮的图像，并且我一直在使用类似的东西：

```
.display {
    background-image: url("../images/1.png");
    display: block;
    background-position: 0 -53px;
    width: 124px;
    height: 53px;
}
.display:hover {
    background-image: url("../images/1.png");
    display: block;
    background-position: 0 0px;
    width: 124px;
    height: 53px;
} 
```

这可行，但它只会使图像立即改变，我更喜欢悬停时的某种“淡入”或“发光”效果。实现我想要的结果的最简单方法是什么？我想它会是 jQuery 或 CSS3 中的东西，但我真的没有运气。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T19:03:56.220

在 CSS 3 中，您可以这样做，设置`opacity`并添加`transformation`，您只需要一张图片！看看这个：

```
img {
    opacity: 0.5;
    transition: opacity 0.5s;
    -moz-transition: opacity 0.5s; /* Firefox 4 */
    -webkit-transition: opacity 0.5s; /* Safari and Chrome */
    -o-transition: opacity 0.5s; /* Opera */
}
img:hover {
    opacity: 1;
    transition: opacity 0.5s;
    -moz-transition: opacity 0.5s; /* Firefox 4 */
    -webkit-transition: opacity 0.5s; /* Safari and Chrome */
    -o-transition: opacity 0.5s; /* Opera */
}​ 
```

### 小提琴：http: [//jsfiddle.net/sBeed/](http://jsfiddle.net/sBeed/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T19:01:36.467

在容器中放置一个带有悬停类的 div，然后淡入悬停 div。我以前做过...这适用于任何浏览器，甚至 ie7/ie8

```
<div class="container">
    <div class="hover"></div>
</div>

$(".container").hover(function(){
    $(".hover", this).fadeIn();
});

.container {
    position:relative;
}

.container.hover {
    position:absolute;
    top:0px;
    left:0px;
    display:none;
} 
```

# r - 所有面板下都需要轴

> ID：12288020
> 
> 赞同：2
> 
> 时间：2012-09-05T18:59:37.920
> 
> 标签：r, lattice

如何在所有底部面板下显示轴？在此示例中，如果存在缺少正方形的网格，则不会显示轴。

```
library(lattice)
arr<- array(replicate(10, rnorm(10)), dim =c(10,10,10) )
dotplot(arr, type = "b", horizontal = F, col = "red",
    main =list( " Centrality", cex=1.5), xlab.top="",as.table=T,
    ylab =list( "Centralities", cex=1.3), 
    xlab = list("Proportion Cutpoints"), 
    scale=list(y=list(cex=1.2,  alternating =1), cex =1),
    auto.key=list(  points = F, border= "grey",
                      space = "top", lines = T, columns=4,height=10,
                      title = "Technologies"),
    par.settings = list(superpose.line = list(col = "red", lwd=2, lty=1:6 ),
                        layout.heights= list(xlab.key.padding = 1), 
                        layout.widths = list(key.ylab.padding = 1)),
    par.strip.text = list(cex=1.5)) 
```

![缺少标签](../Images/75eab3c9ee4dcf884516a5b7001c34d7.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T06:51:47.867

您必须修改负责绘制轴的函数。
简单的方法是强制指定面板的轴：

```
axis_filled <- function(side, ...) {
    if (side=="bottom" && panel.number() %in% c(7,8)) {
        axis.default(side = side, labels="yes", ticks="yes", ...)
    } else {
        axis.default(side = side, ...)
    }
}

dotplot(arr, type = "b", horizontal = F, col = "red",
    main =list( " Centrality", cex=1.5), xlab.top="",as.table=T, ylab =list( "Centralities", cex=1.3), xlab = list("Proportion Cutpoints"), 
    scale=list(y=list(cex=1.2,  alternating =1), cex =1),
    auto.key=list(points = FALSE, border= "grey", space = "top", lines = TRUE, columns=4,height=10, title = "Technologies"),
    par.settings = list(superpose.line = list(col = "red", lwd=2, lty=1:6 ),                            layout.heights= list(xlab.key.padding = 1), layout.widths = list(key.ylab.padding = 1)),
    par.strip.text = list(cex=1.5),
    axis=axis_filled
) 
```

![填写的标签](../Images/fdd4fdfb8e36e1e63b143e9f2c7269c1.png)

更通用的解决方案是检查面板是否已满。例如：

```
axis_filled <- function(side, ...) {
    force_axis <- if (side=="bottom") {
        panel.layout <- trellis.currentLayout("panel")
        # next to last row and nothing below:
        current.row() == nrow(panel.layout)-1 && panel.layout[current.row()+1,current.column()]==0
    } else FALSE
    if (force_axis) {
        axis.default(side = side, labels="yes", ticks="yes", ...)
    } else {
        axis.default(side = side, ...)
    }
} 
```

# zend-framework - 我可以有一个带有和下划线的类吗？

> ID：12288021
> 
> 赞同：0
> 
> 时间：2012-09-05T18:59:42.240
> 
> 标签：zend-framework, hybridauth

我正在向我的 zend 项目添加第 3 方库（混合身份验证）。调用的主要类是 hybrid_auth。我假设在类名中有下划线会在 zend 中引发错误？我应该在整个库中重命名这个类还是创建自己的自动加载器会更好？

请原谅简洁，我正在使用手机，稍后会尝试更新。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T19:28:17.197

它本身不会引发错误。类名中的下划线非常好。

但是默认的自动加载器会尝试在文件中找到`hybrid_auth`你的类。`include_path``hybrid/auth.php`

您可以：

1.  在引用类之前执行手动包含，以便不会启动自动加载

2.  为这个类写一个自定义的自动加载器 - 以及任何其他类似的 - 并将该自动加载器推入`Zend_Loader_Autoloader`堆栈。

3.  将类和/或文件名重命名为符合 PSR-0 标准，以便标准自动加载器对此感到满意。

就个人而言，我会选择（2）：编写自己的自动加载器。我讨厌猴子补丁第 3 方库代码，因为后续的库更新会覆盖我的 hack。

要编写您自己的自动加载器，请查看[此](https://stackoverflow.com/a/8820536/131824).

# css - text-wrap: none 和 text-overflow:ellipses 都被忽略

> ID：12288022
> 
> 赞同：0
> 
> 时间：2012-09-05T18:59:44.067
> 
> 标签：css

如果我的文本太大而不能放在一行上，我希望我的文本被截断，但是即使我添加了 text-wrap:none 和 text-overflow:ellipes 它溢出到多行而不被截断。

```
<snip>

<ul>
<li>
<img = ...>
<div id = "track_title">text</div>
</li>
</ul>

ul {
    position:absolute:
    list-style: none;
    top:20px;
    margin: 0px;
    padding: 0px;
}

li {
    position: relative;
    background-image: url("track_row_unselected.png");
    display: block;
    height: 80px;
}
#track_title {
    position:absolute;
    padding:0;
    margin:0;
    top: 5px;   
    left: 80px;
    width: 180px;
    font-size: 15px;
    font-weight: bold;
    text-wrap:none;
    text-overflow: ellipsis;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T19:01:50.493

[`text-wrap`](http://www.w3schools.com/cssref/css3_pr_text-wrap.asp)任何主流浏览器都不支持。尝试使用`white-space: nowrap;`. 您还需要添加`overflow: hidden;`. [这是一个 jsFiddle](http://jsfiddle.net/gjvVx/1/)。

# scala - 新的 Maven 依赖项无法识别

> ID：12288026
> 
> 赞同：2
> 
> 时间：2012-09-05T18:59:58.917
> 
> 标签：scala, maven

我向一个 Maven 项目（基于 Scala）添加了一个依赖项，但是在重新编译它之后，找不到新的包。新的依赖项如下所示：

```
<dependency>
    <groupId>org.apache.any23</groupId>
    <artifactId>apache-any23</artifactId>
    <version>0.7.0-incubating</version>
</dependency> 
```

现在当我

```
import org.apache.any23._ 
```

我明白了

```
Error: object any23 is not a member of package org.apache 
```

有人知道问题可能是什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T19:05:05.613

在 .m2/repository 目录中查找 jar 文件。例如在 OSX 终端或 Linux 中：

```
find ~/.m2 -print 
```

然后使用 unzip 或 jar 列出内容：

```
jar tf filename 
```

并查找通用包/类名称。

通过查找文件和内容，您很可能会发现问题，无论它是什么。

更新：我刚刚看过，看来您可能想要核心工件：

artifactId：apache-any23-core

它有 JAR 文件，这些文件更有可能包含您想要的内容：类。

# vba - VBA if else循环在excel中返回#VALUE

> ID：12288027
> 
> 赞同：2
> 
> 时间：2012-09-05T19:00:00.730
> 
> 标签：vba, excel

大家好，在 excel 中使用 VBA 的新手，并试图创建一个函数来查看一个数字并将其作为六位数字返回。

我编写的尝试完成此操作的函数如下，但是当我在单元格中使用命令 =Res(A1) 时，我只得到一个#VALUE！作为答案。

此时单元格一中的值是 30508。

任何人都可以提供解决此问题的任何帮助将不胜感激。多谢你们。

```
Function Res(myval As Integer) As Integer

Res = 0

If ((myval > 0) And (myval < 10)) Then    
    Res = myval * 100000

ElseIf ((myval > 9) And (myval < 100)) Then
    Res = myval * 10000

ElseIf ((myval > 99) And (myval < 1000)) Then 
    Res = myval * 1000

ElseIf ((myval > 999) And (myval < 10000)) Then  
    Res = myval * 100

ElseIf ((myval > 9999) And (myval < 100000)) Then
    Res = myval * 10

ElseIf ((myval > 999999) And (myval < 10000000)) Then
    Res = myval / 10

Else
    Res = myval

End If

End Function 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-05T19:18:04.243

更改`Function Res(myval As Integer) As Integer`为：

```
Function Res(myval As Long) As Long 
```

您正在达到整数最大值。

Long 代表长整数，你想在你的数字超过 30k 的任何时候使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T19:22:13.720

您需要使用 long 而不是整数

整数仅涵盖 -32,768 到 32,767

长覆盖 -2,147,483,648 到 2,147,483,647

```
 Function Res(myval As Long) As Long

    Res = 0

    If ((myval > 0) And (myval < 10)) Then    
       Res = myval * 100000

    ElseIf ((myval > 9) And (myval < 100)) Then
        Res = myval * 10000

    ElseIf ((myval > 99) And (myval < 1000)) Then 
        Res = myval * 1000

    ElseIf ((myval > 999) And (myval < 10000)) Then  
        Res = myval * 100

    ElseIf ((myval > 9999) And (myval < 100000)) Then
        Res = myval * 10

    ElseIf ((myval > 999999) And (myval < 10000000)) Then
        Res = myval / 10

    Else
        Res = myval

    End If

    End Function 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T21:06:20.090

```
Function Res(myVal as long) As Long
    Res = myVal * 10 ^ ( 6 - Len(Cstr(myVal)) )
End Function 
```

注意 - 这仍然存在与原始方法相同的问题：

如果 myVal 为 9999999（7 位），则 myVal/10 为 999999.9，Clng(999999.9) 为 10000000（仍为 7 位）

# java - 用户单击菜单项后如何保持 SWT 菜单打开？

> ID：12288028
> 
> 赞同：4
> 
> 时间：2012-09-05T19:00:03.243
> 
> 标签：java, swt, eclipse-rcp, rcp

我有一个带有复选框菜单项菜单的 Eclipse RCP / SWT 应用程序。

我希望能够在单击其他地方关闭菜单之前选中/取消选中多个项目。但是，默认的 SWT 行为是单击后关闭菜单。

我已经实现了以下非常破解的解决方案，它可以工作，但肯定不优雅，可能无法在所有平台或所有情况下正常工作。因此，如果存在一种更简单的技术，我非常感兴趣。

以下代码应立即在 eclipse 中编译和运行（抱歉，它是我可以创建的最短的自包含示例）：

```
import org.eclipse.jface.action.Action;
import org.eclipse.jface.action.IMenuListener2;
import org.eclipse.jface.action.IMenuManager;
import org.eclipse.jface.action.MenuManager;
import org.eclipse.swt.SWT;
import org.eclipse.swt.graphics.Point;
import org.eclipse.swt.widgets.Control;
import org.eclipse.swt.widgets.Display;
import org.eclipse.swt.widgets.Event;
import org.eclipse.swt.widgets.Listener;
import org.eclipse.swt.widgets.Menu;
import org.eclipse.swt.widgets.Shell;

public class MenuTest
{
    public static void main( String[] args )
    {
        // create a SWT Display and Shell
        final Display display = new Display( );
        Shell shell = new Shell( display );
        shell.setText( "Menu Example" );

        // create a jface MenuManager and Menu
        MenuManager popupMenu = new MenuManager( );
        Menu menu = popupMenu.createContextMenu( shell );
        shell.setMenu( menu );

        // create a custom listener class
        final PopupListener listener = new PopupListener( shell, menu );

        // attach the listener to the Manager, Menu, and Shell (yuck!)
        popupMenu.addMenuListener( listener );
        menu.addListener( SWT.Show, listener );
        shell.addListener( SWT.MouseDown, listener );

        // add an item to the menu
        popupMenu.add( new Action( "Test", Action.AS_CHECK_BOX )
        {
            @Override
            public void run( )
            {
                System.out.println( "Test checked: " + isChecked( ) );

                listener.keepMenuVisible( );
            }
        } );

        // show the SWT shell
        shell.setSize( 800, 800 );
        shell.setLocation( 0, 0 );
        shell.open( );
        shell.moveAbove( null );

        while ( !shell.isDisposed( ) )
            if ( !display.readAndDispatch( ) ) display.sleep( );

        return;
    }

    public static class PopupListener implements Listener, IMenuListener2 
    {
        Menu menu;
        Control control;
        Point point;

        public PopupListener( Control control, Menu menu )
        {
            this.control = control;
            this.menu = menu;
        }

        @Override
        public void handleEvent( Event event )
        {
            // when SWT.Show events are received, make the Menu visible
            // (we'll programmatically create such events)
            if ( event.type == SWT.Show )
            {
                menu.setVisible( true );
            }
            // when the mouse is clicked, map the position from Shell
            // coordinates to Display coordinates and save the result
            // this is necessary because there appears to be no way
            // to ask the Menu what its current position is
            else if ( event.type == SWT.MouseDown )
            {   
                point = Display.getDefault( ).map( control, null, event.x, event.y );
            }
        }

        @Override
        public void menuAboutToShow( IMenuManager manager )
        {
            // if we have a saved point, use it to set the menu location
            if ( point != null )
            {
                menu.setLocation( point.x, point.y );
            }
        }

        @Override
        public void menuAboutToHide( IMenuManager manager )
        {
            // do nothing
        }

        // whenever the checkbox action is pressed, the menu closes
        // we run this to reopen the menu
        public void keepMenuVisible( )
        {
            Display.getDefault( ).asyncExec( new Runnable( )
            {
                @Override
                public void run( )
                {
                    Event event = new Event( );
                    event.type = SWT.Show;
                    event.button = 3;

                    menu.notifyListeners( SWT.Show, event );
                    if ( point != null )
                    {
                        menu.setLocation( point.x, point.y );
                    }
                }
            } );
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-06T04:02:00.747

我在 Win7 32bit 和 eclipse 4.2 上尝试了你的代码。不幸的是，它出现了问题并且闪烁。无论如何，这是另一个变化。在我看来，您必须至少使用两个侦听器，一个用于您的菜单项，无论如何都需要，另一个用于获取菜单的坐标：

```
import org.eclipse.swt.SWT;
import org.eclipse.swt.events.MenuDetectEvent;
import org.eclipse.swt.events.MenuDetectListener;
import org.eclipse.swt.events.SelectionAdapter;
import org.eclipse.swt.events.SelectionEvent;
import org.eclipse.swt.graphics.Point;
import org.eclipse.swt.layout.GridLayout;
import org.eclipse.swt.widgets.Display;
import org.eclipse.swt.widgets.Menu;
import org.eclipse.swt.widgets.MenuItem;
import org.eclipse.swt.widgets.Shell;

public class TestMenu 
{
    private static Point point;

    public static void main(String[] args) 
    {
        Display display = new Display();
        Shell shell = new Shell(display);
        shell.setLayout(new GridLayout(1, false));

        final Menu menu = new Menu(shell);
        MenuItem item = new MenuItem(menu, SWT.CHECK);
        item.setText("Check 1");
        item.addSelectionListener(new SelectionAdapter() {
            public void widgetSelected(SelectionEvent e) 
            {
                if(point == null) 
                    return;
                menu.setLocation(point);
                menu.setVisible(true);
            }
        });

        shell.addMenuDetectListener(new MenuDetectListener() {
            public void menuDetected(MenuDetectEvent e) {
                point = new Point(e.x, e.y);
            }
        });

        shell.setMenu(menu);

        shell.open();
        while (!shell.isDisposed()) {
            if (!display.readAndDispatch())
                display.sleep();
        }
        display.dispose();
    }
} 
```

* * *

***更新***

感谢@Baz，请参阅下面的评论。

> 使用 eclipse 3.6.2 在 Linux 32bit 上尝试过这个，不幸的是它似乎不起作用。

***更新 2（通过 ulmangt）***

以下是对您的解决方案的修改，适用于 64 位 Windows 7 和 64 位 Ubuntu Linux。

该类`org.eclipse.swt.widgets.Menu`有一个包保护字段，用于确定菜单位置是否已设置。如果没有，至少在 Linux 上，菜单会出现在鼠标单击下。

因此，获得正确的行为需要使用反射将此布尔字段重置为 false。或者，菜单可能会被处理和重新创建。

最后，Linux 似乎喜欢`menu.setLocation( point )`并由块组成`menu.setVisible( true )`。`asyncExec`

```
import java.lang.reflect.Field;

import org.eclipse.swt.SWT;
import org.eclipse.swt.events.MenuDetectEvent;
import org.eclipse.swt.events.MenuDetectListener;
import org.eclipse.swt.events.MenuEvent;
import org.eclipse.swt.events.MenuListener;
import org.eclipse.swt.events.SelectionAdapter;
import org.eclipse.swt.events.SelectionEvent;
import org.eclipse.swt.graphics.Point;
import org.eclipse.swt.layout.GridLayout;
import org.eclipse.swt.widgets.Display;
import org.eclipse.swt.widgets.Menu;
import org.eclipse.swt.widgets.MenuItem;
import org.eclipse.swt.widgets.Shell;

public class MenuTest
{
    private static Point point;

    public static void main( String[] args )
    {
        Display display = new Display( );
        final Shell shell = new Shell( display );
        shell.setLayout( new GridLayout( 1, false ) );

        final Menu menu = new Menu( shell );
        MenuItem item = new MenuItem( menu, SWT.CHECK );
        item.setText( "Check 1" );
        item.addSelectionListener( new SelectionAdapter( )
        {
            public void widgetSelected( final SelectionEvent e )
            {
                if ( point == null ) return;

                Display.getDefault( ).asyncExec( new Runnable( )
                {
                    @Override
                    public void run( )
                    {
                        menu.setLocation( point );
                        menu.setVisible( true );
                    }
                } );
            }
        } );

        shell.addMenuDetectListener( new MenuDetectListener( )
        {
            public void menuDetected( MenuDetectEvent e )
            {
                point = new Point( e.x, e.y );
            }
        } );

        menu.addMenuListener( new MenuListener( )
        {
            @Override
            public void menuHidden( MenuEvent event )
            {
                try
                {
                    Field field = Menu.class.getDeclaredField( "hasLocation" );
                    field.setAccessible( true );
                    field.set( menu, false );
                }
                catch ( Exception e )
                {
                    e.printStackTrace();
                }
            }

            @Override
            public void menuShown( MenuEvent event )
            {
            }
        });

        shell.setMenu( menu );

        shell.open( );
        while ( !shell.isDisposed( ) )
        {
            if ( !display.readAndDispatch( ) ) display.sleep( );
        }
        display.dispose( );
    }
} 
```

# excel - VLOOKUP 找不到数据的问题

> ID：12288029
> 
> 赞同：1
> 
> 时间：2012-09-05T19:00:10.697
> 
> 标签：excel, csv, vlookup

Col A 有`ItemID`Col B 有`Model_Num`Col C 有很长的列表`Model_Num`。在 Col DI 中要查找`Model_Num`Col C 的`ItemID`

```
item_id (colA)        model_num (colB)   to match (colC)  new data (colD)
--------              ----------         ---------        ---------
870834                FD021              KPA8A            14667122
16595156              S3TA03B            BW01B            #N/A
10752514              FD1424B            GM1500B          #N/A
10756167              SU03B              TA021            #N/A
14667130              KDAD               FD021            870834
14667122              KPA8A              FD021            870834 
```

在新数据列（colD）中，我使用了以下公式：

```
=VLOOKUP(C1,$A$1:$B$114,2,FALSE) 
```

不过，它正在回归`#N/A`一切。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T19:24:34.033

您的 VLOOKUP 公式和/或按列组织数据的方式有误。VLOOKUP 不能用于查找 VLOOKUP 表中查找值左侧的值 - 您必须使用 INDEX/MATCH 函数来执行此操作 - 或者您可以这样做。

1）您可以将列 A（item_iD）剪切并插入到当前列 B（model_num）的右侧。然后适当调整您的 VLOOKUP 公式。（所以基本上你的 item_id 和 model_num 列目前是向后的）。

如果您想“按原样”保持列顺序，那么您将需要使用我当然可以提供的 INDEX/MATCH 函数：

```
=INDEX($A$1:$B$114,MATCH(C1,$B$1:$B$114,0),1) 
```

保持数据不变并将其放在顶部单元格列 D 中，然后自动填充。它应该给你你想要的。

祝你好运。

# c# - 检查日期是否与 linq to ef 相等

> ID：12288034
> 
> 赞同：1
> 
> 时间：2012-09-05T19:00:31.773
> 
> 标签：c#, linq, entity-framework

我正在尝试检查 a`DateTime`是否已经在我的数据库中。

我已经分解了下面的代码，以便更好地了解正在发生的事情，但是尽管我尽了最大努力，但 dateChecks 将始终返回一个空列表。

```
 var MyDate = DateTime.Now;

    foreach (var milestone in mtMilestone.Milestones)
    {

        var checkIfAlreadyPulled = _ipdb.JsonDataReleases.
            Where(x => x.ReleaseId == mtMilestone.ReleaseId).ToList();

        var dateChecks = checkIfAlreadyPulled.
            Where(x => EntityFunctions.Equals(x.LastUpdated, MyDate)).ToList();

        if (!dateChecks.Any())
        {
            /* do stuff what this does it it makes a new entry into the JsonDataReleases 
            db using MyDate as the new LastUpdated value. */ 
        }

        /* Does more unrelated stuff... */

    } 
```

编辑：所以我想通了！

事实证明，当 DateTime.Now 被保存为 sql 数据库中的 LastUpdated 值时，它会切断毫秒。

```
 var now = DateTime.Now;
        var MyDate= new DateTime(now.Year, now.Month, now.Day, now.Hour, now.Minute, now.Second); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T19:43:23.877

如果您的`LastUpdated`字段存储日期和时间，则您的`Where`子句将仅选择与您的`MyDate`. 如果您只是比较日期，则需要比较 `.Date`每一侧的日期：

```
var dateChecks = checkIfAlreadyPulled.
    Where(x => x.LastUpdated.Date == MyDate.Date).ToList(); 
```

# android - 如何将字符串值插入到对话框消息中？

> ID：12288038
> 
> 赞同：1
> 
> 时间：2012-09-05T19:00:35.940
> 
> 标签：android, database, android-edittext

我有一个editText和一个按钮，如果我输入“abc”并点击按钮，它会将值存储在我的数据库中，并会打开一个对话框说它已成功插入，但在对话框中我还想显示插入的内容，所以代码如下：

```
EditText texto = (EditText) findViewById(R.id.etAdd);
final String resultado = texto.getText().toString();

Button add = (Button) findViewById(R.id.bAdd);
add.setOnClickListener(new OnClickListener() {

    public void onClick(View v) {
        // TODO Auto-generated method stub
        try {
            //Abre ou Cria uma database com nome de: "dbtest.db"
            db = openOrCreateDatabase("dbtest.db", Context.MODE_PRIVATE, null);

            try {
                db.insert("usuarioorigem", resultado, null);
                ShowMessage("Mensagens","Inserido" +resultado+ "com sucesso!");
            } finally {

            }
        } finally {

        }
    }
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T19:04:29.637

您的 ShowMessage 函数可能如下所示：

```
private void ShowMessage(String msg){
    Toast.makeText(this, msg, Toast.LENGTH_LONG).show();
} 
```

[有关Toasts](http://developer.android.com/guide/topics/ui/notifiers/toasts.html)的更多信息，请参见此处。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-05T19:07:33.847

关键是检查[插入操作是否成功](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#insert%28java.lang.String,%20java.lang.String,%20android.content.ContentValues%29)

```
 EditText texto = (EditText) findViewById(R.id.etAdd);

            Button add = (Button) findViewById(R.id.bAdd);
            add.setOnClickListener(new OnClickListener() {

                public void onClick(View v) {
                    // TODO Auto-generated method stub
                    try{
                        //Abre ou Cria uma database com nome de: "dbtest.db"
                        db = openOrCreateDatabase("dbtest.db", Context.MODE_PRIVATE, null);
                        String resultado = texto.getText().toString();

                        try{
                            long result = db.insert("usuarioorigem", resultado, null);
                            if(result == -1){
                               ShowMessage("Error in Insert"); //sorry for english here, may be u can use inserido
                            }
                            else{
                               ShowMessage("Mensagens Inserido" +resultado+ "com sucesso!");
                            }
                        }finally{

                        }
                }finally{

                }
                }
            });

    private void ShowMessage(String msg){
        Toast.makeText(this, msg, Toast.LENGTH_LONG).show();
    } 
```

# sql - 将 SQL Server 数据库复制到另一个数据库

> ID：12288043
> 
> 赞同：1
> 
> 时间：2012-09-05T19:00:49.870
> 
> 标签：sql, sql-server, sql-server-2005, backup

我在 SQL Server 2005 中有一个名为 MyStaging 的数据库，我创建了一个名为 MyStaging_bk 的空白数据库。我去了 Backup MyStaging，然后尝试恢复到 MyStaging_bk。但它说我无法恢复，因为备份集不同。

如何复制数据库并且它们在同一数据库服务器上？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T19:11:08.793

我正在考虑您可以使用高级用户登录 sql server。

```
-- go for master
use master

-- backup the old database
backup database olddatabasename
to disk = 'c:\backup.bak'

-- create a new database
create database newdatabasename
on
(
    name = newdatabasenamedata,
    filename = 'c:\newdatabasenamedata.mdf',
    size = 500mb,
    maxsize = unlimited,
    filegrowth = 25mb
)
log on
(
    name = newdatabasenamelog,
    filename = 'c:\newdatabasenamelog.ldf',
    size = 5mb,
    filegrowth = 5mb
)

-- put it in single user mode
alter database newdatabasename
set single_user
with rollback immediate

-- get the backup logical names and write it down
restore filelistonly
from disk = 'c:\backup.bak'

-- restore the database from the backup using the logical names
restore database newdatabasename
from disk = 'c:\backup.bak'
with
    move 'olddatabasenamelogicalnamedata' to 'c:\newdatabasenamedata.mdf',
    move 'olddatabasenamelogicalnamelog' to 'c:\newdatabasenamelog.ldf',
    replace

-- rename the logical names if you want (do it =p)
alter database newdatabasename
modify file
(
    name = 'olddatabasenamelogicalnamedata',
    newname = 'newdatabasenamedata'
)

alter database newdatabasename
modify file
(
    name = 'olddatabasenamelogicalnamelog',
    newname = 'newdatabasenamelog'
) 
```

我很确定从备份中恢复数据库会自动将其置于多用户中，但是：

```
alter database newdatabasename
set multi_user 
```

newdatabase 没有添加任何用户。所以：

```
use newdatabasename    

create user someuser from login anexistentloginname

sp_addrolemember 'db_owner', 'someuser'
sp_addrolemember 'db_datareader', 'someuser' 
sp_addrolemember 'db_datawriter', 'someuser' 
```

**更新1：**

您必须单独运行每个块或`go`在每个块中添加关键字。

**更新2：**

我在这里不好，新数据库将从备份数据库中获取所有用户。

# caching - 具有可排序和分页数据的 memcache 策略

> ID：12288053
> 
> 赞同：2
> 
> 时间：2012-09-05T19:01:34.300
> 
> 标签：caching, memcached

我们目前有一个包含大量评论（带有“upvote”分数）的网站，这些评论总是按 id 排序而不是分页。

我们想添加不同的方式来对评论进行排序（最新、最高分等）以及可以自定义的分页（每页 10、25、100）。

现在，缓存对我们来说很容易。我们可以将原始 HTML 缓存起来，然后为对象吐出注释。如果我们缓存 per_page 和 sort_method 的每一种可能的组合，我们就可以实现这一点，但是命中率会低得多，因为它们的特异性要高得多。

我们目前正试图为此想出一个好的策略，但我们有点难过。

**额外信息：**

*   我们使用 RDS 服务器和用于内存缓存的 ElastiCache 对 AWS 上的多个 EC2 实例进行负载平衡。
*   如果其他可行的技术在我们的基础设施中运行良好，我们愿意接受其他可行的技术来实现我们的目标。（例如。redis）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T08:05:11.593

我不认为只有一个答案，因为很大程度上取决于您网站的实际数量，例如每个 id 的最大评论数。

但是，我不会缓存 HTML 页面，而是缓存构建页面所需的数据，可能作为 SQL 结果集。对于每个排序顺序，我都会有一个缓存条目，其中包含所有评论，然后过滤掉你不需要的那些。如果这看起来太大，那么您也可以将其划分为 N 条评论块。

请记住，您将需要一些强大的方法来处理更新，因此知道要删除哪些键很重要，这就是为什么我喜欢上面所有评论的解决方案，但正如我所说，这实际上取决于您的数字。

# html - 表单帖子上的 Web 查询

> ID：12288056
> 
> 赞同：0
> 
> 时间：2012-09-05T19:01:43.380
> 
> 标签：html, forms, excel

因此，我在电子表格中有很多数据，我需要取一个值（一个数字）并将其输入到供应商给我的订购单中的 Web 表单中。这样我就可以将它添加到我的订单中。但是，我有数千个不同的参考编号，需要弄清楚最好的方法是什么。它们是脚本、vbs 还是可以从 csv 文件中提取这些值的代码，将它们运行到表单中，返回第一组值，然后返回表单并在 EOF 之前再次执行此操作？

这是表格的样子：

```
<div align=center>
Please enter an item number: <br>
<input type="text" name="search_number" value="" size="10" maxlength="8">
<input TYPE="SUBMIT" VALUE="Go" NAME="Action"> 
```

这是返回内容的一部分....或者我真正关心保留/解析的部分

```
<div id="grids">
<table cellspacing=0 cellpadding=0 width=100% border=0><tr height=30 bgcolor=#FFD700>                             
<td>  
<font face=arial size=-1 color=000000>&nbsp;<b>
Style #5095 - APPLAUSE-LEOTARD (Page 5D)
</b></font></td></tr><tr height=5><td></td></tr></table>
<table> 
<tr><th></th><th>SC</th><th>INT</th><th>MC</th><th>LC</th><th>XLC</th><tr><td></td><td               
align=center><small>$27.95</small></td><td align=center><small>$27.95</small></td><td    
align=center><small>$27.95</small></td><td align=center><small>$27.95</small></td><td   
align=center><small>$31.95</small></td></tr>
<tr><td><small> (001)</small></td>
<td><input type="text" name="stq-5095-2-001" value ="" size="4" maxlength="4" 
onfocus="this.select()"></td>
<td ><input type="text" name="stq-5095-3-001" value ="" size="4" maxlength="4"   
onfocus="this.select()"></td>
<td ><input type="text" name="stq-5095-4-001" value ="" size="4" maxlength="4"    
onfocus="this.select()"></td>
<td ><input type="text" name="stq-5095-5-001" value ="" size="4" maxlength="4"    
onfocus="this.select()"></td>
<td ><input type="text" name="stq-5095-6-001" value ="" size="4" maxlength="4"  
onfocus="this.select()"></td>
</tr>
</table> 
```

最后，我想从每个返回值中看到的是样式编号（我搜索过的），它的大小......以及每个到电子表格的价格。这是它现在返回的内容。必须进行 photobucket 共享以便我可以发布此 bc 堆栈溢出要求我在发布图像之前拥有 10 的声誉。

```
http://s1159.photobucket.com/albums/p622/dcolnar/ 
```

我只需要价值和价格。它还会返回与样式#5095F、样式#5095S 密切匹配的结果，但是对于这些我在电子表格中有自己的行。所以搜索无论如何都会返回它们。所以不需要在这里复制这些值。

获得该信息后，我需要返回上一页（我只是在浏览器上使用返回键）并在表单中提交下一个值。（需要删除那里的值......或取决于你如何做......只需使用新值提交）

如果您能够给我代码或给我有关获得这些价值的最佳方式的信息，那就太好了。我真的希望我的供应商能给我发一份他们的数据库表的副本……这样会容易得多。我必须登录才能使用这个工具，他们已经提供了，但是一旦登录，我就不必重新登录来进行多次搜索。仅当我关闭浏览器（结束会话）时，我才被要求重新提交登录凭据

谢谢你提供的所有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T22:39:56.007

我会使用 python 来自动化这个过程：

1.  使用 python 模块`openpyxl`从电子表格中提取数据。
2.  使用 python 模块`Mechanize`自动完成网页导航以及表单完成和提交。
3.  使用 python 模块`BeautifulSoup`解析返回的 HTML 并获取您需要的数据。

其他选择：

1.  Perl 具有与上述 python 模块类似的模块。
2.  电源外壳
3.  其他点网语言

# django - Tastypie：为什么在做 PUT 时响应“pk”字段？

> ID：12288057
> 
> 赞同：1
> 
> 时间：2012-09-05T19:01:45.720
> 
> 标签：django, tastypie

我有这个模型资源：

```
class ProjectResource(ModelResource):
    id = fields.IntegerField('id', readonly=True)

    def alter_list_data_to_serialize(self, request, data):
        return data['objects']

    class Meta:
        queryset = Project.objects.all()
        list_allowed_methods = ['get', 'post']
        detail_allowed_methods = ['get', 'post', 'put', 'delete']
        resource_name = 'projects'
        include_resource_uri = False
        #fields = ['id', 'title', 'date_created', 'date_modified']
        excludes = []
        always_return_data = True

        authorization = Authorization() 
```

当我做 GET /projects/1 或 POST /projects 响应是：

```
'{
"date_created": "2012-08-29T16:47:55.417000+00:00", 
"date_modified": "2012-08-29T16:47:55.417000+00:00", 
"id": 1, 
"title": "1st Testing Project"
}' 
```

但是当我做 PUT /projects 响应是：

```
'{
"date_created": "2012-08-29T16:47:55.417000+00:00", 
"date_modified": "2012-09-05T18:58:39.746336+00:00", 
"id": 1, 
"pk": "1", 
"title": "EDITED project"
}' 
```

所以有额外的“pk”字段。它是如何到达那里的？我该如何摆脱它？它仅在执行 PUT 时存在。有任何想法吗？谢谢。

# html - Bootstrap/CSS div 放置问题

> ID：12288061
> 
> 赞同：0
> 
> 时间：2012-09-05T19:02:00.527
> 
> 标签：html, css, twitter-bootstrap

我在 Twitter Bootstrap 脚手架页面的 .well 中放置一些 div 时遇到了一些麻烦。我一直在研究它，但我的 CSS 知识有限，我主要是自学。

[http://jsfiddle.net/hEvwR/](http://jsfiddle.net/hEvwR/)

它应该看起来像这样：

![模拟](../Images/afc5c27efa0a9458926134dcbd283183.png)

这最初是在 Jade 中，但我将它转换为问题。我也喜欢此页面上有关最佳实践的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T19:35:59.913

见[http://jsfiddle.net/hEvwR/2/](http://jsfiddle.net/hEvwR/2/)

改变

```
 <div class="span5">
      <p><strong>Enter Your Mobile Phone Number</strong>
      </p>
      <input id="features-demo-number" type="text" placeholder="555-123-4567" style="text-align:center;padding:10px 12px;font-size:16px;margin-top:10px;" class="input-medium"/>
      <div class="pull-left">
        <p><strong>(Optional) Enter a MLS identification number for a more personalized demo</strong>
        </p>
        <input id="features-demo-mls-number" type="text" placeholder="123456789" style="text-align:center;padding:10px 12px;font-size:16px;margin-top:10px;" class="input-medium"/><br/>
        <button id="features-demo-customer" class="btn btn-primary btn-large">Send <strong>Buyer</strong> Notification <i class="icon-share-alt icon-white"></i>
        </button>
      </div>
      <div class="pull-right">
        <video id="video-preview" controls="controls" preload="auto" poster="images/poster.png" width="250" height="140" data-setup="{}" class="video-js vjs-default-skin">
          <source src="https://s3.amazonaws.com/textoad.com/assets/textoad.mp4" type="video/mp4">
          </source>
        </video><a href="/signup" style="margin-top:20px;margin-left:0px;font-size:18px;padding-left:20px;padding-right:20px;text-align:center;" class="btn btn-large btn-primary">Sign Up Now</a>
      </div>
    </div> 
```

至

```
 <div class="span5">
      <div class="pull-left">
        <p><strong>Enter Your Mobile Phone Number</strong></p>
        <input id="features-demo-number" type="text" placeholder="555-123-4567" style="text-align:center;padding:10px 12px;font-size:16px;margin-top:10px;" class="input-medium"/>
        <p><strong>(Optional) Enter a MLS identification number for a more personalized demo</strong>
        </p>
        <input id="features-demo-mls-number" type="text" placeholder="123456789" style="text-align:center;padding:10px 12px;font-size:16px;margin-top:10px;" class="input-medium"/><br/>
        <button id="features-demo-customer" class="btn btn-primary btn-large">Send <strong>Buyer</strong> Notification <i class="icon-share-alt icon-white"></i>
        </button>
      </div>
      <div class="pull-right">
        <video id="video-preview" controls="controls" preload="auto" poster="images/poster.png" height="140" data-setup="{}" class="video-js vjs-default-skin">
          <source src="https://s3.amazonaws.com/textoad.com/assets/textoad.mp4" type="video/mp4">
          </source>
        </video><a href="/signup" style="margin-top:20px;margin-left:0px;font-size:18px;padding-left:20px;padding-right:20px;text-align:center;" class="btn btn-large btn-primary">Sign Up Now</a>
      </div>
    </div> 
```

并添加

```
.span5{width:auto;}
#video-preview{width:210px!important;}
.span5>.pull-left{width:210px} 
```

# sqlclr - 使用 PERMISSION_SET = unsafe 创建程序集会引发异常

> ID：12288062
> 
> 赞同：1
> 
> 时间：2012-09-05T19:02:00.320
> 
> 标签：sqlclr

```
CREATE ASSEMBLY [RA.VantagePoint.Clr.Core]
FROM 0x[Assembly binary]
AUTHORIZATION [dbo]
WITH PERMISSION_SET = UNSAFE; 
```

dbo 是 syadmin 和所有者，我收到以下错误：无法获取有关 Windows NT 组/用户 XXXX 的信息（用户是 DB dbo）

这是一个 sql 2008R2 CS 命名实例我将数据库 TrustWorthy 设置为 ON

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T13:50:38.077

如果这是一个长期数据库（即存在一段时间的数据库），则此错误的一种可能性是“dbo”数据库身份最初映射到的 Windows 域帐户不再存在。您可以通过在 sys.databases 中运行以下命令来确定这是否是问题所在：

```
SELECT name, suser_sname(owner_sid) FROM sys.databases 
```

如果第二列为空，则描述的问题可能就在眼前。

这个概念的信息来自[MSDN 论坛上的这篇文章。](http://social.msdn.microsoft.com/Forums/en-US/sqlservicebroker/thread/28699c94-4d1b-43f2-bcfb-a95152ca226b "无法获取所有权信息...问题...")

# https - 在 WebDriver 中使用 HTTP 下载文件

> ID：12288066
> 
> 赞同：5
> 
> 时间：2012-09-05T19:02:06.233
> 
> 标签：https, webdriver, watir-webdriver

我正在尝试使用 WebDriver 浏览 https 站点并使用 WebDriver 下载文件。当我这样做时，弹出文件下载对话框。

```
WebDriver driver = new ChromeDriver();
driver.get("http://xxx/file1.txt"); 
```

我想知道有没有什么方法可以在 WebDriver 中调用一个方法来使用常规 https 请求下载文件而不模拟点击？

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-05T19:33:56.513

没有，至少没有任何方式适用于所有浏览器。您可能能够配置某些浏览器（Firefox 和 Chrome）以将文件下载到指定位置而无需提示。但是，对于您要询问的内容，您根本不需要 Selenium。任何程序化 HTTP 客户端都可以。在 Java 中，我建议查看 Apache 的 HttpClient；在 .NET 中使用 HttpWebRequest 将完成工作。请注意，如果您从中下载文件的站点需要身份验证，您可能需要在 HTTP 请求中指定自定义标头。

作为旁注，您可能需要重新评估为什么您认为需要测试下载文件，如果它不像在浏览器之外执行 HTTP 请求那么简单。[本文](http://ardesco.lazerycode.com/index.php/2012/07/how-to-download-files-with-selenium-and-why-you-shouldnt/)非常详细地讨论了这个问题，并提供了一个非常合理的论点，为什么测试下载文件是有问题的，而且通常是不必要的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-06T08:35:36.830

是的你可以。您需要设置自定义 Chromedriver 配置文件：

```
profile = Selenium::WebDriver::Chrome::Profile.new
profile['download.prompt_for_download'] = false
profile['download.default_directory'] = download_directory 
```

它不会提示任何对话框。关于如何设置下载目录并验证文件是否具有任何给定大小，我有一个更详细的[答案](https://stackoverflow.com/questions/8812708/watir-webdriver-wait-for-download-to-complete/10894905#10894905)。

可以在此处找到其他 chromedriver 开关：http: [//peter.sh/experiments/chromium-command-line-switches/](http://peter.sh/experiments/chromium-command-line-switches/)

# drupal - 如何在 Drupal 7 中以编程方式渲染 Openlayers 地图

> ID：12288068
> 
> 赞同：1
> 
> 时间：2012-09-05T19:02:16.390
> 
> 标签：drupal, drupal-7, openlayers

我的搜索几乎一无所获。我能找到的所有文档都是针对 Drupal 6 版本的。我需要弄清楚如何以编程方式渲染 Openlayers 地图（`openlayers_render_map`我假设使用该函数）。最终，我想使用表单 API 创建一个地图，以在与搜索匹配的多个位置之间进行选择，以便我可以获得规范地址和描述确切位置的 WKT 字符串。

这是一个相当开放的问题，我真正想要的是一个链接到一些写得很好的文档。但是，当我得出不存在这种东西的结论时，一个更具体的问题是：**如何在 PHP 代码中设计 Openlayers 地图并将其呈现在任意模板中？**它*不会*显示存储在节点中的数据，甚至不会显示任何持久的数据，因此使用视图*不是*一个选项。此外，**我如何开始编写与地图交互的 Javascript 以选择某些位置或检索当前选择的位置？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:24:39.133

渲染地图：

```
$map = openlayers_map_load('my_map');
$output = openlayers_render_map($map->data,$map->name); 
```

在 js 中与地图交互：

```
var ol_map = $('.openlayers-container .openlayers-map').data('openlayers'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T17:01:59.037

您确定不能使用视图吗？请耐心等待，因为我提出了一个疯狂的想法：

制作一个地图视图，其中地图本身接受 lat/lng 作为参数（或您选择的其他地理值），然后制作一个根本不包含任何有意义的地图数据视图。把他们联系起来。然后直接从您的地理编码器发送您的地图页面参数。

我正在做类似的事情，但成功有限，但感觉应该是可能的......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-03T03:41:06.357

```
$map = openlayers_map_load('your_map');
$map->data['layer_activated']['your_layer'] = 'your_layer';
$map->data['layers']['your_layer'] = 'your_layer';
$map->data['behaviors']['openlayers_behavior_zoomtolayer']['zoomtolayer']['your_layer'] = 'your_layer';    
$output = openlayers_render_map($map->data,$map->name); 
```

# jquery - 用于调整图像大小的 Jquery 代码不起作用

> ID：12288071
> 
> 赞同：1
> 
> 时间：2012-09-05T19:02:22.427
> 
> 标签：jquery

我是一个 jquery 新手，我有这个项目的最后期限，所以请不要笑。

我正在尝试使此 jquery 代码工作：

```
function resize_images(){
   var def = $(".defx img").height(); // get the desired height

   $(".model").each(function() { // loop through all images inside model divs
       var images = $(this).find("img"); // find the image
       var height = images.height(); // find the image height
       if (height > def){  images.css("height: "+def+"px !important"); } // if the image height is larger than the default add a css rule
   });  
} 
```

任何想法为什么它不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T19:09:20.600

你只检查第一个的高度`img`。循环遍历图像本身：

```
function resize_images() {
    var maxHeight = $(".defx img").height();
    $(".model img").each(function() {
        var $this = $(this);
        if ( $this.height() > maxHeight ) {
            $this.css('height', maxHeight);
        }
    });
} 
```

# c - 比较使用 fgets 和 fscanf 获取的字符串

> ID：12288076
> 
> 赞同：0
> 
> 时间：2012-09-05T19:02:49.947
> 
> 标签：c, string, unix, fgets, scanf

我需要将 fgets 从标准输入获取的字符串与 fscanf 从文件获取的另一个字符串进行比较（并使用 fprintf 写入文件）。我必须使用这两个函数来读取标准输入和文件。我怎么能这样做？因为我看到 fgets 也存储“\0”字节，但 fscanf 没有。

这是代码：

```
#include<stdio.h>
#include<stdlib.h>
#include<string.h>

typedef struct asd {
    char a[20];
    char b[20];
} struttura;

void stampa_file() {
struttura *tmp = NULL;
struttura *letto = NULL;
FILE *file;

tmp = (struttura *)malloc(sizeof(struttura));
letto = (struttura *)malloc(sizeof(struttura));
file = fopen("nuovoFile", "r");
printf("compare:\n");\
fgets(letto->a, sizeof(letto->a), stdin);
fgets(letto->b, sizeof(letto->b), stdin);
while(!feof(file)) {
    fscanf(file, "%s %s\n", tmp->a, tmp->b);
    printf("a: %s, b: %s\n", tmp->a, tmp->b);
    if(strcmp(letto->a, tmp->a) == 0 && strcmp(letto->b, tmp->b)) {
        printf("find matching\n");
    }
}
free(tmp);
free(letto);
}

int main() {
struttura *s = NULL;
FILE *file;

s = (struttura *)malloc(sizeof(struttura));

file = fopen("nuovoFile", "a+");
printf("");
fgets(s->a, sizeof(s->a), stdin);
printf("");
fgets(s->b, sizeof(s->b), stdin);
fprintf(file, "%s%s\n", s->a, s->b);
fclose(file);
stampa_file();

free(s);
return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T21:54:52.233

这里有很多潜在问题，具体取决于您要执行的操作

*   `fgets`读取一行（直到并包括换行符），而`fscanf(.."%s"..)`读取由空格分隔的标记。完全不是一回事。

*   `fscanf(.."%s"..)`不检查您给它写入的缓冲区的边界。您确实希望`fscanf(.."%19s"..)`确保它不会将超过 20 个字节（包括 NUL 终止符）写入您的 20 字节缓冲区。

*   `while(!feof(fp))`几乎总是错误的。 `feof`不会告诉您是否在文件末尾，它会告诉您是否尝试读取文件末尾。因此，如果您刚刚读到文件末尾并且还没有读过去，`feof`将返回 false，但下一次读取将失败。

*   你真的想检查返回值，`fscanf`以确保它读取了你想要它读取的内容（并且实际上向输出缓冲区写入了一些内容。）结合上面的内容，这意味着你可能希望你的循环类似于：

    ```
    while (fscanf(fp, "%19s%19s", tmp->a, tmp->b) == 2) {
            : 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T19:08:10.920

> 我怎么能这样做？因为我看到 fgets 也存储“\0”字节，但 fscanf 没有。

我刚刚**阅读了 fscanf 的文档**并对其进行了测试，并且效果很好：

```
#include <stdio.h>

int main()
{
    char str[100] = { 1 }; // intentionally initialized to nonzero junk
    fscanf(stdin, "%s", str);
    if (strcmp(str, "H2CO3") == 0)
        printf("This is me\n");
    else
        printf("This is not me\n");
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T19:39:12.820

scanf 或 fscanf 与 %s 一起传递时会终止换行符或空格字符上的字符串。fgets 在哪里等到 \n。

因此，如果你打电话

```
fscanf(stdin, "%s", str);

vs

fgets(str); 
```

并且文件包含“你好”

fscanf 将仅包含“Hello”，因为 fgets 将返回整个字符串

# python - 使用 PIL 在 Django 中上传、裁剪和保存图像

> ID：12288077
> 
> 赞同：2
> 
> 时间：2012-09-05T19:02:56.387
> 
> 标签：python, django, image, python-imaging-library, naming

我正在尝试在 django 中上传个人资料图片并使用 PIL 在服务器端对其进行裁剪。我编写了一个简单的函数，它将文件和裁剪区域作为参数，裁剪图像并返回它。

我遇到的问题是返回的对象没有文件名，因此 django 不知道如何保存它。这是来自 django 错误页面的描述（AttributeError(name) 是调用的错误）：

```
/Library/Python/2.6/site-packages/PIL/Image.py in __getattr__
        # numpy array interface support
        new = {}
        shape, typestr = _conv_type_shape(self)
        new['shape'] = shape
        new['typestr'] = typestr
        new['data'] = self.tostring()
        return new
    raise AttributeError(name) ...
##
# Returns a string containing pixel data.
#
# @param encoder_name What encoder to use.  The default is to
#    use the standard "raw" encoder.
▼ Local vars
Variable    Value
self        <PIL.Image.Image image mode=RGB size=300x300 at 0x101FCACF8> 
name    '_committed' 
```

您可以看到图像文件对象没有附加名称，就像直接从 django 上传时一样。我搜索了整个 PIL 文档和 django 文档，但没有找到任何可以保存文件名称的内容（例如，image.save("filename.jpg", "JPEG") 不起作用）。我想将文件保存在内存中，如果可能的话，不必处理写入磁盘。

如有必要，我可以附加额外的代码，但我认为/希望我只是错过了一些简单的 Python 代码。我知道有一些库可以让我更轻松，但现在我只是想了解使用 Python/django 处理图像的基础知识。有任何想法吗？谢谢！

# java - 如何使用@Query 注解构建查询？

> ID：12288078
> 
> 赞同：1
> 
> 时间：2012-09-05T19:02:57.560
> 
> 标签：java, mongodb, spring-data, spring-mongo

有什么方法可以使用 spring-data mongo @Query 注释来表示下面的查询。

```
db.users.find({userName: "titogeo"}, {requests: 1, _id:0}) 
```

控制台中的上述查询输出是

> 请求”：[{“谁”：“blahblahblah1”，
> “谁”：“blahblahblah2”，
> “什么”：“请求”，
> “何时”：ISODate（“2012-09-05T17：52：14.339Z”）}] }

我尝试了以下但没有奏效。

```
@Query("{userName: ?0}, {requests:1, _id:0}")
public Page<AddRequest> getAllFriendRequests(String userName, Pageable pageable); 
```

集合 users 具有 User 对象， requests 是一个列表，其中包含 AddRequest 对象。

当我执行上述方法时，我得到一个空白列表。任何帮助表示赞赏。

spring-data-mongo apis还有什么好的参考网站或书籍吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-05T20:49:36.253

由于您使用过滤器属性来限制返回的属性集（仅请求），因此您需要使用以下语法中的属性关键字：

```
@Query(value = "{ 'userName' : ?0 }", fields = "{ 'requests': 1, '_id': 0 }")
public Page<AddRequest> getAllFriendRequests(String userName, Pageable pageable); 
```

这是一个对 spring-data mongodb 有用的站点：http: [//static.springsource.org/spring-data/data-document/docs/current/reference/html/](http://static.springsource.org/spring-data/data-document/docs/current/reference/html/)

# php - PHP DomDocument - getAllChildrenByTagName

> ID：12288080
> 
> 赞同：0
> 
> 时间：2012-09-05T19:03:01.197
> 
> 标签：php, domdocument, children

PHP中是否有类似“getAllChildrenByTagName”的函数？

```
$dom = new DOMDocument();
$dom->loadXML('<p><a id="1">test 1</a><span><a id="2">test 2</a></span></p>');
foreach($dom->getElementsByTagName('a') AS $node)
    echo($node->textContent); 
```

在这里，我只想要“id = 1”的 a-Tag。可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T19:05:11.677

您可以使用 XPath 直接抓取您要查找的元素：

```
$dom = new DOMDocument();
$dom->loadXML('<p><a id="1">test 1</a><span><a id="2">test 2</a></span></p>');

$xpath = new DOMXpath( $dom);
$a = $xpath->query( '//a[@id="1"]')->item( 0);
echo $a->textContent; 
```

这[将打印](http://viper-7.com/sKYn3Y)：

```
test 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T19:11:15.300

最好在这里使用 XPath。看看下面的 PHP 代码。

```
$dom = new DOMDocument();
$dom->loadXML('<p><a id="1">test 1</a><span><a id="2">test 2</a></span></p>');
$xpath = new DOMXpath($dom);
$elements = $xpath->query("//a[@id='1']"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T19:05:09.753

不，不是 getElementsbyTagName。

更好地使用 XPath 查询，他们在哪里“发明”来做这些事情。

# javascript - 使会话值可用于 JavaScript 的好方法是什么？

> ID：12288082
> 
> 赞同：4
> 
> 时间：2012-09-05T19:03:05.220
> 
> 标签：javascript, .net, html, client-server

当我的页面加载时，它将数据库中的 id 存储到 session:`Session["AppId"] = 1234`中。但是，当我在做 JavaScript 的事情时，我需要知道用于数据库调用的 AppId。如何从服务器代码使我的 JS 可以使用它？注册一个脚本标签`var appId = 1234`是可行的方法还是该代码闻起来有点太成熟了？

向 body 标签添加自定义属性会更有意义吗？`data-appid=1234`例如？

我是网络新手，所以该做什么和不该做什么对我来说并不总是显而易见的。如果有正确/最好的方法，请随时分享。

## 编辑：

我真正需要的解决方案是`HttpContext.Current.Session["AppId"]`. 我不认为静态方法可以访问会话值，所以我认为我必须将它存储在标记中才能通过 Ajax 调用传递给我的 WebMethod。我接受了我所做的答案，因为它回答了我提出的问题。我只是问错了问题。=) 我是新人记得 - 放轻松！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T19:04:49.137

您可以创建隐藏字段或使用全局变量。

隐藏字段：

```
<input type="hidden" value='<%= Session["AppId"] %>'></input> 
```

全局变量：

```
<script type="text/javascript">
window.AppId = '<%= Session["AppId"] %>';
</script> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-05T19:05:16.717

有很多方法可以做到这一点：

*   正如您发布的那样，一个`data-*`属性
*   隐藏的表单域（如果页面上有表单）
*   嵌入网址
*   输出到 javascript 到一个变量中

哪个是最好的没有共识。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T19:11:13.537

我个人将会话值输出到全局变量，如下所示：

```
<script type="text/javascript">
    <?php
    if(isset($_SESSION["AppId"]))
    {
        echo "var AppId=".$_SESSION["AppId"].";";
    }
    else
    {
        echo "var AppId=null;";
    }
    ?>
</script> 
```

# 或者...

虽然我不确定您的客户端应用程序如何运行，但在实际进行数据库查询时，您能否不检查 AppID 值服务器端？

这样，AppID 值永远不会显示给用户，他们将无法通过 javascript 弄乱该值。

# javascript - jQuery - 将表单复制到相同的表单

> ID：12288084
> 
> 赞同：0
> 
> 时间：2012-09-05T19:03:08.727
> 
> 标签：javascript, jquery, forms

我想将现有表单复制到另一个表单。我发现这个[问题](https://stackoverflow.com/questions/1435852/copying-from-form-to-form-in-jquery)适用于正常输入，但它在我的复选框上引发错误

我正在使用的 jQuery 函数（[from ）是](https://stackoverflow.com/a/1436375/94278)

```
(function($) {
    $.fn.copyNamedTo = function(other) {
        return this.each(function() {
            $(':input[name]', this).each(function() {
                $('[name=' + $(this).attr('name') +']', other).val($(this).val())
            })
        })
    }
}(jQuery)); 
```

错误是：

```
Uncaught Error: Syntax error, unrecognized expression: [name=cartype[]] 
```

复选框的排列方式如下：

```
<input type="checkbox" name="cartype[]" id="cartype_10" value="10">4x4
<input type="checkbox" name="cartype[]" id="cartype_11" value="11">Saloon 
```

我希望这是由于`[]`名称中的，但无法弄清楚该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T19:06:33.097

您必须将您的名字中的and 替换为 and `[`（如此[处](http://api.jquery.com/category/selectors/)所述），因为（如您所知）它们在 jQuery 选择器中具有特殊含义。`]``\\[``\\]`

```
$('[name=' + $(this).attr('name').replace(/([\[\]])/g, '\\\\$1') +']', other).val($(this).val()) 
```

请注意，从技术上讲，您还应该有一个表单选择器`$('[name="val"]')`（注意属性值周围的引号）。jQuery 似乎一直对此很宽容，但它符合[docs](http://api.jquery.com/attribute-equals-selector/)。

要确定复选框和单选按钮，您需要设置`checked`它们的属性，而不是更改值。您可以将功能更改为此；

```
$.fn.copyNamedTo = function(other) {
    return this.each(function() {
        $(':input[name]', this).each(function() {
            var target = $('[name=' + $(this).attr('name').replace(/([\[\]])/g, '\\\\$1') +']', other);

            // Radios have the same name as each other, so filter based on value
            // Checkboxes are in the same boat here due to the naming conventions shown in the OP.
            if ($(this).is(':checkbox, :radio')) {
                target.filter('[value="' + this.value + '"]').prop('checked', this.checked);
            } else {
                target.val($(this).val());
            }
        })
    })
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T19:04:21.617

尝试使用`data`属性。

`data-name="cartype[]"`

并使用：`$(this).data('name')`

# jquery - jquery：用超链接的值填充文本框

> ID：12288091
> 
> 赞同：0
> 
> 时间：2012-09-05T19:03:21.023
> 
> 标签：jquery, ajax

我在一个视图上有一些 javascript，可以对我的控制器进行 ajax 调用。我正在遍历数据并正在构建一个表格。我需要做的是为表中的每个项目，使其成为一个超链接，然后当用户单击任何链接时，我想用链接的值填充一个文本框。

到目前为止，我的代码循环遍历 json 数据并构建我的表工作。这是代码片段：

```
 htmlstring = htmlstring + "<th>VlanId</th><th>Name</th>";
    for(i = 0; i < returnDataFromController.length; i++) {
        //alert(returnDataFromController[i].VlanId);
        htmlstring = htmlstring +  "<tr><td><a href=''>"+returnDataFromController[i].VlanId+"</a></td><td>"+ returnDataFromController[i].Name+"</td></tr>";          
    }
    submitFormHTML = "<input type='text' id='newVlanID' style='width:5em;height:1.5em'/>&nbsp;&nbsp;<button class='btn' id='saveVlan' style='width:10em;height:2em'>Reassign Vlan</button>";
    $('#clientajaxcontainer').html(htmlstring);
    $('#newvlanform').html(submitFormHTML); 
```

为了完成我想做的事情，我需要给每个标签一个唯一的名称还是我可以将它分配给一个类？如果我可以为每个标签分配一个特定的类，那就太好了 - 例如）classX ...然后为classX类型的标签的点击事件编写一个jquery处理程序。这可能吗？感谢您花时间阅读这篇文章。

**编辑：**

我正在使用 jquery 1.8 版。除了上面的代码之外，我还添加了一些 javascript 来尝试根据点击事件自动填充文本框：

```
 $('clientajaxcontainer').on("click", "td:first-child a", function(ev) {
  ev.preventDefault();
  $('#newVlanID').val($(this).text());
  }); 
```

如果我理解正确， ev.preventDefault() 应该会阻止浏览器将我重定向到另一个页面。但这似乎不起作用。当我单击任何超链接时，它会重新加载当前页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T19:15:02.767

使用[.on()](http://api.jquery.com/on/)的委托版本并将单击处理程序添加到您的 ajax 容器。

```
$("#clientajaxcontainer").on("click", "td:first-child a", function(ev) {
    ev.preventDefault();

    $("#newVlanID").val($(this).text());
}); 
```

[另一个问题的示例](http://jsfiddle.net/s7bXW/)，但它非常接近这个解决方案，只是没有链接标签:)

**编辑**
对于 1.7 以下的 jQuery 版本，您可以使用[.delegate()](http://api.jquery.com/delegate)代替

```
$("#clientajaxcontainer").delegate("td:first-child a", "click", function(ev) {
    ev.preventDefault();

    $("#newVlanID").val($(this).text());
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T19:14:50.427

我不会将链接创建为 HTML 字符串，而是将它们创建为 jQuery 元素，因此您可以为它们分配点击侦听器：

```
var link = $("<a href=#>"+ yourVar +"</a>");
link.click(function(){
  alert("Do something with "+ $(this).html());
  return false;
});
$(yourDomElement).append(link); 
```

# c++ - GNU Makefile 自动依赖解析

> ID：12288093
> 
> 赞同：0
> 
> 时间：2012-09-05T19:03:25.877
> 
> 标签：c++, build, makefile

我一直在使用`qmake`并且`CMake`过去没有任何问题来生成我的makefile。然而，最近我发现在我运行我的代码的一些集群上，这些工具更难找到/安装，所以我决定编写裸 Makefiles。此外，我还可以学习有关 Makefile 的一两件事；）

我的项目涉及多个目录，其中包含源/头文件，并且通常在它们之间交叉依赖。我通过 SO 学会了使用`-MM`flag 来自动生成依赖信息。我的 Makefile 看起来像这样

```
include $(HEAD_DIR)/common.mk

OBJS_DIR = objs
LIBS_DIR = libs

SRCS  = Matrix.cpp MatrixFull.cpp
OBJS  = $(patsubst %,$(OBJS_DIR)/%,$(SRCS:.cpp=.o))
LIB_0 = $(patsubst %, $(LIBS_DIR)/%,libalgebra.a)

DEPS := $(patsubst %,$(OBJS_DIR)/%,$(SRCS:.cpp=.d))
-include $(DEPS)

.PHONY: all
all:    
    @echo   " ===== Building dependencies in lib/algebra ===== "
    @$(MKDIR) $(OBJS_DIR)
    @$(MAKE)  $(OBJS)
    @$(MKDIR) $(LIBS_DIR)
    @$(MAKE)  $(LIB_0)
    @echo   " ===================== done ===================== "

$(OBJS_DIR)/%.o: %.cpp
    @echo " compiling source file:   $< ..."
    $(CXX) -c $(CXXFLAGS) -I$(INCLUDE_PATH) -MM $< -o $@

$(LIB_0): $($(OBJS_DIR)/%.o)
    @echo " generating library file: $(@F) ..."
    @$(AR) $(AR_FLAGS) $@ $^

.PHONY: clean
clean:
    @$(RM) $(OBJS_DIR) $(LIBS_DIR) 
```

这通常工作正常，但我想改进几件事：1）当我更改头文件`make`并`all` 发出`DEPS`. 这应该发生在这个makefile中吗？如何制定`all`默认规则？2）如何使依赖文件不可见？我试过`DEPS := $(patsubst %,$(OBJS_DIR)/.%,$(SRCS:.cpp=.d))`了，但没有帮助 3) 如果您认为这个 Makefile 可以通过任何其他方式改进，您有什么具体建议可以给我吗？

*编辑：*老实说，我什至不确定 make 如何调用编译器来生成依赖项：p ...我没有看到任何明确的规则。它是否以某种方式隐藏在 中`DEPS := $(patsubst %,$(OBJS_DIR)/%,$(SRCS:.cpp=.d))`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T19:33:24.820

1) 将规则`-include $(DEPS)`向下移动`all`。第一条规则是默认规则（除非您故意设置一些特殊变量），因此如果`include`拉入上面的规则`all:`，那将是默认规则。

2）我认为“使它们不可见”你的意思是你想要`.foo.d`而不是`foo.d`. 您必须修改生成它们的规则：

```
$(OBJS_DIR)/%.o: %.cpp
    @echo " compiling source file:   $< ..."
    $(CXX) -c $(CXXFLAGS) -I$(INCLUDE_PATH) -MM $< -o $@
    @mv $(OBJS_DIR)/$*.d $(OBJS_DIR)/.$*.d 
```

然后是找到它们的变量：

```
DEPS := $(patsubst %.cpp,$(OBJS_DIR)/.%.d,$(SRCS)) 
```

3）我会摆脱递归调用（`$(MAKE) ...`），但你应该首先确保其他一切正常。我很惊讶这`$(OBJS_DIR)/%.o`条规则不适用`common.mk`。除此之外它看起来还不错。

4(?))`$(OBJS_DIR)/%.o`规则中的编译器命令使用该`-MM`标志，因此编译器生成依赖文件作为副作用。

# mongodb - Mongodb组合字段形成集合

> ID：12288094
> 
> 赞同：0
> 
> 时间：2012-09-05T19:03:34.160
> 
> 标签：mongodb, mongodb-java

我的数据库中有几个集合。

我需要通过从不同集合中获取字段来创建一个单独的集合，例如关系表中的视图。

有没有办法在mongodb中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T19:50:29.673

除了[`DBCollection.find(...)`](http://api.mongodb.org/java/current/com/mongodb/DBCollection.html)允许在查询结果中输出键的子集之外，听起来您确实想要进行 SQL 表连接。您不能进行直接连接，但可以使用[`DBRef`](http://api.mongodb.org/java/current/com/mongodb/DBRef.html)该类来模拟类似于 SQL 连接的东西。此外，您不能真正执行 SQL 联合，因为预计相关的属性集将位于同一个集合中。

您可能想查看此[SQL 到 MongoDB 映射图表](http://www.mongodb.org/display/DOCS/SQL+to+Mongo+Mapping+Chart)。一般来说，重要的是要记住 MongoDB 是无模式的，因此您不必为每个文档使用相同的列/行结构。因此，当不强制实施模式时，像视图这样的结构可能不那么重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T07:30:03.900

MongoDB 不支持视图。你必须自己在应用层实现这个功能。

# git - 像 Github for Windows 一样提交所有更改

> ID：12288105
> 
> 赞同：0
> 
> 时间：2012-09-05T19:04:25.853
> 
> 标签：git

我希望这对于一些有经验的 git 用户来说应该是轻而易举的事。我想使用一个命令，当发出该命令时，将使 git 与我的项目目录的当前状态同步。与必须发出单独的命令来添加添加到我的项目中的文件、删除从中删除的文件等相比。基本原理是我不需要仅仅为了 git 来确认对我的项目的每个更改的额外层，我我宁愿让 git 只反映目录（当我发现它是一个值得同步到 git 的好同步点时）。

这也是 Github for Windows 采用的方法。它只是将 git 与您的项目同步（它确实提供了排除更改的选项，但仅作为一个选项）。

真的，我通常发现不需要告诉 git '用这个更改的文件更新'，'从你的记录中删除这个文件，因为我已经删除了它'等等。

我真的不想随着时间的推移进行试验，并希望这个问题有一个简单的设计工作答案。

在此先感谢，马坦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T19:08:13.510

一个`add`命令很好很简单：

```
git add -A 
```

请注意，这`git add .`还不够，因为它`.`会扩展为“当前目录”，也就是“所有当前文件”，这意味着它不会告诉 git 任何不再存在的文件（即已删除的文件）

或者，如果您想在一个步骤中添加*和提交（通常不推荐），那么您可以*

```
git commit -a 
```

反而。

值得知道的是，这些 git 命令没有必要“随着时间的推移进行实验”，因为`git help`有很多关于每个 git 命令及其选项的文档。

# javascript - jQuery从iframe绑定到父元素点击事件

> ID：12288114
> 
> 赞同：1
> 
> 时间：2012-09-05T19:04:54.613
> 
> 标签：javascript, jquery, html, iframe, javascript-events

我早些时候发布了一个类似的问题并收到了答案，在遇到新问题之前我只能部分工作。

这是我的 iframe 中 $(document).ready() 中的代码：

```
$("button#arrow-left", window.parent.document).on("click", function () {
    console.log("Got here");
    $(document).trigger("VEHICLE.CONTROLS.PRESSED_LEFT");
}); 
```

这几乎可以工作。当我单击父文档上的左箭头时，我现在将“到达这里”转储到我的控制台中。但是，据我所知，“VEHICLE.CONTROLS.PRESSED_LEFT”事件永远不会触发。

在我的 iframe javascript 的另一部分，我有以下几行：

```
$(document).on("VEHICLE.CONTROLS.PRESSED_LEFT", function () {
    console.log("Left button pressed, triggering left swipe.");
    $("div#swipe-container").swipe('swipe_left');
}); 
```

第二个控制台日志永远不会发生，并且我的滑动插件没有按应有的方式执行左滑动。

有人可以告诉我我做错了什么吗？

万一它是相关的，我基本上采用了一个在车辆中运行的 HTML5/JS 应用程序并将其移植到浏览器。应用程序本身在 iframe 中运行，父文档有一些模拟车辆控件。

我知道我可以直接绑定到触发滑动的代码区域内的按钮单击，但我的想法是我有一个 JS 文件充当应用程序和目标 API 之间的媒介。这样，无论代码是在实际车辆中运行，还是仅在我的模拟器中运行，我都可以保持代码同步。

编辑：此外，这与我在使用实际车辆 API 之前工作的功能几乎相同。我之前在使用车辆 API 时如何设置控件的示例：

```
sdk.vehicle.watchButtons("left", function () {
    $(document).trigger("VEHICLE.CONTROLS.PRESSED_LEFT");
}); 
```

# java - prepare statement object is not closed

> ID：12288116
> 
> 赞同：0
> 
> 时间：2012-09-05T19:04:57.293
> 
> 标签：java, jdbc, prepared-statement

Is that code affecting the Performance or cause any memory leaks? Here `PreparedStatement` object is not closed and doesn’t have the reference to close. Any suggestion on this?

```
private ResultSet getEmpData(String query){
    ResultSet rs = null;
    try {
        rs = connection.prepareStatement(query).executeQuery();
    } catch (SQLException e) {
        e.printStackTrace();
    }
    return rs;
}

public int getEmployeeSalary(){

    ResultSet rs = null;
    int salary  = 0 ;
    try {
        rs = getEmpData("SELECT SALARY FROM EMP WHERE NAME ='SAM'");
        while (rs.next()) {
            salary = rs.getInt(1);
        }
    } catch (SQLException e) {
    }finally{
        if (rs!= null) {
            try {
                rs.close();
            } catch (SQLException e) {
                e.printStackTrace();
            }
        }
    }
    return salary;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T19:38:30.927

Technically you should not be closing your ResultSet but rather the database connection itself. This should not cause a memory leak provided you close your database connection when you have completed our database operations.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T05:18:24.380

While you're closing the `ResultSet`, you're not closing the `PreparedStatement` statement that is associated with it. What you should be doing in your `finally` block is the following:

```
rs.getStatement().close(); 
```

This would ensure that the associated statement is closed. Also as per the [Javadoc](http://docs.oracle.com/javase/6/docs/api/java/sql/ResultSet.html#close%28%29),

> A ResultSet object is automatically closed when the Statement object that generated it is closed, re-executed, or used to retrieve the next result from a sequence of multiple results.

This means that when you close the statement object using the aforementioned code, you're also effectively closing the ResultSet object.

# ajax - 在 ajax 场景中实现后重定向模式

> ID：12288118
> 
> 赞同：1
> 
> 时间：2012-09-05T19:05:05.313
> 
> 标签：ajax, asp.net-mvc, post-redirect-get

考虑以下场景：我有一个可以打开对话框（jquery 对话框）的页面。此对话框允许用户更新一些值，甚至插入新值。用户有时会多次点击“确认”按钮，触发更新或插入的次数与点击次数一样多。该方法通过 ajax 调用 (jquery ajax) 触发，成功时会向用户显示一个不错的“完成”消息。

在更新场景中，这很好，即使我的服务器代码必须在数据库上调用更新命令的次数与调用该方法的次数一样多。但是在插入情况下，我的数据被提交了几次，并且在数据库中插入了几行。这会给其他领域带来很多问题。

我读到了 post-redirect-get 模式，这将是我问题的理想解决方案。但它只说一个非 ajax 帖子。如果通过 ajax 调用完成对方法的调用呢？如何防止用户多次提交同一件事？

我试图阻止对话框上的按钮，即使它有效，我认为这是不好的解决方案，因为按钮可能不会一直被阻止，特别是如果用户的浏览器有问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T21:50:11.387

除了在用户单击保存按钮后禁用它（这是一个完全合理的解决方案），另一种选择是在您的表单提交中使用唯一的验证令牌，每次用户单击保存时都会对其进行验证。

当请求表单视图时，生成一个唯一标识符（GUID 或类似的），将其存储在用户的会话中，并将其传递给视图。在视图中，包含唯一标识符作为随表单提交的隐藏字段之一。现在，当处理表单提交时，将请求中的值与会话中的值进行比较。如果请求值和会话值匹配，则将会话中的值替换为新的唯一标识符并执行数据库操作。如果请求值和会话值不匹配，您将知道用户重复提交。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T17:22:29.153

尽管 Nathan Taylor 的解决方案是可能且正确的，但我更喜欢做一些更简单的事情。我创建了一个本地布尔值，它应该检查表单是否已提交。第一次提交表单时，此变量接收`true`并阻止进一步提交。检查下面的代码：

```
<script type="javascript">
var isSubmit = false;

$('#myForm').submit(function(){
  //Check if this is the first time the form is submitted
  if(isSubmit === true){
  return false;
}
isSubmit = true;
//Executes the form submission as it should be
});
</script> 
```

请记住在对话框范围内创建此`isSubmit`变量，否则您将无法再提交此表单，当然，除非您在其他地方更改变量。

# jquery - 带有打开/关闭箭头的基本显示/隐藏 Div

> ID：12288123
> 
> 赞同：1
> 
> 时间：2012-09-05T19:05:16.857
> 
> 标签：jquery, hide, show

尝试打开/关闭 div，方向箭头在打开和关闭时发生变化，但在关闭和打开时保持与 div 的连接。

[http://jsfiddle.net/siiimple/GqJj8/8/](http://jsfiddle.net/siiimple/GqJj8/8/)

理想情况下，我希望它在关闭（快速）时向左滑动，然后向右打开。关闭时，关闭的“-”将变为“+”。

谢谢你的帮助 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T21:22:57.103

偏离了 crowjonah 的解决方案，并提出了一些我*认为*更接近您的规范的东西。

在这里查看：

[http://jsfiddle.net/VLNDL/](http://jsfiddle.net/VLNDL/)

首先，对 div 进行了一些重组，使展开/收缩按钮与滑动 div 是对等的；以便它在过渡期间保持连接：

```
<div id="intro-wrap">
<div class="open-intro">+</div>
<div class="close-intro">-</div>
<div id="contentWrap">
    <h1 class="main-header">Here is a Title</h1>
    <p class="main-desc">You can write whatever you want about yourself here. You can say you're a superhuman alien ant, arrived from the nether regions of Dwarf-Ant-Dom.</p>
</div> 
```

​ 然后将 CSS 重构为：1\. 使其更简单，2：更改块、相对、浮动和绝对，以便将按钮“固定”到相对 div，就是这样：

```
 #intro-wrap {
    position: relative;
    z-index: 1;
    border-left: 25px solid rgba(0,0,0,.2);
    width: 200px;
}
#contentWrap{
    background: rgba(0,0,0,.8);
    padding: 15px 40px 25px 30px;
}

#intro-wrap h1 {
    font-family: "PT Sans Narrow";
    font-size: 25px;
    color: #fff;
    font-weight: 700;
    margin-bottom: 0px !important;
    padding-bottom: 10px;
}

#intro-wrap p {
    line-height: 19px;
    color: #999;
}
.open-intro,
.close-intro {
    position:absolute;
    left:200px;
    cursor: pointer;
    width: 25px;
    height: 25px;
    z-index: 50;
    padding-left:15px;
}
.open-intro {
    display: none;
    background: yellow 
}
.close-intro {
    background: red; 
} 
```

我在js中唯一改变的是我禁用了不透明动画，但你可以把它带回来——我只是不会用它来定位#intro-wrap，你应该用它来定位contentWrap：

```
 $('.open-intro').click(function() {
    $('#intro-wrap').animate({
    //opacity: 1,
    left: '0',
  }, 500, function() {
    // Animation complete.
  });
    $('.open-intro').hide();
    $('.close-intro').show();
});

$('.close-intro').click(function() {
    $('#intro-wrap').animate({
    //opacity: 0.25,
    left: '-225',
  }, 400, function() {
    // Animation complete.
  });
    $('.open-intro').show();
    $('.close-intro').hide();
}); 
```

Ĵ

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T19:17:09.577

[http://jsfiddle.net/harmeet_jaipur/ETx7P/](http://jsfiddle.net/harmeet_jaipur/ETx7P/)

您可以通过 slideUp/slideDown 轻松完成此操作。

或者你也可以试试这个：

[http://jsfiddle.net/harmeet_jaipur/7sRRG/1/](http://jsfiddle.net/harmeet_jaipur/7sRRG/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T19:22:58.817

我通常创建一个包含向上和向下箭头的精灵表，然后为每个具有不同背景位置的类。在切换时，只需将箭头分配给类，如果它是打开或关闭的。

此外，更新的小提琴对我来说根本不起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-05T19:24:53.883

左右滑动的一个简单方法是使用[jQuery UI](http://docs.jquery.com/UI/Effects/Slide)！只需`<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>`在 jQuery 本身之后添加并使用本示例中所示的函数（我分叉了 Harmeets）：http: [//jsfiddle.net/qEBnG/1/](http://jsfiddle.net/qEBnG/1/)（编辑：更好：http: [//jsfiddle.net/qEBnG/2 /](http://jsfiddle.net/qEBnG/2/) )

然后只需使用您的选择器和参数填写函数调用：

```
$('.open-button').click(function() {
    $('#content').show("slide", { direction: "left" }, 500);
    $('.open-button').hide();
    $('.close-button').show();
});

$('.close-button').click(function() {
    $('#content').hide("slide", { direction: "left" }, 100);
    $('.open-button').show();
    $('.close-button').hide();
});​ 
```

如果您愿意，可以稍微修改 CSS 以使 + 和 - 按钮相互替换。

正如 josh 所指出的，您不一定要加载整个 jQuery UI 库只是为了一个小的用途，在这种情况下，您可以使用 jQuery 的 animate 函数。这是[一个小提琴](http://jsfiddle.net/qEBnG/3/)，这里有一些代码（坚持现有的点击功能）：

```
$('#content').animate({
    opacity: 1,
    left: '-900', //to close. use 0 to open
}, 500, function() {}); //500 is the speed. lower is quicker 
```

# ruby - 如何通过一次 Fog 调用在存储桶中创建 S3 对象？

> ID：12288125
> 
> 赞同：11
> 
> 时间：2012-09-05T19:05:16.540
> 
> 标签：ruby, fog

这是[在目录（S3 存储桶）中创建文件（S3 对象）的 Fog 演练](http://fog.io/1.5.0/storage/)：

```
connection = Fog::Storage.new({
  :provider                 => 'AWS',
  :aws_access_key_id        => YOUR_AWS_ACCESS_KEY_ID,
  :aws_secret_access_key    => YOUR_AWS_SECRET_ACCESS_KEY
})

directory = connection.directories.create(
  :key    => "fog-demo-#{Time.now.to_i}", # globally unique name
  :public => true
)

file = directory.files.create(
  :key    => 'resume.html',
  :body   => File.open("/path/to/my/resume.html"),
  :public => true
) 
```

但在我看来，这似乎需要 2 个 API 调用：

1.  `connection.directories.create`
2.  `directory.files.create`

如果我已经创建了目录（一个 S3 存储桶），我如何创建一个只有一个 Fog 调用的文件（一个 S3 对象）？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-05T19:39:36.000

如果您知道该目录存在，您可以这样做

```
dir = connection.directories.new(:key => 'foo')# no request made
dir.files.create(...) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-10-21T07:23:19.720

或者，如果您已经有一个要存储文件的存储桶，那么您可以执行以下操作：

```
bucket = connection.directories.get({BUCKET_NAME}) 
```

之后，您将能够调用 bucket.files.create，将文件存储在该存储桶上。

希望能帮助到你！

# c++ - 移动由逗号运算符抑制的构造函数

> ID：12288131
> 
> 赞同：13
> 
> 时间：2012-09-05T19:05:52.133
> 
> 标签：c++, c++11, return, move-semantics, comma-operator

这个程序：

```
#include <iostream>
struct T {
    T() {}
    T(const T &) { std::cout << "copy constructor "; }
    T(T &&) { std::cout << "move constructor "; }
};
int main() {
    ([](T t) -> T { return t; })({}); std::cout << '\n';
    ([](T t) -> T { return void(), t; })({}); std::cout << '\n';
    ([](T t) -> T { return void(), std::move(t); })({}); std::cout << '\n';
} 
```

当由 gcc-4.7.1 编译时输出（[链接](http://liveworkspace.org/code/5ed5d0c99a4749d0b879721f3777c919)）：

```
move constructor 
copy constructor 
move constructor 
```

为什么逗号运算符会有这种效果？标准说：

> ### 5.18 逗号运算符 [expr.comma]
> 
> 1 - [...] 结果的类型和值是右操作数的类型和值；结果与其右操作数[...]具有相同的值类别。如果右操作数的值是临时的，则结果是临时的。

我是否错过了一些允许逗号运算符影响程序语义的东西，或者这是 gcc 中的错误？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-05T19:20:37.000

自动移动基于复制省略的资格：

`§12.8 [class.copy] p32`

> 当满足或将满足复制操作的省略标准时，除了源对象是函数参数的事实，并且要复制的对象由左值指定时，选择复制构造函数的重载决策是首先执行好像对象是由右值指定的。[...]

*当返回表达式是自动对象*的名称时，又允许复制省略。

`§12.8 [class.copy] p31`

> 在`return`具有类返回类型的函数的语句中，**当表达式是具有与函数返回类型相同的 cv 非限定类型的非易失性自动对象**（函数或 catch 子句参数除外）的名称时，可以通过将自动对象直接构造到函数的返回值中来省略复制/移动操作

插入逗号运算符后，表达式不再是自动对象的名称，而只是对一个对象的引用，从而抑制了复制省略。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-05T19:19:40.120

`t` *是*一个局部的命名变量，因此是一个左值。逗号运算符的行为与记录的一样。

相反，您应该问为什么`return t;`允许`t`绑定到右值引用——这才*是*真正的魔力。

# f# - 如何折叠有歧视的工会

> ID：12288132
> 
> 赞同：2
> 
> 时间：2012-09-05T19:05:52.037
> 
> 标签：f#, abstract-syntax-tree, fold, discriminated-union

我正在尝试对受歧视的工会实施折叠。DU 称为 Expr，表示程序表达式，通常是递归的。我正在尝试编写一个折叠，以递归方式累积对 Expr 的操作结果。下面是我写折叠的尝试。

```
let rec foldProceduralExpr (folder : 's -> Expr list -> 's) (state : 's) (expr : Expr) : 's =
    let children =
        match expr with
        | Series s -> s.SerExprs
        | Lambda l -> [l.LamBody; l.LamPre; l.LamPost]
        | Attempt a -> a.AttemptBody :: List.map (fun ab -> ab.ABBody) a.AttemptBranches
        | Let l -> l.LetBody :: List.concat (List.map (fun lb -> match lb with LetVariable (_, expr) -> [expr] | LetFunction (_, _, body, _, pre, post, _) -> [body; pre; post]) l.LetBindings)
        | Case c -> c.CaseTarget :: List.concat (List.map (fun branch -> [branch.TBBody; branch.TBTest]) c.CaseBranches)
        | Condition c -> List.concat (List.map (fun branch -> [branch.TBBody; branch.TBTest]) c.CondBranches)
        | List l -> l.ListElements
        | Array a -> Array.toList a.ArrElements
        | Composite c -> LunTrie.toValueList (LunTrie.map (fun _ mem -> mem.MemExpr) c.CompMembers)
        | _ -> []
    let listFolder = fun state expr -> foldProceduralExpr folder state expr
    let listFolded = List.fold listFolder state children
    folder state (expr :: listFolded) 
```

问题是代码不起作用，这是众所周知的，因为我在最后一行得到了`the construct causes code to be less generic than indicated by the type annotations. The type variable 's has been constrained to be type 'Expr list'`错误`listFolded`。这是因为 的定义`foldProceduralExpr`几乎肯定是错误的。

现在，我很想修复代码并因此修复类型错误，但我根本不知道如何。我想我缺乏的是对非列表或递归数据结构的折叠如何工作的理解。我最近将一个 trie 的折叠从 OCaml 翻译成 F#，并且在理解该折叠如何工作时遇到了很多麻烦。

问题 1：此代码是否有我可以理解的可见修复？

问题 2：是否有资源来获得理解如何编写这些类型的折叠所需的背景？

如果您需要更多信息，请告诉我。我没有将 DU 包括在内，因为它太大且太复杂，无法清楚地说明问题。希望可以说，这是典型的 Lisp 风格的 AST 数据结构。

后续问题：一旦它起作用，我也想用那个折叠写一张地图。这看起来像一张典型的地图，还是需要一些额外的脑力才能弄清楚？

**编辑：关于 Tomas 的帮助**，我已将最后三行变成 -

```
let exprs = expr :: children
let listFolder = fun state expr -> foldProceduralExpr folder state expr
let listFolded = List.fold listFolder state exprs
folder listFolded exprs 
```

我希望这仍然有意义。

**编辑：这是我的最终解决方案。**它概括了得到孩子 -

```
let rec foldRdu (getChildren : 't -> 't list) (folder : 's -> 't -> 't list -> 's) (state : 's) (parent : 't) : 's =
    let children = getChildren parent
    let listFolder = fun state child -> foldRdu getChildren folder state child
    let listFolded = List.fold listFolder state children
    folder listFolded parent children 
```

我将 Expr 和 Expr 列表作为折叠值的原因是我想保留父/子关系的结构以供以后使用。这是一个非常特定于领域的折叠，在某种程度上我想。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T19:27:23.417

第一个问题是，你想实现什么样的折叠？树状结构有多种选择。假设您有一个*n*叉树（即任意数量的子树），您可以：

1.  `Expr`仅在叶子中的节点上应用折叠功能
2.  在叶子上应用折叠功能，然后将其应用到所有内部节点（在递归调用之后）
3.  在处理树时在内部节点上应用折叠功能，然后在叶子上应用

在您的示例中，您的文件夹函数采用`Expr list`这对我来说有点令人困惑 - 我认为您可以只给它当前`Expr`而不是子列表，但是在孩子上调用它也是一种选择。

您首先进行递归调用，然后在当前表达式上调用文件夹，所以我想您想实现选项 2。我可以理解折叠的前两行：

```
// This defines a function that recursively folds the a given 
// expression and produces a new state of type 's
let listFolder = fun state expr -> foldProceduralExpr folder state expr 
// Here, you fold all children recursively starting with 'state' and 
// obtaining a result 'listFolded' of type 's
let listFolded = List.fold listFolder state children 
```

但是，最后一行可能是错误的：

```
// From the previous line, 'listFolded' is of type 's, but 
// here you use it as if it was a list:
folder state (expr :: listFolded) 
```

我假设您可能希望`listFolded`将状态用作传递给`folder`. 该文件夹接受一个表达式列表，因此您可以将其`children`作为第二个参数提供（或者您可以更改`folder`为仅采用一个`Expr`，然后仅给出它`expr`，恕我直言，这更有意义）。无论如何，这应该使它工作，以便您可以运行它并查看发生了什么：

```
folder listFolded children 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-09T12:22:24.040

我曾经写过一篇关于维护涉及大型可区分联合及其转换的代码的实用方法的文章：

[http://t0yv0.blogspot.com/2011/09/transforming-large-unions-in-f.html](http://t0yv0.blogspot.com/2011/09/transforming-large-unions-in-f.html)

在实践中，我发现折叠假设太多，经常有无法用折叠表示的转换。您还希望控制转换的方式——自下而上或自上而下，以及哪些节点被跳过或特殊处理。`transform`本文通过一个简单的函数展示了如何做到这一点。我还从`transform`.

它没有直接回答如何解决您的问题，但它可能会为构建此类代码的另一种方式提供一些启示。

# gradle - 什么是 Gradle 工件依赖图命令？

> ID：12288133
> 
> 赞同：128
> 
> 时间：2012-09-05T19:05:55.797
> 
> 标签：gradle

[我在Gradle 文档](http://gradle.org/docs/current/userguide/dependency_management.html)中读到了这条评论：

```
To deal with problems due to version conflicts, reports with dependency graphs
are also very helpful. Such reports are another feature of dependency management. 
```

我有某种罐子被带进来，但我需要弄清楚它是从哪里来的。通常我会全局排除它，但我需要一些关于这里层次结构的信息。我如何从 Ivy 和 Maven 获得这些信息？

**更不用说有人将 Hibernate jars（很多）带入了我的 jar 列表，我真的很想知道是谁，因为我没有使用 Hibernate 并试图消除这种依赖关系。**

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2012-09-05T20:37:43.113

该命令是`gradle dependencies`，并且它的输出在 Gradle 1.2 中得到了很大改进。（您今天已经可以尝试 1.2-rc-1。）

* * *

## 回答 #2

> 赞同：128
> 
> 时间：2012-09-05T21:14:25.877

啊，因为我的主项目中没有依赖项，所以“gradle依赖项”只列出了那些而不是子项目依赖项，所以正确的命令最终是

```
 gradle :<subproject>:dependencies 
```

所以对我来说这是

```
 gradle :master:dependencies 
```

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2015-04-16T09:55:00.120

如果您想查看项目和所有子项目在顶级 build.gradle 中使用的依赖关系：

```
subprojects {
    task listAllDependencies(type: DependencyReportTask) {}
} 
```

然后调用gradle：

```
gradle listAllDependencies 
```

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2015-08-25T15:21:53.280

如果你有很多配置，输出可能会很长。要仅显示运行时配置的依赖项，请运行

```
gradle dependencies --configuration runtime 
```

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2014-08-10T09:11:46.650

如果你想递归包含子项目，你总是可以自己写：

粘贴到顶层`build.gradle`：

```
task allDeps << {
    println "All Dependencies:"
    allprojects.each { p ->
        println()
        println " $p.name ".center( 60, '*' )
        println()
        p.configurations.all.findAll { !it.allDependencies.empty }.each { c ->
            println " ${c.name} ".center( 60, '-' )
            c.allDependencies.each { dep ->
                println "$dep.group:$dep.name:$dep.version"
            }
            println "-" * 60
        }
    }
} 
```

运行：

```
gradle allDeps 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2019-03-01T09:25:57.233

```
gradlew -q :app:dependencies > dependencies.txt 
```

将所有依赖项写入文件dependencies.txt

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-12-30T04:24:25.660

对于那些希望在`react-native`项目中调试 gradle 依赖项的人来说，命令是（从 执行`projectname/android`）

```
./gradlew app:dependencies --configuration compile 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-01-06T14:24:14.017

1.  列出所有依赖项：`gradle yourmodule:dependencies > dep.txt`.
2.  如果您需要列出特定有问题的依赖项出现在您的项目中的位置/根： `gradle -q dependencyInsight --dependency commons-io --configuration runtimeClasspath`，`commons-io`您的依赖项在哪里。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2019-05-07T03:25:27.333

在最新版本的 Gradle（即 5+）中，如果您使用`--scan`标志运行构建，它会在您可以点击的浏览器中告诉您各种有用的信息，包括依赖项。

```
gradlew --scan clean build 
```

它将分析该构建中发生的事情的废话。这很整洁。

# jakarta-ee - 将实体管理器注入同一类的多个 bean

> ID：12288136
> 
> 赞同：0
> 
> 时间：2012-09-05T19:06:02.787
> 
> 标签：jakarta-ee, code-injection, persistence-unit

我有一个具有一些数据库操作的会话 bean 类。我需要将该类与多个数据库一起使用，因此我配置 ejb-jar.xml 以从该类创建会话 bean，每个 bean 用于每个数据库。这是代码。

```
public class UserEM
{
    /** The entity manager */
    @Resource(name="userEntityManager/em")
    private EntityManager em;

    public EntityManager getEntityManager()
    {
        return this.em;
    }

    ... Database operations using the `em` ...
} 
```

这是ejb-jar.xml

```
 ...
  <enterprise-beans>
    <session>
      <ejb-name>UserEM1</ejb-name>
      <ejb-class>com.abc.app.dao.UserEM</ejb-class>
      <session-type>Stateless</session-type>

      <persistence-context-ref>
        <persistence-context-ref-name>userEntityManager/em</persistence-context-ref-name>
        <persistence-unit-name>DataSource1</persistence-unit-name>
      </persistence-context-ref>
    </session>
    <session>
      <ejb-name>UserEM2</ejb-name>
      <ejb-class>com.abc.app.dao.UserEM</ejb-class>
      <session-type>Stateless</session-type>

      <persistence-context-ref>
        <persistence-context-ref-name>userEntityManager/em</persistence-context-ref-name>
        <persistence-unit-name>DataSource1</persistence-unit-name>
      </persistence-context-ref>
    </session>
  </enterprise-beans>
</ejb-jar>
... 
```

当我只创建一个会话 bean 时，它按预期工作。但是我创建了两个以上，它在部署时引发异常：

```
Caused by: java.lang.IllegalArgumentException: JBAS011053: Incompatible conflicting binding at java:comp/env/userEntityManager/em source: org.jboss.as.jpa.injectors.PersistenceContextInjectionSource@937b07ef
    at org.jboss.as.ee.component.deployers.ModuleJndiBindingProcessor.addJndiBinding(ModuleJndiBindingProcessor.java:237)
    at org.jboss.as.ee.component.deployers.ModuleJndiBindingProcessor.deploy(ModuleJndiBindingProcessor.java:136)
    at org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:113) [jboss-as-server-7.1.1.Final.jar:7.1.1.Final] 
```

这里发生了什么。任何人都可以帮忙吗？任何建议或意见均被采纳。

名和

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T16:17:00.820

玩了一段时间后，我找到了解决方案。这是代码。

这是ejb-jar.xml

```
 ...
  <enterprise-beans>
    <session>
      <ejb-name>UserEM1</ejb-name>
      <ejb-class>com.abc.app.dao.UserEM</ejb-class>
      <session-type>Stateless</session-type>

      <persistence-context-ref>
        <persistence-context-ref-name>**userEntityManager/em1**</persistence-context-ref-name>
        <persistence-unit-name>DataSource1</persistence-unit-name>
      </persistence-context-ref>
    </session>
    <session>
      <ejb-name>UserEM2</ejb-name>
      <ejb-class>com.abc.app.dao.UserEM</ejb-class>
      <session-type>Stateless</session-type>

      <persistence-context-ref>
        <persistence-context-ref-name>**userEntityManager/em2**</persistence-context-ref-name>
        <persistence-unit-name>DataSource2</persistence-unit-name>
      </persistence-context-ref>
    </session>
  </enterprise-beans>
</ejb-jar>
... 
```

我不知道的是，我们不仅在这里声明了两个 EJB，而且还声明了两个持久性上下文引用名称，它们在应用程序中必须是唯一的。换句话说，“persistence-context-ref-name”中的值也必须是唯一的。完成此操作后，应用程序即可部署，并使用不同的数据源创建两个会话 bean。可以使用 JNDI 查找 bean。

干杯，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T23:27:26.053

尝试将@Resource 更改为@PersistenceContext：

```
@PersistenceContext(name="userEntityManager/em")
private EntityManager em; 
```

**更新** 通过 ejb-jar.xml 注入呢？定义不带注释的 EntityManager em 并将以下内容添加到您的 xml：

```
<session>
  <ejb-name>UserEM1</ejb-name>
  <ejb-class>com.abc.app.dao.UserEM</ejb-class>
  <session-type>Stateless</session-type>
  <persistence-context-ref>
    <persistence-context-ref-name>userEntityManager/em</persistence-context-ref-name>
    <persistence-unit-name>DataSource1</persistence-unit-name>
    <injection-target>   
      <injection-target-class>com.abc.app.dao.UserEM</injection-target-class>   
      <injection-target-name>em</injection-target-name>  
    </injection-target>
  </persistence-context-ref>
</session>

<session>
...
</session> 
```

我还注意到您有两个企业 bean 元素。只定义一个，并在其中定义带有会话元素的会话 bean。

# vb.net - Linq 或 Lambda - 允许在连接表上自定义 Orderby 子句的方法

> ID：12288140
> 
> 赞同：2
> 
> 时间：2012-09-05T19:06:22.270
> 
> 标签：vb.net, linq, lambda, datatable, sql-order-by

我有一个 ASP.NET 页面，它是关联的 Handler 类。我想限制此处理程序中重复代码的数量。目前，我有一个方法可以返回包含来自两个连接表的数据的 DataTable。

```
公共共享函数 GetAllRecords() As DataTable
        将 dt 调暗为新数据表

        尝试
            使用上下文作为新的 QREntities()
                暗淡记录 =（来自上下文中的记录.QRRecords
                          加入广告 在 context.QRAdvertisements 上 record.adId 等于 advert.adId
                          选择record.recId、record.hitDate、record.hitLocation、record.ipAddress、advert.adRedirectUrl、advert.adType、advert.adData
                          按 hitDate 降序排序).ToList()

                '设置列标题及其接受的数据类型
                dt = SetDataTableColumns()

                对于每个 r In 记录
                    dt.Rows.Add(r.recId, r.hitDate, r.hitLocation, r.ipAddress, r.adRedirectUrl, r.adType, r.adData)
                下一个
            结束使用
        抓住前任作为例外
            什么都不退
        结束尝试

        返回 dt
    结束功能

```

现在我想允许个人按他们选择的任何列进行排序。我正在考虑将值作为参数传递，然后在 select 语句中检查，然后将关联的列与 Order By 一起使用，但问题是，Dim 记录是匿名类型的列表，这意味着我不能事先声明我知道。我的问题是每个人，最好的方法是什么？

我研究了查询对象、自定义表达式和查询集，但它们似乎让我误入歧途。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T21:43:43.397

动态 Linq 库 OrderBy 函数允许对列和方向进行动态排序。

# java - 在 64 位 Windows 上编译的 JAR 不会在 32 位上运行

> ID：12288141
> 
> 赞同：4
> 
> 时间：2012-09-05T19:06:26.843
> 
> 标签：java, windows, jar, 32bit-64bit

我刚刚在我的 64 位 Windows 7 笔记本电脑上使用 Eclipse 开发并导出了一个可运行的 JAR。我刚刚在其他计算机上尝试过，当您双击它时，它可以在另一台 Windows 7 x64 笔记本电脑上运行。但是，在 32 位笔记本电脑上，我只有在使用命令行运行它时才会启动，`java -jar "C:\Name of Jar.jar"`但不会引发任何错误。

此外，如果我使用该命令，`javaw "C:\Name Of Jar.jar"`我会收到一条错误消息，提示“找不到 Jar.jar 的主类 C:\Name。程序将退出。”

有谁知道为什么，以及如何解决它？提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T19:08:59.863

你是用 JDK 1.7 构建的吗？也许您还没有在您尝试运行它的电脑上安装 JRE7。这是我多次遇到的奇怪错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T19:09:25.113

在您的 32 位机器上右键单击 -> 在 JAR 上打开方式。如果列出了 JRE，您可以使用它打开，并将其设置为运行的默认程序。

我认为这与 32 位或 64 位操作系统无关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T19:10:10.777

试试`javaw -jar jar_name`。我认为这可能会奏效。

# mysql - 在 django 中，“class Meta:”声明的放置位置是否重要？

> ID：12288142
> 
> 赞同：1
> 
> 时间：2012-09-05T19:06:29.907
> 
> 标签：mysql, django, macos, model, meta

按照惯例，django 将`class Meta:`声明放在类定义中的倒数第二个，就在`__unicode__`方法定义之前。这是必需的吗？我试图在 Lion OSX 上追踪一个隐蔽的错误，其中`db_table = u'TableName'`某些模型忽略了语句的大小写（大写/小写）。对于某些模型，它使用 ed 表名`manage.py syncdb`创建 mysql 表，而对于其他模型，它正确使用大小写。使用自定义和其他方法的更复杂的模型是在创建 mysql 表之前转换为小写的模型。我正在尝试重新排列大量代码以查看这是否是问题所在，但找不到正确顺序的文档，尽管我记得过去某处指定了位置。`lower()``db_table``save()``class Meta:`

还尝试了 db_table 规范的 unicode 文字和单字节字符串文字。Niether 有所作为（对于工作或非工作模型）

以下是相关代码：

grep -A5 -B2 _table 'entityorganizer/models.py'

```
 class Meta:
        db_table     = 'Entity'
        verbose_name_plural = "entities"
        ordering = ["map_status","type_name","name"] 
        get_latest_by = "updated"

--

    class Meta:
        db_table = 'EntityRelationship'
        ordering = ["to_entity","relationship_type"]
        unique_together = (('from_entity','to_entity','relationship_type'))
        get_latest_by = "updated"
        verbose_name = "relationship"

--

    class Meta:
        db_table = 'Specialty'
        verbose_name_plural = u'specialties'

    def __unicode__(self):
        return '%s'%(self.specialty)

--

    class Meta:
        db_table = 'ZipCode'
        get_latest_by = "updated"

    def get_region(self):
        return REGION[region_id_v2-200][1] or 0

--

    class Meta:
        db_table = 'Setting'

    def __unicode__(self):
        return '%s = %s'%(self.name, self.value) #, self.updated) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T19:08:54.060

您可以将您`class Meta`的模型放在您想要的任何位置，只要它与正确的缩进匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T17:18:48.063

事实证明，这个`class Meta:`职位确实是一个红鲱鱼（@sdolan 明确表示）。显然，MAMP 或 django 将有关已删除表的情况的元数据存储在表本身之外的某个地方。一旦我们删除了整个数据库并重建，这个`db_table`案例就被 mysql 和`syncdb`

# vb.net - 将数字与句子分开

> ID：12288148
> 
> 赞同：0
> 
> 时间：2012-09-05T19:06:57.623
> 
> 标签：vb.net

如何将数字与这样的句子分开？

```
Z        90.00000 
```

或者

```
 47540.00000 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T19:14:38.913

您可以使用类似下面的正则表达式：

```
Dim regex As Regex = New Regex("\d+\.\d+")
Dim match As Match = regex.Match("Z        90.00000")
If match.Success Then
    Console.WriteLine(match.Value) 
```

这是一个包含很棒的 RegEx 教程和参考资料的网站：

[http://www.regular-expressions.info/dotnet.html](http://www.regular-expressions.info/dotnet.html)

# javascript - 如何确定相对较新版本的 IE 的高度和宽度（是，IE8 不喜欢从 JavaScript 设置这种样式吗？）

> ID：12288149
> 
> 赞同：0
> 
> 时间：2012-09-05T19:07:12.160
> 
> 标签：javascript, html, css, internet-explorer-8, cross-browser

```
var height = (library.window_dimensions().height - 200) + 'px';
document.getElementById('activity-feed').style.height = height; 
```

IE8 报告这两行中的第二行错误。（返回高度和宽度的函数返回窗口高度和宽度的整数。）

IE 在抱怨什么？

- 编辑 -

我在[http://www.howtocreate.co.uk/tutorials/javascript/browserwindow](http://www.howtocreate.co.uk/tutorials/javascript/browserwindow)上关闭了适用于 IE4 但可能不是最新版本的 IE 的代码；我只是希望能够彻底解决 IE4 问题的人对常见的 IE 版本有意义。**代码为窗口高度返回 0，下一行抱怨它的高度为 -200px。**

给出的代码是：

```
function alertSize() {
  var myWidth = 0, myHeight = 0;
  if( typeof( window.innerWidth ) == 'number' ) {
    //Non-IE
    myWidth = window.innerWidth;
    myHeight = window.innerHeight;
  } else if( document.documentElement && ( document.documentElement.clientWidth || document.documentElement.clientHeight ) ) {
    //IE 6+ in 'standards compliant mode'
    myWidth = document.documentElement.clientWidth;
    myHeight = document.documentElement.clientHeight;
  } else if( document.body && ( document.body.clientWidth || document.body.clientHeight ) ) {
    //IE 4 compatible
    myWidth = document.body.clientWidth;
    myHeight = document.body.clientHeight;
  }
  window.alert( 'Width = ' + myWidth );
  window.alert( 'Height = ' + myHeight );
} 
```

所以，我的下一个问题：不一定要回到 IE6 之后，我如何确定宽度和高度，以便例如 IE8 获得正确的高度？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T19:18:35.480

最有可能的是，您没有达到元素。document.getElementByID() 是一个时髦的函数。您正在尝试在 null/undefined 上设置高度。

# javascript - 使用 onblur 和 onchange 进行实时更新

> ID：12288151
> 
> 赞同：2
> 
> 时间：2012-09-05T19:07:13.987
> 
> 标签：javascript, jquery, input, auto-update

嗨，一旦用户完成对页面上的文本区域的更改，我就有 jQuery ajax 调用更新用户信息。现在我让它更新 onblur 但我还想确保 onchange 事件已注册，以便我知道他们不只是单击并退出 textarea。有没有一种结合 onblur 和 onchange 进行此类验证的好方法？

这就是我现在所拥有的：

```
$('#formTitle').bind('blur', function() {
    updateTitle(this.value)
}); 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T19:15:38.533

我认为方法 .change 就足够了。

```
$('#formTitle').change(function() {
    updateTitle(this.value)
}); 
```

这是[示例](http://jsfiddle.net/JQa9n/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T19:14:23.447

试试这个，将值保存在焦点上，然后进行模糊检查以查看它是否已更改。

```
var save_str = $('#formTitle').val();

$('#formTitle').bind('focus', function() {
  save_str = $(this).val();
});

$('#formTitle').bind('blur', function() {
  if (save_str != $(this).val()) {
    // do something
  }
}); 
```

# c# - 如何在 wpf 画布中拖动时避免用户控件重叠

> ID：12288153
> 
> 赞同：0
> 
> 时间：2012-09-05T19:07:20.710
> 
> 标签：c#, .net, wpf

我正在向我的画布动态添加用户控件。我想避免拖动时用户控件重叠。我正在检查每个控件的位置。是否有任何简单的解决方案或适当的方法来实现这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T19:24:34.063

这正是画布使您能够做的事情之一：使您能够重叠。为什么不分别使用网格宽度自动或采取什么休息空间 ( `width/height = auto/*`)，以便每个控件使用其所需空间 ( `auto`) 或其余可用空间 ( `*`)。

# jstree - 在 jstree 上将默认主题更改为苹果

> ID：12288156
> 
> 赞同：1
> 
> 时间：2012-09-05T19:07:35.320
> 
> 标签：jstree

我正在尝试将 jstree 上的主题从默认更改为苹果，如下所示：

```
"themes": {
        "theme": "apple",
        "dots": true,
        "icons": true,
        "url": "../../themes/apple/style.css"
    }, 
```

当我加载树时，我看不到文件夹图像的任何点。任何想法我做错了什么。上面的 style.css 文件指向苹果文件夹的 css 文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T18:33:06.107

这为我做到了：

```
$("#div_id").jstree("set_theme", "apple"); 
```

# c# - 在 ASP.Net 中使用 Google Checkout

> ID：12288157
> 
> 赞同：6
> 
> 时间：2012-09-05T19:07:35.533
> 
> 标签：c#, asp.net, google-checkout, android-pay

好的，我的网站有 3 个结帐选项 - 我们的信用卡处理、PayPal 和 Google Checkout，我通过处理请求来处理前两个选项，然后将用户重定向到收据页面以显示可打印的票据并显示交易的详细信息。这似乎很难用 Google Check Out 来实现。

所以我使用`Response.Redirect(...)`将用户重定向到 Google CheckOut。据我了解，无法为 Google 提供成功交易的重定向 URL。唯一的方法是给谷歌一个 URL 来发送通知。

所以我要创建一个 aspx 页面来收听来自 Google 的通知，这将被放置在数据库中。

我的问题是..如何实现所有这些以获得流畅的用户界面？用户将被重定向到谷歌（我不知道如何`Response.Redirect`在新标签或窗口中执行）所以用户现在正在登录谷歌，处理交易，然后他们必须自己回到我的网站，登录，然后点击最近购买的链接？？然后我可以显示收据。这似乎不对...有没有其他方法可以让其他人更顺利地实施 Google Checkout。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T22:00:25.357

经典 Checkout API 的替代方案是更新的 Wallet API：

[https://developers.google.com/in-app-payments/](https://developers.google.com/in-app-payments/)

整个交易都在应用内进行，这意味着客户永远不会离开您的网站。交易费用也更便宜。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T20:42:47.497

你看过`continue-shopping-url`参数了吗，更多信息请参见 html api 参数参考：

[HTML API 参数参考](https://developers.google.com/checkout/developer/Google_Checkout_HTML_API_Parameter_Reference#tag_continue-shopping-url)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-12-30T08:48:28.337

仅供想要集成**Google 钱包**的新开发者参考， “Google 钱包将于 2015 年 3 月 2 日停用”。

他们写道：“这仅适用于使用 Google Wallet for digital goods API 在自己的网站上接受数字商品付款的网络开发人员”。访问以下链接了解更多详情

[https://support.google.com/wallet/business/answer/6107573?hl=en](https://support.google.com/wallet/business/answer/6107573?hl=en)

# android - 用于键盘动态的 Android API

> ID：12288168
> 
> 赞同：0
> 
> 时间：2012-09-05T19:08:18.773
> 
> 标签：android, android-softkeyboard, keyboard-events

我正在考虑使用 Android 键盘 API 来制作需要键盘动态信息的应用程序。

它是否给了我这种事情所需的那种控制和精度？我看了一下[这个链接](http://android-developers.blogspot.com/2009/04/creating-input-method.html)，它似乎应该可以工作。

我需要的细节主要是

*   连续按键之间的时间间隔
*   向下事件发生和向上事件发生的确切时间

也欢迎其他建议，以及您可以告诉我的任何其他信息！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T17:14:23.327

一般来说，这似乎是可行的。您当然可以捕获触发键盘事件（包括按下和释放）的时间，也许使用[`System.currentTimeMillis`](http://developer.android.com/reference/java/lang/System.html#currentTimeMillis%28%29). 虽然通常在按下键和触发事件之间只有很小的差距，但高 CPU 负载可能会加剧这种情况。我不确定您的确切应用程序是什么，但如果它以身份验证为中心，您可能会考虑在处理之前首先为整个输入记录文本和所有这些时间信息（而不是“实时”）。

# ejb - 在 JBoss 7.1.1 上部署 EJB 2.0 .jar

> ID：12288169
> 
> 赞同：0
> 
> 时间：2012-09-05T19:08:27.120
> 
> 标签：ejb, jboss7.x

我有 netBeans，所以我无法在 JBoss 7.1.1 上部署 Ejb 2.0，所以谁能告诉我如何在 JBoss 7.1.1 上部署它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T09:53:58.967

当您以独立模式启动服务器时，您只需将生成的 .ear 或 .jar 文件复制到`standalone/deployments`文件夹中即可进行部署。这与 NetBeans 无关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T17:20:46.180

Jboss 7.1 上不支持 EJB 2.x 和 EJB 1.x。您必须使用旧版本的 JBoss 服务器。最好升级到 JBoss 7.1 支持的 EJB3.x，或者等待 JBoss 服务器的新版本。

# objective-c - 证书转让

> ID：12288170
> 
> 赞同：0
> 
> 时间：2012-09-05T19:08:34.687
> 
> 标签：objective-c, macos, xcode4.3

我最近买了一个新的 macbook pro 并下载了 Xcode。我尝试从 developer.apple/membercenter 下载我的开发者证书，但它给了我消息没有可用的私钥。如何在我的新笔记本电脑上获取我的配置文件和证书。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T19:12:49.897

您需要从原始计算机的钥匙串中导出密钥。转到钥匙串应用程序，找到您的证书，选择私钥并将其导出。您需要在新计算机上使用这些密钥。

# c# - 玩弄Farseer Physics；缩放让我很困惑

> ID：12288173
> 
> 赞同：0
> 
> 时间：2012-09-05T19:08:49.240
> 
> 标签：c#, xna, farseer

我已经将 Farseer 放到我的项目中，并迅速开始使用`FixtureFactory.AttachCircle(...)`.

奇怪的是我使用常规像素值来确定圆的半径，并将 1:1 转换为 Farseer 中表示的大小。例如`FixtureFactory.AttachCircle(32, 1f, body)`正确转换成直径为 64 像素的圆。

这是为什么？我在谷歌上读到的所有内容都建议不要超过 10（米）并设计自己的规模。

我是否错过了一些设置来定义我的世界的比例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T19:17:56.787

Farseer 引擎似乎使用 MKS 单位（米、千克、秒）。

本文提供了一个很好的示例，[说明](http://blog.dreasgrech.com/2011/02/farseer-physics-engines-meter-kilogram.html)如何将其转换为模拟单位。

# c# - 在配置文件中使用引号作为值

> ID：12288174
> 
> 赞同：3
> 
> 时间：2012-09-05T19:08:48.837
> 
> 标签：c#, config

如何在配置文件中使用引号作为值？我正在使用 C#

```
 <add key ="LeftParan" value ="""/>
 <add key ="RightParan" value ="""/> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-05T19:10:47.663

`.config`文件是 XML - 您需要将嵌入的引号转义为`&quot;`：

```
<add key ="LeftParan" value ="&quot;"/>
<add key ="RightParan" value ="&quot;"/> 
```

另一种选择是使用`'`而不是`"`（[感谢 Jon Hanna](https://stackoverflow.com/questions/12288174/use-quotes-as-value-in-config-file/12288207#comment16483330_12288207)）来分隔您的属性：

```
<add key ="LeftParan" value ='"'/>
<add key ="RightParan" value ='"'/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T19:10:57.563

你可以用这个字符替换`&quot;`

```
<add key ="LeftParan" value ="&quot;"/> 
```

# css - Firefox 在提交按钮中添加 2px 填充

> ID：12288175
> 
> 赞同：6
> 
> 时间：2012-09-05T19:08:50.100
> 
> 标签：css, firefox, button, submit, padding

嗨，我似乎在 Firefox 在提交按钮中添加 2 个额外像素的填充时遇到了一些问题。我已经在 chrome 和 IE9 中对此进行了测试，并且两个浏览器都可以呈现代码，Firefox 似乎在底部添加了 2 个像素填充右上角带有关键背景的提交按钮。这是网站：

[www.thanathos.host22.com](http://www.thanathos.host22.com/)

这是该网站的代码：

```
 <form method="post" action="index.html">
               <input type="text" value="Username"/>
               <input type="text" value="Password"/>
               <input type="submit" id="submit" value=""/>
               <img src="img/header/key.png" alt="" id="key"/>
      </form>

    header section form input{
        color:#b3aaaa;
        border:1px solid #cccccc;
        float: left;
        padding:5px 8px;
        margin-left: 6px;
    } 
```

我该如何纠正？

如果对此没有解决方案，任何人都可以为我提供一个解决方案，即输入文本与输入提交相等并且输入文本从上到下居中？

![在此处输入图像描述](../Images/ee32f3a742dcc3383727f751585103ee.png)

**编辑：**我已经在另一台计算机上检查了这个，似乎 Firefox 正确呈现了这个我遇到过这种类型的问题，之前相同的浏览器版本在不同的计算机上显示的网站有点不同。上次在 chrome 中发生了类似的事情。我从来没有可以解决这个问题。

任何人都知道为什么相同的浏览器会在具有相同屏幕尺寸和分辨率的不同计算机上呈现不同的页面？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-24T21:38:37.913

我遇到了这样的问题。然后我发现这个`CSS`东西解决了这个问题：

```
input::-moz-focus-inner { border:0; padding:0 } 
```

此解决方案在此博客文章的评论中给出：

[防弹 CSS 输入按钮高度](http://cbjdigital.com/blog/2010/08/bulletproof_css_input_button_heights)

正如帖子所说：发生这种情况是因为 Firefox（用户代理）`CSS`使用自己的样式`!important`，并且任何试图覆盖该`CSS`属性的操作都不会被应用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T19:20:56.893

** 我把它留在这里，因为我认为它很有用哦..**

在任何一种情况下，尝试只访问按钮并使用它的 css：

```
input[type="submit"] {
  padding-bottom: 3px;
} 
```

**编辑**

好的，所以您的解决方案存在问题，因为您将图像定位在按钮上方，您将更难实际单击提交按钮。如果将鼠标悬停在键上，您会看到它不会变为指针 = 不可点击。

我建议您删除图像标签，并将其用作提交按钮中的背景。像这样的东西：

```
input[type="submit"] {
  padding-bottom: 3px;
  background: url(path-to-image);
  border: none;
  height: "img-height";
  width: "img-width";
} 
```

如果图像的大小是正确的，也是因为您似乎在提交按钮中已经有了某种背景。我会制作一个包含背景和关键图像的正确大小的图像（我希望这最后一句话有意义）。

另一个可能的问题可能是您的按钮中没有文本，但是该按钮应该从 css 中的早期继承 lineheight/font-size，因此可能会更多地扩展提交按钮。尝试添加诸如 font-size: 1px 之类的东西。

# asp.net-mvc - MVC 3验证：我可以在每个控件的多个位置有多个错误消息吗

> ID：12288180
> 
> 赞同：0
> 
> 时间：2012-09-05T19:09:03.983
> 
> 标签：asp.net-mvc, asp.net-mvc-3

![数据输入页面和验证错误](../Images/299eb1c8988179b5a3551aaa7c5b78b8.png)

这是我的 MVC 注册页面。您可以在顶部看到合并的验证错误消息。UI 设计人员希望红色 (*) 出现在每个需要注意的控件旁边。

我知道如何使用 MVC 3 验证来生成 * 或上面的错误消息，方法是放置 @Html.ValidationMessageFor 并将错误消息自定义为更详细消息中的 *。

我不知道如何做到这两点。我知道我可以用 JQuery 解决这个问题。但我怀疑 MVC 验证有办法做到这一点。@Html.ValidationMessageFor 似乎为每个模型成员/控件应用一次，所以这可能不是方式......

总而言之，我有没有办法为位于与原始消息不同的位置的每个控件添加第二条错误消息（如 *），只有 MVC 验证，没有 JQuery / JS。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T19:25:43.470

据我所知，验证反馈仅支持每个输入一个反馈字符串。您可以为每个反馈消息设置自定义反馈消息并将 * 放在字符串前面，但这打破了 MVC 配置优势的许多约定。

现在，话虽这么说，为什么不试试 CSS 呢？据我了解，这些反馈消息（在每个输入表单旁边时）使用固定的 css 类。所以也许沿着这条线......

```
field-validation-error:before
{ 
    content:"* ";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T19:11:57.553

Html.ValidationSummary 在顶部。Html.ValidationMessageFor 在每个字段旁边。

# java - 如何保证终止 Java 中的任务？

> ID：12288181
> 
> 赞同：0
> 
> 时间：2012-09-05T19:09:13.350
> 
> 标签：java, task, termination

有问题[的如何使线程超时](https://stackoverflow.com/questions/2275443/how-to-timeout-a-thread)，建议的解决方案适用于`ExecutorService`该类，其中可以提交`Runnable`要执行的对象。

该类`ExecutorService`提供了两种方法`shutdown`并`shutdownNow`停止所有任务的执行。但是 Java API 说`shutdownNow`：

“尝试停止所有正在执行的任务，停止等待任务的处理，并返回等待执行的任务列表。除了尽力停止处理正在执行的任务之外，没有任何保证。例如，典型的实现将通过 Thread.interrupt() 取消，因此任何无法响应中断的任务都可能永远不会终止。”

我想知道，如果没有办法执行有保证的任务终止？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T19:16:15.153

如果任务的实现超出了您的控制范围，那么答案是否定的。

任务的实现者有责任并有能力提供一种终止方式。没有它，甚至`System.exit(-1)`可能没有效果，如果任务打开了一个守护线程......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T19:14:34.280

唯一的方法是使用已弃用的 Thread.stop()，但出于充分的理由已弃用它，不应使用它。

所以答案是否定的：没有这个任务协作就没有办法停止一个任务。如果任务即使被要求停止也拒绝停止，则什么也做不了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T19:24:48.347

这是可能的，但是你必须尊重很多事情：

1) 您必须确保正确处理 InterruptedException，例如没有下沉

2) 你必须检查线程状态，例如调用 Thread.interrupted

3) 测试后恢复线程的中断状态

4) 考虑在每个自定义 I/O 方法或循环中咨询此内容（如果适用）

我建议阅读“Java 并发实践”，这本很棒的书包含专门用于纠正线程中断并保证事情按预期工作的整章。

# java - JAX-RS @Path 嵌入变量

> ID：12288188
> 
> 赞同：0
> 
> 时间：2012-09-05T19:09:42.287
> 
> 标签：java, eclipse, glassfish, jax-rs

我正在使用最新的 Jax-RS + Glassfish 版本，并且一直在尝试对我的 API 进行版本控制。出于某种原因，如果我在 @Path Root 资源类中包含嵌入式变量，它甚至不会考虑这些变量。

```
@Path("/v{versionNum}/tasks")
public class Tasks {
    @SuppressWarnings("unused")
    @Context
    private UriInfo context;
} 
```

我的上下文根是 /api

我的 web.xml 包括：

```
 <servlet>
    <description>JAX-RS Tools Generated - Do not modify</description>
    <servlet-name>JAX-RS Servlet</servlet-name>
    <servlet-class>com.sun.jersey.spi.container.servlet.ServletContainer</servlet-class>
    <load-on-startup>1</load-on-startup>
  </servlet>
  <servlet-mapping>
    <servlet-name>JAX-RS Servlet</servlet-name>
    <url-pattern>/*</url-pattern>
  </servlet-mapping> 
```

现在，如果我尝试点击 localhost:8080/api/v1/tasks，我会得到 404。如果我点击 localhost:8080/api/tasks，它可以工作！

我只是不明白我在这里做错了什么。任何帮助将不胜感激谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T20:00:49.507

**sun-web.xml**

```
<sun-web-app>
  <context-root>/api</context-root>
</sun-web-app> 
```

**web.xml**

```
...  
<servlet>
    <servlet-name>ServletAdaptor</servlet-name>
    <servlet-class>com.sun.jersey.spi.container.servlet.ServletContainer</servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
    <servlet-name>ServletAdaptor</servlet-name>
    <url-pattern>/*</url-pattern>
</servlet-mapping>  
... 
```

**HelloWorldService.java**

```
@Path("/v{version}/tasks") 
```

在 GlassFish 上部署
`http://localhost:8080/api/v1/tasks`- 效果很好

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T20:07:01.937

```
<servlet-mapping>
  <servlet-name>JAX-RS Servlet</servlet-name>
  <url-pattern>/api/*</url-pattern>
</servlet-mapping> 
```

本地主机：8080/projectname/api/v15/tasks

*   项目名称：项目名称
*   /api : servlet 映射
*   /v15/tasks : 路径注释

# c# - 如何防止我的上下文菜单溢出到 C# 中的另一个监视器上？

> ID：12288192
> 
> 赞同：2
> 
> 时间：2012-09-05T19:09:54.157
> 
> 标签：c#, contextmenu

我最近一直在学习 C#，并且正在为通知图标制作上下文菜单。上下文菜单出现得很好，但如果菜单太大而无法容纳，它会溢出到我右侧的显示器上。

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T19:39:27.743

我发现我可以重新创建这个问题，如下所示：

![问题](../Images/3e05996760765d114d7a4dbebe6c1460.png)

解决方案似乎是将上下文菜单的**RightToLeft属性更改为****Yes**（右键单击菜单，单击属性，然后从属性窗格中选择**RightToLeft**），因此我的上下文菜单现在如下所示：

![解决方案](../Images/61193c2e77f4ea42b55dcd9294c594bf.png)

希望这可以帮助！

# java - Android AlarmManager 调用运行活动

> ID：12288198
> 
> 赞同：0
> 
> 时间：2012-09-05T19:10:17.860
> 
> 标签：java, android

我有一个警报管理器来检查我的活动是否需要每 30 分钟左右更新一次。我想从 alarmManager 向我正在运行的活动发送一条消息，让它重新加载。我会怎么做？我尝试在 alarmManager 中使用 startActivity，但没有成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T19:20:09.270

你熟悉 Activity 的[onNewIntent](http://developer.android.com/reference/android/app/Activity.html#onNewIntent%28android.content.Intent%29)方法吗？在您的活动课程中，您应该能够执行以下操作：

```
@Override
protected void onNewIntent(Intent i){
    refresh();
} 
```

您还可以将一些额外的数据打包到您使用 AlarmManager 提出的 PendingIntent 中，如果您需要更多逻辑，请从 onNewIntent 中检查它。

# php - html输入=服务器

> ID：12288199
> 
> 赞同：3
> 
> 时间：2012-09-05T19:10:17.777
> 
> 标签：php, html, input

我的服务器上有一个用 html/php 编写的网站。我还有一个脚本，它加载一个文件并返回一些图表。我可以使用`<input type="file" (...)/>`.

问题是：我不想从我的硬盘驱动器而是直接从服务器加载文件 - 我的意思是文件已经上传，现在我希望人们能够选择他们想要的文件并用我的脚本分析它们。假设他们在这个位置：`/home/user/www/source/`. 我该怎么做？是否有一些智能功能可以替换`<input>`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T19:35:20.070

如果某个文件夹中的所有文件都有效，那么您可以[`glob()`](http://php.net/manual/en/function.glob.php)创建链接或选择列表。如果你想操作一个文件的内容，你需要用 PHP[打开它，](http://www.php.net/manual/en/function.fopen.php)[读取](http://www.php.net/manual/en/function.fgets.php)内容，然后将数据输出到 html 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T19:12:21.617

图像存储在硬盘上，使用 img-tag 怎么样？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T19:15:05.320

上传文件后，您的脚本可以将该文件附加到上传文件的列表中......类似于

```
file1.txt
file2.txt
data1.txt 
```

然后你可以使用你的脚本来动态列出文件......

```
<?
$f = file ('uploads.txt');

print '<ul>';
for ($i=0; $i<count($f); $i++) {
    print '<li><a href="analyze.php?f='.$f[$i].'">'.$f[$i].'</a></li>';
}

print '</ul>';

?> 
```

当然，您必须将图形创建代码放在 analyze.php 中，以便它返回与所选文件对应的图形。

# windows-8 - 为非 Windows 应用商店应用程序制作 Metro 磁贴

> ID：12288203
> 
> 赞同：1
> 
> 时间：2012-09-05T19:10:28.873
> 
> 标签：windows-8, icons, windows-store-apps

有没有办法为非 Windows Store App 应用程序制作 Windows Store App 样式的磁贴？有点像，一个非地铁应用程序的新图标。

示例：
我想为 chrome 和 iTunes 制作瓷砖。由于它们还不是 Windows 8 应用程序，因此它们没有磁贴。如果您将程序固定到“开始”，它看起来很糟糕......我想为他们制作一个全尺寸的地铁风格图标。

这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-22T22:10:58.800

[http://forum.xda-developers.com/showthread.php?t=1899865](http://forum.xda-developers.com/showthread.php?t=1899865)

说够了！它有能力做你想做的事。希望这对其他人也有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T08:50:16.120

我也想这样做。到目前为止，我所做的是创建我使用的桌面程序的白色简单版本。将它们指定为快捷方式的图标。像这样，它看起来有点像地铁瓷砖，但瓷砖没有花哨的颜色，而且图像总是缩小比例。

我不认为您可以为您的桌面应用程序创建 Metro 启动器应用程序。我引用：

> 所有 Metro 应用都需要经过认证，只有 Windows 8 Enterprise 可以使用未经认证的 Metro 应用。Windows 8（Metro 风格）应用部署。运行 Windows 8 Enterprise 的加入域的 PC 和平板电脑将自动启用“旁加载”内部的 Windows 8 Metro 风格应用程序，绕过 Windows 应用商店

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T19:35:25.550

您可以制作一个简单地打开 chrome.exe 进程的 VS2012 Metro 应用程序，然后自定义磁贴。

# c# - 可以在 C# 的 if-else 语句中定义类似“between”的内容吗？

> ID：12288206
> 
> 赞同：12
> 
> 时间：2012-09-05T19:10:46.747
> 
> 标签：c#

我想问一个比我C#技能更强的人。

是否可以减少以下代码

```
if(val > 20 && val < 40 )
...
else
if(val > 40 && val < 72 )
...
else
if(val > 72 && val < 88 )
...
else
... 
```

假设我有超过 10-11 条`if-else`语句。

缩短上述代码的最佳方法是什么？

我想到了类似`between`sql 的东西。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-09-05T19:15:55.850

定义一个[扩展方法](http://msdn.microsoft.com/en-us/library/bb383977.aspx)：

```
public static bool Between(this int source, int a, int b)
{
    return source > a && source < b;
} 
```

然后，使用它：

```
if (val.Between(20, 40))
//... 
```

* * *

正如 oɔɯǝɹ 在他的评论中正确指出的那样，您可以更进一步，[`IComparable<T>`](http://msdn.microsoft.com/en-us/library/4d7sx9hd.aspx)使用通用扩展方法支持所有实现者：

```
public static bool Between<T>(this T source, T a, T b) where T : IComparable<T>
{
    return source.CompareTo(a) > 0 && source.CompareTo(b) < 0;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-05T19:21:47.280

另一种方法是将您的范围存储在 List 中并使用 Contains 函数来确定 val 是否在范围内，但如果没有更多信息，它看起来就像您尽可能短的一样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T20:10:51.527

在我看来，收集范围是件好事。如果块内的逻辑非常相似，您可以存储与此范围关联的委托。

```
RangeBase range = collection.FirstOrDefault(x => x.BelongsToRange(42));
if(range != null)
{
    dynamic result = range.SomeDelegate.DynamicInvoke();
} 
```

其中 RangeBase 是一个简单的抽象：

```
public abstract class RangeBase
{
    public int MinValue { get; private set; }
    public int MaxValue { get; private set; }

    public abstract Delegate SomeDelegate { get; }

    protected RangeBase(int minValue, int maxValue)
    {
        MinValue = minValue;
        MaxValue = maxValue;
    }

    public bool BelongsToRange(int number)
    {
        return number > MinValue && number < MaxValue;
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-05T19:22:22.787

您可以在两者之间进行，但如果不是更多的打字来调用它，它也会一样多。在这种情况下，如果你真的想要做什么`between`，那么你会更简洁：

```
if(val >= 20 && val <= 88)
{
  if(val <= 40 )
  ...
  else if(val <= 72 )
  ...
}
else
 ... 
```

请注意，我正在使用`<=`and`>=`来匹配 between 行为。但是，我假设您确实既不想为值做两件事`40`，`72`也不想做任何事情（在您的问题中，什么都不会做）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-05T19:28:43.523

```
class Range{ public int first; public int second}

list<Range> rangeList= new list<Range> 
```

将所有组合写入列表中的类

```
foreach( Range objRange in rangeList)
{
if( val>objRange.first && val<objRange.last)
{......
break;
}
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-09-05T19:15:15.093

```
if(val > 72)
{

}
else 
{
   if(val > 40)
   {
     ...
   }
   else
   {
     ...   
   }
} 
```

# json - 将 NSArray 添加到 json

> ID：12288211
> 
> 赞同：0
> 
> 时间：2012-09-05T19:10:57.797
> 
> 标签：json, nsmutablearray, request, nsarray

我在创建 json 时遇到了一些问题，它有一些简单的字段和`NSArray`. 我有`NSMutableDictionary`我想要转换的参数。

```
param = {
controller = Analytics;
method = saveAnalytics;
timeParameters =     {
    data =         (
                    {
            "device_id" = 56;
            "step_id" = 1;
            "step_time" = 1;
            time = 1346869802;
            udid = "00000000-0000-1000-8000-000C292A9593";
            "user_id" = 1;
        },
                    {
            "device_id" = 56;
            "step_id" = 6;
            "step_time" = 1;
            time = 1346869802;
            udid = "00000000-0000-1000-8000-000C292A9593";
            "user_id" = 1;
        }
);
    token = 4217bd9d1fbdb693ef4d360a8766ec94923ad273a14440f22071b59b243f0db5;
}; 
```

这就是我必须得到的。

```
[controller] => Analytics
[method] => saveAnalytics
[parameters] => Array
   (
       [token] => 6fa97f6f5cc5e0de4e98f17de2acad5d52485be0df6f1da1a81726f6bbdf9a74
       [data] => Array
           (
               [0] => Array
                   (
                       [device_id] => 60
                       [step_id] => 1
                       [step_time] => 1
                       [udid] => 00000000-0000-1000-8000-000C292A9593
                       [user_id] => 13
                       [time] => 1346769966
                   )

               [1] => Array
                   (
                       [device_id] => 60
                       [step_id] => 5
                       [step_time] => 2
                       [udid] => 9b86e254
                       [user_id] => 13
                       [time] => 1346661111
                   )

               [2] => Array
                   (
                       [device_id] => 60
                       [step_id] => 20
                       [step_time] => 3
                       [udid] => 9b86e254
                       [user_id] => 13
                       [time] => 1346661111
                   )

               [3] => Array
                   (
                       [device_id] => 60
                       [step_id] => 20
                       [step_time] => 3
                       [udid] => 9b86e254
                       [user_id] => 13
                       [time] => 1346661111
                   )

           )

   ); 
```

但我只得到 -

```
[controller] => Analytics
[method] => saveAnalytics
[parameters] => (
"token=877cec7e45465ce48dd06aa58b42c502c23fe2111b21770a5d9b6092bb939ea8",
   data = (
           0 = (
       "user_id=1",
       "device_id=56",
       "step_time=1",
       "time=1346781516",
       "step_id=1",
       "udid=00000000-0000-1000-8000-000C292A9593"
   ), 
```

对于第一行我做。

```
[paramArray addObject:[NSString stringWithFormat:@"%@=%@", key, [params objectForKey:key]]]; 
```

对于其他行，我使用了类似的转换，但结果失败了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T19:19:12.823

你不能这样做。数组不是字典——您不能只将键值对设置到数组中。您一定忽略了一些东西——字典中应该有一个数组，或者应该有一个字典而不是数组。

# git - git update-index --assume-unchanged 对目录

> ID：12288212
> 
> 赞同：114
> 
> 时间：2012-09-05T19:10:58.040
> 
> 标签：git, command-line, pipe

混帐 1.7.12

我想将给定目录下的所有文件标记为假设不变。

1.  `git update-index --assume-unchanged dir/`给出“忽略路径”。

2.  `git update-index --assume-unchanged dir/*`很快失败，因为它会遇到未被跟踪的文件，因此它给出“致命：无法标记文件”并退出。

3.  尝试生成要标记的文件列表。 `cd`进入所需目录，然后运行`git ls-files | tr '\n' ' ' | git update-index --assume-unchanged`​​. 这不会产生错误消息，但不会成功标记文件。命令的第一部分`git ls-files | tr '\n' ' '`正确地生成了一个空格分隔的列表，其中包含我要标记的所有文件。如果我将该命令的输出复制并粘贴到命令行，则该`git update-index`命令有效。什么是管道不工作？

`dir`不，我添加到 .gitignore是不够的。我需要将这些文件放在存储库中，但是将在本地进行不需要的更改，这些更改需要被忽略，以便用户可以进行拉取。

* * *

## 回答 #1

> 赞同：198
> 
> 时间：2012-09-05T20:03:36.997

`git update-index`想要文件名在它的命令行上，而不是在它的标准输入上。

## 步骤1：

`cd`进入您要假设的文件夹不变

## 第2步：

你可以这样做：

```
git update-index --assume-unchanged $(git ls-files | tr '\n' ' ') 
```

或者

```
git ls-files | tr '\n' ' ' | xargs git update-index --assume-unchanged 
```

尽管在任何一种情况下，带有空格的文件名都会有问题。如果你有这些，你可以使用这个：

```
git ls-files -z | xargs -0 git update-index --assume-unchanged 
```

编辑：合并来自@MatthewScharley 关于`git ls-files -z`.

### Windows 命令

> **注意：**如果您使用的是 Windows，请使用*Git Bash*运行这些命令

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2013-08-07T18:56:21.060

`find`来自 GNU Findutils的命令有一个`-exec`选项可以消除使用的大部分麻烦`xargs`，尽管它的语法有点特殊。但是，它确实可以完美地处理带有空格的文件名。

此命令将使 git 假定列出的目录中和下的所有文件都未更改：

```
find path/to/dir -type f -exec git update-index --assume-unchanged '{}' \; 
```

Find 接受`-exec`until之后的每个参数`;`（您必须转义以免您的外壳吃掉它）并为找到的每个文件运行一次，同时用`{}`找到的文件名替换（再次单引号，这样您的外壳就不会吃掉它）。

使用`find`的匹配条件（最大递归深度，匹配是文件还是目录，文件名是否匹配表达式），`-exec`您可以做各种强大的事情。

不确定该`find`命令的其他实现。YMMV。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2015-10-06T13:06:13.400

将目录名称添加到`.git/info/exclude`. 这适用于未跟踪的文件。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-05-17T14:11:17.040

Yeap,

```
git update-index --assume-unchanged 
```

works with files only, not with directories. I think, one of faster ways:

```
cd dir
ls | xargs -l git update-index --assume-unchanged 
```

# apache - Mod_rewrite 麻烦（容易？）

> ID：12288213
> 
> 赞同：1
> 
> 时间：2012-09-05T19:11:04.273
> 
> 标签：apache, .htaccess, mod-rewrite

我正在尝试使用 Zend Studio 在 PHP 网站上工作。.htaccess 文件中有大量的 mod_rewrite 规则。这些规则之一如下：

```
RewriteCond %{HTTP_HOST} ^mysite\.com
RewriteRule ^(.*)$ http://www.mysite.com/$1 [R=301]
RewriteRule ^/?$ /fitch/index.php?cmd=homepage [NC,L,QSA] 
```

我想在我的本地 Apache-Zend 服务器上运行这个网站。我试图在下面创建一个附加规则，如下所示：

```
RewriteCond %{HTTP_HOST} ^localhost
RewriteRule ^(.*)$ http://localhost/$1 [R=301]
RewriteRule ^/?$ /fitch/index.php?cmd=homepage [NC,L,QSA] 
```

我想让它这样，如果服务器被赋予`http://localhost/index.php`它重定向到的 url`http://localhost/fitch/index.php?cmd=homepage`

但似乎有一些错误，因为我无法重新启动 Apache。如果有人可以帮助我，我将不胜感激！

# jquery - jquery 的多个选择器

> ID：12288216
> 
> 赞同：3
> 
> 时间：2012-09-05T19:11:10.617
> 
> 标签：jquery

我的选择器需要两个条件才能成立。我希望听众听到以下按钮的事件。我当前的选择器不起作用：

html:

```
 <div class="myclass" data="mydata">
          <button>1</button>
          <button>2</button>
          <button>3</button>
        </div> 
```

javascript（不起作用）：

```
 $('body').on('click.myListener', '[data^=mydata] .myclass > button  ', function (e) {}) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-05T19:12:50.720

`attribute`删除和选择器之间的空格`class`：

```
$('body').on('click.myListener', 'div[data^=mydata].myclass > button', function (e) {}) 
```

# android - 即使我在设置中关闭了触摸振动，为什么我的安卓应用程序仍然振动？

> ID：12288217
> 
> 赞同：1
> 
> 时间：2012-09-05T19:11:10.967
> 
> 标签：android, android-vibration

只是在我的 android 应用程序中测试振动权限。
我已经让它做了一些很好的触觉反馈。

奇怪的是，当我关闭手机*的触摸振动*设置时，主页和返回按钮停止振动，但我的应用程序仍然允许振动。这是为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-07T08:13:38.320

您可能需要在设置中关闭“自动”触觉反馈。

# ios - 在 didEnterBackground 之后如何继续 UIImageView 动画？

> ID：12288221
> 
> 赞同：0
> 
> 时间：2012-09-05T19:11:35.060
> 
> 标签：ios, animation, uiimageview, calayer

我有一个简单的 UIImageView ( `myimageview`) 加载了 NSArray( `animationArray`) 的动画图像（在我的`ViewController.m)`：

```
[self.myimageview setAnimationImages:self.animationArray];
[self.myimageview setAnimationDuration:[self durationTime]];
[self.myimageview setAnimationRepeatCount: 1];
[self.myimageview startAnimating]; 
```

我知道在哪里使用 stopAnimating 等。但是我有一个奇怪的问题。当屏幕锁定时，我的动画没有任何反应。任何东西都像魅力一样。我解锁屏幕后它继续。

但是，当我的应用程序进入**后台模式**时，整个动画就会停止（我的动画时长为 2-3 分钟，因此这是不可接受的）。我搜索了一下，发现了这个主题：

[如何暂停 UIImageView 动画](https://stackoverflow.com/questions/253247/how-to-pause-a-uiimageview-animation)

它说使用此代码的地方：

```
UIView *viewBeingAnimated = //your view that is being animated
viewBeingAnimated.frame = [[viewBeingAnimated.layer presentationLayer] frame];
[viewBeingAnimated.layer removeAllAnimations];
//when user unpauses, create new animation from current position. 
```

现在我正在尝试在 AppDelegate.m 中将其实现到我的代码中

```
// in -(void)applicationDidEnterBackground:
self.viewController.myimageview.frame = [[self.myimageview.frenchPress.layer presentationLayer] frame]; 
```

但是我**在 XCode 中遇到了这个问题**（对于上面的行），我无法继续：

```
AppDelegate.m:40:47: Receiver type 'CALayer' for instance message is a forward declaration 
```

如果我退出到后台值，我会节省时间：（`self.currentDate`仅作为旁注，以防我们需要它）。

如何在不中断的情况下暂停和播放动画？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T19:14:35.420

为了访问 的所有消息和属性`CALayer`，您必须包含其相应的框架标头：

```
#import <QuartzCore/QuartzCore.h> 
```

这有望消除警告。

# php - 使用 Ajax 流式传输日志文件

> ID：12288225
> 
> 赞同：0
> 
> 时间：2012-09-05T19:12:09.093
> 
> 标签：php, ajax, ftp

我需要流式传输位于 FTP 上的日志文件，它来自远程服务器。

我不确定如何流式传输，可能使用 Ajax。

谷歌上有一些东西，但我似乎找不到可以访问远程 FTP 和流式传输文件的东西。

也许使用 Ajax 并使用间隔，然后向下滚动到页面底部。

请注意，日志文件会不断更新，人们也会向服务器发送命令，从而更新日志文件。每次刷新日志和下载日志会不会很慢？一些日志文件可能非常大。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T19:20:26.107

我认为您需要某种中间脚本来跟踪日志文件的最后读取行，并响应 AJAX 调用以及从那时起对文件的任何更新。

我的伪代码解决方案看起来像这样

*   读取本地缓存文件以获取最后处理的行号
*   计算文件中的行数（使用 linux`wc -l`或类似的）
*   根据差异（linux`tail -n X`或类似）计算文件中的最后X行数
*   使用读取的最后行号更新本地缓存文件。
*   将内容返回给调用者。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T20:10:09.360

停止使用文件系统并实现[发布-订阅者模式](http://en.wikipedia.org/wiki/Publish%E2%80%93subscribe_pattern)。有关参考实现，请参阅[loggly](http://www.loggly.com/)或[papertrail](http://www.papertrailapp.com)。

# c# - 带有鉴别器问题的 MongoDB 反序列化

> ID：12288226
> 
> 赞同：6
> 
> 时间：2012-09-05T19:12:18.363
> 
> 标签：c#, mongodb, deserialization

我有以下课程：

```
[BsonIgnoreExtraElements]
public class WidgetCollection
{
    [BsonId]
    public int AccountId { get; set; }
    public ReadOnlyCollection<Widget> Widgets { get; set; }
}

[BsonIgnoreExtraElements]
[BsonDiscriminator(RootClass = true)]
[BsonKnownTypes(typeof(OtherObject1), ...)]
public class Widget
{
    public ObjectId Id { get; set; }
    public string Title { get; set; }
    public int Position { get; set; }
    public WidgetKind Kind { get; set; }
    public bool IsActive { get; set; }
} 
```

数据库中此实例的示例：

```
{ "_id" : 2993644, "Widgets" : [        {       "_t" : "Widget",        "_id" : ObjectId("504797b327e10b1e80c838ac"),   "Title" : "My Notes",   "Position" : 1,         "Kind" : 0,     "IsActive" : true } ] } 
```

然后我有一个聚合命令，它过滤掉“Widgets”数组中的元素，只返回“IsActive”为真的元素。在这种情况下，该命令只返回整个对象。

```
var command = new CommandDocument
                        {
                            {"aggregate", "myCollection" },
                            {"pipeline", commandArray }
                        };

        var result = database.RunCommandAs<AggregateResult<WidgetCollection>>(command).Result;
        return result; 
```

这是 AggregateResult 类：

```
public class AggregateResult<T> : CommandResult
{
    public T Result
    {
        get
        {
           var result = Response["result"].AsBsonArray.SingleOrDefault().AsBsonDocument;
           return BsonSerializer.Deserialize<T>(result);
         }
     }
 } 
```

是的，我知道 SingleOrDefault().AsBsonDocument 可以处理 NRE，但这不是现在的问题。我已将代码调试到反序列化点，并验证“结果”变量包含与上面显示的完全相同的 BSON。我在尝试反序列化结果时收到此消息：“反序列化 Community.Widgets.WidgetCollection 类的 Widgets 属性时发生错误：预期元素名称为 '_v'，而不是 '_id'”。

为什么反序列化器需要一个 '_v' 元素？

**更新**
我通过将 Widgets 属性的类型更改为`ICollection`. 我现在收到这个错误：`Unknown discriminator value 'Widget'.`对我来说，这没有任何意义，因为文档有`"_t" : "Widget"`元素。

我还尝试插入一个派生类，之后“_t”元素的值现在`"[ "Widget", "DerivedClass"]`符合预期，我得到了同样的错误。同样，这在使用时不会发生`database.FindOneAs<>()`，只有在显式使用时才会发生`BsonSerializer.Deserialize<>()`。我尝试在调用之前添加此代码`Deserialize()`：

```
BsonClassMap.RegisterClassMap<Widget>(cm => { cm.AutoMap(); cm.SetIsRootClass(true); });
BsonClassMap.RegisterClassMap<RssFeedWidget>(); 
```

但是我不确定初始化代码应该放在哪里，而且我认为如果我在我的类上使用鉴别器属性，则不需要它。

**这是我的聚合命令**

```
BsonDocument documentMatch = new BsonDocument{{"$match", new BsonDocument{{"_id", documentId}}}};
BsonDocument unwindArray = new BsonDocument{{"$unwind", "$Widgets"}};
BsonDocument arrayMatch = new BsonDocument{{"$match", new BsonDocument{{"Widgets.IsActive", true}}}});

BsonArray commandArray = new BsonArray();
commandArray.Add(documentMatch);
commandArray.Add(unwindArray),
commandArray.Add(arrayMatch);
var command = new CommandDocument
                  {
                      {"aggregate", collectionName},
                      {"pipeline", commandArray}
                  }

var result = database.RunCommandAs<AggregateResult<WidgetCollection>>(command).Result; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T17:18:19.507

我无法重现此问题。我使用了以下程序。因此，由于我在这里使用了一个相对简单的管道，所以您的问题可能是您的聚合文档在映射后没有返回。你能发布你的聚合命令吗？

```
using MongoDB.Bson;
using MongoDB.Bson.Serialization;
using MongoDB.Bson.Serialization.Attributes;
using MongoDB.Driver;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Linq;

namespace TestConsole_Source
{
    class Program
    {
        [BsonIgnoreExtraElements]
        public class WidgetCollection
        {
            [BsonId]
            public int AccountId { get; set; }
            public ReadOnlyCollection<Widget> Widgets { get; set; }
        }

        [BsonIgnoreExtraElements]
        [BsonDiscriminator(RootClass = true)]
        public class Widget
        {
            public string Title { get; set; }
            public int Position { get; set; }
            public bool IsActive { get; set; }
        }

        static void Main(string[] args)
        {
            var server = MongoServer.Create();
            server.Connect();

            var db = server.GetDatabase("widgettest");
            var collection = db.GetCollection<WidgetCollection>("widgets");
            collection.Drop();

            var widgets = new WidgetCollection();
            var widget1 = new Widget { Title = "One", Position = 0, IsActive = true };
            var widget2 = new Widget { Title = "Two", Position = 1, IsActive = true };
            var widget3 = new Widget { Title = "Three", Position = 2, IsActive = false };
            widgets.Widgets = new List<Widget> { widget1, widget2, widget3 }.AsReadOnly();

            collection.Save(widgets);

            var command = new CommandDocument(
                new BsonElement("aggregate", "widgets"),
                new BsonElement("pipeline", new BsonArray(new [] {
                    new BsonDocument(
                        new BsonElement("$project", new BsonDocument("Widgets", 1)))})));

            var response = db.RunCommand(command);
            var rawDoc = response.Response["result"].AsBsonArray.SingleOrDefault().AsBsonDocument;

            var doc = BsonSerializer.Deserialize<WidgetCollection>(rawDoc);

            //Console.ReadKey();
        }
    }
} 
```

**更新：** 使用上面的新信息，我已更正您的聚合查询以使其正常工作。您需要使用一个组才能将结果恢复为与驱动程序期望的格式相同的格式。

```
 var command = new CommandDocument(
        new BsonElement("aggregate", "widgets"),
        new BsonElement("pipeline", new BsonArray(new[] {
            new BsonDocument(
                new BsonElement("$unwind", "$Widgets")),
            new BsonDocument(
                new BsonElement("$match", new BsonDocument("Widgets.IsActive", true))),
            new BsonDocument(
                new BsonElement("$group", new BsonDocument(
                    new BsonElement("_id", "$_id"),
                    new BsonElement("Widgets", new BsonDocument("$addToSet", "$Widgets")))))}))); 
```

即使这样可行，我仍然建议不要执行此过程并简单地过滤 Widgets 客户端。

# gradle - gradle 依赖管理默认使用最新的工件

> ID：12288230
> 
> 赞同：0
> 
> 时间：2012-09-05T19:12:28.323
> 
> 标签：gradle

我在 gradle docs 中读到

```
"Newest - used by default by Gradle - the newest version of the dependency is used. 
This strategy has been in Gradle since early days." 
```

然而，当我使用代码复制配置时，我看到不同版本的重复 jar

```
task('copyJars') { 
    //ext.collection = files { genLibDir.listFiles() }
    //delete ext.collection
    copy { from configurations.compile into genLibDir }
    //copy { from fixedLibDir into genLibDir }
} 
```

这是其中之一..

```
snakeyaml-1.6.jar
snakeyaml-1.7.jar 
```

这是最新的 1.1 gradle 下载

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T20:35:37.050

只有来自 Maven 或 Ivy 存储库的依赖项具有必要的元数据（pom.xml 或 ivy.xml），才会发生冲突解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T20:11:34.557

使用“最新”版本的 jar 时，似乎不支持这个...

```
compile fileTree(dir: project.ext.fixedLibDir, include: '*.jar') 
```

所以你必须自己手动做:(。

# python - 这个简单的 pygame 程序的错误在哪里？（sys.exit() 不工作）

> ID：12288234
> 
> 赞同：1
> 
> 时间：2012-09-05T19:12:56.217
> 
> 标签：python, sys

> **可能重复：**
> [Pygame 程序在退出时挂起](https://stackoverflow.com/questions/2027105/pygame-programs-hanging-on-exit)

运行这个简单的程序：

```
import pygame, sys

pygame.init()

screen = pygame.display.set_mode((800,600))

while True:
    #process input
    for event in pygame.event.get():
        if event.type == pygame.KEYDOWN:
            if event.key == pygame.K_ESCAPE:
                sys.exit() 
```

在 IDLE 中得到这个简单的消息：

```
Traceback (most recent call last):
  File "C:/Users/Aerovistae/Desktop/GD_in_class", line 12, in <module>
    sys.exit()
SystemExit 
```

程序停止响应，必须按Ctrl+Alt+Del。我看不出我在哪里出错了，这是我所能得到的最基本的。我正在关注教授在讲座中所做的事情，我看不出我的代码和他的代码有什么区别。谁能建议可能导致问题的原因？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T19:19:58.890

退出pygame的正确方法是调用

`pygame.quit()`

在主运行循环之后。

从 pygame 文档中阅读：http://www.pygame.org/wiki/FrequentlyAskedQuestions#In [IDLE 为什么 Pygame 窗口不能正确关闭？](http://www.pygame.org/wiki/FrequentlyAskedQuestions#In%20IDLE%20why%20does%20the%20Pygame%20window%20not%20close%20correctly?)

只需退出主运行循环而不是 sys.exit() 并结束程序。

# .net - 使 WCF Web 服务客户端适应更改的 WSDL 定义的最有效方法

> ID：12288235
> 
> 赞同：0
> 
> 时间：2012-09-05T19:12:56.463
> 
> 标签：.net, visual-studio-2010, wcf, web-services, wcf-client

我正在使用 .NET Visual Studio 2010 通过将服务引用添加到我的项目中来构建 Web 服务客户端。

现在我引用的 Web 服务实际上是我自己实现的，它最终将在我们的一台服务器上运行。在开发过程中，Web 服务仍然可能会发生变化，因为我们目前处于原型设计阶段。

因此我的问题是：一旦我更改了 Web 服务接口，即我在客户端项目中引用的 wsdl；那么更新客户端最简单的是什么 - 我可以以某种方式在该客户端项目中重新生成服务引用吗？假设我在 wsdl 中添加了一个新操作并引入了新的数据类型，那么从添加的服务引用中更新现在已经过时的生成代码而言，我最好的前进方式是什么？

并且引用实际的 wsdl 是最好的方法，而不是“在项目中发现服务”（添加服务引用对话框的选项之一）？

感谢你的帮助。

干杯，斯蒂沃

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T19:16:50.950

您只需右键单击服务参考并选择更新服务参考。

通常这很好用。有时我不得不删除并阅读参考，这总是有效的。

我从 .svc 文件中添加引用，而不是直接添加 wsdl。

# java - Java 静态工厂转换

> ID：12288244
> 
> 赞同：2
> 
> 时间：2012-09-05T19:13:54.510
> 
> 标签：java, concurrency, static-methods, static-factory

在我的客户端/服务器桌面应用程序上。我有这个问题，我应该如何使用我的模型正确编码我的 JDBC 类，以确保所有持久性请求都可以支持并发。`i.e., multiple models want to request update to its persistence counterpart simultaneously [without atmost delay].`

情节是这样的。遵循位于服务器应用程序中的类。

持久性包：

```
abstract class AbstractService {
  // other fields
  private final String tName, tId;
  private final String sqlStatement;
  public AbstractService(final String tName, final String tId) {
    this.tName = tName;
    this.tId = tId;
    this.sqlStatement = ""; // SELECT statement
  }
  // java.sql.Connection() createConnection()
  // methods
}
public class T1Service extends AbstractService {
  private final String sqlDMLStatements;
  public T1Service() {
    super("t1", "t1Id");
    this.sqlDMLStatements = ""; // other DML statements
  }      
  // methods having return types of List<E>, Object, Boolean, etc.
  // i.e., public List<E> listAll()
} 
```

通讯类【客户端类】

```
import java.net.*;
import java.io.*;
public class Client extends Observable{
  private Socket socket;
  private ObjectInputStream input;
  private ObjectOutputStream output;
  private Object message;
  // Constructor
  // Getters/Setters
  // Other methods like open or close input/output
  private class ReceiverRunnable implements Runnable
    @Override
    public void run() {
       while(running) { // if socket is still open and I/O stream are open/initialized
          try { message = input.readObject(); } 
          catch(Exception e) {}
          finally { setChanged(); notifyObservers(); }  
       } 
    }
  }
} 
```

主类【服务器类】

```
import java.net.*;
public class Server {
   private List<Client> clientList; // holds all active connections with the server
   private T1Service    t1Service
   private class ConnectionRunnable implements Runnable {
      @Override public void run() {
         while(running) { // serverSocket is open
           Client client = new Client(ServerSocket.accept(), /* other parameters */);
           client.addObserver(new ClientObserver(client));
           clientList.add(client);
         }
      } 
   }
   private class ClientObserver implements Observer {
      private Client client;
      // Constructor
      public void update(Observable o, Object arg) {
         // Check the contents of 'message' to determine what to reply
         // i.e., message.equals("Broadcast") {
         // synchronized(clientList) {
         //   for(Client element : clientList) {
         //     element.getOutput().writeObject(replyObject);
         //     element.getOutput()..flush();
         //   }
         // }
         // i.e., message.equals("T1") {
         // synchronized(t1Service) {
         //     client.getOutput().writeObject(t1.findAll());
         //     client.getOutput().flush();
         // }
      } 
   } 
} 
```

由于这是一个客户端/服务器应用程序，来自客户端的多个请求同时馈送到服务器。服务器处理请求，将适当的回复发送给适当的客户端。*注意：客户端和服务器之间发送的所有对象都是 java.io.Serializable 的实例。*

遇到这种情况并调查`Server.ClientServer.update()`我们可能会遇到性能问题，或者我应该说由于`Intrinsic Locks`. 但是由于我必须遵守规则`concurrency`并`synchronization`确保`Server.T1Service`不会对 N 个客户端请求的队列感到困惑。以下是问题：

1.  根据[Effective Java - Second Edition](http://java.sun.com/docs/books/effective/)的第 1 项`Static Factory`，这是否可以让我创建一个新的类引用来引用 Persistence 包的类中的方法？
2.  内部的每个`Client`元素`List<Client>`是否会形成一个并发问题，让 N 个客户端`message`同时更新其字段，从而触发`ClientObsver.update()`其中此观察者的引用对象只是父类中的单个实例。*由于内存问题，我避免创建 T1Service 的多个实例。*
3.  如果我们要通过 Effective Java - Second Edition 的内容，我怎样才能将我的持久性类转换为易于阅读、易于实例化并支持并发的方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T19:17:24.917

您可能还想查看 Actors，例如[Akka中的 Actors](http://doc.akka.io/docs/akka/snapshot/java/untyped-actors.html)

演员的基本思想是完全避免同步，使用发送事件。Akka 将保证一个actor永远不会被两个线程并行调用。所以你可以定义actor，它对全局变量做一些事情，然后简单地向它发送消息。

通常像魅力一样工作:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T19:29:48.240

> 我的 [Item 1] 静态工厂理论正确吗？

是的，您可以使用静态工厂而不是构造函数。通常这是当您的构造逻辑很复杂并且在各种子类型之间共享以保证工厂模式时。此外，工厂可以在 DI 框架之外提供依赖注入的方法。

> 那么它会解决转换后的静态工厂全局对象的并发问题吗？

如果您需要同步构造，那么静态工厂效果很好，只需`synchronized`在工厂方法的方法声明中添加即可。如果您需要同步对象本身的方法，那么这将无济于事。

> 如果在哪里处理对全局对象的并发访问以及在哪里需要实时访问每个全局对象的方法，我是否建议转换为静态工厂？

正如我上面回答的那样，这取决于您要达到的目标。对于构造函数同步，使用工厂。

# jquery - 使用 jQuery 验证引擎插件向表单字段添加类

> ID：12288246
> 
> 赞同：0
> 
> 时间：2012-09-05T19:14:03.300
> 
> 标签：jquery, addclass, jquery-validation-engine

我正在使用[jQuery 验证引擎](http://posabsolute.github.com/jQuery-Validation-Engine/)。我希望错误的表单字段以红色突出显示，并显示`tooltip-error`消息。我想我可以使用 jQuery 的`addClass`.

我的计划是添加一个类“错误”到紧随其后的任何输入字段`div.inputCreditCardformError`（即保存`tooltip-error`消息的 div。它在字段未验证时出现，并在字段验证后消失。

我的问题是：这个添加的类会在消失时`div.inputCreditCardformError`消失吗？或者添加的类会在页面的生命周期内保留在页面中吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T03:51:35.257

您无需修改​​ jQuery 验证引擎代码即可添加表单字段突出显示。初始化验证引擎时可以使用以下选项：`addFailureCssClassToField`和`addSuccessCssClassToField`.

例如：

```
$("#myForm").validationEngine({addFailureCssClassToField: "inputError"}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T19:20:52.473

如果您使用`.addClass('error')`，该类将保留。在字段有效后，您需要`.removeClass('error')`在代码中放置一个以删除该类。我没有查看代码，但它应该与删除工具提示窗口的代码一起使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T20:57:38.170

试试这个，

jQuery("#formID").validationEngine('attach', {addFailureCssClassToField: "inputError",promptPosition : "topLeft"});

```
.inputError{
    border: 2px solid #000;
} 
```

# sql - 无法合并时的 Oracle SQL 案例

> ID：12288247
> 
> 赞同：1
> 
> 时间：2012-09-05T19:14:09.190
> 
> 标签：sql, oracle, case-when

我们需要创建一个将这两个 SQL 语句组合在一起的视图。

```
SELECT g.state_cd, g.state_name, 
    case when s.ROLE_ID = 110 then 'Yes' else 'No' end  POC
    FROM us_state g
    LEFT OUTER JOIN role s ON g.state_cd = s.OFC_STATE_CD
    and s.role_id = 110 

    SELECT g.state_cd, g.state_name, 
    case when s.ROLE_ID = 120 then 'Yes' else 'No' end  ADM
    FROM us_state g
    LEFT OUTER JOIN role s ON g.state_cd = s.OFC_STATE_CD
    and s.role_id = 120 
```

例如。

一个用户将有多行。有些用户的角色 = 110，有些用户的角色 = 120，有些用户两者兼而有之。那么是否可以创建 1 个结合这两者的 SQL 语句。结果应该是：

```
MD Maryland Yes No
NY Newyork No Yes
NJ Newhersey Yes Yes 
```

上表暗示：

```
MD user has only role of 110
NY user has only the role of 120
NJ user has both roles. 
```

希望我清楚需要什么，这是有道理的。

我试图像这样组合它们：

```
SELECT g.state_cd, g.state_name, 
case when s.ROLE_ID = 110 then 'Yes' else 'No' end  POC,
case when s.ROLE_ID = 120 then 'Yes' else 'No' end  ADM
FROM us_state g
LEFT OUTER JOIN role s ON g.state_cd = s.OFC_STATE_CD
and s.role_id in (110, 120) 
```

但这不起作用，它返回重复的行。不知道我在这里缺少什么。如果有人可以提供帮助，我将不胜感激。

谢谢

哈里什

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T19:17:54.667

您需要汇总结果：

```
SELECT g.state_cd, g.state_name, 
       max(case when s.ROLE_ID = 110 then 'Yes' else 'No' end) as POC,
       max(case when s.ROLE_ID = 120 then 'Yes' else 'No' end) as ADM
FROM us_state g LEFT OUTER JOIN
     role s ON g.state_cd = s.OFC_STATE_CD and s.role_id in (110, 120)
group by g.state_cd, g.state_name 
```

事实证明，“是”和“否”与 MAX 配合得很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T19:36:44.970

这也是一种变体：

```
select state_cd, state_name
       ,case when (select count(*) from role r1 
               where r1.ofc_state_cd = s.state_cd 
                 and r1.role_id = 110) > 0 then 'YES' else 'NO' 
         end as POC
       ,case when (select count(*) from role r2 
               where r2.ofc_state_cd = s.state_cd
                 and r2.role_id = 120) > 0 then 'YES' else 'NO' 
         end as ADM
from us_state s; 
```

[http://sqlfiddle.com/#!4/161e7/8](http://sqlfiddle.com/#!4/161e7/8)

# firefox - Selenium webdrive 页面未加载 - 试图找到不可见的元素并等待

> ID：12288249
> 
> 赞同：1
> 
> 时间：2012-09-05T19:14:12.683
> 
> 标签：firefox, webdriver

嗨，我正在学习 Webdriver。我正在自动化的流程有 5 个屏幕。2 个屏幕，我能够使用 webdriver 进行导航。在第二个屏幕中输入详细信息并单击 ENTER 后，Webdriver 浏览器中没有加载第三个屏幕。

当我手动尝试此操作时，效果很好。我已经尝试了各种等待页面加载和搜索不可见元素的逻辑。

这是 webdriver 浏览器的一些限制吗？

```
 WebDriver driver = new FirefoxDriver();

   driver.get("url");         
  // Find the text input element by its name         
  WebElement element = driver.findElement(By.className("clicButton"));
   // Enter something to search for 
  element.click();
  System.out.println("completed start");
  WebElement element1 = driver.findElement(By.name("contactphone"));
  element1.sendKeys("number");          
  // Now submit the form. WebDriver will find the form for us from the element   
  //element1 = driver.findElement(By.id("the id"));
  //element1.click();
  element1.sendKeys(org.openqa.selenium.Keys.ENTER); 
  System.out.println("clicked continue");
  //WebDriverWait wait = new WebDriverWait(driver,10);
  //WebElement element2 = wait.until(driver.findElement(By.name("name")));

  //wait.until(driver.findElement(By.name("name")).isDisplayed());

  new WebDriverWait(driver, 60)
       .until(ExpectedConditions.presenceOfElementLocated (By.name("name"))); 
```

线程“主”org.openqa.selenium.TimeoutException 中的异常：60 秒后超时，等待存在以下元素：By.name：名称构建信息：版本：'未知'，修订：'未知'，时间：'未知'系统信息：os.name：'Windows XP'，os.arch：'x86'，os.version：'5.1'，java.version：'1.6.0_20'驱动程序信息：driver.version：在组织中未知。 openqa.selenium.support.ui.FluentWait.timeoutException(FluentWait.java:255) 在 org.openqa.selenium.support.ui.FluentWait.timeoutException(FluentWait.java:270) 在 org.openqa.selenium.support.ui。 FluentWait.until(FluentWait.java:222) at LoadUsers.main(LoadUsers.java:49) 原因：org.openqa.selenium.NoSuchElementException：无法定位元素：命令持续时间或超时：0 毫秒

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T16:34:30.160

几个选项：

1.  尝试使用 Keys.Return 而不是 Keys.Enter
2.  尝试在输入元素上而不是在提交按钮上执行 element1.SendKeys(Keys.Return) 。
3.  看看这个：[typing-enter-return-key-in-selenium](https://stackoverflow.com/questions/1629053/typing-enter-return-key-in-selenium)

# perl - VIM：在 ftplugin 中定义时，文件类型特定映射不起作用

> ID：12288250
> 
> 赞同：3
> 
> 时间：2012-09-05T19:14:18.447
> 
> 标签：perl, vim

我正在尝试为 FileType 设置映射`perl`。该映射适用于我忘记在行尾使用分号的情况。

所以首先我尝试在我的 .vimrc 中添加`autocmd! FileType perl nnoremap <leader>; $a;<esc>`它，它工作得很好，但我没有想到使用.vimrc `ftlugin/perl.vim`。

所以我在我的对应中添加了以下行`~/.vim/after/ftplugin/perl.vim`

```
nnoremap <buffer> <leader>; $a;<esc> 
```

但它没有用。

知道为什么它不起作用吗？

我的 perl 版本是`perl 5, version 14`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T19:56:05.867

尝试将文件放入`~/.vim/ftplugin/perl.vim`而不是`~/.vim/after/ftplugin/perl.vim`. 来自`:help after-directory`：

> ```
>  *after-directory*
> 4\. In the "after" directory in the system-wide Vim directory.  This is
>    for the system administrator to overrule or add to the distributed
>    defaults (rarely needed)
> 5\. In the "after" directory in your home directory.  This is for
>    personal preferences to overrule or add to the distributed defaults
>    or system-wide settings (rarely needed). 
> ```

来自`:help ftplugin`：

> 如果您确实想使用默认插件，但否决了其中一项设置，您可以在脚本中编写不同的设置：>
> 
> 设置本地文本宽度=70
> 
> 现在把它写在 "after" 目录中，这样它就可以在分发的 "vim.vim" ftplugin |after-directory| 之后获取。对于 Unix，这将是 "~/.vim/after/ftplugin/vim.vim"。请注意，默认插件将设置“b:did_ftplugin”，但此处将其忽略。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-16T15:16:46.087

我刚刚注意到让我发疯的一件事：`<buffer>`必须小写！出于习惯，我把我所有的`<BRACKET>`前缀都大写了……我对`<BUFFER>`. 我的 ftplugin 映射都不起作用，我无法弄清楚......直到我浪费时间尝试不同的东西，才发现它必须是小写`<buffer>`的。

# iphone - 多个重复视图的导航控制器设计

> ID：12288254
> 
> 赞同：0
> 
> 时间：2012-09-05T19:14:31.457
> 
> 标签：iphone, ios, uinavigationcontroller, modalviewcontroller

我很难理解我应该采取什么方法。我有一个带有问题列表的 TableView 控制器，如果您单击一行，它会推送一个新`QuestionViewVontroller`的显示`question`、`answers`和`next button`（或完成按钮）的行。当用户单击`next`我想加载下一个问题（从 tableview 列表中）但我仍然希望导航工作（后退按钮将带您到 TableView）。

我开始认为我应该保持不变`QuestionViewController`，只加载问题数据。这是正确的吗？或者我应该使用模态视图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T19:21:27.083

您在这里有几个选择。

1.  使用相同的 QuestionViewController 并重新填充它，就像你提到的那样。

2.  推送一个新的 QuestionViewController 并使用弹出到根视图控制器或弹出到给定视图控制器的自定义后退按钮。

＃2中两个选项的代码如下，其中“self”是当前视图控制器（您的问题控制器）。

```
[self.navigationController popToRootViewControllerAnimated:YES];  //this would pop to your UITableViewController, assuming it was the root

[self.navigationController popToViewController:yourTableViewControllerHere Animated:YES];  //this would work as long as you passed a reference to your UITableViewController to your question controllers 
```

由您决定如何选择解决您的问题。但是，如果您决定使用相同的 QuestionViewController，请在导入新问题时包含一个吸引人的动画，以便用户知道发生了什么并让您的应用程序更酷:)

# css - 主 div 不包含其他 div

> ID：12288264
> 
> 赞同：1
> 
> 时间：2012-09-05T19:14:53.650
> 
> 标签：css, html

一两天来我一直在寻找解决方案，但由于我不习惯编写 Web 应用程序，我似乎找不到问题所在。

我有一种预感，这与我确实将两个 div 浮动到左侧有关。

**问题是为什么我的主 div 不包含整个页面？**

这是我的html..！

```
<body onLoad="initializePage()">
<script type="text/javascript">
        $('#Button1').click(function() {

        });
    </script>
<input type="button" id="Button1" value="korv" onClick="hidedivs()" />
<div id="main">
    <div id="searchholder">
        <div id="slider" class="searching"></div>
    </div>
    <div class="left">
        <asp:Repeater ID="Repeater1" runat="server">
            <HeaderTemplate>
                <table id="mytable" cellspacing="0">
                <thead>
                    <tr>
                        <th scope="col" abbr="Sidor/Artiklar" class="nobg">Sidor/Artiklar</th>
                        <th scope="col" abbr="Mozrank">MozRank</th>
                        <th scope="col" abbr="PR">PR</th>
                        <th scope="col" abbr="Dual 1.8GHz">Fri tillgång</th>
                        <th scope="col" colspan="2" abbr="Dual 2.5GHz">Välj själv</th>
                    </tr>
                </thead>
            </HeaderTemplate>
            <ItemTemplate>
                <tr data_id='<%# DataBinder.Eval(Container.DataItem, "pr_domain")%>'>
                    <th scope="row" abbr="Model" class="spec"><%# DataBinder.Eval(Container.DataItem, "namn_domain")%> </th>
                    <td class="alt" ><%# DataBinder.Eval(Container.DataItem, "moz_domain")%></td>
                    <td class="alt"><%# DataBinder.Eval(Container.DataItem, "pr_domain")%></td>
                    <td class="alt"><b></b>
                        <input type='<%# DataBinder.Eval(Container.DataItem, "type_domain")%>' name='<%# DataBinder.Eval(Container.DataItem, "idtag_domain")%>' value='<%# DataBinder.Eval(Container.DataItem, "faccess_domain")%>' onClick="calculatePrice();disableTB(this.name);" />
                        "Fri tillgång" </td>
                    <td class="alt"><input type="radio" name='<%# DataBinder.Eval(Container.DataItem, "idtag_domain")%>' value="0"  onclick="calculatePrice();enableTB(this.name, this.checked)" />
                        "Skriv ditt antal själv" </td>
                    <td class="alt" data_id='<%# DataBinder.Eval(Container.DataItem, "pr_domain")%>'><input type="text"  name='<%# DataBinder.Eval(Container.DataItem, "moz_domain")%>' id='<%# DataBinder.Eval(Container.DataItem, "idtag_domain")%>'  Enabled="false" Width="40px" onKeyUp="calculatePrice()" style="background-color:#eeeeee" /></td>
                </tr>
            </ItemTemplate>
            <FooterTemplate>
                </table>
            </FooterTemplate>
        </asp:Repeater>
    </div>
    <div id="pricingdetails" class="price">Priset för dina artiklar blir: </div>
</div> 
```

我的 .css 样式是

```
.price
{
 font-family:"Verdana";
 font-size:40px;
 color:Green;
 float: left;
 border-right: 1px solid #C1DAD7;
 border-bottom: 1px solid #C1DAD7;
 border-top: 1px solid #C1DAD7;
 color: #797268;
 font: bold 10px "Trebuchet MS", Verdana, Arial, Helvetica, sans-serif;
 background: -moz-linear-gradient(center top , #FFFFFF 0%, #EDEDED 100%) repeat scroll 0 0 transparent;
 display: inline; 
 }

 div.searchholder
{
position: absolute;
top: 0px;
left: 50%;
margin-left: -70px;
width: 480px;    
}

div.main
{
}

div.left
{
float: left;  
}
.searching
{
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T19:17:38.907

这里的问题是，由于您内部的元素`#main` `div`是浮动的，因此它们被认为与您的流程不同`div`，因此它不会调整大小以适应它们。解决此问题的方法是：

*   添加`overflow: hidden;`到您的`#main`样式中。
*   `#main`通过添加浮动您的`float: left;`.
*   将此附加到您的`#main` `div`: `<div style = "clear: both;"></div>`（这是最不推荐的方法）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T19:59:52.353

您需要清除**#main的子元素的浮动**

不要做其他一些人建议的事情（添加一个元素来清除你的浮动；不好的做法），使用一个伪元素。只需使用以下 CSS，瞧！

```
#main::after {
 clear:both;
 content: "";
 display: table;
} 
```

[这是一个小提琴。](http://jsfiddle.net/ZPGds/)这个粉红色背景用于显示上述**#main**的结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T19:17:59.503

您的主 div ( `#main`) 尚未浮动，但您在其中有浮动元素。

要清除浮动添加 CSS：

```
#main {
    overflow: hidden;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-05T19:20:24.723

在结束标记之前添加一个清除。

```
<div style="clear:both"></div> 
```

# ruby-on-rails - 表格中的选择语句部分用于 HABTM 关联

> ID：12288268
> 
> 赞同：0
> 
> 时间：2012-09-05T19:15:05.677
> 
> 标签：ruby-on-rails, ruby-on-rails-3, has-and-belongs-to-many

我有两个模型`Client`和`Topic`. 两者之间都有 HABTM 关联。

我正在尝试`_form`在我的客户端视图中的部分添加一个选择语句，允许用户向客户端添加主题（或编辑该主题等）。

这是我的表单部分的样子：

```
<%= form_for(@client) do |f| %>

  <div class="field">
    <%= f.label :topic %><br />
    <%= f.select :topics, Topic.all.collect { |topic| [topic.name, topic.id] }, {:include_blank => 'None'} %>
  </div>

  <div class="actions">
    <%= f.submit %>
  </div>
<% end %> 
```

我得到的第一个错误是：

```
ActiveModel::MassAssignmentSecurity::Error in ClientsController#create

Can't mass-assign protected attributes: topics 
```

所以，在我的`Client`模型中，我添加了这个：

```
attr_accessible :email, :firm_id, :name, :phone, :topics 
```

这是我现在得到的错误：

```
NoMethodError in ClientsController#create

undefined method `each' for "1":String 
```

我的控制器的创建动作`Clients`非常标准：

```
 def create
    @client = Client.new(params[:client])

    respond_to do |format|
      if @client.save
        format.html { redirect_to @client, notice: 'Client was successfully created.' }
        format.json { render json: @client, status: :created, location: @client }
      else
        format.html { render action: "new" }
        format.json { render json: @client.errors, status: :unprocessable_entity }
      end
    end
  end 
```

`topics`这些是提交的参数（正在传递的通知- 而不是`topic_id`但`topic_id`也不起作用）：

```
{"utf8"=>"✓",
 "authenticity_token"=>"J172LuZQc5NYoiMSzDD3oY9vGmxxCX0OdxcGm4GSPv8=",
 "client"=>{"name"=>"Jack Daniels",
 "email"=>"jack.daniels@some-email.com",
 "phone"=>"2345540098",
 "firm_id"=>"2",
 "topics"=>"1"},
 "commit"=>"Create Client"} 
```

如何使用此 select 语句在创建客户端时将主题分配给我的客户端？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T19:24:09.150

设置“主题”属性时，客户端需要一个主题类的实例。

由于您正在传递 ID，因此您需要更改：

```
<%= f.select :topics, Topic.all.collect { |topic| [topic.name, topic.id] }, {:include_blank => 'None'} %> 
```

改为设置`topic_ids`：

```
<%= f.select :topic_ids, Topic.all.collect { |topic| [topic.name, topic.id] }, {:include_blank => 'None'} %> 
```

当然，在 attr_accessible 中：

```
attr_accessible :email, :firm_id, :name, :phone, :topic_ids 
```

# c - 从多个源文件构建内核模块

> ID：12288276
> 
> 赞同：3
> 
> 时间：2012-09-05T19:16:06.083
> 
> 标签：c, compiler-construction, makefile, kernel-module

我的存在的祸根 Makefile 遇到了一些麻烦。我正在尝试创建一个名为“can.ko”的内核模块（.ko 文件）。我正在编译十几个源文件：

```
TARGET = can
OBJS = can_core.o can_open.o can_select.o can_sysctl.o can_write.o can_close.o \
       can_ioctl.o can_read.o can_util.o can_debug.o can_error.o can_async.o
KDIR = /lib/modules/3.1.10-1.16-desktop/build
PWD := $(shell pwd)

obj-m += $(TARGET).o

default:
make -C $(KDIR) M=$(PWD) modules
$(TARGET).o : $(OBJS) 
```

编译器吐出它找不到。“can.c”。

```
make[4]: *** No rule to make target `/home/mike/iCOM-SDKv1.11.000/framework/drivers/can/can.c', needed by `/home/mike/iCOM-SDKv1.11.000/framework/drivers/can/can.o'.  Stop. 
```

我很确定我不需要在源文件之后命名输出对象，所以很明显有问题。我做了一些搜索，将多个源文件放在一起，发现这是另一种选择：

```
TARGET = can
can-objs := can_core.c can_open.c can_select.c can_sysctl.c can_write.c \
   can_close.c can_ioctl.c can_read.c can_util.c \
   can_debug.c can_error.c \
   can_async.c
KDIR = /lib/modules/3.1.10-1.16-desktop/build
PWD := $(shell pwd)

obj-m += $(TARGET).o

default:
make -C $(KDIR) M=$(PWD) modules 
```

这次我被告知它不知道如何处理 .c 文件：

```
LD [M]  /home/mike/iCOM-SDKv1.11.000/framework/drivers/can/can.o
/home/mike/iCOM-SDKv1.11.000/framework/drivers/can/can_core.c: file not recognized: File format not recognized 
```

任何人都可以帮我让这个东西工作吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T19:23:42.840

`can-objs`需要引用 .o 文件，而不是 .c 文件。

```
can-objs := can_core.o can_open.o can_select.o can_sysctl.o can_write.o \
    can_close.o can_ioctl.o can_read.o can_util.o \
    can_debug.o can_error.o \
    can_async.o 
```

# spring - 为 Spring JUnit 选择 Mocking 框架

> ID：12288278
> 
> 赞同：2
> 
> 时间：2012-09-05T19:16:29.443
> 
> 标签：spring, mocking, junit4

我在基于 Spring 的项目中工作。我的客户要求为我的服务和 DAO 层编写 JUnit 测试用例。
我必须对要使用的 Mocking 框架做出决定，并且尽快将其传达给客户。
我以前从未使用过任何 Mocking 框架。我在网上搜索时听说过 Mockito、JMock、EasyMock 等。但是没有得到任何令人信服的答案，我应该使用哪个。
所以，我需要一些帮助来选择正确的模拟框架。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T21:20:20.823

正如其他评论所说，对此没有明确的*正确*答案，但我绝对建议使用 Mockito，原因如下：

*   它提供了比大多数其他更好的错误描述。失败的验证将返回异常，准确解释发生了哪些其他调用、在何处以及使用了哪些参数，从而使调试变得非常简单。

*   与 EasyMock 等旧框架相比，它具有明显的优势：Mockito 创建并非常有效地实现了一个比 EasyMock、JMock 和其他人遵循的旧记录/重放/验证过程更好的模拟模型。这是非常直观且非常容易掌握的方法，并且可以使测试更加简洁和易于维护。

*   它的模型在许多其他语言（例如 Moq）中也直接流行起来，并且更接近于动态语言中的模拟风格。这使得找到其他熟悉它的人变得非常简单，并使您以后使用其他工具更容易。

*   它正在迅速成为 Java 项目中用于模拟的标准框架：我在许多公司的项目中进行自动化测试，我看到其中有相当多的公司已经在使用 Mockito，并且正在积极迁移到它。搜索“easymock mockito”会出现许多从 EasyMock 迁移到 Mockito 的结果，而在其他方向则没有。

[在https://code.google.com/p/mockito/wiki/MockitoVSEasyMock](https://code.google.com/p/mockito/wiki/MockitoVSEasyMock)上有更多关于 EasyMock 和 Mockito 之间确切区别的详细信息。

更一般地说，除非绝对必要，否则我会避免使用像 PowerMock 这样的框架。PowerMock 允许您模拟普通模拟框架不会模拟的代码库的各种元素，但是您需要模拟这些元素的事实通常是其他一些底层设计问题的有力指标。如果您发现自己无法在不使用 PowerMock 的情况下测试某些内容，您应该真正考虑是否可以重构被测试代码的结构（例如，摆脱对静态方法的依赖，更好地使用依赖注入来避免调用构造函数等） ）。

我还建议您阅读 Martin Fowler 对模拟的[出色介绍](http://martinfowler.com/articles/mocksArentStubs.html)。就所讨论的框架而言，这现在有点过时了，但仍然通过一些很好的例子对主要概念提供了一个非常好的概述。

# python - 编译python代码然后把它放在别的地方

> ID：12288280
> 
> 赞同：0
> 
> 时间：2012-09-05T19:16:45.350
> 
> 标签：python, compilation, cmake

我有 python 文件，例如，名为 blah.py，我想编译然后使用 cmake 将其放置到另一个文件夹中。现在，我可以在我的 cmake 文件中使用以下代码来执行此操作：

```
ADD_CUSTOM_TARGET(output ALL /usr/bin/python -m py_compile src/blah.py
                  COMMAND /bin/mv src/blah.pyc build VERBATIM) 
```

这是在 ubuntu 12.04 上。此代码按预期工作；唯一的问题是python文件正在源目录中编译，然后被放入构建目录中。

但是，我不能假设这个 src 目录将具有读写权限，这意味着我需要做的是将这两个命令合二为一（编译 python 文件并将编译好的 python 文件放入我的构建目录，而不是编译它在 src 目录中然后移动它）

我确定一定有某种方法可以用来指定我希望将此编译代码放置在哪里，但我找不到任何方法。帮助将不胜感激！:)

编辑：此链接可能有解决方案..不确定：

[编译的字节码文件（.pyc）可以在不同的目录中生成吗？](https://stackoverflow.com/questions/611967/can-compiled-bytecode-files-pyc-get-generated-in-different-directory)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T19:34:01.200

我正在输入这个答案，然后查看了您编辑的链接。在未接受的答案之一中给出了相同的答案：[https ://stackoverflow.com/a/611995/496445](https://stackoverflow.com/a/611995/496445)

```
import py_compile
py_compile.compile('/path/to/source/code.py', cfile='/path/to/build/code.pyc') 
```

要通过基本的 shell 命令调用它，您可以像这样格式化它：

```
python -c "import py_compile; py_compile.compile('/path/to/source/code.py', cfile='/path/to/build/code.pyc')" 
```

# python - 使用 Python 的 Flask 为 URL 创建一个“包罗万象”

> ID：12288285
> 
> 赞同：1
> 
> 时间：2012-09-05T19:17:04.787
> 
> 标签：python, flask

我想为我网站上的每个用户创建自定义 URL。我的应用程序对其内部页面使用某些自定义 URL：

```
/login
/gallery
/about
etc ... 
```

如何创建一个位于上述 url 之后的 url，并为函数 urlLookup() 提供它包含的字符串？我是否必须在视图文件的末尾声明这一点？

例如：

```
/First-Last 
```

我怎么能把它扩展到多个变量？

```
/First-Last/contact
/First-Last/album/photo-title 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T19:27:10.020

使用[url 变量](http://flask.pocoo.org/docs/api/#url-route-registrations)：

```
@app.route("/<full_name>")
def profile(full_name):
    # Lookup user by full name

@app.route("/<full_name>/<action>", defaults={"action": "contact"})
def act_on_user(full_name, action):
    # Lookup user and act on them 
```

# perl - perl 无法复制文件内容并打印

> ID：12288295
> 
> 赞同：1
> 
> 时间：2012-09-05T19:17:47.063
> 
> 标签：perl

我需要读取/复制文件（test.pl）的内容，就像它的格式和电子邮件一样。

我正在使用以下代码，但无法打印任何内容。

即使文件存在于同一目录中，我也会收到此错误。

```
Failed: No such file or directory 
```

代码：

```
#!/usr/bin/perl
use strict;
use warnings;
use DBI;

open my $fh, '<', 'test.pl '
    or die "Failed: $!\n";

my $text = do {
    local $/;
    <$fh>
};

close $fh
    or die "Failed again: $!\n";

print $text, "\n"; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-05T19:23:22.717

您尝试打开的文件名中似乎有一个额外的空格。在您的公开声明中，尝试更改`'test.pl '`为`'test.pl'`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T21:39:09.777

如果您要从 STDIN（用户输入）读取文件名，您可能需要使用正则表达式 (s/^\s+//....) 或`Text::Trim`其他验证来修剪它们。

# javascript - jquery 用 val() 复制值似乎删除了换行符

> ID：12288302
> 
> 赞同：0
> 
> 时间：2012-09-05T19:18:04.100
> 
> 标签：javascript, jquery, html

我想知道为什么当我将 textarea 的值 (id="t") 复制到另一个元素 (id="t_hidden") 时，javascript/jquery 会删除我的换行符 (\n)。

```
$('#t_hidden').val($('#t').val()); 
```

当我做某事时。价值 $('#t_hidden') 我认识到我的换行符已经消失了。有人知道为什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T19:21:27.880

目标元素是文本区域吗？如果不是，则可以复制换行符，但将其作为空格忽略。你需要用 a 替换它们`<br />`才能让它们工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-05T19:23:34.057

具有隐藏和文本框类型的元素因此没有换行符，当您设置值时它们将被删除。如果要保留换行符，请使用 textarea 并将显示设置为无。

# jquery - 如何通过 AJAX 初始化 SpringMVC 表单？

> ID：12288305
> 
> 赞同：0
> 
> 时间：2012-09-05T19:18:11.023
> 
> 标签：jquery, ajax, spring-mvc

例如，我想在用户单击页面中的“注册”按钮后才在 Controller 中执行“initRegister”方法

```
@Controller
public class UserController
{

    @RequestMapping(method=RequestMethod.GET, value="/initPage.do")
    public String initPage(Model model)
    {
        return "home.jsp";
    }

    @RequestMapping(method=RequestMethod.GET, value="/initRegister.do")
    @ResponseBody
    public void initRegister(Model model)
    {
        model.addAttribute("reg", new RegisterForm());
    }
} 
```

“注册”按钮调用的 JQuery AJAX：（显示一个用于注册的小弹出窗口）

```
$.get('initRegister.do', function()
            { 
               $('body').append('<div>'
                   +'<form:form method="POST" modelAttribute="reg" '
                   + 'commandName="reg" action="register.do">'
                   + 'name: <form:input path="name"/>'
                   + '<input type="submit" value="Submit">'
                   + '</form:form>'
                   + '</div>');
            }
      ); 
```

但是，当我访问“http://localhost:8080/.../initPage.do”时，在浏览器中出现以下错误

```
Neither BindingResult nor plain target object for bean name 'reg' available as request attribute 
```

该页面仅在我移动“model.addAttribute("reg", new RegisterForm());”时才有效 到“initPage”方法。但是在用户单击“注册”按钮之前，我不需要创建 RegisterForm 实例。

如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T22:24:54.717

我假设这段代码包含在 home.jsp 中

```
$.get('initRegister.do', function()
        { 
           $('body').append('<div>'
               +'<form:form method="POST" modelAttribute="reg" '
               + 'commandName="reg" action="register.do">'
               + 'name: <form:input path="name"/>'
               + '<input type="submit" value="Submit">'
               + '</form:form>'
               + '</div>');
        }
  ); 
```

你不能这样做。当 initPage.do 被渲染时，该`form:form`标记在服务器端进行处理，因为它是一个 JSP 标记并且在 javascript 或 html 中没有任何意义。我很惊讶你得到了和你一样有意义的信息。

渲染 JSP 时，它不关心标签是 HTML、javascript 还是任何地方。如果它看到一个 JSP 标记，它将执行适当的处​​理。试图将 JSP 代码呈现到 html 页面中以响应 AJAX 调用是行不通的，因为 JSP 标记的处理必须在服务器上进行。

通常，您会希望以 JSON 格式（或者我猜是 XML）返回一个对象并在 javascript 中使用它。查看[jQuery 的 get 命令](http://api.jquery.com/jQuery.get/)的文档。您的成功处理程序函数有一个“数据”参数，它将包含来自您的 Ajax 调用的响应。为了使它起作用，您应该将`initRegister`from的返回类型更改为`void`其他类型。您可以使用 Jackson 进行从 POJO 到 JSON 的转换。

# perl - 在 perl 中运行测试文件（.t 文件）时出错

> ID：12288306
> 
> 赞同：2
> 
> 时间：2012-09-05T19:18:12.180
> 
> 标签：perl

我正在尝试在 Test::Simple 模块的帮助下用 perl 编写我的第一个测试用例。`.t`现在，当我尝试运行此文件时，我已经保存了带有扩展名的文件，`windows system`然后它说`windows can not open this file`。

我对此进行了谷歌搜索，我发现要运行此文件，您应该创建一个名为 /t 的新目录并将此文件保存在那里。

[http://perlmeme.org/tutorials/writing_test_harness.html](http://perlmeme.org/tutorials/writing_test_harness.html)

我也试过这个，但它仍然不起作用。

任何机构都可以给我一些提示。

以下是我的测试用例：

```
 #!/usr/bin/perl -w

    use Test::Simple tests => 2;
    ok( 1 + 1 == 2 );
    ok( 2 + 2 == 5 ); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-05T19:23:35.757

Perl 中的 .t 文件只是一个 Perl 脚本。.t 只是为了让您知道它是一个测试脚本而不是其他东西。文件扩展名和目录结构并不重要，它只是为了帮助您保持环境清洁。

要在 Windows 上运行 Perl 脚本，只需从命令行键入`perl <script name>`. 确保您的系统上安装了 Perl 可执行文件，因为默认情况下 Windows 没有，并确保它在您的路径中。如果要运行的脚本不在当前目录中，请确保指定脚本的路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T20:11:23.630

在你给它的网址中说：

现在因为 'dot-T' 文件只是普通的 Perl 脚本，你可以这样运行它们 -

```
perl t/Monger.t 
```

这是您帖子中的错字吗，您将 /t 作为一个目录来保存您的测试文件 - 它应该是 t/，所以只是一个相对于您所在位置的目录。（这“只是”一个约定。）

# c# - 提高 C# 套接字性能

> ID：12288309
> 
> 赞同：2
> 
> 时间：2012-09-05T19:18:46.743
> 
> 标签：c#, performance, sockets, asyncsocket

我们有一个用 C# 编写的 TCP 异步套接字游戏服务器，服务于许多并发连接。除了以下问题外，其他一切正常：

1.  某些用户经常断开连接（并非所有人都介意）
2.  连接速度较慢的用户性能下降

大多数面临此问题的用户都使用 GSM 连接（基于 CDMA 的便携式 USB 加密狗），并且信号强度通常很差。所以基本上他们的带宽很差。可能低于每秒 1KB。

**我的问题：**我们可以做些什么来使连接更稳定并提高性能，即使是较慢的连接？

我正在考虑客户端和服务器端的动态 TCP 缓冲区，但不确定由于为我的方向的每个连接动态执行此操作的开销而导致的性能下降甚至是正确的。

最大数据包大小小于 1 KB。

服务器和客户端上的当前 TCP 缓冲区大小为 16KB

任何关于如何在 C# 中为连接不良或慢速编写稳定的 anync 套接字代码的指针或参考资料都会有很大帮助。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T20:12:01.890

“性能”是一个非常相对的术语。看起来您主要关心的是数据传输速率。不幸的是，考虑到低带宽连接，您对此无能为力——也许数据压缩会有所帮助，但实际效果取决于您的数据，并且在传输速率提高与压缩/解压缩延迟之间总是存在权衡。对于任何类型的互动游戏，还需要考虑延迟。

正如@Pierre 在评论中建议的那样，您可能会考虑使用 UDP 进行传输，但这只有在您可以容忍数据包丢失和重新排序的情况下才有效，这又取决于数据以及您对它的处理方式。

我建议调查的另一种方法是提供两种**不同的服务质量**模式。良好链接上的客户端可以使用完整的功能（例如，全分辨率游戏图像），而低带宽客户端将获得更少的选项（例如，尺寸小得多的低质量图像）。您可以测量客户端连接/握手的初始往返时间以选择模式。

希望这个对你有帮助。

# objective-c - 更改 NSWindow 标题的图标

> ID：12288311
> 
> 赞同：1
> 
> 时间：2012-09-05T19:18:59.270
> 
> 标签：objective-c, nswindow, nsdocument

我正在尝试使用在运行时更改文档窗口的代理图标

[[[自窗口] standardWindowButton:NSWindowDocumentIconButton] setImage:img];

这正在执行，但 info.plist 中的设置覆盖了它。

什么是正确的称呼。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T19:19:50.223

在您的`NSWindow`子类覆盖`setRepresentedURL`如下：

```
- (void)setRepresentedURL:(NSURL *)url
{
    [super setRepresentedURL:url];
    NSImage* img = ...
    [[self standardWindowButton:NSWindowDocumentIconButton] setImage:img];
} 
```

# r - 如何运行使用 III 型错误并查看成对比较的双向 ANOVA？

> ID：12288312
> 
> 赞同：5
> 
> 时间：2012-09-05T19:19:05.973
> 
> 标签：r, anova, tukey

我有一个数据集，我想用它来比较物种和栖息地对家庭范围大小的影响——同时在物种和栖息地内使用 III 型错误和成对比较。
这是数据的一个子集：

```
species<- c("a","b","c","c","b","c","b","b","a","b","c","c","a","a","b","b","a","a","b","c")
    habitat<-  c("x","x","x","y","y","y","x","x","y","z","y","y","z","z","x","x","y","y","z","z")
    homerange<-c(6,5,7,8,9,4,3,5,6,9,3,6,6,7,8,9,5,6,7,8)
    data1<-data.frame(cbind(species, habitat, homerange))
    data1$homerange<-as.numeric(as.character(data1$homerange)) 
```

目前我正在拆分三个物种的数据，然后为每个物种运行单独的 ANOVA，但我相信使用一个 ANOVA 同时询问物种和栖息地更有意义。这是我为一个物种运行的 ANOVA 示例：

```
data.species.a<-subset(data1, species=="a")
fit<-aov(homerange ~ habitat, data=data.species.a)
summary(fit)
TukeyHSD(fit) 
```

aov() 似乎使用 I 类错误。. . 我认为不合适；另外，我相信 Tukey 的测试对于成对比较来说可能过于保守。有人可以帮助我采用一种方法，让我运行一个 ANOVA，考虑物种和栖息地对家庭范围的影响，具有 III 型错误，还允许对物种和栖息地进行不太保守的成对比较？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-05T20:58:37.860

您可以`Anova`在包“car”中设置报告类型 III 的平方和，并且`HSD.test`包中的“agricolae”应该能够将该模型对象作为输入。我认为您不能在数据不平衡的情况下合法地使用 aov() ，所以我正在使用 lm() 拟合。

```
fit<-lm(homerange ~ habitat, data=data.species.a)
require(car)
 Anova(fit, type="III")
require(agricolae)
comparison <- HSD.test(fit, "habitat", group=TRUE) 
```

请注意，R 基础包的作者对 SAS 默认类型 III 平方和不屑一顾（有时甚至是彻底的嘲笑）（[阅读​​此](http://www.stats.ox.ac.uk/pub/MASS3/Exegeses.pdf)内容了解更多详细信息）。该方法在“汽车”包中的介绍主要是为了比较，而不是作为关于统计正确性的建议。

引用对接受 SAS 标准非常谨慎的原因： [Frank Harrell 的评论 re: loss of power](http://markmail.org/search/?q=list:org.r-project.r-help%20venables%20%20type-III#query:list:org.r-project.r-help%20venables%20%20type-III%20page:1%20mid:uxuc6iis4ji4okxb%20state:results)和[Bill Venables 在 r-help 的同一线程中的后来评论](http://markmail.org/search/?q=list:org.r-project.r-help%20venables%20%20type-III#query:list:org.r-project.r-help%20venables%20%20type-III%20page:1%20mid:gyte6fl3jkmteciq%20state:results)

# haskell - 逐行读取文件

> ID：12288318
> 
> 赞同：8
> 
> 时间：2012-09-05T19:19:53.443
> 
> 标签：haskell

我正在尝试逐行读取文件，但是当我到达 EOF 时，我不知道如何停止。

我有这个代码：

```
readWholeFile = do inputFile <- openFile "example.txt" ReadMode
                readALine inputFile

readALine x = do y <- hGetLine x
                 print y
                 readALine x 
```

它显然总是终止引发异常。

我该如何解决？

编辑：确切的错误信息是：

```
*** Exception: example.txt: hGetLine: end of file 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-09-05T19:32:52.167

另一种解决方案。您可以使用 延迟读取文件`readFile`，按需延迟拆分并逐行获取结果：

```
readLines :: FilePath -> IO [String]
readLines = fmap lines . readFile 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-05T19:29:22.297

您正在寻找的是，hIsEOF

查看[http://book.realworldhaskell.org/read/io.html](http://book.realworldhaskell.org/read/io.html)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-09-05T19:30:08.520

您可以[`hIsEOF`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/System-IO.html#v:hIsEOF)在读取一行之前手动检查 EOF 状态，或者您可以只使用现成的（惰性）[`readFile`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:readFile)功能。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-09-05T19:30:20.830

在进一步阅读之前，您可以使用 x 来测试句柄`hIsEOF`。读取行的第一个字符时遇到文件结尾时，hGetLine 失败

# php - PHP preg_replace & 符号

> ID：12288323
> 
> 赞同：2
> 
> 时间：2012-09-05T19:20:08.810
> 
> 标签：php, regex, preg-replace

好的，我可能不会以正确的方式进行此操作，但是这里有..

我有这个字符串，它需要一个链接并提取标签之间的文本......

```
$string = $item;
$pattern = '/\<a([^>]*)\>([^<]*)\<\/a\>/i';
$replacement = '$2';
$message = preg_replace($pattern, $replacement, $string); 
```

此字符串中有一些项目包含与号（在文本部分，而不是标签部分），但大多数都没有。我正在尝试找出一种方法将 & 符号合并到当前模式中，或者`$message`在标签被剥离后在 上执行另一个 preg_replace 以删除 & 符号。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-05T19:24:45.617

总有`$message = str_replace('&', '', $message);`

顺便说一句，如果您试图从 html 输入中去除标签，还有`strip_tags`

例如，如果您的输入是

```
$text = '<a href="google.com">Text</a>'; 
```

然后`strip_tags($text)`就会产生`Text`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T19:25:17.293

是否要删除 & 符号后的所有内容？然后就是

```
'/\<a([^>]*)\>([^<&]*)[^<]*\<\/a\>/i'; 
```

否则，您将需要进行第二次手术。

顺便说一句：您的正则表达式还将匹配以 开头的其他标签`<a`，例如`<author>`或`<audio>`标签。

# javascript - 如何让页面真正重新加载

> ID：12288325
> 
> 赞同：1
> 
> 时间：2012-09-05T19:20:18.903
> 
> 标签：javascript, ajax, greasemonkey, reload

我有一个 Greasemonkey 脚本（由另一个编码员 - Brock Adams 编写），它在代码开头按顺序加载包含在数组中的页面。 [如何自动按顺序打开页面列表？](https://stackoverflow.com/questions/12260455/how-to-open-a-list-of-pages-automatically-and-sequentially/12261238#comment16440466_12261238)

```
 // ==UserScript==
// @name        Multipage, MultiSite slideshow of sorts
// @include     http://google.com/*
// @include     http://site2/*
// @include     http://site3/*
// @include     http://site4/*
// @grant       GM_addStyle
// ==/UserScript==
/*- The @grant directive is needed to work around a major design
    change introduced in GM 1.0.
    It restores the sandbox.
*/

var urlsToLoad  = [
    'http://google.com/'
    , 'http://site2/somepage/'
    , 'http://site3/somepage/'
    , 'http://site4/somepage/'
];

/*--- Since many of these sites load large pictures, Chrome's and 
    Firefox's injection may fire a good deal before the image(s) 
    finish loading.
    So, insure script fires after load:
*/
window.addEventListener ("load", FireTimer, false);
if (document.readyState == "complete") {
    FireTimer ();
}
//--- Catch new pages loaded by WELL BEHAVED ajax.
window.addEventListener ("hashchange", FireTimer,  false);

function FireTimer () {
    setTimeout (GotoNextURL, 5000); // 5000 == 5 seconds
}

function GotoNextURL () {
    var numUrls     = urlsToLoad.length;
    var urlIdx      = urlsToLoad.indexOf (location.href);
    urlIdx++;
    if (urlIdx >= numUrls)
        urlIdx = 0;

    location.href   = urlsToLoad[urlIdx];
} 
```

当我要按顺序加载同一网站的 2 个页面时，问题就出现了：脚本停止工作，因为该网站使用 AJAX 以便更快地加载其页面。

如何强制此脚本完全重新加载页面？

如您所见，他已经尝试过：

```
//--- Catch new pages loaded by WELL BEHAVED ajax. 
window.addEventListener ("hashchange", FireTimer,  false); 
```

来解决这个问题，但它没有按预期工作。

特别是给我这个问题的网站是ink361.com。我创建了一个他的来源示例的 jsFiddle：http: [//jsfiddle.net/XjjfK/](http://jsfiddle.net/XjjfK/)

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T03:25:41.703

我无法登录，但该脚本对我来说非常有效。
我完全按照下面的方式安装了脚本，它在这 3 个 ink361.com 页面之间循环，正如预期的那样。

你要做/检查的一些事情：

1.  您是否在同一页面上使用[您的其他脚本（或任何其他 GM 脚本）？](https://stackoverflow.com/q/12252701/331508)

2.  当您浏览ink361.com 时，Greasemonkey 菜单显示什么？ ![通用菜单](../Images/16b817351206e170c5249fe24dc396e6.png)
    ![GM菜单结果](../Images/6a93c43b1a1ab1f640b7ce4c7d151531.png)

3.  听起来安装的脚本没有`hashchange`代码——应该可以在那个网站上运行，因为它*确实*更新了主题标签。

    1.  卸载脚本。
    2.  重启火狐。
    3.  重新安装脚本。

4.  [在pastebin.com](http://pastebin.com/)上发布准确的、未经编辑的脚本 - 您正在使用 -并在此处链接到它。

5.  卸载 ink361.com 的任何其他脚本，并仅安装以下脚本。
    它有效吗？
    如果没有，请在[pastebin.com](http://pastebin.com/)上发布控制台日志或 Firebug 的日志。

```
// ==UserScript==
// @name        _del me
// @namespace   _pc
// @include     http://ink361.com/*
// @grant       GM_addStyle
// ==/UserScript==
/*- The @grant directive is needed to work around a major design
    change introduced in GM 1.0.
    It restores the sandbox.
*/
console.log ("Start: ", Date ());

var urlsToLoad  = [
    'http://ink361.com/#/users/206053596/photos'
    , 'http://ink361.com/#/users/199101377/photos'
    , 'http://ink361.com/#/users/203767882/photos'
];

/*--- Since many of these sites load large pictures, Chrome's and
    Firefox's injection may fire a good deal before the image(s)
    finish loading.
    So, insure script fires after load:
*/
window.addEventListener ("load", FireTimer, false);
if (document.readyState == "complete") {
    FireTimer ();
}
//--- Catch new pages loaded by WELL BEHAVED ajax.
window.addEventListener ("hashchange", FireTimer,  false);

function FireTimer (zParam) {
    console.log ("Fire: ", zParam);
    console.log (Date ());
    setTimeout (GotoNextURL, 5000); // 5000 == 5 seconds
}

function GotoNextURL () {
    var numUrls     = urlsToLoad.length;
    var urlIdx      = urlsToLoad.indexOf (location.href);
    urlIdx++;
    if (urlIdx >= numUrls)
        urlIdx = 0;

    console.log ("Loading: ", urlsToLoad[urlIdx]);
    location.assign (urlsToLoad[urlIdx]);
} 
```

# ios - 常驻记忆不断增加

> ID：12288335
> 
> 赞同：1
> 
> 时间：2012-09-05T19:21:05.080
> 
> 标签：ios, memory-management, memory-leaks, automatic-ref-counting

我在内存管理方面遇到问题。我正在使用弧。我尝试在 viewdidunload 中将数组 oulet 设置为 nil，并在 dealloc 方法中尝试相同的方法。

当我使用仪器时它没有显示任何东西，我尝试使用此链接查找常驻内存 [Programmatically retrieve memory usage on iPhone](https://stackoverflow.com/questions/787160/programmatically-retrieve-memory-usage-on-iphone)

当我单击左表其他表刷新时，我有两个 uitableviewcontrollers 添加为视图子视图。

每次我点击一张表并刷新右边的表时，常驻内存就会增加 2MB。

我正在删除所有对象，但它仍在不断增加。

有没有人知道如何进行。我知道没有代码就什么都说不出来。我正在寻找可能是罪魁祸首的指南。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T19:38:16.267

使用堆射击分析。

*   1) 进入屏幕
*   2) 标记堆
*   3) 点击并刷新表格
*   4) 标记堆
*   5) 查看 Heap shot 结果

您可能需要多次执行此示例或序列以更好地了解增长。

这是 bbum 的一篇精彩文章：[http ://www.friday.com/bbum/2010/10/17/when-is-a-leak-not-a-leak-using-heapshot-analysis-to-find-不受欢迎的内存增长/](http://www.friday.com/bbum/2010/10/17/when-is-a-leak-not-a-leak-using-heapshot-analysis-to-find-undesirable-memory-growth/)

您也可以考虑使用 Leaks Instrument 查看您的 Cycles 和 Roots。

# sql - 如何消除表中两列的重复

> ID：12288336
> 
> 赞同：2
> 
> 时间：2012-09-05T19:21:17.187
> 
> 标签：sql, duplicates, row

我有这张桌子

```
CREATE TABLE T
(No1 INT,
 No2 INT
)

INSERT INTO T (No1, No2) VALUES (1, 2)

INSERT INTO T (No1, No2) VALUES (2, 1)

INSERT INTO T (No1, No2) VALUES (3, 4)

INSERT INTO T (No1, No2) VALUES (4, 3)

INSERT INTO T (No1, No2) VALUES (5, 6)

INSERT INTO T (No1, No2) VALUES (6, 5)

INSERT INTO T (No1, No2) VALUES (1, 6)

INSERT INTO T (No1, No2) VALUES (6, 1) 
```

* * *

```
 No1 No2
    1   2 
    2   1
    3   4
    4   3
    5   6
    6   5
    1   6
    6   1 
```

我想要的是消除具有相同值但在另一个字段中的行。对我来说 No1=1 No2=2 和 No1=2 No2=1 是一回事。最后我想要这个结果。

```
No1 No2
1   2
3   4
5   6
1   6 
```

我尝试了很多东西，我做了很多搜索，但我什么也没找到。我发现的唯一方法是使用光标。当我玩数百万条记录时，它非常慢。有没有办法通过查询来做到这一点？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T19:31:58.373

```
select t1.*
from MyTable t1
left outer join MyTable t2 on t1.No1 = t2.No2 and t1.No2 = t2.No1
where t2.No2 is null
    or t1.No1 <= t2.No1 
```

[SQL 小提琴示例](http://sqlfiddle.com/#!3/a46b9/6)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T19:32:04.977

Oracle 有两个非常有用的函数，LEAST 和 GREATEST：

```
select distinct least(no1, no2), greatest(no1, no2)
from t 
```

# java - 使用 jax-rs 处理批处理请求

> ID：12288340
> 
> 赞同：1
> 
> 时间：2012-09-05T19:21:28.443
> 
> 标签：java, json, api, request, jax-rs

我要解决的问题是处理服务器上的批处理请求。我在 Mac 上使用 JAX-RS Apache cxf，使用 JSON 进行序列化。我做了一些研究，发现批处理请求可以在服务器上以几种方式实现。

1.  批处理中的所有请求都是相似的，例如，ID 为 1 到 100 的 PUT。
2.  批处理中的所有请求都不同，例如，其中一些请求可能是 PUT、POST、GET...

我再次分析了需求，并意识到我需要实现第二个。我将问题分解为三个部分：使用批处理请求，在服务器上重建单个请求，并将它们分派到各自的 URI。

我的 API 层（路径：/batch）中有一个 POST 方法“handleBatchRequest”，并且我将 HttpRequest 子类化。方法“handleBatchRequest”使用单个请求的列表。第一部分有效。

我被困在第二部分，我找不到将请求从服务器分派到相应 URI 的方法。我不想绕过 API 层，直接将它们发送到内层。

如果有人以前遇到过类似的问题，任何指针将不胜感激。谢谢。

# android - Galaxy SIII 忽略 setDefaultZoom？更新：WebView 的 JellyBean 问题？

> ID：12288344
> 
> 赞同：1
> 
> 时间：2012-09-05T19:21:54.047
> 
> 标签：android, webview, android-4.2-jelly-bean

**更新：**这实际上是一个果冻豆问题：

运行 ICS 的模拟器： ![ICS 版本的 WebView](../Images/9f283dbbebe81d32282468fd259eb671.png)

运行 JB 的模拟器： ![JB版WebView](../Images/6869e82bb4ee0b2eb568b6ff56f52042.png)

所以模拟器设置是一样的（API级别明显不同）。在 3 种不同的设备上测试和验证：Nexus S、Galaxy Nexus 和 GS3。

我有一个显示几个不同网页的 webView 活动。我根据显示的 url 更改默认缩放设置。以下行：

`webSettings.setDefaultZoom(WebSettings.ZoomDensity.FAR);`

正在生成在 ICS 中看到的视图（我在 2.2-4.0.4 中得到相同的行为），但是对于 JellyBean，似乎 DefaultZoom 没有被识别。

还有人遇到这个吗？我觉得这是 JellyBean 的一个错误，但想在提交之前在这里查看。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-14T07:52:09.570

这是一个旧线程，但如果您仍然遇到同样的问题，我会找到一个为我解决类似问题的设置。该问题发生在三星平板电脑上的 Jelly Bean (4.1.2) 上。

```
webView.getSettings().setLayoutAlgorithm(WebSettings.LayoutAlgorithm.SINGLE_COLUMN); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T11:08:41.310

试试这个并告诉我它是否有效......它应该可以处理 fone 屏幕上的页面！

```
 WebView wv = (WebView) findViewById(R.id.webview);
    wv.getSettings().setLoadWithOverviewMode(true);
    wv.getSettings().setUseWideViewPort(true); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T01:58:29.787

我使用 getSettings().setUseWideViewPort(true) 在我自己的应用程序上“修复”了它。

然而，这是一种不当行为 - 在所有其他设备上看起来都是错误的。** 三星因破坏 API 的行为而感到羞耻 ** 设备正常工作：Galaxy Nexus、HTC One X 等。

# python - zookeeper python客户端手表真的很慢

> ID：12288345
> 
> 赞同：0
> 
> 时间：2012-09-05T19:22:10.303
> 
> 标签：python, apache-zookeeper

所以我最近想使用zookeeper（3.4.3）和python客户端（http://pypi.python.org/pypi/zc-zookeeper-static）设置一个配置服务器。

我注意到如果我只设置了一只手表，收到节点更改的通知会非常快。但是当我尝试从同一个会话中观看 100 个节点时，由于某种原因需要大约 2 分钟才能收到通知。这是我的 python 脚本： http: [//pastebin.com/BC6nKdRV](http://pastebin.com/BC6nKdRV)

zookeeper 服务器配置非常简单： `tickTime=2000 dataDir=/var/lib/zookeeper clientPort=2181 maxClientCnxns=0`

不知道我在这里做错了什么。任何建议都会很棒。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T01:49:40.287

原来是客户端的问题。kazoo 对每个会话的多个手表没有问题。我用 5000 块手表进行了测试，更改通知仍然几乎是即时的。[https://github.com/python-zk/kazoo](https://github.com/python-zk/kazoo)

# jquery - 使用 Jquery (Razor) 添加 Html 助手

> ID：12288348
> 
> 赞同：0
> 
> 时间：2012-09-05T19:22:18.810
> 
> 标签：jquery, html, asp.net-mvc-3, razor, html-helper

单击按钮时，我需要添加一个@Html.HiddenFor

我的jQuery代码是这样的：

```
function btnAdd() {

var x;
y = $("#drpDwnPRTPP");  

$("#budgetsList ul").html('<li>Primer elemento ' +
'@Html.HiddenFor(x => Model.ToList()['+ c +'].PRTPP_ID, new { @id="prtppID"'+ c +', @value="'+ y.val() +'" })' +
'</li>'
   ); 
} 
```

但是当我点击这是我在我的 html 中得到的：

Primer elemento @Html.HiddenFor(x => Model.ToList()[0].PRTPP_ID, new { @id="prtppID"0, @value="1" })

而是一个输入元素

有什么办法吗？? ...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T19:32:47.707

HTML 助手是服务器端，Jquery 发生在客户端，所以你需要在客户端添加你的隐藏字段。请参阅：[堆栈溢出](https://stackoverflow.com/questions/2408043/jquery-create-hidden-form-element-on-the-fly)

# cassandra - Cassandra - 创建新的 ColumnFamily 时出现 NullPointerException

> ID：12288351
> 
> 赞同：3
> 
> 时间：2012-09-05T19:22:46.490
> 
> 标签：cassandra, cql

我遇到了这里描述的确切问题[https://issues.apache.org/jira/browse/CASSANDRA-4363](https://issues.apache.org/jira/browse/CASSANDRA-4363)但使用 Cassandra 1.1.2，cqlsh --cql3。

当我尝试创建列族时，我得到的错误是

```
Traceback (most recent call last):
  File "./cqlsh", line 1008, in perform_statement
    self.cursor.execute(statement, decoder=decoder)
  File "./../lib/cql-internal-only-1.0.10.zip/cql-1.0.10/cql/cursor.py", line 117, in execute
    response = self.handle_cql_execution_errors(doquery, prepared_q, compress)
  File "./../lib/cql-internal-only-1.0.10.zip/cql-1.0.10/cql/cursor.py", line 132, in handle_cql_execution_errors
    return executor(*args, **kwargs)
  File "./../lib/cql-internal-only-1.0.10.zip/cql-1.0.10/cql/cassandra/Cassandra.py", line 1583, in execute_cql_query
    self.send_execute_cql_query(query, compression)
  File "./../lib/cql-internal-only-1.0.10.zip/cql-1.0.10/cql/cassandra/Cassandra.py", line 1593, in send_execute_cql_query
    self._oprot.trans.flush()
  File "./../lib/thrift-python-internal-only-0.7.0.zip/thrift/transport/TTransport.py", line 293, in flush
    self.__trans.write(buf)
  File "./../lib/thrift-python-internal-only-0.7.0.zip/thrift/transport/TSocket.py", line 117, in write
    plus = self.handle.send(buff)
error: [Errno 32] Broken pipe 
```

有时我只是让 TSocket 读取 0 个字节。

服务器端日志也和 JIRA 票证中提到的一样。

```
ERROR [Thrift:12] 2012-09-05 12:06:10,999 CustomTThreadPoolServer.java (line 204) Error occurred during processing of message.
java.lang.RuntimeException: java.util.concurrent.ExecutionException: java.lang.NullPointerException
        at org.apache.cassandra.utils.FBUtilities.waitOnFuture(FBUtilities.java:373)
        at org.apache.cassandra.service.MigrationManager.announce(MigrationManager.java:188)
        at org.apache.cassandra.service.MigrationManager.announceNewColumnFamily(MigrationManager.java:139)
        at org.apache.cassandra.cql3.statements.CreateColumnFamilyStatement.announceMigration(CreateColumnFamilyStatement.java:83)
        at org.apache.cassandra.cql3.statements.SchemaAlteringStatement.execute(SchemaAlteringStatement.java:99)
        at org.apache.cassandra.cql3.QueryProcessor.processStatement(QueryProcessor.java:108)
        at org.apache.cassandra.cql3.QueryProcessor.process(QueryProcessor.java:121)
        at org.apache.cassandra.thrift.CassandraServer.execute_cql_query(CassandraServer.java:1237)
        at org.apache.cassandra.thrift.Cassandra$Processor$execute_cql_query.getResult(Cassandra.java:3542)
        at org.apache.cassandra.thrift.Cassandra$Processor$execute_cql_query.getResult(Cassandra.java:3530)
        at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:32)
        at org.apache.thrift.TBaseProcessor.process(TBaseProcessor.java:34)
        at org.apache.cassandra.thrift.CustomTThreadPoolServer$WorkerProcess.run(CustomTThreadPoolServer.java:186)
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
        at java.lang.Thread.run(Thread.java:662)
Caused by: java.util.concurrent.ExecutionException: java.lang.NullPointerException
        at java.util.concurrent.FutureTask$Sync.innerGet(FutureTask.java:222)
        at java.util.concurrent.FutureTask.get(FutureTask.java:83)
        at org.apache.cassandra.utils.FBUtilities.waitOnFuture(FBUtilities.java:369)
        ... 15 more
Caused by: java.lang.NullPointerException
        at org.apache.cassandra.utils.ByteBufferUtil.string(ByteBufferUtil.java:167) 
```

我尝试删除 /var/lib/cassandra 目录并重新启动服务器。我仍然得到错误。JIRA 中的此错误已标记为无法重现，已修复版本无。那么我该怎么做才能让我的 cassandra 再次工作呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T21:06:22.433

[https://issues.apache.org/jira/browse/CASSANDRA-4526](https://issues.apache.org/jira/browse/CASSANDRA-4526)表明这已在 1.1.3 中修复。我会升级（到 1.1.4，最新版本）。

# google-maps - 如何将其他样式应用于 StyledMapType (Google Maps API v3)

> ID：12288353
> 
> 赞同：1
> 
> 时间：2012-09-05T19:22:55.437
> 
> 标签：google-maps, google-maps-api-3

我有一个包含所有默认地图类型以及一些我自己的 StyledMapTypes 的地图。在运行时，我希望能够打开和关闭不同的道路类型，并将其应用于所有地图类型。如果我设置 MapOption 样式属性，它仅适用于默认地图类型。除了构造函数之外，没有其他方法可以访问或更改 StyledMapType 的 MapTypeStyles。

除了为 StyledMapType 和 Road/Highway 配置的每个组合创建一个新的 StyledMapType 之外，还有其他方法吗？

此方法不能很好地扩展：2 个样式化地图 * 2 个当地道路状态 * 2 个高速公路状态 * 2 个主干道状态 = 16 个 StyledMapTypes。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T22:11:14.653

`map.setOptions({ 'styles': styles });` 您可以通过查看 MapOptions 上的文档来设置样式： [https ://developers.google.com/maps/documentation/javascript/reference?hl=de#MapOptions](https://developers.google.com/maps/documentation/javascript/reference?hl=de#MapOptions)

这是一个相当完整的示例： http: [//gmaps-samples-v3.googlecode.com/svn/trunk/styledmaps/wizard/index.html （请参阅](http://gmaps-samples-v3.googlecode.com/svn/trunk/styledmaps/wizard/index.html)[http://gmaps-samples-v3.googlecode](http://gmaps-samples-v3.googlecode.com/svn/trunk/styledmaps/wizard/StyledMapWizard.js) 中的 setMapStyle-function [.com/svn/trunk/styledmaps/wizard/StyledMapWizard.js](http://gmaps-samples-v3.googlecode.com/svn/trunk/styledmaps/wizard/StyledMapWizard.js)）

此工具还可以帮助您更轻松地设置地图样式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T07:24:58.473

不幸`StyledMapType`的是，它是不可变的。请提交功能请求:-)

# javascript - 数据属性有大小限制吗？

> ID：12288355
> 
> 赞同：5
> 
> 时间：2012-09-05T19:23:01.257
> 
> 标签：javascript, html, custom-data-attribute

> **可能重复：**
> [HTML 属性的长度是否有限制？](https://stackoverflow.com/questions/1496096/is-there-a-limit-to-the-length-of-html-attributes)

我想使用数据属性在网页上的脚本之间传递 JSON。例如，一个 div 标签可能如下所示：

```
<div data-choices='{"name1":"Jack","name2":"Jeff"," name3":"Zoe"}'  /> 
```

例如，这类似于 dojo 工具包对选项所做的事情，但在我的情况下，JSON 字符串可能要长得多。

数据属性（W3C 推荐、浏览器限制等）是否有任何大小限制？

# bash - 创建 .deb 以安装 bash 脚本程序

> ID：12288357
> 
> 赞同：5
> 
> 时间：2012-09-05T19:23:06.330
> 
> 标签：bash, ubuntu, installation, debian, deb

我想知道以下是否可能。

我有一个 BASH 脚本，我想为某些人提供它，但我希望他们只需要“安装”程序而不是乱搞终端，所以我认为 .deb 会很酷。

那么“安装”会做什么呢？

简单的。我想将脚本和图标移动到一个文件夹（任何文件夹，但我想知道 Home 中有一些隐藏文件夹），然后运行一个脚本，该脚本在应用程序菜单中为第一个脚本创建一个启动器。似乎没有太多，但是对于我搜索过的内容，似乎没有很多信息...

我怎样才能做到这一点？

顺便说一句，我使用的是 Ubuntu 11.04。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T19:44:23.500

基本上（安装和）运行[`dh-make`](http://man.he.net/man8/dh_make)设置`debian/`目录，编辑生成的文件（主要是删除许多你不需要的，并在 中填写包描述和任何依赖项`debian/control`），然后.[`debuild`](http://man.he.net/man1/debuild)`-us -uc -b`

您可能还需要设置一个简单`Makefile`的 for`debian/rules`调用；它可能只需要一个`install`目标即可将二进制文件复制到`$(DESTDIR)/usr/bin`.

二进制文件安装到`/usr/bin`，你不应该尝试覆盖它。有一个菜单的方法是添加一个[`.desktop`文件](http://standards.freedesktop.org/desktop-entry-spec/desktop-entry-spec-1.0.html)。

一旦你有一个好的`.deb`，你将需要设置一个 repo 来分发它。最简单的解决方案可能是设置一个[launchpad.net](http://launchpad.net/)帐户并在那里创建一个个人 PPA。

找到有关这些主题的更多信息并不难，但当然，您需要知道要查找的内容。规范文档是[Debian 新维护者指南](http://www.debian.org/doc/manuals/maint-guide/index.en.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T01:19:33.373

在 youtube 上找到了这个视频，它完整地解释了为脚本或程序创建 *.deb 的过程，甚至提到了如何为 C 程序执行此操作。

[如何构建简单 *.deb 包的完整指南](http://www.youtube.com/watch?v=nhoRyd2CEVs&feature=my_watch_later_videos&%20list=WL6225713F0A272584)

顺便说一句，有一个错误，作者在制作 *.deb 期间没有注意到。*.desktop 文件中 EXEC 参数的路径在示例中是错误的。

# embedded - 用于嵌入式编程的微控制器

> ID：12288358
> 
> 赞同：2
> 
> 时间：2012-09-05T19:23:11.233
> 
> 标签：embedded, arm, microcontroller, cortex-m

我生活在一个不容易获得流行微控制器的国家。我能找到的唯一基于 arm 的是 STM32F4 Discovery 和 STM32VL Discovery。后者更便宜，因此更可取。

所以问题是，我在寻找正确的方向吗？这些微控制器是专门用于嵌入式编程的吗？（我是初学者）如果有人能让我朝着正确的方向前进，那将非常有帮助。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T19:45:28.057

很难准确回答这个问题，因为在一个微控制器或另一个微控制器之间的选择仅取决于您要解决的应用程序（并且您没有在问题中提供有关您的目标的更多信息）。

如果只是为了教育目的，STM32 探索板是 IMO 一个非常好的选择，因为它们很便宜而且你不需要任何其他硬件（如 JTAG 程序员）来开始使用它（你只需要一个外部电源）。

# internationalization - 在 IDEA IDE 中使用资源包

> ID：12288361
> 
> 赞同：3
> 
> 时间：2012-09-05T19:23:15.610
> 
> 标签：internationalization, intellij-idea, resourcebundle

我正在使用 IDEA IDE 创建 i18n。我创建了我的属性文件的英文版本，然后创建了一个俄语版本。但是当我运行我的 Web 应用程序时，我看到 `Ïðîñìîòð Íîâîñòè`的不是俄语文本。请告诉我 IDEA IDE 出了什么问题，或者资源包插件中是否存在错误。

**更新**

当我在 Eclipse 中编写 I18n 并在 Eclipse 资源包插件中将所有必要的字段填写为俄语而不是俄语文本时，我看到了类似这样的内容`u0443u0434u0430u043Bu0438u0442u044C`，但是当我启动我的应用程序时，它显示得很好。当我在 IDEA IDE 中启动项目时，使用这样的属性一切正常..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T19:33:44.427

我可以使用不同的语言（中文）重新创建您的问题......我刚刚在我的 IntelliJ IDEA 实例中尝试了这个（我正在运行 IntelliJ IDEA 11.1.3）。

我有一个 ResourceBundle，我将简体中文字符放入我的 Resource Bundle 中，如下所示：

**消息属性**

```
user.label=名称 
```

当我通过 IDEA 运行我的 Grails 应用程序时，我得到的是字符`??`而不是汉字`名称`

这是 IntelliJ 资源包编辑器的一个错误。这是问题的链接：

[http://youtrack.jetbrains.com/issue/IDEA-90460](http://youtrack.jetbrains.com/issue/IDEA-90460)

我知道它不会为您提供修复，但至少它向您解释了它为什么会发生以及为什么您看不到 Eclipse 的问题。

# java - Spring、MySQL 和 Hibernate 返回针对列“row_id”调整的超出范围值

> ID：12288363
> 
> 赞同：1
> 
> 时间：2012-09-05T19:23:25.187
> 
> 标签：java, mysql, hibernate, jpa

我正在使用 Spring、MySQL 和 Hibernate 返回针对列“row_id”调整的超出范围值，并且我试图在我的数据库中插入一行，但出现以下错误：

```
Hibernate: insert into school_visit (borough, comments, date_of_visit, district, follow_up_action, meeting_schedule, met_with, nt_user, reaction_of_chapter, region, school, time_of_visit, time_stamp, topics_members, topics_speaker, type_of_visit, visitor_fname, visitor_id, visitor_lname) values (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2012-09-05 15:13:41,692 [http-8080-1] WARN  org.hibernate.util.JDBCExceptionReporter - SQL Error: 0, SQLState: 22001
2012-09-05 15:13:41,692 [http-8080-1] ERROR org.hibernate.util.JDBCExceptionReporter - Data truncation: Out of range value adjusted for column 'row_id' at row 1 
```

下面是我正在使用的模型，您可以看到 row_id 设置为 @GeneratedValue 那么为什么会出现此错误。

下面是我的模型：

```
import java.io.Serializable;
import java.util.Date;

import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.Id;
import javax.persistence.Table;
import javax.validation.constraints.Size;

import org.hibernate.validator.constraints.NotEmpty;

@Entity
@Table(name = "school_visit")
public class VisitModel {

    public Long getRow_id() {
        return row_id;
    }

    public void setRow_id(Long row_id) {
        this.row_id = row_id;
    }

    public String getVisitor_fname() {
        return visitor_fname;
    }

    public void setVisitor_fname(String visitor_fname) {
        this.visitor_fname = visitor_fname;
    }

    public String getVisitor_lname() {
        return visitor_lname;
    }

    public void setVisitor_lname(String visitor_lname) {
        this.visitor_lname = visitor_lname;
    }

    public String getVisitor_id() {
        return visitor_id;
    }

    public void setVisitor_id(String visitor_id) {
        this.visitor_id = visitor_id;
    }

    public String getType_of_visit() {
        return type_of_visit ;
    }

    public void setType_of_visit(String type_of_visit) {
        this.type_of_visit = type_of_visit;
    }

    public String getDate_of_visit() {
        return date_of_visit;
    }

    public void setDate_of_visit(String date_of_visit) {
        this.date_of_visit = date_of_visit;
    }

    public String getBorough() {
        return borough;
    }

    public void setBorough(String borough) {
        this.borough = borough;
    }

    public String getSchool() {
        return school;
    }

    public void setSchool(String school) {
        this.school = school;
    }

    public String getDistrict() {
        return district;
    }

    public void setDistrict(String district) {
        this.district = district;
    }

    public String getMet_with() {
        return met_with;
    }

    public void setMet_with(String met_with) {
        this.met_with = met_with;
    }

    public String getTime_of_visit() {
        return time_of_visit;
    }

    public void setTime_of_visit(String time_of_visit) {
        this.time_of_visit = time_of_visit;
    }

    public String getReaction_of_chapter() {
        return reaction_of_chapter;
    }

    public void setReaction_of_chapter(String reaction_of_chapter) {
        this.reaction_of_chapter = reaction_of_chapter;
    }

    public String getFollow_up_action() {
        return follow_up_action;
    }

    public void setFollow_up_action(String follow_up_action) {
        this.follow_up_action = follow_up_action;
    }

    public String getMeeting_schedule() {
        return meeting_schedule;
    }

    public void setMeeting_schedule(String meeting_schedule) {
        this.meeting_schedule = meeting_schedule;
    }

    public String getComments() {
        return comments;
    }

    public void setComments(String comments) {
        this.comments = comments;
    }

    public String getTopics_speaker() {
        return topics_speaker;
    }

    public void setTopics_speaker(String topics_speaker) {
        this.topics_speaker = topics_speaker;
    }

    public String getTopics_members() {
        return topics_members;
    }

    public void setTopics_members(String topics_members) {
        this.topics_members = topics_members;
    }

    public Date getTime_stamp() {
        return time_stamp;
    }

    public void setTime_stamp(Date time_stamp) {
        this.time_stamp = time_stamp;
    }

    public String getNt_user() {
        return nt_user;
    }

    public void setNt_user(String nt_user) {
        this.nt_user = nt_user;
    }

    public String getRegion() {
        return region;
    }

    public void setRegion(String region) {
        this.region = region;
    }

    @Id
    @GeneratedValue
    @Column(name = "row_id")
    private Long row_id;

    @Size(max = 50)
    @Column(name = "visitor_fname", nullable = false)
    private String visitor_fname;

    @Size(max = 50)
    @Column(name = "visitor_lname", nullable = false)
    private String visitor_lname;

    @Size(max = 5)
    @Column(name = "visitor_id", nullable = false)
    private String visitor_id;

    @Size(max = 25)
    @Column(name = "type_of_visit", nullable = false)
    private String type_of_visit;

    @Size(max = 45)
    @Column(name = "date_of_visit", nullable = false)
    private String date_of_visit;

    @Size(max = 1)
    @Column(name = "borough", nullable = false)
    private String borough;

    @Size(max = 3)
    @Column(name = "school", nullable = false)
    private String school;

    @Size(max = 3)
    @Column(name = "district", nullable = false)
    private String district;

    @Size(max = 200)
    @Column(name = "met_with", nullable = false)
    private String met_with;

    @Size(max = 50)
    @Column(name = "time_of_visit", nullable = false)
    private String time_of_visit;

    @Size(max = 50)
    @Column(name = "reaction_of_chapter", nullable = false)
    private String reaction_of_chapter;

    @Size(max = 50)
    @Column(name = "follow_up_action", nullable = false)
    private String follow_up_action;

    @Size(max = 30)
    @Column(name = "meeting_schedule", nullable = false)
    private String meeting_schedule;

    @Size(max = 2450)
    @Column(name = "comments", nullable = false)
    private String comments;

    @Size(max = 2450)
    @Column(name = "topics_speaker", nullable = false)
    private String topics_speaker;

    @Size(max = 2450)
    @Column(name = "topics_members", nullable = false)
    private String topics_members;

    @Column(name = "time_stamp", nullable = false)
    private Date time_stamp;

    @Size(max = 50)
    @Column(name = "nt_user", nullable = false)
    private String nt_user;

    @Size(max = 3)
    @Column(name = "region", nullable = false)
    private String region;

    @Override
    public String toString() {
        return "VisitModel [row_id=" + row_id + ", visitor_fname="
                + visitor_fname + ", visitor_lname=" + visitor_lname
                + ", visitor_id=" + visitor_id + ", type_of_visit="
                + type_of_visit + ", date_of_visit=" + date_of_visit
                + ", borough=" + borough + ", school=" + school + ", district="
                + district + ", met_with=" + met_with + ", time_of_visit="
                + time_of_visit + ", reaction_of_chapter="
                + reaction_of_chapter + ", follow_up_action="
                + follow_up_action + ", meeting_schedule=" + meeting_schedule
                + ", comments=" + comments + ", topics_speaker="
                + topics_speaker + ", topics_members=" + topics_members
                + ", time_stamp=" + time_stamp + ", nt_user=" + nt_user
                + ", region=" + region + ", getRow_id()=" + getRow_id()
                + ", getVisitor_fname()=" + getVisitor_fname()
                + ", getVisitor_lname()=" + getVisitor_lname()
                + ", getVisitor_id()=" + getVisitor_id()
                + ", getType_of_visit()=" + getType_of_visit()
                + ", getDate_of_visit()=" + getDate_of_visit()
                + ", getBorough()=" + getBorough() + ", getSchool()="
                + getSchool() + ", getDistrict()=" + getDistrict()
                + ", getMet_with()=" + getMet_with() + ", getTime_of_visit()="
                + getTime_of_visit() + ", getReaction_of_chapter()="
                + getReaction_of_chapter() + ", getFollow_up_action()="
                + getFollow_up_action() + ", getMeeting_schedule()="
                + getMeeting_schedule() + ", getComments()=" + getComments()
                + ", getTopics_speaker()=" + getTopics_speaker()
                + ", getTopics_members()=" + getTopics_members()
                + ", getTime_stamp()=" + getTime_stamp() + ", getNt_user()="
                + getNt_user() + ", getRegion()=" + getRegion()
                + ", getClass()=" + getClass() + ", hashCode()=" + hashCode()
                + ", toString()=" + super.toString() + "]";
    }

} 
```

这是我的插入语句：

```
sessionFactory.getCurrentSession().saveOrUpdate(visit); 
```

所以我不明白为什么我会收到这个错误

这是我的 jdbc.pro 文件：

```
database.driver=com.mysql.jdbc.Driver
database.url=jdbc:mysql://dvdbm01.dev/svr_dev
database.user=jxxxx
database.password=xxxx
ibernate.dialect=org.hibernate.dialect.MySQL5Dialect
hibernate.show_sql=true 
```

这是我的数据库 xml 文件：

```
<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xmlns:jdbc="http://www.springframework.org/schema/jdbc"

       xsi:schemaLocation="http://www.springframework.org/schema/beans 
                            http://www.springframework.org/schema/beans/spring-beans.xsd
                            http://www.springframework.org/schema/context 
                            http://www.springframework.org/schema/context/spring-context-3.0.xsd
                            http://www.springframework.org/schema/tx
                            http://www.springframework.org/schema/tx/spring-tx-3.0.xsd
                            http://www.springframework.org/schema/jdbc
                            http://www.springframework.org/schema/jdbc/spring-jdbc-3.0.xsd">

  <context:property-placeholder location="classpath:jdbc.properties" />

  <context:component-scan base-package="org.uftwf" />

  <tx:annotation-driven transaction-manager="hibernateTransactionManager"/>

    <bean id="dataSource"
        class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
        <property name="driverClassName" value="${database.driver}" />
        <property name="url" value="${database.url}" />
        <property name="username" value="${database.user}" />
        <property name="password" value="${database.password}" />
    </bean>

    <bean id="sessionFactory"
        class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
        <property name="dataSource" ref="dataSource" />
        <property name="annotatedClasses">
            <list>
                <value>org.uftwf.schoolvisit.model.VisitModel</value>
                <value>org.uftwf.schoolvisit.model.NameID_lookupModel</value>
                <value>org.uftwf.schoolvisit.model.School_lookupModel</value>
            </list>
        </property>

        <property name="hibernateProperties">
            <props>
                <prop key="hibernate.dialect">${hibernate.dialect}</prop>
                <prop key="hibernate.show_sql">${hibernate.show_sql}</prop>             
            </props>
        </property>
    </bean>

    <bean id="hibernateTransactionManager"
        class="org.springframework.orm.hibernate3.HibernateTransactionManager">
        <property name="sessionFactory" ref="sessionFactory" />
    </bean>
</beans> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T12:42:33.873

可能是您尝试设置的值对于签名字段类型而言太大。
为了了解更多有关此的信息，请参阅...
[http://webomania.wordpress.com/2006/10/01/out-of-range-value-adjusted-for-column-error/](http://webomania.wordpress.com/2006/10/01/out-of-range-value-adjusted-for-column-error/)
干杯！！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T19:44:07.197

试试这个

> @GeneratedValue(strategy=GenerationType.IDENTITY)

另外，检查您是否使用了正确的 MySQL 方言。

# javascript - 从 iframe 事件中侦听

> ID：12288366
> 
> 赞同：1
> 
> 时间：2012-09-05T19:23:33.887
> 
> 标签：javascript, jquery, iframe, cross-domain

在我的页面（index.htm）上，我在一个模式内有一个 iframe，它从不同的域（不属于我）加载内容，即（pagex.htm）。

这个带有 (pagex.htm) 的 iframe 有一个 id 为 (#close) 的元素，它也有一个 onclick() 事件，如下所示：

```
<a id="close-lite" class="ch-close" onclick="closeRender();" href="#">×</a> 
```

在我的 index.htm 中，我有我的 jquery/javascript，我试图做的是访问 iframe 并获取点击事件以关闭我页面内的模式（所以我不尝试修改 iframe 内容）。我曾尝试使用 .content() 但尚未成功。

也许是跨域策略ussue？我怎样才能解决这个问题？

我怎么能用 javascript/jquery 做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T19:28:53.577

这`same-origin-policy`会阻止您收听 Iframe 中发生的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T20:59:15.663

可以使用 postMessage()。

[http://robertnyman.com/2010/03/18/postmessage-in-html5-to-send-messages-between-windows-and-iframes/](http://robertnyman.com/2010/03/18/postmessage-in-html5-to-send-messages-between-windows-and-iframes/)

但它并非在所有浏览器中都有效，并且需要双方的 init。

# css - Bootstrap-sass : bootstrap 中的字段集不能被覆盖

> ID：12288371
> 
> 赞同：3
> 
> 时间：2012-09-05T19:24:07.100
> 
> 标签：css, ruby-on-rails, twitter-bootstrap

我正在用 bootstrap-sass 设计一个 Rails 网络。导入引导程序，覆盖引导程序

```
***fieldset
{
padding: 0;
  margin: 0;
  border: 0;
}*** 
```

我在 bootstrap_and_overrides.css.scss /*bootstrap_and_overrides.css.scss*/ 中添加了一个新的字段集描述

```
@import "bootstrap";
.
.

fieldset {
  padding: 1;
  margin: 1;
  border: 1;
} 
```

但是，我的“字段集”定义被划掉了，引导程序“字段集”仍然有效。当我查看萤火虫时，我发现我定义的字段集在第 5252 行。引导程序“字段集”在第 742 行。

为什么后一个不能覆盖前一个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T20:10:52.810

您必须为您的值定义一个单位：像素、pt、em 等。

# oracle - Oracle Apex 外键形成

> ID：12288373
> 
> 赞同：0
> 
> 时间：2012-09-05T19:24:09.253
> 
> 标签：oracle, oracle-apex

我正在使用 oracle apex 4.0 构建应用程序。

我已经在表中创建了一个外键，我需要将所有可用的外键以及一些相关的属性提取到表单字段中，以便我可以从可用选项中选择一个（下拉类型的东西）。我怎样才能建立这个？

我希望我已经清楚了。

# iphone - 在新的 Storyboard 中从 Prototype Cell 打开 Safari

> ID：12288374
> 
> 赞同：0
> 
> 时间：2012-09-05T19:24:16.537
> 
> 标签：iphone, ios5

我在情节提要中定义的 ViewController 中有一个表格视图。tableview 有原型单元格。我希望当用户触摸单元格时，应该在 iphone 的外部 safari 中打开一个 url。如何做到这一点？我必须从那里调用以下行：

```
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:siteURL]]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T19:25:59.073

在将实例设置为表视图委托的类中：

```
- (void)tableView:(UITableView *)tv didSelectRowAtIndexPath:(NSIndexPath *)ip
{
    [[UIApplication sharedApplication] openURL:[NSURL URLWithString:siteURL]];
} 
```

# windows - 乌龟崩溃后打破锁定

> ID：12288375
> 
> 赞同：1
> 
> 时间：2012-09-05T19:24:17.120
> 
> 标签：windows, svn, tortoisesvn

当我在乌龟崩溃时提交一个文件夹时。我移动了代码，再次签出，再次粘贴我的修改文件并尝试提交。

我收到以下错误：

> 错误：提交失败（详细信息如下）：
> 错误：无法验证路径上的锁定错误：；没有可用的匹配锁定令牌
> 错误：如果您想解除锁定，请使用“检查修改”对话框或存储库浏览器。

我试图找到释放锁定按钮，但它没有出现。我尝试“检查修改”，然后右键单击“Break Lock”文件夹，但没有成功。我还尝试再次锁定文件，但出现错误：

> “错误：被文件系统 '...\repository\db' 中的用户 '' 锁定”

我可以删除删除svn文件夹中某些文件的锁吗？

编辑：当我试图做伯特告诉我的事情时，我的乌龟再次坠毁问题：

> 活动名称：BEX
> 
> 应用程序名称：TortoiseProc.exe
> 
> 应用程序版本：1.7.1.22161
> 
> 故障模块名称：saslDIGESTMD5.dll
> 
> 故障版本名称：2.1.24.0
> 
> 异常代码：c0000005
> 
> 调试错误：saslDIGESTMD5.dll!7333c86a() 未知

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-06T15:26:50.987

此错误与工作副本锁无关，而是与使用显式获得的锁有关`svn lock`

您是否在错误消息中得到了准确的路径？

在这种情况下，你可以做一个

```
svn lock --force PATH -m "Steal lock" 
```

窃取最初存储在另一个工作副本中的锁。

```
svn status -u 
```

还应该向您显示哪些文件被锁定在存储库中。

# python - Django按列号排序

> ID：12288376
> 
> 赞同：0
> 
> 时间：2012-09-05T19:24:20.970
> 
> 标签：python, sql, django

我想按列号对结果进行排序，而不是使用列名。回退到原始 sql：

```
mytable.objects.raw('select * from hub_endu order by 1 desc') 
```

我可以在 django ORM 上实现这一点吗？

喜欢

```
mytable.objects.order_by("-1") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T21:04:41.400

您可以覆盖模型的查询集，并将索引转换为字段名称

```
class CustomQuerySet(models.query.QuerySet):

    def order_by(self, *args, **kwargs):
        my_args = []
        for arg in args:
            if type(arg) == int:
                my_args.append(self.model._meta.fields[arg].name)
            else:
                my_args.append(arg)

        print my_args
        return super(CustomQuerySet, self).order_by(*my_args, **kwargs)

class CustomManager(models.Manager):
    def get_query_set(self):
        return CustomQuerySet(self.model) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T19:44:32.720

不推荐由[http://blog.sqlauthority.com/2010/12/27/sql-server-order-by-columnname-vs-order-by-columnnumber/提供](http://blog.sqlauthority.com/2010/12/27/sql-server-order-by-columnname-vs-order-by-columnnumber/)

```
USE AdventureWorks
GO
-- ColumnName (Recommended)
SELECT *
FROM HumanResources.Department
ORDER BY GroupName, Name
GO
-- ColumnNumber (Strongly Not Recommended)
SELECT *
FROM HumanResources.Department
ORDER BY 3,2
GO 
```

# fortran - 将程序输入保存到模块以供“全局”使用

> ID：12288377
> 
> 赞同：1
> 
> 时间：2012-09-05T19:24:21.697
> 
> 标签：fortran, fortran90, fortran95

我用 Fortran 90 编写了一个程序，它从文本文件中读取数百个输入，并对它们执行许多不同的顺序操作。

我不想继续将这数百个值传递给每个子例程（有很多！）。有没有办法可以将从该文件中读取的数据保存到任何子程序都可以访问的全局变量中？我想我可以以某种方式将这些值保存到每个子例程都可以调用的模块中，但我不确定该怎么做。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T20:25:44.087

您只需将变量放入一个模块中，然后从每个子例程中使用该模块。或者在同一个模块中有子程序。这是现代 Fortran 中全局变量的首选方法；优于普通块。公共块增加了存储顺序的不必要的复杂性。原则上，您应该在每个声明中包含 SAVE，因为如果模块超出范围，即如果在程序执行期间主程序和任何子程序都没有使用该模块，则允许丢失值。可能没有编译器实际上这样做。

```
module my_mod

  real, dimension (100) :: array
  integer :: OneInt

contains

subroutine X

end subroutine X

end module my_mod

program my_prog

use my_mod

read ()  array

call subroutine X

end program my_prog 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-05T22:21:08.143

与模块变量的使用正交，考虑使用一个或多个派生类型将“数百个值”组合在一起（以某种方式相关的值被分组为特定的派生类型）。

（在更基本的层面上，有时以数组而不是一系列标量表示信息更适合该信息的性质 - 因此在数组中存储和传递该信息。）

这使得理解程序中的信息流变得更加容易——在过程引用的站点上，阅读您的代码的人不一定知道被引用的过程可能访问的模块和模块变量。在某些情况下，它还可以使您将来更容易扩展程序 - 如果它们以派生类型而不是一系列模块变量来描述，则更容易拥有多个现存的事物实例。

所以而不是：

```
SUBROUTINE proc( temperature, pressure,  &
    composition_a, composition_b, composition_c )
  REAL, INTENT(IN) :: temperature, pressure,  &
      composition_a, composition_b, composition_c
... 
```

考虑：

```
TYPE State
  REAL :: temperature
  REAL :: pressure
  REAL :: composition(3)
END Type State
...
SUBROUTINE proc(system_state)
   TYPE(State), INTENT(IN) :: system_state
... 
```

在其他情况下，模块变量可能更合适——拆分是一个判断问题。

# coldfusion - 在查询中找不到列，但它在列列表中

> ID：12288380
> 
> 赞同：-1
> 
> 时间：2012-09-05T19:24:31.047
> 
> 标签：coldfusion, railo, cfml

我正在尝试使用[CFCSV custom tag](http://www.getrailo.org/index.cfm/extensions/browse-extensions/cfcsv/)解析 CSV 。这是我的 CFML 代码：

```
<cfset data = fileRead( "inputtest.csv", "utf-8" ) />
<cfcsv action="parse" data="#data#" variable="csv" hascolumnnames="true" delimiter="," />
<cfloop query="csv">
    <cfoutput>#csv.name#</cfoutput>
</cfloop> 
```

..和我的测试CSV：

```
"Email","Name","Address1","Address2","City","State","ZIP","Country","Phone"
"somedude@foobar.com","Some Dude","3129 golden bridge ave",,"somecity","somestate","somezip","usa","1234567890" 
```

我得到的错误是：

> 在查询中找不到列 [NAME]，列是 [Email,Name,Address1,Address2,City,State,ZIP,Country,Phone]

如果我将循环更改为输出名称以外的任何内容，它就可以工作。但我不能得到这个名字。即使将 columname 更改为 to 也会`Name`导致`TheName`相同的错误：

> 在查询中找不到列 [THENAME]，列是 [Email,TheName,Address1,Address2,City,State,ZIP,Country,Phone]

但同样，我输出电子邮件地址或任何其他列都没有问题。更改 CSV 中列的位置和/或从`cfloop query`plus更改`cfoutput`为 just`cfoutput query`无效。

如果我`cfdump`查询，该列就在那里。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T21:13:01.223

我能够通过在 CSV 文件的开头添加换行符来重现该问题，但是在解析列标题行时出现问题时，您可能会看到同样的错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T20:39:28.607

CSV 的格式有问题，我无法弄清楚确切的问题。为了解决这个问题，我将 CSV 重新导出为制表符分隔的文本文件，在 Calc 中打开它，然后以制表符分隔的格式保存。现在它起作用了。我希望我知道原始文件有什么问题。

# django - 在管理员中查看和选择多对多的子集

> ID：12288385
> 
> 赞同：1
> 
> 时间：2012-09-05T19:24:50.553
> 
> 标签：django

这是我的基本模型：

```
Class Company(models.Model):
    title = models.CharField(max_length=100)
    basic_contract = models.FileField(upload_to='company_forms')

Class Addendum(models.Model):
    attachment = models.FileField(upload_to='addendum_forms')
    company = models.ForeignKey(Company)

Class Contract(models.Model):
    customer = models.CharField(max_length=100)
    company = models.ForeignKey(Company)
    attachments = models.ManyToManyField(Addendum) 
```

这是我的简化模型。选择要附加到合同的附录时，我在管理模块中启用了复选框。我希望我的管理屏幕过滤掉仅适用于合同中选择的公司的附录。

当我使用开箱即用的 django 管理员时，我有一个完整的附录列表。有什么方法可以根据公司选择立即过滤吗？考虑到我在创建新合同时必须选择一家公司，这可能吗？我在这里有什么可能的解决方案？

# c# - 关闭应用程序后的 ProcessCmdKey

> ID：12288387
> 
> 赞同：0
> 
> 时间：2012-09-05T19:24:56.600
> 
> 标签：c#, keypress, keydown, notifyicon

如果我按下+ 、或+或+ ，我有这个功能`ProcessCmdKey`将运行一些按钮。`Ctrl``A``Ctrl``N``Ctrl``S`

```
protected override bool ProcessCmdKey(ref Message msg, Keys keyData)
{
    if (keyData == (Keys.Control | Keys.N))
    {
        button4_Click(this, null);
        return true;
    }

    if (keyData == (Keys.Control | Keys.A))
    {
        button3_Click(this, null);
        return true;
    }

    if (keyData == (Keys.Control | Keys.S))
    {
        label10_Click(this, null);
        return true;
    }

    return base.ProcessCmdKey(ref msg, keyData);
} 
```

我有一个问题，是否可以在关闭应用程序（不是关闭应用程序）后，使用`Form_Closing`将应用程序置于`System Icons`using `notifyIcon`，如果您按`Ctrl`+ `A`（例如），将运行按钮？

现在它不起作用，但我可以这样做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T19:45:17.323

要设置托盘图标，请参阅本[指南](http://www.simple-talk.com/dotnet/.net-framework/creating-tray-applications-in-.net-a-practical-guide/)。

您可以通过 Project **Properties > Application > Icon**设置项目的图标。

您可以像这样从任务栏中隐藏窗口：

```
this.ShowInTaskbar = false; 
```

此代码将阻止表单关闭并将其隐藏（除非窗口正在关闭）。

```
protected override void OnFormClosing(FormClosingEventArgs e)
{
    base.OnFormClosing(e);

    if (e.CloseReason == CloseReason.WindowsShutDown) 
    {
        return;
    }

    e.Cancel = true;

    this.WindowState = FormWindowState.Minimized
} 
```

此代码将为您提供托盘图标并在双击时重新显示表单。

```
 public MyForm()
    {
        InitializeComponent();

        NotifyIcon trayIcon = new NotifyIcon()
        {
            Icon = new Icon(@"C:\Temp\MyIcon.ico"),
            BalloonTipText = "Open Me!",
            Visible = true
        };

        trayIcon.DoubleClick += new EventHandler(trayIcon_DoubleClick);
    }

    public void trayIcon_DoubleClick(object sender, EventArgs e)
    {
        this.ShowInTaskbar = false;
        this.WindowState = FormWindowState.Normal;
    } 
```

# php - 每小时从数据库中检索单个值并发送到另一个页面

> ID：12288388
> 
> 赞同：-1
> 
> 时间：2012-09-05T19:25:02.903
> 
> 标签：php, mysql

我需要编写一个每小时运行的 php 脚本，

所以，在我的数据库中，我有 7 个表，代表星期几，如星期日、星期一、星期二等，所有表格都有 25 列，代表 24 小时，如凌晨 1 点、凌晨 2 点、凌晨 3 点等，还有一个时间戳列。

所以，现在我必须编写一个使用 cron 每小时运行这个脚本的 php 脚本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T19:33:30.893

你为什么不把你的数据库设计改成一个表呢？

创建表`days`（ `days_id`int（10）NOT NULL AUTO_INCREMENT， `days_day`tinyint（1）NOT NULL， `days_hour`tinyint（2）NOT NULL， `days_value`varchar（255）默认NULL，主键（`days_id`），唯一键`days_day`（`days_day`，`days_hour`））；

然后只需查询：

$sql = '`days_value`从`days`哪里选择`days_day`= '。日期（'W'）。' 和`days_hour`= ' 。日期（'H'）。'限制 1';

让事情变得更容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T19:54:13.017

使用 php`date()`函数获取各种格式的当前日期信息，无需使用 DB。

这是 PHP 手册的链接。

[http://php.net/manual/en/function.date.php](http://php.net/manual/en/function.date.php)

直接来自链接的 PHP 手册页的一些示例。

```
<?php
// set the default timezone to use. Available since PHP 5.1
date_default_timezone_set('UTC');

// Prints something like: Monday
echo date("l");

// Prints something like: Monday 8th of August 2005 03:12:46 PM
echo date('l jS \of F Y h:i:s A');

// Prints: July 1, 2000 is on a Saturday
echo "July 1, 2000 is on a " . date("l", mktime(0, 0, 0, 7, 1, 2000));

/* use the constants in the format parameter */
// prints something like: Mon, 15 Aug 2005 15:12:46 UTC
echo date(DATE_RFC822);

// prints something like: 2000-07-01T00:00:00+00:00
echo date(DATE_ATOM, mktime(0, 0, 0, 7, 1, 2000));
?> 
```

# java - uri不是绝对的

> ID：12288390
> 
> 赞同：1
> 
> 时间：2012-09-05T19:25:10.523
> 
> 标签：java, jaxb

我正在尝试使用方法解组以下 xml 文件`Jaxb.unmarshall(String,Class)`。我总是得到错误：

`Exception in thread "main" java.lang.IllegalArgumentException: URI is not absolute:`

XML 文件：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<spieltag xmlns="http://arnezelasko.de/spieltag">
<game>
    <spieltag>28</spieltag>
    <nummer>1</nummer>
    <beginn>2010-03-26 20:30:00</beginn>
    <mannschaft_heim><![CDATA[VfL Bochum]]></mannschaft_heim>
    <mannschaft_gast><![CDATA[Eintracht Frankfurt]]></mannschaft_gast>
    <tore_heim_halbzeit>1</tore_heim_halbzeit>
    <tore_gast_halbzeit>1</tore_gast_halbzeit>
    <tore_heim_ergebnis>1</tore_heim_ergebnis>
    <tore_gast_ergebnis>2</tore_gast_ergebnis>
</game>
<game>
    <spieltag>28</spieltag>
    <nummer>2</nummer>
    <beginn>2010-03-27 15:30:00</beginn>
    <mannschaft_heim><![CDATA[Bayern München]]></mannschaft_heim>
    <mannschaft_gast><![CDATA[VfB Stuttgart]]></mannschaft_gast>
    <tore_heim_halbzeit></tore_heim_halbzeit>
    <tore_gast_halbzeit></tore_gast_halbzeit>
    <tore_heim_ergebnis></tore_heim_ergebnis>
    <tore_gast_ergebnis></tore_gast_ergebnis>
</game> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T14:49:28.467

这是您的 xml 示例中的一个[有效的 Java 解组](https://bitbucket.org/jrx/jrxpublic/downloads/12288390-uri-is-not-absolute.zip)示例。

您有一个称为 spieltag 的根元素和一个也称为 spieltag 的内部元素。如果您没有在 XMLSchema 中很好地定义它，这可能会导致问题。在示例中，我使用`spieltag2`了内部`spieltag`元素。

另外，不要忘记使用正确的编译 package-info.java `@XmlSchema`：

正如[这里](https://stackoverflow.com/a/12296535/3673)所说，您可以使用类`@XmlSchema`上的注释`package-info`来控制命名空间限定。如果您已经编写了 package-info 类，请确保它正在被编译（某些版本的 ant 与 package-info 类有问题）。

**包信息**

```
@XmlSchema( 
    namespace = "http://arnezelasko.de/spieltag", 
    elementFormDefault = XmlNsForm.QUALIFIED) 
package de.arnezelasko.spieltag; 
```

**了解更多信息**

*   [http://blog.bdoughan.com/2010/08/jaxb-namespaces.html](http://blog.bdoughan.com/2010/08/jaxb-namespaces.html)

# ruby - 自制卸载红宝石

> ID：12288391
> 
> 赞同：8
> 
> 时间：2012-09-05T19:25:15.370
> 
> 标签：ruby, homebrew

我刚刚通过安装 ruby

> 酿造安装红宝石

有人建议我通过 RVM 安装它，即使我使用 Homebrew，但首先我想卸载 Homebrew 刚刚安装的 ruby​​。

我可以简单地做

> 冲泡卸载红宝石

还是我需要做其他事情？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-06T00:24:51.693

是的，`brew uninstall ruby`应该做的伎俩。

有关更多信息，您可以`man brew`在终端中输入。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2020-11-11T03:47:35.980

做`brew uninstall ruby`会奏效。如果你真的想确定，你可以`brew cleanup`在运行第一个命令后运行。Homebrew 只是使用该`brew cleanup`命令删除不必要的软件包。在某些情况下，最后一个命令对于公式完全消失是必需的。（一个例子是`tree`公式，我不得不使用`brew cleanup`它来完全卸载它。）

（我知道这已经晚了，但这适用于正在查看此内容的任何人）

# design-patterns - 我知道 SRP 有助于减少耦合的三种方式。还有更多吗？

> ID：12288393
> 
> 赞同：0
> 
> 时间：2012-09-05T19:25:21.797
> 
> 标签：design-patterns, single-responsibility-principle

我想弄清楚 SRP 帮助我们减少耦合的所有可能方式。到目前为止，我能想到三个：

1) 如果 A 类有多个职责，这些职责就会耦合，因此对这些职责之一的更改可能需要更改 A 的其他职责。

2) 相关功能通常需要出于相同的原因进行更改，并且通过将其组合在一个类中，可以在尽可能少的地方进行更改（最多只需要对将这些功能组合在一起的类进行更改)

3）假设 A 类执行两个任务（因此可能因两个原因而改变），那么使用 A 的类的数量将大于 A 只执行一个任务（原因是某些类需要 A 来执行第一个任务，其他类将需要 A 来完成第二个任务，还有其他人将它用于两个任务）。这也意味着当 A 休息时，受损的班级数量（利用 A ）将比 A 只执行一项任务时更大。

SRP 是否也可以以任何其他方式帮助减少耦合，上面没有描述？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T17:13:14.830

我认为 SPR 更多的是关于凝聚力和稳健性。如果您关心松散耦合，那么您应该关注其他 SOLID 设计原则，如接口隔离原则和开闭原则。

[http://en.wikipedia.org/wiki/SOLID_%28object-oriented_design%29](http://en.wikipedia.org/wiki/SOLID_%28object-oriented_design%29)

# jquery - 创建节点后jstree显示不正确

> ID：12288394
> 
> 赞同：0
> 
> 时间：2012-09-05T19:25:22.910
> 
> 标签：jquery, jstree

我正在使用 jstree 创建一个新节点，但它显示的节点不正确。

下面两张图是节点创建后不合适的图片。

它们位于 div 内的表格内。div 是可滚动的，并且节点在初始创建时随着滚动而移动。

一旦我取消选择节点，它就会转到正确的位置。

[节点不合适的图片。](http://i.imgur.com/EfvnE)“创建后节点不合适”

[节点不合适的图片。](http://i.imgur.com/i054N)“另一个节点不合适”

显然，重命名也会发生这种情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T19:22:52.480

修改jstree.js中的_show_input函数如下：

```
h2 = obj.children('a:first').after(
    $("<input />", { 
        "value" : t,
        "class" : "jstree-rename-input",
        // "size" : t.length,
        "css" : {
            "padding" : "0",
            "border" : "1px solid silver",
            "left"  : (rtl ? "auto" : (w1 + w2 + 4) + "px"),
            "right" : (rtl ? (w1 + w2 + 4) + "px" : "auto"),
            "top" : "0px",
            "height" : (this.data.core.li_height - 2) + "px",
            "lineHeight" : (this.data.core.li_height - 2) + "px",
            "width" : "150px" // will be set a bit further down
        },
        "blur" : $.proxy(function () {
            var i = obj.children(".jstree-rename-input"),
                v = i.val();
            if(v === "") { v = t; }
            h1.remove();
            i.remove(); // rollback purposes
            this.set_text(obj,t); // rollback purposes
            this.rename_node(obj, v);
            callback.call(this, obj, v, t);
            obj.css("position","");
        }, this),
        "keyup" : function (event) {
            var key = event.keyCode || event.which;
            if(key == 27) { this.value = t; this.blur(); return; }
            else if(key == 13) { this.blur(); return; }
            else {
                h2.width(Math.min(h1.text("pW" + this.value).width(),w));
            }
        },
        "keypress" : function(event) {
            var key = event.keyCode || event.which;
            if(key == 13) { return false; }
        }
    })
).siblings(".jstree-rename-input"); 
```

第一行更改为在 obj 中的第一个锚元素之后附加输入对象，这是一个 LI 元素。最后一行更改为返回所有类为 .jstree-rename-input 的兄弟姐妹。

还删除了输入和 obj 的绝对定位。

# django - 在 Python 2.7 中使用 unicode_literals 时在 Django 中解码 utf-8

> ID：12288398
> 
> 赞同：3
> 
> 时间：2012-09-05T19:25:43.720
> 
> 标签：django, unicode, utf-8, python-2.7

我正在使用 Django 来管理 Postgres 数据库。我有一个值存储在代表西班牙（马拉加）的一个城市的数据库中。我的 Django 项目通过将 unicode 字符串放在`from __future__ import unicode_literals`我创建的每个文件的开头来处理所有内容。

我需要从数据库中提取城市信息并使用`XML`请求将其发送到另一台服务器。一路上有日志记录，以便我可以观察数据流。当我尝试记录城市的值时，我得到以下回溯：

```
UnicodeEncodeError: 'ascii' codec can't encode character u'\xe1' in position 1: ordinal not in range(128) 
```

这是我用来记录我传递的值的代码。

```
def createXML(self, dict):
    """
    ..  method:: createXML()

        Create a single-depth XML string based on a set of tuples

        :param dict: Set of tuples (simple dictionary)
    """

    xml_string = ''
    for key in dict:
        self.logfile.write('\nkey = {0}\n'.format(key))
        if (isinstance(dict[key], basestring)):
            self.logfile.write('basestring\n')
            self.logfile.write('value = {0}\n\n'.format(dict[key].decode('utf-8')))
        else:
            self.logfile.write('value = {0}\n\n'.format(dict[key]))

        xml_string += '<{0}>{1}</{0}>'.format(key, dict[key])

    return xml_string 
```

我基本上将我拥有的所有信息保存在一个简单的字典中，并使用这个函数来生成一个`XML`格式化的字符串——这超出了这个问题的范围。

我得到的错误让我想知道数据库中实际保存的是什么。我已验证该值已`utf-8`编码。我创建了一个简单的脚本来从数据库中提取值，对其进行解码并将其打印到屏幕上。

```
from __future__ import unicode_literals
import psycopg2
# Establish the database connection
try:
    db = psycopg2.connect("dbname = 'dbname' \
                           user = 'user' \
                           host = 'IP Address' \
                           password = 'password'")
    cur = db.cursor()
except:
    print "Unable to connect to the database."

# Get database info if any is available
command = "SELECT state FROM table WHERE id = 'my_id'"
cur.execute(command)
results = cur.fetchall()

state = results[0][0]
print "my state is {0}".format(state.decode('utf-8')) 
```

结果：`my state is Málaga`

在 Django 中，我正在执行以下操作来创建 HTTP 请求：

```
## Create the header
http_header = "POST {0} HTTP/1.0\nHost: {1}\nContent-Type: text/xml\nAuthorization: Basic {2}\nContent-Length: {3}\n\n"
req = http_header.format(service, host, auth, len(self.xml_string)) + self.xml_string 
```

谁能帮我纠正问题，以便我可以将此信息写入数据库并能够创建`req`要发送到其他服务器的字符串？

由于 Django 的处理方式，我是否收到此错误？如果是这样，Django 在做什么？或者，我告诉 Django 这样做是为了什么？

EDIT1：我也尝试`django.utils.encoding`在这个状态值上使用 Django。我从[saltycrane](http://www.saltycrane.com/blog/2008/11/python-unicodeencodeerror-ascii-codec-cant-encode-character/)中读到了一些关于 Djano 可能会遇到 unicode/utf-8 的问题。

我试图修改我的日志记录以使用该`smart_str`功能。

```
def createXML(self, dict):
    """
    ..  method:: createXML()

        Create a single-depth XML string based on a set of tuples

        :param dict: Set of tuples (simple dictionary)
    """

    xml_string = ''
    for key in dict:
        if (isinstance(dict[key], basestring)):
            if (key == 'v1:State'):
                var_str = smart_str(dict[key])
                for index in range(0, len(var_str)):
                    var = bin(ord(var_str[index]))
                    self.logfile.write(var)
                    self.logfile.write('\n')
                self.logfile.write('{0}\n'.format(var_str))

        xml_string += '<{0}>{1}</{0}>'.format(key, dict[key])

    return xml_string 
```

这样做我可以将正确的值写入日志，但我缩小了`.format()`Python 中字符串功能的另一个可能问题。当然，我的 Google 搜索的`python format unicode`第一个结果是[Issue 7300](http://bugs.python.org/issue7300)，它指出这是 Python 2.7 的一个已知“问题”。

现在，从[另一个 stackoverflow 帖子](https://stackoverflow.com/questions/3235386/python-using-format-on-a-unicode-escaped-string)中，我发现了一个“解决方案”，它在 Django 中无法使用该`smart_str`功能（或者至少我无法让它们一起工作）。

我将继续挖掘，看看我是否找不到潜在的问题 - 或者至少找不到解决方法。

`.format()`EDIT2：我通过简单地连接字符串而不是使用该功能找到了一种解决方法。我不喜欢这个“解决方案”——它很丑，但它完成了工作。

```
def createXML(self, dict):
    """
    ..  method:: createXML()

        Create a single-depth XML string based on a set of tuples

        :param dict: Set of tuples (simple dictionary)
    """

    xml_string = ''
    for key in dict:
        xml_string += '<{0}>'.format(key)
        if (isinstance(dict[key], basestring)):
            xml_string += smart_str(dict[key])
        else:
            xml_string += str(dict[key])
        xml_string += '<{0}>'.format(key)

    return xml_string 
```

我将不回答这个问题，因为我很想找到一个解决方案，让我`.format()`按照预期的方式使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T12:05:49.883

这是正确的方法（问题在于打开文件。使用 UTF-8 你必须使用`codecs.open()`：

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-
import codecs

class Writer(object):
    logfile = codecs.open("test.log", "w", 'utf-8')

    def createXML(self, dict):
        xml_string = ''
        for key, value in dict.iteritems():
            self.logfile.write(u'\nkey = {0}\n'.format(key))
            if (isinstance(value, basestring)):
                self.logfile.write(u'basestring\n')
                self.logfile.write(u'value = {0}\n\n'.format( value))
            else:
                self.logfile.write(u'value = {0}\n\n'.format( value ))

            xml_string += u'<{0}>{1}</{0}>'.format(key, value )

        return xml_string 
```

这是来自 python 控制台：

```
In [1]: from test import Writer

In [2]: d = { 'a' : u'Zażółć gęślą jaźń', 'b' : u'Och ja Ci zażółcę' }

In [3]: w = Writer()

In [4]: w.createXML(d)
Out[4]: u'<a>Za\u017c\xf3\u0142\u0107 g\u0119\u015bl\u0105 ja\u017a\u0144</a><b>Och ja Ci za\u017c\xf3\u0142c\u0119</b>' 
```

这是`test.log`文件：

```
key = a
basestring
value = Zażółć gęślą jaźń

key = b
basestring
value = Och ja Ci zażółcę 
```

# elasticsearch - elasticsearch query_string 和术语搜索语法

> ID：12288403
> 
> 赞同：4
> 
> 时间：2012-09-05T19:26:21.237
> 
> 标签：elasticsearch

我想搜索`query_string`包含`Bob`和`Industry_Type_ID`一个`8`OR `9`。

我收到一个解析错误：`Parse Failure [No parser for element [Industry_Type_ID]]`

```
{
    "query" : {
        "query_string":{"query":"Bob"},
        "terms" : {
            "Industry_Type_ID" : [ "8", "9" ],
            "minimum_match" : 1
        }
    }
} 
```

我确定我遗漏了一些明显的东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-05T19:36:37.587

您可以使用带有两个子句的[bool 查询来做到这一点：](http://www.elasticsearch.org/guide/reference/query-dsl/bool-query.html)`must`

```
{
    "query" : {
        "bool" : {
            "must" : [
                {
                    "query_string":{"query":"Bob"}
                },
                {
                    "terms" : {
                        "Industry_Type_ID" : [ "8", "9" ],
                        "minimum_match" : 1
                    }
                }
            ]
        }
    }
} 
```

# javascript - 如何处理谷歌地图网址中的“#”

> ID：12288406
> 
> 赞同：0
> 
> 时间：2012-09-05T19:26:24.190
> 
> 标签：javascript, html, maps

我正在将谷歌地图与我的移动网站集成。每当我将地址传递给包含“#”的网址时，它都会显示“#”出现之前的地址

示例：如果地址是 test1#test2 并且我将其传递给 google url，则在地图中它会显示 test1。

我使用的 URL 是“http://maps.google.com/maps?daddr=" + add" 其中 add 是变量

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T19:36:44.467

哈希 (#) 是 URI（a/k/a URL）中的特定标记。这意味着您正在寻找页面的一部分而不是整个资源。通常，当您需要包含会导致解析 URL 时出现问题的令牌（例如“$”或“/”）时，您应该“URI 编码”该令牌。这会产生类似`%20`（空格）或`%2F`（“/”）的结果。您可能只需要将您的哈希 URI 编码为`%23`.

您可能应该对要发送的整个地址进行 URI 编码，而不仅仅是哈希。这样做有很多选择。JavaScript 甚至有一个可以完成这项工作的内置函数（[encodeURIComponent()](http://www.w3schools.com/jsref/jsref_encodeuricomponent.asp)）。

# java - 我们可以有一个泛型的类类型吗？

> ID：12288407
> 
> 赞同：0
> 
> 时间：2012-09-05T19:26:29.663
> 
> 标签：java, generics

假设我们有这个功能：

```
<T> T   getFromCache (ClassType<T>   clazz); 
```

对于字符串：

```
String str =   getFromCache(String.class); 
```

对于我目前正在考虑做的地图：

```
//… 
Map<String, SomeData>   anotherMapObject  = getFromCache( HashMap.class); 
```

我们能比这更具体吗？

当然，一种解决方案是将“HashMap”包装在一个类中。但是，如果我们不想这样做，那么有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T19:35:58.257

如果你想传入地图实现，你可以这样做：

```
private <M extends Map> Map<String, String> get(Class<M> m) throws Exception {
        return (Map<String, String>) m.newInstance();
    } 
```

您可以像这样参数化键和值类型：

```
private <M extends Map<K, V>, K, V> M getMap(Class<M> m, Class<K> k, Class<V> v) 
```

# css - Flash 覆盖位置：chrome 中的固定元素

> ID：12288409
> 
> 赞同：1
> 
> 时间：2012-09-05T19:26:35.287
> 
> 标签：css, flash, google-chrome

通常，我在编写 css 代码时使用的是 firefox。但是我的代码在使用 chrome 时有问题。

我的固定菜单：

```
header{
  background-color: #2bd5ec;
  overflow:hidden;
  line-height: 200%;
  top:0;
  position:fixed;
  width:100%;
  z-index: 1;
} 
```

当我滚动页面时，我的 swf 文件位于后面。我的 swf 文件的 css 代码。

```
#swfFile{width: 500px;height: 500px;} 
```

但是当我使用 chrome swf 文件时，它位于菜单前面。我必须改变什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T11:41:50.033

这是一个铬错误。chrome 无法处理具有位置：固定和溢出：隐藏和该 div 内的 flashobject 的 div。剥离示例（wmode-param 不必有问题）：

```
<html>
 <head>
  <title>chromebug</title>
 </head>
 <body>
  <div style="min-height:10000px;">CONTENT</div>
  <div style="position: fixed;overflow:hidden;background-color: #000000; bottom: 0; left: 0;">
    <object type="application/x-shockwave-flash" width='400px;' height='100px' data="banner.swf">
     <param name="wmode" value="transparent">
    </object>
  </div>
 </body>
</html> 
```

在这里在线：http: [//bytepirates.com/cbug.html](http://bytepirates.com/cbug.html)

解决方案：去除溢出：隐藏

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T19:39:34.267

它不是您的 CSS 的问题，而是您的 swf 对象的问题。您必须将`wmode`您的嵌入设置为`transparent`. 否则它将覆盖所有其他元素。

```
<object>
    <embed wmode="transparent" height="550" width="733">
</object> 
```

# jquery - 解释 jQuery 代码示例

> ID：12288411
> 
> 赞同：-3
> 
> 时间：2012-09-05T19:26:36.950
> 
> 标签：jquery

我继承了以下 jQuery 代码片段作为 jquery/AJAX 验证系统的一部分。我只需要有人用注释逐行解释代码，这样我就可以理解如何更改脚本的一些操作：

```
// Use Ajax to send everything to form processing file
submitHandler: function(form) {
    $("#send").attr("value", "Sending...");
    $(form).ajaxSubmit({
        success: function(responseText, statusText, xhr, $form) {
            $(form).slideUp("slow");
        $("#response").html(responseText).hide().slideDown("slow");
        }
    });
    return false;
} 
```

具体来说，这些行重新“成功”。. . ' 我特别感兴趣，因为我可以看到 $(form).slideUp("slow") 导致表单缓慢向上滑动（有点明显，不是吗？）。'slideUP' 操作不会将我带到表单的顶部，但总是在表单中间的某个位置。如果我对 jQuery 有更好的理解，我可能会想出如何让“slideUp”始终将我带到表单的顶部。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T19:32:17.883

该函数用于处理元素的`submit`事件。`form`

```
submitHandler: function(form) { 
```

单击发送按钮后，值**Send**应变为**Sending...**：

```
 $("#send").attr("value", "Sending..."); 
```

该函数`ajaxSubmit`在不刷新页面的情况下将表单提交到另一个 URL。

```
 $(form).ajaxSubmit({ 
```

提交后，调用此函数。其中`responseText`是从服务器返回的文本。`statusText`是 HTTP 状态码。`xhr`是`XMLHttpRequest`使用的对象。`$form`是`form`被处理的元素。

```
 success: function(responseText, statusText, xhr, $form) { 
```

现在，提交后，您正在`form`以动画方式向上滑动。

```
 $(form).slideUp("slow"); 
```

您正在填充`#response`div，这是您向用户显示信息的地方，通过平滑向下滑动。

```
 $("#response").html(responseText).hide().slideDown("slow");
        }
    }); 
```

您正在从正常的 HTTP 提交中停止表单。

```
 return false;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T19:31:56.970

我的叙述笔记开始于`//#`

```
// Use Ajax to send everything to form processing file

//# Create a function called 'submitHandler'
submitHandler: function(form) {

    //# Set a form field saying the form is being sent.
    $("#send").attr("value", "Sending...");

    //# Using the form, sumit its value using jQuery's ajaaax
    $(form).ajaxSubmit({

        //# Should the result be successful, call this function
        success: function(responseText, statusText, xhr, $form) {
            //# Slide the form into view (I believe)
            $(form).slideUp("slow");
            //# This puts the return value of the AJAX caall into #response
            $("#response").html(responseText).hide().slideDown("slow");
        }
    });

    //# I'm pretty sure that under jQuery this will stop the default action,
    //# which would be a regular form submit.
    return false;
} 
```

# tomcat - 基于 jar 的无战争部署

> ID：12288412
> 
> 赞同：1
> 
> 时间：2012-09-05T19:26:38.790
> 
> 标签：tomcat, web-applications, jar, war, web-application-design

这次我有一个理论问题。一位为一家相当大的公司工作的软件开发人员今天告诉我，他们不使用war 文件进行应用程序部署。他们的软件架构师认为，war 文件是邪恶的，因为部署 unwared 类的安全性不够，因为他们的运营组员工玩服务器可能会造成损害。据我了解，他们的解决方案是将应用程序打包到 jar 中并将其添加到空的 webapp 样式树的 WEB-INF/lib 文件夹中。它们还用于编辑 server.xml 以在其中添加应用程序的上下文 /docbase 以在它们使用的路径上启用它。我真的对这个解释感到困惑，我以前从未见过这样的事情。我个人认为整个“操作人员问题”听起来像是偏执狂，但仍然如此 我很难决定这种解决方案的优缺点是什么。你怎么看？奇异或辉煌？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T14:17:06.180

实际上，这听起来可以替代扩展 WAR 并因此需要维护许多文件 - 这在您无法直接控制并且可能与其他应用程序共享的环境中可能是不利的。在这种情况下，您可能希望您的应用程序具有较小的文件系统占用空间，并且单个 JAR（可能加上应用服务器中的少量配置条目）可能会更好地工作。

扩展的 WAR 更容易受到“操作人员”可能意外对您的文件执行的各种文件系统操作的影响。例如，考虑一个 unix 单行程序，和 的组合`find`，`rm`它递归地搜索具有特定名称的文件并删除它们，但无意中在错误的目录上运行。Boom - 你的一些类文件突然丢失了，你在生产环境中有一个谜要解决。尤其是在共享环境中，这样的事情可能会发生。

因此，我对此类设计有所了解-在他们的情况下，这可能是最好的选择。也许不出色，但绝对不奇怪。

# path - 更改锂的默认控制器路径

> ID：12288416
> 
> 赞同：0
> 
> 时间：2012-09-05T19:26:52.153
> 
> 标签：path, router, controllers, lithium

我正在编写 API 的新版本，并希望通过为每个版本设置不同的控制器集来支持旧版本。在 Lithium 中的默认“app\controllers”路径中，我希望有例如“v1”和“v2”路径。

我尝试通过执行以下操作在路线本身内完成此操作：

```
 Router::connect('/{:version}/{:controller}/{:action}{:args}', array(
        'controller'=> '\app\controllers\{:version}\{:controller}Controller',
    ), array()); 
```

然后我尝试通过执行以下操作来覆盖库引导模块中的路径：

```
if( preg_match('/^\/(v[0-9\.]+)/', $_SERVER['REQUEST_URI'], $match) ) {
    Libraries::paths(array(
        'controllers' => "controllers\\".$match[1].'\\{:name}Controller',
        'models' => "models\\".$match[1]."\\{:name}",
    ));
} 
```

我花了大约半天的时间搜索谷歌和非常稀疏的锂文档。我不确定我们使用的是什么版本的 Lithium，因为我已经进入了这个预先存在的代码库。

感谢您提供的任何提示！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T22:05:24.817

在您的 routes.php 文件中，您应该重新配置 Dispatcher 默认规则

```
Dispatcher::config(array('rules' => array(
  'v1' => array('controller' => 'app\controllers\v1\{:controller}Controller')
))); 
```

和匹配 /v1/... 请求的延续路由

```
Router::connect('/v1/{:args}', array('v1' => true), array(
  'continue' => true, 'persist' => array('controller', 'v1')
)); 
```

如果需要，您可以轻松地使用`:version`而不是预定义的版本号。

# iphone - 如何获取自己的设备令牌？

> ID：12288417
> 
> 赞同：0
> 
> 时间：2012-09-05T19:27:07.087
> 
> 标签：iphone, ios

是否可以从我自己的 iPhone 获取您自己的设备令牌？我需要它，因为我想测试推送通知...谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T19:33:59.770

您将需要使用该`-(void)application:(UIApplication *)application didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)deviceToken;`方法。下面是一个示例，它将输出您的设备令牌并将其设置为字符串。

```
-(void)application:(UIApplication *)application didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)deviceToken {
    NSLog(@"APN device token: %@", deviceToken);    
    NSString *deviceTokenString = [NSString stringWithFormat:@"%@",deviceToken];
} 
```

但是，您确实应该已经这样做了，这样您就知道将通知发送给您的用户，不是吗？

在进一步澄清评论后编辑：

你的问题根本不是很具体。要回答您更详细的问题，您无法显示它。因为它对于每个设备和每个应用程序都是独一无二的。因此，您的 AppA 令牌与 AppB 不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T19:35:38.327

如果您订阅了推送通知，您将在回调函数中拥有推送通知所需的设备令牌。在那之前没有，除非你写了之前的值。

注意开发/调试模式下的应用程序令牌与发布/临时模式不同！！！

```
- (void)application:(UIApplication*)application didRegisterForRemoteNotificationsWithDeviceToken:(NSData*)deviceToken
{
    NSLog(@"My token is: %@", deviceToken);
} 
```

请看[这个](http://www.raywenderlich.com/3443/apple-push-notification-services-tutorial-part-12)教程。它也不适用于模拟器和越狱设备

# python - 获取字典python中的所有唯一辅助键

> ID：12288423
> 
> 赞同：2
> 
> 时间：2012-09-05T19:27:23.780
> 
> 标签：python

我有一本二维字典，例如：

```
 d[a1][b1] = v1
 d[a1][b2] = v2
 d[a2][b1] = v3
 d[a2][b3] = v4 
```

在上面的示例中，唯一的辅助键是 b1、b2、b3？

如何在 python 中返回列表 [b1,b2,b3]？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T19:32:01.453

```
s = list(set(key2 for key1 in d for key2 in d[key1])) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T19:35:41.457

由于 dict 可能有多个维度，因此从第二级获取值列表的方法是像往常一样遍历 dict。

我的建议是让您考虑使用类似[itertools](http://docs.python.org/library/itertools.html)的东西。Itertools 可以帮助您快速完成像您这样的用例。

# jquery - 媒体查询，通过调整窗口大小来停止 jQuery？

> ID：12288426
> 
> 赞同：1
> 
> 时间：2012-09-05T19:27:29.600
> 
> 标签：jquery, media

[我在这里](http://www.ttmt.org.uk/forum/gallery1/)有一个演示来说明我的问题。这是一个滚动图片库。单击图像时，它会显示得更大 - 灯箱样式。

悬停和单击图像是使用 jQuery 完成的。我希望页面能够响应手机屏幕。如果将浏览器的大小调整为大约 400 像素，则布局将变为一列并垂直滚动。

当布局更改时，我希望 jQuery 停止 - 我不希望悬停，也不希望在单击时显示更大的图像。媒体查询启动时如何停止或更改 jQuery？

```
<!DOCTYPE html>
<html>
<head>
    <title>Title of the document</title>

    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.1/jquery.min.js"></script>
    <link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/3.4.1/build/cssreset/cssreset-min.css">

    <style type="text/css">
        #header{
        position:fixed;
        margin:20px 0 0 20px;
        }
        #header #logo{
        width:100px;
        height:80px;
        background:red;
        }
        ul#gallery {
        margin:120px 0 0 0;
        float:left;
        height:500px;
        margin-right:-20000px;
        }
        ul#gallery li{
        display:inline;
        }
        ul#gallery li img{
        float:left;
        height:100%;
        }
        #lightbox {
            position:fixed; 
            top:0; 
            left:0; 
            width:100%; 
            height:100%; 
            background:url(overlay.png) repeat; 
            text-align:center;
        }
        #lightbox p {
            text-align:right; 
            color:#fff; 
            margin-right:20px; 
            font-size:12px; 
        }
        #lightbox img {
            box-shadow:0 0 15px #111;
            -webkit-box-shadow:0 0 15px #111;
            -moz-box-shadow:0 0 15px #111;
            max-width:940px;
        }
        #content img{
          height:85%;
          max-width:100%;
        }

        /*--------------------------------------
          Media Query
        ---------------------------------------*/

        @media screen and (max-width: 400px){
            #header #logo{
            height:50px;
            }
            ul#gallery {
            margin:20px 0 0 0;
            width:400px;
            }
            ul#gallery li{
            display:block;
            }
            ul#gallery li img{
            opacity:0.5;
            height:auto;
            width:400px;
            }
            #header{
            position:static;
            margin:10px 0 0 20px;
            }
        }
    </style>
</head>
<body>
    <div id="header">
        <div id="logo"></div><!-- #logo -->
    </div><!-- #header -->

    <ul id="gallery">
        <li><a href="images/01.jpg" class="lightbox_trigger"><img src="images/01.jpg" /></a></li>
        <li><a href="images/02.jpg" class="lightbox_trigger"><img src="images/02.jpg" /></a></li>
        <li><a href="images/03.jpg" class="lightbox_trigger"><img src="images/03.jpg" /></a></li>
        <li><a href="images/04.jpg" class="lightbox_trigger"><img src="images/04.jpg" /></a></li>
        <li><a href="images/05.jpg" class="lightbox_trigger"><img src="images/05.jpg" /></a></li>
        <li><a href="images/06.jpg" class="lightbox_trigger"><img src="images/06.jpg" /></a></li>
        <li><a href="images/07.jpg" class="lightbox_trigger"><img src="images/07.jpg" /></a></li>
        <li><a href="images/08.jpg" class="lightbox_trigger"><img src="images/08.jpg" /></a></li>
        <li><a href="images/09.jpg" class="lightbox_trigger"><img src="images/09.jpg" /></a></li>
        <li><a href="images/10.jpg" class="lightbox_trigger"><img src="images/10.jpg" /></a></li>
        <li><a href="images/11.jpg" class="lightbox_trigger"><img src="images/11.jpg" /></a></li>
        <li><a href="images/12.jpg" class="lightbox_trigger"><img src="images/12.jpg" /></a></li>
        <li><a href="images/13.jpg" class="lightbox_trigger"><img src="images/13.jpg" /></a></li>
        <li><a href="images/14.jpg" class="lightbox_trigger"><img src="images/14.jpg" /></a></li>
        <li><a href="images/15.jpg" class="lightbox_trigger"><img src="images/15.jpg" /></a></li>
    </ul>

    <script>
    jQuery(document).ready(function($) {

      $('#gallery img').hover(
         function () {
           $(this).css('opacity',1)
         }, 
         function () {
           $(this).css('opacity',.4);
         }
       );

        $('.lightbox_trigger').click(function(e) {

            e.preventDefault();

            var image_href = $(this).attr("href");

            if ($('#lightbox').length > 0) { // #lightbox exists

                $('#content').html('<img src="' + image_href + '" />');

                //$('#lightbox').show();

                $('#lightbox').fadeIn('2000');
            }

            else { 

                var lightbox = 
                '<div id="lightbox">' +
                    '<p>Click to close</p>' +
                    '<div id="content">' + 
                        '<img src="' + image_href +'" />' +
                    '</div>' +  
                '</div>';

                $('body').append(lightbox);
            }

        });

        $('#lightbox').live('click', function() { 
            $('#lightbox').hide();
        });

    });
    </script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T01:01:13.703

好吧，有很多方法可以解决这个问题。

在您的情况下，您可以检查点击事件的屏幕大小并进行适当的操作。

像这样的东西：

```
 var winWidth = $(window).width(); //cache window width
    $(window).resize(function() {
        winWidth = $(this).width(); //updating winWidth with current window width
    }); 
```

现在，当单击灯箱处理程序时，请执行 winWidth 大小检查：

```
 $('.lightbox_trigger').click(function(e) {

        e.preventDefault();

        var image_href = $(this).attr("href");

       if (winWidth > 400) {       //Checking if screen size is greater than 400
         if ($('#lightbox').length > 0) { // #lightbox exists

            $('#content').html('<img src="' + image_href + '" />');

            //$('#lightbox').show();

            $('#lightbox').fadeIn('2000');
          }

          else { 

            var lightbox = 
            '<div id="lightbox">' +
                '<p>Click to close</p>' +
                '<div id="content">' + 
                    '<img src="' + image_href +'" />' +
                '</div>' +  
            '</div>';

            $('body').append(lightbox);
          }
        }
    }); 
```

如果你经常在这种屏幕上检查安静，我建议你看看 enquire.js [http://wickynilliams.github.com/enquire.js/](http://wickynilliams.github.com/enquire.js/)

希望能帮助到你 ：）

# jquery - jQuery 替代 Flash Mosaic 图片库

> ID：12288430
> 
> 赞同：0
> 
> 时间：2012-09-05T19:28:04.093
> 
> 标签：jquery

我在这里寻找 Flash Mosaic FX 画廊的 jQuery 替代品 [http://www.flashxml.net/mosaic-gallery.html](http://www.flashxml.net/mosaic-gallery.html)

我设法使用 Masonry jQuery 插件将图像平铺，但是当用户将鼠标悬停在它们上时，我很难尝试将它们平铺。我希望看到一些关于此的教程（如果可用）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T19:38:39.850

看同位素：

[http://isotope.metafizzy.co/demos/relayout.html](http://isotope.metafizzy.co/demos/relayout.html)

单击该项目以扩大它，然后再次单击以缩小它。

# javascript - Facebook scrollTo 在 iframe 中不起作用？

> ID：12288435
> 
> 赞同：0
> 
> 时间：2012-09-05T19:28:42.493
> 
> 标签：javascript, facebook, facebook-javascript-sdk

当页面刷新时，我试图让我的 iframe 加载到页面顶部。基本上我有一个 iframe，初始页面高度为 1250 像素，但它发送给您的第二页高度仅为 500 像素。问题是当您重定向到新页面时，您只能看到空白并且必须向上滚动。

我尝试过使用以下内容：

```
$("#postyourwave").click(function(){
    FB.Canvas.scrollTo(0,0);
}); 
```

但没有运气。谁能帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T19:35:17.440

尝试在应用程序设置中将画布高度设置为“固定”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T04:14:13.370

问题是画布内的滚动 iframe，有人告诉我这是不可能的。如果有人知道，请填写我！:)

# wpf - ListViewItem 内的扩展器

> ID：12288437
> 
> 赞同：0
> 
> 时间：2012-09-05T19:28:46.133
> 
> 标签：wpf, listview, expander

我有一个列表视图，我已经为其实现了分组，并在 groupstyle 中定义了一个扩展器，如下所示：

```
<ListView.GroupStyle>
                    <GroupStyle>
                        <GroupStyle.ContainerStyle>
                            <Style TargetType="{x:Type GroupItem}">
                                <Setter Property="Margin" Value="0,0,0,5"/>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="{x:Type GroupItem}">
                                            <Expander IsExpanded="True" >
                                                <Expander.Header>
                                                    <DockPanel>
                                                        <TextBlock FontWeight="Bold" Text="{Binding Path=Name}" Margin="5,0,0,0" Width="100"/>
                                                        <TextBlock FontWeight="Bold" Text="{Binding Path=ItemCount}"/>
                                                        <TextBlock FontWeight="Bold" Text=" Items"/>
                                                    </DockPanel>
                                                </Expander.Header>
                                                <Expander.Content>
                                                    <ItemsPresenter />
                                                </Expander.Content>
                                            </Expander>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </GroupStyle.ContainerStyle>
                    </GroupStyle>
                </ListView.GroupStyle> 
```

我想修改扩展器，以便仅扩展一个，如果存在多个扩展器，并且如果我想以编程方式扩展任何一个扩展器，即假设我从 cs 添加一个对象并想显示该扩展器打开了，应该是可以的，有什么建议吗？？提前致谢

编辑：绑定列表视图和组的代码：

```
CollectionViewSource viewSource = new CollectionViewSource { Source = TO_DOlst };
        viewSource.GroupDescriptions.Add(new PropertyGroupDescription("timeCategory"));
        lstView.ItemsSource = viewSource.View; 
```

timecategory 是类的成员

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T20:05:20.923

您可以通过在您的类中创建一个布尔属性来绑定 IsExpanded 属性，就像 Name 一样，并直接在 CS 中定义所有业务规则。

```
if(ItemsSource.Count() > 1)
  //set IsExpanded = false;
else
  // set only first item and so on. 
```

问候。

# applescript - AppleScript 和加载代码库

> ID：12288438
> 
> 赞同：0
> 
> 时间：2012-09-05T19:28:48.490
> 
> 标签：applescript, static-libraries

纯粹作为一个实验，我试图用 AppleScript 做一些相当复杂的事情，主要是作为一个学术练习，而不是任何事情，但我遇到了麻烦。这是正在发生的事情。

首先，我有一个名为“ascr_code_library.scpt”的代码库，其中只包含一个方法：

```
on return_string_position(this_item, this_str, delim)
    set old_delims to AppleScript's text item delimiters
    set AppleScript's text item delimiters to delim
    set this_list to text items of this_str
    set found_pos to 0
    repeat with i from 1 to the count of this_list
            if item i of this_list is equal to this_item then set found_pos to i
    end repeat
    set AppleScript's text item delimiters to old_delims
    return found_pos
end return_string_position 
```

然后，我有这个脚本，“test-2.scpt”。它的作用非常简单，而且不言自明：

```
set scr_lib to load script (choose file with prompt "Please pick a library")

tell scr_lib
    return_string_position("Who", "Who am I?", " ")
end tell 
```

但是当我运行脚本并选择文件时得到的是以下错误：

*“«data scpt4D617259332E303000000000000000000000000000000000000000000000 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 . . . . . . . （等等，共四页）。. . 1000101010CFADEDEAD» 不理解 return_string_position 消息。”*

那么我哪里错了？据我所知，它正在正确加载脚本。但是在这样一个简单的脚本中，我还能在哪里出错呢？我尝试在方法调用前加上“my”，但这也不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T20:14:59.517

As mentioned in [your previous question](https://stackoverflow.com/questions/12284673/why-wont-this-short-bit-of-code-work), I like this script better because it avoids delimiters and returns each instance.

```
on return_string_position(this_item, this_str)
    set theWords to every word of this_str
    set matchedWords to {}
    repeat with i from 1 to count of theWords
        set aWord to item i of theWords
        if item i of theWords = this_item then set end of matchedWords to i
    end repeat
    return matchedWords
end return_string_position

return_string_position("very", "The coffee was very very very very very ... very hot.") 
```

You can call the script like this:

```
run script file ((path to desktop as text) & "test 1.scpt") with parameters {"very", "The coffee was very very very very very ... very hot."} 
```

# c# - 将数据从一行插入另一行时出现数据截断消息

> ID：12288440
> 
> 赞同：0
> 
> 时间：2012-09-05T19:28:59.070
> 
> 标签：c#, datarow

有没有办法让数据在从
一行插入另一行时被截断？现在发生的事情是，如果其中一个字段太长，它会出现错误并且不会添加行。

这是我拥有的一段代码：

```
DataRow dr = dt.NewRow();  
for (int j = 0; j < edi50.Columns.Count; j++)  
    dr[j] = dr50[j];

dt.Rows.Add(dr);  

try  
{  
    RemoveNulls(dt);  
    daEDI40050.Update(dt);  
}  
catch (Exception e)  
{  
    string m = e.Message;  
} 
```

我有一个 25 个字符长的描述字段，但数据是 34 个字符。我希望能够让它插入 25 并截断其余部分并仍然添加行。

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T19:34:28.820

如果您知道哪个列有限制，以及该列映射到哪个字段，那么只需在调用 Update() 之前截断所有对象上的字段值：

```
myObject.StringField = myObject.StringField.Substring(0,25); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T19:47:30.050

您可以先从数据库中获取架构（未经测试）：

```
DataTable schema;
using (var con = new System.Data.SqlClient.SqlConnection(conStr))
{
    var getSchemaSql = String.Format("SELECT * FROM {0}", tableName);
    using (var schemaCommand = new System.Data.SqlClient.SqlCommand(getSchemaSql, con))
    {
        con.Open();
        using (var reader = schemaCommand.ExecuteReader(CommandBehavior.SchemaOnly))
        {
            schema = reader.GetSchemaTable();
        }
    }
} 
```

然后是类似的东西：

```
for (int j = 0; j < schema.Rows.Count; j++)
{
    DataRow schemaRow = schema.Rows[j];
    Type dataType = schemaRow.Field<Type>("DataType");
    int columnSize = schemaRow.Field<int>("ColumnSize");
    if (dataType.FullName == "System.String")
    {
        String value = dr50[j] as String;
        if (value != null)
            value = value.Substring(0, columnSize);
    } 
 } 
```

同样，完全未经测试并从头开始编写，但它可能会让您了解如何获取列大小。当然，这仅适用于`string`，但我认为这就是您想要的。

# c - ELOG 消息在哪里？

> ID：12288441
> 
> 赞同：3
> 
> 时间：2012-09-05T19:29:02.500
> 
> 标签：c, postgresql, postgis, pgrouting

我正在使用一个 C 库，`librouting_darp.dll`它使用该函数`elog`来记录其进程的调试消息。但我不知道在哪里查找该函数正在记录的消息。

你知道我在哪里可以找到这些消息吗？

--

注意：我不知道`elog`是“C”函数还是“PostgreSql”函数。

[在这里](https://github.com/pgRouting/pgrouting/blob/darp/extra/darp/src/darp_solver.cpp "这个")你可以找到我正在谈论的源代码。

我正在使用 PgAdmin + PostgreSql + PostGis + PgRouting 来调用这个名为 DARP 的函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T19:45:32.247

这是一个支持多个调试级别的[PostgreSQL 函数](http://www.postgresql.org/docs/8.3/static/error-message-reporting.html)，并非所有调试级别都默认保存。您可以通过 log_min_messages 设置进行配置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T19:39:22.580

如果是 Windows，我会查看`eventvwr`Windows 事件查看器。

我还要检查 C:\Program Files\PostgreSQL\XXX\data\pg_log

# javascript - 如何使 cookie 支持此链接列表？

> ID：12288444
> 
> 赞同：0
> 
> 时间：2012-09-05T19:29:16.650
> 
> 标签：javascript, jquery

我正在尝试为我的网站创建一个个人链接框，以便我的访问者可以将他们最喜欢的 10 个链接添加到一个框中。

到目前为止，我已经可以添加和删除链接，但我真正苦苦挣扎的是如何将其保存到用户 cookie 中，以便当用户返回网站时，它会记住前 10 个列表？

而且，是否可以使用 jQuery 添加拖放功能以让用户对链接位置进行排序？

```
<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title> - jsFiddle demo</title>

  <script type='text/javascript' src='http://code.jquery.com/jquery-1.8.0.js'></script>

  <link rel="stylesheet" type="text/css" href="/css/normalize.css">
  <link rel="stylesheet" type="text/css" href="/css/result-light.css">

  <style type='text/css'>
   body { font-size:11px; font-family:Arial, Helvetica, sans-serif;}
#linklist img {width:12px; height:12px;}
#linklist .link {padding:5px 4px 5px 5px; border-bottom:1px solid #EFEFEF;}
#linklist .link:hover {background:#f7f7f7;}
#linklist .link_add {}
#linklist input[type="text"] {padding:8px; border-radius:2px; border:1px solid #CCC; width:270px;} 
  </style>

<script type='text/javascript'>//<![CDATA[ 
$(window).load(function(){
$(function() {
    $('#linklist').on('click',  '.link img', function() {
        if (confirm('Vil du virkelig slette denne lenken ?')) {
            $(this).closest('.link').remove();
        }
    });

    $('#submit').on('click', function() {
        if ($("#lenke").val() == '' || $('#tittel').val() == '') {
            alert('Begge feltene må fylles ut!');
            return;
        }
        if ($('.link').length > 9) {
            alert('Du kan kun legge til ti lenker, slett noen av de andre først !');
            return;
        }
        $('.link').last()
                  .after($('<div />', {'class':'link'})
                  .append('<div style="float:right;"><img src="images/cross.png" /></div>')
                  .append('<div style="clear:both;"></div>')
                  .prepend(
                      $('<div />', {style:"float:left"})
                               .append($('<a />', {href: $("#lenke").val(), text: $('#tittel').val()}))
                  ));
        $('#lenke, #tittel').val('');
    });
});
});//]]>  

</script>

</head>
<body>

<div style="width:300px;">
<h3>Personlige linker</h3>
<div id="linklist" class="frame">

<div class="link">
<div style="float:left;"><a href="#">Jakt og Fiskebutikken</a></div>
<div style="float:right;"><img src="images/cross.png" /></div>
<div style="clear:both;"></div>
</div>

<div class="link">
<div style="float:left;"><a href="#">Maritim.no</a></div>
<div style="float:right;"><img src="images/cross.png" /></div>
<div style="clear:both;"></div>
</div>

<div class="link">
<div style="float:left;"><a href="#">Dagbladet.no</a></div>
<div style="float:right;"><img src="images/cross.png" /></div>
<div style="clear:both;"></div>
</div>

<div class="link">
<div style="float:left;"><a href="#">Spillguide</a></div>
<div style="float:right;"><img src="images/cross.png" /></div>
<div style="clear:both;"></div>
</div>

<div class="link">
<div style="float:left;"><a href="#">Båtmagasinet</a></div>
<div style="float:right;"><img src="images/cross.png" /></div>
<div style="clear:both;"></div>
</div>

<div class="link">
<div style="float:left;"><a href="#">Pressfire</a></div>
<div style="float:right;"><img src="images/cross.png" /></div>
<div style="clear:both;"></div>
</div>

<div class="link">
<div style="float:left;"><a href="#">VG Nett</a></div>
<div style="float:right;"><img src="images/cross.png" /></div>
<div style="clear:both;"></div>
</div>

<div class="link">
<div style="float:left;"><a href="#">Dagbladet.no</a></div>
<div style="float:right;"><img src="images/cross.png" /></div>
<div style="clear:both;"></div>
</div>

<div style="clear:both;"></div>

<div class="link_add">
<div style="padding:5px;"><strong>Add title and URL:</strong></div>
<input id="tittel" placeholder="Title" type="text" />
<input id="lenke"  placeholder="http://www..." type="text" />
<input id="submit" style="padding:6px;" value="Add link" type="button" />
</div>
</div>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T19:40:42.317

在您的 onclick 函数（或任何会更改列表的事件）中，您需要跟踪列表中当前的内容。

你可以做类似的事情

```
function listChanged(listObject) {
    $.cookie('myList', listObject);
} 
```

正如 Robin 指出的，您可能需要使用 localStorage。无论如何，您的想法是您希望将整个列表存储在客户端的某个位置，因此只要列表更改，请保存它。

您还需要序列化您的对象，以便检查[JSON.parse() 和 JSON.stringify()](https://developer.mozilla.org/en-US/docs/Using_native_JSON)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T19:37:40.477

使用 HTML5[`localStorage`](http://diveintohtml5.info/storage.html)而不是 cookie。

```
//to set
localStorage.setItem('sitename#link-name', linkUrl) 
```

* * *

```
//to retrieve values for your site
function fetchMyUrls(){
    var myLinks = [];
    for(var i in localStorage)
    {
        if(localStorage[i].indexOf('sitename') == 0){
           myLinks.push({ i : localStorage[i] });
        }
    }
    return myLinks;
} 
```

# javascript - 如何使用 uglifyjs / uglifyjs2 解析 walk 和 eval javascript 表达式

> ID：12288446
> 
> 赞同：4
> 
> 时间：2012-09-05T19:29:20.870
> 
> 标签：javascript, node.js, expression, eval, uglifyjs

如何使用[uglifyjs](https://github.com/mishoo/UglifyJS2)解析 javascript 表达式？虽然是一个优秀的库，但缺乏文档使得它更难理解！

这些链接在一定程度上帮助了我。

*   [https://groups.google.com/forum/?fromgroups=#!topic/uglifyjs/YjWjgl8Qm0c](https://groups.google.com/forum/?fromgroups=#!topic/uglifyjs/YjWjgl8Qm0c)
*   [https://github.com/mishoo/UglifyJS/blob/master/tmp/instrument.js](https://github.com/mishoo/UglifyJS/blob/master/tmp/instrument.js)

现在我知道这是需要做的

*   解析生成 AST
*   创建自定义步行
*   翻译 AST
*   生成代码
*   eval 生成的代码

这个对吗？还是我错过了什么？

一个带有walker代码的简单示例将非常有帮助和赞赏

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T12:36:57.880

我也是 uglifyjs 的新手。我认为它是一个很棒的库，但是它缺乏好的文档或示例。我认为非常好的 uglifyjs 的一种用途是创建一个**静态分析工具**。出于这个原因，我想分享一个我编写的小脚本，它在 js 文件中找到所有具有小名称的变量，例如*var d=3;* 这些变量名称不是很具有描述性，并且难以维护大型程序。所以我要求所有变量名**至少有 3 个字符长。** 为了让事情变得更有趣，我们不应该将 For..loops 和 For..in 循环中的计数器变量标记为缺陷。

也就是说，我们可以创建这个 smallVariables.js。

```
var smallVariableNames = [];

function addBadVariableName(line,value){
    smallVariableNames.push(line + " "+value);
}

var UglifyJS = require("../tools/node"); //Please install node first
var parser = UglifyJS.parser             // Parse input.js file and create AST 
    , fs = require('fs')
    , filename = 'input.js';

var toplevel = UglifyJS.parse(String(fs.readFileSync(filename)));
var walker = new UglifyJS.TreeWalker(function(node){  //walk AST 
var statement = JSON.parse(JSON.stringify(node));

if  (node instanceof UglifyJS.AST_VarDef || node instanceof UglifyJS.AST_Constant) 

    {

    var parentForIn = walker.find_parent(UglifyJS.AST_ForIn); //in order to avoid init vars in for..in loops 
    var parentLoopVariable ="";
    if (parentForIn) {

        parentLoopVariable = JSON.parse(JSON.stringify(parentForIn));
        parentLoopVariable = parentLoopVariable["init"];
        parentLoopVariable = parentLoopVariable["definitions"];
        if (parentLoopVariable)
        parentLoopVariable = parentLoopVariable[0].name["end"].value;
    }
    var parentFor = walker.find_parent(UglifyJS.AST_For); //in order to avoid init vars in for loops 

    if (parentFor) {
         parentLoopVariable = JSON.parse(JSON.stringify(parentFor));
        parentLoopVariable = parentLoopVariable["init"];
        parentLoopVariable = parentLoopVariable["definitions"];
        if (parentLoopVariable)
            parentLoopVariable = parentLoopVariable[0].name["end"].value;
    }

        var expression = statement["name"];
        if (expression) {
            variableName = node.start.value
            if(variableName  && variableName.length < 3 && variableName !== parentLoopVariable)
                {
                    addBadVariableName(node.start.line,variableName); 
                }
        }

    }
});
toplevel.walk(walker);
for (line in smallVariableNames)
    console.log(smallVariableNames[line]); 
```

简而言之，我们的脚本读取“input.js”文件，解析它，走到树上并找到所有这些小变量。

好的，现在我们有了我们的脚本，我们可以如何测试它！我已将脚本保存在文件夹 %UGLIFY-JS%/test/ 安装最快捷的方法（如果您有 node.js 和 uglify.js）是在命令中运行：*node node_modules/uglify-js/test/smallVariables .js*

根据您的输入文件，您将看到一些行号和小变量名称。通过这种方式，您可以放置​​任何适合您需要的规则。AST 树是一个非常强大的工具。

我还发现以下文章非常有用：http: [//lisperator.net/uglifyjs/walk](http://lisperator.net/uglifyjs/walk)

# python - Python time.strptime() 给出错误的结果？

> ID：12288448
> 
> 赞同：1
> 
> 时间：2012-09-05T19:29:42.197
> 
> 标签：python, time, strptime

我正在尝试解析 mbox 格式的电子邮件假脱机。

我有这样做的代码：

```
if string.find(line, 'Date: ') == 0:                     
    try:
        when = time.mktime(time.strptime(line[6:30], "%a, %d %b %Y %H:%M:%S")) 
```

通常它似乎工作正常，除了当 line = 'Date: Sat, 17 Apr 2004 22:29:37 -0400\n' 它似乎给出了错误的结果（22:29:03 而不是 22:29:37 ）。

这是我的 pdb 跟踪：

```
(Pdb) p line
'Date: Sat, 17 Apr 2004 22:29:37 -0400\n'
(Pdb) p time.strptime(line[6:30], "%a, %d %b %Y %H:%M:%S")
time.struct_time(tm_year=2004, tm_mon=4, tm_mday=17, tm_hour=22, tm_min=29, tm_sec=3, tm_wday=5, tm_yday=108, tm_isdst=-1)
(Pdb) 
```

结果似乎延迟了 34 秒。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-05T19:32:49.473

你把你的线切得太短了；第二个值是*排他性*的，不包括在内：

```
>>> line[6:30]
'Sat, 17 Apr 2004 22:29:3'
>>> line[6:31]
'Sat, 17 Apr 2004 22:29:37'
>>> time.strptime(line[6:31], "%a, %d %b %Y %H:%M:%S")
time.struct_time(tm_year=2004, tm_mon=4, tm_mday=17, tm_hour=22, tm_min=29, tm_sec=37, tm_wday=5, tm_yday=108, tm_isdst=-1) 
```

# http - 用户代理字符串中的“Mozilla/5.0”是什么意思？

> ID：12288452
> 
> 赞同：22
> 
> 时间：2012-09-05T19:29:54.543
> 
> 标签：http, browser, user-agent, mozilla

我`$_SERVER['HTTP_USER_AGENT']`用来记录用户登录我的网站后使用的浏览器和操作系统，当我`echo`这样做时，它会向我显示这些

**火狐**

```
Mozilla/5.0 (Windows NT 6.1; rv:10.0.2) Gecko/20100101 Firefox/10.0.2 
```

**铬合金**

```
Mozilla/5.0 (Windows NT 6.1) AppleWebKit/535.19 (KHTML, like Gecko) Chrome/18.0.1025.162 Safari/535.19 
```

**苹果浏览器**

```
Mozilla/5.0 (Windows NT 6.1) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50 
```

**歌剧**

```
Opera/9.80 (Windows NT 6.1; U; en) Presto/2.9.168 Version/11.50 
```

**IE**

```
Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0) 
```

我很想知道为什么在 IE、Safari 和 Chrome 中使用**Mozilla/5.0**前缀？`echo`

# image - HTTPS：不会显示名称中带有 #、" 或 % 的图像

> ID：12288453
> 
> 赞同：2
> 
> 时间：2012-09-05T19:30:02.793
> 
> 标签：image

我有一个网站可以显示 https: 图像就好了。但是，如果图像具有特殊字符，例如 #、" 或 %，则图像将不会显示。我的 url 都是相对的，以便同时容纳 http 和 https。它们都完美地显示在 http 上。示例 URL：/图像/杂项/1_4-20x3_4"-hex-pl_s.jpg。使用 Apache 服务器。使用 Progress Open Edge 进行编程。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T19:33:01.090

`#`并且`%`是 URL 中的保留字符。`#`用于锚点和`%`编码。

尝试`#`用`%23`和`%`替换`%25`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T19:40:25.747

这是因为 URI 转义。

当您的文件名包含 #、" 或 %，例如`file#1%2".jpg`，您应该使用类似

```
<img src="file%231%252%22.jpg"> 
```

检查这个网站： http: [//www.blooberry.com/indexdot/html/topics/urlencoding.htm](http://www.blooberry.com/indexdot/html/topics/urlencoding.htm)

他们甚至在那里有一个（手动）转换器，但你应该明白这一点......

# python - 如何从另一个文件（并使用 Flask）导入自定义 jinja2 过滤器？

> ID：12288454
> 
> 赞同：21
> 
> 时间：2012-09-05T19:30:05.427
> 
> 标签：python, flask, jinja2

我有一个 jinja_filters.py 文件，其中包含我编写的几十个自定义过滤器。现在我有多个需要使用这些过滤器的 Flask 应用程序。（我不确定我的问题是否与 Flask 相关。）

完成我想要的一种hacky方法是：

```
app = Flask(__name__)

import jinja_filters

@app.template_filter('filter_name1')
def filter_name1(arg):
    return jinja_filters.filter_name1(arg)

@app.template_filter('filter_name2')
def filter_name2(arg):
    return jinja_filters.filter_name2(arg)

... 
```

这样做的“正确”方法是什么？

编辑：理想情况下，我不必列出每个过滤器名称。因此，当我向 jinja_filters.py 添加新过滤器时，我不必更新任何其他代码——我的所有应用程序都可以立即使用它。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2014-06-26T16:38:37.200

推荐使用[Flask blueprints](http://flask.pocoo.org/docs/blueprints/)的方法。它的一个用例就是这个功能：

> *   通过蓝图提供模板过滤器、静态文件、模板和其他实用程序。蓝图不必实现应用程序或视图功能。

您只需要创建一个[`flask.Blueprint`](http://flask.pocoo.org/docs/api/#blueprint-objects)对象并使用它来注册您的过滤器，就像使用`flask.Flask`app 对象一样，使用[`Blueprint.app_template_filter`](http://flask.pocoo.org/docs/api/#flask.Blueprint.app_template_filter)装饰器或[`Blueprint.add_app_template_filter`](http://flask.pocoo.org/docs/api/#flask.Blueprint.add_app_template_filter)方法。

```
# filters.py

import jinja2
import flask

blueprint = flask.Blueprint('filters', __name__)

# using the decorator
@jinja2.contextfilter
@blueprint.app_template_filter()
def filter1(context, value):
    return 1

# using the method
@jinja2.contextfilter
def filter2(context, value):
    return 2

blueprint.add_app_template_filter(filter2) 
```

然后你只需要在你的应用对象上注册蓝图：

```
# app.py

import flask
import filters

app = flask.Flask(__name__)
app.register_blueprint(filters.blueprint) 
```

瞧，过滤器已注册。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2012-09-05T20:57:19.700

无论您在哪里设置您的应用程序对象（可能是 app.py），您只需要导入您的自定义过滤器，然后修改 Jinja 环境属性。

```
import jinja_filters

app = Flask(__name__)
app.jinja_env.filters['filter_name1'] = jinja_filters.filter_name1
app.jinja_env.filters['filter_name2'] = jinja_filters.filter_name2 
```

等等。

另一种可能性是使用`inspect`模块来查找所有方法，`jinja_filters`如下所示：

```
from inspect import getmembers, isfunction
import jinja_filters

app = Flask(__name__)

my_filters = {name: function 
                for name, function in getmembers(jinja_filters)
                if isfunction(function)}

app.jinja_env.filters.update(my_filters) 
```

该代码未经测试，但其想法是构建文件中存在的函数名称和函数的字典，`jinja_filters`然后使用您的过滤器更新 Jinja 环境的过滤器字典。

# c# - 将选定项目从一个列表框绑定到另一个列表框

> ID：12288457
> 
> 赞同：0
> 
> 时间：2012-09-05T19:30:13.063
> 
> 标签：c#

我的表单中有两个列表框。我在第一个列表框中绑定了一些数据。现在我必须从第一个列表框中选择项目，并且当我按下这两个列表框之间的按钮时，应该将这些选定的项目绑定到第二个列表框。我可以一次绑定单个项目，但在绑定多个选定项目时遇到问题。

我正在使用以下代码：

```
Hashtable ht = new Hashtable();

            ht.Add(lbCATallSubcat.SelectedValue.ToString(),lbCATallSubcat.Text.ToString());
            int i = 0;
             foreach (string ent in ht.Values) {           
                string[] name = new string[lbCATallSubcat.Items.Count];

                for (i = 0; i < lbCATallSubcat.SelectedItems.Count; i++) {
                    name[i] = lbCATallSubcat.Text;
                    this.lbCATSelectedSubcat.Items.Add(name[i]);                
                }
                lbCATSelectedSubcat.DisplayMember = ht.Values.ToString();
                lbCATSelectedSubcat.ValueMember = ht.Keys.ToString();
            } 
```

# python - QNetworkReply 导致段错误

> ID：12288458
> 
> 赞同：1
> 
> 时间：2012-09-05T19:30:19.970
> 
> 标签：python, segmentation-fault, pyqt4, qnetworkaccessmanager

我正在尝试为基于 PyQt4 的应用程序编写某种 API 客户端。而且，按照[这个文档](http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/html/qnetworkaccessmanager.html#details)，我写了这个代码：

```
from PyQt4 import QtCore, QtNetwork

class API(QtCore.QObject):
    def processResponse(self, response):
        print 'response'
        response.deleteLater()

    def processError(self, error):
        print 'error'

    def authenticate(self, authUrl, login, password):
        manager = QtNetwork.QNetworkAccessManager()
        request = QtNetwork.QNetworkRequest(QtCore.QUrl(authUrl))
        reply = manager.get(request)
        reply.error.connect(self.processError)
        reply.finished.connect(self.processResponse)
        return reply

    def authenticate2(self, authUrl, login, password):
        manager = QtNetwork.QNetworkAccessManager()
        request = QtNetwork.QNetworkRequest(QtCore.QUrl(authUrl))
        self.reply = manager.get(request)
        self.reply.error.connect(self.processError)
        self.reply.finished.connect(self.processResponse)
        return self.reply

p = API()
z = p.authenticate('http://dev.dentv.ru/edda/v1/token/', 'test', 'test')
print z
print z.isFinished() 
```

第一个问题是 - 没有信号 ( `processResponse`, `processError`) 被调用（即使我声明与 的连接`self.connect(.., SIGNAL(..), ..)`）。第二个问题是，当我调用`isFinished`方法时，这段代码会导致最后一行出现段错误。如果我在 API 方法中调用此方法，它可以正常工作。

我在想，原因是`reply`对象被垃圾收集或以某种方式删除，所以我编写了第二个版本的`authenticate`方法，显式`reply`绑定到对象变量。它也会导致段错误。

我的代码有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T19:33:42.510

我是个白痴 ：（

通过绑定`manager`到对象变量而不是`reply`. 经理被垃圾收集（或类似的东西）。

# django - 如果所有字段都是只读的，则在管理员中隐藏保存按钮

> ID：12288462
> 
> 赞同：4
> 
> 时间：2012-09-05T19:30:48.113
> 
> 标签：django, django-admin

我使用以下`get_readonly_fields`方法不允许在 django 的管理界面中编辑对象：

```
def get_readonly_fields(self, request, obj=None):
    if obj == None or request.user.is_superuser:
        return self.readonly_fields

    # marks all fields as readonly otherwise
    fields = [f.name for f in self.model._meta.fields]
    return fields 
```

`save`这完美地工作，但`save and continue editing`仍然出现。他们不会做任何事情，因为所有字段都是只读的。

`save`因此我的问题是：有没有办法根据所有字段是否为只读来隐藏这些按钮？我怎么能实现这个？

**编辑1：**

我知道如何覆盖`admin/submit_line.html`模板，但我想做的是将 , 设置`show_save`为`show_save_as_new`如果`False`我只有只读字段。如何更改这些变量值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T19:39:10.243

在 django/contrib/admin 中有一个名为 submit_line.html 的文件，用于呈现按钮。要覆盖它们，请在您的模板目录中创建一个名为 admin 的文件夹，然后在 admin/submit_line.html 中按照您想要的方式修改它（基于某些规则）。请注意，以这种方式修改它会影响每个管理对象视图页面。

# cucumber - HTML5 画布和 BDD - Cucumber

> ID：12288464
> 
> 赞同：1
> 
> 时间：2012-09-05T19:31:00.513
> 
> 标签：cucumber, html5-canvas, bdd

我最近在学习行为驱动开发（BDD），我发现它对 CRUD Web 应用程序有好处。

像 Cucumber 这样的 BDD 工具是否适合游戏，特别是它们是否适合 HTML5 Canvas 游戏？

是否还有其他适用于 HTML5 画布游戏的 BDD 工具？还是 BDD 仅适用于 CRUD 应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T11:26:05.253

我最近一直在尝试 BDD 和游戏开发。但我正在使用 C# 构建 .NET 和 XNA 框架。我使用 Visual Studio 作为我的 IDE，并使用 SpecFlow 和 NUnit 进行测试。

SpecFlow 是 BDD/Gherkin 工具——作为一个团队，我们一直在讨论游戏并充实一些需求并在 Gherkin 中记录它们......然后从那里开始。关键是将游戏设计为可测试的。

我们已经将游戏引擎从 XNA 所需的主要“游戏循环”实现中抽象出来，因此我们能够加载它并注入它所需的所有依赖项。然后我们在引擎上运行测试，然后对代码进行断言，以确保它的行为正确。

我们很早就决定图形/绘图/声音/等不在测试范围内……如果它们在最终产品中被破坏，那将是非常明显的。我们设法建立的测试套件让我们确信游戏本身的机制正在按预期工作（即游戏对象 A 是否在正确的位置？游戏对象 B 在被射弹 C 击中时会死吗？等等。 ETC。）。

到目前为止，这是一次非常好的体验。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T07:29:35.050

问题是：你能想出在 JavaScript 中与基于画布的游戏交互的方法吗？

实际上，您可以打开 JS 控制台并从那里与游戏进行交互吗？你能在正确的坐标上点击，你能按键吗？最重要的是，你能对游戏输出的内容做出断言吗？

如果答案是肯定的，那么您可以在 JavaScript 中自动化游戏，并且 Cucumber 或 Cucumber.js 绝对可以在此基础上使用。

如果答案是否定的，并且您无法以与上述类似的方式自动化画布内容，那么恐怕没有自动化工具可以完成这项工作。

回答您的第二个问题：BDD 与“CRUD”应用程序完全无关。它是关于描述*行为*和自动化说明这些行为的示例。因此，您几乎可以对任何类型的应用程序采用 BDD 方法。

如果您不应该找到一种方法来自动化您的应用程序，您仍然可以考虑编写场景来记录您的应用程序的（预期）行为。与普遍看法相反，自动化阶段不是强制性的：）

# d - std.algorithm.joiner(string[],string) - 为什么结果元素是 dchar 而不是 char？

> ID：12288465
> 
> 赞同：7
> 
> 时间：2012-09-05T19:31:02.977
> 
> 标签：d, dmd, phobos

我尝试编译以下代码：

```
import std.algorithm;
void main()
{
    string[] x = ["ab", "cd", "ef"]; // 'string' is same as 'immutable(char)[]'
    string space = " ";
    char z = joiner( x, space ).front(); // error
} 
```

编译以`dmd`错误结束：

```
 test.d(8): Error: cannot implicitly convert expression (joiner(x,space).front()) of type dchar to char 
```

更改`char z`为`dchar z`确实修复了错误消息，但我很感兴趣它为什么首先出现。

为什么结果`joiner(string[],string).front()`是 dchar 而不是 char？

[（文档http://dlang.org/phobos/std_algorithm.html#joiner](http://dlang.org/phobos/std_algorithm.html#joiner)对此没有任何内容）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-05T20:20:00.457

所有字符串都被视为`dchar`. 这是因为 a`dchar`保证是单个代码点，因为在 UTF-32 中，每个代码单元都是一个代码点，而在 UTF-8 ( `char`) 和 UTF-16 ( `wchar`) 中，每个代码点的代码单元数量是不同的。因此，如果您在单个`char`s 或`wchar`s 上进行操作，您将在字符片段而不是整个字符上进行操作，这将是非常糟糕的。如果您对 unicode 不太了解，我建议您阅读Joel Spolsky 的[这篇文章](http://www.joelonsoftware.com/articles/Unicode.html)。它很好地解释了事情。

在任何情况下，因为对单个`char`s 和`wchar`s 进行操作没有意义，所以 and 的字符串`char`被`wchar`视为`dchar`( `ElementType!string`is `dchar`) 的范围，这意味着就范围而言，它们没有`length`( `hasLength!string`is `false`-`walkLength`需要使用获取它们的长度），不可切片（`hasSlicing!string`is `false`），不可索引（`isRandomAccess!string`is `false`）。这也意味着从任何类型的字符串构建新范围的任何内容都将导致范围为`dchar`.`joiner`就是其中之一。有一些函数可以理解 unicode 和特殊情况字符串以提高效率，尽可能利用长度、切片和索引，但除非它们的结果最终是原始的切片，否则它们返回的任何范围都必须进行`dchar`s 。

因此，`front`任何范围的字符都将始终是`dchar`，并且`popFront`总是会弹出一个完整的代码点。

如果您对范围不太了解，我建议您阅读[此](http://ddili.org/ders/d.en/ranges.html)内容。这是一本关于 D 的书中的一章，它是在线的，是目前我们所拥有的关于范围的最佳教程。[我们真的应该在dlang.org](http://dlang.org)上获得一篇关于范围（包括它们如何与字符串一起工作）的适当文章，但还没有人开始编写它。无论如何，您至少需要对范围有基本的了解才能使用很多 D 的标准库（尤其是 std.algorithm），因为它非常频繁地使用它们。

# android - 如何在android的另一个屏幕上显示单击的按钮名称？

> ID：12288466
> 
> 赞同：2
> 
> 时间：2012-09-05T19:31:05.167
> 
> 标签：android

> **可能重复：**
> [如何存储和显示用户在 android 中单击的按钮名称（在不同的屏幕中）](https://stackoverflow.com/questions/12262535/how-to-store-and-display-the-button-names-in-different-screensthat-are-clicke)

我在一个屏幕上有几个按钮，我希望只有单击的按钮名称应该显示在下一个屏幕中。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T17:15:56.783

声明一个静态字符串来存储被点击的按钮的名称。

```
public static String buttonName; 
```

现在，每当单击任何按钮时，在字符串中添加该按钮的名称。

```
 myButton.setOnClickListener(new OnClickListener() 
{ @Override 
public void onClick(View v) 
{ buttonName = "myButtonNumberX";
Intent intent = new Intent(context, PickHeatActivity.class); 
startActivity(intent); } 
}
); 
```

然后，在您的新 PickHeatActivity 中，您可以使用 访问按钮的名称**`MyMainActivityName.buttonName`**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T19:36:08.653

我假设您的意思是“如何在按下按钮时启动下一个屏幕并显示名称？”...如果是这样，您可以使用按钮的 onClickListener（或在 xml 的 onClick 属性中定义的方法）按钮）来启动一个[意图](http://developer.android.com/reference/android/content/Intent.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T15:27:04.977

gh 的意思是你需要添加

```
intent.putExtra("someKey", "someValue"); 
```

在 startActivity() 之前。然后，在下一个活动中，您可以执行以下操作：

```
String someVariable = getIntent().getStringExtra("someKey"); 
```

并且您可以在 TextView 中显示 someVariable 或者您想要这样做。只需保持意图传递值即可。

# design-patterns - 在哪个项目中添加对 PetaPoco 的引用？

> ID：12288468
> 
> 赞同：0
> 
> 时间：2012-09-05T19:31:23.920
> 
> 标签：design-patterns, orm, visual-studio-2012, petapoco

我是 Design Patterns 的新手，并参考了 Scott Millet 的一本书：[Professional ASP.NET Design Patterns](https://rads.stackoverflow.com/amzn/click/com/0470292784)。

在讨论“关注点分离”的章节中，我在解决方案资源管理器中相应地添加了项目：

![在此处输入图像描述](../Images/2ef48c21e10f7f926e98e8c128744241.png)

虽然本书展示了 Linq2SQL 的示例，但我想使用 PetaPoco Micro-ORM。因此，我通过 Nuget 安装了 PetaPoco，但我没有关注是将 PetaPoco 添加到所有项目还是仅添加到模型和 WebUI 项目中。

这是 NuGet 在将 PetaPoco 添加到项目时要求确认的方式：

![在此处输入图像描述](../Images/024af1fcb248e198247ad9c4222a7451.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T20:53:50.793

您只需要在一个项目中使用它——Repository 看起来是您解决方案中的最佳候选者。

# ajaxcontroltoolkit - NoBotState 始终为 InvalidBadResponse (AjaxContorlToolKit)

> ID：12288469
> 
> 赞同：2
> 
> 时间：2012-09-05T19:31:33.143
> 
> 标签：ajaxcontroltoolkit

ASPX 代码：

```
<%@ Register Assembly="AjaxControlToolkit" Namespace="AjaxControlToolkit" TagPrefix="cc1" %>

<cc1:ToolkitScriptManager ID="ToolkitScriptManager2" runat="server">
</cc1:ToolkitScriptManager>

<asp:TextBox ID="txtLastNm" runat="server" CssClass="ETextField1"></asp:TextBox>
<asp:ImageButton ID="btnSend" runat="server" ValidationGroup="Send" BorderWidth="0" BackColor="Transparent" ImageUrl="~/images/Buttons/submit.png"  Height="34" Width="100" onclick="btnSend_Click" />

<cc1:NoBot ID="NoBot1" runat="server" OnGenerateChallengeAndResponse="NoBot1_GenerateChallengeAndResponse" ResponseMinimumDelaySeconds="3"
                      CutoffMaximumInstances="5" CutoffWindowSeconds="60" /> 
```

它在本地工作。但是当我将它上传到服务器上时，它每次都会显示`InvalidBadResponse`

我输入登录数据，然后单击 asp 按钮。NoBot 状态为 InvalidBadResponse 并且失败。但是，然后我点击浏览器的刷新按钮，它要求我重新发送请求，我说好的，现在状态有效！为什么？

同样的问题同样的问题：[AjaxControlToolkit NoBotState 总是 InvalidBadResponse](https://stackoverflow.com/questions/7915240/ajaxcontroltoolkit-nobotstate-is-always-invalidbadresponse)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-04T21:30:26.823

在这里查看我的答案：[AjaxControlToolkit NoBotState 总是 InvalidBadResponse](https://stackoverflow.com/questions/7915240/ajaxcontroltoolkit-nobotstate-is-always-invalidbadresponse/16379127#16379127)

基本上，我的 url 重写弄乱了 ASP.NET ajax 框架库的 url，导致它们无法加载——这意味着 Javascript 挑战总是会失败，因为它没有被执行。

# python - OpenCV中基于已知相机方向的透视变形

> ID：12288473
> 
> 赞同：7
> 
> 时间：2012-09-05T19:31:47.893
> 
> 标签：python, opencv, computer-vision

我正在开展一个项目，该项目试图根据相机的已知方向从图像中消除透视失真。我的想法是，我可以根据相机的已知 X、Y 和 Z 方向创建一个旋转矩阵。然后我可以通过 WarpPerspective 方法将这些矩阵应用于图像。

在我的脚本（用 Python 编写）中，我创建了三个旋转矩阵，每个都基于一个方向角。我已经到了一个我被困在两个问题上的地步。首先，当我将每个单独的矩阵加载到 WarpPerspective 方法中时，它似乎无法正常工作。每当我在一个轴上扭曲图像时，它似乎都会显着过度扭曲图像。仅当我将方位角限制在 1 度或以下时，才能识别图像的内容。

其次，如何将三个旋转矩阵组合成一个矩阵以加载到 WarpPerspective 方法中。我可以将 3x3 旋转矩阵导入该方法，还是必须创建一个 4x4 投影矩阵。下面是我正在处理的代码。

谢谢您的帮助。

铬

```
from numpy import *
import cv

#Sets angle of camera and converts to radians
x =  -14 * (pi/180)
y = 20 * (pi/180)
z =  15 * (pi/180)

#Creates the Rotational Matrices
rX = array([[1, 0, 0], [0, cos(x), -sin(x)], [0, sin(x), cos(x)]])
rY = array([[cos(y), 0, -sin(y)], [0, 1, 0], [sin(y), 0, cos(y)]])
rZ = array([[cos(z), sin(z), 0], [-sin(z), cos(z), 0], [0, 0, 1]])

#Converts to CVMat format
X = cv.fromarray(rX)
Y = cv.fromarray(rY)
Z = cv.fromarray(rZ)

#Imports image file and creates destination filespace
im = cv.LoadImage("reference_image.jpg")
dst = cv.CreateImage(cv.GetSize(im), cv.IPL_DEPTH_8U, 3)

#Warps Image
cv.WarpPerspective(im, dst, X)

#Display
cv.NamedWindow("distorted")
cv.ShowImage("distorted", im)
cv.NamedWindow("corrected")
cv.ShowImage("corrected", dst)
cv.WaitKey(0)
cv.DestroyWindow("distorted")
cv.DestroyWindow("corrected") 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-06T04:49:24.870

你做错了几件事。首先，您不能在没有相机模型的情况下在 x 或 y 轴上旋转。想象一下具有令人难以置信的宽视野的相机。您可以将它非常靠近一个物体并看到整个物体，但是如果该物体旋转它的边缘似乎会很快飞向您，并带有强烈的透视失真。另一方面，小视野（想想望远镜）几乎没有透视失真。一个不错的起点是将您的图像平面设置为至少与相机的宽度一样远，并将您的对象放在图像平面上。这就是我在这个例子中所做的（c++ openCV）

步骤是

1.  构造一个旋转矩阵
2.  图像在原点居中
3.  旋转图像
4.  将图像沿 z 轴向下移动
5.  乘以相机矩阵
6.  扭曲视角

* * *

```
//1
float x =  -14 * (M_PI/180);
float y =  20 * (M_PI/180);
float z =  15 * (M_PI/180);

cv::Matx31f rot_vec(x,y,z);
cv::Matx33f rot_mat;
cv::Rodrigues(rot_vec, rot_mat); //converts to a rotation matrix

cv::Matx33f translation1(1,0,-image.cols/2,
                        0,1,-image.rows/2,
                        0,0,1);
rot_mat(0,2) = 0;
rot_mat(1,2) = 0;
rot_mat(2,2) = 1;

//2 and 3
cv::Matx33f trans = rot_mat*translation1;
//4
trans(2,2) += image.rows;
cv::Matx33f camera_mat(image.rows,0,image.rows/2,
                       0,image.rows,image.rows/2,
                       0,0,1);
//5
cv::Matx33f transform = camera_mat*trans;
//6
cv::Mat final;
cv::warpPerspective(image, final, cv::Mat(transform),image.size()); 
```

这段代码给了我这个输出

![在此处输入图像描述](../Images/2471af27635b31c9fe43867987a2f561.png)

在发布此内容之前，我没有看到佛朗哥的回答。他是完全正确的，使用 FindHomography 可以为您节省所有这些步骤。我仍然希望这很有用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-06T03:29:19.150

仅知道旋转是不够的，除非您的图像是使用远心镜头或具有很长焦距的远摄镜头拍摄的（在这种情况下，图像几乎是正交的，并且没有透视失真）。

此外，这不是必需的。的确，您可以通过校准相机（即估计内在和外在参数以形成完整的相机投影矩阵）来撤销图像中一个平面的透视缩短。

但是，如果您可以在图像中识别出一个四边形，该四边形是真实世界正方形（或具有已知宽度/高度比的矩形）的图像，您可以更简单地获得相同的结果。如果你能做到这一点，你可以简单地计算将正方形（矩形）映射到四边形的单应矩阵，然后使用它的逆进行扭曲。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T20:14:00.060

旋转矩阵的[维基百科页面](http://en.wikipedia.org/wiki/Rotation_matrix)显示了如何将三个基本旋转矩阵组合成一个矩阵。

# gdb - 基于内存地址的gdb条件步骤？

> ID：12288484
> 
> 赞同：1
> 
> 时间：2012-09-05T19:32:34.520
> 
> 标签：gdb

我想知道是否可以创建一个脚本，该脚本将根据内存地址值逐步继续程序的执行（在中断之后）。所以，如果我正在跟踪一个函数并且它进入一个高内存值，我会调用 gdb 脚本，直到内存值低于设定值 - 然后它会再次中断。

我对 gdb 很陌生，仍在阅读手册/教程，但我想知道我的目标是否可行 :) - 如果你能把我推向正确的方向，那就更好了 ;)

谢谢！

编辑，用伪代码更新：

```
while (1) {
    cma = getMemoryAddressForCurrentInstruction();
    if (cma > 0xdeadbeef) {
        stepi;
    } else {
        break;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T23:22:12.787

您在谈论[程序计数器](http://en.wikipedia.org/wiki/Program_counter)（有时称为指令指针）。它在 gdb 中以`$pc`. 您的伪代码可以翻译成这个实际的 gdb 命令：

```
while $pc <= 0xdeadbeef
    stepi 
```

它会很慢，因为它会为每条指令启动和停止程序，但据我所知，如果您不确切知道要查找的地址，则没有快速的方法可以做到这一点。如果你这样做了，那么你可以在那里设置一个断点：

```
break *0xf0abcdef
cont 
```

将运行直到程序计数器达到 0xf0abcdef

# c++ - 如何有效地从 std::set 中选择随机元素

> ID：12288486
> 
> 赞同：12
> 
> 时间：2012-09-05T19:32:41.423
> 
> 标签：c++, algorithm, stl

如何有效地从 a 中选择一个随机元素`std::set`？

A`std::set::iterator`不是**随机访问迭代器**。所以我不能直接索引一个随机选择的元素，就像我可以为 a `std::deque`or`std::vector`

我*可以*获取从返回的迭代器并在 [ , )`std::set::begin()`范围内随机增加它的次数，但这似乎做了很多不必要的工作。对于接近集合大小的“索引”，我最终会遍历内部树结构的整个前半部分，即使已经知道该元素不会在那里找到。`0``std::set::size()`

**有更好的方法吗？**

以效率的名义，我愿意将“随机”定义为比我可能用来在向量中选择随机索引的任何方法*更不随机。*称之为“合理随机”。

**编辑...**

下面有很多有见地的答案。

简短的版本是，即使您可以在*log(n)时间内找到**特定*元素，您也无法通过接口在该时间内找到*任意元素。***`std::set`**

 *** * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-05T19:50:59.127

改用[`boost::container::flat_set`](http://www.boost.org/doc/libs/1_48_0/doc/html/boost/container/flat_set.html)：

```
boost::container::flat_set<int> set;
// ...
auto it = set.begin() + rand() % set.size(); 
```

虽然插入和删除变成了 O(N)，但我不知道这是否是个问题。您仍然有 O(log N) 查找，并且容器是连续的这一事实提供了整体改进，通常超过 O(log N) 插入和删除的损失。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-05T19:41:21.177

导致随机树遍历的`find`(or )谓词怎么样？`lower_bound`您必须告诉它集合的大小，以便它可以估计树的高度，有时会在叶节点之前终止。

编辑：我意识到这个问题是`std::lower_bound`需要一个谓词但没有任何树状行为（在内部它使用`std::advance`在另一个答案的评论中讨论）。 `std::set<>::lower_bound`使用集合的谓词，它不能是随机的并且仍然具有类似集合的行为。

**啊哈**，您不能使用不同的谓词，但可以使用可变谓词。由于`std::set`通过值传递谓词对象，因此您必须使用 a`predicate &`作为谓词，以便您可以访问并修改它（将其设置为“随机化”模式）。

这是一个准工作示例。不幸的是，我无法将我的大脑包裹在正确的随机谓词上，所以我的随机性不是很好，但我相信有人可以解决这个问题：

```
#include <iostream>
#include <set>
#include <stdlib.h>
#include <time.h>

using namespace std;

template <typename T>
struct RandomPredicate {
    RandomPredicate() : size(0), randomize(false) { }
    bool operator () (const T& a, const T& b) {
        if (!randomize)
            return a < b;

        int r = rand();
        if (size == 0)
            return false;
        else if (r % size == 0) {
            size = 0;
            return false;
        } else {
            size /= 2;
            return r & 1;
        }
    }

    size_t size;
    bool randomize;
};

int main()
{
    srand(time(0));

    RandomPredicate<int> pred;
    set<int, RandomPredicate<int> & > s(pred);
    for (int i = 0; i < 100; ++i)
        s.insert(i);

    pred.randomize = true;
    for (int i = 0; i < 100; ++i) {
        pred.size = s.size();
        set<int, RandomPredicate<int> >::iterator it = s.lower_bound(0);
        cout << *it << endl;
    }
} 
```

我半生不熟的随机性测试是`./demo | sort -u | wc -l`看看我得到了多少个唯一整数。使用更大的样本集尝试`./demo | sort | uniq -c | sort -n`寻找不需要的模式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-05T19:50:11.990

*如果*您可以访问底层的红黑树（假设存在一个），那么您可以访问 O(log n) 中的随机节点，选择 L/R 作为`ceil(log2(n))`-bit 随机整数的连续位。但是，您不能，因为标准没有公开底层数据结构。

Xeo 将迭代器放置在向量中的解决方案是 O(n) 时间和空间来设置，但总体上摊销常数。`std::next`这与O(n) 时间相比是有利的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-05T19:44:56.107

您可以使用以下`std::advance`方法：

```
set <int> myset;
//insert some elements into myset
int rnd = rand() % myset.size();
set <int> :: const_iterator it(myset.begin());
advance(it, rnd);
//now 'it' points to your random element 
```

另一种方法，可能不太随机：

```
int mini = *myset().begin(), maxi = *myset().rbegin();
int rnd = rand() % (maxi - mini + 1) + mini;
int rndresult = *myset.lower_bound(rnd); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-05T19:52:06.273

如果集合不经常更新或者您不需要经常运行此算法，请将数据的镜像副本保存在 a 中`vector`（或仅根据需要将集合复制到向量）并从中随机选择。

如评论中所见，另一种方法是将迭代器向量保留在集合中（它们仅在删除`set`s 的元素时无效）并随机选择一个迭代器。

最后，如果您不需要基于树的集合，您可以使用`vector`or`deque`作为您的底层容器并在需要时进行排序/唯一化。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-05T20:10:42.853

您可以通过维护一个正常的值数组来做到这一点；当您插入到集合中时，您将元素附加到数组的末尾（**O(1)**），然后当您想要生成一个随机数时，您也可以从**O(1)**中的数组中获取它。

当您想从数组中删除元素时，问题就来了。最天真的方法将采用**O(n)**，这可能足以满足您的需求。但是，可以使用以下方法将其改进为**O(log n) ；**

保留，对于`i`数组中的每个索引，`prfx[i]`，它表示数组中范围内未删除元素的数量`0...i`。保留一个分段树，您可以在其中保留`prfx[i]`每个范围中包含的最大值。

Updating the segment tree can be done in **O(log n)** per deletion. Now, when you want to access the random number, you query the segment tree to find the "real" index of the number (by finding the earliest range in which the maximum `prfx` is equal to the random index). This makes the random-number generation of complexity **O(log n)**.**

# actionscript-3 - 将 Flash 游戏打包到 AIR 移动 (IPA)

> ID：12288487
> 
> 赞同：2
> 
> 时间：2012-09-05T19:32:44.587
> 
> 标签：actionscript-3, mobile, air

我有一个使用多个库、swc、资产等的复杂游戏项目。输出是两个 swf 文件（带有菜单的外壳和游戏本身）。由于很多问题和设置 ANT，IPA (iOS) 中的打包无法立即工作。但是构建为 swfs 工作正常。

是否可以创建一个单独的移动 as3 项目，它将第一个 swf 加载到全屏，它将加载第二个 swf，然后构建它？如何最好地做到这一点？或者还有其他选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T20:35:16.283

尝试这个：

1.  将主游戏 swf 的副本编译为*swc*。
2.  在您的菜单 swf 的副本中，将其指向游戏 swc，然后在您通常会加载外部游戏 swf 的地方，直接添加根游戏类的新实例：

    ```
    // Before:
    var ldr:Loader = new Loader();
    ... other stuff, progress monitoring, etc. ...
    var mcGame:MovieClip = ldr.content as MovieClip;

    // After - one line:
    import my.game.namespace;
    var mcGame:GameClass = new GameClass(); 
    ```

3.  将此更新的菜单项目编译为 swc。

4.  在您的移动应用程序中，添加菜单阶段的根类的实例：

    ```
    // Constructor for root class of mobile app   
    public function AppRoot() { 
        this.addChild(new GameMenu());
    } 
    ```

现在一切都捆绑在一个编译项目中。

# javascript - 如何使用 Javascript 或 jQuery 代码调用 mousemove

> ID：12288495
> 
> 赞同：2
> 
> 时间：2012-09-05T19:32:59.130
> 
> 标签：javascript, jquery, dom-events

我知道如果您移动鼠标，该事件将调用但是我如何仅在代码的帮助下调用该事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T19:36:11.240

AFAIK 如果这是问题，您将无法移动用户的鼠标指针。
这将被称为**“鼠标劫持”**；）

不知道你为什么问，但是，
如果你的目标是模拟点击另一个元素，你可以这样做：

```
$('#element_1').click(function(){
    $('#element_2').click();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T19:40:35.717

如果你有一个想要触发事件的 jQuery 元素，你需要 trigger 方法

```
var $t = jQuery('#idToElement');
$t.trigger('mousemove',['parameter1','parameter2']); 
```

如果您想使用纯 javascript 执行此操作，则需要文档对象的 createEvent 函数。您可以在[此处找到更多相关信息](http://www.kaizou.org/2010/03/generating-custom-javascript-events/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T18:32:29.140

jQuery中的触发事件可以帮助你很多

# informatica-powercenter - 在 Informatica 工作流中在运行时更改数据源连接

> ID：12288497
> 
> 赞同：1
> 
> 时间：2012-09-05T19:33:08.350
> 
> 标签：informatica-powercenter, informatica

我有一个映射，我需要能够针对多个源模式（具有相同的结构）运行一次一个模式。鉴于模式的数量，我宁愿不为每个模式设置会话以指定特定的映射连接，因为这将需要在添加新模式时添加新会话。

是否可以通过在运行时定义会话内映射的数据源连接（或作为某种参数传入）的方式设置工作流？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T08:52:13.060

1.  配置工作流或会话以使用参数文件。
2.  在会话设置中，将“硬编码”源连接（选项*Use object*）更改为*Use Connection Variable*并输入带`$DBConnection`前缀的变量名称（例如`$DBConnectionSource01`）。
3.  在适当的位置创建一个参数文件，内容如下：

    `[Global]`
    `$DBConnectionSource01=connection_name`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T09:30:37.567

我相信您正在寻找的内容将使用参数文件和一些 shell 脚本来解决（假设您的服务器具有某种 Unix 风格）。

设置您的工作流程以使用参数文件运行。在参数文件全局部分中为数据库连接声明一个特殊参数（以 $DBConnection 开头）。更改会话属性以使用该参数。

您需要为每个源数据库/模式创建适当的关系连接对象。

现在，编写一些 shell 程序来动态更改该参数文件，并将参数文件中的参数值替换为您想要的新值。

运行时的典型事件序列应如下所示 -

1.  每当您想为不同的源运行该工作流/会话/映射时，使用适当的参数启动脚本以影响 Informatica 参数文件中的更改。

2.  运行 Shell 脚本以启动给定数据库源的作业。脚本运行应更改参数文件中的 $DBConnection 参数

3.  使用参数文件通过 pmcmd 启动工作流。

# c# - 在 ASP.NET Membership 中，为什么 resetPassword 会导致“不支持指定方法”错误？

> ID：12288498
> 
> 赞同：3
> 
> 时间：2012-09-05T19:33:14.447
> 
> 标签：c#, asp.net-membership, asp.net-mvc-4

使用 System.Web.Security；

我在 MVC4 中创建了一个 resetPassword 表单：

```
using System.Web.Security;

[HttpPost]
[AllowAnonymous]
public ActionResult ResetPassword(ResetPasswordModel model)
{
    MembershipUser u = Membership.GetUser(model.Username);

    if (HashResetParams(u.UserName, u.ProviderUserKey.ToString()) == model.Key)
    {
        string resetCode = u.ResetPassword();
        u.ChangePassword(resetCode, model.Password);
    }

    return View("ChangePasswordSuccess");
} 
```

知道为什么我在上线时收到“不支持重置密码指定的方法”错误：

```
string resetCode = u.ResetPassword(); 
```

我想知道它是否与默认使用 SimpleMembership 实现的 MVC4 项目有关。

另外，我已经看到了有关如何在 ASP.NET Membership 中重置密码的各种方法，也许有更好的方法？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-19T11:09:52.873

尝试使用：

```
string token = WebSecurity.GeneratePasswordResetToken(userName);
WebSecurity.ResetPassword(token, newPassword); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T19:45:49.797

如果您使用的是[SimpleMembershipProvider](http://msdn.microsoft.com/en-us/library/webmatrix.webdata.simplemembershipprovider%28v=vs.111%29.aspx)，则可以：

> 按照设计，SimpleMembershipProvider 类没有实现 ASP.NET 成员资格提供程序中可能的全部功能，正如所有 ASP.NET 成员资格提供程序使用的 MembershipProvider 类中所定义的那样。类中的某些成员是可用的，因为它们是从基类继承的，但如果您访问它们会抛出异常。

另一种方法是使用[SqlMembershipProvider](http://msdn.microsoft.com/en-us/library/system.web.security.sqlmembershipprovider.aspx)

您的 web.config 中应该有类似的内容：

```
<membership defaultProvider="SqlProvider"
      userIsOnlineTimeWindow="15">
      <providers>
        <add 
          name="SqlProvider" 
          type="System.Web.Security.SqlMembershipProvider" 
          connectionStringName="SqlServices"
          applicationName="MyApplication"
          enablePasswordRetrieval="false"
          enablePasswordReset="true"
          requiresQuestionAndAnswer="true"
          requiresUniqueEmail="false"
          passwordFormat="Hashed"
          maxInvalidPasswordAttempts="5"
          passwordAttemptWindow="10" />
      </providers>
    </membership> 
```

# google-apps-script - 谷歌脚本运行垃圾文档

> ID：12288499
> 
> 赞同：0
> 
> 时间：2012-09-05T19:33:22.230
> 
> 标签：google-apps-script

我已经删除了电子表格，其中包含以定时频率运行的脚本。我还设置了通知，以便在脚本出现错误时通知我。

自从删除它们后，我收到了源源不断的失败通知，我无法停止，有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T13:58:13.220

您是否清空了 Google Drive/Docs 中的垃圾箱？这通常可以解决问题...

# .net - 处理自托管 WCF Web 服务中的并发请求

> ID：12288506
> 
> 赞同：4
> 
> 时间：2012-09-05T19:33:44.270
> 
> 标签：.net, wcf, web-services, concurrency, self-hosting

我开始开发以下场景（Visual Studio 2010，WCF）：我们网络中的不同客户端将调用我自己开发的 Web 服务，该服务作为 Windows 服务的一部分托管，所以我们谈论的是自托管 WCF Windows 服务中的 Web 服务。

自托管的 WCF Web 服务将依次调用外部 Web 服务，因此其行为就像一种门面。

显然，我的自托管 WCF Web 服务将需要接受并发调用，我的问题来了：我打算在我的自托管 WCF Web 服务上从不同客户端调用的操作中，我只需为外部 web 服务，调用外部 web 服务，从外部 web 服务获取同步响应，然后回复调用客户端。

听起来很简单，但是关于进入我的服务主机的多个线程有什么需要考虑的吗？显然，我需要小心主机本身中的任何“全局”变量，但如果我只是在被调用的 Web 服务的不同操作中创建外部 Web 服务客户端，我应该保存，还是我忽略了一些东西？

谢谢大家！

干杯，斯蒂沃

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-05T19:57:40.587

您在这里有几个选择，特别是当它们与 WCF 实例化和并发相关时。

实例化：您的选择是

*   **PerCall**：为每个客户端请求创建一个新的 InstanceContext（因此也是服务对象）。
*   **PerSession**：为每个新的客户端会话创建一个新的 InstanceContext（因此是服务对象），并在该会话的生命周期内维护（这需要支持会话的绑定）。
*   **Single**：单个 InstanceContext（因此也是服务对象）处理应用程序生命周期内的所有客户端请求。

并发：

*   **Single**：每个实例上下文一次最多允许有一个线程处理实例上下文中的消息。希望使用相同实例上下文的其他线程必须阻塞，直到原始线程退出实例上下文
*   **多个**：每个服务实例可以有多个线程同时处理消息。服务实现必须是线程安全的才能使用这种并发模式。
*   **可重入**：每个服务实例一次处理一条消息，但接受可重入操作调用。该服务仅在通过 WCF 客户端对象调用时才接受这些调用。

让我们先看看实例化：

**每次调用**：基本上，如果两个客户端调用您的服务，则会创建 2 个不同的服务实例，然后在调用完成后销毁

**每个会话**：如果这两个客户端分别通过您的代理进行 2 次调用，则在您的主机上为这两个调用创建的 wcf 实例将是相同的（对于每个代理，因此 2 个实例分别为 2 个服务，但每个调用者都转到同一个实例） , 然后销毁

**Single** : 两个代理/客户端将使用同一个实例，因此调用者 1 调用一个操作，然后调用者 2 进行调用，这个相同的实例将被重用。

很直接。

就并发而言，它是上述实例上下文中一次活动的线程数。这里我支持经验和 MSDN，它指出“理解和开发安全地使用多个线程的代码可能很难编写”（**但并非不可能**）

因此，根据您的要求，您似乎不想维护状态和可伸缩性，因为您正在为多个代理调用提供服务，并且您不需要共享任何需要单实例模式的全局数据，那么最可能的解决方案是：

```
[ServiceBehavior
(ConcurrencyMode.Single,
 InstanceContextMode=InstanceContextMode.PerCall)] 
public class YourService: IYourService
{
} 
```

# jquery - 如何专注于 qtip 中的元素（jquery 插件）

> ID：12288507
> 
> 赞同：2
> 
> 时间：2012-09-05T19:33:50.933
> 
> 标签：jquery, focus, qtip, qtip2

我正在尝试打开一个 qtip (v2.0.0) 并让它专注于一个链接——菜单中的第一项。（更一般地说，我试图将这个美妙的 qtip 用作一种上下文菜单，并将焦点放在第一个 li/menu 项上，这样他们就可以方便地按 Enter 而不必单击。）所以......

```
$("tr.request td").qtip({
        content : {
            text: $('#qtipMenu').clone(),
            title : {button : true, text : ' '}
        },
        position : {my : 'bottom center' , at : 'top center'},
        show : {event : 'click'},
        hide : false, 
        events : {
            show : function(){ 
                var selector =  "#"  + this.id + " ul > li:first > a " ;

                // for the sake of experiment...
                $(selector).focus(function(){console.warn("focus on this "+this.tagName + " element!") })
                // and the callback fires, but...
                $(selector)[0].focus(); // doesn't work
                $(selector).focus(); // doesn't work either
                // nor does this:
                $("div.ui-tooltip-content ul > li:first > a").focus();
                // ...though I know I'm definitely addressing this element
                // and can manipulate it in other ways
            },
            render : function(event) {
                $("div.ui-tooltip-content ul").removeAttr('id').show()
            }
        }
    });
} 
```

FWIW，每个 qtip 的内容都是从隐藏的 UL 元素中克隆出来的，因此：

```
<ul id="qtipMenu" style="display:none" class="qtip-menu">
   <li><a href="admin/requests/view">view details</a></li>
   <li><a href="admin/requests/add">add to schedule</a></li>
   <li><a href="admin/requests/delete">delete</a></li>
</ul> 
```

是的，它包含在 $(document).ready(function(){}) 中。“焦点”事件处理程序按预期触发，但浏览器 UI 的实际焦点没有发生（希望我清楚地解释自己）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-06T15:26:46.413

答案是……在“可见”而不是“展示”上做。“可见”发生在“显示”之后

```
$(myTarget).qtip( {

    events: {
        visible : function() {  $(myElementWithinTheTooltip).focus() }
    }
); 
```

愿它为别人节省几个小时的痛苦。我将把它留给忍者来解释时间的内部微妙之处导致了我的问题。

# java - struts2 会话超时重新登录到上次访问的页面

> ID：12288508
> 
> 赞同：0
> 
> 时间：2012-09-05T19:33:54.733
> 
> 标签：java, jsp, jakarta-ee, struts2

我的应用程序是使用 Struts2 开发的，我有一个拦截器，可以根据会话属性验证用户是否登录。现在让我们说会话超时并且用户尝试再次登录。登录成功后，我如何处理重新登录用户并将用户引导回他们正在处理的最后一页......比如说 page3.jsp？

loginInterceptor 是

```
 public class LoginInterceptor extends AbstractInterceptor {
  @Override
   public String intercept(final ActionInvocation invocation) throws Exception {
    Map<String, Object> session = ActionContext.getContext().getSession();

   String userLoggedin = (String) session.get("userLoggedin ");
    Object action = invocation.getAction();

    // user is not logged in yet
    if(userLoggedin == null){       

        // public pages that dont require login
        if (action instanceof LoginNotRequired) {
              return invocation.invoke();

        }

        // Pages that require the user to be logged in - user not logged in yet
        if (!(action instanceof LoginAction)) {
             return "loginRedirect";

        }       

    }

    // user is logged in
    if (userLoggedin.equals("true")) {
         return invocation.invoke();

    }

    return invocation.invoke();
} 
```

}

struts.xml 定义

```
 <interceptors>
        <interceptor name="login" class="com.mypackage.LoginInterceptor">                
             </interceptor>
        <interceptor-stack name="myStack">
            <interceptor-ref name="login"></interceptor-ref>
             <interceptor-ref name="defaultStack"></interceptor-ref>
        </interceptor-stack>
    </interceptors>

    <default-interceptor-ref name="myStack"></default-interceptor-ref>

    <global-results>
        <result name="loginRedirect" type="redirect">/index.jsp</result>
    </global-results> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T19:52:22.340

您需要在会话删除期间保留信息。这意味着应用程序范围内的`user id/name`=>`last page`映射、数据库等以及根据用户的最后请求保持此信息最新的拦截器。

您也可以将这些信息保存在客户端上，例如保存在 cookie 中。

登录将简单地检查所述数据的存在并在找到时重定向到它。

这有很多潜在的问题。例如，如果用户的工作流程依赖于他们会话中的特定信息，那么该信息现在已经消失，需要恢复。

# android - 高级自定义小部件

> ID：12288509
> 
> 赞同：2
> 
> 时间：2012-09-05T19:33:55.387
> 
> 标签：android, android-widget, custom-controls

我搜索了很多，并花了很多时间试图弄清楚如何创建自定义 Android UI 小部件（在代码和 xml 中）。但是有一些限制我不知道如何绕过。因此，我模拟了一个虚构的按钮，并想知道如何实现它。

这对我有很大帮助，而且我确信我不是唯一一个在创建自定义 Android 小部件时遇到问题的人。

![在此处输入图像描述](../Images/e958d9ad9adfa512fac0edd638d46216.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T20:59:45.603

关于多色背景，我成功地使用了形状可绘制对象。

例如，要定义一个灰色实心区域，然后是一个渐变到黑色的渐变，以及一个黑色实心区域：

```
<?xml version="1.0" encoding="utf-8"?>
<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
<item>
    <shape android:shape="rectangle">
        <corners android:radius="10px" />
        <solid android:color="#FF444444"/>
    </shape>
</item>
<item
    android:left="45dp">
    <shape android:shape="rectangle">
        <gradient
        android:angle="0"
        android:centerX="15%"
        android:startColor="#FF444444"
        android:centerColor="#FF000000"
        android:endColor="#FF000000"
        android:type="linear"/>
    </shape>
</item>
    <item>
    <shape android:shape="rectangle">
        <corners android:radius="10px" />
        <stroke
            android:width="2px"
            android:color="#FF444444" />
        <solid android:color="#00000000"/>
    </shape>
</item>
</layer-list> 
```

这里最酷的是分层形状（*项目*）。它应该允许您定义一个黄色三角形、一个红色三角形和一个绿色矩形。

上面的布局呈现如下： ![快照](../Images/fe56c94b9f7f2b81e5685eb768a96b4f.png)

（上述布局未呈现图标和文本）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-03T11:00:51.050

为背景创建一个形状：

```
<shape xmlns:android="http://schemas.android.com/apk/res/android"
   android:shape="rectangle">
   <solid android:color="@color/GREEN"/>
   <stroke
        android:width="2dp"
        android:color="@color/GREEN"/>
</shape> 
```

然后使用显示您的图像的**图层列表**创建一个形状：

```
<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
    <item>
        <shape android:shape="rectangle">
            <solid android:color="@color/GREEN"/>
        </shape>
    </item>
    <item
        android:left="15dp"
        android:top="15dp"
        android:right="15dp"
        android:bottom="15dp"
        android:drawable="@drawable/ic_image" />
</layer-list> 
```

最后，您可以在按钮中使用上述形状：

```
<Button
        android:id="@+id/btnFavorite"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_margin="15dp"
        android:layout_below="@id/btnWorkout"
        android:background="@drawable/selector_main_button"
        android:drawableRight="@drawable/shape_favorite"
        android:gravity="center"
        android:text="@string/favorite"
        android:textSize="@dimen/font_7"
        android:textColor="@color/ORANGE"
        android:textStyle="bold"
        android:onClick="onClick"/> 
```

甚至，应该提到您可以使用第一个形状作为选择器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T19:41:53.843

如果您选择创建自定义小部件，我建议您从 android 源代码中查看最相似的标准小部件并修改它们

# macos - Grails 创建应用程序错误

> ID：12288513
> 
> 赞同：0
> 
> 时间：2012-09-05T19:34:05.053
> 
> 标签：macos, grails, groovy, terminal

任何人都知道为什么我在尝试使用终端创建 grails 应用程序时会收到此错误。

```
mycomputer:test-apps mailboxe$ grails create-app demo
| Configuring classpath
| Error Error executing script CreateApp: /Users/bla/.grails/ivy-cache/resolved-org.grails.internal-grails-2.0.3.xml (Permission denied) (Use --stacktrace to see the full trace) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T03:26:42.743

正如@Phillip Tenn 提到的，这是一个权限问题。有可能使用该`sudo`命令将某些内容安装到缓存中，因此 root 用户拥有该文件，而您的普通用户无法修改它。

最简单的做法可能是直接敲打你的`~/.grails`目录，默认情况下，除了缓存的信息之外什么都没有。因此，除非您手动将某些内容放入其中（例如配置文件），否则可以安全地删除并让它使用下一个`grails`命令重新生成。为此，只需：

```
cd ~
sudo rm -r .grails 
```

它会提示您输入密码，以确保您希望以 root 用户身份运行此命令。

或者，您可以尝试找到有问题的文件并将`chown`其发送给您的用户和组（默认情况下，在 OSX 上，该组是`staff`）。所以对于这个例子：

```
sudo chown bla:staff /Users/bla/.grails/ivy-cache/resolved-org.grails.internal-grails-2.0.3.xml 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T19:40:17.467

Grails 需要能够写入用户目录下的 .grails 文件夹。

在不了解开发环境的详细信息的情况下，`(Permission denied)`当您尝试运行`grails create-app demo`.

我会查看您的目录：

```
/Users/bla/.grails/
/Users/bla/.grails/ivy-cache/ 
```

并确保您具有适当的写入权限。

# vb.net - 如何使用 tls 发送电子邮件？

> ID：12288515
> 
> 赞同：0
> 
> 时间：2012-09-05T19:34:20.887
> 
> 标签：vb.net, email

我需要使用 tls 发送电子邮件如何在 vb.net 中发送？这是我在 Thunderbird 中确认的服务器信息，因为它需要手动输入我的服务器：1\. smtp 服务器：pod51004.outlook.com 2\. 端口：587 3\. TLSSTART 是我记得的连接安全性

我在这种情况下使用 live@edu 电子邮件服务。这是我尝试的代码：

```
Class Mailer
        ''one static method for sending e-mails
        Shared Sub SendMail(ByVal [From] As String, ByVal [To] As String, _
                            ByVal Subject As String, ByVal Body As String, ByVal MailServer _
                            As String, Optional ByVal IsBodyHtml As Boolean = True, _
                            Optional ByVal MailPort As Integer = 25, _
                            Optional ByVal Attachments() As String = Nothing, Optional _
                            ByVal AuthUsername As String = Nothing, Optional ByVal _
                            AuthPassword As String = Nothing)

            'On Error GoTo ErrorHandler
            'create a SmtpClient object to allow applications to send 
            'e-mail by using the Simple Mail Transfer Protocol (SMTP).
            Dim MailClient As SmtpClient = New SmtpClient(MailServer, MailPort)
            MailClient.EnableSsl = True
            MailClient.DeliveryMethod = SmtpDeliveryMethod.Network
            'MailClient.UseDefaultCredentials = False
            ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls
            Dim nc As NetworkCredential = New NetworkCredential(AuthUsername, AuthPassword)
            ''create a MailMessage object to represent an e-mail message
            ''that can be sent using the SmtpClient class
            Dim MailMessage = New MailMessage( _
            [From], [To], Subject, Body)
            ''sets a value indicating whether the mail message body is in Html.
            MailMessage.IsBodyHtml = IsBodyHtml
            ''sets the credentials used to authenticate the sender
            If (AuthUsername IsNot Nothing) AndAlso (AuthPassword _
                                                     IsNot Nothing) Then
                MailClient.Credentials = nc

            End If
            Dim 
            ''add the files as the attachments for the mailmessage object
            If (Attachments IsNot Nothing) Then
                For Each FileName In Attachments
                    MailMessage.Attachments.Add( _
                    New Attachment(FileName))
                Next
            End If
            MailClient.Send(MailMessage)
            ''ErrorHandler:
            '' MsgBox("My error")
        End Sub
    End Class 
```

有人想出主意吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T12:15:48.750

很抱歉让回答者感到困惑，但要解决它给出的一般错误是访问被拒绝。事实证明这是由于 mcafee 阻止了连接，认为这是一个试图大量发送电子邮件的蠕虫（哈哈）。但感谢您的帮助。PS记得在以后出现类似问题的情况下检查mcafee。让自动电子邮件与 mcafee 一起工作很痛苦。

# hibernate - 休眠：文档无效：未找到语法

> ID：12288516
> 
> 赞同：10
> 
> 时间：2012-09-05T19:34:23.663
> 
> 标签：hibernate

当我使用以下代码实例化 Hibernate 时：

```
 Configuration configuration = new Configuration();
        configuration.configure();
        serviceRegistry = new ServiceRegistryBuilder().applySettings(
                configuration.getProperties()).buildServiceRegistry();
        sessionFactory = configuration.buildSessionFactory(serviceRegistry); 
```

我有以下例外：

> org.xml.sax.SAXParseException：文档无效：找不到语法。org.xml.sax.SAXParseException：文档根元素“hibernate-configuration”，必须匹配 DOCTYPE 根“null”。引起：org.hibernate.MappingException：org.hibernate.cfg.Configuration.configure(Configuration.java:1931) 的 org.hibernate.cfg.Configuration.doConfigure(Configuration.java:2014) 的配置无效。 cfg.Configuration.configure(Configuration.java:1910) at com.soccer.system.HibernateUtil.(HibernateUtil.java:23) ... 1 更多原因：org.xml.sax.SAXParseException：文档无效：没有语法成立。

`hibernate.cfg.xml`我在Hibernate 4.1.6中使用以下文件：

```
<?xml version='1.0' encoding='utf-8'?>

<hibernate-configuration
    xmlns="http://www.hibernate.org/xsd/hibernate-configuration"
    xsi:schemaLocation="http://www.hibernate.org/xsd/hibernate-configuration hibernate-configuration-4.0.xsd"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <session-factory>
        <!-- Database connection settings -->
        <property name="connection.driver_class">org.apache.derby.jdbc.ClientDriver</property>
        <property name="connection.url">jdbc:derby://localhost:1527/K:\db</property>
        <property name="connection.username"></property>
        <property name="connection.password"></property>

        <!-- JDBC connection pool (use the built-in) -->
        <property name="connection.pool_size">1</property>

        <!-- SQL dialect -->
        <property name="dialect">org.hibernate.dialect.DerbyDialect</property>

        <!-- Enable Hibernate's automatic session context management -->
        <property name="current_session_context_class">thread</property>

        <!-- Disable the second-level cache -->
        <property name="cache.provider_class">org.hibernate.cache.internal.NoCacheProvider</property>

        <!-- Echo all executed SQL to stdout -->
        <property name="show_sql">true</property>

        <!-- Drop and re-create the database schema on startup -->
        <property name="hbm2ddl.auto">update</property>
    </session-factory>
</hibernate-configuration> 
```

我能做些什么来消除这个异常？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-06T07:27:33.633

添加行

```
<!DOCTYPE hibernate-configuration PUBLIC
      "-//Hibernate/Hibernate Configuration DTD 3.0//EN"
      "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd" > 
```

作为第二行（在 xml 版本之后和`<hibernate-configuration>`标签之前。那么它应该可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T06:23:15.570

删除此代码，问题将得到解决。

```
xmlns="http://www.hibernate.org/xsd/hibernate-configuration"
xsi:schemaLocation="http://www.hibernate.org/xsd/hibernate-configuration hibernate-configuration-4.0.xsd"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
```

# jvm - FPC/Java 错误：“JAS 错误：第 10039 行的引用超出了简称。”

> ID：12288517
> 
> 赞同：1
> 
> 时间：2012-09-05T19:34:26.597
> 
> 标签：jvm, freepascal, jasmin

我正在使用带有 JVM 后端的 Free Pascal 编译一段 Delphi 代码。

如果参与将 Free Pascal 移植到 JVM 后端的人正在阅读这篇文章，那么这是我收到的编译错误消息：

```
MyFile.j:379326: JAS Error: reference from line 10039 exceed size for short. 
```

该文件很大（>6000 行），其中的函数也很大。因此，可能有一些资源正在枯竭。有人可以提示我要简化什么来摆脱这个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T20:55:09.710

跟踪到 Jasmin 汇编程序的错误消息：[http ://www.java2s.com/Open-Source/Java/Byte-Code/Jasmin-2.4/jas/InsnOperand.java.htm](http://www.java2s.com/Open-Source/Java/Byte-Code/Jasmin-2.4/jas/InsnOperand.java.htm)

`goto`当字节码程序集文件中有一个命令指向一个超过 32KB 的标签时，似乎会出现错误。因此，似乎应该归咎于块大小 - FPC 中的程序集生成器假定单个 if/loop 主体的字节码适合 64K 块。我在生成的程序集中找不到任何 goto_w 命令 - 猜测 FPC 不会发出它们。

这个问题在 Jasmin 中得到了修复——它现在在适当的地方用 goto_w 替换了 goto。[在ftp://ftp.freepascal.org/pub/fpc/contrib/jvm/fpcjvmutilities.zip](ftp://ftp.freepascal.org/pub/fpc/contrib/jvm/fpcjvmutilities.zip)获取一份副本

# java - 如何在Java中将两个大列表合并到一个排序列表中？

> ID：12288519
> 
> 赞同：0
> 
> 时间：2012-09-05T19:34:37.870
> 
> 标签：java, performance, list

今天面试，他们给了我：

清单 A 有：

```
f  
google   
gfk  
fat  
... 
```

清单 B 有：

```
hgt    
google  
koko  
fat  
ffta  
... 
```

他们要求我将这两个列表合并到一个排序的列表 C 中。

我所说：

我将列表 B 添加到列表 A，然后从列表 A 创建了一个集合，然后从该集合创建了一个列表。面试官告诉我列表很大，这种方法对性能不好，他说会是一个nlog(n)。

解决这个问题的更好方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T19:41:03.267

那么您的方法将需要 O(3N) 额外空间（连接列表、集合和结果列表），这是其主要的低效率。

我会使用您选择的任何排序算法对 ListA 和 ListB 进行排序（QuickSort 就地需要 O(1) 空间；我相信 Java 的默认排序策略是 MergeSort，它通常需要 O(N) 额外空间），然后使用类似 MergeSort算法检查 ListA 的“当前”索引到 ListB 的当前索引，将应该首先出现的元素插入 ListC，并增加该列表的“当前”索引计数。仍然是 NlogN，但您避免了从集合到集合的多轮转换；此策略仅使用 O(N) 额外空间（对于 ListC；如果您 MergeSort 源列表，您将需要 N/2 空间）。

IMO 算法做面试官想要做的事情的下限是*O* (NlogN)。虽然最好的解决方案在该增长模型中具有更少的额外空间并且效率更高，但您根本无法在少于 NlogN 的时间内对两个未排序的字符串列表进行排序。

**编辑：** Java 不是我的强项（我是一个 SeeSharper 贸易），但代码可能看起来像：

```
Collections.sort(listA);
Collections.sort(listB);

ListIterator<String> aIter = listA.listIterator();
ListIterator<String> bIter = listB.listIterator();
List<String> listC = new List<String>();

while(aIter.hasNext() || bIter.hasNext())
{
   if(!bIter.hasNext())
      listC.add(aIter.next());
   else if(!aIter.hasNext())
      listC.add(bIter.next());
   else
   {
      //kinda smells from a C# background to mix the List and its Iterator, 
      //but this avoids "backtracking" the Iterators when their value isn't selected.
      String a = listA[aIter.nextIndex()];
      String b = listB[bIter.nextIndex()];

      if(a==b) 
      {
         listC.add(aIter.next());
         listC.add(bIter.next());
      }
      else if(a.CompareTo(b) < 0)
         listC.add(aIter.next());
      else
         listC.add(bIter.next());          
   }
} 
```

# javascript - 将 JS 分离为多个文件

> ID：12288522
> 
> 赞同：2
> 
> 时间：2012-09-05T19:35:10.417
> 
> 标签：javascript, jquery, selector, domready

我的网络项目中有多个页面使用完全相同的 JS 函数。我正在将相同的功能复制并粘贴到所有页面的 js 文件中。`common_fns.js`但最近将常用函数分离到另一个名为`some_page.js`. `common_fns.js`类似的东西

`some_page.js`

```
$(function() {
    var closer=$("#nlfcClose"),
    NewFormContainer=$("#NewLessonFormContainer"),
    opener=$("#nlfcOpen"),
    NewForm=$("#NewLessonForm"),
    OpsForm=$("#LessonOps"),
    SelectBox=$( "#courses" ),
    SelectBoxOptions=$("#courses option"),
    jquiBtn=$(".jquiBtn"),
    AddOp="AddLesson",
    DelOp="DelLesson";
}); 
```

`common_fns.js`

```
$(function() {
    SelectBoxOptions.text(function(i, text) {
        return $.trim(text);
    });

    SelectBox.combobox();
    jquiBtn.button();

    closer.button({
        icons: {
            primary: "ui-icon-closethick"
        },
        text: false
    }).click(function(){
        NewFormContainer.slideUp("slow");
    });

    opener.click(function(){
        NewFormContainer.slideDown("slow");
    });

    NewForm.submit(function(){
        var querystring = $(this).serialize();
        ajaxSend(querystring, AddOp);
        return false;
    });

    OpsForm.submit(function(){
        var querystring = $(this).serialize();
        ajaxSend(querystring, DelOp);
        return false;
    });
}); 
```

当我将常用功能复制并粘贴到每个页面的文件时，它正在工作。但现在它没有了：Firebug`undefined SelectBoxOptions`即使是第一个函数也会显示错误消息。我错过了什么？将相同功能复制粘贴到每个页面的 js 文件中的唯一方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T19:40:02.333

您在事件处理程序中声明局部变量，这就是为什么您不能在下一个事件处理程序中使用它们。

声明函数外的变量：

```
var closer, NewFormContainer, opener, NewForm, OpsForm, SelectBox, SelectBoxOptions, jquiBtn, AddOp, DelOp;

$(function() {
    closer = $("#nlfcClose");
    NewFormContainer = $("#NewLessonFormContainer");
    opener = $("#nlfcOpen");
    NewForm = $("#NewLessonForm");
    OpsForm = $("#LessonOps");
    SelectBox = $( "#courses" );
    SelectBoxOptions = $("#courses option");
    jquiBtn = $(".jquiBtn");
    AddOp = "AddLesson";
    DelOp = "DelLesson";
}); 
```

# javascript - Scriptaculous dom：加载仅“有时”工作？

> ID：12288529
> 
> 赞同：0
> 
> 时间：2012-09-05T19:35:45.330
> 
> 标签：javascript, facebook-javascript-sdk, scriptaculous

所以基本上，我正在为我的网站开发 Facebook 登录流程。这是相当基本的，但给我一些问题。问题似乎是点击观察者只在某些时候工作。硬刷新通常会解决问题。以下是我用来进入它的JS代码......

```
function fb_login(login_destination)
{
    FB.login(function(response) {
        if (response.authResponse) {
            var fb_auth_token = response.authResponse.accessToken;
            var fb_user_id = response.authResponse.userID;  
            var url =  '/login/ajax/fb_login.php?fb_auth_token=' + fb_auth_token + '&fb_user_id=' + fb_user_id + '&fb_login=' + login_destination;
            window.location = url;
        }
    }, {scope: 'email,user_about_me'});
}

document.observe("dom:loaded", load_fb);
function load_fb()
{
    window.fbAsyncInit = function(){
        FB.init({
            appId      : 'ID'    
            status     : true, 
            cookie     : true,
            xfbml      : true,
            oauth      : true
        });
    }; 

    $('fb_connect').observe('click',function(event){
        var login_destination = $('fb_connect').getAttribute('dest');
        fb_login(login_destination);
    });
} 
```

唯一的症状似乎是它根本不会响应对某些页面加载的点击。我使用的 ID 直接与图像本身相关联。我很好奇是否有人遇到过这个问题并且知道如何解决它。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T21:04:02.840

我以前遇到过这个。我最终使用计时器来启动初始化脚本作为备份。该函数设置一个变量并在它已经运行时退出。丑陋，但有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T16:56:30.550

所以，我最终解决了这个问题。代码实际上已更改为此....

```
function load_fb()
{   
    var d = document;
    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
    if (d.getElementById(id)) {return;}
    js = d.createElement('script'); js.id = id; js.async = true;
    js.src = "//connect.facebook.net/en_US/all.js";
    ref.parentNode.insertBefore(js, ref); 
```

基本上我现在只是在等待加载 FB JS SDK 直到页面加载之后（参考之前的代码才有意义）。它与脚本无关。

# c# - 如何根据所选国家/地区在 MVC3 中为美国或加拿大邮政编码验证编写自定义验证器？

> ID：12288534
> 
> 赞同：1
> 
> 时间：2012-09-05T19:36:22.493
> 
> 标签：c#, jquery, asp.net-mvc-3, validation

我需要将自定义验证器应用于帐单地址字段。该视图显示多个地址字段，包括国家下拉列表（带有美国和加拿大选项）和 BillingPostalCode 文本框。最初，我将正则表达式应用于允许美国或加拿大邮政编码的消息合同，如下所示：

```
[MessageBodyMember]
[Display(Name = "Billing Postal Code")]
[Required]
[StringLength(10, MinimumLength = 5)]
[RegularExpression("(^\\d{5}(-\\d{4})?$)|(^[ABCEGHJKLMNPRSTVXY]{1}\\d{1}[A-Z]{1} *\\d{1}[A-Z]{1}\\d{1}$)", ErrorMessage = "Zip code is invalid.")] // US or Canada
public string BillingPostalCode
{
   get { return _billingPostalCode; }
   set { _billingPostalCode = value; }
} 
```

以上将允许美国或加拿大的邮政编码。但是，只有在 BillingCountry 下拉列表中分别选择了美国或加拿大时，企业主才希望表单允许使用美国或加拿大的邮政编码。在他的测试用例中，他选择了加拿大并输入了美国的邮政编码。这种情况应该被禁止。

我最初的尝试是将其放在视图中，尽管我对创建 2 个文本框字段不满意。我应该只需要 1 个字段。

```
<div style="float: left; width: 35%;">
   Zip Code<br />
   <span id="spanBillingZipUS">
      @Html.TextBoxFor(m => m.BillingPostalCode, new { @class = "customer_input", @id = "BillingPostalCode" })
   </span>
   <span id="spanBillingZipCanada">
      @Html.TextBoxFor(m => m.BillingPostalCode, new { @class = "customer_input", @id = "BillingPostalCodeCanada" })
   </span>
   @Html.ValidationMessageFor(m => m.BillingPostalCode)
   <br />
</div> 
```

我的想法是，当 Country 下拉列表被切换时，我将使用 jQuery 来显示或隐藏适当的跨度。那块很容易。

但是我遇到了两个文本框都应用了单个验证器的问题，该验证器映射到上面粘贴的 MessageBodyMember。我知道如何在 jQuery 中编写验证代码，但也希望将验证也应用于服务器端。

我对 MVC 相当陌生，来自网络表单。“老派”网络表单自定义验证很容易实现。我在网上找到的用于 MVC 中的自定义验证的示例非常复杂。起初，这似乎是一个非常基本的要求。代码需要评估一个变量（选定的国家/地区）并将该国家/地区的适当正则表达式应用于 BillingPostalCode 字段。

如何使用 MVC3 以简单的方式满足此要求？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T20:17:52.373

好吧，我实现了[**这个人所做**](http://blogs.msdn.com/b/simonince/archive/2011/02/04/conditional-validation-in-asp-net-mvc-3.aspx)的，它作为一个带有**Data Annotations**的 chram 工作。为了更改*下拉值的**检查*，您确实需要做一些工作，但这是我发现使用**Data Annotations**和**Unobtrusive**实现验证的更优雅的方式。

 ****** * *

这里有一个例子：

## 模型

```
...
        [RequiredIf("IsUKResident", true, ErrorMessage = "You must specify the City if UK resident")]
        public string City { get; set; }
... 
```

## 自定义属性

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.ComponentModel.DataAnnotations;
using System.Web.Mvc;

namespace Mvc3ConditionalValidation.Validation
{
    public class RequiredIfAttribute : ValidationAttribute, IClientValidatable
    {
        private RequiredAttribute _innerAttribute = new RequiredAttribute();

        public string DependentProperty { get; set; }
        public object TargetValue { get; set; }

        public RequiredIfAttribute(string dependentProperty, object targetValue)
        {
            this.DependentProperty = dependentProperty;
            this.TargetValue = targetValue;
        }

        protected override ValidationResult IsValid(object value, ValidationContext validationContext)
        {
            // get a reference to the property this validation depends upon
            var containerType = validationContext.ObjectInstance.GetType();
            var field = containerType.GetProperty(this.DependentProperty);

            if (field != null)
            {
                // get the value of the dependent property
                var dependentvalue = field.GetValue(validationContext.ObjectInstance, null);

                // compare the value against the target value
                if ((dependentvalue == null && this.TargetValue == null) ||
                    (dependentvalue != null && dependentvalue.Equals(this.TargetValue)))
                {
                    // match => means we should try validating this field
                    if (!_innerAttribute.IsValid(value))
                        // validation failed - return an error
                        return new ValidationResult(this.ErrorMessage, new[] { validationContext.MemberName });
                }
            }

            return ValidationResult.Success;
        }

        public IEnumerable<ModelClientValidationRule> GetClientValidationRules(ModelMetadata metadata, ControllerContext context)
        {
            var rule = new ModelClientValidationRule()
            {
                ErrorMessage = FormatErrorMessage(metadata.GetDisplayName()),
                ValidationType = "requiredif",
            };

            string depProp = BuildDependentPropertyId(metadata, context as ViewContext);

            // find the value on the control we depend on;
            // if it's a bool, format it javascript style 
            // (the default is True or False!)
            string targetValue = (this.TargetValue ?? "").ToString();
            if (this.TargetValue.GetType() == typeof(bool))
                targetValue = targetValue.ToLower();

            rule.ValidationParameters.Add("dependentproperty", depProp);
            rule.ValidationParameters.Add("targetvalue", targetValue);

            yield return rule;
        }

        private string BuildDependentPropertyId(ModelMetadata metadata, ViewContext viewContext)
        {
            // build the ID of the property
            string depProp = viewContext.ViewData.TemplateInfo.GetFullHtmlFieldId(this.DependentProperty);
            // unfortunately this will have the name of the current field appended to the beginning,
            // because the TemplateInfo's context has had this fieldname appended to it. Instead, we
            // want to get the context as though it was one level higher (i.e. outside the current property,
            // which is the containing object (our Person), and hence the same level as the dependent property.
            var thisField = metadata.PropertyName + "_";
            if (depProp.StartsWith(thisField))
                // strip it off again
                depProp = depProp.Substring(thisField.Length);
            return depProp;
        }
    }
} 
```

## 客户端

```
...
<script src="@Url.Content("~/Scripts/jquery.validate.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.js")" type="text/javascript"></script>

<script>
    $.validator.addMethod('requiredif',
        function (value, element, parameters) {
            var id = '#' + parameters['dependentproperty'];

            // get the target value (as a string, 
            // as that's what actual value will be)
            var targetvalue = parameters['targetvalue'];
            targetvalue = 
              (targetvalue == null ? '' : targetvalue).toString();

            // get the actual value of the target control
            // note - this probably needs to cater for more 
            // control types, e.g. radios
            var control = $(id);
            var controltype = control.attr('type');
            var actualvalue =
                controltype === 'checkbox' ?
                control.attr('checked').toString() :
                control.val();

            // if the condition is true, reuse the existing 
            // required field validator functionality
            if (targetvalue === actualvalue)
                return $.validator.methods.required.call(
                  this, value, element, parameters);

            return true;
        }
    );

    $.validator.unobtrusive.adapters.add(
        'requiredif',
        ['dependentproperty', 'targetvalue'], 
        function (options) {
            options.rules['requiredif'] = {
                dependentproperty: options.params['dependentproperty'],
                targetvalue: options.params['targetvalue']
            };
            options.messages['requiredif'] = options.message;
        });

</script>
...
    <div class="editor-label">
        @Html.LabelFor(model => model.City)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.City)
        @Html.ValidationMessageFor(model => model.City)
    </div>

    <div class="editor-label">
        @Html.LabelFor(model => model.IsUKResident)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.IsUKResident)
        @Html.ValidationMessageFor(model => model.IsUKResident)
    </div>
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T20:19:52.737

这听起来不像是使用 ModelBinding 和验证属性很容易完成的事情。

一个直接的方法可能是保留验证属性，并简单地验证它是美国还是加拿大的邮政编码。然后当它到达服务器时，进行一些手动验证。

例如

```
[Post]
public ActionResult SaveInfo(MyViewModel viewModel)
{
    var isValid = true;
    if (ModelState.IsValid)
    {
        if (!IsValidPostCode(viewModel))
        {
            isValid = false;
            ModelState.AddModelError("BillingPostalCode", "The billing postcode appears to be invalid.");
        }

        if (isValid)
        {
            return RedirectToAction("success");
        }
    }

    return View(viewModel);
}

private static IDictionary<string, string> countryPostCodeRegex = new Dictionary<string, string>
    {
        { "USA", "USAPostCodeRegex" },
        { "Canada", "CanadianPostCodeRegex" },
    }

private bool IsValidPostCode(MyViewModel viewModel)
{
    var regexString = countryPostCodeRegex[viewModel.SelectedCountry];
    var regexMatch = Regex.Match(viewModel.BillingPostalCode, regexString, RegexOptions.IgnoreCase);

    return regexMatch.Success;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T20:31:24.490

I used [MVC Foolproof Validation](http://foolproof.codeplex.com/) in one of my projects. You would do as you were saying with hiding and showing fields, but the validation would follow through the same logic. Have 2 fields for postal code. One for Canada, the other for USA. They each have their own regex validation to ensure the proper format.

**Pseudo Code**

```
[RequiredIf(DependentName = "Country", DependentValue="USA")]
public string PostalCodeUSA { get; set; }

[RequiredIf(DependentName = "Country", DependentValue="Canada")]
public string PostalCodeCanada { get; set; } 
```*****

# android - 如何使用文本视图+按钮显示特定的 sqlite 列值？

> ID：12288535
> 
> 赞同：-1
> 
> 时间：2012-09-05T19:36:23.867
> 
> 标签：android, sqlite, textview

在这个[链接](https://stackoverflow.com/questions/12288038/how-to-insert-a-string-value-into-a-dialog-message)中是我如何将数据插入到我的数据库中，所以现在我想知道如何制作一个按钮，将 textview 值编辑为我的数据库列的值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T20:22:29.050

好的，这是帮助您处理数据库和 Listactivity 的代码

```
public class MyDB { 
    protected static final String TAG = "TAG";

    private final Context mContext;
    private SQLiteDatabase mDb;
    private MyDBhelper mDbHelper;
public MyDB(Context context){   
    this.mContext = context;
    mDbHelper = new MyDBhelper(mContext);
}

public MyDB createDatabase() throws SQLException 
{
    try 
    {
        mDbHelper.createDataBase();
    } 
    catch (IOException mIOException) 
    {
        Log.e(TAG, mIOException.toString() + "  UnableToCreateDatabase");
        throw new Error("UnableToCreateDatabase");
    }
    return this;
}

public MyDB open() throws SQLException 
{
    try 
    {
        mDbHelper.openDataBase();
        mDbHelper.close();
        mDb = mDbHelper.getReadableDatabase();
    } 
    catch (SQLException mSQLException) 
    {
        Log.e(TAG, mSQLException.toString());
        throw mSQLException;
    }
    return this;
}

    public Cursor getplaces() 
    {
        Cursor c = mDb.query(Constants.DATABASE_NAME, null, null, null, null, null, null);
        return c;

    }

    public void close() 
    {
        mDbHelper.close();
    }

} 
```

和活动显示列表

```
public ListplaceActivity extends ListActivity {

    private static MyDB mDbHelper;
    String[] from = new String[] { Constants.TITLE_NAME };
    int[] to = new int[] {R.id.place_title};

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        mDbHelper = new MyDB(this);
        mDBHelper.open();
        Cursor c = mDbHelper.getplaces();
        setListAdapter(new SimpleCursorAdapter(this, 
                  android.R.layout.simple_list_item_1, c, 
                  from, to));

} 
```

# javascript - Javascript 图像刷新

> ID：12288542
> 
> 赞同：1
> 
> 时间：2012-09-05T19:36:57.813
> 
> 标签：javascript, refresh

我正在使用以下代码来尝试刷新我网站上的两个网络摄像头图像。

```
var t_webcam = 60 // interval in seconds 
      image_webcam = "cam_1.jpg" //name of the image 
      function Start_webcam() { 
      tmp_webcam = new Date(); 
      tmp_webcam = "?"+tmp_webcam.getTime() 
      document.images["frontcam"].src = image_webcam+tmp_webcam 
      setTimeout("Start_webcam()", t_webcam*1000) 
      } 
      Start_webcam(); 
```

在网站上，我使用以下代码行调用该函数

但是，当我将其加载到网站上时，出现以下错误并且它不起作用，

> 未捕获的类型错误：无法设置未定义的属性“src”

如果有人对 Javascript 有更多的了解并且能够提供一些帮助，我将非常感激。

谢谢理查德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T19:40:20.023

`document.images`是一个数组，所以它只接受数字索引。您正试图像字典一样访问它，`frontcam`作为键传递。

`document.getElementById`如果您的标签如下所示，您可以改用：

```
<img src="sth.jpg" id="frontcam"></img> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T19:40:50.113

该行：

```
document.images["frontcam"].src = image_webcam+tmp_webcam 
```

是无效的，它可能应该更像这样：

```
 document.getElementById("frontcam").src = image_webcam+tmp_webcam; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T19:41:12.880

我假设`frontcam`是一个ID？

尝试更换

```
document.images["frontcam"].src 
```

和

```
document.getElementById('frontcam').src 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-05T19:43:13.310

`id="frontcam"`如果您的`<img>`标签还没有，请添加一个，然后尝试此代码

```
var t_webcam = 60; // interval in seconds 
var image_webcam = "cam_1.jpg"; //name of the image 
function Start_webcam() { 
  var tmp_webcam = new Date(); 
  tmp_webcam = "?"+tmp_webcam.getTime();
  document.getElementById("frontcam").src = image_webcam+tmp_webcam;
  setTimeout(Start_webcam, t_webcam*1000);
} 
Start_webcam(); 
```

# mysql - MySQL子查询字段减法结果不正确

> ID：12288544
> 
> 赞同：0
> 
> 时间：2012-09-05T19:37:07.727
> 
> 标签：mysql

当我运行此查询时：

```
select 
(IFNULL(ROUND(convertUnits('40892',SUM(o.qty),o.pricingUnit,'FT')),0)) as oItemQty,
(SELECT IFNULL(sum(i.qty),0) from inventory i where i.partID='40892' and i.type=16 and        i.refDocNum=w.woID and i.refApp='WO') as iItemQty,
(IFNULL(ROUND(convertUnits('40892',SUM(o.qty),o.pricingUnit,'FT')),0) - (SELECT    IFNULL(sum(i.qty),0) from inventory i where i.partID='40892' and i.type=16 and    i.refDocNum=w.woID and i.refApp='WO')) as sum
from orderitem o left join wo w on o.orderitemID=w.orderitemID 
where o.partID='40892' and
w.status not in (1,5) and 
(SELECT cancelDate from orders where orders.orderID=o.orderID)='0000-00-00' and 
o.createWO=1 and 
(SELECT orderDate from orders where orders.orderID=o.orderID) >='2012-07-01' 
```

我得到 13650 的“oI​​temQty”和 2730 的“iItemQty”。我遇到的问题是“总和”字段应该是 oItemQty - iItemQty (10920)。现在它返回 13650 (oItemQty)。

我在这里想念什么？为什么当我将子查询作为单独的字段运行时，数字是正确的，但是当我尝试减去它时却不能正常工作？

**更新**：原来这是一个铸造问题。一旦我将 iItemQty 转换为无符号，它就会正确减去。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T19:54:02.620

查看您的查询，我注意到的第一个问题是您通过将其包含在 WHERE 子句中来否定左连接：

```
w.status not in (1,5) 
```

您应该将其移动到左连接的 ON 子句中，以保留该连接的意图。就像现在一样，它基本上被视为内部连接。

# xcode - 错误：关联的包标识已过期

> ID：12288545
> 
> 赞同：4
> 
> 时间：2012-09-05T19:37:07.857
> 
> 标签：xcode, cocoa, app-store, certificate, mac-app-store

我正在尝试验证存档，然后再将其提交到应用商店，但我不断收到以下错误：

> “MY NAME”是一个有效的身份。但是，关联的包裹标识“MY NAME”已过期。

有一个“刷新代码签名身份”选项，但似乎没有任何反应。

可能出了什么问题？有任何想法吗？

* * *

**提示**：这不是我第一次将档案上传到应用商店。我已经这样做了 100 次。问题是我正在使用不同的开发机器，并认为这可能是罪魁祸首。但我还是一头雾水……

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-29T21:54:12.080

我遇到过同样的问题。通过“钥匙串访问”删除过期的开发人员证书对我有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-06T09:16:51.093

从钥匙串访问，查看，显示过期证书并将其全部删除。

[MAS：代码签名身份私钥](https://stackoverflow.com/questions/10559942/mas-code-signing-identity-private-key)

弗朗切斯科·杰米纳拉

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-26T20:09:33.857

我收到了这个确切的错误消息，事实证明我需要下载并安装 Mac App 证书和 Mac Installer 证书，但我只下载了 Mac App 一个。

# haskell - 用于任意元素类型的 Haskell 线性代数矩阵库

> ID：12288548
> 
> 赞同：30
> 
> 时间：2012-09-05T19:37:26.230
> 
> 标签：haskell, matrix, linear-algebra

我正在寻找具有以下功能的 Haskell 线性代数库：

*   矩阵乘法
*   矩阵加法
*   矩阵转置
*   排名计算
*   矩阵反转是一个加号

并具有以下属性：

*   任意元素（标量）类型（特别是*不是* `Storable`实例的元素类型）。我的元素是 的一个实例`Num`，另外可以计算乘法逆。这些元素在数学上形成一个有限域 ( [2 ^(256)] )。这应该足以实现上述功能。
*   任意矩阵大小（我可能需要*100x100*之类的东西，但矩阵大小将取决于用户的输入，因此它不应受内存或可用计算能力之外的任何其他限制）
*   尽可能快，但我知道，由于任意（非或类似）类型的间接性`Int`，任意元素的库可能不会像 C/Fortran 库那样执行工作（通过 FFI 接口）。`Double`当一个元素被触摸时，至少有一个指针被取消引用
*   （用 Haskell 编写，这对我来说不是真正的要求，但由于我的元素不是`Storable`实例，所以库必须用 Haskell 编写）

我已经非常努力地尝试并评估了所有看起来很有希望的东西（Hackage 上的大多数库都直接声明它们不会为我工作）。特别是我使用以下方法编写了测试代码：

*   [hmatrix](http://hackage.haskell.org/package/hmatrix-0.14.1.0) , 假设`Storable`元素
*   [Vec](http://hackage.haskell.org/package/Vec)，但[文档](http://hackage.haskell.org/packages/archive/Vec/1.0.1/doc/html/Data-Vec.html)指出：

    > 低维度：虽然维度仅受 GHC 将处理的内容限制，但该库适用于 2,3 和 4 维度。对于一般线性代数，请查看优秀的 hmatrix 库和 blas 绑定

我查看了更多库的代码和文档，但似乎没有什么适合我的需求:-(。

### 更新

由于似乎什么都没有，我[在 GitHub 上启动了一个项目](https://github.com/weissi/matrix-arbitrary)，旨在开发这样一个库。当前状态*非常*简约，根本没有针对速度进行优化，只有最基本的功能有测试，因此应该可以工作。但是您是否有兴趣使用或帮助开发它：联系我（您可以在我的[网站](http://tux4u.de)上找到我的邮件地址）或发送拉取请求。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-09-12T09:12:45.077

好吧，我确实很确定我的答案有多大的相关性，但我对 GNU GSL 库有很好的经验，并且有一个 haskel 的包装器：

[http://hackage.haskell.org/package/bindings-gsl](http://hackage.haskell.org/package/bindings-gsl)

看看吧，也许对你有帮助

# c++ - C++ Linux Binary 以信号 SIGKILL 终止 - 为什么？（加载到 GDB 中）

> ID：12288550
> 
> 赞同：21
> 
> 时间：2012-09-05T19:37:37.790
> 
> 标签：c++, ubuntu, gdb

所以我在 GDB 中启动了我的 c++ 应用程序，当它退出时，我基本上得到：

```
[Thread 0x7fff76e07700 (LWP 6170) exited]
[Thread 0x7fff76f08700 (LWP 6169) exited]
[Thread 0x7fff77009700 (LWP 6168) exited] 
...
Program terminated with signal SIGKILL, Killed. The program no longer exists.
(gdb) 
```

我真的不知道为什么会发生这种情况，为什么我不能回溯看看它是如何退出的？有人有想法么？它永远不应该结束:(

谢谢！

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-09-06T03:22:37.013

> 我真的不知道为什么会发生这种情况，

这通常意味着

*   其他一些进程执行了 a `kill -9 <your-pid>`，或
*   内核OOM杀手认为您的进程消耗了太多资源，并终止了它（实际上是内核`kill -9`为其执行）。您应该查看`/var/log/messages`（`/var/log/syslog`在 Ubuntu 变体上）以寻找其痕迹——内核通常在 OOM 某个进程时记录一条消息。

> 为什么我不能回溯看看它是如何退出的？

因为要查看回溯，流程必须存在。如果它不存在，则它没有堆栈，因此*不能*有回溯。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-05-28T08:30:37.980

如果您使用的是 Unix/Linux，您还应该能够`dmesg`在终端上键入并查看进程终止的原因。就我而言，确实是OOM。[这是终止后不久我的内核日志的屏幕截图](https://i.stack.imgur.com/6RFwF.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-19T17:57:35.773

进程可能遇到了 cpu time ulimit。如果“cpu time”设置为“unlimited”以外的任何值，请从进程实际启动的环境中检查**ulimit -a**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T15:07:42.230

在我的情况下是崩溃（AV）。即使附加了 GDB，我也无法捕捉到这种违规行为。
希望能帮助到你

# powershell - Powershell 内存使用 - 昂贵？

> ID：12288555
> 
> 赞同：5
> 
> 时间：2012-09-05T19:37:51.540
> 
> 标签：powershell

我是 powershell 新手，但编写了一些在 windows2003 服务器上运行的脚本。它绝对比 cmd 脚本更强大（可能是因为我有编程背景）。然而，当我进一步深入研究时，我注意到：

1.  启动的每个脚本都将在 1 个 powershell 进程下运行，即。您会看到每个脚本都有一个新的 powershell 进程。
2.  我测试内存的脚本非常简单，例如，构建一个字符串或查询一个环境变量，然后开始睡眠 60 秒，所以没有必要（至于内存使用）。但是每个过程大约需要> 30MB。叫我小气，但是由于每天都安排运行内存密集型应用程序，并且如果我需要安排一些 powershell 脚本定期运行，并且可能一些脚本作为服务连续运行，我当然会尽量保持内存消耗为尽可能低。<-- 这是因为我们最近遇到了由于内存不足而导致的大型应用程序故障。

我还没有接触过 C#，但有人会认为有时用 C# 编写任务可能会更好吗？

同时，我看到了有关 powershell 内存泄漏的帖子。我是否认为脚本创建的内存将占用powershell的进程空间，因此当脚本终止因此powershell终止时，创建的内存会被清除？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T20:39:00.617

我的 PowerShell.exe 2.0 本身（不运行脚本）在 XP 上约为 30MB。这些天来，您不必担心每台机器的平均内存。关于内存泄漏，在某些情况下，人们使用 3rd 方库时会在对象未正确处理时发生内存泄漏。要解决这些问题，您必须使用手动调用垃圾收集器`[gc]::Collect()`，但这很少见。其他时候，我看到人们习惯于`Get-Content`读取一个非常大的文件并在使用它之前将其分配给一个变量。这也将占用大量内存。在这种情况下，您可以使用管道一次读取文件部分以减少内存占用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-05T20:55:50.303

1 - 是的，创建了一个新进程。运行 cmd 脚本、vb 脚本或 C# 编译的可执行文件时也是如此。

2 - 加载 powershell 主机和运行时将占用一些重要的内存量，这会因系统和版本而异。它通常是一个比 cmd shell 或专用 C# exe 更重的进程。对于那些 MB，您将获得使 Powershell 如此强大的丰富运行时和库支持。

普通的留言：

*   操作系统为每个进程分配内存。一旦一个进程终止，它的所有内存都会被回收。这是任何现代操作系统的一般设计，并不特定于 Powershell 甚至 Windows。
*   如果您的团队在硬件上运行业务关键型应用程序，以至于少数 30MB 进程可能导致灾难性故障，那么您将遇到更大的问题。打开浏览器并访问 Facebook 会消耗更多的内存。
*   在您想出一些神秘的批处理脚本解决方案的时间里，您可能会在 Powershell 中创建一个更好的解决方案，并且您的公司可以负担得起新的专用硬件，并节省计费时间 :-)
*   您应该使用最适合该工作的工具。Powershell*通常*是正确的工具，但并非总是如此。它非常适合在 Windows 环境中自动执行管理任务（文件处理、使用 AD、计划任务、设置权限等）。对于高性能、大量算法任务或针对原始 .NET API 的复杂编码，它不太适用。对于这些任务，C# 会更有意义。
*   Powershell 得到了微软（以及一个庞大的用户社区！）的大力支持/支持，而且很明显，它是 Windows 未来的首选脚本环境。适用于 Windows 的所有新服务器端技术都支持 powershell。如果您在 admin/IT 工作，那么在 Powershell 中培养一些技能将是一项明智的投资。我永远不会阻止某人学习 C#，但如果您的角色更多是 IT 而不是开发人员，那么 Powershell 将更经常成为正确的工具，并且您的同事也更有可能理解它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-11-20T18:08:18.280

Powershell 比 cmd 需要（更多）资源 (RAM)，因此如果您只需要快速简单的东西，那么使用 cmd 更有意义。

CMD 使用本机 Win32 调用，Powershell 使用 .Net 框架。Powershell 需要更长的时间来加载，并且会比 CMD 消耗更多的 RAM。

> “我监视了一个执行 Get-ChildItem 的 Powershell 会话。几分钟后它增长到 2.5GB（全部为私有内存），而且几乎没有完成。带有小回滚缓冲区的 CMD“dir /od”在大约 2 分钟内完成，并且从不占用超过 300MB 的内存。”
> 
> [https://qr.ae/pGmwoe](https://qr.ae/pGmwoe)

# asp.net - 下拉所选索引在页面加载时更改

> ID：12288558
> 
> 赞同：0
> 
> 时间：2012-09-05T19:38:07.217
> 
> 标签：asp.net

我有一个下拉框，它根据其值填充文本框值。它在更改时触发，但在页面加载时不会触发。如何让它在页面加载时触发？

```
 protected void DropDownList1_SelectedIndexChanged(object sender, EventArgs e)
    {     
   TextBox3.Text = DropDownList1.SelectedValue;
        TextBox12.Text = DropDownList1.SelectedValue;
        TextBox21.Text = DropDownList1.SelectedValue;

     //etc 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T20:07:26.010

Tim Schmelter 对钱的评论是正确的。

```
// Wire up to the page load event
protected void Page_Load(object sender, System.EventArgs e)
{
   updateTextBoxes();
}

// Wire up to the select index-changed event
protected void DropDownList1_SelectIndexChanged( object sender, EventArgs e )
{
    updateTextBoxes();
}

// your workhorse method
protected void updateTextBoxes()
{
   TextBox3.Text  = DropDownList1.SelectedValue;
   TextBox12.Text = DropDownList1.SelectedValue;
   TextBox21.Text = DropDownList1.SelectedValue;

   // etc.
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T20:06:41.267

它不会在页面加载时自动调用，您必须“手动”调用它：

```
 void Page_Load(object sender, System.EventArgs e) {

     // ....

     DropDownList1_SelectedIndexChanged(DropDownList1, e);

 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T19:54:56.457

`SelectedIndexChanged`响应用户驱动的更改而触发。将分配逻辑移动到另一个方法，`Page_Load`并从您的事件处理程序手动调用它。

# json - 如何使用华盛顿特区 Metro API

> ID：12288561
> 
> 赞同：0
> 
> 时间：2012-09-05T19:38:16.403
> 
> 标签：json, api, rest

我一直在研究如何获取[华盛顿特区地铁](http://developer.wmata.com/docs)提供的公交信息 API，并将其显示为 HTML。

该文档在他们的网站上，但它不包含很多示例。我发现的唯一说明是使用三个 URL 之一。

我已经弄清楚如何使用以下代码查看信息。问题是下面的 URL 仅在我的浏览器中将所有数据生成为文本。我无法弄清楚如何将选定的数据显示为 HTML。

从他们的网站：

> 每种方法都有 2 个端点：REST 和 JSON。
> 
> URL (REST) 示例：api.wmata.com/StationPrediction.svc/GetPrediction/A10?api_key=YOUR_API_KEY
> 
> URL (JSON) 示例：api.wmata.com/StationPrediction.svc/json/GetPrediction/A10?api_key=YOUR_API_KEY
> 
> 此外，如果需要，开发人员可以通过向 JSON 调用添加“回调”参数来使用 JSONP：
> 
> http://[JSON 服务的 URL]?api_key=[your_key]&callback=[回调名称]
> 
> 使用 JSONP 时，请确保上面显示的 URL 中的 [回调名称] 是处理 JSON 数据所需的 Javascript 函数的名称。

任何人都可以为我指出正确的方向以获得教程或最佳入门方式吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T17:39:01.513

您应该尝试 WMATA 交互式文档。

[http://developer.wmata.com/io-docs](http://developer.wmata.com/io-docs)

如果您已经注册了密钥，只需登录，您的 API 密钥将自动填充到交互式文档中。I/O Docs 界面应该可以帮助您轻松浏览资源/方法。如果您还有其他问题，请随时在这里提问，我可以为您提供帮助。

我是 Mashery 的平台推广者，该公司帮助 WMATA/DC Metro 管理其 API。

# linux - 编译/链接 CUDA 和 CPP 源文件

> ID：12288567
> 
> 赞同：1
> 
> 时间：2012-09-05T19:38:54.753
> 
> 标签：linux, compiler-construction, linker, cuda, g++

我正在研究一个使用 C++ 源代码和 CUDA 的示例程序。这是我的四个源文件中的基本内容。

matrixmul.cu（主要 CUDA 源代码）：

```
#include <stdlib.h>
#include <cutil.h>
#include "assist.h"
#include "matrixmul.h"

int main (int argc, char ** argv)
{
    ...
    computeGold(reference, hostM, hostN, Mh, Mw, Nw);  //reference to .cpp file
    ...
} 
```

matrixmul_gold.cpp（C++源代码，单函数，无main方法）：

```
void computeGold(float * P, const float * M, const float * N, int Mh, int Mw, int Nw)
{

    ...
} 
```

matrixmul.h（matrixmul_gold.cpp 文件的头文件）

```
#ifndef matrixmul_h
#define matrixmul_h

extern "C"
void computeGold(float * P, const float * M, const float * N, int Mh, int Mw, int Nw);
#endif 
```

Assist.h（辅助函数）

我正在尝试编译和链接这些文件，以便它们可以正常工作。到目前为止，我可以使用以下方法编译 matrixmul_gold.cpp：

```
g++ -c matrixmul_gold.cpp 
```

我可以使用以下方法编译 CUDA 源代码而不会出错：

```
nvcc -I/home/sbu/NVIDIA_GPU_Computing_SDK/C/common/inc -L/home/sbu/NVIDIA_GPU_Computing_SDK/C/lib matrixmul.cu -c -lcutil_x86_64 
```

但我最终得到了两个 .O 文件。我尝试了很多不同的方法来链接这两个 .O 文件，但到目前为止还不行。什么是正确的方法？

更新：根据要求，这里是输出：

```
nm matrixmul_gold.o matrixmul.o | grep computeGold

nm: 'matrixmul.o': No such file
0000000000000000 T _Z11computeGoldPfPKfS1_iii 
```

我认为'matrixmul.o'缺失错误是因为我在运行建议的编译命令时实际上并没有成功编译：

```
nvcc -I/home/sbu/NVIDIA_GPU_Computing_SDK/C/common/inc -L/home/sbu/NVIDIA_GPU_Computing_SDK/C/lib -o matrixmul matrixmul.cu matrixmul_gold.o -lcutil_x86_64 
```

`extern "C"`更新 2：我从 matrixmul_gold.cpp 的开头丢失了一个。我添加了这一点，建议的编译命令效果很好。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T19:54:18.763

按照惯例，您将使用您正在使用的任何编译器来编译包含主子例程的代码以链接应用程序。在这种情况下，您在 中拥有 main `.cu`，因此请使用 nvcc 进行链接。像这样的东西：

```
$ g++ -c matrixmul_gold.cpp
$ nvcc -I/home/sbu/NVIDIA_GPU_Computing_SDK/C/common/inc \
-L/home/sbu/NVIDIA_GPU_Computing_SDK/C/lib \
-o matrixmul matrixmul.cu matrixmul_gold.o -lcutil_x86_64 
```

这将链接一个名为`matrimul`from`matrixmul.cu`的可执行二进制文件`matrixmul_gold.o`和 cutil 库（隐式 nvcc 将链接 CUDA 运行时库和 CUDA 驱动程序库）。

# javascript - jQuery UI - 当 droppable 必须删除拖动的元素时怎么办？

> ID：12288568
> 
> 赞同：3
> 
> 时间：2012-09-05T19:38:57.790
> 
> 标签：javascript, jquery, jquery-ui

我有一个删除它正在使用的元素的事件。看起来像这样：

```
$('.droppable_slot').droppable({
    drop: function (event,ui) {
        // snipped lines of code
        delete_element(ui.draggable);
    }
); 
```

我得到一个错误*a(this).data("draggable") is undefined*显然是因为`delete_element()`删除了 drop 事件正在使用的元素（应该如此）。我不知道如何避免这种情况，除非仅在 drop 事件（或 .droppable() 插件）完成运行其功能后以某种方式运行 delete_element() ，但我不知道该怎么做。我*可以*抑制错误，但我宁愿避免这种情况。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T20:39:14.287

显然，在放置操作完成将源元素移动到目标容器之前，您太早地清除了源容器。

由于在 之后没有由`droppable`小部件触发的事件，使用[setTimeout()](https://developer.mozilla.org/en-US/docs/DOM/window.setTimeout)`drop`延迟清除操作直到删除完成可能是一个很好的解决方法：

```
$(".droppable_slot").droppable({
    drop: function(event, ui) {
        // Snipped lines of code...
        window.setTimeout(function() {
            delete_element(ui.draggable);
        }, 10);
    }
}); 
```

但这是一种解决方法，而不是解决方案。我们这里真正需要的是`drop`操作完成后发生的事件。小部件的`stop`事件`draggable`可能符合条件。但是，如果不查看更多代码，就很难分辨。

# google-chrome-extension - 为什么我无法在 Chrome 应用中打开新页面？

> ID：12288571
> 
> 赞同：0
> 
> 时间：2012-09-05T19:39:11.197
> 
> 标签：google-chrome-extension

我正在制作一个 Chrome 应用程序，当用户单击右上角的应用程序时，用户会打开一个新页面。我试图让 Chrome 在应用加载时打开一个新页面。

这是我的 manifest.json 文件：

```
{
  "name": "My App That Opens in a New Page",
  "version": "1.0",
  "manifest_version": 2,
  "icons": { "128": "mediumIcon.png" },
  "description": "A practice text editor that opens in a new tab or window.",
  "browser_action": {
    "default_icon": "smallIcon.png",
    "default_popup": "load.html"
  }
} 
```

随后，在 load.html 中，我尝试使用此 HTML 按照[http://developer.chrome.com/extensions/overview.html](http://developer.chrome.com/extensions/overview.html)的说明打开一个新页面。

```
<!DOCTYPE html><html><head>
  <script type='text/javascript'>window.open('editor.html');</script>
</head><body></body></html> 
```

但是，`editor.html`当我在 Chrome 中单击我的应用程序的图标时，它没有打开。为什么不？不在`window.open`javascript中打开新窗口？对于嵌入在浏览器中的javascript，它的行为是否不同？

# java - Java 编译器错误：查找表超过 65535 限制

> ID：12288575
> 
> 赞同：1
> 
> 时间：2012-09-05T19:39:23.020
> 
> 标签：java, lookup-tables

由于基于此定义的非常大的查找表，我遇到了此编译器错误：

```
//92 X 182 array
private static final double[][] lookUpTable = new double[][]
{
    { numbers....}
}; 
```

据我了解，将其拆分是一种解决方案，但是要准确拆分该数组将非常困难。我也相信我可以把它移到一个文件中，但我不知道我是否可以格式化它以帮助我，另外我不希望每秒读取文件。还有其他建议可以帮助我解决这个问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T19:47:18.817

将表转换为文件，将文件作为资源嵌入，在静态初始化块中读取一次，然后将其存储在`lookUpTable`数组中。它将无法与通过聚合初始化的数组区分开来，除非没有 65535 限制。存储在静态变量中将帮助您避免“每秒读取一次”。

就格式而言，您可以将矩阵的每一行放在资源文件的单独行中。读取和维护这个文件会很简单，因为您的数字周围不会有其他标记。

这是[解释如何从资源中读取文件的答案的链接](https://stackoverflow.com/q/403256/335858)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T19:42:49.597

按需读取文件一次。

由于您有一个表格/矩阵，我建议每行有一行。阅读每一行并拆分数字并单独解析它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T19:51:12.873

您可以将字符串中的行保留为逗号分隔值（从而减少 java 处理的对象数量），并在程序启动时拆分每一行，从而建立您的 long 表。

# database - 如何在“菱形”关系系统中保持外键关系一致

> ID：12288579
> 
> 赞同：8
> 
> 时间：2012-09-05T19:39:27.027
> 
> 标签：database, database-design, foreign-keys, constraints, normalization

考虑这种情况：**汽车**是从**Salesperson**那里购买的。销售人员在**陈列室**（且仅在一个陈列室）工作。陈列室隶属于**制造商**，仅销售该制造商制造的汽车。同时，汽车是特定**型号**的，而型号是由制造商制造的。

**限制 R：**汽车模型的制造商必须与汽车销售人员的陈列室的附属制造商是同一制造商。

该图显示了明显的外键关系。

```
 ---->  Manufacturer  <----
     |                        |
     |                        |
 Showroom                     |
     ^                        |
     |                      Model
     |                        ^
Salesperson                   |
     ^                        |
     |                        |
     ---------  Car  ---------- 
```

您如何执行限制 R？您可以添加外键关系`Car --> Manufacturer`。然而，汽车制造商可以通过围绕“钻石”以一种或另一种方式连接表格来建立，所以这样做肯定不会标准化吗？但是我不知道如何强制执行约束。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-06T11:55:03.873

确保钻石的“底部”不能参考最终导致钻石的不同“顶部”的钻石“侧面”的方法是使用**识别关系**和由此产生的“胖”自然键，因此它们可以在底部**合并：**

![在此处输入图像描述](../Images/683d15e07f8e874860a6c7a2336eaa78.png)

*（为简洁起见，仅显示 PK 字段。您几乎可以肯定需要车辆识别号作为备用键`Car`等...）*

已`ManufacturerId`沿钻石两侧迁移，并最终在底部合并为一个区域。**它是单一**领域的事实确保不会有两个制造商导致同一辆车。

顺便说一句，这仍然不会阻止您使用代理键（除了这些自然键），假设 DBMS 支持 FK 来替代键：

![在此处输入图像描述](../Images/3aba648a8b1ed7d4871870e871101e05.png)

在这个模型中，代理是多余的，但是你可能还有一些其他的实体，你没有向我们展示，这可能会从使用更纤细的 FK 中受益。

* * *

以上是您的图表的最直接转换，其中汽车仅作为已售汽车存在。但是，我怀疑您希望能够存储尚未售出的汽车，并在*售出*时记住购车者等...

所以，一个更完整的模型看起来像这样：

![在此处输入图像描述](../Images/60649588facb94dc1820a11253ead01f.png)

我们只是反复重复识别关系技巧，因此汽车不能在不同制造商的陈列室中展示，也不能由不同陈列室的销售人员出售。

当只有一排时，汽车是未售出的`Car`。当有一排 in`Car` **和**对应的排 in时，汽车被出售`Sale`。两者`Car`和`Sale`共享相同的 PK，这是“1 到 0..1”的关系，也可以通过合并`Car`和来建模`Sale`，并使 sale 的字段可以为 NULL，并使用适当的 CHECK 确保它们不能“部分为 NULL” .

顺便说一句，无论什么时候你卖东西，你都需要确保销售是“及时冻结的”。例如，购买者实际支付的价格不应该仅仅因为汽车在售出*后*价格发生变化而改变。在[这里](https://stackoverflow.com/a/11930467/533120)查看更多信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-05T20:41:30.323

如果我正确理解了这个问题，这应该很接近。

![在此处输入图像描述](../Images/eb18bebfe56c1292462f87fc0687f0b5.png)

这里有一些关于钥匙的细节

```
--
-- Keys for SalesPerson
--
alter table SalesPerson
  add constraint PK_salesperson primary key (PersonID)

, add constraint AK1_salesperson unique (ManufacturerID, ShowRoomNo, PersonID) 

, add constraint FK1_salesperson foreign key (PersonID)
                           references Person (PersonID)

, add constraint FK2_salesperson foreign key (ManufacturerID, ShowRoomNo)
                         references ShowRoom (ManufacturerID, ShowRoomNo)
;

--
-- keys for Sale table
--
alter table Sale
  add constraint PK_sale primary key (SaleID)

, add constraint FK1_sale foreign key (BuyerID)
                    references Person (PersonID)

, add constraint FK2_sale foreign key (ManufacturerID, ModelName, ShowRoomNo)
                references CarDisplay (ManufacturerID, ModelName, ShowRoomNo)

, add constraint FK3_sale foreign key (ManufacturerID, ShowRoomNo, SalesPersonID)
               references SalesPerson (ManufacturerID, ShowRoomNo, PersonID)
; 
```

# android - 从 Android 库项目访问 NDK 的标头

> ID：12288582
> 
> 赞同：1
> 
> 时间：2012-09-05T19:39:38.887
> 
> 标签：android, android-ndk, header-files, android-library, shared-libraries

我目前正在实现一个自定义的日志记录机制，我需要可以从本机代码和 Java 代码访问该机制。日志记录的基础是在 C/C++ 中使用 Java 包装器实现的，两者一起被构建为一个 android 库项目。

手头的问题是，虽然我的 Java 代码可以访问 Library 项目的输出，但我的本机代码似乎没有办法从 Library 项目中访问本机 .so 或标头。我是否缺少其他步骤，或者这只是当前 ADT 的限制？更具体地说，是否有一个 makefile/eclipse 配置可以解决我通常用来摆脱图书馆项目的事情？（根据需要构建.so，导入重建的.so，导入相关头文件进行c/c++编译等）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T20:21:40.753

我不认为这是一个限制。我们应该在 Android.mk 和 Application.mk 中声明本机代码依赖项

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T22:45:05.503

想出了一种方法来获得我想要的东西——大部分信息（当然）在 NDK 文档中，但我试图做的并不是 100% 支持 ADT。还应该注意的是，我目前被困在 Windows 环境中进行开发，因此在 Linux 中这可能更容易或不必要。第一个键是`$(call import-module ...)`宏。在您的库项目中，将源文件和 Android.mk 文件夹移动到您以后可以找到的命名目录中。我的图书馆项目目录如下所示：

```
MyProject
  > src
  > res
  v jni
      - Application.mk
      v MyLib
          - source.cpp
          - source.h
          - Android.mk 
```

我还必须编辑我的 Application.mk 以指向该项目：

```
APP_PROJECT_PATH := <path-to-my-project>
APP_BUILD_SCRIPT := $(APP_PROJECT_PATH)/jni/MyProject/Android.mk 
```

令人讨厌的是，这以无法预料的方式破坏了我的 Android.mk，直到我将 a 添加`./`到我的源文件中。您还需要导出包含以进行链接：

```
LOCAL_SRC_FILES := ./source.cpp
LOCAL_EXPORT_C_INCLUDES := $(LOCAL_PATH) 
```

确保系统路径变量`NDK_MODULE_PATH`设置为包括您的库的 JNI 目录，例如`<path-to-my-project>/jni`（注意：我这样做后必须重新启动 eclipse）。

在接收应用程序的 Android.mk 文件（您希望本地链接到您的应用程序的文件）中，导入模块：

```
LOCAL_PATH := $(call my-dir)
include $(CLEAR_VARS)
LOCAL_MODULE    := MyNativeProject
LOCAL_SRC_FILES := source.cpp
LOCAL_CFLAGS := -DANDROID_NDK -g -std=c99
LOCAL_SHARED_LIBRARIES := MyLib
include $(BUILD_SHARED_LIBRARY)

$(call import-module,android/native_app_glue)
$(call import-module, IntelLog) 
```

此时一切都已完美构建，但 APK 打包器不喜欢生成的 .so 二进制文件被包含两次（一次来自库项目的自然导入过程，另一次来自`import-module`调用）。要解决这个问题，请清理库并且不要再次构建它！该`import-module`调用将构建 .so 并将其导入您的项目。（显然，如果您的项目只需要 Java API，则需要构建该 .so 文件）。恭喜！你有一个使用混合原生/Java 库的功能性（如果不是直截了当的话）构建过程

# php - 在 ZendFramework 上设置不同的 Controller_Front

> ID：12288583
> 
> 赞同：0
> 
> 时间：2012-09-05T19:39:45.390
> 
> 标签：php, zend-framework, zend-controller

我确实需要更改 Zend_Controller_Front 并使用 My_Controller_Front，但我无法弄清楚......我做了这个：

在 My_Controller_Front

```
 /**
     * Set singleton instance
     */
    public static function setInstance($instance = null) {
        self::$_instance = $instance;
    } 
```

在我的引导下

```
protected function _replaceZendController() {
    Busca_Controller_Front::setInstance(Busca_Controller_Front::getInstance());

    return $this;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T18:22:41.453

通过查看代码，我认为`Zend_Application`除了`Zend_Controller_Front`.

当您运行 Zend_Application 时，会发生以下事情：

*   `Zend_Application::bootstrap()`运行
*   引导过程创建`Zend_Application_Bootstrap_Bootstrap`设置资源加载器然后加载`FrontController`资源
*   Frontcontroller 资源被硬编码以加载`Zend_Controller_Front`（请参阅参考资料`Zend/Application/Resource/Frontcontroller::getFrontController()`）

您可能能够更改此行为的唯一方法是注册您自己的资源加载器，它可以拦截`FrontController`加载您的前端控制器而不是 Zend 前端控制器的资源的加载。当然，您必须确保您的前端控制器支持 Zend 框架支持的所有选项。

那么问题来了，为什么要换成`Zend_Controller_Front`自己的呢？您不能设置适当的选项或创建插件来实现您的目标吗？

# wcf - 如何在 WCF 中使用 SoapExtensionReflector？

> ID：12288586
> 
> 赞同：2
> 
> 时间：2012-09-05T19:40:17.697
> 
> 标签：wcf

我正在尝试更改 wcf Web 服务中的 wsdl。我发现这篇文章[http://blogs.msdn.com/b/kaevans/archive/2005/11/16/493496.aspx](http://blogs.msdn.com/b/kaevans/archive/2005/11/16/493496.aspx)但不幸的是我不能让它工作。

这是网络配置

```
<configuration>
  <system.serviceModel>

    <services>
      <service name="Microsoft.ServiceModel.Samples.CalculatorService" behaviorConfiguration="MyServiceTypeBehaviors" >
        <endpoint contract="Microsoft.ServiceModel.Samples.ICalculator" binding="mexHttpBinding" address="mex" />
      </service>
    </services>

    <behaviors>
      <serviceBehaviors>
        <behavior name="MyServiceTypeBehaviors" >
          <serviceMetadata httpGetEnabled="true" />
        </behavior>
      </serviceBehaviors>
    </behaviors>

  </system.serviceModel>

  <system.web>
    <webServices>
      <soapExtensionReflectorTypes>
        <add type="Msdn.Web.Services.Samples.HttpsReflector, App_Code"/>
      </soapExtensionReflectorTypes>
    </webServices>
  </system.web>

</configuration> 
```

附加链接[http://msdn.microsoft.com/ru-ru/library/ms733766.aspx](http://msdn.microsoft.com/ru-ru/library/ms733766.aspx)

# excel - Excel VBA，错误 438“对象不支持此属性或方法

> ID：12288588
> 
> 赞同：4
> 
> 时间：2012-09-05T19:40:23.707
> 
> 标签：excel, vba

我有这段代码，我在其中得到了一些帮助，但我遇到了一个问题，或者我认为是一个问题。最后一次查找，我被告知该对象不支持此属性或方法。我知道这可能很容易，但我的大脑正在闷烧。如果有人知道为什么会发生这种情况，我需要一些帮助。

谢谢。

```
Option Explicit

Sub Update_Dakota()

    Dim wsDAO As Worksheet              'Dakota OOR
    Dim wsDAD As Worksheet              'Dakota Data
    Dim wsDAR As Worksheet              'Dakota Archive
    Dim wsPOR As Workbook               'New Workbook
    Dim lastrow As Long, fstcell As Long
    Dim strFile As String, NewFileType As String, filename As String

    Set wsDAO = Sheets("Dakota OOR")
    Set wsDAD = Sheets("Dakota Data")
    Set wsDAR = Sheets("Dakota Archive")

    With Application
        .ScreenUpdating = False
        .DisplayAlerts = False
        .EnableEvents = False
    End With

    lastrow = wsDAD.Range("B" & Rows.Count).End(xlUp).Row + 1

    With wsDAD
        .Range("I2").Formula = "=COUNTIFS('Dakota OOR'!$B:$B,$A2,'Dakota OOR'!$D:$D,$C2, 'Dakota OOR'!$G:$G,$F2)"
        .Range("J2").Formula = "=IF(I2,""Same"",""Different"")"
        wsDAD.Range("I2:J2").Copy wsDAD.Range("I3:J" & lastrow)
        wsDAD.Range("I:J").Calculate
    End With

    strFile = Application.GetOpenFilename()
    NewFileType = "Excel Files 2007 (*.xls)"
    Set wsPOR = Application.Workbooks.Open(strFile)
    lastrow = wsPOR.Range("A" & Rows.Count).End(xlUp).Row + 1

    wsPOR.Range("A2:G" & lastrow).Select

End Sub 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-05T19:46:00.060

错误在这里

```
lastrow = wsPOR.Range("A" & Rows.Count).End(xlUp).Row + 1 
```

wsPOR 是工作簿而不是工作表。如果您正在使用该工作簿的“Sheet1”，那么试试这个

```
lastrow = wsPOR.Sheets("Sheet1").Range("A" & _
          wsPOR.Sheets("Sheet1").Rows.Count).End(xlUp).Row + 1 
```

相似地

```
wsPOR.Range("A2:G" & lastrow).Select 
```

应该

```
wsPOR.Sheets("Sheet1").Range("A2:G" & lastrow).Select 
```

# javascript - javascript中的映射和匹配范围

> ID：12288590
> 
> 赞同：3
> 
> 时间：2012-09-05T19:40:26.403
> 
> 标签：javascript, arrays, math, map, match

在 JavaScript 中使用数组映射范围最有效的是什么？

我有这个：

```
var def = [70,200,1000]; 
```

还有一系列可能的数字，比如：

```
var n = [23,45,74,120,240,800,1204,2000]; 
```

现在，**如何从中提取`n`与 中的值匹配的最接近的值`def`？**

在上面的例子中，我会得到`[74,240,800]`. 我希望我清楚自己...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T19:56:01.570

这是一个尝试。迭代`def`一次`n`：

```
var nIndex = 0,
    nlen = n.length,
    prev,
    next;

for(var i = 0, ilen = def.length; i < ilen && nIndex < nlen; i++) {
    var current = def[i];

    while (n[nIndex] < current && nIndex < nlen - 1) nIndex++;

    next = n[nIndex];
    prev = nIndex == 0 ? next : n[nIndex - 1];

    result[i] = current - prev < next - current ? prev : next;
}
// values in def are larger than the greatest value in n
while (result.length < def.length) result.push(n[nlen-1]); 
```

[小提琴](http://jsfiddle.net/u8x3E/3)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T19:55:15.863

[http://jsfiddle.net/8bY2M/](http://jsfiddle.net/8bY2M/)

```
var def = [70,200,1000];
var n = [23,45,74,120,240,800,1204,2000];

var result = [];

for (var i = 0; i < def.length; i++){
    var val = def[i];
    for (var j = 0; j < n.length; j++){
        var nVal = n[j];                
        if (nVal > val){
            var closest = n[j-1] == undefined ? nVal : 
                nVal - val > val - n[j-1] ? n[j-1] : nVal;

            result.push(closest);
            break;
        }    
    }
}

console.log(result); // outputs: [74, 240, 800] 
```

请注意，如果有两个匹配项，这将使用较大的值。（即如果您尝试匹配 70，并且 n 包含 66 和 74，这将与 74 匹配）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T20:33:30.880

其他解决方案非常简单，但如果您正在寻找效率，最好的办法是对初始列表进行预排序（如果尚未排序），然后执行二进制搜索。这是我的解决方案：

```
var def = [70,200,1000];
var n = [23,45,74,120,240,800,1204,2000];

var findClosest = function(n, def) {
    var i, result = [];

    n = n.sort(function(a, b) { return a - b; }); //numeric sort

    var closestN = (function(val) {
        return (function search(r) {
            var mid = r.low + (0 | ((r.high - r.low) / 2));

            if(n[mid] === val) { 
                return n[mid];
            }

            if((r.high - r.low) === 1) {
                return n[r[(Math.abs(n[r.low] - val) > Math.abs(n[r.high] - val)) ? "high" : "low"]];
            }

            r[(val < n[mid]) ? "high" : "low"] = mid;

            return search(r);
        }({low : 0, high: (n.length - 1)})); 
    });

    for (i=0; i<def.length; i++) {
        result.push(closestN(def[i]));    
    }

    return result;
};

//The result can be obtained with findClosest(n, def) 
```

请注意，它的可读性不是很高（如果您不熟悉二进制搜索算法），并且如果您正在寻找性能不重要的简单解决方案，线性搜索会产生更易于维护的代码。但是这个解决方案在 O(n log(n)) 时间内运行，而不是像线性搜索那样在 O(n^2) 时间内运行。

你可以在这里看到它的实际效果：

[http://jsfiddle.net/naYu6/](http://jsfiddle.net/naYu6/)

请注意，在“平局”的情况下（列表中的两个值与所讨论的值等距，将选择两者中较低的一个）。

# java - 无法将 X.509 CN 与 Java 正则表达式匹配

> ID：12288591
> 
> 赞同：0
> 
> 时间：2012-09-05T19:40:30.787
> 
> 标签：java, regex

我正在尝试使用正则表达式来匹配来自 X.509 证书的 CN。

整个字符串看起来像这样：

CN=杰森，OU=MYOU，O=MYORG

这是无效的代码：

```
 Object certChain = request
            .getAttribute("javax.servlet.request.X509Certificate");
    String name = "";
    if (certChain != null) {
        X509Certificate certs[] = (X509Certificate[]) certChain;
        X509Certificate cert = certs[0];
        name = cert.getSubjectDN().getName();
    }

    String strPattern = "CN=(.*?),";
    Pattern pattern = Pattern.compile(strPattern);
    Matcher matcher = pattern.matcher(name);
    String cname = "";
    if (matcher.matches()) {
        cname = matcher.group(1);
    } 
```

Matcher.matches() 返回 false，但我看不出该模式有问题。任何人都可以帮忙吗？

杰森

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T19:56:45.370

`Matcher.matches`如果模式匹配*所有*输入，则唯一返回 true 。你有两条前进的道路：

*   扩展模式以匹配所有输入：`"CN=(.*?),.*"`
*   用于`Matcher.find`查找输入中模式的第一次出现。对 find 的后续调用将匹配输入中的连续出现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T19:43:59.210

要完全匹配字符串`Matcher.matches()`，您可以使用：

```
String strPattern = "CN=(.*?),.*"; 
```

# asp.net - 不使用嵌套网格视图的可扩展/可折叠网格视图行？

> ID：12288592
> 
> 赞同：1
> 
> 时间：2012-09-05T19:40:35.030
> 
> 标签：asp.net, vb.net, gridview

我需要在我的 gridview 中添加一个可扩展的功能，我不太确定我在网上找到的教程是否完全涵盖了我正在寻找的内容。我们有一个填充了 SQL 查询结果的 gridview。这些结果按“过期日期”排序，所有过期的记录都移到顶部并显示为灰色。我们希望折叠所有过期的记录，使其更清晰、更清晰。有没有人有关于如何解决这个问题的任何提示？我发现的大部分内容都涉及嵌套的网格视图，但是我不确定这是否与这个项目有关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T15:16:44.290

如果您在网页中使用 jQuery，这很简单。向要隐藏的行添加一个 CSS 类。只需打电话给`.hide()`他们。

```
$('.greyedout').hide(); 
```

下面是一个示例，它显示了可以隐藏行。希望它能向您解释基本思想。

[http://jsfiddle.net/deostroll/LVyvR/embedded/result/](http://jsfiddle.net/deostroll/LVyvR/embedded/result/)

# objective-c - 从 view.layer 的presentationLayer 捕获图像

> ID：12288595
> 
> 赞同：4
> 
> 时间：2012-09-05T19:40:48.650
> 
> 标签：objective-c, ipad, uiview, screenshot, calayer

最近，我尝试使用动画元素捕获 UIWebView 的屏幕截图。问题是它们出现在屏幕截图上的原始位置，就像没有动画一样。我尝试使用以下代码来解决此问题：

```
CGRect screenRect = [[UIScreen mainScreen] bounds];
UIGraphicsBeginImageContext(self.frame.size);
CGContextRef context = UIGraphicsGetCurrentContext();
[[UIColor clearColor] set];
CGContextFillRect(context, screenRect);
[[self.layer presentationLayer] renderInContext:context];
UIImage *screenImage = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();
return screenImage; 
```

但它使用 EXC_BAD_ACCESS 删除了我的应用程序。一项小研究表明，这种行为是由于快速变化的presentationLayer造成的；所以当我尝试 renderInContext 时，它实际上不存在，`[self.layer presentationLayer]`现在返回另一个 CALayer 对象。

所以问题是如何从动画层的当前状态中获取图像，或者（这也可能是一个解决方案）如何阻止它在截屏时更改presentationLayer？

[更新] 更有趣：presentationLayer 似乎是空的，因为它的内容是 nil，正如我在调试器中看到的那样......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T08:55:21.073

好的，问题出在 CSS 中：

```
-webkit-transform: perspective(100px) translate3d(200px, 100px, -50px) rotateY(15deg); 
```

任何透视或rotateY/rotateX 都会杀死屏幕截图上元素的位置，取自view.layer renderInContext。所以没有办法捕捉网页上“真正的 3d”定位元素。

# android - 我是否需要通过 IntentService 中的超类 onCreate 和 onDestroy 方法调用？

> ID：12288597
> 
> 赞同：4
> 
> 时间：2012-09-05T19:40:50.600
> 
> 标签：android, android-service, intentservice

我已经派生了一个类`IntentService`，我想知道在我的实现中重写这些方法时是否有必要通过超类`onCreate`和`onDestroy`方法调用，因为当您在`Activity`..中重写这些方法时会发生这种情况。如果有必要，请执行这些操作调用需要是我们在覆盖方法中做的第一件事吗？在`Activity`文档中他们对此非常清楚，而在`Service` or`IntentService`文档中我找不到任何具体的内容。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-05T19:44:59.537

> 我想知道在我的实现中重写这些方法时是否有必要通过超类 onCreate 和 onDestroy 方法调用，因为在 Activity 中重写这些方法时会发生这种情况。

绝对地。这些方法在`IntentService`; 如果您没有打电话给他们，您的服务将无法正常工作。

> 如果有必要，这些调用是否需要成为我们在覆盖方法中做的第一件事？

我建议将调用作为`super.onCreate()`您在.`onCreate()``super.onDestroy()``onDestroy()`

# php - $_SESSION 永远不会被设置

> ID：12288601
> 
> 赞同：0
> 
> 时间：2012-09-05T19:41:03.737
> 
> 标签：php, unit-testing, session, login

我正在做一个 PHP 课程的作业，我被困在它的最后一部分。

任务是创建一个简单的登录表单并使用会话以及硬编码的用户名和密码（即没有数据库）。

我遇到的问题是处理登录的类，尤其是会话。有很多代码，我不知道我可以删除什么，因此我把它放在 Pastebin 上，希望没关系。

事情是内置在类中的单元测试通过了，除了 nr。4，检查用户是否登录的那个。问题似乎是 $_SESSION[$this->loginSession] 没有设置，这就是我需要帮助的地方。

变量 $loginSession 在类的开头声明，当用户键入正确的用户名和密码时，应将其设置为“isLoggedIn”，但这不会发生（没有错误消息）。

我的课是：

```
<?php

class LoginHandler {

        private $loginSession;

        public function IsLoggedIn() {
                if($_SESSION[$this->loginSession] == "isLoggedIn") {
                        return true;
                }
                else {
                        return false;
                }
        }

        public function DoLogin($username, $password){

                if ($username != null && $password != null){
                        switch ($username){
                                case "hello";
                                if ($password == "1234"){
                                        $_SESSION[$this->loginSession] == "isLoggedIn";
                                        return true;
                                }
                                else return false;
                                case "hello2";
                                if ($password == "12345"){
                                        $_SESSION[$this->loginSession] == "isLoggedIn";
                                        return true;
                                }
                                else return false;
                        }
                }
                else {
                        return false;
                }
        }

        public function DoLogout(){
                unset($_SESSION[$this->loginSession]);
        }

        public function Test() {

                $this->DoLogout();

                // Test 1: Check so you're not logged in.
                if($this->IsLoggedIn() == true){
                        echo "Test 1 failed";
                        return false;
                }

                // Test 2: Check so that it's not possible to login with wrong password.
                if ($this->DoLogin("hello", "4321") == true){
                        echo "Test 2 failed";
                        return false;
                }

                // Test 3: Check that it's possible to log in.
                if ($this->DoLogin("hello", "1234") == false){
                        echo "Test 3 failed";
                        return false;
                }

                // Test 4: Check that you're logged in
                if ($this->IsLoggedIn() == false){
                        echo "Test 4 failed";
                        return false;
                }

                return true;
        }
}

?> 
```

我希望包含类而不是所有其他文件就足够了，否则我会把它们放上去。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T19:54:10.433

现在我看到了:-)

$_SESSION[$this->loginSession] == "isLoggedIn";

== 应该是 =

== 比较 while = 集合

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-05T19:42:36.620

您需要开始会话。`session_start();` 将它放在您正在使用的文档的最顶部（在页面加载时仅一次）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T20:13:31.990

为什么要在案例说明中使用分号`case "hello";`？应该有一个冒号。`case "hello": { ...instructions}`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-05T19:49:34.790

$this->loginSession 从未设置，所以它是 NULL
$_SESSION[null] 据我所知是不可能的

将您的代码更改为

```
private $loginSession = 'testing'; 
```

它应该可以工作

# php - PHP 简单 HTML DOM 解析器 > 修改获取的链接

> ID：12288602
> 
> 赞同：1
> 
> 时间：2012-09-05T19:41:04.907
> 
> 标签：php, dom

我有一个可以从网站获取内容的脚本，我想做的是修改所有链接。认为：

```
$html = str_get_html('<h2 class="r"><a class="l" href="http://www.example.com/2009/07/page.html" onmousedown="return curwt(this, 'http://www.example.com/2009/07/page.html')">SEO Result Boost <b> </b></a></h2>'); 
```

那么，是否可以这样修改或重写>

```
<h2 class="r"><a class="l" href="http://www.site.com?http://www.example.com/2009/07/page.html">SEO Result Boost <b> </b></a></h2> 
```

我已经阅读了它的手册，但无法理解如何计算它（[http://simplehtmldom.sourceforge.net/#fragment-12](http://simplehtmldom.sourceforge.net/#fragment-12)）

## 有可能吗，有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-06T17:28:54.693

假设[相关问题的答案](https://stackoverflow.com/a/4603362/1443717)有效，

**您应该能够使用以下处理[简单 HTML DOM](http://sourceforge.net/projects/simplehtmldom/)**

```
$site = "http://siteyourgettinglinksfrom.com";
$doc = str_get_html($code);
foreach ($doc->find('a[href]') as $a) {
$href = $a->href;
if (/* $href begins with a absolute URL path */) {
    $a->href = 'http://www.site.com?'.$href;
}
else{ /* $href begins with a relative path */        
    $a->href = 'http://www.site.com?'.$site.$href;
}

}
$code = (string) $doc; 
```

或者

**使用[PHP 的原生 DOM 库](http://php.net/book.dom)：**

```
$site = "http://siteyourgettinglinksfrom.com";
$doc = new DOMDocument();
$doc->loadHTML($code);
$xpath = new DOMXpath($doc);
foreach ($xpath->query('//a[@href]') as $a) {
$href = $a->getAttribute('href');
if (/* $href begins with a absolute URL path */) {
    $a->setAttribute('href', 'http://www.site.com?'.$href);
}
else{ /* $href begins with a relative path */
    $a->setAttribute('href', 'http://www.site.com?'.$site.$href);
}
}
$code = $doc->saveHTML(); 
```

**检查 $href：**

您将检查相对链接并在您从中提取内容的网站地址之前添加，因为大多数网站都使用相对链接。[（这就是正则表达式匹配器是你最好的朋友的地方）](https://stackoverflow.com/a/12013470/1443717)

对于相对链接，您可以在您从中获取链接的站点的绝对路径之前添加

```
 'http://www.site.com?'.$site.$href 
```

对于绝对链接，您只需附加相对链接

```
 'http://www.site.com?'.$href 
```

**示例链接：**

网站相关：`/images/picture.jpg`

文档相关：`../images/picture.jpg`

绝对：`http://somesite.com/images/picture.jpg`

（**注意：**这里需要做更多的工作，因为如果您处理“文档相关”链接，那么您将必须知道您当前所在的目录。站点相关链接应该很好，只要您拥有从中获取链接的站点的根文件夹）

# knockout.js - 将淘汰对象转换为纯 JavaScript 对象时的无限循环

> ID：12288603
> 
> 赞同：5
> 
> 时间：2012-09-05T19:41:06.747
> 
> 标签：knockout.js

按照文档中给出的[说明](http://knockoutjs.com/documentation/json-data.html)，我有以下视图模型：

```
var newContactViewModel = function () {
    var self = this;

    self.Name = ko.observable();
    self.Address = ko.observable();
    self.City = ko.observable();
    self.State = ko.observable();
    self.PostalCode = ko.observable();

    self.Save = function () {
        $.ajax({
            type: "POST",
            url: "/contact",
            data: ko.toJS(self), //infinite loop here
            success: state.OnSaved
        });
    };
}; 
```

调用该`self.Save`方法时，会发生无限循环。Chrome 实际上将错误报告为：

> 未捕获的 RangeError：超出最大调用堆栈大小

如果我使用`ko.mapping.toJS(self)`而不是`ko.toJS(self)`，那么我会得到一个稍微更具启发性的错误，但没有真正的错误“消息”：

![无限循环错误](../Images/90bb27ce779c2fdf1774fb216f9b5518.png)

如果我`ko.toJS(self)`用类似的东西换掉`{ Name: self.Name(), Address: self.Address() /* etc */ }`，那么一切正常。似乎它正在尝试转换`Save`方法并因此重新调用该方法。

KnockoutJS 中存在错误，或者我使用它时存在问题。我更喜欢后者。想法？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-05T20:24:27.100

我发现了代码的问题。 `ko.toJS`保留对象中的功能，因此它能够很好地映射它。但是，jquery 将调用数据对象上的所有函数来尝试获取值。这反过来会导致无限循环。

您需要将该`Save`函数标记为不被映射。不幸的是，该`toJS`功能似乎无法做到这一点。它将保留对象的所有成员。幸运的是，映射插件允许您这样做。

要排除成员，请将`ignore`选项设置为包含的数组，映射时`'Save'`它将忽略该成员。`Save`

```
var data = ko.mapping.toJS(self, {
    ignore: ['Save']
}); 
```

如果您不使用映射插件，则始终可以选择`Save`从 JS 对象中删除该函数。

```
self.Save = function () {
    $.ajax({
        type: "POST",
        url: "/contact",
        data: self.ToData(),
        success: state.OnSaved
    });
};
self.ToData = function () {
    var data = ko.toJS(self);
    delete data.Save; // remove functions
    delete data.ToData;
    return data;
}; 
```

另一方面，我建议不要尝试将视图模型实例用作调用的数据。我会明确地创建数据对象。当然，它有可能会很长，但这种方法很可能总是有效的。

```
self.ToData = function () {
    return ko.toJS({
        Name: self.Name,
        Address: self.Address,
        City: self.City,
        State: self.State,
        PostalCode: self.PostalCode
    });
}; 
```

# json - 标志名转 JSON

> ID：12288604
> 
> 赞同：1
> 
> 时间：2012-09-05T19:41:08.683
> 
> 标签：json, haskell

我需要将类型的值转换为`Distribution.PackageDescription.FlagName`带有包的 JSON`Text.JSON`对象`json`。
我最终采用了以下方法：

```
instance JSON FlagName where
    showJSON (FlagName n) = makeObj [ ("FlagName", showJSON n) ]
    readJSON object = do
        obj <- readJSON object
        flag <- valFromObj "FlagName" obj
        return flag 
```

当我尝试对一个值进行编码并再次对其进行解码时，会发生以下情况：

```
> showJSON (FlagName "foo")  
JSObject (JSONObject {fromJSObject = [("FlagName",JSString (JSONString {fromJSString = "foo"}))]})  
> readJSON (showJSON (FlagName "foo")) :: Result FlagName  
Error "Unable to read JSObject" 
```

我猜错误就在那一行：`obj <- readJSON object`
如何强制 Haskell 使用实例中的`readJSON`函数？`JSON String`

**更新：**我现在发现了一个相当老套的解决方案：

```
instance JSON FlagName where
    showJSON (FlagName n) = makeObj [ ("FlagName", showJSON n) ]

    readJSON object = do
        obj <- readJSON (showJSON (FlagName "foo")) :: Result (JSObject JSValue)
        let maybeFlagName = lookup "FlagName" $ fromJSObject obj
        maybe (fail "Not a FlagName object") (\jsn -> liftM FlagName $ (readJSON jsn :: Result String)) maybeFlagName 
```

如果有人提出更优雅的解决方案，我将不胜感激......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T21:05:18.347

好的，我自己找到了答案：
`valFromObj`返回`FlagName`（即 a `String`）的名称而不是`FlagName`本身。

```
instance JSON FlagName where
    showJSON (FlagName n) = makeObj [ ("FlagName", showJSON n) ]
    readJSON object = do
        obj <- readJSON object
        n <- valFromObj "FlagName" obj
        return $ FlagName n 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T04:28:28.457

最好进行模式匹配，这样您就可以处理 object 不是 of 的情况`JSObject`。除了失败，你还可以做一些其他的事情。您将需要`import Control.Applicative`使用`<$>`. 我只是更喜欢这些事情的应用语法。

```
 instance JSON FlagName where
     showJSON (FlagName n) = makeObj [ ("FlagName", showJSON n) ]
     readJSON (JSObject obj) = FlagName <$> valFromObj "FlagName" obj
     readJSON _ = fail "unknown object" 
```

# c#-4.0 - 如何从 XElement 获取 HTML 值？

> ID：12288612
> 
> 赞同：1
> 
> 时间：2012-09-05T19:41:45.933
> 
> 标签：c#-4.0, linq-to-xml

我试图解析的 XML 文件有一个可能包含 HTML 的元素。我尝试获得这样的值：

```
data.Description = root.Element(namespace+ "Description").Value; 
```

但是当值是 HTML 时，我会返回 HTML 的纯文本表示。有什么方法可以获取 XElement 的原始值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T19:43:08.277

您正在寻找`.ToString()`，它返回外部 XML 源（包括标签本身）

# git - 我们忘记了分支，我们如何进行？

> ID：12288613
> 
> 赞同：1
> 
> 时间：2012-09-05T19:41:46.903
> 
> 标签：git, github

所以我们有 4 个开发人员，我们称他们为 dev1、dev2、dev3 和 dev4。

我们创建了一个 github 帐户，dev1 将代码推送到 github，所有其他开发人员都从 github 中提取并开始研究不同的修补程序和改进。

我们没有使用分支，所以我们都使用 master 分支。

然后我们发现了分支并意识到我们可能应该分支，以便更容易合并内容。

现在，如果我们想从现在开始使用分支，最好的做法是什么？这就是我的想法。

1.  在每个开发人员的本地副本上创建分支
2.  提交并推送代码
3.  每个开发者将有 4 个分支
4.  以某种方式合并它们

这行得通吗？我现在担心的是，由于所有的开发者都做了一些工作并改变了他们的本地副本，如果他们开始一个新的分支，他们的 master 分支已经不同于 github 上的 master 分支。

我们如何以最小的努力进行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T05:40:14.317

如果您的所有开发人员都在同一系统的同一版本上工作，则没有理由创建额外的分支。

最简单的工作流程是让您的开发人员在他们的本地克隆中提交他们的工作，合并来自共享存储库的任何更改，测试此合并的结果并推送回共享主库。

如果您正在维护一个已发布的版本并同时处理未来的版本，或者如果您有一个长期的重构或正在开发的功能，您出于稳定性原因想要屏蔽主分支，您可能会考虑分支。

否则，没有必要为了分支而建立分支。您只会为自己进行额外的管理和维护工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T19:45:43.900

开发人员的个人`master`分支与上游 master 不同不是问题。开发人员都应该从他们自己的 master 创建分支，然后永远不要再碰他们个人的 master 分支（甚至可能删除它们）。

# javascript - 如何在不退出 javascript 的情况下从 javascript 更新网页

> ID：12288616
> 
> 赞同：0
> 
> 时间：2012-09-05T19:41:49.367
> 
> 标签：javascript, refresh, reload

我想用这样的东西动画一个html页面：

```
function showElements(a) {   
  for (i=1; i<=a; i++)  {  
    var img = document.getElementById(getImageId(i));  
    img.style.visibility = 'visible';  
    pause(500);  
  }  
}

function pause(ms) {
  ms += new Date().getTime();
  while (new Date() < ms){}
} 
```

不幸的是，页面只有在 javascript 完成后才会呈现。

如果我添加

```
 window.location.reload(); 
```

每次暂停后（500）；调用，这似乎迫使我的javascript退出。（至少，我没有到达我的 javascript 中的下一行代码。）

如果我插入

```
 var answer=prompt("hello"); 
```

在每次暂停（500）之后，这正是我想要的（即更新页面），除了我不想要烦人的提示，因为我实际上不需要任何用户输入。

那么......在我暂停后是否可以调用*一些东西*来强制刷新页面，不请求用户的任何输入，并允许我的脚本继续？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T19:47:31.813

当 javascript 线程运行时，渲染线程不会更新页面。你需要使用[`setTimeout`](https://developer.mozilla.org/en-US/docs/DOM/window.setTimeout).

无需创建第二个函数或暴露`i`给外部代码，您可以使用带有闭包的内部函数来实现这一点`a`and `i`：

```
function showElements(a) {
    var i = 1;
    function showNext() {
        var img = document.getElementById(getImageId(i));  
        img.style.visibility = 'visible'; 
        i++;
        if(i <= a) setTimeout(showNext, 500);
    }
    showNext();
} 
```

* * *

> 如果我`window.location.reload();`在每次`pause(500)`调用后添加，这似乎会强制我的 javascript 退出

`window.reload()`使浏览器丢弃当前页面并从服务器重新加载它，因此您的 javascript 停止。

* * *

> `var answer=prompt("hello");`如果我在每个之后插入`pause(500)`，这正是我想要的。

`prompt`, `alert`, 并且`confirm`几乎是唯一可以真正暂停 javascript 线程的东西。在某些浏览器中，即使这些仍然会阻塞 UI 线程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T19:45:17.307

您的`pause()`函数在 UI 线程上休眠并冻结浏览器。
这是你的问题。

相反，您需要`setTimeout`稍后调用函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T19:47:37.073

Javascript 本质上是事件驱动/非阻塞的（这是 javascript/Node.js 的一大优点）。试图规避内置功能绝不是一个好主意。为了做你想做的事，你需要安排你的活动。一种方法是使用 setTimeout 和简单的递归。

```
function showElements(a) {   
  showElement(1,a);
}

function showElement(i, max) {
   var img = document.getElementById(getImageId(i));  
   img.style.visibility = 'visible';
   if (i < max) {
      setTimeout(function() { showElement(i+1, max) }, 500);
   }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-05T19:56:36.697

```
function showElements(a,t) {   
  for (var i=1; i<=a; i++)  {  
    (function(a,b){setTimeout(function(){
      document.getElementById(getImageId(a)).style.visibility = 'visible'},a*b);}
    )(i,t)  
  }  
} 
```

t 参数是延迟，例如 500

演示：http: [//jsfiddle.net/doktormolle/nLrps/](http://jsfiddle.net/doktormolle/nLrps/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-05T19:49:04.910

```
var i = 1;
function showElements(a) {   
    var img = document.getElementById(getImageId(i));  
    img.style.visibility = 'visible';  
    if (i < a) {
      setTimeout(function() { showElements(a) }, 500);  
    }
    i++;
}
showElements(5); 
```

# sql - 如何克服死锁

> ID：12288618
> 
> 赞同：0
> 
> 时间：2012-09-05T19:41:57.853
> 
> 标签：sql, deadlock

尝试运行带有删除语句的存储过程时，我收到死锁错误。发生的事情是我有一个 FK 约束表行，该行与我要删除的与之相关的表行同时更新。约束表中正在更新的数据不再重要，任何人都将不再出于任何原因访问正在更新的数据的检索，碰巧这种更新和删除都可以同时发生。所以，我需要以删除为主要操作。

我需要做什么来阻止这样的僵局？

`DELETE FROM Storefront.Sidelite WHERE ID = @SideliteID`;

下面是 Sidelite 表和 Size 约束表的屏幕截图。

![有问题的表](../Images/2213727a4395d4969f5cb3c52adb3ef9.png)

好的，这里没有读取。唯一发生的事情是对 Size 表的许多更新，而 Sidelite 表试图删除它的大小正在更新的记录，这会导致死锁。

我需要停止对 Size 表的所有操作，同时在 sidelite 表中进行删除，然后，我将在触发器中删除相关的大小记录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T19:47:40.287

在获得初始值的 select 语句中，您可以使用 with(readuncommitted) 或 with(nolock) 语句。然而，这会给你带来脏读。请使用以下链接获取更多信息：[为什么使用 READ UNCOMMITTED 隔离级别？](https://stackoverflow.com/questions/2471055/why-use-a-read-uncommitted-isolation-level)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T17:40:19.220

1.)`SET ALLOW_SNAPSHOT_ISOLATION ON`

2.)`SET TRANSACTION ISOLATION LEVEL SNAPSHOT`

```
ALTER proc [Storefront].[proc_DeleteSidelite]
@SideliteID INT
AS
BEGIN
SET TRANSACTION ISOLATION LEVEL SNAPSHOT

  DECLARE @SizeID INT; 
        BEGIN TRAN
          SELECT @SizeID= sl.SizeID FROM Storefront.Sidelite sl 
                                    with(nolock) WHERE sl.ID = @SideliteID
          DELETE FROM Storefront.Sidelite WHERE ID = @SideliteID;
          DELETE FROM Storefront.Size  WHERE ID=@SizeID;
        COMMIT TRAN
END; 
```

# php - 开发者回应 - 付款回调。PHP - 让我发疯

> ID：12288619
> 
> 赞同：0
> 
> 时间：2012-09-05T19:42:08.773
> 
> 标签：php, facebook, facebook-graph-api, payment, facebook-credits

好的，所以我正在尝试在我正在开发的应用程序中设置付款，我的对话框正在工作，它确认购买了该商品。我不知道它在这里之后做了什么，我已经阅读了一篇又一篇文章，但没有快乐。我需要有关如何在购买时更新 mysql 数据库的信息。我知道这个问题很模糊，但任何指导将不胜感激！

我到目前为止的代码如下。

```
if ($request_type == 'payments_get_items') {
  // Get order info from Pay Dialog's order_info.
  // Assumes order_info is a JSON encoded string.
  $order_info = json_decode($request['credits']['order_info'], true);

  // Get item id.
  $item_id = $order_info['item_id'];

  // Simulutates item lookup based on Pay Dialog's order_info.
  if ($item_id == '10Kremeggs') {
    $item = array(
      'title' => '10 Kremeggs',
      'description' => 'Spend Kremeggs in Alien Abduction.',
      // Price must be denominated in credits.
      'price' => 5,
      'image_url' => 'https://afternoon-snow-5267.herokuapp.com/images/bung.png',
      'product_url' => 'https://afternoon-snow-5267.herokuapp.com/Purchase/10xKremeggs.php'
    );

    // Construct response.
    $response = array(
                  'content' => array(
                                 0 => $item,
                               ),
                  'method' => $request_type,
                );
    // Response must be JSON encoded.
    $response = json_encode($response);
  }

} else if ($request_type == "payments_status_update") {
  // Get order details.
  $order_details = json_decode($request['credits']['order_details'], true);

  // Determine if this is an earned currency order.
  $item_data = json_decode($order_details['items'][0]['data'], true);
  $earned_currency_order = (isset($item_data['modified'])) ?
                             $item_data['modified'] : null;

  // Get order status.
  $current_order_status = $order_details['status'];

  if ($current_order_status == 'placed') {
    // Fulfill order based on $order_details unless...

    if ($earned_currency_order) {
      // Fulfill order based on the information below...
      // URL to the application's currency webpage.
      $product = $earned_currency_order['product'];
      // Title of the application currency webpage.
      $product_title = $earned_currency_order['product_title'];
      // Amount of application currency to deposit.
      $product_amount = $earned_currency_order['product_amount'];
      // If the order is settled, the developer will receive this
      // amount of credits as payment.
      $credits_amount = $earned_currency_order['credits_amount'];
    }

    $next_order_status = 'settled';

    // Construct response.
    $response = array(
                  'content' => array(
                                 'status' => $next_order_status,
                                 'order_id' => $order_details['order_id'],
                               ),
                  'method' => $request_type,
                );
    // Response must be JSON encoded.
    $response = json_encode($response);

  } else if ($current_order_status == 'disputed') {
    // 1\. Track disputed item orders.
    // 2\. Investigate user's dispute and resolve by settling or refunding the order.
    // 3\. Update the order status asychronously using Graph API.

  } else if ($current_order_status == 'refunded') {
    // Track refunded item orders initiated by Facebook. No need to respond.

  } else {
    // Track other order statuses.

  }
} 
```

以上是部分支付回调

```
<? mysql_query("UPDATE users SET Kremeggs = Kremeggs+10 WHERE Facebook_id = '$PurchaseUpdate'");
header ("Location: http://apps.facebook.com/alien_abduction/purchaseComplete.php");
?>
</body>
</html> 
```

以上是我需要付款的地方。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T04:43:58.213

听起来您正试图在一个文件中同时处理该过程的两个非常独立的部分（您的第二个代码示例）。您发布的第一个代码示例（看起来像他们的示例代码，这很好）是奖励用户的正确位置 - 您的 mysql 查询属于从第 43 行（`if ($current_order_status == 'placed') {`）开始的块内。我会把细节留给你解决。

您想做的后半部分（将用户重定向到确认页面）不*属于*该回调，而是属于带有付款对话框的页面。如果您也在那里使用示例代码，它属于 js_callback 函数 - 尝试`window.location.href='purchase_complete.php'`（确保这只发生在成功的订单上，ofc）。

希望这能让你指出正确的方向！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T13:21:00.040

```
else if ($request_type == "payments_status_update") {mysql_query("update users_table set payment_column='isok' where kulid like 'getFacebookUserId'");} 
```

# spotify - Windows XP 上的 Spotify 应用程序目录？

> ID：12288620
> 
> 赞同：0
> 
> 时间：2012-09-05T19:42:11.580
> 
> 标签：spotify

我正在尝试在 windows 系统上的 spotify 中调试 spotify 应用程序。但我无法启动应用程序。我遇到了这篇[文章](https://stackoverflow.com/questions/8756961/spotify-apps-home-directory-location-windows-local-development)中描述的相同问题，但在 Windows XP 上路径不同。

我试过 C:\Documents and Settings[user name]\My Documents\Spotify 但这不起作用。知道如何让它发挥作用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T08:17:01.937

我需要重新启动虚拟机。比它奏效了。

# django - Django 和 pytz 的问题

> ID：12288624
> 
> 赞同：1
> 
> 时间：2012-09-05T19:42:37.540
> 
> 标签：django, timezone, pytz

我按照 Django 网站上的时区文档没有运气。我的问题是我的模板上有一个选择框，应该填充 pytz 提供的常用时区，但是，无论出于何种原因，它都是空的。

我的最终目标是允许用户选择自己的时区。

任何帮助表示赞赏，在此先感谢。

**视图.py：**

```
def set_timezone(request):
    if request.method == 'POST':
        request.session['django_timezone'] = pytz.timezone(request.POST['timezone'])
        return redirect('/')
    else:
        return render(request, 'n2w/leads.html', {'timezones': pytz.common_timezones}) 
```

**线索.html：**

```
 {% load tz %}
            {{ datetime }}
            <form action="" method="POST">
                {% csrf_token %}
                <label for="timezone">Time zone:</label>
                <select name="timezone">
                    {% for tz in timezones %}
                        <option value="{{ tz }}"{% if tz == TIME_ZONE %} selected="selected"{% endif %}>{{ tz }}</option>
                    {% endfor %}
                </select>
                <input type="submit" value="Set" />
            </form> 
```

**设置.py：**

```
MIDDLEWARE_CLASSES = (
    'django.middleware.common.CommonMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'django.middleware.timezone.TimeZoneMiddleware',
    # Uncomment the next line for simple clickjacking protection:
    # 'django.middleware.clickjacking.XFrameOptionsMiddleware',
        )

INSTALLED_APPS = (
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    #'django.contrib.sites',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'django.contrib.admin',
    'django.contrib.admindocs',
    'registration',
    'django.contrib.humanize',
    'n2w',
    'n2api',
    'dajaxice',
    'pytz',
) 
```

**中间件类（timezone.py）：**

```
from django.utils import timezone

class TimeZoneMiddleware(object):
    def process_request(self, request):
        tz = request.session.get('django_timezone')
        if tz:
            timezone.activate(tz) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T19:52:59.070

我认为您可能会提出 NameError 或其他问题。尝试导入 pytz：

从 pytz 导入 common_timezones

...

...

返回渲染（请求，'n2w/leads.html'，{'timezones'：common_timezones}）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T15:03:26.303

从 2.7.1 -> 2.7.3 升级我的 Python 安装后，我能够完美地导入 pytz。感谢你的帮助！

# asp.net-mvc-3 - 在 razor mvc3 中添加报告时出现 Devexpress 错误

> ID：12288625
> 
> 赞同：3
> 
> 时间：2012-09-05T19:42:43.940
> 
> 标签：asp.net-mvc-3, devexpress

我正在尝试在我的 MVC 3 Web 应用程序“此应用程序是普通的 MVC 3 应用程序而不是 DevExpress MVC 3 应用程序”中使用 DevExpress 报告，使用以下教程添加 XtraReports [http://documentation.devexpress.com/#XtraReports/CustomDocument9974](http://documentation.devexpress.com/#XtraReports/CustomDocument9974)

问题是每次我尝试添加

```
@Html.DevExpress().ReportToolbar(settings => {
// The following settings are necessary for a Report Toolbar. 
settings.Name = "ReportToolbar";
settings.ReportViewerName = "reportViewer1";
}).GetHtml() 
```

DevExpress() 给我一个错误

“System.Web.Mvc.HtmlHelper”不包含“DevExpress”的定义，并且找不到接受“System.Web.Mvc.HtmlHelper”类型的第一个参数的扩展方法“DevExpress”（您是否缺少 using 指令还是汇编参考？）

有什么建议么？！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-08-20T07:05:34.977

您必须使用此链接中提供的步骤手动将 Devexpress 组件注册到您的项目：

[如何：手动注册 DevExpress 扩展以开始在 MVC Web 应用程序中使用它们](http://documentation.devexpress.com/#AspNet/CustomDocument8163)

上面提供的步骤中唯一缺少的是程序集绑定重定向。没有它，我得到了例外：

```
[InvalidCastException: Unable to cast object of type 'System.Web.Mvc.HtmlHelper`1[System.Object]' to type 'System.Web.Mvc.HtmlHelper'.] 
```

为了防止错误，我将此部分添加到我的主 web.config 下`<configuration>`：

```
<runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
        <dependentAssembly>
            <assemblyIdentity name="System.Web.Mvc" publicKeyToken="31bf3856ad364e35" />
            <bindingRedirect oldVersion="1.0.0.0-3.0.0.0" newVersion="4.0.0.0" />
        </dependentAssembly>
    </assemblyBinding>
</runtime> 
```

这会将旧的 mvc 程序集版本重定向到 MVC 4。对于 MVC 3，bindingRedirect 行应该是这样的：

```
<bindingRedirect oldVersion="1.0.0.0-2.0.0.0" newVersion="3.0.0.0" /> 
```

# c - 如果多连接网络服务器中有一段时间不活动，则关闭套接字

> ID：12288627
> 
> 赞同：4
> 
> 时间：2012-09-05T19:42:51.767
> 
> 标签：c, sockets, http-1.1

我正在构建一个可以接受和处理多个客户端连接的网络服务器。我正在使用`select()`这个。
现在，在此过程中，如果特定连接的套接字上没有任何活动（发送或接收），我想关闭它。因此，如果一段时间内没有来自已连接客户端的请求，我将关闭套接字。有多个这样的连接套接字，我需要对每个套接字进行监视。

我需要这个功能来创建持久连接，因为我的网络服务器必须支持 HTTP 1.1

做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T20:05:05.837

我建议将调用超时设置为`select`下一个套接字超时之前的最短时间。然后，如果超时，关闭空闲套接字，然后重复。像这样的伪代码：

```
timeout = default_timeout;
foreach(socket s)
{
    timeout = min(timeout, (s.last_send_or_recv_time + IDLE_TIMEOUT - now()));
}

result = select(..., timeout);
if(result == 0)
{
    foreach(socket s)
    {
        if(now() - s.last_send_or_recv_time >= IDLE_TIMEOUT)
        {
            close(s);
            remove_from_socket_list(s);
        }
    }
}
else
{
    // Handle received data, update last_send_or_recv_time, etc.
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T02:08:04.673

如果您使用线程和阻塞模式，您只需要在套接字上设置一个合适的 SO_RCVTIMEOUT ，当您`read()`返回 -1 时`errno == EAGAIN/EWOULDBLOCK`，超时已经发生，所以您只需关闭套接字并退出线程。

如果你使用`select()`它会更复杂。Adam Rosenfield 的建议从表面上看似乎是合理的，但实际上，如果其他套接字足够忙，则`select()`超时可能根本不会发生，或者至少在套接字实际上变得太死后的几分钟内不会发生。如果您想严格执行超时，就像在服务器中应该的那样，您必须将最后读取时间与每个套接字相关联，并且在`select()`循环的底部，遍历`fd`集合，挑选出那些*未*准备好的 fd，检查他们的最后阅读时间，并关闭那些太死的人。

# ocaml - OCaml 选项获取

> ID：12288628
> 
> 赞同：11
> 
> 时间：2012-09-05T19:42:53.890
> 
> 标签：ocaml, option

我是 OCaml 的新手，我试图了解您应该如何从“a 选项”中获得价值。根据[http://ocaml-lib.sourceforge.net/doc/Option.html](http://ocaml-lib.sourceforge.net/doc/Option.html)上的文档，有一个 'a option -> 'a 类型的 get 函数可以满足我的要求。但是当我输入：

```
# let z = Some 3;;
val z : int option = Some 3
# get z;;
Error: Unbound value get
# Option.get z;;
Error: Unbound module Option 
```

为什么这不起作用？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-05T19:50:54.603

在 OCaml 中获取任何类型的构造函数中的值的传统方法是使用模式匹配。模式匹配是 OCaml 的一部分，可能与您在其他语言中看到的最不同，所以我建议您不要只是按照您习惯的方式编写程序（例如规避 ocaml-lib 的问题) 而是尝试一下，看看你是否喜欢它。

```
let contents = 
   match z with
   Some c -> c;; 
```

变量`contents`已分配`3`，但您会收到警告：

> 警告 8：这种模式匹配并不详尽。以下是不匹配的值的示例：无

在一般情况下，您不会知道要查看的表达式一定是`Some c`. 选择选项类型的原因通常是有时该值可以是`None`. 在这里，编译器提醒您您没有处理其中一种可能的情况。

您可以“深入”进行模式匹配，编译器仍会检查穷举。考虑这个函数，它需要一个`(int option) option`：

```
let f x =
  match x with
  Some (Some c) -> c
  | None -> 0
  ;; 
```

在这里，您忘记了这种情况`Some (None)`，编译器会告诉您：

> 警告 8：这种模式匹配并不详尽。以下是不匹配的值的示例： Some None

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-05T19:51:52.967

通常的方法是使用模式匹配。

```
# let x = Some 4;;
val x : int option = Some 4

# match x with
  | None -> Printf.printf "saw nothing at all\n"
  | Some v -> Printf.printf "saw %d\n" v;;
saw 4
- : unit = () 
```

您可以编写自己的 get 函数（尽管当值为 None 时您必须决定要做什么）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-09T06:02:00.050

你应该听听上面关于类型安全的海报建议，但也要注意不安全的函数，如 Option.get（顺便说一句，在电池中可用）通常以 exn 为后缀。如果您好奇，这就是如何实现 Option.get 或 Option.get_exn 的：

```
let get_exn = function
  | Some x -> x
  | None   -> raise (Invalid_argument "Option.get") 
```

# java - 如何在另一个活动中获取变量？

> ID：12288629
> 
> 赞同：10
> 
> 时间：2012-09-05T19:42:54.343
> 
> 标签：java, android

如何在另一个活动中访问变量值。在我的示例中，我有一个字符串变量项，其值是微调器选择的值。如何在不使用 Intent 的情况下在另一个活动中访问此变量？

```
 public class LoginScreen extends Activity {

      Spinner sp;
String item;

      Spinner sp = (Spinner) findViewById(R.id.lgnspinner);

    ArrayAdapter<CharSequence> adapter = ArrayAdapter.createFromResource(
            this, R.array.network_array,
            android.R.layout.simple_spinner_item);
    adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);

    sp.setAdapter(adapter);

    sp.setOnItemSelectedListener(new OnItemSelectedListener() {

        public void onItemSelected(AdapterView<?> parent, View view,
                int position, long id) {
            item = (String) parent.getItemAtPosition(position);

        public class AgAppMenu extends Activity { 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-09-05T20:22:07.630

您可以将它们声明为**静态变量**，然后在您的其他类中您可以像**Activity1.stringName**一样访问它们。

```
public static String stringName; 

stringName = .. // value from Spinner 
```

然后，在所有其他活动中，您可以将它们作为**`YourMainActivty.stringName`**.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-05T20:14:08.920

如果您不想使用全局变量，您总是可以在您的活动中创建一个方法来返回您的字符串。

```
public static String getMyString(){
    return item;
} 
```

然后在您当前的活动中，您可以调用：

```
String myValue = LoginScreen.getMyString(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-02-23T05:49:03.837

Try this.

Step 1: Create a static Bundle object in Application class.( ApplicationClass.java)

```
 public static Bundle mMyAppsBundle = new Bundle(): 
```

Step 2:

Set key values pair in that bundle from anywhere. like this:

```
 ApplicationClass.mMyAppsBundle.putString("key","value"); 
```

Step 3:

Now you can get these values from anywhere like this way:

```
 String str = ApplicationClass.mMyAppsBundle.getString("key"); 
```

Apply null check before using bundle objects for safety points of view.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-29T09:25:05.847

使用静态变量可能会导致意外的内存泄漏。为此，您应该使用[https://developer.android.com/reference/androidx/localbroadcastmanager/content/LocalBroadcastManager](https://developer.android.com/reference/androidx/localbroadcastmanager/content/LocalBroadcastManager)。尽管它显示已弃用，但您仍然可以使用它。

如果您遵循最新模式。您可以使用[https://developer.android.com/reference/androidx/lifecycle/LiveData](https://developer.android.com/reference/androidx/lifecycle/LiveData)来观察变量的变化。

# inheritance - 用户类型、jpa 和 Play 的继承问题！框架

> ID：12288630
> 
> 赞同：1
> 
> 时间：2012-09-05T19:43:00.053
> 
> 标签：inheritance, jpa, playframework, playframework-1.x

我正在尝试在我的应用程序中实现用户类型的继承结构。

```
@Entity
@Table(name="User_") // Need this since "User" is a reserved name in SQL Server
@Inheritance(strategy=InheritanceType.JOINED)
public class User extends Model {

    @Column(nullable=false,unique=true)
    public String username;

    ...
} 
```

* * *

```
@Entity
public class Employee extends User {
    ...
} 
```

* * *

```
@Entity
public class Client extends User {
    ...
} 
```

* * *

当我这样做时，创建的`Employee`and`Client`表没有表的任何外键，`User_`表也没有or表`User_`的任何外键。我怎样才能做到这一点？`Employee``Client`

理想情况下，我想要一个`Employee.username`作为 外键的列`User_`，因此其他表可以引用`Employee.username`.

我正在使用播放！框架 1.2.5 和 SQL Server 2005。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T19:07:44.447

Answering my own question since it's been a few days.

The first question I asked was:

> When I do this, the Employee and Client tables that get created do not have any foreign keys to the User_ table, nor does the User_ table have any foreign keys to the Employee or Client tables. How can I make this happen?

This was answered in the comments, thanks axtavt! It turns out that `id` is the Primary Key *and* the Foreign Key.

* * *

Next up, I wrote this in my question:

> Ideally, I'd like an Employee.username column that is a foreign key for User_, so I other tables can have references to Employee.username.

And clarified / worded as a question in comments:

> Any way to actually have the username as a string show up in `Employee`? I want to be able to do this on other tables:

```
@ManyToOne
@JoinColumn(name="employee", referencedColumnName="username")
public Employee employee; 
```

I was never able to find an adequate answer to this, so I'm making do with the default (using the numeric id field):

```
@ManyToOne
public Employee employee; 
```

I'll be happy to accept another answer if this can be solved.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T07:07:25.290

我想你正在寻找这个：[http ://docs.oracle.com/javaee/5/api/javax/persistence/PrimaryKeyJoinColumn.html](http://docs.oracle.com/javaee/5/api/javax/persistence/PrimaryKeyJoinColumn.html)

另外，请注意您应该实现一个鉴别器值。

[您可以在此处阅读该主题： http](http://docs.jboss.org/hibernate/annotations/3.5/reference/en/html/entity.html#d0e1168) ://docs.jboss.org/hibernate/annotations/3.5/reference/en/html/entity.html#d0e1168

# jaxb - XmlSeeAlso 和 XmlRootElement 名称？

> ID：12288631
> 
> 赞同：8
> 
> 时间：2012-09-05T19:43:00.803
> 
> 标签：jaxb

在参考 JAXB 实现中是否有让 XmlSeeAlso 使用来自 XmlRootElement 的 name= 值？

我想要的效果是让 type 属性使用 name= 值而不是 XmlSeeAlso 中的实际类名。

这可能是其他一些 JAXB 实现吗？

小例子：

```
@XmlRootElement(name="some_item")
public class SomeItem{...}

@XmlSeeAlso({SomeItem.class})
public class Resource {...}

XML:
<resource xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="some_item">
...
</resource> 
```

不费吹灰之力就可以吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-05T20:23:07.117

**关于`@XmlSeeAlso`**

注释的目的`@XmlSeeAlso`只是让您的 JAXB (JSR-222) 实现知道，当它为此处理元数据时`Resource`，它还应该处理`SomeItem`该类的元数据。有些人错误地认为它与映射继承有关，因为这是它最常使用的用例。由于无法使用 Java 反射确定类的子类，`@XmlSeeAlso`因此用于让 JAXB 实现知道还应该创建子类的映射。

* * *

以下是如何支持您的用例的示例：

**资源**

对应于 Java 类的复杂类型名称是通过`@XmlType`注解提供的。

```
package forum12288631;

import javax.xml.bind.annotation.XmlType;

@XmlType(name="some_item")
public class Resource {

} 
```

**演示**

根元素名称可以来自`@XmlRootElement`注释，也可以通过`JAXBElement`. 我们将创建一个 的实例`JAXBElement`并指示它持有 的一个实例`Object`。编组时，这将使`xsi:type`属性包含在输出中。

```
package forum12288631;

import javax.xml.bind.*;
import javax.xml.namespace.QName;

public class Demo {

    public static void main(String[] args) throws Exception {
        JAXBContext jc = JAXBContext.newInstance(Resource.class);

        Resource resource = new Resource();
        JAXBElement<Object> jaxbElement = new JAXBElement<Object>(QName.valueOf("resource"), Object.class, resource);

        Marshaller marshaller = jc.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
        marshaller.marshal(jaxbElement, System.out);
    }

} 
```

**输出**

生成的 XML 具有由 提供的根元素，`JAXBElement`并且属性的值`xsi:type`来自 上的`@XmlType`注释`Resource`。

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<resource xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="some_item"/> 
```

# php - 什么是 BLOB 文件类型？

> ID：12288636
> 
> 赞同：0
> 
> 时间：2012-09-05T19:43:29.023
> 
> 标签：php, file-upload, upload, plupload

我有允许这些文件类型的 upload.php 文件：

```
$allowedExtensions = array("mp3","mp4","jpg","jpeg","gif","png"); 
```

它可以正确执行上传，但是当上传的文件大于 5mb（块大小设置为 5mb）时，它会停止工作，除非我用 BLOB 扩展我的数组（Javascript 控制台返回此错误作为来自 upload.php 的响应 - 这就是我知道什么是问题）：

```
$allowedExtensions = array("mp3","mp4","jpg","jpeg","gif","png","blob"); 
```

谁能解释一下那个 BLOB 是什么？这是存储在服务器上的某种上传 PART/CHUNK 吗？我应该包括其他任何惊喜`allowedExtensions`吗？

我的upload.php 来自Plupload.com：https://github.com/downloads/moxiecode/plupload/plupload_1_5_4.zip [（](https://github.com/downloads/moxiecode/plupload/plupload_1_5_4.zip)解压缩，转到/examples/ 并打开upload.php）。我只是通过添加这个来扩展它：

```
foreach($_FILES as $file){
    if($file['tmp_name'] > ''){
        if(!in_array(end(explode(".", strtolower($file['name']))), $allowedExtensions)){
            die($file['name'].' is not an allowed file type!');
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T19:47:11.323

BLOB = 二进制大对象。它是一种用于存储二进制数据的数据库字段类型。

如果不发动战争，恕我直言，图片不属于数据库。将它们存储在磁盘上，并在数据库表中保留对它们的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T20:24:17.023

```
foreach($_FILES as $file){
    if(isset($file['tmp_name']) &&  $file['tmp_name'] != ''){ <--- HERE IS THE CHANGE
        if(!in_array(end(explode(".", strtolower($file['name']))), $allowedExtensions)){
            die($file['name'].' is not an allowed file type!');
        }
    }
} 
```

我修改了您的循环以帮助避免警告。

# java - 无法初始化 GregorianCalendar 对象

> ID：12288638
> 
> 赞同：0
> 
> 时间：2012-09-05T19:43:40.863
> 
> 标签：java, date, calendar

我是 Java 的完全初学者，我一直在制作简单的测试程序来复习我读过的一些材料。以下代码块工作不正确。它应该接受来自用户的年、月和日期，然后创建一个用年、月和日期初始化的 GregorianCalendar 对象。但是，当我尝试返回 GregorianCalendar 变量的月份时，它总是返回我初始化月份变量的月份。我不确定为什么。

```
import java.util.*;
public class Prac {
    public static void main(String[] args){
    Scanner input = new Scanner(System.in);
    System.out.print("Enter Year: ");
    int YEAR = input.nextInt();
    System.out.print("Enter Month: ");
    String MONTH_STRING = input.next();
    System.out.print("Enter Date: ");
    int DATE = input.nextInt();
    int MONTH = 10;
    String mon = MONTH_STRING.toLowerCase();

    if (mon == "january") {
        MONTH = 0;
    } else if (mon == "february") {
        MONTH = 1;
    } else if (mon == "march") {
        MONTH = 2;
    } else if (mon == "april") {
        MONTH =3;
    } else if (mon == "may"){
        MONTH =4;
    } else if (mon == "june"){
        MONTH =5;
    } else if (mon == "july"){
        MONTH =6;
    } else if (mon == "august"){
        MONTH=7;
    } else if (mon == "september"){
        MONTH=8;
    } else if (mon == "october"){
        MONTH=9;
    } else if (mon == "november"){
        MONTH=10;
    } else if (mon == "december"){
        MONTH =11;
    }

    GregorianCalendar entDate = new GregorianCalendar(YEAR,MONTH,DATE);
    System.out.println(entDate.get(Calendar.MONTH));
    }
} 
```

另外，我知道我本可以使用 switch 块，但它以某种方式给了我奇怪的错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T19:48:51.750

# `String.equals`

您正在错误地比较字符串。

`==`操作员检查对象是否相同——意味着相同的内存位置和所有内容。

你要做的是[`String::equals`](https://docs.oracle.com/javase/9/docs/api/java/lang/String.html#equals-java.lang.Object-)方法。

```
if(mon.equals("january") {
    ...
} else if(mon.equals("feburary") {
    ...
} ... 
```

这将仅检查字符串的值是否相等。

此外，除非您使用的是 java 1.7+，否则您将无法为字符串使用 switch case。不是问题的一部分，但仍然很高兴知道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-06T04:00:33.667

# python - pypy memory usage grows forever?

> ID：12288640
> 
> 赞同：13
> 
> 时间：2012-09-05T19:43:51.770
> 
> 标签：python, memory, memory-leaks, pypy

I have a complicated python server app, that runs constantly all the time. Below is a very simplified version of it.

When I run the below app using python; "python Main.py". It uses 8mb of ram straight away, and stays at 8mb of ram, as it should.

When I run it using pypy "pypy Main.py". It begins by using 22mb of ram and over time the ram usage grows. After a 30 seconds its at 50mb, after an hour its at 60mb.

If I change the "b.something()" to be "pass" it doesn't gobble up memory like that.

I'm using pypy 1.9 on OSX 10.7.4 I'm okay with pypy using more ram than python.

**Is there a way to stop pypy from eating up memory over long periods of time?**

```
import sys
import time
import traceback

class Box(object):
    def __init__(self):
        self.counter = 0
    def something(self):
        self.counter += 1
        if self.counter > 100:
            self.counter = 0

try:
    print 'starting...'
    boxes = []      
    for i in range(10000):
        boxes.append(Box())
    print 'running!'
    while True:
        for b in boxes:
            b.something()
        time.sleep(0.02)

except KeyboardInterrupt:
    print ''
    print '####################################'
    print 'KeyboardInterrupt Exception'
    sys.exit(1)

except Exception as e:
    print ''
    print '####################################'
    print 'Main Level Exception: %s' % e
    print traceback.format_exc()
    sys.exit(1) 
```

Below is a list of times and the ram usage at that time (I left it running over night).

```
Wed Sep  5 22:57:54 2012, 22mb ram 
Wed Sep  5 22:57:54 2012, 23mb ram 
Wed Sep  5 22:57:56 2012, 24mb ram 
Wed Sep  5 22:57:56 2012, 25mb ram 
Wed Sep  5 22:57:58 2012, 26mb ram 
Wed Sep  5 22:57:58 2012, 27mb ram 
Wed Sep  5 22:57:59 2012, 29mb ram 
Wed Sep  5 22:57:59 2012, 30mb ram 
Wed Sep  5 22:58:00 2012, 31mb ram 
Wed Sep  5 22:58:02 2012, 32mb ram 
Wed Sep  5 22:58:03 2012, 33mb ram 
Wed Sep  5 22:58:05 2012, 34mb ram 
Wed Sep  5 22:58:08 2012, 35mb ram 
Wed Sep  5 22:58:10 2012, 36mb ram 
Wed Sep  5 22:58:12 2012, 38mb ram 
Wed Sep  5 22:58:13 2012, 39mb ram 
Wed Sep  5 22:58:16 2012, 40mb ram 
Wed Sep  5 22:58:19 2012, 41mb ram 
Wed Sep  5 22:58:21 2012, 42mb ram 
Wed Sep  5 22:58:23 2012, 43mb ram 
Wed Sep  5 22:58:26 2012, 44mb ram 
Wed Sep  5 22:58:28 2012, 45mb ram 
Wed Sep  5 22:58:31 2012, 46mb ram 
Wed Sep  5 22:58:33 2012, 47mb ram 
Wed Sep  5 22:58:35 2012, 49mb ram 
Wed Sep  5 22:58:35 2012, 50mb ram 
Wed Sep  5 22:58:36 2012, 51mb ram 
Wed Sep  5 22:58:36 2012, 52mb ram 
Wed Sep  5 22:58:37 2012, 54mb ram 
Wed Sep  5 22:59:41 2012, 55mb ram 
Wed Sep  5 22:59:45 2012, 56mb ram 
Wed Sep  5 22:59:45 2012, 57mb ram 
Wed Sep  5 23:00:58 2012, 58mb ram 
Wed Sep  5 23:02:20 2012, 59mb ram 
Wed Sep  5 23:02:20 2012, 60mb ram 
Wed Sep  5 23:02:27 2012, 61mb ram 
Thu Sep  6 00:18:00 2012, 62mb ram 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-01T08:54:55.633

[http://doc.pypy.org/en/latest/gc_info.html#minimark-environment-variables](http://doc.pypy.org/en/latest/gc_info.html#minimark-environment-variables) shows how to tweak the gc

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-15T16:58:44.400

Compared to cpython, pypy uses [different garbage collection strategies](http://pypy.readthedocs.org/en/latest/cpython_differences.html#differences-related-to-garbage-collection-strategies). If the increase in memory is due to something in your program, you could try to run a forced garbage collection every now and then, by using the [`collect`](http://docs.python.org/library/gc.html?highlight=gc#gc.collect) function from the `gc` module. In this case, it might also help to explicitly `del` large objects that you don't need anymore and that don't go out of scope.

If it is due to the internal workings of pypy, it might be worth it submitting a bug report, as Mark Dickinson suggested.

# android - Android 在屏幕上画一条线并在单击屏幕上的按钮后将其删除

> ID：12288644
> 
> 赞同：0
> 
> 时间：2012-09-05T19:44:11.547
> 
> 标签：android, android-layout

我是我的应用程序中的 android 开发新手，我想在手指移动时画线，并想通过单击屏幕上提供的按钮来删除我画的所有线。我可以画线，但我无法删除线，而且线也不平滑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T20:35:19.423

创建一个类来表示您的线条，例如：

```
public class Line{
    public float startX;
    public float startY;
    public float endX;
    public float endY;
    public int colour;
    private Paint paint;
    ...
    ...

    public Line(float startX, float startY, float endX, float endY, int colour){
        this.startX = startX;
        this.startY = startY;
        this.endX = endX;
        this.endY = endY;
        this.paint = new Paint();
        this.paint.setColor(colour);
        // look at the antialias and dither options for paint to create a smooth line
        ...
        ...
    }

    public draw(Canvas canvas){
       canvas.drawLine(this.startX, this.startY, this.endX, this.endY, paint);
    }

} 
```

然后在您的活动中，创建一个 Line 对象列表，例如 ArrayList 行；

在您的触摸事件中，不要画一条线，而是在列表中添加一条新线。然后，在您的 onDraw 方法中，如下所示：

```
 for(Line line:lines){
     line.draw(canvas);
 } 
```

最后，在您的按钮单击中，从您的线条列表中删除线条对象。

祝你好运！

# java - 如果子对象是嵌入的，则只能引用子对象的属性

> ID：12288646
> 
> 赞同：1
> 
> 时间：2012-09-05T19:44:22.720
> 
> 标签：java, google-app-engine, jpa, google-cloud-datastore, datanucleus

我想通过 Google AppEngine 上的 datanucleus 的父键检索数据。我使用 JPA。

这是我的 Stock bean（父级）：

```
@Entity
public class Stock implements Serializable {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Key key;

    @OneToMany(fetch=FetchType.LAZY, mappedBy="stock")
    private List<StockValue> stockValues;
} 
```

这是我的 StockValue bean（孩子们）：

```
@Entity
public class StockValue implements Serializable {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Key key;

    @ManyToOne
    private Stock stock;
} 
```

我试着做这样的请求（查询是数据核查询）：

```
DatastoreService datastoreService = DatastoreServiceFactory.getDatastoreService();
Query queryStock = new Query("Stock");
queryStock.addFilter("name", FilterOperator.EQUAL, "toto");

PreparedQuery prepare = datastoreService.prepare(queryStock);
Entity asSingleEntity = prepare.asSingleEntity();

Query query = Query("StockValue", asSingleEntity.getKey());
prepare = datastoreService.prepare(query);

List<Entity> asList = prepare.asList(FetchOptions.Builder.withLimit(10)); 
```

一切都很好。但是我得到了实体，我更喜欢使用我的 bean。所以我尝试这样做（查询是 javax 查询）：

```
Query createQuery = entityManager.createQuery("SELECT p FROM Stock p WHERE p.name = \"toto\"");
Object singleResult = createQuery.getSingleResult();
Stock stockEntity = (Stock)singleResult;

createQuery = entityManager.createQuery("SELECT p FROM StockValue p WHERE p.key IS NOT null AND p.key.parentKey = :parentKey ");
createQuery.setParameter(":parentKey", stockEntity.getKey());
Object singleResult2 = createQuery.getSingleResult(); 
```

这是我的问题，我收到此错误：

```
org.datanucleus.store.appengine.FatalNucleusUserException: SELECT FROM StockValue p WHERE p.key IS NOT null AND p.key.parentKey = :parentKey: Can only reference properties of a sub-object if the sub-object is embedded. 
```

我不明白这一点。我的豆子之间的关系似乎很好，因为如果我这样做：

```
stockEntity.getStockValues(); 
```

我正确地得到了 stockValues 。为什么我的请求失败？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T20:00:35.380

简而言之：在 GAE 中，您只能在一种实体类型中进行查询，或者用 JPA/JDO 的说法，在一个类中进行查询。由于`StockValue`和`Stock`是两个独立的类，因此是两个独立的实体类型，因此您无法跨它们进行查询。

正如错误所暗示的那样：您可以查询是否通过 @Embedded 注释[将一个类嵌入到另一个类中。](http://bpossolo.blogspot.com/2012/01/jpa-embedded-classes-on-app-engine.html)在这种情况下，您将有两个类，但数据存储区中只有一种实体类型。

另外：[`key.parentKey`](https://developers.google.com/appengine/docs/java/javadoc/com/google/appengine/api/datastore/Key#getParent%28%29)与实体关系无关。“Parent”是 GAE Datastore 中用于定义[实体组](https://developers.google.com/appengine/docs/java/datastore/transactions#Entity_Groups)的概念，实体组用于定义事务的范围。

# android - 你必须在 Activity 类中有文件 I/O 吗？

> ID：12288648
> 
> 赞同：0
> 
> 时间：2012-09-05T19:44:22.563
> 
> 标签：android

我的 Activity 类中有用于加载和保存文件的代码。它工作正常。该代码保存了 cFavretClass 的内容。我正在尝试清理代码，所以我将文件 i/o 移动到 cFavret 类中。

我无法编译代码。现在我收到一条错误消息`openFileOutput is undefined in type cFavrets`。

我假设这个方法是在谷歌活动类中声明的？这是否意味着所有文件 I/O 都必须在活动类中？

```
boolean Save()
{
  String FILENAME = "hello_file";

  try {
    FileOutputStream fos = openFileOutput(FILENAME, Context.MODE_PRIVATE );
    fos.write(buffer);
    fos.close();
  }
  // just catch all exceptions and return false
  catch (Throwable t) {
    return false;
  }       
  return true;
}  

boolean Load()
{
  String FILENAME = "hello_file";
  try {
    FileInputStream fos = openFileInput(FILENAME);   
    buffer[0]=0;
    fos.read(buffer);
    fos.close();
  }
  // just catch all exceptions and return false
  catch (Throwable t) {
  // maybe file does not exist, try creating it
    return false;
  }
  return true;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T20:01:23.850

> 这是否意味着所有文件 I/O 都必须在活动类中？

不，但是有问题的方法是从上下文中调用的 - 只需将上下文传递给 this 的构造函数`cFavretClass`（或方法本身，如果您愿意）：

```
Context mContext;
public cFavretClass(Context context) {
  mContext = context;
}

...
  // in your methods:
  mContext.openFileOutput(FILENAME); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T20:05:00.480

正如 JRaymond 所解释的，它是`openFileOutput`一种衍生方法。此方法的特殊之处在于它允许您创建对您的应用程序**私有**的文件。`Context``Activity`

 **您也可以使用普通的 Java I/O 类来写入外部存储（SD 卡），但每个人都可以读取这些文件。**

# hibernate - 从 grails 域的属性中获取数据库列名

> ID：12288650
> 
> 赞同：4
> 
> 时间：2012-09-05T19:44:30.757
> 
> 标签：hibernate, grails

我正在用我的域对象映射一堆旧表。有没有办法在域类中找到属性的数据库列名（反之亦然）？例如：

```
class Person {

String firstName
.
.
.
} 
```

有没有办法使用 firstName 来取回字符串“FIRST_NAME”或“first_name”？我试过用

```
GrailsDomainBinder.getMapping(Person).columns 
```

但这只是出于某种原因给了我 id 列。谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-05T21:05:08.080

我只是把这段代码扔在一起，所以请不要在风格上打败我。:-)

尝试将其放入您的测试操作方法中`PersonController`并添加我的导入语句，`sessionFactory`如下所示：

```
import org.hibernate.persister.entity.AbstractEntityPersister
import org.codehaus.groovy.grails.commons.DefaultGrailsDomainClass

class PersonController {

    // This should get injected by Grails automatically
    def sessionFactory

    ....
    def myTestAction() {
        def domainClazz = grailsApplication.getClassForName("com.test.Person")

        def clazzMetadata = sessionFactory.getClassMetadata(domainClazz)
        def AbstractEntityPersister abstractEntityPersister = (AbstractEntityPersister) clazzMetadata
        def grailsDomainClazz = new DefaultGrailsDomainClass(domainClazz)

        def grailsDomainClazzProperties = grailsDomainClazz.getProperties()

        grailsDomainClazzProperties.each() {
            println "Property Name: ${it.name}"
            abstractEntityPersister.getPropertyColumnNames(it.name).each() {
                println "DB Column: ${it}"
            }
        }
     }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-05T21:08:14.977

好的，我想这就是你要找的。给定以下域

```
class Company {    
  String name
  String logoUrl

  static mapping = {
    table 'people'
    name column: 'my_name'
    logoUrl column:  'lo_go_url'
  }
} 
```

您可以使用以下命令检索域数据：

```
def result = GrailsDomainBinder.getMapping(Company).columns
println result['logoUrl'].column //prints 'lo_go_url' 
```

您还可以使用以下闭包打印出所有列名：

```
result.each{ key, val -> // The key is the attribute name in the class (i.e. name, logoUrl)
  PropertyConfig prop = val // This is not needed, but I wanted to show the type being used. You could just call val.column below.
  println prop.column // This would print out 'my_name', 'lo_go_url'
} 
```

希望这可以帮助！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-05-13T13:25:49.723

我能够以一种有点骇人听闻的方式得到它：

```
 def dbColumnNames = sessionFactory.getClassMetadata(clazz).propertyMapping.getColumnNames(fieldName) 
```

这将返回一个字符串数组，其中第一个元素应该是字段的 DB 列名。

适用于 Grails 2.3.6

# php - PHP会话打开（/tmp/sess_）权限被拒绝

> ID：12288658
> 
> 赞同：0
> 
> 时间：2012-09-05T19:45:01.020
> 
> 标签：php, session

当我从 http 链接转到 https 时，我收到此错误，反之亦然。例如，我的测试站点[http://dev.24houranswers.com/](http://dev.24houranswers.com/)看起来不错。当您导航到登录 [https://dev.24houranswers.com/login.php](https://dev.24houranswers.com/login.php) .. 我收到错误“open(/tmp/sess_6205f1dae5098a7b29ef63f2fa4a0a34, O_RDWR) failed: Permission denied”

..有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T19:54:26.573

错误消息说明了一切：“权限被拒绝”

您无权写入该位置。任何一个：

*   修复 /tmp 的权限，以便网络服务器进程可以在那里写入
*   选择网络服务器进程可以写入的不同位置，使用`session_save_path ( 'mypath' )`
*   安装[自定义会话处理程序](http://php.net/manual/en/session.customhandler.php)并将会话写入文件、数据库、内存缓存等。

# c++ - CORBA C++/Java 应用程序中服务器端的分段错误（核心转储）

> ID：12288660
> 
> 赞同：1
> 
> 时间：2012-09-05T19:45:06.247
> 
> 标签：c++, segmentation-fault, corba, omniorb

我有这样的代码：

```
interface Employee
{
    string getLastname();
};

#include "Employee.idl"

interface Work
{
    Employee getEmployee(in short id);
}; 
```

**服务器文件：**

```
#include "Employee.hh"

class EmployeeImpl : public POA_Employee
{
    private:
        char* lastname;
        int id;

    public:
        EmployeeImpl(const char* lastname, int id);
        char* getLastname();
};

#include "EmployeeImpl.h"

EmployeeImpl::EmployeeImpl(const char* lastname, int id)
{
    this->lastname = const_cast<char*>(lastname);
    this->id = id;
}

char* EmployeeImpl::getLastname()
{
    return this->lastname;
}

#include "Work.hh"
#include <vector>
#include "EmployeeImpl.h"
using namespace std;

class WorkImpl : public POA_Work
{
    private:
        vector<EmployeeImpl> employees;

    public:
        WorkImpl();
        Employee_ptr getEmployee(::CORBA::Short id);
};

#include "WorkImpl.h"

 WorkImpl::WorkImpl()
 {
    EmployeeImpl ei1("Doe", 1);
    EmployeeImpl ei2("Smith", 2);
    EmployeeImpl ei3("Brown", 3);

    employees.push_back(ei1);
    employees.push_back(ei2);
    employees.push_back(ei3);
 }

Employee_ptr WorkImpl::getEmployee(::CORBA::Short id)
{
    return employees[id]._this();
} 
```

**客户端文件：**

```
import java.util.*;
import org.omg.CosNaming.*;
import org.omg.CosNaming.NamingContextPackage.*;
import org.omg.CORBA.*;
import java.io.*;

public class Client
{
    public static void main(String [] args)
    {
     try
     {
        org.omg.CORBA.ORB clientORB = org.omg.CORBA.ORB.init(args, null);

        if (clientORB == null)
        {
            System.out.println("Problem while creating ORB");
            System.exit(1);
        }

        org.omg.CORBA.Object objRef = clientORB.resolve_initial_references("NameService");
        NamingContextExt ncRef = NamingContextExtHelper.narrow(objRef);

        Work work = WorkHelper.narrow(ncRef.resolve_str("WorkService"));
        Employee e = work.getEmployee((short)1);
        System.out.println(e.getLastname());
            e = work.getEmployee((short)2);
            System.out.println(e.getLastname());
            e = work.getEmployee((short)3);
            System.out.println(e.getLastname());

        }catch(Exception e){ System.out.println(e.getMessage()); }
    }
} 
```

当我在客户端运行服务器，然后是客户端时，我看到：

> 史密斯

代替：

> ```
> Doe
> Smith
> Brown 
> ```

当客户端收到消息时，在服务器端我看到：

> 分段错误（应付转储）

和服务器崩溃。我的代码有什么问题？我在 Kubuntu 上使用 omniORB 和 idlj，并使用 g++ 和 javac 来编译我的文件。

**这是我的整个项目：** [http ://www44.zippyshare.com/v/60244821/file.html](http://www44.zippyshare.com/v/60244821/file.html)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T20:19:10.910

您没有遵循关于参数传递的 IDL 到 C++ 映射规则。特别是在服务器上：

```
char* EmployeeImpl::getLastname()
{
    return this->lastname;   // this is the problem
} 
```

您需要返回动态分配的内存，因为骨架代码将`CORBA::string_free`在通过线路将其编组到客户端后将其释放（使用 ）。

这应该是：

```
char* EmployeeImpl::getLastname()
{
    return CORBA::string_dup(this->lastname);
} 
```

这一切都在 Henning & Vinowski 的书*Advanced CORBA Programming with C++*中进行了解释。

您遇到的另一个问题是您正在使用基于 1 的索引对向量进行索引。但是 vector 使用基于 0 的索引方案。要解决此问题，请更改您的客户端调用，或将您的服务器实现更改为以下内容：

```
Employee_ptr WorkImpl::getEmployee(::CORBA::Short id)
{
    if (id >= 1 && id <= employees.size())
    { 
       return employees[id - 1]._this();  // convert to 0-based indexing
    }
    else
    {
       // throw some type of exception
    }
} 
```

# svg - 表示节点的 Svg 图像，在力导向图中改变节点大小

> ID：12288661
> 
> 赞同：4
> 
> 时间：2012-09-05T19:45:16.753
> 
> 标签：svg, graph, d3.js, force-layout

到目前为止，我已经在一个力导向图中使用了 d3.svg.symbol() 来区分不同的节点类型。

我现在想通过将节点显示为 svg 图像来区分不同的节点类型。按照其中一个[示例](http://bl.ocks.org/950642)，我使用以下代码显示节点图像：

```
 var node = svg.selectAll("image.node").data(json.nodes);
    var nodeEnter = node.enter().append("svg:g").append("svg:image")
    .attr("class", "node")
    .attr("xlink:href", function(d)
    {
      switch( d.source )
      {
        case "GEXP": return "img/node_gexp.svg";
        case "CNVR": return "img/node_cnvr.svg";
        case "METH": return "img/node_meth.svg";
        case "CLIN": return "img/node_clin.svg";
        case "GNAB": return "img/node_gnab.svg";
        case "MIRN": return "img/node_mirn.svg";
        case "SAMP": return "img/node_samp.svg";
        case "RPPA": return "img/node_rppa.svg";
      }
    })
    .attr("x", function(d) { return d.px; } )
    .attr("y", function(d) { return d.py; } )
    .attr("width", "50")
    .attr("height", "50")
    .attr("transform", "translate(-25,-25)")
    .on("click", function(d) { 
      console.log("nodeclick");
      } )
    .on("mouseover", fade(0.10) )
    .on("mouseout", fade(default_opacity) )
    .call(force.drag); 
```

这确实显示了 svg 图像，但我有两个问题：

1）我想根据属性缩放节点大小。据我了解，这可以通过提供“规模”属性来完成

```
transform="scale(something)" 
```

到合适的地方，比如图片标签本身或包含图片的组：

```
 var node = svg.selectAll("image.node").data(json.nodes);
    var nodeEnter = node.enter()
    .append("svg:g")
    .attr("transform", function(d) 
    {
      var str = "scale(";
        if( d.gene_interesting_score && d.gene_interesting_score > 0 )
        {
          return str + ( (d.gene_interesting_score - minScore ) / ( maxScore - minScore ) ) + ")";
        }
        return str + 0.7 + ")";
    })
    .append("svg:image")
    .... 
```

碰巧的是， scale() 变换置换了图像：它们不再位于边缘的端点上。在初始化图形时如何正确调整图像大小，最好使控制机制在单个函数中（例如，这样我就不必分别控制 x、y、width、height）？

2) 当图表被缩放时，Chrome 会模糊图像，而在 Firefox 中图像仍然清晰（图片）。如何避免这种模糊？

![上面是铬，下面是 FF](../Images/75192ba0612e62e2ec09c2adeb904b2c.png)

**编辑：**根据 duopixel 的建议，现在的代码是：

```
 var nodeGroup = svg.selectAll("image.node").data(json.nodes).enter()
    .append("svg:g")
    .attr("id", function(d) { return d.id; }) 
    .attr("class", "nodeGroup")
    .call(force.drag);

    var node = nodeGroup.append("svg:image")
    .attr("viewBox", "0 0 " + nodeImageW + " " + nodeImageH)
    .attr("class", "node")
    .attr("xlink:href", function(d)
    {
      switch( d.source )
      {
        case "GEXP": return "img/node_gexp.svg";
        case "CNVR": return "img/node_cnvr.svg";
        case "METH": return "img/node_meth.svg";
        case "CLIN": return "img/node_clin.svg";
        case "GNAB": return "img/node_gnab.svg";
        case "MIRN": return "img/node_mirn.svg";
        case "SAMP": return "img/node_samp.svg";
        case "RPPA": return "img/node_rppa.svg";
      }
    })
    .attr("width", nodeImageW)
    .attr("height", nodeImageH)
    .attr("transform", function(d) 
    {
      var matrix = "matrix(";
      var scale = 0.7; // sx & sy
      if( d.gene_interesting_score && d.gene_interesting_score > 0 )
      {
        scale = ( (d.gene_interesting_score - minScore ) / ( maxScore - minScore ) ) * 0.5 + 0.25; 
      }
      //console.log("id=" + d.id + ", score=" + scale );
      matrix += scale + ",0,0," + scale + "," + ( d.x - ( scale*nodeImageW/2 ) ) + "," + ( d.y - ( scale*nodeImageH/2 ) ) + ")";
      return matrix;
    })
    // .attr("transform", "translate(-25,-25)")
    .on("click", function(d) { 
      console.log("nodeclick");
      } )
    .on("mouseover", fade(0.10) )
    .on("mouseout", fade(node_def_opacity) ); 
```

它解决了问题 #1，但不是第二个问题：通过选择

```
var nodeImageH = 300;
var nodeImageW = 300; 
```

生成的 svg 图像包含很多空白空间（通过使用 firebug 的选择工具选择图像可以看到）。这些图像是在 Inkscape 中创建的，画布尺寸裁剪为 50x50，这应该是正确的查看像素尺寸。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T22:35:11.503

`#1`您需要设置变换原点。在 SVG 中，这意味着您将不得不使用此处回答的变换矩阵：[https ://stackoverflow.com/a/6714140/524555](https://stackoverflow.com/a/6714140/524555)

`#2`要解决模糊缩放问题，请修改`viewBox, width, height`文件`svg`以从大图像开始（即`<svg viewBox="0 0 300 300" width="300" height="300">`.

# c++ - 如何编写一个快速函数来计算一个数字的总除数？

> ID：12288671
> 
> 赞同：4
> 
> 时间：2012-09-05T19:45:42.970
> 
> 标签：c++, algorithm, numbers, primes

我必须找到给定数字 N 的除数总数，其中可以大到 10^14。我尝试计算素数到 10^7，然后使用素数因子的指数找到除数。但是结果太慢了，因为使用筛子找到素数需要 0.03 秒。如何在不计算素数的情况下更快地计算除数的总数？请伪代码/很好解释的算法将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T20:12:16.037

使用阿特金筛法找出所有小于 10^7 的素数。（其中有 664,579 个）

[http://en.wikipedia.org/wiki/Sieve_of_Atkin](http://en.wikipedia.org/wiki/Sieve_of_Atkin)

理想情况下，这应该在编译时完成。

接下来计算素数分解：

```
int x; // the number you want to factor
Map<int to int> primeFactor; // this is a map that will map each prime that appears in the prime factorization to the number of times it appears.

while(x > 1) {
  for each prime p <= x {
     if x % p == 0 {
       x = x / p; 
       primeFactor(p) = primeFactor(p) +1;
     }
  }
} 
```

最后，您将获得完整的素数分解。由此，您可以通过迭代地图的值来计算除数的总数： [https ://math.stackexchange.com/questions/66054/number-of-combinations-of-a-multiset-of-objects](https://math.stackexchange.com/questions/66054/number-of-combinations-of-a-multiset-of-objects)

```
int result = 1;
for each value v in primeFactors {
  result*= (v+1);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T21:03:12.087

我在[博客](http://programmingpraxis.com/2010/02/19/sieve-of-atkin-improved/)中实现了阿特金筛，但仍然发现优化的埃拉托色尼筛更快。

但我怀疑这是你的问题。对于大至 10^14 的数字，无论您如何生成素数，Pollard rho 分解都将击败素数的试除法。我在我的[博客](http://programmingpraxis.com/2011/01/21/pollard-rho-revisited/)上也是这样做的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T06:51:28.827

您可以使用[Pollard 的 rho 算法](https://en.wikipedia.org/wiki/Pollard%27s_rho_algorithm)进行因式分解。有了所有的[改进](https://en.wikipedia.org/wiki/Pollard%27s_rho_algorithm#Variants)，至少 10^20 的数字很快。

这是我在 Java 中查找因子的实现：

```
/**
 * Finds a factor of a number using Brent's algorithm.
 *
 * @param n  The number.
 *
 * @return  A factor of n.
 */
public static BigInteger findFactor(BigInteger n)
{
    final BigInteger result;
    if (n.isProbablePrime(80))
    {
        result = n;
    }
    else
    {
        BigInteger gcd = n;
        BigInteger c = ONE;
        while (gcd.equals(n))
        {
            int limitPower = 0;

            long k = 0;
            BigInteger y = ONE;
            boolean done = false;
            while (!done)
            {
                limitPower++;
                final long limit = Numbers.pow(2, limitPower);
                final int productLimit = (int) Numbers.pow(2, limitPower / 2);

                final BigInteger x = y;
                while (!done && k < limit)
                {
                    final BigInteger savedY = y;
                    int j = 0;
                    final int jLimit = (int) Math.min(productLimit, limit - k);
                    BigInteger p = ONE;
                    while (j < jLimit)
                    {
                        y = next(n, c, y);
                        p = p.multiply(x.subtract(y)).mod(n);
                        j++;
                    }
                    gcd = Numbers.gcd(p, n);

                    if (gcd.equals(ONE))
                    {
                        // Move along, nothing to be seen here
                        k += jLimit;
                    }
                    else
                    {
                        // Restart and find the factor
                        y = savedY;
                        while (!done)
                        {
                            k++;
                            y = next(n, c, y);
                            gcd = Numbers.gcd(x.subtract(y), n);
                            done = !gcd.equals(ONE);
                        }
                    }
                }
            }
            c = c.add(ONE);
        }
        result = gcd;
    }
    return result;
}

private static BigInteger next(BigInteger m, BigInteger c, BigInteger x)
{
    return square(x).subtract(c).mod(m);
} 
```

要分解最多 10 ^(14的数字，您也可以对最多 10) ⁷的奇数进行试除法。

# asp.net - ASP.NET 站点的 Bin 文件夹中的访问被拒绝

> ID：12288674
> 
> 赞同：0
> 
> 时间：2012-09-05T19:45:50.957
> 
> 标签：asp.net, iis, webforms, windows-server-2003

使用 Visual Studio 2008，我已将我的 ASP.NET 网站发布到我的本地磁盘，以准备部署到我们的测试服务器。使用 RDP 会话，我已连接到运行 Windows Server 2003 的测试服务器，使我的本地磁盘可用作 RDP 会话的资源。当我尝试将文件从本地磁盘复制到服务器时，除了bin 文件夹中的 DLL*之外*，所有内容都可以毫无问题地复制。每次我尝试复制 DLL 时都会收到以下错误：“无法复制 [文件名]：访问被拒绝。确保磁盘未满或未受写保护，并且文件当前未在使用中。” 我可以复制 bin 文件夹之外的任何文件以及 bin 文件夹中除 DLL 之外的任何文件（例如 .compiled 文件）。

自从我使用 IIS 和 ASP.NET 以来已经有一段时间了，所以我承认有点生疏，但我已经尝试了我所知道的一切来解决这个问题。我检查了很明显，磁盘上有 3+ GB 可用空间，并且文件没有写保护。

我还尝试了我能想到的一切以确保文件未被使用。我尝试回收应用程序池，重新启动默认网站，使用 GUI 重新启动 IIS 和停止/启动 IIS，在任务管理器中结束 w3wp.exe 进程，Shift-删除文件，从命令提示符删除，还有另外两个用户尝试使用他们的登录凭据删除文件，并重新启动服务器两次。到目前为止，什么都没有奏效，我无计可施。

希望有人对我可以尝试解决的其他问题有任何建议，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T19:54:13.680

尝试从命令提示符停止 IIS，然后重新启动并在重新启动后确认 IIS 仍然停止。

确认上述内容后，压缩文件，将压缩文件复制到您的服务器并解压缩。在文件上运行 AV，您可能需要“解锁”压缩包。

# php - 在 PHP 中删除符号链接

> ID：12288676
> 
> 赞同：5
> 
> 时间：2012-09-05T19:46:04.607
> 
> 标签：php

删除符号链接并保留它们链接的内容的正确方法是什么？删除它们链接的内容的正确方法是什么？哪个会[取消链接](http://php.net/manual/en/function.unlink.php)？似乎有些[模棱两可](https://bugs.php.net/bug.php?id=52176)。

通过一些测试，符号链接根据它们指向的内容响应[is_file](http://php.net/manual/en/function.is-file.php)和[is_dir](http://php.net/manual/en/function.is-dir.php)`true` ，并返回到[is_link](http://php.net/manual/en/function.is-link.php)。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-05T19:52:43.430

`unlink()`是正确的方法

我的一个项目的代码片段，只有在它是符号链接时才删除

```
if(file_exists($linkfile)) {
    if(is_link($linkfile)) {
        unlink($linkfile);
    } else {
        exit("$linkfile exists but not symbolic link\n");
    }
} 
```

readlink()，返回一个链接的目标，你可以运行 unlink

```
if(is_link($linkfile)) {
      $target = readlink($linkfile)
      unlink($target)
} 
```

# javascript - Ajax 和 MySql 的插入、检查和检索

> ID：12288678
> 
> 赞同：2
> 
> 时间：2012-09-05T19:46:19.507
> 
> 标签：javascript, php, jquery, mysql, ajax

我有两个数据库表，guestlist 和出席

在一个 HTML 页面上，我有一个 window.onload 脚本，我想通过 AJAX 检查来宾列表。如果 url 查询中的 firstname AND lastname 出现在 guestlist 表中，则加载该页面。如果没有，请加载错误消息。

正确加载页面后，名字和姓氏会预先填充在两个输入字段中。用户完成表单的其余部分并单击提交，将他们的名字和姓氏插入到出勤表中。

如果名字和姓氏已经出现在出勤表中，则加载错误消息。如果名字和姓氏没有出现在出勤表中，则将表单信息提交到出勤表。

谈到阿贾克斯，我不是最耀眼的灯泡。这是我目前拥有的代码：

HTML

```
<body>
<div id="formDiv">
<form id="partyForm" name="party" action="party_insert" method="post">
<h1>Welcome to The Party</h1>
    <input name="first_name" id="firstname" class="input" type="text" maxlength="99" placeholder="First Name"><br/>
    <input name="last_name" id="lastname" class="input" type="text" maxlength="99" placeholder="Last Name"><br/>
    <input name="costume" id="costume" class="input" type="text" maxlength="999" placeholder="What are you supposed to be?"><br/>
    <div id="buttonDiv">
        <a class="button" id="submit" style="cursor:pointer;">SUBMIT</a>
    </div>
</form>
</div>

<script>
window.onload = function () {
    var fname_init = decodeURIComponent(getUrlVars()["fname"]);
    var lname_init = decodeURIComponent(getUrlVars()["lname"]);

    if(fname_init !== "undefined" && lname_init !== "undefined"){
        var newString = 'fname='+encodeURIComponent(fname_init)+'&lname='+encodeURIComponent(lname_init);
        $.ajax({
            type: "GET",
            url: "guestList.php",
            data: newString,
            success: function(){
                alert("ON THE LIST");
                $('#firstname').val(fname_init);
                $('#lastname').val(lname_init);
            },
            error: function(){
                alert("NOT ON THE LIST");
                window.location = 'error1.html?fname='+encodeURIComponent(fname_init)+'lname='+encodeURIComponent(lname_init);
            }
        })
    }
}

$("#submit").click(function() {
    validate();
});

function submit(){
    var fname = $("#firstname").val();
    var lname = $("#lastname").val();
    var cost = $("#costume").val();
    var dataString = 'fname='+encodeURIComponent(fname)+'&lname='+encodeURIComponent(lname)+'&cost='+encodeURIComponent(cost);
    $.ajax({  
        type: "POST",  
        url: "partyEntry.php",  
        data: dataString,  
        success: function() {  
            alert("ENJOY THE PARTY");
            clearForms();
        }
    });
}

function validate(){
    if ($("#firstname").val() == ""){
        alert("Please Enter your First Name");
    } else {
        if ($("#lastname").val() == ""){
            alert("Please Enter your Last Name");
        }else{
            if ($("#costume").val() == ""){
                alert("You have to have a costume to be eligible for this raffle");
            }else{
                submit();
            }
        }
    }
}

function clearForms() {
    $('#partyForm')[0].reset();

}

function getUrlVars()
{
    var vars = [], hash;
    var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
    for(var i = 0; i < hashes.length; i++)
    {
        hash = hashes[i].split('=');
        vars.push(hash[0]);
        vars[hash[0]] = hash[1];
    }
    return vars;
}

</script>
</body> 
```

来宾列表.php

```
<?php

    $host = "localhost";
    $user = "root";
    $password = "";
    $database = "party";

    $link = mysql_connect($host, $user, $password);
    mysql_select_db($database);

    //SURVEY INFORMATION
    $fname = mysql_real_escape_string($_REQUEST['fname']);
    $lname = mysql_real_escape_string($_REQUEST['lname']);

    $checkClient  = "SELECT * FROM guestlist WHERE first_name = ".$fname." AND last_name = ".$lname;
    mysql_query($checkClient) or die(mysql_error());

    mysql_close($link);

?> 
```

派对入口.php

```
<?php

    $host = "localhost";
    $user = "root";
    $password = "";
    $database = "party";

    $link = mysql_connect($host, $user, $password);
    mysql_select_db($database);

    //SURVEY INFORMATION
    $fname = mysql_real_escape_string($_REQUEST['fname']);
    $lname = mysql_real_escape_string($_REQUEST['lname']);
    $cost = mysql_real_escape_string($_REQUEST['cost']);

    $addClient  = "INSERT INTO attendance (first_name, last_name, costume) VALUES ('$fname','$lname', '$cost')";
    mysql_query($addClient) or die(mysql_error());

    mysql_close($link);

?> 
```

我得到的错误是，即使客人名单上没有名字，它仍然会显示他们在名单上。所以我在对 guestlist.php 的 Ajax 调用中一定是做错了什么，但我不知道是什么。我在编写 ajax 调用以检查客人是否已被放入考勤表时也遇到了问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T19:54:02.103

根据 REST 原理，使用 HTTP 200 响应 POST 请求意味着资源创建成功。您可以使用 HTTP 400 进行响应，并以 text/html/json/xml 格式提供有关错误的详细信息。

尝试这样做，

添加以下代码，

```
$query = mysql_query($addClient) or die(mysql_error());

if(mysql_num_rows($query) > 0)
{
     header('HTTP/1.1 500 Internal Server Error');
     echo 'this is an error message';
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T20:00:59.617

就像我在评论中说的那样，您必须从 中返回一个值`guestList.php`，这样的事情应该可以工作：

```
$checkClient  = "SELECT * FROM guestlist 
                 WHERE first_name = ".$fname." AND 
                       last_name = ".$lname;
$result = mysql_query($checkClient);
$count = mysql_num_rows($result);
mysql_close($link);
// output 1 or 0 stating if the user is on the list or not
echo ($count ? 1 : 0);
exit(); 
```

然后在您的 ajax 回调中，您将执行如下检查：

```
success:function(e) {
   alert((e == 1 ? "User is on list" : "User isn't on list")); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T20:02:36.813

至少您尝试执行无效查询时，php 脚本永远不会抛出错误。查询的执行没有任何错误，因为它的格式很好，因此不会抛出错误，因为您没有从数据库中获取行。

# python - python用正斜杠和反斜杠存储路径名

> ID：12288679
> 
> 赞同：3
> 
> 时间：2012-09-05T19:46:22.243
> 
> 标签：python, list, python-2.7, os.walk

我有一个程序，即`os.walk`sa 目录及其子目录来过滤 pdf 文件，分离出它们的名称和相应的路径名。我遇到的问题是它将扫描最顶层的目录并打印适当的文件名，例如`G:/Books/Title.Pdf`，但它扫描子文件夹的第二个，例如`G:/Books/Sub Folder/Title.pdf`它将打印以下内容

```
G:/Books/Sub Folder\\Title.Pdf 
```

（这显然是一个无效的路径名）。它还将 \\ 添加到子文件夹中的任何子文件夹。

以下是程序：

```
def dicitonary_list():
    indexlist=[]        #holds all files in the given directory including subfolders
    pdf_filenames=[]    #holds list of all pdf filenames in indexlist
    pdf_dir_list = []   #holds path names to indvidual pdf files 

    for root, dirs,files in os.walk('G:/Books/'):
        for name in files:
            indexlist.append(root + name)
            if ".pdf" in name[-5:]:
                pdf_filenames.append(name)

    for files in indexlist:
        if ".pdf" in files[-5:]:
            pdf_dir_list.append(files)

    dictionary=dict(zip(pdf_filenames, pdf_dir_list))       #maps the pdf names to their directory address 
```

我知道我想念的东西很简单，但是为了爱和金钱，我能看到它是什么。一双新鲜的眼睛会有很大帮助！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-05T19:52:42.067

在 Windows 上的 Python 中，正斜杠和反斜杠都是完全有效的路径分隔符。

```
>>> import os
>>> os.getcwd()
'j:\\RpmV'
>>> os.path.exists('j:\\Rpmv\\make.py')
True
>>> os.path.exists('j:/rpmv/make.py')
True
>>> os.path.isfile('j:\\Rpmv/make.py')
True 
```

# c# - 使用多个表单，在 ASP.NET Web 表单页面上提交按钮

> ID：12288680
> 
> 赞同：3
> 
> 时间：2012-09-05T19:46:23.173
> 
> 标签：c#, javascript, jquery

![在此处输入图像描述](../Images/5adca196be4e61345b22204f6ed2179c.png)

我在同一页面中有 3 个不同的提交按钮（登录、搜索、插入），我想要的是找到让这 3 个按钮在我按下它们时执行不同操作的最佳方法，或者我在大约时按下 enter按他们。正如您从我的照片中看到的那样，当我按下`Log In`插入时，也按下了插入，因为我的`global form`母版页中有一个。

我尝试使用不同的表单，但我不能，因为我需要它们拥有`runat="server"`，而这对于页面来说是不可能的。

我使用 asp Texboxes：

```
<asp:TextBox class="text-input" ID="txtLoginEmail" runat="server"
Height="15px" Width="130px"></asp:TextBox> 
```

和 asp 按钮：

```
<asp:Button class="submit google-button" ID="btnLogin" onclick="btnLogin_Click" 

runat="server" Text="Log in" /> 
```

除了我的搜索按钮，它是链接按钮：

```
<asp:LinkButton ID="searchLink" runat="server" onclick="searchLink_Click">Search</asp:LinkButton> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T19:49:37.460

您可以使用[验证组](http://weblogs.asp.net/scottgu/archive/2004/10/24/246945.aspx)在特定按钮单击时仅对所需的文本框进行验证。然后在具体按钮的事件处理程序中，您可以执行特定的逻辑。

# android-emulator - 具有自定义构建的 Android 模拟器不接受键盘输入

> ID：12288683
> 
> 赞同：3
> 
> 时间：2012-09-05T19:46:32.673
> 
> 标签：android-emulator, keyboard, emulation, qemu

我有一个使用自定义构建的金鱼内核的自定义 Android 图像。我一直在使用模拟器进行软件开发。

```
emulator -kernel out/target/product/atom/kernel 
```

当我升级到 SDK 20 时，我不再从主机或图形键盘获得键盘输入。这曾经奏效。我已经看到有关设置 hw.keyboard 属性=yes 的评论。我无法找到一系列有效的操作。

a）尝试启动模拟器并强制我的硬件配置

```
emulator -verbose -kernel out/target/product/atom/kernel -qemu -android-hw /home/jgrecco/work/ics-4.0.4/out/target/product/atom/hardware-qemu.ini 
```

hardware-qemu 被覆盖并且 hw.keyboard 选项为 no。

b) 创建一个 AVD 并让它加载我的自定义内核和图像

```
ex: android create avd --force -b x86 -n aal_emul -t 3

emulator -kernel out/target/product/atom/kernel -show-kernel  @aal_emul 
```

但是无法让 AVD 启动我的自定义映像。它似乎启动了一个默认映像。我试过复制img文件但没有运气

c) 尝试修改默认 hardware.ini 设置 ics-4.0.4/external/qemu/android/avd/hardware-properties.ini 无效。

许多许多其他变体。

如果有人可以使上述任何解决方案起作用或告诉我一个，我将不胜感激。顺便说一句，这是针对 x86 atom 的。

TIA

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T03:48:19.673

经过大量的实验、谷歌搜索、大量诅咒不准确（过时）的文档并更新了我所有的资源（与 repo 同步挂起 - 咆哮），我找到了解决方法。我想我会为了他人的利益而发布这个。

基本问题是升级到 SDK 20 后，我不再可以使用任何方式（真实或仿真键盘）输入应用程序。这仅在加载我自己的自定义图像“lunch #; emulator -kernel out/target/product/...”时发生。上面描述的覆盖 hw.keyboard 属性的尝试都没有对我有用。

我发现的解决方法是在运行时更改模拟器中的设置。设置->语言和输入->default_Hardware 物理键盘（关闭）。虽然我不能使用主机键盘，但我现在可以使用模拟器键盘进行输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-04-16T20:32:45.297

尝试在旁边存在`'hw.keyboard=true'`的文件中设置. 这会覆盖默认值，不应被覆盖。`config.ini``hardware-qemu.ini``hardware-qemu.ini`

# xcode4.4 - iOS 在模拟器和设备上运行不同的输出。键盘点与逗号

> ID：12288684
> 
> 赞同：0
> 
> 时间：2012-09-05T19:46:38.223
> 
> 标签：xcode4.4

我想放在键盘上（。）我运行模拟器就可以了。但我运行 iphone 设备，我似乎 (,) 我的 .m 文件；bText.keyboardType = UIKeyboardTypeDecimalPad;

请帮助我（xcode 4.4.1 + ios 5.1 + iphone 3Gs）！[在此处输入图像描述][1]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T11:04:15.410

有同样的问题，可能是我的一个错误

```
NSRange rangeOfDash = [mediaTotal rangeOfString:@","]; 
```

# xslt - weblogic 12 和 XSLT 错误

> ID：12288692
> 
> 赞同：-2
> 
> 时间：2012-09-05T19:47:35.893
> 
> 标签：xslt, weblogic, weblogic12c

> **可能重复：**
> [不能在包含元素的子元素之后创建 XSLT 属性节点 (id)](https://stackoverflow.com/questions/12289248/xslt-attribute-node-id-cannot-be-created-after-the-children-of-the-containing)

通常我在 Weblogic12 服务器上执行 XSLT 进程。我一直遇到这个问题

```
An attribute node (id) cannot be created after the children of the containing element 
```

在迁移之前，我们的团队完全没有问题......

知道为什么吗？我最近从 BEA Weblogic3 升级到 Oracle Enterprise Weblogic 12。还是我缺少库？

这困扰着我们整个团队！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T10:14:36.917

如果您希望我们找到您的代码错误的地方，您需要向我们展示您的代码。

错误消息（我认为）来自 Saxon，并且可能由于您的配置更改，您选择 Saxon 作为您的 XSLT 处理器，而之前您选择的是 Xalan。在 XSLT 1.0 中，这是一个可恢复的错误，并且允许处理器忽略它（通过简单地不输出有问题的属性）。我认为包含在内总是一个好主意

```
<xsl:comment><xsl:value-of select="system-property('xsl:vendor')"/></xsl:comment> 
```

在生产代码中，以便您可以看到您正在使用的 XSLT 处理器。

当您执行以下操作时会出现错误：

```
<a>
   <b/>
   <xsl:attribute name="x">3</xsl:attribute> 
```

您不能这样做，因为没有打开的开始标记来接收该属性。当然，通常情况比这要复杂一些，例如，元素可能是作为 xsl:call-template 指令的结果写入的。

# javascript - 为什么 Visual Web Developer 不能充当我的 IE7 Javascript 调试器？

> ID：12288695
> 
> 赞同：0
> 
> 时间：2012-09-05T19:47:42.303
> 
> 标签：javascript, visual-studio, debugging, internet-explorer-7, visual-studio-debugging

我需要调试一些无法在 IE7 中运行的 JS，因此我将 Visual Web Developer 2010 Express 安装到我的 IE7 虚拟机中，目的是[使用它来调试我想要的任何东西](https://stackoverflow.com/a/778498/907826)。但是当我在 IE7 中收到 Javascript 错误时，我只会收到一般的“此网站存在问题”消息，而没有调试器：

![IE7 通用 Javascript 错误弹出窗口](../Images/c5e783d594044f3eb73d87537fc83a1b.png)

Internet 选项中的“禁用脚本调试”处于**关闭状态**，并且“显示有关每个脚本错误的通知”**处于打开状态**。我尝试重置 IE 和 Visual Web Developer 的默认设置，并禁用 IE 的所有附加组件。

有谁知道送什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T00:06:30.327

确保您的默认浏览器设置为您尝试测试的浏览器（在本例中为 IE 7）。当您开始在 Visual Wed Developer 中调试您的空项目时，它应该打开默认浏览器。

不确定它的本质，但在幕后发生了一些神奇的事情，使 IE 中的脚本引擎能够通过 IDE 暴露给开发人员。

# webview - 无法将本地图像文件显示为 WebEngine 图像 src 属性

> ID：12288697
> 
> 赞同：1
> 
> 时间：2012-09-05T19:47:45.277
> 
> 标签：webview, javafx-2

我正在尝试设置我动态拥有的 img 标签的 src。以下代码在从 Eclipse 运行时有效，但在将其导出为运行的 jar 文件后无效：

```
doc.getElementById("user-thumb").setAttribute("src", selectedVcard.getThumb().getFilePath()); 
```

“user-thumb” id 得到的元素是一张图片。返回的 thumb 对象是一个简单的自定义 ImageView，我已对其进行了扩展以保存更多信息，并使用以下方法进行初始化：

```
public Thumb(String url) {
    super(url);
    this.setFilePath(url);
    getStyleClass().add("thumb");
} 
```

getFilePath() 方法从临时文件中返回一个路径，该路径以：

```
file:/ 
```

但我已经尝试将其更改为

```
file:// 
```

乃至：

```
file:/// 
```

并没有成功。我在这里用谷歌搜索过，但每个答案都以 file:// 开头。我的代码有问题还是 javafx 2 有问题？顺便说一句，我使用的是 javafx 2.2 GA 和 oracle 的 jre 1.7.0.6。干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T18:50:50.370

您可以[对图像使用数据 URI](http://www.websiteoptimization.com/speed/tweak/inline-images/)

就像是 ...

```
String imageMimeType = "image/jpeg"; // Replace this for the correct mime of the image
String dataURI = "data:" + imageMimeType + ";base64," + 
     javax.xml.bind.DatatypeConverter.printBase64Binary(imageByteArray); 
```

# jquery - Stackoverflow 如何删除并添加到他们的 { code }？

> ID：12288700
> 
> 赞同：2
> 
> 时间：2012-09-05T19:48:00.423
> 
> 标签：jquery

我玩得很开心，将代码复制/粘贴到 textarea 中，然后试图让它在“pre”“/pre”中看起来不错......当然我已经看过了。

但是我遇到了太多空格的问题，所以我试图用一些 nbsp; 替换 \t; 但它并没有变得……真的很漂亮。

所以我想知道，这样做的好方法是什么？SO是怎么做到的？它甚至能够以体面的方式做到这一点吗？

我现在得到的是：

```
var content = $this.html()
                        .replace(/\t\t\t\t\t\t/g, "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;")
                        .replace(/\t\t\t\t\t/g, "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;")
                        .replace(/\t\t\t\t/g, "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;")
                        .replace(/\t\t\t/g, "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;")
                        .replace(/\t\t/g, "&nbsp;&nbsp;&nbsp;")
                        .replace(/\t/g, "");
        $this.html(content); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T20:06:00.550

我认为您应该使用 jQuery 语法荧光笔并让插件为您完成工作。

[http://alexgorbatchev.com/SyntaxHighlighter/](http://alexgorbatchev.com/SyntaxHighlighter/)

[http://steamdev.com/snippet/](http://steamdev.com/snippet/)

# scheme - 在 chez 方案中使用匹配

> ID：12288701
> 
> 赞同：1
> 
> 时间：2012-09-05T19:48:07.063
> 
> 标签：scheme, match, chez-scheme

我正在尝试学习如何在方案中使用匹配。我有点理解它如何处理非常短的问题（即：定义长度只是两行），但不适用于有多个输入和辅助程序的问题。例如，这是定义联合的一种流行方式：

```
(define ele? 
  (lambda (ele ls)
   (cond
    [(null? ls) #f]
    [(eq? ele (car ls)) #t]
    [else (ele? ele (cdr ls))])))

(define union
 (lambda (ls1 ls2)
  (cond
   [(null? ls2) ls1]
   [(ele? (car ls2) ls1) (union ls1 (cdr ls2))]
   [else (union (cons (car ls2) ls1) (cdr ls2))]))) 
```

您如何在两个程序中使用 match 来做到这一点？（或者你甚至需要两个程序？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T01:21:13.527

第一个可以这样实现：

```
(define ele?
  (lambda (a b)
    (let ((isa? (lambda (x) (eq? (car x) a))))
      (match b [(? null?) #f]
               [(? isa?) #t]
               [_ (ele? a (cdr b))])))) 
```

然后第二个很容易

```
(define uni
  (lambda (ls1 ls2)
    (let ((carinls2? (lambda (x) (ele? (car x) ls1))))
      (match ls2 [(? null?) ls1]
                 [(? carinls2?) (uni ls1 (cdr ls2))]
                 [_ (uni (cons (car ls2) ls1) (cdr ls2))])))) 
```

也许有一种更聪明的方法可以避免这些参数让 lambdas 但我仍在学习；）

# android - Android AutocompleteTextView 建议被索引到 listview

> ID：12288705
> 
> 赞同：2
> 
> 时间：2012-09-05T19:48:30.070
> 
> 标签：android

我正在创建一个活动，其中有 textview/autocompletetextview、listview 和一个按钮。我的自动完成文本视图运行良好，但我想将我在文本视图中输入的内容索引到列表视图，当它突出显示时，我会单击按钮并转到相应的活动。

到目前为止，这是我所做的：

```
String[] classes = { 
        "Acornsquash", 
        "Almonds", 
        "Apples", }

private ListView lv;

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    requestWindowFeature( Window.FEATURE_LEFT_ICON );
    setContentView(R.layout.nutritional_list);
    setFeatureDrawableResource( Window.FEATURE_LEFT_ICON, R.drawable.nutrition32 );

    //ArrayAdapter<String> adapter = new ArrayAdapter<String>( this, 
    //      android.R.layout.simple_dropdown_item_1line, classes );
    ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, R.layout.my_list_item, classes );    

    AutoCompleteTextView tv = ( AutoCompleteTextView ) findViewById ( R.id.txtSearcEngine );

    tv.setThreshold( 3 );
    tv.setAdapter( adapter );
    tv.setTextColor( Color.BLACK );

    lv = ( ListView ) findViewById(R.id.lvListSearch);
    lv.setAdapter(new ArrayAdapter<String>( this, android.R.layout.simple_list_item_1, classes ) );
    lv.setOnItemClickListener( this );

public void onItemClick( AdapterView<?> parent, View v, int position, long id ) {

    lv.setSelection(position);

    switch( position )
    {
    case 0:
        Intent acorn = new Intent( Nutritional_List.this, AcornSquash.class );
        startActivity( acorn );
        break;
    case 1:
        Intent almonds = new Intent( Nutritional_List.this, Almonds.class );
        startActivity( almonds );
        break; 
```

我的问题是，我不知道如何将建议从 autocompletetextview 索引到 listview。有什么帮助吗？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T20:25:11.220

**改写**

我发布了两种方法来完成你想要的。我相信第一种方法更容易编码并且使用起来更不容易混淆。第二种方法是直接回答您的问题。

* * *

**方法 1**
当 AutoCompleteTextView 和 ListView 都提供相同的信息时，我觉得很好奇。AutoCompleteTextView 具有根据用户文本过滤选择的优点，但您可以通过添加过滤 ListView 本身的简单 EditText 来删除 AutoCompleteTextView 和 Button。

```
EditText edit = (EditText) findViewById(R.id.edit);
edit.addTextChangedListener(new TextWatcher() {
    public void onTextChanged(CharSequence s, int start, int before, int count) {
        adapter.getFilter().filter(s);
    }

    public void beforeTextChanged(CharSequence s, int start, int count, int after) {}
    public void afterTextChanged(Editable s) {}
}); 
```

哪里`adapter`是类变量，如`lv`,`tv`等，以及传递给的适配器`lv`：

```
adapter = new ArrayAdapter<String>( this, android.R.layout.simple_list_item_1, classes );
lv.setAdapter(adapter); 
```

* * *

**方法 2**
做你最初问的，首先让我们换`classes`一个更强大的`ArrayList<String>`：

```
ArrayList<String> classesList = new ArrayList<String>(Arrays.asList(classes));
...

public void onCreate() {
    ...
    // Update both of your adapters!
    ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, R.layout.my_list_item, classesList ); 
```

创建一个新的类变量为`int tvIndex = -1`. 当我们从 AutoCompleteTextView 中单击一个项目时，我们将使用它：

```
tv.setOnItemClickListener(new OnItemClickListener() {
    @Override
    public void onItemClick(AdapterView<?> parent, View v, int position, long id) {
        String text = ((TextView) v).getText().toString();
        tvIndex = classesList.indexOf(text);
        lv.setSelection(tvIndex);
    }
}); 
```

如果用户按下按钮继续：

```
button.setOnClickListener(new OnClickListener() {
    @Override
    public void onClick(View v) {
        if(tvIndex > -1)
            lv.performItemClick(lv.getChildAt(tvIndex), tvIndex, tvIndex);
    }
}); 
```

希望有帮助！

# c++ - 无法将 char* 转换为 char

> ID：12288706
> 
> 赞同：-3
> 
> 时间：2012-09-05T19:48:38.510
> 
> 标签：c++, multidimensional-array

我的函数被注释掉了，因为我试图先解决这个问题><。但是当我尝试将我的数组传递给函数时，编译会出现一条错误消息。

```
error: cannot convert ‘char*’ to ‘char (*)[7][49]’ for argument ‘1’ to
‘void save(char (*)[7][49])’ 
```

这发生在我的代码第 63:61、67:46 和 70:36 行。

```
//Header
#include <iostream>
#include <fstream> 
using namespace std; 

//function prototype
/* 
Name: deal
Process: takes cards from file into 3d array and 2d array
Input: array name (int),2d array name (int)
Output: none
Dependencies: none 
*/
void deal ( char tablue [7][7][49] , char wastePile [24][24]);
/*
Name: displayCards
Process: Displays cards from array to screen
Input: tablue array (char)
Output to screen: The cards in a solitaire display
Dependencies: None
*/
void displayCards ( char tabalue [7][7][49]);

/*
Name: save
Process: Save tablue to a file
Input: tablue (char)
Output: None
Depnencies: None
*/
void save ( char tablaue [7][7][49] );

// global constants 
ofstream fout; 
ifstream fin;

//main program
int main()
{
//initialize variables  
bool menu = true; 
char choice; 
char tablaue [7][7][49], wastePile [24][24];

//switch menu
 // display options
   cout<< "G.ame" << endl << "Q.uit" << endl;

 //menu
   while ( menu == true )
  { 
   // get user choice
    cin >> choice; 
   // switch 
     switch (choice)
     { 
     // if game
      case 'G':

     //get cards from file
     //deal cards to three "deminsion array" and into waste pile
       // function deal           
         deal ( &tablaue [7][7][49], &wastePile [24][24]);

   //display cards on screen
     // function displayCards
       displayCards ( &tablaue [7][7][49]);

   //save tablaue
     save ( &tablaue [7][7][49]);

   // pause screen
     //system pause

  // break case
     break; 

  //if quit
   case 'Q':

   // end switch
     menu = false; 

 //break case
  break; 
  }
  }
 // display exit screen
 cout<< "Thanks for playing";  

//end program
return 0;
}

//Functions
void deal (char tablue [7][7][49], char wastePile [24][24])
{ 
/*/ initialize variables
char card [40]; 
char space [10];
int rowI, colI, cardI;

// open file
fin.open("card1.txt");

// prime loop
fin << card;

//take in cards
while (fin.good())
{
fin << SPACE;
// fill in array
for ( rowI=0, rowI<7, rowI++)
 {
   for ( colI=0, colI<7, colI++)
    {
     for ( cardI=0, cardI<49, cardI++)
      {
       // check to see if slot should be empty
       if ( rowI < colI)
        {
         tablue[rowI][colI][cardI] = "EMPTY";
        }
      // put card in slot
       else 
        {
         tablue[rowI][colI][cardI] = card;
        }
      }
    }

  }
 //fill waste pile
   for (rowI=0, rowI<24, rowI++) 
    {
     wastePile [rowI] = card; 
    }    
 }*/
}
void displayCards ( char tablue[7][7][49])
{
/*/ initialize variables
int rowI, colI, cardI;

// make space
cout<< endl << endl << "       "; 

// display card
for (rowI =0, rowI<7, rowI++)
{
 for (colI=0, colI<7, colI++)
   {
    for (cardI=0, cardI<7, cardI++) 
     {
      //check for empty slot
       if ( tablue[rowI][colI][cardI] != "EMPTY")
        {
         cout << tablue [rowI][colI][cardI];
        }
       else 
        {
         cout<< "             ";
        }
      //print space
       cout<<"       ";
     }
   }
 }*/
}

void save ( char tablue [7][7][49] )
{
/*

*/
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T19:50:58.977

`&`将数组作为参数传递时，您不需要数组大小。只需传入名称就足够了，只要正确声明了您的 bas 数组大小和类型，从上面的代码中可以看出，它们就是。

IE：

```
deal ( tablaue, wastePile ); 
```

# actionscript-3 - 使用 fullScreenSourceRect 时可以更改 Flash 中的全屏缩放算法吗？

> ID：12288707
> 
> 赞同：1
> 
> 时间：2012-09-05T19:48:45.773
> 
> 标签：actionscript-3, actionscript, fullscreen, hardware-acceleration

当我将我的 Flash 游戏设置为全屏交互显示模式并设置 stage.fullScreenSourceRect 以使其使用硬件缩放时，任何分辨率下的性能似乎都比不使用 fullScreenSourceRect 时要好得多。我真的很想使用这个功能，但问题是它似乎使用了 4 倍模糊或一些类似的缩放算法，这使得一切看起来都非常模糊。

将模糊作为唯一可用的缩放模式似乎是一个奇怪的选择。我会更高兴有一个简单的最近邻居。我在文档中找不到有关更改比例算法的任何信息。有没有办法在仍然使用硬件加速的同时做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T23:14:13.617

这个游戏的预期平台是什么？如果这是移动的，那么可以实施一些标准来确保理想的分辨率。如果这是针对网络的，那么我建议定义刚性尺寸。否则，根据我的经验，最好开发到显示器理想的原始分辨率。除非您的代码动态地将对象绘制到您的舞台上，否则总会有某种光栅/插值。您还可以获取屏幕分辨率并让代码进行相应调整： [如何在 ActionScript 3 中获取用户的屏幕分辨率？](https://stackoverflow.com/questions/1048566/how-do-i-get-the-users-screen-resolution-in-actionscript-3)

我开发了许多触摸屏应用程序，它们跨越具有不同分辨率的多个显示器，AIR 在它的“屏幕”类中有一些很好的选择，可以使过程更容易。

# c# - C#，WebBrowser，如何在页面上的任何其他脚本之前注入和执行 JavaScript？

> ID：12288710
> 
> 赞同：0
> 
> 时间：2012-09-05T19:49:00.400
> 
> 标签：c#, javascript, browser

我知道如何在加载事件时将我自己的脚本注入网页，但它并不总是按预期工作。有时页面会在我之前成功运行自己的脚本，这会使我的整个应用程序失败。我尝试禁用页面生成另一个浏览器窗口的可能性。我的服务器上运行了一个应用程序，当它随机启动 Internet Explorer 实例时 - 它很快使整个机器崩溃，这是一场灾难。

我制作了一个脚本来更改 window.open 方法，它完美地完成了这个技巧 - 除了在我的代码执行之前页面弹出另一个窗口的情况。有没有办法在我完成注入脚本之前冻结 JS？也许有没有办法在 DocumentCompleted 事件之前注入我的脚本？但是怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T19:53:12.090

这并不能直接回答您关于如何在浏览器中执行此操作的问题 - 但我知道 Avast Internet Security 所做的类似事情，它使用 HTTP 代理来完成。

这个想法是在通过网络接收 HTML 页面时拦截它们，并将脚本注入 HTML 本身；因此，任何其他脚本都无法在它之前执行。

虽然这听起来很吓人——你可以使用支持非常优秀的 Fiddler HTTP 调试器的技术来做到这一点[——FiddlerCore API](http://www.fiddler2.com/Fiddler/Core/)

# c# - powerpoint 录音排练时间

> ID：12288713
> 
> 赞同：3
> 
> 时间：2012-09-05T19:49:04.837
> 
> 标签：c#, xml, vb.net, powerpoint

有谁知道如何使用 c# 或 VB 设置 powerpoint 的录制幻灯片/排练时间？可以在打开的 xml 文件中完成吗？或者我忽略了哪些开发人员参考资料？我希望能够选择一种不同的方法来安排自运行演示文稿的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-05-26T00:50:33.510

这是向 Powerpoint 添加 2 1/2 秒排练时间的代码

```
slide.SlideShowTransition.AdvanceTime =2.5f;
slide.SlideShowTransition.AdvanceOnTime = MsoTriState.msoTrue; 
```

花了我很长时间才找到这个，所以希望它可以帮助其他人快乐编程！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-11-28T06:52:02.357

AdvanceTime 存储整个幻灯片的持续时间，事件触发时间存储在 tag.xml 文件中，因为 Timing 值存储为管道分隔符值，例如“|34.0|34|3|5.4”

# ruby - Heroku 将我的 sinatra 应用程序检测为 node.js 应用程序并失败

> ID：12288714
> 
> 赞同：2
> 
> 时间：2012-09-05T19:49:17.060
> 
> 标签：ruby, deployment, heroku, sinatra

这是我的 sinatra 应用程序的目录结构

```
➜  app-fin git:(master) ls
public/  views/  birthday_countdown.rb  config.ru  Gemfile  Gemfile.lock  Procfile  web.rb 
```

我的 Gemfile 是

```
source 'https://rubygems.org'

gem 'sinatra'
gem 'thin' 
```

过程文件

```
web: bundle exec ruby web.rb -p $PORT 
```

和 config.ru

```
$:.unshift File.expand_path("../", __FILE__)
require './web'
run Sinatra::Application 
```

当我尝试推送到 heroku 时，出现此错误，

```
-----> Heroku receiving push
-----> Node.js app detected
-----> Resolving engine versions
       Using Node.js version: 0.6.20
       Using npm version: 1.0.106
-----> Fetching Node.js binaries
-----> Vendoring node into slug
-----> Installing dependencies with npm
       npm ERR! Couldn't read dependencies.
       npm ERR! Error: Invalid name: "Sinatra Class" may not start with '.' or contain %/@+: or whitespace
       npm ERR!     at /tmp/node-npm-cVE5/lib/utils/read-json.js:229:13
       npm ERR!     at /tmp/node-npm-cVE5/lib/utils/read-json.js:134:32
       npm ERR!     at P (/tmp/node-npm-cVE5/lib/utils/read-json.js:110:40)
       npm ERR!     at cb (/tmp/node-npm-cVE5/node_modules/graceful-fs/graceful-fs.js:36:9)
       npm ERR!     at [object Object].<anonymous> (fs.js:123:5)
       npm ERR!     at [object Object].emit (events.js:64:17)
       npm ERR!     at Object.oncomplete (fs.js:1190:12)
       npm ERR! Report this *entire* log at:
       npm ERR!     <http://github.com/isaacs/npm/issues>
       npm ERR! or email it to:
       npm ERR!     <npm-@googlegroups.com>
       npm ERR! 
       npm ERR! System Linux 2.6.32-346-ec2
       npm ERR! command "/tmp/node-node-yUVv/bin/node" "/tmp/node-npm-cVE5/cli.js" "install" "--production"
       npm ERR! cwd /tmp/build_16s1spp2lcght
       npm ERR! node -v v0.6.20
       npm ERR! npm -v 1.0.106
       npm ERR! 
       npm ERR! Additional logging details can be found in:
       npm ERR!     /tmp/build_16s1spp2lcght/npm-debug.log
       npm not ok
 !     Failed to install --production dependencies with npm
 !     Heroku push rejected, failed to compile Node.js app 
```

我很困惑为什么它认为我的应用程序应该使用 node.js，有没有人知道如何让 heroku 相信它实际上是一个 sinatra 应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T00:22:41.647

您是否有可能在创建应用程序时指定了 node.js buildpack？

[https://devcenter.heroku.com/articles/buildpacks](https://devcenter.heroku.com/articles/buildpacks)

既然你有一个合适的 Gemfile，它应该首先被 ruby​​ buildpack 检测到。此外，由于您没有 package.json 文件，因此不应检测到 Node.js。

# javascript - jquery onbefore 卸载触发器

> ID：12288718
> 
> 赞同：0
> 
> 时间：2012-09-05T19:49:40.120
> 
> 标签：javascript, jquery, onbeforeunload

当用户实际离开页面时，我正在使用脚本淡出页面内容。

为此，我尝试使用该`beforeunload`事件。

当我浏览我的网站时它工作正常，但是我也发现它在应用程序启动时触发，例如Skype按钮。虽然我还没有离开过这个页面...

验证 onbeforeunload 事件以防止过早触发的最佳方法是什么？

我想我仍然应该使用我的：

```
$(window).one('beforeunload', function() {
  // need to make some condition, if really leaving the page - execute
  $('html.nojs').stop(true,false).css('overflow','hidden').animate({opacity:0},2000);
}); 
```

但我需要使用一些条件......只是想不出任何......

**编辑：**

*删除了该网站的链接*

动画确实有效，但是如果您转到任何特定产品并单击那里的 Skype 按钮，您会看到它会产生便便......

**编辑2：**

此问题的解决方案是检测触发前卸载事件的原因。正如我所说，通过在该调用中编写一些条件。

我们必须找到一种方法来找出事件是由外部应用程序调用触发的（例如尝试打开应用程序的Skype按钮）还是其他东西，例如......例如：（链接点击，按钮提交，脚本用于位置更改、开始搜索、后退/前进或刷新页面）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T20:02:49.770

这是这个问题的公认答案

[使用 window.onbeforeunload 时捕获用户响应](https://stackoverflow.com/questions/2103881/capture-user-response-when-using-window-onbeforeunload/2103974#2103974)

如果您需要知道是什么触发了 onbeforeunload 事件，您可以有一个全局变量，然后在单击 Skype 按钮时将其设置为 true。然后在 onbeforeload 事件中检查它。

# r - lapply 用于 BiomaRt 查询时比 for-loop 慢。这是预期的吗？

> ID：12288720
> 
> 赞同：2
> 
> 时间：2012-09-05T19:49:47.933
> 
> 标签：r, for-loop, lapply

我想使用`BiomaRt`包查询数据库。我有`loci`并且想要检索一些相关信息，比如说`description`。

我第一次尝试使用`lapply`，但对执行任务所需的时间感到惊讶。因此，我尝试了更基本`for-loop`的并获得更快的结果。

这是预期的还是我的代码或我的理解有问题`apply`？我阅读了其他有关`*apply`vs`for-loop`性能的帖子（[例如，这里](https://stackoverflow.com/questions/2275896/is-rs-apply-family-more-than-syntactic-sugar "2275896")），我知道不应该期望提高性能，但我不明白为什么这里的性能实际上**较低**。

这是一个可重现的例子。

1）加载库并选择数据库：

```
library("biomaRt")
athaliana <- useMart("plants_mart_14")
athaliana <- useDataset("athaliana_eg_gene",mart=athaliana) 
```

2）查询数据库：

```
loci <- c("at1g01300", "at1g01800", "at1g01900", "at1g02335", "at1g02790", 
"at1g03220", "at1g03230", "at1g04040", "at1g04110", "at1g05240"
) 
```

我创建了一个函数用于`lapply`：

```
foo <- function(loci) {
  getBM("description","tair_locus",loci,athaliana)
} 
```

当我在第一个元素上使用此功能时：

```
> system.time(foo(cwp_loci[1]))
utilisateur     système      écoulé 
      0.020       0.004       1.599 
```

当我`lapply`用来检索所有值的数据时：

```
> system.time(lapply(loci, foo))
utilisateur     système      écoulé 
      0.220       0.000      16.376 
```

然后我创建了一个新函数，添加了一个`for-loop`：

```
foo2 <- function(loci) {
  for (i in loci) {
    getBM("description","tair_locus",loci[i],athaliana)
  }
} 
```

这是结果：

```
> system.time(foo2(loci))
utilisateur     système      écoulé 
      0.204       0.004      10.919 
```

当然，这将应用于 的大列表`loci`，因此需要性能最佳的选项。我感谢你的帮助。

**编辑根据@MartinMorgan 的推荐**

简单地把向量`loci`传给getBM就大大提高了查询效率。越简单越好。

```
> system.time(lapply(loci, foo))
utilisateur     système      écoulé 
      0.236       0.024     110.512 

> system.time(foo2(loci))
utilisateur     système      écoulé 
      0.208       0.040     116.099 

> system.time(foo(loci))
utilisateur     système      écoulé 
      0.028       0.000       6.193 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T21:24:15.973

我觉得这与 lapply 与 for 循环无关。调用数据库需要 1.6 秒，lapply 执行 10 次，即总共 16 秒。for 循环没有什么不同，它调用数据库 10 次。但是，它执行与应用循环相同的查询，可能导致数据库返回缓存结果而不是查询数据库。这可以通过颠倒调用的顺序来检查时间是否有利于 lapply。感谢@JoshuaUlrich 在聊天中建议数据库缓存。除了数据库缓存（或由网络服务器缓存）之外，@MartinMorgan 的建议还为花费的时间增加了相当多的随机性`getBM`。

底线，差异很大的可能性在 R 之外并且与循环、lapply 或 for 循环的样式无关。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T21:02:07.580

函数家族虽然是惯用的`apply`，但只是`for`循环的语法糖。他们通常比较慢。正如 joran 所指出的，[这已经](https://stackoverflow.com/q/2275896/324364)在 SO 上被问过了。

如果您想要在 R 中加速循环的提示，请参阅[本卷 R 新闻](http://cran.r-project.org/doc/Rnews/Rnews_2008-1.pdf)（pdf）的第 46 页，称为“R 帮助台——如何避免此循环或使其更快？”

# ember.js - angularJS 是否支持路由和对象持久化？

> ID：12288721
> 
> 赞同：1
> 
> 时间：2012-09-05T19:49:54.360
> 
> 标签：ember.js, angularjs

我正在比较 ember.js 和 angularJS，目前我喜欢 ember 的是路由器和 ember-data（我希望很快成为核心框架的一部分）。

有谁知道 angularJS 是否支持这两个功能？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T20:47:27.080

我对 ember.js 不熟悉，但从阅读 ember 的文档中可以理解，AngularJS 中的机制应该（大致）等效：

1.  AngularJS 中的路由机制由 $route 服务处理。示例/教程在这里：[http ://docs.angularjs.org/tutorial/step_07](http://docs.angularjs.org/tutorial/step_07)
2.  至于数据访问，有高级 $resource 机制（[http://docs.angularjs.org/tutorial/step_11](http://docs.angularjs.org/tutorial/step_11)），非常擅长与 REST 端点交互。

提到的两个服务（$route 和 $resource）都非常适合标准用例，但对于更高级的用例显示出一些限制。幸运的是，总是有较低级别的后备选项（$location 对应 $route，$http 对应 $resource）。

希望对 ember.js 比较熟悉的人能多多评论。

# windows-phone-7.1 - 请解释 WP7 中图像构建操作之间的区别

> ID：12288723
> 
> 赞同：0
> 
> 时间：2012-09-05T19:50:07.013
> 
> 标签：windows-phone-7.1, windows-phone, buildaction

我从另一个开发人员那里接手了一个 WP7 项目，这是我对 WP7 的第一次体验（尽管与我第一次使用 .NET 和/或 XAML 相去甚远）。

我刚刚花了相当多的时间对一张图像大喊大叫，因为它没有按照我预期的方式渲染（也就是没有渲染）。我在后面的代码中设置了它的源属性。

我终于发现，因为这个特定的图像（其他图像渲染得很好）被设置为“Build Action = Resource”，所以我不得不以不同的方式引用它。为什么它没有例外，但这不是问题！

有人可以解释“构建操作 = 资源”和“构建操作 = 内容”与图像相关的区别。请具体说明，例如它如何影响性能（以及为什么！）等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T21:24:54.123

不同之处在于将图像构建到应用程序包 (XAP) 中的方式。如果它被指定为“资源”，那么它被编译到应用程序 DLL 中。如果它被指定为“内容”，那么它将作为 XAP 的一部分包含在内，但位于 DLL 之外。

性能影响是，如果将其作为资源包含，应用程序将需要更长的时间来加载，因为它还需要处理嵌入的图像。但是，当访问该图像时，它会更快，因为它基本上已经作为资源加载了。

通常，除非您确实需要更快的访问，否则您应该尝试将图像设置为内容。

# javascript - 如何调试第三方代码中的 javascript 未定义错误。

> ID：12288731
> 
> 赞同：2
> 
> 时间：2012-09-05T19:50:26.890
> 
> 标签：javascript

所以我在我的应用程序中使用 tinyMce，但我收到一个 JavaScript 错误，我似乎无法弄清楚如何调试。错误是“TypeError：P 未定义” - 我可以从 FireBug 中看到，但我不知道如何获得更多/更好的信息？

我尝试打开“中断所有错误”，但这只是向我显示了最小化的 JS 文件，我什至看不到一个名为“P”的变量，所以我猜我在叫错树。整个事情都很好，除非我点击保存。

*耸耸肩*，我现在只是卡住了。这是我的完整代码。你可以看到我尝试删除所有认为可能是它但没有骰子的插件。

显然，我需要解决的问题是为什么会发生这种情况 - 更好的解决方案是如何找出真正导致它的原因，所以当类似的事情再次发生时，我可以自己弄清楚。

谢谢 - 请参阅下面的完整代码。

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage<dynamic>" %>

<asp:Content ID="Content1" ContentPlaceHolderID="MainContent" runat="server">

    <script type="text/javascript">
        $(document).ready(function() {

            $('textarea.tinymce').tinymce({
                script_url: '/Scripts/TinyMCE/tiny_mce.js',
                theme: "advanced",
                plugins: "save",
                theme_advanced_buttons1: "save",
//                plugins: "pagebreak,style,layer,table,save,advhr,advimage,advlink,emotions,iespell,inlinepopups,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras,template",
//                theme_advanced_buttons1: "save,cut,copy,paste,pastetext,pasteword,|,search,replace,|,bold,italic,underline,strikethrough,|,print,|,iespell",
                theme_advanced_toolbar_location: "top",
                theme_advanced_toolbar_align: "left",
                theme_advanced_statusbar_location: "bottom",
                save_enablewhendirty: true,
                encoding: "xml",
                theme_advanced_resizing: true,
                mode: "textareas",
                save_onsavecallback: "ajaxSave",
                setup: function(ed) {
                    ed.onSaveContent.add(function(i, o) {
                        o.content = o.content.replace( /&#39/g , "&apos");
                    });
                }
            });

            function ajaxSave() {
                alert("ajaxSave called.");
            }

        });

    </script>
    <% Html.BeginForm("Index", "DisabilityReport", FormMethod.Post); %>  
    <%= Html.AntiForgeryToken() %>
    <%= Html.ModelData() %>
    <textarea name="documentContent" class="tinymce" cols="90" rows="60"></textarea>
    <% Html.EndForm();%>
</asp:Content> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T19:55:25.243

我不确定 Firebug，但如果你在 Chrome 中工作，Chrome 开发工具可以扩展压缩的 JS，从而更容易追踪这些错误。请参阅下面的括号按钮：

![在此处输入图像描述](../Images/2b13c786f13e98d904cec841c8176065.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T19:55:40.483

Firefox 有一个名为 JS Deminifier 的小插件，它可以动态地去除代码。唯一的缺点是它有时会在过程中产生错误。

很高兴了解您在寻找什么，但不要完全依赖它。

# facebook - 使用 oauth 2 保护我自己的移动应用程序的最佳方法是什么？

> ID：12288734
> 
> 赞同：1
> 
> 时间：2012-09-05T19:50:45.163
> 
> 标签：facebook, oauth, oauth-2.0

我正在尝试构建一个 OAuth 2 提供程序，并且 Web 服务器流程非常困难，但我无法找出实现已安装应用程序流程的最佳方法

我看到的大多数示例基本上都遵循移动应用程序中嵌入式浏览器内的 Web 服务器流程，这通常也是 facebook 和 google 演示 3rd 方应用程序使用其 API 的方式

但是 facebook 和 google 自己的移动应用程序是否真的使用该流程，或者是否有更好的方法来实现移动身份验证

我的主要问题主要源于客户端 ID 和客户端密码，如果它嵌入到移动应用程序的每个已安装版本中，它基本上变得毫无用处，因为它很容易被嗅探，并且没有明确的 oauth 2 示例说明每个应用程序的基础客户秘密

那么使用 oauth 2 保护我自己的移动应用程序的最佳方法是什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T07:33:01.503

由于您可能希望获得基于用户的授权并且不想在客户端处理用户名/密码，因此您可以选择使用[隐式授予流程](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-31#section-4.2)或[授权代码授予流程](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-31#section-4.1)（您称之为*web 服务器流程*） .

现在查看 OAuth 2 规范的[已安装应用程序部分](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-31#section-9)。他们在那里说：

> 在隐式授权类型和授权码授权类型之间进行选择时，应考虑以下几点：
> 
> *   由于本机应用程序无法对客户端凭据保密，因此使用授权代码授权类型的本机应用程序应该在不使用客户端凭据的情况下这样做。
> *   使用隐式授权类型流程时，不会返回刷新令牌，这需要在访问令牌过期后重复授权过程。

该规范还广泛涵盖了是使用嵌入式用户代理还是外部用户代理。

为了安全地实现这一点（至少在技术上可以在开放平台上实现），请在规范中搜索*native*一词并多次阅读包含该词的部分，尤其是[Client Authentication](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-31#section-10.1)和[Client Impersonation](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-31#section-10.2)部分。

# android - 将图像保存到 SD 卡不起作用

> ID：12288739
> 
> 赞同：1
> 
> 时间：2012-09-05T19:51:01.250
> 
> 标签：android, android-sdcard

在底部遇到问题，我正在尝试创建一个案例以将图像保存到 SD 卡但它不起作用，我不知道为什么。我认为这与 getRawResource 有关，但仍不确定。

谢谢你的帮助！！！

```
 package com.nk_apps.random;

import java.io.InputStream;
import android.app.Activity;
import android.content.Context;
import android.content.res.TypedArray;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.os.Bundle;
import android.provider.MediaStore;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.BaseAdapter;
import android.widget.Gallery;
import android.widget.ImageView;
import android.widget.Toast;

@SuppressWarnings("deprecation")
public class Main extends Activity {

    private Gallery gallery;
    private ImageView imgView;

    private Integer[] imgId = {
            R.drawable.image1,
            R.drawable.image2,
            R.drawable.image3,
            R.drawable.image4,
            R.drawable.image5,
            R.drawable.image6,
    };

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        imgView = (ImageView)findViewById(R.id.imageView01);    
        imgView.setImageResource(imgId[0]);

         gallery = (Gallery) findViewById(R.id.examplegallery);
         gallery.setAdapter(new AddImgAdp(this));

         gallery.setOnItemClickListener(new OnItemClickListener() {
            public void onItemClick(AdapterView parent, View v, int position, long id) {
                imgView.setImageResource(imgId[position]); 
            }
        });

    }

    public class AddImgAdp extends BaseAdapter {
        int GalItemBg;
        private Context cont;

        public AddImgAdp(Context c) {
            cont = c;
            TypedArray typArray = obtainStyledAttributes(R.styleable.Gallery1);
            GalItemBg = typArray.getResourceId(R.styleable.Gallery1_android_galleryItemBackground, 0);
            typArray.recycle();
        }

        public int getCount() {
            return imgId.length;
        }

        public Object getItem(int position) {
            return position;
        }

        public long getItemId(int position) {
            return position;
        }

        public View getView(int position, View convertView, ViewGroup parent) {
            ImageView imgView = new ImageView(cont);

            imgView.setImageResource(imgId[position]);
            imgView.setLayoutParams(new Gallery.LayoutParams(170, 270));
            imgView.setScaleType(ImageView.ScaleType.FIT_XY);
            imgView.setBackgroundResource(GalItemBg);

            return imgView;}

            public void onClick(View v) {
                // TODO Auto-generated method stub

            switch (v.getId()){
            case R.id.bsaveImage:
                InputStream inps = getResources().openRawResource(GalItemBg);
                Bitmap bmp = BitmapFactory.decodeStream(inps);
                try{
                    MediaStore.Images.Media.insertImage(getContentResolver(), bmp, "Title" , "Hip-Hop Wallpapers");
                    Toast saveToast = Toast.makeText(Main.this, "The image has been saved.", Toast.LENGTH_SHORT);
                    saveToast.show();
                }catch(Exception e){
                e.printStackTrace();
                }
                break;
        }
    }

} } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T20:42:38.647

您是否确认您对 sdcard 有写权限？（这是 WRITE_EXTERNAL_STORAGE）

此外，您应该确保查看正确的挂载点以找到映像（例如，对于某些设备，可以是“内部 sdcard”）。

# sql-server - 如何在 SQL Server 2008 中为视图创建复合键？

> ID：12288740
> 
> 赞同：0
> 
> 时间：2012-09-05T19:51:00.923
> 
> 标签：sql-server, asp.net-mvc-3, entity-framework, view

我需要在 SQL Server 2008 中为视图创建复合键，因为我无法在没有定义主键的情况下将视图导入实体框架，而且视图没有我必须创建的主键。现在，当我尝试将视图导入 EF 时出现此错误。

> 表/视图“FanDB.dbo.Quick_View”没有定义主键，也无法推断出有效的主键。此表/视图已被排除。要使用实体，您需要查看架构、添加正确的键并取消注释。

我之前可以将视图添加到 EF，但我的老板删除了我们的数据库，所以我从头开始重新创建数据库。我刚刚忘记了我是怎么做到的说要编辑 XML 文件（不能这样做，因为我不能将它添加到 .edmx）或添加一个我不能做的主键列，因为它是一个快速视图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T02:25:42.947

您可以将视图重新创建为表，添加主键，将其导入 EF，然后删除表并恢复视图。这将使您的表进入 EF，但是以后每次再次更新模型时都必须小心。

或者，您可以创建一个模型数据库，其对象名称与实际数据库相同，但视图创建为表。在设计时使用模型数据库，在运行时使用实际数据库。只要视图是可更新的，EF 运行时就不会关心它实际上是视图，而不是表。

如果您有强迫症，并且有很多表，那么从实际数据库自动生成模型数据库不会太难。

# asp.net - 模型上的一对多集合创建降序

> ID：12288743
> 
> 赞同：0
> 
> 时间：2012-09-05T19:51:12.810
> 
> 标签：asp.net, entity-framework, ef-code-first, code-first

```
Public Class Payment
    Public Property PaymentID As Integer
    Public Property Amount As Double
    Public Property DatePaid As Date
End Class

Public Class Customer
    Public Property CustomerID As Integer
    Public Overridable Property Payments As ICollection(Of Payment)
End Class 
```

有没有办法在 OnModelCreating 中定义 Payments 集合应按 DatePaid 降序排序。这样付款收集将始终以最近的付款开始并以最早的付款结束？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T21:02:18.063

简短的回答：不，没有。

您可以使用 NHibernate 来做到这一点——`OrderBy`在流畅的映射中使用方法——但这可能对你没有帮助。（顺便说一句，我并不是一个 NHibernate 怪胎）。

即使有可能我认为我会非常不愿意使用它，因为我不喜欢这种有状态的行为配置。您最好编写一个返回`Customer`with ordered的存储库方法`Payments`。那是创建和执行查询的地方，所以这就是您要定义其行为的地方。- 只是一个意见。

# sql-server-2005 - 复制数据库错误 (DNN)：被引用表中没有与外键中的引用列列表匹配的主键或候选键

> ID：12288746
> 
> 赞同：0
> 
> 时间：2012-09-05T19:51:38.313
> 
> 标签：sql-server-2005, dotnetnuke, dotnetnuke-5

> DNN 版本：5.6.2
> 
> 工具：SQL Server 管理工作室
> 
> 行动：复制数据库
> 
> 错误：引用表“角色”中没有与外键“FK_UserRoles_Roles”中的引用列列表匹配的主键或候选键

我尝试在线搜索此错误，但所有搜索都会导致在为非唯一列创建外键时遇到此错误的主题。就我而言，密钥已经创建。我仔细检查了 RoleId 列是 Roles 表上的主键，它确实是外键“FK_UserRoles_Roles”引用的列。

任何解决此问题的帮助表示赞赏。或者，除了“复制数据库”选项之外，还有什么快速复制数据库结构和数据的方法？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T04:27:05.243

DotNetNuke 数据库中还有一个 aspnet_Roles 表。这是 ASP.NET 身份验证提供程序的一部分。您的问题可能是没有迁移 aspnet_ 表和 DNN 表中的数据。

# drupal-7 - 在用户配置文件中创建隐藏字段

> ID：12288754
> 
> 赞同：2
> 
> 时间：2012-09-05T19:51:57.643
> 
> 标签：drupal-7

我已使用[此处](https://stackoverflow.com/questions/10579350/how-to-add-new-fields-to-user-profile-in-drupal-7-programmatically)引用的代码成功创建了自定义用户字段。

我希望根据“帐户设置”页面将该字段格式化为“隐藏”。我已在字段实例上将类型设置为隐藏，但它没有隐藏。知道如何将此字段**编程**为隐藏在我的模块中吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T06:25:28.407

您可以使用[Field Permissions 模块](http://drupal.org/project/field_permissions)来实现。

您可以按照自己的方式配置字段外观。

希望对您有所帮助……穆罕默德。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-07T08:17:49.713

您可以使用隐藏字段模块

# vim - Vim：使用 在菜单定义中？

> ID：12288760
> 
> 赞同：1
> 
> 时间：2012-09-05T19:52:18.017
> 
> 标签：vim

在我的 vimrc 中，我有以下映射：

```
map <leader>ddd <plug>test 
```

`<plug>test`在插件目录的外部 vim 文件中定义并按预期工作。问题是当我想在菜单项中使用映射时。例如，在自定义 menu.vim 中，我定义了以下内容：

```
an 10.631 &File.Test1   <leader>ddd
an 10.632 &File.Test2   :normal <leader>ddd<cr>
an 10.633 &File.Test3   :normal <plug>test<cr>
an 10.634 &File.Test4   <plug>test 
```

只有*Test2*有效，但我希望其他三个也能正常工作。有什么我想念的吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T03:40:03.277

编写命令时不要截断命令：`an`表示. 你需要. 如果您没有截断命令，那么猜测会容易得多。`a**nore**menu``amenu`

# php - PDO 应用程序 - 登录功能不正常

> ID：12288765
> 
> 赞同：0
> 
> 时间：2012-09-05T19:52:44.437
> 
> 标签：php, session, pdo

好的，所以我正在构建一个新应用程序，并决定使用 PDO 进行数据库访问。（我对 PDO 完全陌生，但我的印象是它是进行数据库访问的最佳方式）。

现在，我的登录脚本非常简单。它使用给定的用户名（来自登录表单）检查数据库中的用户，尝试将给定的密码与存储的纯文本密码匹配（尚未加密/解密*）*，并根据需要重定向用户。这是一个简单的序列图：

`Login Screen ---(user enters credentials)--->Login Handler---(gets user details and compares pw)-->if (pw == stored pw)--->dashboard / else --->login w/ error msg`

抱歉，如果这很难阅读，我不确定代表流程的最佳方式......无论如何......

这是我的问题：我输入了正确的用户名和密码（甚至区分大小写！），并且总是被重定向回带有错误消息的登录屏幕。但是，如果我只是通过 url 栏转到仪表板，我*不会被*重定向回登录屏幕（如果没有设置会话，我应该是这样），并且我的用户名显示在导航栏中（好像我已经登录正确）。

再次抱歉，如果这很难理解。它有点难以简单解释。如果这是一个问题，我也许可以做一个截屏视频来更好地解释。无论哪种方式，这是我的代码：

**登录处理程序.php**

```
if(!isset($_POST['username']) || !isset($_POST['password'])){
    header('Location: login.php?error=pass');
}
$username = $_POST['username'];
$pass = $_POST['password'];

//TODO: crypt password

try{
    $DB = new PDO("mysql:host=127.0.0.1;port=8889;dbname=cTix", 'root', 'root'); //TODO: change this when uploading to webserver
    $STH = $DB->prepare("SELECT * FROM users WHERE username = $username LIMIT 0, 1");
    $STH->setFetchMode(PDO::FETCH_OBJ);
    $STH->execute();
    $u = $STH->fetch();
    if($pass == $u->password){
        session_start();
        $_SESSION['uid'] = $u->id; //TODO: securely store uid
        header('Location: index.php');
    } else {
        //echo 'Your Password: ' . $pass . ' - Correct Password: ' . $u->password;
        header('Location: login.php?error=pass');
    }
} catch(PDOException $e){
    //echo $e->getMessage();
    header('Location: login.php?error=true');
    exit;
} 
```

下面是检索dashboard.php 用户名的代码：

```
function connection(){
    $host = 'localhost';
    $dbname = 'cTix';
    $user = 'root';
    $pass = 'root';
    try {
        $DBH = new PDO("mysql:host=$host;dbname=$dbname", $user, $pass);
        return $DBH;
    } catch(PDOException $e){
        echo $e->getMessage();
        return null;
    }
}

function getUserById($id){
    $DB = connection();
    $STH = $DB->query("SELECT * FROM users WHERE id = $id");
    $STH->setFetchMode(PDO::FETCH_OBJ);
    $u = $STH->fetch();
    $DB = null;
    return $u;
}

function getUserName(){
    echo getUserById(getCurrentUserId())->name;
} 
```

如果我可以提供任何其他信息，或者我可以提供的任何对您有帮助的信息，请告诉我！

不幸的是，如果没有解决这个愚蠢的登录问题，我无法在这个应用程序上取得任何进展，所以任何帮助都将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T20:18:11.943

这是您的问题所在：

```
$STH = $DB->prepare("SELECT * FROM users WHERE username = $username LIMIT 0, 1"); 
```

您将用户名连接到 SQL 字符串中，但没有引用它。我怀疑这将解决问题：

```
$STH = $DB->prepare("SELECT * FROM users WHERE username = '$username' LIMIT 0, 1"); 
```

**然而**

您应该研究如何使用绑定参数。您已经在使用 PDO，但您仍在 SQL 中编写用户输入的代码，并且绑定参数避免了这种情况——它也可以避免这个问题。

这应该可行，但我没有测试过：

```
$STH = $DB->prepare('SELECT * FROM users WHERE username = ? LIMIT 0, 1');
$STH->bindParam(1, $username);
$STH->setFetchMode(PDO::FETCH_OBJ);
$STH->execute(); 
```

# ios - 无需还原即可知道已购买了哪些 IAP

> ID：12288768
> 
> 赞同：1
> 
> 时间：2012-09-05T19:52:54.123
> 
> 标签：ios, in-app-purchase

我的应用有单独的非消耗性应用内购买待售，以及一个“批量”IAP，其中包含所有其他 IAP 的折扣价。因此，在允许用户购买 IAP 之前，我需要知道他们已经购买了哪些其他 IAP。我知道获取此信息的唯一方法是调用 restoreCompletedTransactions。但是 Apple 拒绝了我的应用程序，说我不允许在显示 Confirm In-App Purchase 对话框之前调用 restoreCompletedTransactions。AFAIK 尝试购买时会出现此对话框。所以我被困住了。有没有人有任何想法？谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T20:07:38.113

购买后您的应用会做什么？当然它设置了一个或 2 个标志以允许其他内容工作？你能不检查解锁的东西，然后你就会知道买了什么。

如果没有，那么只需在购买时在某处存储一个值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T15:06:13.500

我觉得你不能让自己清楚你想要做什么。当我试图做同样的事情时，让我解释一下。

当有人购买非消耗性 IAP 时，您给予他们一些特权。

在你的情况下折扣，在我的情况下一些额外的积分。

当您不知道这是非消耗性 IAP 的第一次购买时，您总是会在用户按下购买按钮时给予折扣。您不能将其存储在 NSUserDefaults 或钥匙串中，因为如果用户更改设备，它将无济于事。

因此，如果用户从设备购买 IAP，他会在该设备上获得折扣，这很酷，但他可以在使用同一帐户登录的每台设备上执行此操作。为了防止这种情况，您需要知道它是否是第一次购买。

有人可以说，你应该让他得到折扣。我不知道他在想什么，但就我而言，我只给出一次积分，因为他只需更换设备就可以得到很多积分，那是不公平的......

顺便说一句，我想出了一个解决方案，但它不是很有用。您可以创建一个名为 Pro Users 的游戏中心排行榜，当有人购买您的 IAP 时，您可以为该排行榜提供 100 分。之后，您可以查看用户评分，看看他是否已经购买了...

# python - 需要将字符串、数字和多维 numpy 数组一起存储在磁盘上

> ID：12288773
> 
> 赞同：0
> 
> 时间：2012-09-05T19:53:24.443
> 
> 标签：python, numpy, save

我的应用程序需要将对象的字段保存到磁盘，以便以后可以轻松地再次加载它们。目前我只是腌制整个对象并使用 gzip 压缩文件，但文件仍然很大（我假设是因为数组）并且比我想要保存的时间更长。有什么方法可以更好地存储数组吗？还是完全不同的方法？

cPickle 似乎并没有提高速度。我已经研究了 HDF5 h5py 来存储数组，但我想把所有东西放在一起。这是我第一次处理这样的问题，所以如果有一个很好的解决方案组合，我会很感激。

# sql - 将表数据从一台服务器复制到另一台服务器

> ID：12288774
> 
> 赞同：1
> 
> 时间：2012-09-05T19:53:27.447
> 
> 标签：sql, sql-server-2008, c#-4.0

服务器A

```
Table1
Id  Name    State   Country
1   Abc OH  USA

Table2
Id  Counties    Places
1   abc     def
1   koi     koii
1   joi     joio 
```

服务器B

```
Table1
Id  Name    State   Country

Table2
Id  Counties    Places 
```

我在两台服务器下都有 2 台服务器 ServerA 和 ServerB，有两个表 Table1/Table2 我正在尝试将 Table1 中的单行和 Table2 中的关联行复制到 ServerB 的 Table1 和 Table2 中。

这就是我尝试这样做的方式：

```
connection1 = connection to ServerA
connection2 = connection to ServerB

SqlCommand cmd1 = new SqlCommand("Select * from Table1 where id = 1");
SqlCommand cmd2 = new SqlCommand("Select * from Table2 where id = 1");

Connection1.Open();
Connection2.Open();

SqlDataReader reader1 = cmd1.ExecuteReader();
SqlDataReader reader2 = cmd2.ExecuteReader();

var value1 = reader1.read();
var value2 = reader2.read(); 
```

我使用`SqlDataReader`并执行上述命令并获取数据并将其插入到`ServerB Table1 and Table2`. 这是正确的方法吗？可以使用更好的sql命令吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T02:29:36.553

尝试使用**SQLBULKCOPY** [（请参见此处的示例）](http://www.codeproject.com/Articles/18418/Transferring-Data-Using-SqlBulkCopy)，这会更快，尤其是在您拥有大量数据的情况下

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T20:31:02.970

大多数数据库允许您连接到其他数据库。特定的 sytnax 高度依赖于数据库。但是，一旦这样做，您可以执行以下操作：

```
select *
into server2.<db2>.<schema2>.table2
from server1.<db>.<schema>.table1 
```

或者

```
create table server2.<db2>.table2 as
    select *
    from server1.<db>.table1 
```

（语法取决于数据库。第一个是 sql-server-like，第二个是 oracle-like。）

如果您的数据有任何大小，使用链接服务器绝对是最好的方法。通过将其读入内存，您可能会想一次读取并插入一行。如果您有超过几十行，您会发现这种方式比必要的更耗时。

# firefox - firebug 在 html 面板旁边显示 css 面板

> ID：12288775
> 
> 赞同：1
> 
> 时间：2012-09-05T19:53:29.677
> 
> 标签：firefox, firebug

今天，我遇到了一个奇怪的问题`Firebug`。让我解释一下：

当我启用它（通过`F12`键或其图标）并选择`HTML`面板时，我将有 2 个面板..`HTML`和`Style`（和`Layout`）。但是，当我转到另一个面板（如`Console`或`Script`）并返回 时`HTML`，侧面板消失了。我必须禁用并`Firebug`再次启用才能使其正常工作。

它是一个错误吗？

**注意**：我正在使用带有`FireFile`和`FireDiff`扩展的 firebug 1.10.3。在 Firefox 15.0 上

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T20:28:16.183

这是我也面临的一个错误，我克服这个问题的方法是重新安装 Firebug。

# windows - 阻止 Wix 在我的产品中安装所有功能？

> ID：12288780
> 
> 赞同：1
> 
> 时间：2012-09-05T19:53:39.763
> 
> 标签：windows, installation, wix, wix3.5

安装 MSP 补丁后，Windows Installer 决定安装初始 MSI 中提供的所有功能。如何防止 MSP 补丁安装所有可用功能？

功能请求显示如下：

```
Installed: Absent
Request: local
Action : local 
```

为什么要求全部安装？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T19:58:00.837

我发现 ADDLOCAL 属性被设置为所有未安装的功能。这导致每个人都有一个“请求：本地”。我为解决这个问题所做的是使用一个小的自定义操作来删除这个属性。它需要在 CostFinalize 之前进行，因为需要在该操作之前定义要安装的功能。变量 REINSTALL 保存已安装的功能，并且所有这些功能都需要重新安装。因此，MSP 补丁仅重新安装已安装的功能，而未触及已卸载的功能。

```
<CustomAction Id="REMOVE_ADDLOCAL_PROPERTY"
       Property="ADDLOCAL" Value="[NonExistentProperty]"
/>
<InstallExecuteSequence>
    <Custom Action="REMOVE_ADDLOCAL_PROPERTY" Before="CostFinalize">
        <![CDATA[PATCH]]>
    </Custom>
</InstallExecuteSequence> 
```

编辑：最后，这个解决方案适用于我的一个补丁，但对另一个失败。所以到目前为止我实施的最终解决方案是在补丁期间设置 REINSTALL=ALL。[这个 MSDN 链接](http://msdn.microsoft.com/en-us/library/windows/desktop/aa371175%28v=vs.85%29.aspx)表明：

> 请注意，即使将 REINSTALL 设置为 ALL，也只会重新安装之前已安装的那些功能。因此，如果为尚未安装的产品设置了 REINSTALL，则根本不会执行任何安装操作。

所以我认为这是一个比删除`ADDLOCAL`属性更好的解决方案。它也适用于两个补丁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T12:03:20.020

您必须在初始安装时将所选功能保存到注册表，`ADDLOCAL`属性。安装补丁时，它必须相应地从注册表设置`ADDLOCAL`属性中读取状态。

否则，补丁会像选择默认值一样运行，因此会安装缺少的功能。

[您链接到升级案例[的问题](https://stackoverflow.com/questions/2327513/wix-upgrade-preselect-features)`MigrateFeatures`，引用[`MigrateFeatureStates`action](http://msdn.microsoft.com/en-us/library/windows/desktop/aa370034%28v=vs.85%29.aspx)的属性在补丁的情况下不起作用。]

# django - 嵌入在 html 中的模态表单在 django 中不起作用

> ID：12288781
> 
> 赞同：1
> 
> 时间：2012-09-05T19:53:45.293
> 
> 标签：django, django-views

我正在申请食品食谱，并尝试在食谱中执行相同的 html 并在模式窗口中包含评论，问题是当我提交模板失败并且没有将评论保存在数据库中

网址.py

```
urlpatterns = patterns('recetas.apps.menus.views',
    url(r'^recetas/$','recetas_view',name='vista_recetas'),
    url(r'^reporte/$','reporte_receta',name='receta_reporte'),
    url(r'^receta/(?P<id_receta>\d+)$','detalle_receta', name='vista_detalle'),
) 
```

调用此 url 的 html 代码

```
<td><a href='/receta/{{ receta.id }}'>{{ receta.titulo }}</a></td> 
```

视图.py

```
def detalle_receta(request, id_receta):
    dato = get_object_or_404(Receta, pk=id_receta)
    comentarios = Comentario.objects.filter(receta=dato)
    if request.POST:
        if request.POST.get('cancel', id_receta):
            return HttpResponseRedirect('/receta/{0}'.format(id_receta))
        form = ComentarioForm(request.POST)
        if form.is_valid():
           form.save()
           return HttpResponseRedirect('/receta/{0}'.format(id_receta))
    else:
        form = ComentarioForm(initial={'receta': id_receta})

    cxt = {'receta':dato,'comentarios':comentarios,'form':form}
    return render_to_response('menus/receta.html', cxt, context_instance=RequestContext(request)) 
```

receta.html

```
{% extends 'base.html' %}
{% block titulo %}{{ receta.titulo }}{% endblock titulo %}
{% block estatico %}
<link rel='stylesheet' href='{{ STATIC_URL }}css/receta.css' type='text/css'>
<link rel='stylesheet' href='{{ STATIC_URL }}css/modal.css' type='text/css'>
<script type='text/javascript'>

    function despliegaModal(valor) {
        var elem = document.getElementById("bgVentanaModal");
        elem.style.visibility = valor;
        }
</script>
{% endblock estatico %}
{% block contenido %}
<div id="bgVentanaModal">
    <div id="ventanaModal">
        <form action="/receta/{{ receta.id_receta }}" method="POST">
            {% csrf_token %}
            {{ form.as_p }}
            <input type="submit" value="Grabar">
            <input name="cancel" type="submit" value="Cancelar">
        </form>
    </div>
</div>
<div id=receta>
    <div id="nombre_receta">
        <h1>{{receta.titulo|title}}</h1>
        <hr>
    </div>
    <div id='ingredientes'>
        <h2>Ingredientes</h2>
        <p>{{ receta.ingredientes }}</p>
    </div>
    <div id='imagen'>
        <img src='{{MEDIA_URL}}{{receta.imagen}}' width="480" height="300" >
    </div>
    <div id='preparacion'>
        <h2>Preparación</h2>
        <p>{{ receta.preparacion }}</p>
    </div>
    <div id='comentarios'>
        <h2>Comentarios</h2>
        {% for item in comentarios %}
            <p>{{ item.texto}}</p>
        {% empty %}
            <p>Sin Comentarios registrados</p>
        {% endfor %}
        {% if user.is_authenticated %}
            <a href="javascript:despliegaModal('visible');">Agregue su comentario</a>
        {% endif %}
    </div>
    <div id="pie">
        <hr>
        <p>Receta Registrada el {{ receta.tiempo_registro|date:'SHORT_DATETIME_FORMAT' }} por {{ receta.usuario }}</p>
    </div>
</div>
{% endblock contenido %} 
```

一切正常，直到我给出取消键，不验证 POST。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T20:45:25.867

我相信问题出在你的`view.py`. 具体在这部分：

```
if request.POST.get('cancel', id_receta):
    return HttpResponseRedirect('/receta/{0}'.format(id_receta)) 
```

这`if`永远不会产生`False`价值，因此，您的评论将永远不会被保存。这与[dict.get](http://docs.python.org/library/stdtypes.html#dict.get)函数的工作方式有关：

> 获取（键[，默认值]）
> 
> 如果键在字典中，则返回键的值，否则返回默认值。如果未给出默认值，则默认为 None，因此此方法永远不会引发 KeyError。

因此，如果单击，`Grabar`您将获得默认值 ( `id_receta`)。请尝试以下操作：

```
if request.POST.get('cancel'): # Default to None
    return HttpResponseRedirect('/receta/{0}'.format(id_receta)) 
```

`Cancelar`一种解决方法是在您单击模板时使用带有一些 JavaScript 的按钮来重定向：

**视图.py**

```
def detalle_receta(request, id_receta):
    dato = get_object_or_404(Receta, pk=id_receta)
    comentarios = Comentario.objects.filter(receta=dato)
    if request.POST:
        # if request.POST.get('cancel', id_receta):
        #    return HttpResponseRedirect('/receta/{0}'.format(id_receta))
        form = ComentarioForm(request.POST)
        if form.is_valid():
           form.save()
           return HttpResponseRedirect('/receta/{0}'.format(id_receta))
    else:
        form = ComentarioForm(initial={'receta': id_receta})

    cxt = {'receta':dato,'comentarios':comentarios,'form':form}
    return render_to_response('menus/receta.html', cxt, context_instance=RequestContext(request)) 
```

**receta.html**

```
...
...
<form action="/receta/{{ receta.id_receta }}" method="POST">
    {% csrf_token %}
    {{ form.as_p }}
    <input type="submit" value="Grabar">
    <input type="button" value="Cancelar" onclick="window.location.href='/receta/{{ dato.id }}'"/>>
</form>
...
... 
```

当然，您应该使用[get_absolute_url](https://docs.djangoproject.com/en/dev/ref/models/instances/?from=olddocs#get-absolute-url)而不是硬编码 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T21:02:09.933

感谢Cesar的帮助，您的回答对我有帮助，但我的错误在receta.html中的变量中

是`{{ receta.id }}`和按钮中的相同正确的是

```
<form action="/receta/{{ receta.id }}" method="POST">
    {% csrf_token %}
    {{ form.as_p }}
    <input type="submit" value="Grabar"/>
    <input type="button" value="Cancelar" onclick="window.location.href='/receta/{{ receta.id }}'"/>
</form> 
```

感谢您的帮助和发现错误的朋友

# ruby - 捆绑安装时出现json gem安装错误

> ID：12288788
> 
> 赞同：2
> 
> 时间：2012-09-05T19:54:05.597
> 
> 标签：ruby, ruby-on-rails-3, json, ruby-on-rails-3.2

当我尝试进行捆绑安装时，出现以下 json 错误。捆绑安装未完成。是什么赋予了？

```
Errno::EACCES: Permission denied - /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/gems/1.9.1/gems/json-1.7.5/.gitignore
An error occurred while installing json (1.7.5), and Bundler cannot continue.
Make sure that `gem install json -v '1.7.5'` succeeds before bundling.

>>$ gem install json -v '1.7.5'
ERROR:  While executing gem ... (Errno::EACCES)
Permission denied - /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/gems/1.9.1/gems/json-1.7.5/.gitignore 
```

编辑： sudo install 命令给出以下错误：

```
>>$ sudo gem install json -v '1.7.5' 
Building native extensions.  This could take a while...
ERROR:  Error installing json:
ERROR: Failed to build gem native extension.

    /usr/local/Cellar/ruby/1.9.3-p194/bin/ruby extconf.rb
creating Makefile

make
sh: make: command not found

Gem files will remain installed in /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/gems/1.9.1/gems/json-1.7.5 for inspection.
Results logged to /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/gems/1.9.1/gems/json-1.7.5/ext/json/ext/generator/gem_make.out 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T20:55:39.613

您需要安装 ruby​​1.8-dev 而不仅仅是 ruby​​1.8，您缺少开发标头。

如果在 OSX 上：

```
sudo install ruby1.8-dev 
```

如果在 Unix 上

```
sudo aptitude install ruby1.8-dev 
```

或者

```
sudo apt-get install ruby1.8-dev 
```

使用 ruby​​gems 源代码进入您的目录并运行： `sudo ruby setup.rb` 运行后：

如果在 OSX 上：

```
sudo gem install json -v '1.7.5' 
```

某些 unix 系统可能需要 gem version 命令才能正常工作，因此您应该运行：

```
sudo gem1.8 install json -v '1.7.5' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T20:32:11.907

在此处找到答案：[在将 redcarpet gem 添加到 Rails 应用程序后运行“$ bundle”时“sh: make: command not found”](https://stackoverflow.com/questions/6550495/sh-make-command-not-found-when-running-bundle-after-adding-redcarpet-gem)安装 Mountain Lion 后需要升级命令行工具

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T20:01:21.620

尝试使用此脚本

> sudo chown -R $USER /usr/local

# vb.net - vb.net 尝试从某个页面读取 xml 时处理服务器响应

> ID：12288794
> 
> 赞同：0
> 
> 时间：2012-09-05T19:54:32.247
> 
> 标签：vb.net

我有以下功能，用于从我的网站获取 html 源代码

```
Public Function GetPageHTML(ByVal URL As String, _
      Optional ByVal TimeoutSeconds As Integer = 10) _
      As String
        ' Retrieves the HTML from the specified URL,
        ' using a default timeout of 10 seconds
        Dim objRequest As Net.WebRequest
        Dim objResponse As Net.WebResponse
        Dim objStreamReceive As System.IO.Stream
        Dim objEncoding As System.Text.Encoding
        Dim objStreamRead As System.IO.StreamReader

        Try
            ' Setup our Web request
            objRequest = Net.WebRequest.Create(URL)
            objRequest.Timeout = TimeoutSeconds * 1000
            ' Retrieve data from request

            Try
                objResponse = objRequest.GetResponse 'some times it gives an error server unavailable 503
            Catch ex As WebException
                MsgBox(ex.Message)
            End Try

            objStreamReceive = objResponse.GetResponseStream
            objEncoding = System.Text.Encoding.GetEncoding( _
                "utf-8")

            objStreamRead = New System.IO.StreamReader( _
                objStreamReceive, objEncoding)
            ' Set function return value

            GetPageHTML = objStreamRead.ReadToEnd()
            ' Check if available, then close response
            If Not objResponse Is Nothing Then
                objResponse.Close()
            End If
        Catch
            ' Error occured grabbing data, simply return nothing
            Return ""
        End Try
    End Function 
```

有时 objResponse 给出错误“503 服务器不可用”和许多其他错误，如 403 等，我如何独立处理这些错误中的每一个？

我怎样才能让这个函数在一段时间后重试请求？问题是 try 语句似乎没有处理这个问题，我不确定为什么我没有看到异常 MsgBox 但它在调试器上显示错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T21:04:05.553

将响应转换为 HttpWebResponse 对象并对其 StatusCode 属性执行 Select Case。你必须清理并完成它，但这里有一个例子：

```
 Select Case CType(objResponse, Net.HttpWebResponse).StatusCode

        Case Net.HttpStatusCode.InternalServerError
            'This is sloppy, but a quick example for one of your sub-questions.
            System.Threading.Thread.Sleep(10000)
            'Try again.
            objResponse = objRequest.GetResponse
        Case Net.HttpStatusCode.BadRequest
            'Error Handling
        Case Net.HttpStatusCode.OK
            'Proceed as normal.
        Case Else
            'Error Handling

    End Select 
```

# testing - 是否有一组“标准”电话号码可用于测试验证码？

> ID：12288797
> 
> 赞同：5
> 
> 时间：2012-09-05T19:54:47.827
> 
> 标签：testing, phone-number

我看到了许多关于验证不同格式和来自不同国家的电话号码的不同问题和讨论。任何人都可以向我指出一组可以执行此类验证代码的综合测试数据吗？

我不想重新讨论关于*如何*验证电话号码的整个讨论。这已在其他地方进行了足够详细的介绍。这更像是寻找输入以传递给进行电话号码验证的“黑匣子”代码的情况。

是否有来自不同国家的许多不同格式的普遍接受的数据集被认为是“全面的”？在任何地方都可以使用特定国家/地区的格式集吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T13:54:18.047

出色地。根据我的 QA 经验，我认为您无法找到国际电话号码集，因为电话号码格式取决于地区、类型（简单或手机/手机）、内部或国际号码等。所以我会根据地域位置选择合适的格式号进行验证。第二点是正在开发的应用程序的功能规范，通常会详细描述可接受的电话号码类型和格式。问题是一个应用程序与另一个应用程序以及电话号码格式不同。希望这对您有所帮助）

# visual-studio-2010 - RDLC 2005 转换为 RDLC 2008：自定义代码不再“看到”

> ID：12288799
> 
> 赞同：1
> 
> 时间：2012-09-05T19:54:57.187
> 
> 标签：visual-studio-2010, reporting-services, rdlc

我的报告有一些问题，因为我已将它们更新为 VS2010 格式。

即使我已将 Microsoft.ReportViwer.Common 和 Microsoft.ReportViewer.WinForms 的引用从 v9 修改为 10，但当我尝试键入代码时。在一个字段中，“代码”之后是什么。总是用红色下划线，当我打印报告时，我得到#ERROR 而不是我想要的值。我知道它区分大小写，我多次检查拼写。

此外，我不知道为什么，但我的字段有错误！句法; 我似乎必须使用 Fields().value 让它们工作（在我不需要调用自定义代码的地方）

这些报告在转换之前运行良好（超过 20 份报告以这种方式转换），但现在不行。似乎报表设计器没有“看到”自定义函数。我试图将它们公开、共享；我所拥有的只是同样愚蠢的#ERROR 显示。

我希望他们在 VS2010 中工作，以避免总是不得不在 VS2008 中修改它们然后在 VS2010 中返回

这是一个带有框架 3.5 的 winform 应用程序

知道什么可能导致这种情况以及补救措施是什么？

非常感谢

尼科

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T05:50:51.037

有几种方法可以在 SSRS 中使用自定义代码。首先你可以在报表->报表属性->代码下的窗口中直接进入VB

另一种方法是编写自定义 DLL（当然可以用任何 .NET 语言完成），然后需要将其复制到您的开发机器和生产报表服务器。然后，您需要在项目中创建对该程序集的引用：报告 --> 报告属性 --> 引用（我假设您知道这一点）。

如果您没有使用自己的自定义程序集，而只是在您的机器上使用对某个程序集的引用，那么服务器上可能会对在哪里找到 dll 感到困惑。您可能需要将 DLL 复制到以下 KB 链接中所示的文件夹中：

[http://support.microsoft.com/kb/920769](http://support.microsoft.com/kb/920769)

当您将字段拖到 tablix 或文本框上并查看值表达式时，它是否使用 Fields!Fieldname.Value 语法？这种语法对 SSRS 来说是很自然的，所以如果这不起作用，它听起来像是你的 Visual Studio 2010 中严重损坏的东西。我认为您安装了 Visual Studio 2010 来创建 Web 应用程序。您没有解释的是您使用的是哪个版本的 BIDS 或 SSDT。如果您正在为 SSRS 2008 R2 或更早版本开发报告，那么这些报告与 Visual Studio 2010 不兼容。那里没有妥协。

如果您正在为 SSRS 2012 开发，那么您正在使用 SSDT 本身（安装 Visual Studio 2010 的外壳版本）或者如果您已经有 Visual Studio 2010，那么您需要为 VS2010 安装服务包 1，然后从SQL Server 2012 光盘。

[http://msdn.microsoft.com/en-us/library/hh500335(v=vs.103).aspx](http://msdn.microsoft.com/en-us/library/hh500335%28v=vs.103%29.aspx)

# java - 调整某些图像的大小时抛出异常“java.awt.color.CMMException：无效的图像格式”......为什么？

> ID：12288813
> 
> 赞同：6
> 
> 时间：2012-09-05T19:55:43.820
> 
> 标签：java, image, exception, image-processing, awt

从 db 获取图像后，当我尝试调整它的大小时，通过使用下面的代码传递宽度

```
 public static BufferedImage resize(final byte[] pImageData,
                    final int width, final int height, final int maxLength, final int minLength, final String imageSubType) throws Exception {

                InputStream is = null;
                BufferedImage resizeImageJpg = null;
                try {

                    is = new ByteArrayInputStream(pImageData);
                    BufferedImage originalImage = ImageIO.read(is);
                     --------------------

    }
   } 
```

在行抛出以下异常：

```
 BufferedImage originalImage = ImageIO.read(is); 
```

例外：

```
Caused by: java.awt.color.CMMException: Invalid image format
    at sun.awt.color.CMM.checkStatus(CMM.java:131)
    at sun.awt.color.ICC_Transform.<init>(ICC_Transform.java:89)
    at java.awt.image.ColorConvertOp.filter(ColorConvertOp.java:516)
    at com.sun.imageio.plugins.jpeg.JPEGImageReader.acceptPixels(JPEGImageReader.java:1169)
    at com.sun.imageio.plugins.jpeg.JPEGImageReader.readImage(Native Method)
    at com.sun.imageio.plugins.jpeg.JPEGImageReader.readInternal(JPEGImageReader.java:1137)
    at com.sun.imageio.plugins.jpeg.JPEGImageReader.read(JPEGImageReader.java:948)
    at javax.imageio.ImageIO.read(ImageIO.java:1422)
    at javax.imageio.ImageIO.read(ImageIO.java:1326) 
```

关于为什么仅针对某些图像引发此错误的任何想法。图片有什么问题吗。如果是这样，可能的错误是什么

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-09T21:21:54.610

[顺便说一句，这个 CMMException 问题在 JDK8 中得到了修复（注意http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=7064516](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=7064516)底部的提交）。我已经确认[JDK8 的预发布版本可以](https://jdk8.java.net/download.html)正确加载 JDK7 失败的映像，如上所述。

# scala - 为什么向左折叠期望（a -> b -> a）而不是（b -> a -> a）？

> ID：12288818
> 
> 赞同：11
> 
> 时间：2012-09-05T19:56:02.873
> 
> 标签：scala, haskell, functional-programming

我想知道为什么 fold left 期望的函数具有类型签名`a -> b -> a`而不是`b -> a -> a`. 这背后是否有设计决策？

例如，在 Haskell 中，我必须编写`foldl (\xs x -> x:xs) [] xs`反转列表而不是较短的列表`foldl (:) [] xs`（这可以使用`b -> a -> a`）。另一方面，有些用例需要标准`a -> b -> a`. 在 Scala 中，这可能是附加的：`xs.foldLeft(List.empty[Int]) ((xs, x) => xs:+x)`可以写成`xs.foldLeft(List.empty[Int]) (_:+_)`.

是否相应地出现更多的用例需要给定类型签名而不是替代类型签名，或者是否有其他决定导致在 Haskell 和 Scala（可能还有许多其他语言）中进行左折叠的设计？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-09-05T20:29:06.287

从概念上讲，右折叠可以`foldr f z [1..4]`替换以下形式的列表

```
 :
 / \
1   :
   / \
  2   :
     / \
    3   :
       / \
      4  [] 
```

具有以下形式的表达式的值

```
 f
 / \
1   f
   / \
  2   f
     / \
    3   f
       / \
      4   z 
```

如果我们在一行上表示这个表达式，所有的括号都将关联到右边，因此名称为 right fold: `(1 `f` (2 `f` (3 `f` (4 `f` z))))`。左折叠在某种意义上与右折叠是双重的。特别是，我们希望左折叠的相应图表的形状是左折叠的镜像，如下所示：

```
 f
       / \
      f   4
     / \
    f   3
   / \
  f   2
 / \
z   1 
```

如果我们要在一行上写出这个图，我们会得到一个表达式，其中所有括号都与左侧相关联，这与左折叠的名称非常吻合：

```
((((z `f` 1) `f` 2) `f` 3) `f` 4) 
```

但请注意，在这个镜像图中，折叠的递归结果`f`作为第一个参数提供，而列表的每个元素作为第二个参数提供，即`f`与右折叠相比，参数以相反的顺序提供。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-05T20:33:54.597

类型签名是`foldl :: (a -> b -> a) -> a -> [b] -> a`; 组合函数的初始值在左边是很自然的，因为这是它与列表元素组合的方式。同样，您会注意到`foldr`相反。您对 reverse 定义的复杂性是因为您使用的 lambda 表达式`flip`本来会更好：`foldl (flip (:)) [] xs`，它在翻转和反转的概念之间也有令人愉快的相似性。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-05T20:00:03.767

因为你写`(a /: bs)`的`foldLeft`是简写；这是一个推`a`过所有 的运算符`bs`，因此很自然地以相同的方式编写函数（即`(A,B) => A`）。请注意，`foldRight`它是按其他顺序进行的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-06T04:16:07.960

假设你有这个：

```
List(4, 2, 1).foldLeft(8)(_ / _) 
```

这与以下内容相同：

```
((8 / 4) / 2) / 1 
```

看看第一个参数如何总是 te 累加器？按此顺序设置参数使占位符语法（下划线）直接转换为扩展表达式。

# arrays - 使用 JSON 数组和 JSON 对象有什么区别？

> ID：12288820
> 
> 赞同：58
> 
> 时间：2012-09-05T19:56:08.763
> 
> 标签：arrays, json, object

使用 JSON 数组有什么区别和优点：

```
{
   thing:[
     { },
     { }
   ]
} 
```

与 JSON 对象：

```
{
   thing:{
     { },
     { }
   }
} 
```

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-09-05T20:00:21.403

`array`an和 an的区别`object`在于

`key`使用 a等设置对象`value`：

```
person.age = 15; 
```

如果该`key`值是一个变量，那么可以像这样访问它：

```
var key = "age";
alert(person[key]); 
```

数组使用整数 [1] 索引并取值。

```
player[1].score += 1000; 
```

[1] 是的，我知道，在 JavaScript 中，整数索引实际上在幕后变成了字符串。忽略那个。当您想到 JSON 时，尤其是采用整数值的数组。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-12-24T14:23:46.043

对象-键和值，数组-整数。你什么时候用这个或那个？

我认为数组和对象分别是“是一个/一个”和“有一个”。让我们以“水果”为例。

水果数组中的每个项目都是一种水果。

> `array fruit : [orange, mango, banana]`

. 数组可以包含对象、字符串、数字、数组，但我们只处理对象和数组。

> `array fruit : [orange:[], mango:{}, banana:{}]`

. 你可以看到 orange 也是一个数组。这意味着任何变成橙色的项目都是橙色的一种，比如：bitter_orange、mandarin、sweet_orange。

对于水果对象，其中的任何项目都是水果的属性。因此水果有

```
object fruit :{seed:{}, endocarp:{},flesh:{}} 
```

这也意味着种子对象中的任何东西都应该是种子的属性，比如：颜色，

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-09-05T19:58:43.587

JSON 数组表示对象的集合。在 JS 中，有一堆集合函数，例如`slice`, `pop`, `push`. 对象只有更多的原始数据。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-09-05T20:00:47.680

您显示的第二种形式实际上不是有效的 JSON，因为“事物”对象中的每个对象都需要某种排序或属性名称才能访问它。

要回答您的问题，不同之处在于，在第一种情况下，您将使用数组访问（如`obj.thing[0]`or ）访问“事物”中的对象`obj.thing[1]`。在第二种情况下，如果您有适当的属性声明，您可以像这样访问`obj.thing.property`

通常在 JSON 中，数组用于存储一组相似的项目，而对象用于包含单个项目的不同属性的分组。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-05T20:02:05.313

JSON 主要是一种允许将 javascript 对象序列化为字符串的语言。因此，在反序列化 JSON 字符串时，您应该得到一个 javascript 对象结构。如果您的 json 反序列化为一个存储 100 个名为 object1 到 object100 的对象的对象，那么这将非常不方便。大多数反序列化器都希望您拥有已知对象和已知对象数组，以便它们可以将字符串转换为您正在使用的语言中的实际对象结构。这也是面向对象设计哲学会回答你的问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-05-02T21:31:41.257

可以使用以下方式转换 JSON 对象`toJSON`：

```
function kryptonite(key)
   {
   var replacement = {};
   for(var __ in this)
     {
     if(__ in alias)
       replacement[__] = this[__]
     }

   return replacement;
   }

var alias = {"Clark":"","phone":""};
var contact = {
               "Clark":"Kent",
               "Kal El":"Superman",
               "phone":"555-7777"
              }

contact.toJSON = kryptonite;

var foo = JSON.stringify(contact) 
```

可以使用以下方式转换 JSON 数组`map`：

```
 var contact = {
               "Clark":"Kent",
               "Kal El":"Superman",
               "phone":"555-7777",
               "home":[{"present":"Metropolis"},{"past":"Krypton"},{"future":"Phantom Zone"}]

              }

 var filter = {"past":"","future":""}

 function junction(value, index)
   {
   for (var __ in filter) if(value[__]) return value[__]
   } 

var island = contact.home.map(junction); 
```

# embedded-linux - 如何指定线程优先级？

> ID：12288822
> 
> 赞同：1
> 
> 时间：2012-09-05T19:56:22.747
> 
> 标签：embedded-linux, vala

我需要在嵌入式 Linux 目标上运行多个线程。其中一个线程需要大量资源，因此我需要它以低优先级在后台运行。有时更高优先级的线程将无事可做。典型的 vala`Thread.create`如下所示：

```
Thread.create<void*> (pProcessor->run, true); 
```

有没有办法指定线程优先级？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T00:09:29.377

你不能在 GLib 中使用线程的东西，你必须直接使用 pthreads。[这里](https://stackoverflow.com/questions/3649281/how-to-increase-thread-priority-in-pthreads)有一些关于如何在 C 中做到这一点的信息。您还需要为相关函数创建 Vala 绑定，因为还没有人这样做（这很容易......如果您了解 Vala 如何映射到 C 只需要几分钟）。

如果我是你，我会考虑使用优先级队列。如果您不想编写自己的[凹凸](http://code.google.com/p/bump/)，则应该已经拥有您需要的一切（特别是[Semaphore](http://code.coeusgroup.com/bump/valadoc/bump-0.1/Bump.Semaphore.html)和/或[TaskQueue](http://code.coeusgroup.com/bump/valadoc/bump-0.1/Bump.TaskQueue.html)），或者如果您更愿意在较低级别工作，[则为 AsyncPriorityQueue 。](http://code.coeusgroup.com/bump/valadoc/bump-0.1/Bump.AsyncPriorityQueue.html)

# xcode - cv::imread 返回 NULL (XCode)

> ID：12288825
> 
> 赞同：3
> 
> 时间：2012-09-05T19:56:36.360
> 
> 标签：xcode, opencv

我正在尝试使用 cv::imread 在 mac os 10.8 上使用 xcode 4.4 加载图片。我有一个名为 tp 的图片的绝对路径，如下所示：

> ```
> NSString *testPic = [picturesDirectory stringByAppendingPathComponent:@"0.bmp"];
> const char* tp = [testPic cStringUsingEncoding:NSASCIIStringEncoding]; 
> ```

我确定路径是正确的，因为我可以从该路径将图片加载为 UIImage。

然后我有以下代码：

> cv::Mat src = cv::imread(tp);

它返回 NULL (src.data)。

我也试过：

> ```
> IplImage *tmp = cvLoadImage(tp);
> cv::Mat src(tmp); 
> ```

但在第一行执行后 tmp 也为 NULL。

有什么建议吗？

谢谢。

# objective-c - 将 NSString 对象设置为零有意义吗？

> ID：12288828
> 
> 赞同：1
> 
> 时间：2012-09-05T19:56:51.453
> 
> 标签：objective-c, ios, cocoa-touch

在`viewDidUnload`我确实设置`IBOutlets`为零的地方，我也将`NSString`对象设置为零。这些是`(nonatomic,strong)`。`NSString`将对象设置为零是否有意义？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T20:06:10.423

请注意，您没有将任何*对象*设置为`nil`. 您所做的设置`nil`是*指向*您的对象之一的指针，因此它不再指向任何东西。

这意味着，如果您在其他对象中有其他实例变量指向您的字符串，它们将不会看到对象中的任何差异——它们仍将指向相同的旧字符串，具有相同的、未更改的内容。

但是，要回答您的问题：取出变量确实有意义`nil`，但是如果以及当您的视图控制器被释放时，实例变量也将被释放。因此，如果您的琴弦很小，则可能没有迫切需要将`nil`它们放入`viewDidUnload`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T20:04:44.850

`viewDidUnload`，虽然它仍然存在，但应该用于删除您可以在`loadView`或中重新创建的任何内容`viewDidLoad`。

如果字符串属性是视图控制器模型的一部分，并且无法重新创建，则不要删除它们。

该方法不能保证被调用——它只会在视图控制器离开屏幕时被调用，但系统已经受到内存压力。它不像`viewWillAppear`或`viewDidDisappear`。它不应该与您的视图控制器的`dealloc`方法相混淆。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T20:01:17.657

如果您手动管理内存，则不必将插座本身设置为零，只需将与其链接的对象设置为。

例如，如果您有`@property (nonatomic,strong)IBOutlet UIImageView *imageView;`

您只需要将图像视图设置为 nil -`imageView = nil;`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-05T20:11:44.283

`-viewDidUnload`仅用于释放在`-viewDidLoad`或中创建的对象`-loadView`，包括 IBOutlets。

如果您不分配这些字符串，`-loadView`或者`-viewDidLoad`将它们释放在`-viewDidUnload`.

# python - subprocess.check_output 不接受长参数

> ID：12288830
> 
> 赞同：4
> 
> 时间：2012-09-05T19:57:01.320
> 
> 标签：python, subprocess, wkhtmltopdf

如果我在同一台机器上执行以下操作，我会得到预期的漂亮 PDF：

```
$ wkhtmltopdf --title "Transaction 773 (printed version)" --margin-left 5 --margin-right 2 --encoding utf8 www.google.com - > salida.pdf 
```

但是，如果*从一个常见的 python shell*我做：

```
>>> import subprocess
>>> f = open("salida.pdf", "wb")
>>> f.write(subprocess.check_output(["wkhtmltopdf", '--title "Transaction 773 (printed version)"', "--margin-left 5", "--margin-right 2", "--encoding utf8", "www.google.com", "-"])) 
```

然后我得到的只是常见错误：

```
/usr/lib/python2.7/subprocess.pyc in check_output(*popenargs, **kwargs)
    542         if cmd is None:
    543             cmd = popenargs[0]
--> 544         raise CalledProcessError(retcode, cmd, output=output)
    545     return output
    546 

CalledProcessError: Command '['wkhtmltopdf', '--title "Transaction 773 (printed version)"', '--margin-left 5', '--margin-right 2', '--encoding utf8', 'www.google.com', '-']' returned non-zero exit status 1 
```

查看完整的错误消息，它告诉我：

> 未知的长参数 --title “交易 773（印刷版）”

为什么不接受论点？值得一提的是，如果我删除所有参数并只留下输入文件和“-”，它就像魅力一样。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-05T19:58:59.887

您需要在单独的项目中指定每个参数，长参数实际上是*2 个*值：

```
f.write(subprocess.check_output([
    "wkhtmltopdf", 
    '--title', "Transaction 773 (printed version)",
    "--margin-left", "5",
    "--margin-right", "2",
    "--encoding", "utf8",
    "www.google.com", "-"])) 
```

通常，shell 会解析这样的命令行，将其拆分为空格（除非文本已用引号括起来），然后将其作为`argv`值传递给新进程。

现在，您正在自己创建该`argv`列表，并且您必须自己进行拆分。请注意，`--title`因此该参数也不再需要使用 shell 级引号。

一个简短的论点（`-ml5`或类似的）没有那个空格，所以你对这些没有问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T20:00:39.687

`--title "Transaction 773 (printed version)"`是*两个*参数，而不是一个，并且必须以这种方式传递，即作为两个单独的列表项。错误是说没有这样的命令行选项`--title "Transaction 773 (printed version)"`-- 它期望`--title`后跟标题*作为单独的参数。*（此外，您不需要在标题周围加上引号。）

这样做的原因是外壳程序通常处理拆分命令行参数。实际的可执行文件会得到一个 shell 解析的参数列表，并且不需要进一步拆分它们。您在没有外壳的情况下调用可执行文件，因此您必须执行外壳所做的事情。

# c# - 如何在c#中构造范围字符串

> ID：12288833
> 
> 赞同：0
> 
> 时间：2012-09-05T19:57:14.403
> 
> 标签：c#, asp.net

> **可能重复：**
> [将列表转换为数字范围字符串](https://stackoverflow.com/questions/7688881/convert-list-to-number-range-string)

假设我有以下代码：

```
List<int> ints = new List<int>();
//myValues are of type List<string>
for(int i=0; i<myValues.count; i++)
{
  string myVal = myValues[i];
  if (myVal=="testing")
  {
    ints.Add(i+1);
  }
}

String.Join (", ", ints); 
```

这将是这样的：

```
1,2,3,6,7,8,9,10,14 
```

我正在寻找一种方法来显示这样的值：

```
1-3, 6-10, 14 
```

有什么建议么？

# java - 给定一个长度和一组字符，如何获得所有可能的字符串组合

> ID：12288836
> 
> 赞同：3
> 
> 时间：2012-09-05T19:57:28.060
> 
> 标签：java, algorithm

> **可能重复：**
> [生成给定字符串的所有排列](https://stackoverflow.com/questions/4240080/generating-all-permutations-of-a-given-string)

给定一个长度`n=4,` 和 a `set of characters -> {'a', 'b'}`，如何编写一些 java 代码来生成包含集合中字符的长度为 n 的所有可能字符串？

对于上面的示例，结果应该有 2^4=16 个字符串，即：

```
aaaa
aaab
aabb
abbb
baaa
baab
babb
bbbb
bbaa
bbab
bbba
abaa
abab
abba
baba
aaba 
```

这是我的代码片段：

```
public void process(String result, String string)
{
    if(string.length() == 0)
    {
        System.out.println(result);
    }else{
        for(int i = 0; i < string.length(); i++)
        {
            String newResult = new String(result+string.charAt(i));
            String newString = new String(string.substring(0,i) + string.substring(i+1, string.length()));
            process(newResult, newString);
        }
    }
} 
```

这似乎只是做排列，而不是我想要的......提前谢谢你:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-05T20:02:04.280

以与计算相同的方式思考它。从技术上讲，您从 aaaa 到 bbbb “计数”，就像二进制一样。

```
aaaa -> 0000
aaab -> 0001
aaba -> 0010
aabb -> 0011
...
bbbb -> 1111 
```

在没有看到您尝试过的内容的情况下，我无法为您提供更多帮助，但基本上您需要通过计数来枚举“最低”元素和“最高”元素之间的所有“数字”。

对于更高的元素计数，只需将您的计数视为在更高的基数中计数。对于八个元素，Set = {a, b, c, d, e, f, g, h}，你会在本质上是八进制数：

```
aaaa -> 0000
aaab -> 0001
...
aaah -> 0007
aaba -> 0010
...
hhhh -> 7777 
```

这与您通过从 0000 计数到 9999 来枚举长度为 4 的 0-9 的所有组合的方式相同。

**编辑：**

感谢您发布您的代码。你是对的，你正在做排列。[更好的方法是使用这里](http://www.martinbroadhurst.com/combinatorial-algorithms.html#multicombinations)讨论的多重组合（与 ordererd 组合集中的重复元素组合）算法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T20:45:09.637

这可能很容易出错，因为我没有测试过，但它应该可以工作。即使没有，它也应该非常接近您正在寻找的内容。请注意，第一个 for 循环会填充 resultList 而不是设置值，因为不会有任何内容可附加。

让我知道是否有问题，我会纠正它。

```
ArrayList<String> results = new ArrayList<String>();
ArrayList<String> components = new ArrayList<String>(){"a","b","c"};
int n = 4;

int size = components.size();
for ( int j = 0; j < size; j++ )
{
  // start with size^(n-1) copies of each letter. 
  for ( int i = 0; i < Math.pow( size, n-1); i++ )
  {
    results.add( components.get( j ) );
  }
}

// At this point you have each letter in there once...

for( int depth = 1; depth < n; depth++ )
{
  for( int j = 0; j < size; j++ )
  {
    String toAppend = components.get( j );
    for( int i = j; i < results.size(); i += size )
    {
      String current = results.get( i );
      current += toAppend;
      results.set( i, current );
    }
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T20:55:28.617

您已经得到了答案，但我觉得您需要更多帮助：

```
if(string.length() == 0)
{
System.out.println(result);
} 
```

为什么要打印一个空字符串？它根本不会打印任何内容。您可能想要打印一条消息并退出您的功能。

# wcf - 无法通过 IIS 中的 net.tcp 绑定调用 WCF 服务

> ID：12288838
> 
> 赞同：2
> 
> 时间：2012-09-05T19:57:37.530
> 
> 标签：wcf, iis

a) 我有一个 WCF 服务，在 Windows 服务中自行托管，在 Windows 2008 R2 机器 A 上。它使用 net.tcp 绑定。不共享端口。

b）我有一个在 Windows 2008 R2 机器 B 上的 IIS 上运行的 ASP.Net 网站（作为 ApplicationPoolIdentity，尽管我怀疑是否相关），它必须调用机器 A 上的服务。

我收到此错误：

> System.ServiceModel.CommunicationException：套接字连接已中止。这可能是由于处理您的消息时出错或远程主机超出接收超时，或者是潜在的网络资源问题造成的。本地套接字超时为“00:01:00”。---> System.IO.IOException: 读操作失败，见内部异常。---> System.ServiceModel.CommunicationException：套接字连接被中止。这可能是由于处理您的消息时出错或远程主机超出接收超时，或者是潜在的网络资源问题造成的。本地套接字超时为“00:01:00”。---> System.Net.Sockets.SocketException: 远程主机在 System.Net.Sockets.Socket.Receive(Byte[] buffer, Int32 offset, Int32 size,
> 
> 服务器堆栈跟踪：在 System.ServiceModel.Channels.StreamConnection.Read（Byte[] 缓冲区，Int32 偏移量，Int32 大小，TimeSpan 超时）在 System.ServiceModel.Channels.ClientFramingDuplexSessionChannel.SendPreamble（IConnection 连接，ArraySegment`1 前导码，TimeoutHelper 和 timeoutHelper ) 在 System.ServiceModel.Channels.ConnectionPoolHelper.EstablishConnection(TimeSpan timeout) 在 System.ServiceModel.Channels.ClientFramingDuplexSessionChannel.OnOpen(TimeSpan timeout) 在 System.ServiceModel.Channels.ClientFramingDuplexSessionChannel.DuplexConnectionPoolHelper.AcceptPooledConnection(IConnection 连接，TimeoutHelper 和 timeoutHelper) 在 System .ServiceModel.Channels.CommunicationObject.Open(TimeSpan timeout) at System.ServiceModel.Channels.ServiceChannel.OnOpen(TimeSpan timeout) at System。ServiceModel.Channels.CommunicationObject.Open(TimeSpan timeout) at System.ServiceModel.Channels.ServiceChannel.CallOpenOnce.System.ServiceModel.Channels.ServiceChannel.ICallOnce.Call(ServiceChannel channel, TimeSpan timeout) at System.ServiceModel.Channels.ServiceChannel.CallOnceManager .CallOnce(TimeSpan timeout, CallOnceManager cascade) at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs, TimeSpan timeout) at System.ServiceModel.Channels.ServiceChannelProxy .InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation) at System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage message)ServiceModel.Channels.ServiceChannel.ICallOnce.Call(ServiceChannel channel, TimeSpan timeout) at System.ServiceModel.Channels.ServiceChannel.CallOnceManager.CallOnce(TimeSpan timeout, CallOnceManager cascade) at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean单向，ProxyOperationRuntime 操作，Object[] 输入，Object[] 输出，TimeSpan 超时）在 System.ServiceModel.Channels.ServiceChannelProxy.InvokeService（IMethodCallMessage methodCall，ProxyOperationRuntime 操作）在 System.ServiceModel.Channels.ServiceChannelProxy.Invoke（IMessage 消息）ServiceModel.Channels.ServiceChannel.ICallOnce.Call(ServiceChannel channel, TimeSpan timeout) at System.ServiceModel.Channels.ServiceChannel.CallOnceManager.CallOnce(TimeSpan timeout, CallOnceManager cascade) at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean单向，ProxyOperationRuntime 操作，Object[] 输入，Object[] 输出，TimeSpan 超时）在 System.ServiceModel.Channels.ServiceChannelProxy.InvokeService（IMethodCallMessage methodCall，ProxyOperationRuntime 操作）在 System.ServiceModel.Channels.ServiceChannelProxy.Invoke（IMessage 消息）System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation) 处 System.ServiceModel.Channels 处的 ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs, TimeSpan timeout)。 ServiceChannelProxy.Invoke（IMessage 消息）System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation) 处 System.ServiceModel.Channels 处的 ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs, TimeSpan timeout)。 ServiceChannelProxy.Invoke（IMessage 消息）

这看起来像一个连接/防火墙问题，但它不是，因为：

c) 我制作了一个简单的 winforms 应用程序，它使用与 (b) 完全相同的代码来调用机器 A 上的 WCF 服务。它在机器 B 上运行时成功。

(b) 和 (c) 都在代码中创建 WCF 代理，而不使用 web.config/app.config 中的任何内容。他们都对端点使用相同的 URI

因此，IIS 进行 net.tcp 调用和常规应用程序之间一定存在一些区别......？有什么与此相关的安全性吗？

为了以防万一，我尝试启用通常需要在 IIS 中托管的所有 Windows 服务（WAS、网络适配器侦听器、端口共享......），但没有任何区别。

非常感谢您的意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-23T16:35:04.670

您必须将绑定安全设置为无。

```
 <netTcpBinding >
    <binding name="MyServer" >
      <security mode="None" />
    </binding>
  </netTcpBinding> 
```

# cassandra - Cassandra 的可用性

> ID：12288841
> 
> 赞同：7
> 
> 时间：2012-09-05T19:58:21.367
> 
> 标签：cassandra, hector, cassandra-0.7

我遇到了一个问题“me.prettyprint.hector.api.exceptions.HUnavailableException: : 可能没有足够的副本来处理一致性级别。” 当我的 RF = 1 时，读取一致性级别 = 1 并且 6 节点环/集群中的一个节点已关闭。我所有的阅读都失败了这个例外。任何的想法？理想情况下，只有在已关闭节点中查找数据的读取才会失败，而所有其他读取都应该成功？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-06T01:33:06.117

可能有几种可能：

*   您正在运行需要多个节点启动的多行查询（get_range、get_indexed_slices、multiget 或 cql 等效项）
*   您的集群不平衡，down 节点拥有大部分环；一个糟糕的多直流配置也可能产生类似的东西
*   您的集群一开始就处于不好的状态，有些节点看不到其他节点。确保 nodetool ring 在对集群中的每个节点运行时显示相同的输出

如果这些都不是原因，请仔细检查您是否使用 Hector 和 cqlsh 正确指定了一致性级别。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-06T15:44:31.573

当我错误地配置我的复制设置时，我看到了类似的情况，特别是我有错误的数据中心命名为复制策略。仔细检查您的 DC 是什么（假设您使用的是 NetworkTopologyStrategy）。

如果您还不知道您的 DC 名称，请在其中一个节点上的 shell 中运行：

```
$ nodetool -h localhost ring
Address         DC          Rack        Status State   Load            Owns    Token                                       
                                                                               141784319550391000000000000000000000000     
172.26.233.135  Cassandra   rack1       Up     Normal  25.75 MB        16.67%  0                                           
172.26.233.136  Cassandra   rack1       Up     Normal  26.03 MB        16.67%  28356863910078200000000000000000000000      
172.26.233.137  Cassandra   rack1       Up     Normal  27.19 MB        16.67%  56713727820156400000000000000000000000      
172.26.233.138  Cassandra   rack1       Up     Normal  26.78 MB        16.67%  85070591730234600000000000000000000000      
172.26.233.139  Solr        rack1       Up     Normal  24.47 MB        16.67%  113427455640313000000000000000000000000     
172.26.233.140  Solr        rack1       Up     Normal  26.66 MB        16.67%  141784319550391000000000000000000000000 
```

您可以看到我们有两个 DC，Cassandra 和 Solr（这是一个 DSE 集群）。

在 cassandra-cli 中：

```
use Keyspace1;
describe; 
```

CLI 将打印策略选项：

```
Keyspace: Catalog:
  Replication Strategy: org.apache.cassandra.locator.NetworkTopologyStrategy
  Durable Writes: true
    Options: [DC1:3]
... 
```

我们有错位。Cassandra 正在寻找一个名为 DC1 的数据中心，因此出现了 UnavailableException。我们需要更新复制选项以匹配集群中的实际 DC。在 CLI 中，使用数据中心名称更新键空间的策略选项：

```
update keyspace Keyspace1 with strategy_options = {Cassandra:3,Solr:2}; 
```

# android - Android gridview 方向

> ID：12288850
> 
> 赞同：-1
> 
> 时间：2012-09-05T19:59:31.077
> 
> 标签：android, android-lifecycle, android-configchanges

嗨，我有具有自定义布局的gridview，自定义布局是一个框架布局，它有两个按钮，一个按钮只有在使用单击其他按钮时才可见......就像用户可以点击一个数字（我正在尝试要清楚，如果有人不明白，请告诉我）......现在我的问题是......我如何保存活动的状态。我希望用户删除与横向或纵向模式相同数量的按钮......即使他改变了平板电脑的方向。

最后，当用户改变方向时，我如何确保活动保持在相同的状态......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T20:20:16.367

看一下 Activity 上的方法覆盖。

[http://developer.android.com/reference/android/app/Activity.html](http://developer.android.com/reference/android/app/Activity.html)

具体来说，您需要[http://developer.android.com/reference/android/app/Activity.html#ConfigurationChanges](http://developer.android.com/reference/android/app/Activity.html#ConfigurationChanges)

请参阅 onSaveInstanceState。祝你好运。

# javascript - Rails：将资产管道中的纯 JavaScript 限制为特定视图

> ID：12288852
> 
> 赞同：1
> 
> 时间：2012-09-05T19:59:38.277
> 
> 标签：javascript, ruby-on-rails, ruby-on-rails-3, amcharts

我正在尝试将我的 AMChart 纯 javascript 从我的视图中取出并放入我的控制器的 assets/javascripts/ 中的 .js 文件中，因为 Rails 喜欢它。

我在两个单独的视图上有两个单独的图表，每个视图都有不同的配置和数据源。

我的问题是，当访问一个视图时，我收到一个 javascript 错误，指出包含*另一个视图*的图表数据的变量“未定义”——所有低于此错误的 javascript 都将被中止。

AMChart javascript 只是纯 javascript（没有 jquery），在我的控制器的两个图表的 .js 文件中看起来像这样：

```
/// Radar Chart for First View

  var chart;

  AmCharts.ready(function () {
    // RADAR CHART
    chart = new AmCharts.AmRadarChart();
    chart.dataProvider = chartData_radar1;  // <- data variable
    chart.categoryField = "criteria";
    chart.startDuration = 1;
    chart.startEffect = ">";
    chart.sequencedAnimation = true;

    // VALUE AXIS
    var valueAxis = new AmCharts.ValueAxis();
    valueAxis.gridType = "circles";
    valueAxis.fillAlpha = 0.02;
    valueAxis.fillColor = "#000000"
    valueAxis.axisAlpha = 0.1;
    valueAxis.gridAlpha = 0.1;
    valueAxis.fontWeight = "bold"
    valueAxis.minimum = 0;
    valueAxis.maximum = 10;
    chart.addValueAxis(valueAxis);

    // GRAPH
    var graph = new AmCharts.AmGraph();
    graph.lineColor = "#98cdff"
    graph.fillAlphas = 0.4;
    graph.bullet = "round"
    graph.valueField = "score"
    graph.balloonText = "[[category]]: [[value]]/10"
    chart.addGraph(graph);

    // Balloon Settings
    var balloon = chart.balloon;
    balloon.adjustBorderColor = true;
    balloon.color = "#000000";
    balloon.cornerRadius = 5;
    balloon.fillColor = "#000000";
    balloon.fillAlpha = 0.7
    balloon.color = "#FFFFFF"

    // WRITE
    chart.write("chartdiv");
  });

/// Radar Chart for Second View

  var chart;

  // Draw AM Radar Chart
  AmCharts.ready(function () {
    // RADAR CHART
    chart = new AmCharts.AmRadarChart();
    chart.dataProvider = chartData_radar2;  // <- data variable
    chart.categoryField = "criteria";
    chart.startDuration = 0.3;
    chart.startEffect = ">";
    chart.sequencedAnimation = true;

    // GRAPH - FIRST 5
    var graph = new AmCharts.AmGraph();
    graph.title = "First 5";
    graph.lineColor = "#bdd523"
    graph.fillAlphas = 0.2;
    graph.bullet = "round"
    graph.valueField = "first5"
    graph.balloonText = "[[category]]: [[value]]/10"
    chart.addGraph(graph);

    // GRAPH - LAST 5
    var graph = new AmCharts.AmGraph();
    graph.title = "Last 5";
    graph.lineColor = "#98cdff"
    graph.fillAlphas = 0.2;
    graph.bullet = "round"
    graph.valueField = "last5"
    graph.balloonText = "[[category]]: [[value]]/10"
    chart.addGraph(graph);

    // VALUE AXIS
    var valueAxis = new AmCharts.ValueAxis();
    valueAxis.gridType = "circles";
    valueAxis.fillAlpha = 0.02;
    valueAxis.fillColor = "#000000"
    valueAxis.axisAlpha = 0.1;
    valueAxis.gridAlpha = 0.1;
    valueAxis.fontWeight = "bold"
    valueAxis.minimum = 0;
    valueAxis.maximum = 10;
    chart.addValueAxis(valueAxis);

    // Balloon Settings
    var balloon = chart.balloon;
    balloon.adjustBorderColor = true;
    balloon.color = "#000000";
    balloon.cornerRadius = 5;
    balloon.fillColor = "#000000";
    balloon.fillAlpha = 0.7
    balloon.color = "#FFFFFF"

    // Legend Settings
    var legend = new AmCharts.AmLegend();
    legend.position = "bottom";
    legend.align = "center";
    legend.markerType = "square";
    legend.rollOverGraphAlpha = 0;
    legend.horizontalGap = 5;
    legend.valueWidth = 5;
    legend.switchable = false;
    chart.addLegend(legend);

    // WRITE
    chart.write("chart_radar");
  }); 
```

（由于缺乏从我的模型中获取数据到 js 方法中的更好方法，我在视图中定义了“chartData_radar1”或“chartData_radar2”（例如在上面的第 7 行中调用），例如）

```
:javascript
  var chartData_radar1 = #{Case.chart_analysis_radar(current_user)}; 
```

我并不是在寻找一种破解/解决方法来让它工作，而是更多地知道在资产管道中处理像这样的纯 JavaScript 的 Rails 方法是什么？有没有一种好方法可以根据视图仅加载一个雷达的 javascript，而不必将其放入视图本身？我知道如果您使用 Jquery 选择器，您可以有选择地加载部分 javascript，我可以例如以某种方式将这些全部打包到 jquery 选择器中吗？

任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-09-23T17:19:40.050

尽管这个问题已经很老了，但我会尝试回答 - 可能会对某人有所帮助。

本质上，您要做的是通过全局变量将数据从 Rails 视图或控制器发送到 Javascript：

```
:javascript
    window.chartData = #{JSON.stringify(@your_data)}; 
```

然后在你的任何 JS 文件中`assets/javascripts/`你都可以访问这个变量。但是，请确保您在页面加载后访问它（所以使用 jQuery`$( document ).ready( function() { ... } )`或者`window.onload = ...`如果您不使用 jQuery）：

```
$( document ).ready( function() {
    ...
    var chart = new AmCharts.AmRadarChart();
    chart.dataProvider = window.chartData;
    ...
}); 
```

或者

```
window.onload = function () {
    ...
    var chart = new AmCharts.AmRadarChart();
    chart.dataProvider = window.chartData;
    ...
}; 
```

你也可以更进一步。您可以将这样的内容直接添加到您的布局中：

```
:javascript
    window.config = #{JSON.stringify(@js_config || {})}; 
```

然后在您的任何控制器方法中，您需要做的就是：

```
@js_config[:chart_data] = some_chart_data 
```

现在您可以在任何 javascript 中访问它：

```
console.log(window.config.chart_data) 
```

在这种情况下，是否需要等待页面加载取决于您是在 head 还是 body 中定义了配置变量。

# xml - 如何使用 XSL 解析带有图像 url 的分隔列表？

> ID：12288857
> 
> 赞同：3
> 
> 时间：2012-09-05T19:59:59.707
> 
> 标签：xml, parsing, xslt, delimited

我有一个列表，其中包含我想使用 XSL 解析和显示的图像的 url，但我只想要前 3 个图像。

例如

```
<xsl:value-of select="@Icons" /> 
```

回报：

```
['http://www.test.com/image1.jpg',
 'http://www.test.com/image2.jpg',
 'http://www.test.com/image3.jpg',
 'http://www.test.com/image4.jpg',
 'http://www.test.com/image5.jpg'] 
```

最终输出应该是：

```
<img src="http://www.test.com/image1.jpg" alt=""/>
<img src="http://www.test.com/image2.jpg" alt=""/>
<img src="http://www.test.com/image3.jpg" alt=""/> 
```

我有部分代码可以选择前 3 个项目，但我不确定如何解析列表并在 html 中显示图像。

```
<xsl:template name="recurse_till_ten">
    <xsl:param name="num">1</xsl:param>
    <xsl:if test="not($num = 3)">
        //Parasing list here
        <xsl:call-template name="recurse_till_ten">
            <xsl:with-param name="num">
                <xsl:value-of select="$num + 1">
            </xsl:with-param>
        </xsl:call-template>
    </xsl:if>
</xsl:template> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T01:03:06.290

# XSLT 1.0 解决方案

这个 XSLT 1.0 样式表...

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="xml" indent="yes" omit-xml-declaration="yes" />
<xsl:strip-space elements="*" />

<xsl:template match="/">
 <xsl:variable name="strip-chars" select="&quot;[]''&quot;" /> 
 <xsl:for-each select="*">
   <xsl:copy>
     <xsl:call-template name="tokenize">
       <xsl:with-param name="content" select="concat(translate(@Icons,$strip-chars,''),',')" />
       <xsl:with-param name="count" select="3" />
     </xsl:call-template>
   </xsl:copy>
  </xsl:for-each>
</xsl:template>

<xsl:template name="tokenize">
  <xsl:param name="content" />
  <xsl:param name="count" />
  <xsl:if test="contains($content,',') and $count > 0">
    <img src="{substring-before($content,',')}" alt="" />
    <xsl:call-template name="tokenize">
      <xsl:with-param name="content" select="normalize-space(substring-after($content,','))" />
      <xsl:with-param name="count" select="$count - 1" />
    </xsl:call-template>
  </xsl:if>  
</xsl:template>

</xsl:stylesheet> 
```

...当应用于此输入文档时...

```
<t Icons="['http://www.test.com/image1.jpg',
 'http://www.test.com/image2.jpg',
 'http://www.test.com/image3.jpg',
 'http://www.test.com/image4.jpg',
 'http://www.test.com/image5.jpg']"/> 
```

...将产生...

```
<t>
  <img src="http://www.test.com/image1.jpg" alt="" />
  <img src="http://www.test.com/image2.jpg" alt="" />
  <img src="http://www.test.com/image3.jpg" alt="" />
</t> 
```

当应用于这个简短的输入文档时......

```
<t Icons="['http://www.test.com/image1.jpg',
 'http://www.test.com/image2.jpg']"/> 
```

...产量...

```
<t>
  <img src="http://www.test.com/image1.jpg" alt="" />
  <img src="http://www.test.com/image2.jpg" alt="" />
</t> 
```

## 笔记

在编辑时，Suresh 的解决方案不适用于图像数量为 3 或更少的第二个用例。

* * *

# XSLT 2.0 解决方案

使用具有这样的样式表的 XSLT 2.0 可以更简单、更有效和更可扩展地达到相同的结果......

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="xml" indent="yes" omit-xml-declaration="yes" />
<xsl:strip-space elements="*" />

<xsl:template match="/">
 <xsl:for-each select="*">
   <xsl:copy>
    <xsl:variable name="image-elements" as="element()*">
      <xsl:analyze-string select="@Icons" regex="'([^']*)'(,|\])" >
       <xsl:matching-substring>
         <img src="{regex-group(1)}" alt="" />
       </xsl:matching-substring>
      </xsl:analyze-string>
    </xsl:variable>
    <xsl:copy-of select="$image-elements[not(position() > 3)]" />
   </xsl:copy>
  </xsl:for-each>
</xsl:template>

</xsl:stylesheet> 
```

* * *

# XSLT 2.0 XPATH 解决方案

出于兴趣，这里是使用纯 XPATH 的 XSLT 2.0 的变体。

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="xml" indent="yes" omit-xml-declaration="yes" />
<xsl:strip-space elements="*" />

<xsl:template match="/">
 <xsl:for-each select="*">
   <xsl:copy>
    <xsl:for-each select="(for $i in tokenize(@Icons,',') return
                           replace($i,'.*''([^'']*)''.*','$1'))
                            [not(position() > 3)]">
      <img src="{.}" alt="" />
    </xsl:for-each>
   </xsl:copy>
  </xsl:for-each>
</xsl:template>

</xsl:stylesheet> 
```

* * *

# 更新和评论 Dimitre 的解决方案

祝贺 Dimitre 提供了更简洁的 XSLT 2.0 解决方案。他使用了与我的稍有不同的输入，其中没有方括号。查看 Dimitre 的解决方案，我可以看到一个调整，使其更小。

这个 XSLT 2.0 样式表是对 Dimitre 解决方案的调整，是所有解决方案中最严格的，作为奖励，它适用于我的输入文档形式和他的形式，以生成相同且正确的结果文档。

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output omit-xml-declaration="yes" indent="yes"/>

<xsl:template match="/">
  <xsl:for-each select="tokenize(/*/@Icons, '\[?\s*''\s*,?\]?')[.][position() le 3]">
   <img src="{.}" alt=""/>
  </xsl:for-each>
 </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T04:57:54.797

**一个更短的 XSLT 2.0 解决方案**：

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:variable name="vDelims">\s*'\s*,?</xsl:variable>
 <xsl:variable name="vTokens" select="tokenize(/*/@Icons, $vDelims)[.]"/>

 <xsl:template match="/*">
  <xsl:for-each select="$vTokens[position() le 3]">
   <img src="{.}" alt=""/>
  </xsl:for-each>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于以下 XML 文档时：**

```
<t Icons=
 "'http://www.test.com/image1.jpg',
  'http://www.test.com/image2.jpg',
  'http://www.test.com/image3.jpg',
  'http://www.test.com/image4.jpg',
  'http://www.test.com/image5.jpg'"/> 
```

**产生了想要的正确结果**：

```
<img src="http://www.test.com/image1.jpg" alt=""/>
<img src="http://www.test.com/image2.jpg" alt=""/>
<img src="http://www.test.com/image3.jpg" alt=""/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T20:17:22.940

使用标记化功能。[在http://www.xml.com/pub/a/2003/05/07/tr.html](http://www.xml.com/pub/a/2003/05/07/tr.html)上有一篇关于标记化的好文章。（或者）

用这个

```
<?xml version="1.0" standalone="yes"?> 
<xsl:stylesheet
 version="1.0"
   xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:template match="/">
   <xsl:variable name="v" select="data/text()"/>
      <list>

      <xsl:call-template name="parse">
        <xsl:with-param name="in" select="normalize-space(translate($v,'[]',''))"/>
        <xsl:with-param name="num">0</xsl:with-param>
      </xsl:call-template>  
  </list> 
</xsl:template>

<xsl:template name="parse">
    <xsl:param name="in"/>
    <xsl:param name="num"/>
    <xsl:variable name="char">'</xsl:variable>
    <xsl:if test="$num &lt; 3">
        <xsl:element name="image">
           <xsl:attribute name="href"><xsl:value-of select="translate(substring-before($in,','),$char,'')"/></xsl:attribute>
        </xsl:element>
      <xsl:call-template name="parse">
        <xsl:with-param name="in" select="substring-after($in,',')"/>
        <xsl:with-param name="num"><xsl:value-of select="$num + 1"/></xsl:with-param>
      </xsl:call-template>  
    </xsl:if>
</xsl:template>

</xsl:stylesheet> 
```

# windows-runtime - 如何检测用户是否关闭了 winrt 应用程序

> ID：12288858
> 
> 赞同：2
> 
> 时间：2012-09-05T20:00:00.523
> 
> 标签：windows-runtime, windows-store-apps

检测用户是否使用 ALT-F4 或关闭手势关闭应用程序的可靠（且立即）方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-06T12:58:33.350

并不是对我的具体问题的确切答案，而是一种解决我发布问题的具体问题的方法。也许它可以帮助别人：

注册到`Window.CoreWindow.VisibilityChanged`：

```
Window.Current.CoreWindow.VisibilityChanged += CoreWindow_VisibilityChanged; 
```

如果可见性已更改为 false，这可能是由于应用程序关闭所致。请注意，该事件也会因许多其他原因而触发，例如通过 ALT-Tab 更改窗口：

```
 void CoreWindow_VisibilityChanged(CoreWindow sender, VisibilityChangedEventArgs args) {
        if(!args.Visible){
           // Action here
        }
 } 
```

*请注意：我怀疑 MS 没有明确提供我正在寻找的事件，因为在用户关闭应用程序的那一刻进行的繁重操作会导致用户体验不太流畅。但是，我认为在某些符合条件的情况下，这样的事件是有意义的，因此人们会使用我在此处提供的解决方法。如果您使用此解决方法或其他解决方法，请注意不要给系统造成沉重负载。*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-05T22:28:09.663

根据[应用程序生命周期](http://msdn.microsoft.com/en-us/library/windows/apps/hh464925.aspx)文档，无法检测到此事件（请参阅“应用程序关闭”部分）。[使用ApplicationData](http://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.applicationdata.aspx)类可以最好地管理这种类型的状态。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-27T07:09:31.937

毫无疑问，您不想一直保存状态以防应用程序被挂起。难道这不会被称为“轮询”（这在其他方面有点糟糕和浪费）？在我的场景中，我有一个跟踪剩余时间的计时器，这是应用程序状态的一部分，但我不想在每次滴答时都存储它。

因此，要正确执行此操作，您需要：

1.  跟踪 VisibilityChanged（如原始海报所述）
2.  跟踪卸载（每当您从页面导航返回等时）
3.  跟踪页面何时被卸载，这样您就不会保存可能挂起的陈旧缓存页面

要详细说明上面的＃3 - 我发现如果我从 A -> B 向前导航，然后返回 A，然后再次导航到 B，我最终会得到另一个缓存页面 B。然后当用户离开应用程序时，我会触发多个 VisibilityChanged 事件，其中一些包括我认为会被销毁但没有被销毁的旧缓存页面。

这是对我有用的代码：

```
public void MyPage() // Constructor
{
  Loaded += (sender, e) =>
  {
    if(!m_isLoaded)
    {
      m_isLoaded = true;

      Window.Current.CoreWindow.VisibilityChanged +=
          OnVisibilityChanged;
    }
  };

  Unloaded += async (sender, e) => 
  {
    if (m_isLoaded)
    {
      m_isLoaded = false;

      Window.Current.CoreWindow.VisibilityChanged -= 
          OnVisibilityChanged;

      await SaveStuff();
    }
  };
}

protected void OnVisibilityChanged(object sender,
  Windows.UI.Core.VisibilityChangedEventArgs e)
{
  if (!e.Visible && m_isLoaded)
  {
    var dontAwait = SaveStuff();
  }
}

// Called whenever the page is unloaded and state needs to be saved.
protected async Task SaveStuff()
{
  await ThreadUtility.voidTask();
}

// Set to false when the page is unloaded (paused).
private bool m_isLoaded = false; 
```

# php - 在 include 中请求 PHP 变量，在 include 外部定义

> ID：12288862
> 
> 赞同：0
> 
> 时间：2012-09-05T20:00:06.310
> 
> 标签：php, variables, include

这里有点问题，我有一个包含以下代码的文件：

```
<?php 
$kvkvariable = 000050650459;   
include("../../../../../../httpdocs/profiel/indextemplate.php"); 
?> 
```

在包含的 PHP 文件中，我需要`$kvkvariable`. 但是，当我回显这个变量时，它没有显示我希望它显示的数字？

如果我放置`$kvkvariable`内部的定义代码，`indextemplate.php`它工作正常。我认为包含与将代码粘贴到同一文件中相同吗？我该如何解决？

谢谢！

编辑：

indextemplate.php 立即以此开头：

```
<?php

echo "Dit is kvk: ".$kvkvariable.""; 
```

它给出以下结果：

```
Dit is kvk: 1337893 
```

老实说，我不知道他从哪里得到这个号码！？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T21:00:57.053

```
<?php 
$kvkvariable = 000050650459;   
include("../../../../../../httpdocs/profiel/indextemplate.php"); 
?> 
```

当 PHP 看到一个以 0 开头的数字时，它会假定它是八进制的 - 如果你通过八进制到十进制转换器运行 000050650459，它会给你 1337893。

因此，您的包含按预期工作；这是 PHP 的变量类型，它没有达到你的预期。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T01:49:48.903

怎么样：

```
<?php
$kvkvariable = 000050650459;   
include( "../../../../../../httpdocs/profiel/indextemplate.php?myvar=" . $kvkvariable ); 
?> 
```

并且您将包含中的变量视为`$_GET[ 'myvar' ]`

那么你的第二个文件应该是这样的：

```
<?php
echo "Dit is kvk: " . $_GET[ 'myvar' ] . ""; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T20:05:05.270

尝试使用[php 的`global`关键字](http://www.php.net/manual/en/language.variables.scope.php)。

```
<?php 
global $kvkvariable;
$kvkvariable = 000050650459;   
include("../../../../../../httpdocs/profiel/indextemplate.php"); 
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-05T21:01:39.800

我自己的问题的答案相当简单，在定义变量的数字周围使用“”！我的坏..也许这可以帮助别人！

# xmlhttprequest - xhr 上传 - 如果大小大于 16mb，则失败

> ID：12288863
> 
> 赞同：0
> 
> 时间：2012-09-05T20:00:08.453
> 
> 标签：xmlhttprequest, plupload

我正在开发拖放文件应用程序。如果它们小于 16mb，我的上传总是有效，但如果它们更多，则永远不会发送 ajax 请求（firebug 中没有 POST 条目）。我发现即使我使用库来完成任务（例如，plupload）也是如此。我可以使用普通的旧表单提交来上传大文件。

我可以使用分块来解决这个问题，但是在最后一个块完成后我必须重新组装到文件中，这似乎需要更多的工作。

有任何想法吗？

```
$(document).on('drop', function(){  
  e.preventDefault();
  var xhr = new XMLHttpRequest();  
  attachment_form = document.getElementById('brief_form')

  form = new FormData(attachment_form)
  form.append('attachents[0][image]',e.originalEvent.dataTransfer.files[0] )

  url = $(attachment_form).attr("action")
  text = ''
  xhr.open("POST", url)
  xhr.setRequestHeader("Accept", "text/javascript");
  xhr.send(form)
}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T22:16:35.697

事实证明，Firebug 是罪魁祸首。至少为我的开发站点禁用它会使问题消失。

如果它至少给出某种警告就好了。

# node.js - 自动将“技术”应用于查询文档

> ID：12288864
> 
> 赞同：0
> 
> 时间：2012-09-05T20:00:13.180
> 
> 标签：node.js, mongoose

我正在使用 node.js+mongoose+websocket（它只是后端-主要用于培训）制作爱好的“civlike”游戏，并且我坚持使用“技术”-不知道如何实现它们。

第一个想法是“重载”一个 exec() 方法，并添加如下内容：

```
Techs.apply(result); 
```

，但不能那样做 - 它是异步的，并且 exec() 无法访问返回的文档。

没有它，我每次查询文档时都必须手动应用它们——但我认为这不是最好的方法，也许我错了，或者这是唯一的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T23:28:09.667

因为它是异步的，所以你必须在你的回调函数中处理文档。我认为你想要做的是这个。

# 通过文档的 ID 获取文档

```
 // docId is the _id passed from the client
    Techs.findById(docId, function(err, doc) {

        // This code executes after we've returned from MongoDB with the answer
        // Now you can either updated it some code like this
        doc.title = 'new title';

        // Then after you've updated you need to call the save() function
        doc.save();

        // Now send the response to the client
        response.end(doc); // this will send the JSON of the doc to the client

    }); 
```

## 或者

# 按字段搜索一个文档（类型：'iphone'）

```
 // Find a document based on a query
    Techs.findOne({type: 'iphone' }, function(err, doc) {

        // This code executes after we've returned from MongoDB with the answer
        // Now you can either updated it some code like this
        doc.title = 'new title';

        // Then after you've updated you need to call the save() function
        doc.save();

        // Now send the response to the client
        response.end(doc); // this will send the JSON of the doc to the client

    }); 
```

# sql - 如何检查 SQL 插入语句中字段的子字符串？

> ID：12288868
> 
> 赞同：0
> 
> 时间：2012-09-05T20:00:21.843
> 
> 标签：sql

我需要帮助尝试根据序列号匹配执行插入语句。表“ `EDI40025.Bundle_Serial_Num`”中的字段为 20 个字符，“ `SerialNumber.Text`”为 6 个字符。我可以以某种方式获取 Bundle_Serial_Num 的子字符串，以便我只检查 6 个字符以匹配文本字段吗？

例如 my `Bundle_Serial_Num`is`"UNS40000000000447022"`和 SerialNumber.Text is `"447022"`。我想将最后 6 个`Bundle_Serial_Num`与文本字段中的 6 个进行比较。

```
string sql = @"INSERT INTO EDI40021 (Vendor_Order, BOL_Num, Cust_Part_Num)  
             WHERE (EDI40025.Bundle_Serial_Num = '" + SerialNumber.Text + "')"; 
```

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T20:01:59.653

使用该`RIGHT`功能抓取序列号的最后六个字符。

```
WHERE (RIGHT(EDI40025.Bundle_Serial_Num, 6) = '" + SerialNumber.Text + "')"; 
```

但是，如果可能，您很可能希望将查询重写为参数化查询，因为您目前容易受到 SQL 注入攻击。

此外，您的查询看起来不太正确，因为您不是`SELECTING`来自表 EDI40025。

# android - Android：在屏幕下方放置一个 10dp ImageView

> ID：12288869
> 
> 赞同：0
> 
> 时间：2012-09-05T20:00:32.413
> 
> 标签：android, android-layout

我试图在屏幕正下方放置一个阴影（只是一个常规的 ImageView），这样当用户向上拖动视图时，它将能够看到阴影。

我应该如何设置保证金等。

我目前的设置是：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:layout_gravity="top"
android:layout_marginBottom="-10dp"
android:minHeight="200dp" >

<EditText
    android:id="@+id/edit_content"
    android:layout_width="match_parent"
    android:layout_height="fill_parent"
    android:layout_gravity="top"
    android:layout_marginBottom="10dp"
    android:background="#00000000"
    android:ems="10"
    android:gravity="top"
    android:inputType="textMultiLine"
    android:lineSpacingExtra="3sp"
    android:padding="20dp" />

<ImageView
    android:layout_width="match_parent"
    android:layout_height="10dp"
    android:padding="10dp"
    android:layout_alignParentBottom="true"
    android:src="@drawable/some_shadow"/> 
```

这样做 ImageView 位于屏幕的底部，但我需要将它放在屏幕下方的高度。（所以它的顶部与屏幕的底部对齐）。

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:37:21.093

不要在这里做 android:layout_marginBottom="-10dp" ，它会溢出你的视野。

您可以做的是将它放在屏幕旁边的视图中并监听滚动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T20:03:36.617

这个怎么样，

```
Paint mShadow = new Paint(); 
// radius=10, y-offset=2, color=black 
mShadow.setShadowLayer(10.0f, 0.0f, 2.0f, 0xFF000000); 
// in onDraw(Canvas) 
canvas.drawBitmap(bitmap, 0.0f, 0.0f, mShadow); 
```

或者

看看这个[https://stackoverflow.com/a/4405209/1143977](https://stackoverflow.com/a/4405209/1143977)

# php - 确定 call_user_func_array 的参数

> ID：12288886
> 
> 赞同：1
> 
> 时间：2012-09-05T20:01:25.010
> 
> 标签：php, oop

我正在调用一个对象方法，通过`call_user_func_array`该方法我根据几个参数传递动态字符串参数。

它目前看起来类似于：

```
<?php
class MyObject
{
     public function do_Procedure ($arg1 = "", $arg2 = "")
     { /* do whatever */ }

     public function do_Something_Else (AnotherObject $arg1 = null)
     { /* This method requires the first parameter to
          be an instance of AnotherObject and not String */ }
}

call_user_func_array(array($object, $method), $arguments);
?> 
```

这适用于方法`$method = 'do_Procedure'`，但如果我想调用`$method = 'do_Something_Else'`需要第一个参数作为实例的方法，`AnotherObject`我会收到`E_RECOVERABLE_ERROR`错误。

我怎么知道应该传递哪种类型的实例？例如，如果此方法需要一个对象实例，但第一个处理的参数是字符串，我如何识别它以便我可以传递 null 或者只是跳过调用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T20:06:09.023

$arguments 是一个数组，它将爆炸到函数的参数。如果您调用该`do_Something_Else`函数，则数组必须为空或第一个元素必须为 null 或`AnotherObject`

在所有其他情况下，您都会收到`E_RECOVERABLE_ERROR`错误。

要找出需要传递的参数，您可以使用 Reflectionclass

示例，需要一些工作来调整您的需求：

```
 protected function Build( $type, $parameters = array( ) )
  {
    if ( $type instanceof \Closure )
      return call_user_func_array( $type, $parameters );

    $reflector = new \ReflectionClass( $type );

    if ( !$reflector->isInstantiable() )
      throw new \Exception( "Resolution target [$type] is not instantiable." );

    $constructor = $reflector->getConstructor();

    if ( is_null( $constructor ) )
      return new $type;

    if( count( $parameters ))
      $dependencies = $parameters; 
    else 
      $dependencies = $this->Dependencies( $constructor->getParameters() );

    return $reflector->newInstanceArgs( $dependencies );
  }

  protected static function Dependencies( $parameters )
  {
    $dependencies = array( );

    foreach ( $parameters as $parameter ) {
      $dependency = $parameter->getClass();

      if ( is_null( $dependency ) ) {
        throw new \Exception( "Unresolvable dependency resolving [$parameter]." );
      }

      $dependencies[] = $this->Resolve( $dependency->name );
    }

    return ( array ) $dependencies;
  } 
```

# linux - 为什么我无法使用 autoconf2.6x 构建 autoconf，它的版本无论如何都比 2.6 新

> ID：12288891
> 
> 赞同：2
> 
> 时间：2012-09-05T20:01:51.363
> 
> 标签：linux, build, centos, autoconf, automake

我的系统是基于centos的。

我尝试构建 autoconf 的原因是有人告诉我我可以尝试构建它以解决其他问题，您可能会通过此链接找到动机，[为什么即使使用正确的 autoconf，autogen.sh 也会失败？](https://stackoverflow.com/questions/12136934/why-autogen-sh-failed-even-with-the-correct-autoconf#comment16480229_12136934)

```
[mirror@home auto]$ cd autoconf/
[mirror@home autoconf]$ ls
AUTHORS    cfg.mk       ChangeLog.3        COPYINGv3    lib          man           README-hacking
bin        ChangeLog.0  configure.ac       doc          m4           NEWS          tests
BUGS       ChangeLog.1  COPYING            GNUmakefile  maint.mk     README        THANKS
build-aux  ChangeLog.2  COPYING.EXCEPTION  HACKING      Makefile.am  README-alpha  TODO
[mirror@home autoconf]$ autoreconf -iv
autoreconf: Entering directory `.'
autoreconf: configure.ac: not using Gettext
autoreconf: running: aclocal -I m4
configure.ac:20: error: Autoconf version 2.60 or higher is required
configure.ac:20: the top level
autom4te: /usr/bin/m4 failed with exit status: 63
aclocal: autom4te failed with exit status: 63
autoreconf: aclocal failed with exit status: 63 
```

// 我的系统上有 autoreconf2.6x，它的版本 si 高于 2.6，但仍然无法构建，为什么？

```
[mirror@home autoconf]$ autore
autoreconf      autoreconf2.59  autoreconf2.6x  autorespond
[mirror@home autoconf]$ autore
autoreconf      autoreconf2.59  autoreconf2.6x  autorespond
[mirror@home autoconf]$ autoreconf2.6x -iv

[mirror@home autoconf]$ autoconf2.6x --version
autoconf (GNU Autoconf) 2.63
Copyright (C) 2008 Free Software Foundation, Inc.
License GPLv2+: GNU GPL version 2 or later
<http://gnu.org/licenses/old-licenses/gpl-2.0.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Written by David J. MacKenzie and Akim Demaille. 
```

仍然无法构建 autoconf，我应该怎么做才能构建它？

```
[mirror@home autoconf]$ ./configure
bash: ./configure: No such file or directory
[mirror@home autoconf]$ autoconf
configure.ac:29: error: possibly undefined macro: AM_INIT_AUTOMAKE
      If this token and others are legitimate, please use m4_pattern_allow.
      See the Autoconf documentation.
configure.ac:117: error: possibly undefined macro: AC_PROG_GNU_M4
configure.ac:124: error: possibly undefined macro: AM_MISSING_PROG
configure.ac:187: error: possibly undefined macro: AM_PATH_LISPDIR
configure.ac:201: error: possibly undefined macro: AC_PROG_MAKE_CASE_SENSITIVE
[mirror@home autoconf]$ autoconf2.
autoconf2.59  autoconf2.6x
[mirror@home autoconf]$ autoconf2.6x

[mirror@home autoconf]$ ./configure --prefix=$HOME/ins/ins_auto

[mirror@home autoconf]$ autoreconf2.6x
configure.ac:20: error: Autoconf version 2.60 or higher is required
configure.ac:20: the top level
autom4te: /usr/bin/m4 failed with exit status: 63
aclocal: autom4te failed with exit status: 63
autoreconf2.6x: aclocal failed with exit status: 63 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-28T21:23:51.663

您安装了两个版本的 autoconf，当`aclocal`运行时`autom4te`，这会启动旧版本。你有一个`autom4te-2.6x`在你的路径？如果是这样，请`export AUTOM4TE=autom4te2.6x`在运行前设置`autoreconf-2.64`。

# c# - 为什么如果我在函数中发送一个字符串作为参数，它会返回为空？

> ID：12288892
> 
> 赞同：3
> 
> 时间：2012-09-05T20:01:55.753
> 
> 标签：c#, .net

使用此代码：

```
 void SomeMethod(string str)
 {
      string tmpStr = ... Read some value from file ... 

      if( !tmpStr.Empty() ) 
           str = tmpStr;

 } 
```

当我使用刚刚在主子例程中创建的简单字符串调用此方法时：

```
 string localString = "";
 SomeMethod( localString ); 
```

`localString`当我在调试中看到方法`SomeMethod`中的变量`tmpStr`不为空并且方法`str`中的变量充满字符时，我返回的值是一个空事件。

如果我将`SomeMethod`签名更改为：

```
SomeMethod(ref string str) 
```

我看到了正确的结果。

但是 string 是一个引用类型，那么为什么在这种情况下我需要用 发送它`ref`呢？以及为什么我只有在打电话时才会得到预期的结果：

```
SomeMethod(string str) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-05T20:13:32.180

不仅字符串是不可变的，而且虽然`string`是引用类型，但引用本身不是。也就是说，您传递的是`string`按引用，但引用本身是按值传递的。

因此，对于引用类型，您可以修改参数所引用的对象（只要它是可修改的），但您不能修改参数所引用的内容，除非您通过引用传递它。

因此，当您尝试更改`string`变量所指的内容时：

```
str = tmpStr; 
```

它改变了`str`本地引用的内容，但不影响原始参数所`localString`引用的内容。

这样想，假设参数`localString`引用位置 1000 的对象：

```
localString 
+---------------+                      1000
|      1000     |   -----------------> +---------------+
+---------------+                      | Count: 1      |
                                       | Value: ""     |
                                       +---------------+ 
```

然后当我们传递`localString`给该方法时，它会创建引用的副本（as `str`）并更新引用计数...

```
localString 
+---------------+                      1000
|      1000     |   -----------------> +---------------+
+---------------+                      | Count: 2      |
                                       | Value: ""     |
str                                    +---------------+
+---------------+                        ^
|      1000     |   ---------------------+
+---------------+ 
```

然后，当您将 str 分配给新字符串时，它会修改引用`str`，但不会`localString`：

```
localString
+---------------+                      1000
|      1000     |   -----------------> +---------------+
+---------------+                      | Count: 1      |
                                       | Value: ""     |
str                                    +---------------+
+---------------+                          2500
|      2500     |   ---------------------> +---------------+
+---------------+                          | Count: 1      |
                                           | Value: ...    |
                                           +---------------+ 
```

所以你的修改`str`只改变了`str`引用的内容，而不是原始的引用`localString`，如果你想改变*那个*，那么你通过引用传递，这意味着这`str`是对原始参数的引用（很像 ptr 到 ptr）：

```
localString
+---------------+                      1000
|      2500     |  ------------------> +---------------+
+---------------+                      | Count: 2      |
        ^                              | Value: ""     |
str     |                              +---------------+
+---------------+       
|               |       
+---------------+ 
```

现在，当您更改`str`它时，它也会更改参考`localString`：

```
localString
+---------------+                      1000
|      1000     |  -----+              +---------------+
+---------------+       |              | Count: 0      |
        ^               |              | Value: ""     |
str     |               |              +---------------+
+---------------+       |                  2500
|               |       +----------------> +---------------+
+---------------+                          | Count: 1      |
                                           | Value: ...    |
                                           +---------------+ 
```

然后，当然，原始字符串（假设在这个例子中没有其他引用它）可以被垃圾收集......

所以，如果你真的想修改`string`参数，通过`ref`or传递它`out`，或者你可以返回新的变异版本，或者存储在实例成员中（尽管传递实例成员是更高阶的耦合，可能会导致其他问题...）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T20:18:29.837

如果您不使用 ref 进行所有更改，但将进行分配，这是因为方法主体内的 str 是作为参数传递的变量的副本，并且它指向内存中的同一个实例，所以如果您调用方法或访问字段，则它位于同一个实例上，但如果您将另一个实例分配给 str 它仅开始指向另一个实例。但由于 str 只是用作参数的变量的副本，因此不会更改参数。如果您使用 ref 则不会创建副本并使用相同的指针。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T20:13:48.510

这应该做你想要的：

```
string SomeMethod()
{
      string tmpStr = ... Read some value from file ... 

      if( !tmpStr.Empty() ) 
           str = tmpStr;

         return str;
}

string localString = SomeMethod(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-05T20:24:39.247

“您不能更改引用本身的值；也就是说，您不能使用相同的引用来为新类分配内存并让它在块之外持续存在。”

从这个网站： http: [//msdn.microsoft.com/en-us/library/0f66670z (v=vs.71).aspx#vclrfpassingmethodparameters_example4](http://msdn.microsoft.com/en-us/library/0f66670z(v=vs.71).aspx#vclrfpassingmethodparameters_example4)

所以你只是改变块内的引用。有两种方法可以解决这个问题。1\. 使用您发现的 ref 关键字传递。2\. 正如其他人所建议的那样；更改方法以返回一个字符串，然后像这样声明您的新字符串：

```
String localString = SomeMethod(); 
```

# javascript - Javascript Date.toString() 格式？

> ID：12288893
> 
> 赞同：26
> 
> 时间：2012-09-05T20:01:56.620
> 
> 标签：javascript, date, timestamp, tostring

> **可能重复：**
> [在 JavaScript 中格式化日期](https://stackoverflow.com/questions/1056728/formatting-a-date-in-javascript)

我有以下一段脚本。这是一个带有日期范围的 HTML5 滑块。滑块使用 unix 时间戳，我想以可读格式显示当前选择。

这工作正常，但输出为“2012 年 5 月 16 日星期三 08:07:30 GMT+0100（GMT 夏令时间）”，尽管我将格式指定为“yyyy-MM-dd HH:mm:ss”。

任何想法为什么它不以我的格式输出？

```
<input id="slider3" type="range" min="1337149800" max="1337160600"
  step="450" onchange="printValue('slider3','rangeValue3')"/>
<input id="rangeValue3" type="text" size="90"/>

<script>
function printValue(sliderID, textbox) {
  var x = document.getElementById(textbox);
  var y = document.getElementById(sliderID);

  var d1=new Date(y.value*1000);

  var newtimestamp = d1.toString("yyyy-MM-dd HH:mm:ss");

  x.value = newtimestamp;
}
</script> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-05T20:03:45.250

JavaScript 的`Date`对象不支持这一点。有很多图书馆可以为您做到这一点。

# java - 修复 maven JSTL 1.2.1 依赖，因此 maven-war-plugin 不会打包冒犯 Tomcat 7 的 JAR

> ID：12288896
> 
> 赞同：4
> 
> 时间：2012-09-05T20:02:04.163
> 
> 标签：java, maven, jstl, war

我的设置：jdk 7、Tomcat 7.0.29、Eclipse Juno（嵌入了 m2e[Maven 3.0.4]、m2eclipse-wtp）

我有一个具有此[JSTL](http://jstl.java.net/download.html)依赖项的动态 Web 项目：

```
<dependency>
    <groupId>org.glassfish.web</groupId>
    <artifactId>javax.servlet.jsp.jstl</artifactId>
    <version>1.2.1</version>
</dependency> 
```

当我`mvn package`在 Tomcat 上进行部署时，我会在日志中收到这些非致命消息，这些消息不会阻止我的应用程序部署：

```
validateJarFile(...\WEB-INF\lib\jsp-api-2.1.jar) - jar not loaded. See Servlet Spec 2.3, section 9.7.2\. Offending class: javax/el/Expression.class
validateJarFile(...\WEB-INF\lib\servlet-api-2.5.jar) - jar not loaded. See Servlet Spec 2.3, section 9.7.2\. Offending class: javax/servlet/Servlet.class 
```

我检查了一下，是的，有问题的 JAR 被打包在 WAR 中。我检查依赖关系`mvn dependency:tree`并得到这个：

```
[INFO] \- org.glassfish.web:javax.servlet.jsp.jstl:jar:1.2.1:compile
[INFO]    \- javax.servlet.jsp.jstl:jstl-api:jar:1.2:compile
[INFO]       +- javax.servlet:servlet-api:jar:2.5:compile
[INFO]       \- javax.servlet.jsp:jsp-api:jar:2.1:compile 
```

两个 JAR 都显示在`compile`范围内，但是如果我检查[pom.xml](http://search.maven.org/remotecontent?filepath=org/glassfish/web/javax.servlet.jsp.jstl/1.2.1/javax.servlet.jsp.jstl-1.2.1.pom)，`org.glassfish.web:javax.servlet.jsp.jstl:jar:1.2.1`我会看到：

```
<dependency>
  <groupId>javax.servlet</groupId>
  <artifactId>servlet-api</artifactId>
  <version>2.5</version>
  <scope>provided</scope>
</dependency>
<dependency>
  <groupId>javax.servlet.jsp</groupId>
  <artifactId>jsp-api</artifactId>
  <version>2.2</version>
  <scope>provided</scope>
</dependency> 
```

这会在范围内显示它们`provided`，我认为这会将它们从包装中排除。

**问题：**

1.  如何告诉 WAR 插件不包含这些 JAR？`<excludes/>`不会削减它，因为这也会将它们从构建路径中删除。
2.  如果我想根据 Servlet 3.0 规范进行开发但保留这个 JSTL 版本怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T06:13:13.000

弄清楚了，jsp-api作为jstl的transative依赖潜入了WEB-INF\lib，解决方法是像这样排除。

```
<dependency>
    <groupId>org.glassfish.web</groupId>
    <artifactId>javax.servlet.jsp.jstl</artifactId>
    <version>${javax.jstl.version}</version>
    <exclusions>
        <exclusion>
            <groupId>javax.servlet</groupId>
            <artifactId>servlet-api</artifactId>
        </exclusion>
        <exclusion>
            <artifactId>jsp-api</artifactId>
            <groupId>javax.servlet.jsp</groupId>
        </exclusion>
    </exclusions>
</dependency> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-28T16:06:43.080

对于***1.2.1*** [版，请使用](https://stackoverflow.com/a/24468573/281545)：

```
<!-- add the selvlet-api that tomcat provides as provided -->
<dependency>
    <groupId>javax.servlet.jsp.jstl</groupId>
    <artifactId>javax.servlet.jsp.jstl-api</artifactId>
    <version>1.2.1</version>
</dependency>
<dependency>
    <groupId>org.glassfish.web</groupId>
    <artifactId>javax.servlet.jsp.jstl</artifactId>
    <version>1.2.1</version>
    <exclusions>
         <!-- jstl-api was adding selvlet-api 2.5 and jsp-api-->
        <exclusion>
            <artifactId>jstl-api</artifactId>
            <groupId>javax.servlet.jsp.jstl</groupId>
        </exclusion>
    </exclusions>
</dependency> 
```

因为如果不是，jstl-api ***1.2***将作为依赖项添加。是 jstl-api 添加了 jsp-api 和 servlet-api 依赖项。

# php - 如何将 apc 3.1.12 还原到 3.1.11

> ID：12288902
> 
> 赞同：1
> 
> 时间：2012-09-05T20:02:23.093
> 
> 标签：php, ubuntu, apc

在 3.1.12 升级后，apc.php 很快显示 100% 缓存已使用。不久之后，httpd 耗尽了所有物理内存，系统开始交换。根据[这个错误报告](https://bugs.php.net/bug.php?id=62863)，如果我将 APC 恢复到 3.1.11，它是正确的。那么如何将其还原为 3.1.11？

操作系统：debian sqeeze 6.0.5

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T21:11:07.903

我已经按照以下步骤操作：

```
$ wget http://pecl.php.net/get/APC-3.1.11.tgz
$ tar xvzf APC-3.1.11.tgz
$ cd APC-3.1.11
$ /usr/local/bin/phpize
$ ./configure --with-php-config=/usr/local/bin/php-config
$ make
$ make install 
```

# jquery - Woocommerce 添加到购物车按钮丢失

> ID：12288903
> 
> 赞同：4
> 
> 时间：2012-09-05T20:02:34.787
> 
> 标签：jquery, wordpress, woocommerce

如果您转到此页面并尝试进行选择，您会看到“添加到购物车”按钮未显示。[http://www.wearigive.com/product/camo-bracelet/](http://www.wearigive.com/product/camo-bracelet/)

您可以在此页面上看到所有评论：[http](http://www.woothemes.com/2012/08/in-this-weeks-episode-of-woocommerce/) ://www.woothemes.com/2012/08/in-this-weeks-episode-of-woocommerce/ 关于“添加到购物车”按钮未显示

我不知道为什么按钮不会显示？我已经验证 jQuery 1.7 正在页面中运行，并且它没有被另一个 jQuery 版本覆盖。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-19T18:35:58.333

我遇到了这个问题并通过简单地填写产品所需的信息（ID、SKU、价格、重量、尺寸）来解决它

![在此处输入图像描述](../Images/8207a6d38ae7822f209dbc00a041c366.png)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2018-03-24T20:06:40.027

有时这会解决问题：转到`apperience > customization > woocommerce > catalog mode`并禁用它。这仅适用于不显示“添加到购物车”按钮。那是我的情况

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-26T02:39:45.543

我有同样的问题。我的解决方案更简单。结果我使用了一个插件，将 javascript 移动到页面底部以加快页面加载速度。显然这导致了一个jquery问题。禁用插件使按钮恢复可见。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-07T03:07:16.083

它可能不会被破坏。如果产品有变量，并且在设置中选择 to 时`enable AJAX add to cart buttons on product archives`，`woocommerce`一旦做出所有选择，按钮 div 将显示给用户。原因，可能有选择影响价格的选项。在您的测试中，请务必在用户端进行所有必需的选择。

# iphone - 阻止用户发送短信的 iPhone 应用程序

> ID：12288907
> 
> 赞同：-1
> 
> 时间：2012-09-05T20:02:52.250
> 
> 标签：iphone, ios, security

我正在尝试构建一个能够进入某种锁定模式的 iPhone 应用程序。本质上，用户在这种模式下所能做的就是接听电话。

这可能吗？iPhone会允许吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T20:05:45.817

iPhone 将允许它。苹果不会。

除非您计划在越狱社区中发布，否则您将不得不使用私有 API，并且最终会因为使用私有 API 和在沙盒之外玩游戏而被 Apple 拒绝。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T21:36:03.483

看一看 Kiosk 模式： [锁定 iPhone/iPod/iPad，使其只能运行一个应用程序](https://stackoverflow.com/questions/5011774/lock-down-iphone-ipod-ipad-so-it-can-only-run-one-app/8994690#8994690)

您可以使用它来锁定手机应用程序中的设备。

# android - 单击活动上的后退按钮时，从未在数据库上显式调用 close()

> ID：12288908
> 
> 赞同：1
> 
> 时间：2012-09-05T20:02:55.550
> 
> 标签：android, database

我在没有崩溃的产品搜索应用程序中遇到此错误，但当我在模拟器中单击返回按钮（从项目的详细信息返回 - “DetaljiProizvoda.java”活动）时显然存在与数据库相关的问题（此时此错误出现在 Logcat 中) 我用 values.put 输入的一些新条目在我搜索它们时似乎没有出现，其他条目出现在搜索结果中。

```
09-05 21:01:23.082: W/IInputConnectionWrapper(758): showStatusIcon on inactive InputConnection
09-05 21:01:48.901: I/dalvikvm(813): threadid=3: reacting to signal 3
09-05 21:01:48.951: I/dalvikvm(813): Wrote stack traces to '/data/anr/traces.txt'
09-05 21:01:49.401: I/dalvikvm(813): threadid=3: reacting to signal 3
09-05 21:01:49.451: I/dalvikvm(813): Wrote stack traces to '/data/anr/traces.txt'
09-05 21:01:49.741: D/gralloc_goldfish(813): Emulator without GPU emulation detected.
09-05 21:01:49.901: I/dalvikvm(813): threadid=3: reacting to signal 3
09-05 21:01:49.951: I/dalvikvm(813): Wrote stack traces to '/data/anr/traces.txt'
09-05 21:02:06.762: I/dalvikvm(813): threadid=3: reacting to signal 3
09-05 21:02:06.781: I/dalvikvm(813): Wrote stack traces to '/data/anr/traces.txt'
09-05 21:02:28.111: D/dalvikvm(813): GC_CONCURRENT freed 143K, 3% free 9386K/9671K, paused 8ms+31ms
09-05 21:02:28.122: E/SQLiteDatabase(813): close() was never explicitly called on database '/data/data/hr.punctum.LociranjePonudaProizvoda/databases/proizvodidb' 
09-05 21:02:28.122: E/SQLiteDatabase(813): android.database.sqlite.DatabaseObjectNotClosedException: Application did not close the cursor or database object that was opened here
09-05 21:02:28.122: E/SQLiteDatabase(813):  at android.database.sqlite.SQLiteDatabase.<init>(SQLiteDatabase.java:1943)
09-05 21:02:28.122: E/SQLiteDatabase(813):  at android.database.sqlite.SQLiteDatabase.openDatabase(SQLiteDatabase.java:1007)
09-05 21:02:28.122: E/SQLiteDatabase(813):  at android.database.sqlite.SQLiteDatabase.openDatabase(SQLiteDatabase.java:986)
09-05 21:02:28.122: E/SQLiteDatabase(813):  at android.database.sqlite.SQLiteDatabase.openOrCreateDatabase(SQLiteDatabase.java:1051)
09-05 21:02:28.122: E/SQLiteDatabase(813):  at android.app.ContextImpl.openOrCreateDatabase(ContextImpl.java:770)
09-05 21:02:28.122: E/SQLiteDatabase(813):  at android.content.ContextWrapper.openOrCreateDatabase(ContextWrapper.java:221)
09-05 21:02:28.122: E/SQLiteDatabase(813):  at android.database.sqlite.SQLiteOpenHelper.getWritableDatabase(SQLiteOpenHelper.java:157)
09-05 21:02:28.122: E/SQLiteDatabase(813):  at hr.punctum.LociranjePonudaProizvoda.DetaljiProizvoda.onCreate(DetaljiProizvoda.java:24)
09-05 21:02:28.122: E/SQLiteDatabase(813):  at android.app.Activity.performCreate(Activity.java:4465)
09-05 21:02:28.122: E/SQLiteDatabase(813):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
09-05 21:02:28.122: E/SQLiteDatabase(813):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
09-05 21:02:28.122: E/SQLiteDatabase(813):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
09-05 21:02:28.122: E/SQLiteDatabase(813):  at android.app.ActivityThread.access$600(ActivityThread.java:123)
09-05 21:02:28.122: E/SQLiteDatabase(813):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
09-05 21:02:28.122: E/SQLiteDatabase(813):  at android.os.Handler.dispatchMessage(Handler.java:99)
09-05 21:02:28.122: E/SQLiteDatabase(813):  at android.os.Looper.loop(Looper.java:137)
09-05 21:02:28.122: E/SQLiteDatabase(813):  at android.app.ActivityThread.main(ActivityThread.java:4424)
09-05 21:02:28.122: E/SQLiteDatabase(813):  at java.lang.reflect.Method.invokeNative(Native Method)
09-05 21:02:28.122: E/SQLiteDatabase(813):  at java.lang.reflect.Method.invoke(Method.java:511)
09-05 21:02:28.122: E/SQLiteDatabase(813):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
09-05 21:02:28.122: E/SQLiteDatabase(813):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
09-05 21:02:28.122: E/SQLiteDatabase(813):  at dalvik.system.NativeStart.main(Native Method)
09-05 21:02:28.202: E/System(813): Uncaught exception thrown by finalizer
09-05 21:02:28.332: E/System(813): java.lang.IllegalStateException: Don't have database lock!
09-05 21:02:28.332: E/System(813):  at android.database.sqlite.SQLiteDatabase.verifyLockOwner(SQLiteDatabase.java:2090)
09-05 21:02:28.332: E/System(813):  at android.database.sqlite.SQLiteDatabase$1.entryRemoved(SQLiteDatabase.java:2182)
09-05 21:02:28.332: E/System(813):  at android.database.sqlite.SQLiteDatabase$1.entryRemoved(SQLiteDatabase.java:2178)
09-05 21:02:28.332: E/System(813):  at android.util.LruCache.trimToSize(LruCache.java:197)
09-05 21:02:28.332: E/System(813):  at android.util.LruCache.evictAll(LruCache.java:285)
09-05 21:02:28.332: E/System(813):  at android.database.sqlite.SQLiteDatabase.deallocCachedSqlStatements(SQLiteDatabase.java:2143)
09-05 21:02:28.332: E/System(813):  at android.database.sqlite.SQLiteDatabase.closeClosable(SQLiteDatabase.java:1126)
09-05 21:02:28.332: E/System(813):  at android.database.sqlite.SQLiteDatabase.finalize(SQLiteDatabase.java:1914)
09-05 21:02:28.332: E/System(813):  at java.lang.Daemons$FinalizerDaemon.doFinalize(Daemons.java:182)
09-05 21:02:28.332: E/System(813):  at java.lang.Daemons$FinalizerDaemon.run(Daemons.java:168)
09-05 21:02:28.332: E/System(813):  at java.lang.Thread.run(Thread.java:856)
09-05 21:02:28.511: E/SQLiteDatabase(813): close() was never explicitly called on database '/data/data/hr.punctum.LociranjePonudaProizvoda/databases/proizvodidb' 
09-05 21:02:28.511: E/SQLiteDatabase(813): android.database.sqlite.DatabaseObjectNotClosedException: Application did not close the cursor or database object that was opened here
09-05 21:02:28.511: E/SQLiteDatabase(813):  at android.database.sqlite.SQLiteDatabase.<init>(SQLiteDatabase.java:1943)
09-05 21:02:28.511: E/SQLiteDatabase(813):  at android.database.sqlite.SQLiteDatabase.openDatabase(SQLiteDatabase.java:1007)
09-05 21:02:28.511: E/SQLiteDatabase(813):  at android.database.sqlite.SQLiteDatabase.openDatabase(SQLiteDatabase.java:986)
09-05 21:02:28.511: E/SQLiteDatabase(813):  at android.database.sqlite.SQLiteDatabase.openOrCreateDatabase(SQLiteDatabase.java:1051)
09-05 21:02:28.511: E/SQLiteDatabase(813):  at android.app.ContextImpl.openOrCreateDatabase(ContextImpl.java:770)
09-05 21:02:28.511: E/SQLiteDatabase(813):  at android.content.ContextWrapper.openOrCreateDatabase(ContextWrapper.java:221)
09-05 21:02:28.511: E/SQLiteDatabase(813):  at android.database.sqlite.SQLiteOpenHelper.getWritableDatabase(SQLiteOpenHelper.java:157)
09-05 21:02:28.511: E/SQLiteDatabase(813):  at hr.punctum.LociranjePonudaProizvoda.DetaljiProizvoda.onCreate(DetaljiProizvoda.java:24)
09-05 21:02:28.511: E/SQLiteDatabase(813):  at android.app.Activity.performCreate(Activity.java:4465)
09-05 21:02:28.511: E/SQLiteDatabase(813):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
09-05 21:02:28.511: E/SQLiteDatabase(813):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
09-05 21:02:28.511: E/SQLiteDatabase(813):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
09-05 21:02:28.511: E/SQLiteDatabase(813):  at android.app.ActivityThread.access$600(ActivityThread.java:123)
09-05 21:02:28.511: E/SQLiteDatabase(813):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
09-05 21:02:28.511: E/SQLiteDatabase(813):  at android.os.Handler.dispatchMessage(Handler.java:99)
09-05 21:02:28.511: E/SQLiteDatabase(813):  at android.os.Looper.loop(Looper.java:137)
09-05 21:02:28.511: E/SQLiteDatabase(813):  at android.app.ActivityThread.main(ActivityThread.java:4424)
09-05 21:02:28.511: E/SQLiteDatabase(813):  at java.lang.reflect.Method.invokeNative(Native Method)
09-05 21:02:28.511: E/SQLiteDatabase(813):  at java.lang.reflect.Method.invoke(Method.java:511)
09-05 21:02:28.511: E/SQLiteDatabase(813):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
09-05 21:02:28.511: E/SQLiteDatabase(813):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
09-05 21:02:28.511: E/SQLiteDatabase(813):  at dalvik.system.NativeStart.main(Native Method)
09-05 21:02:28.552: E/System(813): Uncaught exception thrown by finalizer
09-05 21:02:28.601: E/System(813): java.lang.IllegalStateException: Don't have database lock!
09-05 21:02:28.601: E/System(813):  at android.database.sqlite.SQLiteDatabase.verifyLockOwner(SQLiteDatabase.java:2090)
09-05 21:02:28.601: E/System(813):  at android.database.sqlite.SQLiteDatabase$1.entryRemoved(SQLiteDatabase.java:2182)
09-05 21:02:28.601: E/System(813):  at android.database.sqlite.SQLiteDatabase$1.entryRemoved(SQLiteDatabase.java:2178)
09-05 21:02:28.601: E/System(813):  at android.util.LruCache.trimToSize(LruCache.java:197)
09-05 21:02:28.601: E/System(813):  at android.util.LruCache.evictAll(LruCache.java:285)
09-05 21:02:28.601: E/System(813):  at android.database.sqlite.SQLiteDatabase.deallocCachedSqlStatements(SQLiteDatabase.java:2143)
09-05 21:02:28.601: E/System(813):  at android.database.sqlite.SQLiteDatabase.closeClosable(SQLiteDatabase.java:1126)
09-05 21:02:28.601: E/System(813):  at android.database.sqlite.SQLiteDatabase.finalize(SQLiteDatabase.java:1914)
09-05 21:02:28.601: E/System(813):  at java.lang.Daemons$FinalizerDaemon.doFinalize(Daemons.java:182)
09-05 21:02:28.601: E/System(813):  at java.lang.Daemons$FinalizerDaemon.run(Daemons.java:168)
09-05 21:02:28.601: E/System(813):  at java.lang.Thread.run(Thread.java:856) 
```

**数据库助手.java**

```
package hr.punctum.LociranjePonudaProizvoda;

import android.content.ContentValues;
import android.content.Context;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;

public class DatabaseHelper extends SQLiteOpenHelper {

    public static final String DATABASE_NAME = "proizvodidb";

    public DatabaseHelper(Context context) {
        super(context, DATABASE_NAME, null, 1);
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        /*
         * Kreiranje tabele proizvodi i punjenje tabele sa podacima.
         * Kasnije cu prebaciti ove hardcore kodirane statment-e u XML datoteku.
         */
        String sql = "CREATE TABLE IF NOT EXISTS proizvodi (" +
                        "_id INTEGER PRIMARY KEY AUTOINCREMENT, " + 
                        "naziv TEXT, " +
                        "tvrtka TEXT, " +
                        "cijena TEXT, " +
                        "kategorija TEXT, " +
                        "telefonTvrtke TEXT, " +
                        "adresaTvrtke TEXT)";
        db.execSQL(sql);

        ContentValues values = new ContentValues();

        values.put("naziv", "Canon 60D");
        values.put("tvrtka", "Protis");
        values.put("cijena", "4600");
        values.put("kategorija", "fotoaparati");
        values.put("telefonTvrtke", "016587176");
        values.put("adresaTvrtke", "Laducka 36A");
        db.insert("proizvodi", "tvrtka", values);

        values.put("naziv", "Nikon D800");
        values.put("tvrtka", "MagazinRS");
        values.put("cijena", "21600");
        values.put("kategorija", "fotoaparati");
        values.put("telefonTvrtke", "454562542");
        values.put("adresaTvrtke", "Laniste 1B");       
        db.insert("proizvodi", "tvrtka", values);   

        values.put("naziv", "Olympus OM-D");
        values.put("tvrtka", "Telebit");
        values.put("cijena", "5200");
        values.put("kategorija", "fotoaparati");
        values.put("telefonTvrtke", "5657676");
        values.put("adresaTvrtke", "Laniste 1B");       
        db.insert("proizvodi", "tvrtka", values);

        values.put("naziv", "Pentax K-7");
        values.put("tvrtka", "Svijet medija");
        values.put("cijena", "7400");
        values.put("kategorija", "fotoaparati");
        values.put("telefonTvrtke", "11236676");
        values.put("adresaTvrtke", "Laniste 1B");       
        db.insert("proizvodi", "tvrtka", values);

        values.put("naziv", "Samsung S3");
        values.put("tvrtka", "Svijet medija");
        values.put("cijena", "4200");
        values.put("kategorija", "mobiteli");
        values.put("telefonTvrtke", "7814442222");
        values.put("adresaTvrtke", "Laniste 1B");       
        db.insert("proizvodi", "tvrtka", values);

        values.put("naziv", "Samsung S2");
        values.put("tvrtka", "Svijet medija");
        values.put("cijena", "3200");
        values.put("kategorija", "mobiteli");
        values.put("telefonTvrtke", "7814442222");
        values.put("adresaTvrtke", "Laniste 1B");       
        db.insert("proizvodi", "tvrtka", values);

        values.put("naziv", "Huawei U8650");
        values.put("tvrtka", "MagazinRS");
        values.put("cijena", "3200");
        values.put("kategorija", "mobiteli");
        values.put("telefonTvrtke", "7814442222");
        values.put("adresaTvrtke", "Laniste 1B");       
        db.insert("proizvodi", "tvrtka", values);

        values.put("naziv", "Huawei U8660");
        values.put("tvrtka", "MagazinRS");
        values.put("cijena", "3200");
        values.put("kategorija", "mobiteli");
        values.put("telefonTvrtke", "7814442222");
        values.put("adresaTvrtke", "Laniste 1B");       
        db.insert("proizvodi", "tvrtka", values);

        values.put("naziv", "Huawei U8660");
        values.put("tvrtka", "MagazinRS");
        values.put("cijena", "3400");
        values.put("kategorija", "mobiteli");
        values.put("telefonTvrtke", "7814442222");
        values.put("adresaTvrtke", "Laniste 1B");       
        db.insert("proizvodi", "tvrtka", values);

        //db.close();   
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        db.execSQL("DROP TABLE IF EXISTS proizvodi");
        onCreate(db);
    }

} 
```

* * *

**ListaProizvoda.java**

```
package hr.punctum.LociranjePonudaProizvoda;

import android.app.ListActivity;
import android.content.Intent;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.os.Bundle;
import android.view.View;
import android.widget.EditText;
import android.widget.ListAdapter;
import android.widget.ListView;
import android.widget.SimpleCursorAdapter;

public class ListaProizvoda extends ListActivity {

    protected EditText searchText;
    protected SQLiteDatabase db;
    protected Cursor cursor;
    protected ListAdapter adapter;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        db = (new DatabaseHelper(this)).getWritableDatabase();
        searchText = (EditText) findViewById (R.id.searchText);

    }    

    @SuppressWarnings("deprecation")
    public void search(View view) {
        // || je operacija spajanja u SQLiteu, slijedeci sql query vraca rezultat iz baze svih zapisa koji pocinju na slovo uneseno u search polje
        cursor = db.rawQuery("SELECT _id, naziv, tvrtka, cijena FROM proizvodi WHERE naziv LIKE ?", 
                        new String[]{searchText.getText().toString() + "%"}); 
        adapter = new SimpleCursorAdapter(this,R.layout.proizvodi_list_artikl,cursor,new String[] {"naziv", "tvrtka", "cijena"},new int[] {R.id.naziv, R.id.tvrtka, R.id.cijena});
        setListAdapter(adapter);    

    }

    public void onListItemClick(ListView parent, View view, int position, long id) {
        //kreiranje Intenta za komunikaciju s drugim activity-om
        Intent intent = new Intent(this, DetaljiProizvoda.class);
        Cursor cursor = (Cursor) adapter.getItem(position);
        //slanje varijable
        intent.putExtra("PROIZVODI_ID", cursor.getInt(cursor.getColumnIndex("_id")));
        startActivity(intent);
    }

} 
```

* * *

**DetaljiProizvoda.java**

```
package hr.punctum.LociranjePonudaProizvoda;

import android.app.Activity;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.os.Bundle;
import android.widget.TextView;

public class DetaljiProizvoda extends Activity {

    protected TextView naziv;
    protected TextView kategorija;
    protected TextView tvrtka;
    protected TextView telefonTvrtke;
    protected TextView adresaTvrtke;
    protected int proizvodId;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.detalji_proizvoda);
        //hvatanje parametra (ID iz tablice) Intenta iz ListaProizvoda activity-a
        proizvodId = getIntent().getIntExtra("PROIZVODI_ID", 0);
        SQLiteDatabase db = (new DatabaseHelper(this)).getWritableDatabase();
        Cursor cursor = db.rawQuery("SELECT proizv._id, proizv.naziv, proizv.tvrtka, proizv.cijena, proizv.kategorija, proizv.telefonTvrtke, proizv.adresaTvrtke FROM proizvodi proizv LEFT OUTER JOIN proizvodi mgr ON proizv._id = mgr._id WHERE proizv._id = ?", 
                new String[]{""+proizvodId});

        if (cursor.getCount() == 1)
        {
            cursor.moveToFirst();

            naziv = (TextView) findViewById(R.id.naziv);
            naziv.setText(cursor.getString(cursor.getColumnIndex("naziv"))); /*+ " " + cursor.getString(cursor.getColumnIndex("lastName")));*/

            kategorija = (TextView) findViewById(R.id.kategorija);
            kategorija.setText(cursor.getString(cursor.getColumnIndex("kategorija")));

            tvrtka = (TextView) findViewById(R.id.tvrtka);
            tvrtka.setText(cursor.getString(cursor.getColumnIndex("tvrtka")));

            telefonTvrtke = (TextView) findViewById(R.id.telefonTvrtke);
            telefonTvrtke.setText(cursor.getString(cursor.getColumnIndex("telefonTvrtke")));

            adresaTvrtke = (TextView) findViewById(R.id.adresaTvrtke);
            adresaTvrtke.setText(cursor.getString(cursor.getColumnIndex("adresaTvrtke")));

        }

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T20:05:34.950

只需关闭您的并`cursors`停止“数据库从未关闭”消息：`db``onDestroy()`

```
@Override
protected void onDestroy() {
    cursor.close();
    db.close();
    super.onDestroy();
} 
```

同样`id`在此方法中已经引用了相应的行：

```
public void onListItemClick(ListView parent, View view, int position, long id) {
    //kreiranje Intenta za komunikaciju s drugim activity-om
    Intent intent = new Intent(this, DetaljiProizvoda.class);
    //slanje varijable 
    intent.putExtra("PROIZVODI_ID", id);
    startActivity(intent);
} 
```

我希望这会有所帮助！

* * *

**从评论中添加**

我错过了你也在打开你的数据库`DetaljiProizvoda`，基本上你打电话的任何地方你`getWritableDatabase()`都需要在`close()`完成后打电话。`DetaljiProizvoda`您可以像这样进行设置`ListaProizvoda`（通过声明`db`和`cursor`作为类变量并复制`onDestroy()`方法）。`onCreate()`但是因为您只读取了一次数据库，所以只需将其添加到in的底部`DetaljiProizvoda`：

```
cursor.close();
db.close(); 
```

您询问：

> 这些方法（onResume 和 onDestroy）不是已经在每个活动中实现了吗？

是的，这就是我们使用的原因`@Override`以及`super`当我们`extend`上课的时候。在我们的例子中，`@Override`告诉编译器使用我们的版本`onCreate()`，`onDestroy()`等等，如果我们想调用父类的版本，我们使用`super`关键字。您不需要覆盖大多数父方法。您不需要覆盖 Activity 的`onCreate()`，但是如果没有您的代码，这个应用程序不会做太多事情`onCreate()`......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T20:09:05.163

```
@SuppressWarnings("deprecation")
public void search(View view) {
    // || je operacija spajanja u SQLiteu, slijedeci sql query vraca rezultat iz baze svih zapisa koji pocinju na slovo uneseno u search polje
    cursor = db.rawQuery("SELECT _id, naziv, tvrtka, cijena FROM proizvodi WHERE naziv LIKE ?", 
            new String[]{searchText.getText().toString() + "%"}); 
    adapter = new SimpleCursorAdapter(this,R.layout.proizvodi_list_artikl,cursor,new String[] {"naziv", "tvrtka", "cijena"},new int[] {R.id.naziv, R.id.tvrtka, R.id.cijena});
    setListAdapter(adapter);
    cursor.close();  // Add this line
    db.close(); // And this line as well

} 
```

# mysql - 插入选择查询需要超过 10 分钟

> ID：12288909
> 
> 赞同：0
> 
> 时间：2012-09-05T20:02:57.977
> 
> 标签：mysql, performance

几周前我运行它时花费不到 1 分钟的查询现在花费了 10 多分钟，而且看不到尽头。

新查询（需要很长时间）

```
select sds.school_id, 
  detail.year, 
  detail.race,
  ROUND((detail.count / summary.total) * 100 ,2) as percent 
FROM school_data_race_ethnicity_raw as detail
inner join school_data_schools as sds USING (school_id)
inner join (
  select sds2.district_id, year, sum(count) as total
  from school_data_race_ethnicity_raw
  inner join school_data_schools as sds2 USING (school_id)
  group by sds2.district_id, year
  ) as summary on summary.district_id = sds.district_id 
    and summary.year = detail.year 
```

询问：

```
INSERT INTO school_data_race_ethnicity_schools (school_id, year, race, percent) (
    SELECT school_id,
           year,
           race,
           ROUND((count/(
        SELECT SUM(count) 
          FROM school_data_race_ethnicity_raw as school_data_race_ethnicity_raw_inner 
         WHERE school_id = school_data_race_ethnicity_raw_outer.school_id 
           and year = school_data_race_ethnicity_raw_outer.year)
                        ) * 100,2) as percent
      FROM school_data_race_ethnicity_raw as school_data_race_ethnicity_raw_outer) 
```

解释：

```
mysql> explain SELECT school_id,year,race,ROUND((count/(SELECT SUM(count) 
    -> FROM school_data_race_ethnicity_raw as school_data_race_ethnicity_raw_inner 
    -> WHERE 
    -> school_id = school_data_race_ethnicity_raw_outer.school_id and 
    -> year = school_data_race_ethnicity_raw_outer.year)) * 100,2) as percent
    -> FROM school_data_race_ethnicity_raw as school_data_race_ethnicity_raw_outer;
+----+--------------------+--------------------------------------+------+----------------------------+------+---------+-----------------------------------------------------------------+-------+-------------+
| id | select_type        | table                                | type | possible_keys              | key  | key_len | ref                                                             | rows  | Extra       |
+----+--------------------+--------------------------------------+------+----------------------------+------+---------+-----------------------------------------------------------------+-------+-------------+
|  1 | PRIMARY            | school_data_race_ethnicity_raw_outer | ALL  | NULL                       | NULL | NULL    | NULL                                                            | 84012 |             |
|  2 | DEPENDENT SUBQUERY | school_data_race_ethnicity_raw_inner | ref  | school_id,year,school_id_2 | year | 4       | rocdocs_main_drupal_7.school_data_race_ethnicity_raw_outer.year |  8402 | Using where |
+----+--------------------+--------------------------------------+------+----------------------------+------+---------+-----------------------------------------------------------------+-------+-------------+
2 rows in set (0.00 sec) 
```

创建表：

```
mysql> show create table school_data_race_ethnicity_raw;
+--------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Table                          | Create Table                                                                                                                                                                                                                                                                                                                                                                                                  |
+--------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| school_data_race_ethnicity_raw | CREATE TABLE `school_data_race_ethnicity_raw` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `school_id` varchar(255) NOT NULL,
  `year` int(11) NOT NULL,
  `race` varchar(255) NOT NULL,
  `count` int(11) NOT NULL,
  PRIMARY KEY (`id`),
  KEY `school_id` (`school_id`,`year`),
  KEY `year` (`year`,`race`),
  KEY `school_id_2` (`school_id`)
) ENGINE=MyISAM AUTO_INCREMENT=84013 DEFAULT CHARSET=latin1 |
+--------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> show create table school_data_race_ethnicity_schools;
+------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Table                              | Create Table                                                                                                                                                                                                                                                                                                                                                                           |
+------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| school_data_race_ethnicity_schools | CREATE TABLE `school_data_race_ethnicity_schools` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `school_id` varchar(255) NOT NULL,
  `year` int(11) NOT NULL,
  `race` varchar(255) NOT NULL,
  `percent` decimal(15,2) NOT NULL,
  PRIMARY KEY (`id`),
  KEY `year` (`year`,`race`),
  KEY `school_id` (`school_id`,`year`)
) ENGINE=MyISAM AUTO_INCREMENT=24961 DEFAULT CHARSET=latin1 |
+------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> show processlist;
+------+---------+--------------------+-----------------------+---------+------+--------------+------------------------------------------------------------------------------------------------------+
| Id   | User    | Host               | db                    | Command | Time | State        | Info                                                                                                 |
+------+---------+--------------------+-----------------------+---------+------+--------------+------------------------------------------------------------------------------------------------------+
| 1739 | [REMOVED] |  [REMOVED] | rocdocs_main_drupal_7 | Query   | 1467 | Sending data | INSERT INTO school_data_race_ethnicity_schools (school_id, year, race, percent) (
SELECT school_id,y |
| 1800 | root    | localhost          | rocdocs_main_drupal_7 | Query   |    0 | NULL         | show processlist                                                                                     |
+------+---------+--------------------+-----------------------+---------+------+--------------+------------------------------------------------------------------------------------------------------+
2 rows in set (0.00 sec) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T20:16:55.907

由于您使用子查询计算百分比的方式，您的 SELECT 将非常慢。它正在读取每一行的一整年数据。如果您使用子查询来选择总数并加入该总数，那么它应该运行得更快。

在我的脑海中，这样的事情（虽然不理想）应该比您现有的查询快得多：

```
select detail.school_id, 
  detail.year, 
  detail.race,
  ROUND((detail.count / summary.total) * 100 ,2) as percent 
FROM school_data_race_ethnicity_raw as detail
inner join (
  select school_id, year, sum(count) as total
  from school_data_race_ethnicity_raw
  group by school_id, year
  ) as summary on summary.school_id = detail.school_id 
    and summary.year = detail.year 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T20:34:28.497

让我们处理`SELECT`查询。让我们一块一块地做。看起来您想要为每个不同的学校、种族和年份设置一行。这很简单。

```
 SELECT r.school_id, r.year, r.race, something
     FROM school_data_race_ethnicity_raw r
    GROUP BY r.school_id, r.year, r.race 
```

现在让我们整理一下您的`something`指标。很难从你的问题中确切地说出来，但我会猜。看起来您想要属于每个种族的学生比例。

所以我们需要处理两个摘要查询。一个给我们每个学校每年的学生总数。

```
 SELECT r.school_id, r.year, SUM(count) count
    FROM school_data_race_ethnicity_raw r
GROUP BY r.school_id, r.year 
```

第二个是按学校、年份和种族划分的学生总数。

```
 SELECT r.school_id, r.year, r.race, SUM(count) count
    FROM school_data_race_ethnicity_raw r
GROUP BY r.school_id, r.year, r.race 
```

然后，我们需要将这两个查询连接在一起，就好像它们是虚拟表一样，所以我们可以做分数：

```
 SELECT t.school_id, t.year, u.race, u.count/t.count percent
     FROM 
     (
          SELECT r.school_id, r.year, SUM(count) count
            FROM school_data_race_ethnicity_raw r
        GROUP BY r.school_id, r.year
     ) t
     LEFT JOIN
     (
          SELECT r.school_id, r.year, r.race, SUM(count) count
            FROM school_data_race_ethnicity_raw r
        GROUP BY r.school_id, r.year, r.race
     ) u ON (t.school_id = u.school_id AND t.year = u.year) 
```

最后，您需要百分比，所以让我们将分数乘以 100.0。

```
 SELECT t.school_id, t.year, u.race, ROUND(100.0*u.count/t.count, 2) percent
     FROM 
     (
          SELECT r.school_id, r.year, SUM(count) count
            FROM school_data_race_ethnicity_raw r
        GROUP BY r.school_id, r.year
     ) t
     LEFT JOIN
     (
          SELECT r.school_id, r.year, r.race, SUM(count) count
            FROM school_data_race_ethnicity_raw r
        GROUP BY r.school_id, r.year, r.race
     ) u ON (t.school_id = u.school_id AND t.year = u.year) 
```

# php - 将数组固定为数字顺序

> ID：12288910
> 
> 赞同：0
> 
> 时间：2012-09-05T20:03:02.807
> 
> 标签：php, cakephp

我有一个这样的数组

```
array
  0 => 
    array
      'title' => string 'Last Name' (length=9)
      'price' => string '0.0000' (length=6)
      'price_type' => string 'fixed' (length=5)
      'is_required' => int 1
  1 => 
    array
      'title' => string 'Title 1' (length=6)
      'price' => string '0.0000' (length=6)
      'price_type' => string 'fixed' (length=5)
      'is_required' => int 0
  2 => 
    array
      'title' => string 'Title 10' (length=7)
      'price' => string '0.0000' (length=6)
      'price_type' => string 'fixed' (length=5)
      'is_required' => int 0
  3 => 
    array
      'title' => string 'Title 11' (length=7)
      'price' => string '0.0000' (length=6)
      'price_type' => string 'fixed' (length=5)
      'is_required' => int 0
  4 => 
    array
       'title' => string 'Title 12' (length=7)
      'price' => string '0.0000' (length=6)
      'price_type' => string 'fixed' (length=5)
      'is_required' => int 0
  5 => 
    array
       'title' => string 'Title 2' (length=6)
      'price' => string '0.0000' (length=6)
      'price_type' => string 'fixed' (length=5)
      'is_required' => int 0
  6 => 
    array
        'title' => string 'Title 3' (length=6)
      'price' => string '0.0000' (length=6)
      'price_type' => string 'fixed' (length=5)
      'is_required' => int 0
  7 => 
    array
       'title' => string 'Title 4' (length=6)
      'price' => string '0.0000' (length=6)
      'price_type' => string 'fixed' (length=5)
      'is_required' => int 0
  8 => 
    array
      'title' => string 'Title 5' (length=6)
      'price' => string '0.0000' (length=6)
      'price_type' => string 'fixed' (length=5)
      'is_required' => int 0
  9 => 
    array
      'title' => string 'Title 6' (length=6)
      'price' => string '0.0000' (length=6)
      'price_type' => string 'fixed' (length=5)
      'is_required' => int 0
  10 => 
    array
      'title' => string 'Title 7' (length=6)
      'price' => string '0.0000' (length=6)
      'price_type' => string 'fixed' (length=5)
      'is_required' => int 0
  11 => 
    array
       'title' => string 'Title 8' (length=6)
      'price' => string '0.0000' (length=6)
      'price_type' => string 'fixed' (length=5)
      'is_required' => int 0
  12 => 
    array
        'title' => string 'Title 9' (length=6)
      'price' => string '0.0000' (length=6)
      'price_type' => string 'fixed' (length=5)
      'is_required' => int 0 
```

所以问题是在数组中我有标题。当我执行 foreach 循环时，标题显示为

```
LAST NAME:
Title 1:
Title 10:
Title 11:
Title 12:
Title 2:
Title 3:
Title 4:
Title 5:
Title 6:
Title 7:
Title 8:
Title 9: 
```

正如您所注意到的，标题 10 出现在 1 之后，并且它的数字顺序不正确。我怎样才能在 php.ini 中解决这个问题。谢谢

**试过** $titles = array(); foreach ($product->custom_options as $key => $row) { $titles[$key] = $row['title']; } var_dump(array_multisort($titles, SORT_DESC, $product->custom_options));

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T20:07:18.190

尝试将[usort](http://php.net/manual/en/function.usort.php)与[strnatcmp](http://php.net/manual/en/function.strnatcmp.php)结合使用。像这样的东西：

```
usort($array, function($lhs, $rhs){ 
    return strnatcmp($lhs['title'], $rhs['title']);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T20:07:56.150

您永远不会对数组进行排序，它是按该顺序显示的，因为您以这种方式插入了项目，您首先需要对数组进行排序，但不是以字母数字方式。尝试使用另一个具有整数值的字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T20:11:57.097

问题很可能与阵列的生成有关，而不是像现在一样修复它。据我所知，您将标题作为第一个元素，从那时起，您将拥有未正确“排序”的元素。

在不知道确切要求的情况下，根据您发布的内容，“排序”的一种方法是：

```
// $data array is the existing array
$new_array = array();
foreach ($data as $item) {
    if ($item['title'] == 'Last Name') {
        $new_array[0] = $item;
    } 
    else
    {
        $key = intval(trim(str_replace("Title ", "", $item['title'])));
        $new_array[$key] = $item;
    }
}

ksort($new_array); 
```

生成的数组具有键为 0 的元素作为标题，其他所有内容都取决于“标题 XX”，其中 XX 是一个数字（取自标题元素

高温高压

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T05:14:47.587

您可以直接使用 php 定义的[natsort 函数](http://in3.php.net/manual/en/function.natsort.php)，该函数使用“自然顺序”算法对数组进行排序。

只需编写以下代码即可完成。

```
natsort($array); 
```

# performance - 减少 Visual Studio 构建时间

> ID：12288912
> 
> 赞同：7
> 
> 时间：2012-09-05T20:03:06.050
> 
> 标签：performance, visual-studio, time, build

我有一个包含大约 100 个项目的 Visual Studio 解决方案。它们中的大多数形成依赖层次结构。现在，如果我为一个项目更改一个 .cs 并构建它，那么所有相关项目也会被构建——无论它们是否已被更改。有没有办法让 Visual Studio 只构建更改的项目？每次我通过重建整个地段来做一点改变时，我都会浪费几分钟。它加起来很大！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-05T20:05:31.020

不，没有好的方法可以做到这一点。有时确实会发生一些*增量*构建（Visual Studio 2010 或更高版本），但不能保证。

将成熟的项目编译成程序集，并从您的不稳定（当前正在开发）项目中引用它们。如果您正在进行适当的单元测试，这应该不是一个大问题。分而治之；首先完成依赖项并使它们稳定，然后将它们提交给程序集。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T20:05:33.187

减少项目数量。

每个项目都会产生一个**部署**`DLL`单元。[这通常是不需要](https://www.simple-talk.com/dotnet/.net-framework/partitioning-your-code-base-through-.net-assemblies-and-visual-studio-projects/)的。

 **如果您需要按逻辑排列代码，可以在项目中使用文件夹。

此外，不是项目引用，而是引用构建的 DLL。

* * *

为什么这个建议有效：

*   生成的 DLL 更少。
*   对这些 DLL 的引用较少，因此需要复制的 DLL 也较少。
*   许多其他项目引用的项目会为每个引用项目重新编译。如果使用 DLL 而不是项目引用，则不会发生重新编译。**

# google-chrome-extension - 为什么我的 Chrome 扩展程序的扩展程序管理图标不显示？

> ID：12288914
> 
> 赞同：4
> 
> 时间：2012-09-05T20:03:20.380
> 
> 标签：google-chrome-extension, icons

我正在尝试在扩展面板中添加一个显示在我的 Chrome 扩展名称旁边的图标。我尝试使用以下 manifest.json 文件。

```
{
  "name": "My Extension",
  "version": "1.0",
  "manifest_version": 2,
  "icons": { "16": "mediumIcon.png", "48": "mediumIcon.png", "128": "mediumIcon.png" },
  "description": "A practice extension.",
  "browser_action": {
    "default_icon": "smallIcon.png",
    "default_popup": "load.html"
  }
} 
```

mediumIcon.png 为 128x128。当我在 Chrome 的“扩展”选项卡中进入开发人员模式并加载解压后的扩展时，该图标不在我的扩展名称旁边。实际上，该图标的黑白版本会闪烁一秒钟，之后会出现默认的 Chrome 扩展程序图标（看起来像一块拼图）。

为什么不？我认为文档指出，如果需要，图标可以按比例缩小。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-06T03:58:13.613

chrome 扩展中的[图标文档说明](http://developer.chrome.com/extensions/manifest.html#icons)了与您的问题相关的两件事：

> 重要提示：仅使用记录的图标大小。

和

> 提供一个 48x48 的图标，用于扩展管理页面

如果您提供不同大小的图标，而应该使用 48x48，它将被忽略。由于管理页面的图标是从48x48版本生成的，所以不会显示。

您的问题的解决方案是为每个图标定义提供正确尺寸的图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-03-18T16:31:53.603

```
{
  "name": "Chrome Extention",
  "page_action": {
    },
  "icons": {
      "16": "images/get_started16.png",
      "32": "images/get_started32.png",
      "48": "images/get_started48.png",
      "128": "images/get_started128.png"
    }
} 
```

从中删除`icons`属性`page_action`并将其放在根级别。

# c++ - 将 binomial_heap 与indirect_cmp 一起使用

> ID：12288921
> 
> 赞同：1
> 
> 时间：2012-09-05T20:04:00.367
> 
> 标签：c++, boost

我试图保持一个按属性映射中的值排序的堆。我尝试了下面的代码，但编译器不喜欢我对堆构造函数的参数 (PriorityQueueType pq(indirectComparison);)。根据文档（http://www.boost.org/doc/libs/1_51_0/doc/html/boost/heap/binomial_heap.html），有一个构造函数：

显式 binomial_heap(value_compare const & = value_compare());

这需要一个 value_compare，我认为它是我提供的 IndirectComparisonType 类型（我不太了解可选的模板参数和 base_maker::compare_argument 类型的东西）？

这是供参考的indirect_cmp 文档：http: [//www.boost.org/doc/libs/1_51_0/boost/pending/indirect_cmp.hpp](http://www.boost.org/doc/libs/1_51_0/boost/pending/indirect_cmp.hpp)

```
#include <boost/heap/binomial_heap.hpp>
#include <boost/pending/indirect_cmp.hpp>
#include <boost/array.hpp>
#include <boost/graph/grid_graph.hpp>
#include <iostream>

int main(int, char*[])
{
  // Construct a graph
  boost::array<std::size_t, 2> lengths = { { 2,2 } };
  typedef boost::grid_graph<2> GraphType;
  GraphType graph(lengths);
  typedef boost::graph_traits<GraphType>::vertex_descriptor Vertex;
  typedef boost::property_map<GraphType,
boost::vertex_index_t>::const_type GridIndexMapType;
  GridIndexMapType gridIndexMap(get(boost::vertex_index, graph));

  // Construct a property map
  typedef boost::vector_property_map<float, GridIndexMapType> PriorityMapType;
  PriorityMapType priorityMap(gridIndexMap);

  // Construct the indirect comparison functor
  typedef boost::indirect_cmp<PriorityMapType, std::less<float> >
IndirectComparisonType;
  IndirectComparisonType indirectComparison(priorityMap);

  // Construct the queue
  typedef int ValueType;
  typedef boost::heap::binomial_heap<ValueType,
boost::heap::stable<false>, IndirectComparisonType> PriorityQueueType;
  PriorityQueueType pq(indirectComparison);

  return 0;
} 
```

有谁知道如何正确地将这个间接比较函子提供给队列？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T21:15:11.520

您需要将模板选项括起来`boost::heap::compare`以对其进行标识，如[docs](http://www.boost.org/doc/libs/1_51_0/doc/html/boost/heap/binomial_heap.html#id1598345)中所示。

# internet-explorer - 如何以包括 IE 6、7 和 8 的方式对窗口高度和宽度进行功能检测？

> ID：12288922
> 
> 赞同：0
> 
> 时间：2012-09-05T20:04:32.797
> 
> 标签：internet-explorer, internet-explorer-8, cross-browser, internet-explorer-7, internet-explorer-6

```
if (typeof(window.innerWidth) === 'number') 
```

捕获 Chrome 和 Firefox，并提供了相当明显的方法来确定窗口的高度和宽度。

我应该检测哪些功能以获得可比较的数据（我知道相同的数据可能不是一个选项）来捕获 IE6、7 和 8？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T20:41:15.500

我建议为此使用 jQuery，尤其是跨浏览器的要求。

在 jQuery 中，你有`$(window).width()`，所以你可以很容易地做你想做的事。

```
var winWidth  = $(window).width();   // returns width of browser viewport
var docWidth = $(document).width(); // returns width of HTML document 
```

另见：[http ://api.jquery.com/width/](http://api.jquery.com/width/)

# ruby-on-rails - 在 ruby on rails 中从 class_name 转换为 ClassName（反之亦然）

> ID：12288927
> 
> 赞同：1
> 
> 时间：2012-09-05T20:04:47.443
> 
> 标签：ruby-on-rails, string

我可以尝试自己做这件事，但由于 rails 已经经常处理这个问题，我想也许会有一个帮手。

我想要一个可以接受`"object_name"`和返回的函数`"ObjectName"`（也可以做相反的事情）。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T20:09:00.470

只要您包含 active_support（它在 rails 中），以下内容将适用于任何 ruby​​ 项目：

```
"object_name".classify 
```

# php - 人们如何通过我的联系表发送垃圾邮件

> ID：12288928
> 
> 赞同：2
> 
> 时间：2012-09-05T20:04:53.717
> 
> 标签：php, forms, validation, spam

我今天被联系到从一个域发送大量垃圾邮件。这是一个相对简单的 php 网站，带有一个包含姓名、电子邮件、电话和消息的联系表。除非整个服务器被黑客入侵，否则我看不到该网站可用于向多个用户发送垃圾邮件的任何其他方式。

电子邮件经过验证，错误字符从邮件正文中删除。我尝试了多种方法来尝试通过表单修改标题，但似乎无法正常工作，所以我开始认为表单是安全的。

这是表单验证：

```
 $to='owner@website.com';

              $messageSubject='Enquiry from the website';
              $confirmationSubject='Your email to website.com';
              $confirmationBody="Thankyou for your recent email enquiry to website.com.\n\nYour email has been sent and we will get back to you as soon as possible.\n\nThe message you sent was:\n";
              $email='';
              $body='';
              $displayForm=true;
              if ($_POST){
                $email=stripslashes($_POST['email']);
                $body=stripslashes($_POST['body']);
                $name=stripslashes($_POST['name']);
                $phone=stripslashes($_POST['phone']);
                // validate e-mail address
                $valid=eregi('^([0-9a-z]+[-._+&])*[0-9a-z]+@([-0-9a-z]+[.])+[a-z]{2,6}$',$email);
                $crack=eregi("(\r|\n)(to:|from:|cc:|bcc:)",$body);
                $spam=eregi("http",$body);
                $businessBody = "Enquiry from: $name\nEmail: $email\nPhone: $phone\n\nMessage:\n$body";
                if ($email && $body && $phone && $name && $valid && !$crack & !$spam){
                    if (mail($to,$messageSubject,$businessBody,'From: '.$email."\r\n") && mail($email,$confirmationSubject,$confirmationBody.$body,'From: '.$to."\r\n")){
                        $displayForm=false;
                        echo "<div><p>Your message to us was sent successfully, and a confirmation copy has also been sent to your e-mail address.</p><p>Your message was:<br>".htmlspecialchars($body)."</p></div>";
                    }
                    else echo '<div class="emailMessage"><p>Something went wrong when the server tried to send your message. This might be due to a server error, and is probably not your fault. We apologise for any inconvenience caused. You are welcome to telephone us on 01383 625110</p></div>'; // the messages could not be sent
                }
                else if ($crack) echo '<div class="emailMessage"><p>Your message contained e-mail headers within the message body. This seems to be a cracking attempt and the message has not been sent.</p></div>'; // cracking attempt
                else if ($spam) echo '<div class="emailMessage"><p>Your message contained characters that our system has flagged as spam email and has not been sent.</p></div>'; // spam mail!
                else echo '<div class="emailMessage"><p>Your message could not be sent. You must complete all fields - name, phone number, e-mail address and a message.</p></div>'; // form not complete
                } 
```

任何人都可以看到这种形式可以被滥用的方式吗？

## 编辑

事实证明，有人在为群发邮件构建的服务器上放置了另一个加密文件，所以它实际上并不是来自这种形式。无论如何感谢您的答案，他们可能会帮助其他人！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T20:09:01.587

使用像[SwiftMailer](http://swiftmailer.org/)这样的适当的邮件类，你会遇到更少的麻烦（和更好看的代码，也是）。通常，通过在“from”或其他标题中添加换行符来滥用这些形式，从而允许它们设置自己的恶意标题。

例如：

```
if (mail($to,$messageSubject,$businessBody,'From: '.$email."\r\n") && mail($email,$confirmationSubject,$confirmationBody.$body,'From: '.$to."\r\n")){ 
```

虽然你已经剥离了斜线，但你并没有剥离新的线条。如果我将我的电子邮件设置为：

```
ceejayoz@example.com
Bcc: victim@example.com 
```

受害者@example.com 在电子邮件中被密件抄送。通过一些更聪明的东西——把它变成一个多部分的电子邮件并添加一个额外的默认部分——他们可以完全自定义电子邮件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T20:12:12.320

如果 $_POST['email'] 是，则可以批量发送：

```
usera@test.com,userb@test.com,userc@test.com 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T20:25:21.907

@ceejayoz 的回答很好，虽然我看到您试图在代码中防止密件抄送和换行符，但仅限于电子邮件正文，而不是电子邮件字段。这是最容易受到黑客攻击的电子邮件字段。

这是我多年来用来保护电子邮件字段的一些代码：

```
 $value = "some@email.com";
    if (!preg_match("/^[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i", $value)){
         $error[$i] = "Invalid email address.";
    }
        //Nuke email header injection.
        $submitted = $value;
        $value = str_replace('\\r', '\n', $value);
        $value = str_replace('\\n', '\n', $value);
        $value = str_replace('\r', '\n', $value);
        $value = str_replace(',', '\n', $value);
        $value = str_replace(';', '\n', $value);
        $value = str_replace(' ', '\n', $value);
        $value = explode('\n', $value);
        $value = $value[0];
        if (trim($value) !== trim($submitted)) {
            echo "Stop hacking me!";
        }
    } 
```

或者使用其他人的课程，正如 ceejayoz 所说。

此外，请考虑使用验证码和其他方式，或限制每分钟提交次数，作为为代码添加多级防御的另一种方式。

# javascript - 从另一个函数达到 $this 值

> ID：12288931
> 
> 赞同：0
> 
> 时间：2012-09-05T20:05:01.207
> 
> 标签：javascript, jquery

我的 javascript 文件中有这些行，它工作正常。

```
handleInput = function(e) {
    var $this = $(this),
    id = $this.attr("id");
    alert(id);
}

....

something.bind("keyup", handleInput); 
```

然后我决定延迟输入功能并添加以下几行：

```
handleDelayedInput = function(e) {
    setTimeout(handleInput(e), 50);
}

.....

something.bind("keyup", handleDelayedInput); 
```

但是现在`alert(id);`说未定义，因为我认为我无法将 this 传递给该函数。

我对吗？我该如何解决？有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T20:10:50.237

那是因为您不再`handleInput`像从 jQuery 绑定方法调用它时那样传递任何对象上下文。就我个人而言，我会像这样重写整个事情：

```
something.on("keyup", function(e) {
    var obj = $(this);
    setTimeout(function(obj) {
        alert(obj.attr("id");
    }, 50);
}); 
```

请注意使用 of`on()`而不是`bind()`which 现在是首选用法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T20:07:44.947

使用[`apply`功能](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)：

```
var handleDelayedInput = function(e) {
    var that = this;
    setTimeout(function() {
        handleInput.apply(that, [e]);
    }, 50);
}

something.bind("keyup", handleDelayedInput); // Assuming something is a 
                                             // jQuery object 
```

这是一个[有效的 jsFiddle](http://jsfiddle.net/UFDYc/)。

`handleInput`像这样调用`setTimeout(handleInput(e), 50);`会丢失上下文，所以在这种情况下`this`不会是你所期望的`handleInput`。

另外，`setTimeout`应该传递一个函数，而不是函数的*结果*（除非结果本身就是一个函数）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T20:07:55.273

当 jQuery 调用事件处理程序时，它会设置处理程序函数的上下文。在您的第二段代码中调用 handleInput 时，情况并非如此，因此`this`设置为 default value `window`。

您可以使用[`apply`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)或[`call`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/call)设置上下文：

```
handleInput.call(this, e); 
```

两者之间的区别在于，它`apply`接受一个参数数组，而您可以`call`一个一个地传递参数：`func.apply(context, arg1, arg2)`.

所以你的完整代码是：

```
handleInput = function(e) {
    var $this = $(this),
    id = $this.attr("id");
    alert(id);
}

handleDelayedInput = function(e) {
    var element = this;
    setTimeout(function(){
        handleInput.call(element, e);
    }, 50);
}

something.bind("keyup", handleDelayedInput); 
```

请注意，由于我们使用的是 setTimout，我们需要找到一种方法将元素传递给超时处理函数。此外，在您的代码中，您使用的返回值`handleInput(e)`作为处理程序函数 - 而不是`handleInput`.

不过，我同意 Mike 的观点，如果您自己编写了 handleInput 并且可以修改它，那么使用`this`而不是仅仅传递参数是没有意义的。如果您仍然想在其他地方使用 handleInput 作为直接处理程序，那么保持它的方式是有意义的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-05T20:10:08.277

你可以这样做：

```
handleInput = function(e) {
   var $this = $(this),
   id = $this.attr("id");
   setTimeout(function() {alert(id);}, 50);
} 
```

# ruby - NoMethodError: undefined method `name' (我的 Pickaxe Book 代码中的棘手错误)

> ID：12288932
> 
> 赞同：0
> 
> 时间：2012-09-05T20:05:02.220
> 
> 标签：ruby

我一直在关注镐书中的代码示例，但最近被我的代码中的一个错误难住了。

添加这行代码后（在下面的完整文件中的~第 60 行）-

`@index.add_to_index(song, song.name, song.artist)`

我收到此错误：

```
Loaded suite ruby_juke
Started
E
Finished in 0.000213 seconds.

  1) Error:
test_delete(TestSongList):
NoMethodError: undefined method `name' for #<Song:0x10cd95eb0>
    ruby_juke.rb:60:in `append'
    ruby_juke.rb:163:in `test_delete'

1 tests, 0 assertions, 0 failures, 1 errors 
```

我的问题是，那一行代码在做什么导致错误？

如果您可以提供帮助，请随时发送提示、提示链接、问我问题等。

谢谢！-d

ps 如果有帮助，这里是我的 ruby​​_juke.rb 程序的内容：

```
#!/usr/local/bin/ruby -w

class Song

  attr_writer :duration

  @@plays = 0

  def initialize(name, artist, duration)
    @name     = name
    @artist   = artist
    @duration = duration
    @plays    = 0
  end

  def play
    @plays  += 1   # same as @plays = @plays + 1
    @@plays += 1
    "this song: #@plays plays. total #@@plays plays."
  end

  def duration_in_minutes
    @duration/60.0    # force floating point
  end

  def duration_in_minutes=(new_duration)
    @duration = (new_duration*60).to_i
  end

  def to_s
    "song: #@name--#@artist (#@duration)"
  end

end

class KaraokeSong < Song

  def initialize(name, artist, duration, lyrics)
    super(name, artist, duration)
    @lyrics = lyrics
  end

  # format ourselves as a string by appending
  # our lyrics to our parent's #to_s value.
  def to_s
    super + " [#@lyrics]"
  end

end

class SongList

  def initialize
    @songs = Array.new
    @index = WordIndex.new
  end

  def append(song)
    @songs.push(song)
    @index.add_to_index(song, song.name, song.artist)
    self
  end

  def lookup(word)
    @index.lookup(word)
  end

  def delete_first
    @songs.shift
  end

  def delete_last
    @songs.pop
  end

  def [](index)
    @songs[index]
  end

  def with_title(title)
    @songs.find {|song| title == song.name }
  end

  MAX_TIME = 5*60        # 5 minutes

  def SongList.is_too_long(song)
    return song.duration > MAX_TIME
  end

end

class WordIndex

  def initialize
    @index = {}
  end

  def add_to_index(obj, *phrases)
    phrases.each do |phrase|
      phrase.scan(/\w[-w']+/) do |word|      # extract each word
        word.downcase!
        @index[word] = [] if @index[word].nil?
        @index[word].push(obj)
      end
    end
  end

  def lookup(word)
    @index[word.downcase]
  end

end

class MyLogger

  private_class_method :new

  @@logger = nil

  def MyLogger.create
    @@logger = new unless @@logger
    @@logger
  end

end

class Button

  def initialize(label)
    @label = label
  end

end

songlist = SongList.new

class JukeboxButton < Button

  def initialize(label, &action)
    super(label)
    @action = action
  end

  def button_pressed
    @action.call(self)
  end

end

start_button = JukeboxButton.new("Start") { songlist.start }
pause_button = JukeboxButton.new("Pause") { songlist.pause }

require 'test/unit'
class TestSongList < Test::Unit::TestCase

  def test_delete
    list = SongList.new
    s1 = Song.new('title1', 'artst1', 1)
    s2 = Song.new('title2', 'artst2', 2)
    s3 = Song.new('title3', 'artst3', 3)
    s4 = Song.new('title4', 'artst4', 4)
    list.append(s1).append(s2).append(s3).append(s4)
    assert_equal(s1, list[0])
    assert_equal(s3, list[2])
    assert_nil(list[9])
    assert_equal(s1, list.delete_first)
    assert_equal(s2, list.delete_first)
    assert_equal(s4, list.delete_last)
    assert_equal(s3, list.delete_last)
    assert_nil(list.delete_last)
  end

end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T20:07:30.283

您的`Song`课程没有`name`方法（如错误所述）。您需要添加一个返回私有变量值的方法`@name`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T20:13:18.937

你没有 getter 和 setter for `name`。例如

```
def name
 @name
end

def name=(name)
 @name = name
end 
```

对所有要显式设置的属性执行此操作，而不是通过初始化程序。有一个捷径。`attr_accessor`. 阅读：[http ://www.rubyist.net/~slagell/ruby/accessors.html](http://www.rubyist.net/~slagell/ruby/accessors.html)

# zend-framework - Zend 布局 headLink()

> ID：12288933
> 
> 赞同：0
> 
> 时间：2012-09-05T20:05:03.050
> 
> 标签：zend-framework, http-status-code-404

我已经使用 Zend 设置了布局，当我使用时：

```
<?php echo $this->headLink()->prependStylesheet('/css/global.css'); ?> 
```

浏览器找不到我的 css 文件。它位于：

```
public/css/ 
```

我的 vHosts 文件中的文档路由设置为 /public。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T21:03:35.237

尝试

```
$this->headLink()->prependStylesheet($this->baseUrl().'/css/global.css') 
```

您必须定义 baseUrl 以便它可以找到 css 的路径

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T20:07:21.970

尝试`<?php echo $this->headLink()->prependStylesheet('css/global.css'); ?>`

# jquery - 数据表 fnrender 函数

> ID：12288937
> 
> 赞同：1
> 
> 时间：2012-09-05T20:05:30.603
> 
> 标签：jquery, jquery-datatables

我正在使用很棒的 datatables jquery 插件，但是我在渲染表格时遇到了一些问题。

我有以下代码：

```
$(document).ready(function() {
var jsonEmp="";
$.getJSON("../lib/violation_select_emp.php", function(json) {
    jsonEmp = json;
}); 

var oTable;
oTable = $('#uview').dataTable({
    "bStateSave":true,
    "bProcessing": true,
    "bServerSide": true,
    "sAjaxSource": "../lib/server_processing_emp_list.php",
    "sPaginationType": "four_button",
    "aaSorting": [[ 0, "asc" ]],
    "aoColumns": [
    {
        "fnRender": function ( oObj ) {
         var empID=oObj.aData[4];
         var empName=oObj.aData[5];
         return "<a href='viewEmployer.php?empID="+empID+"'>"+empName+"</a>";
    }
    },
    {
        "fnRender": function ( oObj ) {
            var numAlerts=jsonEmp.length;
            var i=0;
            var alerts=0;
            while(i<numAlerts){
            if(jsonEmp[i]==oObj.aData[3]){
                alerts++;
            }
            i++;
    }
    return alerts;
    }
});
}); 
```

当我加载页面时，fnrender 列中没有显示任何内容，但是当我点击下一个分页按钮，然后点击上一个分页按钮时，我看到了我想要查看的信息。

我的理论是表格需要刷新，但是当我这样做时，它会导致同样的事情发生。

不知道该怎么办，希望有人可以帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T17:16:20.383

您有 $.getJSON 的回调函数。在回调函数中，您为使用“”初始化的 jsonEmp 变量分配一个值。您的代码不会等待您发送请求的网站的响应，您在 $.getJSON 下面的 Javascript 代码不会等待页面响应，从而导致在分配现实生活之前使用 jsonEmp 的错误对它的价值。

建议：

```
$(document).ready(function() {
var jsonEmp="";
var oTable;
$.getJSON("../lib/violation_select_emp.php", function(json) {
    jsonEmp = json;
oTable = $('#uview').dataTable({
    "bStateSave":true,
    "bProcessing": true,
    "bServerSide": true,
    "sAjaxSource": "../lib/server_processing_emp_list.php",
    "sPaginationType": "four_button",
    "aaSorting": [[ 0, "asc" ]],
    "aoColumns": [
    {
        "fnRender": function ( oObj ) {
         var empID=oObj.aData[4];
         var empName=oObj.aData[5];
         return "<a href='viewEmployer.php?empID="+empID+"'>"+empName+"</a>";
    }
    },
    {
        "fnRender": function ( oObj ) {
            var numAlerts=jsonEmp.length;
            var i=0;
            var alerts=0;
            while(i<numAlerts){
            if(jsonEmp[i]==oObj.aData[3]){
                alerts++;
            }
            i++;
    }
    return alerts;
    }
});
}); 

}); 
```

如您所见，我已经将您的对象的初始化放入回调函数中，我仍然认为您的问题来自初始化，但我没有测试代码。让我知道我的建议的结果。

祝你好运！

# javascript - 什么是“真”、“假”和“空”？

> ID：12288945
> 
> 赞同：2
> 
> 时间：2012-09-05T20:05:45.883
> 
> 标签：javascript, keyword

为什么它们不是关键字？这些是什么？

```
true, false, null 
```

**更新快速回答**

这些是保留字，但它们不是关键字。

由规范验证的小技术区别 - ES3 和 ES5

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-05T20:08:16.477

它们是*布尔文字*。从[规范](http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf)：

> ```
> BooleanLiteral ::
>    true
>    false 
> ```
> 
> *   布尔文字`true`的值是布尔类型的值，即`true`.
> *   布尔文字`false`的值是布尔类型的值，即`false`.

`10`它类似于*数字文字*或*字符串*文字`'foo'`。

 **保留字*包括关键字和文字。`true`和`false`是*保留字*， 但它们不是*关键字*。以下是*关键字*：

```
break    do       instanceof typeof
case     else     new        var
catch    finally  return     void
continue for      switch     while
debugger function this       with
default  if       throw
delete   in       try 
```

请注意，`true`并且`false`不会出现在此列表中。

我认为您的困惑来自于没有意识到这两个术语*关键字*和*保留字*是不一样的。每个关键字都是保留字，但并非每个保留字都是关键字。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-05T20:18:16.247

实际上`true`和`false`是 Javascript 中的保留字，来自：

[http://ecma-international.org/ecma-262/5.1/#sec-7.6.1](http://ecma-international.org/ecma-262/5.1/#sec-7.6.1)

```
A reserved word is an IdentifierName that cannot be used as an Identifier.

Syntax
    ReservedWord ::
        Keyword
        FutureReservedWord
        NullLiteral
        BooleanLiteral 
```

并且在

[http://ecma-international.org/ecma-262/5.1/#sec-7.8.2](http://ecma-international.org/ecma-262/5.1/#sec-7.8.2)

你可以阅读：

```
Boolean Literals

Syntax
    BooleanLiteral ::
        true
        false 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-05T20:08:49.983

[Mozilla 文档](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Reserved_Words)

> 此外，文本 null、true 和 false 保留在 ECMAScript 中以供正常使用。

它们实际上似乎是“保留”使用的，但我不知道为什么它们没有被列为保留字。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-05T20:09:44.320

使用非对象 javascript，您只需编写

```
if( sami.value = true) //Noticed i didn't put == 
```

如果是 object 布尔对象代表两个值：“true”或“false”。

以下代码创建一个名为 myBoolean 的布尔对象：

```
var myBoolean=new Boolean(); 
```

如果布尔对象没有初始值，或者传递的值是以下之一：

```
0
-0
null
""
false
undefined
NaN 
```

对象设置为假。对于任何其他值，它都设置为 true（即使使用字符串“false”）！*

# c++ - 如何实现多线程异步操作？

> ID：12288946
> 
> 赞同：0
> 
> 时间：2012-09-05T20:05:49.660
> 
> 标签：c++, multithreading, boost-thread

这是我目前的方法的样子：

```
// Somewhere in a UI class
// Called when a button called "Start" clicked
MyWindow::OnStartClicked(Event &sender)
{
  _thread = new boost::thread(boost::bind(&MyWindow::WorkToDo, this));
}

MyWindow::WorkToDo()
{
  for(int i = 1; i < 10000000; i++)
  {
    int percentage = (int)((float)i / 100000000.f);
    _progressBar->SetValue(percentage);
    _statusText->SetText("Working... %d%%", percentage);
    printf("Pretend to do something useful...\n");
  }
}

// Called on every frame
MyWindow::OnUpdate()
{
  if(_thread != 0 && _thread->timed_join(boost::posix_time::seconds(0))
  {
    _progressBar->SetValue(100);
    _statusText->SetText("Completed!");
    delete _thread;
    _thread = 0;
  }
} 
```

但我担心这远非安全，因为我在程序执行结束时不断收到未处理的异常。

我基本上想在不阻塞 GUI 部分的情况下将繁重的任务分离到另一个线程中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T20:13:24.643

有很多方法可以做到这一点，很难确定。对于 Windows，您通常会根据 GUI 操作启动线程，并且结果和/或进度通过消息泵循环发送回 GUI。您将声明或注册自定义窗口消息，并让工作线程的各种报告位置将它们发布到主窗口句柄或子窗口句柄设置以监视异步进度。

有很多很多方法可以做到这一点。以上只是一种描述，但对于中等任务，我发现它通常可以解决问题。既然如此，您就可以正确使用此处显示的代码。您正在直接设置并绕过消息循环（不是真的，但就您需要关注的而言），所以这应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T21:02:42.903

如果你可以使用 Boost 或 C++11，试试 boost/std::future 和 async

# asp.net - 当网站托管在 IIS 上时，CSS 不会立即加载

> ID：12288948
> 
> 赞同：0
> 
> 时间：2012-09-05T20:06:01.223
> 
> 标签：asp.net, css, iis, iis-7

我在 IIS 上有一个 ASP.net 网站，每当我第一次直接通过 IIS 管理器甚至通过它的托管名称查看网页时，它只会加载网页的内容，而不是 CSS。我必须刷新它才能使页面正确定位。

有没有其他人遇到过这个问题并且知道我可以解决这个问题的方法？

先感谢您！

# java - 从 keyTyped 发送火灾事件后未调用 getTableCellRendererComponent

> ID：12288951
> 
> 赞同：0
> 
> 时间：2012-09-05T20:06:11.953
> 
> 标签：java, jtable, tablecellrenderer

您好，有一个 Jtable，其中一列具有特定的单元格渲染模型。这个模型，只是在这个列中放了按钮而不是文本数据。

表格的第一个显示效果很好。当我使用更改内容顺序的函数时，仍会为此列调用模型（通过调用 fireTableDataChanged() 来强制重绘）。

现在，我希望删除键删除表的当前行。为此，我使用以下代码：

```
public void keyTyped(KeyEvent arg0) {
    if (arg0.getKeyChar() == KeyEvent.VK_DELETE) {
        int currentRow = this.m_data.currentRow();
        if (currentRow >= 0) {
            this.m_data.deleteRow(currentRow);
            System.out.println("mise a jour après destruction de ligne");
            this.fireTableRowsDeleted(currentRow, currentRow);
        }
    }
} 
```

（m_data 是我的表模型）。令人惊讶的是，数据更新了（行已经消失），但第一列是空的。而且我的跟踪显示只调用了 getValueAt() 。未调用 getTableCellRendererComponent()。

我试图触发 fireTableDataChanged() 而不是 fireTableRowsDeleted() 但它是一回事。因此，它似乎与火函数无关。关于这个问题的起源以及解决方法的任何想法？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T20:46:02.770

这是我们用于表格模型的代码。你可以使用它。如您所见，它非常简单干净。

```
 public abstract class BeanTableModel<B> extends ArrayList<B>
                    implements TableModel {

            private List<TableModelListener> listeners = new ArrayList();
            private TableModelAttributeList attributeList;

            public BeanTableModel() {
                super();
            }

            public BeanTableModel(Object[][] attributes) {
                super();
                this.attributeList = new TableModelAttributeList(attributes) {
                };
            }

            public TableModelAttributeList getAttributeList() {
                return attributeList;
            }

            public final void setAttributeList(TableModelAttributeList attributeList) {
                this.attributeList = attributeList;
            }

            @Override
            public final int getRowCount() {
                return size();
            }

            @Override
            public final int getColumnCount() {
                if (attributeList != null) {
                    return attributeList.size();
                } else {
                    return 0;
                }
            }

            @Override
            public final String getColumnName(int columnIndex) {
                if (attributeList != null) {
                    return attributeList.getColumnName(columnIndex);
                } else {
                    return null;
                }
            }

            @Override
            public final Class<?> getColumnClass(int columnIndex) {
                if (attributeList != null) {
                    return attributeList.getColumnClass(columnIndex);

                } else {
                    return Object.class;
                }
            }

            @Override
            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return false;
            }

            @Override
            public final Object getValueAt(int rowIndex, int columnIndex) {
                try {
                    if (rowIndex >= 0) {
                        return (attributeList != null) ? attributeList.getValue(this.get(
                                rowIndex), columnIndex) : null;
                    } else {
                        return get(rowIndex);
                    }
                } catch (Exception ex) {
                    Logger.getLogger(BeanTableModel.class.getName()).log(Level.SEVERE,
                                                                            null, ex);
                    return null;
                }
            }

            @Override
            public final boolean add(B e) {
                boolean result = super.add(e);

                if (result) {
                    fireListeners();
                }

                return result;
            }

            @Override
            public final boolean addAll(Collection<? extends B> c) {
                boolean result = super.addAll(c);

                if (result) {
                    fireListeners();
                }

                return result;
            }

            public final void change(Collection<? extends B> c) {
                super.clear();
                super.addAll(c);
                fireListeners();
            }

            @Override
            public final boolean addAll(int index, Collection<? extends B> c) {
                boolean result = super.addAll(index, c);

                if (result) {
                    fireListeners();
                }

                return result;
            }

            @Override
            public final void clear() {
                super.clear();
                fireListeners();
            }

            @Override
            public final boolean remove(Object o) {
                boolean result = super.remove(o);

                if (result) {
                    fireListeners();
                }

                return result;
            }

            @Override
            public final boolean removeAll(Collection<?> c) {
                boolean result = super.removeAll(c);

                if (result) {
                    fireListeners();
                }

                return result;
            }

            @Override
            protected final void removeRange(int fromIndex, int toIndex) {
                super.removeRange(fromIndex, toIndex);
                fireListeners();
            }

            @Override
            public final boolean retainAll(Collection<?> c) {
                boolean result = super.retainAll(c);

                if (result) {
                    fireListeners();
                }

                return result;
            }

            @Override
            public final B remove(int index) {
                B b = super.remove(index);
                fireListeners();
                return b;
            }

            @Override
            public final void add(int index, B element) {
                super.add(index, element);
                fireListeners();
            }

            @Override
            public final B set(int index, B element) {
                B b = super.set(index, element);
                fireListeners();
                return b;
            }

            @Override
            public final void trimToSize() {
                super.trimToSize();
                fireListeners();
            }

            @Override
            public void setValueAt(Object aValue, int rowIndex, int columnIndex) {
                //Do Nothing
            }

            @Override
            public final void addTableModelListener(TableModelListener l) {
                listeners.add(l);
            }

            @Override
            public final void removeTableModelListener(TableModelListener l) {
                listeners.remove(l);
            }

            public final void fireListeners() {
                TableModelEvent evt = new TableModelEvent(this);

                for (TableModelListener listener : listeners) {
                    listener.tableChanged(evt);
                }
            }

            public final ArrayList<B> serialize() {
                return new ArrayList<B>(this);
            }
          } 
```

这是针对格式及其解释方式：

```
 public abstract class TableModelAttributeList {

            public static final int COLUMN_NAME = 0;
            public static final int CLASS = 1;
            public static final int ATTRIBUTE_NAME = 2;
            public static final int FORMAT = 3;
            public static final int REPLACE = 4;
            private final Object[][] attributes;
            private final Pattern[] patterns;

            public TableModelAttributeList(Object[][] attributes) {
                this.attributes = attributes;
                patterns = new Pattern[attributes.length];

                for (int i = 0, size = attributes.length; i < size; i++) {
                    if (attributes[i][REPLACE] != null) {
                        patterns[i] = Pattern.compile((String) attributes[i][FORMAT]);
                    }
                }
            }

            public final String getColumnName(int column) {
                return (String) attributes[column][COLUMN_NAME];
            }

            public final Class<?> getColumnClass(int column) {
                return (Class<?>) attributes[column][CLASS];
            }

            public final int size() {
                return attributes.length;
            }

            public final Object getValue(Object bean, int column) throws
                    Exception {

                try {
                    Object value = null;

                    if (attributes[column][ATTRIBUTE_NAME] == null) {
                        return "";
                    }

                    if (attributes[column][ATTRIBUTE_NAME].equals("this")) {
                        return bean;

                    } else {
                        try {
                        value = PropertyUtils.getProperty(bean,
                                                            (String) attributes[column][ATTRIBUTE_NAME]);
                        } catch (NullPointerException ex) {
                        return "";

                        } catch (NestedNullException ex) {
                        return "";
                        }
                    }
                    if (value == null) {
                        return null;

                    } else if (patterns[column] != null) {
                        Matcher matcher = patterns[column].matcher(String.valueOf(value));
                        if (matcher.find()) {
                        return matcher.replaceAll(
                                (String) attributes[column][REPLACE]);
                        } else {
                        return null;
                        }

                    } else if (value instanceof Date) {
                        if (attributes[column][FORMAT] != null) {
                        DateFormat format = new SimpleDateFormat(
                                (String) attributes[column][FORMAT]);
                        return format.format((Date) value);

                        } else {
                        return value;
                        }

                    } else if (attributes[column][FORMAT] != null) {
                        return String.format(
                                (String) attributes[column][FORMAT], value);
                    } else {
                        return value;
                    }
                } catch (IllegalAccessException ex) {
                    String message = "The property named '"
                            + (String) attributes[column][ATTRIBUTE_NAME]
                            + "' has a private getter method";
                    throw new Exception(message, ex);
                } catch (InvocationTargetException ex) {
                    String message = "An exception has ocurred while retrieving value for bean property '"
                            + (String) attributes[column][ATTRIBUTE_NAME] + "'";
                    throw new Exception(message, ex);
                } catch (NoSuchMethodException ex) {
                    String message = "The bean doesn't have a property named '"
                            + (String) attributes[column][ATTRIBUTE_NAME] + "'";
                    throw new InvalidModelAttributesException(message, ex);
                }
            }
          } 
```

这是应该如何创建表模型的：

```
 public class SelectEmployeeTableModel extends BeanTableModel<Empleados> {

                public static final String NOMBRE = "Nombre";

                public static final String DEPARTAMENTO = "Departamento";

                public static final String FECHA_BAJA = "FechaBaja";

                public SelectEmployeeTableModel() {
                    super(new Object[][]{
                        {NOMBRE                   ,  Object.class,     "nombreCompleto"           , null, null},
                        {DEPARTAMENTO       ,  Object.class,     "departamentoId.nombre"    , null, null},
                        {FECHA_BAJA       ,  Object.class,     "fechaBaja"    , null, null}
                    });
                }
             } 
```

第一列是可见的列名，第二列是数据的类型（如果要显示复选框，请将其替换为 Boolean.class），第三列是不带“get”前缀的名称，因为它使用反射，第四个是格式（对于一个日期，它可以是“dd/MM/yyyy”或“$%.2f”对于十进制数），第五个是用正则表达式替换。

然后在要使用它的面板中执行以下操作：

```
 jtable.setModel(new SelectEmployeeTableModel()); 
```

如果您需要更改表模型中的数据

```
 model.change(collectionName); 
```

如果你只是出于某种原因想要刷新，你可以

```
 model.fireListeners(); 
```

渲染器从未失败过。至少你没有在实体中设置吸气剂。

如果你有任何疑问，不要害怕问！祝你有美好的一天。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-08T17:34:21.300

好的，我终于找到了问题所在。我有一个 ListSelectionListener，在某些情况下，它发送了一个 fireTableCellUpdated(-1,0)。这是“愚蠢的Java”解释为“删除表格渲染”的命令。

# html - 将站点移动到子文件夹后 Mod_rewrite 不起作用

> ID：12288955
> 
> 赞同：0
> 
> 时间：2012-09-05T20:06:48.360
> 
> 标签：html, url, mod-rewrite, url-rewriting, url-routing

我刚刚将一个旧站点连同它的 mod_rewrite 规则一起移到了一个子文件夹，但它们不再起作用了。

例如，一条规则是：

```
#   Input:  noticias/
#   Output: noticias.php
RewriteRule ^noticias/?$  noticias.php 
```

它应该从 mydomain.com/movedsite/noticias/ 到 mydomain.com/movedsite/noticias.php

它没有：错误消息说

未找到 - 在此服务器上未找到请求的 URL /mydomainfolder/movedsite/noticias.php。

正如另一个论坛问题中所建议的那样，我尝试在我的规则元素前面添加斜杠：

重写规则 ^/noticias/?$ /noticias.php

那也行不通。

有人可以帮我吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T23:31:47.193

您可能需要设置 RewriteBase：

> 当您在每个目录 (htaccess) 上下文中的替换中使用相对路径时，需要此指令，除非以下任一条件为真：
> 
> *   原始请求和替换位于 DocumentRoot 下（与通过其他方式（例如别名）可访问相反）。
>     
>     
> *   包含 RewriteRule 的目录的文件系统路径（以相对替换为后缀）作为服务器上的 URL 路径也是有效的（这种情况很少见）。

[http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewritebase](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewritebase)

# curl - curl 选项 CURLOPT_HTTPPROXYTUNNEL 是什么意思？

> ID：12288956
> 
> 赞同：12
> 
> 时间：2012-09-05T20:06:59.597
> 
> 标签：curl, http-proxy

在 cURL 文档中，有一个名为的选项[`CURLOPT_HTTPPROXYTUNNEL`](https://curl.haxx.se/libcurl/c/CURLOPT_HTTPPROXYTUNNEL.html)被定义为在启用时通过代理创建隧道。

但是，我不知道隧道是什么以及它做什么。如果我不使用这样的隧道会有什么不同？

```
curl_setopt($session, CURLOPT_HTTPPROXYTUNNEL, 1) 
```

**更新：**

我得到的是隧道指的是一个`HTTP CONNECT METHOD`，这就是我理解它的作用：

基于 HTTP 的隧道方法使用 HTTP CONNECT 方法/命令。客户端向 HTTP 代理发出 HTTP CONNECT 命令。然后代理与特定的服务器：端口建立 TCP 连接，并在该服务器：端口和客户端连接之间中继数据。因为这会造成安全漏洞，支持 CONNECT 的 HTTP 代理通常会限制对 CONNECT 方法的访问。代理只允许访问特定授权服务器的白名单。

那么，问题是，使用和不使用 CONNECT 方法连接到代理有什么区别？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-28T17:21:49.380

**没有`CURLOPT_HTTPPROXYTUNNEL`**

没有`CURLOPT_HTTPPROXYTUNNEL`：您只需使用代理地址/端口作为 HTTP 请求的目标。代理将读取您查询的 HTTP 标头，将您的请求转发到目的地（使用您的 HTTP 标头），然后将响应写入您。

**示例步骤：**

1.  `HTTP GET /index.html`发给`1.1.1.1 (proxy)`
2.  `1.1.1.1`接收请求并解析标头以获取 HTTP 请求的最终目的地。
3.  `1.1.1.1`将您的查询和标题转发到`www.site.com (destination in request headers)`.
4.  `1.1.1.1`将收到的回复写回给您`www.site.com`

**和`CURLOPT_HTTPPROXYTUNNEL`**

With ：您要求代理通过执行HTTP 请求直接`CURLOPT_HTTPPROXYTUNNEL`打开到您的目的地的直接二进制连接（如 HTTPS，称为 a ）。当隧道正常时，代理给你写回一个. 当它收到您的浏览器开始直接查询目的地时：代理不解析HTTP头，理论上不读取隧道数据，它只是转发它，这就是为什么它被称为隧道！`TCP Tunnel``CONNECT``HTTP/1.1 200 Connection established`

**示例步骤：**

1.  `HTTP CONNECT`发给`1.1.1.1`
2.  `1.1.1.1`接收`HTTP CONNECT`并获取您最终目的地的 ip/port（`header`字段 of `HTTP CONNECT`）。
3.  `1.1.1.1``TCP Socket`通过做一个`TCP handshake`到你的目的地打开一个`2.22.63.73:80 (ip/port of www.site.com)`。
4.  `1.1.1.1`通过将您的管道连接`TCP Socket`到`TCP Socket`打开的通道`2.22.63.73:80`然后将您写回`HTTP/1.1 200 Connection established`女巫来建立隧道，这意味着您的客户端现在可以让您的查询抛出`TCP Tunnel`（收到的 TCP 数据将直接传输到服务器，反之亦然）。

# java - 打印字符时出现未知问号

> ID：12288970
> 
> 赞同：0
> 
> 时间：2012-09-05T20:07:48.693
> 
> 标签：java

对于一个班级项目，我正在生成一个类似 ROT13 的加密方法，我们唯一的区别是，不是第 13 个字符，而是第 9 个字符。令人惊讶的是，我能够制作出适用于小写字母的东西，看看我的方法是否有效。

它可以工作，但由于某种原因，出现了奇怪的字符，更常见的是问号，有时只是原始字符数组中没有的额外字符。

例如：我的名字导致`ljb|nh?`. `|`不`?`应该在那里，至少据我所知他们不应该在那里。

谁能通过查看我的代码告诉我为什么会发生这种情况？

```
public class Encrypt {
    public static void main(String[] args) {
        // Lower a-z: 97-122; Higher A-Z: 65-90
        jumble("casey");
    }
    public static void jumble(String input) {
        char[] phraseChar = input.toCharArray();
        // StringBuilder output = new StringBuilder("");

        for (int i = 0; i < phraseChar.length; i++) {
            System.out.print("" + phraseChar[i]);
        }

        System.out.println();

        for (int j = 0; j < phraseChar.length; j++) {
                int i = (int) phraseChar[j];
                if (i >= 'a' && i <= 'z') {
                    i += 9;
                    if (i > 'z') {
                        int newChar = 96 + (i - 'z');
                        System.out.print((char) newChar);
                    }
                    System.out.print((char) i);
            }
        }
    }
} 
```

任何能帮我查明这个问题的人都是圣人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T20:12:42.477

```
if (i >= 'a' && i <= 'z') { 
   i += 9; 
   if (i > 'z') { 
       int newChar = 96 + (i - 'z'); 
       System.out.print((char) newChar); 
   } 
   System.out.print((char) i);
 } 
```

如果`i`超出范围，您将打印“更正”的字符和原始的越界字符。放一个`else`

我不是圣人。为这些事情使用调试器。这些知识将来会派上用场。

# java - 有没有办法在没有一系列 if 语句的情况下实现这一目标？

> ID：12288976
> 
> 赞同：0
> 
> 时间：2012-09-05T20:08:09.887
> 
> 标签：java

我有一个问题，要求用户输入 1-12 的数字，然后程序返回相应的月份。例如，如果他们用户输入数字“2”，则将打印字符串“Feb”。

我知道如何实现这一点，但我觉得有一种更好、更有效的方法来解决它。我正在考虑的方法是只为每个数字（1-12）制作 12 个 if 语句，然后根据数字打印相应的月份。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T20:10:19.067

使用`Map`按月号键入的键。该值将包含月份名称。

```
Map<Integer, String> monthNames = new HashMap<Integer, String>();
monthNames.put(1, "January");
monthNames.put(2, "February");
...
int month = 3;
System.out.println(monthNames.get(month)); // prints March 
```

还可以考虑使用`DateFormatSymbols`来获取月份名称。请参阅[如何将整数转换为 Java 中的本地化月份名称？](https://stackoverflow.com/questions/1038570/how-can-i-convert-an-integer-to-localized-month-name-in-java)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T20:10:36.723

使用[哈希表](http://docs.oracle.com/javase/7/docs/api/java/util/Hashtable.html)。每个关键点都指向一个元素，例如您的月份。也许您也可以构建自己的哈希函数。可能是 O(1) 访问时间而不是 O(n)。

```
 Hashtable numbers = new Hashtable();
 numbers.put("one", new Integer(1)); //String<-->Integer
 numbers.put("two", new Integer(2));
 numbers.put("three", new Integer(3));

  Integer n = (Integer)numbers.get("two");
 if (n != null) {
     System.out.println("two = " + n);
 }

 You can change the key and element(in this example they are String and Integer) like this:

 Hashtable<Integer, String> abc=new Hashtable<Integer, String>();
    abc.put(new Integer(4), "hello"); 
```

Hashtables 接受key 和 item 的**对象**，因此您可以使用任何扩展 Object 的类。非常灵活。但是，玩对象可能会稍微降低性能，因为你不是在说“基准”之类的东西，这可能是你的朋友。

```
 __________________________________________________________
| You can use Integer.valueOf() (available since Java 1.5) |
| instead of new Integer   Credit to "Steve Kuo"           | 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-05T20:10:51.523

使用[switch](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/switch.html)语句是一种方法。虽然使用不同的数据结构有更优雅的方法，但鉴于您是入门课程，理解数据结构会更难。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-05T20:11:42.773

您可以简单地使用数组来实现这一点

```
arr = {"january", "february"
// etc
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-05T20:13:28.660

你可以使用 switch 语句，因为你没有使用任何结构，否则我会推荐一个 map，虽然一开始它会很像一堆 if 语句。

```
int monthNumber;
    String month;
    switch(monthNumber){
        case 1: month = "January";
                break;
        case 2: ...
    } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-05T20:14:35.300

许多解决方案：

*   使用`Map`数字 1、2、3 到“Jan”、“Feb”、“Mar”等的映射。
*   使用字符串数组，但请记住数组索引以`0`：`String[] months = new String[] {"0 is no month", "Jan", "Feb", "Mar", ... };`
*   使用 switch/case 语句

如果您只需要一次，那么开关/机箱恕我直言是最干净的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-05T21:09:03.100

您可以使用 switch 语句，也可以使用一些数据结构，例如映射、数组、列表等。

开关示例 1：

```
public String getMonth(int month)
{
    switch (month)
    {
        case 1: return "January";
        case 2: return "February";
        case 3: return "March";
        case 4: return "April";
        case 5: return "May";
        case 6: return "June";
        case 7: return "July";
        case 8: return "August";
        case 9: return "September";
        case 10: return "October";
        case 11: return "November";
        case 12: return "December";
    }
} 
```

开关示例 2：

```
public String getCondition(int month)
{
    String message = "";
    switch (month)
    {
        case 1: message = "January";
            break;
        case 2: message = "February";
            break;
        case 3: message = "March";
            break;
        case 4: message = "April";
            break;
        case 5: message = "May";
            break;
        case 6: message = "June";
            break;
        case 7: message = "July";
            break;
        case 8: message = "August";
            break;
        case 9: message = "September";
            break;
        case 10: message = "October";
            break;
        case 11: message = "November";
            break;
        case 12: message = "December";
            break;
        default: message = "Invalid month";
    }
} 
```

试试这些例子。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-05T20:11:47.407

使用地图之类的地图月。然后months.get(i) 得到MonthName。

# javascript - JSTree 的 data.rslt.obj.text() 返回一个文本数组而不是来自所需节点的文本

> ID：12288982
> 
> 赞同：0
> 
> 时间：2012-09-05T20:08:46.203
> 
> 标签：javascript, json, contextmenu, bind, jstree

我试图让 jstree 只返回我正在重命名的节点的文本。相反，它返回当前节点以及所有子节点名称的串联列表。我已将 jstree 配置为按需加载。我可以做些什么来限制上下文菜单返回的文本以重命名为我试图重命名的节点？非常感激！这是完整的jstree代码：

```
 $("#RequirementsTree")
    .bind("select_node.jstree", function(event, data) {
            if(is_requirement_node(data))
            {
                var id = data.rslt.obj.attr("id");

                if(id != null)
                {
                    $("#RequirementsTree").jstree('close_all')
                }
                else {
                    alert("Requirement node select error");
                }
            }
     })
    .bind("create.jstree", function(e, data) {
        // Ajax call to Server with parent node id and new node text
        $.ajax({
            type: "POST",
            url: '@Url.Content("~/RMS/insertRequirementNode")',
            data: {
                    ParentID : ParentNode,
                    ChildNodeText : data.rslt.obj.text()
            },
            success: function(new_data) {
                $.jstree._reference($("#RequirementsTree")).refresh(-1);
                ParentNode = null;
                data = null;
                return new_data;
            }   
        });

        ParentNode = null;
        if (data.rslt.parent == -1) {
            alert("Can not create new root directory");
            // Rollback/delete the newly created node
            $.jstree.rollback(data.rlbk);
            return;
        }

        BranchReqFLag = null;
    }).bind("rename.jstree", function(e, data) {
            $.ajax({
                type: "POST",
                url: '@Url.Content("~/RMS/updateRMSHierarchyNode")',
                data: {
                    NodeID: ParentNode,
                    NodeText: data.rslt.obj.text()
                },
                success: function() {
                    ParentNode = null;
                    data = null;
                }
            });
    }).jstree({
        json_data: {
            data: RBSTreeModel,
            ajax: {
                type: "POST",
                data: function (n) {
                    return {
                        NodeID: n.attr("id").substring(4),
                        Level: n.attr("name").substring(7)
                    };
                },
                url: function (node) {
                    return "/Audit/GetRequirementsTreeStructure";
                },
                success: function (new_data) {
                    return new_data;
                }
            }
        },
        contextmenu: {
            items: function($node) {
                    return {
                        createItem : {
                            "label" : "Create New Branch",
                            "action" : function(obj) { 
                                this.create(obj); 
                                BranchReqFlag = "Branch"; 
                                ParentNode = obj.attr("id").substring(4);
                            },
                            "separator_before" : true
                        },
                        renameItem : {
                            "label" : "Rename Branch",
                            "action" : function(obj) { 
                                this.rename(obj);
                                BranchReqFlag = "Branch";
                                ParentNode = obj.attr("id").substring(4);
                            },
                            "separator_before" : true
                        }
                    };
            }
        },
        plugins: ["themes", "json_data", "ui", "crrm", "contextmenu"]
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T22:39:35.850

`data.rslt.new_name`保存输入的新名称。如果您使用 Chrome 或 Firebugs 进行检查`data`，您将找到大多数此类问题的答案。

```
...
    }).bind("rename.jstree", function(e, data) {
            $.ajax({
                type: "POST",
                url: '@Url.Content("~/RMS/updateRMSHierarchyNode")',
                data: {
                    NodeID: ParentNode,
                    NodeText: data.rslt.new_name
                },
                success: function() {
                    ParentNode = null;
                    data = null;
                }
            });
    })
... 
```

# java - Appengine Datastore 无法通过未编码的键找到现有实体

> ID：12288987
> 
> 赞同：0
> 
> 时间：2012-09-05T20:09:03.497
> 
> 标签：java, google-app-engine, google-cloud-datastore

我在数据存储中有现有实体。我可以通过属性查询找到它的管理控制台，例如：

```
SELECT * FROM UserEntry where email = 'user@mail.com' 
```

并通过编码的密钥字符串查询它，例如：

```
SELECT * FROM UserEntry where __key__ = KEY('cy1hcHByIAsSCVVzZXJFbnRyeM') 
```

但是，当我通过未编码的键查询实体时，找不到它：

```
SELECT * where __key__ = KEY('UserEntry','user@mail.com') 
```

从以前的查询中，我可以验证密钥是否正确，并且相同的查询适用于相同类型的其他实体。

当我尝试通过 JDO API 访问实体时，我遇到了同样的行为：

```
pm.getObjectById(UserEntry.class, "user@mail.com"); 
```

此代码导致以下异常：

```
javax.jdo.JDOObjectNotFoundException: Could not retrieve entity of kind UserEntry with key UserEntry("user@mail.com") 
```

这怎么发生的？我该如何解决这个问题并在将来避免它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T20:45:48.127

离线我们发现 urlsafe 密钥字符串对用户名进行了编码，并添加了空格，就好像它已编码一样`KEY('UserEntry','user@mail.com ')`。这似乎是程序中的输入验证错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T00:48:08.143

电子邮件属性是您在实体上的 PK 吗？因为如果不是，那么查询它是没有意义的。一旦您使用电子邮件作为普通属性发布您的第一个查询，我假设它不会在您的 PK 上重复，因此您不能在 Key(type,email) 上使用它进行查询。

在管理控制台上获取实体后，单击密钥属性以确保电子邮件是密钥的一部分。

# perl - perl：在子例程中添加的哈希条目丢失

> ID：12288989
> 
> 赞同：2
> 
> 时间：2012-09-05T20:09:05.477
> 
> 标签：perl, hash, reference, subroutine

为什么第二次调用 printHash 时哈希为空？

```
my %hash = ();
addToHash(\%hash);
printHash(\%hash);

sub addToHash {
  my %hash = %{$_[0]};
  $hash{"test"} = "test";
  printHash(\%hash);
} 

sub printHash {
  print "printHash: \n";
  my %hash = %{$_[0]};
  foreach my $key (keys %hash) {
      print "key: $key, value: $hash{$key}\n";      
  }
} 
```

输出：

打印哈希：

键：测试，值：测试

打印哈希：

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-05T20:12:31.637

在

```
sub addToHash {
  my %hash = %{$_[0]};
  $hash{"test"} = "test";
  printHash(\%hash);
} 
```

`my %hash`创建一个*新的散列*，将参数引用的散列*复制*到其中。你要

```
sub addToHash {
  my $hr = $_[0];
  $hr->{"test"} = "test";
  printHash($hr);
} 
```

为了修改原始哈希。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-05T20:11:13.630

因为该`addToHash`函数正在将键值对添加到第一个变量的*副本中。*`%hash`

```
my %hash = %{$_[0]} 
```

取消引用中的哈希引用，`$_[0]`但分配`my %hash`创建哈希内容的新副本。如果要`addToHash`影响输入哈希引用，仍然需要将其作为哈希引用：

```
sub addToHash {
    my $hashref = $_[0];
    $hashref->{"test"} = "test";
    printHash( $hashref );
} 
```

* * *

试试这个练习来了解使用散列和引用散列之间的区别。

```
%a = (foo => "bar");       # hash
$b = { foo => "bar" };     # reference to hash

%c = %a;                   # new copy of a hash
$c{"foo"} = "baz";         # changes the copy of %a, but not %a
print $a{"foo"};           # still outputs "bar"

$d = $b;                   # $d is reference to same hash that $b points to
$d->{"foo"} = "baz";       # changes $b
print $b->{"foo"};         # now outputs "baz"

$e = \%a;                  # $e is a reference to hash %a
$e->{"foo"} = "baz";       # changes %a
print $a{"foo"};           # now outputs "baz" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T20:12:16.487

您的 subrutine 中有 local `%hash`，因此您不会更改 main-scope 中的那个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-05T21:36:17.473

您可能希望直接使用哈希*别名*（在您的情况下为`$_[0]`）。

# ruby-on-rails - 非常简单的搜索 + date_select

> ID：12288990
> 
> 赞同：1
> 
> 时间：2012-09-05T20:09:09.580
> 
> 标签：ruby-on-rails, search, date-range

我想用 date_select 字段创建简单的搜索

例如我有帖子（标题、文本和 create_at（默认））

在 create_at 字段中，我有类似的内容：25/12/2012（输出中）

我想在标题和文本中搜索 fild（我这样做），并为 date_range （开始和结束 date_fild）

如果我在这个字段中放一些东西，我会进行这样的搜索：

```
named_scope :between, lambda { |starts, ends| { :conditions => ['created_at > ? AND created_at <= ?', starts, ends] } } 
```

在简单的搜索中，我有这个：

```
 <%= form_tag posts_path, :method => 'get', :id => "posts_search" do %>
    <p>
      <%= text_field_tag :search, params[:search] %>
      <%= submit_tag "Search", :name => nil %>
    </p>

    <div id="someid"><%= render 'table' %></div>
  <% end %> 
```

和这个：

```
def index
  @posts = Post.search(params[:search]).paginate(:per_page => 3, :page => params[:page])
end 
```

# pagination - Cakephp 和分页多个结果集

> ID：12288991
> 
> 赞同：2
> 
> 时间：2012-09-05T20:09:33.973
> 
> 标签：pagination, cakephp-2.0

当 $this->paginate 在操作中被调用一次时，我的分页工作正常，但它似乎不是对多次调用的很好支持。这就是我想要做的......

```
function admin_index() {

    $published = $this->pagination('Post', array('status'=>1));
    $unpublished = $this->pagination('Post', array('status'=>0));

    $this->set('published', $published);
    $this->set('unpublished', $unpublished);
} 
```

我的观点的简化版本是：

```
<h1>Unpublished Posts</h1>
<?php echo $this->element('table', array('posts'=>$unpublished)); ?>
<h1>Published Posts</h1>
<?php echo $this->element('table', array('posts'=>$published)); ?> 
```

很简单，我可以重复使用相同的元素来显示不同类型的数据。除了jquery table sorter / hacks to Cakephp之外，真的没有办法单独对这些表进行分页吗？

我知道我可以将所有数据放在一个表中，然后只使用排序来区分状态，但我想先检查我是否遗漏了一些东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T14:31:37.597

由于这方面没有太多活动，我继续做合理的事情并想出了一个解决方法。以下是我想出的：

控制器：

```
function index() {
    $active = $this->paginate('Post', array('Post.status'=>1));     
    $activePaging = $this->request->params['paging']['Post'];

    $inactive = $this->paginate('Post', array('Post.status'=>0));
    $inActivePaging = $this->request->params['paging']['Post'];

    $this->set('active', $active);
    $this->set('inactive', $inactive);

    $this->request->params['paging']['Active'] = $activePaging;
    $this->request->params['paging']['InActive'] = $inActivePaging;
    unset($this->request->params['paging']['Post']);
}

public function paginate() {
    if ($this->request->is('ajax')) {
        $model = $this->request->params['named']['model'];
        $status = $model === 'Active' ? 1 : 0;

        $posts = $this->paginate('Post', array('Post.status'=>$status));
        $paging = $this->request->params['paging']['Post'];
        unset($this->request->params['paging']['Post']);
        $this->request->params['paging'][$model] = $paging;

        $this->set('posts', $posts);
        $this->set('model', $model);
        $this->render('/Posts/ajax_posts_paginated', 'ajax');
    }
} 
```

意见：（简化）

索引.ctp

```
<h3>Inactive Posts</h3>
<div class="well" id="InActive">
<?php echo $this->element('posts_table_paginated', array('posts'=>$inactive, 'model'=>'InActive')); ?>
</div>

<h3>Active Posts</h3>
<div class="well" id="Active">
<?php echo $this->element('posts_table_paginated', array('posts'=>$active, 'model'=>'Active')); ?>
</div> 
```

元素/posts_table_paginated.ctp

```
<?php
$this->Paginator->options(array(
    'update' => '#'.$model,
    'evalScripts' => true,
    'url'=> array('controller'=>'posts', 'action'=>'paginate', 'model'=>$model)
));
?>
<table>
    <tr>
        <th><?php echo $this->Paginator->sort('id', 'ID', array('model'=>$model)); ?></th>
        <th><?php echo $this->Paginator->sort('title', 'Title', array('model'=>$model)); ?></th>
        <th><?php echo $this->Paginator->sort('created', 'Created', array('model'=>$model)); ?></th>
        <th>Created by</th>
    </tr>
    <?php 
    foreach ($posts as $post): 
    ?>
    <tr>
        <td><?php echo $post['Post']['id']; ?></td>
        <td><?php echo $post['Post']['title']; ?></td>
        <td><?php echo $post['Post']['created']; ?></td>
        <td><?php echo $post['User']['username']; ?></td>
    </tr>
    <?php 
    endforeach; 
    ?>
</table>
<?php
    if ($this->params['paging'][$model]['count'] > 0) {
?>
<div id="pagination">
    <ul id="paginate">
        <?php
            echo $this->Paginator->prev(__('previous'), array('tag' => 'li', 'model'=>$model), null, array('tag'=>'li', 'class'=>'prev off'));
            echo $this->Paginator->numbers(array('tag'=>'li', 'model'=>$model, 'separator' => false));
            echo $this->Paginator->next(__('next'), array('tag' => 'li', 'model'=>$model), null, array('tag'=>'li', 'class'=>'next off'));
        ?>
    </ul>
</div>

<?php 
    }
    echo $this->Js->writeBuffer(); 
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-18T23:36:43.267

我有同样的问题并解决了**cakephp 版本 2.5.3**中的以下类的问题 我没有检查我的方法是否也适用于旧版本。首先，我创建了一个 Helper 和 Component 类，它扩展了 PaginationComponent 和 PaginationHelper 并覆盖了一些方法。

**/app/Controller/Component/_PaginatorComponent.php**

```
<?php
/**
 * Filename:    _PaginatorComponent.php
 * User:        
 * Date:        18.01.14
 */
App::import('Component', 'Paginator');
class _PaginatorComponent extends PaginatorComponent{
    public function paginate($object = null, $scope = array(), $whitelist = array())
    {
        //Adopt from the beginning of parent::paginate
        if (is_array($object))
            $object = null;
        $object = $this->_getObject($object);

        $options = $this->mergeOptions($object->alias); //get options
        $params = $this->Controller->request->params; //get params

        //if custom page name is set
        if(isset($params['named'][$options['pageRequestName']]))
        {
            //get the page number and set it as 'page' in the request (for other methods in the Component)
            $page = $params['named'][$options['pageRequestName']];
            $this->Controller->request->params['named']['page'] =intval($page);
        }
        else
            $this->Controller->request->params['named']['page'] = 1; //else set the page number to 1

        $pageRequestName = null; //important for parent::paginate

        $results = parent::paginate($object, $scope, $whitelist); // TODO: Change the autogenerated stub
        unset($this->Controller->request->params['named']['page']); //remove the appended page number

        //get the options again
        $options = $this->mergeOptions($object->alias);
        //and add the pageRequestName to the paging array
        if(isset($options['pageRequestName']))
        $this->Controller->request['paging'] = array_merge_recursive(
            (array)$this->Controller->request['paging'],
            array($object->alias => array('pageRequestName'=>$options['pageRequestName']))
        );
        return $results;
    }

} 
```

**/app/View/Helper/_PaginatorHelper.php**

```
<?php
/**
 * Filename:    _PaginatorHelper.php
 * User:        
 * Date:        18.01.14
 */
App::uses('PaginatorHelper', 'View/Helper');
class _PaginatorHelper extends PaginatorHelper{
    public function link($title, $url = array(), $options = array()) {
        //change the page parameter 'page' to the custom pageRequestName
        if(isset($url['page']))
        {
            $params = $this->params($this->model);
            if(isset($params['pageRequestName']))
            {
                $url[$params['pageRequestName']] = $url['page'];
                unset($url['page']);
            }
        }
        return parent::link($title,$url,$options);
    }

    protected function _pagingLink($which, $title = null, $options = array(), $disabledTitle = null, $disabledOptions = array())
    {
        //Prevent the deletion of the variable model
        $disabledOptions['model'] = $options['model'];
        return parent::_pagingLink($which, $title, $options, $disabledTitle, $disabledOptions); // TODO: Change the autogenerated stub
    }

    private $model = null;
    public function numbers($options = array())
    {
        //Only to set the model again
        if(isset($options['model']))
            $this->model = $options['model'];
        return parent::numbers($options); // TODO: Change the autogenerated stub
    }

} 
```

和一个快速使用分页的视图元素：

**/app/View/Element/paging.ctp**

```
<div class="paging">
    <?php
    $options = !isset($modelName)?array():array('model'=>$modelName);
    echo $this->Paginator->prev('< ' . __('zurück'), $options, null, array('class' => 'prev disabled'));
    echo $this->Paginator->numbers(array('separator' => '')+$options);
    echo $this->Paginator->next(__('vor') . ' >', $options, null, array('class' => 'next disabled'));
    ?>
</div> 
```

您可以像这样在视图中调用分页元素：（[文档](http://book.cakephp.org/2.0/en/views.html)）

```
<?php
echo $this->element('paging',array('modelName'=>'Customer'));
?> 
```

如果你想使用新创建的分页器，你必须说 cakephp 来使用你的类而不是普通的分页器。在您的控制器中，您像这样设置 PaginatorHelper 和 PaginatorComponent：（在[此处](https://stackoverflow.com/a/16804811/2486198)找到）

```
public $helpers = array('Paginator' => array('className' => '_Paginator' ));
public $components = array('Paginator' => array('className' => '_Paginator' )); 
```

控制器内部的用法。$paginate 必须被分组到模型组中：（[文档](http://book.cakephp.org/2.0/en/core-libraries/components/pagination.html)）

```
public $paginate = array(
        'Customer' => array (
            'limit' => 25,
            'pageRequestName' => 'cpage'
        ),
        'Employer' => array (
            'limit' => 25,
            'pageRequestName' => 'erpage'
        ),
        'Employee' => array (
            'limit' => 25,
            'pageRequestName' => 'eepage'
        )
    ); 
```

但我在以下情况下使用它：

```
$this->Paginator->settings['Customer'] = array(
            'conditions'=>array(
                'OR'=>array(
                    array('name LIKE'=>'%'.$search_query.'%'),
                )
            ),
            'limit' => 5,
            'pageRequestName' => 'cpage'
        );
        $result = $this->Paginator->paginate('Customer'); 
```

我希望我可以帮助一些不想要 javascript hack 的人，但确实有可能在一侧有多个分页。

目前你只能使用**'paramType' => 'named'**

在我看来，PaginationComponent 和 PaginationHelper 中的原始代码很难阅读、扩展和适应。

# javascript - 已定义变量上的未定义错误

> ID：12288995
> 
> 赞同：-1
> 
> 时间：2012-09-05T20:09:53.680
> 
> 标签：javascript, jquery

这是一个简单的检查和ajax发送功能

`fcell`是单元格编号，`v_cell`是前 3 位数字，应该在 091-3 范围内。

所以我得到了他们两个，当我提醒他们一切都很好（虽然我得到了 3 个警报）但是当它发送 ajax 请求时我得到了这个错误

```
TypeError: fcell is undefined
[Break On This Error]   
var v_cell = fcell.slice(0,3); 
```

这是代码

```
var finprog = false;    
    $('.send_to_friend').click(function(){

    var tr     = $(this).parent().parent();
    var p      = $(this).parent();
    var fcell  = tr.find('.fcell').val();
    var fname  = tr.find('.fname').val();
    var funame = tr.find('.funame').val();
    var v_cell = fcell.slice(0,3);
    alert(fcell);
    alert(v_cell);

    if(isNaN(fcell))
    { 
        alert('error');
        return false;
    }

    if(fcell.length != 11 )
    { 
        alert('error');
        return false;
    }

    if(v_cell != 091 && v_cell != 092 && v_cell != 093 )
    { 
        alert('error');
        return false;
    }

    if(fname.length == 0 )
    {
        alert('error');
        return false;
    }

    if(funame.length == 0 )
    {
        alert('error');
        return false;
    }

    if(finprog) return false;
    finprog = true ;

    var id  = tr.attr('class');
    p.html('<img src="images/load_square.gif" width="27" height="27" />');

    $.post('aj.php' , { name:fname , uname:funame , cell:fcell , sms_id:id , doo : 'sent_to_friend' }
     , function(data) { 
     finprog = false;

        if($.trim(data) == 'ok')
        {
            p.html('ok');
        }
        else
        {
            p.html('error');
        }
    })

}) 
```

这没有任何意义

这是我的 ajax 参数。它在这里定义！`cell 09163105802`

```
Parametersapplication/x-www-form-urlencoded
cell    09125105802
doo sent_to_friend
name    x
sms_id  9
uname   x 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T20:12:33.737

您很可能收到此错误，因为您的 tr 对象为空。因此，当您尝试查找具有 fcell 类的元素时，它也会返回 null。

```
var tr = $(this).parent().parent();
// tr is most likely null here
var fcell  = tr.find('.fcell').val();
// therefore fcell cannot be found and is undefined 
```

如果是这种情况，我建议您使用以下方法来查找您的 tr.

```
var tr = $(this).closest('tr'); 
```

# javascript - 在 Knockout 中绑定数据后获取数据

> ID：12288998
> 
> 赞同：1
> 
> 时间：2012-09-05T20:10:08.860
> 
> 标签：javascript, jquery, mvvm, knockout.js

我有单个网格页面并尝试使用 Knockout 绑定数据，但我想这是一个逻辑问题（因为我）。数据绑定在从 json 获取数据之前开始。

这里是javascript；

```
$(function () {

my.PriceListViewModel = (function () {
    var 
        data = ko.observableArray([]),
        totalCount = ko.observable(),
        currentPage = ko.observable(1),
        page = ko.observable(my.PageModel),
        goTo = function (d) {
            $.getJSON("/prices/GetByFilterViaJSON?limit=3&page=" + d, function (data) {
                Data(data.Data);
                CurrentPage(d);
            });
        },
        loadData = function () {
            $.getJSON("/prices/GetByFilterViaJSON?limit=3", function (list) {
                $.each(list, function (key, val) {
                    data.push(val);
                });

                my.PageModel.LoadData(data);
                Page = my.PageModel;
            });
        };
    return {
        Data: data,
        TotalCount: totalCount,
        CurrentPage: currentPage,
        Page: page,
        GoTo: goTo,
        LoadData: loadData
    };
})();

my.PageModel = (function () {
    loadData = function (data) {
        ko.mapping.fromJS(data.Page, {}, this);
    };

    return {
        LoadData: loadData
    };

})();

my.PriceListViewModel.LoadData();
debugger;
ko.applyBindings(my.PriceListViewModel);
}); 
```

和html；

```
<div class="section table_section">
<div class="section_inner" id="divTestKoRemoteGrid" >
    <div class="title_wrapper">
        <h2 data-bind="text: TotalCount">
            Prices</h2>
    </div>
    <div class="section_content">
        <div id="product_list">
            <!--[if !IE]>start table_wrapper<![endif]-->
            <div class="table_wrapper">
                <div class="table_wrapper_inner">
                    <table cellpadding="0" cellspacing="0" width="100%">
                        <tbody>
                            <tr>
                                <th>
                                    No.
                                </th>
                                <th>
                                    Tier
                                </th>
                                <th>
                                </th>
                            </tr>
                            <!-- ko foreach: Data -->
                            <tr data-bind="css: { second: $index() % 2 }">
                                <td data-bind="text: Id" style="width: 26px;">
                                </td>
                                <td data-bind="text: Tier" style="width: 35px;">
                                </td>
                                <td style="width: 120px;">
                                    <div class="actions_menu">
                                        <ul>
                                            <li><a class="edit" href="">edit</a></li>
                                            <li><a class="delete" href="">deny</a></li>
                                        </ul>
                                    </div>
                                </td>
                            </tr>
                            <!-- /ko -->
                        </tbody>
                    </table>
                </div>
            </div>
            <!--[if !IE]>end table_wrapper<![endif]-->
        </div>
        <!--[if !IE]>start pagination<![endif]-->
        <div class="pagination">
            <span class="page_no" data-bind="text: CurrentPage()"></span>
            <ul class="pag_list" data-bind="foreach: ko.utils.range(1, Page.TotalPage)">                   
                <li><a href=""  data-bind="click: $root.GoTo, css:{current_page: $data==$root.CurrentPage()}"><span><span data-bind="text: $data"></span></span></a>
                </li>
            </ul>
        </div>
        <!--[if !IE]>end pagination<![endif]-->
    </div>
</div> 
```

如何在绑定开始之前获取数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T06:17:58.337

您可以致电 ko.applyBindings(my.PriceListViewModel); 仅在检索到初始数据后。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T06:57:30.210

在文档就绪函数中调用应用绑定。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-07T13:23:28.033

我找到了解决方案。

我使用了异步的 $.getJson 方法，因此数据是在加载视图模型后到来的。

我用 $.ajax.async = false 更改了 $.getJson 方法，然后一切正常。

```
my.PriceListViewModel = (function () {
    var 
        data = ko.observableArray([]),
        totalCount = ko.observable(),
        page = ko.observable(),
        goTo = function (d) {
            $.getJSON("/prices/GetByFilterViaJSON?limit=6&page=" + d, function (list) {
                data(list.Data);
                page(list.Page);
            });
        },
        loadData = function () {
            $.ajax({
                type: 'GET',
                url: '/prices/GetByFilterViaJSON',
                dataType: 'json',
                success: function (list) {
                    data(list.Data);
                    page(list.Page);
                    totalCount(list.TotalCount);
                },
                data: { limit: 6 },
                async: false
            });
        };
    return {
        Data: data,
        TotalCount: totalCount,
        Page: page,
        GoTo: goTo,
        LoadData: loadData
    };
})(); 
my.PriceListViewModel.LoadData();
ko.applyBindings(my.PriceListViewModel); 
```