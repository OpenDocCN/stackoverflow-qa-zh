# StackOverflow 问答 000092000-000092999

# c - 指针和引用之间的真正区别是什么？

> ID：92001
> 
> 赞同：29
> 
> 时间：2008-09-18T12:19:54.187
> 
> 标签：c, pointers, reference

AKA - 对指针的痴迷是什么？

我只真正使用过现代的、面向对象的语言，如 ActionScript、Java 和 C#，我并不真正了解指针的重要性以及您使用它们的目的。我在这里错过了什么？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2008-09-18T12:26:09.773

这一切都只是间接：不处理数据，而是说“我会引导你到那里的一些数据”的能力。您在 Java 和 C# 中具有相同的概念，但仅在参考格式中。

主要区别在于引用实际上是不可变的路标——它们总是指向某些东西。这很有用且易于理解，但不如 C 指针模型灵活。C 指针是您可以愉快地重写的路标。你知道你要找的绳子就在被指向的绳子的隔壁吗？好吧，只是稍微改变一下路标。

这与 C 的“接近骨子里，需要低水平的知识”方法很好地结合在一起。我们*知道*a`char* foo`由一组字符组成，这些字符从 foo 路标指向的位置开始。如果我们还知道该字符串至少有 10 个字符长，我们可以将路标更改`(foo + 5)`为指向相同的字符串，但从长度的一半开始。

当您知道自己在做什么时，这种灵活性很有用，如果您不知道则死亡（“知道”不仅仅是“知道语言”，它是“知道程序的确切状态”）。弄错了，你的路标会指引你离开悬崖的边缘。引用不会让您摆弄，因此您更有信心可以毫无风险地遵循它们（尤其是在与“引用的对象永远不会消失”之类的规则相结合时，就像在大多数垃圾收集语言中一样）。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-09-18T12:31:40.790

你错过了很多！了解计算机如何在较低级别上工作在多种情况下非常有用。C 和汇编程序会为你做到这一点。

基本上，指针可让您将内容写入计算机内存中的任何点。在更原始的硬件/操作系统或嵌入式系统中，这实际上可能会做一些有用的事情。说再次打开和关闭blinkenlichts。

当然，这不适用于现代系统。操作系统是主存的主宰。如果您尝试访问错误的内存位置，您的进程将以其生命为傲慢付出代价。

在 C 中，指针是传递对数据的引用的方式。调用函数时，您不想将一百万位复制到堆栈中。相反，您只需告诉数据在主存储器中的位置。换句话说，你给了一个*指向*数据的指针。

在某种程度上，即使使用 Java 也会发生这种情况。您传递对对象的引用，而不是对象本身。请记住，最终每个对象都是计算机主存储器中的一组位。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-09-18T12:21:22.860

指针用于直接操作内存的内容。

这取决于您是否认为这是一件好事，但它是如何在 C 或汇编程序中完成任何事情的基础。

高级语言在幕后隐藏了指针：例如，Java 中的引用在您遇到的几乎所有 JVM 中都被实现为指针，这就是为什么它被称为 NullPointerException 而不是 NullReferenceException。但是它并没有让程序员直接访问它指向的内存地址，也不能修改它来取一个正确类型的对象地址以外的值。因此，它没有提供与低级语言中的指针相同的功能（和责任）。

[编辑：这是对“对指针的痴迷是什么？”这个问题的答案。我所比较的只是带有 Java 引用的汇编器/C 风格的指针。此后问题标题已更改：如果我开始回答新问题，我可能会提到 Java 以外的其他语言的引用]

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-09-18T12:31:08.590

这就像在问，“对 CPU 指令的痴迷是什么？如果没有将 x86 MOV 指令撒在各处，我是否会错过一些东西？”</p>

在低级别编程时，您只*需要指针。*在大多数高级编程语言实现中，指针的使用与在 C 中一样广泛，但编译器对用户隐藏。

所以……别担心。您已经在使用指针了——而且也没有错误地使用指针的危险。:)

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-09-18T12:43:37.843

我将指针视为汽车中的手动变速器。如果您学会驾驶配备自动变速器的汽车，那不会成为一个糟糕的司机。而且您仍然可以完成驾驶员在手动变速箱上学到的大部分内容。你的驾驶知识只会有一个漏洞。如果您必须手动驾驶，您可能会遇到麻烦。当然，它的基本概念很容易理解，但是一旦你必须从坡道开始，你就完蛋了。但是，手动变速器仍有一席之地。例如，赛车手需要能够换档以使汽车以最佳方式响应当前的赛车条件。拥有手动变速箱对他们的成功非常重要。

这与现在的编程非常相似。需要在某些软件上进行 C/C++ 开发。一些例子是高端 3D 游戏、低级嵌入式软件、速度是软件目的的关键部分的东西，以及允许您更接近地访问需要处理的实际数据的低级语言是该性能的关键. 然而，对于大多数程序员来说，情况并非如此，不知道指针也不是很糟糕。但是，我相信每个人都可以从学习 C 和指针以及手动变速器中受益。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-09-18T12:36:13.213

由于您一直在使用面向对象的语言进行编程，所以让我这样说吧。

你得到对象 A 实例化对象 B，并将它作为方法参数传递给对象 C。对象 C 修改了对象 B 中的一些值。当你回到对象 A 的代码时，你可以看到对象 B 中更改的值。为什么会这样？

因为您将对象 B 的*引用*传递给对象 C，而不是创建对象 B 的另一个副本。所以对象 A 和对象 C 都在内存中保存对同一个对象 B 的引用。从一个地方改变，在另一个地方被看到。这称为按引用。

现在，如果您使用原始类型（如 int 或 float）并将它们作为方法参数传递，则 Object A 无法看到 Object C 中的更改，因为 Object A 仅传递了一个*副本*而不是它自己的变量副本的引用. 这称为按值。

你可能已经知道了。

回到 C 语言，函数 A 将一些变量传递给函数 B。这些函数参数是本机副本，按值。为了让函数 B 操作属于函数 A 的副本，函数 A 必须传递一个*指向*变量的指针，这样它就变成了按引用传递。

“嘿，这是我的整数变量的内存地址。把新值放在那个地址位置，我稍后再取。”

请注意，这个概念是相似的，但不是 100% 相似。指针可以做的不仅仅是“通过引用”传递。指针允许函数将内存的任意位置操作为所需的任何值。指针还用于指向*执行代码*的新地址，以动态执行任意逻辑，而不仅仅是数据变量。指针甚至可以指向*其他指针*（双指针）。这很强大，但也很容易引入难以检测的错误和安全漏洞。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-18T13:04:22.520

我在日常工作中大量使用指针和引用……在托管代码（C#、Java）和非托管代码（C++、C）中。我了解了如何处理指针以及大师自己的指针是什么...[Binky！][1] 无需多说；）

指针和引用之间的区别是这样的。指针是指向某个内存块的地址。它可以被重写，或者换句话说，重新分配给其他一些内存块。引用只是对某个对象的重命名。只能分配一次！一旦分配给一个对象，就不能再分配给另一个对象。引用不是地址，它是变量的另一个名称。查看[C++ FAQ](http://cslibrary.stanford.edu/104/)了解更多信息。

[链接1](http://cslibrary.stanford.edu/104/)

[链接2](https://isocpp.org/wiki/faq/references#assigning-refs)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-18T13:42:39.777

如果您以前没有看过指针，那么您肯定会错过这个迷你宝石：

```
void strcpy(char *dest, char *src)
{    
        while(*dest++ = *src++);
} 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-09-18T14:49:10.680

从历史上看，使编程成为可能的是认识到内存位置可以保存计算机指令，而不仅仅是数据。

指针源于内存位置也可以保存其他内存位置的地址的认识，从而为我们提供了间接性。如果没有指针（在低级别），大多数复杂的数据结构都是不可能的。没有链表、二叉树或哈希表。没有按引用传递，只有按值传递。由于指针可以指向代码，没有它们我们也没有虚函数或函数查找表。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-18T12:46:20.427

我目前正在设计一些高级企业软件，其中数据块（在本例中存储在 SQL 数据库中）被 1 个或多个其他实体引用。如果在没有更多实体引用时保留了一大块数据，我们就是在浪费存储空间。如果参考点如此不存在的数据，那也是一个大问题。

在我们的问题和使用指针的语言中的内存管理问题之间有一个很强的类比。能够以这种类比与我的同事交谈非常有用。不删除未引用的数据是“内存泄漏”。无处可去的引用是“悬空指针”。我们可以选择显式的“释放”，或者我们可以使用“引用计数”来实现“垃圾收集”。

所以在这里，了解低级内存管理有助于设计高级应用程序。

在 Java 中，您一直在使用指针。大多数变量都是指向对象的指针——这就是为什么：

```
StringBuffer x = new StringBuffer("Hello");
StringBuffer y = x;
x.append(" boys");
System.out.println(y); 
```

...打印“你好男孩”而不是“你好”。

C 语言中唯一的区别在于，指针的加减法很常见——如果你弄错了逻辑，你最终可能会弄乱你不应该接触的数据。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-18T13:09:08.190

字符串是 C（和其他相关语言）的基础。使用 C 编程时，**您**必须管理内存。你不只是说“好吧，我需要一堆字符串”；您需要考虑数据结构。你需要多少内存？你什么时候分配？你什么时候释放它？假设您需要 10 个字符串，每个字符串不超过 80 个字符。

好的，每个字符串都是一个字符数组（81 个字符 - 你不能忘记 null 否则你会很抱歉！）然后每个字符串本身就是一个数组。最终结果将是一个多维数组，例如

```
char dict[10][81]; 
```

请注意，顺便说一句，该 dict 不是“字符串”或“数组”或“字符”。这是一个指针。当您尝试打印其中一个字符串时，您所做的只是传递单个字符的地址；C 假设如果它只是开始打印字符，它最终会命中一个空值。它假设如果您在一个字符串的开头，并且向前跳 81 个字节，您将在下一个字符串的开头。而且，事实上，获取您的指针并向其添加 81 个字节是跳转到下一个字符串的*唯一可能方法。*

那么，为什么指针很重要？因为没有他们你什么都做不了。你甚至不能做一些简单的事情，比如打印出一堆字符串；你**当然**不能做任何有趣的事情，比如实现链表、散列、队列、树、文件系统、一些内存管理代码、内核等等。你需要理解它们，因为 C 只是给你一块内存，让你做剩下的事情，而用一块原始内存做任何事情都需要指针。

还有很多人认为，理解指针的能力与编程技能高度相关。乔尔提出了这个论点，等等。例如

> 现在，我坦率地承认，在今天编写的 90% 的代码中都不需要使用指针进行编程，事实上，在生产代码中它是非常危险的。好的。没关系。而函数式编程在实践中并没有太多使用。同意。
> 
> 但它对于一些最令人兴奋的编程工作仍然很重要。例如，如果没有指针，您将永远无法在 Linux 内核上工作。如果不真正理解指针，你就无法理解 Linux 中的一行代码，或者实际上，任何操作系统。

从[这里](http://www.joelonsoftware.com/articles/ThePerilsofJavaSchools.html)。优秀的文章。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-18T15:02:48.353

老实说，如果您不知道指针，大多数经验丰富的开发人员都会笑（希望是友好的）。在我以前的工作中，我们去年有两个新员工（刚毕业）不知道指针，仅这一点就成为与他们交谈大约一周的话题。没有人会相信一个人在不知道指针的情况下如何毕业......

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2015-05-28T17:19:53.080

C++ 中的引用与 Java 或 .NET 语言中的引用根本不同。.NET 语言具有称为“byrefs”的特殊类型，其行为与 C++“引用”非常相似。

C++ 引用或 .NET byref（我将使用后一个术语，以与 .NET 引用区分开来）是一种特殊类型，它不包含变量，而是包含足以识别变量（或可以运行的东西）的信息作为一个，例如阵列插槽）在别处举行。Byrefs 通常仅用作函数参数/参数，并且旨在是短暂的。将 byref 传递给函数的代码保证由此标识的变量将至少在该函数返回之前存在，并且函数通常保证在返回后不保留任何 byref 副本（请注意，在 C++ 中，后一个限制不是强制执行）。因此，byrefs 不能超过由此确定的变量。

在 Java 和 .NET 语言中，引用是一种标识堆对象的类型；每个堆对象都有一个关联的类，堆对象类中的代码可以访问存储在对象中的数据。堆对象可以授予外部代码对存储在其中的数据的有限或完全访问权限，和/或允许外部代码调用其类中的某些方法。使用引用来调用其类的方法将导致该引用对该方法可用，然后该方法可以使用它来访问堆对象中的数据（甚至是私有数据）。

Java 和 .NET 语言中引用的特殊之处在于，作为绝对不变量，只要该引用存在，每个非空引用都将继续标识同一个堆对象。一旦在宇宙中的任何地方都不存在对堆对象的引用，堆对象将简单地停止存在，但是当对堆对象的任何引用存在时，堆对象无法停止存在，也没有任何方法可以实现“正常” " 对堆对象的引用自发地变成对该对象的引用以外的任何东西。Java 和 .NET 都具有特殊的“弱引用”类型，但即使它们也支持不变量。如果 Universe 中任何地方都不存在对对象的非弱引用，则任何现有的弱引用都将失效；一旦发生，就不会有'

指针，像 C++ 引用和 Java/.NET 引用一样，标识对象，但与上述引用类型不同，它们可以比它们标识的对象寿命更长。如果指针标识的对象不再存在但指针本身不存在，则任何使用指针的尝试都将导致未定义行为。如果一个指针既不知道是也不知道`null`当前存在的对象，那么就没有标准定义的方法来做*任何事情*用那个指针，而不是用别的东西覆盖它。在由此识别的对象停止存在之后，指针继续存在是完全合法的，前提是没有任何东西使用过指针，但是指针之外的东西必须表明它是否可以安全使用，因为没有办法问指针本身。

指针和引用（任一类型）之间的主要区别在于，始终可以询问引用是否有效（它们将有效或可识别为 null），并且如果观察到有效，它们将一直存在，只要它们存在。不能询问指针是否有效，并且系统不会做任何事情来确保指针不会变为无效，也不会允许无效的指针被识别为这样。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-18T13:24:30.693

很长一段时间我都不懂指针，但我懂数组寻址。所以我通常会在一个数组中为对象放置一些存储区域，然后使用该数组的索引作为“指针”概念。

```
SomeObject store[100];
int a_ptr = 20;
SomeObject A = store[a_ptr]; 
```

这种方法的一个问题是，在我修改“A”之后，我必须将它重新分配给“存储”数组才能使更改永久生效：

```
store[a_ptr] = A; 
```

在幕后，编程语言进行了多次复制操作。大多数情况下，这不会影响性能。它主要使代码容易出错和重复。

在我学会了理解指针之后，我不再使用数组寻址方法。这个比喻还是很有道理的。只需考虑“存储”数组是由编程语言的运行时管理的。

```
SomeObject A;
SomeObject* a_ptr = &A;
// Any changes to a_ptr's contents hereafter will affect
// the one-true-object that it addresses. No need to reassign. 
```

如今，我只在无法合法复制对象时使用指针。出现这种情况的原因有很多：

1.  为了性能而避免昂贵的对象复制操作。
2.  其他一些因素不允许对象复制操作。
3.  您希望函数调用对对象产生副作用（不要传递对象，将指针传递给它）。
4.  在某些语言中 - 如果您想从函数返回多个值（尽管通常避免）。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-18T12:21:59.737

指针是在低级编程语言中表示间接的最实用的方式。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-18T12:24:45.720

指针很重要！它们“指向”一个内存地址，很多内部结构都表示为指针，IE、字符串数组其实就是一个指向指针的列表！指针也可用于更新传递给函数的变量。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-18T12:25:41.380

如果您想在运行时生成“对象”而不在堆栈上预先分配内存，则需要它们

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-18T12:40:39.363

参数效率 - 传递一个指针（Int - 4 个字节），而不是复制整个（任意大）对象。

Java 类也通过引用（基本上是指针）传递，这只是在 Java 中对程序员隐藏的。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-18T13:06:46.853

使用 C 和 C++ 等语言进行编程，您更接近“金属”。指针保存变量、数据、函数等所在的内存位置。您可以传递指针而不是按值传递（复制变量和数据）。

指针有两点困难：

1.  关于指针、寻址等的指针可能会变得非常神秘。它会导致错误，并且难以阅读。
2.  指针指向的内存通常是从堆中分配的，这意味着您负责释放该内存。应用程序越大，就越难满足这一要求，最终会导致难以追踪的内存泄漏。

您可以将指针行为与 Java 对象的传递方式进行比较，但在 Java 中您不必担心释放内存，因为这是由垃圾收集处理的。通过这种方式，您可以获得关于指针的好处，但不必处理负面因素。当然，如果您不取消引用您的对象，您仍然可以在 Java 中获得内存泄漏，但那是另一回事。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-09-18T14:39:25.803

另外需要注意的是，您可以通过将代码块标记为不安全来使用 C# 中的指针（与普通引用相反）。然后，您可以直接更改内存地址并进行指针运算和所有有趣的事情。它非常适合非常快速的图像处理（我个人唯一使用过的地方）。

据我所知，Java 和 ActionScript 不支持不安全的代码和指针。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-05-15T11:20:38.693

我总是对高级语言中对指针或引用等事物的关注感到苦恼。在更高的抽象层次上考虑对象（甚至只是函数）的行为确实很有用，而不是考虑“让我看看，如果我将这个东西的地址发送到那里，那么那个东西会给我一个指向别的东西的指针”

甚至考虑一个简单的交换函数。如果你有

无效交换（int＆a，int＆b）

或者

程序交换（var a，b：整数）

然后将这些解释为可以更改值。事实上，这是通过传递变量的地址来实现的，这只是分散了目的。

与对象相同 --- 不要将对象标识符视为指针或对“东西”的引用。相反，只需将它们视为您可以向其发送消息的对象。即使在像 C++ 这样的原始语言中，通过尽可能高水平地思考（和写作），您也可以更快地走得更远。

* * *

## 回答 #22

> 赞同：-3
> 
> 时间：2008-09-18T12:21:39.690

写两行以上的 c 或 c++，你就会发现。

它们是指向变量内存位置的“指针”。这就像通过引用传递一个变量。

# asp.net - 以编程方式使绑定列不可见

> ID：92004
> 
> 赞同：0
> 
> 时间：2008-09-18T12:20:15.123
> 
> 标签：asp.net

我试图在数据绑定之后使数据绑定列不可见，因为它在数据绑定之前不存在。但是，DataGrid.Columns 集合指示计数为 0，这使得自动生成的列看起来不属于该集合。

如何使绑定期间自动生成的列不可见？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T12:22:29.940

您必须将代码添加到订单项呈现代码并将该列的可见性设置为 false。即使它已绑定，也会为每条记录触发该事件，并且您可以操作输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T12:23:04.103

因为它是动态创建的，所以我知道的唯一方法是隐藏单元格，这是一个您可以调整的示例：

```
protected void GridView_RowCreated(object sender, GridViewRowEventArgs e)
{
  e.Row.Cells[1].Visible = false;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T12:24:44.817

如果我正确理解您的场景，您可能希望在数据绑定事件期间设置它的可见属性

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T13:10:08.733

> 尼克·克拉弗
> 
> > GridView_RowCreated

尼克，我没有使用 GridView。这是 ItemCreated ;-)

# string - 如何确定随机字符串是否听起来像英语？

> ID：92006
> 
> 赞同：22
> 
> 时间：2008-09-18T12:20:20.787
> 
> 标签：string, linguistics, nlp

我有一个基于输入单词列表生成字符串的算法。如何仅分隔听起来像英语单词的字符串？IE。在保留**LORD**的同时丢弃**RDLO**。

 ****编辑：**为了澄清，它们不需要是字典中的实际单词。他们只需要听起来像英语。例如**KEAL**将被接受。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-09-18T12:23:40.590

您可以构建一个巨大的英文文本的马尔可夫链。

之后，您可以将单词输入马尔可夫链并检查单词是英语的概率有多高。

见这里：[http ://en.wikipedia.org/wiki/Markov_chain](http://en.wikipedia.org/wiki/Markov_chain)

在页面底部，您可以看到马尔科夫文本生成器。你想要的恰恰相反。

简而言之：马尔可夫链为每个字符存储下一个字符将跟随的概率。如果你有足够的内存，你可以把这个想法扩展到两个或三个字符。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-09-18T12:42:35.570

[贝叶斯过滤器的简单方法（来自http://sebsauvage.net/python/snyppets/#bayesian](http://sebsauvage.net/python/snyppets/#bayesian)的 Python 示例）

```
from reverend.thomas import Bayes
guesser = Bayes()
guesser.train('french','La souris est rentrée dans son trou.')
guesser.train('english','my tailor is rich.')
guesser.train('french','Je ne sais pas si je viendrai demain.')
guesser.train('english','I do not plan to update my website soon.')

>>> print guesser.guess('Jumping out of cliffs it not a good idea.')
[('english', 0.99990000000000001), ('french', 9.9999999999988987e-005)]

>>> print guesser.guess('Demain il fera très probablement chaud.')
[('french', 0.99990000000000001), ('english', 9.9999999999988987e-005)] 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-18T12:22:11.657

使用马尔可夫链很容易生成发音为英语的单词。然而，倒退是一个更大的挑战。结果的可接受误差范围是多少？你总是可以有一个常见字母对、三元组等的列表，并以此为基础对其进行评分。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-18T18:31:37.930

您可以通过将候选字符串标记为二元组（相邻字母对）并根据英语二元组频率表检查每个二元组来解决此[问题](http://en.wikipedia.org/wiki/Bigram)。

*   很简单：如果频率表上的任何二元组足够低（或完全不存在），则将该字符串视为不可信而拒绝。（字符串包含“QZ”二元组？拒绝！）
*   不太简单：计算整个字符串的整体合理性，例如，每个二元组的频率除以该长度的有效英语字符串的平均频率的乘积。这将允许您（a）在其他高频二元组中接受具有奇数低频二元组的字符串，以及（b）拒绝具有多个单独的低但不完全低于阈值二元组的字符串.

其中任何一个都需要对阈值进行一些调整，第二种技术比第一种更需要。

用三元组做同样的事情可能会更健壮，尽管它也可能会导致一组更严格的“有效”字符串。这是否成功取决于您的应用程序。

基于现有研究语料库的二元表和三元表可以免费或购买（我没有找到任何免费可用的，但到目前为止只是粗略的谷歌），但你可以从任何好的地方自己计算一个二元表或三元表 -大小的英文文本语料库。只需将每个单词作为标记并计算每个二元组——您可以将其作为散列处理，其中给定的二元组作为键，递增的整数计数器作为值。

英语形态学和英语语音学（众所周知！）不如等距，因此这种技术很可能会生成“看起来”是英语但呈现麻烦发音的字符串。这是三元组而不是二元组的另一个论据——如果 n-gram 跨越整个声音，那么通过分析使用多个字母顺序产生给定音素的声音所产生的怪异将会减少。（例如，想想“犁”或“海啸”。）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-18T12:30:29.107

我很想在英语单词词典上运行 soundex 算法并缓存结果，然后对您的候选字符串进行 soundex 并与缓存匹配。

根据性能要求，您可以为 soundex 代码制定距离算法并接受一定容差内的字符串。

Soundex 很容易实现 - 有关算法的描述，请参见[Wikipedia](http://en.wikipedia.org/wiki/Soundex "维基百科")。

您想要做的一个示例实现是：

```
def soundex(name, len=4):
    digits = '01230120022455012623010202'
    sndx = ''
    fc = ''

    for c in name.upper():
        if c.isalpha():
            if not fc: fc = c
            d = digits[ord(c)-ord('A')]
            if not sndx or (d != sndx[-1]):
                sndx += d

    sndx = fc + sndx[1:]
    sndx = sndx.replace('0','')
    return (sndx + (len * '0'))[:len]

real_words = load_english_dictionary()
soundex_cache = [ soundex(word) for word in real_words ]

if soundex(candidate) in soundex_cache:
    print "keep"
else:
    print "discard" 
```

显然，您需要提供 read_english_dictionary 的实现。

**编辑**：您的“KEAL”示例会很好，因为它具有与“KEEL”相同的 soundex 代码（K400）。如果您想了解失败率，您可能需要记录被拒绝的单词并手动验证它们。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-18T12:44:54.940

您应该研究“可发音的”密码生成器，因为它们正在尝试完成相同的任务。

Perl 解决方案是[Crypt::PassGen](http://search.cpan.org/~tjenness/Crypt-PassGen-0.05/PassGen.pm)，您可以使用字典对其进行训练（因此，如果需要，您可以将其训练成各种语言）。它遍历字典并收集关于 1、2 和 3 个字母序列的统计数据，然后根据相对频率构建新的“单词”。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-18T12:53:31.423

[Metaphone](http://en.wikipedia.org/wiki/Metaphone)和[Double Metaphone](http://en.wikipedia.org/wiki/Double_Metaphone)与 SOUNDEX 类似，只是它们可能比[SOUNDEX](http://en.wikipedia.org/wiki/Soundex)更接近您的目标。它们被设计为根据它们的语音“声音”“散列”单词，并且擅长为英语（但不是其他语言和专有名称）这样做。

这三种算法要记住的一点是，它们对单词的第一个字母非常敏感。例如，如果您想弄清楚**KEAL**是否听起来像英语，您将找不到与**REAL**的匹配项，因为首字母不同。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-18T12:25:11.867

它们必须是真正的英文单词，还是只是看起来像是英文单词的字符串？

如果它们只需要看起来像*可能的*英语单词，您可以对一些真实的英语文本进行一些统计分析，并找出哪些字母组合经常出现。完成此操作后，您可以丢弃不太可能的字符串，尽管其中一些可能是真实的单词。

或者您可以只使用字典并拒绝不在其中的单词（允许复数和其他变体）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T12:22:29.643

您可以将它们与字典（在 Internet 上免费提供）进行比较，但这在 CPU 使用率方面可能会很昂贵。除此之外，我不知道有任何其他编程方式可以做到这一点。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-18T12:26:52.300

这听起来像是一项相当复杂的任务！在我的脑海中，辅音音素在它之前或之后都需要一个元音。但是，确定音素是什么将非常困难！您可能需要手动写出它们的列表。例如，“TR”可以，但“TD”不行，等等。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-18T12:32:32.363

我可能会根据英语单词数据库使用 SOUNDEX 算法评估每个单词。如果您在 SQL 服务器上执行此操作，那么设置一个包含大多数英语单词列表的数据库（使用免费提供的字典）应该很容易，并且 MSSQL 服务器已将 SOUNDEX 实现为可用的搜索算法。

显然，如果你愿意，你可以用任何语言自己实现它——但这可能是一项艰巨的任务。

通过这种方式，您可以评估每个单词在多大程度上听起来像一个现有的英语单词（如果有的话），并且您可以为您希望接受的结果设置一些限制。您可能想考虑如何组合多个单词的结果，并且您可能会根据测试调整接受限制。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-08-05T17:29:55.297

我建议查看 phi 测试和巧合指数。 [http://www.threading.com/cryptography2.htm](http://www.threaded.com/cryptography2.htm)

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2008-09-18T12:35:47.393

我建议一些简单的规则和标准对和三胞胎会很好。

例如，除了一些双元音和标准辅音对（例如 th、ie 和 ei、oo、tr）外，英语发音词倾向于遵循元音-辅音-元音的模式。使用这样的系统，您应该删除几乎所有听起来不像是英语的单词。仔细检查后，您会发现您可能会删除很多听起来也像英语的单词，但是您可以开始添加允许更广泛单词的规则并手动“训练”您的算法。

您不会删除所有的假阴性（例如，我认为您无法想出一个规则来包含“节奏”而不明确编码该节奏是一个词），但它将提供一种过滤方法。

我还假设您想要可能是英语单词的字符串（发音时听起来很合理），而不是绝对是具有英语含义的单词的字符串。

# c# - 以编程方式在 C# DataGridView 中设置记录指针

> ID：92008
> 
> 赞同：2
> 
> 时间：2008-09-18T12:20:25.747
> 
> 标签：c#, .net, winforms, datagridview

如何以编程方式在 C# DataGridView 中设置记录指针？

我试过“DataGridView.Rows[DesiredRowIndex].Selected=true;”，但它不起作用。它所做的只是在网格中突出显示该行；它不会将记录指针移动到该行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T12:32:23.330

要更改数据网格的活动行，您需要将数据网格的当前单元格属性设置为所选行上的非隐藏、非禁用、非标题单元格。你会这样做：

```
dataGridView1.CurrentCell = this.dataGridView1[YourColumn,YourRow]; 
```

确保单元格符合上述条件。更多信息可以在以下位置找到：

[http://msdn.microsoft.com/en-us/library/yc4fsbf5.aspx](http://msdn.microsoft.com/en-us/library/yc4fsbf5.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-21T10:00:55.687

尝试设置第一个的焦点`DataGrid`。像这样的东西

```
dataGridView1.Focus();
dataGridView1.CurrentCell = this.dataGridView1[YourColumn,YourRow]; 
```

这在我的情况下有效，希望它对你也有帮助

# webforms - 如何仅显示一条验证错误消息 与 MyFaces 特立尼达？

> ID：92027
> 
> 赞同：0
> 
> 时间：2008-09-18T12:22:56.363
> 
> 标签：webforms, myfaces, trinidad

对于注册表单，我有一些简单的东西，例如：

```
 <tr:panelLabelAndMessage
            label="Zip/City"
            showRequired="true">
            <tr:inputText 
                id="zip"
                value="#{data['registration'].zipCode}" 
                contentStyle="width:36px"
                simple="true"
                required="true" />
            <tr:inputText 
                id="city"
                value="#{data['registration'].city}" 
                contentStyle="width:133px"
                simple="true"
                required="true" />
        </tr:panelLabelAndMessage>
        <tr:message for="zip" />
        <tr:message for="city" /> 
```

包括最后两行时，我收到两条关于验证错误的消息。省略最后一行时，会出现一个 javascript 警报，这不是我想要的。

是否有解决方案以某种方式仅显示一条验证失败消息？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-20T13:19:32.070

问题是，字段必须水平布局。将 ZIP 字段和城市不相邻放在一条线上是不行的。至少对我来说。

一位同事指示我在第一个 tr:message 中设置一个 faclets 变量，并在第二个对该变量作出反应的属性上放置一个渲染属性。还没有时间尝试也没有找到设置变量的正确命令。将尽快公布结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-20T10:16:31.947

I know this won't be ideal, but if you remove the `panelLabelAndMessage` tag and just use the label attribute on the `inputText` tag that should remove the extra error message.

# .net - 从代码生成.NET UML？

> ID：92029
> 
> 赞同：2
> 
> 时间：2008-09-18T12:23:15.210
> 
> 标签：.net, visual-studio, uml

.NET 有什么东西可以从代码生成 UML 图。最好是 Visual Studio 的插件。在一个没有多少架构文档的成熟项目上开始工作一开始可能会很痛苦。最终你会了解代码的来龙去脉，但是从一开始就帮助你了解代码是如何组合在一起的会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T12:27:19.443

在 Visual Studio 2005/8 中，您可以右键单击一个类，然后选择在类图中查看，这将创建一个包含所选类和任何相关类的新 ClassDiagram。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T12:29:11.200

如果您有 Visio 并选择 Project->Visio UML->Reverse Engineer，您将获得该项目的 uml。Sparx Systems 制作了一款名为“Enterprise Architect”的产品，它也应该能够做到这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T12:43:19.827

如果您为一个大项目生成 UML 类图，结果将会非常混乱。

有时我在 Visual Studio 中使用类图。我手动添加了我认为值得额外解释的类。这些图不是 UML，但它足够接近。它们始终是最新的，您可以更改图表并且代码会自动更新。

为了传达设计的更大图景，我使用[这些 UML 模板](http://softwarestencils.com/uml/index.html)并手工绘制图表。为了让与我交流的人明白我的观点，我发现最好省略不相关的细节，这样我们就可以专注于我认为重要的事情。没有自动 UML 生成工具可以确定要省略哪些不相关的细节。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-02-18T19:04:09.950

Visual Studio 2010 Ultimate 支持 UML 类、序列、组件、用例和活动图。它还支持从代码创建序列、依赖图和层图。关于从代码生成 UML 图的问题，VS 架构和建模工具论坛中有一个回复：[是否可以将 C# 代码逆向工程为 UML 类图？](http://social.msdn.microsoft.com/Forums/en-US/vsarch/thread/a1ee9393-8f9b-45f2-8277-6e49346a119a)

其他工具包括架构资源管理器，可让您浏览和探索您的解决方案。

有关详细信息，请参阅以下链接：

要下载 RC 版本，请访问：[Microsoft Visual Studio 2010 Ultimate RC](http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=457bab91-5eb2-4b36-b0f4-d6f34683c62a)

要查看 RC 文档，请参阅[建模应用程序](http://msdn.microsoft.com/en-us/library/57b85fsc%28VS.100%29.aspx)。

要讨论这些工具，请访问[Visual Studio 2010 Architectural Discovery & Modeling Tools](http://social.msdn.microsoft.com/Forums/en-US/vsarch/threads)论坛。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-02-18T22:54:28.983

[Enterprise Architect](http://www.sparxsystems.com/)做到了这一点，并为 Visual Studio 提供了一个插件。它还将制作非常有用的序列图。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T11:03:50.510

类图并不总是有效。我经常发现由于某种原因它不会显示课程。我必须依靠钢笔和铅笔或与从事该项目的人交谈。

# c# - 在 DataGridViewComboboxColumn 上设置选定项

> ID：92035
> 
> 赞同：5
> 
> 时间：2008-09-18T12:23:52.773
> 
> 标签：c#, .net, winforms, datagridview

我有一个带有 DataGridViewComboboxColumn 列的数据网格视图，该列具有 3 个值：

“小号中号大号”

我取回用户默认值，在这种情况下为“中”

我想在 datagridview 中显示一个下拉单元格，但默认值为“中”。我会通过选择索引或只是设置组合框的 Text 属性在常规组合框中执行此操作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-03T08:00:59.250

当您进入 datagridview 时，最好进入数据绑定。这将处理您正在谈论的所有选定的索引内容。

但是，如果你想自己进去，

```
DataGridView.Rows[rowindex].Cells[columnindex].Value 
```

将让您获取和设置与 DataGridViewComboBoxColumn 关联的值。只需确保提供正确的行索引和列索引，并将值设置为正确的类型（与 DataGridViewComboBoxColumn 的 ValueMember 属性类型相同）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-24T05:49:03.260

```
DataGridViewComboBoxColumn ColumnPage = new DataGridViewComboBoxColumn();
ColumnPage.DefaultCellStyle.NullValue = "Medium"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T12:42:23.150

您是在检索用户数据并尝试在 DataGridView 中手动设置值，还是实际上将 DataGridVew 绑定到数据源？因为如果您已将网格绑定到数据源，则只需将列上的 DataPropertyName 设置为对象属性的字符串名称：

```
[DataGridViewComboboxColumnName].DataPropertyName = "PropertyNameToBindTo"; 
```

或者你的意思是你希望它默认为中等新行？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-28T10:07:16.380

完成这个任务你应该做这样的事情： -

```
 this.dataGridViewStudentInformation.Columns[ColumnIndex].DataPropertyName = dataGridViewStudentInformation.Columns[2].Name ; //Set the ColumnName to which you want to bind. 
```

并将数据库中的默认值设置为中。

# c++ - Visual Studio 2005 中的“附加到进程”

> ID：92039
> 
> 赞同：1
> 
> 时间：2008-09-18T12:24:35.783
> 
> 标签：c++, visual-studio-2005, visual-c++-2005

我安装了 Visual Studio 2005（带有 SP1）并将默认设置设置为 C++ 所需的设置。

现在我打开一个解决方案并运行 exe。在“工具”菜单项下，我选择“附加进程”并将其附加到我刚刚运行的 exe 中。我在代码中的几个地方放置了断点（这个断点看起来是启用的），这些是断点绝对应该被命中的地方。但由于某种原因，我的断点没有命中。

PS：所有 pdb 都存在于正确的位置。

有没有我缺少的设置。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T12:29:02.030

也许它附加到“错误类型”的代码。

在“附加到进程”对话框中，有一个设置允许您选择要调试的代码类型。尝试单击“附加到”文本框旁边的“选择”按钮并仅选中~~“托管代码”~~相关代码类型。

[http://img204.imageshack.us/img204/3017/capture5ct4.png](http://img204.imageshack.us/img204/3017/capture5ct4.png)

大多数情况下，保留“自动确定要调试的代码类型”设置对我有用。但是，在某些情况下，调试器无法理解我想要附加到托管代码（例如，如果我从批处理文件启动了我的应用程序），当它这样做时，上述解决方案对我有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T12:26:08.730

你在调试模式吗？当我尝试在发布模式下执行此操作时，我遇到了这个问题。它没有抱怨，只是没有达到断点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T12:31:08.967

使用“**模块**”视图查看您的 exe/dll 是否已加载，如果没有，请指定从何处加载 PDB。

# mysql - 是否有一个简单的工具可以将 mysql 转换为 postgresql 语法？

> ID：92043
> 
> 赞同：20
> 
> 时间：2008-09-18T12:24:45.673
> 
> 标签：mysql, database, postgresql

[我已经尝试过这里](http://wiki.postgresql.org/wiki/Converting_from_other_Databases_to_PostgreSQL)列出的工具，其中一些比其他工具更成功，但没有一个给我可以使用的有效 postgres 语法（tinyint 错误等）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-20T01:54:31.543

有一个`mysqldump`选项可以输出 PostgreSQL 代码：

```
mysqldump --compatible=postgresql ...

```

但这不太好。

相反，请参阅[Linus Oleander 的回答中描述的](https://stackoverflow.com/a/15670452/19163)[mysql-to-postgres](https://github.com/maxlapshin/mysql2postgres)工具。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-11-06T08:03:35.837

试试这个，它就像魅力一样！

```
http://www.sqlines.com/online 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-27T22:07:28.330

在谷歌上一段时间后，我发现[了这篇文章](http://ruby.zigzo.com/2011/12/03/migrating-data-from-mysql-to-postgresql/)。

1.  使用. [_](https://github.com/maxlapshin/mysql2postgres) _`[sudo] gem install mysql2psql`
2.  通过运行创建配置文件`mysql2psql`。您会看到一个错误，但`mysql2psql.yml`应该已经创建了一个文件。
3.  编辑`mysql2psql.yml`
4.  再次运行`mysql2psql`以迁移您的数据。

提示：如果您希望在迁移数据之前清除 postgresql 数据库，请在配置文件中设置`force_truncate`为。`true``mysql2psql.yml`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-05-06T17:05:18.953

在 Debian（或 Ubuntu）上安装[pgloader ：](https://github.com/dimitri/pgloader)

```
sudo apt install pgloader 
```

以 postgres 用户登录并创建数据库

```
sudo su postgres
createdb -O user db_migrated 
```

将数据从mysql数据库传输到postgresql

```
pgloader mysql://user@localhost/db postgresql:///db_migrated 
```

还检查[Dimitri Fontaine 将 pgloader 从 python 重写为 common lisp](https://tapoueh.org/blog/2014/05/why-is-pgloader-so-much-faster/)，以便他可以实现真正的线程。

# 其他平台安装

*   [要在 Windows 上安装 pgloader](https://github.com/dimitri/pgloader/issues/1017#issuecomment-566469443)，您可以使用适用于 Linux 的 Windows 子系统。

*   [要在 Mac 上安装 pgloader](https://github.com/dimitri/pgloader#building-from-sources-on-macos)，您可以使用：`brew install --HEAD pgloader`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-09-02T20:47:15.493

我用过[py-mysql2pgsql](https://github.com/philipsoutham/py-mysql2pgsql)。安装后只需要 yml 格式的简单配置文件（源，目标），例如：

```
# if a socket is specified we will use that
# if tcp is chosen you can use compression
mysql:
 hostname: localhost
 port: 3306
 socket: /tmp/mysql.sock
 username: mysql2psql
 password:
 database: mysql2psql_test
 compress: false
destination:
 # if file is given, output goes to file, else postgres
 file:
 postgres:
  hostname: localhost
  port: 5432
  username: mysql2psql
  password:
  database: mysql2psql_test 
```

用法：

```
> py-mysql2pgsql -h
usage: py-mysql2pgsql [-h] [-v] [-f FILE]

Tool for migrating/converting data from mysql to postgresql.

optional arguments:
  -h, --help            show this help message and exit
  -v, --verbose         Show progress of data migration.
  -f FILE, --file FILE  Location of configuration file (default:
                        mysql2pgsql.yml). If none exists at that path,
                        one will be created for you. 
```

更多关于它的主页[https://github.com/philipsoutham/py-mysql2pgsql](https://github.com/philipsoutham/py-mysql2pgsql)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T12:29:30.810

看看[PG Foundry](http://pgfoundry.org/)，Postgres 的额外实用程序往往会在那里。我相信您正在寻找的工具确实存在。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T14:25:55.413

此 postgresql 页面上列出了一款付费软件： [http ://www.postgresql.org/download/products/1](http://www.postgresql.org/download/products/1)

这是在pgFoundry： [http ://pgfoundry.org/projects/mysql2pgsql/](http://pgfoundry.org/projects/mysql2pgsql/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-09-22T10:05:12.427

[此页面](https://en.wikibooks.org/wiki/Converting_MySQL_to_PostgreSQL)列出了语法差异，但我还没有找到一个简单的工作查询转换器。使用[ORM](https://en.wikipedia.org/wiki/Object-relational_mapping)包而不是原始 SQL 可以防止这些问题。

我目前正在为遗留代码库开发一个转换器：

```
function mysql2pgsql($mysql){
    return preg_replace("/limit (\d+), *(\d+)/i", "limit $1 offset $2", preg_replace("/as '([^']+)'/i", 'as "$1"', $mysql)); // Note: limit needs order
} 
```

对于`CREATE`语句，[SQLines](http://www.sqlines.com/online)会在线转换大部分语句。不过，之后我仍然必须编辑 mysqldump：

```
"mediumtext" -> "text", "^LOCK.*" -> "", "^UNLOCK.*" -> "", "`" -> '"', "'" -> "''" in 'data', "0000-00-00" -> "2000-01-01", deduplicate constraint names, " CHARACTER SET utf8 " -> " ".
"int(10)" -> "int" was missed in the last table, so pass that part of the mysqldump through http://www.sqlines.com/online again. 
```

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2008-09-18T12:39:00.757

您很可能永远不会获得可以为您完成所有工作的此类任务的工具。准备好自己做一些重构工作。

# asp.net - ASP.NET 中的会话变量混淆？

> ID：92052
> 
> 赞同：1
> 
> 时间：2008-09-18T12:25:59.510
> 
> 标签：asp.net, session, variables

ASP.NET 是否可以混淆服务器上哪个用户与哪个会话变量相关联？会话变量是否与跨时间、空间和维度创建它们的原始用户一成不变？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T12:29:43.743

这取决于您的会话提供者，如果您以不再唯一的方式覆盖会话密钥生成，那么多个用户可能正在访问同一个会话。

你看到了什么行为？你确定你所说的变量没有静态因素吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T13:35:55.020

回答您最初的问题：会话被键入到放置在 cookie 中的 id。这个 id 是使用一些随机数加密例程生成的。它不能保证是唯一的，但在会话的整个生命周期内它极不可能被复制。即使您的会话持续了整个工作日。一个非常受欢迎的网站甚至可能需要数年时间才能生成一个重复的密钥（没有统计数据或事实来支持它）。

话虽如此，您的问题似乎并不在于会话值混淆了。我首先要看的是连接池。默认情况下，ADO 池连接，但如果您使用不在池中的用户名/密码请求连接，它应该为您提供一个新连接。提示如果您的站点非常大，将来可能会成为性能瓶颈。自从我使用 SQL Server 以来已经有一段时间了，在 Oracle 中可以调用来切换用户的身份。如果 SQL Server 中没有等价物，我会感到惊讶。您可以尝试使用通用用户名/密码连接到您的数据库，然后在将连接交回给其余代码之前执行该身份切换调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T12:29:19.733

虽然一切皆有可能。. . .

不，除非您将会话状态存储在 sql server 或其他进程外存储中，然后将其弄乱。. .

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T12:29:58.500

会话绑定到用户 cookie，在正常情况下发生混乱的可能性很小，但是如果使用分布式会话状态可能会出现问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T12:30:36.720

这是不可能的。会话与创建者相关联。

你想混在一起，或者你有一个看起来混在一起的情况吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T12:51:49.523

更多信息：

我有一个应用程序，它从登录页面获取用户名/密码并将其存储在会话变量中。我将它放入我的连接字符串中以调用 SQL Server。

当表被更新时，我们在数据库中使用“system_user”来识别“最后更新者”用户。我们看到一些奇怪的行为，其中我们期望列出的用户不正确，它显示的是其他人。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T13:02:36.223

您可以弹出调试器并查看是否确实在该连接字符串上传递了正确的值？它会很快帮助您确定问题出在哪一边。

还要确保没有任何连接代码具有连接或用户的静态属性，或者一个用户可能在更新触发之前将其连接替换为最新用户的连接。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T13:27:58.113

我的猜测是您正在重新使用类上的静态字段来保存连接字符串。这些静态字段在多个 IIS 请求中重复使用，因此您可能只会在“上次更新者”中看到最近登录的用户。

顺便说一句，除非您有充分的理由这样做，否则您不应该像这样连接到数据库。您正在阻止自己使用连接池，这会在高负载下损害性能。

# unit-testing - 图形用户界面测试

> ID：92059
> 
> 赞同：15
> 
> 时间：2008-09-18T12:26:52.423
> 
> 标签：unit-testing, user-interface, functional-programming

我正在解决测试我的 GUI 的问题，但我并不完全确定这里的最佳方法。我的 GUI 是使用传统的 MVC 框架构建的，因此我可以轻松地测试 GUI 的逻辑部分，而无需启动 GUI 本身。但是，在测试 GUI 的功能时，我不确定是否应该担心单独测试 GUI 组件，或者是否应该主要关注系统的功能测试。这是一个非常复杂的系统，其中测试 GUI 经常涉及向服务器发送消息，然后观察 GUI 上的响应。我最初的想法是功能测试是这里的方法，因为我需要运行整个系统来真正测试 UI。对此问题的评论将不胜感激。

谢谢，杰夫

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-18T17:15:38.063

我可以提供的其他 GUI 测试工具有： Thoughtworks [White](http://www.codeplex.com/white)、 [PyWinAuto](http://pywinauto.openqa.org/)、 [AutoIt](http://www.autoitscript.com/)、 [AutoHotKey](http://www.autohotkey.com/)。

尝试自动化 GUI 时要记住的一件事是，您可以做到这一点的唯一方法是在构建 GUI 时考虑到自动化。粉碎那些认为他们的 GUI 不应该在项目早期支持可测试性的开发人员，并愉快地公开所有有助于按需自动化的钩子，因为您的测试需要。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T12:34:38.600

您（至少）有两个问题 - 环境（服务器）的复杂性和 GUI 的复杂性。

有许多自动化 GUI 测试的工具。所有这些或多或少都是脆弱的，面对不断变化的布局，需要进行大量的持续维护。使用它们有好处，但这是一个长期的好处。

另一方面，环境是可以驯服的区域。如果您的应用程序是使用依赖注入/反转技术构建的（您将服务器组件“注入”到应用程序中），那么您可以使用相关服务器接口的“模拟”来使您能够编写测试用例脚本。

结合这两种技术将允许您自动化 GUI 测试。

最后一个想法——祝你好运！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T12:38:16.220

根据您在 MVC 范围内的位置（这是一个过度使用的术语），测试视图可能是一个机械过程，以确保调用正确的模型方法以响应视图的正确输入以测试某些客户端验证谁知道。

许多从 MVC 演变而来的模式（我在想[被动视图](http://martinfowler.com/eaaDev/PassiveScreen.html)，[监督控制器](http://martinfowler.com/eaaDev/SupervisingPresenter.html)）都在努力使视图只需要很少的测试，因为它实际上只是将用户输入连接到演示者或模型（取决于确切的您正在使用的模式的变体）。

“测试 GUI 经常涉及向服务器发送消息，然后观察 GUI 上的响应”这句话让我担心。

我立即认为应该使用服务器的模拟或存根来测试 GUI，以测试正确的交互正在发生并且 GUI 做出适当的响应。

如果您需要服务器的自动化功能测试，我认为不需要让 GUI 参与其中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T12:36:01.577

Mercury QuickTest Pro、Borland SilkTest 和 Ranorex Recorder 是一些 GUI 测试工具。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T12:37:27.657

如果您的应用程序是基于 Web 的，您可以使用[WatiN](http://watin.sourceforge.net/)或[Selenium](http://selenium.openqa.org/)等工具编写测试。

如果您的应用程序基于 Windows .NET，您可以尝试[White](http://www.codeplex.com/white)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T12:39:18.573

我的建议：忘记传统的 GUI 测试。太贵。编写测试代码需要很多时间，工具也不是很稳定，所以你会得到不可靠的测试结果。代码和测试之间的耦合非常强，你会花很多时间在维护上。

新趋势是忽略 GUI 测试。请参阅 Fowler 的 ModelViewPresenter 模式作为指南[链接文本](http://www.martinfowler.com/eaaDev/uiArchs.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T17:03:57.453

我能说的最清楚的方法是：

**不要浪费时间编写自动化 GUI 测试**。

特别是当您使用 MVC 应用程序时 - 在您的情况下，当您向服务器发送消息时，您可以确保正确的消息编号返回并完成。您可以添加一些额外的案例 - 或完全添加另一个测试，以确保 GUI 将消息 ID 转换为正确的字符串，但您只需要运行该测试一次。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-18T17:07:43.717

我们确实在我们的项目中加入了 GUI 测试，它有它的副作用。然而，开发人员有一个关键的设计原则：*保持 GUI 层尽可能薄！*

这意味着GUI 类中*没有逻辑*。在负责输入验证等的表示模型中将其分开。

为了在 Unix 机器上进行测试，我们在运行测试时使用 Xvfb 服务器作为 DISPLAY。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-09-25T21:43:15.823

Try the [hallway usability test](http://www.joelonsoftware.com/articles/fog0000000043.html). It's cheap and useful: go to the nearest hallway, grab the first person that passes, make them sit at your computer and use your software. Watch over their shoulder, you will see what they try to do, what frustrates them, and so on. Do this a few times and notice the patterns.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-18T12:28:53.747

您正在寻找的是“验收测试”。你如何做取决于你使用的框架，你正在创建什么类型的应用程序以及使用什么语言。如果你用谷歌搜索你的特定技术和上述短语，你应该会找到一些可以使用的工具。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-19T07:25:50.627

**不要错过“GUI”中的“U”**
我的意思是：如果您尝试测试的一切正常并且按计划工作，那么您可以遵循[Seb Rose 的回答](https://stackoverflow.com/questions/92059/gui-testing#92125)。

但是请不要忘记**，必须考虑用户界面**，而不是任何用户，而是应用程序的目标用户。因此，在您确定所有工作都必须正常工作之后，将每个视图/屏幕/表单与一个由用户组成的团队进行测试，该团队代表可能使用您的应用程序的每一组不同用户：高级用户、管理员、MS Office用户，低计算机配置用户，高计算机配置用户......然后，获得每个用户的批评，混合，如果需要，重新触摸您的 GUI，然后再次返回 GUI 用户的测试。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-23T11:24:23.817

我发现[WinTask](http://www.wintask.com/)是一种很好的 GUI 测试方法。如果您不经常更改操作系统引用 UI 的每个元素的方式，WinTask 会按名称寻址 UI 元素，因此即使布局发生变化，仍然可以按下/调整/选择 UI 元素。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-01T17:56:59.133

对于 SIMPLE 基于 Web 的 GUI 测试，请尝试[iMacros](https://addons.mozilla.org/en-US/firefox/addon/3863)（一个简单的 Firefox 插件，有一个很酷的功能，可以将整个测试发送给另一个人）请注意，SIMPLE 是用首字母拼写的......

# unicode - 不同语言的最小 Unicode 编码？

> ID：92073
> 
> 赞同：2
> 
> 时间：2008-09-18T12:29:07.473
> 
> 标签：unicode

不同语言中不同 unicode 编码的典型平均每字符字节数是多少？

例如，如果我想要最少的字节数来编码一些英文文本，那么平均而言，UTF-8 将是每个字符 1 个字节，而 UTF-16 将是 2，所以我会选择 UTF-8。

如果我想要一些韩文文本，那么 UTF-16 可能平均每个字符大约 2 个，但 UTF-8 可能平均大约 3 个（我不知道，我只是在这里编一些说明性数字）。

哪种编码对不同的语言和字符集产生最小的存储要求？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T12:32:30.913

对于任何给定的语言，每个字符的字节数比率都相当稳定，因为大多数语言都分配给连续的代码页。最大的例外是重音拉丁字符，它们在代码空间中的分配高于非重音形式。对于这些，我没有确切的数字。

对于具有连续字符分配的语言，在 Wikipedia 上有一个[表格，其中包含各种语言的详细编号。](http://en.wikipedia.org/wiki/Comparison_of_Unicode_encodings#In_detail)一般来说，UTF-8 适用于大多数小字符集（除了在高代码页上分配的字符集），而 UTF-16 适用于两字节字符集。

如果您需要更密集的压缩，您可能还想查看[Unicode Technical Note 14](http://www.unicode.org/notes/tn14/)，其中比较了一些旨在减少各种语言数据大小的特殊用途编码。但这些技术并不是特别常见。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T12:40:02.017

UTF8 最适合字符主要低于 U+0800 的任何字符集。否则为 UTF16。

也就是说，UTF8 表示拉丁文、希腊文、西里尔文、希伯来文和阿拉伯文等。在拉丁语以外的语言中，字符将占用与在 UTF16 中相同的空间，但您将节省标点符号和间距的字节。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T12:42:18.143

如果您真的担心字符串/字符大小，您是否考虑过压缩它们？这会自动将字符串减少到它的“最小”编码。这是令人头疼的一层，尤其是如果您想在内存中执行此操作，并且在很多情况下它不会给您带来任何好处，但是尤其是编码对于您看起来的紧凑程度而言往往过于通用要瞄准。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T12:51:41.803

在 UTF-16 中，所有重要的语言（即除了克林贡语、精灵和其他奇怪的东西之外的任何语言）都将被编码为 2 字节字符。

所以问题是找到具有 2 字节或 1 字节大小字符的字形的语言。

在 UTF-8 的维基百科页面中： [http ://en.wikipedia.org/wiki/Utf-8](http://en.wikipedia.org/wiki/Utf-8)

我们看到，Unicode 索引为 0x0800 或更大的字符在 UTF-8 中至少有 3 个字节长。

知道了，你只需要看看 unicode 上的代码图表：[http ://www.unicode.org/charts/](http://www.unicode.org/charts/)

符合您要求的语言。

:-)

现在，请注意，根据您使用的框架，选择很可能不是您的选择：

*   在 Windows API 上，Unicode 由 wchar_t 字符处理，并且是 UTF-16
*   在 Linux 上，Unicode 由 char 处理，并且是 UTF-8
*   Java 内部是 UTF-16，大多数兼容的 XML 解析器也是如此
*   有人告诉我（一些我不感兴趣的技术会议......对不起......）UTF-8 是数据库选择的编码。

所以，拿起你的毒药...

:-)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T13:02:02.387

我不知道确切的数字，但对于日语 Shift_JIS 平均每个字符的字节数比 UTF-8 少，EUC-JP 也是如此，因为它们针对日语文本进行了优化。但是，它们不涵盖与 Unicode 相同的代码点空间，因此它们可能不是您问题的正确答案。

UTF-16 对于日语字符（每个字符 2 个字节而不是 3 个）优于 UTF-8，但如果有很多 7 位字符，则比 UTF-8 差。这取决于上下文 - 技术文本更有可能包含 1 字节范围内的大量字符。经典的日语文本可能没有。

请注意，对于传输，如果您可以压缩（gzip，bz2）数据，则编码并不重要。Unicode 中字母的代码点非常接近，因此您会期望在压缩数据中具有非常短的表示的通用前缀。

UTF-8 通常适合在内存中表示，因为它通常比 UTF-32 或 UTF-16 更紧凑，并且与 char* 上的函数兼容，这些函数“期望”ASCII 或 ISO-8859-1 NUL 终止的字符串。但是，如果您需要按索引随机访问字符，那将毫无用处。

如果您不关心非 BMP 字符，UCS-2 总是每个字符 2 个字节，因此提供随机访问。但这取决于你所说的“Unicode”是什么意思。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T12:35:06.663

UTF-8

JoelOnSoftware 上有一篇关于 unicode 的非常好的文章：

[每个软件开发人员绝对、绝对必须了解 Unicode 和字符集的绝对最低要求（没有借口！）](http://www.joelonsoftware.com/printerFriendly/articles/Unicode.html)

# xml - 如何以独立于平台的方式使用节点集功能？

> ID：92076
> 
> 赞同：11
> 
> 时间：2008-09-18T12:29:20.657
> 
> 标签：xml, cross-platform, msxml, xslt

我正在编写一些我想在 linux 和 Windows 下使用的 xlst 文件。在这个文件中，我使用了在 MSXML 和 xsltproc 的不同命名空间中声明的节点集函数（分别为“urn:schemas-microsoft-com:xslt”和“ [http://exslt.org/common](http://exslt.org/common) ”）。是否有任何平台独立的方式使用节点集？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-18T13:26:47.913

您可以使用函数 function-available() 来确定应该使用哪个函数：

```
<xsl:choose>
  <xsl:when test="function-available('exslt:node-set')">
    <xsl:apply-templates select="exslt:node-set($nodelist)" />
  </xsl:when>
  <xsl:when test="function-available('msxsl:node-set')">
    <xsl:apply-templates select="msxsl:node-set($nodelist)" />
  </xsl:when>
  <!-- etc -->
</xsl:choose> 
```

您甚至可以将此逻辑包装在命名模板中，并使用节点集作为参数调用它。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-01T03:45:40.770

**是的，有一个很好的通用解决方案**。

[**EXSLT**](http://exslt.org/)的函数[**common:node-set()**](http://exslt.org/exsl/functions/node-set/index.html)可以实现为内联 Javascript 函数，因此可用于任何支持 Javascript 的浏览器（几乎所有主流浏览器无一例外）。

这种技术最初是由[**Julian Reschke**](http://greenbytes.de/tech/webdav/)发现的，在他将其发布到[**xsl-list**](http://www.biglist.com/lists/xsl-list/archives/)后，由[**David Carlisle**](http://dpcarlisle.blogspot.com/)进行了宣传。在[**David Carlisle 的博客上，**](http://dpcarlisle.blogspot.com/2007/05/exslt-node-set-function.html)还有一个指向测试页面的链接，该链接显示了这样实现的 common:node-set() 函数是否适用于您选择的浏览器。

总结一下：

1.  首先去[**这里**](http://dpcarlisle.blogspot.com/2007/05/exslt-node-set-function.html)阅读解释。
2.  然后尝试测试页面。特别是，验证它是否适用于 IE（这意味着适用于 MSXML）
3.  最后，使用代码。

尽情享受吧！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T21:58:34.890

[Exslt](http://www.exslt.org) “应该是”一组独立于平台的 xslt 扩展，但仅限于各种 xslt 处理器选择实现它们。

有[一些证据](http://www.tkachenko.com/blog/archives/000559.html)表明 MSXML 实际上确实支持 exsl:node-set()，但我不确定。

有一篇[旧文章](http://www.xml.com/pub/a/2003/08/06/exslt.html)讨论[了基于 MSXML 的 exslt 实现](http://fxsl.sourceforge.net/)。

否则，我认为 function-available() 是你的朋友:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T12:34:03.157

Firefox 3 在其客户端 XSLT 处理中实现了节点集（作为 EXSLT 2.0 命名空间改进的一部分）。

也许不是您正在寻找的答案 - 但它可能是，这取决于您的问题的上下文。;-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T08:41:51.363

如果没有特别的理由在 Windows 上使用节点集的 msxml 实现，您可以在任何地方使用 exslt，方法是将从[http://exslt.org](http://exslt.org)下载的实现包含在您的样式表中，[exslt howto](http://exslt.org/howto.html)描述了所需的步骤。您可以使用“扩展名称空间”方式或“命名模板”方式。

# compilation - Borland C++ Builder 6 总是编译所有文件

> ID：92079
> 
> 赞同：1
> 
> 时间：2008-09-18T12:29:54.197
> 
> 标签：compilation, c++builder, c++builder-6

为什么 C++ Builder 6 总是编译所有文件？

我对一个文件进行了一些更改，但 BCB 6 会在我启动应用程序时编译所有文件。任何的想法？我使用的是 Windows XP SP2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T12:48:17.317

您是否位于同一台机器上的源文件和二进制对象？如果不是听起来像您有网络时间同步问题。

如果它们最有可能是头文件问题，则编译器包含文件在未来某个时间有修改日期，或者您的应用程序依赖于在编译期间更改的某些头文件，例如从 COM 导入。

编辑：检查设置 VS 有一个始终重新编译的标志，这对于 BCB 也可能是正确的，如果设置然后取消设置它。另一种可能性是预编译的头文件被错误配置为在每个源文件上生成。

我不熟悉 BCB 6 来给出更准确的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T13:14:02.250

试试这个 BCB 编译器插件： [Bcc32Pch IDE Plugin](http://andy.jgknet.de/cpp/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T19:49:09.380

您是否使所有或许多文件依赖于特定模块？

任何依赖于特定模块的文件都将在模块类结构（包含在 .h 文件中）被修改时重新构建。例如，如果您有一个可以被许多其他模块访问的数据模块，那么每次修改数据模块的类结构时，您都会看到所有依赖模块的重建。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-03T21:45:58.050

Borland 中有一个编译指示，它控制重新编译的代码行数。

在过去的几年中，我管理过（在某些项目中），只编译了我的源代码的更改。我不知道，这是否适用于较新版本的 borland

Borland 6 有一个编译指示“hdrstop”。这仅在项目选项“预编译头”不是“无”时才有效

几年前，我有一台非常慢的计算机，我通过以下技巧将编译时间从几小时缩短到几分钟

所有cpp都变成了这第一行

```
#include "all.h"
#pragma hdrstop 
```

默认是“vcl.h”的包含

“all.h”将包括所有标题，这是所有需要的！单位。每个单元将跳过所有源，这取决于pragma hdrstop**之前的标题。**

例子：

单元1.h

```
 #include <string> 
```

单元1.cpp

```
 #include "all.h"
   #pragma hdrstop

   #include "Unit1.h" 
```

单元2.h

```
 #include <vcl> 
```

单元2.cpp

```
 #include "all.h"
   #pragma hdrstop

   #include "Unit2.h" 
```

全部.h

```
 #include <string>
   #include <vcl> 
```

* * *

## 输入

1.  不要在头文件中使用 all.h
2.  您可以添加项目标题中使用的所有包含，例如，
3.  所有依赖于“预编译头文件”的源都不会再次编译！
4.  预编译头文件的生成会很慢！所以只在 all.h 中添加 headers，不会经常更改。像系统标题或您的标题已经完成。
5.  编译可能会失败。有时包含的顺序会为编译产生“僵局”。如果发生这种情况，请停用“预编译头文件”。如果您像在 java 中那样编写 c++，大多数问题都会得到解决：每个类都将成为他自己的文件（cpp 和 h）。
6.  项目选项“Pre-Compiled headers”中的文件名显示了实际预编译文件的基本名称。一个单元可以与另一个单元共享一个预编译文件，如果它在“pragma hdrstop”之前具有（完全相同）相同的inludes。如果您只有一个带有数字后缀的文件，则可以达到最佳性能。多个预编译头的示例：

单元1.h

```
 #include <string> 
```

单元1.cpp

```
 #include "all.h"
   #pragma hdrstop

   #include "Unit1.h" 
```

单元2.h

```
 #include <vcl> 
```

单元2.cpp

```
 #include <vcl> //!!!!!!!!!!!!!!!!!!! produce a second version of an precompiled file
   #pragma hdrstop

   #include "Unit2.h" 
```

全部.h

```
 #include <string>
  #include <vcl> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T13:14:03.230

确保您使用的是“make”命令而不是“build”命令，除非它是必需的。

用 Borland 工具做一个项目似乎总是有这个问题——它不一定注意到哪些已经改变并开始编译所有东西。

查看 Pre-Compiled Headers 选项，这可能有助于加快速度。

当 Borland/CodeGear 从 C++Builder 2007 开始切换到 MSBuild 系统时，编译速度更快，效率更高。

# sql - 将具有默认值的列添加到 SQL Server 中的现有表

> ID：92082
> 
> 赞同：3061
> 
> 时间：2008-09-18T12:30:04.630
> 
> 标签：sql, sql-server, sql-server-2005, sql-server-2000

如何在[SQL Server 2000](http://en.wikipedia.org/wiki/Microsoft_SQL_Server#Genesis) / [SQL Server 2005](http://en.wikipedia.org/wiki/Microsoft_SQL_Server#SQL_Server_2005)的现有表中添加具有默认值的列？

* * *

## 回答 #1

> 赞同：3869
> 
> 时间：2008-09-18T12:34:33.437

## 句法：

```
ALTER TABLE {TABLENAME} 
ADD {COLUMNNAME} {TYPE} {NULL|NOT NULL} 
CONSTRAINT {CONSTRAINT_NAME} DEFAULT {DEFAULT_VALUE}
WITH VALUES 
```

## 例子：

```
ALTER TABLE SomeTable
        ADD SomeCol Bit NULL --Or NOT NULL.
 CONSTRAINT D_SomeTable_SomeCol --When Omitted a Default-Constraint Name is autogenerated.
    DEFAULT (0)--Optional Default-Constraint.
WITH VALUES --Add if Column is Nullable and you want the Default Value for Existing Records. 
```

## 笔记：

**可选的约束名称：**
如果您省略`CONSTRAINT D_SomeTable_SomeCol`，SQL Server 将自动生成
    一个具有有趣名称的默认约束，例如：`DF__SomeTa__SomeC__4FB7FEF6`

**可选的 With-Values 语句：**
仅 当`WITH VALUES`您的列为 Nullable
    并且您希望将默认值用于现有记录时才需要。
如果您的 Column 是`NOT NULL`，那么无论您是否指定，它都会自动使用
    所有现有记录的默认值`WITH VALUES`。

**插入如何与默认约束一起使用：**
如果您将记录插入`SomeTable`并且***不***指定`SomeCol`的值，那么它将默认为`0`。
如果您插入 Record***并***Specify`SomeCol`的值作为`NULL`（并且您的列允许空值），
    则默认约束将***不会***被使用，`NULL`并将作为值插入。

笔记基于以下每个人的出色反馈。
特别感谢：
    @Yatrix、@WalterStabosz、@YahooSerious 和 @StackMan 的评论。

* * *

## 回答 #2

> 赞同：1115
> 
> 时间：2008-09-18T12:31:48.387

```
ALTER TABLE Protocols
ADD ProtocolTypeID int NOT NULL DEFAULT(1)
GO 
```

包含**DEFAULT**会使用默认值填充**现有**行中的列，因此不会违反 NOT NULL 约束。

* * *

## 回答 #3

> 赞同：266
> 
> 时间：2011-04-12T17:40:44.833

添加可为*空的列*时，`WITH VALUES`将确保将特定的 DEFAULT 值应用于现有行：

```
ALTER TABLE table
ADD column BIT     -- Demonstration with NULL-able column added
CONSTRAINT Constraint_name DEFAULT 0 WITH VALUES 
```

* * *

## 回答 #4

> 赞同：153
> 
> 时间：2008-09-18T12:39:32.877

```
ALTER TABLE <table name> 
ADD <new column name> <data type> NOT NULL
GO
ALTER TABLE <table name> 
ADD CONSTRAINT <constraint name> DEFAULT <default value> FOR <new column name>
GO 
```

* * *

## 回答 #5

> 赞同：140
> 
> 时间：2012-08-05T03:28:21.523

```
ALTER TABLE MYTABLE ADD MYNEWCOLUMN VARCHAR(200) DEFAULT 'SNUGGLES' 
```

* * *

## 回答 #6

> 赞同：113
> 
> 时间：2012-05-25T14:50:21.837

最基本的版本，只有两行

```
ALTER TABLE MyTable
ADD MyNewColumn INT NOT NULL DEFAULT 0 
```

* * *

## 回答 #7

> 赞同：105
> 
> 时间：2008-09-24T16:03:25.137

当您添加的列有`NOT NULL`约束但没有`DEFAULT`约束（值）时要小心。在这种情况下，如果表中有任何行，该`ALTER TABLE`语句将失败。`NOT NULL`解决方案是从新列中删除约束，或为其提供`DEFAULT`约束。

* * *

## 回答 #8

> 赞同：94
> 
> 时间：2010-12-09T17:45:15.897

采用：

```
-- Add a column with a default DateTime  
-- to capture when each record is added.

ALTER TABLE myTableName  
ADD RecordAddedDate SMALLDATETIME NULL DEFAULT (GETDATE())  
GO 
```

* * *

## 回答 #9

> 赞同：90
> 
> 时间：2014-10-14T18:38:41.273

如果你想添加多个列，你可以这样做，例如：

```
ALTER TABLE YourTable
    ADD Column1 INT NOT NULL DEFAULT 0,
        Column2 INT NOT NULL DEFAULT 1,
        Column3 VARCHAR(50) DEFAULT 'Hello'
GO 
```

* * *

## 回答 #10

> 赞同：60
> 
> 时间：2011-12-27T02:44:40.633

采用：

```
ALTER TABLE {TABLENAME} 
ADD {COLUMNNAME} {TYPE} {NULL|NOT NULL} 
CONSTRAINT {CONSTRAINT_NAME} DEFAULT {DEFAULT_VALUE} 
```

参考：[ALTER TABLE (Transact-SQL)](https://msdn.microsoft.com/en-us/library/ms190273.aspx) (MSDN)

* * *

## 回答 #11

> 赞同：60
> 
> 时间：2014-06-20T18:33:58.603

要将列添加到具有默认值的现有数据库表，我们可以使用：

```
ALTER TABLE [dbo.table_name]
    ADD [Column_Name] BIT NOT NULL
Default ( 0 ) 
```

这是将列添加到具有默认值的现有数据库表的另一种方法。

下面是一个更彻底的 SQL 脚本，用于添加具有默认值的列，包括在添加列之前检查列是否存在，还检查约束并在存在约束时将其删除。该脚本还为约束命名，这样我们就可以有一个很好的命名约定（我喜欢 DF_），如果不是，SQL 会给我们一个具有随机生成数字的名称的约束；所以也很高兴能够命名约束。

```
-------------------------------------------------------------------------
-- Drop COLUMN
-- Name of Column: Column_EmployeeName
-- Name of Table: table_Emplyee
--------------------------------------------------------------------------
IF EXISTS (
            SELECT 1
            FROM INFORMATION_SCHEMA.COLUMNS
            WHERE TABLE_NAME = 'table_Emplyee'
              AND COLUMN_NAME = 'Column_EmployeeName'
           )
    BEGIN

        IF EXISTS ( SELECT 1
                    FROM sys.default_constraints
                    WHERE object_id = OBJECT_ID('[dbo].[DF_table_Emplyee_Column_EmployeeName]')
                      AND parent_object_id = OBJECT_ID('[dbo].[table_Emplyee]')
                  )
            BEGIN
                ------  DROP Contraint

                ALTER TABLE [dbo].[table_Emplyee] DROP CONSTRAINT [DF_table_Emplyee_Column_EmployeeName]
            PRINT '[DF_table_Emplyee_Column_EmployeeName] was dropped'
            END
     --    -----   DROP Column   -----------------------------------------------------------------
        ALTER TABLE [dbo].table_Emplyee
            DROP COLUMN Column_EmployeeName
        PRINT 'Column Column_EmployeeName in images table was dropped'
    END

--------------------------------------------------------------------------
-- ADD  COLUMN Column_EmployeeName IN table_Emplyee table
--------------------------------------------------------------------------
IF NOT EXISTS (
                SELECT 1
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = 'table_Emplyee'
                  AND COLUMN_NAME = 'Column_EmployeeName'
               )
    BEGIN
    ----- ADD Column & Contraint
        ALTER TABLE dbo.table_Emplyee
            ADD Column_EmployeeName BIT   NOT NULL
            CONSTRAINT [DF_table_Emplyee_Column_EmployeeName]  DEFAULT (0)
        PRINT 'Column [DF_table_Emplyee_Column_EmployeeName] in table_Emplyee table was Added'
        PRINT 'Contraint [DF_table_Emplyee_Column_EmployeeName] was Added'
     END

GO 
```

这是将列添加到具有默认值的现有数据库表的两种方法。

* * *

## 回答 #12

> 赞同：56
> 
> 时间：2011-11-27T11:39:59.060

您可以通过以下方式使用 T-SQL 执行此操作。

```
 ALTER TABLE {TABLENAME}
 ADD {COLUMNNAME} {TYPE} {NULL|NOT NULL}
 CONSTRAINT {CONSTRAINT_NAME} DEFAULT {DEFAULT_VALUE} 
```

您也可以通过右键单击设计菜单中的表来使用[SQL Server Management Studio ，将默认值设置为表。](http://en.wikipedia.org/wiki/SQL_Server_Management_Studio)

此外，如果要向数据库中的所有表添加相同的列（如果它不存在），请使用：

```
 USE AdventureWorks;
 EXEC sp_msforeachtable
'PRINT ''ALTER TABLE ? ADD Date_Created DATETIME DEFAULT GETDATE();''' ; 
```

* * *

## 回答 #13

> 赞同：55
> 
> 时间：2011-12-01T00:19:06.657

在 SQL Server 2008-R2 中，我进入设计模式 - 在测试数据库中 - 并使用设计器添加我的两列并使用 GUI 进行设置，然后臭名昭著`Right-Click`的提供选项“***生成更改脚本***”！

弹出一个小窗口，您猜对了，正确格式的保证工作更改脚本。点击简单按钮。

* * *

## 回答 #14

> 赞同：53
> 
> 时间：2012-06-01T02:19:53.520

或者，您可以添加默认值而无需显式命名约束：

```
ALTER TABLE [schema].[tablename] ADD  DEFAULT ((0)) FOR [columnname] 
```

如果您在创建此约束时对现有默认约束有疑问，则可以通过以下方式删除它们：

```
alter table [schema].[tablename] drop constraint [constraintname] 
```

* * *

## 回答 #15

> 赞同：49
> 
> 时间：2015-12-10T17:26:57.407

这也可以在 SSMS GUI 中完成。我在下面显示了一个默认日期，但默认值当然可以是任何值。

1.  将您的表格放在设计视图中（右键单击对象资源管理器中的表格->设计）
2.  向表中添加一列（如果已存在，请单击要更新的列）
3.  在下面的列属性中，在*默认值或绑定*字段中输入`(getdate())`或`'abc'`或`0`或您想要的任何值，如下图所示：

 *[![在此处输入图像描述](https://i.stack.imgur.com/FQbi1.png)](https://i.stack.imgur.com/FQbi1.png)

* * *

## 回答 #16

> 赞同：45
> 
> 时间：2008-09-18T12:31:01.120

```
ALTER TABLE ADD ColumnName {Column_Type} Constraint 
```

MSDN 文章*[ALTER TABLE (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms190273.aspx)*包含所有的 alter table 语法。

* * *

## 回答 #17

> 赞同：36
> 
> 时间：2014-03-05T13:37:20.943

例子：

```
ALTER TABLE [Employees] ADD Seniority int not null default 0 GO 
```

* * *

## 回答 #18

> 赞同：25
> 
> 时间：2014-11-25T13:23:07.067

例子：

```
ALTER TABLE tes 
ADD ssd  NUMBER   DEFAULT '0'; 
```

* * *

## 回答 #19

> 赞同：24
> 
> 时间：2016-10-20T04:17:29.097

**首先创建一个名为 student 的表：**

```
CREATE TABLE STUDENT (STUDENT_ID INT NOT NULL) 
```

**向其中添加一列：**

```
ALTER TABLE STUDENT 
ADD STUDENT_NAME INT NOT NULL DEFAULT(0)

SELECT * 
FROM STUDENT 
```

将创建该表并将一列添加到具有默认值的现有表中。

[![图 1](https://i.stack.imgur.com/lMXvg.png)](https://i.stack.imgur.com/lMXvg.png)

* * *

## 回答 #20

> 赞同：22
> 
> 时间：2017-05-05T08:45:05.260

这有很多答案，但我觉得有必要添加这个扩展方法。这似乎要长得多，但如果您将 NOT NULL 字段添加到活动数据库中具有数百万行的表中，则它非常有用。

```
ALTER TABLE {schemaName}.{tableName}
    ADD {columnName} {datatype} NULL
    CONSTRAINT {constraintName} DEFAULT {DefaultValue}

UPDATE {schemaName}.{tableName}
    SET {columnName} = {DefaultValue}
    WHERE {columName} IS NULL

ALTER TABLE {schemaName}.{tableName}
    ALTER COLUMN {columnName} {datatype} NOT NULL 
```

这将做的是将列添加为可空字段并使用默认值，将所有字段更新为默认值（或者您可以分配更有意义的值），最后它将将该列更改为 NOT NULL。

这样做的原因是，如果您更新一个大型表并添加一个新的非空字段，它必须写入每一行，因此将在添加列时锁定整个表，然后写入所有值。

此方法将添加可空列，该列本身运行速度更快，然后在设置非空状态之前填充数据。

我发现在一个语句中完成整个操作会将我们更活跃的表之一锁定 4-8 分钟，而且我经常会终止该进程。这种方法每个部分通常只需要几秒钟并且导致最小的锁定。

此外，如果您有一个包含数十亿行的表，则可能值得像这样批量更新：

```
WHILE 1=1
BEGIN
    UPDATE TOP (1000000) {schemaName}.{tableName}
        SET {columnName} = {DefaultValue}
        WHERE {columName} IS NULL

    IF @@ROWCOUNT < 1000000
        BREAK;
END 
```

* * *

## 回答 #21

> 赞同：21
> 
> 时间：2014-09-01T07:17:52.563

试试这个

```
ALTER TABLE Product
ADD ProductID INT NOT NULL DEFAULT(1)
GO 
```

* * *

## 回答 #22

> 赞同：20
> 
> 时间：2015-06-15T14:04:34.733

SQL Server + Alter Table + 添加列 + 默认值 uniqueidentifier

```
ALTER TABLE Product 
ADD ReferenceID uniqueidentifier not null 
default (cast(cast(0 as binary) as uniqueidentifier)) 
```

* * *

## 回答 #23

> 赞同：20
> 
> 时间：2016-04-26T05:46:59.383

```
IF NOT EXISTS (
    SELECT * FROM INFORMATION_SCHEMA.COLUMNS
    WHERE TABLE_NAME ='TABLENAME' AND COLUMN_NAME = 'COLUMNNAME'
)
BEGIN
    ALTER TABLE TABLENAME ADD COLUMNNAME Nvarchar(MAX) Not Null default
END 
```

* * *

## 回答 #24

> 赞同：20
> 
> 时间：2018-02-08T13:58:41.693

```
--Adding Value with Default Value
ALTER TABLE TestTable
ADD ThirdCol INT NOT NULL DEFAULT(0)
GO 
```

* * *

## 回答 #25

> 赞同：19
> 
> 时间：2018-02-05T07:26:16.313

这适用于 SQL Server：

```
ALTER TABLE TableName
ADD ColumnName (type) -- NULL OR NOT NULL
DEFAULT (default value)
WITH VALUES 
```

例子：

```
ALTER TABLE Activities
ADD status int NOT NULL DEFAULT (0)
WITH VALUES 
```

如果要添加约束，则：

```
ALTER TABLE Table_1
ADD row3 int NOT NULL
CONSTRAINT CONSTRAINT_NAME DEFAULT (0)
WITH VALUES 
```

* * *

## 回答 #26

> 赞同：16
> 
> 时间：2015-12-22T10:52:03.997

向表中添加新列：

```
ALTER TABLE [table]
ADD Column1 Datatype 
```

**例如，**

```
ALTER TABLE [test]
ADD ID Int 
```

如果用户想让它自动递增，那么：

```
ALTER TABLE [test]
ADD ID Int IDENTITY(1,1) NOT NULL 
```

* * *

## 回答 #27

> 赞同：12
> 
> 时间：2016-09-09T06:40:59.843

这可以通过下面的代码来完成。

```
CREATE TABLE TestTable
    (FirstCol INT NOT NULL)
    GO
    ------------------------------
    -- Option 1
    ------------------------------
    -- Adding New Column
    ALTER TABLE TestTable
    ADD SecondCol INT
    GO
    -- Updating it with Default
    UPDATE TestTable
    SET SecondCol = 0
    GO
    -- Alter
    ALTER TABLE TestTable
    ALTER COLUMN SecondCol INT NOT NULL
    GO 
```

* * *

## 回答 #28

> 赞同：12
> 
> 时间：2018-08-28T08:22:22.943

尝试使用以下查询：

```
ALTER TABLE MyTable
ADD MyNewColumn DataType DEFAULT DefaultValue 
```

这将在表格中添加一个新列。

* * *

## 回答 #29

> 赞同：10
> 
> 时间：2016-05-24T11:20:56.783

```
ALTER TABLE tbl_table ADD int_column int NOT NULL DEFAULT(0) 
```

从此查询中，您可以添加默认值为 0 的数据类型整数列。

* * *

## 回答 #30

> 赞同：10
> 
> 时间：2017-03-09T12:37:06.400

好吧，我现在对我之前的答案进行了一些修改。我注意到没有提到任何答案`IF NOT EXISTS`。所以我将提供一个新的解决方案，因为我在更改表格时遇到了一些问题。

```
IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.columns WHERE table_name = 'TaskSheet' AND column_name = 'IsBilledToClient')
BEGIN
ALTER TABLE dbo.TaskSheet ADD
 IsBilledToClient bit NOT NULL DEFAULT ((1))
END
GO 
```

这`TaskSheet`是特定的表名，`IsBilledToClient`是您要插入的新列和`1`默认值。这意味着在新列中现有行的值是多少，因此将在那里自动设置一个。但是，您可以根据我使用的列类型随意更改`BIT`，因此我输入默认值 1。

我建议使用上述系统，因为我遇到了一个问题。那么问题是什么？问题是，如果`IsBilledToClient`表中确实存在该列，那么如果您只执行下面给出的部分代码，您将在 SQL Server 查询生成器中看到错误。但是如果它不存在，那么第一次执行时不会出错。

```
ALTER TABLE {TABLENAME}
ADD {COLUMNNAME} {TYPE} {NULL|NOT NULL}
CONSTRAINT {CONSTRAINT_NAME} DEFAULT {DEFAULT_VALUE}
[WITH VALUES] 
```

* * *

## 回答 #31

> 赞同：8
> 
> 时间：2016-05-09T14:28:10.380

如果默认值为 Null，则：

1.  在 SQL Server 中，打开目标表的树
2.  右键单击“列”==>`New Column`
3.  键入列名称，`Select Type`然后选中允许空值复选框
4.  在菜单栏中，单击`Save`

完毕！

* * *

## 回答 #32

> 赞同：8
> 
> 时间：2017-03-15T05:29:29.713

您可以使用此查询：

```
ALTER TABLE tableName ADD ColumnName datatype DEFAULT DefaultValue; 
```

* * *

## 回答 #33

> 赞同：8
> 
> 时间：2017-05-09T12:14:24.650

右键单击表名并单击**Design**，单击最后一个列名下并输入 Column Name, Data Type, Allow Nulls。

然后在页面底部设置一个**默认值或绑定**：类似于 '1' 的字符串或 1 的 int。

* * *

## 回答 #34

> 赞同：7
> 
> 时间：2020-06-12T21:31:21.647

```
ALTER TABLE <YOUR_TABLENAME>
ADD <YOUR_COLUMNNAME> <DATATYPE> <NULL|NOT NULL> 
ADD CONSTRAINT <CONSTRAINT_NAME>   ----OPTIONAL
DEFAULT <DEFAULT_VALUE> 
```

如果您没有给出约束名称，那么 sql server 使用默认名称。

**例子：-**

```
ALTER TABLE TEMP_TABLENAME
ADD COLUMN1 NUMERIC(10,0) NOT NULL
ADD CONSTRAINT ABCDE   ----OPTIONAL
DEFAULT (0) 
```

* * *

## 回答 #35

> 赞同：6
> 
> 时间：2017-10-04T09:56:06.443

第1步。首先，您必须通过添加字段来更改表

```
alter table table_name add field field_name data_type 
```

步骤 2 创建默认值

```
USE data_base_name;
GO
CREATE DEFAULT default_name AS 'default_value'; 
```

step-3 然后你必须执行这个程序

```
exec sp_bindefault 'default_name' , 'schema_name.table_name.field_name' 
```

例子 -

```
USE master;
GO
EXEC sp_bindefault 'today', 'HumanResources.Employee.HireDate'; 
```

* * *

## 回答 #36

> 赞同：6
> 
> 时间：2018-04-15T07:14:51.410

```
--Adding New Column with Default Value
ALTER TABLE TABLENAME 
ADD COLUMNNAME DATATYPE NULL|NOT NULL DEFAULT (DEFAULT_VALUE) 
```

或者

```
--Adding CONSTRAINT And Set Default Value on Column
ALTER TABLE TABLENAME ADD  CONSTRAINT [CONSTRAINT_Name]  DEFAULT 
(DEFAULT_VALUE) FOR [COLUMNNAME] 
```

* * *

## 回答 #37

> 赞同：5
> 
> 时间：2015-12-07T10:44:35.230

SQL Server + Alter Table + 添加列 + 默认值 uniqueidentifier...

```
ALTER TABLE [TABLENAME] ADD MyNewColumn INT not null default 0 GO 
```

* * *

## 回答 #38

> 赞同：4
> 
> 时间：2018-02-13T07:05:51.180

```
ALTER TABLE Table1 ADD Col3 INT NOT NULL DEFAULT(0) 
```

* * *

## 回答 #39

> 赞同：3
> 
> 时间：2020-05-08T16:31:35.177

`OFFLINE`并`ONLINE`涉及如何在 NDB Cluster Tables 上执行 ALTER table。NDB Cluster 支持在 MySQL NDB Cluster 7.3 及更高版本中使用 ALGORITHM=INPLACE 语法的在线 ALTER TABLE 操作。NDB Cluster 还支持使用 ONLINE 和 OFFLINE 关键字的特定于 NDB 的旧语法。从 MySQL NDB Cluster 7.3 开始不推荐使用这些关键字；它们在 MySQL NDB Cluster 7.4 中继续受支持，但在 NDB Cluster 的未来版本中可能会被删除。

`IGNORE`与 ALTER 语句将如何处理具有新添加的约束 UNIQUE 的列中的重复值有关。如果未指定 IGNORE，则 ALTER 将失败并且不会被应用。如果指定了 IGNORE，则保留所有重复行的第一行，删除重置并应用 ALTER。

这`ALTER_SPECIFICATION`将是你正在改变的。您正在添加、删除或修改什么列或索引，或者您在列上应用了哪些约束。

```
ALTER [ONLINE | OFFLINE] [IGNORE] TABLE tbl_name
       alter_specification [, alter_specification] ...

    alter_specification:
        ...
        ADD [COLUMN] (col_name column_definition,...)
        ...

Eg: ALTER TABLE table1 ADD COLUMN foo INT DEFAULT 0; 
```

* * *

## 回答 #40

> 赞同：3
> 
> 时间：2021-11-18T01:39:34.490

有两种不同的方法来解决这个问题。两者都添加了默认值，但在这里的问题陈述中添加了完全不同的含义。

让我们从创建一些示例数据开始。

## **创建示例数据**

```
CREATE TABLE ExistingTable (ID INT)
GO
INSERT INTO ExistingTable (ID)
VALUES (1), (2), (3)
GO
SELECT *
FROM ExistingTable 
```

[![在此处输入图像描述](https://i.stack.imgur.com/4DGjz.png)](https://i.stack.imgur.com/4DGjz.png)

## **1.为将来的插入添加具有默认值的列**

```
ALTER TABLE ExistingTable
ADD ColWithDefault VARCHAR(10) DEFAULT 'Hi'
GO 
```

[![在此处输入图像描述](https://i.stack.imgur.com/K0IzB.png)](https://i.stack.imgur.com/K0IzB.png)

所以现在我们在插入新记录时添加了一个默认列，`'Hi'`如果没有提供值，它将默认它的值

```
INSERT INTO ExistingTable(ID)
VALUES (4)
GO
Select * from ExistingTable
GO 
```

[![在此处输入图像描述](https://i.stack.imgur.com/0Ddse.png)](https://i.stack.imgur.com/0Ddse.png)

好吧，这解决了我们的问题以具有默认值，但这是一个问题。如果我们想在所有列中都有默认值，而不仅仅是未来的插入呢？？？为此，我们有方法 2。

## **2.为所有插入添加具有默认值的列**

```
ALTER TABLE ExistingTable
ADD DefaultColWithVal VARCHAR(10) DEFAULT 'DefaultAll'
WITH VALUES
GO
Select * from ExistingTable
GO 
```

[![在此处输入图像描述](https://i.stack.imgur.com/WQEVe.png)](https://i.stack.imgur.com/WQEVe.png)

以下脚本将在每种可能的情况下添加一个具有默认值的新列。

希望它为所提出的问题增加价值。谢谢。

* * *

## 回答 #41

> 赞同：2
> 
> 时间：2019-11-19T12:48:44.560

在 SQL Server 中，您可以使用以下模板：

```
ALTER TABLE {tablename}
ADD 
    {columnname} {datatype} DEFAULT {default_value} 
```

例如，要将`int`默认值 = 1 的数据类型的新列 [Column1] 添加到现有表 [Table1] 中，可以使用以下查询：

```
ALTER TABLE [Table1]
ADD 
    [Column1] INT DEFAULT 1 
```

* * *

## 回答 #42

> 赞同：2
> 
> 时间：2019-12-04T06:19:25.480

ALTER 表 dataset.tablename ADD column_current_ind 整数 DEFAULT 0

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2021-10-26T04:36:00.097

**句法：**

```
ALTER TABLE {TABLENAME} 
ADD {COLUMNNAME} {TYPE} {NULL|NOT NULL} 
CONSTRAINT {CONSTRAINT_NAME} DEFAULT {DEFAULT_VALUE}
WITH VALUES 
```

**例子：**

```
ALTER TABLE Admin_Master 
ADD Can_View_Password  BIT NULL 
CONSTRAINT DF_Admin_Master_Can_View_Password DEFAULT (1)
WITH VALUES 
```

# sql - 从 SQL 语句中的字段中删除前导零

> ID：92093
> 
> 赞同：104
> 
> 时间：2008-09-18T12:31:04.723
> 
> 标签：sql, sql-server, tsql

我正在处理从 SQLServer 数据库读取以生成提取文件的 SQL 查询。从特定字段中删除前导零的要求之一，这是一个简单的`VARCHAR(10)`字段。因此，例如，如果字段包含“00001A”，则 SELECT 语句需要将数据返回为“1A”。

SQL中有没有办法以这种方式轻松删除前导零？我知道有一个`RTRIM`功能，但这似乎只是删除空格。

* * *

## 回答 #1

> 赞同：162
> 
> 时间：2008-09-18T13:07:56.460

```
select substring(ColumnName, patindex('%[^0]%',ColumnName), 10) 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2012-08-15T23:51:09.137

```
select replace(ltrim(replace(ColumnName,'0',' ')),' ','0') 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-17T19:58:23.197

```
select substring(substring('B10000N0Z', patindex('%[0]%','B10000N0Z'), 20), 
    patindex('%[^0]%',substring('B10000N0Z', patindex('%[0]%','B10000N0Z'), 
    20)), 20) 
```

Returns `N0Z`，也就是说，将摆脱前导零和任何出现在它们之前的东西。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-11-13T13:23:55.737

我有同样的需求并使用了这个：

```
select 
    case 
        when left(column,1) = '0' 
        then right(column, (len(column)-1)) 
        else column 
      end 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-04-18T08:49:14.853

你可以使用这个：

```
SELECT REPLACE(LTRIM(REPLACE('000010A', '0', ' ')),' ', '0') 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-12-21T23:25:29.877

如果您希望查询返回 0 而不是一串零或任何其他值，您可以将其转换为 case 语句，如下所示：

```
select CASE
      WHEN ColumnName = substring(ColumnName, patindex('%[^0]%',ColumnName), 10) 
       THEN '0'
      ELSE substring(ColumnName, patindex('%[^0]%',ColumnName), 10) 
      END 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-02-01T06:10:08.927

你可以试试这个 -如果需要，*只*删除前导零需要特别注意：

```
DECLARE @LeadingZeros    VARCHAR(10) ='-000987000'

SET @LeadingZeros =
      CASE WHEN PATINDEX('%-0', @LeadingZeros) = 1   THEN 
           @LeadingZeros
      ELSE 
           CAST(CAST(@LeadingZeros AS INT) AS VARCHAR(10)) 
      END   

SELECT @LeadingZeros 
```

或者你可以简单地打电话

```
CAST(CAST(@LeadingZeros AS INT) AS VARCHAR(10)) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-01-31T06:38:57.880

这是从字符串中删除前导零的 SQL 标量值函数：

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:      Vikas Patel
-- Create date: 01/31/2019
-- Description: Remove leading zeros from string
-- =============================================
CREATE FUNCTION dbo.funRemoveLeadingZeros 
(
    -- Add the parameters for the function here
    @Input varchar(max)
)
RETURNS varchar(max)
AS
BEGIN
    -- Declare the return variable here
    DECLARE @Result varchar(max)

    -- Add the T-SQL statements to compute the return value here
    SET @Result = @Input

    WHILE LEFT(@Result, 1) = '0'
    BEGIN
        SET @Result = SUBSTRING(@Result, 2, LEN(@Result) - 1)
    END

    -- Return the result of the function
    RETURN @Result

END
GO 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-03-05T23:41:07.620

如果您想从大小未知的字符串中删除前导零。

您可以考虑使用 STUFF 命令。

这是它如何工作的示例。

```
SELECT ISNULL(STUFF(ColumnName
                   ,1
                   ,patindex('%[^0]%',ColumnName)-1
                   ,'')
             ,REPLACE(ColumnName,'0','')
             ) 
```

在提琴手中查看它将涵盖的各种场景

[https://dbfiddle.uk/?rdbms=sqlserver_2012&fiddle=14c2dca84aa28f2a7a1fac59c9412d48](https://dbfiddle.uk/?rdbms=sqlserver_2012&fiddle=14c2dca84aa28f2a7a1fac59c9412d48)

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2014-04-08T13:55:21.660

从以下语句中删除前导 0 肯定会起作用。

```
SELECT replace(left(Convert(nvarchar,GETDATE(),101),2),'0','')+RIGHT(Convert(nvarchar,GETDATE(),101),8) 
```

只需替换`GETDATE()`为您的表的日期字段。

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2018-05-17T15:01:50.563

要删除前导 0，您可以将数字列乘以 1 例如：**选择 (ColumnName * 1)**

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2016-02-12T22:17:36.770

我借鉴了上面的想法。这既不快速也不优雅。但它是准确的。

案子

```
WHEN left(column, 3) = '000' THEN right(column, (len(column)-3))

WHEN left(column, 2) = '00' THEN right(a.column, (len(column)-2))

WHEN left(column, 1) = '0' THEN right(a.column, (len(column)-1))

ELSE 
```

结尾

* * *

## 回答 #13

> 赞同：-3
> 
> 时间：2016-11-29T14:14:05.487

```
select CASE
         WHEN TRY_CONVERT(bigint,Mtrl_Nbr) = 0
           THEN ''
           ELSE substring(Mtrl_Nbr, patindex('%[^0]%',Mtrl_Nbr), 18)
       END 
```

* * *

## 回答 #14

> 赞同：-3
> 
> 时间：2018-01-10T01:40:12.997

你可以试试这个 `SELECT REPLACE(columnname,'0','') FROM table`

* * *

## 回答 #15

> 赞同：-5
> 
> 时间：2014-08-20T08:14:49.717

```
select ltrim('000045', '0') from dual;

LTRIM
-----
45 
```

这应该做。

# wpf - 是否可以在 WPF 中的资源字典后面设置代码以进行事件处理？

> ID：92100
> 
> 赞同：154
> 
> 时间：2008-09-18T12:31:43.800
> 
> 标签：wpf

是否可以在 WPF 中的资源字典后面设置代码。例如，在按钮的用户控件中，您在 XAML 中声明它。按钮单击的事件处理代码在控件后面的代码文件中完成。如果我要创建一个带有按钮的数据模板，我该如何为它在资源字典中的按钮单击编写事件处理程序代码。

* * *

## 回答 #1

> 赞同：222
> 
> 时间：2008-09-19T00:45:08.203

我想你要问的是你想要一个 ResourceDictionary 的代码隐藏文件。你完全可以做到这一点！实际上，您可以使用与 Window 相同的方式来执行此操作：

假设您有一个名为 MyResourceDictionary 的 ResourceDictionary。在 MyResourceDictionary.xaml 文件中，将 x:Class 属性放在根元素中，如下所示：

```
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    x:Class="MyCompany.MyProject.MyResourceDictionary"
                    x:ClassModifier="public"> 
```

然后，使用以下声明创建一个名为 MyResourceDictionary.xaml.cs 的代码隐藏文件：

```
namespace MyCompany.MyProject
{
    partial class MyResourceDictionary : ResourceDictionary
    { 
       public MyResourceDictionary()
       {
          InitializeComponent();
       }     
       ... // event handlers ahead..
    }
} 
```

你完成了。你可以在后面的代码中添加任何你想要的东西：方法、属性和事件处理程序。

**== Windows 10 应用更新 ==**

万一你在玩**UWP**，还有一件事需要注意：

```
<Application x:Class="SampleProject.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:rd="using:MyCompany.MyProject">
<!-- no need in x:ClassModifier="public" in the header above -->

    <Application.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>

                <!-- This will NOT work -->
                <!-- <ResourceDictionary Source="/MyResourceDictionary.xaml" />-->

                <!-- Create instance of your custom dictionary instead of the above source reference -->
                <rd:MyResourceDictionary />

            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Application.Resources>

</Application> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-25T23:17:30.060

我不同意“ageektrapped”......使用部分类的方法不是一个好习惯。那么将字典与页面分开的目的是什么？

从代码隐藏中，您可以使用以下命令访问 ax:Name 元素：

```
Button myButton = this.GetTemplateChild("ButtonName") as Button;
if(myButton != null){
   ...
} 
```

如果要在加载自定义控件时连接到控件，可以在 OnApplyTemplate 方法中执行[此操作。](http://msdn.microsoft.com/en-us/library/system.windows.controls.control.gettemplatechild(VS.95).aspx)需要重写 OnApplyTemplate 才能执行此操作。这是一种常见的做法，可以让您的样式与控件保持断开连接。（样式不应该依赖于控件，但控件应该依赖于具有样式）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-11-27T12:33:37.653

Gishu - 虽然这似乎是一种“通常不被鼓励的做法”，但您可能想要这样做的一个原因是：

文本框获得焦点时的标准行为是将插入符号放置在与控件失去焦点时相同的位置。如果您希望在整个应用程序中，当用户选择任何文本框时突出显示文本框的全部内容，那么在资源字典中添加一个简单的处理程序就可以了。

您希望默认用户交互行为与开箱即用行为不同的任何其他原因似乎都是资源字典中隐藏代码的良好候选者。

完全同意任何特定于应用程序功能的东西都不应该在资源字典后面的代码中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-02-25T22:26:01.557

再加上……这些天，随着 {x:Bind ...} 的出现，如果你想把你的 DataTemplate 放到一个共享的 ResourceDictionary 文件中，你需要给那个文件一个代码。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-09-18T12:45:00.540

XAML 用于构建不包含代码的对象图。
数据模板用于指示如何在屏幕上呈现自定义用户对象...（例如，如果它是列表框项）行为不是数据模板专业领域的一部分。重新绘制解决方案...

# mysql - MySQL 慢查询日志——慢有多慢？

> ID：92103
> 
> 赞同：21
> 
> 时间：2008-09-18T12:32:07.950
> 
> 标签：mysql, database, performance

你发现mysql慢查询日志参数的最佳设置是什么，为什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-18T13:43:57.340

我推荐这三行

```
log_slow_queries
设置变量 = long_query_time=1
日志查询不使用索引

```

第一个和第二个将在一秒钟内记录任何查询。正如其他人所指出的那样，如果您想在您的网站上获得高交易率，那么一秒钟的查询已经很遥远了，但我发现它会出现一些真正的 WTF；*应该*很快的查询，但对于运行它的任何数据组合都不是。

最后一个将记录任何不使用索引的查询。除非你做数据仓库，否则任何常见查询都应该有你能找到的最好的索引，所以要注意它的输出。

虽然它肯定不是用于生产，但最后一个选项

```
日志 = /var/log/mysql/mysql.log

```

将记录所有查询，如果您尝试调整特定页面或操作，这可能很有用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T12:36:35.100

无论何时/您/感觉在您的系统上进行查询都慢得令人无法接受。

这取决于您运行的查询类型和系统类型；如果是某个后端报告系统执行复杂的数据挖掘等，而延迟并不重要，那么花费几秒钟的查询可能无关紧要，但在预期会迅速返回结果的面向用户的系统上可能是完全不可接受的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T12:36:47.737

将其设置为您喜欢的任何内容。唯一的问题是，在一个股票 MySQL 中，它只能以 1 秒为增量设置，这对某些人来说太慢了。

最常用的生产服务器执行太多查询以记录所有查询。慢日志是一种过滤日志的方式，这样我们就可以看到需要很长时间的日志（大多数查询可能几乎立即执行）。这是一个有点生硬的乐器。

如果您愿意，可以将其设置为 1 秒，这样您可能不会用完磁盘空间或造成性能问题。

这实际上是关于启用慢速日志的风险——如果您认为它可能会导致进一步的磁盘或性能问题，请不要这样做。

当然，您可以在非生产服务器上启用慢速日志并通过模拟负载，但这绝不是完全相同的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T21:26:55.073

Peter Zaitsev 发表了一篇关于使用慢查询日志的[好文章。](http://www.mysqlperformanceblog.com/2006/09/06/slow-query-log-analyzes-tools/ "慢查询日志分析工具")他指出很重要的一件事是还要考虑使用某个查询的频率。每天运行一次的报告对于快速来说并不重要。但是经常运行的东西即使需要半秒钟也可能是一个问题。如果没有微慢补丁，您将无法检测到这一点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T13:11:34.487

就分辨率而言，它不仅是一种生硬的工具，而且它是 MySQL 实例范围的，因此，如果您有不同的数据库具有不同的性能要求，那么您有点不走运。显然有一些方法可以解决这个问题，但是在设置慢日志设置时记住这一点很重要。

除了应用程序的性能要求之外，另一个要考虑的因素是您要记录的内容。您是否使用日志来捕获会威胁数据库实例稳定性的查询（例如导致死锁或笛卡尔连接的查询）或影响特定用户性能并且可能需要一些调整的查询？这将影响您设置阈值的位置。

# project-management - 在项目接近尾声时，你如何度过不可避免的动机“低谷”？

> ID：92113
> 
> 赞同：7
> 
> 时间：2008-09-18T12:33:04.250
> 
> 标签：project-management

在做一个项目的时候，在有趣的部分被编码之后，我的动力就被严重削弱了。你怎么做才能克服这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T12:37:21.820

不要将所有“无聊”的部分留到最后——确保每个组件都能在项目中尽早使用回归测试和文档。

话虽如此，过去几周仍将涉及追查真正难以捉摸的错误，处理最后一秒的需求更改，完成文档，并通常将这该死的东西排除在外。我的方法就是把它收起来：低下头，知道越早完成，你就能越早开始处理所有优先级较低、更有趣的事情，这些事情已经排在当前版本之后。

除了在发布前安排您的客户全部休假之外，您无法完全避免最后一刻的需求/文档更改。或者让自己像苹果和谷歌一样处于主导地位，这样客户就不会事先知道发布。

您“应该”尽早寻找难以捉摸的错误（我的意思是那些难以重现的错误，以至于您没有一致的测试用例），因为您无法估计修复它们需要多长时间。但实际上，随着项目的进行，其中一部分将变得不那么难以捉摸，或者成为另一个已知问题的副作用，因此您可以通过给他们有限的机会来平均节省时间。这样做的缺点是到最后会剩下一些。但是，如果有两个以上，那么你做错了。

在一个重要的截止日期之后进行短暂的“休息”，做任何你觉得最有趣的事情，从长远来看，这是避免倦怠的好方法。即使你因为跳过了一些困难的计划而最终放弃了大部分，你也会让自己更有效率。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T12:36:23.510

使用测试驱动的开发。一个失败的测试总是一个强大的动力。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T12:37:01.510

让一些测试人员放松一下。没有什么比看到人们使用你有趣的部分并找到明显的改进更能激励你的了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T12:35:33.730

对自己重复一遍：**我的代码在签入之前不存在。**

或者，如果您没有使用版本控制，请选择“直到发布”或“直到发布”。

你也可以用恐惧说，如果你不完成并启动它，其他人会。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T12:36:35.583

通常我会试着告诉自己，**让事情在现实世界**中运行同样有趣，因为在那里你的代码会获得**积分**，或者会因发现的错误和功能请求而得到**改进。**

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T12:39:11.507

不要先做所有有趣的部分。

我鼓励自己做无聊的代码，总是留下一些体面的东西直到最后，并严格首先完成无聊的部分。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T12:40:28.193

“如果你不完成并启动它，其他人会。”

之前告诉自己那个。然而，有时休息几个小时然后再回来是件好事。这样你就不会像以前那样精疲力尽了。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-18T12:52:31.100

我试图推动错误日/晚的概念。设定一个要解决的错误/问题的目标，当你达到这个数字时，每个人都会出去买（付钱的！）比萨饼/啤酒。保持团队士气，并在原本无聊的时期成为焦点。

您还可以在此概念中添加奖品/荣誉，以获得最佳重构或性能改进等

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T12:38:08.560

我同意这很艰难。唯一能让我坚持下去的就是记住我在看到它完成/发货/在客户手中后的感觉。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-18T12:44:04.130

我的动机只是完成它。就像有人说的那样，你只需要蹲下来去做。这都是优先级的问题。优先级越快，你就能越早回到有趣的事情上。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-18T13:30:34.330

1.  试着看看你是否可以短暂休息一两天，然后精神焕发地回来。
2.  不要把无聊的部分留到最后
3.  自己测试一下
4.  确保您的饮食/运动/睡眠/等水平不会降低
5.  告诉其他人你感觉有点沮丧，你能调换一天的工作区域吗？

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-23T17:04:39.087

一般来说，当你完成了 90% 的工作时，它就快结束了，你只需要完成最后的 90% :-)

始终考虑这一点，您会发现它还有很长的路要走。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-05T01:16:39.943

我很高兴做一些创造性的有趣的编程。

但在那之后，我考虑让用户满意。

# c# - 如何在没有 CopyFile 或 CopyFileEx 的情况下在 Windows 上复制大文件？

> ID：92114
> 
> 赞同：10
> 
> 时间：2008-09-18T12:33:05.950
> 
> 标签：c#, windows, file-io

Windows Server 2003 有一个限制，它会阻止您复制非常大的文件，这与您拥有的 RAM 量成正比。限制在于 xcopy、Explorer、Robocopy 和 .NET FileInfo 类使用的 CopyFile 和 CopyFileEx 函数。

这是您得到的错误：

> 无法复制 [文件名]：系统资源不足，无法完成请求的服务。

这是一篇关于该主题的[知识库文章](http://support.microsoft.com/default.aspx/kb/259837)，但它与 NT4 和 2000 相关。

还有一个建议是从 Exchange 安装中[使用 ESEUTIL](http://blogs.technet.com/askperf/archive/2007/05/08/slow-large-file-copy-issues.aspx)，但我没有任何运气让它工作。

有没有人知道一个快速，简单的方法来处理这个？我说的是在具有 2Gb RAM 的机器上 >50Gb。我计划启动 Visual Studio 并为我编写一些东西来完成它，但如果有一些已经存在、稳定且经过良好测试的东西会很好。

**[编辑]**我提供了工作 C# 代码来配合接受的答案。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-18T12:39:26.217

最好的选择是打开原始文件进行读取，打开目标文件进行写入，然后逐块循环复制它。在伪代码中：

```
f1 = open(filename1);
f2 = open(filename2, "w");
while( !f1.eof() ) {
  buffer = f1.read(buffersize);
  err = f2.write(buffer, buffersize);
  if err != NO_ERROR_CODE
    break;
}
f1.close(); f2.close(); 
```

**[由 Asker 编辑]**好的，这就是它在 C# 中的样子（它很慢，但似乎可以正常工作，并且它取得了进展）：

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Text;

namespace LoopCopy
{
    class Program
    {
        static void Main(string[] args)
        {
            if (args.Length != 2)
            {
                Console.WriteLine(
                  "Usage: LoopCopy.exe SourceFile DestFile");
                return;
            }

            string srcName = args[0];
            string destName = args[1];

            FileInfo sourceFile = new FileInfo(srcName);
            if (!sourceFile.Exists)
            {
                Console.WriteLine("Source file {0} does not exist", 
                    srcName);
                return;
            }
            long fileLen = sourceFile.Length;

            FileInfo destFile = new FileInfo(destName);
            if (destFile.Exists)
            {
                Console.WriteLine("Destination file {0} already exists", 
                    destName);
                return;
            }

            int buflen = 1024;
            byte[] buf = new byte[buflen];
            long totalBytesRead = 0;
            double pctDone = 0;
            string msg = "";
            int numReads = 0;
            Console.Write("Progress: ");
            using (FileStream sourceStream = 
              new FileStream(srcName, FileMode.Open))
            {
                using (FileStream destStream = 
                    new FileStream(destName, FileMode.CreateNew))
                {
                    while (true)
                    {
                        numReads++;
                        int bytesRead = sourceStream.Read(buf, 0, buflen);
                        if (bytesRead == 0) break; 
                        destStream.Write(buf, 0, bytesRead);

                        totalBytesRead += bytesRead;
                        if (numReads % 10 == 0)
                        {
                            for (int i = 0; i < msg.Length; i++)
                            {
                                Console.Write("\b \b");
                            }
                            pctDone = (double)
                                ((double)totalBytesRead / (double)fileLen);
                            msg = string.Format("{0}%", 
                                     (int)(pctDone * 100));
                            Console.Write(msg);
                        }

                        if (bytesRead < buflen) break;

                    }
                }
            }

            for (int i = 0; i < msg.Length; i++)
            {
                Console.Write("\b \b");
            }
            Console.WriteLine("100%");
            Console.WriteLine("Done");
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-18T12:41:30.830

如果您想编写代码，可以优化的一种方法是以块的形式发送文件（例如使用[MTOM](http://www.codeproject.com/KB/XML/MTOMWebServices.aspx)）。我使用这种方法将大型文件从数据中心发送到我们的办公室进行打印。

[此外，请检查此处](http://lifehacker.com/software/lifehacker-top-10/top-10-free-windows-file-wranglers-330037.php)提到的 TeraCopy 实用程序..

# apache-flex - 什么是凯恩戈姆“比较器”

> ID：92132
> 
> 赞同：0
> 
> 时间：2008-09-18T12:35:40.140
> 
> 标签：apache-flex, actionscript-3

任何人都可以用易于理解的术语解释这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T13:00:37.303

[这是 Adob​​e 的 5 部分系列](http://www.adobe.com/devnet/flex/articles/cairngorm_pt1.html)- 是否易于理解取决于个人用户的角度！

[这篇文章](http://nyls.blogspot.com/2006/11/flex-cairngormfiltering-data-with.html)还描述了“比较器”，就像一个过滤器。

# delphi - 为什么我的 D2009 exe 会生成带有名为 ATTnnnnn.DAT 附件的电子邮件

> ID：92196
> 
> 赞同：7
> 
> 时间：2008-09-18T12:43:33.740
> 
> 标签：delphi, email, smtp, indy

当在 D2007 中编译的相同源代码生成带有正确命名为原始文件名的附件的电子邮件时，为什么我的 D2009 exe 会生成带有名为 ATTnnnnn.DAT 的附件的电子邮件？

我正在使用 D2007 和 D2009 附带的相应 Indy 库。附件中没有原始文件名会阻止用户双击附件打开它（通常附件是 Excel 电子表格）。

注意：代码是相同的——只是编译器和 Indy 库有所不同。D2009 exe发送的附件可以保存并重命名为zzzz.xls，然后正确打开-即电子邮件和附件正确通过-只是电子邮件附件文件名混乱。

有人建议附件标题已损坏。印地被破坏了吗？要复制的代码是可以在许多网站上找到的标准代码，但如果需要，我可以发布。提前谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-19T10:09:59.623

我发现了问题 - 请参阅 adug.com.au 邮件列表了解解决方案的详细信息，但总的来说 - D2009 附带的 Indy 版本（版本 10.2.5）在 IdMessageClient.pas 中有 2 个错误单元在附件部分处理中设置 name= 和 filename= 的两行（一行是内存中的 1222，另一行是前几行；对不起，我现在在家；我今晚在工作中修好了东西）。缺少这些分号会导致附件标题格式错误，Outlook 会为附件生成自己的名称。

修复方法是在输出 name= 或 filename= 标记之前输出一个分号 ( ; )。然后印地需要重建。

我比较了 Indy (10.1.5) 的 D2007 版本，可以看到它总是将分号放在 Content-Type 行的末尾，从而避免了 D2009 包含的版本中出现的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T13:52:44.223

我建议更新到当前的 Tiburon 快照 ( [http://indy.fulgan.com/ZIP](http://indy.fulgan.com/ZIP) )。Indy 版本现在是 10.5.7。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T13:42:09.873

恐怕您可能只需要追溯到 indy 代码。Indy 过去有很多错误，所以这可能是原因。如果您跟踪，您应该很快就会找到它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T13:45:31.610

是否设置了 IdAttachment.Filename 属性？有可能在 Indy 版本之间他们改变了 Filename 的工作方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-11T22:11:25.003

理查德的建议对我有用。我比较了正确附件的消息来源和 Indy 的消息来源。将分号放在 Content-type 和 Content-disposition 后面（确实在第 1220 行左右，它可以工作。谢谢理查德！

# design-patterns - 设计模式及其用途的最佳资源是什么？

> ID：92225
> 
> 赞同：1
> 
> 时间：2008-09-18T12:50:01.247
> 
> 标签：design-patterns, resources

说到设计模式的使用，我猜有三种类型的商店。那些如果打在脸上就不会知道模式的人 - 这些人通常更喜欢 Ctrl-C / Ctrl-V 方法来重用代码。那些每天花费数小时搜索遗留代码以希望实现一种更好的模式的人——这些人通常花费更多时间重构简单程序的代码，而不是花费一百年的维护时间。最后，那些走中间道路的人会在有意义的情况下使用模式，并为最少暴露的代码编写任何首先出现的代码。

我想知道是否有人锁定了一种在软件开发生命周期中平衡结合模式使用的好方法。此外，关于模式、它们的激励因素以及它们的正确使用，Web 上的最佳资源是什么？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T12:58:15.873

那里有很多不同的“模式”系列，但是以最广泛的术语来回答你的问题......

我建议：

*   Jim Coplien 的[组织模式](http://users.rcn.com/jcoplien/Patterns/Top10OrgPatterns.html)
*   山坡集团[维基](http://www.hillside.net/)
*   Kevlin Henney 的[网站](http://curbralan.com/)有很多优秀的链接和论文

离线（我的最爱）：

*   福勒的[企业架构模式](http://martinfowler.com/books.html)
*   Feather[与遗留代码的有效合作](https://rads.stackoverflow.com/amzn/click/com/0131177052)

离线（流行）：

*   GoF 设计模式
*   Fowler 的重构：改进现有代码的设计

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T12:57:28.857

[http://www.dofactory.com/Patterns/Patterns.aspx](http://www.dofactory.com/Patterns/Patterns.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T13:01:26.023

模式的良好使用取决于知识和经验；它没有公式。一件好事是让一个在明智地应用模式方面经验丰富的人定期审查团队中其他人的代码，以确保他们没有过度使用或未充分使用设计模式。它们不是预先准备好的食谱——它们需要技巧才能有效地应用，而且必须学习。

我对设计模式的第一次也是最好的接触是[Portland Pattern Repository](http://c2.com/cgi/wiki?WelcomeVisitors)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T13:07:26.587

“模式”的使用在很大程度上取决于

1.  使用的语言
2.  一个喜欢实现的目标。

设计模式可以在 C++、Java 等语言中被高估。它们隐藏了各种打字问题带来的不灵活。以下是关于以较少限制的语言“生存”的模式的链接：http: [//norvig.com/design-patterns/](http://norvig.com/design-patterns/)

另一个例子是面向方面的编程，其中可能会努力以一种不是为它“设计”的语言“引入”事物。

所用工具背后的理念也有很大的影响。只需比较 Smalltalk、Common Lisp、Haskell 等中的普通 PHP 或 Visual Basic 程序和解决方案。

语法元素也有很大的影响。您会在 C、C++（迭代器）中看到大量类似的循环，但如果您研究支持高阶函数的语言，您只会发现一些循环。

然后，您必须查看人们访问编程的方式，自下而上或自上而下，零碎增长或建立金字塔，或任何其他个人偏好

我建议阅读提到的链接，然后检查“不同”语言的实现......

问候弗里德里希

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T12:56:10.980

我想我不得不推荐**Refactoring: Improvement the Design of Existing Code**。

[![重构：改进现有代码的设计](https://i.stack.imgur.com/CaLlH.jpg)](https://i.stack.imgur.com/CaLlH.jpg)
[（来源：[2020ok.com](http://2020ok.com/img/1/41191.jpg)）]

大量示例说明如何合理使用模式。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T12:56:45.287

我认为最好的网络资源包含有关模式和重构的信息 - [http://sourcemaking.com](http://sourcemaking.com)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T13:02:23.243

每个人都一直在使用模式。他们只是可能不知道。即使是像“遍历列表”这样简单的事情也是一种模式。

我认为将模式纳入工作周期的最佳方式就是使用它们，并在讨论它们和评论代码时按名称引用它们。希望这将导致知识的传播。

因此，举例来说，您发现您的工作非常适合 Observer。你对你的同事说“嘿，如果我们让这个对象成为观察者，这个对象是它的主题，这将很容易做到。”

要么你的同事马上就会明白——这种模式可以节省你的时间——或者你可以教育他们，*下次*你提到 Observer 时，他们就会马上明白。

同时，你在传播知识，他们会发现机会使用他们从你那里学到的新模式。这当然是双向的。下次可能是*他们*教*你*一种新模式。

所有这一切都依赖于你的同事不是那种点头并假装不理解某事的类型。你确实需要他们说“嘿，你提到了观察者，我想我不知道那是什么。”

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-18T13:05:02.300

我是这个系列的忠实粉丝，并且读过他们的很多书，所以我推荐[Head First Design Patterns](http://oreilly.com/catalog/9780596007126/)。您可以通过 O'Reilly 的[Safari Bookshelf](http://safari.oreilly.com/)在线阅读它，但硬拷贝也带有精美的图案海报。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-18T13:09:42.057

我完全同意上面的评论。我尽可能使用设计模式，但始终依赖团队的其他成员来真正理解特定模式的好处。否则你最终会得到丑陋的代码和一个有点类似于模式的轻量级包装器。

顺便说一句， [http://www.developer.com](http://www.developer.com)每月有几篇关于设计模式及其应用的文章。祝你好运！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-18T12:57:24.580

定义和原始答案是[设计模式](https://rads.stackoverflow.com/amzn/click/com/0201633612)中概念的起源。这本书在非常理论的层面上讨论了这个概念，而不是渗透到该领域的管理语言。他们认为设计模式只是常见习语的名称。他们列举了一些并证明了他们的立场。

他们避免“我应该使用什么设计模式”类型的问题，而是将问题处理为“我是否自然地进入了一个众所周知的领域？如果是这样，其他人的经验可以帮助我吗？”。对我来说，设计模式不像预制组件，您可以将它们粘合在一起以形成解决方案。它们只是当您遇到与其他人反驳的情况类似的情况时的指导存储库，并给出名称以允许人们在对话中参考一般情况。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-18T13:03:31.807

设计模式很有趣，因为只有当你完全理解了适用的模式时，你才知道在哪里使用模式。诸如 Strategy、Observer、Iterator 之类的东西，经过一点练习，您就可以不用费力地使用它。如果你在 C# 中，你会一直使用迭代器（IEnumerable...），而不会将其视为一种模式。

在我看来，这些简单的模式是最好的模式。你已经有工作要做了，当它*不太*适合时，试图将你的问题硬塞到一个又一个模式中是浪费你的时间，并导致糟糕的代码。

我的建议是查看一个模式的 uml 图，如果它相当简单，那么试着学得足够好，以便以后回忆起来。具有更简单合约的模式可能更有用。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-18T13:06:13.547

我会自己去看《四人帮的设计模式》这本书

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-18T13:06:56.977

我同意这些参考资料，但对新手不友好。快速开始学习设计模式的简单方法：

[Head First：设计模式](https://rads.stackoverflow.com/amzn/click/com/0596007124)

然后，您可以在了解全局后查看更高级的书籍（很多实际示例；-)）

# python - Python，超越基础

> ID：92230
> 
> 赞同：14
> 
> 时间：2008-09-18T12:51:07.733
> 
> 标签：python

我已经掌握了 Python 的基础知识，并且有一个小假期，我想利用其中的一些时间来学习更多 Python。问题是我不知道该学什么或从哪里开始。我主要从事网络开发，但在这种情况下，我不知道它会产生多大的影响。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-18T13:01:53.463

好吧，高级 Python 编程有很多资源：

*   潜入 Python（[免费阅读](http://www.diveintopython.net/)）
*   在线 python 食谱（例如[这里](http://code.activestate.com/recipes/langs/python/)和[那里](http://the.taoofmac.com/space/Python/Grimoire)）
*   O'Reilly 的 Python 食谱（见亚马逊）
*   一个有趣的谜语游戏：[Python Challenge](http://www.pythonchallenge.com/)

如果您想在简历上写“Python”，以下是您必须掌握的科目列表：

*   [列表推导](http://docs.python.org/tutorial/datastructures.html#list-comprehensions)
*   [迭代器和生成器](https://stackoverflow.com/questions/231767/the-python-yield-keyword-explained/231855#231855)
*   [装饰师](https://stackoverflow.com/questions/739654/understanding-python-decorators/1594484#1594484)

它们使 Python 成为如此酷的语言（当然还有标准库，我每天都在发现）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-18T12:58:50.740

根据您所说的“掌握基础知识”的确切含义，我建议您通读[Dive Into Python](http://www.diveintopython.net/)并键入/执行所有章节代码，然后获得像[Programming Collective Intelligence](http://www.amazon.co.uk/Programming-Collective-Intelligence-Building-Applications/dp/0596529325/)之类的东西并完成它 - 你会学到python 非常好，更不用说一些非常优秀的算法，它们对 Web 开发人员来说会派上用场。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T12:56:33.337

[The Python Challenge](http://pythonchallenge.com)是一个很好玩的东西，虽然不是一个项目。我发现它在提高我的 Python 技能方面非常有用，同时它可以让你的大脑得到很好的锻炼。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T12:57:32.897

我真的很喜欢[Programming Python 这本书。](https://rads.stackoverflow.com/amzn/click/com/0596009259)它有各种各样的小项目，其中大部分可以在一个晚上悠闲地完成。它们使您熟悉大多数标准库，并且可能会引起您的兴趣。最重要的是，这些小项目实际上在“日常”意义上是有用的。这本书几乎只假设您了解并理解 Python 作为一门语言的基本要素，而不是了解它庞大的 API 库。

我想你会发现它非常值得努力。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T13:23:41.103

我将[在 Python 中插入 Building Skills](http://homepage.mac.com/s_lott/books/python.html)。另外，如果您想要更具挑战性的东西，[OO 设计中的构建技能](http://homepage.mac.com/s_lott/books/oodesign.html)是一个相当大且复杂的系列练习。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-18T13:49:59.777

*如果您想掌握惯用*的 Python，Python Cookbook绝对是必不可少的。*此外，那本书让我爱上了这门语言。*

 ** * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T12:54:38.753

我建议使用 Django 或 Pylons 编写一个重要的 web 应用程序，这会进行一些数字运算。没有比让自己解决问题并边走边学更好的方法来学习一门新语言！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-18T13:10:07.577

编写一个 Web 应用程序，可能使用[Django](http://www.djangoproject.com/) -[文档](http://docs.djangoproject.com/)会教你很多好的 Python 风格。

使用一些流行的库，如[Pygments](http://pygments.org/)或[Universal Feed Parser](http://www.feedparser.org/)。这两种方法都提供了非常有用的功能，这些功能很难在一个有据可查的 API 中使用。

一般来说，我会远离那些没有很好记录的库——如果你没有任何 C经验。我还在学习 Python 时编写了 wxPython 代码，Python 是我的第一门语言，当时它只是 wxWidgets 的一个包装器。那段代码很容易成为我写过的最丑陋的代码。

我没有从 Dive Into Python 中得到太多，除了动态导入章节——其他地方并没有很好地记录。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-18T13:20:21.797

人们倾向于说“最好的学习方式是通过实践”这样的话，但我一直发现，除非你专门学习一门语言来为某个项目做出贡献，否则很难真正找到要解决的小问题来保持自己去。

一个很好的解决方案是[Project Euler](http://projecteuler.net/)，它列出了从简单到相当费脑筋的各种编程\数学挑战。例如，第一个挑战是：

> 如果我们列出所有小于 10 且是 3 或 5 的倍数的自然数，我们会得到 3、5、6 和 9。这些倍数之和是 23。

到了第 50 题，它已经变得更难了

> 一百万以下的哪个素数可以写成最连续素数之和

总共有 208 个，但我认为这里和那里都会添加一些新的。

虽然在开始 Project Euler 之前我已经相当了解 Python，但我发现我完全通过使用该语言学到了一些很酷的技巧。祝你好运！

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-08T01:31:46.893

在 Google 视频上搜索“Alex Martelli”、“Alex Martelli patterns”和“Thomas Wouters”。有很多关于高级 Python、Python 中的设计模式等的有趣演讲。

# html - CSS 可以真正覆盖页面上 HTML 元素的顺序吗？

> ID：92239
> 
> 赞同：23
> 
> 时间：2008-09-18T12:52:18.510
> 
> 标签：html, css

如果页面上有多个s，则可以使用 CSS 调整大小、浮动它们并稍微移动它们……但我看不出有什么方法可以克服第一个将显示在顶部附近的`div`事实`div`页面和最后一个`div`将在底部附近！我不能完全覆盖元素的顺序，因为它们来自源 HTML，可以吗？

我一定是遗漏了一些东西，因为人们说“我们可以通过编辑一个 CSS 文件来改变整个网站的外观。”，但这取决于你仍然希望`div`s 的顺序相同！

（PS 我确信没有人`position:absolute`在页面上的每个元素上使用。）

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-09-18T12:57:05.813

CSS 可以将元素*从正常流程中取出，*并以您想要的任何方式将它们放置在任何地方。但它不能*创建新的流程*。

我的意思是您可以将 html 文档中的最后一项放置在页面/窗口的开头/顶部，并且您可以将 html 文档中的第一项放置在页面/窗口的末尾/底部。但是当你这样做时，你不能相对于彼此定位这些项目；您必须自己知道要正确定位 html 文档中的第一个项目，页面末尾将有多远。如果该内容是动态的（即：来自数据库或 CMS），那么这绝非易事。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-18T13:07:06.977

使用浮动和绝对位置，您可以使用一些非常好的定位魔法来更改页面的某些顺序。

例如，使用 StackOverflow，如果标记设置正确，标题和主体内容可能是标记中的前 2 个内容，然后是导航/搜索，最后是右侧边栏。这可以通过一个内容容器来完成，该容器的上边距足以容纳导航，右边距足够大以容纳侧边栏。然后两者都可以绝对定位。标记可能如下所示：

```
h1 {
  position: absolute;
  top: 0;
  left: 0;
}

#content {
  margin-top: 100px;
  margin-right: 250px;
}

#nav {
  position: absolute;
  top: 0;
  left: 300px;
}

#side {
  position: absolute;
  right: 0;
  top: 100px;
}
```

```
<h1> Stack Overflow </h1>
<div id="content">
  <h2> Can Css truly blah blah? </h2>
  ...
</div>
<div id="nav">
  <ul class="main">
    <li>quiestions</li> ... </ul>
  ....
</div>
<div id="side">
  <div class="box">
    <h3> Sponsored By </h3>
    <h4> New Zelands fish market </h4>
    ....
  </div>
</div>
```

这里重要的是标记必须考虑到这种定位魔法。

更改内容以使导航栏位于左侧，而导航下方的侧边栏太难了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T12:57:50.167

您可能想查看[CSS Zen Garden](http://www.csszengarden.com/)以获得如何做您想做的事的优秀示例。大量的示例布局通过右侧的链接查看使用严格的 CSS 移动所有内容的各种方式。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-10T22:16:24.153

今天有几种方法可以做到这一点。第一个适用于更多浏览器，但受到更多限制：

1.  使用 的 CSS 显示值`table-caption`，`table-row`并`table-cell`允许最多三个由 CSS 专门控制的元素进行垂直排序。

2.  这是较新的，仅适用于所有最新的浏览器（是的，它在 IE9 中会失败）：使用 flexbox CSS 属性。

[您可以在“这是响应式](http://bradfrost.github.com/this-is-responsive/patterns.html)”模式页面查看实时示例并阅读有关这些技术的更多信息。我正在谈论的两个在标题为“Source-Order Shift”的部分中

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T12:56:01.043

你不需要 position:absolute 在每个元素上做你想做的事。

您只需在几个关键项目上使用它，然后您可以将它们放置在您想要的任何位置，将包含在其中的所有项目与该部分的根元素一起移动。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T13:01:30.127

我认为最重要的因素是以语义上有意义的方式放置您的 html 元素，幸运的是，您在 CSS 中的布局不必做太多工作。例如，您网站的页眉可能是页面上的第一个元素，然后是普通导航，然后是子导航、内容和页脚（不完整列表）。

大约 90-95% 的您想要使用的布局应该相对容易将标记操作成您所追求的东西。其他 5-10% 仍然是可能的，但需要更多的努力，但您需要问自己的问题是“我希望网站标题多久位于页面的右下角？”

我一直发现，如果您确实想显着改变外观和感觉，至少与从头开始的重新编码相比，网站的布局并不是很难在事后进行操作。

</2c>

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T13:11:33.847

您可以使用 position:absolute 完全独立于源顺序来定位单个框。因此，您可以使用 CSS 将页眉移动到页面底部，将页脚移动到顶部。

但是请注意，这通常不利于可访问性：您应该使源中内容的顺序或多或少与您向读者呈现的顺序相同。原因是屏幕阅读器或类似设备将按照源中定义的顺序而不是 CSS 定义的视觉顺序呈现内容。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T13:05:41.940

关于页眉总是在前，页脚在后的好点！但我可能想将我的广告 DIV 从顶部移到右侧。

我听说的另一件事是将内容 DIV 放在首位，因此 Google 会更加关注您（页面顶部附近的相关关键字得分更高）......或者这是一个神话？这样做也需要我正在询问的那种 CSS 技巧。

# svn - 为什么 mvn release:prepare 在标记时失败？

> ID：92258
> 
> 赞同：5
> 
> 时间：2008-09-18T12:55:16.553
> 
> 标签：svn, maven-2, release, maven-scm

使用我的多项目 pom 时，我在运行 release:prepare 时遇到错误。项目设置没有什么花哨的，之前的每个发布步骤都运行良好。我得到的错误是：

```
    [信息] --------------------------------------------- -------------------------
    [错误] 构建失败
    [信息] --------------------------------------------- -------------------------
    [INFO] 无法标记 SCM
    提供者消息：
    svn tag 命令失败。
    命令输出：
    svn：提交失败（详情如下）：
    svn：文件'/repos/june/tags/foo-1.0.2/foo.bar.org/pom.xml'已经存在

```

知道它来自哪里以及如何解决它吗？

（很抱歉重复的帖子 - 第一次被关闭是因为我没有将其表述为可以回答的问题。我希望现在可以了。）

**编辑**
Maven 发布插件负责版本处理本身。因此，当我检查 subversion 存储库中的路径时，路径还不存在。

**编辑 2**
@Ben：我不知道服务器版本，但是客户端也是 1.5.2。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-15T10:22:44.367

[最新版本的maven-release-plugin](http://maven.apache.org/plugins/maven-release-plugin/)解决了这个问题。将此添加到您的 POM 以将其拉入。

```
<build>
  <pluginManagement>
    <plugins>
      <plugin>
        <artifactId>maven-release-plugin</artifactId>
        <version>2.0-beta-9</version>
      </plugin>
    </plugins>
  </pluginManagement>
</build> 
```

已修复的问题是[MRELEASE-375](http://jira.codehaus.org/browse/MRELEASE-375)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T13:04:40.400

这是因为您没有增加版本号 - 1.0.2 已经存在于您的 Subversion 存储库中。

要么增加你的版本，要么只是从你的 repo 中删除 /repos/june/tags/foo-1.0.2 标签。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-03T22:54:24.330

Roland，如果您还没有看过这个，请看一下 John Smart 关于这个问题的博客文章。虽然他提出的脚本不优雅，但它解决了问题：

[http://weblogs.java.net/blog/johnsmart/archive/2008/12/subversion_mave.html](http://weblogs.java.net/blog/johnsmart/archive/2008/12/subversion_mave.html)

另一种解决方案是使用 Git。（我 == 目前正在写关于 Maven 和 Git 的文章）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T16:54:18.303

可能有用的链接：

[http://weblogs.java.net/blog/johnsmart/archive/2008/12/subversion_mave.html](http://weblogs.java.net/blog/johnsmart/archive/2008/12/subversion_mave.html)（前面提到过）

[http://jira.codehaus.org/browse/MRELEASE-427](http://jira.codehaus.org/browse/MRELEASE-427)（真正的错误？）

[http://jira.codehaus.org/browse/SCM-406](http://jira.codehaus.org/browse/SCM-406)（相关错误）

[http://olafsblog.sysbsb.de/?p=73](http://olafsblog.sysbsb.de/?p=73)（更新的也许更有帮助的帖子）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T13:03:20.777

据我所知，这是 Subversion 1.5 中的一个错误，与 maven 没有直接关系。然而，为我修复它的解决方法是更新本地 svn 存储库并再次运行 release:prepare 目标。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-30T14:12:28.450

我花了很长时间与这个作斗争。在 SVN 1.5.1+ 中有些不同之处，它破坏了直接从工作副本提交到标签 - 这正是 Maven 所做的。关于谁负责解决问题，仍然存在很多指责。

您可以执行“svn update”并重新运行发布命令，但如果您正在执行发布：分支，这将导致发布插件不会将您的 POM 文件返回到之前的状态。

我所知道的最好的解决方法是退回到 Subversion 1.5.0。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-19T02:07:57.593

这已在最新版本的插件版本 2.0-beta-9 中得到[修复](http://jira.codehaus.org/browse/MRELEASE-427)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-10-15T11:17:46.697

当我在没有安装 svn 的服务器上遇到构建问题时，我点击了这篇文章。

这有帮助： [Jenkins with Subversion](https://stackoverflow.com/questions/16897288/jenkins-with-subversion)

# winforms - 如何以通用方式启用/禁用剪切/复制/粘贴菜单和工具栏项？

> ID：92262
> 
> 赞同：7
> 
> 时间：2008-09-18T12:55:43.133
> 
> 标签：winforms

我有一个带有文本框、组合框、datagridview 等控件的 Windows 窗体应用程序。这些控件允许用户使用剪贴板，即剪切/复制和粘贴文本。也可以删除文本（与剪贴板无关）。

我的应用程序有一个菜单栏，其中包含一个包含剪切/复制/粘贴/删除项目的编辑项目，以及一个包含这些项目的工具栏。如何根据具有焦点的控件的状态正确启用/禁用这些项目？

我正在寻找一种通用的方式，即我寻找一种我曾经做过的实现，并且可以在将来独立于我的应用程序将使用的控件重用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T13:08:41.793

没有用于从 Windows 窗体控件获取剪切/复制/粘贴信息的通用接口或方法集。

我建议您最好的方法是为每种类型的控件创建一个包装类。然后，当您想要更新菜单状态时，您将获得当前控件的焦点并为其创建适当的包装器。然后您向该包装器询问您需要的状态信息。这样，您只需为您使用的每种类型的控件创建一个包装器实现。开始有点痛苦，但其他时候你只需要添加你遇到的新控件。

剪贴板信息要容易得多，因为您可以询问剪贴板单例是否有数据以及它是什么类型。然后，您仍然需要询问目标控件是否可以接受该类型的信息，因此仍然需要做额外的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T13:06:02.283

为每个启用/禁用组创建一个阵列。将控件添加到数组中（当然它必须是正确的类型，例如 Object 或 Any 等，具体取决于您使用的编程语言）。然后启用，禁用只需循环遍历数组并为每个控件调用启用/禁用方法或函数。同样，根据您可能需要回退的语言。

# c# - 从 C# 客户端向 Java 服务器发送一个 4 字节的消息头

> ID：92287
> 
> 赞同：7
> 
> 时间：2008-09-18T12:57:30.680
> 
> 标签：c#, java, sockets

我正在尝试将 C# 客户端写入用 Java 编写的服务器。服务器需要一个 4 字节（Java 中的 DataInputStread readInt()）消息头，后跟实际消息。

我对 C# 完全陌生，如何将此消息头发送到 Java 服务器？我尝试了几种方法（主要是在没有深入了解 C# 语言的情况下反复试验），但没有任何效果。Java 端的消息长度不正确（非常大）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-18T14:22:41.053

正如其他海报所指出的那样，它是字节序。

Java [DataInputStream](http://java.sun.com/j2se/1.4.2/docs/api/java/io/DataInputStream.html)期望数据是[大端](http://en.wikipedia.org/wiki/Endianness)（网络字节顺序）。从 Mono 文档（对于[BinaryWriter 等等价](http://www.go-mono.com/docs/monodoc.ashx?link=T%3aSystem.IO.BinaryWriter)物）来看，C# 倾向于小端（Win32/x86 的默认设置）。

因此，当您使用标准类库将 32 位 int '1' 更改为字节时，它们会产生不同的结果：

```
//byte hex values
Java: 00 00 00 01
  C#: 01 00 00 00 
```

您可以更改在 C# 中编写 int 的方式：

```
private static void WriteInt(Stream stream, int n) {
    for(int i=3; i>=0; i--)
    {
        int shift = i * 8; //bits to shift
        byte b = (byte) (n >> shift);
        stream.WriteByte(b);
    }
} 
```

编辑：

一种更安全的方法是：

```
private static void WriteToNetwork(System.IO.BinaryWriter stream, int n) {
    n = System.Net.IPAddress.HostToNetworkOrder(n);
    stream.Write(n);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T14:32:24.417

As everyone here has already pointed out, the issue is most likely caused by the C# application sending ints in little-endian order whereas the Java app expects them in network order (big-endian). However, instead of explicitly rearranging bytes in the C# app, the correct way is to rely on built-in functions for converting from host to network order (htons and the likes) -- this way your code will continue working just fine even when run on a big-endian machine.

In general, when troubleshooting such issues, I find it useful to record the correct traffic (e.g., Java to Java in your case) using tools like netcat or wireshark, and then compare it to the incorrect traffic to see where it's going wrong. As an added benefit, you can also use netcat to inject the captured/prerecorded requests into the server or inject captured/prerecorded responses into the client. Not to mention that you can also modify the requests/responses in a file and test the results before commencing with fixing the code.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T13:01:15.757

这很简单，但你检查过字节序吗？您发送数据的字节序与您接收的字节序很容易不匹配。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T13:12:37.290

如果您要交换大量数据，我建议您实现（或找到）一个可以按网络顺序写入和读取整数的 Stream-wrapper。但是，如果您真的只需要编写长度，请执行以下操作：

```
using(Socket socket = ...){
  NetworkStream ns = new NetworkStream(socket);      
  ns.WriteByte((size>>24) & 0xFF);
  ns.WriteByte((size>>16) & 0xFF);
  ns.WriteByte((size>>8)  & 0xFF);
  ns.WriteByte( size      & 0xFF);
  // write the actual message
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T13:09:31.900

我不知道 C#，但你只需要这样做：

```
out.write((len >>> 24) & 0xFF);
out.write((len >>> 16) & 0xFF);
out.write((len >>>  8) & 0xFF);
out.write((len >>>  0) & 0xFF); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T14:48:09.200

Sysetm.Net.IPAddress 类有两个静态帮助器方法：HostToNetworkOrder() 和 NetworkToHostOrder() 为您进行转换。您可以将它与流上的 BinaryWriter 一起使用以写入正确的值：

```
using (Socket socket = new Socket())
using (NetworkStream stream = new NetworkStream(socket))
using (BinaryWriter writer = new BinaryWriter(stream))
{
    int myValue = 42;
    writer.Write(IPAddress.HostToNetworkOrder(myValue));
} 
```

# visual-studio - 如何使visualstudio .net 与VB6 和Service Pack 6 一起工作

> ID：92290
> 
> 赞同：1
> 
> 时间：2008-09-18T12:57:48.340
> 
> 标签：visual-studio

我有需要运行可视化服务包 6 的 VB 应用程序，现在当我安装 visualstudio.net（任何版本的 .net）时，它的调试器无法正常工作，我可以在 visualstudio.net 中创建 Windows/Web 应用程序但不能能够调试任何东西，所以我必须保留两台计算机，一台用于 VB，一台用于 .net，有人知道这是什么原因吗？有什么解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-18T12:59:51.893

我在同一个系统上使用了 Visual Studio 6 和 Visual Studio 2005，所以我知道你可以设置它以便两个调试器都工作。但是，当我这样做时，设置就可以正常工作，所以我不能告诉你我做了什么让它工作，除了 VS2005 首先在机器上。

# silverlight - Silverlight 与 DataSet Web 服务的交互

> ID：92323
> 
> 赞同：1
> 
> 时间：2008-09-18T13:02:14.740
> 
> 标签：silverlight

我的同事发现自己处于一个“有趣”的境地。他正在开发一个 Silverlight (2.0) 原型，该原型需要调用企业中现有的 Web 服务并将返回的数据绑定到数据显示控件。问题是，Web 服务返回 .NET 数据集（它们不会更改现有实现），而 Silverlight 本身并不支持数据集。

一个好的解决方法是什么？我在想一个适配器模式，但不知道中间人 Web 服务进行转换是否是一个很好的主意。如果有许多现有的 Web 服务，可能会很乏味。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T13:22:44.740

AFAIK，当 .NET Web 服务返回 DataSet 时，它会返回其 XML 表示形式（这非常友好）。.NET 客户端可以直接使用 DataSet 的事实只是抽象了发生 Xml 序列化-反序列化的事实。

所以我会手动查询您需要的 Web 服务，观察生成的 XML，然后在客户端对其进行解析。

另一种可能性是利用 Web 服务使用标准 XML 序列化器这一事实，因此您可以从返回的架构创建 C# 类，然后让 XmlSerializer 自动处理它。我不确定 XSD.exe 工具生成的代码是否对 Silverlight 友好，但值得一试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-12T18:32:08.283

尝试以下操作：[http ://silverlightdataset.net](http://silverlightdataset.net)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T13:06:10.613

数据集的危险和普遍的讨厌。我将使用一个通用代理来负责使用 web 方法并将数据集转换为 xml/json

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-06T19:07:27.593

是的，[silverlight ds](http://www.silverlightds.com)是一个很好的解决方案，他们甚至内置了关系

# wpf - 如何访问 WPF ListView 的 ListViewItems？

> ID：92328
> 
> 赞同：16
> 
> 时间：2008-09-18T13:02:56.987
> 
> 标签：wpf, listview, internals

在一个事件中，我想将焦点放在 ListViewItem 模板中的特定文本框上。XAML 如下所示：

```
<ListView x:Name="myList" ItemsSource="{Binding SomeList}">
    <ListView.View>
        <GridView>
            <GridViewColumn>
                <GridViewColumn.CellTemplate>
                    <DataTemplate>
                        <!-- Focus this! -->
                        <TextBox x:Name="myBox"/> 
```

我在后面的代码中尝试了以下内容：

```
(myList.FindName("myBox") as TextBox).Focus(); 
```

但我似乎误解了`FindName()`文档，因为它返回`null`.

也`ListView.Items`没有帮助，因为（当然）包含我绑定的业务对象并且没有 ListViewItems。

也没有`myList.ItemContainerGenerator.ContainerFromItem(item)`，它也返回 null。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-02T09:02:33.323

要了解为什么`ContainerFromItem`对我不起作用，这里有一些背景。我需要此功能的事件处理程序如下所示：

```
var item = new SomeListItem();
SomeList.Add(item);
ListViewItem = SomeList.ItemContainerGenerator.ContainerFromItem(item); // returns null 
```

之后不会立即创建容器，因为事件可以`Add()`在非 UI 线程上处理。相反，它会启动异步调用并等待 UI 线程回调并执行实际的 ListViewItem 控件生成。`ItemContainerGenerator``CollectionChanged`

为了在发生这种情况时得到通知，`ItemContainerGenerator`公开了一个`StatusChanged`在所有容器生成后触发的事件。

现在我必须听这个事件并决定控件当前是否想要设置焦点。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-09-18T13:57:59.960

正如其他人所指出的，通过在 ListView 上调用 FindName 无法找到 myBox TextBox。但是，您可以获取当前选中的 ListViewItem，并使用 VisualTreeHelper 类从 ListViewItem 中获取 TextBox。这样做看起来像这样：

```
private void myList_SelectionChanged(object sender, SelectionChangedEventArgs e)
{
    if (myList.SelectedItem != null)
    {
        object o = myList.SelectedItem;
        ListViewItem lvi = (ListViewItem)myList.ItemContainerGenerator.ContainerFromItem(o);
        TextBox tb = FindByName("myBox", lvi) as TextBox;

        if (tb != null)
            tb.Dispatcher.BeginInvoke(new Func<bool>(tb.Focus));
    }
}

private FrameworkElement FindByName(string name, FrameworkElement root)
{
    Stack<FrameworkElement> tree = new Stack<FrameworkElement>();
    tree.Push(root);

    while (tree.Count > 0)
    {
        FrameworkElement current = tree.Pop();
        if (current.Name == name)
            return current;

        int count = VisualTreeHelper.GetChildrenCount(current);
        for (int i = 0; i < count; ++i)
        {
            DependencyObject child = VisualTreeHelper.GetChild(current, i);
            if (child is FrameworkElement)
                tree.Push((FrameworkElement)child);
        }
    }

    return null;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-25T17:09:34.157

我注意到问题标题与问题的内容没有直接关系，接受的答案也没有回答它。我已经能够通过使用以下方法“访问 WPF ListView 的 ListViewItems”：

```
public static IEnumerable<ListViewItem> GetListViewItemsFromList(ListView lv)
{
    return FindChildrenOfType<ListViewItem>(lv);
}

public static IEnumerable<T> FindChildrenOfType<T>(this DependencyObject ob)
    where T : class
{
    foreach (var child in GetChildren(ob))
    {
        T castedChild = child as T;
        if (castedChild != null)
        {
            yield return castedChild;
        }
        else
        {
            foreach (var internalChild in FindChildrenOfType<T>(child))
            {
                yield return internalChild;
            }
        }
    }
}

public static IEnumerable<DependencyObject> GetChildren(this DependencyObject ob)
{
    int childCount = VisualTreeHelper.GetChildrenCount(ob);

    for (int i = 0; i < childCount; i++)
    {
        yield return VisualTreeHelper.GetChild(ob, i);
    }
} 
```

我不确定递归有多忙，但在我的情况下它似乎工作正常。不，我以前没有`yield return`在递归上下文中使用过。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-02T22:31:34.947

您可以向上遍历 ViewTree 以查找与从命中测试触发的单元格对应的项目“ *ListViewItem ”记录集。*

同样，您可以从父视图中获取列标题来比较和匹配单元格的列。您可能希望将单元格名称绑定到列标题名称作为比较器委托/过滤器的键。

例如：HitResult 位于 TextBlock 上，以绿色显示。您希望获得“ *ListViewItem* ”的句柄。

[![在此处输入图像描述](https://i.stack.imgur.com/8p78C.jpg)](https://i.stack.imgur.com/8p78C.jpg)

```
/// <summary>
///   ListView1_MouseMove
/// </summary>
/// <param name="sender"></param>
/// <param name="e"></param>
private void ListView1_MouseMove(object sender, System.Windows.Input.MouseEventArgs e) {
  if (ListView1.Items.Count <= 0)
    return;

  // Retrieve the coordinate of the mouse position.
  var pt = e.GetPosition((UIElement) sender);

  // Callback to return the result of the hit test.
  HitTestResultCallback myHitTestResult = result => {
    var obj = result.VisualHit;

    // Add additional DependancyObject types to ignore triggered by the cell's parent object container contexts here.
    //-----------
    if (obj is Border)
      return HitTestResultBehavior.Stop;
    //-----------

    var parent = VisualTreeHelper.GetParent(obj) as GridViewRowPresenter;
    if (parent == null)
      return HitTestResultBehavior.Stop;

    var headers = parent.Columns.ToDictionary(column => column.Header.ToString());

    // Traverse up the VisualTree and find the record set.
    DependencyObject d = parent;
    do {
      d = VisualTreeHelper.GetParent(d);
    } while (d != null && !(d is ListViewItem));

    // Reached the end of element set as root's scope.
    if (d == null)
      return HitTestResultBehavior.Stop;

    var item = d as ListViewItem;
    var index = ListView1.ItemContainerGenerator.IndexFromContainer(item);
    Debug.WriteLine(index);

    lblCursorPosition.Text = $"Over {item.Name} at ({index})";

    // Set the behavior to return visuals at all z-order levels.
    return HitTestResultBehavior.Continue;
  };

  // Set up a callback to receive the hit test result enumeration.
  VisualTreeHelper.HitTest((Visual)sender, null, myHitTestResult, new PointHitTestParameters(pt));
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-09-18T14:15:27.653

我们在 WPF 的新数据网格中使用了类似的技术：

```
Private Sub SelectAllText(ByVal cell As DataGridCell)
    If cell IsNot Nothing Then
        Dim txtBox As TextBox= GetVisualChild(Of TextBox)(cell)
        If txtBox IsNot Nothing Then
            txtBox.Focus()
            txtBox.SelectAll()
        End If
    End If
End Sub

Public Shared Function GetVisualChild(Of T As {Visual, New})(ByVal parent As Visual) As T
    Dim child As T = Nothing
    Dim numVisuals As Integer = VisualTreeHelper.GetChildrenCount(parent)
    For i As Integer = 0 To numVisuals - 1
        Dim v As Visual = TryCast(VisualTreeHelper.GetChild(parent, i), Visual)
        If v IsNot Nothing Then
            child = TryCast(v, T)
            If child Is Nothing Then
                child = GetVisualChild(Of T)(v)
            Else
                Exit For
            End If
        End If
    Next
    Return child
End Function 
```

该技术应该对您相当适用，只需在生成后传递您的 listviewitem 即可。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2010-09-13T11:09:00.937

或者它可以简单地通过

```
private void yourtextboxinWPFGrid_LostFocus(object sender, RoutedEventArgs e)
    {
       //textbox can be catched like this. 
       var textBox = ((TextBox)sender);
       EmailValidation(textBox.Text);
    } 
```

# svn - 持续集成中的清洁构建

> ID：92329
> 
> 赞同：7
> 
> 时间：2008-09-18T13:03:17.377
> 
> 标签：svn, cruisecontrol.net, nant

我们为 CI 使用 CruiseControl.Net/NAnt/Subversion 堆栈。对每个构建进行新的检查太费时了，所以目前我们只是对工作副本进行更新。但是，这留下了孤立文件在源代码管理中被删除后可能保留在工作副本中的可能性。我们曾尝试使用 NAnt 删除任务在更新前删除所有代码源文件，但这可能会损坏工作副本。有谁知道在干净且最新的工作副本上运行构建的快速方法？编辑：我们在 SVN 1.3.2

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T13:09:56.550

如果您只是“更新”，SVN 将删除源代码管理中已删除的所有文件。但是，在构建过程中创建的文件可能仍然存在并且可能会干扰新构建。我不确定 SVN 是否有删除它们的命令，但我想你可以用一个小脚本来做到这一点，SVN 肯定可以告诉你哪些文件在源代码控制之下，哪些不在。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T13:16:26.050

我们的 CC 实现也有类似的问题。

我们的解决方案...我们已经制作了一个 3:00 AM 每晚构建，除了基本单元测试之外，它还执行了更长时间运行的集成测试。我们只是决定让凌晨 3:00 在新树上构建一个完全干净的构建。由于是半夜，它很少影响到任何人。所有其他“正常”签入都运行增量构建。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T13:06:43.890

如果在完成 svn 更新后，您的工作副本中留下了孤立文件，那么您的 Subversion 版本中存在错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T13:07:58.830

您可以每天进行一次完整构建，然后在签入时保持构建原样。此外，对于部署构建，始终使用干净的完整构建可能是一个好主意。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T13:09:23.850

我能想到的唯一方法是在构建服务器上有两个副本。首先，您在第一个位置进行更新。您删除第二个位置。首先复制到第二个，然后在第二个位置构建。这样你总是从一个干净的构建开始。

您可能想看看为什么您的结帐需要这么长时间。我使用了相同的 buildserver 堆栈并且从来没有遇到过这个问题。Subversion 通常比构建本身花费更少的时间。

# visual-studio - “贪婪的” 和 在 Visual Studio 中

> ID：92342
> 
> 赞同：4
> 
> 时间：2008-09-18T13:05:33.970
> 
> 标签：visual-studio, keyboard

有没有办法在 Visual Studio 中应用“贪婪”行为和键？“贪婪”是指当光标位置和下一个单词绑定之间的所有空格都可以使用一次击键删除时的这种行为。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-18T13:10:47.623

好吧，我不认为您可以更改删除键或退格键的绑定 - 但 CTRL+DEL 和 CTRL+Backspace 非常接近您想要的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T13:06:59.037

您可以使用**Ctrl+Shift+箭头**键进行选择，然后点击 Delete。**您可能需要在仍按Ctrl+Shift**组合的同时多次按箭头键，但由于手指处于同一位置，因此速度非常快。这也适用于增量选择单词。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T13:11:31.037

实际上，您需要这样做：**`Ctrl`+ `Shift`+ `Left`+`Right`** - 这将只给您选择的空间，然后您可以按删除。

这是假设您来自右侧，并且您必须删除左侧的空间。

当然，这仍然是 5 次击键……但它胜过一次又一次按退格键……

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T13:09:03.523

只需**Ctrl+Backspace** ...

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T13:12:10.320

**`Ctrl`+`Back Space`**和**`Ctrl`+`Delete`**也是贪婪的，它们删除各自方向上最近的单词。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T13:11:27.387

听起来您可以为其编写宏，然后分配给键盘快捷键（例如`SHIFT`+ `DEL`）。

如果您探索 EnvDTE 命名空间，您可以做很多事情来更改活动文档窗口中的文本。我会先检查类似...

```
 Public Sub RemoveWhiteSpace()
        DTE.ActiveDocument.Selection.WordRight(True)
        DTE.ActiveDocument.Selection.Text = " "
    End Sub 
```

这只是一个简单的例子，但你可以很容易地进一步扩展它

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-09-08T11:47:33.787

您正在寻找：

Edit.DeleteHorizo​​ntalWhiteSpace

我将它设置为 Ctrl+K, Ctrl+\ 我认为这是默认设置，但可能不是

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-08-09T15:21:48.337

最近，ReSharper 将其作为一个选项。默认情况下它是打开的，这导致了这个问答：[Visual Studio 最近的“饥饿”或“贪婪”退格行为更新？](https://stackoverflow.com/questions/57417166/visual-studio-recent-hungry-or-greedy-backspace-behavior-update)

也许这不符合直接在 Visual Studio 中应用该行为的条件，但很高兴了解这一点。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T14:42:04.207

好的，我有这个 < Ctrl > 的东西。并应用这些知识，我找到了相应的 VS 命令：*Edit.WordDeleteToStart*和*Edit.WordDeleteToEnd*。

我已经使用 Options->Environment->Keyboard 对话框成功地重新映射了 < Delete > 和 < Backspace > 键。不幸的是，这个命令不仅适用于我希望的空白，但仍然感谢大家！

# c# - 有没有人找到并行运行 C# Selenium RC 测试的方法？

> ID：92362
> 
> 赞同：14
> 
> 时间：2008-09-18T13:07:41.950
> 
> 标签：c#, selenium, acceptance-testing, selenium-grid, pnunit

**有没有人找到一种方法来并行运行用 C# 编写的 Selenium RC / Selenium Grid 测试？**

我目前使用 Selenium RC 的 C# 驱动程序编写了一个相当大的测试套件。运行整个测试套件需要一个多小时才能完成。我通常不必运行整个套件，所以到目前为止这不是问题，但我希望能够更经常地做一些事情（即，作为自动构建的一部分）

我最近花了一些时间研究 Selenium Grid 项目，其目的本质上是允许这些测试并行运行。不幸的是，我正在使用的 TestDriven.net 插件似乎是连续运行测试的（即一个接一个）。我假设 NUnit 会以类似的方式执行测试，尽管我还没有实际测试过。

我注意到 NUnit 2.5 测试版开始讨论与 pNUnit 并行运行测试，但我对这个项目还不够熟悉，无法确定这是否可行。

我正在考虑的另一个选择是将我的测试套件分成不同的库，这可以让我同时从每个库运行测试，但我想尽可能避免这种情况，因为我不相信这是拆分的正当理由测试套件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-04T16:49:35.427

我正在做这件事，并发现[Gallio](http://www.gallio.org/)最新可以并行驱动 mbUnit 测试。您可以将它们驱动到单个[Selenium Grid](http://selenium-grid.seleniumhq.org/)集线器，该集线器可以有多个远程控制服务器进行侦听。

我正在使用[Gallio 的最新每晚](http://ccnet.gallio.org/Distributables/)来获取[ParallelizableAttribute](http://www.gallio.org/api/html/T_MbUnit_Framework_ParallelizableAttribute.html)和[DegreeOfParallelismAttribute](http://www.gallio.org/api/html/T_MbUnit_Framework_DegreeOfParallelismAttribute.html)。

我注意到的一件事是我不能依赖`TestSet`和`TestTeardown`隔离并行测试。您需要测试看起来像这样：

```
[Test] public void Foo(){
  var s = new DefaultSelenium("http://grid", 4444, "*firefox",
                              "http://server-under-test");
  s.Start();
  s.Open("mypage.aspx");
  // Continue
  s.Stop();

} 
```

使用该`[SetUp]`属性启动 Selenium 会话会导致测试无法从`s.Start()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-28T20:12:06.690

大约三年前，我编写了 PNUnit 作为 NUnit 的扩展，我很高兴看到它最终被集成到 NUnit 中。

我们每天都使用它在不同的发行版和组合下测试我们的软件。举个例子：我们有一个包含大约 210 个测试的重型测试（长测试）的测试套件。他们每个人都设置了一个服务器并在命令行中运行一个客户端，运行多个操作（最多 210 个场景）。

好吧，我们使用相同的套件在不同的 Linux 组合和 Windows 变体上运行测试，也将 Windows 服务器与 linux 客户端、windows xp、vista、域控制器、域外等组合在一起。我们使用相同的二进制文件，然后在几个盒子上启动“代理”。

我们使用相同的平台：平衡负载测试负载 -> 我的意思是，更快地以块的形式运行。同时运行几个组合，我觉得更有趣的是：定义多客户端场景：两个客户端等待服务器启动，然后启动操作，相互同步等等。我们还使用 PNUnit 进行负载测试（针对单个服务器的数百个盒子）。

因此，如果您对如何设置它有任何疑问（恐怕还不简单），请不要犹豫。

另外我很久以前在 DDJ 上写过一篇关于它的文章：[http ://www.ddj.com/architect/193104810](http://www.ddj.com/architect/193104810)

希望能帮助到你

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T20:02:49.270

我不知道没有答案是否算作答案，但我想说你已经研究了所有东西，你真的想出了两种可能的解决方案......

*   测试套件并行运行测试
*   拆分测试套件

我对其他任何事情都不知所措。

# javascript - Maven插件分析javascript代码质量

> ID：92372
> 
> 赞同：20
> 
> 时间：2008-09-18T13:09:13.307
> 
> 标签：javascript, maven-2, static-analysis, jslint

Javascript 代码可能很难维护。
我正在寻找能够帮助我确保合理质量水平的工具。
到目前为止，我找到了[JsUNIt](https://github.com/pivotal/jsunit)，一个非常好的 javascript 单元测试框架。可以在任何可用浏览器上从 ant 自动运行测试。
我还没有找到一些与 PMD、checkstyle、Findbug 等价的 javascript...

你知道 javascript 的任何静态代码分析工具吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2010-06-28T01:34:25.870

这是一个旧线程，但如果您有兴趣在您的 maven 项目中运行 Jasmine 进行 BDD 测试，我正是为此目的编写了这个 jasmine-maven-plugin（即，通过鼓励它的 TDD 来提高 JS 质量）。

[http://github.com/searls/jasmine-maven-plugin](http://github.com/searls/jasmine-maven-plugin)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-10-25T20:09:16.093

作为 Maven 中编译阶段的一部分，我使用以下代码运行 JSLint。

它从 maven 存储库下载 jslint4java，因此您不需要其他任何东西。

如果 JSLint 在 javascript 文件中发现问题，则构建将失败。

```
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-antrun-plugin</artifactId>
            <version>1.6</version>
            <executions>
                <execution>
                    <phase>compile</phase>
                    <goals>
                        <goal>run</goal>
                    </goals>
                    <configuration>
                        <target>
                            <taskdef name="jslint" classname="com.googlecode.jslint4java.ant.JSLintTask" classpath="${settings.localRepository}/com/googlecode/jslint4java/jslint4java-ant/1.4.2/jslint4java-ant-1.4.2.jar" />
                            <jslint options="white,browser,devel,undef,eqeqeq,plusplus,bitwise,regexp,strict,newcap,immed">
                                <predef>Ext,Utils</predef>
                                <formatter type="plain" />
                                <fileset dir="${basedir}/src/main/resources/META-INF/resources/js" includes="**/*.js" />
                            </jslint>
                        </target>
                    </configuration>
                </execution>
            </executions>
            <dependencies>
                <dependency>
                    <groupId>com.googlecode.jslint4java</groupId>
                    <artifactId>jslint4java-ant</artifactId>
                    <version>1.4.2</version>
                </dependency>
            </dependencies>
        </plugin> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-12-08T19:29:31.200

[Wro4j-maven-plugin](http://code.google.com/p/wro4j/wiki/MavenPlugin)还为 JavaScript 和 CSS 资源的静态代码分析提供了几个目标，例如：[jslint](http://jslint.com/)、[jshint](http://www.jshint.com/)和[csslint](http://csslint.net/)

这是官方[Wro4j-maven-plugin 文档](https://wro4j.readthedocs.io/en/stable/MavenPlugin/)的链接。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-12-07T05:13:40.403

我在 Codehaus 提交的几个插件可能也很有趣：

[http://mojo.codehaus.org/js-import-maven-plugin/](http://mojo.codehaus.org/js-import-maven-plugin/)

[http://mojo.codehaus.org/jslint-maven-plugin/](http://mojo.codehaus.org/jslint-maven-plugin/)

第一个为 JavaScript 带来了 Maven 依赖管理。第二个允许快速有效地调用 JSLint。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T14:17:49.973

“jslint ant task”的快速谷歌显示[jslint4java](http://code.google.com/p/jslint4java/)，它显然包括一个 Ant 任务。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-03-14T20:04:09.723

jslint4java 已经提到过几次，我不记得他们添加了哪个版本，但实际上有一个内置的 Maven 任务。

传统上使用 jslint4java 和 Maven，人们使用 antrun 插件来运行 jslint4java ant 任务，但是您现在可以在 Maven 中配置它并避免额外的步骤。

[http://docs.jslint4java.googlecode.com/git/2.0.2/maven.html](http://docs.jslint4java.googlecode.com/git/2.0.2/maven.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-10T19:16:07.447

这个项目看起来很接近：

[http://dev.abiss.gr/mvn-jstools/index.html](http://dev.abiss.gr/mvn-jstools/index.html)

它使用 JsLint 生成报告。它看起来不像构建生命周期的测试阶段，所以我认为如果 jslint 发现问题（这是我想在我的项目中做的），它不会拒绝构建。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-09-18T16:10:01.680

新的[jslint-maven-plugin](http://code.google.com/p/jslint-maven-plugin)看起来很有用。它包装了 jslint4java，在构建的测试阶段执行 JSLint。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-06T14:00:33.870

我参与过[SweetDEV RIA 项目](http://sweetdev-ria.sourceforge.net/)，它是一个由多个“Web 2.0/Ajax/JavaScript”组件组成的 Java 标记库。

maven 2 构建过程包括一些内部插件，这些插件启动[JSLint](http://www.jslint.com/)（代码验证器）、[JsMin](http://www.crockford.com/javascript/jsmin.html)（代码压缩器）、[JsDoc 生成](http://sweetdev-ria.sourceforge.net/sweetdev-ria3.1/jsdoc/index.html)（JavaDoc 类文档）、[JsUnit](http://www.jsunit.net/)（单元测试）和[Selenium](http://selenium.openqa.org/)（在浏览器中）测试。

您可以查看[SweetDEV RIA maven 插件库](http://sweetdev-ria.svn.sourceforge.net/viewvc/sweetdev-ria/sweetdev-ria-m2-plugins/trunk/)。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2011-08-25T19:39:09.143

声纳和 JavaScript 插件：[http ://docs.codehaus.org/display/SONAR/JavaScript+Plugin](http://docs.codehaus.org/display/SONAR/JavaScript+Plugin)

# python - Fedora Core 9 上的 Django + FCGID——我错过了什么？

> ID：92373
> 
> 赞同：0
> 
> 时间：2008-09-18T13:09:21.480
> 
> 标签：python, django, apache2, fastcgi, fcgid

Fedora Core 9 似乎使用[FCGID](http://fastcgi.coremail.cn/)而不是[FastCGI](http://www.fastcgi.com/drupal/node/2)作为预构建的 YUM 管理模块。[*我宁愿不必在 YUM 之外维护一个模块；所以没有为我或我的系统管理员手动构建。*]

我正在尝试通过 runfastcgi 界面（根据[FastCGI 部署](http://docs.djangoproject.com/en/dev/howto/deployment/fastcgi/)文档）启动 Django。

我看到的是写入的结果页面`error_log`。它不会通过 Apache 返回到我的浏览器。此外，还有一堆消息——显然来自[Flup](http://trac.saddi.com/flup)和 WSGIServer——表明 WSGI 环境没有正确定义。

1.  FastCGI 是否可用于 FC9，而我只是忽略了它？

2.  FCGID 和 Flup 是否真的为 Django 创建了必要的 WSGI 环境？如果是这样，您可以分享`.fcgi`您正在使用的界面脚本吗？`mysite.fcgi`我的是从Django 文档中复制的。FCGID[文档](http://fastcgi.coremail.cn/doc.htm)页面提示支持 PHP 和 Ruby——直接 PHP，通过Ruby——`dispatch.fcgi`不支持 Python。

**更新**。错误消息是...

```
WSGIServer: missing FastCGI param REQUEST_METHOD required by WSGI! 
WSGIServer: missing FastCGI param SERVER_NAME required by WSGI!
WSGIServer: missing FastCGI param SERVER_PORT required by WSGI!
WSGIServer: missing FastCGI param SERVER_PROTOCOL required by WSGI! 
```

我应该放弃船舶并切换到[mod_python](http://www.modpython.org/)并放弃这种方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T14:13:09.720

你为什么不试试[modwsgi](http://code.google.com/p/modwsgi/)？对于 Django 等 WSGI 应用程序来说，这听起来是近来的首选方式。

如果您不想为 Fedora Core 编译东西，那可能会比较棘手。

关于你的第一个问题，[这](http://fitri.manzanisimo.net/2008/05/23/hostmonster-python-25-subversion-14-django-svn-mysqldb-fcgid/)似乎解决了 fcgid 配置问题。

请注意，您不想像这样手动运行 django 应用程序：`python manage.py runfcgi`如果设置正确并由`touch your.fcgi`.

# c# - 创建隐藏文件夹

> ID：92376
> 
> 赞同：44
> 
> 时间：2008-09-18T13:09:41.760
> 
> 标签：c#, .net, filesystems

有什么方法可以从 c# 中以编程方式在存储设备上创建（我猜是访问）隐藏文件夹？

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2008-09-18T13:12:05.357

```
using System.IO; 

string path = @"c:\folders\newfolder"; // or whatever 
if (!Directory.Exists(path)) 
{ 
DirectoryInfo di = Directory.CreateDirectory(path); 
di.Attributes = FileAttributes.Directory | FileAttributes.Hidden; 
} 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2008-09-18T13:12:38.943

是的你可以。照常创建目录，然后在其上设置属性。例如

```
DirectoryInfo di = new DirectoryInfo(@"C:\SomeDirectory");

//See if directory has hidden flag, if not, make hidden
if ((di.Attributes & FileAttributes.Hidden) != FileAttributes.Hidden)
{   
     //Add Hidden flag    
     di.Attributes |= FileAttributes.Hidden;    
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-18T13:21:25.880

```
CreateHiddenFolder(string name)  
{  
  DirectoryInfo di = new DirectoryInfo(name);  
  di.Create();  
  di.Attributes |= FileAttributes.Hidden;  
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-18T13:14:03.043

```
string path = @"c:\folders\newfolder"; // or whatever 
if (!System.IO.Directory.Exists(path)) 
{ 
    DirectoryInfo di = Directory.CreateDirectory(path); 
    di.Attributes = FileAttributes.Directory | FileAttributes.Hidden; 
} 
```

从[这里](http://www.csharpfriends.com/Forums/ShowPost.aspx?PostID=54724#54727)。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2015-02-10T16:43:59.750

仅获取根文件夹路径的代码。

就像如果我们有 C:/Test/ C:/Test/Abc C:/Test/xyz C:/Test2/ C:/Test2/mnp

它将返回根文件夹路径，即 C:/Test/ C:/Test2/

```
 int index = 0;
            while (index < lst.Count)
            {
                My obj = lst[index];
                lst.RemoveAll(a => a.Path.StartsWith(obj.Path));
                lst.Insert(index, obj );
                index++;                    
            } 
```

# c++ - 为什么不能在 switch 语句中声明变量？

> ID：92396
> 
> 赞同：1049
> 
> 时间：2008-09-18T13:11:55.467
> 
> 标签：c++, switch-statement

我一直想知道 - 为什么不能在 switch 语句中的 case 标签之后声明变量？在 C++ 中，您几乎可以在任何地方声明变量（并且在接近第一次使用时声明它们显然是一件好事），但以下仍然行不通：

```
switch (val)  
{  
case VAL:  
  // This won't work
  int newVal = 42;  
  break;
case ANOTHER_VAL:  
  ...
  break;
} 
```

以上给了我以下错误（MSC）：

> “case”标签跳过“newVal”的初始化

这似乎也是其他语言的限制。为什么会出现这样的问题？

* * *

## 回答 #1

> 赞同：1268
> 
> 时间：2008-09-18T13:17:14.533

`Case`语句只是**标签**。这意味着编译器会将其解释为直接跳转到标签。在 C++ 中，这里的问题是范围之一。您的大括号将范围定义为`switch`语句中的所有内容。这意味着您将留下一个范围，在该范围内将进一步执行跳转到跳过初始化的代码。

处理此问题的正确方法是定义特定于该`case`语句的范围并在其中定义变量：

```
switch (val)
{   
case VAL:  
{
  // This will work
  int newVal = 42;  
  break;
}
case ANOTHER_VAL:  
...
break;
} 
```

* * *

## 回答 #2

> 赞同：401
> 
> 时间：2013-11-07T08:12:16.270

这个问题最初被同时标记为[c](/questions/tagged/c "显示标记为“c”的问题")和[c++](/questions/tagged/c%2b%2b "显示标记为“c++”的问题")。原始代码确实在 C 和 C++ 中都无效，但是出于完全不同的不相关原因。

*   在 C++ 中，此代码无效，因为标签跳过其初始化`case ANOTHER_VAL:`跳转到变量的范围。`newVal`绕过自动对象初始化的跳转在 C++ 中是非法的。大多数答案都正确解决了这个问题。

*   但是，在 C 语言中绕过变量初始化并不是错误。在 C 语言中，在初始化时跳入变量的范围是合法的。这仅意味着该变量未初始化。由于完全不同的原因，原始代码不能在 C 中编译。原始代码中的标签`case VAL:`附在变量的声明中`newVal`。在 C 语言中，声明不是语句。它们不能被标记。这就是将此代码解释为 C 代码时导致错误的原因。

    ```
     switch (val)  
      {  
      case VAL:             /* <- C error is here */
        int newVal = 42;  
        break;
      case ANOTHER_VAL:     /* <- C++ error is here */
        ...
        break;
      } 
    ```

    添加一个额外的`{}`块可以解决 C++ 和 C 问题，即使这些问题恰好有很大不同。在 C++ 方面，它限制了 的范围`newVal`，确保`case ANOTHER_VAL:`不再跳转到该范围，从而消除了 C++ 问题。在 C 方面，extra`{}`引入了复合语句，从而使`case VAL:`标签适用于语句，从而消除了 C 问题。

*   在 C 情况下，没有`{}`. 只需在标签后添加一个空语句，`case VAL:`代码就会生效

    ```
     switch (val)  
      {  
      case VAL:;            /* Now it works in C! */
        int newVal = 42;  
        break;
      case ANOTHER_VAL:  
        ...
        break;
      } 
    ```

    请注意，即使它现在从 C 的角度来看是有效的，但从 C++ 的角度来看它仍然是无效的。

*   对称地，在 C++ 的情况下，这个问题可以在没有`{}`. 只需从变量声明中删除初始化程序，代码就会生效

    ```
     switch (val)  
      {  
      case VAL: 
        int newVal;
        newVal = 42;  
        break;
      case ANOTHER_VAL:     /* Now it works in C++! */
        ...
        break;
      } 
    ```

    请注意，即使它现在从 C++ 的角度来看是有效的，但从 C 的角度来看它仍然是无效的。

* * *

## 回答 #3

> 赞同：138
> 
> 时间：2008-09-18T13:54:04.447

行。只是为了澄清这与声明无关。它仅与“跳过初始化”有关（ISO C++ '03 6.7/3）

这里的很多帖子都提到，跳过声明可能会导致变量“未声明”。这不是真的。可以在没有初始化程序的情况下声明 POD 对象，但它将具有不确定的值。例如：

```
switch (i)
{
   case 0:
     int j; // 'j' has indeterminate value
     j = 0; // 'j' set (not initialized) to 0, but this statement
            // is jumped when 'i == 1'
     break;
   case 1:
     ++j;   // 'j' is in scope here - but it has an indeterminate value
     break;
} 
```

如果对象是非 POD 或聚合，编译器会隐式添加初始化程序，因此无法跳过这样的声明：

```
class A {
public:
  A ();
};

switch (i)  // Error - jumping over initialization of 'A'
{
   case 0:
     A j;   // Compiler implicitly calls default constructor
     break;
   case 1:
     break;
} 
```

此限制不限于 switch 语句。使用“goto”跳过初始化也是错误的：

```
goto LABEL;    // Error jumping over initialization
int j = 0; 
LABEL:
  ; 
```

有点琐碎的是，这是 C++ 和 C 之间的区别。在 C 中，跳过初始化不是错误。

正如其他人所提到的，解决方案是添加一个嵌套块，以便变量的生命周期仅限于单个案例标签。

* * *

## 回答 #4

> 赞同：41
> 
> 时间：2008-09-18T13:13:46.523

整个 switch 语句在同一范围内。要绕过它，请执行以下操作：

```
switch (val)
{
    case VAL:
    {
        // This **will** work
        int newVal = 42;
    }
    break;

    case ANOTHER_VAL:
      ...
    break;
} 
```

**注意**括号。

* * *

## 回答 #5

> 赞同：33
> 
> 时间：2011-12-18T06:33:17.943

在阅读了所有答案和更多研究之后，我得到了一些东西。

```
Case statements are only 'labels' 
```

**在 C 中，根据规范，**

§6.8.1 标记语句：

```
labeled-statement:
    identifier : statement
    case constant-expression : statement
    default : statement 
```

在 C 中，没有任何子句允许“带标签的声明”。它只是不是语言的一部分。

所以

```
case 1: int x=10;
        printf(" x is %d",x);
break; 
```

这**不会编译**，请参阅[http://codepad.org/YiyLQTYw](http://codepad.org/YiyLQTYw)。GCC 给出一个错误：

```
label can only be a part of statement and declaration is not a statement 
```

甚至

```
 case 1: int x;
          x=10;
            printf(" x is %d",x);
    break; 
```

这**也没有编译**，请参阅[http://codepad.org/BXnRD3bu](http://codepad.org/BXnRD3bu)。在这里，我也遇到了同样的错误。

* * *

**在 C++ 中，根据规范，**

允许标记声明，但不允许标记初始化。

请参阅[http://codepad.org/ZmQ0IyDG](http://codepad.org/ZmQ0IyDG)。

* * *

**解决这种情况的方法有两个**

1.  使用 {} 使用新范围

    ```
    case 1:
           {
               int x=10;
               printf(" x is %d", x);
           }
    break; 
    ```

2.  或使用带有标签的虚拟语句

    ```
    case 1: ;
               int x=10;
               printf(" x is %d",x);
    break; 
    ```

3.  在 switch() 之前声明变量，如果满足您的要求，则在 case 语句中使用不同的值对其进行初始化

    ```
    main()
    {
        int x;   // Declare before
        switch(a)
        {
        case 1: x=10;
            break;

        case 2: x=20;
            break;
        }
    } 
    ```

* * *

**switch 语句的更多内容**

永远不要在 switch 中写任何不属于任何标签的语句，因为它们永远不会执行：

```
switch(a)
{
    printf("This will never print"); // This will never executed

    case 1:
        printf(" 1");
        break;

    default:
        break;
} 
```

请参阅[http://codepad.org/PA1quYX3](http://codepad.org/PA1quYX3)。

* * *

## 回答 #6

> 赞同：20
> 
> 时间：2008-09-18T13:15:23.587

你不能这样做，因为`case`标签实际上只是包含块的入口点。

[达夫的装置](http://en.wikipedia.org/wiki/Duff%27s_device)最清楚地说明了这一点。这是来自维基百科的一些代码：

```
strcpy(char *to, char *from, size_t count) {
    int n = (count + 7) / 8;
    switch (count % 8) {
    case 0: do { *to = *from++;
    case 7:      *to = *from++;
    case 6:      *to = *from++;
    case 5:      *to = *from++;
    case 4:      *to = *from++;
    case 3:      *to = *from++;
    case 2:      *to = *from++;
    case 1:      *to = *from++;
               } while (--n > 0);
    }
} 
```

请注意`case`标签如何完全忽略块边界。是的，这是邪恶的。但这就是您的代码示例不起作用的原因。跳转到`case`标签与使用相同`goto`，因此不允许使用构造函数跳过局部变量。

正如其他几张海报所指出的那样，您需要放入自己的一块：

```
switch (...) {
    case FOO: {
        MyObject x(...);
        ...
        break; 
    }
    ...
 } 
```

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2008-09-18T14:00:31.840

到目前为止，大多数回复在一个方面都是错误的：您**可以**在 case 语句之后声明变量，但*不能*初始化它们：

```
case 1:
    int x; // Works
    int y = 0; // Error, initialization is skipped by case
    break;
case 2:
    ... 
```

如前所述，解决此问题的一个好方法是使用大括号为您的案例创建范围。

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2008-09-18T17:02:47.783

我最喜欢的邪恶开关技巧是使用 if(0) 跳过不需要的 case 标签。

```
switch(val)
{
case 0:
// Do something
if (0) {
case 1:
// Do something else
}
case 2:
// Do something in all cases
} 
```

但是非常邪恶。

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2008-09-18T13:14:33.073

试试这个：

```
switch (val)
{
    case VAL:
    {
        int newVal = 42;
    }
    break;
} 
```

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2008-09-18T13:15:17.660

*如果*您开始一个新块，您可以在 switch 语句中声明变量：

```
switch (thing)
{ 
  case A:
  {
    int i = 0;  // Completely legal
  }
  break;
} 
```

原因是在堆栈上分配（和回收）空间以存储局部变量。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2008-09-18T13:22:09.483

考虑：

```
switch(val)
{
case VAL:
   int newVal = 42;
default:
   int newVal = 23;
} 
```

在没有 break 语句的情况下，有时 newVal 会被声明两次，直到运行时你才知道它是否如此。我的猜测是限制是因为这种混乱。newVal 的范围是什么？约定将规定它将是整个 switch 块（在大括号之间）。

我不是 C++ 程序员，但在 C 语言中：

```
switch(val) {
    int x;
    case VAL:
        x=1;
} 
```

工作正常。在 switch 块内声明一个变量是可以的。在案件警卫之后声明不是。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2008-09-18T13:16:24.427

开关的整个部分是一个单一的声明上下文。您不能在这样的 case 语句中声明变量。试试这个：

```
switch (val)  
{  
case VAL:
{
  // This will work
  int newVal = 42;
  break;
}
case ANOTHER_VAL:  
  ...
  break;
} 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-09-18T13:21:36.537

如果您的代码显示“int newVal=42”，那么您可以合理地预期 newVal 永远不会未初始化。但是，如果您跳过此语句（这就是您正在做的事情），那么这正是发生的事情 - newVal 在范围内但尚未分配。

如果这就是你真正想要发生的事情，那么语言需要通过说“int newVal; newVal = 42;”来使其明确。否则，您可以将 newVal 的范围限制为单一情况，这更有可能是您想要的。

如果您考虑相同的示例但使用“const int newVal = 42;”，它可能会澄清事情

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-10-17T14:31:26.943

我只是想强调*slim*的[观点](https://stackoverflow.com/questions/92396/why-cant-variables-be-declared-in-a-switch-statement#answer-92477)。switch 构造创建了一个完整的、一流的公民范围。因此，可以在第一个 case 标签之前的 switch 语句中声明（和初始化）一个变量，**而无需**额外的括号对：

```
switch (val) {  
  /* This *will* work, even in C89 */
  int newVal = 42;  
case VAL:
  newVal = 1984; 
  break;
case ANOTHER_VAL:  
  newVal = 2001;
  break;
} 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-09-02T15:08:23.113

到目前为止，答案都是针对 C++ 的。

对于 C++，您不能跳过初始化。您可以在 C 中。但是，在 C 中，声明不是语句，并且 case 标签必须跟在语句之后。

所以，有效的（但丑陋的）C，无效的 C++

```
switch (something)
{
  case 1:; // Ugly hack empty statement
    int i = 6;
    do_stuff_with_i(i);
    break;
  case 2:
    do_something();
    break;
  default:
    get_a_life();
} 
```

反过来，在 C++ 中，声明就是声明，所以下面是有效的 C++，无效的 C

```
switch (something)
{
  case 1:
    do_something();
    break;
  case 2:
    int i = 12;
    do_something_else();
} 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2010-09-06T21:19:43.920

有趣的是，这很好：

```
switch (i)  
{  
case 0:  
    int j;  
    j = 7;  
    break;  

case 1:  
    break;
} 
```

...但这不是：

```
switch (i)  
{  
case 0:  
    int j = 7;  
    break;  

case 1:  
    break;
} 
```

我知道修复很简单，但我还不明白为什么第一个示例不会打扰编译器。正如前面提到的（2 年前呵呵），**声明**不是导致错误的原因，即使有逻辑。初始化是问题。如果变量被初始化并在不同的行上声明，它就会编译。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2016-05-21T22:17:37.487

[我最初为这个问题](https://stackoverflow.com/questions/37368137/c-why-can-we-define-a-variable-in-case-of-switch)写了这个答案。但是，当我完成它时，我发现答案已关闭。所以我把它贴在这里，也许喜欢参考标准的人会觉得它很有帮助。

有问题的原始代码：

```
int i;
i = 2;
switch(i)
{
    case 1: 
        int k;
        break;
    case 2:
        k = 1;
        cout<<k<<endl;
        break;
} 
```

其实有2个问题：

**1、为什么我可以在`case`label后面声明一个变量？**

这是因为在 C++ 中，标签必须采用以下形式：

N3337 6.1/1

> 标记语句：
> 
> ...
> 
> *   *属性说明符 seqopt* `case` `constant-expression`：`statement`
> 
> ...

并且在`C++` *声明中声明*也被认为是*声明*（而不是`C`）：

N3337 6/1：

> *声明*：
> 
> ...
> 
> *声明-声明*
> 
> ...

**2\. 为什么我可以跳过变量声明然后使用它？**

因为：N3337 6.7/3

> 可以转移到一个块中，**但不能以一种绕过初始化声明的方式**。跳转的程序（**从**switch 语句的条件**到 case 标签**的转移在这方面被认为是跳转。）
> 
> **从具有自动存储持续时间的变量不在范围内的点到它在范围内的点是格式错误的，** **除非该变量具有标量类型**、具有普通默认构造函数和普通析构函数的类类型、cv 限定版本这些类型之一，或上述类型之一的数组，并且在没有初始化程序的情况下声明（8.5）。

由于`k`是*标量类型*，并且在声明点未初始化，因此可以跳过它的声明。这在语义上是等价的：

```
goto label;

int x;

label:
cout << x << endl; 
```

`x`但是，如果在声明点初始化，这是不可能的：

```
 goto label;

    int x = 58; //error, jumping over declaration with initialization

    label:
    cout << x << endl; 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2015-01-01T18:17:08.520

一个`switch`块**与一系列`if/else if`块不同。**我很惊讶没有其他答案清楚地解释它。

考虑这个`switch`声明：

```
switch (value) {
    case 1:
        int a = 10;
        break;
    case 2:
        int a = 20;
        break;
} 
```

这可能令人惊讶，但编译器不会将其视为简单的`if/else if`. 它将产生以下代码：

```
if (value == 1)
    goto label_1;
else if (value == 2)
    goto label_2;
else
    goto label_end;

{
label_1:
    int a = 10;
    goto label_end;
label_2:
    int a = 20; // Already declared !
    goto label_end;
}

label_end:
    // The code after the switch block 
```

`case`语句被转换为标签，然后用调用`goto`。括号创建了一个新的范围，现在很容易看出为什么不能在一个`switch`块中声明两个具有相同名称的变量。

可能看起来很奇怪，但是需要支持*fallthrough*（即不使用`break`to let execution continue to next `case`）。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-09-18T13:24:17.183

新变量只能在块范围内声明。你需要写这样的东西：

```
case VAL:  
  // This will work
  {
  int newVal = 42;  
  }
  break; 
```

当然， newVal 仅在大括号内具有范围......

干杯，拉尔夫

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-09-18T13:15:16.800

我相信手头的问题是该语句被跳过，并且您尝试在其他地方使用 var ，它不会被声明。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-09-18T13:15:25.647

newVal 存在于开关的整个范围内，但仅在 VAL 分支被命中时才被初始化。如果您围绕 VAL 中的代码创建一个块，则应该没问题。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2012-07-10T06:48:19.453

C++ 标准有： 可以转移到一个块中，但不能通过初始化绕过声明的方式。从具有自动存储持续时间的局部变量不在范围内的点跳转到它在范围内的点的程序是格式错误的，除非该变量具有 POD 类型 (3.9) 并且在没有初始化程序 (8.5) 的情况下声明。

说明此规则的代码：

```
#include <iostream>

using namespace std;

class X {
  public:
    X() 
    {
     cout << "constructor" << endl;
    }
    ~X() 
    {
     cout << "destructor" << endl;
    }
};

template <class type>
void ill_formed()
{
  goto lx;
ly:
  type a;
lx:
  goto ly;
}

template <class type>
void ok()
{
ly:
  type a;
lx:
  goto ly;
}

void test_class()
{
  ok<X>();
  // compile error
  ill_formed<X>();
}

void test_scalar() 
{
  ok<int>();
  ill_formed<int>();
}

int main(int argc, const char *argv[]) 
{
  return 0;
} 
```

显示初始化器效果的代码：

```
#include <iostream>

using namespace std;

int test1()
{
  int i = 0;
  // There jumps fo "case 1" and "case 2"
  switch(i) {
    case 1:
      // Compile error because of the initializer
      int r = 1; 
      break;
    case 2:
      break;
  };
}

void test2()
{
  int i = 2;
  switch(i) {
    case 1:
      int r;
      r= 1; 
      break;
    case 2:
      cout << "r: " << r << endl;
      break;
  };
}

int main(int argc, const char *argv[]) 
{
  test1();
  test2();
  return 0;
} 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2013-02-08T10:55:29.563

似乎可以在 switch case 语句中声明或创建匿名对象*，*因为它们不能被引用，因此不能落入下一个案例。考虑这个示例在 GCC 4.5.3 和 Visual Studio 2008 上编译（可能是合规性问题，所以请专家权衡）

```
#include <cstdlib>

struct Foo{};

int main()
{
    int i = 42;

    switch( i )
    {
    case 42:
        Foo();  // Apparently valid
        break;

    default:
        break;
    }
    return EXIT_SUCCESS;
} 
```

# asp.net - Web 应用程序的全局与通用 Active Directory 组访问

> ID：92413
> 
> 赞同：2
> 
> 时间：2008-09-18T13:14:12.153
> 
> 标签：asp.net, authentication, active-directory, web-applications

我有一个 SQL Server 2000、C# 和 ASP.net Web 应用程序。我们希望通过使用 Active Directory 组来控制对它的访问。如果我放入的组是“全球”，但如果该组是“通用”，我就可以进行身份​​验证。

我怎样才能使这项工作与“通用”组一起工作？这是我的授权块：

```
 <authorization>
  <allow roles="domain\Group Name Here"/>
  <allow roles="domain\Group Name Here2"/>
  <allow roles="domain\Group Name Here3"/>
  <deny users="*"/>
  </authorization> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T14:15:49.323

根据您的 Active Directory 拓扑，您可能必须等待通用组成员身份复制到所有域控制器。Active Directory 建议以下内容：

1.  为每个域创建一个全局组，例如“域 A 授权用户”、“域 B 授权用户”
2.  将您想要的域 A 中的用户放入“域 A 授权用户”组等
3.  在根域“所有授权用户”中创建一个通用组
4.  将全局组放入通用组
5.  使用 Universal 组保护资源：<allow roles="root domain\All Authorized Users/>
6.  等待复制

此方案的一个优点是，当您将新用户添加到全局组之一时，您不必等待 GC 复制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T17:01:35.320

原来我需要使用“Pre Win2000”id 而不是普通的。

# perl - 如何在 Perl 中阅读和操作 PDF 1.5 文件？

> ID：92426
> 
> 赞同：9
> 
> 时间：2008-09-18T13:15:30.857
> 
> 标签：perl, pdf

似乎没有任何 Perl 库可以打开、操作和重新保存使用交叉引用流而不是表格的较新 PDF 版本（我相信是 1.5 及更高版本）的 PDF 文档。有谁知道任何基于 unix/linux 的实用程序可以将 PDF 转换为旧版本？或者我错过了可以处理这个问题的 CPAN 中的 Perl 模块？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-20T15:32:56.193

完毕！一小时前，我将 CAM::PDF v1.50 上传到 CPAN。它现在支持 PDF v1.5 压缩对象流和交叉引用流。我已经用我在网上找到的一些 PDF 文件对其进行了测试，但我肯定会感谢反馈（好的或坏的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T13:18:42.363

我会尝试通过带有适当参数的ghostscript运行它。

就像是`gs -dBATCH -dNOPAUSE -sDEVICE=pdfwriter -dCompatibilityLevel=1.2`

# asp.net - 如何将内联 CSS 应用于 ASP.NET 服务器控件？

> ID：92427
> 
> 赞同：16
> 
> 时间：2008-09-18T13:15:35.957
> 
> 标签：asp.net, css

根据我运行的一个简单测试，我认为不可能将内联 <style> 标记放入 ASP.NET 服务器控件中。该样式最终没有呈现到输出 HTML。即使有可能，我敢肯定这样做是不好的做法。

是否有可能做到这一点？我可以看到它对于只有 1 或 2 个 CSS 类要应用的快速原型很有用。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-09-18T13:25:49.193

Intellisense 不会给你提示，但你可以这样做：

```
<asp:Label ID="Label1" runat="server" Text="Label" style="color:Red;"></asp:Label> 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-09-18T13:37:14.487

根据[www.w3schools.com](http://www.w3schools.com/TAGS/tag_style.asp)：

> 样式元素位于头部。如果要在页面中包含样式表，则应在外部定义样式表，并使用`<link>`.

所以`<style type="text\css"></style>`在控件中包含样式元素（例如块）不是一个好主意。如果可以的话，它可能会在某些浏览器中产生影响，但它不会验证并且是不好的做法。

如果您想将样式内联应用于元素，那么这些都可以工作：

C＃

```
myControl.Attributes["style"] = "color:red";

myControl.Attributes.Add("style", "color:red"); 
```

VB.NET

```
myControl.Attributes("style") = "color:red";

myControl.Attributes.Add("style", "color:red"); 
```

但请记住，*这将替换在 style 属性上设置的任何现有样式*。如果您尝试在代码中的多个位置设置样式，这可能是一个问题，因此需要注意。

最好使用 CSS 类，因为您可以将多个样式声明分组并避免冗余和页面膨胀。[从WebControl](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.webcontrol.aspx)派生的所有控件都有一个可以使用的[CssClass](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.webcontrol.cssclass.aspx)属性，但再次注意不要覆盖已在其他地方应用的现有类。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-06-30T14:40:01.050

如果使用 Attributes["style"]，则每次调用时都会覆盖样式。如果您在两个不同的代码部分中进行调用，这可能是一个问题。同样，这也可能是一个问题，因为该框架包含用于基本设置的属性，例如边框和颜色，这些属性也将作为内联样式应用。这是一个例子：

```
// dangerous: first style will be overwritten
myControl.Attributes["style"] = "text-align:center";
// in some other section of code
myControl.Attributes["style"] = "width:100%"; 
```

为了玩得更好，请设置这样的样式：

```
// correct: both style settings are applied
myControl.Attributes.CssStyle.Add("text-align", "center");
// in some other section of code
myControl.Attributes.CssStyle.Add("width", "100%"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T13:17:57.137

我认为您必须将其作为属性添加到服务器控件...才能呈现为 HTML。

所以基本上（在 C# 中），

```
ControlName.Attributes["style"] = "color:red"; 
```

# c# - 异常通过 Application.ThreadException 和 AppDomain.CurrentDomain.UnhandledException

> ID：92434
> 
> 赞同：4
> 
> 时间：2008-09-18T13:16:26.127
> 
> 标签：c#, exception

我遇到了一个应用程序挂起的问题，并给了我默认的“请告诉 Microsoft 这个问题”弹出窗口，而不是应用程序中的“未处理的异常”对话框。

在应用程序代码中，Application.ThreadException 和 AppDomain.CurrentDomain.UnhandledException 都被重定向到将错误日志写入磁盘、将屏幕截图保存到磁盘并显示友好对话框的方法。

但是当这个错误发生时，这三件事都不会发生。我在事件查看器中得到的只是这个：

*EventType clr20e3、P1 myapp.exe、P2 4.0.0.0、P3 47d794d4、P4 mscorlib、P5 2.0.0.0、P6 471ebc5b、P7 15e5、P8 27、P9 system.argumentoutofrange、P10 NIL*

鉴于该错误似乎仅在应用程序运行几个小时后才发生，我想知道它是否可能是内存泄漏问题。我搜索了一些“clr20e3”，但只找到了 ASP.Net 的东西。我的应用程序是 Windows Forms (.Net 2.0) exe，使用了相当多的程序集——在 C# 和一些非托管 C++ 中。

我想这也可能是错误处理方法中的错误 - 正如一些答案所暗示的那样，我可能会尝试在错误处理程序的开头进行记录（但考虑到这几乎就是我所做的......）。

任何解决此问题的帮助将不胜感激 - 无论是解决方案，还是有关如何找出问题根本原因的建议。

更新：原始错误的根本原因是访问具有负索引的数组（即 system.argumentoutofrange）。为什么这没有被困住对我来说有点神秘，但是考虑到两个异常都被发送到相同的处理代码，我想知道是否可能没有条件（例如）两者都被调用并争夺资源（例如日志文件）？

我设法通过在错误处理代码中的任何其他内容之前执行 EventLog.WriteEntry 来证明这一点。现在添加了一个标志以防止在错误处理中重新进入，我似乎不再有问题......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T13:20:12.483

只是在这里在黑暗中拍摄 - ArgumentOutOfRangeException 实际上是从您的异常*处理程序*中抛出的吗？

此外，您没有说有什么类型的应用程序有问题- Application.ThreadException 只影响 WinForms 线程，所以如果这不是 GUI 应用程序，它是无用的。[（请参阅MSDN 文档](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.threadexception.aspx)中的备注部分）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T13:24:08.183

您是否检查过是否`ArgumentOutOfRangeException`从您的处理程序本身抛出？可能值得在异常处理程序的入口处对事件日志或跟踪进行简单的写入，并确认您确实在命中它。

***编辑：***写入事件日志的信息可以在以下位置找到：

[http://support.microsoft.com/kb/307024](http://support.microsoft.com/kb/307024)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-06T17:05:36.607

您是否不止一次调用 Application.Run() ？这将显示您描述的相同症状。您必须编写一个自定义 ApplicationContext 类作为解决方法。只是我的 0.02 美元经通胀调整。

# python - 从python中的字符串中去除不可打印的字符

> ID：92438
> 
> 赞同：98
> 
> 时间：2008-09-18T13:17:06.797
> 
> 标签：python, string, non-printable

我用来跑步

```
$s =~ s/[^[:print:]]//g; 
```

在 Perl 上摆脱不可打印的字符。

在 Python 中没有 POSIX 正则表达式类，我不能写 [:print:] 让它意味着我想要的。我知道在 Python 中无法检测字符是否可打印。

你会怎么办？

编辑：它也必须支持 Unicode 字符。string.printable 方式会很高兴地将它们从输出中剥离出来。curses.ascii.isprint 将为任何 unicode 字符返回 false。

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2008-09-18T14:28:04.380

不幸的是，在 Python 中迭代字符串相当慢。对于这种事情，正则表达式的速度要快一个数量级。您只需要自己构建角色类。*unicodedata*模块对此非常有帮助，尤其是*unicodedata.category()*函数。有关类别的描述，请参阅[Unicode 字符数据库](http://www.unicode.org/reports/tr44/#General_Category_Values)。

```
import unicodedata, re, itertools, sys

all_chars = (chr(i) for i in range(sys.maxunicode))
categories = {'Cc'}
control_chars = ''.join(c for c in all_chars if unicodedata.category(c) in categories)
# or equivalently and much more efficiently
control_chars = ''.join(map(chr, itertools.chain(range(0x00,0x20), range(0x7f,0xa0))))

control_char_re = re.compile('[%s]' % re.escape(control_chars))

def remove_control_chars(s):
    return control_char_re.sub('', s) 
```

对于 Python2

```
import unicodedata, re, sys

all_chars = (unichr(i) for i in xrange(sys.maxunicode))
categories = {'Cc'}
control_chars = ''.join(c for c in all_chars if unicodedata.category(c) in categories)
# or equivalently and much more efficiently
control_chars = ''.join(map(unichr, range(0x00,0x20) + range(0x7f,0xa0)))

control_char_re = re.compile('[%s]' % re.escape(control_chars))

def remove_control_chars(s):
    return control_char_re.sub('', s) 
```

对于某些用例，额外的类别（例如来自*对照*组的所有类别可能更可取，尽管这可能会减慢处理时间并显着增加内存使用量。每个类别的字符数：

*   `Cc`（控制）：65
*   `Cf`（格式）：161
*   `Cs`（代理）：2048
*   `Co`（自用）：137468
*   `Cn`（未分配）：836601

***编辑**从评论中添加建议。*

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2008-09-18T13:23:14.690

据我所知，最pythonic/最有效的方法是：

```
import string

filtered_string = filter(lambda x: x in string.printable, myStr) 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-09-18T15:25:37.923

您可以尝试使用以下功能设置过滤器`unicodedata.category()`：

```
import unicodedata
printable = {'Lu', 'Ll'}
def filter_non_printable(str):
  return ''.join(c for c in str if unicodedata.category(c) in printable) 
```

有关可用类别，请参见[Unicode 数据库字符属性](http://www.unicode.org/versions/Unicode9.0.0/ch04.pdf)中第 175 页的表 4-9

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2014-09-14T02:20:39.790

在 Python 3 中，

```
def filter_nonprintable(text):
    import itertools
    # Use characters of control category
    nonprintable = itertools.chain(range(0x00,0x20),range(0x7f,0xa0))
    # Use translate to remove all non-printable characters
    return text.translate({character:None for character in nonprintable}) 
```

有关.translate() 与 regex & .replace() 的比较，请参阅[有关删除标点符号的 StackOverflow 帖子](https://stackoverflow.com/questions/265960/best-way-to-strip-punctuation-from-a-string-in-python)

可以通过`nonprintable = (ord(c) for c in (chr(i) for i in range(sys.maxunicode)) if unicodedata.category(c)=='Cc')`使用@Ants Aasma 所示的[Unicode 字符数据库类别来生成范围。](http://www.unicode.org/reports/tr44/#General_Category_Values)

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2019-01-31T00:58:09.353

以下将适用于 Unicode 输入，并且速度相当快......

```
import sys

# build a table mapping all non-printable characters to None
NOPRINT_TRANS_TABLE = {
    i: None for i in range(0, sys.maxunicode + 1) if not chr(i).isprintable()
}

def make_printable(s):
    """Replace non-printable characters in a string."""

    # the translate method on str removes characters
    # that map to None from the string
    return s.translate(NOPRINT_TRANS_TABLE)

assert make_printable('Café') == 'Café'
assert make_printable('\x00\x11Hello') == 'Hello'
assert make_printable('') == '' 
```

我自己的测试表明这种方法比遍历字符串并使用`str.join`.

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2018-09-27T15:16:00.670

python 3中的另一个选项：

```
re.sub(f'[^{re.escape(string.printable)}]', '', my_string) 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-09-18T13:26:00.143

此函数使用列表推导和 str.join，因此它以线性时间而不是 O(n^2) 运行：

```
from curses.ascii import isprint

def printable(input):
    return ''.join(char for char in input if isprint(char)) 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2020-06-23T08:25:06.103

根据@Ber 的回答，我建议仅删除[Unicode 字符数据库类别](http://www.unicode.org/reports/tr44/#General_Category_Values)中定义的控制字符：

```
import unicodedata
def filter_non_printable(s):
    return ''.join(c for c in s if not unicodedata.category(c).startswith('C')) 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-18T13:17:35.843

我现在想出的最好的是（感谢上面的python-izers）

```
def filter_non_printable(str):
  return ''.join([c for c in str if ord(c) > 31 or ord(c) == 9]) 
```

这是我发现适用于 Unicode 字符/字符串的唯一方法

有更好的选择吗？

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2018-01-07T02:13:54.950

下面的一个比上面的其他执行得更快。看一看

```
''.join([x if x in string.printable else '' for x in Str]) 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-07-05T07:04:04.770

> 在 Python 中没有 POSIX 正则表达式类

使用`regex`库时有：[https ://pypi.org/project/regex/](https://pypi.org/project/regex/)

它维护良好，支持 Unicode 正则表达式、Posix 正则表达式等等。用法（方法签名）与 Python**的**`re`.

从文档中：

> `[[:alpha:]]; [[:^alpha:]]`
> 
> 支持 POSIX 字符类。这些通常被视为`\p{...}`.

（我不是附属的，只是一个用户。）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-09-11T05:22:02.680

要删除“空白”，

```
import re
t = """
\n\t<p>&nbsp;</p>\n\t<p>&nbsp;</p>\n\t<p>&nbsp;</p>\n\t<p>&nbsp;</p>\n\t<p>
"""
pat = re.compile(r'[\t\n]')
print(pat.sub("", t)) 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-06-17T19:42:17.433

改编自[Ants Aasma](https://stackoverflow.com/a/93029/5306011)和[shawnrad](https://stackoverflow.com/a/25829509/5306011)的回答：

```
nonprintable = set(map(chr, list(range(0,32)) + list(range(127,160))))
ord_dict = {ord(character):None for character in nonprintable}
def filter_nonprintable(text):
    return text.translate(ord_dict)

#use
str = "this is my string"
str = filter_nonprintable(str)
print(str) 
```

在 Python 3.7.7 上测试

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2022-02-13T23:24:50.180

从 python 中的字符串中剥离“不可打印”字符的优雅 pythonic 解决方案是使用 isprintable() 字符串方法以及生成器表达式或列表理解，具体取决于用例，即。字符串的大小：

```
 ''.join(c for c in my_string if c.isprintable()) 
```

str.isprintable() 如果字符串中的所有字符都可打印或字符串为空，则返回 True，否则返回 False。不可打印字符是那些在 Unicode 字符数据库中定义为“其他”或“分隔符”的字符，但 ASCII 空间 (0x20) 除外，它被认为是可打印的。（请注意，此上下文中的可打印字符是在字符串上调用 repr() 时不应转义的字符。它与写入 sys.stdout 或 sys.stderr 的字符串的处理无关。）

# java - 分布式并发控制

> ID：92452
> 
> 赞同：56
> 
> 时间：2008-09-18T13:18:40.660
> 
> 标签：java, concurrency, load-balancing, scaling, terracotta

我已经为此工作了几天，我找到了几种解决方案，但没有一个非常简单或轻量级。问题基本上是这样的：我们有一个由 10 台机器组成的集群，每台机器都在多线程 ESB 平台上运行相同的软件。我可以相当容易地处理同一台机器上的线程之间的并发问题，但是不同机器上相同数据的并发呢？

本质上，该软件接收请求以通过 Web 服务将客户数据从一个企业提供给另一个企业。但是，客户可能存在也可能不存在于其他系统上。如果没有，我们通过 Web 服务方法创建它。所以它需要一种测试和设置，但我需要某种信号量来阻止其他机器引起竞争条件。我之前遇到过为一个本地客户创建两次远程客户的情况，这并不是很理想。

我在概念上玩弄过的解决方案是：

1.  使用我们的容错共享文件系统来创建“锁定”文件，这些文件将由每台机器根据客户进行检查

2.  在我们的数据库中使用一个特殊的表，并锁定整个表以便对锁定记录进行“测试和设置”。

3.  使用 Terracotta，一种有助于扩展的开源服务器软件，但使用的是中心辐射模型。

4.  使用 EHCache 同步复制我的内存“锁”。

我无法想象我是唯一遇到过这种问题的人。你是怎么解决的？您是自己做的还是有最喜欢的第 3 方产品？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-09-18T23:11:36.040

您可能要考虑使用[Hazelcast](http://www.hazelcast.com)分布式锁。超级精简和容易。

```
java.util.concurrent.locks.Lock lock = Hazelcast.getLock ("mymonitor");
lock.lock ();
try {
// do your stuff
}finally {
   lock.unlock();
} 
```

Hazelcast - 分布式队列、映射、集合、列表、锁定

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-17T03:17:08.333

我们使用 Terracotta，所以我想投赞成票。

我一直在关注 Hazelcast，它看起来是另一种有前途的技术，但由于我没有使用过它，所以无法投票支持它，而且听说它使用基于 P2P 的系统，我真的不会信任它。缩放需求。

但我也听说过来自雅虎的 Zookeeper，它正在 Hadoop 的保护伞下发展。如果你喜欢冒险尝试一些新技术，这真的很有希望，因为它非常精简和卑鄙，只专注于协调。我喜欢这个愿景和承诺，尽管它可能还是太绿了。

*   [http://www.terracotta.org](http://www.terracotta.org)
*   [http://wiki.apache.org/hadoop/ZooKeeper](http://wiki.apache.org/hadoop/ZooKeeper)
*   [http://www.hazelcast.com](http://www.hazelcast.com)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-19T16:19:03.113

Terracotta 更接近于“分层”模型——所有客户端应用程序都与 Terracotta 服务器阵列通信（更重要的是，它们不会相互通信）。Terracotta 服务器阵列能够为规模和可用性进行集群（镜像，用于可用性，条带化，用于规模）。

无论如何，正如您可能知道的那样，Terracotta 使您能够像在单个 JVM 中一样通过使用 POJO 同步/等待/通知或使用任何 java.util.concurrent 原语（例如 ReentrantReadWriteLock）来表达跨集群的并发性, CyclicBarrier, AtomicLong, FutureTask 等等。

[Terracotta Cookbook](http://www.terracotta.org/web/display/orgsite/Tutorials)中有很多简单的食谱展示了这些原语的用法。

作为示例，我将发布 ReentrantReadWriteLock 示例（注意没有“Terracotta”版本的锁 - 您只需使用普通的 Java ReentrantReadWriteLock）

```
import java.util.concurrent.locks.*;

public class Main
{
    public static final Main instance = new Main();
    private int counter = 0;
    private ReentrantReadWriteLock rwl = new ReentrantReadWriteLock(true);

    public void read()
    {
        while (true) {
            rwl.readLock().lock();
                try {
                System.out.println("Counter is " + counter);
            } finally {
                rwl.readLock().unlock();
            }
            try { Thread.currentThread().sleep(1000); } catch (InterruptedException ie) {  }
        }
    }

    public void write()
    {
        while (true) {
            rwl.writeLock().lock();
            try {
               counter++;
               System.out.println("Incrementing counter.  Counter is " + counter);
            } finally {
                 rwl.writeLock().unlock();
            }
            try { Thread.currentThread().sleep(3000); } catch (InterruptedException ie) {  }
        }
    }

    public static void main(String[] args)
    {
        if (args.length > 0)  {
            // args --> Writer
            instance.write();
        } else {
            // no args --> Reader
            instance.read();
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-01-12T10:16:33.080

我建议使用[Redisson](https://redisson.org)。它实现了 30 多种分布式数据结构和服务，包括`java.util.Lock`. 使用示例：

```
Config config = new Config();
config.addAddress("some.server.com:8291");
Redisson redisson = Redisson.create(config);

Lock lock = redisson.getLock("anyLock");
lock.lock();
try {
    ...
} finally {
   lock.unlock();
}

redisson.shutdown(); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-17T03:36:17.060

我打算建议使用 memcached 作为一种非常快速的分布式 RAM 存储来保存日志；但似乎 EHCache 是一个类似的项目，但更以 java 为中心。

只要您确定使用原子更新（memcached 支持它们，不了解 EHCache），任何一种都是可行的。这是迄今为止最具可扩展性的解决方案。

作为相关数据点，Google 使用“Chubby”，一种基于 RAM 的快速分布式锁存储作为多个系统的根，其中包括 BigTable。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T13:42:39.823

我在 Coherence 方面做了很多工作，它允许使用多种方法来实现分布式锁。天真的方法是请求在所有参与节点上锁定相同的逻辑对象。在 Coherence 术语中，这是锁定复制缓存上的密钥。这种方法不能很好地扩展，因为网络流量会随着您添加节点而线性增加。更聪明的方法是使用分布式缓存，其中集群中的每个节点自然负责一部分密钥空间，因此将密钥锁定在这样的缓存中总是涉及与最多一个节点的通信。您可以根据这个想法推出自己的方法，或者更好的是，获得 Coherence。它确实是您梦寐以求的可扩展性工具包。

我要补充一点，任何半体面的基于多节点网络的锁定机制都必须相当复杂才能在任何网络故障的情况下正确动作。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T13:50:31.083

不确定我是否了解整个上下文，但听起来您有 1 个单一数据库支持这一点？为什么不使用数据库的锁定：如果创建客户是单个 INSERT，那么这个语句单独可以用作锁定，因为数据库将拒绝违反您的一个约束的第二个 INSERT（例如，客户名称是独特的例如）。

如果“插入客户”操作不是原子操作并且是一组语句，那么我将引入（或使用）一个初始 INSERT，它创建一些简单的基本记录来识别您的客户（具有必要的唯一性约束），然后执行所有同一事务中的其他插入/更新。同样，数据库将负责一致性，任何并发修改都将导致其中一个失败。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T13:33:44.527

我用两种方法做了一个简单的 RMI 服务：锁定和释放。这两种方法都需要一个密钥（我的数据模型使用 UUID 作为 pk 所以这也是锁定密钥）。

RMI 是一个很好的解决方案，因为它是集中式的。您不能使用 EJB 执行此操作（特别是在集群中，因为您不知道您的呼叫将在哪台机器上进行）。另外，这很容易。

它对我有用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-16T07:27:11.247

如果您可以设置负载平衡，以便单个客户的请求始终映射到同一服务器，那么您可以通过本地同步来处理这个问题。例如，使用您的客户 ID mod 10 来查找要使用的 10 个节点中的哪一个。

即使您不想在一般情况下这样做，您的节点也可以针对这种特定类型的请求相互代理。

假设您的用户足够统一（即如果您有大量用户），您不希望在一个节点过载的地方出现热点，这应该仍然可以很好地扩展。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-08-26T16:54:37.720

您也可以考虑将[Cacheonix](http://www.cacheonix.com/products/cacheonix/index.htm)用于分布式锁。与此处提到的其他任何内容不同，Cacheonix 支持 ReadWrite 锁，并在需要时将锁升级从读取到写入：

```
ReadWriteLock rwLock = Cacheonix.getInstance().getCluster().getReadWriteLock();
Lock lock = rwLock.getWriteLock();
try {
  ...
} finally {
  lock.unlock();
} 
```

全面披露：我是一名 Cacheonix 开发人员。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-08-23T01:01:11.047

由于您已经连接到数据库，因此在添加另一个基础设施之前，请看一下[JdbcSemaphore](https://github.com/zolyfarkas/spf4j/blob/master/spf4j-core/src/main/java/org/spf4j/concurrent/jdbc/JdbcSemaphore.java)，它使用起来很简单：

```
JdbcSemaphore semaphore = new JdbcSemaphore(ds, semName, maxReservations);
boolean acq = semaphore.acquire(acquire, 1, TimeUnit.MINUTES);
if (acq) {
 // do stuff
 semaphore.release();
} else {
  throw new TimeoutException();
} 
```

它是[spf4j](http://www.spf4j.org)库的一部分。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2008-09-18T13:28:14.400

过去，我们会在网络上使用特定的“锁定服务器”来处理这个问题。呜呜。

您的数据库服务器可能具有专门用于执行此类操作的资源。MS-SQL Server 具有可通过*sp_getapplock* / *sp_releaseapplock*过程使用的应用程序锁。

* * *

## 回答 #13

> 赞同：-5
> 
> 时间：2010-02-08T08:45:35.023

我们一直在开发一个开源的分布式同步框架，目前 DistributedReentrantLock 和 DistributedReentrantReadWrite 锁已经实现，但仍处于测试和重构阶段。在我们的架构中，锁键被划分在桶中，每个节点对一定数量的桶负责。因此，对于成功的锁定请求来说，只有一个网络请求。我们还使用 AbstractQueuedSynchronizer 类作为本地锁状态，因此所有失败的锁请求都在本地处理，这大大减少了网络流量。我们使用 JGroups ( [http://jgroups.org](http://jgroups.org) ) 进行组通信，使用 Hessian 进行序列化。

详情请查看[http://code.google.com/p/vitrit/](http://code.google.com/p/vitrit/)。

请给我您的宝贵意见。

卡姆兰

# multithreading - 如何编写无锁结构？

> ID：92455
> 
> 赞同：36
> 
> 时间：2008-09-18T13:18:51.380
> 
> 标签：multithreading, multicore, lock-free

在我的多线程应用程序中，我看到其中存在严重的锁争用，从而阻碍了跨多个内核的良好可扩展性。我决定使用无锁编程来解决这个问题。

如何编写无锁结构？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-09-18T13:36:31.990

简短的回答是：

你不能。

长答案是：

如果您问这个问题，您可能还没有足够的知识来创建无锁结构。创建无锁结构非常困难，只有该领域的专家才能做到。不要自己编写，而是搜索现有的实现。当你找到它时，检查它的使用范围有多广，它的文档记录如何，如果它被充分证明，有什么限制 - 甚至其他人发布的一些无锁结构也被破坏了。

如果您没有找到与您当前使用的结构相对应的无锁结构，请调整算法以便您可以使用一些现有的。

如果您仍然坚持创建自己的无锁结构，请务必：

*   从非常简单的事情开始
*   了解目标平台的内存模型（包括读/写重新排序约束，哪些操作是原子的）
*   研究其他人在实现无锁结构时遇到的问题
*   不要只是猜测它是否会起作用，而是要证明它
*   重度测试结果

更多阅读：

[维基百科上的无锁和无等待算法](http://en.wikipedia.org/wiki/Lock-free_and_wait-free_algorithms)

[Herb Sutter：无锁密码：一种虚假的安全感](http://www.ddj.com/cpp/210600279)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-09-18T13:25:50.240

使用诸如[Intel 的 Threading Building Blocks 之](http://www.threadingbuildingblocks.org/)类的库，它包含相当多的无锁结构和算法。我真的不建议您尝试自己编写无锁代码，它极易出错并且很难做到正确。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-09-18T13:23:14.380

编写线程安全的无锁代码很难；但是[Herb Sutter 的这篇文章](http://www.ddj.com/cpp/210600279)会让你开始。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-09-18T13:42:31.570

正如*sblundy*指出的那样，如果所有对象都是不可变的、只读的，则您无需担心锁定，但这意味着您可能需要大量复制对象。复制通常涉及 malloc 并且 malloc 使用锁定来同步线程之间的内存分配，因此不可变对象可能比您想象的要少（malloc 本身的扩展性很差，而且 malloc 很**慢**；如果您在性能关键部分执行了很多 malloc，请不要不要指望有好的表现）。

当您只需要更新简单变量（例如 32 或 64 位 int 或指针），对它们执行简单的加法或减法运算或只是交换两个变量的值时，大多数平台为此提供“原子操作”（进一步 GCC 提供这些以及）。*Atomic 与 thread-safe 不同*。但是，原子确保，例如，如果一个线程将 64 位值写入内存位置，而另一个线程从中读取，则读取的线程要么在写操作之前或在写操作之后获取值，但绝不会出现*损坏*的值在写入操作之间（例如，前 32 位已经是新值，最后 32 位仍然是旧值！如果您不对此类变量使用原子访问，则可能会发生这种情况）。

但是，如果您有一个想要更新的具有 3 个值的 C 结构，即使您使用原子操作更新所有三个值，这也是三个独立的操作，因此读者可能会看到一个值已被更新而两个未更新的结构更新。如果您必须保证，在这里您将需要一个锁，读者要么看到结构中的所有值要么是旧值要么是新值。

使锁的扩展性更好的一种方法是使用 R/W 锁。在许多情况下，对数据的更新很少（写操作），但访问数据却非常频繁（读取数据），想想集合（哈希表、树）。在这种情况下，R/W 锁将为您带来巨大的性能提升，因为许多线程可以同时持有一个读锁（它们不会相互阻塞），并且只有当一个线程想要写锁时，所有其他线程在执行更新时被阻止。

避免线程问题的最佳方法是不跨线程共享任何数据。如果每个线程大部分时间都处理其他线程无法访问的数据，那么您根本不需要锁定该数据（也不需要原子操作）。所以尽量在线程之间共享尽可能少的数据。然后，如果确实需要，您只需要一种快速的方法在线程之间移动数据（ITC，线程间通信）。根据您的操作系统、平台和编程语言（不幸的是，您都没有告诉我们这些），可能存在各种强大的 ITC 方法。

最后，另一个使用共享数据但没有任何锁定的技巧是确保线程不会访问共享数据的相同部分。例如，如果两个线程共享一个数组，但一个只会访问偶数，另一个只会访问奇数索引，则不需要锁定。或者如果两者共享同一个内存块并且一个只使用它的上半部分，另一个只使用下半部分，则不需要锁定。虽然没有说这会带来良好的性能；尤其是在多核 CPU 上。一个线程对该共享数据的写入操作（运行一个内核）可能会强制为另一个线程（运行在另一个内核上）刷新缓存，并且这些缓存刷新通常是在现代多核 CPU 上运行的多线程应用程序的瓶颈。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-04-09T08:47:46.387

正如我的教授（来自“多处理器编程艺术”的 Nir ​​Shavit）告诉全班同学：请不要。主要原因是可测试性——你不能测试同步代码。您可以运行模拟，甚至可以进行压力测试。但它充其量只是粗略的近似。你真正需要的是数学正确性证明。很少有人能够理解它们，更不用说写它们了。因此，正如其他人所说：使用现有的库。[Joe Duffy 的博客](http://www.bluebytesoftware.com/blog/2006/10/26/ConcurrencyAndTheImpactOnReusableLibraries.aspx)调查了一些技术（第 28 节）。您应该尝试的第一个是树拆分 - 分解为较小的任务并合并。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-09-18T13:24:32.987

不变性是避免锁定的一种方法。请参阅[Eric Lippert 对](http://blogs.msdn.com/ericlippert/archive/tags/Immutability/default.aspx)不可变堆栈和队列等事物的讨论和实现。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-04-09T07:50:45.277

在重新。Suma 的回答，Maurice Herlithy 在多处理器编程的艺术中表明，实际上*任何东西都*可以在没有锁的情况下编写（参见第 6 章）。iirc，这本质上涉及将任务拆分为处理节点元素（如函数闭包），并将每个元素加入队列。线程将通过跟踪最新缓存节点中的所有节点来计算状态。显然，在最坏的情况下，这可能会导致顺序性能，但它确实具有重要的无锁属性，可以防止线程在持有锁时可能被长时间调度的情况。Herlithy 还实现了理论上的无等待性能，这意味着一个线程不会永远等待来赢得原子队列（这是很多复杂的代码）。

多线程队列/堆栈非常困难（检查[ABA 问题](http://www.research.ibm.com/people/m/michael/RC23089.pdf)）。其他的事情可能很简单。习惯 while(true) { atomicCAS until I swaped it } 块；他们非常强大。对 CAS 正确性的直觉可以帮助开发，尽管您应该使用良好的测试和更强大的工具（可能是[SKETCH](http://sketch.cs.berkeley.edu/)、即将推出的 MIT [Kendo](http://projects.csail.mit.edu/kendo/)或[spin](http://spinroot.com/spin/whatispin.html)？）来检查正确性，如果您可以将其简化为一个简单的结构。

请发布更多关于您的问题的信息。没有细节很难给出一个好的答案。

**编辑**不变性很好，但如果我理解正确的话，它的适用性是有限的。它并没有真正克服读后写的危险。考虑两个线程执行“mem = NewNode(mem)”；他们都可以读取内存，然后都可以写入；不适合经典的增量函数。此外，由于堆分配（必须跨线程同步），它可能很慢。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-09-18T13:21:51.480

不变性会产生这种效果。对对象的更改会产生一个新对象。Lisp 在幕后以这种方式工作。

[Effective Java](https://rads.stackoverflow.com/amzn/click/com/0321356683)的第 13 项解释了这种技术。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-09-18T13:37:33.423

Cliff Click 利用有限状态机对无锁数据结构进行了一些主要研究，并发布了许多 Java 实现。您可以在他的博客上找到他的论文、幻灯片和实现：http: [//blogs.azulsystems.com/cliff/](http://blogs.azulsystems.com/cliff/)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-18T15:30:25.057

使用现有的实现，因为这个工作领域是领域专家和博士的领域（如果你想把它做好！）

例如这里有一个代码库：

[http://www.cl.cam.ac.uk/research/srg/netos/lock-free/](http://www.cl.cam.ac.uk/research/srg/netos/lock-free/)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-18T13:28:31.497

无锁同步的基本原理是这样的：

*   每当您阅读结构时，您都会在阅读后进行测试，以查看自开始阅读以来结构是否发生了突变，然后重试直到您成功阅读，而在您这样做时没有其他东西出现并发生突变；

*   每当你改变结构时，你安排你的算法和数据，以便有一个原子步骤，如果采取这个步骤，会导致整个更改对其他线程可见，并安排事情以使任何更改都不可见，除非迈出了这一步。您可以使用平台上存在的任何无锁原子机制来执行该步骤（例如，比较和设置、加载链接+条件存储等）。在该步骤中，您必须检查自突变操作开始以来是否有任何其他线程对对象进行了突变，如果没有则提交，如果有则重新开始。

网络上有很多无锁结构的例子；在不了解您正在实施的内容以及在哪个平台上的情况下，很难更具体。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-18T13:32:44.607

大多数无锁算法或结构都是从一些原子操作开始的，即，一旦由一个线程开始，对某个内存位置的更改将在任何其他线程可以执行相同的操作之前完成。你的环境中有这样的操作吗？

有关此主题的规范论文，请参见[此处](http://erdani.org/publications/cuj-2004-10.pdf)。

也可以试试这个[维基百科文章](http://en.wikipedia.org/wiki/Lock-free_and_wait-free_algorithms)以获得更多的想法和链接。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-18T15:24:40.187

如果您正在为多核 cpu 编写自己的无锁数据结构，请不要忘记内存屏障！此外，考虑研究[软件事务内存](http://en.wikipedia.org/wiki/Software_transactional_memory)技术。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-18T13:22:27.017

好吧，这取决于结构的类型，但是您必须制作结构，以便它可以仔细、静默地检测和处理可能的冲突。

我怀疑你可以制作一个 100% 无锁的，但同样，这取决于你需要构建什么样的结构。

您可能还需要对结构进行分片，以便多个线程处理单个项目，然后再进行同步/重组。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-18T13:24:03.613

如前所述，这实际上取决于您正在谈论的结构类型。例如，您可以编写一个有限的无锁队列，但不能编写一个允许随机访问的队列。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-18T13:26:43.200

减少或消除共享的可变状态。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-18T14:42:38.650

在 Java 中，使用 JDK 5+ 中的 java.util.concurrent 包，而不是自己编写。如上所述，这确实是专家的领域，除非您有一两年的空闲时间，否则无法自己动手。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-18T16:06:30.180

你能澄清一下你所说的结构是什么意思吗？

现在，我假设您的意思是整体架构。您可以通过不在进程之间共享内存并为您的进程使用参与者模型来实现它。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-20T02:26:12.280

查看我的[链接 ConcurrentLinkedHashMap](http://code.google.com/p/concurrentlinkedhashmap/)，了解如何编写无锁数据结构的示例。它不是基于任何学术论文，也不需要像其他人暗示的那样需要多年的研究。它只需要仔细的工程。

我的实现确实使用了 ConcurrentHashMap，这是一个每桶锁算法，但它不依赖于该实现细节。它可以很容易地被 Cliff Click 的无锁实现所取代。我从 Cliff 那里借用了一个想法，但使用得更明确，即使用状态机对所有 CAS 操作进行建模。这极大地简化了模型，您会看到我通过 'ing 状态拥有伪锁。另一个技巧是根据需要允许懒惰和解决。通过回溯或让其他线程“帮助”清理，您会经常看到这一点。就我而言，我决定允许列表上的死节点在到达头部时被驱逐，而不是处理从列表中间删除它们的复杂性。我可以改变这一点，但我没有

“多处理器编程的艺术”一书是一本很好的入门书。不过，总的来说，我建议在应用程序代码中避免使用无锁设计。通常，在其他更不容易出错的技术更适合的情况下，这只是矫枉过正。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-04-09T08:02:17.260

如果您看到锁争用，我会首先尝试在您的数据结构上使用更细粒度的锁，而不是完全无锁的算法。

例如，我目前正在研究多线程应用程序，它有一个自定义消息传递系统（每个线程的队列列表，队列包含线程要处理的消息）来在线程之间传递信息。这个结构有一个全局锁。就我而言，我不需要这么多的速度，所以这并不重要。但是，如果这个锁会成为一个问题，例如，它可以被每个队列上的单独锁替换。然后在特定队列中添加/删除元素不会影响其他队列。仍然会有一个用于添加新队列等的全局锁，但不会有太多的竞争。

即使是单个多生产者/消费者队列也可以在每个元素上使用粒度锁定来编写，而不是使用全局锁定。这也可以消除争用。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2010-11-11T18:38:30.107

如果您阅读有关该主题的几个实现和论文，您会注意到有以下共同主题：

1)**共享状态对象是 lisp/clojure 风格的不可变对象**：也就是说，所有写操作都是在新对象中复制现有状态，对新对象进行修改，然后尝试更新共享状态（从对齐指针获得可以使用 CAS 原语进行更新）。换句话说，您永远不会修改可能被超过当前线程读取的现有对象。对于大而复杂的对象，可以使用 Copy-on-Write 语义来优化不变性，但那是另一棵坚果树

2）**您清楚地指定当前和下一个状态之间允许的转换是有效**的：然后验证算法是否有效变得容易几个数量级

3)**处理每个线程的危险指针列表中丢弃的引用**。引用对象安全后，尽可能重用

请参阅我的另一篇相关文章，其中一些使用信号量和互斥锁实现的代码（部分）以无锁样式重新实现： [互斥和信号量](https://stackoverflow.com/questions/3850491/mutual-exclusion-and-semaphores/3882976#3882976)

# java - 在 Java 中使用 openssl 加密

> ID：92456
> 
> 赞同：6
> 
> 时间：2008-09-18T13:19:02.767
> 
> 标签：java, encryption, openssl

我有一个遗留 C++ 模块，它使用 openssl 库（DES 加密）提供加密/解密。我正在尝试将该代码翻译成 java，并且我不想依赖 DLL、JNI 等... C++ 代码如下所示：

```
des_string_to_key(reinterpret_cast<const char *>(key1), &initkey);
des_string_to_key(reinterpret_cast<const char *>(key2), &key);
key_sched(&key, ks);
// ...
des_ncbc_encrypt(reinterpret_cast<const unsigned char *>(tmp.c_str()), 
reinterpret_cast< unsigned char *>(encrypted_buffer), tmp.length(), ks, &initkey, 
DES_ENCRYPT);

return base64(reinterpret_cast<const unsigned char *>(encrypted_buffer),    strlen(encrypted_buffer)); 
```

Java 代码如下所示：

```
Cipher ecipher;
try {
    ecipher = Cipher.getInstance("DES");
    SecretKeySpec keySpec = new SecretKeySpec(key, "DES");      
    ecipher.init(Cipher.ENCRYPT_MODE, keySpec);         
    byte[] utf8 = password.getBytes("UTF8");
    byte[] enc = ecipher.doFinal(utf8);
    return new sun.misc.BASE64Encoder().encode(enc);
}
catch {
    // ...
} 
```

所以我可以很容易地在 Java 中进行 DES 加密，但是如何使用完全不同的方法获得与上述代码相同的结果呢？特别困扰我的是，C++ 版本使用 2 个密钥，而 Java 版本只使用 1 个密钥。关于 CBC 模式下的 DES 的答案非常令人满意，但我还不能让它工作。以下是有关原始代码的更多详细信息： unsigned char key1[10]= {0}; 无符号字符 key2[50]= {0};

```
int i;
for (i=0;i<8;i++)
    key1[i] = 31+int((i*sqrt((double)i*5)))%100;
key1[9]=0;

for (i=0;i<48;i++)
    key2[i] = 31+int((i*i*sqrt((double)i*2)))%100;
key2[49]=0;
...
// Initialize encrypted buffer
memset(encrypted_buffer, 0, sizeof(encrypted_buffer));

// Add begin Text and End Text to the encrypted message
std::string input;
const char beginText = 2;
const char endText = 3;
input.append(1,beginText);
input.append(bufferToEncrypt);
input.append(1,endText);    

// Add padding
tmp.assign(desPad(input));

des_ncbc_encrypt(reinterpret_cast<const unsigned char *>(tmp.c_str()),     
reinterpret_cast< unsigned char *>(encrypted_buffer), tmp.length(), ks, &initkey, 
DES_ENCRYPT);
... 
```

根据我的阅读，密钥应该是 56（或 64，我不清楚）位长，但这里是 48 字节长。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T14:16:35.420

我不是 OpenSSL 专家，但我猜 C++ 代码在 CBC 模式下使用 DES，因此需要一个 IV（这可能是 initKey，这就是为什么你认为你需要两个密钥）。如果我是对的，您也需要更改 Java 代码以在 CBC 模式下使用 DES，那么 Java 代码也将需要加密密钥和 IV。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T14:39:00.233

另外，请记住，您真的不应该在代码中使用 sun.misc.* 类。这可能会破坏其他 VM，因为它们不是公共 API。Apache Commons Codecs（以及其他）具有不存在此问题的 Base64 实现。

我不太确定为什么单个 DES 会使用多个密钥。即使您使用的是 Triple-DES，我相信您也会使用单个密钥（具有更多字节的数据），而不是使用 Java Cryptography API 的单独密钥。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T13:32:05.747

算法应该匹配；如果您得到不同的结果，则可能与您处理键和文本的方式有关。还要记住，Java 字符是 2 个字节长，而 C++ 字符是 1 个字节，所以这可能与它有关。

# perl - Perl::Critic: Moose 之后的生活？

> ID：92465
> 
> 赞同：18
> 
> 时间：2008-09-18T13:21:12.590
> 
> 标签：perl, moose, perl-critic, perl-tidy

我已经开始将一个项目转换为 Moose，我注意到的第一件事是我的批评/整洁测试陷入困境。Moose、Tidy 和 Critic 似乎不像以前那么喜欢彼此了。

是否有关于如何让评论家/整洁者更欣赏驼鹿方言的文档？大多数 Moose 用户都做什么？为更重的 Moose 模块放松/放弃评论家？自定义政策？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-21T21:45:02.753

你见过[Perl::Critic::Moose](http://search.cpan.org/dist/Perl-Critic-Moose)吗？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-18T13:34:50.607

两者都可以进行详细配置。

我不知道为什么 perltidy 不喜欢它，**它与它无关**。Perltidy 只控制风格。您可以在不更改任何功能的情况下更改代码的样式，这实际上主要是空格问题。您应该更改样式或使用 .perltidyrc 文件更改 perltidy 配置。

我不知道 perlcritic 有什么问题（也许是左值方法？），但您可以考虑使用 .perlcriticrc 文件关闭这些特定策略。此外，如果你的 perlcritic 是旧的，你可能想要升级它，因为一些旧版本在 Moose 类中给出了一些不正确的错误。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-19T13:02:29.043

早期版本的 Perl::Critic 的“使用严格”策略不知道 Moose 会为您启用严格，但如果您升级 Perl::Critic，这将得到修复。

我将 Perl::Critic 和 Perl::Tidy 与 Moose 一起使用，我没有看到任何特别损坏的东西。好吧，实际上，我无法让 Perl::Tidy 正确布局这样的东西：

```
my $apple = Apple->new({
    color => "red",
    type  => "delicious",
}); 
```

Tidy 会坚持认为 ( 和 { 是缩进的两个开头级别，它看起来很傻：

```
my $apple = Apple->new({
        color => "red",
        type  => "delicious",
}); 
```

但是我们以前遇到过这个问题；项目中的编码约定是对命名参数使用 hashref，而不是 hash。因此，这并不是真正与 Moose 相关的问题。

你的具体症状是什么？

/J

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T13:47:11.077

我对 Critic 测试没有任何问题 - 诚然，我以 Severity=3 运行，至少部分原因是我必须处理的一些遗留代码是我没有 /time/ 来整理的，但是我的 Moose 东西可以通过那。

# tfs - 应该怎么做才能使 TFS 为事件发送电子邮件？

> ID：92467
> 
> 赞同：2
> 
> 时间：2008-09-18T13:21:16.537
> 
> 标签：tfs

我们的 Tfs 服务器（Tfs2008）安装了 smtp 服务器。但是我们不能让 Tfs 在事件发生后向订阅者发送电子邮件（我们正在使用[EventSubscriptionTool](http://www.codeplex.com/tfseventsubscription)）。

我们的 appsettings 包括以下几行：

```
<add key="emailNotificationFromAddress" value="tfs@mail.com" />
<add key="smtpServer" value="localhost" /> 
```

这个任务还有其他技巧吗...？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T14:09:19.930

您听起来好像已修复公共部分 - 在 %ProgramFile%\Microsoft Visual Studio 2008 Team Foundation Server\Web Services\Services 中的 web.config 中设置适当的 appSettings。

Pete Sheill 的以下帖子可能会帮助您调试问题所在。

*   [http://blogs.msdn.com/psheill/archive/2005/11/28/497662.aspx](http://blogs.msdn.com/psheill/archive/2005/11/28/497662.aspx)

它是在考虑 TFS2005 的情况下编写的，但是如果您在 2008 的路径中替换 2005，您将了解要点。

祝你好运，

马丁。

# javascript - 如何在 Cocoa/WebKit 应用程序中从 Javascript 调用 Objective-C 方法？

> ID：92471
> 
> 赞同：12
> 
> 时间：2008-09-18T13:21:33.480
> 
> 标签：javascript, objective-c, cocoa, webkit

我有一个使用 WebView 来显示 HTML 界面的 Cocoa 应用程序。我将如何从 HTML 界面中的 Javascript 函数调用 Objective-C 方法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-18T13:23:57.530

这记录在[developer.apple.com](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/DisplayWebContent/Tasks/JavaScriptFromObjC.html)上。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-05-26T19:35:01.393

Apple 的文档比较环保，对我来说非常不可用，所以我做了一个概念证明，即在 Cocoa 中从 javascript 调用 Objective C 方法，反之亦然，尽管后者更容易。

首先确保你有你的 webview 作为 setFrameLoadDelegate：

```
[testWinWebView setFrameLoadDelegate:self]; 
```

您需要告诉 webview 在加载后立即监视特定对象：

```
- (void)webView:(WebView *)sender didClearWindowObject:(WebScriptObject *)windowScriptObject forFrame:(WebFrame *)frame {
    //add the controller to the script environment
    //the "ObjCConnector" object will now be available to JavaScript
    [windowScriptObject setValue:self forKey:@"ObjCConnector"];
} 
```

然后是通信业务：

```
// a few methods to log activity
- (void)acceptJavaScriptFunctionOne:(NSString*) logText {
    NSLog(@"acceptJavaScriptFunctionOne: %@",logText);
}
- (void)acceptJavaScriptFunctionTwo:(NSString*) logText {
    NSLog(@"acceptJavaScriptFunctionTwo: %@",logText);
}

//this returns a nice name for the method in the JavaScript environment
+(NSString*)webScriptNameForSelector:(SEL)sel {
    NSLog(@"%@ received %@ with sel='%@'", self, NSStringFromSelector(_cmd), NSStringFromSelector(sel));
    if(sel == @selector(acceptJavaScriptFunctionOne:))
        return @"functionOne"; // this is what you're sending in from JS to map to above line
    if(sel == @selector(acceptJavaScriptFunctionTwo:))
        return @"functionTwo"; // this is what you're sending in from JS to map to above line
    return nil;
}

//this allows JavaScript to call the -logJavaScriptString: method
+ (BOOL)isSelectorExcludedFromWebScript:(SEL)sel {
    NSLog(@"isSelectorExcludedFromWebScript: %@", NSStringFromSelector(sel));
    if(sel == @selector(acceptJavaScriptFunctionOne:) ||
       sel == @selector(acceptJavaScriptFunctionTwo:))
        return NO;
    return YES;
} 
```

关键是，如果您有多个要调用的方法，则需要将它们全部排除在 isSelectorExcludedFromWebScript 方法中，并且需要通过 javascript 调用映射到 webScriptNameForSelector 中的 ObjC 方法。

完整的项目概念证明文件： [https ://github.com/bytestudios/JS-function-and-ObjC-method-connector](https://github.com/bytestudios/JS-function-and-ObjC-method-connector)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-09-13T19:43:06.023

如果您想在 iPhone 应用程序中执行此操作，则需要使用 UIWebViewDelegate 方法 shouldStartLoadWithRequest 做一个技巧：

这个 api [http://code.google.com/p/jsbridge-to-cocoa/](http://code.google.com/p/jsbridge-to-cocoa/)为你做。它非常轻巧。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-18T09:41:24.487

我有一个使用 NimbleKit 的解决方案。它可以从 Javascript 调用 Objective C 函数。

# java - 在 Java 中不考虑周末和银行假日的经过时间

> ID：92475
> 
> 赞同：1
> 
> 时间：2008-09-18T13:21:44.757
> 
> 标签：java, date, time, stopwatch, elapsed

我已经实现了一个运行良好的秒表，而没有考虑到银行假期和周末不应计入总持续时间。我一直在寻找一些开源库，我可以在其中获取经过的时间，传递开始瞬间、结束瞬间和一组银行假期（周末不计算在内）。唯一让我更轻松的库是 net.sf.jtemporal，但我仍然需要扩展功能。谁能告诉我是否有一些有用的库来获得想要的功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T13:41:54.833

正如我在[那里](https://stackoverflow.com/questions/80541/given-two-dates-what-is-the-best-way-of-finding-the-number-of-weekdays-in-php#80627)提到的，可能最好和最简单的方法是创建一个包含每天信息的表（从开始/银行假期开始的工作日计数等；每天一行 = 每年 365 行），然后只使用计数功能/ 适当的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T13:54:22.510

我怀疑你能找到特定的东西。但是创建自己的逻辑很容易。这是一些伪代码...

```
private long CalculateTimeSpan(DateTime BeginDate, DateTime EndDate, ArrayList<DateTime> BankHollidays)
{
    long ticks = 0;
    while (BeginDate <= EndDate) // iterate until reaching end
    {
        if ((BeginDate is holliday?) || (BeginDate is Weekend?))
             skip;
        else
             ticks += (24*60*60*1000);

        BeginDate = BeginDate + 1 day; // add one day and iterate
    }

    return ticks;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T13:28:39.937

你也只计算银行营业时间吗？上午 9 点到下午 3 点？还是一天24小时？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T13:57:29.070

你应该看看[Joda Time](http://joda-time.sourceforge.net/)。它是一种比 Java 中包含的更好的日期/时间 API

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-26T08:54:31.687

我认为这将是您正在寻找的有效解决方案。它计算经过的时间（考虑到一个工作日有 24 小时），不计算银行假日和周末：

```
/**
 * Calculate elapsed time in milliseconds
 * 
 * @param startTime
 * @param endTime
 * @return elapsed time in milliseconds
 */

protected long calculateElapsedTimeAux(long startTime, long endTime) { 
    CustomizedGregorianCalendar calStartTime = new CustomizedGregorianCalendar(this.getTimeZone());
    CustomizedGregorianCalendar calEndTime = new CustomizedGregorianCalendar(this.getTimeZone());
    calStartTime.setTimeInMillis(startTime);
    calEndTime.setTimeInMillis(endTime);
    long ticks = 0;

    while (calStartTime.before(calEndTime)) { // iterate until reaching end 
        ticks = ticks + increaseElapsedTime(calStartTime, calEndTime);
    }

    return ticks;
}

private long increaseElapsedTime(CustomizedGregorianCalendar calStartTime, CustomizedGregorianCalendar calEndTime) {
    long interval;
    long ticks = 0;

    interval = HOURS_PER_DAY*MINUTES_PER_HOUR*SECONDS_PER_MIN*MILLISECONDS_PER_SEC; // Interval of one day

    if ( calEndTime.getTimeInMillis() - calStartTime.getTimeInMillis() < interval) {
        interval = calEndTime.getTimeInMillis() - calStartTime.getTimeInMillis();
    }

    ticks = increaseElapsedTimeAux(calStartTime, calEndTime, interval);
    calStartTime.setTimeInMillis(calStartTime.getTimeInMillis() + interval);

    return ticks;
}

protected long increaseElapsedTimeAux(CustomizedGregorianCalendar calStartTime, CustomizedGregorianCalendar calEndTime, long interval) {
    long ticks = 0;

    CustomizedGregorianCalendar calNextStartTime = new CustomizedGregorianCalendar(this.getTimeZone());
    calNextStartTime.setTimeInMillis(calStartTime.getTimeInMillis() + interval);

    if ( (calStartTime.isWorkingDay(_nonWorkingDays) && calNextStartTime.isWorkingDay(_nonWorkingDays)) ) { // calStartTime and calNextStartTime are working days
        ticks = interval;

    }
    else {
        if (calStartTime.isWorkingDay(_nonWorkingDays)) { // calStartTime is a working day and calNextStartTime is a non-working day
            ticks = (calStartTime.getNextDay().getTimeInMillis() - calStartTime.getTimeInMillis());
        }
        else {
            if (calNextStartTime.isWorkingDay(_nonWorkingDays)) { // calStartTime is a non-working day and calNextStartTime is a working day
                ticks = (calNextStartTime.getTimeInMillis() - calStartTime.getNextDay().getTimeInMillis());
            }
            else {} // calStartTime and calEndTime are non-working days
        }
    }

    return ticks;
} 
```

# version-control - 在虚拟机上运行 JIRA

> ID：92490
> 
> 赞同：11
> 
> 时间：2008-09-18T13:23:33.693
> 
> 标签：version-control, virtual-machine, jira

任何人在 VM 上运行 Jira 有任何成功或失败吗？

我正在设置一个新的源代码控制和缺陷跟踪服务器。我的服务器机房快满了，我的服务组建议使用虚拟机。我看到一堆人在VM（包括NCSA）上运行SVN。VM 还可以让我摆脱硬件问题并为我提供高可用性。最后，它让我摆脱了一些繁文缛节，并且可以更快地实施。

那么，有人知道为什么我不应该将 Jira 放在 VM 上吗？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-03-11T17:31:22.060

我们刚刚对此进行了研究，这就是我们发现的：

*   如果您计划有少量项目（10-20 个），总共有 1,000 到 5,000 个问题和大约 100-200 个用户，那么具有 256-512MB 可用 RAM 的最新服务器（2.8+GHz CPU）应该可以满足您的需求。需要。
*   如果您计划处理更多的问题和用户，添加更多内存会有所帮助。我们有报告称，为 JIRA 分配 1GB 的 RAM 足以处理 100,000 个问题。
*   作为参考，Atlassian 的 JIRA 站点 ( [http://jira.atlassian.com/](http://jira.atlassian.com/) ) 拥有超过 33,000 个问题和超过 30,000 个用户帐户。该系统在 64 位 Quad 处理器上运行。服务器有 4 GB 内存，其中 1 GB 专用于 JIRA。

对于我们的安装（<10000 个问题，一次 <20 个并发会话），我们使用非常少的服务器资源（<1GB Ram，在四核处理器上运行，我们通常使用 <5%，峰值 <30%），而 VM 没有不会以任何可衡量的数量影响性能。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-18T13:40:57.817

我不明白为什么您不应该在 vm 上运行 jira - 但 jira 需要大量资源，如果您的 vm 驻留在负载很重的机器上，它可能会表现出较差的性能。为什么不记录支持请求 (support.atlassian.com) 并询问？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-13T23:28:19.623

我们在虚拟机上运行 Jira - VMWare 运行 Windows Server 2003 SE 并将数据存储在我们的 SQL Server 2000 服务器上。没问题，效果很好。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-19T23:18:52.510

我的公司最近将我们的 JIRA 实例从托管的物理服务器转移到了 Amazon EC2 实例，一切都保持得很好。我们正在使用一个 m1.large 实例（64 位操作系统，具有 4 个虚拟内核和 8GB RAM），但这远远超出了我们对 JIRA 的需要；我们还在同一个 EC2 实例上托管 Confluence 和我们的公司网站。

请注意，我们是一个相对较小的装备；到目前为止，我们的 JIRA 实例有 25 个用户（其中​​可能有 15 个处于活动状态）和大约 1000 个 JIRA 问题。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-09T22:32:55.857

我们在基于 Linux 的 VM 实例上运行 JIRA（和其他 Atlassian 应用程序）实例。一切都运行得很好。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-08T21:28:44.613

在 VM 上使用 JIRA 的磁盘访问速度...

[http://confluence.atlassian.com/display/JIRA/Testing+Disk+Access+Speed](http://confluence.atlassian.com/display/JIRA/Testing+Disk+Access+Speed)

我想知道使用 JIRA 和 VM（Chris Latta）的人是否在下面运行 ESX——这可能比 Windows 主机更快。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-02T00:04:41.717

我已经设法从一组虚拟机上运行 Jira、Bamboo 和 FishEye，这些虚拟机都托管在同一台服务器上。尽管我不建议在大多数商店中将这种设置用于生产。按照今天的标准，Jira 的要求相当低。只要确保您可以从您的主机中允许足够的资源，事情应该可以正常运行。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-18T13:45:27.383

如果您所说的 VM 是指操作系统的虚拟实例，例如在 Xen、VMWare 甚至 Amazon EC2 上运行的 linux 实例，那么 Jira 可以正常运行。唯一需要担心虚拟系统的情况是，如果您正在做一些依赖于硬件的事情，例如运行图形 3D 应用程序，或者说一些使用传真调制解调器或带有 Asterisk 的 Digium 电话卡的事情。

# tomcat - Tomcat 6 的强 SSL

> ID：92504
> 
> 赞同：3
> 
> 时间：2008-09-18T13:25:43.343
> 
> 标签：tomcat, ssl, aes

我正在尝试创建一个用于 Apache Tomcat 6 的自签名证书。我可以制作的每个证书总是会导致浏览器与 AES-128 连接。客户希望我证明我可以在 AES-256 上创建连接。

我试过java的keytool和openssl。我尝试了各种参数，但似乎无法指定任何关于密钥大小的信息，只是签名大小。

如何获得浏览器-tomcat 连接以使用带有自签名证书的 AES-256？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-18T15:40:36.857

Okie doke，我想我刚刚想通了。

正如我上面所说，关键的知识点是证书无关紧要，只要它是使用支持 AES 256 位加密（例如 RSA）的算法生成的。为了确保我们在同一页面上，为了我的测试，我使用以下内容生成了我的自签名证书：

```
keytool -genkey -alias tomcat -keyalg RSA 
```

现在，您必须确保您的服务器上的 Java 实现支持 AES-256，这是一个棘手的问题。我在 OS X (OS 10.5) 机器上进行了测试，当我查看它默认支持的密码列表时，AES-256 不在列表中，这就是为什么只使用上面生成的证书的原因在我的浏览器和 Tomcat 之间创建 AES-128 连接。（嗯，从技术上讲，TLS_RSA_WITH_AES_256_CBC_SHA 不在列表中——根据[这个 JDK 5 列表](http://java.sun.com/j2se/1.5.0/docs/guide/security/jsse/JSSERefGuide.html#AppA)，这就是你想要的密码。）

为了完整起见，这是我创建的用于检查我的盒子支持的密码的简短 Java 应用程序：

```
import java.util.Arrays;
import javax.net.ssl.SSLSocketFactory;

public class CipherSuites {
  public static void main(String[] args) {
    SSLSocketFactory sslsf = (SSLSocketFactory) SSLSocketFactory.getDefault();
    String[] ciphers = sslsf.getDefaultCipherSuites();
    Arrays.sort(ciphers);
    for (String cipher : ciphers) {
      System.out.println(cipher);
    }
  }
} 
```

事实证明，这个 OS X 机器默认安装的 JDK 5 需要安装“Unlimited Strength Jurisdiction Policy Files”，以便告诉 Java 可以使用更高位的加密级别；您可以[在此处找到这些文件](http://java.sun.com/javase/downloads/index_jdk5.jsp)（向下滚动并查看“其他下载”部分的顶部）。我不确定 JDK 6 是否需要做同样的事情，但是[这里提供](http://java.sun.com/javase/downloads/index.jsp)了 JDK 6 的相同策略文件，所以我认为它确实如此。解压缩该文件，阅读自述文件以了解如何将文件安装到它们所属的位置，然后再次检查您支持的密码......我敢打赌 AES-256 现在在列表中。

If it is, you should be golden; just restart Tomcat, connect to your SSL instance, and I bet you'll now see an AES-256 connection.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T14:34:48.450

danivo，只要服务器的证书能够进行 AES 加密，浏览器和服务器之间的加密级别就与证书本身无关——加密级别是在浏览器和服务器之间协商的。换句话说，我的理解是证书没有指定加密级别，只是加密*类型*（例如，AES）。请参阅[此链接](http://www.trustico.com/material/techpaper_encryption.pdf)(PDF) 以验证这一点，以及证书经销商如何追加销售“支持 256 位”的证书，尽管证书不是决定 256 位功能的因素。

因此，您拥有支持 AES-128 的证书就可以了——他们的关键是弄清楚如何让 Tomcat 支持 AES-256（因为大多数（如果不是全部）主流浏览器肯定支持它）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T14:49:15.750

SSL 连接的强度是在浏览器和服务器（或任何提供 SSL）之间协商的。可能是他们的浏览器要求使用较弱的密码。他们有没有在这个浏览器上看到过 256-AES SSL 连接？AES-128 仍然是一种非常安全的算法，所以除非他们想要保护某些东西免受离线攻击（想想：超级计算机蛮力生成 2^128 密钥[维基百科](http://en.wikipedia.org/wiki/Brute_force_attack)）攻击，否则 128 位应该没问题。如果他们真的需要那么多保护，他们可能应该使用比网站更稳定的数据访问解决方案，到他们的服务器的安全 ssh 隧道是防弹的（你可以告诉他们他们可以拥有 256 位 AES 和 4096 位RSA 也是），或 vpn 取决于实现。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T16:32:18.757

I think what you are looking for is [http://www.sslshopper.com/article-how-to-disable-weak-ciphers-and-ssl-2-in-tomcat.html](http://www.sslshopper.com/article-how-to-disable-weak-ciphers-and-ssl-2-in-tomcat.html) and [http://docs.oracle.com/javase/1.5.0/docs/guide/security/jsse/JSSERefGuide.html#AppA](http://docs.oracle.com/javase/1.5.0/docs/guide/security/jsse/JSSERefGuide.html#AppA)

Depending on whether you want good security and compatibility or PCI certification.

# c# - 如何使用 C# 以编程方式配置 ODBC 数据源

> ID：92514
> 
> 赞同：9
> 
> 时间：2008-09-18T13:27:09.207
> 
> 标签：c#, .net, odbc

有没有办法用 C# 创建一个 ODBC DSN？

也许是 P/invoke？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T13:44:06.827

您可以使用注册表类在注册表中写入 dsn 信息，在

```
HKLM\Software\ODBC\ODBC.INI\ODBC Data Sources 
```

您需要检查 ODBC 驱动程序需要哪些值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-04T16:21:18.503

可以在[此处](https://stackoverflow.com/questions/170466/what-is-the-simplest-most-maintainable-way-to-create-a-sql-server-odbc-data-sou#170490)找到为 SQL Server 创建 ODBC 数据源所需的注册表项和值的示例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T13:30:46.060

以下资源可能会有所帮助：

MSDN：

[如何在 Visual C# .NET 和连接字符串中使用 ODBC .NET 托管提供程序](http://support.microsoft.com/kb/310988)

CodeProject.com

[用 C# 编写的 ODBC（DSN/驱动程序）管理器 DLL](http://www.codeproject.com/KB/database/sdbODBCMngr.aspx)

您可以尝试调用函数：

SQLWriteDSNToIni 和 ConfigDSN（MSDN 链接由于某种原因已失效，请尝试按函数名称搜索）

# c# - 为什么 JSON 中 datetime 的行为在不同系统（win xp，server 2003）上有所不同？

> ID：92515
> 
> 赞同：3
> 
> 时间：2008-09-18T13:27:11.983
> 
> 标签：c#, asp.net, ajax, web-services, json

我的 Web 应用程序分为 WebGui 和 WebService。WebService 负责业务逻辑和数据库处理。从浏览器中的 Javascript 我根据从浏览器输入的日期和时间请求数据。此请求转到 WebGui 中的 .asmx Url，在此函数中调用 Web 服务。

在我的开发系统（windows xp）上，我得到了正确的数据，但是当我在测试系统上安装它时，我必须添加本地时区差异才能获得正确的数据。

例如，我想要日期和时间“21.07.2008 14:27:30”的数据，我必须发送“21.07.2008 16:27:30”。

为什么两个系统上的行为不同，我应该怎么做才能在两个系统上获得相同的行为？

*   Web GUI 在 asp.net 2.0 c# 中
*   Web 服务在 asp.net 1.1 c#

**更新**

由于日期和时间在 JSON 协议中发送为“/Date(1221738803000)/”，因此将日期解释为不同格式是没有问题的。这是解释/忘记时区的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T15:17:21.720

我怀疑这与 .NET 2.0 中引入的 DateTime.Kind 属性有关。默认情况下，它设置为 DateTimeKind.Unspecified，大部分时间与 DateTimeKind.Local 处理相同，因此当日期被序列化时，它将被转换为 UTC。在将 Kind 传递给 Web 服务调用之前，您可以尝试使用 DateTime.SpecifyKind(...) 将 Kind 设置为 DateTimeKind.Utc。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T19:05:28.093

尝试使用 Json.NET 来处理您的序列化。

请注意此处有关序列化格式的注释：

[http://james.newtonking.com/archive/2008/08/25/json-net-3-0-released.aspx](http://james.newtonking.com/archive/2008/08/25/json-net-3-0-released.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-08T22:02:14.367

如果时区无关紧要，请将日期/时间作为格式化字符串传递，这样您就可以确切地知道它的外观，并使用 DateTime.Parse 将其转换为服务器端的 DateTime。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T14:24:35.417

根据服务器的文化设置，日期的解释会有所不同。即给定日期：01.05.2008 en-GB（英国）的文化将日期读取为5月1日，具有en-US文化的系统将其读取为1月5日。

为了解决这个问题，您应该确保日期始终以 UTC 格式 (yyyy-mm-dd) 传输，无论文化如何，都将始终以这种方式解释。

# vb.net - VB.NET 中的 HTTP GET

> ID：92522
> 
> 赞同：46
> 
> 时间：2008-09-18T13:28:21.513
> 
> 标签：vb.net, http-get

在 VB.net 中发出 http get 的最佳方法是什么？我想得到像[http://api.hostip.info/?ip=68.180.206.184这样的请求的结果](http://api.hostip.info/?ip=68.180.206.184)

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2008-09-18T13:31:45.920

在 VB.NET 中：

```
Dim webClient As New System.Net.WebClient
Dim result As String = webClient.DownloadString("http://api.hostip.info/?ip=68.180.206.184") 
```

在 C# 中：

```
System.Net.WebClient webClient = new System.Net.WebClient();
string result = webClient.DownloadString("http://api.hostip.info/?ip=68.180.206.184"); 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-09-18T13:37:26.640

您可以使用 HttpWebRequest 类来执行请求并从给定的 URL 检索响应。你会像这样使用它：

```
Try
    Dim fr As System.Net.HttpWebRequest
    Dim targetURI As New Uri("http://whatever.you.want.to.get/file.html")         

    fr = DirectCast(HttpWebRequest.Create(targetURI), System.Net.HttpWebRequest)
    If (fr.GetResponse().ContentLength > 0) Then
        Dim str As New System.IO.StreamReader(fr.GetResponse().GetResponseStream())
        Response.Write(str.ReadToEnd())
        str.Close(); 
    End If   
Catch ex As System.Net.WebException
   'Error in accessing the resource, handle it
End Try 
```

HttpWebRequest 的详细信息位于：http: [//msdn.microsoft.com/en-us/library/system.net.httpwebrequest.aspx](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.aspx)

第二种选择是使用 WebClient 类，它提供了一个更易于使用的下载 Web 资源的接口，但不如 HttpWebRequest 灵活：

```
Sub Main()
    'Address of URL
    Dim URL As String = http://whatever.com
    ' Get HTML data
    Dim client As WebClient = New WebClient()
    Dim data As Stream = client.OpenRead(URL)
    Dim reader As StreamReader = New StreamReader(data)
    Dim str As String = ""
    str = reader.ReadLine()
    Do While str.Length > 0
        Console.WriteLine(str)
        str = reader.ReadLine()
    Loop
End Sub 
```

有关 webclient 的更多信息，请访问：http: [//msdn.microsoft.com/en-us/library/system.net.webclient.aspx](http://msdn.microsoft.com/en-us/library/system.net.webclient.aspx)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-18T13:32:26.463

使用[WebRequest](https://docs.microsoft.com/en-us/dotnet/api/system.net.webrequest)类

这是为了获取图像：

```
Try
    Dim _WebRequest As System.Net.WebRequest = Nothing
    _WebRequest = System.Net.WebRequest.Create(http://api.hostip.info/?ip=68.180.206.184)
Catch ex As Exception
    Windows.Forms.MessageBox.Show(ex.Message)
    Exit Sub
End Try

Try
    _NormalImage = Image.FromStream(_WebRequest.GetResponse().GetResponseStream())
Catch ex As Exception
    Windows.Forms.MessageBox.Show(ex.Message)
    Exit Sub
End Try 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T13:32:48.037

最简单的方法是`System.Net.WebClient.DownloadFile`或`DownloadString`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T13:29:27.623

您应该尝试[HttpWebRequest](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.aspx)类。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T13:36:09.857

试试这个：

```
WebRequest request = WebRequest.CreateDefault(RequestUrl);
request.Method = "GET";

WebResponse response;
try { response = request.GetResponse(); }
catch (WebException exc) { response = exc.Response; }

if (response == null)
    throw new HttpException((int)HttpStatusCode.NotFound, "The requested url could not be found.");

using(StreamReader reader = new StreamReader(response.GetResponseStream())) {
    string requestedText = reader.ReadToEnd();

    // do what you want with requestedText
} 
```

对不起 C#，我知道你要求 VB，但我没有时间转换。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-05-11T09:24:08.307

```
Public Function getLoginresponce(ByVal email As String, ByVal password As String) As String
    Dim requestUrl As String = "your api"
    Dim request As HttpWebRequest = TryCast(WebRequest.Create(requestUrl), HttpWebRequest)
    Dim response As HttpWebResponse = TryCast(request.GetResponse(), HttpWebResponse)
    Dim dataStream As Stream = response.GetResponseStream()
    Dim reader As New StreamReader(dataStream)
    Dim responseFromServer As String = reader.ReadToEnd()
    Dim result = responseFromServer
    reader.Close()
    response.Close()
    Return result
End Function 
```

# python - Python 模块函数以意想不到的方式使用

> ID：92533
> 
> 赞同：5
> 
> 时间：2008-09-18T13:29:56.983
> 
> 标签：python

基于["Split a string by spaces in Python"](https://stackoverflow.com/questions/6209/split-a-string-ignoring-quoted-sections#6243)，它使用*shlex.split*巧妙地分割带引号的字符串，我有兴趣了解由非显而易见的标准库函数解决的其他常见任务。

如果这变成了[本周的模块](http://www.doughellmann.com/projects/PyMOTW/)，那也很好。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-18T19:08:34.237

I was quite surprised to learn that you could use the bisect module to do a very fast binary search in a sequence. It's documentation doesn't say anything about it:

> This module provides support for maintaining a list in sorted order without having to sort the list after each insertion.

The usage is very simple:

```
>>> import bisect
>>> lst = [4, 7, 10, 23, 25, 100, 103, 201, 333]
>>> bisect.bisect_left(lst, 23)
3 
```

You have to remember though, that it's quicker to linearly look for something in a list goes item by item, than sorting the list and then doing a binary search on it. The first option is O(n), the second is O(nlogn).

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T18:13:28.520

我使用 itertools（尤其是循环、重复、链）使 python 的行为更像 R 和其他函数/向量应用程序。通常这可以让我避免 Numpy 的开销和复杂性。

```
# in R, shorter iterables are automatically cycled
# and all functions "apply" in a "map"-like way over lists
> 0:10 + 0:2
 [1]  0  2  4  3  5  7  6  8 10  9 11 
```

Python #Normal python In [1]: range(10) + range(3) Out[1]: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2]

```
## this code is terrible, but it demos the idea.
from itertools import cycle
def addR(L1,L2):
    n = max( len(L1), len(L2))
    out = [None,]*n
    gen1,gen2 = cycle(L1), cycle(L2)
    ii = 0
    while ii < n:
        out[ii] = gen1.next() + gen2.next()
        ii += 1
    return out

In [21]: addR(range(10), range(3))
Out[21]: [0, 2, 4, 3, 5, 7, 6, 8, 10, 9] 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-18T15:56:57.007

经常被忽视的模块、用途和技巧：

collections.defaultdict()：当您希望字典中缺少的键具有默认值时。

functools.wraps()：用于编写与内省很好的装饰器。

posixpath：POSIX 系统的 os.path 模块。即使在 Windows 和其他非 POSIX 系统上，您也可以使用它来操作 POSIX 路径（包括 URI 元素）。

ntpath：Windows 的 os.path 模块；可用于在非 Windows 系统上操作 Windows 路径。

（还有：macpath，用于 MacOS 9 及更早版本，os2emxpath 用于 OS/2 EMX，但我不确定是否还有人关心。）

pprint：对容器的 repr() 进行更结构化的打印使调试更加容易。

imp：编写自己的插件系统或从任意档案中制作 Python 导入模块所需的所有工具。

rlcompleter：在普通的交互式解释器中获得制表符补全。只需执行“import readline, rlcompleter; readline.parse_and_bind('tab: complete')”

PYTHONSTARTUP 环境变量：可以设置为进入交互式解释器时将执行的文件的路径（在主命名空间中）；对于像上面的 rlcompleter 配方那样放入东西很有用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T13:32:23.843

得知 struct.unpack 后，我发现它是解压二进制数据格式的天赐之物！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T17:11:53.813

[getpass](http://docs.python.org/lib/module-getpass.html)对于确定当前用户的登录名很有用。

[grp](http://docs.python.org/lib/module-grp.html)允许您按名称查找 Unix 组 ID，反之亦然。

[dircache](http://docs.python.org/lib/module-dircache.html)在您反复轮询目录内容的情况下可能很有用。

[glob](http://docs.python.org/lib/module-glob.html)可以像 Unix shell 一样找到匹配通配符的文件名。

[当您需要复制、删除或重命名文件时， shutil](http://docs.python.org/lib/module-shutil.html)很有用。

[csv](http://docs.python.org/lib/module-csv.html)可以简化分隔文本文件的解析。

[optparse](http://docs.python.org/lib/module-optparse.html)提供了一种可靠的方式来解析命令行选项。

[当您需要操作 bzip2 压缩文件时， bz2](http://docs.python.org/lib/module-bz2.html)会派上用场。

[urlparse](http://docs.python.org/lib/module-urlparse.html)将为您省去将 URL 分解为组件部分的麻烦。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T17:58:06.637

大多数其他示例只是被忽略，而不是模块的意外用途。

fnmatch 和 shlex 一样，可以以意想不到的方式应用。fnmatch 是一种穷人的正则表达式，可以用于多个匹配文件，它可以将字符串与简化的通配符模式进行比较。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T15:17:34.183

我发现[sched 模块](http://docs.python.org/lib/module-sched.html)对类似 cron 的活动很有帮助。它简化了很多事情。不幸的是，我发现它为时已晚。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-18T21:20:29.020

我开始欣赏的一个功能是 string.translate。它的工作速度非常快，并且在您想要更改或删除字符串中的字符的任何地方都很有用。我刚刚在一个看似不适用的[问题](https://stackoverflow.com/questions/89909/in-python-how-to-i-verify-that-a-string-only-contains-letters-numbers-underscor#92000)中使用了它，发现它轻松击败了所有其他解决方案。

缺点是它的 API 有点笨拙，但这在 Py2.6 / Py3.0 中有所改进。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-19T05:54:22.763

泡菜模块[非常棒](http://docs.python.org/lib/module-pickle.html)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-19T12:10:20.230

复数。（complexobject.c 定义了一个类，所以从技术上讲它不是一个模块）。非常适合二维坐标，易于平移/旋转等

例如。

```
TURN_LEFT_90= 1j
TURN_RIGHT_90= -1j

coord= 5+4j # x=5 y=4
print coord*TURN_LEFT_90 
```

# java - 从抽象语法树获取控制流图

> ID：92537
> 
> 赞同：15
> 
> 时间：2008-09-18T13:30:45.593
> 
> 标签：java, parsing, abstract-syntax-tree, control-flow

我有一个从 ANTLR Parser Generator for Java 派生的 AST。我想做的是以某种方式构建源代码的控制流图，其中每个语句或表达式都是一个唯一的节点。我知道这个识别肯定有一些递归性，我想知道你会建议什么作为最佳选择，如果 ANTLR 有一个我可以用于这项工作的工具集。干杯，克里斯

* * *

编辑 - 我主要关心的是从 AST 获取控制流图（CFG）。这样我可以获得源的树表示。澄清一下，源代码和实现语言都是 Java。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-18T15:30:36.680

通常 CFG 是在较低级别的表示（例如 JVM 字节码）上计算的。几年前有人就这样的事情做过[论文。](http://www.ssw.uni-linz.ac.at/General/Staff/TW/Wuerthinger06Bachelor.pdf)那里可能有一种有用的方法来描述如何获得该表示。

由于您的源语言和目标语言相同，因此没有代码生成步骤——您已经完成了！但是，现在您可以走 AST。在 AST 的每个节点，你都要问自己：这是不是“跳跃”指令？方法调用和 if 语句是跳转指令的示例。循环结构（例如`for`and `while`）也是如此。加法和乘法等指令是非跳转的。

首先与每个 java 语句关联 CFG 中的一个节点，以及一个入口和出口节点。作为第一个近似值，遍历树并：

1.  如果当前语句是一个方法调用，则找出该方法调用的相应主体的入口节点在哪里，并创建一条从当前语句指向该入口节点的边。如果该语句是一个方法返回，请枚举可能调用它的地方并为这些地方添加一条边。
2.  对于每个非跳跃语句，在它和下一个语句之间划一条边。

这会给你*某种*CFG。该过程在第 2 步中有些繁琐，因为调用的方法可能在库中声明，而不是在 AST 中的其他地方——如果是这样，要么不做边，要么不做边到代表该条目的特殊节点库方法。

这有意义吗？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-17T08:46:18.827

生成一个真正考虑到所有语言问题的完整控制流图比看起来更难。您不仅必须识别看似“基本块”的内容，还必须识别函数调用（有点容易，但识别*目标*可能更难），其中类初始化程序等幕后操作可以发生。并担心可能发生异常的点以及发生异常时控制的去向。

如果您仔细检查大多数语言，他们也会清楚表达式中计算的计算顺序，如果您在表达式中有两个副作用，这很重要；控制流应反映顺序（或非顺序，如果未定义）。

也许您只想要具有基本块和条件的控制流的抽象。这显然要容易一些。

在任何一种情况下（简单 CFG 或完整 CFG），您都需要遍历 AST，在每个点都引用可能的控制流目标（例如，对于大多数情况，例如 IF 语句，有两个流目标：THEN 和ELSE 子句）。在每个节点，将该节点链接到适当的控制流目标，可能会替换流目标（例如，当您遇到 IF 时）。

为 Java（或 C）的完整语言语义做到这一点需要做很多工作。您可能只想使用现成的计算此工具的工具。请参阅[http://www.semanticdesigns.com/Products/DMS/FlowAnalysis.html](http://www.semanticdesigns.com/Products/DMS/FlowAnalysis.html) 了解从我们的工具中出来的真正样子。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T14:11:06.060

根据一些评论，听起来 OP 确实想要进行[代码生成](http://en.wikipedia.org/wiki/Code_generation_%28compiler%29)——将 AST 转换为基于基本块和跳转点的较低级别的指令序列。

代码生成是非常特定于语言的，并且已经在这个主题上投入了大量工作。在进行代码生成之前，您需要了解您的*目标语言*——无论是汇编程序还是其他一些高级语言。一旦你确定了这一点，你只需要遍历 AST 并生成一系列指令来实现 AST 中的代码。（我说这很简单，但可能很难——很难一概而论，因为这里的考虑是非常特定于语言的。）

您为代码生成选择的表示将隐含或显式包含控制流图。如果您的目标语言相当低级（接近汇编程序），那么控制流图应该相对容易提取。

（如果您需要更多说明，请发表评论。）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-09-18T13:35:29.327

你试过[ANTLR Studio](http://placidsystems.com/screenshots.aspx)吗？它不会生成空洞 AST 图，但对于复习来说，它已经很有帮助了。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-09-18T13:51:54.623

当我过去这样做时，我使用[graphviz](http://www.graphviz.org/)，特别是 dot 工具来生成图形。我通过在编译时实际遍历控制流图来创建点输入文件。

图形布局是一个*难题*，graphviz 做得很好。它可以输出为 ps、pdf 和各种图像格式，并且布局通常非常直观。我强烈推荐它。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2018-08-31T03:15:16.063

我认为我无法以您可能正在寻找的方式回答您的问题，因为我不知道在 ANTLR 中以任何方式生成带有或不带有 AST 的 CFG。但是，简而言之，您将使用 ANTLR 生成的内容来生成单独的 Java 程序来生成 CFG。您将利用 ANTLR 生成的语法树作为输入，在您自己创建的单独 Java 程序中生成 CFG。此时，您实质上是在构建编译器。“编译器”和 JVM 之间的区别在于，您的输出是程序如何分支其各种执行路径的可视化表示 (CFG)，而 JVM/Java 编译器生成用于在真实机器 (CPU) 上执行的代码。

一个类比是，如果有人坐下来写一本书（例如用英语），句子中使用的单个单词是计算机语言的 TOKENS，句子的形成方式与上下文无关语法表达有效的计算机代码和段落相似。整个小说以类似的方式讲述一个故事，语义分析/编译器/CFG 可能会产生/表示逻辑上有效的程序，这些程序实际上会做一些有用的事情并且或多或少没有逻辑错误。换句话说，一旦你解决了有效句法（正确的句子结构）的问题，任何人都可以在一个页面上写一堆句子，但只有某些句子组合才能产生实际做某事的文本（讲一个故事）。

您要问的是最后一块 - 如何着手获取语法树并转换或解释 AST 在逻辑上实际执行的操作。当然，您需要为每种要执行此操作的语言构建一个“编译器”。拥有正确的语法并不能告诉您程序做*了什么*——只是从语法的角度来看程序是正确的。

Linter、语法高亮器和 IDE 都是围绕着试图让这最后一块拼图成为人类更容易和更有效的任务的想法而构建的。

# linq-to-objects - 可查询的 对于性能优于 O(n) 的对象？

> ID：92539
> 
> 赞同：4
> 
> 时间：2008-09-18T13:30:51.303
> 
> 标签：linq-to-objects, iqueryable

是否有任何用于 linq-to-objects 的 IQueriable 实现比调用 myEnumerable.AsQueriable() 时获得的默认 O(n) 线性搜索性能更好？

我看过[http://www.codeplex.com/i4o/](http://www.codeplex.com/i4o/)它有更好的性能，但似乎依赖于在 IndexedCollection 上使用扩展方法，而不是让 IndexedColleciton 实现 IQueriable。

我很想保持我的界面返回 IQueriable<T> 因为我不希望任何人知道他们是在访问缓存还是数据库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T18:55:03.770

你可能想看看 plinq [http://msdn.microsoft.com/en-us/magazine/cc163329.aspx](http://msdn.microsoft.com/en-us/magazine/cc163329.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T13:49:50.040

另一个答案可能是通过内存对象数据库来支持它，例如：[db4o](http://www.db4o.com/s/linqdb.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-02T09:26:43.463

本质上，对非索引资源（例如列表或 IEnumerable）的任何查询最多只能是 O(n)，因为它必须遍历列表中的每个项目以检查条件。为了获得比 O(n) 更好的性能，您需要考虑以某种形式对数据进行索引。

正如您所提到的，您可能希望查看一个库来结束创建这些索引，特别是如果您只想公开 IQueryable。

如果您对一种更手动的方式来查找具有更好性能的数据感兴趣，那么我建议您查看字典以通过键进行有效查找，或者如果您需要进行范围查询，则可能使用 b-trees。如果您对背后的理论感兴趣，[这里有一篇关于数据结构（包括 b 树）的精彩 MSDN帖子。](http://msdn.microsoft.com/en-US/library/ms379572%28v=vs.80%29.aspx)此外，[NGenerics](http://code.google.com/p/ngenerics/)可能是一个值得关注的有趣项目。

# .net - 保存和恢复表格位置和大小

> ID：92540
> 
> 赞同：12
> 
> 时间：2008-09-18T13:31:01.083
> 
> 标签：.net, winforms, configuration, settings

在 WinForms 2.0 C# 应用程序中，用于在应用程序中保存和恢复表单位置和大小的典型方法是什么？

相关，是否可以在运行时添加新的用户范围的应用程序设置？我完全了解如何在设计时添加设置，这不是问题。但是如果我想在运行时创建一个呢？

更多细节：

我的应用程序是现有 Visual FoxPro 应用程序的转换。我一直在尝试尽可能多地阅读有关应用程序设置、用户设置等的内容，并让自己清楚地了解 .Net 的做事方式，但我仍然对一些事情感到困惑。

在 Fox 应用程序中，保存的设置存储在注册表中。我的表单是子类的，并且我有基类代码，可以自动将表单位置和大小保存在注册表中，并键入表单名称。每当我创建一个新表单时，我不需要做任何特别的事情来获得这种行为；它内置在基类中。我的 .Net 表单也是子类化的，这部分运行良好。

在.Net 中，我得到的印象是我应该使用用户范围的设置来处理用户偏好之类的事情。表单的大小和位置绝对看起来像是用户偏好。但是，我看不到任何将这些设置自动添加到项目中的方法。换句话说，每次我在我的项目中添加一个新表单（并且它们是 100 个表单）时，我必须记住添加一个用户范围的应用程序设置，并确保给它提供与表单相同的名称，即“ FormMySpecialSizePosition”来保存大小和位置。我宁愿不必记得这样做。这只是运气不好？或者我是否通过尝试使用用户范围的设置来完全吠叫错误的树？我是否需要创建自己的 XML 文件来保存设置，以便我可以做任何我想做的事情（即，在运行时添加新设置）？或者是其他东西？

当然，这是一种非常普遍的做法，有人可以说出“正确”的做法。提前致谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-25T11:43:39.207

```
private void Form1_Load( object sender, EventArgs e )
{
    // restore location and size of the form on the desktop
    this.DesktopBounds =
        new Rectangle(Properties.Settings.Default.Location,
    Properties.Settings.Default.Size);
    // restore form's window state
    this.WindowState = ( FormWindowState )Enum.Parse(
        typeof(FormWindowState),
        Properties.Settings.Default.WindowState);
}

private void Form1_FormClosing( object sender, FormClosingEventArgs e )
{
    System.Drawing.Rectangle bounds = this.WindowState != FormWindowState.Normal ? this.RestoreBounds : this.DesktopBounds;
    Properties.Settings.Default.Location = bounds.Location;
    Properties.Settings.Default.Size = bounds.Size;
    Properties.Settings.Default.WindowState =
        Enum.GetName(typeof(FormWindowState), this.WindowState);
    // persist location ,size and window state of the form on the desktop
    Properties.Settings.Default.Save();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-02-24T19:06:58.343

实际上，互联网上任何地方都没有一个单一的“有效”解决方案，所以这是我自己的创作：

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Drawing;
using System.Windows.Forms;
using Microsoft.Win32;
using System.ComponentModel;
using System.Security.Cryptography;

namespace nedprod
{
    abstract public class WindowSettings
    {
        private Form form;

        public FormWindowState state;
        public Point location;
        public Size size;

        public WindowSettings(Form _form)
        {
            this.form = _form;
        }
        internal class MD5Sum
        {
            static MD5CryptoServiceProvider engine = new MD5CryptoServiceProvider();
            private byte[] sum = engine.ComputeHash(BitConverter.GetBytes(0));
            public MD5Sum() { }
            public MD5Sum(string s)
            {
                for (var i = 0; i < sum.Length; i++)
                    sum[i] = byte.Parse(s.Substring(i * 2, 2), System.Globalization.NumberStyles.HexNumber);
            }
            public void Add(byte[] data)
            {
                byte[] temp = new byte[sum.Length + data.Length];
                var i=0;
                for (; i < sum.Length; i++)
                    temp[i] = sum[i];
                for (; i < temp.Length; i++)
                    temp[i] = data[i - sum.Length];
                sum=engine.ComputeHash(temp);
            }
            public void Add(int data)
            {
                Add(BitConverter.GetBytes(data));
            }
            public void Add(string data)
            {
                Add(Encoding.UTF8.GetBytes(data));
            }
            public static bool operator ==(MD5Sum a, MD5Sum b)
            {
                if (a.sum == b.sum) return true;
                if (a.sum.Length != b.sum.Length) return false;
                for (var i = 0; i < a.sum.Length; i++)
                    if (a.sum[i] != b.sum[i]) return false;
                return true;
            }
            public static bool operator !=(MD5Sum a, MD5Sum b)
            {
                return !(a == b);
            }
            public override bool Equals(object obj)
            {
                try
                {
                    return (bool)(this == (MD5Sum)obj);
                }
                catch
                {
                    return false;
                }
            }
            public override int GetHashCode()
            {
                return ToString().GetHashCode();
            }
            public override string ToString()
            {
                StringBuilder sb = new StringBuilder();
                for (var i = 0; i < sum.Length; i++)
                    sb.Append(sum[i].ToString("x2"));
                return sb.ToString();
            }
        }
        private MD5Sum screenconfig()
        {
            MD5Sum md5=new MD5Sum();
            md5.Add(Screen.AllScreens.Length); // Hash the number of screens
            for(var i=0; i<Screen.AllScreens.Length; i++)
            {
                md5.Add(Screen.AllScreens[i].Bounds.ToString()); // Hash the dimensions of this screen
            }
            return md5;
        }
        public void load()
        {
            using (RegistryKey r = Registry.CurrentUser.OpenSubKey(@"Software\" + CompanyId() + @"\" + AppId() + @"\Window State\" + form.Name))
            {
                if (r != null)
                {
                    try
                    {
                        string _location = (string)r.GetValue("location"), _size = (string)r.GetValue("size");
                        state = (FormWindowState)r.GetValue("state");
                        location = (Point)TypeDescriptor.GetConverter(typeof(Point)).ConvertFromInvariantString(_location);
                        size = (Size)TypeDescriptor.GetConverter(typeof(Size)).ConvertFromInvariantString(_size);

                        // Don't do anything if the screen config has since changed (otherwise windows vanish off the side)
                        if (screenconfig() == new MD5Sum((string) r.GetValue("screenconfig")))
                        {
                            form.Location = location;
                            form.Size = size;
                            // Don't restore if miminised (it's unhelpful as the user misses the fact it's opened)
                            if (state != FormWindowState.Minimized)
                                form.WindowState = state;
                        }
                    }
                    catch (Exception)
                    {
                    }
                }
            }
        }
        public void save()
        {
            state = form.WindowState;
            if (form.WindowState == FormWindowState.Normal)
            {
                size = form.Size;
                location = form.Location;
            }
            else
            {
                size = form.RestoreBounds.Size;
                location = form.RestoreBounds.Location;
            }
            using (RegistryKey r = Registry.CurrentUser.CreateSubKey(@"Software\" + CompanyId()+@"\"+AppId() + @"\Window State\" + form.Name, RegistryKeyPermissionCheck.ReadWriteSubTree))
            {
                r.SetValue("state", (int) state, RegistryValueKind.DWord);
                r.SetValue("location", location.X.ToString() + "," + location.Y.ToString(), RegistryValueKind.String);
                r.SetValue("size", size.Width.ToString()+","+size.Height.ToString(), RegistryValueKind.String);
                r.SetValue("screenconfig", screenconfig().ToString(), RegistryValueKind.String);
            }
        }
        abstract protected string CompanyId();
        abstract protected string AppId();
    }
} 
```

此实现将表单的位置和大小存储在 HKCU/Software/<CompanyId()>/<AppId()>/Window State/<form name> 中。如果显示器配置发生更改，它不会恢复设置，以防止窗口在屏幕外恢复。

显然这不能处理同一表单的多个实例。我还专门禁用了还原最小化，但这是源的简单修复。

上面的内容旨在放入其自己的 .cs 文件中，并且再也不会被触及。您必须像这样实例化一个本地命名空间副本（在 Program.cs 或您的插件主 .cs 文件或任何地方）：

```
namespace <your app/plugin namespace name>
{
    public class WindowSettings : nedprod.WindowSettings
    {
        public WindowSettings(Form form) : base(form) { }
        protected override string CompanyId() { return "<your company name>"; }
        protected override string AppId() { return "<your app name>"; }
    }
    .... 
```

现在您在主命名空间中有一个非抽象实例化。因此，要使用，请将其添加到您要保存和恢复的表单中：

```
 private void IssuesForm_FormClosing(object sender, FormClosingEventArgs e)
    {
        new WindowSettings(this).save();
    }

    private void IssuesForm_Load(object sender, EventArgs e)
    {
        new WindowSettings(this).load();
    } 
```

显然，您可以根据自己的目的随意定制。没有任何明示或暗示的保证。使用风险自负 - 我否认任何版权。

尼尔

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-02-19T18:26:34.670

我从某个地方得到了这段代码，但不幸的是当时（很久以前）没有评论我从哪里得到它。

这会将表单信息保存到用户的 HKCU 注册表中：

```
using System;
using System.Windows.Forms;
using Microsoft.Win32;

/// <summary>Summary description for FormPlacement.</summary>
public class PersistentForm : System.Windows.Forms.Form
{
    private const string DIALOGKEY = "Dialogs";

    /// <summary></summary>
    protected override void OnCreateControl()
    {
        LoadSettings();
        base.OnCreateControl ();
    }

    /// <summary></summary>
    protected override void OnClosing(System.ComponentModel.CancelEventArgs e)
    {
        SaveSettings();
        base.OnClosing(e);
    }

    /// <summary>Saves the form's settings.</summary>
    public void SaveSettings()
    {
        RegistryKey dialogKey = Application.UserAppDataRegistry.CreateSubKey(DIALOGKEY);
        if (dialogKey != null)
        {
            RegistryKey formKey = dialogKey.CreateSubKey(this.GetType().ToString());
            if (formKey != null)
            {
                formKey.SetValue("Left", this.Left);
                formKey.SetValue("Top", this.Top);
                formKey.Close();
            }
            dialogKey.Close();
        }
    }

    /// <summary></summary>
    public void LoadSettings()
    {
        RegistryKey dialogKey = Application.UserAppDataRegistry.OpenSubKey(DIALOGKEY);
        if (dialogKey != null)
        {
            RegistryKey formKey = dialogKey.OpenSubKey(this.GetType().ToString());
            if (formKey != null)
            {
                this.Left = (int)formKey.GetValue("Left");
                this.Top = (int)formKey.GetValue("Top");
                formKey.Close();
            }
            dialogKey.Close();
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-27T11:48:34.953

我只是将它流式传输到一个单独的`XML`文件 - 快速而肮脏，可能不是你想要的：

```
Dim winRect As String() = util.ConfigFile.GetUserConfigInstance().GetValue("appWindow.rect").Split(",")
Dim winState As String = util.ConfigFile.GetUserConfigInstance().GetValue("appWindow.state")

Me.WindowState = FormWindowState.Normal

Me.Left = CType(winRect(0), Integer)
Me.Top = CType(winRect(1), Integer)
Me.Width = CType(winRect(2), Integer)
Me.Height = CType(winRect(3), Integer)

If winState = "maximised" Then
    Me.WindowState = FormWindowState.Maximized
End If 
```

和

```
Dim winState As String = "normal"
If Me.WindowState = FormWindowState.Maximized Then
    winState = "maximised"
ElseIf Me.WindowState = FormWindowState.Minimized Then
    winState = "minimised"
End If

If Me.WindowState = FormWindowState.Normal Then

    Dim winRect As String = CType(Me.Left, String) & "," & CType(Me.Top, String) & "," & CType(Me.Width, String) & "," & CType(Me.Height, String)
    ' only save window rectangle if its not maximised/minimised
    util.ConfigFile.GetUserConfigInstance().SetValue("appWindow.rect", winRect)
End If

util.ConfigFile.GetUserConfigInstance().SetValue("appWindow.state", winState) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T14:45:43.963

You could create a base form class with common functionality such as remembering the position and size and inherit from that base class.

```
public class myForm : Form {
protected override void OnLoad(){
    //load the settings and apply them
    base.OnLoad();
}

protected override void OnClose(){
    //save the settings
    base.OnClose();
}
}
then for the other forms:

public class frmMainScreen : myForm {
// you get the settings for free ;)
}
```

Well, something like that ;)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T14:53:33.100

我和你在同一条船上，因为我有许多表单（在我的例子中是 MDI 子级），我想为每个用户保留位置和大小。根据我的研究，不支持在运行时创建应用程序设置。（请参阅[此博客条目](http://bytes.com/forum/thread479401.html)）但是，您不必将所有内容都粘贴在主设置文件中。您可以将设置文件添加到您的项目（[在 MSDN 中解释](http://msdn.microsoft.com/en-us/library/bb397748.aspx)）并通过 Properties.Settings 对象使用它。这不会减轻必须记住为每个表单创建新设置的痛苦，但至少可以将它们保持在一起，并且不会弄乱您的主要应用程序设置。

至于使用基类来检索设置......我不知道你是否可以在那里做到这一点。我会（并且可能会）做的是命名每个属性，然后使用 Me.GetType().ToString() （我在 VB 中工作）来合成我想要在 Load() 事件中检索的属性的名称每种形式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-09-21T20:57:15.507

这是我使用的代码。

```
private void SaveWindowPosition()
{
    Rectangle rect = (WindowState == FormWindowState.Normal) ?
        new Rectangle(DesktopBounds.Left, DesktopBounds.Top, DesktopBounds.Width, DesktopBounds.Height) :
        new Rectangle(RestoreBounds.Left, RestoreBounds.Top, RestoreBounds.Width, RestoreBounds.Height);
    RegistrySettings.SetSetting("WindowPosition", String.Format("{0},{1},{2},{3},{4}",
        (int)this.WindowState,
        rect.Left, rect.Top, rect.Width, rect.Height));
}

private void RestoreWindowPosition()
{
    try
    {
        string s = RegistrySettings.GetSetting("WindowPosition", String.Empty) as string;
        if (s != null)
        {
            List<int> settings = s.Split(new char[] { ',' }, StringSplitOptions.RemoveEmptyEntries)
                                  .Select(v => int.Parse(v)).ToList();
            if (settings.Count == 5)
            {
                this.SetBounds(
                    settings[1],
                    settings[2],
                    settings[3],
                    settings[4]);
                this.WindowState = (FormWindowState)settings[0];
            }
        }
    }
    catch { /* Just leave current position if error */ }
} 
```

我还在我的文章[保存和恢复窗体的窗口位置](http://www.blackbeltcoder.com/Articles/winforms/saving-and-restoring-a-forms-window-position)中介绍了此代码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-12-17T21:36:51.837

以下是一些相关链接可供查看：

[使用应用程序设置功能保存表单的大小和位置](http://blogs.msdn.com/b/rprabhu/archive/2005/11/28/497792.aspx)

[任何有关如何使用应用程序设置的好例子](http://social.msdn.microsoft.com/forums/en-US/csharpgeneral/thread/5e509b2a-76da-4d91-89b5-9fa8cb50fc8f/)

[探索持久应用程序设置的秘密](http://www.devx.com/dotnet/Article/33944/1954)

# visual-studio-2008 - NUnit 是否适用于 .NET 3.5？

> ID：92541
> 
> 赞同：9
> 
> 时间：2008-09-18T13:31:23.767
> 
> 标签：visual-studio-2008, .net-3.5, nunit

我刚刚开始学习单元测试（以及一般的 TDD）。我的问题是最新版本的 NUnit 是否支持在 VS2008 中使用 .NET 3.5？我查看了 NUnit 的文档页面，但他们没有提及。

如果有人在 3.5 中使用过它，是否有任何限制或功能不起作用/需要变通方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-18T13:32:58.583

我一直在使用 3.5 的 nUnit。只要你有一个适用于 2.0 的版本，你应该没问题 - 相同的 CLR 和所有这些。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T13:35:50.793

是的。

.Net 3.5 主要是重新包装和营销。.Net 3.5 中的 .Net 核心实际上是 .Net 2.0。

因此，您为 .Net 2.0 找到的任何实用程序也可以应用于 .Net 3.5。

对于 NUnit，这意味着 .Net 2 版本是您想要的版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T13:33:42.247

我没有发现任何限制。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-26T16:03:23.460

是的，它确实。

[2.5.5](https://launchpad.net/nunitv2/+announcement/5667)版也适用于 .NET 4.0。

如果您刚刚开始，您应该知道 NUnit 也正在经历一些重大变化。您可以[从新主页](https://launchpad.net/nunit-xtp)看到他们正在使 NUnit 成熟，以包含 .NET 中的一些新功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-26T15:55:40.200

[在http://social.msdn.microsoft.com/forums/en-US/vsdebug/thread/365fd6ef-0fa5-4eeb-b2d5-7c2f795b1f8c?prof=required](http://social.msdn.microsoft.com/forums/en-US/vsdebug/thread/365fd6ef-0fa5-4eeb-b2d5-7c2f795b1f8c?prof=required)检查要遵循的步骤

# c++ - 头文件中的变量声明 - 静态与否？

> ID：92546
> 
> 赞同：93
> 
> 时间：2008-09-18T13:32:05.637
> 
> 标签：c++, c, static

当重构掉一些时，`#defines`我在 C++ 头文件中遇到了类似于以下内容的声明：

```
static const unsigned int VAL = 42;
const unsigned int ANOTHER_VAL = 37; 
```

问题是，静电会产生什么不同（如果有的话）？`#ifndef HEADER` `#define HEADER` `#endif`请注意，由于经典技巧（如果重要的话），不可能多次包含标题。

`VAL`如果标头包含在多个源文件中，静态是否意味着只创建一个副本？

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2008-09-18T15:37:28.627

文件范围变量上的`static`and`extern`标记确定它们是否可在其他翻译单元（即其他`.c`或`.cpp`文件）中访问。

*   `static`提供变量内部链接，将其隐藏在其他翻译单元中。但是，可以在多个翻译单元中定义具有内部链接的变量。

*   `extern`提供变量外部链接，使其对其他翻译单元可见。通常这意味着变量只能在一个翻译单元中定义。

默认值（当您未指定`static`or时`extern`）是 C 和 C++ 不同的领域之一。

*   在 C 中，文件范围的变量`extern`默认为（外部链接）。如果您使用的是 C，`VAL`则 is`static`和`ANOTHER_VAL`is `extern`。

*   在 C++ 中，如果文件范围的变量是，则默认情况下是`static`（内部链接），如果不是`const`，则默认情况下是（内部链接） `extern`。如果您使用 C++，两者`VAL`和`ANOTHER_VAL`都是`static`.

[来自C 规范](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1124.pdf)的草案：

> 6.2.2 标识符的链接 ... -5- 如果函数的标识符声明没有存储类说明符，则其链接被确定为就好像它是使用存储类说明符 extern 声明的一样。如果对象标识符的声明具有文件范围且没有存储类说明符，则其链接是外部的。

[来自C++ 规范](http://www.kuzbass.ru:8086/docs/isocpp/dcl.html)的草案：

> 7.1.1 - 存储类说明符 [dcl.stc] ... -6- 在没有存储类说明符的命名空间范围内声明的名称具有外部链接，除非它由于先前的声明而具有内部链接并且如果它不是声明为常量。声明为 const 且未显式声明为 extern 的对象具有内部链接。

* * *

## 回答 #2

> 赞同：109
> 
> 时间：2008-09-18T13:43:40.133

这`static`意味着将为`VAL`包含它的每个源文件创建一个副本。但这也意味着多个包含不会导致多个定义`VAL`在链接时发生冲突。在 C 中，如果没有 ，`static`您将需要确保仅定义一个源文件`VAL`而其他源文件声明它`extern`。通常可以通过在源文件中定义它（可能使用初始化程序）并将`extern`声明放在头文件中来做到这一点。

`static`全局级别的变量仅在它们自己的源文件中可见，无论它们是通过包含到达那里还是在主文件中。

* * *

*编者注：*在 C++ 中，声明中`const`既`static`没有 or`extern`关键字的对象是隐式`static`.

* * *

## 回答 #3

> 赞同：49
> 
> 时间：2008-09-18T13:50:21.817

静态意味着您每个文件都会获得一份副本，但与其他人不同的是，这样做是完全合法的。您可以使用一个小代码示例轻松地对此进行测试：

测试.h：

```
static int TEST = 0;
void test(); 
```

测试1.cpp：

```
#include <iostream>
#include "test.h"

int main(void) {
    std::cout << &TEST << std::endl;
    test();
} 
```

测试2.cpp：

```
#include <iostream>
#include "test.h"

void test() {
    std::cout << &TEST << std::endl;
} 
```

运行它会给你这个输出：

> 0x446020
> 0x446040

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-04-27T02:18:06.607

`const`C++ 中的变量具有内部链接。所以，使用`static`没有任何效果。

**啊**

```
const int i = 10; 
```

**一.cpp**

```
#include "a.h"

func()
{
   cout << i;
} 
```

**二.cpp**

```
#include "a.h"

func1()
{
   cout << i;
} 
```

如果这是一个 C 程序，您将收到“多重定义”错误`i`（由于外部链接）。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-18T13:46:49.127

这一层代码的静态声明意味着变量只在当前编译单元中可见。这意味着只有该模块中的代码才能看到该变量。

如果您有一个头文件声明了一个静态变量，并且该头文件包含在多个 C/CPP 文件中，那么该变量将是这些模块的“本地”变量。对于包含标头的 N 个位置，该变量将有 N 个副本。它们完全没有关系。任何这些源文件中的任何代码都只会引用在该模块中声明的变量。

在这种特殊情况下，“静态”关键字似乎没有提供任何好处。我可能会遗漏一些东西，但这似乎并不重要——我以前从未见过这样的事情。

至于内联，在这种情况下，变量可能是内联的，但这只是因为它被声明为 const。编译器*可能*更有可能内联模块静态变量，但这取决于情况和正在编译的代码。不能保证编译器会内联“静态”。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-18T13:56:22.520

C书（免费在线）有一章关于链接，更详细地解释了“静态”的含义（尽管其他评论中已经给出了正确答案）： [http ://publications.gbdirect.co.uk/c_book /chapter4/linkage.html](http://publications.gbdirect.co.uk/c_book/chapter4/linkage.html)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-18T20:47:42.877

要回答这个问题，“静态是否意味着只创建一个 VAL 的副本，以防标头包含在多个源文件中？”...

**没有**。VAL 将始终在包含标头的每个文件中单独定义。

在这种情况下，C 和 C++ 的标准确实会产生差异。

> 在 C 中，文件范围的变量默认为外部变量。如果您使用 C，VAL 是静态的，ANOTHER_VAL 是外部的。

请注意，如果标头包含在不同的文件中（相同的全局名称定义了两次），现代链接器可能会抱怨 ANOTHER_VAL，并且如果 ANOTHER_VAL 在另一个文件中被初始化为不同的值，肯定会抱怨

> 在 C++ 中，如果文件范围的变量为 const，则默认为静态，如果不是，则默认为 extern。如果您使用 C++，则 VAL 和 ANOTHER_VAL 都是静态的。

您还需要考虑两个变量都指定为 const 的事实。理想情况下，编译器总是会选择内联这些变量，而不是为它们包含任何存储空间。可以分配存储的原因有很多。我能想到的...

*   调试选项
*   文件中的地址
*   编译器总是分配存储空间（复杂的 const 类型不容易内联，因此成为基本类型的特例）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-18T13:49:53.830

假设这些声明在全局范围内（即不是成员变量），那么：

**static**表示“内部链接”。在这种情况下，由于它被声明为**const**，因此编译器可以对其进行优化/内联。如果省略**const**，则编译器必须在每个编译单元中分配存储空间。

通过省略**静态**链接默认为**外部**链接。同样，您已经被**const**性所拯救 - 编译器可以优化/内联使用。如果您删除**const**，那么您将在链接时收到*多重定义的符号*错误。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-09-29T10:34:49.687

您不能在不定义静态变量的情况下声明它（这是因为存储类修饰符 static 和 extern 是互斥的）。静态变量可以在头文件中定义，但这会导致包含头文件的每个源文件都有自己的变量私有副本，这可能不是预期的。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-01-23T09:35:56.273

**const**变量在 C++ 中默认是静态的，但在 C++ 中是外部的。所以如果你使用 C++，这不知道要使用什么构造。

（7.11.6 C++ 2003，Apexndix C 有示例）

将编译/链接源代码作为 C 和 C++ 程序进行比较的示例：

```
bruziuz:~/test$ cat a.c
const int b = 22;
int main(){return 0;}
bruziuz:~/test$ cat b.c
const int b=2;
bruziuz:~/test$ gcc -x c -std=c89 a.c b.c
/tmp/ccSKKIRZ.o:(.rodata+0x0): multiple definition of `b'
/tmp/ccDSd0V3.o:(.rodata+0x0): first defined here
collect2: error: ld returned 1 exit status
bruziuz:~/test$ gcc -x c++ -std=c++03 a.c b.c 
bruziuz:~/test$ 
bruziuz:~/test$ gcc --version | head -n1
gcc (Ubuntu 5.4.0-6ubuntu1~16.04.5) 5.4.0 20160609 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-18T13:35:38.623

静态阻止另一个编译单元将该变量外部化，以便编译器可以在使用它的地方“内联”变量的值，而不为它创建内存存储。

在您的第二个示例中，编译器不能假定其他一些源文件不会将其外部化，因此它必须将该值实际存储在内存中的某个位置。

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2008-09-18T13:40:11.280

静态防止编译器添加多个实例。这对于#ifndef 保护变得不那么重要了，但是假设标头包含在两个单独的库中，并且应用程序是链接的，则将包含两个实例。

# windows - 如何开始 Windows 开发？

> ID：92556
> 
> 赞同：6
> 
> 时间：2008-09-18T13:33:12.577
> 
> 标签：windows

多年来，我一直是基于 Unix 的 Web 程序员（Perl 和 PHP）。就语言本身而言，我也精通 C 和 C++（以及 bash 和那种系统管理员之类的东西）。我在学习一门新语言时从来没有遇到过问题（几年前我一直在玩 Java，虽然我可以写它，但我只是不喜欢它作为一种语言）。

我没有任何经验的是用于编写图形 Windows 应用程序的大量框架。

对于我想要完成的基于 Windows 的应用程序，我有一些想法。我可以这样做是 Perl/TCL/TK，但出于各种原因，我想要更“原生”的东西。

通过我现在的公司，我可以使用 Microsoft 工具（以及使用它们进行“开发”的许可证），因此我决定自学一些新东西。

所以，我已经安装了 Visual Studio 2008。我启动它，点击“新项目”，然后对我可以开始的各种类型的新项目感到非常困惑。

有人可以帮助我不仅了解基本差异，而且对每种类型适用于何种事物有任何建议吗？

假设我要走 C++ 路线（我知道该语言，因此不选择 C# - 除非这实际上更可取......）我可以使用：

*   Windows 窗体
*   MFC 应用程序
*   Win32

我也知道离开微软我可以使用 wxWidgets。wxWidgets 确实吸引了我（跨平台等），但这与上面的各种 Microsoft 选项相比如何？我也知道 Qt 存在。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T13:39:54.027

这取决于您想要“接近金属”的程度。如果您想快速编写仅限 Windows 的应用程序，请选择 .Net/C#/Windows Forms/WPF。如果您决心学习一个不易使用的平台，并且拥有 15 年的遗留代码的保护，但可以让您无限控制每一个小细节，请选择 C++/MFC（需要明确：MFC 也仅限 Windows） .

MFC 是 C win32 api 的包装器，以及一些封装标准功能的额外好东西。了解 win32 api 的工作原理很有帮助。要了解这一点，我推荐 Charles Petzold 的“Programming Windows”（老前辈称为“The Petzold”）。您也可以选择从 MFC 开始。查看 Visual Studio 和 codeproject.com 等网站上包含的许多示例和教程。

.Net / C# 更容易使用。它抽象了很多 Win32 api，但它仍然是一个包装器 - 所以对于某些事情，您需要“下拉一个级别”，就像您过去使用 Visual Basic 所做的那样。恕我直言（我可能会为此修改），C# 是新的 Visual Basic，除了它不像语言那么难看而且它是静态类型的。公平地说，它也有一些优点，比如不需要奇怪的 VB 运行时（但它确实需要 .Net，所以......）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T13:35:42.273

对我来说，C# 是 Windows 开发的首选语言。我和你有同样的背景，我发现 C# 令人耳目一新。我真的很喜欢这种语言，而 .NET 现在是我的首选平台。此外，通过 Mono 开发与您的 Unix 根源保持联系很容易。确实，.NET 是一个很棒的平台，您应该探索它。

此外，当涉及到 Visual Studio 时，您必须记住，不同的项目基本上只指定默认包含哪些类型的库以及构建过程。如果您想保留 Unix 风格的 Makefile，您可以使用 Mono 进行 Windows 开发。

亚历克斯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T13:56:05.890

我认为我的建议与您的目标有很大关系。如果您正在寻找构建自己的应用程序并希望将其快速推向市场，并且它必须是 Windows，那么我会按照其他人的建议使用 C# WF。

如果你想让自己更受雇，那么我会选择 C#/ASP.Net。通过这种方式，您可以学习 C#，但也可以了解更多关于 Web 开发的知识，尤其是 ASP.Net。我想你会发现 Windows 窗体相对来说要容易得多，而且不值得花很多时间在上面。

因此，如果我是你，我会构建我的应用程序，使其大部分与界面分离。我将首先学习如何使该代码在 ASP.Net 中交互，然后我会在 Windows 窗体中尝试它。如果你能做到这一点，你将学到很多非常重要的 .Net 框架开发技能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T22:43:16.577

恕我直言，wxWidgets 比任何一个都好。例如，我知道很多人将他们的项目从 MFC 转换为 wx。wxWidgets 拥有 MFC 的所有功能（在早期的 wx 版本中，很多类都是 MFC 类的克隆），还有更多。它不仅是一个 GUI 库，而且您拥有各种常见任务的包装器，例如读取/写入 XML 文件、Windows 注册表、各种图形类型和图像数据的操作、字符集之间的转换类等。还有wxCode 网站上有很多附加类，可以轻松增强您的应用程序。

wxWidgets 也是跨平台的，具有完整的 Unicode 支持，并且只会更进一步。如果您决定试一试，请确保您尝试使用 wxFormBuilder 轻松、所见即所得的用户界面构建器（对话框、窗口等）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T13:36:30.773

Windows 窗体是**迄今为止**最好的。但是，如果您还不知道自己在做什么，那么使用 C++ 中的 Windows 窗体只会让您更加困惑，因为您实际上是在使用 C++/CLI，它也可能是一种完全不同的语言。如果你想走这条路，最好选择 C#。

MFC 可能最接近您所熟悉的。但是，同样，Windows 窗体要好得多。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T13:38:48.523

我真的会选择 C# 而不是 C++。对于 Windows 客户端应用程序，它无可匹敌。对于像你这样的 C/C++ 家伙，语法学习曲线会很短。困难在于学习 .NET 框架，但这是您必须以一种或另一种方式产生的成本。

选择 C# 后，只需选择 Windows 窗体或 WPF 应用程序。两者都是客户端应用程序类型。如果您选择 WPF 应用程序，您还必须学习 XAML，这是一个相当新但功能强大的概念。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T13:39:21.547

我尝试在 .Net（Windows 窗体）中进行一些 C++ 编程。尽管有可能这肯定不是一次愉快的体验，主要是因为您有一些额外的关键字，这些关键字与标准 C++ 不同。但是，如果您愿意学习更多 C++，这是一个选择。

我自己已经开始使用 C# 进行一个项目，该项目运行良好。如果你有 C++ 的背景，这很容易学习。

我永远不会再碰 Win32 API。真的太可怕了！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T13:47:01.827

如果您只是对编写图形化 Windows 应用程序感兴趣，请坚持使用“Windows 窗体应用程序”。它将从一个空白的 Windows 窗体和一个包含您的 main() 方法的类开始。

“控制台应用程序”项目可能是最简单的，它只是使用 main() 为您创建一个类文件，仅此而已。

“类库”项目具有用于创建 DLL 的脚手架和默认构建设置。

不同类型的项目之间通常没有任何根本区别。他们所做的只是为您设置一些默认包含并生成一些脚手架代码（例如，空白窗口窗体）以帮助您入门。

我建议学习 C#。如果您了解 Java，这对您来说不会有太大的飞跃。C# 的初始版本实际上被设计为与 Java 完全一样，但多年来它们有所不同。

# web-services - 我是否应该拒绝比预期更长的 URL？

> ID：92561
> 
> 赞同：5
> 
> 时间：2008-09-18T13:34:08.177
> 
> 标签：web-services, rest, security, http, url

我正在开发一个应用程序，并且 URL 格式为`www.example.com/some_url/some_parameter/some_keyword`. 我从设计上知道这些 URL 将具有最大长度（并且仍然有效）。我是否应该验证每个请求的 URL 长度以防止缓冲区溢出/注入攻击？我相信这显然是肯定的，但我不是安全专家，所以也许我遗漏了一些东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T13:37:29.883

如果您不期望该输入，请拒绝它。

您应该始终验证您的输入，并肯定丢弃超出预期范围的任何内容。如果您已经知道您的 URL 确实不会超过某个长度，那么在它到达应用程序之前拒绝它似乎是明智的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-18T13:47:57.813

纵深防御是一个很好的原则。但是错误的安全措施是一个糟糕的原则。差异取决于很多细节。

如果您确实确信任何超过 N 的 URL 都是无效的，那么您不妨拒绝它。但是，如果它是真的，并且如果您的输入验证的其余部分是正确的，那么无论如何它都会在以后被拒绝。因此，所有这些检查可能会减轻代码中其他错误造成的损害。花时间思考如何避免这些错误通常比思考 N 可能是什么要好。

如果您确实检查了长度，那么最好不要在代码的其他地方依赖这个长度限制。这样做会将不同的检查更紧密地结合在一起，并且如果您更改规范并需要接受更长的 URL，则在下一个版本中更改限制变得更加困难。例如，如果长度限制成为将 URL 放入堆栈而不给予应有的注意和注意的借口，那么您可能正在让某人跌倒。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T13:36:52.083

你怎么确定*所有*长于 N 的 URL 都是无效的？如果您可以确定，那么将其限制为一个健全性检查应该没有什么坏处——但不要让这愚弄您以为您已经阻止了一类漏洞利用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T13:41:23.760

我能看到的唯一可能导致问题的是，虽然今天你的 URL 永远不会超过 N，但你不能保证永远不会如此。一年后，当你回去进行编辑以允许 url 长度为 N+y 时，你可能会忘记修改 url 拒绝代码。

在使用 URL 参数之前，最好先验证它们。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T15:01:42.160

Safari、Internet Explorer 和 Firefox 都有不同的可接受的最大长度。

我投票选择所有三个中最短的。

[http://www.boutell.com/newfaq/misc/urllength.html](http://www.boutell.com/newfaq/misc/urllength.html)

从链接中提取 -

" **Microsoft Internet Explorer（浏览器）** - 2,083 个字符

**Firefox（浏览器）** - 在 65,536 个字符之后，位置栏不再显示 Windows Firefox 1.5.x 中的 URL。但是，更长的 URL 也可以。我在 100,000 个字符后停止测试。

**Safari（浏览器）** - 至少 80,000 个字符可以使用。”

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T13:37:22.380

我认为这可能会给您一些安全性，并且如果人们确实向您发送了疯狂的长 URL，可能会为您节省一点带宽，但很大程度上您也应该在实际应用程序中验证您的数据。多级安全性通常更好，但不要错误地认为，因为一开始有一个（薄弱的）保护措施，其余的就不会出现问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T13:37:43.470

我会说不。这只是虚假的安全。只需好好编程并检查您对坏东西的请求。应该够了。

此外，这不是未来的证据。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T13:38:02.253

是的。如果它太长并且你确定然后尽快拒绝它。如果可以，请在它到达您的应用程序之前拒绝它（例如 IISLockdown 将执行此操作）。

记住要考虑字符编码。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T13:38:13.330

比检查长度更好，我认为你应该检查内容。您永远不知道将来将如何使用您的 URL 架构，但您始终可以清理您的输入。把一个非常复杂的事情简单地说：不要相信用户提供的数据。不要将它直接放入数据库查询中，不要 eval() 它，不要认为任何事情都是理所当然的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-18T13:38:13.517

如果您知道有效的 URL 不能超过*N*个字节，那么这听起来是一种无需太多努力即可快速拒绝跨站点脚本尝试的好方法。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-18T13:45:07.977

**验证请求中的**内容比验证 URL 长度更好。

您的需求将来可能会发生变化，此时您必须删除或更改 URL 长度验证，可能会引入错误。

如果它最终成为一个经过验证的安全漏洞，那么您可以实施它。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-18T14:55:22.007

好的，让我们假设这样的 N 存在。正如 onebyone 指出的那样，长度超过 N 个字符的格式错误的 URL 无论如何都会被其他输入验证拒绝。然而，在我看来，这开启了一个全新的思考方式：

使用此常量，您可以验证您的其他验证。但是，如果其他验证无法将某个 URL 检测为无效，但该 URL 的长度超过 N 个字符，则该 URL 会触发错误并应被记录（并且可能整个应用程序应该关闭，因为它们可能会创建一个足够短的无效 URL）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-07-22T15:16:47.237

哦，我的，很多答案，很多好点，不过如此分散，所以让我尝试巩固所有这些。**tl; dr** imo，这对应用层代码来说太低级了。

是的，URL 可以是*任意*长度，但实际上浏览器有限制。当然，这只能保护您免受那些愿意将自己限制在这些向量中的基于浏览器的攻击，因此您确实需要某种方法来处理主动攻击尝试。

好的，它可以防止缓冲区溢出。好吧，只有当您在低级别工作并且不考虑此类问题时。如今，大多数语言都很好地支持字符串，并且不允许它们溢出。如果您正在处理一些非常低级的系统，实际上将数据读取为字节并将其放入“字符串”类型，那么当然，您应该有某种检测和处理它的方法，但分配内存并不难，并一次传输已知数量，只需跟踪您预留了多少内存即可。坦率地说，如果你正在处理那个低级别，你真的应该使用其他东西。

好吧，那仅仅根据字符串长度拒绝呢？对此的主要缺点是可能产生虚假的安全感。也就是说，代码的某些区域可能会变得“草率”，并且很容易受到您试图避免的漏洞的攻击。您显然必须小心确保这个“全局”限制实际上是足够的，但考虑到您的 URI 格式，您可能能够让这些“部分”报告它们的最大长度是多少，并集中长度检查（对于两者整个字符串，以及它的组成部分）；至少这样，如果某个部分需要允许更长的字符串，则更容易处理更改。

This does of course have some advantages to it, for one, it's very quick to be able to compare the length of a string and reject the request right away... but don't forget to be a 'well behaved' site you should be sending back a proper response explaining why the server is rejecting this. In practice though, do you really think you are going to have to handle that many of these types of 'wrong' URL, surely they would be wrong in so many other ways.

For some reason, you felt like not saying what language you are using. High level languages like Java or Python have some very good libraries for dealing with 'web stuff'. Java will let you specify patterns for the URI, including the use of regex for that pattern, so if you wanted a name in the URL, you could have something like `@Path("/person/(.{0..100}")` to limit the parameter to 100 characters. I'd be surprised if the likes of Ruby or Python didn't have equivalent, they like to promote themselves as nice 'webby' languages.

Finally, regardless of length, there are *many* things that you will need to validate, not just length. Having to worry about the length of the URI causing a buffer overflow is a very low level thing, and would need to be very generic, ie need to handle any request, even one with a 1GB URI potentially; note I said 'handle' not 'accept it an pass it up to the application layer', it could reject it at that low level, also triggering system events maybe.

# c# - 如何在 Scintilla 中突出显示文本？

> ID：92565
> 
> 赞同：7
> 
> 时间：2008-09-18T13:34:54.163
> 
> 标签：c#, python, perl, ide, scintilla

我正在使用[Scintilla](http://www.scintilla.org/)编写编辑器。

我已经在使用词法分析器进行自动语法突出显示，但现在我想标记搜索结果。如果我只想标记一个命中，我可以在那里设置选择，但是，我想标记（例如黄色背景）所有命中。

我用 Perl 写这个，但如果你有其他语言的建议，那也很酷。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-18T13:59:19.770

您是否阅读过[Scintilla 文档中的标记参考](http://scintilla.sourceforge.net/ScintillaDoc.html#Markers "闪烁中的标记")？这个参考可能有点晦涩，所以我建议也看看 SciTE 的源代码。这个文本编辑器最初是 Scintilla 的测试平台。它成长为一个成熟的编辑器，但它仍然是所有 Scintilla 的一个很好的实现参考。

在我们的特殊情况下，在 Find 对话框中有一个 Mark All 按钮。你可以在 SciTEBase::MarkAll() 方法中找到它的实现。此方法仅在搜索结果上循环（直到它在第一个搜索结果上循环，如果有的话）并在找到的行上放置一个书签（并且可以选择在找到的项目上设置一个指示符）。找到的行是使用 SCI_LINEFROMPOSITION(posFound) 获得的，书签只是对 SCI_MARKERADD(lineno, markerBookmark) 的调用。请注意，标记可以是边距中的符号，或者如果未关联到边距，它将突出显示整行。

HTH。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T13:48:41.400

“示例”编辑器 scite 使用书签功能为所有匹配搜索结果的行添加书签。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-31T18:05:43.117

我使用[指标](http://www.scintilla.org/ScintillaDoc.html#Indicators)来突出显示搜索结果。

# c# - 在 Mono 中学习 C#

> ID：92592
> 
> 赞同：14
> 
> 时间：2008-09-18T13:37:31.897
> 
> 标签：c#, .net, mono, cross-platform

Mono 在 Linux 和 OS X 上的 C# 开发有多可靠？我一直在考虑学习 C#，并且想知道使用 Mono 学习是否就足够了。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-18T13:41:43.180

我已经使用单声道超过 2 年了。工作是 windows 和 .Net，家庭是 GNU/Linux 上的单声道。我已经能够从同一个 SVN 存储库毫无问题地运行 GUI 和 ASP.NET 应用程序。我必须做的唯一更改是连接字符串。ASP.NET 在 mod_mono 下适用于 apache 和 xsp2。有些 .NET 3.5 部分不存在，但绝对适用于 .NET 2.0 及更早版本。

Monodevelop 进展顺利，我相信调试器也运行良好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T13:39:01.113

应该没问题。它现在支持 C# 3.0。不过，我通常会尝试坚持以 2.0 为目标，它非常稳定。

Winforms 和 ASP.NET 对我来说都很好用。唯一需要考虑的是目前不支持 WPF。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T13:41:33.167

.NET 2.0 已完全实现，如果您打算只使用 .NET 2.0，几乎可以保证它可以正常工作（甚至是 WinForms）:) 其他版本仍在大量开发中，因此您必须查看 Mono 的网站。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T13:42:38.793

我无法谈论 Mono 的 OSX 支持，但它用于 Linux 中的一些相当大的项目，例如[Banshee](http://banshee-project.org)和[F-Spot](http://f-spot.org/)。[Monodevelop](http://www.monodevelop.com/)是一个相当不错的 IDE。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-23T20:19:54.403

Mono 在 OSX 上非常稳定。堆栈中唯一缺少的部分是 GUI，Gtk# 或 Winforms 在 linux 上都无法正常工作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T13:43:39.447

我认为使用 mono 学习 C# 是非常可行的。我没有使用 mono 的实践经验，但该平台似乎非常稳定，并且 Mono 被用于许多[商业和开源应用程序](http://www.mono-project.com/Software)中。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T16:36:05.897

Mono 最近刚刚宣布它完全支持 .NET 3.5 并且整体 Mono 可以很好地处理大部分事情。很多工作都是由志愿者完成的，因此您仍然会遇到会导致问题的极端案例，但他们对 bugzilla 和邮件列表的响应非常迅速。

他们刚刚添加的另一个很棒的功能是能够从 Windows 中的 Visual Studio 远程附加到在 Linux/Mac 上运行的进程。这使您能够调试可能遇到的任何系统特定问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T13:41:29.610

学习语言，你会很好的。单声道中缺少一些库，但这不会阻止您学习该语言。您可以在[Mono 项目页面：FAQ](http://www.mono-project.com/FAQ:_General)中找到更多信息。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-05-28T14:52:13.077

**Mono**是事实上的**.NET for Unix**。

我不建议，但我鼓励您使用**Mono学习****C#**。通过这种方式，您将涉足 .NET 跨平台方法。

 **现在使用**Xamarin Mono 工具**(http://xamarin.com/)，您还可以设计在 Android、iOS 和 WindowsPhone（以及更多）之间共享代码的跨平台移动应用程序。

# multithreading - SQL Compact Edition 3.5 SP 1 - LockTimeOutException - 如何调试？

> ID：92601
> 
> 赞同：1
> 
> 时间：2008-09-18T13:38:33.157
> 
> 标签：multithreading, sql-server-ce

在我们的应用程序中，我们偶尔会遇到 SQL CE 抛出的 LockTimeoutExceptions。我们最近升级到 3.5 SP 1，其中一些似乎已经消失，但我们仍然偶尔会看到它们。我确定这是我们代码中的一个错误（它是多线程的），但我无法准确地确定它。有没有人有任何好的技术来调试这个问题？像这样的异常日志（这些异常从来没有堆栈跟踪）：

> SQL Server Compact 在等待锁定时超时。设备的默认锁定时间为 2000 毫秒，台式机的默认锁定时间为 5000 毫秒。可以使用 ssce: default lock timeout 属性在连接字符串中增加默认锁定超时。[会话 id = 6,线程 id = 7856,进程 id = 10116,表名 = 产品,冲突类型 = s 锁 (x 块),资源 = DDL]

我们的数据库读取量很大，但很少写入，而且我*认为*我已经在需要的地方得到了保护。

编辑：SQL CE 已经自动使用 NOLOCK [http://msdn.microsoft.com/en-us/library/ms172398(sql.90).aspx](http://msdn.microsoft.com/en-us/library/ms172398(sql.90).aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T18:31:15.950

我刚刚意识到 3.5 SP1 在异常中包含了让我确定的新信息。

> SQL Server Compact 在等待锁定时超时。设备的默认锁定时间为 2000 毫秒，台式机的默认锁定时间为 5000 毫秒。可以使用 ssce: default lock timeout 属性在连接字符串中增加默认锁定超时。[ 会话 id = 6，线程 id = 7856，进程 id = 10116，*表名 = 产品*，冲突类型 = s 锁（x 块），*资源 = DDL* ]

我能够确定它是在尝试删除必须与其打开连接的现有表时发生的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-25T22:02:05.147

万一其他人看到这个页面，我发现了另一个可能发生这种情况的原因。我创建了一个 SqlCeTransaction 来包装各种语句，但我不小心没有在其中一个语句上使用该事务。这导致了我的锁定超时消息。

# actionscript-3 - 学习 AS3 的最佳资源

> ID：92602
> 
> 赞同：1
> 
> 时间：2008-09-18T13:38:47.760
> 
> 标签：actionscript-3

让我先说我绝不是设计师。我对学习 AS3 很感兴趣，并且想知道有哪些适合初学者的最佳书籍/资源。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T08:00:03.067

要获得一份非常出色且脚踏实地的 Actionscript3 初学者指南，您必须查看 Rich Shupe 和 Zevan Rosser 撰写的“Learning ActionScript 3.0”。这是我最喜欢的 ORIELLY 出版物。有人建议我在阅读 Colin Moock 的“Essential ActionScript 3.0”之前先阅读这本书。阅读“学习 ActionScript 3.0”后，您将对新的 Display 对象和事件流有一个深刻的理解，这是两个非常重要的领域。接下来，我将转到“Essential ActionScript 3.0”，它非常全面且内容丰富。一旦您对该语言感到认真并想要攻击更深层次的 OOP 主体，那么是时候查看由 Ed 之友发布的“面向对象的 ActionScript 3.0”，它涵盖了包括 UML 在内的许多内容，

阅读书籍和教程很棒，但没有什么比进入 IDE 并应用新概念和想法并确认结果更重要了。进入那里并开始追踪东西:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T13:46:46.477

Adobe 的[实时文档](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/)是一个很好的可搜索参考，他们也有一[本编程书 (PDF)](http://livedocs.adobe.com/flex/3/progAS_flex3.pdf)。[OSFlash](http://www.osflash.org/)是一个很好的社区站点，其中包含您可以查看的开源代码和教程。[Haxe](http://haxe.org/)是一种出色的替代语言和编译器，具有额外的功能。要查看一些带有源代码的漂亮图形示例，请查看[Andre Michelle 的实验室](http://lab.andre-michelle.com/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T14:00:16.257

现在，我可以告诉您，围绕 Adob​​e Flex 有一个非常活跃的社区，它结合了基于 XML 的 UI 开发语法以及背后代码的 AS3。我无法强调资源和社区有多棒。如果您不是设计师，并且只想使用 Flash 和 ActionScript 构建应用程序，那么 Flex 是一个很好的地方，不仅可以开始，而且可以真正提高您的技能。SDK 是免费和开源的，这也有帮助。

查看这些家伙的代码和新闻：

1.  [http://blog.paranoidferret.com/](http://blog.paranoidferret.com/)
2.  [http://blog.everythingflex.com/](http://blog.everythingflex.com/)
3.  [http://www.mikechambers.com/blog/](http://www.mikechambers.com/blog/)
4.  [http://www.onflex.org/ted/index.php](http://www.onflex.org/ted/index.php)
5.  [http://dougmccune.com/blog/](http://dougmccune.com/blog/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T19:45:34.573

关于 ActionScript 的绝对最佳书籍是Colin Moock 的**Essential ActionScript 3.0**

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-03T11:31:25.993

我从 actionscript.org 的教程和论坛上学到了所有我知道的东西

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T13:43:24.363

这很大程度上取决于你的背景。你有其他语言/平台的编程经验吗？

虽然我自己没有读过，但 Colin Moock 的 Essential Actionscript 2/3 应该是入门的好书。除此之外，还有很多很棒的在线资源（Google ;)）。对于 RSS 源，请查看 feeds.adobe.com

除此之外，我认为与任何其他编程语言相同的提示和技巧适用于 actionscript。熟能生巧；）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T13:45:54.403

这听起来可能很奇怪，但我推荐 Adob​​e 提供的名为[Programming ActionScript 3.0 (PDF)](http://livedocs.adobe.com/flex/3/progAS_flex3.pdf)的免费文档。这就是我学习AS3的方式。

您可能想查看一些 O'Reilly 书籍以及 Colin Moock 的书籍。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T15:57:57.830

Colin Moock 的[Essential ActionScript 3.0](http://oreilly.com/catalog/9780596526948/#top)非常棒。这家伙既是一位出色的程序员又是一位出色的作家，这本书开头非常简单，但涵盖的主题非常多。

查看他[的购买地点列表/在线阅读](http://www.moock.org/eas3/)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-24T09:06:09.257

如果您已经熟悉基本的编程概念，我推荐由 Joey Lott 和 Danny Patterson编写的[Advanced ActionScript 3 with Design Patterns 。](http://safari.oreilly.com/0321426568)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-09-01T22:43:57.213

如果您想了解AS3游戏，这个网站非常好！

[www.foundation-flash.com](http://www.foundation-flash.com/tutorials/index2.php)

# assembly - 什么会导致汇编语言程序显示“垃圾”？

> ID：92613
> 
> 赞同：0
> 
> 时间：2008-09-18T13:40:14.340
> 
> 标签：assembly, x86, masm

我有一些代码应该显示一条短消息。这是相关的代码：

```
DATA    SEGMENT 'DATA'
MSG DB  0AH, 0DH, 'Hello, Adam', '$'
CHAR    DB  00H
DATA ENDS

CODE    SEGMENT 'CODE'
PRINT_MSG:
    MOV AH, 09H ;Command to print string of characters
    MOV DX, OFFSET MSG  ;Mov address of message into DX
    INT 21H     ;DOS Interrupt
    JMP WAITING ;Loop back to waiting state
CODE ENDS 
```

输出是：

```
E:\ece323\software\lab2>MAIN.EXE
?F ^?¶ ? N?   ?               -!-

Hello, Adam- 
```

这里发生了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T13:52:13.450

我的猜测是您的 DS 没有指向您的数据段。

Int21 函数 0x09 从 DS:DX 获取字符串。

请记住，DX 只是一个 16 位寄存器。要访问 16 位范围之外的数据，您必须使用段寄存器。这些被称为数据的 DS 和 ES，代码的 CS 和堆栈的 SS（i386 上也有 FS 和 GS）。

您加载的确切地址由 16 * segment_register + offset_register 给出。Int21 无法猜测您的 DS 在哪里，因此您必须在调用中断之前加载它。

我猜你从来没有初始化你的 DS 寄存器，所以它很可能指向代码，而不是数据段。

尝试更换你的

```
 MOV DX, offset MSG 
```

经过：

```
 LDS DX, MSG  ; Check that, it's been ages since I've written 16 bit code. 
```

不幸的是，自从我上次使用 16 位汇编程序以来已经有好几年了，所以我无法检查它，但 LDS 应该可以解决问题。

您也可以通过以下方式在程序启动时间接加载 DS：

```
 MOV AX, SEG DATA  ; check that - can be SEGMENT or so as well.
  MOV DS, AX 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T13:58:06.887

尝试以下更改：

```
DATA    SEGMENT 'DATA'
ERROR_MSG DB 'DS:DX is wrong'
MSG DB  0AH, 0DH, 'Hello, Adam', '$'
CHAR    DB      00H
DATA ENDS 
```

如果显示错误消息，则 DS:DX 是错误的，因此 DS 没有指向 DATA 段，或者“OFFSET MSG”由于某种原因是错误的……我的 asm 生锈了，但尝试使用 ADDR 而不是 OFFSET (? )

如果没有显示错误消息，则问题发生在执行到达 PRINT_MSG 之前。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T13:25:59.853

Nils 是对的，需要设置 DS 寄存器才能使用 int 21 的此功能。首先尝试使用 EAX 转换的第二部分，它应该肯定可以工作。

字符串后面的 0 char 中不需要。第 9 个函数不适用于以空字符结尾的字符串，这个 '$' 字符可以代替 0。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-12-01T15:24:40.093

看起来你是 PSP 的一部分。这是一个.COM吗？如果您忘记了 ORG 100h 汇编器指令，则偏移量将不会指向您认为它们应该指向的位置……有趣的旁注是，仅从 MOV OFFSET 切换到 LEA 也将“起作用”。MASM 足够聪明，可以在您使用 LEA 时弄清楚您在做什么，而在使用 OFFSET 时可能不会（是的，我很久以前就很难学会这一切...... :-)）。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-09-18T13:53:51.450

我的猜测是您可能没有在“Real”模式下运行，这是 MSDOS 程序通常（以及特定的 Int 21h 中断）工作所必需的。

自 Windows 95 以来，Windows 一直以“受保护”模式独占运行；我认为，自 Windows 2000 以来，命令提示符一直处于保护模式。

您可能想尝试为您创建 EXE 的快捷方式，然后在快捷方式中设置兼容性选项。

# many-to-many - MS Dynamics CRM 4.0 中的多对多关系 - 如何？

> ID：92617
> 
> 赞同：0
> 
> 时间：2008-09-18T13:41:06.257
> 
> 标签：many-to-many, entity-relationship, dynamics-crm-4, crm

我正在为我大学的一个项目开发 MS CRM 服务器。

我想做的是让 CRM 的用户标记一些联系人，我想创建一个实体来归档标签，并在标签实体和联系人之间创建 N:N 关系。我已经创建并发布了新实体和关系，但我不知道如何在联系表单中添加查找字段，以便用户可以看到与一个联系人相关的标签并添加一个新的。

谁能帮我？

如果您无法理解我要做什么，请告诉我，我将重新制定。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-18T21:08:43.667

我开始写一个答案，但意识到你在谈论 4.0 而我只在 3.0 中完成过。

但是，我能够找到有关 4.0 中新的多对多功能的屏幕截图

[http://www.philiprichardson.org/blog/post/Titan-Many-to-Many-Relationships.aspx](http://www.philiprichardson.org/blog/post/Titan-Many-to-Many-Relationships.aspx)

# python - Python 套接字突然超时？

> ID：92620
> 
> 赞同：13
> 
> 时间：2008-09-18T13:41:22.930
> 
> 标签：python, api, sockets, ssl, gmail

我今天回到了一个通过 SSL 登录 Gmail 的旧脚本。该脚本在我上次运行它时运行良好（几个月前），但现在它立即死亡：

```
<urlopen error The read operation timed out> 
```

如果我设置超时（无论多长时间），它会立即死亡：

```
<urlopen error The connect operation timed out> 
```

后者可通过以下方式重现：

```
import socket
socket.setdefaulttimeout(30000)
sock = socket.socket()
sock.connect(('www.google.com', 443))
ssl = socket.ssl(sock) 
```

返回：

```
socket.sslerror: The connect operation timed out 
```

但我似乎无法重现前者，并且在通过代码进行了很多步骤之后，我不知道是什么原因造成的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T15:06:36.347

```
import socket
socket.setdefaulttimeout(30000)
sock = socket.socket()
sock.connect(('www.google.com', 443))
ssl = socket.ssl(sock)
ssl.server()
--> '/C=US/ST=California/L=Mountain View/O=Google Inc/CN=www.google.com' 
```

它工作得很好。我无法重现您的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T15:06:11.310

HTTPS 无法访问 www.google.com。它重定向到不安全的 HTTP。要获取邮件，您应该去[https://mail.google.com](https://mail.google.com)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T20:29:34.447

The first thing I would check is whether you need to connect via an HTTP proxy (in which case direct connections bypassing the proxy will likely time out). Run Wireshark and see what happens.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-04-18T14:22:48.013

连接到 没有超时`www.google.com`，但 Python 3.x 现在提供了该`ssl`模块，因此 OP 的示例代码将不起作用。

以下是适用于当前 Python 版本的类似内容：

```
import ssl
import socket
from pprint import pprint

hostname = 'www.google.org'
context = ssl.create_default_context()

with socket.create_connection((hostname, 443)) as sock:
    with context.wrap_socket(sock, server_hostname=hostname) as ssock:
        pprint(ssock.getpeercert()['subject']) 
```

产生：

```
((('countryName', 'US'),),
 (('stateOrProvinceName', 'California'),),
 (('localityName', 'Mountain View'),),
 (('organizationName', 'Google LLC'),),
 (('commonName', 'misc.google.com'),)) 
```

在此处阅读有关 ssl 模块的更多信息：[https ://docs.python.org/3/library/ssl.html](https://docs.python.org/3/library/ssl.html)

# web-services - 自有网络服务，或可以在发明者去世后继续存在的服务

> ID：92638
> 
> 赞同：2
> 
> 时间：2008-09-18T13:43:08.527
> 
> 标签：web-services

我注意到今天有一个名为[Dead man's switch](http://www.deadmansswitch.net/)的新网络服务，它会在你不回复证明你还活着的周期性“ping”的情况下发送电子邮件。但我突然想到，我可能比为服务付费的个人或组织活得更久，从而使服务变得毫无用处。

我们可能不愿意使用其他类型的服务，仅仅因为价值太高，我们不相信可能会失去兴趣的发明者或可能破产的组织。就像可以在许多不同的程序和设备中使用的数据存储库一样，但是如果有人忘记支付托管费用，这将破坏它们。

但是说服务“拥有自己”，并支付自己的托管费用？像这样：

*   主机是 Amazon EC2 或类似的
*   账单是通过从银行账户中借记的方式支付的
*   银行账户由利息回报和广告收入补充
*   银行帐户以服务本身的名义，一旦播种，就再也不会为其他任何事情而动摇
*   创建者声明服务“完成”并进入下一个项目

对我来说，这是一个工程问题，类似于建造火星探测器、遗忘式发电机、千禧年时钟以及其他具有自身稳态机制并且可以被其创造者抛弃而不会停止运行的人工制品。

问题是：有什么陷阱？银行账户必须是真实人名吗？你能阻止政府吗？从考虑 n 年后“无人认领”的帐户？它如何从崩溃中恢复？是否有用于在其他公司开设新主机帐户的 API，以便它可以自动扩展自身并保护自己免受任何主机破产的影响？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T14:02:13.460

你不能以这种方式使服务变得健壮——如果银行账户是单点故障，那么当（不是如果）它失败时，你就输了。如果没有法人实体，银行账户就无法存在，但这只是一个细节 - 其他失败是亚马逊可能会撤下 SC2，或提高价格，或做出不兼容的 API 更改，或被竞争对手贿赂或法院下令删除您的应用程序。

罗斯·安德森 (Ross Anderson) 发表了对数据存储“永恒服务”要求的初步描述。广泛的原则是将其分发给尽可能多的人，并确保他们都有可靠的激励措施来保持服务运行并保持特定数据的实时性。它必须能够抵御尽可能多的参与者退出，以及尽可能多的参与者“流氓”并试图颠覆它。

他只在我阅读的论文中给出了粗略的概述，以及一些可能有用的具体技术，但那是 10 多年前的事了。如果你看，你可能会找到进一步的研究。

[http://www.cl.cam.ac.uk/~rja14/eternity/eternity.html](http://www.cl.cam.ac.uk/~rja14/eternity/eternity.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T14:13:01.060

我想到的一件事是维基百科。一个共同发明人退出了，另一个在其中的作用越来越有限，编辑人员流动性令人难以置信，还有大量的人试图颠覆它（故意破坏，假文章，输入虚假信息），他们不断涌入不知道自己在做什么的人。

他们做对的是分散了结构。除了托管它的服务器之外，WP 上的所有内容都分布在全球数千名管理员和数百万贡献者之间。WP 本身不断在新人中产生足够的兴趣，以继续补充离开的人——而且他们经常离开。如果您查看 WP 的内部结构，您会感到震惊和震惊，它甚至可以工作，但它确实有效并且非常有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T13:47:35.880

我想你已经看太多科幻电影了。为什么我有一种感觉，你是那种会通过释放带有致命人工智能的机器人来导致人类灭亡的人……

不过有趣的想法。我喜欢。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T13:49:17.733

银行帐户必须与个人（通过 SSN）或公司（通过 TIN）绑定。将其绑定到个人帐户会更好，因为虽然公司**听起来**像您正在寻找的东西，但还涉及其他成本，例如州税和联邦税，这将导致公司在没有人为干预的情况下解散以维持它.

至于 API，目前除了“创建者”编写某种可以注册某些当前主机公司的机器人脚本之外，目前还没有通用的 API……当然，这并不能解决“埋没忘记”方面。

不过非常有趣的想法......我很想看到这个问题的其他回答:-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T13:50:55.093

该服务需要获得某种描述的既定合法身份，然后才能以其名义开设银行账户。

一旦发生，就有可能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T15:02:14.907

除了法律上的复杂性。

您的服务还需要知道何时该删除自身。如果它不再被使用，并且它包含的信息在其他地方被复制到更好/更有效的服务中（你将如何测试它？） - 它是否通过继续消耗资源来达到目的？

正如其他人所说，这听起来像是大量科幻故事的开始：）

# seo - google对大型站点地图的容忍度有多大

> ID：92651
> 
> 赞同：0
> 
> 时间：2008-09-18T13:45:28.087
> 
> 标签：seo, sitemap

我有几个页面的站点地图，其中唯一不同的内容是标题属性和在谷歌地图中绘制的内容？

谷歌会因为垃圾邮件而惩罚我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T16:18:18.760

谷歌有一个特定的地理空间内容索引标准，他们称之为“[地理站点地图](http://www.google.com/support/webmasters/bin/answer.py?hl=en&answer=94554)”。它只是[sitemaps.org 协议](http://sitemaps.org/protocol.php)的扩展，它添加了一个 XML 命名空间和一些额外的标签，以将 Google 引导到您的内容中，其中包含与地图相关的信息。

如果您已经在使用 KML 来生成地图，这可以像将 Google 指向您服务器上的数据文件而不是用户可访问的页面一样简单。如果您通过其他方法生成地图，则可以通过创建“影子”KML 文件来实现，该文件仅为 Google 爬虫镜像您的内容。

我记得这个过程的关键是：

*   [使用KML（Keyhole 标记语言）](http://code.google.com/apis/kml/documentation/kmlreference.html)镜像您的内容
*   用 atom:author 元素标记 KML 中的每个项目，以便 Google 对其进行归因
*   用 atom:link 元素标记 KML 中的每个项目，该元素会引导回您对该内容的呈现
*   在 Document 范围内包括 atom:author 和 atom:link 元素
*   将 KML 放入您的 GEO 站点地图并适当标记

我发现的一个问题是您必须将您的地理站点地图内容与其他站点地图放在一个单独的文件中，并通过[站点地图索引文件](http://sitemaps.org/protocol.php#index)链接到它。[然后在谷歌网站管理员工具](https://www.google.com/webmasters/tools/docs/en/about.html)中单独提交地理站点地图（将其标记为 GEO 站点地图），以便他们注意到。

2007 年谷歌开发者日有一些关于这方面的介绍，现在在 YouTube 上，包括“[谷歌和 GeoWeb](http://www.youtube.com/watch?v=Pjn5RkIHzYo) ”和“ [KML 搜索和开发地图混搭](http://www.youtube.com/watch?v=qi0Ys2EZXVY)”。[Google Developer Day YouTube 频道](http://www.youtube.com/googledeveloperday)上可能还有其他相关内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T13:51:18.743

普遍的智慧说“是”。您的页面排名是您对互联网贡献价值的直接代表。如果您试图通过创建重复或接近重复的页面来让自己看起来拥有更多内容，那么您可能会受到适当的惩罚。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T06:05:48.790

谷歌不理解 javascript，如果页面在链接中看起来相同，那么谷歌不会在其中找到太多价值

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T21:01:17.240

该值在地图中，这些地图位于不同域的 iframe 中。从 Google 的角度来看，因此向用户提供您的一个页面可能对该用户没有用处。

# c++ - 如何在 CEdit 控件中保留插入符号位置？

> ID：92671
> 
> 赞同：2
> 
> 时间：2008-09-18T13:47:04.977
> 
> 标签：c++, mfc, user-interface

我正在 MFC 中编写一个应用程序（不要问），我有一个包含数字的 CEdit 框。编辑该数字时，我想对更改采取行动，然后将插入符号替换为我对更改采取行动之前的位置-如果用户就在“。”之前 在“35.40”中，如果他们将其更改为“345.40”，我希望它仍然放在点之前。我目前正在接收 CHANGE 消息，但可以切换到其他内容（更新？）。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T13:53:08.707

在更改之前使用 GetSel() 函数来存储光标的位置，然后使用 SelSel() 将其设置回来。您可以使用这些函数来获取/设置插入符号的位置，而不仅仅是获取/设置用户所做的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T14:13:11.873

你能解释一下为什么要改变 CEdit 框的行为吗？作为用户，我每次输入某个字符时都会更改插入符号。或者，如果您以编程方式更改该值，您是否希望防止这种情况发生？

# php - 整洁转换为

> ID：92672
> 
> 赞同：2
> 
> 时间：2008-09-18T13:47:07.740
> 
> 标签：php, tidy

我正在使用 PHP 5 Tidy 类来格式化 html。

一切都很好，除非它被传递了一个样式属性，当它将它更改为一个类属性时。由于我只格式化文档的正文，而不是头部，因此头部中没有定义要读取的属性的类。

我查看了所有 Tidy 选项，但不知道如何阻止这种行为。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T14:18:04.887

尝试关闭[清洁](http://tidy.sourceforge.net/docs/quickref.html#clean)选项。

# performance - 哪个是自动 GUI 性能测试的最佳工具？

> ID：92679
> 
> 赞同：0
> 
> 时间：2008-09-18T13:48:16.317
> 
> 标签：performance, user-interface, testing

我们目前正在测试 Java Swing 应用程序的性能。我想知道是否有一个很好的工具来自动化这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T13:56:09.247

几年前，我使用[JMeter](http://jakarta.apache.org/jmeter/)来完成这样的任务。我通常喜欢使用它，尽管我从未对其他可用的东西进行过多研究，我不知道它是否仍在积极开发中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T13:56:34.347

收听 Pragmatic Programmers关于使用 Ruby 进行 GUI 测试的[播客。](http://podcasts.pragprog.com/2008-08/ian-dees-on-scripted-gui-testing-with-ruby.mp3)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T11:49:36.310

您可以尝试使用[Cucumber](http://cukes.info)和[Swinger](http://github.com/demetriusnunes/swinger)为 Swing GUI 应用程序用简单的英语编写功能验收测试。Cucumber 有一个包含分析信息的输出格式化程序。

Cucumber 允许您编写如下测试：

```
 Scenario: Dialog manipulation
    Given the frame "SwingSet" is visible
      And the frame "SwingSet" is the container
    When I click the menu "File/About"
    Then I should see the dialog "About Swing!"
    Given the dialog "About Swing!" is the container
    When I click the button "OK"
    Then I should not see the dialog "About Swing!" 
```

看看这个[Swinger 视频演示](http://blog.demetriusnunes.com/past/2009/6/9/who_said_you_cant_test_swing_apps/)，看看它的实际效果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T21:58:47.363

Pragmatic Programmers 还出版了一[本](https://rads.stackoverflow.com/amzn/click/com/1934356182)关于使用 Ruby 进行 GUI 测试的书。

特别是，他们给出了使用 JRuby 测试摇摆应用程序的大量示例。

他们所做的测试主要是为了测试功能，但我认为添加一些性能指标并不难。

这样做的好处是您可以获得很大的灵活性，但它不是一个打包的工具。

# .net - 如何在代码中定义列表视图模板

> ID：92689
> 
> 赞同：10
> 
> 时间：2008-09-18T13:49:35.737
> 
> 标签：.net, asp.net, controls, webforms

我正在编写一个复合控件，其中包含一个列表视图来显示项目表。通常在 Asp.NET 中使用 ListView 时，我会在代码转发中定义模板。

```
<asp:ListView runat="server" ID="ArticleList">
    <LayoutTemplate>
        <div class="ContentContainer">
            <div runat="server" id="itemPlaceholder" />
        </div>
    </LayoutTemplate>
    <ItemTemplate>
        <div>
            <div><%# Eval("Content") %></div>
        </div>
    </ItemTemplate>
    </asp:ListView> 
```

我假设它是这样的：

```
ListView view = new ListView();
view.LayoutTemplate = .....
view.ItemTemplate = .....

// when do I call these?
view.DataSource = myDataSource;
view.DataBind(); 
```

**更新：** 我通过实现 ITemplate 接口创建了 2 个模板：

```
private class LayoutTemplate : ITemplate
{
    public void InstantiateIn(Control container)
    {
        var outer = new HtmlGenericControl("div");
        var inner = new HtmlGenericControl("div") { ID = "itemPlaceholder" };
        table.Rows.Add(row);

        container.Controls.Add(table);
    }
}

private class ItemTemplate : ITemplate
{
    public void InstantiateIn(Control container)
    {
        var inner = new HtmlGenericControl("div");

        container.Controls.Add(inner);
    }
} 
```

我可以使用以下方法添加它们：

```
dataList.LayoutTemplate = new LayoutTemplate();
dataList.ItemTemplate = new ItemTemplate(); 
```

但后来我卡住了，因为 container.DataItem 为空。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-29T14:50:12.467

诀窍是在 ItemTemplate 中订阅 itemplaceholder 的数据绑定事件。

完整的解决方案：

```
public class FibonacciControl : CompositeControl
{
    public FibonacciControl()
    {
        // ....
    }

    protected override void CreateChildControls()
    {
        base.CreateChildControls();

        ListView view = new ListView();

        view.LayoutTemplate = new LayoutTemplate();
        view.ItemTemplate = new ItemTemplate();

        view.DataSource = FibonacciSequence();
        view.DataBind();

        this.Controls.Add(view);
    }

    private IEnumerable<int> FibonacciSequence()
    {

        int i1 = 0;
        int i2 = 1;

        for (int i = 0; i < Iterations; i++)
        {
            yield return i1 + i2;
            int temp = i1 + i2;
            i1 = i2;
            i2 = temp;
        }
        yield break;
    }

    public int Iterations { get; set; }

    private class LayoutTemplate : ITemplate
    {

        public void InstantiateIn(Control container)
        {
            var ol = new HtmlGenericControl("ol");
            var li = new HtmlGenericControl("li") { ID = "itemPlaceholder" };
            ol.Controls.Add(li);

            container.Controls.Add(ol);
        }
    }

    private class ItemTemplate : ITemplate
    {
        public void InstantiateIn(Control container)
        {
            var li = new HtmlGenericControl("li");

            li.DataBinding += DataBinding;
            container.Controls.Add(li);
        }

        public void DataBinding(object sender, EventArgs e)
        {
            var container = (HtmlGenericControl)sender;
            var dataItem = ((ListViewDataItem)container.NamingContainer).DataItem;

            container.Controls.Add( new Literal(){Text = dataItem.ToString() });
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T15:00:07.983

这个链接能有帮助吗？[以编程方式使用模板化控件](http://web.archive.org/web/20120414044008/http://iridescence.no/post/Using-Templated-Controls-Programmatically.aspx)

在设计时生成模板（以便将它们保存在 aspx 文件中）有点棘手，但 DataBinding 将自动工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-07T21:50:18.670

此处以 Sonteks 示例为基础是一个创建模板的示例，该模板包含然后使用数据绑定绑定的元素。

```
public partial class View : PortalModuleBase
{
    protected void Page_Load(object sender, EventArgs e)
    {

    }

    #region MasterListView_ItemDataBound
    public void MasterListView_ItemDataBound(object sender, ListViewItemEventArgs e)
    {
        ListViewItem objListViewItem = (ListViewItem)e.Item;
        ListViewDataItem objListViewDataItem = objListViewItem as ListViewDataItem;

        if (objListViewDataItem != null)
        {
            Tab objTab = (Tab)objListViewDataItem.DataItem;
            IEnumerable<Tab> Tabs = CustomData(objTab.TabID);

            Label TabIDLabel = (Label)objListViewItem.FindControl("TabIDLabel");
            Label TabNameLabel = (Label)objListViewItem.FindControl("TabNameLabel");

            TabIDLabel.Text = objTab.TabID.ToString();
            TabNameLabel.Text = objTab.TabName;

            AddListView(objTab.TabName, objListViewItem, Tabs);
        }
    }
    #endregion

    #region CustomData
    static IEnumerable<Tab> CustomData(int? ParentID)
    {
        TabAdminDataContext objTabAdminDataContext = new TabAdminDataContext();

        var myCustomData = from Tabs in objTabAdminDataContext.Tabs
                           where Tabs.ParentId == ParentID
                           select Tabs;

        return myCustomData.AsEnumerable();
    }
    #endregion

    #region AddListView
    private void AddListView(string CurrentTabName, Control container, IEnumerable<Tab> ChildTabs)
    {
        // The Tab has Children so add a ListView
        if (ChildTabs.Count() > 0)
        {
            ListView ChildListView = new ListView();
            ChildListView.ID = "ChildListView";
            ChildListView.ItemCommand += ListView_ItemCommand;
            ChildListView.EnableViewState = true;
            ChildListView.LayoutTemplate = new MyLayoutTemplate();
            ChildListView.ItemTemplate = new MyItemTemplate();
            ChildListView.DataSource = ChildTabs;
            ChildListView.DataBind();

            // Put the ListView in a Panel
            var oTR = new HtmlGenericControl("tr") { ID = "ChildListViewTR" };
            var oTD = new HtmlGenericControl("td") { ID = "ChildListViewTD" };

            Panel objPanel = new Panel();
            objPanel.ID = "ListViewPanel";
            objPanel.ToolTip = CurrentTabName;
            objPanel.Controls.Add(ChildListView);

            oTD.Controls.Add(objPanel);
            oTR.Controls.Add(oTD);
            container.Controls.Add(oTR);
        }
    }
    #endregion

    #region ListView_ItemCommand
    protected void ListView_ItemCommand(object sender, ListViewCommandEventArgs e)
    {
        LinkButton objButton = (LinkButton)sender;
        Label1.Text = objButton.Text;
        MasterListView.DataBind();
    }
    #endregion

    #region MyLayoutTemplate
    public class MyLayoutTemplate : ITemplate
    {
        public void InstantiateIn(Control container)
        {
            var oTR = new HtmlGenericControl("tr") { ID = "itemPlaceholder" };
            container.Controls.Add(oTR);
        }
    }
    #endregion

    #region ItemTemplate
    public class MyItemTemplate : ITemplate
    {
        public void InstantiateIn(Control container)
        {
            var oTR = new HtmlGenericControl("tr");

            var oTD1 = new HtmlGenericControl("td");
            LinkButton TabIDLinkButton = new LinkButton();
            TabIDLinkButton.ID = "TabIDLinkButton";
            oTD1.Controls.Add(TabIDLinkButton);
            oTR.Controls.Add(oTD1);

            var oTD2 = new HtmlGenericControl("td");
            Label TabNameLabel = new Label();
            TabNameLabel.ID = "TabNameLabel";
            oTD2.Controls.Add(TabNameLabel);
            oTR.Controls.Add(oTD2);

            oTR.DataBinding += DataBinding;
            container.Controls.Add(oTR);
        }

        public void DataBinding(object sender, EventArgs e)
        {
            var container = (HtmlGenericControl)sender;
            var dataItem = ((ListViewDataItem)container.NamingContainer).DataItem;
            Tab objTab = (Tab)dataItem;

            LinkButton TabIDLinkButton = (LinkButton)container.FindControl("TabIDLinkButton");
            Label TabNameLabel = (Label)container.FindControl("TabNameLabel");

            TabIDLinkButton.Text = "+" + objTab.TabID.ToString();
            TabNameLabel.Text = objTab.TabName;

            IEnumerable<Tab> ChildTabs = View.CustomData(objTab.TabID);

            View objView = new View();
            objView.AddListView(objTab.TabName, container, ChildTabs);
        }

    }
    #endregion

} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-09-18T17:09:21.590

设置一个类，如：

```
public delegate void InstantiateTemplateDelegate(Control container);

public class GenericTemplateImplementation : ITemplate
{
    private InstantiateTemplateDelegate instantiateTemplate;

    public void InstantiateIn(Control container)
    {
        this.instantiateTemplate(container);
    }

    public GenericTemplateImplementation(InstantiateTemplateDelegate instantiateTemplate)
    {
        this.instantiateTemplate = instantiateTemplate;
    }
} 
```

然后执行以下操作：

```
 view.LayoutTemplate = new GenericTemplateImplementation(p =>
                {
                    p.Controls.Add(new Label { Text = "Foo" });
                }); 
```

# sql-server - 如何获得 CPU/内存/等方面的数据库特定性能指标。在 SQL Server 2005 中？

> ID：92696
> 
> 赞同：0
> 
> 时间：2008-09-18T13:50:33.893
> 
> 标签：sql-server, sql-server-2005, performance, optimization

我在一个共享的 SQL Server 2005 集群实例上有几个数据库，我想要性能指标。我有一些进程运行了很长时间，并且怀疑代码效率低下，而不是硬件不足是罪魁祸首。

我想要一些方法来获得这些性能指标，这样我就可以排除数据库硬件是罪魁祸首。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T13:58:44.293

这很棘手……您可以使用性能监视器来跟踪硬件和操作系统因素——例如 CPU 使用率、内存；以及各种 SQL Server 计数器，例如每秒查询数。显然，内存使用情况会告诉您是否需要更多 RAM，但要判断（比如说）高 CPU 使用率是由于代码效率低下还是由于代码密集造成的并不容易。

一些计数器更有助于深入研究性能问题 - 可以计算数据库中的锁之类的东西，问题是您无法分辨多少是太多，因为所有代码的工作方式都不同。您可以判断您是否经历了太多，或者缓慢的时期是否等同于大量计数。这也适用于其他各种柜台 - 去看看有什么可以查看的。

另一件事是运行跟踪（sql server 工具）以获取正在运行的查询列表。取一些最慢/最大的，看看当你运行它们时会出现什么执行计划——这表明你可以优化查询，尽管由你来决定代码是效率低下还是和以前一样密集。

最后，获得一个像 Spotlight 这样的工具，它可以汇总大量数据库统计数据并将其详细显示给您。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T14:12:09.440

我刚刚阅读了一篇关于使用 typeperf.exe 中内置的 windows 来解决这个问题的好文章。 [http://www.mssqltips.com/tip.asp?tip=1575](http://www.mssqltips.com/tip.asp?tip=1575)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T16:49:57.347

啊，听起来像是 SQL Profiler 的工作。 [http://msdn.microsoft.com/en-us/library/ms181091(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms181091(SQL.90).aspx)

# vba - 合并行/连接行

> ID：92698
> 
> 赞同：8
> 
> 时间：2008-09-18T13:50:44.580
> 
> 标签：vba, ms-access, coalesce

我正在寻找与 SQL Server 的 COALESCE 函数等效的 Access 2007。

在 SQL Server 中，您可以执行以下操作：

**人**

```
John
Steve
Richard 
```

**SQL**

```
DECLARE @PersonList nvarchar(1024)
SELECT @PersonList = COALESCE(@PersonList + ',','') + Person
FROM PersonTable

PRINT @PersonList 
```

产生：约翰、史蒂夫、理查德

我想做同样的事情，但在 Access 2007 中。

有谁知道如何在 Access 2007 中组合这样的行？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-18T15:56:41.453

这是一个示例用户定义函数 (UDF) 和可能的用法。

功能：

```
Function Coalsce(strSQL As String, strDelim, ParamArray NameList() As Variant)
Dim db As Database
Dim rs As DAO.Recordset
Dim strList As String

    Set db = CurrentDb

    If strSQL <> "" Then
        Set rs = db.OpenRecordset(strSQL)

        Do While Not rs.EOF
            strList = strList & strDelim & rs.Fields(0)
            rs.MoveNext
        Loop

        strList = Mid(strList, Len(strDelim))
    Else

        strList = Join(NameList, strDelim)
    End If

    Coalsce = strList

End Function 
```

用法：

```
SELECT documents.MembersOnly, 
    Coalsce("SELECT FName From Persons WHERE Member=True",":") AS Who, 
    Coalsce("",":","Mary","Joe","Pat?") AS Others
FROM documents; 
```

ADO 版本，灵感来自 onedaywhen 的评论

```
Function ConcatADO(strSQL As String, strColDelim, strRowDelim, ParamArray NameList() As Variant)
   Dim rs As New ADODB.Recordset
   Dim strList As String

   On Error GoTo Proc_Err

       If strSQL <> "" Then
           rs.Open strSQL, CurrentProject.Connection
           strList = rs.GetString(, , strColDelim, strRowDelim)
           strList = Mid(strList, 1, Len(strList) - Len(strRowDelim))
       Else
           strList = Join(NameList, strColDelim)
       End If

       ConcatADO = strList

   Exit Function

   Proc_Err:
       ConcatADO = "***" & UCase(Err.Description)
   End Function 
```

来自：[http ://wiki.lessthandot.com/index.php/Concatenate_a_List_into_a_Single_Field_%28Column%29](http://wiki.lessthandot.com/index.php/Concatenate_a_List_into_a_Single_Field_%28Column%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T14:12:15.447

我认为 Nz 是你所追求的，语法是`Nz(variant, [if null value])`. 这是文档链接：[Nz Function](http://office.microsoft.com/en-us/access/HA012288901033.aspx)

```
---Person--- 
John
Steve
Richard

DECLARE @PersonList nvarchar(1024)
SELECT @PersonList = Nz(@PersonList + ',','') + Person
FROM PersonTable

PRINT @PersonList 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T14:38:27.850

尽管 Nz 做了与 COALESCE 类似的事情，但您不能在 Access 中使用它来执行您正在执行的操作。构建行值列表的不是 COALESCE，而是变量的连接。

不幸的是，这在 Access 查询中是不可能的，该查询必须是单个 SQL 语句并且没有声明变量的工具。

我认为您需要创建一个函数来打开一个结果集，对其进行迭代并将行值连接成一个字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T14:58:57.580

要在 Access 中组合行，您可能需要如下所示的代码：

```
Public Function Coalesce(pstrTableName As String, pstrFieldName As String)

Dim rst As DAO.Recordset
Dim str As String

    Set rst = CurrentDb.OpenRecordset(pstrTableName)
    Do While rst.EOF = False
        If Len(str) = 0 Then
            str = rst(pstrFieldName)
        Else
            str = str & "," & rst(pstrFieldName)
        End If
        rst.MoveNext
    Loop

    Coalesce = str

End Function 
```

您将需要添加错误处理代码并清理您的记录集，如果您使用 ADO 而不是 DAO，这将略有改变，但总体思路是相同的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T15:02:05.717

我在这里了解到您有一个包含 3 条记录的表“人”。没有什么比得上你在 Access 中描述的。

在“标准”访问（DAO 记录集）中，您必须打开一个记录集并使用 getrows 方法来获取您的数据

```
Dim rs as DAO.recordset, _
    personList as String, _
    personArray() as variant

set rs = currentDb.open("Person")
set personArray = rs.getRows(rs.recordcount)

rs.close 
```

一旦你有了这个数组（它将是二维的），你可以操纵它来提取你需要的“列”。可能有一种聪明的方法可以从中提取一维数组，因此您可以使用“Join”指令将每个数组值连接到一个字符串中。

# sql - 计算生效日期的非迭代/非循环方式？

> ID：92699
> 
> 赞同：3
> 
> 时间：2008-09-18T13:50:48.260
> 
> 标签：sql, date

我有一张名为 OffDays 的表，其中保留了周末和节假日日期。我有一个名为 LeadTime 的表，其中存储了要制造的产品的时间量（以天为单位）。最后，我有一个名为 Order 的表，其中保存了产品和订单日期。

是否可以在不使用存储过程或循环的情况下查询产品何时完成制造？

例如：

*   OffDays 有 2008-01-10、2008-01-11、2008-01-14。
*   LeadTime 对产品 9 有 5 个。
*   产品 9 的订单为 2008-01-09。

我正在寻找的计算是这样的：

*   2008-01-09 1
*   2008-01-10 x
*   2008-01-11 x
*   2008-01-12 2
*   2008-01-13 3
*   2008-01-14 x
*   2008-01-15 4
*   2008-01-16 5

我想知道是否可以让查询返回 2008-01-16 而不必使用存储过程，或者在我的应用程序代码中计算它。

**编辑（为什么没有存储过程/循环）：** 我不能使用存储过程的原因是数据库不支持它们。我只能添加额外的表/数据。该应用程序是第三方报告工具，我只能控制 SQL 查询。

**编辑（我现在是怎么做的）：** 我目前的方法是我在订单表中有一个额外的列来保存计算的日期，然后计划任务/cron 作业每小时对所有订单运行计算。由于几个原因，这不太理想。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T13:55:13.663

最好的方法是使用日历表。

请参阅[http://web.archive.org/web/20070611150639/http://sqlserver2000.databases.aspfaq.com/why-should-i-consider-using-an-auxiliary-calendar-table.html](http://web.archive.org/web/20070611150639/http://sqlserver2000.databases.aspfaq.com/why-should-i-consider-using-an-auxiliary-calendar-table.html)。

然后您的查询可能类似于：

```
SELECT c.dt, l.*, o.*, c.*
    FROM [statistics].dbo.[calendar] c, 
    [order] o  JOIN
    lead l ON l.leadId = o.leadId
    WHERE c.isWeekday = 1 
    AND   c.isHoliday =0 
    AND   o.orderId = 1
    AND   l.leadDays = ( 
        SELECT COUNT(*)  
            FROM [statistics].dbo.Calendar c2 
            WHERE c2.dt >= o.startDate
            AND c2.dt <= c.dt 
            AND c2.isWeekday=1 
            AND c2.isHoliday=0 
    ) 
```

希望有帮助，

RB。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T14:04:37.773

您可以提前生成一个工作日表。

```
WDId | WDDate
-----+-----------
4200 | 2008-01-08
4201 | 2008-01-09
4202 | 2008-01-12
4203 | 2008-01-13
4204 | 2008-01-16
4205 | 2008-01-17 
```

然后进行查询，例如

```
SELECT DeliveryDay.WDDate FROM WorkingDay OrderDay, WorkingDay DeliveryDay, LeadTime, Order where DeliveryDay.WDId = OrderDay.WDId + LeadTime.LTDays AND OrderDay.WDDate = '' AND LeadTime.ProductId = Order.ProductId AND Order.OrderId = 1234 
```

您需要一个带有循环的存储过程来生成 WorkingDays 表，但不需要用于常规查询。与使用应用程序代码计算天数相比，到服务器的往返次数也更少。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T13:53:40.517

只需在应用程序代码中计算它...更容易，您不必在 sql 中编写一个非常丑陋的查询

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T14:42:06.170

这是一种方法 - 使用 dateadd 函数。

我需要把这个答案从桌面上拿下来。这在很长的交货时间内不会正常工作。它只是添加在提前期中找到的休息天数并将日期推迟。当新范围内出现更多休息日时，这将导致问题。

```
-- Setup test
create table #odays (offd datetime)
create table #leadtime (pid int , ltime int)
create table [#order] (pid int, odate datetime)

insert into #odays 
select '1/10/8'
insert into #odays 
select '1/11/8'
insert into #odays 
select '1/14/8'

insert into #Leadtime
values (3,5)
insert into #leadtime
values (9, 5)

insert into #order 
values( 9, '1/9/8')

select dateadd(dd, 
(select count(*)-1 
   from #odays 
   where offd between odate and  
    (select odate+ltime 
       from #order o 
       left join #leadtime l 
         on o.pid = l.pid 
       where l.pid = 9
     )
 ),
 odate+ltime) 
 from #order o 
 left join #leadtime l  
   on o.pid = l.pid 
 where o.pid = 9 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T13:59:39.470

你为什么反对使用循环？

//一些伪代码

```
int leadtime = 5;
date order = 2008-01-09;
date finishdate = order;
while (leadtime > 0) {
finishdate.addDay();
if (!IsOffday(finishdate)) leadtime--;
}
return finishdate;
```

这似乎是一个过于简单的功能，无法尝试找到非循环方式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T14:03:54.267

嗯.. 一种解决方案可能是存储一个日期表，该表的偏移量基于从年初开始计算的非休息天数。让我们说一月。2 是休息日。08 年 1 月 1 日的偏移量为 1（如果您想从 0 开始，则为 0）。08 年 1 月 3 日的偏移量为 2，因为计数跳过了 08 年 1 月 2 日。从那里可以进行简单的计算。获取订单日期的偏移量，添加提前期，然后查找计算的偏移量以获取结束日期。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T14:49:07.590

一种方法（不创建另一个表）是使用一种上限函数：对于每个关闭日期，在子查询中找出相对于订单日期有多少“在日期”出现在它之前。然后取小于提前期的最高数字。使用对应的日期，加上余数。

此代码可能特定于 PostgreSQL，如果这不是您使用的，请见谅。

```
CREATE DATABASE test;
CREATE TABLE offdays
(
  offdate date NOT NULL,
  CONSTRAINT offdays_pkey PRIMARY KEY (offdate)
);
insert into offdays (offdate) values ('2008-01-10');
insert into offdays (offdate) values ('2008-01-11');
insert into offdays (offdate) values ('2008-01-14');
insert into offdays (offdate) values ('2008-01-18'); -- just for testing
CREATE TABLE product
(
  id integer NOT NULL,
  CONSTRAINT product_pkey PRIMARY KEY (id)
);
insert into product (id) values (9);
CREATE TABLE leadtime
(
  product integer NOT NULL,
  leaddays integer NOT NULL,
  CONSTRAINT leadtime_pkey PRIMARY KEY (product),
  CONSTRAINT leadtime_product_fkey FOREIGN KEY (product)
      REFERENCES product (id) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE NO ACTION
);
insert into leadtime (product, leaddays) values (9, 5);
CREATE TABLE "order"
(
  product integer NOT NULL,
  "start" date NOT NULL,
  CONSTRAINT order_pkey PRIMARY KEY (product),
  CONSTRAINT order_product_fkey FOREIGN KEY (product)
      REFERENCES product (id) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE NO ACTION
);
insert into "order" (product, "start") values (9, '2008-01-09');

-- finally, the query:

select e.product, offdate + (leaddays - ondays)::integer as "end"
from
(
    select c.product, offdate, (select (a.offdate - c."start") - count(b.offdate) from offdays b where b.offdate < a.offdate) as ondays, d.leaddays
    from offdays a, "order" c
    inner join leadtime d on d.product = c.product
) e
where leaddays >= ondays
order by "end" desc
limit 1; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T18:22:44.643

这是 PostgreSQL 语法，但应该很容易翻译成其他 SQL 方言

```
--Sample data
create table offdays(datum date);

insert into offdays(datum)
select to_date('2008-01-10','yyyy-MM-dd') UNION 
select to_date('2008-01-11','yyyy-MM-dd') UNION 
select to_date('2008-01-14','yyyy-MM-dd') UNION 
select to_date('2008-01-20','yyyy-MM-dd') UNION
select to_date('2008-01-21','yyyy-MM-dd') UNION
select to_date('2008-01-26','yyyy-MM-dd');

create table leadtime (product_id integer , lead_time integer);
insert into leadtime(product_id,lead_time) values (9,5);

create table myorder (order_id integer,product_id integer, datum date);
insert into myorder(order_id,product_id,datum) 
values (1,9,to_date('2008-01-09','yyyy-MM-dd'));
insert into myorder(order_id,product_id,datum) 
values (2,9,to_date('2008-01-16','yyyy-MM-dd'));
insert into myorder(order_id,product_id,datum) 
values (3,9,to_date('2008-01-23','yyyy-MM-dd'));

--Query
select order_id,min(finished_date)
FROM 
    (select mo.order_id,(mo.datum+lead_time+count(od2.*)::integer-1) as finished_date
     from 
         myorder mo
         join leadtime lt on (mo.product_id=lt.product_id)
         join offdays od1 on (mo.datum<od1.datum)
         left outer join offdays od2 on (mo.datum<od2.datum and od2.datum<od1.datum)
     group by  mo.order_id,mo.datum,lt.lead_time,od1.datum
     having (mo.datum+lead_time+count(od2.*)::integer-1) < od1.datum) tmp
group by 1;       

--Results :
1    2008.01.16
2    2008.01.22 
```

对于将在 offdays 表中的最后一个日期之后完成的订单（订单号 3），这**不会返回**结果，因此您必须注意按时插入 offdays。假设订单不会在 offdays 开始。

# javascript - jQuery/JavaScript 替换损坏的图像

> ID：92720
> 
> 赞同：577
> 
> 时间：2008-09-18T13:53:32.840
> 
> 标签：javascript, jquery, html, brokenimage

我有一个包含一堆图像的网页。有时图像不可用，因此客户端浏览器中会显示损坏的图像。

如何使用 jQuery 获取图像集，将其过滤为损坏的图像，然后替换 src？

* * *

--我认为使用 jQuery 会更容易做到这一点，但结果证明只使用纯 JavaScript 解决方案要容易得多，即 Prestaul 提供的解决方案。

* * *

## 回答 #1

> 赞同：805
> 
> 时间：2008-09-18T14:04:21.050

使用 JavaScript处理`onError`图像以重新分配其源的事件：

```
function imgError(image) {
    image.onerror = "";
    image.src = "/images/noimage.gif";
    return true;
} 
```

```
<img src="image.png" onerror="imgError(this);"/> 
```

或者没有 JavaScript 函数：

```
<img src="image.png" onError="this.onerror=null;this.src='/images/noimage.gif';" /> 
```

以下兼容性表列出了支持错误工具的浏览器：

[http://www.quirksmode.org/dom/events/error.html](http://www.quirksmode.org/dom/events/error.html)

* * *

## 回答 #2

> 赞同：211
> 
> 时间：2008-10-03T19:18:11.953

我使用内置的`error`处理程序：

```
$("img").error(function () {
    $(this).unbind("error").attr("src", "broken.gif");
}); 
```

**编辑：**该`error()`方法在[jquery 1.8](https://api.jquery.com/error/)及更高版本中已弃用。相反，您应该`.on("error")`改用：

```
$("img").on("error", function () {
    $(this).attr("src", "broken.gif");
}); 
```

* * *

## 回答 #3

> 赞同：130
> 
> 时间：2012-06-15T13:54:28.463

如果像我这样的人尝试将`error`事件附加到动态 HTML`img`标记，我想指出，有一个问题：

[与标准](http://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-eventgroupings-htmlevents)所说的相反，显然`img`错误事件在大多数浏览器中**[都不会冒泡。](http://forum.jquery.com/topic/error-event-with-live)**

因此，以下内容将**不起作用**：

```
$(document).on('error', 'img', function () { ... }) 
```

希望这对其他人有帮助。我希望我在这个线程中看到了这个。但是，我没有。所以，我添加它

* * *

## 回答 #4

> 赞同：62
> 
> 时间：2008-09-18T14:26:43.260

这是一个独立的解决方案：

```
$(window).load(function() {
  $('img').each(function() {
    if ( !this.complete
    ||   typeof this.naturalWidth == "undefined"
    ||   this.naturalWidth == 0                  ) {
      // image was broken, replace with your new image
      this.src = 'http://www.tranism.com/weblog/images/broken_ipod.gif';
    }
  });
}); 
```

* * *

## 回答 #5

> 赞同：39
> 
> 时间：2008-09-18T14:05:26.510

我相信这就是你所追求的：[jQuery.Preload](http://flesler.blogspot.com/2008/01/jquerypreload.html)

这是演示中的示例代码，您指定了加载和未找到的图像，并且一切就绪：

```
jQuery('#images img').preload({
  placeholder:'placeholder.jpg',
  notFound:'notfound.jpg'
}); 
```

* * *

## 回答 #6

> 赞同：30
> 
> 时间：2010-03-25T23:57:06.113

```
$(window).bind('load', function() {
  $('img').each(function() {
    if( (typeof this.naturalWidth != "undefined" && this.naturalWidth == 0) 
    ||  this.readyState == 'uninitialized'                                  ) {
        $(this).attr('src', 'missing.jpg');
    }
  });
}); 
```

来源： http: [//www.developria.com/2009/03/jquery-quickie---broken-images.html](http://www.developria.com/2009/03/jquery-quickie---broken-images.html)

* * *

## 回答 #7

> 赞同：25
> 
> 时间：2016-10-26T13:41:54.977

虽然 OP 正在寻找替换 SRC，但我敢肯定，很多人遇到这个问题可能只想隐藏损坏的图像，在这种情况下，[这个简单的解决方案](https://stackoverflow.com/a/3675104/937377)对我来说非常有用。

# 使用内联 JavaScript：

```
<img src="img.jpg" onerror="this.style.display='none';" />
```

# 使用外部 JavaScript：

```
var images = document.querySelectorAll('img');

for (var i = 0; i < images.length; i++) {
  images[i].onerror = function() {
    this.style.display='none';
  }
}
```

```
<img src='img.jpg' />
```

# 使用现代外部 JavaScript：

```
document.querySelectorAll('img').forEach((img) => {
  img.onerror = function() {
    this.style.display = 'none';
  }
});
```

```
<img src='img.jpg' />
```

请参阅浏览器对[NodeList.forEach](https://caniuse.com/#feat=mdn-api_nodelist_foreach)和[箭头函数](https://caniuse.com/#feat=arrow-functions)的支持。

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2014-02-18T15:59:39.670

这是替换所有损坏图像的快捷方式，无需更改 HTML 代码；）

[代码笔示例](https://codepen.io/ASHFAQAHMED/pen/RYxyjm)

```
 $("img").each(function(){
        var img = $(this);
        var image = new Image();
        image.src = $(img).attr("src");
        var no_image = "https://dummyimage.com/100x100/7080b5/000000&text=No+image";
        if (image.naturalWidth == 0 || image.readyState == 'uninitialized'){
            $(img).unbind("error").attr("src", no_image).css({
                height: $(img).css("height"),
                width: $(img).css("width"),
            });
        }
  }); 
```

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2014-04-11T13:54:10.653

这是一种糟糕的技术，但几乎可以保证：

```
<img onerror="this.parentNode.removeChild(this);"> 
```

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2011-12-20T12:15:27.267

我找不到适合我需要的脚本，所以我创建了一个递归函数来检查损坏的图像并尝试每四秒重新加载一次，直到它们被修复。

我将其限制为 10 次尝试，就好像它尚未加载一样，图像可能不存在于服务器上，并且该函数将进入无限循环。不过我还在测试。随意调整它:)

```
var retries = 0;
$.imgReload = function() {
    var loaded = 1;

    $("img").each(function() {
        if (!this.complete || typeof this.naturalWidth == "undefined" || this.naturalWidth == 0) {

            var src = $(this).attr("src");
            var date = new Date();
            $(this).attr("src", src + "?v=" + date.getTime()); //slightly change url to prevent loading from cache
            loaded =0;
        }
    });

    retries +=1;
    if (retries < 10) { // If after 10 retries error images are not fixed maybe because they
                        // are not present on server, the recursion will break the loop
        if (loaded == 0) {
            setTimeout('$.imgReload()',4000); // I think 4 seconds is enough to load a small image (<50k) from a slow server
        }
        // All images have been loaded
        else {
            // alert("images loaded");
        }
    }
    // If error images cannot be loaded  after 10 retries
    else {
        // alert("recursion exceeded");
    }
}

jQuery(document).ready(function() {
    setTimeout('$.imgReload()',5000);
}); 
```

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2014-08-19T06:53:36.550

这是 JavaScript，应该是跨浏览器兼容的，并且没有丑陋的标记`onerror=""`：

```
var sPathToDefaultImg = 'http://cdn.sstatic.net/stackexchange/img/logos/so/so-icon.png',
    validateImage = function( domImg ) {
        oImg = new Image();
        oImg.onerror = function() {
            domImg.src = sPathToDefaultImg;
        };
        oImg.src = domImg.src;
    },
    aImg = document.getElementsByTagName( 'IMG' ),
    i = aImg.length;

while ( i-- ) {
    validateImage( aImg[i] );
} 
```

[编解码器：](http://codepen.io/elstermann/pen/giEvC?editors=001)

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2016-05-02T19:54:15.093

您可以为此使用 GitHub 自己的 fetch：

前端：[https](https://github.com/github/fetch)
://github.com/github/fetch 或后端，Node.js 版本：[https ://github.com/bitinn/node-fetch](https://github.com/bitinn/node-fetch)

```
fetch(url)
  .then(function(res) {
    if (res.status == '200') {
      return image;
    } else {
      return placeholder;
    }
  } 
```

编辑：此方法将取代 XHR，据说已经在 Chrome 中。对于将来阅读本文的任何人，您可能不需要包含上述库。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2011-12-23T23:04:19.440

更好地调用使用

```
jQuery(window).load(function(){
    $.imgReload();
}); 
```

因为 using`document.ready`并不一定意味着加载图像，只加载 HTML。因此，不需要延迟呼叫。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2013-06-27T20:34:21.003

```
(window.jQuery || window.Zepto).fn.fallback = function (fallback) {
  return this.one('error', function () {
    var self = this;
    this.src = (fallback || 'http://lorempixel.com/$width/$height').replace(
      /\$(\w+)/g, function (m, t) { return self[t] || ''; }
    );
  });
}; 
```

您可以通过以下方式传递占位符路径并访问失败图像对象的所有属性`$*`：

```
$('img').fallback('http://dummyimage.com/$widthx$height&text=$src'); 
```

[http://jsfiddle.net/ARTsinn/Cu4Zn/](http://jsfiddle.net/ARTsinn/Cu4Zn/)

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2013-07-18T17:24:27.677

[CoffeeScript](http://en.wikipedia.org/wiki/CoffeeScript)变体：

我修复了 Turbolinks 的一个问题，该问题有时会导致 .error() 方法在 Firefox 中出现，即使图像确实存在。

```
$("img").error ->
  e = $(@).get 0
  $(@).hide() if !$.browser.msie && (typeof this.naturalWidth == "undefined" || this.naturalWidth == 0) 
```

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2014-04-25T15:20:46.170

多年来，这一直让我感到沮丧。我的 CSS 修复在`img`. 当动态图像`src`未加载到前景时，会在 的背景上看到一个占位符`img`。如果您的图像具有默认大小（例如`height`、和/或）`min-height`，则此方法有效。`width``min-width`

您会看到损坏的图像图标，但这是一种改进。成功测试到IE9。iOS Safari 和 Chrome 甚至不显示损坏的图标。

```
.dynamicContainer img {
  background: url('/images/placeholder.png');
  background-size: contain;
} 
```

添加一个小动画，让`src`加载时间没有背景闪烁。Chrome 会在后台平稳地淡入，但桌面版 Safari 则不会。

```
.dynamicContainer img {
  background: url('/images/placeholder.png');
  background-size: contain;
  animation: fadein 1s;                     
}

@keyframes fadein {
  0%   { opacity: 0.0; }
  50%  { opacity: 0.5; }
  100% { opacity: 1.0; }
} 
```

```
.dynamicContainer img {
  background: url('https://picsum.photos/id/237/200');
  background-size: contain;
  animation: fadein 1s;
}

@keyframes fadein {
  0% {
    opacity: 0.0;
  }
  50% {
    opacity: 0.5;
  }
  100% {
    opacity: 1.0;
  }
}

img {
  /* must define dimensions */
  width: 200px;
  height: 200px;
  min-width: 200px;
  min-height: 200px;
  /* hides broken text */
  color: transparent;
  /* optional css below here */
  display: block;
  border: .2em solid black;
  border-radius: 1em;
  margin: 1em;
}
```

```
<div class="dynamicContainer">
  <img src="https://picsum.photos/200" alt="Found image" />
  <img src="https://picsumx.photos/200" alt="Not found image" />
</div>
```

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2014-06-29T10:28:07.903

通过使用[Prestaul 的回答](https://stackoverflow.com/questions/92720/jquery-javascript-to-replace-broken-images/92819#92819)，我添加了一些检查，我更喜欢使用 jQuery 方式。

```
<img src="image1.png" onerror="imgError(this,1);"/>
<img src="image2.png" onerror="imgError(this,2);"/>

function imgError(image, type) {
    if (typeof jQuery !== 'undefined') {
       var imgWidth=$(image).attr("width");
       var imgHeight=$(image).attr("height");

        // Type 1 puts a placeholder image
        // Type 2 hides img tag
        if (type == 1) {
            if (typeof imgWidth !== 'undefined' && typeof imgHeight !== 'undefined') {
                $(image).attr("src", "http://lorempixel.com/" + imgWidth + "/" + imgHeight + "/");
            } else {
               $(image).attr("src", "http://lorempixel.com/200/200/");
            }
        } else if (type == 2) {
            $(image).hide();
        }
    }
    return true;
} 
```

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2014-11-12T12:22:41.590

如果您插入了`img`with `innerHTML`，例如：`$("div").innerHTML = <img src="wrong-uri">`，如果它失败，您可以加载另一个图像，例如：

```
<script>
    function imgError(img) {
        img.error="";
        img.src="valid-uri";
    }
</script>

<img src="wrong-uri" onerror="javascript:imgError(this)"> 
```

为什么`javascript: _`需要？因为通过 script 标签注入到 DOM 中的脚本在`innerHTML`注入时不会运行，因此您必须明确。

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2016-07-13T18:28:34.237

我在查看[其他 SO 帖子](https://stackoverflow.com/questions/18837735/check-if-image-exists-on-server-using-javascript)时发现了这篇文章。以下是我在那里给出的答案的副本。

我知道这是一个旧线程，但是 React 已经变得流行起来，也许使用 React 的人会来这里寻找相同问题的答案。

因此，如果您使用 React，您可以执行以下操作，这是由 React 团队的 Ben Alpert 提供的原始[答案](https://discuss.reactjs.org/t/onerror-for-img-to-hide-images-with-error/2094)

```
getInitialState: function(event) {
    return {image: "http://example.com/primary_image.jpg"};
},
handleError: function(event) {
    this.setState({image: "http://example.com/failover_image.jpg"});
},
render: function() {
    return (
        <img onError={this.handleError} src={src} />;
    );
} 
```

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2016-09-01T13:23:34.700

我创建了一个[小提琴](https://jsfiddle.net/Rohith_KP/3mqecx69/6/)来使用“onerror”事件替换损坏的图像。这可能会对您有所帮助。

```
 //the placeholder image url
    var defaultUrl = "url('https://sadasd/image02.png')";

    $('div').each(function(index, item) {
      var currentUrl = $(item).css("background-image").replace(/^url\(['"](.+)['"]\)/, '$1');
      $('<img>', {
        src: currentUrl
      }).on("error", function(e) {
        $this = $(this);
        $this.css({
          "background-image": defaultUrl
        })
        e.target.remove()
      }.bind(this))
    }) 
```

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2016-11-04T16:00:23.257

这是一个使用 JQuery 包装的 HTML5 Image 对象的示例。调用主图像 URL 的加载函数，如果该加载导致错误，请将图像的 src 属性替换为备用 URL。

```
function loadImageUseBackupUrlOnError(imgId, primaryUrl, backupUrl) {
    var $img = $('#' + imgId);
    $(new Image()).load().error(function() {
        $img.attr('src', backupUrl);
    }).attr('src', primaryUrl)
}

<img id="myImage" src="primary-image-url"/>
<script>
    loadImageUseBackupUrlOnError('myImage','primary-image-url','backup-image-url');
</script> 
```

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2017-04-07T15:10:16.450

纯JS。我的任务是：如果图像'bl-once.png'为空->从数组列表（在当前目录中）插入第一个（没有404状态）图像：

```
<img src="http://localhost:63342/GetImage/bl-once.png" width="200" onerror="replaceEmptyImage.insertImg(this)">
```

也许它需要改进，但是：

```
var srcToInsertArr = ['empty1.png', 'empty2.png', 'needed.png', 'notActual.png']; // try to insert one by one img from this array
    var path;
    var imgNotFounded = true; // to mark when success

    var replaceEmptyImage = {
        insertImg: function (elem) {

            if (srcToInsertArr.length == 0) { // if there are no more src to try return
                return "no-image.png";
            }
            if(!/undefined/.test(elem.src)) { // remember path
                path = elem.src.split("/").slice(0, -1).join("/"); // "http://localhost:63342/GetImage"
            }
            var url = path + "/" + srcToInsertArr[0];

            srcToInsertArr.splice(0, 1); // tried 1 src

                if(imgNotFounded){ // while not success
                    replaceEmptyImage.getImg(url, path, elem); // CALL GET IMAGE
                }

        },
        getImg: function (src, path, elem) { // GET IMAGE

            if (src && path && elem) { // src = "http://localhost:63342/GetImage/needed.png"

                var pathArr = src.split("/"); // ["http:", "", "localhost:63342", "GetImage", "needed.png"]
                var name = pathArr[pathArr.length - 1]; // "needed.png"

                xhr = new XMLHttpRequest();
                xhr.open('GET', src, true);
                xhr.send();

                xhr.onreadystatechange = function () {

                    if (xhr.status == 200) {
                        elem.src = src; // insert correct src
                        imgNotFounded = false; // mark success
                    }
                    else {
                        console.log(name + " doesn't exist!");
                        elem.onerror();
                    }

                }
            }
        }

    };
```

因此，它会将正确的 'needed.png' 插入到我的 src 或当前目录中的 'no-image.png' 中。

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2008-09-18T14:05:27.523

我不确定是否有更好的方法，但我可以想到一个 hack 来获得它 - 你可以 Ajax 发布到 img URL，并解析响应以查看图像是否真的回来了。如果它以 404 或其他形式返回，则换掉 img。虽然我预计这会很慢。

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2013-10-21T11:11:39.920

我用这两个简单的功能解决了我的问题：

```
function imgExists(imgPath) {
    var http = jQuery.ajax({
                   type:"HEAD",
                   url: imgPath,
                   async: false
               });
    return http.status != 404;
}

function handleImageError() {
    var imgPath;

    $('img').each(function() {
        imgPath = $(this).attr('src');
        if (!imgExists(imgPath)) {
            $(this).attr('src', 'images/noimage.jpg');
        }
    });
} 
```

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2017-09-02T03:16:04.453

jQuery 1.8

```
// If missing.png is missing, it is replaced by replacement.png
$( "img" )
  .error(function() {
    $( this ).attr( "src", "replacement.png" );
  })
  .attr( "src", "missing.png" ); 
```

jQuery 3

```
// If missing.png is missing, it is replaced by replacement.png
$( "img" )
  .on("error", function() {
    $( this ).attr( "src", "replacement.png" );
  })
  .attr( "src", "missing.png" ); 
```

[参考](https://api.jquery.com/error/)

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2018-01-14T15:56:36.130

有时使用`error`事件是不可行的，例如因为您试图在已经加载的页面上执行某些操作，例如当您通过控制台、书签或异步加载的脚本运行代码时。在这种情况下，检查`img.naturalWidth`and`img.naturalHeight`是 0 似乎可以解决问题。

例如，这是一个从控制台重新加载所有损坏图像的片段：

```
$$("img").forEach(img => {
  if (!img.naturalWidth && !img.naturalHeight) {
    img.src = img.src;
  }
} 
```

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2018-05-23T09:37:43.143

我认为即使备份图像无法加载，我也有一种更优雅`window`的方式来处理事件委托和事件捕获。`error`

```
img {
  width: 100px;
  height: 100px;
}
```

```
<script>
  window.addEventListener('error', windowErrorCb, {
    capture: true
  }, true)

  function windowErrorCb(event) {
    let target = event.target
    let isImg = target.tagName.toLowerCase() === 'img'
    if (isImg) {
      imgErrorCb()
      return
    }

    function imgErrorCb() {
      let isImgErrorHandled = target.hasAttribute('data-src-error')
      if (!isImgErrorHandled) {
        target.setAttribute('data-src-error', 'handled')
        target.src = 'backup.png'
      } else {
        //anything you want to do
        console.log(target.alt, 'both origin and backup image fail to load!');
      }
    }
  }
</script>
<img id="img" src="error1.png" alt="error1">
<img id="img" src="error2.png" alt="error2">
<img id="img" src="https://i.stack.imgur.com/ZXCE2.jpg" alt="avatar">
```

重点是 ：

1.  将代码放入`head`并作为第一个内联脚本执行。所以，它会监听脚本之后发生的错误。

2.  使用事件捕获来捕获错误，尤其是对于那些没有冒泡的事件。

3.  使用事件委托，避免在每个图像上绑定事件。

4.  在给错误`img`元素一个属性后给他们一个属性`backup.png`以避免`backup.png`随后的无限循环消失，如下所示：

**img error->backup.png->error->backup.png->error->,,,,,**

* * *

## 回答 #28

> 赞同：3
> 
> 时间：2021-10-01T04:49:44.243

**对于 React 开发人员**：

```
<img 
    src={"https://urlto/yourimage.png"} // <--- If this image src fail to load, onError function will be called, where you can add placeholder image or any image you want to load
    width={200} 
    alt={"Image"} 
    onError={(event) => {
       event.target.onerror = "";
       event.target.src = "anyplaceholderimageUrlorPath"
       return true;
    }}
 /> 
```

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2018-02-20T04:41:52.807

如果图像无法加载（例如，因为它不在提供的 URL 中），图像 URL 将更改为默认值，

有关[.error()的更多信息](https://api.jquery.com/error/)

```
$('img').on('error', function (e) {
  $(this).attr('src', 'broken.png');
});
```

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2017-11-16T20:43:54.930

我遇到了同样的问题。这段代码适用于我的情况。

```
// Replace broken images by a default img
$('img').each(function(){
    if($(this).attr('src') === ''){
      this.src = '/default_feature_image.png';
    }
}); 
```

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2020-03-12T13:02:59.123

我使用延迟加载并且必须这样做才能使其正常工作：

```
lazyload();

var errorURL = "https://example.com/thisimageexist.png";

$(document).ready(function () {
  $('[data-src]').on("error", function () {
    $(this).attr('src', errorURL);
  });
}); 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2019-02-01T00:38:01.763

我发现这个效果最好，如果任何图像第一次加载失败，它就会从 DOM 中完全删除。执行`console.clear()`使控制台窗口保持清洁，因为 try/catch 块不能省略 404 错误。

```
$('img').one('error', function(err) {
    // console.log(JSON.stringify(err, null, 4))
    $(this).remove()
    console.clear()
}) 
```

# c# - 将大型 ASP.NET VB.NET 项目转换为 C# - 增量？

> ID：92728
> 
> 赞同：8
> 
> 时间：2008-09-18T13:53:55.490
> 
> 标签：c#, asp.net, vb.net

正在寻找一些方法来将现有的大型 ASP.NET VB.NET 项目逐步转换为 C#，同时仍能够将其部署为单个 Web 应用程序（目前每周部署一次）。

我的想法是创建一个新的 C# ASP.NET 项目并慢慢移动页面，但我从未尝试过这样做并在部署期间以某种方式将其与另一个 ASP.NET 项目合并。

（澄清：大型 ASP.NET VB.NET 项目在 VS IDE 中绝对是狗……）

有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T14:03:00.057

从业务逻辑开始，然后按照自己的方式进入页面。将您能做的一切封装到 C# 库中，您可以将其添加为对 VB.NET 站点的引用。

完成所有后端的移植和测试后，您就可以开始制作单独的页面，但我建议您在完成所有转换之前不要推出。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T14:07:24.117

您可以保留包含 VB 代码和 C# 代码的 App_Code 目录。如此有效，当您有空闲时间转换它时，您可以非常缓慢地完成它。

我目前在我的 App_Code 目录中同时拥有 VB.Net 和 C# 代码，在我的业余时间我转换为 VB.Net 代码，或者任何时候我必须返回到带有 VB.Net 的页面并将其弄乱我将其转换为 C#。

当 Easy Peasy 和 Microsoft 允许您在同一个应用程序上同时拥有 VB.NET 和 C# 时，他们做得更好。这是他们可以在整个应用程序制作过程中实施的最佳想法之一。

如果您想在一个目录中添加两个代码目录，请将其添加到您的 Web.config

```
<compilation>
<codeSubDirectories>
    <add directoryName="VB_Code"/>
    <add directoryName="CS_Code"/>
</codeSubDirectories>
</compilation> 
```

然后在 App_Code 目录中添加一个名为 VB_Code 的文件夹和另一个名为 CS_Code 的文件夹。然后把你所有的 vb/C# 代码扔到你的文件夹和你的好。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T13:58:38.740

一个喜欢的端口我拿它吗？我真的不明白这一点以及你会从所有的努力中获得什么。也许编写任何新功能或将缓慢/糟糕的现有逻辑/服务层重构到 c# 中，但至于网页，我看不到 80/20 的好处。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T04:35:34.390

我已经成功地使用[Reflector](http://www.red-gate.com/products/reflector/)（它是免费的）提取了 vb 项目的 dll，并将代码查看为 C#。局部变量并不总是翻译，但您可以随时比较翻译和重构内容。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T14:02:40.713

将旧的东西保留在 VB 中。C# 中的所有新东西。过渡可能很慢，但您不会浪费时间。在空闲时间，更改 C# 中的内容。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T14:04:56.883

我通过执行以下操作在一个项目中做到了这一点：

1.  创建 C# 类库
2.  从 VB Web 应用程序引用 C# 类库
3.  在 C# 库中创建类后面的代码
4.  更新aspx/ascx文件中的“Inherits”属性引用C#类（这个文件在原VB工程中仍然存在）

它工作得有些好；有时有点痛苦，因为您现在必须浏览多个项目才能查看单个页面/控件，但它确实让我做您想做的事情。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T14:06:29.173

您可以简单地在解决方案中创建一个新的 c# 类库项目。在这里一次重新编码几个类，然后替换主项目中的 vb 类。

但老实说，我同意我看不到好处，除非您尝试学习 c# 或者只是真的不喜欢 vb 或者只是无聊。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-06-19T19:35:30.347

尝试[#开发](http://www.icsharpcode.net/OpenSource/SD/)。我认为这是将任何 .net 支持的语言转换为任何 .net 支持的语言的最佳方式。

其他工具仅转换代码，但这会转换整个项目。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T18:36:30.850

如果你有 179 美元，你就完成了。

*   [http://www.tangiblesoftwaresolutions.com/Product_Details/Instant_CSharp.htm](http://www.tangiblesoftwaresolutions.com/Product_Details/Instant_CSharp.htm)

当然，也有免费软件转换器可用。

*   [http://www.google.com/search?q=convert+vb.net+csharp](http://www.google.com/search?q=convert+vb.net+csharp)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-18T14:00:42.777

可以办到。好吧，我希望它可以像我在旧的 ASP.net 应用程序上一点一点地做一样。您一次只能更改超过 1 个网络表单。您可能会遇到困难的是，我似乎无法在应用程序代码文件夹中使用混合语言，因为它们是一起编译的。

# windows-vista - 使用 MS SAPI TTS 无意改变音高

> ID：92742
> 
> 赞同：1
> 
> 时间：2008-09-18T13:55:56.220
> 
> 标签：windows-vista, text-to-speech, sapi

是否有其他人使用 MS SAPI TTS 语音经历过（并且可能已解决）无意的音高变化？

我正在使用带有 SAPI 5.1 的 SpVoice 自动化接口。

现在，我的应用程序（VB6 应用程序）可以进入 TTS（Microsoft Anna）开始听起来像花栗鼠的状态（适当的速率，但高音），甚至重新启动 Vista 也不能解决问题。

我将 XML 传递给 Voice.Speak() 函数。我已经尝试在所有其他 XML 之前发送 < pitch absmiddle="0" /> ，但它仍然不能纠正音高问题。当我在语音控制面板中尝试 TTS 语音预览时，语音具有正常音高。

过去我在 XP 中出现过这个问题，但是重新启动似乎可以纠正它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T12:44:14.937

你能回答你自己的问题吗？你能在答案中问另一个问题吗？为时已晚... ：）

我的解决方案是将 Voice.AudioOutputStream.format.Type 初始化为合理的值，例如 16kHz16BitMono。我有一个错误，如果只有一个声音可用，则可以跳过此初始化步骤。事实证明（对于我在 Vista VMWare 环境中运行的项目）如果您不设置语音的音频格式，您将获得高音调的语音。很高兴知道..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T02:01:04.057

我还没有看到这种情况发生，尽管我的经验主要是使用带有 SSML 的 SAPI 5.3，它被翻译（在幕后）为 SAPI TTS。

您是否尝试过使用`<pitch absmiddle="0">`Your Text Here 而不是仅在文本的前面来包围您的文本？

# metrics - 自动化用户研究，什么是好的策略？

> ID：92752
> 
> 赞同：0
> 
> 时间：2008-09-18T13:56:33.923
> 
> 标签：metrics, user-testing

我正在制作一个在线系统，以使用 sharepoint 作为门户集成许多其他系统。我想要内置良好的日志记录，这样我就可以真正看到我的用户在做什么（而不侵犯他们的隐私！）

我想制作热图叠加层，以查看正在创建哪些链接，以及正在使用哪些页面的直观报告等。

我想谷歌分析会做这种事情，但是我可以使用其他工具吗？

我也许可以更多地了解我的用户，因为他们都将通过 Active Directory 进行身份验证才能访问该站点。这会改变我可以或应该使用的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T14:03:57.090

您可以问自己一个问题：隐私问题是否如此重要以至于您无法使用第三方跟踪工具（即 Google Analytics）来帮助您？

我认为构建您自己的分析工具的唯一原因是保持个人控制信息的收集和使用方式（例如，如果您的用户有高度的隐私偏执狂）。这是一个链接，可以帮助您审核 Active Directory 记录的各种用户事件：

[http://www.windowsecurity.com/articles/windows-active-directory-auditing.html](http://www.windowsecurity.com/articles/windows-active-directory-auditing.html)

（从谷歌搜索找到：活动目录用户跟踪）

# open-source - 在 Sourceforge 上将 OSS 项目许可证从 GPL 切换到 L-GPL

> ID：92754
> 
> 赞同：3
> 
> 时间：2008-09-18T13:56:39.790
> 
> 标签：open-source, licensing

是否可以将开源项目许可证从[GPL](http://opensource.org/licenses/gpl-2.0.php)切换到[LGPL v3](http://opensource.org/licenses/lgpl-3.0.html)？

我是项目发起人，也是唯一的贡献者。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T14:04:19.663

是的当然。您可以将许可证更改为您想要的任何内容。

转到您的管理页面，然后从菜单中编辑注册，查看公共信息，然后编辑 Trove 分类。您需要删除然后添加一个新类别。容易（如果有点链接快乐）。

如果您是项目的管理员，无论您有多少人或谁做出了贡献，这都适用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T20:24:41.683

除了指出的要点之外，请注意，已获得该产品许可的任何人（以及获得该产品许可的任何人）都有权遵守 GPL - 您不能更改他们使用该软件的条款（除非他们同意更改）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T14:01:04.867

AFAIK，如果您是源代码的唯一贡献者，无论您是原始作者还是首席开发人员，您都可以这样做。

如果您可以得到所有贡献者的批准，那么您可以更改许可证。

警告：IANAL。

# ruby - 如何在 Ruby 上获得 CTRL-LEFTCLICK 导航以在 IntelliJ 7 中工作？

> ID：92768
> 
> 赞同：0
> 
> 时间：2008-09-18T13:58:08.023
> 
> 标签：ruby, intellij-idea

在 IntelliJ 中，当编辑 Java 文件时`CTRL`+LEFTCLICK 上的标识符会将我带到定义该标识符的位置。由于某种原因，它在编辑 Ruby 代码时不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T02:27:24.870

这是因为程序不知道在哪里可以找到该标识符……这更像是程序使用问题而不是编程问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-20T00:08:09.617

不，事实并非如此。当我将鼠标悬停在标识符上时，在 95% 的情况下，IntelliJ 能够准确地计算出标识符是什么（局部变量、成员变量、类等），并在工具提示中向我显示完全限定的类名等。

即使是按住`CTRL`并悬停在标识符上也会显示蓝色下划线：只是当我单击它时没有任何反应。我希望被带到定义标识符的地方。所以要么我有配置问题，要么 IntelliJ 有一个错误——只是不知道哪个。

# syntax-highlighting - 停止 SubText/FCKEditor 弄乱 HTML

> ID：92769
> 
> 赞同：1
> 
> 时间：2008-09-18T13:58:14.840
> 
> 标签：syntax-highlighting, fckeditor, subtext

我正在尝试整理一个博客，并且已经使用了 SubText，并且我刚刚安装了 SyntaxHighlighter，但它似乎无法正常工作。SubText 或 FCKEditor 似乎篡改了 HTMl，内联了 pre 标记中的所有内容，并在每行的末尾放置了换行符。

艰难时期！

有谁知道如何阻止这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-01T12:27:07.300

在 FCKEditor 中，它与 IE 中的一个 bug 有关，即在**pre**标记中不正确地呈现 innerHTML。它是一个常见的问题。

我为 FCKEditor 编写了一个插件，它使用 SyntaxHighlighter 来正确格式化代码。你可以在[这里](http://www.psykoptic.com/blog/post/2008/12/01/Code-Syntax-Highlight-Plugin-for-FCKeditor.aspx)阅读。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-15T06:29:59.973

核选项是通过更改简单地切换到纯文本编辑器

```
<BlogEntryEditor defaultProvider="FCKeditorBlogEntryEditorProvider"> 
```

至

```
<BlogEntryEditor defaultProvider="PlainTextBlogEntryEditorProvider"> 
```

一个更好的选择是使用 Windows Live Writer 发布。Subtext 很好地支持 WLW。 [http://windowslivewriter.spaces.live.com/default.aspx?wa=wsignin1.0&sa=860053782](http://windowslivewriter.spaces.live.com/default.aspx?wa=wsignin1.0&sa=860053782)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T15:11:01.610

这是由每个浏览器如何实现 HTML 设计模式造成的，不幸的是，它们似乎都破坏了完美的 HTML。没有选项可以阻止这种行为，但是可以使用 JavaScript 使用正则表达式来整理（或使用[JS HTML 解析器](http://ejohn.org/blog/pure-javascript-html-parser/)）来完成一些后期处理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-01T16:19:14.507

我知道它不是 FCKEditor 或 SubTexts 之一，但 TinyMCE 有一个标志，可以在其 HTML 视图中为您正确格式化 HTML。

**apply_source_formatting：真**

它将正确格式化所有 HTML。不是很出色，但比通常将其全部拖到一行上要好得多，并且几乎无法阅读。

# java - 如何在 JLabel 中垂直显示文本？(Java 1.6)

> ID：92781
> 
> 赞同：13
> 
> 时间：2008-09-18T13:59:22.263
> 
> 标签：java, jlabel

我希望在 JLabel 中垂直显示文本，底部的第一个字母，顶部的最后一个字母。这可能吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-18T14:19:20.907

当我需要这样做时，我找到了这个页面：[http ://www.java2s.com/Tutorial/Java/0240__Swing/VerticalLabelUI.htm。](http://www.java2s.com/Tutorial/Java/0240__Swing/VerticalLabelUI.htm)

我不知道您是否希望字母“站立”彼此或全部旋转。

```
/*
 * The contents of this file are subject to the Sapient Public License
 * Version 1.0 (the "License"); you may not use this file except in compliance
 * with the License. You may obtain a copy of the License at
 * http://carbon.sf.net/License.html.
 *
 * Software distributed under the License is distributed on an "AS IS" basis,
 * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for
 * the specific language governing rights and limitations under the License.
 *
 * The Original Code is The Carbon Component Framework.
 *
 * The Initial Developer of the Original Code is Sapient Corporation
 *
 * Copyright (C) 2003 Sapient Corporation. All Rights Reserved.
 */

import java.awt.Dimension;
import java.awt.FontMetrics;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Insets;
import java.awt.Rectangle;
import java.awt.geom.AffineTransform;

import javax.swing.Icon;
import javax.swing.JComponent;
import javax.swing.JLabel;
import javax.swing.plaf.basic.BasicLabelUI;

/**
 * This is the template for Classes.
 *
 *
 * @since carbon 1.0
 * @author Greg Hinkle, January 2002
 * @version $Revision: 1.4 $($Author: dvoet $ / $Date: 2003/05/05 21:21:27 $)
 * @copyright 2002 Sapient
 */

public class VerticalLabelUI extends BasicLabelUI {
    static {
        labelUI = new VerticalLabelUI(false);
    }

    protected boolean clockwise;

    public VerticalLabelUI(boolean clockwise) {
        super();
        this.clockwise = clockwise;
    }

    public Dimension getPreferredSize(JComponent c) {
        Dimension dim = super.getPreferredSize(c);
        return new Dimension( dim.height, dim.width );
    }

    private static Rectangle paintIconR = new Rectangle();
    private static Rectangle paintTextR = new Rectangle();
    private static Rectangle paintViewR = new Rectangle();
    private static Insets paintViewInsets = new Insets(0, 0, 0, 0);

    public void paint(Graphics g, JComponent c) {

        JLabel label = (JLabel)c;
        String text = label.getText();
        Icon icon = (label.isEnabled()) ? label.getIcon() : label.getDisabledIcon();

        if ((icon == null) && (text == null)) {
            return;
        }

        FontMetrics fm = g.getFontMetrics();
        paintViewInsets = c.getInsets(paintViewInsets);

        paintViewR.x = paintViewInsets.left;
        paintViewR.y = paintViewInsets.top;

        // Use inverted height & width
        paintViewR.height = c.getWidth() - (paintViewInsets.left + paintViewInsets.right);
        paintViewR.width = c.getHeight() - (paintViewInsets.top + paintViewInsets.bottom);

        paintIconR.x = paintIconR.y = paintIconR.width = paintIconR.height = 0;
        paintTextR.x = paintTextR.y = paintTextR.width = paintTextR.height = 0;

        String clippedText =
            layoutCL(label, fm, text, icon, paintViewR, paintIconR, paintTextR);

        Graphics2D g2 = (Graphics2D) g;
        AffineTransform tr = g2.getTransform();
        if (clockwise) {
            g2.rotate( Math.PI / 2 );
            g2.translate( 0, - c.getWidth() );
        } else {
            g2.rotate( - Math.PI / 2 );
            g2.translate( - c.getHeight(), 0 );
        }

        if (icon != null) {
            icon.paintIcon(c, g, paintIconR.x, paintIconR.y);
        }

        if (text != null) {
            int textX = paintTextR.x;
            int textY = paintTextR.y + fm.getAscent();

            if (label.isEnabled()) {
                paintEnabledText(label, g, clippedText, textX, textY);
            } else {
                paintDisabledText(label, g, clippedText, textX, textY);
            }
        }

        g2.setTransform( tr );
    }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-22T19:00:33.777

在 JLabel 中垂直显示文本的另一种方法是在 JLabel 的文本中使用 HTML 标记。例如 `setText("<HTML>H<br>E<br>L<br>L<br>O</HTML>");`将文本设置为
H
E
L
L
O

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-18T14:02:56.123

你可以通过弄乱paint命令来做到这一点，有点像这样：

```
public class JVertLabel extends JComponent{
  private String text;

  public JVertLabel(String s){
    text = s;
  }

  public void paintComponent(Graphics g){
    super.paintComponent(g);
    Graphics2D g2d = (Graphics2D)g;

    g2d.rotate(Math.toRadians(270.0)); 
    g2d.drawString(text, 0, 0);
  }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-08-25T12:38:28.317

您还可以使用 SwingX API

从下到上：

```
JXLabel label = new JXLabel("MY TEXT");
label.setTextRotation(3 * Math.PI / 2); 
```

从上到下 ：

```
JXLabel label = new JXLabel("MY TEXT");
label.setTextRotation(Math.PI / 2); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-09-06T09:25:29.693

这是另一个解决方案：

*   考虑本地化
*   可以绘制垂直堆叠和居中或旋转的字符

[http://www.macdevcenter.com/pub/a/mac/2002/03/22/vertical_text.html](http://www.macdevcenter.com/pub/a/mac/2002/03/22/vertical_text.html)

突出显示 Javadoc 中的注释：

> 中/日/韩文字在垂直绘制时有特殊规则，切勿旋转

有关一些视觉示例，请参阅文章。

这是主类[JTextIcon.java](http://www.macdevcenter.com/mac/2002/03/22/examples/VTextIcon.java)，以防文章从网络上掉下来：

```
/**
 VTextIcon is an Icon implementation which draws a short string vertically.
 It's useful for JTabbedPanes with LEFT or RIGHT tabs but can be used in any
 component which supports Icons, such as JLabel or JButton 

 You can provide a hint to indicate whether to rotate the string 
 to the left or right, or not at all, and it checks to make sure 
 that the rotation is legal for the given string 
 (for example, Chinese/Japanese/Korean scripts have special rules when 
 drawn vertically and should never be rotated)
 */
public class VTextIcon implements Icon, PropertyChangeListener {
    String fLabel;
    String[] fCharStrings; // for efficiency, break the fLabel into one-char strings to be passed to drawString
    int[] fCharWidths; // Roman characters should be centered when not rotated (Japanese fonts are monospaced)
    int[] fPosition; // Japanese half-height characters need to be shifted when drawn vertically
    int fWidth, fHeight, fCharHeight, fDescent; // Cached for speed
    int fRotation;
    Component fComponent;

    static final int POSITION_NORMAL = 0;
    static final int POSITION_TOP_RIGHT = 1;
    static final int POSITION_FAR_TOP_RIGHT = 2;

    public static final int ROTATE_DEFAULT = 0x00;
    public static final int ROTATE_NONE = 0x01;
    public static final int ROTATE_LEFT = 0x02;
    public static final int ROTATE_RIGHT = 0x04;

    /**
     * Creates a <code>VTextIcon</code> for the specified <code>component</code>
     * with the specified <code>label</code>.
     * It sets the orientation to the default for the string
     * @see #verifyRotation
     */
    public VTextIcon(Component component, String label) {
        this(component, label, ROTATE_DEFAULT);
    }

    /**
     * Creates a <code>VTextIcon</code> for the specified <code>component</code>
     * with the specified <code>label</code>.
     * It sets the orientation to the provided value if it's legal for the string
     * @see #verifyRotation
     */
    public VTextIcon(Component component, String label, int rotateHint) {
        fComponent = component;
        fLabel = label;
        fRotation = verifyRotation(label, rotateHint);
        calcDimensions();
        fComponent.addPropertyChangeListener(this);
    }

    /**
     * sets the label to the given string, updating the orientation as needed
     * and invalidating the layout if the size changes
     * @see #verifyRotation
     */
    public void setLabel(String label) {
        fLabel = label;
        fRotation = verifyRotation(label, fRotation); // Make sure the current rotation is still legal
        recalcDimensions();
    }

    /**
     * Checks for changes to the font on the fComponent
     * so that it can invalidate the layout if the size changes
     */
    public void propertyChange(PropertyChangeEvent e) {
        String prop = e.getPropertyName();
        if("font".equals(prop)) {
            recalcDimensions();
        }
    }

    /** 
     * Calculates the dimensions.  If they've changed,
     * invalidates the component
     */
    void recalcDimensions() {
        int wOld = getIconWidth();
        int hOld = getIconHeight();
        calcDimensions();
        if (wOld != getIconWidth() || hOld != getIconHeight())
            fComponent.invalidate();
    }

    void calcDimensions() {
        FontMetrics fm = fComponent.getFontMetrics(fComponent.getFont());
        fCharHeight = fm.getAscent() + fm.getDescent();
        fDescent = fm.getDescent();
        if (fRotation == ROTATE_NONE) {
            int len = fLabel.length();
            char data[] = new char[len];
            fLabel.getChars(0, len, data, 0);
            // if not rotated, width is that of the widest char in the string
            fWidth = 0;
            // we need an array of one-char strings for drawString
            fCharStrings = new String[len];
            fCharWidths = new int[len];
            fPosition = new int[len];
            char ch;
            for (int i = 0; i < len; i++) {
                ch = data[i];
                fCharWidths[i] = fm.charWidth(ch);
                if (fCharWidths[i] > fWidth)
                    fWidth = fCharWidths[i];
                fCharStrings[i] = new String(data, i, 1);               
                // small kana and punctuation
                if (sDrawsInTopRight.indexOf(ch) >= 0) // if ch is in sDrawsInTopRight
                    fPosition[i] = POSITION_TOP_RIGHT;
                else if (sDrawsInFarTopRight.indexOf(ch) >= 0)
                    fPosition[i] = POSITION_FAR_TOP_RIGHT;
                else
                    fPosition[i] = POSITION_NORMAL;
            }
            // and height is the font height * the char count, + one extra leading at the bottom
            fHeight = fCharHeight * len + fDescent;
        }       
        else {
            // if rotated, width is the height of the string
            fWidth = fCharHeight;
            // and height is the width, plus some buffer space 
            fHeight = fm.stringWidth(fLabel) + 2*kBufferSpace;
        }
    }

   /**
     * Draw the icon at the specified location.  Icon implementations
     * may use the Component argument to get properties useful for 
     * painting, e.g. the foreground or background color.
     */
    public void paintIcon(Component c, Graphics g, int x, int y) {
        // We don't insist that it be on the same Component
        g.setColor(c.getForeground());
        g.setFont(c.getFont());
        if (fRotation == ROTATE_NONE) {
            int yPos = y + fCharHeight;
            for (int i = 0; i < fCharStrings.length; i++) {
                // Special rules for Japanese - "half-height" characters (like ya, yu, yo in combinations)
                // should draw in the top-right quadrant when drawn vertically
                // - they draw in the bottom-left normally
                int tweak;
                switch (fPosition[i]) {
                    case POSITION_NORMAL: 
                        // Roman fonts should be centered. Japanese fonts are always monospaced.  
                        g.drawString(fCharStrings[i], x+((fWidth-fCharWidths[i])/2), yPos);
                        break;
                    case POSITION_TOP_RIGHT:
                        tweak = fCharHeight/3; // Should be 2, but they aren't actually half-height
                        g.drawString(fCharStrings[i], x+(tweak/2), yPos-tweak); 
                        break;
                    case POSITION_FAR_TOP_RIGHT:
                        tweak = fCharHeight - fCharHeight/3;
                        g.drawString(fCharStrings[i], x+(tweak/2), yPos-tweak); 
                        break;
                }
                yPos += fCharHeight;
            }
        }
        else if (fRotation == ROTATE_LEFT) {
            g.translate(x+fWidth,y+fHeight);
            ((Graphics2D)g).rotate(-NINETY_DEGREES);
            g.drawString(fLabel, kBufferSpace, -fDescent);
            ((Graphics2D)g).rotate(NINETY_DEGREES);
            g.translate(-(x+fWidth),-(y+fHeight));
        } 
        else if (fRotation == ROTATE_RIGHT) {
            g.translate(x,y);
            ((Graphics2D)g).rotate(NINETY_DEGREES);
            g.drawString(fLabel, kBufferSpace, -fDescent);
            ((Graphics2D)g).rotate(-NINETY_DEGREES);
            g.translate(-x,-y);
        } 

    }

    /**
     * Returns the icon's width.
     *
     * @return an int specifying the fixed width of the icon.
     */
    public int getIconWidth() {
        return fWidth;
    }

    /**
     * Returns the icon's height.
     *
     * @return an int specifying the fixed height of the icon.
     */
    public int getIconHeight() {
        return fHeight;
    }

    /** 
         verifyRotation

        returns the best rotation for the string (ROTATE_NONE, ROTATE_LEFT, ROTATE_RIGHT)

        This is public static so you can use it to test a string without creating a VTextIcon

     from http://www.unicode.org/unicode/reports/tr9/tr9-3.html
     When setting text using the Arabic script in vertical lines, 
     it is more common to employ a horizontal baseline that 
     is rotated by 90� counterclockwise so that the characters 
     are ordered from top to bottom. Latin text and numbers 
     may be rotated 90� clockwise so that the characters 
     are also ordered from top to bottom.

        Rotation rules
        - Roman can rotate left, right, or none - default right (counterclockwise)
        - CJK can't rotate
        - Arabic must rotate - default left (clockwise)

     from the online edition of _The Unicode Standard, Version 3.0_, file ch10.pdf page 4
     Ideographs are found in three blocks of the Unicode Standard...
     U+4E00-U+9FFF, U+3400-U+4DFF, U+F900-U+FAFF

     Hiragana is U+3040-U+309F, katakana is U+30A0-U+30FF

     from http://www.unicode.org/unicode/faq/writingdirections.html
     East Asian scripts are frequently written in vertical lines 
     which run from top-to-bottom and are arrange columns either 
     from left-to-right (Mongolian) or right-to-left (other scripts). 
     Most characters use the same shape and orientation when displayed 
     horizontally or vertically, but many punctuation characters 
     will change their shape when displayed vertically.

     Letters and words from other scripts are generally rotated through 
     ninety degree angles so that they, too, will read from top to bottom. 
     That is, letters from left-to-right scripts will be rotated clockwise 
     and letters from right-to-left scripts counterclockwise, both 
     through ninety degree angles.

    Unlike the bidirectional case, the choice of vertical layout 
    is usually treated as a formatting style; therefore, 
    the Unicode Standard does not define default rendering behavior 
    for vertical text nor provide directionality controls designed to override such behavior

     */
    public static int verifyRotation(String label, int rotateHint) {
        boolean hasCJK = false;
        boolean hasMustRotate = false; // Arabic, etc

        int len = label.length();
        char data[] = new char[len];
        char ch;
        label.getChars(0, len, data, 0);
        for (int i = 0; i < len; i++) {
            ch = data[i];
            if ((ch >= '\u4E00' && ch <= '\u9FFF') ||
                (ch >= '\u3400' && ch <= '\u4DFF') ||
                (ch >= '\uF900' && ch <= '\uFAFF') ||
                (ch >= '\u3040' && ch <= '\u309F') ||
                (ch >= '\u30A0' && ch <= '\u30FF') )
               hasCJK = true;
            if ((ch >= '\u0590' && ch <= '\u05FF') || // Hebrew
                (ch >= '\u0600' && ch <= '\u06FF') || // Arabic
                (ch >= '\u0700' && ch <= '\u074F') ) // Syriac
               hasMustRotate = true;
        }
        // If you mix Arabic with Chinese, you're on your own
        if (hasCJK)
            return DEFAULT_CJK;

        int legal = hasMustRotate ? LEGAL_MUST_ROTATE : LEGAL_ROMAN;
        if ((rotateHint & legal) > 0)
            return rotateHint;

        // The hint wasn't legal, or it was zero
        return hasMustRotate ? DEFAULT_MUST_ROTATE : DEFAULT_ROMAN;
    }

    // The small kana characters and Japanese punctuation that draw in the top right quadrant:
    // small a, i, u, e, o, tsu, ya, yu, yo, wa  (katakana only) ka ke
    static final String sDrawsInTopRight = 
        "\u3041\u3043\u3045\u3047\u3049\u3063\u3083\u3085\u3087\u308E" + // hiragana 
        "\u30A1\u30A3\u30A5\u30A7\u30A9\u30C3\u30E3\u30E5\u30E7\u30EE\u30F5\u30F6"; // katakana
    static final String sDrawsInFarTopRight = "\u3001\u3002"; // comma, full stop

    static final int DEFAULT_CJK = ROTATE_NONE;
    static final int LEGAL_ROMAN = ROTATE_NONE | ROTATE_LEFT | ROTATE_RIGHT;
    static final int DEFAULT_ROMAN = ROTATE_RIGHT; 
    static final int LEGAL_MUST_ROTATE = ROTATE_LEFT | ROTATE_RIGHT;
    static final int DEFAULT_MUST_ROTATE = ROTATE_LEFT;

    static final double NINETY_DEGREES = Math.toRadians(90.0);
    static final int kBufferSpace = 5;
} 
```

提供免费用于任何目的。

还有一个`CompositeIcon`类可以让你用另一个图标组成垂直文本（这里没有给出）

根据文章中的评论，在方法中添加抗锯齿`paintIcon`：

```
 Graphics2D g2 = (Graphics2D) g;
    g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON); 
```

# ajax - 开始学习 AJAX 的最佳地点是什么（我有 Perl 作为后端）

> ID：92786
> 
> 赞同：4
> 
> 时间：2008-09-18T14:00:30.157
> 
> 标签：ajax

我目前正在开发一个使用基本 cgi 来翻页的网站。我希望将网站更改为具有更好的（读取动态）界面。

您会推荐哪些技术（如果不是 AJAX）和/或教程来帮助我入门？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-18T17:30:39.387

“AJAX”这个术语有点误导，很容易让试图学习它的人感到困惑。该术语本身实际上仅适用于从服务器异步获取或发送数据（即，无需重新加载页面），但它倾向于用于描述任何现代 Javascript 繁重的系统。（事实上​​，即使你在谈论异步获取或发送数据，术语“AJAX”也并不完全正确——它最初的意思是“异步 Javascript 和 XML”，但大多数现代实现使用 JSON 代替 XML ）。

所以，我怀疑，你真正在谈论的是“现代 Javascript”。在网站上使用 Javascript（如前所述）涉及几种相关但不同的技术，在开始了解这些技术是什么、它们在哪里开始和结束以及它们如何交互时非常有帮助。

首先，您拥有 Javascript 语言本身。虽然有几种实现，但这实际上是相对简单的，而且你应该很容易掌握它的语法。

然后是 DOM 或文档对象模型。这是浏览器对页面本身的基于 Javascript 的界面。与 Javascript 语言相比，DOM 实际上是相当复杂的，并且很可能是您最麻烦的地方（尤其是因为不同浏览器提供的 DOM 往往会存在细微差别）。

为了真正开始学习这些东西，我建议您从了解基本的 DOM 操作开始。了解如何使用 DOM 动态创建元素、如何分配事件、代码如何与页面交互等。网络上有大量资源可供查看，还有几本书。如前所述，O'Reilly 的[*Javascript: The Definitive Guide*](https://rads.stackoverflow.com/amzn/click/com/0596101996)是一个极好的资源。如果您想要可靠的网络资源，请尝试[PPK 的网站](http://www.quirksmode.org/js/contents.html)。您还需要安装[Firebug——](http://getfirebug.com/)它对调试非常有用。它也是一个出色的学习工具，您可以打开控制台并“玩”任何您想要的页面。DOM 浏览器和选项卡补全功能让它变得非常简单。

您*可以*从孤立地查看 Javascript 开始，但它很简单，您可能只需查看几个示例就可以掌握所需的一切。相反，我建议随着你的进步，你重新审视 Javascript 语言本身。了解它的对象原型（以及它与您可能习惯的更传统的 OOP 类有何不同。）这些概念可能需要一些时间才能被某些人“点击”，而且当您在开始，所以我建议暂时忽略它。

请注意，我还没有提到 AJAX 或任何框架——如果你在开始研究框架**之前**对 Javascript 和 DOM 有基本的了解，你会发现它会容易*得多。*当涉及到 DOM 操作时，这些框架只是提供“快捷方式”和实用功能——如果您不知道它在幕后做什么，那么解决任何问题都可能非常棘手。

 **我还建议使用框架来处理 AJAX 的复杂性，仅仅是因为（与 DOM 操作和事件处理不同）除非你真的想要，否则你几乎没有理由了解 XMLHttpRequest 的复杂性。让框架来处理它以及出现的所有浏览器兼容性问题。

祝你好运！

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-18T14:11:10.177

AJAX 最好采用以下方法：

1.  [Javascript](http://devedge-temp.mozilla.org/library/manuals/2000/javascript/1.5/guide/)语言。
2.  对[DOM](http://www.w3.org/TR/1998/REC-DOM-Level-1-19981001/)的理解。
3.  对[XMLHttpRequest](http://en.wikipedia.org/wiki/XMLHttpRequest)的理解。

一旦掌握了这些，您就可以就您想使用的 API 或框架做出明智的决定。后端并不重要，但我建议您使用[JSON](http://www.json.org/)作为您选择的协议而不是 XML。XML 解析充满了不一致，需要代码破解才能解决。JSON 要简单得多。

有关更多信息，请参阅我对“[有人从 Struts 1 迁移到另一个 Web 框架吗？](https://stackoverflow.com/questions/90078/has-anyone-migrated-from-struts-1-to-another-web-framework#90197) ”的回答。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-18T14:08:03.303

您可能想查看[HTML::Prototype](http://search.cpan.org/~esskar/HTML-Prototype/lib/HTML/Prototype.pm)、[JQuery](http://search.cpan.org/~peterg/JQuery/lib/JQuery.pm)或[CGI::Ajax](http://search.cpan.org/~bpederse/CGI-Ajax/lib/CGI/Ajax.pm)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T14:07:57.783

我建议使用 jQuery，轻量级且非常容易快速掌握，是一个很棒的 irc 和 web 社区。对于 ajax，它就像 $.ajax(url, callbackFn); - [http://docs.jquery.com/Ajax](http://docs.jquery.com/Ajax)

www.learningjquery.com 上的好教程

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-19T14:50:40.003

这里有很多关于将 AJAX（或 JavaScript/DOM）作为独立实体学习的好答案，但是 CPAN 的 CGI::AJAX 模块是设置自己拥有一个使用 AJAX 更新页面的最快、最简单的方法-the-fly 使用 Perl 后端。它不需要 DOM、XML、JSON 或 Perl 以外的任何语言、一点 HTML 和最基本的 JavaScript 提示。

您所要做的就是分配一个 JavaScript 事件处理程序（例如，onkeyup='...'），指定调用哪个 Perl 函数以及提供哪些数据作为输入，并创建一个 div 来接收输出。CGI::AJAX 将从那里为您处理与服务器的所有通信和 DOM 操作。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-18T14:37:14.560

我发现在进入更深入的教程之前，W3 Schools 教程总是一个很好的起点。

[http://www.w3schools.com/ajax/default.asp](http://www.w3schools.com/ajax/default.asp)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T14:04:53.280

如果您对 javascript 方面有些陌生，您可能应该开始使用框架。

[Jquery](http://jquery.com/)是轻量级和漂亮的，并且有很好的[教程](http://docs.jquery.com/Tutorials)和[文档](http://docs.jquery.com/Main_Page)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-18T14:49:32.737

如果你真的想了解你在做什么，[JavaScript: The Definitive Guide](https://rads.stackoverflow.com/amzn/click/com/0596101996)是学习 JavaScript 的一个很好的参考，并且有一个部分专门介绍 XMLHttpRequest 的工作原理以及使用它时跨浏览器的关注点。

一旦你掌握了这一点，就可以考虑使用像 jQuery 或 Prototype 这样的框架来为你处理繁重的工作。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-21T04:26:23.263

我会推荐[Head First Labs](http://www.headfirstlabs.com/)的[Head Rush Ajax](http://www.headfirstlabs.com/books/hrajax/)一书。

它将引导您从头开始学习 Ajax。

他们对您可能知道或可能不知道的内容做出最低限度的假设。

作者很好地展示了理解和使用 AJAX 的构建块。

问候...

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-18T14:03:12.177

最好的办法是从一个为 AJAX 提供合理接口的 Javascript 库开始，例如 Prototype。有大量资源可用于学习此类库的基础知识。例如： http: [//www.prototypejs.org/learn](http://www.prototypejs.org/learn)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-18T14:05:10.083

[学习 jQuery](http://safari.oreilly.com/9781847192509)怎么样？

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-18T14:13:14.307

如果您不想深入了解具体细节，可以使用[TIBCO 通用接口](http://www.tibco.com/devnet/gi/default.jsp)。它是免费的、开源的并在 Tomcat 中运行。GI 是一个基于 AJAX 的 IDE，在浏览器中运行，用于制作 AJAX 网站。

我不为 TIBCO 工作，只是想提供帮助。如果您必须为该工具付费，我可能不会建议您使用它。

-史蒂文

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-18T18:44:01.457

另请参阅[perl.com](http://perl.com/)[的使用 Perl](http://www.perl.com/lpt/a/977)的Ajax

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-19T03:52:52.650

我从[Ajax Hacks](http://oreilly.com/catalog/9780596101695/)获得了关于 AJAX（以及 JavaScript，就此而言）的第一次介绍，它为理解它的全部内容以及每个人都在推动的为你做的库中幕后发生的事情提供了良好的基础.

# asp.net - 动态创建的用户控件无法处理 PostBack 上的事件

> ID：92792
> 
> 赞同：6
> 
> 时间：2008-09-18T14:00:51.247
> 
> 标签：asp.net, dynamic, user-controls, postback

我有一个用户控件，它使用页面初始化中的以下代码动态加载到页面中。

```
Dim oCtl As Object
oCtl = LoadControl("~/Controls/UserControl1.ascx")

oCtl.Id = "UserControl11"
PlaceHolder1.Controls.Clear()
PlaceHolder1.Controls.Add(oCtl) 
```

用户控件还包含一个按钮，我无法在用户控件中捕获按钮单击。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-14T13:35:31.813

您正在做的一些事情既不需要，也可能会导致您的问题。

这些是：

1.  无需将控制对象存储在会话中。控件本身应该根据需要使用 ViewState 和 Session State 来存储信息，而不是整个实例。
2.  创建控件时不应检查 PostBack。每次都必须创建它以允许 ViewState 工作和连接事件。
3.  在加载 ViewState 后加载的控件通常无法正常运行，因此请尽可能避免在 Page Load 事件期间加载。

这段代码对我有用：

* * *

默认.aspx

```
<%@ Page Language="vb" AutoEventWireup="false" CodeBehind="Default.aspx.vb" Inherits="Test_User_Control._Default" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server"><title></title></head>
<body>
    <form id="form1" runat="server">
        <asp:PlaceHolder ID="PlaceHolder1" runat="server" />
    </form>
</body>
</html> 
```

* * *

默认.aspx.vb

```
Partial Public Class _Default
    Inherits System.Web.UI.Page

    Private Sub Page_Init(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Init

        Dim control As Control = LoadControl("~/UserControl1.ascx")
        PlaceHolder1.Controls.Add(control)

    End Sub
End Class 
```

* * *

用户控件1.ascx

```
<%@ Control Language="vb" AutoEventWireup="false" CodeBehind="UserControl1.ascx.vb" Inherits="Test_User_Control.UserControl1" %>
<asp:Label ID="Label1" Text="Before Button Press" runat="server" />
<asp:Button ID="Button1" Text="Push me" runat="server" /> 
```

* * *

用户控件1.ascx.vb

```
Public Partial Class UserControl1
    Inherits System.Web.UI.UserControl

    Private Sub Button1_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Button1.Click
        Label1.Text = "The button has been pressed!"
    End Sub

End Class 
```

* * *

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-18T14:26:19.843

在 .NET 进入页面生命周期的“回发事件处理”步骤之前，您必须确保该控件存在于页面上。由于控件是动态添加的，因此您必须确保在每次回发时重新创建该控件，以便它可以找到触发事件的控件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T14:17:08.947

确保在每次回发时加载控件 - 如果在页面回发时控件不在控件树中，ASP.NET 将不会引发按钮单击事件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-13T11:05:22.803

我刚刚遇到了与您类似的问题，除了在我的情况下我没有使用会话来存储控件。

就我而言，我在这一行中找到了问题：

`PlaceHolder1.Controls.Clear()`

我所做的是创建一个子控件并将它们添加到 Page_Init 上的父容器中，然后处理一些事件处理程序，然后在 Page_PreRender 上我再次使用更新的数据重新创建整个列表。

我在这种情况下使用的解决方案是创建一次控件集合 - 在页面周期的早期阶段。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T14:03:31.817

几个问题：

1.  在页面生命周期的什么时候加载控件？
2.  事件处理程序代码在哪里？在控件本身还是您尝试将其连接到页面？
3.  到目前为止，你做了什么来完成这个活动？

最后，.Net 的样式指南特别建议*不要*在 oCtl 中使用任何像 o 这样的匈牙利前缀疣，您应该将其键入为控件而不是对象。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T15:00:40.353

既然你问了，我会这样写你的初始化事件。我将把 Load 事件留作练习：

```
Protected Sub Page_Init(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Init
    If IsPostBack AndAlso Session("ctl") IsNot Nothing Then
        Dim MyControl As Control = Session("ctl")
        PlaceHolder1.Controls.Add(MyControl)
    End If
End Sub 
```

我也会想出一个比“mycontrol”更好的名字，但因为我不知道这个控件会做什么。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T15:42:15.823

I don't know without trying it, but what if you programatically wire up the button's event handler? For instance, in the code-behind for the User Control itself, in Init or Load (not sure):

```
AddHandler Button1.Click, AddressOf Button1_Click 
```

If that doesn't do anything, I know it's less efficient, but what if you don't store the User Control instance in Session and always recreate it in Page_Init every time?

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T14:37:30.940

Here is the complete code for the Page

```
Partial Class DynamicLoad
    Inherits System.Web.UI.Page

    Protected Sub Page_Init(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Init
        If IsPostBack Then
            If Not (Session("ctl") Is Nothing) Then
                Dim oCtl As Object
                oCtl = Session("ctl")
                PlaceHolder1.Controls.Add(oCtl)
            End If
        End If
    End Sub

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        If Not IsPostBack Then
            Dim oCtl As Object
            oCtl = LoadControl("~/Controls/UserControl1.ascx")

            oCtl.Id = "UserControl11"
            PlaceHolder1.Controls.Clear()
            PlaceHolder1.Controls.Add(oCtl)

            Session("ctl") = oCtl
        End If
    End Sub
End Class 
```

Here is the complete code for the user Control

```
Partial Class UserControl1
    Inherits System.Web.UI.UserControl
    Protected Sub Button1_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Button1.Click
        Label1.Text = "This is Text AFTER Post Back in User Control 1"
    End Sub
End Class 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-09-18T14:08:29.327

您只想在不是 isPostBack 时加载控件

# exchange-server - WebDAV 检索邮件时不包含密件抄送标头

> ID：92801
> 
> 赞同：0
> 
> 时间：2008-09-18T14:02:23.537
> 
> 标签：exchange-server, webdav

这似乎是[此处](http://blogs.msdn.com/webdav_101/archive/2008/04/24/why-can-t-webdav-read-bcc.aspx)所述的预期行为，但我无法相信获取密件抄送的唯一方法是解析 Outlook Web Access 的 HTML 代码。

有没有人遇到过同样的限制并找到了解决方法？我也可以通过 WebDAV 从某个地方获取密件抄送并自己添加标题字段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T20:21:55.400

根据定义，密件抄送不会在电子邮件消息中创建或使用任何标题。否则它不会是“盲目的”，不是吗？

# linux - Linux 相当于 DOS 暂停是什么？

> ID：92802
> 
> 赞同：263
> 
> 时间：2008-09-18T14:02:27.763
> 
> 标签：linux, bash, shell

我有一个 Bash shell 脚本，我想在其中暂停执行，直到用户按下一个键。在 DOS 中，这很容易通过`pause`命令完成。我可以在我的脚本中使用 Linux 等价物吗？

* * *

## 回答 #1

> 赞同：355
> 
> 时间：2008-09-18T14:03:44.610

`read`做这个：

```
user@host:~$ read -n1 -r -p "Press any key to continue..." key
[...]
user@host:~$ 
```

`-n1`指定它只等待一个字符。将`-r`其置于原始模式，这是必要的，否则，如果您按下反斜杠之类的东西，它不会注册，直到您按下下一个键。`-p`指定提示，如果它包含空格，则必须用引号引起来。仅当您想知道他们按下了哪个键时，才需要该`key`参数，在这种情况下，您可以通过`$key`.

如果您使用 Bash，您还可以使用 指定超时`-t`，这会导致读取在未按下键时返回失败。例如：

```
read -t5 -n1 -r -p 'Press any key in the next five seconds...' key
if [ "$?" -eq "0" ]; then
    echo 'A key was pressed.'
else
    echo 'No key was pressed.'
fi 
```

* * *

## 回答 #2

> 赞同：172
> 
> 时间：2013-07-22T01:42:11.927

我经常使用这些非常短的方法，它们就像@theunamedguy 和@Jim 解决方案，但还具有超时和静默模式。

我特别喜欢最后一种情况，并在许多循环运行的脚本中使用它，直到用户按下`Enter`.

# 命令

*   **输入解决方案**

    ```
    read -rsp $'Press enter to continue...\n' 
    ```

*   **转义解决方案** *（使用 -d $'\e'）*

    ```
    read -rsp $'Press escape to continue...\n' -d $'\e' 
    ```

*   **任何关键解决方案** *（使用 -n 1）*

    ```
    read -rsp $'Press any key to continue...\n' -n 1 key
    # echo $key 
    ```

*   **带有预选选项的问题** *（使用 -ei $'Y'）*

    ```
    read -rp $'Are you sure (Y/n) : ' -ei $'Y' key;
    # echo $key 
    ```

*   **超时解决方案** *（使用 -t 5）*

    ```
    read -rsp $'Press any key or wait 5 seconds to continue...\n' -n 1 -t 5; 
    ```

*   **睡眠增强别名**

    ```
    read -rst 0.5; timeout=$?
    # echo $timeout 
    ```

# 解释

**-r**指定原始模式，不允许像“\”或“^”这样的组合字符。

**-s**指定静默模式，因为我们不需要键盘输出。

**-p $' *prompt* '**指定提示符，它需要在 $' 和 ' 之间以允许空格和转义字符。请注意，您必须在带有美元符号的单引号之间放置以使转义字符受益，否则您可以使用简单引号。

**-d $' *\e* '**将转义符指定为分隔符，因此作为当前条目的最后一个字符，可以放置任何字符，但要小心放置用户可以键入的字符。

**-n *1***指定它只需要一个字符。

**-e**指定 readline 模式。

**-i $' *Y* '**将 Y指定为 readline 模式下的初始文本。

**-t *5***指定超时 5 秒

***键***服务以防您需要知道输入，在 -n1 情况下，是已按下的键。

**美元？**用于知道最后一个程序的退出代码，用于读取，142超时，0正确输入。放$? 如果您需要在某些命令之后对其进行测试，请尽快在变量中进行测试，因为所有命令都会重写 $?

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-09-18T14:15:12.007

`read`没有任何参数只会在你按下回车后继续。`pause`如果按任意键，DOS命令将继续。`read –n1`如果您想要这种行为，请使用。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2017-01-18T20:01:15.000

这对我来说适用于多种 Linux 风格，而其中一些其他解决方案没有（包括这里最流行的解决方案）。我也觉得它更易读...

```
echo Press enter to continue; read dummy; 
```

请注意，需要将变量作为参数提供给`read`.

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2014-06-04T20:22:23.493

`read -n1`不便携。一种可移植的方法可能是：

```
(   trap "stty $(stty -g;stty -icanon)" EXIT
    LC_ALL=C dd bs=1 count=1 >/dev/null 2>&1
)   </dev/tty 
```

除了使用 `read`，只需按`ENTER`一下继续提示，您可以执行以下操作：

```
sed -n q </dev/tty 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-09-22T11:40:11.103

如果您只需要暂停一个循环或脚本，并且您很乐意按 Enter 而不是任何键，那么`read`它自己就可以完成这项工作。

```
do_stuff
read
do_more_stuff 
```

它对最终用户不友好，但在您为自己编写快速脚本并且需要暂停它以在后台手动执行某些操作的情况下可能就足够了。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-06-28T05:28:44.380

此函数适用于`bash`和`zsh`，并确保对终端的 I/O：

```
# Prompt for a keypress to continue. Customise prompt with $*
function pause {
  >/dev/tty printf '%s' "${*:-Press any key to continue... }"
  [[ $ZSH_VERSION ]] && read -krs  # Use -u0 to read from STDIN
  [[ $BASH_VERSION ]] && </dev/tty read -rsn1
  printf '\n'
}
export_function pause 
```

把它放在你`.{ba,z}shrc`的大正义中！

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2021-09-02T17:56:52.947

这修复了它，因此按 ENTER 以外的任何键仍将转到新行

```
read -n1 -r -s -p "Press any key to continue..." ; echo 
```

* * *

比windows暂停要好，因为你可以更改文本使其更有用

```
read -n1 -r -s -p "Press any key to continue... (cant find the ANY key? press ENTER) " ; echo 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-04-04T17:03:41.547

是的使用`read`- 并且有一些调整使其`cron`在终端和终端中都非常有用。

例子：

```
time rsync (options)
read -n 120 -p "Press 'Enter' to continue..." ; echo " " 
```

-n 120 使 read 语句在 2 分钟后超时，因此它不会阻塞`cron`。

在终端中，它需要 2 分钟来查看`rsync`命令执行所需的时间。

然后后续`echo`就是这样后续的 bash 提示符会出现在下一行。

`Enter`否则，在终端中按下“继续...”后，它将直接显示在同一行。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2022-03-05T10:32:01.040

我已经构建了一个小程序来`pause`在 Linux 中实现命令。我已将代码上传到我的 GitHub[存储库](https://github.com/savvysiddharth/pause-command)。

要安装它，

```
git clone https://github.com/savvysiddharth/pause-command.git
cd pause-command
sudo make install 
```

安装后，您现在可以使用`pause`类似于在 Windows 中执行的命令。

它还支持可选的自定义字符串，例如`read`.

例子：

```
pause "Pausing execution, Human intervention required..." 
```

使用它，使用类似语句的 C/C++ 程序`system("pause");`现在与 linux 兼容。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-09-18T14:04:32.033

试试这个：

```
function pause(){
   read -p "$*"
} 
```

# communication - 管理数字干扰的有效方法

> ID：92809
> 
> 赞同：3
> 
> 时间：2008-09-18T14:03:19.087
> 
> 标签：communication, time-management

由于同事可以使用过多的沟通方式，您如何设法在足够长的时间内避免分心以完成一些重点编程？

您是否退出或关闭所有通信，您是否告诉人们离开消息真的意味着您是一种方式，或其他什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T14:08:28.263

我的电子邮件与工作中的编码机位于单独的计算机上，这很有帮助。大多数其他转移被阻止。除此之外，我唯一能分散我注意力的就是电话和路过的同事。

不过，StackOverflow 并没有被阻止，这越来越让人分心。;)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T14:13:29.797

我喜欢放弃东西的想法。我不需要像我一样每 15 分钟检查一次。问题是，使用 twitter、电子邮件、Aim、irc 等，有很多东西要打开。

我的解决方案只是使用`open`带有一堆应用程序名称的handy-dandy 命令的一个小bash 命令。它立即打开所有内容，我检查所有内容，然后退出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T14:19:07.210

*   没有在后台运行的即时消息应用程序。相信我，你会活下来的。
*   没有电子邮件通知。相反，每隔一两个小时就进出一次。电子邮件从来都不是一种即时的沟通渠道——这就是电话的用途。

作为一名程序员，一旦你被打断，你需要花费 15-20 分钟来接听线程，因此五次打断意味着你实际上浪费了一个多小时。

没有什么能阻止同事就他们本可以发送电子邮件或走进你的办公室的事情打电话给你（除非他们尊重你的时间）。如果它成为一个问题，你将不得不提防并说出来......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T14:19:45.880

一件事是，当我与人交流时，我会尽量坚持使用即时消息。一般来说，人们会发现通过即时通讯程序与我交流是很自然的。至少，这就是我的组织文化的运作方式。

IM 更可取，因为您可以选择在准备好时接听 - 与电话或面对面不同。电子邮件是 IM 购买你的一个更极端的例子，但在我的组织中，大多数人都尽量避免使用电子邮件，因为几乎每个人都被内部垃圾邮件淹没，没有人及时阅读邮件。试着让人们更多地使用 IM，这样你的想法就不会经常分散。此外，通过耳机听一些环境或器乐，最好是降噪。如果您戴上耳机，人们就不太可能打扰您，尤其是当他们知道您在办公桌前并且可以向您发送即时消息时。

但就像我说的，你在方便的时候回复你的即时消息。试着让人们习惯一次被忽视 5-15 分钟。是的，你的问题不是那么严重，以至于我必须立即解决它们。我认为电子邮件最多需要一天的周转时间，所以我尽量不经常检查它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T16:50:01.773

我正要问同样的问题，所以我将为这个问题做出贡献。

我使用的其中一个东西是一个名为![块站点](https://addons.mozilla.org/en-US/firefox/addon/3145). 我用它来阻止在 Firefox 中访问“screwoff”网站，如 Slashdot、Fark、Shacknews 等。

当然，这并不排除打开另一个浏览器来打开这些站点的想法，但是由于我必须在 IE 中打开 JavaScript 调试，并且地球上的每个站点都因为愚蠢的原因而使调试器跳闸（第 1 行：无效字符等）。 ) 并且使用 Opera 只是一种痛苦的练习，它让我无法经常去这些网站。

我真正想要的是一个程序，它可以在全球范围内阻止某些站点，除了一天中的某些时间。就像，只浏览午餐或其他东西。如果有人知道这样的人，我很想听听。

# database - 使用 SQL Server 2008 在 Visio 中对数据库图表进行逆向工程

> ID：92811
> 
> 赞同：42
> 
> 时间：2008-09-18T14:03:40.553
> 
> 标签：database, sql-server-2008, odbc, visio

我需要对 Microsoft SQL Server 2008 进行逆向工程以创建 Microsoft Visio 2007 数据库模型图。所以我从数据库菜单中选择“逆向工程师”来连接数据库。

我配置了 Microsoft SQL Server Visio 驱动程序，以便使用 SQL Server Native Client 10.0 作为 ODBC 驱动程序。之后我创建了一个连接到我的数据库的用户 DSN。此 DSN 有效（至少提供的测试是成功的）。在逆向工程师向导中单击下一步后，Visio 会询问我正确提供的凭据，但单击确定后，我会收到以下消息：

> 当前选择的 Visio 驱动程序与数据源不兼容。

我尝试使用旧的 SQL Server ODBC 驱动程序，当然还重新配置了 Visio 驱动程序。它也不起作用。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-04-28T18:22:37.977

要将 Visio 2007 连接到 SQL Server 2008 数据库，请在 Visio 2007 中运行逆向工程师向导（数据库/逆向工程师...），从“已安装的 Visio 驱动程序”下拉列表中选择 ODBC 通用驱动程序。然后使用 SQL Native Client（2005.90.4035、2005 SP3）创建一个新的数据源。您将收到一条警告，指出检索到的某些信息可能不完整。单击确定并继续。这不是最直观的解决方案（但并不难），但至少这将允许您使用 Visio 2007 连接到 SQL 2008。

Chip Lambert，激流回旋咨询

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-09-18T15:24:23.777

通过 Microsoft 论坛获得Microsoft[支持：](http://forums.microsoft.com/TechNet/ShowPost.aspx?PostID=3825120&SiteID=17)

> 进一步调查显示，这是 Visio 2007 的预期行为。当 Visio 使用 Visio SQL Server 驱动程序打开连接时，它会检查服务器版本，并且由于 SQL Server 2008 在 Visio 2007 之后发布，它不会将 SQL Server 2008 识别为受支持的版本，并且关闭连接。您可以等待能够识别 SQL Server 2008 的未来版本的 Visio 发布，或者使用可以成功打开与 SQL Server 2008 的连接的 Visio Generic ODBC 驱动程序。第三种选择是使用 SQL Server 2005 的副本进行初始逆向工程. Visio 团队已意识到此问题。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-07-12T16:00:26.317

一个旧线程，但仍然是一个当前问题......我发现虽然使用 ODBC 通用驱动程序有效，但逆向工程工具却错过了触发器、检查子句、视图和存储过程。通过指定 Access Visio 驱动程序，至少我们恢复了检查子句和视图。

不过，总的来说，我不得不说，我认为这表明微软相关团队对他们的客户缺乏尊重。去年升级到 Visual Studio 2010 时我有过非常相似的经历，结果发现我的 SSIS 项目不再打开……从[这个线程](http://connect.microsoft.com/SQLServer/feedback/details/508552/ssis-vs2010-project-type)可以看出，MS 不在乎。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-24T19:34:55.877

您可以在 ODBC 数据源管理器实用程序中创建一个用户 DSN，然后使用选择 ODBC 通用驱动程序而不是 Microsoft SQL Server 驱动程序，通过 Visio 2007 连接到您的 MSSQL 2008 实例。

您还可以尝试使用适用于 Office 2007 的 SQL Server 2008 数据挖掘插件。

在此处获取它们：http: [//www.microsoft.com/downloads/details.aspx? FamilyId=896A493A-2502-4795-94AE-E00632BA6DE7&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=896A493A-2502-4795-94AE-E00632BA6DE7&displaylang=en)

我希望这有帮助！

干杯

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-08-10T20:47:31.260

我最终使用通用 OLE Db 提供程序而不是 ODBC 通用驱动程序连接到 SQL Server 2008 - 数据类型似乎可以通过。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-01-04T23:23:39.447

我也遇到了这个问题，如上所述我发现有效

1.  正在使用逆向工程向导
2.  在第一步中使用通用 OLE Db 提供程序
3.  然后在下一步中将连接提供程序设置为显示的最高 SQL 本机驱动程序（我在 Windows 10 Surface Pro 4 上使用 SQL2016 和 SQL 本机 11.0 以供参考）
4.  然后在连接选项卡中输入正确的目的地和凭据（如果不确定，请测试连接）

    这似乎对我有用，（然后我能够通过表索引视图主键和外键以及存储过程）。

我还发现 visio 一直锁定我......显然这很常见（我感觉很特别）在终于厌倦它之后我查看了这些链接

[https://dhondiyals.wordpress.com/2011/07/29/microsoft-visio-2010-crashes-very-frequently-resolved/](https://dhondiyals.wordpress.com/2011/07/29/microsoft-visio-2010-crashes-very-frequently-resolved/)

[https://answers.microsoft.com/en-us/msoffice/forum/msoffice_visio-mso_windows8/visio-2010-frozen-on-surface-pro/df1df27a-6585-4b0c-8442-a4363c541e08](https://answers.microsoft.com/en-us/msoffice/forum/msoffice_visio-mso_windows8/visio-2010-frozen-on-surface-pro/df1df27a-6585-4b0c-8442-a4363c541e08)

我发现我的问题出在后面，（触摸屏和手写运行应用程序）。所以结束了它，现在我有了我期待的体验

# c# - 在 C# 中将对象数组（实现接口 IFoo）转换为 IFoo[]

> ID：92820
> 
> 赞同：1
> 
> 时间：2008-09-18T14:04:31.720
> 
> 标签：c#

```
class A : IFoo
{
}

...

A[] arrayOfA = new A[10];

if(arrayOfA is IFoo[]) 
{
    // this is not called
} 
```

Q1：为什么`arrayOfA`不是数组`IFoos`？

Q2：为什么我不能`arrayOfA`投到`IFoo[]`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T14:12:09.503

`arrayOfA` **是** `IFoo[]`。

你的程序一定有其他问题。

您似乎已经模拟了一些代码来显示问题，但实际上您的代码（见下文）按您的预期工作。尝试用真实的代码更新这个问题 - 或者尽可能接近真实 - 我们可以再看看。

```
using System;
public class oink {
    public static void Main() {
        A[] aOa = new A[10];

        if (aOa is IFoo[]) { Console.WriteLine("aOa is IFoo[]"); }

    }
    public interface IFoo {}
    public class A : IFoo {}
}

PS D:\> csc test.cs
Microsoft (R) Visual C# 2008 Compiler version 3.5.30729.1
for Microsoft (R) .NET Framework version 3.5
Copyright (C) Microsoft Corporation. All rights reserved.

PS D:\> D:\test.exe
aOa is IFoo[]
PS D:\> 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2008-09-18T14:09:19.447

你可以试试

```
if (arrayofA[0] is IFoo) {.....} 
```

哪种回答你的问题。`arrayOfA`是一个数组。数组是实现`ICloneable`, `IList`, `ICollection`, &的对象`IEnumerable`。`IFoo`不在其中。

# svn - 如何使用 TextMate 作为我的命令行颠覆消息编辑器？

> ID：92826
> 
> 赞同：4
> 
> 时间：2008-09-18T14:05:00.083
> 
> 标签：svn, command-line, textmate

简单地将 SVN_EDITOR 变量设置为“mate”并不能完成工作。它会在适当的时候打开 TextMate，但是当我保存消息并退出时，系统会提示我继续、中止或重试。似乎缓冲区没有返回给 svn 命令以供使用。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-09-18T14:07:05.973

您需要在 SVN_EDITOR（或 EDITOR）变量中包含命令行选项

导出 SVN_EDITOR='mate -w'

这使得 svn 命令在继续之前等待编辑器关闭/释放文件，这是该过程现在变得混乱的地方。

见[这里](http://manual.macromates.com/en/using_textmate_from_terminal.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-02-15T00:59:13.123

我发现这个线程谷歌搜索 textmate 作为 svn 编辑器。在尝试时，我发现您还可以在`~/.subversion/config`文件中设置 editor-cmd，更重要的是，您应该将值设置为，`mate -wl1`因为这样插入符号将放置在文件的第一行，即放置注释以进行提交信息。

只是我对这个线程的贡献。

# asp.net - 实时站点的 ASP .NET 部署模型

> ID：92835
> 
> 赞同：1
> 
> 时间：2008-09-18T14:06:07.380
> 
> 标签：asp.net, deployment

我最近继承了一个当前运行的棕地应用程序。通过响应或带有链接的响应，如何以及什么是对站点进行更改并将其部署到实时 ASP .NET 网站的最佳方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T14:08:29.870

我总是先在我的盒子上开发。

我将进行测试，备份实时站点，然后通过 ftp 更新更新。

很简单，但我还没有遇到问题。

另外：我也正在运行 svn，并且在更新实时站点之前我会提交更改。这样我就有了两个备份：源代码控制和物理压缩备份。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T14:45:30.577

Don't know if this will work for you, but we use the "Use fixed naming and single page assemblies" publish model of VS2005\. We test locally, deploy to a dev server to test with the other developer's changes (there are only 2 of us), and then deploy to a temp directory on the live server. Then we RDP into the live server, backup the files we changed, and copy the new ones over in place.

Works really well, and we avoid paving each other's stuff this way. We tried deploying direct to the site using the built in deploy, but that removes the entire directories, deleting a whole bunch of static files we have within the IIS root folders.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T02:02:51.750

我发现的最易于管理的方法是使用部署应用程序。Application Center 2000 相当不错，但不再受支持。新应用程序可在[http://www.iis.net/downloads/default.aspx?tabid=34&g=6&i=1602](http://www.iis.net/downloads/default.aspx?tabid=34&g=6&i=1602)获得。它也适用于 COM 程序集。

# sharepoint - 如何在 MOSS 中使用来自不同站点的列表？

> ID：92837
> 
> 赞同：5
> 
> 时间：2008-09-18T14:06:39.267
> 
> 标签：sharepoint, moss

我在一个网站上有一个公告列表。我想将它作为 Web 部件添加到每个子站点的顶部。我怎样才能在 MOSS 中做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T14:30:45.747

在这种情况下，我使用了数据视图 Web 部件。创建 Web 服务数据源以从其他站点的列表中获取数据。

很像这样：

[http://www.sharepointblogs.com/ssa/archive/2007/02/23/showing-web-service-data-in-a-data-view-web-part.aspx](http://www.sharepointblogs.com/ssa/archive/2007/02/23/showing-web-service-data-in-a-data-view-web-part.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-21T18:49:15.200

几点。

首先，您指定您使用的是 WSS 3.0，因此 CQWP 不可用（您需要 MOSS 并打开发布以使其可用）。增强的社区版也不适合您，因为它源自 CQWP。

其次，我同意 Eugene Katz 的观点，即 DataFormWebPart 将是一种简单的方法，而且我的生成方式与他发布的链接略有不同。在 Sharepoint Designer 中，打开要放置 Web 部件的所需站点。从任务窗格菜单中选择数据源库，然后单击窗格底部的“连接到另一个库...”，然后浏览/选择包含公告列表的父站点。现在，您可以从“数据源库”窗格上新创建的节点将您的公告添加为 DataFormWebPart，就像它在您的站点上一样。如果您不熟悉，Sharepoint Designer 帮助将显示如何执行此操作。

根据自己的喜好设置 DataFormWebPart 后，您可以通过执行以下操作更轻松地将其添加到其他站点：突出显示新构建的 DataFormWebPart 并选择文件/导出/将 Web 部件保存到.../站点库。它现在将作为可添加的 Web 部件在整个网站集中提供。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T14:31:29.440

开箱即用是不可能的。列表仅限于一个站点。

您唯一的选择是使用内容查询 Web 部件（在 SharePoint Standard 或更高版本中可用）。

[这](http://www.datasprings.com/Resources/ArticlesInformation/AboutSharePointContentQueryWebPart/tabid/835/language/en-US/Default.aspx)是使用 CQWP 的方法。

[这里](http://www.codeplex.com/ECQWP)还有增强社区版。

您可以将这些嵌入到您的子网站模板中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T16:36:56.847

您应该使用 SharePoint 对象模型获取该特定列表的 SPList 对象。一旦你得到相同的结果，你就可以使用 RenderAsHtml() 方法渲染列表。请注意，RenderAsHtml() 方法将 SPQuery 对象作为参数。您需要使用适当的查询字符串创建一个 SPQuery 对象。此代码可能会覆盖自定义 Web 部件的 RenderWebPart() 方法：

SPSite 站点 = 新 SPSite(siteURL);

SPWeb web = site.OpenWeb(webName);

SPList 列表 = web.Lists[listName];

SPQuery 查询 = 新 SPQuery();

查询.查询 = 查询字符串；

字符串 html = list.RenderAsHtml(query);

输出.Write(html); //输出是RenderWebPart方法中的HtmlTextWriter对象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T00:43:12.233

内容查询 Web 部件或开源增强内容查询 Web 部件是完成此任务的好方法。如果您没有 MOSS 但有 WSS，Katz 先生和 Ashwin 先生的答案是可以接受的，但回答这个问题的方法不同。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-22T04:01:45.793

Codeplex 上的 Content By Type Web 部件是一个非常棒的 Web 部件。它还支持从任何子站点的任何列表中显示给定内容类型的项目。

见： http: [//www.codeplex.com/eoffice](http://www.codeplex.com/eoffice)

# c# - 是否有 .NET 函数来验证类名？

> ID：92841
> 
> 赞同：22
> 
> 时间：2008-09-18T14:07:27.643
> 
> 标签：c#, .net, validation, class, naming

我正在使用 CodeDom 根据用户值生成动态代码。其中一个值控制我正在生成的类的名称。我知道我可以使用正则表达式根据有关有效类名的语言规则对名称进行消毒，但我想知道框架中是否内置了特定方法来验证和/或消毒类名。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-09-18T14:22:40.727

确定字符串是否是类或变量的有效标识符的一种简单方法是调用静态方法

```
System.CodeDom.Compiler.CodeGenerator.IsValidLanguageIndependentIdentifier(string value) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-18T14:22:03.817

使用类`CreateValidIdentifier`上的方法`CSharpCodeProvider`。

```
CSharpCodeProvider codeProvider = new CSharpCodeProvider(); 
string sFixedName = codeProvider.CreateValidIdentifier("somePossiblyInvalidName"); 
CodeTypeDeclaration codeType = new CodeTypeDeclaration(sFixedName); 
```

给定一些输入，它会返回一个有效的名称。如果您只想验证名称而不是修复它，请比较输入和输出。它不会改变有效输入，因此输出将是等效的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T14:19:12.093

我找到了我的问题的答案。我可以打电话

```
CodeCompiler.ValidateIdentifiers(class1); 
```

其中 class1 是一个 CodeObject，用于验证该 CodeDom 树及下面的所有标识符。因此，我可以在创建 CodeTypeDeclaration class1 后立即调用它来验证类名，或者我可以构建我的 CodeDom，然后在最后调用它来验证树中的所有标识符。正是我需要的！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T16:02:10.877

```
public static bool IsReservedKeyWord(string identifier)
        {
            Microsoft.CSharp.CSharpCodeProvider csharpProvider = new Microsoft.CSharp.CSharpCodeProvider();
            return csharpProvider.IsValidIdentifier(identifier);
        } 
```

# html - 将表格布局转换为 Div

> ID：92842
> 
> 赞同：1
> 
> 时间：2008-09-18T14:07:35.863
> 
> 标签：html, css, layout

我正在实现一个使用 ASP.Repeater 来显示每个评论的评论控件。评论本身目前使用表格来显示，将一些图像划分为气泡中的评论。

我知道表格应该是设计布局的邪恶缩影，并且对于浏览器显示非常昂贵，但我不完全确定如何将我的圆角放在正确的位置并确保所有内容都对齐。

是否有人对所需的 HTML/CSS 有任何建议、示例、技巧，或者我应该坚持使用表格并希望获得最好的结果？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T14:19:03.980

我见过的使用 DIV 元素创建圆角的最佳资源是一篇关于“A List Apart”的文章 - 请参阅[http://alistapart.com/articles/customcorners/](http://alistapart.com/articles/customcorners/)。如果您希望使用 DIV 元素来布局整个站点，那么该站点上还有其他几篇相关文章。看：

[http://alistapart.com/articles/slidingdoors/](http://alistapart.com/articles/slidingdoors/)
[http://www.alistapart.com/articles/slidingdoors2/](http://www.alistapart.com/articles/slidingdoors2/)
[http://www.alistapart.com/articles/negativemargins/](http://www.alistapart.com/articles/negativemargins/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T14:12:06.540

在 CSS中有几种不同的方法来做[圆角](https://stackoverflow.com/questions/7089/what-is-the-best-way-to-create-rounded-corners-using-css)

我更喜欢尽可能使用 CSS 而不是表格，只是因为我发现代码更容易维护，而且这听起来像是一个具有完美范围的项目，可以让你沾沾自喜。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T14:13:04.430

简而言之，你会想要这样的东西：

```
<style>
  .start { background-image: url("topofbubble.png"); height: <heightofimage>; }
  .end { background-image: url("bottomofbubble.png"); height: <heightofimage>; }
  .body {background-image: url("sliceofbubblemiddle.png"); }
</style>

...

<div class="comment">
  <span class="start"></span>
  <span class="body">I would like to say that div layouts are far better than table layouts.</span>
  <span class="end"></style>
</div> 
```

那应该让你开始。我没有专门尝试代码，如有必要，可以制作一个完整的示例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T00:01:44.450

如果您愿意为 IE 用户呈现尖角，圆角可以通过`border-radius`CSS 属性轻松解决。目前没有浏览器将其实现为基本属性，但有一些浏览器将其作为前缀属性。例如，要在 Firefox 中使用它，您可以使用属性`-moz-border-radius`，对于 Safari，使用`-webkit-border-radius`等。

# perl - 如何在 Perl 中缩小数组？

> ID：92847
> 
> 赞同：13
> 
> 时间：2008-09-18T14:08:07.390
> 
> 标签：perl, arrays

如何在 Perl 中使数组更短？我阅读了一些网页，表明我可以分配：

```
$#ARRAY = 42; 
```

我读到不推荐使用 $# 。我也需要一个适用于数组数组的解决方案。这没有用：

```
$#$ARRAY[$i] = 42; 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-09-18T14:20:03.353

我不知道分配`$#ARRAY`被弃用；`perldoc perldata`从 5.10.0 开始，当然什么也没说。这是截断数组的最快方法。

如果您想要更具可读性的内容，请使用`splice`：

```
splice @ARRAY, 43; 
```

（注意`43`而不是`42`-`$#ARRAY`获取数组的最后一个索引，而获取数组`splice`的*长度*）。

至于处理数组数组，我假设您的意思是能够通过引用截断嵌套数组？在这种情况下，您需要：

```
$#{$ARRAY->[7]} = 42; 
```

或者

```
splice @{$ARRAY->[7]}, 43; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-18T14:17:22.907

您的选择几乎是无限的（我在这里概述了五种方法），但您的策略将完全取决于您的具体需求和目标。（所有示例都将 @array 转换为不超过 $N 个元素）

* * *

[编辑]

正如其他人指出的那样，原始问题中建议的方式实际上并未被弃用，它提供了最快、最简洁但不一定是最易读的解决方案。 **它还具有使用空元素扩展少于 $N 元素的数组的副作用**：

```
$#array = $N-1; 
```

* * *

最少代码：

```
#best for trimming down large arrays into small arrays
@array = $array[0..($N-1)]; 
```

从大型数组中修剪少量数字最有效：

```
#This is a little less expensive and clearer
splice(@array, $n, @#array); 
```

几乎在所有情况下都是不可取的，除非你真的喜欢 delete()：

```
#this is the worst solution yet because it requires resizing after the delete
while($N-1 < $#array)
{
   delete(array[$i]);
} 
```

如果您需要以相反的顺序列出列表的其余部分，这很有用：

```
#this is better than deleting because there is no resize
while($N-1 < $#array)
{
    pop @array;
    #or, "push $array2, pop @array;" for the reverse order remainder
} 
```

从长远来看有助于节省时间：

```
#don't put more values into the array than you actually want 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-18T16:20:01.473

该[`$#`](http://search.cpan.org/dist/perl-5.8.8/pod/perlvar.pod#%24%23)变量已弃用，但该`$#array`功能未弃用。

要`$#array`在产生数组引用的任意表达式上使用语法，请执行`$#{ EXPR }`.

查看无价之宝：[http ://perlmonks.org/?node=References+quick+reference](http://perlmonks.org/?node=References+quick+reference)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-18T14:48:28.700

您基本上自己给出了规范的答案。通过设置最后一个索引来缩短数组：

```
$#Array = 42 
```

表示数组中最后一个索引的 $#Foo 符号绝对*不会*被弃用。同样，分配给它也不会被弃用。引用 perldata 文档：

> 数组的长度是一个标量值。 **您可以通过评估 $#days 来找到数组 @days 的长度**，就像在 csh 中一样。但是，这不是数组的长度；它是最后一个元素的下标，这是一个不同的值，因为通常有第 0 个元素。 **分配给 $#days 实际上会更改数组的长度。** 以这种方式缩短数组会破坏中间值。延长先前缩短的数组不会恢复这些元素中的值。（它曾经在 Perl 4 中这样做，但我们必须打破它以确保在预期的时候调用析构函数。）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T14:26:02.747

*   $#array 是数组的*最后一个索引*。
*   $#$array*将是$array**指向*的数组的最后一个索引。
*   $#$array[$i] 表示您正在尝试索引标量-无法完成。$#{$array[3]} 在我们尝试引用最后一个索引之前正确解析了主数组的下标。
*   单独使用

    $#{$array[3]} = 9;

    将长度 9 分配给$array[3] 处的[自动激活数组。](http://en.wikipedia.org/wiki/Autovivification)

*   如有疑问，请使用 Data::Dumper：

    ```
    use Data::Dumper;
    $#{$array[3]} = 5;
    $#array       = 10;
    print Dumper( \@array, $array ), "\n"; 
    ```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T14:10:57.040

$#{$ARRAY[$i]} = 42;

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T14:12:44.417

你可以做

```
splice @array, $length;
#or
splice @{$arrays[$i]}, $length; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T18:20:39.920

有两种解释问题的方法。

*   如何减少数组的长度？
*   如何减少数组消耗的内存量？

到目前为止，大多数答案都集中在前者上。在我看来，最好的答案是**拼接**功能。例如，要从末尾删除 10 个元素：

```
splice @array, -10; 
```

然而，由于 Perl 为数组管理内存的方式，确保数组占用更少内存的唯一方法是将其复制到新数组（并让旧数组的内存被回收）。为此，我倾向于考虑使用*切片*操作。例如，要删除 10 个元素：

```
@new = @old[ 0 .. $#old - 10 ] 
```

以下是 500 个元素数组（使用 2104 字节）的不同方法的比较：

```
 original: length  500 => size 2104
     pound: length  490 => size 2208
    splice: length  490 => size 2104
    delete: length  490 => size 2104
     slice: length  490 => size 2064 
```

您可以看到只有切片操作（复制到新数组）的*大小*比原始操作小。

这是我用于此分析的代码：

```
use strict;
use warnings;
use 5.010;
use Devel::Size qw/size/;

my @original = (1 .. 500);
show( 'original', \@original );

my @pound = @original;
$#pound = $#pound - 10;
show( 'pound', \@pound );

my @splice = @original;
splice(@splice,-10);
show( 'splice', \@splice);

my @delete = @original;
delete @delete[ -10 .. -1 ];
show( 'delete', \@delete );

my @slice = @original[0 .. $#original - 10];
show( 'slice', \@slice);

sub show {
    my ($name, $ref) = @_;
    printf( "%10s: length %4d => size %d\n", $name, scalar @$ref, size($ref));
} 
```

# multithreading - 在主线程中使用 TAdsSettings 对象，在其他线程中使用 AdsQuery 对象是否安全？

> ID：92848
> 
> 赞同：1
> 
> 时间：2008-09-18T14:08:16.347
> 
> 标签：multithreading, delphi, advantage-database-server

我有一个正在转换为 ISAPI 的 Win-CGI 应用程序。

该应用程序使用 Extended Systems Advantage Database Server 的 TDataset 后代。

由于 TAdsSettings 对象只能有一个实例，因此它必须在主线程中。

请求线程中需要 TAdsQuery 对象。

这会起作用吗？也就是说，请求线程中的 AdsQueries 是否会从主线程中的 AdsSettings 对象中获取全局设置，这是否是线程安全的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T19:25:52.463

是的，它会起作用。TAdsSettings 组件修改 Advantage Client Engine (ACE) 中的设置，并且使用 ISAPI 将加载一个所有线程都使用的 ACE 实例。

但是，我不会推荐它。根据您正在更改的设置，直接调用 ACE API 会更有意义。例如，如果您只设置日期格式，则删除 TAdsSettings 组件并只调用 AdsSetDateFormat60 会更有意义，它需要一个连接句柄。摆脱 TAdsSettings 组件消除了设置 ACE 全局设置的大量调用。其中许多调用必须有一个同步对象来在全局更改时阻止所有连接。这将对性能产生负面影响，尤其是在 Web 应用程序等多线程应用程序中。而是进行对指定连接句柄进行操作的调用。

您可以通过引用 TAdsConnection.Handle 属性或调用 TAdsQuery.GetAceConnectionHandle 方法来获取连接句柄。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T17:08:16.693

如果 AdsQueries 不在主线程中（即），请确保 AdsQueries 使用 Synchronize 直接访问 TAdsSettings（或使用消息系统在工作线程和主线程之间进行通信，而不是直接访问`System.MainThreadID <> Windows.GetCurrentThreadID`）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T11:33:26.910

我也在新闻组中问过这个问题：devzone.advantagedatabase.com, Advantage.Delphi

为了完整起见，我将从该线程的其余部分添加更多问题/答案：

> **问我）：**
> 
> 线程中的许多查询当前未附加到 TAdsConnection 对象。我计划为每个线程创建一个连接以供这些“孤立”查询使用，但它是一个大型应用程序，这需要时间。我也很确定 TAdsSettings 对象中唯一的非默认属性是服务器类型集，它也可以在连接组件中设置，因此一旦所有查询都链接到连接，就不需要设置组件。我将考虑直接调用设置 API 作为替代方案。
> 
> 同时，我确实对线程和未分配连接组件的查询有疑问。我从帮助文件中注意到，如果多个线程中的查询共享一个连接对象，则查询将连续运行而不是同时运行。在每个线程中都有一个连接对象，这应该不是问题，但我想知道没有分配连接对象的*查询*。从多线程并发的角度来看，它们会被认为是在独立的连接上，还是会被认为是在同一个连接上，因此必须相互让步？
> 
> **答案（杰里米）：**
> 
> 您将需要解决这个问题。他们将只搜索全局连接列表以找到具有相同路径的连接，然后他们将使用该连接。在多线程应用程序中不好。

因此，根据 Jeremy 的回答，最好为每个线程创建至少一个 TAdsConnection 对象，并确保所有查询都附加到它，否则可能会发生序列化。

# c++ - C ++中的结构和类有什么区别？

> ID：92859
> 
> 赞同：471
> 
> 时间：2008-09-18T14:09:58.947
> 
> 标签：c++, oop, class, struct, c++-faq

[已经在 C#/.Net 的上下文中提出了](https://stackoverflow.com/questions/13049)这个问题。

现在我想了解 C++ 中结构和类之间的区别。请讨论技术差异以及在 OO 设计中选择其中一种的原因。

我将从一个明显的区别开始：

*   如果不指定`public:`or `private:`，则结构的成员默认是公共的；默认情况下，类的成员是私有的。

我确信在 C++ 规范的晦涩角落中还可以找到其他差异。

* * *

## 回答 #1

> 赞同：480
> 
> 时间：2009-06-16T06:19:01.103

您忘记了类和结构之间棘手的第二个区别。

引用标准（C++98 到 C++11 中的第 11.2.2 节）：

> 在基类没有*访问说明符*的情况下 ，当派生类声明为 *struct时假定为 public，而当声明**类*为 class 时假定为 private 。

为了完整起见，类和结构之间更广为人知的区别在 (11.2) 中定义：

> 默认情况下，使用关键字 class 定义的类的成员*是*私有*的。*默认情况下，使用关键字*struct*或*union*定义的类的成员 是*公共的。*

附加区别：关键字`class`可以用来声明模板参数，而`struct`关键字不能这样使用。

* * *

## 回答 #2

> 赞同：167
> 
> 时间：2008-09-18T14:18:44.153

引用[C++ FAQ](https://isocpp.org/wiki/faq/classes-and-objects#struct-vs-class)，

> [7.8]关键字struct和class有什么区别？
> 
> 结构的成员和基类默认是公共的，而在类中，它们默认是私有的。注意：您应该明确地使您的基类公开、私有或受保护，而不是依赖默认值。
> 
> 结构和类在其他方面在功能上是等价的。
> 
> 好的，足够干净的技术谈话了。从情感上讲，大多数开发人员在类和结构之间做出了强烈的区分。结构感觉就像是一堆开放的位，封装或功能的方式很少。一个类感觉就像是一个活生生的、负责任的社会成员，具有智能服务、强大的封装屏障和定义明确的接口。由于这是大多数人已经拥有的含义，因此如果您的类具有很少的方法并且具有公共数据（这样的事情确实存在于设计良好的系统中！），您可能应该使用 struct 关键字，否则您可能应该使用该类关键词。

* * *

## 回答 #3

> 赞同：130
> 
> 时间：2010-08-07T23:17:38.190

值得记住 C++ 的起源以及与 C 的兼容性。

C 有结构，没有封装的概念，所以一切都是公开的。

在采用面向对象的方法时，默认情况下公开通常被认为是一个坏主意，因此在制作一种原生有利于 OOP 的 C 形式时（您可以在 C 中执行 OO，但它对您没有帮助），这是C++ 中的想法（最初是“C With Classes”），默认情况下将成员设为私有是有意义的。

另一方面，如果 Stroustrup 更改了 的语义`struct`，使其成员默认为私有，则会破坏兼容性（不再像标准分歧那样经常如此，但所有有效的 C 程序也是有效的 C++ 程序，这对让 C++ 站稳脚跟有很大的影响）。

所以引入了一个新的关键字，`class`它与结构完全一样，但默认情况下是私有的。

如果 C++ 是从零开始，没有历史，那么它可能只有一个这样的关键字。它也可能不会产生它所产生的影响。

一般来说，人们在做类似 C 中如何使用结构的事情时会倾向于使用结构。公共成员，没有构造函数（只要它不在联合中，你**可以**在结构中拥有构造函数，就像类一样，但人们倾向于不这样做），没有虚拟方法等。因为语言与通信一样多人们阅读代码来指导机器（否则我们会坚持使用汇编和原始 VM 操作码），坚持下去是个好主意。

* * *

## 回答 #4

> 赞同：35
> 
> 时间：2008-09-18T14:12:32.140

类的成员默认是私有的。结构的成员默认是公开的。除此之外没有其他区别。另请参阅[此问题](https://stackoverflow.com/questions/54585/when-should-you-use-a-class-vs-a-struct-in-c)。

* * *

## 回答 #5

> 赞同：31
> 
> 时间：2008-09-18T14:15:12.990

根据[C++ 编程语言](https://rads.stackoverflow.com/amzn/click/com/0201700735)中的 Stroustrup ：

> 您使用哪种风格取决于环境和品味。我通常更喜欢`struct`用于所有数据都公开的类。我认为这样的类“不是很合适的类型，只是数据结构”。

功能上，除了public/private没有区别

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2015-07-24T05:44:13.843

1.  类的成员默认是**私有的**，结构的成员默认是**公有的**。

例如程序 1 编译失败，程序 2 工作正常。

```
// Program 1
#include <stdio.h>

class Test {
    int x; // x is private
};

int main()
{
  Test t;
  t.x = 20; // compiler error because x is private
  getchar();
  return 0;
} 
```

```
// Program 2
#include <stdio.h>

struct Test {
    int x; // x is public
};

int main()
{
  Test t;
  t.x = 20; // works fine because x is public
  getchar();
  return 0;
} 
```

2.  从类/结构派生结构时，**基类/结构的默认访问说明符是 public**。并且在派生类时，**默认访问说明符是 private**。

例如程序 3 编译失败，程序 4 工作正常。

```
// Program 3
#include <stdio.h>

class Base {
public:
    int x;
};

class Derived : Base { }; // is equivalent to class Derived : private Base {}

int main()
{
  Derived d;
  d.x = 20; // compiler error because inheritance is private
  getchar();
  return 0;
} 
```

```
// Program 4
#include <stdio.h>

class Base {
public:
    int x;
};

struct Derived : Base { }; // is equivalent to struct Derived : public Base {}

int main()
{
  Derived d;
  d.x = 20; // works fine because inheritance is public
  getchar();
  return 0;
} 
```

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2008-09-18T14:23:30.927

STRUCT 是一种抽象数据类型，它根据结构规范划分给定的内存块。结构在文件序列化/反序列化中特别有用，因为结构通常可以逐字写入文件。（即获取指向结构的指针，使用 SIZE 宏计算要复制的字节数，然后将数据移入或移出结构。）

类是一种不同类型的抽象数据类型，它试图确保信息隐藏。在内部，可以有各种机制、方法、临时变量、状态变量。等等，它们都用于为希望使用该类的任何代码提供一致的 API。

实际上，结构是关于数据的，类是关于代码的。

但是，您确实需要了解这些仅仅是抽象。完全有可能创建看起来很像类的结构和看起来很像结构的类。事实上，最早的 C++ 编译器只是将 C++ 代码翻译成 C 的预编译器。因此，这些抽象对逻辑思维是有益的，而不一定是计算机本身的资产。

除了每个都是不同类型的抽象之外，类还为 C 代码命名难题提供了解决方案。由于不能有多个同名函数公开，因此开发人员过去常常遵循 _() 模式。例如 mathlibextreme_max()。通过将 API 分组到类中，可以将类似的函数（这里我们称之为“方法”）组合在一起，并防止在其他类中命名方法。这允许程序员更好地组织他的代码并增加代码重用。理论上，至少。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2008-09-18T14:15:19.043

唯一的另一个区别是类和结构的默认继承，不出所料，它们分别是私有的和公共的。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2019-06-19T20:35:59.393

`class`和之间`struct`的区别是关键字之间的区别，而不是数据类型之间的区别。这两个

```
struct foo : foo_base { int x;};
class bar : bar_base { int x; }; 
```

两者都定义了一个类类型。此上下文中关键字的不同之处在于默认访问权限不同：

*   `foo::x`是公开的并且`foo_base`是公开继承的
*   `bar::x`是私有的并且`bar_base`是私有继承的

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2008-09-19T10:12:11.273

1.  结构的成员默认是公共的，类的成员默认是私有的。
2.  Structure 从另一个结构或类的默认继承是公共的。从另一个结构或类的类的默认继承是私有的。

```
class A{    
public:    
    int i;      
};

class A2:A{    
};

struct A3:A{    
};

struct abc{    
    int i;
};

struct abc2:abc{    
};

class abc3:abc{
};

int _tmain(int argc, _TCHAR* argv[])
{    
    abc2 objabc;
    objabc.i = 10;

    A3 ob;
    ob.i = 10;

    //A2 obja; //privately inherited
    //obja.i = 10;

    //abc3 obss;
    //obss.i = 10;
} 
```

这是在VS2005上。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-09-18T14:15:11.307

不在规范中，没有。主要区别在于程序员在 2 年内阅读您的代码时的期望。结构通常被假定为 POD。当您为定义对象以外的目的定义类型时，结构也用于模板元编程。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2008-09-18T15:31:53.290

需要注意的另一件事是，如果您更新了具有使用类的结构的旧版应用程序，您可能会遇到以下问题：

旧代码有结构，代码被清理，这些变成了类。然后将一两个虚函数添加到新更新的类中。

当虚函数在类中时，编译器将在内部添加指向类数据的额外指针以指向函数。

这将如何破坏旧的遗留代码是，如果在旧代码中的某个地方使用 memfill 清除结构以将其全部清除为零，这也会破坏额外的指针数据。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2011-11-12T11:21:53.650

另一个主要区别是在模板方面。据我所知，您可以在定义模板而不是结构时使用类。

```
template<class T> // OK
template<struct T> // ERROR, struct not allowed here 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2018-12-19T14:00:23.890

1.  默认情况下，使用关键字定义的类的成员`class`。默认情况下`private`，使用关键字`struct`(or `union`)定义的类的成员。`public`

2.  如果基类没有访问说明符，`public`则在声明**派生**类时假定，并在声明`struct`类`private`时假定`class`。

3.  您可以声明一个`enum class`但不能声明一个`enum struct`.

4.  您可以使用`template<class T>`但不能使用`template<struct T>`.

另请注意，C++ 标准允许您将类型前向声明为 a `struct`，然后`class`在声明类型时使用，反之亦然。此外，`std::is_class<Y>::value`对于`true`Y 是 a`struct`和 a `class`，但是`false`对于 a `enum class`。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-09-18T14:13:29.017

这是一个很好的解释：[http ://carcino.gen.nz/tech/cpp/struct_vs_class.php](http://carcino.gen.nz/tech/cpp/struct_vs_class.php)

> 因此，再一次：在 C++ 中，结构与类相同，只是结构的成员默认具有公共可见性，但类的成员默认具有私有可见性。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-09-18T14:17:42.300

这只是一个约定。可以创建结构来保存简单数据，但后来随着成员函数和构造函数的添加而演变。另一方面，看到除 public 之外的任何东西是不寻常的：在结构中访问。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2010-04-18T09:18:14.243

> ISO IEC 14882-2003
> 
> **9班**
> 
> §3
> 
> 结构是使用*class-key* `struct`定义的类；它的成员和基类（第 10 条）默认是公共的（第 11 条）。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2011-08-04T14:25:00.830

其他答案提到了私有/公共默认值，（但请注意，结构是类是结构；它们不是两个不同的项目，只是定义同一项目的两种方式）。

值得注意的是（特别是因为提问者可能正在使用 MSVC++，因为他提到了“非托管”C++）是 Visual C++ 在某些情况下会抱怨，如果一个类是用声明`class`然后定义的`struct`（或者可能反过来)，尽管标准说这是完全合法的。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2012-07-10T19:07:09.190

*   . 在类中，默认情况下所有成员都是私有的，但在结构中，默认情况下成员是公共的。

    1.  结构没有构造函数和析构函数之类的术语，但是如果您不提供，则类编译器会创建默认值。

    2.  Sizeof 空结构是 0 Bytes 或者 Sizeof 空类是 1 Byte 结构默认访问类型是 public。通常应该使用结构来对数据进行分组。

    类默认访问类型是私有的，继承的默认模式是私有的。应该使用一个类来对数据和对该数据进行操作的方法进行分组。

    简而言之，约定是当目的是对数据进行分组时使用结构，而当我们需要数据抽象和可能继承时使用类。

    在 C++ 中，结构和类是按值传递的，除非显式取消引用。在其他语言中，类和结构可能具有不同的语义——即。对象（类的实例）可以通过引用传递，结构可以通过值传递。注意：有与此问题相关的评论。请参阅讨论页添加到对话。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2016-09-29T11:38:01.740

虽然其他答案暗示了这一点，但并未明确提及 - 结构与 C 兼容，具体取决于使用情况；类不是。

这意味着如果您正在编写一个希望与 C 兼容的标头，那么除了 struct （在 C 世界中不能有函数；但可以有函数指针）之外，您别无选择。

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2015-05-01T12:30:43.610

您可以考虑将其作为何时使用 struct 或 class 的指南，[https://msdn.microsoft.com/en-us/library/ms229017%28v=vs.110%29.aspx](https://msdn.microsoft.com/en-us/library/ms229017%28v=vs.110%29.aspx)。

> √ 如果类型的实例很小且通常短暂存在或通常嵌入在其他对象中，请考虑定义结构而不是类。
> 
> X 避免定义结构，除非该类型具有以下所有特征：
> 
> 它在逻辑上表示单个值，类似于原始类型（int、double 等）。
> 
> 它的实例大小小于 16 个字节。
> 
> 它是不可变的。
> 
> 它不必经常装箱。

* * *

## 回答 #22

> 赞同：-2
> 
> 时间：2015-03-16T16:49:09.007

类仅在软件工程的上下文中才有意义。在数据结构和算法的上下文中，类和结构没有那么不同。没有任何规则限制必须引用该类的成员。

当开发有大量没有课程的人的大型项目时，您最终可能会得到复杂的耦合代码，因为每个人都使用他们想要的任何函数和数据。类提供权限控制和固有功能以增强解耦和重用代码。

如果您阅读了一些软件工程原理，您会发现大多数标准如果不上课就无法轻松实现。例如： [http ://en.wikipedia.org/wiki/SOLID_%28object-oriented_design%29](http://en.wikipedia.org/wiki/SOLID_%28object-oriented_design%29)

顺便说一句，当结构分配大量内存并包含多个变量时，值类型变量表示值嵌入在分配结构的位置。相反，引用类型变量的值是外部的，并且由一个指针引用，该指针也嵌入在分配结构的位置。

* * *

## 回答 #23

> 赞同：-3
> 
> 时间：2013-04-15T13:57:45.987

**C++中struct**和**class**关键字的区别在于，当特定复合数据类型没有特定说明符时，默认**struct**或**union**是public关键字，只考虑数据隐藏，class是private关键字，考虑隐藏程序代码或数据。总是有些程序员为了代码而使用**结构**来存储数据和**类**。有关更多信息，请联系其他来源。

* * *

## 回答 #24

> 赞同：-3
> 
> 时间：2013-08-27T01:22:29.987

在所有这些因素中，可以得出结论，概念类非常适合表示现实世界的对象，而不是“结构”。很大程度上是因为类中使用的 OOP 概念在解释现实世界场景时非常实用，因此更容易将它们与现实结合起来。例如，结构的默认继承是公共的，但如果我们将此规则应用于现实世界，那就太荒谬了。但是在一个类中，默认继承是私有的，这更现实。

无论如何，我需要证明的是类是一个更广泛的、现实世界适用的概念，而结构是一个内部组织很差的原始概念（尽管结构遵循 OOP 概念，但它们的含义很差）

* * *

## 回答 #25

> 赞同：-3
> 
> 时间：2014-01-28T19:50:07.233

oops 中结构体和类关键字的主要区别在于，结构体中不存在公共和私有成员声明。数据成员和成员函数可以定义为公共、私有和受保护的。

* * *

## 回答 #26

> 赞同：-4
> 
> 时间：2015-07-15T18:21:35.397

**更新：**请忽略此回复。我没有考虑结构体的值未初始化而恰好为0的可能性。结构体和类之间没有初始化差异。

* * *

我看到与默认初始化有关的结构和类之间的另一个不同之处。

```
struct Foo {
    int a;
};

class Bar {
    int a;
};

class Tester {
    Foo m_Foo = Foo();
    Bar m_Bar = Bar();

public:
    Tester() {}
};

int main() {
    auto myTester = Tester();
} 
```

运行该代码并检查 myTester。您会发现对于 m_Foo，结构体 m_Foo.a 已初始化为 0，但对于 m_Bar，类 m_Bar.a 未初始化。因此，默认构造函数对结构和类的作用似乎确实有所不同。我在 Visual Studio 中看到了这一点。

* * *

## 回答 #27

> 赞同：-4
> 
> 时间：2017-06-09T13:14:36.580

struct 和 class 的主要区别在于，struct 中只能声明不同数据类型的数据变量，而 class 中可以声明数据变量、成员函数，从而可以通过函数来​​操作数据变量。

-> 我在类 vs 结构中发现的另一个方便的事情是，在程序中实现文件时，如果你想在每组新操作上一次又一次地对结构进行一些操作，你需要创建一个单独的函数，你需要从文件中读取结构的对象后传递它，以便对其进行一些操作。在课堂上，如果您创建一个函数，该函数每次都对所需的数据进行一些操作..它很容易，您只需从文件中读取对象并调用该函数..

但这取决于程序员他/她认为哪种方式合适......根据我的说法，我每次都喜欢上课，因为它支持 OOP，这就是它在几乎所有语言中实现的原因以及它所有时间编程的美妙特性；- )

是的，我忘了提到的最难忘的区别是，类支持数据隐藏，还支持在内置数据类型上执行的操作，而 struct 不支持！

* * *

## 回答 #28

> 赞同：-5
> 
> 时间：2011-08-04T13:28:15.140

我发现了另一个不同之处。如果您没有在类中定义构造函数，编译器将定义一个。但是在结构中，如果你没有定义构造函数，编译器也不会定义构造函数。所以在某些我们真的不需要构造函数的情况下，struct 是更好的选择（性能提示）。对不起我的英语不好。

* * *

## 回答 #29

> 赞同：-5
> 
> 时间：2013-09-25T10:54:45.823

类是引用类型，结构是值类型。
当我说类是引用类型时，
基本上它们将包含实例变量的地址。

例如：

```
Class MyClass
{
    Public Int DataMember;  //By default, accessibility of class data members 
                            //will be private. So I am making it as Public which 
                            //can be accessed outside of the class.
} 
```

在 main 方法中，
我可以使用 new 运算符创建此类的实例，该运算符为此类分配内存
并将其基地址存储到 MyClass 类型变量（_myClassObject2）中。

```
Static Public void Main (string[] arg)
{
    MyClass _myClassObject1 = new MyClass();
    _myClassObject1.DataMember = 10;

    MyClass _myClassObject2 = _myClassObject1;
    _myClassObject2.DataMember=20;
} 
```

在上述程序中，MyClass _myClassObject2 = _myClassObject1; 指令表明 MyClass 类型的两个变量

1.  我的类对象1
2.  我的类对象2

并将指向相同的内存位置。
它基本上将相同的内存位置分配给另一个相同类型的变量。

因此，如果我们对任何一个对象类型 MyClass 所做的任何更改都会对另一个对象产生影响，
因为两者都指向相同的内存位置。

“_myClassObject1.DataMember = 10;” 在这一行，对象的两个数据成员都将包含值 10。
“_myClassObject2.DataMember = 20;” 在这一行，对象的数据成员都将包含 20 的值。
最终，**我们通过指针访问对象的数据成员。**

与类不同，结构是值类型。例如：

```
Structure MyStructure
{
    Public Int DataMember;  //By default, accessibility of Structure data 
                            //members will be private. So I am making it as 
                            //Public which can be accessed out side of the structure.
}

Static Public void Main (string[] arg)
{
    MyStructure _myStructObject1 = new MyStructure();
    _myStructObject1.DataMember = 10;

    MyStructure _myStructObject2 = _myStructObject1;
    _myStructObject2.DataMember = 20;
} 
```

在上述程序中，
使用 new 运算符实例化 MyStructure 类型的对象
并将地址存储到 MyStructure 类型的 _myStructObject 变量中，并
使用“_myStructObject1.DataMember = 10”将值 10 分配给结构的数据成员。

在下一行中，
我声明了另一个 MyStructure 类型的变量 _myStructObject2 并将 _myStructObject1 分配给它。
此处 .NET C# 编译器创建 _myStructureObject1 对象的另一个副本，
并将该内存位置分配给 MyStructure 变量 _myStructObject2。

因此，无论我们对 _myStructObject1 所做的任何更改都不会对另一个 MyStructObject 类型的变量 _myStructObject2 产生影响。
这就是为什么我们说结构是值类型。

所以类的直接基类是对象，结构的直接基类是继承自 Object 的 ValueType。
**类将支持继承，而结构则不支持。**

我们怎么说呢？
这背后的原因是什么？
答案是类。

它可以是抽象的、密封的、静态的和部分的，不能是私有的、受保护的和受保护的内部的。

* * *

## 回答 #30

> 赞同：-8
> 
> 时间：2014-12-05T14:45:45.223

结构和类之间有3个基本区别

1St-内存是为堆栈内存中的结构保留的（接近编程语言），堆栈内存中的类是否保留仅用于引用和实际内存保留在堆内存中。

2Nd - 默认情况下，结构视为公共，无论类视为私有。

3Rd-不能在结构中重用代码，但在类中我们可以多次重用相同的代码，称为inhertence

# c# - ascx 用户控件中的事件处理

> ID：92860
> 
> 赞同：3
> 
> 时间：2008-09-18T14:10:01.880
> 
> 标签：c#, asp.net

将事件从用户控件传递到父控件/页面的最佳实践是什么我想做类似的事情：

```
MyPage.aspx:
<asp:Content ID="Content1" ContentPlaceHolderID="MainContentPlaceholder" runat="server">
  <uc1:MyUserControl ID="MyUserControl1" runat="server" 
     OnSomeEvent="MyUserControl_OnSomeEvent" />

MyUserControl.ascx.cs:
public partial class MyUserControl: UserControl
{
    public event EventHandler SomeEvent;
....
   private void OnSomething()
    {
        if (SomeEvent!= null)
            SomeEvent(this, EventArgs.Empty);
    } 
```

问题是什么是最佳做法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T14:19:13.853

您可能希望在父控件中订阅的控件上创建一个事件。有关示例，请参阅[OdeToCode](http://www.odetocode.com/code/94.aspx)。

这是为了长寿的文章：

一些用户控件是完全独立的，例如，显示当前股票报价的用户控件不需要与页面上的任何其他内容进行交互。其他用户控件将包含回发按钮。尽管可以从包含页面订阅按钮单击事件，但这样做会破坏一些面向对象的封装规则。一个更好的想法是在用户控件中发布一个事件，以允许任何相关方处理该事件。

这种技术通常被称为“事件冒泡”，因为事件可以继续通过层，从底部（用户控件）开始，可能像气泡向上移动香槟杯一样到达顶层（页面）。

首先，让我们创建一个带有按钮的用户控件。

```
<%@ Control Language="c#" AutoEventWireup="false" 
    Codebehind="WebUserControl1.ascx.cs" 
    Inherits="aspnet.eventbubble.WebUserControl1" 
    TargetSchema="http://schemas.microsoft.com/intellisense/ie5"
%>
<asp:Panel id="Panel1" runat="server" Width="128px" Height="96px">
    WebUserControl1 
    <asp:Button id="Button1" Text="Button" runat="server"/>
</asp:Panel> 
```

用户控件背后的代码如下所示。

```
public class WebUserControl1 : System.Web.UI.UserControl
{
   protected System.Web.UI.WebControls.Button Button1;
   protected System.Web.UI.WebControls.Panel Panel1;

   private void Page_Load(object sender, System.EventArgs e)
   {
      Response.Write("WebUserControl1 :: Page_Load <BR>");
   }

   private void Button1_Click(object sender, System.EventArgs e)
   {
      Response.Write("WebUserControl1 :: Begin Button1_Click <BR>");
      OnBubbleClick(e);
      Response.Write("WebUserControl1 :: End Button1_Click <BR>");
   }

   public event EventHandler BubbleClick;

   protected void OnBubbleClick(EventArgs e)
   {
      if(BubbleClick != null)
      {
         BubbleClick(this, e);
      }
   }           

   #region Web Form Designer generated code
   override protected void OnInit(EventArgs e)
   {
      InitializeComponent();
      base.OnInit(e);
   }

   private void InitializeComponent()
   {
      this.Button1.Click += new System.EventHandler(this.Button1_Click);
      this.Load += new System.EventHandler(this.Page_Load);

   }
   #endregion

} 
```

用户控件指定一个声明委托的公共事件 (BubbleClick)。任何对 BubbleClick 事件感兴趣的人都可以添加一个 EventHandler 方法以在事件触发时执行——就像用户控件为 Button 触发 Click 事件时添加一个 EventHandler 一样。

在 OnBubbleClick 事件中，我们首先检查是否有人附加到该事件（BubbleClick != null），然后我们可以通过调用 BubbleClick 调用所有事件处理方法，通过 EventArgs 参数并设置用户控件（this）作为事件发送者。请注意，我们还使用 Response.Write 来跟踪执行流程。

ASPX 页面现在可以使用户控件工作。

```
<%@ Register TagPrefix="ksa" 
    TagName="BubbleControl" 
    Src="WebUserControl1.ascx" 
%>
<%@ Page language="c#" Codebehind="WebForm1.aspx.cs" 
    AutoEventWireup="false" Inherits="aspnet.eventbubble.WebForm1" 
%>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" >
<HTML>
    <HEAD>
        <title>WebForm1</title>
    </HEAD>
    <body MS_POSITIONING="GridLayout">
        <form id="Form1" method="post" runat="server">
            <ksa:BubbleControl id="BubbleControl" runat="server" />
        </form>
    </body>
</HTML> 
```

在页面后面的代码中。

```
public class WebForm1 : System.Web.UI.Page
{
   protected WebUserControl1 BubbleControl;

   private void Page_Load(object sender, System.EventArgs e)
   {
      Response.Write("WebForm1 :: Page_Load <BR>");
   }

   #region Web Form Designer generated code
   override protected void OnInit(EventArgs e)
   {
      InitializeComponent();
      base.OnInit(e);
   }

   private void InitializeComponent()
   {    
      this.Load += new System.EventHandler(this.Page_Load);
      BubbleControl.BubbleClick += new EventHandler(WebForm1_BubbleClick);
   }
   #endregion

   private void WebForm1_BubbleClick(object sender, EventArgs e)
   {
      Response.Write("WebForm1 :: WebForm1_BubbleClick from " + 
                     sender.GetType().ToString() + "<BR>");         
   }
} 
```

请注意，父页面只需要在 InitializeComponent 方法期间添加一个事件处理程序。当我们收到事件时，我们将再次使用 Reponse.Write 来跟踪执行流程。

一个警告：如果任何时候事件神秘地停止工作，请检查 InitializeComponent 方法以确保设计者没有删除任何添加事件处理程序的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T14:16:52.363

1) 在用户控件中声明一个公共事件

2) 在用户控件内的适当位置发出 RaiseEvent

3）在父页面的Init事件中，使用AddHandler将control.event分配给你要使用的处理程序

就那么简单！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-20T17:38:42.513

我在 OdeToCode 上找到了 @lordscarlet 在他接受的解决方案中链接到的相同解决方案。问题是我需要 VB 而不是 C# 中的解决方案。它没有完美地翻译。具体来说，检查 OnBubbleClick 中的事件处理程序是否为 null 在 VB 中不起作用，因为编译器认为我正在尝试调用该事件，并且给出了一个错误，提示“...不能直接调用。使用 'RaiseEvent'声明引发事件。” 因此，这里是 OdeToCode 解决方案的 VB 翻译，使用名为 CountryDropDownList 的控件。

对于初学者，让我们创建一个附加下拉列表的用户控件。

```
<%@ Control Language="vb" AutoEventWireup="false" CodeBehind="CountryDropDownList.ascx.vb" Inherits="CountryDropDownList" %>
<asp:DropDownList runat="server" ID="ddlCountryList" OnSelectedIndexChanged="ddlCountryList_SelectedIndexChanged" AutoPostBack="true">
    <asp:ListItem Value=""></asp:ListItem>
    <asp:ListItem value="US">United States</asp:ListItem>
    <asp:ListItem value="AF">Afghanistan</asp:ListItem>
    <asp:ListItem value="AL">Albania</asp:ListItem>
</asp:DropDownList> 
```

用户控件背后的代码如下所示。

```
Public Class CountryDropDownList
    Inherits System.Web.UI.UserControl
    Public Event SelectedCountryChanged As EventHandler

    Protected Sub ddlCountryList_SelectedIndexChanged(sender As Object, e As EventArgs)
        ' bubble the event up to the parent
        RaiseEvent SelectedCountryChanged(Me, e)
    End Sub
End Class 
```

ASPX 页面现在可以使用户控件工作。

```
<%@ Page Language="vb" AutoEventWireup="false" CodeBehind="UpdateProfile.aspx.vb" Inherits="UpdateProfile" MaintainScrollPositionOnPostback="true" %>
<%@ Register Src="~/UserControls/CountryDropDownList.ascx" TagPrefix="SO" TagName="ucCountryDropDownList" %>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" >
<HTML>
    <HEAD>
        <title>WebForm1</title>
    </HEAD>
    <body>
        <form id="Form1" method="post" runat="server">
            <SO:ucCountryDropDownList id="ddlCountry" runat="server" />
        </form>
    </body>
</HTML> 
```

在页面后面的代码中：

```
Protected Sub OnSelectedCountryChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles ddlCountry.SelectedCountryChanged
    ' add your code here
End Sub 
```

# ruby - 为什么 Ruby 只允许某些运算符重载

> ID：92862
> 
> 赞同：8
> 
> 时间：2008-09-18T14:10:09.087
> 
> 标签：ruby, methods, operators, operator-overloading

在 Ruby 中，与许多其他 OO 编程语言一样，运算符是可重载的。但是，只能重载某些字符运算符。

此列表可能不完整，但以下是一些不能重载的运算符：

```
!, not, &&, and, ||, or 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-09-18T14:16:01.570

[“&& 和 || 运算符不可重载，主要是因为它们提供了无法通过纯方法调用重现的“短路”评估。”](http://ola-bini.blogspot.com/2007/10/operator-overloading-in-ruby.html?showComment=1191704640000#c7207705878073349200)

——吉姆·韦里奇

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-18T14:14:12.353

方法是可重载的，它们是语言语法的一部分。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-09-18T14:16:58.383

是的。运算符不可重载。只有方法。

有些运营商不是真的。它们是方法的糖。`5 + 5`确实如此`5.+(5)`，而且`foo[bar] = baz`确实如此`foo.[]=(bar, baz)`。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-20T20:53:26.860

在 Ruby 1.9 中，`!`操作符实际上也是一种方法，可以被覆盖。这只留下`&&`and`||`和它们的低优先级对应物`and`and `or`。

还有一些其他“组合运算符”不能被覆盖，例如`a != b`is 实际上`!(a == b)`和`a += b`is 实际上`a = a+b`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-19T00:11:42.683

我们不要忘记`<<`例如：

```
string = "test"
string << "ing" 
```

与调用相同：

```
string.<<("ing") 
```

# c# - NUnit 与 Visual Studio 2008 的单元测试测试项目

> ID：92869
> 
> 赞同：255
> 
> 时间：2008-09-18T14:11:11.737
> 
> 标签：c#, asp.net-mvc, visual-studio-2008, unit-testing, nunit

我将在工作中启动一个新项目，并希望进行单元测试。我们将使用 Visual Studio 2008、C# 和 ASP.NET MVC 的东西。我正在考虑使用 NUnit 或 Visual Studio 2008 的内置测试项目，但我愿意研究其他建议。一个系统是否比另一个系统更好，或者可能比另一个系统更易于使用/理解？

我希望将这个项目设置为我们未来开发工作的“最佳实践”。

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2008-09-18T14:33:41.713

[Daok](https://stackoverflow.com/questions/92869/nunit-vs-visual-studio-2008s-test-projects-for-unit-testing/92900#92900) named all the pro's of Visual Studio 2008 test projects. Here are the pro's of NUnit.

*   NUnit has a mocking framework.
*   NUnit can be run outside of the IDE. This can be useful if you want to run tests on a non-Microsoft build server, like [CruiseControl.NET](https://en.wikipedia.org/wiki/CruiseControl).
*   NUnit has more versions coming out than visual studio. You don't have to wait years for a new version. And you don't have to install a new version of the IDE to get new features.
*   There are extensions being developed for NUnit, like row-tests, etc.
*   Visual Studio tests take a long time to start up for some reason. This is better in Visual Studio 2008, but it is still too slow for my taste. Quickly running a test to see if you didn't break something can take too long. NUnit with something like Testdriven.Net to run tests from the IDE is actually much faster. Especially when running single tests. According to Kjetil Klaussen, this is caused by the Visual Studio testrunner. Running MSTest tests in TestDriven.Net makes MSTest performance comparable to NUnit.

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2008-09-18T14:59:22.447

单元测试框架实际上并不重要，因为您可以使用单独的项目文件和条件编译来转换测试类（例如，Visual Studio → NUnit）：

```
#if !NUNIT
  使用 Microsoft.VisualStudio.TestTools.UnitTesting；
 ＃别的
  使用 NUnit.Framework；
  使用 TestClass = NUnit.Framework.TestFixtureAttribute；
  使用 TestMethod = NUnit.Framework.TestAttribute;
  使用 TestInitialize = NUnit.Framework.SetUpAttribute;
  使用 TestCleanup = NUnit.Framework.TearDownAttribute；
  使用 TestContext = System.String;
  使用 DeploymentItem = NUnit.Framework.DescriptionAttribute；
 ＃万一

```

TestDriven.Net 插件很好，而且不是很贵...只有普通的 Visual Studio 2008，您必须从您的测试类或测试列表中找到测试。使用[TestDriven.Net](http://www.testdriven.net/)，您可以直接从您正在测试的类中运行您的测试。毕竟，单元测试应该易于维护并且靠近开发人员。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2008-11-18T16:49:28.723

Visual Studio 2008 内置单元测试框架的优点/变化：

1.  2008 版现在有专业版（之前它需要昂贵的 Visual Studio 版本，这仅用于开发人员单元测试），这让许多开发人员只能选择开放/外部测试框架。
2.  单一公司支持的内置 API。
3.  使用相同的工具来运行和创建测试（您也可以使用命令行运行它们[MSTest](https://en.wikipedia.org/wiki/Visual_Studio_Unit_Testing_Framework)）。
4.  简单的设计（在没有模拟框架的情况下被授予，但这对许多程序员来说是一个很好的起点）。
5.  授予长期支持（我仍然记得[NDoc](https://en.wikipedia.org/wiki/NDoc)发生了什么，我不想承诺五年内可能不会支持的测试框架，但我仍然认为 NUnit 是一个很棒的框架）。
6.  如果使用 Team Foundation Server 作为后端，您可以使用失败的测试数据以简单的方式创建工作项或错误。

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2008-09-18T14:13:30.530

我已经使用 NUnit 两年了。一切都很好，但我不得不说 Visual Studio 中的单元测试系统非常好，因为它在 GUI 内部，可以更轻松地对私有函数进行测试，而不必乱来。

此外，Visual Studio 的单元测试可以让你做覆盖和其他 NUnit 无法做的事情。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2008-09-19T22:35:35.517

Visual Studio 的测试框架的一个小烦恼是它会创建许多测试运行文件，这些文件往往会使您的项目目录变得混乱——尽管这没什么大不了的。

此外，如果您缺少诸如[TestDriven.NET](http://www.testdriven.net/)之类的插件，则无法在 Visual Studio 环境中调试 NUnit（或 MbUnit、xUnit 等）单元测试，就像使用内置的 Microsoft Visual Studio 测试框架一样.

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2008-11-28T11:28:50.987

有点离题，但如果你使用 NUnit，我可以推荐使用[ReSharper——](http://www.jetbrains.com/resharper/)它向 Visual Studio UI 添加了一些按钮，这使得在 IDE 中运行和调试测试变得更加容易。

这篇评论有点过时了，但更详细地解释了这一点：

*[将 ReSharper 用作 TDD 工具包的重要组成部分](http://codebetter.com/blogs/paul.laudeman/archive/2006/08/15/Using-ReSharper-as-an-essential-part-of-your-TDD-toolkit.aspx)*

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2008-09-18T19:46:57.437

[xUnit](https://en.wikipedia.org/wiki/XUnit)是新建项目的另一种可能性。它可能有一种更直观的语法，但它与其他框架并不真正兼容。

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2009-03-08T06:59:28.747

我对 NUnit 上的 Visual Studio 单元测试的主要不满是 Visual Studio 测试创建倾向于注入一堆生成的代码以供私有成员访问。

有些人可能想测试他们的私有方法，有些人可能不想。那是一个不同的话题。

我担心的是，当我编写单元测试时，它们应该受到严格控制，这样我才能确切地知道我在测试什么以及我是如何测试它的。如果有自动生成的代码，我将失去一些所有权。

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2009-07-08T20:46:26.213

我已经使用这两种方法做了一些[TDD](https://en.wikipedia.org/wiki/Test-driven_development)，而且（也许我有点笨）NUnit 对我来说似乎更快更简单。当我说很多时，我的意思是很多。

在 MSTest 中，到处都有太多的属性 - 进行真正测试的代码是您可能在这里和那里阅读的那几行代码。一个大乱子。在 NUnit 中，执行测试的代码只是支配属性，这是它应该做的。

此外，在 NUnit 中，您只需单击要运行的测试（只有一个？涵盖一个类的所有测试？一个程序集？解决方案？）。一键点击。窗户又大又干净。你会得到清晰的绿灯和红灯。你真的知道一见钟情。

在VSTS中，测试列表卡在屏幕底部，又小又丑。你必须看两次才能知道发生了什么。而且您不能只运行一项测试（好吧，我还没有发现！）。

但我当然可能是错的——我刚刚阅读了大约 21 篇关于“如何使用 VSTS 进行简单的 TDD”的博客文章。我应该阅读更多；你说的对。

对于 NUnit，我读过一个。我在同一天进行 TDD。带着乐趣。

顺便说一句，我通常喜欢微软的产品。Visual Studio 确实是开发人员可以买到的最好的工具——但是 Visual Studio Team System 中的 TDD 和工作项管理确实很糟糕。

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2009-02-13T18:53:46.640

我收到“NUnit 文件结构比 VSTest 更丰富”的消息...当然，如果您更喜欢 NUnit 文件结构，您可以使用此解决方案以另一种方式，像这样（NUnit → Visual Studio）：

```
 #if !MSTEST
     using NUnit.Framework;
 #else
     using Microsoft.VisualStudio.TestTools.UnitTesting;
     using TestFixture = Microsoft.VisualStudio.TestTools.UnitTesting.TestClassAttribute;
     using Test = Microsoft.VisualStudio.TestTools.UnitTesting.TestMethodAttribute;
     using SetUp = Microsoft.VisualStudio.TestTools.UnitTesting.TestInitializeAttribute;
     using TearDown = Microsoft.VisualStudio.TestTools.UnitTesting.TestCleanupAttribute;
 #endif 
```

或任何其他转换... :-) 这里的使用只是编译器的别名。

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2008-09-19T20:25:49.103

首先，我想纠正一个错误的说法：您可以使用命令行在 Visual Studio 之外运行 MSTest。尽管几个 CI 工具，例如[TeamCity](https://en.wikipedia.org/wiki/TeamCity)，对 NUnit 有更好的支持（可能会随着 MSTest 变得更流行而改变）。

在我当前的项目中，我们同时使用了两者，唯一的区别是我们发现 MSTest 始终以 32 位运行，而 NUnit 以 32 位或 64 位测试运行，这仅在您的代码使用依赖于 32/64 位的本机代码时才重要。

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2009-06-12T05:53:22.007

我从 MSTest 开始，但出于一个简单的原因我切换了。MSTest 不支持从其他程序集*继承测试方法。*

我讨厌多次编写同一个测试的想法。特别是在一个测试方法很容易运行到 100 次测试的大型项目中。

NUnit 正是我所需要的。NUnit 唯一缺少的是一个 Visual Studio 插件，它可以显示每个测试的红色/绿色状态（如[VSTS](https://visualstudio.microsoft.com/team-services/)）。

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2009-08-23T22:40:30.027

如果您正在考虑 MSTest 或 NUnit，那么我建议您查看[MbUnit](https://en.wikipedia.org/wiki/List_of_unit_testing_frameworks#.NET_programming_languages)。我的理由是

1.  TestDriven.Net 兼容性。没有什么比 TestDriven.Net.ReRunWithDebugger 绑定到键盘组合更好了。
2.  加里奥框架。Gallio 是像 NUnit 一样的测试运行器。唯一的区别是它不在乎你是用 NUnit、[MSTest](https://en.wikipedia.org/wiki/Visual_Studio_Unit_Testing_Framework)、[xUnit](https://en.wikipedia.org/wiki/XUnit)还是 MbUnit 编写测试。他们都跑了。
3.  与 NUnit 的兼容性。MbUnit 支持 NUnit 中的所有功能。我认为您甚至不需要更改您的属性（必须检查），只需您的参考和`using`s。
4.  集合断言。MbUnit 有更多的 Assert 案例，包括 CollectionAssert 类。基本上，您不再需要编写自己的测试来查看两个集合是否相同。
5.  组合测试。如果您可以提供两组数据并针对所有数据组合进行测试，那不是很酷吗？它以 MbUnit 为单位。

我最初选择 MbUnit 是因为它的 [RowTest ....] 功能，但我还没有找到一个回头的理由。我把我所有的活动测试套件都从 NUnit 转移了过来，并且再也没有回头。从那时起，我已经将两个不同的开发团队转换为收益。

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2008-09-19T20:52:18.667

据我所知，目前有四个框架可用于使用 .NET 进行单元测试：

*   [单元](https://en.wikipedia.org/wiki/NUnit)
*   [兆单位](https://en.wikipedia.org/wiki/List_of_unit_testing_frameworks#.NET_programming_languages)
*   [测试](https://en.wikipedia.org/wiki/Visual_Studio_Unit_Testing_Framework)
*   [xUnit](https://en.wikipedia.org/wiki/XUnit)

NUnit 一直处于领先地位，但在过去一年左右的时间里，差距已经缩小。我自己还是更喜欢 NUnit，尤其是他们不久前添加了一个流畅的界面，这使得测试非常易读。

如果您刚刚开始进行单元测试，它可能不会有太大的不同。一旦您掌握了速度，您将能够更好地判断哪种框架最适合您的需求。

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2010-04-21T14:17:54.557

我不喜欢 Visual Studio 的内置测试框架，因为它迫使您创建一个单独的项目，而不是将您的测试作为您正在测试的项目的一部分。

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2009-01-14T03:23:47.520

MSTest 本质上是对 NUnit 进行了轻微改造，具有一些新功能（例如装配设置和拆卸，而不仅仅是夹具和测试级别），并且缺少一些最好的位（例如新的 2.4 约束语法）。NUnit 比较成熟，其他厂商的支持也比较多；当然，因为它一直是免费的（而[MSTest](https://en.wikipedia.org/wiki/Visual_Studio_Unit_Testing_Framework)只进入了 Visual Studio 2008 的专业版，在此之前它的 SKU 价格更高），并且大多数 ALT.NET 项目都使用它。

话虽如此，有些公司非常不愿意使用没有微软标签的东西，尤其是[OSS](https://en.wikipedia.org/wiki/Free_and_open-source_software)代码。因此，拥有一个官方的微软测试框架可能是这些公司需要进行测试的动机；老实说，重要的是测试，而不是您使用的工具（使用[Tuomas Hietanen 的代码](https://stackoverflow.com/questions/92869/nunit-vs-visual-studio-2008s-test-projects-for-unit-testing#93339)，您几乎可以使您的测试框架可互换）。

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2010-11-09T02:35:54.677

随着[代码合同系统在 .NET 4.0 中的发布和](http://msdn.microsoft.com/en-us/magazine/ee236408.aspx)[静态检查器](http://msdn.microsoft.com/en-us/devlabs/dd491992.aspx)的可用性，理论上您将需要编写更少的测试用例，而[Pex](http://research.microsoft.com/en-us/projects/pex/)之类的工具将有助于识别这些用例。将此与手头的讨论联系起来，如果您需要减少单元测试，因为您的合同覆盖了您的尾巴，那么为什么不继续使用内置部件，因为这样可以减少管理依赖项。这些天来，我都是关于简单的。:-)

也可以看看：

*   [Microsoft Pex – 自动化单元测试](http://lammichalfranc.wordpress.com/2010/08/15/microsoft-pex-automated-unit-testing/)
*   [使用 Visual Studio 2010 和 C# 4.0 使用 Pex 生成单元测试](http://fernandomachadopirizen.wordpress.com/2010/05/19/unit-tests-generation-with-pex-using-visual-studio-2010-and-c-4-0/)

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2009-05-22T20:54:24.253

我更喜欢使用 MS 的小测试框架，但现在我坚持使用 NUnit。MS的问题通常是（对我来说）

*   必须*维护的共享“测试”文件（无意义）*
*   测试列表会导致与多个开发人员/VCS 发生冲突
*   糟糕的集成 UI - 混乱的设置，繁琐的测试选择
*   没有好的外部跑步者

注意事项

*   如果我正在测试一个 aspx 站点，我*肯定会*使用 MS 的
*   如果我是单独开发，MS也可以
*   如果我的技能有限并且无法配置 NUnit :)

我发现编写我的测试并启动 NUnitGUI 或其他前端之一要容易得多（testDriven 的价格远远高出很多）。使用命令行版本设置调试也很容易。

# database - 在关系数据库中将用户表与人员表分离

> ID：92894
> 
> 赞同：10
> 
> 时间：2008-09-18T14:13:13.260
> 
> 标签：database, database-design, rdbms

我做过很多网络应用程序，你做的第一件事就是创建一个包含用户名、密码、姓名、电子邮件和所有其他常见问题的用户表。我目前的项目提出了一种情况，即非用户记录需要与用户类似的功能，但不需要成为一阶用户的能力。

创建第二个表是否合理`people_tb`，即主关系表和数据存储，并且仅使用`users_tb`用于身份验证？分离是否`user_tb`存在`people_tb`任何问题？如果通常这样做，有哪些策略和解决方案以及缺点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-18T14:29:00.960

这当然是一个好主意，因为您正在规范化数据库。我在正在编写的应用程序中做了类似的设计，其中有一个员工表和一个用户表。用户可能来自外部公司或员工，所以我有单独的表，因为员工始终是用户，但用户可能不是员工。

您将遇到的问题是，无论何时使用 user 表，您几乎总是希望 person 表获取您想要显示的名称或其他常见属性。

从编码的角度来看，如果您使用的是直接 SQL，那么在精神上解析 select 语句将需要更多的努力。如果您使用的是 ORM 库，可能会稍微复杂一些。我对这些没有足够的经验。

在我的应用程序中，我用 Ruby on Rails 编写它，所以我经常做一些事情，比如employee.user.name，如果我把它们放在一起，它就只是employee.name 或user.name。

从性能的角度来看，您正在访问两个表而不是一个，但是如果有适当的索引，它应该可以忽略不计。如果你有一个包含主键和人名的索引，例如，数据库会命中用户表，然后是人表的索引（几乎直接命中），所以性能几乎与有一张桌子。

您还可以在数据库中创建一个视图以保持两个表连接在一起，从而为您提供额外的性能增强。我知道在更高版本的 Oracle 中，如果需要提高性能，您甚至可以在视图上放置索引。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T14:17:39.397

我经常这样做，因为对我来说，“用户”（用户名、密码、创建日期、上次登录日期）的概念与“人”（姓名、地址、电话、电子邮件）不同。您可能会发现的缺点之一是您的查询通常需要更多的连接才能获得您正在寻找的信息。例如，如果您只有一个登录名，则需要加入“人员”表以获取名字和姓氏。如果您基于用户 id 主键的所有内容，这会有所缓解，但仍会弹出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T14:15:51.290

如果 user_tb 有 auth 信息，我非常愿意将其与 people_tb 分开。但是，我会保持两者之间的关系，并且大多数用户的信息将存储在 people_tb 中，除了身份验证所需的所有信息（我想不会用于其他用途）它是设计和效率之间的一个很好的权衡我思考。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T14:22:53.377

这绝对是我们所做的，因为我们拥有数百万人的记录并且只有数千名用户。我们还将地址、电话和电子邮件分开到关系表中，因为许多人拥有不止一个这些东西。关键是不要依赖名称作为标识符，因为名称不是唯一的。确保通过某种类型的代理键（最好是整数或 GUID）而不是名称来连接表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T14:19:50.220

我总是尽量避免数据重复。如果不是所有的人都需要登录，您可以有一个通用`people`表，其中包含适用于人和用户的信息（例如，名字、姓氏等）。

然后对于登录的人，您可以拥有一个`users`与 1~1 关系的表`people`。该表可以存储用户名和密码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T14:28:52.303

我会说去规范化设计（两个表），并且只去规范化（去一个用户/人员表），如果它真的会让你的生活更轻松的话。但是，如果实际上所有人都是用户，那么预先进行非规范化可能会更简单。由你决定; 我已经使用了标准化的方法，没有问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T14:34:30.200

很合理。

例如，请查看[此处](http://msdn.microsoft.com/en-us/library/ms229862.aspx "表格示例")的 aspnet_* 服务表。

他们的内置模式有一个`aspnet_Users`和`aspnet_Membership`后面的表，其中包含有关给定用户的更多扩展信息（散列密码等），但`aspnet_User.UserID`用于参考完整性等模式的其他部分。

最重要的是，如果属性是不同的实体，则将属性放在单独的表中是非常常见且良好的设计，就像您的情况一样。

# layout - 在 wiki 上，可以接受重组人们的标题吗？

> ID：92902
> 
> 赞同：1
> 
> 时间：2008-09-18T14:13:39.610
> 
> 标签：layout, coding-style, wiki, social

我不喜欢人们使用 h3 而不是 h1，或者仅仅因为它的外观而跳过一个级别。恕我直言，标题表示文档结构，而不是布局。布局只是一个副作用，可以通过主题进行自定义。

“错误”的标题级别也使得生成正确的目录和/或导出到其他格式变得更加困难。

在进行 wiki 园艺时，是否可以完全重组其他人的页面以使用适当的嵌套标题级别？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T14:44:09.317

正如其他人所提到的，如果您正在做的是大修，最好在文章的讨论页面上开始对话。如果有人在一篇相当短的文章中有一个 H1 和两个 H3，我认为改变它们没什么大不了的。有疑问时开始讨论。

可能相关的另一件事是，如果您找不到有关标题使用的编辑或样式指南，它们对文章目录的影响，用于控制其外观的样式等，那么您总是可以开始讨论那。如果对于一篇文章的正确布局存在分歧，那么 wiki 将很难阅读。无论是由这样的讨论决定的（确保达成共识和法定人数，或者任何适合在相关 wiki 上跨 wiki 的决定）都可以更可靠地单方面编辑到任何不符合要求的文章中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T14:33:19.610

我同意特菲翁的观点。这取决于各个 wiki 的指导方针和/或规则，但也取决于行为规则。在某些站点上，可以编辑您想要的任何页面，在某些站点上，最好通知原始（或维护）作者。

我要说的另一件事是，将您的论点呈现给初始页面作者或最近的维护作者会更有礼貌。您还可以在讨论页面上添加评论，说明您的意见。因为虽然通常认为根据内容级别先使用 H1 然后使用 H2 而不是跳过，这确实是个人喜好问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T14:16:12.893

是的，可以按照网站的既定标准或事实标准来重构人们的标题。

当您编辑某人的帖子时，社区将通过回滚您的更改、保留您的更改或编辑您的更改来决定您的编辑是否值得或肤浅。

参见[维基百科风格手册](http://en.wikipedia.org/wiki/Wikipedia:Manual_of_Style)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T14:17:35.653

这取决于编码/布局指南的状态。如果他们在使用 h2 时说要使用 h3，那么您可以对其进行编辑。但是，如果您仅根据个人喜好编辑其他人的帖子，那么我会说这是错误的。

除此之外，您可以随时询问作者是否可以找到它们。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-09-18T14:17:00.007

wiki 的好处是您可以自由编辑它！如果你认为重组会让它变得更好，那么一定要去做。

# flash - 闪存编辑器

> ID：92925
> 
> 赞同：2
> 
> 时间：2008-09-18T14:16:34.487
> 
> 标签：flash

我应该使用什么应用程序来为网站创建 Flash 动画？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T14:18:26.477

Adobe Flash ( [http://www.adobe.com/products/flash/](http://www.adobe.com/products/flash/) )

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T14:21:23.820

对于其他选项（免费软件），请查看[此问题](https://stackoverflow.com/questions/55075/can-i-develop-flash-without-buying-anything)或[此问题](https://stackoverflow.com/questions/21174/foss-tools-for-flash-development)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T14:25:34.167

我已经使用[SWiSH Max2](http://www.swishzone.com/index.php?area=products&product=max)几年了（嗯，SWiSH Max 然后是第二个）。它在很大程度上是 Flash 编辑的“FrontPage”，但它的优势是相当专业、易于使用且相对便宜（149 美元，而 Adob​​e Flash CS3 为 699 美元，尽管我认为我为它支付了 99 美元，所以它的价格上涨了）。

它有 30 天的免费试用期。

# php - 如何避免缓存中对象的重复副本？

> ID：92927
> 
> 赞同：1
> 
> 时间：2008-09-18T14:16:40.990
> 
> 标签：php, caching, memcached

我正在使用 memcache 为 Web 应用程序的模型层设计缓存，我最大的问题之一是数据一致性。我想到了像这样缓存数据：（key=query，value=list of object ids result of the query）对于列表的每个id：（key=object.id，value=object）

因此，每次完成查询时：如果查询已经存在，我会从缓存中检索列表中指示的对象。如果不是，则列表的所有对象都存储在缓存中，替换任何其他旧值。

有人用过这个替代品吗，是上帝吗？还有其他想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T14:26:20.623

缓存是没有一个正确答案的主题之一 - 这取决于您的域。

您描述的缓存策略可能足以满足您的域。但是，您似乎并不担心过时的数据。通常我希望看到针对某些实体的时间戳 - 如果缓存的值比某些系统定义的参数旧，那么它将被认为是陈旧的并重新获取。

有关缓存算法的更多讨论，请参阅[Wikipedia](http://en.wikipedia.org/wiki/Cache_algorithms)（初学者）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T14:23:56.947

欢迎来到并发编程的世界。你会想了解一些关于[互斥](http://en.wikipedia.org/wiki/Mutual_exclusion)的知识。如果您告诉我们您正在开发什么语言/平台，我们可以更具体地描述您的选择。

# python - time.sleep -- 休眠线程或进程？

> ID：92928
> 
> 赞同：399
> 
> 时间：2008-09-18T14:16:45.063
> 
> 标签：python, multithreading, time, sleep, python-internals

在 Python for *nix 中，会`time.sleep()`阻塞线程还是进程？

* * *

## 回答 #1

> 赞同：396
> 
> 时间：2008-09-18T14:42:23.020

它阻塞了线程。如果您查看 Python 源代码中的 Modules/timemodule.c，您会看到在对 的调用中`floatsleep()`，睡眠操作的实质部分被包装在 Py_BEGIN_ALLOW_THREADS 和 Py_END_ALLOW_THREADS 块中，允许其他线程在当前线程继续执行一个睡觉。你也可以用一个简单的 python 程序来测试它：

```
import time
from threading import Thread

class worker(Thread):
    def run(self):
        for x in xrange(0,11):
            print x
            time.sleep(1)

class waiter(Thread):
    def run(self):
        for x in xrange(100,103):
            print x
            time.sleep(5)

def run():
    worker().start()
    waiter().start() 
```

这将打印：

```
>>> thread_test.run()
0
100
>>> 1
2
3
4
5
101
6
7
8
9
10
102 
```

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2008-09-18T14:22:52.677

它只会使线程休眠，除非您的应用程序只有一个线程，在这种情况下，它将使线程休眠并有效地使进程休眠。

然而， python 文档[`sleep()`](https://docs.python.org/3/library/time.html#time.sleep)并没有具体说明这一点，所以我当然可以理解这种混乱！

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2008-09-18T14:18:51.813

只是线程。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2008-09-18T14:32:45.787

线程将阻塞，但进程仍然存在。

在单线程应用程序中，这意味着在您睡觉时一切都被阻塞。在多线程应用程序中，只有您明确“睡眠”的线程会阻塞，其他线程仍在进程中运行。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-08-26T00:21:35.043

只有线程，除非您的进程有一个线程。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-10-28T21:24:44.433

进程本身不可运行。在执行方面，进程只是线程的容器。这意味着您根本无法暂停该过程。它根本不适用于过程。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-01-20T10:57:32.940

如果它在同一个线程中执行，它会阻塞一个线程，而不是如果它是从主代码执行的

# apache-flex - 控制弹性图表轴

> ID：92936
> 
> 赞同：2
> 
> 时间：2008-09-18T14:17:30.210
> 
> 标签：apache-flex, charts, renderer

我想使用只有 3 个标签的小型弹性图表，例如过去 2 小时的图表，带有 3 个水平标签，如下所示：

```
 |       |        |    
9:46    10:46    11:46 
```

（当然，要显示的值不止 3 个！）

有人告诉我这不是微不足道的，但你会怎么做呢？

另外，您是否知道任何介绍如何在 Flex 中实现复杂布局的书籍？我发现的书籍是面向代码的，通常将格式限制在最低限度，而且将属性名称与您正在尝试做的事情联系起来并不总是那么简单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T18:51:34.883

查看[AxisRenderer](http://livedocs.adobe.com/flex/3/langref/mx/charts/AxisRenderer.html)类的在线[Flex 语言指南。](http://livedocs.adobe.com/flex/3/langref/index.html)

它还有一些有用的示例代码和输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-24T01:54:22.587

你看过 CategoryAxis 类型吗？使用它，您可以显式设置标签。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T13:01:03.843

我认为在要用作 dataProvider 的每个变量之前都需要 "[Bindable]" ，所以在*labels*之前再添加一个。

# emacs - How do I set the size of Emacs' window?

> ID：92971
> 
> 赞同：107
> 
> 时间：2008-09-18T14:20:29.000
> 
> 标签：emacs, elisp

I'm trying to detect the size of the screen I'm starting emacs on, and adjust the size and position the window it is starting in (I guess that's the frame in emacs-speak) accordingly. I'm trying to set up my .emacs so that I always get a "reasonably-big" window with it's top-left corner near the top-left of my screen.

I guess this is a *big* ask for the general case, so to narrow things down a bit I'm most interested in GNU Emacs 22 on Windows and (Debian) Linux.

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2008-09-18T16:40:11.147

If you want to change the size according to resolution you can do something like this (adjusting the preferred width and resolutions according to your specific needs):

```
(defun set-frame-size-according-to-resolution ()
  (interactive)
  (if window-system
  (progn
    ;; use 120 char wide window for largeish displays
    ;; and smaller 80 column windows for smaller displays
    ;; pick whatever numbers make sense for you
    (if (> (x-display-pixel-width) 1280)
           (add-to-list 'default-frame-alist (cons 'width 120))
           (add-to-list 'default-frame-alist (cons 'width 80)))
    ;; for the height, subtract a couple hundred pixels
    ;; from the screen height (for panels, menubars and
    ;; whatnot), then divide by the height of a char to
    ;; get the height we want
    (add-to-list 'default-frame-alist 
         (cons 'height (/ (- (x-display-pixel-height) 200)
                             (frame-char-height)))))))

(set-frame-size-according-to-resolution) 
```

Note that window-system is deprecated in newer versions of emacs. A suitable replacement is `(display-graphic-p)`. See [this answer](https://stackoverflow.com/a/5795518/7432) to the question [How to detect that emacs is in terminal-mode?](https://stackoverflow.com/questions/5795451/how-to-detect-that-emacs-is-in-terminal-mode) for a little more background.

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2008-09-18T16:29:29.737

I've got the following in my `.emacs`:

```
(if (window-system)
  (set-frame-height (selected-frame) 60)) 
```

You might also look at the functions `set-frame-size`, `set-frame-position`, and `set-frame-width`. Use `C-h f` (aka `M-x describe-function`) to bring up detailed documentation.

I'm not sure if there's a way to compute the max height/width of a frame in the current windowing environment.

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2008-09-18T14:26:48.033

Taken from: [http://www.gnu.org/software/emacs/windows/old/faq4.html](http://www.gnu.org/software/emacs/windows/old/faq4.html)

```
(setq default-frame-alist
      '((top . 200) (left . 400)
        (width . 80) (height . 40)
        (cursor-color . "white")
        (cursor-type . box)
        (foreground-color . "yellow")
        (background-color . "black")
        (font . "-*-Courier-normal-r-*-*-13-*-*-*-c-*-iso8859-1")))

(setq initial-frame-alist '((top . 10) (left . 30))) 
```

The first setting applies to all emacs frames including the first one that pops up when you start. The second setting adds additional attributes to the first frame. This is because it is sometimes nice to know the original frame that you start emacs in.

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2008-09-18T14:34:04.973

The easiest way I've found to do that in an X-Window environment is through [X resources](http://www.gnu.org/software/emacs/manual/html_node/emacs/Table-of-Resources.html#Table-of-Resources). The relevant part of my .Xdefaults looks like this:

```
Emacs.geometry: 80x70 
```

You should be able to suffix it with +0+0 location coordinates to force it to the upper-left corner of your display. (the reason I don't do it is that I occasionnally spawn new frames, and it makes things confusing if they appear in the exact same location as the previous one)

According to the manual, [this technique works on MS Windows too](http://www.gnu.org/software/emacs/manual/html_node/emacs/MS_002dWindows-Registry.html#MS_002dWindows-Registry), storing the resources as key/value pairs in the registry. I never tested that. It might be great, it might be much more of an inconvenience compared to simply editing a file.

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2012-09-08T22:18:15.620

Try adding the following code to `.emacs`

```
(add-to-list 'default-frame-alist '(height . 24))

(add-to-list 'default-frame-alist '(width . 80)) 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2008-09-18T16:44:39.887

You can also the -geometry parameter when firing up emacs: `emacs -geometry 80x60+20+30` will give you a window 80 characters wide, 60 rows high, with the top left corner 20 pixels to the right and 30 pixels down from the top left corner of the background.

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2011-10-05T11:32:56.563

On ubuntu do:

```
(defun toggle-fullscreen ()
  (interactive)
  (x-send-client-message nil 0 nil "_NET_WM_STATE" 32
                 '(2 "_NET_WM_STATE_MAXIMIZED_VERT" 0))
  (x-send-client-message nil 0 nil "_NET_WM_STATE" 32
                 '(2 "_NET_WM_STATE_MAXIMIZED_HORZ" 0))
)
(toggle-fullscreen) 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2010-08-21T20:05:22.447

On windows, you could make emacs frame maximized using this function :

```
(defun w32-maximize-frame ()
  "Maximize the current frame"
  (interactive)
  (w32-send-sys-command 61488)) 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-18T14:25:26.133

```
(setq initial-frame-alist
        (append '((width . 263) (height . 112) (top . -5) (left . 5) (font . "4.System VIO"))
                initial-frame-alist))

(setq default-frame-alist
        (append '((width . 263) (height . 112) (top . -5) (left . 5) (font . "4.System VIO"))
                default-frame-alist)) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-08-11T05:42:07.887

```
(defun set-frame-size-according-to-resolution ()
  (interactive)
  (if window-system
  (progn
    ;; use 120 char wide window for largeish displays
    ;; and smaller 80 column windows for smaller displays
    ;; pick whatever numbers make sense for you
    (if (> (x-display-pixel-width) 1280)
           (add-to-list 'default-frame-alist (cons 'width 120))
           (add-to-list 'default-frame-alist (cons 'width 80)))
    ;; for the height, subtract a couple hundred pixels
    ;; from the screen height (for panels, menubars and
    ;; whatnot), then divide by the height of a char to
    ;; get the height we want
    (add-to-list 'default-frame-alist 
         (cons 'height (/ (- (x-display-pixel-height) 200)
                             (frame-char-height)))))))

(set-frame-size-according-to-resolution) 
```

I prefer Bryan Oakley's settings. However the **'height** not work properly in my GNU Emacs 24.1.1.

# javascript - “部分函数应用程序”在 Javascript 的上下文中是用词不当吗？

> ID：92984
> 
> 赞同：11
> 
> 时间：2008-09-18T14:22:42.270
> 
> 标签：javascript, functional-programming

我和我的一个朋友正在讨论 Javascript 中的柯里化和部分函数应用程序，对于两者是否可以实现，我们得出了截然不同的结论。我想出了这个实现`Function.prototype.curry`，这是我们讨论的基础：

```
Function.prototype.curry = function() {
    if (!arguments.length) return this;

    var args = Array.prototype.slice.apply(arguments);
    var mmm_curry = this, args;

    return function() {
        var inner_args = Array.prototype.slice.apply(arguments);
        return mmm_curry.apply(this, args.concat(inner_args));
    }

} 
```

使用如下：

```
var vindaloo = function(a, b) {
    return (a + b);
}

var karahi = vindaloo.curry(1);
var masala = karahi(2);
var gulai = karahi(3);

print(masala);
print(other); 
```

在 Spidermonkey 中的输出如下：

```
$ js curry.js
3
4 
```

他的观点是，由于 Javascript`function`原语本身并不支持“部分函数应用”，因此将绑定到变量的函数`karahi`称为部分应用是完全错误的。他的论点是，当`vindaloo`函数被柯里化时，函数本身被完全应用并返回一个闭包，而不是“部分应用的函数”。

现在，我的观点是，虽然 Javascript 本身不支持其`function`原语中的部分应用程序（不像 ML 或 Haskell），但这并不意味着您不能创建该语言的高阶函数，它能够封装部分应用函数的概念。此外，尽管被“应用”，函数的范围仍然绑定到它返回的闭包，导致它保持“部分应用”。

哪个是对的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T14:44:55.290

我认为谈论 JavaScript 中的偏函数应用程序是完全可以的——如果它像偏函数应用程序一样工作，那么它一定是一个。你还会怎么命名它？

你的*curry*函数如何实现他的目标只是一个实现细节。以类似的方式，我们可以在 ECMAScript 规范中进行部分应用，但是当 IE 像您一样实现它时，您将无法找到答案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T14:48:34.737

从技术上讲，您正在创建一个调用原始函数的全新函数。所以如果我对部分应用函数的理解是正确的，这不是一个部分应用函数。部分应用的函数会更接近于此（请注意，这不是通用解决方案）：

```
vindaloo.curry = function(a) {
    return function(b) {
        return a + b;
    };
}; 
```

IIUC，这仍然不是部分应用的功能。但它更接近。如果您可以检查代码，则真正的部分应用函数实际上看起来像这样：

```
function karahi(b) {
    return 1 + b;
}; 
```

因此，从技术上讲，您的原始方法*只是*返回一个绑定在闭包中的函数。我能想到的在 JavaScript 中真正部分应用函数的唯一方法是解析函数，应用更改，然后通过 eval() 运行它。

但是，您的解决方案是该概念在 JavaScript 中的一个很好的实际应用，因此实际上实现了目标，即使它在技术上并不准确。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T15:38:43.227

技术细节对我来说并不重要——如果语义保持不变，并且出于所有意图和目的，该函数的行为就好像它真的是一个部分应用的函数，谁在乎呢？

我曾经对事情很学术，但担心这些细节最终并不能真正完成工作。

就个人而言，我使用[**MochiKit**](http://www.mochikit.com)；它有一个很好的 partial() 函数，可以帮助创建这样的函数。我喜欢它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T14:43:44.887

您应该查看[Curried JavaScript Functions](http://www.svendtofte.com/code/curried_javascript/)。我还没有完全理解他的咖喱功能，但它可能有你的答案。

编辑：不过，我同意你的评估。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-01T14:48:15.870

> 他的观点是，由于 Javascript 函数原语本身并不支持“部分函数应用”

你可以非常优雅地在 ES6 中进行柯里化：

```
> const add = a => b => a + b
> const add10 = add(10)
> [1,2,3].map(add10)
[ 11, 12, 13 ] 
```

# drools - 在大批量过程中使用 Drools

> ID：92985
> 
> 赞同：16
> 
> 时间：2008-09-18T14:22:49.010
> 
> 标签：drools

我们使用 Drools 作为解决方案的一部分，在一个非常密集的处理应用程序中充当一种过滤器，可能在 500,000 + 个工作内存对象上运行多达 100 条规则。事实证明它非常慢。其他人有在批处理应用程序中使用 Drools 的经验吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-07T08:10:27.673

取决于您的规则 - 给定足够的内存，500K 对象是合理的（它必须在内存中填充 RETE 网络，因此内存使用量是 500K 对象的倍数 - 即对象空间 + 网络结构、索引等空间） - 它可能您正在分页到磁盘，这将非常慢。

当然，如果你有匹配相同类型事实组合的规则，那可能会导致尝试组合的爆炸式增长，即使你有 1 条规则也会非常慢。如果你有更多关于你正在做的分析的信息，那可能会帮助你找到可能的解决方案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-03T00:48:50.947

我使用了带有状态工作记忆的 Drools，其中包含超过 100 万个事实。通过对规则和底层 JVM 进行一些调整，初始启动几分钟后性能会非常好。如果您想了解更多详情，请告诉我。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T21:08:33.560

我没有使用过最新版本的 Drools（我上次使用它是大约一年前），但当时我们的高负载基准测试证明它非常慢。在我们的大部分架构都基于它之后，我们感到非常失望。

至少我记得关于 drools 的一些好处是他们的开发团队可以在 IRC 上找到并且非常有帮助，你可以试试他们，毕竟他们是专家：**irc.codehaus.org #drools**

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-17T13:10:56.393

我自己只是在学习流口水，所以也许我遗漏了一些东西，但是为什么整批五十万个对象一次添加到工作内存中？我能想到的唯一原因是，只有当批次中的两个或多个项目相关时才会启动规则。

如果不是这种情况，那么也许您可以使用无状态会话并一次断言一个对象。我假设在这种情况下规则的运行速度会快 50 万倍。

即使是这种情况，您的所有规则是否都需要访问所有 500k 个对象？您能否通过一次应用一项规则来加快处理速度，然后在处理的第二阶段使用不同的规则库和工作内存应用批处理级规则？这不会改变数据量，但 RETE 网络会更小，因为简单的规则会被删除。

另一种方法是在第二阶段尝试识别相关的对象组并按组声明对象，进一步减少工作内存中的数据量并拆分 RETE 网络。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-30T15:38:42.047

Drools 并不是真正设计用于在大量对象上运行的。它针对在一些对象上运行复杂的规则进行了优化。

每个附加对象的工作内存初始化太慢，并且缓存策略旨在为每个工作内存对象工作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-29T11:14:48.573

使用无状态会话并一次添加一个对象？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-01-20T19:33:03.923

在解析了几千个对象后，我遇到了 OutOfMemory 错误的问题。设置不同的默认优化器解决了这个问题。

```
OptimizerFactory.setDefaultOptimizer(OptimizerFactory.SAFE_REFLECTIVE); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-30T16:30:18.927

我们也在研究流口水，但对我们来说，对象的数量很少，所以这不是问题。我确实记得读过相同算法的替代版本，它们更多地考虑了内存使用情况，并且针对速度进行了优化，同时仍然基于相同的算法。不过，不确定他们中是否有人将其变成了真正可用的库。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2016-05-24T12:44:40.667

这个优化器也可以通过使用参数 -Dmvel2.disable.jit=true 来设置********